BEGIN                                                                   00001000
DEFINE                                                                  00002000
    MEMORY      =  8192#,                                               00003000
    PRINTERTOG  =  TRUE#,                                               00004000
    READERTOG   =  TRUE#,                                               00005000
    PRINTERLINELENGTH  =  132#;                                         00006000
%                                                                       00007000
%                                                                       00008000
REAL    COMMON;                                                         00009000
%                                                                       00010000
%        LAST LABEL = 336                                               00011000
%                                                                       00012000
DEFINE                                                                  00013000
    POWERFAIL             =  LAB(0)#,                                   00014000
    MEMORYPARITY          =  LAB(1)#,                                   00015000
    IO0                   =  LAB(2)#,                                   00016000
    IO1                   =  LAB(3)#,                                   00017000
    IO2                   =  LAB(4)#,                                   00018000
    IO3                   =  LAB(5)#,                                   00019000
    INITIALIZE            =  LAB(6)#;                                   00020000
%                                                                       00021000
FILE LINE 18 (5,17),                                                    00022000
     REQUEST DISK SERIAL "SYSTEM""REQUEST" (2,15,150),                  00023000
     NIF DISK SERIAL "SYSTEM""NIF" (2,30,150),                          00024000
     CODE DISK SERIAL [20:30] "CODE""DC1000" (2,60,600,SAVE 7);         00025000
%                                                                       00026000
DEFINE                                                                  00027000
         LABLMAX                 =  340#;                               00028000
%                                                                       00029000
REAL ARRAY                                                              00030000
    CODEARRAY[0:60],                                                    00031000
    LBUFF[0:14],                                                        00032000
    TEXTARRAY[0:3,0:255],                                               00033000
    ASCII[0:64],                                                        00034000
    L[0:2,0:LABLMAX],                                                   00035000
    PA[0:3,0:256],                                                      00036000
    OUTPOINTER,                                                         00037000
    INPOINTER,                                                          00038000
    SENARRAY,                                                           00039000
    FUNARRAY[0:63];                                                     00040000
%                                                                       00041000
REAL                                                                    00042000
    LOC,                                                                00043000
    JUNK,                                                               00044000
    JUNK1,                                                              00045000
    JUNK2,                                                              00046000
    I,                                                                  00047000
    II,                                                                 00048000
    J,                                                                  00049000
    K,                                                                  00050000
    Z,                                                                  00051000
    A,                                                                  00052000
    C,                                                                  00053000
    X,                                                                  00054000
    P,                                                                  00055000
    B,                                                                  00056000
    D,                                                                  00057000
    Y,                                                                  00058000
    Q,                                                                  00059000
    F;                                                                  00060000
%                                                                       00061000
INTEGER                                                                 00062000
    IJUNK,                                                              00063000
    RECORDS,                                                            00064000
    LASTCODEINX,                                                        00065000
    PASSES,                                                             00066000
    ERRORNUMBER,                                                        00067000
    PRECISION,                                                          00068000
    ERRORS,                                                             00069000
    CODEINX,                                                            00070000
    NEXTPOOL;                                                           00071000
%                                                                       00072000
BOOLEAN                                                                 00073000
    FIRSTPASS,                                                          00074000
    LASTPASS,                                                           00075000
    STOP,                                                               00076000
    LISTING;                                                            00077000
%                                                                       00078000
LABEL                                                                   00079000
    PUNCHONLY;                                                          00080000
%                                                                       00081000
%                                                                       00082000
DEFINE                                                                  00083000
    POOL(POOL1)               =  PA[0,POOL1]#,                          00084000
    POOLADDRESS(POOLADDRESS1) =  PA[1,POOLADDRESS1]#,                   00085000
    POOLUSE(POOLUSE1)         =  PA[2,POOLUSE1]#,                       00086000
    EMITVAL(EMITVAL1)         =  PA[3,EMITVAL1]#,                       00087000
    LABLARRAY(LABLARRAY1)     =  L[0,LABLARRAY1]#,                      00088000
    LABLS(LABLS1)             =  L[0,LABLS1]#,                          00089000
    LABLUSE(LABLUSE1)         =  L[1,LABLUSE1]#;                        00090000
%                                                                       00091000
DEFINE                                                                  00092000
    CLEARLINE                 =  CLEAN(LBUFF[0])#;                      00093000
%                                                                       00094000
DEFINE                                                                  00095000
    LITPRINT                  =  0#,                                    00096000
    OPPRINT                   =  2#,                                    00097000
    HEADINGPRINT              =  4#,                                    00098000
    PRINTERRORS               =  INKIT(0,0,5,0)#,                       00099000
    SKIPPAGE                  =  INKIT(0,1,6,0)#,                       00100000
    DOUBLESPACE               =  INKIT(0,2,6,0)#,                       00101000
    SKIPLINE                  =  INKIT(0,3,6,0)#,                       00102000
    WRITESTARS                =  INKIT(0,4,6,0)#,                       00103000
    REGBASE                   =  192#,                                  00104000
    STARSFORM                 =  TEXTARRAY[2,212]#,                     00105000
    ERROW                     =  3#,                                    00106000
    ERRSIZE                   =  4#,                                    00107000
    ERRBASE                   =  189#,                                  00108000
    ERRORMAX                 =  10#,                                    00109000
    SCRATCH                   =  230#;                                  00110000
%                                                                       00111000
DEFINE             %  FOR USE IN TYPE FUNCTIONS AND ADDRESS CALCULATION 00112000
    SIGNS                     =  1#,                                    00113000
    SIGNL                     =  1#,                                    00114000
    PHYSICALADDRESSS          =  1#,                                    00115000
    PHYSICALADDRESSL          =  15#,                                   00116000
    SECTORS                   =  3#,                                    00117000
    SECTORL                   =  5#,                                    00118000
    SIZES                     =  8#,                                    00119000
    SIZEL                     =  3#,                                    00120000
    ERRORSS                   =  11#,                                   00121000
    ERRORL                    =  1#,                                    00122000
    TYPES                     =  11#,                                   00123000
    TYPEL                     =  5#,                                    00124000
    PRECISIONMASKS            =  16#,                                   00125000
    PRECISIONMASKL            =  4#,                                    00126000
    LABLINDEXS                =  16#,                                   00127000
    LABLINDEXL                =  10#,                                   00128000
    SECTORUSEMASKS            =  16#,                                   00129000
    SECTORUSEMASKL            =  32#,                                   00130000
    LITERALS                  =  17#,                                   00131000
    LITERALL                  =  31#,                                   00132000
    PRECISIONUSEDS            =  28#,                                   00133000
    PRECISIONUSEDL            =  4#,                                    00134000
    ADDRESSS                  =  32#,                                   00135000
    ADDRESSL                  =  16#,                                   00136000
    SIGN                      =  [SIGNS:SIGNL]#,                        00137000
    PHYSICALADDRESS           =  [PHYSICALADDRESSS:PHYSICALADDRESSL]#,  00138000
    SECTOR                    =  [SECTORS:SECTORL]#,                    00139000
    SIZE                      =  [SIZES:SIZEL]#,                        00140000
    ERROR                     =  [ERRORSS:ERRORL]#,                     00141000
    TYPE                      =  [TYPES:TYPEL]#,                        00142000
    PRECISIONMASK             =  [PRECISIONMASKS:PRECISIONMASKL]#,      00143000
    LABLINDEX                 =  [LABLINDEXS:LABLINDEXL]#,              00144000
    SECTORUSEMASK             =  [SECTORUSEMASKS:SECTORUSEMASKL]#,      00145000
    LITERAL                   =  [LITERALS:LITERALL]#,                  00146000
    PRECISIONUSED             =  [PRECISIONUSEDS:PRECISIONUSEDL]#,      00147000
    ADDRESS                   =  [ADDRESSS:ADDRESSL]#,                  00148000
    TYPELITERAL      =  1#,                                             00149000
    TYPEREGISTER     =  2#,                                             00150000
    USEIT            =  3#,                                             00151000
    TYPELABL         =  12#,                                            00152000
    TYPEREFERENCED   =  8#,                                             00153000
    TYPELABLERROR    =  28#;                                            00154000
%                                                                       00155000
%    ERROR TYPES                                                        00156000
%           1    MULTIPLY DEFINED LABEL                                 00157000
%           2    UNDEFINED LABEL                                        00158000
%           4    LABEL LOCATION CONFLICT                                00159000
%           8    LABEL ASSIGNMENT ERROR                                 00160000
%          16    POSSIBLE OPERAND SIZE ERROR                            00161000
%          32    INDEXED OPERAND ERROR                                  00162000
%          64    ILLEGAL REGISTER TYPE                                  00163000
%         128    INSUFFICIENT MEMORY                                    00164000
%         256    LITERAL PASS MISMATCH                                  00165000
%         512    ADDRESSABILITY ERROR                                   00166000
%                                                                       00167000
%                                                                       00168000
%                                                                       00169000
REAL PROCEDURE HEX(N);  VALUE N; REAL N; FORWARD;                       00170000
PROCEDURE DUMPER (A,L1,L2);                                             00171000
    VALUE L1,L2;                                                        00172000
    ARRAY A[*,*];                                                       00173000
    INTEGER L1,L2;                                                      00174000
BEGIN                                                                   00175000
INTEGER I,J,K;                                                          00176000
ARRAY T[0:15];                                                          00177000
STREAM PROCEDURE SPLIT(S,D,L);                                          00178000
VALUE L;                                                                00179000
BEGIN                                                                   00180000
SI:=S;  DI:=D;                                                          00181000
L(DI:=DI+4; DS:=4 CHR; DI:=DI+4; DS:=4 CHR);                            00182000
END;                                                                    00183000
FORMAT OT(I5,X5,8(A6,X1,A6,X4));                                        00184000
FOR I:=0 STEP 1 UNTIL L1 DO                                             00185000
BEGIN                                                                   00186000
WRITE(LINE[DBL]);                                                       00187000
WRITE(LINE,<X5,"ROW =",I5>,I);                                          00188000
FOR J:=0 STEP 6 WHILE J { L2 DO                                         00189000
BEGIN                                                                   00190000
SPLIT(A[I,J],T,IF J+6 > L2 THEN L2-J+1 ELSE 6);                         00191000
FOR K:=0 STEP 1 UNTIL 15 DO T[K]:=HEX(T[K]);                            00192000
IF J+6 > L2 THEN FOR K:=2|(L2-J+1) STEP 1 UNTIL 15 DO T[K]:="      ";   00193000
WRITE(LINE,OT,J,FOR K:=0 STEP 1 UNTIL 11 DO T[K]);                      00194000
END;                                                                    00195000
END;                                                                    00196000
END;                                                                    00197000
PROCEDURE INKIT(WHAT,SZ,FORM,LC);                                       00198000
    VALUE WHAT,SZ,FORM,LC;                                              00199000
    REAL WHAT,SZ,FORM,LC;     FORWARD;                                  00200000
%                                                                       00201000
PROCEDURE EMIT(VAL,NUMBER,TYP);                                         00202000
    VALUE VAL,NUMBER,TYP;                                               00203000
    REAL VAL,NUMBER,TYP;     FORWARD;                                   00204000
%                                                                       00205000
%                                                                       00206000
%                                                                       00207000
%         ERR CAUSES AN ERROR OF TYPE X TO BE RECORDED,                 00208000
%         THEN CAUSES ANY ERRORS COLLECTED TO BE PRINTED                00209000
%                                                                       00210000
PROCEDURE ERR(X);                                                       00211000
    VALUE X;                                                            00212000
    REAL X;                                                             00213000
    BEGIN                                                               00214000
         ERRORNUMBER:=REAL(BOOLEAN(ERRORNUMBER) OR BOOLEAN(X));         00215000
         ERRORS := ERRORS + 1;                                          00216000
         PRINTERRORS;                                                   00217000
    END;                                                                00218000
%                                                                       00219000
%                                                                       00220000
%         FLAG RECORDS AN ERROR OF TYPE X FOR LATER PRINTING            00221000
%                                                                       00222000
PROCEDURE FLAG(X);                                                      00223000
    VALUE X;                                                            00224000
    REAL X;                                                             00225000
    BEGIN                                                               00226000
         ERRORNUMBER:=REAL(BOOLEAN(ERRORNUMBER) OR BOOLEAN(X));         00227000
         ERRORS := ERRORS + 1;                                          00228000
    END;                                                                00229000
%                                                                       00230000
%                                                                       00231000
%         LOCATE SETS THE LOCATION COUNTER LOC TO POS.                  00232000
%                                                                       00233000
PROCEDURE LOCATE(POS);                                                  00234000
    VALUE POS;                                                          00235000
    INTEGER POS;                                                        00236000
    LOC.ADDRESS:=POS;                                                   00237000
%                                                                       00238000
%                                                                       00239000
%         LABL PLACES LABL[INX] AT THE CURRENT LOCATION                 00240000
%         COUNTER                                                       00241000
%                                                                       00242000
PROCEDURE LABL(INX);                                                    00243000
    VALUE INX;                                                          00244000
    INTEGER INX;                                                        00245000
    IF FIRSTPASS THEN                                                   00246000
         BEGIN                                                          00247000
              IF INX.TYPE ! TYPEREFERENCED THEN                         00248000
                   LABLS[INX.LABLINDEX]:=REAL(BOOLEAN(INX &             00249000
                            (TYPELABLERROR)TYPE) OR TRUE)               00250000
              ELSE                                                      00251000
                   BEGIN                                                00252000
                        LABLS[INX.LABLINDEX]:=INX & (TYPELABL)TYPE;     00253000
                        LABLUSE[INX.LABLINDEX]:=LABLUSE[INX.LABLINDEX] &00254000
                                          LOC.ADDRESS PHYSICALADDRESS;  00255000
                   END                                                  00256000
         END                                                            00257000
    ELSE                                                                00258000
         IF LASTPASS THEN                                               00259000
              BEGIN                                                     00260000
                   SKIPLINE;                                            00261000
                   IF LABLUSE[INX.LABLINDEX].PHYSICALADDRESS !          00262000
                       LOC.ADDRESS OR INX.TYPE ! TYPELABL THEN          00263000
                     BEGIN                                              00264000
                          ERR(8);                                       00265000
                          IF INX.TYPE ! TYPELABLERROR THEN              00266000
                          LABLS[INX.LABLINDEX]:=REAL(BOOLEAN(INX &      00267000
                                 (TYPELABLERROR)TYPE) AND NOT TRUE);    00268000
                     END                                                00269000
              END                                                       00270000
     ELSE                                                               00271000
          LABLUSE[INX.LABLINDEX].PHYSICALADDRESS:=LOC;                  00272000
%                                                                       00273000
%                                                                       00274000
%         LAB IS A MEANS OF REFERENCING LABL[INX] SO                    00275000
%         THAT ITS ADDRESS CAN BE USED IN GENERATING                    00276000
%         CODE                                                          00277000
%                                                                       00278000
REAL PROCEDURE LAB(INX);                                                00279000
    VALUE INX;                                                          00280000
    REAL INX;                                                           00281000
    IF LASTPASS THEN                                                    00282000
    BEGIN                                                               00283000
         LAB:=LABLS[INX]                                                00284000
    END                                                                 00285000
    ELSE                                                                00286000
    BEGIN                                                               00287000
         LABLUSE[INX]:=LABLUSE[INX] & (1)[47-LOC.[33:5]:47:1];          00288000
         LAB:=LABLARRAY[INX];                                           00289000
    END OF LAB;                                                         00290000
%                                                                       00291000
%                                                                       00292000
%         STORAGE DECLARES STORAGE AREAS OF NUMBER ELEMENTS             00293000
%         OF SIZE SZ WITH INITIAL VALUES IF LITVAL, AND                 00294000
%         A BASE ADDRESS AT LABL[INX]                                   00295000
%                                                                       00296000
PROCEDURE STORAGE(INX,LITVAL,SZ,NUMBER);                                00297000
    VALUE INX,LITVAL,SZ,NUMBER;                                         00298000
    INTEGER INX,LITVAL,SZ,NUMBER;                                       00299000
    BEGIN                                                               00300000
    IF INX ! 0 THEN LABL(INX);                                          00301000
    FOR INX:=1 STEP 1 UNTIL NUMBER DO                                   00302000
         IF LASTPASS THEN                                               00303000
              EMIT(LITVAL,IF SZ = 0 THEN PRECISION ELSE SZ,LITPRINT)    00304000
         ELSE  LOC:=LOC+(IF SZ = 0 THEN PRECISION ELSE SZ);             00305000
    END OF STORAGE;                                                     00306000
%                                                                       00307000
%                                                                       00308000
%         LIT ALLOWS ONE TO REFERENCE A LITERAL WITHOUT                 00309000
%         RESERVING A LOCATION AND STORING IT THERE.                    00310000
%         ATTEMPTS ARE MADE TO OPTIMIZE THE USE OF                      00311000
%         MEMORY                                                        00312000
%                                                                       00313000
REAL PROCEDURE LIT(VAL);                                                00314000
    VALUE VAL;                                                          00315000
    REAL VAL;                                                           00316000
    BEGIN                                                               00317000
         LABEL FOUND;                                                   00318000
    FOR I:=0 STEP 1 WHILE I < NEXTPOOL DO                               00319000
    IF POOL[I] = VAL THEN GO TO FOUND;                                  00320000
    IF LASTPASS THEN FLAG(256);                                         00321000
    POOL[NEXTPOOL]:=VAL;                                                00322000
    NEXTPOOL:=NEXTPOOL+1;                                               00323000
FOUND:   IF LASTPASS THEN                                               00324000
         LIT := (VAL := POOLADDRESS[I]).ADDRESS + VAL.SIZE - PRECISION  00325000
    ELSE                                                                00326000
    BEGIN                                                               00327000
         POOLUSE[I]:=POOLUSE[I] & (1)[47-LOC.[33:5]:47:1];              00328000
         POOLADDRESS[I]:=POOLADDRESS[I] & (1)[PRECISIONUSEDS+4-PRECISION00329000
                                              :47:1];                   00330000
    END;                                                                00331000
    END OF LIT;                                                         00332000
%                                                                       00333000
%         HEX RETURNS THE HEX REPRESENTATION OF THE RIGHT HALF          00334000
%         OF N                                                          00335000
%                                                                       00336000
REAL PROCEDURE HEX(N);   VALUE N; REAL N;                               00337000
    HEX:=REAL(BOOLEAN(                                                  00338000
         (N:=N.[44:4] & N[38:40:4] & N[32:36:4] & N[26:32:4] &          00339000
             N[20:28:4] & N[14:24:4]) + "666666")                       00340000
             AND BOOLEAN("++++++")).[12:32] | 7 + N;                    00341000
%                                                                       00342000
%                                                                       00343000
%         CLEAN CLEARS THE ARRAY POINTED TO BY DEST TO BLANKS           00344000
%         FOR 15 WORDS                                                  00345000
%                                                                       00346000
STREAM PROCEDURE CLEAN(DEST);                                           00347000
    BEGIN                                                               00348000
         DI:=DEST;  DS:= 8 LIT " ";                                     00349000
         SI:=DEST;   DS:= 14 WDS;                                       00350000
    END;                                                                00351000
%                                                                       00352000
%                                                                       00353000
%         OUTPUT FORMATS INFORMATION IN BUFF.  CONTAINED IS THE         00354000
%         INSTRUCTION COUNTER(LOCATION)  THE QUANTITY(WHAT) OF SIZE     00355000
%         SZ AND THE TEXT POINTER TO BY TP IS COPIED FOR 7|SIZE         00356000
%         CHARACTERS.   THIS PROCEDURE IS USED FOR FORMATING LINE       00357000
%         PRINTER OUTPUT.                                               00358000
%                                                                       00359000
STREAM PROCEDURE OUTPUT(BUFF,LOCATION,WHAT,SZ,TP,SIZE);                 00360000
    VALUE LOCATION,WHAT,SZ,SIZE;                                        00361000
    BEGIN                                                               00362000
              LOCAL T;                                                  00363000
             LABEL L1,L2;                                               00364000
        DI:=BUFF;   DI:=DI+5;                                           00365000
        SI:=LOC LOCATION;   SI:=SI+4;                                   00366000
        DS:=4 CHR;                                                      00367000
        DI:=DI+4;   SI:=LOC SZ;                                         00368000
        SI:=SI-SZ;   SI:=SI-SZ;                                         00369000
        TALLY:=4;   SZ(TALLY:=TALLY+63);                                00370000
        T:=TALLY;                                                       00371000
        DI:=DI+T;   DI:=DI+T;                                           00372000
        DS:=SZ CHR;   DS:=SZ CHR;                                       00373000
        CI:=CI+SIZE;                                                    00374000
        GO TO L1;                                                       00375000
        GO TO L2;                                                       00376000
        GO TO L2;                                                       00377000
        GO TO L2;                                                       00378000
    L2: DI:=DI+10;   SI:=TP;                                            00379000
        SIZE(SI:=SI+1;   DS:=7 CHR);                                    00380000
    L1:                                                                 00381000
    END;                                                                00382000
%                                                                       00383000
%                                                                       00384000
%         COPY MOVES STUFF TO BUFF ACCORDING TO TYP.  THIS IS USED      00385000
%         FORMAT MISCELLANEOUS OUTPUT TO THE PRINTER.                   00386000
%                                                                       00387000
STREAM PROCEDURE COPY(DEST,STUFF,TYP);                                  00388000
    VALUE STUFF,TYP;                                                    00389000
    BEGIN                                                               00390000
         LABEL T0,T1,T2,T3,EXIT;                                        00391000
    DI:=DEST;   SI:=LOC STUFF;                                          00392000
    CI:=CI+TYP;                                                         00393000
    GO TO T0;                                                           00394000
    GO TO T1;                                                           00395000
    GO TO T2;                                                           00396000
    GO TO T3;                                                           00397000
T0: SI:=SI+4;   DI:=DI+3;   DS:= 4 CHR;   GO TO EXIT;                   00398000
T1: SI:=SI+5;   DI:=DI+4;   DS:= 3 CHR;   GO TO EXIT;                   00399000
T2: SI:=SI+6;   DI:=DI+5;   DS:= 2 CHR;   GO TO EXIT;                   00400000
T3: SI:=SI+1;   DS:= 7 CHR;   GO TO EXIT;                               00401000
EXIT:                                                                   00402000
    END;                                                                00403000
%                                                                       00404000
%                                                                       00405000
%         PRINTREG PRINTS THE REGISTERS USED IN TWO BYTE OPERATIONS     00406000
%         THAT INVOLVE REGISTER TO REGISTER OPERATIONS.  THE MODE IS    00407000
%         TAKEN INTO ACCOUNT IN INKIT THE REGISTER, SO THAT ONE WILL    00408000
%         KNOW WHAT ACTUAL REGISTER IS BEING REFERENCED.                00409000
%                                                                       00410000
PROCEDURE PRINTREG(VAL);                                                00411000
    VALUE VAL;                                                          00412000
    REAL VAL;                                                           00413000
    BEGIN                                                               00414000
         COPY(LBUFF[8],TEXTARRAY[2,REGBASE+(VAL MOD 16)],3);            00415000
         COPY(LBUFF[7],TEXTARRAY[2,REGBASE+(VAL DIV 16)],3);            00416000
    END;                                                                00417000
%                                                                       00418000
%                                                                       00419000
%         PRINTADDRESS PRINTS THE ADDRESS USED BY AN OPERATOR OF        00420000
%         SIZE SZ AND OPERATION CODE OF WHAT.                           00421000
%                                                                       00422000
PROCEDURE PRINTADDRESS(WHAT,SZ);                                        00423000
    VALUE WHAT,SZ;                                                      00424000
    REAL WHAT,SZ;                                                       00425000
BEGIN                                                                   00426000
    IF SZ = 3 THEN COPY(LBUFF[7],HEX(WHAT),0)                           00427000
         ELSE                                                           00428000
           COPY(LBUFF[7],HEX(IF BOOLEAN(WHAT.[35:1]) THEN WHAT.[38:10]  00429000
                     ELSE WHAT.[36:12]),1);                             00430000
END;                                                                    00431000
%                                                                       00432000
%                                                                       00433000
%         COPYTEXT MOVES SZ WORDS (7 CHAR/WORD) FROM SOURCE             00434000
%         TO DEXT.                                                      00435000
%                                                                       00436000
STREAM PROCEDURE COPYTEXT(DEST,SOURCE,SZ);                              00437000
    VALUE SZ;                                                           00438000
    BEGIN                                                               00439000
         SI:=SOURCE;   DI:=DEST;                                        00440000
         SZ(SI:=SI+1;   DS:=7 CHR);                                     00441000
    END;                                                                00442000
%                                                                       00443000
%                                                                       00444000
%         LOOKUP RETURNS INFORMATION ABOUT OPERATION CODE WHAT OF       00445000
%         WHAT AND SIZE SZ SO THAT PRINTER OUTPUT CAN BE MADE.          00446000
%                                                                       00447000
REAL PROCEDURE LOOKUP(WHAT,SZ);                                         00448000
    VALUE WHAT,SZ;                                                      00449000
    REAL WHAT,SZ;                                                       00450000
    BEGIN                                                               00451000
%                                                                       00452000
%    RESULTS                                                            00453000
%         WORD INDEX           [40:8]                                   00454000
%         ROW INDEX            [37:3]                                   00455000
%         SZ                   [34:3]                                   00456000
%         REGISTERS            [16:8]                                   00457000
%                                                                       00458000
         REAL SCRATCH;                                                  00459000
         LABEL ONE,TWO,THREE,L1,L2,L3,L4,LL,LL1,LL2,LL3,LL4,LLL,EXIT;   00460000
         SWITCH S:=ONE,TWO,THREE;                                       00461000
         SWITCH SS:=L1,L2,L3,L4;                                        00462000
         SWITCH SSS:=LL1,LL2,LL3,LL4;                                   00463000
         GO TO S[SZ];                                                   00464000
ONE:     LOOKUP:=WHAT+WHAT+4096;     GO TO EXIT;                        00465000
THREE:   LOOKUP:=(2|WHAT.[24:8])&255[16:40:8] & (2)[34:3];              00466000
         GO TO EXIT;                                                    00467000
TWO:     IF SZ:=WHAT.[32:8] LSS 48 OR SZ GTR 51 THEN                    00468000
              LOOKUP:=(SZ+SZ).[40:8] &                                  00469000
                         (SZ+SZ)[39:39:1] & (2)[34:45:3] &              00470000
                   (IF SZ GEQ 64 THEN 255 ELSE WHAT.[40:8])[16:40:8]    00471000
         ELSE                                                           00472000
         BEGIN                                                          00473000
              GO TO SS[SZ-47];                                          00474000
         L1:  SCRATCH:=OUTPOINTER[WHAT.[40:8] DIV 4];      GO TO LL;    00475000
         L2:  SCRATCH:=INPOINTER[WHAT.[40:8] DIV 4];       GO TO LL;    00476000
         L3:  SCRATCH:=SENARRAY[WHAT.[40:8] DIV 4];        GO TO LL;    00477000
         L4:  SCRATCH:=FUNARRAY[WHAT.[40:8] DIV 4];                     00478000
         LL:  GO TO SSS[WHAT.[40:8] MOD 4 + 1];                         00479000
         LL1: SCRATCH:=3|(SCRATCH.[1:11]);      GO TO LLL;              00480000
         LL2: SCRATCH:=3|(SCRATCH.[12:12]);     GO TO LLL;              00481000
         LL3: SCRATCH:=3|(SCRATCH.[24:12]);     GO TO LLL;              00482000
         LL4: SCRATCH:=3|(SCRATCH.[36:12]);     GO TO LLL;              00483000
         LLL: LOOKUP:=ENTIER(SCRATCH MOD 192)                           00484000
                          & ((SCRATCH DIV 192)+2)[37:45:3]              00485000
                          & (3)[34:45:3];                               00486000
         END;                                                           00487000
EXIT:                                                                   00488000
    END OF LOOKUP;                                                      00489000
%                                                                       00490000
%                                                                       00491000
%         INKIT PRINTS WHAT OF SIZE SZ ACCORDING TO                     00492000
%         THE INSTRUCTIONS IN FORM.                                     00493000
%         THIS IS THE PLACE WHERE THE ACTUAL LINE PRINTING IS DONE      00494000
%                                                                       00495000
PROCEDURE INKIT(WHAT,SZ,FORM,LC);                                       00496000
    VALUE WHAT,SZ,FORM,LC;                                              00497000
    REAL WHAT,SZ,FORM,LC;                                               00498000
    IF LISTING THEN                                                     00499000
    BEGIN                                                               00500000
         INTEGER RSLT;                                                  00501000
         LABEL LIT,PASS,OP,HEADING,ERRS,EXIT,SPECIAL,L1,L2,L3,L4,STOP;  00502000
         SWITCH S := LIT,EXIT,OP,EXIT,PASS,ERRS,SPECIAL,EXIT;           00503000
         SWITCH SS:=L1,L2,L3,L4;                                        00504000
%                                                                       00505000
         GO TO S[FORM+1];                                               00506000
LIT:     OUTPUT(LBUFF[0],HEX(LOC),                                      00507000
                 IF SZ = 4 THEN HEX(WHAT)&HEX(WHAT.[16:8])[1:37:11]     00508000
                     ELSE HEX(WHAT),SZ,TEXTARRAY[0,0],0);               00509000
         GO TO PASS;                                                    00510000
OP:      OUTPUT(LBUFF[0],HEX(LOC),HEX(WHAT),SZ,                         00511000
                    TEXTARRAY[(RSLT:=LOOKUP(WHAT,SZ)).[37:3],           00512000
                       RSLT.[40:8]],RSLT.[34:3]);                       00513000
         IF RSLT.[16:8] ! 0 THEN                                        00514000
              IF RSLT.[16:8] = 255 THEN PRINTADDRESS(WHAT,SZ)           00515000
                   ELSE PRINTREG(RSLT.[16:8]);                          00516000
         IF ERRORNUMBER = 0 THEN GO TO PASS;                            00517000
         WRITE(LINE,15,LBUFF[*]);                                       00518000
         CLEARLINE;                                                     00519000
ERRS:    FOR I:=0 STEP 1 UNTIL ERRORMAX DO                              00520000
         BEGIN                                                          00521000
              IF BOOLEAN(ERRORNUMBER) THEN                              00522000
              BEGIN                                                     00523000
                   COPYTEXT(LBUFF[9],TEXTARRAY[ERROW,ERRBASE+ERRSIZE|I],00524000
                              ERRSIZE);                                 00525000
                   WRITE(LINE,15,LBUFF[*]);                             00526000
              END;                                                      00527000
              IF ERRORNUMBER:=ERRORNUMBER DIV 2 = 0 THEN GO TO STOP;    00528000
         END;                                                           00529000
         ERRORNUMBER:=0;                                                00530000
STOP:    CLEARLINE;                                                     00531000
         GO TO EXIT;                                                    00532000
SPECIAL: GO TO SS[SZ];                                                  00533000
    L1:  WRITE(LINE[PAGE]);     GO TO EXIT;                             00534000
    L2:  WRITE(LINE[DBL]);      GO TO EXIT;                             00535000
    L3:  WRITE(LINE);           GO TO EXIT;                             00536000
    L4:  COPYTEXT(LBUFF[0],STARSFORM,17);                               00537000
PASS:    WRITE(LINE,15,LBUFF[*]);                                       00538000
         CLEARLINE;                                                     00539000
EXIT:                                                                   00540000
    END OF INKIT;                                                       00541000
%                                                                       00542000
%                                                                       00543000
%         HEADING IS USED TO PRINT HEADINGS ON OUTPUT LISTINGS.         00544000
%                                                                       00545000
PROCEDURE HEADING(A1,A2,A3,A4,A5);                                      00546000
    VALUE A1,A2,A3,A4,A5;                                               00547000
    REAL  A1,A2,A3,A4,A5;                                               00548000
    BEGIN                                                               00549000
%                                                                       00550000
         COPYTEXT(LBUFF[1],A1,A5);                                      00551000
         INKIT(0,0,4,0);                                                00552000
%                                                                       00553000
    END OF HEADING;                                                     00554000
%                                                                       00555000
%                                                                       00556000
%         MOVE IS USED BY THE EMITTER TO PLACE INFORMATION IN THE       00557000
%         CODE FILE.  STUFF OF LENGTH TYPE+1 IS PLACED IN WORD          00558000
%         BEGINNING AT BYTE DTYPE.                                      00559000
%                                                                       00560000
STREAM PROCEDURE MOVE(STUFF,TYP,WORD,DTYPE);                            00561000
    VALUE STUFF,TYP,DTYPE;                                              00562000
    BEGIN                                                               00563000
         LABEL L1,L2,L3,L4,LF,D2,D3,D4,D5,D22,D44,DF,T1,T2,T3,FIN;      00564000
    SI:=LOC STUFF;                                                      00565000
    CI:=CI+TYP;                                                         00566000
    GO TO L1;                                                           00567000
    GO TO L2;                                                           00568000
    GO TO L3;                                                           00569000
    SI:=SI+2;   GO TO L4;                                               00570000
L1: SI:=SI+6;   GO TO L4;                                               00571000
L2: SI:=SI+5;   SKIP 2 SB;   GO TO LF;                                  00572000
L3: SI:=SI+4;   GO TO LF;                                               00573000
L4: SKIP 4 SB;                                                          00574000
LF:                                                                     00575000
    DI:=WORD;                                                           00576000
    CI:=CI+DTYPE;                                                       00577000
    GO TO DF;                                                           00578000
    GO TO D2;                                                           00579000
    GO TO D3;                                                           00580000
    GO TO D4;                                                           00581000
    GO TO D5;                                                           00582000
    DI:=DI+6;   GO TO D44;                                              00583000
D2: DI:=DI+1;   GO TO D22;                                              00584000
D3: DI:=DI+2;   GO TO D44;                                              00585000
D4: DI:=DI+4;   GO TO DF;                                               00586000
D5: DI:=DI+5;                                                           00587000
D22: SKIP 2 DB;   GO TO DF;                                             00588000
D44: SKIP 4 DB;                                                         00589000
DF:                                                                     00590000
    CI:=CI+TYP;                                                         00591000
    GO TO T1;                                                           00592000
    GO TO T2;                                                           00593000
    GO TO T3;                                                           00594000
    32(IF SB THEN DS:=1 SET ELSE DS:=1 RESET; SKIP 1 SB); GO TO FIN;    00595000
T1:  8(IF SB THEN DS:=1 SET ELSE DS:=1 RESET; SKIP 1 SB); GO TO FIN;    00596000
T2: 16(IF SB THEN DS:=1 SET ELSE DS:=1 RESET; SKIP 1 SB); GO TO FIN;    00597000
T3: 24(IF SB THEN DS:=1 SET ELSE DS:=1 RESET; SKIP 1 SB); GO TO FIN;    00598000
FIN:                                                                    00599000
    END OF MOVE;                                                        00600000
%                                                                       00601000
%                                                                       00602000
%         SMASH IS USED BY WRITERECORD TO CLEAN UP THE CODEARRAY        00603000
%         AFTER A RECORD HAS BEEN WRITEN TO DISK.                       00604000
%                                                                       00605000
STREAM PROCEDURE SMASH(A,B);                                            00606000
    BEGIN                                                               00607000
    DI:=A;   SI:=B;   DS:=1 WDS;   B:=DI;                               00608000
    DS:=8 LIT "0";   SI:=B;   DS:=58 WDS;                               00609000
    END;                                                                00610000
%                                                                       00611000
%                                                                       00612000
%         WRITERECORD IS USED TO WRITE THE CURRENT CODEARRAY TO         00613000
%         DISK.  NOTE THAT THE WRITE IS ONLY DONE OF ANY CODE HAS       00614000
%         BEEN PUT INTO CODEARRAY SINCE THE LAST CALL ON WRITERECORD.   00615000
%                                                                       00616000
PROCEDURE WRITERECORD;                                                  00617000
    IF CODEINX ! 0 THEN                                                 00618000
         BEGIN                                                          00619000
         LASTCODEINX:=CODEINX;                                          00620000
         RECORDS:=RECORDS + 1;                                          00621000
         WRITE(CODE,60,CODEARRAY[*]);                                   00622000
         SMASH(CODEARRAY[0],CODEARRAY[60]);                             00623000
         CODEINX:=IF CODEINX LSS 360 THEN 0 ELSE CODEINX-360;           00624000
         END;                                                           00625000
%                                                                       00626000
%                                                                       00627000
%         EMIT COPIES NUMBER BYTES OF INFORMATION FROM VAL TO           00628000
%         THE CODEARRAY, AND PRINTS A MESSAGE ACCORDING TO TYP.         00629000
%                                                                       00630000
PROCEDURE EMIT(VAL,NUMBER,TYP);                                         00631000
    VALUE VAL,NUMBER,TYP;                                               00632000
    REAL VAL,NUMBER,TYP;                                                00633000
    IF LASTPASS THEN                                                    00634000
    BEGIN                                                               00635000
        MOVE(VAL,NUMBER-1,CODEARRAY[CODEINX DIV 6],                     00636000
             ENTIER(CODEINX MOD 6));                                    00637000
        IF (CODEINX:=CODEINX+NUMBER) GEQ 360 THEN WRITERECORD;          00638000
        IF LISTING THEN INKIT(VAL,NUMBER,TYP,0);                        00639000
        LOC:=LOC+NUMBER;                                                00640000
    END                                                                 00641000
    ELSE LOC:=LOC+NUMBER;                                               00642000
%                                                                       00643000
%         EMITCONSTANT EMITS A LITERAL OF SIZE SZ WITH THE VALUE N      00644000
%         AT THE PRESENT POSITION OF LOC.                               00645000
%                                                                       00646000
PROCEDURE EMITCONSTANT(N,SZ);                                           00647000
    VALUE N,SZ;                                                         00648000
         REAL N,SZ;                                                     00649000
    IF N < 0 THEN                                                       00650000
         EMIT((REAL(NOT BOOLEAN(N)).[16:32] + 1),SZ,LITPRINT)           00651000
    ELSE                                                                00652000
         EMIT(N,SZ,LITPRINT);                                           00653000
%                                                                       00654000
%         PUNCHER PUNCHES A BCL DECK IN THE FORM EXPECTED BY THE        00655000
%         BCL CARD LOADER.                                              00656000
%                                                                       00657000
PROCEDURE PUNCHER;                                                      00658000
    BEGIN                                                               00659000
         FILE PUNCH 0 (2,10);                                           00660000
         SAVE ARRAY I[0:59],O[0:79],TEMP[0:4];                          00661000
         INTEGER OP,IP,SCRATCH,RC,IPL;                                  00662000
         REAL BCC;                                                      00663000
         BOOLEAN TOG;                                                   00664000
         LABEL ENTR;                                                    00665000
         ARRAY PUNCHCODE[0:7];                                          00666000
%                                                                       00667000
    STREAM PROCEDURE TRANSFER(S,SD,D,DD,N);                             00668000
    VALUE SD,DD,N;                                                      00669000
    BEGIN                                                               00670000
         SI:=S;                                                         00671000
         SKIP SD SB;                                                    00672000
         DI:=D;                                                         00673000
         SKIP DD DB;                                                    00674000
%                                                                       00675000
         N(8( IF SB THEN DS:= 1 SET ELSE DS:= 1 RESET;  SKIP 1 SB;););  00676000
%                                                                       00677000
    END;                                                                00678000
%                                                                       00679000
    STREAM PROCEDURE UNPACK(S,D);                                       00680000
    BEGIN                                                               00681000
         SI:=S;                                                         00682000
         DI:=D;                                                         00683000
%                                                                       00684000
         2(40( DS:= 7 LIT "0";  DS:= 3 RESET;                           00685000
              3(IF SB THEN DS:= 1 SET ELSE DS:= 1 RESET;                00686000
                   SKIP 1 SB;);););                                     00687000
%                                                                       00688000
    END;                                                                00689000
%                                                                       00690000
%                                                                       00691000
    STREAM PROCEDURE PACK(A);                                           00692000
    BEGIN                                                               00693000
         SI:=A;                                                         00694000
         DI:=A;                                                         00695000
         2(40(SI:=SI + 7;   DS:= 1 CHR;););                             00696000
    END;                                                                00697000
%                                                                       00698000
    FILL PUNCHCODE[*] WITH " ","8","2",OCT14,"0","Y","S","!";           00699000
    CODE.AREAS := 0;                                                    00700000
    CODE.AREASIZE := 0;                                                 00701000
         SEARCH(CODE,I[*]);                                             00702000
         READ(CODE [I[5]],2,I[*]);                                      00703000
         LASTCODEINX := I[0];                                           00704000
         RECORDS := I[1];                                               00705000
         READ(CODE[0],0,I[*]);                                          00706000
%                                                                       00707000
    IP := IPL := 360;                                                   00708000
    LOC := 0;                                                           00709000
         GO TO ENTR;                                                    00710000
    DO                                                                  00711000
    BEGIN                                                               00712000
         IF OP < 30 THEN                                                00713000
              BEGIN                                                     00714000
                   IF OP = 0 THEN                                       00715000
                        BEGIN                                           00716000
                             OP := 3;                                   00717000
                             TRANSFER(LOC,32,TEMP,0,2);                 00718000
                        END;                                            00719000
                   IF IP GEQ IPL THEN                                   00720000
                        BEGIN                                           00721000
                             READ(CODE,60,I[*]);                        00722000
                             IP := 0;                                   00723000
                             IF (RC := RC + 1) = RECORDS THEN           00724000
                                  IPL := LASTCODEINX;                   00725000
                        END;                                            00726000
                   TRANSFER(I[IP DIV 6],ENTIER((8 | IP) MOD 48),        00727000
                        TEMP[OP DIV 6],ENTIER((8 | OP) MOD 48),         00728000
                        SCRATCH:=MIN(30 - OP,IPL - IP));                00729000
                   IP := IP + SCRATCH;                                  00730000
                   OP := OP + SCRATCH;                                  00731000
                   LOC := LOC + SCRATCH;                                00732000
              END                                                       00733000
         ELSE                                                           00734000
              BEGIN                                                     00735000
ENTR:              UNPACK(TEMP,O);                                      00736000
                   FOR SCRATCH := 0 STEP 1 UNTIL 79 DO                  00737000
                        BEGIN                                           00738000
                             BCC := REAL(NOT BOOLEAN(BCC) EQV           00739000
                                  BOOLEAN(O[SCRATCH]));                 00740000
                             O[SCRATCH] := PUNCHCODE[O[SCRATCH]];       00741000
                        END;                                            00742000
                   O[7] := PUNCHCODE[BCC.[45:3]];                       00743000
                   PACK(O);                                             00744000
                   WRITE(PUNCH,10,O[*]);                                00745000
                   BCC := OP := 0;                                      00746000
                   FOR SCRATCH := 0 STEP 1 UNTIL 79 DO O[SCRATCH] := 0; 00747000
                   FOR SCRATCH:=0 STEP 1 UNTIL 4 DO TEMP[SCRATCH] := 0; 00748000
              END;                                                      00749000
    END UNTIL RC = RECORDS AND IP GEQ IPL;                              00750000
%                                                                       00751000
    IF TOG := NOT TOG THEN GO TO ENTR;                                  00752000
%                                                                       00753000
    END OF PUNCHER;                                                     00754000
%                                                                       00755000
%         RE FORMATS THE OPCODE FOR AN OPERATOR OF TYPE OP USING        00756000
%         REGISTERS A AND B AS SOURCE AND DESTINATION.                  00757000
%                                                                       00758000
REAL PROCEDURE RE(OP,A,B);                                              00759000
    VALUE OP,A,B;                                                       00760000
    REAL OP,A,B;                                                        00761000
%                                                                       00762000
    BEGIN                                                               00763000
         IF A.TYPE ! TYPEREGISTER THEN                                  00764000
              BEGIN                                                     00765000
                   FLAG(64);                                            00766000
                   A:=0;                                                00767000
              END;                                                      00768000
         IF B.TYPE ! TYPEREGISTER THEN                                  00769000
              BEGIN                                                     00770000
                   FLAG(64);                                            00771000
                   B:=0;                                                00772000
              END;                                                      00773000
         RE:=B & A[40:4] & OP[32:8];                                    00774000
    END OF RE;                                                          00775000
%                                                                       00776000
%         DREDGER ACCEPTS A DESCRIPTOR(DE) AND A TYPE(FORM) AND         00777000
%         RETURNS AN ADDRESS.                                           00778000
%                                                                       00779000
REAL PROCEDURE DREDGER(DE,FORM);                                        00780000
    VALUE DE,FORM;                                                      00781000
    REAL DE,FORM;                                                       00782000
%                                                                       00783000
    CASE FORM OF                                                        00784000
    BEGIN                                                               00785000
%                                                                       00786000
    IF DE.TYPE = 0 THEN DREDGER:=LIT(DE).[36:12]                        00787000
    ELSE                                                                00788000
    IF DE.TYPE = TYPELABL THEN                                          00789000
         IF DE.ADDRESS = LABLS[FORM:=DE.LABLINDEX].ADDRESS THEN         00790000
              BEGIN                                                     00791000
                   IF DE.SECTOR LSS 4 THEN                              00792000
                        DREDGER:=(IF DE.ADDRESS = LABLUSE[FORM].        00793000
                                                 PHYSICALADDRESS THEN   00794000
                                  DE.[36:12] ELSE (LABLUSE[FORM].       00795000
                                               PHYSICALADDRESS).[36:12])00796000
                   ELSE                                                 00797000
                   IF DE.SECTOR = LOC.[33:5] AND LOC.[40:8] ! 255 THEN  00798000
                        DREDGER:=4096 + (LABLUSE[DE.LABLINDEX]          00799000
                                    .PHYSICALADDRESS).[38:10]           00800000
                   ELSE                                                 00801000
                   BEGIN                                                00802000
                        DREDGER:=7168 + DE.[38:10];                     00803000
                        L[1,DE] := L[1,DE] & (1)[SECTORUSEMASKS:47:1];  00804000
                   END;                                                 00805000
              END                                                       00806000
         ELSE                                                           00807000
              BEGIN                                                     00808000
                   FORM:=DE.ADDRESS-LABLS[DE.LABLINDEX].ADDRESS;        00809000
                   IF (JUNK:=LABLUSE[DE.LABLINDEX].PHYSICALADDRESS)     00810000
                      + FORM < 4096 THEN                                00811000
                        DREDGER:=JUNK+FORM                              00812000
                   ELSE                                                 00813000
                   IF (JUNK + FORM).[33:5] = LOC.[33:5] THEN            00814000
                        DREDGER:= 4096 + (JUNK + FORM).[38:10]          00815000
                   ELSE FLAG(512);                                      00816000
              END                                                       00817000
    ELSE                                                                00818000
    IF DE.TYPE = USEIT THEN DREDGER:=DE.[36:12] ELSE                    00819000
    IF DE.TYPE ! TYPELABLERROR THEN FLAG(2) ELSE                        00820000
    IF BOOLEAN(DE) THEN FLAG(1) ELSE FLAG(4);                           00821000
%                                                                       00822000
    IF DE.TYPE = TYPELABL THEN                                          00823000
         IF DE.ADDRESS = LABLS[DE.LABLINDEX].ADDRESS THEN               00824000
              BEGIN                                                     00825000
                   IF DE.SECTOR LSS 4 THEN                              00826000
                        DREDGER := (IF DE.SIZE LSS 4 THEN DE ELSE       00827000
                                       LABLUSE[DE.LABLINDEX].           00828000
                                       PHYSICALADDRESS).[36:12]         00829000
                   ELSE                                                 00830000
                   IF DE.SECTOR = LOC.[33:5] AND LOC.[40:8] ! 255 THEN  00831000
                        DREDGER:=4096 + (LABLUSE[DE.LABLINDEX]          00832000
                                    .PHYSICALADDRESS).[38:10]           00833000
                   ELSE                                                 00834000
                   BEGIN                                                00835000
                        DREDGER := 7168 + DE.[38:10];                   00836000
                        L[1,DE.LABLINDEX] := L[1,DE.LABLINDEX] &        00837000
                                  (1)[SECTORUSEMASKS:47:1];             00838000
                   END;                                                 00839000
              END                                                       00840000
         ELSE                                                           00841000
              BEGIN                                                     00842000
                   FORM:=DE.ADDRESS-LABLS[DE.LABLINDEX].ADDRESS;        00843000
                   IF (JUNK:=LABLUSE[DE.LABLINDEX].PHYSICALADDRESS)     00844000
                      + FORM < 4096 THEN                                00845000
                        DREDGER:=JUNK+FORM                              00846000
                   ELSE                                                 00847000
                   IF (JUNK + FORM).[33:5] = LOC.[33:5] THEN            00848000
                        DREDGER:= 4096 + (JUNK + FORM).[38:10]          00849000
                  ELSE BEGIN  II := PRECISION;   PRECISION := 2;        00850000
                              DREDGER := 7168 + LIT(DE.ADDRESS);        00851000
                              PRECISION := II;     END;                 00852000
              END                                                       00853000
    ELSE                                                                00854000
    IF DE.TYPE ! TYPELABLERROR THEN FLAG(2) ELSE                        00855000
    IF BOOLEAN(DE) THEN FLAG(1) ELSE FLAG(4);                           00856000
%                                                                       00857000
    IF DE.TYPE = TYPELABL THEN                                          00858000
         DREDGER:=(LABLUSE[DE.LABLINDEX].PHYSICALADDRESS) +             00859000
                  (IF DE.ADDRESS = LABLS[DE.LABLINDEX].ADDRESS THEN 0   00860000
                    ELSE DE.ADDRESS - LABLS[DE.LABLINDEX].ADDRESS)      00861000
    ELSE                                                                00862000
    IF DE.TYPE = 0 THEN DREDGER:=DE.[38:10] ELSE                        00863000
    IF DE.TYPE ! TYPELABLERROR THEN FLAG(2) ELSE                        00864000
    IF BOOLEAN(DE) THEN FLAG(1) ELSE FLAG(4);                           00865000
%                                                                       00866000
    IF DE.TYPE = TYPELABL THEN                                          00867000
         IF DE.SECTOR = 0 THEN                                          00868000
              BEGIN                                                     00869000
                   DREDGER:=6144 + (LABLUSE[DE.LABLINDEX]               00870000
                               .PHYSICALADDRESS).[38:10] +              00871000
                               DE.ADDRESS - LABLS[DE.LABLINDEX].ADDRESS;00872000
              END                                                       00873000
         ELSE FLAG(512)                                                 00874000
    ELSE                                                                00875000
    IF DE.TYPE = 0 THEN                                                 00876000
         DREDGER:=6144 + DE.[38:10]                                     00877000
    ELSE                                                                00878000
    FLAG(32);                                                           00879000
%                                                                       00880000
    IF DE.TYPE = TYPELABL THEN                                          00881000
         IF DE.SECTOR = 0 THEN                                          00882000
              DREDGER := 7168 + (LABLUSE[DE.LABLINDEX]                  00883000
                         .PHYSICALADDRESS).[38:10] +                    00884000
                         DE.ADDRESS - LABLS[DE.LABLINDEX].ADDRESS       00885000
         ELSE IF DE.SECTOR = LOC.[33:5] AND LOC.[40:8] ! 255 THEN       00886000
                   DREDGER := 5120 + (LABLUSE[DE.LABLINDEX]             00887000
                              .PHYSICALADDRESS).[38:10] +               00888000
                              DE.ADDRESS - LABLS[DE.LABLINDEX].ADDRESS  00889000
         ELSE                                                           00890000
              BEGIN                                                     00891000
                   DREDGER := 7168 + DE.ADDRESS + 2;                    00892000
                   L[0,DE:=DE.LABLINDEX] := L[0,DE] & (1)[1:47:1];      00893000
              END                                                       00894000
    ELSE                                                                00895000
    IF DE.TYPE = 0 THEN                                                 00896000
         BEGIN                                                          00897000
              IF DE.ADDRESS { 1023 THEN                                 00898000
                   DREDGER := 7168 + DE.ADDRESS                         00899000
              ELSE FLAG(512);                                           00900000
         END                                                            00901000
    ELSE                                                                00902000
    IF DE.TYPE ! TYPELABLERROR THEN FLAG(2) ELSE                        00903000
    IF BOOLEAN(DE) THEN FLAG(1) ELSE FLAG(4);                           00904000
%                                                                       00905000
    END OF DREDGER;                                                     00906000
%                                                                       00907000
%         DES TAKES THE LABL I AND RETURNS THE ADDRESS OF               00908000
%         OF A DESCRIPTOR TO IT.  IF NEED BE, A DESCRIPTOR WILL BE      00909000
%         EMITTED.                                                      00910000
%                                                                       00911000
REAL PROCEDURE DES(I);                                                  00912000
    VALUE I;                                                            00913000
    REAL I;                                                             00914000
    BEGIN                                                               00915000
         IF I.TYPE = 0 THEN                                             00916000
              DES:=I & (USEIT)TYPE                                      00917000
         ELSE                                                           00918000
              IF I.TYPE = TYPELABL THEN                                 00919000
                   BEGIN                                                00920000
                        DES:=I & (USEIT)TYPE;                           00921000
                        LABLS[I.LABLINDEX].[SIZES:1]:=1;                00922000
                   END;                                                 00923000
    END OF DES;                                                         00924000
%                                                                       00925000
%                                                                       00926000
%         DECLARATIONS FOR OPERATORS FOLLOW                             00927000
%                                                                       00928000
DEFINE                                                                  00929000
    E1(I)               =  EMIT(I,1,OPPRINT)#,                          00930000
    E2(I)               =  EMIT(I,2,OPPRINT)#,                          00931000
    E3(I)               =  EMIT(I,3,OPPRINT)#,                          00932000
    HLT                 =  EMIT(0,1,2)#,                                00933000
    CST                 =  EMIT(1,1,2)#,                                00934000
    SOV                 =  EMIT(2,1,2)#,                                00935000
    SOVN                =  EMIT(3,1,2)#,                                00936000
    SOD                 =  EMIT(4,1,2)#,                                00937000
    SODN                =  EMIT(5,1,2)#,                                00938000
    SAN                 =  EMIT(6,1,2)#,                                00939000
    SANN                =  EMIT(7,1,2)#,                                00940000
    SAZ                 =  EMIT(8,1,2)#,                                00941000
    SAZN                =  EMIT(9,1,2)#,                                00942000
    SXZ                 =  EMIT(10,1,2)#,                               00943000
    SXZN                =  EMIT(11,1,2)#,                               00944000
    CLA                 =  EMIT(12,1,2)#,                               00945000
    CMA                 =  EMIT(13,1,2)#,                               00946000
    IAR                 =  EMIT(14,1,2)#,                               00947000
    CIA                 =  EMIT(15,1,2)#,                               00948000
    SP1                 =  EMIT(16,1,2);                                00949000
                           PRECISION:=1#,                               00950000
    SP2                 =  EMIT(17,1,2);                                00951000
                           PRECISION:=2#,                               00952000
    SP3                 =  EMIT(18,1,2);                                00953000
                           PRECISION:=3#,                               00954000
    SP4                 =  EMIT(19,1,2);                                00955000
                           PRECISION:=4#,                               00956000
    SOF                 =  EMIT(20,1,2)#,                               00957000
    ROF                 =  EMIT(21,1,2)#,                               00958000
    NOP                 =  EMIT(22,1,2)#,                               00959000
    IXO                 =  EMIT(23,1,2)#,                               00960000
    SR1                 =  EMIT(24,1,2)#,                               00961000
    SR8                 =  EMIT(25,1,2)#,                               00962000
    RR1                 =  EMIT(26,1,2)#,                               00963000
    RR8                 =  EMIT(27,1,2)#,                               00964000
    SL1                 =  EMIT(28,1,2)#,                               00965000
    SL8                 =  EMIT(29,1,2)#,                               00966000
    RL1                 =  EMIT(30,1,2)#,                               00967000
    RL8                 =  EMIT(31,1,2)#;                               00968000
%                                                                       00969000
PROCEDURE REGOP(I,J,TYP);                                               00970000
         VALUE I,J,TYP;                                                 00971000
         REAL I,J,TYP;                                                  00972000
    EMIT(RE(TYP,I,J),2,2);                                              00973000
%                                                                       00974000
DEFINE                                                                  00975000
%                                                                       00976000
    T(I,J)    =   REGOP(I,J,32)#,                                       00977000
    COMP(I,J) =   REGOP(I,J,33)#,                                       00978000
    INCR(I,J) =   REGOP(I,J,34)#,                                       00979000
    DECR(I,J) =   REGOP(I,J,35)#,                                       00980000
    ANDR(I,J) =   REGOP(I,J,36)#,                                       00981000
    ORR(I,J)  =   REGOP(I,J,37)#,                                       00982000
    EOR(I,J)  =   REGOP(I,J,38)#,                                       00983000
    ADDR(I,J) =   REGOP(I,J,39)#;                                       00984000
%                                                                       00985000
DEFINE                                                                  00986000
    BRM(I)         =  EMIT((DREDGER(I,ABSADDRESS) & (56)[24:8]),3,2)#,  00987000
    CSQ(I)         =  EMIT((DREDGER(I,ABSADDRESS) & (57)[24:8]),3,2)#;  00988000
%                                                                       00989000
DEFINE                                                                  00990000
    STORAGEONLY         =  0#,                                          00991000
    LABLONLY            =  1#,                                          00992000
    ABSADDRESS          =  2#,                                          00993000
    INDEXED             =  3#,                                          00994000
    INDIRECT            =  4#;                                          00995000
%                                                                       00996000
PROCEDURE ADDRESSREF(I,TYP);                                            00997000
         VALUE I,TYP;                                                   00998000
         REAL I,TYP;                                                    00999000
    EMIT((DREDGER(I,STORAGEONLY) & TYP[32:3]),2,2);                     01000000
%                                                                       01001000
PROCEDURE GOTO(I);                                                      01002000
         VALUE I;                                                       01003000
         REAL I;                                                        01004000
    EMIT((DREDGER(I,LABLONLY) & (7)[32:3]),2,2);                        01005000
%                                                                       01006000
PROCEDURE INDADDRESS(I,TYP);                                            01007000
         VALUE I,TYP;                                                   01008000
         REAL I,TYP;                                                    01009000
    EMIT((DREDGER(I,INDIRECT) & TYP[32:3]),2,2);                        01010000
%                                                                       01011000
PROCEDURE INXADDRESS(I,TYP);                                            01012000
         VALUE I,TYP;                                                   01013000
         REAL I,TYP;                                                    01014000
    EMIT((DREDGER(I,INDEXED) & TYP[32:3]),2,2);                         01015000
%                                                                       01016000
DEFINE                                                                  01017000
%                                                                       01018000
    DESC(I)        =   ADDRESSREF(DES(I),2)#,                           01019000
    LOAD(I)        =   ADDRESSREF(I,2)#,                                01020000
    ST(I)          =   ADDRESSREF(I,3)#,                                01021000
    ADD(I)         =   ADDRESSREF(I,4)#,                                01022000
    SUB(I)         =   ADDRESSREF(I,5)#,                                01023000
    ANDM(I)        =   ADDRESSREF(I,6)#,                                01024000
%                                                                       01025000
    LOADX(I)        =   INXADDRESS(I,2)#,                               01026000
    STX(I)          =   INXADDRESS(I,3)#,                               01027000
    ADDX(I)         =   INXADDRESS(I,4)#,                               01028000
    SUBX(I)         =   INXADDRESS(I,5)#,                               01029000
    ANDX(I)         =   INXADDRESS(I,6)#,                               01030000
    GOTOX(I)        =   INXADDRESS(I,7)#,                               01031000
%                                                                       01032000
    LOADIND(I)     =   INDADDRESS(I,2)#,                                01033000
    STIND(I)       =   INDADDRESS(I,3)#,                                01034000
    ADDIND(I)      =   INDADDRESS(I,4)#,                                01035000
    SUBIND(I)      =   INDADDRESS(I,5)#,                                01036000
    ANDIND(I)      =   INDADDRESS(I,6)#,                                01037000
    GOTOIND(I)     =   INDADDRESS(I,7)#;                                01038000
%                                                                       01039000
DEFINE                                                                  01040000
    TH                  =  12288#,                                      01041000
    TH1                 =  12544#,                                      01042000
    TH2                 =  12800#,                                      01043000
    TH3                 =  13056#,                                      01044000
    MIN                 =  EMIT(TH,2,2)#,                               01045000
    CIS                 =  EMIT(TH1,2,2)#,                              01046000
    CIM                 =  EMIT(TH1+32,2,2)#,                           01047000
    SIE                 =  EMIT(TH2,2,2)#,                              01048000
    SSH                 =  EMIT(TH2+112,2,2)#,                          01049000
    SS1                 =  EMIT(TH2+32,2,2)#,                           01050000
    SS2                 =  EMIT(TH2+64,2,2)#,                           01051000
    SS3                 =  EMIT(TH2+128,2,2)#,                          01052000
    IBD                 =  EMIT(TH3,2,2)#,                              01053000
    IBE                 =  EMIT(TH3+32,2,2)#;                           01054000
%                                                                       01055000
DEFINE                                                                  01056000
    BTO(I)              =  EMIT(TH+I,2,2)#,                             01057000
    BTI(I)              =  EMIT(TH1+I,2,2)#,                            01058000
    SEN(I)              =  EMIT(TH2+I,2,2)#,                            01059000
    FUN(I)              =  EMIT(TH3+I,2,2)#;                            01060000
%                                                                       01061000
DEFINE                                                                  01062000
         DS1(I)         =  EMITCONSTANT(I,1)#,                          01063000
         DS2(I)         =  EMITCONSTANT(I,2)#,                          01064000
         DS3(I)         =  EMITCONSTANT(I,3)#,                          01065000
         DS4(I)         =  EMITCONSTANT(I,4)#;                          01066000
%                                                                       01067000
    DEFINE                                                              01068000
         DA(X)   =  EMIT((LABLUSE[X.LABLINDEX].PHYSICALADDRESS),2,0)#;  01069000
%                                                                       01070000
%                                                                       01071000
%                                                                       01072000
%                                                                       01073000
%         MOVER IS USED FOR MOVING SZ WORDS FROM SOURCE TO DEST.        01074000
%                                                                       01075000
STREAM PROCEDURE MOVER(SOURCE,DEST,SZ);                                 01076000
    VALUE SZ;                                                           01077000
    BEGIN                                                               01078000
         LOCAL A;                                                       01079000
         DI:= LOC A;   SI:=LOC SZ;                                      01080000
         SI:=SI+6;   DI:=DI+7;                                          01081000
         DS:= 1 CHR;                                                    01082000
         SI:=SOURCE;    DI:=DEST;                                       01083000
         DS:= SZ WDS;                                                   01084000
         A(DS:= 32 WDS;   DS:=32 WDS);                                  01085000
    END OF MOVER;                                                       01086000
%                                                                       01087000
%                                                                       01088000
%         EMITINTERRUPTCODE EMITS THE FIRST TWELVE BYTES OF CODE        01089000
%         THAT CONTAINS CALLS ON THE BASIC INTERRUPT ROUTINES.          01090000
%                                                                       01091000
%                                                                       01092000
PROCEDURE EMITINTERRUPTCODE;                                            01093000
    BEGIN                                                               01094000
         DS2(L[1,6].PHYSICALADDRESS);                                   01095000
         DS2(0);                                                        01096000
         NOP;                                                           01097000
         NOP;                                                           01098000
         HLT;                                                           01099000
         NOP;                                                           01100000
         CSQ(IO0);                                                      01101000
         NOP;                                                           01102000
         CSQ(IO1);                                                      01103000
         NOP;                                                           01104000
         CSQ(IO2);                                                      01105000
         NOP;                                                           01106000
         CSQ(IO3);                                                      01107000
    END OF EMIT INTERRUPT CODE;                                         01108000
%                                                                       01109000
%                                                                       01110000
%         ONES COUNTS THE NUMBER OF COUNTEM IN THE RIGHT MOST 32 BITS   01111000
%         OF A VARIABLE.                                                01112000
%                                                                       01113000
%                                                                       01114000
REAL STREAM PROCEDURE COUNTEM(X);                                       01115000
    VALUE X;                                                            01116000
    BEGIN                                                               01117000
         SI:=LOC X;   SI:=SI+2;   SKIP 4 SB;                            01118000
         32(IF SB THEN TALLY:=TALLY+1;   SKIP 1 SB);                    01119000
         COUNTEM:=TALLY;                                                01120000
    END OF COUNTEM;                                                     01121000
%                                                                       01122000
%         FIRST IS USED TO FIND THE PRECISION OF A LITERAL.             01123000
%                                                                       01124000
INTEGER STREAM PROCEDURE FIRST(X);                                      01125000
    VALUE X;                                                            01126000
    BEGIN;                                                              01127000
         SI:=LOC X;                                                     01128000
         SI:=SI+7;                                                      01129000
         SKIP 2 SB;                                                     01130000
         4(IF SB THEN JUMP OUT ELSE TALLY:=TALLY+1;   SKIP 1 SB;);      01131000
         FIRST:=TALLY;                                                  01132000
    END;                                                                01133000
%                                                                       01134000
%                                                                       01135000
%         EMITDESCRIPTIORANDLITERALS EMITS THE LITERALS USED, AND       01136000
%         THEN EMITS THE DESCRIPTORS TO STORAGE AREAS AND LABEL         01137000
%         POINTS.                                                       01138000
%                                                                       01139000
%                                                                       01140000
PROCEDURE DUMPTHECRUD;                                                  01141000
    BEGIN                                                               01142000
         REAL TEMP2;                                                    01143000
    FOR I:= 0 STEP 1 UNTIL LABLMAX DO                                   01144000
    BEGIN                                                               01145000
         IF (TEMP2:=LABLARRAY[I]).TYPE = TYPELABL THEN                  01146000
         BEGIN                                                          01147000
              IF TEMP2 LSS 0 OR TEMP2.SIZE GEQ 4 THEN                   01148000
              BEGIN                                                     01149000
                   LABLS[I].ADDRESS:=LOC;                               01150000
                   IF LASTPASS THEN                                     01151000
                        EMIT(LABLUSE[I].PHYSICALADDRESS,2,LITPRINT)     01152000
                   ELSE   LOC:=LOC+2;                                   01153000
                   IF TEMP2 LSS 0 THEN                                  01154000
                        BEGIN                                           01155000
                        IF LASTPASS THEN                                01156000
                             EMIT(32768 + LABLUSE[I].PHYSICALADDRESS,   01157000
                                  2,LITPRINT)                           01158000
                        ELSE     LOC := LOC + 2;                        01159000
                        END;                                            01160000
              END                                                       01161000
              ELSE                                                      01162000
              LABLS[I].ADDRESS:=LABLUSE[I].PHYSICALADDRESS;             01163000
         END;                                                           01164000
    END OF DESCRIPTOR EMITTING;                                         01165000
%                                                                       01166000
    FOR I:=0 STEP 1 WHILE I < NEXTPOOL DO                               01167000
    BEGIN                                                               01168000
    EMITVAL[I]:=POOL[I] & (4-FIRST(POOLADDRESS[I].PRECISIONUSED))SIZE;  01169000
    POOLADDRESS[I]:=POOLADDRESS[I] & LOC ADDRESS &                      01170000
                     LOC.[33:5] SECTOR & EMITVAL[I].SIZE SIZE;          01171000
    IF POOL[I] < 0 THEN                                                 01172000
         EMITVAL[I] := EMITVAL[I] &                                     01173000
                        (REAL(NOT BOOLEAN(EMITVAL[I])).[16:32] + 1)     01174000
                                                 [16:32];               01175000
    EMIT(EMITVAL[I],EMITVAL[I].SIZE,LITPRINT);                          01176000
    END OF LITERAL EMITTING;                                            01177000
%                                                                       01178000
    MOVER(LABLUSE[*],L[2,*],LABLMAX+1);                                 01179000
    MOVER(PA[2,*],PA[3,*],NEXTPOOL+1);                                  01180000
    IF NOT LASTPASS THEN FOR I:=6 STEP 1 UNTIL LABLMAX DO               01181000
         LABLUSE[I]:=0;                                                 01182000
%                                                                       01183000
    END OF EMIT DESCRIPTORS AND LITERALS;                               01184000
%                                                                       01185000
%         FEELTHEMADDRESSES EXAMINES THE LABLUSE ENTRIES AND            01186000
%         DETERMINES WHICH LABLELS AND STORAGE LOCATIONS NEED           01187000
%         DESCRIPTORS IN THE FIRST PAGE OF MEMORY.                      01188000
%                                                                       01189000
PROCEDURE FEELTHEMADDRESSES;                                            01190000
    BEGIN                                                               01191000
%                                                                       01192000
         FOR I:=0 STEP 1 UNTIL LABLMAX DO                               01193000
              BEGIN                                                     01194000
                   IF JUNK1:=COUNTEM((JUNK:=LABLUSE[I]).SECTORUSEMASK) =01195000
                      0 THEN ELSE                                       01196000
                   BEGIN                                                01197000
                   IF JUNK ! L[2,I] THEN LASTPASS:=TRUE;                01198000
                   IF JUNK1 = 1 OR JUNK.PHYSICALADDRESS < 4096 THEN     01199000
                        LABLARRAY[I]:=LABLARRAY[I] &                    01200000
                                       JUNK[ADDRESSS+1:PHYSICALADDRESSS:01201000
                                         PHYSICALADDRESSL] &            01202000
                                        JUNK[SECTORS:PHYSICALADDRESSS:  01203000
                                          SECTORL]                      01204000
                   ELSE                                                 01205000
                        LABLARRAY[I]:=LABLARRAY[I] & (1)[SIZES:47:1] &  01206000
                                       JUNK[SECTORS:PHYSICALADDRESSS:5];01207000
                   END;                                                 01208000
              END;                                                      01209000
%                                                                       01210000
         LASTPASS:=NOT LASTPASS;                                        01211000
%                                                                       01212000
    END OF FEEL THEM ADDRESSES;                                         01213000
%                                                                       01214000
%                                                                       01215000
%                                                                       01216000
%         KICKITALLOFF IS USED FOR SETTING UP THE INITIAL CONDITIONS    01217000
%         IN PREPARATION FOR THE FIRST PASS.                            01218000
%                                                                       01219000
PROCEDURE KICKITALLOFF;                                                 01220000
    BEGIN                                                               01221000
%                                                                       01222000
         FIRSTPASS:=TRUE;                                               01223000
%                                                                       01224000
         Z:= 0 & TYPEREGISTER TYPE;                                     01225000
         A:= 1 & TYPEREGISTER TYPE;                                     01226000
         C:= 2 & TYPEREGISTER TYPE;                                     01227000
         X:= 3 & TYPEREGISTER TYPE;                                     01228000
         P:= 4 & TYPEREGISTER TYPE;                                     01229000
         B:= 5 & TYPEREGISTER TYPE;                                     01230000
         D:= 6 & TYPEREGISTER TYPE;                                     01231000
         Y:= 7 & TYPEREGISTER TYPE;                                     01232000
         Q:= 8 & TYPEREGISTER TYPE;                                     01233000
         F:= 9 & TYPEREGISTER TYPE;                                     01234000
%                                                                       01235000
         LOC:= 0 & TYPELABL TYPE & (1)SIZE;                             01236000
%                                                                       01237000
         FOR I:=0 STEP 1 UNTIL LABLMAX DO                               01238000
              LABLARRAY[I]:= 0 & I LABLINDEX & TYPEREFERENCED TYPE;     01239000
%                                                                       01240000
    FILL ASCII[*] WITH                                                  01241000
         48,49,50,51,52,53,54,55,56,57,35,64,63,58,62,33,43,65,66,67,   01242000
         68,69,70,71,72,73,46,91,38,40,60,94,92,74,75,76,77,78,79,80,   01243000
         81,82,36,42,45,41,59,39,32,47,83,84,85,86,87,88,89,90,44,37,   01244000
         94,61,93,34,128;                                               01245000
%                                                                       01246000
         EMITINTERRUPTCODE;                                             01247000
    END OF KICKITALLOFF;                                                01248000
%                                                                       01249000
%                                                                       01250000
%         FINALLY IS USED FOR SETTING UP THE INITIL                     01251000
%         CONDITIONS NEEDED FOR THE FINAL PASS.                         01252000
%                                                                       01253000
PROCEDURE FINALLY;                                                      01254000
    BEGIN                                                               01255000
%                                                                       01256000
         CLEARLINE;                                                     01257000
         ERRORNUMBER:=0;                                                01258000
         ERRORS := 0;                                                   01259000
         LISTING := NOT BOOLEAN(COMMON.[46:1]);                         01260000
%                                                                       01261000
    FILL TEXTARRAY[0,*] WITH                                            01262000
         "HALT   ","       ","*******"," CST   ",                       01263000
         "SKIP ON"," OVRFLW","SKIP NO"," OVRFLW",                       01264000
         "SKIP IF"," ODD   ","SKIP IF"," EVEN  ",                       01265000
         "SKIP IF"," NEG   ","SKIP IF"," POS   ",                       01266000
         "SKIP IF"," ZERO  ","SKIP IF"," NONZRO",                       01267000
         "SKIP IF"," X ZERO","SKIP IF"," X NONZ",                       01268000
         "CLEAR A","C      ","COMPLEM","ENT AC ",                       01269000
         "INCREME","NT AC  ","INVERT ","AC     ",                       01270000
         "*******"," P = 1 ","*******"," P = 2 ",                       01271000
         "*******"," P = 3 ","*******"," P = 4 ",                       01272000
         "OVFL = ","TRUE   ","OVFL = ","FALSE  ",                       01273000
         "NOP    ","       ","INCREME","NT X   ",                       01274000
         "SHIFT R","T BIT  ","SHIFT R","T BYTE ",                       01275000
         "ROTATE ","RT BIT ","ROTATE ","RT BYTE",                       01276000
         "SHIFT L"," BIT   ","SHIFT L"," BYTE  ",                       01277000
         "ROTATE ","L BIT  ","ROTATE ","L BYTE ",                       01278000
         "MOVE   ","       ","COMPLEM","ENT    ",                       01279000
         "INCREME","NT     ","DECREME","NT     ",                       01280000
         "AND    ","       ","OR     ","       ",                       01281000
         "EXOR   ","       ","ADD    ","       ",                       01282000
         "???????","???????","???????","???????",                       01283000
         "???????","???????","???????","???????",                       01284000
         "???????","???????","???????","???????",                       01285000
         "???????","???????","???????","???????",                       01286000
         "???????","???????","???????","???????",                       01287000
         "???????","???????","???????","???????",                       01288000
         "???????","???????","???????","???????",                       01289000
         "???????","???????","???????","???????",                       01290000
         "BRANCH ","& MARK ","*******"," CSQ   ",                       01291000
         "???????","???????","???????","???????",                       01292000
         "???????","???????","???????","???????",                       01293000
         "???????","???????","???????","???????",                       01294000
         "LOAD   ","       ","LOAD   ","       ",                       01295000
         "LOAD   ","       ","LOAD   ","       ",                       01296000
         "LOAD   ","       ","LOAD   ","       ",                       01297000
         "LOAD   ","       ","LOAD   ","       ",                       01298000
         "LOAD   ","       ","LOAD   ","       ",                       01299000
         "LOAD   ","       ","LOAD   ","       ",                       01300000
         "LOAD   ","       ","LOAD   ","       ",                       01301000
         "LOAD   ","       ","LOAD   ","       ",                       01302000
         "LOAD RE","LATIVE ","LOAD RE","LATIVE ",                       01303000
         "LOAD RE","LATIVE ","LOAD RE","LATIVE ",                       01304000
         "LOAD IN","D REL  ","LOAD IN","D REL  ",                       01305000
         "LOAD IN","D REL  ","LOAD IN","D REL  ",                       01306000
         "LOAD IN","DEXED  ","LOAD IN","DEXED  ",                       01307000
         "LOAD IN","DEXED  ","LOAD IN","DEXED  ",                       01308000
         "LOAD IN","D 0    ","LOAD IN","D 0    ",                       01309000
         "LOAD IN","D 0    ","LOAD IN","D 0    ",                       01310000
         "STORE  ","       ","STORE  ","       ",                       01311000
         "STORE  ","       ","STORE  ","       ",                       01312000
         "STORE  ","       ","STORE  ","       ",                       01313000
         "STORE  ","       ","STORE  ","       ",                       01314000
         "STORE  ","       ","STORE  ","       ",                       01315000
         "STORE  ","       ","STORE  ","       ",                       01316000
         "STORE  ","       ","STORE  ","       ",                       01317000
         "STORE  ","       ","STORE  ","       ",                       01318000
         "STORE R","ELATIVE","STORE R","ELATIVE",                       01319000
         "STORE R","ELATIVE","STORE R","ELATIVE",                       01320000
         "STORE I","ND REL ","STORE I","ND REL ",                       01321000
         "STORE I","ND REL ","STORE I","ND REL ",                       01322000
         "STORE I","NDEXED ","STORE I","NDEXED ",                       01323000
         "STORE I","NDEXED ","STORE I","NDEXED ",                       01324000
         "STORE I","ND 0   ","STORE I","ND 0   ",                       01325000
         "STORE I","ND 0   ","STORE I","ND 0   ";                       01326000
%                                                                       01327000
    FILL TEXTARRAY[1,*] WITH                                            01328000
         "ADD    ","       ","ADD    ","       ",                       01329000
         "ADD    ","       ","ADD    ","       ",                       01330000
         "ADD    ","       ","ADD    ","       ",                       01331000
         "ADD    ","       ","ADD    ","       ",                       01332000
         "ADD    ","       ","ADD    ","       ",                       01333000
         "ADD    ","       ","ADD    ","       ",                       01334000
         "ADD    ","       ","ADD    ","       ",                       01335000
         "ADD    ","       ","ADD    ","       ",                       01336000
         "ADD REL","ATIVE  ","ADD REL","ATIVE  ",                       01337000
         "ADD REL","ATIVE  ","ADD REL","ATIVE  ",                       01338000
         "ADD IND"," REL   ","ADD IND"," REL   ",                       01339000
         "ADD IND"," REL   ","ADD IND"," REL   ",                       01340000
         "ADD IND","EXED   ","ADD IND","EXED   ",                       01341000
         "ADD IND","EXED   ","ADD IND","EXED   ",                       01342000
         "ADD IND"," 0     ","ADD IND"," 0     ",                       01343000
         "ADD IND"," 0     ","ADD IND"," 0     ",                       01344000
         "SUB    ","       ","SUB    ","       ",                       01345000
         "SUB    ","       ","SUB    ","       ",                       01346000
         "SUB    ","       ","SUB    ","       ",                       01347000
         "SUB    ","       ","SUB    ","       ",                       01348000
         "SUB    ","       ","SUB    ","       ",                       01349000
         "SUB    ","       ","SUB    ","       ",                       01350000
         "SUB    ","       ","SUB    ","       ",                       01351000
         "SUB    ","       ","SUB    ","       ",                       01352000
         "SUB REL","ATIVE  ","SUB REL","ATIVE  ",                       01353000
         "SUB REL","ATIVE  ","SUB REL","ATIVE  ",                       01354000
         "SUB IND"," REL   ","SUB IND"," REL   ",                       01355000
         "SUB IND"," REL   ","SUB IND"," REL   ",                       01356000
         "SUB IND","EXED   ","SUB IND","EXED   ",                       01357000
         "SUB IND","EXED   ","SUB IND","EXED   ",                       01358000
         "SUB IND"," 0     ","SUB IND"," 0     ",                       01359000
         "SUB IND"," 0     ","SUB IND"," 0     ",                       01360000
         "AND    ","       ","AND    ","       ",                       01361000
         "AND    ","       ","AND    ","       ",                       01362000
         "AND    ","       ","AND    ","       ",                       01363000
         "AND    ","       ","AND    ","       ",                       01364000
         "AND    ","       ","AND    ","       ",                       01365000
         "AND    ","       ","AND    ","       ",                       01366000
         "AND    ","       ","AND    ","       ",                       01367000
         "AND    ","       ","AND    ","       ",                       01368000
         "AND REL","ATIVE  ","AND REL","ATIVE  ",                       01369000
         "AND REL","ATIVE  ","AND REL","ATIVE  ",                       01370000
         "AND IND"," REL   ","AND IND"," REL   ",                       01371000
         "AND IND"," REL   ","AND IND"," REL   ",                       01372000
         "AND IND","EXED   ","AND IND","EXED   ",                       01373000
         "AND IND","EXED   ","AND IND","EXED   ",                       01374000
         "AND IND"," 0     ","AND IND"," 0     ",                       01375000
         "AND IND"," 0     ","AND IND"," 0     ",                       01376000
         "GO TO  ","       ","GO TO  ","       ",                       01377000
         "GO TO  ","       ","GO TO  ","       ",                       01378000
         "GO TO  ","       ","GO TO  ","       ",                       01379000
         "GO TO  ","       ","GO TO  ","       ",                       01380000
         "GO TO  ","       ","GO TO  ","       ",                       01381000
         "GO TO  ","       ","GO TO  ","       ",                       01382000
         "GO TO  ","       ","GO TO  ","       ",                       01383000
         "GO TO  ","       ","GO TO  ","       ",                       01384000
         "GO TO R","ELATIVE","GO TO R","ELATIVE",                       01385000
         "GO TO R","ELATIVE","GO TO R","ELATIVE",                       01386000
         "GO TO I","ND REL ","GO TO I","ND REL ",                       01387000
         "GO TO I","ND REL ","GO TO I","ND REL ",                       01388000
         "GO TO I","NDEXED ","GO TO I","NDEXED ",                       01389000
         "GO TO I","NDEXED ","GO TO I","NDEXED ",                       01390000
         "GO TO I","ND 0   ","GO TO I","ND 0   ",                       01391000
         "GO TO I","ND 0   ","GO TO I","ND 0   ";                       01392000
%                                                                       01393000
    FILL TEXTARRAY[2,*] WITH                                            01394000
         "???????","???????","???????",                                 01395000
         "SPOUT  ","       ","       ",                                 01396000
         "$$$$$$$","$$$$$$$","$$$$$$$",                                 01397000
         "$$$$$$$","$$$$$$$","$$$$$$$",                                 01398000
         "OUTPUT ","SLC    ","       ",                                 01399000
         "OUTPUT ","CP     ","       ",                                 01400000
         "OUTPUT ","PTP    ","       ",                                 01401000
         "NORMAL ","OUTPUT ","MLC    ",                                 01402000
         "OUTPUT ","LP     ","       ",                                 01403000
         "SPECIAL"," OUTPUT"," MLC   ",                                 01404000
         "OUTPUT ","FORMAT ","LP     ",                                 01405000
         "INPUT S","PO     ","       ",                                 01406000
         "$$$$$$$","$$$$$$$","$$$$$$$",                                 01407000
         "$$$$$$$","$$$$$$$","$$$$$$$",                                 01408000
         "INPUT C","R      ","       ",                                 01409000
         "INPUT S","LC     ","       ",                                 01410000
         "NORMAL ","INPUT M","LC     ",                                 01411000
         "$$$$$$$","$$$$$$$","$$$$$$$",                                 01412000
         "$$$$$$$","$$$$$$$","$$$$$$$",                                 01413000
         "CR SEN ","ON LINE","       ",                                 01414000
         "SLC SEN","REC. BI","T MODE ",                                 01415000
         "CP SEN ","READY  ","       ",                                 01416000
         "PTP SEN"," NOT ST","OPPING ",                                 01417000
         "MLC SEN","       ","       ",                                 01418000
         "LP SEN ","ERROR  ","       ",                                 01419000
         "SPO SEN","OUTPUT ","READY  ",                                 01420000
         "PTR SEN"," DATA R","EADY   ",                                 01421000
         "CR SEN ","MALFUNC","TION   ",                                 01422000
         "SLC SEN"," OUTPUT"," READY ",                                 01423000
         "CP SEN ","READY  ","       ",                                 01424000
         "PTP SEN"," NOT ST","OP CODE",                                 01425000
         "MLC SEN","OUTPUT ","INTRUPT",                                 01426000
         "LP SEN ","END OF ","PAGE   ",                                 01427000
         "SPO SEN"," INPUT ","READY  ",                                 01428000
         "CR SEN ","DATA RE","ADY    ",                                 01429000
         "SLC SEN"," INPUT ","READY  ",                                 01430000
         "SEN CP ","ERROR  ","       ",                                 01431000
         "PTP SEN"," NOT EO","T      ",                                 01432000
         "MCL SEN"," IRB OF","F      ",                                 01433000
         "LP SEN ","MOTION ","DONE   ",                                 01434000
         "PTR SEN"," NOT EO","T      ",                                 01435000
         "CR SEN ","READY  ","       ",                                 01436000
         "SLC SEN"," CARRIE","R ON   ",                                 01437000
         "CP SEN ","FIRST 4"," ROWS  ",                                 01438000
         "MLC SEN"," DATA R","EADY   ",                                 01439000
         "LP SEN ","PRINT D","ONE    ",                                 01440000
         "PTR SEN"," NOT EN","D MSG. ",                                 01441000
         "SLC SEN"," CLEAR ","TO SEND",                                 01442000
         "CP SEN ","BUFFER ","READY  ",                                 01443000
         "PTP SEN"," READY ","       ",                                 01444000
         "MLC SEN","       ","       ",                                 01445000
         "SLC SEN"," INTERL","OCK    ",                                 01446000
         "PTP SEN"," DATA N","EEDED  ",                                 01447000
         "MLC SEN","       ","       ",                                 01448000
         "LP SEN ","READY  ","       ",                                 01449000
         "SLC SEN"," RING  ","       ",                                 01450000
         "MLC SEN","       ","       ",                                 01451000
         "LP SEN ","BUFFER ","READY  ",                                 01452000
         "SLC SEN"," ODD PA","RITY   ",                                 01453000
         "MLC SEN","       ","       ",                                 01454000
         "ENBL SP","O OUTPT"," INTRPT",                                 01455000
         "START P","T READE","R      ",                                 01456000
         "ENBL CR"," INTRUP","TS     ",                                 01457000
         "ENBL SL","C REC. ","BIT MOD",                                 01458000
         "Z      ","A      ","C      ","X      ",                       01459000
         "P      ","B      ","D      ","Y      ",                       01460000
         "Q      ","F      ",0,0,0,0,0,0,0,0,0,0,                       01461000
         "*******","*******","*******","*******",                       01462000
         "*******","*******","*******","*******",                       01463000
         "*******","*******","*******","*******",                       01464000
         "*******","*******","*******","*******",                       01465000
         "********",                                                    01466000
         0,0,0,0,0,0,0,0,0,0,0;                                         01467000
%                   NEXT ENTRY IS 241                                   01468000
%                                                                       01469000
    FILL TEXTARRAY[3,*] WITH                                            01470000
         "ENBL CP"," INTRUP","TS     ",                                 01471000
         "SET PTP"," BINARY"," MODE  ",                                 01472000
         "ENBL ML","C INTRU","PTS    ",                                 01473000
         "ENBL LP"," INTRUP","TS     ",                                 01474000
         "RESET S","PO CONT","ROL    ",                                 01475000
         "$$$$$$$","$$$$$$$","$$$$$$$",                                 01476000
         "$$$$$$$","$$$$$$$","$$$$$$$",                                 01477000
         "INITIAT","E CARD ","CYCLE  ",                                 01478000
         "ENBL SL","C REC. ","INTRUPT",                                 01479000
         "DSBL CP"," INTRUP","TS     ",                                 01480000
         "SET PTP"," ALPHA ","MODE   ",                                 01481000
         "DSBL ML","C INTRU","PTS    ",                                 01482000
         "DSBL LP"," INTRUP","TS     ",                                 01483000
         "START S","PO READ","ER     ",                                 01484000
         "$$$$$$$","$$$$$$$","$$$$$$$",                                 01485000
         "$$$$$$$","$$$$$$$","$$$$$$$",                                 01486000
         "DSBL CR"," INTRUP","TS     ",                                 01487000
         "DSBL SL","C REC. ","INTRPTS",                                 01488000
         "SELCT C","P MAIN ","STACKER",                                 01489000
         "ENBL PT","P INTRU","PTS    ",                                 01490000
         "SET MLC"," IRB OF","F      ",                                 01491000
         "INITIAL","IZE LP ","CONTROL",                                 01492000
         "ENBL SP","O INPUT"," INTRPT",                                 01493000
         "SELECT ","PTR ALP","HA MODE",                                 01494000
         "INITIAL","IZE CR ","CONTROL",                                 01495000
         "SLC DAT","A TERM."," RDY ON",                                 01496000
         "SELECT ","CP AUX."," STACKR",                                 01497000
         "DSBL PT","P INTRU","PTS    ",                                 01498000
         "MLC REA","D W REG","ISTER  ",                                 01499000
         "ENBL PT","R INTRU","PTS    ",                                 01500000
         "SLC REQ"," TO SND"," ON    ",                                 01501000
         "INITIAT","E CP CY","CLE    ",                                 01502000
         "PTP FUN","       ","       ",                                 01503000
         "MLC SYS","TEM RES","ET     ",                                 01504000
         "$$$$$$$","$$$$$$$","$$$$$$$",                                 01505000
         "$$$$$$$","$$$$$$$","$$$$$$$",                                 01506000
         "SLC REQ"," TO SEN","D OFF  ",                                 01507000
         "INITIAT","E CP CO","NTROL  ",                                 01508000
         "START P","T PUNCH","       ",                                 01509000
         "MLC LIN","E RESET","       ",                                 01510000
         "READ SP","O ONE C","HAR    ",                                 01511000
         "$$$$$$$","$$$$$$$","$$$$$$$",                                 01512000
         "$$$$$$$","$$$$$$$","$$$$$$$",                                 01513000
         "ENBL SL","C REC W","RD MODE",                                 01514000
         "STOP PT"," PUNCH ","       ",                                 01515000
         "MLC CPU"," PRIORI","TY     ",                                 01516000
         "PTR REW","IND    ","       ",                                 01517000
         "INITIAL","IZE SLC"," CONTRL",                                 01518000
         "RESET P","TP CONT","ROL    ",                                 01519000
         "MLC FUN","       ","       ",                                 01520000
         "MODIFY ","INTERRU","PTS    ",                                 01521000
         "COPY IN","TERRUPT"," STATUS",                                 01522000
         "COPY IN","TERRUPT"," MASK  ",                                 01523000
         "SKIP IF"," INTERR","UPT ENV",                                 01524000
         "SKIP PO","WER FAI","L/HALT ",                                 01525000
         "SKIP SE","NSE 1 O","FF     ",                                 01526000
         "SKIP SE","NSE 2 O","FF     ",                                 01527000
         "SKIP SE","NSE 3 O","FF     ",                                 01528000
         "DISABLE"," INTERR","UPTS   ",                                 01529000
         "ENABLE ","INTERRU","PTS    ",                                 01530000
         0,0,0,0,0,0,0,0,0,                                             01531000
         "MULTIPL","Y DEFIN","ED LABE","L      ",                       01532000
         "UNDEFIN","ED LABE","L      ","       ",                       01533000
         "LABEL L","OCATION"," CONFLI","CT     ",                       01534000
         "LABEL A","SSIGNME","NT ERRO","R      ",                       01535000
         "POSSIBL","E OPERA","ND SIZE"," ERROR ",                       01536000
         "INDEXED"," OPERAN","D ERROR","       ",                       01537000
         "ILLEGAL"," REGIST","ER TYPE","       ",                       01538000
         "INSUFFI","CIENT M","EMORY  ","       ",                       01539000
         "LITERAL"," PASS M","ISMATCH","       ",                       01540000
         "ADDRESS","ABILITY"," ERROR ","       ";                       01541000
%                                                                       01542000
    FILL OUTPOINTER[*] WITH                                             01543000
         OCT0162000100020000, OCT0000000000040005,                      01544000
         OCT0000000600000000, OCT0000000000000007,                      01545000
         0,0,0, OCT0000001000000000, 0,0,0,                             01546000
         OCT0000000000000011, 0,0,0,                                    01547000
         OCT0000001200000000,0,0,0,0,0,0,0,0,                           01548000
         0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,                       01549000
         0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;                       01550000
%                                                                       01551000
    FILL INPOINTER[*] WITH                                              01552000
         OCT0163001300140000, OCT0000001600170000,0,                    01553000
         OCT0000000000000020,                                           01554000
         0,0,0,0,                                                       01555000
         OCT0164000000000000,                                           01556000
         0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,                                 01557000
         0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,                       01558000
         0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;                       01559000
%                                                                       01560000
    FILL SENARRAY[*] WITH                                               01561000
         OCT0165000000210000, OCT0000002300240025,                      01562000
         OCT0000002600000000, 23,0,0,0,                                 01563000
         OCT0000003000000000, OCT0167003100320000,                      01564000
         OCT0000003300340035, OCT0000003600000000,                      01565000
         32,0,0,0, OCT0000004000000000,                                 01566000
         OCT0170004100000000, OCT0000004200430044,                      01567000
         OCT0000004500000000, OCT0000000000000046,                      01568000
         0,0,0,                                                         01569000
         OCT0000004700000000, OCT0000000000500000,                      01570000
         OCT0000005100520053, 0,44,0,0,0,                               01571000
         OCT0000005500000000, OCT0171000000560000,                      01572000
         OCT0000000000570060, OCT0000006100000000,                      01573000
         50,0,0,0,0,0,                                                  01574000
         OCT0000000000630000, OCT0000006400000000,                      01575000
         53,0,0,0,                                                      01576000
         OCT0000006600000000,0,                                         01577000
         OCT0000000000670000,0,56,0,0,0,                                01578000
         OCT0000007100000000,0,                                         01579000
         OCT0000000000720000,0,59,0,0,0,0;                              01580000
%                                                                       01581000
    FILL FUNARRAY[*] WITH                                               01582000
         OCT0172007400750000, OCT0000007600770100,                      01583000
         OCT0000010100000000, 66,0,0,0,                                 01584000
         OCT0000010300000000, OCT0173010401050000,                      01585000
         OCT0000010701100111, OCT0000011200000000,                      01586000
         75,0,0,0,                                                      01587000
          OCT0000011400000000, OCT0000011501160000,                     01588000
          OCT0000012001210122, OCT0000012300000000,                     01589000
         84,0,0,0,                                                      01590000
         OCT0000012500000000, OCT0000012601270000,                      01591000
         OCT0000013001310132, OCT0000013300000000,                      01592000
         92,0,0,0,0,                                                    01593000
         OCT0000000001350000, OCT0000000001360137,                      01594000
         OCT0000014000000000, 97,0,0,0,0,                               01595000
         OCT0000000001420000, OCT0000000001440145,                      01596000
         OCT0000014600000000, 103,0,0,0,0,                              01597000
         OCT0000015001510000, OCT0000000001530000,                      01598000
         OCT0000015400000000, 109,0,0,0,0,                              01599000
         OCT0000000001560000, OCT0000000001570000,                      01600000
         OCT0000016000000000, 113,0,0,0,0;                              01601000
%                                                                       01602000
    END OF FINALLY;                                                     01603000
%                                                                       01604000
%                                                                       01605000
%         DONEIHOPE IS CALLED AT THE END OF EACH PASS TO DETERMINE      01606000
%         IF ANOTHER PASS SHOULD BE TAKEN.                              01607000
%                                                                       01608000
BOOLEAN PROCEDURE DONEIHOPE;                                            01609000
    IF LASTPASS THEN DONEIHOPE:=TRUE                                    01610000
    ELSE                                                                01611000
    BEGIN                                                               01612000
         LOC:=0 & TYPELABL TYPE & (1) SIZE;                             01613000
         FEELTHEMADDRESSES;                                             01614000
         IF LASTPASS THEN FINALLY;                                      01615000
         EMITINTERRUPTCODE;                                             01616000
         DUMPTHECRUD;                                                   01617000
         FIRSTPASS:=FALSE;                                              01618000
         DONEIHOPE := IF PASSES := PASSES + 1 > 7 THEN TRUE ELSE FALSE; 01619000
    END OF DONEIHOPE;                                                   01620000
%                                                                       01621000
%                                                                       01622000
%                                                                       01623000
%                                                                       01624000
%         THE FOLLOWING IS THE FIRST EXECUTABLE CODE.                   01625000
%                                                                       01626000
%                                                                       01627000
    IF BOOLEAN(COMMON.[47:1]) THEN GO TO PUNCHONLY;                     01628000
    KICKITALLOFF;                                                       01629000
%                                                                       01630000
    DO                                                                  01631000
    BEGIN                                                               01632000
 REAL SEGMENT;                                                          01633000
%                                                                       10000000
    DEFINE                                                              10001000
         TIMEOUT                 =  7000#,                              10002000
         SOH                     =   1#,                                10003000
         SOHP                    =  1#,                                 10004000
         STEXT                   =   2#,                                10005000
         STEXTP                  =  2#,                                 10006000
         ETX                     =   3#,                                10007000
         ETXP                    =  131#,                               10008000
         EOT                     =   4#,                                10009000
         EOTP                    =  4#,                                 10010000
         ENQ                     =   5#,                                10011000
         ENQP                    =  133#,                               10012000
         ACK                     =   6#,                                10013000
         ACKP                    =  134#,                               10014000
         NAK                     =  21#,                                10015000
         NAKP                    =  21#,                                10016000
         SYNC                    =  22#,                                10017000
         SYNCP                   =  22#,                                10018000
         ESC                     =  27#,                                10019000
         ESCP                    =  155#,                               10020000
         MSMAX                   =  400#,                               10021000
         CR                      =  13#,                                10022000
         DELETE                  =  127#,                               10023000
         BACKSPACE               =  60#,                                10024000
         LF                      =  10#,                                10025000
         CRP                     =  13#,                                10026000
         QM                      =  63#,                                10027000
         BLANK                   =  32#,                                10028000
         CONTROLAT               =  96#,                                10029000
         LEFTARROW               =  95#,                                10030000
         COMPRESSCHAR            =  27#;                                10031000
%                                                                       10032000
    DEFINE                                                              10033000
         CHECKLIST(XX) =   SP2;   LOAD(XX);  SAZN;  GOTO(LOC+12);       10034000
                           T(C,X);   BRM(CHECKADDRESS);   LOADX(0);     10035000
                           SAZ;   GOTO(LOC-8)#;                         10036000
%                                                                       10037000
    DEFINE                                                              10038000
DEBUG  =  LAB(100)#,                                                    10039000
         SUPERFORGET             =  LAB(333)#,                          10040000
LONGSPACEFORGET  =  LAB(101)#,                                          10041000
LONGSPACEGET  =  LAB(102)#,                                             10042000
NOMEMORYLEFT  =  LAB(103)#,                                             10043000
LONGSPACEQ  =  LAB(104)#,                                               10044000
SHORTSPACEQ  =  LAB(105)#,                                              10045000
ITEMP  =  LAB(126)#,                                                    10046000
         CA1                     =  LAB(192)#,                          10047000
         CHECKADDRESS            =  LAB(170)#,                          10048000
         NRMASK                  =  LAB(203)#,                          10049000
         CHECKTIMER              =  LAB(336)#,                          10050000
         CLOCK                   =  LAB(133)#,                          10051000
         TIMEDOUT                =  LAB(93)#,                           10052000
         DUMPCORE                =  LAB(106)#,                          10053000
         DUMPALINE               =  LAB(107)#,                          10054000
         DC1                     =  LAB(108)#,                          10055000
         DC2                     =  LAB(109)#,                          10056000
         DC3                     =  LAB(110)#,                          10057000
         DUMPSPACE               =  LAB(111)#,                          10058000
         DUMPBYTE                =  LAB(112)#,                          10059000
         PRINTDUMPBYTE           =  LAB(90)#,                           10060000
         DUMPTABLE               =  LAB(91)#,                           10061000
IL  =  LAB(118)#,                                                       10062000
IL2  =  LAB(119)#,                                                      10063000
         IL3                     =  LAB(92)#,                           10064000
         IL4                     =  LAB(128)#,                          10065000
LM  =  LAB(120)#,                                                       10066000
IM  =  LAB(121)#,                                                       10067000
ONE38  =  LAB(122)#,                                                    10068000
EIGHTY4  =  LAB(123)#,                                                  10069000
LCL  =  LAB(124)#,                                                      10070000
LCS  =  LAB(125)#,                                                      10071000
NOTHINGTODO  =  LAB(113)#,                                              10072000
GETSPACE  =  LAB(114)#,                                                 10073000
FORGETSPACE  =  LAB(115)#,                                              10074000
TESTCR  =  LAB(116)#,                                                   10075000
         TESTCP              =  LAB(117)#,                              10076000
         TESTMODEM             =  LAB(311)#,                            10077000
         TESTLP                =  LAB(312)#,                            10078000
         NSECOND               =  LAB(313)#;                            10079000
%                                                                       10080000
%                                                                       10081000
%                                                                       10082000
%         THE FOLLOWING DEFINES ARE FOR PRINTER CONTROL OPERATORS       10083000
%                                                                       10084000
    DEFINE                                                              10085000
         ENABLELPINTERRUPT       =  29#,          % FUN                 10086000
         DISABLELPINTERRUPT      =  61#,          % FUN                 10087000
         LPCLEAR                 =  93#,          % FUN                 10088000
         LPDATA                  =  29#,          % BTO                 10089000
         LPFORMAT                =  61#,          % BTO                 10090000
         LPERR                   =  29#,          % SEN                 10091000
         ENDOFPAGE               =  61#,          % SEN                 10092000
         LPMOTIONDONE            =  93#,          % SEN                 10093000
         PRINTCYCLEDONE          =  125#,         % SEN                 10094000
         LPREADY                 =  189#,         % SEN                 10095000
         LPDATAREADY             =  221#;         % SEN                 10096000
%                                                                       10097000
%         THE NEXT DEFINE IS FOR THE BITS OF THE PRINTER STATUS WORDS   10098000
%                                                                       10099000
    DEFINE                                                              10100000
         NOTREADYBIT             =  128#,                               10101000
         LOCKBIT                 =   64#,                               10102000
         LOCKBIT2                =   32#,                               10103000
         EOPBIT                  =   16#,                               10104000
         LPERRBIT                =    8#,                               10105000
         MOTIONDONEBIT           =    4#,                               10106000
         LPBUFFFULLBIT           =    2#,                               10107000
         BUSYBIT                 =    1#;                               10108000
%                                                                       10109000
%         THE NEXT DEFINE CONTAINS THE INDEXES FOR SPO MESSAGES         10110000
%         PERTAINING TO THE LINE PRINTER                                10111000
%                                                                       10112000
    DEFINE                                                              10113000
         LPNR                    =  110#,                               10114000
         LPCK                    =  124#;                               10115000
%                                                                       10116000
%         THE NEXT DEFINE CONTAINS THE CARRIAGE CONTROL CONSTANTS       10117000
%                                                                       10118000
    DEFINE                                                              10119000
         SINGLESPACE             =  16#,                                10120000
         DOUBLESPACE             =  32#,                                10121000
         PAGESKIP                =   1#;                                10122000
%                                                                       10123000
    DEFINE                                                              10124000
         MSG(X)                  =  DS1(ASCII[X])#;                     10125000
%                                                                       10126000
%                                                                       10127000
%         THE NEXT DEFINE LAYS OUT THE ARRANGEMENT OF THE PRINTER BUFFER10128000
%                                                                       10129000
    DEFINE                                                              10130000
         LINK                    =  0#,                                 10131000
         ENDPOS                  =  2#,                                 10132000
         LINEFORMAT              =  3#,                                 10133000
         LINEREPLICATOR          =  4#,                                 10134000
         FIRSTPRINTCHAR          =  5#;                                 10135000
%                                                                       10136000
%                                                                       10137000
%         THE FOLLOWING ARE LABELS USED IN THE PRINTER ROUTINES         10138000
%                                                                       10139000
    DEFINE                                                              10140000
         PRINTERNOTREADY         =  LAB(7)#,                            10141000
         PRINTERCHECK            =  LAB(8)#,                            10142000
         NOPRINTERACTIVITY       =  LAB(9)#,                            10143000
         PRINTALINE              =  LAB(10)#,                           10144000
         PRINTTHEBUFFER          =  LAB(11)#,                           10145000
         PRINTERLOCKED           =  LAB(13)#,                           10146000
         PRINTERLOCKED2          =  LAB(14)#,                           10147000
         SETPRINTERNOTREADY      =  LAB(36)#,                           10148000
         PRINTAFTER              =  LAB(17)#,                           10149000
         NORMALPRINT             =  LAB(18)#,                           10150000
         EXPANDPRINTERDATA       =  LAB(19)#,                           10151000
         PRINTERTEST             =  LAB(20)#,                           10152000
         PRINTNOBUFFER           =  LAB(325)#,                          10153000
         LOADPRINTCHAR           =  LAB(21)#,                           10154000
         PRINTERLOOP             =  LAB(22)#,                           10155000
          PRINTIT                =  LAB(23)#,                           10156000
         PRINTERTRANSLATE        =  LAB(24)#,                           10157000
         LPTABLE                 =  LAB(45)#,                           10158000
         PRINTERLAB1             =  LAB(25)#,                           10159000
         PRINTERLAB2             =  LAB(26)#;                           10160000
%                                                                       10161000
%         THE FOLLOWING DEFINES ARE FOR STORAGE LOCATIONS USED BY THE   10162000
%         PRINTER ROUTINES                                              10163000
%                                                                       10164000
    DEFINE                                                              10165000
         PRINTERCCTABLE          =  LAB(177)#,                          10166000
         PRINTERBUFFERS          =  LAB(291)#,                          10167000
         LPSTATUS                =  LAB(27)#,    % 1                    10168000
         NEXTPRINTERFORMAT       =  LAB(29)#,    % 1                    10169000
         PRINTERFORMATCOUNT      =  LAB(30)#,    % 1                    10170000
         PRINTERLOOPCONTROL      =  LAB(31)#,    % 1                    10171000
         LPPOINTER               =  LAB(32)#,    % 2                    10172000
         LPLIMIT                 =  LAB(33)#,    % 2                    10173000
         PRINTERQ                =  LAB(34)#,    % 2                    10174000
         PRINTERTAIL             =  LAB(35)#;    % 2                    10175000
%                                                                       10176000
%                                                                       10177000
%         THE FOLLOWIING DEFINES ARE FOR THE I/O OPERATORS NEEDED TO    10178000
%         HANDLE THE CARD READER.                                       10179000
%                                                                       10180000
    DEFINE                                                              10181000
         ENABLECRINTERRUPT        =   5#,        % FUN                  10182000
         DISABLECRINTERRUPT       =  69#,        % FUN                  10183000
         CRCLEAR                  = 101#,        % FUN                  10184000
         CRINITIATE               =  37#,        % FUN                  10185000
         CRONLINE                 =   5#,        % SEN                  10186000
         CRERROR                  =  25#,        % SEN                  10187000
         CRDATAREADY              =  69#,        % SEN                  10188000
         CRBUSY                   = 101#,        % SEN                  10189000
         CRREAD                   =   5#;        % BTI                  10190000
%                                                                       10191000
%                                                                       10192000
%         THE NEXT BLOCK OF DEFINES CONTAIN THE DEFINES FOR THE BITS IN 10193000
%         THE CARD READER STATUS WORD.                                  10194000
%                                                                       10195000
    DEFINE                                                              10196000
         % NOTREADYBIT            = 128#,                               10197000
         % LOCKBIT                =  64#,                               10198000
         % LOCKBIT2               =  32#,                               10199000
         CRFIRSTBIT               =  16#,                               10200000
         CRINHIBITBIT             =   8#,                               10201000
         CRERRBIT                 =   4#,                               10202000
         CRBUFFFULLBIT            =   2#;                               10203000
         % BUSYBIT                =   1#;                               10204000
%                                                                       10205000
%                                                                       10206000
%         THE NEXT SECTION OF DEFINES CONTAINS THE INDECES IF THE SPO   10207000
%         MESSAGES USED BY THE CARD READER ROUTINES.                    10208000
%                                                                       10209000
    DEFINE                                                              10210000
         CRNR                    =  69#,                                10211000
         NOMEM                   =  12#,                                10212000
         CRERR                   =  83#,                                10213000
         CRINV                   =  98#;                                10214000
%                                                                       10215000
%                                                                       10216000
%         THE FOLLOWING DEFINES ARE STORAGE AREAS USED BY THE CARD READE10217000
%         CODE.                                                         10218000
%                                                                       10219000
    DEFINE                                                              10220000
         EBCDICVECTOR            =  LAB(141)#,                          10221000
         BCLVECTOR                =  LAB(40)#,   % VECTOR 16 | 1        10222000
         CRTABLE                  =  LAB(41)#,   % 2                    10223000
         CURRENTCARDTABLE         =  LAB(74)#,   % 2                    10224000
         CRBUFFER                 =  LAB(42)#,   % VECTOR 80 | 2        10225000
         CRSTATUS                 =  LAB(43)#,   % 1                    10226000
         CRFLAGS                  =  LAB(44)#,   % 1                    10227000
         CRSUPRESSCOUNT           =  LAB(46)#,   % 1                    10228000
         CRCOUNT                  =  LAB(72)#,   % 1                    10229000
         CRPOINTER                =  LAB(47)#,   % 2                    10230000
         CRTEMP                   =  LAB(48)#,   % 2                    10231000
         CRSCRATCH                =  LAB(49)#,   % 1                    10232000
         CRSCRATCH2               =  LAB(50)#,   % 1                    10233000
         CARDREADERQ              =  LAB(51)#,   % 2                    10234000
         CARDREADERQTAIL          =  LAB(52)#;   % 2                    10235000
%                                                                       10236000
%                                                                       10237000
%         THE NEXT BLOCK OF DEFINES IS FOR THE LABELS USED IN THE CARD  10238000
%         READER CODE.                                                  10239000
%                                                                       10240000
    DEFINE                                                              10241000
         CRINTERRUPT              =  LAB(53)#,                          10242000
         CARDREADERINTERRUPTNOTDATAREADY  =  LAB(54)#,                  10243000
         EMPTYCARDREADERHOPPER    =  LAB(55)#,                          10244000
         CRNOTREADY               =  LAB(56)#,                          10245000
         CRREADY                  =  LAB(57)#,                          10246000
         CARDREADERSTARTIO        =  LAB(59)#,                          10247000
         CARDREADERLOCKED         =  LAB(60)#,                          10248000
         CARDREADERLOCKED2        =  LAB(61)#,                          10249000
         MOVECRBUFFER             =  LAB(62)#,                          10250000
         GETNEXTCARDCOL           =  LAB(63)#,                          10251000
         TESTFORCRDONE            =  LAB(64)#,                          10252000
         MAYBEENDOFCRSUPRESSION   =  LAB(65)#,                          10253000
         LOCALTESTFORCRDONE       =  LAB(66)#,                          10254000
         INITIALIZECRSUPRESSION   =  LAB(67)#,                          10255000
         DONTTRANSFERCRBUFFER     =  LAB(68)#,                          10256000
         CARDREADERERROR          =  LAB(69)#,                          10257000
         CHECKFORINVALIDCHAR      =  LAB(70)#,                          10258000
         STORECARDCHAR            =  LAB(73)#,                          10259000
         READCHECK                =  LAB(75)#,                          10260000
         INVALIDCARDCHAR          =  LAB(71)#;                          10261000
%                                                                       10262000
%                                                                       10263000
%         THE NEXT BLOCK OF DEFINES DEFINES THE MODEM OPERATORS.        10264000
%                                                                       10265000
    DEFINE                                                              10266000
         ENABLEMODEMINTERRUPT     =  38#,     % FUN                     10267000
         DISABLEMODEMINTERRUPT    =  70#,     % FUN                     10268000
         TURNONDTR                = 102#,     % FUN                     10269000
         TURNONRS                 = 134#,     % FUN                     10270000
         TURNOFFRS                = 166#,     % FUN                     10271000
         GOTOBITMODE              =   6#,     % FUN                     10272000
         GOTOBYTEMODE             = 198#,     % FUN                     10273000
         MODEMCLEAR               = 230#,     % FUN                     10274000
         BITMODE                  =   6#,     % SEN                     10275000
         BYTEREQUEST             =  38#,     % SEN                      10276000
         DATAPRESENT             =  70#,     % SEN                      10277000
         CARRIER                 = 102#,     % SEN                      10278000
         CLEARTOSEND              = 134#,     % SEN                     10279000
         INTERLOCKON              = 166#,     % SEN                     10280000
         RINGRECEIVED            = 198#,     % SEN                      10281000
         ODDPARITY                = 230#,     % SEN                     10282000
         MODEMREAD                =   6#,     % BTI                     10283000
         MODEMWRITE               =   6#;     % BTO                     10284000
%                                                                       10285000
%                                                                       10286000
%         THE NEXT GROUP OF DEFINES LISTS THE MODEM STATUS CONDITIONS.  10287000
%                                                                       10288000
    DEFINE                                                              10289000
         IDLE                    =   0#,                                10290000
         IDLERECEIVE             =   2#,                                10291000
         TRANSMITENQ             =   4#,                                10292000
         RECEIVEENQ              =   6#,                                10293000
         TRANSMITACK             =   8#,                                10294000
         RECEIVEACK              =  10#,                                10295000
         TRANSMITNAK             =  12#,                                10296000
         TRANSMITHEADER          =  16#,                                10297000
         RECEIVEHEADER           =  18#,                                10298000
         TRANSMITMSG             =  20#,                                10299000
         RECEIVEMSG              =  22#,                                10300000
         TRANSMITBCC             =  24#,                                10301000
         RECEIVEBCC              =  26#,                                10302000
         ACKNOWLEDGE             =  28#,                                10303000
         RECEIVERESPONSE         =  30#,                                10304000
         TRANSMITEOT             =  32#,                                10305000
         LOOKFORRING             =  34#;                                10306000
%                                                                       10307000
%                                                                       10308000
%         THE FOLLOWING DEFINE DECLARES THE SPO MESSAGES                10309000
%         FOR THE MODEM ROUTINES.                                       10310000
%                                                                       10311000
    DEFINE                                                              10312000
         HLMESS                  =  -2#,                                10313000
         NOSYSTEMLINK            =  53#,                                10314000
         CONNECTIONMADE          =  153#,                               10315000
         CLSOFF                  =  37#,                                10316000
         MISSINGMESSAGE          =  20#;                                10317000
%                                                                       10318000
%                                                                       10319000
%         THE NEXT GROUP OF DEFINES LAYS OUT THE MODEM FLAG.            10320000
%                                                                       10321000
    DEFINE                                                              10322000
         LINEACTIVEBIT           =  128#,                               10323000
         MYSTARTBIT              =   64#,                               10324000
         CONNECTEDBIT            =   32#,                               10325000
         RINGBIT                 =   16#,                               10326000
         INTERLOCKBIT            =    8#,                               10327000
         DTRBIT                  =    4#,                               10328000
         CARRIERBIT              =    2#,                               10329000
         CLEARTOSENDBIT          =    1#;                               10330000
%                                                                       10331000
%                                                                       10332000
%         THE FOLLOWING BLOCK OF DEFINES ASSIGNES THE MODEM LABELS.     10333000
%                                                                       10334000
    DEFINE                                                              10335000
         INTERLOCKINTERRUPT      =  LAB(130)#,                          10336000
         LOSSOFINTERLOCK         =  LAB(131)#,                          10337000
         INTERLOCKCLEANUP        =  LAB(152)#,                          10338000
         INTERLOCK               =  LAB(234)#,                          10339000
         CARRIERINTERRUPT        =  LAB(134)#,                          10340000
         RINGINTERRUPT           =  LAB(135)#,                          10341000
         CLEARTOSENDINTERRUPT    =  LAB(136)#,                          10342000
         INITIATERECEIVE         =  LAB(137)#,                          10343000
         SYNCHRONIZERECEIVE      =  LAB(138)#,                          10344000
         LOOKFORDATA             =  LAB(337)#,                          10345000
         LOOKFORENQ              =  LAB(139)#,                          10346000
         FOUNDTHEENQ             =  LAB(335)#,                          10347000
         SETUPFORSYNC            =  LAB(140)#,                          10348000
         LOOKFORETX              =  LAB(142)#,                          10349000
         INCOMMING               =  LAB(144)#,                          10350000
         LASTTRANOK              =  LAB(145)#,                          10351000
         DEVICEQUEUEPRESENT      =  LAB(326)#,                          10352000
         DEVICEQUEUEUPDATED      =  LAB(327)#,                          10353000
         CLOSETHELINE            =  LAB(146)#,                          10354000
         LOOKFORACK              =  LAB(147)#,                          10355000
         FOUNDTHEACK             =  LAB(149)#,                          10356000
         FOUNDANAK               =  LAB(150)#,                          10357000
         DECYPHERRESPONSE        =  LAB(151)#,                          10358000
         LOOKFORHEADER           =  LAB(153)#,                          10359000
         MODEMLAB1               =  LAB(154)#,                          10360000
         STOREAMESSAGE           =  LAB(155)#,                          10361000
         GETABLOCK               =  LAB(156)#,                          10362000
         SECONDBLOCK             =  LAB(157)#,                          10363000
         FIRSTBLOCK              =  LAB(158)#,                          10364000
         BLANKSUPRESSION         =  LAB(159)#,                          10365000
         SUPRESSIT               =  LAB(160)#,                          10366000
         LPSUPRESS               =  LAB(161)#,                          10367000
         TOOMANYBLANKS           =  LAB(162)#,                          10368000
         CHECKBCC                =  LAB(163)#,                          10369000
         LASTRECOK               =  LAB(322)#,                          10370000
         BYPASSSUPRESS           =  LAB(318)#,                          10371000
         FOUNDANEOT              =  LAB(319)#,                          10372000
         PLACEENDOFBUFFERPOSITION=  LAB(320)#,                          10373000
         BADRECNO                =  LAB(164)#,                          10374000
         FORMATERROR             =  LAB(166)#,                          10375000
         MSGTOOLONG              =  LAB(168)#,                          10376000
         LOOKFORENDOFBLOCK       =  LAB(169)#,                          10377000
         EOM                     =  LAB(89)#,                           10378000
         GETACHAR                =  LAB(171)#,                          10379000
         INITIATETRANSMIT        =  LAB(172)#,                          10380000
         OKTOSEND                =  LAB(173)#,                          10381000
         SYNCHRONIZETRANSMISSION =  LAB(174)#,                          10382000
         TRANSMITSYNC            =  LAB(175)#,                          10383000
         ACKNOWLEDGELASTREC      =  LAB(176)#,                          10384000
         NOLINEACTIVITY          =  LAB(211)#,                          10385000
         WAKEUPLINE              =  LAB(178)#,                          10386000
         KILLTHELINE             =  LAB(179)#,                          10387000
         SENDAHEADER             =  LAB(180)#,                          10388000
         TAGAIN                  =  LAB(182)#,                          10389000
         EOB                     =  LAB(184)#,                          10390000
         ADDTOMESSAGE            =  LAB(185)#,                          10391000
         SENDAC                  =  LAB(186)#,                          10392000
         FINISHTRANSMIT          =  LAB(187)#,                          10393000
         READYTODROPLINE         =  LAB(189)#,                          10394000
         ABORTTRANSMIT           =  LAB(190)#,                          10395000
         IGNOREDATAINTERRUPTS    =  LAB(191)#,                          10396000
         ANSWERRING              =  LAB(193)#,                          10397000
         IGNORERING              =  LAB(194)#,                          10398000
         TSLEEPER                =  LAB(195)#,                          10399000
         RSLEEPER                =  LAB(196)#,                          10400000
         TSLEEPHERE              =  LAB(331)#,                          10401000
         RSLEEPHERE              =  LAB(332)#,                          10402000
         FINDAMESSAGE            =  LAB(197)#,                          10403000
         UNITFOUND               =  LAB(198)#,                          10404000
         NOGO                    =  LAB(199)#,                          10405000
         FINDAUNIT               =  LAB(200)#,                          10406000
         FOUNDTRAFFIC            =  LAB(201)#,                          10407000
         SETUPUDINFO             =  LAB(323)#,                          10408000
         NORMALCLEARTOSEND       =  LAB(202)#,                          10409000
         JUSTIDLEDTHELINE            =  LAB(261)#,                      10410000
         NORMALCARRIER           =  LAB(205)#,                          10411000
         FINDTHEACTION           =  LAB(206)#,                          10412000
         HANDLEBADTRAN           =  LAB(209)#,                          10413000
         CARRIERON               =  LAB(210)#,                          10414000
         MODEMIDLE               =  LAB(212)#,                          10415000
         OPENALINE               =  LAB(213)#,                          10416000
         NEWACTIVITY             =  LAB(95)#,                           10417000
         CONTROLGETSPACE         =  LAB(214)#,                          10418000
         SHORTSPACE              =  LAB(215)#,                          10419000
         CNOMEM                  =  LAB(216)#,                          10420000
         CONTROLFORGETSPACE      =  LAB(217)#,                          10421000
         LONGSPACE               =  LAB(218)#,                          10422000
         STORECC                 =  LAB(219)#,                          10423000
         SKIPBEFORE              =  LAB(220)#,                          10424000
         SIMPLESKIP              =  LAB(221)#,                          10425000
         SPACEIT                 =  LAB(222)#,                          10426000
         DSFIXED                 =  LAB(223)#,                          10427000
         DSFIXUP                 =  LAB(224)#,                          10428000
         SIMPLESPACE             =  LAB(225)#,                          10429000
         STOREMSG                =  LAB(127)#,                          10430000
         SENDANAK                =  LAB(129)#,                          10431000
         SENDACK                 =  LAB(188)#,                          10432000
         NOSPACEFORMODEM         =  LAB(83)#,                           10433000
         RETRY                   =  LAB(84)#,                           10434000
         LINKBACK                =  LAB(86)#,                           10435000
         MAKEANEWQ               =  LAB(87)#,                           10436000
         HL                      =  LAB(88)#,                           10437000
         EOREC                   =  LAB(94)#,                           10438000
         MAKENOTREADY            =  LAB(143)#,                          10439000
         MAKEREADY               =  LAB(165)#,                          10440000
         XIT                     =  LAB(226)#;                          10441000
%                                                                       10442000
%                                                                       10443000
%         THE NEXT BLOCK OF DEFINES RESERVES SPACE FOR THE MODEM STORAGE10444000
%         LOCATIONS.                                                    10445000
%                                                                       10446000
    DEFINE                                                              10447000
         RECEIVELABEL            =  LAB(230)#,                          10448000
         TRANSMITLABEL           =  LAB(231)#,                          10449000
         RINGLABEL               =  LAB(232)#,                          10450000
         CARRIERLABEL            =  LAB(233)#,                          10451000
         CLEARTOSENDLABEL        =  LAB(235)#,                          10452000
         MODEMSTATUS             =  LAB(236)#,                          10453000
         NEXTACTIVITY            =  LAB(237)#,                          10454000
         LASTACTIVITY            =  LAB(238)#,                          10455000
         ACTIONTYPE              =  LAB(239)#,                          10456000
         MCOUNT                  =  LAB(240)#,                          10457000
         RCOUNT                  =  LAB(96)#,                           10458000
         RECNO                   =  LAB(241)#,                          10459000
         TRANNO                  =  LAB(242)#,                          10460000
         BCC                     =  LAB(243)#,                          10461000
         MODEMFLAGS              =  LAB(244)#,                          10462000
         MC1                     =  LAB(245)#,                          10463000
         MC2                     =  LAB(246)#,                          10464000
         MC3                     =  LAB(321)#,                          10465000
         MODEMTEMP               =  LAB(247)#,                          10466000
         UNIT                    =  LAB(248)#,                          10467000
         UNITNO                  =  LAB(183)#,                          10468000
         UNITLIMIT               =  LAB(204)#,                          10469000
         UNITCOUNT               =  LAB(207)#,                          10470000
         UNITLIMITTABLE          =  LAB(262)#,                          10471000
         UNITCOUNTTABLE          =  LAB(266)#,                          10472000
         UD1                     =  LAB(249)#,                          10473000
         UD2                     =  LAB(250)#,                          10474000
         UDOFFSET                =  LAB(251)#,                          10475000
         UDLENGTH                =  LAB(252)#,                          10476000
         UDTOGS                  =  LAB(253)#,                          10477000
         ACTIONLABEL             =  LAB(255)#,                          10478000
         POWERSOF10              =  LAB(256)#,                          10479000
         TOGTABLE                =  LAB(37)#,                           10480000
         LENGTHTABLE             =  LAB(38)#,                           10481000
         LASTTRAN                =  LAB(77)#,                           10482000
         QUEUES                  =  LAB(78)#,                           10483000
         SOFTQTAIL               =  LAB(167)#,                          10484000
         MODEMPOINTER            =  LAB(80)#,                           10485000
         LASTREC                 =  LAB(81)#,                           10486000
         OFFSETTABLE             =  LAB(82)#,                           10487000
         OUTPUTUNITTABLE         =  LAB(12)#,                           10488000
         INPUTUNITTABLE          =  LAB(58)#,                           10489000
         CC1TABLE                =  LAB(181)#,                          10490000
         MASKTABLE               =  LAB(334)#,                          10491000
         MBUFF                   =  LAB(254)#;                          10492000
%                                                                       10493000
%                                                                       10494000
%         THE NEXT GROUP OF DEFINITIONS IS USED BY THE MODEM CODE.      10495000
%                                                                       10496000
    DEFINE                                                              10497000
%                                                                       10498000
         ENS   =   GOTO(XIT)#,                                          10499000
%                                                                       10500000
         DEBUGDUMP(X)   =  II := PRECISION;                             10501000
                         SP1;     LOAD(X);                              10502000
                         STIND(DEBUG);                                  10503000
                         SP2;     LOAD(DEBUG);                          10504000
                         IAR;     ST(DEBUG);                            10505000
                         EMIT(15 + II,1,2);   PRECISION := II#,         10506000
%                                                                       10507000
         RECEIVE     =     BRM(GETACHAR);                               10508000
                           PRECISION := 1#,                             10509000
%                                                                       10510000
         SEND(X)   =   IF PRECISION ! 1 THEN SP1;                       10511000
                       LOAD(X);                                         10512000
                       BRM(SENDAC)#,                                    10513000
%                                                                       10514000
         TRANSMIT(X)   =   IF PRECISION ! 1 THEN SP1;                   10515000
                           LOAD(X);                                     10516000
                           BTO(MODEMWRITE)#,                            10517000
%                                                                       10518000
         INITIALIZEBCC   =   IF PRECISION ! 1 THEN SP1;                 10519000
                             CLA;                                       10520000
                             ST(BCC)#,                                  10521000
%                                                                       10522000
         INCREMENT(X)   =   LOAD(X);                                    10523000
                            IAR;                                        10524000
                            ST(X)#,                                     10525000
%                                                                       10526000
         NEXT(X)   =   IF PRECISION ! 2 THEN SP2;                       10527000
                       LOAD(X);                                         10528000
                       ST(NEXTACTIVITY)#;                               10529000
%                                                                       10530000
%                                                                       10531000
%         THIS GROUP OF DEFINES DECLARES THE OPERATORS TO HANDLE        10532000
%         SPO CONSOL READS AND WRITES.  THERE ARE OTHER OPERATORS,      10533000
%         BUT THE SOFTWARE DOES NOT USE THEM.                           10534000
%                                                                       10535000
    DEFINE                                                              10536000
         SPOCLEAR               =  33#,     % FUN                       10537000
         SPOWRITEREADY          =  33#,     % SEN                       10538000
         SPOREADREADY           =  65#,     % SEN                       10539000
         SPOWRITE               =   1#,     % BTO                       10540000
         SPOREAD                =   1#;     % BTI                       10541000
%                                                                       10542000
%                                                                       10543000
%         THE NEXT FEW DEFINES DECLARE THE SPO STATUS BITS.             10544000
%                                                                       10545000
    DEFINE                                                              10546000
         DONTSTOREBIT           =  128#,                                10547000
         ECHOBIT                =   64#,                                10548000
         KEYINCONTINUEDBIT      =   32#,                                10549000
         %  NOT USED            =   16#,                                10550000
         %  NOT USED            =    8#,                                10551000
         %  NOT USED            =    4#,                                10552000
         OUTBUSYBIT             =    2#,                                10553000
         INBUSYBIT              =    1#;                                10554000
%                                                                       10555000
%         THE FOLLOWING IS THE ONLY SPO MESSAGE FOR SPO.                10556000
%                                                                       10557000
    DEFINE                                                              10558000
         REENTERKEYIN            =  137#;                               10559000
%                                                                       10560000
%                                                                       10561000
%                                                                       10562000
%         THE NEXT BLOCK OF DEFINES IS FOR MACRO OPTIONS USED BY        10563000
%         THE SPO CODE SPECIFICALLY AND BY OTHER PIECES OF CODE         10564000
%         POSSIBILY.                                                    10565000
%                                                                       10566000
    DEFINE                                                              10567000
         SPOUT(X)     =      IF PRECISION ! 2 THEN SP2;                 10568000
                             LOAD(X);                                   10569000
                             BRM(ENTERSPOUTMESSAGE)#,                   10570000
%                                                                       10571000
         SPOUTSLEEP(X)     =     IF PRECISION ! 2 AND X ! 0 THEN SP2;   10572000
                                 IF X = 0 THEN CLA ELSE DESC(X);        10573000
                                 BRM(SPOSLEEP)#,                        10574000
%                                                                       10575000
         CHAINDOWN     =     T(C,X);                                    10576000
                             LOADX(0);                                  10577000
                             SAZ;                                       10578000
                             GOTO(LOC-5)#;                              10579000
%                                                                       10580000
%                                                                       10581000
%         THE NEXT BLOCK OF CODE CONTAINS THE LABELS FOR THE SPO CODE.  10582000
%                                                                       10583000
    DEFINE                                                              10584000
         SPOINPUT                   =  LAB(263)#,                       10585000
         ACTUALSPOREAD              =  LAB(264)#,                       10586000
         ENDOFKEYIN                 =  LAB(265)#,                       10587000
         SPOQUEUEACTIVE             =  LAB(267)#,                       10588000
         LEAVEKEYIN                 =  LAB(268)#,                       10589000
         DELETEKEYIN                =  LAB(269)#,                       10590000
         ENDOFLINE                  =  LAB(270)#,                       10591000
         NEWKEYIN                   =  LAB(271)#,                       10592000
         NOSPACEFORKEYIN            =  LAB(272)#,                       10593000
         PLACEENDOFKEYIN            =  LAB(273)#,                       10594000
         SPOBACKSPACE               =  LAB(274)#,                       10595000
         DONTBACKSPACE              =  LAB(275)#,                       10596000
         ADDTOKEYIN                 =  LAB(276)#,                       10597000
         EXITADDTOKEYIN             =  LAB(277)#,                       10598000
         KEYINALREADYEXISTS         =  LAB(278)#,                       10599000
         IDLESPOREAD                =  LAB(279)#,                       10600000
         SPOUTNOTBUSY               =  LAB(280)#,                       10601000
         NOSYSTEMSPOUTS          =  LAB(76)#,                           10602000
         ECHOBACKKEYIN              =  LAB(281)#,                       10603000
         LONGKEYIN                  =  LAB(282)#,                       10604000
         ENDOFECHOBACK              =  LAB(283)#,                       10605000
         FINDASPOUT                 =  LAB(284)#,                       10606000
         SPOUTMSG                   =  LAB(285)#,                       10607000
         ENDOFSPOUT                 =  LAB(287)#,                       10608000
         REALENDOFSPOUT             =  LAB(288)#,                       10609000
         EXPANDSPOUT                =  LAB(289)#,                       10610000
         SPOUTCOMPRESSEDDATA        =  LAB(290)#,                       10611000
         ENTERSPOUTMESSAGE          =  LAB(292)#,                       10612000
         SPOSLEEP                   =  LAB(293)#,                       10613000
         TESTSPOINPUT               =  LAB(294)#,                       10614000
         TESTSPOOUTPUT              =  LAB(310)#;                       10615000
%                                                                       10616000
%                                                                       10617000
%         THE NEXT BLOCK OF DEFINES IS FOR THE STORAGE LOCATIONS        10618000
%         USED BY THE SPO CODE.                                         10619000
%                                                                       10620000
    DEFINE                                                              10621000
         SPOSTATUS                  =  LAB(314)#,                       10622000
         KEYINQ                  =  LAB(15)#,                           10623000
         KEYINQTAIL              =  LAB(16)#,                           10624000
         SPOUTQ                  =  LAB(79)#,                           10625000
         SPOUTQTAIL              =  LAB(315)#,                          10626000
         SPOUTBUFFERS            =  LAB(324)#,                          10627000
         SPOUTLABEL                 =  LAB(295)#,                       10628000
         SPO1                       =  LAB(296)#,                       10629000
         SPO2                       =  LAB(297)#,                       10630000
         SPOUTCOUNT                 =  LAB(298)#,                       10631000
         SPOUTBUFFER                =  LAB(299)#,                       10632000
         SPOUTPOINTER               =  LAB(300)#,                       10633000
         KEYIN                      =  LAB(301)#,                       10634000
         KEYINBUFFER                =  LAB(302)#,                       10635000
         KEYINPOINTER               =  LAB(303)#,                       10636000
         KEYINCOUNT                 =  LAB(304)#,                       10637000
         CHAR                       =  LAB(305)#,                       10638000
         SPOTABLE                   =  LAB(306)#,                       10639000
         SPOMAX                     =  LAB(307)#,                       10640000
         SPOMESS                    =  LAB(317)#,                       10641000
         NEXTSPOUT                  =  LAB(308)#,                       10642000
         PUTSPOUT                   =  LAB(309)#;                       10643000
%                                                                       10644000
PROCEDURE TSLEEP(XX);                                                   10645000
         VALUE XX;                                                      10646000
         REAL XX;                                                       10647000
    IF XX = 0 THEN BRM(TSLEEPHERE) ELSE                                 10648000
         BEGIN                                                          10649000
              IF PRECISION ! 2 THEN SP2;                                10650000
              DESC(XX);                                                 10651000
              GOTO(TSLEEPER);                                           10652000
         END;                                                           10653000
%                                                                       10654000
PROCEDURE RSLEEP(XX);                                                   10655000
         VALUE XX;                                                      10656000
         REAL XX;                                                       10657000
    IF XX = 0 THEN BRM(RSLEEPHERE) ELSE                                 10658000
         BEGIN                                                          10659000
              IF PRECISION ! 2 THEN SP2;                                10660000
              DESC(XX);                                                 10661000
              GOTO(RSLEEPER);                                           10662000
         END;                                                           10663000
%                                                                       10664000
%                                                                       20000000
%                                                                       20001000
%         PROCEDURE SPACEHANDLER CONTAINS THE LOGIC NEEDED TO PERFORM   20002000
%         THE SPACE HANDLING FUNCTIONS REQUIRED BY ANY CONFIGURATION    20003000
%         OF THE DC-1000.                                               20004000
%                                                                       20005000
PROCEDURE SPACEHANDLER;                                                 20006000
    BEGIN                                                               20007000
         REAL SEGMENT;                                                  20008000
%                                                                       20009000
    LABL(FORGETSPACE);                                                  20010000
              HEADING("FORGET ","SPACE  ",0,0,2);                       20011000
%                                                                       20012000
         DS2(0);                                                        20013000
         SP2;                                                           20014000
         SAZN;                                                          20015000
         GOTOIND(FORGETSPACE);                                          20016000
%                                                                       20017000
    IF PRINTERTOG THEN                                                  20018000
       BEGIN                                                            20019000
         SOVN;                                                          20020000
         GOTO(LONGSPACEFORGET);                                         20021000
       END;                                                             20022000
%                                                                       20023000
         SANN;                                                          20024000
         GOTOIND(FORGETSPACE);                                          20025000
%                                                                       20026000
         IBD;                                                           20027000
         CSQ(LOC+5);                                                    20028000
         GOTOIND(FORGETSPACE);                                          20029000
%                                                                       20030000
         SP2;                                                           20031000
         T(D,X);                                                        20032000
         LOAD(SHORTSPACEQ);                                             20033000
         STX(0);                                                        20034000
         T(X,C);                                                        20035000
         ST(SHORTSPACEQ);                                               20036000
         IBE;                                                           20037000
         CST;                                                           20038000
%                                                                       20039000
    IF PRINTERTOG THEN                                                  20040000
       BEGIN                                                            20041000
    LABL(LONGSPACEFORGET);                                              20042000
              HEADING("LONG SP","ACE FOR","GET    ",0,3);               20043000
%                                                                       20044000
         IBD;                                                           20045000
         CSQ(LOC+5);                                                    20046000
         GOTOIND(FORGETSPACE);                                          20047000
%                                                                       20048000
         SP2;                                                           20049000
         T(D,X);                                                        20050000
         LOAD(LONGSPACEQ);                                              20051000
         STX(0);                                                        20052000
         T(X,C);                                                        20053000
         ST(LONGSPACEQ);                                                20054000
         IBE;                                                           20055000
         CST;                                                           20056000
       END;                                                             20057000
%                                                                       20058000
    LABL(GETSPACE);                                                     20059000
              HEADING("GET SPA","CE     ",0,0,2);                       20060000
%                                                                       20061000
         DS2(0);                                                        20062000
         SP2;                                                           20063000
    IF PRINTERTOG THEN                                                  20064000
       BEGIN                                                            20065000
         SOVN;                                                          20066000
         GOTO(LONGSPACEGET);                                            20067000
       END;                                                             20068000
%                                                                       20069000
         IBD;                                                           20070000
         CSQ(LOC+5);                                                    20071000
         GOTOIND(GETSPACE);                                             20072000
%                                                                       20073000
         SP2;                                                           20074000
         LOAD(SHORTSPACEQ);                                             20075000
         SAZN;                                                          20076000
         GOTO(NOMEMORYLEFT);                                            20077000
%                                                                       20078000
         T(C,D);                                                        20079000
         LOADIND(SHORTSPACEQ);                                          20080000
         ST(SHORTSPACEQ);                                               20081000
         IBE;                                                           20082000
         CST;                                                           20083000
%                                                                       20084000
    IF PRINTERTOG THEN                                                  20085000
       BEGIN                                                            20086000
    LABL(LONGSPACEGET);                                                 20087000
              HEADING("LONG SP","ACE GET",0,0,2);                       20088000
%                                                                       20089000
         IBD;                                                           20090000
         CSQ(LOC+5);                                                    20091000
         GOTOIND(GETSPACE);                                             20092000
%                                                                       20093000
         SP2;                                                           20094000
         LOAD(LONGSPACEQ);                                              20095000
         SAZN;                                                          20096000
         GOTO(NOMEMORYLEFT);                                            20097000
%                                                                       20098000
         T(C,D);                                                        20099000
         LOADIND(LONGSPACEQ);                                           20100000
         ST(LONGSPACEQ);                                                20101000
         IBE;                                                           20102000
         CST;                                                           20103000
       END;                                                             20104000
%                                                                       20105000
    LABL(NOMEMORYLEFT);                                                 20106000
              HEADING("NO MEMO","RY LEFT",0,0,2);                       20107000
%                                                                       20108000
         T(Z,D);                                                        20109000
         IBE;                                                           20110000
         CST;                                                           20111000
%                                                                       20112000
    LABL(SUPERFORGET);                                                  20113000
              HEADING("SUPER F","ORGET  ",0,0,2);                       20114000
         DS2(0);                                                        20115000
%                                                                       20116000
    IF PRINTERTOG THEN                                                  20117000
       BEGIN                                                            20118000
         ST(MODEMTEMP);                                                 20119000
         LOAD(UDTOGS);                                                  20120000
         SR8;                                                           20121000
         SOD;                                                           20122000
         ROF;                                                           20123000
         SODN;                                                          20124000
         SOF;                                                           20125000
         NOP;                                                           20126000
         LOAD(MODEMTEMP);                                               20127000
       END                                                              20128000
    ELSE ROF;                                                           20129000
         BRM(CONTROLFORGETSPACE);                                       20130000
         GOTOIND(SUPERFORGET);                                          20131000
%                                                                       20132000
    LABL(CONTROLFORGETSPACE);                                           20133000
              HEADING("CONTROL"," FORGET"," SPACE ",0,3);               20134000
%                                                                       20135000
         DS2(0);                                                        20136000
         SAZN;                                                          20137000
         GOTOIND(CONTROLFORGETSPACE);                                   20138000
%                                                                       20139000
    IF PRINTERTOG THEN                                                  20140000
       BEGIN                                                            20141000
         SOVN;                                                          20142000
         GOTO(LONGSPACE);                                               20143000
       END;                                                             20144000
%                                                                       20145000
         T(C,A);                                                        20146000
         T(C,X);                                                        20147000
         LOADX(0);                                                      20148000
         SAZ;                                                           20149000
         GOTO(LOC-5);                                                   20150000
         LOAD(SHORTSPACEQ);                                             20151000
         SAZ;                                                           20152000
         STX(0);                                                        20153000
         T(A,C);                                                        20154000
         ST(SHORTSPACEQ);                                               20155000
         GOTOIND(CONTROLFORGETSPACE);                                   20156000
%                                                                       20157000
    IF PRINTERTOG THEN                                                  20158000
       BEGIN                                                            20159000
    LABL(LONGSPACE);                                                    20160000
              HEADING("LONG SP","ACE    ",0,0,2);                       20161000
%                                                                       20162000
         T(C,A);                                                        20163000
         T(C,X);                                                        20164000
         LOADX(0);                                                      20165000
         SAZ;                                                           20166000
         GOTO(LOC-5);                                                   20167000
         LOAD(LONGSPACEQ);                                              20168000
         SAZ;                                                           20169000
         STX(0);                                                        20170000
         T(A,C);                                                        20171000
         ST(LONGSPACEQ);                                                20172000
         GOTOIND(CONTROLFORGETSPACE);                                   20173000
       END;                                                             20174000
%                                                                       20175000
    LABL(CONTROLGETSPACE);                                              20176000
              HEADING("CONTROL"," GET SP","ACE    ",0,3);               20177000
%                                                                       20178000
         DS2(0);                                                        20179000
         SP2;                                                           20180000
%                                                                       20181000
    IF PRINTERTOG THEN                                                  20182000
       BEGIN                                                            20183000
         SOV;                                                           20184000
         GOTO(SHORTSPACE);                                              20185000
%                                                                       20186000
         LOAD(LONGSPACEQ);                                              20187000
         SAZN;                                                          20188000
         GOTO(CNOMEM);                                                  20189000
         T(C,X);                                                        20190000
         LOADX(0);                                                      20191000
         ST(LONGSPACEQ);                                                20192000
         T(X,C);                                                        20193000
         GOTOIND(CONTROLGETSPACE);                                      20194000
%                                                                       20195000
    LABL(SHORTSPACE);                                                   20196000
              HEADING("SHORT S","PACE   ",0,0,2);                       20197000
       END;                                                             20198000
%                                                                       20199000
         LOAD(SHORTSPACEQ);                                             20200000
         SAZN;                                                          20201000
         GOTO(CNOMEM);                                                  20202000
         T(C,X);                                                        20203000
         LOADX(0);                                                      20204000
         ST(SHORTSPACEQ);                                               20205000
         T(X,C);                                                        20206000
         GOTOIND(CONTROLGETSPACE);                                      20207000
%                                                                       20208000
    LABL(CNOMEM);                                                       20209000
              HEADING("CNOMEM ",0,0,0,1);                               20210000
%                                                                       20211000
         CLA;                                                           20212000
         GOTOIND(CONTROLGETSPACE);                                      20213000
%                                                                       20214000
%                                                                       20215000
    END OF SPACE HANDLER;                                               20216000
%                                                                       20217000
%                                                                       20218000
%         THE PROCEDURE TRANSLATORS CONTAINS THE LOGIC TO INCLUDE ANY   20219000
%         TRANSLATORS NEEDED BY ANY OTHER PART OF THE DC-1000 SYSTEM.   20220000
%                                                                       20221000
PROCEDURE TRANSLATORS;                                                  20222000
    BEGIN                                                               20223000
         REAL SEGMENT;                                                  20224000
%                                                                       20225000
    IF PRINTERTOG THEN                                                  20226000
       BEGIN                                                            20227000
    LABL(PRINTERTRANSLATE);                                             20228000
              HEADING("PRINTER"," TRANSL","ATE    ",0,3);               20229000
%                                                                       20230000
         DS2(0);                                                        20231000
         SP1;                                                           20232000
         SL1;                                                           20233000
         RL1;                                                           20234000
         SL1;                                                           20235000
         SR1;                                                           20236000
         IAR;                                                           20237000
         SR1;                                                           20238000
         SP2;                                                           20239000
         SL8;                                                           20240000
         SR8;                                                           20241000
         ADD(DES(LPTABLE));                                             20242000
         T(C,X);                                                        20243000
         SP1;                                                           20244000
         LOADX(0);                                                      20245000
         GOTOIND(PRINTERTRANSLATE);                                     20246000
       END;                                                             20247000
%                                                                       20248000
    END OF TRANSLATORS;                                                 20249000
%                                                                       20250000
%                                                                       20251000
%         THE FOLLOWING PROCEDURE RESERVES SPACE NEEDED BY THE VARIOUS  20252000
%         PERIPHERAL HANDLING ROUTINES.                                 20253000
%                                                                       20254000
PROCEDURE STORAGE;                                                      20255000
    BEGIN                                                               20256000
         REAL SEGMENT;                                                  20257000
%                                                                       20258000
    LABL(DEBUG);                                                        20259000
              HEADING("DEBUG  ",0,0,0,1);                               20260000
         DS2(MEMORY);                                                   20261000
%                                                                       20262000
    LABL(SHORTSPACEQ);                                                  20263000
              HEADING("SHORT S","PACE QU","EUE    ",0,3);               20264000
         DS2(0);                                                        20265000
%                                                                       20266000
    LABL(LONGSPACEQ);                                                   20267000
              HEADING("LONG SP","ACE QUE","UE     ",0,3);               20268000
         DS2(0);                                                        20269000
%                                                                       20270000
    LABL(CLOCK);                                                        20271000
              HEADING("CLOCK  ",0,0,0,1);                               20272000
         DS3(0);                                                        20273000
%                                                                       20274000
    LABL(NRMASK);                                                       20275000
              HEADING("NR MASK",0,0,0,1);                               20276000
         DS1(0);                                                        20277000
%                                                                       20278000
    LABL(ITEMP);                                                        20279000
              HEADING("ITEMP  ",0,0,0,1);                               20280000
         DS4(0);                                                        20281000
%                                                                       20282000
    LABL(QUEUES);                                                       20283000
              HEADING("QUEUES ",0,0,0,1);                               20284000
         DS2(0);                                                        20285000
    LABL(SOFTQTAIL);                                                    20286000
         DS2(0);                                                        20287000
%                                                                       20288000
    LABL(KEYINQ);                                                       20289000
              HEADING("KEYIN Q","UEUE   ",0,0,2);                       20290000
         DS2(0);                                                        20291000
    LABL(KEYINQTAIL);                                                   20292000
         DS2(0);                                                        20293000
%                                                                       20294000
    LABL(CARDREADERQ);                                                  20295000
              HEADING("CARD RE","ADER QU","EUE    ",0,3);               20296000
         DS2(0);                                                        20297000
    LABL(CARDREADERQTAIL);                                              20298000
         DS2(0);                                                        20299000
%                                                                       20300000
    LABL(SPOUTQ);                                                       20301000
              HEADING("SPOUT Q",0,0,0,1);                               20302000
         DS2(0);                                                        20303000
    LABL(SPOUTQTAIL);                                                   20304000
         DS2(0);                                                        20305000
%                                                                       20306000
    LABL(PRINTERQ);                                                     20307000
              HEADING("PRINTER"," Q     ",0,0,2);                       20308000
         DS2(0);                                                        20309000
    LABL(PRINTERTAIL);                                                  20310000
         DS2(0);                                                        20311000
%                                                                       20312000
%                                                                       20313000
%                                                                       20314000
    END OF STORAGE;                                                     20315000
%                                                                       20316000
%                                                                       20317000
%                                                                       20318000
%          THIS PROCEDURE CONTAINS THE CODE NEEDED TO PERFORM THE       20319000
%          OVERALL CONTROL FUNCTIONS OF THE DC-1000.                    20320000
%                                                                       20321000
PROCEDURE EXECUTIVE;                                                    20322000
    BEGIN                                                               20323000
%                                                                       20324000
    LABL(XIT);                                                          20325000
              HEADING("XIT    ",0,0,0,1);                               20326000
%                                                                       20327000
         SP4;                                                           20328000
         LOAD(ITEMP);                                                   20329000
         IBE;                                                           20330000
         CST;                                                           20331000
%                                                                       20332000
    LABL(NOTHINGTODO);                                                  20333000
              HEADING("NOTHING"," TO DO ",0,0,2);                       20334000
         SIE;   SOF;   HLT;                                             20335000
         SS3;     NOP;     HLT;                                         20336000
%                                                                       20337000
%         EXECUTIVE CODE TO HANDLE MODEM.                               20338000
%                                                                       20339000
    LABL(TESTMODEM);                                                    20340000
              HEADING("TEST MO","DEM    ",0,0,2);                       20341000
         SP1;                                                           20342000
         LOAD(MODEMFLAGS);                                              20343000
         SANN;                                                          20344000
         GOTO(LOC+5);                                                   20345000
         BRM(MODEMIDLE);                                                20346000
%                                                                       20347000
    LABL(TESTLP);                                                       20348000
              HEADING("TEST LP",0,0,0,1);                               20349000
    IF PRINTERTOG THEN                                                  20350000
       BEGIN                                                            20351000
         SP1;                                                           20352000
         LOAD(LPSTATUS);                                                20353000
         BRM(PRINTERCHECK);                                             20354000
       END;                                                             20355000
%                                                                       20356000
    LABL(TESTCR);                                                       20357000
              HEADING("TESTCR ",0,0,0,1);                               20358000
    IF READERTOG THEN                                                   20359000
       BEGIN                                                            20360000
         SP1;                                                           20361000
         LOAD(CRSTATUS);                                                20362000
         SANN;                                                          20363000
         GOTO(CRNOTREADY);                                              20364000
         SEN(CRBUSY);                                                   20365000
         GOTO(LOC+4);                                                   20366000
         GOTO(TESTCP);                                                  20367000
         BRM(CRREADY);                                                  20368000
       END;                                                             20369000
%                                                                       20370000
    LABL(TESTCP);                                                       20371000
              HEADING("TEST CP",0,0,0,1);                               20372000
%                                                                       20373000
    LABL(TESTSPOOUTPUT);                                                20374000
              HEADING("TEST SP","O OUTPU","T      ",0,3);               20375000
         SEN(SPOWRITEREADY);                                            20376000
         GOTO(LOC+4);                                                   20377000
         GOTOIND(SPOUTLABEL);                                           20378000
%                                                                       20379000
    LABL(TESTSPOINPUT);                                                 20380000
              HEADING("TEST SP","O INPUT",0,0,2);                       20381000
         SEN(SPOREADREADY);                                             20382000
         GOTO(LOC+4);                                                   20383000
         GOTO(SPOINPUT);                                                20384000
%                                                                       20385000
    LABL(NSECOND);                                                      20386000
              HEADING("N-SECON","D      ",0,0,2);                       20387000
         SP1;                                                           20388000
         LOAD(NRMASK);                                                  20389000
         SAZN;                                                          20390000
         GOTO(CHECKTIMER);                                              20391000
         SOD;                                                           20392000
         GOTO(LOC+13);                                                  20393000
         SP2;                                                           20394000
         LOAD(SPOUTQ);                                                  20395000
         SAZ;                                                           20396000
         GOTO(LOC+7);                                                   20397000
         CLA;                                                           20398000
         IAR;                                                           20399000
         BRM(MAKEREADY);                                                20400000
    IF PRINTERTOG THEN                                                  20401000
       BEGIN                                                            20402000
         SP1;                                                           20403000
         LOAD(NRMASK);                                                  20404000
         SR1;                                                           20405000
         SOD;                                                           20406000
         GOTO(LOC+13);                                                  20407000
         SP2;                                                           20408000
         LOAD(PRINTERQ);                                                20409000
         SAZ;                                                           20410000
         GOTO(LOC+7);                                                   20411000
         LOAD(3);                                                       20412000
         BRM(MAKEREADY);                                                20413000
       END;                                                             20414000
%                                                                       20415000
    LABL(CHECKTIMER);                                                   20416000
              HEADING("CHECK T","IMER   ",0,0,2);                       20417000
         SP2;                                                           20418000
         LOAD(LASTACTIVITY);                                            20419000
         SUB(TRANSMITENQ);                                              20420000
         SAZ;                                                           20421000
         GOTO(NOTHINGTODO);                                             20422000
         SP3;                                                           20423000
         LOAD(CLOCK);                                                   20424000
         IAR;                                                           20425000
         ST(CLOCK);                                                     20426000
         SANN;                                                          20427000
         GOTO(NOTHINGTODO);                                             20428000
%                                                                       20429000
    LABL(TIMEDOUT);                                                     20430000
              HEADING("TIMEDOU","T      ",0,0,2);                       20431000
         SP2;                                                           20432000
         CLA;                                                           20433000
         ST(LASTACTIVITY);                                              20434000
         SP1;                                                           20435000
         INCREMENT(MC3);                                                20436000
         SAZN;                                                          20437000
         GOTO(LOC+7);                                                   20438000
         BRM(OPENALINE);                                                20439000
         GOTO(NOTHINGTODO);                                             20440000
         SPOUT(HLMESS);                                                 20441000
         GOTO(NOTHINGTODO);                                             20442000
%                                                                       20443000
    END OF EXECUTIVE;                                                   20444000
%                                                                       20445000
%                                                                       20446000
%         INITIALIZE SYSTEM CREATES THE CODE NEEDED TO CLEAR ALL DEVICES20447000
%         AND TO INTERROGATE THE SATAUS OF EACH DEVICE AND SET THE      20448000
%         STATUS WORDS TO THE PROPER STATE.  THEN THE FREE SPACE QUEUES 20449000
%         ARE CREATED USING THE REST OF MEMORY.                         20450000
%                                                                       20451000
PROCEDURE INITIALIZSYSTEM;                                              20452000
    BEGIN                                                               20453000
         INTEGER SMALL,LARGE;                                           20454000
         LABEL EMITVAL,ALLSETNOW;                                       20455000
%                                                                       20456000
         DEFINE                                                         20457000
              OPTIMIZE(X)   =  (II + X > L[1,6].PHYSICALADDRESS AND     20458000
                   II + X < LABLUSE[IL2.LABLINDEX].PHYSICALADDRESS)     20459000
                   OR II + X GEQ LOC.ADDRESS + 4     #;                 20460000
%                                                                       20461000
    LABL(INITIALIZE);                                                   20462000
              HEADING("INITIAL","IZE    ",0,0,2);                       20463000
%                                                                       20464000
%                                                                       20465000
%         THE FOLLOWING IS SYSTEM INITIALIZE CODE FOR THE MODEMS.       20466000
%                                                                       20467000
         IBD;                                                           20468000
         CSQ(LOC+3);                                                    20469000
         FUN(TURNONDTR);                                                20470000
         SP2;                                                           20471000
         CLA;                                                           20472000
         IAR;                                                           20473000
         SAZ;                                                           20474000
         GOTO(LOC-2);                                                   20475000
         SEN(INTERLOCKON);                                              20476000
         GOTO(IL3);                                                     20477000
         SP1;                                                           20478000
         LOAD(CONNECTEDBIT + INTERLOCKBIT + DTRBIT);                    20479000
         ST(MODEMFLAGS);                                                20480000
         SP2;                                                           20481000
         DESC(IGNORERING);                                              20482000
         ST(RINGLABEL);                                                 20483000
         GOTO(IL4);                                                     20484000
    LABL(IL3);                                                          20485000
         SPOUT(NOSYSTEMLINK);                                           20486000
%                                                                       20487000
    LABL(IL4);                                                          20488000
         FUN(ENABLEMODEMINTERRUPT);                                     20489000
         SP3;                                                           20490000
         LOAD(LCS);                                                     20491000
         T(C,X);                                                        20492000
         SP1;                                                           20493000
         CLA;                                                           20494000
         STX(0);                                                        20495000
         INCR(X,X);                                                     20496000
         T(X,C);                                                        20497000
         SP2;                                                           20498000
         SUB(LM);                                                       20499000
         SANN;                                                          20500000
         GOTO(LOC-12);                                                  20501000
%                                                                       20502000
         SP2;                                                           20503000
         LOAD(LM);                                                      20504000
         T(C,X);                                                        20505000
         LOAD(EIGHTY4);                                                 20506000
         T(C,A);                                                        20507000
%                                                                       20508000
    LABL(IL);                                                           20509000
              HEADING("IL     ",0,0,0,1);                               20510000
%                                                                       20511000
         ADDR(A,X);                                                     20512000
         T(X,C);                                                        20513000
         SP2;                                                           20514000
         ROF;                                                           20515000
         BRM(FORGETSPACE);                                              20516000
         SP1;                                                           20517000
         LOAD(LCS);                                                     20518000
         IAR;                                                           20519000
         ST(LCS);                                                       20520000
         SAZ;                                                           20521000
         GOTO(IL);                                                      20522000
%                                                                       20523000
         SP2;                                                           20524000
         LOAD(ONE38);                                                   20525000
         T(C,A);                                                        20526000
%                                                                       20527000
    LABL(IL2);                                                          20528000
    IF PRINTERTOG THEN                                                  20529000
       BEGIN                                                            20530000
              HEADING("IL2    ",0,0,0,1);                               20531000
%                                                                       20532000
         SP2;                                                           20533000
         ADDR(A,X);                                                     20534000
         T(X,C);                                                        20535000
         SOF;                                                           20536000
         BRM(FORGETSPACE);                                              20537000
         SP1;                                                           20538000
         LOAD(LCL);                                                     20539000
         IAR;                                                           20540000
         ST(LCL);                                                       20541000
         SAZ;                                                           20542000
         GOTO(IL2);                                                     20543000
       END;                                                             20544000
%                                                                       20545000
         LOAD(IM);                                                      20546000
         MIN;                                                           20547000
%                                                                       20548000
         SS3;                                                           20549000
         HLT;                                                           20550000
         NOP;                                                           20551000
         SP2;                                                           20552000
         DESC(NOTHINGTODO);                                             20553000
         T(C,Q);                                                        20554000
         GOTO(HL);                                                      20555000
%                                                                       20556000
    LABL(LM);                                                           20557000
              HEADING("LM     ",0,0,0,1);                               20558000
         DS2(MEMORY);                                                   20559000
%                                                                       20560000
    LABL(IM);                                                           20561000
              HEADING("IM     ",0,0,0,1);                               20562000
         DS1(75);                                                       20563000
%                                                                       20564000
    LABL(ONE38);                                                        20565000
              HEADING("ONE38  ",0,0,0,1);                               20566000
         DS2(-138);                                                     20567000
%                                                                       20568000
    LABL(EIGHTY4);                                                      20569000
              HEADING("EIGHTY4",0,0,0,1);                               20570000
         DS2(-84);                                                      20571000
%                                                                       20572000
    LARGE := IF PRINTERTOG THEN 9 ELSE 0;                               20573000
    DO                                                                  20574000
    BEGIN                                                               20575000
         SMALL := SMALL + 1;                                            20576000
         II := MEMORY - (LARGE | 138) - (SMALL | 84);                   20577000
         IF II < L[1,6].PHYSICALADDRESS THEN GO TO EMITVAL;             20578000
    END UNTIL FALSE;                                                    20579000
%                                                                       20580000
EMITVAL:                                                                20581000
%                                                                       20582000
    FOR IJUNK := 84 STEP 84 UNTIL 420 DO                                20583000
         IF OPTIMIZE(IJUNK) THEN GO TO ALLSETNOW;                       20584000
%                                                                       20585000
ALLSETNOW:                                                              20586000
         SMALL := SMALL - (IJUNK DIV 84);                               20587000
%                                                                       20588000
    LABL(LCL);                                                          20589000
              HEADING("LCL    ",0,0,0,1);                               20590000
         DS1(-LARGE);                                                   20591000
%                                                                       20592000
   LABL(LCS);                                                           20593000
              HEADING("LCS    ",0,0,0,1);                               20594000
         DS1(-SMALL);                                                   20595000
%                                                                       20596000
         DS2(LOC);                                                      20597000
%                                                                       20598000
    END OF INITIALIZE SYSTEM;                                           20599000
%                                                                       20600000
%                                                                       20601000
%         INTERRUPTCODE CONTAINS THE CODE TO HANDLE ALL INTERRUPTS      20602000
%         RECEIVED BY THE DC-1000 AND THEN SOME.                        20603000
%                                                                       20604000
PROCEDURE INTERRUPTCODE;                                                20605000
    BEGIN                                                               20606000
         REAL SEGMENT;                                                  20607000
%                                                                       20608000
    LABL(IO0);                                                          20609000
              HEADING("IO0    ",0,0,0,1);                               20610000
%                                                                       20611000
         SP4;                                                           20612000
         ST(ITEMP);                                                     20613000
         SEN(DATAPRESENT);                                              20614000
         GOTOIND(TRANSMITLABEL);                                        20615000
         GOTOIND(RECEIVELABEL);                                         20616000
%                                                                       20617000
    LABL(IO1);                                                          20618000
              HEADING("IO1    ",0,0,0,1);                               20619000
%                                                                       20620000
    IF READERTOG THEN                                                   20621000
       BEGIN                                                            20622000
         SP4;                                                           20623000
         ST(ITEMP);                                                     20624000
         GOTO(CRINTERRUPT);                                             20625000
       END                                                              20626000
    ELSE                                                                20627000
       BEGIN                                                            20628000
         FUN(CRCLEAR);                                                  20629000
         IBE;   CST;                                                    20630000
       END;                                                             20631000
%                                                                       20632000
    LABL(IO2);                                                          20633000
              HEADING("IO2    ",0,0,0,1);                               20634000
%                                                                       20635000
         FUN(167);   IBE;   CST;                                        20636000
%                                                                       20637000
    LABL(IO3);                                                          20638000
              HEADING("IO3    ",0,0,0,1);                               20639000
%                                                                       20640000
         SP4;                                                           20641000
         ST(ITEMP);                                                     20642000
         SP1;                                                           20643000
         CIS;                                                           20644000
         SODN;                                                          20645000
         GOTO(CLEARTOSENDINTERRUPT);                                    20646000
         SR1;                                                           20647000
         SODN;                                                          20648000
         GOTO(CARRIERINTERRUPT);                                        20649000
         SR1;                                                           20650000
         SR1;                                                           20651000
         SODN;                                                          20652000
         SEN(PRINTCYCLEDONE);                                           20653000
         NOP;                                                           20654000
         NOP;                                                           20655000
         SR1;                                                           20656000
         SOD;                                                           20657000
         GOTO(LOC+8);                                                   20658000
         SEN(RINGRECEIVED);                                             20659000
         GOTO(INTERLOCKINTERRUPT);                                      20660000
         GOTO(RINGINTERRUPT);                                           20661000
         ENS;                                                           20662000
%                                                                       20663000
    END OF INTERRUPT CODE;                                              20664000
%                                                                       20665000
%                                                                       20666000
%         THE NEXT PROCEDURE CONTAINS THE CODE FOR CORE DUMPS TO        20667000
%         PRINTER.                                                      20668000
%                                                                       20669000
PROCEDURE DUMPDCCORE;                                                   20670000
    BEGIN                                                               20671000
         REAL SEGMENT;                                                  20672000
%                                                                       20673000
    DEFINE ACTUALMEMORY = 16384 + 32#;                                  20674000
%                                                                       20675000
    LABL(DUMPCORE);                                                     20676000
              HEADING("DUMP CO","RE     ",0,0,2);                       20677000
         DS2(0);                                                        20678000
         SP2;                                                           20679000
         CLA;                                                           20680000
         T(Z,B);                                                        20681000
    LABL(DUMPALINE);                                                    20682000
         SP2;                                                           20683000
         LOAD(-12);                                                     20684000
         ST(DC3);                                                       20685000
         LOAD(-3);                                                      20686000
         ST(DC1);                                                       20687000
         LOAD(-16);                                                     20688000
         ST(DC2);                                                       20689000
         T(B,X);                                                        20690000
         LOAD(48);                                                      20691000
         ADDR(C,X);                                                     20692000
         FUN(LPCLEAR);                                                  20693000
         CLA;                                                           20694000
         BRM(PRINTDUMPBYTE);                                            20695000
         BRM(DUMPSPACE);                                                20696000
%                                                                       20697000
         DECR(X,X);                                                     20698000
         LOADX(0);                                                      20699000
         T(X,D);                                                        20700000
         BRM(DUMPBYTE);                                                 20701000
         LOAD(DC2);                                                     20702000
         IAR;                                                           20703000
         ST(DC2);                                                       20704000
         T(D,X);                                                        20705000
         SAZ;                                                           20706000
         GOTO(LOC-17);                                                  20707000
%                                                                       20708000
         LOAD(-16);                                                     20709000
         ST(DC2);                                                       20710000
         LOAD(-5);                                                      20711000
         ST(DC3);                                                       20712000
         BRM(DUMPSPACE);                                                20713000
         LOAD(DC1);                                                     20714000
         IAR;                                                           20715000
         ST(DC1);                                                       20716000
         T(D,X);                                                        20717000
         SAZ;                                                           20718000
         GOTO(LOC-38);                                                  20719000
%                                                                       20720000
         LOAD(-5);                                                      20721000
         ST(DC3);                                                       20722000
         BRM(DUMPSPACE);                                                20723000
%                                                                       20724000
         T(B,C);                                                        20725000
         SL8;                                                           20726000
         BRM(DUMPBYTE);                                                 20727000
         T(B,C);                                                        20728000
         BRM(DUMPBYTE);                                                 20729000
         LOAD(32);                                                      20730000
         SEN(LPDATAREADY);                                              20731000
         GOTO(LOC-2);                                                   20732000
         BTO(LPFORMAT);                                                 20733000
         SEN(LPMOTIONDONE);                                             20734000
         GOTO(LOC-2);                                                   20735000
         SP1;                                                           20736000
         CLA;                                                           20737000
         IAR;                                                           20738000
         SAZ;                                                           20739000
         GOTO(LOC-2);                                                   20740000
         SEN(LPMOTIONDONE);                                             20741000
         GOTO(LOC-8);                                                   20742000
         SP2;                                                           20743000
         LOAD(48);                                                      20744000
         ADDR(C,B);                                                     20745000
         T(B,X);                                                        20746000
         SP1;                                                           20747000
         CLA;                                                           20748000
         ST(DC1);                                                       20749000
         INCR(X,X);                                                     20750000
         LOADX(0);                                                      20751000
         CMA;                                                           20752000
         SAZ;                                                           20753000
         GOTO(DUMPALINE);                                               20754000
         LOAD(DC1);                                                     20755000
         IAR;                                                           20756000
         ST(DC1);                                                       20757000
         SAZ;                                                           20758000
         GOTO(LOC-14);                                                  20759000
         GOTOIND(DUMPCORE);                                             20760000
%                                                                       20761000
    LABL(DC1);                                                          20762000
         DS2(0);                                                        20763000
    LABL(DC2);                                                          20764000
         DS2(0);                                                        20765000
    LABL(DC3);                                                          20766000
         DS2(0);                                                        20767000
%                                                                       20768000
    LABL(DUMPSPACE);                                                    20769000
         DS2(0);                                                        20770000
         LOAD(16);                                                      20771000
         BRM(PRINTDUMPBYTE);                                            20772000
         LOAD(DC3);                                                     20773000
         IAR;                                                           20774000
         ST(DC3);                                                       20775000
         SAZ;                                                           20776000
         GOTO(LOC-11);                                                  20777000
         GOTOIND(DUMPSPACE);                                            20778000
%                                                                       20779000
    LABL(PRINTDUMPBYTE);                                                20780000
         DS2(0);                                                        20781000
         SEN(LPDATAREADY);                                              20782000
         GOTO(LOC-2);                                                   20783000
         BTO(LPDATA);                                                   20784000
         GOTOIND(PRINTDUMPBYTE);                                        20785000
%                                                                       20786000
    LABL(DUMPBYTE);                                                     20787000
         DS2(0);                                                        20788000
         T(Z,A);                                                        20789000
         SP1;                                                           20790000
         SR8;                                                           20791000
         SP3;                                                           20792000
         SL1;   SL1;   SL1;   SL1;                                      20793000
         SP2;                                                           20794000
         RL1;   RL1;   RL1;   RL1;                                      20795000
         ROF;                                                           20796000
         ADD(DES(DUMPTABLE));                                           20797000
         T(C,X);                                                        20798000
         LOADX(0);                                                      20799000
         SR8;                                                           20800000
         BRM(PRINTDUMPBYTE);                                            20801000
         SOVN;                                                          20802000
         GOTOIND(DUMPBYTE);                                             20803000
         T(A,C);                                                        20804000
         SOF;                                                           20805000
         GOTO(LOC-16);                                                  20806000
%                                                                       20807000
    LABL(DUMPTABLE);                                                    20808000
         DS1(10);                                                       20809000
         DS1(1);                                                        20810000
         DS1(2);                                                        20811000
         DS1(3);                                                        20812000
         DS1(4);                                                        20813000
         DS1(5);                                                        20814000
         DS1(6);                                                        20815000
         DS1(7);                                                        20816000
         DS1(8);                                                        20817000
         DS1(9);                                                        20818000
         DS1(49);                                                       20819000
         DS1(50);                                                       20820000
         DS1(51);                                                       20821000
         DS1(52);                                                       20822000
         DS1(53);                                                       20823000
         DS1(54);                                                       20824000
%                                                                       20825000
    END OF DUMP DC CORE;                                                20826000
%                                                                       20827000
%                                                                       30000000
%                                                                       30001000
%         LINEPRINTERREADY CONTAINS THE CODE WHICH DECIEDES WHAT TO DO  30002000
%         WHEN THE LINE PRINTER IS READY (ON LINE).  THE CODE CONTAINED 30003000
%         HEREIN DECIDES WHEN TO FILL THE LINE PRINTER BUFFER,  WHEN TO 30004000
%         ORDER A PRINT OR FORM FEED, AND WHEN TO PREVENT USE OF THE    30005000
%         PRINTER.  MULTIPLE FORMAT AS WELL AS PRINT BEFORE AND PRINT   30006000
%         AFTER ARE INCLUDED HERE.                                      30007000
%                                                                       30008000
PROCEDURE LINEPRINTERREADY;                                             30009000
    BEGIN                                                               30010000
         REAL SEGMENT;                                                  30011000
%                                                                       30012000
    LABL(PRINTERCHECK);                                                 30013000
              HEADING("PRINTER"," CHECK ",0,0,2);                       30014000
         DS2(0);                                                        30015000
         RL1;                                                           30016000
         SANN;                                                          30017000
         GOTO(PRINTERLOCKED);                                           30018000
%                                                                       30019000
    LABL(NOPRINTERACTIVITY);                                            30020000
              HEADING("NO PRIN","TER ACT","IVITY  ",0,3);               30021000
         SEN(PRINTCYCLEDONE);                                           30022000
         GOTOIND(PRINTERCHECK);                                         30023000
         SEN(LPMOTIONDONE);                                             30024000
         GOTOIND(PRINTERCHECK);                                         30025000
         CLA;                                                           30026000
         SEN(LPERR);                                                    30027000
         GOTO(LOC+4);                                                   30028000
         ADD(LPERRBIT + LOCKBIT);                                       30029000
         SEN(ENDOFPAGE);                                                30030000
         GOTO(LOC+4);                                                   30031000
         ADD(EOPBIT);                                                   30032000
         T(C,A);                                                        30033000
         LOAD(LPSTATUS);                                                30034000
         ORR(A,C);                                                      30035000
         ST(LPSTATUS);                                                  30036000
         ANDM(LPERRBIT);                                                30037000
         SAZN;                                                          30038000
         GOTO(PRINTALINE);                                              30039000
         SPOUT(LPCK);                                                   30040000
         SP1;                                                           30041000
         FUN(LPCLEAR);                                                  30042000
         LOAD(LOCKBIT);                                                 30043000
         ST(LPSTATUS);                                                  30044000
         GOTOIND(PRINTERCHECK);                                         30045000
%                                                                       30046000
    LABL(PRINTERLOCKED);                                                30047000
              HEADING("PRINTER"," INTERL","OCKED  ",0,3);               30048000
         FUN(LPCLEAR);                                                  30049000
         SEN(LPREADY);                                                  30050000
         GOTO(LOC+4);                                                   30051000
         GOTO(PRINTERLOCKED2);                                          30052000
         LOAD(LPSTATUS);                                                30053000
         ANDM(255 - LOCKBIT2);                                          30054000
         ADD(LOCKBIT2);                                                 30055000
         ST(LPSTATUS);                                                  30056000
         GOTOIND(PRINTERCHECK);                                         30057000
%                                                                       30058000
    LABL(PRINTERLOCKED2);                                               30059000
              HEADING("PRINTER"," LOCKED","2      ",0,3);               30060000
         RL1;                                                           30061000
         SAN;                                                           30062000
         GOTOIND(PRINTERCHECK);                                         30063000
         LOAD(MOTIONDONEBIT);                                           30064000
         ST(LPSTATUS);                                                  30065000
         GOTO(NOPRINTERACTIVITY);                                       30066000
%                                                                       30067000
    LABL(SETPRINTERNOTREADY);                                           30068000
              HEADING("SET PRI","NTER NO","T READY",0,3);               30069000
         LOAD(LOCKBIT);                                                 30070000
         ST(LPSTATUS);                                                  30071000
         SPOUT(LPNR);                                                   30072000
         GOTOIND(PRINTERCHECK);                                         30073000
%                                                                       30074000
%                                                                       30075000
    LABL(PRINTALINE);                                                   30076000
              HEADING("PRINT A"," LINE  ",0,0,2);                       30077000
         FUN(LPCLEAR);                                                  30078000
         LOAD(PRINTERFORMATCOUNT);                                      30079000
         SAZ;                                                           30080000
         GOTO(PRINTTHEBUFFER);                                          30081000
         SP2;                                                           30082000
         LOAD(PRINTERQ);                                                30083000
         T(C,X);                                                        30084000
         SAZN;                                                          30085000
         GOTOIND(PRINTERCHECK);                                         30086000
         SEN(LPREADY);                                                  30087000
         GOTO(SETPRINTERNOTREADY);                                      30088000
         SP1;                                                           30089000
         LOADX(LINEFORMAT);                                             30090000
         ANDM(127);                                                     30091000
         SAZ;                                                           30092000
         GOTO(LOC+14);                                                  30093000
         LOADX(LINEFORMAT);                                             30094000
         ADDX(LINEREPLICATOR);                                          30095000
         STX(LINEFORMAT);                                               30096000
         CLA;                                                           30097000
         IAR;                                                           30098000
         STX(LINEREPLICATOR);                                           30099000
         GOTO(LOC-17);                                                  30100000
         LOADX(LINEFORMAT);                                             30101000
         ST(NEXTPRINTERFORMAT);                                         30102000
         SANN;                                                          30103000
         GOTO(PRINTAFTER);                                              30104000
%                                                                       30105000
         LOADX(LINEREPLICATOR);                                         30106000
         CIA;                                                           30107000
         ST(PRINTERFORMATCOUNT);                                        30108000
         GOTO(NORMALPRINT);                                             30109000
%                                                                       30110000
    LABL(PRINTAFTER);                                                   30111000
              HEADING("PRINT A","FTER   ",0,0,2);                       30112000
         LOADX(LINEREPLICATOR);                                         30113000
         CIA;                                                           30114000
         ST(PRINTERFORMATCOUNT);                                        30115000
         CLA;                                                           30116000
         STX(LINEFORMAT);                                               30117000
         IAR;                                                           30118000
         STX(LINEREPLICATOR);                                           30119000
         GOTO(PRINTIT);                                                 30120000
%                                                                       30121000
    LABL(NORMALPRINT);                                                  30122000
              HEADING("NORMAL ","PRINT  ",0,0,2);                       30123000
         SP2;                                                           30124000
         LOAD(PRINTERQ);                                                30125000
         T(C,X);                                                        30126000
         ADD(FIRSTPRINTCHAR - 1);                                       30127000
         ST(LPLIMIT);                                                   30128000
         T(C,A);                                                        30129000
         LOADX(2);                                                      30130000
         SR8;                                                           30131000
         SAZN;                                                          30132000
         GOTO(PRINTNOBUFFER);                                           30133000
         SUB(7);                                                        30134000
         SAZN;                                                          30135000
         GOTO(PRINTNOBUFFER);                                           30136000
         ADD(7);                                                        30137000
         ADDR(X,C);                                                     30138000
         ST(LPPOINTER);                                                 30139000
         T(C,X);                                                        30140000
%                                                                       30141000
    LABL(LOADPRINTCHAR);                                                30142000
              HEADING("LOAD A ","PRINT C","HAR    ",0,3);               30143000
         CLA;                                                           30144000
         SP1;                                                           30145000
         LOADIND(LPPOINTER);                                            30146000
         SUB(COMPRESSCHAR);                                             30147000
         SAZN;                                                          30148000
         GOTO(EXPANDPRINTERDATA);                                       30149000
         ADD(COMPRESSCHAR);                                             30150000
         BRM(PRINTERTRANSLATE);                                         30151000
         SEN(LPDATAREADY);                                              30152000
         GOTO(LOC-2);                                                   30153000
         BTO(LPDATA);                                                   30154000
%                                                                       30155000
    LABL(PRINTERTEST);                                                  30156000
              HEADING("PRINTER"," TEST  ",0,0,2);                       30157000
         SP2;                                                           30158000
         LOAD(LPPOINTER);                                               30159000
         DECR(C,C);                                                     30160000
         ST(LPPOINTER);                                                 30161000
         SUB(LPLIMIT);                                                  30162000
         SAZ;                                                           30163000
         GOTO(LOADPRINTCHAR);                                           30164000
%                                                                       30165000
    LABL(PRINTNOBUFFER);                                                30166000
              HEADING("PRINT N","O BUFFE","R      ",0,3);               30167000
         IBD;                                                           30168000
         CSQ(LOC+3);                                                    30169000
         SP1;                                                           30170000
         LOAD(PRINTERBUFFERS);                                          30171000
         SUB(1);                                                        30172000
         ST(PRINTERBUFFERS);                                            30173000
         SP2;                                                           30174000
         LOAD(PRINTERQ);                                                30175000
         T(C,X);                                                        30176000
         LOADX(0);                                                      30177000
         ST(PRINTERQ);                                                  30178000
         SAZN;                                                          30179000
         ST(PRINTERTAIL);                                               30180000
         T(X,D);                                                        30181000
         IBE;                                                           30182000
         CSQ(LOC+3);                                                    30183000
         SOF;                                                           30184000
         BRM(FORGETSPACE);                                              30185000
         SP3;                                                           30186000
         LOAD(CLOCK);                                                   30187000
         ADD(125);                                                      30188000
         ST(CLOCK);                                                     30189000
         GOTO(PRINTIT);                                                 30190000
%                                                                       30191000
    LABL(EXPANDPRINTERDATA);                                            30192000
              HEADING("EXPAND ","PRINTER"," DATA  ",0,3);               30193000
         SP2;                                                           30194000
         LOAD(LPPOINTER);                                               30195000
         DECR(C,X);                                                     30196000
         DECR(X,C);                                                     30197000
         ST(LPPOINTER);                                                 30198000
         CLA;                                                           30199000
         SP1;                                                           30200000
         LOADX(0);                                                      30201000
         CIA;                                                           30202000
         ST(PRINTERLOOPCONTROL);                                        30203000
         LOADIND(LPPOINTER);                                            30204000
         BRM(PRINTERTRANSLATE);                                         30205000
         T(C,A);                                                        30206000
         T(A,C);                                                        30207000
         SEN(LPDATAREADY);                                              30208000
         GOTO(LOC-2);                                                   30209000
         BTO(LPDATA);                                                   30210000
         LOAD(PRINTERLOOPCONTROL);                                      30211000
         IAR;                                                           30212000
         ST(PRINTERLOOPCONTROL);                                        30213000
         SAZ;                                                           30214000
         GOTO(LOC-14);                                                  30215000
         GOTO(PRINTERTEST);                                             30216000
%                                                                       30217000
    LABL(PRINTTHEBUFFER);                                               30218000
              HEADING("PRINT T","HE BUFF","ER     ",0,3);               30219000
         SEN(LPREADY);                                                  30220000
          GOTO(SETPRINTERNOTREADY);                                     30221000
%                                                                       30222000
    LABL(PRINTIT);                                                      30223000
              HEADING("PRINTIT",0,0,0,1);                               30224000
         SP1;                                                           30225000
         LOAD(LPSTATUS);                                                30226000
         SR1;                                                           30227000
         SL1;                                                           30228000
         IAR;                                                           30229000
         ST(LPSTATUS);                                                  30230000
         RL1;                                                           30231000
         RL1;                                                           30232000
         RL1;                                                           30233000
         SAN;                                                           30234000
         GOTO(PRINTERLAB2);                                             30235000
         LOAD(PAGESKIP);                                                30236000
         BTO(LPFORMAT);                                                 30237000
         LOAD(LPSTATUS);                                                30238000
         ANDM(255 - EOPBIT);                                            30239000
         ST(LPSTATUS);                                                  30240000
         GOTOIND(PRINTERCHECK);                                         30241000
%                                                                       30242000
    LABL(PRINTERLAB2);                                                  30243000
              HEADING("PRINTER"," LAB2  ",0,0,2);                       30244000
         LOAD(PRINTERFORMATCOUNT);                                      30245000
         IAR;                                                           30246000
         ST(PRINTERFORMATCOUNT);                                        30247000
         LOAD(NEXTPRINTERFORMAT);                                       30248000
         BTO(LPFORMAT);                                                 30249000
         SUB(SINGLESPACE);                                              30250000
         SAZ;                                                           30251000
         GOTOIND(PRINTERCHECK);                                         30252000
%                                                                       30253000
         LOAD(PRINTERFORMATCOUNT);                                      30254000
         SODN;                                                          30255000
         GOTOIND(PRINTERCHECK);                                         30256000
         SANN;                                                          30257000
         IAR;                                                           30258000
         NOP;                                                           30259000
         RR1;                                                           30260000
         ST(PRINTERFORMATCOUNT);                                        30261000
         LOAD(DOUBLESPACE);                                             30262000
         ST(NEXTPRINTERFORMAT);                                         30263000
         GOTOIND(PRINTERCHECK);                                         30264000
%                                                                       30265000
%                                                                       30266000
    END OF LINE PRINTER READY;                                          30267000
%                                                                       30268000
%                                                                       30269000
%         LINEPRINTERTABLE CONTAINS THE SPECIAL FORM ASCII(67) TO BCL   30270000
%         EXTERNAL TABLES NEEDED BY THE ROUTINE PRINTERTRANSLATE TO     30271000
%         CONVERT THE ASCII(67) INPUT INTO PRINTED OUTPUT.              30272000
%                                                                       30273000
PROCEDURE LINEPRINTERTABLES;                                            30274000
    BEGIN                                                               30275000
    REAL SEGMENT;                                                       30276000
%                                                                       30277000
    LABL(LPTABLE);                                                      30278000
              HEADING("LP TABL","E      ",0,0,2);                       30279000
%                                                                       30280000
         FOR II := 16,12,15,49,31,50,11,51 DO DS1(II);                  30281000
         FOR II := 43,52,28,53,48,54,47,55 DO DS1(II);                  30282000
         FOR II := 61,56,45,57,44,33,58,34 DO DS1(II);                  30283000
         FOR II := 27,35,32,36,59,37,17,38 DO DS1(II);                  30284000
         FOR II := 10,39,1,40,2,41,3,18 DO DS1(II);                     30285000
         FOR II := 4,19,5,20,6,21,7,22 DO DS1(II);                      30286000
         FOR II := 8,23,9,24,13,25,46,60 DO DS1(II);                    30287000
         FOR II := 62,42,29,30,14,26,0,63 DO DS1(II);                   30288000
%                                                                       30289000
    LABL(PRINTERCCTABLE);                                               30290000
              HEADING("PRINTER"," CC TAB","LE     ",0,3);               30291000
         FOR II := 0,16,0,16,0,128+16,128 DO DS1(II);                   30292000
%                                                                       30293000
    END OF LINE PRINTER TABLES;                                         30294000
%                                                                       30295000
%                                                                       30296000
%         LINEPRINTERSTORAGE RESERVES THE STORAGE LOCATIONS NEEDED      30297000
%         TO HANDLE THE LINE PRINTER.                                   30298000
%                                                                       30299000
PROCEDURE LINEPRINTERSTORAGE;                                           30300000
    BEGIN                                                               30301000
         REAL SEGMENT;                                                  30302000
    LABL(LPSTATUS);                                                     30303000
              HEADING("LP STAT","US     ",0,0,2);                       30304000
         DS1(0);                                                        30305000
%                                                                       30306000
    LABL(NEXTPRINTERFORMAT);                                            30307000
              HEADING("NEXT PR","INT FOR","MAT    ",0,3);               30308000
         DS1(0);                                                        30309000
%                                                                       30310000
    LABL(PRINTERFORMATCOUNT);                                           30311000
              HEADING("FORMAT ","COUNT  ",0,0,2);                       30312000
         DS1(0);                                                        30313000
%                                                                       30314000
    LABL(PRINTERBUFFERS);                                               30315000
              HEADING("PRINTER"," BUFFER","S      ",0,3);               30316000
         DS1(0);                                                        30317000
%                                                                       30318000
    LABL(PRINTERLOOPCONTROL);                                           30319000
              HEADING("PRINTER"," LOOP C","ONTROL ",0,3);               30320000
         DS1(0);                                                        30321000
%                                                                       30322000
    LABL(LPPOINTER);                                                    30323000
              HEADING("LP POIN","TER    ",0,0,2);                       30324000
         DS2(0);                                                        30325000
%                                                                       30326000
    LABL(LPLIMIT);                                                      30327000
              HEADING("LP LIMI","T      ",0,0,2);                       30328000
         DS2(0);                                                        30329000
%                                                                       30330000
%                                                                       30331000
    END OF LINE PRINTER STORAGE;                                        30332000
%                                                                       30333000
%                                                                       35000000
%         CARDREADERINTERRUPT CONTAINS THE CODE TO HANDLE               35001000
%         A CARD READER INTERRUPT.  IF THE INTERRUPT WAS                35002000
%         CAUSED BY DATA READY THEN THE COLUMN IS STORED IN THE         35003000
%         CARD READER BUFFER AREA(CRBUFFER).  IF THE INTERRUPT          35004000
%         WAS ANYTHING ELSE, THEN PROPER ACTION FOR READER              35005000
%         NOT READY OR END OF CARD I/O ARE TAKEN.                       35006000
%                                                                       35007000
PROCEDURE CARDREADERINTERRUPT;                                          35008000
    BEGIN                                                               35009000
              REAL SEGMENT;                                             35010000
%                                                                       35011000
    LABL(CRINTERRUPT);                                                  35012000
              HEADING("CARD RE","ADER IN","TERRUPT",0,3);               35013000
%                                                                       35014000
         SEN(CRDATAREADY);                                              35015000
         GOTO(CARDREADERINTERRUPTNOTDATAREADY);                         35016000
         SP1;                                                           35017000
         LOAD(CRCOUNT);                                                 35018000
         SAZN;                                                          35019000
         GOTO(READCHECK);                                               35020000
         IAR;                                                           35021000
         ST(CRCOUNT);                                                   35022000
         LOAD(CRSTATUS);                                                35023000
         ANDM(255 - CRFIRSTBIT);                                        35024000
         ST(CRSTATUS);                                                  35025000
         SP2;                                                           35026000
         BTI(CRREAD);                                                   35027000
         SL8;                                                           35028000
         BTI(CRREAD);                                                   35029000
         STIND(CRPOINTER);                                              35030000
         LOAD(CRPOINTER);                                               35031000
         IAR;                                                           35032000
         IAR;                                                           35033000
         ST(CRPOINTER);                                                 35034000
         ENS;                                                           35035000
%                                                                       35036000
    LABL(CARDREADERINTERRUPTNOTDATAREADY);                              35037000
              HEADING("READER ","INTERRU","PT NOT ","DATA   ",4);       35038000
%                                                                       35039000
         FUN(CRCLEAR);                                                  35040000
         SP1;                                                           35041000
         LOAD(CRSTATUS);                                                35042000
         ANDM(CRFIRSTBIT);                                              35043000
         SAZ;                                                           35044000
         GOTO(EMPTYCARDREADERHOPPER);                                   35045000
         LOAD(CRCOUNT);                                                 35046000
         SAZ;                                                           35047000
         GOTO(READCHECK);                                               35048000
         LOAD(CRBUFFFULLBIT);                                           35049000
         ST(CRSTATUS);                                                  35050000
         ENS;                                                           35051000
%                                                                       35052000
    LABL(EMPTYCARDREADERHOPPER);                                        35053000
              HEADING("EMPTY C","ARD REA","DER HOP","PER    ",4);       35054000
%                                                                       35055000
         PRECISION := 1;                                                35056000
         LOAD(CRSTATUS);                                                35057000
         ANDM(255 - NOTREADYBIT - BUSYBIT);                             35058000
         ADD(NOTREADYBIT);                                              35059000
         ST(CRSTATUS);                                                  35060000
         ENS;                                                           35061000
%                                                                       35062000
    LABL(READCHECK);                                                    35063000
              HEADING("READ CH","ECK    ",0,0,2);                       35064000
%                                                                       35065000
         PRECISION := 1;                                                35066000
         FUN(CRCLEAR);                                                  35067000
         LOAD(LOCKBIT);                                                 35068000
         ST(CRSTATUS);                                                  35069000
         SPOUT(CRERR);                                                  35070000
         ENS;                                                           35071000
    END OF CARD READER INTERRUPT;                                       35072000
%                                                                       35073000
%                                                                       35074000
%         PROCEDURE CARDREADERNOTREADY CONTAINS THE CODE TO SPOUT       35075000
%         "CR NOT READY" ON THE SPO.                                    35076000
%                                                                       35077000
PROCEDURE CARDREADERNOTREADY;                                           35078000
    BEGIN                                                               35079000
         REAL SEGMENT;                                                  35080000
%                                                                       35081000
    LABL(CRNOTREADY);                                                   35082000
              HEADING("CARD RE","ADER NO","T READY",0,3);               35083000
         PRECISION := 1;                                                35084000
         SL1;                                                           35085000
         SANN;                                                          35086000
         GOTO(TESTCP);                                                  35087000
%                                                                       35088000
         SPOUT(CRNR);                                                   35089000
         SP1;                                                           35090000
         LOAD(CRSTATUS);                                                35091000
         ANDM(255 - NOTREADYBIT - LOCKBIT - LOCKBIT2);                  35092000
         ADD(LOCKBIT);                                                  35093000
         ST(CRSTATUS);                                                  35094000
         GOTO(TESTCP);                                                  35095000
%                                                                       35096000
    END OF CARD READER NOT READY;                                       35097000
%                                                                       35098000
%                                                                       35099000
%         CARDREADERNOTREADY CONTAINS THE CODE TO DETERMINE             35100000
%         IF A CARD I/O CAN BE STARTED, OR IF ANY ERROR MESSAGES        35101000
%         SHOULD BE PRINTED ON THE SUPERVISORY PRINTER;                 35102000
%                                                                       35103000
PROCEDURE CARDREADERREADY;                                              35104000
    BEGIN                                                               35105000
         REAL SEGMENT;                                                  35106000
%                                                                       35107000
    LABL(CRREADY);                                                      35108000
              HEADING("CARD RE","ADER RE","ADY    ",0,3);               35109000
%                                                                       35110000
         DS2(0);                                                        35111000
         SODN;                                                          35112000
         GOTO(TESTCP);                                                  35113000
         RR1;                                                           35114000
         SODN;                                                          35115000
         GOTO(MOVECRBUFFER);                                            35116000
%                                                                       35117000
         RL1;                                                           35118000
         SL1;                                                           35119000
         SANN;                                                          35120000
         GOTO(CARDREADERLOCKED);                                        35121000
%                                                                       35122000
    LABL(CARDREADERSTARTIO);                                            35123000
              HEADING("CARD RE","ADER ST","ART I/O",0,3);               35124000
%                                                                       35125000
         SP2;                                                           35126000
         DESC(CRBUFFER);                                                35127000
         ST(CRPOINTER);                                                 35128000
         SP1;                                                           35129000
         LOAD(-80);                                                     35130000
         ST(CRCOUNT);                                                   35131000
         LOAD(CRFIRSTBIT + BUSYBIT);                                    35132000
         ST(CRSTATUS);                                                  35133000
         FUN(CRCLEAR);                                                  35134000
         FUN(CRINITIATE);                                               35135000
         FUN(ENABLECRINTERRUPT);                                        35136000
         GOTOIND(CRREADY);                                              35137000
%                                                                       35138000
    LABL(CARDREADERLOCKED);                                             35139000
              HEADING("CARD RE","ADER LO","CKED   ",0,3);               35140000
%                                                                       35141000
         RL1;                                                           35142000
         SANN;                                                          35143000
         GOTO(CARDREADERLOCKED2);                                       35144000
         SEN(CRONLINE);                                                 35145000
         GOTO(LOC+4);                                                   35146000
         GOTOIND(CRREADY);                                              35147000
%                                                                       35148000
         ADD(128);                                                      35149000
         RR1;                                                           35150000
         RR1;                                                           35151000
         ST(CRSTATUS);                                                  35152000
         GOTOIND(CRREADY);                                              35153000
%                                                                       35154000
    LABL(CARDREADERLOCKED2);                                            35155000
              HEADING("CARD RE","ADER LO","CKED2  ",0,3);               35156000
%                                                                       35157000
         SEN(CRONLINE);                                                 35158000
         GOTOIND(CRREADY);                                              35159000
         GOTO(CARDREADERSTARTIO);                                       35160000
%                                                                       35161000
    END OF CARD READER READY;                                           35162000
%                                                                       35163000
%                                                                       35164000
%                                                                       35165000
%         PROCEDURE MOVEIT CONTAINS THE CODE TO MOVE A CARD             35166000
%         IMAGE FROM THE CARDBUFFER TO A DATA AREA.  THIS CODE ALSO     35167000
%         COMPRESSES ALL RUNS OF FIVE OR MORE BLANKS INTO THE           35168000
%         STANDARD FORM FOR BLANK SUPRESSED DATA.                       35169000
%                                                                       35170000
PROCEDURE CARDREADERMOVER;                                              35171000
    BEGIN                                                               35172000
         BEGIN REAL SEGMENT;                                            35173000
%                                                                       35174000
    LABL(MOVECRBUFFER);                                                 35175000
              HEADING("MOVE CR"," BUFFER",0,0,2);                       35176000
         PRECISION := 1;                                                35177000
         SR1;                                                           35178000
         SODN;                                                          35179000
         GOTO(CARDREADERERROR);                                         35180000
         LOAD(-79);                                                     35181000
         ST(CRCOUNT);                                                   35182000
         LOAD(CRFLAGS);                                                 35183000
         ANDM(CRINHIBITBIT);                                            35184000
         SAZ;                                                           35185000
         GOTO(LOC+7);                                                   35186000
         CLA;                                                           35187000
         ST(CRFLAGS);                                                   35188000
         ST(CRSUPRESSCOUNT);                                            35189000
         ROF;                                                           35190000
         BRM(GETSPACE);                                                 35191000
         SP2;                                                           35192000
         SAZN;                                                          35193000
         GOTO(DONTTRANSFERCRBUFFER);                                    35194000
%                                                                       35195000
         ST(CRTEMP);                                                    35196000
         ADD(3);                                                        35197000
         DECR(C,B);                                                     35198000
         DESC(CRBUFFER);                                                35199000
         DECR(C,D);                                                     35200000
         GOTO(LOC+5);                                                   35201000
%                                                                       35202000
    LABL(GETNEXTCARDCOL);                                               35203000
              HEADING("GET NEX","T CARD ","COL    ",0,3);               35204000
%                                                                       35205000
         IAR;                                                           35206000
         ST(CRCOUNT);                                                   35207000
         INCR(B,B);                                                     35208000
         INCR(D,X);                                                     35209000
         INCR(X,D);                                                     35210000
         SP2;                                                           35211000
         LOADX(0);                                                      35212000
%                                                                       35213000
         RR1;                                                           35214000
         SODN;                                                          35215000
         ADD(2047);                                                     35216000
         RL8;                                                           35217000
         ST(CRSCRATCH);                                                 35218000
         ANDM(65408);                                                   35219000
         T(Z,A);                                                        35220000
         SAZN;                                                          35221000
         GOTO(LOC+10);                                                  35222000
%                                                                       35223000
         INCR(A,A);                                                     35224000
         SANN;                                                          35225000
         GOTO(LOC+5);                                                   35226000
         SL1;                                                           35227000
         GOTO(LOC-6);                                                   35228000
%                                                                       35229000
         SL1;                                                           35230000
         SAZ;                                                           35231000
         GOTO(INVALIDCARDCHAR);                                         35232000
%                                                                       35233000
         SP1;                                                           35234000
         LOAD(CRSCRATCH2);                                              35235000
         ANDM(15);                                                      35236000
         SP2;                                                           35237000
         ADD(CURRENTCARDTABLE);                                         35238000
         T(C,X);                                                        35239000
         LOADX(0);                                                      35240000
         SANN;                                                          35241000
         GOTO(CHECKFORINVALIDCHAR);                                     35242000
%                                                                       35243000
         SR8;                                                           35244000
         ADD(DES(CRTABLE));                                             35245000
         T(C,X);                                                        35246000
         ADDR(A,X);                                                     35247000
         SP1;                                                           35248000
         LOADX(0);                                                      35249000
         SANN;                                                          35250000
         GOTO(INVALIDCARDCHAR);                                         35251000
%                                                                       35252000
    LABL(STORECARDCHAR);                                                35253000
              HEADING("STORE C","ARD CHA","R      ",0,3);               35254000
%                                                                       35255000
         T(B,X);                                                        35256000
         STX(0);                                                        35257000
%                                                                       35258000
         SUB(BLANK);                                                    35259000
         SAZ;                                                           35260000
         GOTO(MAYBEENDOFCRSUPRESSION);                                  35261000
         LOAD(CRSUPRESSCOUNT);                                          35262000
         SUB(5);                                                        35263000
         SAZN;                                                          35264000
         GOTO(INITIALIZECRSUPRESSION);                                  35265000
         ADD(6);                                                        35266000
         ST(CRSUPRESSCOUNT);                                            35267000
%                                                                       35268000
    LABL(TESTFORCRDONE);                                                35269000
              HEADING("TEST FO","R CR DO","NE     ",0,3);               35270000
%                                                                       35271000
         SP1;                                                           35272000
         LOAD(CRCOUNT);                                                 35273000
         SAZ;                                                           35274000
         GOTO(GETNEXTCARDCOL);                                          35275000
         LOAD(CRFLAGS);                                                 35276000
         SOD;                                                           35277000
         GOTO(MAYBEENDOFCRSUPRESSION);                                  35278000
         SP2;                                                           35279000
         LOAD(CRSUPRESSCOUNT);                                          35280000
         SR8;                                                           35281000
         CIA;                                                           35282000
         ADDR(C,B);                                                     35283000
         GOTO(LOCALTESTFORCRDONE);                                      35284000
%                                                                       35285000
    LABL(MAYBEENDOFCRSUPRESSION);                                       35286000
              HEADING("MAYBE E","ND OF C","R SUPRE","SSION  ",4);       35287000
%                                                                       35288000
         LOAD(CRFLAGS);                                                 35289000
         SAZN;                                                          35290000
         ST(CRSUPRESSCOUNT);                                            35291000
         SAZN;                                                          35292000
         GOTO(LOCALTESTFORCRDONE);                                      35293000
         CLA;                                                           35294000
         ST(CRFLAGS);                                                   35295000
         SP2;                                                           35296000
         LOAD(CRSUPRESSCOUNT);                                          35297000
         SR8;                                                           35298000
         IAR;                                                           35299000
         CIA;                                                           35300000
         ADDR(C,B);                                                     35301000
         CMA;                                                           35302000
         T(Z,X);                                                        35303000
         SXZ;                                                           35304000
         INCR(X,X);                                                     35305000
         SUB(10);                                                       35306000
         SAN;                                                           35307000
         GOTO(LOC-5);                                                   35308000
         ADD(10);                                                       35309000
         SP2;                                                           35310000
         SL8;                                                           35311000
         ORR(X,C);                                                      35312000
         RL8;                                                           35313000
         ADD(12336);                                                    35314000
         INCR(B,X);                                                     35315000
         STX(1);                                                        35316000
         SP1;                                                           35317000
         LOAD(COMPRESSCHAR);                                            35318000
         STX(0);                                                        35319000
         SP2;                                                           35320000
         LOAD(4);                                                       35321000
         ADDR(C,B);                                                     35322000
%                                                                       35323000
         LOAD(CRSUPRESSCOUNT);                                          35324000
         SR8;                                                           35325000
         ADDR(C,X);                                                     35326000
         SP1;                                                           35327000
         LOADX(0);                                                      35328000
         T(B,X);                                                        35329000
         STX(0);                                                        35330000
%                                                                       35331000
    END OF SEGMENT;                                                     35332000
%                                                                       35333000
    LABL(LOCALTESTFORCRDONE);                                           35334000
              HEADING("LOCAL T","EST FOR"," CR DON","E      ",4);       35335000
%                                                                       35336000
         SP1;                                                           35337000
         LOAD(CRCOUNT);                                                 35338000
         SAZ;                                                           35339000
         GOTO(GETNEXTCARDCOL);                                          35340000
%                                                                       35341000
         T(B,X);                                                        35342000
         LOAD(CR);                                                      35343000
         STX(1);                                                        35344000
%                                                                       35345000
         SP2;                                                           35346000
         LOAD(CRTEMP);                                                  35347000
         T(C,X);                                                        35348000
         CIA;                                                           35349000
         ADDR(B,C);                                                     35350000
         SP1;                                                           35351000
         STX(2);                                                        35352000
         SP2;                                                           35353000
         CLA;                                                           35354000
         STX(0);                                                        35355000
%                                                                       35356000
         IBD;                                                           35357000
         CSQ(LOC+3);                                                    35358000
         SP2;                                                           35359000
         LOAD(CARDREADERQ);                                             35360000
         SAZN;                                                          35361000
         GOTO(LOC+10);                                                  35362000
%                                                                       35363000
         T(Y,C);                                                        35364000
         STIND(CARDREADERQTAIL);                                        35365000
         ST(CARDREADERQTAIL);                                           35366000
         GOTO(LOC+8);                                                   35367000
%                                                                       35368000
         T(Y,C);                                                        35369000
         ST(CARDREADERQTAIL);                                           35370000
         ST(CARDREADERQ);                                               35371000
%                                                                       35372000
         IBE;                                                           35373000
         CSQ(LOC+3);                                                    35374000
         SP1;                                                           35375000
         CLA;                                                           35376000
         ST(CRFLAGS);                                                   35377000
         ST(CRSTATUS);                                                  35378000
         SP3;                                                           35379000
         LOAD(CLOCK);                                                   35380000
         ADD(180);                                                      35381000
         ST(CLOCK);                                                     35382000
         GOTO(TESTCR);                                                  35383000
%                                                                       35384000
    LABL(INITIALIZECRSUPRESSION);                                       35385000
              HEADING("INITIAL","IZE CR ","COMPRES","SION   ",4);       35386000
%                                                                       35387000
         PRECISION := 1;                                                35388000
         LOAD(6);                                                       35389000
         ST(CRSUPRESSCOUNT);                                            35390000
         CLA;                                                           35391000
         IAR;                                                           35392000
         ST(CRFLAGS);                                                   35393000
         GOTO(TESTFORCRDONE);                                           35394000
%                                                                       35395000
    LABL(DONTTRANSFERCRBUFFER);                                         35396000
              HEADING("DONT TR","ANSFER ","CR BUFF","ER     ",4);       35397000
%                                                                       35398000
         SP1;                                                           35399000
         LOAD(CRSTATUS);                                                35400000
         ANDM(CRINHIBITBIT);                                            35401000
         SAZ;                                                           35402000
         GOTO(TESTCP);                                                  35403000
         LOAD(CRINHIBITBIT);                                            35404000
         ADD(CRSTATUS);                                                 35405000
         ST(CRSTATUS);                                                  35406000
         SPOUT(NOMEM);                                                  35407000
         GOTO(CARDREADERSTARTIO);                                       35408000
%                                                                       35409000
     LABL(CARDREADERERROR);                                             35410000
              HEADING("CARD RE","ADER ER","ROR    ",0,3);               35411000
%                                                                       35412000
         PRECISION := 1;                                                35413000
         SPOUT(CRERR);                                                  35414000
         SP1;                                                           35415000
         LOAD(CRSTATUS);                                                35416000
         ANDM(255 - CRERRBIT - LOCKBIT - LOCKBIT2);                     35417000
         ANDM(LOCKBIT);                                                 35418000
         ST(CRSTATUS);                                                  35419000
         GOTO(TESTCP);                                                  35420000
%                                                                       35421000
    LABL(CHECKFORINVALIDCHAR);                                          35422000
             HEADING("CHECK F","OR INVA","LID CHA","R      ",4);        35423000
%                                                                       35424000
         SR8;                                                           35425000
         SP1;                                                           35426000
         SUB(128);                                                      35427000
         SAZ;                                                           35428000
         GOTO(STORECARDCHAR);                                           35429000
%                                                                       35430000
    LABL(INVALIDCARDCHAR);                                              35431000
              HEADING("INVALID"," CARD C","HAR    ",0,3);               35432000
%                                                                       35433000
         SP2;                                                           35434000
         DECR(D,C);                                                     35435000
         SUB(DES(CRBUFFER));                                            35436000
         SAZ;                                                           35437000
         GOTO(LOC+7);                                                   35438000
         SP1;                                                           35439000
         LOAD(QM);                                                      35440000
         GOTO(STORECARDCHAR);                                           35441000
         PRECISION := 2;                                                35442000
         SPOUT(CRINV);                                                  35443000
         SP1;                                                           35444000
         LOAD(LOCKBIT);                                                 35445000
         ST(CRSTATUS);                                                  35446000
         GOTO(TESTCP);                                                  35447000
%                                                                       35448000
    END OF CARD READER MOVER;                                           35449000
%                                                                       35450000
%                                                                       35451000
%         CARDREADERSTORAGE RESERVES ALL OF THE LOW MEMORY STORAGE      35452000
%         LOCATIONS NEEDED FOR HANDLING THE CARD READER.                35453000
%                                                                       35454000
PROCEDURE CARDREADERSTORAGE;                                            35455000
    BEGIN                                                               35456000
         REAL SEGMENT;                                                  35457000
%                                                                       35458000
    LABL(CRSTATUS);                                                     35459000
              HEADING("CR STAT","US WORD",0,0,2);                       35460000
         DS1(LOCKBIT);                                                  35461000
%                                                                       35462000
    LABL(CRFLAGS);                                                      35463000
              HEADING("CARD RE","ADER FL","AGS    ",0,3);               35464000
         DS1(0);                                                        35465000
%                                                                       35466000
    LABL(CRCOUNT);                                                      35467000
              HEADING("CARD RE","ADER CO","UNT    ",0,3);               35468000
         DS1(0);                                                        35469000
%                                                                       35470000
    LABL(CRSUPRESSCOUNT);                                               35471000
              HEADING("CR BLAN","K SUPRE","SSION C","OUNT   ",4);       35472000
         DS1(0);                                                        35473000
%                                                                       35474000
    LABL(CRPOINTER);                                                    35475000
              HEADING("CARD RE","ADER PO","INTER  ",0,3);               35476000
         DS2(0);                                                        35477000
%                                                                       35478000
    LABL(CRTEMP);                                                       35479000
              HEADING("CR TEMP",0,0,0,1);                               35480000
         DS2(0);                                                        35481000
%                                                                       35482000
    LABL(CRSCRATCH);                                                    35483000
              HEADING("CR SCRA","TCH    ",0,0,2);                       35484000
         DS1(0);                                                        35485000
%                                                                       35486000
    LABL(CRSCRATCH2);                                                   35487000
              HEADING("CR SCRA","TCH 2  ",0,0,2);                       35488000
         DS1(0);                                                        35489000
%                                                                       35490000
    LABL(CURRENTCARDTABLE);                                             35491000
              HEADING("CURRENT"," CARD T","ABLE   ",0,3);               35492000
         DA(BCLVECTOR);                                                 35493000
%                                                                       35494000
    END OF CARD READER STORAGE;                                         35495000
%                                                                       35496000
%                                                                       35497000
%         CARDREADERTABLES CONTAINS THE DATA NEEDED BY THE              35498000
%         CARD READER ROUTINES.  THIS PROCEDURE ALSO RESERVES           35499000
%         THE PHYSICAL I/O BUFFER FOR THE CARD READING PROCESS.         35500000
%                                                                       35501000
PROCEDURE CARDREADERTABLES;                                             35502000
    BEGIN                                                               35503000
         REAL SEGMENT;                                                  35504000
%                                                                       35505000
    LABL(BCLVECTOR);                                                    35506000
              HEADING("BCL VEC","TOR    ",0,0,2);                       35507000
%                                                                       35508000
         FOR II := 0,10,20,ASCII["|"]+128,30,ASCII["+"]+128,            35509000
                   128,128,40,50,60,128,70,128,128,128 DO DS1(II);      35510000
%                                                                       35511000
    LABL(EBCDICVECTOR);                                                 35512000
              HEADING("EBCDIC ","VECTOR ",0,0,2);                       35513000
         FOR II := 0,10,20,ASCII["|"]+128,30,128,128,128,80,90,100,     35514000
                   128,110,128,128,128 DO DS1(II);                      35515000
%                                                                       35516000
    LABL(CRTABLE);                                                      35517000
              HEADING("CR TABL","E      ",0,0,2);                       35518000
%                                                                       35519000
         FOR II := " ",1,2,3,4,5,6,7,0,9,0,"/","S","T","U",             35520000
                   "V","W","X",0,"Z","-","J","K","L","M","N",           35521000
                   "O","P",0,"R","&","A","B","C","D","E","F",           35522000
                   "G",0,"I",8  DO DS1(ASCII[II]);                      35523000
%                                                                       35524000
         DS1(128);                                                      35525000
%                                                                       35526000
         FOR II := "?","#","@",":",">","}",0 DO DS1(ASCII[II]);         35527000
%                                                                       35528000
         DS1(128);                                                      35529000
         DS1(ASCII["Y"]);                                               35530000
         DS1(128);                                                      35531000
%                                                                       35532000
         FOR II := "!",",","%","=","]",""",0 DO DS1(ASCII[II]);         35533000
%                                                                       35534000
         DS1(128);                                                      35535000
         DS1(ASCII["Q"]);                                               35536000
         DS1(128);                                                      35537000
         DS1(128);                                                      35538000
%                                                                       35539000
         FOR II := "$","*",")",";","{",0 DO DS1(ASCII[II]);             35540000
%                                                                       35541000
         DS1(128);                                                      35542000
         DS1(ASCII["H"]);                                               35543000
         DS1(128);                                                      35544000
         DS1(128);                                                      35545000
%                                                                       35546000
         FOR II := ".","[","(","<" DO DS1(ASCII[II]);                   35547000
%                                                                       35548000
         DS1(96);                                                       35549000
         DS1(0);                                                        35550000
         DS1(128);                                                      35551000
%                                                                       35552000
         FOR II := "8",64,":","#","@",64,"=",""",64,64 DO MSG(II);      35553000
%                                                                       35554000
         FOR II := "Y","}",64,",","%",64,">",12,64,64  DO MSG(II);      35555000
%                                                                       35556000
         FOR II := "Q","!","]","$","*",")",";",64,64,64 DO MSG(II);     35557000
%                                                                       35558000
         FOR II := "H","{","[",".","<","(","+" DO MSG(II);              35559000
%                                                                       35560000
         FOR II := 96,128,128 DO DS1(II);                               35561000
%                                                                       35562000
    LABL(CRBUFFER);                                                     35563000
              HEADING("CARD RE","ADER BU","FFER   ",0,3);               35564000
%                                                                       35565000
         FOR II := 0 STEP 1 UNTIL 79 DO DS2(0);                         35566000
%                                                                       35567000
    END OF CARD READER TABLES;                                          35568000
%                                                                       35569000
%                                                                       40000000
%         THE NEXT PROCEDURE CONTAINS THE GENERAL SPO CODE.             40001000
%                                                                       40002000
PROCEDURE SPOCODE;                                                      40003000
    BEGIN                                                               40004000
         REAL SEGMENT;                                                  40005000
%                                                                       40006000
    LABL(ENTERSPOUTMESSAGE);                                            40007000
              HEADING("ENTER S","POUT ME","SSAGE  ",0,3);               40008000
         PRECISION := 2;                                                40009000
         DS2(0);                                                        40010000
         ADD(DES(SPOMESS));                                             40011000
         SL1;     IAR;     RR1;                                         40012000
         FUN(DISABLEMODEMINTERRUPT);                                    40013000
         STIND(PUTSPOUT);                                               40014000
         LOAD(PUTSPOUT);                                                40015000
         IAR;     IAR;                                                  40016000
         ST(PUTSPOUT);                                                  40017000
         SUB(DES(SPOMAX));                                              40018000
         SAZ;                                                           40019000
         GOTO(LOC+6);                                                   40020000
         DESC(SPOTABLE);                                                40021000
         ST(PUTSPOUT);                                                  40022000
         FUN(ENABLEMODEMINTERRUPT);                                     40023000
         GOTOIND(ENTERSPOUTMESSAGE);                                    40024000
%                                                                       40025000
    LABL(SPOSLEEP);                                                     40026000
              HEADING("SPO SLE","EP     ",0,0,2);                       40027000
         DS2(0);                                                        40028000
         SAZ;                                                           40029000
         GOTO(LOC+5);                                                   40030000
         SP2;                                                           40031000
         LOAD(SPOSLEEP);                                                40032000
         ST(SPOUTLABEL);                                                40033000
         GOTO(TESTSPOINPUT);                                            40034000
%                                                                       40035000
     END OF SPO CODE;                                                   40036000
%                                                                       40037000
%                                                                       40038000
%         THE NEXT PROCEDURE CONTAINS THE CODE FOR HANDLING SPO INPUT.  40039000
%         IT CAN HANDLE MULTI-LINE SPO INPUTS,BACKSPACING, INCLUDING    40040000
%         BACKSPACING PAST THE BEGINNING OF LINE, AND KEYINS WHEN NO    40041000
%         SPACE IS AVAILABLE FOR STORING THE MESSAGE.  DELETE IS ALSO   40042000
%         HANDLED PROPERLY BY THIS PIECE OF CODE.  ONE NEED ONLY DEPRESS40043000
%         THE FIRST KEY OF THE MESSAGE THEN WAIT FOR THAT LETTER TO BE  40044000
%         PRINTED IN ORDER TO START THE ENTRY OF A SPO MESSAGE.         40045000
%         THE  CHARACTER " IS THE BACKSPACE CHARACTER AS IT IS FOR      40046000
%         THE CENTRAL SPO.  A MESSAGE CAN BE DELETED BY TYPING RUB OUT  40047000
%         (THE KEY).  DEPRESSING RETURN CAUSED END OF MESSAGE ACTION.   40048000
%                                                                       40049000
PROCEDURE KEYINCODE;                                                    40050000
    BEGIN                                                               40051000
         REAL SEGMENT;                                                  40052000
%                                                                       40053000
    LABL(SPOINPUT);                                                     40054000
              HEADING("SPO INP","UT     ",0,0,2);                       40055000
         SP1;                                                           40056000
         LOAD(SPOSTATUS);                                               40057000
         SOD;                                                           40058000
         GOTO(NEWKEYIN);                                                40059000
         SANN;                                                          40060000
         GOTO(IDLESPOREAD);                                             40061000
         SL1;                                                           40062000
         SANN;                                                          40063000
         GOTO(ACTUALSPOREAD);                                           40064000
         BTI(SPOREAD);                                                  40065000
         GOTO(NSECOND);                                                 40066000
%                                                                       40067000
    LABL(ACTUALSPOREAD);                                                40068000
              HEADING("ACTUAL ","SPO REA","D      ",0,3);               40069000
         SEN(SPOREADREADY);                                             40070000
         GOTO(NSECOND);                                                 40071000
         BTI(SPOREAD);                                                  40072000
         CMA;                                                           40073000
         SAZN;                                                          40074000
         GOTO(DELETEKEYIN);                                             40075000
         CMA;                                                           40076000
         ANDM(127);                                                     40077000
         ST(CHAR);                                                      40078000
         STIND(KEYINPOINTER);                                           40079000
         SUB(CR);                                                       40080000
         SAZN;                                                          40081000
         GOTO(ENDOFKEYIN);                                              40082000
         SUB(32 - CR);                                                  40083000
         SANN;                                                          40084000
         GOTO(NSECOND);                                                 40085000
         SUB(96 - 32 + CR);                                             40086000
         SAN;                                                           40087000
         GOTO(NSECOND);                                                 40088000
         INCREMENT(KEYINCOUNT);                                         40089000
         SAZN;                                                          40090000
         GOTO(ENDOFLINE);                                               40091000
         SP2;                                                           40092000
         INCREMENT(KEYINPOINTER);                                       40093000
         GOTO(NSECOND);                                                 40094000
%                                                                       40095000
    LABL(ENDOFKEYIN);                                                   40096000
              HEADING("END OF ","KEYIN  ",0,0,2);                       40097000
         PRECISION := 1;                                                40098000
         LOAD(SPOSTATUS);                                               40099000
         SAN;                                                           40100000
         GOTO(LOC+11);                                                  40101000
         SPOUT(REENTERKEYIN);                                           40102000
         SP1;                                                           40103000
         LOAD(SPOSTATUS);                                               40104000
         ANDM(255 - DONTSTOREBIT - INBUSYBIT);                          40105000
         ST(SPOSTATUS);                                                 40106000
         BRM(PLACEENDOFKEYIN);                                          40107000
         BRM(ADDTOKEYIN);                                               40108000
         PRECISION := 2;                                                40109000
         LOAD(KEYINQ);                                                  40110000
         SAZ;                                                           40111000
         GOTO(SPOQUEUEACTIVE);                                          40112000
         FUN(DISABLEMODEMINTERRUPT);                                    40113000
         LOAD(KEYIN);                                                   40114000
         SAZN;                                                          40115000
         GOTO(LEAVEKEYIN);                                              40116000
         ST(KEYINQ);                                                    40117000
         CHAINDOWN;                                                     40118000
         T(X,C);                                                        40119000
         ST(KEYINQTAIL);                                                40120000
         GOTO(LEAVEKEYIN);                                              40121000
%                                                                       40122000
    LABL(SPOQUEUEACTIVE);                                               40123000
              HEADING("SPO QUE","UE ACTI","VE     ",0,3);               40124000
         FUN(DISABLEMODEMINTERRUPT);                                    40125000
         LOAD(KEYIN);                                                   40126000
         SAZN;                                                          40127000
         GOTO(LEAVEKEYIN);                                              40128000
         STIND(KEYINQTAIL);                                             40129000
         CHAINDOWN;                                                     40130000
         T(X,C);                                                        40131000
         ST(KEYINQTAIL);                                                40132000
%                                                                       40133000
    LABL(LEAVEKEYIN);                                                   40134000
              HEADING("LEAVE K","EYIN   ",0,0,2);                       40135000
         FUN(ENABLEMODEMINTERRUPT);                                     40136000
         CLA;                                                           40137000
         ST(KEYIN);                                                     40138000
         GOTO(NSECOND);                                                 40139000
%                                                                       40140000
    LABL(DELETEKEYIN);                                                  40141000
              HEADING("DELETE ","KEYIN  ",0,0,2);                       40142000
         PRECISION := 1;                                                40143000
         LOAD(CR);                                                      40144000
         ST(CHAR);                                                      40145000
         LOAD(SPOSTATUS);                                               40146000
         ANDM(255 - DONTSTOREBIT - INBUSYBIT);                          40147000
         ST(SPOSTATUS);                                                 40148000
         BRM(ADDTOKEYIN);                                               40149000
         LOAD(KEYIN);                                                   40150000
         T(C,X);                                                        40151000
         SXZN;                                                          40152000
         GOTO(LOC+16);                                                  40153000
         LOADX(0);                                                      40154000
         T(C,A);                                                        40155000
         T(X,C);                                                        40156000
         ROF;                                                           40157000
         BRM(FORGETSPACE);                                              40158000
         T(A,C);                                                        40159000
         GOTO(LOC-17);                                                  40160000
         CLA;                                                           40161000
         ST(KEYIN);                                                     40162000
         GOTO(NSECOND);                                                 40163000
%                                                                       40164000
    LABL(ENDOFLINE);                                                    40165000
              HEADING("END OF ","LINE   ",0,0,2);                       40166000
         SP1;                                                           40167000
         LOAD(SPOSTATUS);                                               40168000
         ADD(KEYINCONTINUEDBIT);                                        40169000
         ST(SPOSTATUS);                                                 40170000
         BRM(PLACEENDOFKEYIN);                                          40171000
         BRM(ADDTOKEYIN);                                               40172000
         GOTO(LOC+15);                                                  40173000
%                                                                       40174000
    LABL(NEWKEYIN);                                                     40175000
              HEADING("NEW KEY","IN     ",0,0,2);                       40176000
         RR1;                                                           40177000
         SOD;                                                           40178000
         GOTO(LOC+11);                                                  40179000
         RL1;                                                           40180000
         ANDM(255 - KEYINCONTINUEDBIT - INBUSYBIT);                     40181000
         ADD(KEYINCONTINUEDBIT + INBUSYBIT);                            40182000
         ST(SPOSTATUS);                                                 40183000
         BTI(SPOREAD);                                                  40184000
         ROF;                                                           40185000
         BRM(GETSPACE);                                                 40186000
         SP2;                                                           40187000
         SAZN;                                                          40188000
         GOTO(NOSPACEFORKEYIN);                                         40189000
         T(C,X);                                                        40190000
         ST(KEYINBUFFER);                                               40191000
         ADD(3);                                                        40192000
         ST(KEYINPOINTER);                                              40193000
         SP1;                                                           40194000
         LOAD(-72);                                                     40195000
         ST(KEYINCOUNT);                                                40196000
         LOAD(SPOSTATUS);                                               40197000
         SR1;                                                           40198000
         SL1;                                                           40199000
         IAR;                                                           40200000
         ST(SPOSTATUS);                                                 40201000
         GOTO(ACTUALSPOREAD);                                           40202000
%                                                                       40203000
    LABL(NOSPACEFORKEYIN);                                              40204000
              HEADING("NO SPAC","E FOR K","EYIN   ",0,3);               40205000
         SP1;                                                           40206000
         LOAD(SPOSTATUS);                                               40207000
         ANDM(255 - DONTSTOREBIT - INBUSYBIT);                          40208000
         ADD(DONTSTOREBIT + INBUSYBIT);                                 40209000
         ST(SPOSTATUS);                                                 40210000
         SP2;                                                           40211000
         CLA;                                                           40212000
         ST(KEYINBUFFER);                                               40213000
         LOAD(KEYIN);                                                   40214000
         SAZN;                                                          40215000
         GOTO(LOC+15);                                                  40216000
         T(C,X);                                                        40217000
         ROF;                                                           40218000
         BRM(FORGETSPACE);                                              40219000
         LOADX(0);                                                      40220000
         SAZ;                                                           40221000
         GOTO(LOC-9);                                                   40222000
         ST(KEYIN);                                                     40223000
         GOTO(NSECOND);                                                 40224000
%                                                                       40225000
    LABL(PLACEENDOFKEYIN);                                              40226000
              HEADING("PLACE E","ND OF K","EYIN   ",0,3);               40227000
         DS2(0);                                                        40228000
         SP2;                                                           40229000
         LOAD(KEYINBUFFER);                                             40230000
         SAZN;                                                          40231000
         GOTOIND(PLACEENDOFKEYIN);                                      40232000
         T(C,X);                                                        40233000
         SUB(KEYINPOINTER);                                             40234000
         CIA;                                                           40235000
         SP1;                                                           40236000
         SUB(2);                                                        40237000
         STX(2);                                                        40238000
         GOTOIND(PLACEENDOFKEYIN);                                      40239000
%                                                                       40240000
    LABL(ADDTOKEYIN);                                                   40241000
              HEADING("ADD TO ","KEYIN  ",0,0,2);                       40242000
         DS2(0);                                                        40243000
         SP2;                                                           40244000
         LOAD(KEYINBUFFER);                                             40245000
         SAZN;                                                          40246000
         GOTOIND(ADDTOKEYIN);                                           40247000
         T(C,X);                                                        40248000
         LOAD(KEYIN);                                                   40249000
         SAZ;                                                           40250000
         GOTO(KEYINALREADYEXISTS);                                      40251000
         T(X,C);                                                        40252000
         ST(KEYIN);                                                     40253000
%                                                                       40254000
    LABL(EXITADDTOKEYIN);                                               40255000
              HEADING("EXIT AD","D TO KE","YIN    ",0,3);               40256000
         CLA;                                                           40257000
         STX(0);                                                        40258000
         ST(KEYINBUFFER);                                               40259000
         GOTOIND(ADDTOKEYIN);                                           40260000
%                                                                       40261000
    LABL(KEYINALREADYEXISTS);                                           40262000
              HEADING("KEYIN A","LREADY ","EXISTS ",0,3);               40263000
         T(C,X);                                                        40264000
         CHAINDOWN;                                                     40265000
         LOAD(KEYINBUFFER);                                             40266000
         STX(0);                                                        40267000
         T(C,X);                                                        40268000
         GOTO(EXITADDTOKEYIN);                                          40269000
%                                                                       40270000
    LABL(IDLESPOREAD);                                                  40271000
              HEADING("IDLE SP","O READ ",0,0,2);                       40272000
         SP1;                                                           40273000
         BTI(SPOREAD);                                                  40274000
         ANDM(127);                                                     40275000
         ST(CHAR);                                                      40276000
         SUB(CR);                                                       40277000
         SAZN;                                                          40278000
         GOTO(ENDOFKEYIN);                                              40279000
         SUB(DELETE - CR);                                              40280000
         SAZN;                                                          40281000
         GOTO(DELETEKEYIN);                                             40282000
         INCREMENT(KEYINCOUNT);                                         40283000
         SAZ;                                                           40284000
         GOTO(NSECOND);                                                 40285000
         LOAD(-72);                                                     40286000
         ST(KEYINCOUNT);                                                40287000
         LOAD(SPOSTATUS);                                               40288000
         ADD(KEYINCONTINUEDBIT);                                        40289000
         ST(SPOSTATUS);                                                 40290000
         GOTO(NSECOND);                                                 40291000
%                                                                       40292000
    END OF KEYIN CODE;                                                  40293000
%                                                                       40294000
%                                                                       40295000
%         THE NEXT PROCEDURE CONTAINS THE CODE TO PRINT SPO OUTPUT      40296000
%         AND INPUT ON THE SUPERVISORY PRINTER.                         40297000
%         IT HANDLES PROBLEMS OF CONTINUED RECORDS ON INPUT OR          40298000
%         OUTPUT.                                                       40299000
%                                                                       40300000
PROCEDURE SPOUTCODE;                                                    40301000
    BEGIN                                                               40302000
         REAL SEGMENT;                                                  40303000
%                                                                       40304000
    LABL(SPOUTNOTBUSY);                                                 40305000
              HEADING("SPOUT N","OT BUSY",0,0,2);                       40306000
         SP1;                                                           40307000
         LOAD(SPOSTATUS);                                               40308000
         SOD;                                                           40309000
         GOTO(FINDASPOUT);                                              40310000
         ANDM(255 - OUTBUSYBIT - ECHOBIT);                              40311000
         ADD(ECHOBIT + OUTBUSYBIT);                                     40312000
         ST(SPOSTATUS);                                                 40313000
         SP2;                                                           40314000
         DESC(ECHOBACKKEYIN);                                           40315000
         ST(SPOUTLABEL);                                                40316000
%                                                                       40317000
    LABL(ECHOBACKKEYIN);                                                40318000
              HEADING("ECHO BA","CK KEYI","N      ",0,3);               40319000
         SP1;                                                           40320000
         LOAD(SPOSTATUS);                                               40321000
         ANDM(KEYINCONTINUEDBIT);                                       40322000
         SAZ;                                                           40323000
         GOTO(LONGKEYIN);                                               40324000
         LOAD(CHAR);                                                    40325000
         SAZN;                                                          40326000
         GOTO(TESTSPOINPUT);                                            40327000
         BTO(SPOWRITE);                                                 40328000
         SUB(CR);                                                       40329000
         SAZN;                                                          40330000
         GOTO(ENDOFECHOBACK);                                           40331000
         CLA;                                                           40332000
         ST(CHAR);                                                      40333000
         GOTO(TESTSPOINPUT);                                            40334000
%                                                                       40335000
    LABL(LONGKEYIN);                                                    40336000
              HEADING("LONG KE","YIN    ",0,0,2);                       40337000
         LOAD(CHAR);                                                    40338000
         BTO(SPOWRITE);                                                 40339000
         CLA;                                                           40340000
         ST(CHAR);                                                      40341000
         SPOUTSLEEP(0);                                                 40342000
         SP1;                                                           40343000
         LOAD(CR);                                                      40344000
         BTO(SPOWRITE);                                                 40345000
         SPOUTSLEEP(0);                                                 40346000
         SP1;                                                           40347000
         LOAD(LF);                                                      40348000
         BTO(SPOWRITE);                                                 40349000
         LOAD(SPOSTATUS);                                               40350000
         ANDM(255 - KEYINCONTINUEDBIT);                                 40351000
         ST(SPOSTATUS);                                                 40352000
         SPOUTSLEEP(ECHOBACKKEYIN);                                     40353000
%                                                                       40354000
    LABL(ENDOFECHOBACK);                                                40355000
              HEADING("END OF ","ECHO BA","CK     ",0,3);               40356000
         PRECISION := 1;                                                40357000
         SPOUTSLEEP(0);                                                 40358000
         SP1;                                                           40359000
         LOAD(LF);                                                      40360000
         BTO(SPOWRITE);                                                 40361000
         CLA;                                                           40362000
         ST(CHAR);                                                      40363000
         LOAD(SPOSTATUS);                                               40364000
         ANDM(INBUSYBIT + DONTSTOREBIT);                                40365000
         ST(SPOSTATUS);                                                 40366000
         SPOUTSLEEP(SPOUTNOTBUSY);                                      40367000
%                                                                       40368000
    LABL(FINDASPOUT);                                                   40369000
              HEADING("FIND A ","SPOUT  ",0,0,2);                       40370000
         SP2;                                                           40371000
         LOAD(SPOUTQ);                                                  40372000
         SAZN;                                                          40373000
         GOTO(NOSYSTEMSPOUTS);                                          40374000
         IBD;                                                           40375000
         CSQ(LOC+3);                                                    40376000
         SP1;                                                           40377000
         LOAD(SPOUTBUFFERS);                                            40378000
         SUB(1);                                                        40379000
         ST(SPOUTBUFFERS);                                              40380000
         SP2;                                                           40381000
         T(D,X);                                                        40382000
         LOADX(0);                                                      40383000
         ST(SPOUTQ);                                                    40384000
         SAZN;                                                          40385000
         ST(SPOUTQTAIL);                                                40386000
         IBE;                                                           40387000
         CSQ(LOC+3);                                                    40388000
         GOTO(LOC+29);                                                  40389000
%                                                                       40390000
    LABL(NOSYSTEMSPOUTS);                                               40391000
              HEADING("NO SYST","EM SPOU","TS     ",0,3);               40392000
         LOADIND(NEXTSPOUT);                                            40393000
         SAZN;                                                          40394000
         GOTO(REALENDOFSPOUT);                                          40395000
         T(C,A);                                                        40396000
         CLA;   STIND(NEXTSPOUT);                                       40397000
         LOAD(NEXTSPOUT);                                               40398000
         IAR;   IAR;                                                    40399000
         ST(NEXTSPOUT);                                                 40400000
         SUB(DES(SPOMAX));                                              40401000
         SAZ;                                                           40402000
         GOTO(LOC+6);                                                   40403000
         DESC(SPOTABLE);                                                40404000
         ST(NEXTSPOUT);                                                 40405000
         T(A,C);                                                        40406000
         ST(SPOUTBUFFER);                                               40407000
         SL1;                                                           40408000
         SR1;                                                           40409000
         T(C,X);                                                        40410000
         ADD(3);                                                        40411000
         ST(SPOUTPOINTER);                                              40412000
         SP1;                                                           40413000
         LOAD(SPOUTBUFFER);                                             40414000
         SANN;                                                          40415000
         CLA;     SAZ;                                                  40416000
         CLA;     IAR;                                                  40417000
         SUBX(ENDPOS);                                                  40418000
         ST(SPOUTCOUNT);                                                40419000
         LOAD(SPOSTATUS);                                               40420000
         ANDM(255 - OUTBUSYBIT);                                        40421000
         ADD(OUTBUSYBIT);                                               40422000
         ST(SPOSTATUS);                                                 40423000
%                                                                       40424000
    LABL(SPOUTMSG);                                                     40425000
              HEADING("SPOUT M","SG     ",0,0,2);                       40426000
         SPOUTSLEEP(0);                                                 40427000
         SP1;                                                           40428000
         INCREMENT(SPOUTCOUNT);                                         40429000
         SAZN;                                                          40430000
         GOTO(ENDOFSPOUT);                                              40431000
         LOAD(SPOSTATUS);                                               40432000
         SODN;                                                          40433000
         GOTO(ENDOFSPOUT);                                              40434000
         LOADIND(SPOUTPOINTER);                                         40435000
         SUB(CR);                                                       40436000
         SAZN;                                                          40437000
         GOTO(ENDOFSPOUT);                                              40438000
         SUB(COMPRESSCHAR - CR);                                        40439000
         SAZN;                                                          40440000
         GOTO(EXPANDSPOUT);                                             40441000
         ADD(COMPRESSCHAR);                                             40442000
         BTO(SPOWRITE);                                                 40443000
         SP2;                                                           40444000
         INCREMENT(SPOUTPOINTER);                                       40445000
         GOTO(TESTSPOINPUT);                                            40446000
%                                                                       40447000
    LABL(ENDOFSPOUT);                                                   40448000
              HEADING("END OF ","SPOUT  ",0,0,2);                       40449000
         SP2;                                                           40450000
         LOAD(SPOUTBUFFER);                                             40451000
         ROF;                                                           40452000
         BRM(FORGETSPACE);                                              40453000
         SP1;                                                           40454000
         LOAD(CR);                                                      40455000
         BTO(SPOWRITE);                                                 40456000
         SPOUTSLEEP(0);                                                 40457000
         SP1;                                                           40458000
         LOAD(LF);                                                      40459000
         BTO(SPOWRITE);                                                 40460000
         LOAD(SPOUTCOUNT);                                              40461000
         SAZN;                                                          40462000
         GOTO(FINDASPOUT);                                              40463000
%                                                                       40464000
    LABL(REALENDOFSPOUT);                                               40465000
              HEADING("REAL EN","D OF SP","OUT    ",0,3);               40466000
         SP1;                                                           40467000
         LOAD(SPOSTATUS);                                               40468000
         ANDM(INBUSYBIT + DONTSTOREBIT + KEYINCONTINUEDBIT);            40469000
         ST(SPOSTATUS);                                                 40470000
         SPOUTSLEEP(SPOUTNOTBUSY);                                      40471000
%                                                                       40472000
    LABL(EXPANDSPOUT);                                                  40473000
              HEADING("EXPAND ","SPOUT  ",0,0,2);                       40474000
         SP2;                                                           40475000
         DESC(SPOUTCOMPRESSEDDATA);                                     40476000
         ST(SPOUTLABEL);                                                40477000
         LOAD(SPOUTPOINTER);                                            40478000
         T(C,X);                                                        40479000
         ADD(3);                                                        40480000
         ST(SPOUTPOINTER);                                              40481000
         SP1;                                                           40482000
         LOADX(1);                                                      40483000
         CIA;                                                           40484000
         ST(SPO1);                                                      40485000
         LOADX(2);                                                      40486000
         ST(SPO2);                                                      40487000
%                                                                       40488000
    LABL(SPOUTCOMPRESSEDDATA);                                          40489000
              HEADING("SPOUT C","OMPRESS","ED DATA",0,3);               40490000
         SP1;                                                           40491000
         LOAD(SPO2);                                                    40492000
         BTO(SPOWRITE);                                                 40493000
         INCREMENT(SPO1);                                               40494000
         SAZ;                                                           40495000
         GOTO(TESTSPOINPUT);                                            40496000
         LOAD(SPOUTCOUNT);                                              40497000
         ADD(3);                                                        40498000
         ST(SPOUTCOUNT);                                                40499000
         SANN;                                                          40500000
         GOTO(SPOUTMSG);                                                40501000
         GOTO(ENDOFSPOUT);                                              40502000
%                                                                       40503000
    END OF SPOUT CODE;                                                  40504000
%                                                                       40505000
%                                                                       40506000
%         THE NEXT PROCEDURE RESERVES THE STORAGE NEEDDED TO            40507000
%         HANDLE THE SPO.                                               40508000
%                                                                       40509000
PROCEDURE SPOSTORAGE;                                                   40510000
    BEGIN                                                               40511000
         REAL SEGMENT;                                                  40512000
%                                                                       40513000
    LABL(SPOUTCOUNT);                                                   40514000
              HEADING("SPOUT C","OUNT   ",0,0,2);                       40515000
         DS1(0);                                                        40516000
%                                                                       40517000
    LABL(SPOUTBUFFERS);                                                 40518000
              HEADING("SPOUT B","UFFERS ",0,0,2);                       40519000
         DS1(0);                                                        40520000
%                                                                       40521000
    LABL(SPO1);                                                         40522000
              HEADING("SPO1   ",0,0,0,1);                               40523000
         DS1(0);                                                        40524000
%                                                                       40525000
    LABL(SPO2);                                                         40526000
              HEADING("SPO2   ",0,0,0,1);                               40527000
         DS1(0);                                                        40528000
%                                                                       40529000
    LABL(SPOUTLABEL);                                                   40530000
              HEADING("SPOUT L","ABEL   ",0,0,2);                       40531000
         DA(SPOUTNOTBUSY);                                              40532000
%                                                                       40533000
    LABL(SPOUTBUFFER);                                                  40534000
              HEADING("SPOUT B","UFFER  ",0,0,2);                       40535000
         DS2(0);                                                        40536000
%                                                                       40537000
    LABL(SPOUTPOINTER);                                                 40538000
              HEADING("SPOUT P","OINTER ",0,0,2);                       40539000
         DS2(0);                                                        40540000
%                                                                       40541000
    LABL(NEXTSPOUT);                                                    40542000
              HEADING("NEXT SP","OUT    ",0,0,2);                       40543000
         DA(SPOTABLE);                                                  40544000
%                                                                       40545000
    LABL(PUTSPOUT);                                                     40546000
              HEADING("PUT SPO","UT     ",0,0,2);                       40547000
         DA(SPOTABLE);                                                  40548000
%                                                                       40549000
    LABL(CHAR);                                                         40550000
              HEADING("CHAR   ",0,0,0,1);                               40551000
         DS1(0);                                                        40552000
%                                                                       40553000
    LABL(KEYINCOUNT);                                                   40554000
              HEADING("KEYIN C","OUNT   ",0,0,2);                       40555000
         DS1(0);                                                        40556000
%                                                                       40557000
    LABL(KEYIN);                                                        40558000
              HEADING("KEYIN  ",0,0,0,1);                               40559000
         DS2(0);                                                        40560000
%                                                                       40561000
    LABL(KEYINBUFFER);                                                  40562000
              HEADING("KEYIN B","UFFER  ",0,0,2);                       40563000
         DS2(0);                                                        40564000
%                                                                       40565000
    LABL(KEYINPOINTER);                                                 40566000
              HEADING("KEYIN P","OINTER ",0,0,2);                       40567000
         DS2(0);                                                        40568000
%                                                                       40569000
    LABL(SPOSTATUS);                                                    40570000
              HEADING("SPO STA","TUS    ",0,0,2);                       40571000
         DS1(0);                                                        40572000
%                                                                       40573000
%                                                                       40574000
    END OF SPO STORAGE;                                                 40575000
%                                                                       40576000
%         THE NEXT PROCEDURE CONTAINS TABLES NEEDED BY THE SPO          40577000
%         ROUTINES.                                                     40578000
%                                                                       40579000
PROCEDURE SPOTABLES;                                                    40580000
    BEGIN                                                               40581000
         REAL SEGMENT;                                                  40582000
%                                                                       40583000
    LABL(SPOTABLE);                                                     40584000
              HEADING("SPO TAB","LES    ",0,0,2);                       40585000
         FOR II := 0 STEP 1 UNTIL 11 DO DS2(0);                         40586000
%                                                                       40587000
    LABL(SPOMAX);                                                       40588000
%                                                                       40589000
    LABL(SPOMESS);                                                      40590000
              HEADING("SPO MES","SAGES  ",0,0,2);                       40591000
         DS1(13);                                                       40592000
         FOR II := "N","O"," ","R","E","S","P","O","N","S","E"          40593000
                   DO MSG(II);                                          40594000
         DS1(CR);                                                       40595000
         DS1(CR);                                                       40596000
%                                                                       40597000
         DS1(7);                                                        40598000
         FOR II := "N","O"," ","M","E","M" DO MSG(II);                  40599000
         DS1(CR);                                                       40600000
%                                                                       40601000
         DS1(16);                                                       40602000
         FOR II := "M","I","S","S","I","N","G"," ","M","E","S","S","A", 40603000
                   "G","E" DO MSG(II);                                  40604000
         DS1(CR);                                                       40605000
%                                                                       40606000
         DS1(15);                                                       40607000
         FOR II := "T","R","A","N","S","M","I","T"," ","A","B","O","R", 40608000
                   "T" DO MSG(II);                                      40609000
         DS1(CR);                                                       40610000
%                                                                       40611000
         DS1(16);                                                       40612000
         FOR  II := "N","O"," ","S","Y","S","T","E","M"," ","L","I","N",40613000
                    "K" DO MSG(II);                                     40614000
         DS1(CR);                                                       40615000
%                                                                       40616000
         DS1(13);                                                       40617000
         FOR II := "C","R"," ","N","O","T"," ","R","E","A","D","Y"      40618000
                   DO MSG(II);                                          40619000
         DS1(CR);                                                       40620000
%                                                                       40621000
         DS1(14);                                                       40622000
         FOR II := "C","R"," ","R","E","A","D"," ","C","H","E","C",     40623000
                   "K" DO MSG(II);                                      40624000
         DS1(CR);                                                       40625000
%                                                                       40626000
         DS1(11);                                                       40627000
         FOR II := "C","R"," ","I","N","V"," ","C","H","R" DO MSG(II);  40628000
         DS1(CR);                                                       40629000
%                                                                       40630000
         DS1(13);                                                       40631000
         FOR II := "L","P"," ","N","O","T"," ","R","E","A","D","Y"      40632000
                   DO MSG(II);                                          40633000
         DS1(CR);                                                       40634000
%                                                                       40635000
         DS1(12);                                                       40636000
         FOR II := "P","R","I","N","T"," ","C","H","E","C","K"          40637000
                   DO MSG(II);                                          40638000
         DS1(CR);                                                       40639000
%                                                                       40640000
         DS1(15);                                                       40641000
         FOR II := "R","E","-","E","N","T","E","R"," ","K","E","Y",     40642000
                   "I","N" DO MSG(II);                                  40643000
         DS1(CR);                                                       40644000
%                                                                       40645000
         DS1(23);                                                       40646000
         FOR II := "C","O","N","N","E","C","T","I","O","N"," ",         40647000
                   "E","S","T","A","B","L","I","S","H","E","D"          40648000
                   DO MSG(II);                                          40649000
         DS1(CR);                                                       40650000
%                                                                       40651000
    END OF SPO TABLES;                                                  40652000
%                                                                       40653000
%                                                                       70000000
%         THE NEXT PROCEDURE CONTAINS THE CODE FOR HANDLING THE MODEM   70001000
%         INTERRUPTS.                                                   70002000
%                                                                       70003000
PROCEDURE MODEMINTERRUPT;                                               70004000
%                                                                       70005000
    BEGIN                                                               70006000
%                                                                       70007000
         REAL SEGMENT;                                                  70008000
%                                                                       70009000
    LABL(INTERLOCKINTERRUPT);                                           70010000
              HEADING("INTERLO","CK INTE","RRUPT  ",0,3);               70011000
%                                                                       70012000
         SP1;                                                           70013000
         LOAD(MODEMFLAGS);                                              70014000
         ANDM(255 - INTERLOCKBIT);                                      70015000
         T(C,A);                                                        70016000
         SEN(INTERLOCKON);                                              70017000
         CLA;                                                           70018000
         SAZ;                                                           70019000
         LOAD(INTERLOCKBIT);                                            70020000
         ADDR(A,C);                                                     70021000
         ST(MODEMFLAGS);                                                70022000
         SEN(INTERLOCKON);                                              70023000
         GOTO(LOSSOFINTERLOCK);                                         70024000
%                                                                       70025000
         LOAD(DTRBIT + INTERLOCKBIT + CONNECTEDBIT);                    70026000
         ST(MODEMFLAGS);                                                70027000
         SP2;                                                           70028000
         DESC(IGNORERING);                                              70029000
         ST(RINGLABEL);                                                 70030000
         SPOUT(CONNECTIONMADE);                                         70031000
         ENS;                                                           70032000
%                                                                       70033000
    LABL(CARRIERINTERRUPT);                                             70034000
              HEADING("CARRIER"," INTERR","UPT    ",0,3);               70035000
%                                                                       70036000
         SP1;                                                           70037000
         LOAD(MODEMFLAGS);                                              70038000
         ANDM(255 - CARRIERBIT);                                        70039000
         T(C,A);                                                        70040000
         SEN(CARRIER);                                                  70041000
         CLA;                                                           70042000
         SAZ;                                                           70043000
         LOAD(CARRIERBIT);                                              70044000
         ADDR(A,C);                                                     70045000
         ST(MODEMFLAGS);                                                70046000
         GOTOIND(CARRIERLABEL);                                         70047000
%                                                                       70048000
    LABL(RINGINTERRUPT);                                                70049000
              HEADING("RING IN","TERRUPT",0,0,2);                       70050000
%                                                                       70051000
         SP1;                                                           70052000
         LOAD(MODEMFLAGS);                                              70053000
         ANDM(255 - RINGBIT);                                           70054000
         ADD(RINGBIT);                                                  70055000
         ST(MODEMFLAGS);                                                70056000
         GOTOIND(RINGLABEL);                                            70057000
%                                                                       70058000
%                                                                       70059000
    LABL(CLEARTOSENDINTERRUPT);                                         70060000
              HEADING("CLEAR T","O SEND ","INTERRU","PT     ",4);       70061000
%                                                                       70062000
         SP1;                                                           70063000
         LOAD(MODEMFLAGS);                                              70064000
         ANDM(255 - CLEARTOSENDBIT);                                    70065000
         T(C,A);                                                        70066000
         SEN(CLEARTOSEND);                                              70067000
         CLA;                                                           70068000
         SAZ;                                                           70069000
         LOAD(CLEARTOSENDBIT);                                          70070000
         ADDR(A,C);                                                     70071000
         ST(MODEMFLAGS);                                                70072000
         GOTOIND(CLEARTOSENDLABEL);                                     70073000
%                                                                       70074000
    END OF MODEM INTERRUPT CODE;                                        70075000
%                                                                       70076000
%                                                                       70077000
%         MODEM RECEIVE CODE CONTAINS THE PROGRAMMING NEEDED TO RECEIVE,70078000
%         INTURPRET, AND STORE RECEIVED CHARACTERS.                     70079000
%                                                                       70080000
PROCEDURE MODEMRECEIVE;                                                 70081000
    BEGIN                                                               70082000
%                                                                       70083000
         REAL SEGMENT;                                                  70084000
    BEGIN REAL SEGMENT;                                                 70085000
%                                                                       70086000
    LABL(INITIATERECEIVE);                                              70087000
              HEADING("INITIAT","E RECEI","VE     ",0,3);               70088000
%                                                                       70089000
         DS2(0);                                                        70090000
         SP2;                                                           70091000
         FUN(GOTOBITMODE);                                              70092000
         DESC(SYNCHRONIZERECEIVE);                                      70093000
         ST(RECEIVELABEL);                                              70094000
         LOAD(NEXTACTIVITY);                                            70095000
         ST(MODEMSTATUS);                                               70096000
         ADD(DES(ACTIONLABEL));                                         70097000
         T(C,X);                                                        70098000
         LOADX(0);                                                      70099000
         ST(ACTIONTYPE);                                                70100000
         CLA;                                                           70101000
         ST(NEXTACTIVITY);                                              70102000
         GOTOIND(INITIATERECEIVE);                                      70103000
%                                                                       70104000
    LABL(SYNCHRONIZERECEIVE);                                           70105000
              HEADING("SYNCHRO","NIZE RE","CEIVE  ",0,3);               70106000
%                                                                       70107000
         RSLEEP(0);                                                     70108000
         SP1;                                                           70109000
         BTI(MODEMREAD);                                                70110000
         SUB(SYNCP);                                                    70111000
         SAZ;                                                           70112000
         ENS;                                                           70113000
%                                                                       70114000
    LABL(SETUPFORSYNC);                                                 70115000
              HEADING("SET UP ","FOR SYN","C      ",0,3);               70116000
%                                                                       70117000
         LOAD(-8);                                                      70118000
         ST(RCOUNT);                                                    70119000
         RSLEEP(0);                                                     70120000
         SP1;                                                           70121000
         INCREMENT(RCOUNT);                                             70122000
         BTI(MODEMREAD);                                                70123000
         SUB(SYNCP);                                                    70124000
         SAZ;                                                           70125000
         ENS;                                                           70126000
%                                                                       70127000
         LOAD(RCOUNT);                                                  70128000
         SAZ;                                                           70129000
         GOTO(SETUPFORSYNC);                                            70130000
         FUN(GOTOBYTEMODE);                                             70131000
         SP2;                                                           70132000
         LOAD(ACTIONTYPE);                                              70133000
         ST(RECEIVELABEL);                                              70134000
         ENS;                                                           70135000
%                                                                       70136000
    LABL(LOOKFORDATA);                                                  70137000
              HEADING("LOOK FO","R DATA ",0,0,2);                       70138000
         SP1;                                                           70139000
         BTI(MODEMREAD);                                                70140000
         SUB(SYNCP);                                                    70141000
         SAZ;                                                           70142000
         ENS;                                                           70143000
         BRM(INITIATERECEIVE);                                          70144000
         GOTO(SETUPFORSYNC);                                            70145000
%                                                                       70146000
    LABL(LOOKFORENQ);                                                   70147000
              HEADING("LOOK FO","R ENQ  ",0,0,2);                       70148000
%                                                                       70149000
         RECEIVE;                                                       70150000
         PRECISION := 1;                                                70151000
         SUB(ENQ);                                                      70152000
         SAZN;                                                          70153000
         GOTO(FOUNDTHEENQ);                                             70154000
%                                                                       70155000
         ADD(ENQ - EOT);                                                70156000
         SAZN;                                                          70157000
         GOTO(FOUNDANEOT);                                              70158000
%                                                                       70159000
         NEXT(TRANSMITNAK);                                             70160000
         RSLEEP(IGNOREDATAINTERRUPTS);                                  70161000
%                                                                       70162000
    LABL(FOUNDTHEENQ);                                                  70163000
%                                                                       70164000
         SP2;                                                           70165000
         NEXT(TRANSMITACK);                                             70166000
         RSLEEP(IGNOREDATAINTERRUPTS);                                  70167000
%                                                                       70168000
    LABL(LOOKFORETX);                                                   70169000
              HEADING("LOOK FO","R ETX  ",0,0,2);                       70170000
%                                                                       70171000
         RECEIVE;                                                       70172000
         PRECISION := 1;                                                70173000
         SUB(EOT);                                                      70174000
         SAZN;                                                          70175000
         GOTO(FOUNDANEOT);                                              70176000
         IAR;                                                           70177000
         SAZ;                                                           70178000
         ENS;                                                           70179000
         RSLEEP(IGNOREDATAINTERRUPTS);                                  70180000
%                                                                       70181000
    LABL(INCOMMING);                                                    70182000
              HEADING("INCOMMI","NG     ",0,0,2);                       70183000
%                                                                       70184000
         SP2;                                                           70185000
         LOAD(LASTTRAN);                                                70186000
         BRM(SUPERFORGET);                                              70187000
         CLA;                                                           70188000
         ST(LASTTRAN);                                                  70189000
         SP1;                                                           70190000
         INCREMENT(TRANNO);                                             70191000
         SUB(58);                                                       70192000
         SAZ;                                                           70193000
         GOTO(LOC+6);                                                   70194000
         LOAD(48);                                                      70195000
         ST(TRANNO);                                                    70196000
         GOTO(LOOKFORHEADER);                                           70197000
%                                                                       70198000
    LABL(LASTTRANOK);                                                   70199000
              HEADING("LAST TR","AN OK  ",0,0,2);                       70200000
%                                                                       70201000
         SP2;                                                           70202000
         LOAD(LASTTRAN);                                                70203000
         BRM(SUPERFORGET);                                              70204000
         CLA;                                                           70205000
         ST(LASTTRAN);                                                  70206000
         ST(UNIT);                                                      70207000
         SP1;                                                           70208000
         INCREMENT(TRANNO);                                             70209000
         SUB(58);                                                       70210000
         SAZ;                                                           70211000
         GOTO(LOC+6);                                                   70212000
         LOAD(48);                                                      70213000
         ST(TRANNO);                                                    70214000
         BRM(FINDAMESSAGE);                                             70215000
         PRECISION := 2;                                                70216000
         SAZN;                                                          70217000
         GOTO(CLOSETHELINE);                                            70218000
         BRM(LINKBACK);                                                 70219000
         NEXT(TRANSMITMSG);                                             70220000
         RSLEEP(IGNOREDATAINTERRUPTS);                                  70221000
%                                                                       70222000
    LABL(CLOSETHELINE);                                                 70223000
              HEADING("CLOSE T","HE LINE",0,0,2);                       70224000
         NEXT(TRANSMITEOT);                                             70225000
         RSLEEP(IGNOREDATAINTERRUPTS);                                  70226000
%                                                                       70227000
    LABL(LOOKFORACK);                                                   70228000
              HEADING("LOOK FO","R ACK  ",0,0,2);                       70229000
         RECEIVE;                                                       70230000
         PRECISION := 1;                                                70231000
         SUB(NAK);                                                      70232000
         SAZN;                                                          70233000
         GOTO(FOUNDANAK);                                               70234000
%                                                                       70235000
         ADD(NAK - ACK);                                                70236000
         SAZN;                                                          70237000
         GOTO(FOUNDTHEACK);                                             70238000
%                                                                       70239000
         IAR;                                                           70240000
         SAZN;                                                          70241000
         GOTO(FOUNDTHEENQ);                                             70242000
%                                                                       70243000
         SP2;                                                           70244000
         NEXT(TRANSMITENQ);                                             70245000
         RSLEEP(IGNOREDATAINTERRUPTS);                                  70246000
%                                                                       70247000
    LABL(FOUNDANEOT);                                                   70248000
              HEADING("FOUND A","N EOT  ",0,0,2);                       70249000
         SP1;                                                           70250000
         LOAD(MODEMFLAGS);                                              70251000
         ANDM(63);                                                      70252000
         ST(MODEMFLAGS);                                                70253000
         SP2;                                                           70254000
         CLA;                                                           70255000
         ST(LASTACTIVITY);                                              70256000
         ST(MODEMSTATUS);                                               70257000
         ST(NEXTACTIVITY);                                              70258000
         ST(LASTREC);                                                   70259000
         ST(LASTTRAN);                                                  70260000
         RSLEEP(IGNOREDATAINTERRUPTS);                                  70261000
%                                                                       70262000
    LABL(FOUNDTHEACK);                                                  70263000
              HEADING("FOUND T","HE ACK ",0,0,2);                       70264000
%                                                                       70265000
         SP2;                                                           70266000
         NEXT(TRANSMITMSG);                                             70267000
         RSLEEP(IGNOREDATAINTERRUPTS);                                  70268000
%                                                                       70269000
    LABL(FOUNDANAK);                                                    70270000
              HEADING("FOUND A"," NAK   ",0,0,2);                       70271000
%                                                                       70272000
         SP2;                                                           70273000
         NEXT(TRANSMITEOT);                                             70274000
         RSLEEP(IGNOREDATAINTERRUPTS);                                  70275000
%                                                                       70276000
    LABL(DECYPHERRESPONSE);                                             70277000
              HEADING("DECYPHE","R RESPO","NSE    ",0,3);               70278000
         RECEIVE;                                                       70279000
         PRECISION := 1;                                                70280000
         SUB(NAK);                                                      70281000
         SAZN;                                                          70282000
         GOTO(RETRY);                                                   70283000
         ADD(NAK - ACK);                                                70284000
         SAZN;                                                          70285000
         GOTO(LASTTRANOK);                                              70286000
%                                                                       70287000
         IAR;                                                           70288000
         SAZN;                                                          70289000
         GOTO(RETRY);                                                   70290000
%                                                                       70291000
         IAR;                                                           70292000
         SAZN;                                                          70293000
         GOTO(FOUNDANEOT);                                              70294000
%                                                                       70295000
         ADD(EOT - SOH);                                                70296000
         SAZN;                                                          70297000
         GOTO(INCOMMING);                                               70298000
%                                                                       70299000
         SP2;                                                           70300000
         CLA;                                                           70301000
         ST(MODEMSTATUS);                                               70302000
         ST(NEXTACTIVITY);                                              70303000
         RSLEEP(IGNOREDATAINTERRUPTS);                                  70304000
%                                                                       70305000
    LABL(RETRY);                                                        70306000
              HEADING("RETRY  ",0,0,0,1);                               70307000
         SP2;                                                           70308000
         LOAD(LASTTRAN);                                                70309000
         BRM(LINKBACK);                                                 70310000
         NEXT(TRANSMITMSG);                                             70311000
         RSLEEP(IGNOREDATAINTERRUPTS);                                  70312000
%                                                                       70313000
    LABL(STOREMSG);                                                     70314000
              HEADING("STORE M","SG     ",0,0,2);                       70315000
         RECEIVE;                                                       70316000
%                                                                       70317000
         PRECISION := 1;                                                70318000
         SUB(EOT);                                                      70319000
         SAZN;                                                          70320000
         GOTO(FOUNDANEOT);                                              70321000
         ADD(EOT - SOH);                                                70322000
         SAZ;                                                           70323000
         GOTO(FORMATERROR);                                             70324000
%                                                                       70325000
    LABL(LOOKFORHEADER);                                                70326000
              HEADING("LOOK FO","R HEADE","R      ",0,3);               70327000
%                                                                       70328000
         RSLEEP(0);                                                     70329000
         SP1;                                                           70330000
         INITIALIZEBCC;                                                 70331000
         ST(MC3);                                                       70332000
         RECEIVE;                                                       70333000
         SP2;                                                           70334000
         ANDM(15);                                                      70335000
         ADD(DES(POWERSOF10));                                          70336000
         T(C,X);                                                        70337000
         LOADX(0);                                                      70338000
         SR8;                                                           70339000
         ST(UNIT);                                                      70340000
         CLA;                                                           70341000
         ST(LASTREC);                                                   70342000
         RSLEEP(0);                                                     70343000
         RECEIVE;                                                       70344000
         SP2;                                                           70345000
         ANDM(15);                                                      70346000
         ADD(UNIT);                                                     70347000
         T(C,A);                                                        70348000
         SL1;                                                           70349000
         ADD(DES(OUTPUTUNITTABLE));                                     70350000
         T(C,X);                                                        70351000
         LOADX(0);                                                      70352000
         ST(UNIT);                                                      70353000
         SAZN;                                                          70354000
         GOTO(HL);                                                      70355000
         BRM(SETUPUDINFO);                                              70356000
         RSLEEP(0);                                                     70357000
%                                                                       70358000
         RECEIVE;                                                       70359000
         SUB(RECNO);                                                    70360000
         SAZ;                                                           70361000
         GOTO(BADRECNO);                                                70362000
%                                                                       70363000
    LABL(MODEMLAB1);                                                    70364000
              HEADING("MODEM L","AB1    ",0,0,2);                       70365000
%                                                                       70366000
         RSLEEP(0);                                                     70367000
         RECEIVE;                                                       70368000
         PRECISION := 1;                                                70369000
         SUB(STEXT);                                                    70370000
         SAZ;                                                           70371000
         GOTO(FORMATERROR);                                             70372000
%                                                                       70373000
    LABL(STOREAMESSAGE);                                                70374000
              HEADING("STORE A"," MESSAG","E      ",0,3);               70375000
%                                                                       70376000
         RSLEEP(0);                                                     70377000
         RECEIVE;                                                       70378000
         PRECISION := 1;                                                70379000
         ST(MC2);                                                       70380000
         SUB(ETX);                                                      70381000
         SAZN;                                                          70382000
         GOTO(EOM);                                                     70383000
         SUB(EOT - ETX);                                                70384000
         SAZN;                                                          70385000
         GOTO(FOUNDANEOT);                                              70386000
         SUB(CR - EOT);                                                 70387000
         SAZN;                                                          70388000
         GOTO(GETABLOCK);                                               70389000
         SUB(ESC - CR);                                                 70390000
         SAZN;                                                          70391000
         GOTO(BLANKSUPRESSION);                                         70392000
         SP2;                                                           70393000
         LOAD(MODEMPOINTER);                                            70394000
         IAR;                                                           70395000
         ST(MODEMPOINTER);                                              70396000
         SP1;                                                           70397000
         LOAD(MCOUNT);                                                  70398000
         IAR;                                                           70399000
         ST(MCOUNT);                                                    70400000
         SAZN;                                                          70401000
         GOTO(MSGTOOLONG);                                              70402000
         LOAD(MC2);                                                     70403000
         STIND(MODEMPOINTER);                                           70404000
         GOTO(STOREAMESSAGE);                                           70405000
%                                                                       70406000
    LABL(NOSPACEFORMODEM);                                              70407000
              HEADING("NO SPAC","E FOR M","ODEM   ",0,3);               70408000
         SP1;                                                           70409000
         INCREMENT(RECNO);                                              70410000
         SUB(58);                                                       70411000
         SAZ;                                                           70412000
         GOTO(LOC+6);                                                   70413000
         LOAD(48);                                                      70414000
         ST(RECNO);                                                     70415000
         SP2;                                                           70416000
         LOAD(UNITNO);                                                  70417000
         SR1;                                                           70418000
         BRM(MAKENOTREADY);                                             70419000
          SP2;                                                          70420000
         LOAD(LASTREC);                                                 70421000
         BRM(SUPERFORGET);                                              70422000
         NEXT(ACKNOWLEDGE);                                             70423000
         RSLEEP(LOOKFORETX);                                            70424000
%                                                                       70425000
    LABL(EOM);                                                          70426000
              HEADING("EOM    ",0,0,0,1);                               70427000
         SP2;                                                           70428000
         LOAD(MBUFF);                                                   70429000
         SAZN;                                                          70430000
         GOTO(LOC+5);                                                   70431000
         BRM(PLACEENDOFBUFFERPOSITION);                                 70432000
         LOAD(MBUFF);                                                   70433000
         SAZN;                                                          70434000
         GOTO(LOC+10);                                                  70435000
         T(C,X);                                                        70436000
         SUB(MODEMPOINTER);                                             70437000
         SP1;                                                           70438000
         CIA;                                                           70439000
         STX(2);                                                        70440000
         RSLEEP(CHECKBCC);                                              70441000
%                                                                       70442000
    LABL(PLACEENDOFBUFFERPOSITION);                                     70443000
              HEADING("PLACE E","ND OF B","UFFER P","OSITION",4);       70444000
         DS2(0);                                                        70445000
         T(C,A);                                                        70446000
         SP1;                                                           70447000
         LOAD(UDTOGS);                                                  70448000
         SL1;                                                           70449000
         SAN;                                                           70450000
         GOTO(BYPASSSUPRESS);                                           70451000
         LOAD(MCOUNT);                                                  70452000
         SAZN;                                                          70453000
         GOTO(BYPASSSUPRESS);                                           70454000
         ST(MC2);                                                       70455000
         SP2;                                                           70456000
         LOAD(MODEMPOINTER);                                            70457000
         T(C,X);                                                        70458000
         ADD(3);                                                        70459000
         ST(MODEMPOINTER);                                              70460000
         SP1;                                                           70461000
         LOAD(BLANK);                                                   70462000
         STX(1);                                                        70463000
         LOAD(MC2);                                                     70464000
         CIA;                                                           70465000
         STX(2);                                                        70466000
         LOAD(COMPRESSCHAR);                                            70467000
         STX(3);                                                        70468000
%                                                                       70469000
    LABL(BYPASSSUPRESS);                                                70470000
              HEADING("BYPASS ","SUPRESS",0,0,2);                       70471000
         SP2;                                                           70472000
         GOTOIND(PLACEENDOFBUFFERPOSITION);                             70473000
%                                                                       70474000
    LABL(GETABLOCK);                                                    70475000
              HEADING("GET A B","LOCK   ",0,0,2);                       70476000
%                                                                       70477000
         SP2;                                                           70478000
         LOAD(MBUFF);                                                   70479000
         SAZN;                                                          70480000
         GOTO(FIRSTBLOCK);                                              70481000
         BRM(PLACEENDOFBUFFERPOSITION);                                 70482000
         LOAD(LASTREC);                                                 70483000
         SAZN;                                                          70484000
         GOTO(SECONDBLOCK);                                             70485000
         T(C,X);                                                        70486000
         LOADX(0);                                                      70487000
         SAZ;                                                           70488000
         GOTO(LOC-5);                                                   70489000
         T(A,C);                                                        70490000
         STX(0);                                                        70491000
         T(A,X);                                                        70492000
         SUB(MODEMPOINTER);                                             70493000
         CIA;                                                           70494000
         SP1;                                                           70495000
         STX(2);                                                        70496000
         SP2;                                                           70497000
         GOTO(FIRSTBLOCK);                                              70498000
%                                                                       70499000
    LABL(SECONDBLOCK);                                                  70500000
              HEADING("SECOND ","BLOCK  ",0,0,2);                       70501000
%                                                                       70502000
         T(A,C);                                                        70503000
         T(A,X);                                                        70504000
         SUB(MODEMPOINTER);                                             70505000
         CIA;                                                           70506000
         SP1;                                                           70507000
         STX(2);                                                        70508000
         SP2;                                                           70509000
%                                                                       70510000
         T(A,C);                                                        70511000
         ST(LASTREC);                                                   70512000
%                                                                       70513000
    LABL(FIRSTBLOCK);                                                   70514000
              HEADING("FIRST B","LOCK   ",0,0,2);                       70515000
%                                                                       70516000
         SP1;                                                           70517000
         INCREMENT(MC3);                                                70518000
         LOAD(UDTOGS);                                                  70519000
         SOD;                                                           70520000
         ROF;                                                           70521000
         SODN;                                                          70522000
         SOF;                                                           70523000
         NOP;                                                           70524000
         BRM(CONTROLGETSPACE);                                          70525000
         SAZN;                                                          70526000
         GOTO(NOSPACEFORMODEM);                                         70527000
         ST(MBUFF);                                                     70528000
         ADD(UDOFFSET);                                                 70529000
         DECR(C,C);                                                     70530000
         ST(MODEMPOINTER);                                              70531000
         CLA;                                                           70532000
         STIND(MBUFF);                                                  70533000
         SP1;                                                           70534000
         LOAD(UDLENGTH);                                                70535000
         ST(MCOUNT);                                                    70536000
         LOAD(UDTOGS);                                                  70537000
         SR1;                                                           70538000
         SOD;                                                           70539000
         GOTO(STOREAMESSAGE);                                           70540000
         RSLEEP(0);                                                     70541000
%                                                                       70542000
         SP2;                                                           70543000
         DESC(CC1TABLE);                                                70544000
         ADD(UNITNO);                                                   70545000
         T(C,X);                                                        70546000
         LOADX(0);                                                      70547000
         T(C,X);                                                        70548000
         RECEIVE;                                                       70549000
         SP2;                                                           70550000
         ANDM(15);                                                      70551000
         ADDR(C,X);                                                     70552000
         LOADX(0);                                                      70553000
         T(C,A);                                                        70554000
         LOAD(MBUFF);                                                   70555000
         T(C,X);                                                        70556000
         T(A,C);                                                        70557000
         SP1;                                                           70558000
         STX(3);                                                        70559000
         LOAD(UDTOGS);                                                  70560000
         ANDM(4);                                                       70561000
         SAZN;                                                          70562000
         GOTO(STOREAMESSAGE);                                           70563000
         RSLEEP(0);                                                     70564000
%                                                                       70565000
         SP2;                                                           70566000
         LOAD(MBUFF);                                                   70567000
         RECEIVE;                                                       70568000
         PRECISION := 1;                                                70569000
         ANDM(15);                                                      70570000
         STX(4);                                                        70571000
         GOTO(STOREAMESSAGE);                                           70572000
%                                                                       70573000
    END OF SEGMENT;                                                     70574000
    LABL(BLANKSUPRESSION);                                              70575000
              HEADING("BLANK S","UPRESSI","ON     ",0,3);               70576000
%                                                                       70577000
         RSLEEP(0);                                                     70578000
         RECEIVE;                                                       70579000
         SP2;                                                           70580000
         ANDM(15);                                                      70581000
         ADD(DES(POWERSOF10));                                          70582000
         T(C,X);                                                        70583000
         SP1;                                                           70584000
         LOADX(0);                                                      70585000
         ST(MC2);                                                       70586000
         RSLEEP(0);                                                     70587000
%                                                                       70588000
         RECEIVE;                                                       70589000
         PRECISION := 1;                                                70590000
         ANDM(15);                                                      70591000
         ADD(MC2);                                                      70592000
         SAZN;                                                          70593000
         LOAD(100);                                                     70594000
         ST(MC2);                                                       70595000
         ADD(MCOUNT);                                                   70596000
         SAN;                                                           70597000
         GOTO(TOOMANYBLANKS);                                           70598000
%                                                                       70599000
    LABL(SUPRESSIT);                                                    70600000
              HEADING("SUPRESS"," IT    ",0,0,2);                       70601000
%                                                                       70602000
         ST(MCOUNT);                                                    70603000
         SP2;                                                           70604000
         LOAD(MODEMPOINTER);                                            70605000
         T(C,X);                                                        70606000
         ADD(3);                                                        70607000
         ST(MODEMPOINTER);                                              70608000
         SP1;                                                           70609000
         LOAD(UDTOGS);                                                  70610000
         SANN;                                                          70611000
         GOTO(LPSUPRESS);                                               70612000
         LOAD(COMPRESSCHAR);                                            70613000
         STX(1);                                                        70614000
         LOAD(MC2);                                                     70615000
         STX(2);                                                        70616000
         LOAD(BLANK);                                                   70617000
         STX(3);                                                        70618000
         GOTO(STOREAMESSAGE);                                           70619000
%                                                                       70620000
    LABL(LPSUPRESS);                                                    70621000
              HEADING("LP SUPR","ESS    ",0,0,2);                       70622000
%                                                                       70623000
         LOAD(BLANK);                                                   70624000
         STX(1);                                                        70625000
         LOAD(MC2);                                                     70626000
         STX(2);                                                        70627000
         LOAD(COMPRESSCHAR);                                            70628000
         STX(3);                                                        70629000
         GOTO(STOREAMESSAGE);                                           70630000
%                                                                       70631000
    LABL(TOOMANYBLANKS);                                                70632000
              HEADING("TOO MAN","Y BLANK","S      ",0,3);               70633000
%                                                                       70634000
         LOAD(MCOUNT);                                                  70635000
         CIA;                                                           70636000
         ST(MC2);                                                       70637000
         CLA;                                                           70638000
         CMA;                                                           70639000
         ST(MCOUNT);                                                    70640000
         GOTO(SUPRESSIT);                                               70641000
%                                                                       70642000
    LABL(CHECKBCC);                                                     70643000
              HEADING("CHECK B","CC     ",0,0,2);                       70644000
%                                                                       70645000
         SP1;                                                           70646000
         BTI(MODEMREAD);                                                70647000
         ANDM(127);                                                     70648000
         SUB(BCC);                                                      70649000
         SAZN;                                                          70650000
         GOTO(LASTRECOK);                                               70651000
         NEXT(TRANSMITNAK);                                             70652000
         LOAD(LASTREC);                                                 70653000
         BRM(SUPERFORGET);                                              70654000
         LOAD(MBUFF);                                                   70655000
         BRM(SUPERFORGET);                                              70656000
         RSLEEP(IGNOREDATAINTERRUPTS);                                  70657000
%                                                                       70658000
    LABL(LASTRECOK);                                                    70659000
              HEADING("LAST RE","C OK   ",0,0,2);                       70660000
         SP1;                                                           70661000
         INCREMENT(RECNO);                                              70662000
         SUB(58);                                                       70663000
         SAZ;                                                           70664000
         GOTO(LOC+6);                                                   70665000
         LOAD(48);                                                      70666000
         ST(RECNO);                                                     70667000
         LOAD(MC3);                                                     70668000
         ADDIND(UNITCOUNT);                                             70669000
         STIND(UNITCOUNT);                                              70670000
         SUB(UNITLIMIT);                                                70671000
         SANN;                                                          70672000
         GOTO(LOC+28);                                                  70673000
         ADD(UNITLIMIT);                                                70674000
         SUB(MC3);                                                      70675000
         STIND(UNITCOUNT);                                              70676000
         SP2;                                                           70677000
         LOAD(UNITNO);                                                  70678000
         SR1;                                                           70679000
         BRM(MAKENOTREADY);                                             70680000
         SP2;                                                           70681000
         LOAD(LASTREC);                                                 70682000
         BRM(SUPERFORGET);                                              70683000
         LOAD(MBUFF);                                                   70684000
         BRM(SUPERFORGET);                                              70685000
         GOTO(DEVICEQUEUEUPDATED);                                      70686000
         SP2;                                                           70687000
         DESC(LASTREC);                                                 70688000
         CHAINDOWN;                                                     70689000
         LOAD(MBUFF);                                                   70690000
         SAZ;                                                           70691000
         GOTO(LOC+7);                                                   70692000
         T(X,C);                                                        70693000
         ST(MBUFF);                                                     70694000
         SAZN;                                                          70695000
         STX(0);                                                        70696000
%                                                                       70697000
         LOAD(UNIT);                                                    70698000
         ADD(DES(QUEUES));                                              70699000
         T(C,A);                                                        70700000
         T(C,X);                                                        70701000
         LOADX(0);                                                      70702000
         SAZ;                                                           70703000
         GOTO(DEVICEQUEUEPRESENT);                                      70704000
%                                                                       70705000
         LOAD(LASTREC);                                                 70706000
         STX(0);                                                        70707000
         SAZ;                                                           70708000
         LOAD(MBUFF);                                                   70709000
         STX(2);                                                        70710000
         GOTO(DEVICEQUEUEUPDATED);                                      70711000
%                                                                       70712000
    LABL(DEVICEQUEUEPRESENT);                                           70713000
              HEADING("DEVICE ","QUEUE P","RESENT ",0,3);               70714000
         LOAD(LASTREC);                                                 70715000
         SAZN;                                                          70716000
         GOTO(DEVICEQUEUEUPDATED);                                      70717000
         T(A,X);                                                        70718000
         LOADX(2);                                                      70719000
         T(C,X);                                                        70720000
         LOAD(LASTREC);                                                 70721000
         STX(0);                                                        70722000
         LOAD(MBUFF);                                                   70723000
         T(A,X);                                                        70724000
         STX(2);                                                        70725000
%                                                                       70726000
    LABL(DEVICEQUEUEUPDATED);                                           70727000
              HEADING("DEVICE ","QUEUE U","PDATED ",0,3);               70728000
         NEXT(ACKNOWLEDGE);                                             70729000
         RSLEEP(IGNOREDATAINTERRUPTS);                                  70730000
%                                                                       70731000
    LABL(BADRECNO);                                                     70732000
              HEADING("BAD REC"," NO    ",0,0,2);                       70733000
%                                                                       70734000
         PRECISION := 1;                                                70735000
         ADD(RECNO);                                                    70736000
         ST(RECNO);                                                     70737000
         SPOUT(MISSINGMESSAGE);                                         70738000
         GOTO(MODEMLAB1);                                               70739000
%                                                                       70740000
    LABL(FORMATERROR);                                                  70741000
              HEADING("FORMAT ","ERROR  ",0,0,2);                       70742000
%                                                                       70743000
         PRECISION := 1;                                                70744000
         NEXT(TRANSMITNAK);                                             70745000
         LOAD(MODEMSTATUS);                                             70746000
         SUB(RECEIVEMSG);                                               70747000
         SAZ;                                                           70748000
         GOTO(LOC+17);                                                  70749000
         LOAD(MBUFF);                                                   70750000
         BRM(SUPERFORGET);                                              70751000
         LOAD(LASTREC);                                                 70752000
         BRM(SUPERFORGET);                                              70753000
         CLA;                                                           70754000
         ST(MBUFF);                                                     70755000
         ST(LASTREC);                                                   70756000
         RSLEEP(IGNOREDATAINTERRUPTS);                                  70757000
%                                                                       70758000
    LABL(MSGTOOLONG);                                                   70759000
              HEADING("MSG TOO"," LONG  ",0,0,2);                       70760000
%                                                                       70761000
         LOAD(CR);                                                      70762000
         STIND(MODEMPOINTER);                                           70763000
         SP2;                                                           70764000
         LOAD(MBUFF);                                                   70765000
         T(C,X);                                                        70766000
         ADD(UDOFFSET);                                                 70767000
         SUB(MODEMPOINTER);                                             70768000
         CIA;                                                           70769000
         SP1;                                                           70770000
         STX(2);                                                        70771000
%                                                                       70772000
    LABL(LOOKFORENDOFBLOCK);                                            70773000
              HEADING("LOOK FO","R END O","F BLOCK",0,3);               70774000
%                                                                       70775000
         PRECISION := 1;                                                70776000
         RSLEEP(0);                                                     70777000
         RECEIVE;                                                       70778000
         SUB(ETX);                                                      70779000
         SAZN;                                                          70780000
         GOTO(EOM);                                                     70781000
         SUB(EOT - ETX);                                                70782000
         SAZN;                                                          70783000
         GOTO(FOUNDANEOT);                                              70784000
         SUB(CR - EOT);                                                 70785000
         SAZN;                                                          70786000
         GOTO(GETABLOCK);                                               70787000
         ENS;                                                           70788000
%                                                                       70789000
    LABL(GETACHAR);                                                     70790000
              HEADING("GET A C","HAR    ",0,0,2);                       70791000
%                                                                       70792000
         DS2(0);                                                        70793000
         SP1;                                                           70794000
         SEN(ODDPARITY);                                                70795000
         GOTO(FORMATERROR);                                             70796000
         BTI(MODEMREAD);                                                70797000
         ANDM(127);                                                     70798000
         T(C,A);                                                        70799000
         SUB(SYNC);                                                     70800000
         SAZN;                                                          70801000
         ENS;                                                           70802000
         LOAD(BCC);                                                     70803000
         EOR(A,C);                                                      70804000
         ST(BCC);                                                       70805000
         T(A,C);                                                        70806000
         SUB(CONTROLAT);                                                70807000
         SAZN;                                                          70808000
         GOTO(LOC+6);                                                   70809000
         T(A,C);                                                        70810000
         GOTOIND(GETACHAR);                                             70811000
         LOAD(LEFTARROW);                                               70812000
         GOTOIND(GETACHAR);                                             70813000
%                                                                       70814000
%                                                                       70815000
    END OF MODEM RECEIVE CODE;                                          70816000
%                                                                       70817000
%                                                                       70818000
%         THE NEXT PROCEDURE CONTAINS THE MODEM CODE TO TRANSMIT        70819000
%         INFORMATION DOWN THE LINE TO THE SYSTEM.                      70820000
%                                                                       70821000
PROCEDURE MODEMTRANSMIT;                                                70822000
    BEGIN                                                               70823000
%                                                                       70824000
         REAL SGMENT;                                                   70825000
%                                                                       70826000
    LABL(INITIATETRANSMIT);                                             70827000
              HEADING("INITIAT","E TRANS","MIT    ",0,3);               70828000
%                                                                       70829000
         DS2(0);                                                        70830000
         FUN(TURNONRS);                                                 70831000
         SP1;                                                           70832000
         LOAD(16);                                                      70833000
         MIN;                                                           70834000
         SP2;                                                           70835000
         DESC(OKTOSEND);                                                70836000
         ST(CLEARTOSENDLABEL);                                          70837000
         DESC(XIT);                                                     70838000
         ST(CARRIERLABEL);                                              70839000
         DESC(IGNOREDATAINTERRUPTS);                                    70840000
         ST(TRANSMITLABEL);                                             70841000
         ST(RECEIVELABEL);                                              70842000
         FUN(GOTOBYTEMODE);                                             70843000
         GOTOIND(INITIATETRANSMIT);                                     70844000
%                                                                       70845000
    LABL(OKTOSEND);                                                     70846000
              HEADING("OK TO S","END    ",0,0,2);                       70847000
%                                                                       70848000
         SP2;                                                           70849000
         SEN(CLEARTOSEND);                                              70850000
         ENS;                                                           70851000
         DESC(NORMALCLEARTOSEND);                                       70852000
         ST(CLEARTOSENDLABEL);                                          70853000
         BRM(SYNCHRONIZETRANSMISSION);                                  70854000
         ENS;                                                           70855000
%                                                                       70856000
    LABL(SYNCHRONIZETRANSMISSION);                                      70857000
              HEADING("SYNCHRO","NIZE TR","ANSMISS","ION    ",4);       70858000
%                                                                       70859000
         DS2(0);                                                        70860000
         SP2;                                                           70861000
         LOAD(NEXTACTIVITY);                                            70862000
         ST(MODEMSTATUS);                                               70863000
         ADD(DES(ACTIONLABEL));                                         70864000
         T(C,X);                                                        70865000
         LOADX(0);                                                      70866000
         ST(ACTIONTYPE);                                                70867000
         CLA;                                                           70868000
         ST(NEXTACTIVITY);                                              70869000
         DESC(TRANSMITSYNC);                                            70870000
         ST(TRANSMITLABEL);                                             70871000
         SP1;                                                           70872000
         FUN(GOTOBYTEMODE);                                             70873000
         CLA;                                                           70874000
         IAR;                                                           70875000
         MIN;                                                           70876000
         TRANSMIT(SYNCP);                                               70877000
         LOAD(-3);                                                      70878000
         ST(MC1);                                                       70879000
         GOTOIND(SYNCHRONIZETRANSMISSION);                              70880000
%                                                                       70881000
    LABL(TRANSMITSYNC);                                                 70882000
              HEADING("TRANSMI","T SYNCS",0,0,2);                       70883000
%                                                                       70884000
         SP1;                                                           70885000
         TRANSMIT(SYNCP);                                               70886000
         LOAD(MC1);                                                     70887000
         IAR;                                                           70888000
         ST(MC1);                                                       70889000
         SAZ;                                                           70890000
         ENS;                                                           70891000
         SP2;                                                           70892000
         LOAD(MODEMSTATUS);                                             70893000
         SUB(ACKNOWLEDGE);                                              70894000
         SAZN;                                                          70895000
         GOTO(ACKNOWLEDGELASTREC);                                      70896000
         LOAD(ACTIONTYPE);                                              70897000
         ST(TRANSMITLABEL);                                             70898000
         ENS;                                                           70899000
%                                                                       70900000
    LABL(SENDACK);                                                      70901000
              HEADING("SEND AC","K      ",0,0,2);                       70902000
%                                                                       70903000
         SP1;                                                           70904000
         TRANSMIT(ACKP);                                                70905000
         NEXT(RECEIVEMSG);                                              70906000
         GOTO(FINISHTRANSMIT);                                          70907000
%                                                                       70908000
    LABL(SENDANAK);                                                     70909000
              HEADING("SEND NA","K      ",0,0,2);                       70910000
         SP1;                                                           70911000
         TRANSMIT(NAKP);                                                70912000
         SP2;                                                           70913000
         LOAD(LASTACTIVITY);                                            70914000
         ST(NEXTACTIVITY);                                              70915000
         GOTO(FINISHTRANSMIT);                                          70916000
%                                                                       70917000
    LABL(ACKNOWLEDGELASTREC);                                           70918000
              HEADING("ACKNOWL","EDGE LA","ST REC ",0,3);               70919000
         SP2;                                                           70920000
         CLA;                                                           70921000
         ST(LASTREC);                                                   70922000
         ST(MCOUNT);                                                    70923000
         ST(UNIT);                                                      70924000
         ST(MBUFF);                                                     70925000
         ST(LASTTRAN);                                                  70926000
         BRM(FINDAMESSAGE);                                             70927000
         SAZN;                                                          70928000
         GOTO(NOLINEACTIVITY);                                          70929000
         BRM(LINKBACK);                                                 70930000
         NEXT(RECEIVERESPONSE);                                         70931000
         LOAD(TRANSMITMSG);                                             70932000
         ST(MODEMSTATUS);                                               70933000
         TSLEEP(SENDAHEADER);                                           70934000
%                                                                       70935000
    LABL(NOLINEACTIVITY);                                               70936000
              HEADING("NO LINE"," ACTIVI","TY     ",0,3);               70937000
         NEXT(RECEIVERESPONSE);                                         70938000
         TSLEEP(SENDACK);                                               70939000
%                                                                       70940000
%                                                                       70941000
    LABL(WAKEUPLINE);                                                   70942000
              HEADING("WAKE UP"," LINE  ",0,0,2);                       70943000
         SP1;                                                           70944000
         TRANSMIT(ENQP);                                                70945000
         SP3;                                                           70946000
         LOAD(-TIMEOUT);                                                70947000
         ST(CLOCK);                                                     70948000
         NEXT(RECEIVEACK);                                              70949000
         GOTO(FINISHTRANSMIT);                                          70950000
%                                                                       70951000
    LABL(KILLTHELINE);                                                  70952000
              HEADING("KILL TH","E LINE ",0,0,2);                       70953000
%                                                                       70954000
         SP1;                                                           70955000
         TRANSMIT(EOTP);                                                70956000
         SP2;                                                           70957000
         CLA;                                                           70958000
         ST(NEXTACTIVITY);                                              70959000
         GOTO(FINISHTRANSMIT);                                          70960000
%                                                                       70961000
    LABL(SENDAHEADER);                                                  70962000
              HEADING("SEND A ","HEADER ",0,0,2);                       70963000
%                                                                       70964000
         SP1;                                                           70965000
         TRANSMIT(SOHP);                                                70966000
         INITIALIZEBCC;                                                 70967000
         TSLEEP(0);                                                     70968000
         SP1;                                                           70969000
         SEND(UD1);                                                     70970000
         TSLEEP(0);                                                     70971000
         SP1;                                                           70972000
         SEND(UD2);                                                     70973000
         TSLEEP(0);                                                     70974000
         SP1;                                                           70975000
         SEND(TRANNO);                                                  70976000
         TSLEEP(0);                                                     70977000
         SP1;                                                           70978000
         SEND(STEXT);                                                   70979000
%                                                                       70980000
         SP2;                                                           70981000
         CLA;                                                           70982000
         ST(MCOUNT);                                                    70983000
         BRM(FINDAMESSAGE);                                             70984000
         ST(LASTTRAN);                                                  70985000
         T(C,X);                                                        70986000
         ADD(UDOFFSET);                                                 70987000
         ST(MODEMPOINTER);                                              70988000
         LOADX(2);                                                      70989000
         SR8;                                                           70990000
         ST(MCOUNT);                                                    70991000
         SP1;                                                           70992000
         CIA;                                                           70993000
         ST(RCOUNT);                                                    70994000
         TSLEEP(0);                                                     70995000
         SP1;                                                           70996000
         SEND(CR);                                                      70997000
         LOADIND(MODEMPOINTER);                                         70998000
         SUB(CR);                                                       70999000
         SAZN;                                                          71000000
         GOTO(EOB);                                                     71001000
%                                                                       71002000
    LABL(TAGAIN);                                                       71003000
              HEADING("TAGAIN ",0,0,0,1);                               71004000
%                                                                       71005000
         TSLEEP(0);                                                     71006000
         SP1;                                                           71007000
         LOADIND(MODEMPOINTER);                                         71008000
         BRM(SENDAC);                                                   71009000
         LOAD(RCOUNT);                                                  71010000
         IAR;                                                           71011000
         ST(RCOUNT);                                                    71012000
         SAZN;                                                          71013000
         GOTO(EOB);                                                     71014000
         SP2;                                                           71015000
         LOAD(MODEMPOINTER);                                            71016000
         IAR;                                                           71017000
         ST(MODEMPOINTER);                                              71018000
         SP1;                                                           71019000
         LOADIND(MODEMPOINTER);                                         71020000
         SUB(CR);                                                       71021000
         SAZ;                                                           71022000
         GOTO(TAGAIN);                                                  71023000
%                                                                       71024000
    LABL(EOB);                                                          71025000
              HEADING("EOB    ",0,0,0,1);                               71026000
%                                                                       71027000
         SP2;                                                           71028000
         LOAD(UNIT);                                                    71029000
         SAZN;                                                          71030000
         GOTO(LOC+8);                                                   71031000
         BRM(FINDAMESSAGE);                                             71032000
         SAZ;                                                           71033000
         GOTO(ADDTOMESSAGE);                                            71034000
         TSLEEP(0);                                                     71035000
         SP1;                                                           71036000
         SEND(ETX);                                                     71037000
         TSLEEP(0);                                                     71038000
         SP1;                                                           71039000
         SEND(BCC);                                                     71040000
         NEXT(RECEIVERESPONSE);                                         71041000
         GOTO(FINISHTRANSMIT);                                          71042000
%                                                                       71043000
    LABL(ADDTOMESSAGE);                                                 71044000
              HEADING("ADD TO ","MESSAGE",0,0,2);                       71045000
%                                                                       71046000
         ST(MODEMTEMP);                                                 71047000
         LOAD(LASTTRAN);                                                71048000
         T(C,X);                                                        71049000
         LOADX(0);                                                      71050000
         SAZ;                                                           71051000
         GOTO(LOC-5);                                                   71052000
%                                                                       71053000
         LOAD(MODEMTEMP);                                               71054000
         STX(0);                                                        71055000
         T(C,X);                                                        71056000
         ADD(UDOFFSET);                                                 71057000
         ST(MODEMPOINTER);                                              71058000
         CLA;                                                           71059000
         STX(0);                                                        71060000
         SP1;                                                           71061000
         LOAD(RCOUNT);                                                  71062000
         ST(MC3);                                                       71063000
         LOADX(2);                                                      71064000
         CIA;                                                           71065000
         ST(RCOUNT);                                                    71066000
         LOAD(MC3);                                                     71067000
         SAZ;                                                           71068000
         GOTO(LOC+10);                                                  71069000
         SP2;                                                           71070000
         LOAD(UNITNO);                                                  71071000
         SUB(2);                                                        71072000
         SAZN;                                                          71073000
         GOTO(TAGAIN);                                                  71074000
         TSLEEP(0);                                                     71075000
         SP1;                                                           71076000
         SEND(CR);                                                      71077000
         LOADIND(MODEMPOINTER);                                         71078000
         SUB(CR);                                                       71079000
         SAZN;                                                          71080000
         GOTO(EOB);                                                     71081000
         GOTO(TAGAIN);                                                  71082000
%                                                                       71083000
    LABL(SENDAC);                                                       71084000
              HEADING("SEND AC",0,0,0,1);                               71085000
%                                                                       71086000
         DS2(0);                                                        71087000
         SP1;                                                           71088000
         ANDM(127);                                                     71089000
         T(C,A);                                                        71090000
         T(Z,X);                                                        71091000
         SODN;                                                          71092000
         INCR(X,X);                                                     71093000
         SR1;                                                           71094000
         SAZ;                                                           71095000
         GOTO(LOC-5);                                                   71096000
         T(X,C);                                                        71097000
         SODN;                                                          71098000
         GOTO(LOC+5);                                                   71099000
         LOAD(128);                                                     71100000
         SODN;                                                          71101000
         CLA;                                                           71102000
         NOP;                                                           71103000
         ADDR(A,C);                                                     71104000
         BTO(MODEMWRITE);                                               71105000
         T(C,A);                                                        71106000
         LOAD(BCC);                                                     71107000
         EOR(A,C);                                                      71108000
         ST(BCC);                                                       71109000
         GOTOIND(SENDAC);                                               71110000
%                                                                       71111000
    LABL(FINISHTRANSMIT);                                               71112000
              HEADING("FINISH ","TRANSMI","T      ",0,3);               71113000
         SP1;                                                           71114000
         CLA;                                                           71115000
         ST(MC1);                                                       71116000
         TSLEEP(0);                                                     71117000
         SP1;                                                           71118000
         TRANSMIT(SYNCP);                                               71119000
         LOAD(MC1);                                                     71120000
         SAZ;                                                           71121000
         GOTO(READYTODROPLINE);                                         71122000
         IAR;                                                           71123000
         ST(MC1);                                                       71124000
         ENS;                                                           71125000
%                                                                       71126000
    LABL(READYTODROPLINE);                                              71127000
              HEADING("READY T","O DROP ","LINE   ",0,3);               71128000
%                                                                       71129000
         TSLEEP(0);                                                     71130000
         SP2;                                                           71131000
         FUN(TURNOFFRS);                                                71132000
         LOAD(MODEMSTATUS);                                             71133000
         ST(LASTACTIVITY);                                              71134000
         SUB(TRANSMITEOT);                                              71135000
         SAZ;                                                           71136000
         GOTO(LOC+10);                                                  71137000
         SP1;                                                           71138000
         LOAD(MODEMFLAGS);                                              71139000
         ANDM(63);                                                      71140000
         ST(MODEMFLAGS);                                                71141000
         SP2;                                                           71142000
         CLA;                                                           71143000
         ST(MODEMSTATUS);                                               71144000
         DESC(IGNOREDATAINTERRUPTS);                                    71145000
         ST(TRANSMITLABEL);                                             71146000
         DESC(NORMALCARRIER);                                           71147000
         ST(CARRIERLABEL);                                              71148000
         DESC(LOOKFORDATA);                                             71149000
         ST(RECEIVELABEL);                                              71150000
         FUN(GOTOBITMODE);                                              71151000
         ENS;                                                           71152000
%                                                                       71153000
    LABL(ABORTTRANSMIT);                                                71154000
              HEADING("ABORT T","RANSMIT",0,0,2);                       71155000
%                                                                       71156000
         FUN(TURNOFFRS);                                                71157000
         LOAD(IDLE);                                                    71158000
         ST(MODEMSTATUS);                                               71159000
         DESC(NORMALCLEARTOSEND);                                       71160000
         ST(CLEARTOSENDLABEL);                                          71161000
         ENS;                                                           71162000
%                                                                       71163000
    LABL(IGNOREDATAINTERRUPTS);                                         71164000
              HEADING("IGNORE ","DATA IN","TERRUPT","S      ",4);       71165000
%                                                                       71166000
         SEN(DATAPRESENT);                                              71167000
         ENS;                                                           71168000
         BTI(MODEMREAD);                                                71169000
%                                                                       71170000
         ENS;                                                           71171000
%                                                                       71172000
%                                                                       71173000
    END OF MODEM TRANSMIT;                                              71174000
%                                                                       71175000
%                                                                       71176000
%         THE NEXT PROCEDURE CONTAINS MISCELLANEOUS MODEM CODE.         71177000
%                                                                       71178000
PROCEDURE MODEMCODE;                                                    71179000
    BEGIN                                                               71180000
%                                                                       71181000
         REAL SEGMENT;                                                  71182000
%                                                                       71183000
    LABL(LOSSOFINTERLOCK);                                              71184000
              HEADING("LOSS OF"," INTERL","OCK    ",0,3);               71185000
         SP1;                                                           71186000
         LOAD(DTRBIT);                                                  71187000
         ST(MODEMSTATUS);                                               71188000
         FUN(TURNONDTR);                                                71189000
         SPOUT(NOSYSTEMLINK);                                           71190000
         LOAD(MODEMSTATUS);                                             71191000
         SUB(TRANSMITMSG);                                              71192000
         SAZN;                                                          71193000
         GOTO(LOC+20);                                                  71194000
         SUB(RECEIVEMSG - TRANSMITMSG);                                 71195000
         SAZ;                                                           71196000
         GOTO(INTERLOCKCLEANUP);                                        71197000
         LOAD(LASTTRAN);                                                71198000
         SAZN;                                                          71199000
         GOTO(LOC+5);                                                   71200000
         BRM(LINKBACK);                                                 71201000
         CLA;                                                           71202000
         ST(LASTTRAN);                                                  71203000
         GOTO(INTERLOCKCLEANUP);                                        71204000
         LOAD(LASTREC);                                                 71205000
         BRM(SUPERFORGET);                                              71206000
%                                                                       71207000
    LABL(INTERLOCKCLEANUP);                                             71208000
              HEADING("INTERLO","CK CLEA","NUP    ",0,3);               71209000
         CLA;                                                           71210000
         ST(LASTREC);                                                   71211000
         ST(UNIT);                                                      71212000
         ST(MODEMSTATUS);                                               71213000
         ST(LASTACTIVITY);                                              71214000
         ST(NEXTACTIVITY);                                              71215000
         DESC(ANSWERRING);                                              71216000
         ST(RINGLABEL);                                                 71217000
         ENS;                                                           71218000
%                                                                       71219000
    LABL(ANSWERRING);                                                   71220000
              HEADING("ANSWER ","RING   ",0,0,2);                       71221000
%                                                                       71222000
         SP1;                                                           71223000
         FUN(TURNONDTR);                                                71224000
         LOAD(DTRBIT + RINGBIT);                                        71225000
         ST(MODEMFLAGS);                                                71226000
         SP2;                                                           71227000
         LOAD(LOOKFORRING);                                             71228000
         ST(MODEMSTATUS);                                               71229000
         ENS;                                                           71230000
%                                                                       71231000
    LABL(IGNORERING);                                                   71232000
              HEADING("IGNORE ","RING   ",0,0,2);                       71233000
%                                                                       71234000
         FUN(DISABLEMODEMINTERRUPT);                                    71235000
         ENS;                                                           71236000
%                                                                       71237000
    LABL(TSLEEPER);                                                     71238000
              HEADING("T SLEEP","ER     ",0,0,2);                       71239000
%                                                                       71240000
         ST(TRANSMITLABEL);                                             71241000
         ENS;                                                           71242000
%                                                                       71243000
    LABL(RSLEEPER);                                                     71244000
              HEADING("R SLEEP","ER     ",0,0,2);                       71245000
%                                                                       71246000
         ST(RECEIVELABEL);                                              71247000
         ENS;                                                           71248000
%                                                                       71249000
    LABL(TSLEEPHERE);                                                   71250000
              HEADING("TSLEEP ","HERE   ",0,0,2);                       71251000
         DS2(0);                                                        71252000
         SP2;                                                           71253000
         LOAD(TSLEEPHERE);                                              71254000
         ST(TRANSMITLABEL);                                             71255000
         ENS;                                                           71256000
%                                                                       71257000
    LABL(RSLEEPHERE);                                                   71258000
              HEADING("RSLEEP ","HERE   ",0,0,2);                       71259000
         DS2(0);                                                        71260000
         SP2;                                                           71261000
         LOAD(RSLEEPHERE);                                              71262000
         ST(RECEIVELABEL);                                              71263000
         ENS;                                                           71264000
%                                                                       71265000
%                                                                       71266000
    LABL(LINKBACK);                                                     71267000
              HEADING("LINK BA","CK     ",0,0,2);                       71268000
         DS2(0);                                                        71269000
         T(C,A);                                                        71270000
         T(C,X);                                                        71271000
         LOADX(0);                                                      71272000
         SAZ;                                                           71273000
         GOTO(LOC-5);                                                   71274000
         T(X,C);                                                        71275000
         ST(MODEMTEMP);                                                 71276000
         LOAD(UNIT);                                                    71277000
         ADD(DES(QUEUES));                                              71278000
         T(C,X);                                                        71279000
         LOADX(0);                                                      71280000
         SAZN;                                                          71281000
         GOTO(MAKEANEWQ);                                               71282000
         STIND(MODEMTEMP);                                              71283000
         T(A,C);                                                        71284000
         STX(0);                                                        71285000
         GOTOIND(LINKBACK);                                             71286000
%                                                                       71287000
    LABL(MAKEANEWQ);                                                    71288000
              HEADING("MAKE A ","NEW Q  ",0,0,2);                       71289000
         T(A,C);                                                        71290000
         STX(0);                                                        71291000
         LOAD(MODEMTEMP);                                               71292000
         STX(2);                                                        71293000
         GOTOIND(LINKBACK);                                             71294000
%                                                                       71295000
    LABL(FINDAMESSAGE);                                                 71296000
              HEADING("FIND A ","MESSAGE",0,0,2);                       71297000
%                                                                       71298000
         DS2(0);                                                        71299000
         SP2;                                                           71300000
         LOAD(UNIT);                                                    71301000
         SAZN;                                                          71302000
         GOTO(FINDAUNIT);                                               71303000
%                                                                       71304000
    LABL(UNITFOUND);                                                    71305000
              HEADING("UNIT FO","UND    ",0,0,2);                       71306000
%                                                                       71307000
         SR1;     SL1;                                                  71308000
         ADD(DES(QUEUES));                                              71309000
         T(C,X);                                                        71310000
         LOADX(0);                                                      71311000
         SAZN;                                                          71312000
         GOTOIND(FINDAMESSAGE);                                         71313000
%                                                                       71314000
         T(X,A);                                                        71315000
         T(C,X);                                                        71316000
         ST(MODEMTEMP);                                                 71317000
         LOADX(ENDPOS);                                                 71318000
         SR8;                                                           71319000
         ADD(MCOUNT);                                                   71320000
         ST(MCOUNT);                                                    71321000
         SUB(MSMAX);                                                    71322000
         SAN;                                                           71323000
         GOTO(NOGO);                                                    71324000
%                                                                       71325000
         LOADX(0);                                                      71326000
         T(A,X);                                                        71327000
         STX(0);                                                        71328000
         SAZN;                                                          71329000
         STX(2);                                                        71330000
         CLA;                                                           71331000
         STIND(MODEMTEMP);                                              71332000
         LOAD(MODEMTEMP);                                               71333000
         GOTOIND(FINDAMESSAGE);                                         71334000
%                                                                       71335000
    LABL(NOGO);                                                         71336000
         CLA;                                                           71337000
         GOTOIND(FINDAMESSAGE);                                         71338000
%                                                                       71339000
    LABL(FINDAUNIT);                                                    71340000
              HEADING("FIND A ","UNIT   ",0,0,2);                       71341000
         DESC(QUEUES);                                                  71342000
         T(C,X);                                                        71343000
         LOADX(0);                                                      71344000
         SAZ;                                                           71345000
         GOTO(FOUNDTRAFFIC);                                            71346000
         ROF;                                                           71347000
         LOAD(4);                                                       71348000
         ADDR(C,X);                                                     71349000
         LOADX(0);                                                      71350000
         SAZ;                                                           71351000
         GOTO(FOUNDTRAFFIC);                                            71352000
         SOVN;                                                          71353000
         GOTOIND(FINDAMESSAGE);                                         71354000
         SOF;                                                           71355000
         GOTO(LOC-13);                                                  71356000
%                                                                       71357000
    LABL(FOUNDTRAFFIC);                                                 71358000
              HEADING("FOUND T","RAFFIC ",0,0,2);                       71359000
         T(X,C);                                                        71360000
         SUB(DES(QUEUES));                                              71361000
         ST(UNIT);                                                      71362000
         SR1;     SR1;                                                  71363000
         T(C,A);                                                        71364000
         BRM(SETUPUDINFO);                                              71365000
         LOAD(UNIT);                                                    71366000
         GOTO(UNITFOUND);                                               71367000
%                                                                       71368000
    LABL(SETUPUDINFO);    % THE A REGISTER SHOULD CONTAIN THE UNIT #    71369000
              HEADING("SET UP ","UD INFO",0,0,2);                       71370000
         PRECISION := 2;                                                71371000
         DS2(0);                                                        71372000
         T(A,C);                                                        71373000
         ADD(DES(TOGTABLE));                                            71374000
         T(C,X);                                                        71375000
         LOADX(0);                                                      71376000
         ST(UDTOGS);                                                    71377000
         DESC(LENGTHTABLE);                                             71378000
         T(C,X);                                                        71379000
         ADDR(A,X);                                                     71380000
         SP1;                                                           71381000
         LOADX(0);                                                      71382000
         ST(UDLENGTH);                                                  71383000
         SP2;                                                           71384000
         T(A,C);                                                        71385000
         SL1;                                                           71386000
         ST(UNITNO);                                                    71387000
         ADD(DES(OFFSETTABLE));                                         71388000
         T(C,X);                                                        71389000
         LOADX(0);                                                      71390000
         ST(UDOFFSET);                                                  71391000
         LOAD(12336);                                                   71392000
         ADDR(A,C);                                                     71393000
         ST(UD1);                                                       71394000
         T(A,C);                                                        71395000
         ADD(DES(UNITLIMITTABLE));                                      71396000
         T(C,X);                                                        71397000
         LOADX(0);                                                      71398000
         ST(UNITLIMIT);                                                 71399000
         LOAD(UNITNO);                                                  71400000
         ADD(DES(UNITCOUNTTABLE));                                      71401000
         T(C,X);                                                        71402000
         LOADX(0);                                                      71403000
         ST(UNITCOUNT);                                                 71404000
         GOTOIND(SETUPUDINFO);                                          71405000
%                                                                       71406000
    LABL(HL);                                                           71407000
              HEADING("H/L    ",0,0,0,1);                               71408000
         SP2;                                                           71409000
         LOAD(QUEUES);                                                  71410000
         ROF;                                                           71411000
         BRM(CONTROLFORGETSPACE);                                       71412000
         LOAD(SPOUTQ);                                                  71413000
         ROF;                                                           71414000
         BRM(CONTROLFORGETSPACE);                                       71415000
         LOAD(KEYINQ);                                                  71416000
         ROF;                                                           71417000
         BRM(CONTROLFORGETSPACE);                                       71418000
         LOAD(CARDREADERQ);                                             71419000
         ROF;                                                           71420000
         BRM(CONTROLFORGETSPACE);                                       71421000
         LOAD(PRINTERQ);                                                71422000
         SOF;                                                           71423000
         BRM(CONTROLFORGETSPACE);                                       71424000
         SP4;                                                           71425000
         CLA;                                                           71426000
         ST(SPOUTQ);                                                    71427000
         ST(CARDREADERQ);                                               71428000
         ST(KEYINQ);                                                    71429000
         ST(PRINTERQ);                                                  71430000
         ST(QUEUES);                                                    71431000
         ROF;                                                           71432000
         BRM(CONTROLGETSPACE);                                          71433000
         T(C,X);                                                        71434000
         ST(QUEUES);                                                    71435000
         ST(SOFTQTAIL);                                                 71436000
         CLA;                                                           71437000
         STX(0);                                                        71438000
         ST(UNIT);                                                      71439000
         SP1;                                                           71440000
         LOAD(48);                                                      71441000
         STX(3);                                                        71442000
         STX(4);                                                        71443000
    IF PRINTERTOG THEN STX(5);                                          71444000
         IAR;                                                           71445000
         ST(TRANNO);                                                    71446000
         ST(RECNO);                                                     71447000
    IF PRINTERTOG THEN LOAD(51);                                        71448000
    IF PRINTERTOG THEN STX(6);                                          71449000
         LOAD(CR);                                                      71450000
         STX(IF PRINTERTOG THEN 7 ELSE 5);                              71451000
         LOAD(IF PRINTERTOG THEN  5 ELSE 3);                            71452000
         STX(2);                                                        71453000
         SP2;                                                           71454000
         LOAD(MODEMSTATUS);                                             71455000
         SAZN;                                                          71456000
         ENS;                                                           71457000
         NEXT(ACKNOWLEDGE);                                             71458000
         RSLEEP(IGNOREDATAINTERRUPTS);                                  71459000
%                                                                       71460000
    LABL(MAKENOTREADY);                                                 71461000
              HEADING("MAKE NO","T READY",0,0,2);                       71462000
         PRECISION := 2;                                                71463000
         DS2(0);                                                        71464000
         ST(MODEMTEMP);                                                 71465000
         ADD(12336);                                                    71466000
         T(C,A);                                                        71467000
         ROF;                                                           71468000
         BRM(CONTROLGETSPACE);                                          71469000
         SAZN;                                                          71470000
         GOTOIND(MAKENOTREADY);                                         71471000
         T(C,X);                                                        71472000
         LOAD(12336);                                                   71473000
         IAR;                                                           71474000
         STX(3);                                                        71475000
         T(A,C);                                                        71476000
         STX(5);                                                        71477000
         LOAD(4);                                                       71478000
         STX(1);                                                        71479000
         CLA;                                                           71480000
         STX(0);                                                        71481000
         T(X,A);                                                        71482000
         LOAD(SOFTQTAIL);                                               71483000
         SAZ;                                                           71484000
         GOTO(LOC+10);                                                  71485000
%                                                                       71486000
         T(A,C);                                                        71487000
         ST(QUEUES);                                                    71488000
         ST(SOFTQTAIL);                                                 71489000
         GOTO(LOC+12);                                                  71490000
%                                                                       71491000
         T(A,X);                                                        71492000
         LOAD(QUEUES);                                                  71493000
         STX(0);                                                        71494000
         T(A,C);                                                        71495000
         ST(QUEUES);                                                    71496000
         LOAD(MODEMTEMP);                                               71497000
         ADD(DES(MASKTABLE));                                           71498000
         T(C,X);                                                        71499000
         SP1;                                                           71500000
         LOADX(0);     CMA;                                             71501000
         T(C,A);                                                        71502000
         LOAD(NRMASK);                                                  71503000
         ORR(A,C);                                                      71504000
         ST(NRMASK);                                                    71505000
         GOTOIND(MAKENOTREADY);                                         71506000
%                                                                       71507000
    LABL(MAKEREADY);                                                    71508000
              HEADING("MAKE RE","ADY    ",0,0,2);                       71509000
         PRECISION := 2;                                                71510000
         DS2(0);                                                        71511000
         T(C,B);                                                        71512000
         ADD(12336);                                                    71513000
         T(C,A);                                                        71514000
         ROF;                                                           71515000
         BRM(CONTROLGETSPACE);                                          71516000
         PRECISION := 2;                                                71517000
         SAZN;                                                          71518000
         GOTOIND(MAKEREADY);                                            71519000
         T(C,X);                                                        71520000
         LOAD(12336);                                                   71521000
         IAR;                                                           71522000
         IAR;                                                           71523000
         STX(3);                                                        71524000
         T(A,C);                                                        71525000
         STX(5);                                                        71526000
         LOAD(4);                                                       71527000
         STX(1);                                                        71528000
         CLA;                                                           71529000
         STX(0);                                                        71530000
         T(X,A);                                                        71531000
         LOAD(SOFTQTAIL);                                               71532000
         SAZ;                                                           71533000
         GOTO(LOC+8);                                                   71534000
%                                                                       71535000
         T(A,C);                                                        71536000
         ST(QUEUES);                                                    71537000
         GOTO(LOC+8);                                                   71538000
%                                                                       71539000
         T(C,X);                                                        71540000
         T(A,C);                                                        71541000
         STX(0);                                                        71542000
         ST(SOFTQTAIL);                                                 71543000
         DESC(MASKTABLE);                                               71544000
         ADDR(B,C);                                                     71545000
         T(C,X);                                                        71546000
         SP1;                                                           71547000
         LOADX(0);                                                      71548000
         ANDM(NRMASK);                                                  71549000
         ST(NRMASK);                                                    71550000
         GOTOIND(MAKEREADY);                                            71551000
%                                                                       71552000
    LABL(NORMALCLEARTOSEND);                                            71553000
              HEADING("NORMAL ","CLEAR T","O SEND ",0,3);               71554000
         SODN;                                                          71555000
         ENS;                                                           71556000
%                                                                       71557000
         SP2;                                                           71558000
         LOAD(LASTACTIVITY);                                            71559000
         SUB(TRANSMITEOT);                                              71560000
         SAZN;                                                          71561000
         GOTO(JUSTIDLEDTHELINE);                                        71562000
         LOAD(MODEMSTATUS);                                             71563000
         SR1;                                                           71564000
         SODN;                                                          71565000
         ENS;                                                           71566000
         SAZN;                                                          71567000
         ENS;                                                           71568000
%                                                                       71569000
         FUN(TURNOFFRS);                                                71570000
         SPOUT(CLSOFF);                                                 71571000
         LOAD(MODEMSTATUS);                                             71572000
         SUB(TRANSMITMSG);                                              71573000
         SAZN;                                                          71574000
         GOTO(HANDLEBADTRAN);                                           71575000
         SP2;                                                           71576000
         LOAD(LASTACTIVITY);                                            71577000
         ST(NEXTACTIVITY);                                              71578000
         CLA;                                                           71579000
         ST(MODEMSTATUS);                                               71580000
         ENS;                                                           71581000
%                                                                       71582000
    LABL(JUSTIDLEDTHELINE);                                             71583000
              HEADING("JUST ID","LED THE"," LINE  ",0,3);               71584000
         SP1;                                                           71585000
         LOAD(MODEMFLAGS);                                              71586000
         ANDM(255 - LINEACTIVEBIT - MYSTARTBIT);                        71587000
         ST(MODEMFLAGS);                                                71588000
         ENS;                                                           71589000
%                                                                       71590000
    LABL(NORMALCARRIER);                                                71591000
              HEADING("NORMAL ","CARRIER",0,0,2);                       71592000
%                                                                       71593000
         SP2;                                                           71594000
         LOAD(MODEMFLAGS);                                              71595000
         SR8;                                                           71596000
         SR1;                                                           71597000
         SODN;                                                          71598000
         GOTO(CARRIERON);                                               71599000
         LOAD(MODEMSTATUS);                                             71600000
         SAZN;                                                          71601000
         GOTO(FINDTHEACTION);                                           71602000
         SR1;                                                           71603000
         SOD;                                                           71604000
         ENS;                                                           71605000
%                                                                       71606000
         LOAD(MODEMSTATUS);                                             71607000
         ST(LASTACTIVITY);                                              71608000
         SAZN;                                                          71609000
         ENS;                                                           71610000
         CLA;                                                           71611000
         ST(MODEMSTATUS);                                               71612000
%                                                                       71613000
    LABL(FINDTHEACTION);                                                71614000
              HEADING("FIND TH","E ACTIO","N      ",0,3);               71615000
%                                                                       71616000
         LOAD(NEXTACTIVITY);                                            71617000
         SAZN;                                                          71618000
         GOTO(LOC+11);                                                  71619000
         SR1;                                                           71620000
         SODN;                                                          71621000
         ENS;                                                           71622000
         BRM(INITIATETRANSMIT);                                         71623000
         ENS;                                                           71624000
%                                                                       71625000
         LOAD(LASTACTIVITY);                                            71626000
         SUB(RECEIVEENQ);                                               71627000
         SAZ;                                                           71628000
         ENS;                                                           71629000
         SP1;                                                           71630000
         LOAD(CONNECTEDBIT + DTRBIT + INTERLOCKBIT);                    71631000
         ST(MODEMFLAGS);                                                71632000
         ENS;                                                           71633000
%                                                                       71634000
    LABL(HANDLEBADTRAN);                                                71635000
              HEADING("HANDLE ","BAD TRA","N      ",0,3);               71636000
%                                                                       71637000
         LOAD(LASTTRAN);                                                71638000
         T(C,A);                                                        71639000
         T(C,X);                                                        71640000
         LOADX(0);                                                      71641000
         SAZ;                                                           71642000
         GOTO(LOC-10);                                                  71643000
         T(X,C);                                                        71644000
         ST(MODEMTEMP);                                                 71645000
%                                                                       71646000
         LOAD(UNIT);                                                    71647000
         SR8;                                                           71648000
         ADD(DES(QUEUES));                                              71649000
         T(C,X);                                                        71650000
         STIND(MODEMTEMP);                                              71651000
         T(A,C);                                                        71652000
         STX(0);                                                        71653000
         GOTO(ABORTTRANSMIT);                                           71654000
%                                                                       71655000
    LABL(CARRIERON);                                                    71656000
              HEADING("CARRIER"," ON    ",0,0,2);                       71657000
%                                                                       71658000
         SP2;                                                           71659000
         LOAD(NEXTACTIVITY);                                            71660000
         SAZN;                                                          71661000
         GOTO(NEWACTIVITY);                                             71662000
         SR1;                                                           71663000
         SOD;                                                           71664000
         ENS;                                                           71665000
         BRM(INITIATERECEIVE);                                          71666000
         ENS;                                                           71667000
%                                                                       71668000
    LABL(NEWACTIVITY);                                                  71669000
              HEADING("NEW ACT","IVITY  ",0,0,2);                       71670000
         SP2;                                                           71671000
         LOAD(MODEMSTATUS);                                             71672000
         SUB(LOOKFORRING);                                              71673000
         SAZN;                                                          71674000
         ENS;                                                           71675000
         NEXT(RECEIVEENQ);                                              71676000
         SP1;                                                           71677000
         LOAD(MODEMFLAGS);                                              71678000
         SL1;     SL1;     SR1;     IAR;     RR1;                       71679000
         ST(MODEMFLAGS);                                                71680000
         BRM(INITIATERECEIVE);                                          71681000
         ENS;                                                           71682000
%                                                                       71683000
    LABL(MODEMIDLE);                                                    71684000
              HEADING("MODEM I","DLE    ",0,0,2);                       71685000
%                                                                       71686000
         DS2(0);                                                        71687000
         SL1;                                                           71688000
         SL1;                                                           71689000
         SAN;                                                           71690000
         GOTOIND(MODEMIDLE);                                            71691000
         LOAD(-4);                                                      71692000
         ST(MC3);                                                       71693000
         BRM(FINDAMESSAGE);                                             71694000
         SAZN;                                                          71695000
         GOTOIND(MODEMIDLE);                                            71696000
         BRM(LINKBACK);                                                 71697000
         BRM(OPENALINE);                                                71698000
         GOTOIND(MODEMIDLE);                                            71699000
%                                                                       71700000
    LABL(OPENALINE);                                                    71701000
              HEADING("OPEN A ","LINE   ",0,0,2);                       71702000
%                                                                       71703000
         DS2(0);                                                        71704000
         BRM(INITIATETRANSMIT);                                         71705000
         NEXT(TRANSMITENQ);                                             71706000
         SP1;                                                           71707000
         LOAD(MODEMFLAGS);                                              71708000
         ANDM(255 - LINEACTIVEBIT - MYSTARTBIT);                        71709000
         ADD(LINEACTIVEBIT + MYSTARTBIT);                               71710000
         ST(MODEMFLAGS);                                                71711000
         GOTOIND(OPENALINE);                                            71712000
%                                                                       71713000
%                                                                       71714000
    END OF MODEM CODE;                                                  71715000
%                                                                       71716000
%                                                                       71717000
%         THE NEXT PROCEDURE RESERVES SPACE NEEDED TO HANDLE THE MODEM. 71718000
%                                                                       71719000
PROCEDURE MODEMSTORAGE;                                                 71720000
    BEGIN                                                               71721000
%                                                                       71722000
         REAL SEGMENT;                                                  71723000
%                                                                       71724000
    LABL(UNITNO);                                                       71725000
              HEADING("UNIT NO",0,0,0,1);                               71726000
         DS2(0);                                                        71727000
%                                                                       71728000
    LABL(UNIT);                                                         71729000
              HEADING("UNIT   ",0,0,0,1);                               71730000
         DS2(0);                                                        71731000
%                                                                       71732000
    LABL(UNITLIMIT);                                                    71733000
              HEADING("UNIT LI","MIT    ",0,0,2);                       71734000
         DS1(0);                                                        71735000
%                                                                       71736000
    LABL(UNITCOUNT);                                                    71737000
              HEADING("UNIT CO","UNT    ",0,0,2);                       71738000
         DS2(0);                                                        71739000
%                                                                       71740000
    LABL(UD1);                                                          71741000
              HEADING("UD1    ",0,0,0,1);                               71742000
         DS1(0);                                                        71743000
%                                                                       71744000
    LABL(UD2);                                                          71745000
              HEADING("UD2    ",0,0,0,1);                               71746000
         DS1(0);                                                        71747000
%                                                                       71748000
    LABL(UDTOGS);                                                       71749000
              HEADING("UDTOGS ",0,0,0,1);                               71750000
         DS1(0);                                                        71751000
%                                                                       71752000
    LABL(UDOFFSET);                                                     71753000
              HEADING("UDOFFSE","T      ",0,0,2);                       71754000
         DS2(0);                                                        71755000
%                                                                       71756000
    LABL(UDLENGTH);                                                     71757000
              HEADING("UDLENGT","H      ",0,0,2);                       71758000
         DS1(0);                                                        71759000
%                                                                       71760000
    LABL(MCOUNT);                                                       71761000
              HEADING("MCOUNT ",0,0,0,1);                               71762000
         DS2(0);                                                        71763000
%                                                                       71764000
    LABL(RCOUNT);                                                       71765000
              HEADING("RCOUNT ",0,0,0,1);                               71766000
         DS1(0);                                                        71767000
%                                                                       71768000
    LABL(MC2);                                                          71769000
              HEADING("MC2    ",0,0,0,1);                               71770000
         DS1(0);                                                        71771000
%                                                                       71772000
    LABL(MC1);                                                          71773000
              HEADING("MC1    ",0,0,0,1);                               71774000
         DS1(0);                                                        71775000
%                                                                       71776000
    LABL(MC3);                                                          71777000
              HEADING("MC3    ",0,0,0,1);                               71778000
         DS1(0);                                                        71779000
%                                                                       71780000
    LABL(MODEMTEMP);                                                    71781000
              HEADING("MODEM T","EMP    ",0,0,2);                       71782000
         DS2(0);                                                        71783000
%                                                                       71784000
    LABL(MBUFF);                                                        71785000
              HEADING("MBUFF  ",0,0,0,1);                               71786000
         DS2(0);                                                        71787000
%                                                                       71788000
    LABL(RECNO);                                                        71789000
              HEADING("REC NO.",0,0,0,1);                               71790000
         DS1(49);                                                       71791000
%                                                                       71792000
    LABL(TRANNO);                                                       71793000
              HEADING("TRAN NO",0,0,0,1);                               71794000
         DS1(49);                                                       71795000
%                                                                       71796000
    LABL(BCC);                                                          71797000
              HEADING("BCC    ",0,0,0,1);                               71798000
         DS1(0);                                                        71799000
%                                                                       71800000
    LABL(MODEMFLAGS);                                                   71801000
              HEADING("MODEM F","LAGS   ",0,0,2);                       71802000
         DS1(0);                                                        71803000
%                                                                       71804000
    LABL(RECEIVELABEL);                                                 71805000
              HEADING("RECEIVE"," LABEL ",0,0,2);                       71806000
         DA(IGNOREDATAINTERRUPTS);                                      71807000
%                                                                       71808000
    LABL(TRANSMITLABEL);                                                71809000
              HEADING("TRANSMI","T LABEL",0,0,2);                       71810000
         DA(IGNOREDATAINTERRUPTS);                                      71811000
%                                                                       71812000
    LABL(RINGLABEL);                                                    71813000
              HEADING("RING LA","BEL    ",0,0,2);                       71814000
         DA(ANSWERRING);                                                71815000
%                                                                       71816000
    LABL(CARRIERLABEL);                                                 71817000
              HEADING("CARRIER"," LABEL ",0,0,2);                       71818000
         DA(NORMALCARRIER);                                             71819000
%                                                                       71820000
    LABL(CLEARTOSENDLABEL);                                             71821000
              HEADING("CLEAR T","O SEND ",0,0,2);                       71822000
         DA(NORMALCLEARTOSEND);                                         71823000
%                                                                       71824000
    LABL(MODEMSTATUS);                                                  71825000
              HEADING("MODEM S","TATUS  ",0,0,2);                       71826000
         DS2(0);                                                        71827000
%                                                                       71828000
    LABL(LASTACTIVITY);                                                 71829000
              HEADING("LAST AC","TIVITY ",0,0,2);                       71830000
         DS2(0);                                                        71831000
%                                                                       71832000
    LABL(NEXTACTIVITY);                                                 71833000
              HEADING("NEXT AC","TIVITY ",0,0,2);                       71834000
         DS2(0);                                                        71835000
%                                                                       71836000
    LABL(ACTIONTYPE);                                                   71837000
              HEADING("ACTION ","TYPE   ",0,0,2);                       71838000
         DS2(0);                                                        71839000
%                                                                       71840000
    LABL(LASTTRAN);                                                     71841000
              HEADING("LAST TR","AN     ",0,0,2);                       71842000
         DS2(0);                                                        71843000
%                                                                       71844000
    LABL(LASTREC);                                                      71845000
              HEADING("LAST RE","C      ",0,0,2);                       71846000
         DS2(0);                                                        71847000
%                                                                       71848000
    LABL(MODEMPOINTER);                                                 71849000
               HEADING("MODEM P","OINTER ",0,0,2);                      71850000
         DS2(0);                                                        71851000
%                                                                       71852000
%                                                                       71853000
    END OF MODEM STORAGE;                                               71854000
%                                                                       71855000
%                                                                       71856000
%         THE FOLLOWING PROCEDURE CONTAINS THE TABLES NEEDED BY THE     71857000
%         MODEM CODE.                                                   71858000
%                                                                       71859000
PROCEDURE MODEMTABLES;                                                  71860000
    BEGIN                                                               71861000
%                                                                       71862000
         REAL SEGMENT;                                                  71863000
%                                                                       71864000
%                                                                       71865000
%         THE FOLLOWING IS TABLE STORAGE FOR THE MODEMS.                71866000
%                                                                       71867000
    LABL(CC1TABLE);                                                     71868000
              HEADING("CC1 TAB","LE     ",0,0,2);                       71869000
         DS2(0);                                                        71870000
         DS2(0);                                                        71871000
         DS2(0);                                                        71872000
         DA(PRINTERCCTABLE);                                            71873000
%                                                                       71874000
    LABL(OFFSETTABLE);                                                  71875000
              HEADING("OFFSET ","TABLE  ",0,0,2);                       71876000
%                                                                       71877000
         DS2(3);                                                        71878000
         DS2(3);                                                        71879000
         DS2(3);                                                        71880000
         DS2(5);                                                        71881000
%                                                                       71882000
    LABL(LENGTHTABLE);                                                  71883000
              HEADING("LENGTH ","TABLE  ",0,0,2);                       71884000
%                                                                       71885000
         DS1(0);                                                        71886000
         DS1(-73);                                                      71887000
         DS1(-80);                                                      71888000
         DS1(-(PRINTERLINELENGTH + 1));                                 71889000
%                                                                       71890000
    LABL(TOGTABLE);                                                     71891000
              HEADING("TOG TAB","LE     ",0,0,2);                       71892000
%                                                                       71893000
         DS1(0);                                                        71894000
         DS1(0);                                                        71895000
         DS1(0);                                                        71896000
         DS1(199);                                                      71897000
%                                                                       71898000
    LABL(OUTPUTUNITTABLE);                                              71899000
              HEADING("OUTPUT ","UNIT TA","BLE    ",0,3);               71900000
         DS2(0);                                                        71901000
         DS2(12);                                                       71902000
         DS2(0);                                                        71903000
         DS2(16);                                                       71904000
%                                                                       71905000
    LABL(INPUTUNITTABLE);                                               71906000
              HEADING("INPUT U","NIT TAB","LE     ",0,3);               71907000
         DS2(0);                                                        71908000
         DS2(4);                                                        71909000
         DS2(8);                                                        71910000
         DS2(0);                                                        71911000
%                                                                       71912000
    LABL(POWERSOF10);                                                   71913000
              HEADING("POWERS ","OF 10  ",0,0,2);                       71914000
%                                                                       71915000
         FOR II := 0 STEP 1 UNTIL 10 DO DS1(IJUNK := 10 | II);          71916000
%                                                                       71917000
    LABL(UNITLIMITTABLE);                                               71918000
              HEADING("UNIT LI","MIT TAB","LE     ",0,3);               71919000
         DS1(20);                                                       71920000
         DS1(5);                                                        71921000
         DS1(6);                                                        71922000
         DS1(20);                                                       71923000
%                                                                       71924000
    LABL(UNITCOUNTTABLE);                                               71925000
              HEADING("UNIT CO","UNT TAB","LE     ",0,3);               71926000
         DS2(0);                                                        71927000
         DA(SPOUTBUFFERS);                                              71928000
         DS2(0);                                                        71929000
    IF PRINTERTOG THEN DA(PRINTERBUFFERS) ELSE DS2(0);                  71930000
%                                                                       71931000
    LABL(MASKTABLE);                                                    71932000
              HEADING("MASK TA","BLE    ",0,0,2);                       71933000
         DS1(255);                                                      71934000
         DS1(254);                                                      71935000
         DS1(251);                                                      71936000
         DS1(253);                                                      71937000
%                                                                       71938000
%                                                                       71939000
%         THE FOLLOWING VECTOR CONTAINS THE ADDRESSES OF THE ROUTINES   71940000
%         TO HANDLE ALL OF THE CONDITIONS THAT THE MODEM ROUTINES       71941000
%         HAVE STATUSES FOR.                                            71942000
%                                                                       71943000
    LABL(ACTIONLABEL);                                                  71944000
              HEADING("ACTION ","LABEL  ",0,0,2);                       71945000
%                                                                       71946000
         DA(IGNOREDATAINTERRUPTS);                                      71947000
         DA(IGNOREDATAINTERRUPTS);                                      71948000
         DA(WAKEUPLINE);                                                71949000
         DA(LOOKFORENQ);                                                71950000
         DA(SENDACK);                                                   71951000
         DA(LOOKFORACK);                                                71952000
         DA(SENDANAK);                                                  71953000
         DS2(0);                                                        71954000
         DA(SENDAHEADER);                                               71955000
         DA(LOOKFORHEADER);                                             71956000
         DA(SENDAHEADER);                                               71957000
         DA(STOREMSG);                                                  71958000
         DA(IGNOREDATAINTERRUPTS);                                      71959000
         DA(CHECKBCC);                                                  71960000
         DA(ACKNOWLEDGELASTREC);                                        71961000
         DA(DECYPHERRESPONSE);                                          71962000
         DA(KILLTHELINE);                                               71963000
         DA(IGNOREDATAINTERRUPTS);                                      71964000
%                                                                       71965000
    END OF MODEM TABLES;                                                71966000
%                                                                       71967000
%                                                                       90000000
    WHILE LOC.ADDRESS LSS 256 DO DS1(0);                                90001000
%                                                                       90002000
    STORAGE;                                                            90003000
    IF PRINTERTOG THEN LINEPRINTERSTORAGE;                              90004000
    IF READERTOG THEN CARDREADERSTORAGE;                                90005000
    SPOSTORAGE;                                                         90006000
    MODEMSTORAGE;                                                       90007000
%                                                                       90008000
    EXECUTIVE;                                                          90009000
%                                                                       90010000
    IF READERTOG THEN CARDREADERINTERRUPT;                              90011000
    MODEMINTERRUPT;                                                     90012000
    PRECISION := 1;                                                     90013000
%                                                                       90014000
    IF READERTOG THEN CARDREADERNOTREADY;                               90015000
%                                                                       90016000
    IF PRINTERTOG THEN LINEPRINTERREADY;                                90017000
    IF READERTOG THEN CARDREADERREADY;                                  90018000
    MODEMRECEIVE;                                                       90019000
    MODEMTRANSMIT;                                                      90020000
%                                                                       90021000
    IF READERTOG THEN CARDREADERMOVER;                                  90022000
%                                                                       90023000
    TRANSLATORS;                                                        90024000
%                                                                       90025000
    SPOCODE;                                                            90026000
    KEYINCODE;                                                          90027000
    SPOUTCODE;                                                          90028000
%                                                                       90029000
    MODEMCODE;                                                          90030000
%                                                                       90031000
    SPACEHANDLER;                                                       90032000
    INTERRUPTCODE;                                                      90033000
%                                                                       90034000
    IF PRINTERTOG THEN LINEPRINTERTABLES;                               90035000
    IF READERTOG THEN CARDREADERTABLES;                                 90036000
    MODEMTABLES;                                                        90037000
    SPOTABLES;                                                          90038000
    INITIALIZSYSTEM;                                                    90039000
%                                                                       90040000
%                                                                       90041000
    END UNTIL DONEIHOPE;                                                90042000
%                                                                       90043000
    WRITERECORD;                                                        90044000
    CLOSE(LINE);                                                        90045000
    CODEARRAY[0] := LASTCODEINX;                                        90046000
    CODEARRAY[1] := RECORDS;                                            90047000
    WRITE(CODE,60,CODEARRAY[*]);                                        90048000
    LOCK(CODE);                                                         90049000
%                                                                       90050000
PUNCHONLY:                                                              90051000
    IF ERRORS = 0 THEN PUNCHER;                                         90052000
%                                                                       90053000
END.                                                                    90054000
END;END.        LAST CARD ON 0CRDING TAPE                               99999999
