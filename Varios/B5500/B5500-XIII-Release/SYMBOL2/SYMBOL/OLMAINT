%%%%%%%%%%ONLINE/MAINT%%%%%JUNE 30,1971 EDITION%%%%%T.M.E.%%%%%%%%%%%%%%00010000
 BEGIN                                                                  00020000
     COMMENT   PATCH LEVEL IN COMPILER HEADING AT 04170000******;       00021000
     INTEGER                                                            00030000
          ERRORS,                                                       00040000
          FILEADDR,                                                     00050000
          TEST,                                                         00060000
          STOPPER;                                                      00070000
%***********************************************************************00080000
          FILE TWX 19(2,10),                                            00090000
          MAINT(2,10),                                                  00100000
          SPO 11(2,10),                                                 00110000
          LINE 1(2,17),                                                 00120000
          PBD 15(2,17),                                                 00130000
          PBT 6(2,17),                                                  00140000
          NEWTAPE TAPE (2,10,150,SAVE 100),                             00150000
          TAPE TAPE (2,10,150),                                         00160000
          DSK DISK SERIAL "CONF   " "MAINT  " (2,10,150),               00170000
          PTCH DISK SERIAL "PATCH  " "MAINT  " (2,10,150),              00180000
          UFILE DISK SERIAL "TPECNF " "MAINT  " (2,30,SAVE 10),         00190000
          COEFILE DISK SERIAL [1:1024] "TPECNF " "MAINT  "              00200000
               (2,30,SAVE 10),                                          00210000
          VFILE DISK SERIAL [20:600] "NEW    " "MAINT  " (2,10,         00220000
               150,SAVE 10);                                            00230000
%***********************************************************************00240000
     SWITCH FILE OUTFILE:=LINE,SPO,PBD,PBT,TWX;                         00250000
     SWITCH FILE CONFROLFILE:=TWX,SPO;                                  00260000
     SWITCH FILE INPUTFILE:=TWX,SPO,MAINT,TAPE,DSK;                     00270000
     SWITCH FILE COEDFILE:=COEFILE,UFILE;                               00280000
     SWITCH FILE PATCHFILE:=MAINT,PTCH;                                 00290000
     SWITCH FILE NEWT:=VFILE,NEWTAPE;                                   00300000
%***********************************************************************00310000
     DEFINE OUTFI=OUTFILE[OUTSWITCH]#,                                  00320000
            CFILE=CONFROLFILE[CSWITCH]#,                                00330000
            PATCH=PATCHFILE[PATCHSWITCH]#,                              00340000
            NEW=NEWT[NEWSWITCH]#,                                       00350000
            INFILE=INPUTFILE[INSWITCH]#;                                00360000
%***********************************************************************00370000
     FORMAT DONETESTS("ON-LINE MAINTENANCE TESTS COMPLETED"),           00380000
            INVCMN("INPUT DEVICE UNKNOWN~"),                            00390000
            WHATUNIT("CR OR SPO~"),                                     00400000
            STAR(36("*")),                                              00410000
            TERM("ONLINE/MAINT TERMINATED BY OPERATOR ");               00420000
%***********************************************************************00430000
     DEFINE TERMINATE=BEGIN                                             00440000
                           WRITE(OUTFI[DBL],TERM);                      00450000
                           DATIME;                                      00460000
                           GO EXIT;                                     00470000
                      END#;                                             00480000
%***********************************************************************00490000
     REAL JUNK,                                                         00500000
          NT1,                                                          00510000
          NT2,                                                          00520000
          NT3,                                                          00530000
          NT4,                                                          00540000
          NT5,                                                          00550000
          NT6;                                                          00560000
%***********************************************************************00570000
     INTEGER                                                            00580000
          MIX,                                                          00590000
          T,                                                            00600000
          BEGINADDR,                                                    00610000
          ENDADDR,                                                      00620000
          SEGS,                                                         00630000
          COUNT,                                                        00640000
          ABREVIATE,                                                    00650000
          WBUFF,                                                        00660000
          UNIT,                                                         00670000
          TINU,                                                         00680000
          DKTYPE,                                                       00690000
          INSWITCH,                                                     00700000
          OUTSWITCH,                                                    00710000
          CSWITCH,                                                      00720000
          PATCHSWITCH,                                                  00730000
          SEGNO,                                                        00740000
          NUMBEROFTESTS,                                                00750000
          HDR,                                                          00760000
          INP,                                                          00770000
          ERROR;                                                        00780000
%***********************************************************************00790000
     BOOLEAN                                                            00800000
          OCTL,                                                         00810000
          BCL,                                                          00820000
          NOWRT,                                                        00830000
          WRTLOCK,                                                      00840000
          DONETOG,                                                      00850000
          AREACLEARED,                                                  00860000
          FILEOPENED,                                                   00870000
          TWXOUT,                                                       00880000
          COMPAREDATA,                                                  00890000
          ABREV,                                                        00891000
          IGNORERRORS,                                                  00892000
          LST,                                                          00900000
          JUNKB,                                                        00910000
          COMPILING,                                                    00920000
          PAGE;                                                         00930000
%***********************************************************************00940000
     LABEL                                                              00950000
          RETURN,                                                       00960000
          ALLDONE,                                                      00970000
          EXIT,                                                         00980000
          RUNDISKTESTS;                                                 00990000
%***********************************************************************01000000
     SAVE ARRAY                                                         01010000
          INPUTBUFFER[0:29],                                            01020000
          JUNKBUFFER[0:60],                                             01030000
          TESTBUFFER[0:5],                                              01040000
          TRANSLATEBUFFER[0:7],                                         01050000
          OUTBUFFER[0:29];                                              01060000
%***********************************************************************01070000
     ARRAY                                                              01080000
          TESTARRAY[0:11];                                              01090000
%***********************************************************************01100000
     DEFINE                                                             01110000
          IOMASK=..2000000000#,                                         01120000
          MAXLEVELS=9#,                                                 01130000
          MAXPATTERNS=64#,                                              01140000
          MAXBUFFS=10#,                                                 01150000
          SEGSIZE=512#,                                                 01160000
          MAXSEGS=64#,                                                  01170000
          NUMBEROFDISKTESTS=11#,                                        01180000
          NUMBEROFTAPETESTS=10#,                                        01190000
          EMPTY=..77777#,                                               01200000
          CF=33:15#,                                                    01210000
          FF=18:15#,                                                    01220000
          SF=8:10#,                                                     01230000
          HF=3:15#,                                                     01240000
          SCF=33:9#,                                                    01250000
          CTC=33:33:15#,                                                01260000
          CTF=18:33:15#,                                                01270000
          FTF=18:18:15#,                                                01280000
          CTSF=8:38:10#,                                                01290000
          CTHF=3:33:15#,                                                01300000
          CTSCF=33:39:9#;                                               01310000
%***********************************************************************01320000
     INTEGER STREAM PROCEDURE COREADDR(VAR);                            01330000
          BEGIN SI:=VAR; COREADDR:=SI; END;                             01340000
%***********************************************************************01350000
     STREAM PROCEDURE CLEER(A,L); VALUE A,L;                            01360000
          BEGIN LOCAL LL;                                               01370000
               SI:=LOC L; SI:=SI+6; DI:=LOC LL; DI:=DI+7; DS:=CHR;      01380000
               DI:=A; DS:=8 LIT " "; SI:=A;                             01390000
               LL(DS:=32 WDS; DS:=32 WDS); DS:=L WDS;                   01400000
          END;                                                          01410000
%***********************************************************************01420000
     DEFINE CLEAR(CLEAR1,CLEAR2)=                                       01430000
          CLEER(COREADDR(CLEAR1),ENTIER(CLEAR2-1))#;                    01440000
%***********************************************************************01450000
     REAL STREAM PROCEDURE DECMAL(NR); VALUE NR;                        01460000
          BEGIN                                                         01470000
               SI:=LOC NR;                                              01480000
               DI:=LOC DECMAL;                                          01490000
               DS:=8 DEC;                                               01500000
          END;                                                          01510000
%***********************************************************************01520000
     BOOLEAN STREAM PROCEDURE COMPARR(NROFWDS,A,B,READABIL);            01530000
          VALUE NROFWDS,A,B,READABIL;                                   01540000
          BEGIN                                                         01550000
               LABEL BAD,XIT,E,OK;                                      01560000
               LOCAL TEMP,ERROR,TEMP1,ERRORS,TSI;                       01570000
               DI:=LOC ERRORS; DI:=DI+4; DS:=LIT "1";                   01580000
               SI:=A; DI:=B;                                            01590000
               TALLY:=1;                                                01600000
               NROFWDS(IF 8 SC=DC THEN                                  01610000
                    BEGIN                                               01620000
                         ERROR(JUMP OUT TO OK);                         01630000
                         TALLY:=TALLY+1;                                01640000
                    OK:                                                 01650000
                    END ELSE                                            01660000
                    BEGIN                                               01670000
                         READABIL(TEMP:=TALLY; JUMP OUT 2 TO BAD);      01680000
                         ERROR(JUMP OUT TO E); TEMP:=TALLY;             01690000
                         TALLY:=1; ERROR:=TALLY; TALLY:=0;              01700000
                    E:                                                  01710000
                         TALLY:=TALLY+1;                                01720000
                         SI:=SI-8; DI:=DI-8;                            01730000
                         8(IF SC=DC THEN ELSE                           01740000
                         BEGIN                                          01750000
                              TSI:=SI; SI:=ERRORS; SI:=SI+8;            01760000
                              ERRORS:=SI; SI:=TSI;                      01770000
                         END);                                          01780000
                    END);                                               01790000
               ERROR(JUMP OUT TO BAD);                                  01800000
               GO XIT;                                                  01810000
          BAD:                                                          01820000
               TSI:=TALLY; SI:=LOC TSI; SI:=SI+7;                       01830000
               DI:=LOC COMPARR; DI:=DI+3; DS:=CHR;                      01840000
               SI:=LOC ERRORS; SI:=SI+6;                                01850000
               DS:=2 CHR;                                               01860000
               SI:=LOC TEMP; SI:=SI+7; DS:=CHR; DS:=LIT "1";            01870000
          XIT: END;                                                     01880000
%***********************************************************************01890000
     INTEGER PROCEDURE MAX(A,B); VALUE A,B; INTEGER A,B;                01900000
          MAX:=IF A GEQ B THEN A ELSE B;                                01910000
%***********************************************************************01920000
     INTEGER PROCEDURE MIN(A,B); VALUE A,B; INTEGER A,B;                01930000
          MIN:=IF A LEQ B THEN A ELSE B;                                01940000
%***********************************************************************01950000
     BOOLEAN PROCEDURE BIGCOMPARE(N,A,B,ERRORS,FIRST,WORD);             01960000
          VALUE N,A,B;                                                  01970000
          INTEGER N,A,B,ERRORS,FIRST,WORD;                              01980000
          BEGIN                                                         01990000
          BOOLEAN T,R;                                                  02000000
          INTEGER I,J,K,EC,F,W,G;                                       02010000
%                                                                       02020000
          IF N LSS 0 THEN                                               02030000
          BEGIN                                                         02040000
               A:=A+N+1;                                                02050000
               B:=B-(N:=ABS(N))+1;                                      02060000
          END;                                                          02070000
          F:=EMPTY;                                                     02080000
          FOR I:=((N+62) DIV 63)-1 STEP -1 UNTIL 0 DO                   02090000
          BEGIN                                                         02100000
               IF T:=COMPARR(IF I NEQ 0 THEN 63 ELSE                    02110000
                             IF J:=N MOD 63 = 0 THEN 63 ELSE J,         02120000
                             A,B,0) THEN                                02130000
               BEGIN                                                    02140000
                    EC:=EC+(K:=REAL(T)).[27:9];                         02150000
                    W:=W+K.[18:6];                                      02160000
                    IF F=EMPTY THEN F:=K.[36:6]+G;                      02170000
               END;                                                     02180000
               A:=A+63; B:=B+63; G:=G+63;                               02190000
          END;                                                          02200000
          BIGCOMPARE:=(ERRORS:=EC) NEQ 0;                               02390000
          FIRST:=F;                                                     02400000
          WORD:=W;                                                      02410000
          END;                                                          02420000
%***********************************************************************02430000
     DEFINE COMPARED(COMPARED1,COMPARED2,COMPARED3,COMPARED4)=          02440000
            COMPARR(COMPARED1,COREADDR(COMPARED2),                      02450000
                    COREADDR(COMPARED3),COMPARED4)#;                    02460000
     DEFINE COMPARE(COMPARE1)=COMPARED(BUFFLTH,DISK[COMPARE1,1],        02470000
          COMPAREBUFF[COMPARE1-2,1],TEST=3)#;                           02480000
%***********************************************************************02490000
     STREAM PROCEDURE ROTO1(Z,Y,S,SK,GM,D); VALUE Z,Y,S,SK,GM,D;        02500000
          BEGIN                                                         02510000
          SI:=S; SI:=SI+SK; DI:=D;                                      02520000
          Y(16(DS:=32 CHR));                                            02530000
          Z(DS:=8 CHR);                                                 02540000
          SK(DS:=LIT " ");                                              02550000
          DI:=DI-SK; SI:=LOC GM; SI:=SI+7; DS:=CHR;                     02560000
          END;                                                          02570000
%***********************************************************************02580000
     STREAM PROCEDURE ROTATE(BUFF,JUNK,N,LENGTH); VALUE BUFF,N,LENGTH;  02590000
          BEGIN LOCAL L,NN,NNN,LL;                                      02600000
          SI:=LOC LENGTH;DI:=LOC L; SI:=SI+6; DI:=DI+7; DS:=CHR;        02610000
          SI:=LOC N; DI:=LOC NN; SI:=SI+6; DI:=DI+7; DS:=CHR;           02620000
          SI:=LOC N; SI:=SI+5; DI:=LOC NNN; DI:=DI+7; DS:=CHR;          02630000
          SI:=LOC LENGTH; SI:=SI+5; DI:=LOC LL; DI:=DI+7; DS:=CHR;      02640000
          DI:=JUNK; SI:=BUFF;                                           02650000
          NNN(8(16(DS:=32 CHR)));                                       02660000
          NN(DS:=32 CHR; DS:=32 CHR); DS:=N CHR; DI:=BUFF;              02670000
          LL(8(16(DS:=32 CHR)));                                        02680000
          L(DS:=32 CHR; DS:=32 CHR); DS:=LENGTH CHR;                    02690000
          SI:=JUNK; DI:=BUFF;                                           02700000
          LL(8(16(DI:=DI+32)));                                         02710000
          L(DI:=DI+32; DI:=DI+32); DI:=DI+LENGTH;                       02720000
          NNN(8(16(DS:=32 CHR)));                                       02730000
          NN(DS:=32 CHR; DS:=32 CHR); DS:=N CHR;                        02740000
          END;                                                          02750000
%***********************************************************************02760000
     STREAM PROCEDURE BUFFERSHIFT(S,A,B,N,RT,HETO);                     02770000
          VALUE S,A,B,N,RT,HETO;                                        02780000
          BEGIN LOCAL NN,SS,SSS,NNN; LABEL XIT;                         02790000
          SI:=LOC N; SI:=SI+6; DI:=LOC NN; DI:=DI+7; DS:=CHR;           02800000
          SI:=LOC S; SI:=SI+6; DI:=LOC SS; DI:=DI+7; DS:=CHR;           02810000
          SI:=A; DI:=B;                                                 02820000
          RT(SSS(8(16(DI:=DI+32))); SS(DI:=DI+32; DI:=DI+32);           02830000
             DI:=DI+S;                                                  02840000
             NNN(8(16(DS:=32 CHR)));                                    02850000
             NN(DS:=32 CHR; DS:=32 CHR); DS:=N CHR;                     02860000
             HETO(SI:=A; DI:=B;                                         02870000
                  SSS(8(16(DS:=32 CHR)));                               02880000
                  SS(DS:=32 CHR; DS:=32 CHR); DS:=S CHR);               02890000
             JUMP OUT TO XIT);                                          02900000
          SSS(8(16(SI:=SI+32)));                                        02910000
          SS(SI:=SI+32; SI:=SI+32); SI:=SI+S;                           02920000
          NNN(8(16(DS:=32 CHR)));                                       02930000
          NN(DS:=32 CHR; DS:=32 CHR); DS:=N CHR;                        02940000
          HETO(SI:=A;                                                   02950000
               NNN(8(16(SI:=SI+32)));                                   02960000
               NN(SI:=SI+32; SI:=SI+32); SI:=SI+N;                      02970000
               SSS(8(16(DS:=32 CHR)));                                  02980000
               SS(DS:=32 CHR; DS:=32 CHR); DS:=S CHR);                  02990000
     XIT: END;                                                          03000000
%5**********************************************************************03010000
     STREAM PROCEDURE SHIFTIT(N,A,B,R); VALUE N,R;                      03020000
          BEGIN                                                         03030000
          LOCAL NN,RR;                                                  03040000
               SI:=LOC N; SI:=SI+6; DI:=LOC NN; DI:=DI+7; DS:=CHR;      03050000
               SI:=LOC R; SI:=SI+6; DI:=LOC RR; DI:=DI+7; DS:=CHR;      03060000
               SI:=A; DI:=B;                                            03070000
               NN(DS:=32 CHR; DS:=32 CHR); DS:=N CHR;                   03080000
               SI:=A;                                                   03090000
               RR(DS:=32 CHR; DS:=32 CHR); DS:=R CHR;                   03100000
          END;                                                          03110000
%***********************************************************************03120000
     STREAM PROCEDURE VALUEMOVE(N,A,B); VALUE N,A,B;                    03130000
          BEGIN LOCAL NN;                                               03140000
          SI:=LOC N; SI:=SI+6; DI:=LOC NN; DI:=DI+7; DS:=CHR;           03150000
          SI:=A; DI:=B;                                                 03160000
          NN(DS:=32 WDS; DS:=32 WDS); DS:=N WDS;                        03170000
          END;                                                          03180000
%***********************************************************************03190000
     STREAM PROCEDURE CHARACTERMOVE(N,A,B); VALUE N,A,B;                03200000
          BEGIN LOCAL NN;                                               03210000
          SI:=LOC N; SI:=SI+6; DI:=LOC NN; DI:=DI+7; DS:=CHR;           03220000
          SI:=A; DI:=B; NN(DS:=32 CHR; DS:=32 CHR); DS:=N CHR;          03230000
          END;                                                          03240000
%***********************************************************************03250000
     STREAM PROCEDURE FUNNYMOVE(N,A,B); VALUE N,A;                      03260000
          BEGIN SI:=A;DI:=B;N(DS:=8 CHR); END;                          03270000
%***********************************************************************03280000
     STREAM PROCEDURE EDITR(LENGTH,SOURCE,DEST,BCL,OCTL,                03290000
          JUNKBUFFER,TRANSLATEBUFFER,TWXOUT);                           03300000
          VALUE LENGTH,SOURCE,BCL,OCTL,TWXOUT;                          03310000
          BEGIN                                                         03320000
          LOCAL TEMPS,TEMPD,TEMPR;                                      03330000
          LABEL XIT;                                                    03340000
               SI:=SOURCE;                                              03350000
               TEMPS:=SI;                                               03360000
          BCL(DI:=JUNKBUFFER; TEMPD:=DI;                                03370000
               LENGTH(8(DI:=LOC TEMPR; DI:=DI+7; DS:=CHR;               03380000
                        TEMPS:=SI; SI:=TRANSLATEBUFFER; SI:=SI+TEMPR;   03390000
                        DI:=TEMPD; DS:=CHR; TEMPD:=DI;                  03400000
                        SI:=TEMPS));                                    03410000
                      SI:=JUNKBUFFER; JUMP OUT);                        03420000
          DI:=DEST;                                                     03430000
          TALLY:=1; TEMPS:=TALLY;                                       03440000
          OCTL(LENGTH(2(8(DS:=3 RESET; 3(IF SB THEN DS:=SET ELSE        03450000
                                      DS:=RESET; SKIP SB);              03460000
                         );TEMPS(DS:=LIT " "));DS:=LIT " ");            03470000
               JUMP OUT TO XIT);                                        03480000
          LENGTH(DS:=8 CHR; DS:=LIT " ");                               03490000
          XIT: TWXOUT(DS:=LIT "~"); END;                                03500000
%***********************************************************************03510000
     DEFINE EDIT(EDIT1,EDIT2,EDIT3,EDIT4,EDIT5,EDIT6,EDIT7,EDIT8)=      03520000
          EDITR(EDIT1,COREADDR(EDIT2),EDIT3,EDIT4,EDIT5,EDIT6,          03530000
                EDIT7,EDIT8)#;                                          03540000
%***********************************************************************03550000
     DEFINE                                                             03560000
            SHIFT(SHIFT1,SHIFT2,SHIFT3)=                                03570000
           SHIFTIT(ENTIER(CYNUM:=((CYNUM+1) MOD (T:=8|SHIFT1))),        03580000
                SHIFT2,SHIFT3,ENTIER(T-CYNUM))#,                        03590000
            SHIFTR(SHIFTR1,SHIFTR2,SHIFTR3)=                            03600000
           SHIFTIT(ENTIER(CYNUMR:=((CYNUMR+1) MOD (T:=8|SHIFTR1))),     03610000
                SHIFTR2,SHIFTR3,ENTIER(T-CYNUMR))#;                     03620000
%***********************************************************************03630000
     INTEGER STREAM PROCEDURE OCTAL(NR); VALUE NR;                      03640000
          BEGIN                                                         03650000
          SI:=LOC NR; DI:=LOC OCTAL; DS:=8 OCT;                         03660000
          END;                                                          03670000
%***********************************************************************03680000
     STREAM PROCEDURE MOVE(N,A,B); VALUE N;                             03690000
          BEGIN LOCAL NN;                                               03700000
               SI:=LOC N; DI:=LOC NN; SI:=SI+6; DI:=DI+7; DS:=CHR;      03710000
               SI:=A; DI:=B; NN(DS:=32 WDS; DS:=32 WDS);                03720000
               DS:=N WDS;                                               03730000
          END;                                                          03740000
%***********************************************************************03750000
     DEFINE DECIMAL(DECIMAL1)=IF MAINT THEN MAINTADDR(DECIMAL1)         03760000
                                  ELSE DECMAL(DECIMAL1)#,               03770000
            COMMON=ERRORS#;                                             03780000
%***********************************************************************03790000
     PROCEDURE IOREQUEST(FINAL,IODESC,LOCATION);                        03800000
          VALUE FINAL,IODESC,LOCATION;                                  03810000
          REAL FINAL,IODESC,LOCATION;                                   03820000
          COMMUNICATE(41);                                              03830000
%***********************************************************************03840000
     REAL PROCEDURE DISKIO(CORE,SIZE,DISK);                             03850000
               VALUE SIZE,DISK; ARRAY CORE[*]; INTEGER SIZE,DISK;       03860000
          BEGIN                                                         03870000
          BOOLEAN ERR; REAL IOD;                                        03880000
          INTEGER LOCATION;                                             03890000
               IF BOOLEAN((CORE[0]:=DECMAL(DISK)).[1:5]) THEN           03900000
               BEGIN                                                    03910000
                    UNIT:=19; TINU:=12;                                 03920000
               END ELSE                                                 03930000
               BEGIN                                                    03940000
                    UNIT:=18; TINU:=6;                                  03950000
               END;                                                     03960000
               IOD:=                                                    03970000
               (COREADDR(CORE[0]))&SIZE[8:38:10]&((SIZE.[38:10]+29)     03980000
                    DIV 30 + 512)[18:33:15]&SIZE[24:1:1]&               03990000
                    TINU[3:43:5];                                       04000000
               LOCATION:=COREADDR(IOD);                                 04010000
               IOREQUEST(-IOD&0[25:40:8],IOD,LOCATION&UNIT[12:42:6]&    04020000
                    1[2:47:1]);                                         04030000
               WAIT(LOCATION,IOMASK);                                   04040000
               DISKIO:=IOD;                                             04050000
          END DISKIO;                                                   04060000
%***********************************************************************04070000
     PROCEDURE DATIME;                                                  04080000
          BEGIN                                                         04090000
          ARRAY A[0:6];                                                 04100000
          INTEGER D,H,M,MIN,Q,P,Y,R;                                    04110000
          REAL T1;                                                      04120000
          LABEL OWT;                                                    04130000
          FORMAT DT(A*,"DAY,  ",2(I2,"/"),I2,", ",I2,":",A2,X1,A1,      04140000
                    "M.");                                              04150000
          FORMAT DT1(X26,"BURROUGHS B-5700 SIMPL COMPILER  ",           04160000
                     "MARK XII.2",                                      04170000
                     X5,A*,"DAY,  ",2(I2,"/"),I2,", "                   04171000
                     ,I2,":",A2,X1,A1,"M.");                            04180000
          LIST LST(A[R].[42:6],A[R].[6:36],M,D,Y,12|REAL(Q:=            04190000
                    H MOD 12=0)+Q,Q:=MIN MOD 10+(MIN DIV 10)|64,        04200000
                    IF H GEQ 12 THEN "P" ELSE "A");                     04210000
               FILL A[*] WITH "SUN3","MON3","TUES4","WEDNES6",          04220000
                              "THURS5","FRI3","SATUR5";                 04230000
               IF COMPILING AND OUTSWITCH=0 THEN                        04231000
               BEGIN                                                    04232000
                    WRITE(OUTFI[DBL]);                                  04232100
                    WRITE(OUTFI[DBL]);                                  04232200
               END;                                                     04232300
               Y:=TIME(0);                                              04240000
               T1:=TIME(1);                                             04250000
               D:=Y.[30:6]|100+Y.[36:6]|10+Y.[42:6];                    04260000
               Y:=Y.[18:6]|10+Y.[24:6];                                 04270000
               FOR H:=31,IF Y MOD 4=0 THEN 29 ELSE 28,                  04280000
               31,30,31,30,31,31,30,31,30 DO                            04290000
               IF D LEQ H THEN GO OWT ELSE                              04300000
               BEGIN D:=D-H; M:=M+1; END;                               04310000
          OWT:                                                          04320000
               H:=T1 DIV 216000; MIN:=(T1 DIV 3600) MOD 60;             04330000
               IF M LSS 2 THEN                                          04340000
               BEGIN Q:=M+11; P:=Y-1; END ELSE                          04350000
               BEGIN Q:=M-1; P:=Y; END;                                 04360000
               M:=M+1;                                                  04370000
               R:=((Q|26-2)DIV 10+D+P+P.[36:10]+1)MOD 7;                04380000
               IF COMPILING THEN WRITE(OUTFI[DBL],DT1,LST) ELSE         04390000
               WRITE(OUTFI[DBL],DT,LST);                                04400000
                                                                        04410000
               FILEOPENED:=TRUE;                                        04411000
          END;                                                          04420000
%***********************************************************************04430000
     PROCEDURE DKBUSINESS(BUFF); VALUE BUFF; REAL BUFF;                 04440000
          COMMUNICATE(40);                                              04450000
%***********************************************************************04460000
     INTEGER STREAM PROCEDURE INUNIT(BUFF);                             04470000
          BEGIN                                                         04480000
          LABEL B;                                                      04490000
               SI:=BUFF;                                                04500000
          B:   IF SC=" " THEN BEGIN SI:=SI+1; GO B; END ELSE            04510000
               IF SC="S" THEN TALLY:=1 ELSE                             04520000
               IF SC="C" THEN TALLY:=2 ELSE                             04530000
               TALLY:=3;                                                04540000
               INUNIT:=TALLY;                                           04550000
          END;                                                          04560000
%***********************************************************************04570000
     STREAM PROCEDURE BOJMESS(BUFF,INUNIT);                             04580000
          BEGIN                                                         04590000
          LABEL XIT;                                                    04600000
               DI:=BUFF;                                                04610000
               DS:=14 LIT "INPUT IS FROM ";                             04650000
               SI:=INUNIT;                                              04660000
               2(SI:=SI+1; 7(IF SC="~" THEN                             04670000
                   BEGIN                                                04680000
                        DS:=CHR;                                        04690000
                        JUMP OUT 2 TO XIT;                              04700000
                   END ELSE DS:=CHR));                                  04710000
          XIT: END;                                                     04720000
%***********************************************************************04730000
     PROCEDURE READANDMOVE(SZ,F,BUFFER); VALUE SZ,BUFFER;               04740000
          INTEGER SZ,BUFFER; FILE F;                                    04750000
          BEGIN                                                         04760000
          INTEGER I,J,K;                                                04770000
          BOOLEAN B;                                                    04780000
%                                                                       04790000
               J:=((ABS(SZ)+(K:=IF SZ GTR 0 THEN 30 ELSE 10)-1)         04800000
                    DIV K)-1;                                           04810000
               BUFFER:=BUFFER-K;                                        04820000
               B:=SZ MOD K=0;                                           04830000
               FOR I:=0 STEP 1 UNTIL J DO                               04840000
               BEGIN                                                    04850000
                    READ(F,K,JUNKBUFFER[*]);                            04860000
                    VALUEMOVE(IF I=J AND NOT B THEN ENTIER(SZ MOD K)    04870000
                         ELSE K,COREADDR(JUNKBUFFER),BUFFER:=           04880000
                         BUFFER+K);                                     04890000
               END;                                                     04900000
          END;                                                          04910000
%***********************************************************************04920000
     PROCEDURE MOVEANDWRITE(KEY,SZ,DOBLE,UTILITY,BUFFER);               04930000
          VALUE KEY,SZ,DOBLE,BUFFER;                                    04940000
          INTEGER SZ,BUFFER; BOOLEAN KEY,DOBLE;                         04950000
          FILE UTILITY;                                                 04960000
          BEGIN                                                         04970000
          INTEGER I,J,K,L,X;                                            04980000
          LABEL EOL;                                                    04990000
          FORMAT WRDNO(I4),                                             05000000
               DUPF(X8,*(2(8("=")," ")," ")),                           05010000
               SDUPF(X8,*(8("=")," "));                                 05020000
          BOOLEAN B,DUP;                                                05030000
%                                                                       05040000
               L:=K:=IF KEY THEN WBUFF ELSE 30;                         05050000
               J:=IF KEY AND REAL(KEY) LSS 64 THEN                      05060000
                  (SZ DIV (L:=12-6|REAL(OCTL)-                          05070000
                  (3+2|ABS(REAL(OCTL)-1))|REAL(TWXOUT))                 05080000
                  -REAL(SZ MOD L=0)) ELSE                               05090000
                  ((SZ+K-1) DIV K)-1;                                   05100000
               B:=SZ MOD L=0;                                           05110000
               BUFFER:=BUFFER-L;                                        05120000
               FOR I:=0 STEP 1 UNTIL J DO                               05130000
               BEGIN                                                    05140000
                    CLEAR(OUTBUFFER,K);                                 05150000
                    IF KEY AND REAL(KEY) LSS 64 THEN                    05160000
                    BEGIN                                               05170000
                    IF COMPARR(L,BUFFER,BUFFER:=BUFFER+L,1) OR          05180000
                    I=0 OR                                              05185000
                    I=J THEN                                            05190000
                    BEGIN                                               05200000
                    DUP:=FALSE;                                         05210000
                         WRITE(OUTBUFFER[*],WRDNO,I|L+1);               05220000
                         EDITR(IF I=J AND NOT B THEN                    05230000
                              ENTIER(SZ MOD L) ELSE L,                  05240000
                              BUFFER,                                   05250000
                              OUTBUFFER[1],BCL,OCTL,JUNKBUFFER,         05260000
                              TRANSLATEBUFFER,TWXOUT);                  05270000
                    END ELSE                                            05280000
                    IF DUP THEN GO EOL ELSE                             05290000
                    BEGIN                                               05300000
                         IF OCTL THEN                                   05310000
                              WRITE(OUTBUFFER[*],DUPF,L) ELSE           05320000
                              WRITE(OUTBUFFER[*],SDUPF,L);              05330000
                         DUP:=TRUE;                                     05340000
                    END;                                                05350000
                    END ELSE                                            05360000
                    FUNNYMOVE(IF I=J AND NOT B THEN ENTIER(SZ MOD K)    05370000
                              ELSE K,BUFFER:=BUFFER+K,OUTBUFFER);       05380000
                    IF DOBLE THEN                                       05390000
                    WRITE(UTILITY[DBL],K,OUTBUFFER[*]) ELSE             05400000
                    WRITE(UTILITY,K,OUTBUFFER[*]);                      05410000
          EOL: END;                                                     05420000
          END;                                                          05430000
%***********************************************************************05440000
     PROCEDURE TRANSFEROUT(SIZE,BLENGTH,F,A); VALUE SIZE,BLENGTH;       05450000
          INTEGER SIZE,BLENGTH; FILE F; ARRAY A[*];                     05460000
          BEGIN                                                         05470000
          INTEGER I,J; BOOLEAN B;                                       05480000
%                                                                       05490000
               B:=SIZE MOD BLENGTH=0;                                   05500000
               J:=((SIZE+BLENGTH-1) DIV BLENGTH)-1;                     05510000
               IF SIZE LEQ BLENGTH THEN WRITE(F,SIZE,A[*]) ELSE         05520000
               FOR I:=0 STEP 1 UNTIL J DO                               05530000
               BEGIN                                                    05540000
                    CLEAR(OUTBUFFER,BLENGTH);                           05550000
                    MOVE(IF I=J AND NOT B THEN ENTIER(SIZE MOD          05560000
                         BLENGTH) ELSE BLENGTH,A[I|BLENGTH],            05570000
                         OUTBUFFER);                                    05580000
                    WRITE(F,BLENGTH,OUTBUFFER[*]);                      05590000
               END;                                                     05600000
          END;                                                          05610000
%***********************************************************************05620000
     PROCEDURE TRANSFERIN(SIZE,BLENGTH,F,A); VALUE SIZE,BLENGTH;        05630000
          INTEGER SIZE,BLENGTH; FILE F; ARRAY A[*];                     05640000
          BEGIN                                                         05650000
          BOOLEAN B; INTEGER I,J;                                       05660000
%                                                                       05670000
               IF SIZE LEQ BLENGTH THEN READ(F,SIZE,A[*]) ELSE          05680000
               BEGIN                                                    05690000
                    B:=SIZE MOD BLENGTH=0;                              05700000
                    J:=((SIZE+BLENGTH-1)DIV BLENGTH)-1;                 05710000
                    FOR I:=0 STEP 1 UNTIL J DO                          05720000
                    BEGIN                                               05730000
                         READ(F,BLENGTH,JUNKBUFFER[*]);                 05740000
                         MOVE(IF I=J AND NOT B THEN ENTIER(SIZE         05750000
                              MOD BLENGTH) ELSE BLENGTH,                05760000
                              JUNKBUFFER,A[I|BLENGTH]);                 05770000
                    END;                                                05780000
               END;                                                     05790000
          END;                                                          05800000
%#########OUTER BLOCK CODE STARTS HERE##################################05810000
%                                                                       05820000
          FUNNYMOVE(1,COREADDR(INPUTBUFFER)-2,MIX);                     05830000
          MIX:=MIX.[9:6];                                               05840000
          IF COMMON=0 THEN                                              05850000
          BEGIN                                                         05860000
               DKBUSINESS(COREADDR(JUNK));                              05870000
               IF JUNK.[15:9] LSS 32 THEN COMMON:=3;                    05880000
          END;                                                          05890000
          WHILE COMMON GTR 2 OR COMMON LSS 0 DO                         05900000
          BEGIN                                                         05910000
               WRITE(SPO,INVCMN);                                       05920000
               WRITE(SPO,WHATUNIT);                                     05930000
               READ(SPO,10,INPUTBUFFER[*]);                             05940000
               COMMON:=INUNIT(INPUTBUFFER);                             05950000
          END;                                                          05960000
          IF COMMON NEQ 2 THEN CSWITCH:=INSWITCH:=COMMON                05970000
          ELSE                                                          05980000
          BEGIN CSWITCH:=1; INSWITCH:=2; END;                           05990000
          FILL JUNKBUFFER[*] WITH                                       06000000
               0,"~      ",                                             06010000
               "SPO~   ",0,                                             06020000
               "CARD RE","ADER~  ";                                     06030000
          IF COMMON=0 THEN JUNKBUFFER[0]:=TIME(-1);                     06040000
          BOJMESS(OUTBUFFER,JUNKBUFFER[2|COMMON]);                      06050000
          WRITE(SPO,10,OUTBUFFER[*]);                                   06060000
          COMMON:=0;                                                    06070000
          ENDADDR:=BEGINADDR:=-1;                                       06080000
     RETURN:                                                            06090000
     BEGIN                                                              06100000
%#########SCAN BLOCK DECLARATIONS BEGIN HERE############################06110000
     REAL SPECIALCHR;                                                   06120000
     DEFINE                                                             06130000
          GOPERROR(GOPERROR1)=                                          06140000
          BEGIN                                                         06150000
               ERROR:=GOPERROR1;                                        06160000
               GO PERROR;                                               06170000
          END#,                                                         06180000
          FIRSTEST=9#, %HEADER INDEX OF FIRST CONF TEST                 06190000
          WRD(WRD1,WRD2)=WHATWORD(TESTBUFFER,WRD1,WRD2)#,               06200000
          CODEFILE=COEDFILE[CODESWITCH]#,                               06210000
          DBUFF=COREADDR(SEGDICT)#,                                     06220000
          BL=BOOLEAN#,                                                  06240000
          DUPNR=9#,                                                     06250000
          INVCHR=31#,                                                   06270000
          INVWRD=0#,                                                    06280000
          INVTEST=23#,                                                  06290000
          NOTEST=12#,                                                   06300000
          INVNR=33#,                                                    06310000
        NOUT=32#;                                                       06330000
%***********************************************************************06340000
     FORMAT                                                             06350000
          ENTERDATA("ENTER MAINT CC~"),                                 06360000
          EOFF("-EOF NO LABEL (MAINT)~");                               06380000
%***********************************************************************06390000
     FILE TESTAPE 5(1,10);                                              06400000
%***********************************************************************06410000
     INTEGER                                                            06420000
          CRD,                                                          06430000
          CINSW,                                                        06440000
           COUT,                                                        06450000
          S,                                                            06460000
          A,                                                            06470000
          W,                                                            06480000
          CODESWITCH,                                                   06490000
          LEVELCOUNT,                                                   06500000
          NEXTBUFF,                                                     06510000
          TRANS,                                                        06520000
          NEWSWITCH,                                                    06530000
          LASTSCAN,                                                     06540000
          FIRSTSCAN,                                                    06550000
          ACCUMULATOR;                                                  06560000
%***********************************************************************06570000
     BOOLEAN                                                            06580000
          OP,                                                           06590000
          OBJECTPRESENT,                                                06600000
          LIBONLY,                                                      06610000
          SOP,                                                          06620000
          TAPETEST,                                                     06630000
          DISKTEST,                                                     06640000
          KNOWN,                                                        06650000
          NTOG,                                                         06660000
          HTOG,                                                         06670000
          NOPP,                                                         06680000
          ERRTOG,                                                       06690000
          CONF,                                                         06700000
          LINERROR,                                                     06710000
          XLATE,                                                        06720000
          DONESCAN,                                                     06730000
          CMENT,                                                        06740000
          EOFTOG,                                                       06750000
          SAVING,                                                       06760000
          PTOG,                                                         06770000
          DEBUGN,                                                       06771000
          DOLLRE,                                                       06780000
          MOD3IOS,                                                      06790000
          MAKETAPE,                                                     06800000
          REV;                                                          06810000
%***********************************************************************06820000
     LABEL                                                              06830000
          PERROR,                                                       06840000
          CONTROL,                                                      06850000
          CONFIDENCE,                                                   06860000
          RUNTAPETESTS,                                                 06870000
          MCCLCOMPILER,                                                 06880000
          FINISHOFF,                                                    06890000
          MCCLRUN,                                                      06910000
          R1,                                                           06920000
          READIT,                                                       06930000
          RETURN1;                                                      06940000
%***********************************************************************06950000
     ARRAY                                                              06960000
          COMPAREBUFF[0:45],                                            06970000
          HEADER[0:29];                                                 06980000
%***********************************************************************06990000
     SAVE ARRAY UNITS[0:1,0:17];                                        07000000
%***********************************************************************07010000
     STREAM PROCEDURE FILLRESERVED(COMPAREBUFF);                        07020000
          BEGIN                                                         07030000
               DI:=COMPAREBUFF;                                         07040000
               DS:=8 LIT "CONFIDEN";%1                                  07050000
               DS:=8 LIT "SKIP    ";                                    07060000
               DS:=8 LIT "BEGIN   ";%3                                  07070000
               DS:=8 LIT "END     ";%4                                  07080000
               DS:=8 LIT "SCHEDULE";%5                                  07090000
               DS:=8 LIT "OUTPUT  ";%6                                  07100000
               DS:=8 LIT "ON      ";%7                                  07110000
               DS:=8 LIT "ALL     ";%8                                  07120000
               DS:=8 LIT "TESTS   ";%9                                  07130000
               DS:=8 LIT "TEST    ";%10                                 07140000
               DS:=8 LIT "EXCEPT  ";%11                                 07150000
               DS:=8 LIT "TIMES   ";%12                                 07160000
               DS:=8 LIT "NO      ";%13                                 07170000
               DS:=8 LIT "STOP    ";%14                                 07180000
               DS:=8 LIT "ABREVIAT";%15                                 07190000
               DS:=8 LIT "NOPAGE  ";%16                                 07200000
               DS:=8 LIT "RESULT  ";%17                                 07210000
               DS:=8 LIT "LP      ";%18                                 07220000
               DS:=8 LIT "SPO     ";%19                                 07230000
               DS:=8 LIT "PBD     ";%20                                 07240000
               DS:=8 LIT "PBT     ";%21                                 07250000
               DS:=8 LIT "TWX     ";%22                                 07260000
               DS:=8 LIT "OK      ";%23                                 07270000
               DS:=8 LIT "OCT     ";%24                                 07280000
               DS:=8 LIT "BCL     ";%25                                 07290000
               DS:=8 LIT "INT     ";%26                                 07300000
               DS:=8 LIT "TESTAPE ";%27                                 07310000
               DS:=8 LIT "CONF    ";%1                                  07320000
               DS:=8 LIT "SK      ";%2                                  07330000
               DS:=8 LIT "B       ";%3                                  07340000
               DS:=8 LIT "E       ";%4                                  07350000
               DS:=8 LIT "SCHED   ";%5                                  07360000
               DS:=8 LIT "OUT     ";%6                                  07370000
               DS:=8 LIT "O       ";%7                                  07380000
               DS:=8 LIT "ALL     ";%8                                  07390000
               DS:=8 LIT "TSTS    ";%9                                  07400000
               DS:=8 LIT "T       ";%10                                 07410000
               DS:=8 LIT "X       ";%11                                 07420000
               DS:=8 LIT "TMS     ";%12                                 07430000
               DS:=8 LIT "NO      ";%13                                 07440000
               DS:=8 LIT "ST      ";%14                                 07450000
               DS:=8 LIT "AB      ";%15                                 07460000
               DS:=8 LIT "NOPAGE  ";%16                                 07470000
               DS:=8 LIT "RSLT    ";%17                                 07480000
          END;                                                          07490000
%***********************************************************************07500000
     PROCEDURE FILLUNITS;                                               07510000
          BEGIN                                                         07520000
               FILL UNITS[1,*] WITH                                     07530000
                    OCT100000,                                          07540000
                    OCT300001,                                          07550000
                    OCT500002,                                          07560000
                    OCT700003,                                          07570000
                    OCT1100004,                                         07580000
                    OCT1300005,                                         07590000
                    OCT1500006,                                         07600000
                    OCT1700007,                                         07610000
                    OCT2100010,                                         07620000
                    OCT2300011,                                         07630000
                    OCT2500012,                                         07640000
                    OCT2700013,                                         07650000
                    OCT3100014,                                         07660000
                    OCT3300015,                                         07670000
                    OCT3500016,                                         07680000
                    OCT3700017,                                         07690000
                    OCT600022,                                          07700000
                    OCT1400023;                                         07710000
               FILL UNITS[0,*] WITH                                     07720000
                    "MTA     ",                                         07730000
                    "MTB     ",                                         07740000
                    "MTC     ",                                         07750000
                    "MTD     ",                                         07760000
                    "MTE     ",                                         07770000
                    "MTF     ",                                         07780000
                    "MTH     ",                                         07790000
                    "MTJ     ",                                         07800000
                    "MTK     ",                                         07810000
                    "MTL     ",                                         07820000
                    "MTM     ",                                         07830000
                    "MTN     ",                                         07840000
                    "MTP     ",                                         07850000
                    "MTR     ",                                         07860000
                    "MTS     ",                                         07870000
                    "MTT     ",                                         07880000
                    "DKA     ",                                         07890000
                    "DKB     ";                                         07900000
          END;                                                          07910000
%***********************************************************************07920000
     STREAM PROCEDURE INVKBD(X,INPUTBUFFER,MIX,TWX);                    07930000
          VALUE MIX,TWX;                                                07940000
          BEGIN                                                         07950000
          LOCAL TEMP; LABEL M,N;                                        07960000
               SI:=LOC MIX; DI:=LOC TEMP; DS:=2 DEC;                    07970000
               DI:=DI-2;                                                07980000
               DS:=FILL;                                                07990000
               DI:=X; SI:=LOC TEMP;                                     08000000
               DS:=8 LIT "INV KBD ";                                    08010000
               TWX(JUMP OUT TO N);                                      08020000
               2(IF SC=" " THEN SI:=SI+1 ELSE DS:=CHR);                 08030000
               DS:=2LIT "AX";                                           08040000
          N:                                                            08050000
               SI:=INPUTBUFFER;                                         08060000
          M:   IF SC="~" THEN DS:=CHR ELSE                              08070000
               BEGIN DS:=CHR; GO M; END;                                08080000
          END;                                                          08090000
%***********************************************************************08100000
     REAL STREAM PROCEDURE SCANAWORD(INPUTBUFFER,TESTBUFFER,            08110000
          FIRSTSCAN,LASTSCAN,SPECIALCHR,SAVING,ACCUM);                  08120000
          VALUE SAVING;                                                 08130000
          BEGIN                                                         08140000
          COMMENT  SCANAWORD SCANS INPUTBUFFER BEGINNING AT             08150000
                   FIRSTSCAN - IF EIGHT SUCCESSIVE                      08160000
                   BLANKS ARE THERE ENCOUNTERED, THE PROCEDURE IS       08170000
                   EXITED RETURNING THE VALUE @707070707 - OTHERWISE    08180000
                   THE PROCEDURE EXAMINES THE FIRST NON-BLANK CHR       08190000
                   AND IF IT IS NOT ALPHANUMERIC IT IS STORED IN        08200000
                   SPECIALCHR - IF THE CHARACTER IS                     08210000
                   ALPHANUMERIC, THE PROCEDURE CONTINUES TO SCAN        08220000
                   UNTIL A NON-ALPHA CHARACTER IS ENCOUNTERED -         08230000
                   CHARACTERS SCANNED ARE PLACED IN TESTBUFFER -        08240000
                   UPON ENCOUNTERING A NON-ALPHA CHARACTER, THE         08250000
                   CONTENTS OF TESTBUFFER ARE EXAMINED AND IF           08260000
                   ALL CHARACTERS PLACED THEREIN ARE NUMERIC,           08270000
                   THEY ARE CONVERTED TO AN OCTAL INTEGER AND           08280000
                   STORED IN TESTBUFFER[0] - IN THIS CASE, THE          08290000
                   SIGN OF SCANAWORD IS MADE NEGATIVE - IF A            08300000
                   NON-NUMERIC CHR IS ENCOUNTERED IN TESTBUFFER,        08310000
                   SCANAWORD REMAINS POSITIVE - IN EITHER CASE          08320000
                   SCANAWORD RETURNS THE NUMBER OF CHARACTERS           08330000
                   (EXCLUDING BLANKS) SCANNED;                          08340000
               LOCAL SCANCOUNT,TEMP,LSCAN,FSCAN;                        08350000
               LABEL B,XIT;                                             08360000
                                                                        08370000
               SI:=FIRSTSCAN; DI:=LOC FSCAN; DS:=WDS; SI:=FSCAN;        08380000
               DI:=TESTBUFFER; DS:=16 LIT " ";                          08390000
          B:   IF SC=" " THEN BEGIN SI:=SI+1; GO B; END;                08400000
               IF SC="~" THEN                                           08410000
               BEGIN                                                    08420000
                    DI:=LOC SCANAWORD;                                  08430000
                    DS:=8 LIT "00077777";                               08440000
                    GO XIT;                                             08450000
               END;                                                     08460000
               FSCAN:=SI;                                               08470000
               SAVING(SI:=ACCUM; DI:=LOC LSCAN; DS:=WDS;                08480000
               DI:=LSCAN; SI:=FSCAN;                                    08490000
               IF SC=ALPHA THEN                                         08500000
               BEGIN                                                    08510000
                    DS:=LIT " ";                                        08520000
                    16(IF SC=ALPHA THEN DS:=CHR ELSE JUMP OUT);         08530000
               END ELSE                                                 08540000
               IF SC NEQ "#" THEN                                       08550000
               IF SC NEQ "%" THEN                                       08560000
               DS:=CHR;                                                 08570000
               LSCAN:=DI; SI:=LOC LSCAN; DI:=ACCUM; DS:=WDS;            08580000
               SI:=FSCAN);                                              08590000
               DI:=SPECIALCHR;                                          08600000
               DS:=8 LIT "00000000";                                    08610000
               DI:=DI-1;                                                08620000
               IF SC=ALPHA THEN DI:=TESTBUFFER ELSE                     08630000
               BEGIN                                                    08640000
                    DS:=CHR;                                            08650000
                    LSCAN:=SI;                                          08660000
                    GO XIT;                                             08670000
               END;                                                     08680000
               16(IF SC=ALPHA  THEN                                     08690000
                    BEGIN DS:=CHR; TALLY:=TALLY+1;END ELSE              08700000
                    JUMP OUT);                                          08710000
               LSCAN:=SI;                                               08720000
               SCANAWORD:=TALLY; TALLY:=0;                              08730000
               DI:=LOC TEMP;                                            08740000
               SI:=TESTBUFFER;                                          08750000
               8(IF SC LEQ "Z" THEN IF SC=" " THEN JUMP OUT ELSE        08760000
                    JUMP OUT TO XIT ELSE                                08770000
                    BEGIN DS:=CHR; TALLY:=TALLY+1; END);                08780000
               SI:=LOC SCANCOUNT;                                       08790000
               DI:=TESTBUFFER;                                          08800000
               SI:=LOC TEMP;                                            08810000
               SCANCOUNT:=TALLY;                                        08820000
               DS:=SCANCOUNT OCT;                                       08830000
               DI:=LOC SCANAWORD;                                       08840000
               DS:=LIT "+";                                             08850000
          XIT: SI:=LOC LSCAN; DI:=LASTSCAN; DS:=WDS;                    08860000
               SI:=LOC FSCAN; DI:=FIRSTSCAN; DS:=WDS;                   08870000
          END;                                                          08880000
%***********************************************************************08890000
     REAL STREAM PROCEDURE WHATWORD(TESTBUFFER,COMPAREBUFF,             08900000
          LENGTH); VALUE LENGTH;                                        08910000
          BEGIN                                                         08920000
          LABEL XIT;                                                    08930000
               SI:=TESTBUFFER;                                          08940000
               DI:=COMPAREBUFF;                                         08950000
               LENGTH(IF 8 SC=DC THEN                                   08960000
                    BEGIN WHATWORD:=TALLY; JUMP OUT TO XIT; END         08970000
               ELSE                                                     08980000
                    BEGIN SI:=SI-8; TALLY:=TALLY+1; END);               08990000
               TALLY:=1; WHATWORD:=TALLY;                               09000000
               DI:=LOC WHATWORD; DS:=LIT"+";                            09010000
     XIT: END;                                                          09020000
%***********************************************************************09030000
     DEFINE SCANIT=SCANAWORD(INPUTBUFFER,TESTBUFFER,FIRSTSCAN,          09040000
          LASTSCAN,SPECIALCHR,SAVING,ACCUMULATOR)#,                     09050000
          WORD=WRD(COMPAREBUFF,44) MOD 27+1#;                           09060000
%                                                                       09070000
%***********************************************************************09080000
     STREAM PROCEDURE KRUNCHER(INPUTBUFFER,ACCUMULATOR);                09090000
          BEGIN                                                         09100000
          LOCAL X; LABEL L,IB,T,A,B,XIT;                                09110000
               SI:=ACCUMULATOR; DI:=LOC X; DS:=WDS;                     09120000
               SI:=INPUTBUFFER; DI:=X;                                  09130000
          IB:  IF SC=" " THEN BEGIN SI:=SI+1; GO IB; END;               09140000
          L:   IF SC=ALPHA THEN                                         09150000
          T:   BEGIN DS:=CHR; GO L; END;                                09160000
          A:   IF SC="~" THEN GO XIT ELSE                               09170000
               IF SC=" " THEN                                           09180000
               BEGIN                                                    09190000
                    SI:=SI+1;                                           09200000
          B:        IF SC=" " THEN BEGIN SI:=SI+1; GO B; END            09210000
                    ELSE                                                09220000
                    IF SC=ALPHA THEN                                    09230000
                    BEGIN                                               09240000
                         DS:=LIT " ";                                   09250000
                         GO T;                                          09260000
                    END ELSE GO A;                                      09270000
               END ELSE GO T;                                           09280000
          XIT:                                                          09290000
               DS:=LIT " ";                                             09300000
               X:=DI;                                                   09310000
               DI:=ACCUMULATOR;                                         09320000
               SI:=LOC X;                                               09330000
               DS:=WDS;                                                 09340000
          END;                                                          09350000
%***********************************************************************09360000
     BOOLEAN PROCEDURE TESTSCHEDULER;                                   09370000
          BEGIN                                                         09380000
          INTEGER                                                       09390000
               I,                                                       09400000
               TEST,                                                    09410000
               LASTNUMBER,                                              09420000
               RWORD;                                                   09430000
          LABEL                                                         09440000
               S0,S1,S2,                                                09450000
               W1,W2,W3,W4,W5,W6,W7,W8,                                 09460000
               GOGOGO,                                                  09470000
               SCN,                                                     09480000
               READAGAIN,                                               09490000
               XIT;                                                     09500000
          SWITCH S:=S0,S1,S2;                                           09510000
          SWITCH W:=W1,W2,W3,W4,W5,W6,W7,W8;                            09520000
          BOOLEAN REPEAT,                                               09530000
                  EXCEPT,                                               09540000
                  TIMES,                                                09550000
                  ENUMERATE,                                            09560000
                  SHORT,                                                09570000
                  SPECIAL,                                              09580000
                  NR,                                                   09590000
                  ALL;                                                  09600000
          DEFINE GOERROR(GOERROR1)=                                     09610000
               BEGIN ERROR:=GOERROR1; GO XIT; END#;                     09620000
%                                                                       09630000
               SPECIAL:=TRUE;                                           09640000
               NUMBEROFTESTS:=IF TAPETEST THEN NUMBEROFTAPETESTS        09650000
                    ELSE NUMBEROFDISKTESTS;                             09660000
          SCN:                                                          09670000
               FIRSTSCAN:=LASTSCAN;                                     09680000
               IF ABS(COUNT:=SCANIT) GTR 16 THEN GO READAGAIN;          09690000
               IF SPECIALCHR=""" THEN                                   09700000
               BEGIN CMENT:=NOT CMENT; GO SCN; END ELSE                 09710000
               IF CMENT THEN GO SCN;                                    09720000
               GO TO S[(REAL(SPECIALCHR=0)|                             09730000
                    (1+COUNT.[1:1]))+1];                                09740000
%                                                                       09750000
          S0: %NON ALPHANUMERIC                                         09760000
               IF TIMES THEN GOERROR(11) ELSE                           09770000
               IF REPEAT THEN GOERROR(10);                              09780000
               IF NOT ALL THEN                                          09790000
               SHORT:=FALSE;                                            09800000
               IF SPECIALCHR="|" THEN                                   09810000
               BEGIN                                                    09820000
                    IF SPECIAL THEN GOERROR(12) ELSE                    09830000
                    IF EXCEPT THEN GOERROR(13);                         09840000
                    TIMES:=TRUE; GO SCN                                 09850000
               END ELSE                                                 09860000
               IF SPECIALCHR NEQ ")" THEN                               09870000
               BEGIN                                                    09880000
                    IF REPEAT THEN GOERROR(11) ELSE                     09890000
                    IF SPECIAL THEN GOERROR(12) ELSE                    09900000
                    SPECIAL:=TRUE;  GO SCN;                             09910000
               END ELSE                                                 09920000
               BEGIN%                                                   09930000
                    FOR I:=1 STEP 1 UNTIL NUMBEROFTESTS DO              09940000
                    IF TESTARRAY[I] NEQ 0 THEN GO GOGOGO;               09950000
                    ERROR:=15;                                          09960000
                    GO XIT;                                             09970000
               END;                                                     09980000
          S1: %IDENTIFIER                                               09990000
               IF (RWORD:=WORD GTR 15 OR RWORD LSS 7) OR TIMES          10000000
               OR (REPEAT AND RWORD NEQ 12) THEN GOERROR(16)            10010000
               ELSE GO W[RWORD-7];                                      10020000
          W1: %"ALL"                                                    10030000
               IF ALL OR ENUMERATE OR NOT SPECIAL THEN GOERROR(17);     10040000
               ALL:=TRUE;                                               10050000
               FOR I:=1 STEP 1 UNTIL NUMBEROFTESTS DO                   10060000
                    TESTARRAY[I]:=1;                                    10070000
               GO SCN;                                                  10080000
          W2: %"TESTS"                                                  10090000
               ENUMERATE:=NOT ALL;                                      10100000
               GO SCN;                                                  10110000
          W3: %"TEST"                                                   10120000
               GO SCN;                                                  10130000
          W4: %"EXCEPT"                                                 10140000
               IF EXCEPT  THEN GOERROR(18);                             10150000
               IF NOT ALL THEN GOERROR(13) ELSE                         10160000
               EXCEPT:=TRUE;                                            10170000
               GO SCN;                                                  10180000
          W5: %"TIMES"                                                  10190000
               IF EXCEPT OR NOT REPEAT THEN GOERROR(14);                10200000
               TESTARRAY[TEST]:=TESTARRAY[TEST]|LASTNUMBER;             10210000
               REPEAT:=FALSE;                                           10220000
               GO SCN;                                                  10230000
          W6: %"NO"                                                     10240000
               IF (SPECIAL AND NR) THEN GOERROR(12) ELSE                10250000
               IF SHORT THEN GOERROR(22) ELSE                           10260000
               IF ALL THEN FOR I:=1 STEP 1 UNTIL NUMBEROFTESTS DO       10270000
                    TESTARRAY[I]:=-1                                    10280000
               ELSE%                                                    10290000
               TESTARRAY[TEST]:=-TESTARRAY[TEST];                       10300000
               SHORT:=TRUE;                                             10310000
               GO SCN;                                                  10320000
          W7:  GO XIT;%"STOP"                                           10330000
          W8:%"ABREVIATE"                                               10340000
               IF (SPECIAL AND NR) THEN GOERROR(12) ELSE                10350000
               IF SHORT THEN GOERROR(22);                               10360000
               IF ALL THEN ABREVIATE:=2047 ELSE                         10370000
               ABREVIATE:=ABREVIATE+ENTIER(2*TEST);                     10380000
               SHORT:=TRUE;                                             10390000
               GO SCN;                                                  10400000
          S2: %NUMBER                                                   10410000
               IF (ALL AND NOT EXCEPT) THEN GOERROR(20) ELSE            10420000
               IF REPEAT THEN GOERROR(11) ELSE                          10430000
               ENUMERATE:=NOT ALL;                                      10440000
               NR:=TRUE;                                                10450000
               IF SPECIAL THEN                                          10460000
               BEGIN                                                    10470000
                    IF SHORT THEN GOERROR(21) ELSE                      10480000
                    IF TEST:=TESTBUFFER[0] GTR NUMBEROFTESTS            10490000
                    OR TEST=0 THEN GOERROR(23) ELSE                     10500000
                    IF (TESTARRAY[TEST] NEQ 0 AND NOT                   10510000
                    EXCEPT) THEN GOERROR(9) ELSE                        10520000
                    SPECIAL := FALSE;                                   10530000
                    IF EXCEPT THEN                                      10540000
                    TESTARRAY[TEST]:=0                                  10550000
                    ELSE                                                10560000
                    TESTARRAY[TEST]:=1;                                 10570000
               END                                                      10580000
               ELSE                                                     10590000
               IF TIMES THEN                                            10600000
               BEGIN                                                    10610000
                    TIMES:=FALSE;                                       10620000
                    TESTARRAY[TEST]:=TESTARRAY[TEST]|                   10630000
                         TESTBUFFER[0];                                 10640000
                    GO SCN;                                             10650000
               END ELSE                                                 10660000
               BEGIN                                                    10670000
                    IF EXCEPT THEN GOERROR(24) ELSE                     10680000
                    LASTNUMBER:=TESTBUFFER[0];                          10690000
                    REPEAT:=TRUE;                                       10700000
               END;                                                     10710000
               GO SCN;                                                  10720000
          READAGAIN:                                                    10730000
               CRD:=CRD+1;                                              10740000
               KRUNCHER(INPUTBUFFER,ACCUMULATOR);                       10750000
               READ(INFILE,10,INPUTBUFFER[*]);                          10760000
               FIRSTSCAN:=LASTSCAN:=COREADDR(INPUTBUFFER);              10770000
               GO SCN;                                                  10780000
          GOGOGO:                                                       10790000
               IF TESTARRAY[2] NEQ 0 AND DISKTEST AND SEGS=0 THEN       10800000
               GOERROR(28) ELSE                                         10810000
               TESTSCHEDULER:=TRUE;                                     10820000
          XIT: END;                                                     10830000
%***********************************************************************10840000
     STREAM PROCEDURE ERROUT(OUTBUFFER,COUNT,                           10850000
          FIRSTSCAN,MAINT,COL,ERRBUFF,ERROR);                           10860000
          VALUE COUNT,FIRSTSCAN,MAINT,COL,ERROR;                        10870000
          BEGIN                                                         10880000
               DI:=OUTBUFFER;                                           10890000
               DS:=14 LIT "#MAINT CC ERR(";                             10900000
               SI:=ERRBUFF;                                             10910000
               ERROR(SI:=SI+16);                                        10920000
               16(IF SC="%" THEN                                        10930000
                    BEGIN SI:=SI+1; DS:=LIT """; END                    10940000
               ELSE IF SC="*" THEN JUMP OUT ELSE DS:=CHR);              10950000
               DS:=5 LIT ")CRD ";                                       10960000
               SI:=LOC MAINT; DS:=2 DEC; DS:=LIT ":"; DS:=2 DEC;        10970000
               DS:=LIT "[";                                             10980000
               SI:=FIRSTSCAN; DS:=COUNT CHR;                            10990000
               DS:=LIT "]";                                             11000000
               DS:=LIT "~";                                             11030000
          END;                                                          11050000
%***********************************************************************11060000
     BOOLEAN PROCEDURE TESTADDRESS(ADDR); VALUE ADDR;                   11070000
          INTEGER ADDR;                                                 11080000
          BEGIN                                                         11090000
          REAL I;                                                       11100000
               TESTADDRESS:=(I:=DECMAL(ADDR)).[6:6] GTR 9 OR            11110000
               I.[12:6] GTR 3 OR BOOLEAN(DISKIO(TESTBUFFER,-0,          11120000
               ADDR).[27:1]);                                           11130000
          END;                                                          11140000
%***********************************************************************11150000
     PROCEDURE CLEARAREA;                                               11160000
          BEGIN                                                         11170000
          LABEL TRYCREATE,KBD,XIT;                                      11180000
          REAL BUFF,ADDR,SLEEPER,JUNK;                                  11190000
          FORMAT LOF("SEGS ",I8," TO ",I8," LOCKED OUT",                11200000
                     " (EU ",I2," - SW ",I2,")",                        11210000
                     "~"),                                              11220000
                 NOTAVAILF("NORMAL SEG WRITE TESTS NOT AVAIL",          11230000
                           " WITH SHAREDISK");                          11240000
          FORMAT ALREADY(" TEST AREA ALREADY CLEARED(IN USE BY ",       11250000
                         A6,"/",A1,A6,")");                             11260000
          SWITCH FORMAT AX:=("#SKIP,STOP OR OK",                        11270000
                    "~"),                                               11280000
                            ("SKIP OR STOP","~");                       11290000
          INTEGER I;                                                    11300000
          BOOLEAN SD;                                                   11310000
%***********************************************************************11320000
     BOOLEAN STREAM PROCEDURE CLEARED(BUFF);                            11330000
          BEGIN                                                         11340000
          LOCAL TEMP,TSI;                                               11350000
          LABEL L;                                                      11360000
               SI:=BUFF; IF SC=" " THEN                                 11370000
               BEGIN SI:=SI+1; IF SC="D" THEN TALLY:=1; END ELSE        11380000
               BEGIN                                                    11390000
                    SI:=SI+39; TSI:=SI;                                 11400000
                    DI:=LOC TEMP; DS:=6 LIT "DKTEST";                   11410000
                    DI:=DI-6;                                           11420000
                    IF 6 SC=DC THEN                                     11430000
          L:        BEGIN                                               11440000
                         TEMP:=TALLY;                                   11450000
                         DI:=DI-6; SI:=SI+1;                            11460000
                         IF 7 SC GEQ DC THEN                            11470000
                         BEGIN                                          11480000
                              TALLY:=3; SI:=TSI; DI:=BUFF;              11490000
                              DS:=2 LIT "0"; DS:=6 CHR;                 11500000
                              SI:=SI+1; DS:=LIT "0"; DS:=7 CHR;         11510000
                         END;                                           11520000
                    END ELSE                                            11530000
                    BEGIN                                               11540000
                         DI:=LOC TEMP; DS:=6 LIT "BADISK"; DI:=DI-6;    11550000
                         SI:=TSI; IF 6 SC=DC THEN GO L;                 11560000
                    END;                                                11570000
               END;                                                     11580000
               CLEARED:=TALLY;                                          11590000
          END;                                                          11600000
%***********************************************************************11610000
     STREAM PROCEDURE DEBLANKER(A,B);                                   11620000
          BEGIN LABEL L,BB;                                             11630000
               SI:=A; DI:=B; DS:=CHR;                                   11640000
          L:   IF SC NEQ "~" THEN                                       11650000
               BEGIN                                                    11660000
          BB:       IF SC=" " THEN                                      11670000
                    BEGIN                                               11680000
                         SI:=SI+1;                                      11690000
                         IF SC=" " THEN GO BB;                          11700000
                         IF SC=ALPHA THEN                               11710000
                         BEGIN SI:=SI-1; DS:=CHR; END;                  11720000
                         GO L;                                          11730000
                    END;                                                11740000
                    DS:=CHR; GO L;                                      11750000
               END;                                                     11760000
               DS:=LIT "~";                                             11780000
          END;                                                          11800000
%***********************************************************************11810000
               NOWRT:=WRTLOCK:=FALSE;                                   11820000
               FOR ADDR:=10000|(BEGINADDR DIV 10000) STEP 10000 UNTIL   11830000
               10000|(ENDADDR DIV 10000)+9999 DO                        11840000
               IF BOOLEAN(DISKIO(TESTBUFFER,0,ADDR).[28:1]) THEN        11850000
               BEGIN                                                    11860000
                    WRITE(CFILE,LOF,ADDR,ADDR+9999,                     11870000
                         ADDR DIV 1000000,                              11880000
                    ((I:=(ADDR DIV 10000) MOD 100) MOD 4)+              11890000
                    ((I DIV (4|DKTYPE))|4)+1);                          11900000
                    WRTLOCK:=TRUE;                                      11910000
               END;                                                     11920000
               IF WRTLOCK THEN GO KBD;                                  11930000
               FOR I:=2,8,9,10,11 DO                                    11940000
               IF TESTARRAY[I] NEQ 0 THEN WRTLOCK:=TRUE;                11950000
               IF WRTLOCK THEN WRTLOCK:=FALSE ELSE GO XIT;              11960000
               BUFF:=-(ADDR:=COREADDR(SLEEPER))&COREADDR(INPUTBUFFER[1])11970000
               [15:33:15];                                              11980000
          TRYCREATE:                                                    11990000
               INPUTBUFFER[0]:=BEGINADDR;                               12000000
               INPUTBUFFER[1]:=SEGS+1;                                  12010000
               SLEEPER:=0; DKBUSINESS(BUFF);                            12020000
               IF SD:=SLEEPER=3 THEN                                    12030000
               BEGIN                                                    12040000
                    WRITE(CFILE,NOTAVAILF);                             12050000
                    GO KBD;                                             12060000
               END ELSE                                                 12070000
               BEGIN                                                    12080000
                    DEBLANKER(INPUTBUFFER,OUTBUFFER);                   12090000
                    IF REAL(AREACLEARED:=CLEARED(OUTBUFFER)) LSS 3 THEN 12100000
                    WRITE(CFILE,10,OUTBUFFER[*]) ELSE                   12110000
                    WRITE(CFILE,ALREADY,OUTBUFFER[0],(JUNK:=            12120000
                          OUTBUFFER[1]).[6:6],JUNK);                    12130000
               END;                                                     12140000
               IF NOT AREACLEARED THEN                                  12150000
               BEGIN                                                    12160000
          KBD:                                                          12170000
                    WRITE(CFILE,AX[REAL(WRTLOCK OR SD)]);               12180000
                    READ(CFILE,10,INPUTBUFFER[*]);                      12190000
                    FIRSTSCAN:=LASTSCAN:=COREADDR(INPUTBUFFER);         12200000
                    JUNK:=SCANIT; IF JUNK:=WORD = 14 THEN               12210000
                    GO RETURN1                                          12220000
                    ELSE IF JUNK=2 THEN                                 12230000
                    BEGIN                                               12240000
                         NOWRT:=TRUE;                                   12250000
                         GO XIT;                                        12260000
                    END ELSE IF JUNK NEQ 23 OR WRTLOCK OR SD THEN       12270000
                    BEGIN                                               12280000
                         CLEAR(OUTBUFFER,10);                           12290000
                         INVKBD(OUTBUFFER,INPUTBUFFER,MIX,CSWITCH=0);   12300000
                         WRITE(CFILE,9,OUTBUFFER[*]);                   12310000
                         GO KBD;                                        12320000
                    END;                                                12330000
                    GO TRYCREATE;                                       12340000
               END;                                                     12350000
          XIT: END;                                                     12360000
%***********************************************************************12370000
     BOOLEAN PROCEDURE SAFESCAN;                                        12380000
          COMMENT  USED TO SCAN CONTROL CARDS AND DOLLAR CARDS          12390000
                   SAFESCAN IS TRUE WHEN END OF CARD IS REACHED--       12400000
                   DOES NOT READ THE NEXT CARD;                         12410000
          BEGIN                                                         12420000
               FIRSTSCAN:=LASTSCAN;                                     12430000
               SAFESCAN:=(COUNT:=SCANIT) GTR 16 OR                      12440000
                    (COMPILING AND SPECIALCHR="%");                     12450000
          END;                                                          12460000
%***********************************************************************12470000
     INTEGER PROCEDURE DOLLARCARD;                                      12480000
     BEGIN                                                              12490000
          ARRAY DOLLARWORDS[0:6];                                       12500000
          INTEGER W;                                                    12510000
          LABEL XIT;                                                    12520000
          IF NOT DOLLRE THEN PTOG:=FALSE;                               12540000
          FILL DOLLARWORDS[*] WITH                                      12550000
               "CARD    ",%0                                            12560000
               "TAPE    ",%1                                            12570000
               "DISK    ",%2                                            12580000
               "VOID    ",%3                                            12590000
               "LIST    ",%4                                            12600000
               "NEW     ",%5                                            12610000
               "DEBUGN  ";%6                                            12611000
          COUNT:=SCANIT; %SCAN THE "$"                                  12620000
          IF SAFESCAN THEN GO XIT ELSE                                  12630000
          IF COUNT GTR 0 THEN                                           12640000
               IF W:=WRD(DOLLARWORDS,3+REAL(DOLLRE)) LSS 0 THEN         12650000
                    GO XIT                                              12660000
               ELSE                                                     12670000
          ELSE GO XIT;                                                  12680000
          IF W=3 THEN                                                   12690000
          BEGIN                                                         12700000
               IF SAFESCAN THEN GO XIT ELSE                             12710000
               IF COUNT LSS 0 THEN DOLLARCARD:=TESTBUFFER[0];           12720000
               GO XIT;                                                  12730000
          END;                                                          12740000
          IF NOT DOLLRE THEN                                            12750000
          BEGIN                                                         12760000
               CINSW:=INSWITCH;                                         12770000
               DOLLRE:=TRUE;                                            12780000
               CASE W OF                                                12790000
               BEGIN                                                    12800000
                    BEGIN END;                                          12810000
                    BEGIN INSWITCH:=3; PTOG:=TRUE; END;                 12820000
                    BEGIN INSWITCH:=4; PTOG:=TRUE; END;                 12830000
               END;                                                     12840000
          END;                                                          12850000
          LST:=NTOG:=DEBUGN:=FALSE;                                     12851000
          WHILE NOT SAFESCAN DO                                         12860000
          BEGIN                                                         12870000
               LST:=(W:=WRD(DOLLARWORDS,7)=4) OR LST;                   12880000
               NTOG:=W=5 OR NTOG;                                       12890000
               DEBUGN:=DEBUGN OR W=6;                                   12891000
          END;                                                          12900000
          LST:=LST OR DEBUGN;                                           12901000
     XIT: FIRSTSCAN:=LASTSCAN:=INP; END;                                12910000
%***********************************************************************12910100
     REAL STREAM PROCEDURE TOPIOD(F);                                   12910200
          COMMENT RETURN TOP IOD FOR FILE F;                            12910300
          BEGIN                                                         12910400
               SI:=F;                                                   12910500
               DI:=LOC TOPIOD;                                          12910600
               DS:=WDS;                                                 12910700
               DI:=LOC TOPIOD;                                          12910800
               DS:=RESET;                                               12910900
          END;                                                          12911000
%***********************************************************************12920000
     PROCEDURE GETNEXTCARD(T); INTEGER T;                               12930000
          BEGIN                                                         12940000
          FORMAT SEQF(X72,I8);                                          12950000
          OWN INTEGER TAPESEQ,PATSEQ;                                   12960000
          INTEGER D,E;                                                  12970000
          LIST TS(TAPESEQ),PS(PATSEQ);                                  12980000
          LABEL LOOK, START, EOF,EOF1,EOF2,EOP;                         12990000
     LOOK:                                                              13000000
          IF NOT PTOG THEN GO EOF1 ELSE                                 13010000
          IF REAL(PTOG) LSS 2 THEN                                      13020000
          BEGIN                                                         13030000
               READ(INFILE[NO],SEQF,TS);                                13040000
               IF PATSEQ NEQ 99999999 THEN                              13041000
               READ(PATCH[NO],SEQF,PS);                                 13050000
               PTOG:=BOOLEAN(3);                                        13060000
          END;                                                          13070000
     START:                                                             13080000
          IF TAPESEQ LSS PATSEQ THEN                                    13090000
          BEGIN                                                         13100000
               T:=..63;                                                 13110000
               READ(INFILE,10,INPUTBUFFER[*]);                          13120000
               READ(INFILE[NO],SEQF,TS)[EOF];                           13130000
               IF FALSE THEN                                            13140000
     EOF:           TAPESEQ:=99999999;                                  13150000
          END ELSE                                                      13160000
          BEGIN                                                         13170000
               T:=..23;                                                 13180000
               IF TAPESEQ=PATSEQ THEN                                   13190000
               BEGIN                                                    13200000
                    T:=..51;                                            13210000
                    READ(INFILE); %SKIP OVER THAT CARD                  13220000
                    READ(INFILE[NO],SEQF,TS)[EOF1];                     13230000
                    IF FALSE THEN                                       13240000
     EOF1:          TAPESEQ:=99999999;                                  13250000
               END;                                                     13260000
               READ(PATCH,10,INPUTBUFFER[*]);                           13270000
               IF PATSEQ NEQ 99999999 THEN                              13280000
               BEGIN                                                    13290000
                    READ(PATCH[NO],SEQF,PS)[EOF2];                      13300000
                    IF PATSEQ=99999999 THEN                             13310000
     EOP:                                                               13310500
                    BEGIN                                               13311000
                         READ(PATCH); %READ 9-S CARD                    13312000
                         READ(PATCH[NO])[EOF2]; %ALLOWS CARD            13313000
                                                %READER RELEASE         13314000
                                                %AT END OF PATCH        13315000
                         IF D="*" THEN GO START;                        13315100
                    END;                                                13316000
                    IF FALSE THEN                                       13320000
     EOF2:          BEGIN                                               13330000
                         PATSEQ:=99999999;                              13331000
                         IF PATCHSWITCH=1 THEN   %PATCH FILE ON DISK    13332000
                              CLOSE(PATCH) ELSE                         13333000
                         IF CINSW=2 THEN %IF PATCH & CONTROL            13334000
                                         %FROM CARD READER              13335000
                         BEGIN                                          13336000
                              DONETOG:=TRUE;                            13337000
                              CLOSE(MAINT);                             13338000
                         END;                                           13339000
                    END;                                                13340000
               END;                                                     13342000
               CHARACTERMOVE(1,INP,BL(COREADDR(D)) OR                   13350000
                    BL(..700000));                                      13360000
               IF D="$" THEN                                            13370000
               BEGIN                                                    13380000
                    E:=DOLLARCARD;                                      13390000
                    GO LOOK;                                            13400000
               END ELSE                                                 13410000
               IF D="*" THEN                                            13411000
               BEGIN                                                    13412000
                    PATSEQ:=99999999;                                   13413000
                    GO EOP;                                             13414000
               END;                                                     13415000
          END;                                                          13420000
          IF E GTR MIN(PATSEQ,TAPESEQ) THEN GO START;                   13430000
          TEST:=OCTAL(TOPIOD(INPUTBUFFER[9]));                          13440000
     END;                                                               13450000
%***********************************************************************13460000
   PROCEDURE SCAN; FORWARD;                                             13470000
%***********************************************************************13480000
     PROCEDURE READAGAIN;                                               13490000
          BEGIN                                                         13500000
          LABEL XIT,EOF;                                                13510000
          FORMAT FMT (X105,A1," ",A3);                                  13520000
          INTEGER T;                                                    13530000
               IF NOT COMPILING THEN                                    13540000
               BEGIN                                                    13550000
                    IF SAVING THEN INPUTBUFFER[9]:=REAL(NOT FALSE);     13560000
                    KRUNCHER(INPUTBUFFER,ACCUMULATOR);                  13570000
               END;                                                     13580000
               LASTSCAN:=FIRSTSCAN:=INP;                                13590000
               IF DONESCAN THEN                                         13600000
               READ(INFILE[NO],10,INPUTBUFFER[*])[EOF] ELSE             13610000
               BEGIN                                                    13620000
                    IF COMPILING THEN                                   13630000
                    BEGIN                                               13640000
                         T:=..23;                                       13650000
                         GETNEXTCARD(T);                                13660000
                         IF NTOG THEN WRITE(NEW,10,INPUTBUFFER[*]);     13670000
                         IF LST THEN                                    13680000
                         BEGIN                                          13690000
                         IF NOT HTOG THEN                               13700000
                         BEGIN                                          13710000
                              DATIME;                                   13720000
                              HTOG:=TRUE;                               13730000
                              WRITE(OUTFI[DBL]);                        13740000
                         END;                                           13750000
                         WRITE(OUTBUFFER[*],FMT,T,DECMAL(A));           13760000
                         MOVE(9,INPUTBUFFER,OUTBUFFER[2]);              13770000
                         MOVE(1,INPUTBUFFER[9],OUTBUFFER[12]);          13780000
                         WRITE(OUTFI[DBL],15,OUTBUFFER[*]);             13790000
                         END;                                           13800000
                         MOVE(1,INPUTBUFFER[10],INPUTBUFFER[9]);        13810000
                    END ELSE READ(INFILE,10,INPUTBUFFER[*])[EOF];       13820000
                    CRD:=CRD+1;                                         13830000
               END;                                                     13840000
               SCAN;                                                    13850000
               GO XIT;                                                  13860000
          EOF:  IF DONESCAN THEN MOVE(1,COMPAREBUFF[13],                13870000
               TESTBUFFER) ELSE                                         13880000
               BEGIN                                                    13890000
                    EOFTOG:=TRUE;                                       13900000
                    GO PERROR;                                          13910000
               END;                                                     13920000
          XIT: LINERROR:=FALSE; END;                                    13930000
%***********************************************************************13940000
     PROCEDURE SCAN;                                                    13950000
          BEGIN                                                         13960000
          INTEGER W;                                                    13970000
               FIRSTSCAN:=LASTSCAN;                                     13980000
               IF COUNT:=SCANIT GTR 63 OR                               13990000
               (COMPILING AND SPECIALCHR="%") THEN READAGAIN;           14000000
               IF NOT COMPILING THEN                                    14010000
               IF SPECIALCHR=""" THEN IF CMENT:=NOT CMENT THEN          14020000
               BEGIN                                                    14030000
                    SPECIALCHR:=0;                                      14040000
                    WHILE SPECIALCHR NEQ """ DO SCAN;                   14050000
                    SCAN;                                               14060000
               END;                                                     14070000
               IF COMPILING AND                                         14080000
               (W:=WRD(COMPAREBUFF,17)=16 OR W=13) THEN %END OR ELSE    14090000
               SPECIALCHR:=";";                                         14100000
          END;                                                          14110000
%***********************************************************************14120000
     PROCEDURE FILLXLATEBUFFER;                                         14130000
          BEGIN                                                         14140000
          FILL TRANSLATEBUFFER[*] WITH                                  14150000
               OCT1201020304050607,                                     14160000
               OCT1011131400151617,                                     14170000
               OCT7261626364656667,                                     14180000
               OCT7071737460757677,                                     14190000
               OCT5241424344454647,                                     14200000
               OCT5051535440555657,                                     14210000
               OCT2021222324252627,                                     14220000
               OCT3031333432353637;                                     14230000
          END;                                                          14240000
%***********************************************************************14250000
%***********************************************************************14940000
     PROCEDURE CCSCANR(W,SP,E,D,A); VALUE W,SP,E;                       14950000
          INTEGER W,SP,E,D;                                             14960000
          ARRAY A[*];                                                   14970000
          BEGIN                                                         14980000
               IF SAFESCAN THEN IF E NEQ 0 THEN                         14990000
                    BEGIN                                               15000000
                         COUNT:=SPECIALCHR:=0;                          15010000
                         ERROR:=34;                                     15020000
                         GO PERROR;                                     15030000
                    END                                                 15040000
                    ELSE D:=-1                                          15050000
               ELSE                                                     15060000
               IF SP NEQ 0 THEN                                         15070000
                    IF SPECIALCHR=SP THEN D:=EMPTY ELSE                 15080000
                    GOPERROR(E)                                         15090000
               ELSE                                                     15100000
               IF NT1:=WRD(A,12) NEQ W THEN                             15110000
                    IF E NEQ 0 THEN GOPERROR(E)                         15120000
                    ELSE D:=NT1                                         15130000
               ELSE D:=EMPTY;                                           15140000
          END;                                                          15150000
%***********************************************************************15160000
     INTEGER STREAM PROCEDURE FILEIDENTIFIER(FIRSTSCAN,LASTSCAN,A);     15170000
          BEGIN                                                         15180000
          LABEL L,L1,L2,XIT;                                            15190000
          LOCAL T1,T2;                                                  15200000
          SI:=FIRSTSCAN; DI:=LOC T1; DS:=WDS;                           15210000
          SI:=T1;                                                       15220000
     L:   IF SC=" " THEN BEGIN SI:=SI+1; GO L; END ELSE                 15230000
          IF SC="~" THEN                                                15240000
          BEGIN                                                         15250000
               DI:=LOC FILEIDENTIFIER;                                  15260000
               DS:=8 LIT "00077777";                                    15270000
               GO XIT;                                                  15280000
          END;                                                          15290000
          T1:=SI; SI:=LOC T1; DI:=FIRSTSCAN; DS:=WDS; SI:=T1;           15300000
          IF SC=ALPHA THEN TALLY:=1 ELSE GO XIT;                        15310000
          DI:=A; DS:=16 LIT "0       ";                                 15320000
          DI:=DI-15;                                                    15330000
          7(IF SC=ALPHA THEN DS:=CHR ELSE JUMP OUT);                    15340000
     L1:  IF SC=" " THEN BEGIN SI:=SI+1; GO L1; END ELSE                15350000
          IF SC="/" THEN SI:=SI+1 ELSE GO XIT;                          15360000
     L2:  IF SC=" " THEN BEGIN SI:=SI+1; GO L2; END ELSE                15370000
          IF SC=ALPHA THEN TALLY:=2 ELSE GO XIT;                        15380000
          DI:=A; DI:=DI+9;                                              15390000
          7(IF SC=ALPHA THEN DS:=CHR ELSE JUMP OUT);                    15400000
     XIT:                                                               15410000
          T1:=SI; SI:=LOC T1; DI:=LASTSCAN; DS:=WDS;                    15420000
          FILEIDENTIFIER:=TALLY;                                        15430000
     END;                                                               15440000
%***********************************************************************15450000
     PROCEDURE LABELEQUATER(F,SW,SW1,WW,A); VALUE SW1,WW;               15460000
          FILE F; INTEGER SW,SW1,WW;                                    15470000
          ARRAY A[*];                                                   15480000
          BEGIN                                                         15490000
               ARRAY AA[0:1];                                           15500000
               INTEGER D;                                               15520000
               DEFINE FILEID=FILEIDENTIFIER(FIRSTSCAN,LASTSCAN,         15530000
                    AA)#;                                               15540000
     %                                                                  15550000
               FIRSTSCAN:=LASTSCAN;                                     15560000
               SW:=0;                                                   15580000
               IF NT2:=FILEID=0 THEN GOPERROR(34) ELSE                  15590000
               IF SW1 GTR 0 THEN                                        15600000
               BEGIN                                                    15601000
                    CCSCANR(WW,0,0,D,A);                                15610000
                    IF D=EMPTY THEN SW:=SW1 ELSE LASTSCAN:=FIRSTSCAN;   15620000
               END;                                                     15621000
               FILL F WITH IF BL(NT2) THEN 0 ELSE AA[0],                15630000
                           IF BL(NT2) THEN AA[0] ELSE AA[1];            15631000
          END;                                                          15640000
%***********************************************************************15650000
     PROCEDURE CONTROLCARD;                                             15660000
          BEGIN                                                         15670000
           OWN ARRAY CONTROLWORDS[0:11];                                15680000
          INTEGER D,CCCOUNT;                                            15690000
          ARRAY CCS[0:59];                                              15691000
          LABEL LE,XIT;                                                 15700000
          DEFINE                                                        15710000
            CCSCAN(CCSCAN1,CCSCAN2,CCSCAN3,CCSCAN4)=                    15720000
                CCSCANR(CCSCAN1,CCSCAN2,CCSCAN3,CCSCAN4,                15730000
                CONTROLWORDS)#,                                         15740000
            PRINTCCS=PRINTCCARDS(CCS,CCCOUNT)#,                         15741000
            LABELEQUATE(LABELEQUATE1,LABELEQUATE2,LABELEQUATE3,         15750000
                        LABELEQUATE4)=                                  15760000
            LABELEQUATER(LABELEQUATE1,LABELEQUATE2,LABELEQUATE3,        15770000
                        LABELEQUATE4,CONTROLWORDS)#;                    15780000
          PROCEDURE PRINTCCARDS(CCS,CCCOUNT);                           15781000
               ARRAY CCS[*]; INTEGER CCCOUNT;                           15782000
               BEGIN                                                    15783000
               INTEGER I;                                               15784000
%                                                                       15785000
               FOR I:=0 STEP 1 UNTIL CCCOUNT DO                         15786000
               BEGIN                                                    15787000
                    IF I NEQ 0 THEN                                     15788000
                    MOVE(10,CCS[I|10],CCS);                             15789000
                    WRITE(OUTFI[DBL],10,CCS[*]);                        15790000
               END;                                                     15791000
               CCCOUNT:=0;                                              15792000
               END;                                                     15793000
%                                                                       15794000
          IF CONTROLWORDS[0]=0 THEN                                     15800000
          FILL CONTROLWORDS[*] WITH                                     15810000
               "COMPILE ",                                              15820000
               "TO      ",                                              15830000
               "CONFIDEN",                                              15840000
               "FILE    ",                                              15850000
               "SIMPL   ",                                              15860000
               "CARD    ",                                              15870000
               "DISK    ",                                              15880000
               "TAPE    ",                                              15890000
               "NEWTAPE ",                                              15900000
               "DATA    ",                                              15910000
               "END     ",                                              15920000
               "SERIAL  ";                                              15921000
          CCSCAN(10,0,0,D);                                             15930000
          IF D=EMPTY THEN GO RETURN1 ELSE                               15940000
          IF D NEQ 0 THEN GOPERROR(0);                                  15950000
          IF TWXOUT THEN GOPERROR(8); %"INV OU"-MUST USE LP,PBD,OR PBT  15950100
          MOVE(10,INPUTBUFFER,CCS);                                     15951000
          LABELEQUATE(COEFILE,JUNK,-1,-1);                              15960000
          CCSCAN(1,0,0,D);                                              15970000
          IF D=EMPTY THEN BEGIN CCSCAN(2,0,30,D); CONF:=TRUE; END ELSE  15980000
          IF NOT CONF:=(D=2) THEN GOPERROR(33);                         15990000
     LE:                                                                16000000
          ACCUMULATOR:=COREADDR(JUNKBUFFER);                            16001000
          IF CCCOUNT=5 THEN PRINTCCS;                                   16002000
          READ(INFILE,10,INPUTBUFFER[*]);                               16010000
          MOVE(10,INPUTBUFFER,CCS[(CCCOUNT:=CCCOUNT+1)|10]);            16011000
          FIRSTSCAN:=LASTSCAN:=INP;                                     16020000
          CCSCAN(-2,"*",30,D);                                          16030000
          CCSCAN(-2,0,0,D);                                             16040000
          IF D GEQ 9 THEN GO XIT ELSE                                   16050000
          IF D NEQ 4 THEN GOPERROR(30);                                 16060000
          CCSCAN(3,0,33,D);                                             16070000
          CCSCAN(-2,0,0,D);                                             16080000
          IF D LSS 5 OR D GTR 8 THEN GOPERROR(33) ELSE                  16090000
          BEGIN CCSCAN(3,"=",33,JUNK);                                  16100000
          CASE D-5 OF                                                   16110000
          BEGIN                                                         16120000
               BEGIN %CARD                                              16130000
                    LABELEQUATE(PTCH,PATCHSWITCH,1,6);                  16131000
                    IF PATCHSWITCH=0 THEN                               16132000
                    BEGIN                                               16133000
                         CCSCAN(-2,0,0,D);                              16134000
                         PATCHSWITCH:=REAL(D=11);                       16135000
                    END;                                                16136000
               END;                                                     16137000
               LABELEQUATE(DSK,JUNK,-2,0); %DISK                        16140000
               LABELEQUATE(TAPE,JUNK,-2,0); %TAPE                       16150000
               BEGIN                                                    16151000
               D:=LASTSCAN;                                             16152000
               LABELEQUATE(NEW,NEWSWITCH,1,7); %NEWTAPE                 16160000
               IF NEWSWITCH=1 THEN                                      16161000
               BEGIN LASTSCAN:=D;                                       16162000
               LABELEQUATE(NEW,NEWSWITCH,1,7);                          16163000
               END;                                                     16164000
               END;                                                     16166000
          END;                                                          16170000
          END;                                                          16180000
          GO LE;                                                        16190000
     XIT: IF D=10 AND PATCHSWITCH=0 THEN GOPERROR(33);                  16200000
          COMPILING:=TRUE;                                              16210000
          PRINTCCS;                                                     16211000
          END;                                                          16220000
%***********************************************************************16230000
%***********************************************************************16240000
     PROCEDURE RELEASETHEUNIT(UNIT); VALUE UNIT; INTEGER UNIT;          16250000
          BEGIN                                                         16260000
          IF UNITS[1,UNIT] LSS 0 THEN                                   16270000
               LOCK(TESTAPE,RELEASE);                                   16280000
          UNITS[1,UNIT].[1:1]:=0;                                       16300000
          END;                                                          16310000
%***********************************************************************16320000
     INTEGER STREAM PROCEDURE UNITNAME(U);                              16330000
          BEGIN                                                         16340000
          SI:=U; DI:=LOC UNITNAME; DI:=DI+5; DS:=3 CHR;                 16350000
          END;                                                          16360000
%***********************************************************************16370000
     DEFINE UNAME(UNAME1)=UNITNAME(UNITS[0,UNAME1])#;                   16380000
%***********************************************************************16490000
     BOOLEAN PROCEDURE GETHEUNIT(UNIT,KEY);                             16500000
          VALUE UNIT,KEY;                                               16510000
          INTEGER UNIT;                                                 16520000
          BOOLEAN KEY;                                                  16530000
          BEGIN                                                         16540000
          FORMAT NOTESTAPE("TEST TAPE ON WRONG UNIT(",                  16550000
                           A3," NOT ",A3,")",                           16550100
               "~"),                                                    16560000
                 AX("STOP OR OK~");                                     16560100
          INTEGER U,U1,I;                                               16570000
          ARRAY WORDS[0:1];                                             16571000
          LABEL XIT,PAR,WPAR,AXL;                                       16580000
          IF U:=UNITS[1,UNIT] LSS 0 THEN GO XIT ELSE                    16590000
          IF KEY THEN                                                   16600000
          BEGIN                                                         16610000
               FILL TESTAPE WITH 0,"    "&UNAME(UNIT)[6:30:18],0,*,0,5; 16620000
               WRITE(TESTAPE)[WPAR:WPAR];                               16630000
          END ELSE                                                      16640000
          WHILE TRUE DO                                                 16641000
          BEGIN                                                         16650000
               FILL TESTAPE WITH "ONLINE ","TESTAPE";                   16660000
               READ(TESTAPE)[PAR:PAR];                                  16670000
     PAR:      IF U1:=TOPIOD(TESTAPE).[3:5] NEQ U.[FF] THEN             16680000
               BEGIN                                                    16690000
                    CLOSE(TESTAPE,RELEASE);                             16700000
                    I:=0;                                               16700100
                    WHILE UNITS[1,I].[FF] NEQ U1 DO I:=I+1;             16701100
     AXL:                                                               16702100
                    WRITE(CFILE,NOTESTAPE,UNAME(I),UNAME(UNIT));        16710000
                    WRITE(CFILE,AX);                                    16710200
                    FILL WORDS[*] WITH "STOP    ","SKIP    ";           16710300
                    FIRSTSCAN:=LASTSCAN:=INP;                           16710400
                    READ(CFILE,10,INPUTBUFFER[*]);                      16710450
                    IF COUNT:=SCANIT GTR 16 OR                          16710500
                    W:=WRD(WORDS,2) LSS 0 THEN GO AXL ELSE              16710600
                    IF W=0 THEN                                         16710700
                    BEGIN                                               16710800
                         GETHEUNIT:=TRUE;                               16710900
                         GO TO XIT;                                     16711000
                    END;                                                16711100
                    GETHEUNIT:=TRUE;                                    16720000
                    GO XIT;                                             16730000
               END ELSE GO WPAR;                                        16740000
          END;                                                          16750000
     WPAR:                                                              16760000
          REWIND(TESTAPE);                                              16770000
          TRANS:=0;                                                     16780000
          UNITS[1,UNIT].[1:1]:=1;                                       16790000
     XIT: END;                                                          16800000
%***********************************************************************16810000
     BOOLEAN PROCEDURE CONFSCAN;                                        16820000
          BEGIN                                                         16830000
          INTEGER STREAM PROCEDURE TRUNCATE(BUFFER); VALUE BUFFER;      16840000
               BEGIN LOCAL JUNK,BLANK; LABEL L;                         16841000
                    SI:=LOC BUFFER; SKIP SB; IF SB THEN                 16842000
                    BEGIN TALLY:=1; BLANK:=TALLY; TALLY:=0;END;         16843000
                    SI:=BUFFER;                                         16844000
                    IF SC=ALPHA THEN                                    16845000
               L:   BEGIN                                               16846000
                         SI:=SI-1; IF SC=ALPHA THEN                     16847000
                         BEGIN TALLY:=TALLY+1; GO L; END;               16848000
                         JUNK:=SI; SI:=LOC JUNK; DI:=JUNK;              16849000
                         DI:=DI+1;                                      16850000
                         TRUNCATE:=DI; JUNK:=TALLY;                     16851000
                         BLANK(JUNK(DS:=LIT " "));                      16852000
                    END ELSE TRUNCATE:=SI;                              16853000
               END;                                                     16854000
          DEFINE COMMENTSCAN=BEGIN                                      16855000
                                  WHILE SPECIALCHR NEQ "#" DO SCAN;     16856000
                                  GO ENDSCAN;                           16857000
                             END#;                                      16858000
          DEFINE GOERROR(GOERROR1)=                                     16859000
               BEGIN ERROR:=GOERROR1; GO E; END#;                       16860000
          LABEL ADDRSCAN,                                               16861000
                B,                                                      16862000
                RV,                                                     16863000
                SCHEDULE,                                               16864000
                EADDR,                                                  16865000
               CALLSCHEDULE,                                            16866000
                E,                                                      16867000
                D,                                                      16868000
                D1,                                                     16869000
                P,                                                      16870000
                EOF,                                                    16871000
                ENDSCAN,                                                16872000
                FILLTRAN,                                               16873000
                XIT;                                                    16874000
          BOOLEAN TOGLE,REVR;                                           16875000
          INTEGER SEL1,I;                                               16876000
          REAL IOD,JUNK;                                                16877000
               OP:=XLATE:=FALSE;                                        16878000
               IF REVR:=REV THEN GO RV;                                 16879000
          B:                                                            16880000
               REVR:=FALSE;                                             16881000
               SCAN;                                                    16882000
               IF SPECIALCHR="=" THEN                                   16883000
               BEGIN                                                    16884000
                    LABELEQUATER(UFILE,JUNK,-1,-2,TESTBUFFER);          16885000
                    SCAN;                                               16886000
               END;                                                     16887000
               IF SPECIALCHR NEQ "(" THEN GOERROR(1);                   16888000
               SCAN;                                                    16889000
               IF WORD=3 THEN%"BEGIN"                                   16890000
               BEGIN DISKTEST:=TOGLE:=TRUE; SCAN; END ELSE              16891000
               IF TAPETEST:=COUNT GTR 0 THEN GO CALLSCHEDULE ELSE       16892000
               IF NOT DISKTEST:=COUNT LSS 0 THEN GOERROR(2);            16893000
               IF SEL1:=TESTBUFFER[0] GTR ENDADDR OR SEL1 LSS           16894000
               BEGINADDR OR BEGINADDR=0 THEN                            16895000
               BEGIN                                                    16896000
                    IF TESTADDRESS(BEGINADDR:=SEL1) THEN GOERROR(25);   16897000
                    ENDADDR:=-1;                                        16898000
               END ELSE BEGINADDR:=SEL1;                                16899000
               IF TOGLE THEN GO ADDRSCAN;                               16900000
               SCAN;                                                    16901000
               IF SPECIALCHR NEQ ":" THEN GOERROR(3);                   16902000
               SCAN;                                                    16903000
               IF COUNT GEQ 0 THEN GOERROR(2)                           16904000
               ELSE SEL1:=TESTBUFFER[0]+BEGINADDR-1;                    16905000
          EADDR:                                                        16906000
               IF SEL1 GTR ENDADDR OR SEL1 LSS                          16907000
               BEGINADDR OR ENDADDR=-1 THEN                             16908000
               BEGIN                                                    16909000
                    AREACLEARED:=FALSE;                                 16910000
                    IF TESTADDRESS(ENDADDR:=SEL1) OR                    16911000
                    ENDADDR LSS BEGINADDR OR                            16912000
                    ENDADDR DIV 1000000 NEQ BEGINADDR DIV 1000000       16913000
                    THEN GOERROR(25) ELSE                               16914000
                    SEGS:=ENDADDR-BEGINADDR;                            16915000
               END ELSE ENDADDR:=SEL1;                                  16916000
               GO SCHEDULE;                                             16917000
          ADDRSCAN:                                                     16918000
               TOGLE:=FALSE;                                            16919000
               SCAN;                                                    16920000
               IF SPECIALCHR = ";" THEN SCAN;                           16921000
               IF WORD NEQ 4 THEN GOERROR(4);%"END"                     16922000
               SCAN;                                                    16923000
               IF COUNT GEQ 0 THEN GOERROR(2);                          16924000
               SEL1:=TESTBUFFER[0];                                     16925000
               GO EADDR;                                                16926000
          SCHEDULE:                                                     16927000
               SCAN;                                                    16928000
               IF SPECIALCHR=";" THEN SCAN;                             16929000
          CALLSCHEDULE:                                                 16930000
               IF W:=WORD=5 THEN %SCHEDULE                              16932000
               IF NOT TESTSCHEDULER THEN GO E ELSE ELSE                 16933000
               IF WORD=27 THEN %TESTAPE                                 16934000
               BEGIN                                                    16935000
                    IF NOT TAPETEST THEN GOERROR(5);                    16936000
                    TESTARRAY[0]:=1;                                    16937000
                    SCAN;                                               16938000
                    IF SPECIALCHR NEQ ")" THEN GOERROR(16);             16939000
               END ELSE GOERROR(5);                                     16940000
               IF TAPETEST THEN                                         16941000
               BEGIN                                                    16942000
                    SCAN;                                               16943000
                    IF UNIT:=WRD(UNITS[0,0],16) LSS 0 THEN              16945000
                         GOERROR(29);                                   16946000
               END;                                                     16947000
          D:                                                            16948000
               SCAN;                                                    16949000
          D1:                                                           16950000
               IF REV THEN GO RV;                                       16951000
               IF SPECIALCHR="#" THEN GO ENDSCAN ELSE                   16952000
               IF SPECIALCHR="%" THEN COMMENTSCAN ELSE                  16953000
               IF SPECIALCHR=";" THEN GO D ELSE                         16954000
          RV:                                                           16955000
               IF SEL1:=WORD GEQ 24 AND SEL1 LEQ 26 THEN                16956000
               BEGIN                                                    16957000
                    IF XLATE THEN GOERROR(6) ELSE XLATE:=TRUE;          16958000
                    CASE(SEL1-24) OF                                    16959000
                    BEGIN                                               16960000
                         BEGIN OCTL:=TRUE; BCL:=FALSE; END;             16961000
                         BCL:=OCTL:=TRUE;%BCL                           16962000
                         BCL:=OCTL:=FALSE;%INT                          16963000
                    END;                                                16964000
                    GO D;                                               16965000
               END ELSE                                                 16966000
               IF WORD=6 THEN%"OUTPUT"                                  16967000
               BEGIN                                                    16968000
                    IF OP THEN GOERROR(7) ELSE OP:=TRUE;                16969000
                    SCAN;                                               16970000
                    IF WORD=17 THEN SCAN;%"RESULT"                      16971000
                    IF WORD=7 THEN SCAN;%"ON"                           16972000
                    IF SEL1:=WORD LSS 18 OR SEL1 GTR 22 THEN            16973000
                    %18="LP"                                            16974000
                    %19="SPO"                                           16975000
                    %20="PBD"                                           16976000
                    %21="PBT"                                           16977000
                    %22="TWX"                                           16978000
                    IF SEL1 =16 THEN GO P ELSE                          16979000
                    GOERROR(8) ELSE                                     16980000
                    IF SEL1:=SEL1-18 NEQ OUTSWITCH AND FILEOPENED THEN  16981000
                         BEGIN                                          16982000
                              CLOSE(OUTFI);                             16983000
                              FILEOPENED:=FALSE;                        16984000
                         END;                                           16985000
                    WBUFF:=IF (TWXOUT:=(OUTSWITCH:=SEL1)=1 OR           16986000
                               OUTSWITCH=4) THEN 9 ELSE 15;             16986100
                    SCAN; SEL1:=WORD;                                   16987000
                    IF SEL1=16 THEN                                     16988000
          P:                                                            16989000
                    BEGIN PAGE:=FALSE; GO D; END ELSE                   16990000
                    BEGIN PAGE:=TRUE; GO D1; END;                       16991000
               END;                                                     16992000
               IF REV THEN                                              16993000
               BEGIN                                                    16994000
                    REV:=FALSE;                                         16995000
                    IF COUNT=0 THEN                                     16996000
                         IF SPECIALCHR="#" THEN GO RETURN1              16996100
                         ELSE SCAN;                                     16996200
                    IF SEL1:=WORD = 1 THEN GO B ELSE                    16997000
                    IF SPECIALCHR="#" THEN GO RETURN1;                  16997100
               END;                                                     16998000
               ERROR:=26+REAL(REVR);                                    16999000
          E:                                                            17000000
               BEGINADDR:=ENDADDR:=-1;                                  17001000
               CONFSCAN:=TRUE;                                          17002000
               GO XIT;                                                  17003000
          ENDSCAN:                                                      17004000
               SOP:=SOP OR OP OR XLATE;                                 17004500
               IF OP THEN OP:=FALSE ELSE PAGE:=TRUE;                    17005000
               IF XLATE THEN XLATE:=FALSE ELSE                          17006000
               IF TAPETEST THEN                                         17006100
               BEGIN                                                    17006200
                    OCTL:=TRUE;                                         17006300
                    BCL:=FALSE;                                         17006400
               END ELSE BCL:=OCTL:=TRUE;                                17006500
               IF INSWITCH=2 THEN                                       17007000
               BEGIN                                                    17008000
                    DONESCAN:=TRUE;                                     17009000
                    SCAN;                                               17010000
                    IF WORD=14 THEN                                     17011000
                    BEGIN CLOSE(MAINT); DONETOG:=TRUE; END;             17012000
                    DONESCAN:=FALSE;                                    17013000
               END ELSE                                                 17014000
               KRUNCHER(INPUTBUFFER,ACCUMULATOR);                       17015000
               IF TAPETEST THEN                                         17016000
               BEGIN                                                    17017000
                    IF GETHEUNIT(UNIT,TESTARRAY[0]=1) THEN              17018000
                         GO TO IF DONETOG THEN ALLDONE ELSE RETURN;     17019000
                    GO FILLTRAN;                                        17020000
               END;                                                     17021000
               DKTYPE:=1+DISKIO(TESTBUFFER,-0,BEGINADDR).[28:1];        17022000
               IF NOT AREACLEARED THEN                                  17023000
               FOR IOD:=2,4,5,6,7,8,9,10,11 DO                          17024000
               IF TESTARRAY[IOD] NEQ 0 THEN                             17025000
               BEGIN CLEARAREA; GO FILLTRAN; END;                       17026000
     FILLTRAN:                                                          17027000
               IF BCL AND TRANSLATEBUFFER[0]=0 THEN                     17028000
               FILLXLATEBUFFER;                                         17029000
               WBUFF:=IF (TWXOUT:=(OUTSWITCH=1 OR OUTSWITCH=4)) THEN    17038000
                    9 ELSE 15;                                          17039000
               FILEOPENED:=TRUE;                                        17040000
               DATIME;                                                  17041000
               COUNT:=((ACCUMULATOR.[33:15]-                            17042000
                        (IOD:=COREADDR(JUNKBUFFER[0]))+                 17043000
                        REAL(ACCUMULATOR.[27:6] GTR 1))                 17044000
                        DIV I:=WBUFF);                                  17045000
               FOR SEL1:=0 STEP 1 UNTIL COUNT DO                        17046000
               BEGIN                                                    17047000
                    FUNNYMOVE(I+1,IOD,OUTBUFFER);                       17048000
                    IOD:=TRUNCATE(IOD:=IOD+I);                          17049000
                    JUNK:=TRUNCATE(-COREADDR(OUTBUFFER[I]));            17050000
                    WRITE(OUTFI,WBUFF,OUTBUFFER[*]);                    17051000
               END;                                                     17052000
               WRITE(OUTFI[DBL]);                                       17053000
               WRITE(OUTFI);                                            17054000
     XIT: END;                                                          17055000
%***********************************************************************18400000
INTEGER STREAM PROCEDURE STRINGSCAN(FIRSTSCAN,LASTSCAN,                 18410000
PATTERN,MAX,ETOG,OCTL,SV);                                              18420000
VALUE MAX,OCTL,SV;                                                      18430000
   BEGIN                                                                18440000
   LOCAL TSI,TDI;                                                       18450000
   LABEL XIT,BADOCT,CHECK,SVOCT;                                        18460000
   SI:=FIRSTSCAN; DI:=LOC TSI; DS:=WDS;                                 18470000
   SI:=PATTERN; DI:=LOC TDI; DS:=WDS;                                   18480000
   SI:=TSI; DI:=TDI;                                                    18490000
   IF SC=""" THEN                                                       18500000
      BEGIN SI:=SI+1; TALLY:=1; IF SC=""" THEN                          18510000
         BEGIN DS:=CHR; SV(DS:=LIT """); GO XIT; END ELSE               18520000
         BEGIN                                                          18530000
         TDI:=DI; DI:=ETOG; DS:=8 LIT "00000002"; DI:=TDI;              18540000
         GO XIT;                                                        18550000
         END;                                                           18560000
      END;                                                              18570000
   OCTL(MAX(2(IF SC=""" THEN JUMP OUT 3 TO CHECK ELSE                   18580000
              IF SC LSS "0" THEN                                        18590000
   BADOCT:    BEGIN                                                     18600000
                   TDI:=DI; DI:=ETOG; DS:=8 LIT "00000003";             18610000
                   DI:=TDI; JUMP OUT 3 TO XIT;                          18620000
              END ELSE                                                  18630000
              IF SC="?" THEN GO BADOCT ELSE                             18640000
              BEGIN                                                     18650000
                   SV(DS:=CHR; JUMP OUT TO SVOCT);                      18660000
                   SKIP 3 SB;                                           18670000
                   3(IF SB THEN DS:=SET ELSE DS:=RESET; SKIP SB);       18680000
SVOCT:        END); TALLY:=TALLY+1);                                    18690000
              JUMP OUT TO CHECK);                                       18700000
   MAX(IF SC=""" THEN JUMP OUT ELSE                                     18710000
      BEGIN DS:=CHR; TALLY:=TALLY+1; END);                              18720000
CHECK:                                                                  18730000
   IF SC=""" THEN                                                       18740000
      BEGIN                                                             18750000
      SV(DS:=CHR; JUMP OUT TO XIT);                                     18760000
      SI:=SI+1;                                                         18770000
      END                                                               18780000
   ELSE                                                                 18790000
      BEGIN                                                             18800000
      TDI:=DI; DI:=ETOG; DS:=8 LIT "00000001"; DI:=TDI;                 18810000
      END;                                                              18820000
XIT: STRINGSCAN:=TALLY; TSI:=SI; SI:=LOC TSI;                           18830000
   TDI:=DI; DI:=LASTSCAN; DS:=WDS;                                      18840000
   SI:=LOC TDI; DI:=PATTERN; DS:=WDS;                                   18850000
   END;                                                                 18860000
%***********************************************************************18870000
STREAM PROCEDURE PROPOGATE(P,JUNK,RI,COUNT,RIMODCOUNT);                 18880000
     VALUE RI,COUNT,RIMODCOUNT;                                         18890000
     BEGIN                                                              18900000
     LOCAL T,TRI,TRMC,TC;                                               18910000
     SI:=LOC RI; SI:=SI+6; DI:=LOC TRI; DI:=DI+7; DS:=CHR;              18920000
     SI:=LOC RIMODCOUNT; SI:=SI+6; DI:=LOC TRMC; DI:=DI+7; DS:=CHR;     18930000
     SI:=LOC COUNT; SI:=SI+6; DI:=LOC TC; DI:=DI+7; DS:=CHR;            18940000
     SI:=P; DI:=LOC T; DS:=WDS;                                         18950000
     DI:=JUNK; SI:=T;                                                   18960000
     TC(SI:=SI-32; SI:=SI-32); SI:=SI-COUNT;                            18970000
     TC(DS:=32 CHR; DS:=32 CHR); DS:=COUNT CHR;                         18980000
     SI:=LOC P; DI:=T; SI:=JUNK;                                        18990000
     TRI(2(32(TC(DS:=32 CHR; DS:=32 CHR); DS:=COUNT CHR;                19000000
     TC(SI:=SI-32; SI:=SI-32); SI:=SI-COUNT)));                         19010000
     RI(TC(DS:=32 CHR; DS:=32 CHR); DS:=COUNT CHR;                      19020000
     TC(SI:=SI-32; SI:=SI-32); SI:=SI-COUNT);                           19030000
     TRMC(DS:=32 CHR; DS:=32 CHR);                                      19040000
     DS:=RIMODCOUNT CHR;                                                19050000
     T:=DI; DI:=P; SI:=LOC T; DS:=WDS;                                  19060000
     END;                                                               19070000
%***********************************************************************19080000
STREAM PROCEDURE RIPPLER(P,RI,INCR); VALUE RI,INCR;                     19090000
   BEGIN                                                                19100000
   LOCAL TP,B,TRI;                                                      19110000
%                                                                       19120000
   SI:=LOC RI; SI:=SI+6; DI:=LOC TRI; DI:=DI+7; DS:=CHR;                19130000
   SI:=P; DI:=LOC TP; DS:=WDS;                                          19140000
   SI:=TP; DI:=LOC B; SI:=SI-1; DI:=DI+7; DS:=CHR;                      19150000
   SI:=LOC B; DI:=TP; SI:=SI+7;                                         19160000
   TRI(2(32(TALLY:=B; TALLY:=TALLY+INCR; B:=TALLY; DS:=CHR; SI:=SI-1)));19170000
   RI(TALLY:=B; TALLY:=TALLY+INCR; B:=TALLY; DS:=CHR; SI:=SI-1);        19180000
   TP:=DI; DI:=P; SI:=LOC TP; DS:=WDS;                                  19190000
   END;                                                                 19200000
%***********************************************************************19210000
     PROCEDURE FILLMODIFIERS(COMPAREBUFF);                              19220000
          ARRAY COMPAREBUFF[*];                                         19230000
          FILL COMPAREBUFF[*] WITH                                      19240000
               "UNIT    ",%0                                            19250000
               "BUFFER  ",%1                                            19260000
               "PATTERN ",%2                                            19270000
               "DOUBLE  ",%3                                            19280000
               "SPACE   ",%4                                            19290000
               "PAGE    ",%5                                            19300000
               "TIMES   ",%6                                            19310000
               "WITH    ",%7                                            19320000
               "USING   ",%8                                            19330000
               "BEGIN   ",%9                                            19340000
               "ON      ",%10                                           19350000
               "ERROR   ",%11                                           19360000
               "GO      ",%12                                           19370000
               "ELSE    ",%13                                           19380000
               "NO      ",%14                                           19390000
               "STOP    ",%15                                           19400000
               "END     ",%16                                           19410000
               "RIPPLE  ",%17                                           19420000
               "BKWD    ",%18                                           19430000
               "ALPHA   ",%19                                           19440000
               "BINARY  ",%20                                           19450000
               "INTO    ",%21                                           19460000
               "FROM    ",%22                                           19470000
               "OCT     ",%23                                           19480000
               "PARITY  ",%24                                           19490000
               "TAPEMARK",%25                                           19500000
               "GM      ",%26                                           19510000
               "TAPELABE",%27                                           19520000
               "FROM    ",%28                                           19530000
               "TALLY   ",%29                                           19540000
               "TOGGLE  ",%30                                           19550000
               "TEST    ",%31                                           19560000
               "TRUE    ",%32                                           19570000
               "FALSE   ",%33                                           19580000
               "BOT     ",%34                                           19590000
               "EOT     ",%35                                           19600000
               "THRU    ",%36                                           19610000
               "THEN    ",%37                                           19620000
               "MOD3    ";%38                                           19621000
%***********************************************************************19621005
   INTEGER STREAM PROCEDURE SPECIALMOVE(N,A,B);VALUE N,A,B;             19621100
      BEGIN LOCAL NN;                                                   19621200
      SI:=LOC N; SI:=SI+6; DI:=LOC NN; DI:=DI+7; DS:=CHR;               19621300
      SI:=A; DI:=B; NN(DS:=32 CHR; DS:=32 CHR); DS:=N CHR;              19621400
      SPECIALMOVE:=DI;                                                  19621500
      END;                                                              19621600
%***********************************************************************19629000
%***********************************************************************19630000
BOOLEAN PROCEDURE PATTERNGENERATOR(CHRS,PATBUFF);                       19640000
   VALUE CHRS,PATBUFF; INTEGER CHRS,PATBUFF;                            19650000
   BEGIN                                                                19660000
   INTEGER SL,P,RI,CR,ET,TRI,SIZE;                                      19670000
   INTEGER SST;                                                         19670100
   LABEL PROPED,PROPIT,SIMPLE;                                          19670200
   LABEL BACK,RIPPAT,BJBACK,PROP,LOOK,FINISHEDSCANING,XIT;              19680000
   DEFINE                                                               19690000
      WORD=WRD(COMPAREBUFF,24)#,                                        19700000
      PRINTERROR(PRINTERROR1)=                                          19710000
      BEGIN                                                             19720000
        ERROR:=PRINTERROR1;                                             19730000
        PATTERNGENERATOR:=TRUE;                                         19740000
        GO XIT;                                                         19750000
      END#,                                                             19760000
      OCCTL=23#,                                                        19770000
      RIPLE=17#;                                                        19780000
   BOOLEAN BJ,OCTLL,LNG,MINUS,COMPILING;                                19790000
%                                                                       19800000
   IF NOT COMPILING:=PATBUFF LSS 0 THEN                                 19810000
     CLEER(P:=PATBUFF,((CHRS+7) DIV 8));                                19820000
   SIZE:=((CR:=CHRS)+7)DIV 8;                                           19830000
      WHILE TRUE DO                                                     19840000
BACK:                                                                   19850000
         BEGIN                                                          19860000
         SCAN;                                                          19870000
         IF BJ:=COUNT LSS 0 THEN                                        19880000
      IF RI:=TESTBUFFER[0] GTR CHRS OR RI=0 THEN                        19890000
         PRINTERROR(107) ELSE ELSE                                      19900000
         IF SPECIALCHR=""" THEN RI:=CHRS ELSE                           19910000
         IF WORD=RIPLE THEN                                             19920000
            BEGIN                                                       19930000
            RI:=CHRS;                                                   19940000
            OCTLL:=FALSE;                                               19950000
RIPPAT:                                                                 19960000
            ET:=0;                                                      19970000
            SCAN;                                                       19980000
            IF SPECIALCHR NEQ """ THEN                                  19990000
            IF OCTLL:=WORD=OCCTL THEN GO RIPPAT ELSE                    20000000
            PRINTERROR(108);                                            20010000
            FIRSTSCAN:=LASTSCAN;                                        20020000
            IF NOT COMPILING THEN                                       20030000
            COUNT:=STRINGSCAN(FIRSTSCAN,LASTSCAN,P,1,ET,OCTLL,0);       20040000
            IF SAVING THEN                                              20050000
               BEGIN                                                    20060000
               LASTSCAN:=FIRSTSCAN;                                     20070000
               COUNT:=STRINGSCAN(FIRSTSCAN,LASTSCAN,ACCUMULATOR,        20080000
                  1,ET,OCTLL,1);                                        20090000
               END;                                                     20100000
            IF ET=0 THEN SCAN ELSE PRINTERROR(111);                     20110000
            IF (MINUS:=SPECIALCHR="-") OR SPECIALCHR="+" THEN           20120000
               BEGIN                                                    20130000
               SCAN;                                                    20140000
               IF COUNT LSS 0 THEN                                      20150000
                  IF NT6:=TESTBUFFER[0] GTR 63 THEN PRINTERROR(115)     20160000
                  ELSE SCAN                                             20170000
               ELSE PRINTERROR(115);                                    20180000
               END                                                      20190000
            ELSE NT6:=1;                                                20200000
         IF NOT COMPILING THEN                                          20210000
            RIPPLER(P,RI,IF MINUS THEN 63-NT6 ELSE NT6);                20220000
            GO LOOK;                                                    20230000
            END                                                         20240000
         ELSE IF OCTLL:=WORD=OCCTL THEN GO BACK ELSE                    20250000
         PRINTERROR(108);                                               20260000
         IF BJ THEN                                                     20270000
            BEGIN                                                       20280000
            OCTLL:=BJ:=FALSE;                                           20290000
BJBACK:     SCAN;                                                       20300000
            IF SPECIALCHR NEQ """ THEN                                  20310000
               IF WORD=RIPLE THEN GO RIPPAT                             20320000
               ELSE IF OCTLL:=WORD=OCCTL THEN GO BJBACK ELSE            20330000
               PRINTERROR(108);                                         20340000
            END;                                                        20350000
         TRI:=0;                                                        20360000
         LNG:=FALSE;                                                    20370000
         WHILE TRI LSS RI DO                                            20380000
            BEGIN                                                       20390000
            FIRSTSCAN:=LASTSCAN; ET:=0;                                 20400000
            IF NOT COMPILING THEN                                       20410000
            COUNT:=STRINGSCAN(FIRSTSCAN,LASTSCAN,P,MIN(RI-TRI,63),      20420000
                              ET,OCTLL,0);                              20430000
            IF SAVING THEN                                              20440000
               BEGIN                                                    20450000
               LASTSCAN:=FIRSTSCAN;                                     20460000
               COUNT:=STRINGSCAN(FIRSTSCAN,LASTSCAN,ACCUMULATOR,        20470000
                  MIN(RI-TRI,63),ET,OCTLL,1);                           20480000
               END;                                                     20490000
            IF ET=3 THEN PRINTERROR(115) ELSE                           20500000
            IF ET=2 THEN                                                20510000
               BEGIN                                                    20520000
               SCAN; IF NOT(SPECIALCHR=""" AND LNG) THEN                20530000
               PRINTERROR(111) ELSE GO PROP;                            20540000
               END ELSE                                                 20550000
            IF ET=1 THEN                                                20560000
               IF TRI:=TRI+COUNT GEQ RI THEN PRINTERROR(107)            20570000
               ELSE LNG:=TRUE ELSE                                      20580000
               BEGIN                                                    20590000
PROP:                                                                   20600000
               IF NOT COMPILING THEN                                    20610000
          IF TRI:=TRI+COUNT LSS RI THEN                                 20620000
          BEGIN                                                         20621000
               IF P.[FF]=0 THEN                                         20622000
                    IF TRI MOD 8=0 THEN                                 20623000
                         GO SIMPLE                                      20624000
                    ELSE                                                20625000
               ELSE                                                     20626000
                    IF SST:=((8|P.[CF])+P.[FF]-TRI) = 0 THEN            20627000
                    BEGIN                                               20628000
                         IF TRI LSS 8 THEN                              20629000
                              IF RI GEQ 8|TRI THEN                      20630000
                              BEGIN                                     20631000
                                   JUNK:=0;                             20631100
                                   PROPOGATE(P,JUNK,7,TRI,0);           20632000
                                   IF TRI:=8|TRI=RI THEN GO PROPED;     20633000
                              END                                       20634000
                              ELSE                                      20635000
                             BEGIN                                      20636000
     PROPIT:                                                            20636100
                                   JUNK:=0;                             20636200
                                   IF ET:=(COUNT:=RI-TRI) DIV TRI GTR   20637000
                                        4095 THEN                       20638000
                                   BEGIN PROPOGATE(P,JUNK,4095,TRI,0);  20639000
                                        ET:=ET-4095;                    20640000
                                       JUNK:=0;                         20640500
                                   END;                                 20641000
                                  PROPOGATE(P,JUNK,ET,TRI,              20642000
                                        ENTIER(COUNT MOD TRI));         20643000
                                   GO PROPED;                           20644000
                              END;                                      20645000
     SIMPLE:             VALUEMOVE((RI-TRI) DIV 8,P-TRI DIV 8,P);       20646000
                         P:=P+((RI-TRI) DIV 8);                         20647000
                         IF ET:=(RI-TRI) MOD TRI NEQ 0 THEN             20648000
                         P:=SPECIALMOVE(ET,P-((RI-TRI) DIV 8),P);       20649000
                         GO PROPED;                                     20650000
                    END ELSE                                            20651000
                    IF TRI LSS 8 THEN                                   20653000
                         GO PROPIT                                      20654000
                    ELSE                                                20655000
                    BEGIN                                               20656000
                         IF RI-TRI GTR 4095 THEN                        20657000
                         BEGIN                                          20658000
                              P:=SPECIALMOVE(4095,(SST DIV 8)&          20659000
                                   (ENTIER(SST MOD 8))[CTF],P);         20660000
                              TRI:=TRI+4095;                            20661000
                          END;                                          20662000
                         P:=SPECIALMOVE(RI-TRI,(SST DIV 8)&             20663000
                              (ENTIER(SST MOD 8))[CTF],P);              20664000
                    END;                                                20665000
          END;                                                          20666000
PROPED:                                                                 20670000
               TRI:=RI;                                                 20730000
               END;                                                     20740000
            END;                                                        20750000
         CHRS:=CHRS-RI;                                                 20760000
         SCAN;                                                          20770000
LOOK:                                                                   20780000
         IF SPECIALCHR=0 THEN PRINTERROR(112) ELSE                      20790000
         IF SPECIALCHR=")" THEN GO FINISHEDSCANING;                     20800000
         END;                                                           20810000
FINISHEDSCANING:                                                        20820000
      IF NOT COMPILING THEN                                             20830000
      IF CHRS NEQ 0 THEN                                                20840000
      BEGIN                                                             20850000
      ARRAY J[0:SIZE];                                                  20860000
      ROTATE(PATBUFF,J,CR-CHRS,CHRS);                                   20870000
      END;                                                              20880000
XIT: END;                                                               20890000
%#########SCAN BLOCK CODE STARTS HERE###################################20900000
     RETURN1:                                                           20910000
          IF DONETOG THEN GO ALLDONE;                                   20920000
          INPUTBUFFER[0]:=INPUTBUFFER[10]:=REAL(NOT FALSE);             20930000
          NEWSWITCH:=PATCHSWITCH:=ERROR:=CRD:=ABREVIATE:=0;             20940000
          CLEAR(JUNKBUFFER,60);                                         20950000
          FOR TEST:=NUMBEROFDISKTESTS STEP -1 UNTIL 0 DO                20960000
          TESTARRAY[TEST]:=0;                                           20970000
          INP:=FIRSTSCAN:=LASTSCAN:=COREADDR(INPUTBUFFER);              20980000
          ACCUMULATOR:=COREADDR(JUNKBUFFER);                            20990000
          FILLRESERVED(COMPAREBUFF);                                    21000000
          IF UNITS[1,0]=0 THEN                                          21010000
          FILLUNITS;                                                    21020000
     READIT:                                                            21030000
          CONF:=LST:=COMPILING:=MAKETAPE:=NTOG:=PTOG:=HTOG:=            21040000
          OP:=XLATE:=DONESCAN:=CMENT:=EOFTOG:=REV:=FALSE;               21050000
          PAGE:=TRUE;                                                   21060000
               %TO REINITIALIZE AFTER EXITING TEST BLOCKS%              21070000
          IF INSWITCH NEQ 2 THEN                                        21080000
          WRITE(INFILE,ENTERDATA);                                      21090000
     R1:                                                                21100000
          SCAN;                                                         21110000
          IF COUNT=0 THEN                                               21120000
          IF SPECIALCHR="*" THEN                                        21130000
          GO CONTROL ELSE                                               21140000
          GOPERROR(INVCHR) ELSE                                         21150000
          IF COUNT LSS 0 THEN GOPERROR(INVWRD) ELSE                     21160000
          IF W:=(WRD(COMPAREBUFF,44)MOD 27)+1=1 THEN                    21170000
               GO CONFIDENCE ELSE                                       21180000
          IF REV:=(W=6 OR (W LEQ 26 AND W GEQ 24)) THEN                 21190000
               GO CONFIDENCE ELSE                                       21191000
          IF W=14 THEN GO ALLDONE ELSE                                  21200000
          GOPERROR(INVWRD);                                             21210000
                                                                        21220000
     CONTROL:                                                           21230000
          CONTROLCARD;                                                  21240000
          GO MCCLCOMPILER;                                              21250000
     CONFIDENCE:                                                        21260000
          IF NOT CONFSCAN THEN                                          21270000
          GO TO IF TAPETEST THEN RUNTAPETESTS ELSE RUNDISKTESTS;        21280000
     PERROR:                                                            21310000
          IF EOFTOG THEN                                                21320000
          BEGIN                                                         21330000
               IF CRD=0 THEN GO ALLDONE;                                21331000
               WRITE(CFILE,EOFF);                                       21340000
               GO EXIT;                                                 21350000
          END ELSE                                                      21360000
          IF WORD NEQ 14 THEN                                           21370000
          BEGIN                                                         21380000
               IF ERROR LEQ 29 THEN                                     21400000
               BEGIN                                                    21410000
               FILL JUNKBUFFER[*] WITH                                  21420000
                    "INV 1ST ","WD*     ",                              21430000
                    "NO %(%* ","        ",                              21440000
                    "NO DSK A","DDR*    ",                              21450000
                    "NO %:%* ","        ",                              21460000
                    "NO END* ","        ",                              21470000
                    "NO SCHED","*       ",                              21480000
                    "XTRA TRA","NS*     ",                              21490000
                    "XTRA OU*","        ",                              21500000
                    "INV OU* ","        ",                              21510000
                    "DUP TEST","#*      ",                              21520000
                    "NO %TIME","S%*     ",                              21530000
                    "NO |INT*","        ",                              21540000
                    "NO TEST#","*       ",                              21550000
                    "INV EXCE","PT*     ",                              21560000
                    "INV TIME","S*      ",                              21570000
                    "NO TESTS","*       ",                              21580000
                    "INV SCHE","D*      ",                              21590000
                    "XTRA %AL","L%*     ",                              21600000
                    "XTRA EXC","EPT*    ",                              21610000
                    "NO %ALL%","*       ",                              21620000
                    "NO EXCEP","T*      ",                              21630000
                    "INV %NO%","*       ",                              21640000
                    "XTRA %NO","%*      ",                              21650000
                    "INV TEST","#*      ",                              21660000
                    "NO %,%* ","        ",                              21670000
                    "INV DSK ","ADDR*   ",                              21680000
                    "NO %#%* ","        ",                              21690000
                    "INV REQU","EST*    ",                              21700000
                    "INSUF SE","GS*     ",                              21710000
                    "INV UNIT","*        ";                             21720000
               END ELSE                                                 21730000
               BEGIN                                                    21740000
               ERROR:=ERROR-30;                                         21750000
               FILL JUNKBUFFER[*] WITH                                  21760000
                    "INV CC* ","        ",                              21770000
                    "INV CHR*","        ",                              21780000
                    "NO OU*  ","        ",                              21790000
                    "INV LABE","L EQUAT*",                              21800000
                    "INCOMPLE","TE CC*  ";                              21810000
               END;                                                     21820000
               ERROUT(OUTBUFFER,ABS(COUNT)+                             21830000
                    REAL(SPECIALCHR NEQ 0),FIRSTSCAN,CRD,               21840000
                    8|(FIRSTSCAN.[33:15]-COREADDR(INPUTBUFFER))+        21850000
                    FIRSTSCAN.[27:6]+1,JUNKBUFFER,ERROR);               21860000
               WRITE(CFILE,9,OUTBUFFER[*]);                             21870000
          END;                                                          21880000
          GO TO IF INSWITCH=2 THEN EXIT ELSE RETURN1;                   21890000
     MCCLCOMPILER:                                                      21900000
%##########SIMPL COMPILER BLOCK#########################################21910000
     BEGIN                                                              21920000
%***********************************************************************21930000
     INTEGER                                                            21940000
          THISTEST,                                                     21950000
          NEXTUNIT,                                                     21960000
          NEXTPATTERN,                                                  21970000
          UNIT,                                                         21980000
          U,                                                            21990000
          SIZE,                                                         22000000
          W,                                                            22010000
          NEXTLABEL,                                                    22020000
          P,                                                            22030000
          B,                                                            22040000
          JUNK,                                                         22050000
          CODETOG,                                                      22060000
          SAVEA,                                                        22070000
          NEXTSEG,                                                      22080000
          TIME1;                                                        22090000
%***********************************************************************22100000
     BOOLEAN JUNKB;                                                     22110000
%***********************************************************************22120000
     FORMAT                                                             22130000
          PATSF("NO. PATTERNS = ",I3),                                  22140000
          SUCCESSF("END OF COMPILATION, NO SYNTAX ERRORS"),             22141000
          ERRF("END OF COMPILATION,",I4," SYNTAX ERRORS"),              22142000
          DISKSIZEF("PROG. DISK FILE SIZE = ",I4," SEGS"),              22150000
          EFF("NUMBER OF ERRORS DETECTED=",I4,". COMPILATION TIME=",    22160000
              I5," SECONDS."),                                          22170000
          SEGSIZEF("NO. PGM SEGS = ",I3,"; TOTAL PROG SEG ",            22180000
                   "SIZE = ",I5," WDS");                                22190000
%***********************************************************************22200000
     DEFINE                                                             22210000
          LUNIT=0#,                                                     22220000
          BUFF=1#,                                                      22230000
          PAT=2#,                                                       22240000
          DUBLE=3#,                                                     22250000
          SPCE=4#,                                                      22260000
          WTH=7#,                                                       22270000
          USING=8#,                                                     22280000
          NIGEB=9#,                                                     22290000
          ON=10#,                                                       22300000
          ERR=11#,                                                      22310000
          GOGO=12#,                                                     22320000
          ESLE=13#,                                                     22330000
          NONO=14#,                                                     22340000
          STP=15#,                                                      22350000
          RIPLE=17#,                                                    22360000
          OCCTL=23#,                                                    22370000
          PAR=24#,                                                      22380000
          TPMRK=25#,                                                    22390000
          TLLY=29#,                                                     22400000
          TGLE=30#,                                                     22410000
          TST=31#,                                                      22420000
          EURT=32#,                                                     22430000
          ESLAF=33#,                                                    22440000
          THRU=36#,                                                     22450000
          THN=37#,                                                      22460000
          MOD3=38#,                                                     22461000
          PGE=5#;                                                       22470000
%***********************************************************************22480000
     ARRAY EDOC[0:1,0:511];                                             22490000
%***********************************************************************22500000
     DEFINE                                                             22510000
          NROFRESERVED=20#,                                             22520000
          MAXLABELS=32#,                                                22530000
          LNAMES[LNAMES1]=LAYBELS[0,LNAMES1]#,                          22540000
          LABELS[LABELS1]=LAYBELS[1,LABELS1]#,                          22550000
          PNAMES[PNAMES1]=PATTERNS[1,PNAMES1]#,                         22560000
          BNAMES[BNAMES1]=BUFFERS[1,BNAMES1]#,                          22570000
          WORD=WRD(COMPAREBUFF,NROFMOD)#,                               22580000
          CODE[CODE1]=EDOC[CODETOG,CODE1]#,                             22590000
          MAXLEVELS=9#,                                                 22600000
          NROFMOD=39#;                                                  22610000
%***********************************************************************22620000
     ARRAY                                                              22630000
          UNKNOWNUNITS[0:1,0:17],                                       22640000
          RESERVED[0:NROFRESERVED-1],                                   22650000
          LAYBELS[0:1,0:MAXLABELS-1],                                   22660000
          SEGDICT[0:MAXSEGS-1],                                         22670000
          BUFFERS[0:1,0:MAXBUFFS-1],                                    22680000
          PATTERNS[0:1,0:MAXPATTERNS-1],                                22690000
          UNITABLE[0:1,0:17];                                           22700000
%***********************************************************************22710000
     PROCEDURE PRINTHERROR(ERROR); VALUE ERROR; INTEGER ERROR;          22720000
          BEGIN                                                         22730000
          FORMAT ERRORF(X7,"ERROR NUMBER ",A3,"-");                     22740000
          STREAM PROCEDURE REMOTERRORMESSAGE(OUTBUFF,LINENR,            22750000
               ERROR,FIRSTSCAN,COUNT);                                  22760000
               VALUE ERROR,FIRSTSCAN,COUNT;                             22770000
               BEGIN                                                    22780000
               LOCAL TDI;                                               22790000
                    DI:=OUTBUFF;                                        22800000
                    DS:=10 LIT "NEAR LINE ";                            22810000
                    SI:=LINENR; TDI:=DI; DS:=8 DEC;                     22820000
                    SI:=TDI; DI:=TDI;                                   22830000
                    7(IF SC="0" THEN SI:=SI+1);                         22840000
                    8(IF SC=" " THEN JUMP OUT ELSE DS:=CHR);            22850000
                    DS:=14 LIT " ERROR NUMBER ";                        22860000
                    SI:=LOC ERROR; DS:=3 DEC;                           22870000
                    DS:=3 LIT " - ";                                    22880000
                    SI:=FIRSTSCAN; DS:=COUNT CHR;                       22890000
               END;                                                     22900000
%                                                                       22910000
          IF ERRORS:=ERRORS+1=1 THEN ERRTOG:=TRUE;                      22920000
          IF CSWITCH=0 THEN                                             22930000
          BEGIN                                                         22940000
               CLEAR(OUTBUFFER,10);                                     22950000
               REMOTERRORMESSAGE(OUTBUFFER,TEST,ERROR,FIRSTSCAN,        22960000
                    ABS(COUNT)+REAL(COUNT=0));                          22970000
               WRITE(TWX,10,OUTBUFFER[*]);                              22980000
          END;                                                          22990000
          IF NOT LST THEN                                               23000000
          IF NOT LINERROR THEN                                          23010000
          BEGIN                                                         23020000
               IF NOT HTOG THEN                                         23020100
               BEGIN                                                    23020200
                    DATIME;                                             23020300
                    HTOG:=TRUE;                                         23020400
                    WRITE(OUTFI[DBL]);                                  23020500
               END;                                                     23020600
               CLEAR(OUTBUFFER,WBUFF);                                  23030000
               LINERROR:=TRUE;                                          23040000
               WRITE(OUTFI);                                            23050000
               MOVE(9,INPUTBUFFER,OUTBUFFER);                           23060000
               OUTBUFFER[9]:=DECMAL(TEST);                              23070000
               WRITE(OUTFI[DBL],11,OUTBUFFER[*]);                       23080000
          END;                                                          23090000
          WRITE(OUTBUFFER[*],ERRORF,DECMAL(ERROR));                     23100000
          CHARACTERMOVE(ABS(COUNT)+REAL(COUNT=0),FIRSTSCAN,             23110000
               COREADDR(OUTBUFFER[3]));                                 23120000
          WRITE(OUTFI[DBL],10,OUTBUFFER[*]);                            23140000
          WHILE NOT(SPECIALCHR=";" OR SPECIALCHR="#") DO SCAN;          23170000
          END;                                                          23180000
%***********************************************************************23190000
DEFINE PRINTERROR(PRINTERROR1)=                                         23200000
   BEGIN PRINTHERROR(PRINTERROR1); GO XIT; END#;                        23210000
%***********************************************************************23211000
     STREAM PROCEDURE OCTADES(N,A,B); VALUE N,A,B;                      23212000
          BEGIN                                                         23213000
          SI:=LOC B; SI:=SI-N; N(SKIP 3 SB);                            23214000
          DI:=B;                                                        23215000
          N(DS:=3 RESET; 3(IF SB THEN DS:=SET ELSE DS:=RESET;           23216000
                           SKIP SB));                                   23217000
          END;                                                          23218000
%***********************************************************************23220000
     PROCEDURE DEBUGOUT(I,S,A); VALUE I,S,A; REAL I; INTEGER S,A;       23221000
          BEGIN                                                         23222000
          REAL JUNK;                                                    23223000
               CLEAR(OUTBUFFER,4);                                      23224000
               EDIT(1,I,OUTBUFFER[1],0,1,JUNK,JUNK,0);                  23225000
               OCTADES(3,S,I:=COREADDR(OUTBUFFER));                     23226000
               OCTADES(3,A,BL(I) OR BL(..400000));                      23227000
               WRITE(OUTFI[DBL],4,OUTBUFFER[*]);                        23228000
          END;                                                          23229000
%***********************************************************************23229500
PROCEDURE EMITLITERAL(LITERAL); VALUE LITERAL; REAL LITERAL;            23230000
                                                                        23240000
   BEGIN                                                                23250000
   LABEL XIT;                                                           23260000
   INTEGER JUNK;                                                        23261000
   CODE[A]:=LITERAL;                                                    23270000
   IF DEBUGN THEN                                                       23271000
      DEBUGOUT(LITERAL,S,A);                                            23272000
   IF A:=A+1=SEGSIZE THEN                                               23280000
      IF NOT(LITERAL=63 OR (LITERAL.[42:6]=8 AND S NEQ                  23290000
             LITERAL.[FF])) THEN                                        23300000
         BEGIN                                                          23310000
         PRINTHERROR(500);                                              23320000
         WHILE SPECIALCHR NEQ "#" DO SCAN;                              23330000
         GO FINISHOFF;                                                  23340000
         END;                                                           23350000
XIT: END;                                                               23400000
%***********************************************************************23410000
INTEGER PROCEDURE WHATBUFFER;                                           23420000
   BEGIN                                                                23430000
   INTEGER B;                                                           23440000
   FORMAT BF(X2,A3,"-B");                                               23441000
   LABEL XIT;                                                           23450000
   COMMENT--THIS ROUTINE ASSUMES THAT THE VARIABLE "SIZE" CONTAINS      23460000
            THE LENGTH OF THE SUBJECT BUFFER IN WORDS;                  23470000
   SCAN;                                                                23480000
   IF COUNT LEQ 0 THEN PRINTERROR(200) ELSE                             23490000
   IF B:=WHATWORD(TESTBUFFER,BNAMES[0],NEXTBUFF) LSS 0 THEN             23500000
      BEGIN                                                             23510000
      IF NEXTBUFF=MAXBUFFS THEN PRINTERROR(201) ELSE                    23520000
      MOVE(1,TESTBUFFER,BNAMES[NEXTBUFF]);                              23530000
      B:=NEXTBUFF;                                                      23540000
      IF LST THEN                                                       23541000
         BEGIN                                                          23542000
         OCTADES(3,NEXTBUFF,BL(COREADDR(JUNK)) OR BL(..500000));        23543000
         WRITE(OUTFI[DBL],BF,JUNK);                                     23544000
         END;                                                           23545000
      NEXTBUFF:=NEXTBUFF+1;                                             23550000
      END;                                                              23560000
   BUFFERS[0,B].[SF]:=MAX(SIZE,BUFFERS[0,B].[SF]);                      23570000
   WHATBUFFER:=B;                                                       23580000
XIT: END;                                                               23590000
%***********************************************************************23600000
     PROCEDURE STARTASEGMENT(SEGMENT); VALUE SEGMENT; INTEGER SEGMENT;  23610000
          BEGIN                                                         23620000
          LABEL XIT;                                                    23630000
          FORMAT SEGF(X86,"START OF SEGMENT ",10("*"),I3);              23640000
%                                                                       23650000
          IF CODETOG=1 THEN                                             23660000
          PRINTERROR(900) ELSE                                          23670000
          EMITLITERAL(8&SEGMENT[CTF]);                                  23680000
          SAVEA:=A; A:=0;                                               23690000
          CODETOG:=1;                                                   23700000
          S:=SEGMENT;                                                   23710000
          IF LST THEN                                                   23720000
          WRITE(OUTFI[DBL],SEGF,S);                                     23730000
     XIT: END;                                                          23740000
%***********************************************************************23750000
     PROCEDURE FINISHSEGMENT;                                           23760000
          BEGIN                                                         23770000
          LABEL XIT;                                                    23780000
          FORMAT ESEGF(X79,"SEGMENT",I3," IS",I4," LONG, ",             23790000
                       "NEXT SEGMENT 0");                               23800000
%                                                                       23810000
          IF S=0 THEN PRINTERROR(901) ELSE                              23820000
          EMITLITERAL(8&SAVEA[CTSCF]);                                  23830000
          SEGDICT[S]:=0&SEGNO[CTF]&A[CTSF];                             23840000
          READ SEEK(COEFILE[SEGNO]);                                    23850000
          TRANSFEROUT(A,30,COEFILE,CODE[*]);                            23860000
          SEGNO:=SEGNO+((A+29) DIV 30);                                 23870000
          IF LST THEN                                                   23880000
          WRITE(OUTFI[DBL],ESEGF,S,A);                                  23890000
          CODETOG:=0;                                                   23900000
          A:=SAVEA;                                                     23910000
          S:=0;                                                         23920000
     XIT: END;                                                          23930000
%***********************************************************************23940000
     STREAM PROCEDURE BUILDLABEL(D,MFID,FID,DATE);                      23950000
          VALUE MFID,FID,DATE;                                          23960000
          BEGIN                                                         23970000
          DI:=D;                                                        23980000
          DS:=LIT "("; DS:=LIT """;                                     23990000
          DS:=8 LIT " LABEL  ";                                         24000000
          SI:=LOC MFID;                                                 24010000
          DS:=16 CHR;   %MFID & FID                                     24020000
          DS:=3 LIT "001";     %REEL NR                                 24030000
          SI:=SI+3; DS:=5 CHR;     %CREATION DATE                       24040000
          DS:=2 LIT "01";      %CYCLE NR                                24050000
          DS:=5 LIT "99364";     %PURGE DATE                            24060000
          DS:=LIT "0";     %TAPEMARK END                                24070000
          DS:=5 LIT "00001";     %BLOCKCOUNT                            24080000
          DS:=7 LIT "0000001";   %RECORD COUNT                          24090000
          DS:=LIT "0";           %NOT MEM DUMP TAPE                     24100000
          DS:=5 LIT "0";         %PHYSICAL REEL NR                      24110000
          DS:=LIT "0";           %UNBLOCKED                             24120000
          DS:=5 LIT "00010";     %BUFFER LENGTH                         24130000
          DS:=5 LIT "00010";     %MAX REC SIZE                          24140000
          DS:=3 LIT "0";                                                24150000
          DS:=LIT """;                                                  24160000
          DS:=LIT ")";                                                  24170000
          20(DS:=8 LIT " ");                                            24180000
          DS:=4 LIT " ";                                                24190000
          END;                                                          24200000
%%**********************************************************************24210000
INTEGER PROCEDURE WHATPATTERN(TYPE); VALUE TYPE; INTEGER TYPE;          24220000
   BEGIN                                                                24230000
   DEFINE KNOWN=TYPE=1#,                                                24240000
          INPUTPATTERN=TYPE=2#;                                         24250000
   BOOLEAN SAVEPATTERN,NOPATTERN,LTOG;                                  24260000
   LABEL XIT,WRAP;                                                      24270000
   INTEGER CHRS,SL,P,SIZE,RI,CR,ET,TRI,OLDCRD;                          24280000
   FORMAT PF(X2,A3,"-P");                                               24290000
   %                                                                    24300000
   SCAN;                                                                24310000
   IF KNOWN THEN                                                        24320000
      BEGIN                                                             24330000
      IF (WHATPATTERN:=WHATWORD(TESTBUFFER,PNAMES[0],                   24340000
         NEXTPATTERN)) LSS 0 THEN                                       24350000
         BEGIN                                                          24360000
            WHATPATTERN:=0;                                             24370000
            PRINTERROR(100);                                            24380000
         END;                                                           24390000
      END ELSE                                                          24400000
      BEGIN                                                             24410000
      IF COUNT=0 THEN PRINTERROR(101) ELSE                              24420000
      IF SAVEPATTERN:=COUNT GTR 0 THEN                                  24430000
         BEGIN                                                          24440000
         IF WHATPATTERN:=WHATWORD(TESTBUFFER,PNAMES[0],NEXTPATTERN)     24450000
            GEQ 0 THEN GO XIT ELSE                                      24460000
         IF WORD=27 THEN                                                24470000
            BEGIN                                                       24480000
            CLEAR(JUNKBUFFER,60);                                       24490000
            BUILDLABEL(JUNKBUFFER,"ONLINE ","TESTAPE","71146");         24500000
            LTOG:=TRUE;                                                 24510000
            END;                                                        24520000
         IF NEXTPATTERN=MAXPATTERNS THEN PRINTERROR(103) ELSE           24530000
         MOVE(1,TESTBUFFER,PNAMES[NEXTPATTERN]);                        24540000
         WHATPATTERN:=NEXTPATTERN;                                      24550000
         IF LTOG THEN                                                   24560000
            BEGIN CHRS:=72; ACCUMULATOR:=0; SIZE:=9; GO WRAP; END;      24570000
         SCAN;                                                          24580000
         IF COUNT GEQ 0 THEN PRINTERROR(101);                           24590000
         END ELSE                                                       24600000
      IF INPUTPATTERN THEN PRINTERROR(114);                             24610000
      ACCUMULATOR:=COREADDR(JUNKBUFFER);                                24620000
      CLEAR(JUNKBUFFER,(60));                                           24630000
      JUNKBUFFER[59]:=REAL(NOT FALSE);                                  24640000
      IF SIZE:=((CHRS:=TESTBUFFER[0])+7) DIV 8 GTR 1021 THEN            24650000
         PRINTERROR(105) ELSE SAVING:=TRUE;;                            24660000
         SCAN;                                                          24670000
      IF NOPATTERN:=SPECIALCHR NEQ "(" THEN                             24680000
         IF SAVEPATTERN AND NOT INPUTPATTERN THEN                       24690000
            PRINTERROR(106) ELSE                                        24700000
         ELSE                                                           24710000
      IF INPUTPATTERN THEN PRINTERROR(113) ELSE                         24720000
         BEGIN                                                          24730000
         OLDCRD:=CRD;                                                   24740000
         IF PATTERNGENERATOR(CHRS,-1) THEN                              24750000
         PRINTERROR(ERROR);                                             24760000
         SAVING:=FALSE;                                                 24770000
         END;                                                           24780000
         IF INPUTPATTERN OR NOT NOPATTERN THEN                          24790000
         BEGIN                                                          24800000
WRAP:                                                                   24810000
         IF NOT SAVEPATTERN THEN                                        24820000
            BEGIN                                                       24830000
            PNAMES[NEXTPATTERN]:=                                       24840000
               IF NEXTPATTERN LSS 10 THEN                               24850000
                  0&DECMAL(NEXTPATTERN)[1:43:5]&" "[6:42:6] ELSE        24860000
                  0&DECMAL(NEXTPATTERN)[1:37:11]&" "[12:42:6];          24870000
               WHATPATTERN:=NEXTPATTERN;                                24880000
            END;                                                        24890000
         IF INPUTPATTERN THEN                                           24900000
            PATTERNS[0,NEXTPATTERN]:=CHRS&SEGNO[CTF]&SIZE[CTSF] ELSE    24910000
               BEGIN                                                    24920000
               IF ACCUMULATOR.[CF] GTR COREADDR(JUNKBUFFER[29]) THEN    24930000
                  PRINTERROR(117) ELSE                                  24940000
               PATTERNS[0,NEXTPATTERN]:=                                24950000
                  CHRS&SEGNO[CTF]&SIZE[CTSF];                           24960000
               WRITE(COEFILE,30,JUNKBUFFER[*]);                         24970000
               END;                                                     24980000
         IF LST THEN                                                    24990000
            BEGIN                                                       25000000
            OCTADES(3,NEXTPATTERN,COREADDR(ET));                        25001000
            WRITE(OUTFI[DBL],PF,ET.[1:17]);                             25002000
            END;                                                        25003000
         NEXTPATTERN:=NEXTPATTERN+1;                                    25010000
         SEGNO:=SEGNO+1;                                                25020000
         END ELSE                                                       25030000
         IF TYPE LSS 0 THEN WHATPATTERN:=-CHRS                          25040000
         ELSE                                                           25050000
         PRINTERROR(106);                                               25060000
         END;                                                           25070000
XIT: SAVING:=FALSE; END;                                                25080000
%***********************************************************************25081000
DEFINE                                                                  25082000
   EMIT(EMIT1,EMIT2,EMIT3,EMIT4)=                                       25083000
   EMITLITERAL(EMIT1&EMIT2[CTSCF]&EMIT3[CTF]&EMIT4[1:47:1])#;           25084000
%***********************************************************************25090000
REAL PROCEDURE WHATLABEL(KEY); VALUE KEY; INTEGER KEY;                  25100000
   BEGIN                                                                25110000
   INTEGER L;                                                           25120000
   LABEL XIT;                                                           25130000
   SCAN;                                                                25140000
   CASE KEY OF                                                          25150000
      BEGIN                                                             25160000
      IF WORD=TST THEN                                                  25170000
         WHATLABEL:=12 ELSE                                             25180000
      BEGIN                                                             25181000
      IF LEVELCOUNT NEQ 0 THEN EMIT(10,LEVELCOUNT,0,1);                 25182000
      IF L:=WRD(LNAMES[0],NEXTLABEL) GEQ 0 THEN                         25190000
         IF NT1:=LABELS[L] LSS 0 THEN                                   25200000
            WHATLABEL:=8&NT1[27:3:15]                                   25210000
         ELSE                                                           25220000
            BEGIN                                                       25230000
            WHATLABEL:=NT1.[18:30];                                     25240000
            LABELS[L]:=LABELS[L]&A[CTC]&S[CTF];                         25250000
         END                                                            25260000
      ELSE                                                              25270000
         BEGIN                                                          25280000
         IF NEXTLABEL=MAXLABELS THEN PRINTERROR(812) ELSE               25290000
         WHATLABEL:=..7777777777;                                       25300000
         LABELS[NEXTLABEL]:=A&S[CTF];                                   25310000
         MOVE(1,TESTBUFFER,LNAMES[NEXTLABEL]);                          25320000
         NEXTLABEL:=NEXTLABEL+1;                                        25330000
         END;                                                           25340000
      END;                                                              25341000
      IF L:=WRD(LNAMES[0],NEXTLABEL) GEQ 0 THEN                         25350000
         BEGIN                                                          25360000
         IF NT1:=LABELS[L] LSS 0 THEN PRINTERROR(813) ELSE              25370000
         LABELS[L]:=-LABELS[L]&(A&S[33:42:6])[CTHF];                    25380000
         END                                                            25390000
      ELSE                                                              25400000
         BEGIN                                                          25410000
         IF NEXTLABEL=MAXLABELS THEN PRINTERROR(812) ELSE               25420000
         LABELS[NEXTLABEL]:=-..7777777777&S[3:42:6]&A[9:39:9];          25430000
         MOVE(1,TESTBUFFER,LNAMES[NEXTLABEL]);                          25440000
         NEXTLABEL:=NEXTLABEL+1;                                        25450000
         END;                                                           25460000
      END;                                                              25470000
XIT: END;                                                               25480000
%***********************************************************************25530000
     PROCEDURE STATEMENT; FORWARD;                                      25540000
%***********************************************************************25550000
     PROCEDURE COMPOUNDSTATEMENT;                                       25560000
          BEGIN                                                         25570000
          LABEL XIT;                                                    25580000
          SCAN; %WORD PREVIOUSLY IN TESTBUFFER WAS "BEGIN"              25590000
          WHILE TRUE DO                                                 25600000
          BEGIN                                                         25610000
               STATEMENT;                                               25620000
               IF WRD(RESERVED,NROFRESERVED)=7 THEN GO XIT ELSE         25630000
               IF COUNT NEQ 0 THEN PRINTHERROR(119);                    25640000
               SCAN;                                                    25650000
          END;                                                          25660000
     XIT: SCAN; END;                                                    25670000
%***********************************************************************25680000
     PROCEDURE RECALLSEGMENT(SEGMENT); VALUE SEGMENT; INTEGER SEGMENT;  25690000
          BEGIN                                                         25700000
               READ SEEK(COEFILE[SEGDICT[SEGMENT].[FF]]);               25710000
               TRANSFERIN(SEGDICT[SEGMENT].[SF],30,COEFILE,EDOC[1,*]);  25720000
          END;                                                          25730000
%***********************************************************************25740000
     PROCEDURE RETURNSEGMENT(SEGMENT); VALUE SEGMENT; INTEGER SEGMENT;  25750000
          BEGIN                                                         25760000
               READ SEEK(COEFILE[SEGDICT[SEGMENT].[FF]]);               25770000
               TRANSFEROUT(SEGDICT[SEGMENT].[SF],30,COEFILE,EDOC[1,*]); 25780000
               READ SEEK(COEFILE[SEGNO]);                               25790000
          END;                                                          25800000
%***********************************************************************25810000
     PROCEDURE CONDITIONALSTATEMENT;                                    25820000
          BEGIN                                                         25830000
          INTEGER A1,A2;                                                25840000
          LABEL XIT;                                                    25850000
          %                                                             25860000
          A1:=A; EMITLITERAL(0);                                        25870000
          SCAN;                                                         25880000
          STATEMENT;                                                    25890000
          IF WORD=ESLE THEN                                             25900000
          BEGIN                                                         25910000
               A2:=A; EMITLITERAL(0);                                   25920000
               CODE[A1]:=8&A[CTSCF]&S[CTF];                             25930000
               IF DEBUGN THEN DEBUGOUT(CODE[A1],S,A1);                  25931000
               A1:=A2;                                                  25940000
               SCAN;                                                    25950000
               STATEMENT;                                               25960000
          END;                                                          25970000
          CODE[A1]:=8&A[CTSCF]&S[CTF];                                  25980000
          IF DEBUGN THEN DEBUGOUT(CODE[A1],S,A1);                       25981000
     XIT: END;                                                          25990000
%***********************************************************************26000000
     PROCEDURE DOLOOP;                                                  26010000
          BEGIN                                                         26020000
          INTEGER A1;                                                   26030000
          LABEL XIT;                                                    26040000
               IF LEVELCOUNT:=LEVELCOUNT+1=MAXLEVELS THEN               26050000
               PRINTERROR(3) ELSE                                       26060000
               IF LEVELCOUNT=1 THEN                                     26070000
               STARTASEGMENT(NEXTSEG:=NEXTSEG+1);                       26080000
               EMITLITERAL(..100);                                      26090000
               A1:=A;                                                   26100000
               SCAN;                                                    26110000
               STATEMENT;                                               26120000
               IF BOOLEAN(NT2:=REAL(SPECIALCHR="*")) THEN               26130000
               BEGIN                                                    26140000
                    IF LEVELCOUNT NEQ 1 THEN PRINTERROR(4);             26150000
                    TESTBUFFER[0]:=0;                                   26160000
               END ELSE                                                 26170000
               IF COUNT GEQ 0 THEN PRINTERROR(4);                       26180000
               BEGIN                                                    26190000
                    CODE[A1-1].[FF]:=A;                                 26200000
                    IF DEBUGN THEN DEBUGOUT(CODE[A1-1],S,A1-1);         26201000
                    IF NT1:=TESTBUFFER[0] GEQ 512 THEN                  26210000
                    PRINTERROR(5) ELSE SCAN;                            26220000
                    IF WORD=6 THEN EMIT(3,NT1,A1,NT2) ELSE              26230000
                     PRINTERROR(6);                                     26240000
               END;                                                     26250000
               IF LEVELCOUNT:=LEVELCOUNT-1=0 THEN                       26260000
               FINISHSEGMENT;                                           26270000
     XIT: END;                                                          26280000
%***********************************************************************26290000
     PROCEDURE IOSTATEMENT(TYPE); VALUE TYPE; INTEGER TYPE;             26300000
          BEGIN                                                         26310000
          COMMENT                                                       26320000
               TYPE=1     READ                                          26330000
               TYPE=2     WRITE                                         26340000
               TYPE=3     SPACE                                         26350000
               TYPE=4     ERASE                                         26360000
               TYPE=5     REWIND                                        26370000
               TYPE=6     BACKSPACE                                     26380000
          ;                                                             26390000
          DEFINE                                                        26400000
               BKWD=18#,                                                26410000
               ALFA=19#,                                                26420000
               BNRY=20#,                                                26430000
               INTO=21#,                                                26440000
               FROM=22#,                                                26450000
               BOT=34#,                                                 26460000
               EOT=35#,                                                 26470000
               THRU=36#,                                                26480000
               GM=26#;                                                  26490000
          INTEGER PROCEDURE WHATUNIT;                                   26500000
               BEGIN                                                    26510000
               SCAN;                                                    26520000
               IF U:=WRD(UNITABLE[0,0],NEXTUNIT) GEQ 0 THEN             26530000
                    WHATUNIT:=U ELSE                                    26540000
               IF U:=WRD(UNITS[0,0],16) GEQ 0 THEN                      26550000
               BEGIN                                                    26560000
                    MOVE(1,UNITS[0,U],UNITABLE[0,NEXTUNIT]);            26570000
                    UNITABLE[1,NEXTUNIT]:=UNITS[1,U];                   26580000
                    WHATUNIT:=NEXTUNIT;                                 26590000
                    NEXTUNIT:=NEXTUNIT+1;                               26600000
               END ELSE                                                 26610000
               WHATUNIT:=-1;                                            26620000
               END;                                                     26630000
          REAL IOD,IOD1;                                                26640000
          LABEL S1,S2,S2A,S3,S4,S5,S6,E,EMITIO,XIT,FINDREADMODIFIERS;   26650000
          LABEL E1;                                                     26660000
          SWITCH IOSW:=S1,S2,S3,S4,S5,S6;                               26670000
          %                                                             26680000
          IOD:=..500000013&(U:=WHATUNIT)[3:3:5];                        26690000
          IF U LSS 0 THEN PRINTERROR(771);                              26700000
          IOD1:=TYPE&..77777777[18:24:24];                              26710000
          SIZE:=0;                                                      26720000
          SCAN;                                                         26730000
          GO IOSW[TYPE];                                                26740000
     S1: %READ                                                          26750000
          IOD.[24:1]:=1;                                                26760000
          IF W:=WORD=PAT THEN                                           26770000
          BEGIN                                                         26780000
               IOD.[SF]:=SIZE:=IF P:=WHATPATTERN(-1) LSS 0 THEN         26790000
                             ((ABS(P)+7) DIV 8) ELSE                    26800000
                              PATTERNS[0,P].[SF];                       26810000
               IF P GEQ 0 THEN                                          26820000
               BEGIN                                                    26830000
                    SCAN; IOD1.[FF]:=P;                                 26840000
                    IF WORD=THRU THEN                                   26850000
                    BEGIN                                               26860000
                         SCAN;                                          26870000
                         IF WORD=TLLY THEN                              26880000
                         BEGIN                                          26890000
                              IOD.[SF]:=1023; SIZE:=1020;               26900000
                         END ELSE                                       26910000
                         IF COUNT GEQ 0 THEN PRINTERROR(780) ELSE       26920000
                         IF NT1:=TESTBUFFER[0] DIV 8 GTR SIZE THEN      26930000
                              PRINTERROR(781) ELSE                      26940000
                         IOD.[SF]:=NT1;                                 26950000
                         SCAN;                                          26960000
                    END;                                                26970000
               END ELSE                                                 26980000
               IOD1.[SF]:=ENTIER(ABS(P) MOD 8);                         26990000
               W:=IF COUNT GTR 0 THEN WORD ELSE -1;                     27000000
          END ELSE                                                      27010000
          IF W=TPMRK THEN                                               27020000
          BEGIN                                                         27030000
               IOD.[27:2]:=3;                                           27040000
               IOD.[SF]:=SIZE:=1020;                                    27050000
               SCAN;                                                    27060000
               W:=IF COUNT GTR 0 THEN WORD ELSE -1;                     27070000
          END ELSE                                                      27080000
          IF (JUNKB:=W=BOT) OR W=EOT THEN                               27090000
          BEGIN                                                         27100000
               IOD.[27:1]:=1; IOD.[29:1]:=1; IOD.[22:1]:=REAL(JUNKB);   27110000
               SCAN;                                                    27120000
               W:=IF COUNT GTR 0 THEN WORD ELSE -1;                     27130000
          END ELSE                                                      27140000
          IOD.[SF]:=SIZE:=1020;                                         27150000
     FINDREADMODIFIERS:                                                 27160000
          IF SPECIALCHR NEQ 0 OR COUNT LSS 0 THEN                       27170000
               IF IOD1.[FF] NEQ EMPTY AND IOD1.[SCF]=..777 THEN         27180000
                    PRINTERROR(773)                                     27190000
               ELSE GO EMITIO                                           27200000
          ELSE                                                          27210000
          IF W=BKWD THEN IOD.[22:1]:=1 ELSE                             27220000
          IF W=ALFA THEN                                                27230000
          BEGIN                                                         27240000
               IOD.[21:1]:=0;                                           27250000
               IF BL(IOD.[27:1]) THEN IOD.[28:1]:=0;                    27260000
          END ELSE                                                      27270000
          IF W=BNRY THEN ELSE                                           27280000
          IF W=INTO THEN                                                27290000
          BEGIN                                                         27300000
               IF IOD1.[SCF] LSS ..777 THEN                             27310000
                    PRINTERROR(751) ELSE SCAN;                          27320000
               IF WORD=BUFF THEN IOD1.[SCF]:=WHATBUFFER ELSE            27330000
               PRINTERROR(777);                                         27340000
          END ELSE                                                      27350000
          IF WORD=PAR THEN IOD.[28:1]:=1 ELSE                           27360000
          IF W=ON THEN                                                  27370000
               IF IOD1.[FF] NEQ EMPTY AND IOD1.[SCF]=..777 THEN         27380000
                    PRINTERROR(773)                                     27390000
               ELSE GO E                                                27400000
          ELSE PRINTERROR(759);                                         27410000
          SCAN; W:=WORD; GO FINDREADMODIFIERS;                          27420000
     S2:  %WRITE                                                        27430000
          MAKETAPE:=TRUE;                                               27440000
          IF W:=WORD=FROM THEN                                          27450000
          BEGIN                                                         27460000
     S2A:                                                               27470000
               SCAN;                                                    27480000
               IF WORD=BUFF THEN B:=WHATBUFFER ELSE PRINTERROR(753);    27490000
               IF IOD.[FF]=EMPTY AND SIZE=0 THEN                        27500000
                    IOD.[SF]:=BUFFERS[0,B].[SF];                        27510000
               IOD1.[SCF]:=B;                                           27520000
               SCAN;                                                    27530000
          END ELSE                                                      27540000
          IF W=PAT THEN                                                 27550000
          BEGIN                                                         27560000
               IOD.[SF]:=SIZE:=IF P:=WHATPATTERN(-1) LSS 0 THEN         27570000
                    ((ABS(P)+7) DIV 8) ELSE PATTERNS[0,P].[SF];         27580000
               IF P GEQ 0 THEN                                          27590000
               BEGIN                                                    27600000
                    SCAN; IOD1.[FF]:=P;                                 27610000
                    IF WORD=THRU THEN                                   27620000
                    BEGIN                                               27630000
                         SCAN;                                          27640000
                         IF WORD=TLLY THEN                              27650000
                         BEGIN IOD.[SF]:=1023; SIZE:=1020; END ELSE     27660000
                         IF COUNT GEQ 0 THEN PRINTERROR(780) ELSE       27670000
                         IF NT1:=TESTBUFFER[0] DIV 8 GTR SIZE THEN      27680000
                              PRINTERROR(781) ELSE                      27690000
                         IOD.[SF]:=NT1;                                 27700000
                         SCAN;                                          27710000
                    END;                                                27720000
               END ELSE                                                 27730000
               IOD1.[SF]:=ENTIER(ABS(P) MOD 8);                         27740000
               IF W:=WORD=FROM THEN GO S2A;                             27750000
          END ELSE                                                      27760000
          IF W=TPMRK THEN                                               27770000
          BEGIN                                                         27780000
               SCAN;                                                    27790000
               IOD:=IOD&..40[CTF];                                      27800000
          END ELSE PRINTERROR(754);                                     27810000
          IF W:=WORD=BNRY THEN SCAN ELSE                                27820000
          IF W=ALFA THEN                                                27830000
          BEGIN                                                         27840000
               SCAN; IOD.[21:1]:=0;                                     27850000
               IF WORD=GM THEN                                          27860000
               BEGIN                                                    27870000
                    IOD.[23:1]:=0;                                      27880000
                    SCAN;                                               27890000
               END;                                                     27900000
          END;                                                          27910000
          GO TO IF WORD=ON THEN E ELSE EMITIO;                          27920000
     S3:                                                                27930000
          IOD.[24:1]:=1;                                                27940000
          IF SPECIALCHR NEQ 0 OR COUNT LSS 0 THEN GO EMITIO ELSE        27950000
          IF (JUNKB:=(W:=WORD)=BOT) OR W=EOT THEN                       27960000
          BEGIN                                                         27970000
               IOD.[27:1]:=1; IOD.[29:1]:=1;                            27980000
               IOD.[22:1]:=REAL(JUNKB);                                 27990000
          END ELSE                                                      28000000
          IF W=PAR THEN IOD.[28:1]:=1 ELSE                              28010000
          IF W=BKWD THEN IOD.[22:1]:=1 ELSE                             28020000
          IF W=ALFA THEN IOD.[21:1]:=0 ELSE                             28030000
          IF W=BNRY THEN ELSE                                           28040000
          IF W=TPMRK THEN IOD.[27:1]:=1 ELSE                            28050000
          IF W=ON THEN GO E ELSE                                        28060000
          PRINTERROR(772);                                              28070000
          SCAN;                                                         28080000
          GO S3;                                                        28090000
     S4: %ERASE                                                         28100000
          IOD.[18:1]:=1;                                                28110000
          GO S2;                                                        28120000
     S5: %REWIND                                                        28130000
          IF BL(NT1:=REAL(WORD=BOT)) THEN                               28140000
               SCAN;                                                    28150000
          NT2:=REAL(WORD=ON);                                           28160000
          EMITLITERAL(11&..42[18:42:6]&U[3:43:5]&                       28170000
             ENTIER(NT1|5)[27:45:3]&NT2[1:47:1]);                       28180000
          EMITLITERAL(IOD1);                                            28190000
          GO TO IF BL(NT2) THEN E1 ELSE XIT;                            28200000
     S6: %BACKSPACE;                                                    28210000
          IOD.[22:1]:=1;                                                28220000
          GO S3;                                                        28230000
     E:                                                                 28240000
          IOD:=-IOD;                                                    28250000
     EMITIO:                                                            28260000
          EMITLITERAL(IOD);                                             28270000
          EMITLITERAL(IOD1);                                            28280000
          IF IOD LSS 0 THEN                                             28290000
     E1:                                                                28300000
          BEGIN                                                         28310000
               SCAN;                                                    28320000
               IF WORD=ERR THEN CONDITIONALSTATEMENT ELSE               28330000
               PRINTERROR(810);                                         28340000
          END;                                                          28350000
     XIT: END;                                                          28360000
%***********************************************************************28370000
     PROCEDURE STATEMENT;                                               28380000
          BEGIN                                                         28390000
     LABEL                                                              28400000
          S1,S2,S3,S4,S5,S6,S7,S9,S10,S12,S13,                          28410000
          E,                                                            28420000
          G,                                                            28430000
          START,                                                        28440000
          XIT,                                                          28450000
          EMITDISPLAY,                                                  28460000
          BGN,                                                          28470000
          IO,                                                           28480000
          FINDISPLAYMODIFIERS;                                          28490000
          SWITCH SW:=S1,S2,S3,S4,S5,S6,S7,XIT,S9,G,S10,BGN,             28500000
               IO,IO,IO,IO,IO,IO,S12,S13;                               28510000
     START:                                                             28520000
          IF COUNT=0 THEN PRINTERROR(2) ELSE                            28530000
          IF COUNT LSS 0 THEN PRINTERROR(4) ELSE                        28540000
          IF W:=WRD(RESERVED,NROFRESERVED) GEQ 0 THEN                   28550000
          GO SW[W+1] ELSE PRINTERROR(8);                                28560000
     S1:                                                                28570000
          IF LEVELCOUNT NEQ 0 THEN PRINTERROR(306) ELSE                 28580000
          SCAN;                                                         28590000
          IF W:=WORD=LUNIT THEN                                         28600000
          BEGIN                                                         28610000
               SCAN;                                                    28620000
               IF U:=UNIT:=WRD(UNKNOWNUNITS[0,0],18)=-1 THEN            28630000
               PRINTERROR(300) ELSE                                     28640000
               IF BOOLEAN(UNKNOWNUNITS[1,UNIT].[1:1]) THEN              28650000
               PRINTERROR(301) ELSE                                     28660000
               BEGIN                                                    28670000
                    IF NEXTUNIT=18 THEN PRINTERROR(302) ELSE            28680000
                    UNITABLE[1,NEXTUNIT]:=-UNIT;                        28690000
                    MOVE(1,UNKNOWNUNITS[0,UNIT],UNITABLE[0,             28700000
                            UNIT:=NEXTUNIT]);                           28710000
                    UNKNOWNUNITS[1,0]:=-UNIT;                           28720000
                    NEXTUNIT:=NEXTUNIT+1;                               28730000
                    EMIT(1,0,UNIT,0);                                   28740000
                    SCAN;                                               28750000
               END;                                                     28760000
          END ELSE                                                      28770000
          IF W=PAT THEN                                                 28780000
          BEGIN                                                         28790000
               SCAN;                                                    28800000
               IF COUNT GTR 0 THEN                                      28810000
               IF JUNK:=WRD(PNAMES[0],NEXTPATTERN)=-1 THEN              28820000
               BEGIN                                                    28830000
                    LASTSCAN:=FIRSTSCAN;                                28840000
                    P:=WHATPATTERN(2);                                  28850000
                    EMIT(1,0,P,1);                                      28860000
                    GO XIT;                                             28870000
               END                                                      28880000
               ELSE PRINTERROR(304)                                     28890000
               ELSE PRINTERROR(303) ;                                   28900000
          END ELSE PRINTERROR(305);                                     28910000
          GO XIT;                                                       28920000
     S2: %DISPLAY                                                       28930000
          NT1:=SIZE:=0; SCAN;                                           28940000
          IF JUNKB:=(W:=WORD=BUFF) THEN                                 28950000
          BEGIN                                                         28960000
               B:=WHATBUFFER;                                           28970000
               SCAN;                                                    28980000
          END ELSE                                                      28990000
          IF W=PAT THEN                                                 29000000
          BEGIN                                                         29010000
                    IF B:=WHATPATTERN(-1) LSS 0 THEN                    29020000
                    BEGIN                                               29030000
                         SIZE:=(ABS(B)+7)DIV 8;                         29040000
                         SCAN; IF WORD=28 THEN                          29050000
                         B:=WHATBUFFER ELSE                             29060000
                         PRINTERROR(306);                               29070000
                         JUNKB:=TRUE;                                   29080000
                    END;                                                29090000
               SCAN;                                                    29100000
          END ELSE B:=EMPTY;                                            29110000
     FINDISPLAYMODIFIERS:                                               29120000
          IF SPECIALCHR NEQ 0 OR COUNT LSS 0 THEN GO EMITDISPLAY;       29130000
          IF W:=WORD=DUBLE THEN                                         29140000
          BEGIN                                                         29150000
               SCAN;                                                    29160000
               IF WORD=SPCE THEN SCAN;                                  29170000
               NT1:=NT1+1;                                              29180000
               GO FINDISPLAYMODIFIERS;                                  29190000
          END ELSE                                                      29200000
          IF W=PGE THEN NT1:=NT1+2 ELSE                                 29210000
          IF W=NONO THEN NT1:=NT1+64 ELSE                               29220000
          PRINTERROR(401);                                              29230000
          SCAN;                                                         29240000
          GO FINDISPLAYMODIFIERS;                                       29250000
     EMITDISPLAY:                                                       29260000
          IF NT1.[42:6] GTR 3 OR NT1 GTR 67 THEN PRINTERROR(402) ELSE   29270000
          EMITLITERAL(2&NT1[CTSCF]&B[CTF]&SIZE[CTSF]&REAL(JUNKB)        29280000
               [1:47:1]);                                               29290000
          GO XIT;                                                       29300000
     S3: %DO                                                            29310000
          DOLOOP;                                                       29320000
          SCAN;                                                         29330000
          GO XIT;                                                       29340000
     S4: %FILL                                                          29350000
          SCAN;                                                         29360000
          NT1:=NT2:=0;                                                  29370000
          IF W:=WORD=TLLY THEN                                          29380000
          BEGIN                                                         29390000
               SCAN;                                                    29400000
               IF WORD=WTH THEN SCAN ELSE PRINTERROR(501);              29410000
               IF WORD=TLLY THEN                                        29420000
                    BEGIN SCAN; NT1:=1; END;                            29430000
               IF SPECIALCHR="+" THEN SCAN ELSE                         29440000
               IF SPECIALCHR="-" THEN                                   29450000
                    BEGIN NT2:=1; SCAN; END;                            29460000
               IF COUNT GEQ 0 THEN PRINTERROR(503) ELSE                 29470000
               EMIT(13,0,0,NT1);                                        29480000
               EMITLITERAL(TESTBUFFER[0]&NT2[1:47:1]);                  29490000
               SCAN; GO XIT;                                            29500000
          END ELSE                                                      29510000
          IF W=TGLE THEN                                                29520000
          BEGIN                                                         29530000
               SCAN;                                                    29540000
               IF WORD=WTH THEN SCAN ELSE PRINTERROR(501);              29550000
               IF WORD=ESLAF THEN ELSE                                  29560000
               IF WORD=EURT THEN NT1:=1 ELSE                            29570000
               PRINTERROR(504);                                         29580000
               EMIT(13,1,NT1,0);                                        29590000
               SCAN; GO XIT;                                            29600000
          END ELSE                                                      29610000
          IF WORD=BUFF THEN B:=WHATBUFFER ELSE PRINTERROR(500);         29620000
          SCAN;                                                         29630000
          IF (W:=WORD=WTH OR KNOWN:=W=USING) THEN SCAN ELSE             29640000
          PRINTERROR(501);                                              29650000
          IF WORD=PAT THEN                                              29660000
          BUFFERS[0,B].[SF]:=MAX(BUFFERS[0,B].[SF],                     29670000
               PATTERNS[0,P:=WHATPATTERN(REAL(KNOWN))].[SF]) ELSE       29680000
          PRINTERROR(502);                                              29690000
          EMIT(4,B,P,0);                                                29700000
          SCAN;                                                         29710000
          GO XIT;                                                       29720000
     S5: %ROTATE                                                        29730000
          SCAN;                                                         29740000
          IF WORD=BUFF THEN B:=WHATBUFFER ELSE                          29750000
          PRINTERROR(601);                                              29760000
          SCAN;                                                         29770000
          IF SPECIALCHR="+" OR JUNKB:=SPECIALCHR="-" THEN               29780000
          BEGIN                                                         29790000
               SCAN;                                                    29800000
               IF COUNT LSS 0 THEN                                      29810000
                    IF NT1:=TESTBUFFER[0] LSS 8|(BUFFERS[0,B].[SF]) THEN29820000
                    EMIT(5,B,NT1,REAL(JUNKB))                           29830000
                    ELSE PRINTERROR(602)                                29840000
               ELSE PRINTERROR(603);                                    29850000
          END ELSE                                                      29860000
          PRINTERROR(604);                                              29870000
          SCAN;                                                         29880000
          GO XIT;                                                       29890000
     S6: %SHIFT                                                         29900000
          SCAN;                                                         29910000
          IF WORD=BUFF THEN B:=WHATBUFFER ELSE                          29920000
          PRINTERROR(701);                                              29930000
          SCAN;                                                         29940000
          IF (JUNKB:=SPECIALCHR="+") OR SPECIALCHR="-" THEN             29950000
          BEGIN                                                         29960000
               SCAN;                                                    29970000
               IF COUNT LSS 0 THEN                                      29980000
               BEGIN                                                    29990000
                    IF NT1:=TESTBUFFER[0] GTR NT2:=                     30000000
                            8|(BUFFERS[0,B].[SF]) THEN                  30010000
                    IF NT2:=NT1+(NT2 DIV 8) LEQ 1021 THEN               30020000
                    BUFFERS[0,B].[SF]:=NT2 ELSE                         30030000
                    PRINTERROR(702);                                    30040000
                    EMIT(6,B,NT1,REAL(JUNKB));                          30050000
               END ELSE PRINTERROR(703);                                30060000
          END ELSE                                                      30070000
          PRINTERROR(704);                                              30080000
          SCAN;                                                         30090000
          GO XIT;                                                       30100000
     S7: %COMPARE                                                       30110000
          SCAN;                                                         30120000
          IF W:=WORD=PAT THEN P:=WHATPATTERN(1)+MAXBUFFS ELSE           30130000
          IF W=BUFF THEN P:=WHATBUFFER ELSE                             30140000
          PRINTERROR(801);                                              30150000
          SCAN;                                                         30160000
          IF WORD=WTH THEN SCAN ELSE PRINTERROR(800);                   30170000
          IF WORD=BUFF THEN B:=WHATBUFFER ELSE PRINTERROR(801);         30180000
          SCAN;                                                         30190000
          EMIT(7,B,P,REAL(JUNKB:=WORD=ON));                             30200000
          IF JUNKB THEN GO E ELSE                                       30210000
          GO XIT;                                                       30220000
     S9: %LABEL                                                         30230000
          IF LEVELCOUNT NEQ 0 THEN PRINTERROR(814) ELSE                 30240000
          NT1:=WHATLABEL(1);                                            30250000
          SCAN;                                                         30260000
          IF SPECIALCHR NEQ ":" THEN PRINTERROR(815);                   30270000
          SCAN;                                                         30280000
          GO START;                                                     30290000
     E:                                                                 30300000
          SCAN;                                                         30310000
          IF WORD=ERR THEN CONDITIONALSTATEMENT ELSE                    30320000
          PRINTHERROR(810);                                             30330000
          GO XIT;                                                       30340000
     G:                                                                 30350000
          EMITLITERAL(WHATLABEL(0));                                    30360000
          SCAN;                                                         30370000
          GO XIT;                                                       30380000
     S10:                                                               30390000
          IF LEVELCOUNT=0 THEN EMITLITERAL(63) ELSE                     30400000
          EMITLITERAL(10);                                              30410000
          SCAN;                                                         30420000
          GO XIT;                                                       30430000
     BGN: %BEGIN                                                        30440000
          COMPOUNDSTATEMENT;                                            30450000
          GO XIT;                                                       30460000
     IO:                                                                30470000
          IOSTATEMENT(W-11);                                            30480000
          GO XIT;                                                       30490000
      S12: %TEST                                                        30500000
          IF LEVELCOUNT NEQ 0 THEN                                      30510000
          PRINTERROR(814) ELSE SCAN;                                    30520000
          IF COUNT GEQ 0 THEN PRINTERROR(816) ELSE                      30530000
          IF NT1:=TESTBUFFER[0] GTR NUMBEROFTAPETESTS THEN              30540000
             PRINTERROR(817) ELSE                                       30550000
          IF BL((HEADER[NT1:=NT1+FIRSTEST]).[1:1]) THEN                 30560000
             PRINTERROR(818) ELSE                                       30570000
          HEADER[NT1]:=-A;                                              30580000
          IF THISTEST GEQ 0 THEN                                        30590000
          HEADER[THISTEST+FIRSTEST].[FF]:=REAL(MAKETAPE);               30600000
          MAKETAPE:=FALSE;                                              30610000
          NUMBEROFTESTS:=MAX(NUMBEROFTESTS,THISTEST:=NT1-FIRSTEST);     30620000
          SCAN; IF SPECIALCHR NEQ ":" THEN PRINTERROR(815) ELSE         30630000
          SCAN; GO START;                                               30640000
     S13: %IF                                                           30650000
          SCAN;                                                         30660000
          IF W:=WORD=TGLE THEN EMIT(13,2,0,0) ELSE                      30670000
          IF W=MOD3 THEN EMIT(13,4,0,0) ELSE                            30671000
          IF W=TLLY THEN                                                30680000
          BEGIN                                                         30690000
               SCAN;                                                    30700000
               IF SPECIALCHR="=" THEN SCAN ELSE                         30710000
                    PRINTERROR(819);                                    30720000
               IF COUNT GTR 0 THEN PRINTERROR(820) ELSE                 30730000
               EMIT(13,3,0,0);                                          30740000
               EMITLITERAL(TESTBUFFER[0]);                              30750000
          END;                                                          30760000
               SCAN;                                                    30770000
               IF WORD NEQ THN THEN PRINTERROR(821);                    30780000
               CONDITIONALSTATEMENT;                                    30790000
               GO XIT;                                                  30800000
     XIT: END OF STATEMENT;                                             30810000
%***********************************************************************30820000
     PROCEDURE INITIALIZE;                                              30830000
          BEGIN                                                         30840000
          LABEL XIT;                                                    30850000
          TIME1:=TIME(1);                                               30860000
          IF LST THEN DATIME;                                           30870000
          NEXTSEG:=CODESWITCH:=LEVELCOUNT:=0;                           30880000
          COUT:=1;                                                      30890000
          INPUTBUFFER[10]:=..73737373737373;                            30900000
          ROTATE(COREADDR(INPUTBUFFER[10]),JUNK,7,1);                   30910000
          MOVE(1,INPUTBUFFER[9],TEST);                                  30920000
          MOVE(1,INPUTBUFFER[10],INPUTBUFFER[9]);                       30930000
          DOLLRE:=FALSE;                                                30940000
          FIRSTSCAN:=LASTSCAN:=COREADDR(INPUTBUFFER[9]);                30950000
          IF NOT SOP THEN                                               30980000
          BEGIN                                                         30990000
               WBUFF:=IF TWXOUT:=(OUTSWITCH=1 OR OUTSWITCH=4) THEN      31000000
                  9 ELSE 15;                                            31010000
          END;                                                          31020000
          FILL RESERVED[*] WITH                                         31030000
               "INPUT   ",                                              31040000
               "DISPLAY ",                                              31050000
               "DO      ",                                              31060000
               "FILL    ",                                              31070000
               "ROTATE  ",                                              31080000
               "SHIFT   ",                                              31090000
               "COMPARE ",                                              31100000
               "END     ",                                              31110000
               "LABEL   ",                                              31120000
               "GO      ",                                              31130000
               "STOP    ",                                              31140000
               "BEGIN   ",                                              31150000
               "READ    ",                                              31160000
               "WRITE   ",                                              31170000
               "SPACE   ",                                              31180000
               "ERASE   ",                                              31190000
               "REWIND  ",                                              31200000
               "BACKSPAC",                                              31210000
               "TEST    ",                                              31220000
               "IF      ";                                              31230000
          FILLMODIFIERS(COMPAREBUFF);                                   31240000
          FILL UNKNOWNUNITS[0,*] WITH                                   31250000
               "MT1     ",                                              31260000
               "MT2     ",                                              31270000
               "MT3     ",                                              31280000
               "MT4     ",                                              31290000
               "MT5     ",                                              31300000
               "MT6     ",                                              31310000
               "MT7     ",                                              31320000
               "MT8     ",                                              31330000
               "MT9     ",                                              31340000
               "MT10    ",                                              31350000
               "MT11    ",                                              31360000
               "MT12    ",                                              31370000
               "MT13    ",                                              31380000
               "MT14    ",                                              31390000
               "MT15    ",                                              31400000
               "MT16    ",                                              31410000
               "DK1     ",                                              31420000
               "DK2     ";                                              31430000
          THISTEST:=-1;                                                 31440000
          WRITE(COEFILE,30,OUTBUFFER[*]);                               31450000
          FOR NT1:=0 STEP 1 UNTIL 29 DO HEADER[NT1]:=0;                 31460000
          SEGNO:=1;                                                     31470000
          NEXTLABEL:=S:=A:=NEXTUNIT:=NEXTPATTERN:=0;                    31480000
          BUFFERS[0,0]:=..10007777700000;                               31490000
          BUFFERS[0,1]:=..17747777700000;                               31500000
          NEXTBUFF:=2;                                                  31510000
          BUFFERS[0,2]:=..7777700000;                                   31520000
          MOVE(MAXBUFFS-3,BUFFERS[0,2],BUFFERS[0,3]);                   31530000
          LABELS[0]:=..777777777777777;                                 31540000
          MOVE(MAXLABELS-1,LABELS[0],LABELS[1]);                        31550000
     XIT: END OF INITIALIZE;                                            31560000
%***********************************************************************31570000
     PROCEDURE WRAPUP;                                                  31580000
          BEGIN                                                         31590000
          LABEL SAVECODE,XIT;                                           31600000
          EMITLITERAL(63);                                              31610000
          SEGDICT[S]:=0&SEGNO[CTF]&A[CTSF];                             31620000
          IF LEVELCOUNT NEQ 0 THEN PRINTHERROR(7);                      31630000
          NT5:=EMPTY;                                                   31640000
          FOR NT1:=NEXTLABEL-1 STEP -1 UNTIL 0 DO                       31650000
          IF NT2:=LABELS[NT1] GEQ 0 THEN                                31660000
          BEGIN                                                         31670000
               FIRSTSCAN:=COREADDR(TESTBUFFER);;                        31680000
               COUNT:=8;                                                31690000
               MOVE(1,LNAMES[NT1],TESTBUFFER);                          31700000
               PRINTHERROR(160);                                        31710000
          END ELSE                                                      31720000
          IF NT2.[CF] LSS EMPTY THEN                                    31730000
          BEGIN                                                         31740000
               NT4:=NT2.[CF]; NT3:=NT2.[FF];                            31750000
               NT2:=8&NT2[27:3:15];                                     31760000
               WHILE NT4 NEQ EMPTY DO                                   31770000
               BEGIN                                                    31780000
                    IF DEBUGN THEN DEBUGOUT(NT2,NT3,NT4);               31781000
                    IF NT3=S THEN                                       31790000
                    BEGIN                                               31800000
                         NT6:=CODE[NT4];                                31810000
                         CODE[NT4]:=NT2;                                31820000
                    END ELSE                                            31830000
                    IF NT3=NT5 THEN                                     31840000
          SAVECODE:                                                     31850000
                    BEGIN                                               31860000
                         NT6:=EDOC[1,NT4];                              31870000
                         EDOC[1,NT4]:=NT2;                              31880000
                    END ELSE                                            31890000
                    BEGIN                                               31900000
                         IF NT5 NEQ EMPTY THEN                          31910000
                         RETURNSEGMENT(NT5);                            31920000
                         RECALLSEGMENT(NT5:=NT3);                       31930000
                         GO SAVECODE;                                   31940000
                    END;                                                31950000
               NT3:=NT6.[FF]; NT4:=NT6.[CF];                            31960000
               END;                                                     31970000
          END;                                                          31980000
          IF NT5 NEQ EMPTY THEN RETURNSEGMENT(NT5);                     31990000
          FOR NT1:=NEXTBUFF-1 STEP -1 UNTIL 2 DO                        32000000
               IF BUFFERS[0,NT1].[SF]=0 THEN BUFFERS[0,NT1].[SF]:=1020; 32010000
          IF NOT ERRTOG THEN                                            32020000
          BEGIN                                                         32030000
               READ SEEK(COEFILE[SEGNO]);                               32040000
               TRANSFEROUT(A,30,COEFILE,CODE[*]);                       32050000
               SEGNO:=SEGNO+((A+29)DIV 30);                             32060000
               TRANSFEROUT(NEXTBUFF,30,COEFILE,BUFFERS[0,*]);           32070000
               TRANSFEROUT(NEXTBUFF,30,COEFILE,BNAMES[*]);              32080000
               HEADER[0]:=SEGNO;                                        32090000
               TRANSFEROUT(NEXTPATTERN,30,COEFILE,PNAMES[*]);           32100000
               TRANSFEROUT(HEADER[2]:=NEXTPATTERN,30,COEFILE,           32110000
                           PATTERNS[0,*]);                              32120000
               SEGNO:=SEGNO+2|((NEXTPATTERN+29)DIV 30);                 32130000
               TRANSFEROUT(HEADER[3]:=NEXTSEG+1,30,COEFILE,SEGDICT[*]); 32140000
               WRITE(COEFILE,HEADER[1]:=NEXTUNIT,UNITABLE[0,*]);        32150000
               WRITE(COEFILE,NEXTUNIT,UNITABLE[1,*]);                   32160000
               SEGNO:=SEGNO+1+(NEXTSEG DIV 30)+                         32170000
               2|REAL(NEXTUNIT GTR 0);                                  32180000
               HEADER[4]:=COUT.[FF];                                    32190000
               HEADER[5]:=COUT.[CF];                                    32200000
               HEADER[6]:=NEXTBUFF;                                     32210000
               HEADER[7]:=REAL(MAKETAPE);                               32220000
               IF THISTEST GEQ 0 THEN                                   32230000
               HEADER[THISTEST+FIRSTEST].[FF]:=REAL(MAKETAPE);          32240000
               MAKETAPE:=FALSE;                                         32250000
               HEADER[8]:=NUMBEROFTESTS;                                32260000
               REWIND(COEFILE);                                         32270000
               WRITE(COEFILE,30,HEADER[*]);                             32280000
          END;                                                          32290000
          REWIND(COEFILE);                                              32300000
          IF LST THEN                                                   32310000
          BEGIN                                                         32320000
               P:=0;                                                    32330000
               FOR B:=0 STEP 1 UNTIL NEXTSEG DO                         32340000
                    P:=P+SEGDICT[B].[SF];                               32350000
               WRITE(OUTFI[DBL]);                                       32360000
               WRITE(OUTFI[DBL],EFF,ERRORS,(TIME(1)-TIME1)DIV 60);      32370000
               WRITE(OUTFI[DBL],SEGSIZEF,NEXTSEG+1,P);                  32380000
               WRITE(OUTFI[DBL],PATSF,NEXTPATTERN);                     32390000
               WRITE(OUTFI[DBL],DISKSIZEF,SEGNO+2);                     32400000
               WRITE(OUTFI[PAGE]);                                      32410000
          END;                                                          32430000
          COMPILING:=FALSE;                                             32440000
          IF PTOG THEN IF PATCHSWITCH=1 OR CINSW NEQ 2 THEN             32450000
               CLOSE(PATCH);                                            32460000
          IF INSWITCH NEQ CINSW THEN                                    32470000
          BEGIN                                                         32480000
               CLOSE(INFILE); INSWITCH:=CINSW;                          32490000
          END;                                                          32500000
          IF NTOG THEN                                                  32510000
          BEGIN                                                         32520000
               NTOG:=FALSE;                                             32530000
               LOCK(NEW,*);                                             32540000
          END;                                                          32550000
          IF OBJECTPRESENT:=NOT ERRTOG THEN                             32560000
               IF CONF THEN                                             32570000
               BEGIN                                                    32580000
                    LOCK(COEFILE,*);                                    32590000
                    WRITE(CFILE,SUCCESSF);                              32591000
                    OBJECTPRESENT:=FALSE;                               32600000
                    GO RETURN1;                                         32610000
               END ELSE                                                 32620000
               IF LIBONLY THEN                                          32630000
               BEGIN                                                    32640000
                    LIBONLY:=FALSE;                                     32650000
                    GO RETURN1;                                         32660000
               END ELSE                                                 32670000
               GO MCCLRUN;                                              32680000
          CONF:=FALSE;                                                  32690000
          WRITE(CFILE,ERRF,ERRORS);                                     32691000
          FIRSTSCAN:=LASTSCAN:=INP;                                     32700000
          INPUTBUFFER[0]:=..1200000000000000;                           32710000
     XIT: END;                                                          32720000
%#########COMPILER BLOCK CODE###########################################32730000
     INITIALIZE;                                                        32740000
     WHILE WORD NEQ NIGEB DO SCAN;                                      32750000
     COMPOUNDSTATEMENT;                                                 32760000
     WRAPUP;                                                            32770000
     END;                                                               32780000
%#########END OF COMPILER BLOCK#########################################32790000
FINISHOFF:                                                              32800000
   IF ERRTOG THEN                                                       32810000
   IF INSWITCH=2 THEN GO EXIT ELSE                                      32820000
      BEGIN                                                             32830000
      ERRTOG:=FALSE;                                                    32840000
      ERROR:=ERRORS:=0;                                                 32850000
      GO RETURN1;                                                       32860000
      END ELSE                                                          32870000
      BEGIN SCAN; IF SPECIALCHR NEQ "#" THEN GOPERROR(26) ELSE          32880000
            GO RETURN1;                                                 32890000
      END;                                                              32900000
RUNTAPETESTS:                                                           32920000
     CONF:=TRUE;                                                        32930000
      IF OBJECTPRESENT THEN CLOSE(CODEFILE);                            32940000
      CODESWITCH:=1;                                                    32950000
      MAKETAPE:=TESTARRAY[0] NEQ 0;                                     33020000
      TEST:=-1;                                                         33030000
MCCLRUN:                                                                33040000
ERROR:=ERRORS:=0;                                                       33050000
READ(CODEFILE,30,HEADER[*]);                                            33060000
READ SEEK(CODEFILE[HEADER[0]]);                                         33070000
TRANSFERIN(NT1:=HEADER[6],30,CODEFILE,COMPAREBUFF[*]);                  33080000
   FOR NT2:=NT1 STEP 1 UNTIL 9 DO COMPAREBUFF[NT2]:=0;                  33090000
IF NOT SOP THEN                                                         33100000
   BEGIN                                                                33110000
   WBUFF:=IF TWXOUT:=(OUTSWITCH:=HEADER[4]=1 OR OUTSWITCH=4)            33120000
      THEN 9 ELSE 15;                                                   33130000
   IF OCTL:=HEADER[5] GTR 0 THEN BCL:=HEADER[5] GTR 1;                  33140000
   END;                                                                 33150000
%#########INTERPRETER BLOCK DECLARATIONS START HERE#####################33160000
BEGIN                                                                   33170000
DEFINE IFL=42:6#,                                                       33180000
       IBUFF=COREADDR(CODE)#,                                           33190000
       DBUFF=COREADDR(PATBUFF[1])#,                                     33200000
       MAXSWITCH=8#;                                                    33210000
%***********************************************************************33220000
SAVE ARRAY                                                              33230000
   B2[0:COMPAREBUFF[2].[SF]+1],                                         33240000
   B3[0:COMPAREBUFF[3].[SF]+1],                                         33250000
   B4[0:COMPAREBUFF[4].[SF]+1],                                         33260000
   B5[0:COMPAREBUFF[5].[SF]+1],                                         33270000
   B6[0:COMPAREBUFF[6].[SF]+1],                                         33280000
   B7[0:COMPAREBUFF[7].[SF]+1],                                         33290000
   B8[0:COMPAREBUFF[8].[SF]+1],                                         33300000
   B9[0:COMPAREBUFF[9].[SF]+1];                                         33310000
%***********************************************************************33540000
SAVE ARRAY CODE[0:511],PATBUFF[0:1022];                                 33550000
%***********************************************************************33560000
ARRAY                                                                   33570000
   LEVELARRAY[0:MAXLEVELS-1],                                           33580000
   UNITABLE[0:1,0:HEADER[1]],                                           33590000
   PATTERNS[0:1,0:MAX(HEADER[2]-1,0)],                                  33600000
   BUFFERS[0:1,0:HEADER[6]-1],                                          33610000
   SEGDICT[0:HEADER[3]-1],                                              33620000
   PNAMES[0:MAX(HEADER[2]-1,0)],                                        33630000
   BNAMES[0:HEADER[6]-1];                                               33640000
%***********************************************************************33650000
     INTEGER P,B,SIZE,U,LOOPCOUNT,TALLY,RTYCNT;                         33660000
%***********************************************************************33670000
     REAL JUNK,INSTRUCTION,IOD1;                                        33680000
%***********************************************************************33690000
     BOOLEAN TOGGLE;                                                    33700000
%***********************************************************************33710000
PROCEDURE GETSEGMENT(SEGMENT); VALUE SEGMENT; INTEGER SEGMENT;          33720000
   BEGIN                                                                33730000
   READ SEEK(CODEFILE[(JUNK:=SEGDICT[SEGMENT]).[FF]]);                  33740000
   TRANSFERIN(JUNK.[SF],30,CODEFILE,CODE[*]);                           33750000
   S:=SEGMENT;                                                          33760000
   END;                                                                 33770000
%***********************************************************************33770005
     PROCEDURE STARTAPEIO(IOD,RESULT); VALUE IOD; REAL IOD,RESULT;      33770010
          FORWARD;                                                      33770020
%***********************************************************************33770050
     PROCEDURE STOPCHECK(I); REAL I;                                    33770100
          BEGIN                                                         33770200
          FORMAT                                                        33770300
               INVIN("INVALID IN=",I4),                                 33770400
               TERM1("TEST #",I2," TERMINATED BY OPERATOR"),            33770500
               TERM2("ONLINE MAINTENANCE TERMINATED BY OPERATOR");      33770600
          INTEGER J;                                                    33770700
          LABEL TWO,XIT;                                                33770800
%                                                                       33770900
          IF STOPPER GTR 3 OR STOPPER LSS 0 THEN                        33771000
          BEGIN                                                         33771100
               WRITE(CFILE,INVIN,STOPPER);                              33771200
               GO XIT;                                                  33771300
          END ELSE                                                      33771400
          IF STOPPER=3 THEN                                             33771500
          BEGIN                                                         33771600
               WRITE(OUTFI[DBL],TERM2);                                 33771700
               DONETOG:=TRUE;                                           33771800
               GO TWO;                                                  33771900
          END ELSE                                                      33772000
          BEGIN                                                         33772100
               WRITE(OUTFI[DBL],TERM1,TEST);                            33772200
               IF STOPPER=2 THEN                                        33772300
               BEGIN                                                    33772400
                    IF DONETOG THEN                                     33772500
                    BEGIN                                               33772600
                         DONETOG:=FALSE;                                33772700
                         INSWITCH:=CSWITCH;                             33772800
                    END;                                                33772900
          TWO:      FOR J:=TEST STEP 1 UNTIL NUMBEROFTESTS DO           33773000
                         TESTARRAY[J]:=0;                               33773100
               END;                                                     33773200
          END;                                                          33773300
          IF LEVELCOUNT=0 THEN I:=12 ELSE                               33773400
          BEGIN                                                         33773500
               LEVELCOUNT:=1;                                           33773600
               LOOPCOUNT:=0;                                            33773700
               I:=10;                                                   33773800
          END;                                                          33773900
          J:=COREADDR(STOPPER);                                         33774000
          STARTAPEIO(..4200000000&UNITABLE[1,0][3:28:5],STOPPER);       33774100
          WAIT(J,IOMASK);                                               33774200
     XIT: STOPPER:=0;                                                   33774300
     END;                                                               33774400
%***********************************************************************33780000
REAL PROCEDURE INSTR;                                                   33790000
   BEGIN                                                                33800000
   REAL I; LABEL NEXT;                                                  33810000
NEXT:                                                                   33820000
   IF I:=CODE[A]=0 THEN                                                 33830000
      BEGIN                                                             33840000
      A:=A+1; GO NEXT;                                                  33850000
      END                                                               33860000
   ELSE IF I.[IFL]=8 THEN                                               33870000
      IF NT1:=I.[FF]=S THEN BEGIN A:=I.[SCF]; GO NEXT; END ELSE         33880000
      BEGIN                                                             33890000
      GETSEGMENT(NT1);                                                  33900000
      A:=I.[SCF];                                                       33910000
      GO NEXT;                                                          33920000
      END;                                                              33930000
   A:=A+1;                                                              33940000
   IF I.[IFL] =63 THEN I.[IFL]:=MAXSWITCH ELSE                          33950000
   IF I.[IFL]=0 THEN                                                    33960000
   BEGIN LEVELARRAY[LEVELCOUNT]:=LOOPCOUNT&I[FTF];                      33970000
         LOOPCOUNT:=-1; LEVELCOUNT:=LEVELCOUNT+1;                       33980000
         GO NEXT;                                                       33990000
   END;                                                                 34000000
   IF STOPPER NEQ 0 THEN STOPCHECK(I);                                  34001000
   INSTR:=I;                                                            34010000
   END;                                                                 34020000
%***********************************************************************34030000
DEFINE NEXTINSTRUCTION=                                                 34040000
   GO TO SW[(INSTRUCTION:=INSTR).[IFL]]#;                               34050000
%***********************************************************************34060000
LABEL S1,S2,S3,S4,S5,S6,S7,DONE,S9,S10,                                 34070000
      S11,S12,S13;                                                      34080000
%***********************************************************************34090000
SWITCH SW:=S1,S2,S3,S4,S5,S6,S7,DONE,S9,S10,S11,S12,S13;                34100000
%***********************************************************************34110000
FORMAT INVUNIT("INV UNIT~"),                                            34120000
      DASH(72("-")),                                                    34121000
      NOTDONE("TEST #",I3," NOT RUN (WRITE LOCK)"),                     34122000
      EOTESTF("END OF RESULTS FOR TEST #",I2),                          34130000
      ERRSF(I5," ERRORS DETECTED"),                                     34140000
      INVTALLY("-INVALID I/O SIZE=",I8,":S=",I2,",A=",I3),              34150000
      INVTALLY1(10("#"),"-INVALID I/O SIZE=",I8,":S=",I2,",A=",         34170000
                I3,74("#")),                                            34180000
      PATERR("-PATTERN ERROR NR",I4," S=",I2,",A=",I3,                  34190000
             "~");                                                      34200000
%***********************************************************************34210000
STREAM PROCEDURE INPUTMESSAGE(TYPE,ADDR,B,SZ); VALUE TYPE,ADDR,         34220000
   SZ;                                                                  34230000
   BEGIN                                                                34240000
   LABEL L;                                                             34250000
   DI:=B; DS:=7 LIT "#ENTER ";                                          34260000
   TYPE(DS:=8 LIT "PATTERN "; JUMP OUT TO L);                           34270000
   DS:=5 LIT "UNIT ";                                                   34280000
L: SI:=ADDR;                                                            34290000
   8(IF SC=" " THEN JUMP OUT ELSE DS:=CHR);                             34300000
   TYPE(DS:=LIT"("; SI:=LOC SZ; DS:=4 DEC; DS:=LIT ")");                34310000
   DS:=LIT "~";                                                         34330000
   END;                                                                 34340000
%***********************************************************************34350000
STREAM PROCEDURE DISPLAYHEADING(BUFF,D,ID,XLATE);                       34360000
   VALUE BUFF,XLATE;                                                    34370000
   BEGIN                                                                34380000
   LABEL L;                                                             34390000
   DI:=D;                                                               34400000
   BUFF(DS:=7 LIT "BUFFER ";                                            34410000
        SI:=ID;                                                         34420000
        8(IF SC=" " THEN JUMP OUT ELSE DS:=CHR);                        34430000
        DS:=10 LIT " CONTAINS(";                                        34440000
        JUMP OUT TO L);                                                 34450000
   DS:=8 LIT "PATTERN ";                                                34460000
   SI:=ID;                                                              34470000
   8(IF SC=" " THEN JUMP OUT ELSE DS:=CHR);                             34480000
   DS:=4 LIT " IS(";                                                    34490000
L:                                                                      34500000
   SI:=LOC XLATE; SI:=SI+5; DS:=3 CHR;                                  34510000
   DS:=2 LIT ")-";                                                      34520000
   END;                                                                 34530000
%***********************************************************************34540000
PROCEDURE GETPATTERN(P,B); VALUE P,B; INTEGER P,B;                      34550000
   BEGIN                                                                34560000
   LABEL XIT; BOOLEAN CLR;                                              34570000
   IF CLR:=BOOLEAN(P.[1:1]) THEN P:=ABS(P);                             34580000
   IF NT1:=(NT2:=BUFFERS[0,B]).[FF] LSS EMPTY                           34590000
         THEN                                                           34600000
      IF NT1=P THEN %PATTERN ALREADY PRESENT                            34610000
         GO XIT                       %SO GO ON                         34620000
      ELSE                                                              34630000
      BEGIN %DELINK BUFFER FROM PRESENT PATTERN (NT1)                   34640000
      IF NT3:=(NT4:=BUFFERS[1,B]).[CF]=EMPTY THEN%HEAD OF LIST          34650000
         PATTERNS[1,NT1].[FF]:=NT4.[FF] ELSE                            34660000
         BUFFERS[1,NT3].[FF]:=NT4.[FF];                                 34670000
      BUFFERS[1,B].[FF]:=EMPTY;                                         34680000
      IF NT5:=NT4.[FF]=EMPTY THEN                %TAIL OF LIST          34690000
         PATTERNS[1,NT1].[CF]:=NT3 ELSE                                 34700000
         BUFFERS[1,NT5].[CF]:=NT3;                                      34710000
      BUFFERS[1,B].[CF]:=EMPTY;                                         34720000
      END;                                                              34730000
   IF ABS(P)=EMPTY THEN                                                 34740000
      BEGIN                                                             34741000
      IF P LSS 0 THEN CLEER((NT3:=BUFFERS[0,B]).[CF],NT3.[SF]);         34742000
      GO XIT;                                                           34743000
      END;                                                              34744000
   IF NT1:=(NT2:=(NT3:=BUFFERS[0,B]).[SF])-PATTERNS[0,P].[SF]           34750000
      GTR 0 THEN                                                        34760000
      CLEER(NT3.[CF]+NT2-NT1,NT1-1);                                    34770000
   BUFFERS[1,B].[CF]:=PATTERNS[1,P].[CF];                               34780000
   PATTERNS[1,P].[CF]:=B;                                               34790000
   IF NT2:=PATTERNS[1,P].[FF]=EMPTY THEN                                34800000
      BEGIN                                                             34810000
      PATTERNS[1,P].[FF]:=B;                                            34820000
      IF NOT CLR THEN                                                   34830000
      BEGIN                                                             34840000
         READ(CODEFILE[(NT1:=PATTERNS[0,P]).[FF]],30,                   34850000
            INPUTBUFFER[*]);                                            34860000
         FIRSTSCAN:=LASTSCAN:=INP;                                      34870000
         COMPILING:=TRUE;                                               34880000
         SCAN;                                                          34890000
         IF PATTERNGENERATOR(NT1.[CF],BUFFERS[0,B].[CF]) THEN           34900000
            BEGIN                                                       34910000
            WRITE(CFILE,PATERR,ERROR,S,A);                              34920000
            GO EXIT;                                                    34930000
            END ELSE                                                    34940000
         COMPILING:=FALSE;                                              34950000
      END                                                               34960000
      END                                                               34970000
   ELSE                                                                 34980000
      IF NOT CLR THEN                                                   34990000
      VALUEMOVE(PATTERNS[0,P].[SF],BUFFERS[0,NT2].[CF],                 35000000
         BUFFERS[0,B].[CF]);                                            35010000
XIT: BUFFERS[0,B].[FF]:=P; END;                                         35020000
%***********************************************************************35030000
   PROCEDURE STARTAPEIO(IOD,RESULT); VALUE IOD; REAL IOD,RESULT;        35040000
          BEGIN                                                         35050000
          RESULT:=0;                                                    35060000
          IOREQUEST(-(IOD)&5[25:40:8],IOD,COREADDR(RESULT)&             35070000
               UNIT[12:42:6]&1[2:47:1]);                                35080000
          TRANS:=IF BOOLEAN(IOD.[22:1]) THEN                            35090000
                      IF BOOLEAN(IOD.[18:1]) THEN 0                     35100000
                      ELSE TRANS-1                                      35110000
                 ELSE TRANS+1;                                          35120000
          END;                                                          35130000
%***********************************************************************35140000
     PROCEDURE TAPERROR(IOD,RESULT,MASK,KEY);                           35150000
          VALUE IOD,MASK,KEY;                                           35160000
         REAL IOD,RESULT,MASK; INTEGER KEY;                             35170000
          FORWARD;                                                      35180000
%***********************************************************************35190000
     REAL PROCEDURE TAPEPARITYRETRY(R,OIOD); VALUE R,OIOD;              35200000
          REAL R,OIOD;                                                  35210000
          FORWARD;                                                      35220000
%***********************************************************************35230000
     PROCEDURE IOFINISH(IOD,RESULT,MASK,KEY);VALUE IOD,MASK,KEY;        35240000
          REAL IOD,RESULT,MASK; INTEGER KEY;                            35250000
          BEGIN                                                         35260000
          INTEGER AD;                                                   35270000
          LABEL XIT,E;                                                  35280000
          AD:=COREADDR(RESULT);                                         35290000
          WAIT(AD,IOMASK);                                              35300000
          IF MASK=-..37700000 THEN GO XIT;                              35310000
          IF RESULT.[25:8]=MASK.[25:8] THEN                             35320000
            IF NOT BL(MASK.[1:1]) THEN    %NOT RETRY I/O                35330000
               IF KEY=1 THEN                                            35340000
                  IF P:=IOD1.[FF] LSS EMPTY THEN                        35350000
                    BEGIN                                               35360000
                         GETPATTERN(P,1);                               35370000
                         IF BIGCOMPARE(IOD.[SF]&IOD[1:22:1],            35380000
                              IOD.[CF],ENTIER(DBUFF+(IOD.[SF]-1)        35390000
                              |IOD.[22:1]),JUNK,JUNK,JUNK) THEN         35400000
                              GO E                                      35410000
                         ELSE GO XIT                                    35420000
                    END                                                 35430000
                  ELSE GO XIT                                           35440000
               ELSE GO XIT;                                             35450000
     E:                                                                 35460000
          TAPERROR(IOD,RESULT,MASK,KEY);                                35470000
          IF RESULT GTR 0 THEN                                          35480000
          IF IOD LSS 0 THEN                                             35490000
          BEGIN                                                         35500000
               A:=A+1;                                                  35510000
               GO XIT;                                                  35520000
          END;                                                          35530000
     XIT: END;                                                          35540000
%***********************************************************************35550000
     PROCEDURE READERROR(IOD,SZ); VALUE IOD,SZ; REAL IOD; INTEGER SZ;   35550100
          BEGIN                                                         35550200
          FORMAT                                                        35550300
               WTF(I4," WORDS (",A3,") READ WERE:"),                    35550400
               OKWTF(I4," WORDS (",A3,") READ--SAME AS EXPECTED"),      35550500
               BWTF(I4," WORDS (",A3,") READ--NOT AS EXPECTED--WERE:"), 35550600
               DIFF(I5," CHRS(IN",I5," WDS) DIFFER FROM EXPECTED ",     35550700
                    "RECORD (FIRST IN WRD",I5,")"),                     35550800
               SIZERRORF(X24,"SIZE ERROR (",I4," WORDS READ)"),         35550810
               NOTRANSF("NO DATA TRANSFERED ON READ");                  35550820
          LIST WLIST(SZ,IF BCL THEN "BCL" ELSE "INT");                  35550900
%                                                                       35551000
          IF BL(IOD.[23:1]) AND SZ NEQ IOD.[SF] THEN                    35551100
               WRITE(OUTFI[DBL],SIZERRORF,SZ);                          35551200
          WRITE(OUTFI[DBL]);                                            35551300
          IF SZ=0 THEN WRITE(OUTFI[DBL],NOTRANSF) ELSE                  35551400
          BEGIN                                                         35551500
               IF IOD1.[FF] NEQ EMPTY THEN                              35551600
                    IF COMPAREDATA:=BIGCOMPARE(SZ&IOD[1:22:1],          35551700
                         IOD.[CF],DBUFF+(SZ-1)|IOD.[22:1],NT4,NT5,NT6)  35551800
                    THEN                                                35551900
                    BEGIN                                               35552000
                         WRITE(OUTFI[DBL],BWTF,WLIST);                  35552100
                         WRITE(OUTFI[DBL]);                             35552200
                         MOVEANDWRITE(TRUE,SZ,FALSE,OUTFI,IOD.[CF]-     35552300
                              (SZ-1)|IOD.[22:1]);                       35552400
                         WRITE (OUTFI[DBL] );                           35552450
                         WRITE(OUTFI[DBL],DIFF,NT4,NT6,NT5);            35552500
                         WRITE(OUTFI[DBL]);                             35552600
                    END ELSE                                            35552700
                    BEGIN                                               35552800
                         WRITE(OUTFI[DBL],OKWTF,WLIST);                 35552900
                         WRITE(OUTFI[DBL]);                             35553000
                    END                                                 35553100
               ELSE                                                     35553200
               BEGIN                                                    35553300
                    WRITE(OUTFI[DBL],WTF,WLIST);                        35553400
                    WRITE(OUTFI[DBL]);                                  35553500
                    MOVEANDWRITE(TRUE,SZ,FALSE,OUTFI,                   35553600
                         IOD.[CF]-(SZ-1)|IOD.[22:1]);                   35553700
                    WRITE(OUTFI[DBL]);                                  35553800
               END;                                                     35553900
          END;                                                          35554000
          END;                                                          35554100
%***********************************************************************35554500
     PROCEDURE TAPERROR(IOD,RESULT,MASK,KEY);                           35560000
          VALUE IOD,MASK,KEY;                                           35570000
          REAL IOD,RESULT,MASK; INTEGER KEY;                            35580000
          BEGIN                                                         35590000
          DEFINE R=RESULT#,                                             35600000
                 RL=REAL#;                                              35610000
          INTEGER E;                                                    35620000
          BOOLEAN RETRYTOG,PGE;                                         35630000
          OWN INTEGER RTYCOUNT;                                         35640000
          LABEL SIX,XIT,SPOUT,TAPEPARITY,IODS,PAGECHECK;                35650000
          FORMAT                                                        35660000
               ULF(50("-")),     SULF(*("-")," ",*("-")),               35670000
               NOTRANSF("NO DATA TRANSFERED ON READ"),                  35680000
               BLNKTPEF(X24,"BLANK TAPE ON WRITE"),                     35690000
               ERRF(A*," FAILURE"),                                     35700000
               NOERRF(X24,"NO ERROR BITS"),                             35710000
               BLNKTPERF(X24,"BLANK TAPE ON READ"),                     35720000
               D20F(X24,"PARITY - D20"),                                35730000
               D20AEF(X24,"PARITY - D20 (AS EXPECTED)"),                35740000
               RESF(X8,"RESULT DESC. = "),                              35750000
               IODF(X8,"I/O DESC.    = "),                              35760000
               RETYF("ANALYSIS I/O #",I2," ",A5),                       35770000
               ORIGF("ANALYSIS I/O #0 (ORIGINAL I/O)"),                 35780000
               BLKF("*ORIGINAL I/O ON BLOCK #",I3," WAS:"),             35790000
               ORIGINALF("*ORIGINAL I/O"),                              35800000
               BOTAEF("BOT (AS EXPECTED)"),                             35810000
               BOTF(X24,"BOT"),                                         35820000
               EOTF(X24,"EOT"),                                         35830000
               TAPEMARKEXPF("TAPE MARK RECORD EXPECTED"),               35831000
               EOTAEF("EOT (AS EXPECTED)"),                             35840000
               EOFF(X24,"EOF - D21"),                                   35850000
               EOFAEF(X24,"EOF - D21 (AS EXPECTED)"),                   35860000
               EXPF(I4," WORDS EXPECTED WERE(",A3,")-"),                35880000
               D19F(X24,"MEMORY PARITY - D19"),                         35890000
               WRTLOCKF(X24,A3,"-WRITE LOCK"),                          35900000
               D17F(X24,"MEMORY PARITY - D17"),                         35910000
               SUCCESSF("COMMENT:",/,X9,                                35920000
                        "-RETRY WAS SUCCESSFUL",/,X9,                   35921000
                        "-RETRY ROUTINE EXITED"),                       35922000
               IRRECOVRF("COMMENT:",/,X9                                35923000
                         "-FAILURE WAS IRRECOVERABLE",/,X9,             35924000
                         "-RETRY ROUTINE EXITED"),                      35925000
               BLNKTPEIRREC("COMMENT:",/,X9                             35926000
                         "-BLANK TAPE",/,X9                             35927000
                         "-RETRY ROUTINE EXITED"),                      35928000
               NOTRY("COMMENT:",/,X9,                                   35929000
                     "-NO RETRYS ATTEMPTED ON THIS TYPE I/O ",          35930000
                          "AND FAILURE",/,X9,                           35931000
                     "-ERROR ROUTINE EXITED"),                          35932000
               STRANGE("COMMENT:",/,X9                                  35950000
                       "-RECORD WAS INTENTIONALLY READ IN ",            35951000
                       "INCORRECT PARITY",/,X9,                         35952000
                       "-NO RETRIES WERE ATTEMPTED",/,X9,               35953000
                       "-ERROR ROUTINE EXITED"),                        35954000
                ODD("COMMENT: ODD SITUATION",/,                         35960000
                    "         -COULD NOT READ RECORD WITH ORIGINAL",    35970000
                         " I/O BUT COULD WITH THIS ONE",/,              35980000
                    "         -RETRY ROUTINE WAS EXITED"),              35990000
               BAD("COMMENT: BAD SITUATION",/,                          36000000
                    "         -DATA READ WAS INCORRECT",/,              36010000
                    "         -SINCE HARDWARE DETECTED NO ",            36020000
                    "ERROR CONDITIONS, RETRY ROUTINE WAS EXITED"),      36030000
               INVADDRF(X16,"INVALID ADDR - D22");                      36040000
          STREAM PROCEDURE IODANA(OP,DIRECT,TOG,MODE,SIZE,A,B);         36050000
               VALUE OP,DIRECT,TOG,MODE,SIZE;                           36060000
               BEGIN                                                    36070000
               LOCAL T1;                                                36080000
               LABEL L;                                                 36090000
               SI:=LOC OP; DI:=LOC T1; DI:=DI+7; DS:=CHR;               36100000
               DI:=B;                                                   36110000
               SI:=SI+7; SI:=SI-T1; DS:=T1 CHR; DS:=LIT " ";            36120000
               SI:=LOC DIRECT; SI:=SI+7;                                36130000
               IF SC="1" THEN DS:=7 LIT "FORWARD" ELSE                  36140000
               IF SC="2" THEN DS:=7 LIT "REVERSE";                      36150000
               TOG(DS:=LIT "("; SI:=LOC MODE; SI:=SI+7;                 36160000
                   IF SC="2" THEN DS:=6 LIT "BINARY" ELSE               36170000
                   IF SC="1" THEN DS:=5 LIT "ALPHA";                    36180000
                   SI:=LOC SIZE; TALLY:=8;                              36190000
                   8(IF SC="0" THEN                                     36200000
                     BEGIN TALLY:=TALLY+63; SI:=SI+1 END ELSE           36210000
                     JUMP OUT);                                         36220000
                   T1:=TALLY;                                           36230000
                   T1(DS:=LIT ","; DS:=T1 CHR; DS:=6 LIT " WORDS";      36240000
                      JUMP OUT);                                        36250000
               DS:=LIT ")");                                            36260000
               DS:=6 LIT " WITH ";                                      36270000
               SI:=A;                                                   36280000
          L:   IF SC=" " THEN BEGIN SI:=SI+1; IF SC NEQ " " THEN        36290000
               BEGIN DS:=LIT " "; DS:=CHR; GO L; END END ELSE           36300000
               BEGIN DS:=CHR; GO L; END;                                36310000
               DS:=9 LIT " EXPECTED";                                   36320000
          END;                                                          36330000
          PROCEDURE IODANALYZ(KEY,JUNK,IOD,MASK);                       36340000
               VALUE KEY,JUNK,IOD,MASK;                                 36350000
               INTEGER KEY; REAL JUNK,IOD,MASK;                         36360000
               BEGIN                                                    36370000
               DEFINE BUFFS=JUNKBUFFER[0],OUTBUFFER#;                   36380000
               FORMAT BOTF("BOT"),                                      36390000
                      EOTF("EOT"),                                      36400000
                      EOFF("EOF - D21"),                                36410000
                      D20F("PARITY - D20"),                             36420000
                      NOERRF("NO ERROR BITS");                          36430000
                    CLEAR(OUTBUFFER,WBUFF);                             36440000
                    IF KEY=6 THEN KEY:=3;                               36450000
                    IF BL(MASK.[27:1]) THEN                             36460000
                         IF BL(MASK.[29:1]) THEN                        36470000
                              IF BL(IOD.[22:1]) THEN                    36480000
                              WRITE(JUNKBUFFER[*],BOTF)                 36490000
                              ELSE WRITE(JUNKBUFFER[*],EOTF)            36500000
                         ELSE WRITE(JUNKBUFFER[*],EOFF)                 36510000
                    ELSE                                                36520000
                         IF BL(MASK.[28:1]) THEN                        36530000
                              WRITE(JUNKBUFFER[*],D20F)                 36540000
                         ELSE                                           36550000
                              WRITE(JUNKBUFFER[*],NOERRF);              36560000
                    CASE KEY-1 OF                                       36570000
                    BEGIN                                               36580000
                         IODANA(JUNK,1+IOD.[22:1],1,1+IOD.[21:1],       36590000
                              DECMAL(IOD.[SF]),BUFFS);                  36600000
                         IODANA(JUNK,0,1,1+IOD.[21:1],DECMAL(IOD.[SF]), 36610000
                              BUFFS);                                   36620000
                         IODANA(JUNK,1+IOD.[22:1],1,1+IOD.[21:1],       36630000
                              0,BUFFS);                                 36640000
                         IODANA(JUNK,0,1,1+IOD.[21:1],DECMAL(IOD.[SF]), 36650000
                              BUFFS);                                   36660000
                         IODANA(JUNK,0,0,0,0,BUFFS);                    36670000
                    END;                                                36680000
                    WRITE(OUTFI,WBUFF,OUTBUFFER[*]);                    36690000
               END;                                                     36700000
          DEFINE IODANALYZER=IODANALYZ(KEY,JUNK,IOD,MASK)#;             36710000
     %CHECK FOR EOT AND BOT                                             36720000
          IF BL(R.[2:1]) AND BL(R.[29:1]) THEN                          36730000
          BEGIN                                                         36740000
               MOD3IOS:=TRUE;                                           36750000
               IF R.[13:2] NEQ 0 THEN                                   36760000
               BEGIN                                                    36770000
               R.[27:1]:=1;                                             36780000
               IF RL((NOT BL(MASK.[25:8])) AND (BL(R.[25:8])))          36790000
                     =0 THEN                                            36800000
               IF NOT BL(MASK.[1:1]) THEN                               36810000
               BEGIN R:=-R; GO XIT; END;                                36820000
               R.[27:1]:=0;                                             36830000
               END;                                                     36840000
          END;                                                          36850000
          IF NOT PGE:=(IOD GTR 0 AND NOT BL(MASK.[1:1])) THEN IOD:=     36860000
               ABS(IOD);                                                36870000
          FILL JUNKBUFFER[*] WITH                                       36880000
               "4000READ",                                              36890000
               "500WRITE",                                              36900000
               "500SPACE",                                              36910000
               "500ERASE",                                              36920000
               "60REWIND",                                              36930000
               "500SPACE";                                              36940000
          IF BL(MASK.[1:1]) THEN                                        36950000
          BEGIN                                                         36960000
               JUNK:=JUNKBUFFER[KEY-1];                                 36970000
               WRITE(OUTFI[DBL]); WRITE(OUTFI);                         36980000
               WRITE(OUTFI[DBL],RETYF,RTYCOUNT:=RTYCOUNT+1,             36990000
                    IF R.[25:8]=MASK.[25:8] OR KEY=3 THEN "     " ELSE  37000000
                    "(BAD)");                                           37010000
          END                                                           37020000
          ELSE                                                          37030000
          BEGIN                                                         37040000
               RTYCOUNT:=0;                                             37050000
               ERROR:=ERROR+1; ERRORS:=ERRORS+1;                        37060000
               IF IGNORERRORS THEN GO XIT;                              37061000
               WRITE(OUTFI,ERRF,(JUNK:=JUNKBUFFER[KEY-1]).[1:5],        37070000
                     JUNK);                                             37080000
               WRITE(OUTFI,SULF,JUNK.[1:5],7);                          37090000
               WRITE(OUTFI[DBL]);                                       37100000
               WRITE(OUTFI[DBL],BLKF,TRANS+IOD.[22:1]);                 37110000
               IODANALYZER;                                             37120000
               WRITE(OUTFI[DBL]);                                       37130000
               IF KEY=1 THEN                                            37140000
               IF P:=IOD1.[FF] NEQ EMPTY THEN                           37150000
               BEGIN                                                    37160000
                    GETPATTERN(P,1);                                    37170000
                    WRITE(OUTFI[DBL],EXPF,E:=IOD.[SF],                  37180000
                         IF BCL THEN "BCL" ELSE "INT");                 37190000
                    WRITE(OUTFI[DBL]);                                  37200000
                    MOVEANDWRITE(TRUE,E,FALSE,OUTFI,DBUFF);             37210000
                    WRITE(OUTFI[DBL]);                                  37220000
               END ELSE                                                 37230000
               IF BL(MASK.[27:1]) THEN                                  37230010
               BEGIN                                                    37230020
                    WRITE(OUTFI[DBL],TAPEMARKEXPF);                     37230030
                    WRITE(OUTFI[DBL]);                                  37230040
               END;                                                     37230050
               IF ABREV THEN GO IODS;                                   37230100
               WRITE(OUTFI[DBL],ULF);                                   37240000
               WRITE(OUTFI[DBL],ORIGF);                                 37250000
          END;                                                          37260000
          IF MASK.[46:2] LSS 3 THEN IODANALYZER ELSE                    37270000
          WRITE(OUTFI,ORIGINALF);                                       37280000
     IODS:                                                              37285000
          WRITE(OUTBUFFER[*],IODF);                                     37290000
          EDIT(1,IOD,OUTBUFFER[3],0,1,JUNK,JUNK,0);                     37300000
          WRITE(OUTFI,6,OUTBUFFER[*]);                                  37310000
          WRITE(OUTBUFFER[*],RESF);                                     37320000
          EDIT(1,RESULT,OUTBUFFER[3],0,1,JUNK,JUNK,0);                  37330000
          WRITE(OUTFI[DBL],6,OUTBUFFER[*]);                             37340000
          IF E:=RESULT.[25:8]=0 THEN                                    37350000
               WRITE(OUTFI,NOERRF)                                      37360000
          ELSE                                                          37370000
          BEGIN                                                         37380000
               IF BL(E.[46:1]) THEN                                     37390000
               BEGIN                                                    37400000
                    WRITE(OUTFI,D17F);                                  37410000
                    GO SIX;                                             37420000
               END;                                                     37430000
               IF BL(E.[44:1]) THEN                                     37440000
               IF BL(R.[2:1]) THEN                                      37450000
               BEGIN                                                    37460000
                    MOD3IOS:=TRUE;                                      37470000
                    IF BL(R.[11:1]) THEN                                37480000
                    BEGIN                                               37490000
                         WRITE(OUTFI,D19F);                             37500000
                         GO SIX;                                        37510000
                    END;                                                37520000
                    IF BL(R.[24:1]) THEN %READ                          37530000
                    BEGIN                                               37540000
                         IF BL(R.[13:1]) THEN %BOT                      37550000
                         BEGIN                                          37560000
                              R.[27:1]:=1;                              37570000
                              IF BL(MASK.[29:1]) THEN                   37580000
                              WRITE(OUTFI,BOTAEF) ELSE                  37590000
                              WRITE(OUTFI,BOTF);                        37600000
                              GO SIX;                                   37610000
                         END ELSE                                       37620000
                         IF BL(R.[14:1]) THEN                           37630000
                         BEGIN                                          37640000
                              IF BL(MASK.[29:1]) THEN                   37650000
                              WRITE(OUTFI,EOTAEF) ELSE                  37660000
                              WRITE(OUTFI,EOTF);                        37670000
                              R.[27:1]:=1;                              37680000
                              IF RL(BL(E) AND BL(..367))=0 THEN         37690000
                              GO SIX;                                   37700000
                         END;                                           37710000
                    END ELSE                                            37720000
                    BEGIN                                               37730000
                         IF BL(R.[12:1]) THEN %BLANK TAPE               37740000
                         BEGIN                                          37750000
                              WRITE(OUTFI,BLNKTPEF);                    37760000
                              GO SIX;                                   37770000
                         END;                                           37780000
                         IF BL(R.[14:1]) THEN                           37790000
                         BEGIN                                          37800000
                              IF BL(MASK.[29:1]) THEN                   37810000
                              WRITE(OUTFI,EOTAEF) ELSE                  37820000
                              WRITE(OUTFI,EOTF);                        37830000
                              R.[27:1]:=1;                              37840000
                         END;                                           37850000
                    END;                                                37860000
                    END ELSE                                            37870000
                    BEGIN                                               37880000
                         WRITE(OUTFI,D19F);                             37890000
                         GO SIX;                                        37900000
                    END;                                                37910000
                    IF BL(R.[24:1]) THEN %READ                          37920000
                    BEGIN                                               37930000
                         IF BL(E.[41:1]) THEN                           37940000
                         BEGIN                                          37950000
                              WRITE(OUTFI,INVADDRF);                    37960000
                              GO SIX;                                   37970000
                         END;                                           37980000
                         IF BL(R.[27:1]) THEN                           37990000
                         BEGIN                                          38000000
                              IF BL(MASK.[27:1]) THEN                   38010000
                              WRITE(OUTFI,EOFAEF) ELSE                  38020000
                              WRITE(OUTFI,EOFF);                        38030000
                              IF NOT BL(R.[28:1]) THEN                  38040000
                              GO SIX;                                   38050000
                         END;                                           38060000
          TAPEPARITY:                                                   38070000
                         IF ABS(KEY) LEQ 2 THEN                         38080000
                         RETRYTOG:=TRUE;                                38090000
                         IF BL(E.[43:1]) THEN                           38100000
                              BEGIN                                     38110000
                                   IF RETRYTOG:=NOT BL(MASK.[28:1]) THEN38120000
                                        WRITE(OUTFI,D20F) ELSE          38130000
                                        WRITE(OUTFI,D20AEF);            38140000
                              END                                       38150000
                         ELSE                                           38160000
                              WRITE(OUTFI,BLNKTPERF);                   38170000
                         GO SIX;                                        38180000
                    END;                                                38190000
                    IF BL(E.[41:1]) THEN                                38200000
                    IF BL(E.[43:1]) THEN                                38210000
                    BEGIN                                               38220000
                         WRITE(OUTFI,WRTLOCKF,UNAME(UNIT));             38230000
                         GO SIX;                                        38240000
                    END ELSE                                            38250000
                    BEGIN                                               38260000
                         WRITE(OUTFI,INVADDRF);                         38270000
                         GO SIX;                                        38280000
                    END;                                                38290000
                    IF RETRYTOG:=BL(E.[43:1]) THEN GO TAPEPARITY;       38300000
               END;                                                     38310000
          SIX:                                                          38320000
               IF BL(MASK.[1:1]) AND NOT BL(MASK) THEN GO XIT;          38330000
                    IF KEY=1 THEN                                       38340000
                    BEGIN                                               38350000
                         IF(NOT BL(MASK.[1:1])) OR BL(MASK) THEN        38360000
                         BEGIN                                          38370000
                              FUNNYMOVE(1,IOD.[CF]-1&IOD[1:22:1],       38380000
                                   NT1);                                38390000
                              READERROR(IOD,NT1);                       38400000
                         END;                                           38410000
                    END;                                                38420000
                    IF BL(MASK.[1:1]) OR ABREV THEN GO PAGECHECK;       38421000
                    IF RETRYTOG THEN                                    38430000
                    BEGIN                                               38440000
                            WRITE(OUTFI[DBL]);                          38441000
                         NT2:=TAPEPARITYRETRY(R,IOD);                   38450000
                         IF KEY=1 THEN                                  38460000
                         BEGIN                                          38470000
                              IF E:=NT2.[CF]=64 OR E=128 THEN           38480000
                                   NT1:=NT2.[FF] ELSE                   38490000
                              FUNNYMOVE(1,IOD.[CF]-1&IOD                38500000
                                   [1:22:1],NT1);                       38510000
                              IF E=0 THEN                               38520000
                                   IF COMPAREDATA THEN                  38530000
                                        WRITE(OUTFI,BAD)                38540000
                                   ELSE                                 38550000
                                        WRITE(OUTFI,SUCCESSF)           38560000
                              ELSE                                      38570000
                              IF E=16 THEN                              38580000
                                   WRITE(OUTFI,IRRECOVRF)               38590000
                              ELSE                                      38600000
                              IF E=32 THEN                              38610000
                                   WRITE(OUTFI,BLNKTPEIRREC)            38620000
                              ELSE                                      38630000
                              BEGIN                                     38640000
                                   READERROR(IOD,NT1);                  38650000
                                   IF E=8 OR E=128 THEN                 38660000
                                        WRITE(OUTFI,ODD)                38670000
                                   ELSE                                 38680000
                                   IF COMPAREDATA THEN                  38690000
                                        WRITE(OUTFI,BAD)                38700000
                                   ELSE                                 38710000
                                        WRITE(OUTFI,ODD);               38720000
                              END;                                      38730000
                         END                                            38740000
                         ELSE                                           38750000
                         BEGIN                                          38760000
                              IF NT2.[CF]=0 THEN                        38770000
                                   WRITE(OUTFI,SUCCESSF) ELSE           38780000
                                   WRITE(OUTFI,IRRECOVRF);              38790000
                         END;                                           38800000
                         COMPAREDATA:=FALSE;                            38801000
                         WRITE(OUTFI[DBL]);                             38802000
                    END ELSE                                            38810000
               BEGIN                                                    38830000
                    WRITE(OUTFI[DBL]);                                  38831000
                    IF BL(MASK.[28:1]) AND                              38840000
                         BL(R.[28:1]) THEN                              38850000
                    WRITE(OUTFI,STRANGE) ELSE                           38860000
                    WRITE(OUTFI,NOTRY);                                 38870000
                    COMPAREDATA:=FALSE;                                 38871000
                    WRITE(OUTFI[DBL]);                                  38872000
               END;                                                     38880000
          PAGECHECK:                                                    38885000
               IF PGE THEN                                              38910000
               IF PAGE THEN WRITE(OUTFI[PAGE]) ELSE                     38920000
               WRITE(OUTFI[DBL],STAR);                                  38930000
          XIT: END;                                                     38940000
%***********************************************************************38950000
     REAL PROCEDURE TAPEPARITYRETRY(R,OIOD); VALUE R,OIOD;              38960000
          REAL R,OIOD;                                                  38970000
          BEGIN                                                         38980000
          REAL                                                          38990000
               T1,T2,T3,Z,Y,SIZE,LIMIT;                                 39000000
          BOOLEAN OT;                                                   39010000
          INTEGER I;                                                    39020000
          OWN INTEGER MSK,KEY;                                          39021000
          OWN REAL RESULT,IOD,SPACEMASK,SPACEIOD,M,W,MODE,N;            39030000
          OWN REAL J,K;                                                 39040000
          DEFINE ERASEIOD=SPACEMASK#;                                   39050000
          OWN REAL BSIZE;                                               39060000
          DEFINE RL=REAL#;                                              39070000
          LABEL                                                         39100000
                GIVEUP,                                                 39110000
                RP,                                                     39120000
               LP,                                                      39130000
                LX;                                                     39140000
          OWN REAL T4;                                                  39150000
          LABEL XIT;                                                    39160000
          SWITCH SW:=GIVEUP,XIT;                                        39170000
          BOOLEAN PROCEDURE DOTHEIONOW(R,OT); VALUE R;                  39180000
               REAL R; BOOLEAN OT;                                      39190000
               BEGIN                                                    39200000
               LABEL XIO;                                               39210000
               INTEGER Y;                                               39220000
               FOR Y:=1 STEP 1 UNTIL 18 DO                              39230000
                    BEGIN                                               39240000
                         IF BL(R.[24:1]) THEN                           39250000
                         BEGIN                                          39260000
                              IF OT THEN GETPATTERN(-EMPTY,B);          39261000
                              WHILE T4 GTR TIME(1) DO                   39270000
                              WHEN(0);                                  39280000
                              T4:=TIME(1)+4;                            39290000
                         END;                                           39300000
                         STARTAPEIO(IOD,RESULT);                        39310000
                         IF OT THEN MSK:=MSK&R[27:27:1];                39311000
                         IOFINISH(IOD,RESULT,-RL(OT)&MSK[25:40:8],KEY); 39320000
                         MSK.[27:1]:=0;                                 39321000
                         IF BL(RESULT.[29:1]) AND BL(RESULT.[2:1]) THEN 39330000
                         BEGIN                                          39340000
                              IF BL(RESULT.[12:1]) THEN                 39350000
                              IF BL(IOD.[24:1]) THEN                    39360000
                              TRANS:=TRANS-1&IOD[1:22:1] ELSE           39370000
                              BEGIN                                     39380000
                                   DOTHEIONOW:=TRUE;;                   39390000
                                   MODE:=16;                            39400000
                              END ELSE                                  39410000
                              IF BL(RESULT.[11:1]) THEN  %MEM PAR       39420000
                              BEGIN                                     39430000
                                   MODE:=16;                            39440000
                                   DOTHEIONOW:=TRUE;                    39450000
                                   GO XIO;                              39460000
                              END;                                      39470000
                              IF RESULT.[13:2] NEQ 0 THEN Y:=18;        39480000
                         END ELSE                                       39490000
                         GO TO XIO;                                     39500000
                    END;                                                39510000
                    RESULT.[27:1]:=1; MODE:=32;                         39520000
          XIO: OT:=FALSE; END OF DOTHEIONOW;                            39530000
          DEFINE DOIONOW=                                               39540000
               BEGIN IF DOTHEIONOW(R,OT) THEN GO XIT;END#;              39550000
          INTEGER PROCEDURE SPACEITBACK(R,OIOD,OT); VALUE R,OIOD;       39560000
               REAL R,OIOD; BOOLEAN OT;                                 39570000
               BEGIN                                                    39580000
               LABEL XIS;                                               39590000
               LIST BSIZEL(BSIZE);                                      39591000
               DEFINE DOIONOW=IF DOTHEIONOW(R,OT) THEN                  39600000
                           BEGIN SPACEITBACK:=2; GO XIS; END#;          39610000
               FORMAT ERASERRF("COMMENT: ERASE ERROR DETECTED",         39620000
                               /,X9,"-AFTER RETRY, LENGTH OF ",         39630000
                               "PRECEDING RECORD=",I4,", NOT SAME ",    39640000
                               "AS BEFORE (BAD)",/,X9,                  39641000
                               "-GARBAGE WAS APPARENTLY LEFT IN ",      39641100
                               "AREA ERASED"),                          39641200
                     WHATSUP("COMMENT: THE FOLLOWING SPACING ",         39641300
                           "OPERATIONS ARE PERFORMED TO:",/,X9,         39641400
                             "A) CHECK THE LENGTH OF THE PRECEDING ",   39641500
                             "RECORD",/,X9,                             39641600
                             "B) POSITION THE TAPE TO ERASE THE ",      39641700
                             "BAD RECORD - BACKSPACING IS DONE ",       39641800
                             "UNTIL ",/,X12,                            39641900
                             "NUMBER OF WORDS SPACED OVER EXCEEDS",     39641910
                             " NUMBER OF WORDS WRITTEN OR ",            39641920
                             "UNTIL EOF"),                              39641930
                      PRECF("COMMENT: BEFORE RETRY, LENGTH OF ",        39642000
                            "PRECEDING RECORD=",I4,", REMEMBERED ",     39642100
                            "FOR TEST FURTHER ON"),                     39642200
                      PRECF1("COMMENT: AFTER RETRY, LENGTH OF ",        39642300
                             "PRECEDING RECORD=",I4,", SAME AS ",       39642400
                             "BEFORE (GOOD)");                          39642500
               IF TRANS=1 THEN %FIRST RECORD SO REWIND.....             39650000
               BEGIN                                                    39660000
                    IOD:=..4200000000&OIOD[3:3:5];                      39670000
                    DOIONOW;                                            39680000
               END ELSE                                                 39690000
               BEGIN                                                    39700000
                    IF N GTR 0 THEN WRITE(OUTFI[DBL]);                  39700050
                    WRITE(OUTFI,WHATSUP); WRITE(OUTFI[DBL]);            39700100
                    M:=W;                                               39710000
                    KEY:=3;                                             39720000
                    IOD:=SPACEIOD;                                      39730000
                    J:=0;                                               39740000
                    DO BEGIN                                            39750000
                         DOIONOW;                                       39760000
                         TRANS:=TRANS+1;                                39770000
                         J:=J+1;                                        39780000
                    END UNTIL((M:=RESULT.[CF]-SPACEIOD.[CF]+M) LSS 0    39790000
                         OR BL(RESULT.[27:1])) AND J GTR 1;             39800000
                    TRANS:=TRANS-2;                                     39810000
                    IOD:=SPACEIOD&0[22:47:1];                           39820000
                    DOIONOW;                                            39830000
                    WRITE(OUTFI[DBL]);                                  39831000
                    IF N=0 THEN                                         39840000
                         WRITE(OUTFI[DBL],PRECF,BSIZE:=                 39841000
                              RESULT.[CF]-IOD.[CF])                     39842000
                    ELSE                                                39843000
                    IF BSIZE NEQ BSIZE:=RESULT.[CF]-IOD.[CF] THEN       39850000
                    BEGIN                                               39860000
                         WRITE(OUTFI,ERASERRF,BSIZEL);                  39880000
                         WRITE(OUTFI[DBL]);                             39890000
                         SPACEITBACK:=1;                                39900000
                         GO XIS;                                        39901000
               END ELSE                                                 39910000
                    WRITE(OUTFI[DBL],PRECF1,BSIZEL);                    39911000
               END;                                                     39920000
          XIS: END OF SPACEITBACK;                                      39930000
          STREAM PROCEDURE ROTO2(Z,Y,S,SK,FL,FK,D);                     39940000
               VALUE Z,Y,S,SK,FL,FK,D;                                  39950000
               BEGIN                                                    39960000
                    SI:=S; SI:=SI+SK; DI:=D; DI:=DI+7;                  39970000
                    Y(16(32(DS:=CHR; SI:=SI-2; DI:=DI-2)));             39980000
                    Z(8(DS:=CHR; SI:=SI-2; DI:=DI-2));                  39990000
                    SI:=LOC FL; SI:=SI+7;                               39991000
                    FK(DS:=CHR; SI:=SI-1; DI:=DI-2);                    39992000
               END;                                                     40000000
          DEFINE SPACEBACK=GO SW[SPACEITBACK(R,OIOD,OT)]#;              40010000
          FORMAT                                                        40020000
               BACKF("COMMENT: AT THIS POINT THE TAPE WAS ",            40040000
                    "SPACED INTO THE VACUUM COLUMN AND ",/,             40050000
                     X9,"THEN SPACED BACK TO BLOCK #",I4),              40060000
               MOVEDF("INFORMATION MOVED TO ",A*," OF BUFFER ",         40070000
                      "TO AGREE WITH ORIGINAL I/O");                    40080000
     %                                                                  40090000
               MSK:=KEY:=MODE:=W:=J:=K:=BSIZE:=N:=T4:=0;                40091000
                    %INITIALIZE "OWN" VARIABLES NOT INITIALIZED         40092000
                    %ELSEWHERE                                          40093000
               IF BL(R.[24:1]) THEN %READ ERROR                         40100000
               BEGIN                                                    40110000
                    SPACEMASK:=REAL(BL(OIOD.[21:2]|..1111) EQV          40120000
                         NOT BL(..0123));                               40130000
                    SPACEIOD:=OIOD&1[8:38:10]&1[23:47:1];               40140000
                    FOR M:=1 STEP 1 UNTIL 2 DO                          40150000
                    BEGIN SPACEIOD:=SPACEIOD&SPACEMASK[21:46:2];        40160000
                       MSK:=16; KEY:=1;                                 40170000
                       FOR N:=1 STEP 1 UNTIL 2 DO                       40180000
                         BEGIN IOD:=SPACEIOD;                           40190000
                         IF N+M GTR 2 THEN                              40200000
                    LP:   BEGIN                                         40210000
                              DOIONOW;                                  40220000
                    END ELSE                                            40230000
                         IF NOT (BL(R.[29:1]) AND BL(R.[2:1]) AND       40240000
                              BL(R.[12:1])) THEN GO LP;                 40250000
                         IF BL(RESULT.[28:1]) THEN                      40260000
                              BEGIN                                     40270000
                              OT:=BL(3);                                40280000
                              MSK:=MODE:=0; IOD:=OIOD;                  40290000
                              END                                       40300000
                         ELSE                                           40310000
                              BEGIN; MODE:=8;                           40320000
                              MSK:=16;                                  40330000
                                   IOD:=OIOD&SPACEMASK[21:43:2];        40340000
                              END;                                      40350000
                         DOIONOW;                                       40360000
                         IF NOT BL(RESULT.[28:1]) THEN GO XIT;          40370000
                         IF MOD3IOS THEN IF BL(OIOD.[23:1]) THEN        40380000
                         BEGIN                                          40390000
                              MSK:=0;                                   40400000
                              Z:=IOD:=OIOD&SPACEMASK[21:40:2]&          40420000
                                 (OIOD.[CF]+(OIOD.[8:10]-1)&            40430000
                                 OIOD[1:22:1])[CTC];                    40440000
                              DOIONOW; MODE:=64;                        40450000
                              IF BL(RESULT.[28:1]) THEN                 40460000
                              BEGIN                                     40470000
                                   OT:=BL(3); MODE:=0;                  40480000
                                   IOD:=OIOD; DOIONOW;                  40490000
                                   IF NOT BL(RESULT.[28:1]) THEN GO XIT;40500000
                                   IOD:=Z&SPACEMASK[21:46:2];           40510000
                                   MSK:=16;                             40520000
                                   DOIONOW; MODE:=128;                  40530000
                                   IF BL(RESULT.[28:1]) THEN            40540000
                                   BEGIN IOD:=OIOD&SPACEMASK[21:43:2];  40550000
                                        MODE:=8;                        40560000
          RP:                                                           40570000
                                        Z:=0;                           40580000
                                        DOIONOW;                        40590000
                                        IF BL(RESULT.[28:1]) THEN       40600000
                                           GO TO LX ELSE GO XIT;        40610000
                                   END;                                 40620000
                              END;                                      40630000
                              Z:=ABS(IOD.[CF]-RESULT.[CF]);             40640000
                              IF IOD.[21:2]=0 THEN                      40650000
                                Z:=Z-REAL(RESULT.[15:3]=0);             40660000
                              IF IOD.[8:10] LSS Z THEN                  40670000
                                   BEGIN                                40680000
                                   OT:=BL(3);                           40690000
                                   IOD:=OIOD; MODE:=0;                  40700000
                                   GO RP;                               40710000
                                   END;                                 40720000
                              IF BL(IOD.[22:1]) THEN                    40730000
                              ROTO1(Z,Z DIV 64,RESULT.[CF]+1,           40740000
                                    (RESULT.[15:3]+1).[45:3],           40750000
                                    IF BL(IOD.[21:1]) THEN 0            40760000
                                       ELSE ..37,OIOD.[CF]) ELSE        40770000
                              ROTO2(Z,Z DIV 64,RESULT.[CF]-1,           40780000
                                    (RESULT.[15:3]+7).[45:3],           40790000
                                    IF BL(IOD.[21:1]) THEN 0            40800000
                                      ELSE ..14,(8-RESULT.[15:3])       40810000
                                   .[45:3],OIOD.[CF]);                  40820000
                              MSK:=EMPTY;                               40830000
                              WRITE(OUTFI[DBL]);                        40831000
                              WRITE(OUTFI[DBL],MOVEDF,IF                40840000
                                 BL(IOD.[22:1]) THEN                    40850000
                                        5 ELSE 4,                       40860000
                                   IF BL(IOD.[22:1]) THEN               40870000
                                        "FRONT" ELSE "BACK");           40880000
                              IOD:=..140000005&OIOD[21:21:2]&           40890000
                                   OIOD[3:3:5];                         40900000
                              DOIONOW; GO XIT;                          40910000
          LX:            END;                                           40920000
                    END;                                                40930000
                    MSK:=EMPTY;                                         40940000
                    N:=IF TRANS LSS 15 THEN TRANS ELSE 15;              40950000
                    IOD:=SPACEIOD&SPACEMASK[21:40:2];                   40960000
                    FOR W:=1 STEP 1 UNTIL N DO                          40970000
                        BEGIN DOIONOW;                                  40980000
                             IF BL(RESULT.[27:1]) THEN N:=0;            40990000
                        END;                                            41000000
                    IOD:=SPACEIOD&SPACEMASK[21:37:2];                   41010000
                    FOR N:=3 STEP 1 UNTIL W DO DOIONOW;                 41020000
                    OT:=BL(3);                                          41030000
                    MSK:=0;                                             41040000
                    WRITE(OUTFI[DBL]);                                  41050000
                    WRITE(OUTFI,BACKF,TRANS+ABS(OIOD.[22:1]-1));        41060000
                    WRITE(OUTFI[DBL]);                                  41070000
                    IOD:=OIOD; MODE:=0; DOIONOW;                        41080000
                    IF NOT BL(RESULT.[28:1]) THEN GO XIT;               41090000
               END;                                                     41100000
               MODE:=16;                                                41110000
          END ELSE BEGIN   %WRITE PARITY                                41120000
               LIMIT:=..10000;                                          41130000
               ERASEIOD:=(SPACEIOD:=OIOD&0[8:38:10]&7[22:45:3]&         41140000
                    COREADDR(T2)[CTC])&..112[18:41:7];                  41150000
               W:=R.[CF]-OIOD.[CF]+2;                                   41160000
               WHILE TRUE DO                                            41170000
               BEGIN                                                    41180000
                    SPACEBACK;                                          41190000
                    IF (N:=N+W+128) GTR LIMIT THEN GO GIVEUP;           41200000
                    IOD:=ERASEIOD&N[9:39:9];                            41210000
                    KEY:=4;                                             41220000
                    FOR J:=0 STEP 512 UNTIL N DO                        41230000
                    BEGIN TRANS:=TRANS-1;                               41240000
                         DOIONOW;                                       41250000
                         IOD:=ERASEIOD&1[8:47:1];                       41260000
                         IF BL(RESULT.[27:1]) THEN                      41270000
                         BEGIN                                          41280000
                              IF NOT BL(R.[27:1]) THEN LIMIT:=J+3000;   41290000
                              R.[27:1]:=1;                              41300000
                         END;                                           41310000
                    END;                                                41320000
                    KEY:=2; OT:=BL(3);                                  41330000
                    IOD:=OIOD;                                          41340000
                    DOIONOW;                                            41350000
                    IF BL(RESULT.[27:1]) THEN R.[27:1]:=1;              41360000
                    IF NOT BL(RESULT.[28:1]) THEN                       41370000
                    BEGIN                                               41380000
                         SIZE:=RESULT.[CF]-OIOD.[CF];                   41390000
                         SPACEBACK;                                     41400000
                         IOD:=SPACEIOD&0[22:47:1];                      41410000
                         DOIONOW;                                       41420000
                         IF NOT (BL(RESULT.[28:1]) OR (BL(OIOD.[21:1])  41430000
                              AND (RESULT.[CF]-SPACEIOD.[CF] NEQ SIZE)))41440000
                         THEN                                           41450000
                         BEGIN                                          41460000
                              MODE:=0&R[42:27:1];                       41470000
                              GO XIT;                                   41480000
                         END;                                           41490000
                    END;                                                41500000
               END;                                                     41510000
          GIVEUP:                                                       41520000
               MODE:=16;                                                41530000
          END;                                                          41540000
          XIT: TAPEPARITYRETRY:=MODE&Z[CTF];                            41550000
          END;                                                          41560000
%***********************************************************************41560100
     PROCEDURE LOOKAHEAD(KEY); VALUE KEY; INTEGER KEY;                  41560200
          BEGIN                                                         41560300
          INTEGER NEXTKEY,NEXTIOD1,NEXTP,NEXTB;                         41560400
          %                                                             41560500
          P:=EMPTY;                                                     41560600
          IF KEY=1 THEN                                                 41560700
               IF P:=IOD1.[FF] NEQ EMPTY THEN                           41560800
                    GETPATTERN(P,1);                                    41560900
          IF CODE[A].[IFL]=11 THEN                                      41561000
          BEGIN                                                         41561100
               IF NEXTKEY:=(NEXTIOD1:=CODE[A+1]).[IFL]=2 THEN           41561200
                    IF NEXTP:=NEXTIOD1.[FF] NEQ EMPTY THEN              41561300
                    BEGIN                                               41561400
                         IF NEXTB:=NEXTIOD1.[SCF]=..777 THEN            41561500
                              NEXTB:=1;                                 41561600
                         IF NEXTB NEQ B AND (NEXTB NEQ 1 OR             41561700
                              P=EMPTY) THEN GETPATTERN(NEXTP,           41561800
                                   NEXTB);                              41561900
                    END;                                                41562000
          END;                                                          41562100
          END;                                                          41562200
%***********************************************************************41570000
     PROCEDURE TAPEIO(IOD,IOD1); VALUE IOD,IOD1; REAL IOD,IOD1;         41580000
          BEGIN                                                         41590000
          LABEL REED,W,SP,BKSP,ERSE,RWND,XIT;                           41600000
          SWITCH IOS:=REED,W,SP,ERSE,RWND,BKSP;                         41610000
          LIST TANDM(NT1,S,A-1);                                        41620000
          REAL MASK,RESULT;                                             41630000
          STREAM PROCEDURE LITERALMOVE(LITERAL,ADDR); VALUE             41640000
               LITERAL,ADDR;                                            41650000
               BEGIN SI:=LOC LITERAL; DI:=ADDR; DS:=8 CHR; END;         41660000
          %                                                             41670000
          MASK:=0&IOD[25:25:5];                                         41680000
          UNIT:=(NT2:=UNITABLE[1,IOD.[3:5]]).[CF];                      41690000
          IOD:=IOD&(TINU:=NT2.[FF])[3:43:5]&                            41700000
               5[25:40:8]&                                              41710000
               BUFFERS[0,B:=(IF NT1:=IOD1.[SCF]=..777 THEN 1            41720000
                    ELSE NT1)][CTC]&0[25:40:8];                         41730000
          IF IOD.[SF]=1023 THEN                                         41740000
          BEGIN                                                         41750000
               IF TALLY GTR 0 AND NT1:=TALLY DIV 8 LEQ 1020 THEN        41760000
               IOD.[SF]:=NT1 ELSE                                       41770000
               BEGIN                                                    41780000
                    WRITE(CFILE,INVTALLY,TANDM);                        41790000
                    IF NOT TWXOUT THEN                                  41800000
                    WRITE(OUTFI,INVTALLY1,TANDM);                       41810000
                    GO EXIT;                                            41820000
               END;                                                     41830000
          END;                                                          41840000
          GO TO IOS[IOD1.[IFL]];                                        41850000
%                                                                       41860000
     REED:                                                              41870000
          GETPATTERN(-EMPTY,B) ;                                        41880000
          IF BL(IOD.[22:1]) THEN IOD.[CF]:=IOD.[CF]-1+                  41890000
               NT2:=IF BL(IOD.[23:1]) THEN IOD.[SF] ELSE                41900000
               BUFFERS[0,B].[SF];                                       41910000
          STARTAPEIO(ABS(IOD),RESULT);                                  41920000
          LOOKAHEAD(1);                                                 41920100
          IOFINISH(IOD,RESULT,MASK,1);                                  41930000
          GO XIT;                                                       41940000
     W:                                                                 41950000
          IF BL(MASK.[27:1]) THEN   %WRITE TAPEMARK                     41960000
          BEGIN                                                         41970000
               MASK.[27:1]:=0;                                          41980000
               JUNK:=..1737000000000000;                                41990000
               IOD.[CF]:=COREADDR(JUNK);                                42000000
          END ELSE                                                      42010000
          BEGIN                                                         42020000
               IF P:=IOD1.[FF] NEQ EMPTY THEN GETPATTERN(P,B);          42030000
               IF NOT BL(IOD.[21:1]) THEN                               42040000
                     LITERALMOVE(NOT FALSE,(NT2:=BUFFERS[0,B]).[CF]+    42080000
                        IOD.[SF]);                                      42090000
          END;                                                          42100000
          STARTAPEIO(ABS(IOD),RESULT);                                  42110000
          LOOKAHEAD(2);                                                 42110100
          IOFINISH(IOD,RESULT,MASK,2);                                  42120000
          GO XIT;                                                       42130000
     SP:                                                                42140000
     BKSP:                                                              42150000
          IOD.[CF]:=COREADDR(TESTBUFFER[1+IOD.[22:1]]);                 42160000
          STARTAPEIO(ABS(IOD),RESULT);                                  42170000
          LOOKAHEAD(2);                                                 42170100
          IOFINISH(IOD,RESULT,MASK,IOD1.[IFL]);                         42180000
          GO XIT;                                                       42190000
     ERSE:                                                              42200000
          TRANS:=TRANS-1;                                               42210000
     RWND:                                                              42220000
          STARTAPEIO(ABS(IOD),RESULT);                                  42230000
          LOOKAHEAD(2);                                                 42230100
          IOFINISH(IOD,RESULT,MASK,IOD1.[IFL]);                         42240000
     XIT: END;                                                          42250000
%***********************************************************************42250100
     PROCEDURE DETERMINECHANNELTYPE;                                    42250200
          BEGIN                                                         42250300
          REAL RESULT;                                                  42250400
          BOOLEAN MOD3;                                                 42250500
          INTEGER AD,I;                                                 42250600
          FORMAT                                                        42250610
               MOD3FAIL("UNIT FAILED TO DETECT MOD 3 IOS",              42250620
                        "(ON REWIND AT BOT)"),                          42250630
               MOD3WEIRD("UNIT DETECTED BOT ON REWIND & ",              42250640
                         "THEREFORE MOD-3 I/O S",/,                     42250650
                         "MCP DID NOT INDICATE MOD-3 I/O S ",           42250660
                         "HAD BEEN SENSED");                            42250670
          %                                                             42250700
          AD:=COREADDR(RESULT);                                         42250800
          DKBUSINESS(COREADDR(MOD3IOS)&EMPTY[CTF]);                     42250900
          STARTAPEIO(..4200000000&UNITABLE[1,0][3:28:5],RESULT);        42251000
          WAIT(AD,IOMASK);                                              42251100
          IF NOT((MOD3:=BL(RESULT.[2:1])) EQV MOD3IOS) THEN             42251200
          BEGIN                                                         42251300
               IF MOD3IOS THEN                                          42251400
                    WRITE(OUTFI[DBL],MOD3FAIL)                          42251500
               ELSE                                                     42251600
                    WRITE(OUTFI[DBL],MOD3WEIRD);                        42251700
          END;                                                          42251800
          MOD3IOS:=MOD3IOS OR MOD3;                                     42251900
          END;                                                          42252000
%***********************************************************************42260000
     PROCEDURE DETERMINEUNITSTATUS;                                     42260100
          BEGIN                                                         42260200
          COMMENT - DETERMINES IF A WRITE RING IS REQUIRED AND          42260300
               IF SO REQUESTS THAT IT BE MADE AVAILABLE;                42260400
          INTEGER AD,I;                                                 42260500
          BOOLEAN RINGRQD;                                              42260510
          REAL IOD,RESULT;                                              42260520
          LABEL IO;                                                     42260600
          FORMAT NORING("WRITE RING RQD - ",A3),                        42260700
                 ABORT("TEST ON ",A3," ABORTED(NO WRITE RING)"),        42260750
                 AX("SKIP,STOP OR OK");                                 42260800
          NOWRT:=WRTLOCK:=FALSE;                                        42260900
          IF NOT CONF THEN                                              42261000
               RINGRQD:=BL(HEADER[7])                                   42261100
          ELSE                                                          42261200
          FOR I:=1 STEP 1 UNTIL NUMBEROFTESTS DO                        42261300
               IF RINGRQD:=TESTARRAY[I] NEQ 0 AND                       42261400
                    BL(HEADER[FIRSTEST+I].[FF])                         42261500
               THEN I:=100;                                             42261600
          IF RINGRQD THEN                                               42261700
          BEGIN                                                         42261800
     IO:                                                                42261900
               STARTAPEIO(..500000000&UNITS[1,UNIT][3:28:5],            42262000
                    RESULT);                                            42262100
               AD:=COREADDR(RESULT);                                    42262200
               WAIT(AD,IOMASK);                                         42262300
               IF WRTLOCK:=BL(RESULT.[28:1]) THEN                       42262400
               BEGIN                                                    42262500
               ARRAY WORDS[0:2];                                        42262600
               LABEL AXL;                                               42262650
     AXL:                                                               42262660
                    WRITE(CFILE,NORING,UNAME(UNIT));                    42262700
                    WRITE(CFILE,AX);                                    42262900
                    FILL WORDS[*] WITH                                  42263000
                         "SKIP    ",                                    42263100
                         "STOP    ",                                    42263200
                         "OK      ";                                    42263300
                    FIRSTSCAN:=LASTSCAN:=INP;                           42263400
                    RELEASETHEUNIT(UNIT);                               42263450
                    READ(CFILE,10,INPUTBUFFER[*]);                      42263500
                    IF I:=SCANIT GTR 16 THEN GO AXL ELSE                42263600
                     IF AD:=WRD(WORDS,3) LSS 0 THEN GO AXL ELSE         42263700
                    IF NOWRT:=AD=0 THEN ELSE                            42263800
                    IF AD=1 THEN                                        42263900
                    BEGIN                                               42263910
                         WRITE(OUTFI[PAGE],ABORT,UNAME(UNIT));          42263920
                         GO TO IF DONETOG THEN ALLDONE ELSE DONE;       42264000
                    END ELSE                                            42264010
                    BEGIN                                               42264100
                         IF GETHEUNIT(UNIT,FALSE) THEN                  42264300
                              GO TO IF DONETOG THEN ALLDONE             42264310
                                    ELSE DONE;                          42264320
                         GO IO;                                         42264400
                         RESULT:=0;                                     42264450
                    END;                                                42264500
               END;                                                     42264600
          IF GETHEUNIT(UNIT,FALSE) THEN GO TO IF DONETOG THEN           42264650
               ALLDONE ELSE DONE;                                       42264660
          END;                                                          42264700
          END;                                                          42264750
%***********************************************************************42264800
PROCEDURE INITIALIZEINTERPRETER;                                        42264900
BEGIN                                                                   42265000
IF NOT TAPETEST THEN                                                    42270000
   BEGIN                                                                42280000
   WRITE(OUTFI[PAGE]);                                                  42290000
   DATIME;                                                              42300000
   FILEOPENED:=TRUE;                                                    42310000
   END;                                                                 42320000
%INITIALIZE BUFFER TABLES                                               42330000
MOVE(NT1:=HEADER[6],COMPAREBUFF,BUFFERS[0,0]);                          42340000
FOR B:=NT1-1 STEP -1 UNTIL 0 DO                                         42350000
CASE B OF                                                               42360000
   BEGIN                                                                42370000
   BUFFERS[0,0].[CF]:=IBUFF;                                            42380000
   BUFFERS[0,1].[CF]:=DBUFF;                                            42390000
   BUFFERS[0,2].[CF]:=COREADDR(B2)+1;                                   42400000
   BUFFERS[0,3].[CF]:=COREADDR(B3)+1;                                   42410000
   BUFFERS[0,4].[CF]:=COREADDR(B4)+1;                                   42420000
   BUFFERS[0,5].[CF]:=COREADDR(B5)+1;                                   42430000
   BUFFERS[0,6].[CF]:=COREADDR(B6)+1;                                   42440000
   BUFFERS[0,7].[CF]:=COREADDR(B7)+1;                                   42450000
   BUFFERS[0,8].[CF]:=COREADDR(B8)+1;                                   42460000
   BUFFERS[0,9].[CF]:=COREADDR(B9)+1;                                   42470000
   END;                                                                 42700000
TRANSFERIN(NT1,30,CODEFILE,BNAMES[*]);                                  42710000
BUFFERS[1,0]:=NT2:=..7777777777;                                        42720000
MOVE(NT1-1,BUFFERS[1,0],BUFFERS[1,1]);                                  42730000
%INITIALIZE PATTERN TABLES                                              42740000
TRANSFERIN(NT1:=HEADER[2],30,CODEFILE,PNAMES[*]);                       42750000
TRANSFERIN(NT1,30,CODEFILE,PATTERNS[0,*]);                              42760000
PATTERNS[1,0]:=NT2;                                                     42770000
IF NT1 GTR 1 THEN                                                       42780000
MOVE(NT1-1,PATTERNS[1,0],PATTERNS[1,1]);                                42790000
%READ IN SEGMENT DICTIONARY                                             42800000
TRANSFERIN(HEADER[3],30,CODEFILE,SEGDICT[*]);                           42810000
%READ IN UNIT TABLE                                                     42820000
IF NT1:=HEADER[1] GTR 0 THEN                                            42830000
   BEGIN                                                                42840000
   IF TAPETEST THEN                                                     42850000
      BEGIN                                                             42860000
      MOVE(1,UNITS[0,UNIT],UNITABLE[0,0]);                              42870000
      UNITABLE[1,0]:=UNITS[1,UNIT];                                     42880000
      END                                                               42890000
   ELSE                                                                 42900000
      BEGIN                                                             42910000
      READ(CODEFILE,NT1,UNITABLE[0,*]);                                 42920000
      READ(CODEFILE,NT1,UNITABLE[1,*]);                                 42930000
      END;                                                              42940000
   DETERMINEUNITSTATUS;                                                 42970500
   DETERMINECHANNELTYPE;                                                42971000
   END;                                                                 42980000
TRANS:=S:=A:=TALLY:=0;                                                  42990000
TOGGLE:=FALSE;                                                          43000000
LOOPCOUNT:=LEVELARRAY[0]:=-1;                                           43010000
IF BCL AND TRANSLATEBUFFER[0]=0 THEN FILLXLATEBUFFER;                   43020000
FILLMODIFIERS(COMPAREBUFF);                                             43030000
GETSEGMENT(0);                                                          43040000
END;                                                                    43040100
%#########INTERPRETER BLOCK CODE########################################43040200
INITIALIZEINTERPRETER;                                                  43040300
NEXTINSTRUCTION;                                                        43050000
S1:                                                                     43060000
NEXTINSTRUCTION;                                                        43630000
S2: %DISPLAY                                                            43640000
          IF INSTRUCTION.[FF]=EMPTY THEN                                43650000
          BEGIN                                                         43660000
               IF NT1:=INSTRUCTION.[36:6] GTR 1 THEN                    43670000
              IF PAGE THEN                                              43680000
               WRITE(OUTFI[PAGE]) ELSE                                  43690000
              WRITE(OUTFI[DBL],STAR) ELSE                               43700000
               IF BOOLEAN(NT1) THEN                                     43710000
               WRITE(OUTFI[DBL]) ELSE                                   43720000
               WRITE(OUTFI);                                            43730000
               NEXTINSTRUCTION;                                         43740000
          END;                                                          43750000
   IF NT1:=INSTRUCTION.[36:6] GTR 1 THEN                                43760000
   WRITE(OUTFI[PAGE]);                                                  43770000
   B:=P:=INSTRUCTION.[FF];                                              43780000
   CLEAR(OUTBUFFER,WBUFF);                                              43790000
   JUNKB:=INSTRUCTION LSS 0;                                            43800000
   IF INSTRUCTION.[SCF] LSS 63 THEN                                     43810000
   BEGIN                                                                43820000
   IF JUNKB THEN                                                        43830000
   DISPLAYHEADING(1,OUTBUFFER,BNAMES[B],                                43840000
      IF BCL THEN "BCL" ELSE "INT") ELSE                                43850000
   DISPLAYHEADING(0,OUTBUFFER,PNAMES[P],                                43860000
      IF BCL THEN "BCL" ELSE "INT");                                    43870000
   WRITE(OUTFI[DBL],WBUFF,OUTBUFFER[*]);                                43880000
   END;                                                                 43890000
   IF JUNKB THEN                                                        43900000
   MOVEANDWRITE(BOOLEAN(INSTRUCTION.[SCF]) OR TRUE,                     43910000
      IF NT1:=INSTRUCTION.[SF]=0 THEN BUFFERS[0,B].[SF] ELSE NT1,       43920000
      BOOLEAN(INSTRUCTION.[SCF]),OUTFI,                                 43930000
      BUFFERS[0,B].[CF]) ELSE                                           43940000
      BEGIN                                                             43950000
         IF NT5:=PATTERNS[1,P].[FF]=EMPTY THEN                          43960000
            BEGIN GETPATTERN(P,1); JUNK:=DBUFF; END ELSE                43970000
            JUNK:=BUFFERS[0,NT5].[CF];                                  43980000
         MOVEANDWRITE(BOOLEAN(NT1:=INSTRUCTION.[SCF]) OR TRUE,          43990000
            PATTERNS[0,P].[SF],BOOLEAN(NT1),OUTFI,JUNK);                44000000
      END;                                                              44010000
      IF INSTRUCTION.[SCF] LSS 64 THEN                                  44020000
      WRITE(OUTFI[DBL]);                                                44030000
      NEXTINSTRUCTION;                                                  44040000
S3: %END OF LOOP                                                        44050000
   IF INSTRUCTION LSS 0 THEN                                            44060000
   BEGIN                                                                44070000
        WRITE(OUTFI[DBL],ERRSF,ERROR);                                  44080000
        WRITE(OUTFI[PAGE],EOTESTF,TEST);                                44090000
        ERROR:=0;                                                       44100000
   END;                                                                 44110000
   IF LOOPCOUNT LSS 0 THEN LOOPCOUNT:=                                  44120000
      IF INSTRUCTION LSS 0 THEN ABS(TESTARRAY[TEST]) ELSE               44130000
      INSTRUCTION.[SCF];                                                44140000
   IF LOOPCOUNT:=LOOPCOUNT-1 GTR 0 THEN                                 44150000
      BEGIN                                                             44160000
      GO SW[(INSTRUCTION:=CODE[(A:=INSTRUCTION.[FF]+1)-1])              44170000
         .[IFL]];                                                       44180000
   END ELSE                                                             44190000
   LOOPCOUNT:=LEVELARRAY[LEVELCOUNT:=LEVELCOUNT-1]&0[CTF];;             44200000
   NEXTINSTRUCTION;                                                     44210000
S4: %FILL A BUFFER                                                      44220000
   GETPATTERN(INSTRUCTION.[FF],INSTRUCTION.[SCF]);                      44230000
   NEXTINSTRUCTION;                                                     44240000
S5: %ROTATIONS                                                          44250000
   IF BUFFERS[0,1].[FF] LSS EMPTY THEN                                  44260000
   GETPATTERN(EMPTY,1);                                                 44270000
   GETPATTERN(EMPTY,B:=INSTRUCTION.[SCF]);                              44280000
   IF INSTRUCTION LSS 0 THEN                                            44290000
     ROTATE((NT1:=BUFFERS[0,B]).[CF],PATBUFF[0],                        44300000
         8|(NT1.[SF])-NT2:=INSTRUCTION.[FF],NT2)                        44310000
   ELSE                                                                 44320000
     ROTATE((NT1:=BUFFERS[0,B]).[CF],PATBUFF[0],                        44330000
         NT2:=INSTRUCTION.[FF],8|(NT1.[SF])-NT2);                       44340000
   NEXTINSTRUCTION;                                                     44350000
S6: %SHIFTS                                                             44360000
   GETPATTERN(EMPTY,B:=INSTRUCTION.[SCF]);                              44370000
   BUFFERSHIFT(NT1:=INSTRUCTION.[FF],NT2:=(NT3:=BUFFERS[0,B]).[CF],     44380000
      NT2,8|(NT3.[SF])-NT1,INSTRUCTION LSS 0,0);                        44390000
   NEXTINSTRUCTION;                                                     44400000
S7: %COMPARISONS                                                        44410000
   IF JUNKB:=(P:=INSTRUCTION.[FF] GEQ MAXBUFFS) THEN                    44420000
      BEGIN                                                             44430000
      GETPATTERN(P:=P-MAXBUFFS,1);                                      44440000
      NT1:=DBUFF;                                                       44450000
      NT3:=PATTERNS[0,P];                                               44460000
      END                                                               44470000
   ELSE NT1:=(NT3:=BUFFERS[0,P]).[CF];                                  44480000
   IF COMPAREDATA:=BIGCOMPARE(MIN(NT3.[SF],(NT2:=                       44490000
      BUFFERS[0,B:=INSTRUCTION.[SCF]]).[SF]),NT1,NT2.[CF],NT4,          44500000
      NT5,NT6) THEN                                                     44510000
      IF INSTRUCTION LSS 0 THEN                                         44520000
         A:=A+1;                                                        44530000
   NEXTINSTRUCTION;                                                     44540000
S9:                                                                     44550000
S10:                                                                    44560000
   IF INSTRUCTION LSS 0 THEN                                            44561000
      BEGIN                                                             44562000
      LOOPCOUNT:=LEVELARRAY[LEVELCOUNT:=LEVELCOUNT-INSTRUCTION.[SCF]]   44563000
          &0[CTF];                                                      44564000
      NEXTINSTRUCTION;                                                  44565000
      END;                                                              44566000
   LOOPCOUNT:=0;                                                        44570000
   INSTRUCTION:=CODE[A:=LEVELARRAY[LEVELCOUNT-1].[FF]];                 44580000
   A:=A+1;                                                              44581000
   GO S3;                                                               44590000
S11: %TAPEIO                                                            44600000
   TAPEIO(INSTRUCTION,IOD1:=INSTR);                                     44610000
   NEXTINSTRUCTION;                                                     44620000
S12:                                                                    44630000
   FOR TEST:=TEST+1 STEP 1 UNTIL NUMBEROFTESTS DO                       44640000
      IF TESTARRAY[TEST] NEQ 0 THEN                                     44650000
         BEGIN                                                          44660000
         IF BL(HEADER[TEST+FIRSTEST].[FF]) AND NOWRT THEN               44661000
         BEGIN                                                          44662000
              WRITE(OUTFI,DASH);                                        44663000
              WRITE(OUTFI,NOTDONE,TEST);                                44664000
              WRITE(OUTFI[PAGE],DASH);                                  44665000
              GO S12;                                                   44666000
         END;                                                           44667000
         IGNORERRORS:=TESTARRAY[TEST] LSS 0;                            44668000
         ABREV:=(REAL(BL(ABREVIATE)AND BL(ENTIER(2*TEST))) NEQ 0);      44669000
         A:=HEADER[TEST+FIRSTEST].[CF]; NEXTINSTRUCTION;                44670000
         END;                                                           44680000
  GO DONE;                                                              44690000
S13:                                                                    44700000
   IF NT1:=INSTRUCTION.[SCF]=0 THEN                                     44710000
   BEGIN                                                                44720000
        TALLY:=IF INSTRUCTION LSS 0 THEN                                44730000
             (TALLY+CODE[(A:=A+1)-1]) ELSE CODE[(A:=A+1)-1];            44740000
   END ELSE                                                             44750000
   IF NT1=1 THEN                                                        44760000
      TOGGLE:=BL(INSTRUCTION.[FF])                                      44770000
   ELSE                                                                 44780000
   IF NT1=2 THEN                                                        44790000
      IF TOGGLE THEN A:=A+1 ELSE                                        44800000
   ELSE                                                                 44800050
   IF NT1=4 THEN                                                        44800100
      IF MOD3IOS THEN A:=A+1 ELSE                                       44800200
   ELSE                                                                 44810000
   IF TALLY=INSTR THEN A:=A+1;                                          44820000
   NEXTINSTRUCTION;                                                     44830000
DONE:                                                                   44840000
   CLOSE(CODEFILE); SEGNO:=A:=S:=0; GO RETURN;                          44850000
   END;                                                                 44860000
END;                                                                    44870000
     RUNDISKTESTS:                                                      44880000
%##########DISK TEST BLOCK STARTS HERE##################################44890000
     BEGIN                                                              44900000
     LABEL                                                              44910000
          RUNTESTS;                                                     44920000
%***********************************************************************44930000
     INTEGER                                                            44940000
          CYNUMR,                                                       44950000
          SFA,                                                          44960000
          BUFFLTH,                                                      44970000
          JUMPOFF,                                                      44980000
          JUMPCOUNT,                                                    44990000
          CYNUM,                                                        45000000
          WRTOG,                                                        45010000
          RDTOG;                                                        45020000
%***********************************************************************45030000
     BOOLEAN                                                            45040000
          WRT,                                                          45050000
          SHIF,                                                         45060000
          FORTYMILL,                                                    45070000
          MAINT,                                                        45080000
          REV,                                                          45090000
          LONG,                                                         45100000
          SWITCHER,                                                     45110000
          ADDRESSINGCOMPLETE;                                           45120000
%***********************************************************************45160000
     SAVE ARRAY                                                         45170000
          IOD,RES[0:3],                                                 45180000
          LOCATION[0:3],                                                45190000
          SZ[0:5],                                                      45200000
          SHIFTBUFF[0:45],                                              45210000
          DISK[0:3,0:45],                                               45220000
          COMPAREBUFF[0:1,0:45],                                        45230000
          DA[0:1,0:3],                                                  45240000
          JA[0:1,0:11];                                                 45250000
%***********************************************************************45260000
     ARRAY                                                              45270000
          RTY[0:2,0:44],                                                45280000
          E,OUNT,OLR[0:2];                                              45290000
%***********************************************************************45300000
     INTEGER PROCEDURE ZNE(FA); VALUE FA; INTEGER FA;                   45310000
          ZNE:=IF FA:=(FA MOD 100) LSS SZ[4] THEN 0 ELSE                45320000
               IF FA LSS SZ[5] THEN 1 ELSE 2;                           45330000
%***********************************************************************45340000
     REAL PROCEDURE MADDR(FILEADDR,KLUGE); VALUE FILEADDR,KLUGE;        45350000
          INTEGER FILEADDR; BOOLEAN KLUGE;                              45360000
          BEGIN                                                         45370000
               REAL JUNK1; INTEGER JUNK2;                               45380000
               IF BOOLEAN(FILEADDR.[1:1]) THEN                          45390000
               MADDR:=100|((FILEADDR:=ABS(FILEADDR)) DIV 100)+          45400000
                    SZ[(JUNK2:=ZNE(FILEADDR))+3]+                       45410000
                    REAL(REV)|(SZ[JUNK2]-1)                             45420000
               ELSE                                                     45430000
               BEGIN                                                    45440000
                    IF KLUGE THEN                                       45450000
                    FILEADDR:=FILEADDR MOD 1000000;                     45460000
                    JUNK1:=DECMAL(FILEADDR);                            45470000
                    IF FORTYMILL THEN                                   45480000
                    BEGIN                                               45490000
                         JUNK2:=OCTAL(JUNK1.[12:12])&0[45:47:1];        45500000
                         IF KLUGE THEN JUNK2:=JUNK2 MOD 4;              45510000
                         JUNK1:=JUNK1&DECMAL(JUNK2)[12:36:12];          45520000
                    END ELSE                                            45530000
                    IF KLUGE THEN                                       45540000
                    JUNK1:=JUNK1&DECMAL(ENTIER(OCTAL(JUNK1.[12:12])     45550000
                         MOD 4))[12:36:12];                             45560000
                    JUNK2:=JUNK1.[12:6]+10-5|REAL(WRT);                 45570000
                    JUNK1:=JUNK1&JUNK2[12:42:6];                        45580000
                    JUNK1.[36:12]:=                                     45590000
                    IF JUNK2:=ZNE(FILEADDR)=0 THEN 0 ELSE               45600000
                    IF JUNK2=1 THEN "25" ELSE "58";                     45610000
                    MADDR:=JUNK1;                                       45620000
               END;                                                     45630000
          END;                                                          45640000
%***********************************************************************45650000
     DEFINE MAINTADDR(MAINTADDR1)=MADDR(MAINTADDR1,FALSE)#,             45660000
             DELTA=8#;                                                  45670000
%***********************************************************************45680000
     STREAM PROCEDURE M2PATTERN(S,DEST,ADDRESS); VALUE ADDRESS;         45690000
          BEGIN                                                         45700000
          LOCAL SAVESI;                                                 45710000
               DI:=DEST; SI:=S;                                         45720000
               DS:=18 CHR;                                              45730000
               SI:=SI+6; SAVESI:=SI;                                    45740000
               SI:=LOC ADDRESS;                                         45750000
               SI:=SI+2; DS:=6 CHR;                                     45760000
               SI:=SAVESI;                                              45770000
               DS:=9 WDS;                                               45780000
          END;                                                          45790000
%***********************************************************************45800000
     PROCEDURE FINDGOODM2PATTERN(ADDR); VALUE ADDR; INTEGER ADDR;       45810000
          BEGIN                                                         45820000
          INTEGER I,SU,EU,EA;                                           45830000
          REAL IOD,RESULT,LOCATION;                                     45840000
          LABEL XIT;                                                    45850000
%                                                                       45860000
                    FILL OUTBUFFER[*] WITH                              45870000
                    "   20003",                                         45880000
                    "99990   ",                                         45890000
                    " 0000000",                                         45900000
                    "0 1.2[3(",                                         45910000
                    "0 1.2[3(",                                         45920000
                    "0 1.2[3(",                                         45930000
                    "0 1.2[3(",                                         45940000
                    "0 1.2[3(",                                         45950000
                    "EE||CC@@",                                         45960000
                    "EE||CC@@",                                         45970000
                    "EE||CC@@",                                         45980000
                    "EE||CC@@";                                         45990000
               IOD:=COREADDR(JUNKBUFFER[0])&12[8:38:10]&                46000000
                    513[18:33:15]&1[24:47:1]&TINU[3:43:5];              46010000
               LOCATION:=(I:=COREADDR(RESULT))&UNIT[12:42:6]&           46020000
                    1[2:47:1];                                          46030000
               EU:=ADDR DIV 1000000;                                    46040000
               SU:=((ADDR DIV 10000)MOD 100) DIV 4|DKTYPE;              46050000
               EA:=(ADDR:=1000000|EU+DKTYPE|40000|SU)+40000;            46060000
               WHILE TRUE DO                                            46070000
               BEGIN                                                    46080000
                    JUNKBUFFER[0]:=DECIMAL(ADDR);                       46090000
                    M2PATTERN(OUTBUFFER,OUTBUFFER,MADDR(ADDR,TRUE));    46100000
                    IOREQUEST(-(RESULT:=IOD)&0[25:40:8],RESULT,         46110000
                         LOCATION);                                     46120000
                    WAIT(I,IOMASK);                                     46130000
                    IF RESULT.[25:8]=0 THEN                             46140000
                    IF (RESULT:=REAL(COMPARED(12,OUTBUFFER,             46150000
                         JUNKBUFFER[1],0))).[36:6] LSS 3 THEN           46160000
                    IF RESULT.[18:6] LSS 3 THEN                         46170000
                    BEGIN                                               46180000
                         MOVE(12,JUNKBUFFER[1],SHIFTBUFF);              46190000
                         GO XIT;                                        46200000
                    END;                                                46210000
                    IF ADDR:=ADDR+SZ[ZNE(ADDR)] GTR EA THEN             46220000
                    BEGIN                                               46230000
                         MOVE(12,OUTBUFFER,SHIFTBUFF);                  46240000
                         GO XIT;                                        46250000
                    END;                                                46260000
               END;                                                     46270000
          XIT: END;                                                     46280000
%***********************************************************************46290000
     DEFINE COUNTUP(COUNTUP1)=COUNTUP1:=2|REAL(COUNTUP1 GTR 1)          46300000
                              +ABS((COUNTUP1 MOD 2) - 1)#;              46310000
%***********************************************************************46320000
     PROCEDURE ERRORANALYSIS(BUFFERNR); VALUE BUFFERNR; INTEGER         46330000
          BUFFERNR; FORWARD;                                            46340000
%***********************************************************************46350000
     PROCEDURE IO(CODE,BUFFERNR); VALUE CODE,BUFFERNR;                  46360000
          INTEGER CODE,BUFFERNR;                                        46370000
          BEGIN                                                         46380000
          LABEL REED,W,RC,WC,XIT,FAKEOUT;                               46390000
          SWITCH S:=REED,W,RC,WC;                                       46400000
          INTEGER JUNK,BNUM;                                            46410000
          DEFINE COUNTUPERRORS=BEGIN ERROR:=ERROR+1;                    46420000
                                     ERRORS:=ERRORS+1;                  46430000
                               END#;                                    46440000
%                                                                       46450000
               BNUM:=BUFFERNR-2;                                        46460000
               GO S[CODE];                                              46470000
          REED:                                                         46480000
               IF FILEADDR:=DA[BNUM,2]LSS 0 THEN                        46490000
               BEGIN COUNTUP(RDTOG); GO XIT; END;                       46500000
               IF WRT THEN CLEAR(DISK[BUFFERNR,0],BUFFLTH+1) ELSE       46510000
               IF MAINT THEN M2PATTERN(SHIFTBUFF,COMPAREBUFF[BNUM,      46520000
                    1],MADDR(FILEADDR,TRUE)) ELSE                       46530000
               MOVE(BUFFLTH,COMPAREBUFF[BNUM,1],DISK[BUFFERNR,1]);      46540000
               DISK[BUFFERNR,0]:=DISK[BUFFERNR,1]:=DECIMAL(FILEADDR);   46550000
               IOREQUEST(-(RES[BUFFERNR]:=IOD[BUFFERNR])&0[25:40:8],    46560000
                    RES[BUFFERNR],LOCATION[BUFFERNR]);                  46570000
               IF SHIF THEN                                             46580000
               SHIFTR(BUFFLTH,SHIFTBUFF,COMPAREBUFF[BNUM,1]);           46590000
               IF WRT OR NOT MAINT THEN                                 46600000
               COMPAREBUFF[BNUM,1]:=DECIMAL(FILEADDR);                  46610000
               COUNTUP(RDTOG);                                          46620000
               GO XIT;                                                  46630000
          W:                                                            46640000
               IF FILEADDR:=DA[BUFFERNR,0] LSS 0 THEN                   46650000
               BEGIN COUNTUP(WRTOG); GO XIT; END;                       46660000
               IF SHIF THEN                                             46670000
               SHIFT(BUFFLTH,SHIFTBUFF,DISK[BUFFERNR,1]);               46680000
               DISK[BUFFERNR,0]:=DISK[BUFFERNR,1]:=DECIMAL(FILEADDR);   46690000
               IOREQUEST(-(RES[BUFFERNR]:=IOD[BUFFERNR])&0              46700000
                    [25:40:8],RES[BUFFERNR],LOCATION[BUFFERNR]);        46710000
               COUNTUP(WRTOG);                                          46720000
               IF LONG THEN RDTOG:=WRTOG+2;                             46730000
               GO XIT;                                                  46740000
          RC:                                                           46750000
               IF FILEADDR:=DA[BNUM,3] LSS 0 THEN                       46760000
               GO XIT;                                                  46770000
               JUNK:=LOCATION[BUFFERNR].[33:15];                        46780000
               WAIT(JUNK,IOMASK);                                       46790000
               IF RES[BUFFERNR].[25:8] NEQ 0 THEN                       46800000
               BEGIN                                                    46810000
                    IF IGNORERRORS THEN COUNTUPERRORS ELSE              46820000
                    BEGIN                                               46830000
                         COMPAREDATA:=COMPARE(BUFFERNR );               46840000
                         ERRORANALYSIS(BUFFERNR);                       46850000
                    END                                                 46860000
               END ELSE                                                 46870000
               BEGIN                                                    46880000
                    IF WRT OR MAINT THEN                                46890000
                    IF COMPAREDATA:=COMPARE(BUFFERNR ) THEN             46900000
                    IF TEST=1 THEN                                      46910000
                    BEGIN                                               46920000
                         IF REAL(COMPAREDATA).[36:6] LEQ 3 THEN         46930000
                         BEGIN                                          46940000
                              FINDGOODM2PATTERN(FILEADDR);              46950000
                              M2PATTERN(SHIFTBUFF,COMPAREBUFF           46960000
                                   [BNUM,1],MADDR(FILEADDR,TRUE));      46970000
                              IF COMPAREDATA:=COMPARE(BUFFERNR)         46980000
                              THEN GO FAKEOUT;                          46990000
                         END ELSE GO FAKEOUT;                           47000000
                    END ELSE                                            47010000
          FAKEOUT:                                                      47020000
                    IF IGNORERRORS THEN COUNTUPERRORS ELSE              47030000
                    ERRORANALYSIS(BUFFERNR)                             47040000
                    ELSE ELSE                                           47050000
                    IF NOT COMPAREDATA:=COMPARE(BUFFERNR )              47060000
                    THEN GO FAKEOUT;                                    47070000
               END;                                                     47080000
               GO XIT;                                                  47090000
          WC:                                                           47100000
               IF FILEADDR:=DA[BUFFERNR,1] LSS 0 THEN GO XIT;           47110000
               JUNK:=LOCATION[BUFFERNR].[33:15];                        47120000
               WAIT(JUNK,IOMASK);                                       47130000
               IF RES[BUFFERNR].[25:8] NEQ 0 THEN                       47140000
               IF IGNORERRORS THEN COUNTUPERRORS ELSE                   47150000
                    ERRORANALYSIS(BUFFERNR);                            47160000
               RES[BUFFERNR]:=IOMASK;                                   47170000
          XIT: END IO;                                                  47180000
%***********************************************************************47190000
     DEFINE W(W1)=IO(2,W1)#,                                            47200000
            REED(REED1)=IO(1,REED1)#,                                   47210000
            RC(RC1)=IO(3,RC1)#,                                         47220000
            WC(WC1)=IO(4,WC1)#;                                         47230000
%***********************************************************************47240000
     PROCEDURE BREAKDOWNADDRESS;                                        47250000
          BEGIN                                                         47260000
          REAL FA;                                                      47270000
          INTEGER                                                       47280000
               TRACK,                                                   47290000
               SU,                                                      47300000
               SET,                                                     47310000
               ZONE,                                                    47320000
               PIN,                                                     47330000
               SEG,                                                     47340000
               HEAD;                                                    47350000
          ALPHA FACE;                                                   47360000
          FORMAT                                                        47370000
               SUF("STORAGE UNIT",I3,X4,":",X4,"ZONE",I2,X8,":",        47380000
                   X4,"HEAD",I3),                                       47390000
               DISKF("DISK",I2,X13,":",X4,"TRACK",I3,X6,":",X4,         47400000
                     "PIN ",I2),                                        47410000
               FACEF(A3," FACE",X11,":",X4,"SEGMENT ",A2,X4,":");       47420000
%                                                                       47430000
               FA:=DECMAL(FILEADDR);                                    47440000
               SU:=(SET:=OCTAL(FA.[12:12])) DIV (4|DKTYPE);             47450000
               SET:=(SET MOD 4)+1;                                      47460000
               FACE:=IF (REAL((TRACK:=OCTAL(FA.[24:12])) LSS 50)+       47470000
                    REAL(SET MOD 2=1)) MOD 2=0 THEN "CW " ELSE "CCW";   47480000
               ZONE:=ZNE(FILEADDR)+1;                                   47490000
               IF TRACK:=TRACK MOD 50 LEQ 24 THEN                       47500000
                    HEAD:=IF TRACK MOD 2=0 THEN 2 ELSE 1                47510000
               ELSE                                                     47520000
                    HEAD:=IF TRACK MOD 2=0 THEN 4 ELSE 3;               47530000
               PIN:=TRACK DIV 2-13|((HEAD-1) DIV 2)+1;                  47540000
               HEAD:=HEAD+ZONE*2+ZONE-2;                                47550000
               SEG:=IF MAINT THEN IF WRT THEN "M1" ELSE "M2" ELSE       47560000
                    DECMAL(ENTIER(FILEADDR MOD 100)-SZ[ZONE+2]);        47570000
%                                                                       47580000
               WRITE(OUTFI,SUF,SU,ZONE,HEAD);                           47590000
               WRITE(OUTFI,DISKF,SET,TRACK,PIN);                        47600000
               WRITE(OUTFI,FACEF,FACE,SEG);                             47610000
          END;                                                          47620000
%***********************************************************************47630000
     INTEGER STREAM PROCEDURE ANALYZEDESC(RESULT,MSGBUFFER);            47640000
          BEGIN                                                         47650000
               SI:=RESULT; SI:=SI+4;                                    47660000
               DI:=MSGBUFFER;                                           47670000
               SKIP SB;                                                 47680000
               IF SB THEN                                               47690000
               BEGIN                                                    47700000
                    DS:=21 LIT "READCHECK ERROR - D23";                 47710000
                    TALLY:=TALLY+1;                                     47720000
                    DS:=27 LIT " ";                                     47730000
               END;                                                     47740000
               SKIP SB;                                                 47750000
               IF SB THEN                                               47760000
               BEGIN                                                    47770000
                    DS:=27 LIT "CORE ADDRESS ERROR - D22 - ";           47780000
                    DS:=11 LIT "ADDRESS = @";                           47790000
                    SI:=RESULT; SI:=SI+5; SKIP 3 SB;                    47800000
                    5(DS:=3 RESET; 3(IF SB THEN DS:=SET ELSE DS:=RESET; 47810000
                         SKIP SB));                                     47820000
                    DS:=5 LIT " ";                                      47830000
                    SI:=RESULT; SI:=SI+4; SKIP 2 SB;                    47840000
                    TALLY:=TALLY+1;                                     47850000
               END;                                                     47860000
               SKIP SB;                                                 47870000
               IF SB THEN                                               47880000
               BEGIN                                                    47890000
                    DS:=18 LIT "EU NOT READY - D21";                    47900000
                    DS:=30 LIT " ";                                     47910000
                    TALLY:=TALLY+1;                                     47920000
               END;                                                     47930000
               SKIP SB;                                                 47940000
               IF SB THEN                                               47950000
               BEGIN                                                    47960000
                    DS:=17 LIT "READ PARITY - D20";                     47970000
                    DS:=31 LIT " ";                                     47980000
                    TALLY:=TALLY+1;                                     47990000
               END;                                                     48000000
               SKIP SB;                                                 48010000
               IF SB THEN                                               48020000
               BEGIN                                                    48030000
                    DS:=18 LIT "WRITE PARITY - D19";                    48040000
                    DS:=30 LIT " ";                                     48050000
                    TALLY:=TALLY+1;                                     48060000
               END;                                                     48070000
               SKIP SB;                                                 48080000
               IF SB THEN                                               48090000
               BEGIN                                                    48100000
                    DS:=2 LIT "DK";                                     48110000
                    SI:=RESULT; IF SC="3" THEN DS:=LIT "B"              48120000
                    ELSE DS:=LIT "A";                                   48130000
                    DS:=16 LIT " NOT READY - D18";                      48140000
                    DS:=29 LIT " ";                                     48150000
                    SI:=SI+5;                                           48160000
                    TALLY:=TALLY+1;                                     48170000
               END;                                                     48180000
               SKIP SB;                                                 48190000
               IF SB THEN                                               48200000
               BEGIN                                                    48210000
                    DS:=16 LIT "MEM PARITY - D17";                      48220000
                    DS:=32 LIT " ";                                     48230000
                    TALLY:=TALLY+1;                                     48240000
               END;                                                     48250000
               SKIP SB;                                                 48260000
               IF SB THEN                                               48270000
               BEGIN                                                    48280000
                    DS:=2 LIT "DK";                                     48290000
                    SI:=RESULT; IF SC="3" THEN DS:=LIT "B" ELSE         48300000
                    DS:=LIT "A";                                        48310000
                    DS:=11 LIT " BUSY - D16";                           48320000
                    DS:=34 LIT " ";                                     48330000
                    TALLY:=TALLY+1;                                     48340000
               END;                                                     48350000
               ANALYZEDESC:=TALLY;                                      48360000
          END;                                                          48370000
%***********************************************************************48380000
     PROCEDURE ERRORANALYSIS(BUFFERNR); VALUE BUFFERNR; INTEGER         48390000
          BUFFERNR;                                                     48400000
          BEGIN                                                         48410000
          BOOLEAN V,M2,READERR,WRITERR;                                 48420000
          INTEGER X,ERRS,I,J,K,Z,OUNTP;                                 48430000
          REAL Y,OLDRESULT,RESULT,JUNK;                                 48440000
          LABEL XIT,RETRY,DISPLAY,DOIO,CHECK,OK;                        48450000
          FORMAT                                                        48460000
                 FAILF(A*," FAILURE"),                                  48470000
                 WRDNO(I2),                                             48480000
                 RESF("RESULT DESC. =  "),                              48490000
                 IODF("I/O DESC.    = "),                               48500000
                 RSAABF("RESULT DESC. =  SAME AS RETRY ",I1),           48510000
                 IODSAAF("I/O DESC.    =  SAME AS RETRY ",I1),          48520000
                 ISAABF("SAME AS RETRY ",I1),                           48530000
                 INITF("RETRY=0(INITIAL FAILURE ON THIS ",              48540000
                         "ADDRESS)"),                                   48550000
                 RETRYF("RETRY=",I1),                                   48560000
                 OKF("RETRY="I1,", NO ERRORS, ERROR ROUTINE ",          48570000
                     "EXITED"),                                         48580000
                 DAF("DISK ADDRESS=",A1,A6),                            48590000
                 NOTRANSF("NO DATA TRANSFERED ON READ"),                48600000
                 NOWTRANSF("NO DATA TRANSFERED ON WRITE"),              48610000
                 WDIFF(I3," CHRS(IN",I3," WDS) DIFFER FROM ",           48620000
                      "WRITTEN RECORD--FIRST APPEARS IN WRD",I3),       48630000
                 M2DIFF(I3," CHRS(IN",I3," WDS) DIFFER FROM ",          48640000
                      "FACTORY-RCDED RECORD--FIRST IN ",                48650000
                      "IN WRD",I3),                                     48660000
                 M2WACT("12 WORDS RECORDED AT FACTORY WERE(",           48670000
                      A3,")-"),                                         48680000
                 NOERRF(X16,"NO ERRORS"),                               48690000
                 LRDIFF(I3," CHRS(IN",I3," WDS) DIFFER FROM RETRY",I2,  48700000
                      "--FIRST APPEARS IN WORD",I3),                    48710000
                 WACT(I2," WORDS WRITTEN WERE(",A3,")-"),               48720000
                 RACT(I2," WORDS READ WERE(",A3,")-");                  48730000
          SWITCH FORMAT NOCOMP:=("SAME AS WRITTEN"),                    48740000
               ("SAME AS RECORDED AT FACTORY");                         48750000
%                                                                       48760000
     DEFINE DOIRETRY=                                                   48770000
                     IF WRT OR MAINT THEN                               48780000
                     IF COMPAREDATA:=COMPARE(BUFFERNR)                  48790000
                     THEN GO RETRY ELSE GO OK ELSE                      48800000
                     IF NOT COMPAREDATA:=COMPARE(BUFFERNR)              48810000
                     THEN GO RETRY ELSE GO OK#;                         48820000
     DEFINE SPOUT(SPOUT1,SPOUT2)=                                       48830000
          JUNK:=(BUFFLTH DIV (I:=(12-6|REAL(OCTL)-                      48840000
               (3+2|ABS(REAL(OCTL)-1))|REAL(TWXOUT))))-1;               48850000
          FOR Y:=0 STEP 1 UNTIL JUNK DO                                 48860000
          BEGIN                                                         48870000
               WRITE(OUTBUFFER[*],WRDNO,ERRS:=Y|I+1);                   48880000
               EDIT(I,SPOUT1[SPOUT2,ERRS],OUTBUFFER[1],                 48890000
                    BCL,OCTL,JUNKBUFFER,TRANSLATEBUFFER,TWXOUT);        48900000
               IF Y MOD 5=0 THEN WRITE(OUTFI);                          48910000
               WRITE(OUTFI,WBUFF,OUTBUFFER[*]);                         48920000
          END;                                                          48930000
          IF (J:=BUFFLTH MOD I) NEQ 0 THEN                              48940000
          BEGIN                                                         48950000
               WRITE(OUTBUFFER[*],WRDNO,ERRS:=I|(JUNK+1)+1);            48960000
               EDIT(J,SPOUT1[SPOUT2,ERRS],                              48970000
                    OUTBUFFER[1],BCL,OCTL,JUNKBUFFER,TRANSLATEBUFFER,   48980000
                    TWXOUT);                                            48990000
               WRITE(OUTFI,WBUFF,OUTBUFFER[*]);                         49000000
          END#;                                                         49010000
%                                                                       49020000
          OUNT[0]:=OUNT[1]:=OUNTP:=-1;                                  49030000
          READERR:=NOT(WRITERR:=BUFFERNR LSS 2);                        49040000
          ERROR:=ERROR+1;                                               49050000
          ERRORS:=ERRORS+1;                                             49060000
          M2:=MAINT AND NOT WRT;                                        49070000
          IF PAGE AND NOT ABREV AND ERROR GTR 1 THEN                    49080000
          WRITE(OUTFI[PAGE]) ELSE                                       49090000
          IF ERROR GTR 1 THEN                                           49100000
          WRITE(OUTFI,STAR);                                            49110000
          WRITE(OUTFI[DBL]);                                            49120000
          WRITE(OUTFI[DBL],FAILF,I:=IF WRITERR THEN 5                   49130000
               ELSE 4,IF READERR THEN "READ" ELSE "WRITE");             49140000
          WRITE(OUTFI,DAF,(JUNK:=DECIMAL(FILEADDR)).[6:6],JUNK);        49150000
          WRITE(OUTFI);                                                 49160000
          BREAKDOWNADDRESS;                                             49170000
          WRITE(OUTFI);                                                 49180000
          IF (WRT OR MAINT) AND NOT ABREV THEN IF                       49190000
          READERR THEN                                                  49200000
          BEGIN                                                         49210000
               WRITE(OUTFI[DBL]);                                       49220000
               IF M2 THEN WRITE(OUTFI,M2WACT,IF BCL THEN "BCL"          49230000
                    ELSE "INT") ELSE                                    49240000
               WRITE(OUTFI,WACT,BUFFLTH,IF BCL THEN "BCL" ELSE          49250000
                    "INT");                                             49260000
               SPOUT(COMPAREBUFF,BUFFERNR-2);                           49270000
               WRITE(OUTFI[DBL]);                                       49280000
          END;                                                          49290000
          WHILE TRUE DO                                                 49300000
          BEGIN                                                         49310000
     RETRY:                                                             49320000
               WRITE(OUTFI[DBL]);                                       49330000
               IF NOT ABREV THEN                                        49340000
               IF X=0 THEN WRITE(OUTFI,INITF) ELSE                      49350000
               WRITE(OUTFI,RETRYF,X);                                   49360000
               V:=FALSE; JUNK:=(RESULT:=RES[BUFFERNR]).[3:5];           49370000
               FOR I:=0 STEP 1 UNTIL OUNTP DO                           49380000
               IF JUNK=OUNT[I].[33:15] THEN                             49390000
               BEGIN                                                    49400000
                    V:=TRUE;                                            49410000
                    WRITE(OUTFI,IODSAAF,OUNT[I].[18:15]);               49420000
               END;                                                     49430000
               IF NOT V THEN                                            49440000
               BEGIN                                                    49450000
                    WRITE(OUTBUFFER[*],IODF);                           49460000
                    OUNT[OUNTP:=OUNTP+1]:=JUNK&X[18:33:15];             49470000
                    JUNK:=IOD[BUFFERNR]&JUNK[3:43:5];                   49480000
                    EDIT(1,JUNK,OUTBUFFER[2],0,1,                       49490000
                         JUNK,TRANSLATEBUFFER,0);                       49500000
                    WRITE(OUTFI,5,OUTBUFFER[*]);                        49510000
               END;                                                     49520000
               FOR I:=0 STEP 1 UNTIL X-1 DO                             49530000
               IF RESULT=OLR[I] THEN                                    49540000
               BEGIN                                                    49550000
                    WRITE(OUTFI,RSAABF,I);                              49560000
                    IF WRITERR THEN GO DOIO ELSE                        49570000
                    GO CHECK;                                           49580000
               END;                                                     49590000
               WRITE(OUTBUFFER[*],RESF);                                49600000
               EDIT(1,RESULT,OUTBUFFER[2],0,                            49610000
               1,JUNK,TRANSLATEBUFFER,0);                               49620000
               WRITE(OUTFI,9,OUTBUFFER[*]);                             49630000
               CLEAR(OUTBUFFER,9);                                      49640000
               IF ERRS:=ANALYZEDESC(RESULT,JUNKBUFFER)-1 GEQ 0          49650000
               THEN                                                     49660000
               FOR Y:=0 STEP 1 UNTIL ERRS DO                            49670000
               BEGIN                                                    49680000
                    MOVE(6,JUNKBUFFER[Y|6],OUTBUFFER[2]);               49690000
                    WRITE(OUTFI,6,OUTBUFFER[*]);                        49700000
               END                                                      49710000
               ELSE                                                     49720000
               WRITE(OUTFI,NOERRF);                                     49730000
               IF WRITERR THEN GO DOIO;                                 49740000
     CHECK:                                                             49750000
               IF ABREV THEN GO XIT;                                    49760000
               IF WRT OR MAINT THEN                                     49770000
               BEGIN                                                    49780000
                    IF RESULT.[33:15]=IOD[BUFFERNR].[33:15]+1 THEN      49790000
                    BEGIN                                               49800000
                         WRITE(OUTFI,NOTRANSF);                         49810000
                          IF X NEQ 3 THEN E[X]:=0;                      49820000
                         GO DOIO;                                       49830000
                    END ELSE                                            49840000
                    IF COMPAREDATA THEN                                 49850000
     DISPLAY:                                                           49860000
                    FOR I:=0 STEP 1 UNTIL X-1 DO                        49870000
                    IF REAL(COMPAREDATA)=E[I] THEN IF NOT               49880000
                    V:=COMPARED(BUFFLTH,DISK[BUFFERNR,1],RTY[Z:=I,0],0) 49890000
                    THEN                                                49900000
                    BEGIN                                               49910000
                         WRITE(OUTBUFFER[*],RACT,BUFFLTH,IF BCL         49920000
                              THEN "BCL" ELSE "INT");                   49930000
                         WRITE(TESTBUFFER[*],ISAABF,I);                 49940000
                         MOVE(2,TESTBUFFER,OUTBUFFER[3]);               49950000
                         WRITE(OUTFI,5,OUTBUFFER[*]);                   49960000
                         IF X NEQ 3 THEN E[X]:=-REAL(COMPAREDATA);      49970000
                         GO DOIO;                                       49980000
                    END;                                                49990000
                    WRITE(OUTFI);                                       50000000
                    IF COMPAREDATA THEN                                 50010000
                    BEGIN                                               50020000
                         WRITE(OUTFI,RACT,BUFFLTH,IF BCL THEN           50030000
                              "BCL" ELSE "INT");                        50040000
                         SPOUT(DISK,BUFFERNR);                          50050000
                         WRITE(OUTFI);                                  50060000
                         IF X NEQ 3 THEN E[X]:=REAL(COMPAREDATA);       50070000
                         IF WRT THEN                                    50080000
                         WRITE(OUTFI,WDIFF,(JUNK:=REAL(COMPAREDATA))    50090000
                               .[27:9],JUNK.[18:6],JUNK.[36:6]) ELSE    50100000
                         IF MAINT THEN                                  50110000
                         WRITE(OUTFI,M2DIFF,(JUNK:=REAL(COMPAREDATA)).  50120000
                              [27:9],JUNK.[18:6],JUNK.[36:6]);          50130000
                         IF E[K]=0 THEN                                 50140000
                         BEGIN                                          50150000
                              K:=X; GO DOIO;                            50160000
                         END ELSE                                       50170000
                         IF X NEQ 0 AND Z NEQ K THEN                    50180000
                         V:=COMPARED(BUFFLTH,DISK[BUFFERNR,1],          50190000
                              RTY[K,0],0);                              50200000
                         IF X NEQ 0 THEN                                50210000
                         WRITE(OUTFI[DBL],LRDIFF,(JUNK:=REAL(V)).[27:9],50220000
                               JUNK.[18:6],K,JUNK.[36:6]);              50230000
                         K:=X;                                          50240000
                    END ELSE                                            50250000
                    BEGIN                                               50260000
                         IF X NEQ 3 THEN E[X]:=0;                       50270000
                         WRITE(OUTBUFFER[*],RACT,BUFFLTH,IF BCL THEN    50280000
                              "BCL" ELSE "INT");                        50290000
                         WRITE(TESTBUFFER[*],NOCOMP[REAL(M2)]);         50300000
                         MOVE(4,TESTBUFFER,OUTBUFFER[3]);               50310000
                         WRITE(OUTFI,9,OUTBUFFER[*]);                   50320000
                    END;                                                50330000
               END  ELSE                                                50340000
               IF COMPAREDATA THEN GO DISPLAY ELSE                      50350000
               WRITE(OUTFI,NOTRANSF);                                   50360000
     DOIO:                                                              50370000
               IF WRITERR THEN                                          50380000
               IF RESULT.[33:15]=IOD[BUFFERNR].[33:15]+1 THEN           50390000
               WRITE(OUTFI,NOWTRANSF);                                  50400000
               IF X:=(I:=X)+1=4 THEN GO XIT ELSE                        50410000
               IF READERR THEN IF E[I] GTR 0 THEN                       50420000
               MOVE(BUFFLTH,DISK[BUFFERNR,1],RTY[I,0]);                 50430000
               OLR[I]:=RESULT;                                          50440000
               IOREQUEST(-(RES[BUFFERNR]:=IOD[BUFFERNR])&0              50450000
                    [25:40:8],RES[BUFFERNR],LOCATION[BUFFERNR]);        50460000
               JUNK:=LOCATION[BUFFERNR].[33:15];                        50470000
               WAIT(JUNK,IOMASK);                                       50480000
               IF RES[BUFFERNR].[25:8] NEQ 0 THEN                       50490000
               BEGIN                                                    50500000
                    IF READERR THEN                                     50510000
                    COMPAREDATA:=COMPARE(BUFFERNR );                    50520000
                    GO RETRY;                                           50530000
               END                                                      50540000
               ELSE IF READERR THEN DOIRETRY                            50550000
               ELSE GO OK;                                              50560000
          END;                                                          50570000
     OK:                                                                50580000
          WRITE(OUTFI[DBL]);                                            50590000
          WRITE(OUTFI[DBL],OKF,X);                                      50600000
     XIT:                                                               50610000
          WRITE(OUTFI);                                                 50620000
          COMPAREDATA:=FALSE;                                           50630000
     END ERRORANALYSIS;                                                 50640000
%***********************************************************************50650000
     STREAM PROCEDURE GETPATERN(BUFFLTH,SHIFTBUFF,PATERN);              50660000
          VALUE BUFFLTH,PATERN;                                         50670000
          BEGIN                                                         50680000
          LABEL XIT;                                                    50690000
               DI:=SHIFTBUFF;                                           50700000
               PATERN(BUFFLTH(DS:=8 LIT "EEEEEEEE"); JUMP OUT           50710000
                       TO XIT);                                         50720000
               BUFFLTH(DS:=8 LIT "Q}{|Q}{|");                           50730000
          XIT:                                                          50740000
          END GETSTD;                                                   50750000
%***********************************************************************50760000
     PROCEDURE GETNEWADDRESS(CODE); VALUE CODE; INTEGER CODE;           50770000
          BEGIN                                                         50780000
               LABEL XIT,DONE,DFAKE;                                    50790000
               INTEGER I,DIRECT;                                        50800000
               REAL JUMP;                                               50810000
               IF ADDRESSINGCOMPLETE THEN                               50820000
               BEGIN FILEADDR:=-1; GO XIT; END;                         50830000
               FILEADDR:=IF CODE MOD 2=0 THEN                           50840000
               DA[ABS(WRTOG-1),0] ELSE DA[ABS(RDTOG-3),2];              50850000
               COUNT:=COUNT+REAL(TEST NEQ 2 OR JUMPOFF NEQ 1);          50860000
               DIRECT:=IF REV THEN -1 ELSE 1;                           50870000
               IF MAINT THEN                                            50880000
               BEGIN                                                    50890000
                    IF REV THEN                                         50900000
                    IF FILEADDR:=FILEADDR-SZ[ZNE(FILEADDR)] GEQ         50910000
                    JUMPOFF THEN GO XIT ELSE ELSE                       50920000
                    IF FILEADDR:=FILEADDR+SZ[ZNE(FILEADDR)] LEQ         50930000
                    JUMPOFF THEN GO XIT;                                50940000
                    IF JUMP:=JA[REAL(REV),JUMPCOUNT:=JUMPCOUNT+2]       50950000
                    LSS 0 THEN                                          50960000
          DFAKE:                                                        50970000
                    BEGIN                                               50980000
                         ADDRESSINGCOMPLETE:=TRUE;                      50990000
                         JUMPCOUNT:=0;                                  51000000
                         IF REV THEN FILEADDR:=-1 ELSE GO DONE;         51010000
                    END ELSE                                            51020000
                    BEGIN                                               51030000
                         FILEADDR:=JUMP;                                51040000
                         JUMPOFF:=JA[REAL(REV),JUMPCOUNT+1];            51050000
                    END;                                                51060000
               END ELSE                                                 51070000
               BEGIN                                                    51080000
                    IF REV THEN IF FILEADDR:=FILEADDR-DELTA             51090000
                    GEQ BEGINADDR THEN GO XIT ELSE ELSE                 51100000
                    IF FILEADDR:=FILEADDR+DELTA LEQ ENDADDR THEN        51110000
                    GO XIT;                                             51120000
                    IF LONG THEN                                        51130000
                    IF COUNT LSS SEGS THEN                              51140000
                    BEGIN                                               51150000
                         COUNTUP(JUMPOFF);                              51160000
                         SFA:=FILEADDR:=SFA+JUMPOFF;                    51170000
                         SWITCHER:=TRUE;                                51180000
                    END ELSE GO DFAKE ELSE                              51190000
                    IF COUNT LEQ SEGS THEN                              51200000
                    FILEADDR:=SFA:=SFA+DIRECT ELSE GO DFAKE;            51210000
               END;                                                     51220000
          XIT:                                                          51230000
               IF CODE=0 THEN                                           51240000
               BEGIN                                                    51250000
                    FOR I:=3 STEP-1 UNTIL 2 DO                          51260000
                    DA[WRTOG,I]:=DA[WRTOG,I-1];                         51270000
                    DA[WRTOG,0]:=DA[WRTOG,1]:=FILEADDR;                 51280000
               END ELSE                                                 51290000
               IF CODE=1 THEN                                           51300000
               FOR I:=0 STEP 1 UNTIL 3 DO                               51310000
                   DA[RDTOG - 2,I]:=FILEADDR                            51320000
               ELSE                                                     51330000
               IF CODE=2 THEN                                           51340000
               DA[WRTOG,0]:=DA[WRTOG,1]:=FILEADDR                       51350000
               ELSE                                                     51360000
               DA[I:=(RDTOG - 2),2]:=DA[I,3]:=FILEADDR;                 51370000
     DONE:                                                              51380000
     END;                                                               51390000
%***********************************************************************51400000
     STREAM PROCEDURE TESTDESCRIPTION(TEST,MAINT,WRT,REV,SHIF,LONG,     51410000
          OUTBUFFER,BUFFLTH); VALUE TEST,MAINT,WRT,REV,SHIF,LONG,       51420000
          BUFFLTH;                                                      51430000
          BEGIN                                                         51440000
               LABEL S,WD,XIT,T,P,W,L;                                  51450000
%                                                                       51460000
               DI:=OUTBUFFER;                                           51470000
               DS:=5 LIT "TEST ";                                       51480000
               SI:=LOC TEST; DS:=2 DEC; DI:=DI-2; DS:=FILL;             51490000
               DI:=OUTBUFFER; DI:=DI+7; DS:=2 LIT " (";                 51500000
               MAINT(DS:=LIT "M"; WRT(DS:=LIT "1"; JUMP OUT 2 TO S);    51510000
                    DS:=LIT "2"; JUMP OUT TO S);                        51520000
               DS:=6 LIT "NORMAL";                                      51530000
          S:   DS:=11 LIT " SEGMENTS--";                                51540000
               MAINT(WRT(JUMP OUT 2 TO T); DS:=24 LIT                   51550000
                    "READ-ONLY SEGMENTS TEST,");                        51560000
          T:                                                            51570000
               WRT(JUMP OUT TO L); MAINT(JUMP OUT TO L);                51580000
               DS:=17 LIT "READABILITY TEST,";                          51590000
          L:                                                            51600000
               LONG(DS:=24 LIT "SEGMENT CROSS-OVER TEST,";              51610000
                    JUMP OUT TO WD);                                    51620000
               WRT(DS:=10 LIT "WORST CASE"; SHIF(DS:=9 LIT " SHIFTING"; 51630000
                    JUMP OUT 2 TO P); DS:=9 LIT " CONSTANT");           51640000
          P:                                                            51650000
               WRT(DS:=9 LIT " PATTERN,");                              51660000
          WD:  SI:=LOC BUFFLTH; DS:=2 DEC;                              51670000
               DS:=4 LIT " WD ";                                        51680000
               REV(DS:=7 LIT "REVERSE"; JUMP OUT TO W);                 51690000
               DS:=7 LIT "FORWARD";                                     51700000
          W:                                                            51710000
               WRT(DS:=4 LIT " R/W"; JUMP OUT TO XIT);                  51720000
               DS:=6 LIT " READS";                                      51730000
          XIT: DS:=LIT ")"; END;                                        51740000
%***********************************************************************51750000
     PROCEDURE RUNATEST(TEST); VALUE TEST; INTEGER TEST;                51760000
          BEGIN                                                         51770000
               LABEL                                                    51780000
                    LOOP,                                               51790000
                    LOOP1,                                              51800000
                    LOOP2,                                              51810000
                    STARTLONGLOOP,                                      51820000
                    LONGWRITE,                                          51830000
                    STARTLONGREAD,                                      51840000
                    LONGREAD,                                           51850000
                    MAKESWITCH,                                         51860000
                    REVLOOP,                                            51870000
                    FINISHUP,                                           51880000
                    XIT,                                                51890000
                    ABORT,                                              51900000
                    STARTRDLOOP;                                        51910000
               FORMAT                                                   51920000
                      DASH(72("-")),                                    51930000
                      STOPF("TEST ",I2," TERMINATED BY ",               51940000
                           "OPERATOR"),                                 51950000
                      INVIN(" INV IN~"),                                51960000
                      EUF("EU ",I2,"--DISK MODEL ",A2," (",I2,          51970000
                           " MS)"),                                     51980000
                      NOTDOF("TEST",I3," NOT PERFORMED ",               51990000
                             "(DISK CONFLICT)"),                        52000000
                      WRTLOCKF("TEST",I3," NOT PERFORMED ",             52010000
                      "(WRITE-LOCK)"),                                  52020000
                      ERRORF(I6," SEGMENTS FAILED TEST"),               52030000
                      SEGSF(I6," SEGMENTS TESTED"),                     52040000
                      ETEST("END OF TEST ",I2," RESULTS");              52050000
               INTEGER                                                  52060000
                    I,                                                  52070000
                    REPEAT;                                             52080000
               REAL JUNK;                                               52090000
               BOOLEAN STOPTOG;                                         52100000
               DEFINE STOPCHECK=                                        52110000
                    IF STOPPER NEQ 0 THEN                               52120000
                    IF STOPPER GTR 3 OR STOPPER LSS 0 THEN              52130000
                    BEGIN                                               52140000
                         WRITE(SPO,INVIN);                              52150000
                         STOPPER:=0;                                    52160000
                    END ELSE GO XIT#;                                   52170000
%***********************************************************************52180000
     BOOLEAN PROCEDURE NOTDONE;                                         52190000
          BEGIN                                                         52200000
          INTEGER I,J;                                                  52210000
               FOR I:=0 STEP 1 UNTIL 1 DO                               52220000
               FOR J:=0 STEP 1 UNTIL 3 DO                               52230000
               IF DA[I,J] GEQ 0 THEN                                    52240000
               BEGIN; I:=J:=3; NOTDONE:=TRUE; END;                      52250000
          END;                                                          52260000
%***********************************************************************52270000
%                                                                       52280000
               MAINT:=TEST=1 OR(TEST GTR 3 AND TEST LSS 8);             52290000
               WRT:=TEST GTR 3 OR TEST=2;                               52300000
               IF NOT MAINT AND WRT AND NOWRT THEN                      52310000
               BEGIN                                                    52320000
                    WRITE(OUTFI,DASH);                                  52330000
                    WRITE(OUTFI,NOTDOF,TEST);                           52340000
                    WRITE(OUTFI,DASH);                                  52350000
                    GO ABORT;                                           52360000
               END;                                                     52370000
               IF WRT AND WRTLOCK THEN                                  52380000
               BEGIN                                                    52390000
                    WRITE(OUTFI,DASH);                                  52400000
                    WRITE(OUTFI,WRTLOCKF,TEST);                         52410000
                    WRITE(OUTFI,DASH);                                  52420000
                    GO ABORT;                                           52430000
               END;                                                     52440000
               ABREV:=(REAL(BOOLEAN(ABREVIATE) AND BOOLEAN(ENTIER       52450000
                    (2*TEST))) NEQ 0);                                  52460000
               REV:=TEST GEQ 5 AND TEST MOD 2 = 1;                      52470000
               SHIF:=TEST=6 OR TEST=7 OR TEST=10 OR TEST=11;            52480000
               IF IGNORERRORS:=BOOLEAN((REPEAT:=TESTARRAY[TEST]).       52490000
                    [1:1]) THEN                                         52500000
               REPEAT:=ABS(REPEAT);                                     52510000
               BUFFLTH:=IF LONG:=TEST=2 THEN 45 ELSE IF MAINT           52520000
               THEN 12 ELSE 30;                                         52530000
               IOD[0]:=(COREADDR(DISK[0,0]))&BUFFLTH[8:38:10]&          52540000
               (I:=((BUFFLTH+29)DIV 30 +512))[18:33:15]&TINU[3:43:5];   52550000
               IOD[1]:=IOD[0]&COREADDR(DISK[1,0])[33:33:15];            52560000
               IOD[2]:=COREADDR(DISK[2,0])&BUFFLTH[8:38:10]&I           52570000
                    [18:33:15]&TINU[3:43:5]&1[24:47:1];                 52580000
               IOD[3]:=IOD[2]&COREADDR(DISK[3,0])[33:33:15];            52590000
               JUNK:=COREADDR(RES);                                     52600000
               FOR I:=0 STEP 1 UNTIL 3 DO                               52610000
               LOCATION[I]:=(JUNK+I)&UNIT[12:42:6]&1[2:47:1];           52620000
               GETPATERN(BUFFLTH+1,SHIFTBUFF,ABS(REAL(WRT)-1));         52630000
               IF NOT SHIF THEN                                         52640000
               BEGIN                                                    52650000
                    MOVE(BUFFLTH,SHIFTBUFF,DISK[0,1]);                  52660000
                    MOVE(BUFFLTH,SHIFTBUFF,DISK[1,1]);                  52670000
                    IF (NOT MAINT) OR WRT THEN                          52680000
                    BEGIN                                               52690000
                         MOVE(BUFFLTH,SHIFTBUFF,COMPAREBUFF[0,1]);      52700000
                         MOVE(BUFFLTH,SHIFTBUFF,COMPAREBUFF[1,1]);      52710000
                    END;                                                52720000
               END;                                                     52730000
          LOOP:                                                         52740000
               WRITE(OUTFI[DBL]);                                       52750000
               RDTOG:=2; WRTOG:=0;                                      52760000
               WRITE(OUTFI);                                            52770000
               CLEAR(OUTBUFFER,9);                                      52780000
               TESTDESCRIPTION(TEST,MAINT,WRT,REV,SHIF,LONG,            52790000
                    OUTBUFFER,BUFFLTH);                                 52800000
               WRITE(OUTFI,9,OUTBUFFER[*]);                             52810000
               WRITE(OUTFI,DASH);                                       52820000
               WRITE(OUTFI[DBL]);                                       52830000
               WRITE(OUTFI[DBL],EUF,BEGINADDR DIV 1000000,              52840000
                    IF FORTYMILL THEN "1B" ELSE "1A",20|DKTYPE);        52850000
               COUNT:=ERROR:=CYNUMR:=CYNUM:=0;                          52860000
               COMPAREDATA:=ADDRESSINGCOMPLETE:=FALSE;                  52870000
               RES[0]:=RES[1]:=RES[2]:=RES[3]:=IOMASK;                  52880000
               SFA:=FILEADDR:=IF REV THEN ENDADDR ELSE BEGINADDR;       52890000
               STOPCHECK;                                               52900000
               IF REV THEN                                              52910000
               BEGIN                                                    52920000
                    IF MAINT THEN                                       52930000
                    BEGIN                                               52940000
                         FILEADDR:=JA[1,0];                             52950000
                         JUMPOFF:=JA[1,1];                              52960000
                    END;                                                52970000
                    DA[0,0]:=DA[0,1]:=FILEADDR;                         52980000
                    DA[0,2]:=DA[0,3]:=-1;                               52990000
                    DA[1,0]:=DA[1,1]:=DA[1,2]:=DA[1,3]:=-1;             53000000
                    W(0);                                               53010000
          REVLOOP:                                                      53020000
                    WC(WRTOG);                                          53030000
                    STOPCHECK;                                          53040000
                    GETNEWADDRESS(0);                                   53050000
                    IF ADDRESSINGCOMPLETE THEN IF NOTDONE THEN          53060000
                    W(WRTOG) ELSE GO XIT ELSE W(WRTOG);                 53070000
                    RC(RDTOG);                                          53080000
                    REED(RDTOG);                                        53090000
                    GO REVLOOP;                                         53100000
               END                                                      53110000
               ELSE                                                     53120000
               IF LONG THEN                                             53130000
               BEGIN                                                    53140000
                    ENDADDR:=ENDADDR-1;%TO PREVENT INV DSK ADDR         53150000
                    DA[0,0]:=DA[0,1]:=DA[0,2]:=DA[0,3]:=BEGINADDR;      53160000
                    JUMPOFF:=1;                                         53170000
          STARTLONGLOOP:                                                53180000
                    W(WRTOG);                                           53190000
          LONGWRITE:                                                    53200000
                    WC(WRTOG);                                          53210000
                    STOPCHECK;                                          53220000
                    GETNEWADDRESS(1);                                   53230000
                    IF SWITCHER THEN GO STARTLONGREAD ELSE              53240000
                    W(WRTOG);                                           53250000
                    GO LONGWRITE;                                       53260000
          STARTLONGREAD:                                                53270000
                    SWITCHER:=FALSE;                                    53280000
                    COUNTUP(WRTOG);                                     53290000
                    WC(WRTOG);                                          53300000
                    REED(RDTOG);                                        53310000
                    GETNEWADDRESS(1);                                   53320000
                    IF SWITCHER OR ADDRESSINGCOMPLETE THEN              53330000
                    GO MAKESWITCH;                                      53340000
                    REED(RDTOG);                                        53350000
          LONGREAD:                                                     53360000
                    RC(RDTOG);                                          53370000
                    STOPCHECK;                                          53380000
                    GETNEWADDRESS(1);                                   53390000
                    IF ADDRESSINGCOMPLETE OR SWITCHER THEN              53400000
          MAKESWITCH:                                                   53410000
                    BEGIN                                               53420000
                         WRTOG:=RDTOG-2;                                53430000
                         COUNTUP(RDTOG);                                53440000
                         RC(RDTOG);                                     53450000
                         SWITCHER:=FALSE;                               53460000
                         GO TO IF ADDRESSINGCOMPLETE THEN XIT           53470000
                         ELSE STARTLONGLOOP;                            53480000
                    END;                                                53490000
                    REED(RDTOG);                                        53500000
                    GO LONGREAD;                                        53510000
               END                                                      53520000
               ELSE                                                     53530000
               BEGIN                                                    53540000
                    IF MAINT THEN                                       53550000
                    BEGIN                                               53560000
                         FILEADDR:=JA[0,0];                             53570000
                         JUMPOFF:=JA[0,1];                              53580000
                         IF TEST=1 THEN                                 53590000
                         FINDGOODM2PATTERN(FILEADDR);                   53600000
                    END;                                                53610000
                    IF WRT THEN                                         53620000
                    BEGIN                                               53630000
                         DA[0,0]:=DA[0,1]:=FILEADDR;                    53640000
                         W(0);                                          53650000
          LOOP1:                                                        53660000
                         WC(WRTOG);                                     53670000
                         STOPCHECK;                                     53680000
                         GETNEWADDRESS(2);                              53690000
                         IF ADDRESSINGCOMPLETE THEN GO STARTRDLOOP;     53700000
                         W(WRTOG);                                      53710000
                         GO LOOP1;                                      53720000
          STARTRDLOOP:                                                  53730000
                         ADDRESSINGCOMPLETE:=FALSE;                     53740000
                         COUNTUP(WRTOG);                                53750000
                         WC(WRTOG);                                     53760000
                         COUNT:=0;                                      53770000
                         IF MAINT THEN                                  53780000
                         BEGIN                                          53790000
                              FILEADDR:=JA[0,0];                        53800000
                              JUMPOFF:=JA[0,1];                         53810000
                         END ELSE FILEADDR:=BEGINADDR;                  53820000
                    END;                                                53830000
                    SFA:=DA[0,2]:=DA[0,3]:=FILEADDR;                    53840000
                    REED(2);                                            53850000
                    STOPCHECK;                                          53860000
                    GETNEWADDRESS(3);                                   53870000
                    IF ADDRESSINGCOMPLETE THEN                          53880000
                    BEGIN RC(2); GO XIT; END;                           53890000
                    REED(3);                                            53900000
          LOOP2:                                                        53910000
                    RC(RDTOG);                                          53920000
                    STOPCHECK;                                          53930000
                    GETNEWADDRESS(3);                                   53940000
                    IF ADDRESSINGCOMPLETE THEN GO FINISHUP;             53950000
                    REED(RDTOG);                                        53960000
                    GO LOOP2;                                           53970000
          FINISHUP:                                                     53980000
                    COUNTUP(RDTOG);                                     53990000
                    RC(RDTOG);                                          54000000
               END;                                                     54010000
          XIT:                                                          54020000
               IF STOPPER NEQ 0 THEN                                    54030000
               BEGIN                                                    54040000
                    FOR I:=0 STEP 1 UNTIL 3 DO                          54050000
                    BEGIN                                               54060000
                         JUNK:=LOCATION[I].[33:15];                     54070000
                         WAIT(JUNK,IOMASK);                             54080000
                         %MAKE SURE ALL I/O IS FINISHED                 54090000
                    END;                                                54100000
                    WRITE(OUTFI,STOPF,TEST);                            54110000
                    IF STOPPER NEQ 1 THEN                               54120000
                    FOR I:=0 STEP 1 UNTIL NUMBEROFTESTS DO              54130000
                    TESTARRAY[I]:=0;                                    54140000
                    STOPTOG:=TRUE;                                      54150000
                    REPEAT:=0;                                          54160000
                    IF STOPPER GTR 1 THEN                               54170000
                    IF INSWITCH=2 AND DONETOG THEN                      54180000
                    BEGIN                                               54190000
                         INSWITCH:=1;                                   54200000
                         DONETOG:=FALSE;                                54210000
                    END;                                                54220000
                    STOPPER:=REAL(STOPPER=3);                           54230000
               END;                                                     54240000
               IF LONG THEN ENDADDR:=ENDADDR+1;                         54250000
               IF ERROR GTR 0 THEN IF PAGE THEN WRITE(OUTFI[PAGE])      54260000
               ELSE WRITE(OUTFI,STAR);                                  54270000
               WRITE(OUTFI,SEGSF,COUNT);                                54280000
               WRITE(OUTFI,ERRORF,ERROR);                               54290000
               WRITE(OUTFI,ETEST,TEST);                                 54300000
               IF REPEAT:=REPEAT-1 GTR 0 THEN GO LOOP;                  54310000
          ABORT: IF OUTSWITCH NEQ 1 THEN WRITE(OUTFI[PAGE]);            54320000
               IF BOOLEAN(STOPPER) AND STOPTOG THEN TERMINATE           54330000
               ELSE STOPTOG:=FALSE;                                     54340000
          END;                                                          54350000
%***********************************************************************54360000
     PROCEDURE SETUPMAINT;                                              54370000
          BEGIN                                                         54380000
          INTEGER EU,BSU,ESU,A1,A2,A3,I,EA,BA,RBA,FEA;                  54390000
          LABEL WRAPUP,COLLECT;                                         54400000
 %                                                                      54410000
               BA:=MAINTADDR(-BEGINADDR);                               54420000
               FEA:=MAINTADDR(-ENDADDR);                                54430000
               REV:=TRUE;                                               54440000
               RBA:=MAINTADDR(-BEGINADDR);                              54450000
               EA:=MAINTADDR(-ENDADDR);                                 54460000
               BSU:=(((BA DIV 10000)MOD 100) DIV 8);                    54470000
               ESU:=(((EA DIV 10000)MOD 100)DIV 8);                     54480000
               EU:=BA DIV 1000000;                                      54490000
               IF SEGS LSS 40000 OR NOT FORTYMILL THEN                  54500000
               BEGIN                                                    54510000
                    JA[0,0]:=BA; JA[0,1]:=FEA;                          54520000
                    JA[1,0]:=EA; JA[1,1]:=RBA;                          54530000
               END ELSE                                                 54540000
               BEGIN                                                    54550000
                    IF A1:=(1000000|EU+80000|BSU+40000) GTR BA THEN     54560000
                    BEGIN                                               54570000
                         JA[0,0]:=BA; JA[0,1]:=BA+39999;                54580000
                    END ELSE                                            54590000
                    BEGIN                                               54600000
                         JA[0,0]:=BA; JA[0,1]:=A1+39999;                54610000
                    END;                                                54620000
                    IF A2:=(1000000|EU+80000|ESU+39999) LSS EA          54630000
                    THEN                                                54640000
                    BEGIN                                               54650000
                         JA[1,0]:=EA; JA[1,1]:=EA-39999;                54660000
                    END ELSE                                            54670000
                    BEGIN                                               54680000
                         JA[1,0]:=EA; JA[1,1]:=A2-39999;                54690000
                    END;                                                54700000
                    A1:=A1+40000; A2:=A2-40000;                         54710000
                    IF A1 GTR EA THEN GO WRAPUP ELSE                    54720000
                    FOR I:=2 STEP 2 WHILE TRUE DO                       54730000
                    BEGIN                                               54740000
                         IF A1+80000 GTR EA THEN GO COLLECT;            54750000
                         JA[0,I]:=A1; JA[0,I+1]:=A1+39999;              54760000
                         JA[1,I]:=A2; JA[1,I+1]:=A2-39999;              54770000
                         A1:=A1+80000;                                  54780000
                         A2:=A2-80000;                                  54790000
                    END;                                                54800000
          COLLECT:                                                      54810000
                    IF EA GTR A3:=(1000000|EU+80000|ESU+39999) THEN     54820000
                    BEGIN                                               54830000
                         JA[0,I]:=A1; JA[0,I+1]:=A3;                    54840000
                    END ELSE                                            54850000
                    BEGIN                                               54860000
                         JA[0,I]:=A1; JA[0,I+1]:=FEA;                   54870000
                    END;                                                54880000
                    IF A3:=(1000000|EU+80000|BSU+40000) GTR BA THEN     54890000
                    BEGIN                                               54900000
                         JA[1,I]:=A2; JA[1,I+1]:=A3;                    54910000
                    END ELSE                                            54920000
                    BEGIN                                               54930000
                         JA[1,I]:=A2; JA[1,I+1]:=RBA;                   54940000
                    END;                                                54950000
               END;                                                     54960000
          WRAPUP:                                                       54970000
               JA[0,I:=I+2]:=JA[1,I]:=-1;                               54980000
               REV:=FALSE;                                              54990000
     END;                                                               55000000
%***********************************************************************55010000
          WRT:=SHIF:=MAINT:=REV:=LONG:=SWITCHER:=ADDRESSINGCOMPLETE:=   55011000
          COMPAREDATA:=ABREV:=IGNORERRORS:=FALSE;                       55012000
          CYNUMR:=SFA:=BUFFLTH:=JUMPOFF:=JUMPCOUNT:=CYNUM:=             55013000
          WRTOG:=0;                                                     55014000
     COMMENT: THE ABOVE STATEMENTS ARE INCLUDED TO INSURE               55015000
              THAT ALL VARIABLES IN THIS BLOCK ARE PROPERLY             55016000
              INITIALIZED - THIS IS NECESSARY BECAUSE THE               55017000
              VARIABLES OCCUPY THE SAME PRT LOCATIONS AS                55018000
              AS DO VARIBLES LOCAL TO THE SCAN BLOCK;                   55019000
          IF FORTYMILL:=DKTYPE=2 THEN                                   55020000
          BEGIN                                                         55030000
               SZ[0]:=25; SZ[1]:=33; SZ[2]:=42; SZ[4]:=25;              55040000
               SZ[5]:=58;                                               55050000
          END ELSE                                                      55060000
          BEGIN                                                         55070000
               SZ[0]:=24; SZ[1]:=32; SZ[2]:=44; SZ[4]:=24;              55080000
               SZ[5]:=56;                                               55090000
          END;                                                          55100000
          FOR TEST:=1,4,5,6,7 DO                                        55130000
          IF TESTARRAY[TEST] NEQ 0 THEN                                 55140000
          BEGIN SETUPMAINT; GO RUNTESTS; END;                           55150000
     RUNTESTS:                                                          55160000
          FOR TEST:=1 STEP 1 UNTIL NUMBEROFTESTS DO                     55170000
          IF TESTARRAY[TEST] NEQ 0 THEN                                 55180000
          RUNATEST(TEST);                                               55190000
          GO TO IF DONETOG THEN ALLDONE ELSE RETURN;                    55200000
     END;                                                               55210000
%#########END OF DISK TEST BLOCK########################################55220000
     ALLDONE:                                                           55230000
          IF NOT FILEOPENED THEN GO EXIT;                               55240000
          WRITE(OUTFI[DBL],DONETESTS);                                  55250000
          DATIME;                                                       55260000
     EXIT: END ONLINE MAINTENANCE ROUTINES.                             55270000
END;END.        LAST CARD ON 0CRDING TAPE                               99999999
