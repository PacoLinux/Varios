00000000000000000000000000000000000000000000000000000000000000000000000000000000
COMMENT ................................................................00001000
:                                                                      :00002000
:               ********  ALGOL FILTER ROUTINE  ********               :00003000
:                                                                      :00004000
:                        JAMES C. PAO  (03/26/68)                      :00005000
:                                                                      :00006000
:......................................................................;00007000
BEGIN  COMMENT OUTERMOST BLOCK TO FIX THE BLOCK & RECORD SIZES FOR THE  00008000
               INPUT FILES "TAPE" AND "CARD". * * * * * * * * * * * * *;00009000
REAL               DEBUGN;   % DEBUGGING THE GENERATED CODES.           00010000
INTEGER            I,J,K,Z;  % BLOCK & RECORD SIZES ALSO SCRATCHES.     00011000
BOOLEAN STREAM PROCEDURE  DSKFILE(FSQ);  % CHECK IF IT IS A DISK FILE.  00012000
     VALUE         FSQ;                                                 00013000
              BEGIN                                                     00014000
                   SI~LOC DSKFILE; SI~SI-7;                             00015000
                   DI~LOC DSKFILE; DI~DI+5; SKIP 3 DB;                  00016000
                   9(IF SB THEN DS~SET ELSE DS~RESET; SKIP SB);         00017000
                   DS~LIT"3";  SI~DSKFILE;  DI~LOC DSKFILE;  DS~WDS;    00018000
                   SI~DSKFILE;  FSQ(SI~SI+40);  SI~SI+31;               00019000
                   IF SC="-" THEN TALLY~1 ELSE                          00020000
                   IF SC>"9" THEN TALLY~1 ELSE TALLY~0;                 00021000
                   DSKFILE~TALLY;                                       00022000
              END  DSKFILE;                                             00023000
                   IF DSKFILE(1) THEN  % 1 FOR INPUT FILE "TAPE".       00024000
                   BEGIN I~10; J~150 END ELSE BEGIN I~56; J~10 END;     00025000
                   IF DSKFILE(2) THEN  % 2 FOR INPUT FILE "CARD".       00026000
                   BEGIN K~2; Z~150 END ELSE BEGIN K~5; Z~10 END;       00027000
BEGIN  COMMENT THIS IS THE BEGINNING OF THE PROGRAM.  * * * * * * * * *;00028000
FILE OUT           LINE 18(1,15);                                       00029000
FILE               TAPE(2,I,J);                                         00030000
FILE               PACH "CARD"(K,10,Z);                                 00031000
SAVE FILE          NEWTAPE DISK SERIAL[20:3000](2,10,150,SAVE 99);      00032000
FILE               PUNCH 0(2,10);                                  %001%00032500
FILE               DFSK DISK RANDOM[20:100](1,12,60);                   00033000
SAVE ARRAY         CV[0:11]; % OLD CARD IMAGE.                          00034000
SAVE ARRAY         CI[0:11]; % NEW GENERATE CARD IMAGE.                 00035000
SAVE ARRAY         DCI[0:11];     % CARD IMAGE FOR BUILDING DEFINE.     00036000
SAVE ARRAY         EV[0:19]; % RESULT FROM SCANNING.                    00037000
ARRAY              PC,PPC[0:12];  % PREVIOUS CARD IMAGE.                00038000
ARRAY              STKHD[0:124];  % SCRAMBLED-INDEX ARRAY.              00039000
ARRAY              INFO[0:31,0:255];   % IDENTIFIER STORAGE ARRAY.      00040000
ARRAY              CB[0:99,0:11]; % GENERATED CARD IMAGES.              00041000
ARRAY              INF[0:11];     % DEFINE ENTRY TO INFO[*,*].          00042000
ARRAY              STR[0:7,0:49]; % STORE FOR SCANNING.                 00043000
ARRAY              ACT[0:7]; % STORAGE OF DOLLAR CARD FOR DELAY ACTION. 00044000
ARRAY              A,B[0:14];     % SCRATCH ARRAYS.                     00045000
INTEGER            IFX;      % INDEX OF INFO[*,*] IN THE SCANNING.      00046000
INTEGER            CC0;      % STARTING ADDRESS OF THE CURRENT SCAN.    00047000
INTEGER            CC;       % CURRENT ADDRESS IN CARD BUFFER.          00048000
INTEGER            EST,EET;  % STARTING ADDRESS OF CARD BUFFER, CV[*].  00049000
INTEGER            CED;      % ENDING ADDRESS OF CARD BUFFER.           00050000
INTEGER            CST;      % STARTING ADDRESS OF CARD BUFFER.         00051000
INTEGER            IST;      % STARTING ADDRESS OF CI[0].               00052000
INTEGER            IC;       % CURRENT ADDRESS OF CI[*].                00053000
INTEGER            DST;      % STARTING ADDRESS OF DCI[*].              00054000
INTEGER            NCR;      % NO. OF CHRS SCANNED.                     00055000
INTEGER            NXT;      % NEXT CHR IN CARD BUFFER.                 00056000
INTEGER            NCD;      % CARD INDEX OF INPUT.                     00057000
INTEGER            NC0;      % CARD INDEX OF CURRENT SCAN STARTED.      00058000
INTEGER            NCE;      % CARD INDEX OF CURRENT SCAN ENDING.       00059000
INTEGER            OUTN;     % OUTPUT CARD IMAGE COUNT.                 00060000
INTEGER            ERX;      % ERROR INDICATION DURING EDITING.         00061000
INTEGER            ERRDFN;   % ERROR INDICATION DURING EXECUTING DEFINE.00062000
INTEGER            LFX;      % LOW INDEX OF INFO[*,*].                  00063000
INTEGER            HFX;      % HIGHEST INDEX OF INFO[*,*].              00064000
INTEGER            NFX;      % NEXT AVAILABLE INDEX OF INFO[*,*].       00065000
INTEGER            DFX;      % MAX INFO-INX OF RESRVD WDS FOR DECLARATN.00066000
INTEGER            RFX;      % MAX INFO-INX OF ABSOLUTE RESERVED WORDS. 00067000
INTEGER            CFX;      % MAX INFO-INX OF CONDITIONAL RESERVED WDS.00068000
INTEGER            EITNINES; % DECIMAL VALUE OF 99999999.               00069000
INTEGER            BLKCNT;   % BLOCK COUNT.                             00070000
INTEGER            DOLLAR;   % CARD INDEX AT WHICH $-CARD FUNCTIONS.    00071000
INTEGER            BBB,BB;   % NO. OF BLANKS ON THE CARD JUST READ.     00072000
INTEGER            NNO,INC;  % NEW SEQUENCE NO. AND INCREAMENT.         00073000
REAL               INV;      % OCT1400000000000000.                     00074000
REAL               DX;       % RECORD INDEX OF DFSK-FILE.               00075000
REAL               LDF;      % CURRENT LEVEL INDEX OF DEFINE EXECUTING. 00076000
REAL               LLF;      % LOWEST DEFINE LEVEL IN "CHECKNEXT".      00077000
REAL               CBX;      % ROW INDEX OF CB[*,*].                    00078000
REAL               AVC;      % NO. OF AVAILABLE CHRS IN CI[*].          00079000
REAL               BLK;      % 3-ZERO AND 5-BLANK.                      00080000
REAL               A89;      % "99999999".                              00081000
REAL               T0,T1,T2; % PROGRAM STARTING DATE AND TIME.          00082000
REAL               FST,LST;  % FIRST AND LAST CHR TYPE IN EDITING.      00083000
REAL               ND,NN,NR,NE;  % COUNTS OF DELD,NEW,RETAINED AND ERRS.00084000
REAL               R,P,T;    % SRATCH REALS.                            00085000
BOOLEAN            EOF;      % END-OF-FILE ON BOTH SYMBOLIC & PATCH.    00086000
BOOLEAN            NEWTP;    % CREATION OF A NEW SYMBOLIC FILE.         00087000
BOOLEAN            NEWTPED;  % THERE IS A NEWTAPE CREATED.              00088000
BOOLEAN            PNCH;     % PUNCH DECK REQUIRED.                %001%00088300
BOOLEAN            PNCHED;   % THERE HAS BEEN A PUNCH DECK.        %001%00088600
BOOLEAN            RESQ;     % RESEQUENCE REQUIRED.                     00089000
BOOLEAN            GENERATE; % GENERATION OF THE CURRENT STATEMENT.     00090000
BOOLEAN            CIVALID;  % CI[*] HAS VALID INFORMATION.             00091000
BOOLEAN            NEWCARD;  % A CARD JUST READ BEFORE ANY SCAN.        00092000
BOOLEAN            NEWCD;    % THE ITEM JUST SCANNED IS 1ST ITEM ON CRD.00093000
BOOLEAN            DFINE;    % DURING PROCESS OF A "DEFINE".            00094000
BOOLEAN            ENDCMMT;  % DURING SCANNING OF COMMENT AFTER "END".  00095000
BOOLEAN            B47;      % INDICATION OF GENERATING "47-".          00096000
BOOLEAN            BBK;      % BLANK INDICATOR USED IN SCAN-PROCEDURE.  00097000
BOOLEAN            FRSTPRNT; % FIRST LINE TO BE PRINTED.                00098000
BOOLEAN            STRM;     % DURING PROCCESSING OF A STREAM PROCEDURE.00099000
BOOLEAN            SQ1ST;    % INCREASE 1ST NEW CARD FOR NONRESEQUENCE. 00100000
BOOLEAN            LSTO,LSTN,LSTD;     % LISTING OF OLD, NEW & DELETED. 00101000
DEFINE             CNO=EV[17]#;   % SEQUENCE NO. OF THE SYMBOLIC FILE.  00102000
DEFINE             PNO=EV[18]#;   % SEQUENCE NO. OF THE PATCH DECK.     00103000
DEFINE             ENO=EV[19]#;   % ENDING SEQ NO. OF ITEM JUST SCANNED.00104000
DEFINE             FOU=LINE#,  CARD=TAPE#,  NTP=NEWTAPE#;               00105000
FORMAT             HDNG(X20,"BURROUGHS B-5500 TO B-6500 ALGOL FILTER",  00106000
                        X8,A4,I3,", ",A2,X3,I2,":",I2,X1,A1,".M."/);    00107000
FORMAT             TAIL(/X10,                                           00108000
                        "NUMBER OF CARDS WITH POSSIBLE ERRORS:",I6,"."  00109000
                        /X10,                                           00110000
                        "NUMBER OF CARDS DELETED:",I6,"."/X10,          00111000
                        "TOTAL NUMBER OF CARDS IN THE PROGRAM:",I6,     00112000
                        ";      RETAINED:",I6,";      GENERATED:",I6,   00113000
                        "."/X10,                                        00114000
                        "TIME USED FOR FILTERING:     PROCESSING:",I4,  00115000
                        " MIN. ",I2," SEC.;     ELAPSED:",I4," MIN. ",  00116000
                        I2," SEC..");                                   00117000
FORMAT             DBG(13(1O,X1));                                      00118000
PROCEDURE          DUMPARRAY(A,AXL,AXH,FOU,AB,ALPHANAME,NUMBER);        00119000
COMMENT ................................................................00120000
:        DUMP OUT THROUGH FILE (FOU) AN ONE-DIMENSIONAL ARRAY (A)      :00121000
: STARTING FROM (A[AXL]) TO (A[AXH]) IN ALPHA (AB=1) OR OCTAL (AB=0)   :00122000
: FORM.  (ALPHANAME) AND (NUMBER) WILL BE SHOWN AS THE HEADLINE.       :00123000
:                              --------  J. C. PAO   08/25/65  --------:00124000
:......................................................................;00125000
     VALUE         AXL,AXH,AB,ALPHANAME,NUMBER;                         00126000
     INTEGER       AXL,AXH,AB,NUMBER;                                   00127000
     ALPHA         ALPHANAME;                                           00128000
     ARRAY         A[*];                                                00129000
     FILE          FOU;                                                 00130000
              BEGIN                                                     00131000
       ARRAY       LN[0:14];                                            00132000
       INTEGER     I,W,L;                                               00133000
       BOOLEAN     BOOL;                                                00134000
       FORMAT      TTL("RECORD ",A6,I8,X5,"[",2A6,"]");                 00135000
       SWITCH FORMAT F~("----  ",6(X2,"-----------------")),            00136000
                       (X2,"----",X2,10(X2,"---------"));               00137000
       DEFINE      SLH=F[AB]#;                                          00138000
       LABEL       LL;                                                  00139000
STREAM PROCEDURE   OCT12(I,O1,O2);                                      00140000
     VALUE         I;                                                   00141000
              BEGIN                                                     00142000
                   SI~LOC I;  SI~SI+2;                                  00143000
                   DI~O1;  DI~DI+2;                                     00144000
                   6(SKIP 3 DB;                                         00145000
                     3(IF SB THEN DS~SET ELSE DS~RESET; SKIP SB));      00146000
                   DI~O2;  DI~DI+2;                                     00147000
                   6(SKIP 3 DB;                                         00148000
                     3(IF SB THEN DS~SET ELSE DS~RESET; SKIP SB));      00149000
              END  OCT12;                                               00150000
BOOLEAN STREAM PROCEDURE  SAME(A,B,N);                                  00151000
     VALUE         N;                                                   00152000
              BEGIN                                                     00153000
       LABEL       LL;                                                  00154000
                   SI~B; DI~A; TALLY~0;                                 00155000
                   N(IF 8 SC!DC THEN JUMP OUT TO LL);                   00156000
                   TALLY~1;                                             00157000
         LL:       SAME~TALLY;                                          00158000
              END  SAME;                                                00159000
STREAM PROCEDURE   EDIT(L,A,I,N,AB);                                    00160000
     VALUE         I,N,AB;                                              00161000
              BEGIN                                                     00162000
       LOCAL       W,T;                                                 00163000
                   SI~LOC AB; SI~SI+7; DI~L;                            00164000
                   IF SC="0" THEN                                       00165000
                   BEGIN                                                00166000
                     TALLY~6; N(TALLY~TALLY+63); T~TALLY;               00167000
                     SI~LOC I; DS~4 DEC; DS~2 LIT"  "; SI~A;            00168000
                     N(DS~LIT " ";                                      00169000
                       2(DS~LIT " ";                                    00170000
                         8(DS~3 RESET;                                  00171000
                           3(IF SB THEN DS~SET ELSE DS~RESET; SKIP SB)  00172000
                      ) ) );                                            00173000
                     T(DS~19 LIT "    ");                               00174000
                   END ELSE                                             00175000
                   BEGIN                                                00176000
                     TALLY~10; N(TALLY~TALLY+63); T~TALLY;              00177000
                     SI~LOC I; DS~2 LIT"  "; DS~4 DEC; DS~2 LIT"  ";    00178000
                   SI~A;                                                00179000
                     N(DS~LIT " "; 2(DS~LIT " "; DS~4 CHR));            00180000
                     T(DS~11 LIT "    "); DS~2 LIT "  ";                00181000
                   END;                                                 00182000
              END  EDIT;                                                00183000
                   WRITE(FOU);  OCT12(NUMBER,L,W);                      00184000
                   WRITE(FOU[DBL],TTL,ALPHANAME,NUMBER,L,W);            00185000
                   IF AB=0 THEN W~6 ELSE BEGIN AB~1; W~10 END;          00186000
                   IF (L~(AXH-AXL) DIV W + 1)=1 THEN W~AXH-AXL+1;       00187000
                   FOR I~1 STEP 1 UNTIL L DO                            00188000
                   BEGIN                                                00189000
                     IF I=1 THEN GO TO LL ELSE                          00190000
                     IF I=L THEN BEGIN W~AXH-(AXL~AXL+W)+1;GO TO LL END;00191000
                     IF SAME(A[AXL],A[AXL~AXL+W],W) THEN                00192000
                     BEGIN                                              00193000
                       IF NOT BOOL THEN                                 00194000
                       BEGIN WRITE(FOU,SLH); BOOL~TRUE END;             00195000
                     END ELSE                                           00196000
                     BEGIN                                              00197000
                       IF BOOL THEN BOOL~FALSE;                         00198000
         LL:           EDIT(LN[0],A[AXL],AXL,W,AB);                     00199000
                       IF I=L THEN WRITE(FOU[DBL],15,LN[*]) ELSE        00200000
                       WRITE(FOU,15,LN[*]);                             00201000
                     END;                                               00202000
                   END;                                                 00203000
              END  DUMPARRAY;                                           00204000
STREAM PROCEDURE   ADDSS(S,A);                                          00205000
COMMENT ................................................................00206000
:  THIS PROCEDURE STORE THE ABSOLUTE ADDRESS OF (A) INTO (S).          :00207000
:                              --------  J. C. PAO   11/02/66  --------:00208000
:......................................................................;00209000
              BEGIN                                                     00210000
                   SI~A; A~SI; SI~LOC A; DI~S; DS~WDS;                  00211000
              END  ADDSS;                                               00212000
STREAM PROCEDURE   TRNSFBTS(B,A,BB,AB,BITS);                            00213000
COMMENT ................................................................00214000
:    THIS PROCEDURE WILL TRANSFER "BITS" BITS FROM "A", BIT POSITION   :00215000
: "AB" TO "B", BIT POSITION "BB".    ("BITS"{4095)                     :00216000
:......................................................................;00217000
       VALUE       BB,AB,BITS;                                          00218000
              BEGIN                                                     00219000
       LOCAL       N;                                                   00220000
                   DI~LOC N; DI~DI+7; SI~LOC BITS; SI~SI+6; DS~CHR;     00221000
                   SI~A; SKIP AB SB; DI~B; SKIP BB DB;                  00222000
                   N(2(32(IF SB THEN DS~SET ELSE DS~RESET; SKIP SB)));  00223000
                   BITS(IF SB THEN DS~SET ELSE DS~RESET; SKIP SB);      00224000
              END  TRNSFBTS;                                            00225000
STREAM PROCEDURE   TRNSFCHR(A,B,AS,BS,CH);                              00226000
COMMENT ................................................................00227000
:  TRANSFER FROM (B), STARTING CHARACTER INDEX (BS), INTO (A), STARTING:00228000
:CHARACTER INDEX (AS), FOR (CH) CHARACTERS.   (CH{63)                  :00229000
:......................................................................;00230000
     VALUE         AS,BS,CH;                                            00231000
              BEGIN                                                     00232000
                   DI~A; DI~DI+AS;   SI~B; SI~SI+BS;   DS~CH CHR;       00233000
              END  TRNSFCHR;                                            00234000
STREAM PROCEDURE   TRNSFWDS(A,B,WD);                                    00235000
COMMENT ................................................................00236000
:  TRANSFER FROM "B" INTO "A" FOR "WD" WORDS.  ("WD" { 4095)           :00237000
:......................................................................;00238000
     VALUE         WD;                                                  00239000
              BEGIN                                                     00240000
       LOCAL       N;                                                   00241000
                   DI~LOC N; DI~DI+7; SI~LOC WD; SI~SI+6; DS~CHR;       00242000
                   DI~A; SI~B;                                          00243000
                   N(DS~32 WDS; DS~32 WDS);  DS~WD WDS;                 00244000
              END  TRNSFWDS;                                            00245000
STREAM PROCEDURE   CHRTRNSF(T,F,NC);                                    00246000
COMMENT ................................................................00247000
:    THIS PROCEDURE TRANSFERS (N) CHARACTERS FROM (F) TO (T).  BOTH (F):00248000
: AND (T) ARE CONSIDERED AS THE ABSOLUTE ADDRESSES.  AT THE END OF     :00249000
:TRANSFERRING, ONLY (T) IS UPDATED.                                    :00250000
:                              --------  J. C. PAO   04/15/66  ------  :00251000
:......................................................................;00252000
     VALUE         F,NC;                                                00253000
              BEGIN                                                     00254000
     LOCAL         I,J;                                                 00255000
                   SI~T; DI~LOC J; DS~WDS;                              00256000
                   SI~LOC NC; SI~SI+6;  DI~LOC I; DI~DI+7;  DS~CHR;     00257000
                   SI~F;  DI~J;                                         00258000
                   I(2(DS~32 CHR));  DS~NC CHR;                         00259000
                   J~DI; SI~LOC J; DI~T; DS~WDS;                        00260000
              END  CHRTRNSF;                                            00261000
INTEGER STREAM PROCEDURE   COMPAREA(A,B,AC,BC,N);                       00262000
COMMENT ................................................................00263000
:  TO COMPARE INFORMATION IN (A) AND (B) STARTING FROM CHARACTER INDEX :00264000
:(AC) AND (BC) RESPECTIVELY FOR (N) CHARACTERS.                        :00265000
:  THE VALUE OF "COMPARE":  A=B: 0,   A>B: +1,   A<B: -1.              :00266000
:                              --------  J. C. PAO   08/25/65  --------:00267000
:......................................................................;00268000
     VALUE         AC,BC,N;                                             00269000
              BEGIN                                                     00270000
       LABEL       L1,L2,L3,L4;                                         00271000
                   SI~A; SI~SI+AC;  DI~B; DI~DI+BC;                     00272000
         L1:       N(IF SC>DC THEN JUMP OUT 1 TO L2;                    00273000
                     SI~SI-1; DI~DI-1;                                  00274000
                     IF SC<DC THEN JUMP OUT 1 TO L3; );                 00275000
                   GO TO L4;                                            00276000
         L2:       TALLY~1; COMPAREA~TALLY; GO TO L4;                   00277000
         L3:       DI~LOC COMPAREA; DS~8 LIT "+0000001";                00278000
         L4:  END  COMPAREA;                                            00279000
INTEGER PROCEDURE   COMPAREB(A,B,AB,BB,N);                              00280000
COMMENT ................................................................00281000
:  TO COMPARE INFORMATION IN (A) AND (B) STARTING FROM CHARACTER INDEX :00282000
:(AC) AND (BC) RESPECTIVELY FOR (N) BITS IN BINARY.                    :00283000
:                              --------  J. C. PAO   08/25/65  --------:00284000
:......................................................................;00285000
     VALUE         AB,BB,N;                                             00286000
     INTEGER       AB,BB,N;                                             00287000
     REAL          A,B;                                                 00288000
              BEGIN                                                     00289000
       INTEGER     I,J,T,AW,BW;                                         00290000
       LABEL       L1;                                                  00291000
INTEGER STREAM PROCEDURE  INT(A,AW,AB,BTS,IO);                          00292000
     VALUE         AW,AB,BTS,IO;                                        00293000
              BEGIN                                                     00294000
                   DI~LOC INT; SKIP IO DB;                              00295000
                   SI~A; AW(SI~SI+8); SKIP AB SB;                       00296000
                   BTS(IF SB THEN DS~SET ELSE DS~RESET; SKIP SB);       00297000
              END INT;                                                  00298000
         L1:       AW~AW + (AB DIV 48);  AB~AB MOD 48;                  00299000
                   BW~BW + (BB DIV 48);  BB~BB MOD 48;                  00300000
                   T~IF N>39 THEN 39 ELSE N;                            00301000
                   IF (I~INT(A,AW,AB,T,48-T))>(J~INT(B,BW,BB,T,48-T))   00302000
                   THEN COMPAREB~1 ELSE                                 00303000
                   IF I<J THEN COMPAREB~-1 ELSE                         00304000
                   IF N=T THEN COMPAREB~0 ELSE                          00305000
                   BEGIN N~N-T; AB~AB+T; BB~BB+T; GO TO L1; END;        00306000
              END  COMPAREB;                                            00307000
STREAM PROCEDURE   ZERO(A,WD);                                          00308000
COMMENT ................................................................00309000
:  SARTING FROM (A), SET (WD) WORDS TO BE ZEROES.  (1{WD{64)           :00310000
:                              --------  J. C. PAO   12/09/66  --------:00311000
:......................................................................;00312000
     VALUE         WD;                                                  00313000
              BEGIN                                                     00314000
                   DI~A; DS~8 LIT"0000";  SI~A;                         00315000
                   TALLY~WD; TALLY~TALLY+63; WD~TALLY;  DS~WD WDS;      00316000
              END  ZERO;                                                00317000
STREAM PROCEDURE   IOCVRT(A,B,ST,CH,IO);                                00318000
COMMENT ................................................................00319000
:  THIS PROCEDURE DOES INPUT ("IO"=1) OR OUTPUT ("IO"=0) CONVERT FROM  :00320000
:"B" INTO "A", STARTING CHR-POSITION "ST", FOR "CH" CHRS.              :00321000
:                              --------  J. C. PAO   04/21/64  --------:00322000
:......................................................................;00323000
     VALUE         ST,CH,IO;                                            00324000
              BEGIN                                                     00325000
                   DI~A;  SI~LOC IO; SI~SI+7; SKIP 5 SB;                00326000
                   IF SB THEN                                           00327000
                   BEGIN SI~B; SI~SI+ST; DS~CH OCT END ELSE             00328000
                   BEGIN SI~B; DI~DI+ST; DS~CH DEC END;                 00329000
              END  IOCVRT;                                              00330000
REAL PROCEDURE     DATE(T);                                             00331000
COMMENT ................................................................00332000
:  THIS PROCEDURE CONVERTS THE VALUE OF AN SYSTEM INTERNAL DATE INTO   :00333000
:MONTH, DAY AND YEAR.                                                  :00334000
:  VALUE OF RESULT:   CHR 1-4: MONTH (IN CHARACTERS).                  :00335000
:                     CHR 5-6: YEAR (IN CHARACTERS).                   :00336000
:                     CHR 7  : DAY (IN BINARY).                        :00337000
:                              --------  J. C. PAO   06/21/66  --------:00338000
:......................................................................;00339000
     VALUE         T;                                                   00340000
     REAL          T;                                                   00341000
              BEGIN                                                     00342000
       INTEGER     D,M;                                                 00343000
       LABEL       LE;                                                  00344000
                   IF (D~T.[42:6]+10|(T.[36:6]+10|(T.[30:6]))){31 THEN  00345000
                   BEGIN M~"JAN."; GO TO LE END;  D~D-31;               00346000
                   IF D{(M~IF (M~T.[24:6]+10|(T.[18:6])).[46:2]=0 THEN  00347000
                   29 ELSE 28) THEN                                     00348000
                   BEGIN M~"FEB."; GO TO LE END;  D~D-M;                00349000
                   IF D{31 THEN BEGIN M~"MAR."; GO TO LE END; D~D-31;   00350000
                   IF D{30 THEN BEGIN M~"APR."; GO TO LE END; D~D-30;   00351000
                   IF D{31 THEN BEGIN M~" MAY"; GO TO LE END; D~D-31;   00352000
                   IF D{30 THEN BEGIN M~"JUN."; GO TO LE END; D~D-30;   00353000
                   IF D{31 THEN BEGIN M~"JUL."; GO TO LE END; D~D-31;   00354000
                   IF D{31 THEN BEGIN M~"AUG."; GO TO LE END; D~D-31;   00355000
                   IF D{30 THEN BEGIN M~"SEP."; GO TO LE END; D~D-30;   00356000
                   IF D{31 THEN BEGIN M~"OCT."; GO TO LE END; D~D-31;   00357000
                   IF D{30 THEN BEGIN M~"NOV."; GO TO LE END; D~D-30;   00358000
                   M~"DEC.";                                            00359000
         LE:       DATE~D&M[6:24:24]&T[30:18:12];                       00360000
              END  DATE;                                                00361000
INTEGER PROCEDURE  INFOENTRY(F,WDS);                                    00362000
COMMENT ................................................................00363000
:    THIS PROCEDURE ENTERS AN ENTRY INTO INFO[*,*] AND UPDATES ALL THE :00364000
:CONCERNED INDEXES.  "F" IS THE ARRAY IDENTIFIER WHICH CONTAINS "WDS"  :00365000
:WORDS IN THIS ENTRY.                                                  :00366000
:                              --------  J. C. PAO   04/27/68  --------:00367000
:......................................................................;00368000
     VALUE         WDS;                                                 00369000
     REAL          WDS;                                                 00370000
     ARRAY         F[0];                                                00371000
              BEGIN                                                     00372000
       INTEGER     S;                                                   00373000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"INFENY",F[0],WDS);               00374000
COMMENT  CHECK IF THE REMAINING WORDS OF THE CURRENT ROW OF INFO[*,*]   00375000
         CAN NOT HOLD THIS ENTRY, START WITH A THE NEXT ROW;            00376000
                   IF NFX.[40:8]+WDS>257 THEN NFX~(NFX+256)&1[40:40:8]; 00377000
COMMENT  STORE THE FOLLOWING INDEXES IN THIS ENTRY:                     00378000
         [40: 8]: REL INX OF THE ADDITIONAL INFO.  (ALREADY IN F[0]).   00379000
         [33: 7]: INX OF STKHD[*].  (SEE NOTE 3).                       00380000
         [25: 8]: REL INX OF THE PREVIOUS ENTRY.  (SEE NOTE 1).         00381000
         [12:13]: ABS INX OF THE PREVIOUS ENTRY WITH THE SAME VALUE, OR 00382000
                  THE SAME INX OF STKHD[*].  (SEE NOTE 2).              00383000
         [ 4: 8]: TOTAL UNMBER OF WORDS IN THIS ENTRY.  (SEE NOTE 4).   00384000
         [ 1: 3]: THE TYPE OF IDENTIFIER:                               00385000
                  0: RESERVED WORD OR DONT-CARE. (REGARDLESS OF "STRM").00386000
                  2: SUBSCRIPTED IDENTIFIER.     ("STRM" SHOULD BE OFF).00387000
                  4: DEFINE.                     (REGARDLESS OF "STRM").00388000
                  6: SIMPLE VARIABLE.            ("STRM" SHOULD BE OFF).00389000
                  1: STREAM PROCEDURE.           (WHEN "STRM" IS OFF).  00390000
                     STREAM VALUE VARIABLE.      (WHEN "STRM" IS ON).   00391000
                  3: STREAM NAME VARIABLE.       ("STRM" SHOULD BE ON). 00392000
                  5: STREAM VALUE IN LOCAL[*].   ("STRM" SHOULD BE ON). 00393000
                  7: STREAM NAME IN LOCAL[*].    ("STRM" SHOULD BE ON). 00394000
                                                                       ;00395000
                   F[0]~F[0]&(NFX-HFX)[25:40:8]          % NOTE 1.      00396000
                       &STKHD[S~(F[1] MOD 125)][12:35:13]% NOTE 2.      00397000
                       &S[33:41:7]&WDS[4:40:8];          % NOTES 3 & 4. 00398000
COMMENT  TRANSFER THE ENTRY INTO INFO[*,*];                             00399000
                   TRNSFWDS(INFO[(INFOENTRY~HFX~STKHD[S]~NFX).[35:5],   00400000
                     NFX.[40:8]-1],F[0],WDS);                           00401000
COMMENT  IF THE NEXT AVAILABLE INDEX OF INFO[*,*] IS POINTED TO THE     00402000
         0TH WORD OF THE ROW, MOVE IT TO THE 1ST WORD OF THE NEXT ROW;  00403000
                   IF (NFX~NFX+WDS).[40:8]=0 THEN NFX~NFX+1;            00404000
IF DEBUGN=3 THEN DUMPARRAY(F,0,WDS-1,FOU,1,"ENTRY:",HFX);               00405000
              END  INFOENTRY;                                           00406000
PROCEDURE          INFOREMOVE(START);                                   00407000
COMMENT ................................................................00408000
:    THIS PROCEDURE REMOVES THE ENTRIES FROM INFO[*,*].  REMOVAL STARTS:00409000
:FROM THE INFO-INDEX "START".  AL THE CONCERNED INDEXES ARE UPDATED.   :00410000
:                              --------  J. C. PAO   04/27/68  --------:00411000
:......................................................................;00412000
     VALUE         START;                                               00413000
     REAL          START;                                               00414000
              BEGIN                                                     00415000
       REAL        P;                                                   00416000
       LABEL       LE;                                                  00417000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"INFRMV",START,HFX,NFX);          00418000
                   IF HFX<START THEN GO TO LE;                          00419000
                   DO                                                   00420000
                   STKHD[(P~INFO[HFX.[35:5],HFX.[40:8]-1]).[33:7]]~     00421000
                   P.[12:13] UNTIL (HFX~HFX-P.[25:8])<START;            00422000
                   IF (NFX~HFX+INFO[HFX.[35:5],HFX.[40:8]-1].[4:8]).    00423000
                   [40:8]=0 THEN NFX~NFX+1;                             00424000
LE:                                                                     00425000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"INFRVM","START=",START,"HFX  =", 00426000
HFX,"NFX  =",NFX);                                                      00427000
IF DEBUGN=3 THEN DUMPARRAY(STKHD,0,124,FOU,0,"STKHD:",HFX);             00428000
IF DEBUGN=3 THEN FOR START~0 STEP 1 UNTIL NFX.[35:5] DO                 00429000
DUMPARRAY(INFO[START,*],0,255,FOU,1,"INFO :",START);                    00430000
END; COMMENT                                                            00431000
         LE:  END  INFOREMOVE;                                          00432000
BOOLEAN PROCEDURE  SCAN(TYP);  VALUE TYP; INTEGER TYP;  FORWARD;        00433000
BOOLEAN PROCEDURE  INPUT;                                               00434000
COMMENT ................................................................00435000
:  THIS PROCEDURE READS THE SYMBOLIC FILE AND THE PATCH CARD DECK INTO :00436000
:CV[*].  ACCORDING TO THEIR NEXT SEQUENCE NO.,  IT READS A CARD AT A   :00437000
:TIME.                                                                 :00438000
:  VALUE OF RESULT:  TRUE: THE END OF BOTH FILES.                      :00439000
:                              --------  J. C. PAO   04/01/68  --------:00440000
:......................................................................;00441000
              BEGIN                                                     00442000
BOOLEAN STREAM PROCEDURE  DOLLARSIGN(C);  % CHECK FOR DOLLAR SIGN CARD. 00443000
     VALUE         C;                                                   00444000
              BEGIN                                                     00445000
                   SI~C;                                                00446000
                   IF SC="$" THEN BEGIN TALLY~1; DOLLARSIGN~TALLY END;  00447000
              END  DOLLARSIGN;                                          00448000
PROCEDURE          DOLLARCARD;  % PROCCESS A DOLLAR SIGN CARD.          00449000
              BEGIN                                                     00450000
STREAM PROCEDURE   VOID(V,C);                                           00451000
     VALUE         C;                                                   00452000
              BEGIN                                                     00453000
                   SI~C; SI~SI+7;  DI~V;  TALLY~8;                      00454000
                   7(IF SC!" " THEN JUMP OUT;                           00455000
                     SI~SI-1; TALLY~TALLY+63; DS~LIT" ");               00456000
                   SI~C;  C~TALLY;  DS~C CHR;                           00457000
              END  VOID;                                                00458000
       REAL        I,J;                                                 00459000
       LABEL       L1,L2,L3,L4,L5,L55,L56,L6,L7,L8,L9,LL,LE;            00460000
COMMENT  STORE AWAY THE CURRENT SCAN AND PREPARE FOR SCANNING THE DOLLAR00461000
         SIGN CARD;                                                     00462000
                   STR[I~LDF+1,1]~REAL(DFINE);                          00463000
                   STR[I, 2]~REAL(GENERATE);                            00464000
                   STR[I, 3]~REAL(NEWCARD);                             00465000
                   STR[I, 4]~IF RESQ THEN 3 ELSE 0;                     00466000
                   STR[I, 6]~NCD;                                       00467000
                   STR[I, 7]~CC0;                                       00468000
                   STR[I, 8]~NC0;                                       00469000
                   STR[I, 9]~NCR;                                       00470000
                   STR[I,10]~NXT;                                       00471000
                   STR[I,11]~FST;                                       00472000
                   STR[I,12]~LST;                                       00473000
                   STR[I,13]~REAL(BBK);                                 00474000
                   STR[I,14]~NCE;                                       00475000
                   TRNSFWDS(STR[I,17],EV[0],17);                        00476000
                   TRNSFWDS(STR[I,36],EV[19],1);                        00477000
                   DFINE~BOOLEAN(2);  % STOP SWITCH IN SCAN FOR $-CARD. 00478000
                   GENERATE~NEWCARD~BBK~FALSE;                          00479000
                   RESQ~TRUE;  CC~CST;                                  00480000
                   IF SCAN(1) THEN GO TO LL;                            00481000
                   IF NXT.[42:6]!2 THEN GO TO LL;                       00482000
COMMENT  CHECK FOR VIOD CARD AND SKIP BOTH PATCH DECK AND OLD FILE;     00483000
                   IF NXT.[36:6]!"V" THEN GO TO L5;                     00484000
                   IF SCAN(5) THEN GO TO LL;                            00485000
                   IF NCR!4 THEN GO TO LL;                              00486000
                   IF EV[0].[18:24]!"VOID" THEN GO TO LL;               00487000
                   VOID(ACT[0],CC);                                     00488000
         L1:       READ(PACH[NO])[L2];                                  00489000
                   TRNSFWDS(PNO,PACH(9),1);                             00490000
                   IF COMPAREA(PNO,ACT[0],0,0,8)<0 THEN                 00491000
                   BEGIN READ(PACH); GO TO L1 END ELSE GO TO L3;        00492000
         L2:       PNO~A89;                                             00493000
         L3:       IF COMPAREA(CNO,INV,0,0,8)!0 THEN                    00494000
                   IF COMPAREA(CNO,ACT[0],0,0,8)<0 THEN                 00495000
                   BEGIN                                                00496000
                     READ(CARD);  READ(CARD[NO])[L4];                   00497000
                     TRNSFWDS(CNO,CARD(9),1);  GO TO L3;                00498000
         L4:         CNO~A89;                                           00499000
                   END;  GO TO LL;                                      00500000
COMMENT  THIS IS NOT A VOID CARD, SCAN IT;                              00501000
         L5:       IF SCAN(5) THEN GO TO LL;                            00502000
                   IF NCR!4 THEN GO TO LL;                              00503000
                   IF (J~EV[0].[18:24])="CARD" THEN                     00504000
                   IF COMPAREA(CNO,A89,0,0,8)!0 THEN                    00505000
                   BEGIN CNO~INV; GO TO L56 END ELSE GO TO L56;         00506000
                   IF J!"TAPE" THEN GO TO LL;                           00507000
                   IF COMPAREA(CNO,INV,0,0,8)=0 THEN                    00508000
                   BEGIN                                                00509000
                     READ(CARD[NO])[L55];                               00510000
                     TRNSFWDS(CNO,CARD(9),1);  GO TO L56;               00511000
         L55:        CNO~A89;                                           00512000
                   END;                                                 00513000
         L56:      DOLLAR~NCD;  ZERO(ACT[1],5);                         00514000
                   IF BOOLEAN(STR[I,4])THEN ACT[6]~NNO+(ACT[7]~INC) ELSE00515000
                   BEGIN  IOCVRT(ACT[6],ENO,0,8,1);                     00516000
                     IF ACT[6]<(ACT[7]~0) THEN ACT[6]~0;                00517000
                   END;                                                 00518000
         L6:       IF NXT.[42:6]!2 THEN GO TO LL;                       00519000
                   IF NXT.[36:6]!"L" THEN GO TO L7;                     00520000
                   IF SCAN(5) THEN GO TO LL;                            00521000
                   IF NCR=4 THEN                                        00522000
                   IF EV[0].[18:24]!"LIST" THEN GO TO LL ELSE           00523000
                   BEGIN ACT[1]~ACT[2]~ACT[3]~1; GO TO L6 END;          00524000
                   IF NCR!5 THEN GO TO LL;                              00525000
                   IF (J~EV[0].[18:30])="LISTO" THEN                    00526000
                   BEGIN ACT[1]~1; GO TO L6 END;                        00527000
                   IF J="LISTG" THEN                                    00528000
                   BEGIN ACT[2]~1; GO TO L6 END;                        00529000
                   IF J="LISTD" THEN                                    00530000
                   BEGIN ACT[3]~1; GO TO L6 END;  GO TO LL;             00531000
         L7:       IF NXT.[36:6]="N" THEN                               00532000
                   BEGIN                                                00533000
                     IF SCAN(5) THEN GO TO LL;                          00534000
                     IF NCR!3 THEN GO TO LL;                            00535000
                     IF EV[0].[18:18]!"NEW" THEN GO TO LL;              00536000
                     IF NXT!2&"T"[36:42:6] THEN GO TO LL;               00537000
                     IF SCAN(5) THEN GO TO LL;                          00538000
                     IF EV[0].[18:24]!"TAPE" THEN GO TO LL;             00539000
                     ACT[4]~1;                                          00540000
                     IF NXT.[42:6]!2 THEN GO TO LL;                     00541000
                   END;                                                 00542000
                   IF NXT.[36:6]="P" THEN                          %001%00542100
                   BEGIN                                           %001%00542200
                     IF SCAN(5) THEN GO TO LL;                     %001%00542300
                     IF NCR!5 THEN GO TO LL;                       %001%00542400
                     IF EV[0].[18:30]!"PUNCH" THEN GO TO LL;       %001%00542500
                     ACT[4]~ACT[4]+2;                              %001%00542600
                     IF NXT.[42:6]!2 THEN GO TO LL;                %001%00542700
                   END;                                            %001%00542800
                   IF NXT.[36:6]!"S" THEN GO TO LL;                     00543000
                   IF SCAN(5) THEN GO TO LL;                            00544000
                   IF NCR!3 THEN GO TO LL;                              00545000
                   IF EV[0].[18:18]!"SEQ" THEN GO TO LL;                00546000
                   ACT[5]~1;  IF BOOLEAN(STR[I,4]) THEN STR[I,4]~1;     00547000
                   IF NXT.[42:6]!0 THEN GO TO L8;                       00548000
                   IF SCAN(0) THEN GO TO LL;                            00549000
                   IOCVRT(ACT[6],EV[0],3,IF NCR>8 THEN 8 ELSE NCR,1);   00550000
                   ACT[6]~-ACT[6];                                      00551000
         L8:       IF NXT!4&"+"[36:42:6] THEN GO TO LL;                 00552000
                   IF SCAN(1) THEN GO TO LL;                            00553000
                   IF NXT.[42:6]!0 THEN GO TO LL;                       00554000
                   IF SCAN(0) THEN GO TO LL;                            00555000
                   IOCVRT(ACT[7],EV[0],3,IF NCR>8 THEN 8 ELSE NCR,1);   00556000
COMMENT  RESTORE THE ORIGINAL SCAN AND READ THE NEXT PATCH CARD;        00557000
         LL:       DFINE   ~BOOLEAN(STR[I,1]);                          00558000
                   GENERATE~BOOLEAN(STR[I,2]);                          00559000
                   NEWCARD ~BOOLEAN(STR[I,3]);                          00560000
                   RESQ    ~BOOLEAN(STR[I,4]);                          00561000
                   NCD~STR[I, 6];                                       00562000
                   CC0~STR[I, 7];                                       00563000
                   NC0~STR[I, 8];                                       00564000
                   NCR~STR[I, 9];                                       00565000
                   NXT~STR[I,10];                                       00566000
                   FST~STR[I,11];                                       00567000
                   LST~STR[I,12];                                       00568000
                   BBK~BOOLEAN(STR[I,13]);                              00569000
                   NCE~STR[I,14];                                       00570000
                   TRNSFWDS(EV[0],STR[I,17],17);                        00571000
                   TRNSFWDS(EV[19],STR[I,36],1);                        00572000
                   READ(PACH[NO])[L9];                                  00573000
                   TRNSFWDS(PNO,PACH(9),1);  GO TO LE;                  00574000
         L9:       PNO~A89;                                             00575000
         LE:  END  DOLLARCARD;                                          00576000
       REAL        I;                                                   00577000
       LABEL       L0,L1,L2,L23,L3,L4,LE;                               00578000
         L0:       IF I~COMPAREA(PNO,CNO,0,0,8)<0 THEN                  00579000
                   IF COMPAREA(PNO,A89,0,0,8)=0 THEN GO TO L23 ELSE     00580000
         L1:       BEGIN  % READ FROM THE PATCH DECK.                   00581000
                     READ(PACH,9,CV[*]);  CV[9]~INV&4[45:45:3];         00582000
                     TRNSFWDS(CV[11],PNO,1);                            00583000
                     IF DOLLARSIGN(CST) THEN  % CHECK FOR $-CARD.       00584000
                     BEGIN DOLLARCARD; GO TO L0 END;                    00585000
                     READ(PACH[NO])[L2];                                00586000
                     TRNSFWDS(PNO,PACH(9),1);  GO TO LE;                00587000
         L2:         PNO~A89;  GO TO LE;                                00588000
                   END;                                                 00589000
                   IF I=0 THEN                                          00590000
                   IF COMPAREA(CNO,A89,0,0,8)=0 THEN                    00591000
         L23:      BEGIN  % END OF BOTH FILES.                          00592000
                     CLOSE(CARD,RELEASE);  CLOSE(PACH,RELEASE);         00593000
                     INPUT~TRUE;  GO TO LE;                             00594000
                   END ELSE                                             00595000
                   BEGIN  % REPLACEMENT FROM PATCH DECK.                00596000
                     READ(CARD);  READ(CARD[NO])[L3];                   00597000
                     TRNSFWDS(CNO,CARD(9),1);  GO TO L1;                00598000
         L3:         CNO~A89;  GO TO L1;                                00599000
                   END;                                                 00600000
                   % READ FROM THE SYMBOLIC FILE.                       00601000
                   READ(CARD,9,CV[*]);  CV[9]~INV;                      00602000
                   TRNSFWDS(CV[11],CNO,1);                              00603000
                   READ(CARD[NO])[L4];                                  00604000
                   TRNSFWDS(CNO,CARD(9),1);  GO TO LE;                  00605000
         L4:       CNO~A89;                                             00606000
         LE:  END  INPUT;                                               00607000
PROCEDURE          OUTPUT(A);                                           00608000
COMMENT ................................................................00609000
:  THIS PROCEDURE TAKES CARE OF EDITING AND OUTPUT A CARD IMAGE OF ANY :00610000
:KIND, NEW, OLD, OR OLD DELETED.                                       :00611000
:                              --------  J. C. PAO   04/28/68  --------:00612000
:......................................................................;00613000
     ARRAY         A[0];                                                00614000
              BEGIN                                                     00615000
STREAM PROCEDURE   PRNTEDT(P,C);                                        00616000
              BEGIN                                                     00617000
       LABEL       L1;                                                  00618000
                   DI~P; SI~C; DS~9 WDS; DS~8 LIT"    ";                00619000
                   SI~SI+7; SKIP 5 SB;                                  00620000
                   IF SB THEN                                           00621000
                   BEGIN DS~8 LIT" DELETED"; SI~SI-1 END ELSE           00622000
                   BEGIN DS~8 CHR; SI~SI-9 END;                         00623000
                   SKIP 3 SB;  DS~LIT" ";                               00624000
                   IF SB THEN DS~LIT"R" ELSE                            00625000
                   BEGIN  SKIP SB;                                      00626000
                     IF SB THEN                                         00627000
                     BEGIN                                              00628000
                       DS~11 LIT" GENERATED"; SI~SI-2; GO TO L1;        00629000
                     END ELSE DS~LIT"T";                                00630000
                   END;  DS~2 LIT"  ";  SI~SI+8; DS~8 CHR; SI~SI-18;    00631000
         L1:       DS~4 LIT"    ";                                      00632000
                   IF SC="1" THEN 8(DS~2 RESET; DS~2 SET; DS~2 RESET)   00633000
                   ELSE DS~8 LIT"    ";  DS~8 LIT"    ";                00634000
              END  PRNTEDT;                                             00635000
       INTEGER     P,T;                                                 00636000
       LABEL       L1,L2,LE;                                            00637000
                   IF BOOLEAN(A[9]) THEN                                00638000
                   BEGIN  % DELETED CARD IMAGE.                         00639000
                     ND~ND+1;  % DELETED CARD COUNT.                    00640000
                     IF LSTD THEN GO TO L1;                             00641000
                     IF A[9].[36:6]!0 THEN                              00642000
         L1:         BEGIN                                              00643000
                       IF FRSTPRNT THEN                                 00644000
                       BEGIN  FRSTPRNT~FALSE;                           00645000
                         IF (T~T1 DIV 3600)<12 THEN P~"A" ELSE          00646000
                         BEGIN IF T>12 THEN T~T-12; P~"P" END;          00647000
                         WRITE(FOU[DBL],HDNG,T0.[6:24],T0.[42:6],       00648000
                               T0.[30:12],T,(T1 MOD 3600) DIV 60,P);    00649000
                       END;                                             00650000
                       PRNTEDT(FOU(0),A[0]);  RELEASE(FOU);             00651000
                     END;                                               00652000
                     GO TO LE;                                          00653000
                   END;                                                 00654000
                   IF RESQ THEN                                         00655000
                   BEGIN NNO~NNO+INC; IOCVRT(A[10],NNO,0,8,0) END;      00656000
                   IF BOOLEAN(A[9].[45:2]) THEN                         00657000
                   BEGIN  % GENERATED CARD IMAGE.                       00658000
                     NN~NN+1;  % NEW GENERATED CARD COUNT.              00659000
                     IF A[9].[36:6]!0 THEN                              00660000
                     BEGIN  NE~NE+1;  % ERROR COUNT.                    00661000
                       GO TO L2;                                        00662000
                     END ELSE                                           00663000
                     IF LSTN THEN GO TO L2;                             00664000
                   END ELSE                                             00665000
                   BEGIN  % OLD RETAINED CARD IMAGE.                    00666000
                     NR~NR+1;  % OLD RETAINED CARD COUNT.               00667000
                     IF NOT RESQ THEN TRNSFWDS(A[10],A[11],1);          00668000
                     IF A[9].[36:6]!0 THEN                              00669000
                     BEGIN  NE~NE+1;  % ERROR COUNT.                    00670000
         L2:           IF FRSTPRNT THEN                                 00671000
                       BEGIN  FRSTPRNT~FALSE;                           00672000
                         IF (T~T1 DIV 3600)<12 THEN P~"A" ELSE          00673000
                         BEGIN IF T>12 THEN T~T-12; P~"P" END;          00674000
                         WRITE(FOU[DBL],HDNG,T0.[6:24],T0.[42:6],       00675000
                               T0.[30:12],T,(T1 MOD 3600) DIV 60,P);    00676000
                       END;                                             00677000
                       PRNTEDT(FOU(0),A[0]);  RELEASE(FOU);             00678000
                     END ELSE                                           00679000
                     IF LSTO THEN GO TO L2;                             00680000
                   END;                                                 00681000
                   IF NEWTP THEN                                        00682000
                   BEGIN  NEWTPED~TRUE;                                 00683000
                     TRNSFWDS(A[9],A[10],1);  WRITE(NTP,10,A[*]);       00684000
                   END;                                                 00685000
                   IF PNCH THEN                                    %001%00685100
                   BEGIN  PNCHED~TRUE;                             %001%00685200
                     IF NEWTP THEN ELSE TRNSFWDS(A[9],A[10],1);    %001%00685300
                     WRITE(PUNCH,10,A[*]);                         %001%00685400
                   END;                                            %001%00685500
         LE:  END  OUTPUT;                                              00686000
PROCEDURE          OUTPUTNEW(CN);                                       00687000
COMMENT ................................................................00688000
:    THIS PROCEDURE OUTPUTS THE GENERATED CARD IMAGES FROM CB[*,*] UP  :00689000
:TO THE IMAGE WHICH HAS THE CARD INDEX NUMBER "CN".                    :00690000
:                              --------  J. C. PAO   04/28/68  --------:00691000
:......................................................................;00692000
     VALUE         CN;                                                  00693000
     REAL          CN;                                                  00694000
              BEGIN                                                     00695000
       REAL        I,J,N,S,X;                                           00696000
       LABEL       L1,L2,L3,L4,L5,LE;                                   00697000
                   IF CBX<0 THEN GO TO LE;                              00698000
                   IF (N~CB[I~J~0,11])>CN THEN GO TO LE;                00699000
                   IF NOT RESQ THEN IOCVRT(S,CB[I,10],0,8,1);  GO TO L1;00700000
                   DO BEGIN                                             00701000
                     IF CB[I,11]!N THEN                                 00702000
                     BEGIN                                              00703000
                       IF NOT RESQ THEN IOCVRT(X,CB[I,10],0,8,1);       00704000
                       GO TO IF I-J+REAL(SQ1ST)=1 THEN L2 ELSE L4;      00705000
                     END;                                               00706000
         L1:       END UNTIL (I~I+1)>CBX;                               00707000
                   IF I-J+REAL(SQ1ST)=1 THEN                            00708000
         L2:       BEGIN N~0; GO TO L5 END;                             00709000
                   IF NEWCARD THEN IOCVRT(X,CV[11],0,8,1) ELSE          00710000
                   IF N~COMPAREA(PNO,CNO,0,0,8)<0 THEN GO TO L3 ELSE    00711000
                   IF N>0 THEN IOCVRT(X,CNO,0,8,1) ELSE                 00712000
                   IF COMPAREA(PNO,A89,0,0,8)!0 THEN                    00713000
         L3:       IOCVRT(X,PNO,0,8,1) ELSE X~EITNINES;                 00714000
         L4:       N~(X-S) DIV (I-J+REAL(SQ1ST));                       00715000
                   IF SQ1ST THEN SQ1ST~FALSE ELSE GO TO L5;             00716000
                   DO BEGIN                                             00717000
                     IF NOT RESQ THEN                                   00718000
                     IF N>0 THEN                                        00719000
                     BEGIN S~S+N; IOCVRT(CB[J,10],S,0,8,0) END;         00720000
         L5:         OUTPUT(CB[J,*]);                                   00721000
                   END UNTIL (J~J+1)}I;                                 00722000
                   IF I>CBX THEN CBX~-1 ELSE                            00723000
                   IF N~CB[I,11]{CN THEN                                00724000
                   BEGIN IF NOT RESQ THEN S~X; GO TO L1 END ELSE        00725000
                   BEGIN  J~-1;                                         00726000
                     DO TRNSFWDS(CB[J~J+1,0],CB[I,0],12)                00727000
                     UNTIL (I~I+1)>CBX;  CBX~J;                         00728000
                   END;                                                 00729000
         LE:       IF DOLLAR{CN THEN                                    00730000
                   BEGIN  % DOLLAR CARD STARTS FUNCTIONING.             00731000
                     LSTO~BOOLEAN(ACT[1]);                              00732000
                     LSTN~BOOLEAN(ACT[2]);                              00733000
                     LSTD~BOOLEAN(ACT[3]);                              00734000
                     PNCH~(NEWTP~BOOLEAN(ACT[4])).[46:1];          %001%00735000
                     IF RESQ~BOOLEAN(ACT[5]) THEN                       00736000
                     BEGIN  INC~ACT[7];                                 00737000
                       NNO~IF BOOLEAN(ACT[6].[1:1]) THEN -ACT[6]-INC    00738000
                           ELSE ACT[6];                                 00739000
                     END;                                               00740000
                     DOLLAR~BLK;                                        00741000
                   END;                                                 00742000
              END  OUTPUTNEW;                                           00743000
PROCEDURE          STARTGEN;                                            00744000
COMMENT ................................................................00745000
:    THIS PROCEDURE STARTS THE GENERATING PROCESS ON THE CARD "NC0" AT :00746000
:THE ADDRESS "CC0".  THE GENERATING PROCESS WILL BE TERMINATED IN THE  :00747000
:SCAN-PROCEDURE AT THE END OF THE CARD, IF NOTHING IS CONTINUED TO THE :00748000
:THE NEXT CARD.                                                        :00749000
:                              --------  J. C. PAO   04/11/68  --------:00750000
:......................................................................;00751000
              BEGIN                                                     00752000
       REAL        I;                                                   00753000
       LABEL       L1,LE;                                               00754000
                   IF OUTN}NC0 THEN GO TO LE;  % IT SHOULD NEVER HAPPEN.00755000
                   IF NC0=NCD-2 THEN                                    00756000
                   BEGIN  PPC[9].[47:1]~1;  PC[9].[47:1]~1;             00757000
                     CI[11]~NCD-2;                                      00758000
                     TRNSFWDS(A[0],CV[0],12);                           00759000
                     TRNSFWDS(CV[0],PPC[0],12);  GO TO L1;              00760000
                   END ELSE                                             00761000
                   IF NC0=NCD-1 THEN                                    00762000
                   BEGIN  PC[9].[47:1]~1;  CI[11]~NCD-1;                00763000
                     TRNSFWDS(A[0],CV[0],12);                           00764000
                     TRNSFWDS(CV[0],PC[0],12);                          00765000
         L1:         IC~IST;                                            00766000
                     CHRTRNSF(IC,CST,I~(CC0.[33:15]-CST)|8+CC0.[30:3]); 00767000
                     CI[9]~2&CV[9][36:36:6];                            00768000
                     IF REAL(RESQ)!1 THEN TRNSFWDS(CI[10],CV[11],1);    00769000
                     TRNSFWDS(CV[0],A[0],12);                           00770000
                     IF NOT NEWCARD THEN CV[9].[47:1]~1;                00771000
                   END ELSE                                             00772000
                   BEGIN  CV[9].[47:1]~1;  IC~IST;  CI[11]~NCD;         00773000
                     CHRTRNSF(IC,CST,I~(CC0.[33:15]-CST)|8+CC0.[30:3]); 00774000
                     CI[9]~2&CV[9][36:36:6];                            00775000
                     IF REAL(RESQ)!1 THEN TRNSFWDS(CI[10],CV[11],1);    00776000
                   END;                                                 00777000
                   LST~4;  AVC~72-I;  CIVALID~TRUE;                     00778000
                   GENERATE~TRUE;                                       00779000
         LE:  END  STARTGEN;                                            00780000
PROCEDURE          EDITING(OP,NC);                                      00781000
COMMENT ................................................................00782000
:  THIS PROCEDURE DOES EDITING JOB INTO THE GENERATED CARD IMAGE.  "OP":00783000
:INDICATES THE TYPE OF EDITING OPERATIONS:                             :00784000
:  OP=0: SET "NC" NUMBER OF BLANKS.                                    :00785000
:  OP=1: TRANSFER "NC" NUMBER OF CHARACTERS.                           :00786000
:  OP=2: MAKE A STRING WHICH HAS "NC" NUMBER OF CHARACTERS EXCLUDING   :00787000
:        BOTH QUOTATIONS.                                              :00788000
:                              --------  J. C. PAO   03/27/68  --------:00789000
:......................................................................;00790000
     VALUE         OP,NC;                                               00791000
     REAL          OP,NC;                                               00792000
              BEGIN                                                     00793000
STREAM PROCEDURE   EDT(T,F,LST,OP,NC);                                  00794000
     VALUE         F,OP,NC;                                             00795000
              BEGIN                                                     00796000
       LOCAL       I;                                                   00797000
       LABEL       L1;                                                  00798000
                   SI~T; DI~LOC I; DS~WDS; DI~I;                        00799000
                   SI~LOC OP; SKIP SB;                                  00800000
                   IF SB THEN DS~LIT" ";  SI~SI+6;                      00801000
                   IF SC="1" THEN                                       00802000
                   BEGIN  % TRANSFER CHARACTERS.                        00803000
                     SI~F; DS~NC CHR; NC~DI;                            00804000
                     DI~LST; DS~7 LIT"0000";                            00805000
                     SI~NC; SI~SI-1;                                    00806000
                     IF SC>"9" THEN DS~LIT"4" ELSE                      00807000
                     IF SC}"0" THEN DS~LIT"0" ELSE                      00808000
                     IF SC=ALPHA THEN DS~LIT"2" ELSE DS~LIT"4";         00809000
                   END ELSE                                             00810000
                   IF SC="0" THEN                                       00811000
                   BEGIN  % SET BLANKS.                                 00812000
                     NC(DS~LIT" ");  SI~LOC NC; SI~SI+6;                00813000
                     IF SC!"0" THEN                                     00814000
                     BEGIN  I~DI;  DI~LOC F; DI~DI+7; DS~CHR;           00815000
                       DI~I;  F(2(DS~32 LIT"    "));                    00816000
                     END;  GO TO L1;                                    00817000
                   END ELSE                                             00818000
                   BEGIN  % TRANSFER A STRING.                          00819000
                     DS~LIT"""; SI~F; DS~NC CHR; DS~LIT""";             00820000
         L1:         NC~DI;  DI~LST; DS~7 LIT"0000"; DS~LIT"4";         00821000
                   END;                                                 00822000
                   SI~LOC NC; DI~T; DS~WDS;                             00823000
              END  EDT;                                                 00824000
       REAL        A;                                                   00825000
       BOOLEAN     B;                                                   00826000
       LABEL       L1,LE;                                               00827000
                   IF NC=0 THEN                                         00828000
                   IF OP!0 THEN GO TO LE;                               00829000
                   IF (IF CIVALID THEN AVC ELSE AVC~72-BB)<(A~          00830000
                   IF OP=0 THEN NC ELSE                                 00831000
                   (IF OP=2 THEN NC+2 ELSE NC)+REAL(B~LST!4 AND FST!4)) 00832000
                   THEN                                                 00833000
                   BEGIN  % ITEM CAN NOT BE HELD ON THIS CARD.          00834000
                     IF CIVALID THEN  % OUTPUT THE VALID CARD FIRST.    00835000
                     BEGIN                                              00836000
                     IF AVC>0 THEN EDT(IC,0,LST,0,AVC);  AVC~72-BB;     00837000
                       TRNSFWDS(CB[CBX~CBX+1,0],CI[0],12);              00838000
                     END;  GO TO L1;                                    00839000
                   END ELSE                                             00840000
                   IF NOT CIVALID THEN                                  00841000
         L1:       BEGIN  IC~IST;                                       00842000
                     IF BB!0 THEN                                       00843000
                     IF BB+NC{72 THEN                                   00844000
                     BEGIN  EDT(IC,0,LST,0,BB);                         00845000
                       IF B THEN                                        00846000
                       BEGIN B~FALSE; A~IF OP=2 THEN NC+2 ELSE NC END;  00847000
                     END ELSE AVC~72;  CI[9]~2;                         00848000
                   END;                                                 00849000
                   IF BOOLEAN(EV[0].[1:1]) THEN CI[9].[36:6]~1;         00850000
                   IF CI[11]!NCE THEN                                   00851000
                   BEGIN  CI[11]~NCE;                                   00852000
                     IF REAL(RESQ)!1 THEN TRNSFWDS(CI[10],ENO,1);       00853000
                   END;                                                 00854000
                   IF A!0 THEN EDT(IC,EST,LST,IF B THEN -OP ELSE OP,NC);00855000
                   IF (AVC~AVC-A)!0 THEN CIVALID~TRUE ELSE              00856000
                   IF OP=0 THEN                                         00857000
                   BEGIN  % END OF THE CARD, GO TO CB[*,*].             00858000
                     TRNSFWDS(CB[CBX~CBX+1,0],CI[0],12);                00859000
                     CIVALID~FALSE;                                     00860000
                   END ELSE CIVALID~TRUE;                               00861000
         LE:  END  EDITING;                                             00862000
PROCEDURE          ERREDT(NC);                                          00863000
     VALUE         NC;                                                  00864000
     REAL          NC;                                                  00865000
              BEGIN                                                     00866000
       INTEGER     A,B;                                                 00867000
       LABEL       L1;                                                  00868000
                   B~BB;  BB~0;  GO TO L1;                              00869000
                   DO BEGIN  FST~4;                                     00870000
                     TRNSFCHR(EV[0],EV[IF A}5 THEN (A-5).[39:6]+1ELSE 0]00871000
                       ,3,IF A}5 THEN (A-5).[45:3] ELSE A+3,NC~NC-A);   00872000
         L1:         IF CIVALID THEN                                    00873000
                     IF AVC=0 THEN EDITING(0,0);                        00874000
                     IF (A~IF NC>(IF CIVALID THEN AVC ELSE AVC~72)      00875000
                        THEN AVC ELSE NC)>63 THEN A~63;                 00876000
                     EDITING(1,A);                                      00877000
                   END UNTIL NC=A;  BB~B;                               00878000
              END  ERREDT;                                              00879000
INTEGER STREAM PROCEDURE  LEADING0(A,NC);                               00880000
     VALUE         NC;                                                  00881000
              BEGIN                                                     00882000
       LABEL       L1,LE;                                               00883000
                   SI~A; SI~SI+3;  TALLY~NC;                            00884000
                   IF SC!"0" THEN BEGIN LEADING0~TALLY; GO TO LE END;   00885000
                   A~SI;                                                00886000
                   NC(IF SC!"0" THEN JUMP OUT 1 TO L1 ELSE              00887000
                      BEGIN SI~SI+1; TALLY~TALLY+63 END);               00888000
                   TALLY~1; LEADING0~TALLY;  DI~A; DS~LIT"0"; GO TO LE; 00889000
         L1:       LEADING0~TALLY;  DI~A; DS~LEADING0 CHR;              00890000
         LE:  END  LEADING0;                                            00891000
BOOLEAN PROCEDURE  SCAN(TYP);                                           00892000
COMMENT ................................................................00893000
:  PROCEDURE SCAN DOES THE SCANNING WORK ON AN INPUT CARD FILE.  IT    :00894000
:SCANS DEFFERENT TYPES OF INFORMATION ACCORDING TO THE VALUE OF "TYP"  :00895000
:WHICH IS THE ONLY FORMAL PARAMETER PASSED TO THE PROCEDURE.  IT ALSO  :00896000
:SKIPS BLANKS AND TELLS THE NEXT CARACTER IN THE INPUT STRING.  THE    :00897000
:CONTINUITY OF COLUMN 72 ON A CARD AND COLUMN 1 ON THE NEXT IS ALSO    :00898000
:TAKEN INTO CONSIDERATION.                                             :00899000
:     TYP=0:  SCAN FOR A STRING OF DIGITS.                             :00900000
:     TYP=1:  PICK UP THE FIRST CHR WHICH MUST NOT BE AN INVALID CHR.  :00901000
:     TYP=2:  SCAN FOR A STRING OF LETTERS.                            :00902000
:     TYP=3:  SKIP BLANKS UNTIL A VALID CHR ENCOUNTERED.               :00903000
:     TYP=4:  SKIP UNTIL A CHR WHICH EQUALS TO TYP.[36:6] W8ICH MAY BE :00904000
:             AN INVALID CHARACTER.                                    :00905000
:     TYP=5:  SCAN FOR A STRING OF COMBINATION OF LETTERS AND DIGITS.  :00906000
:     TYP=6:  PICK UP CHRS UNTIL A """ ENCOUNTERED, THEN SKIP THIS """.:00907000
:             REST PROCESS IS SAME AS TYP=3.                           :00908000
:     TYP=7:  SEE THE NEXT CHARACTER.                                  :00909000
:    BESIDES "TYP", SEVERAL OUTSIDE PARAMETERS ARE ALSO CONCERNED IN   :00910000
:THIS PROCEDURE.                                                       :00911000
:     CARD :  THE CARD FILE WHICH SUPPLIES THE INPUT CARDS.            :00912000
:     CV[*]:  A SAVE ARRAY WHICH IS USED AS THE CARD BUFFER.  THE 1ST  :00913000
:             CHARACTER OF CV[9] MUST BE AN INVALID CHARACTER.         :00914000
:     CST  :  THE ADDRESS OF CV[0] EXPRSSED AS AN OPERAND.             :00915000
:     CED  :  THE ADDRESS OF CV[9] EXPRSSED AS AN OPERAND.             :00916000
:     EST  :  THE STARTING ADDRESS WHERE THE SCANNED INFORMATION GOES. :00917000
:             IT IS ALSO EXPRESSED AS AN OPERAND.                      :00918000
:     EET  :  SAME AS "EST" EXCEPT WHEN THE SCANNING IS IN COORPARATION:00919000
:             WITH A "STRING" (SEE ALSO PROCEDURE "STRING").           :00920000
:     CC   :  THE CURRENT ADDRESS WHERE THE SCANNING SHOULD START.     :00921000
:             AFTER TH SCANNING, IT IS MODIFIED SO THAT IT POINTS TO   :00922000
:             THE NEXT VISIBLE CHARACTER.                              :00923000
:     NCR  :  NO. OF CHARACTERS SCANNED.                               :00924000
:     NXT  :  TWO FIELDS TO COMMUNICATE OUTSIDE:                       :00925000
:             NXT.[36:6]:  THE NEXT VISIBLE CHR AFTER SCANNING.        :00926000
:             NXT.[42:6]:  THE CHR-CODE OF THE NEXT CHR.               :00927000
:                 0: DIGIT,  2: LETTER,  4: SPECIAL CHR.               :00928000
:                 1 OR 3: INVALID CHR, THIS IS END-OF-FILE CODE.       :00929000
:     I,J,K:  THESE ARE USED AS SCRATCH PARAMETERS.                    :00930000
:  VALUE OF RESULT:                                                    :00931000
:     BIT 47:  INDICATION OF ERRORS (SEE FOLLOWING).                   :00932000
:     BIT 46:  AN INVALID CHARACTER ENCOUNTERED (BIT 47 ON).           :00933000
:     BIT 45:  NUMBER OF CHARACTERS SCANNED MORE THAN 63 (BIT 47 ON).  :00934000
:                              --------  J. C. PAO   06/10/67  --------:00935000
:......................................................................;00936000
     VALUE         TYP;                                                 00937000
     INTEGER       TYP;                                                 00938000
              BEGIN                                                     00939000
REAL STREAM PROCEDURE  SCANNING(D,S,BK,TY);                             00940000
     VALUE         TY;                                                  00941000
              BEGIN                                                     00942000
       LOCAL       T,B;                                                 00943000
       LABEL       DIGITS,SNGLCHR,LETTERS,DEBLANK,IDENTFR,CHARACTER;    00944000
       LABEL       COMENT,CHRCTR,CONTINUE,NEXT,DBK,RESULT;              00945000
                   SI~D; DI~LOC SCANNING; DS~WDS;                       00946000
                   SI~S; DI~LOC T; DS~WDS;                              00947000
                   DI~SCANNING;  SI~T;                                  00948000
                   CI~CI+TY;  % BRANCH ACCORDING TO VALUE OF TY.        00949000
                   GO TO DIGITS;   % TY=0,                              00950000
                   GO TO SNGLCHR;  % TY=1,                              00951000
                   GO TO LETTERS;  % TY=2,                              00952000
                   GO TO DEBLANK;  % TY=3,                              00953000
                   GO TO CHARACTER;% TY=4,                              00954000
                   GO TO IDENTFR;  % TY=5,                              00955000
                   GO TO COMENT;   % TY=6, ELSE (TY=7) SEE NEXT CHR.    00956000
                   IF SC>"9" THEN GO TO CONTINUE;                       00957000
                   GO TO NEXT;                                          00958000
         COMENT:   IF SC>"9" THEN GO TO CONTINUE;                       00959000
                   IF SC!""" THEN BEGIN DS~CHR; GO TO COMENT END;       00960000
                   SI~SI+1; GO TO DEBLANK;                              00961000
         CHARACTER:DI~LOC TY;  DI~DI+6;                                 00962000
         CHRCTR:   IF SC!DC THEN                                        00963000
                   BEGIN  SI~SI-1; DI~DI-1;                             00964000
                     IF SC>"9" THEN GO TO CONTINUE;                     00965000
                     SI~SI+1; GO TO CHRCTR;                             00966000
                   END;  DI~SCANNING;                                   00967000
                   GO TO DEBLANK;                                       00968000
         IDENTFR:  IF SC>"9" THEN GO TO CONTINUE;                       00969000
                   IF SC=ALPHA THEN                                     00970000
                   BEGIN DS~CHR; GO TO IDENTFR END ELSE                 00971000
                   GO TO DEBLANK;                                       00972000
         LETTERS:  IF SC>"9" THEN GO TO CONTINUE;                       00973000
                   IF SC}"0" THEN GO TO DEBLANK;                        00974000
                   IF SC=ALPHA THEN                                     00975000
                   BEGIN DS~CHR; GO TO LETTERS END ELSE                 00976000
                   GO TO DEBLANK;                                       00977000
         DIGITS:   IF SC>"9" THEN                                       00978000
         CONTINUE: BEGIN TALLY~3; GO TO RESULT END;                     00979000
                   IF SC}"0" THEN                                       00980000
                   BEGIN DS~CHR; GO TO DIGITS END ELSE                  00981000
                   GO TO DEBLANK;                                       00982000
         SNGLCHR:  IF SC>"9" THEN GO TO CONTINUE;                       00983000
                   DS~CHR;                                              00984000
         DEBLANK:  IF SC=" " THEN                                       00985000
                   BEGIN  TALLY~1; B~TALLY;                             00986000
         DBK:        SI~SI+1;                                           00987000
                     IF SC=" " THEN GO TO DBK;                          00988000
                   END;                                                 00989000
                   IF SC>"9" THEN TALLY~1 ELSE                          00990000
         NEXT:     IF SC}"0" THEN TALLY~0 ELSE                          00991000
                   IF SC=ALPHA THEN TALLY~2 ELSE TALLY~4;               00992000
         RESULT:   SCANNING~DI;  T~SI;                                  00993000
                   DI~D; SI~LOC SCANNING; DS~WDS;  % UPDATE DI.         00994000
                   SCANNING~TALLY;  SI~T;                               00995000
                   DI~LOC SCANNING; DI~DI+6; DS~CHR;  % NEXT CHR.       00996000
                   DI~S; SI~LOC T; DS~WDS;  % UPDATE SI.                00997000
                   SI~LOC B;  SI~SI+7;                                  00998000
                   IF SC!"0" THEN                                       00999000
                   BEGIN DI~BK; SI~LOC B; DS~WDS END;                   01000000
              END  SCANNING;                                            01001000
STREAM PROCEDURE   INVLID(A);                                           01002000
              BEGIN                                                     01003000
       LOCAL       T;                                                   01004000
                   SI~A; DI~LOC T; DS~WDS;                              01005000
                   DI~T;  DS~2 RESET; DS~2 SET; DS~2 RESET;  T~DI;      01006000
                   SI~LOC T; DI~A; DS~WDS;                              01007000
              END  INVLID;                                              01008000
       INTEGER     I,J,K;                                               01009000
       BOOLEAN     BC;       % ITEM SCANNED CONTINUED TO THE NEXT CARD. 01010000
       BOOLEAN     BR;       % SCRATCH BOOLEAN.                         01011000
       LABEL       L00,L0,L01,L1,L2,L3,L4,L5,L6,LE;                     01012000
COMMENT  IF THE CURRENT SCANNING STARTS AT A NEW CARD, AND IF IT IS NOT 01013000
         DURING PROCESS OF A "DEFINE", OUTPUT ALL THE ORIGINAL SYMBOLIC 01014000
         AND NEW GENERATED CARDS, AND TERMINATES THE GENERATING PROCESS;01015000
                   IF NEWCARD THEN  % END OF LAST CARD.                 01016000
                   BEGIN  NEWCD~BOOLEAN(1&BB[36:39:9]);                 01017000
                     BB~BBB;  % NO. OF LEADING BLANKS ON THE NEW CARD.  01018000
                     IF GENERATE THEN  % DURING GENERATING PROCESS.     01019000
                     BEGIN  % TERMINATE GENERATING AT THE END OF A CARD.01020000
                       IF CIVALID THEN EDITING(0,AVC);  GENERATE~FALSE; 01021000
                     END;                                               01022000
                     IF OUTN<NCD-2 THEN                                 01023000
                     BEGIN  OUTPUT(PPC);  OUTN~OUTN+1;                  01024000
                       OUTPUTNEW(NCD-2);  GO TO L00;                    01025000
                     END;                                               01026000
                     IF OUTN=NCD-2 THEN                                 01027000
         L00:        BEGIN  OUTPUT(PC);  OUTN~OUTN+1;                   01028000
                       OUTPUTNEW(NCD-1);                                01029000
                     END;  NEWCARD~FALSE;                               01030000
                   END ELSE NEWCD~FALSE;                                01031000
COMMENT  PREPARING FOR SCANNING;                                        01032000
                   IF (I~J~EET)!EST THEN                                01033000
                   BEGIN NCR~1; EV[0]~BLK&"""[18:42:6] END ELSE         01034000
                   BEGIN NCR~0; EV[0]~BLK END;                          01035000
                   % WHEN EET!EST SEE PROCEDURE "STRING".               01036000
                   IF TYP!7 THEN                                        01037000
                   IF ERX!0 THEN BEGIN EV[0].[1:1]~1; ERX~0 END;        01038000
                   K~3;  % A VALUE TO INDICATE THE STATUS IN SCANNING.  01039000
                         % K=0:  SCANNING COMPLETE, POINTER AT THE NEXT 01040000
                         %       VISIBLE CHARACTER.                     01041000
                         % K=1:  SCANNING COMPLETE, POINTER CAN NOT FIND01042000
                         %       A VISIBLE CHARACTER ON THIS CARD.      01043000
                         % K=3:  SCANNING TO BE CONTINUED TO THE NEXT   01044000
                         %       CARD.                                  01045000
                   CC0~CC;  % ADDRESS THAT THE SCANNING STARTS.         01046000
                   NC0~NCE~NCD;  % CARD NO. THE SCANNING STARTS & ENDS. 01047000
                   IF DFINE THEN GO TO L0;                              01048000
                   IF REAL(RESQ)!1 THEN TRNSFWDS(ENO,CV[11],1);         01049000
                   IF BBK THEN FST~LST~0 ELSE FST~4;                    01050000
                   BBK~FALSE;                                           01051000
COMMENT  THE SCANNING IS PERFORMED IN THE STREAM PROCEDURE "SCANNING",  01052000
         WHEN "BOOLEAN(K)" IS TRUE, READING THE NEXT CARD IS PERFORMED  01053000
         IN THE PROCEDUR  "INPUT" WHICH YEILDS A RESULT-VALUE OF TRUE IF01054000
         IT IS THE END OF THE "DEFINE" (WHEN DFINE=TRUE), OR THE END OF 01055000
         THE SYMBOLIC FILE AND PATCH DECK (WHEN DFINE=FALSE);           01056000
         L0:       WHILE BOOLEAN                                        01057000
                   (K~(NXT~SCANNING(I,CC,BBK,IF K=3 THEN TYP ELSE 3))   01058000
                   .[45:3]) DO                                          01059000
                   BEGIN  % READ NEXT CARD IS NECESSARY.                01060000
                     IF CC!CED THEN  % INVALID CHR ON CARD.             01061000
                     BEGIN  CV[9].[36:6]~1;                             01062000
                       BR~BR OR BOOLEAN(5);                             01063000
                       IF TYP=7 THEN GO TO L5;                          01064000
                       CC~IF CC.[30:3]=7 THEN CC.[33:15]+1 ELSE         01065000
                          CC&(CC.[30:3]+1)[30:45:3];                    01066000
                       INVLID(I);                                       01067000
                       K~1;  EV[0].[1:1]~1;  GO TO L0;                  01068000
                     END;                                               01069000
                     IF K=3 THEN                                        01070000
                     BEGIN  % INFORMATION TO BE CONTINUED TO NEXT CARD. 01071000
                       BC~TRUE;  % ITEM MAY BE CONTINUED TO NEXT CARD.  01072000
         L01:          IF NCR~NCR+                                      01073000
                       (I.[33:15]-J.[33:15])|8+I.[30:3]-J.[30:3]>63     01074000
                       THEN  % NO. OF CHR IN STRING GREATER THAN 63.    01075000
                       BEGIN  CV[9].[36:6]~1;  % MARK ERROR ON OLD CARD.01076000
                         IF GENERATE THEN                               01077000
                         BEGIN  % KEEP ON TRANSFERRING TO THE NEW CARD. 01078000
                           EV[0].[1:1]~1;  % SETTING ERROR IN EDITING.  01079000
                           IF BR.[44:1] THEN FST~4 ELSE                 01080000
                           IF TYP=6 THEN  % ADD OPENNING """ TO STRING. 01081000
                           BEGIN  I~EV[0];  EV[0]~0&"""[18:42:6];       01082000
                             ERREDT(1);  EV[0]~I;                       01083000
                           END;                                         01084000
                           ERREDT(NCR);                                 01085000
                         END;  NCR~0; I~J~EST;                          01086000
                         BR~BR OR BOOLEAN(9);                           01087000
                       END;                                             01088000
                       J~I;  % RETAIN DESTINATION ADDRESS.              01089000
                     END ELSE                                           01090000
                     IF BC THEN                                         01091000
                     BEGIN                                              01092000
                       BC~FALSE;                                        01093000
                       IF I=J THEN GO TO IF DFINE THEN L4 ELSE L1 ELSE  01094000
                       BEGIN  NCE~NCD;                                  01095000
                         IF REAL(RESQ)!1 THEN TRNSFWDS(ENO,CV[11],1);   01096000
                         GO TO L01;                                     01097000
                       END;                                             01098000
                     END ELSE                                           01099000
                     IF NEWCARD THEN                                    01100000
         L1:         BEGIN NCD~NCD-1; BBK~TRUE; GO TO L4 END; %SKIP BLK.01101000
                     IF REAL(DFINE)>0 THEN GO TO L4;                    01102000
                     IF OUTN<NCD-2 THEN  % PPC[*] HAS VALID CARD IMAGE. 01103000
                     BEGIN  OUTPUT(PPC);  OUTN~OUTN+1;                  01104000
                       OUTPUTNEW(NCD-2);  GO TO L2;                     01105000
                     END ELSE                                           01106000
                     IF OUTN=NCD-2 THEN  % PC[*] HAS VALID CARD IMAGE.  01107000
         L2:         BEGIN  % MAKE PC[*] AVAILABLE FOR CV[*].           01108000
                       IF NC0{NCD-1 THEN TRNSFWDS(PPC[0],PC[0],12) ELSE 01109000
                       BEGIN  OUTPUT(PC);  OUTN~OUTN+1;                 01110000
                         OUTPUTNEW(NCD-1);                              01111000
                       END;  GO TO L3;                                  01112000
                     END ELSE                                           01113000
                     IF OUTN=NCD-1 THEN  % CV[*] HAS VALID CARD IMAGE.  01114000
         L3:         BEGIN  TRNSFWDS(PC[0],CV[0],12);                   01115000
                       IF NEWCARD THEN                                  01116000
                       IF GENERATE THEN PC[9].[47:1]~1;  % MARK DELETED.01117000
                     END;                                               01118000
         L4:         IF DFINE THEN                                      01119000
                     BEGIN  READ(DFSK[NCD~NCD+1],12,CV[*]);             01120000
                       IF CV[9] .[36:6]!0 THEN ERRDFN~1;                01121000
                     END ELSE                                           01122000
                     IF REAL(DFINE)=2 THEN GO TO L5 ELSE                01123000
                     BEGIN                                              01124000
                       IF EOF~INPUT THEN  % READ NEXT INPUT CARD.       01125000
                       GO TO L5;  NCD~NCD+1;                            01126000
                       NEWCARD~TRUE  % REMEMBER A NEW CARD JUST READ.   01127000
                     END;  CC~CST;  % SET SCAN POINTER AT BEGINNING.    01128000
                   END;  % END OF "WHILE-LOOP".                         01129000
         L5:       IF NEWCARD THEN BBB~(CC.[33:15]-CST)|8+CC.[30:3];    01130000
                   IF TYP=7 THEN GO TO LE;                              01131000
                   IF NOT DFINE THEN                                    01132000
                   IF BC THEN                                           01133000
                   IF I!J THEN                                          01134000
                   IF NC0=NCD-1 THEN                                    01135000
                   BEGIN  % ITEM CONTINUED TO THIS CARD.                01136000
                     IF GENERATE THEN CV[9].[47:1]~1;                   01137000
                     BBB~0;  NEWCARD~FALSE;  NCE~NCD;                   01138000
                     IF REAL(RESQ)!1 THEN TRNSFWDS(ENO,CV[11],1);       01139000
                   END;                                                 01140000
                   IF NCR~NCR+                                          01141000
                   (I.[33:15]-J.[33:15])|8+I.[30:3]-J.[30:3]>63 THEN    01142000
         L6:       BEGIN  CV[9].[36:6]~1;  % CHRS IN ITEM > 63;         01143000
                     IF GENERATE THEN                                   01144000
                     BEGIN                                              01145000
                       EV[0].[1:1]~1;  % SETTING ERROR IN EDITING.      01146000
                       IF BR.[44:1] THEN FST~4 ELSE                     01147000
                       IF TYP=6 THEN  % ADD OPENNING """ TO THE STRING. 01148000
                       BEGIN  I~EV[0];  EV[0]~0&"""[18:42:6];           01149000
                         ERREDT(1);  EV[0]~I;                           01150000
                       END;                                             01151000
                       ERREDT(NCR);                                     01152000
                       IF TYP=6 THEN  % ADD CLOSING """ TO THE STRING.  01153000
                       BEGIN EV[0]~0&"""[18:42:6]; FST~4; ERREDT(1) END;01154000
                     END;                                               01155000
                     BR~BR OR BOOLEAN(9);                               01156000
                   END ELSE                                             01157000
                   IF BR.[44:1] THEN GO TO L6 ELSE                      01158000
                   IF BR.[45:1] THEN                                    01159000
                   IF GENERATE THEN EDITING(1,NCR);                     01160000
         LE:       SCAN~BR;                                             01161000
              END  SCAN;                                                01162000
REAL PROCEDURE     SCANNING;                                            01163000
COMMENT ................................................................01164000
:    THIS PROCEDURE SCANS A WORD.  IF THE WORD IS A "DEFINE", SCANNING :01165000
:WILL AUTOMATICALLY BRANCH TO THE DEFINETO GET "NXT" AND DO             01166000
:RETRY.  IF THE WORD IS A "COMMENT", THE COMMENT WILL BE SKIPPED AND   :01167000
:DOES THE RETRY AS THAT IN HANDLING THE DEFINE.                        :01168000
:    VALUE OF RESULT:                                                  :01169000
:      0:  A RESERVED WORD IS SCANNED.                                 :01170000
:      1:  THE WORD SCANNED HAS MORE THEN 63 CHRS OR AN INVALID CHR,   :01171000
:          THE WORD IS EDITED.                                         :01172000
:      2:  A DEFINE. BIT[29:13] CONTAINS THE INDEX OF INFO[*,*].       :01173000
:      4:  A SUBSCRIPTED IDENTIFIER.                                   :01174000
:      6:  A SIMPLE IDENTIFIER.                                        :01175000
:      8:  NOT FOUND IN INFO[*,*].  (IFX ALWAY SET TO BLK).            :01176000
:     10:  STREAM PROCEDURE OR A STREAM VALUE VARIABLE IF "STRM" IS ON.:01177000
:     12:  STREAM NAME VARIABLE.                                       :01178000
:     14:  STREAM VALUE VARIABLE ALSO IN LOCAL[*].                     :01179000
:     16:  STREAM NAME VARIABLE ALSO IN LOCAL[*].                      :01180000
:                              --------  J. C. PAO   04/23/68  --------:01181000
:......................................................................;01182000
              BEGIN                                                     01183000
       REAL        P,X,Y;                                               01184000
       LABEL       LL,L0,L1,LE;                                         01185000
                   IF SCAN(5) THEN                                      01186000
                   BEGIN SCANNING~1; IFX~BLK; GO TO LE END;             01187000
                   P~EV[0]&NCR[1:31:17];                                01188000
                   IF (IFX~STKHD[P MOD 125])=0 THEN GO TO L0;           01189000
                   DO                                                   01190000
                   IF INFO[X~IFX.[35:5],Y~IFX.[40:8]]=P THEN            01191000
                   BEGIN                                                01192000
                     IF NCR{5 THEN GO TO                                01193000
                     IF IFX}LFX THEN L1 ELSE IF IFX{RFX THEN L1 ELSE LL;01194000
                     IF COMPAREA(EV[1],INFO[X,Y+1],0,0,NCR-5)=0 THEN GO 01195000
                     IF IFX}LFX THEN L1 ELSE IF IFX{RFX THEN L1 ELSE LL;01196000
         LL:       END UNTIL (IFX~INFO[X,Y-1].[12:13])=0;               01197000
         L0:       IFX~BLK;  SCANNING~8;  GO TO LE;                     01198000
         L1:       IF BOOLEAN(X~(P~INFO[X,Y-1]).[1:3]) THEN             01199000
                   IF X=1 THEN SCANNING~10 ELSE                         01200000
                   IF STRM THEN SCANNING~9+X ELSE GO TO L0 ELSE         01201000
                   IF X=0 THEN GO TO LE ELSE                            01202000
                   IF X=4 THEN SCANNING~2&(IFX+P.[40:8])[29:35:13] ELSE 01203000
                   IF STRM THEN GO TO L0 ELSE                           01204000
                   IF (SCANNING~X)=2 THEN SCANNING~4;                   01205000
         LE:  END  SCANNING;                                            01206000
PROCEDURE          ERROR;                                               01207000
              BEGIN                                                     01208000
       LABEL       LE;                                                  01209000
                   IF DFINE THEN BEGIN ERRDFN~1; GO TO LE END;          01210000
                   EV[0].[1:1]~1;                                       01211000
                   IF NC0=NCD-2 THEN                                    01212000
                   BEGIN PPC[9].[36:6]~1; PC[9].[36:6]~1 END ELSE       01213000
                   IF NC0=NCD-1 THEN                                    01214000
                   BEGIN PC[9].[36:6]~1; CV[9].[36:6]~1 END ELSE        01215000
                   CV[9].[36:6]~1;                                      01216000
         LE:  END  ERROR;                                               01217000
PROCEDURE          DFINEIN(F);                                          01218000
COMMENT ................................................................01219000
:    THIS PROCEDURE STORES UP ALL THE CONCERNED INFORMATION OF THE     :01220000
:CURRENT SCANNING AND READS "DFSK" FILE STARTS THE SCANNING OF THE     :01221000
: DEFINE.  "F" IS THE INFO-INDEX OF THE ADDITIONAL INFORMATION OF THE  :01222000
:DEFINE.                                                               :01223000
:                              --------  J. C. PAO   05/04/68  --------:01224000
:......................................................................;01225000
     VALUE         F;                                                   01226000
     REAL          F;                                                   01227000
              BEGIN                                                     01228000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU[NO],DBG,"DFN-IN",NXT,F,LDF);          01229000
                   STR[LDF~LDF+1,0]~0;                                  01230000
                   STR[LDF, 1]~REAL(DFINE);                             01231000
                   STR[LDF, 2]~REAL(GENERATE);                          01232000
                   STR[LDF, 3]~REAL(NEWCARD);                           01233000
                   STR[LDF, 4]~REAL(RESQ);                              01234000
                   STR[LDF, 5]~CC;                                      01235000
                   STR[LDF, 6]~NCD;                                     01236000
                   STR[LDF, 7]~CC0;                                     01237000
                   STR[LDF, 8]~NC0;                                     01238000
                   STR[LDF, 9]~NCR;                                     01239000
                   STR[LDF,10]~NXT;                                     01240000
                   STR[LDF,11]~FST;                                     01241000
                   STR[LDF,12]~LST;                                     01242000
                   STR[LDF,13]~REAL(BBK);                               01243000
                   STR[LDF,14]~NCE;                                     01244000
                   TRNSFWDS(STR[LDF,17],EV[0],20);                      01245000
                   TRNSFWDS(STR[LDF,37],CV[0],12);                      01246000
                   DFINE~RESQ~TRUE;  LST~4;                             01247000
                   GENERATE~NEWCARD~BBK~FALSE;                          01248000
                   READ(DFSK[NCD~F],12,CV[*]);  CC~CST;                 01249000
                   ERRDFN~CV[9].[36:6];  F~REAL(SCAN(3));               01250000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"      ","      ","      ",       01251000
"      ","AFTER:",NXT,LDF);                                             01252000
IF DEBUGN=3 THEN DUMPARRAY(CV,0,11,FOU,1,"CV[*]:",CC);                  01253000
              END  DFINEIN;                                             01254000
PROCEDURE          DFINEOUT;                                            01255000
COMMENT ................................................................01256000
:    THIS PROCEDURE RESTORES THE ORIGINAL SCANNING INFORMATION AND     :01257000
:CONTINUES THE ORIGINAL SCANNING.                                      :01258000
:                              --------  J. C. PAO   05/04/68  --------:01259000
:......................................................................;01260000
              BEGIN                                                     01261000
       REAL        I;                                                   01262000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU[NO],DBG,"DFNOUT",NXT,STR[0,0],LDF);   01263000
                   DFINE   ~BOOLEAN(STR[LDF,1]);                        01264000
                   GENERATE~BOOLEAN(STR[LDF,2]);                        01265000
                   NEWCARD ~BOOLEAN(STR[LDF,3]);                        01266000
                   RESQ    ~BOOLEAN(STR[LDF,4]);                        01267000
                   CC ~STR[LDF, 5];                                     01268000
                   NCD~STR[LDF, 6];                                     01269000
                   CC0~STR[LDF, 7];                                     01270000
                   NC0~STR[LDF, 8];                                     01271000
                   NCR~STR[LDF, 9];                                     01272000
                   NXT~STR[LDF,10];                                     01273000
                   FST~STR[LDF,11];                                     01274000
                   LST~STR[LDF,12];                                     01275000
                   BBK~BOOLEAN(STR[LDF,13]);                            01276000
                   NCE~STR[LDF,14];                                     01277000
                   TRNSFWDS(CV[0],STR[LDF,37],12);                      01278000
                   IF LDF=0 THEN                                        01279000
                   IF (I~STR[0,0])!0 THEN                               01280000
                   BEGIN                                                01281000
                     IF BOOLEAN(I) THEN                                 01282000
                     BEGIN  EV[0]~0&"/"[18:42:6];                       01283000
                       IF NOT GENERATE THEN STARTGEN;  EDITING(1,1);    01284000
                     END;                                               01285000
                     IF BOOLEAN(I.[46:1]) THEN                          01286000
                     BEGIN  EV[0]~"47-  ";                              01287000
                       IF NOT GENERATE THEN STARTGEN;  EDITING(1,3);    01288000
                     END;                                               01289000
                     IF BOOLEAN(I.[45:1]) THEN                          01290000
                     BEGIN  EV[0]~"POINT"; EV[1]~0&"ER("[1:31:17];      01291000
                       IF NOT GENERATE THEN STARTGEN;  EDITING(1,8);    01292000
                     END;                                               01293000
                     IF BOOLEAN(I.[44:1]) THEN                          01294000
                     BEGIN  EV[0]~0&")"[18:42:6];                       01295000
                       IF NOT GENERATE THEN STARTGEN;  EDITING(1,1);    01296000
                     END;                                               01297000
                   END;                                                 01298000
                   TRNSFWDS(EV[0],STR[LDF,17],20);                      01299000
                   IF (LDF~LDF-1)<0 THEN                                01300000
                   BEGIN                                                01301000
                     IF ERRDFN!0 THEN                                   01302000
                     BEGIN EV[0].[1:1]~1; CV[9].[36:6]~1; ERRDFN~0 END; 01303000
                     IF GENERATE THEN EDITING(1,NCR);                   01304000
                   END;                                                 01305000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"      ","      ","      ",       01306000
"      ","AFTER:",NXT,LDF);                                             01307000
              END  DFINEOUT;                                            01308000
PROCEDURE          PERCENT;                                             01309000
COMMENT ................................................................01310000
:  THIS PROCEDURE TAKES CARE OF SCANNING AND EDITING OF THE NOTES AFTER:01311000
:A "%" ON THE CARD.                                                    :01312000
:                              --------  J. C. PAO   04/15/68  ------  :01313000
:......................................................................;01314000
              BEGIN                                                     01315000
       INTEGER     N;                                                   01316000
       LABEL       L0,L1,LE;                                            01317000
         L0:       N~(CED-CC.[33:15])|8-CC.[30:3];  % NO. OF CHRS AFT %.01318000
                   IF GENERATE THEN                                     01319000
                   IF NOT NEWCARD THEN                                  01320000
                   BEGIN                                                01321000
                     IF CIVALID THEN                                    01322000
                     BEGIN                                              01323000
                       IF N>AVC THEN                                    01324000
                       BEGIN EDITING(0,AVC); GO TO L1 END;              01325000
                     END ELSE                                           01326000
         L1:         BEGIN IC~IST; CIVALID~TRUE; AVC~72; CI[9]~2 END;   01327000
                     IF AVC!N THEN EDITING(0,AVC-N);                    01328000
                     CHRTRNSF(IC,CC,N);                                 01329000
                     LST~4;  AVC~0;                                     01330000
                   END;  CC~CED;                                        01331000
COMMENT  IF THE "%" IS AT COLUMN 72 ON THE CARD, SKIP THE NEXT CARD;    01332000
                   IF N=1 THEN  % A "%" AT COLUMN 72.                   01333000
                   BEGIN  % SKIP THE NEXT CARD.                         01334000
                     IF EOF THEN GO TO LE;                              01335000
                     N~REAL(SCAN(7));  % SEE THE NEXT CHR TO STOP SCAN. 01336000
                     CC~CED;                                            01337000
                   END;                                                 01338000
COMMENT  SET THE STARTING SCANNING ADDRESS AT THE FIRST VISIBLE CHR;    01339000
                   IF EOF THEN GO TO LE;                                01340000
                   N~REAL(SCAN(3));                                     01341000
                   IF NXT.[36:6]="%" THEN GO TO L0;                     01342000
         LE:  END  PERCENT;                                             01343000
PROCEDURE          COMMNT;                                              01344000
COMMENT ................................................................01345000
:  THIS PROCEDURE TAKES CARE THE SCANNING AND EDITING OF A COMMENT.    :01346000
:THE PROCESS TERMINATES AT END-OF-FILE OR AFTER A SEMICOLUMN.  THE     :01347000
:ENTIRE COMMENT WILL BE EDITED AT THE SAME COLUMN AS ON THE OLD CARD.  :01348000
:                              --------  J. C. PAO   04/15/68  ------  :01349000
:......................................................................;01350000
              BEGIN                                                     01351000
       INTEGER     N,S;                                                 01352000
       LABEL       L1,L2,L3,L4,LE;                                      01353000
                   IF GENERATE THEN                                     01354000
                   BEGIN  % DURING GENERATING PROCESS.                  01355000
                     IF NOT CIVALID THEN                                01356000
                     BEGIN IC~IST; CIVALID~TRUE; AVC~72; CI[9]~2 END;   01357000
                     IF AVC>(N~(CED-CC0.[33:15])|8-CC0.[30:3]) THEN     01358000
                     BEGIN EDITING(0,AVC-N); GO TO L2 END ELSE          01359000
                     IF AVC=N THEN GO TO IF LST!4 THEN L1 ELSE L2 ELSE  01360000
                     BEGIN                                              01361000
         L1:           EDITING(0,AVC);                                  01362000
                       EDITING(0,72-N-BB);  CI[9]~2;                    01363000
         L2:           ERREDT(7);  % EDIT THE WORD "COMMENT".           01364000
                       IF N>7 THEN                                      01365000
                       IF NC0<NCD THEN GO TO L3 ELSE                    01366000
                       EDITING(0,AVC-(CED-CC.[33:15])|8+CC.[30:3]) ELSE 01367000
                       IF N<7 THEN                                      01368000
                       BEGIN                                            01369000
                         IF NC0=NCD-2 THEN                              01370000
         L3:             EDITING(0,AVC) ELSE                            01371000
                       EDITING(0,65+N-(CED-CC.[33:15])|8+CC.[30:3]);    01372000
                       END ELSE  % N=7.                                 01373000
                       IF CC=CST THEN EDITING(0,72);                    01374000
                     END;                                               01375000
                   END;                                                 01376000
COMMENT  SCANNING UNTIL AFTER SEMICOLUMN, EDITING UNTIL THE END OF THE  01377000
         ORIGINAL CARD (END OF GENERATING);                             01378000
         L4:       IF EOF THEN GO TO LE;                                01379000
                   IF GENERATE THEN S~NXT;                              01380000
                   IF NXT.[36:6]=";" THEN                               01381000
                   BEGIN  N~REAL(SCAN(1));                              01382000
                     IF GENERATE THEN                                   01383000
                     BEGIN LST~4; EDITING(1,1) END;  GO TO LE;          01384000
                   END;                                                 01385000
                   CC~IF CC.[30:3]=7 THEN CC.[33:15]+1 ELSE             01386000
                      CC&(CC.[30:3]+1)[30:45:3];                        01387000
                   N~REAL(SCAN(7));                                     01388000
                   IF GENERATE THEN                                     01389000
                   BEGIN LST~4; EV[0]~0&S[18:36:6]; EDITING(1,1) END;   01390000
                   GO TO L4;                                            01391000
         LE:  END  COMMNT;                                              01392000
PROCEDURE          STRING;                                              01393000
COMMENT ................................................................01394000
:    THIS PROCEDURE TAKES CARE OF SCANNING AND EDITING OF A STRING.    :01395000
:THIS PROCEDURE ONLY BE CALLED WHEN THE OPENNING QUOTE OF A STRING IS  :01396000
:INDICATED BY "NXT".                                                   :01397000
:                              --------  J. C. PAO   04/16/68  --------:01398000
:......................................................................;01399000
              BEGIN                                                     01400000
       INTEGER     I,J;                                                 01401000
       LABEL       LE;                                                  01402000
                   J~CC&NCD[9:27:21]&REAL(BBK)[1:47:1];                 01403000
                   CC~IF (I~CC.[30:3])=7 THEN CC.[33:15]+1 ELSE         01404000
                      CC&(I+1)[30:45:3];  % SKIP THE OPENNING QUOTE.    01405000
                   I~REAL(SCAN(7));  % SEE THE NEXT CHARACTER.          01406000
                   IF NEWCARD THEN                                      01407000
                   BEGIN  IF GENERATE THEN CV[9].[47:1]~1;              01408000
                     BBB~0;  NEWCARD~FALSE;  NCE~NCD;                   01409000
                     IF REAL(RESQ)!1 THEN TRNSFWDS(ENO,CV[11],1);       01410000
                   END;                                                 01411000
                   IF NXT.[36:6]=""" THEN                               01412000
                   BEGIN  % THE 1ST CHARACTER OF THE STRING IS A """.   01413000
                     EET.[30:3]~4;                                      01414000
                     CC~IF (I~CC.[30:3])=7 THEN CC.[33:15]+1 ELSE       01415000
                        CC&(I+1)[30:45:3];  % SKIP THE OPENNING QUOTE.  01416000
                     IF SCAN(6) THEN   % ERROR ENCOUNTERED IN SCANNING. 01417000
                     BEGIN EET~EST; GO TO LE END;                       01418000
                     EET~EST;                                           01419000
                   END ELSE                                             01420000
                   IF SCAN(6) THEN GO TO LE;                            01421000
                   IF GENERATE THEN                                     01422000
                   BEGIN  IF BOOLEAN(J.[1:1]) THEN LST~FST~0;           01423000
                     EDITING(2,NCR);                                    01424000
                   END ELSE                                             01425000
                   BEGIN  BBK~BOOLEAN(J.[1:1]);                         01426000
                     CC0~J.[30:18];  NC0~J.[9:21];                      01427000
                   END;                                                 01428000
         LE:  END  STRING;                                              01429000
PROCEDURE          NUMBER;                                              01430000
COMMENT ................................................................01431000
:    THIS PROCEDURE PICKS UP A NUMBER.                                 :01432000
:                              --------  J. C. PAO   04/25/68  --------:01433000
:......................................................................;01434000
              BEGIN                                                     01435000
       LABEL       L1,L2,L3,L4,LE;                                      01436000
                   IF NXT.[36:6]="." THEN GO TO L1;                     01437000
                       IF NXT.[36:6]="@" THEN GO TO L3;                 01438000
                   IF NOT SCAN(0) THEN                                  01439000
                   IF GENERATE THEN EDITING(1,NCR);                     01440000
                   IF EOF THEN GO TO LE;                                01441000
                   IF NXT.[36:6]="." THEN                               01442000
                   BEGIN  % IT MAY BE A DECIMAL POINT.                  01443000
                     IF BBK THEN  % NOT DECIMAL POINT, PICK UP ANY WAY. 01444000
                     BEGIN                                              01445000
                       IF DFINE THEN ERRDFN~1 ELSE CV[9].[36:6]~ERX~1;  01446000
                       IF NOT SCAN(1) THEN                              01447000
                       IF GENERATE THEN EDITING(1,1);  GO TO LE;        01448000
                     END;                                               01449000
         L1:         IF NOT SCAN(1) THEN                                01450000
                     IF GENERATE THEN EDITING(1,1);                     01451000
                     IF EOF THEN GO TO L2;                              01452000
                     IF NXT.[42:6]!0 THEN                               01453000
                     BEGIN  % NOT A DECIMAL POINT.                      01454000
         L2:           IF DFINE THEN ERRDFN~1 ELSE CV[9].[36:6]~ERX~1;  01455000
                       GO TO LE;                                        01456000
                     END ELSE                                           01457000
                     IF BBK THEN GO TO L2;                              01458000
                     IF NOT SCAN(0) THEN                                01459000
                     IF GENERATE THEN EDITING(1,NCR);                   01460000
                   END;                                                 01461000
                   IF EOF THEN GO TO LE;                                01462000
                   IF NXT.[36:6]="%" THEN PERCENT;                      01463000
                   IF NXT.[36:6]!"@" THEN GO TO LE;                     01464000
         L3:       IF NOT SCAN(1) THEN                                  01465000
                   IF GENERATE THEN EDITING(1,1);                       01466000
                   IF EOF THEN GO TO L2;                                01467000
                   IF NXT.[36:6]="%" THEN PERCENT;                      01468000
                   IF NXT.[36:6]="+" THEN GO TO L4;                     01469000
                   IF NXT.[36:6]="-" THEN                               01470000
         L4:       IF NOT SCAN(1) THEN                                  01471000
                   IF GENERATE THEN EDITING(1,1);                       01472000
                   IF EOF THEN GO TO L2;                                01473000
                   IF NXT.[36:6]="%" THEN PERCENT;                      01474000
                   IF NXT.[42:6]!0 THEN GO TO L2;                       01475000
                   IF NOT SCAN(0) THEN                                  01476000
                   IF GENERATE THEN EDITING(1,NCR);                     01477000
         LE:  END  NUMBER;                                              01478000
PROCEDURE          FOURTY7(S);                                          01479000
     VALUE         S;                                                   01480000
     REAL          S;                                                   01481000
COMMENT ................................................................01482000
:    THIS PROCEDURE SCANS AN INTEGER AND EDITS INTO THE NEW CARD IMAGE :01483000
:A VALUE OF 47 MINUS THAT INTEGER.  IF THE SCANNING HAS ERROR OR THE   :01484000
:NEW VALUE IS NO GOOD THE ERROR WILL BE SET IN BOTH OLD AND NEW CARD.  :01485000
:***** IMPORTANT: THE PROCEDURE ONLY BE CALLED WHEN "DFINE" IS FALSE.  :01486000
:                              --------  J. C. PAO   04/18/68  --------:01487000
:......................................................................;01488000
              BEGIN                                                     01489000
       INTEGER     I;                                                   01490000
       LABEL       L1,LE;                                               01491000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"FOUR-7",NXT);                    01492000
                   IF BOOLEAN(S) THEN                                   01493000
                   IF SCAN(0) THEN GO TO LE;                            01494000
                   IF NCR>2 THEN                                        01495000
                   IF NCR~LEADING0(EV[0],NCR)>2 THEN                    01496000
         L1:       BEGIN  % NO. OF DIGITS MORE THAN 2.                  01497000
                     ERROR;                                             01498000
                     IF GENERATE THEN EDITING(1,NCR);                   01499000
                     GO TO LE;                                          01500000
                   END;                                                 01501000
                   IF (I~47-(IF NCR=1 THEN EV[0].[18:6] ELSE            01502000
                     EV[0].[18:6]|10+EV[0].[24:6]))<0 THEN              01503000
                   GO TO L1;                                            01504000
                   IF I<10 THEN BEGIN NCR~1; EV[0].[18:6]~I END ELSE    01505000
                   IF I{46 THEN                                         01506000
                   BEGIN  NCR~2;                                        01507000
                     EV[0].[18:12]~ENTIER(I MOD 10)&(I DIV 10)[36:42:6];01508000
                   END ELSE GO TO L1;                                   01509000
                   IF NOT GENERATE THEN STARTGEN;  EDITING(1,NCR);      01510000
         LE:  END  FOURTY7;                                             01511000
REAL PROCEDURE     CHECKNEXT(NEXT);                                     01512000
COMMENT ................................................................01513000
:    THIS PROCEDURE CHECKS THE "NXT" AGAINST THE GIVEN VALUE OF "NEXT".:01514000
:IT ALSO TAKES CARE OF BRANCHING INTO A DEFINE AND SKIPPING THE "%" AND:01515000
:THE "COMMENT".                                                        :01516000
:    VALUE OF RESULT:                                                  :01517000
:      0:  A RESERVED WORD OR "DONT-CARE" OR NOT FOUND, IF IFX=LBK.    :01518000
:      1:  THE END-OF-FILE.                                            :01519000
:      2:  A SPECIAL CHARACTER OR DIGIT WHICH NOT EQUAL TO "NEXT".     :01520000
:          (THE ONLY CASE THE "NXT" IS NOT SCANNED EVEN NOT MATCH).    :01521000
:      3:  THE RESERVED WORD "BEGIN".  (NOT EDITED).                   :01522000
:      4: A SUBSCRIPTED IDENTIFIER.                                    :01523000
:      5:  THE RESERVED WORD "END".  (NOT EDITED).                     :01524000
:      6:  A SIMPLE IDENTIFIER.                                        :01525000
:      8: THE "NXT" EQUALS TO THE GIVEN "NEXT".  (NOT SCANNED).        :01526000
:      9:  AN INVALID CHR OR NO. OF CHRS > 63.          ("STRM" IS ON).:01527000
:     10:  STREAM PROCEDURE OR STREAM VALUE VARIABLE IF "STRM" IS ON.  :01528000
:     12:  STREAM NAME VARIABLE.                        ("STRM" IS ON).:01529000
:     14:  STREAM VALUE VARIABLE ALSO IN LOCAL[*].      ("STRM" IS ON).:01530000
:     16:  STREAM NAME VARIABLE ALSO IN LOCAL[*].       ("STRM" IS ON).:01531000
:                              --------  J. C. PAO   04/22/68  --------:01532000
:......................................................................;01533000
     VALUE         NEXT;                                                01534000
     REAL          NEXT;                                                01535000
              BEGIN                                                     01536000
       REAL        I;                                                   01537000
       LABEL       L1,L4,LE;                                            01538000
                   LLF~LDF;  % LOWEST DEFINE LEVEL ENCOUNTERED.         01539000
         L1:       IF EOF THEN                                          01540000
                   BEGIN CHECKNEXT~1; GO TO LE END;                     01541000
                   IF NXT=NEXT THEN BEGIN CHECKNEXT~8; GO TO LE END;    01542000
                   IF I~NXT.[36:6]="%" THEN BEGIN PERCENT; GO TO L1 END;01543000
                   IF I="#" THEN                                        01544000
                   IF DFINE THEN BEGIN DFINEOUT; LLF~LDF; GO TO L1 END; 01545000
                   IF NXT.[42:6]!2 THEN BEGIN CHECKNEXT~2; GO TO LE END;01546000
COMMENT  CHECK THE NEXT CHARACTER IS A LETTER, CHECK WHAT IT IS;        01547000
                   IF BOOLEAN(I~SCANNING) THEN                          01548000
                   BEGIN IF STRM THEN CHECKNEXT~9; GO TO LE END;        01549000
                   IF I=0 THEN                                          01550000
                   BEGIN                                                01551000
                     IF IFX=DFX+2 THEN  % RESERVED WORD "BEGIN".        01552000
                     BEGIN CHECKNEXT~3; GO TO LE END;                   01553000
                     IF IFX=DFX+4 THEN  % RESERVED WORD "END".          01554000
                     BEGIN CHECKNEXT~5; GO TO LE END;                   01555000
                     IF IFX=DFX+6 THEN  % RESERVED WORD "COMMENT".      01556000
                     IF NOT ENDCMMT THEN                                01557000
                     BEGIN COMMNT; GO TO L1 END;                        01558000
                     GO TO IF REAL(STRM)=0 THEN L4 ELSE LE;             01559000
                   END;                                                 01560000
                   IF I.[42:6]!2 THEN                                   01561000
                   IF STRM THEN                                         01562000
                   BEGIN  CHECKNEXT~IF I=8 THEN 0 ELSE I;               01563000
                     GO TO LE;                                          01564000
                   END ELSE                                             01565000
                   BEGIN  CHECKNEXT~IF I=8 THEN 0 ELSE I;               01566000
                     GO TO IF REAL(STRM)=0 THEN L4 ELSE LE;             01567000
                   END ELSE                                             01568000
                   BEGIN  % THIS IS A DEFINE.                           01569000
                     DFINEIN(INFO[I.[29:5],I.[34:8]]);                  01570000
                     IF B47 THEN                                        01571000
                     IF LDF=0 THEN STR[0,0].[46:1]~1;  GO TO L1;        01572000
                   END;                                                 01573000
         L4:       IF GENERATE THEN EDITING(1,NCR);                     01574000
         LE:       B47~FALSE;                                           01575000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"CHKNXT",NXT,IFX); END; COMMENT ..01576000
              END  CHECKNEXT;                                           01577000
REAL PROCEDURE     BALABALA(I);  VALUE I; REAL I;  FORWARD;             01578000
REAL PROCEDURE     BRACKET(CLOS,EDT);                                   01579000
COMMENT ................................................................01580000
:    THIS PROCEDURE PROCESSES A STRING OF ALGOL LANGUAGE ENCLOSED IN A :01581000
:PAIR OF BRACKETS OF PARENTHESES.                                      :01582000
:    VALUE OF RESULT:                                                  :01583000
:      0:  THE GIVEN "]" OR ")" NOT FOUND, STOPPED AT ")", "]" OR A    :01584000
:          SEMICOLUMN.                                                 :01585000
:      1:  STOPPED AT END-OF-FILE.                                     :01586000
:      3:  STOPPED AT "BEGIN".                                         :01587000
:      4:  THE GIVEN "]" OR ")" WAS FOUND AND PROCESSED.               :01588000
:      5:  STOPPED AT "END".                                           :01589000
:                              --------  J. C. PAO   04/22/68  --------:01590000
:......................................................................;01591000
     VALUE         CLOS,EDT;                                            01592000
     REAL          CLOS,EDT;                                            01593000
              BEGIN                                                     01594000
       REAL        I;                                                   01595000
       LABEL       LE;                                                  01596000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"PRACKT",NXT,CLOS,EDT);           01597000
                   IF BOOLEAN(EDT) THEN                                 01598000
                   BEGIN                                                01599000
                     IF DFINE THEN                                      01600000
                     IF CLOS="]" THEN IF CV[9].[43:2]!0 THEN ERRDFN~1;  01601000
                     IF NOT SCAN(1) THEN                                01602000
                     IF GENERATE THEN EDITING(1,1);                     01603000
                   END;                                                 01604000
                   IF BOOLEAN(BRACKET~BALABALA(0)) THEN                 01605000
                   BEGIN ERROR; GO TO LE END;                           01606000
                   IF NXT.[36:6]!CLOS THEN                              01607000
                   BEGIN  % ERROR CONDITION.                            01608000
                     IF DFINE THEN ERRDFN~1 ELSE                        01609000
                     BEGIN CV[9].[36:6]~1; ERX~1 END;                   01610000
                     GO TO LE;                                          01611000
                   END;                                                 01612000
                   IF NOT SCAN(1) THEN                                  01613000
                   IF GENERATE THEN EDITING(1,1);  BRACKET~4;           01614000
         LE:  END  BRACKET;                                             01615000
REAL PROCEDURE     SUBSCRIPT;                                           01616000
COMMENT ................................................................01617000
:    THIS PROCEDURE PICKS UP THE SUBSCRIPTION IF THERE IS ANY.         :01618000
:    VALUE OF RESULT:  0:  NO SUBSCRIPTION IS FOUND.                   :01619000
:                      1:  STOPED AT "BEGIN".                          :01620000
:                      3:  STOPED AT "END".                            :01621000
:                      8:  THE SUBSCRIPTION IS PICKED UP.              :01622000
:                              --------  J. C. PAO   04/22/68  --------:01623000
:......................................................................;01624000
              BEGIN                                                     01625000
       REAL        I;                                                   01626000
       LABEL       L1,L2,L3,LE;                                         01627000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"SUBSPT",NXT);                    01628000
                   IF EOF THEN                                          01629000
         L1:       BEGIN SUBSCRIPT~1; GO TO LE END;                     01630000
                   IF NXT.[36:6]="[" THEN GO TO L2;                     01631000
                   IF (I~CHECKNEXT(4&"["[36:42:6]))=8 THEN              01632000
                   BEGIN                                                01633000
         L2:         IF (I~BRACKET("]",1))=4 THEN                       01634000
                     BEGIN SUBSCRIPT~8; GO TO LE END ELSE               01635000
                     IF NOT BOOLEAN(I) THEN I~2;                        01636000
                   END ELSE                                             01637000
                   IF I=2 THEN                                          01638000
                   IF NXT.[42:6]=4 THEN GO TO L3;                       01639000
COMMENT  ILEAGAL ITEM FOLLOWS THIS SUBSCRIPTED ID, POSSIBLE ERROR;      01640000
                   IF DFINE THEN ERRDFN~1 ELSE                          01641000
                   IF I=2 THEN CV[9].[36:6]~ERX~1 ELSE                  01642000
                   BEGIN ERROR; CI[9].[36:6]~1 END;                     01643000
         L3:       SUBSCRIPT~I;                                         01644000
         LE:  END  SUBSCRIPT;                                           01645000
REAL PROCEDURE     PARTIAL(P);                                          01646000
COMMENT ................................................................01647000
:    THIS PROCEDURE SCANS FOR A PARTIAL-FIELD IF P=1, OR SCANS FOR A   :01648000
:CONCATENATE-FIELD IF P!1.                                             :01649000
:    VALUE OF RESULT:                                                  :01650000
:      0:  A RESEVED WORD.                                             :01651000
:      1:  THE END-OF-FILE.                                            :01652000
:      2:  A SPECIAL CHARACTER OR DIGIT.                               :01653000
:          (NOT SCANNED).                                              :01654000
:      3:  THE RESERVED WORD "BEGIN".  (NOT EDITED).                   :01655000
:      4: A SUBSCRIPTED IDENTIFIER.                                    :01656000
:      5:  THE RESERVED WORD "END".  (NOT EDITED).                     :01657000
:      6:  A SIMPLE IDENTIFIER.                                        :01658000
:      8:  THE FIELD IS PROCESSED.                                     :01659000
:                              --------  J. C. PAO   04/26/68  --------:01660000
:......................................................................;01661000
     VALUE         P;                                                   01662000
     REAL          P;                                                   01663000
              BEGIN                                                     01664000
       REAL        I;                                                   01665000
       LABEL       L1,L2,L3,L4,L5,L6,L7,L8,L9,LE;                       01666000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"PARTIL",NXT,P);                  01667000
                   P~IF BOOLEAN(P) THEN 2 ELSE 3;                       01668000
COMMENT  LOOKING FOR "[" FIRST;                                         01669000
                   IF EOF THEN                                          01670000
         L1:       BEGIN PARTIAL~1; GO TO LE END;                       01671000
                   IF NXT.[36:6]="[" THEN GO TO L4;                     01672000
                   IF NXT.[42:6]=0 THEN                                 01673000
         L2:       BEGIN  % POSSIBLE ERROR, THE "[" NOT FOUND.          01674000
                     IF DFINE THEN ERRDFN~1 ELSE CV[9].[36:6]~ERX~1;    01675000
                     PARTIAL~2;  GO TO LE;                              01676000
                   END;                                                 01677000
                   IF (I~CHECKNEXT(4&"["[36:42:6]))!8 THEN              01678000
                   BEGIN                                                01679000
                     IF I=2 THEN GO TO L2;                              01680000
                     IF DFINE THEN ERRDFN~1 ELSE                        01681000
                     BEGIN ERROR; CI[9].[36:6]~1 END;                   01682000
         L3:         PARTIAL~I;  GO TO LE;                              01683000
                   END;                                                 01684000
         L4:       IF NOT SCAN(1) THEN                                  01685000
                   IF GENERATE THEN EDITING(1,1);                       01686000
COMMENT  IF IT IS DURING EXECUTION OF A DEFINE, AND THE "[" WAS MARKED  01687000
         NOT RECOGNIZED AS A PARTIAL-FIELD, NO SCANNING IS NEED;        01688000
                   IF DFINE THEN                                        01689000
                   BEGIN                                                01690000
                     IF ERRDFN=0 THEN                                   01691000
                     IF I~CV[9].[43:2]!0 THEN                           01692000
                     BEGIN  % CHANGE WAS MADE IN THE DEFINE.            01693000
                       IF I!P-1 THEN ERRDFN~1;                          01694000
                     END ELSE ERRDFN~1;                                 01695000
                   END;                                                 01696000
COMMENT  MAKE SURE THE BIT INDEX IS A INTEGER;                          01697000
         L6:       IF EOF THEN GO TO L1;                                01698000
                   B47~P>1;                                             01699000
                   IF NXT.[42:6]=0 THEN GO TO L8;                       01700000
                   IF (I~CHECKNEXT(1))!2 THEN  % NOT A DIGIT.           01701000
         L7:       BEGIN  % MARK ERROR.                                 01702000
                     IF DFINE THEN ERRDFN~1 ELSE                        01703000
                     IF I=2 THEN CV[9].[36:6]~ERX~1 ELSE                01704000
                     BEGIN ERROR; CI[9].[36:6]~1 END;                   01705000
                     IF (PARTIAL~BRACKET("]",0))=4 THEN PARTIAL~8;      01706000
                     GO TO LE;                                          01707000
                   END;                                                 01708000
                   IF NXT.[42:6]!0 THEN GO TO L7;                       01709000
         L8:       IF (P~P-1)=0 THEN                                    01710000
                   BEGIN                                                01711000
                     IF NOT SCAN(0) THEN                                01712000
                     IF GENERATE THEN EDITING(1,NCR);                   01713000
                   END ELSE                                             01714000
                   IF DFINE THEN I~REAL(SCAN(0)) ELSE FOURTY7(1);       01715000
COMMENT  CHECK THE ":" OR "]";                                          01716000
                   IF EOF THEN GO TO L1;                                01717000
                   IF NXT=(I~4&(IF P=0 THEN "]" ELSE ":")[36:42:6]) THEN01718000
                   GO TO L9;                                            01719000
                   IF NXT.[42:6]=0 THEN BEGIN I~2; GO TO L7 END;        01720000
                   IF (I~CHECKNEXT(I))!8 THEN GO TO L7;                 01721000
         L9:       IF NOT SCAN(1) THEN                                  01722000
                   IF GENERATE THEN EDITING(1,1);                       01723000
                   IF P>0 THEN GO TO L6;                                01724000
                   PARTIAL~8;                                           01725000
         LE:       B47~FALSE;                                           01726000
              END  PARTIAL;                                             01727000
REAL PROCEDURE     STRMPROCDUR;  FORWARD;                               01728000
REAL PROCEDURE     CONCATENATE;                                         01729000
COMMENT ................................................................01730000
:    THIS PROCEDURE SCANS FOR THE PART STARTING FROM AFTER THE "&" IN  :01731000
:A CONCATENATE EXPRESSION.                                             :01732000
:    VALUE OF RESULT:                                                  :01733000
:      0:  A RESEVED WORD.                                             :01734000
:      1:  THE END-OF-FILE.                                            :01735000
:      2:  A SPECIAL CHARACTER OR DIGIT.                               :01736000
:          (NOT SCANNED).                                              :01737000
:      3:  THE RESERVED WORD "BEGIN".  (NOT EDITED).                   :01738000
:      4: A SUBSCRIPTED IDENTIFIER.                                    :01739000
:      5:  THE RESERVED WORD "END".  (NOT EDITED).                     :01740000
:      6:  A SIMPLE IDENTIFIER.                                        :01741000
:      8:  THE CONCATENATE ERPRESSION IS COMPLETLY PROCESSED.          :01742000
:                              --------  J. C. PAO   04/26/68  --------:01743000
:......................................................................;01744000
              BEGIN                                                     01745000
       REAL        I;                                                   01746000
       LABEL       L1,L2,L3,L4,L5,L6,LE;                                01747000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"CONCAT",NXT);                    01748000
                   IF EOF THEN                                          01749000
         L1:       BEGIN CONCATENATE~1; GO TO LE END;                   01750000
                   IF BOOLEAN(I~CHECKNEXT(1)) THEN                      01751000
         L2:       BEGIN                                                01752000
                     IF DFINE THEN ERRDFN~1 ELSE                        01753000
                     IF I=2 THEN CV[9].[36:6]~ERX~1 ELSE                01754000
                     BEGIN ERROR; CI[9].[36:6]~1 END;                   01755000
         L3:         CONCATENATE~I;  GO TO LE;                          01756000
                   END;                                                 01757000
                   IF I=6 THEN GO TO L4;                                01758000
                   IF I=2 THEN                                          01759000
                   BEGIN                                                01760000
                     IF NXT.[36:6]=""" THEN BEGIN STRING; GO TO L4 END; 01761000
                     IF NXT.[36:6]="(" THEN                             01762000
                     GO TO IF (I~BRACKET(")",1))=4 THEN L4 ELSE L2;     01763000
                     IF NXT.[42:6]=0 THEN                               01764000
                     BEGIN                                              01765000
                       IF NOT SCAN(0) THEN                              01766000
                       IF GENERATE THEN EDITING(1,NCR);  GO TO L6;      01767000
                     END;  GO TO L2;                                    01768000
                   END;                                                 01769000
                   IF I=0 THEN                                          01770000
                   BEGIN                                                01771000
                     IF NXT.[36:6]="(" THEN                             01772000
                     GO TO IF (I~BRACKET(")",1))=4 THEN L4 ELSE L2;     01773000
                   END;                                                 01774000
                   IF I=10 THEN                                         01775000
                   GO TO IF (I~STRMPROCDUR)=8 THEN L4 ELSE L2;          01776000
                   IF I=4 THEN                                          01777000
                   IF (I~SUBSCRIPT)!8 THEN GO TO L2;                    01778000
         L4:       IF EOF THEN GO TO L1;                                01779000
                   IF I~NXT.[36:6]="[" THEN GO TO L6;                   01780000
                   IF I="." THEN GO TO L5;                              01781000
                   IF NXT.[42:6]=0 THEN GO TO L2;                       01782000
                   IF (I~CHECKNEXT(4&"."[36:42:6]))=8 THEN              01783000
         L5:       BEGIN  % NEXT IS A "." PICK UP PARTIAL-FIELD 1ST.    01784000
                     IF NOT SCAN(1) THEN                                01785000
                     IF GENERATE THEN EDITING(1,1);                     01786000
                     GO TO IF (I~PARTIAL(1))=8 THEN L6 ELSE L2;         01787000
                   END;                                                 01788000
         L6:       GO TO IF (I~PARTIAL(0))=8 THEN L3 ELSE L2;           01789000
         LE:  END  CONCATENATE;                                         01790000
REAL PROCEDURE     FILLSTATEMENT;                                       01791000
COMMENT ................................................................01792000
:    THIS PROCEDURE PROCESSES A FILL-STATEMENT.                        :01793000
:    VALUE OF RESULT:  0-6: SAME AS IN "CHECKNEXT" PROCEDURE.          :01794000
:                        8: PROCESSED WITH A SEMICOLUM.                :01795000
:                              --------  J. C. PAO   06/19/68  --------:01796000
:......................................................................;01797000
              BEGIN                                                     01798000
       REAL        I;                                                   01799000
       LABEL       L1,L2,L3,LX,LX1,LX2,LE;                              01800000
                   IF GENERATE THEN EDITING(1,NCR);  % THE WORD "FILL". 01801000
                   IF (I~CHECKNEXT(1))!4 THEN                           01802000
         LX:       BEGIN                                                01803000
                     IF DFINE THEN ERRDFN~1 ELSE                        01804000
                     IF I=2 THEN CV[9].[36:6]~ERX~1 ELSE                01805000
                     BEGIN ERROR; CI[9].[36:6]~1 END;                   01806000
         LX1:        FILLSTATEMENT~I;  GO TO LE;                        01807000
                   END;                                                 01808000
                   IF (I~SUBSCRIPT)!8 THEN GO TO LX;                    01809000
                   IF (I~CHECKNEXT(1))!0 THEN GO TO LX;                 01810000
                   IF IFX!DFX+33 THEN GO TO LX;  % DFX+33 IS "WITH".    01811000
         L1:       STRM~BOOLEAN(2);  I~CHECKNEXT(1);  STRM~FALSE;       01812000
                   IF I=2 THEN                                          01813000
                   BEGIN                                                01814000
                     IF NXT.[42:6]=0 THEN                               01815000
                     BEGIN                                              01816000
                       IF NOT SCAN(0) THEN                              01817000
                       IF GENERATE THEN EDITING(1,NCR);                 01818000
                     END ELSE                                           01819000
                     IF NXT.[36:6]=""" THEN STRING ELSE GO TO LX;       01820000
                     GO TO L2;                                          01821000
                   END;                                                 01822000
                   IF I!0 THEN GO TO IF BOOLEAN(I) THEN LX ELSE LX2;    01823000
                   IF IFX!BLK THEN GO TO LX2;                           01824000
                   IF EV[0].[18:18]!"OCT" THEN                          01825000
         LX2:      BEGIN                                                01826000
                     IF GENERATE THEN EDITING(1,NCR);  GO TO LX;        01827000
                   END;                                                 01828000
                   IF NOT GENERATE THEN STARTGEN;                       01829000
                   EV[0].[18:6]~3;  EDITING(1,1);                       01830000
                   TRNSFCHR(EV[0],EV[0],3,6,NCR~NCR-3);                 01831000
                   FST~4;  EDITING(2,NCR);                              01832000
         L2:       IF (I~CHECKNEXT(4&","[36:42:6]))=8 THEN GO TO L3;    01833000
                   IF I=2 AND NXT.[36:6]=";" THEN                       01834000
                   BEGIN  I~";";                                        01835000
         L3:         IF NOT SCAN(1) THEN                                01836000
                     IF GENERATE THEN EDITING(1,1);                     01837000
                     IF I=";" THEN I~8 ELSE GO TO L1;                   01838000
                   END;  GO TO LX1;                                     01839000
         LE:  END  FILLSTATEMENT;                                       01840000
REAL PROCEDURE     STRMPROCDUR;                                         01841000
COMMENT ................................................................01842000
:    THIS PROCEDURE PROCESSES A STREAM-PROCEDURE-CALL STATEMENT.       :01843000
:    VALUE OF RESULT:  0 TO 6:  SAME AS INDICATED IN "CHECKNEXT".      :01844000
:                           8:  THE PROCESS IS COMPLETED.              :01845000
:                              --------  J. C. PAO   06/06/68  --------:01846000
:......................................................................;01847000
              BEGIN                                                     01848000
       REAL        I,J,N,B,P,X;                                         01849000
       ARRAY       E[0:8];                                              01850000
       LABEL       L1,L2,L3,L4,L45,L5,L6,L7,LE;                         01851000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"STMCLL",NXT);                    01852000
COMMENT  FROM THE INFO-INDEX OF THE STREAM PROCEDURE IDENTIFIER, IFX,   01853000
         OBTAIN THE FORMAL PARAMETERS INFORMATION.  WHERE               01854000
         N:  ONE PLUS THE NUMBER OF WORDS OF THE ADDITIONAL INFORMATION 01855000
             OF THIS ENTRY IN INFO[*,*], OR                             01856000
             N = 1 + (<NUMBER OF FORMAL PARAMETERS> + 7) DIV 8.         01857000
         X:  ONE MINUS THE INFO-INDEX OF THE ADDITIONAL INFORMATION OF  01858000
             THIS ENTRY IN INFO[*,*];                                   01859000
                   N~(P~INFO[IFX.[35:5],IFX.[40:8]-1]).[4:8]            01860000
                     -(P~P.[40:8]);                                     01861000
                   X~IFX+P-1;  J~7;                                     01862000
                   IF (I~CHECKNEXT(4&"("[36:42:6]))!8 THEN              01863000
         L1:       BEGIN                                                01864000
                     IF DFINE THEN ERRDFN~1 ELSE                        01865000
                     IF I=2 THEN CV[9].[36:6]~ERX~1 ELSE                01866000
                     BEGIN ERROR; CI[9].[36:6]~1 END;                   01867000
                     IF BOOLEAN(I) THEN STRMPROCDUR~I ELSE              01868000
                     IF BOOLEAN(B) THEN                                 01869000
                     IF STRMPROCDUR~BRACKET(")",0)=4 THEN STRMPROCDUR~8 01870000
                     ELSE ELSE STRMPROCDUR~I;  GO TO LE;                01871000
                   END;                                                 01872000
                   B~1;  % B REMINES THE FACT THAT "(" WAS PROCESSED.   01873000
         L2:       IF NOT SCAN(1) THEN                                  01874000
                   IF GENERATE THEN EDITING(1,1);                       01875000
                   STRM~BOOLEAN(2);  I~CHECKNEXT(1);  STRM~FALSE;       01876000
                   IF BOOLEAN(I) THEN GO TO L1;                         01877000
COMMENT  CHECK THIS ACTURAL PARAMETER AND SEE IF IT IS CALLED BY NAME OR01878000
         BY VALUE;                                                      01879000
                   IF (J~J+1)=8 THEN                                    01880000
                   BEGIN  J~0;                                          01881000
                     IF (N~N-1){0 THEN                                  01882000
                     BEGIN  % SHOULD HAVE NO MORE PARAMETER.            01883000
         L3:           IF I!2 THEN                                      01884000
                       IF GENERATE THEN EDITING(1,NCR);  GO TO L1;      01885000
                     END;  P~INFO[(X~X+1).[35:5],X.[40:8]];             01886000
                   END;  TRNSFCHR(B,P,7,J,1);                           01887000
                   IF NOT BOOLEAN(B) THEN BEGIN B~1; GO TO L3 END;      01888000
                   IF B=3 THEN GO TO L4;                                01889000
COMMENT  THIS ACTURAL PARAMETER IS CALLED BY VALUE;                     01890000
                   IF I!2 THEN                                          01891000
                   IF GENERATE THEN EDITING(1,NCR);                     01892000
                   IF BOOLEAN(I~BALABALA(I&","[36:42:6])) THEN GO TO L1;01893000
                   IF I~NXT.[36:6]="," THEN GO TO L2;                   01894000
                   IF I=")" THEN GO TO L7;                              01895000
                   I~2;  GO TO L1;                                      01896000
COMMENT  THIS ACTURAL PARAMETER IS CALLED BY NAME;                      01897000
         L4:       IF DFINE THEN IF LLF}0 THEN GO TO L3 ELSE            01898000
                   BEGIN STR[0,0].[45:1]~1; GO TO L45 END;              01899000
                   IF NOT GENERATE THEN STARTGEN;                       01900000
                   E[0]~EV[0];                                          01901000
                   IF NCR>5 THEN TRNSFWDS(E[1],EV[1],(NCR+2).[36:9]);   01902000
                   EV[0]~"POINT"; EV[1]~0&"ER("[1:31:17];  EDITING(1,8);01903000
                   EV[0]~E[0];                                          01904000
                   IF NCR>5 THEN TRNSFWDS(EV[1],E[1],(NCR+2).[36:9]);   01905000
                   EDITING(1,NCR);                                      01906000
         L45:      IF I=4 THEN                                          01907000
                   IF (I~SUBSCRIPT)!8 THEN                              01908000
                   BEGIN                                                01909000
                     IF I=2 THEN                                        01910000
                     IF NXT.[36:6]="," THEN GO TO L5 ELSE               01911000
                     IF NXT.[36:6]=")" THEN GO TO L6;                   01912000
                   END ELSE                                             01913000
                   IF (I~CHECKNEXT(4&","[36:42:6]))=8 THEN              01914000
         L5:       BEGIN  CC0~CC; NC0~NCD;                              01915000
                     IF DFINE THEN IF LLF}0 THEN GO TO L3 ELSE          01916000
                     BEGIN STR[0,0].[44:1]~1; GO TO L2 END;             01917000
                     IF NOT GENERATE THEN STARTGEN;                     01918000
                     EV[0]~0&")"[18:42:6];  FST~4;  EDITING(1,1);       01919000
                     GO TO L2;                                          01920000
                   END ELSE                                             01921000
                   IF I=2 AND NXT.[36:6]=")" THEN                       01922000
         L6:       BEGIN  CC0~CC; NC0~NCD;                              01923000
                     IF DFINE THEN IF LLF}0 THEN GO TO L3 ELSE          01924000
                     BEGIN STR[0,0].[44:1]~1; GO TO L7 END;             01925000
                     IF NOT GENERATE THEN STARTGEN;                     01926000
                     EV[0]~0&")"[18:42:6];  FST~4;  EDITING(1,1);       01927000
         L7:         IF NOT SCAN(1) THEN                                01928000
                     IF GENERATE THEN EDITING(1,1);                     01929000
                     STRMPROCDUR~8;  GO TO LE;                          01930000
                   END;                                                 01931000
                   ERROR;  CI[9].[36:6]~1;                              01932000
                   IF BOOLEAN(I) THEN GO TO L1;                         01933000
                   IF BOOLEAN(I~BALABALA(I&","[36:42:6])) THEN GO TO L1;01934000
                   IF I~NXT.[36:6]="," THEN GO TO L5;                   01935000
                   IF I=")" THEN GO TO L6;                              01936000
                   I~2;  GO TO L1;                                      01937000
         LE:  END  STRMPROCDUR;                                         01938000
REAL PROCEDURE     BALABALA(I);                                         01939000
COMMENT ................................................................01940000
:    THIS PROCEDURE PROCESSES A STRING OF ALGOL LANGUAGE UNTIL THE     :01941000
:NEXT IS A "]", ")","BEGIN","END" OR SEMICOLUMN.                       :01942000
:    VALUE OF RESULT:  0:  STOPPED AT A "]",")" OR SEMICOLUMN.         :01943000
:                      1:  STOPPED AT END-OF-FILE.                     :01944000
:                      3:  STOPPED AT "BEGIN".                         :01945000
:                      5:  STOPPED AT "END".                           :01946000
:                              --------  J. C. PAO   04/22/68  --------:01947000
:......................................................................;01948000
     VALUE         I;                                                   01949000
     REAL          I;                                                   01950000
              BEGIN                                                     01951000
       REAL        STOP;                                                01952000
       LABEL       L1,L2,L3,LE;                                         01953000
       LABEL       N1;                                                  01954000
       LABEL       C1,C2;                                               01955000
       LABEL       W1,W2;                                               01956000
       LABEL       WS1,WS2;                                             01957000
       LABEL       WP1,WP2,WP3;                                         01958000
       LABEL       WC1,WC2;                                             01959000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"BALABA",NXT,I);                  01960000
                   IF (STOP~I.[36:6])!0 THEN I~I.[42:6];                01961000
                   IF I=4 THEN GO TO WS1 ELSE  % START TO PICK SUBSCRPT.01962000
                   IF I=6 THEN GO TO WP1 ELSE  % START TO PICK PARTIAL. 01963000
                   IF I=10 THEN GO TO WS2;     % START TO PROCS STRM PR.01964000
COMMENT  THIS IS THE END-OF-FILE;                                       01965000
         L1:       IF EOF THEN                                          01966000
         L2:       BEGIN BALABALA~1; GO TO LE END;                      01967000
                   IF I=0 THEN                                          01968000
                   IF IFX=DFX+31 THEN                                   01969000
                   BEGIN I~FILLSTATEMENT; GO TO WP3 END;                01970000
COMMENT  THE NEXT CHARACTER IS A DIGIT;                                 01971000
         L3:       IF I~NXT.[42:6]=0 THEN                               01972000
         N1:       BEGIN NUMBER; GO TO WC1 END;                         01973000
COMMENT  THE NEXT CHARACTER IS A SPECIAL CHARACTER;                     01974000
                   IF I=2 THEN GO TO W1;                                01975000
         C1:       IF I~NXT.[36:6]=";" THEN GO TO LE;                   01976000
                   IF I=")" THEN GO TO LE;                              01977000
                   IF I="]" THEN GO TO LE;                              01978000
                   IF I=STOP THEN GO TO LE;                             01979000
                   IF I="%" THEN BEGIN PERCENT; GO TO L1 END;           01980000
                   IF I=""" THEN BEGIN STRING; GO TO WP1 END;           01981000
                   IF I="(" THEN                                        01982000
                   GO TO IF BOOLEAN(I~BRACKET(")",1)) THEN W2 ELSE      01983000
                         IF I=4 THEN WP1 ELSE L3;                       01984000
                   IF I="[" THEN                                        01985000
                   GO TO IF BOOLEAN(I~BRACKET("]",1)) THEN W2 ELSE L3;  01986000
                   IF I="#" THEN                                        01987000
                   IF DFINE THEN BEGIN DFINEOUT; GO TO L1 END ELSE      01988000
                   GO TO C2;                                            01989000
                   IF I="." THEN GO TO N1;  % MUST BE A DECIMAL POINT.  01990000
                   IF I="@" THEN GO TO N1;  % EXPONENT.                 01991000
                   IF I="&" THEN                                        01992000
         C2:       BEGIN  % POSSIBLE ERROR.                             01993000
                     IF DFINE THEN ERRDFN~1 ELSE CV[9].[36:6]~ERX~1;    01994000
                   END;                                                 01995000
                   IF NOT SCAN(1) THEN                                  01996000
                   IF GENERATE THEN EDITING(1,1);  GO TO L1;            01997000
COMMENT  THE NEXT CHARACTER IS A LETTER;                                01998000
         W1:       IF BOOLEAN(I~CHECKNEXT(1)) THEN  % FORCE TO SCAN.    01999000
         W2:       BEGIN BALABALA~I; GO TO LE END;                      02000000
                   IF I=0 THEN GO TO L1;                                02001000
                   IF I=2 THEN GO TO L3;                                02002000
COMMENT  PICK UP THE SUBSCRIPTION IF THERE IS ANY;                      02003000
                   IF I=4 THEN  % THIS ID MAY BE FOLLOWED BY [ ].       02004000
         WS1:      GO TO IF (I~SUBSCRIPT)=8 THEN WP1 ELSE WP3;          02005000
COMMENT  THIS IS A STREAM PROCEDURE CALL STATEMENT;                     02006000
                   IF I=10 THEN                                         02007000
         WS2:      GO TO IF (I~STRMPROCDUR)=8 THEN WP1 ELSE WP3;        02008000
COMMENT  PICK UP THE PARTIAL-FIELD IF THERE IS ONE;                     02009000
         WP1:      IF EOF THEN GO TO L2;                                02010000
                   IF I~NXT.[42:6]=0 THEN GO TO N1;                     02011000
                   IF I=4 THEN                                          02012000
                   IF I~NXT.[36:6]="." THEN GO TO WP2 ELSE              02013000
                   IF I="&" THEN GO TO WC2;                             02014000
                   IF (I~CHECKNEXT(4&"."[36:42:6]))=8 THEN              02015000
         WP2:      BEGIN  % THE NEXT IS A ".".                          02016000
                     IF NOT SCAN(1) THEN                                02017000
                     IF GENERATE THEN EDITING(1,1);                     02018000
                     IF (I~PARTIAL(1))=8 THEN GO TO WC1;                02019000
                   END ELSE                                             02020000
                   IF I=2 THEN                                          02021000
                   IF NXT.[36:6]="&" THEN GO TO WC2;                    02022000
         WP3:      GO TO IF BOOLEAN(I) THEN W2 ELSE IF I=4 THEN WS1 ELSE02023000
                         IF I=6 THEN WP1 ELSE L1;                       02024000
COMMENT  PICK UP THE CONCATENATE-FIELD IF THERE ARE ANY;                02025000
         WC1:      IF EOF THEN GO TO W2;                                02026000
                   IF NXT.[36:6]="&" THEN GO TO WC2;                    02027000
                   IF NXT.[42:6]=0 THEN GO TO N1;                       02028000
                   IF (I~CHECKNEXT(4&"&"[36:42:6]))=8 THEN              02029000
         WC2:      BEGIN                                                02030000
                     IF NOT SCAN(1) THEN                                02031000
                     IF GENERATE THEN EDITING(1,1);                     02032000
                     IF (I~CONCATENATE)=8 THEN GO TO WC1;               02033000
                   END;                                                 02034000
                   GO TO WP3;                                           02035000
         LE:  END  BALABALA;                                            02036000
REAL PROCEDURE     STATEMENT;                                           02037000
COMMENT ................................................................02038000
:    THIS PROCEDURE PROCESSES THE ALGOL LANGUAGE AND STOPS AFTER A     :02039000
: SEMICOLUMN.                                                          :02040000
:    VALUE OF RESULT:  0:  STOPPED AFTER A SEMICOLUMN.                 :02041000
:                      1:  STOPPED AT END-OF-FILE.                     :02042000
:                      3:  STOPPED AT "BEGIN".                         :02043000
:                      5:  STOPPED AT "END".                           :02044000
:                              --------  J. C. PAO   05/01/68  --------:02045000
:......................................................................;02046000
              BEGIN                                                     02047000
     REAL          I;                                                   02048000
       LABEL       L1,L2,LE;                                            02049000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"STATEM",NXT);                    02050000
                   IF NXT.[36:6]=";" THEN GO TO L2;                     02051000
         L1:       IF BOOLEAN(I~BALABALA(0)) THEN                       02052000
                   BEGIN STATEMENT~I; GO TO LE END;                     02053000
                   IF NXT.[36:6]!";" THEN                               02054000
                   BEGIN                                                02055000
                     IF DFINE THEN ERRDFN~1 ELSE CV[9].[36:6]~ERX~1;    02056000
                     IF NOT SCAN(1) THEN                                02057000
                     IF GENERATE THEN EDITING(1,1);  GO TO L1;          02058000
                   END;                                                 02059000
         L2:       IF NOT SCAN(1) THEN                                  02060000
                   IF GENERATE THEN EDITING(1,1);                       02061000
         LE:  END  STATEMENT;                                           02062000
BOOLEAN PROCEDURE  SKIPUNTIL(CH);                                       02063000
COMMENT ................................................................02064000
:    THIS PROCEDURE SKIPS UNTIL THE GIVEN SPECIAL CHARACTER "CH".      :02065000
:    VALUE OF RESULT:  TRUE:  "CH" NOT FOUND.                          :02066000
:                             1:  END-OF-FILE.                         :02067000
:                             3:  "BEGIN".                             :02068000
:                             5:  "END".                               :02069000
:                              --------  J. C. PAO   04/25/68  --------:02070000
:......................................................................;02071000
     VALUE         CH;                                                  02072000
     REAL          CH;                                                  02073000
              BEGIN                                                     02074000
       REAL        I;                                                   02075000
       LABEL       L1,LE;                                               02076000
         L1:       IF (I~CHECKNEXT(4&CH[36:42:6]))=8 THEN GO TO LE;     02077000
                   IF BOOLEAN(I) THEN                                   02078000
                   BEGIN SKIPUNTIL~BOOLEAN(I); GO TO LE END;            02079000
                   IF I!2 THEN GO TO L1;                                02080000
                   IF NXT.[36:6]=""" THEN BEGIN STRING; GO TO L1 END;   02081000
                   IF NOT SCAN(IF NXT.[42:6]=4 THEN 1 ELSE 0) THEN      02082000
                   IF GENERATE THEN EDITING(1,NCR);  GO TO L1;          02083000
         LE:  END  SKIPUNTIL;                                           02084000
PROCEDURE          BUILDEFINE;                                          02085000
COMMENT ................................................................02086000
:    THIS PROCEDURE ENTERS A FIRST LEVEL DEFINE DECLARATION INTO THE   :02087000
:INFO[*,*] AS WELL AS DFSK-FILE.  INSIDE THE DEFINE BODY, EACH "[" WILL:02088000
:START WITH A NEW RECORD AND THE 9TH WORD, BIT[44:1] INDICATES THIS "[":02089000
:IS QUESTIONABLE TO BE USED AS A PATIAL-FIELD OR CONCATENATE-FIELD.    :02090000
:THE BIT INDEX WILL BE CHANGED INTO 47 MINUS THAT INDEX IF THE NEXT IS :02091000
: A ":".                                                               :02092000
:                              --------  J. C. PAO   04/27/68  --------:02093000
:......................................................................;02094000
              BEGIN                                                     02095000
       OWN INTEGER IC;       % CURRENT ADDRESS OF DCI[*].               02096000
       OWN INTEGER BB;       % NO. OF BLANKS PRECEEDING BUILDING DEFINE.02097000
       OWN INTEGER LST;      % THE CHR-CODE OF THE LAST CHR EDITED.     02098000
       OWN INTEGER AVC;      % NO. OF AVAILABLE CHRS IN DCI[*].         02099000
STREAM PROCEDURE   DFER(F,E);                                           02100000
              BEGIN                                                     02101000
       LOCAL       NC;                                                  02102000
                   DI~F;  DS~28 LIT"XXXXXXXX  DEFINES FOLLOWING ";      02103000
                   DS~LIT""";  F~DI;  DS~11 LIT"    "; SI~F; DS~9 WDS;  02104000
                   DS~8 LIT"XXXX";                                      02105000
                   SI~E; SI~SI+2;  DI~LOC NC; DI~DI+7; DS~CHR;          02106000
                   DI~F; DS~NC CHR; DS~LIT"""; DS~13 LIT" ARE IGNORED.";02107000
              END  DFER;                                                02108000
PROCEDURE          EDIT(OP,NC);                                         02109000
COMMENT ................................................................02110000
:  THIS PROCEDURE EDITS THE 1ST LEVEL FEFINE DECLARATION INTO DCI[*].  :02111000
:THIS IS SO CALLED "BUILD THE FEFINE".  "OP" INDICATES THE TYPE OF     :02112000
:EDITING OPERATIONS:                                                   :02113000
:  OP=0: SET "NC" NUMBER OF BLANKS.                                    :02114000
:  OP=1: TRANSFER "NC" NUMBER OF CHARACTERS.                           :02115000
:  OP=2: MAKE A STRING WHICH HAS "NC" NUMBER OF CHARACTERS EXCLUDING   :02116000
:        BOTH QUOTATIONS.                                              :02117000
:                              --------  J. C. PAO   04/28/68  --------:02118000
:......................................................................;02119000
     VALUE         OP,NC;                                               02120000
     REAL          OP,NC;                                               02121000
              BEGIN                                                     02122000
STREAM PROCEDURE   EDT(T,F,LST,OP,NC);                                  02123000
     VALUE         F,OP,NC;                                             02124000
              BEGIN                                                     02125000
       LOCAL       I;                                                   02126000
       LABEL       L1;                                                  02127000
                   SI~T; DI~LOC I; DS~WDS; DI~I;                        02128000
                   SI~LOC OP; SKIP SB;                                  02129000
                   IF SB THEN DS~LIT" ";  SI~SI+6;                      02130000
                   IF SC="1" THEN                                       02131000
                   BEGIN  % TRANSFER CHARACTERS.                        02132000
                     SI~F; DS~NC CHR; NC~DI;                            02133000
                     DI~LST; DS~7 LIT"0000";                            02134000
                     SI~NC; SI~SI-1;                                    02135000
                     IF SC>"9" THEN DS~LIT"4" ELSE                      02136000
                     IF SC}"0" THEN DS~LIT"0" ELSE                      02137000
                     IF SC=ALPHA THEN DS~LIT"2" ELSE DS~LIT"4";         02138000
                   END ELSE                                             02139000
                   IF SC="0" THEN                                       02140000
                   BEGIN  % SET BLANKS.                                 02141000
                     NC(DS~LIT" ");  SI~LOC NC; SI~SI+6;                02142000
                     IF SC!"0" THEN                                     02143000
                     BEGIN  I~DI;  DI~LOC F; DI~DI+7; DS~CHR;           02144000
                       DI~I;  F(2(DS~32 LIT"    "));                    02145000
                     END;  GO TO L1;                                    02146000
                   END ELSE                                             02147000
                   BEGIN  % TRANSFER A STRING.                          02148000
                     DS~LIT"""; SI~F; DS~NC CHR; DS~LIT""";             02149000
         L1:         NC~DI;  DI~LST; DS~7 LIT"0000"; DS~LIT"4";         02150000
                   END;                                                 02151000
                   SI~LOC NC; DI~T; DS~WDS;                             02152000
              END  EDT;                                                 02153000
       REAL        A;                                                   02154000
       BOOLEAN     B;                                                   02155000
       LABEL       LE;                                                  02156000
IF DEBUGN=3 THEN                                                        02157000
BEGIN WRITE(FOU,DBG,"**EDIT");                                          02158000
      DUMPARRAY(DCI,0,11,FOU,1,"DCI[*]",DST);                           02159000
      DUMPARRAY(EV,0,18,FOU,1,"EV[*]:",EST);                            02160000
      WRITE(FOU,DBG,OP,NC,AVC,BB,LST,FST,IC);                           02161000
END;                                                                    02162000
                   IF NC=0 THEN                                         02163000
                   IF OP!0 THEN GO TO LE;                               02164000
                   IF AVC<(A~IF OP=0 THEN NC ELSE                       02165000
                   (IF OP=2 THEN NC+2 ELSE NC)+REAL(B~LST!4 AND FST!4)) 02166000
                   THEN                                                 02167000
                   BEGIN  % ITEM CAN NOT BE HELD ON THIS CARD.          02168000
                     IF AVC>0 THEN EDT(IC,0,LST,0,AVC);                 02169000
                     IF AVC}0 THEN WRITE(DFSK[DX~DX+1],12,DCI[*]);      02170000
                     IC~DST;  % RESTART WITH A NEW CARD IMAGE.          02171000
                     IF BB=0 THEN AVC~72 ELSE                           02172000
                     IF BB+NC{72 THEN                                   02173000
                     BEGIN  EDT(IC,0,LST,0,BB);  AVC~72-BB;             02174000
                       IF B THEN                                        02175000
                       BEGIN B~FALSE; A~IF OP=2 THEN NC+2 ELSE NC END;  02176000
                     END ELSE AVC~72;  DCI[9]~INV&5[42:42:6];           02177000
                   END;                                                 02178000
                   IF BOOLEAN(EV[0].[1:1]) THEN DCI[9].[36:6]~1;        02179000
                   IF A!0 THEN EDT(IC,EST,LST,IF B THEN -OP ELSE OP,NC);02180000
                   IF (AVC~AVC-A)=0 THEN                                02181000
                   IF OP=0 THEN                                         02182000
                   BEGIN  % END OF THE CARD, GO TO CB[*,*].             02183000
                     WRITE(DFSK[DX~DX+1],12,DCI[*]);                    02184000
                     DCI[9]~INV&5[42:42:6];  AVC~-1;                    02185000
                   END;                                                 02186000
IF DEBUGN=3 THEN                                                        02187000
BEGIN                                                                   02188000
     DUMPARRAY(DCI,0,11,FOU,1,"DCI[*]",DST);                            02189000
      DUMPARRAY(CI,0,11,FOU,1,"CI[*]:",IST);                            02190000
      WRITE(FOU,DBG,OP,NC,AVC,BB,LST,FST,IC);                           02191000
      WRITE(FOU,DBG,"~~EDIT");                                          02192000
END;                                                                    02193000
         LE:  END  EDIT;                                                02194000
REAL PROCEDURE     CHECKNXT(NEXT);                                      02195000
COMMENT ................................................................02196000
:    THIS PROCEDURE CHECKS THE "NXT" AGAINST THE GIVEN "NEXT".         :02197000
:    VALUE OF RESULT:                                                  :02198000
:      0: NOT MATCH:  NOTHING ELSE SCANNED. "NXT" IS A CHR OR DIGIT.   :02199000
:      1: END-OF-FILE.                                                 :02200000
:      2: NOT MATCH:  THE "NXT" IS SCANNED.                            :02201000
:      4: NOT MATCH:  THE "NXT" IS PROCESSED.  (SCANNING ERROR)        :02202000
:      6: MATCHES.                                                     :02203000
:                              --------  J. C. PAO   04/26/68  --------:02204000
:......................................................................;02205000
     VALUE         NEXT;                                                02206000
     REAL          NEXT;                                                02207000
              BEGIN                                                     02208000
       LABEL       L1,L2,LE;                                            02209000
         L1:       IF EOF THEN BEGIN CHECKNXT~1; GO TO LE END;          02210000
                   IF NXT=NEXT THEN BEGIN CHECKNXT~6; GO TO LE END;     02211000
                   IF NXT.[36:6]="%" THEN                               02212000
                   BEGIN PERCENT; GO TO L1 END;                         02213000
                   IF NXT.[42:6]!2 THEN GO TO LE;                       02214000
COMMENT  CHECK THE "NXT" MAY BE A COMMENT;                              02215000
                   IF SCAN(5) THEN BEGIN CHECKNXT~4; GO TO LE END;      02216000
                   IF NCR!7 THEN GO TO L2;                              02217000
                   IF EV[0].[18:30]!"COMME" THEN GO TO L2;              02218000
                   EV[2]~"NT";                                          02219000
                   IF COMPAREA(EV[1],EV[2],0,6,2)!0 THEN                02220000
         L2:       BEGIN CHECKNXT~2; GO TO LE END;                      02221000
                   COMMNT;  GO TO L1;  % IT IS COMMENT, RE-CHECK.       02222000
LE:IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"CHNXTD",NXT,NEXT) END; COMMENT02223000
         LE:  END  CHECKNXT;                                            02224000
PROCEDURE          SKIPDEFINE;                                          02225000
COMMENT ................................................................02226000
:    THIS PROCEDURE SKIPS UNTIL AFTER A "#".  THE COMMENTS, STRINGS,   :02227000
:DEFINES AND "%"S ARE RECOGNIZED.                                      :02228000
:                              --------  J. C. PAO   04/25/68  --------:02229000
:......................................................................;02230000
              BEGIN                                                     02231000
       REAL        I,UNTL;                                              02232000
       LABEL       L1,L2,LE;                                            02233000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"SKIPDF",NXT);                    02234000
                   UNTL~4&"#"[36:42:6];                                 02235000
         L1:       IF (I~CHECKNXT(UNTL))=6 THEN                         02236000
                   BEGIN  % END OF THE DEFINE.                          02237000
                     IF NOT SCAN(1) THEN                                02238000
                     IF GENERATE THEN EDITING(1,1);                     02239000
                     GO TO LE;                                          02240000
                   END;                                                 02241000
                   IF I=4 THEN GO TO L1;                                02242000
                   IF BOOLEAN(I) THEN GO TO LE;                         02243000
                   IF I=0 THEN                                          02244000
                   IF NXT.[36:6]=""" THEN                               02245000
                   BEGIN STRING; GO TO L1 END ELSE                      02246000
                   IF SCAN(IF NXT.[42:6]=4 THEN 1 ELSE 0) THEN GO TO L1;02247000
COMMENT  CHECK IF THERE IS ANY DEFINE INSIDE THIS DEFINE;               02248000
                   IF NCR=6 THEN                                        02249000
                   IF EV[0].[18:30]="DEFIN" THEN                        02250000
                   BEGIN  EV[2]~"E";                                    02251000
                     IF COMPAREA(EV[1],EV[2],0,7,1)=0 THEN              02252000
                     BEGIN                                              02253000
                       IF GENERATE THEN EDITING(1,6);                   02254000
         L2:           SKIPDEFINE;                                      02255000
                       IF (I~CHECKNXT(4&";"[36:42:6]))=6 THEN           02256000
                       BEGIN                                            02257000
                         IF NOT SCAN(1) THEN                            02258000
                         IF GENERATE THEN EDITING(1,1);  GO TO L1;      02259000
                       END;                                             02260000
                       IF BOOLEAN(I) THEN GO TO LE;                     02261000
                       IF I=4 THEN GO TO L2;                            02262000
                       IF I=0 THEN                                      02263000
                       IF SCAN(IF NXT.[42:6]=4 THEN 1 ELSE 0) THEN      02264000
                       GO TO L2;                                        02265000
                       IF GENERATE THEN EDITING(1,NCR);                 02266000
                       GO TO L2;                                        02267000
                     END;                                               02268000
                   END;                                                 02269000
                   IF GENERATE THEN EDITING(1,NCR);  GO TO L1;          02270000
         LE:  END  SKIPDEFINE;                                          02271000
REAL PROCEDURE     CHGDFN47;                                            02272000
COMMENT ................................................................02273000
:    THIS PROCEDURE CHANGES THE VALUE INSIDE A PARTIAL-FIELD OR A      :02274000
:CONCATENATE-FIELD INTO 47 MINUS THAT VALUE.  THIS CHGE IS MADE, IF AND:02275000
:ONLY IF THE NEXT IS A ":".  **** ONLY BE CALLED WHEN DFINE=FALSE **** :02276000
:    VALUE OF RESULT:                                                  :02277000
:      0: NOT CHANGED AND NOTHING PROCESSED.                           :02278000
:      1: ERROR CAUSES THE ENTIRE DEFINE IGNORED.                      :02279000
:      2: NOT CHANGED BUT SOMETHING PROCESSED.                         :02280000
:      4: NOT CHANGED BUT MORE THAN ONE ITEM PROCESSED.                :02281000
:      6: CHANGED.                                                     :02282000
:                              --------  J. C. PAO   04/25/68  --------:02283000
:......................................................................;02284000
              BEGIN                                                     02285000
       REAL        I,J,K;                                               02286000
       LABEL       L1,L2,L3,L4,LE;                                      02287000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"CHNG47",NXT);                    02288000
COMMENT  SCAN FOR THE ITEM SUPPOSEDLY TO BE CHANGED AND SEE WHAT IT IS; 02289000
                   IF BOOLEAN(I~CHECKNXT(1)) THEN                       02290000
         L1:       BEGIN CHGDFN47~1; GO TO LE END;                      02291000
                   IF I=4 THEN GO TO L1;                                02292000
                   IF I=0 THEN                                          02293000
                   BEGIN                                                02294000
                     IF NXT.[42:6]=4 THEN GO TO LE ELSE                 02295000
                     IF SCAN(0) THEN GO TO L1;                          02296000
                   END ELSE                                             02297000
                   % HERE I=2: IT WAS A WORD JUST SCANNED.              02298000
                   IF NCR=6 THEN                                        02299000
                   IF EV[0].[18:30]="DEFIN" THEN                        02300000
                   BEGIN  EV[2]~"E";                                    02301000
                     IF COMPAREA(EV[1],EV[2],0,7,1)=0 THEN              02302000
                     BEGIN                                              02303000
                       IF GENERATE THEN EDITING(1,NCR);  GO TO L1;      02304000
                     END;                                               02305000
                   END;                                                 02306000
COMMENT  CHECK THE NEXT ITEM, CHANGE WILL BE MADE IF IT IS A ":";       02307000
                   IF NXT.[42:6]=0 THEN                                 02308000
         L2:       BEGIN  CHGDFN47~2;                                   02309000
         L3:         EDIT(1,NCR);                                       02310000
                     IF GENERATE THEN EDITING(1,NCR);                   02311000
                     GO TO LE;                                          02312000
                   END;                                                 02313000
                   IF NXT.[42:6]=4 THEN                                 02314000
                   IF NXT.[36:6]=":" THEN GO TO L4 ELSE                 02315000
                   IF NXT.[36:6]!"%" THEN GO TO L2;                     02316000
COMMENT  THE NEXT ITEM IS NOT ":", BUT THE ":" MAY COME AFTER "%"S OR   02317000
         COMMENTS.  AT THIS POINT START THE GENERATING PROCESS ANYWAY.  02318000
         NOTE: THE "%"S OR COMMENTS WILL BE MOVED INTO THE FRONT OF THE 02319000
         ITEM TO BE CHANGED, REGARDLESS THE CHANGE IS MADE OR NOT;      02320000
                   IF NOT GENERATE THEN STARTGEN;                       02321000
                   TRNSFCHR(A[0],EV[0],0,3,J~NCR);                      02322000
                   IF (K~CHECKNXT(4&":"[36:42:6]))=6 THEN               02323000
                   BEGIN TRNSFCHR(EV[0],A[0],3,0,NCR~J); GO TO L4 END;  02324000
                   IF BOOLEAN(K) THEN GO TO L1;                         02325000
                   IF K=4 THEN  % 2 ITEMS SWITCHED, IT IS BAD ANY WAY.  02326000
                   BEGIN  TRNSFCHR(EV[0],A[0],3,0,J);                   02327000
                     IF NOT GENERATE THEN STARTGEN;  EDITING(1,J);      02328000
                     GO TO L1;                                          02329000
                   END;                                                 02330000
                   IF K=0 THEN                                          02331000
                   BEGIN TRNSFCHR(EV[0],A[0],3,0,NCR~J); GO TO L2 END;  02332000
                   TRNSFCHR(B[0],EV[0],0,3,NCR);                        02333000
                   TRNSFCHR(EV[0],A[0],3,0,J);                          02334000
                   EDIT(1,J);                                           02335000
                   IF NOT GENERATE THEN STARTGEN;  EDITING(1,J);        02336000
                   TRNSFCHR(EV[0],B[0],3,0,NCR);                        02337000
                   CHGDFN47~4;  GO TO L3;                               02338000
         L4:       EDIT(1,NCR);                                         02339000
                   IF I=2 THEN                                          02340000
                   BEGIN  I~EV[0];  EV[0]~0&"47-"[18:30:18];            02341000
                     IF NOT GENERATE THEN STARTGEN;                     02342000
                     EDITING(1,3);  EV[0]~I;  EDITING(1,NCR);           02343000
                   END ELSE FOURTY7(0);                                 02344000
                   IF SCAN(1) THEN GO TO L1;                            02345000
                   EDIT(1,1);                                           02346000
                   IF GENERATE THEN EDITING(1,1);                       02347000
                   CHGDFN47~6;                                          02348000
         LE:  END  CHGDFN47;                                            02349000
BOOLEAN PROCEDURE  BRCKT;                                               02350000
COMMENT ................................................................02351000
:    THIS PROCEDURE CHECKS THE DEFINE-STRING STARTING WITH A "[".  IF  :02352000
:THE "[" IS A PARTIAL-FIELD OR CONCATENATE-FIELD, DCI[9].[44:1]~1.     :02353000
:    VALUE OF RESULT:  TRUE: ERRORS CAUSE THE DEFINE BE IGNORED.       :02354000
:                              --------  J. C. PAO   04/25/68  --------:02355000
:......................................................................;02356000
              BEGIN                                                     02357000
       REAL        I,D,BST;                                             02358000
       LABEL       L1,L3,L34,L4,L5,LE;                                  02359000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"BRCKDF",NXT);                    02360000
                   IF AVC}0 THEN EDIT(0,AVC);  % STARTS A NEW CARD AT [.02361000
                   IF DFINE THEN DCI[9].[36:9]~CV[9].[36:9] ELSE        02362000
                   BST~DX+1;                                            02363000
                   IF SCAN(1) THEN                                      02364000
         L1:       BEGIN BRCKT~TRUE; GO TO LE END;                      02365000
                   EDIT(1,1);                                           02366000
                   IF GENERATE THEN EDITING(1,1);                       02367000
                   IF DFINE THEN GO TO LE;                              02368000
                   IF (I~CHGDFN47)=6 THEN D~1 ELSE                      02369000
                   GO TO IF BOOLEAN(I) THEN L1 ELSE LE;                 02370000
         L3:       IF BOOLEAN(I~CHGDFN47) THEN GO TO L1;                02371000
                   IF I=6 THEN                                          02372000
                   IF (D~D+1){2 THEN GO TO L3 ELSE                      02373000
         L34:      BEGIN  % FLAG THE ERROR.                             02374000
                     ERROR; CI[9].[36:6]~1;  D~D&1[39:42:6]; GO TO L5;  02375000
                   END;                                                 02376000
                   IF I=2 THEN                                          02377000
                   BEGIN                                                02378000
                     IF EOF THEN GO TO L1;                              02379000
                     IF NXT.[36:6]="]" THEN                             02380000
         L4:         BEGIN                                              02381000
                       IF SCAN(1) THEN GO TO L1;                        02382000
                       EDIT(1,1);                                       02383000
                       IF GENERATE THEN EDITING(1,1);                   02384000
         L5:           IF BST>DX THEN DCI[9].[36:9]~D ELSE              02385000
                       BEGIN  READ(DFSK[BST],12,A[*]);                  02386000
                         A[9].[36:9]~D;  WRITE(DFSK[BST],12,A[*]);      02387000
                       END;  GO TO LE;                                  02388000
                     END;                                               02389000
                     IF NXT.[42:6]=0 THEN GO TO L34;                    02390000
                     IF (I~CHECKNEXT(4&"]"[36:42:6]))=6 THEN GO TO L4;  02391000
                     IF I=4 THEN GO TO L1;                              02392000
                     IF BOOLEAN(I) THEN GO TO L1;                       02393000
                     IF I=2 THEN                                        02394000
                     BEGIN  EDIT(1,NCR);                                02395000
                       IF GENERATE THEN EDITING(1,NCR);                 02396000
                     END;  GO TO L34;                                   02397000
                   END ELSE GO TO L34;                                  02398000
         LE:  END  BRCKT;                                               02399000
BOOLEAN PROCEDURE  DFNBODY;                                             02400000
COMMENT ................................................................02401000
:    THIS PROCEDURE BUILD THE BODY OF A DEFINE IN TO DFSK-FILE.  IF IT :02402000
:IS NOT DURING THE EXECUTION OF A DEFINE THE PARTIAL-FIELD AND THE     :02403000
:CONCATENATE-FIELD WILL BE CHANGED.                                    :02404000
:    VALUE OF RESULT:  TRUE: ERROR CAUSES THE ENTIRE DEFINE IGNORED.   :02405000
:                              --------  J. C. PAO   04/25/68  --------:02406000
:......................................................................;02407000
              BEGIN                                                     02408000
       REAL        I,J;                                                 02409000
       LABEL       L1,L2,L3,L34,L4,LE;                                  02410000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"DFBODY",NXT);                    02411000
         L1:       IF EOF THEN GO TO L3;                                02412000
                   IF (I~NXT.[42:6])=4 THEN                             02413000
                   BEGIN                                                02414000
                     IF J~NXT.[36:6]="[" THEN                           02415000
                     GO TO IF BRCKT THEN L2 ELSE L1;                    02416000
                     IF J=""" THEN                                      02417000
                     BEGIN STRING; EDIT(2,NCR); GO TO L1 END;           02418000
                     IF J="%" THEN                                      02419000
                     BEGIN PERCENT; GO TO L1 END;                       02420000
                   END;                                                 02421000
                   IF SCAN(IF I=2 THEN 5 ELSE IF I=4 THEN 1 ELSE 0) THEN02422000
         L2:       BEGIN  SKIPDEFINE;                                   02423000
         L3:         DFNBODY~TRUE;  GO TO LE;                           02424000
                   END;                                                 02425000
                   IF I=2 THEN                                          02426000
                   IF NCR=7 THEN                                        02427000
                   IF EV[0].[18:30]="COMME" THEN                        02428000
                   BEGIN  EV[2]~"NT";                                   02429000
                     IF COMPAREA(EV[1],EV[2],0,6,2)=0 THEN              02430000
                     BEGIN COMMNT; GO TO L1 END;                        02431000
                   END;                                                 02432000
                   EDIT(1,NCR);                                         02433000
                   IF GENERATE THEN EDITING(1,NCR);                     02434000
                   IF I=4 THEN                                          02435000
                   IF J="#" THEN GO TO LE ELSE                          02436000
                   IF J=":" THEN                                        02437000
                   BEGIN ERROR; DCI[9].[36:6]~1; CI[9].[36:6]~1 END;    02438000
                   IF I!2 THEN GO TO L1;                                02439000
                   IF NCR!6 THEN GO TO L1;                              02440000
                   IF EV[0].[18:30]!"DEFIN" THEN GO TO L1;              02441000
                   EV[2]~"E";                                           02442000
                   IF COMPAREA(EV[1],EV[2],0,7,1)!0 THEN GO TO L1;      02443000
COMMENT  PROCESSES THE DEFINES INSIDE THIS DEFINE;                      02444000
         L34:      IF BOOLEAN(I~CHECKNXT(1)) THEN GO TO L3;             02445000
                   IF I!2 THEN  % DEFINE ID DOESNT START WITH A LETTER. 02446000
         L4:       BEGIN  SKIPDEFINE;                                   02447000
                     GO TO IF EOF THEN L3 ELSE                          02448000
                     IF NXT.[36:6]=";" THEN L2 ELSE                     02449000
                     IF I~CHECKNXT(4&";"[36:42:6])=6 THEN L2 ELSE L4;   02450000
                   END;                                                 02451000
                   EDIT(1,NCR);                                         02452000
                   IF GENERATE THEN EDITING(1,NCR);                     02453000
                   IF EOF THEN GO TO L3;                                02454000
                   IF NXT.[36:6]!"=" THEN                               02455000
                   BEGIN                                                02456000
                     IF (I~CHECKNXT(4&"="[36:42:6]))=0 THEN             02457000
                     IF NXT.[36:6]="(" THEN                             02458000
                     BEGIN                                              02459000
                       IF DFINE THEN ERRDFN~1 ELSE CV[9].[36:6]~ERX~1;  02460000
                       LFX~NFX;  I~BRACKET(")",1);  LFX~1;              02461000
                       IF I=4 THEN                                      02462000
                       BEGIN  EV[0]~-0&"()"[18:36:12]; EDIT(1,2);       02463000
                         IF EOF THEN GO TO L3;                          02464000
                         I~IF NXT.[36:6]="=" THEN 6 ELSE                02465000
                         CHECKNXT(4&"="[36:42:6]);                      02466000
                       END;                                             02467000
                     END;                                               02468000
                     IF BOOLEAN(I) THEN GO TO L3;                       02469000
                     IF I=2 THEN                                        02470000
                     BEGIN                                              02471000
                       IF GENERATE THEN EDITING(1,NCR);  GO TO L4;      02472000
                     END;                                               02473000
                     IF I!6 THEN GO TO L4;                              02474000
                   END;                                                 02475000
                   IF SCAN(1) THEN GO TO L4;                            02476000
                   EDIT(1,1);                                           02477000
                   IF GENERATE THEN EDITING(1,1);                       02478000
                   IF DFNBODY THEN GO TO L4;                            02479000
                   IF EOF THEN GO TO L3;                                02480000
                   IF J~NXT.[36:6]!"," THEN                             02481000
                   IF J!";" THEN                                        02482000
                   BEGIN                                                02483000
                     IF BOOLEAN(I~CHECKNXT(4&","[36:42:6])) THEN        02484000
                     GO TO L3;                                          02485000
                     IF I=2 THEN                                        02486000
                     BEGIN                                              02487000
                       IF GENERATE THEN EDITING(1,NCR);  GO TO L4;      02488000
                     END;                                               02489000
                     IF I=0 THEN                                        02490000
                     IF NXT.[36:6]!";" THEN GO TO L4 ELSE               02491000
                     IF I!6 THEN GO TO L4;                              02492000
                   END;                                                 02493000
                   IF SCAN(1) THEN GO TO L2;                            02494000
                   EDIT(1,1);                                           02495000
                   IF GENERATE THEN EDITING(1,1);                       02496000
                   GO TO IF J=";" THEN L1 ELSE L34;                     02497000
         LE:  END  DFNBODY;                                             02498000
       REAL        I,J,INFOINX,DFST;                                    02499000
       LABEL       H0,H1,H12,H14,H2,HE;                                 02500000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"BULDFN",NXT,DX);                 02501000
COMMENT  INITIALIZING THE EDIT-PROCEDURE IN THIS BLOCK;                 02502000
                   BB~2;  % BLANKS IN THE FRONT OF EACH CARD.           02503000
                   DFST~DX;  AVC~-1;  DCI[9]~INV&5[42:42:6];            02504000
COMMENT  SCAN FOR THE DEFINE IDENTIFIER;                                02505000
         H0:       IF BOOLEAN(I~CHECKNXT(1)) THEN GO TO H1;             02506000
                   IF I!2 THEN  % DEFINE ID DOSNT START WITH A LETTER.  02507000
         H1:       BEGIN  DX~DFST;                                      02508000
                     IF INFOINX=0 THEN                                  02509000
                     BEGIN  INF[0]~"6DEFIN"; INF[1]~0&"E"[1:43:5];      02510000
                       DFER(FOU(0),INF[0]);                             02511000
                     END ELSE                                           02512000
                     DFER(FOU(0),INFO[INFOINX.[35:5],INFOINX.[40:8]]);  02513000
                     RELEASE(FOU);                                      02514000
         H12:        IF EOF THEN GO TO HE ELSE SKIPDEFINE;              02515000
                     IF EOF THEN GO TO HE;                              02516000
                     IF NXT.[36:6]=";" THEN                             02517000
         H14:        BEGIN                                              02518000
                       IF NOT SCAN(1) THEN                              02519000
                       IF GENERATE THEN EDITING(1,1);  GO TO HE;        02520000
                     END ELSE  GO TO                                    02521000
                     IF CHECKNXT(4&";"[36:42:6])=6 THEN H14 ELSE H12;   02522000
                   END;                                                 02523000
                   IF GENERATE THEN EDITING(1,NCR);                     02524000
COMMENT  BUILD IN INF[*] THE ENTRY OF THIS DEFINE.  INF[*] WILL BE MOVED02525000
         TO INFO[*,*] WHEN THE PROCESS IS COMPLETE WITH NO ERROR;       02526000
                   INF[1]~EV[0]&NCR[1:31:17];                           02527000
                   IF NCR>5 THEN                                        02528000
                   BEGIN                                                02529000
                     INF[0]~-(NCR+10) DIV 8;  % ADDITIONAL INFO REL INX.02530000
                     TRNSFWDS(INF[2],EV[1],-INF[0]-1);                  02531000
                   END ELSE INF[0]~-1;                                  02532000
COMMENT  PICK UP THE "=", AFTER WHICH, THE DEFINE BODY STARTS;          02533000
                   IF EOF THEN GO TO H1;                                02534000
                   IF NXT.[36:6]="=" THEN GO TO H2;                     02535000
                   IF (I~CHECKNXT(4&"="[36:42:6]))=6 THEN GO TO H2;     02536000
                   IF I=0 THEN                                          02537000
                   IF NXT.[36:6]="(" THEN                               02538000
                   BEGIN                                                02539000
                     IF DFINE THEN ERRDFN~1 ELSE CV[9].[36:6]~ERX~1;    02540000
                     LFX~NFX;  I~BRACKET(")",1);  LFX~1;                02541000
                     IF I=4 THEN                                        02542000
                     IF (I~CHECKNXT(4&"="[36:42:6]))=6 THEN             02543000
                     BEGIN EV[0].[1:1]~1; EDIT(0,0); GO TO H2 END;      02544000
                   END;                                                 02545000
                   IF I=2 THEN                                          02546000
                   IF GENERATE THEN EDITING(1,NCR);                     02547000
                   GO TO H1;                                            02548000
COMMENT  START TO BUILD THE DEFINE BODY INTO DFSK-FILE;                 02549000
         H2:       IF NOT SCAN(1) THEN                                  02550000
                   IF GENERATE THEN EDITING(1,1);                       02551000
                   INF[1-INF[0]]~DX+1;  % STORE DFSK-INDEX OF FEFINE.   02552000
                   IF DFNBODY THEN GO TO H1;                            02553000
COMMENT  COMPLETE BUILDING THIS DEFINE, ENTER IT TO INFO[*,*];          02554000
                   IF AVC}0 THEN EDIT(0,AVC);                           02555000
                   INFOINX~INFOENTRY(INF,2-INF[0]);                     02556000
                   DFST~DX;                                             02557000
IF DEBUGN=3 THEN                                                        02558000
BEGIN                                                                   02559000
      DUMPARRAY(INFO[0,*],0,255,FOU,1,"INFO:0",HFX);                    02560000
      FOR I~0 STEP 1 UNTIL DX DO                                        02561000
      BEGIN READ(DFSK[I],12,A[*]);DUMPARRAY(A,0,11,FOU,1,"DFSK :",I)END;02562000
END;                                                                    02563000
COMMENT  PICK UP THE SEMICOLUMN OR THE COMMA AFTER THIS DEFINE;         02564000
                   IF J~NXT.[36:6]!";" THEN                             02565000
                   IF J!"," THEN                                        02566000
                   BEGIN                                                02567000
                     IF BOOLEAN(I~CHECKNXT(4&";"[36:42:6])) THEN        02568000
                     GO TO H1;                                          02569000
                     IF I=2 THEN                                        02570000
                     BEGIN                                              02571000
                       IF GENERATE THEN EDITING(1,NCR);  GO TO H1;      02572000
                     END;                                               02573000
                     IF I=0 THEN                                        02574000
                     BEGIN IF J~NXT.[36:6]!"," THEN GO TO H1 END ELSE   02575000
                     IF I=6 THEN J~NXT.[36:6] ELSE GO TO H1;            02576000
                   END;                                                 02577000
                   IF NOT SCAN(1) THEN                                  02578000
                   IF GENERATE THEN EDITING(1,1);                       02579000
                   IF J!";" THEN GO TO H0;                              02580000
         HE:  END  BUILDEFINE;                                          02581000
REAL PROCEDURE     DONTCARE(I);                                         02582000
COMMENT ................................................................02583000
:    THIS PROCEDURE ENTERS A "DONT-CARE" INTO INFO[*,*] IF THE NEXT IS :02584000
:AN IDENTIFIER.  IF "I" IS AN EVEN NUMBER, NO SCAN IS PERFORMED AND    :02585000
:WHATEVER IS IN EV[*] WILL BE ENTERED INTO INFO[*,*].                  :02586000
:    VALUE OF RESULT:  0:  NEXT IS A ABSOLUTE RESERVED WORD.           :02587000
:                      1:  NEXT IS END-OF-FILE.                        :02588000
:                      2:  NEXT IS A DIGIT OR SPECIAL CHARACTER.       :02589000
:                      3:  NEXT IS "BEGIN".                            :02590000
:                      5:  NEXT IS "END".                              :02591000
:                      8:  NEXT IS ENTERED AS A "DONT-CARE".           :02592000
:                              --------  J. C. PAO   05/15/68  --------:02593000
:......................................................................;02594000
     VALUE         I;                                                   02595000
     REAL          I;                                                   02596000
              BEGIN                                                     02597000
       ARRAY       A[0:9];                                              02598000
       LABEL       L1,L2,LE;                                            02599000
                   IF BOOLEAN(I) THEN                                   02600000
                   BEGIN LFX~NFX;  I~CHECKNEXT(1); LFX~1 END ELSE GO L2;02601000
                   IF BOOLEAN(I) THEN                                   02602000
         L1:       BEGIN DONTCARE~I; GO TO LE END;                      02603000
                   IF I=2 THEN GO TO L1;                                02604000
                   IF IFX{RFX THEN GO TO LE;                            02605000
         L2:       A[0]~0;  % MARK AS A RESERVED WORD --- "DONT-CARE".  02606000
                   A[1]~EV[0]&NCR[1:31:17];                             02607000
                   IF NCR{5 THEN I~0 ELSE                               02608000
                   TRNSFWDS(A[2],EV[1],I~(NCR+2).[39:6]);               02609000
                   I~INFOENTRY(A,I+2);                                  02610000
                   DONTCARE~8;                                          02611000
         LE:  END  DONTCARE;                                            02612000
REAL PROCEDURE     DCLARTYPE(AY);                                       02613000
COMMENT ................................................................02614000
:    THIS PROCEDURE ENTERS AN ARRAY IDENTIFIER ("AY"=1) OR A SIMPLE    :02615000
:IDENTIFIER ((AY=0) INTO INFO[*,*].                                    :02616000
:    VALUE OF RESULT:  0:  PROCESSED UNTIL AFTER THE SEMICOLUMN.       :02617000
:                      1:  STOPPED AT END-OF-FILE.                     :02618000
:                      3:  STOPPED AT "BEGIN".                         :02619000
:                      5:  STOPPED AT "END".                           :02620000
:                              --------  J. C. PAO   04/30/68  --------:02621000
:......................................................................;02622000
     VALUE         AY;                                                  02623000
     REAL          AY;                                                  02624000
              BEGIN                                                     02625000
       REAL        H,I;                                                 02626000
       LABEL       L1,L2,L3,L4,L5,LX,LX1,LE;                            02627000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"DCTYPE",NXT,AY);                 02628000
COMMENT  ENTER THE IDENTIFIER INTO INFO[*,*];                           02629000
                   IF BOOLEAN(AY) THEN                                  02630000
                   BEGIN A[0]~0&1[1:46:2]; GO TO L3 END ELSE            02631000
                   A[0]~0&3[1:46:2];                                    02632000
         L1:       A[1]~EV[0]&NCR[1:31:17];                             02633000
                   IF NCR{5 THEN I~0 ELSE                               02634000
                   TRNSFWDS(A[2],EV[1],I~(NCR+2).[39:6]);               02635000
                   I~INFOENTRY(A,I+2);                                  02636000
COMMENT  LOOKING FOR THE NEXT IDENTIFIER IF THERE ANY;                  02637000
                   IF (I~CHECKNEXT(4&","[36:42:6]))=8 THEN              02638000
         L2:       BEGIN  % LOOKING FOR THE NEXT IDENTIFIER.            02639000
                     IF NOT SCAN(1) THEN                                02640000
                     IF GENERATE THEN EDITING(1,1);                     02641000
         L3:         LFX~NFX;  I~CHECKNEXT(1);  LFX~1;                  02642000
                     GO TO IF BOOLEAN(I) THEN LX ELSE                   02643000
                           IF I=2 THEN LX ELSE                          02644000
                           IF IFX>RFX THEN L1 ELSE LX;                  02645000
                   END;                                                 02646000
                   IF I=2 THEN                                          02647000
                   BEGIN                                                02648000
                     IF NXT.[36:6]="[" THEN                             02649000
                     GO TO IF BOOLEAN(AY) THEN L4 ELSE LX;              02650000
                     IF NXT.[36:6]=";" THEN                             02651000
                     GO TO IF BOOLEAN(AY) THEN LX ELSE L5;              02652000
                   END;  GO TO LX;                                      02653000
COMMENT  SCAN FOR THE [ ] IN CASE OF AN ARRAY IDENTIFIER;               02654000
         L4:       IF (I~BRACKET("]",1))!4 THEN GO TO LX;               02655000
                   IF(I~CHECKNEXT(4&","[36:42:6]))=8 THEN GO TO L2;     02656000
                   IF I=2 THEN                                          02657000
                   IF NXT.[36:6]=";" THEN GO TO L5;                     02658000
COMMENT  ERROR SITUATION, MARK ERROR;                                   02659000
         LX:       IF DFINE THEN ERRDFN~1 ELSE                          02660000
                   IF I=2 THEN CV[9].[36:6]~ERX~1 ELSE                  02661000
                   BEGIN ERROR; CI[9].[36:6]~1 END;                     02662000
                   IF BOOLEAN(I) THEN GO TO LX1;                        02663000
                   IF BOOLEAN(I~REAL(SKIPUNTIL(";"))) THEN              02664000
         LX1:      BEGIN DCLARTYPE~I; GO TO LE END;                     02665000
         L5:       IF NOT SCAN(1) THEN                                  02666000
                   IF GENERATE THEN EDITING(1,1);                       02667000
         LE:  END  DCLARTYPE;                                           02668000
REAL PROCEDURE     BLOCK(BGN);  VALUE BGN; REAL BGN;  FORWARD;          02669000
REAL PROCEDURE     PROCEDUR(TP);                                        02670000
COMMENT ................................................................02671000
:    THIS PROCEDURE TAKES CARE OF PROCESSING A PROCEDURE DECLARATION.  :02672000
:    VALUE OF RESULT:  0:  PROCESS COMPLETE.                           :02673000
:                      1:  STOPPED AT END-OF-FILE.                     :02674000
:                      3:  STOPPED AT "BEGIN".                         :02675000
:                      5:  STOPPED AT "END".                           :02676000
:                              --------  J. C. PAO   05/03/68  --------:02677000
:......................................................................;02678000
     VALUE         TP;                                                  02679000
     BOOLEAN       TP;                                                  02680000
              BEGIN                                                     02681000
       REAL        I;                                                   02682000
       LABEL       L1,L2,LX,LX1,LE;                                     02683000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"PROCDR",NXT,TP);                 02684000
                   IF (I~DONTCARE(1))!8 THEN                            02685000
         LX:       BEGIN  % THE NEXT IS A SPECIAL CHR OR A DIGIT.       02686000
                     IF DFINE THEN ERRDFN~1 ELSE                        02687000
                     IF I=2 THEN CV[9].[36:6]~ERX~1 ELSE                02688000
                     BEGIN ERROR; CI[9].[36:6]~1 END;                   02689000
                     IF BOOLEAN(I) THEN GO TO LX1;                      02690000
         L1:         LFX~NFX;  I~REAL(SKIPUNTIL(";"));  LFX~1;          02691000
                     IF BOOLEAN(I) THEN                                 02692000
         LX1:        BEGIN PROCEDUR~I; GO TO LE END;                    02693000
                     IF NOT SCAN(1) THEN                                02694000
                     IF GENERATE THEN EDITING(1,1);  GO TO L2;          02695000
                   END;                                                 02696000
                   IF BOOLEAN(I~CHECKNEXT(4&"("[36:42:6])) THEN         02697000
                   GO TO LX;                                            02698000
                   IF I=8 THEN GO TO L1;                                02699000
                   IF I!2 THEN GO TO LX;                                02700000
                   IF NXT.[36:6]!";" THEN GO TO LX;                     02701000
                   IF NOT SCAN(1) THEN                                  02702000
                   IF GENERATE THEN EDITING(1,1);                       02703000
                   IF TP THEN                                           02704000
                   INFO[HFX.[35:5],HFX.[40:8]-1].[1:2]~3;               02705000
         L2:       IF BOOLEAN(I~BLOCK(0)) THEN                          02706000
                   GO TO IF I=1 THEN LX ELSE LX1;                       02707000
                   IF NXT.[36:6]!";" THEN                               02708000
                   BEGIN                                                02709000
                     IF DFINE THEN ERRDFN~1 ELSE CV[9].[36:6]~ERX~1;    02710000
                   END ELSE                                             02711000
                   IF NOT SCAN(1) THEN                                  02712000
                   IF GENERATE THEN EDITING(1,1);                       02713000
         LE:  END  PROCEDUR;                                            02714000
STREAM PROCEDURE   BGNEND(F,BE,BKCNT,CDNO,DFN,DFID,BDNO);               02715000
     VALUE         BE,BKCNT,DFN;                                        02716000
              BEGIN                                                     02717000
                   DI~F;  2(DS~33 LIT"    "); DS~5 LIT"****";           02718000
                   SI~LOC BE; SI~SI+7;                                  02719000
                   IF SC="1" THEN                                       02720000
                   BEGIN  DS~8 LIT" BEGIN (";  F~DI;                    02721000
                     DI~BDNO; SI~CDNO; DS~8 CHR; DI~F;                  02722000
                   END ELSE DS~8 LIT"** END (";                         02723000
                   SI~LOC BKCNT; DS~3 DEC; DS~5 LIT") ON ";             02724000
                   SI~CDNO; DS~8 CHR;                                   02725000
                   SI~LOC DFN; SI~SI+7;                                 02726000
                   IF SC="1" THEN                                       02727000
                   BEGIN  DS~11 LIT" IN DEFINE ";                       02728000
                     SI~DFID; SI~SI+3; DS~5 CHR; DS~LIT" ";             02729000
                   END ELSE BEGIN DS~LIT" "; DS~16 LIT"****" END;       02730000
                   SI~LOC BE; SI~SI+7;                                  02731000
                   IF SC!"1" THEN                                       02732000
                   BEGIN DI~DI-1; DS~LIT" "; SI~BDNO; DS~8 CHR END ELSE 02733000
                   DS~8 LIT"****";                                      02734000
              END  BGNEND;                                              02735000
REAL PROCEDURE     STREAMPROCEDURE(TP);                                 02736000
COMMENT ................................................................02737000
:    THIS PROCEDURE PROCCESSES THE STREAM PROCEDURES.                  :02738000
:                              --------  J. C. PAO   05/23/68  --------:02739000
:......................................................................;02740000
     VALUE         TP;                                                  02741000
     BOOLEAN       TP;                                                  02742000
              BEGIN                                                     02743000
REAL PROCEDURE     ERRSTREAM(J);  % 2: ")", ";".  4: "THEN".  6: "ELSE".02744000
     VALUE         J;             % 1,3,5: EOF, "BEGIN", "END".         02745000
     REAL          J;                                                   02746000
              BEGIN                                                     02747000
       REAL        I;                                                   02748000
       LABEL       L1,L2,LE;                                            02749000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"ERRSTM",NXT,J);                  02750000
                   IF (I~LFX&J[1:1:1])<0 THEN J~-J; LFX~NFX; STRM~FALSE;02751000
                   IF DFINE THEN ERRDFN~1 ELSE                          02752000
                   IF J=2 THEN CV[9].[36:6]~ERX~1 ELSE                  02753000
                   BEGIN  ERROR;  CI[9].[36:6]~1;                       02754000
                     IF BOOLEAN(J) THEN GO TO LE;                       02755000
         L1:         IF GENERATE THEN EDITING(1,NCR);                   02756000
                   END;                                                 02757000
         L2:       IF (J~CHECKNEXT(4&";"[36:42:6]))=8 THEN              02758000
                   BEGIN J~2; GO TO LE END;                             02759000
                   IF J=2 THEN                                          02760000
                   IF NXT.[36:6]=")" AND I>0 THEN GO TO LE ELSE         02761000
                   IF NXT.[36:6]=""" THEN                               02762000
                   BEGIN STRING; GO TO L2 END ELSE                      02763000
                   GO TO IF SCAN(IF NXT.[42:6]=4 THEN 1 ELSE 0) THEN L2 02764000
                         ELSE L1;                                       02765000
                   IF J=0 THEN IF IFX=BLK THEN GO TO L2;                02766000
                   IF I>0 THEN                                          02767000
                   IF IFX=DFX+9 THEN BEGIN J~6; GO TO LE END ELSE       02768000
                   IF IFX=DFX+19 THEN BEGIN J~4; GO TO LE END;          02769000
                   IF NOT BOOLEAN(J) THEN GO TO L2;                     02770000
         LE:       LFX~ABS(I); STRM~TRUE;  ERRSTREAM~J;                 02771000
              END  ERRSTREAM;                                           02772000
PROCEDURE          LOCAL(X);  % MAKE A "LOCAL[INFO[X]]".                02773000
     VALUE         X;                                                   02774000
     REAL          X;                                                   02775000
              BEGIN                                                     02776000
       REAL        I;                                                   02777000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"LOCAL ",NXT,X);                  02778000
                   IF NOT GENERATE THEN STARTGEN;                       02779000
                   EV[0]~"LOCAL"; EV[1]~0&"["[1:43:5];  EDITING(1,6);   02780000
                   EDITING(1,(EV[0]~INFO[I~X.[35:5],(X~X.[40:8])+       02781000
                   INFO[I,X-1].[40:8]]).[12:6]);  FST~4;                02782000
                   EV[0]~0&"]"[18:42:6];  EDITING(1,1);                 02783000
              END  LOCAL;                                               02784000
PROCEDURE          REPEATFIELD(X);  % MAKE A REPEATFIELD.               02785000
     VALUE         X;                                                   02786000
     REAL          X;                                                   02787000
              BEGIN                                                     02788000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"RPTFLD",NXT,X);                  02789000
                   IF NOT GENERATE THEN STARTGEN;                       02790000
                   IF X!0 THEN LOCAL(X) ELSE                            02791000
                   BEGIN EV[0]~"TALLY"; EDITING(1,5) END;               02792000
                   EV[0]~0&"."[18:42:6];  LST~4;  EDITING(1,1);         02793000
                   EV[0]~"[5:6]";  EDITING(1,5);                        02794000
              END  REPEATFIELD;                                         02795000
REAL PROCEDURE     STATEMENT(J,B,BNO);                                  02796000
                   VALUE J,B; REAL J,B; ARRAY BNO[0];  FORWARD;         02797000
REAL PROCEDURE     SETPOINTER;  % ENTER WITH "SI" OR "DI".              02798000
              BEGIN             % 0: NEXT UNKNOWN.  2,4,6: "ERRSTREAM". 02799000
       REAL        I;           % 1,3,5: EOF, BEGIN, END.               02800000
       LABEL       L1,L2,L3,LX,LE;                                      02801000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"SETPNT",NXT);                    02802000
                   IF GENERATE THEN EDITING(1,2);                       02803000
                   IF (I~CHECKNEXT(4&"~"[36:42:6]))!8 THEN              02804000
         LX:       BEGIN SETPOINTER~ERRSTREAM(I); GO TO LE END;         02805000
                   IF NOT SCAN(1) THEN                                  02806000
                   IF GENERATE THEN EDITING(1,1);                       02807000
                   IF (I~CHECKNEXT(1))}10 THEN                          02808000
                   BEGIN  IF I=10 OR I=14 THEN ERROR;                   02809000
                     IF GENERATE THEN EDITING(1,NCR);  GO TO LE;        02810000
                   END;                                                 02811000
                   IF I!0 OR IFX!BLK THEN GO TO LX;                     02812000
                   IF NCR=3 THEN                                        02813000
                   IF EV[0].[18:18]!"LOC" THEN GO TO LX ELSE            02814000
                   BEGIN  IF NOT GENERATE THEN STARTGEN;                02815000
                     EV[0]~"POINT"; EV[1]~0&"ER("[1:31:17];             02816000
                     EDITING(1,8);  BBK~FALSE;                          02817000
                     IF (I~CHECKNEXT(1))<10 THEN GO TO LX;              02818000
                     IF I<14 THEN                                       02819000
                     BEGIN  ERROR;                                      02820000
                       IF GENERATE THEN EDITING(1,NCR);  GO TO L1;      02821000
                     END ELSE                                           02822000
                     BEGIN  LOCAL(IFX);                                 02823000
         L1:           IF NOT GENERATE THEN STARTGEN;                   02824000
                       EV[0]~0&")"[18:42:6];  EDITING(1,1);             02825000
                       IF NOT GENERATE THEN STARTGEN;                   02826000
                     END;  GO TO LE;                                    02827000
                   END  ELSE                                            02828000
                   IF NCR!2 THEN GO TO LX;                              02829000
                   IF I~EV[0].[18:12]="SI" THEN GO TO L3;               02830000
                   IF I="DI" THEN GO TO L3;                             02831000
                   IF I="SC" THEN GO TO L2;                             02832000
                   IF I="DC" THEN                                       02833000
         L2:       BEGIN  ERROR;                                        02834000
         L3:         IF GENERATE THEN EDITING(1,2);                     02835000
                     IF I.[42:6]="C" THEN GO TO LE;                     02836000
                     IF (I~CHECKNEXT(4&"+"[36:42:6]))!8 THEN            02837000
                     IF I!2 THEN GO TO LX ELSE                          02838000
                     IF NXT.[36:6]!"-" THEN GO TO LX;                   02839000
                     IF NOT SCAN(1) THEN                                02840000
                     IF GENERATE THEN EDITING(1,1);                     02841000
                     IF (I~CHECKNEXT(1))=2 THEN                         02842000
                     IF NXT.[42:6]!0 THEN GO TO LX ELSE                 02843000
                     BEGIN                                              02844000
                       IF NOT SCAN(0) THEN                              02845000
                       IF GENERATE THEN EDITING(1,NCR);  GO TO LE;      02846000
                     END  ELSE                                          02847000
                     IF I<10 THEN GO TO LX;                             02848000
                     IF I<14 THEN                                       02849000
                     BEGIN  ERROR;                                      02850000
                       IF GENERATE THEN EDITING(1,NCR);  GO TO LE;      02851000
                     END;                                               02852000
                     REPEATFIELD(IFX);                                  02853000
                   END ELSE GO TO LX;                                   02854000
         LE:  END  SETPOINTER;                                          02855000
REAL PROCEDURE     PARAMETER(X,I);                                      02856000
     VALUE         X,I;                                                 02857000
     REAL          X,I;                                                 02858000
              BEGIN                                                     02859000
REAL PROCEDURE     STORE(X,I);                                          02860000
     VALUE         X,I;                                                 02861000
     REAL          X,I;                                                 02862000
              BEGIN                                                     02863000
       REAL        J,K;                                                 02864000
       LABEL       L1,L2,LX,LE;                                         02865000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"STORE ",NXT,X,I);                02866000
                   IF I<14 THEN IF GENERATE THEN EDITING(1,NCR)ELSE ELSE02867000
                   BEGIN IF NOT GENERATE THEN STARTGEN; K~LST END;      02868000
                   IF (J~CHECKNEXT(4&"~"[36:42:6]))!8 THEN              02869000
         LX:       BEGIN STORE~ERRSTREAM(J); GO TO LE END;              02870000
                   IF SCAN(1) THEN GO TO LX;                            02871000
                   IF I<14 THEN IF GENERATE THEN EDITING(1,NCR)ELSE ELSE02872000
                   IF NOT GENERATE THEN STARTGEN;                       02873000
                   IF (J~CHECKNEXT(1))!0 THEN GO TO LX;                 02874000
                   IF IFX!BLK THEN GO TO LX;                            02875000
                   IF NCR=2 THEN GO TO L1;                              02876000
                   IF NCR!5 THEN GO TO LX;                              02877000
                   IF (J~EV[0]).[18:30]!"TALLY" THEN GO TO LX;          02878000
                   IF I<14 THEN GO TO L2;                               02879000
                   FST~0; LST~K;  LOCAL(X);                             02880000
                   EV[0]~0&"~"[18:42:6];  EDITING(1,1);                 02881000
                   REPEATFIELD(0);  GO TO LE;                           02882000
         L1:       IF (J~EV[0]).[18:12]!"SI" AND J.[18:12]!"DI" THEN    02883000
         L2:       BEGIN ERROR; J.[1:1]~1 END ELSE                      02884000
                   IF I=10 OR I=14 THEN GO TO L2;                       02885000
                   IF I<14 THEN                                         02886000
                   BEGIN  IF GENERATE THEN EDITING(1,NCR);              02887000
                     GO TO LE;                                          02888000
                   END ELSE IF NOT GENERATE THEN STARTGEN;              02889000
                   IF (I~(EV[0]~INFO[X.[35:5],X.[40:8]]).[12:6])>5 THEN 02890000
                   TRNSFWDS(EV[1],INFO[X.[35:5],X.[40:8]+1],            02891000
                            (I+2).[36:9]);                              02892000
                   FST~0; LST~K;  EDITING(1,I);                         02893000
                   EV[0]~0&"~"[18:42:6];  LST~4;  EDITING(1,1);         02894000
                   IF NCR=2 THEN                                        02895000
                   BEGIN EV[0]~J; EDITING(1,2) END ELSE                 02896000
                   BEGIN REPEATFIELD(0); CI[9].[36:6]~1 END;            02897000
         LE:  END  STORE;                                               02898000
REAL PROCEDURE     LOOP(X,I);                                           02899000
     VALUE         X,I;                                                 02900000
     REAL          X,I;                                                 02901000
              BEGIN                                                     02902000
       REAL        J;                                                   02903000
       BOOLEAN     N;                                                   02904000
       LABEL       L1,L2,LX1,LX,LE;                                     02905000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"LOOP  ",NXT,X,I);                02906000
                   IF I=2 THEN                                          02907000
                   BEGIN                                                02908000
                     IF SCAN(0) THEN GO TO LX1;                         02909000
                     IF (J~CHECKNEXT(4&"("[36:42:6]))!8 THEN GO TO LX;  02910000
                     IF NCR>8 THEN                                      02911000
                     IF (NCR~LEADING0(EV[0],NCR))>8 THEN GO TO LX;      02912000
                     IOCVRT(X,EV[0],3,NCR,1);                           02913000
                     IF X>63 THEN X~X.[42:6];                           02914000
                     IF X>9 THEN                                        02915000
                     BEGIN  NCR~2;                                      02916000
                       J~0&(X DIV 10)[18:42:6]&ENTIER(X MOD 10)         02917000
                       [24:42:6];                                       02918000
                     END ELSE                                           02919000
                     BEGIN J~0&X[18:42:6]; NCR~1 END;                   02920000
                   END ELSE                                             02921000
                   BEGIN IF I<14 THEN ERROR; J~EV[0] END;               02922000
                   IF NOT GENERATE THEN STARTGEN;                       02923000
                   EV[0]~"THRU ";  EDITING(1,5);                        02924000
                   IF I<14 THEN                                         02925000
                   BEGIN EV[0]~J; EDITING(1,NCR) END ELSE               02926000
                   REPEATFIELD(X);  LST~FST~0;                          02927000
                   EV[0]~"DO   ";  EDITING(1,2);                        02928000
                   IF N~NEWCD THEN EDITING(0,AVC);                      02929000
                   IF SCAN(1) THEN                                      02930000
         LX1:      BEGIN  J~0;                                          02931000
         LX:         LOOP~ERRSTREAM(J);  GO TO LE;                      02932000
                   END;                                                 02933000
                   IF NOT GENERATE THEN                                 02934000
                   BEGIN  STARTGEN;                                     02935000
                     IF N THEN                                          02936000
                     BEGIN BB~REAL(N.[36:9]); CIVALID~FALSE END;        02937000
                   END;  FST~0;                                         02938000
                   EV[0]~"BEGIN";  EDITING(1,5);  BBK~TRUE;             02939000
         L1:       IF BOOLEAN(J~STATEMENT(CHECKNEXT(1),0,A)) THEN GO LX;02940000
                   IF J!2 THEN GO TO LX;                                02941000
                   IF NXT.[36:6]=";" THEN                               02942000
         L2:       BEGIN                                                02943000
                     IF SCAN(1) THEN GO TO LX1;                         02944000
                     IF GENERATE THEN EDITING(1,1);  GO TO L1;          02945000
                   END;                                                 02946000
                   IF NXT.[36:6]!")" THEN GO TO LX;                     02947000
                   IF SCAN(1) THEN GO TO LX1;                           02948000
                   IF NOT GENERATE THEN STARTGEN;                       02949000
                   IF NOT NEWCD THEN LST~FST~0;                         02950000
                   EV[0]~"END  ";  EDITING(1,3);                        02951000
         LE:  END  LOOP;                                                02952000
       REAL        J,K;                                                 02953000
       LABEL       L1,LE;                                               02954000
                   IF I=2 THEN GO TO L1;                                02955000
                   J~EV[0]&NCR[1:31:17];                                02956000
                   K~CHECKNEXT(4&"("[36:42:6]);                         02957000
                   NCR~(EV[0]~J).[1:17];                                02958000
                   IF BOOLEAN(K) THEN                                   02959000
                   BEGIN                                                02960000
                     IF GENERATE THEN EDITING(1,NCR);                   02961000
                     IF K=3 THEN BEGIN EV[0]~"BEGIN"; NCR~5 END ELSE    02962000
                     IF K=5 THEN BEGIN EV[0]~"END  "; NCR~3 END;        02963000
                     PARAMETER~ERRSTREAM(K);  GO TO LE;                 02964000
                   END;                                                 02965000
                   IF K!8 THEN PARAMETER~STORE(X,I) ELSE                02966000
         L1:       PARAMETER~LOOP(X,I);                                 02967000
         LE:  END  PARAMETER;                                           02968000
REAL PROCEDURE     TALLY;                                               02969000
              BEGIN                                                     02970000
       REAL        I,B;                                                 02971000
       LABEL       L0,L1,L2,LX,LE;                                      02972000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"TALLY ",NXT);                    02973000
                   IF GENERATE THEN EDITING(1,NCR);                     02974000
                   IF (I~CHECKNEXT(4&"~"[36:42:6]))!8 THEN              02975000
         LX:       BEGIN TALLY~ERRSTREAM(I); GO TO LE END;              02976000
         L0:       IF NOT SCAN(1) THEN                                  02977000
                   IF GENERATE THEN EDITING(1,1);                       02978000
                   IF (I~CHECKNEXT(1))}10 THEN                          02979000
                   BEGIN IF I<14 THEN BEGIN ERROR; GO TO L2 END;        02980000
                     REPEATFIELD(IFX);  GO TO LE;                       02981000
                   END;                                                 02982000
                   IF I=2 THEN                                          02983000
         L1:       IF NXT.[42:6]!0 THEN GO TO LX ELSE                   02984000
                   BEGIN                                                02985000
                     IF NOT SCAN(0) THEN                                02986000
         L2:         IF GENERATE THEN EDITING(1,NCR);  GO TO LE;        02987000
                   END;                                                 02988000
                   IF BOOLEAN(B) THEN GO TO LX;                         02989000
                   IF I!0 THEN GO TO LX;                                02990000
                   IF IFX!BLK THEN GO TO LX;                            02991000
                   IF NCR!5 THEN GO TO LX;                              02992000
                   IF EV[0].[18:30]!"TALLY" THEN GO TO LX;              02993000
                   IF GENERATE THEN EDITING(1,NCR);  B~1;               02994000
                   GO TO IF (I~CHECKNEXT(4&"+"[36:42:6]))=8 THEN L0     02995000
                         ELSE LX;                                       02996000
         LE:  END  TALLY;                                               02997000
REAL PROCEDURE     GOTO;         % ENTER WITH "GO".                     02998000
              BEGIN              % 0: NEXT UNKNOWN.  2,4,6: "ERRSTREAM".02999000
       REAL        I,J;          % 1,3,5: EOF, "BEGIN", "END".          03000000
       LABEL       L1,LX,LE;                                            03001000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"GOTO  ",NXT);                    03002000
                   IF GENERATE THEN EDITING(1,NCR);  % THE WORD "GO".   03003000
         L1:       IF BOOLEAN(I~CHECKNEXT(1)) THEN                      03004000
         LX:       BEGIN GOTO~ERRSTREAM(I); GO TO LE END;               03005000
                   IF I!0 THEN GO TO LX;                                03006000
                   IF IFX=DFX+23 THEN  % THE WORD "TO".                 03007000
                   BEGIN  IF BOOLEAN(J) THEN GO TO LX ELSE J~1;         03008000
                     IF GENERATE THEN EDITING(1,NCR);  GO TO L1;        03009000
                   END;                                                 03010000
                   IF IFX=BLK OR IFX<LFX THEN GO TO LX;                 03011000
                   IF GENERATE THEN EDITING(1,NCR);                     03012000
         LE:  END  GOTO;                                                03013000
REAL PROCEDURE     JUMPOUT;                                             03014000
              BEGIN                                                     03015000
       REAL        J,E,L;                                               03016000
       LABEL       L1,L2,LX,LE;                                         03017000
                   IF NOT GENERATE THEN STARTGEN;  L~LST;               03018000
                   IF J~CHECKNEXT(1)!0 THEN                             03019000
         LX:       BEGIN JUMPOUT~ERRSTREAM(J); GO TO LE END;            03020000
                   IF IFX!DFX+15 THEN GO TO LX;                         03021000
                   IF NOT GENERATE THEN STARTGEN;                       03022000
                   IF (J~CHECKNEXT(1))=2 THEN                           03023000
                   BEGIN                                                03024000
         L1:         IF NXT.[36:6]=";" THEN                             03025000
         L2:         BEGIN EV[0]~"JUMP "; LST~L; FST~0;  EDITING(1,5);  03026000
                       EV[0]~"OUT  ";  ERROR;  EDITING(1,3);            03027000
                       IF E!0 THEN                                      03028000
                       BEGIN EV[0]~E; EDITING(1,E.[12:6]) END;          03029000
                       JUMPOUT~J;  GO TO LE;                            03030000
                     END;                                               03031000
                     IF NXT.[36:6]=")" THEN GO TO L2;                   03032000
                     IF E!0 THEN GO TO LX;                              03033000
                     IF NXT.[42:6]!0 THEN GO TO LX;                     03034000
                     IF SCAN(0) THEN BEGIN J~0; GO TO LX END;           03035000
                     IF NOT GENERATE THEN STARTGEN;                     03036000
                     E~EV[0]&NCR[12:42:6];                              03037000
                     IF (J~CHECKNEXT(1))=2 THEN GO TO L1;               03038000
                   END;                                                 03039000
                   IF J=5 THEN GO TO L2;  IF J!0 THEN GO TO LX;         03040000
                   IF IFX=DFX+9 THEN BEGIN J~6; GO TO L2 END;           03041000
                   IF IFX!DFX+23 THEN GO TO LX;                         03042000
                   IF NOT GENERATE THEN STARTGEN;                       03043000
                   EV[0]~"GO TO"; LST~L; FST~0;  EDITING(1,5);          03044000
                   IF (J~CHECKNEXT(1))!0 THEN GO TO LX;                 03045000
                   IF IFX=BLK OR IFX<LFX THEN GO TO LX;                 03046000
                   IF GENERATE THEN EDITING(1,NCR);                     03047000
         LE:  END  JUMPOUT;                                             03048000
REAL PROCEDURE     IFSTATEMENT;  % ENTER WITH "IF".                     03049000
              BEGIN              % 0: NEXT UNKNOWN.  2,4,6: "ERRSTREAM".03050000
       REAL        I,J;          % 1,3,5: EOF, "BEGIN", "END".          03051000
       ARRAY       E[0:8];                                              03052000
       LABEL       L0,L1,L2,L3,L4,LX,LE;                                03053000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"IFSTMT",NXT);                    03054000
                   IF GENERATE THEN EDITING(1,2);  % THE WORD "IF".     03055000
                   IF BOOLEAN(I~CHECKNEXT(1)) THEN                      03056000
         LX:       BEGIN IFSTATEMENT~ERRSTREAM(I); GO TO LE END;        03057000
                   IF I=2 THEN                                          03058000
                   IF NXT.[42:6]=0 THEN                                 03059000
                   BEGIN                                                03060000
                     IF SCAN(0) THEN GO TO LX;                          03061000
                     E[0]~EV[0]&NCR[1:31:17];                           03062000
                     IF NCR>5 THEN TRNSFWDS(E[1],EV[1],(NCR+2).[36:9]); 03063000
         L0:         IF NOT GENERATE THEN STARTGEN;                     03064000
                     IF (I~CHECKNEXT(1))!0 THEN GO TO LX;               03065000
                     IF NCR!2 THEN GO TO LX ELSE                        03066000
                     BEGIN J~EV[0].[18:12]; GO TO L2 END;               03067000
                   END ELSE GO TO LX;                                   03068000
                   IF I}10 THEN                                         03069000
                   BEGIN  IF I<14 THEN ERROR;                           03070000
                     E[0]~-I&IFX[30:35:13];  GO TO L0;                  03071000
                   END;                                                 03072000
                   IF I!0 THEN GO TO LX;                                03073000
                   IF IFX!BLK THEN GO TO LX;                            03074000
                   IF NCR=6 THEN                                        03075000
                   IF EV[0].[18:30]!"TOGGL" THEN GO TO LX ELSE          03076000
                   BEGIN  J~"E";                                        03077000
                     IF COMPAREA(EV[1],J,0,7,1)!0 THEN GO TO LX;        03078000
         L1:         ERROR;  IF GENERATE THEN EDITING(1,NCR);           03079000
                     GO TO L3;                                          03080000
                   END ELSE                                             03081000
                   IF NCR!2 THEN GO TO LX;                              03082000
                   IF J~EV[0].[18:12]="SB" THEN GO TO L1;               03083000
         L2:       IF J!"SC" THEN GO TO LX;                             03084000
                   IF NOT GENERATE THEN STARTGEN;                       03085000
                   IF (I~CHECKNEXT(1))!2 THEN GO TO LX;                 03086000
                   IF J~NXT.[36:6]!"<" THEN  IF J!"{" THEN              03087000
                   IF J!"=" THEN  IF J!"}" THEN  IF J!">" THEN          03088000
                   IF J!"!" THEN GO TO LX;                              03089000
                   IF NOT SCAN(1) THEN                                  03090000
                   IF NOT GENERATE THEN STARTGEN;                       03091000
                   IF BOOLEAN(I~CHECKNEXT(1)) THEN GO TO LX;            03092000
                   IF NOT GENERATE THEN STARTGEN;                       03093000
                   IF I=2 THEN                                          03094000
                   IF NXT.[36:6]!""" THEN GO TO LX ELSE                 03095000
                   BEGIN % STRING.                                      03096000
                     IF E[0]!0 THEN GO TO LX;                           03097000
                     EV[0]~"SIJ  "&J[30:42:6];  FST~0;  EDITING(1,3);   03098000
                     STRING;  GO TO L3;                                 03099000
                   END;                                                 03100000
                   IF I!0 THEN GO TO LX;                                03101000
                   IF IFX=17 THEN                                       03102000
                   BEGIN  % "ALPHA".                                    03103000
                     IF E[0]!0 THEN GO TO LX;  % BAD ANY WAY.           03104000
                     IF J!"=" THEN GO TO LX;                            03105000
                     EV[0]~"REAL(";  FST~0;  EDITING(1,5);              03106000
                     EV[0]~"SI,1)";  EDITING(1,5);                      03107000
                     EV[0]~" IN  ";  EDITING(1,3);                      03108000
                     EV[0]~"ALPHA";  FST~0;  EDITING(1,5);              03109000
                     GO TO L3;                                          03110000
                   END;                                                 03111000
                   IF NCR!2 THEN GO TO LX;                              03112000
                   IF EV[0].[18:12]!"DC" THEN GO TO LX;                 03113000
                   EV[0]~"SI:SI";  FST~0;  EDITING(1,5);                03114000
                   EV[0]~0&J[18:42:6];  FST~4;  EDITING(1,1);           03115000
                   EV[0]~"DI:DI";  FST~0;  EDITING(1,5);                03116000
                   EV[0]~"FOR  ";  EDITING(1,3);                        03117000
                   IF E[0]<0 THEN                                       03118000
                   BEGIN                                                03119000
                     IF E[0].[43:5]<14 THEN                             03120000
                     BEGIN                                              03121000
                       IF J~(EV[0]~-INFO[(I~E[0]).[30:5],I.[35:8]]).    03122000
                       [12:6]>5 THEN                                    03123000
                       TRNSFWDS(EV[1],INFO[I.[30:5],I.[35:8]+1],        03124000
                                (J+2).[36:9]);                          03125000
                     END ELSE                                           03126000
                     BEGIN REPEATFIELD(E[0].[30:13]); GO TO L3 END;     03127000
                   END ELSE                                             03128000
                   IF E[0]=0 THEN EV[0]~0&(J~1)[12:42:6]&1[18:42:6] ELSE03129000
                   IF (J~(EV[0]~E[0]).[12:6])>5 THEN                    03130000
                   TRNSFWDS(EV[1],E[1],(J+2).[36:9]);                   03131000
                   EDITING(1,J);                                        03132000
         L3:       IF (I~CHECKNEXT(1))!0 THEN GO TO LX;                 03133000
                   IF IFX!DFX+19 THEN GO TO LX;                         03134000
                   IF GENERATE THEN EDITING(1,NCR);                     03135000
                   IF (I~STATEMENT(CHECKNEXT(1),0,E))=2 THEN            03136000
         L4:       BEGIN IFSTATEMENT~I; GO TO LE END ELSE               03137000
                   IF I=5 THEN GO TO L4 ELSE IF I!6 THEN GO TO LX;      03138000
                   IF GENERATE THEN EDITING(1,NCR);                     03139000
                   GO TO IF (I~STATEMENT(CHECKNEXT(1),0,E))=2 THEN L4   03140000
                         ELSE IF I=5 OR I=6 THEN L4 ELSE LX;            03141000
         LE:  END  IFSTATEMENT;                                         03142000
REAL PROCEDURE     TRANSFER;                                            03143000
              BEGIN                                                     03144000
STREAM PROCEDURE   ADJUST(O,NCR,NMR);                                   03145000
     VALUE         NCR,NMR;                                             03146000
              BEGIN                                                     03147000
                   DI~O;  DI~DI+3; DI~DI+NCR;                           03148000
                   SI~O;  SI~SI+3;                                      03149000
                   NMR(DS~CHR; NCR~DI; DI~NCR; O~SI; SI~O);             03150000
              END  ADJUST;                                              03151000
       REAL        I,J,K;                                               03152000
       ARRAY       E[0:8];                                              03153000
       LABEL       L1,L2,L3,L4,LX,LE;                                   03154000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"TRNSFR",NXT);                    03155000
                   IF (I~CHECKNEXT(4&"~"[36:42:6]))!8 THEN              03156000
         LX:       BEGIN TRANSFER~ERRSTREAM(I); GO TO LE END;           03157000
                   IF NOT GENERATE THEN STARTGEN;                       03158000
                   EV[0]~"REPLA"; EV[1]~0&"CE"[1:37:11];  EDITING(1,7); 03159000
                   EV[0]~"DI:DI";  FST~0;  EDITING(1,5);                03160000
                   EV[0]~"BY   ";  EDITING(1,2);                        03161000
                   IF SCAN(1) THEN GO TO LX;                            03162000
                   IF NOT GENERATE THEN STARTGEN;                       03163000
                   IF (I~CHECKNEXT(1))=2 THEN                           03164000
                   IF NXT.[42:6]!0 THEN GO TO LX ELSE                   03165000
                   IF SCAN(0) THEN GO TO LX ELSE                        03166000
                   BEGIN  IF NOT GENERATE THEN STARTGEN;                03167000
                     IF NCR>8 THEN                                      03168000
                     IF (NCR~LEADING0(EV[0],NCR))>8 THEN GO TO LX;      03169000
                     IOCVRT(J,EV[0],3,NCR,1);                           03170000
                     IF J>63 THEN J~J.[42:6];  GO TO L1;                03171000
                   END;                                                 03172000
                   IF I}10 THEN                                         03173000
                   BEGIN  IF NOT GENERATE THEN STARTGEN;                03174000
                     IF I<14 THEN ERROR;                                03175000
                     J~-IFX&REAL(I<14)[30:47:1];                        03176000
         L1:         I~CHECKNEXT(1);                                    03177000
                   END ELSE J~1;                                        03178000
                   IF I!0 THEN GO TO LX;                                03179000
                   IF IFX!BLK THEN GO TO LX;                            03180000
                   IF NOT GENERATE THEN STARTGEN;                       03181000
                   IF NCR!3 THEN                                        03182000
         L2:       BEGIN  ERROR;                                        03183000
                     E[0]~EV[0]&NCR[12:42:6];                           03184000
                     IF NCR>5 THEN TRNSFWDS(E[1],EV[1],(NCR+2).[36:9]); 03185000
                   END ELSE                                             03186000
                   IF K~EV[0].[18:18]="LIT" THEN                        03187000
                   IF J<0 THEN GO TO LX ELSE                            03188000
                   IF (I~CHECKNEXT(4&"""[36:42:6]))!8 THEN GO TO LX ELSE03189000
                   BEGIN  K~CC&NCD[9:27:21];                            03190000
                     CC~IF (I~CC.[30:3])=7 THEN CC.[33:15]+1 ELSE       03191000
                        CC&(I+1)[30:45:3];                              03192000
                     IF SCAN(7) THEN GO TO LX;                          03193000
                     IF NEWCARD THEN                                    03194000
                     BEGIN  IF GENERATE THEN CV[9].[47:1]~1;            03195000
                       BBB~0;  NEWCARD~FALSE;  NCE~NCD;                 03196000
                       IF REAL(RESQ)!1 THEN TRNSFWDS(ENO,CV[11],1);     03197000
                     END;                                               03198000
                     IF NXT.[36:6]=""" THEN                             03199000
                     BEGIN  EET.[30:3]~4;                               03200000
                       CC~IF (I~CC.[30:3])=7 THEN CC.[33:15]+1 ELSE     03201000
                          CC&(I+1)[30:45:3];                            03202000
                       IF SCAN(6) THEN BEGIN EET~EST; GO TO LX END;     03203000
                       EET~EST;                                         03204000
                     END ELSE                                           03205000
                     IF SCAN(6) THEN GO TO LX;                          03206000
                     IF J>NCR THEN                                      03207000
                     IF NCR!1 AND NCR!2 AND NCR!4 AND NCR!8 THEN        03208000
                     BEGIN  ADJUST(EV[0],NCR,J-NCR);  NCR~J;            03209000
                       IF NOT GENERATE THEN                             03210000
                       BEGIN CC0~K.[30:18]; NC0~K.[9:21]; STARTGEN END; 03211000
                     END;  LST~FST~0;                                   03212000
                     IF GENERATE THEN EDITING(2,NCR);                   03213000
                     IF J=NCR THEN GO TO LE;                            03214000
                     K~"CHR";  FST~LST~0;  GO TO L3;                    03215000
                   END ELSE                                             03216000
                   IF K!"CHR" THEN IF K!"WDS" THEN GO TO L2;            03217000
                   EV[0]~"SI:SI"; FST~0; EDITING(1,5);                  03218000
         L3:       EV[0]~"FOR  "; EDITING(1,3);                         03219000
                   IF J<0 THEN                                          03220000
                   BEGIN                                                03221000
                     IF BOOLEAN(J.[30:1]) THEN                          03222000
                     BEGIN                                              03223000
                       IF I~(EV[0]~-INFO[(J~-J).[35:5],J.[40:8]]).[12:6]03224000
                       >5 THEN                                          03225000
                       TRNSFWDS(EV[1],INFO[J.[35:5],J.[40:8]+1],        03226000
                       (I+2).[36:9]);                                   03227000
                       EDITING(1,I);                                    03228000
                     END ELSE REPEATFIELD(-J);  LST~0; GO TO L4;        03229000
                   END;                                                 03230000
                   EV[0]~IF J{9 THEN 0&J[18:42:6] ELSE                  03231000
                        0&(J DIV 10)[18:42:6]&ENTIER(J MOD 10)[24:42:6];03232000
                   EDITING(1,IF J{9 THEN 1 ELSE 2);                     03233000
         L4:       IF K="WDS" THEN                                      03234000
                   BEGIN EV[0]~"WORDS"; FST~0; EDITING(1,5) END ELSE    03235000
                   IF K!"CHR" THEN                                      03236000
                   BEGIN                                                03237000
                     IF K~(EV[0]~E[0]).[12:6]>5 THEN                    03238000
                     TRNSFWDS(EV[1],E[1],(K+2).[36:9]);                 03239000
                     FST~0; EDITING(1,K);                               03240000
                   END;                                                 03241000
         LE:  END  TRANSFER;                                            03242000
REAL PROCEDURE     RELEASTATEMENT;                                      03243000
              BEGIN                                                     03244000
       REAL        I,J;                                                 03245000
       LABEL       L1,LE;                                               03246000
                   ERROR;                                               03247000
                   IF GENERATE THEN EDITING(1,NCR);                     03248000
                   IF (I~CHECKNEXT(4&"("[36:42:6]))!8 THEN              03249000
         L1:       BEGIN RELEASTATEMENT~ERRSTREAM(-I); GO TO LE END;    03250000
                   J~LFX; LFX~NFX;  STRM~FALSE;                         03251000
                   I~BRACKET(")",1);  LFX~J;  STRM~TRUE;                03252000
                   IF I=0 THEN                                          03253000
                   IF NXT.[36:6]!";" THEN BEGIN I~-2; GO TO L1 END ELSE 03254000
                   I~2;                                                 03255000
                   IF I!4 THEN RELEASTATEMENT~I;                        03256000
         LE:  END  RELEASTATEMENT;                                      03257000
REAL PROCEDURE     STATEMENT(J,B,BNO);                                  03258000
     VALUE         J,B;                                                 03259000
     REAL          J,B;                                                 03260000
     ARRAY         BNO[0];                                              03261000
              BEGIN                                                     03262000
PROCEDURE          SETYPE(X,I);                                         03263000
     VALUE         X,I;                                                 03264000
     REAL          X,I;                                                 03265000
              BEGIN                                                     03266000
       BOOLEAN     ND;                                                  03267000
       ARRAY       E[0:8];                                              03268000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"SETYPE",NXT,X,I,NEWCD);          03269000
                   IF ND~(NEWCD AND NOT BOOLEAN(I)) THEN                03270000
                   BEGIN                                                03271000
                     NEWCD.[27:9]~BOOLEAN(BB);  BB~REAL(NEWCD).[36:9];  03272000
                   END;                                                 03273000
                   IF NOT GENERATE THEN                                 03274000
                   BEGIN STARTGEN; IF ND THEN CIVALID~FALSE END;        03275000
                   TRNSFWDS(E[0],EV[0],(NCR+10).[36:9]);                03276000
                   IF I!0 THEN                                          03277000
                   BEGIN  EV[0]~0&";"[18:42:6]; LST~4;                  03278000
                     EDITING(1,1);                                      03279000
                     IF NEWCD AND BOOLEAN(I) THEN EDITING(0,AVC) ELSE   03280000
                     LST~FST~0;                                         03281000
                   END;                                                 03282000
                   IF (I~(EV[0]~INFO[X.[35:5],X.[40:8]]).[12:6])>5 THEN 03283000
                   TRNSFWDS(EV[1],INFO[X.[35:5],X.[40:8]+1],            03284000
                            (I+2).[36:9]);                              03285000
                   EDITING(1,I);                                        03286000
                   EV[0]~0&"~"[18:42:6];  LST~4;  EDITING(1,1);         03287000
                   IF X>6 THEN LOCAL(X) ELSE                            03288000
                   BEGIN  EV[0]~"BOOLE"; EV[1]~0&"AN("[1:31:17];        03289000
                     EDITING(1,8);  LOCAL(X);                           03290000
                     EV[0]~0&")"[18:42:6];  EDITING(1,1);               03291000
                   END;  EV[0]~0&";"[18:42:6];  EDITING(1,1);           03292000
                   IF ND THEN                                           03293000
                   BEGIN BB~REAL(NEWCD).[27:9]; EDITING(0,AVC) END ELSE 03294000
                   LST~FST~0;                                           03295000
                   TRNSFWDS(EV[0],E[0],(NCR+10).[36:9]);                03296000
              END  SETYPE;                                              03297000
       REAL        I;                                                   03298000
       ARRAY       BGG[0:1];                                            03299000
       DEFINE      BGN=BOOLEAN(B)#;                                     03300000
       LABEL       L0,L1,L2,L3;                                         03301000
       LABEL       B0,B1,B12,B2,B3;                                     03302000
       LABEL       S0,S1,S2,S3;                                         03303000
       LABEL       LX,LE;                                               03304000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"STATMT",J,B);                    03305000
                   IF BGN THEN TRNSFWDS(BGG[0],BNO[0],1);  GO TO L1;    03306000
         L0:       J~CHECKNEXT(1);                                      03307000
         L1:       IF J=0 THEN                                          03308000
                   IF IFX=BLK THEN                                      03309000
                   BEGIN                                                03310000
                     IF NCR=2 THEN                                      03311000
                     IF J~EV[0].[18:12]="SI" THEN GO TO L2 ELSE         03312000
                     IF J="DI" THEN                                     03313000
         L2:         GO TO IF (J~SETPOINTER)=5 THEN S3 ELSE             03314000
                           IF BOOLEAN(J) THEN B0 ELSE                   03315000
                           IF J=0 THEN S0 ELSE S1  ELSE                 03316000
                     IF J="DS" THEN                                     03317000
                     GO TO IF (J~TRANSFER)=5 THEN S3 ELSE               03318000
                           IF BOOLEAN(J) THEN B0 ELSE                   03319000
                           IF J=0 THEN S0 ELSE S1  ELSE                 03320000
                     BEGIN J~0; GO TO LX END;                           03321000
                     IF NCR=5 THEN                                      03322000
                     IF EV[0].[18:30]="TALLY" THEN                      03323000
                     GO TO IF (J~TALLY)=5 THEN S3 ELSE                  03324000
                           IF BOOLEAN(J) THEN B0 ELSE                   03325000
                           IF J=0 THEN S0 ELSE S1;                      03326000
                     IF NCR=4 THEN                                      03327000
                     IF EV[0].[18:24]="JUMP" THEN                       03328000
                     GO TO IF (J~JUMPOUT)=5 THEN S3 ELSE                03329000
                           IF BOOLEAN(J) THEN B0 ELSE                   03330000
                           IF J=0 THEN S0 ELSE S1;                      03331000
         LX:         GO TO IF (J~ERRSTREAM(J))=5 THEN S3 ELSE           03332000
                           IF BOOLEAN(J) THEN B0 ELSE                   03333000
                           IF J=0 THEN S0 ELSE S1;                      03334000
                   END ELSE                                             03335000
                   IF IFX=DFX+17 THEN  % THE WORD "IF".                 03336000
                   GO TO IF (J~IFSTATEMENT)=5 THEN S3 ELSE              03337000
                         IF BOOLEAN(J) THEN B0 ELSE                     03338000
                         IF J=0 THEN S0 ELSE S1  ELSE                   03339000
                   IF IFX=DFX+21 THEN  % THE WORD "GO".                 03340000
                   GO TO IF (J~GOTO)=5 THEN S3 ELSE                     03341000
                         IF BOOLEAN(J) THEN B0 ELSE                     03342000
                         IF J=0 THEN S0 ELSE S1  ELSE                   03343000
                   IF IFX=DFX+28 THEN  % THE WORD "RELEASE".            03344000
                   GO TO IF (J~RELEASTATEMENT)=5 THEN S3 ELSE           03345000
                         IF BOOLEAN(J) THEN B0 ELSE                     03346000
                         IF J=0 THEN S0 ELSE S1  ELSE                   03347000
                   IF IFX}LFX THEN                                      03348000
                   BEGIN                                                03349000
                     IF GENERATE THEN EDITING(1,NCR);                   03350000
                     GO TO IF (J~CHECKNEXT(4&":"[36:42:6]))!8 THEN LX   03351000
                     ELSE S2;                                           03352000
                   END;                                                 03353000
                   IF J=2 THEN GO TO IF NXT.[42:6]=0 THEN L3 ELSE S1;   03354000
                   IF J}10 THEN                                         03355000
         L3:       GO TO IF (J~PARAMETER(IFX,J))=5 THEN S3 ELSE         03356000
                         IF BOOLEAN(J) THEN B0 ELSE                     03357000
                         IF J=0 THEN S0 ELSE S1;                        03358000
                   IF NOT BOOLEAN(J) THEN GO TO LX;                     03359000
         B0:       IF J=1 THEN                                          03360000
         B1:       BEGIN STATEMENT~J; GO TO LE END;                     03361000
                   IF J=3 THEN                                          03362000
                   BEGIN  % THE WORD "BEGIN".                           03363000
                     BLKCNT~BLKCNT+1;  TRNSFWDS(BGG[1],BGG[0],1);       03364000
                     IF DFINE THEN                                      03365000
                     BGNEND(FOU(0),1,BLKCNT,STR[0,48],1,STR[0,17],      03366000
                            BGG[0]) ELSE                                03367000
                     IF NC0=NCD-2 THEN                                  03368000
                     BGNEND(FOU(0),1,BLKCNT,PPC[11],0,BGG[1],BGG[0])ELSE03369000
                     IF NC0=NCD-1 THEN                                  03370000
                     BGNEND(FOU(0),1,BLKCNT,PC[11],0,BGG[1],BGG[0]) ELSE03371000
                     BGNEND(FOU(0),1,BLKCNT,CV[11],0,BGG[1],BGG[0]);    03372000
                     RELEASE(FOU);                                      03373000
                     IF GENERATE THEN EDITING(1,NCR);                   03374000
                     J~STATEMENT(CHECKNEXT(1),1,BGG);                   03375000
                     TRNSFWDS(BGG[0],BGG[1],1);                         03376000
                     GO TO IF BOOLEAN(J) THEN B0 ELSE S1;               03377000
                   END;                                                 03378000
                   IF BGN THEN                                          03379000
                   BEGIN  J~0;                                          03380000
         B12:        IF I~B.[34:13]!0 THEN SETYPE(I&B[1:1:1],J);        03381000
                     IF DFINE THEN                                      03382000
                     BGNEND(FOU(0),0,BLKCNT,STR[0,48],1,STR[0,17],      03383000
                            BGG[0]) ELSE                                03384000
                     IF NC0=NCD-2 THEN                                  03385000
                     BGNEND(FOU(0),0,BLKCNT,PPC[11],0,BGG[1],BGG[0])ELSE03386000
                     IF NC0=NCD-1 THEN                                  03387000
                     BGNEND(FOU(0),0,BLKCNT,PC[11],0,BGG[1],BGG[0]) ELSE03388000
                     BGNEND(FOU(0),0,BLKCNT,CV[11],0,BGG[1],BGG[0]);    03389000
                     RELEASE(FOU);                                      03390000
                     BLKCNT~BLKCNT-1;                                   03391000
         B2:         IF GENERATE THEN EDITING(1,NCR);                   03392000
         B3:         I~LFX; LFX~NFX;  ENDCMMT~TRUE;                     03393000
                     J~CHECKNEXT(1);  LFX~I;  ENDCMMT~FALSE;            03394000
                     IF BOOLEAN(J) THEN                                 03395000
                     GO TO IF J=3 THEN B2 ELSE B1;                      03396000
                     IF J=2 THEN                                        03397000
                     GO TO IF I~NXT.[36:6]=";" THEN B1 ELSE             03398000
                           IF I=")" THEN B1 ELSE IF I="." THEN B1 ELSE  03399000
                           IF SCAN(IF NXT.[42:6]=4 THEN 1 ELSE 0) THEN  03400000
                           B3 ELSE B2;                                  03401000
                     IF J=0 THEN                                        03402000
                     IF IFX=DFX+9 THEN BEGIN J~6; GO TO B1 END;         03403000
                     GO TO B2;                                          03404000
                   END ELSE GO TO B1;                                   03405000
         S0:       J~CHECKNEXT(1);                                      03406000
                   IF J=6 THEN GO TO LX ELSE                            03407000
                   IF J=0 THEN IF IFX=DFX+9 THEN J~6;                   03408000
         S1:       IF J=2 THEN                                          03409000
                   BEGIN                                                03410000
                     IF I~NXT.[36:6]=";" THEN                           03411000
                     IF BGN THEN                                        03412000
                     BEGIN                                              03413000
         S2:           IF NOT SCAN(1) THEN                              03414000
                       IF GENERATE THEN EDITING(1,1);  GO TO L0;        03415000
                     END ELSE                                           03416000
                     BEGIN                                              03417000
                       IF I~B.[34:13]!0 THEN                            03418000
                       BEGIN NC0~NCD; CC0~CC; SETYPE(I&B[1:1:1],1) END; 03419000
                       GO TO B1;                                        03420000
                     END;  GO TO IF NXT.[36:6]=")" THEN B1 ELSE LX;     03421000
                   END;                                                 03422000
                   IF J=6 THEN GO TO B1;                                03423000
                   IF J=5 THEN                                          03424000
         S3:       IF BGN THEN BEGIN J~2; GO TO B12 END ELSE GO TO B1;  03425000
                   GO TO LX;                                            03426000
         LE:  END  STATEMENT;                                           03427000
       INTEGER     I,J,K,L,V,X,Y,NP;                                    03428000
       ARRAY       BGG[0:1],A[0:14];                                    03429000
       LABEL       L1,L2,L3,L4,L5,L6;                                   03430000
       LABEL       B1,B2,B3,B4,B5,B6,B7,B8,B9;                          03431000
       LABEL       G0,G1,G2,G3,G4,G5;                                   03432000
       LABEL       P0,P1;                                               03433000
       LABEL       LX,LX1,LX2,LX3;                                      03434000
       LABEL       LE,LEX;                                              03435000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"STREAM",NXT,TP);                 03436000
                   IF DFINE THEN                                        03437000
                   BEGIN I~CHECKNEXT(1); GO TO LX END;                  03438000
COMMENT  SKIP THE WORD "STREAM" WHICH HAS BEEN ALREADY SCANNED BEFORE   03439000
         THE ENTRY TO THIS PROCEDURE, AND CHECK THE WORD "PROCEDURE";   03440000
                   IF NOT GENERATE THEN BEGIN STARTGEN; BBK~FALSE END;  03441000
                   IF BOOLEAN(I~CHECKNEXT(1)) THEN                      03442000
         LX:       BEGIN                                                03443000
                     IF DFINE THEN ERRDFN~1 ELSE                        03444000
                     IF I=2 THEN CV[9].[36:6]~ERX~1 ELSE                03445000
                     BEGIN ERROR; CI[9].[36:6]~1 END;                   03446000
                     IF BOOLEAN(I) THEN GO TO LX1;                      03447000
                     LFX~NFX;  I~REAL(SKIPUNTIL(";"));  LFX~1;          03448000
                     IF NOT BOOLEAN(I) THEN                             03449000
                     IF NOT SCAN(1) THEN                                03450000
                     IF GENERATE THEN EDITING(1,1);  % EDIT ";".        03451000
         LX1:        STREAMPROCEDURE~IF I=3 THEN BLOCK(1) ELSE          03452000
                     IF BOOLEAN(I) THEN I ELSE BLOCK(0);  GO TO LEX;    03453000
                   END;                                                 03454000
                   IF I!0 THEN GO TO LX;                                03455000
                   IF IFX!6 THEN GO TO LX;                              03456000
COMMENT  CHECK THE STREAM PROCEDURE IDENTIFIER AND THE "(" MUST BE ALSO 03457000
         IMMEDIATELY FOLLOWING.  THE PROCEDURE ID IS TEMPORARILY STORED 03458000
         IN A[*];                                                       03459000
                   CV[9].[36:6]~ERX~1;  % FLAG ERROR ON PROCEDURE ID.   03460000
                   LFX~NFX;  I~CHECKNEXT(1);  LFX~1;                    03461000
                   IF I!0 THEN GO TO LX;                                03462000
                   IF IFX{RFX THEN GO TO LX;                            03463000
                   A[1]~EV[0]&NCR[1:31:17];                             03464000
                   IF NCR{5 THEN J~0 ELSE                               03465000
                   TRNSFWDS(A[2],EV[1],J~(NCR+2).[39:6]);               03466000
                   IF (I~CHECKNEXT(4&"("[36:42:6]))!8 THEN GO TO LX;    03467000
                   IF NOT SCAN(1) THEN                                  03468000
                   IF GENERATE THEN EDITING(1,1);  % EDIT "(".          03469000
COMMENT  FROM NOW ON AND AS LONG AS WITHIN THE STREAM PROCEDURE, NO     03470000
         DEFINE IS PERMITTED.  ALL THE DEFINE IDENTIFIERS ARE TREATED   03471000
         AS UNDECLARED INDENTIFIER.  *********  IMPORTANT NOTE  ********03472000
         MARK INFO[*,*] BY SETTING "LFX" TO "NFX".  STORE THE PROCEDURE 03473000
         IDENTIFIER TO INFO[*,*] IF IT IS DECLARED WITH A TYPE;         03474000
                   IF DFINE THEN GO TO LX;                              03475000
                   A[0]~(J+1)&1[1:45:3];  A[J+2]~0;  STRM~TRUE;         03476000
                   LFX~IF TP THEN INFOENTRY(A,J+3)  % ENTER TYPD PRO ID.03477000
                       ELSE NFX;                                        03478000
COMMENT  START TO SCAN FOR THE FORMAL PARAMETERS AND ENTER THEM TO      03479000
         INFO[*,*] AS CALLED BY NAME FIRST;                             03480000
         L1:       IF (I~CHECKNEXT(1))!0 THEN                           03481000
         LX2:      BEGIN  STRM~FALSE;                                   03482000
                     IF I=9 THEN I~0 ELSE                               03483000
                     IF I!2 AND NOT BOOLEAN(I) THEN                     03484000
                     IF GENERATE THEN EDITING(1,NCR);                   03485000
                     IF LFX<NFX THEN INFOREMOVE(LFX);  LFX~1;  GO TO LX;03486000
                   END;                                                 03487000
                   IF IFX!BLK THEN GO TO LX2;                           03488000
                   IF GENERATE THEN EDITING(1,NCR);                     03489000
                   B[1]~EV[0]&NCR[1:31:17];                             03490000
                   IF NCR{5 THEN I~0 ELSE                               03491000
                   TRNSFWDS(B[2],EV[1],I~(NCR+2).[39:6]);               03492000
                   B[0]~(I+1)&3[1:45:3];  B[I+2]~0;                     03493000
                   I~INFOENTRY(B,I+3);                                  03494000
                   IF (NP~NP+1)=1 THEN IF NOT TP THEN LFX~I;            03495000
                   IF (I~CHECKNEXT(4&","[36:42:6]))=8 THEN              03496000
                   BEGIN                                                03497000
                     IF NOT SCAN(1) THEN                                03498000
                     IF GENERATE THEN EDITING(1,1);  GO TO L1;          03499000
                   END;                                                 03500000
                   IF BOOLEAN(I) THEN GO TO LX2;                        03501000
                   IF NXT.[36:6]!")" THEN GO TO LX2;                    03502000
                   IF NOT SCAN(1) THEN                                  03503000
                   IF GENERATE THEN EDITING(1,1);                       03504000
                   IF (I~CHECKNEXT(4&";"[36:42:6]))!8 THEN GO TO LX2;   03505000
                   B[5]~X~0;                                            03506000
                   IF NOT SCAN(1) THEN                                  03507000
                   IF GENERATE THEN EDITING(X~1,1);  % EDIT ";".        03508000
COMMENT  SCAN FOR VALUE DECLARATIONS AND MODIFY THE VALUE LIST TO       03509000
         INCLUDE ALL THE FORMAL PARAMETERS.  ALSO CHANGE THE ORIGINAL   03510000
         VALUE LIST INTO THE REAL SPECIFICATION;                        03511000
                   B[0]~REAL(NEWCARD);  TRNSFWDS(B[1],ENO,1);  B[2]~NCE;03512000
                   IF (I~CHECKNEXT(1))!0 OR IFX!28 THEN                 03513000
                   BEGIN  % NO VALUE IS SPECIFIED ORIGINALLY.           03514000
                     IF GENERATE THEN B[0]~0 ELSE                       03515000
                     BEGIN                                              03516000
                       IF BOOLEAN(B[0]) THEN                            03517000
                       BEGIN  GENERATE~TRUE;  CIVALID~FALSE;            03518000
                         TRNSFWDS(CI[10],B[1],2);  LST~4;               03519000
                         SQ1ST~BOOLEAN(X);                              03520000
                         TRNSFWDS(B[1],ENO,1);  B[2]~NCE;               03521000
                         TRNSFWDS(ENO,CI[10],1);  NCE~CI[11];           03522000
                       END ELSE STARTGEN;                               03523000
                     END;                                               03524000
                     IF I!2 THEN                                        03525000
                     TRNSFWDS(B[6],EV[0],((B[5]~NCR)+10).[39:6]);       03526000
                     EV[0]~"VALUE";  FST~0;  EDITING(1,5);              03527000
                     K~HFX;  GO TO L2;                                  03528000
                   END;                                                 03529000
                   IF NOT GENERATE THEN                                 03530000
                   BEGIN  STARTGEN;                                     03531000
                     IF BOOLEAN(B[0]) THEN                              03532000
                     BEGIN  TRNSFWDS(B[1],ENO,1);  B[2]~NCE;            03533000
                       TRNSFWDS(CI[10],B[1],2);                         03534000
                     END;                                               03535000
                   END;                                                 03536000
                   EDITING(1,NCR);  % THE WORD "VALUE".                 03537000
                   K~HFX;  FST~0;  GO TO L2;                            03538000
                   DO BEGIN                                             03539000
                     EV[0]~0&","[18:42:6];  FST~4;  EDITING(1,1);       03540000
         L2:         EV[0]~(P~INFO[X~K.[35:5],Y~K.[40:8]]);             03541000
                     IF (P~P.[12:6])>5 THEN                             03542000
                     TRNSFWDS(EV[1],INFO[X,Y+1],(P+2).[39:6]);          03543000
                     EDITING(1,P);                                      03544000
                   END UNTIL (K~K-INFO[X,Y-1].[25:8])<(IF TP THEN LFX+1 03545000
                             ELSE LFX);                                 03546000
                   EV[0]~0&";"[18:42:6];  FST~4;  EDITING(1,1);         03547000
                   IF BOOLEAN(B[0]) THEN EDITING(0,AVC) ELSE LST~FST~0; 03548000
                   IF I!0 OR IFX!28 THEN                                03549000
                   BEGIN B[4]~V~0; INF[1]~BB; GO TO L4 END;             03550000
                   EV[0]~"REAL ";  EDITING(1,4);  BBK~TRUE;             03551000
         L3:       IF (I~CHECKNEXT(1))<10 THEN GO TO LX2;               03552000
                   IF GENERATE THEN EDITING(1,NCR);  V~V+1;             03553000
                   INFO[IFX.[35:5],IFX.[40:8]-1].[1:3]~1;               03554000
                   IF (I~CHECKNEXT(4&","[36:42:6]))=8 THEN              03555000
                   BEGIN                                                03556000
                     IF NOT SCAN(1) THEN                                03557000
                     IF GENERATE THEN EDITING(1,1);  GO TO L3;          03558000
                   END;                                                 03559000
                   IF I!2 THEN GO TO LX2;                               03560000
                   IF NXT.[36:6]!";" THEN GO TO LX2;                    03561000
                   IF NOT SCAN(1) THEN                                  03562000
                   IF GENERATE THEN EDITING(1,1);                       03563000
                   IF BOOLEAN(B[0]~REAL(NEWCARD)) THEN                  03564000
                   IF GENERATE THEN                                     03565000
                   BEGIN                                                03566000
                     IF CIVALID THEN EDITING(0,AVC);  GENERATE~FALSE;   03567000
                   END;                                                 03568000
                   TRNSFWDS(B[1],ENO,1);  B[2]~NCE;                     03569000
                   Y~REAL(GENERATE); GENERATE~FALSE; X~CBX;CBX~-1; K~BB;03570000
                   I~CHECKNEXT(1);  CBX~X;  GENERATE~BOOLEAN(Y);        03571000
                   INF[1]~BB;  BB~K;                                    03572000
                   IF BOOLEAN(I) THEN                                   03573000
                   IF I!3 THEN GO TO LX2;                               03574000
                   IF NP<V THEN GO TO LX2;                              03575000
                   IF NP=(B[4]~V) THEN GO TO L5;                        03576000
COMMENT  ADD TO THE PROCEDURE THE POINTER SPECIFICATION PART.  ALL THE  03577000
         FORMAL PARAMETERS WHICH ARE NOT CALLED BY VALUE WILL BE LISTED 03578000
         IN THE POINTER LIST;                                           03579000
                   IF I!2 THEN                                          03580000
                   TRNSFWDS(B[6],EV[0],((B[5]~NCR)+10).[39:6]);         03581000
                   IF GENERATE THEN B[0]~0 ELSE                         03582000
                   BEGIN                                                03583000
                     IF BOOLEAN(B[0]~REAL(NEWCARD)) THEN                03584000
                     BEGIN  GENERATE~TRUE;  CIVALID~FALSE;              03585000
                       TRNSFWDS(CI[10],B[1],2);  LST~4;                 03586000
                       TRNSFWDS(B[1],ENO,1);  B[2]~NCE;                 03587000
                       TRNSFWDS(ENO,CI[10],1);  NCE~CI[11];             03588000
                     END ELSE STARTGEN;                                 03589000
                   END;                                                 03590000
                   IF NP!V THEN                                         03591000
         L4:       BEGIN                                                03592000
                     EV[0]~"POINT"; EV[1]~0&"ER"[1:37:11]; EDITING(1,7);03593000
                     FST~0;                                             03594000
                   END;                                                 03595000
         L5:       A[J~((B[3]~NP)+7).[36:9]+A[0].[40:8]]~0;             03596000
                   A[0].[4:8]~J+1;  % NO. OF WORDS IN THE ENTRY.        03597000
                   K~HFX;  V~NP-V;  NP~NP|6+3;                          03598000
                   DO BEGIN                                             03599000
                     IF (P~INFO[X~K.[35:5],(Y~K.[40:8])-1]).[1:3]=3 THEN03600000
                     BEGIN                                              03601000
                       IF L~(EV[0]~INFO[X,Y]).[12:6]>5 THEN             03602000
                       TRNSFWDS(EV[1],INFO[X,Y+1],(L+2).[39:6]);        03603000
                       EDITING(1,L);                                    03604000
                       EV[0]~0&(IF V~V-1=0 THEN ";" ELSE ",")[18:42:6]; 03605000
                       FST~4;  EDITING(1,1);                            03606000
                       IF V=0 THEN EDITING(0,AVC);                      03607000
                     END;                                               03608000
                     IF NP~NP-6<3 THEN BEGIN NP~45; A[J~J-1]~0 END;     03609000
                     TRNSFBTS(A[J],P,NP,1,3);                           03610000
                   END UNTIL (K~K-P.[25:8])<(IF TP THEN LFX+1 ELSE LFX);03611000
COMMENT  CHECK THE WORD "BEGIN".  IF THE ORIGINAL STREAM PROCEDURE DOES 03612000
         NOT HAVE ONE, ADD ONE TO IT;                                   03613000
                   NP~B[3];  V~B[4];  L~0;                              03614000
                   IF I=3 THEN                                          03615000
                   BEGIN                                                03616000
                     IF BOOLEAN(B[0]) THEN                              03617000
                     BEGIN                                              03618000
                       IF GENERATE THEN                                 03619000
                       BEGIN  IF CIVALID THEN EDITING(0,AVC);           03620000
                         GENERATE~FALSE;                                03621000
                       END;  TRNSFWDS(ENO,B[1],1);                      03622000
                       X~NCE; NCE~B[2];  Y~REAL(NEWCARD); NEWCARD~TRUE; 03623000
                       TRNSFWDS(INF[0],CV[11],1);TRNSFWDS(CV[11],ENO,1);03624000
                       OUTPUTNEW(X);                                    03625000
                       NEWCARD~BOOLEAN(Y);  TRNSFWDS(CV[11],INF[0],1);  03626000
                     END;                                               03627000
                     BLKCNT~BLKCNT+1;                                   03628000
                     IF DFINE THEN                                      03629000
                     BGNEND(FOU(0),1,BLKCNT,STR[0,48],1,STR[0,17],      03630000
                            BGG[0]) ELSE                                03631000
                     IF NC0=NCD-2 THEN                                  03632000
                     BGNEND(FOU(0),1,BLKCNT,PPC[11],0,BGG[1],BGG[0])ELSE03633000
                     IF NC0=NCD-1 THEN                                  03634000
                     BGNEND(FOU(0),1,BLKCNT,PC[11],0,BGG[1],BGG[0]) ELSE03635000
                     BGNEND(FOU(0),1,BLKCNT,CV[11],0,BGG[1],BGG[0]);    03636000
                     RELEASE(FOU);                                      03637000
                     IF NOT BOOLEAN(B[0]~REAL(NEWCARD)) THEN            03638000
                     BEGIN                                              03639000
                       IF NOT GENERATE THEN STARTGEN;                   03640000
                       EV[0]~"BEGIN";  EDITING(1,5);                    03641000
                     END;  BB~INF[1];  GO TO B5;                        03642000
                   END ELSE                                             03643000
                   BEGIN                                                03644000
                     IF I=0 AND IFX=DFX+25 THEN                         03645000
                     BEGIN  % THIS IS A FORWARD DECLARATION.            03646000
                       IF BOOLEAN(B[0]) THEN                            03647000
                       BEGIN                                            03648000
                         IF GENERATE THEN                               03649000
                         BEGIN  IF CIVALID THEN EDITING(0,AVC);         03650000
                           GENERATE~FALSE;                              03651000
                         END;  TRNSFWDS(ENO,B[1],1);  X~NCE; NCE~B[2];  03652000
                         Y~REAL(NEWCARD);  NEWCARD~TRUE;                03653000
                         TRNSFWDS(INF[0],CV[11],1);                     03654000
                         TRNSFWDS(CV[11],ENO,1);  OUTPUTNEW(X);         03655000
                         NEWCARD~BOOLEAN(Y);  TRNSFWDS(CV[11],INF[0],1);03656000
                       END;                                             03657000
                       IF GENERATE THEN                                 03658000
                       BEGIN  TRNSFWDS(EV[0],B[6],(B[5]+10).[39:6]);    03659000
                         EDITING(1,7);                                  03660000
                       END;                                             03661000
                       IF (J~CHECKNEXT(4&";"[36:42:6]))!8 THEN GO LX3;  03662000
                       IF NOT SCAN(1) THEN                              03663000
                       IF GENERATE THEN EDITING(1,1);  GO TO LE;        03664000
                     END;                                               03665000
                     IF BOOLEAN(B[0]) THEN EDITING(0,AVC)ELSE LST~FST~0;03666000
                     EV[0]~"BEGIN";  EDITING(1,5);                      03667000
                     IF BOOLEAN(B[0]) THEN EDITING(0,AVC);              03668000
                     J~I;  B[4]~BB;  BB~INF[1];  GO TO B8;              03669000
                   END;                                                 03670000
COMMENT  PROCESS THE LABEL DECLARATIONS IF THERE ARE ANY.  ALSO MODIFY  03671000
         THE LOCAL-DECLARATIONS INTO THE POINTER-DECLARATIONS;          03672000
         B1:       IF X="LABEL" THEN                                    03673000
                   BEGIN                                                03674000
                     IF GENERATE THEN EDITING(1,NCR);                   03675000
         B2:         K~LFX; STRM~FALSE; J~DONTCARE(1); LFX~K; STRM~TRUE;03676000
                     IF J!8 THEN                                        03677000
         LX3:        IF (J~ERRSTREAM(-J))=1 THEN                        03678000
                     BEGIN STREAMPROCEDURE~1; GO TO LE END ELSE         03679000
                     GO TO IF BOOLEAN(J) THEN B7 ELSE B4;               03680000
                     IF (J~CHECKNEXT(4&","[36:42:6]))=8 THEN            03681000
                     BEGIN                                              03682000
                       IF NOT SCAN(1) THEN                              03683000
                       IF GENERATE THEN EDITING(1,1);  GO TO B2;        03684000
                     END;                                               03685000
                     IF J=2 THEN                                        03686000
                     IF NXT.[36:6]=";" THEN GO TO B4;  GO TO LX3;       03687000
                   END;                                                 03688000
                   IF NOT GENERATE THEN STARTGEN;                       03689000
                   EV[0]~"POINT"; EV[1]~0&"ER"[1:37:11];  EDITING(1,7); 03690000
         B3:       IF J~CHECKNEXT(1)!0 THEN GO TO LX3;                  03691000
                   IF IFX!BLK THEN GO TO LX3;                           03692000
                   IF GENERATE THEN EDITING(1,NCR);                     03693000
                   INF[1]~EV[0]&NCR[1:31:17];                           03694000
                   IF NCR{5 THEN J~0 ELSE                               03695000
                   TRNSFWDS(INF[2],EV[1],J~(NCR+2).[39:6]);             03696000
                   INF[0]~(J+1)&3[1:45:3];  INF[J+2]~0;                 03697000
                   J~INFOENTRY(INF,J+3);  L~L+1;                        03698000
                   IF (J~CHECKNEXT(4&","[36:42:6]))=8 THEN              03699000
                   BEGIN                                                03700000
                     IF NOT SCAN(1) THEN                                03701000
                     IF GENERATE THEN EDITING(1,1);  GO TO B3;          03702000
                   END;                                                 03703000
                   IF J=1 THEN GO TO LX3;                               03704000
                   IF NXT.[36:6]=";" THEN                               03705000
                   BEGIN                                                03706000
         B4:         IF NOT SCAN(1) THEN                                03707000
                     IF GENERATE THEN BEGIN T~0; EDITING(1,1) END ELSE  03708000
                     T~1;                                               03709000
         B5:         IF NEWCARD THEN                                    03710000
                     IF GENERATE THEN                                   03711000
                     BEGIN  IF CIVALID THEN EDITING(0,AVC);             03712000
                       GENERATE~FALSE;                                  03713000
                     END;                                               03714000
                     B[0]~REAL(NEWCARD);                                03715000
                     Y~REAL(GENERATE);  GENERATE~FALSE;  X~CBX; CBX~-1; 03716000
                     K~BB;  J~CHECKNEXT(1);  B[4]~BB;  BB~K;            03717000
                     CBX~X;  GENERATE~BOOLEAN(Y);                       03718000
                     IF J=1 THEN GO TO LX3;                             03719000
         B6:         IF J!0 THEN GO TO B7;                              03720000
                     IF NCR!5 THEN GO TO B7;                            03721000
                     IF X~EV[0].[18:30]!"LABEL" THEN                    03722000
                     IF X!"LOCAL" THEN GO TO B7;                        03723000
                     OUTPUTNEW(NCE);                                    03724000
                     TRNSFWDS(B[1],ENO,1);  B[2]~NCE;  BB~B[4];         03725000
                     GO TO B1;                                          03726000
                   END;                                                 03727000
         B7:       IF J!2 THEN                                          03728000
                   TRNSFWDS(B[6],EV[0],((B[5]~NCR)+10).[39:6]);         03729000
                   IF GENERATE THEN B[0]~0 ELSE                         03730000
                   BEGIN                                                03731000
                     IF BOOLEAN(B[0]) THEN                              03732000
                     BEGIN  GENERATE~TRUE;  CIVALID~FALSE;              03733000
                       TRNSFWDS(CI[10],B[1],2); LST~4; SQ1ST~BOOLEAN(T);03734000
                       TRNSFWDS(B[1],ENO,1);  B[2]~NCE;                 03735000
                       TRNSFWDS(ENO,CI[10],1);  NCE~CI[11];             03736000
                     END ELSE STARTGEN;                                 03737000
                   END;                                                 03738000
COMMENT  ADD TO THE PROCEDURE THE POINTER DECLARATIONS OF "DI" & "SI";  03739000
         B8:       EV[0]~"POINT"; EV[1]~0&"ER"[1:37:11];  EDITING(1,7); 03740000
                   EV[0]~";DI,SI";  TRNSFCHR(EV[1],EV[0],0,2,1);        03741000
                   FST~0;  EDITING(1,6);                                03742000
                   IF BOOLEAN(B[0]) THEN EDITING(0,AVC) ELSE LST~FST~0; 03743000
COMMENT  ADD TO THE PROCEDURE THE REAL DECLARATION OF "TALLY";          03744000
                   EV[0]~"REAL ";  EDITING(1,4);                        03745000
                   EV[0]~";TALLY";  TRNSFCHR(EV[1],EV[0],0,2,1);        03746000
                   EDITING(1,6);                                        03747000
                   IF BOOLEAN(B[0]) THEN EDITING(0,AVC) ELSE LST~FST~0; 03748000
COMMENT  ADD TO THE PROCEDURE THE ARRAY DECLARATION OF "LOCAL[*]";      03749000
                   EV[1]~NP+(IF TP THEN L ELSE L-1);                    03750000
                   EV[0]~"ARRAY";  EDITING(1,5);  FST~0;                03751000
                   EV[0]~"LOCAL";  EDITING(1,5);  FST~4;                03752000
                   EV[0]~"[0:  ";  EDITING(1,3);  FST~EV[0]~0;          03753000
                   IF EV[1]=0 THEN EV[0]~K~1 ELSE                       03754000
                   BEGIN  X~K~5;  IOCVRT(X,EV[1],3,5,0);  GO TO B9;     03755000
                     DO BEGIN                                           03756000
                       K~K-1;  X~0&X[18:24:24];                         03757000
         B9:         END UNTIL X.[18:6]!0;  EV[0]~X;                    03758000
                   END;                                                 03759000
                   EDITING(1,K);  FST~4;                                03760000
                   EV[0]~"];   ";  EDITING(1,2);                        03761000
                   IF BOOLEAN(B[0]) THEN EDITING(0,AVC) ELSE LST~FST~0; 03762000
COMMENT  ASSIGN THE INDEX OF LOCAL[*] TO ALL THE VARIABLE IN INFO[*,*]. 03763000
         AND GENERATE THE ASSIGNMENT STATEMENTS TO ASSIGN THOSE FORMAL  03764000
         PARAMETERS WHICH ARE CALLED BY VALUE INTO "LOCAL[*]";          03765000
         G0:       T~R~0;  K~HFX;  BB~B[4];                             03766000
                   IF (NP~L)!0 THEN                                     03767000
         G1:       DO BEGIN                                             03768000
                     IF (P~INFO[X~K.[35:5],(Y~K.[40:8])-1]).[1:3]=1 THEN03769000
                     IF BOOLEAN(R) THEN                                 03770000
                     BEGIN                                              03771000
                       EV[0]~"LOCAL"; EV[1]~0&"["[1:43:5]; EDITING(1,6);03772000
                       IF T=0 THEN Z~EV[0]~1 ELSE                       03773000
                       BEGIN Z~EV[0]~5; IOCVRT(EV[0],T,3,5,0); GO TO G2;03774000
                         DO BEGIN                                       03775000
                           Z~Z-1;  EV[0]~0&EV[0][18:24:24];             03776000
         G2:             END UNTIL EV[0].[18:6]!0;                      03777000
                       END;  EDITING(1,Z);                              03778000
                       INFO[X,Y-1].[1:3]~5;                             03779000
                       INFO[X,Y+P.[40:8]]~EV[0]&Z[12:42:6];             03780000
                       EV[0]~"]~   "; FST~4;  EDITING(1,2);             03781000
                       IF (Z~(EV[0]~INFO[X,Y]).[12:6])>5 THEN           03782000
                       TRNSFWDS(EV[1],INFO[X,Y+1],(Z+2).[39:6]);        03783000
                       EDITING(1,Z);                                    03784000
                       EV[0]~0&";"[18:42:6]; EDITING(1,1); LST~FST~0;   03785000
                       T~T-1;  NP~NP-1;                                 03786000
                     END ELSE GO TO G3  ELSE                            03787000
                     IF P.[1:3]=3 THEN                                  03788000
         G3:         BEGIN  INFO[X,Y-1].[1:3]~P.[1:3]+4;                03789000
                       IF T=0 THEN Z~EV[0]~1 ELSE                       03790000
                       BEGIN Z~EV[0]~5; IOCVRT(EV[0],T,3,5,0); GO TO G4;03791000
                         DO BEGIN                                       03792000
                           Z~Z-1;  EV[0]~0&EV[0][18:24:24];             03793000
         G4:             END UNTIL EV[0].[18:6]!0;                      03794000
                       END;  INFO[X,Y+P.[40:8]]~EV[0]&Z[12:42:6];       03795000
                       T~T+(IF R!0 THEN -1 ELSE 1);                     03796000
                       NP~NP-1;                                         03797000
                     END;  K~K-P.[25:8];                                03798000
                   END UNTIL NP{0;                                      03799000
                   IF (R~R+1)=1 THEN                                    03800000
                   BEGIN T~(NP~B[3])+(IF TP THEN T ELSE T-1); GO G1 END;03801000
                   IF R=2 THEN                                          03802000
                   IF TP THEN BEGIN NP~1; GO TO G1 END;                 03803000
                   NP~B[3];                                             03804000
         G5:       IF BOOLEAN(B[0]) THEN                                03805000
                   BEGIN  EDITING(0,AVC);  TRNSFWDS(ENO,B[1],1);        03806000
                     X~NCE; NCE~B[2];  NEWCARD~TRUE;                    03807000
                     TRNSFWDS(INF[0],CV[11],1); TRNSFWDS(CV[11],ENO,1); 03808000
                     OUTPUTNEW(X);  TRNSFWDS(CV[11],INF[0],1);          03809000
                     GENERATE~FALSE;                                    03810000
                   END ELSE                                             03811000
                   BEGIN LST~FST~0; TRNSFWDS(ENO,B[1],1); NCE~B[2] END; 03812000
                   IF J!2 THEN                                          03813000
                   TRNSFWDS(EV[0],B[6],((NCR~B[5])+10).[39:6]);         03814000
         P0:       IF (J~STATEMENT(J,IF TP THEN REAL(I=3)&LFX[34:35:13] 03815000
                       &REAL(TP)[1:45:1] ELSE REAL(I=3),BGG))!2 THEN    03816000
         P1:       BEGIN STREAMPROCEDURE~ERRSTREAM(J); GO TO LE END;    03817000
                   IF NXT.[36:6]!";" THEN GO TO P1;                     03818000
                   IF NOT BOOLEAN(I) THEN                               03819000
                   BEGIN                                                03820000
                     IF GENERATE THEN                                   03821000
                     BEGIN IF CIVALID THEN EDITING(0,AVC) END ELSE      03822000
                     BEGIN STARTGEN; EDITING(0,AVC) END;                03823000
                     EV[0].[18:18]~"END";  EDITING(1,3);                03824000
                   END;                                                 03825000
                   IF NOT SCAN(1) THEN                                  03826000
                   IF GENERATE THEN EDITING(1,1);                       03827000
         LE:       INFOREMOVE(LFX);  LFX~1;  STRM~FALSE;                03828000
                   I~INFOENTRY(A,A[0].[4:8]);                           03829000
         LEX: END  STREAMPROCEDURE;                                     03830000
REAL PROCEDURE     FILENAME;                                            03831000
COMMENT ................................................................03832000
:    THIS PROCEDURE ADDS A "/" IN BETWEEN THE TWO SYMBOLIC FILE NAMES  :03833000
:IF THERE ARE ANY.                                                     :03834000
:    VALUE OF RESULT:  0:  STOPPED AT AN ABSOLUTE RESERVED WORD.       :03835000
:                      1:  STOPPED AT END-OF-FILE.                     :03836000
:                      2:  STOPPED AT A DIGIT OR A SPECIAL CHARACTER.  :03837000
:                      3:  STOPPED AT "BEGIN".                         :03838000
:                      5:  STOPPED AT "END".                           :03839000
:                      8:  SUCCESSFULLY PROCESSED.                     :03840000
:                              --------  J. C. PAO   05/06/68  --------:03841000
:......................................................................;03842000
              BEGIN                                                     03843000
       REAL        I;                                                   03844000
       LABEL       L0,L1,LX,LE;                                         03845000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"FILENM",NXT);                    03846000
         L0:       IF (I~DONTCARE(1))!8 THEN                            03847000
                   BEGIN                                                03848000
                     IF I=0 THEN                                        03849000
                     IF IFX=DFX+13 THEN GO TO L0 ELSE                   03850000
                     IF IFX=DFX+15 THEN GO TO L0;                       03851000
                     FILENAME~I;  GO TO LE;                             03852000
                   END;                                                 03853000
         L1:       IF (I~CHECKNEXT(4&";"[36:42:6]))=8 THEN              03854000
                   BEGIN                                                03855000
                     IF NOT SCAN(1) THEN                                03856000
                     IF GENERATE THEN EDITING(1,1);                     03857000
                     FILENAME~8;  GO TO LE;                             03858000
                   END;                                                 03859000
                   IF BOOLEAN(I) THEN GO TO LX;                         03860000
                   IF I!2 THEN GO TO L1;                                03861000
                   IF I~NXT.[36:6]=""" THEN                             03862000
                   BEGIN  STRING;                                       03863000
                     IF BOOLEAN(I~CHECKNEXT(1)) THEN GO TO LX;          03864000
                     IF I=2 THEN                                        03865000
                     IF NXT.[36:6]=""" THEN                             03866000
                     IF DFINE THEN                                      03867000
                     BEGIN IF LLF<0 THEN STR[0,0].[47:1]~1 END ELSE     03868000
                     BEGIN                                              03869000
                       CC0~CC;  NC0~NCD;                                03870000
                       IF NOT GENERATE THEN STARTGEN;                   03871000
                       EV[0]~0&"/"[18:42:6];  EDITING(1,1);             03872000
                       STRING;                                          03873000
                     END;  GO TO L1;                                    03874000
                   END;                                                 03875000
                   IF I="(" THEN                                        03876000
                   GO TO IF (I~BRACKET(")",1))=4 THEN L1 ELSE LX;       03877000
                   IF I="[" THEN                                        03878000
                   GO TO IF (I~BRACKET("]",1))=4 THEN L1 ELSE LX;       03879000
                   IF I="," THEN                                        03880000
                   BEGIN                                                03881000
                     IF NOT SCAN(1) THEN                                03882000
                     IF GENERATE THEN EDITING(1,1);  GO TO L0;          03883000
                   END;                                                 03884000
                   IF NOT SCAN(IF NXT.[42:6]=4 THEN 1 ELSE 0) THEN      03885000
                   IF GENERATE THEN EDITING(1,NCR);  GO TO L1;          03886000
         LX:       FILENAME~IF I=0 THEN 2 ELSE I;                       03887000
         LE:  END  FILENAME;                                            03888000
REAL PROCEDURE     DECLARATION(BGN);                                    03889000
COMMENT ................................................................03890000
:    THIS PROCEDURE PROCESSES THE DECLARATIONS INSIDE A BLOCK.  IF THE :03891000
:DECLARATION IS A SUBSCRIPTED IDENTIFIER, A SIMPLE IDENTIFIER OR A     :03892000
:DEFINE, IT IS ENTERED INTO INFO[*,*].                                 :03893000
:    "BGN" INDICATES THAT THE DECLARATIONS BELONG TO A BLOCK OR JUST   :03894000
:THE SPECIFICATION PART BELONG TO A PROCEDURE HEADING.                 :03895000
:    VALUE OF RESULT:  0: NOMRE DECLARATIONS.                          :03896000
:                      1: STOPPED AT END-OF-FILE.                      :03897000
:                      3: STOPPED AT "BEGIN".                          :03898000
:                      5: STOPPED AT "END".                            :03899000
:                              --------  J. C. PAO   05/01/68  --------:03900000
:......................................................................;03901000
     VALUE         BGN;                                                 03902000
     REAL          BGN;                                                 03903000
              BEGIN                                                     03904000
       REAL        I,X;                                                 03905000
       DEFINE      NB=BOOLEAN(BGN)#;                                    03906000
       LABEL       L1,L2,L3,L4,L5,L6,L7,L8,L9;                          03907000
       LABEL       LL,LC,LF,LO,LT,LA,LX1,LX,LE;                         03908000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG,"DECLAR",NXT,BGN);                03909000
                   BGN~REAL(NOT BOOLEAN(BGN));                          03910000
         L1:       IF BOOLEAN(I~CHECKNEXT(1)) THEN                      03911000
                   GO TO IF I!1 THEN LX1 ELSE LX;                       03912000
                   IF I=2 THEN                                          03913000
                   IF NXT.[36:6]=";" THEN GO TO LE ELSE                 03914000
         LX:       BEGIN  % THE NEXT IS A SPECIAL CHR OR A DIGIT.       03915000
                     IF DFINE THEN ERRDFN~1 ELSE                        03916000
                     IF I=2 THEN CV[9].[36:6]~ERX~1 ELSE                03917000
                     BEGIN ERROR; CI[9].[36:6]~1 END;                   03918000
                     IF BOOLEAN(I) THEN GO TO LX1;                      03919000
         LL:         LFX~NFX;  I~REAL(SKIPUNTIL(";"));  LFX~1;          03920000
                     IF BOOLEAN(I) THEN                                 03921000
         LX1:        BEGIN DECLARATION~I; GO TO LE END;                 03922000
                     IF NOT SCAN(1) THEN                                03923000
                     IF GENERATE THEN EDITING(1,NCR);  GO TO L1;        03924000
                   END;                                                 03925000
                   IF I!0 THEN  % DECLARATION EXHAUSTED, START STATEMNT.03926000
                   GO TO IF BOOLEAN(I~BALABALA(I)) THEN LX1 ELSE LE;    03927000
                   IF IFX>DFX THEN GO TO LE;  % DECLARATION EXHAUSTED.  03928000
                   IF IFX{9 THEN GO TO L7;  IF IFX{19 THEN GO TO LT;    03929000
                   IF IFX=43 THEN  % "DUMP" IS AT 43 IN INFO[*,*].      03930000
                   IF NB THEN GO TO LX ELSE                             03931000
         L2:       GO TO IF BOOLEAN(I~STATEMENT) THEN LX ELSE L1;       03932000
                   IF IFX=40 THEN  % "MONITOR" IS AT 40 IN INFO[*,*].   03933000
                   IF NB THEN GO TO LX ELSE                             03934000
                   BEGIN  X~1;                                          03935000
         L3:         LFX~NFX;  RFX~RFX+11;  % CHECK FAULT DECLARATIONS. 03936000
                     I~CHECKNEXT(1);  LFX~1;  RFX~RFX-11;               03937000
                     IF BOOLEAN(I) THEN GO TO LX;                       03938000
                     IF I!0 THEN GO TO LX;  IF IFX{RFX THEN GO TO LX;   03939000
                     IF IFX>RFX+11 THEN                                 03940000
                     GO TO IF BOOLEAN(X) THEN L2 ELSE LX;               03941000
                     I~DONTCARE(0);                                     03942000
                     IF BOOLEAN(I~CHECKNEXT(1)) THEN GO TO LX;          03943000
                     IF I!2 THEN GO TO LX;                              03944000
                     IF NXT.[36:6]!"," THEN GO TO L2;                   03945000
                     IF NOT SCAN(1) THEN                                03946000
                     IF GENERATE THEN EDITING(1,1);  GO TO L3;          03947000
                   END;                                                 03948000
                   IF IFX=37 THEN  % "SWITCH" IS AT 37 IN INFO[*,*].    03949000
                   BEGIN                                                03950000
                     IF BOOLEAN(I~DONTCARE(1)) THEN GO TO LX;           03951000
                     IF I=8 THEN GO TO IF NB THEN LC ELSE L2;           03952000
                     IF I!0 THEN GO TO LX;                              03953000
                     IF IFX=35 THEN  % SWITCH LIST.                     03954000
         L4:         GO TO IF (I~DONTCARE(1))!8 THEN LX ELSE            03955000
                           IF NB THEN LC ELSE L2;                       03956000
                     IF IFX=32 THEN  % SWITCH FORMAT.                   03957000
                     GO TO IF (I~DONTCARE(1))!8 THEN LX ELSE            03958000
                           IF NB THEN LC ELSE LL;                       03959000
                     GO TO IF IFX!24 THEN LX ELSE  % SWITCH FILE.       03960000
                           IF NB THEN L6 ELSE L4;                       03961000
                   END;                                                 03962000
                   IF IFX=35 THEN  % "LIST" IS AT 35 IN INFO[*,*].      03963000
                   IF NB THEN GO TO L6 ELSE                             03964000
                   BEGIN  X~0;                                          03965000
         L5:         IF (I~DONTCARE(1))!8 THEN                          03966000
                     BEGIN                                              03967000
                       IF BOOLEAN(X) THEN                               03968000
                       IF I=0 THEN                                      03969000
                       IF IFX=DFX+13 THEN GO TO L5 ELSE                 03970000
                       IF IFX=DFX+15 THEN GO TO L5;  GO TO LX;          03971000
                     END;                                               03972000
                     IF (I~CHECKNEXT(4&"("[36:42:6]))!8 THEN GO TO LX;  03973000
                     IF BOOLEAN(X) THEN LFX~NFX;                        03974000
                     I~BRACKET(")",1);                                  03975000
                     IF BOOLEAN(X) THEN LFX~1;                          03976000
                     IF I!4 THEN GO TO LX;                              03977000
                     IF (I~CHECKNEXT(1))!2 THEN GO TO LX;               03978000
                     IF NXT.[36:6]=";" THEN GO TO L2;                   03979000
                     IF NXT.[36:6]!"," THEN GO TO LX;                   03980000
                     IF NOT SCAN(1) THEN                                03981000
                     IF GENERATE THEN EDITING(1,1);  GO TO L5;          03982000
                   END;                                                 03983000
                   IF IFX=32 THEN  % "FORMAT" IS AT 32 INFO[*,*].       03984000
                   IF NB THEN GO TO L6 ELSE BEGIN X~1; GO TO L5 END;    03985000
                   IF IFX=30 THEN  % "LABEL" IS AT 30 INFO[*,*].        03986000
                   BEGIN                                                03987000
         L6:         IF (I~DONTCARE(1))!8 THEN GO TO LX;                03988000
         LC:         IF (I~CHECKNEXT(4&","[36:42:6]))=8 THEN            03989000
                     BEGIN                                              03990000
                       IF NOT SCAN(1) THEN                              03991000
                       IF GENERATE THEN EDITING(1,1);  GO TO L6;        03992000
                     END;                                               03993000
                     IF I=2 THEN                                        03994000
                     IF NXT.[36:6]=";" THEN GO TO L2;  GO TO LX;        03995000
                   END;                                                 03996000
                   IF IFX=28 THEN  % "VALUE" IS AT 28 IN INFO[*,*].     03997000
                   GO TO IF NB THEN LL ELSE LX;                         03998000
                   IF IFX=26 THEN  % "SAVE" IS AT 26 IN INFO[*,*].      03999000
                   IF NB THEN GO TO LX ELSE                             04000000
                   BEGIN                                                04001000
                     IF (I~CHECKNEXT(1))!0 THEN GO TO LX;               04002000
                     GO TO IF IFX=24 THEN LF ELSE IF IFX=22 THEN LO ELSE04003000
                           IF IFX=4 THEN LA ELSE IF IFX{9 THEN LX ELSE  04004000
                           IF IFX>22 THEN LX ELSE LT;                   04005000
                   END;                                                 04006000
                   IF IFX=24 THEN  % "FILE" IS AT 24 IN INFO[*,*].      04007000
                   IF NB THEN GO TO L6 ELSE                             04008000
         LF:       GO TO IF (I~FILENAME)=8 THEN L1 ELSE LX;             04009000
                   IF IFX=22 THEN  % "OWN" IS AT 22 IN INFO[*,*].       04010000
                   IF NB THEN GO TO LX ELSE                             04011000
         LO:       BEGIN  X~0;                                          04012000
                     IF (I~CHECKNEXT(1))!0 THEN GO TO LX;               04013000
                     IF IFX<12 THEN GO TO IF IFX=4 THEN LA ELSE LX;     04014000
                     IF IFX>19 THEN GO TO LX;                           04015000
                   END;                                                 04016000
         LT:       X~IF IFX=17 THEN 3 ELSE  % TYPE OF "ALPHA".          04017000
                     IF IFX=19 THEN 5 ELSE  % TYPE OF "BOOLEAN".        04018000
                     1;  % TYPE OF "INTEGER" OR "REAL".                 04019000
                   LFX~NFX;  I~CHECKNEXT(1);  LFX~1;                    04020000
                   IF I!0 THEN GO TO LX;                                04021000
                   IF IFX>RFX THEN                                      04022000
                   GO TO IF BOOLEAN(I~DCLARTYPE(0)) THEN LX ELSE L1;    04023000
                   IF IFX=24 THEN                                       04024000
                   GO TO IF X!3 THEN LX ELSE                            04025000
                   IF NB THEN L6 ELSE LF;                               04026000
                   IF NB THEN GO TO IF IFX=4 THEN LA ELSE LX;           04027000
                   GO TO IF IFX=9 THEN L8 ELSE IF IFX=6 THEN L9 ELSE    04028000
                   IF IFX=4 THEN LA ELSE LX;                            04029000
         L7:       X~0;                                                 04030000
                   IF IFX=9 THEN  % "STREAM" IS AT 9 IN INFO[*,*].      04031000
                   IF NB THEN GO TO LX ELSE                             04032000
         L8:       GO TO IF BOOLEAN(I~STREAMPROCEDURE(BOOLEAN(X))) THEN 04033000
                   LX ELSE L1;                                          04034000
                   IF IFX=6 THEN  % "PROCEDURE" IS AT 6 IN INFO[*,*].   04035000
                   IF NB THEN                                           04036000
                   IF BOOLEAN(X) THEN                                   04037000
                   BEGIN  LFX~NFX;  I~CHECKNEXT(1);  LFX~1;             04038000
                     GO TO IF I!0 THEN LX ELSE IF IFX{RFX THEN LX ELSE  04039000
                           IF BOOLEAN(I~DCLARTYPE(0)) THEN LX ELSE L1;  04040000
                   END ELSE GO TO L6 ELSE                               04041000
         L9:       GO TO IF BOOLEAN(I~PROCEDUR(BOOLEAN(X))) THEN LX     04042000
                   ELSE L1;                                             04043000
                   IF IFX=4 THEN  % "ARRAY" IS AT 4 IN INFO[*,*].       04044000
         LA:       GO TO IF BOOLEAN(I~DCLARTYPE(1)) THEN LX ELSE L1;    04045000
                   IF NB THEN GO TO LX;                                 04046000
                   BUILDEFINE;  GO TO L1;                               04047000
         LE:  END  DECLARATION;                                         04048000
REAL PROCEDURE     BLOCK(BGN);                                          04049000
COMMENT ................................................................04050000
:    THIS PROCEDURE PROCESSES A BLOCK.  "BGN" IS A SWITCH TO TELL IF   :04051000
:THERE IS A "BEGIN" TO BE EDITED FIRST OR THE "BEGIN" WILL COME LATER  :04052000
:IN CASE OF A PROCEDURE.                                               :04053000
:    VALUE OF RESULT:  0:  THE BLOCK IS COMPLETE.                      :04054000
:                      1:  STOPPED AT END-OF-FILE.                     :04055000
:                      5:  STOPPED AT "END".  (ONLY WHEN BGN=0).       :04056000
:                              --------  J. C. PAO   05/01/68  --------:04057000
:......................................................................;04058000
     VALUE         BGN;                                                 04059000
     REAL          BGN;                                                 04060000
              BEGIN                                                     04061000
       ARRAY       BGG[0:1];                                            04062000
       REAL        T,I,STIFX,STDX;                                      04063000
       LABEL       L1,L12,L2,L3,L3I,L30,L32,L33,L34,L4,L5,LE;           04064000
IF BOOLEAN(DEBUGN) THEN WRITE(FOU,DBG," BLOCK",NXT,BGN,NFX,DX);         04065000
                   STIFX~NFX;  STDX~DX;                                 04066000
                   IF BOOLEAN(BGN) THEN                                 04067000
         L1:       BEGIN  BLKCNT~BLKCNT+1;                              04068000
                     IF NOT LSTO THEN GO TO L12;                        04069000
                     IF FRSTPRNT THEN                                   04070000
                     BEGIN  FRSTPRNT~FALSE;                             04071000
                       IF (T~T1 DIV 3600)<12 THEN I~"A" ELSE            04072000
                       BEGIN IF T>12 THEN T~T-12; I~"P" END;            04073000
                       WRITE(FOU[DBL],HDNG,T0.[6:24],T0.[42:6],         04074000
                             T0.[30:12],T,(T1 MOD 3600) DIV 60,I);      04075000
                     END;                                               04076000
                     IF DFINE THEN                                      04077000
                     BGNEND(FOU(0),1,BLKCNT,STR[0,48],1,STR[0,17],      04078000
                            BGG[0]) ELSE                                04079000
                     IF NC0=NCD-2 THEN                                  04080000
                     BGNEND(FOU(0),1,BLKCNT,PPC[11],0,BGG[1],BGG[0])ELSE04081000
                     IF NC0=NCD-1 THEN                                  04082000
                     BGNEND(FOU(0),1,BLKCNT,PC[11],0,BGG[1],BGG[0]) ELSE04083000
                     BGNEND(FOU(0),1,BLKCNT,CV[11],0,BGG[1],BGG[0]);    04084000
                     RELEASE(FOU);                                      04085000
         L12:        IF GENERATE THEN EDITING(1,NCR);                   04086000
                   END;                                                 04087000
                   IF BOOLEAN(I~DECLARATION(BGN)) THEN                  04088000
         L2:       IF I=1 THEN                                          04089000
         L3:       BEGIN BLOCK~1; GO TO LE END ELSE                     04090000
                   IF I=3 THEN                                          04091000
                   BEGIN                                                04092000
                     IF BOOLEAN(BGN) THEN                               04093000
                     GO TO IF BOOLEAN(I~BLOCK(1)) THEN L2 ELSE L5;      04094000
                     BGN~1;  GO TO L1;  % THIS IS FOR PROCEDURES.       04095000
                   END ELSE                                             04096000
                   BEGIN  % AN "END" IS ENCOUNTERED.                    04097000
                     IF BOOLEAN(BGN) THEN                               04098000
                     BEGIN  % SKIP COMMENT AFTER THE WORD "END".        04099000
                       IF NOT LSTO THEN GO TO L3I;                      04100000
                       IF DFINE THEN                                    04101000
                       BGNEND(FOU(0),0,BLKCNT,STR[0,48],1,STR[0,17],    04102000
                              BGG[0]) ELSE                              04103000
                       IF NC0=NCD-2 THEN                                04104000
                       BGNEND(FOU(0),0,BLKCNT,PPC[11],0,BGG[1],BGG[0])  04105000
                       ELSE                                             04106000
                       IF NC0=NCD-1 THEN                                04107000
                       BGNEND(FOU(0),0,BLKCNT,PC[11],0,BGG[1],BGG[0])   04108000
                       ELSE                                             04109000
                       BGNEND(FOU(0),0,BLKCNT,CV[11],0,BGG[1],BGG[0]);  04110000
                       RELEASE(FOU);                                    04111000
         L3I:          BLKCNT~BLKCNT-1;                                 04112000
         L30:          IF GENERATE THEN EDITING(1,NCR);  % "END" IS 1ST.04113000
         L32:          LFX~NFX;  ENDCMMT~TRUE;                          04114000
                       I~CHECKNEXT(1);  LFX~1;  ENDCMMT~FALSE;          04115000
                       IF BOOLEAN(I) THEN                               04116000
                       IF I=3 THEN GO TO L30 ELSE                       04117000
                       BEGIN BLOCK~I; GO TO L33 END;                    04118000
                       IF I=2 THEN                                      04119000
                       GO TO IF I~NXT.[36:6]=";" THEN L33 ELSE          04120000
                             IF I="." THEN L33 ELSE                     04121000
                             IF SCAN(IF NXT.[42:6]=4 THEN 1 ELSE 0)     04122000
                             THEN L32 ELSE L30;                         04123000
                       GO TO IF I!0 THEN L32 ELSE                       04124000
                             IF IFX=DFX+9 THEN L33 ELSE  % WORD "ELSE". 04125000
                             IF IFX=DFX+11 THEN L33 ELSE L32; % "UNTIL".04126000
                     END ELSE BLOCK~5;                                  04127000
         L33:        IF NFX>STIFX THEN                                  04128000
                     BEGIN INFOREMOVE(STIFX); DX~STDX END;  GO TO LE;   04129000
                   END;                                                 04130000
                   IF BOOLEAN(BGN) THEN GO TO L5;                       04131000
         L34:      IF BOOLEAN(I~BALABALA(0)) THEN                       04132000
         L4:       GO TO IF I!3 THEN L2 ELSE                            04133000
                   IF BOOLEAN(I~BLOCK(1)) THEN L4 ELSE L34 ELSE         04134000
                   IF NXT.[36:6]=";" THEN GO TO L33 ELSE                04135000
                   BEGIN                                                04136000
                     IF DFINE THEN ERRDFN~1 ELSE CV[9].[36:6]~ERX~1;    04137000
                     IF NOT SCAN(1) THEN                                04138000
                     IF GENERATE THEN EDITING(1,1);  GO TO L34;         04139000
                   END;                                                 04140000
         L5:       DO UNTIL BOOLEAN(I~STATEMENT);  GO TO L2;            04141000
         LE:  END  BLOCK;                                               04142000
LABEL              L1,L2,L3,L9,LE;                                      04143000
                   T0~DATE(TIME(0));                                    04144000
                   T1~TIME(1) DIV 60;                                   04145000
                   T2~TIME(2) DIV 60;                                   04146000
                   BLK~"     ";                                         04147000
                   EITNINES~99999999;                                   04148000
                   IOCVRT(A89,EITNINES,0,8,0);                          04149000
                   FRSTPRNT~TRUE;                                       04150000
                   INV~0&12[1:43:5];                                    04151000
                   ADDSS(CST,CV[0]);                                    04152000
                   ADDSS(CED,CV[9]);                                    04153000
                   ADDSS(EST,EV[0]);  EST~EET~EST&3[30:45:3];           04154000
                   ADDSS(IST,CI[0]);                                    04155000
                   ADDSS(DST,DCI[0]);                                   04156000
                   NCD~OUTN~CBX~LDF~BLKCNT~-1;                          04157000
                   HFX~LFX~NFX~1;                                       04158000
COMMENT  INITIALLY CREATE THE INFO[*,*] WITH ALL THE RESERVED WORDS.    04159000
         FIRST CATAGORY IS THE RESERVED WORDS FOR DECLARATIONS;         04160000
                   FILL INFO[1,*] WITH                                  04161000
                     "6DEFIN","E0000000",  %  0, [ 1],  2,              04162000
                     "5ARRAY",             %  3, [ 4],                  04163000
                     "9PROCE","DURE0000",  %  5, [ 6],  7,              04164000
                     "6STREA","M0000000",  %  8, [ 9], 10,              04165000
                     "4REAL ",             % 11, [12],                  04166000
                     "7INTEG","ER000000",  % 13, [14], 15,              04167000
                     "5ALPHA",             % 16, [17],                  04168000
                     "7BOOLE","AN000000",  % 18, [19], 20,              04169000
                     "3OWN  ",             % 21, [22],                  04170000
                     "4FILE ",             % 23, [24],                  04171000
                     "4SAVE ",             % 25, [26],                  04172000
                     "5VALUE",             % 27, [28],                  04173000
                     "5LABEL",             % 29, [30],                  04174000
                     "6FORMA","T0000000",  % 31, [32], 33,              04175000
                     "4LIST ",             % 34, [35],                  04176000
                     "6SWITC","H0000000",  % 36, [37], 38,              04177000
                     "7MONIT","OR000000",  % 39, [40], 41,              04178000
                     "4DUMP ",             % 42, [43],                  04179000
                     "000000","00000000";                               04180000
                   EV[0]~I~0;                                           04181000
                   DO BEGIN                                             04182000
                     IF J~((EV[1]~INFO[1,I]).[12:6]+2).[39:6]>0 THEN    04183000
                     TRNSFWDS(EV[2],INFO[1,I+1],J);                     04184000
                     DFX~INFOENTRY(EV,J+2);                             04185000
                   END UNTIL INFO[1,I~I+J+1]=0;                         04186000
COMMENT  SECOND CATAGORY IS THE ABSOLUTLY RESERVED WORDS;               04187000
                   FILL INFO[1,*] WITH                                  04188000
                     "5BEGIN",             % DFX+ 2.                    04189000
                     "3END  ",             % DFX+ 4.                    04190000
                     "7COMME","NT000000",  % DFX+ 6.                    04191000
                     "4ELSE ",             % DFX+ 9.                    04192000
                     "5UNTIL",             % DFX+11.                    04193000
                     "2IN   ",             % DFX+13.                    04194000
                     "3OUT  ",             % DFX+15.                    04195000
                     "2IF   ",             % DFX+17.                    04196000
                     "4THEN ",             % DFX+19.                    04197000
                     "2GO   ",             % DFX+21.                    04198000
                     "2TO   ",             % DFX+23.                    04199000
                     "7FORWA","RD000000",  % DFX+25.                    04200000
                     "7RELEA","SE000000",  % DFX+28.                    04201000
                     "4FILL ",             % DFX+31.                    04202000
                     "4WITH ",             % DFX+33.                    04203000
                     "2DO   ",                                          04204000
                     "2OR   ",                                          04205000
                     "3AND  ",                                          04206000
                     "3DIV  ",                                          04207000
                     "3EQV  ",                                          04208000
                     "3FOR  ",                                          04209000
                     "3IMP  ",                                          04210000
                     "3MOD  ",                                          04211000
                     "3NOT  ",                                          04212000
                     "4LOCK ",                                          04213000
                     "4READ ",                                          04214000
                     "4STEP ",                                          04215000
                     "5CLOSE",                                          04216000
                     "5SPACE",                                          04217000
                     "5WHILE",                                          04218000
                     "5WRITE",                                          04219000
                     "6DOUBL","E0000000",                               04220000
                     "6REWIN","D0000000",                               04221000
                     "000000","00000000";                               04222000
                   I~0;                                                 04223000
                   DO BEGIN                                             04224000
                     IF J~((EV[1]~INFO[1,I]).[12:6]+2).[39:6]>0 THEN    04225000
                     TRNSFWDS(EV[2],INFO[1,I+1],J);                     04226000
                     RFX~INFOENTRY(EV,J+2);                             04227000
                   END UNTIL INFO[1,I~I+J+1]=0;                         04228000
                   BB~2;  INF[0]~0&3[1:46:2];                           04229000
                   INF[1]~"4TRUE ";  RFX~INFOENTRY(INF,2);              04230000
                   INF[1]~"5FALSE";  RFX~INFOENTRY(INF,2);              04231000
COMMENT  TIRD CATAGORY IS THE RESERVED WORDS BUT CAN BE REDECLARED;     04232000
                   FILL INFO[1,*] WITH                                  04233000
                     "4FLAG ",             % RFX+ 2.                    04234000
                     "4ZERO ",             % RFX+ 4.                    04235000
                     "5INDEX",             % RFX+ 6.                    04236000
                     "6EXPOV","R0000000",  % RFX+ 8.                    04237000
                     "6INTOV","R0000000",  % RFX+11.                    04238000
                     "3ZIP  ",                                          04239000
                     "2LN   ",                                          04240000
                     "2NO   ",                                          04241000
                     "3ABS  ",                                          04242000
                     "3COS  ",                                          04243000
                     "3EXP  ",                                          04244000
                     "3SIN  ",                                          04245000
                     "3DBL  ",                                          04246000
                     "4DISK ",                                          04247000
                     "4SEEK ",                                          04248000
                     "4SORT ",                                          04249000
                     "4SIGN ",                                          04250000
                     "4SQRT ",                                          04251000
                     "4TIME ",                                          04252000
                     "4PAGE ",                                          04253000
                     "4WAIT ",                                          04254000
                     "4WHEN ",                                          04255000
                     "5BREAK",                                          04256000
                     "5MERGE",                                          04257000
                     "5PRINT",                                          04258000
                     "5PUNCH",                                          04259000
                     "5PURGE",                                          04260000
                     "6ARCTA","N0000000",                               04261000
                     "6ENTIE","R0000000",                               04262000
                     "6RANDO","M0000000",                               04263000
                     "6REVER","S0000000",                               04264000
                     "6SEARC","M0000000",                               04265000
                     "6SERIA","L0000000",                               04266000
                     "6UPDAT","E0000000",                               04267000
                     "000000","00000000";                               04268000
                   I~0;                                                 04269000
                   DO BEGIN                                             04270000
                     IF J~((EV[1]~INFO[1,I]).[12:6]+2).[39:6]>0 THEN    04271000
                     TRNSFWDS(EV[2],INFO[1,I+1],J);                     04272000
                     CFX~INFOENTRY(EV,J+2);                             04273000
                   END UNTIL INFO[1,I~I+J+1]=0;                         04274000
COMMENT  CREATE PSEUDO DEFINES FOR LB,RB,EQL,NEQ,LSS,LEQ,GEQ,GTR,TIMES; 04275000
                   INF[0]~-1;                                           04276000
                   EV[0]~" [ # ";  EDITING(1,5);                        04277000
                   WRITE(DFSK[INF[2]~0],12,CI[*]);  CIVALID~FALSE;      04278000
                   INF[1]~BLK&"2LB"[12:30:18];  CFX~INFOENTRY(INF,3);   04279000
                   EV[0].[24:6]~"]";  EDITING(1,5);                     04280000
                   WRITE(DFSK[INF[2]~1],12,CI[*]);  CIVALID~FALSE;      04281000
                   INF[1].[18:6]~"R";  CFX~INFOENTRY(INF,3);            04282000
                   EV[0].[24:6]~"=";  EDITING(1,5);                     04283000
                   WRITE(DFSK[INF[2]~2],12,CI[*]);  CIVALID~FALSE;      04284000
                   INF[1].[12:24]~"3EQL";  CFX~INFOENTRY(INF,3);        04285000
                   EV[0].[24:6]~"!";  EDITING(1,5);                     04286000
                   WRITE(DFSK[INF[2]~3],12,CI[*]);  CIVALID~FALSE;      04287000
                   INF[1].[18:18]~"NEQ";  CFX~INFOENTRY(INF,3);         04288000
                   EV[0].[24:6]~"<";  EDITING(1,5);                     04289000
                   WRITE(DFSK[INF[2]~4],12,CI[*]);  CIVALID~FALSE;      04290000
                   INF[1].[18:18]~"LSS";  CFX~INFOENTRY(INF,3);         04291000
                   EV[0].[24:6]~"{";  EDITING(1,5);                     04292000
                   WRITE(DFSK[INF[2]~5],12,CI[*]);  CIVALID~FALSE;      04293000
                   INF[1].[18:18]~"LEQ";  CFX~INFOENTRY(INF,3);         04294000
                   EV[0].[24:6]~"}";  EDITING(1,5);                     04295000
                   WRITE(DFSK[INF[2]~6],12,CI[*]);  CIVALID~FALSE;      04296000
                   INF[1].[18:18]~"GEQ";  CFX~INFOENTRY(INF,3);         04297000
                   EV[0].[24:6]~">";  EDITING(1,5);                     04298000
                   WRITE(DFSK[INF[2]~7],12,CI[*]);  CIVALID~FALSE;      04299000
                   INF[1].[18:18]~"GTR";  CFX~INFOENTRY(INF,3);         04300000
                   EV[0].[24:6]~"|";  EDITING(1,5);                     04301000
                   WRITE(DFSK[INF[2]~DX~8],12,CI[*]);  CIVALID~FALSE;   04302000
                   INF[1].[12:36]~"5TIMES";  CFX~INFOENTRY(INF,3);      04303000
                   READ(PACH[NO])[LE];  TRNSFWDS(PNO,PACH(9),1);        04304000
                   CV[9]~CNO~INV;  CC~CED;                              04305000
                   DOLLAR~-(ACT[1]~ACT[2]~1);                           04306000
                   LST~4;  R~REAL(SCAN(3));                             04307000
                   OUTPUTNEW(-1);  % IF THE 1ST CARD IS $-CARD, START   04308000
                                   % TO FUNCTION IMMEDIATELY.           04309000
         L1:       IF (I~CHECKNEXT(1))=2 THEN                           04310000
                   BEGIN                                                04311000
                     IF NXT.[36:6]=""" THEN BEGIN STRING; GO TO L1 END; 04312000
                     IF NOT SCAN(IF NXT.[42:6]=4 THEN 1 ELSE 0) THEN    04313000
         L2:         IF GENERATE THEN EDITING(1,NCR);  GO TO L1;        04314000
                   END ELSE                                             04315000
                   IF I=5 THEN GO TO L2 ELSE                            04316000
                   IF I=1 THEN BEGIN Z~3; GO TO L9 END;                 04317000
                   IF I!3 THEN GO TO L1;                                04318000
                   IF BOOLEAN(I~BLOCK(1)) THEN                          04319000
                   IF I=1 THEN BEGIN Z~3; GO TO L9 END ELSE GO TO L3;   04320000
                   IF EOF THEN GO TO L3;                                04321000
                   IF NXT=4&"."[36:42:6] THEN                           04322000
                   BEGIN  Z~0;                                          04323000
                     IF NOT SCAN(1) THEN                                04324000
                     IF GENERATE THEN EDITING(1,1);                     04325000
                   END ELSE                                             04326000
         L3:       BEGIN  Z~1;                                          04327000
                     IF DFINE THEN                                      04328000
                     DO DFINEOUT UNTIL NOT DFINE ELSE                   04329000
                     BEGIN                                              04330000
                       IF NOT GENERATE THEN STARTGEN;                   04331000
                       EV[0]~0&"."[18:42:6];  EDITING(1,1);             04332000
                     END;                                               04333000
                   END;                                                 04334000
         L9:       IF CIVALID THEN EDITING(0,AVC);                      04335000
                   IF OUTN<NCD-2 THEN                                   04336000
                   BEGIN OUTPUT(PPC); OUTN~OUTN+1; OUTPUTNEW(NCD-2) END;04337000
                   IF OUTN=NCD-2 THEN                                   04338000
                   BEGIN OUTPUT(PC); OUTN~OUTN+1; OUTPUTNEW(NCD-1) END; 04339000
                   IF Z=3 THEN                                          04340000
                   BEGIN  FILL A[*] WITH                                04341000
                     "XXXXXXXX","  END OF"," FILE BU","T NOT EN",       04342000
                     "D OF PRO","GRAM    ","XXXXXXXX","XXXXXXXX",       04343000
                     "XXXXXXXX","XXXXXXXX","XXXXXXXX","XXXXXXXX",       04344000
                     "XXXXXXXX","        ","XXXXXXXX";                  04345000
                     WRITE(FOU,15,A[*]);                                04346000
                   END ELSE                                             04347000
                   IF OUTN=NCD-1 THEN                                   04348000
                   BEGIN OUTPUT(CV); OUTN~OUTN+1; OUTPUTNEW(NCD) END;   04349000
                   IF Z=1 THEN                                          04350000
                   BEGIN  FILL A[*] WITH                                04351000
                     "XXXXXXXX","  END OF"," PROGRAM"," WITHOUT",       04352000
                     " A PERIO","D  XXXXX","XXXXXXXX","XXXXXXXX",       04353000
                     "XXXXXXXX","XXXXXXXX","XXXXXXXX","XXXXXXXX",       04354000
                     "XXXXXXXX","        ","XXXXXXXX";                  04355000
                     WRITE(FOU,15,A[*]);                                04356000
                   END;                                                 04357000
                   IF FRSTPRNT THEN GO TO LE;                           04358000
                   IF (T1~TIME(1)/60-T1)<0 THEN T1~T1+86400;            04359000
                   IF (T2~TIME(2)/60-T2)<0 THEN T2~T2+86400;            04360000
                   WRITE(FOU[DBL],TAIL,NE,ND,NR+NN,NR,NN,T2 DIV 60,     04361000
                         T2 MOD 60,T1 DIV 60,T1 MOD 60);                04362000
         LE:       IF NEWTPED OR PNCHED THEN                       %001%04363000
                   BEGIN                                                04364000
                     FILL A[*] WITH "END;END."," L A S T","  C A R ",   04365000
                         "D  C R E"," A T E D","  B Y  F"," I L T E",   04366000
                         " R      ","        ","99999999";              04367000
                     IF NEWTPED THEN WRITE(NTP,10,A[*]);           %001%04368000
                     IF PNCHED THEN WRITE(PUNCH,10,A[*]);          %001%04368500
                   END;                                                 04369000
END OF THE PROGRAM BLOCK;                                               04370000
END OF THE OUTERMOST BLOCK.                                             04371000
END;END.        LAST CARD ON 0CRDING TAPE                               99999999
