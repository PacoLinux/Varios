$#PATCH NUMBER 1 FOR MCP.XII CONTAINS 6 CARDS                                &&&
%B 5 5 0 0   M C P  M A R K     X I I . 24                 02/15/71     00001000
                  INDEPENDENTRUNNER(P(.IOERR),R&U[3:43:5]&              04223100
                        (LOCATQUE[S]:=(*P(DUP))&1[1:47:1])[1:9:1])      04224000
$VOID                                                                   04224100
              BEGIN IF U GEQ 0 THEN                                     04523500
                   END;                                                 04532500
$#PATCH NUMBER 2 FOR MCP.XII CONTAINS 86 CARDS                               &&&
 REAL PROCEDURE FORMESS(BUFF,H1); VALUE BUFF,H1; REAL BUFF,H1;          08418000
    BEGIN REAL B,H,U,M1;                                                08418500
         INTEGER I;                                                     08418700
         LABEL AGAIN,EXIT;                                              08419000
         M1:=M[BUFF.[15:15]-2];                                         08419100
         STREAM(BUFF:);                                                 08419200
         BEGIN SI:=BUFF;                                                08419300
           L: IF SC=" " THEN BEGIN SI:=SI+1; GO TO L END;               08419400
              BUFF:=SI;                                                 08419500
         END;                                                           08419600
         BUFF:=P;                                                       08419700
AGAIN:   U:=FORMESS:=UNITIN(TINU,BUFF);                                 08420000
$VOID                                                                   08423000
              BEGIN STREAM(A:=TINU[U],B:=B:=SPACE(5));                  08424000
                   LABELTABLE[U]:=@114&H1[1:47:1];                      08430000
                   IF H1 THEN B:=NOT 0 ELSE                             08433000
                   BEGIN B:=NOT I;  H:=I:=0;                            08434000
                           IF (*H).[CF] NEQ 0 THEN                      08434400
                   END;                                                 08434910
              END;                                                      08437050
EXIT:    IF NOT H1 THEN                                                 08437100
         BEGIN IF U GTR 31 THEN                                         08437150
              BEGIN STREAM(BUFF,B:=B:=SPACE(5));                        08437200
                   BEGIN DS:=10 LIT"INV KBD RY";                        08437250
                        SI:=BUFF; DS:=3 CHR;                            08437300
                        DS:=LIT"~";                                     08437350
                   END;                                                 08437400
                   SPOUT(B INX M1);                                     08437450
              END;                                                      08437500
              STREAM(OK:=0,BUFF:);                                      08437550
              BEGIN SI:=BUFF;                                           08437600
                   3(IF SC=" " THEN JUMP OUT;                           08437650
                     IF SC="," THEN JUMP OUT;                           08437700
                     IF SC="~" THEN JUMP OUT TO L3;                     08437750
                     SI:=SI+1);                                         08437800
              L1:  IF SC=" " THEN                                       08437850
              L2:  BEGIN SI:=SI+1; GO TO L1 END;                        08437900
                   IF SC="," THEN GO TO L2;                             08437950
                   BUFF:=SI;                                            08438000
                   IF SC!"~" THEN TALLY:=1;                             08438050
              L3:  OK:=TALLY;                                           08438100
              END;                                                      08438150
              BUFF:=P;                                                  08438200
              IF P THEN GO AGAIN;                                       08438250
              FORMESS:=-1;                                              08438300
         END;                                                           08438350
    END;                                                                08438500
         BEGIN REAL A=B,T,U,I,M1;                                       08576000
              LABEL AGAIN,EXIT;                                         08576100
              M1:=M[B.[15:15]-2];                                       08577000
              STREAM(B:);                                               08577100
              BEGIN SI:=B;                                              08577200
                L: IF SC=" " THEN BEGIN SI:=SI+1; GO TO L END;          08577300
                   B:=SI;                                               08577400
              END;                                                      08577500
              B:=P;                                                     08577600
AGAIN:        T:=SPACE(10);                                             08577700
              IF (U:=UNITIN(TINU,A)) GTR 31 THEN                        08578000
              STREAM(A,T);                                              08578100
              BEGIN DS:=10 LIT"INV KBD SV";                             08578200
                   SI:=A; DS:=3 CHR;                                    08578300
                   DS:=LIT"~";                                          08578400
              END ELSE                                                  08578500
$VOID 08578801                                                          08578600
              SPOUT(T INX M1);                                          08597000
              STREAM(OK:=0,A:);                                         08597050
              BEGIN SI:=A;                                              08597100
                   3(IF SC=" " THEN JUMP OUT;                           08597150
                     IF SC="," THEN JUMP OUT;                           08597200
                     IF SC="~" THEN JUMP OUT TO L3;                     08597250
                     SI:=SI+1);                                         08597300
              L1:  IF SC=" " THEN                                       08597350
              L2:  BEGIN SI:=SI+1; GO TO L1 END;                        08597400
                   IF SC="," THEN GO TO L2;                             08597450
                   A:=SI;                                               08597500
                   IF SC!"~" THEN TALLY:=1;                             08597550
              L3:  OK:=TALLY;                                           08597600
              END;                                                      08597650
              A:=P;                                                     08597700
              IF P THEN GO AGAIN;                                       08597750
    FMR: RY:  IF (HN2:=FORMESS(KTR,HN1!0)) LSS 0 THEN GO TO FORGET;     16091000
         IF HN2 GTR 31 THEN GO TO ERROR ELSE GO TO RXIT;                16092000
$VOID 16092261                                                          16092010
    SV:  SAVETHEUNIT(KTR);                                              16128000
$VOID 16128241                                                          16128010
         GO FORGET;                                                     16129000
$#PATCH NUMBER 3 FOR MCP.XII CONTAINS 6 CARDS                                &&&
$VOID                                                                   44242002
$VOID 44242021                                                          44242007
    ACTDATE~WEEKDAY~0;                                                  44243000
    INTFINISH(A);                                                       44244000
    FORGETSPACE(INTS);                                                  44245000
    GO TO NOTHINGTODO;                                                  44246000
$#PATCH NUMBER 4 FOR MCP.XII CONTAINS 1 CARDS                                &&&
                (HEADER INX 0)&FIB[5][30:13:3];                         38508000
$#PATCH NUMBER 5 FOR MCP.XII CONTAINS 1 CARDS                                &&&
              IF (I:=DIRECTORYSEARCH("REMOTE ","LOG    ",2)) NEQ 0 THEN 43003000
$#PATCH NUMBER 6 FOR MCP.XII CONTAINS 2 CARDS                                &&&
         LOG[1]:= MID.[6:42];          %FIRST NAME                      08698480
         LOG[2]:= FID.[6:42];           %SECOND NAME                    08698490
$#PATCH NUMBER 7 FOR MCP.XII CONTAINS 37 CARDS                               &&&
              CLOSEXCLUSIVE,ZER,UNSYS,SYS,                              18207000
$INCLUDE 18210101, IF SHAREDISK;                                        18210099
         LABEL ONE,TOG1,TOG2,STOG;                                      18210100
$INCLUDE 18314001, IF SHAREDISK;                                        18310999
$OMIT 18314201, IF SHAREDISK;                                           18314099
              FH[9].[9:5]:=P(DUP).[9:5]+1;                              18314100
              FH[9].[1:1]:=1;                                           18314200
$INCLUDE 18321001, IF SHAREDISK;                                        18319999
$OMIT 18321101, IF SHAREDISK;                                           18321099
         FH[4].[16:5]:=P(DUP).[16:5]+1;                                 18321100
$INCLUDE 18327001, IF SHAREDISK;                                        18325999
$OMIT 18327101, IF SHAREDISK;                                           18327099
              FH[9].[5:1]:=1;                                           18327100
$INCLUDE 18336001, IF SHAREDISK;                                        18334999
$OMIT 18336101, IF SHAREDISK;                                           18336099
              FH[9].[9:5]:=P(DUP).[9:5]+1;                              18336100
$INCLUDE 18357001, IF SHAREDISK;                                        18350999
$OMIT 18357301, IF SHAREDISK;                                           18357099
         IF (I:=FH[9].[9:5]-1)=0 THEN                                   18357100
         FH[9].[1:1]:=0;                                                18357200
         FH[9].[9:5]:=I;                                                18357300
$INCLUDE 18361001, IF SHAREDISK;                                        18359999
$OMIT 18361101, IF SHAREDISK;                                           18361099
         FH[4].[16:5]:=P(DUP).[16:5]-1;                                 18361100
$INCLUDE 18365001, IF SHAREDISK;                                        18363999
$OMIT 18365101, IF SHAREDISK;                                           18365099
         FH[9].[5:1]:=0;                                                18365100
$INCLUDE 18369001, IF SHAREDISK;                                        18367999
$OMIT 18369101, IF SHAREDISK;                                           18369099
         FH[9].[9:5]:=P(DUP).[9:5]-1;                                   18369100
$INCLUDE 18392001, IF SHAREDISK;                                        18390999
$OMIT 18392101, IF SHAREDISK;                                           18392099
              FH[4].[12:1]:=1;                                          18392100
$INCLUDE 18399001, IF SHAREDISK;                                        18397999
$OMIT 18399101, IF SHAREDISK;                                           18399099
         FH[4].[12:1]:=0;                                               18399100
$INCLUDE 18410001, IF SHAREDISK;                                        18403999
$#PATCH NUMBER 8 FOR MCP.XII CONTAINS 1 CARDS                                &&&
    H[1]:=H[8];      % RESTORE ROW LENGTH                               02780920
$#PATCH NUMBER 9 FOR MCP.XII CONTAINS 2 CARDS                                &&&
              IF JAR[P1MIX,2].[3:1] AND PRT[P1MIX,@51].[43:1] THEN      42547100
                 PRT[P1MIX,@51].[44:1])) THEN                           42550600
$#PATCH NUMBER 10 FOR MCP.XII CONTAINS 19 CARDS                              &&&
    DISKWAIT(-F,-30,B~DIRECTORYTOP+1);                                  06057600
         DISKWAIT(-F,30,B); FH[SYS]~0;                                  06057750
    DISKWAIT(F,-30,B);                                                  06057770
$VOID                                                                   22051000
              LOCKDIRECTORY;                                            22051250
              UNLOCKDIRECTORY;                                          22052350
$VOID                                                                   22052500
    BCL[7]~H[4];BCL[9].[43:5]~H[5].[23:5];                              28012340
                   FORGETUSERDISK(H[I]+RL,-(ABS(BRL-RL)));              37516000
                   FORGETUSERDISK(A[NT4-1]+RL,                          37542000
                                  -(ABS((NT2-9)|BRL-NT4|RL)));          37542010
$VOID                                                                   44242002
$VOID 44242021                                                          44242007
    ACTDATE~WEEKDAY~0;                                                  44243000
    INTFINISH(A);                                                       44244000
    FORGETSPACE(INTS);                                                  44245000
    GO TO NOTHINGTODO;                                                  44246000
                        P(MKS,NT4,DIB 0,LOD,SLATE[NSLATE],COC);%        48055000
         P(0,STF,PRT[P1MIX,8],STS,MKS,NT4,DIB 0,LOD,XCH,COC);           48145000
$#PATCH NUMBER 11 FOR MCP.XII CONTAINS 1 CARDS                               &&&
         N:=(W MOD 7) NEQ 0 AND RD.[25:1];                              27100000
$#PATCH NUMBER 12 FOR MCP.XII CONTAINS 2 CARDS                               &&&
              STREAM(W,S:=BUFF,BUFFER);                                 27093000
$VOID                                                                   27096500
$#PATCH NUMBER 13 FOR MCP.XII CONTAINS 3 CARDS                               &&&
                             IF(HALF:=((RD:=RD.[CF])-BUFF) MOD 7)= 1    23179000
                             THEN RD:=RD-1; RA:=M[BUFF-2].[CF]-RD;      23179050
                             IF HALF LEQ 1 THEN                         23179100
$#PATCH NUMBER 14 FOR MCP.XII  CONTAINS 1 CARDS                              &&&
              MOVE(20,[H[10]],[M[G+10]]);                               02783400
$#PATCH NUMBER 15 FOR MCP.XII CONTAINS 1 CARDS                               &&&
BEGIN SI:=FB;SI:=SI+16;DS:=3OCT;DS:=5OCT;DS:=OCT END;                   02887400
$#PATCH NUMBER 16 FOR MCP.XII CONTAINS 2 CARDS                               &&&
$VOID                                                                   00455990
         AUXPRINT((IF TYPE=68 THEN -0 ELSE MIX)&ZZSTA[9:9:9]);          16152210
$#PATCH NUMBER 17 FOR MCP.XII CONTAINS 2 CARDS                               &&&
    BEGIN IF S[L]!0 OR C OR (S[L]=0 AND TRANSACTION[L]=2) THEN          02864600
          BLASTQ(L);                                                    02864700
$#PATCH NUMBER 18 FOR MCP.XII CONTAINS 1 CARDS                               &&&
                   @ 001220000713147,  COMMENT ZIP;%                    00273000
$#PATCH NUMBER 19 FOR MCP.XII CONTAINS 2 CARDS                               &&&
$INCLUDE 19562501, IF DATACOM AND NOT INQUIRY;                          19561000
      GO TO INITIATE;                                                   19562500
$#PATCH NUMBER 20 FOR MCP.XII CONTAINS 6 CARDS                               &&&
              "8INVALD","8 FILE ","4NAME..", %75                        02345750
         IF (A.[1:5]!0 OR B.[1:5]!0) THEN                               14559300
         BEGIN                                                          14559400
             TERMINATE(P1MIX); TERMINALMESSAGE(75);                     14559500
             GO TO BOMBOUT;                                             14559600
         END;                                                           14559700
$#PATCH NUMBER 21 FOR MCP.XII CONTAINS 2 CARDS                               &&&
    BEGIN Q:=UT[H:=K-C+1].DSIZE;                                        05974400
         FOR H:=H STEP 1 UNTIL K DO                                     05974600
$#PATCH NUMBER 22 FOR MCP.XII CONTAINS 14 CARDS                              &&&
          C29,C30,C31,C32,C33,C34,C35,C36,C37,C38,C39,C40,C41,SL;       19508000
           SL,SL,C31,SL,SL,SL,C35,C36,SL,SL,C39,C40,C41;                19513000
C40:: IF R5.[15:15]=0 THEN                                              19685400
      BEGIN                                                             19685410
$INCLUDE 19685421, IF DATACOM AND NOT INQUIRY;                          19685419
            M[R5]:=USERSTA[P1MIX];                                      19685420
$OMIT 19685431, IF DATACOM AND NOT INQUIRY;                             19685429
            M[R5]:=0;                                                   19685430
            GO INITIATE;                                                19685440
      END ELSE                                                          19685450
      BEGIN INDEPENDENTRUNNER(P(.DKBUSINESS),R5); SLEEP([M[R5]],1);     19685460
            GO RETURN;                                                  19685470
      END;                                                              19685480
C41:: IOREQUEST(R7,R6,FLAG(R5)); GO INITIATE;                           19685550
$#PATCH NUMBER 23 FOR MCP.XII CONTAINS 49  CARDS                             &&&
         TMID=FID+1,                                                    05950900
         A=TMID+1,                                                      05951000
    BOOLEAN RDT=HD+1;                                                   05951700
    INTEGER C=RDT+1,D=C+1,I=D+1,J=I+1,R=J+1,S=R+1,                      05951800
            LA=S+1,SA1=NT2,                                             05951900
    REAL E=LA+1;                                                        05952200
    INTEGER SLEEPER=AVS+1;                                              05952500
    P(0,0,0,0,BUFF,DUP); BUFF:=P.[15:15]-1; P(0,0,B LSS 0);             05953200
    P(0,0,0,0,0,0,0,0,0);                                               05956200
    IF RDT THEN                                                         05956250
    BEGIN P(B); A:=M[BUFF INX 0]; N:=M[BUFF INX 1]; END ELSE            05956300
    BEGIN                                                               05956350
    END;                                                                05958500
X:  IF A GEQ L:=(H:=UT[T].DEND)-(Q:=UT[T].DSIZE) THEN                   05962600
    IF (LA:=(A+N)) LEQ H THEN GO AZ%AREA AVAILABLE                      05962700
    ELSE IF LA LEQ SA1:=(UT[T+1].DEND-UT[T+1].DSIZE) THEN               05962800
    N:=LA-A:=H ELSE N:=SA1-A:=H ELSE IF (LA:=A+N) GTR L THEN            05962900
    N:=L-A ELSE RDT:=RDT OR @100000;                                    05963000
    GO INUSE;                                                           05963100
Y:  TMID:=IF RDT THEN "DKTEST " ELSE "BADISK ";                         05963800
    STREAM(TMID,FID,N,MID,B,BUFF);                                      05964000
    BEGIN DS:=LIT "."; SI:=LOC TMID; SI:=SI+1; DS:=7 CHR;               05964200
         DS:=LIT "/"; SI:=SI+1; DS:=7 CHR;                              05964400
         DS:=13 LIT " NOT CREATED("; SI:=SI+8; SKIP SB;                 05964500
         IF SB THEN ELSE                                                05964600
         BEGIN SI:=LOC N; DS:=7 DEC; N:=DI; DI:=DI-7; DS:=7 FILL;       05964800
              DI:=N; DS:=5 LIT " SEGS"; SI:=SI+1;                       05964900
         END; DS:=11 LIT " IN USE BY "; DS:=7 CHR; DS:=LIT"/";          05965000
         SI:=SI+1; DS:=7 CHR;                                           05965200
         DS:=2 LIT")~";                                                 05965400
    END;                                                                05965600
$ VOID 05966001                                                         05965800
              IF(E EQV @114)=NOT 0 THEN                                 05967800
              BEGIN MID:="SYSTEM "; B:=FID; GO Z; END;                  05967900
                        IF A GEQ C THEN IF A LSS                        05968800
                        SA1:=(C+D:=UT[30|I+8]) THEN                     05968900
                        BEGIN MID:=E&((LA LEQ SA1) AND                  05969000
                             (RDT.[18:15]))[1:47:1];                    05969100
                             IF A+N GTR SA1 THEN N~SA1-A;               05969150
                             B:=UT[451+2|I];                            05969200
AZ: IF A NEQ L AND LA NEQ H THEN                                        05970800
         UT[T+1]:=H&(H-LA)[TODSIZE];                                    05972800
    IF A=L AND LA=H THEN                                                05973400
    MID:=IF RDT THEN "DKTEST " ELSE "BADISK ";                          05975400
$OMIT 05979401, IF SHAREDISK;                                           05979399
EXIT: IF RDT THEN M[SLEEPER INX 0]:=1 ELSE SPOUT(BUFF);                 05979400
$INCLUDE 05979451, IF SHAREDISK;                                        05979449
EXIT: IF RDT THEN M[SLEEPER INX 0]:=3 ELSE SPOUT(BUFF);                 05979450
    BUFF:=0; KILL([BUFF]);                                              05979500
$#PATCH NUMBER 24 FOR MCP.XII CONTAINS 8 CARDS                               &&&
 PROCEDURE COMMUNICATE;  FORWARD;                                       00478000
 PROCEDURE LIBRARYLOAD; FORWARD;                                        00479000
 PROCEDURE LIBRARYDUMP;  FORWARD;                                       00480000
$VOID 18992001                                                          18991000
         DIRECT:=[M[P(..RESWDS,LOD,1,INX)]]&121[8:38:10];%              20601700
         M[P(..RESWDS,LOD,1,NOT,INX)].[2:1]:=1;                         20601800
         M[P(..RESWDS,LOD,1,NOT,INX)].[2:1]:=0;                         20610450
                       "24"                                             44203100
$#PATCH NUMBER 25 FOR MCP.XII    CONTAINS  14  CARDS         I                 &
%B 5 7 0 0   M C P  M A R K     X I I . 68                 04/15/71     00001000
                   68                                                   44203100
         IF P2MIX=0 THEN GO TO COMINIT;                                 48019500
$INCLUDE 48083001, IF STATISTICS;                                       48082999
              PBUSY~0;                                                  48083000
              DO DO P(INI) UNTIL (P(RRR) OR RRRMECH)!READY%             48084000
                   UNTIL STATUSBIT;%                                    48084100
              TOGLE~TOGLE AND NOT STATUSMASK;                           48084200
              INDEPENDENTRUNNER(P(.STATUS),0);%                         48084300
              GO TO NOTHINGTODO;%                                       48084400
 P2FAKE:                TOGLE~TOGLE OR HP2MASK;                         48085000
$VOID                                                                   48088000
$VOID                                                                   48089000
$VOID 48094001                                                          48089099
$#PATCH NUMBER 26 FOR MCP.XII    CONTAINS  7 CARDS           I                 &
              RNALL=OPTION.[17:1]#,                                     00416710
              "RNAL","L000", %17                                        00454920
$VOID                                                                   00455990
              "8INVALD","5 COM 0", %78                                  02345760
                   OR (H[4].[4:2]!SYSNO AND NOT RNALL)                  07437900
         IF PRT[P1MIX,9]<0 THEN                                         19525100
         BEGIN TERMINATE(P1MIX); TERMINALMESSAGE(78) END;               19525200
$#PATCH NUMBER 27 FOR MCP.XII   CONTAINS 14 CARDS            I                 &
SAVE INTEGER PROCEDURE DISKSPACE(NWORDS,P1MIX,AUX);%                    00365000
    VALUE NWORDS,P1MIX,AUX;                                             00366000
    INTEGER NWORDS,P1MIX;REAL AUX;                                      00367000
              DATAOLAY=OPTION.[14:1]#,                                  00416750
              "DATA","OLAY", %14                                        00454950
BEGIN WHILE (L~DISKSPACE(J,X,0)){0 DO SLEEP([OLAYMASK],TWO(X));         02727600
      BEGIN M[J].[3:3]~7; %MARK AS "READ-ONLY", ALREADY WRITTEN         19297600
          DISK~DISKSPACE(IOD,MIX,M[MOM].[6:1]);IF DISK<0 THEN           22322200
         IF M[MOM].[3:3]!7 THEN                                         22325400
         IF M[MOM].[3:3]=6 THEN M[MOM].[5:1]~1;                         22349100
 SAVE INTEGER PROCEDURE DISKSPACE(WORDS,MIX,AUX);                       24101000
 VALUE WORDS,MIX,AUX;                                                   24102000
 INTEGER WORDS,MIX; REAL AUX;                                           24103000
         IF P(AUXILIARYSPACE(WORDS),DUP)!0 AND (DATAOLAY OR AUX) THEN   24149000
$# PATCH NUMBER 28 FOR MCP.XII CONTAINS 1 CARDS             I
              :29: DO UNTIL FALSE;             % 35 - SPECIAL INTERRUPT 46011100
$#PATCH NUMBER 29 FOR MCP.XII   CONTAINS 4 CARDS             I                 &
              STREAM(Z:=RD:=[IT] INX (0&STA[9:9:9]&1[3:47:1]));         25225100
              DS:=4 LIT "{<!~";                                         25225200
$VOID                                                                   25225300
$VOID                                                                   25225600
$#PATCH NUMBER 30 FOR MCP.XII   CONTAINS 9 CARDS             I                 &
$OMIT 19212001, IF SHAREDISK;                                           19211999
                  A4[6]:=M[T+4].[16:5]+M[T+9].[9:5];                    19212000
$INCLUDE 19212061, IF SHAREDISK;                                        19212049
                  A4[6]:=0&(I:=M[T+4].[16:20]+M[T+9].[9:20])[43:28:5] & 19212050
                    I[38:33:5]&I[33:38:5]&I[28:43:5];                   19212060
                  IF A4.[8:10] GTR 9 THEN                               19212100
                  BEGIN A4[7]:=M[T+4].[36:6];  A4[8]:=M[T+3];           19212200
                        A4[9]:=M[T+1];                                  19212300
                  END;                                                  19212400
$#PATCH NUMBER  31 FOR MCP.XII   CONTAINS 164 CARDS          I                 &
        IF LUN{22 AND LUN}20 OR (LUN{18 AND % LP OR CP BK-UP            02278000
        (P(M[TOPIO].[3:5],DUP)=22 OR P(XCH)=10))                        02278100
                   IF M[TOPIO].[3:5]=22 THEN % NOT CP BK-UP             02285100
                        PBCOUNT~PBCOUNT+(((NB[J] EQV "PBD    ")=NOT 0   06058760
                             OR (NB[J] EQV "PUD    ")=NOT 0)            06058770
DEFINE PRINTWAIT(PRINTWAIT1)=PRINTORPUNCHWAIT(PRINTWAIT1,0)#;           08254000
BOOLEAN PROCEDURE PRINTORPUNCHWAIT(Q,PNCH);VALUE Q,PNCH;REAL Q,PNCH;    08255000
         BEGIN IF PNCH THEN IF LABELTABLE[V~22]!0 THEN V~0 ELSE ELSE    08257500
              IF LABELTABLE[V~20]!0 THEN                                08257600
              IF (((MULTITABLE[I] EQV "PBTMCP ")=NOT 0 AND V!22) OR     08261500
                  ((MULTITABLE[I] EQV "PUTMCP ")=NOT 0 AND V=22)) THEN  08261600
                        IF(((D[Q] EQV"PBD    ")=NOT 0) AND (V!22)) OR   08269500
                          (((D[Q] EQV"PUD    ")=NOT 0) AND (V=22)) THEN 08269550
                   PRINTORPUNCHWAIT~TRUE;                               08277100
               IF MULTITABLE[U]!"PBTMCP " AND MULTITABLE[U]!"PUTMCP "   08293500
               THEN                                                     08293600
               BEGIN; STREAM(BUFF);                                     08294000
               DS~29 LIT "NOT PRINT/PUNCH BACK-UP TAPE~";               08294100
               IF PRINTORPUNCHWAIT(-U,MULTITABLE[U]="PUTMCP ") THEN     08295500
               GO F ELSE GO T ELSE GO S                                 08295600
                IF(I~DIRECTORYSEARCH("PBD    ",U&1[CTC],5))=0 THEN      08296400
                IF(I~DIRECTORYSEARCH("PUD    ",U&1[CTC],5))=0 THEN GO S 08296500
                 ELSE I.[3:1]~1;                                        08296550
              FORGETSPACE(I);IF PRINTORPUNCHWAIT(U.[6:24],I.[3:1]) THEN 08297000
                   IF I:=HEADER[5].[3:1] THEN HEADER[5].[3:1]:=0;       08709100
                   ENTERUSERFILE(IF I THEN "PUD    " ELSE "PBD    ",    08712000
                                 HEADER[6],HEADER INX 0-1);             08712100
                   HEADER[5].[3:1]:=I; %SET CP BK UP TOG                08712200
 NAME            INREC; DEFINE CONS="PBD    "#; DEFINE PUNS="PUD    "#; 13003000
        P(DIRECTORYSEARCH(-(IF V!22 THEN CONS ELSE PUNS),               13006820
          CURRPBNAME,13),DEL);                                          13006830
        P(DIRECTORYSEARCH(-(IF V!22 THEN CONS ELSE PUNS),               13006840
          CURRPBNAME,7),DEL);                                           13006850
    END;                                                                13006860
                        SI~LOC U; SI~SI+7; IF SC!"C" THEN DS~CHR ELSE   13007300
                        BEGIN DI~DI-2; DS~3LIT"CPA"; END;               13007325
     BEGIN IF V=22 THEN GO WHY; LOC:=SPACE(15);                         13044020
                   IF (HEADER:=DIRECTORYSEARCH(IF V!22 THEN CONS        13062000
                       ELSE PUNS,CURRPBNAME,3))=0                       13062100
                             FORGETSPACE(DIRECTORYSEARCH(IF V!22        13098125
                             THEN CONS ELSE PUNS,CURRPBNAME,13));       13098130
                        BEGIN IF V!22 THEN                              13098300
                        IF (HEADER:=DIRECTORYSEARCH(IF V!22 THEN        13112000
                            CONS ELSE PUNS,U,3))=0                      13112025
 QUIT:             IF V!22 THEN P(WAITIO(@4000100000,0,V),DEL);         13132000
                   PBCOUNT~PBCOUNT+((((A EQV"PBD    ")=NOT 0) OR        14599900
                           ((A EQV"PUD    ")=NOT 0)) AND (B.[CF]=1));   14599910
    OUR: STREAM(A~"LP":B~"MT",C~"DK",D~"CP",KTR);                       16111000
              SI~SI-2; DI~DI+6; IF 2 SC=DC THEN TALLY~5;                16117200
         PBCOUNT~PBCOUNT-((((A EQV"PBD    ")=NOT 0) OR                  18442000
                ((A EQV"PUD    ")=NOT 0)) AND (B.[CF]=1));              18443000
         IF (TYPE~SCAN)=PERIO THEN BEGIN TPNO~0; GO EXIT END;           20461000
         IF TYPE=BACK THEN                                              20461100
         TPNO~20 ELSE                                                   20461200
         BEGIN TPNO~21; IF SCAN!BACK THEN GO ERROR END;                 20461300
         IF SCAN=PERIO THEN GO ERROR;                                   20461400
         IF (TYPE~SCAN)=PERIO THEN                                      20461500
              TPNO~TPNO+4 ELSE                                          20461600
         IF TYPE=DISK THEN                                              20461700
              TPNO~TPNO+2 ELSE                                          20461800
         IF TYPE!TAPE THEN GO ERROR;                                    20461900
              IF TYPE!PERIO THEN GO NEXT ELSE GO EXIT;                  20461950
              PBCOUNT~PBCOUNT-((((CMM[0] EQV "PBD    ")=NOT 0) OR       20579720
                   ((CMM[0] EQV "PUD    ")=NOT 0)) AND (CMM[1].[CF]=1)) 20579730
                   +((((CMM[2] EQV "PBD    ")=NOT 0) OR                 20579740
                   ((CMM[2] EQV "PUD    ")=NOT 0)) AND (CMM[3].[CF]=1));20579750
                   IF (MULTITABLE[U]="PBTMCP " OR                       22188000
                       MULTITABLE[U]="PUTMCP ") AND                     22188100
                        STREAM(A~TINU[U],PN~MULTITABLE[U]="PUTMCP ",    22191000
                               AREA);                                   22191100
                                       PN(DS~3 LIT"#CP"; JUMP OUT TO L);22192100
                                       DS~3 LIT"#LP"; L:                22192200
                                       DS~12 LIT" BACK-UP ON ";         22193000
         PUNCH: STARTIO(U); IF UNIT[U].[15:3]=0 THEN                    22213500
              IF PRINTWAIT(-U) THEN GO TO COMMON; GO TO SCRATCH;        22213600
$VOID                                                                   22217000
BEGIN INTEGER GOTL,GOTT,GOTB,GOTP,GOTC;                                 37003000
      DEFINE PNTOG=(TYPE=0 OR TYPE GEQ 20)#;                            37007100
      REAL SUBROUTINE PUNCH;%                                           37019100
      BEGIN IF LABELTABLE[22]=0 THEN BEGIN U~22;P(1) END ELSE P(0);     37019200
            PUNCH~GOTC~P;                                               37019300
      END PUNCH;                                                        37019400
      BEGIN IF NOT(GOTL OR GOTB OR GOTC) THEN%                          37021000
      BEGIN IF NOT(GOTL OR GOTC) THEN                                   37039000
      IF TYPE>1 AND TYPE!4 AND TYPE!6 AND TYPE<15 THEN GO SOMEWHERE;    37046020
 ROUND:  IF TYPE=1 OR TYPE=4 OR (TYPE>16 AND TYPE<19) THEN              37046040
         IF TYPE=0 OR (TYPE>20 AND TYPE) THEN                           37046070
         IF PUNCH THEN BEGIN KIND~6; GO X END;                          37046075
         IF TYPE=4 OR TYPE=6 OR TYPE=16 OR TYPE=18 OR                   37046080
         (TYPE GEQ 20 AND NOT TYPE.[46:1]) THEN                         37046090
         BEGIN T1~0; T2~IF TYPE GEQ 20 THEN "PUTMCP " ELSE "PBTMCP ";   37046100
               T3~@122212342546447;                                     37046110
                             A~REEL,B~DATE,C~CYCLE,D~0,PN~TYPE GEQ 20,  37046192
                             T~T1-2);                                   37046194
                             PN(D~DI; DI~DI-6; DS~2LIT"UT"; DI~D);      37046205
                             PN(D~DI; DI~DI-14; DS~2LIT"UT"; DI~D);     37046212
      IF (TYPE GEQ 15 AND TYPE LEQ 18) OR TYPE GEQ 22 THEN              37046360
              M[T1+5]~MID&(TYPE GEQ 22)[3:47:1]; % CP BK UP TOG         37046630
 W3:     FILEMESS("#.. ..."&(IF TYPE=6 OR TYPE=20 THEN "   " ELSE       37046680
                  (IF PNTOG THEN "CP" ELSE "LP"))[12:36:12]             37046690
                  &(IF TYPE<2 THEN "   " ELSE IF TYPE GEQ 20 THEN       37046700
                  "PUT" ELSE "PBT")[30:30:18],                          37046710
                  (IF TYPE<2 THEN "RQD    " ELSE " MT RQD"),MID,FID,    37046720
         COMPLEXSLEEP(((IF (TYPE!6 AND TYPE!20) THEN IF PNTOG THEN      37046760
                  PUNCH ELSE PRINTER ELSE 0) OR REPLY[P1MIX]            37046770
                  >0 OR(IF TYPE>1 THEN BKUPTAPE OR MAGTAPE ELSE 0) OR   37046780
         IF NOT(GOTB OR GOTT OR GOTL OR GOTC) THEN                      37046820
              IF PNTOG THEN BEGIN U~REPLY[P1MIX].[FF]; GO CP END;       37046850
         IF GOTB THEN GO THERE ELSE IF GOTT THEN GO CLAIMT ELSE         37046940
         IF GOTC THEN KIND~6 ELSE KIND~1;                               37046950
CP:   TYPE~IF U=1 THEN 21 ELSE IF U=3 THEN 20 ELSE                      37058000
           IF U=5 THEN 0 ELSE 22; REPLY[P1MIX]~0; GO ROUND;             37059000
                 FILEMESS((IF TYPE GEQ 20 OR TYPE=0 THEN "PUD...."      38242100
                 ELSE "PBD....")&M[U+6][24:6:24],"OUT    ",             38243000
      BEGIN TYPE~IF (TYPE!0 AND TYPE<20) THEN 15 ELSE 22;               38265000
      BEGIN TYPE~IF (TYPE!0 AND TYPE<20) THEN 6 ELSE 20;                38285000
            BEGIN IF TYPE GEQ 20 THEN % MAKE CP BACK-UP LABEL           38325100
            BEGIN M[M[ALPHA-2] INX 4]:=FLAG(NABS(JAR[P1MIX,0]));        38325200
                  M[M[ALPHA-2] INX 5]:=FLAG(JAR[P1MIX,1]&17[1:43:5]);   38325300
                  STREAM(A:=[M[M[ALPHA-2] INX 6]]);                     38325400
                  BEGIN DS:=15 LIT" PUNCH BACK-UP "; DS:=LIT"%";        38325500
                        2(DS:=8 LIT"%%%%%%%%");                         38325600
                  END;                                                  38325700
            END ELSE % MAKE LP LABEL                                    38325800
                  M[M[ALPHA-2] INX 3]:=T1;                              38326500
            END;                                                        38326550
                  M[M[ALPHA-2] INX 1]:=MFID;                            38326600
      LABEL EOF,PBD,PUD;%                                               38548000
      REAL TYPE=+31;                                                    38562100
         BEGIN M[ALPHA].[FF]~@60020; IF TYPE<20 THEN CKBKUP;            38583000
      BEGIN IF TYPE<20 THEN CKBKUP;                                     38591100
            M[ALPHA]~(*P(DUP))&2[18:45:3]&M[ALPHA-2][8:8:10];           38592000
            IF I:=TYPE>20 THEN M[T+5].[3:1]:=0;                         38607100
            ENTERUSERFILE(IF I THEN P(PUD) ELSE P(PBD),R~M[T+6],T-1);   38608000
            IF PRINTORPUNCHWAIT(R.[6:24],I) THEN                        38609100
                 T~DIRECTORYSEARCH(IF I THEN P(PUD) ELSE P(PBD),        38609300
                   R&1[CTC],5);                                         38609350
                 FILEMESS((IF I THEN P(PUD) ELSE P(PBD))&R[24:6:24],    38610100
                         " REL:  ",MID,FID,0,0,0);                      38610200
            FOR T:=1 STEP 1 UNTIL R.[CF] DO                             38610300
            FORGETSPACE(DIRECTORYSEARCH(IF I THEN P(PUD) ELSE P(PBD),   38610400
                        R&T[CTC],14));                                  38610450
            STREAM(PN:=TYPE GEQ 20,D:=0,I);                             38626000
            BEGIN                                                       38626100
                 DS:=24LIT" LABEL  0PBTMCP 0BACK-UP";                   38626200
                 PN(D:=DI; DI:=DI-14; DS:=2LIT"UT"; DI:=D);             38626300
                 20(DS:=2LIT"  ");                                      38626400
            END;                                                        38626500
$VOID                                                                   38627000
     I:=IF AUTOPRINT THEN NOT PRINTORPUNCHWAIT(-U,TYPE GEQ 20)          38639000
        AND 1 ELSE 1;                                                   38639100
PUD:::   "PUD    ";                                                     38644500
                  &TINU[IF (KIND=7 OR KIND=12) THEN IF TYPE<20          39034000
                        THEN 20 ELSE 22 ELSE                            39034050
      IF TYPE=19 THEN GO TO DC19; IF TYPE>25 THEN GO TO DCN;            39092050
      IF (TYPE=0 AND NOT IO) OR TYPE GEQ 20 THEN                        39092060
      BEGIN IF USEPBD THEN TYPE~22; GO LOOKOUT END;                     39092070
                                            PBCOUNT~PBCOUNT+((((DDD[478 40309100
                                            -2|I]EQV"PBD    ")=NOT 0)   40309150
                                            OR((DDD[478-2|I]EQV"PUD    "40309200
                                            )=NOT 0))AND(DDD[479-2|I].  40309250
                                            [CF]=1));                   40309300
      REAL TYPE;                                                        41017300
BKUP: TYPE:=FPB[FNUM+3].[43:5]; BACKCLOSE(0);                           41144000
$#PATCH NUMBER 32 FOR MCP.XII   CONTAINS 45 CARDS            I                 &
$VOID                                                                   06056900
         IF N LEQ RESERVEDISKSIZE THEN% CALL OUT RESERVES               06353510
         IF (Z:=DIRECTORYSEARCH("RESERVE","DISK   ",6)) NEQ 0 THEN      06353530
         BEGIN FORGETSPACE(Z);                                          06353540
                    IF N>0 THEN IF NOT LIBMSG THEN                      06353542
                    BEGIN STREAM(Z~Z~SPACE(3));                         06353544
                          DS~23 LIT "**RESERVE/DISK REMOVED~";          06353550
                    SPOUT(Z);                                           06353551
                    END;                                                06353552
         END OF RESERVE CALL UP;                                        06353570
         IF AUTOUNLD THEN                                               06353580
         BEGIN P(P1MIX); AUTOUNLD:=P1MIX:=0;                            06353590
               STREAM(A:=DATE,Z:=Z:=SPACE(10)+2);                       06353600
               BEGIN DS:=23 LIT"CC UNLOAD EXPIRED TO XP";               06353610
                     SI:=LOC A; SI:=SI+3; DS:=5 CHR;                    06353620
                     DS:=9 LIT " =/=;END.";                             06353630
               END;                                                     06353640
               INDEPENDENTRUNNER(P(.CONTROLCARD),Z&31[3:43:5]);         06353650
               P1MIX:=P;                                                06353660
               IF N GEQ 0 THEN                                          06353670
               BEGIN STREAM(Z:=Z:=SPACE(10));                           06353680
                     DS:=18 LIT"18 AUTOUNLD RESET~";                    06353690
                     SPOUT(Z);                                          06353700
         END   END AUTOMATIC UNLOADING;                                 06353710
         IF NOT N.[2:1] THEN                                            06353720
              BEGIN                                                     06354100
                   END;                                                 06360505
              SPOUT(BUFF);                                              06360510
              REPLY[P1MIX]:=-@412;                                      06360520
              COMPLEXSLEEP((REPLY[P1MIX] GTR 0) OR                      06360530
                           (TERMIX.[CF]=P1MIX));                        06360540
              IF TERMIX.[CF]=P1MIX THEN                                 06360550
              BEGIN PRTROW[P1MIX].[7:1]~1;                              06360560
                    GO TO INITIATE;                                     06360570
              END;                                                      06360580
              IF NOT WHYSLEEP(@412) THEN                                06360590
              BEGIN BUFF~SPACE(10);                                     06360600
                    GO TO WHY;                                          06360610
              END;                                                      06360620
              BEGIN                                                     06361010
              SPOUT(BUFF);NT1~0;DO SLEEP([CLOCK],NOT CLOCK)             06361700
                                UNTIL (NT1~NT1+1)=30;                   06361705
              END                                                       06361710
$VOID 06365001                                                          06362000
$VOID 06380061                                                          06365120
$#PATCH NUMBER 33 FOR MCP.XII   CONTAINS  7 CARDS            I                 &
    L ~ GETSPACE(335,0,0)+2;                                            08568600
    M[L+10] ~ GETUSERDISK(-(M[L+8]~M[L+8]+10)); % GET XTRA TEN          08569700
    DO BEGIN                                    % TO MAKE COPY          08569800
         DISKWAIT (-L-31,300,M[J+10]+I);        % SIMPLER               08569900
         DISKWAIT ( L+31,300,M[L+10]+I);                                08569910
    END UNTIL (I~I+10)}M[J+8];                                          08569920
    LOGFREE ~ M[J+10];                                                  08570000
$#PATCH NUMBER 34 FOR MCP.XII   CONTAINS 5 CARDS             I                 &
            IF DIREC AND NOT FIB[16].[22:1] THEN                        38180000
              FOR CNTCTL~DIREC STEP 1 UNTIL 2 DO% DIREC = 0 OR 1    %DB 38198010
              P(WAITIO(@4740000005&(NOT DIREC)[22:47:1],@377,U),DEL);%DB38198020
                  IF NOT REW THEN                                       38752000
                       IF NOT UNLABELED THEN                            38754100
$#PATCH NUMBER 35 FOR MCP.XII   CONTAINS 15 CARDS            I                 &
              REAL LUN,TM,REEL,T;                                       02661000
              STREAM(A~PRNTABLE[LUN].[30:18],T~[T],L~LBL+6);            02664000
              BEGIN DI~DI+5; SI~LOC A; DS~5DEC; SI~SI-8; DI~T;          02664100
                    DS~8DEC; DI~DI-7; DS~6FILL;               END;      02665000
                   FILEMESS(" OUT"&TINU[LUN][6:30:18],T,M[LBL+1],       02668500
         STREAM (S~PRNTABLE[U].[18:30],T~[T]);                          28091100
         BEGIN SI~LOC S; DS~8DEC; DI~DI-7; DS~6FILL; END;               28091200
         IF OPNMESS THEN FILEMESS(" IN "&TINU[U][6:30:18],T,0,MID,1,0,0)28092000
                 BEGIN IF U GEQ 16 THEN T1 ~0 ELSE                      38118010
                        STREAM(S~PRNTABLE[U].[30:18],D~[T1]);%          38118100
                        BEGIN SI ~ LOC S; DS ~ 8 DEC;         %         38118200
                              DI ~ DI-7; DS ~ 6 FILL;         %         38118300
                        END;                                  %         38118400
                           &TINU[U][6:30:18],T1,MFID,FID,REEL,%         38120000
                 END;                                                   38121100
$#PATCH NUMBER 36 FOR MCP.XII   CONTAINS 24 CARDS            I                 &
PROCEDURE LOGCOMMENT (Q); VALUE Q; REAL Q;  FORWARD;                    02434790
              "OC",% 65                                                 08168454
PROCEDURE LOGCOMMENT (Q); VALUE Q; REAL Q;                              15610000
    BEGIN                                                               15611000
REAL     I,J,K,L;                                                       15612000
ARRAY    LOG[*];                                                        15613000
         L ~ GETSPACE(72,0,0)+2;                                        15614000
         STREAM (Q:D~L+5);                                              15615000
         BEGIN  SI ~ Q;                                                 15616000
         L:   IF SC!"~" THEN BEGIN DS ~ CHR; GO TO L; END;              15617000
              5(DS ~ 8 LIT " "); DI ~ DI-32; Q ~ DI;                    15618000
         END;                                                           15619000
         I ~ P.[33:15]; LOG ~ [M[L]] & (I-L+4)[8:38:10];                15620000
         LOG[3] ~ I ~ I-L-5; % NUMBER OF WORDS IN COMMENT               15621000
         WHILE (J~XCLOCK+P(RTR))}5184000 DO MIDNIGHT;                   15622000
         LOG[2] ~ DATE.[18:30];                                         15623000
         LOG[1] ~ J;                                                    15624000
         LOG[0] ~ 99;                                                   15625000
         LOGSPACE([LOG[0]],I+9);                                        15626000
         FORGETSPACE(LOG);                                              15627000
    END;                                                                15628000
         LABEL MR,XD,OC;                                                16009800
                           ,XD,OC                                       16020160
    OC:  LOGCOMMENT(KTR); GO TO FORGET;                                 16081100
$#PATCH NUMBER 37 FOR MCP.XII   CONTAINS 4 CARDS             I                 &
ELSE IF I+N+100 GEQ J THEN K ~ 2 % NEARLY FULL                          05706000
              IF VECTOR[2].[8:10]=0 THEN L ~ LOG[29];                   06217100
              IF FILEBLOCK[J-1]=0 THEN LOG[TIMEX -1]~*P(DUP)-1 ELSE     06230100
              N ~ LOG[TIMEX -1]|5;                                      06243100
$#PATCH NUMBER 38 FOR MCP.XII   CONTAINS  24 CARDS           I                 &
              FAST      = 94#,                                          20247900
              "FAST   ",94,                                             20286400
              IF CN>NEUP.NEUF THEN GO TO INCSC;                         20568611
              ELSE IF CN=SLOW THEN CMM[19]~P(DUP,LOD) OR M ELSE         20568630
              IF CN=FAST THEN CMM[19]~-CMM[19] ELSE GO TO INCSC;        20568640
         LIBNO~ABS(CMM[19]);                                            20572000
          EXT,OK,WY,                                                    28010100
    COMMON ~ IF COMMON.[9:6]!0 THEN -COMMON.[9:6] OR M ELSE             28201200
             IF COMMON.[1:1] THEN 1 OR M ELSE                           28201300
             IF COMMON.[2:1] THEN 2 OR M ELSE 0;                        28201400
OK:                IF (H[9+W]~PETUSERDISK(-H[8],COMMON))<1 THEN         28310000
                   BEGIN                                                28311000
$ VOID 28311200                                                         28311100
WY:                     LBMESS(-X[J],X[J+1],".#NO US","ER DISK"," ",    28311200
                               0,TINU[U]);                              28311300
                        REPLY[P1MIX] ~ -@04101220;                      28311400
                        COMPLEXSLEEP(REPLY[P1MIX]}0 OR DSED             28311500
                                     OR PRT[P1MIX,@25]=5);              28311600
                        IF NOT WHYSLEEP(@4101220) THEN GO TO WY;        28311700
                        IF REPLY[P1MIX]=4 THEN GO TO OK;                28311800
                        IF DSED THEN ABORT;                             28311900
                        IF  REPLY[P1MIX]=8 THEN                         28311910
                        BEGIN COMMON ~ COMMON AND NOT M; GO TO OK; END; 28311920
                        PRT[P1MIX,@25] ~ 0;                             28311930
$#PATCH NUMBER 39 FOR MCP.XII    CONTAINS  46  CARDS         I                 &
                   DSZE~IF P(M[P(DUP)+1],TOP) THEN P ELSE P.[8:10],     02222200
                   TOG~(N=7), Q~[B[N]], A);                             02223000
      IF I=(-7) THEN BEGIN  R4~R5;  R5~R6;  END;                        19155100
            FIRST~(((56|UL+OF)|512|ABS(COBOL)+2)|64+12)|64+10;          37225000
            IF COBOL>0 AND (FIB[13].[22:1] OR TYPE=10) THEN             38024100
                          &P(FLAG(FIB[19-ABS(3|COBOL)]),XCH)[CTC];      38044000
      IF COBOL<0 THEN   % ADJUST UPPER BOUND FOR COBOL 68               38049200
         BEGIN  MASK ~ (IF IO AND NOT FIB[13].[22:1]                    38049300
                   THEN HEADER[7]                                       38049400
                   ELSE  (((HEADER[9] | HEADER[1]) DIV                  38049500
                            HEADER[0].[42:6]) | HEADER[0].[30:12]) - 1);38049600
         IF FIB[3]=0 OR FIB[3]>MASK THEN FIB[3]~MASK; %LESSOR OF 2 EVILS38049700
         END;                                                           38049800
           IF COBOL<1 THEN     % ALGOL OR COBOL 68                      38052000
              FOR MASK ~ 0 STEP 1 UNTIL NBUFS-1 DO                      38053000
              IF COBOL THEN M[M[ALPHA+MASK] INX NOT 2] ~ NOT 0          38053500
                        ELSE M[ALPHA+MASK]~P(DUP,LOD)&1[27:47:1];       38054000
              BEGIN  IF COBOL>0 THEN                                    38062000
                        IF NOT (FIB7=0 OR FIB[13].[22:1]) THEN          38062500
                        BEGIN  FIB7 ~ FIB7 - 1;                         38063000
                               OPTIONAL ~ NBUFS - 1;                    38063500
                        END ELSE  OPTIONAL ~ NBUFS - 2                  38064000
                        ELSE BEGIN      % COBOL 68                      38064200
                             OPTIONAL ~ NBUFS - 1;                      38064400
                             IF DIREC THEN FIB7 ~ FIB[7] ~ FIB[3];      38064600
                             END;                                       38065000
               FORMS~((HEADER[0].[30:12]|T1)&DIREC[1:47:1])+FIB7,       38076000
                   IF COBOL<0 THEN M[M[ALPHA] INX NOT 2] ~              38082400
                      (IF FORMS}0 THEN FORMS DIV FIB[11] ELSE NOT 0);   38082500
             IF COBOL } 0 THEN          % NOT COBOL 68                  38092900
            BEGIN IF COBOL > 0 THEN              % COBOL61              38391020
                  BEGIN ACCESS ~ 4;                                     38391030
                  IF FIB[13].[10:9] = 2 THEN     % SEEK IN PROCESS      38391040
                     BEGIN COOLOFF; FIB[13].[10:9] ~ 1;  END            38391050
                  END ELSE IF FIB[17]<BLEN THEN ACCESS~4;  % COBOL68    38391060
      STATE~FIB[5];  UNLABELED~FIB[4].[2:1];                            39090000
      COBOL~(FIB[13] AND 1)&([FIB].[8:10]=22)[1:47:1];  % COBOL 60 & 68 39091100
      IF COBOL>0 OR FIB[4].[7:1] THEN     % COBOL 60 OR SORT            39092010
FILLBUFFERS(FIB[16],FIB[19-3|ABS(COBOL)],NBUFS-ABS(COBOL),NBUFS);%%%%%% 39146000
IF COBOL THEN FIB[16]~(*P(DUP))&M[ALPHA][CTC]; %%%%%%%%%%%%%%%%%%%%%%%% 39147000
            IF COBOL>0 OR FIB[4].[7:1] THEN M[FIB INX NOT 1].[3:6] ~ 6  39304000
      COBOL~(FIB[13] AND 1)&([FIB].[8:10]=22)[1:47:1];  % COBOL 60 & 68 41051000
      IF COBOL>0 OR FIB[4].[7:1] THEN  % COBOL 60 OR SORT               41051100
    IF COBOL>0 OR FIB[4].[7:1] THEN        % COBOL 60 OR SORT           41212100
         ELSE IF JAR[P1MIX,2] < 0 THEN IF PRT[P1MIX,11].[FF] = 0 THEN   42551090
              PRT[P1MIX,11]~1 ELSE PRT[P1MIX,PRT[P1MIX,11].[FF]]~1      42551100
$#PATCH NUMBER 40 FOR MCP.XII   CONTAINS 3 CARDS             C                 &
$INCLUDE 14206306, IF STATISTICS;                                       14206299
              COUNTUP(19+(DISKADDR GTR 0),(SIZE+29) DIV 30);            14206305
$VOID                                                                   14206400
$#PATCH NUMBER 41 FOR  MCP.XII   CONTAINS 14  CARDS          C                 &
     USERCODE[MIX]~ABS(S[24]);                                          20088200
$VOID                                                                   20092980
         A~[M[SPACE(210)]]&210[8:38:10];                                22904000
         DISKWAIT(-A.[CF],210,ESPDISKTOP+1);                            22907000
         A[180+P1MIX]~USERCODE[P1MIX];                                  22917000
         DISKWAIT(A.[CF],210,ESPDISKTOP+1);                             22918000
    ESPDISKTOP~ESPDISKBOTTOM+I-8; %TOP OF ESPDISK                       44087100
              DISKWAIT(-30-A,210,ESPDISKTOP+1);                         44211000
                   BEGIN GI~[M[SPACE(210)]]&210[8:38:10];               44220000
                        MOVE(210,A+30,GI);                              44221000
                        MOVE(206,A+33,A+34);                            44223000
                        DISKWAIT(A+30,210,ESPDISKTOP+1);                44224000
                   USERCODE[I]~GI[I+180];P1MIX~I;                       45123000
                   P1MIX~0;                                             45130100
$#PATCH NUMBER 42  FOR MCP.XII    CONTAINS  2 CARDS          C                 &
         ELSE IF JAR[P1MIX,2] < 0 THEN IF PRT[P1MIX,11].[FF] = 0 THEN   42551090
              PRT[P1MIX,11]~1 ELSE PRT[P1MIX,PRT[P1MIX,11].[FF]]~1      42551100
$#PATCH NUMBER 43 FOR MCP.XII    CONTAINS  2  CARDS          C                 &
                   SEGZERO~[M[SPACE(5)]];                               45110000
                   STREAM(A~[LDATE],B~[X[5]]);                          45116000
$#PATCH NUMBER 44 FOR MCP.XII    CONTAINS  2 CARDS           C                 &
                        PRT[P1MIX,@23]:=1;                              13097100
                   IF NOT (SVPBT OR PRT[P1MIX,@23]) THEN                13135200
$#PATCH NUMBER  45 FOR MCP.XII   CONTAINS  2 CARDS           C                 &
            IF NOT PRTROW[P1MIX].[7:1] THEN                             38573000
            IF FIB[14].[CF]=FIB[14].[FF]                                38573100
$#PATCH NUMBER  46 FOR MCP.XII    CONTAINS  2 CARDS          I                 &
                        M[BOUF INX 11].[42:6]~31; % GP MK               21247100
                   M[BOUF INX 11].[42:6]~31; % GP MK                    21276100
$#PATCH NUMBER  47 FOR MCP.XII   CONTAINS  1 CARDS            C                &
              M[KTR-4].[9:6]:=0;                                        16184020
$# PATCH NUMBER 48 FOR MCP.XII   CONTAINS  3 CARDS           C                 &
     IF CODE!3 THEN                                                     08103450
    BEGIN                                                               08103460
    END;                                                                08103650
$#PATCH NUMBER  49  FOR MCP.XII    CONTAINS 6 CARDS          C                 &
              "8INVALI","8D BLOC","8K EXIT", % 78                       02345760
                   I:=AIT[0]+1;                                         42488000
                   IF (BCNTR:=PRT[P1MIX,CURBLKCNTR]) LEQ 0 THEN         42488100
                   BEGIN TERMINATE(P1MIX);                              42488200
                        TERMINALMESSAGE(78);                            42488300
                   END;                                                 42488400
$#PATCH NUMBER 50 FOR MCP.XII   CONTAINS  1 CARDS            C                 &
                   IF I GTR PSEUDOMAX1 THEN  I:=NABS(RUNUMBER)  ELSE    07462200
$#PATCH NUMBER 51 FOR MCP.XII   CONTAINS 1 CARDS             C                 &
                   STREAM(A~PRNTABLE[U].[30:18],TL);                    02434424
$#PATCH NUMBER 52  FOR MCP.XII    CONTAINS 13 CARDS          C                 &
              LABEL L,PAR,DCW,INQ,CHECKSMW;                             24505000
                                       GO TO CHECKSMW;                  24531310
                                       IF NOT RD.[23:1] THEN            24533510
CHECKSMW:                              IF STA LSS 0 THEN                24533520
                                       BEGIN IF EF NEQ @0040 THEN       24533530
                                            IF P(STATIONMESSAGEHOLDER,  24533540
                                            STA AND @0007570000000000,  24533550
                                            LLL,RFB,.EF,STD).[9:9] =    24533560
                                            STA.[9:9] THEN              24533570
                                            M[EF].[3:1]:=1;             24533575
                                            RUNSMW;                     24533580
                                            GO TO L;                    24533585
                                       END ELSE IF RD.[24:1] THEN GO L; 24533590
$#PATCH NUMBER 53 FOR MCP.XII   CONTAINS 2 CARDS              C                &
              IF P(ILL,0&STA[9:9:9],LLL,DEL).[9:9] = STA.[9:9] THEN     23243200
              GO TO DCW;                                                23243400
$#PATCH NUMBER 54 FOR MCP.XII   CONTAINS 2 CARDS                               &
              ACTDATE:=WEEKDAY:=0;                                      44241150
$VOID                                                                   44242002
$#PATCH NUMBER 55 FOR MCP.XII    CONTAINS  13 CARDS          C                 &
                   BEGIN                                                08434000
                        B:=NOT I; I:=0;                                 08434100
                        IF U=23 THEN H:=P(.READERA);                    08434200
                        IF U=24 THEN H:=P(.READERB);                    08434300
                        IF H ! 0 THEN                                   08434400
                        BEGIN UNITCODE[U-23]:=-0;                       08434500
                             IF (*H).[CF] ! 0 THEN                      08434600
                             BEGIN FORGETSPACE(*H-2);                   08434700
                                  M[H]:=0;                              08434800
                   END  END  END;                                       08434900
$VOID                                                                   08434910
         IF UNITNO=23 THEN READERA:=0 ELSE                              20608510
         IF UNITNO=24 THEN READERB:=0 ELSE                              20608520
$#PATCH NUMBER 56  FOR MCP.XII    CONTAINS 14 CARDS          C                 &
$VOID 09515201                                                          09515100
         DS:=4 LIT" XII"; SI:=LOC A;                                    15503000
         IF SC GEQ " " THEN;                                            15503100
         8(IF TOGGLE THEN IF SC="0" THEN SI:=SI+1 ELSE DS:=CHR ELSE     15503200
           DS:=CHR);                                                    15503300
              DS:=3 LIT"XII";                                           44204600
              SI:=LOC S; IF SC GEQ " " THEN;                            44205000
              8(IF TOGGLE THEN IF SC="0" THEN SI:=SI+1 ELSE DS:=CHR     44205050
                ELSE DS:=CHR);                                          44205100
              DS:=6 LIT" MODS ";                                        44205200
              SI:=MEMASK; SI:=SI-1;                                     44205300
              8(SI:=SI+8; IF SC="1" THEN DS:=LIT"@" ELSE DS:=LIT"R");   44205400
              DS:=4 LIT"  -~";                                          44206000
              END;                                                      44206100
$#PATCH NUMBER 57 FOR MCP.XII   CONTAINS  2 CARDS            C                 &
      BEGIN BLEN:=10;                                                   38256000
            FIB[18]:=(*P(DUP))&BLEN[CTC]&BLEN[CTF]&BLEN[3:33:15];       38256500
$#PATCH NUMBER 58 FOR MCP.XII    CONTAINS 10  CARDS          C                 &
$INCLUDE 14411741, IF DATACOM AND NOT INQUIRY;                          14411499
              IF CHAIN GTR 0 THEN                                       14411620
              BEGIN S:=[M[GETSPACE(5,0,0)+2]]&5[8:38:10];               14411640
                   DISKWAIT(-(S INX 0),5,CHAIN);                        14411660
                   ZIPPER(S[1],S[2],S[3]);                              14411680
                   FORGETSPACE(S);                                      14411700
              END;                                                      14411720
              IF CHAIN ! 0 THEN FORGETESPDISK(ABS(CHAIN));              14411740
$INCLUDE 14431111, IF DATACOM AND NOT INQUIRY;                          14431100
$VOID 14431281                                                          14431200
$#PATCH NUMBER 59 FOR MCP.XII    CONTAINS  1 CARDS           C                 &
                          IF P(NT6,DUP)=4 OR P(XCH)=8 THEN CDATE~0;     38015400
$#PATCH NUMBER  61 FOR  MCP.XII    CONTAINS  4  CARDS        C                 &
         I := (MIXMAX+1)|11                      % PRT THRU USERCODE    44151000
$ INCLUDE 44151046,IF AUXMEM;                                           44151034
              +P(MIXMAX+1,DUP,+)                 % AUXDATA,AUXCODE      44151035
$VOID                                                                   44151044
$#PATCH NUMBER 62  FOR MCP.XII    CONTAINS  5 CARDS          C                 &
         IF TERMIX.[CF]=P1MIX THEN                                      14583000
         BEGIN FOR I~M[L+10]+10 STEP -1 UNTIL 11 DO                     14583100
               IF M[L+I]!0 THEN FORGETUSERDISK(M[L+I],-M[L+9]);         14583200
         GO TO BOMBOUT;                                                 14583300
         END;                                                           14583400
$#PATCH NUMBER  63  FOR MCP.XII    CONTAINS 11 CARDS          C                &
                                     ELSE IF SC = @20 THEN DS:=10 LIT   14647500
                                          " WRT/SEEK "                  14647600
              FIB:=M[P(.TANK,LOD) INX NOT 2];                           14668210
              IF FIB[14] NEQ 0 THEN  %CANT WRITE A SOUGHT FILE          14668220
              BEGIN INFO:=-" INV"; GO TO MESSAGE; END;                  14668230
 IF FIB[14] = 0 THEN                                                    21542300
 FOR I:=NUMBUFS-1 STEP -1 UNTIL 0 DO                                    21542400
 IF M[ADRNUQWD] NEQ 0 THEN  %CANT SEEK AN OUTPUT FILE                   21542500
 BEGIN I:=2; GO TO DSER; END;                                           21542600
         STREAM(X:=(I=1),Y:=(I=2),T1);                                  21586000
                   Y(DS:=14 LIT "SEEK ON WRIT ~"; JUMP OUT TO EX);      21589500
$#PATCH NUMBER  64  FOR MCP.XII    CONTAINS  2 CARDS         C                 &
$VOID                                                                   38013800
            FIB[5].[45:1]~0;                                            38045100
$#PATCH NUMBER  65 FOR  MCP.XII    CONTAINS  1 CARDS         C                 &
         IF (A~GETUSERDISK((N~RESERVEDISKSIZE)&1[2:47:1]))=0 THEN       05954800
$#PATCH NUMBER 66 FOR MCP.XII    CONTAINS  1 CARDS           C                 &
              STREAM(S~S~SPACE(4));                                     07429100
$#PATCH NUMBER 67  FOR MCP.XII    CONTAINS  4  CARDS         C                 &
         LABEL GETHDR,IN,OUT,AROUND,XOUT;                               08098100
     IF ((A EQV B)=NOT 0) AND ((A EQV "~      ")=NOT 0) THEN GO XOUT;   08103100
 OUT:    IF CODE!0 OR (CODE=0 AND STA.[9:9]!0) THEN FORGETSPACE(HDR);   08130000
XOUT:    FORGETSPACE(NB);                                               08130100
$#PATCH NUMBER  68 FOR MCP.XII    CONTAINS  4 CARDS          C                 &
               BEGIN PG:=HDR[9] AND @37;                            %RH 08099510
                    INFO:=0; WHILE (INFO:=INFO+1) LEQ PG DO IF      %RH 08099520
                    HDR[INFO+9]!0 THEN INFOTEMP:=INFOTEMP+1;        %RH 08099530
                    INFO:=(INFOTEMP|HDR[8])&4[1:43:5]; INFOTEMP:=0; %RH 08099540
$#PATCH NUMBER  69 FOR MCP.XII CONTAINS   4 CARDS          I                 &&&
%B 5 7 0 0   M C P  M A R K     X I I . 78                 05/15/71     00001000
$INCLUDE 19297201, IF AUXMEM;                                           19294099
$VOID                                                                   22325399
         "78"                                                           44203100
$#PATCH NUMBER  70 FOR MCP.XII CONTAINS   7 CARDS          I                 &&&
         REAL T, COB68;                                                 15066000
         COB68 ~ (FIB ~ *(FLOC)).[8:10] = 22;                           15073000
         IF NOT COB68 THEN                                              15080900
         IF NOT COB68 THEN                                              15102900
      BEGIN IF COBOL { 0 THEN          % ALGOL OR COBOL68               39145200
      FILLBUFFERS(FIB[16],FIB[19-3|ABS(COBOL)],NBUFS-(COBOL>0),NBUFS);  39146000
      IF COBOL>0 THEN FIB[16]~(*P(DUP))&M[ALPHA][CTC];                  39147000
$#PATCH NUMBER  71 FOR MCP.XII CONTAINS   4 CARDS          C                 &&&
         P(GETSPACE(128,12,0)+1,STS,CANCELSTA,RCW,0,RDS,0,XCH,CFX,STF); 03500800
    P(GETSPACE(128,12,0)+1,STS,BUFF,RCW,0,RDS,0,XCH,CFX,STF);           05953000
     P(GETSPACE(128,12,1)+1,STS,RCW,0,RDS,0,XCH,CFX,STF);               41402100
     P(GETSPACE(128,12,1)+1,STS,FILE,RCW,0,RDS,0,XCH,CFX,STF);          41405810
$#PATCH NUMBER  72 FOR MCP.XII CONTAINS   1 CARDS          C                 &&&
              UNITCODE[R+9]:=-0;                                        07409300
$#PATCH NUMBER  73 FOR MCP.XII CONTAINS   6 CARDS          C                 &&&
$VOID                                                                   08697299
$VOID 44241364                                                          44241350
         IF(I~DIRECTORYSEARCH("SYSTEM ","LOG    ",5))!0 THEN            44241375
         BEGIN LOGFREE~NABS(M[I INX 10]); FORGETSPACE(I) END;           44241376
         CLEANOUT(SYSNO);                                               44241397
         SETUPSCRATCHDIRECTORY;                                         44241398
$#PATCH NUMBER  74 FOR MCP.XII CONTAINS   2 CARDS          C                 &&&
                                 IF UNITNO = 31 THEN                    20374310
                                 BEGIN I~PERIO; GO TO TYPE1 END;        20374320
$#PATCH NUMBER  75 FOR MCP.XII CONTAINS 171 CARDS          C                 &&&
$ VOID 00005101                                                         00005100
$ VOID 00012001                                                         00011000
$ VOID                                                                  00059000
$ VOID 00124001                                                         00124000
$ VOID 00137001                                                         00137000
$ VOID 00139001                                                         00139000
$ VOID                                                                  00151000
$ VOID 00167001                                                         00167000
                    1- 4 = TYPE OF I/O DEVICE%                          00192000
              @0400007777777777, COMMENT MTE =  4;%                     00214000
              @0400007777777777, COMMENT MTF =  5;%                     00215000
              @0400007777777777, COMMENT MTH =  6;%                     00216000
              @0400007777777777, COMMENT MTJ =  7;%                     00217000
              @0400007777777777, COMMENT MTK =  8;%                     00218000
              @0400007777777777, COMMENT MTL =  9;%                     00219000
              @0400007777777777, COMMENT MTM = 10;%                     00220000
              @0400007777777777, COMMENT MTN = 11;%                     00221000
              @0400007777777777, COMMENT MTP = 12;%                     00222000
              @0400007777777777, COMMENT MTR = 13;%                     00223000
              @0400007777777777, COMMENT MTS = 14;%                     00224000
              @0400007777777777, COMMENT MTT = 15;%                     00225000
$ VOID                                                                  00296315
$ VOID                                                                  00296345
$ VOID 00298001                                                         00298000
$ VOID 00300051                                                         00300000
$ VOID 00303001                                                         00303000
$ VOID 00337001                                                         00337000
$ VOID 00340001                                                         00340000
$ VOID 00379301                                                         00379300
$ VOID 00381001                                                         00381000
$ VOID 00388001                                                         00388000
$ VOID 00419201                                                         00419200
$ VOID 00423001                                                         00423000
$ VOID                                                                  01023000
$ VOID                                                                  02121010
$ VOID 02134031                                                         02134030
$ VOID 02153001                                                         02153000
$ VOID 02160001                                                         02160000
$ VOID 02166001                                                         02166000
$ VOID 02170001                                                         02170000
$ VOID 02174046                                                         02174045
$ VOID 02174061                                                         02174060
$ VOID 02378001                                                         02378000
$ VOID 02396001                                                         02396000
$ VOID                                                                  02773200
$ VOID                                                                  02780600
$ VOID                                                                  02784100
$ VOID                                                                  02872500
$ VOID                                                                  02897800
$ VOID                                                                  02955800
$ VOID 02962111                                                         02962100
$ VOID 03501501                                                         03501300
$ VOID 03502201                                                         03502200
$ VOID 04098501                                                         04098400
$ VOID 04428001                                                         04428000
$ VOID 04468401                                                         04468400
$ VOID 05002001                                                         05002000
$ VOID 05006001                                                         05006000
$ VOID 05010001                                                         05009000
$ VOID 05015001                                                         05015000
$ VOID 05021501                                                         05021500
$ VOID 05025001                                                         05024000
$ VOID 05031101                                                         05031000
$ VOID 05037501                                                         05034000
$ VOID 05051001                                                         05050000
$ VOID                                                                  05057000
$ VOID                                                                  05070680
$ VOID                                                                  05072000
$ VOID                                                                  05077500
$ VOID 05078921                                                         05078800
$ VOID 05088201                                                         05088100
$ VOID                                                                  05091000
$ VOID                                                                  05120000
$ VOID                                                                  05122000
$ VOID 05125021                                                         05125010
$ VOID                                                                  05126200
$ VOID                                                                  05127130
$ VOID 05128101                                                         05128000
$ VOID                                                                  05130100
$ VOID 05135001                                                         05133000
$ VOID                                                                  05135320
$ VOID                                                                  05138000
$ VOID 05142001                                                         05140100
$ VOID                                                                  05499999
$ VOID 05507001                                                         05505000
$ VOID                                                                  05509000
$ VOID 05527001                                                         05526000
$ VOID                                                                  05529000
$ VOID                                                                  05532000
$ VOID                                                                  05558000
$ VOID                                                                  05565000
$ VOID                                                                  05601000
$ VOID 05714001                                                         05713000
$ VOID 05781011                                                         05780900
$ VOID 05806401                                                         05806300
$ VOID 05809501                                                         05809400
$ VOID                                                                  05810800
$ VOID 05811161                                                         05811150
$ VOID 05813636                                                         05813620
$ VOID 05827201                                                         05827100
$ VOID 05837701                                                         05837600
$ VOID 05839396                                                         05839390
$ VOID                                                                  05839500
$ VOID                                                                  05839900
$ VOID 05841101                                                         05841000
$ VOID 05842001                                                         05841800
$ VOID 05846596                                                         05846590
$ VOID                                                                  05846700
$ VOID                                                                  05847300
$ VOID 05848801                                                         05848600
$ VOID                                                                  06179100
$ VOID                                                                  06179400
$ VOID                                                                  06264000
$ VOID                                                                  06353000
$ VOID                                                                  06463955
$ VOID                                                                  06465890
$ VOID                                                                  06502000
$ VOID                                                                  06530000
$ VOID                                                                  06538000
$ VOID                                                                  06666000
$ VOID                                                                  06676000
$ VOID                                                                  06687000
$ VOID                                                                  06693000
$ VOID 06722001                                                         06721000
$ VOID 06730001                                                         06729000
$ VOID                                                                  06747000
$ VOID                                                                  06750000
$ VOID                                                                  06772000
$ VOID                                                                  06818000
$ VOID 06827301                                                         06827000
$ VOID                                                                  06847800
$ VOID                                                                  06852700
$ VOID                                                                  06855300
$ VOID                                                                  06874800
$ VOID                                                                  07168000
$ VOID                                                                  07172000
$ VOID                                                                  07435100
$ VOID                                                                  07443000
$ VOID                                                                  07544000
$ VOID                                                                  08040000
$ VOID                                                                  08100000
$ VOID 08136011                                                         08136000
$ VOID                                                                  08136062
$ VOID                                                                  08136200
$ VOID                                                                  08264500
$ VOID                                                                  08293000
$ VOID                                                                  08533300
$ VOID                                                                  08539000
$ VOID                                                                  08672000
$ VOID                                                                  08675000
$ VOID                                                                  08694000
$ VOID                                                                  08848500
$ VOID                                                                  08857500
$ VOID                                                                  08871000
$ VOID                                                                  08909000
$ VOID                                                                  08915500
$ VOID                                                                  08948000
$ VOID                                                                  09016000
$ VOID                                                                  09084000
$ VOID                                                                  09096000
$ VOID                                                                  09114000
$ VOID                                                                  09118000
$ VOID                                                                  09199000
$ VOID                                                                  09211000
$ VOID                                                                  09215000
$ VOID                                                                  09224000
$ VOID                                                                  09251000
$ VOID                                                                  09266000
$ VOID                                                                  09301200
$ VOID                                                                  09504100
$ VOID                                                                  09650000
$#PATCH NUMBER  76 FOR MCP.XII CONTAINS   9 CARDS          C                 &&&
$ INCLUDE 09701601, IF STATISTICS;                                      09701599
LABEL STATS,STLOG;                                                      09701600
$ INCLUDE 09708301, IF STATISTICS;                                      09708099
         ELSE IF (B EQV P(STATS))= T THEN%                              09708100
              P(((A EQV P(SYS))=T) OR                                   09708200
              ((A EQV P(STLOG))=T))                                     09708300
$ INCLUDE 09720801, IF STATISTICS;                                      09720699
    STATS:::  "STATS  ";%                                               09720700
    STLOG:::  "STLOG  ";%                                               09720800
$#PATCH NUMBER  77 FOR MCP.XII CONTAINS   1 CARDS          C                 &&&
$VOID                                                                   44243000
$#PATCH NUMBER  78 FOR MCP.XII CONTAINS  12 CARDS          C                 &&&
                   BEGIN B:=NOT I; H:=I:=0;                             08434000
                        IF U=23 THEN H:=P(.READERA);                    08434100
                        IF U=24 THEN H:=P(.READERB);                    08434200
                        IF H!0 THEN                                     08434300
                        BEGIN UNITCODE[U-23]:=-0;                       08434400
                             IF (*H).[CF]!0 THEN                        08434500
                             BEGIN FORGETSPACE(*H-2);                   08434600
                                  M[H]:=0;                              08434700
                             END;                                       08434800
                        END;                                            08434900
                   END;                                                 08434950
         HN1:=0;                                                        16186550
$#PATCH NUMBER 79 FOR MCP.XII CONTAINS  3  CARDS           I                 &&&
%B 5 7 0 0   M C P  M A R K     X I I . 98                 06/15/71     00001000
         IF (A.[1:5]!0 OR B.[1:5]!0 OR A=@114 OR A=@14) THEN            14559300
                   "98"                                                 44203100
$#PATCH NUMBER 80 FOR MCP.XII CONTAINS  5  CARDS           I                 &&&
               REAL BUFF = RCW+2;  %KEYIN = RCW+1                       16002000
              CFX,STF,0); STACKUSE:=TRUE; END;                          16026000
                   IF SC="~" THEN BEGIN MIX:=SI; GO TO XXIT; END;       16033500
              IF P(.KTR,~,.MIX,SND) GTR @777 THEN                       16044000
              BEGIN KEYIN:=TRUE; GO TO FORGET; END;                     16044500
$#PATCH NUMBER 81 FOR MCP.XII CONTAINS  3  CARDS           I                 &&&
              STREAM(BUFF); DS:=11 LIT "{<!BREAK{!~";                   25192023
              RD:=BUFF INX (0&STAJG[9:9:9]&1[3:47:1]);                  25192024
              WRITERD;                                                  25192027
$#PATCH NUMBER 82 FOR MCP.XII CONTAINS   2 CARDS           I                 &&&
         IF HN1!0 OR TYPE ! 41 THEN  %ALWAYS ALLOW SS                   16064250
                   IF IT="SS" THEN IT:=7 ELSE                           25184500
$#PATCH NUMBER 83 FOR  MCP.XII  CONTAINS  2 CARDS          I                 &&&
$INCLUDE 39236156, IF DATACOM AND DCSPO AND NOT INQUIRY;                39236154
         IF M[ALPHA-2]!0 THEN IF GET(M[ALPHA-2]).[32:1] THEN GO TO DCN; 39236155
$#PATCH NUMBER 84 FOR  MCP.XII  CONTAINS 1  CARDS          I                 &&&
                   M[T+4]~-0&SYSNO[4:46:2]&1[2:47:1];                   28299000
$#PATCH NUMBER 86 FOR  MCP.XII  CONTAINS 6  CARDS          C                 &&&
                   BEGIN IF NOT M[L].[33:1] THEN%NOT TYPE 13 INT        02211000
                         BEGIN S~ADR; %SEGNO IN RCW                     02211010
                         END ELSE S~-1;                                 02212100
         END UNTIL (IF S!0 THEN  IF S=(-1) THEN 0 ELSE                  02216500
                                (B[0]<S OR NOT B[S].PBIT)               02216510
                   ELSE (P(M[T-2].[3:12],DUP)!@700  AND P(XCH)!@1500)); 02216600
$#PATCH NUMBER 87 FOR  MCP.XII  CONTAINS 2  CARDS          C                 &&&
                     0,0&CARD[9:9:9]);                                  20587600
                 0,0&CARD[9:9:9]);                                      20588950
$#PATCH NUMBER 88 FOR  MCP.XII  CONTAINS 14 CARDS          C                 &&&
BOOLEAN PROCEDURE SYSTEMFILE(A,B);VALUE A,B; REAL A,B; FORWARD;         00463300
              IF NOT SYSTEMFILE(MID,FID) THEN                           09301250
$ VOID                                                                  20382167
         OR ((CMM[0] EQV "PBD    ")=NOT 0)                              20511186
         OR SYSTEMFILE(CMM[0],CMM[1]) THEN GO TO ERROR;                 20511188
         IF CN NEQ 0 THEN T:=IF SYSTEMFILE(CMM[2],CMM[3]) THEN -1 ELSE  20574700
           BEGIN CN:=1; CMM[2]:=CMM[0]; CMM[3]:=CMM[1] END;             20580610
         T:=IF SYSTEMFILE(CMM[2],CMM[3]) THEN -1                        20580625
                   ELSE DIRECTORYSEARCH(CMM[2],CMM[3],5);               20580626
              IF T GTR 0 THEN                                           20580630
              IF T LSS 0 THEN                                           20580716
              LBMESS(-CMM[2],CMM[3],"NOT ",IF TOG THEN                  20580717
                     "SET " ELSE "RESET ","(SYSTEM",                    20580718
                     " FILE)",0&CARD[9:9:9])ELSE                        20580719
$#PATCH NUMBER 89 FOR  MCP.XII  CONTAINS 8  CARDS          C                 &&&
 IF NOT C AND (X1:=NEUP.[FF]-NEUP.[CF]-1) GEQ 0 THEN                    40262300
 IF NT1 GEQ 10 THEN NT1:=NEUP.[CF]+NT1-10;                              40324190
 VR[NT1+1]:=0&(SU[X].FORTYMILLDISK+1)[TOSPEED]&RL[TONUMENT]&            40324200
FOR NT1:=NEUP.[CF]-1 STEP -1 UNTIL 0 DO                                 40334065
IF (NT1:=NT2-3) - (X2:=NEUP.[CF]) GEQ 0 THEN                            40334077
FOR NT1:=NT1 STEP -1 UNTIL X2 DO                                        40334079
    IF NT1 THEN VR[NT2+NT1 DIV 2].[8:20]:=SOCK[NT1-X2+30]               40334081
    ELSE VR[NT2+NT1 DIV 2].[28:20]:=SOCK[NT1-X2+30];                    40334083
$#PATCH NUMBER 90 FOR  MCP.XII  CONTAINS 4  CARDS          C                 &&&
              "8INVALD","8 FILE ","4NAME..", % 75                       02345740
              "8INVALD","8 BLOCK","5 EXIT.", % 78                       02345750
              "8INVALD","5 COM .",           % 81                       02345760
         BEGIN TERMINATE(P1MIX); TERMINALMESSAGE(81) END;               19525200
$#PATCH NUMBER 91 FOR  MCP.XII  CONTAINS 1  CARDS          C                 &&&
              P(GETSPACE(196,12,0)+1,STS,RCW,0,RDS,0,XCH,CFX,STF);      20634000
$#PATCH NUMBER 92 FOR  MCP.XII  CONTAINS 1  CARDS          C                 &&&
OK:                IF (H[9+W]~PETUSERDISK(-H[8] OR M,COMMON))<1 THEN    28310000
$#PATCH NUMBER 93 FOR  MCP.XII  CONTAINS 1  CARDS          C                 &&&
         FIB[18]:=(*P(DUP))&(BLEN:=RLEN)[3:33:15]&BLEN[CTF];            39236030
$#PATCH NUMBER 94 FOR  MCP.XII  CONTAINS 1  CARDS          C                 &&&
         P((ADDRS:=GETSPACE(196,12,0))+1,STS,RCW,0,RDS,0,XCH,CFX,STF);  14353000
$#PATCH NUMBER 95 FOR  MCP.XII  CONTAINS 1  CARDS          C                 &&&
           M[SOURCE:=CARDLOC]:=@1425452432373737                        20295100
$#PATCH NUMBER 96 FOR  MCP.XII  CONTAINS 2  CARDS          C                 &&&
                   IF (Y~M[LINK~T])>0 OR Y.[CF]=LOC                     24057100
                   OR M[Y].[FF]!LINK THEN                               24057150
$#PATCH NUMBER 97 FOR  MCP.XII  CONTAINS 2  CARDS          C                 &&&
                   H:   4(40(IF SC="~" THEN JUMP OUT 2 TO HH;           15032000
                        DS~CHR)); HH:                                   15033000
$#PATCH NUMBER 98 FOR  MCP.XII  CONTAINS 4  CARDS          C                 &&&
    M[J+20]:=(*P(DUP))&I[8:38:10];                                      08571400
 %       D[20].[8:10]=NUMBER OF LAST LOG FILE                           44008340
 %            .[18:30]=NUMBER OF ENTRIES IN LOG (TIMESHARING)           44008350
 %       D[21]=SCHEDWORD (TIMESHARING)                                  44008360
$#PATCH NUMBER 99 FOR MCP.XII CONTAINS   6 CARDS           C                 &&&
%B 5 7 0 0   M C P  M A R K     X I I I . 0                07/15/71     00001000
                   IF PRNTABLE[UNIT].[1:1] AND                          13135000
                   NOT(SVPBT OR PRT[P1MIX,@23]) THEN                    13135200
    DS~4 LIT"XIII";     SI:= LOC A ;                                    15503000
                  "0"                                                   44203100
              DS~4 LIT"XIII";                                           44204600
$# PATCH NUMBER 100 FOR MCP.XII CONTAINS 147 CARDS          I                &&&
$VOID 00000038                                                          00000034
     ,BREAKTOG=TOGLE.[14:1]# %BREAKOUT TOG                              00081960
     ,BREAKMASK=@100000000000#                                          00081970
$INCLUDE 00419106, IF BREAKOUT AND AUXMEM;                              00419104
INTEGER BREAKING;                                                       00419105
$INCLUDE 02697691, IF BREAKOUT AND AUXMEM;                              02697299
PROCEDURE AUXTODISK(D,L,A,DA);VALUE D,L,DA;REAL D,L,DA;ARRAY A[*];      02697300
BEGIN INTEGER I,N; REAL T;                                              02697310
SUBROUTINE NOTE;                                                        02697320
BEGIN IF (I~A[0]~A[0]+1) MOD 60=0 THEN                                  02697330
      BEGIN DISKWAIT(A,60,DA+(((A[0] DIV 60)-1)|2)); I~1 END;           02697340
      A[I].[FF]~L;                                                      02697350
      A[I].[CF]~D INX 0;                                                02697360
END;                                                                    02697370
SUBROUTINE OLAYIT;                                                      02697380
BEGIN IF NOT STOREDY THEN SLEEP([TOGLE],STOREMASK);                     02697390
      STOREDY~0;                                                        02697400
      IF M[L].[2:1] THEN P(OLAY(T-2),DEL);                              02697410
      STOREDY~1;                                                        02697420
END;                                                                    02697430
      IF D.[FF]=L THEN %MOTHER,DOPE VECTOR                              02697440
      IF D.[2:1] THEN %PRESENT                                          02697450
      BEGIN IF NOT P(M[D INX 0],TOP) THEN %FLAGBIT                      02697460
            BEGIN N~ D.[8:10];                                          02697470
            FOR I~0 STEP 1 UNTIL N-1 DO                                 02697480
                   BEGIN T~D INX I;                                     02697490
                         AUXTODISK(NFLAG(M[T]),T,A,DA);                 02697500
                   END;                                                 02697510
            END                                                         02697520
            ELSE IF M[(T~M[L].[CF])-1].[18:3]=7 THEN                    02697530
                     BEGIN OLAYIT;                                      02697540
                           D~M[L] INX 0;                                02697550
                           NOTE;                                        02697560
                           MAKEPRESENT(L);                              02697570
                           M[(T~M[L].[CF])-1].[FF]~0;                   02697580
                           OLAYIT;                                      02697590
                     END                                                02697600
      END ELSE                                                          02697610
      BEGIN IF D.[33:3]=7 THEN                                          02697620
            BEGIN NOTE;                                                 02697630
                  MAKEPRESENT(L);                                       02697640
                  M[(T~M[L].[CF])-1].[FF]~0;                            02697650
                  OLAYIT;                                               02697660
                  END                                                   02697670
      END;                                                              02697680
END;                                                                    02697690
DEFINE CODEADDRESS(CODEADDRESS1,CODEADDRESS2)=                          02697710
            ACTUALOVERLAYADDRESS(1,CODEADDRESS1,CODEADDRESS2)#,         02697720
       DATADDRESS(DATADDRESS1,DATADDRESS2)=                             02697730
            ACTUALOVERLAYADDRESS(0,DATADDRESS1,DATADDRESS2)#;           02697740
SAVE INTEGER PROCEDURE ACTUALOVERLAYADDRESS(TYPE,MIX,LOC);              02697750
     VALUE TYPE,MIX,LOC; INTEGER TYPE,MIX,LOC; FORWARD;                 02697770
$INCLUDE 02701701, IF AUXMEM;                                           02701699
INTEGER ARRAY GG[*],AA[*]; REAL SVDA;                                   02701700
BEGIN WHILE(L:=DISKSPACE(J,X,0)) LEQ 0 DO SLEEP([OLAYMASK],TWO(X));     02727600
               IF T.[4:2]!3 THEN                                        02743810
              E[I]:=T&0[2:2:1]&J[CTF]&SPOT[CTC]&0[5:5:1];               02745200
             IF T.[4:2]!3 THEN                                          02745700
             BEGIN                                                      02745750
             DISKWAIT(-B,S~IF J LSS 600 THEN J ELSE 600,Z+K);           02745800
             DISKWAIT(B,S,Z+L);                                         02745802
             END                                                        02745804
             ELSE                                                       02745810
             BEGIN                                                      02745815
             IF Z!0 THEN J~J+8;%OFFSET FOR OVERLAP                      02745818
             DISKWAIT(-B,S~IF J<600 THEN J ELSE 600,                    02745820
                      CODEADDRESS(X,T));                                02745830
             IF S= 600 THEN T.[CF]~T INX 37; %592 DIV 16                02745840
             DISKWAIT(IF Z=0 THEN B ELSE B+8,S,Z+L);%NOTE OVERLAP       02745845
             END;                                                       02745850
$VOID                                                                   02746000
MP:=H.[FF]-1;                                                           02748205
$INCLUDE 02748341, IF AUXMEM;                                           02748209
IF AUXDATA[P1MIX]!0 THEN                                                02748210
BEGIN                                                                   02748215
F~[M[SPACE(K~(GG~DALOCROW[X]).[8:10])]]&K[8:38:10];%DALOCROW            02748220
M[GG INX @77776].[9:6]~0;                                               02748225
MOVE(K,GG.[CF],F.[CF]);                                                 02748230
DALOCROW[X]:=F; %SUBS COPY                                              02748235
N:=GG[0] INX 0;                                                         02748240
J:=SPACE(600);                                                          02748245
FOR I:=1 STEP 2 UNTIL N DO %COPY DALOCROW & OLAY DISK                   02748250
BEGIN F[I]:=GETUSERDISK(CHUNKSIZE);                                     02748255
FOR K~0 STEP 20 UNTIL CHUNKSIZE-20 DO                                   02748260
      BEGIN                                                             02748265
      DISKWAIT(-J,600,GG[I]+K);                                         02748270
      DISKWAIT(J,600,F[I]+K);                                           02748275
      END;                                                              02748280
END;                                                                    02748285
FORGETSPACE(J);                                                         02748290
I~MP; L~M[I-2].[CF]-1;                                                  02748295
AA~[M[GETSPACE(64,0,1)+2]]&64[8:38:10]; AA[0]~0;                        02748300
M[AA INX @77776].[9:6]~0; MOVE(63,AA INX 0,AA INX 1);                   02748305
SVDA~GETUSERDISK(137); %4096 WDS MAX                                    02748308
WHILE (T:=HUNT(I).[CF]) { L DO %OLAY FAKEOUT                            02748310
BEGIN IF P(T,DUP)<H[8] INX 0 OR P(XCH)>(H[10] INX 0) THEN               02748312
      IF (D~NFLAG(M[T]))>0 THEN %DATA DESC                              02748315
         AUXTODISK(D,T,AA,SVDA); % TRANS FROM AUX TO DISK               02748320
      I:=T+1;                                                           02748325
END;                                                                    02748330
IF AA[0]>59 THEN                                                        02748332
DISKWAIT(AA,60,SVDA+(((AA[0]+((AA[0] DIV 59)-1))DIV 60)|2));            02748335
END OF AUXMEM STUFF;                                                    02748340
$VOID                                                                   02749600
$INCLUDE 02765191, IF AUXMEM;                                           02765099
; IF AUXDATA[P1MIX]!0 THEN                                              02765100
BEGIN                                                                   02765110
IF (N~AA[0])>0 AND N<60 THEN                                            02765112
 FOR I~1 STEP 1 UNTIL N DO M[AA[I].[FF]].[CF]~AA[I] INX 0 ELSE          02765114
     BEGIN FOR J~0 STEP 1 UNTIL N DIV 59 DO                             02765116
          BEGIN DISKWAIT(-AA,60,SVDA+J|2);                              02765118
          T~IF J<N DIV 59 THEN 59 ELSE N MOD 59;                        02765119
          FOR I~1 STEP 1 UNTIL T DO                                     02765120
               M[AA[I].[FF]].[CF]~AA[I] INX 0 ;                         02765122
          END;                                                          02765124
     END;                                                               02765126
FORGETSPACE(AA INX 0);                                                  02765128
FORGETUSERDISK(SVDA,-137);                                              02765129
F~DALOCROW[X]; N~F[0] INX 0;                                            02765130
FOR I:=1 STEP 2 UNTIL N DO                                              02765140
    FORGETUSERDISK(F[I],-CHUNKSIZE);                                    02765150
DALOCROW[X]:=GG; %RESTORE DALOCROW                                      02765160
M[GG INX @77776].[9:6]~X;                                               02765170
FORGETSPACE(F.[CF]);                                                    02765180
END;                                                                    02765190
$INCLUDE 02811101, IF AUXMEM;                                           02811099
IF NOT BREAKTOG THEN SLEEP([TOGLE],BREAKMASK);BREAKTOG:=0;BREAKING:=X;  02811100
$INCLUDE 02819301, IF AUXMEM;                                           02819299
 BREAKTOG~1; BREAKING~0;                                                02819300
$VOID                                                                   08168454
             "OC",%69                                                   08168500
$VOID 14103001                                                          14100000
$INCLUDE 14368002, IF BREAKOUT AND AUXMEM;                              14367999
              IF BREAKING=P1MIX AND NOT BREAKTOG THEN                   14368000
              BEGIN BREAKING~0; BREAKTOG~1 END;                         14368001
                          ,XD                                           16020160
                          ,AU,OC                                        16020300
              P(GETSPACE(196,12,0)+1,STS,RCW,0,RDS,0,XCH,CFX,STF);      20634000
$INCLUDE 24150001, IF AUXMEM;                                           24148999
         IF (AUX OR DATAOLAY)                                           24149000
$INCLUDE 24149011, IF BREAKOUT;                                         24149009
         AND MIX NEQ BREAKING                                           24149010
         THEN IF P(AUXILIARYSPACE(WORDS),DUP) NEQ 0 THEN                24149020
         END ELSE P(DEL) ELSE ;                                         24150000
         P(DALOCROW[MIX]);                                              24150010
$INCLUDE 45247101, IF BREAKOUT AND AUXMEM;                              45247099
BREAKTOG~1;  BREAKING~0;                                                45247100
$#PATCH NUMBER 101 FOR MCP.XII CONTAINS   2 CARDS          C                 &&&
$INCLUDE 15520401, IF B6500LOAD;                                        15520300
          DS~10 LIT "B6500LOAD,";                                       15520400
$#PATCH NUMBER 102 FOR MCP.XII CONTAINS   7 CARDS          I                 &&&
              0,0,                           % 81 - RFE                 02345760
              "8EXCESS","8 IO TI","2ME....", % 83                       02345770
                                  IF TERMIX=@1777 THEN                  22023000
                                  IF PROCTIME[I]>0 THEN                 22023500
                                     TERMINATE(I&15[18:33:15]) ELSE     22024000
                                  IF A[J+1]> JAR[I,4] THEN              22024500
                                     TERMINATE(I&83[18:33:15]);         22025000
$#PATCH NUMBER 103 FOR MCP.XII CONTAINS   1 CARDS          C                 &&&
$VOID 22187001                                                          22186000
$#PATCH NUMBER 104 FOR MCP.XII CONTAINS  13 CARDS          I                 &&&
BEGIN REAL I,J;                                                         37303000
$VOID 37308001                                                          37307000
BEGIN                                                                   37313000
      STREAM(S~[TINU[U]],M~MULTITABLE[U],F~LABELTABLE[U],               37314000
             N~PRNTABLE[U].[30:18],D~J~GETSPACE(10,2,0)+2);             37314100
                  DS~6 LIT " RW/L ";                                    37316000
                  SI~LOC M;SI~SI+1;DS~7 CHR;DS~LIT" ";                  37316100
                  SI~SI+1; DS~7 CHR; DS~LIT"(";                         37316200
                  DS~5 DEC; DS~2 LIT ")~";                              37316300
         SPOUT(J);                                                      37318000
      LABELTABLE[U]~@214;                                               37318100
      MULTITABLE[U]~RDCTABLE[U]~0;                                      37319010
      IF U<16 THEN PRNTABLE[U]~0 ;                                      37319020
$#PATCH NUMBER 105 FOR MCP.XII CONTAINS  1  CARDS          C                 &&&
$VOID                                                                   48126009
$#PATCH NUMBER 106 FOR MCP.XII CONTAINS  2  CARDS          I                 &&&
              FOR I~20 STEP 1 UNTIL 21 DO                               45104100
               P(WAITIO(@4000100000,@777,I),DEL);                       45104200
$#PATCH NUMBER 107 FOR MCP.XII CONTAINS  3  CARDS          C                 &&&
          DO T~SCAN UNTIL T>IDENT AND T{RESETV;                         20587800
CCC: DO T~SCAN UNTIL T>IDENT AND T{RESETV;                              20594450
       DO T~SCAN UNTIL T>IDENT AND T{RESETV;                            20605900
$#PATCH NUMBER 108 FOR MCP.XII CONTAINS  3  CARDS          I                 &&&
      IF LIBMSG THEN                                                    07350100
EXIT: SPOUT(I INX TUSTA)                                                07351000
      ELSE FORGETSPACE(I);                                              07351100
$#PATCH NUMBER 109 FOR MCP.XII CONTAINS  2  CARDS          I                 &&&
              GO TO ENDF;                                               20608060
$VOID 20608091                                                          20608065
$#PATCH NUMBER 110 FOR MCP.XII CONTAINS 11 CARDS           C                 &&&
$VOID                                                                   14351209
$VOID                                                                   14355009
$VOID                                                                   14358399
$INCLUDE 14411601, IF DATACOM AND NOT INQUIRY;                          14411499
$VOID                                                                   19292009
       H[1]~R5;H[2]~R4;                                                 19292400
$INCLUDE 19292411, IF DATACOM AND NOT INQUIRY;                          19292409
       H[3]~USERSTA[P1MIX];                                             19292410
$OMIT 19292421, IF DATACOM AND NOT INQUIRY;                             19292419
       H[3]~0;                                                          19292420
$VOID 19293001                                                          19292999
$#PATCH NUMBER 111 FOR MCP.XII CONTAINS 12  CARDS          C                 &&&
      MODULUS=13#,  DIRMOD=169#;                                        00419150
COMMENT                                                                 00419210
         THE RELATIONSHIP BETWEEN MODULUS AND DIRMOD IS:                00419220
         DIRMOD := MODULUS | MODULUS, WHERE MODULUS IS A LOW            00419230
         ODD PRIME. (THE RECOMMENDED VALUE OF MODULUS IS 13).           00419240
         FOR SYSTEMS WITH ONLY 4 MEMORY MODS, MODULUS MUST BE           00419250
         SET TO A SMALLER VALUE SO THAT DIRECTORYBUILDER WILL           00419260
         NOT GET A NO-MEM, MAKING IT IMPOSSIBLE TO HALT/LOAD.           00419270
         IT IS SUGGESTED THAT MODULUS BE SET TO 11, DIRMOD TO 121       00419280
         FOR A SYSTEM WITH 4 MODS. IT MAY BE NECESSARY TO SET IT        00419290
         SMALLER, DEPENDING UPON DISK CONFIGURATION;                    00419300
$VOID 40245401                                                          40245100
$#PATCH NUMBER 112  FOR  MCP.XII  CONTAINS  9 CARDS        C                 &&&
         IF (SZ:=SZ-1) ! T THEN                                         18054000
         HOLDER.[FF]:=Y:=SZ;                                            18059000
         IF ((I:=FH[9].[9:20]-T) AND T|31)=0 THEN                       18352000
              LOCKDIRECTORY;                                            22051100
              IF (J:=HOLDER.[FF])!0 THEN    % HOLD LIST IS NOT EMPTY    22051200
              BEGIN                                                     22051250
              END;                                                      22052350
              UNLOCKDIRECTORY;                                          22052400
    HOLDER:=DIRECTORYTOP-6-(HOLDMAX+29) DIV 30;                         44086100
$#PATCH NUMBER 113  FOR  MCP.XII  CONTAINS 16 CARDS        C                 &&&
    IF (USERCODE[P1MIX] EQV MCP) ! NOT 0 THEN %                         04105550
         IF(FH[2] EQV 0)=NOT 0 OR (ABS(USERID) EQV ABS(FH[2]))=NOT 0    06463910
         BEGIN IF (SH:=DIRECTORYSEARCH(ABS(FH[5]),FH[6],20))=0 %        06463970
         FALSE THEN GO AROUND; %                                        08117140
LOG[3]~IF H[2]=0THEN IF H[5]=0THEN "FREE   " ELSE H[5] ELSE H[2]; %     08698500
IF H[1].[6:18] = 0 THEN LOG[4] ~ DATE ELSE %                            08698505
LOG[5] ~ IF 0 = JUNK ~ H[1].[25:23] THEN XCLOCK ELSE JUNK; % CR TIME    08698530
STREAM(DATE,J~5);BEGIN SI~LOC DATE;DS~8OCT END;FH[3].[12:18]~JUNK;      18451500
$VOID                                                                   20511186
M[OPTN INX 5]~M[OPTN INX 2].[6:42]; M[OPTN INX 2]~M[OPTN INX 6]~0;      20511550
         IF CN!0 THEN T:=IF SYSTEMFILE(CMM[2],CMM[3]) THEN -1 ELSE      20574700
              (USERID EQV ABS(M[T+2])) NEQ NOT 0 THEN %                 20575700
              (USERID EQV ABS(M[T+2])) NEQ NOT 0 THEN %                 20578400
      IF (USERID EQV MCP) = NOT 0 OR (USERID EQV ABS(M[T+2])) %         20580645
             IF (USERCODE[P1MIX] EQV ABS(M[T+2])) NEQ NOT 0 THEN %      28272000
             IF (USERCODE[P1MIX] EQV ABS(M[T+2])) NEQ NOT 0 THEN %      28583000
$#PATCH NUMBER 114  FOR  MCP.XII  CONTAINS 12 CARDS        I                 &&&
     IF INTSIZE=0 THEN                                                  20100190
     IF  ((S[1] EQV "DISK   ")=NOT 0) AND                               20100200
         (((S[0] EQV "PRNPBT ")=NOT 0) OR                               20100202
         ((S[0] EQV "LDCNTRL")=NOT 0) OR                                20100204
         ((S[0] EQV "LIBMAIN")=NOT 0)) THEN ELSE                        20100206
     BEGIN                                                              20100210
         NT3~SPACE(4);                                                  20100220
         STREAM(NT3);                                                   20100230
         DS~24LIT"##NO INTRINSICS FILE...~";                            20100240
         SPOUT(NT3);                                                    20100250
         SLEEP([INTSIZE],@1777);                                        20100300
     END;                                                               20100310
$#PATCH NUMBER 115  FOR  MCP.XII  CONTAINS  23 CARDS       I                 &&&
      DEFINE TECH=STATE.[46:2]#,             OPENIO=FIB[13].[22:1]#,    38385400
             WRITBACK=FIB[13].[23:1]#,       LASTIO=FIB[13].[46:1]#,    38385500
             WRITEAFTEREOF=FIB[13].[44:2]#,  INPUT=STATE.[43:1]#;       38385600
      P(RCW,MSCW,STF);       RCW ~ RCW & P(XCH)[CTC];                   38387000
      HEADER ~ FIB[14];      ACCESS ~ FIB[4].[27:3];                    38388000
      IF COBOL THEN                                                     38389000
      BEGIN  IF COBOL > 0 THEN                   % COBOL 61             38389100
             BEGIN IF WRITBACK AND TECH=0 AND LASTIO AND                38389200
                      (OPENIO OR NOT(INPUT))   THEN                     38389300
                       IF ACCESS=1 AND WRITEAFTEREOF!0 THEN             38389400
                       BEGIN  FIB[7] ~ *P(DUP) - 1;                     38389500
                              HEADER[7] ~ *P(DUP) - 1;                  38389600
                       END ELSE WRITEAFTEREOF ~ 0;                      38389700
                   IF TECH=0 THEN IF WRITEAFTEREOF=2 THEN               38389800
                        BEGIN  FIB[7] ~ *P(DUP) + 1;                    38389900
                               HEADER[7] ~ *P(DUP) + 1;                 38390000
                        END ELSE IF WRITEAFTEREOF=1 THEN                38390100
                        BEGIN  FIB[7] ~ *P(DUP) - 1;                    38390200
                               HEADER[7] ~ *P(DUP) - 1;                 38390300
                        END;                                            38390400
                   WRITEAFTEREOF ~ 0;                                   38390500
             END;                                                       38391000
             IF ACCESS=1 THEN                    % IF RANDOM            38391010
$#PATCH NUMBER 116 FOR MCP.XII CONTAINS 15 CARDS           C                 &&&
$VOID 45087101                                                          45076000
              IF GIVEDATE THEN                                          45135100
              BEGIN; STREAM(B~I~SPACE(2));                              45135110
                     DS~11 LIT "#DT PLEASE~";                           45135120
                     SPOUT(I);                                          45135130
                     DATE~-1;                                           45135140
              END;                                                      45135150
              IF GIVETIME THEN                                          45135160
              BEGIN; STREAM(B~I~SPACE(2));                              45135170
                     DS~11 LIT "#TR PLEASE~";                           45135180
                     SPOUT(I);                                          45135190
                     XCLOCK~-5184000;                                   45135200
              END;                                                      45135210
              TOGLE~TOGLE OR HOLDMASK OR KEYBOARDMASK;                  45135220
              COMPLEXSLEEP(XCLOCK}0 AND DATE}0);                        45135230
$#PATCH NUMBER 117  FOR  MCP.XII  CONTAINS 3  CARDS        I                 &&&
DRUM:                                                                   04437000
$OMIT 04437101,IF AUXMEM;                                               04437099
               IF E.[42:1] THEN GO TO LOCKOUT;%                         04437100
$#PATCH NUMBER 118  FOR  MCP.XII  CONTAINS 10 CARDS        I                 &&&
$INCLUDE 08852601, IF DATACOM AND NOT INQUIRY;                          08852599
       NAME ADDR=ES; REAL USERID=EM;                                    08852600
$INCLUDE 08882801, IF DATACOM AND NOT INQUIRY;                          08882599
       USERID:=IF BUFF.[9:9] LEQ 1 THEN MCP ELSE                        08882600
               IF GET(BUFF).[32:1] THEN MCP ELSE (IF P(LOOKQ,BUFF AND%  08882650
               @7570000000000,LLL,ADDR,STD).[9:9]=BUFF.[9:9] THEN       08882700
               ABS(M[ADDR INX 1]) ELSE 0);                              08882800
$INCLUDE 08912201, IF DATACOM AND NOT INQUIRY;                          08912099
       IF (USERID EQV MCP) NEQ NOT 0 THEN IF (USERID EQV ABS(S[24])) NEQ08912100
       NOT 0 THEN BEGIN SPOUT(BUFF);LEVEL:=MIXMAX+1;GO EXIT END;        08912200
$#PATCH NUMBER 119  FOR  MCP.XII  CONTAINS 12 CARDS        I                 &&&
              "WY", %12                                                 08151000
         SUBROUTINE SPOIT;M[BUFF-2]:=B AND @7570000000000;              16024600
EI: A:=0; SPOIT;                                                        16150000
    FOR I:=1 STEP 1 UNTIL MIXMAX DO                                     16150100
    IF *[JARROW[I]] ! 0 THEN                                            16150200
    IF REPLY[I] LSS 0 THEN REPLY[A:=I]:=10;                             16150300
    M[BUFF-1]:=IF A NEQ 0 THEN NOT 0 ELSE FLAG("NULL   ");              16150400
              IF (CLOCK AND @17777)=0 THEN                              22014100
              BEGIN FOR I:=1 STEP 1 UNTIL MIXMAX DO                     22014400
                    IF *[JARROW[I]] NEQ 0 THEN                          22014500
                    IF REPLY[I] LSS 0 THEN REPLY[I]:=10;                22014600
              END;                                                      22014900
$#PATCH NUMBER 120  FOR  MCP.XII  CONTAINS  6 CARDS        I                 &&&
              "3TS",%33 SCHED TS                                        08524920
      IF TYPE GTR 20 THEN GO TS;IF TYPE GTR 18 THEN GO XSES; GO PS;     08883000
    IF SID NEQ 63 THEN BEGIN IF S[3].[8:10] NEQ SID THEN GO TS1 END ELSE08885500
      IF SID NEQ 63 THEN BEGIN TYPE:=34;GO EXIT END;                    08901500
      IF SID NEQ 63 THEN TYPE:=34 ELSE%                                 08904050
               ,HM,CU,BK,AU,TS                                          16013010
$#PATCH NUMBER 121  FOR  MCP.XII  CONTAINS  3 CARDS        I                 &&&
              "PRIORIT", 52, %OF "PROCESS" THRU "SAVE".                 20266500
$VOID 20360001                                                          20359000
          BEGIN                                                         20361000
$#PATCH NUMBER 122  FOR  MCP.XII  CONTAINS  7 CARDS        C                 &&&
         BEGIN T:=SPACE(30);DISKWAIT(-T,30,0);                          32000500
               STREAM(M:=M[T+10+5|SYSNO],F:=M[T+11+5|SYSNO],BUF);       32000510
               BEGIN DS:=2LIT"0:";SI:=LOC M;SI:=SI+1;DS:=7CHR;          32000520
                     DS:=LIT"/";SI:=SI+1;DS:=7CHR;DS:=3LIT"= 0";        32000530
               END;                                                     32000540
               FORGETSPACE(T);T:=(BUF+2)&4[30:45:3];%                   32000600
         END ELSE%                                                      32000700
$#PATCH NUMBER 123  FOR  MCP.XII  CONTAINS  7 CARDS        C                 &&&
                   STREAM(I,X,J:=J:=SPACE(10));%                        45131100
                   BEGIN SI:=X;DS:=2WDS;DI:=J;%                         45131200
                         DS:=LIT"*";DI:=DI+7;DS:=LIT"/";                45131300
                         DI:=DI+7;DS:=LIT"=";SI:=LOC I;                 45131400
                         DS:=2DEC;DS:=9LIT":ABORTED~";%                 45131500
                   END;%                                                45131600
                   SPOUT(J);%                                           45131700
$#PATCH NUMBER 124  FOR  MCP.XII  CONTAINS  1 CARDS        C                 &&&
JARROW[X]:=0;                                                           02832300
$#PATCH NUMBER 125  FOR  MCP.XII  CONTAINS  4 CARDS        I                 &&&
         REAL GM,GM1; COMMENT GM,GM1 MUST IMMEDIATELY FOLLOW MESSAGE;   24034001
              BEGIN;STREAM(P1MIX,SIZE,M:=[MESSAGE]);                    24049000
                    BEGIN SI:=LOC P1MIX;DS:=2 DEC;DS:=9LIT" NO MEM ";   24049100
                          DS:=5DEC;DS:=5LIT" WDS~";                     24049200
$#PATCH NUMBER 126  FOR  MCP.XII  CONTAINS  4 CARDS        C                 &&&
$INCLUDE 45129101, IF STATISTICS;                                       45129099
                   UVROW[I] ~ *P(.LOGARRAY);                            45129100
$INCLUDE 45133101, IF STATISTICS;                                       45133099
              LOGARRAY[9] ~ 0;                                          45133100
$#PATCH NUMBER 127  FOR  MCP.XII  CONTAINS 10 CARDS        C                 &&&
              SEE,LOCKSYS,RSET,DONTWAIT,NOFILE;                         18208000
         IF DSED THEN GO TO NOFILE ELSE                                 18257000
NOFILE:       TEMP:=0;                                                  18266000
    BEGIN                                                               28442500
         IF DUMPING THEN J:=J-2 ELSE                                    28443000
         BEGIN X[J]:=@14;                                               28443500
              J:=-2;                                                    28444000
         END;                                                           28444500
    U:=-1;                                                              28554500
    IF DSED THEN ABORT;                                                 28555500
$#PATCH NUMBER 128  FOR  MCP.XII  CONTAINS  6 CARDS        I                 &&&
              "NOT ","USED", %13 NOT USED                               00455000
              "NOT ","USED", %12 NOT USED                               00455100
              "NOT ","USED", %11 NOT USED                               00455200
              "NOT ","USED", %10 NOT USED                               00455300
              "NOT ","USED", %9  NOT USED                               00455400
              "OPTN", "0000",  %0%                                      00455990
$#PATCH NUMBER 129  FOR  MCP.XII  CONTAINS 12 CARDS        C                 &&&
                   IF E.[43:1] THEN % (SHM)                             04321000
                      BEGIN % (SHM)                                     04321100
                      IF TYPE=0 THEN GO TO READER; % READ CHECK (SHM)   04321200
                      IF TYPE=1 THEN GO TO PRINTER; % PRINT CHECK (SHM) 04321300
                      IF TYPE=6 THEN GO TO PUNCH; % PUNCH CHECK (SHM)   04321400
                      END;                                              04321500
$ VOID 04326210                                                         04326100
                   IF E.[45:1] THEN GO TO NOTREADYMESS; % (SHM)         04369100
              SPOUT(KEY); % (SHM)                                       04423000
              IF E.[45:1] THEN GO TO NOTREADYMESS; % NOT READY (SHM)    04423100
              TINU[U].[18:12]:=P(DUP).[18:12]+1;% (SHM)                 04423200
              F:=0; GO TO CLEAR; % (SHM)                                04423300
$#PATCH NUMBER 130  FOR  MCP.XII  CONTAINS  2 CARDS        I                 &&&
COMMENT TO REDEFINE MAX NO. OF PSEUDO RDRS,SIZE AND INITIALIZATION      00007061
         OF TINU[*] AT 00241900 MUST ALSO BE MODIFIED ACCORDINGLY;      00007062
$#PATCH NUMBER 131  FOR  MCP.XII  CONTAINS  5 CARDS        I                 &&&
DEFINE MCP=M[1]#; %PRIVILEDGED USERCODE STORED IN M[1]                  00013600
REAL DIRECTORYTOP;                                                      00418050
    %BY MCP LOADER AND STORED IN MCP PRT(DIRECTORYTOP)                  00418070
ARRAY USERCODE[*];                                                      02695000
         DIRECTORYTOP~M[1];                                             46040200
$#PATCH NUMBER 132  FOR  MCP.XII  CONTAINS 35 CARDS        I                 &&&
              "MC", %MAKE A COMPILER                                    08168510
         LABEL WI,CM,MC;                                                16010310
                          ,MC                                           16020400
MC:      NAMEID(HN1,KTR);                                               16152310
         NAMEID(HN2,KTR);                                               16152320
         NAMEID(HN2,KTR);                                               16152330
         IF(A:=DIRECTORYSEARCH(HN1,HN2,4)) NEQ 0 THEN                   16152340
         BEGIN IF(J:=DIRECTORYSEARCH(HN1,"DISK   ",5))!0 THEN           16152350
               BEGIN FORGETSPACE(J); FORGETSPACE(A);                    16152360
                     LBMESS(-HN1,HN2,"NOT ","MC-ED","(DUP ","FILE)",0); 16152370
               END ELSE                                                 16152380
               BEGIN M[A INX 4]:=(*P(DUP))&2[1:46:2]&1[8:47:1];         16152390
                     ENTERUSERFILE(-HN1,"DISK   ",A INX 0-1);           16152400
                     A:=A&DIRECTORYFREE[18:32:15];                      16152410
                     FORGETSPACE(DIRECTORYSEARCH(HN1,HN2,8));           16152420
                     HEADERUNLOCK(HN1,"DISK   ",A);                     16152430
                      LBMESS(HN1,HN2,"MC-ED:",HN1,"/DISK C","OMPILER",0)16152450
               ;END                                                     16152460
         END ELSE LBMESS(-HN1,HN2,"NOT ","MC-ED","(NOT ON"," DISK)",0); 16152470
         GO TO EXIT;                                                    16152480
%    .[8:1]       USED TO MARK SPECIAL COMPILERS                        18104000
         TSPOL          =63#,                                           20235050
         COBOL68        =65#,                                           20235080
         "TSPOL  ",          63,                                        20270050
         "COBOL68",          65,                                        20270080
               IF (CN~SCAN)=PERIO THEN BEGIN CCCOMPILE~1; GO EXIT END;  20585350
               IF CN<ALGOL OR CN>COBOL THEN                             20585355
                IF(T:=DIRECTORYSEARCH(ACCUM[0],"DISK   ",5))!0 THEN     20585360
                BEGIN IF NOT M[T+4].[8:1] THEN                          20585365
                      BEGIN LBMESS(-ACCUM[0],"DISK   ",                 20585370
                            "NOT A ","COMPILE","R",0,0);                20585375
                      FORGETSPACE(T); CCCOMPILE~1; GO EXIT;             20585380
                      END; FORGETSPACE(T);                              20585385
                END;                                                    20585390
         DIRECT ~ [M[P(..RESWDS,LOD,1,INX)]]&151[8:38:10];              20601700
$#PATCH NUMBER 133  FOR  MCP.XII  CONTAINS 27 CARDS        I                 &&&
 BOOLEAN PROCEDURE CONQUER(C,N,L,S,G);                                  15168000
 VALUE C,N,L,S,G;                                                       15168100
 INTEGER G;                                                             15169100
                   IF G THEN                                            15172500
                   BEGIN IF NOT G THEN P(0,RTN);                        15175000
              X:   IF NOT N THEN                                        15175900
                             BEGIN G~CONQUER(C,N~N DIV 2,L,N INX S,1);  15176000
                                   G~CONQUER(S INX N,N,L,S,1);          15177000
                                   P(1,RTN);                            15177800
              CONQUER~1;                                                15187500
    LABEL C21A;                                                         19006250
$VOID                                                                   19130000
      IF NOT CONQUER(0,R5-1,R6,1 INX A,J) THEN                          19131100
      BEGIN FORGETSPACE(A);                                             19131110
C21A: STREAM(P1MIX,T~R5|R6,A~I~SPACE(7));                               19131120
      BEGIN DS~LIT "#"; SI~LOC P1MIX;                                   19131130
            DS~2 DEC; DS~ 13 LIT " NO SORT MEM:";                       19131140
            DS~5 DEC; DS~9 LIT " WDS RQD~";                             19131150
      END;                                                              19131160
      SPOUT(I);                                                         19131170
      REPLY[P1MIX]~-@30412;                                             19131180
      COMPLEXSLEEP(REPLY[P1MIX]>0 OR TERMIX.[CF]=P1MIX);                19131190
      IF TERMIX.[CF]=P1MIX THEN GO TO INITIATE;                         19131200
      IF NOT WHYSLEEP(@30412) THEN GO TO C21A;                          19131210
      J~REPLY[P1MIX].[CF]=3;                                            19131220
      GO TO C21;                                                        19131230
      END;                                                              19131240
$#PATCH NUMBER 134  FOR  MCP.XII  CONTAINS 2  CARDS        I                 &&&
      IF R5.[FF]=@77777 THEN                                            19685452
      BEGIN M[R5]:=MOD3IOS; GO INITIATE; END ELSE                       19685456
$# PATCH NUMBER 135 FOR MCP.XII CONTAINS  13  CARDS        I                 &&&
              DISKWAIT(-B,30,FJ);                                       40317400
              DISKWAIT(B,30,FJ);                                        40317600
$ VOID                                                                  40321120
                                  DISKWAIT(I.[CF],30,I.[FF]);           40340000
$ VOID                                                                  40341000
                        DISKWAIT(-A,30,J);                              40343000
                        BEGIN                                           40346100
                             DISKWAIT(-(A+60),30,(DDD[2] DIV 6)+J);     40346200
                                  DISKWAIT(A,30,J);                     40346500
$ VOID                                                                  40346600
                                  DISKWAIT(A,30,J);                     40350000
            DISKWAIT(DDD INX 0,180,Y);                                  40356600
$ VOID                                                                  40356700
$#PATCH NUMBER 136 FOR MCP.XII CONTAINS   2 CARDS          C                 &&&
              IF STANOTINUSE AND (STA OR NOT STA.[44:1]) THEN           23135000
         RD:=(BUFF INX (@7570000000000 AND STA)) OR @0400000040000000;  27082000
$# PATCH NUMBER 137 FOR MCP.XII CONTAINS 1055 CARDS           I         00001000
$ INCLUDE 02131013, IF RJE;                                             02131011
PROCEDURE TWXOUT(A,B,C,D); VALUE A,B,C,D; REAL A,B,C,D; FORWARD;        02131012
              INTEGER CR;                                               02133013
                   CR:=MESSAGE.[2:1];                                   02133525
$ INCLUDE 02134018, IF RJE;                                             02134016
              IF (TUSTA:=0&JAR[MIX,6][9:9:9])!0 THEN SPOFLAG:=1 ELSE    02134017
$ VOID 02144500                                                         02143999
$ VOID 02164501                                                         02164100
              CR:=(MIX!0) OR CR;                                        02174008
              STREAM(M:=CR:L:=LINES,R:=LFT,S:=MESSAGE+1,Z:=I+1);        02174330
                       BEGIN SI:=S; M(DS:=2 LIT "{!");                  02174331
                       S:=CI; GO TO START; M:=TALLY;                    02174332
                       M(IF SC!"}" THEN IF SC!"{" THEN                  02174333
                         IF SC!">" THEN IF SC!"<" THEN                  02174334
                         IF SC!"!" THEN                                 02174335
                         BEGIN DS:=CHR; GO TO LL; END;                  02174336
                         DS:=2 RESET; DS:=2 SET; DS:=2 RESET; SI:=SI+1; 02174337
LL:                     ); CI:=L;                                       02174338
START:                 TALLY:=36;                                       02174339
                       L(Z:=DI; 2(L:=CI; CI:=S); DS:=2 LIT "{!");       02174340
                       TALLY:=8;                                        02174345
                       R(Z:=DI; L:=CI; CI:=S); SI:=Z;                   02174350
                       R:=SI; DI:=R; DS:=3 LIT "{!~"; M:=DI;            02174356
                   NT1:=((NT1:=P).[CF]-(I+1))|8 + NT1.[30:3] - 2;       02174358
$ INCLUDE 02174367, IF RJE;                                             02174359
                   IF GET(TUSTA) THEN  %GOES TO RJE TERMINAL            02174360
                   BEGIN M[MESSAGE].[CF]:=1;  %UNLOCK MESSAGEWRITER     02174361
                        TWXOUT(1&LINES[CTF],NT1-CR,I+1,TUSTA);          02174362
                        FORGETSPACE(I+1);                               02174364
                   END ELSE                                             02174366
                   BEGIN                                                02174368
                   MA:=P(STATIONMESSAGEHOLDER,TUSTA OR @7777700000,     02174370
                   END END STA LOOP;                                    02174500
$ INCLUDE 02174731, IF DATACOM AND RJE AND NOT INQUIRY;                 02174729
              IF NOT GET(TUSTA) THEN  %ALREADY DONE IF THERE IS RJE     02174730
$ VOID                                                                  06668065
    SPOUT(MESS&TUB[9:39:9]&1[2:47:1]);                                  06668270
              H[4]:=H[6]:=0;                                            07179200
              A:=M[I+6].[CF];                                           07278000
              L2:=M[I+6].[CF];                                          07312000
                   IF (FIRSTDECK:=L2)=0 THEN LASTDECK:=0;               07314100
              IF (V:=M[J+6].[CF])=0 THEN GO TO REMOVE;                  07318000
              M[J+6].[CF]:=L2;                                          07321000
                               IF (N:=M[D+6].[CF])!0 THEN GO TRYIT ELSE 07371820
              A:=H[6];                                                  07446150
              INDEPENDENTRUNNER(P(.CONTROLCARD),T&                      07449000
$ INCLUDE 07449101, IF DATACOM AND RJE AND NOT INQUIRY;                 07449099
                                                  A[9:9:9]&             07449100
                                                  (R+32)[2:42:6]);      07449200
         NEXT:IF (A:=H[6].[CF])!0 THEN GO TO L;                         07451000
         H[4]:=0&15[12:44:4];                                           07550000
            M[I+6].[CF]:=T1;                                            07565000
     IF NOT (P(GET(STA),DUP).[32:1] OR P(XCH)) THEN                     08101050
             "4MX",     % 2                                             08141000
             "4PD",     % 5                                             08144000
             "4CC",%13                                                  08152000
             "4PB",%14                                                  08153000
             "4WD",%19                                                  08158000
             "4WT",%20                                                  08159000
             "4TO",%24                                                  08163000
             "4CD",%27                                                  08166000
             "4TF",%32       TYPE OUT MULTIPROCESSING FACTOR            08168030
             "4TS",%34       TYPE OUT SCHEDULE (NAMES IN SHEET)         08168050
             "4EX",%37                                                  08168080
             "4LO",%39       LOG-OUT (FROM REMOTE STATION)              08168100
             "4SS",%41       STATION TO STATION MESSAGE                 08168120
             "4LF",%50                                                  08168210
             "4LC",%51                                                  08168220
             "4LS",%52                                                  08168230
             "4WM",%55       WHAT MCP                                   08168260
             "4BK",%56       BREAK FOR SPO                              08168270
             "4WI",%62       WHAT INTRINSICS                            08168400
             "4CU",%63       TYPE AMOUNT OF CORE IN USE FOR ALL MIXES   08168450
             "4AU",%67                                                  08168490
      BEGIN INTEGER U,V,I,J,S; DEFINE STA=PNCH#;                        08255500
$ INCLUDE 08256701, IF DATACOM AND RJE AND NOT INQUIRY;                 08256699
         IF PNCH.[9:9]!0 THEN IF (GET(PNCH) AND 3)=1 THEN GO TO QUIT;   08256700
         BEGIN                                                          08257100
$ INCLUDE 08257401, IF DATACOM AND RJE AND NOT INQUIRY;                 08257199
              IF PNCH.[9:9]!0 THEN                                      08257200
              IF PNCH THEN IF GET(PNCH).[37:3]=1 THEN V:=22             08257300
              ELSE ELSE IF GET(PNCH).[34:3]=1 THEN V:=20 ELSE ELSE      08257400
              IF PNCH THEN IF LABELTABLE[V:=22]!0 THEN V:=0 ELSE ELSE   08257500
$ INCLUDE 08259601, IF DATACOM AND RJE AND NOT INQUIRY;                 08259599
              STA:=PNCH.[9:9];                                          08259600
$ INCLUDE 08260901, IF DATACOM AND RJE AND NOT INQUIRY;                 08260899
              IF (STA:=PNCH.[9:9])=0 THEN                               08260900
              IF ((U=0 AND AUTOPRINT) OR STA!0) AND PBCOUNT!0 THEN      08267000
$ INCLUDE 08269351, IF DATACOM AND RJE AND NOT INQUIRY;                 08269319
                             IF STA!0 THEN IF V=22 THEN                 08269320
                             STATION[STA.[44:4],STA.[39:4]].[37:1]      08269330
                             :=0 ELSE STATION[STA.[44:4],STA.[39:4]]    08269340
                             .[34:1]:=0;                                08269350
                             GO TO QUIT;                                08269360
$ INCLUDE 08269931, IF DATACOM AND RJE AND NOT INQUIRY;                 08269929
                                  OR D[37]!STA                          08269930
         BEGIN                                                          08270810
$INCLUDE 08270841, IF DATACOM AND RJE AND NOT INQUIRY;                  08270819
              IF STA!0 THEN                                             08270820
              IF V=22 THEN STATION[STA.[44:4],STA.[39:4]].[37:1]:=1     08270830
              ELSE STATION[STA.[44:4],STA.[39:4]].[34:1]:=1 ELSE        08270840
              LABELTABLE[V]:=@2147513145632551;                         08270850
                   INDEPENDENTRUNNER(P(.CONTROLCARD),                   08276900
$ INCLUDE 08276951, IF DATACOM AND RJE AND NOT INQUIRY;                 08276949
                        IF STA!0 THEN I&30[3:43:5]&STA[9:39:9] ELSE     08276950
                        I&31[3:43:5]);                                  08277000
    QUIT:                                                               08280000
$ INCLUDE 08280011, IF DATACOM AND RJE AND NOT INQUIRY;                 08280009
          IF STA = 0 THEN  %NOT RJE                                     08280010
          IF V ! 0 THEN LABELTABLE[V]:=0;                               08280020
    BEGIN REAL U,I,STA,B=BUFF;                                          08283000
$ INCLUDE 08284501, IF DATACOM AND RJE AND NOT INQUIRY;                 08284499
          IF GET(NT1:=0&BUFF[9:6:9]) THEN STA:=NT1;                     08284500
               IF (STA:=MULTITABLE[U]!"PBTMCP " OR STA) AND             08293500
               MULTITABLE[U]!"PUTMCP " THEN                             08293600
$ INCLUDE 08294301, IF RJE AND DATACOM AND NOT INQUIRY;                 08294299
    S:             SPOUT(BUFF&STA[9:9:9]);                              08294300
$ OMIT 08294501, IF RJE AND DATACOM AND NOT INQUIRY;                    08294499
               IF PRINTORPUNCHWAIT(-U,STA) THEN                         08295500
                ELSE STA:=STA OR 1;                                     08296550
               FORGETSPACE(I);IF PRINTORPUNCHWAIT(U.[6:24],STA) THEN    08297000
    L:::      "6DS", %  1                                               08512000
              "5OK", %  4                                               08515000
              "5AX", %  6                                               08517000
              "6TI", %  9                                               08520000
              "5WY", % 10                                               08521000
              "5RM", % 11                                               08522000
              "6ST", % 13                                               08523100
              "6IN", % 14                                               08523200
              "6OT", % 15                                               08523300
              "6QT", % 16                                               08523400
              "7ES", % 20                                               08523800
              "6CT", % 23    CHANGE TIME LIMITS OF A JOB IN THE MIX     08524100
              "6XT", % 24    EXTEND TIME LIMITS OF A JOB IN THE MIX     08524200
              "6TL", % 25    TYPE I-O AND PROCESSOR TIME LIMITS         08524300
              "6CU", % 30    TYPE AMT OF CORE IN USE FOR A GIVEN MIX    08524800
              "7BK", % 31    BREAK OF MIX MESSAGES FOR SPO              08524900
              "6AU", % 32    TYPE AMT OF CORE IN USE FOR GIVEN MIX      08524910
         REAL T=-2,IOD,H6;  INTEGER I=IOD;                              08704000
                   H6:=HEADER[6];                                       08711750
$ INCLUDE 08712001, IF DATACOM AND RJE AND NOT INQUIRY;                 08711799
                   IF P(JAR[P1MIX,6].[9:9],DUP)!0 THEN                  08711800
                   BEGIN P(GET(JAR[P1MIX,6]));                          08711850
                        IF I THEN IF P.[39:1] THEN ELSE P(DEL,0)        08711900
                        ELSE IF P.[36:1] THEN ELSE P(DEL,0);            08711950
                   END;  HEADER[6]:=P(XCH);                             08712000
$ OMIT 08712011, IF DATACOM AND RJE AND NOT INQUIRY;                    08712009
                   HEADER[6]:=0;                                        08712010
                   ENTERUSERFILE(IF I THEN "PND    " ELSE "PBD    ",    08712050
                                 H6,HEADER INX 0 -1);                   08712100
                   HEADER[6]:=1 INX H6;                                 08713100
                   HEADER[9]:=0;                                        08714000
                   MOVE(20,[HEADER[9]],[HEADER[10]]);                   08714100
$VOID                                                                   08714200
$ INCLUDE 09060201, IF RJE;                                             09060199
              AND NOT STA                                               09060200
         BEGIN DS:=6 LIT "#FROM ";                                      09073000
      BUFF:=BUFF&T[9:44:4]&B[14:44:4]&1[2:47:1];                        09082500
      REAL PASSBACK=-4;  %USED BY RJEINPUT TO GATHER USERCODE           09214350
    BEGIN                                                               09214505
$ INCLUDE 09214509, IF RJE;                                             09214507
          IF NOT STA THEN                                               09214508
          NAMEID(C,ADDR);  NAMEID(C,ADDR);                              09214510
                DKSGROW:=M[FH+8];                                       09214550
                RECORDSIZE:=M[FH].[1:14];                               09214560
                            THEN GO TO ENDFILE;                         09214630
                            IF (ABS(T1) EQV C1) ! NOT 0 THEN            09214665
                            GO TO ENDFILE ELSE GO TO FOUND              09214670
                            ELSE GO TO FOUND;                           09214675
                END; GO TO ENDFILE;                                     09214715
    FOUND:                                                              09214720
                NT1:=BUFF AND @7570000000000;                           09214740
                M[F:=TEMPLOG-1]:=NT1&P(LOOKQ,NT1,LLL,.A,STD)            09214750
    ENDFILE:    FORGETSPACE(FH);                                        09214925
    OWT:                                                                09214960
$ INCLUDE 09241751, IF RJE;                                             09241099
      IF NOT Q AND STA THEN                                             09241100
      BEGIN IF (T EQV C) ! NOT 0 THEN                                   09241150
           BEGIN C:=0; NT1:=@2462255123462425; END                      09241160
           ELSE IF C1.[6:6]!"~" THEN NT1:=@0721626266465124 % PASSWORD  09241200
           ELSE M[PASSBACK]:=0;                                         09241210
           STREAM(B:=(M[PASSBACK]=4),N:=FLAG(NT1),BUFF);                09241250
           BEGIN B(DS:=23 LIT "INVALID LOG-ON SEQUENCE";JUMP OUT TO AX);09241300
                N(DS:=8 LIT "INVALID "; SI:=LOC N; DS:=WDS; SI:=LOC N;  09241350
                  DS:=13 LIT " -- RE-ENTER ";DS:=8 CHR;JUMP OUT TO AX); 09241400
                DS:=21 LIT "ENTER PASSWORD PLEASE";                     09241450
           AX:  DS:=LIT "~";                                            09241500
           END;                                                         09241550
           PASSBACK:=C; GO TO EXIT;                                     09241600
      END;                                                              09241650
$ INCLUDE 09252161, IF RJE;                                             09252099
      IF STA THEN                                                       09252100
      BEGIN                                                             09252110
           FOR T:=1 STEP 1 UNTIL MIXMAX DO                              09252120
           IF JAR[T,*] ! 0 THEN                                         09252130
           IF JAR[T,6].[9:9]=STA.[9:9] THEN GO TO EXIT;                 09252140
           SET(STA:=GET(STA)&0[46:47:1]);                               09252150
      END ELSE                                                          09252160
      BEGIN                                                             09252200
      END;                                                              09255100
EOT:  DELINKER;                                                         09267000
$ INCLUDE 09270501, IF RJE;                                             09267499
      IF STA THEN  %RJE                                                 09267500
      BEGIN                                                             09268000
           FOR T:=1 STEP 1 UNTIL MIXMAX DO                              09268500
           IF JAR[T,*]!0 THEN                                           09269000
           IF JAR[T,6].[9:9]=STA.[9:9] THEN                             09269500
           IF JAR[T,0]="PRNPBT " AND JAR[T,1]="DISK   " THEN            09269600
           BEGIN REPLY[T]:=16; PRT[T,@25]:=5; END ELSE                  09269700
           TERMINATE(T&67[CTF]);                                        09270000
      END ELSE                                                          09270500
      BEGIN                                                             09271000
           STREAM(A:="~~":ADDR);                                        09271500
           BEGIN                                                        09272000
                SI:=LOC A; SI:=SI+6;                                    09272500
$ VOID                                                                  09272600
                IF 2 SC!DC THEN A:=TALLY;                               09273000
           END;                                                         09273500
           IF P=0 THEN GO TO EXIT;                                      09274000
           SET(STA&0[46:47:1]&0[31:47:1]);                              09274500
           IF STA.[32:1] THEN SPOSIN(STA,2,0);                          09275000
     END;                                                               09275500
 REAL              U=-4,CURRPBNAME=U,B,T,IOD=T,UNIT,ENDFLAG,LOC,STA;    13005000
$ INCLUDE 13021447, IF DATACOM AND RJE AND NOT INQUIRY;                 13021435
                   END ELSE IF STA ! 0 THEN                             13021436
                   BEGIN LABELTABLE[U]:=@2147513145632551;              13021438
                        RDCTABLE[U].[8:6]:=P1MIX;                       13021440
                        P(PRINTORPUNCHWAIT(-V,STA),DEL);                13021442
                        JAR[P1MIX,6].[9:9]:=0; STA:=0;                  13021444
                        FPB[8].[36:6]:=(V:=U)+1;                        13021446
                   END ELSE IF U ! V THEN                               13021448
                   BEGIN LABELTABLE[U]:=LABELTABLE[V];LABELTABLE[V]:=0; 13021449
$ INCLUDE 13044096, IF DATACOM AND RJE AND NOT INQUIRY;                 13044094
           IF STA!0 THEN TWXOUT(3&@202[CTF],120,LOC,STA) ELSE           13044095
$ INCLUDE 13078351, IF DATACOM AND RJE AND NOT INQUIRY;                 13078349
                   IF STA = 0 THEN                                      13078350
$ INCLUDE 13082051, IF DATACOM AND RJE AND NOT INQUIRY;                 13082049
                 AND STA = 0                                            13082050
$ INCLUDE 13105501, IF DATACOM AND RJE AND NOT INQUIRY;                 13105499
                   IF (STA:=0&JAR[P1MIX,6][9:9:9])=0 THEN               13105500
$ INCLUDE 13128751, IF DATACOM AND RJE AND NOT INQUIRY;                 13128199
                   IF STA ! 0 THEN  %GOES TO REMOTE                     13128200
                   BEGIN                                                13128300
                        NT1:=(P(INREC.[CF],DUP)-B.[CF]) DIV 18 +1;      13128400
                        NT1:=(IF V=22 THEN 2 ELSE 3)&NT1[3:42:6];       13128500
                        TWXOUT(NT1,80,[INREC[0]],STA);                  13128600
                        INREC:=P INX M;                                 13128700
                   END ELSE %NORMAL I/O                                 13128750
 QUIT:             IF V NEQ 22 THEN  %PAGE EJECT                        13132000
$ INCLUDE 13132021, IF DATACOM AND RJE AND NOT INQUIRY;                 13132019
                   IF STA!0 THEN TWXOUT(3&@101[CTF],0,0,STA) ELSE       13132020
                   P(WAITIO(@4000100000,0,V),DEL);                      13132040
      END;    END; IF STA=0 THEN IF RDCTABLE[V].[8:6]=P1MIX THEN        13142000
$ INCLUDE 13146701, IF DATACOM AND RJE AND NOT INQUIRY;                 13146699
                   IF STA!0 THEN P(PRINTORPUNCHWAIT(-V,STA),DEL) ELSE   13146700
                   BEGIN                                                13146800
                   END;                                                 13148050
$ INCLUDE 13299998, IF DATACOM AND NOT INQUIRY;                         13198999
$ INCLUDE 13799999, IF DATACOM AND RJE AND NOT INQUIRY;                 13299999
REAL RJEWAITQ;  %USED TO QUEUE MESSAGES WAITING FOR NOT READY UNIT      13300000
PROCEDURE RJEUNITCHANGE(T);VALUE T; REAL T;                             13301000
BEGIN REAL RCW=+0,SMH=STATIONMESSAGEHOLDER,DC=+1,U=+2,STA=+3,BUFF=+4;   13302000
    LABEL DOIO,AXEIT,RTRY;                                              13303000
    DEFINE STACURR=STATION[STA.[14:4],STA.[9:4]]#;                      13304000
    SUBROUTINE RUNSM;  RUNSMW;                                          13305000
    IF NOT T THEN  %INDEPENDENT RUNNER                                  13306000
    BEGIN                                                               13307000
         P(GETSPACE(96,12,0)+1,STS,T,RCW,0,RDS,0,XCH,CFX,STF);          13308000
         STACKUSE:=TRUE;                                                13309000
    END;                                                                13310000
    P(DC19Q,0&T[9:9:9],LLL,XCH,DEL,3,INX,T.[FF],GET(T),0);              13311000
    IF U=1 THEN STA:=STA&T[40:47:1] ELSE                                13312000
    IF U=3 THEN STA:=STA&T[35:47:1] ELSE                                13313000
    IF U=2 THEN STA:=STA&T[38:47:1];                                    13314000
    IF T THEN  %UNIT WENT NOT READY                                     13315000
    BEGIN STA:=STACURR:=STA&0[22:47:1];                                 13316000
         IF STA.[32:1] THEN  %MESSAGES IN OUTPUT QUEUE                  13317000
         BEGIN T:=P(SMH,0&STA[9:9:9],LLL,0,INX,.BUFF,STD);              13318000
              WHILE T.[9:9]=STA.[9:9] DO                                13319000
              BEGIN STREAM(A:=BUFF INX 1:);                             13320000
                   BEGIN SI:=A; SI:=SI+2;                               13321000
                        DI:=LOC A; DS:=2 OCT;                           13322000
                   END STREAM;                                          13323000
                   IF P=U THEN  %MESSAGE TO NOT READY UNIT              13324000
                   BEGIN M[T]:=(*P(DUP))&T[FTF];                        13325000
                        M[T.[FF]].[CF]:=T;                              13326000
                        NT1:=P(RJEWAITQ,NT2:=0&STA[9:9:9]&(NOT 0)[CTF], 13327000
                        LLL,0,INX,.NT3,STD);                            13328000
                        M[BUFF]:=NT2&U[3:42:6]&NT1[FTF]&NT3[CTC];       13329000
                        M[NT1.[FF]].[CF]:=BUFF;                         13330000
                        M[NT3].[FF]:=BUFF;                              13331000
                        M[DC]:=(*P(DUP))+1;                             13332000
                   END;                                                 13333000
                   T:=M[BUFF:=T];                                       13334000
              END;                                                      13335000
              IF P(SMH,0&STA[9:9:9],LLL,DEL).[9:9]!STA.[9:9] THEN       13336000
              BEGIN STA:=STA&0[32:47:1];                                13337000
DOIO:              T:=[BUFF] INX (@400000000000000&STA[9:9:9]);         13338000
                   BUFF:=@3437000000000000;                             13339000
                   IOREQUEST(NABS(T)&@113[CTF],T,[T]&30[12:42:6]);      13340000
                   STACURR:=STA&1[29:47:1];                             13341000
                   SLEEP([T],IOMASK);                                   13342000
              END ELSE RUNSM;                                           13343000
              P(XIT);                                                   13344000
         END ELSE GO TO DOIO;                                           13345000
    END ELSE %UNIT WENT READY                                           13346000
    BEGIN                                                               13347000
RTRY:    T:=P(RJEWAITQ,NT2:=0&STA[9:9:9],LLL,0,INX,.BUFF,STD);          13348000
         NT2:=NT2&(NOT 0)[FTF];                                         13349000
         WHILE T.[9:9]=STA.[9:9] DO                                     13350000
         BEGIN IF T.[3:6]=U THEN                                        13351000
              BEGIN IF M[DC]=0 THEN                                     13352000
                   BEGIN IF (STACURR:=STA).[32:1] THEN RUNSM;           13353000
                        IF U=3 THEN BUFF:=@10000 ELSE                   13354000
                        IF U=2 THEN BUFF:=@1000  ELSE                   13355000
                        IF U=1 THEN BUFF:=@200;                         13356000
                        COMPLEXSLEEP((STACURR AND BUFF)!0 OR M[DC]!0);  13357000
                        IF ((STA:=STACURR) AND BUFF)!0 THEN             13358000
                        GO TO AXEIT ELSE GO TO RTRY;                    13359000
                   END;                                                 13360000
                   M[DC]:=(*P(DUP))-1;                                  13361000
                   NT1:=P(SMH,NT2,LLL,0,INX,.NT3,STD);                  13362000
                   M[BUFF]:=NT2&NT1[FTF]&NT3[CTC];                      13363000
                   M[NT1.[FF]].[CF]:=BUFF;                              13364000
                   M[NT3].[FF]:=BUFF;                                   13365000
                   M[T]:=(*P(DUP))&T[FTF];                              13366000
                   M[T.[FF]].[CF]:=T;                                   13367000
                   STA:=STA&1[32:47:1];                                 13368000
              END;                                                      13369000
              T:=M[BUFF:=T];                                            13370000
         END;                                                           13371000
         IF (STACURR:=STA).[32:1] THEN RUNSM;                           13372000
         IF U=1 THEN P(1) ELSE IF U=2 THEN                              13373000
         BEGIN U:=5; P(STA.[37:1]); END ELSE P(STA.[34:1]);             13374000
         IF NOT P THEN P(PRINTORPUNCHWAIT(-(U+17),STA),DEL);            13375000
AXEIT:   KILL([T]);                                                     13376000
    END;                                                                13377000
END RJEUNITCHANGE;                                                      13378000
PROCEDURE TWXOUT(UNIT,NUMCHRS,AREA,STA);                                13379000
VALUE UNIT,NUMCHRS,AREA,STA;  REAL UNIT,NUMCHRS,AREA,STA;               13380000
BEGIN REAL F,MASK,VR=-6; LABEL PRINLOOP,RY;                             13381000
    DEFINE STACURR=STATION[STA.[14:4],STA.[9:4]]#;                      13382000
    IF UNIT.[CF]!1 THEN NT1:=60 ELSE                                    13383000
    BEGIN NT2:=UNIT.[FF];                                               13384000
         NT1:=(NUMCHRS+NT2+20).[33:12];                                 13385000
         NUMCHRS:=NUMCHRS-NT2;                                          13386000
    END;                                                                13387000
    IF STACURR.[28:1] OR UNIT.[CF] GTR 3 THEN P(XIT);                   13388000
    F:=NABS((GETSPACE(NT1,5,0)+2)&P(DUP)[15:33:15]);                    13389000
    M[F INX (NOT 1)].[9:6]:=0;  % GET RID OF MIX IN MEM LINK            13390000
    AREA:=P(.AREA,LOD,0,INX);                                           13391000
    IF (NT1:=UNIT.[3:6])=0 THEN NT2:=UNIT.[FF] ELSE                     13392000
PRINLOOP:                                                               13393000
    IF UNIT.[CF]=3 THEN                                                 13394000
    BEGIN NT4:=(NT3:=NFLAG(M[VR+17])).[18:1];                           13395000
         IF (NT2:=NT3.[29:4])!0 THEN                                    13396000
         NT2:=NT2&(IF NT4 THEN 1 ELSE 3)[36:42:6] ELSE                  13397000
         BEGIN IF (NT2:=NT3.[27:2])!0 THEN                              13398000
              NT2:=IF NT2 THEN 2 ELSE 1;                                13399000
              IF NOT NT4 THEN NT2:=NT2&2[36:42:6];                      13400000
         END;                                                           13401000
         NUMCHRS:=IF NT4 THEN 0 ELSE 0&NT3[40:13:5];                    13402000
    END;                                                                13403000
    STREAM(TN:=F.[1:1]:A:=NT2,B:=UNIT:=UNIT.[CF],C:=P(DUP)!3,           13404000
    D:=NUMCHRS.[43:5],E:=NUMCHRS.[38:5],AREA,G:=UNIT.[CF]=1,F);         13405000
    BEGIN TN(DS:=2 LIT "}!"; SI:=LOC B; SI:=SI+6; DS:=2 CHR;            13406000
         DS:=LIT "0"; DS:=LIT "!"; DS:=LIT """); DS:=2 LIT "-!";        13407000
         C(JUMP OUT TO START);SI:=LOC A; SI:=SI+6; DS:=2 CHR;           13408000
START:   SI:=AREA; A:=CI; GO TO NEXT;                                   13409000
         %SUBROUTINE TO CHANGE STATES IF NEEDED - TEXT TO CONTROL       13410000
         C(DI:=DI-1; JUMP OUT TO NE); DS:=LIT "!";                      13411000
NE:      CI:=TN;  %SUBROUTINE EXIT                                      13412000
NEXT:    B:=CI; GO TO NEX;                                              13413000
         %SUBROUTINE TO CHANGE STATES - CONTROL TO TEXT                 13414000
         DS:=LIT "!"; TALLY:=1; C:=TALLY; CI:=TN;                       13415000
NEX:     AREA:=CI; GO TO STAR;                                          13416000
         %SUBROUTINE THAT DOES THE WORK IN MOVING AND CONVERTING CHARS  13417000
         D(IF SC = "~" THEN                                             13418000
         BEGIN TN:=CI; CI:=A; DS:=LIT "@";                              13419000
              SI:=SI+1; TN:=CI; CI:=B;                                  13420000
         END ELSE                                                       13421000
         BEGIN G(IF SC!"{" THEN JUMP OUT;  % NOT CARRIAGE RETURN        13422000
              TN:=CI; CI:=A; SI:=SI+2; DS:=LIT "-";                     13423000
              TN:=CI; CI:=B; JUMP OUT TO SKPP);                         13424000
              IF SC = "!" THEN DS:=LIT "!";                             13425000
              DS:=CHR; TALLY:=0; C:=TALLY;                              13426000
         END;                                                           13427000
SKPP:    );                                                             13428000
         CI:=F;  %SUBROUTINE EXIT                                       13429000
STAR:    F:=CI; CI:=AREA; %CALL SUBR. FOR MOD 32 CHRS                   13430000
         TALLY:=32; D:=TALLY; E(F:=CI; CI:=AREA);                       13431000
         G(DI:=DI-2; JUMP OUT TO AXEIT);                                13432000
         TN:=CI; CI:=A; TN:=DI;                                         13433000
AXEIT:   DS:=2 LIT "#~";                                                13434000
    END;                                                                13435000
    IF NUMCHRS!0 AND UNIT>1 THEN  %ATTEMPT BLANK SUPPRESSION            13436000
    STREAM(D:=P:B:=0,C:=0,A:=F);                                        13437000
    BEGIN SI:=A; D:=CI; GO TO LOOP;                                     13438000
         %SUBROUTINE TO CHECK FOR ETX AT END OF STRING OF BLANKS        13439000
         IF SC = "!" THEN                                               13440000
         BEGIN SI:=SI+1;                                                13441000
              IF SC = "#" THEN  %ETX - FORGET ABOUT THE BLANKS          13442000
              BEGIN C(DI:=DI-1; JUMP OUT TO AX); DS:=LIT "!";           13443000
AX:                DS:=CHR; GO TO LOOP;                                 13444000
              END ELSE SI:=SI-1;                                        13445000
         END;                                                           13446000
         TALLY:=0; CI:=B;  %SUBROUTINE EXIT                             13447000
NOGO:    %NOT GOING TO SUPPRESS BLANKS                                  13448000
         A:=TALLY; B:=CI; CI:=D; A(DS:=LIT " "); GO TO LOOP;            13449000
SPEC:    TALLY:=1; C:=TALLY; SI:=LOC C;                                 13450000
         SI:=SI+6; DI:=DI-2; DS:=2 ADD; TALLY:=0;                       13451000
         DS:=5 LIT "!;!99"; SI:=B;                                      13452000
LOOP:    IF SC NEQ "~" THEN                                             13453000
         BEGIN IF SC = " " THEN  %ATTEMPT TO SUPPRESS BLANKS            13454000
              BEGIN C:=TALLY; TALLY:=1; SI:=SI+1;                       13455000
                   4(IF SC NEQ " " THEN JUMP OUT TO NOGO;               13456000
                   SI:=SI+1; TALLY:=TALLY+1);                           13457000
                   %  COUNT TOTAL NUMBER BLANKS                         13458000
                   A:=TALLY; B:=DI; DI:=A;  %DI USED AS COUNTER         13459000
BL:                IF SC = " " THEN                                     13460000
                   BEGIN SI:=SI+1; DI:=DI+8; GO TO BL; END;             13461000
                   A:=DI; DI:=B; B:=CI; CI:=D;                          13462000
                   B:=SI; SI:=LOC A;                                    13463000
                   C(DI:=DI-1; JUMP OUT TO N); DS:=LIT "!";             13464000
N:                 DS:=2 LIT ";!"; DS:=2 DEC;                           13465000
                   IF TOGGLE THEN ELSE GO TO SPEC;                      13466000
                   SI:=B; GO TO LOOP;                                   13467000
              END;  %NO BLANK NEXT                                      13468000
              IF SC = "!" THEN                                          13469000
              BEGIN C:=TALLY; C(JUMP OUT TO R); TALLY:=1;               13470000
              END ELSE                                                  13471000
R:            TALLY:=0;                                                 13472000
              DS:=CHR; GO TO LOOP;                                      13473000
         END;                                                           13474000
         DS:=CHR; DI:=DI-2; D:=DI;                                      13475000
    END;                                                                13476000
    NT2:=P; IF NT1 GTR 0 THEN                                           13477000
    IF (NT2.[CF] - F.[15:15]) LSS 44 THEN                               13478000
    IF NOT NT3.[20:1] THEN                                              13479000
    IF (NT1:=NT1-1) GTR 0 THEN                                          13480000
    BEGIN AREA:=VR:=VR-18;                                              13481000
         F:=NT2&F[15:15:15];                                            13482000
         GO TO PRINLOOP;                                                13483000
    END;                                                                13484000
RY: IF UNIT=3 THEN MASK:=@10000 ELSE  %[35:1]                           13485000
    IF UNIT=2 THEN MASK:=@1000 ELSE   %[38:1]                           13486000
    IF UNIT = 1 THEN  % SPO                                             13487000
    IF STACURR.[40:1] THEN  %TANK IN RJEWAITQ                           13488000
    BEGIN AREA:=P(RJEWAITQ,STA OR @7777700000,LLL,0,INX,.UNIT,STD);     13489000
         M[F:=F.[15:15]-1]:=STA&AREA[FTF]&UNIT[CTC]&1[3:42:6];          13490000
         M[AREA.[FF]].[CF]:=F;                                          13491000
         M[UNIT].[FF]:=F;                                               13492000
         P(XIT);                                                        13493000
    END ELSE MASK:=0;                                                   13494000
    IF (STACURR AND MASK)!0 THEN                                        13495000
    COMPLEXSLEEP((STACURR AND MASK)=0);                                 13496000
    P(DC19Q,STA,LLL,3,INX,.AREA,STD,DEL);                               13497000
    IF M[AREA]=0 THEN                                                   13498000
    BEGIN SLEEP([M[AREA]],@77); GO TO RY; END;                          13499000
    M[AREA]:=(*P(DUP)) - 1;                                             13500000
    STACURR.[32:1]:=1;                                                  13501000
    AREA:=P(STATIONMESSAGEHOLDER,STA OR @7777700000,LLL,                13502000
            0,INX,.UNIT,STD);                                           13503000
    M[F:=F.[15:15]-1]:=STA&AREA[FTF]&UNIT[CTC];                         13504000
    M[AREA.[FF]].[CF]:=F;                                               13505000
    M[UNIT].[FF]:=F;                                                    13506000
    RUNSMW;                                                             13507000
END TWXOUT;                                                             13508000
PROCEDURE RJINPUT(STA); VALUE STA; REAL STA;                            13509000
BEGIN  %THIS IS THE PROCEDURE THAT HANDLES ALL REMOTE JOB INPUT         13510000
    DEFINE STACURR=STATION[STA.[14:4],STA.[9:4]]#;                      13511000
    REAL RCW=+0,N=+1,L=+2,T1=+3,T2=+4,D=+5,X=+6,Q=+7,FIR=+8,DCLINK=+9,  13512000
    HELLO=+10,INBUFF=+11,OUTBUFF=+12,OUTBUFFOLD=+13,RESERVE=+14,        13513000
    FIRSTCARD=+15;  ARRAY H=+16[*];  INTEGER A=X,I=T1;                  13514000
    LABEL EXIT,BOMB,ERROR,CARDRDR,SPO,LOOP,CONTROL,STR,FORG,            13515000
    DIALUP,UNITCHANGE;                                                  13516000
    SWITCH INUNIT:=CONTROL,SPO,CARDRDR,ERROR,ERROR,ERROR,ERROR;         13517000
    SWITCH CONTROLSW:=DIALUP,UNITCHANGE,UNITCHANGE;                     13518000
    SUBROUTINE ADR;                                                     13519000
    BEGIN IF (T2:=H[(T1:=A DIV 200)+10])=0 THEN                         13520000
         BEGIN H[9]:=T1+1;                                              13521000
              T2:=H[T1+10]:=GETUSERDISK(200);                           13522000
         END;                                                           13523000
         A:=A MOD 200 + T2;                                             13524000
    END;                                                                13525000
    %%%%%%%%%START HERE                                                 13526000
    P(GETSPACE(128,12,0)+1,STS,STA AND @7570000000000,                  13527000
    RCW,0,RDS,0,XCH,CFX,STF);                                           13528000
    STACKUSE:=TRUE;                                                     13529000
    P(0,0,0,0,0,0,0,3,DC19Q,STA,LLL,XCH,DEL,1,INX,0,GETSPACE(31,0,1)+3);13530000
    %DONT GET SPACE FOR BUFFERS USED BY RJ CARDRDR DECKS UNTIL NEEDED   13531000
    %HERE IS ALL THE ACTION - READ ALL BUFFERS OUT OF THE DC19Q         13532000
    %IF A CARD READER DECK IS STARTED DONT EXIT UNTIL IT IS DONE        13533000
    %ELSE LEAVE AS SOON AS ALL INPUT HAS BEEN HANDLED                   13534000
LOOP:  %FIND FIRST ENTRY IN DC19Q FOR STA                               13535000
    IF (A:=Q.[CF]=0) THEN ELSE GO TO STR;                               13536000
    IF FIR AND HELLO=0 THEN                                             13537000
    IF M[DCLINK].[CF]=DCLINK OR M[M[DCLINK]]>0 THEN GO TO EXIT;         13538000
    IF M[DCLINK].[CF]=DCLINK THEN COMPLEXSLEEP(M[DCLINK].[CF]!DCLINK);  13539000
    T2:=M[DCLINK].[CF];                                                 13540000
    WHILE (T1:=M[T2]) GTR 0 DO SLEEP([M[T2]],-0);                       13541000
    M[DCLINK].[CF]:=T1; %DELINK FROM QUEUE                              13542000
    M[T1]:=(*P(DUP))&T1[FTF];                                           13543000
    Q:=(T2+2)&(T2+1)[15:33:15];                                         13544000
STR:                                                                    13545000
    STREAM(TN:=A,SS:=Q,S:=P(DUP).[9:6]=1:INBUFF);                       13546000
    BEGIN TN(SI:=SS;SI:=SI+3;IF SC="1" THEN                             13547000
             BEGIN DS:=8 LIT "~"; JUMP OUT TO CLR; END);                13548000
          S(DS:=8 LIT "~"; JUMP OUT TO CLR); DS:=8 LIT " ";             13549000
CLR:     SI:=INBUFF; DS:=29 WDS;                                        13550000
         SI:=SS; TN(SI:=SI+7); IF SC="-" THEN SI:=SI+1; DI:=INBUFF;     13551000
LOOPC:   IF SC = "!" THEN                                               13552000
         BEGIN SI:=SI+1;                                                13553000
              IF SC = "!" THEN                                          13554000
              BEGIN DS:=CHR; GO TO LOOPC;                               13555000
              END ELSE GO TO LOOPN;                                     13556000
         END;                                                           13557000
         IF SC = "@" THEN                                               13558000
         BEGIN SI:=SI+1; DS:=LIT "~"; GO TO LOOPC; END;                 13559000
         IF SC="-" THEN                                                 13560000
         BEGIN S:=SI; GO TO EXIT; END;                                  13561000
         IF SC="#" THEN                                                 13562000
         BEGIN S:=TALLY; GO TO EXIT; END;                               13563000
         IF SC ! ";" THEN  %INVALID CHARACTER - DISCARD IT              13564000
         BEGIN SI:=SI+1; GO TO LOOPC; END;                              13565000
         %NEXT IS THE BLANK SUPPRESSION CODE                            13566000
         SI:=SI+2; INBUFF:=DI; DI:=LOC S; DS:=7 LIT "0"; DS:=CHR;       13567000
         DI:=INBUFF; S(DS:=10 LIT " "); INBUFF:=DI; DI:=LOC S;          13568000
         DI:=DI+7; DS:=CHR; DI:=INBUFF; S(DS:=LIT " ");                 13569000
LOOPN:   %NORMAL STATE CHARACTERS                                       13570000
         IF SC = "!" THEN                                               13571000
         BEGIN SI:=SI+1;                                                13572000
              IF SC ! "!" THEN GO TO LOOPC;                             13573000
         END;                                                           13574000
         DS:=CHR; GO TO LOOPN;                                          13575000
EXIT:    %GET DEVICE AND TRANSMISSION NUMBER                            13576000
         TN(SI:=SS;SI:=SI+2;DI:=LOC SS;DS:=2 OCT;DI:=LOC TN;DS:=CHR);   13577000
    END;                                                                13578000
    IF (Q:=P&Q[9:9:21]).[CF]=0 THEN FORGETSPACE(Q.[15:15]);             13579000
    T1:=P; IF (NT5:=P) THEN                                             13580000
    BEGIN Q:=Q&T1[9:42:6];                                              13581000
         STACURR:=(*P(DUP))&NT5[4:2:4];                                 13582000
    END ELSE T1:=Q.[9:6];                                               13583000
    IF T1 } 3 THEN GO TO FORG;                                          13584000
    IF HELLO=0 THEN  %NOT IN DIAL UP PROCESS                            13585000
    IF T1=0 OR GET(STA).[46:1] THEN ELSE GO TO FORG ELSE  %DISCARD      13586000
    IF T1 LEQ 1 THEN                                                    13587000
    IF T1 = 1 THEN                                                      13588000
    BEGIN                                                               13589000
         IF L.[6:6] = 0 THEN  %NO USERCODE ALREADY ENTERED              13590000
         BEGIN T1:=INBUFF&(P(DUP))[15:33:15];                           13591000
              INBUFF:=GETSPACE(31,0,0)+3;                               13592000
         END ELSE             %USERCODE ALREADY - NOW ADD PASSWORD      13593000
         STREAM(INBUFF,L,T1:=T1:=(GETSPACE(10,0,0)+2)                   13594000
                                  &(P(DUP)+1)[15:33:15]);               13595000
         BEGIN SI:=LOC L; SI:=SI+1; DS:=7 CHR;                          13596000
              DS:=LIT ","; SI:=INBUFF; DS:=9 WDS;                       13597000
         END;                                                           13598000
         M[T1.[15:15]-2]:=STA;                                          13599000
         P([HELLO],0,INX);                                              13600000
         LGINOUT(T1,1);                                                 13601000
         L:=P;  %RETRIEVE USERCODE FOUND BY LGINOUT                     13602000
         IF GET(STA).[46:1] THEN                                        13603000
         BEGIN HELLO:=0;                                                13604000
              IF P(GET(STA),DUP).[36:1] THEN                            13605000
              P(PRINTORPUNCHWAIT(-20,STA),DEL);                         13606000
              IF P.[39:1] THEN P(PRINTORPUNCHWAIT(-22,STA),DEL);        13607000
              GO TO LOOP;                                               13608000
         END;                                                           13609000
         IF (HELLO:=HELLO+1) GTR 4 THEN                                 13610000
         BEGIN  %TOO MANY INVALID USERCODES                             13611000
              HELLO:=0; GO TO LOOP;                                     13612000
         END ELSE GO TO LOOP;                                           13613000
    END ELSE GO TO CONTROL ELSE                                         13614000
    BEGIN                                                               13615000
FORG:    IF Q.[CF]!0 THEN FORGETSPACE(Q.[15:15]);                       13616000
         Q:=0; GO TO LOOP;                                              13617000
    END;                                                                13618000
    GO TO INUNIT[T1];                                                   13619000
CONTROL:  %USED FOR THE SPECIAL CONTROL MESSAGES                        13620000
    STREAM(I:=INBUFF:);                                                 13621000
    BEGIN SI:=I; DI:=LOC I; DS:=2 OCT; END;                             13622000
    GO TO CONTROLSW[T1:=P];                                             13623000
DIALUP:                                                                 13624000
    STREAM(N:=STACURR.[46:1]:INBUFF);                                   13625000
    BEGIN SI:=INBUFF; SI:=SI+2; DI:=DI+16;                              13626000
L:       IF SC = "0" THEN                                               13627000
         BEGIN DS:=2 OCT; GO TO L; END;                                 13628000
         DS:=22 LIT "B5700 R. J. E. SYSTEM ";                           13629000
         N(DS:=24 LIT "CONNECTION REESTABLISHED"; JUMP OUT TO A);       13630000
           DS:=24 LIT "-- ENTER USERCODE PLEASE";                       13631000
 A:      DS:=2 LIT "{!";                                                13632000
    END STREAM;                                                         13633000
    FOR T1:=2 STEP 1 WHILE (T2:=M[INBUFF+T1]).[1:5]=0 DO                13634000
    IF T2=2 THEN STACURR.[39:1]:=1 ELSE                                 13635000
    IF T2=3 THEN STACURR.[36:1]:=1;                                     13636000
    TWXOUT(1,47,INBUFF+T1,STA);                                         13637000
    IF NOT P THEN BEGIN HELLO:=1; L:=0; END;                            13638000
    GO TO LOOP;                                                         13639000
UNITCHANGE:                                                             13640000
    STREAM(INBUFF,T2:=[T2]);                                            13641000
    BEGIN SI:=INBUFF; SI:=SI+2; DS:=2 OCT; END;                         13642000
    IF (T1:=(T1 INX STA)&T2[CTF]) THEN RJEUNITCHANGE(T1) ELSE           13643000
    INDEPENDENTRUNNER(P(.RJEUNITCHANGE),T1);                            13644000
    GO TO LOOP;                                                         13645000
SPO:  %INPUT FROM REMOTE SPO                                            13646000
    INDEPENDENTRUNNER(P(.KEYIN),1&INBUFF[CTF]&STA[9:9:9]);              13647000
    INBUFF:=GETSPACE(31,0,1)+3;                                         13648000
    GO TO LOOP;                                                         13649000
CARDRDR:  %PLACE INPUT FROM CARD READER IN LOAD CONTROL TYPE DECKS      13650000
    IF FIR THEN  %START UP A NEW DECK                                   13651000
    BEGIN IF FIR=3 THEN  %GO GET BUFFER SPACE FOR DECKS                 13652000
         P(GETSPACE(60,0,1)+2,DUP,GETSPACE(30,0,1)+2,                   13653000
         GETSPACE(10,0,1)+2,[M[GETSPACE(30,0,1)+2]]&30[8:38:10]);       13654000
         FIR:=L:=N:=H[9]:=0;                                            13655000
         MOVE(20,[H[9]],[H[10]]);                                       13656000
         H[8]:=200; D:=1;                                               13657000
         MOVE(10,INBUFF,FIRSTCARD);                                     13658000
    END;                                                                13659000
    IF D = 0 THEN SLEEP([D],NOT 0);  %WAIT FOR DISKIO IF NECESSARY      13660000
    MOVE(10,INBUFF,OUTBUFF);                                            13661000
    IF (P(M[INBUFF],TOP) AND P(XCH).[1:5]=@14) THEN                     13662000
    BEGIN IF L DIV 6 ! N DIV 6 THEN                                     13663000
         BEGIN A:=L DIV 3;                                              13664000
              ADR;                                                      13665000
              DISKWAIT(-RESERVE,30,A);                                  13666000
              M[I:=L MOD 3 | 10 + 9 + RESERVE]:=N;                      13667000
              DISKWAIT(RESERVE,30,A);                                   13668000
         END ELSE M[(L-N)|10 + 9 + OUTBUFF]:=N;                         13669000
         L:=M[OUTBUFF+9]:=N;                                            13670000
         Q:=NABS(Q);                                                    13671000
    END;                                                                13672000
    IF N=12000 THEN  %DECK IS TOO LARGE                                 13673000
    BEGIN STREAM(FIRSTCARD,T1:=T1:=GETSPACE(14,0,0)+2);                 13674000
         BEGIN DS:=32 LIT                                               13675000
              "#MORE THAN 12000 CARDS IN:    {!";                       13676000
              SI:=FIRSTCARD; DS:=9 WDS; DS:=2 LIT "{!";                 13677000
         END;                                                           13678000
         TWXOUT(1&1[CTF],105,T1,STA);                                   13679000
         GO TO BOMB;                                                    13680000
    END;                                                                13681000
    IF (N:=N+1) MOD 6 = 0 THEN  % WRITE OUT ANOTHER BLOCK               13682000
    BEGIN A:=N DIV 3 - 2;                                               13683000
         ADR;                                                           13684000
         OUTBUFF:=OUTBUFFOLD;                                           13685000
         DISKIO(D,OUTBUFF-1,60,A);                                      13686000
    END ELSE OUTBUFF:=OUTBUFF+10;                                       13687000
    IF Q.[1:1] THEN  %CHECK FOR QM END                                  13688000
    BEGIN M[INBUFF+9]:=0&"."[1:43:5];                                   13689000
         STREAM(X:="END":INBUFF);                                       13690000
         BEGIN SI:=INBUFF;                                              13691000
L:            SI:=SI+1; IF SC = " " THEN GO TO L;                       13692000
              DI:=LOC X; DI:=DI+5;                                      13693000
              IF 3 SC = DC THEN TALLY:=1;                               13694000
              X:=TALLY;                                                 13695000
         END;                                                           13696000
         IF P THEN ELSE GO TO LOOP;                                     13697000
    END ELSE GO TO LOOP;                                                13698000
    %  END OF DECK CLOSE THE FILE                                       13699000
    IF D = 0 THEN SLEEP([D],NOT 0);                                     13700000
    OUTBUFF:=OUTBUFFOLD;                                                13701000
    L:=(A:=N DIV 6|2)+2;                                                13702000
    ADR;                                                                13703000
    IF N MOD 6 ! 0 THEN DISKWAIT(OUTBUFF,60,A);                         13704000
    IF L LSS 200 THEN                                                   13705000
    BEGIN H[8]:=L;                                                      13706000
         FORGETUSERDISK(A+2,L-200);                                     13707000
    END;                                                                13708000
    H[7]:=N-1;                                                          13709000
    H[6]:=0&STA[9:9:9];                                                 13710000
    H[5]:=-0;                                                           13711000
    H[4]:=0;                                                            13712000
    FIR:=1;                                                             13713000
    ENTERCONTROLDECK(H);                                                13714000
    GO TO LOOP;                                                         13715000
ERROR:                                                                  13716000
BOMB:  %THROWAWAY THE LATEST DECK                                       13717000
    T1:=H[9]+9; FIR:=1;                                                 13718000
    FOR T2:=10 STEP 1 UNTIL T1 DO                                       13719000
    FORGETUSERDISK(H[T2],-H[8]);                                        13720000
    GO TO LOOP;                                                         13721000
EXIT:  %THROWAWAY THE BUFFERS                                           13722000
    FORGETSPACE(INBUFF-1);                                              13723000
    IF FIR ! 3 THEN                                                     13724000
    BEGIN FORGETSPACE(OUTBUFFOLD);                                      13725000
         FORGETSPACE(FIRSTCARD);                                        13726000
         FORGETSPACE(RESERVE);                                          13727000
         FORGETSPACE(H);                                                13728000
    END;                                                                13729000
    STACURR.[33:1]:=0;                                                  13730000
    KILL([STA]);                                                        13731000
END REMOTE JOB INPUT HANDLER;                                           13732000
                   TACH(0,P1MIX,5);                                     14411520
              T:=VECTOR[6];                                             14411600
$ INCLUDE 14429301, IF DATACOM AND RJE AND NOT INQUIRY;                 14429199
              IF T.[9:9] ! 0 THEN                                       14429200
              VECTOR:=NABS(VECTOR INX 0)&T[9:9:9];                      14429300
$ INCLUDE 15520301, IF B6500LOAD;                                       15520299
         DS:=10 LIT "B6500LOAD,";                                       15520300
$ INCLUDE 15520401, IF RJE AND DATACOM AND NOT INQUIRY;                 15520399
         DS:=4 LIT "RJE,";                                              15520400
              IF P(GET(B),DUP,NOT) AND P(XCH).[32:1] THEN %BACK UP SPO  16030070
              P(P(DUP) GEQ 4,.J,STD,3,AND);                             16063500
$ INCLUDE 16064206, IF RJE;                                             16064204
         IF GET(B) THEN IF J THEN ELSE GO TO ERROR ELSE                 16064205
$INCLUDE 16067152, IF DCSPO AND DATACOM AND RJE AND NOT INQUIRY;        16067149
         IF B.[9:9]!0 THEN IF GET(B) THEN IF JAR[MIX,6].[9:9]=          16067150
         B.[9:9] THEN ELSE GO TO ERROR;  %REFERENCE ONLY OWN MIXES      16067151
    PT:  PRINTBACKUP(KTR&B[6:9:9]);                                     16082000
      INDEPENDENTRUNNER(P(.CONTROLCARD),T                               19045000
$ INCLUDE 19045006, IF DATACOM AND RJE AND NOT INQUIRY;                 19045004
                                        &JAR[P1MIX,6][9:9:9]            19045005
                                        &J[3:43:5]);                    19045007
$ INCLUDE 19045098, IF DATACOM AND RJE AND NOT INQUIRY;                 19045096
                   H[6]:=0&JAR[P1MIX,6][9:9:9];                         19045097
$ INCLUDE 20061051, IF DATACOM AND RJE AND NOT INQUIRY;                 20061049
      IF NOT GET(S[23]) THEN  %CAN ONLY EXECUTE FROM RJE                20061050
             IF (L:=GET(S[23])) OR (NOT L.[32:1] AND                    20082200
$VOID                                                                   20082205
               (L.[4:4]!L.[9:4] OR L.[14:4]!L.[18:4])) THEN             20082210
         IF NOT (L:=GET(S[23])) THEN                                    20092575
            BEGIN IF NOT L.[32:1] THEN TACH(L,MIX,7);                   20092630
               IF NOT (L:=GET(S[23])).[31:1] THEN                       20092650
         IF L.[9:9]!0 THEN IF L THEN  %REMOTE JOB                       20097000
BMSG:    T:=NABS(T&S[23][9:9:9]) ELSE                                   20097100
         IF L.[32:1] OR (L.[4:4]=L.[9:4] AND L.[14:4]=L.[18:4])         20097200
         THEN ELSE GO TO BMSG;                                          20097300
         SPOUT(T);                                                      20097400
                     0,0&CARD[9:9:9]);                                  20587600
                 0,0&CARD[9:9:9]);                                      20588950
         IF P(GET(CARD),DUP).[32:1] AND NOT P(XCH) THEN                 20597150
         BEGIN USERID:=MCP; P(0); GO TO FINDX; END;                     20597160
$ INCLUDE 20597361, IF RJE;                                             20597359
         IF GET(CARD) THEN P(0) ELSE                                    20597360
$ INCLUDE 20602421, IF DATACOM AND RJE AND NOT INQUIRY;                 20602409
         IF CARD.[9:9]!0 THEN IF GET(CARD) THEN                         20602410
         P(CCFIND(CARD,USERID,ADDR,T),DEL); %FIND DEFAULT USER          20602420
$ INCLUDE 20602911, IF DATACOM AND RJE AND NOT INQUIRY;                 20602909
         IF NOT GET(CARD) THEN  %DONT CALL IF RJE                       20602910
$ INCLUDE 20603221, IF DATACOM AND RJE AND NOT INQUIRY;                 20603209
               IF CARD.[9:9]!0 THEN IF GET(CARD) THEN                   20603210
               CMM[6]:=(*P(DUP))&CARD[9:9:9];                           20603220
$ INCLUDE 20604411, IF DATACOM AND RJE AND NOT INQUIRY;                 20604409
          IF NOT GET(CARD) THEN  %DONT CALL IF RJE                      20604410
USERS: T:=SCAN; T:=SCAN;                                                20605700
       IF (USERID.[1:1] AND USERID!MCP)                                 20605750
$ INCLUDE 20605761, IF DATACOM AND RJE AND NOT INQUIRY;                 20605759
       OR GET(CARD)                                                     20605760
       THEN USERID := ACCUM[0];                                         20605800
$ INCLUDE 20606971, IF DATACOM AND RJE AND NOT INQUIRY;                 20606969
       IF GET(CARD) THEN T:=T&CARD[9:9:9];                              20606970
$ INCLUDE 20607471, IF DATACOM AND RJE AND NOT INQUIRY;                 20607469
       IF GET(CARD) THEN T:=T&CARD[9:9:9];                              20607470
                        BOUF:=BOUF&STA[9:9:9]&1[2:47:1];                21247000
$ INCLUDE 23054301, IF RJE;                                             23054299
TOUT,RTRY,                                                              23054300
    SUBROUTINE PERFORMIO;  %DOES IO FROM BUFF WITH RD                   23061100
    BEGIN RD:=BUFF INX (@0400000000000000 OR TUSTA);                    23061200
         IOREQUEST(NABS(RD&@113[25:40:8]),RD,[RD]&30[12:42:6]);         23061300
         SLEEP([RD],IOMASK);                                            23061400
    END;                                                                23061500
$ INCLUDE 23079031, IF RJE;                                             23079009
              IF GET(STA) THEN                                          23079010
              IF P(STATIONMESSAGEHOLDER,STA,LLL,0,INX,.MESSADDR,STD)    23079020
              .[9:9]=STA.[9:9] THEN GO TO FORGETALL ELSE GO TO EGRESS;  23079030
                        BEGIN                                           23145500
$ INCLUDE 23149001, IF RJE;                                             23145999
                             IF STA THEN IF STA.[45:1] THEN             23146000
                             BEGIN STREAM(N:=NT1:=STA.[18:4],BUFF);     23146100
                                   BEGIN SI:=LOC N; DI:=DI+4; DS:=DEC;  23146200
                                   END STREAM;                          23146300
                                   IF (NT1:=NT1+1)=10 THEN NT1:=0;      23146400
                                   STACURR.[18:4]:=NT1;                 23146500
                             END ELSE  %NOT SELECTED SEND OUT ENQ       23146600
                             BEGIN STREAM(B:=BUFF:=[MESS] INX 0);       23146700
                                   DS:=2 LIT "%~";                      23147000
TOUT:                             PERFORMIO;                            23147400
                                  IF (RD.[23:10] AND @464)!0 THEN       23147500
                                  PERFORMIO;  %QUIRK OF SYNCH ADAPT     23147600
                                  STACURR:=(*P(DUP))&1[29:47:1]         23147700
                                                    &1[45:47:1];        23147750
                                  RD:=CLOCK+P(RTR)+64; %WAIT A SECOND   23147800
                                  COMPLEXSLEEP((CLOCK+P(RTR)>RD) OR     23147850
                                               NOT STACURR.[29:1]);     23147900
                                  IF (STA:=STACURR).[29:1] THEN         23147950
                                  BEGIN STACURR.[42:2]:=NT5:=           23148000
                                                        STA.[42:2]+1;   23148050
                                       IF NT5=4 THEN %TOO MANY RETRIES  23148100
                                       BEGIN INQUPT(@100000000&         23148150
                                              STA[9:9:9]); GO LOOPEND;  23148200
                                       END ELSE GO TO TOUT;             23148250
                                  END ELSE                              23148300
                                  GO TO LOOPEND;                        23148500
                             END ELSE                                   23149000
$ INCLUDE 23149851, IF RJE;                                             23149849
RTRY:                                                                   23149850
$ INCLUDE 23152601, IF RJE;                                             23150999
                        END ELSE IF STA THEN                            23151000
                        IF STA<0 THEN BUFF:=BUFF INX (MESS.[3:6]) ELSE  23151100
                        IF STA.[31:1] THEN                              23151200
                        BEGIN STACURR.[31:1]:=0; GO RTRY; END ELSE      23151300
                        BEGIN STACURR.[32:1]:=HALF:=M[MESS].[9:9]       23151400
                             = TUSTA.[9:9];                             23151500
                             IF HALF THEN GO TO FORGETMESS;             23151600
                             STREAM(H:=HALF:=STA.[44:1],                23151700
                                    B:=BUFF:=[MESS] INX 0);             23151800
                             BEGIN H(DS:=LIT "$"; JUMP OUT TO EOT);     23151900
                                  DS:=LIT "&";  %ACK                    23152000
EOT:                              DS:=LIT "~";                          23152100
                             END;                                       23152200
                             PERFORMIO;                                 23152300
                             STACURR:=(*P(DUP))&1[29:47:1]&             23152400
                                      (1-HALF)[45:47:1];                23152500
                             GO TO FORGETMESS;                          23152600
                        END ELSE                                        23152700
                        PERFORMIO;                                      23170000
$VOID 23175001                                                          23171000
                                  BEGIN IF NOT STA THEN                 23178200
$ INCLUDE 23179071, IF RJE;                                             23179059
                             IF STA THEN M[MESSADDR]:=NABS(MESS)&       23179060
                                (RD-(MESSADDR+1))[3:42:6] ELSE          23179070
              END                                                       23206000
$ INCLUDE 23206501, IF RJE;                                             23206099
         ELSE IF STA THEN                                               23206100
              BEGIN                                                     23206200
              P(DC19Q,0&STA[9:9:9],LLL,3,INX,.ADDR,STD,DEL);            23206300
              M[ADDR]:=(*P(DUP))+1;                                     23206400
              LABEL L,PAR,DCW,INQ,CHECKSMW;                             24505000
              IF ((EF:=RD.[23:10] AND @1464) ! @1400  %NOT RR/AB        24525500
                   AND STA.[44:2] = 1)                                  24526000
$ INCLUDE 24526501, IF RJE;                                             24526499
                   OR STA                                               24526500
                   THEN IF NOT RD.[30:1] THEN                           24527000
$VOID 24530601                                                          24530000
                                  IF STA.[37:1] OR STA THEN             24530700
                                            END;                        24531300
$ INCLUDE 24531331, IF RJE;                                             24531309
                                            IF STA THEN STATION[        24531310
                                            STA.[14:4],STA.[9:4]]:=     24531320
                                            ABS(*P(DUP)) ELSE           24531330
                                            GO TO CHECKSMW;             24531340
                                  ELSE IF STA.[43:1] THEN DCREAD(STA)   24531360
$ INCLUDE 24534801, IF RJE;                                             24534599
                             IF EF=0 AND STA THEN                       24534600
                             IF STATION[STA.[14:4],STA.[9:4]].          24534700
                             [45:1] THEN GO TO L;  %DISCARD IDLE INT    24534800
LOGINOUT;                                                               25089000
                   GO TO LOGINOUT;                                      25197000
LOGINOUT:                                                               25223100
$ INCLUDE 25287091, IF RJE;                                             25287004
IF STA THEN  %RJE                                                       25287005
BEGIN IF PARAMETER.[CF]!0 THEN                                          25287010
    BEGIN ACTIVEINT;                                                    25287015
         IF STACURR.[30:1] THEN ELSE GO TO EGRESS;                      25287020
    END;                                                                25287025
    STATIONMESSAGEWRITER(0&STA[9:9:9]);                                 25287030
    WHILE (NT1:=P(RJEWAITQ,0&STA[9:9:9],LLL,0,INX,.NT2,STD)).           25287035
           [9:9] = STA.[9:9] DO                                         25287040
    BEGIN M[NT1]:=(*P(DUP))&NT1[FTF];                                   25287045
         M[NT1.[FF]].[CF]:=NT1;                                         25287050
         FORGETSPACE(NT2);                                              25287055
    END;                                                                25287060
    STACURR:=@2000001&STA[9:9:9];                                       25287065
    NT1:=(GETSPACE(10,0,0)+2)&(P(DUP)+1)[15:CF];                        25287070
    M[NT1 INX NOT 0]:=0&STA[9:9:9];                                     25287075
    LGINOUT(NT1,2);                                                     25287080
    GO TO EGRESS;                                                       25287085
END;                                                                    25287090
IF SPOSTA THEN                                                          25287095
BEGIN                                                                   25287100
    GO TO LOGINOUT;                                                     25290000
    LABEL LOOPEND,CHECKGM,DOIO;                                         27045000
$ INCLUDE 27045201, IF RJE;                                             27045099
    LABEL      MSG,ACK,ENQ,EOT,NAK,INVLD,SMWR,NOGO;                     27045100
    SWITCH SW:=MSG,ACK,ENQ,EOT,NAK,INVLD;                               27045200
$ INCLUDE 27065001, IF RJE;                                             27064999
              IF NOT STA THEN                                           27065000
              IF AVAILABLEBUFFERS!0 THEN                                27065100
              AVAILABLEBUFFERS:=(*P(DUP))-1 ELSE GO TO LOOPEND;         27065200
$VOID                                                                   27067000
         IF STA.[33:1] AND NOT STA THEN                                 27081100
$ INCLUDE 27103701, IF RJE;                                             27103499
         IF RD.[28:1] AND STA THEN                                      27103500
         STREAM(S:=ELEMENT[1].[FF]+2);                                  27103600
         BEGIN SI:=S; IF SC!"$" THEN DS:=LIT "~"; END;                  27103700
$ INCLUDE 27105501, IF RJE;                                             27105499
              IF NOT STA THEN                                           27105500
                   L:="{<!";  % CR LF                                   27108000
DOIO:              STREAM(L,R:=RD:=[W] INX (0&STA[9:9:9]&1[3:47:1]));   27108200
                   BEGIN SI:=LOC L; SI:=SI+5;                           27108400
                        IF SC="{" THEN DS:=2 CHR ELSE SI:=SI+2;         27108600
                        DS:=CHR; DS:=LIT "~";                           27108800
                   END;                                                 27109000
$ INCLUDE 27111501, IF RJE;                                             27111499
                   IF STA THEN GO TO LOOPEND;                           27111500
$ INCLUDE 27112501, IF RJE;                                             27112099
              IF STA AND ERROR THEN                                     27112100
              BEGIN M[BUFFER:=ELEMENT[1].[FF]+1]:=(BUFFER+1)&           27112200
                        ELEMENT[1][20:8:10];  %REUSE READ BUFFER        27112300
                   ERROR:=0; L:="5"; GO TO NOGO;                        27112400
              END;                                                      27112500
$ INCLUDE 27115451, IF RJE;                                             27115009
              IF (STA:=STACURR:=(*P(DUP))&0[22:47:1]) THEN              27115010
              BEGIN STREAM(W:=W:=W+1:L:=[L]);                           27115020
                   BEGIN DS:=5 LIT "}&%$5";DI:=L; SI:=W;                27115030
                        5(IF SC=DC THEN JUMP OUT; TALLY:=TALLY+1;       27115040
                          SI:=SI-1); W:=TALLY;                          27115050
                   END;                                                 27115060
                   IF (L:=P) GTR 0 THEN                                 27115070
                   BEGIN M[W-2].[1:17]:=0;                              27115072
                        M[W-1]:=W&(ELEMENT[1]:=                         27115074
                                 NABS(*P(DUP)))[20:8:10];               27115076
                   END;                                                 27115078
                   IF L LSS 4 THEN STACURR.[42:2]:=0;                   27115080
                   GO TO SW[L];                                         27115090
MSG:               IF NOT STA.[33:1] THEN                               27115100
                   BEGIN STACURR.[33:1]:=1;                             27115110
                        INDEPENDENTRUNNER(P(.RJINPUT),STA);             27115120
                   END;                                                 27115130
                   STACURR.[44:1]:=0;                                   27115140
                   IF STA.[32:1] THEN                                   27115150
                   BEGIN STREAM(A:=1:W);                                27115160
                        BEGIN SI:=LOC A; DI:=DI+2;                      27115170
                             IF 2 SC=DC THEN                            27115180
                             BEGIN DI:=DI+5; SI:=SI+4;                  27115190
                                  IF 2 SC = DC THEN TALLY:=1;           27115200
                             END;                                       27115210
                             A:=TALLY                                   27115220
                        END;                                            27115250
                        IF P THEN  %CONTROL MSG CHECK IT                27115260
                        BEGIN STACURR.[22:1]:=1; GO LOOPEND; END;       27115270
SMWR:                   RUNSMW; GO TO LOOPEND;                          27115280
                   END;                                                 27115290
                   L:="&"; GO TO DOIO;                                  27115300
ACK:               STACURR.[44:2]:=STA.[32:1]+2;                        27115310
                   IF STA.[32:1] THEN GO TO SMWR;                       27115320
                   L:="$"; GO TO DOIO;                                  27115330
ENQ:               STACURR.[45:1]:=1; L:="&"; GO TO DOIO;               27115340
EOT:               STACURR.[45:1]:=0; GO TO SMWR;                       27115350
NAK:               STACURR.[31:1]:=1; GO TO NOGO;                       27115360
INVLD:             L:="%";  %SEND OUT ENQ UNLESS IT IS FOURTH RETRY     27115390
NOGO:              STACURR.[42:2]:=NT5:=STA.[42:2]+1;  %BUMP RETRY COUNT27115400
                   IF NT5 = 4 THEN  %THROWAWAY MESSAGES FOR THIS LINE   27115410
                   BEGIN INQUPT(@100000000&STA[9:9:9]);                 27115420
                        GO TO LOOPEND;                                  27115430
                   END ELSE IF L=4 THEN GO SMWR ELSE GO TO DOIO;        27115440
             END;                                                       27115450
$ OMIT 27115901, IF RJE;                                                27115899
               STACURR.[22:1]:=0;                                       27115900
$ VOID                                                                  27122300
                  BEGIN HEADER[73]~FIB[5].[FF] OR @360170100100000;     38334000
            R:=M[T+6];                                                  38607300
$ INCLUDE 38607901, IF DATACOM AND RJE AND NOT INQUIRY;                 38607399
            IF P(JAR[P1MIX,6].[9:9],DUP)!0 THEN                         38607400
            BEGIN P(GET(JAR[P1MIX,6]));                                 38607500
                 IF I THEN IF P.[39:1] THEN ELSE P(DEL,0)               38607600
                 ELSE IF P.[36:1] THEN ELSE P(DEL,0);                   38607700
            END;                                                        38607800
            M[T+6]:=P(XCH);                                             38607900
            ENTERUSERFILE(IF I THEN P(PUD) ELSE P(PBD),R,T-1);          38608000
            IF AUTOPRINT OR M[T+6]!0 THEN                               38609000
            IF PRINTORPUNCHWAIT(R.[6:24],I&M[T+6][9:39:9]) THEN         38609100
      INDEPENDENTRUNNER(P(.CONTROLCARD),(M[ALPHA-2].[CF])&              38732100
$ INCLUDE 38732201, IF DATACOM AND RJE AND NOT INQUIRY;                 38732199
                                        JAR[P1MIX,6][9:9:9]&            38732200
                                        U[2:42:6]);                     38732300
$ INCLUDE 39092041, IF DATACOM AND RJE AND NOT INQUIRY;                 39092039
      T2:=0&JAR[P1MIX,6][9:9:9];                                        39092040
      BEGIN IF USEPBD                                                   39092070
$ INCLUDE 39092076, IF DATACOM AND RJE AND NOT INQUIRY;                 39092074
           OR (IF T2!0 THEN GET(T2).[39:1] ELSE 0)                      39092075
           THEN TYPE:=22; GO TO LOOKOUT;                                39092080
      END;                                                              39092090
      BEGIN IF USEPBD                                                   39092150
$ INCLUDE 39092156, IF DATACOM AND RJE AND NOT INQUIRY;                 39092154
           OR (IF T2!0 THEN GET(T2).[36:1] ELSE 0)                      39092155
           THEN TYPE:=15; GO TO LOOKOUT;                                39092160
      END;                                                              39092170
DCO:     U:=30; KIND:=10;                                               39235000
$ INCLUDE 39235101, IF DATACOM AND RJE AND NOT INQUIRY;                 39235099
         IF T2 = 0 THEN                                                 39235100
         GO TO SPDC;                                                    39235200
DC19:                                                                   39236000
$ INCLUDE 39236016, IF DATACOM AND RJE AND NOT INQUIRY;                 39236009
        IF T2!0 THEN  %ILLEGAL USE OF DATACOM FOR REMOTE JOB ENTRY      39236010
         BEGIN STREAM(T2:=T2:=GETSPACE(12,0,0)+2);                      39236011
               DS:=30 LIT "-DATACOM INV WITH REMOTE JOB ~";             39236012
              TERMINATE(P1MIX);                                         39236013
              TERMINALMESSAGE(-T2);                                     39236014
          END;                                                          39236015
          FIB[14]:=NBUFS;                                               39236017
          U:=30; KIND:=13;                                              39236018
$ INCLUDE 44202036, IF RJE;                                             44202034
RJEWAITQ:=@7770000000000&P(.RJEWAITQ)[CTF]&P(.RJEWAITQ)[CTC];           44202035
LABEL LOOP,NOGOOD;                                                      45003100
$ INCLUDE 45075251, IF DATACOM AND NOT INQUIRY;                         45027999
                   B:=IRPTB AND @7570000000000;                         45052000
                   BLASTREAD;                                           45053000
$ VOID 45066001;                                                        45054000
SUBROUTINE BLASTREAD;                                                   45075010
BEGIN FOR IRPDBS:=0 STEP 1 UNTIL 1 DO                                   45075020
    P(WAITIO(B&1[18:47:1],@777300004,30),DEL);                          45075030
    IF NOT (IRPDBS:=GET(B)).[30:1] THEN                                 45075040
    BEGIN                                                               45075050
         IRPTB:=[DDD[60]] INX (@040000040000000 OR B);                  45075060
         IOREQUEST(NABS(IRPTB),IRPTB,[IRPTB]&30[12:42:6]);              45075070
         SLEEP([IRPTB],IOMASK);                                         45075080
         STATION[B.[14:4],B.[9:4]].[22:9]:=0;                           45075090
$ INCLUDE 45075171, IF DATACOM AND RJE AND NOT INQUIRY;                 45075099
         IF IRPDBS THEN                                                 45075100
         BEGIN                                                          45075110
              IRPDBS:=0;                                                45075150
              TWXOUT(0,2,[IRPDBS] INX 0,B);                             45075160
         END;                                                           45075170
         IRPDBS:=GETSPACE(10,0,0)+2;                                    45075180
         MOVE(10,SHLM,IRPDBS);                                          45075190
         SPOUT(IRPDBS INX B);                                           45075200
         M[(IRPDBS:=GETSPACE(10,0,0)+2)-1]:=(*P(DUP))&B[9:9:9];         45075210
         GIMEDATE(IRPDBS,1);                                            45075220
         M[(IRPDBS:=GETSPACE(10,0,0)+2)-1]:=(*P(DUP))&B[9:9:9];         45075230
         TIMEOUT(IRPDBS);                                               45075240
END; END;                                                               45075250
$VOID                                                                   45092100
                   BEGIN IF (J:=M[I+10])!0 THEN                         45094000
                        BEGIN DISKWAIT(-A,30,J);                        45094200
                             MCP:=NFLAG(M[A] INX 0);                    45094400
                             X:=M[I].[1:14] - 1;                        45094600
                             T:=0;                                      45094800
LOOP:                                                                   45095000
$ INCLUDE 45099201, IF DATACOM AND RJE AND NOT INQUIRY;                 45095199
                             IF (T:=T+X+1) GEQ 30 THEN                  45095200
                             BEGIN DISKWAIT(-A,30,J:=J+1); T:=0; END;   45095400
                             IF DDD[T] = 140 THEN  %RJE LINES           45095600
                             BEGIN                                      45095800
                                  FOR C:=1 STEP 1 UNTIL X DO            45096000
                                  IF (B:=DDD[C+T]) GTR 1 THEN           45096200
                                  BEGIN                                 45096400
                                       P(GET(B),DEL);                   45096600
                                       LOC:=P(DC19Q,B,LLL,0,INX,.Z,STD);45096800
                                       M[Z].[FF]:=Y:=GETSPACE(5,5,0)+2; 45097000
                                       M[LOC.[FF]].[CF]:=Y;             45097200
                                       M[Y]:=(Z&LOC[FTF]) OR B;         45097400
                                       M[Y:=Y+1]:=Y&Y[CTF]&60[8:38:10]; 45097600
                                       M[Y+1]:=0;                       45097800
                                       M[Y+2]:=M[Y+3]:=4;               45098000
                                       STATION[B.[14:4],B.[9:4]]:=      45098200
                                       B OR 1;                          45098400
                                       BLASTREAD;                       45098600
                                  END;                                  45098800
                                  GO TO LOOP;                           45099000
                             END;                                       45099200
                        END;                                            45099400
                        FORGETSPACE(I);                                 45099600
                   END ELSE MCP:=NOT 0;                                 45099800
                   FORGETSPACE(SHLM);                                   45100000
