VERSION A06

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:1    
        1        1        /*M*  Z8EZ -- Create ILL/ETT for STRING and UNSTRING statements */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*P*   NAME: Z8EZ$STRING
        9        9             AUTHOR: Mark Glenn  (Extract comments by John Heath)
       10       10            PURPOSE: This procedure does semantic checking and produces
       11       11                     the ILL/ETT for the STRING statement.
       12       12        */
       13       13
       14       14        /*D*   NAME: Z8EZ$STRING
       15       15
       16       16              INPUT: Abstract Syntax Tree for the STRING statement.
       17       17
       18       18             OUTPUT: ILS/ILL/ETT intermediate language items.
       19       19
       20       20        DESCRIPTION: Phase 1 makes 3 passes on the STRING statement.
       21       21                     The first pass (Z8EN) produces the Abstract
       22       22                     Syntax Tree (AST).  The second and third passes
       23       23                     are done by this procedure.
       24       24
       25       25             Pass 2: Validate the operands of the STRING statement.
       26       26
       27       27             Pass 3: Generate the intermediate language items to do
       28       28                     the STRING statement.  The STRING statement is
       29       29                     broken down into smaller statements (MOVE, IF, etc.)
       30       30                     by this module, thus it makes calls to procedures
       31       31                     used by these smaller statements (Z8E7$MOVE,
       32       32                     Z8EK$BRANCH_TRUE, etc.).
       33       33
       34       34                     Pass 3 is broken into two parts: optimizable and
       35       35                     not-optimizable.  The algorithm for optimizable
       36       36                     STRING (simple STRING with no DELIMITED clauses)
       37       37                     generates a series of MOVEs.  The algorithm for
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:2    
       38       38                     non-optimizable STRING is highly dependent on the
       39       39                     types and numbers of optional clauses used in the
       40       40                     the statement.
       41       41        */
       42       42
       43       43        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:3    
       44       44        Z8EZ$STRING:PROC( STRING_LIST$ ,
       45       45                          INTO$ ,
       46       46                          POINTER$ ,
       47       47                          ON_OVERFLOW$,
       48       48                          NOT_ON_OVERFLOW$ );
       49       49
       50       50
       51       51    1        DCL KEYWORD$       PTR;
       52       52    1        DCL INTO$          PTR;
       53       53    1        DCL POINTER$      PTR;
       54       54    1        DCL STRING_LIST$   PTR;
       55       55    1        DCL ON_OVERFLOW$   PTR;
       56       56    1        DCL NOT_ON_OVERFLOW$  PTR;
       57       57
       58       58
       59       59
       60       60             %EQU PHASE = 1;
       61       61             %INCLUDE Z8A_DEFC;
       62      129             %INCLUDE Z8A_SUPP_MAC;
       63     2529             %INCLUDE Z8E_MACROS;
       64     3204             %INCLUDE Z8E_STACKS;
       65     5470             %INCLUDE Z8A_ST;
       66     9129             %INCLUDE Z8A_ETT;
       67     9430             %INCLUDE Z8A_ILL;
       68    10123             %INCLUDE Z8A_COMCOM;
       69    10773             %INCLUDE Z8A_LIBRARY;
       70    10987             %INCLUDE Z8E_O1COM;
       71    11748             %INCLUDE Z8E_HEAP;
       72    11804             %INCLUDE Z8E_WINDOW;
       73    13874             %INCLUDE Z8A_ILS;
       74    13983             %INCLUDE Z8E_ILS_LIST;
       75    14067             %INCLUDE Z8A_TYPES;
       76    14241             %INCLUDE Z8A_ERR_NUMS;
       77    15005
       78    15006
       79    15007    1        DCL Z8EV$LEAST_STRONGEST_TYPE    ENTRY(3);
       80    15008    1        DCL Z8EV$CONVERT_TYA             ENTRY(3);
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:4    
       81    15009    1        DCL Z8AT$CREATE_TEMP_WITH_BASE   ENTRY(2);
       82    15010    1        DCL Z8AT$CREATE_TEMPORARY        ENTRY(2);
       83    15011    1        DCL Z8AC$LX_ETT_ITEM_TYI_CONST   ENTRY(2);
       84    15012    1        DCL Z8AU$LENGTH                  ENTRY(2);
       85    15013    1        DCL Z8E5$MATH_PACK               ENTRY(2);
       86    15014    1        DCL Z8EK$COMPARE                 ENTRY(4);
       87    15015    1        DCL Z8EK$BRANCH                  ENTRY(1) ;
       88    15016    1        DCL Z8EK$BRANCH_TRUE             ENTRY(2);
       89    15017    1        DCL Z8EK$BRANCH_FALSE            ENTRY(2);
       90    15018    1        DCL Z8ED$DISPOSE_ABSSYN_TREE     ENTRY(1);
       91    15019    1        DCL Z8EY$INSERT                  ENTRY(4);
       92    15020    1        DCL Z8E7$MOVE                    ENTRY(2);
       93    15021    1        DCL Z8CO$CREATE_LIBRARY_BASE     ENTRY(2);
       94    15022    1        DCL Z8CO$DISPL_CHECK             ENTRY(1) ALTRET;
       95    15023    1        DCL Z8CO$INTEGER_CHECK           ENTRY(1) ALTRET;
       96    15024    1        DCL Z8CO$INTEGER_CHECK_NO_ERROR  ENTRY(1) ALTRET;
       97    15025    1        DCL Z8CO$P_CHECK                 ENTRY(1) ALTRET;
       98    15026    1        DCL Z8AE$ERROR                  ENTRY(12);
       99    15027    1        DCL Z8EZ$MAX_VALUE              ENTRY(2);
      100    15028    1        DCL Z8AU$LENGTH_ETT             ENTRY(2);
      101    15029    1        DCL Z8AU$TYPE_DESCRIPTOR        ENTRY (2) ;
      102    15030    1        DCL Z8AF$FORME                  ENTRY(4) ;
      103    15031    1        DCL Z8AF$NEW_FISS               ENTRY(4) ;
      104    15032    1        DCL Z8AF$NEW_OFF                ENTRY(3) ;
      105    15033    1        DCL Z8EA$SUBSTR_ZERO            ENTRY(4) ;
      106    15034
      107    15035
      108    15036    1        DCL STRINGS$         PTR;
      109    15037    1        DCL IDENTS$          PTR;
      110    15038
      111    15039            %DCL_AUTO_LX_ITEM     ( @NAME = SENDING );
      112    15043            %DCL_AUTO_LX_ITEM     ( @NAME = RECEIVING );
      113    15047
      114    15048            %DCL_AUTO_LX_ITEM     ( @NAME = ID1 );
      115    15052            %DCL_AUTO_LX_ITEM     ( @NAME = ID2 );
      116    15056            %DCL_AUTO_LX_ITEM     ( @NAME = ID3 );
      117    15060            %DCL_AUTO_LX_ITEM     ( @NAME = ID4 );
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:5    
      118    15064
      119    15065            %DCL_AUTO_LX_ITEM     ( @NAME = LENGTH_ID1 );
      120    15069            %DCL_AUTO_LX_ITEM     ( @NAME = LENGTH_ID2 );
      121    15073            %DCL_AUTO_LX_ITEM     ( @NAME = LENGTH_ID3 );
      122    15077
      123    15078            %DCL_AUTO_LX_ITEM     ( @NAME = ONE );
      124    15082            %DCL_AUTO_LX_ITEM     ( @NAME = TWO );
      125    15086            %DCL_AUTO_LX_ITEM     ( @NAME = REMAINDER );
      126    15090            %DCL_AUTO_LX_ITEM     ( @NAME = LENGTH_ID3_P1) ;
      127    15094            %DCL_AUTO_LX_ITEM     ( @NAME = MINIMUM_ );
      128    15098            %DCL_AUTO_LX_ITEM     ( @NAME = INDX );
      129    15102            %DCL_AUTO_LX_ITEM     ( @NAME = INDEX_EXPR ) ;
      130    15106            %DCL_AUTO_LX_ITEM     ( @NAME = ADD );
      131    15110            %DCL_AUTO_LX_ITEM     ( @NAME = KANJI_LX_ETT );
      132    15114            %DCL_AUTO_LX_ITEM     ( @NAME = PLUS_ONE );
      133    15118            %DCL_AUTO_LX_ITEM     ( @NAME = POINTER_TIMES2 );
      134    15122
      135    15123    1        DCL 1 TYPE_DESC ALIGNED,
      136    15124                  %TYPE_DESC ;
      137    15158
      138    15159    1        DCL ID1$             PTR;
      139    15160    1        DCL ID2$             PTR;
      140    15161    1        DCL ID3$             PTR;
      141    15162    1        DCL ID4$             PTR;
      142    15163    1        DCL ID3_ST$          PTR;
      143    15164
      144    15165    1        DCL LENGTH_ID1$      PTR;
      145    15166    1        DCL LENGTH_ID2$      PTR;
      146    15167    1        DCL LENGTH_ID3$      PTR;
      147    15168
      148    15169    1        DCL DELIMITER$       PTR;
      149    15170    1        DCL IDENTS_TAIL$     PTR;
      150    15171    1        DCL STRINGS_TAIL$    PTR;
      151    15172    1        DCL OVERFLOW$        PTR;
      152    15173    1        DCL NO_OVERFLOW$     PTR ;
      153    15174    1        DCL END_STRING$     PTR;
      154    15175    1        DCL INTO_LENGTH$    PTR;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:6    
      155    15176    1        DCL COMPARISON$     PTR;
      156    15177    1        DCL KANJI_LX_ETT$   PTR;
      157    15178    1        DCL POINTER_TIMES2$ PTR;
      158    15179    1        DCL PLUS_ONE$       PTR;
      159    15180    1        DCL ONE$            PTR;
      160    15181    1        DCL TWO$            PTR;
      161    15182    1        DCL ADD$            PTR;
      162    15183    1        DCL LENGTH_ID3_P1$  PTR;
      163    15184    1        DCL MINIMUM$        PTR;
      164    15185    1        DCL RECEIVING$      PTR;
      165    15186    1        DCL INDEX$          PTR;
      166    15187    1        DCL INDEX_EXPR$     PTR ;
      167    15188    1        DCL REMAINDER$      PTR;
      168    15189    1        DCL TABLE_ETT$      PTR;
      169    15190
      170    15191
      171    15192    1        DCL POINTER         BOOLEAN;
      172    15193    1        DCL OVERFLOW        BOOLEAN;
      173    15194    1        DCL SIZE            BOOLEAN;
      174    15195    1        DCL OPTIMIZABLE     BOOLEAN ;
      175    15196
      176    15197    1        DCL CURRENT_OFFSET  SBIN WORD ;
      177    15198    1        DCL ID3_LENGTH      SBIN WORD ;
      178    15199    1        DCL ID1_COUNT       SBIN WORD ;
      179    15200    1        DCL ID1_MAX         SBIN WORD ;
      180    15201    1        DCL OP              SBIN WORD ;
      181    15202
      182    15203        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:7    
      183    15204        %MACRO IF_THEN_DO (@LOP =, @REL =, @ROP =, @LAB =) ;
      184    15205
      185    15206               DO ;
      186    15207                 %LSET LINE@ = CHARTEXT (CONCAT (TEXTCHAR (@LOP),
      187    15208                                                 ' -> LX_ETT_ITEM.LINE')) ;
      188    15209                 %LSET COLUMN@ = CHARTEXT (CONCAT (TEXTCHAR (@LOP),
      189    15210                                                 ' -> LX_ETT_ITEM.COLUMN')) ;
      190    15211
      191    15212                 COMPARISON$ = ADDR (COMPARISON) ;
      192    15213                 %INIT_BINARY_OP (@POINTER = COMPARISON$,
      193    15214                                  @LOP$    = @LOP,
      194    15215                                  @OP      = @REL,
      195    15216                                  @ROP$    = @ROP,
      196    15217                                  @LINE    = %LINE@,
      197    15218                                  @COLUMN  = %COLUMN@) ;
      198    15219
      199    15220                 CALL Z8AT$CREATE_TEMPORARY (%PARA, @LAB) ;
      200    15221                 CALL Z8EK$BRANCH_FALSE (@LAB, COMPARISON$) ;
      201    15222               END ;
      202    15223
      203    15224        %MEND ;
      204    15225
      205    15226        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:8    
      206    15227    1        ID1$ = ADDR(ID1);
      207    15228    1        ID2$ = ADDR(ID2);
      208    15229    1        ID3$ = ADDR(ID3);
      209    15230    1        ID4$ = ADDR(ID4);
      210    15231
      211    15232    1        LENGTH_ID1$ = ADDR(LENGTH_ID1);
      212    15233    1        LENGTH_ID2$ = ADDR(LENGTH_ID2);
      213    15234    1        LENGTH_ID3$ = ADDR(LENGTH_ID3);
      214    15235
      215    15236    1        RECEIVING$ = ADDR(RECEIVING);
      216    15237
      217    15238    1        ONE$       = ADDR(ONE);
      218    15239    1        TWO$       = ADDR(TWO);
      219    15240    1        REMAINDER$ = ADDR(REMAINDER);
      220    15241    1        LENGTH_ID3_P1$       = ADDR(LENGTH_ID3_P1);
      221    15242    1        MINIMUM$   = ADDR(MINIMUM_);
      222    15243    1        INDEX$     = ADDR(INDX);
      223    15244    1        ADD$       = ADDR(ADD);
      224    15245    1        KANJI_LX_ETT$ = ADDR(KANJI_LX_ETT);
      225    15246    1        POINTER_TIMES2$ = ADDR(POINTER_TIMES2);
      226    15247    1        PLUS_ONE$ = ADDR(PLUS_ONE);
      227    15248
      228    15249        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:9    
      229    15250        /*V* PASS 2 --- Validate the operands of the STRING statement */
      230    15251
      231    15252    1        IF COMCOM.OB.FIPS.LEVEL >= %INT_LEV THEN
      232    15253    1          CALL Z8AE$ERROR (%E$LEVEL_CHECK,
      233    15254    1                           O1COM.LINE_NO,
      234    15255    1                           O1COM.COLUMN_NO);
      235    15256    1        OPTIMIZABLE = TRUE ;
      236    15257    1        STRINGS$ = STRING_LIST$ -> LX_LIST.HEAD$;
      237    15258    1        ID1_MAX = 0 ; /* Count of number of id1's */
      238    15259
      239    15260    2        DO UNTIL(STRINGS$ = ADDR(NIL));
      240    15261    2          IDENTS$ = STRINGS$ -> LX_LIST.HEAD$ -> LX_LIST.HEAD$;
      241    15262
      242    15263    2          CALL VALIDATE_ID2(STRINGS$ -> LX_LIST.TAIL$) ALTRET(BAD_STRING);
      243    15264
      244    15265    3          DO UNTIL(IDENTS$ = ADDR(NIL));
      245    15266    3            ID1_MAX = ID1_MAX + 1 ;
      246    15267    3            CALL VALIDATE_ID1(IDENTS$) ALTRET(BAD_STRING);
      247    15268
      248    15269    3            IDENTS$ = IDENTS$ -> LX_LIST.LINK;
      249    15270    3          END /* Case */;
      250    15271
      251    15272    2        STRINGS$ = STRINGS$ -> LX_LIST.LINK;
      252    15273    2        END /* Case */;
      253    15274
      254    15275    1        CALL VALIDATE_ID3(INTO$) ALTRET(BAD_STRING);
      255    15276    1        CALL VALIDATE_ID4(POINTER$, INTO$) ALTRET(BAD_STRING);
      256    15277
      257    15278    1        IF ON_OVERFLOW$ ~= ADDR(NIL)   OR
      258    15279    1              NOT_ON_OVERFLOW$ ~= ADDR(NIL)     THEN
      259    15280    1          OVERFLOW = %TRUE;
      260    15281    1        IF OVERFLOW THEN OPTIMIZABLE = FALSE ;
      261    15282
      262    15283        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:10   
      263    15284        /*V* PASS 3a -- Generate the ILL to do the STRING (optimizable).
      264    15285
      265    15286           STRING id1a, id1b, ... INTO id3.
      266    15287
      267    15288                       MVAN                   MVAN      . . .
      268    15289                      /    \                 /    \
      269    15290                   FISS    id1a            FISS   id1b
      270    15291                  /    \                  /    \
      271    15292               id3  length-id1a         OFF     length-id1b
      272    15293                                       /   \
      273    15294                                     id3  length-id1a
      274    15295        */
      275    15296
      276    15297    2        IF OPTIMIZABLE THEN DO ;
      277    15298
      278    15299    2          CURRENT_OFFSET = 0 ;
      279    15300    2          CALL PREPARE_ID3 (INTO$, ID3$) ;
      280    15301    2          ID3_LENGTH = LENGTH_ID3$
      281    15302    2                    -> LX_ETT_ITEM.ETT$
      282    15303    2                    -> ETT.LOP
      283    15304    2                    -> CONST.CONSTI.WORD1 ;
      284    15305
      285    15306    2          STRINGS$ = STRING_LIST$ -> LX_LIST.HEAD$ ;
      286    15307
      287    15308    3          DO UNTIL (STRINGS$ = ADDR(NIL)) ;
      288    15309
      289    15310    3            IDENTS$ = STRINGS$ -> LX_LIST.HEAD$ -> LX_LIST.HEAD$ ;
      290    15311
      291    15312    4            DO UNTIL (IDENTS$ = ADDR(NIL)) ;
      292    15313
      293    15314    4              CALL PREPARE_ID1 (IDENTS$, ID1$) ;
      294    15315
      295    15316    4              IF CURRENT_OFFSET < ID3_LENGTH THEN
      296    15317    4                CALL MOVE (ID3$, ID1$, LENGTH_ID1$
      297    15318    4                                    -> LX_ETT_ITEM.ETT$
      298    15319    4                                    -> ETT.LOP
      299    15320    4                                    -> CONST.CONSTI,
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:11   
      300    15321    4                           CURRENT_OFFSET) ;
      301    15322
      302    15323    4              IDENTS$ = IDENTS$ -> LX_ITEM.LINK ;
      303    15324
      304    15325    4            END ; /* Until Ident$ = Nil */
      305    15326
      306    15327    3            STRINGS$ = STRINGS$ -> LX_LIST.LINK ;
      307    15328
      308    15329    3          END ; /* Until String$ = Nil */
      309    15330
      310    15331    2        END ; /* Optimizable */
      311    15332
      312    15333    2       ELSE DO ;
      313    15334
      314    15335        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:12   
      315    15336        /*V* PASS 3b -- Generate the ILL to do the STRING (non-optimizable) */
      316    15337
      317    15338    2          CALL Z8AC$LX_ETT_ITEM_TYI_CONST(1, ONE$);
      318    15339    2          CALL Z8AC$LX_ETT_ITEM_TYI_CONST(2, TWO$);
      319    15340
      320    15341    2          CALL Z8AT$CREATE_TEMPORARY(%PARA, OVERFLOW$);
      321    15342    2          CALL Z8AT$CREATE_TEMPORARY(%PARA, END_STRING$);
      322    15343
      323    15344    2          CALL PREPARE_ID3(INTO$, ID3$);
      324    15345    2          CALL PREPARE_ID4(POINTER$, INTO$, ID4$);
      325    15346
      326    15347    2          ID1_COUNT = 0 ;
      327    15348    2          STRINGS$ = STRING_LIST$ -> LX_LIST.HEAD$;
      328    15349
      329    15350               %FISH( TRIAD = ID3$ -> LX_ETT_ITEM.ETT$,
      330    15351                      RTN   = ID3_ST$ );
      331    15359
      332    15360    3          DO UNTIL(STRINGS$ = ADDR(NIL));
      333    15361    3            IDENTS$    = STRINGS$ -> LX_LIST.HEAD$ -> LX_LIST.HEAD$;
      334    15362
      335    15363    3            CALL PREPARE_ID2(STRINGS$ -> LX_LIST.TAIL$, ID2$);
      336    15364
      337    15365    4            DO UNTIL(IDENTS$ = ADDR(NIL));
      338    15366    4              ID1_COUNT = ID1_COUNT + 1 ;
      339    15367
      340    15368    4              IF ID3_ST$ -> SCALAR.B.KANJI    THEN
      341    15369    5                DO;
      342    15370
      343    15371                     /*  For Kanji, multiply pointer by 2 and subtract
      344    15372                         one.  Subtract is because offset in COBOL start
      345    15373                         at one and in PL6 at 0 */
      346    15374
      347    15375                       %INIT_BINARY_OP( @POINTER = POINTER_TIMES2$,
      348    15376                                        @OP   = %OP_STAR,
      349    15377                                        @LOP$ = ID4$,
      350    15378                                        @ROP$ = TWO$ );
      351    15396
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:13   
      352    15397                       %INIT_BINARY_OP( @POINTER = PLUS_ONE$,
      353    15398                                        @OP   = %OP_BINARY_MINUS,
      354    15399                                        @LOP$ = POINTER_TIMES2$,
      355    15400                                        @ROP$ = ONE$ );
      356    15418
      357    15419    5                  CALL Z8E5$MATH_PACK( PLUS_ONE$,
      358    15420    5                                       PLUS_ONE$ );
      359    15421
      360    15422    5                  CALL Z8E7$MOVE( ID4$,
      361    15423    5                                  PLUS_ONE$ );
      362    15424    5                END;
      363    15425
      364    15426
      365    15427    5              IF POINTER OR ID1_COUNT > 1 THEN DO ;
      366    15428    5                CALL Z8EK$COMPARE( ID4$ ,
      367    15429    5                                   %OP_GREATER_THAN ,
      368    15430    5                                   LENGTH_ID3$ ,
      369    15431    5                                   COMPARISON$);
      370    15432
      371    15433    5                CALL Z8EK$BRANCH_TRUE(OVERFLOW$, COMPARISON$);
      372    15434
      373    15435    5                CALL Z8ED$DISPOSE_ABSSYN_TREE(COMPARISON$);
      374    15436    5              END ; /* Pointer clause or this is not the 1st id1 */
      375    15437
      376    15438    4              CALL PREPARE_ID1(IDENTS$, ID1$);
      377    15439
      378    15440                   %INIT_BINARY_OP( @POINTER     = LENGTH_ID3_P1$ ,
      379    15441                                    @OP          = %OP_PLUS,
      380    15442                                    @LOP$        = LENGTH_ID3$ ,
      381    15443                                    @ROP$        = ONE$) ;
      382    15461
      383    15462                   %INIT_BINARY_OP( @POINTER     = REMAINDER$ ,
      384    15463                                    @OP          = %OP_BINARY_MINUS,
      385    15464                                    @LOP$        = LENGTH_ID3_P1$ ,
      386    15465                                    @ROP$        = ID4$ );
      387    15483
      388    15484    4              IF SIZE THEN
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:14   
      389    15485    5                DO;
      390    15486    5                  INDEX$ = LENGTH_ID1$ ; /* Index (id1, SIZE) */
      391    15487
      392    15488                       %INIT_BINARY_OP( @POINTER    = MINIMUM$ ,
      393    15489                                        @OP         = %OP_MINIMUM ,
      394    15490                                        @LOP$       = REMAINDER$ ,
      395    15491                                        @ROP$       = LENGTH_ID1$ );
      396    15509
      397    15510    5                  CALL Z8E5$MATH_PACK(MINIMUM$, MINIMUM$);
      398    15511
      399    15512    5                  IF POINTER OR ID1_COUNT ~= 1 THEN
      400    15513    5                    CALL Z8EY$INSERT(ID3$, ID4$, MINIMUM$, RECEIVING$);
      401    15514    5                  ELSE
      402    15515    5                    CALL Z8EY$INSERT (ID3$, ONE$, MINIMUM$, RECEIVING$) ;
      403    15516
      404    15517    5                  CALL Z8E7$MOVE(RECEIVING$, ID1$);
      405    15518    5                END;
      406    15519    4              ELSE
      407    15520    5                DO;
      408    15521    5                  INDEX_EXPR$ = ADDR (INDEX_EXPR) ;
      409    15522                       %INIT_LX_ETT_ITEM (@POINTER = INDEX$, @TYPE = %TYI) ;
      410    15544    5                  CALL Z8AT$CREATE_TEMP_WITH_BASE (%SCALAR,
      411    15545    5                                          INDEX$ -> LX_ETT_ITEM.ETT$) ;
      412    15546
      413    15547    5                  IF ID3_ST$ -> SCALAR.B.KANJI  THEN
      414    15548    5                    CALL KANJI_INDEX( INDEX$ );
      415    15549    5                  ELSE
      416    15550    6                    DO;
      417    15551                           %INIT_BINARY_OP( @POINTER    = INDEX_EXPR$ ,
      418    15552                                            @OP         = %OP_INDEX ,
      419    15553                                            @LOP$       = ID2$ ,
      420    15554                                            @ROP$       = ID1$ );
      421    15572
      422    15573    6                      CALL Z8E5$MATH_PACK (INDEX_EXPR$, INDEX_EXPR$) ;
      423    15574    6                      CALL Z8E7$MOVE (INDEX$, INDEX_EXPR$) ;
      424    15575    6                    END;
      425    15576
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:15   
      426    15577                       %INIT_BINARY_OP( @POINTER    = MINIMUM$ ,
      427    15578                                        @OP         = %OP_MINIMUM ,
      428    15579                                        @LOP$       = REMAINDER$ ,
      429    15580                                        @ROP$       = INDEX$ );
      430    15598
      431    15599    5                  CALL Z8E5$MATH_PACK(MINIMUM$, MINIMUM$);
      432    15600
      433    15601    5                  CALL Z8EY$INSERT(ID3$, ID4$, MINIMUM$, RECEIVING$);
      434    15602
      435    15603    5                  CALL Z8E7$MOVE(RECEIVING$, ID1$);
      436    15604    5                END;
      437    15605
      438    15606                   /* IF Remainder >= Index(id1,id2) THEN GO TO No_Overflow */
      439    15607
      440    15608    4              CALL Z8EK$COMPARE (REMAINDER$,
      441    15609    4                                 %OP_GREATER_THAN_OR_EQUAL,
      442    15610    4                                 INDEX$,
      443    15611    4                                 COMPARISON$) ;
      444    15612
      445    15613    4              CALL Z8AT$CREATE_TEMPORARY (%PARA, NO_OVERFLOW$) ;
      446    15614    4              CALL Z8EK$BRANCH_TRUE (NO_OVERFLOW$, COMPARISON$) ;
      447    15615    4              CALL Z8ED$DISPOSE_ABSSYN_TREE (COMPARISON$) ;
      448    15616
      449    15617    5              IF POINTER THEN DO ;
      450    15618
      451    15619                     /* MOVE Length(id3)+1 TO id4 */
      452    15620
      453    15621    5                IF ID3_ST$ -> SCALAR.B.KANJI   THEN
      454    15622    6                  DO;
      455    15623
      456    15624                         %INIT_BINARY_OP( @POINTER = PLUS_ONE$,
      457    15625                                          @OP   = %OP_PLUS,
      458    15626                                          @LOP$ = LENGTH_ID3_P1$,
      459    15627                                          @ROP$ = ONE$ );
      460    15645
      461    15646                         %INIT_BINARY_OP( @POINTER = KANJI_LX_ETT$,
      462    15647                                          @OP   = %OP_SLASH,
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:16   
      463    15648                                          @LOP$ = PLUS_ONE$,
      464    15649                                          @ROP$ = TWO$ );
      465    15667
      466    15668    6                    CALL Z8E5$MATH_PACK( KANJI_LX_ETT$,
      467    15669    6                                         KANJI_LX_ETT$ );
      468    15670
      469    15671    6                    CALL Z8E7$MOVE( ID4$,
      470    15672    6                                    KANJI_LX_ETT$ );
      471    15673    6                  END;
      472    15674    5                ELSE
      473    15675    6                  DO;
      474    15676    6                    CALL Z8E5$MATH_PACK( LENGTH_ID3_P1$,
      475    15677    6                                         LENGTH_ID3_P1$ );
      476    15678    6                    CALL Z8E7$MOVE( ID4$,
      477    15679    6                                    LENGTH_ID3_P1$ );
      478    15680    6                  END;
      479    15681
      480    15682    5              END ; /* POINTER clause used */
      481    15683
      482    15684                   /* GO TO Overflow */
      483    15685
      484    15686    4              CALL Z8EK$BRANCH (OVERFLOW$) ;
      485    15687
      486    15688                   %NEW_ILL (@ID = %DEFLB, @LOP = NO_OVERFLOW$) ;
      487    16067
      488    16068    5              IF POINTER OR ID1_COUNT ~= ID1_MAX THEN DO ;
      489    16069
      490    16070                     /* ADD Index(id1,id2) TO id4 */
      491    16071
      492    16072                     %INIT_BINARY_OP (@POINTER = ADD$,
      493    16073                                      @OP      = %OP_PLUS,
      494    16074                                      @LOP$    = ID4$,
      495    16075                                      @ROP$    = INDEX$) ;
      496    16093
      497    16094    5                IF ID3_ST$ -> SCALAR.B.KANJI   THEN
      498    16095    6                  DO;
      499    16096
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:17   
      500    16097                         %INIT_BINARY_OP( @POINTER = PLUS_ONE$,
      501    16098                                          @OP   = %OP_PLUS,
      502    16099                                          @LOP$ = ADD$,
      503    16100                                          @ROP$ = ONE$ );
      504    16118
      505    16119                         %INIT_BINARY_OP( @POINTER = KANJI_LX_ETT$,
      506    16120                                          @OP   = %OP_SLASH,
      507    16121                                          @LOP$ = PLUS_ONE$,
      508    16122                                          @ROP$ = TWO$ );
      509    16140
      510    16141    6                    CALL Z8E5$MATH_PACK( KANJI_LX_ETT$,
      511    16142    6                                         KANJI_LX_ETT$ );
      512    16143    6                    CALL Z8E7$MOVE( ID4$,
      513    16144    6                                    KANJI_LX_ETT$ );
      514    16145    6                  END;
      515    16146    5                ELSE
      516    16147    6                  DO;
      517    16148    6                    CALL Z8E5$MATH_PACK( ADD$, ADD$ );
      518    16149    6                    CALL Z8E7$MOVE( ID4$, ADD$ );
      519    16150    6                  END;
      520    16151
      521    16152    5              END ; /* POINTER clause or this is not the last ID1 */
      522    16153
      523    16154
      524    16155
      525    16156
      526    16157    4              IDENTS$ = IDENTS$ -> LX_ITEM.LINK;
      527    16158    4            END /* Until */;
      528    16159
      529    16160    3            STRINGS$ = STRINGS$ -> LX_LIST.LINK;
      530    16161    3          END /* Until */;
      531    16162
      532    16163               /*  Add NOT OVERFLOW if needed  */
      533    16164
      534    16165    2          IF NOT_ON_OVERFLOW$ ~= ADDR(NIL)    THEN
      535    16166    3            DO;
      536    16167                   %APPEND_ILS_LIST( @FROM$ = NOT_ON_OVERFLOW$,
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:18   
      537    16168                                     @TO$ = "ADDR(O1COM.ILS_LIST)" );
      538    16185    3            END;
      539    16186
      540    16187               /* GO TO END_STRING */
      541    16188
      542    16189    2          IF ON_OVERFLOW$ ~= ADDR(NIL)    THEN
      543    16190    2            CALL Z8EK$BRANCH (END_STRING$) ;
      544    16191
      545    16192               %NEW_ILL( @ID        = %DEFLB ,
      546    16193                         @LOP       = OVERFLOW$ );
      547    16572
      548    16573    2          IF ON_OVERFLOW$ ~= ADDR(NIL)   THEN
      549    16574    3            DO;
      550    16575                   %APPEND_ILS_LIST( @FROM$ = ON_OVERFLOW$,
      551    16576                                     @TO$   = "ADDR(O1COM.ILS_LIST)");
      552    16593
      553    16594                   %NEW_ILL( @ID     = %DEFLB ,
      554    16595                             @LOP    = END_STRING$ );
      555    16974    3            END;
      556    16975
      557    16976    2        END ; /* Not Optimizable */
      558    16977
      559    16978    1   BAD_STRING:;
      560    16979
      561    16980        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:19   
      562    16981
      563    16982        /*I*   NAME: MOVE
      564    16983
      565    16984        DESCRIPTION: Move id1$ to Substring (id3$, offset, length).
      566    16985
      567    16986        */
      568    16987
      569    16988    1   MOVE: PROC (ID3$, ID1$, LENGTH, OFFSET) ;
      570    16989
      571    16990    2        DCL  ID3$               PTR ;
      572    16991    2        DCL  ID1$               PTR ;
      573    16992    2        DCL  OFFSET             SBIN WORD ;
      574    16993    2        DCL  LENGTH             SBIN WORD ;
      575    16994    2        DCL  RESULT$            PTR ;
      576    16995    2        DCL  ORIGINAL_ID3_ETT$  PTR ;
      577    16996    2        DCL  FISS_LENGTH        SBIN WORD ;
      578    16997
      579    16998    2        ORIGINAL_ID3_ETT$ = ID3$ -> LX_ETT_ITEM.ETT$ ;
      580    16999
      581    17000    3        IF OFFSET ~= 0 THEN DO ;
      582    17001
      583    17002    3          CALL Z8AF$NEW_OFF (ID3$ -> LX_ETT_ITEM.ETT$,
      584    17003    3                             OFFSET,
      585    17004    3                             RESULT$) ;
      586    17005    3          ID3$ -> LX_ETT_ITEM.ETT$ = RESULT$ ;
      587    17006
      588    17007    3        END ; /* Offset <> 0 */
      589    17008
      590    17009
      591    17010    2        IF ID3_LENGTH - OFFSET < LENGTH
      592    17011    2        THEN FISS_LENGTH = ID3_LENGTH - OFFSET ;
      593    17012    2        ELSE FISS_LENGTH = LENGTH ;
      594    17013    2        CALL Z8AF$NEW_FISS (ID3$ -> LX_ETT_ITEM.ETT$,
      595    17014    2                            FISS_LENGTH,
      596    17015    2                            %ALPHA_NUMERIC_FISS,
      597    17016    2                            RESULT$) ;
      598    17017    2        ID3$ -> LX_ETT_ITEM.ETT$ = RESULT$ ;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:20   
      599    17018
      600    17019    2        CALL Z8E7$MOVE (ID3$, ID1$) ;
      601    17020
      602    17021    2        ID3$ -> LX_ETT_ITEM.ETT$ = ORIGINAL_ID3_ETT$ ;
      603    17022    2        OFFSET = OFFSET + LENGTH ; /* ready for next call to MOVE */
      604    17023
      605    17024    2   END MOVE ;
      606    17025
      607    17026        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:21   
      608    17027        /*I*   NAME: VALIDATE_IDn, n = 1 -> 4
      609    17028
      610    17029        DESCRIPTION: These routines are used by Pass 2 of Z8EZ$STRING.
      611    17030                     They validate the semantics of each identifier.
      612    17031
      613    17032        */
      614    17033
      615    17034        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:22   
      616    17035    1   VALIDATE_ID1: PROC (ID1$) ALTRET;
      617    17036
      618    17037    2        DCL ID1$    PTR;
      619    17038
      620    17039    2        IF ID1$ -> LX_ITEM.ID = %LX_ETT_ITEM THEN        /*#31090*/
      621    17040    2          IF ID1$ -> LX_ETT_ITEM.TYPE ~= %TYA
      622    17041    2          AND ID1$ -> LX_ETT_ITEM.TYPE ~= %TYN
      623    17042    2          THEN OPTIMIZABLE = FALSE ;
      624    17043
      625    17044    2        CALL Z8CO$DISPL_CHECK(ID1$) ALTRET(BAD);
      626    17045
      627    17046    3        IF ID1$ -> LX_ITEM.ID = %LX_ETT_ITEM THEN DO ;
      628    17047    4          DO CASE(ID1$ -> LX_ETT_ITEM.TYPE);
      629    17048    4            CASE(%TYD, %TYO, %TYF, %TYC);
      630    17049    4              CALL INTEGER_CHECK(ID1$);
      631    17050    4              CALL Z8CO$P_CHECK(ID1$) ALTRET(BAD);
      632    17051    4          END /* Case */;
      633    17052
      634    17053    3          CALL Z8AU$TYPE_DESCRIPTOR (ID1$ -> LX_ETT_ITEM.ETT$,
      635    17054    3                                     TYPE_DESC) ;
      636    17055    3          IF TYPE_DESC.SIZ$ ~= ADDR(NIL)
      637    17056    3          THEN OPTIMIZABLE = FALSE ;
      638    17057    3        END ;
      639    17058
      640    17059    2        RETURN;
      641    17060
      642    17061    2   BAD:
      643    17062    2        ALTRETURN;
      644    17063
      645    17064    2   END VALIDATE_ID1;
      646    17065        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:23   
      647    17066    1   VALIDATE_ID2: PROC (ID2$) ALTRET;
      648    17067
      649    17068    2        DCL ID2$    PTR;
      650    17069
      651    17070
      652    17071    2        SIZE = FALSE;
      653    17072
      654    17073    2        IF ID2$ -> LX_ITEM.ID = %LX_TERMINAL THEN
      655    17074    2          IF ID2$ -> LX_TERMINAL.SYMBOL = %RSV_WRD_SIZE THEN
      656    17075    2            SIZE = TRUE;
      657    17076
      658    17077    2        IF NOT SIZE THEN
      659    17078    3          DO;
      660    17079    3            OPTIMIZABLE = FALSE ;
      661    17080    3            CALL Z8CO$DISPL_CHECK(ID2$) ALTRET(BAD);
      662    17081
      663    17082    3            IF ID2$ -> LX_ITEM.ID = %LX_ETT_ITEM THEN
      664    17083    4              DO CASE(ID2$ -> LX_ETT_ITEM.TYPE);
      665    17084    4                CASE(%TYD, %TYO, %TYF, %TYC);
      666    17085    4                  CALL INTEGER_CHECK(ID2$);
      667    17086    4                  CALL Z8CO$P_CHECK(ID2$) ALTRET(BAD);
      668    17087    4              END /* Case */;
      669    17088    3          END;
      670    17089
      671    17090    2        RETURN;
      672    17091
      673    17092    2   BAD:
      674    17093    2        ALTRETURN;
      675    17094
      676    17095
      677    17096    2   END VALIDATE_ID2;
      678    17097        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:24   
      679    17098    1   VALIDATE_ID3: PROC (ID3$) ALTRET;
      680    17099
      681    17100    2        DCL ID3$                PTR;
      682    17101    2        DCL ST$$                PTR;
      683    17102
      684    17103    2        IF ID3$ -> LX_ETT_ITEM.TYPE ~= %TYA
      685    17104    2        AND ID3$ -> LX_ETT_ITEM.TYPE ~= %TYN
      686    17105    2        THEN OPTIMIZABLE = FALSE ;
      687    17106
      688    17107    2        CALL Z8CO$DISPL_CHECK (ID3$) ALTRET (BAD) ;
      689    17108
      690    17109             %FISH(TRIAD = ID3$ -> LX_ETT_ITEM.ETT$, RTN = ST$$);
      691    17117
      692    17118    2        IF ST$$ -> VARIABLE.B.SUB_CLASS.EDITED THEN
      693    17119    3          DO;
      694    17120    3            CALL Z8AE$ERROR(%E$EDITED_INVALID,
      695    17121    3                            ID3$ -> LX_ETT_ITEM.LINE ,
      696    17122    3                            ID3$ -> LX_ETT_ITEM.COLUMN );
      697    17123    3            GOTO BAD ;
      698    17124    3          END;
      699    17125
      700    17126    2        IF ST$$ -> VARIABLE.B.JUSTIFIED THEN
      701    17127    3          DO;
      702    17128    3            CALL Z8AE$ERROR(%E$JUSTIFIED_INVALID,
      703    17129    3                            ID3$ -> LX_ETT_ITEM.LINE ,
      704    17130    3                            ID3$ -> LX_ETT_ITEM.COLUMN );
      705    17131    3            GOTO BAD ;
      706    17132    3          END;
      707    17133
      708    17134    2        CALL Z8AU$TYPE_DESCRIPTOR (ID3$ -> LX_ETT_ITEM.ETT$,
      709    17135    2                                   TYPE_DESC) ;
      710    17136    2        IF TYPE_DESC.SIZ$ ~= ADDR(NIL)
      711    17137    2        THEN OPTIMIZABLE = FALSE ;
      712    17138
      713    17139    2        RETURN;
      714    17140
      715    17141    2   BAD:
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:25   
      716    17142    2        ALTRETURN ;
      717    17143
      718    17144    2   END VALIDATE_ID3;
      719    17145        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:26   
      720    17146    1   VALIDATE_ID4: PROC (ID4$, ID3$) ALTRET;
      721    17147
      722    17148    2        DCL ID4$    PTR;
      723    17149    2        DCL ID3$    PTR;
      724    17150
      725    17151    2        DCL ETT$$   PTR;
      726    17152    2        DCL ID4_MAX SBIN WORD;
      727    17153    2        DCL ID3_LEN SBIN WORD;
      728    17154
      729    17155    2        POINTER =   ID4$ -> LX_ITEM.ID ~= %LX_TERMINAL;
      730    17156
      731    17157    2        IF POINTER THEN
      732    17158    3          DO;
      733    17159    3            OPTIMIZABLE = FALSE ;
      734    17160    3            CALL Z8CO$INTEGER_CHECK(ID4$) ALTRET(BAD);
      735    17161    3            CALL Z8CO$P_CHECK(ID4$) ALTRET(BAD);
      736    17162
      737    17163    3            CALL Z8EZ$MAX_VALUE(ID4$, ID4_MAX);
      738    17164    3            CALL Z8AU$LENGTH_ETT(ID3$ -> LX_ETT_ITEM.ETT$, ETT$$);
      739    17165
      740    17166    4            IF ETT$$ -> ETT.ID = %TRIAD THEN DO ; /* Size is constant */
      741    17167
      742    17168    4              ID3_LEN = ETT$$ -> ETT.LOP -> CONST.CONSTI.WORD1 ;
      743    17169
      744    17170    5              IF ID4_MAX < (1 + ID3_LEN) THEN DO ;
      745    17171    5                CALL Z8AE$ERROR(%E$INSUFFICIENT_SIGNIFICANCE,
      746    17172    5                                ID4$ -> LX_ETT_ITEM.LINE,
      747    17173    5                                ID4$ -> LX_ETT_ITEM.COLUMN) ;
      748    17174    5                ALTRETURN ;
      749    17175    5              END ; /* ID4 max value < ID3 Length + 1 */
      750    17176    4            END ; /* ID3 has a constant length */
      751    17177    3          END ; /* POINTER clause exists */
      752    17178
      753    17179    2        RETURN;
      754    17180
      755    17181    2   BAD:
      756    17182    2        ALTRETURN;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:27   
      757    17183
      758    17184    2   END VALIDATE_ID4;
      759    17185        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:28   
      760    17186        /*I*   NAME: INTEGER_CHECK
      761    17187
      762    17188        DESCRIPTION: This routine issues a warning message if the identifier
      763    17189                     is not an integer variable.
      764    17190
      765    17191        */
      766    17192    1   INTEGER_CHECK:PROC(ID$);
      767    17193
      768    17194    2        DCL ID$ PTR;
      769    17195
      770    17196    2        CALL Z8CO$INTEGER_CHECK_NO_ERROR (ID$)
      771    17197    3          WHENALTRETURN DO;
      772    17198                 %CONDITIONAL_ERROR (@LX_ITEM$ = ID$,
      773    17199                                     @ERROR#   = %E$SHOULD_BE_INTEGER,
      774    17200                                     @LINE     = ID$ -> LX_ETT_ITEM.LINE,
      775    17201                                     @COLUMN   = ID$ -> LX_ETT_ITEM.COLUMN);
      776    17231    3          END;
      777    17232
      778    17233    2   END INTEGER_CHECK;
      779    17234        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:29   
      780    17235        /*I*   NAME: PREPARE_IDn, n = 1 -> 4
      781    17236
      782    17237        DESCRIPTION: These routines are used by Pass 3 of Z8EZ$STRING.
      783    17238                     They prepare each operand for use by the general
      784    17239                     STRING algorithm.  This includes conversions from
      785    17240                     one type to another, setting the type for a constant,
      786    17241                     and finding the length of an operand.
      787    17242
      788    17243        */
      789    17244
      790    17245        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:30   
      791    17246    1   PREPARE_ID1:PROC(ID1$, RETURN$);
      792    17247
      793    17248    2        DCL ID1$          PTR;
      794    17249    2        DCL RETURN$       PTR;
      795    17250
      796    17251
      797    17252    2        IF ID1$ -> LX_ITEM.ID = %LX_TERMINAL THEN
      798    17253    3          DO ;
      799    17254    3            CALL Z8EV$CONVERT_TYA (ID1$, RETURN$, ID3$) ;
      800    17255    3            RETURN$ -> LX_ETT_ITEM.B.ALL = FALSE ; /* Move only one character */
      801    17256    3          END ;
      802    17257    2        ELSE
      803    17258    2          RETURN$ -> LX_ETT_ITEM = ID1$ -> LX_ETT_ITEM ;
      804    17259
      805    17260    3        DO CASE (RETURN$ -> LX_ETT_ITEM.TYPE) ;
      806    17261
      807    17262    3          CASE (%TYO, %TYD) ;
      808    17263
      809    17264    3            CALL Z8AF$FORME (%DNA, RETURN$ -> LX_ETT_ITEM.ETT$,
      810    17265    3                                0, RETURN$ -> LX_ETT_ITEM.ETT$) ;
      811    17266    3            RETURN$ -> LX_ETT_ITEM.TYPE = %TYA ;
      812    17267
      813    17268    3          CASE (%TYE, %TYF, %TYB, %TYC) ;
      814    17269
      815    17270    3            IF RETURN$ -> LX_ETT_ITEM.TYPE = %TYE OR
      816    17271    3                RETURN$ -> LX_ETT_ITEM.TYPE = %TYF
      817    17272    3              THEN OP = %OP_EBCDIC_TO_ASCII ;
      818    17273    3              ELSE OP = %OP_GBCD_TO_ASCII ;
      819    17274
      820    17275    3            CALL Z8CO$CREATE_LIBRARY_BASE (OP, TABLE_ETT$) ;
      821    17276
      822    17277    3            CALL Z8AF$FORME (%CVT,
      823    17278    3                             RETURN$ -> LX_ETT_ITEM.ETT$,
      824    17279    3                             TABLE_ETT$,
      825    17280    3                             RETURN$ -> LX_ETT_ITEM.ETT$) ;
      826    17281
      827    17282    3            IF RETURN$ -> LX_ETT_ITEM.TYPE = %TYF OR
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:31   
      828    17283    3                RETURN$ -> LX_ETT_ITEM.TYPE = %TYC THEN
      829    17284    3              CALL Z8AF$FORME (%DNA,
      830    17285    3                               RETURN$ -> LX_ETT_ITEM.ETT$,
      831    17286    3                               0,
      832    17287    3                               RETURN$ -> LX_ETT_ITEM.ETT$) ;
      833    17288
      834    17289    3            RETURN$ -> LX_ETT_ITEM.TYPE = %TYA ;
      835    17290
      836    17291    3          CASE (%TYA, %TYN);
      837    17292
      838    17293    3          CASE (ELSE) ;
      839    17294
      840    17295    3            CALL Z8AE$ERROR (%E$UNEXPECTED_CASE) ;
      841    17296
      842    17297    3        END ; /* Case of RETURN$ type */
      843    17298
      844    17299    2        CALL Z8AU$LENGTH(RETURN$ -> LX_ETT_ITEM.ETT$,
      845    17300    2                         LENGTH_ID1$);
      846    17301
      847    17302    2   END PREPARE_ID1;
      848    17303
      849    17304        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:32   
      850    17305    1   PREPARE_ID2:PROC(ID2$, RETURN$);
      851    17306
      852    17307    2        DCL ID2$       PTR;
      853    17308    2        DCL RETURN$    PTR;
      854    17309
      855    17310
      856    17311    2        SIZE = FALSE;
      857    17312
      858    17313    2        IF ID2$ -> LX_ITEM.ID = %LX_TERMINAL THEN
      859    17314    2          IF ID2$ -> LX_TERMINAL.SYMBOL = %RSV_WRD_SIZE THEN
      860    17315    2            SIZE = TRUE;
      861    17316
      862    17317    3        IF NOT SIZE THEN DO ;
      863    17318    3          IF ID2$ -> LX_ITEM.ID = %LX_TERMINAL THEN
      864    17319    3            CALL Z8EV$CONVERT_TYA (ID2$, RETURN$, ID3$) ;
      865    17320    3          ELSE
      866    17321    3            RETURN$ -> LX_ETT_ITEM = ID2$ -> LX_ETT_ITEM;
      867    17322    3          CALL Z8AU$LENGTH (RETURN$ ->LX_ETT_ITEM.ETT$,
      868    17323    3                            LENGTH_ID2$) ;
      869    17324    3        END ; /* Not SIZE */
      870    17325
      871    17326    2   END PREPARE_ID2;
      872    17327        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:33   
      873    17328    1   PREPARE_ID3:PROC(ID3$, RETURN$);
      874    17329
      875    17330    2        DCL ID3$         PTR;
      876    17331    2        DCL RETURN$      PTR;
      877    17332
      878    17333    2        RETURN$ -> LX_ETT_ITEM = ID3$ -> LX_ETT_ITEM;
      879    17334
      880    17335    2        CALL Z8AU$LENGTH(RETURN$ -> LX_ETT_ITEM.ETT$,
      881    17336    2                         LENGTH_ID3$);
      882    17337
      883    17338
      884    17339    2   END PREPARE_ID3;
      885    17340
      886    17341        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:34   
      887    17342
      888    17343    1   PREPARE_ID4:PROC(ID4$, ID3$, RETURN$);
      889    17344
      890    17345    2        DCL ID4$       PTR;
      891    17346    2        DCL ID3$       PTR;
      892    17347    2        DCL RETURN$    PTR;
      893    17348
      894    17349
      895    17350
      896    17351    2        IF NOT POINTER THEN
      897    17352    3          DO;
      898    17353                 %INIT_LX_ETT_ITEM( @POINTER   = RETURN$ ,
      899    17354                                    @TYPE      = %TYI );
      900    17376
      901    17377    3            CALL Z8AT$CREATE_TEMP_WITH_BASE(%SCALAR,
      902    17378    3                                            RETURN$ -> LX_ETT_ITEM.ETT$ );
      903    17379
      904    17380    3            CALL Z8E7$MOVE(RETURN$, ONE$);
      905    17381    3          END;
      906    17382    2        ELSE
      907    17383    2          RETURN$ -> LX_ETT_ITEM = ID4$ -> LX_ETT_ITEM;
      908    17384    2   END PREPARE_ID4;
      909    17385        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:35   
      910    17386        /*===========*/
      911    17387    1     KANJI_INDEX : PROC ( COUNT$ );
      912    17388        /*===========*/
      913    17389
      914    17390    2   DCL BEGAIN_INDEX$       PTR;
      915    17391    2   DCL END_INDEX$          PTR;
      916    17392
      917    17393        %DCL_AUTO_LX_ITEM( @NAME = COUNT );
      918    17397        %DCL_AUTO_LX_ITEM( @NAME = SUB );
      919    17401        %DCL_AUTO_LX_ITEM( @NAME = COMPARISON );
      920    17405        %DCL_AUTO_LX_ITEM( @NAME = LENGTH_ID1 );
      921    17409        %DCL_AUTO_LX_ITEM( @NAME = LENGTH_ID2 );
      922    17413        %DCL_AUTO_LX_ITEM( @NAME = SUB_STR );
      923    17417
      924    17418    2   DCL COUNT$              PTR;
      925    17419    2   DCL COUNT_BASE$         PTR;
      926    17420    2   DCL SUBSTR$             PTR;
      927    17421    2   DCL SUB$                PTR;
      928    17422    2   DCL COMPARISON$         PTR;
      929    17423    2   DCL LENGTH_ID1$         PTR;
      930    17424    2   DCL LENGTH_ID2$         PTR;
      931    17425
      932    17426
      933    17427    2   SUB$ = ADDR( SUB );
      934    17428    2   SUBSTR$ = ADDR( SUB_STR );
      935    17429
      936    17430    2   CALL Z8AT$CREATE_TEMPORARY( %PARA, BEGAIN_INDEX$ );
      937    17431    2   CALL Z8AT$CREATE_TEMPORARY( %PARA, END_INDEX$ );
      938    17432
      939    17433    2   LENGTH_ID2$ = ADDR( LENGTH_ID2 );
      940    17434    2   CALL Z8AU$LENGTH( ID2$ -> LX_ETT_ITEM.ETT$,
      941    17435    2                     LENGTH_ID2$ );
      942    17436    2   LENGTH_ID1$ = ADDR( LENGTH_ID1 );
      943    17437    2   CALL Z8AU$LENGTH( ID1$ -> LX_ETT_ITEM.ETT$,
      944    17438    2                     LENGTH_ID1$ );
      945    17439
      946    17440        %NEW_ILL( @ID  = %MVII,
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:36   
      947    17441                  @LOP = COUNT$ -> LX_ETT_ITEM.ETT$,
      948    17442                  @ROP = COMCOM.VALUE_0 );
      949    17821
      950    17822        %NEW_ILL( @ID  = %DEFLB,
      951    17823                  @LOP = BEGAIN_INDEX$ );
      952    18202
      953    18203        %INIT_BINARY_OP( @POINTER = SUB$,
      954    18204                         @LOP$    = LENGTH_ID1$,
      955    18205                         @ROP$    = TWO$,
      956    18206                         @OP      = %OP_BINARY_MINUS,
      957    18207                         @LINE    = "ID1$ -> LX_ETT_ITEM.LINE",
      958    18208                         @COLUMN  = "ID1$ -> LX_ETT_ITEM.COLUMN" );
      959    18226
      960    18227        %IF_THEN_DO( @LOP = COUNT$,
      961    18228                     @ROP = SUB$,
      962    18229                     @REL = %OP_LESS_THAN_OR_EQUAL,
      963    18230                     @LAB = END_INDEX$ );
      964    18264
      965    18265    2   CALL Z8EA$SUBSTR_ZERO( ID1$,
      966    18266    2                          COUNT$,
      967    18267    2                          LENGTH_ID2$,
      968    18268    2                          SUBSTR$ );
      969    18269    2   COMPARISON$ = ADDR( COMPARISON );
      970    18270
      971    18271        %INIT_BINARY_OP( @POINTER = COMPARISON$,
      972    18272                         @LOP$    = SUBSTR$,
      973    18273                         @OP      = %OP_EQUAL,
      974    18274                         @ROP$    = ID2$,
      975    18275                         @LINE    = "ID2$ -> LX_ETT_ITEM.LINE",
      976    18276                         @COLUMN  = "ID2$ -> LX_ETT_ITEM.COLUMN" );
      977    18294
      978    18295    2   CALL Z8EK$BRANCH_TRUE( END_INDEX$,
      979    18296    2                          COMPARISON$ );
      980    18297
      981    18298        %NEW_ILL( @ID  = %AD2I,
      982    18299                  @LOP = COUNT$ -> LX_ETT_ITEM.ETT$,
      983    18300                  @ROP = TWO$ -> LX_ETT_ITEM.ETT$ );
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:37   
      984    18679
      985    18680    2   CALL Z8EK$BRANCH( BEGAIN_INDEX$ );
      986    18681
      987    18682        %NEW_ILL( @ID = %DEFLB,
      988    18683                  @LOP = END_INDEX$ );
      989    19062
      990    19063
      991    19064    2   END KANJI_INDEX;
      992    19065    1   END Z8EZ$STRING;
      993    19066
      994    19067        %EOD;

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:38   
--  Include file information  --

   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8E_ILS_LIST.:Z8A6TOU  is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LIBRARY.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EZ$STRING.

   Procedure Z8EZ$STRING requires 1772 words for executable code.
   Procedure Z8EZ$STRING requires 286 words of local(AUTO) storage.

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:39   

 Object Unit name= Z8EZ$STRING                                File name= Z8EZ.:Z8A6TOU
 UTS= AUG 09 '97 12:59:58.44 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none    90    132  LEX_SYMBOL
    2  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
    3  LblCom even  none    90    132  TEMP_LEX_SYMBOL
    4  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
    5  LblCom even  none     1      1  ST$
    6  LblCom even  none     5      5  ST_
    7  LblCom even  none     1      1  ETT$
    8  LblCom even  none     1      1  HEAD_ETT$
    9  LblCom even  none   512   1000  ETT_BUCKETS
   10  LblCom even  none     5      5  ETT_
   11  LblCom even  none     1      1  ILL$
   12  LblCom even  none     5      5  ILL_
   13  LblCom even  none     1      1  HEAP$
   14  LblCom even  none     1      1  ILS$
   15  LblCom even  none     5      5  ILS_
   16   Proc  even  none  1772   3354  Z8EZ$STRING
   17  RoData even  none    52     64  Z8EZ$STRING

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    16      0   yes            yes      Std        5  Z8EZ$STRING
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:40   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std      12 Z8AE$ERROR
         yes           Std       2 Z8AT$CREATE_TEMPORARY
         yes           Std       4 Z8EK$COMPARE
         yes           Std       4 Z8AN$NEW_ILL
         yes           Std       1 Z8EK$BRANCH
         yes           Std       2 Z8EK$BRANCH_TRUE
         yes           Std       1 Z8ED$DISPOSE_ABSSYN_TREE
         yes           Std       2 Z8AT$CREATE_TEMP_WITH_BASE
         yes           Std       2 Z8AC$LX_ETT_ITEM_TYI_CONST
         yes           Std       2 Z8E7$MOVE
         yes           Std       2 Z8E5$MATH_PACK
         yes           Std       4 Z8EY$INSERT
         yes           Std       3 Z8AF$NEW_OFF
         yes           Std       4 Z8AF$NEW_FISS
 yes     yes           Std       1 Z8CO$DISPL_CHECK
 yes     yes           Std       1 Z8CO$P_CHECK
         yes           Std       2 Z8AU$TYPE_DESCRIPTOR
 yes     yes           Std       1 Z8CO$INTEGER_CHECK
         yes           Std       2 Z8AU$LENGTH_ETT
         yes           Std       2 Z8EZ$MAX_VALUE
 yes     yes           Std       1 Z8CO$INTEGER_CHECK_NO_ERROR
         yes           Std       3 Z8EV$CONVERT_TYA
         yes           Std       2 Z8CO$CREATE_LIBRARY_BASE
         yes           Std       4 Z8AF$FORME
         yes           Std       2 Z8AU$LENGTH
         yes           Std       4 Z8EA$SUBSTR_ZERO
         yes           Std       5 Z8AN$NEW_ILL1
         yes           Std       2 Z8EK$BRANCH_FALSE
                       nStd      0 X66_AUTO_5
                       nStd      0 X66_ARET
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:41   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    ILL_STEP                              COMCOM                                O1COM
     HIER_STK_PTR                          HIER_STK                              PAGE_FORMAT
     REP_STK_PTR                           REP_STK                          r    ILS_STEP_TABLE

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:42   


        1        1        /*M*  Z8EZ -- Create ILL/ETT for STRING and UNSTRING statements */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*P*   NAME: Z8EZ$STRING
        9        9             AUTHOR: Mark Glenn  (Extract comments by John Heath)
       10       10            PURPOSE: This procedure does semantic checking and produces
       11       11                     the ILL/ETT for the STRING statement.
       12       12        */
       13       13
       14       14        /*D*   NAME: Z8EZ$STRING
       15       15
       16       16              INPUT: Abstract Syntax Tree for the STRING statement.
       17       17
       18       18             OUTPUT: ILS/ILL/ETT intermediate language items.
       19       19
       20       20        DESCRIPTION: Phase 1 makes 3 passes on the STRING statement.
       21       21                     The first pass (Z8EN) produces the Abstract
       22       22                     Syntax Tree (AST).  The second and third passes
       23       23                     are done by this procedure.
       24       24
       25       25             Pass 2: Validate the operands of the STRING statement.
       26       26
       27       27             Pass 3: Generate the intermediate language items to do
       28       28                     the STRING statement.  The STRING statement is
       29       29                     broken down into smaller statements (MOVE, IF, etc.)
       30       30                     by this module, thus it makes calls to procedures
       31       31                     used by these smaller statements (Z8E7$MOVE,
       32       32                     Z8EK$BRANCH_TRUE, etc.).
       33       33
       34       34                     Pass 3 is broken into two parts: optimizable and
       35       35                     not-optimizable.  The algorithm for optimizable
       36       36                     STRING (simple STRING with no DELIMITED clauses)
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:43   
       37       37                     generates a series of MOVEs.  The algorithm for
       38       38                     non-optimizable STRING is highly dependent on the
       39       39                     types and numbers of optional clauses used in the
       40       40                     the statement.
       41       41        */
       42       42
       43       43        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:44   
       44       44        Z8EZ$STRING:PROC( STRING_LIST$ ,

     44 16 000000   000000 700200 xent  Z8EZ$STRING  TSX0  ! X66_AUTO_5
        16 000001   000436 000005                    ZERO    286,5

       45       45                          INTO$ ,
       46       46                          POINTER$ ,
       47       47                          ON_OVERFLOW$,
       48       48                          NOT_ON_OVERFLOW$ );
       49       49
       50       50
       51       51    1        DCL KEYWORD$       PTR;
       52       52    1        DCL INTO$          PTR;
       53       53    1        DCL POINTER$      PTR;
       54       54    1        DCL STRING_LIST$   PTR;
       55       55    1        DCL ON_OVERFLOW$   PTR;
       56       56    1        DCL NOT_ON_OVERFLOW$  PTR;
       57       57
       58       58
       59       59
       60       60             %EQU PHASE = 1;
       61       61             %INCLUDE Z8A_DEFC;
       62      129             %INCLUDE Z8A_SUPP_MAC;
       63     2529             %INCLUDE Z8E_MACROS;
       64     3204             %INCLUDE Z8E_STACKS;
       65     5470             %INCLUDE Z8A_ST;
       66     9129             %INCLUDE Z8A_ETT;
       67     9430             %INCLUDE Z8A_ILL;
       68    10123             %INCLUDE Z8A_COMCOM;
       69    10773             %INCLUDE Z8A_LIBRARY;
       70    10987             %INCLUDE Z8E_O1COM;
       71    11748             %INCLUDE Z8E_HEAP;
       72    11804             %INCLUDE Z8E_WINDOW;
       73    13874             %INCLUDE Z8A_ILS;
       74    13983             %INCLUDE Z8E_ILS_LIST;
       75    14067             %INCLUDE Z8A_TYPES;
       76    14241             %INCLUDE Z8A_ERR_NUMS;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:45   
       77    15005
       78    15006
       79    15007    1        DCL Z8EV$LEAST_STRONGEST_TYPE    ENTRY(3);
       80    15008    1        DCL Z8EV$CONVERT_TYA             ENTRY(3);
       81    15009    1        DCL Z8AT$CREATE_TEMP_WITH_BASE   ENTRY(2);
       82    15010    1        DCL Z8AT$CREATE_TEMPORARY        ENTRY(2);
       83    15011    1        DCL Z8AC$LX_ETT_ITEM_TYI_CONST   ENTRY(2);
       84    15012    1        DCL Z8AU$LENGTH                  ENTRY(2);
       85    15013    1        DCL Z8E5$MATH_PACK               ENTRY(2);
       86    15014    1        DCL Z8EK$COMPARE                 ENTRY(4);
       87    15015    1        DCL Z8EK$BRANCH                  ENTRY(1) ;
       88    15016    1        DCL Z8EK$BRANCH_TRUE             ENTRY(2);
       89    15017    1        DCL Z8EK$BRANCH_FALSE            ENTRY(2);
       90    15018    1        DCL Z8ED$DISPOSE_ABSSYN_TREE     ENTRY(1);
       91    15019    1        DCL Z8EY$INSERT                  ENTRY(4);
       92    15020    1        DCL Z8E7$MOVE                    ENTRY(2);
       93    15021    1        DCL Z8CO$CREATE_LIBRARY_BASE     ENTRY(2);
       94    15022    1        DCL Z8CO$DISPL_CHECK             ENTRY(1) ALTRET;
       95    15023    1        DCL Z8CO$INTEGER_CHECK           ENTRY(1) ALTRET;
       96    15024    1        DCL Z8CO$INTEGER_CHECK_NO_ERROR  ENTRY(1) ALTRET;
       97    15025    1        DCL Z8CO$P_CHECK                 ENTRY(1) ALTRET;
       98    15026    1        DCL Z8AE$ERROR                  ENTRY(12);
       99    15027    1        DCL Z8EZ$MAX_VALUE              ENTRY(2);
      100    15028    1        DCL Z8AU$LENGTH_ETT             ENTRY(2);
      101    15029    1        DCL Z8AU$TYPE_DESCRIPTOR        ENTRY (2) ;
      102    15030    1        DCL Z8AF$FORME                  ENTRY(4) ;
      103    15031    1        DCL Z8AF$NEW_FISS               ENTRY(4) ;
      104    15032    1        DCL Z8AF$NEW_OFF                ENTRY(3) ;
      105    15033    1        DCL Z8EA$SUBSTR_ZERO            ENTRY(4) ;
      106    15034
      107    15035
      108    15036    1        DCL STRINGS$         PTR;
      109    15037    1        DCL IDENTS$          PTR;
      110    15038
      111    15039            %DCL_AUTO_LX_ITEM     ( @NAME = SENDING );
      112    15043            %DCL_AUTO_LX_ITEM     ( @NAME = RECEIVING );
      113    15047
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:46   
      114    15048            %DCL_AUTO_LX_ITEM     ( @NAME = ID1 );
      115    15052            %DCL_AUTO_LX_ITEM     ( @NAME = ID2 );
      116    15056            %DCL_AUTO_LX_ITEM     ( @NAME = ID3 );
      117    15060            %DCL_AUTO_LX_ITEM     ( @NAME = ID4 );
      118    15064
      119    15065            %DCL_AUTO_LX_ITEM     ( @NAME = LENGTH_ID1 );
      120    15069            %DCL_AUTO_LX_ITEM     ( @NAME = LENGTH_ID2 );
      121    15073            %DCL_AUTO_LX_ITEM     ( @NAME = LENGTH_ID3 );
      122    15077
      123    15078            %DCL_AUTO_LX_ITEM     ( @NAME = ONE );
      124    15082            %DCL_AUTO_LX_ITEM     ( @NAME = TWO );
      125    15086            %DCL_AUTO_LX_ITEM     ( @NAME = REMAINDER );
      126    15090            %DCL_AUTO_LX_ITEM     ( @NAME = LENGTH_ID3_P1) ;
      127    15094            %DCL_AUTO_LX_ITEM     ( @NAME = MINIMUM_ );
      128    15098            %DCL_AUTO_LX_ITEM     ( @NAME = INDX );
      129    15102            %DCL_AUTO_LX_ITEM     ( @NAME = INDEX_EXPR ) ;
      130    15106            %DCL_AUTO_LX_ITEM     ( @NAME = ADD );
      131    15110            %DCL_AUTO_LX_ITEM     ( @NAME = KANJI_LX_ETT );
      132    15114            %DCL_AUTO_LX_ITEM     ( @NAME = PLUS_ONE );
      133    15118            %DCL_AUTO_LX_ITEM     ( @NAME = POINTER_TIMES2 );
      134    15122
      135    15123    1        DCL 1 TYPE_DESC ALIGNED,
      136    15124                  %TYPE_DESC ;
      137    15158
      138    15159    1        DCL ID1$             PTR;
      139    15160    1        DCL ID2$             PTR;
      140    15161    1        DCL ID3$             PTR;
      141    15162    1        DCL ID4$             PTR;
      142    15163    1        DCL ID3_ST$          PTR;
      143    15164
      144    15165    1        DCL LENGTH_ID1$      PTR;
      145    15166    1        DCL LENGTH_ID2$      PTR;
      146    15167    1        DCL LENGTH_ID3$      PTR;
      147    15168
      148    15169    1        DCL DELIMITER$       PTR;
      149    15170    1        DCL IDENTS_TAIL$     PTR;
      150    15171    1        DCL STRINGS_TAIL$    PTR;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:47   
      151    15172    1        DCL OVERFLOW$        PTR;
      152    15173    1        DCL NO_OVERFLOW$     PTR ;
      153    15174    1        DCL END_STRING$     PTR;
      154    15175    1        DCL INTO_LENGTH$    PTR;
      155    15176    1        DCL COMPARISON$     PTR;
      156    15177    1        DCL KANJI_LX_ETT$   PTR;
      157    15178    1        DCL POINTER_TIMES2$ PTR;
      158    15179    1        DCL PLUS_ONE$       PTR;
      159    15180    1        DCL ONE$            PTR;
      160    15181    1        DCL TWO$            PTR;
      161    15182    1        DCL ADD$            PTR;
      162    15183    1        DCL LENGTH_ID3_P1$  PTR;
      163    15184    1        DCL MINIMUM$        PTR;
      164    15185    1        DCL RECEIVING$      PTR;
      165    15186    1        DCL INDEX$          PTR;
      166    15187    1        DCL INDEX_EXPR$     PTR ;
      167    15188    1        DCL REMAINDER$      PTR;
      168    15189    1        DCL TABLE_ETT$      PTR;
      169    15190
      170    15191
      171    15192    1        DCL POINTER         BOOLEAN;
      172    15193    1        DCL OVERFLOW        BOOLEAN;
      173    15194    1        DCL SIZE            BOOLEAN;
      174    15195    1        DCL OPTIMIZABLE     BOOLEAN ;
      175    15196
      176    15197    1        DCL CURRENT_OFFSET  SBIN WORD ;
      177    15198    1        DCL ID3_LENGTH      SBIN WORD ;
      178    15199    1        DCL ID1_COUNT       SBIN WORD ;
      179    15200    1        DCL ID1_MAX         SBIN WORD ;
      180    15201    1        DCL OP              SBIN WORD ;
      181    15202
      182    15203        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:48   
      183    15204        %MACRO IF_THEN_DO (@LOP =, @REL =, @ROP =, @LAB =) ;
      184    15205
      185    15206               DO ;
      186    15207                 %LSET LINE@ = CHARTEXT (CONCAT (TEXTCHAR (@LOP),
      187    15208                                                 ' -> LX_ETT_ITEM.LINE')) ;
      188    15209                 %LSET COLUMN@ = CHARTEXT (CONCAT (TEXTCHAR (@LOP),
      189    15210                                                 ' -> LX_ETT_ITEM.COLUMN')) ;
      190    15211
      191    15212                 COMPARISON$ = ADDR (COMPARISON) ;
      192    15213                 %INIT_BINARY_OP (@POINTER = COMPARISON$,
      193    15214                                  @LOP$    = @LOP,
      194    15215                                  @OP      = @REL,
      195    15216                                  @ROP$    = @ROP,
      196    15217                                  @LINE    = %LINE@,
      197    15218                                  @COLUMN  = %COLUMN@) ;
      198    15219
      199    15220                 CALL Z8AT$CREATE_TEMPORARY (%PARA, @LAB) ;
      200    15221                 CALL Z8EK$BRANCH_FALSE (@LAB, COMPARISON$) ;
      201    15222               END ;
      202    15223
      203    15224        %MEND ;
      204    15225
      205    15226        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:49   
      206    15227    1        ID1$ = ADDR(ID1);

  15227 16 000002   200044 630500                    EPPR0   ID1,,AUTO
        16 000003   200270 450500                    STP0    ID1$,,AUTO

      207    15228    1        ID2$ = ADDR(ID2);

  15228 16 000004   200054 631500                    EPPR1   ID2,,AUTO
        16 000005   200271 451500                    STP1    ID2$,,AUTO

      208    15229    1        ID3$ = ADDR(ID3);

  15229 16 000006   200064 633500                    EPPR3   ID3,,AUTO
        16 000007   200272 453500                    STP3    ID3$,,AUTO

      209    15230    1        ID4$ = ADDR(ID4);

  15230 16 000010   200074 634500                    EPPR4   ID4,,AUTO
        16 000011   200273 454500                    STP4    ID4$,,AUTO

      210    15231
      211    15232    1        LENGTH_ID1$ = ADDR(LENGTH_ID1);

  15232 16 000012   200104 635500                    EPPR5   LENGTH_ID1,,AUTO
        16 000013   200275 455500                    STP5    LENGTH_ID1$,,AUTO

      212    15233    1        LENGTH_ID2$ = ADDR(LENGTH_ID2);

  15233 16 000014   200114 636500                    EPPR6   LENGTH_ID2,,AUTO
        16 000015   200276 456500                    STP6    LENGTH_ID2$,,AUTO

      213    15234    1        LENGTH_ID3$ = ADDR(LENGTH_ID3);

  15234 16 000016   200124 637500                    EPPR7   LENGTH_ID3,,AUTO
        16 000017   200277 457500                    STP7    LENGTH_ID3$,,AUTO

      214    15235
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:50   
      215    15236    1        RECEIVING$ = ADDR(RECEIVING);

  15236 16 000020   200034 630500                    EPPR0   RECEIVING,,AUTO
        16 000021   200320 450500                    STP0    RECEIVING$,,AUTO

      216    15237
      217    15238    1        ONE$       = ADDR(ONE);

  15238 16 000022   200134 630500                    EPPR0   ONE,,AUTO
        16 000023   200313 450500                    STP0    ONE$,,AUTO

      218    15239    1        TWO$       = ADDR(TWO);

  15239 16 000024   200144 630500                    EPPR0   TWO,,AUTO
        16 000025   200314 450500                    STP0    TWO$,,AUTO

      219    15240    1        REMAINDER$ = ADDR(REMAINDER);

  15240 16 000026   200154 630500                    EPPR0   REMAINDER,,AUTO
        16 000027   200323 450500                    STP0    REMAINDER$,,AUTO

      220    15241    1        LENGTH_ID3_P1$       = ADDR(LENGTH_ID3_P1);

  15241 16 000030   200164 630500                    EPPR0   LENGTH_ID3_P1,,AUTO
        16 000031   200316 450500                    STP0    LENGTH_ID3_P1$,,AUTO

      221    15242    1        MINIMUM$   = ADDR(MINIMUM_);

  15242 16 000032   200174 630500                    EPPR0   MINIMUM_,,AUTO
        16 000033   200317 450500                    STP0    MINIMUM$,,AUTO

      222    15243    1        INDEX$     = ADDR(INDX);

  15243 16 000034   200204 630500                    EPPR0   INDX,,AUTO
        16 000035   200321 450500                    STP0    INDEX$,,AUTO

      223    15244    1        ADD$       = ADDR(ADD);
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:51   

  15244 16 000036   200224 630500                    EPPR0   ADD,,AUTO
        16 000037   200315 450500                    STP0    ADD$,,AUTO

      224    15245    1        KANJI_LX_ETT$ = ADDR(KANJI_LX_ETT);

  15245 16 000040   200234 630500                    EPPR0   KANJI_LX_ETT,,AUTO
        16 000041   200310 450500                    STP0    KANJI_LX_ETT$,,AUTO

      225    15246    1        POINTER_TIMES2$ = ADDR(POINTER_TIMES2);

  15246 16 000042   200254 630500                    EPPR0   POINTER_TIMES2,,AUTO
        16 000043   200311 450500                    STP0    POINTER_TIMES2$,,AUTO

      226    15247    1        PLUS_ONE$ = ADDR(PLUS_ONE);

  15247 16 000044   200244 630500                    EPPR0   PLUS_ONE,,AUTO
        16 000045   200312 450500                    STP0    PLUS_ONE$,,AUTO

      227    15248
      228    15249        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:52   
      229    15250        /*V* PASS 2 --- Validate the operands of the STRING statement */
      230    15251
      231    15252    1        IF COMCOM.OB.FIPS.LEVEL >= %INT_LEV THEN

  15252 16 000046   000036 720000 xsym               LXL0    COMCOM+30
        16 000047   000002 100003                    CMPX0   2,DU
        16 000050   000055 604000 16                 TMI     s:15256

      232    15253    1          CALL Z8AE$ERROR (%E$LEVEL_CHECK,

  15253 16 000051   000002 630400 17                 EPPR0   2
        16 000052   000000 631400 17                 EPPR1   0
        16 000053   000000 701000 xent               TSX1    Z8AE$ERROR
        16 000054   000000 011000                    NOP     0

      233    15254    1                           O1COM.LINE_NO,
      234    15255    1                           O1COM.COLUMN_NO);
      235    15256    1        OPTIMIZABLE = TRUE ;

  15256 16 000055   400000 236003                    LDQ     -131072,DU
        16 000056   200330 756100                    STQ     OPTIMIZABLE,,AUTO

      236    15257    1        STRINGS$ = STRING_LIST$ -> LX_LIST.HEAD$;

  15257 16 000057   200003 470500                    LDP0    @STRING_LIST$,,AUTO
        16 000060   000000 471500                    LDP1    0,,PR0
        16 000061   100004 236100                    LDQ     4,,PR1
        16 000062   200022 756100                    STQ     STRINGS$,,AUTO

      237    15258    1        ID1_MAX = 0 ; /* Count of number of id1's */

  15258 16 000063   200334 450100                    STZ     ID1_MAX,,AUTO

      238    15259
      239    15260    2        DO UNTIL(STRINGS$ = ADDR(NIL));

      240    15261    2          IDENTS$ = STRINGS$ -> LX_LIST.HEAD$ -> LX_LIST.HEAD$;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:53   

  15261 16 000064   200022 470500                    LDP0    STRINGS$,,AUTO
        16 000065   000004 471500                    LDP1    4,,PR0
        16 000066   100004 236100                    LDQ     4,,PR1
        16 000067   200023 756100                    STQ     IDENTS$,,AUTO

      241    15262
      242    15263    2          CALL VALIDATE_ID2(STRINGS$ -> LX_LIST.TAIL$) ALTRET(BAD_STRING);

  15263 16 000070   200022 236100                    LDQ     STRINGS$,,AUTO
        16 000071   000001 036003                    ADLQ    1,DU
        16 000072   200337 756100                    STQ     OP+2,,AUTO
        16 000073   002040 701000 16                 TSX1    VALIDATE_ID2
        16 000074   001626 702000 16                 TSX2    BAD_STRING

      243    15264
      244    15265    3          DO UNTIL(IDENTS$ = ADDR(NIL));

      245    15266    3            ID1_MAX = ID1_MAX + 1 ;

  15266 16 000075   200334 054100                    AOS     ID1_MAX,,AUTO

      246    15267    3            CALL VALIDATE_ID1(IDENTS$) ALTRET(BAD_STRING);

  15267 16 000076   200023 630500                    EPPR0   IDENTS$,,AUTO
        16 000077   200337 450500                    STP0    OP+2,,AUTO
        16 000100   001731 701000 16                 TSX1    VALIDATE_ID1
        16 000101   001626 702000 16                 TSX2    BAD_STRING

      247    15268
      248    15269    3            IDENTS$ = IDENTS$ -> LX_LIST.LINK;

  15269 16 000102   200023 470500                    LDP0    IDENTS$,,AUTO
        16 000103   000007 236100                    LDQ     7,,PR0
        16 000104   200023 756100                    STQ     IDENTS$,,AUTO

      249    15270    3          END /* Case */;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:54   

  15270 16 000105   000005 116000 17                 CMPQ    5
        16 000106   000075 601000 16                 TNZ     s:15266

      250    15271
      251    15272    2        STRINGS$ = STRINGS$ -> LX_LIST.LINK;

  15272 16 000107   200022 470500                    LDP0    STRINGS$,,AUTO
        16 000110   000007 236100                    LDQ     7,,PR0
        16 000111   200022 756100                    STQ     STRINGS$,,AUTO

      252    15273    2        END /* Case */;

  15273 16 000112   000005 116000 17                 CMPQ    5
        16 000113   000064 601000 16                 TNZ     s:15261

      253    15274
      254    15275    1        CALL VALIDATE_ID3(INTO$) ALTRET(BAD_STRING);

  15275 16 000114   200004 236100                    LDQ     @INTO$,,AUTO
        16 000115   200337 756100                    STQ     OP+2,,AUTO
        16 000116   002133 701000 16                 TSX1    VALIDATE_ID3
        16 000117   001626 702000 16                 TSX2    BAD_STRING

      255    15276    1        CALL VALIDATE_ID4(POINTER$, INTO$) ALTRET(BAD_STRING);

  15276 16 000120   200004 236100                    LDQ     @INTO$,,AUTO
        16 000121   200340 756100                    STQ     @COUNT$+1,,AUTO
        16 000122   200005 236100                    LDQ     @POINTER$,,AUTO
        16 000123   200337 756100                    STQ     OP+2,,AUTO
        16 000124   002251 701000 16                 TSX1    VALIDATE_ID4
        16 000125   001626 702000 16                 TSX2    BAD_STRING

      256    15277
      257    15278    1        IF ON_OVERFLOW$ ~= ADDR(NIL)   OR

  15278 16 000126   200006 470500                    LDP0    @ON_OVERFLOW$,,AUTO
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:55   
        16 000127   000000 236100                    LDQ     0,,PR0
        16 000130   000005 116000 17                 CMPQ    5
        16 000131   000136 601000 16                 TNZ     s:15280
        16 000132   200007 471500                    LDP1    @NOT_ON_OVERFLOW$,,AUTO
        16 000133   100000 236100                    LDQ     0,,PR1
        16 000134   000005 116000 17                 CMPQ    5
        16 000135   000140 600000 16                 TZE     s:15281

      258    15279    1              NOT_ON_OVERFLOW$ ~= ADDR(NIL)     THEN
      259    15280    1          OVERFLOW = %TRUE;

  15280 16 000136   400000 236003                    LDQ     -131072,DU
        16 000137   200326 756100                    STQ     OVERFLOW,,AUTO

      260    15281    1        IF OVERFLOW THEN OPTIMIZABLE = FALSE ;

  15281 16 000140   200326 234100                    SZN     OVERFLOW,,AUTO
        16 000141   000143 605000 16                 TPL     s:15297

  15281 16 000142   200330 450100                    STZ     OPTIMIZABLE,,AUTO

      261    15282
      262    15283        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:56   
      263    15284        /*V* PASS 3a -- Generate the ILL to do the STRING (optimizable).
      264    15285
      265    15286           STRING id1a, id1b, ... INTO id3.
      266    15287
      267    15288                       MVAN                   MVAN      . . .
      268    15289                      /    \                 /    \
      269    15290                   FISS    id1a            FISS   id1b
      270    15291                  /    \                  /    \
      271    15292               id3  length-id1a         OFF     length-id1b
      272    15293                                       /   \
      273    15294                                     id3  length-id1a
      274    15295        */
      275    15296
      276    15297    2        IF OPTIMIZABLE THEN DO ;

  15297 16 000143   200330 234100                    SZN     OPTIMIZABLE,,AUTO
        16 000144   000232 605000 16                 TPL     s:15338

      277    15298
      278    15299    2          CURRENT_OFFSET = 0 ;

  15299 16 000145   200331 450100                    STZ     CURRENT_OFFSET,,AUTO

      279    15300    2          CALL PREPARE_ID3 (INTO$, ID3$) ;

  15300 16 000146   200272 631500                    EPPR1   ID3$,,AUTO
        16 000147   200340 451500                    STP1    @COUNT$+1,,AUTO
        16 000150   200004 236100                    LDQ     @INTO$,,AUTO
        16 000151   200337 756100                    STQ     OP+2,,AUTO
        16 000152   002666 701000 16                 TSX1    PREPARE_ID3
        16 000153   000000 011000                    NOP     0

      280    15301    2          ID3_LENGTH = LENGTH_ID3$

  15301 16 000154   200277 470500                    LDP0    LENGTH_ID3$,,AUTO
        16 000155   000001 471500                    LDP1    1,,PR0
        16 000156   100001 473500                    LDP3    1,,PR1
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:57   
        16 000157   300010 235100                    LDA     8,,PR3
        16 000160   200332 755100                    STA     ID3_LENGTH,,AUTO

      281    15302    2                    -> LX_ETT_ITEM.ETT$
      282    15303    2                    -> ETT.LOP
      283    15304    2                    -> CONST.CONSTI.WORD1 ;
      284    15305
      285    15306    2          STRINGS$ = STRING_LIST$ -> LX_LIST.HEAD$ ;

  15306 16 000161   200003 474500                    LDP4    @STRING_LIST$,,AUTO
        16 000162   400000 475500                    LDP5    0,,PR4
        16 000163   500004 236100                    LDQ     4,,PR5
        16 000164   200022 756100                    STQ     STRINGS$,,AUTO

      286    15307
      287    15308    3          DO UNTIL (STRINGS$ = ADDR(NIL)) ;

      288    15309
      289    15310    3            IDENTS$ = STRINGS$ -> LX_LIST.HEAD$ -> LX_LIST.HEAD$ ;

  15310 16 000165   200022 470500                    LDP0    STRINGS$,,AUTO
        16 000166   000004 471500                    LDP1    4,,PR0
        16 000167   100004 236100                    LDQ     4,,PR1
        16 000170   200023 756100                    STQ     IDENTS$,,AUTO

      290    15311
      291    15312    4            DO UNTIL (IDENTS$ = ADDR(NIL)) ;

      292    15313
      293    15314    4              CALL PREPARE_ID1 (IDENTS$, ID1$) ;

  15314 16 000171   200270 630500                    EPPR0   ID1$,,AUTO
        16 000172   200340 450500                    STP0    @COUNT$+1,,AUTO
        16 000173   200023 631500                    EPPR1   IDENTS$,,AUTO
        16 000174   200337 451500                    STP1    OP+2,,AUTO
        16 000175   002402 701000 16                 TSX1    PREPARE_ID1
        16 000176   000000 011000                    NOP     0
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:58   

      294    15315
      295    15316    4              IF CURRENT_OFFSET < ID3_LENGTH THEN

  15316 16 000177   200331 236100                    LDQ     CURRENT_OFFSET,,AUTO
        16 000200   200332 116100                    CMPQ    ID3_LENGTH,,AUTO
        16 000201   000217 605000 16                 TPL     s:15323

      296    15317    4                CALL MOVE (ID3$, ID1$, LENGTH_ID1$

  15317 16 000202   200275 470500                    LDP0    LENGTH_ID1$,,AUTO
        16 000203   000001 471500                    LDP1    1,,PR0
        16 000204   100001 473500                    LDP3    1,,PR1
        16 000205   200331 634500                    EPPR4   CURRENT_OFFSET,,AUTO
        16 000206   200342 454500                    STP4    END_INDEX$+1,,AUTO
        16 000207   300010 631500                    EPPR1   8,,PR3
        16 000210   200341 451500                    STP1    BEGAIN_INDEX$+1,,AUTO
        16 000211   200270 633500                    EPPR3   ID1$,,AUTO
        16 000212   200340 453500                    STP3    @COUNT$+1,,AUTO
        16 000213   200272 635500                    EPPR5   ID3$,,AUTO
        16 000214   200337 455500                    STP5    OP+2,,AUTO
        16 000215   001627 701000 16                 TSX1    MOVE
        16 000216   000000 011000                    NOP     0

      297    15318    4                                    -> LX_ETT_ITEM.ETT$
      298    15319    4                                    -> ETT.LOP
      299    15320    4                                    -> CONST.CONSTI,
      300    15321    4                           CURRENT_OFFSET) ;
      301    15322
      302    15323    4              IDENTS$ = IDENTS$ -> LX_ITEM.LINK ;

  15323 16 000217   200023 470500                    LDP0    IDENTS$,,AUTO
        16 000220   000007 236100                    LDQ     7,,PR0
        16 000221   200023 756100                    STQ     IDENTS$,,AUTO

      303    15324
      304    15325    4            END ; /* Until Ident$ = Nil */
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:59   

  15325 16 000222   000005 116000 17                 CMPQ    5
        16 000223   000171 601000 16                 TNZ     s:15314

      305    15326
      306    15327    3            STRINGS$ = STRINGS$ -> LX_LIST.LINK ;

  15327 16 000224   200022 470500                    LDP0    STRINGS$,,AUTO
        16 000225   000007 236100                    LDQ     7,,PR0
        16 000226   200022 756100                    STQ     STRINGS$,,AUTO

      307    15328
      308    15329    3          END ; /* Until String$ = Nil */

  15329 16 000227   000005 116000 17                 CMPQ    5
        16 000230   000165 601000 16                 TNZ     s:15310

      309    15330
      310    15331    2        END ; /* Optimizable */

  15331 16 000231   001626 710000 16                 TRA     BAD_STRING

      311    15332
      312    15333    2       ELSE DO ;

      313    15334
      314    15335        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:60   
      315    15336        /*V* PASS 3b -- Generate the ILL to do the STRING (non-optimizable) */
      316    15337
      317    15338    2          CALL Z8AC$LX_ETT_ITEM_TYI_CONST(1, ONE$);

  15338 16 000232   200313 631500                    EPPR1   ONE$,,AUTO
        16 000233   200431 451500                    STP1    LENGTH_ID2$+2,,AUTO
        16 000234   000010 236000 17                 LDQ     8
        16 000235   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 000236   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 000237   000006 631400 17                 EPPR1   6
        16 000240   000000 701000 xent               TSX1    Z8AC$LX_ETT_ITEM_TYI_CONST
        16 000241   000000 011000                    NOP     0

      318    15339    2          CALL Z8AC$LX_ETT_ITEM_TYI_CONST(2, TWO$);

  15339 16 000242   200314 630500                    EPPR0   TWO$,,AUTO
        16 000243   200431 450500                    STP0    LENGTH_ID2$+2,,AUTO
        16 000244   000012 236000 17                 LDQ     10
        16 000245   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 000246   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 000247   000006 631400 17                 EPPR1   6
        16 000250   000000 701000 xent               TSX1    Z8AC$LX_ETT_ITEM_TYI_CONST
        16 000251   000000 011000                    NOP     0

      319    15340
      320    15341    2          CALL Z8AT$CREATE_TEMPORARY(%PARA, OVERFLOW$);

  15341 16 000252   200303 630500                    EPPR0   OVERFLOW$,,AUTO
        16 000253   200431 450500                    STP0    LENGTH_ID2$+2,,AUTO
        16 000254   000014 236000 17                 LDQ     12
        16 000255   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 000256   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 000257   000006 631400 17                 EPPR1   6
        16 000260   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        16 000261   000000 011000                    NOP     0

      321    15342    2          CALL Z8AT$CREATE_TEMPORARY(%PARA, END_STRING$);
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:61   

  15342 16 000262   200305 630500                    EPPR0   END_STRING$,,AUTO
        16 000263   200431 450500                    STP0    LENGTH_ID2$+2,,AUTO
        16 000264   000014 236000 17                 LDQ     12
        16 000265   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 000266   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 000267   000006 631400 17                 EPPR1   6
        16 000270   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        16 000271   000000 011000                    NOP     0

      322    15343
      323    15344    2          CALL PREPARE_ID3(INTO$, ID3$);

  15344 16 000272   200272 630500                    EPPR0   ID3$,,AUTO
        16 000273   200340 450500                    STP0    @COUNT$+1,,AUTO
        16 000274   200004 236100                    LDQ     @INTO$,,AUTO
        16 000275   200337 756100                    STQ     OP+2,,AUTO
        16 000276   002666 701000 16                 TSX1    PREPARE_ID3
        16 000277   000000 011000                    NOP     0

      324    15345    2          CALL PREPARE_ID4(POINTER$, INTO$, ID4$);

  15345 16 000300   200273 630500                    EPPR0   ID4$,,AUTO
        16 000301   200341 450500                    STP0    BEGAIN_INDEX$+1,,AUTO
        16 000302   200004 236100                    LDQ     @INTO$,,AUTO
        16 000303   200340 756100                    STQ     @COUNT$+1,,AUTO
        16 000304   200005 236100                    LDQ     @POINTER$,,AUTO
        16 000305   200337 756100                    STQ     OP+2,,AUTO
        16 000306   002711 701000 16                 TSX1    PREPARE_ID4
        16 000307   000000 011000                    NOP     0

      325    15346
      326    15347    2          ID1_COUNT = 0 ;

  15347 16 000310   200333 450100                    STZ     ID1_COUNT,,AUTO

      327    15348    2          STRINGS$ = STRING_LIST$ -> LX_LIST.HEAD$;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:62   

  15348 16 000311   200003 470500                    LDP0    @STRING_LIST$,,AUTO
        16 000312   000000 471500                    LDP1    0,,PR0
        16 000313   100004 236100                    LDQ     4,,PR1
        16 000314   200022 756100                    STQ     STRINGS$,,AUTO

      328    15349
      329    15350               %FISH( TRIAD = ID3$ -> LX_ETT_ITEM.ETT$,
      330    15351                      RTN   = ID3_ST$ );

  15353 16 000315   200272 473500                    LDP3    ID3$,,AUTO
        16 000316   300001 236100                    LDQ     1,,PR3
        16 000317   200274 756100                    STQ     ID3_ST$,,AUTO

  15354 16 000320   200274 474500                    LDP4    ID3_ST$,,AUTO
        16 000321   400000 220100                    LDX0    0,,PR4
        16 000322   000751 100003                    CMPX0   489,DU
        16 000323   000333 603000 16                 TRC     s:15361

  15355 16 000324   200274 470500                    LDP0    ID3_ST$,,AUTO
        16 000325   000001 236100                    LDQ     1,,PR0
        16 000326   200274 756100                    STQ     ID3_ST$,,AUTO

  15356 16 000327   200274 470500                    LDP0    ID3_ST$,,AUTO
        16 000330   000000 220100                    LDX0    0,,PR0
        16 000331   000751 100003                    CMPX0   489,DU
        16 000332   000324 602000 16                 TNC     s:15355

      331    15359
      332    15360    3          DO UNTIL(STRINGS$ = ADDR(NIL));

      333    15361    3            IDENTS$    = STRINGS$ -> LX_LIST.HEAD$ -> LX_LIST.HEAD$;

  15361 16 000333   200022 470500                    LDP0    STRINGS$,,AUTO
        16 000334   000004 471500                    LDP1    4,,PR0
        16 000335   100004 236100                    LDQ     4,,PR1
        16 000336   200023 756100                    STQ     IDENTS$,,AUTO
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:63   

      334    15362
      335    15363    3            CALL PREPARE_ID2(STRINGS$ -> LX_LIST.TAIL$, ID2$);

  15363 16 000337   200271 631500                    EPPR1   ID2$,,AUTO
        16 000340   200340 451500                    STP1    @COUNT$+1,,AUTO
        16 000341   200022 236100                    LDQ     STRINGS$,,AUTO
        16 000342   000001 036003                    ADLQ    1,DU
        16 000343   200337 756100                    STQ     OP+2,,AUTO
        16 000344   002614 701000 16                 TSX1    PREPARE_ID2
        16 000345   000000 011000                    NOP     0

      336    15364
      337    15365    4            DO UNTIL(IDENTS$ = ADDR(NIL));

      338    15366    4              ID1_COUNT = ID1_COUNT + 1 ;

  15366 16 000346   200333 054100                    AOS     ID1_COUNT,,AUTO

      339    15367
      340    15368    4              IF ID3_ST$ -> SCALAR.B.KANJI    THEN

  15368 16 000347   200274 470500                    LDP0    ID3_ST$,,AUTO
        16 000350   000003 236100                    LDQ     3,,PR0
        16 000351   001000 316007                    CANQ    512,DL
        16 000352   000442 600000 16                 TZE     s:15427

      341    15369    5                DO;

      342    15370
      343    15371                     /*  For Kanji, multiply pointer by 2 and subtract
      344    15372                         one.  Subtract is because offset in COBOL start
      345    15373                         at one and in PL6 at 0 */
      346    15374
      347    15375                       %INIT_BINARY_OP( @POINTER = POINTER_TIMES2$,
      348    15376                                        @OP   = %OP_STAR,
      349    15377                                        @LOP$ = ID4$,
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:64   
      350    15378                                        @ROP$ = TWO$ );

  15380 16 000353   000005 220003                    LDX0    5,DU
        16 000354   200311 471500                    LDP1    POINTER_TIMES2$,,AUTO
        16 000355   100000 740100                    STX0    0,,PR1

  15381 16 000356   000000 221003                    LDX1    0,DU
        16 000357   100000 441100                    SXL1    0,,PR1

  15388 16 000360   000133 235000 xsym               LDA     COMCOM+91
        16 000361   100005 755100                    STA     5,,PR1

  15389 16 000362   000134 236000 xsym               LDQ     COMCOM+92
        16 000363   100006 756100                    STQ     6,,PR1

  15390 16 000364   200314 236100                    LDQ     TWO$,,AUTO
        16 000365   100002 756100                    STQ     2,,PR1

  15391 16 000366   200273 236100                    LDQ     ID4$,,AUTO
        16 000367   100001 756100                    STQ     1,,PR1

  15392 16 000370   000022 235007                    LDA     18,DL
        16 000371   100003 755100                    STA     3,,PR1

  15393 16 000372   000005 236000 17                 LDQ     5
        16 000373   100007 756100                    STQ     7,,PR1

      351    15396
      352    15397                       %INIT_BINARY_OP( @POINTER = PLUS_ONE$,
      353    15398                                        @OP   = %OP_BINARY_MINUS,
      354    15399                                        @LOP$ = POINTER_TIMES2$,
      355    15400                                        @ROP$ = ONE$ );

  15402 16 000374   200312 473500                    LDP3    PLUS_ONE$,,AUTO
        16 000375   300000 740100                    STX0    0,,PR3

  15403 16 000376   200312 473500                    LDP3    PLUS_ONE$,,AUTO
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:65   
        16 000377   300000 441100                    SXL1    0,,PR3

  15410 16 000400   000133 236000 xsym               LDQ     COMCOM+91
        16 000401   200312 473500                    LDP3    PLUS_ONE$,,AUTO
        16 000402   300005 756100                    STQ     5,,PR3

  15411 16 000403   000134 236000 xsym               LDQ     COMCOM+92
        16 000404   200312 473500                    LDP3    PLUS_ONE$,,AUTO
        16 000405   300006 756100                    STQ     6,,PR3

  15412 16 000406   200313 236100                    LDQ     ONE$,,AUTO
        16 000407   200312 473500                    LDP3    PLUS_ONE$,,AUTO
        16 000410   300002 756100                    STQ     2,,PR3

  15413 16 000411   200311 236100                    LDQ     POINTER_TIMES2$,,AUTO
        16 000412   200312 473500                    LDP3    PLUS_ONE$,,AUTO
        16 000413   300001 756100                    STQ     1,,PR3

  15414 16 000414   000021 235007                    LDA     17,DL
        16 000415   200312 473500                    LDP3    PLUS_ONE$,,AUTO
        16 000416   300003 755100                    STA     3,,PR3

  15415 16 000417   000005 236000 17                 LDQ     5
        16 000420   200312 473500                    LDP3    PLUS_ONE$,,AUTO
        16 000421   300007 756100                    STQ     7,,PR3

      356    15418
      357    15419    5                  CALL Z8E5$MATH_PACK( PLUS_ONE$,

  15419 16 000422   200312 633500                    EPPR3   PLUS_ONE$,,AUTO
        16 000423   200431 453500                    STP3    LENGTH_ID2$+2,,AUTO
        16 000424   200312 634500                    EPPR4   PLUS_ONE$,,AUTO
        16 000425   200430 454500                    STP4    LENGTH_ID2$+1,,AUTO
        16 000426   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 000427   000006 631400 17                 EPPR1   6
        16 000430   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        16 000431   000000 011000                    NOP     0
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:66   

      358    15420    5                                       PLUS_ONE$ );
      359    15421
      360    15422    5                  CALL Z8E7$MOVE( ID4$,

  15422 16 000432   200312 630500                    EPPR0   PLUS_ONE$,,AUTO
        16 000433   200431 450500                    STP0    LENGTH_ID2$+2,,AUTO
        16 000434   200273 631500                    EPPR1   ID4$,,AUTO
        16 000435   200430 451500                    STP1    LENGTH_ID2$+1,,AUTO
        16 000436   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 000437   000006 631400 17                 EPPR1   6
        16 000440   000000 701000 xent               TSX1    Z8E7$MOVE
        16 000441   000000 011000                    NOP     0

      361    15423    5                                  PLUS_ONE$ );
      362    15424    5                END;

      363    15425
      364    15426
      365    15427    5              IF POINTER OR ID1_COUNT > 1 THEN DO ;

  15427 16 000442   200325 234100                    SZN     POINTER,,AUTO
        16 000443   000447 604000 16                 TMI     s:15428
        16 000444   200333 235100                    LDA     ID1_COUNT,,AUTO
        16 000445   000001 115007                    CMPA    1,DL
        16 000446   000501 604400 16                 TMOZ    s:15438

      366    15428    5                CALL Z8EK$COMPARE( ID4$ ,

  15428 16 000447   200307 630500                    EPPR0   COMPARISON$,,AUTO
        16 000450   200433 450500                    STP0    LENGTH_ID2$+4,,AUTO
        16 000451   200277 631500                    EPPR1   LENGTH_ID3$,,AUTO
        16 000452   200432 451500                    STP1    LENGTH_ID2$+3,,AUTO
        16 000453   000017 236000 17                 LDQ     15
        16 000454   200431 756100                    STQ     LENGTH_ID2$+2,,AUTO
        16 000455   200273 633500                    EPPR3   ID4$,,AUTO
        16 000456   200430 453500                    STP3    LENGTH_ID2$+1,,AUTO
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:67   
        16 000457   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 000460   000015 631400 17                 EPPR1   13
        16 000461   000000 701000 xent               TSX1    Z8EK$COMPARE
        16 000462   000000 011000                    NOP     0

      367    15429    5                                   %OP_GREATER_THAN ,
      368    15430    5                                   LENGTH_ID3$ ,
      369    15431    5                                   COMPARISON$);
      370    15432
      371    15433    5                CALL Z8EK$BRANCH_TRUE(OVERFLOW$, COMPARISON$);

  15433 16 000463   200307 630500                    EPPR0   COMPARISON$,,AUTO
        16 000464   200431 450500                    STP0    LENGTH_ID2$+2,,AUTO
        16 000465   200303 631500                    EPPR1   OVERFLOW$,,AUTO
        16 000466   200430 451500                    STP1    LENGTH_ID2$+1,,AUTO
        16 000467   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 000470   000006 631400 17                 EPPR1   6
        16 000471   000000 701000 xent               TSX1    Z8EK$BRANCH_TRUE
        16 000472   000000 011000                    NOP     0

      372    15434
      373    15435    5                CALL Z8ED$DISPOSE_ABSSYN_TREE(COMPARISON$);

  15435 16 000473   200307 630500                    EPPR0   COMPARISON$,,AUTO
        16 000474   200430 450500                    STP0    LENGTH_ID2$+1,,AUTO
        16 000475   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 000476   000020 631400 17                 EPPR1   16
        16 000477   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        16 000500   000000 011000                    NOP     0

      374    15436    5              END ; /* Pointer clause or this is not the 1st id1 */

      375    15437
      376    15438    4              CALL PREPARE_ID1(IDENTS$, ID1$);

  15438 16 000501   200270 630500                    EPPR0   ID1$,,AUTO
        16 000502   200340 450500                    STP0    @COUNT$+1,,AUTO
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:68   
        16 000503   200023 631500                    EPPR1   IDENTS$,,AUTO
        16 000504   200337 451500                    STP1    OP+2,,AUTO
        16 000505   002402 701000 16                 TSX1    PREPARE_ID1
        16 000506   000000 011000                    NOP     0

      377    15439
      378    15440                   %INIT_BINARY_OP( @POINTER     = LENGTH_ID3_P1$ ,
      379    15441                                    @OP          = %OP_PLUS,
      380    15442                                    @LOP$        = LENGTH_ID3$ ,
      381    15443                                    @ROP$        = ONE$) ;

  15445 16 000507   000005 220003                    LDX0    5,DU
        16 000510   200316 470500                    LDP0    LENGTH_ID3_P1$,,AUTO
        16 000511   000000 740100                    STX0    0,,PR0

  15446 16 000512   000000 221003                    LDX1    0,DU
        16 000513   200316 470500                    LDP0    LENGTH_ID3_P1$,,AUTO
        16 000514   000000 441100                    SXL1    0,,PR0

  15453 16 000515   000133 235000 xsym               LDA     COMCOM+91
        16 000516   200316 470500                    LDP0    LENGTH_ID3_P1$,,AUTO
        16 000517   000005 755100                    STA     5,,PR0

  15454 16 000520   000134 235000 xsym               LDA     COMCOM+92
        16 000521   200316 470500                    LDP0    LENGTH_ID3_P1$,,AUTO
        16 000522   000006 755100                    STA     6,,PR0

  15455 16 000523   200313 236100                    LDQ     ONE$,,AUTO
        16 000524   200316 470500                    LDP0    LENGTH_ID3_P1$,,AUTO
        16 000525   000002 756100                    STQ     2,,PR0

  15456 16 000526   200277 236100                    LDQ     LENGTH_ID3$,,AUTO
        16 000527   200316 470500                    LDP0    LENGTH_ID3_P1$,,AUTO
        16 000530   000001 756100                    STQ     1,,PR0

  15457 16 000531   000020 235007                    LDA     16,DL
        16 000532   200316 470500                    LDP0    LENGTH_ID3_P1$,,AUTO
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:69   
        16 000533   000003 755100                    STA     3,,PR0

  15458 16 000534   000005 236000 17                 LDQ     5
        16 000535   200316 470500                    LDP0    LENGTH_ID3_P1$,,AUTO
        16 000536   000007 756100                    STQ     7,,PR0

      382    15461
      383    15462                   %INIT_BINARY_OP( @POINTER     = REMAINDER$ ,
      384    15463                                    @OP          = %OP_BINARY_MINUS,
      385    15464                                    @LOP$        = LENGTH_ID3_P1$ ,
      386    15465                                    @ROP$        = ID4$ );

  15467 16 000537   200323 470500                    LDP0    REMAINDER$,,AUTO
        16 000540   000000 740100                    STX0    0,,PR0

  15468 16 000541   200323 470500                    LDP0    REMAINDER$,,AUTO
        16 000542   000000 441100                    SXL1    0,,PR0

  15475 16 000543   000133 236000 xsym               LDQ     COMCOM+91
        16 000544   200323 470500                    LDP0    REMAINDER$,,AUTO
        16 000545   000005 756100                    STQ     5,,PR0

  15476 16 000546   000134 236000 xsym               LDQ     COMCOM+92
        16 000547   200323 470500                    LDP0    REMAINDER$,,AUTO
        16 000550   000006 756100                    STQ     6,,PR0

  15477 16 000551   200273 236100                    LDQ     ID4$,,AUTO
        16 000552   200323 470500                    LDP0    REMAINDER$,,AUTO
        16 000553   000002 756100                    STQ     2,,PR0

  15478 16 000554   200316 236100                    LDQ     LENGTH_ID3_P1$,,AUTO
        16 000555   200323 470500                    LDP0    REMAINDER$,,AUTO
        16 000556   000001 756100                    STQ     1,,PR0

  15479 16 000557   000021 236007                    LDQ     17,DL
        16 000560   200323 470500                    LDP0    REMAINDER$,,AUTO
        16 000561   000003 756100                    STQ     3,,PR0
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:70   

  15480 16 000562   000005 236000 17                 LDQ     5
        16 000563   200323 470500                    LDP0    REMAINDER$,,AUTO
        16 000564   000007 756100                    STQ     7,,PR0

      387    15483
      388    15484    4              IF SIZE THEN

  15484 16 000565   200327 234100                    SZN     SIZE,,AUTO
        16 000566   000676 605000 16                 TPL     s:15521

      389    15485    5                DO;

      390    15486    5                  INDEX$ = LENGTH_ID1$ ; /* Index (id1, SIZE) */

  15486 16 000567   200275 236100                    LDQ     LENGTH_ID1$,,AUTO
        16 000570   200321 756100                    STQ     INDEX$,,AUTO

      391    15487
      392    15488                       %INIT_BINARY_OP( @POINTER    = MINIMUM$ ,
      393    15489                                        @OP         = %OP_MINIMUM ,
      394    15490                                        @LOP$       = REMAINDER$ ,
      395    15491                                        @ROP$       = LENGTH_ID1$ );

  15493 16 000571   200317 470500                    LDP0    MINIMUM$,,AUTO
        16 000572   000000 740100                    STX0    0,,PR0

  15494 16 000573   200317 470500                    LDP0    MINIMUM$,,AUTO
        16 000574   000000 441100                    SXL1    0,,PR0

  15501 16 000575   000133 236000 xsym               LDQ     COMCOM+91
        16 000576   200317 470500                    LDP0    MINIMUM$,,AUTO
        16 000577   000005 756100                    STQ     5,,PR0

  15502 16 000600   000134 236000 xsym               LDQ     COMCOM+92
        16 000601   200317 470500                    LDP0    MINIMUM$,,AUTO
        16 000602   000006 756100                    STQ     6,,PR0
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:71   

  15503 16 000603   200275 236100                    LDQ     LENGTH_ID1$,,AUTO
        16 000604   200317 470500                    LDP0    MINIMUM$,,AUTO
        16 000605   000002 756100                    STQ     2,,PR0

  15504 16 000606   200323 236100                    LDQ     REMAINDER$,,AUTO
        16 000607   200317 470500                    LDP0    MINIMUM$,,AUTO
        16 000610   000001 756100                    STQ     1,,PR0

  15505 16 000611   000034 236007                    LDQ     28,DL
        16 000612   200317 470500                    LDP0    MINIMUM$,,AUTO
        16 000613   000003 756100                    STQ     3,,PR0

  15506 16 000614   000005 236000 17                 LDQ     5
        16 000615   200317 470500                    LDP0    MINIMUM$,,AUTO
        16 000616   000007 756100                    STQ     7,,PR0

      396    15509
      397    15510    5                  CALL Z8E5$MATH_PACK(MINIMUM$, MINIMUM$);

  15510 16 000617   200317 630500                    EPPR0   MINIMUM$,,AUTO
        16 000620   200431 450500                    STP0    LENGTH_ID2$+2,,AUTO
        16 000621   200317 631500                    EPPR1   MINIMUM$,,AUTO
        16 000622   200430 451500                    STP1    LENGTH_ID2$+1,,AUTO
        16 000623   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 000624   000006 631400 17                 EPPR1   6
        16 000625   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        16 000626   000000 011000                    NOP     0

      398    15511
      399    15512    5                  IF POINTER OR ID1_COUNT ~= 1 THEN

  15512 16 000627   200325 234100                    SZN     POINTER,,AUTO
        16 000630   000634 604000 16                 TMI     s:15513
        16 000631   200333 235100                    LDA     ID1_COUNT,,AUTO
        16 000632   000001 115007                    CMPA    1,DL
        16 000633   000651 600000 16                 TZE     s:15515
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:72   

      400    15513    5                    CALL Z8EY$INSERT(ID3$, ID4$, MINIMUM$, RECEIVING$);

  15513 16 000634   200320 630500                    EPPR0   RECEIVING$,,AUTO
        16 000635   200433 450500                    STP0    LENGTH_ID2$+4,,AUTO
        16 000636   200317 631500                    EPPR1   MINIMUM$,,AUTO
        16 000637   200432 451500                    STP1    LENGTH_ID2$+3,,AUTO
        16 000640   200273 633500                    EPPR3   ID4$,,AUTO
        16 000641   200431 453500                    STP3    LENGTH_ID2$+2,,AUTO
        16 000642   200272 634500                    EPPR4   ID3$,,AUTO
        16 000643   200430 454500                    STP4    LENGTH_ID2$+1,,AUTO
        16 000644   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 000645   000015 631400 17                 EPPR1   13
        16 000646   000000 701000 xent               TSX1    Z8EY$INSERT
        16 000647   000000 011000                    NOP     0
        16 000650   000665 710000 16                 TRA     s:15517

      401    15514    5                  ELSE
      402    15515    5                    CALL Z8EY$INSERT (ID3$, ONE$, MINIMUM$, RECEIVING$) ;

  15515 16 000651   200320 630500                    EPPR0   RECEIVING$,,AUTO
        16 000652   200433 450500                    STP0    LENGTH_ID2$+4,,AUTO
        16 000653   200317 631500                    EPPR1   MINIMUM$,,AUTO
        16 000654   200432 451500                    STP1    LENGTH_ID2$+3,,AUTO
        16 000655   200313 633500                    EPPR3   ONE$,,AUTO
        16 000656   200431 453500                    STP3    LENGTH_ID2$+2,,AUTO
        16 000657   200272 634500                    EPPR4   ID3$,,AUTO
        16 000660   200430 454500                    STP4    LENGTH_ID2$+1,,AUTO
        16 000661   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 000662   000015 631400 17                 EPPR1   13
        16 000663   000000 701000 xent               TSX1    Z8EY$INSERT
        16 000664   000000 011000                    NOP     0

      403    15516
      404    15517    5                  CALL Z8E7$MOVE(RECEIVING$, ID1$);

  15517 16 000665   200270 630500                    EPPR0   ID1$,,AUTO
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:73   
        16 000666   200431 450500                    STP0    LENGTH_ID2$+2,,AUTO
        16 000667   200320 631500                    EPPR1   RECEIVING$,,AUTO
        16 000670   200430 451500                    STP1    LENGTH_ID2$+1,,AUTO
        16 000671   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 000672   000006 631400 17                 EPPR1   6
        16 000673   000000 701000 xent               TSX1    Z8E7$MOVE
        16 000674   000000 011000                    NOP     0

      405    15518    5                END;

  15518 16 000675   001103 710000 16                 TRA     s:15608

      406    15519    4              ELSE
      407    15520    5                DO;

      408    15521    5                  INDEX_EXPR$ = ADDR (INDEX_EXPR) ;

  15521 16 000676   200214 630500                    EPPR0   INDEX_EXPR,,AUTO
        16 000677   200322 450500                    STP0    INDEX_EXPR$,,AUTO

      409    15522                       %INIT_LX_ETT_ITEM (@POINTER = INDEX$, @TYPE = %TYI) ;

  15524 16 000700   000004 222003                    LDX2    4,DU
        16 000701   200321 471500                    LDP1    INDEX$,,AUTO
        16 000702   100000 742100                    STX2    0,,PR1

  15525 16 000703   200321 470500                    LDP0    INDEX$,,AUTO
        16 000704   000000 441100                    SXL1    0,,PR0

  15526 16 000705   000001 236007                    LDQ     1,DL
        16 000706   200321 470500                    LDP0    INDEX$,,AUTO
        16 000707   000004 756100                    STQ     4,,PR0

  15527 16 000710   000005 236000 17                 LDQ     5
        16 000711   200321 470500                    LDP0    INDEX$,,AUTO
        16 000712   000007 756100                    STQ     7,,PR0

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:74   
  15528 16 000713   200321 470500                    LDP0    INDEX$,,AUTO
        16 000714   000001 756100                    STQ     1,,PR0

  15529 16 000715   000005 236000 17                 LDQ     5
        16 000716   200321 470500                    LDP0    INDEX$,,AUTO
        16 000717   000002 756100                    STQ     2,,PR0

  15531 16 000720   000133 236000 xsym               LDQ     COMCOM+91
        16 000721   200321 470500                    LDP0    INDEX$,,AUTO
        16 000722   000005 756100                    STQ     5,,PR0

  15532 16 000723   000134 236000 xsym               LDQ     COMCOM+92
        16 000724   200321 470500                    LDP0    INDEX$,,AUTO
        16 000725   000006 756100                    STQ     6,,PR0

      410    15544    5                  CALL Z8AT$CREATE_TEMP_WITH_BASE (%SCALAR,

  15544 16 000726   200321 236100                    LDQ     INDEX$,,AUTO
        16 000727   000001 036003                    ADLQ    1,DU
        16 000730   000022 235000 17                 LDA     18
        16 000731   200430 757100                    STAQ    LENGTH_ID2$+1,,AUTO
        16 000732   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 000733   000006 631400 17                 EPPR1   6
        16 000734   000000 701000 xent               TSX1    Z8AT$CREATE_TEMP_WITH_BASE
        16 000735   000000 011000                    NOP     0

      411    15545    5                                          INDEX$ -> LX_ETT_ITEM.ETT$) ;
      412    15546
      413    15547    5                  IF ID3_ST$ -> SCALAR.B.KANJI  THEN

  15547 16 000736   200274 470500                    LDP0    ID3_ST$,,AUTO
        16 000737   000003 236100                    LDQ     3,,PR0
        16 000740   001000 316007                    CANQ    512,DL
        16 000741   000747 600000 16                 TZE     s:15556

      414    15548    5                    CALL KANJI_INDEX( INDEX$ );

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:75   
  15548 16 000742   200321 631500                    EPPR1   INDEX$,,AUTO
        16 000743   200337 451500                    STP1    OP+2,,AUTO
        16 000744   002777 701000 16                 TSX1    KANJI_INDEX
        16 000745   000000 011000                    NOP     0
        16 000746   001017 710000 16                 TRA     s:15582

      415    15549    5                  ELSE
      416    15550    6                    DO;

      417    15551                           %INIT_BINARY_OP( @POINTER    = INDEX_EXPR$ ,
      418    15552                                            @OP         = %OP_INDEX ,
      419    15553                                            @LOP$       = ID2$ ,
      420    15554                                            @ROP$       = ID1$ );

  15556 16 000747   000005 220003                    LDX0    5,DU
        16 000750   200322 471500                    LDP1    INDEX_EXPR$,,AUTO
        16 000751   100000 740100                    STX0    0,,PR1

  15557 16 000752   000000 221003                    LDX1    0,DU
        16 000753   200322 471500                    LDP1    INDEX_EXPR$,,AUTO
        16 000754   100000 441100                    SXL1    0,,PR1

  15564 16 000755   000133 235000 xsym               LDA     COMCOM+91
        16 000756   200322 471500                    LDP1    INDEX_EXPR$,,AUTO
        16 000757   100005 755100                    STA     5,,PR1

  15565 16 000760   000134 235000 xsym               LDA     COMCOM+92
        16 000761   200322 471500                    LDP1    INDEX_EXPR$,,AUTO
        16 000762   100006 755100                    STA     6,,PR1

  15566 16 000763   200270 236100                    LDQ     ID1$,,AUTO
        16 000764   200322 471500                    LDP1    INDEX_EXPR$,,AUTO
        16 000765   100002 756100                    STQ     2,,PR1

  15567 16 000766   200271 236100                    LDQ     ID2$,,AUTO
        16 000767   200322 471500                    LDP1    INDEX_EXPR$,,AUTO
        16 000770   100001 756100                    STQ     1,,PR1
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:76   

  15568 16 000771   000035 235007                    LDA     29,DL
        16 000772   200322 471500                    LDP1    INDEX_EXPR$,,AUTO
        16 000773   100003 755100                    STA     3,,PR1

  15569 16 000774   000005 236000 17                 LDQ     5
        16 000775   200322 471500                    LDP1    INDEX_EXPR$,,AUTO
        16 000776   100007 756100                    STQ     7,,PR1

      421    15572
      422    15573    6                      CALL Z8E5$MATH_PACK (INDEX_EXPR$, INDEX_EXPR$) ;

  15573 16 000777   200322 631500                    EPPR1   INDEX_EXPR$,,AUTO
        16 001000   200431 451500                    STP1    LENGTH_ID2$+2,,AUTO
        16 001001   200322 633500                    EPPR3   INDEX_EXPR$,,AUTO
        16 001002   200430 453500                    STP3    LENGTH_ID2$+1,,AUTO
        16 001003   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001004   000006 631400 17                 EPPR1   6
        16 001005   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        16 001006   000000 011000                    NOP     0

      423    15574    6                      CALL Z8E7$MOVE (INDEX$, INDEX_EXPR$) ;

  15574 16 001007   200322 630500                    EPPR0   INDEX_EXPR$,,AUTO
        16 001010   200431 450500                    STP0    LENGTH_ID2$+2,,AUTO
        16 001011   200321 631500                    EPPR1   INDEX$,,AUTO
        16 001012   200430 451500                    STP1    LENGTH_ID2$+1,,AUTO
        16 001013   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001014   000006 631400 17                 EPPR1   6
        16 001015   000000 701000 xent               TSX1    Z8E7$MOVE
        16 001016   000000 011000                    NOP     0

      424    15575    6                    END;

      425    15576
      426    15577                       %INIT_BINARY_OP( @POINTER    = MINIMUM$ ,
      427    15578                                        @OP         = %OP_MINIMUM ,
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:77   
      428    15579                                        @LOP$       = REMAINDER$ ,
      429    15580                                        @ROP$       = INDEX$ );

  15582 16 001017   000005 220003                    LDX0    5,DU
        16 001020   200317 470500                    LDP0    MINIMUM$,,AUTO
        16 001021   000000 740100                    STX0    0,,PR0

  15583 16 001022   000000 221003                    LDX1    0,DU
        16 001023   200317 470500                    LDP0    MINIMUM$,,AUTO
        16 001024   000000 441100                    SXL1    0,,PR0

  15590 16 001025   000133 235000 xsym               LDA     COMCOM+91
        16 001026   200317 470500                    LDP0    MINIMUM$,,AUTO
        16 001027   000005 755100                    STA     5,,PR0

  15591 16 001030   000134 235000 xsym               LDA     COMCOM+92
        16 001031   200317 470500                    LDP0    MINIMUM$,,AUTO
        16 001032   000006 755100                    STA     6,,PR0

  15592 16 001033   200321 236100                    LDQ     INDEX$,,AUTO
        16 001034   200317 470500                    LDP0    MINIMUM$,,AUTO
        16 001035   000002 756100                    STQ     2,,PR0

  15593 16 001036   200323 236100                    LDQ     REMAINDER$,,AUTO
        16 001037   200317 470500                    LDP0    MINIMUM$,,AUTO
        16 001040   000001 756100                    STQ     1,,PR0

  15594 16 001041   000034 235007                    LDA     28,DL
        16 001042   200317 470500                    LDP0    MINIMUM$,,AUTO
        16 001043   000003 755100                    STA     3,,PR0

  15595 16 001044   000005 236000 17                 LDQ     5
        16 001045   200317 470500                    LDP0    MINIMUM$,,AUTO
        16 001046   000007 756100                    STQ     7,,PR0

      430    15598
      431    15599    5                  CALL Z8E5$MATH_PACK(MINIMUM$, MINIMUM$);
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:78   

  15599 16 001047   200317 630500                    EPPR0   MINIMUM$,,AUTO
        16 001050   200431 450500                    STP0    LENGTH_ID2$+2,,AUTO
        16 001051   200317 631500                    EPPR1   MINIMUM$,,AUTO
        16 001052   200430 451500                    STP1    LENGTH_ID2$+1,,AUTO
        16 001053   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001054   000006 631400 17                 EPPR1   6
        16 001055   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        16 001056   000000 011000                    NOP     0

      432    15600
      433    15601    5                  CALL Z8EY$INSERT(ID3$, ID4$, MINIMUM$, RECEIVING$);

  15601 16 001057   200320 630500                    EPPR0   RECEIVING$,,AUTO
        16 001060   200433 450500                    STP0    LENGTH_ID2$+4,,AUTO
        16 001061   200317 631500                    EPPR1   MINIMUM$,,AUTO
        16 001062   200432 451500                    STP1    LENGTH_ID2$+3,,AUTO
        16 001063   200273 633500                    EPPR3   ID4$,,AUTO
        16 001064   200431 453500                    STP3    LENGTH_ID2$+2,,AUTO
        16 001065   200272 634500                    EPPR4   ID3$,,AUTO
        16 001066   200430 454500                    STP4    LENGTH_ID2$+1,,AUTO
        16 001067   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001070   000015 631400 17                 EPPR1   13
        16 001071   000000 701000 xent               TSX1    Z8EY$INSERT
        16 001072   000000 011000                    NOP     0

      434    15602
      435    15603    5                  CALL Z8E7$MOVE(RECEIVING$, ID1$);

  15603 16 001073   200270 630500                    EPPR0   ID1$,,AUTO
        16 001074   200431 450500                    STP0    LENGTH_ID2$+2,,AUTO
        16 001075   200320 631500                    EPPR1   RECEIVING$,,AUTO
        16 001076   200430 451500                    STP1    LENGTH_ID2$+1,,AUTO
        16 001077   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001100   000006 631400 17                 EPPR1   6
        16 001101   000000 701000 xent               TSX1    Z8E7$MOVE
        16 001102   000000 011000                    NOP     0
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:79   

      436    15604    5                END;

      437    15605
      438    15606                   /* IF Remainder >= Index(id1,id2) THEN GO TO No_Overflow */
      439    15607
      440    15608    4              CALL Z8EK$COMPARE (REMAINDER$,

  15608 16 001103   200307 630500                    EPPR0   COMPARISON$,,AUTO
        16 001104   200433 450500                    STP0    LENGTH_ID2$+4,,AUTO
        16 001105   200321 631500                    EPPR1   INDEX$,,AUTO
        16 001106   200432 451500                    STP1    LENGTH_ID2$+3,,AUTO
        16 001107   000024 236000 17                 LDQ     20
        16 001110   200431 756100                    STQ     LENGTH_ID2$+2,,AUTO
        16 001111   200323 633500                    EPPR3   REMAINDER$,,AUTO
        16 001112   200430 453500                    STP3    LENGTH_ID2$+1,,AUTO
        16 001113   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001114   000015 631400 17                 EPPR1   13
        16 001115   000000 701000 xent               TSX1    Z8EK$COMPARE
        16 001116   000000 011000                    NOP     0

      441    15609    4                                 %OP_GREATER_THAN_OR_EQUAL,
      442    15610    4                                 INDEX$,
      443    15611    4                                 COMPARISON$) ;
      444    15612
      445    15613    4              CALL Z8AT$CREATE_TEMPORARY (%PARA, NO_OVERFLOW$) ;

  15613 16 001117   200304 630500                    EPPR0   NO_OVERFLOW$,,AUTO
        16 001120   200431 450500                    STP0    LENGTH_ID2$+2,,AUTO
        16 001121   000014 236000 17                 LDQ     12
        16 001122   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 001123   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001124   000006 631400 17                 EPPR1   6
        16 001125   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        16 001126   000000 011000                    NOP     0

      446    15614    4              CALL Z8EK$BRANCH_TRUE (NO_OVERFLOW$, COMPARISON$) ;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:80   

  15614 16 001127   200307 630500                    EPPR0   COMPARISON$,,AUTO
        16 001130   200431 450500                    STP0    LENGTH_ID2$+2,,AUTO
        16 001131   200304 631500                    EPPR1   NO_OVERFLOW$,,AUTO
        16 001132   200430 451500                    STP1    LENGTH_ID2$+1,,AUTO
        16 001133   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001134   000006 631400 17                 EPPR1   6
        16 001135   000000 701000 xent               TSX1    Z8EK$BRANCH_TRUE
        16 001136   000000 011000                    NOP     0

      447    15615    4              CALL Z8ED$DISPOSE_ABSSYN_TREE (COMPARISON$) ;

  15615 16 001137   200307 630500                    EPPR0   COMPARISON$,,AUTO
        16 001140   200430 450500                    STP0    LENGTH_ID2$+1,,AUTO
        16 001141   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001142   000020 631400 17                 EPPR1   16
        16 001143   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        16 001144   000000 011000                    NOP     0

      448    15616
      449    15617    5              IF POINTER THEN DO ;

  15617 16 001145   200325 234100                    SZN     POINTER,,AUTO
        16 001146   001272 605000 16                 TPL     s:15686

      450    15618
      451    15619                     /* MOVE Length(id3)+1 TO id4 */
      452    15620
      453    15621    5                IF ID3_ST$ -> SCALAR.B.KANJI   THEN

  15621 16 001147   200274 470500                    LDP0    ID3_ST$,,AUTO
        16 001150   000003 236100                    LDQ     3,,PR0
        16 001151   001000 316007                    CANQ    512,DL
        16 001152   001252 600000 16                 TZE     s:15676

      454    15622    6                  DO;

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:81   
      455    15623
      456    15624                         %INIT_BINARY_OP( @POINTER = PLUS_ONE$,
      457    15625                                          @OP   = %OP_PLUS,
      458    15626                                          @LOP$ = LENGTH_ID3_P1$,
      459    15627                                          @ROP$ = ONE$ );

  15629 16 001153   000005 220003                    LDX0    5,DU
        16 001154   200312 471500                    LDP1    PLUS_ONE$,,AUTO
        16 001155   100000 740100                    STX0    0,,PR1

  15630 16 001156   000000 221003                    LDX1    0,DU
        16 001157   200312 471500                    LDP1    PLUS_ONE$,,AUTO
        16 001160   100000 441100                    SXL1    0,,PR1

  15637 16 001161   000133 235000 xsym               LDA     COMCOM+91
        16 001162   200312 471500                    LDP1    PLUS_ONE$,,AUTO
        16 001163   100005 755100                    STA     5,,PR1

  15638 16 001164   000134 235000 xsym               LDA     COMCOM+92
        16 001165   200312 471500                    LDP1    PLUS_ONE$,,AUTO
        16 001166   100006 755100                    STA     6,,PR1

  15639 16 001167   200313 236100                    LDQ     ONE$,,AUTO
        16 001170   200312 471500                    LDP1    PLUS_ONE$,,AUTO
        16 001171   100002 756100                    STQ     2,,PR1

  15640 16 001172   200316 236100                    LDQ     LENGTH_ID3_P1$,,AUTO
        16 001173   200312 471500                    LDP1    PLUS_ONE$,,AUTO
        16 001174   100001 756100                    STQ     1,,PR1

  15641 16 001175   000020 235007                    LDA     16,DL
        16 001176   200312 471500                    LDP1    PLUS_ONE$,,AUTO
        16 001177   100003 755100                    STA     3,,PR1

  15642 16 001200   000005 236000 17                 LDQ     5
        16 001201   200312 471500                    LDP1    PLUS_ONE$,,AUTO
        16 001202   100007 756100                    STQ     7,,PR1
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:82   

      460    15645
      461    15646                         %INIT_BINARY_OP( @POINTER = KANJI_LX_ETT$,
      462    15647                                          @OP   = %OP_SLASH,
      463    15648                                          @LOP$ = PLUS_ONE$,
      464    15649                                          @ROP$ = TWO$ );

  15651 16 001203   200310 471500                    LDP1    KANJI_LX_ETT$,,AUTO
        16 001204   100000 740100                    STX0    0,,PR1

  15652 16 001205   200310 471500                    LDP1    KANJI_LX_ETT$,,AUTO
        16 001206   100000 441100                    SXL1    0,,PR1

  15659 16 001207   000133 236000 xsym               LDQ     COMCOM+91
        16 001210   200310 471500                    LDP1    KANJI_LX_ETT$,,AUTO
        16 001211   100005 756100                    STQ     5,,PR1

  15660 16 001212   000134 236000 xsym               LDQ     COMCOM+92
        16 001213   200310 471500                    LDP1    KANJI_LX_ETT$,,AUTO
        16 001214   100006 756100                    STQ     6,,PR1

  15661 16 001215   200314 236100                    LDQ     TWO$,,AUTO
        16 001216   200310 471500                    LDP1    KANJI_LX_ETT$,,AUTO
        16 001217   100002 756100                    STQ     2,,PR1

  15662 16 001220   200312 236100                    LDQ     PLUS_ONE$,,AUTO
        16 001221   200310 471500                    LDP1    KANJI_LX_ETT$,,AUTO
        16 001222   100001 756100                    STQ     1,,PR1

  15663 16 001223   000023 236007                    LDQ     19,DL
        16 001224   200310 471500                    LDP1    KANJI_LX_ETT$,,AUTO
        16 001225   100003 756100                    STQ     3,,PR1

  15664 16 001226   000005 236000 17                 LDQ     5
        16 001227   200310 471500                    LDP1    KANJI_LX_ETT$,,AUTO
        16 001230   100007 756100                    STQ     7,,PR1

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:83   
      465    15667
      466    15668    6                    CALL Z8E5$MATH_PACK( KANJI_LX_ETT$,

  15668 16 001231   200310 631500                    EPPR1   KANJI_LX_ETT$,,AUTO
        16 001232   200431 451500                    STP1    LENGTH_ID2$+2,,AUTO
        16 001233   200310 633500                    EPPR3   KANJI_LX_ETT$,,AUTO
        16 001234   200430 453500                    STP3    LENGTH_ID2$+1,,AUTO
        16 001235   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001236   000006 631400 17                 EPPR1   6
        16 001237   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        16 001240   000000 011000                    NOP     0

      467    15669    6                                         KANJI_LX_ETT$ );
      468    15670
      469    15671    6                    CALL Z8E7$MOVE( ID4$,

  15671 16 001241   200310 630500                    EPPR0   KANJI_LX_ETT$,,AUTO
        16 001242   200431 450500                    STP0    LENGTH_ID2$+2,,AUTO
        16 001243   200273 631500                    EPPR1   ID4$,,AUTO
        16 001244   200430 451500                    STP1    LENGTH_ID2$+1,,AUTO
        16 001245   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001246   000006 631400 17                 EPPR1   6
        16 001247   000000 701000 xent               TSX1    Z8E7$MOVE
        16 001250   000000 011000                    NOP     0

      470    15672    6                                    KANJI_LX_ETT$ );
      471    15673    6                  END;

  15673 16 001251   001272 710000 16                 TRA     s:15686

      472    15674    5                ELSE
      473    15675    6                  DO;

      474    15676    6                    CALL Z8E5$MATH_PACK( LENGTH_ID3_P1$,

  15676 16 001252   200316 631500                    EPPR1   LENGTH_ID3_P1$,,AUTO
        16 001253   200431 451500                    STP1    LENGTH_ID2$+2,,AUTO
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:84   
        16 001254   200316 633500                    EPPR3   LENGTH_ID3_P1$,,AUTO
        16 001255   200430 453500                    STP3    LENGTH_ID2$+1,,AUTO
        16 001256   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001257   000006 631400 17                 EPPR1   6
        16 001260   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        16 001261   000000 011000                    NOP     0

      475    15677    6                                         LENGTH_ID3_P1$ );
      476    15678    6                    CALL Z8E7$MOVE( ID4$,

  15678 16 001262   200316 630500                    EPPR0   LENGTH_ID3_P1$,,AUTO
        16 001263   200431 450500                    STP0    LENGTH_ID2$+2,,AUTO
        16 001264   200273 631500                    EPPR1   ID4$,,AUTO
        16 001265   200430 451500                    STP1    LENGTH_ID2$+1,,AUTO
        16 001266   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001267   000006 631400 17                 EPPR1   6
        16 001270   000000 701000 xent               TSX1    Z8E7$MOVE
        16 001271   000000 011000                    NOP     0

      477    15679    6                                    LENGTH_ID3_P1$ );
      478    15680    6                  END;

      479    15681
      480    15682    5              END ; /* POINTER clause used */

      481    15683
      482    15684                   /* GO TO Overflow */
      483    15685
      484    15686    4              CALL Z8EK$BRANCH (OVERFLOW$) ;

  15686 16 001272   200303 630500                    EPPR0   OVERFLOW$,,AUTO
        16 001273   200430 450500                    STP0    LENGTH_ID2$+1,,AUTO
        16 001274   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001275   000020 631400 17                 EPPR1   16
        16 001276   000000 701000 xent               TSX1    Z8EK$BRANCH
        16 001277   000000 011000                    NOP     0

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:85   
      485    15687
      486    15688                   %NEW_ILL (@ID = %DEFLB, @LOP = NO_OVERFLOW$) ;

  16009 16 001300   000027 236000 17                 LDQ     23
        16 001301   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 001302   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001303   200435 450500                    STP0    LENGTH_ID2$+6,,AUTO
        16 001304   000030 236000 17                 LDQ     24
        16 001305   200434 756100                    STQ     LENGTH_ID2$+5,,AUTO
        16 001306   000032 237000 17                 LDAQ    26
        16 001307   200432 757100                    STAQ    LENGTH_ID2$+3,,AUTO
        16 001310   200432 630500                    EPPR0   LENGTH_ID2$+3,,AUTO
        16 001311   000015 631400 17                 EPPR1   13
        16 001312   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        16 001313   000000 011000                    NOP     0

  16018 16 001314   200304 236100                    LDQ     NO_OVERFLOW$,,AUTO
        16 001315   000000 470400 11                 LDP0    ILL$
        16 001316   000001 756100                    STQ     1,,PR0

      487    16067
      488    16068    5              IF POINTER OR ID1_COUNT ~= ID1_MAX THEN DO ;

  16068 16 001317   200325 234100                    SZN     POINTER,,AUTO
        16 001320   001324 604000 16                 TMI     s:16077
        16 001321   200333 236100                    LDQ     ID1_COUNT,,AUTO
        16 001322   200334 116100                    CMPQ    ID1_MAX,,AUTO
        16 001323   001474 600000 16                 TZE     s:16157

      489    16069
      490    16070                     /* ADD Index(id1,id2) TO id4 */
      491    16071
      492    16072                     %INIT_BINARY_OP (@POINTER = ADD$,
      493    16073                                      @OP      = %OP_PLUS,
      494    16074                                      @LOP$    = ID4$,
      495    16075                                      @ROP$    = INDEX$) ;

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:86   
  16077 16 001324   000005 220003                    LDX0    5,DU
        16 001325   200315 471500                    LDP1    ADD$,,AUTO
        16 001326   100000 740100                    STX0    0,,PR1

  16078 16 001327   000000 221003                    LDX1    0,DU
        16 001330   200315 470500                    LDP0    ADD$,,AUTO
        16 001331   000000 441100                    SXL1    0,,PR0

  16085 16 001332   000133 235000 xsym               LDA     COMCOM+91
        16 001333   200315 470500                    LDP0    ADD$,,AUTO
        16 001334   000005 755100                    STA     5,,PR0

  16086 16 001335   000134 235000 xsym               LDA     COMCOM+92
        16 001336   200315 470500                    LDP0    ADD$,,AUTO
        16 001337   000006 755100                    STA     6,,PR0

  16087 16 001340   200321 236100                    LDQ     INDEX$,,AUTO
        16 001341   200315 470500                    LDP0    ADD$,,AUTO
        16 001342   000002 756100                    STQ     2,,PR0

  16088 16 001343   200273 236100                    LDQ     ID4$,,AUTO
        16 001344   200315 470500                    LDP0    ADD$,,AUTO
        16 001345   000001 756100                    STQ     1,,PR0

  16089 16 001346   000020 235007                    LDA     16,DL
        16 001347   200315 470500                    LDP0    ADD$,,AUTO
        16 001350   000003 755100                    STA     3,,PR0

  16090 16 001351   000005 236000 17                 LDQ     5
        16 001352   200315 470500                    LDP0    ADD$,,AUTO
        16 001353   000007 756100                    STQ     7,,PR0

      496    16093
      497    16094    5                IF ID3_ST$ -> SCALAR.B.KANJI   THEN

  16094 16 001354   200274 470500                    LDP0    ID3_ST$,,AUTO
        16 001355   000003 236100                    LDQ     3,,PR0
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:87   
        16 001356   001000 316007                    CANQ    512,DL
        16 001357   001454 600000 16                 TZE     s:16148

      498    16095    6                  DO;

      499    16096
      500    16097                         %INIT_BINARY_OP( @POINTER = PLUS_ONE$,
      501    16098                                          @OP   = %OP_PLUS,
      502    16099                                          @LOP$ = ADD$,
      503    16100                                          @ROP$ = ONE$ );

  16102 16 001360   200312 471500                    LDP1    PLUS_ONE$,,AUTO
        16 001361   100000 740100                    STX0    0,,PR1

  16103 16 001362   200312 471500                    LDP1    PLUS_ONE$,,AUTO
        16 001363   100000 441100                    SXL1    0,,PR1

  16110 16 001364   000133 236000 xsym               LDQ     COMCOM+91
        16 001365   200312 471500                    LDP1    PLUS_ONE$,,AUTO
        16 001366   100005 756100                    STQ     5,,PR1

  16111 16 001367   000134 236000 xsym               LDQ     COMCOM+92
        16 001370   200312 471500                    LDP1    PLUS_ONE$,,AUTO
        16 001371   100006 756100                    STQ     6,,PR1

  16112 16 001372   200313 236100                    LDQ     ONE$,,AUTO
        16 001373   200312 471500                    LDP1    PLUS_ONE$,,AUTO
        16 001374   100002 756100                    STQ     2,,PR1

  16113 16 001375   200315 236100                    LDQ     ADD$,,AUTO
        16 001376   200312 471500                    LDP1    PLUS_ONE$,,AUTO
        16 001377   100001 756100                    STQ     1,,PR1

  16114 16 001400   200312 471500                    LDP1    PLUS_ONE$,,AUTO
        16 001401   100003 755100                    STA     3,,PR1

  16115 16 001402   000005 236000 17                 LDQ     5
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:88   
        16 001403   200312 471500                    LDP1    PLUS_ONE$,,AUTO
        16 001404   100007 756100                    STQ     7,,PR1

      504    16118
      505    16119                         %INIT_BINARY_OP( @POINTER = KANJI_LX_ETT$,
      506    16120                                          @OP   = %OP_SLASH,
      507    16121                                          @LOP$ = PLUS_ONE$,
      508    16122                                          @ROP$ = TWO$ );

  16124 16 001405   200310 471500                    LDP1    KANJI_LX_ETT$,,AUTO
        16 001406   100000 740100                    STX0    0,,PR1

  16125 16 001407   200310 471500                    LDP1    KANJI_LX_ETT$,,AUTO
        16 001410   100000 441100                    SXL1    0,,PR1

  16132 16 001411   000133 236000 xsym               LDQ     COMCOM+91
        16 001412   200310 471500                    LDP1    KANJI_LX_ETT$,,AUTO
        16 001413   100005 756100                    STQ     5,,PR1

  16133 16 001414   000134 236000 xsym               LDQ     COMCOM+92
        16 001415   200310 471500                    LDP1    KANJI_LX_ETT$,,AUTO
        16 001416   100006 756100                    STQ     6,,PR1

  16134 16 001417   200314 236100                    LDQ     TWO$,,AUTO
        16 001420   200310 471500                    LDP1    KANJI_LX_ETT$,,AUTO
        16 001421   100002 756100                    STQ     2,,PR1

  16135 16 001422   200312 236100                    LDQ     PLUS_ONE$,,AUTO
        16 001423   200310 471500                    LDP1    KANJI_LX_ETT$,,AUTO
        16 001424   100001 756100                    STQ     1,,PR1

  16136 16 001425   000023 236007                    LDQ     19,DL
        16 001426   200310 471500                    LDP1    KANJI_LX_ETT$,,AUTO
        16 001427   100003 756100                    STQ     3,,PR1

  16137 16 001430   000005 236000 17                 LDQ     5
        16 001431   200310 471500                    LDP1    KANJI_LX_ETT$,,AUTO
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:89   
        16 001432   100007 756100                    STQ     7,,PR1

      509    16140
      510    16141    6                    CALL Z8E5$MATH_PACK( KANJI_LX_ETT$,

  16141 16 001433   200310 631500                    EPPR1   KANJI_LX_ETT$,,AUTO
        16 001434   200431 451500                    STP1    LENGTH_ID2$+2,,AUTO
        16 001435   200310 633500                    EPPR3   KANJI_LX_ETT$,,AUTO
        16 001436   200430 453500                    STP3    LENGTH_ID2$+1,,AUTO
        16 001437   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001440   000006 631400 17                 EPPR1   6
        16 001441   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        16 001442   000000 011000                    NOP     0

      511    16142    6                                         KANJI_LX_ETT$ );
      512    16143    6                    CALL Z8E7$MOVE( ID4$,

  16143 16 001443   200310 630500                    EPPR0   KANJI_LX_ETT$,,AUTO
        16 001444   200431 450500                    STP0    LENGTH_ID2$+2,,AUTO
        16 001445   200273 631500                    EPPR1   ID4$,,AUTO
        16 001446   200430 451500                    STP1    LENGTH_ID2$+1,,AUTO
        16 001447   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001450   000006 631400 17                 EPPR1   6
        16 001451   000000 701000 xent               TSX1    Z8E7$MOVE
        16 001452   000000 011000                    NOP     0

      513    16144    6                                    KANJI_LX_ETT$ );
      514    16145    6                  END;

  16145 16 001453   001474 710000 16                 TRA     s:16157

      515    16146    5                ELSE
      516    16147    6                  DO;

      517    16148    6                    CALL Z8E5$MATH_PACK( ADD$, ADD$ );

  16148 16 001454   200315 631500                    EPPR1   ADD$,,AUTO
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:90   
        16 001455   200431 451500                    STP1    LENGTH_ID2$+2,,AUTO
        16 001456   200315 633500                    EPPR3   ADD$,,AUTO
        16 001457   200430 453500                    STP3    LENGTH_ID2$+1,,AUTO
        16 001460   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001461   000006 631400 17                 EPPR1   6
        16 001462   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        16 001463   000000 011000                    NOP     0

      518    16149    6                    CALL Z8E7$MOVE( ID4$, ADD$ );

  16149 16 001464   200315 630500                    EPPR0   ADD$,,AUTO
        16 001465   200431 450500                    STP0    LENGTH_ID2$+2,,AUTO
        16 001466   200273 631500                    EPPR1   ID4$,,AUTO
        16 001467   200430 451500                    STP1    LENGTH_ID2$+1,,AUTO
        16 001470   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001471   000006 631400 17                 EPPR1   6
        16 001472   000000 701000 xent               TSX1    Z8E7$MOVE
        16 001473   000000 011000                    NOP     0

      519    16150    6                  END;

      520    16151
      521    16152    5              END ; /* POINTER clause or this is not the last ID1 */

      522    16153
      523    16154
      524    16155
      525    16156
      526    16157    4              IDENTS$ = IDENTS$ -> LX_ITEM.LINK;

  16157 16 001474   200023 470500                    LDP0    IDENTS$,,AUTO
        16 001475   000007 236100                    LDQ     7,,PR0
        16 001476   200023 756100                    STQ     IDENTS$,,AUTO

      527    16158    4            END /* Until */;

  16158 16 001477   000005 116000 17                 CMPQ    5
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:91   
        16 001500   000346 601000 16                 TNZ     s:15366

      528    16159
      529    16160    3            STRINGS$ = STRINGS$ -> LX_LIST.LINK;

  16160 16 001501   200022 470500                    LDP0    STRINGS$,,AUTO
        16 001502   000007 236100                    LDQ     7,,PR0
        16 001503   200022 756100                    STQ     STRINGS$,,AUTO

      530    16161    3          END /* Until */;

  16161 16 001504   000005 116000 17                 CMPQ    5
        16 001505   000333 601000 16                 TNZ     s:15361

      531    16162
      532    16163               /*  Add NOT OVERFLOW if needed  */
      533    16164
      534    16165    2          IF NOT_ON_OVERFLOW$ ~= ADDR(NIL)    THEN

  16165 16 001506   200007 470500                    LDP0    @NOT_ON_OVERFLOW$,,AUTO
        16 001507   000000 236100                    LDQ     0,,PR0
        16 001510   000005 116000 17                 CMPQ    5
        16 001511   001532 600000 16                 TZE     s:16189

      535    16166    3            DO;

      536    16167                   %APPEND_ILS_LIST( @FROM$ = NOT_ON_OVERFLOW$,
      537    16168                                     @TO$ = "ADDR(O1COM.ILS_LIST)" );

  16174 16 001512   000000 471500                    LDP1    0,,PR0
        16 001513   100001 236100                    LDQ     1,,PR1
        16 001514   000005 116000 17                 CMPQ    5
        16 001515   001532 600000 16                 TZE     s:16189

  16175 16 001516   000017 236000 xsym               LDQ     O1COM+15
        16 001517   000005 116000 17                 CMPQ    5
        16 001520   001524 601000 16                 TNZ     s:16179
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:92   

  16176 16 001521   100001 236100                    LDQ     1,,PR1
        16 001522   000017 756000 xsym               STQ     O1COM+15

  16177 16 001523   001527 710000 16                 TRA     s:16181

  16179 16 001524   100001 236100                    LDQ     1,,PR1
        16 001525   000020 473400 xsym               LDP3    O1COM+16
        16 001526   300002 756100                    STQ     2,,PR3

  16181 16 001527   000000 471500                    LDP1    0,,PR0
        16 001530   100002 236100                    LDQ     2,,PR1
        16 001531   000020 756000 xsym               STQ     O1COM+16

      538    16185    3            END;

      539    16186
      540    16187               /* GO TO END_STRING */
      541    16188
      542    16189    2          IF ON_OVERFLOW$ ~= ADDR(NIL)    THEN

  16189 16 001532   200006 471500                    LDP1    @ON_OVERFLOW$,,AUTO
        16 001533   100000 236100                    LDQ     0,,PR1
        16 001534   000005 116000 17                 CMPQ    5
        16 001535   001544 600000 16                 TZE     s:16514

      543    16190    2            CALL Z8EK$BRANCH (END_STRING$) ;

  16190 16 001536   200305 633500                    EPPR3   END_STRING$,,AUTO
        16 001537   200430 453500                    STP3    LENGTH_ID2$+1,,AUTO
        16 001540   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001541   000020 631400 17                 EPPR1   16
        16 001542   000000 701000 xent               TSX1    Z8EK$BRANCH
        16 001543   000000 011000                    NOP     0

      544    16191
      545    16192               %NEW_ILL( @ID        = %DEFLB ,
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:93   
      546    16193                         @LOP       = OVERFLOW$ );

  16514 16 001544   000027 236000 17                 LDQ     23
        16 001545   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 001546   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001547   200435 450500                    STP0    LENGTH_ID2$+6,,AUTO
        16 001550   000030 236000 17                 LDQ     24
        16 001551   200434 756100                    STQ     LENGTH_ID2$+5,,AUTO
        16 001552   000032 237000 17                 LDAQ    26
        16 001553   200432 757100                    STAQ    LENGTH_ID2$+3,,AUTO
        16 001554   200432 630500                    EPPR0   LENGTH_ID2$+3,,AUTO
        16 001555   000015 631400 17                 EPPR1   13
        16 001556   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        16 001557   000000 011000                    NOP     0

  16523 16 001560   200303 236100                    LDQ     OVERFLOW$,,AUTO
        16 001561   000000 470400 11                 LDP0    ILL$
        16 001562   000001 756100                    STQ     1,,PR0

      547    16572
      548    16573    2          IF ON_OVERFLOW$ ~= ADDR(NIL)   THEN

  16573 16 001563   200006 471500                    LDP1    @ON_OVERFLOW$,,AUTO
        16 001564   100000 236100                    LDQ     0,,PR1
        16 001565   000005 116000 17                 CMPQ    5
        16 001566   001626 600000 16                 TZE     BAD_STRING

      549    16574    3            DO;

      550    16575                   %APPEND_ILS_LIST( @FROM$ = ON_OVERFLOW$,
      551    16576                                     @TO$   = "ADDR(O1COM.ILS_LIST)");

  16582 16 001567   100000 473500                    LDP3    0,,PR1
        16 001570   300001 236100                    LDQ     1,,PR3
        16 001571   000005 116000 17                 CMPQ    5
        16 001572   001607 600000 16                 TZE     s:16916

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:94   
  16583 16 001573   000017 236000 xsym               LDQ     O1COM+15
        16 001574   000005 116000 17                 CMPQ    5
        16 001575   001601 601000 16                 TNZ     s:16587

  16584 16 001576   300001 236100                    LDQ     1,,PR3
        16 001577   000017 756000 xsym               STQ     O1COM+15

  16585 16 001600   001604 710000 16                 TRA     s:16589

  16587 16 001601   300001 236100                    LDQ     1,,PR3
        16 001602   000020 474400 xsym               LDP4    O1COM+16
        16 001603   400002 756100                    STQ     2,,PR4

  16589 16 001604   100000 473500                    LDP3    0,,PR1
        16 001605   300002 236100                    LDQ     2,,PR3
        16 001606   000020 756000 xsym               STQ     O1COM+16

      552    16593
      553    16594                   %NEW_ILL( @ID     = %DEFLB ,
      554    16595                             @LOP    = END_STRING$ );

  16916 16 001607   000027 236000 17                 LDQ     23
        16 001610   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 001611   200430 633500                    EPPR3   LENGTH_ID2$+1,,AUTO
        16 001612   200435 453500                    STP3    LENGTH_ID2$+6,,AUTO
        16 001613   000030 236000 17                 LDQ     24
        16 001614   200434 756100                    STQ     LENGTH_ID2$+5,,AUTO
        16 001615   000032 237000 17                 LDAQ    26
        16 001616   200432 757100                    STAQ    LENGTH_ID2$+3,,AUTO
        16 001617   200432 630500                    EPPR0   LENGTH_ID2$+3,,AUTO
        16 001620   000015 631400 17                 EPPR1   13
        16 001621   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        16 001622   000000 011000                    NOP     0

  16925 16 001623   200305 236100                    LDQ     END_STRING$,,AUTO
        16 001624   000000 470400 11                 LDP0    ILL$
        16 001625   000001 756100                    STQ     1,,PR0
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:95   

      555    16974    3            END;

      556    16975
      557    16976    2        END ; /* Not Optimizable */

  16925 16 001626   003353 710000 16    BAD_STRING   TRA     s:19065

      558    16977
      559    16978    1   BAD_STRING:;
      560    16979
      561    16980        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:96   
      562    16981
      563    16982        /*I*   NAME: MOVE
      564    16983
      565    16984        DESCRIPTION: Move id1$ to Substring (id3$, offset, length).
      566    16985
      567    16986        */
      568    16987
      569    16988    1   MOVE: PROC (ID3$, ID1$, LENGTH, OFFSET) ;

  16988 16 001627   200336 741300       MOVE         STX1  ! OP+1,,AUTO

      570    16989
      571    16990    2        DCL  ID3$               PTR ;
      572    16991    2        DCL  ID1$               PTR ;
      573    16992    2        DCL  OFFSET             SBIN WORD ;
      574    16993    2        DCL  LENGTH             SBIN WORD ;
      575    16994    2        DCL  RESULT$            PTR ;
      576    16995    2        DCL  ORIGINAL_ID3_ETT$  PTR ;
      577    16996    2        DCL  FISS_LENGTH        SBIN WORD ;
      578    16997
      579    16998    2        ORIGINAL_ID3_ETT$ = ID3$ -> LX_ETT_ITEM.ETT$ ;

  16998 16 001630   200337 470500                    LDP0    @ID3$,,AUTO
        16 001631   000000 471500                    LDP1    0,,PR0
        16 001632   100001 236100                    LDQ     1,,PR1
        16 001633   200344 756100                    STQ     ORIGINAL_ID3_ETT$,,AUTO

      580    16999
      581    17000    3        IF OFFSET ~= 0 THEN DO ;

  17000 16 001634   200342 473500                    LDP3    @OFFSET,,AUTO
        16 001635   300000 235100                    LDA     0,,PR3
        16 001636   001655 600000 16                 TZE     s:17010

      582    17001
      583    17002    3          CALL Z8AF$NEW_OFF (ID3$ -> LX_ETT_ITEM.ETT$,

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:97   
  17002 16 001637   200343 634500                    EPPR4   RESULT$,,AUTO
        16 001640   200432 454500                    STP4    LENGTH_ID2$+3,,AUTO
        16 001641   200342 236100                    LDQ     @OFFSET,,AUTO
        16 001642   200431 756100                    STQ     LENGTH_ID2$+2,,AUTO
        16 001643   100001 635500                    EPPR5   1,,PR1
        16 001644   200430 455500                    STP5    LENGTH_ID2$+1,,AUTO
        16 001645   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001646   000000 631400 17                 EPPR1   0
        16 001647   000000 701000 xent               TSX1    Z8AF$NEW_OFF
        16 001650   000000 011000                    NOP     0

      584    17003    3                             OFFSET,
      585    17004    3                             RESULT$) ;
      586    17005    3          ID3$ -> LX_ETT_ITEM.ETT$ = RESULT$ ;

  17005 16 001651   200337 470500                    LDP0    @ID3$,,AUTO
        16 001652   000000 471500                    LDP1    0,,PR0
        16 001653   200343 236100                    LDQ     RESULT$,,AUTO
        16 001654   100001 756100                    STQ     1,,PR1

      587    17006
      588    17007    3        END ; /* Offset <> 0 */

      589    17008
      590    17009
      591    17010    2        IF ID3_LENGTH - OFFSET < LENGTH

  17010 16 001655   200342 471500                    LDP1    @OFFSET,,AUTO
        16 001656   200332 236100                    LDQ     ID3_LENGTH,,AUTO
        16 001657   100000 136100                    SBLQ    0,,PR1
        16 001660   200341 473500                    LDP3    @LENGTH,,AUTO
        16 001661   300000 116100                    CMPQ    0,,PR3
        16 001662   001667 605000 16                 TPL     s:17012

      592    17011    2        THEN FISS_LENGTH = ID3_LENGTH - OFFSET ;

  17011 16 001663   200332 236100                    LDQ     ID3_LENGTH,,AUTO
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:98   
        16 001664   100000 136100                    SBLQ    0,,PR1
        16 001665   200345 756100                    STQ     FISS_LENGTH,,AUTO
        16 001666   001671 710000 16                 TRA     s:17013

      593    17012    2        ELSE FISS_LENGTH = LENGTH ;

  17012 16 001667   300000 235100                    LDA     0,,PR3
        16 001670   200345 755100                    STA     FISS_LENGTH,,AUTO

      594    17013    2        CALL Z8AF$NEW_FISS (ID3$ -> LX_ETT_ITEM.ETT$,

  17013 16 001671   000000 474500                    LDP4    0,,PR0
        16 001672   200343 635500                    EPPR5   RESULT$,,AUTO
        16 001673   200433 455500                    STP5    LENGTH_ID2$+4,,AUTO
        16 001674   000035 236000 17                 LDQ     29
        16 001675   200432 756100                    STQ     LENGTH_ID2$+3,,AUTO
        16 001676   200345 636500                    EPPR6   FISS_LENGTH,,AUTO
        16 001677   200431 456500                    STP6    LENGTH_ID2$+2,,AUTO
        16 001700   400001 637500                    EPPR7   1,,PR4
        16 001701   200430 457500                    STP7    LENGTH_ID2$+1,,AUTO
        16 001702   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 001703   000015 631400 17                 EPPR1   13
        16 001704   000000 701000 xent               TSX1    Z8AF$NEW_FISS
        16 001705   000000 011000                    NOP     0

      595    17014    2                            FISS_LENGTH,
      596    17015    2                            %ALPHA_NUMERIC_FISS,
      597    17016    2                            RESULT$) ;
      598    17017    2        ID3$ -> LX_ETT_ITEM.ETT$ = RESULT$ ;

  17017 16 001706   200337 470500                    LDP0    @ID3$,,AUTO
        16 001707   000000 471500                    LDP1    0,,PR0
        16 001710   200343 236100                    LDQ     RESULT$,,AUTO
        16 001711   100001 756100                    STQ     1,,PR1

      599    17018
      600    17019    2        CALL Z8E7$MOVE (ID3$, ID1$) ;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:99   

  17019 16 001712   200337 630500                    EPPR0   @ID3$,,AUTO
        16 001713   000006 631400 17                 EPPR1   6
        16 001714   000000 701000 xent               TSX1    Z8E7$MOVE
        16 001715   000000 011000                    NOP     0

      601    17020
      602    17021    2        ID3$ -> LX_ETT_ITEM.ETT$ = ORIGINAL_ID3_ETT$ ;

  17021 16 001716   200337 470500                    LDP0    @ID3$,,AUTO
        16 001717   000000 471500                    LDP1    0,,PR0
        16 001720   200344 236100                    LDQ     ORIGINAL_ID3_ETT$,,AUTO
        16 001721   100001 756100                    STQ     1,,PR1

      603    17022    2        OFFSET = OFFSET + LENGTH ; /* ready for next call to MOVE */

  17022 16 001722   200342 471500                    LDP1    @OFFSET,,AUTO
        16 001723   200341 473500                    LDP3    @LENGTH,,AUTO
        16 001724   100000 236100                    LDQ     0,,PR1
        16 001725   300000 036100                    ADLQ    0,,PR3
        16 001726   100000 756100                    STQ     0,,PR1

      604    17023
      605    17024    2   END MOVE ;

  17024 16 001727   200336 221300                    LDX1  ! OP+1,,AUTO
        16 001730   000001 702211                    TSX2  ! 1,X1

      606    17025
      607    17026        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:100  
      608    17027        /*I*   NAME: VALIDATE_IDn, n = 1 -> 4
      609    17028
      610    17029        DESCRIPTION: These routines are used by Pass 2 of Z8EZ$STRING.
      611    17030                     They validate the semantics of each identifier.
      612    17031
      613    17032        */
      614    17033
      615    17034        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:101  
      616    17035    1   VALIDATE_ID1: PROC (ID1$) ALTRET;

  17035 16 001731   200336 741300       VALIDATE_ID1 STX1  ! OP+1,,AUTO

      617    17036
      618    17037    2        DCL ID1$    PTR;
      619    17038
      620    17039    2        IF ID1$ -> LX_ITEM.ID = %LX_ETT_ITEM THEN        /*#31090*/

  17039 16 001732   200337 470500                    LDP0    @ID1$,,AUTO
        16 001733   000000 471500                    LDP1    0,,PR0
        16 001734   100000 220100                    LDX0    0,,PR1
        16 001735   000004 100003                    CMPX0   4,DU
        16 001736   001745 601000 16                 TNZ     s:17044

      621    17040    2          IF ID1$ -> LX_ETT_ITEM.TYPE ~= %TYA

  17040 16 001737   100004 235100                    LDA     4,,PR1
        16 001740   000010 115007                    CMPA    8,DL
        16 001741   001745 600000 16                 TZE     s:17044
        16 001742   000016 115007                    CMPA    14,DL
        16 001743   001745 600000 16                 TZE     s:17044

      622    17041    2          AND ID1$ -> LX_ETT_ITEM.TYPE ~= %TYN
      623    17042    2          THEN OPTIMIZABLE = FALSE ;

  17042 16 001744   200330 450100                    STZ     OPTIMIZABLE,,AUTO

      624    17043
      625    17044    2        CALL Z8CO$DISPL_CHECK(ID1$) ALTRET(BAD);

  17044 16 001745   200337 630500                    EPPR0   @ID1$,,AUTO
        16 001746   000020 631400 17                 EPPR1   16
        16 001747   000000 701000 xent               TSX1    Z8CO$DISPL_CHECK
        16 001750   002036 702000 16                 TSX2    BAD

      626    17045
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:102  
      627    17046    3        IF ID1$ -> LX_ITEM.ID = %LX_ETT_ITEM THEN DO ;

  17046 16 001751   200337 470500                    LDP0    @ID1$,,AUTO
        16 001752   000000 471500                    LDP1    0,,PR0
        16 001753   100000 220100                    LDX0    0,,PR1
        16 001754   000004 100003                    CMPX0   4,DU
        16 001755   002034 601000 16                 TNZ     s:17059

      628    17047    4          DO CASE(ID1$ -> LX_ETT_ITEM.TYPE);

  17047 16 001756   100004 235100                    LDA     4,,PR1
        16 001757   000024 115007                    CMPA    20,DL
        16 001760   001762 602005 16                 TNC     s:17047+4,AL
        16 001761   002016 710000 16                 TRA     s:17053
        16 001762   002006 710000 16                 TRA     s:17049
        16 001763   002016 710000 16                 TRA     s:17053
        16 001764   002016 710000 16                 TRA     s:17053
        16 001765   002006 710000 16                 TRA     s:17049
        16 001766   002016 710000 16                 TRA     s:17053
        16 001767   002016 710000 16                 TRA     s:17053
        16 001770   002016 710000 16                 TRA     s:17053
        16 001771   002016 710000 16                 TRA     s:17053
        16 001772   002016 710000 16                 TRA     s:17053
        16 001773   002016 710000 16                 TRA     s:17053
        16 001774   002016 710000 16                 TRA     s:17053
        16 001775   002006 710000 16                 TRA     s:17049
        16 001776   002016 710000 16                 TRA     s:17053
        16 001777   002016 710000 16                 TRA     s:17053
        16 002000   002016 710000 16                 TRA     s:17053
        16 002001   002016 710000 16                 TRA     s:17053
        16 002002   002016 710000 16                 TRA     s:17053
        16 002003   002016 710000 16                 TRA     s:17053
        16 002004   002016 710000 16                 TRA     s:17053
        16 002005   002006 710000 16                 TRA     s:17049

      629    17048    4            CASE(%TYD, %TYO, %TYF, %TYC);

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:103  
      630    17049    4              CALL INTEGER_CHECK(ID1$);

  17049 16 002006   200337 236100                    LDQ     @ID1$,,AUTO
        16 002007   200341 756100                    STQ     @LENGTH,,AUTO
        16 002010   002353 701000 16                 TSX1    INTEGER_CHECK
        16 002011   000000 011000                    NOP     0

      631    17050    4              CALL Z8CO$P_CHECK(ID1$) ALTRET(BAD);

  17050 16 002012   200337 630500                    EPPR0   @ID1$,,AUTO
        16 002013   000020 631400 17                 EPPR1   16
        16 002014   000000 701000 xent               TSX1    Z8CO$P_CHECK
        16 002015   002036 702000 16                 TSX2    BAD

      632    17051    4          END /* Case */;

      633    17052
      634    17053    3          CALL Z8AU$TYPE_DESCRIPTOR (ID1$ -> LX_ETT_ITEM.ETT$,

  17053 16 002016   200337 470500                    LDP0    @ID1$,,AUTO
        16 002017   000000 471500                    LDP1    0,,PR0
        16 002020   200264 633500                    EPPR3   TYPE_DESC,,AUTO
        16 002021   200431 453500                    STP3    LENGTH_ID2$+2,,AUTO
        16 002022   100001 634500                    EPPR4   1,,PR1
        16 002023   200430 454500                    STP4    LENGTH_ID2$+1,,AUTO
        16 002024   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 002025   000006 631400 17                 EPPR1   6
        16 002026   000000 701000 xent               TSX1    Z8AU$TYPE_DESCRIPTOR
        16 002027   000000 011000                    NOP     0

      635    17054    3                                     TYPE_DESC) ;
      636    17055    3          IF TYPE_DESC.SIZ$ ~= ADDR(NIL)

  17055 16 002030   200266 236100                    LDQ     TYPE_DESC+2,,AUTO
        16 002031   000005 116000 17                 CMPQ    5
        16 002032   002034 600000 16                 TZE     s:17059

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:104  
      637    17056    3          THEN OPTIMIZABLE = FALSE ;

  17056 16 002033   200330 450100                    STZ     OPTIMIZABLE,,AUTO

      638    17057    3        END ;

      639    17058
      640    17059    2        RETURN;

  17059 16 002034   200336 221300                    LDX1  ! OP+1,,AUTO
        16 002035   000001 702211                    TSX2  ! 1,X1

      641    17060
      642    17061    2   BAD:
      643    17062    2        ALTRETURN;

  17062 16 002036   200336 221300       BAD          LDX1  ! OP+1,,AUTO
        16 002037   000000 702211                    TSX2  ! 0,X1

      644    17063
      645    17064    2   END VALIDATE_ID1;
      646    17065        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:105  
      647    17066    1   VALIDATE_ID2: PROC (ID2$) ALTRET;

  17066 16 002040   200336 741300       VALIDATE_ID2 STX1  ! OP+1,,AUTO

      648    17067
      649    17068    2        DCL ID2$    PTR;
      650    17069
      651    17070
      652    17071    2        SIZE = FALSE;

  17071 16 002041   200327 450100                    STZ     SIZE,,AUTO

      653    17072
      654    17073    2        IF ID2$ -> LX_ITEM.ID = %LX_TERMINAL THEN

  17073 16 002042   200337 470500                    LDP0    @ID2$,,AUTO
        16 002043   000000 471500                    LDP1    0,,PR0
        16 002044   100000 220100                    LDX0    0,,PR1
        16 002045   002053 601000 16                 TNZ     s:17077

      655    17074    2          IF ID2$ -> LX_TERMINAL.SYMBOL = %RSV_WRD_SIZE THEN

  17074 16 002046   100003 235100                    LDA     3,,PR1
        16 002047   000643 115007                    CMPA    419,DL
        16 002050   002053 601000 16                 TNZ     s:17077

      656    17075    2            SIZE = TRUE;

  17075 16 002051   400000 236003                    LDQ     -131072,DU
        16 002052   200327 756100                    STQ     SIZE,,AUTO

      657    17076
      658    17077    2        IF NOT SIZE THEN

  17077 16 002053   200327 234100                    SZN     SIZE,,AUTO
        16 002054   002127 604000 16                 TMI     s:17090

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:106  
      659    17078    3          DO;

      660    17079    3            OPTIMIZABLE = FALSE ;

  17079 16 002055   200330 450100                    STZ     OPTIMIZABLE,,AUTO

      661    17080    3            CALL Z8CO$DISPL_CHECK(ID2$) ALTRET(BAD);

  17080 16 002056   200337 630500                    EPPR0   @ID2$,,AUTO
        16 002057   000020 631400 17                 EPPR1   16
        16 002060   000000 701000 xent               TSX1    Z8CO$DISPL_CHECK
        16 002061   002131 702000 16                 TSX2    BAD

      662    17081
      663    17082    3            IF ID2$ -> LX_ITEM.ID = %LX_ETT_ITEM THEN

  17082 16 002062   200337 470500                    LDP0    @ID2$,,AUTO
        16 002063   000000 471500                    LDP1    0,,PR0
        16 002064   100000 220100                    LDX0    0,,PR1
        16 002065   000004 100003                    CMPX0   4,DU
        16 002066   002127 601000 16                 TNZ     s:17090

      664    17083    4              DO CASE(ID2$ -> LX_ETT_ITEM.TYPE);

  17083 16 002067   100004 235100                    LDA     4,,PR1
        16 002070   000024 115007                    CMPA    20,DL
        16 002071   002073 602005 16                 TNC     s:17083+4,AL
        16 002072   002127 710000 16                 TRA     s:17090
        16 002073   002117 710000 16                 TRA     s:17085
        16 002074   002127 710000 16                 TRA     s:17090
        16 002075   002127 710000 16                 TRA     s:17090
        16 002076   002117 710000 16                 TRA     s:17085
        16 002077   002127 710000 16                 TRA     s:17090
        16 002100   002127 710000 16                 TRA     s:17090
        16 002101   002127 710000 16                 TRA     s:17090
        16 002102   002127 710000 16                 TRA     s:17090
        16 002103   002127 710000 16                 TRA     s:17090
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:107  
        16 002104   002127 710000 16                 TRA     s:17090
        16 002105   002127 710000 16                 TRA     s:17090
        16 002106   002117 710000 16                 TRA     s:17085
        16 002107   002127 710000 16                 TRA     s:17090
        16 002110   002127 710000 16                 TRA     s:17090
        16 002111   002127 710000 16                 TRA     s:17090
        16 002112   002127 710000 16                 TRA     s:17090
        16 002113   002127 710000 16                 TRA     s:17090
        16 002114   002127 710000 16                 TRA     s:17090
        16 002115   002127 710000 16                 TRA     s:17090
        16 002116   002117 710000 16                 TRA     s:17085

      665    17084    4                CASE(%TYD, %TYO, %TYF, %TYC);

      666    17085    4                  CALL INTEGER_CHECK(ID2$);

  17085 16 002117   200337 236100                    LDQ     @ID2$,,AUTO
        16 002120   200341 756100                    STQ     @LENGTH,,AUTO
        16 002121   002353 701000 16                 TSX1    INTEGER_CHECK
        16 002122   000000 011000                    NOP     0

      667    17086    4                  CALL Z8CO$P_CHECK(ID2$) ALTRET(BAD);

  17086 16 002123   200337 630500                    EPPR0   @ID2$,,AUTO
        16 002124   000020 631400 17                 EPPR1   16
        16 002125   000000 701000 xent               TSX1    Z8CO$P_CHECK
        16 002126   002131 702000 16                 TSX2    BAD

      668    17087    4              END /* Case */;

      669    17088    3          END;

      670    17089
      671    17090    2        RETURN;

  17090 16 002127   200336 221300                    LDX1  ! OP+1,,AUTO
        16 002130   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:108  

      672    17091
      673    17092    2   BAD:
      674    17093    2        ALTRETURN;

  17093 16 002131   200336 221300       BAD          LDX1  ! OP+1,,AUTO
        16 002132   000000 702211                    TSX2  ! 0,X1

      675    17094
      676    17095
      677    17096    2   END VALIDATE_ID2;
      678    17097        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:109  
      679    17098    1   VALIDATE_ID3: PROC (ID3$) ALTRET;

  17098 16 002133   200336 741300       VALIDATE_ID3 STX1  ! OP+1,,AUTO

      680    17099
      681    17100    2        DCL ID3$                PTR;
      682    17101    2        DCL ST$$                PTR;
      683    17102
      684    17103    2        IF ID3$ -> LX_ETT_ITEM.TYPE ~= %TYA

  17103 16 002134   200337 470500                    LDP0    @ID3$,,AUTO
        16 002135   000000 471500                    LDP1    0,,PR0
        16 002136   100004 235100                    LDA     4,,PR1
        16 002137   000010 115007                    CMPA    8,DL
        16 002140   002144 600000 16                 TZE     s:17107
        16 002141   000016 115007                    CMPA    14,DL
        16 002142   002144 600000 16                 TZE     s:17107

      685    17104    2        AND ID3$ -> LX_ETT_ITEM.TYPE ~= %TYN
      686    17105    2        THEN OPTIMIZABLE = FALSE ;

  17105 16 002143   200330 450100                    STZ     OPTIMIZABLE,,AUTO

      687    17106
      688    17107    2        CALL Z8CO$DISPL_CHECK (ID3$) ALTRET (BAD) ;

  17107 16 002144   200337 630500                    EPPR0   @ID3$,,AUTO
        16 002145   000020 631400 17                 EPPR1   16
        16 002146   000000 701000 xent               TSX1    Z8CO$DISPL_CHECK
        16 002147   002247 702000 16                 TSX2    BAD

      689    17108
      690    17109             %FISH(TRIAD = ID3$ -> LX_ETT_ITEM.ETT$, RTN = ST$$);

  17111 16 002150   200337 470500                    LDP0    @ID3$,,AUTO
        16 002151   000000 471500                    LDP1    0,,PR0
        16 002152   100001 236100                    LDQ     1,,PR1
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:110  
        16 002153   200340 756100                    STQ     ST$$,,AUTO

  17112 16 002154   200340 473500                    LDP3    ST$$,,AUTO
        16 002155   300000 220100                    LDX0    0,,PR3
        16 002156   000751 100003                    CMPX0   489,DU
        16 002157   002167 603000 16                 TRC     s:17118

  17113 16 002160   200340 470500                    LDP0    ST$$,,AUTO
        16 002161   000001 236100                    LDQ     1,,PR0
        16 002162   200340 756100                    STQ     ST$$,,AUTO

  17114 16 002163   200340 470500                    LDP0    ST$$,,AUTO
        16 002164   000000 220100                    LDX0    0,,PR0
        16 002165   000751 100003                    CMPX0   489,DU
        16 002166   002160 602000 16                 TNC     s:17113

      691    17117
      692    17118    2        IF ST$$ -> VARIABLE.B.SUB_CLASS.EDITED THEN

  17118 16 002167   200340 470500                    LDP0    ST$$,,AUTO
        16 002170   000003 236100                    LDQ     3,,PR0
        16 002171   000004 316007                    CANQ    4,DL
        16 002172   002210 600000 16                 TZE     s:17126

      693    17119    3          DO;

      694    17120    3            CALL Z8AE$ERROR(%E$EDITED_INVALID,

  17120 16 002173   200337 471500                    LDP1    @ID3$,,AUTO
        16 002174   100000 473500                    LDP3    0,,PR1
        16 002175   300006 634500                    EPPR4   6,,PR3
        16 002176   200432 454500                    STP4    LENGTH_ID2$+3,,AUTO
        16 002177   300005 635500                    EPPR5   5,,PR3
        16 002200   200431 455500                    STP5    LENGTH_ID2$+2,,AUTO
        16 002201   000037 236000 17                 LDQ     31
        16 002202   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 002203   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:111  
        16 002204   000000 631400 17                 EPPR1   0
        16 002205   000000 701000 xent               TSX1    Z8AE$ERROR
        16 002206   000000 011000                    NOP     0

      695    17121    3                            ID3$ -> LX_ETT_ITEM.LINE ,
      696    17122    3                            ID3$ -> LX_ETT_ITEM.COLUMN );
      697    17123    3            GOTO BAD ;

  17123 16 002207   002247 710000 16                 TRA     BAD

      698    17124    3          END;
      699    17125
      700    17126    2        IF ST$$ -> VARIABLE.B.JUSTIFIED THEN

  17126 16 002210   040000 316003                    CANQ    16384,DU
        16 002211   002227 600000 16                 TZE     s:17134

      701    17127    3          DO;

      702    17128    3            CALL Z8AE$ERROR(%E$JUSTIFIED_INVALID,

  17128 16 002212   200337 471500                    LDP1    @ID3$,,AUTO
        16 002213   100000 473500                    LDP3    0,,PR1
        16 002214   300006 634500                    EPPR4   6,,PR3
        16 002215   200432 454500                    STP4    LENGTH_ID2$+3,,AUTO
        16 002216   300005 635500                    EPPR5   5,,PR3
        16 002217   200431 455500                    STP5    LENGTH_ID2$+2,,AUTO
        16 002220   000041 236000 17                 LDQ     33
        16 002221   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 002222   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 002223   000000 631400 17                 EPPR1   0
        16 002224   000000 701000 xent               TSX1    Z8AE$ERROR
        16 002225   000000 011000                    NOP     0

      703    17129    3                            ID3$ -> LX_ETT_ITEM.LINE ,
      704    17130    3                            ID3$ -> LX_ETT_ITEM.COLUMN );
      705    17131    3            GOTO BAD ;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:112  

  17131 16 002226   002247 710000 16                 TRA     BAD

      706    17132    3          END;
      707    17133
      708    17134    2        CALL Z8AU$TYPE_DESCRIPTOR (ID3$ -> LX_ETT_ITEM.ETT$,

  17134 16 002227   200337 471500                    LDP1    @ID3$,,AUTO
        16 002230   100000 473500                    LDP3    0,,PR1
        16 002231   200264 634500                    EPPR4   TYPE_DESC,,AUTO
        16 002232   200431 454500                    STP4    LENGTH_ID2$+2,,AUTO
        16 002233   300001 635500                    EPPR5   1,,PR3
        16 002234   200430 455500                    STP5    LENGTH_ID2$+1,,AUTO
        16 002235   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 002236   000006 631400 17                 EPPR1   6
        16 002237   000000 701000 xent               TSX1    Z8AU$TYPE_DESCRIPTOR
        16 002240   000000 011000                    NOP     0

      709    17135    2                                   TYPE_DESC) ;
      710    17136    2        IF TYPE_DESC.SIZ$ ~= ADDR(NIL)

  17136 16 002241   200266 236100                    LDQ     TYPE_DESC+2,,AUTO
        16 002242   000005 116000 17                 CMPQ    5
        16 002243   002245 600000 16                 TZE     s:17139

      711    17137    2        THEN OPTIMIZABLE = FALSE ;

  17137 16 002244   200330 450100                    STZ     OPTIMIZABLE,,AUTO

      712    17138
      713    17139    2        RETURN;

  17139 16 002245   200336 221300                    LDX1  ! OP+1,,AUTO
        16 002246   000001 702211                    TSX2  ! 1,X1

      714    17140
      715    17141    2   BAD:
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:113  
      716    17142    2        ALTRETURN ;

  17142 16 002247   200336 221300       BAD          LDX1  ! OP+1,,AUTO
        16 002250   000000 702211                    TSX2  ! 0,X1

      717    17143
      718    17144    2   END VALIDATE_ID3;
      719    17145        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:114  
      720    17146    1   VALIDATE_ID4: PROC (ID4$, ID3$) ALTRET;

  17146 16 002251   200336 741300       VALIDATE_ID4 STX1  ! OP+1,,AUTO

      721    17147
      722    17148    2        DCL ID4$    PTR;
      723    17149    2        DCL ID3$    PTR;
      724    17150
      725    17151    2        DCL ETT$$   PTR;
      726    17152    2        DCL ID4_MAX SBIN WORD;
      727    17153    2        DCL ID3_LEN SBIN WORD;
      728    17154
      729    17155    2        POINTER =   ID4$ -> LX_ITEM.ID ~= %LX_TERMINAL;

  17155 16 002252   200337 470500                    LDP0    @ID4$,,AUTO
        16 002253   000000 471500                    LDP1    0,,PR0
        16 002254   400000 220003                    LDX0    -131072,DU
        16 002255   100000 222100                    LDX2    0,,PR1
        16 002256   002260 601000 16                 TNZ     s:17155+6
        16 002257   000000 220003                    LDX0    0,DU
        16 002260   000000 636010                    EAQ     0,X0
        16 002261   200325 756100                    STQ     POINTER,,AUTO

      730    17156
      731    17157    2        IF POINTER THEN

  17157 16 002262   200325 234100                    SZN     POINTER,,AUTO
        16 002263   002347 605000 16                 TPL     s:17179

      732    17158    3          DO;

      733    17159    3            OPTIMIZABLE = FALSE ;

  17159 16 002264   200330 450100                    STZ     OPTIMIZABLE,,AUTO

      734    17160    3            CALL Z8CO$INTEGER_CHECK(ID4$) ALTRET(BAD);

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:115  
  17160 16 002265   200337 630500                    EPPR0   @ID4$,,AUTO
        16 002266   000020 631400 17                 EPPR1   16
        16 002267   000000 701000 xent               TSX1    Z8CO$INTEGER_CHECK
        16 002270   002351 702000 16                 TSX2    BAD

      735    17161    3            CALL Z8CO$P_CHECK(ID4$) ALTRET(BAD);

  17161 16 002271   200337 630500                    EPPR0   @ID4$,,AUTO
        16 002272   000020 631400 17                 EPPR1   16
        16 002273   000000 701000 xent               TSX1    Z8CO$P_CHECK
        16 002274   002351 702000 16                 TSX2    BAD

      736    17162
      737    17163    3            CALL Z8EZ$MAX_VALUE(ID4$, ID4_MAX);

  17163 16 002275   200342 630500                    EPPR0   ID4_MAX,,AUTO
        16 002276   200431 450500                    STP0    LENGTH_ID2$+2,,AUTO
        16 002277   200337 236100                    LDQ     @ID4$,,AUTO
        16 002300   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 002301   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 002302   000006 631400 17                 EPPR1   6
        16 002303   000000 701000 xent               TSX1    Z8EZ$MAX_VALUE
        16 002304   000000 011000                    NOP     0

      738    17164    3            CALL Z8AU$LENGTH_ETT(ID3$ -> LX_ETT_ITEM.ETT$, ETT$$);

  17164 16 002305   200340 470500                    LDP0    @ID3$,,AUTO
        16 002306   000000 471500                    LDP1    0,,PR0
        16 002307   200341 633500                    EPPR3   ETT$$,,AUTO
        16 002310   200431 453500                    STP3    LENGTH_ID2$+2,,AUTO
        16 002311   100001 634500                    EPPR4   1,,PR1
        16 002312   200430 454500                    STP4    LENGTH_ID2$+1,,AUTO
        16 002313   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 002314   000006 631400 17                 EPPR1   6
        16 002315   000000 701000 xent               TSX1    Z8AU$LENGTH_ETT
        16 002316   000000 011000                    NOP     0

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:116  
      739    17165
      740    17166    4            IF ETT$$ -> ETT.ID = %TRIAD THEN DO ; /* Size is constant */

  17166 16 002317   200341 470500                    LDP0    ETT$$,,AUTO
        16 002320   000000 220100                    LDX0    0,,PR0
        16 002321   000015 100003                    CMPX0   13,DU
        16 002322   002347 601000 16                 TNZ     s:17179

      741    17167
      742    17168    4              ID3_LEN = ETT$$ -> ETT.LOP -> CONST.CONSTI.WORD1 ;

  17168 16 002323   000001 471500                    LDP1    1,,PR0
        16 002324   100010 235100                    LDA     8,,PR1
        16 002325   200343 755100                    STA     ID3_LEN,,AUTO

      743    17169
      744    17170    5              IF ID4_MAX < (1 + ID3_LEN) THEN DO ;

  17170 16 002326   200342 236100                    LDQ     ID4_MAX,,AUTO
        16 002327   200343 116100                    CMPQ    ID3_LEN,,AUTO
        16 002330   002347 605400 16                 TPNZ    s:17179

      745    17171    5                CALL Z8AE$ERROR(%E$INSUFFICIENT_SIGNIFICANCE,

  17171 16 002331   200337 473500                    LDP3    @ID4$,,AUTO
        16 002332   300000 474500                    LDP4    0,,PR3
        16 002333   400006 635500                    EPPR5   6,,PR4
        16 002334   200432 455500                    STP5    LENGTH_ID2$+3,,AUTO
        16 002335   400005 631500                    EPPR1   5,,PR4
        16 002336   200431 451500                    STP1    LENGTH_ID2$+2,,AUTO
        16 002337   000043 236000 17                 LDQ     35
        16 002340   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 002341   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 002342   000000 631400 17                 EPPR1   0
        16 002343   000000 701000 xent               TSX1    Z8AE$ERROR
        16 002344   000000 011000                    NOP     0

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:117  
      746    17172    5                                ID4$ -> LX_ETT_ITEM.LINE,
      747    17173    5                                ID4$ -> LX_ETT_ITEM.COLUMN) ;
      748    17174    5                ALTRETURN ;

  17174 16 002345   200336 221300                    LDX1  ! OP+1,,AUTO
        16 002346   000000 702211                    TSX2  ! 0,X1

      749    17175    5              END ; /* ID4 max value < ID3 Length + 1 */
      750    17176    4            END ; /* ID3 has a constant length */
      751    17177    3          END ; /* POINTER clause exists */
      752    17178
      753    17179    2        RETURN;

  17179 16 002347   200336 221300                    LDX1  ! OP+1,,AUTO
        16 002350   000001 702211                    TSX2  ! 1,X1

      754    17180
      755    17181    2   BAD:
      756    17182    2        ALTRETURN;

  17182 16 002351   200336 221300       BAD          LDX1  ! OP+1,,AUTO
        16 002352   000000 702211                    TSX2  ! 0,X1

      757    17183
      758    17184    2   END VALIDATE_ID4;
      759    17185        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:118  
      760    17186        /*I*   NAME: INTEGER_CHECK
      761    17187
      762    17188        DESCRIPTION: This routine issues a warning message if the identifier
      763    17189                     is not an integer variable.
      764    17190
      765    17191        */
      766    17192    1   INTEGER_CHECK:PROC(ID$);

  17192 16 002353   200340 741300       INTEGER_CHE* STX1  ! @ID3$,,AUTO

      767    17193
      768    17194    2        DCL ID$ PTR;
      769    17195
      770    17196    2        CALL Z8CO$INTEGER_CHECK_NO_ERROR (ID$)

  17196 16 002354   200341 630500                    EPPR0   @ID$,,AUTO
        16 002355   000020 631400 17                 EPPR1   16
        16 002356   000000 701000 xent               TSX1    Z8CO$INTEGER_CHECK_NO_ERROR
        16 002357   002361 702000 16                 TSX2    s:17211
        16 002360   002400 710000 16                 TRA     s:17233

      771    17197    3          WHENALTRETURN DO;

      772    17198                 %CONDITIONAL_ERROR (@LX_ITEM$ = ID$,
      773    17199                                     @ERROR#   = %E$SHOULD_BE_INTEGER,
      774    17200                                     @LINE     = ID$ -> LX_ETT_ITEM.LINE,
      775    17201                                     @COLUMN   = ID$ -> LX_ETT_ITEM.COLUMN);

  17211 16 002361   200341 470500                    LDP0    @ID$,,AUTO
        16 002362   000000 471500                    LDP1    0,,PR0
        16 002363   100000 236100                    LDQ     0,,PR1
        16 002364   400000 316007                    CANQ    -131072,DL
        16 002365   002400 601000 16                 TNZ     s:17233

  17213 16 002366   100006 633500                    EPPR3   6,,PR1
        16 002367   200432 453500                    STP3    LENGTH_ID2$+3,,AUTO
        16 002370   100005 634500                    EPPR4   5,,PR1
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:119  
        16 002371   200431 454500                    STP4    LENGTH_ID2$+2,,AUTO
        16 002372   000045 236000 17                 LDQ     37
        16 002373   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 002374   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 002375   000000 631400 17                 EPPR1   0
        16 002376   000000 701000 xent               TSX1    Z8AE$ERROR
        16 002377   000000 011000                    NOP     0

      776    17231    3          END;

      777    17232
      778    17233    2   END INTEGER_CHECK;

  17233 16 002400   200340 221300                    LDX1  ! @ID3$,,AUTO
        16 002401   000001 702211                    TSX2  ! 1,X1

      779    17234        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:120  
      780    17235        /*I*   NAME: PREPARE_IDn, n = 1 -> 4
      781    17236
      782    17237        DESCRIPTION: These routines are used by Pass 3 of Z8EZ$STRING.
      783    17238                     They prepare each operand for use by the general
      784    17239                     STRING algorithm.  This includes conversions from
      785    17240                     one type to another, setting the type for a constant,
      786    17241                     and finding the length of an operand.
      787    17242
      788    17243        */
      789    17244
      790    17245        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:121  
      791    17246    1   PREPARE_ID1:PROC(ID1$, RETURN$);

  17246 16 002402   200336 741300       PREPARE_ID1  STX1  ! OP+1,,AUTO

      792    17247
      793    17248    2        DCL ID1$          PTR;
      794    17249    2        DCL RETURN$       PTR;
      795    17250
      796    17251
      797    17252    2        IF ID1$ -> LX_ITEM.ID = %LX_TERMINAL THEN

  17252 16 002403   200337 470500                    LDP0    @ID1$,,AUTO
        16 002404   000000 471500                    LDP1    0,,PR0
        16 002405   100000 220100                    LDX0    0,,PR1
        16 002406   002425 601000 16                 TNZ     s:17258

      798    17253    3          DO ;

      799    17254    3            CALL Z8EV$CONVERT_TYA (ID1$, RETURN$, ID3$) ;

  17254 16 002407   200272 633500                    EPPR3   ID3$,,AUTO
        16 002410   200432 453500                    STP3    LENGTH_ID2$+3,,AUTO
        16 002411   200340 236100                    LDQ     @RETURN$,,AUTO
        16 002412   200337 235100                    LDA     @ID1$,,AUTO
        16 002413   200430 757100                    STAQ    LENGTH_ID2$+1,,AUTO
        16 002414   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 002415   000000 631400 17                 EPPR1   0
        16 002416   000000 701000 xent               TSX1    Z8EV$CONVERT_TYA
        16 002417   000000 011000                    NOP     0

      800    17255    3            RETURN$ -> LX_ETT_ITEM.B.ALL = FALSE ; /* Move only one character */

  17255 16 002420   200340 470500                    LDP0    @RETURN$,,AUTO
        16 002421   000000 471500                    LDP1    0,,PR0
        16 002422   000046 236000 17                 LDQ     38
        16 002423   100000 356100                    ANSQ    0,,PR1

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:122  
      801    17256    3          END ;

  17256 16 002424   002432 710000 16                 TRA     s:17260

      802    17257    2        ELSE
      803    17258    2          RETURN$ -> LX_ETT_ITEM = ID1$ -> LX_ETT_ITEM ;

  17258 16 002425   200340 473500                    LDP3    @RETURN$,,AUTO
        16 002426   300000 474500                    LDP4    0,,PR3
        16 002427   000100 100500                    MLR     fill='000'O
        16 002430   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32
        16 002431   400000 000040                    ADSC9   0,,PR4                   cn=0,n=32

      804    17259
      805    17260    3        DO CASE (RETURN$ -> LX_ETT_ITEM.TYPE) ;

  17260 16 002432   200340 470500                    LDP0    @RETURN$,,AUTO
        16 002433   000000 471500                    LDP1    0,,PR0
        16 002434   100004 235100                    LDA     4,,PR1
        16 002435   000024 115007                    CMPA    20,DL
        16 002436   002440 602005 16                 TNC     s:17260+6,AL
        16 002437   002574 710000 16                 TRA     s:17295
        16 002440   002464 710000 16                 TRA     s:17264
        16 002441   002574 710000 16                 TRA     s:17295
        16 002442   002574 710000 16                 TRA     s:17295
        16 002443   002464 710000 16                 TRA     s:17264
        16 002444   002574 710000 16                 TRA     s:17295
        16 002445   002574 710000 16                 TRA     s:17295
        16 002446   002505 710000 16                 TRA     s:17270
        16 002447   002574 710000 16                 TRA     s:17295
        16 002450   002600 710000 16                 TRA     s:17299
        16 002451   002574 710000 16                 TRA     s:17295
        16 002452   002574 710000 16                 TRA     s:17295
        16 002453   002505 710000 16                 TRA     s:17270
        16 002454   002505 710000 16                 TRA     s:17270
        16 002455   002574 710000 16                 TRA     s:17295
        16 002456   002600 710000 16                 TRA     s:17299
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:123  
        16 002457   002574 710000 16                 TRA     s:17295
        16 002460   002574 710000 16                 TRA     s:17295
        16 002461   002574 710000 16                 TRA     s:17295
        16 002462   002574 710000 16                 TRA     s:17295
        16 002463   002505 710000 16                 TRA     s:17270

      806    17261
      807    17262    3          CASE (%TYO, %TYD) ;

      808    17263
      809    17264    3            CALL Z8AF$FORME (%DNA, RETURN$ -> LX_ETT_ITEM.ETT$,

  17264 16 002464   100001 633500                    EPPR3   1,,PR1
        16 002465   200433 453500                    STP3    LENGTH_ID2$+4,,AUTO
        16 002466   000035 236000 17                 LDQ     29
        16 002467   200432 756100                    STQ     LENGTH_ID2$+3,,AUTO
        16 002470   100001 634500                    EPPR4   1,,PR1
        16 002471   200431 454500                    STP4    LENGTH_ID2$+2,,AUTO
        16 002472   000050 236000 17                 LDQ     40
        16 002473   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 002474   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 002475   000015 631400 17                 EPPR1   13
        16 002476   000000 701000 xent               TSX1    Z8AF$FORME
        16 002477   000000 011000                    NOP     0

      810    17265    3                                0, RETURN$ -> LX_ETT_ITEM.ETT$) ;
      811    17266    3            RETURN$ -> LX_ETT_ITEM.TYPE = %TYA ;

  17266 16 002500   200340 470500                    LDP0    @RETURN$,,AUTO
        16 002501   000000 471500                    LDP1    0,,PR0
        16 002502   000010 235007                    LDA     8,DL
        16 002503   100004 755100                    STA     4,,PR1
        16 002504   002600 710000 16                 TRA     s:17299

      812    17267
      813    17268    3          CASE (%TYE, %TYF, %TYB, %TYC) ;

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:124  
      814    17269
      815    17270    3            IF RETURN$ -> LX_ETT_ITEM.TYPE = %TYE OR

  17270 16 002505   000006 115007                    CMPA    6,DL
        16 002506   002511 600000 16                 TZE     s:17272
        16 002507   000013 115007                    CMPA    11,DL
        16 002510   002514 601000 16                 TNZ     s:17273

      816    17271    3                RETURN$ -> LX_ETT_ITEM.TYPE = %TYF
      817    17272    3              THEN OP = %OP_EBCDIC_TO_ASCII ;

  17272 16 002511   002723 236007                    LDQ     1491,DL
        16 002512   200335 756100                    STQ     OP,,AUTO
        16 002513   002516 710000 16                 TRA     s:17275

      818    17273    3              ELSE OP = %OP_GBCD_TO_ASCII ;

  17273 16 002514   002663 236007                    LDQ     1459,DL
        16 002515   200335 756100                    STQ     OP,,AUTO

      819    17274
      820    17275    3            CALL Z8CO$CREATE_LIBRARY_BASE (OP, TABLE_ETT$) ;

  17275 16 002516   200324 631500                    EPPR1   TABLE_ETT$,,AUTO
        16 002517   200431 451500                    STP1    LENGTH_ID2$+2,,AUTO
        16 002520   200335 633500                    EPPR3   OP,,AUTO
        16 002521   200430 453500                    STP3    LENGTH_ID2$+1,,AUTO
        16 002522   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 002523   000006 631400 17                 EPPR1   6
        16 002524   000000 701000 xent               TSX1    Z8CO$CREATE_LIBRARY_BASE
        16 002525   000000 011000                    NOP     0

      821    17276
      822    17277    3            CALL Z8AF$FORME (%CVT,

  17277 16 002526   200340 470500                    LDP0    @RETURN$,,AUTO
        16 002527   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:125  
        16 002530   100001 633500                    EPPR3   1,,PR1
        16 002531   200433 453500                    STP3    LENGTH_ID2$+4,,AUTO
        16 002532   200324 634500                    EPPR4   TABLE_ETT$,,AUTO
        16 002533   200432 454500                    STP4    LENGTH_ID2$+3,,AUTO
        16 002534   100001 635500                    EPPR5   1,,PR1
        16 002535   200431 455500                    STP5    LENGTH_ID2$+2,,AUTO
        16 002536   000052 236000 17                 LDQ     42
        16 002537   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 002540   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 002541   000015 631400 17                 EPPR1   13
        16 002542   000000 701000 xent               TSX1    Z8AF$FORME
        16 002543   000000 011000                    NOP     0

      823    17278    3                             RETURN$ -> LX_ETT_ITEM.ETT$,
      824    17279    3                             TABLE_ETT$,
      825    17280    3                             RETURN$ -> LX_ETT_ITEM.ETT$) ;
      826    17281
      827    17282    3            IF RETURN$ -> LX_ETT_ITEM.TYPE = %TYF OR

  17282 16 002544   200340 470500                    LDP0    @RETURN$,,AUTO
        16 002545   000000 471500                    LDP1    0,,PR0
        16 002546   100004 235100                    LDA     4,,PR1
        16 002547   000013 115007                    CMPA    11,DL
        16 002550   002553 600000 16                 TZE     s:17284
        16 002551   000023 115007                    CMPA    19,DL
        16 002552   002567 601000 16                 TNZ     s:17289

      828    17283    3                RETURN$ -> LX_ETT_ITEM.TYPE = %TYC THEN
      829    17284    3              CALL Z8AF$FORME (%DNA,

  17284 16 002553   100001 633500                    EPPR3   1,,PR1
        16 002554   200433 453500                    STP3    LENGTH_ID2$+4,,AUTO
        16 002555   000035 236000 17                 LDQ     29
        16 002556   200432 756100                    STQ     LENGTH_ID2$+3,,AUTO
        16 002557   100001 634500                    EPPR4   1,,PR1
        16 002560   200431 454500                    STP4    LENGTH_ID2$+2,,AUTO
        16 002561   000050 236000 17                 LDQ     40
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:126  
        16 002562   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 002563   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 002564   000015 631400 17                 EPPR1   13
        16 002565   000000 701000 xent               TSX1    Z8AF$FORME
        16 002566   000000 011000                    NOP     0

      830    17285    3                               RETURN$ -> LX_ETT_ITEM.ETT$,
      831    17286    3                               0,
      832    17287    3                               RETURN$ -> LX_ETT_ITEM.ETT$) ;
      833    17288
      834    17289    3            RETURN$ -> LX_ETT_ITEM.TYPE = %TYA ;

  17289 16 002567   200340 470500                    LDP0    @RETURN$,,AUTO
        16 002570   000000 471500                    LDP1    0,,PR0
        16 002571   000010 235007                    LDA     8,DL
        16 002572   100004 755100                    STA     4,,PR1
        16 002573   002600 710000 16                 TRA     s:17299

      835    17290
      836    17291    3          CASE (%TYA, %TYN);

      837    17292
      838    17293    3          CASE (ELSE) ;

      839    17294
      840    17295    3            CALL Z8AE$ERROR (%E$UNEXPECTED_CASE) ;

  17295 16 002574   000054 630400 17                 EPPR0   44
        16 002575   000020 631400 17                 EPPR1   16
        16 002576   000000 701000 xent               TSX1    Z8AE$ERROR
        16 002577   000000 011000                    NOP     0

      841    17296
      842    17297    3        END ; /* Case of RETURN$ type */

      843    17298
      844    17299    2        CALL Z8AU$LENGTH(RETURN$ -> LX_ETT_ITEM.ETT$,
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:127  

  17299 16 002600   200340 470500                    LDP0    @RETURN$,,AUTO
        16 002601   000000 471500                    LDP1    0,,PR0
        16 002602   200275 633500                    EPPR3   LENGTH_ID1$,,AUTO
        16 002603   200431 453500                    STP3    LENGTH_ID2$+2,,AUTO
        16 002604   100001 634500                    EPPR4   1,,PR1
        16 002605   200430 454500                    STP4    LENGTH_ID2$+1,,AUTO
        16 002606   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 002607   000006 631400 17                 EPPR1   6
        16 002610   000000 701000 xent               TSX1    Z8AU$LENGTH
        16 002611   000000 011000                    NOP     0

      845    17300    2                         LENGTH_ID1$);
      846    17301
      847    17302    2   END PREPARE_ID1;

  17302 16 002612   200336 221300                    LDX1  ! OP+1,,AUTO
        16 002613   000001 702211                    TSX2  ! 1,X1

      848    17303
      849    17304        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:128  
      850    17305    1   PREPARE_ID2:PROC(ID2$, RETURN$);

  17305 16 002614   200336 741300       PREPARE_ID2  STX1  ! OP+1,,AUTO

      851    17306
      852    17307    2        DCL ID2$       PTR;
      853    17308    2        DCL RETURN$    PTR;
      854    17309
      855    17310
      856    17311    2        SIZE = FALSE;

  17311 16 002615   200327 450100                    STZ     SIZE,,AUTO

      857    17312
      858    17313    2        IF ID2$ -> LX_ITEM.ID = %LX_TERMINAL THEN

  17313 16 002616   200337 470500                    LDP0    @ID2$,,AUTO
        16 002617   000000 471500                    LDP1    0,,PR0
        16 002620   100000 220100                    LDX0    0,,PR1
        16 002621   002627 601000 16                 TNZ     s:17317

      859    17314    2          IF ID2$ -> LX_TERMINAL.SYMBOL = %RSV_WRD_SIZE THEN

  17314 16 002622   100003 235100                    LDA     3,,PR1
        16 002623   000643 115007                    CMPA    419,DL
        16 002624   002627 601000 16                 TNZ     s:17317

      860    17315    2            SIZE = TRUE;

  17315 16 002625   400000 236003                    LDQ     -131072,DU
        16 002626   200327 756100                    STQ     SIZE,,AUTO

      861    17316
      862    17317    3        IF NOT SIZE THEN DO ;

  17317 16 002627   200327 234100                    SZN     SIZE,,AUTO
        16 002630   002664 604000 16                 TMI     s:17326
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:129  

      863    17318    3          IF ID2$ -> LX_ITEM.ID = %LX_TERMINAL THEN

  17318 16 002631   000000 100003                    CMPX0   0,DU
        16 002632   002645 601000 16                 TNZ     s:17321

      864    17319    3            CALL Z8EV$CONVERT_TYA (ID2$, RETURN$, ID3$) ;

  17319 16 002633   200272 633500                    EPPR3   ID3$,,AUTO
        16 002634   200432 453500                    STP3    LENGTH_ID2$+3,,AUTO
        16 002635   200340 236100                    LDQ     @RETURN$,,AUTO
        16 002636   200337 235100                    LDA     @ID2$,,AUTO
        16 002637   200430 757100                    STAQ    LENGTH_ID2$+1,,AUTO
        16 002640   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 002641   000000 631400 17                 EPPR1   0
        16 002642   000000 701000 xent               TSX1    Z8EV$CONVERT_TYA
        16 002643   000000 011000                    NOP     0
        16 002644   002652 710000 16                 TRA     s:17322

      865    17320    3          ELSE
      866    17321    3            RETURN$ -> LX_ETT_ITEM = ID2$ -> LX_ETT_ITEM;

  17321 16 002645   200340 473500                    LDP3    @RETURN$,,AUTO
        16 002646   300000 474500                    LDP4    0,,PR3
        16 002647   000100 100500                    MLR     fill='000'O
        16 002650   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32
        16 002651   400000 000040                    ADSC9   0,,PR4                   cn=0,n=32

      867    17322    3          CALL Z8AU$LENGTH (RETURN$ ->LX_ETT_ITEM.ETT$,

  17322 16 002652   200340 470500                    LDP0    @RETURN$,,AUTO
        16 002653   000000 471500                    LDP1    0,,PR0
        16 002654   200276 633500                    EPPR3   LENGTH_ID2$,,AUTO
        16 002655   200431 453500                    STP3    LENGTH_ID2$+2,,AUTO
        16 002656   100001 634500                    EPPR4   1,,PR1
        16 002657   200430 454500                    STP4    LENGTH_ID2$+1,,AUTO
        16 002660   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:130  
        16 002661   000006 631400 17                 EPPR1   6
        16 002662   000000 701000 xent               TSX1    Z8AU$LENGTH
        16 002663   000000 011000                    NOP     0

      868    17323    3                            LENGTH_ID2$) ;
      869    17324    3        END ; /* Not SIZE */

      870    17325
      871    17326    2   END PREPARE_ID2;

  17326 16 002664   200336 221300                    LDX1  ! OP+1,,AUTO
        16 002665   000001 702211                    TSX2  ! 1,X1

      872    17327        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:131  
      873    17328    1   PREPARE_ID3:PROC(ID3$, RETURN$);

  17328 16 002666   200336 741300       PREPARE_ID3  STX1  ! OP+1,,AUTO

      874    17329
      875    17330    2        DCL ID3$         PTR;
      876    17331    2        DCL RETURN$      PTR;
      877    17332
      878    17333    2        RETURN$ -> LX_ETT_ITEM = ID3$ -> LX_ETT_ITEM;

  17333 16 002667   200340 470500                    LDP0    @RETURN$,,AUTO
        16 002670   000000 471500                    LDP1    0,,PR0
        16 002671   200337 473500                    LDP3    @ID3$,,AUTO
        16 002672   300000 474500                    LDP4    0,,PR3
        16 002673   000100 100500                    MLR     fill='000'O
        16 002674   400000 000040                    ADSC9   0,,PR4                   cn=0,n=32
        16 002675   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32

      879    17334
      880    17335    2        CALL Z8AU$LENGTH(RETURN$ -> LX_ETT_ITEM.ETT$,

  17335 16 002676   000000 471500                    LDP1    0,,PR0
        16 002677   200277 634500                    EPPR4   LENGTH_ID3$,,AUTO
        16 002700   200431 454500                    STP4    LENGTH_ID2$+2,,AUTO
        16 002701   100001 635500                    EPPR5   1,,PR1
        16 002702   200430 455500                    STP5    LENGTH_ID2$+1,,AUTO
        16 002703   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 002704   000006 631400 17                 EPPR1   6
        16 002705   000000 701000 xent               TSX1    Z8AU$LENGTH
        16 002706   000000 011000                    NOP     0

      881    17336    2                         LENGTH_ID3$);
      882    17337
      883    17338
      884    17339    2   END PREPARE_ID3;

  17339 16 002707   200336 221300                    LDX1  ! OP+1,,AUTO
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:132  
        16 002710   000001 702211                    TSX2  ! 1,X1

      885    17340
      886    17341        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:133  
      887    17342
      888    17343    1   PREPARE_ID4:PROC(ID4$, ID3$, RETURN$);

  17343 16 002711   200336 741300       PREPARE_ID4  STX1  ! OP+1,,AUTO

      889    17344
      890    17345    2        DCL ID4$       PTR;
      891    17346    2        DCL ID3$       PTR;
      892    17347    2        DCL RETURN$    PTR;
      893    17348
      894    17349
      895    17350
      896    17351    2        IF NOT POINTER THEN

  17351 16 002712   200325 234100                    SZN     POINTER,,AUTO
        16 002713   002766 604000 16                 TMI     s:17383

      897    17352    3          DO;

      898    17353                 %INIT_LX_ETT_ITEM( @POINTER   = RETURN$ ,
      899    17354                                    @TYPE      = %TYI );

  17356 16 002714   200341 470500                    LDP0    @RETURN$,,AUTO
        16 002715   000000 471500                    LDP1    0,,PR0
        16 002716   000004 220003                    LDX0    4,DU
        16 002717   100000 740100                    STX0    0,,PR1

  17357 16 002720   000000 471500                    LDP1    0,,PR0
        16 002721   000000 221003                    LDX1    0,DU
        16 002722   100000 441100                    SXL1    0,,PR1

  17358 16 002723   000000 471500                    LDP1    0,,PR0
        16 002724   000001 235007                    LDA     1,DL
        16 002725   100004 755100                    STA     4,,PR1

  17359 16 002726   000000 471500                    LDP1    0,,PR0
        16 002727   000005 236000 17                 LDQ     5
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:134  
        16 002730   100007 756100                    STQ     7,,PR1

  17360 16 002731   000000 471500                    LDP1    0,,PR0
        16 002732   100001 756100                    STQ     1,,PR1

  17361 16 002733   000000 471500                    LDP1    0,,PR0
        16 002734   000005 236000 17                 LDQ     5
        16 002735   100002 756100                    STQ     2,,PR1

  17363 16 002736   000000 471500                    LDP1    0,,PR0
        16 002737   000133 236000 xsym               LDQ     COMCOM+91
        16 002740   100005 756100                    STQ     5,,PR1

  17364 16 002741   000000 471500                    LDP1    0,,PR0
        16 002742   000134 236000 xsym               LDQ     COMCOM+92
        16 002743   100006 756100                    STQ     6,,PR1

      900    17376
      901    17377    3            CALL Z8AT$CREATE_TEMP_WITH_BASE(%SCALAR,

  17377 16 002744   000000 471500                    LDP1    0,,PR0
        16 002745   100001 633500                    EPPR3   1,,PR1
        16 002746   200431 453500                    STP3    LENGTH_ID2$+2,,AUTO
        16 002747   000022 236000 17                 LDQ     18
        16 002750   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 002751   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 002752   000006 631400 17                 EPPR1   6
        16 002753   000000 701000 xent               TSX1    Z8AT$CREATE_TEMP_WITH_BASE
        16 002754   000000 011000                    NOP     0

      902    17378    3                                            RETURN$ -> LX_ETT_ITEM.ETT$ );
      903    17379
      904    17380    3            CALL Z8E7$MOVE(RETURN$, ONE$);

  17380 16 002755   200313 630500                    EPPR0   ONE$,,AUTO
        16 002756   200431 450500                    STP0    LENGTH_ID2$+2,,AUTO
        16 002757   200341 236100                    LDQ     @RETURN$,,AUTO
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:135  
        16 002760   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 002761   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 002762   000006 631400 17                 EPPR1   6
        16 002763   000000 701000 xent               TSX1    Z8E7$MOVE
        16 002764   000000 011000                    NOP     0

      905    17381    3          END;

  17381 16 002765   002775 710000 16                 TRA     s:17384

      906    17382    2        ELSE
      907    17383    2          RETURN$ -> LX_ETT_ITEM = ID4$ -> LX_ETT_ITEM;

  17383 16 002766   200341 470500                    LDP0    @RETURN$,,AUTO
        16 002767   000000 471500                    LDP1    0,,PR0
        16 002770   200337 473500                    LDP3    @ID4$,,AUTO
        16 002771   300000 474500                    LDP4    0,,PR3
        16 002772   000100 100500                    MLR     fill='000'O
        16 002773   400000 000040                    ADSC9   0,,PR4                   cn=0,n=32
        16 002774   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32

      908    17384    2   END PREPARE_ID4;

  17384 16 002775   200336 221300                    LDX1  ! OP+1,,AUTO
        16 002776   000001 702211                    TSX2  ! 1,X1

      909    17385        %EJECT;
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:136  
      910    17386        /*===========*/
      911    17387    1     KANJI_INDEX : PROC ( COUNT$ );

  17387 16 002777   200336 741300       KANJI_INDEX  STX1  ! OP+1,,AUTO

      912    17388        /*===========*/
      913    17389
      914    17390    2   DCL BEGAIN_INDEX$       PTR;
      915    17391    2   DCL END_INDEX$          PTR;
      916    17392
      917    17393        %DCL_AUTO_LX_ITEM( @NAME = COUNT );
      918    17397        %DCL_AUTO_LX_ITEM( @NAME = SUB );
      919    17401        %DCL_AUTO_LX_ITEM( @NAME = COMPARISON );
      920    17405        %DCL_AUTO_LX_ITEM( @NAME = LENGTH_ID1 );
      921    17409        %DCL_AUTO_LX_ITEM( @NAME = LENGTH_ID2 );
      922    17413        %DCL_AUTO_LX_ITEM( @NAME = SUB_STR );
      923    17417
      924    17418    2   DCL COUNT$              PTR;
      925    17419    2   DCL COUNT_BASE$         PTR;
      926    17420    2   DCL SUBSTR$             PTR;
      927    17421    2   DCL SUB$                PTR;
      928    17422    2   DCL COMPARISON$         PTR;
      929    17423    2   DCL LENGTH_ID1$         PTR;
      930    17424    2   DCL LENGTH_ID2$         PTR;
      931    17425
      932    17426
      933    17427    2   SUB$ = ADDR( SUB );

  17427 16 003000   200352 630500                    EPPR0   SUB,,AUTO
        16 003001   200424 450500                    STP0    SUB$,,AUTO

      934    17428    2   SUBSTR$ = ADDR( SUB_STR );

  17428 16 003002   200412 631500                    EPPR1   SUB_STR,,AUTO
        16 003003   200423 451500                    STP1    SUBSTR$,,AUTO

      935    17429
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:137  
      936    17430    2   CALL Z8AT$CREATE_TEMPORARY( %PARA, BEGAIN_INDEX$ );

  17430 16 003004   200340 633500                    EPPR3   BEGAIN_INDEX$,,AUTO
        16 003005   200431 453500                    STP3    LENGTH_ID2$+2,,AUTO
        16 003006   000014 236000 17                 LDQ     12
        16 003007   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 003010   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 003011   000006 631400 17                 EPPR1   6
        16 003012   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        16 003013   000000 011000                    NOP     0

      937    17431    2   CALL Z8AT$CREATE_TEMPORARY( %PARA, END_INDEX$ );

  17431 16 003014   200341 630500                    EPPR0   END_INDEX$,,AUTO
        16 003015   200431 450500                    STP0    LENGTH_ID2$+2,,AUTO
        16 003016   000014 236000 17                 LDQ     12
        16 003017   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 003020   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 003021   000006 631400 17                 EPPR1   6
        16 003022   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        16 003023   000000 011000                    NOP     0

      938    17432
      939    17433    2   LENGTH_ID2$ = ADDR( LENGTH_ID2 );

  17433 16 003024   200402 630500                    EPPR0   LENGTH_ID2,,AUTO
        16 003025   200427 450500                    STP0    LENGTH_ID2$,,AUTO

      940    17434    2   CALL Z8AU$LENGTH( ID2$ -> LX_ETT_ITEM.ETT$,

  17434 16 003026   200427 631500                    EPPR1   LENGTH_ID2$,,AUTO
        16 003027   200431 451500                    STP1    LENGTH_ID2$+2,,AUTO
        16 003030   200271 236100                    LDQ     ID2$,,AUTO
        16 003031   000001 036003                    ADLQ    1,DU
        16 003032   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 003033   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 003034   000006 631400 17                 EPPR1   6
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:138  
        16 003035   000000 701000 xent               TSX1    Z8AU$LENGTH
        16 003036   000000 011000                    NOP     0

      941    17435    2                     LENGTH_ID2$ );
      942    17436    2   LENGTH_ID1$ = ADDR( LENGTH_ID1 );

  17436 16 003037   200372 630500                    EPPR0   LENGTH_ID1,,AUTO
        16 003040   200426 450500                    STP0    LENGTH_ID1$,,AUTO

      943    17437    2   CALL Z8AU$LENGTH( ID1$ -> LX_ETT_ITEM.ETT$,

  17437 16 003041   200426 631500                    EPPR1   LENGTH_ID1$,,AUTO
        16 003042   200431 451500                    STP1    LENGTH_ID2$+2,,AUTO
        16 003043   200270 236100                    LDQ     ID1$,,AUTO
        16 003044   000001 036003                    ADLQ    1,DU
        16 003045   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 003046   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 003047   000006 631400 17                 EPPR1   6
        16 003050   000000 701000 xent               TSX1    Z8AU$LENGTH
        16 003051   000000 011000                    NOP     0

      944    17438    2                     LENGTH_ID1$ );
      945    17439
      946    17440        %NEW_ILL( @ID  = %MVII,
      947    17441                  @LOP = COUNT$ -> LX_ETT_ITEM.ETT$,
      948    17442                  @ROP = COMCOM.VALUE_0 );

  17755 16 003052   200337 470500                    LDP0    @COUNT$,,AUTO
        16 003053   000000 471500                    LDP1    0,,PR0
        16 003054   000027 236000 17                 LDQ     23
        16 003055   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 003056   100001 633500                    EPPR3   1,,PR1
        16 003057   200435 453500                    STP3    LENGTH_ID2$+6,,AUTO
        16 003060   200430 631500                    EPPR1   LENGTH_ID2$+1,,AUTO
        16 003061   200434 451500                    STP1    LENGTH_ID2$+5,,AUTO
        16 003062   000060 237000 17                 LDAQ    48
        16 003063   200432 757100                    STAQ    LENGTH_ID2$+3,,AUTO
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:139  
        16 003064   000010 236000 17                 LDQ     8
        16 003065   200431 756100                    STQ     LENGTH_ID2$+2,,AUTO
        16 003066   200431 630500                    EPPR0   LENGTH_ID2$+2,,AUTO
        16 003067   000055 631400 17                 EPPR1   45
        16 003070   000000 701000 xent               TSX1    Z8AN$NEW_ILL1
        16 003071   000000 011000                    NOP     0

  17758 16 003072   200337 470500                    LDP0    @COUNT$,,AUTO
        16 003073   000000 471500                    LDP1    0,,PR0
        16 003074   100001 236100                    LDQ     1,,PR1
        16 003075   000000 473400 11                 LDP3    ILL$
        16 003076   300001 756100                    STQ     1,,PR3

  17759 16 003077   000124 236000 xsym               LDQ     COMCOM+84
        16 003100   300002 756100                    STQ     2,,PR3

      949    17821
      950    17822        %NEW_ILL( @ID  = %DEFLB,
      951    17823                  @LOP = BEGAIN_INDEX$ );

  18144 16 003101   000027 236000 17                 LDQ     23
        16 003102   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 003103   200430 631500                    EPPR1   LENGTH_ID2$+1,,AUTO
        16 003104   200435 451500                    STP1    LENGTH_ID2$+6,,AUTO
        16 003105   000030 236000 17                 LDQ     24
        16 003106   200434 756100                    STQ     LENGTH_ID2$+5,,AUTO
        16 003107   000032 237000 17                 LDAQ    26
        16 003110   200432 757100                    STAQ    LENGTH_ID2$+3,,AUTO
        16 003111   200432 630500                    EPPR0   LENGTH_ID2$+3,,AUTO
        16 003112   000015 631400 17                 EPPR1   13
        16 003113   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        16 003114   000000 011000                    NOP     0

  18153 16 003115   200340 236100                    LDQ     BEGAIN_INDEX$,,AUTO
        16 003116   000000 470400 11                 LDP0    ILL$
        16 003117   000001 756100                    STQ     1,,PR0

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:140  
      952    18202
      953    18203        %INIT_BINARY_OP( @POINTER = SUB$,
      954    18204                         @LOP$    = LENGTH_ID1$,
      955    18205                         @ROP$    = TWO$,
      956    18206                         @OP      = %OP_BINARY_MINUS,
      957    18207                         @LINE    = "ID1$ -> LX_ETT_ITEM.LINE",
      958    18208                         @COLUMN  = "ID1$ -> LX_ETT_ITEM.COLUMN" );

  18210 16 003120   000005 220003                    LDX0    5,DU
        16 003121   200424 471500                    LDP1    SUB$,,AUTO
        16 003122   100000 740100                    STX0    0,,PR1

  18211 16 003123   000000 221003                    LDX1    0,DU
        16 003124   100000 441100                    SXL1    0,,PR1

  18218 16 003125   200270 470500                    LDP0    ID1$,,AUTO
        16 003126   000005 235100                    LDA     5,,PR0
        16 003127   100005 755100                    STA     5,,PR1

  18219 16 003130   200270 470500                    LDP0    ID1$,,AUTO
        16 003131   000006 235100                    LDA     6,,PR0
        16 003132   100006 755100                    STA     6,,PR1

  18220 16 003133   200314 236100                    LDQ     TWO$,,AUTO
        16 003134   100002 756100                    STQ     2,,PR1

  18221 16 003135   200426 236100                    LDQ     LENGTH_ID1$,,AUTO
        16 003136   100001 756100                    STQ     1,,PR1

  18222 16 003137   000021 235007                    LDA     17,DL
        16 003140   100003 755100                    STA     3,,PR1

  18223 16 003141   000005 236000 17                 LDQ     5
        16 003142   100007 756100                    STQ     7,,PR1

      959    18226
      960    18227        %IF_THEN_DO( @LOP = COUNT$,
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:141  
      961    18228                     @ROP = SUB$,
      962    18229                     @REL = %OP_LESS_THAN_OR_EQUAL,
      963    18230                     @LAB = END_INDEX$ );

  18236 16 003143   200362 630500                    EPPR0   COMPARISON,,AUTO
        16 003144   200425 450500                    STP0    COMPARISON$,,AUTO

  18244 16 003145   000000 740100                    STX0    0,,PR0

  18245 16 003146   200425 470500                    LDP0    COMPARISON$,,AUTO
        16 003147   000000 441100                    SXL1    0,,PR0

  18252 16 003150   200337 470500                    LDP0    @COUNT$,,AUTO
        16 003151   000000 473500                    LDP3    0,,PR0
        16 003152   200425 474500                    LDP4    COMPARISON$,,AUTO
        16 003153   300005 235100                    LDA     5,,PR3
        16 003154   400005 755100                    STA     5,,PR4

  18253 16 003155   000000 473500                    LDP3    0,,PR0
        16 003156   200425 474500                    LDP4    COMPARISON$,,AUTO
        16 003157   300006 235100                    LDA     6,,PR3
        16 003160   400006 755100                    STA     6,,PR4

  18254 16 003161   200424 236100                    LDQ     SUB$,,AUTO
        16 003162   200425 473500                    LDP3    COMPARISON$,,AUTO
        16 003163   300002 756100                    STQ     2,,PR3

  18255 16 003164   000000 236100                    LDQ     0,,PR0
        16 003165   200425 473500                    LDP3    COMPARISON$,,AUTO
        16 003166   300001 756100                    STQ     1,,PR3

  18256 16 003167   000032 235007                    LDA     26,DL
        16 003170   200425 473500                    LDP3    COMPARISON$,,AUTO
        16 003171   300003 755100                    STA     3,,PR3

  18257 16 003172   000005 236000 17                 LDQ     5
        16 003173   200425 473500                    LDP3    COMPARISON$,,AUTO
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:142  
        16 003174   300007 756100                    STQ     7,,PR3

  18260 16 003175   200341 633500                    EPPR3   END_INDEX$,,AUTO
        16 003176   200431 453500                    STP3    LENGTH_ID2$+2,,AUTO
        16 003177   000014 236000 17                 LDQ     12
        16 003200   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 003201   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 003202   000006 631400 17                 EPPR1   6
        16 003203   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        16 003204   000000 011000                    NOP     0

  18261 16 003205   200425 630500                    EPPR0   COMPARISON$,,AUTO
        16 003206   200431 450500                    STP0    LENGTH_ID2$+2,,AUTO
        16 003207   200341 631500                    EPPR1   END_INDEX$,,AUTO
        16 003210   200430 451500                    STP1    LENGTH_ID2$+1,,AUTO
        16 003211   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 003212   000006 631400 17                 EPPR1   6
        16 003213   000000 701000 xent               TSX1    Z8EK$BRANCH_FALSE
        16 003214   000000 011000                    NOP     0

      964    18264
      965    18265    2   CALL Z8EA$SUBSTR_ZERO( ID1$,

  18265 16 003215   200423 630500                    EPPR0   SUBSTR$,,AUTO
        16 003216   200433 450500                    STP0    LENGTH_ID2$+4,,AUTO
        16 003217   200427 631500                    EPPR1   LENGTH_ID2$,,AUTO
        16 003220   200432 451500                    STP1    LENGTH_ID2$+3,,AUTO
        16 003221   200337 236100                    LDQ     @COUNT$,,AUTO
        16 003222   200431 756100                    STQ     LENGTH_ID2$+2,,AUTO
        16 003223   200270 633500                    EPPR3   ID1$,,AUTO
        16 003224   200430 453500                    STP3    LENGTH_ID2$+1,,AUTO
        16 003225   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 003226   000015 631400 17                 EPPR1   13
        16 003227   000000 701000 xent               TSX1    Z8EA$SUBSTR_ZERO
        16 003230   000000 011000                    NOP     0

      966    18266    2                          COUNT$,
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:143  
      967    18267    2                          LENGTH_ID2$,
      968    18268    2                          SUBSTR$ );
      969    18269    2   COMPARISON$ = ADDR( COMPARISON );

  18269 16 003231   200362 630500                    EPPR0   COMPARISON,,AUTO
        16 003232   200425 450500                    STP0    COMPARISON$,,AUTO

      970    18270
      971    18271        %INIT_BINARY_OP( @POINTER = COMPARISON$,
      972    18272                         @LOP$    = SUBSTR$,
      973    18273                         @OP      = %OP_EQUAL,
      974    18274                         @ROP$    = ID2$,
      975    18275                         @LINE    = "ID2$ -> LX_ETT_ITEM.LINE",
      976    18276                         @COLUMN  = "ID2$ -> LX_ETT_ITEM.COLUMN" );

  18278 16 003233   000005 220003                    LDX0    5,DU
        16 003234   000000 740100                    STX0    0,,PR0

  18279 16 003235   000000 221003                    LDX1    0,DU
        16 003236   200425 470500                    LDP0    COMPARISON$,,AUTO
        16 003237   000000 441100                    SXL1    0,,PR0

  18286 16 003240   200271 470500                    LDP0    ID2$,,AUTO
        16 003241   200425 471500                    LDP1    COMPARISON$,,AUTO
        16 003242   000005 235100                    LDA     5,,PR0
        16 003243   100005 755100                    STA     5,,PR1

  18287 16 003244   200271 470500                    LDP0    ID2$,,AUTO
        16 003245   200425 471500                    LDP1    COMPARISON$,,AUTO
        16 003246   000006 235100                    LDA     6,,PR0
        16 003247   100006 755100                    STA     6,,PR1

  18288 16 003250   200271 236100                    LDQ     ID2$,,AUTO
        16 003251   200425 470500                    LDP0    COMPARISON$,,AUTO
        16 003252   000002 756100                    STQ     2,,PR0

  18289 16 003253   200423 236100                    LDQ     SUBSTR$,,AUTO
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:144  
        16 003254   200425 470500                    LDP0    COMPARISON$,,AUTO
        16 003255   000001 756100                    STQ     1,,PR0

  18290 16 003256   000027 235007                    LDA     23,DL
        16 003257   200425 470500                    LDP0    COMPARISON$,,AUTO
        16 003260   000003 755100                    STA     3,,PR0

  18291 16 003261   000005 236000 17                 LDQ     5
        16 003262   200425 470500                    LDP0    COMPARISON$,,AUTO
        16 003263   000007 756100                    STQ     7,,PR0

      977    18294
      978    18295    2   CALL Z8EK$BRANCH_TRUE( END_INDEX$,

  18295 16 003264   200425 630500                    EPPR0   COMPARISON$,,AUTO
        16 003265   200431 450500                    STP0    LENGTH_ID2$+2,,AUTO
        16 003266   200341 631500                    EPPR1   END_INDEX$,,AUTO
        16 003267   200430 451500                    STP1    LENGTH_ID2$+1,,AUTO
        16 003270   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 003271   000006 631400 17                 EPPR1   6
        16 003272   000000 701000 xent               TSX1    Z8EK$BRANCH_TRUE
        16 003273   000000 011000                    NOP     0

      979    18296    2                          COMPARISON$ );
      980    18297
      981    18298        %NEW_ILL( @ID  = %AD2I,
      982    18299                  @LOP = COUNT$ -> LX_ETT_ITEM.ETT$,
      983    18300                  @ROP = TWO$ -> LX_ETT_ITEM.ETT$ );

  18613 16 003274   200337 470500                    LDP0    @COUNT$,,AUTO
        16 003275   000000 471500                    LDP1    0,,PR0
        16 003276   000027 236000 17                 LDQ     23
        16 003277   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 003300   100001 633500                    EPPR3   1,,PR1
        16 003301   200435 453500                    STP3    LENGTH_ID2$+6,,AUTO
        16 003302   200430 631500                    EPPR1   LENGTH_ID2$+1,,AUTO
        16 003303   200434 451500                    STP1    LENGTH_ID2$+5,,AUTO
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:145  
        16 003304   000062 237000 17                 LDAQ    50
        16 003305   200432 757100                    STAQ    LENGTH_ID2$+3,,AUTO
        16 003306   000010 236000 17                 LDQ     8
        16 003307   200431 756100                    STQ     LENGTH_ID2$+2,,AUTO
        16 003310   200431 630500                    EPPR0   LENGTH_ID2$+2,,AUTO
        16 003311   000055 631400 17                 EPPR1   45
        16 003312   000000 701000 xent               TSX1    Z8AN$NEW_ILL1
        16 003313   000000 011000                    NOP     0

  18616 16 003314   200337 470500                    LDP0    @COUNT$,,AUTO
        16 003315   000000 471500                    LDP1    0,,PR0
        16 003316   100001 236100                    LDQ     1,,PR1
        16 003317   000000 473400 11                 LDP3    ILL$
        16 003320   300001 756100                    STQ     1,,PR3

  18617 16 003321   200314 471500                    LDP1    TWO$,,AUTO
        16 003322   100001 236100                    LDQ     1,,PR1
        16 003323   300002 756100                    STQ     2,,PR3

      984    18679
      985    18680    2   CALL Z8EK$BRANCH( BEGAIN_INDEX$ );

  18680 16 003324   200340 631500                    EPPR1   BEGAIN_INDEX$,,AUTO
        16 003325   200430 451500                    STP1    LENGTH_ID2$+1,,AUTO
        16 003326   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 003327   000020 631400 17                 EPPR1   16
        16 003330   000000 701000 xent               TSX1    Z8EK$BRANCH
        16 003331   000000 011000                    NOP     0

      986    18681
      987    18682        %NEW_ILL( @ID = %DEFLB,
      988    18683                  @LOP = END_INDEX$ );

  19004 16 003332   000027 236000 17                 LDQ     23
        16 003333   200430 756100                    STQ     LENGTH_ID2$+1,,AUTO
        16 003334   200430 630500                    EPPR0   LENGTH_ID2$+1,,AUTO
        16 003335   200435 450500                    STP0    LENGTH_ID2$+6,,AUTO
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:146  
        16 003336   000030 236000 17                 LDQ     24
        16 003337   200434 756100                    STQ     LENGTH_ID2$+5,,AUTO
        16 003340   000032 237000 17                 LDAQ    26
        16 003341   200432 757100                    STAQ    LENGTH_ID2$+3,,AUTO
        16 003342   200432 630500                    EPPR0   LENGTH_ID2$+3,,AUTO
        16 003343   000015 631400 17                 EPPR1   13
        16 003344   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        16 003345   000000 011000                    NOP     0

  19013 16 003346   200341 236100                    LDQ     END_INDEX$,,AUTO
        16 003347   000000 470400 11                 LDP0    ILL$
        16 003350   000001 756100                    STQ     1,,PR0

      989    19062
      990    19063
      991    19064    2   END KANJI_INDEX;

  19064 16 003351   200336 221300                    LDX1  ! OP+1,,AUTO
        16 003352   000001 702211                    TSX2  ! 1,X1

      992    19065    1   END Z8EZ$STRING;

  19065 16 003353   000000 702200 xent               TSX2  ! X66_ARET
      993    19066
      994    19067        %EOD;

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:147  
--  Include file information  --

   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8E_ILS_LIST.:Z8A6TOU  is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LIBRARY.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EZ$STRING.
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:148  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 002 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 003 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 004 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:149  
  ****  Section 005 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 006 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 007 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 008 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 009 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 010 LblCom ETT_

PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:150  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ETT_

  ****  Section 011 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 012 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILL_

  ****  Section 013 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAP$

  ****  Section 014 LblCom ILS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILS$

  ****  Section 015 LblCom ILS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:151  

     0-0-0/w STRC(180)         1 ILS_

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   337-0-0/w PTR         r     1 @COUNT$                  341-0-0/w PTR         r     1 @ID$
   340-0-0/w PTR         r     1 @ID1$                    337-0-0/w PTR         r     1 @ID1$
   337-0-0/w PTR         r     1 @ID1$                    337-0-0/w PTR         r     1 @ID2$
   337-0-0/w PTR         r     1 @ID2$                    337-0-0/w PTR         r     1 @ID3$
   337-0-0/w PTR         r     1 @ID3$                    340-0-0/w PTR         r     1 @ID3$
   337-0-0/w PTR         r     1 @ID3$                    340-0-0/w PTR         r     1 @ID3$
   337-0-0/w PTR         r     1 @ID4$                    337-0-0/w PTR         r     1 @ID4$
     4-0-0/w PTR         r     1 @INTO$                   341-0-0/w PTR         r     1 @LENGTH
     7-0-0/w PTR         r     1 @NOT_ON_OVERFLOW$        342-0-0/w PTR         r     1 @OFFSET
     6-0-0/w PTR         r     1 @ON_OVERFLOW$              5-0-0/w PTR         r     1 @POINTER$
   340-0-0/w PTR         r     1 @RETURN$                 340-0-0/w PTR         r     1 @RETURN$
   340-0-0/w PTR         r     1 @RETURN$                 341-0-0/w PTR         r     1 @RETURN$
     3-0-0/w PTR         r     1 @STRING_LIST$            224-0-0/d STRC(288)   r     1 ADD
   315-0-0/w PTR         r     1 ADD$                     340-0-0/w PTR         r     1 BEGAIN_INDEX$
   362-0-0/d STRC(288)   r     1 COMPARISON               307-0-0/w PTR         r     1 COMPARISON$
   425-0-0/w PTR         r     1 COMPARISON$              342-0-0/d STRC(288)         1 COUNT
    *0-0-0/w PTR         r     1 COUNT$                   422-0-0/w PTR               1 COUNT_BASE$
   331-0-0/w SBIN        r     1 CURRENT_OFFSET           300-0-0/w PTR               1 DELIMITER$
   341-0-0/w PTR         r     1 END_INDEX$               305-0-0/w PTR         r     1 END_STRING$
   341-0-0/w PTR         r     1 ETT$$                    345-0-0/w SBIN        r     1 FISS_LENGTH
    *0-0-0/w PTR         r     1 ID$                       44-0-0/d STRC(288)   r     1 ID1
   270-0-0/w PTR         r     1 ID1$                      *0-0-0/w PTR         r     1 ID1$
    *0-0-0/w PTR         r     1 ID1$                      *0-0-0/w PTR         r     1 ID1$
   333-0-0/w SBIN        r     1 ID1_COUNT                334-0-0/w SBIN        r     1 ID1_MAX
    54-0-0/d STRC(288)   r     1 ID2                      271-0-0/w PTR         r     1 ID2$
    *0-0-0/w PTR         r     1 ID2$                      *0-0-0/w PTR         r     1 ID2$
    64-0-0/d STRC(288)   r     1 ID3                      272-0-0/w PTR         r     1 ID3$
    *0-0-0/w PTR         r     1 ID3$                      *0-0-0/w PTR         r     1 ID3$
    *0-0-0/w PTR         r     1 ID3$                      *0-0-0/w PTR         r     1 ID3$
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:152  
    *0-0-0/w PTR         r     1 ID3$                     343-0-0/w SBIN        r     1 ID3_LEN
   332-0-0/w SBIN        r     1 ID3_LENGTH               274-0-0/w PTR         r     1 ID3_ST$
    74-0-0/d STRC(288)   r     1 ID4                      273-0-0/w PTR         r     1 ID4$
    *0-0-0/w PTR         r     1 ID4$                      *0-0-0/w PTR         r     1 ID4$
   342-0-0/w SBIN        r     1 ID4_MAX                   23-0-0/w PTR         r     1 IDENTS$
   301-0-0/w PTR               1 IDENTS_TAIL$             321-0-0/w PTR         r     1 INDEX$
   214-0-0/d STRC(288)   r     1 INDEX_EXPR               322-0-0/w PTR         r     1 INDEX_EXPR$
   204-0-0/d STRC(288)   r     1 INDX                      *0-0-0/w PTR         r     1 INTO$
   306-0-0/w PTR               1 INTO_LENGTH$             234-0-0/d STRC(288)   r     1 KANJI_LX_ETT
   310-0-0/w PTR         r     1 KANJI_LX_ETT$             10-0-0/w PTR               1 KEYWORD$
    *0-0-0/w SBIN        r     1 LENGTH                   104-0-0/d STRC(288)   r     1 LENGTH_ID1
   372-0-0/d STRC(288)   r     1 LENGTH_ID1               275-0-0/w PTR         r     1 LENGTH_ID1$
   426-0-0/w PTR         r     1 LENGTH_ID1$              114-0-0/d STRC(288)   r     1 LENGTH_ID2
   402-0-0/d STRC(288)   r     1 LENGTH_ID2               276-0-0/w PTR         r     1 LENGTH_ID2$
   427-0-0/w PTR         r     1 LENGTH_ID2$              124-0-0/d STRC(288)   r     1 LENGTH_ID3
   277-0-0/w PTR         r     1 LENGTH_ID3$              164-0-0/d STRC(288)   r     1 LENGTH_ID3_P1
   316-0-0/w PTR         r     1 LENGTH_ID3_P1$           317-0-0/w PTR         r     1 MINIMUM$
   174-0-0/d STRC(288)   r     1 MINIMUM_                  11-0-0/w STRC(324)         1 NAME
    *0-0-0/w PTR         r     1 NOT_ON_OVERFLOW$         304-0-0/w PTR         r     1 NO_OVERFLOW$
    *0-0-0/w SBIN        r     1 OFFSET                   134-0-0/d STRC(288)   r     1 ONE
   313-0-0/w PTR         r     1 ONE$                      *0-0-0/w PTR         r     1 ON_OVERFLOW$
   335-0-0/w SBIN        r     1 OP                       330-0-0/b BIT         r     1 OPTIMIZABLE
   344-0-0/w PTR         r     1 ORIGINAL_ID3_ETT$        326-0-0/b BIT         r     1 OVERFLOW
   303-0-0/w PTR         r     1 OVERFLOW$                244-0-0/d STRC(288)   r     1 PLUS_ONE
   312-0-0/w PTR         r     1 PLUS_ONE$                325-0-0/b BIT         r     1 POINTER
    *0-0-0/w PTR         r     1 POINTER$                 254-0-0/d STRC(288)   r     1 POINTER_TIMES2
   311-0-0/w PTR         r     1 POINTER_TIMES2$           34-0-0/d STRC(288)   r     1 RECEIVING
   320-0-0/w PTR         r     1 RECEIVING$               154-0-0/d STRC(288)   r     1 REMAINDER
   323-0-0/w PTR         r     1 REMAINDER$               343-0-0/w PTR         r     1 RESULT$
    *0-0-0/w PTR         r     1 RETURN$                   *0-0-0/w PTR         r     1 RETURN$
    *0-0-0/w PTR         r     1 RETURN$                   *0-0-0/w PTR         r     1 RETURN$
    24-0-0/d STRC(288)         1 SENDING                  327-0-0/b BIT         r     1 SIZE
   340-0-0/w PTR         r     1 ST$$                      22-0-0/w PTR         r     1 STRINGS$
   302-0-0/w PTR               1 STRINGS_TAIL$             *0-0-0/w PTR         r     1 STRING_LIST$
   352-0-0/d STRC(288)   r     1 SUB                      424-0-0/w PTR         r     1 SUB$
   423-0-0/w PTR         r     1 SUBSTR$                  412-0-0/d STRC(288)   r     1 SUB_STR
   324-0-0/w PTR         r     1 TABLE_ETT$               144-0-0/d STRC(288)   r     1 TWO
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:153  
   314-0-0/w PTR         r     1 TWO$                     264-0-0/w STRC(144)   r     1 TYPE_DESC

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w UBIN              1 ILL_STEP(0:144)
     0-0-0/w UBIN              1 ILS_STEP_TABLE(0:2)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(288)         1 ADD_STMT
     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(396)         1 ARRAY
     0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(108)   r     1 BINARY_ILL                 0-0-0/w STRC(288)   r     1 BINARY_OP
     0-0-0/w STRC(396)         1 BLOCK                      0-0-0/w STRC(144)         1 BRANCH_ILL
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(216)         1 CCOSU
     0-0-0/w STRC(396)         1 CD                         0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(396)         1 CLASS                      0-0-0/w STRC(108)         1 CODED_MOVE
     0-0-0/w STRC(288)         1 COMPUTE_STMT               0-0-0/w STRC(396)         1 CONDITION
     0-0-0/w STRC(396)   r     1 CONST                      0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(396)         1 DB                         0-0-0/w STRC(396)         1 DCB_
     0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER         0-0-0/w STRC(252)         1 DEFERED_ID_TREE
     0-0-0/w STRC(288)         1 DEFERED_QUAL_ID            0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(144)         1 DEFLB                      0-0-0/w STRC(288)         1 DELETE_STMT
     0-0-0/w STRC(288)         1 DIVIDE_STMT                0-0-0/w STRC(396)         1 DML_ITEM
     0-0-0/w STRC(144)         1 DOEND                      0-0-0/w STRC(396)         1 DO_N
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:154  
     0-0-0/w STRC(180)         1 DV4I                       0-0-0/w STRC(180)         1 ENTRY_ILL
     0-0-0/w STRC(180)   r     1 ETT                        0-0-0/w STRC(108)         1 EVALU
     0-0-0/w STRC(396)         1 FD                         0-0-0/w STRC(144)         1 GO
     0-0-0/w STRC(180)         1 ILL                        0-0-0/w STRC              1 ILL_NO_OPS
     0-0-0/w STRC(180)   r     1 ILS                        0-0-0/w STRC(288)   r     1 ILS_LIST
     0-0-0/w STRC(288)         1 INSPECT_1_STMT             0-0-0/w STRC(288)         1 INSPECT_2_STMT
     0-0-0/w STRC(288)         1 INSPECT_4_STMT             0-0-0/w STRC(396)         1 INTDEF
     0-0-0/w STRC(396)         1 LABEL                      0-0-0/w STRC(288)         1 LA_ITEM
     0-0-0/w STRC(108)         1 LINOI                      0-0-0/w STRC(504)         1 LX_CD_INPUT
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)   r     1 LX_ETT_ITEM                0-0-0/w STRC(288)   r     1 LX_ITEM
     0-0-0/w STRC(288)         1 LX_LARGE                   0-0-0/w STRC(288)   r     1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
     0-0-0/w STRC(288)   r     1 LX_TERMINAL                0-0-0/w STRC(72)          1 MFILL
     0-0-0/w STRC(396)         1 MNEMONIC                   0-0-0/w STRC(288)         1 MULTIPLY_STMT
     0-0-0/w STRC(180)         1 MULTI_GO                   0-0-0/w STRC(180)         1 MVEAL
     0-0-0/w STRC(108)         1 MVFIL                      0-0-0/w STRC(72)          1 MVIIS
     0-0-0/w STRC(144)         1 OPN                        0-0-0/w STRC(180)         1 OS_CALL
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(396)         1 PARA
     0-0-0/w STRC(216)         1 PFORM                      0-0-0/w STRC(144)         1 PINC
     0-0-0/w STRC(144)         1 PREOFF                     0-0-0/w STRC(108)         1 PRESET
     0-0-0/w STRC(396)         1 PROC_                      0-0-0/w STRC(396)         1 PROC_DEF
     0-0-0/w STRC(144)         1 P_A_PRESET                 0-0-0/w STRC(144)         1 P_P_PRESET
     0-0-0/w STRC(396)         1 RD                         0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(144)         1 REMEM                      0-0-0/w STRC(288)         1 REWRITE_STMT
     0-0-0/w STRC(396)   r     1 SCALAR                     0-0-0/w STRC(144)         1 SCOPE
     0-0-0/w STRC(396)         1 SD                         0-0-0/w STRC(216)         1 SEARCH_
     0-0-0/w STRC(396)         1 SECTION                    0-0-0/w STRC(396)         1 SEGMENT
     0-0-0/w STRC(396)         1 ST                         0-0-0/w STRC(288)         1 START_STMT
     0-0-0/w STRC(72)          1 STP2                       0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(396)         1 SWITCH
     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR              0-0-0/w STRC(396)         1 SYMDEF_
     0-0-0/w STRC(396)         1 SYMREF_                    0-0-0/w STRC(396)         1 TEMP
     0-0-0/w STRC(144)         1 TRINARY_ILL                0-0-0/w STRC(72)    r     1 UNARY_ILL
     0-0-0/w STRC(288)         1 UNARY_OP                   0-0-0/w STRC(288)         1 UNSTRING_STMT
     0-0-0/w STRC(216)         1 USER_CALL                  0-0-0/w STRC(108)         1 VAL
     0-0-0/w STRC(108)         1 VAL_END                    0-0-0/w STRC(396)   r     1 VARIABLE
PL6.E3A0      #001=Z8EZ$STRING File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 12:59 Page:155  
     0-0-0/w STRC(72)          1 WHEN                       0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EZ$STRING requires 1772 words for executable code.
   Procedure Z8EZ$STRING requires 286 words of local(AUTO) storage.

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:156  
      995        1        /*T***********************************************************/
      996        2        /*T*                                                         */
      997        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      998        4        /*T*                                                         */
      999        5        /*T***********************************************************/
     1000        6
     1001        7        /*P*   NAME: Z8EZ$UNSTRING
     1002        8             AUTHOR: John Heath (design by Mark Glenn)
     1003        9            PURPOSE: This procedure does semantic checking and produces
     1004       10                     the ILL/ETT for the UNSTRING statement.
     1005       11        */
     1006       12
     1007       13        /*D*   NAME: Z8EZ$UNSTRING
     1008       14
     1009       15              INPUT: Abstract Syntax Tree for the UNSTRING statement.
     1010       16
     1011       17             OUTPUT: ILS/ILL/ETT intermediate language items.
     1012       18
     1013       19        DESCRIPTION: Phase 1 makes 3 passes on the UNSTRING statement.
     1014       20                     The first pass (Z8EN) produces the Abstract
     1015       21                     Syntax Tree (AST).  The second and third passes
     1016       22                     are done by this procedure.
     1017       23
     1018       24             Pass 2: Validate the operands of the UNSTRING statement.
     1019       25
     1020       26             Pass 3: Generate the intermediate language items to do
     1021       27                     the UNSTRING statement.  The UNSTRING statement is
     1022       28                     broken down into smaller statements (MOVE, IF, etc.)
     1023       29                     by this module, thus it makes calls to procedures
     1024       30                     used by these smaller statements (Z8E7$MOVE,
     1025       31                     Z8EK$BRANCH_TRUE, etc.).
     1026       32
     1027       33                     Pass 3 is broken into two parts: optimizable and
     1028       34                     not-optimizable.  The algorithm for optimizable
     1029       35                     UNSTRING (simple UNSTRING with no DELIMITED clauses)
     1030       36                     generates a series of MOVEs.  The algorithm for
     1031       37                     non-optimizable UNSTRING is highly dependent on the
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:157  
     1032       38                     types and numbers of optional clauses used in the
     1033       39                     the statement.
     1034       40        */
     1035       41
     1036       42        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:158  
     1037       43        Z8EZ$UNSTRING: PROC(UNSTRING$,
     1038       44                            ON_OVERFLOW$,
     1039       45                            NOT_ON_OVERFLOW$ );
     1040       46
     1041       47             %EQU PHASE = 1;
     1042       48             %INCLUDE Z8A_DEFC;
     1043      116             %INCLUDE Z8A_SUPP_MAC;
     1044     2516             %INCLUDE Z8E_MACROS;
     1045     3191             %INCLUDE Z8E_STACKS;
     1046     5457             %INCLUDE Z8A_ST;
     1047     9116             %INCLUDE Z8A_TYPES ;
     1048     9290             %INCLUDE Z8A_ILL ;
     1049     9983             %INCLUDE Z8A_ETT ;
     1050    10284             %INCLUDE Z8E_ILS_LIST ;
     1051    10368             %INCLUDE Z8E_O1COM ;
     1052    11129             %INCLUDE Z8E_WINDOW ;
     1053    13199             %INCLUDE Z8A_LIBRARY ;
     1054    13413             %INCLUDE Z8A_COMCOM ;
     1055    14063             %INCLUDE Z8A_ILS ;
     1056    14172             %INCLUDE Z8A_LTS ;
     1057    16249             %INCLUDE Z8A_ERR_NUMS ;
     1058    17013             %INCLUDE Z8A_DNT ;
     1059    17234
     1060    17235    1   DCL UNSTRING$       PTR;
     1061    17236    1   DCL ON_OVERFLOW$    PTR;
     1062    17237    1   DCL NOT_ON_OVERFLOW$ PTR;
     1063    17238
     1064    17239    1   DCL  ADD$              PTR ;
     1065    17240    1   DCL  SUB$              PTR ;
     1066    17241    1   DCL  ALL               BOOLEAN ;
     1067    17242    1   DCL  ALL_ID2S_ARE_CONSTANT  BOOLEAN ;
     1068    17243    1   DCL  ALL_LENGTH_1      BOOLEAN ;
     1069    17244    1   DCL  AND$              PTR ;
     1070    17245    1   DCL  ASCBIN$           PTR ;
     1071    17246    1   DCL  COMPARISON$       PTR ;
     1072    17247    1   DCL  COMPARISON2$      PTR ;
     1073    17248    1   DCL  COUNT             BOOLEAN ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:159  
     1074    17249    1   DCL  COUNT$            PTR ;
     1075    17250    1   DCL  CURRENT_OFFSET    SBIN WORD ;
     1076    17251    1   DCL  DELIMITED         BOOLEAN ;
     1077    17252    1   DCL  DELIMITER         BOOLEAN ;
     1078    17253    1   DCL  DELIMITER$        PTR ;
     1079    17254    1   DCL  DELIMS$           PTR ;
     1080    17255    1   DCL  DNT$$             PTR ;
     1081    17256    1   DCL  END_IF$           PTR ;
     1082    17257    1   DCL  END_INTO$         PTR ;
     1083    17258    1   DCL  EXIT_INTO_LOOP$    PTR ;
     1084    17259    1   DCL  END_UNSTRING$     PTR ;
     1085    17260    1   DCL  ID1$              PTR ;
     1086    17261    1   DCL  ID1_ST$           PTR ;
     1087    17262    1   DCL  ID2$              PTR ;
     1088    17263    1   DCL  ID2_CHAR          CHAR (1) ;
     1089    17264    1   DCL  ID4$              PTR ;
     1090    17265    1   DCL  ID5$              PTR ;
     1091    17266    1   DCL  ID6$              PTR ;
     1092    17267    1   DCL  ID6_PLUS_ID7$     PTR ;
     1093    17268    1   DCL  ID7$              PTR ;
     1094    17269    1   DCL  ID8$              PTR ;
     1095    17270    1   DCL  IDENT$            PTR ;
     1096    17271    1   DCL  INTO$             PTR ;
     1097    17272    1   DCL  INTO_LABEL$       PTR ;
     1098    17273    1   DCL  INTO_LIST$        PTR ;
     1099    17274    1   DCL  INTO_NO           SBIN WORD ;
     1100    17275    1   DCL  INTO_MAX          SBIN WORD ;
     1101    17276    1   DCL  ID1_LENGTH        SBIN WORD ;
     1102    17277    1   DCL  LENGTH_ID1$       PTR ;
     1103    17278    1   DCL  LENGTH_ID2$       PTR ;
     1104    17279    1   DCL  LENGTH_ID4$       PTR ;
     1105    17280    1   DCL  LOW_VALUE_DELIM   BOOLEAN ;                            /*#30498*/
     1106    17281    1   DCL  LTS$$             PTR ;
     1107    17282    1   DCL  MIN$              PTR ;
     1108    17283    1   DCL  NOT_OVERFLOW_LABEL$ PTR;
     1109    17284    1   DCL  ONE$              PTR ;
     1110    17285    1   DCL  OPTIMIZABLE       BOOLEAN ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:160  
     1111    17286    1   DCL  OVERFLOW          BOOLEAN ;
     1112    17287    1   DCL  OVERFLOW_LABEL$   PTR ;
     1113    17288    1   DCL  POINTER           BOOLEAN ;
     1114    17289    1   DCL  POINTER$          PTR ;
     1115    17290    1   DCL  POSITION$         PTR ;
     1116    17291    1   DCL  PRODUCE_UNSTRING_ILS  BOOLEAN ;
     1117    17292    1   DCL  ST$$              PTR ;
     1118    17293    1   DCL  SPACE_LX$         PTR ;
     1119    17294    1   DCL  SUBSTR$           PTR ;
     1120    17295    1   DCL  TABLE$            PTR ;
     1121    17296    1   DCL  TABLEVAL$         PTR ;
     1122    17297    1   DCL  TABLE_ETT$        PTR ;
     1123    17298    1   DCL  TALLYING          BOOLEAN ;
     1124    17299    1   DCL  TALLYING$         PTR ;
     1125    17300    1   DCL  ZERO$             PTR ;
     1126    17301    1   DCL  TWO$              PTR;
     1127    17302    1   DCL  ID7_TIMES_2$      PTR;
     1128    17303    1   DCL  ID7_DIVIDE_2$     PTR;
     1129    17304    1   DCL  ID6_DIVIDE_2$     PTR;
     1130    17305    1   DCL  ID7_ST$           PTR;
     1131    17306    1   DCL  PLUS_ONE$         PTR;
     1132    17307    1   DCL  SUB_ONE$          PTR;
     1133    17308
     1134    17309    1   DCL 1 TYPE_DESC ALIGNED,
     1135    17310             %TYPE_DESC ;
     1136    17344
     1137    17345    1   DCL 1  SAVED_ILS_LIST DALIGNED,
     1138    17346    1        2 * (0:%(LENGTH_LX_ITEM - 1)) PTR ALIGNED ;
     1139    17347
     1140    17348    1   DCL 1  DO_BODY_ILS_LIST DALIGNED,
     1141    17349    1        2 * (0:%(LENGTH_LX_ITEM - 1)) PTR ALIGNED ;
     1142    17350
     1143    17351
     1144    17352    1   DCL  Z8AC$LX_ETT_ITEM_TYI_CONST ENTRY(2) ;
     1145    17353    1   DCL  Z8AE$ERROR                ENTRY (12) ;
     1146    17354    1   DCL  Z8AF$FORME                ENTRY (4) ;
     1147    17355    1   DCL  Z8AF$NEW_FISS             ENTRY (4) ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:161  
     1148    17356    1   DCL  Z8AF$NEW_OFF              ENTRY (3) ;
     1149    17357    1   DCL  Z8AH$NEW_DNT              ENTRY (3) ;
     1150    17358    1   DCL  Z8AT$CREATE_TEMPORARY     ENTRY (2) ;
     1151    17359    1   DCL  Z8AT$CREATE_TEMP_WITH_BASE ENTRY(2) ;
     1152    17360    1   DCL  Z8AU$LENGTH               ENTRY (2) ;
     1153    17361    1   DCL  Z8AU$LENGTH_ETT           ENTRY (2) ;
     1154    17362    1   DCL  Z8EZ$MAX_VALUE            ENTRY (2) ;
     1155    17363    1   DCL  Z8AU$TYPE_DESCRIPTOR      ENTRY (2) ;
     1156    17364    1   DCL  Z8E5$MATH_PACK            ENTRY (2) ;
     1157    17365    1   DCL  Z8E7$MOVE                 ENTRY (2) ;
     1158    17366    1   DCL  Z8EA$ASCBIN               ENTRY (2) ;
     1159    17367    1   DCL  Z8EA$SUBSTR_ZERO          ENTRY (4) ;
     1160    17368    1   DCL  Z8ED$DISPOSE_ABSSYN_TREE  ENTRY (1) ;
     1161    17369    1   DCL  Z8EK$BRANCH               ENTRY (1) ;
     1162    17370    1   DCL  Z8EK$BRANCH_FALSE         ENTRY (2) ;
     1163    17371    1   DCL  Z8EK$BRANCH_TRUE          ENTRY (2) ;
     1164    17372    1   DCL  Z8EK$COMPARE              ENTRY (4) ;
     1165    17373    1   DCL  Z8CO$CREATE_LIBRARY_BASE  ENTRY (2) ;
     1166    17374    1   DCL  Z8CO$DISPL_CHECK          ENTRY (1) ALTRET ;
     1167    17375    1   DCL  Z8CO$INTEGER_CHECK        ENTRY(1) ALTRET;
     1168    17376    1   DCL  Z8CO$INTEGER_CHECK_NO_ERROR ENTRY(1) ALTRET;
     1169    17377    1   DCL  Z8CO$P_CHECK              ENTRY (1) ALTRET ;
     1170    17378    1   DCL  Z8EV$CONVERT              ENTRY (3) ;
     1171    17379    1   DCL  Z8EV$CONVERT_TYA          ENTRY (3) ;
     1172    17380    1   DCL  Z8EQ$CREATE_DO_WHILE      ENTRY (2) ;
     1173    17381    1   DCL  Z8EY$SUBSTR               ENTRY (4) ;
     1174    17382    1   DCL  Z8EZ$SEARCH               ENTRY (5) ;
     1175    17383
     1176    17384        %DCL_AUTO_LX_ITEM (@NAME = ADD) ;
     1177    17388        %DCL_AUTO_LX_ITEM (@NAME = SUB) ;
     1178    17392        %DCL_AUTO_LX_ITEM (@NAME = ANDD) ;
     1179    17396        %DCL_AUTO_LX_ITEM (@NAME = ASC_BIN) ;
     1180    17400        %DCL_AUTO_LX_ITEM (@NAME = COMPARISON) ;
     1181    17404        %DCL_AUTO_LX_ITEM (@NAME = COMPARISON2) ;
     1182    17408        %DCL_AUTO_LX_ITEM (@NAME = ID1) ;
     1183    17412        %DCL_AUTO_LX_ITEM (@NAME = ID2) ;
     1184    17416        %DCL_AUTO_LX_ITEM (@NAME = ID4) ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:162  
     1185    17420        %DCL_AUTO_LX_ITEM (@NAME = ID5) ;
     1186    17424        %DCL_AUTO_LX_ITEM (@NAME = ID6) ;
     1187    17428        %DCL_AUTO_LX_ITEM (@NAME = ID6_PLUS_ID7) ;
     1188    17432        %DCL_AUTO_LX_ITEM (@NAME = ID7) ;
     1189    17436        %DCL_AUTO_LX_ITEM (@NAME = ID8) ;
     1190    17440        %DCL_AUTO_LX_ITEM (@NAME = LENGTH_ID1) ;
     1191    17444        %DCL_AUTO_LX_ITEM (@NAME = LENGTH_ID2) ;
     1192    17448        %DCL_AUTO_LX_ITEM (@NAME = LENGTH_ID4) ;
     1193    17452        %DCL_AUTO_LX_ITEM (@NAME = LOW) ;                           /*#30498*/
     1194    17456        %DCL_AUTO_LX_ITEM (@NAME = MIN) ;
     1195    17460        %DCL_AUTO_LX_ITEM (@NAME = ONE) ;
     1196    17464        %DCL_AUTO_LX_ITEM (@NAME = ID7_TIMES_2);
     1197    17468        %DCL_AUTO_LX_ITEM (@NAME = ID7_DIVIDE_2);
     1198    17472        %DCL_AUTO_LX_ITEM (@NAME = ID6_DIVIDE_2);
     1199    17476        %DCL_AUTO_LX_ITEM (@NAME = POSITION) ;
     1200    17480        %DCL_AUTO_LX_ITEM (@NAME = SPACE_LX) ;
     1201    17484        %DCL_AUTO_LX_ITEM (@NAME = SUB_STR) ;
     1202    17488        %DCL_AUTO_LX_ITEM (@NAME = TABLE) ;
     1203    17492        %DCL_AUTO_LX_ITEM (@NAME = TABLEVAL) ;
     1204    17496        %DCL_AUTO_LX_ITEM (@NAME = TWO) ;
     1205    17500        %DCL_AUTO_LX_ITEM (@NAME = ZERO) ;
     1206    17504        %DCL_AUTO_LX_ITEM (@NAME = PLUS_ONE);
     1207    17508        %DCL_AUTO_LX_ITEM (@NAME = SUB_ONE);
     1208    17512
     1209    17513        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:163  
     1210    17514        %MACRO IF_THEN_DO (@LOP =, @REL =, @ROP =, @LAB =) ;
     1211    17515
     1212    17516               DO ;
     1213    17517                 %LSET LINE@ = CHARTEXT (CONCAT (TEXTCHAR (@LOP),
     1214    17518                                                 ' -> LX_ETT_ITEM.LINE')) ;
     1215    17519                 %LSET COLUMN@ = CHARTEXT (CONCAT (TEXTCHAR (@LOP),
     1216    17520                                                 ' -> LX_ETT_ITEM.COLUMN')) ;
     1217    17521
     1218    17522                 COMPARISON$ = ADDR (COMPARISON) ;
     1219    17523                 %INIT_BINARY_OP (@POINTER = COMPARISON$,
     1220    17524                                  @LOP$    = @LOP,
     1221    17525                                  @OP      = @REL,
     1222    17526                                  @ROP$    = @ROP,
     1223    17527                                  @LINE    = %LINE@,
     1224    17528                                  @COLUMN  = %COLUMN@) ;
     1225    17529
     1226    17530                 CALL Z8AT$CREATE_TEMPORARY (%PARA, @LAB) ;
     1227    17531                 CALL Z8EK$BRANCH_FALSE (@LAB, COMPARISON$) ;
     1228    17532               END ;
     1229    17533
     1230    17534        %MEND ;
     1231    17535
     1232    17536        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:164  
     1233    17537        /*V* PASS 2 --- Validate the operands of the UNSTRING statement */
     1234    17538
     1235    17539    1        IF COMCOM.OB.FIPS.LEVEL >= %INT_LEV THEN
     1236    17540    1          CALL Z8AE$ERROR (%E$LEVEL_CHECK,
     1237    17541    1                           O1COM.LINE_NO,
     1238    17542    1                           O1COM.COLUMN_NO);
     1239    17543    1        OPTIMIZABLE = TRUE ;
     1240    17544    1        PRODUCE_UNSTRING_ILS = TRUE ;
     1241    17545
     1242    17546    1        IDENT$   = UNSTRING$ -> UNSTRING_STMT.IDENT$;
     1243    17547    1        POINTER$ = UNSTRING$ -> UNSTRING_STMT.POINTER$;
     1244    17548    1        TALLYING$ = UNSTRING$ -> UNSTRING_STMT.TALLYING$;
     1245    17549
     1246    17550    1        IF UNSTRING$ -> UNSTRING_STMT.DELIM_LIST$ = ADDR(NIL) THEN
     1247    17551    1          DELIMS$ = ADDR(NIL);
     1248    17552    1        ELSE
     1249    17553    1          DELIMS$ = UNSTRING$ -> UNSTRING_STMT.DELIM_LIST$ -> LX_LIST.HEAD$;
     1250    17554    1        DELIMITED = DELIMS$ ~= ADDR(NIL) ;
     1251    17555
     1252    17556    1        INTO_LIST$ = UNSTRING$ -> UNSTRING_STMT.INTO_LIST$ -> LX_LIST.HEAD$;
     1253    17557
     1254    17558    1        CALL VALIDATE_ID1 (IDENT$) ;
     1255    17559    1        CALL VALIDATE_ID7 (POINTER$, IDENT$) ;
     1256    17560    1        CALL VALIDATE_ID8 (TALLYING$) ;
     1257    17561
     1258    17562    1        ALL_LENGTH_1 = TRUE ;
     1259    17563    1        ALL_ID2S_ARE_CONSTANT = TRUE ;
     1260    17564
     1261    17565    2        DO WHILE (DELIMS$ ~= ADDR(NIL));
     1262    17566    2          CALL VALIDATE_ID2 (DELIMS$);
     1263    17567    2          OPTIMIZABLE = FALSE ;
     1264    17568
     1265    17569    2          DELIMS$ = DELIMS$ -> LX_ITEM.LINK;
     1266    17570    2        END /* While */;
     1267    17571
     1268    17572    1        INTO_MAX = 0 ;
     1269    17573
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:165  
     1270    17574    2        DO UNTIL (INTO_LIST$ = ADDR(NIL));
     1271    17575    2          INTO_MAX = INTO_MAX + 1 ;
     1272    17576    2          ID4$ = INTO_LIST$ -> LX_LIST.HEAD$;
     1273    17577    2          ID5$ = INTO_LIST$ -> LX_LIST.HEAD$ -> LX_ITEM.LINK;
     1274    17578    2          ID6$ = INTO_LIST$ -> LX_LIST.TAIL$;
     1275    17579
     1276    17580    2          CALL VALIDATE_ID4 (ID4$) ;
     1277    17581    2          CALL VALIDATE_ID5 (ID5$) ;
     1278    17582    2          CALL VALIDATE_ID6 (ID6$) ;
     1279    17583
     1280    17584    2          INTO_LIST$ = INTO_LIST$ -> LX_LIST.LINK;
     1281    17585    2        END /* Until */;
     1282    17586
     1283    17587        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:166  
     1284    17588        /*V* UNSTRING_PASS_3 */
     1285    17589
     1286    17590    1          IF PRODUCE_UNSTRING_ILS = FALSE THEN GOTO BAD_UNSTRING ;
     1287    17591
     1288    17592    1          ADD$ = ADDR (ADD) ;
     1289    17593    1          SUB$ = ADDR (SUB) ;
     1290    17594    1          AND$ = ADDR (ANDD) ;
     1291    17595    1          ASCBIN$ = ADDR (ASC_BIN) ;
     1292    17596    1          COMPARISON$ = ADDR (COMPARISON) ;
     1293    17597    1          COMPARISON2$ = ADDR (COMPARISON2) ;
     1294    17598    1          ID1$ = ADDR (ID1) ;
     1295    17599    1          ID2$ = ADDR (ID2) ;
     1296    17600    1          ID4$ = ADDR (ID4) ;
     1297    17601    1          ID5$ = ADDR (ID5) ;
     1298    17602    1          ID6$ = ADDR (ID6) ;
     1299    17603    1          ID6_PLUS_ID7$ = ADDR (ID6_PLUS_ID7) ;
     1300    17604    1          ID7$ = ADDR (ID7) ;
     1301    17605    1          ID8$ = ADDR (ID8) ;
     1302    17606    1          LENGTH_ID1$ = ADDR (LENGTH_ID1) ;
     1303    17607    1          LENGTH_ID2$ = ADDR (LENGTH_ID2) ;
     1304    17608    1          LENGTH_ID4$ = ADDR (LENGTH_ID4) ;
     1305    17609    1          MIN$ = ADDR (MIN) ;
     1306    17610    1          ONE$ = ADDR (ONE) ;
     1307    17611    1          TWO$ = ADDR (TWO);
     1308    17612    1          POSITION$ = ADDR (POSITION) ;
     1309    17613    1          SPACE_LX$ = ADDR (SPACE_LX) ;
     1310    17614    1          SUBSTR$ = ADDR (SUB_STR) ;
     1311    17615    1          TABLE$ = ADDR (TABLE) ;
     1312    17616    1          ZERO$ = ADDR (ZERO) ;
     1313    17617    1          ID7_TIMES_2$ = ADDR(ID7_TIMES_2);
     1314    17618    1          ID7_DIVIDE_2$ = ADDR(ID7_DIVIDE_2);
     1315    17619    1          ID6_DIVIDE_2$ = ADDR(ID6_DIVIDE_2);
     1316    17620    1          PLUS_ONE$ = ADDR(PLUS_ONE);
     1317    17621    1          SUB_ONE$ = ADDR(SUB_ONE);
     1318    17622    1          END_IF$ = ADDR(NIL);
     1319    17623    1          OVERFLOW = %FALSE;
     1320    17624
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:167  
     1321    17625               %INIT_LX_ETT_ITEM (@POINTER = ASCBIN$, @TYPE = %TYI) ;
     1322    17647               %INIT_LX_ETT_ITEM (@POINTER = TABLE$ , @TYPE = %TYA) ;
     1323    17669    1          CALL Z8AH$NEW_DNT (' ', 1, DNT$) ;
     1324    17670               %NEW_CONST (@ST$ = ST$,
     1325    17671                           @DNT$ = DNT$,
     1326    17672                           @TYPE = %TYA,
     1327    17673                           @ALL = TRUE) ;
     1328    17714               %INIT_LX_TERMINAL (@POINTER = SPACE_LX$, @ST$ = ST$, @DNT$ = DNT$, @SYMBOL =
             17714                   %RSV_WRD_SPACES) ;
     1329    17732    1          SPACE_LX$ -> LX_TERMINAL.B.ALL = TRUE ;
     1330    17733               %INIT_LX_ETT_ITEM (@POINTER = SUBSTR$, @TYPE = %TYA) ;
     1331    17755
     1332    17756    1          CALL Z8AT$CREATE_TEMP_WITH_BASE (%SCALAR, TABLE_ETT$) ;
     1333    17757    1          TABLE_ETT$ -> ETT.LOP -> ST.TYPE = %TYA ;
     1334    17758    1          TABLE_ETT$ -> ETT.LOP -> ST.ADSC.N = 512 ;
     1335    17759    1          TABLE$ -> LX_ETT_ITEM.ETT$ = TABLE_ETT$ ;
     1336    17760
     1337    17761    1          CALL Z8AC$LX_ETT_ITEM_TYI_CONST (1, ONE$) ;
     1338    17762    1          CALL Z8AC$LX_ETT_ITEM_TYI_CONST (0, ZERO$) ;
     1339    17763    1          CALL Z8AC$LX_ETT_ITEM_TYI_CONST (2, TWO$) ;
     1340    17764
     1341    17765    1          IF ON_OVERFLOW$ ~= ADDR(NIL)   OR
     1342    17766    1                NOT_ON_OVERFLOW$ ~= ADDR(NIL)   THEN
     1343    17767    2            DO;
     1344    17768    2              OVERFLOW = %TRUE;
     1345    17769    2              OPTIMIZABLE = %FALSE ;
     1346    17770    2            END;
     1347    17771
     1348    17772    1          CALL PREPARE_ID1 (IDENT$, ID1$) ;
     1349    17773
     1350    17774        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:168  
     1351    17775        /*V* PASS 3a -- Generate the ILL to do the UNSTRING (optimizable)
     1352    17776
     1353    17777             UNSTRING id1 INTO id4a, id4b, ...
     1354    17778
     1355    17779                       MVAN                    MVAN       . . .
     1356    17780                      /    \                  /    \
     1357    17781                    id4a   id1             id4b    OFF
     1358    17782                                                  /   \
     1359    17783                                                id1  length_id4a
     1360    17784        */
     1361    17785
     1362    17786    2          IF OPTIMIZABLE THEN DO ;
     1363    17787
     1364    17788    2            CURRENT_OFFSET = 0 ;
     1365    17789    2            ID1_LENGTH = LENGTH_ID1$
     1366    17790    2                      -> LX_ETT_ITEM.ETT$
     1367    17791    2                      -> ETT.LOP
     1368    17792    2                      -> CONST.CONSTI.WORD1 ;
     1369    17793    2            INTO_LIST$ = UNSTRING$ -> UNSTRING_STMT.INTO_LIST$ -> LX_LIST.HEAD$ ;
     1370    17794
     1371    17795    3            DO WHILE (INTO_LIST$ ~= ADDR(NIL)) ;
     1372    17796
     1373    17797    3              INTO$ = INTO_LIST$ -> LX_LIST.HEAD$ ;
     1374    17798    3              CALL PREPARE_ID4 (INTO$, ID4$) ;
     1375    17799
     1376    17800    4              IF CURRENT_OFFSET < ID1_LENGTH THEN DO ;
     1377    17801
     1378    17802    4                CALL MOVE (ID1$, ID4$,
     1379    17803    4                           LENGTH_ID4$
     1380    17804    4                           -> LX_ETT_ITEM.ETT$
     1381    17805    4                           -> ETT.LOP
     1382    17806    4                           -> CONST.CONSTI,
     1383    17807    4                           CURRENT_OFFSET) ;
     1384    17808
     1385    17809    4              END ; /* Current Offset < Length(id1) */
     1386    17810
     1387    17811    3              INTO_LIST$ = INTO_LIST$ -> LX_LIST.LINK ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:169  
     1388    17812
     1389    17813    3            END ; /* While INTO_LIST$ <> Nil */
     1390    17814
     1391    17815    2          END ; /* Optimizable */
     1392    17816
     1393    17817    2          ELSE DO ;
     1394    17818
     1395    17819        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:170  
     1396    17820        /*V* PASS 3b -- Generate the ILL for UNSTRING (non-optimizable) */
     1397    17821
     1398    17822    2            CALL PREPARE_ID7 (POINTER$, ID7$) ;
     1399    17823    2            CALL PREPARE_ID8 (TALLYING$, ID8$) ;
     1400    17824
     1401    17825    2            CALL Z8AT$CREATE_TEMPORARY (%PARA, OVERFLOW_LABEL$) ;
     1402    17826    2            CALL Z8AT$CREATE_TEMPORARY( %PARA, NOT_OVERFLOW_LABEL$ );
     1403    17827    2            CALL Z8AT$CREATE_TEMPORARY (%PARA, END_UNSTRING$) ;
     1404    17828    2            EXIT_INTO_LOOP$ = ADDR(NIL) ;
     1405    17829    2            LOW_VALUE_DELIM = FALSE ;                          /*#30498*/
     1406    17830
     1407    17831                 %FISH( TRIAD = ID1$ -> LX_ETT_ITEM.ETT$,
     1408    17832                        RTN   = ID1_ST$ );
     1409    17840
     1410    17841    2            IF ID1_ST$ -> SCALAR.B.KANJI    THEN
     1411    17842    3              DO;
     1412    17843
     1413    17844                     %INIT_BINARY_OP( @POINTER = ID7_TIMES_2$,
     1414    17845                                      @OP = %OP_STAR,
     1415    17846                                      @LOP$ = ID7$,
     1416    17847                                      @ROP$ = TWO$ );
     1417    17865
     1418    17866                     %INIT_BINARY_OP( @POINTER = SUB_ONE$,
     1419    17867                                      @OP = %OP_BINARY_MINUS,
     1420    17868                                      @LOP$ = ID7_TIMES_2$,
     1421    17869                                      @ROP$ = ONE$ );
     1422    17887
     1423    17888    3                CALL Z8E5$MATH_PACK( SUB_ONE$, SUB_ONE$ );
     1424    17889    3                CALL Z8E7$MOVE( ID7$, SUB_ONE$ );
     1425    17890
     1426    17891    3              END;
     1427    17892
     1428    17893    3            IF POINTER THEN DO ;
     1429    17894
     1430    17895                   /* IF ID7 < 1 THEN GO TO OVERFLOW */
     1431    17896
     1432    17897                   %INIT_BINARY_OP (@POINTER = COMPARISON$,
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:171  
     1433    17898                                    @LOP$    = ID7$,
     1434    17899                                    @OP      = %OP_LESS_THAN_OR_EQUAL,
     1435    17900                                    @ROP$    = ZERO$,
     1436    17901                                    @LINE    = "ID7$ -> LX_ETT_ITEM.LINE",
     1437    17902                                    @COLUMN  = "ID7$ -> LX_ETT_ITEM.COLUMN") ;
     1438    17920
     1439    17921    3              CALL Z8EK$BRANCH_TRUE (OVERFLOW_LABEL$, COMPARISON$) ;
     1440    17922
     1441    17923                   /* IF ID7 > LENGTH (ID1) THEN GOTO OVERFLOW */
     1442    17924
     1443    17925                   %INIT_BINARY_OP (@POINTER = COMPARISON$,
     1444    17926                                    @LOP$    = ID7$,
     1445    17927                                    @OP      = %OP_GREATER_THAN,
     1446    17928                                    @ROP$     = LENGTH_ID1$,
     1447    17929                                    @LINE    = "ID7$ -> LX_ETT_ITEM.LINE",
     1448    17930                                    @COLUMN  = "ID7$ -> LX_ETT_ITEM.COLUMN") ;
     1449    17948
     1450    17949    3              CALL Z8EK$BRANCH_TRUE (OVERFLOW_LABEL$, COMPARISON$) ;
     1451    17950
     1452    17951    3            END ; /* POINTER SPECIFIED */
     1453    17952
     1454    17953    2            IF UNSTRING$ -> UNSTRING_STMT.DELIM_LIST$ = ADDR(NIL) THEN
     1455    17954    2              DELIMS$ = ADDR(NIL);
     1456    17955    2            ELSE
     1457    17956    2              DELIMS$ = UNSTRING$ -> UNSTRING_STMT.DELIM_LIST$ -> LX_LIST.HEAD$;
     1458    17957    2            DELIMITED = DELIMS$ ~= ADDR(NIL) ;
     1459    17958
     1460    17959    3            IF DELIMITED  AND  NOT ID1_ST$ -> SCALAR.B.KANJI  THEN DO ;
     1461    17960
     1462    17961    4              IF ALL_ID2S_ARE_CONSTANT THEN DO ;
     1463    17962
     1464    17963                     /* Create table at compile time */
     1465    17964
     1466    17965    4                ITERATION = 129 ;
     1467    17966                     %RESERVE_LTS (ITEM = %LCNST, POINTER = LTS$$) ;
     1468    18052
     1469    18053    5                DO WHILE (DELIMS$ ~= ADDR (NIL)) ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:172  
     1470    18054
     1471    18055    5                  CALL PREPARE_ID2 (DELIMS$, ID2$) ;
     1472    18056
     1473    18057    5                  CALL GET_CHAR (ID2$, ID2_CHAR) ;             /*#30498*/
     1474    18058
     1475    18059    6                  IF ID2_CHAR = BITASC ('000'O) THEN DO ;      /*#30498*/
     1476    18060    6                    SUBSTR (LTS$$ ->LCNST.CONST, 0, 1) = BITASC ('001'O) ;
     1477    18061    6                    LOW_VALUE_DELIM = TRUE ;                   /*#30498*/
     1478    18062    6                    ALL_LENGTH_1 = FALSE ;
     1479    18063    6                  END ; /* ID-2 is LOW-VALUE */                /*#30498*/
     1480    18064    5                  ELSE
     1481    18065    5                    SUBSTR (LTS$$ -> LCNST.CONST, ASCBIN (ID2_CHAR), 1)
     1482    18066    5                      = ID2_CHAR ;
     1483    18067
     1484    18068    5                  DELIMS$ = DELIMS$ -> LX_ITEM.LINK ;
     1485    18069
     1486    18070    5                END ; /* WHILE */
     1487    18071
     1488    18072                     %NEW_CONST (@ST$          = ST$$,
     1489    18073                                 @TYPE         = %TYA,
     1490    18074                                 @LONG_CONSTANT= '1'B) ;
     1491    18115    4                ST$$ -> CONST.CONST$.PTR$ = LTS$$ ;
     1492    18116    4                ST$$ -> SCALAR.DESCL = 512 ;
     1493    18117    4                CALL Z8AF$FORME (%TRIAD, ST$$, ADDR(NIL),
     1494    18118    4                                 TABLE$ -> LX_ETT_ITEM.ETT$) ;
     1495    18119
     1496    18120    4              END ; /* All id2's are constants */
     1497    18121
     1498    18122    4              ELSE DO ; /* All id2's are not constants */
     1499    18123
     1500    18124                     /* TABLE = '000'O */
     1501    18125
     1502    18126                     %NEW_ILL (@ID = %MFILL,
     1503    18127                               @LOP = TABLE$ -> LX_ETT_ITEM.ETT$,
     1504    18128                               @FILL = "BITASC('000'O)") ;
     1505    18507
     1506    18508    5                DO WHILE (DELIMS$ ~= ADDR (NIL)) ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:173  
     1507    18509
     1508    18510    5                  CALL PREPARE_ID2 (DELIMS$, ID2$) ;
     1509    18511                                                                    /*#30498*/
     1510    18512    6                  IF ID2$ -> LX_ETT_ITEM.ETT$ -> ETT.ID = %TRIAD THEN DO;
     1511    18513
     1512    18514    6                    CALL GET_CHAR (ID2$, ID2_CHAR) ;
     1513    18515
     1514    18516    7                    IF ID2_CHAR = BITASC ('000'O) THEN DO ;
     1515    18517
     1516    18518                           /* TCT instruction doesn't work for LOW-VALUES */
     1517    18519                           /* Change ID2 to a non-zero character */
     1518    18520
     1519    18521    7                      ID2$ = ADDR(LOW) ;
     1520    18522    7                      CALL Z8AC$LX_ETT_ITEM_TYI_CONST
     1521    18523    7                           (BITBIN ('001000000000'O), ID2$) ;
     1522    18524
     1523    18525    7                    END ; /* ID2 first character is LOW-VALUE */
     1524    18526
     1525    18527    6                  END ; /* ID2 is a constant */
     1526    18528
     1527    18529                       /*N* Test first character ID2 at runtime for LOW-VALUE */
     1528    18530
     1529    18531                       /* IF BY IS CONSTANT & LENGTH = 1 */
     1530    18532
     1531    18533    5                  CALL Z8AU$TYPE_DESCRIPTOR (ID2$->LX_ETT_ITEM.ETT$, TYPE_DESC) ;
     1532    18534
     1533    18535    5                  IF  ID2$ -> LX_ETT_ITEM.ETT$ ->ETT.ID = %TRIAD
     1534    18536    6                  AND TYPE_DESC.DESC.ADSC.N = 1 THEN DO ;
     1535    18537
     1536    18538                         /* SUBSTR (TABLE, ASCBIN(ID2), 1) = ID2 */
     1537    18539
     1538    18540    6                    CALL Z8EA$ASCBIN (ID2$, ASCBIN$) ;
     1539    18541    6                    CALL Z8EA$SUBSTR_ZERO (TABLE$, ASCBIN$, ONE$, SUBSTR$) ;
     1540    18542    6                    CALL Z8E7$MOVE (SUBSTR$, ID2$) ;
     1541    18543
     1542    18544    6                  END ;
     1543    18545
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:174  
     1544    18546    6                  ELSE DO ; /* ID2 NOT CONSTANT OR NOT LENGTH 1 */
     1545    18547
     1546    18548                         /* SUBSTR (TABLE, ASCBIN (SUB_ID2), 1) = ID2 */
     1547    18549                         /* WHERE SUB_ID2 IS: SUBSTR (ID2, 1, 1) [COBOL SUBSTR]    */
     1548    18550
     1549    18551    6                    CALL Z8EY$SUBSTR (ID2$, ONE$, ONE$, SUBSTR$) ;
     1550    18552    6                    CALL Z8EA$ASCBIN (SUBSTR$, ASCBIN$) ;
     1551    18553    6                    CALL Z8EA$SUBSTR_ZERO (TABLE$, ASCBIN$, ONE$, SUBSTR$) ;
     1552    18554
     1553    18555    6                    IF ID2$ -> LX_ETT_ITEM.TYPE = %TYN     THEN
     1554    18556    6                      SUBSTR$ -> LX_ETT_ITEM.TYPE = %TYN;
     1555    18557
     1556    18558    6                    CALL Z8E7$MOVE (SUBSTR$, ID2$) ;
     1557    18559
     1558    18560    6                  END ; /* ID2 IS NOT CONSTANT OR LENGTH NOT ONE */
     1559    18561
     1560    18562    5                  DELIMS$ = DELIMS$ -> LX_ITEM.LINK ;
     1561    18563
     1562    18564    5                END ; /* WHILE */
     1563    18565
     1564    18566    4              END ; /* All ID2's are not constants */
     1565    18567
     1566    18568    3            END ; /* DELIMITED */
     1567    18569
     1568    18570          %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:175  
     1569    18571                 /*V* UNSTRING_PASS_3_INTO_CLAUSES */
     1570    18572
     1571    18573    2            INTO_LIST$ = UNSTRING$ -> UNSTRING_STMT.INTO_LIST$ -> LX_LIST.HEAD$ ;
     1572    18574    2            INTO_NO = 0 ;
     1573    18575
     1574    18576    3            DO WHILE (INTO_LIST$ ~= ADDR(NIL)) ;
     1575    18577
     1576    18578    3              INTO_NO = INTO_NO + 1 ;
     1577    18579    3              INTO$ = INTO_LIST$ -> LX_LIST.HEAD$ ;
     1578    18580    3              DELIMITER$ = INTO_LIST$ ->LX_LIST.HEAD$ -> LX_ITEM.LINK ;
     1579    18581    3              COUNT$ = INTO_LIST$ -> LX_LIST.TAIL$ ;
     1580    18582
     1581    18583    3              CALL PREPARE_ID4 (INTO$, ID4$) ;
     1582    18584    3              CALL PREPARE_ID5 (DELIMITER$, ID5$) ;
     1583    18585    3              CALL PREPARE_ID6 (COUNT$, ID6$) ;
     1584    18586
     1585    18587    4              IF INTO_NO > 1 THEN DO ;
     1586    18588
     1587    18589                     /* IF ID7 > LENGTH (ID1) THEN GOTO END_UNSTRING */
     1588    18590
     1589    18591                     %INIT_BINARY_OP (@POINTER = COMPARISON$,
     1590    18592                                      @LOP$    = ID7$,
     1591    18593                                      @OP      = %OP_GREATER_THAN,
     1592    18594                                      @ROP$    = LENGTH_ID1$,
     1593    18595                                      @LINE    = "ID7$ -> LX_ETT_ITEM.LINE",
     1594    18596                                      @COLUMN  = "ID7$ -> LX_ETT_ITEM.COLUMN") ;
     1595    18614
     1596    18615    4                CALL Z8EK$BRANCH_TRUE (NOT_OVERFLOW_LABEL$, COMPARISON$) ;
     1597    18616
     1598    18617    4              END ; /* INTO_NO > 1 */
     1599    18618
     1600    18619    4              IF DELIMITED THEN DO ;
     1601    18620
     1602    18621                     /* ID6 = 0 */
     1603    18622
     1604    18623    4                CALL Z8E7$MOVE (ID6$, ZERO$) ;
     1605    18624
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:176  
     1606    18625                     /* INTO_LABEL: CALL SEARCH (POSITION,
     1607    18626                                                 TABLEVAL,
     1608    18627                                                 TABLE,
     1609    18628                                                 SUBSTR (ID1, ID6+ID7))
     1610    18629                                                 ALTRET (END_INTO)
     1611    18630                     */
     1612    18631
     1613    18632    4                CALL Z8AT$CREATE_TEMPORARY (%PARA, INTO_LABEL$) ;
     1614    18633    4                CALL Z8AT$CREATE_TEMPORARY (%PARA, END_INTO$) ;
     1615    18634
     1616    18635    4                IF DELIMITER AND NOT ID1_ST$ -> SCALAR.B.KANJI  THEN
     1617    18636    5                  DO;
     1618    18637    5                    TABLEVAL$ = ADDR(TABLEVAL);
     1619    18638                         %INIT_LX_ETT_ITEM (@POINTER = TABLEVAL$, @TYPE = %TYA);
     1620    18660    5                    CALL Z8AT$CREATE_TEMP_WITH_BASE (%SCALAR, TABLEVAL$->
     1621    18661    5                                                       LX_ETT_ITEM.ETT$ );
     1622    18662    5                    TABLEVAL$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP ->
     1623    18663    5                                 CONST.ADSC.N = 1 ;
     1624    18664    5                  END;  /* if Delimiter */
     1625    18665    4                ELSE
     1626    18666    5                  DO;
     1627    18667    5                    TABLEVAL$ = ADDR(NIL);
     1628    18668    5                  END;
     1629    18669
     1630    18670                     %NEW_ILL (@ID = %DEFLB, @LOP = INTO_LABEL$) ;
     1631    19049
     1632    19050                     /* ID6 + ID7 */
     1633    19051
     1634    19052                     %INIT_BINARY_OP (@POINTER = ID6_PLUS_ID7$,
     1635    19053                                      @LOP$    = ID6$,
     1636    19054                                      @OP      = %OP_PLUS,
     1637    19055                                      @ROP$    = ID7$,
     1638    19056                                      @LINE    = "ID6$ -> LX_ETT_ITEM.LINE",
     1639    19057                                      @COLUMN  = "ID6$ -> LX_ETT_ITEM.COLUMN") ;
     1640    19075
     1641    19076                     %INIT_LX_ETT_ITEM (@POINTER = POSITION$, @TYPE = %TYI) ;
     1642    19098    4                CALL Z8AT$CREATE_TEMP_WITH_BASE (%SCALAR, POSITION$ -> LX_ETT_ITEM.ETT$
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:177  
             19098                         ) ;
     1643    19099    4                DELIMS$ = UNSTRING$ -> UNSTRING_STMT.DELIM_LIST$ -> LX_LIST.HEAD$ ;
     1644    19100
     1645    19101    4                IF NOT ID1_ST$ -> SCALAR.B.KANJI   THEN
     1646    19102    5                  DO;
     1647    19103
     1648    19104    5                    CALL Z8EY$SUBSTR (ID1$, ID6_PLUS_ID7$, ADDR(NIL), SUBSTR$) ;
     1649    19105
     1650    19106    5                    CALL Z8EZ$SEARCH (POSITION$, TABLEVAL$, TABLE$, SUBSTR$, END_INTO$)
             19106                             ;
     1651    19107    5                  END;
     1652    19108    4                ELSE
     1653    19109    5                  DO;
     1654    19110    5                    CALL KANJI_INDEX( POSITION$,
     1655    19111    5                                      DELIMS$ );
     1656    19112           /*            %INIT_BINARY_OP( @POINTER = COMPARISON$,
     1657    19113                                          @OP = %OP_GREATER_THAN_OR_EQUAL,
     1658    19114                                          @LOP$ = LENGTH_ID1$,
     1659    19115                                          @ROP$ = POSITION$ );
     1660    19116                         CALL Z8EK$BRANCH_TRUE( END_INTO$,
     1661    19117                                                COMPARISON$ );  */
     1662    19118    5                  END;
     1663    19119
     1664    19120                     /* ID6 = ID6 + POSITION */
     1665    19121
     1666    19122    4                CALL ADD_A_AND_B_GIVING_C (ID6$, POSITION$, ID6$) ;
     1667    19123
     1668    19124    5                IF ALL_LENGTH_1 THEN DO ;
     1669    19125                       /* ID4 = SUBSTR (ID1, ID7, ID6) */
     1670    19126
     1671    19127    5                  CALL Z8EY$SUBSTR (ID1$, ID7$, ID6$, SUBSTR$) ;
     1672    19128    5                  CALL Z8E7$MOVE (ID4$, SUBSTR$) ;
     1673    19129
     1674    19130    6                  IF TALLYING THEN DO ;
     1675    19131
     1676    19132                         /* ID8 = ID8 + 1 */
     1677    19133
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:178  
     1678    19134    6                    CALL ADD_A_AND_B_GIVING_C (ID8$, ONE$, ID8$) ;
     1679    19135
     1680    19136    6                  END ; /* TALLYING */
     1681    19137
     1682    19138    6                  IF DELIMITER THEN DO ;
     1683    19139
     1684    19140                         /* ID5 = TABLEVAL */
     1685    19141
     1686    19142    6                    CALL Z8E7$MOVE (ID5$, TABLEVAL$) ;
     1687    19143
     1688    19144    6                  END ; /* DELIMITER */
     1689    19145
     1690    19146    5                  IF POINTER OR INTO_NO ~= INTO_MAX
     1691    19147    6                  OR OVERFLOW THEN DO ;
     1692    19148
     1693    19149                         /* ID7 = ID7 + ID6 + 1 */
     1694    19150
     1695    19151    6                    CALL ADD_A_AND_B_GIVING_C ( ID6_PLUS_ID7$, ONE$, ID7$) ;
     1696    19152
     1697    19153    6                  END ; /* OVERFLOW, POINTER, or not last INTO guy */
     1698    19154
     1699    19155                       /* GOTO EXIT_INTO_LOOP */
     1700    19156
     1701    19157    6                  IF EXIT_INTO_LOOP$ = ADDR(NIL) THEN DO ;
     1702    19158
     1703    19159    6                    CALL Z8AT$CREATE_TEMPORARY (%PARA, EXIT_INTO_LOOP$) ;
     1704    19160
     1705    19161    6                  END ;
     1706    19162
     1707    19163    5                  CALL Z8EK$BRANCH (EXIT_INTO_LOOP$) ;
     1708    19164
     1709    19165    5                END ; /* All id2's length = 1 & no ALL's */
     1710    19166
     1711    19167    5                ELSE DO ; /* ALL "BY" LENGTHS ARE NOT ONE BYTE */
     1712    19168
     1713    19169    5                  DELIMS$ = UNSTRING$ -> UNSTRING_STMT.DELIM_LIST$ -> LX_LIST.HEAD$ ;
     1714    19170
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:179  
     1715    19171    6                  DO WHILE (DELIMS$ ~= ADDR(NIL)) ;
     1716    19172
     1717    19173    6                    CALL PREPARE_ID2 (DELIMS$, ID2$) ;
     1718    19174
     1719    19175                         /* IF SUBSTR (ID1, ID6+ID7, LENGTH(ID2)) = ID2
     1720    19176                            THEN DO / * NOTE: ONE-BASED SUBSTR */
     1721    19177
     1722    19178    6                    IF NOT ID1_ST$ -> SCALAR.B.KANJI   THEN
     1723    19179    7                      DO;
     1724    19180    7                        CALL Z8EY$SUBSTR (ID1$, ID6_PLUS_ID7$, LENGTH_ID2$, SUBSTR$) ;
     1725    19181
     1726    19182                             %IF_THEN_DO (@LOP = SUBSTR$,
     1727    19183                                          @REL = %OP_EQUAL,
     1728    19184                                          @ROP = ID2$,
     1729    19185                                          @LAB = END_IF$) ;
     1730    19219    7                      END;
     1731    19220
     1732    19221                         /* ID4 = SUBSTR (ID1, ID7, ID6) [ONE-BASED SUBSTR] */
     1733    19222
     1734    19223    6                    CALL Z8EY$SUBSTR (ID1$, ID7$, ID6$, SUBSTR$) ;
     1735    19224    6                    CALL Z8E7$MOVE (ID4$, SUBSTR$) ;
     1736    19225
     1737    19226    7                    IF TALLYING THEN DO ; /* ID8 EXISTS */
     1738    19227
     1739    19228                           /* ADD 1 TO ID8 */
     1740    19229
     1741    19230    7                      CALL ADD_A_AND_B_GIVING_C (ID8$, ONE$, ID8$) ;
     1742    19231
     1743    19232    7                    END ; /* TALLYING */
     1744    19233
     1745    19234    7                    IF DELIMITER THEN DO ; /* ID5 EXISTS */
     1746    19235
     1747    19236                           /* ID5 = ID2 */
     1748    19237
     1749    19238          /*               B.ALL TURNED OFF BY PREPARE_ID2
     1750    19239                           CALL Z8E7$MOVE (ID5$, ID2$) ;
     1751    19240          */
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:180  
     1752    19241    7                      IF ID5$ -> LX_ETT_ITEM.TYPE = %TYE OR ID5$ -> LX_ETT_ITEM.TYPE =
             19241                               %TYB THEN
     1753    19242    8                        DO ;
     1754    19243    8                          IF ID5$ -> LX_ETT_ITEM.TYPE = %TYE
     1755    19244    8                            THEN CALL Z8CO$CREATE_LIBRARY_BASE (%OP_ASCII_TO_EBCDIC,
             19244                                     TABLE_ETT$) ;
     1756    19245    8                            ELSE CALL Z8CO$CREATE_LIBRARY_BASE (%OP_ASCII_TO_GBCD,
             19245                                     TABLE_ETT$) ;
     1757    19246                               %NEW_ILL (@ID    = %MVT,
     1758    19247                                         @FROM  = ID2$ -> LX_ETT_ITEM.ETT$,
     1759    19248                                         @TABLE = TABLE_ETT$,
     1760    19249                                         @TO    = ID5$ -> LX_ETT_ITEM.ETT$) ;
     1761    19628    8                        END ;
     1762    19629    7                      ELSE
     1763    19630                             %NEW_ILL (@ID  = %MVAN,
     1764    19631                                       @LOP = ID5$ -> LX_ETT_ITEM.ETT$,
     1765    19632                                       @ROP = ID2$ -> LX_ETT_ITEM.ETT$) ;
     1766    20011
     1767    20012    7                    END ; /* DELIMITER */
     1768    20013
     1769    20014                         /* ID7 = ID7 + ID6 + LENGTH (ID2) */
     1770    20015
     1771    20016    6                    CALL ADD_A_AND_B_GIVING_C (ID6_PLUS_ID7$, LENGTH_ID2$, ID7$) ;
     1772    20017
     1773    20018    7                    IF ALL THEN DO ;
     1774    20019
     1775    20020    7                      CALL CREATE_ALL_DO_WHILE ;
     1776    20021
     1777    20022    7                    END ; /* ALL */
     1778    20023
     1779    20024                         /* GOTO EXIT_INTO_LOOP */
     1780    20025
     1781    20026    7                    IF EXIT_INTO_LOOP$ = ADDR(NIL) THEN DO ;
     1782    20027
     1783    20028    7                      CALL Z8AT$CREATE_TEMPORARY (%PARA, EXIT_INTO_LOOP$) ;
     1784    20029
     1785    20030    7                    END ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:181  
     1786    20031
     1787    20032    6                    CALL Z8EK$BRANCH (EXIT_INTO_LOOP$) ;
     1788    20033
     1789    20034    6                    IF END_IF$ ~= ADDR(NIL)  THEN
     1790    20035    7                      DO;
     1791    20036                             %NEW_ILL (@ID = %DEFLB, @LOP = END_IF$) ;
     1792    20415    7                      END;
     1793    20416
     1794    20417    6                    DELIMS$ = DELIMS$ -> LX_ITEM.LINK ;
     1795    20418    6                    IF ID1_ST$ -> SCALAR.B.KANJI  THEN
     1796    20419    6                      DELIMS$ = ADDR(NIL);
     1797    20420
     1798    20421    6                  END ; /* WHILE DELIMS$ <> NIL */
     1799    20422
     1800    20423    5                  IF NOT ID1_ST$ -> SCALAR.B.KANJI  THEN
     1801    20424    6                    DO;
     1802    20425                                 /*  Kanji always compares the whole string
     1803    20426                                     so this will never be hit.            */
     1804    20427                           /* ID6 = ID6 + 1 */
     1805    20428
     1806    20429    6                      CALL ADD_A_AND_B_GIVING_C (ID6$, ONE$, ID6$) ;
     1807    20430
     1808    20431                           /* GOTO INTO_LABEL */
     1809    20432
     1810    20433    6                      CALL Z8EK$BRANCH (INTO_LABEL$) ;
     1811    20434
     1812    20435    6                    END;
     1813    20436
     1814    20437    5                END ; /* ALL "BY" LENGTHS ARE NOT ONE BYTE */
     1815    20438
     1816    20439                     /* END_INTO: */
     1817    20440
     1818    20441                     %NEW_ILL( @ID = %DEFLB, @LOP = END_INTO$) ;
     1819    20820
     1820    20821    5                IF DELIMITER THEN DO ;
     1821    20822
     1822    20823                       /* ID5 = ' ' */
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:182  
     1823    20824
     1824    20825
     1825    20826    5                  CALL Z8E7$MOVE (ID5$, SPACE_LX$) ;
     1826    20827
     1827    20828    5                END ; /* DELIMITER */
     1828    20829                     /*  If kanji, calculate the number of bytes to move  */
     1829    20830
     1830    20831    4                IF ID1_ST$ -> SCALAR.B.KANJI     THEN
     1831    20832    5                  DO;
     1832    20833                         %NEW_ILL( @ID  = %AD2I,
     1833    20834                                   @LOP = POSITION$ -> LX_ETT_ITEM.ETT$,
     1834    20835                                   @ROP = ONE$ -> LX_ETT_ITEM.ETT$);
     1835    21214                         %NEW_ILL( @ID  = %SB2I,
     1836    21215                                   @LOP = POSITION$ -> LX_ETT_ITEM.ETT$,
     1837    21216                                   @ROP = ID7$ -> LX_ETT_ITEM.ETT$ );
     1838    21595    5                  END;
     1839    21596
     1840    21597                     /* ID6 = ID6 + POSITION */
     1841    21598
     1842    21599    4                CALL ADD_A_AND_B_GIVING_C (ID6$, POSITION$, ID6$) ;
     1843    21600
     1844    21601                     /* ID4 = SUBSTR (ID1, ID7, ID6) */
     1845    21602
     1846    21603    4                CALL Z8EY$SUBSTR (ID1$, ID7$, ID6$, SUBSTR$) ;
     1847    21604    4                CALL Z8E7$MOVE (ID4$, SUBSTR$) ;
     1848    21605
     1849    21606    5                IF TALLYING THEN DO ;
     1850    21607
     1851    21608                       /* ID8 = ID8 + 1 */
     1852    21609
     1853    21610    5                  CALL ADD_A_AND_B_GIVING_C (ID8$, ONE$, ID8$) ;
     1854    21611
     1855    21612    5                END ; /* TALLYING */
     1856    21613
     1857    21614                     /* ID7 = ID7 + ID6 */
     1858    21615
     1859    21616    4                CALL Z8E5$MATH_PACK (ID6_PLUS_ID7$, ADD$) ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:183  
     1860    21617    4                CALL Z8E7$MOVE (ID7$, ADD$) ;
     1861    21618
     1862    21619                     /* GOTO NOT_OVERFLOW */
     1863    21620
     1864    21621    4                CALL Z8EK$BRANCH( NOT_OVERFLOW_LABEL$ );
     1865    21622
     1866    21623    4              END ; /* DELIMITED */
     1867    21624
     1868    21625    4              ELSE DO ; /* NO DELIMITED CLAUSE */
     1869    21626
     1870    21627                     /* ID4 = SUBSTR (ID1, ID7, MIN (LENGTH(ID4), LENGTH(ID1) + 1 - ID7) */
     1871    21628
     1872    21629                     %INIT_BINARY_OP (@POINTER = ADD$,
     1873    21630                                      @LOP$    = LENGTH_ID1$,
     1874    21631                                      @OP      = %OP_PLUS,
     1875    21632                                      @ROP$    = ONE$,
     1876    21633                                      @LINE    = "ID1$ -> LX_ETT_ITEM.LINE",
     1877    21634                                      @COLUMN  = "ID1$ -> LX_ETT_ITEM.COLUMN") ;
     1878    21652
     1879    21653                     %INIT_BINARY_OP (@POINTER = SUB$,
     1880    21654                                      @LOP$    = ADD$,
     1881    21655                                      @OP      = %OP_BINARY_MINUS,
     1882    21656                                      @ROP$    = ID7$,
     1883    21657                                      @LINE    = "ID1$ -> LX_ETT_ITEM.LINE",
     1884    21658                                      @COLUMN  = "ID1$ -> LX_ETT_ITEM.COLUMN") ;
     1885    21676
     1886    21677                     %INIT_BINARY_OP (@POINTER = MIN$,
     1887    21678                                      @LOP$    = LENGTH_ID4$,
     1888    21679                                      @OP      = %OP_MINIMUM,
     1889    21680                                      @ROP$    = SUB$,
     1890    21681                                      @LINE    = "ID4$ -> LX_ETT_ITEM.LINE",
     1891    21682                                      @COLUMN  = "ID4$ -> LX_ETT_ITEM.COLUMN") ;
     1892    21700
     1893    21701    4                CALL Z8EY$SUBSTR (ID1$, ID7$, MIN$, SUBSTR$) ;
     1894    21702    4                CALL Z8E7$MOVE (ID4$, SUBSTR$) ;
     1895    21703
     1896    21704                     /* ID7 = ID7 + MIN (LENGTH(ID4), LENGTH(ID1) - ID7) */
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:184  
     1897    21705
     1898    21706    4                CALL ADD_A_AND_B_GIVING_C (ID7$, MIN$, ID7$) ;
     1899    21707
     1900    21708    5                IF TALLYING THEN DO ;
     1901    21709                       /* ID8 = ID8 + 1 */
     1902    21710
     1903    21711    5                  CALL ADD_A_AND_B_GIVING_C (ID8$, ONE$, ID8$) ;
     1904    21712
     1905    21713    5                END ; /* TALLYING */
     1906    21714
     1907    21715    4              END ; /* NO DELIMITED CLAUSE */
     1908    21716
     1909    21717                   /* EXIT_INTO_LOOP: */
     1910    21718
     1911    21719    4              IF EXIT_INTO_LOOP$ ~= ADDR(NIL) THEN DO ;
     1912    21720
     1913    21721                     %NEW_ILL (@ID = %DEFLB, @LOP = EXIT_INTO_LOOP$) ;
     1914    22100    4                EXIT_INTO_LOOP$ = ADDR(NIL) ;
     1915    22101
     1916    22102    4              END ;
     1917    22103
     1918    22104    3              INTO_LIST$ = INTO_LIST$ -> LX_LIST.LINK ;
     1919    22105
     1920    22106    3            END ; /* WHILE INTO_LIST <> NIL */
     1921    22107
     1922    22108          %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:185  
     1923    22109                 /* UNSTRING WRAPUP */
     1924    22110
     1925    22111    3            IF OVERFLOW   THEN DO ;
     1926    22112
     1927    22113                   /* IF ID7 <= LENGTH(ID1) THEN DO */
     1928    22114
     1929    22115                   %INIT_BINARY_OP( @POINTER = "ADDR(COMPARISON)",
     1930    22116                                    @LOP$ = ID7$,
     1931    22117                                    @OP = %OP_GREATER_THAN,
     1932    22118                                    @ROP$ = LENGTH_ID1$,
     1933    22119                                    @LINE = ID7$ -> LX_ETT_ITEM.LINE,
     1934    22120                                    @COLUMN = ID7$ -> LX_ETT_ITEM.COLUMN );
     1935    22138
     1936    22139    3              CALL Z8EK$BRANCH_FALSE( OVERFLOW_LABEL$, ADDR(COMPARISON));
     1937    22140
     1938    22141    3            END ; /* OVERFLOW */
     1939    22142
     1940    22143                 %NEW_ILL( @ID = %DEFLB, @LOP = NOT_OVERFLOW_LABEL$ );
     1941    22522
     1942    22523    2            IF ID1_ST$ -> SCALAR.B.KANJI    THEN
     1943    22524    3              DO;
     1944    22525
     1945    22526                     %INIT_BINARY_OP( @POINTER = PLUS_ONE$,
     1946    22527                                      @OP  = %OP_PLUS,
     1947    22528                                      @LOP$ = ID7$,
     1948    22529                                      @ROP$ = ONE$ );
     1949    22547                     %INIT_BINARY_OP( @POINTER = ID7_DIVIDE_2$,
     1950    22548                                      @OP  = %OP_SLASH,
     1951    22549                                      @LOP$ = PLUS_ONE$,
     1952    22550                                      @ROP$ = TWO$ );
     1953    22568
     1954    22569    3                CALL Z8E5$MATH_PACK( ID7_DIVIDE_2$, ID7_DIVIDE_2$ );
     1955    22570    3                CALL Z8E7$MOVE( ID7$, ID7_DIVIDE_2$ );
     1956    22571
     1957    22572                     %INIT_BINARY_OP( @POINTER = ID6_DIVIDE_2$,
     1958    22573                                      @OP  = %OP_SLASH,
     1959    22574                                      @LOP$ = ID6$,
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:186  
     1960    22575                                      @ROP$ = TWO$ );
     1961    22593
     1962    22594    3                CALL Z8E5$MATH_PACK( ID6_DIVIDE_2$, ID6_DIVIDE_2$ );
     1963    22595    3                CALL Z8E7$MOVE( ID6$, ID6_DIVIDE_2$ );
     1964    22596
     1965    22597    3              END;
     1966    22598    2            IF NOT_ON_OVERFLOW$ ~= ADDR(NIL)    THEN
     1967    22599    3              DO;
     1968    22600                     %APPEND_ILS_LIST( @FROM$ = NOT_ON_OVERFLOW$,
     1969    22601                                       @TO$ = "ADDR(O1COM.ILS_LIST)" );
     1970    22618    3              END;
     1971    22619
     1972    22620    2            CALL Z8EK$BRANCH( END_UNSTRING$ );
     1973    22621
     1974    22622    2            IF OVERFLOW OR POINTER THEN
     1975    22623    3              DO;
     1976    22624                     %NEW_ILL (@ID = %DEFLB, @LOP = OVERFLOW_LABEL$) ;
     1977    23003
     1978    23004    3                IF ID1_ST$ -> SCALAR.B.KANJI   THEN
     1979    23005    4                  DO;
     1980    23006
     1981    23007                         %INIT_BINARY_OP( @POINTER = PLUS_ONE$,
     1982    23008                                          @OP  = %OP_PLUS,
     1983    23009                                          @LOP$ = ID7$,
     1984    23010                                          @ROP$ = ONE$ );
     1985    23028                         %INIT_BINARY_OP( @POINTER = ID7_DIVIDE_2$,
     1986    23029                                          @OP  = %OP_SLASH,
     1987    23030                                          @LOP$ = PLUS_ONE$,
     1988    23031                                          @ROP$ = TWO$ );
     1989    23049
     1990    23050    4                    CALL Z8E5$MATH_PACK( ID7_DIVIDE_2$, ID7_DIVIDE_2$ );
     1991    23051    4                    CALL Z8E7$MOVE( ID7$, ID7_DIVIDE_2$ );
     1992    23052
     1993    23053                         %INIT_BINARY_OP( @POINTER = ID6_DIVIDE_2$,
     1994    23054                                          @OP  = %OP_SLASH,
     1995    23055                                          @LOP$ = ID6$,
     1996    23056                                          @ROP$ = TWO$ );
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:187  
     1997    23074
     1998    23075    4                    CALL Z8E5$MATH_PACK( ID6_DIVIDE_2$, ID6_DIVIDE_2$ );
     1999    23076    4                    CALL Z8E7$MOVE( ID6$, ID6_DIVIDE_2$ );
     2000    23077
     2001    23078    4                  END;
     2002    23079    3              END;
     2003    23080
     2004    23081    3            IF ON_OVERFLOW$ ~= ADDR(NIL)   THEN DO ;
     2005    23082
     2006    23083                   %APPEND_ILS_LIST (@TO$   = "ADDR(O1COM.ILS_LIST)",
     2007    23084                                     @FROM$ = ON_OVERFLOW$) ;
     2008    23101
     2009    23102    3            END ; /* OVERFLOW */
     2010    23103
     2011    23104                 %NEW_ILL (@ID = %DEFLB, @LOP = END_UNSTRING$) ;
     2012    23483
     2013    23484    2          END ; /* Not optimizable */
     2014    23485
     2015    23486    1          RETURN ;
     2016    23487
     2017    23488    1   BAD_UNSTRING: ;
     2018    23489
     2019    23490    1          RETURN ;
     2020    23491
     2021    23492        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:188  
     2022    23493    1   CREATE_ALL_DO_WHILE: PROC ;
     2023    23494
     2024    23495        /*I*   NAME: CREATE_ALL_DO_WHILE
     2025    23496
     2026    23497        DESCRIPTION: Create the ILL for the following DO WHILE:
     2027    23498
     2028    23499                  DO WHILE (ID7 + LENGTH(ID2) <= LENGTH(ID1) + 1
     2029    23500                       AND  SUBSTR (ID1, ID7, LENGTH(ID2)) = ID2) ;
     2030    23501                    ADD Length(id2) TO id7
     2031    23502                  END
     2032    23503
     2033    23504                  SIX STEPS TO CREATING A DO WHILE:
     2034    23505                  (1) SAVE O1COM.ILS_LIST
     2035    23506                  (2) SET O1COM.ILS_LIST TO NIL
     2036    23507                  (3) CREATE LOOP BODY
     2037    23508                  (4) SAVE O1COM.ILS_LIST (THE BODY)
     2038    23509                  (5) RESTORE O1COM.ILS_LIST
     2039    23510                  (6) CALL Z8EQ$CREATE_DO_WHILE (CONDITION, BODY)
     2040    23511               */
     2041    23512
     2042    23513    2          DCL  LENGTH_ID1_PLUS_1$  PTR ;
     2043    23514               %DCL_AUTO_LX_ITEM (@NAME = LENGTH_ID1_PLUS_1) ;
     2044    23518
     2045    23519    2          LENGTH_ID1_PLUS_1$ = ADDR (LENGTH_ID1_PLUS_1) ;
     2046    23520
     2047    23521
     2048    23522    2          SAVED_ILS_LIST = O1COM.ILS_LIST ;
     2049    23523               %INIT_ILS_LIST (@POINTER = "ADDR(O1COM.ILS_LIST)") ;
     2050    23531
     2051    23532               /*V* DO_BODY: ADD Length(id2) TO id7 */
     2052    23533
     2053    23534    2          CALL ADD_A_AND_B_GIVING_C ( ID7$, LENGTH_ID2$, ID7$) ;
     2054    23535
     2055    23536               /*V* WRAPUP DO WHILE */
     2056    23537
     2057    23538    2          DO_BODY_ILS_LIST = O1COM.ILS_LIST ;
     2058    23539    2          O1COM.ILS_LIST = SAVED_ILS_LIST ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:189  
     2059    23540
     2060    23541               %INIT_BINARY_OP (@POINTER = LENGTH_ID1_PLUS_1$,
     2061    23542                                @LOP$    = LENGTH_ID1$,
     2062    23543                                @OP      = %OP_PLUS,
     2063    23544                                @ROP$    = ONE$,
     2064    23545                                @LINE    = "ID1$ -> LX_ETT_ITEM.LINE",
     2065    23546                                @COLUMN  = "ID1$ -> LX_ETT_ITEM.COLUMN") ;
     2066    23564
     2067    23565               %INIT_BINARY_OP (@POINTER = ADD$,
     2068    23566                                @LOP$    = ID7$,
     2069    23567                                @OP      = %OP_PLUS,
     2070    23568                                @ROP$    = LENGTH_ID2$,
     2071    23569                                @LINE    = "ID2$ -> LX_ETT_ITEM.LINE",
     2072    23570                                @COLUMN  = "ID2$ -> LX_ETT_ITEM.COLUMN") ;
     2073    23588
     2074    23589               %INIT_BINARY_OP (@POINTER = COMPARISON$,
     2075    23590                                @LOP$    = ADD$,
     2076    23591                                @OP      = %OP_LESS_THAN_OR_EQUAL,
     2077    23592                                @ROP$    = LENGTH_ID1_PLUS_1$,
     2078    23593                                @LINE    = "ID1$ -> LX_ETT_ITEM.LINE",
     2079    23594                                @COLUMN  = "ID1$ -> LX_ETT_ITEM.COLUMN") ;
     2080    23612
     2081    23613    2          CALL Z8EY$SUBSTR (ID1$, ID7$, LENGTH_ID2$, SUBSTR$) ;
     2082    23614
     2083    23615               %INIT_BINARY_OP (@POINTER = COMPARISON2$,
     2084    23616                                @LOP$    = SUBSTR$,
     2085    23617                                @OP      = %OP_EQUAL,
     2086    23618                                @ROP$    = ID2$,
     2087    23619                                @LINE    = "ID2$ -> LX_ETT_ITEM.LINE",
     2088    23620                                @COLUMN  = "ID2$ -> LX_ETT_ITEM.COLUMN") ;
     2089    23638
     2090    23639               %INIT_BINARY_OP (@POINTER = AND$,
     2091    23640                                @LOP$    = COMPARISON$,
     2092    23641                                @OP      = %OP_AND,
     2093    23642                                @ROP$    = COMPARISON2$,
     2094    23643                                @LINE    = "ID2$ -> LX_ETT_ITEM.LINE",
     2095    23644                                @COLUMN  = "ID2$ -> LX_ETT_ITEM.COLUMN") ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:190  
     2096    23662
     2097    23663    2          CALL Z8EQ$CREATE_DO_WHILE (AND$, ADDR(DO_BODY_ILS_LIST)) ;
     2098    23664
     2099    23665    2   END CREATE_ALL_DO_WHILE ;
     2100    23666
     2101    23667        %EJECT;                                                     /*#30498*/
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:191  
     2102    23668        /*I*   NAME: GET_CHAR
     2103    23669        DESCRIPTION: Given a ptr to an LX_ETT_ITEM, get the first character
     2104    23670                     of the constant represented by the LX_ETT_ITEM.
     2105    23671        */
     2106    23672
     2107    23673    1   GET_CHAR: PROC (ID$, ID_CHAR) ;
     2108    23674
     2109    23675    2   DCL    ID$             PTR ;      /* INPUT:  ptr to an LX_ETT_ITEM */
     2110    23676    2   DCL    ID_CHAR$        PTR ;      /* SCRATCH: ptr to the char string */
     2111    23677    2   DCL    ID_CHAR         CHAR (1) ; /* OUTPUT: the character */
     2112    23678
     2113    23679    2          ID_CHAR$ = ID$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP ;
     2114    23680               %GET_CONSTANT_ADDRESS (@CONSTANT = ID_CHAR$,
     2115    23681                                      @STRING   = ID_CHAR$) ;
     2116    23689    2          ID_CHAR = SUBSTR (ID_CHAR$ -> CHARS, 0, 1) ;
     2117    23690
     2118    23691    2   END GET_CHAR ;
     2119    23692        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:192  
     2120    23693
     2121    23694        /*I*   NAME: MOVE
     2122    23695
     2123    23696        DESCRIPTION: Move Substring (id1$, offset) to id4$
     2124    23697
     2125    23698        */
     2126    23699
     2127    23700    1   MOVE: PROC (ID1$, ID4$, LENGTH, OFFSET) ;
     2128    23701
     2129    23702    2        DCL  ID4$               PTR ;
     2130    23703    2        DCL  ID1$               PTR ;
     2131    23704    2        DCL  OFFSET             SBIN WORD ;
     2132    23705    2        DCL  LENGTH             SBIN WORD ;
     2133    23706    2        DCL  RESULT$            PTR ;
     2134    23707    2        DCL  ORIGINAL_ID1_ETT$  PTR ;
     2135    23708
     2136    23709    2        ORIGINAL_ID1_ETT$ = ID1$ -> LX_ETT_ITEM.ETT$ ;
     2137    23710
     2138    23711    3        IF OFFSET ~= 0 THEN DO ;
     2139    23712
     2140    23713    3          CALL Z8AF$NEW_OFF (ID1$ -> LX_ETT_ITEM.ETT$,
     2141    23714    3                             OFFSET,
     2142    23715    3                             RESULT$) ;
     2143    23716    3          ID1$ -> LX_ETT_ITEM.ETT$ = RESULT$ ;
     2144    23717
     2145    23718    3        END ; /* Offset <> 0 */
     2146    23719
     2147    23720    3        IF ID1_LENGTH - OFFSET < LENGTH THEN DO ;
     2148    23721
     2149    23722    3          CALL Z8AF$NEW_FISS (ID1$ -> LX_ETT_ITEM.ETT$,
     2150    23723    3                              ID1_LENGTH - OFFSET,
     2151    23724    3                              %ALPHA_NUMERIC_FISS,
     2152    23725    3                              RESULT$) ;
     2153    23726    3          ID1$ -> LX_ETT_ITEM.ETT$ = RESULT$ ;
     2154    23727
     2155    23728    3        END ;
     2156    23729
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:193  
     2157    23730    2        CALL Z8E7$MOVE (ID4$, ID1$) ;
     2158    23731
     2159    23732    2        ID1$ -> LX_ETT_ITEM.ETT$ = ORIGINAL_ID1_ETT$ ;
     2160    23733    2        OFFSET = OFFSET + LENGTH ; /* ready for next call to MOVE */
     2161    23734
     2162    23735    2   END MOVE ;
     2163    23736
     2164    23737        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:194  
     2165    23738        /*I*   NAME: VALIDATE_IDn, n = 1 -> 8
     2166    23739
     2167    23740        DESCRIPTION: These routines are used by Pass 2 of Z8EZ$UNSTRING.
     2168    23741                     They validate the semantics of each identifier.
     2169    23742
     2170    23743        */
     2171    23744
     2172    23745        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:195  
     2173    23746    1   VALIDATE_ID1: PROC (ID1$) ;
     2174    23747
     2175    23748    2        DCL ID1$      PTR;
     2176    23749
     2177    23750    3          IF ID1$ -> LX_ITEM.B.ERROR THEN DO ;
     2178    23751    3            PRODUCE_UNSTRING_ILS = FALSE ;
     2179    23752    3            RETURN ;
     2180    23753    3          END ;
     2181    23754
     2182    23755    3          DO CASE (ID1$ -> LX_ETT_ITEM.TYPE) ;
     2183    23756    3            CASE (%TYA, %TYN, %TYE, %TYB) ;
     2184    23757    3              CALL Z8AU$TYPE_DESCRIPTOR (ID1$ -> LX_ETT_ITEM.ETT$,
     2185    23758    3                                         TYPE_DESC) ;
     2186    23759    3              IF TYPE_DESC.SIZ$ ~= ADDR(NIL)
     2187    23760    3              THEN OPTIMIZABLE = FALSE ;
     2188    23761    3              RETURN ;
     2189    23762    3            CASE (ELSE) ;
     2190    23763    3              CALL Z8AE$ERROR (%E$ALPHANUMERIC_TYPE_EXPECTED,
     2191    23764    3                               ID1$ -> LX_ETT_ITEM.LINE,
     2192    23765    3                               ID1$ -> LX_ETT_ITEM.COLUMN) ;
     2193    23766    3              PRODUCE_UNSTRING_ILS = FALSE ;
     2194    23767    3          END ;
     2195    23768
     2196    23769    2   END VALIDATE_ID1;
     2197    23770        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:196  
     2198    23771    1   VALIDATE_ID2: PROC (ID2$) ;
     2199    23772
     2200    23773    2        DCL ID2$      PTR;
     2201    23774
     2202    23775    3          IF ID2$ -> LX_ITEM.B.ERROR THEN DO ;
     2203    23776    3            PRODUCE_UNSTRING_ILS = FALSE ;
     2204    23777    3            RETURN ;
     2205    23778    3          END ;
     2206    23779
     2207    23780    2          IF ID2$ -> LX_ITEM.B.ALL
     2208    23781    2          THEN ALL_LENGTH_1 = FALSE ;
     2209    23782
     2210    23783    3          DO CASE (ID2$ -> LX_ITEM.ID) ;
     2211    23784
     2212    23785    3            CASE (%LX_TERMINAL) ;
     2213    23786
     2214    23787                       /*#31092*/
     2215    23788                       /* Will be taken care of by PREPARE_ID2  */
     2216    23789
     2217    23790    3            CASE (%LX_ETT_ITEM) ;
     2218    23791
     2219    23792    3              ALL_ID2S_ARE_CONSTANT = FALSE ;
     2220    23793
     2221    23794    4              DO CASE (ID2$ -> LX_ETT_ITEM.TYPE) ;
     2222    23795    4                CASE (%TYA, %TYN, %TYE, %TYB) ;
     2223    23796    4                  CALL Z8AU$TYPE_DESCRIPTOR (ID2$ -> LX_ETT_ITEM.ETT$,
     2224    23797    4                                             TYPE_DESC) ;
     2225    23798    4                  IF ID2$ -> LX_ETT_ITEM.ETT$ -> ETT.ID ~= %TRIAD
     2226    23799    4                  OR TYPE_DESC.DESC.ADSC.N ~= 1
     2227    23800    4                  THEN ALL_LENGTH_1 = FALSE ;
     2228    23801    4                  RETURN ;
     2229    23802    4                CASE (ELSE) ;
     2230    23803    4                  CALL Z8AE$ERROR (%E$ALPHANUMERIC_TYPE_EXPECTED,
     2231    23804    4                                   ID2$ -> LX_ETT_ITEM.LINE,
     2232    23805    4                                   ID2$ -> LX_ETT_ITEM.COLUMN) ;
     2233    23806    4                  PRODUCE_UNSTRING_ILS = FALSE ;
     2234    23807    4              END ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:197  
     2235    23808
     2236    23809    3            CASE (ELSE) ;
     2237    23810
     2238    23811    3              ALL_ID2S_ARE_CONSTANT = FALSE ;
     2239    23812    3              ALL_LENGTH_1 = FALSE ;
     2240    23813
     2241    23814    3          END ; /* Case */
     2242    23815
     2243    23816    2   END VALIDATE_ID2;
     2244    23817        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:198  
     2245    23818    1   VALIDATE_ID4: PROC (ID4$) ;
     2246    23819
     2247    23820    2        DCL ID4$      PTR;
     2248    23821
     2249    23822    3          IF ID4$ -> LX_ITEM.B.ERROR THEN DO ;
     2250    23823    3            PRODUCE_UNSTRING_ILS = FALSE ;
     2251    23824    3            RETURN ;
     2252    23825    3          END ;
     2253    23826
     2254    23827    2        IF ID4$ -> LX_ETT_ITEM.TYPE ~= %TYA
     2255    23828    2        AND ID4$ -> LX_ETT_ITEM.TYPE ~= %TYN
     2256    23829    2        THEN OPTIMIZABLE = FALSE ;
     2257    23830
     2258    23831    2        CALL Z8CO$DISPL_CHECK(ID4$) ALTRET (BAD);
     2259    23832
     2260    23833    2        IF ID4$ -> LX_ITEM.ID = %LX_ETT_ITEM THEN
     2261    23834    3          DO CASE(ID4$ -> LX_ETT_ITEM.TYPE);
     2262    23835    3            CASE(%TYD, %TYO, %TYF, %TYC);
     2263    23836    3              CALL INTEGER_CHECK(ID4$);
     2264    23837    3              CALL Z8CO$P_CHECK(ID4$) ALTRET (BAD);
     2265    23838    3          END /* Case */;
     2266    23839
     2267    23840    2        CALL Z8AU$TYPE_DESCRIPTOR (ID4$ -> LX_ETT_ITEM.ETT$,
     2268    23841    2                                   TYPE_DESC) ;
     2269    23842    2        IF TYPE_DESC.SIZ$ ~= ADDR(NIL)
     2270    23843    2        THEN OPTIMIZABLE = FALSE ;
     2271    23844
     2272    23845    2        RETURN;
     2273    23846
     2274    23847    2   BAD:
     2275    23848    2        PRODUCE_UNSTRING_ILS = FALSE;
     2276    23849
     2277    23850    2   END VALIDATE_ID4;
     2278    23851        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:199  
     2279    23852    1   VALIDATE_ID5: PROC (ID5$) ;
     2280    23853
     2281    23854    2        DCL ID5$      PTR;
     2282    23855
     2283    23856    3          DO CASE (ID5$ -> LX_ITEM.ID) ;
     2284    23857
     2285    23858    3            CASE (%LX_TERMINAL) ; /* EMPTY */
     2286    23859
     2287    23860    3            CASE (%LX_ETT_ITEM) ;
     2288    23861
     2289    23862    3              OPTIMIZABLE = FALSE ;
     2290    23863    4              IF ID5$ -> LX_ITEM.B.ERROR THEN DO ;
     2291    23864    4                PRODUCE_UNSTRING_ILS = FALSE ;
     2292    23865    4                RETURN ;
     2293    23866    4              END ;
     2294    23867
     2295    23868    4              DO CASE (ID5$ -> LX_ETT_ITEM.TYPE) ;
     2296    23869    4                CASE (%TYA, %TYN, %TYE, %TYB) ;
     2297    23870                       /* OK */
     2298    23871    4                CASE (ELSE) ;
     2299    23872    4                  CALL Z8AE$ERROR (%E$ALPHANUMERIC_TYPE_EXPECTED,
     2300    23873    4                                   ID5$ -> LX_ETT_ITEM.LINE,
     2301    23874    4                                   ID5$ -> LX_ETT_ITEM.COLUMN) ;
     2302    23875    4                  PRODUCE_UNSTRING_ILS = FALSE ;
     2303    23876    4              END ;
     2304    23877
     2305    23878    4              IF DELIMITED = FALSE THEN DO ;
     2306    23879    4                CALL Z8AE$ERROR (%E$ILLEGAL_DELIMITER_CLAUSE,
     2307    23880    4                                 ID5$ -> LX_ETT_ITEM.LINE,
     2308    23881    4                                 ID5$ -> LX_ETT_ITEM.COLUMN) ;
     2309    23882    4                PRODUCE_UNSTRING_ILS = FALSE ;
     2310    23883    4              END ;
     2311    23884
     2312    23885    3            CASE (ELSE) ;
     2313    23886
     2314    23887    3              CALL Z8AE$ERROR (%E$UNEXPECTED_CASE) ;
     2315    23888    3              PRODUCE_UNSTRING_ILS = FALSE ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:200  
     2316    23889
     2317    23890    3          END ; /* Case of id5's ID */
     2318    23891
     2319    23892    2   END VALIDATE_ID5;
     2320    23893        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:201  
     2321    23894    1   VALIDATE_ID6: PROC (ID6$) ;
     2322    23895
     2323    23896    2        DCL ID6$      PTR;
     2324    23897
     2325    23898    3          DO CASE (ID6$ -> LX_ITEM.ID) ;
     2326    23899
     2327    23900    3            CASE (%LX_TERMINAL) ; /* EMPTY */
     2328    23901
     2329    23902    3            CASE (%LX_ETT_ITEM) ;
     2330    23903
     2331    23904    3              OPTIMIZABLE = FALSE ;
     2332    23905    4              IF ID6$ -> LX_ITEM.B.ERROR THEN DO ;
     2333    23906    4                PRODUCE_UNSTRING_ILS = FALSE ;
     2334    23907    4                RETURN ;
     2335    23908    4              END ;
     2336    23909
     2337    23910    4              IF DELIMITED = FALSE THEN DO ;
     2338    23911    4                CALL Z8AE$ERROR (%E$ILLEGAL_COUNT_CLAUSE,
     2339    23912    4                                 ID6$ -> LX_ETT_ITEM.LINE,
     2340    23913    4                                 ID6$ -> LX_ETT_ITEM.COLUMN) ;
     2341    23914    4                PRODUCE_UNSTRING_ILS = FALSE ;
     2342    23915    4              END ;
     2343    23916
     2344    23917    3              CALL Z8CO$INTEGER_CHECK (ID6$) ALTRET (BAD) ;
     2345    23918    3              CALL Z8CO$P_CHECK       (ID6$) ALTRET (BAD) ;
     2346    23919
     2347    23920    3            CASE (ELSE) ;
     2348    23921
     2349    23922    3              CALL Z8AE$ERROR (%E$UNEXPECTED_CASE) ;
     2350    23923    3              PRODUCE_UNSTRING_ILS = FALSE ;
     2351    23924
     2352    23925    3          END ; /* Case of id6's ID */
     2353    23926
     2354    23927    2          RETURN ;
     2355    23928
     2356    23929    2   BAD:   PRODUCE_UNSTRING_ILS = FALSE ;
     2357    23930
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:202  
     2358    23931    2   END VALIDATE_ID6;
     2359    23932        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:203  
     2360    23933    1   VALIDATE_ID7: PROC (ID7$, ID1$) ;
     2361    23934
     2362    23935    2        DCL ID7$    PTR;
     2363    23936    2        DCL ID1$    PTR;
     2364    23937
     2365    23938    2        DCL ETT$$   PTR;
     2366    23939    2        DCL ID7_MAX SBIN WORD;
     2367    23940    2        DCL ID1_LEN SBIN WORD;
     2368    23941
     2369    23942    2        POINTER = ID7$ ~= ADDR (NIL) ;
     2370    23943
     2371    23944    2        IF POINTER THEN
     2372    23945    3          DO;
     2373    23946
     2374    23947    3            OPTIMIZABLE = FALSE ;
     2375    23948    4            IF ID7$ -> LX_ITEM.B.ERROR THEN DO ;
     2376    23949    4              PRODUCE_UNSTRING_ILS = FALSE ;
     2377    23950    4              RETURN ;
     2378    23951    4            END ;
     2379    23952
     2380    23953    3            CALL Z8CO$INTEGER_CHECK(ID7$) ALTRET (BAD);
     2381    23954    3            CALL Z8CO$P_CHECK(ID7$) ALTRET (BAD);
     2382    23955
     2383    23956    3            CALL Z8EZ$MAX_VALUE(ID7$, ID7_MAX);
     2384    23957    3            CALL Z8AU$LENGTH_ETT(ID1$ -> LX_ETT_ITEM.ETT$, ETT$$);
     2385    23958
     2386    23959    4            IF ETT$$ -> ETT.ID = %TRIAD THEN DO ; /* Size is constant */
     2387    23960
     2388    23961    4              ID1_LEN = ETT$$ -> ETT.LOP -> CONST.CONSTI.WORD1 ;
     2389    23962
     2390    23963    5              IF ID7_MAX < (1 + ID1_LEN) THEN DO ;
     2391    23964    5                CALL Z8AE$ERROR (%E$ID7_TOO_SMALL,
     2392    23965    5                                 ID7$ -> LX_ETT_ITEM.LINE,
     2393    23966    5                                 ID7$ -> LX_ETT_ITEM.COLUMN) ;
     2394    23967    5                PRODUCE_UNSTRING_ILS = FALSE ;
     2395    23968    5              END ; /* ID7 max size < ID1 length + 1 */
     2396    23969    4            END ; /* Size is a constant */
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:204  
     2397    23970    3          END ; /* POINTER clause exists */
     2398    23971
     2399    23972    2        RETURN;
     2400    23973
     2401    23974    2   BAD:
     2402    23975    2        PRODUCE_UNSTRING_ILS = FALSE;
     2403    23976
     2404    23977    2   END VALIDATE_ID7;
     2405    23978        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:205  
     2406    23979    1   VALIDATE_ID8: PROC (ID8$) ;
     2407    23980
     2408    23981    2          DCL ID8$      PTR;
     2409    23982
     2410    23983    2        TALLYING = ID8$ ~= ADDR(NIL) ;
     2411    23984
     2412    23985    3        IF TALLYING THEN DO ;
     2413    23986
     2414    23987    3          OPTIMIZABLE = FALSE ;
     2415    23988    4          IF ID8$ -> LX_ITEM.B.ERROR THEN DO ;
     2416    23989    4            PRODUCE_UNSTRING_ILS = FALSE ;
     2417    23990    4            RETURN ;
     2418    23991    4          END ;
     2419    23992
     2420    23993    4          DO CASE (ID8$ -> LX_ITEM.ID) ;
     2421    23994
     2422    23995    4            CASE (%LX_TERMINAL) ; /* EMPTY */
     2423    23996
     2424    23997    4            CASE (%LX_ETT_ITEM) ;
     2425    23998
     2426    23999    4              CALL Z8CO$INTEGER_CHECK (ID8$) ALTRET (BAD) ;
     2427    24000    4              CALL Z8CO$P_CHECK       (ID8$) ALTRET (BAD) ;
     2428    24001
     2429    24002    4            CASE (ELSE) ;
     2430    24003
     2431    24004    4              CALL Z8AE$ERROR (%E$UNEXPECTED_CASE) ;
     2432    24005    4              PRODUCE_UNSTRING_ILS = FALSE ;
     2433    24006
     2434    24007    4          END ; /* Case of id6's ID */
     2435    24008
     2436    24009    3        END ;
     2437    24010
     2438    24011    2        RETURN ;
     2439    24012
     2440    24013    2   BAD:   PRODUCE_UNSTRING_ILS = FALSE ;
     2441    24014
     2442    24015    2   END VALIDATE_ID8;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:206  
     2443    24016        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:207  
     2444    24017        /*I*   NAME: INTEGER_CHECK
     2445    24018
     2446    24019        DESCRIPTION: This routine issues a warning message if the identifier
     2447    24020                     is not an integer variable.
     2448    24021
     2449    24022        */
     2450    24023    1   INTEGER_CHECK:PROC(ID$);
     2451    24024
     2452    24025    2        DCL ID$ PTR;
     2453    24026
     2454    24027    2        CALL Z8CO$INTEGER_CHECK_NO_ERROR (ID$)
     2455    24028    3          WHENALTRETURN DO;
     2456    24029                 %CONDITIONAL_ERROR (@LX_ITEM$ = ID$,
     2457    24030                                     @ERROR#   = %E$SHOULD_BE_INTEGER,
     2458    24031                                     @LINE     = ID$ -> LX_ETT_ITEM.LINE,
     2459    24032                                     @COLUMN   = ID$ -> LX_ETT_ITEM.COLUMN);
     2460    24062    3          END;
     2461    24063
     2462    24064    2   END INTEGER_CHECK;
     2463    24065        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:208  
     2464    24066        /*I*   NAME: PREPARE_IDn, n = 1 -> 8
     2465    24067
     2466    24068        DESCRIPTION: These routines are used by Pass 3 of Z8EZ$UNSTRING.
     2467    24069                     They prepare each operand for use by the general
     2468    24070                     STRING algorithm.  This includes conversions from
     2469    24071                     one type to another, setting the type for a constant,
     2470    24072                     and finding the length of an operand.
     2471    24073
     2472    24074        */
     2473    24075
     2474    24076        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:209  
     2475    24077    1   PREPARE_ID1: PROC (IDENT$, ID1$) ;
     2476    24078
     2477    24079    2   DCL  ID1$      PTR ;
     2478    24080    2   DCL  IDENT$    PTR ;
     2479    24081    2   DCL  ID1_ST$   PTR ;
     2480    24082
     2481    24083
     2482    24084    3          IF IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.ID = %SSOP THEN DO ;
     2483    24085                 %INIT_LX_ETT_ITEM (@POINTER = ID1$, @TYPE = %TYA) ;
     2484    24107    3            CALL Z8AT$CREATE_TEMP_WITH_BASE (%SCALAR, ID1$ -> LX_ETT_ITEM.ETT$) ;
     2485    24108    3            ID1_ST$ = ID1$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP ;
     2486    24109    3            ID1_ST$ -> VARIABLE.TYPE = %TYA ;
     2487    24110    3            CALL Z8AU$TYPE_DESCRIPTOR (IDENT$ -> LX_ETT_ITEM.ETT$, TYPE_DESC) ;
     2488    24111    3            ID1_ST$ -> VARIABLE.ADSC.N = TYPE_DESC.DESC.ADSC.N ;
     2489    24112    3            CALL Z8E7$MOVE (ID1$, IDENT$) ;
     2490    24113    3          END ;
     2491    24114    3          ELSE DO ; /* ID1 IS NOT SUBSCRIPTED */
     2492    24115    3            ID1$ -> LX_ETT_ITEM = IDENT$ -> LX_ETT_ITEM ;
     2493    24116    3          END ;
     2494    24117
     2495    24118    2          CALL Z8AU$LENGTH (ID1$ -> LX_ETT_ITEM.ETT$, LENGTH_ID1$) ;
     2496    24119
     2497    24120    2   END PREPARE_ID1  ;
     2498    24121
     2499    24122        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:210  
     2500    24123    1   PREPARE_ID2: PROC (DELIMITED$, ID2$) ;
     2501    24124
     2502    24125    2   DCL  DELIMITED$  PTR ;
     2503    24126    2   DCL  ID2$        PTR ;
     2504    24127    2   DCL  ID2_ST$     PTR ;
     2505    24128
     2506    24129    2          IF  DELIMITED$ -> LX_ITEM.ID = %LX_ETT_ITEM
     2507    24130    3          AND DELIMITED$ -> LX_ETT_ITEM.ETT$ -> ETT.ID = %SSOP THEN DO ;
     2508    24131                 %INIT_LX_ETT_ITEM (@POINTER = ID2$, @TYPE = %TYA) ;
     2509    24153    3            CALL Z8AT$CREATE_TEMP_WITH_BASE (%SCALAR, ID2$ -> LX_ETT_ITEM.ETT$) ;
     2510    24154    3            ID2_ST$ = ID2$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP ;
     2511    24155    3            ID2_ST$ -> VARIABLE.TYPE = %TYA ;
     2512    24156    3            CALL Z8AU$TYPE_DESCRIPTOR (DELIMITED$ -> LX_ETT_ITEM.ETT$, TYPE_DESC) ;
     2513    24157    3            ID2_ST$ -> VARIABLE.ADSC.N = TYPE_DESC.DESC.ADSC.N ;
     2514    24158    3            CALL Z8E7$MOVE (ID2$, DELIMITED$) ;
     2515    24159    3            DELIMITED$ -> LX_ETT_ITEM.ETT$ = ID2$ -> LX_ETT_ITEM.ETT$ ;
     2516    24160    3          END ;
     2517    24161    3          ELSE DO ; /* ID2 IS NOT SUBSCRIPTED */
     2518    24162    3            ID2$ -> LX_ETT_ITEM = DELIMITED$ -> LX_ETT_ITEM ;
     2519    24163    3          END ;
     2520    24164
     2521    24165    2          ALL = DELIMITED$ -> LX_ITEM.B.ALL ;
     2522    24166    2          ID2$ -> LX_ITEM.B.ALL = '0'B ;
     2523    24167
     2524    24168    2          IF ID2$ -> LX_ETT_ITEM.TYPE ~= %TYA
     2525    24169    3          AND ID2$ -> LX_ETT_ITEM.TYPE ~= %TYN THEN DO ;
     2526    24170    3            CALL Z8EV$CONVERT_TYA (ID2$, ID2$, ID1$) ;
     2527    24171    3          END ;
     2528    24172
     2529    24173    2          CALL Z8AU$LENGTH (ID2$ -> LX_ETT_ITEM.ETT$, LENGTH_ID2$) ;
     2530    24174                                                            /*#31092*/
     2531    24175    2          IF ID2$ -> LX_ETT_ITEM.ETT$ -> ETT.ID = %TRIAD   AND
     2532    24176    2             ID2$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP -> ST.ID = %CONST  AND
     2533    24177    2             ID2$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP -> ST.NDSC.N = 1   THEN;
     2534    24178                  /* O.K. */
     2535    24179    2          ELSE
     2536    24180    2            ALL_LENGTH_1 = FALSE;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:211  
     2537    24181
     2538    24182    2   END PREPARE_ID2  ;
     2539    24183
     2540    24184        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:212  
     2541    24185    1   PREPARE_ID4: PROC (INTO$, ID4$) ;
     2542    24186
     2543    24187    2   DCL  INTO$  PTR ;
     2544    24188    2   DCL  ID4$   PTR ;
     2545    24189
     2546    24190    2          ID4$ -> LX_ETT_ITEM = INTO$ -> LX_ETT_ITEM ;
     2547    24191
     2548    24192    2          CALL Z8AU$LENGTH (ID4$ -> LX_ETT_ITEM.ETT$, LENGTH_ID4$) ;
     2549    24193
     2550    24194    2   END PREPARE_ID4  ;
     2551    24195
     2552    24196        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:213  
     2553    24197    1   PREPARE_ID5:  PROC (DELIMITER$, ID5$) ;
     2554    24198
     2555    24199    2   DCL  DELIMITER$  PTR ;
     2556    24200    2   DCL  ID5$        PTR ;
     2557    24201
     2558    24202    3        IF DELIMITER$ -> LX_ITEM.ID = %LX_TERMINAL THEN DO ;
     2559    24203    3          DELIMITER = FALSE ;
     2560    24204    3        END ;
     2561    24205    3        ELSE DO ;
     2562    24206    3          DELIMITER = TRUE ;
     2563    24207    3          ID5$ -> LX_ETT_ITEM = DELIMITER$ -> LX_ETT_ITEM ;
     2564    24208    3        END ;
     2565    24209
     2566    24210    2   END PREPARE_ID5 ;
     2567    24211
     2568    24212        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:214  
     2569    24213    1   PREPARE_ID6: PROC (COUNT$, ID6$) ;
     2570    24214
     2571    24215    2   DCL  COUNT$  PTR ;
     2572    24216    2   DCL  ID6$    PTR ;
     2573    24217
     2574    24218    3        IF COUNT$ -> LX_ITEM.ID = %LX_TERMINAL THEN DO ; /* EMPTY */
     2575    24219    3            COUNT = FALSE ;
     2576    24220                 %INIT_LX_ETT_ITEM (@POINTER = ID6$, @TYPE = %TYI) ;
     2577    24242    3            CALL Z8AT$CREATE_TEMP_WITH_BASE (%SCALAR, ID6$ -> LX_ETT_ITEM.ETT$) ;
     2578    24243    3          END ;
     2579    24244
     2580    24245    3          ELSE DO ;
     2581    24246    3            COUNT = TRUE ;
     2582    24247    3            ID6$ -> LX_ETT_ITEM = COUNT$ -> LX_ETT_ITEM ;
     2583    24248    3          END ;
     2584    24249
     2585    24250    2   END PREPARE_ID6 ;
     2586    24251
     2587    24252        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:215  
     2588    24253    1   PREPARE_ID7: PROC (POINTER$, ID7$) ;
     2589    24254
     2590    24255    2   DCL  POINTER$  PTR ;
     2591    24256    2   DCL  ID7$      PTR ;
     2592    24257
     2593    24258
     2594    24259    3          IF POINTER = FALSE THEN DO ;
     2595    24260
     2596    24261                 %INIT_LX_ETT_ITEM (@POINTER = ID7$, @TYPE = %TYI) ;
     2597    24283    3            CALL Z8AT$CREATE_TEMP_WITH_BASE (%SCALAR, ID7$ -> LX_ETT_ITEM.ETT$) ;
     2598    24284    3            CALL Z8E7$MOVE (ID7$, ONE$) ; /* ID7 = 1 */
     2599    24285
     2600    24286    3          END ;
     2601    24287
     2602    24288    3          ELSE DO ;
     2603    24289
     2604    24290                 /*N* IF ID7 IS SUBSCRIPTED, MOVE IT TO TEMP, THEN
     2605    24291                      MOVE TEMP BACK TO ID7 AFTER UNSTRING????
     2606    24292                      OR USE ADDR TO FIND EFFECTIVE ADDRESS.
     2607    24293                 */
     2608    24294
     2609    24295    3            ID7$ -> LX_ETT_ITEM = POINTER$ -> LX_ETT_ITEM ;
     2610    24296
     2611    24297    3          END ;
     2612    24298
     2613    24299    2   END PREPARE_ID7 ;
     2614    24300
     2615    24301        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:216  
     2616    24302    1   PREPARE_ID8: PROC (TALLYING$, ID8$) ;
     2617    24303
     2618    24304    2   DCL  TALLYING$  PTR ;
     2619    24305    2   DCL  ID8$       PTR ;
     2620    24306
     2621    24307
     2622    24308    3          IF TALLYING$ = ADDR (NIL) THEN DO ;
     2623    24309    3            TALLYING = FALSE ;
     2624    24310    3          END ;
     2625    24311
     2626    24312    3          ELSE DO ;
     2627    24313    3            TALLYING = TRUE ;
     2628    24314                 /*N* SEE COMMENT IN PREPARE ID7 */
     2629    24315    3            ID8$ -> LX_ETT_ITEM = TALLYING$ -> LX_ETT_ITEM ;
     2630    24316    3          END ;
     2631    24317
     2632    24318    2   END PREPARE_ID8 ;
     2633    24319
     2634    24320        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:217  
     2635    24321        /*I*   NAME: ADD_A_AND_B_GIVING_C
     2636    24322
     2637    24323        DESCRIPTION: Generate ILL/ETT to add two operands and save the result.
     2638    24324
     2639    24325        */
     2640    24326
     2641    24327    1   ADD_A_AND_B_GIVING_C: PROC (A$, B$, C$) ;
     2642    24328
     2643    24329    2   DCL  A$    PTR ; /* LX_ETT_ITEMS */
     2644    24330    2   DCL  B$    PTR ;
     2645    24331    2   DCL  C$    PTR ;
     2646    24332    2   DCL  ADD$  PTR ;
     2647    24333
     2648    24334        %DCL_AUTO_LX_ITEM (@NAME = ADD) ;
     2649    24338
     2650    24339               /*V* C = A + B */
     2651    24340
     2652    24341    2          ADD$ = ADDR(ADD) ;
     2653    24342
     2654    24343               %INIT_BINARY_OP (@POINTER = ADD$,
     2655    24344                                @LOP$    = A$,
     2656    24345                                @OP      = %OP_PLUS,
     2657    24346                                @ROP$    = B$,
     2658    24347                                @LINE    = "A$ -> LX_ETT_ITEM.LINE",
     2659    24348                                @COLUMN  = "A$ -> LX_ETT_ITEM.COLUMN") ;
     2660    24366
     2661    24367    2          CALL Z8E5$MATH_PACK (ADD$, ADD$) ;
     2662    24368    2          CALL Z8E7$MOVE (C$, ADD$) ;
     2663    24369
     2664    24370    2   END ADD_A_AND_B_GIVING_C ;
     2665    24371        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:218  
     2666    24372        /*===========*/
     2667    24373    1     KANJI_INDEX : PROC ( COUNT$, DELIMS$ );
     2668    24374        /*===========*/
     2669    24375
     2670    24376    2   DCL BEGAIN_INDEX$       PTR;
     2671    24377    2   DCL END_INDEX$          PTR;
     2672    24378
     2673    24379        %DCL_AUTO_LX_ITEM( @NAME = COUNT );
     2674    24383        %DCL_AUTO_LX_ITEM( @NAME = SUB );
     2675    24387        %DCL_AUTO_LX_ITEM( @NAME = COMPARISON );
     2676    24391        %DCL_AUTO_LX_ITEM( @NAME = LENGTH_ID1 );
     2677    24395        %DCL_AUTO_LX_ITEM( @NAME = LENGTH_ID2 );
     2678    24399        %DCL_AUTO_LX_ITEM( @NAME = SUB_STR );
     2679    24403
     2680    24404    2   DCL COUNT$              PTR;
     2681    24405    2   DCL COUNT_BASE$         PTR;
     2682    24406    2   DCL SUBSTR$             PTR;
     2683    24407    2   DCL SUB$                PTR;
     2684    24408    2   DCL COMPARISON$         PTR;
     2685    24409    2   DCL LENGTH_ID1$         PTR;
     2686    24410    2   DCL LENGTH_ID2$         PTR;
     2687    24411    2   DCL DELIMS$             PTR;
     2688    24412    2   DCL DELIMS$$            PTR;
     2689    24413
     2690    24414
     2691    24415    2   DELIMS$$ = DELIMS$;
     2692    24416    2   SUB$ = ADDR( SUB );
     2693    24417    2   SUBSTR$ = ADDR( SUB_STR );
     2694    24418
     2695    24419    2   CALL Z8AT$CREATE_TEMPORARY( %PARA, BEGAIN_INDEX$ );
     2696    24420    2   CALL Z8AT$CREATE_TEMPORARY( %PARA, END_INDEX$ );
     2697    24421
     2698    24422    2   LENGTH_ID1$ = ADDR( LENGTH_ID1 );
     2699    24423    2   CALL Z8AU$LENGTH( ID1$ -> LX_ETT_ITEM.ETT$,
     2700    24424    2                     LENGTH_ID1$ );
     2701    24425
     2702    24426        %NEW_ILL( @ID  = %MVII,
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:219  
     2703    24427                  @LOP = COUNT$ -> LX_ETT_ITEM.ETT$,
     2704    24428                  @ROP = ID7$ -> LX_ETT_ITEM.ETT$ );
     2705    24807
     2706    24808        %NEW_ILL( @ID  = %SB2I,
     2707    24809                  @LOP = COUNT$ -> LX_ETT_ITEM.ETT$,
     2708    24810                  @ROP = ONE$ -> LX_ETT_ITEM.ETT$ );
     2709    25189
     2710    25190        %NEW_ILL( @ID  = %DEFLB,
     2711    25191                  @LOP = BEGAIN_INDEX$ );
     2712    25570
     2713    25571        %INIT_BINARY_OP( @POINTER = SUB$,
     2714    25572                         @LOP$    = LENGTH_ID1$,
     2715    25573                         @ROP$    = TWO$,
     2716    25574                         @OP      = %OP_BINARY_MINUS,
     2717    25575                         @LINE    = "ID1$ -> LX_ETT_ITEM.LINE",
     2718    25576                         @COLUMN  = "ID1$ -> LX_ETT_ITEM.COLUMN" );
     2719    25594
     2720    25595        %IF_THEN_DO( @LOP = COUNT$,
     2721    25596                     @ROP = SUB$,
     2722    25597                     @REL = %OP_LESS_THAN_OR_EQUAL,
     2723    25598                     @LAB = END_INTO$ );
     2724    25632
     2725    25633    2   LENGTH_ID2$ = ADDR( LENGTH_ID2 );
     2726    25634    2   COMPARISON$ = ADDR( COMPARISON );
     2727    25635
     2728    25636    3   DO WHILE DELIMS$$ ~= ADDR(NIL);
     2729    25637
     2730    25638    3     CALL PREPARE_ID2( DELIMS$$, ID2$ );
     2731    25639    3     CALL Z8AU$LENGTH( ID2$ -> LX_ETT_ITEM.ETT$,
     2732    25640    3                       LENGTH_ID2$ );
     2733    25641
     2734    25642    3     CALL Z8EA$SUBSTR_ZERO( ID1$,
     2735    25643    3                            COUNT$,
     2736    25644    3                            LENGTH_ID2$,
     2737    25645    3                            SUBSTR$ );
     2738    25646
     2739    25647          %INIT_BINARY_OP( @POINTER = COMPARISON$,
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:220  
     2740    25648                           @LOP$    = SUBSTR$,
     2741    25649                           @OP      = %OP_EQUAL,
     2742    25650                           @ROP$    = ID2$,
     2743    25651                           @LINE    = "ID2$ -> LX_ETT_ITEM.LINE",
     2744    25652                           @COLUMN  = "ID2$ -> LX_ETT_ITEM.COLUMN" );
     2745    25670
     2746    25671    3     CALL Z8EK$BRANCH_TRUE( END_INDEX$,
     2747    25672    3                            COMPARISON$ );
     2748    25673    3     DELIMS$$ = DELIMS$$ -> LX_ITEM.LINK;
     2749    25674
     2750    25675    3   END;
     2751    25676
     2752    25677        %NEW_ILL( @ID  = %AD2I,
     2753    25678                  @LOP = COUNT$ -> LX_ETT_ITEM.ETT$,
     2754    25679                  @ROP = TWO$ -> LX_ETT_ITEM.ETT$ );
     2755    26058
     2756    26059    2   CALL Z8EK$BRANCH( BEGAIN_INDEX$ );
     2757    26060
     2758    26061        %NEW_ILL( @ID = %DEFLB,
     2759    26062                  @LOP = END_INDEX$ );
     2760    26441
     2761    26442        %NEW_ILL( @ID = %AD2I,
     2762    26443                  @LOP = COUNT$ -> LX_ETT_ITEM.ETT$,
     2763    26444                  @ROP = ONE$ -> LX_ETT_ITEM.ETT$ );
     2764    26823
     2765    26824        %NEW_ILL( @ID  = %SB2I,
     2766    26825                  @LOP = COUNT$ -> LX_ETT_ITEM.ETT$,
     2767    26826                  @ROP = ID7$ -> LX_ETT_ITEM.ETT$ );
     2768    27205
     2769    27206    2   END KANJI_INDEX;
     2770    27207
     2771    27208    1   END Z8EZ$UNSTRING ;
     2772    27209        %EOD ;

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:221  
--  Include file information  --

   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LIBRARY.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_ILS_LIST.:Z8A6TOU  is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EZ$UNSTRING.

   Procedure Z8EZ$UNSTRING requires 3521 words for executable code.
   Procedure Z8EZ$UNSTRING requires 432 words of local(AUTO) storage.

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:222  

 Object Unit name= Z8EZ$UNSTRING                              File name= Z8EZ.:Z8A6TOU
 UTS= AUG 09 '97 13:03:06.00 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none    90    132  LEX_SYMBOL
    2  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
    3  LblCom even  none    90    132  TEMP_LEX_SYMBOL
    4  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
    5  LblCom even  none     1      1  ST$
    6  LblCom even  none     5      5  ST_
    7  LblCom even  none     1      1  ILL$
    8  LblCom even  none     5      5  ILL_
    9  LblCom even  none     1      1  ETT$
   10  LblCom even  none     1      1  HEAD_ETT$
   11  LblCom even  none   512   1000  ETT_BUCKETS
   12  LblCom even  none     5      5  ETT_
   13  LblCom even  none     1      1  ILS$
   14  LblCom even  none     5      5  ILS_
   15  LblCom even  none     1      1  LTS$
   16  LblCom even  none     5      5  LTS_
   17  LblCom even  none     1      1  DNT$
   18  LblCom even  none     5      5  DNT_
   19  LblCom even  none     1      1  DNT_BUCKET_NUMBER
   20  LblCom even  none     1      1  DNT_OF_1$
   21  RoData even  UTS      1      1  Z8EZ$UNSTRING
   22   Proc  even  none  3521   6701  Z8EZ$UNSTRING
   23  RoData even  none    70    106  Z8EZ$UNSTRING
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:223  

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    22      0   yes            yes      Std        3  Z8EZ$UNSTRING

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std      12 Z8AE$ERROR
         yes           Std       2 Z8CO$CREATE_LIBRARY_BASE
         yes           Std       4 Z8AN$NEW_ILL
         yes           Std       3 Z8AH$NEW_DNT
         yes           Std       2 Z8AU$TYPE_DESCRIPTOR
         yes           Std       5 Z8EZ$SEARCH
         yes           Std       1 Z8AR$RESERVER
         yes           Std       4 Z8EA$SUBSTR_ZERO
         yes           Std       1 Z8EK$BRANCH
         yes           Std       4 Z8EY$SUBSTR
         yes           Std       2 Z8EK$BRANCH_TRUE
         yes           Std       2 Z8AT$CREATE_TEMP_WITH_BASE
         yes           Std       2 Z8AT$CREATE_TEMPORARY
         yes           Std       2 Z8AC$LX_ETT_ITEM_TYI_CONST
         yes           Std       4 Z8AF$FORME
         yes           Std       2 Z8EK$BRANCH_FALSE
         yes           Std       2 Z8E7$MOVE
         yes           Std       2 Z8E5$MATH_PACK
         yes           Std       5 Z8AN$NEW_ILL1
         yes           Std       2 Z8EA$ASCBIN
         yes           Std       2 Z8EQ$CREATE_DO_WHILE
         yes           Std       3 Z8AF$NEW_OFF
         yes           Std       4 Z8AF$NEW_FISS
 yes     yes           Std       1 Z8CO$DISPL_CHECK
 yes     yes           Std       1 Z8CO$P_CHECK
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:224  
 yes     yes           Std       1 Z8CO$INTEGER_CHECK
         yes           Std       2 Z8AU$LENGTH_ETT
         yes           Std       2 Z8EZ$MAX_VALUE
 yes     yes           Std       1 Z8CO$INTEGER_CHECK_NO_ERROR
         yes           Std       2 Z8AU$LENGTH
         yes           Std       3 Z8EV$CONVERT_TYA
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    ILL_STEP                              O1COM                                 HIER_STK_PTR
     HIER_STK                              PAGE_FORMAT                           REP_STK_PTR
     REP_STK                               COMCOM                           r    ILS_STEP_TABLE
r    LTS_STEP

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:225  


      995        1        /*T***********************************************************/
      996        2        /*T*                                                         */
      997        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      998        4        /*T*                                                         */
      999        5        /*T***********************************************************/
     1000        6
     1001        7        /*P*   NAME: Z8EZ$UNSTRING
     1002        8             AUTHOR: John Heath (design by Mark Glenn)
     1003        9            PURPOSE: This procedure does semantic checking and produces
     1004       10                     the ILL/ETT for the UNSTRING statement.
     1005       11        */
     1006       12
     1007       13        /*D*   NAME: Z8EZ$UNSTRING
     1008       14
     1009       15              INPUT: Abstract Syntax Tree for the UNSTRING statement.
     1010       16
     1011       17             OUTPUT: ILS/ILL/ETT intermediate language items.
     1012       18
     1013       19        DESCRIPTION: Phase 1 makes 3 passes on the UNSTRING statement.
     1014       20                     The first pass (Z8EN) produces the Abstract
     1015       21                     Syntax Tree (AST).  The second and third passes
     1016       22                     are done by this procedure.
     1017       23
     1018       24             Pass 2: Validate the operands of the UNSTRING statement.
     1019       25
     1020       26             Pass 3: Generate the intermediate language items to do
     1021       27                     the UNSTRING statement.  The UNSTRING statement is
     1022       28                     broken down into smaller statements (MOVE, IF, etc.)
     1023       29                     by this module, thus it makes calls to procedures
     1024       30                     used by these smaller statements (Z8E7$MOVE,
     1025       31                     Z8EK$BRANCH_TRUE, etc.).
     1026       32
     1027       33                     Pass 3 is broken into two parts: optimizable and
     1028       34                     not-optimizable.  The algorithm for optimizable
     1029       35                     UNSTRING (simple UNSTRING with no DELIMITED clauses)
     1030       36                     generates a series of MOVEs.  The algorithm for
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:226  
     1031       37                     non-optimizable UNSTRING is highly dependent on the
     1032       38                     types and numbers of optional clauses used in the
     1033       39                     the statement.
     1034       40        */
     1035       41
     1036       42        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:227  
     1037       43        Z8EZ$UNSTRING: PROC(UNSTRING$,

     43 22 000000   000000 700200 xent  Z8EZ$UNSTRI* TSX0  ! X66_AUTO_3
        22 000001   000660 000003                    ZERO    432,3

     1038       44                            ON_OVERFLOW$,
     1039       45                            NOT_ON_OVERFLOW$ );
     1040       46
     1041       47             %EQU PHASE = 1;
     1042       48             %INCLUDE Z8A_DEFC;
     1043      116             %INCLUDE Z8A_SUPP_MAC;
     1044     2516             %INCLUDE Z8E_MACROS;
     1045     3191             %INCLUDE Z8E_STACKS;
     1046     5457             %INCLUDE Z8A_ST;
     1047     9116             %INCLUDE Z8A_TYPES ;
     1048     9290             %INCLUDE Z8A_ILL ;
     1049     9983             %INCLUDE Z8A_ETT ;
     1050    10284             %INCLUDE Z8E_ILS_LIST ;
     1051    10368             %INCLUDE Z8E_O1COM ;
     1052    11129             %INCLUDE Z8E_WINDOW ;
     1053    13199             %INCLUDE Z8A_LIBRARY ;
     1054    13413             %INCLUDE Z8A_COMCOM ;
     1055    14063             %INCLUDE Z8A_ILS ;
     1056    14172             %INCLUDE Z8A_LTS ;
     1057    16249             %INCLUDE Z8A_ERR_NUMS ;
     1058    17013             %INCLUDE Z8A_DNT ;
     1059    17234
     1060    17235    1   DCL UNSTRING$       PTR;
     1061    17236    1   DCL ON_OVERFLOW$    PTR;
     1062    17237    1   DCL NOT_ON_OVERFLOW$ PTR;
     1063    17238
     1064    17239    1   DCL  ADD$              PTR ;
     1065    17240    1   DCL  SUB$              PTR ;
     1066    17241    1   DCL  ALL               BOOLEAN ;
     1067    17242    1   DCL  ALL_ID2S_ARE_CONSTANT  BOOLEAN ;
     1068    17243    1   DCL  ALL_LENGTH_1      BOOLEAN ;
     1069    17244    1   DCL  AND$              PTR ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:228  
     1070    17245    1   DCL  ASCBIN$           PTR ;
     1071    17246    1   DCL  COMPARISON$       PTR ;
     1072    17247    1   DCL  COMPARISON2$      PTR ;
     1073    17248    1   DCL  COUNT             BOOLEAN ;
     1074    17249    1   DCL  COUNT$            PTR ;
     1075    17250    1   DCL  CURRENT_OFFSET    SBIN WORD ;
     1076    17251    1   DCL  DELIMITED         BOOLEAN ;
     1077    17252    1   DCL  DELIMITER         BOOLEAN ;
     1078    17253    1   DCL  DELIMITER$        PTR ;
     1079    17254    1   DCL  DELIMS$           PTR ;
     1080    17255    1   DCL  DNT$$             PTR ;
     1081    17256    1   DCL  END_IF$           PTR ;
     1082    17257    1   DCL  END_INTO$         PTR ;
     1083    17258    1   DCL  EXIT_INTO_LOOP$    PTR ;
     1084    17259    1   DCL  END_UNSTRING$     PTR ;
     1085    17260    1   DCL  ID1$              PTR ;
     1086    17261    1   DCL  ID1_ST$           PTR ;
     1087    17262    1   DCL  ID2$              PTR ;
     1088    17263    1   DCL  ID2_CHAR          CHAR (1) ;
     1089    17264    1   DCL  ID4$              PTR ;
     1090    17265    1   DCL  ID5$              PTR ;
     1091    17266    1   DCL  ID6$              PTR ;
     1092    17267    1   DCL  ID6_PLUS_ID7$     PTR ;
     1093    17268    1   DCL  ID7$              PTR ;
     1094    17269    1   DCL  ID8$              PTR ;
     1095    17270    1   DCL  IDENT$            PTR ;
     1096    17271    1   DCL  INTO$             PTR ;
     1097    17272    1   DCL  INTO_LABEL$       PTR ;
     1098    17273    1   DCL  INTO_LIST$        PTR ;
     1099    17274    1   DCL  INTO_NO           SBIN WORD ;
     1100    17275    1   DCL  INTO_MAX          SBIN WORD ;
     1101    17276    1   DCL  ID1_LENGTH        SBIN WORD ;
     1102    17277    1   DCL  LENGTH_ID1$       PTR ;
     1103    17278    1   DCL  LENGTH_ID2$       PTR ;
     1104    17279    1   DCL  LENGTH_ID4$       PTR ;
     1105    17280    1   DCL  LOW_VALUE_DELIM   BOOLEAN ;                            /*#30498*/
     1106    17281    1   DCL  LTS$$             PTR ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:229  
     1107    17282    1   DCL  MIN$              PTR ;
     1108    17283    1   DCL  NOT_OVERFLOW_LABEL$ PTR;
     1109    17284    1   DCL  ONE$              PTR ;
     1110    17285    1   DCL  OPTIMIZABLE       BOOLEAN ;
     1111    17286    1   DCL  OVERFLOW          BOOLEAN ;
     1112    17287    1   DCL  OVERFLOW_LABEL$   PTR ;
     1113    17288    1   DCL  POINTER           BOOLEAN ;
     1114    17289    1   DCL  POINTER$          PTR ;
     1115    17290    1   DCL  POSITION$         PTR ;
     1116    17291    1   DCL  PRODUCE_UNSTRING_ILS  BOOLEAN ;
     1117    17292    1   DCL  ST$$              PTR ;
     1118    17293    1   DCL  SPACE_LX$         PTR ;
     1119    17294    1   DCL  SUBSTR$           PTR ;
     1120    17295    1   DCL  TABLE$            PTR ;
     1121    17296    1   DCL  TABLEVAL$         PTR ;
     1122    17297    1   DCL  TABLE_ETT$        PTR ;
     1123    17298    1   DCL  TALLYING          BOOLEAN ;
     1124    17299    1   DCL  TALLYING$         PTR ;
     1125    17300    1   DCL  ZERO$             PTR ;
     1126    17301    1   DCL  TWO$              PTR;
     1127    17302    1   DCL  ID7_TIMES_2$      PTR;
     1128    17303    1   DCL  ID7_DIVIDE_2$     PTR;
     1129    17304    1   DCL  ID6_DIVIDE_2$     PTR;
     1130    17305    1   DCL  ID7_ST$           PTR;
     1131    17306    1   DCL  PLUS_ONE$         PTR;
     1132    17307    1   DCL  SUB_ONE$          PTR;
     1133    17308
     1134    17309    1   DCL 1 TYPE_DESC ALIGNED,
     1135    17310             %TYPE_DESC ;
     1136    17344
     1137    17345    1   DCL 1  SAVED_ILS_LIST DALIGNED,
     1138    17346    1        2 * (0:%(LENGTH_LX_ITEM - 1)) PTR ALIGNED ;
     1139    17347
     1140    17348    1   DCL 1  DO_BODY_ILS_LIST DALIGNED,
     1141    17349    1        2 * (0:%(LENGTH_LX_ITEM - 1)) PTR ALIGNED ;
     1142    17350
     1143    17351
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:230  
     1144    17352    1   DCL  Z8AC$LX_ETT_ITEM_TYI_CONST ENTRY(2) ;
     1145    17353    1   DCL  Z8AE$ERROR                ENTRY (12) ;
     1146    17354    1   DCL  Z8AF$FORME                ENTRY (4) ;
     1147    17355    1   DCL  Z8AF$NEW_FISS             ENTRY (4) ;
     1148    17356    1   DCL  Z8AF$NEW_OFF              ENTRY (3) ;
     1149    17357    1   DCL  Z8AH$NEW_DNT              ENTRY (3) ;
     1150    17358    1   DCL  Z8AT$CREATE_TEMPORARY     ENTRY (2) ;
     1151    17359    1   DCL  Z8AT$CREATE_TEMP_WITH_BASE ENTRY(2) ;
     1152    17360    1   DCL  Z8AU$LENGTH               ENTRY (2) ;
     1153    17361    1   DCL  Z8AU$LENGTH_ETT           ENTRY (2) ;
     1154    17362    1   DCL  Z8EZ$MAX_VALUE            ENTRY (2) ;
     1155    17363    1   DCL  Z8AU$TYPE_DESCRIPTOR      ENTRY (2) ;
     1156    17364    1   DCL  Z8E5$MATH_PACK            ENTRY (2) ;
     1157    17365    1   DCL  Z8E7$MOVE                 ENTRY (2) ;
     1158    17366    1   DCL  Z8EA$ASCBIN               ENTRY (2) ;
     1159    17367    1   DCL  Z8EA$SUBSTR_ZERO          ENTRY (4) ;
     1160    17368    1   DCL  Z8ED$DISPOSE_ABSSYN_TREE  ENTRY (1) ;
     1161    17369    1   DCL  Z8EK$BRANCH               ENTRY (1) ;
     1162    17370    1   DCL  Z8EK$BRANCH_FALSE         ENTRY (2) ;
     1163    17371    1   DCL  Z8EK$BRANCH_TRUE          ENTRY (2) ;
     1164    17372    1   DCL  Z8EK$COMPARE              ENTRY (4) ;
     1165    17373    1   DCL  Z8CO$CREATE_LIBRARY_BASE  ENTRY (2) ;
     1166    17374    1   DCL  Z8CO$DISPL_CHECK          ENTRY (1) ALTRET ;
     1167    17375    1   DCL  Z8CO$INTEGER_CHECK        ENTRY(1) ALTRET;
     1168    17376    1   DCL  Z8CO$INTEGER_CHECK_NO_ERROR ENTRY(1) ALTRET;
     1169    17377    1   DCL  Z8CO$P_CHECK              ENTRY (1) ALTRET ;
     1170    17378    1   DCL  Z8EV$CONVERT              ENTRY (3) ;
     1171    17379    1   DCL  Z8EV$CONVERT_TYA          ENTRY (3) ;
     1172    17380    1   DCL  Z8EQ$CREATE_DO_WHILE      ENTRY (2) ;
     1173    17381    1   DCL  Z8EY$SUBSTR               ENTRY (4) ;
     1174    17382    1   DCL  Z8EZ$SEARCH               ENTRY (5) ;
     1175    17383
     1176    17384        %DCL_AUTO_LX_ITEM (@NAME = ADD) ;
     1177    17388        %DCL_AUTO_LX_ITEM (@NAME = SUB) ;
     1178    17392        %DCL_AUTO_LX_ITEM (@NAME = ANDD) ;
     1179    17396        %DCL_AUTO_LX_ITEM (@NAME = ASC_BIN) ;
     1180    17400        %DCL_AUTO_LX_ITEM (@NAME = COMPARISON) ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:231  
     1181    17404        %DCL_AUTO_LX_ITEM (@NAME = COMPARISON2) ;
     1182    17408        %DCL_AUTO_LX_ITEM (@NAME = ID1) ;
     1183    17412        %DCL_AUTO_LX_ITEM (@NAME = ID2) ;
     1184    17416        %DCL_AUTO_LX_ITEM (@NAME = ID4) ;
     1185    17420        %DCL_AUTO_LX_ITEM (@NAME = ID5) ;
     1186    17424        %DCL_AUTO_LX_ITEM (@NAME = ID6) ;
     1187    17428        %DCL_AUTO_LX_ITEM (@NAME = ID6_PLUS_ID7) ;
     1188    17432        %DCL_AUTO_LX_ITEM (@NAME = ID7) ;
     1189    17436        %DCL_AUTO_LX_ITEM (@NAME = ID8) ;
     1190    17440        %DCL_AUTO_LX_ITEM (@NAME = LENGTH_ID1) ;
     1191    17444        %DCL_AUTO_LX_ITEM (@NAME = LENGTH_ID2) ;
     1192    17448        %DCL_AUTO_LX_ITEM (@NAME = LENGTH_ID4) ;
     1193    17452        %DCL_AUTO_LX_ITEM (@NAME = LOW) ;                           /*#30498*/
     1194    17456        %DCL_AUTO_LX_ITEM (@NAME = MIN) ;
     1195    17460        %DCL_AUTO_LX_ITEM (@NAME = ONE) ;
     1196    17464        %DCL_AUTO_LX_ITEM (@NAME = ID7_TIMES_2);
     1197    17468        %DCL_AUTO_LX_ITEM (@NAME = ID7_DIVIDE_2);
     1198    17472        %DCL_AUTO_LX_ITEM (@NAME = ID6_DIVIDE_2);
     1199    17476        %DCL_AUTO_LX_ITEM (@NAME = POSITION) ;
     1200    17480        %DCL_AUTO_LX_ITEM (@NAME = SPACE_LX) ;
     1201    17484        %DCL_AUTO_LX_ITEM (@NAME = SUB_STR) ;
     1202    17488        %DCL_AUTO_LX_ITEM (@NAME = TABLE) ;
     1203    17492        %DCL_AUTO_LX_ITEM (@NAME = TABLEVAL) ;
     1204    17496        %DCL_AUTO_LX_ITEM (@NAME = TWO) ;
     1205    17500        %DCL_AUTO_LX_ITEM (@NAME = ZERO) ;
     1206    17504        %DCL_AUTO_LX_ITEM (@NAME = PLUS_ONE);
     1207    17508        %DCL_AUTO_LX_ITEM (@NAME = SUB_ONE);
     1208    17512
     1209    17513        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:232  
     1210    17514        %MACRO IF_THEN_DO (@LOP =, @REL =, @ROP =, @LAB =) ;
     1211    17515
     1212    17516               DO ;
     1213    17517                 %LSET LINE@ = CHARTEXT (CONCAT (TEXTCHAR (@LOP),
     1214    17518                                                 ' -> LX_ETT_ITEM.LINE')) ;
     1215    17519                 %LSET COLUMN@ = CHARTEXT (CONCAT (TEXTCHAR (@LOP),
     1216    17520                                                 ' -> LX_ETT_ITEM.COLUMN')) ;
     1217    17521
     1218    17522                 COMPARISON$ = ADDR (COMPARISON) ;
     1219    17523                 %INIT_BINARY_OP (@POINTER = COMPARISON$,
     1220    17524                                  @LOP$    = @LOP,
     1221    17525                                  @OP      = @REL,
     1222    17526                                  @ROP$    = @ROP,
     1223    17527                                  @LINE    = %LINE@,
     1224    17528                                  @COLUMN  = %COLUMN@) ;
     1225    17529
     1226    17530                 CALL Z8AT$CREATE_TEMPORARY (%PARA, @LAB) ;
     1227    17531                 CALL Z8EK$BRANCH_FALSE (@LAB, COMPARISON$) ;
     1228    17532               END ;
     1229    17533
     1230    17534        %MEND ;
     1231    17535
     1232    17536        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:233  
     1233    17537        /*V* PASS 2 --- Validate the operands of the UNSTRING statement */
     1234    17538
     1235    17539    1        IF COMCOM.OB.FIPS.LEVEL >= %INT_LEV THEN

  17539 22 000002   000036 720000 xsym               LXL0    COMCOM+30
        22 000003   000002 100003                    CMPX0   2,DU
        22 000004   000011 604000 22                 TMI     s:17543

     1236    17540    1          CALL Z8AE$ERROR (%E$LEVEL_CHECK,

  17540 22 000005   000002 630400 23                 EPPR0   2
        22 000006   000000 631400 23                 EPPR1   0
        22 000007   000000 701000 xent               TSX1    Z8AE$ERROR
        22 000010   000000 011000                    NOP     0

     1237    17541    1                           O1COM.LINE_NO,
     1238    17542    1                           O1COM.COLUMN_NO);
     1239    17543    1        OPTIMIZABLE = TRUE ;

  17543 22 000011   400000 236003                    LDQ     -131072,DU
        22 000012   200075 756100                    STQ     OPTIMIZABLE,,AUTO

     1240    17544    1        PRODUCE_UNSTRING_ILS = TRUE ;

  17544 22 000013   200103 756100                    STQ     PRODUCE_UNSTRING_ILS,,AUTO

     1241    17545
     1242    17546    1        IDENT$   = UNSTRING$ -> UNSTRING_STMT.IDENT$;

  17546 22 000014   200003 470500                    LDP0    @UNSTRING$,,AUTO
        22 000015   000000 471500                    LDP1    0,,PR0
        22 000016   100002 236100                    LDQ     2,,PR1
        22 000017   200056 756100                    STQ     IDENT$,,AUTO

     1243    17547    1        POINTER$ = UNSTRING$ -> UNSTRING_STMT.POINTER$;

  17547 22 000020   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:234  
        22 000021   100005 236100                    LDQ     5,,PR1
        22 000022   200101 756100                    STQ     POINTER$,,AUTO

     1244    17548    1        TALLYING$ = UNSTRING$ -> UNSTRING_STMT.TALLYING$;

  17548 22 000023   000000 471500                    LDP1    0,,PR0
        22 000024   100006 236100                    LDQ     6,,PR1
        22 000025   200113 756100                    STQ     TALLYING$,,AUTO

     1245    17549
     1246    17550    1        IF UNSTRING$ -> UNSTRING_STMT.DELIM_LIST$ = ADDR(NIL) THEN

  17550 22 000026   000000 471500                    LDP1    0,,PR0
        22 000027   100003 236100                    LDQ     3,,PR1
        22 000030   000005 116000 23                 CMPQ    5
        22 000031   000035 601000 22                 TNZ     s:17553

     1247    17551    1          DELIMS$ = ADDR(NIL);

  17551 22 000032   000005 236000 23                 LDQ     5
        22 000033   200036 756100                    STQ     DELIMS$,,AUTO
        22 000034   000040 710000 22                 TRA     s:17554

     1248    17552    1        ELSE
     1249    17553    1          DELIMS$ = UNSTRING$ -> UNSTRING_STMT.DELIM_LIST$ -> LX_LIST.HEAD$;

  17553 22 000035   100003 473500                    LDP3    3,,PR1
        22 000036   300004 236100                    LDQ     4,,PR3
        22 000037   200036 756100                    STQ     DELIMS$,,AUTO

     1250    17554    1        DELIMITED = DELIMS$ ~= ADDR(NIL) ;

  17554 22 000040   400000 220003                    LDX0    -131072,DU
        22 000041   000005 116000 23                 CMPQ    5
        22 000042   000044 601000 22                 TNZ     s:17554+4
        22 000043   000000 220003                    LDX0    0,DU
        22 000044   000000 636010                    EAQ     0,X0
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:235  
        22 000045   200033 756100                    STQ     DELIMITED,,AUTO

     1251    17555
     1252    17556    1        INTO_LIST$ = UNSTRING$ -> UNSTRING_STMT.INTO_LIST$ -> LX_LIST.HEAD$;

  17556 22 000046   000000 471500                    LDP1    0,,PR0
        22 000047   100004 473500                    LDP3    4,,PR1
        22 000050   300004 236100                    LDQ     4,,PR3
        22 000051   200061 756100                    STQ     INTO_LIST$,,AUTO

     1253    17557
     1254    17558    1        CALL VALIDATE_ID1 (IDENT$) ;

  17558 22 000052   200056 634500                    EPPR4   IDENT$,,AUTO
        22 000053   200551 454500                    STP4    SUB_ONE+9,,AUTO
        22 000054   004423 701000 22                 TSX1    VALIDATE_ID1
        22 000055   000000 011000                    NOP     0

     1255    17559    1        CALL VALIDATE_ID7 (POINTER$, IDENT$) ;

  17559 22 000056   200056 630500                    EPPR0   IDENT$,,AUTO
        22 000057   200552 450500                    STP0    @COUNT$+1,,AUTO
        22 000060   200101 631500                    EPPR1   POINTER$,,AUTO
        22 000061   200551 451500                    STP1    SUB_ONE+9,,AUTO
        22 000062   005112 701000 22                 TSX1    VALIDATE_ID7
        22 000063   000000 011000                    NOP     0

     1256    17560    1        CALL VALIDATE_ID8 (TALLYING$) ;

  17560 22 000064   200113 630500                    EPPR0   TALLYING$,,AUTO
        22 000065   200551 450500                    STP0    SUB_ONE+9,,AUTO
        22 000066   005222 701000 22                 TSX1    VALIDATE_ID8
        22 000067   000000 011000                    NOP     0

     1257    17561
     1258    17562    1        ALL_LENGTH_1 = TRUE ;

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:236  
  17562 22 000070   400000 236003                    LDQ     -131072,DU
        22 000071   200023 756100                    STQ     ALL_LENGTH_1,,AUTO

     1259    17563    1        ALL_ID2S_ARE_CONSTANT = TRUE ;

  17563 22 000072   200022 756100                    STQ     ALL_ID2S_ARE_CONSTANT,,AUTO

     1260    17564
     1261    17565    2        DO WHILE (DELIMS$ ~= ADDR(NIL));

  17565 22 000073   000104 710000 22                 TRA     s:17570

     1262    17566    2          CALL VALIDATE_ID2 (DELIMS$);

  17566 22 000074   200036 630500                    EPPR0   DELIMS$,,AUTO
        22 000075   200551 450500                    STP0    SUB_ONE+9,,AUTO
        22 000076   004504 701000 22                 TSX1    VALIDATE_ID2
        22 000077   000000 011000                    NOP     0

     1263    17567    2          OPTIMIZABLE = FALSE ;

  17567 22 000100   200075 450100                    STZ     OPTIMIZABLE,,AUTO

     1264    17568
     1265    17569    2          DELIMS$ = DELIMS$ -> LX_ITEM.LINK;

  17569 22 000101   200036 470500                    LDP0    DELIMS$,,AUTO
        22 000102   000007 236100                    LDQ     7,,PR0
        22 000103   200036 756100                    STQ     DELIMS$,,AUTO

     1266    17570    2        END /* While */;

  17570 22 000104   200036 236100                    LDQ     DELIMS$,,AUTO
        22 000105   000005 116000 23                 CMPQ    5
        22 000106   000074 601000 22                 TNZ     s:17566

     1267    17571
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:237  
     1268    17572    1        INTO_MAX = 0 ;

  17572 22 000107   200063 450100                    STZ     INTO_MAX,,AUTO

     1269    17573
     1270    17574    2        DO UNTIL (INTO_LIST$ = ADDR(NIL));

     1271    17575    2          INTO_MAX = INTO_MAX + 1 ;

  17575 22 000110   200063 054100                    AOS     INTO_MAX,,AUTO

     1272    17576    2          ID4$ = INTO_LIST$ -> LX_LIST.HEAD$;

  17576 22 000111   200061 470500                    LDP0    INTO_LIST$,,AUTO
        22 000112   000004 236100                    LDQ     4,,PR0
        22 000113   200050 756100                    STQ     ID4$,,AUTO

     1273    17577    2          ID5$ = INTO_LIST$ -> LX_LIST.HEAD$ -> LX_ITEM.LINK;

  17577 22 000114   000004 471500                    LDP1    4,,PR0
        22 000115   100007 236100                    LDQ     7,,PR1
        22 000116   200051 756100                    STQ     ID5$,,AUTO

     1274    17578    2          ID6$ = INTO_LIST$ -> LX_LIST.TAIL$;

  17578 22 000117   000001 236100                    LDQ     1,,PR0
        22 000120   200052 756100                    STQ     ID6$,,AUTO

     1275    17579
     1276    17580    2          CALL VALIDATE_ID4 (ID4$) ;

  17580 22 000121   200050 631500                    EPPR1   ID4$,,AUTO
        22 000122   200551 451500                    STP1    SUB_ONE+9,,AUTO
        22 000123   004614 701000 22                 TSX1    VALIDATE_ID4
        22 000124   000000 011000                    NOP     0

     1277    17581    2          CALL VALIDATE_ID5 (ID5$) ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:238  

  17581 22 000125   200051 630500                    EPPR0   ID5$,,AUTO
        22 000126   200551 450500                    STP0    SUB_ONE+9,,AUTO
        22 000127   004726 701000 22                 TSX1    VALIDATE_ID5
        22 000130   000000 011000                    NOP     0

     1278    17582    2          CALL VALIDATE_ID6 (ID6$) ;

  17582 22 000131   200052 630500                    EPPR0   ID6$,,AUTO
        22 000132   200551 450500                    STP0    SUB_ONE+9,,AUTO
        22 000133   005030 701000 22                 TSX1    VALIDATE_ID6
        22 000134   000000 011000                    NOP     0

     1279    17583
     1280    17584    2          INTO_LIST$ = INTO_LIST$ -> LX_LIST.LINK;

  17584 22 000135   200061 470500                    LDP0    INTO_LIST$,,AUTO
        22 000136   000007 236100                    LDQ     7,,PR0
        22 000137   200061 756100                    STQ     INTO_LIST$,,AUTO

     1281    17585    2        END /* Until */;

  17585 22 000140   000005 116000 23                 CMPQ    5
        22 000141   000110 601000 22                 TNZ     s:17575

     1282    17586
     1283    17587        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:239  
     1284    17588        /*V* UNSTRING_PASS_3 */
     1285    17589
     1286    17590    1          IF PRODUCE_UNSTRING_ILS = FALSE THEN GOTO BAD_UNSTRING ;

  17590 22 000142   200103 234100                    SZN     PRODUCE_UNSTRING_ILS,,AUTO
        22 000143   004032 605000 22                 TPL     BAD_UNSTRING

     1287    17591
     1288    17592    1          ADD$ = ADDR (ADD) ;

  17592 22 000144   200150 630500                    EPPR0   ADD,,AUTO
        22 000145   200017 450500                    STP0    ADD$,,AUTO

     1289    17593    1          SUB$ = ADDR (SUB) ;

  17593 22 000146   200160 631500                    EPPR1   SUB,,AUTO
        22 000147   200020 451500                    STP1    SUB$,,AUTO

     1290    17594    1          AND$ = ADDR (ANDD) ;

  17594 22 000150   200170 633500                    EPPR3   ANDD,,AUTO
        22 000151   200024 453500                    STP3    AND$,,AUTO

     1291    17595    1          ASCBIN$ = ADDR (ASC_BIN) ;

  17595 22 000152   200200 634500                    EPPR4   ASC_BIN,,AUTO
        22 000153   200025 454500                    STP4    ASCBIN$,,AUTO

     1292    17596    1          COMPARISON$ = ADDR (COMPARISON) ;

  17596 22 000154   200210 635500                    EPPR5   COMPARISON,,AUTO
        22 000155   200026 455500                    STP5    COMPARISON$,,AUTO

     1293    17597    1          COMPARISON2$ = ADDR (COMPARISON2) ;

  17597 22 000156   200220 636500                    EPPR6   COMPARISON2,,AUTO
        22 000157   200027 456500                    STP6    COMPARISON2$,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:240  

     1294    17598    1          ID1$ = ADDR (ID1) ;

  17598 22 000160   200230 637500                    EPPR7   ID1,,AUTO
        22 000161   200044 457500                    STP7    ID1$,,AUTO

     1295    17599    1          ID2$ = ADDR (ID2) ;

  17599 22 000162   200240 630500                    EPPR0   ID2,,AUTO
        22 000163   200046 450500                    STP0    ID2$,,AUTO

     1296    17600    1          ID4$ = ADDR (ID4) ;

  17600 22 000164   200250 630500                    EPPR0   ID4,,AUTO
        22 000165   200050 450500                    STP0    ID4$,,AUTO

     1297    17601    1          ID5$ = ADDR (ID5) ;

  17601 22 000166   200260 630500                    EPPR0   ID5,,AUTO
        22 000167   200051 450500                    STP0    ID5$,,AUTO

     1298    17602    1          ID6$ = ADDR (ID6) ;

  17602 22 000170   200270 630500                    EPPR0   ID6,,AUTO
        22 000171   200052 450500                    STP0    ID6$,,AUTO

     1299    17603    1          ID6_PLUS_ID7$ = ADDR (ID6_PLUS_ID7) ;

  17603 22 000172   200300 630500                    EPPR0   ID6_PLUS_ID7,,AUTO
        22 000173   200053 450500                    STP0    ID6_PLUS_ID7$,,AUTO

     1300    17604    1          ID7$ = ADDR (ID7) ;

  17604 22 000174   200310 630500                    EPPR0   ID7,,AUTO
        22 000175   200054 450500                    STP0    ID7$,,AUTO

     1301    17605    1          ID8$ = ADDR (ID8) ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:241  

  17605 22 000176   200320 630500                    EPPR0   ID8,,AUTO
        22 000177   200055 450500                    STP0    ID8$,,AUTO

     1302    17606    1          LENGTH_ID1$ = ADDR (LENGTH_ID1) ;

  17606 22 000200   200330 630500                    EPPR0   LENGTH_ID1,,AUTO
        22 000201   200065 450500                    STP0    LENGTH_ID1$,,AUTO

     1303    17607    1          LENGTH_ID2$ = ADDR (LENGTH_ID2) ;

  17607 22 000202   200340 630500                    EPPR0   LENGTH_ID2,,AUTO
        22 000203   200066 450500                    STP0    LENGTH_ID2$,,AUTO

     1304    17608    1          LENGTH_ID4$ = ADDR (LENGTH_ID4) ;

  17608 22 000204   200350 630500                    EPPR0   LENGTH_ID4,,AUTO
        22 000205   200067 450500                    STP0    LENGTH_ID4$,,AUTO

     1305    17609    1          MIN$ = ADDR (MIN) ;

  17609 22 000206   200370 630500                    EPPR0   MIN,,AUTO
        22 000207   200072 450500                    STP0    MIN$,,AUTO

     1306    17610    1          ONE$ = ADDR (ONE) ;

  17610 22 000210   200400 630500                    EPPR0   ONE,,AUTO
        22 000211   200074 450500                    STP0    ONE$,,AUTO

     1307    17611    1          TWO$ = ADDR (TWO);

  17611 22 000212   200510 630500                    EPPR0   TWO,,AUTO
        22 000213   200115 450500                    STP0    TWO$,,AUTO

     1308    17612    1          POSITION$ = ADDR (POSITION) ;

  17612 22 000214   200440 630500                    EPPR0   POSITION,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:242  
        22 000215   200102 450500                    STP0    POSITION$,,AUTO

     1309    17613    1          SPACE_LX$ = ADDR (SPACE_LX) ;

  17613 22 000216   200450 630500                    EPPR0   SPACE_LX,,AUTO
        22 000217   200105 450500                    STP0    SPACE_LX$,,AUTO

     1310    17614    1          SUBSTR$ = ADDR (SUB_STR) ;

  17614 22 000220   200460 630500                    EPPR0   SUB_STR,,AUTO
        22 000221   200106 450500                    STP0    SUBSTR$,,AUTO

     1311    17615    1          TABLE$ = ADDR (TABLE) ;

  17615 22 000222   200470 630500                    EPPR0   TABLE,,AUTO
        22 000223   200107 450500                    STP0    TABLE$,,AUTO

     1312    17616    1          ZERO$ = ADDR (ZERO) ;

  17616 22 000224   200520 630500                    EPPR0   ZERO,,AUTO
        22 000225   200114 450500                    STP0    ZERO$,,AUTO

     1313    17617    1          ID7_TIMES_2$ = ADDR(ID7_TIMES_2);

  17617 22 000226   200410 630500                    EPPR0   ID7_TIMES_2,,AUTO
        22 000227   200116 450500                    STP0    ID7_TIMES_2$,,AUTO

     1314    17618    1          ID7_DIVIDE_2$ = ADDR(ID7_DIVIDE_2);

  17618 22 000230   200420 630500                    EPPR0   ID7_DIVIDE_2,,AUTO
        22 000231   200117 450500                    STP0    ID7_DIVIDE_2$,,AUTO

     1315    17619    1          ID6_DIVIDE_2$ = ADDR(ID6_DIVIDE_2);

  17619 22 000232   200430 630500                    EPPR0   ID6_DIVIDE_2,,AUTO
        22 000233   200120 450500                    STP0    ID6_DIVIDE_2$,,AUTO

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:243  
     1316    17620    1          PLUS_ONE$ = ADDR(PLUS_ONE);

  17620 22 000234   200530 630500                    EPPR0   PLUS_ONE,,AUTO
        22 000235   200122 450500                    STP0    PLUS_ONE$,,AUTO

     1317    17621    1          SUB_ONE$ = ADDR(SUB_ONE);

  17621 22 000236   200540 630500                    EPPR0   SUB_ONE,,AUTO
        22 000237   200123 450500                    STP0    SUB_ONE$,,AUTO

     1318    17622    1          END_IF$ = ADDR(NIL);

  17622 22 000240   000005 236000 23                 LDQ     5
        22 000241   200040 756100                    STQ     END_IF$,,AUTO

     1319    17623    1          OVERFLOW = %FALSE;

  17623 22 000242   200076 450100                    STZ     OVERFLOW,,AUTO

     1320    17624
     1321    17625               %INIT_LX_ETT_ITEM (@POINTER = ASCBIN$, @TYPE = %TYI) ;

  17627 22 000243   000004 220003                    LDX0    4,DU
        22 000244   400000 740100                    STX0    0,,PR4

  17628 22 000245   000000 221003                    LDX1    0,DU
        22 000246   200025 470500                    LDP0    ASCBIN$,,AUTO
        22 000247   000000 441100                    SXL1    0,,PR0

  17629 22 000250   000001 235007                    LDA     1,DL
        22 000251   200025 470500                    LDP0    ASCBIN$,,AUTO
        22 000252   000004 755100                    STA     4,,PR0

  17630 22 000253   000005 236000 23                 LDQ     5
        22 000254   200025 470500                    LDP0    ASCBIN$,,AUTO
        22 000255   000007 756100                    STQ     7,,PR0

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:244  
  17631 22 000256   200025 470500                    LDP0    ASCBIN$,,AUTO
        22 000257   000001 756100                    STQ     1,,PR0

  17632 22 000260   000005 236000 23                 LDQ     5
        22 000261   200025 470500                    LDP0    ASCBIN$,,AUTO
        22 000262   000002 756100                    STQ     2,,PR0

  17634 22 000263   000133 236000 xsym               LDQ     COMCOM+91
        22 000264   200025 470500                    LDP0    ASCBIN$,,AUTO
        22 000265   000005 756100                    STQ     5,,PR0

  17635 22 000266   000134 236000 xsym               LDQ     COMCOM+92
        22 000267   200025 470500                    LDP0    ASCBIN$,,AUTO
        22 000270   000006 756100                    STQ     6,,PR0

     1322    17647               %INIT_LX_ETT_ITEM (@POINTER = TABLE$ , @TYPE = %TYA) ;

  17649 22 000271   200107 470500                    LDP0    TABLE$,,AUTO
        22 000272   000000 740100                    STX0    0,,PR0

  17650 22 000273   200107 470500                    LDP0    TABLE$,,AUTO
        22 000274   000000 441100                    SXL1    0,,PR0

  17651 22 000275   000010 236007                    LDQ     8,DL
        22 000276   200107 470500                    LDP0    TABLE$,,AUTO
        22 000277   000004 756100                    STQ     4,,PR0

  17652 22 000300   000005 236000 23                 LDQ     5
        22 000301   200107 470500                    LDP0    TABLE$,,AUTO
        22 000302   000007 756100                    STQ     7,,PR0

  17653 22 000303   200107 470500                    LDP0    TABLE$,,AUTO
        22 000304   000001 756100                    STQ     1,,PR0

  17654 22 000305   000005 236000 23                 LDQ     5
        22 000306   200107 470500                    LDP0    TABLE$,,AUTO
        22 000307   000002 756100                    STQ     2,,PR0
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:245  

  17656 22 000310   000133 236000 xsym               LDQ     COMCOM+91
        22 000311   200107 470500                    LDP0    TABLE$,,AUTO
        22 000312   000005 756100                    STQ     5,,PR0

  17657 22 000313   000134 236000 xsym               LDQ     COMCOM+92
        22 000314   200107 470500                    LDP0    TABLE$,,AUTO
        22 000315   000006 756100                    STQ     6,,PR0

     1323    17669    1          CALL Z8AH$NEW_DNT (' ', 1, DNT$) ;

  17669 22 000316   000010 630400 23                 EPPR0   8
        22 000317   000000 631400 23                 EPPR1   0
        22 000320   000000 701000 xent               TSX1    Z8AH$NEW_DNT
        22 000321   000000 011000                    NOP     0

     1324    17670               %NEW_CONST (@ST$ = ST$,
     1325    17671                           @DNT$ = DNT$,
     1326    17672                           @TYPE = %TYA,
     1327    17673                           @ALL = TRUE) ;

  17677 22 000322   000002 236000 6                  LDQ     ST_+2
        22 000323   000013 036007                    ADLQ    11,DL
        22 000324   000003 116000 6                  CMPQ    ST_+3
        22 000325   000336 604000 22                 TMI     s:17679

  17678 22 000326   000014 236000 23                 LDQ     12
        22 000327   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 000330   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 000331   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 000332   200653 630500                    EPPR0   ID2_ST$+2,,AUTO
        22 000333   000013 631400 23                 EPPR1   11
        22 000334   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 000335   000000 011000                    NOP     0

  17679 22 000336   000002 236000 6                  LDQ     ST_+2
        22 000337   000022 736000                    QLS     18
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:246  
        22 000340   000001 036000 6                  ADLQ    ST_+1
        22 000341   000000 756000 5                  STQ     ST$

  17680 22 000342   000013 236007                    LDQ     11,DL
        22 000343   000002 056000 6                  ASQ     ST_+2

  17683 22 000344   000767 220003                    LDX0    503,DU
        22 000345   000000 470400 5                  LDP0    ST$
        22 000346   000000 740100                    STX0    0,,PR0

  17684 22 000347   000000 470400 5                  LDP0    ST$
        22 000350   001000 236007                    LDQ     512,DL
        22 000351   000000 552110                    STBQ    0,'10'O,PR0

  17685 22 000352   000000 470400 5                  LDP0    ST$
        22 000353   000126 236000 xsym               LDQ     O1COM+86
        22 000354   000000 552104                    STBQ    0,'04'O,PR0

  17686 22 000355   000010 221003                    LDX1    8,DU
        22 000356   000000 470400 5                  LDP0    ST$
        22 000357   000002 741100                    STX1    2,,PR0

  17687 22 000360   000003 450100                    STZ     3,,PR0

  17688 22 000361   000005 236000 23                 LDQ     5
        22 000362   000004 756100                    STQ     4,,PR0

  17689 22 000363   000005 236000 23                 LDQ     5
        22 000364   000005 756100                    STQ     5,,PR0

  17690 22 000365   000000 236000 17                 LDQ     DNT$
        22 000366   000006 756100                    STQ     6,,PR0

  17701 22 000367   040000 236003                    LDQ     16384,DU
        22 000370   000003 256100                    ORSQ    3,,PR0

     1328    17714               %INIT_LX_TERMINAL (@POINTER = SPACE_LX$, @ST$ = ST$, @DNT$ = DNT$, @SYMBOL =
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:247  
             17714                   %RSV_WRD_SPACES) ;

  17716 22 000371   000000 222003                    LDX2    0,DU
        22 000372   200105 471500                    LDP1    SPACE_LX$,,AUTO
        22 000373   100000 742100                    STX2    0,,PR1

  17717 22 000374   000000 223003                    LDX3    0,DU
        22 000375   200105 470500                    LDP0    SPACE_LX$,,AUTO
        22 000376   000000 443100                    SXL3    0,,PR0

  17721 22 000377   000015 235007                    LDA     13,DL
        22 000400   200105 470500                    LDP0    SPACE_LX$,,AUTO
        22 000401   000004 755100                    STA     4,,PR0

  17723 22 000402   000005 236000 23                 LDQ     5
        22 000403   200105 470500                    LDP0    SPACE_LX$,,AUTO
        22 000404   000007 756100                    STQ     7,,PR0

  17725 22 000405   000000 236000 5                  LDQ     ST$
        22 000406   200105 470500                    LDP0    SPACE_LX$,,AUTO
        22 000407   000001 756100                    STQ     1,,PR0

  17726 22 000410   000650 235007                    LDA     424,DL
        22 000411   200105 470500                    LDP0    SPACE_LX$,,AUTO
        22 000412   000003 755100                    STA     3,,PR0

  17727 22 000413   000000 236000 17                 LDQ     DNT$
        22 000414   200105 470500                    LDP0    SPACE_LX$,,AUTO
        22 000415   000002 756100                    STQ     2,,PR0

  17728 22 000416   000133 235000 xsym               LDA     COMCOM+91
        22 000417   200105 470500                    LDP0    SPACE_LX$,,AUTO
        22 000420   000005 755100                    STA     5,,PR0

  17729 22 000421   000134 235000 xsym               LDA     COMCOM+92
        22 000422   200105 470500                    LDP0    SPACE_LX$,,AUTO
        22 000423   000006 755100                    STA     6,,PR0
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:248  

     1329    17732    1          SPACE_LX$ -> LX_TERMINAL.B.ALL = TRUE ;

  17732 22 000424   200105 470500                    LDP0    SPACE_LX$,,AUTO
        22 000425   040000 236007                    LDQ     16384,DL
        22 000426   000000 256100                    ORSQ    0,,PR0

     1330    17733               %INIT_LX_ETT_ITEM (@POINTER = SUBSTR$, @TYPE = %TYA) ;

  17735 22 000427   000004 224003                    LDX4    4,DU
        22 000430   200106 470500                    LDP0    SUBSTR$,,AUTO
        22 000431   000000 744100                    STX4    0,,PR0

  17736 22 000432   200106 470500                    LDP0    SUBSTR$,,AUTO
        22 000433   000000 443100                    SXL3    0,,PR0

  17737 22 000434   000010 235007                    LDA     8,DL
        22 000435   200106 470500                    LDP0    SUBSTR$,,AUTO
        22 000436   000004 755100                    STA     4,,PR0

  17738 22 000437   000005 236000 23                 LDQ     5
        22 000440   200106 470500                    LDP0    SUBSTR$,,AUTO
        22 000441   000007 756100                    STQ     7,,PR0

  17739 22 000442   200106 470500                    LDP0    SUBSTR$,,AUTO
        22 000443   000001 756100                    STQ     1,,PR0

  17740 22 000444   000005 236000 23                 LDQ     5
        22 000445   200106 470500                    LDP0    SUBSTR$,,AUTO
        22 000446   000002 756100                    STQ     2,,PR0

  17742 22 000447   000133 236000 xsym               LDQ     COMCOM+91
        22 000450   200106 470500                    LDP0    SUBSTR$,,AUTO
        22 000451   000005 756100                    STQ     5,,PR0

  17743 22 000452   000134 236000 xsym               LDQ     COMCOM+92
        22 000453   200106 470500                    LDP0    SUBSTR$,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:249  
        22 000454   000006 756100                    STQ     6,,PR0

     1331    17755
     1332    17756    1          CALL Z8AT$CREATE_TEMP_WITH_BASE (%SCALAR, TABLE_ETT$) ;

  17756 22 000455   200111 630500                    EPPR0   TABLE_ETT$,,AUTO
        22 000456   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 000457   000017 236000 23                 LDQ     15
        22 000460   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 000461   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 000462   000015 631400 23                 EPPR1   13
        22 000463   000000 701000 xent               TSX1    Z8AT$CREATE_TEMP_WITH_BASE
        22 000464   000000 011000                    NOP     0

     1333    17757    1          TABLE_ETT$ -> ETT.LOP -> ST.TYPE = %TYA ;

  17757 22 000465   200111 470500                    LDP0    TABLE_ETT$,,AUTO
        22 000466   000001 471500                    LDP1    1,,PR0
        22 000467   000010 220003                    LDX0    8,DU
        22 000470   100002 740100                    STX0    2,,PR1

     1334    17758    1          TABLE_ETT$ -> ETT.LOP -> ST.ADSC.N = 512 ;

  17758 22 000471   200111 470500                    LDP0    TABLE_ETT$,,AUTO
        22 000472   000001 471500                    LDP1    1,,PR0
        22 000473   001000 236007                    LDQ     512,DL
        22 000474   100001 752103                    STCQ    1,'03'O,PR1

     1335    17759    1          TABLE$ -> LX_ETT_ITEM.ETT$ = TABLE_ETT$ ;

  17759 22 000475   200111 236100                    LDQ     TABLE_ETT$,,AUTO
        22 000476   200107 470500                    LDP0    TABLE$,,AUTO
        22 000477   000001 756100                    STQ     1,,PR0

     1336    17760
     1337    17761    1          CALL Z8AC$LX_ETT_ITEM_TYI_CONST (1, ONE$) ;

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:250  
  17761 22 000500   200074 630500                    EPPR0   ONE$,,AUTO
        22 000501   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 000502   000011 236000 23                 LDQ     9
        22 000503   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 000504   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 000505   000015 631400 23                 EPPR1   13
        22 000506   000000 701000 xent               TSX1    Z8AC$LX_ETT_ITEM_TYI_CONST
        22 000507   000000 011000                    NOP     0

     1338    17762    1          CALL Z8AC$LX_ETT_ITEM_TYI_CONST (0, ZERO$) ;

  17762 22 000510   200114 630500                    EPPR0   ZERO$,,AUTO
        22 000511   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 000512   000021 236000 23                 LDQ     17
        22 000513   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 000514   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 000515   000015 631400 23                 EPPR1   13
        22 000516   000000 701000 xent               TSX1    Z8AC$LX_ETT_ITEM_TYI_CONST
        22 000517   000000 011000                    NOP     0

     1339    17763    1          CALL Z8AC$LX_ETT_ITEM_TYI_CONST (2, TWO$) ;

  17763 22 000520   200115 630500                    EPPR0   TWO$,,AUTO
        22 000521   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 000522   000023 236000 23                 LDQ     19
        22 000523   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 000524   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 000525   000015 631400 23                 EPPR1   13
        22 000526   000000 701000 xent               TSX1    Z8AC$LX_ETT_ITEM_TYI_CONST
        22 000527   000000 011000                    NOP     0

     1340    17764
     1341    17765    1          IF ON_OVERFLOW$ ~= ADDR(NIL)   OR

  17765 22 000530   200004 470500                    LDP0    @ON_OVERFLOW$,,AUTO
        22 000531   000000 236100                    LDQ     0,,PR0
        22 000532   000005 116000 23                 CMPQ    5
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:251  
        22 000533   000540 601000 22                 TNZ     s:17768
        22 000534   200005 471500                    LDP1    @NOT_ON_OVERFLOW$,,AUTO
        22 000535   100000 236100                    LDQ     0,,PR1
        22 000536   000005 116000 23                 CMPQ    5
        22 000537   000543 600000 22                 TZE     s:17772

     1342    17766    1                NOT_ON_OVERFLOW$ ~= ADDR(NIL)   THEN
     1343    17767    2            DO;

     1344    17768    2              OVERFLOW = %TRUE;

  17768 22 000540   400000 236003                    LDQ     -131072,DU
        22 000541   200076 756100                    STQ     OVERFLOW,,AUTO

     1345    17769    2              OPTIMIZABLE = %FALSE ;

  17769 22 000542   200075 450100                    STZ     OPTIMIZABLE,,AUTO

     1346    17770    2            END;

     1347    17771
     1348    17772    1          CALL PREPARE_ID1 (IDENT$, ID1$) ;

  17772 22 000543   200044 631500                    EPPR1   ID1$,,AUTO
        22 000544   200552 451500                    STP1    @COUNT$+1,,AUTO
        22 000545   200056 633500                    EPPR3   IDENT$,,AUTO
        22 000546   200551 453500                    STP3    SUB_ONE+9,,AUTO
        22 000547   005327 701000 22                 TSX1    PREPARE_ID1
        22 000550   000000 011000                    NOP     0

     1349    17773
     1350    17774        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:252  
     1351    17775        /*V* PASS 3a -- Generate the ILL to do the UNSTRING (optimizable)
     1352    17776
     1353    17777             UNSTRING id1 INTO id4a, id4b, ...
     1354    17778
     1355    17779                       MVAN                    MVAN       . . .
     1356    17780                      /    \                  /    \
     1357    17781                    id4a   id1             id4b    OFF
     1358    17782                                                  /   \
     1359    17783                                                id1  length_id4a
     1360    17784        */
     1361    17785
     1362    17786    2          IF OPTIMIZABLE THEN DO ;

  17786 22 000551   200075 234100                    SZN     OPTIMIZABLE,,AUTO
        22 000552   000626 605000 22                 TPL     s:17822

     1363    17787
     1364    17788    2            CURRENT_OFFSET = 0 ;

  17788 22 000553   200032 450100                    STZ     CURRENT_OFFSET,,AUTO

     1365    17789    2            ID1_LENGTH = LENGTH_ID1$

  17789 22 000554   200065 470500                    LDP0    LENGTH_ID1$,,AUTO
        22 000555   000001 471500                    LDP1    1,,PR0
        22 000556   100001 473500                    LDP3    1,,PR1
        22 000557   300010 235100                    LDA     8,,PR3
        22 000560   200064 755100                    STA     ID1_LENGTH,,AUTO

     1366    17790    2                      -> LX_ETT_ITEM.ETT$
     1367    17791    2                      -> ETT.LOP
     1368    17792    2                      -> CONST.CONSTI.WORD1 ;
     1369    17793    2            INTO_LIST$ = UNSTRING$ -> UNSTRING_STMT.INTO_LIST$ -> LX_LIST.HEAD$ ;

  17793 22 000561   200003 474500                    LDP4    @UNSTRING$,,AUTO
        22 000562   400000 475500                    LDP5    0,,PR4
        22 000563   500004 476500                    LDP6    4,,PR5
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:253  
        22 000564   600004 236100                    LDQ     4,,PR6
        22 000565   200061 756100                    STQ     INTO_LIST$,,AUTO

     1370    17794
     1371    17795    3            DO WHILE (INTO_LIST$ ~= ADDR(NIL)) ;

  17795 22 000566   000623 710000 22                 TRA     s:17813

     1372    17796
     1373    17797    3              INTO$ = INTO_LIST$ -> LX_LIST.HEAD$ ;

  17797 22 000567   200061 470500                    LDP0    INTO_LIST$,,AUTO
        22 000570   000004 236100                    LDQ     4,,PR0
        22 000571   200057 756100                    STQ     INTO$,,AUTO

     1374    17798    3              CALL PREPARE_ID4 (INTO$, ID4$) ;

  17798 22 000572   200050 631500                    EPPR1   ID4$,,AUTO
        22 000573   200552 451500                    STP1    @COUNT$+1,,AUTO
        22 000574   200057 633500                    EPPR3   INTO$,,AUTO
        22 000575   200551 453500                    STP3    SUB_ONE+9,,AUTO
        22 000576   005662 701000 22                 TSX1    PREPARE_ID4
        22 000577   000000 011000                    NOP     0

     1375    17799
     1376    17800    4              IF CURRENT_OFFSET < ID1_LENGTH THEN DO ;

  17800 22 000600   200032 236100                    LDQ     CURRENT_OFFSET,,AUTO
        22 000601   200064 116100                    CMPQ    ID1_LENGTH,,AUTO
        22 000602   000620 605000 22                 TPL     s:17811

     1377    17801
     1378    17802    4                CALL MOVE (ID1$, ID4$,

  17802 22 000603   200067 470500                    LDP0    LENGTH_ID4$,,AUTO
        22 000604   000001 471500                    LDP1    1,,PR0
        22 000605   100001 473500                    LDP3    1,,PR1
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:254  
        22 000606   200032 634500                    EPPR4   CURRENT_OFFSET,,AUTO
        22 000607   200554 454500                    STP4    BEGAIN_INDEX$+1,,AUTO
        22 000610   300010 631500                    EPPR1   8,,PR3
        22 000611   200553 451500                    STP1    @DELIMS$+1,,AUTO
        22 000612   200050 633500                    EPPR3   ID4$,,AUTO
        22 000613   200552 453500                    STP3    @COUNT$+1,,AUTO
        22 000614   200044 635500                    EPPR5   ID1$,,AUTO
        22 000615   200551 455500                    STP5    SUB_ONE+9,,AUTO
        22 000616   004321 701000 22                 TSX1    MOVE
        22 000617   000000 011000                    NOP     0

     1379    17803    4                           LENGTH_ID4$
     1380    17804    4                           -> LX_ETT_ITEM.ETT$
     1381    17805    4                           -> ETT.LOP
     1382    17806    4                           -> CONST.CONSTI,
     1383    17807    4                           CURRENT_OFFSET) ;
     1384    17808
     1385    17809    4              END ; /* Current Offset < Length(id1) */

     1386    17810
     1387    17811    3              INTO_LIST$ = INTO_LIST$ -> LX_LIST.LINK ;

  17811 22 000620   200061 470500                    LDP0    INTO_LIST$,,AUTO
        22 000621   000007 236100                    LDQ     7,,PR0
        22 000622   200061 756100                    STQ     INTO_LIST$,,AUTO

     1388    17812
     1389    17813    3            END ; /* While INTO_LIST$ <> Nil */

  17813 22 000623   000005 116000 23                 CMPQ    5
        22 000624   000567 601000 22                 TNZ     s:17797

     1390    17814
     1391    17815    2          END ; /* Optimizable */

  17815 22 000625   004031 710000 22                 TRA     s:23486

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:255  
     1392    17816
     1393    17817    2          ELSE DO ;

     1394    17818
     1395    17819        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:256  
     1396    17820        /*V* PASS 3b -- Generate the ILL for UNSTRING (non-optimizable) */
     1397    17821
     1398    17822    2            CALL PREPARE_ID7 (POINTER$, ID7$) ;

  17822 22 000626   200054 630500                    EPPR0   ID7$,,AUTO
        22 000627   200552 450500                    STP0    @COUNT$+1,,AUTO
        22 000630   200101 631500                    EPPR1   POINTER$,,AUTO
        22 000631   200551 451500                    STP1    SUB_ONE+9,,AUTO
        22 000632   006006 701000 22                 TSX1    PREPARE_ID7
        22 000633   000000 011000                    NOP     0

     1399    17823    2            CALL PREPARE_ID8 (TALLYING$, ID8$) ;

  17823 22 000634   200055 630500                    EPPR0   ID8$,,AUTO
        22 000635   200552 450500                    STP0    @COUNT$+1,,AUTO
        22 000636   200113 631500                    EPPR1   TALLYING$,,AUTO
        22 000637   200551 451500                    STP1    SUB_ONE+9,,AUTO
        22 000640   006074 701000 22                 TSX1    PREPARE_ID8
        22 000641   000000 011000                    NOP     0

     1400    17824
     1401    17825    2            CALL Z8AT$CREATE_TEMPORARY (%PARA, OVERFLOW_LABEL$) ;

  17825 22 000642   200077 630500                    EPPR0   OVERFLOW_LABEL$,,AUTO
        22 000643   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 000644   000025 236000 23                 LDQ     21
        22 000645   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 000646   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 000647   000015 631400 23                 EPPR1   13
        22 000650   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        22 000651   000000 011000                    NOP     0

     1402    17826    2            CALL Z8AT$CREATE_TEMPORARY( %PARA, NOT_OVERFLOW_LABEL$ );

  17826 22 000652   200073 630500                    EPPR0   NOT_OVERFLOW_LABEL$,,AUTO
        22 000653   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 000654   000025 236000 23                 LDQ     21
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:257  
        22 000655   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 000656   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 000657   000015 631400 23                 EPPR1   13
        22 000660   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        22 000661   000000 011000                    NOP     0

     1403    17827    2            CALL Z8AT$CREATE_TEMPORARY (%PARA, END_UNSTRING$) ;

  17827 22 000662   200043 630500                    EPPR0   END_UNSTRING$,,AUTO
        22 000663   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 000664   000025 236000 23                 LDQ     21
        22 000665   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 000666   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 000667   000015 631400 23                 EPPR1   13
        22 000670   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        22 000671   000000 011000                    NOP     0

     1404    17828    2            EXIT_INTO_LOOP$ = ADDR(NIL) ;

  17828 22 000672   000005 236000 23                 LDQ     5
        22 000673   200042 756100                    STQ     EXIT_INTO_LOOP$,,AUTO

     1405    17829    2            LOW_VALUE_DELIM = FALSE ;                          /*#30498*/

  17829 22 000674   200070 450100                    STZ     LOW_VALUE_DELIM,,AUTO

     1406    17830
     1407    17831                 %FISH( TRIAD = ID1$ -> LX_ETT_ITEM.ETT$,
     1408    17832                        RTN   = ID1_ST$ );

  17834 22 000675   200044 470500                    LDP0    ID1$,,AUTO
        22 000676   000001 236100                    LDQ     1,,PR0
        22 000677   200045 756100                    STQ     ID1_ST$,,AUTO

  17835 22 000700   200045 471500                    LDP1    ID1_ST$,,AUTO
        22 000701   100000 220100                    LDX0    0,,PR1
        22 000702   000751 100003                    CMPX0   489,DU
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:258  
        22 000703   000713 603000 22                 TRC     s:17841

  17836 22 000704   200045 470500                    LDP0    ID1_ST$,,AUTO
        22 000705   000001 236100                    LDQ     1,,PR0
        22 000706   200045 756100                    STQ     ID1_ST$,,AUTO

  17837 22 000707   200045 470500                    LDP0    ID1_ST$,,AUTO
        22 000710   000000 220100                    LDX0    0,,PR0
        22 000711   000751 100003                    CMPX0   489,DU
        22 000712   000704 602000 22                 TNC     s:17836

     1409    17840
     1410    17841    2            IF ID1_ST$ -> SCALAR.B.KANJI    THEN

  17841 22 000713   200045 470500                    LDP0    ID1_ST$,,AUTO
        22 000714   000003 236100                    LDQ     3,,PR0
        22 000715   001000 316007                    CANQ    512,DL
        22 000716   001006 600000 22                 TZE     s:17893

     1411    17842    3              DO;

     1412    17843
     1413    17844                     %INIT_BINARY_OP( @POINTER = ID7_TIMES_2$,
     1414    17845                                      @OP = %OP_STAR,
     1415    17846                                      @LOP$ = ID7$,
     1416    17847                                      @ROP$ = TWO$ );

  17849 22 000717   000005 220003                    LDX0    5,DU
        22 000720   200116 471500                    LDP1    ID7_TIMES_2$,,AUTO
        22 000721   100000 740100                    STX0    0,,PR1

  17850 22 000722   000000 221003                    LDX1    0,DU
        22 000723   100000 441100                    SXL1    0,,PR1

  17857 22 000724   000133 235000 xsym               LDA     COMCOM+91
        22 000725   100005 755100                    STA     5,,PR1

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:259  
  17858 22 000726   000134 236000 xsym               LDQ     COMCOM+92
        22 000727   100006 756100                    STQ     6,,PR1

  17859 22 000730   200115 236100                    LDQ     TWO$,,AUTO
        22 000731   100002 756100                    STQ     2,,PR1

  17860 22 000732   200054 236100                    LDQ     ID7$,,AUTO
        22 000733   100001 756100                    STQ     1,,PR1

  17861 22 000734   000022 235007                    LDA     18,DL
        22 000735   100003 755100                    STA     3,,PR1

  17862 22 000736   000005 236000 23                 LDQ     5
        22 000737   100007 756100                    STQ     7,,PR1

     1417    17865
     1418    17866                     %INIT_BINARY_OP( @POINTER = SUB_ONE$,
     1419    17867                                      @OP = %OP_BINARY_MINUS,
     1420    17868                                      @LOP$ = ID7_TIMES_2$,
     1421    17869                                      @ROP$ = ONE$ );

  17871 22 000740   200123 473500                    LDP3    SUB_ONE$,,AUTO
        22 000741   300000 740100                    STX0    0,,PR3

  17872 22 000742   200123 473500                    LDP3    SUB_ONE$,,AUTO
        22 000743   300000 441100                    SXL1    0,,PR3

  17879 22 000744   000133 236000 xsym               LDQ     COMCOM+91
        22 000745   200123 473500                    LDP3    SUB_ONE$,,AUTO
        22 000746   300005 756100                    STQ     5,,PR3

  17880 22 000747   000134 236000 xsym               LDQ     COMCOM+92
        22 000750   200123 473500                    LDP3    SUB_ONE$,,AUTO
        22 000751   300006 756100                    STQ     6,,PR3

  17881 22 000752   200074 236100                    LDQ     ONE$,,AUTO
        22 000753   200123 473500                    LDP3    SUB_ONE$,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:260  
        22 000754   300002 756100                    STQ     2,,PR3

  17882 22 000755   200116 236100                    LDQ     ID7_TIMES_2$,,AUTO
        22 000756   200123 473500                    LDP3    SUB_ONE$,,AUTO
        22 000757   300001 756100                    STQ     1,,PR3

  17883 22 000760   000021 235007                    LDA     17,DL
        22 000761   200123 473500                    LDP3    SUB_ONE$,,AUTO
        22 000762   300003 755100                    STA     3,,PR3

  17884 22 000763   000005 236000 23                 LDQ     5
        22 000764   200123 473500                    LDP3    SUB_ONE$,,AUTO
        22 000765   300007 756100                    STQ     7,,PR3

     1422    17887
     1423    17888    3                CALL Z8E5$MATH_PACK( SUB_ONE$, SUB_ONE$ );

  17888 22 000766   200123 633500                    EPPR3   SUB_ONE$,,AUTO
        22 000767   200653 453500                    STP3    ID2_ST$+2,,AUTO
        22 000770   200123 634500                    EPPR4   SUB_ONE$,,AUTO
        22 000771   200652 454500                    STP4    ID2_ST$+1,,AUTO
        22 000772   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 000773   000015 631400 23                 EPPR1   13
        22 000774   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        22 000775   000000 011000                    NOP     0

     1424    17889    3                CALL Z8E7$MOVE( ID7$, SUB_ONE$ );

  17889 22 000776   200123 630500                    EPPR0   SUB_ONE$,,AUTO
        22 000777   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 001000   200054 631500                    EPPR1   ID7$,,AUTO
        22 001001   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 001002   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 001003   000015 631400 23                 EPPR1   13
        22 001004   000000 701000 xent               TSX1    Z8E7$MOVE
        22 001005   000000 011000                    NOP     0

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:261  
     1425    17890
     1426    17891    3              END;

     1427    17892
     1428    17893    3            IF POINTER THEN DO ;

  17893 22 001006   200100 234100                    SZN     POINTER,,AUTO
        22 001007   001114 605000 22                 TPL     s:17953

     1429    17894
     1430    17895                   /* IF ID7 < 1 THEN GO TO OVERFLOW */
     1431    17896
     1432    17897                   %INIT_BINARY_OP (@POINTER = COMPARISON$,
     1433    17898                                    @LOP$    = ID7$,
     1434    17899                                    @OP      = %OP_LESS_THAN_OR_EQUAL,
     1435    17900                                    @ROP$    = ZERO$,
     1436    17901                                    @LINE    = "ID7$ -> LX_ETT_ITEM.LINE",
     1437    17902                                    @COLUMN  = "ID7$ -> LX_ETT_ITEM.COLUMN") ;

  17904 22 001010   000005 220003                    LDX0    5,DU
        22 001011   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 001012   000000 740100                    STX0    0,,PR0

  17905 22 001013   000000 221003                    LDX1    0,DU
        22 001014   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 001015   000000 441100                    SXL1    0,,PR0

  17912 22 001016   200054 470500                    LDP0    ID7$,,AUTO
        22 001017   200026 471500                    LDP1    COMPARISON$,,AUTO
        22 001020   000005 235100                    LDA     5,,PR0
        22 001021   100005 755100                    STA     5,,PR1

  17913 22 001022   200054 470500                    LDP0    ID7$,,AUTO
        22 001023   200026 471500                    LDP1    COMPARISON$,,AUTO
        22 001024   000006 235100                    LDA     6,,PR0
        22 001025   100006 755100                    STA     6,,PR1

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:262  
  17914 22 001026   200114 236100                    LDQ     ZERO$,,AUTO
        22 001027   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 001030   000002 756100                    STQ     2,,PR0

  17915 22 001031   200054 236100                    LDQ     ID7$,,AUTO
        22 001032   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 001033   000001 756100                    STQ     1,,PR0

  17916 22 001034   000032 235007                    LDA     26,DL
        22 001035   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 001036   000003 755100                    STA     3,,PR0

  17917 22 001037   000005 236000 23                 LDQ     5
        22 001040   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 001041   000007 756100                    STQ     7,,PR0

     1438    17920
     1439    17921    3              CALL Z8EK$BRANCH_TRUE (OVERFLOW_LABEL$, COMPARISON$) ;

  17921 22 001042   200026 630500                    EPPR0   COMPARISON$,,AUTO
        22 001043   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 001044   200077 631500                    EPPR1   OVERFLOW_LABEL$,,AUTO
        22 001045   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 001046   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 001047   000015 631400 23                 EPPR1   13
        22 001050   000000 701000 xent               TSX1    Z8EK$BRANCH_TRUE
        22 001051   000000 011000                    NOP     0

     1440    17922
     1441    17923                   /* IF ID7 > LENGTH (ID1) THEN GOTO OVERFLOW */
     1442    17924
     1443    17925                   %INIT_BINARY_OP (@POINTER = COMPARISON$,
     1444    17926                                    @LOP$    = ID7$,
     1445    17927                                    @OP      = %OP_GREATER_THAN,
     1446    17928                                    @ROP$     = LENGTH_ID1$,
     1447    17929                                    @LINE    = "ID7$ -> LX_ETT_ITEM.LINE",
     1448    17930                                    @COLUMN  = "ID7$ -> LX_ETT_ITEM.COLUMN") ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:263  

  17932 22 001052   000005 220003                    LDX0    5,DU
        22 001053   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 001054   000000 740100                    STX0    0,,PR0

  17933 22 001055   000000 221003                    LDX1    0,DU
        22 001056   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 001057   000000 441100                    SXL1    0,,PR0

  17940 22 001060   200054 470500                    LDP0    ID7$,,AUTO
        22 001061   200026 471500                    LDP1    COMPARISON$,,AUTO
        22 001062   000005 235100                    LDA     5,,PR0
        22 001063   100005 755100                    STA     5,,PR1

  17941 22 001064   200054 470500                    LDP0    ID7$,,AUTO
        22 001065   200026 471500                    LDP1    COMPARISON$,,AUTO
        22 001066   000006 235100                    LDA     6,,PR0
        22 001067   100006 755100                    STA     6,,PR1

  17942 22 001070   200065 236100                    LDQ     LENGTH_ID1$,,AUTO
        22 001071   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 001072   000002 756100                    STQ     2,,PR0

  17943 22 001073   200054 236100                    LDQ     ID7$,,AUTO
        22 001074   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 001075   000001 756100                    STQ     1,,PR0

  17944 22 001076   000030 235007                    LDA     24,DL
        22 001077   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 001100   000003 755100                    STA     3,,PR0

  17945 22 001101   000005 236000 23                 LDQ     5
        22 001102   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 001103   000007 756100                    STQ     7,,PR0

     1449    17948
     1450    17949    3              CALL Z8EK$BRANCH_TRUE (OVERFLOW_LABEL$, COMPARISON$) ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:264  

  17949 22 001104   200026 630500                    EPPR0   COMPARISON$,,AUTO
        22 001105   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 001106   200077 631500                    EPPR1   OVERFLOW_LABEL$,,AUTO
        22 001107   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 001110   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 001111   000015 631400 23                 EPPR1   13
        22 001112   000000 701000 xent               TSX1    Z8EK$BRANCH_TRUE
        22 001113   000000 011000                    NOP     0

     1451    17950
     1452    17951    3            END ; /* POINTER SPECIFIED */

     1453    17952
     1454    17953    2            IF UNSTRING$ -> UNSTRING_STMT.DELIM_LIST$ = ADDR(NIL) THEN

  17953 22 001114   200003 470500                    LDP0    @UNSTRING$,,AUTO
        22 001115   000000 471500                    LDP1    0,,PR0
        22 001116   100003 236100                    LDQ     3,,PR1
        22 001117   000005 116000 23                 CMPQ    5
        22 001120   001124 601000 22                 TNZ     s:17956

     1455    17954    2              DELIMS$ = ADDR(NIL);

  17954 22 001121   000005 236000 23                 LDQ     5
        22 001122   200036 756100                    STQ     DELIMS$,,AUTO
        22 001123   001127 710000 22                 TRA     s:17957

     1456    17955    2            ELSE
     1457    17956    2              DELIMS$ = UNSTRING$ -> UNSTRING_STMT.DELIM_LIST$ -> LX_LIST.HEAD$;

  17956 22 001124   100003 473500                    LDP3    3,,PR1
        22 001125   300004 236100                    LDQ     4,,PR3
        22 001126   200036 756100                    STQ     DELIMS$,,AUTO

     1458    17957    2            DELIMITED = DELIMS$ ~= ADDR(NIL) ;

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:265  
  17957 22 001127   400000 220003                    LDX0    -131072,DU
        22 001130   000005 116000 23                 CMPQ    5
        22 001131   001133 601000 22                 TNZ     s:17957+4
        22 001132   000000 220003                    LDX0    0,DU
        22 001133   000000 636010                    EAQ     0,X0
        22 001134   200033 756100                    STQ     DELIMITED,,AUTO

     1459    17958
     1460    17959    3            IF DELIMITED  AND  NOT ID1_ST$ -> SCALAR.B.KANJI  THEN DO ;

  17959 22 001135   200033 234100                    SZN     DELIMITED,,AUTO
        22 001136   001576 605000 22                 TPL     s:18573
        22 001137   200045 471500                    LDP1    ID1_ST$,,AUTO
        22 001140   100003 236100                    LDQ     3,,PR1
        22 001141   001000 316007                    CANQ    512,DL
        22 001142   001576 601000 22                 TNZ     s:18573

     1461    17960
     1462    17961    4              IF ALL_ID2S_ARE_CONSTANT THEN DO ;

  17961 22 001143   200022 234100                    SZN     ALL_ID2S_ARE_CONSTANT,,AUTO
        22 001144   001345 605000 22                 TPL     s:18395

     1463    17962
     1464    17963                     /* Create table at compile time */
     1465    17964
     1466    17965    4                ITERATION = 129 ;

  17965 22 001145   000201 235007                    LDA     129,DL
        22 001146   000000 755000 0                  STA     ITERATION

     1467    17966                     %RESERVE_LTS (ITEM = %LCNST, POINTER = LTS$$) ;

  18042 22 001147   000002 236000 16                 LDQ     LTS_+2
        22 001150   000000 036000 0                  ADLQ    ITERATION
        22 001151   000003 116000 16                 CMPQ    LTS_+3
        22 001152   001163 604000 22                 TMI     s:18044
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:266  

  18043 22 001153   000026 236000 23                 LDQ     22
        22 001154   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 001155   200652 633500                    EPPR3   ID2_ST$+1,,AUTO
        22 001156   200653 453500                    STP3    ID2_ST$+2,,AUTO
        22 001157   200653 630500                    EPPR0   ID2_ST$+2,,AUTO
        22 001160   000013 631400 23                 EPPR1   11
        22 001161   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 001162   000000 011000                    NOP     0

  18044 22 001163   000002 236000 16                 LDQ     LTS_+2
        22 001164   000022 736000                    QLS     18
        22 001165   000001 036000 16                 ADLQ    LTS_+1
        22 001166   200071 756100                    STQ     LTS$$,,AUTO

  18045 22 001167   000002 236000 16                 LDQ     LTS_+2
        22 001170   000000 036000 0                  ADLQ    ITERATION
        22 001171   000002 756000 16                 STQ     LTS_+2

  18046 22 001172   001106 220003                    LDX0    582,DU
        22 001173   200071 470500                    LDP0    LTS$$,,AUTO
        22 001174   000000 740100                    STX0    0,,PR0

  18048 22 001175   000000 721000 0                  LXL1    ITERATION
        22 001176   000000 441100                    SXL1    0,,PR0

     1468    18052
     1469    18053    5                DO WHILE (DELIMS$ ~= ADDR (NIL)) ;

  18053 22 001177   001240 710000 22                 TRA     s:18070

     1470    18054
     1471    18055    5                  CALL PREPARE_ID2 (DELIMS$, ID2$) ;

  18055 22 001200   200046 630500                    EPPR0   ID2$,,AUTO
        22 001201   200650 450500                    STP0    @DELIMITED$+1,,AUTO
        22 001202   200036 631500                    EPPR1   DELIMS$,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:267  
        22 001203   200647 451500                    STP1    DELIMS$$+3,,AUTO
        22 001204   005455 701000 22                 TSX1    PREPARE_ID2
        22 001205   000000 011000                    NOP     0

     1472    18056
     1473    18057    5                  CALL GET_CHAR (ID2$, ID2_CHAR) ;             /*#30498*/

  18057 22 001206   200047 630500                    EPPR0   ID2_CHAR,,AUTO
        22 001207   200552 450500                    STP0    @COUNT$+1,,AUTO
        22 001210   200046 631500                    EPPR1   ID2$,,AUTO
        22 001211   200551 451500                    STP1    SUB_ONE+9,,AUTO
        22 001212   004273 701000 22                 TSX1    GET_CHAR
        22 001213   000000 011000                    NOP     0

     1474    18058
     1475    18059    6                  IF ID2_CHAR = BITASC ('000'O) THEN DO ;      /*#30498*/

  18059 22 001214   200047 236100                    LDQ     ID2_CHAR,,AUTO
        22 001215   777000 376003                    ANQ     -512,DU
        22 001216   000000 116003                    CMPQ    0,DU
        22 001217   001227 601000 22                 TNZ     s:18065

     1476    18060    6                    SUBSTR (LTS$$ ->LCNST.CONST, 0, 1) = BITASC ('001'O) ;

  18060 22 001220   200071 470500                    LDP0    LTS$$,,AUTO
        22 001221   001000 236003                    LDQ     512,DU
        22 001222   000001 552140                    STBQ    1,'40'O,PR0

     1477    18061    6                    LOW_VALUE_DELIM = TRUE ;                   /*#30498*/

  18061 22 001223   400000 236003                    LDQ     -131072,DU
        22 001224   200070 756100                    STQ     LOW_VALUE_DELIM,,AUTO

     1478    18062    6                    ALL_LENGTH_1 = FALSE ;

  18062 22 001225   200023 450100                    STZ     ALL_LENGTH_1,,AUTO

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:268  
     1479    18063    6                  END ; /* ID-2 is LOW-VALUE */                /*#30498*/

  18063 22 001226   001235 710000 22                 TRA     s:18068

     1480    18064    5                  ELSE
     1481    18065    5                    SUBSTR (LTS$$ -> LCNST.CONST, ASCBIN (ID2_CHAR), 1)

  18065 22 001227   200047 236100                    LDQ     ID2_CHAR,,AUTO
        22 001230   000033 772000                    QRL     27
        22 001231   200071 470500                    LDP0    LTS$$,,AUTO
        22 001232   040106 100500                    MLR     fill='040'O
        22 001233   200047 000001                    ADSC9   ID2_CHAR,,AUTO           cn=0,n=1
        22 001234   000001 000001                    ADSC9   1,Q,PR0                  cn=0,n=1

     1482    18066    5                      = ID2_CHAR ;
     1483    18067
     1484    18068    5                  DELIMS$ = DELIMS$ -> LX_ITEM.LINK ;

  18068 22 001235   200036 471500                    LDP1    DELIMS$,,AUTO
        22 001236   100007 236100                    LDQ     7,,PR1
        22 001237   200036 756100                    STQ     DELIMS$,,AUTO

     1485    18069
     1486    18070    5                END ; /* WHILE */

  18070 22 001240   200036 236100                    LDQ     DELIMS$,,AUTO
        22 001241   000005 116000 23                 CMPQ    5
        22 001242   001200 601000 22                 TNZ     s:18055

     1487    18071
     1488    18072                     %NEW_CONST (@ST$          = ST$$,
     1489    18073                                 @TYPE         = %TYA,
     1490    18074                                 @LONG_CONSTANT= '1'B) ;

  18078 22 001243   000002 236000 6                  LDQ     ST_+2
        22 001244   000013 036007                    ADLQ    11,DL
        22 001245   000003 116000 6                  CMPQ    ST_+3
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:269  
        22 001246   001257 604000 22                 TMI     s:18080

  18079 22 001247   000014 236000 23                 LDQ     12
        22 001250   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 001251   200652 631500                    EPPR1   ID2_ST$+1,,AUTO
        22 001252   200653 451500                    STP1    ID2_ST$+2,,AUTO
        22 001253   200653 630500                    EPPR0   ID2_ST$+2,,AUTO
        22 001254   000013 631400 23                 EPPR1   11
        22 001255   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 001256   000000 011000                    NOP     0

  18080 22 001257   000002 236000 6                  LDQ     ST_+2
        22 001260   000022 736000                    QLS     18
        22 001261   000001 036000 6                  ADLQ    ST_+1
        22 001262   200104 756100                    STQ     ST$$,,AUTO

  18081 22 001263   000013 236007                    LDQ     11,DL
        22 001264   000002 056000 6                  ASQ     ST_+2

  18084 22 001265   000767 220003                    LDX0    503,DU
        22 001266   200104 470500                    LDP0    ST$$,,AUTO
        22 001267   000000 740100                    STX0    0,,PR0

  18085 22 001270   200104 470500                    LDP0    ST$$,,AUTO
        22 001271   001000 236007                    LDQ     512,DL
        22 001272   000000 552110                    STBQ    0,'10'O,PR0

  18086 22 001273   200104 470500                    LDP0    ST$$,,AUTO
        22 001274   000126 236000 xsym               LDQ     O1COM+86
        22 001275   000000 552104                    STBQ    0,'04'O,PR0

  18087 22 001276   000010 221003                    LDX1    8,DU
        22 001277   200104 470500                    LDP0    ST$$,,AUTO
        22 001300   000002 741100                    STX1    2,,PR0

  18088 22 001301   200104 470500                    LDP0    ST$$,,AUTO
        22 001302   000003 450100                    STZ     3,,PR0
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:270  

  18089 22 001303   000005 236000 23                 LDQ     5
        22 001304   200104 470500                    LDP0    ST$$,,AUTO
        22 001305   000004 756100                    STQ     4,,PR0

  18090 22 001306   000005 236000 23                 LDQ     5
        22 001307   200104 470500                    LDP0    ST$$,,AUTO
        22 001310   000005 756100                    STQ     5,,PR0

  18091 22 001311   000005 236000 23                 LDQ     5
        22 001312   200104 470500                    LDP0    ST$$,,AUTO
        22 001313   000006 756100                    STQ     6,,PR0

  18093 22 001314   200104 470500                    LDP0    ST$$,,AUTO
        22 001315   400000 236003                    LDQ     -131072,DU
        22 001316   000003 256100                    ORSQ    3,,PR0

     1491    18115    4                ST$$ -> CONST.CONST$.PTR$ = LTS$$ ;

  18115 22 001317   200071 236100                    LDQ     LTS$$,,AUTO
        22 001320   200104 470500                    LDP0    ST$$,,AUTO
        22 001321   000010 756100                    STQ     8,,PR0

     1492    18116    4                ST$$ -> SCALAR.DESCL = 512 ;

  18116 22 001322   001000 222003                    LDX2    512,DU
        22 001323   200104 470500                    LDP0    ST$$,,AUTO
        22 001324   000001 442100                    SXL2    1,,PR0

     1493    18117    4                CALL Z8AF$FORME (%TRIAD, ST$$, ADDR(NIL),

  18117 22 001325   000005 236000 23                 LDQ     5
        22 001326   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 001327   200107 236100                    LDQ     TABLE$,,AUTO
        22 001330   000001 036003                    ADLQ    1,DU
        22 001331   200657 756100                    STQ     ID2_ST$+6,,AUTO
        22 001332   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:271  
        22 001333   200656 450500                    STP0    ID2_ST$+5,,AUTO
        22 001334   200104 631500                    EPPR1   ST$$,,AUTO
        22 001335   200655 451500                    STP1    ID2_ST$+4,,AUTO
        22 001336   000031 236000 23                 LDQ     25
        22 001337   200654 756100                    STQ     ID2_ST$+3,,AUTO
        22 001340   200654 630500                    EPPR0   ID2_ST$+3,,AUTO
        22 001341   000027 631400 23                 EPPR1   23
        22 001342   000000 701000 xent               TSX1    Z8AF$FORME
        22 001343   000000 011000                    NOP     0

     1494    18118    4                                 TABLE$ -> LX_ETT_ITEM.ETT$) ;
     1495    18119
     1496    18120    4              END ; /* All id2's are constants */

  18120 22 001344   001576 710000 22                 TRA     s:18573

     1497    18121
     1498    18122    4              ELSE DO ; /* All id2's are not constants */

     1499    18123
     1500    18124                     /* TABLE = '000'O */
     1501    18125
     1502    18126                     %NEW_ILL (@ID = %MFILL,
     1503    18127                               @LOP = TABLE$ -> LX_ETT_ITEM.ETT$,
     1504    18128                               @FILL = "BITASC('000'O)") ;

  18395 22 001345   000034 236000 23                 LDQ     28
        22 001346   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 001347   200107 236100                    LDQ     TABLE$,,AUTO
        22 001350   000001 036003                    ADLQ    1,DU
        22 001351   200657 756100                    STQ     ID2_ST$+6,,AUTO
        22 001352   200652 633500                    EPPR3   ID2_ST$+1,,AUTO
        22 001353   200656 453500                    STP3    ID2_ST$+5,,AUTO
        22 001354   000036 237000 23                 LDAQ    30
        22 001355   200654 757100                    STAQ    ID2_ST$+3,,AUTO
        22 001356   000011 236000 23                 LDQ     9
        22 001357   200653 756100                    STQ     ID2_ST$+2,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:272  
        22 001360   200653 630500                    EPPR0   ID2_ST$+2,,AUTO
        22 001361   000032 631400 23                 EPPR1   26
        22 001362   000000 701000 xent               TSX1    Z8AN$NEW_ILL1
        22 001363   000000 011000                    NOP     0

  18397 22 001364   200107 470500                    LDP0    TABLE$,,AUTO
        22 001365   000001 236100                    LDQ     1,,PR0
        22 001366   000000 471400 7                  LDP1    ILL$
        22 001367   100001 756100                    STQ     1,,PR1

  18398 22 001370   000000 236003                    LDQ     0,DU
        22 001371   100000 552110                    STBQ    0,'10'O,PR1

     1505    18507
     1506    18508    5                DO WHILE (DELIMS$ ~= ADDR (NIL)) ;

  18508 22 001372   001573 710000 22                 TRA     s:18564

     1507    18509
     1508    18510    5                  CALL PREPARE_ID2 (DELIMS$, ID2$) ;

  18510 22 001373   200046 630500                    EPPR0   ID2$,,AUTO
        22 001374   200650 450500                    STP0    @DELIMITED$+1,,AUTO
        22 001375   200036 631500                    EPPR1   DELIMS$,,AUTO
        22 001376   200647 451500                    STP1    DELIMS$$+3,,AUTO
        22 001377   005455 701000 22                 TSX1    PREPARE_ID2
        22 001400   000000 011000                    NOP     0

     1509    18511                                                                    /*#30498*/
     1510    18512    6                  IF ID2$ -> LX_ETT_ITEM.ETT$ -> ETT.ID = %TRIAD THEN DO;

  18512 22 001401   200046 470500                    LDP0    ID2$,,AUTO
        22 001402   000001 471500                    LDP1    1,,PR0
        22 001403   100000 220100                    LDX0    0,,PR1
        22 001404   000015 100003                    CMPX0   13,DU
        22 001405   001432 601000 22                 TNZ     s:18533

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:273  
     1511    18513
     1512    18514    6                    CALL GET_CHAR (ID2$, ID2_CHAR) ;

  18514 22 001406   200047 633500                    EPPR3   ID2_CHAR,,AUTO
        22 001407   200552 453500                    STP3    @COUNT$+1,,AUTO
        22 001410   200046 631500                    EPPR1   ID2$,,AUTO
        22 001411   200551 451500                    STP1    SUB_ONE+9,,AUTO
        22 001412   004273 701000 22                 TSX1    GET_CHAR
        22 001413   000000 011000                    NOP     0

     1513    18515
     1514    18516    7                    IF ID2_CHAR = BITASC ('000'O) THEN DO ;

  18516 22 001414   200047 236100                    LDQ     ID2_CHAR,,AUTO
        22 001415   777000 376003                    ANQ     -512,DU
        22 001416   000000 116003                    CMPQ    0,DU
        22 001417   001432 601000 22                 TNZ     s:18533

     1515    18517
     1516    18518                           /* TCT instruction doesn't work for LOW-VALUES */
     1517    18519                           /* Change ID2 to a non-zero character */
     1518    18520
     1519    18521    7                      ID2$ = ADDR(LOW) ;

  18521 22 001420   200360 630500                    EPPR0   LOW,,AUTO
        22 001421   200046 450500                    STP0    ID2$,,AUTO

     1520    18522    7                      CALL Z8AC$LX_ETT_ITEM_TYI_CONST

  18522 22 001422   200046 631500                    EPPR1   ID2$,,AUTO
        22 001423   200653 451500                    STP1    ID2_ST$+2,,AUTO
        22 001424   000040 236000 23                 LDQ     32
        22 001425   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 001426   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 001427   000015 631400 23                 EPPR1   13
        22 001430   000000 701000 xent               TSX1    Z8AC$LX_ETT_ITEM_TYI_CONST
        22 001431   000000 011000                    NOP     0
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:274  

     1521    18523    7                           (BITBIN ('001000000000'O), ID2$) ;
     1522    18524
     1523    18525    7                    END ; /* ID2 first character is LOW-VALUE */

     1524    18526
     1525    18527    6                  END ; /* ID2 is a constant */

     1526    18528
     1527    18529                       /*N* Test first character ID2 at runtime for LOW-VALUE */
     1528    18530
     1529    18531                       /* IF BY IS CONSTANT & LENGTH = 1 */
     1530    18532
     1531    18533    5                  CALL Z8AU$TYPE_DESCRIPTOR (ID2$->LX_ETT_ITEM.ETT$, TYPE_DESC) ;

  18533 22 001432   200124 630500                    EPPR0   TYPE_DESC,,AUTO
        22 001433   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 001434   200046 236100                    LDQ     ID2$,,AUTO
        22 001435   000001 036003                    ADLQ    1,DU
        22 001436   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 001437   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 001440   000015 631400 23                 EPPR1   13
        22 001441   000000 701000 xent               TSX1    Z8AU$TYPE_DESCRIPTOR
        22 001442   000000 011000                    NOP     0

     1532    18534
     1533    18535    5                  IF  ID2$ -> LX_ETT_ITEM.ETT$ ->ETT.ID = %TRIAD

  18535 22 001443   200046 470500                    LDP0    ID2$,,AUTO
        22 001444   000001 471500                    LDP1    1,,PR0
        22 001445   100000 220100                    LDX0    0,,PR1
        22 001446   000015 100003                    CMPX0   13,DU
        22 001447   001511 601000 22                 TNZ     s:18551
        22 001450   200125 236100                    LDQ     TYPE_DESC+1,,AUTO
        22 001451   007777 376007                    ANQ     4095,DL
        22 001452   000001 116007                    CMPQ    1,DL
        22 001453   001511 601000 22                 TNZ     s:18551
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:275  

     1534    18536    6                  AND TYPE_DESC.DESC.ADSC.N = 1 THEN DO ;

     1535    18537
     1536    18538                         /* SUBSTR (TABLE, ASCBIN(ID2), 1) = ID2 */
     1537    18539
     1538    18540    6                    CALL Z8EA$ASCBIN (ID2$, ASCBIN$) ;

  18540 22 001454   200025 633500                    EPPR3   ASCBIN$,,AUTO
        22 001455   200653 453500                    STP3    ID2_ST$+2,,AUTO
        22 001456   200046 631500                    EPPR1   ID2$,,AUTO
        22 001457   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 001460   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 001461   000015 631400 23                 EPPR1   13
        22 001462   000000 701000 xent               TSX1    Z8EA$ASCBIN
        22 001463   000000 011000                    NOP     0

     1539    18541    6                    CALL Z8EA$SUBSTR_ZERO (TABLE$, ASCBIN$, ONE$, SUBSTR$) ;

  18541 22 001464   200106 630500                    EPPR0   SUBSTR$,,AUTO
        22 001465   200655 450500                    STP0    ID2_ST$+4,,AUTO
        22 001466   200074 631500                    EPPR1   ONE$,,AUTO
        22 001467   200654 451500                    STP1    ID2_ST$+3,,AUTO
        22 001470   200025 633500                    EPPR3   ASCBIN$,,AUTO
        22 001471   200653 453500                    STP3    ID2_ST$+2,,AUTO
        22 001472   200107 634500                    EPPR4   TABLE$,,AUTO
        22 001473   200652 454500                    STP4    ID2_ST$+1,,AUTO
        22 001474   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 001475   000027 631400 23                 EPPR1   23
        22 001476   000000 701000 xent               TSX1    Z8EA$SUBSTR_ZERO
        22 001477   000000 011000                    NOP     0

     1540    18542    6                    CALL Z8E7$MOVE (SUBSTR$, ID2$) ;

  18542 22 001500   200046 630500                    EPPR0   ID2$,,AUTO
        22 001501   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 001502   200106 631500                    EPPR1   SUBSTR$,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:276  
        22 001503   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 001504   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 001505   000015 631400 23                 EPPR1   13
        22 001506   000000 701000 xent               TSX1    Z8E7$MOVE
        22 001507   000000 011000                    NOP     0

     1541    18543
     1542    18544    6                  END ;

  18544 22 001510   001570 710000 22                 TRA     s:18562

     1543    18545
     1544    18546    6                  ELSE DO ; /* ID2 NOT CONSTANT OR NOT LENGTH 1 */

     1545    18547
     1546    18548                         /* SUBSTR (TABLE, ASCBIN (SUB_ID2), 1) = ID2 */
     1547    18549                         /* WHERE SUB_ID2 IS: SUBSTR (ID2, 1, 1) [COBOL SUBSTR]    */
     1548    18550
     1549    18551    6                    CALL Z8EY$SUBSTR (ID2$, ONE$, ONE$, SUBSTR$) ;

  18551 22 001511   200106 633500                    EPPR3   SUBSTR$,,AUTO
        22 001512   200655 453500                    STP3    ID2_ST$+4,,AUTO
        22 001513   200074 631500                    EPPR1   ONE$,,AUTO
        22 001514   200654 451500                    STP1    ID2_ST$+3,,AUTO
        22 001515   200074 634500                    EPPR4   ONE$,,AUTO
        22 001516   200653 454500                    STP4    ID2_ST$+2,,AUTO
        22 001517   200046 635500                    EPPR5   ID2$,,AUTO
        22 001520   200652 455500                    STP5    ID2_ST$+1,,AUTO
        22 001521   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 001522   000027 631400 23                 EPPR1   23
        22 001523   000000 701000 xent               TSX1    Z8EY$SUBSTR
        22 001524   000000 011000                    NOP     0

     1550    18552    6                    CALL Z8EA$ASCBIN (SUBSTR$, ASCBIN$) ;

  18552 22 001525   200025 630500                    EPPR0   ASCBIN$,,AUTO
        22 001526   200653 450500                    STP0    ID2_ST$+2,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:277  
        22 001527   200106 631500                    EPPR1   SUBSTR$,,AUTO
        22 001530   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 001531   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 001532   000015 631400 23                 EPPR1   13
        22 001533   000000 701000 xent               TSX1    Z8EA$ASCBIN
        22 001534   000000 011000                    NOP     0

     1551    18553    6                    CALL Z8EA$SUBSTR_ZERO (TABLE$, ASCBIN$, ONE$, SUBSTR$) ;

  18553 22 001535   200106 630500                    EPPR0   SUBSTR$,,AUTO
        22 001536   200655 450500                    STP0    ID2_ST$+4,,AUTO
        22 001537   200074 631500                    EPPR1   ONE$,,AUTO
        22 001540   200654 451500                    STP1    ID2_ST$+3,,AUTO
        22 001541   200025 633500                    EPPR3   ASCBIN$,,AUTO
        22 001542   200653 453500                    STP3    ID2_ST$+2,,AUTO
        22 001543   200107 634500                    EPPR4   TABLE$,,AUTO
        22 001544   200652 454500                    STP4    ID2_ST$+1,,AUTO
        22 001545   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 001546   000027 631400 23                 EPPR1   23
        22 001547   000000 701000 xent               TSX1    Z8EA$SUBSTR_ZERO
        22 001550   000000 011000                    NOP     0

     1552    18554
     1553    18555    6                    IF ID2$ -> LX_ETT_ITEM.TYPE = %TYN     THEN

  18555 22 001551   200046 470500                    LDP0    ID2$,,AUTO
        22 001552   000004 235100                    LDA     4,,PR0
        22 001553   000016 115007                    CMPA    14,DL
        22 001554   001560 601000 22                 TNZ     s:18558

     1554    18556    6                      SUBSTR$ -> LX_ETT_ITEM.TYPE = %TYN;

  18556 22 001555   000016 236007                    LDQ     14,DL
        22 001556   200106 471500                    LDP1    SUBSTR$,,AUTO
        22 001557   100004 756100                    STQ     4,,PR1

     1555    18557
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:278  
     1556    18558    6                    CALL Z8E7$MOVE (SUBSTR$, ID2$) ;

  18558 22 001560   200046 630500                    EPPR0   ID2$,,AUTO
        22 001561   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 001562   200106 631500                    EPPR1   SUBSTR$,,AUTO
        22 001563   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 001564   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 001565   000015 631400 23                 EPPR1   13
        22 001566   000000 701000 xent               TSX1    Z8E7$MOVE
        22 001567   000000 011000                    NOP     0

     1557    18559
     1558    18560    6                  END ; /* ID2 IS NOT CONSTANT OR LENGTH NOT ONE */

     1559    18561
     1560    18562    5                  DELIMS$ = DELIMS$ -> LX_ITEM.LINK ;

  18562 22 001570   200036 470500                    LDP0    DELIMS$,,AUTO
        22 001571   000007 236100                    LDQ     7,,PR0
        22 001572   200036 756100                    STQ     DELIMS$,,AUTO

     1561    18563
     1562    18564    5                END ; /* WHILE */

  18564 22 001573   200036 236100                    LDQ     DELIMS$,,AUTO
        22 001574   000005 116000 23                 CMPQ    5
        22 001575   001373 601000 22                 TNZ     s:18510

     1563    18565
     1564    18566    4              END ; /* All ID2's are not constants */

     1565    18567
     1566    18568    3            END ; /* DELIMITED */

     1567    18569
     1568    18570          %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:279  
     1569    18571                 /*V* UNSTRING_PASS_3_INTO_CLAUSES */
     1570    18572
     1571    18573    2            INTO_LIST$ = UNSTRING$ -> UNSTRING_STMT.INTO_LIST$ -> LX_LIST.HEAD$ ;

  18573 22 001576   200003 470500                    LDP0    @UNSTRING$,,AUTO
        22 001577   000000 471500                    LDP1    0,,PR0
        22 001600   100004 473500                    LDP3    4,,PR1
        22 001601   300004 236100                    LDQ     4,,PR3
        22 001602   200061 756100                    STQ     INTO_LIST$,,AUTO

     1572    18574    2            INTO_NO = 0 ;

  18574 22 001603   200062 450100                    STZ     INTO_NO,,AUTO

     1573    18575
     1574    18576    3            DO WHILE (INTO_LIST$ ~= ADDR(NIL)) ;

  18576 22 001604   003325 710000 22                 TRA     s:22106

     1575    18577
     1576    18578    3              INTO_NO = INTO_NO + 1 ;

  18578 22 001605   200062 054100                    AOS     INTO_NO,,AUTO

     1577    18579    3              INTO$ = INTO_LIST$ -> LX_LIST.HEAD$ ;

  18579 22 001606   200061 470500                    LDP0    INTO_LIST$,,AUTO
        22 001607   000004 236100                    LDQ     4,,PR0
        22 001610   200057 756100                    STQ     INTO$,,AUTO

     1578    18580    3              DELIMITER$ = INTO_LIST$ ->LX_LIST.HEAD$ -> LX_ITEM.LINK ;

  18580 22 001611   000004 471500                    LDP1    4,,PR0
        22 001612   100007 236100                    LDQ     7,,PR1
        22 001613   200035 756100                    STQ     DELIMITER$,,AUTO

     1579    18581    3              COUNT$ = INTO_LIST$ -> LX_LIST.TAIL$ ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:280  

  18581 22 001614   000001 236100                    LDQ     1,,PR0
        22 001615   200031 756100                    STQ     COUNT$,,AUTO

     1580    18582
     1581    18583    3              CALL PREPARE_ID4 (INTO$, ID4$) ;

  18583 22 001616   200050 631500                    EPPR1   ID4$,,AUTO
        22 001617   200552 451500                    STP1    @COUNT$+1,,AUTO
        22 001620   200057 633500                    EPPR3   INTO$,,AUTO
        22 001621   200551 453500                    STP3    SUB_ONE+9,,AUTO
        22 001622   005662 701000 22                 TSX1    PREPARE_ID4
        22 001623   000000 011000                    NOP     0

     1582    18584    3              CALL PREPARE_ID5 (DELIMITER$, ID5$) ;

  18584 22 001624   200051 630500                    EPPR0   ID5$,,AUTO
        22 001625   200552 450500                    STP0    @COUNT$+1,,AUTO
        22 001626   200035 631500                    EPPR1   DELIMITER$,,AUTO
        22 001627   200551 451500                    STP1    SUB_ONE+9,,AUTO
        22 001630   005705 701000 22                 TSX1    PREPARE_ID5
        22 001631   000000 011000                    NOP     0

     1583    18585    3              CALL PREPARE_ID6 (COUNT$, ID6$) ;

  18585 22 001632   200052 630500                    EPPR0   ID6$,,AUTO
        22 001633   200552 450500                    STP0    @COUNT$+1,,AUTO
        22 001634   200031 631500                    EPPR1   COUNT$,,AUTO
        22 001635   200551 451500                    STP1    SUB_ONE+9,,AUTO
        22 001636   005725 701000 22                 TSX1    PREPARE_ID6
        22 001637   000000 011000                    NOP     0

     1584    18586
     1585    18587    4              IF INTO_NO > 1 THEN DO ;

  18587 22 001640   200062 235100                    LDA     INTO_NO,,AUTO
        22 001641   000001 115007                    CMPA    1,DL
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:281  
        22 001642   001705 604400 22                 TMOZ    s:18619

     1586    18588
     1587    18589                     /* IF ID7 > LENGTH (ID1) THEN GOTO END_UNSTRING */
     1588    18590
     1589    18591                     %INIT_BINARY_OP (@POINTER = COMPARISON$,
     1590    18592                                      @LOP$    = ID7$,
     1591    18593                                      @OP      = %OP_GREATER_THAN,
     1592    18594                                      @ROP$    = LENGTH_ID1$,
     1593    18595                                      @LINE    = "ID7$ -> LX_ETT_ITEM.LINE",
     1594    18596                                      @COLUMN  = "ID7$ -> LX_ETT_ITEM.COLUMN") ;

  18598 22 001643   000005 220003                    LDX0    5,DU
        22 001644   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 001645   000000 740100                    STX0    0,,PR0

  18599 22 001646   000000 221003                    LDX1    0,DU
        22 001647   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 001650   000000 441100                    SXL1    0,,PR0

  18606 22 001651   200054 470500                    LDP0    ID7$,,AUTO
        22 001652   200026 471500                    LDP1    COMPARISON$,,AUTO
        22 001653   000005 235100                    LDA     5,,PR0
        22 001654   100005 755100                    STA     5,,PR1

  18607 22 001655   200054 470500                    LDP0    ID7$,,AUTO
        22 001656   200026 471500                    LDP1    COMPARISON$,,AUTO
        22 001657   000006 235100                    LDA     6,,PR0
        22 001660   100006 755100                    STA     6,,PR1

  18608 22 001661   200065 236100                    LDQ     LENGTH_ID1$,,AUTO
        22 001662   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 001663   000002 756100                    STQ     2,,PR0

  18609 22 001664   200054 236100                    LDQ     ID7$,,AUTO
        22 001665   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 001666   000001 756100                    STQ     1,,PR0
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:282  

  18610 22 001667   000030 235007                    LDA     24,DL
        22 001670   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 001671   000003 755100                    STA     3,,PR0

  18611 22 001672   000005 236000 23                 LDQ     5
        22 001673   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 001674   000007 756100                    STQ     7,,PR0

     1595    18614
     1596    18615    4                CALL Z8EK$BRANCH_TRUE (NOT_OVERFLOW_LABEL$, COMPARISON$) ;

  18615 22 001675   200026 630500                    EPPR0   COMPARISON$,,AUTO
        22 001676   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 001677   200073 631500                    EPPR1   NOT_OVERFLOW_LABEL$,,AUTO
        22 001700   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 001701   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 001702   000015 631400 23                 EPPR1   13
        22 001703   000000 701000 xent               TSX1    Z8EK$BRANCH_TRUE
        22 001704   000000 011000                    NOP     0

     1597    18616
     1598    18617    4              END ; /* INTO_NO > 1 */

     1599    18618
     1600    18619    4              IF DELIMITED THEN DO ;

  18619 22 001705   200033 234100                    SZN     DELIMITED,,AUTO
        22 001706   003125 605000 22                 TPL     s:21636

     1601    18620
     1602    18621                     /* ID6 = 0 */
     1603    18622
     1604    18623    4                CALL Z8E7$MOVE (ID6$, ZERO$) ;

  18623 22 001707   200114 630500                    EPPR0   ZERO$,,AUTO
        22 001710   200653 450500                    STP0    ID2_ST$+2,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:283  
        22 001711   200052 631500                    EPPR1   ID6$,,AUTO
        22 001712   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 001713   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 001714   000015 631400 23                 EPPR1   13
        22 001715   000000 701000 xent               TSX1    Z8E7$MOVE
        22 001716   000000 011000                    NOP     0

     1605    18624
     1606    18625                     /* INTO_LABEL: CALL SEARCH (POSITION,
     1607    18626                                                 TABLEVAL,
     1608    18627                                                 TABLE,
     1609    18628                                                 SUBSTR (ID1, ID6+ID7))
     1610    18629                                                 ALTRET (END_INTO)
     1611    18630                     */
     1612    18631
     1613    18632    4                CALL Z8AT$CREATE_TEMPORARY (%PARA, INTO_LABEL$) ;

  18632 22 001717   200060 630500                    EPPR0   INTO_LABEL$,,AUTO
        22 001720   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 001721   000025 236000 23                 LDQ     21
        22 001722   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 001723   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 001724   000015 631400 23                 EPPR1   13
        22 001725   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        22 001726   000000 011000                    NOP     0

     1614    18633    4                CALL Z8AT$CREATE_TEMPORARY (%PARA, END_INTO$) ;

  18633 22 001727   200041 630500                    EPPR0   END_INTO$,,AUTO
        22 001730   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 001731   000025 236000 23                 LDQ     21
        22 001732   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 001733   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 001734   000015 631400 23                 EPPR1   13
        22 001735   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        22 001736   000000 011000                    NOP     0

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:284  
     1615    18634
     1616    18635    4                IF DELIMITER AND NOT ID1_ST$ -> SCALAR.B.KANJI  THEN

  18635 22 001737   200034 234100                    SZN     DELIMITER,,AUTO
        22 001740   002013 605000 22                 TPL     s:18667
        22 001741   200045 470500                    LDP0    ID1_ST$,,AUTO
        22 001742   000003 236100                    LDQ     3,,PR0
        22 001743   001000 316007                    CANQ    512,DL
        22 001744   002013 601000 22                 TNZ     s:18667

     1617    18636    5                  DO;

     1618    18637    5                    TABLEVAL$ = ADDR(TABLEVAL);

  18637 22 001745   200500 631500                    EPPR1   TABLEVAL,,AUTO
        22 001746   200110 451500                    STP1    TABLEVAL$,,AUTO

     1619    18638                         %INIT_LX_ETT_ITEM (@POINTER = TABLEVAL$, @TYPE = %TYA);

  18640 22 001747   000004 220003                    LDX0    4,DU
        22 001750   100000 740100                    STX0    0,,PR1

  18641 22 001751   000000 221003                    LDX1    0,DU
        22 001752   200110 471500                    LDP1    TABLEVAL$,,AUTO
        22 001753   100000 441100                    SXL1    0,,PR1

  18642 22 001754   000010 235007                    LDA     8,DL
        22 001755   200110 471500                    LDP1    TABLEVAL$,,AUTO
        22 001756   100004 755100                    STA     4,,PR1

  18643 22 001757   000005 236000 23                 LDQ     5
        22 001760   200110 471500                    LDP1    TABLEVAL$,,AUTO
        22 001761   100007 756100                    STQ     7,,PR1

  18644 22 001762   200110 471500                    LDP1    TABLEVAL$,,AUTO
        22 001763   100001 756100                    STQ     1,,PR1

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:285  
  18645 22 001764   000005 236000 23                 LDQ     5
        22 001765   200110 471500                    LDP1    TABLEVAL$,,AUTO
        22 001766   100002 756100                    STQ     2,,PR1

  18647 22 001767   000133 236000 xsym               LDQ     COMCOM+91
        22 001770   200110 471500                    LDP1    TABLEVAL$,,AUTO
        22 001771   100005 756100                    STQ     5,,PR1

  18648 22 001772   000134 236000 xsym               LDQ     COMCOM+92
        22 001773   200110 471500                    LDP1    TABLEVAL$,,AUTO
        22 001774   100006 756100                    STQ     6,,PR1

     1620    18660    5                    CALL Z8AT$CREATE_TEMP_WITH_BASE (%SCALAR, TABLEVAL$->

  18660 22 001775   200110 236100                    LDQ     TABLEVAL$,,AUTO
        22 001776   000001 036003                    ADLQ    1,DU
        22 001777   000017 235000 23                 LDA     15
        22 002000   200652 757100                    STAQ    ID2_ST$+1,,AUTO
        22 002001   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002002   000015 631400 23                 EPPR1   13
        22 002003   000000 701000 xent               TSX1    Z8AT$CREATE_TEMP_WITH_BASE
        22 002004   000000 011000                    NOP     0

     1621    18661    5                                                       LX_ETT_ITEM.ETT$ );
     1622    18662    5                    TABLEVAL$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP ->

  18662 22 002005   200110 470500                    LDP0    TABLEVAL$,,AUTO
        22 002006   000001 471500                    LDP1    1,,PR0
        22 002007   100001 473500                    LDP3    1,,PR1
        22 002010   000001 236007                    LDQ     1,DL
        22 002011   300001 752103                    STCQ    1,'03'O,PR3

     1623    18663    5                                 CONST.ADSC.N = 1 ;
     1624    18664    5                  END;  /* if Delimiter */

  18664 22 002012   002015 710000 22                 TRA     s:18991

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:286  
     1625    18665    4                ELSE
     1626    18666    5                  DO;

     1627    18667    5                    TABLEVAL$ = ADDR(NIL);

  18667 22 002013   000005 236000 23                 LDQ     5
        22 002014   200110 756100                    STQ     TABLEVAL$,,AUTO

     1628    18668    5                  END;

     1629    18669
     1630    18670                     %NEW_ILL (@ID = %DEFLB, @LOP = INTO_LABEL$) ;

  18991 22 002015   000034 236000 23                 LDQ     28
        22 002016   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 002017   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002020   200657 450500                    STP0    ID2_ST$+6,,AUTO
        22 002021   000037 236000 23                 LDQ     31
        22 002022   200656 756100                    STQ     ID2_ST$+5,,AUTO
        22 002023   000044 237000 23                 LDAQ    36
        22 002024   200654 757100                    STAQ    ID2_ST$+3,,AUTO
        22 002025   200654 630500                    EPPR0   ID2_ST$+3,,AUTO
        22 002026   000027 631400 23                 EPPR1   23
        22 002027   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        22 002030   000000 011000                    NOP     0

  19000 22 002031   200060 236100                    LDQ     INTO_LABEL$,,AUTO
        22 002032   000000 470400 7                  LDP0    ILL$
        22 002033   000001 756100                    STQ     1,,PR0

     1631    19049
     1632    19050                     /* ID6 + ID7 */
     1633    19051
     1634    19052                     %INIT_BINARY_OP (@POINTER = ID6_PLUS_ID7$,
     1635    19053                                      @LOP$    = ID6$,
     1636    19054                                      @OP      = %OP_PLUS,
     1637    19055                                      @ROP$    = ID7$,
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:287  
     1638    19056                                      @LINE    = "ID6$ -> LX_ETT_ITEM.LINE",
     1639    19057                                      @COLUMN  = "ID6$ -> LX_ETT_ITEM.COLUMN") ;

  19059 22 002034   000005 220003                    LDX0    5,DU
        22 002035   200053 471500                    LDP1    ID6_PLUS_ID7$,,AUTO
        22 002036   100000 740100                    STX0    0,,PR1

  19060 22 002037   000000 221003                    LDX1    0,DU
        22 002040   200053 470500                    LDP0    ID6_PLUS_ID7$,,AUTO
        22 002041   000000 441100                    SXL1    0,,PR0

  19067 22 002042   200052 470500                    LDP0    ID6$,,AUTO
        22 002043   200053 471500                    LDP1    ID6_PLUS_ID7$,,AUTO
        22 002044   000005 235100                    LDA     5,,PR0
        22 002045   100005 755100                    STA     5,,PR1

  19068 22 002046   200052 470500                    LDP0    ID6$,,AUTO
        22 002047   200053 471500                    LDP1    ID6_PLUS_ID7$,,AUTO
        22 002050   000006 235100                    LDA     6,,PR0
        22 002051   100006 755100                    STA     6,,PR1

  19069 22 002052   200054 236100                    LDQ     ID7$,,AUTO
        22 002053   200053 470500                    LDP0    ID6_PLUS_ID7$,,AUTO
        22 002054   000002 756100                    STQ     2,,PR0

  19070 22 002055   200052 236100                    LDQ     ID6$,,AUTO
        22 002056   200053 470500                    LDP0    ID6_PLUS_ID7$,,AUTO
        22 002057   000001 756100                    STQ     1,,PR0

  19071 22 002060   000020 235007                    LDA     16,DL
        22 002061   200053 470500                    LDP0    ID6_PLUS_ID7$,,AUTO
        22 002062   000003 755100                    STA     3,,PR0

  19072 22 002063   000005 236000 23                 LDQ     5
        22 002064   200053 470500                    LDP0    ID6_PLUS_ID7$,,AUTO
        22 002065   000007 756100                    STQ     7,,PR0

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:288  
     1640    19075
     1641    19076                     %INIT_LX_ETT_ITEM (@POINTER = POSITION$, @TYPE = %TYI) ;

  19078 22 002066   000004 222003                    LDX2    4,DU
        22 002067   200102 470500                    LDP0    POSITION$,,AUTO
        22 002070   000000 742100                    STX2    0,,PR0

  19079 22 002071   200102 470500                    LDP0    POSITION$,,AUTO
        22 002072   000000 441100                    SXL1    0,,PR0

  19080 22 002073   000001 236007                    LDQ     1,DL
        22 002074   200102 470500                    LDP0    POSITION$,,AUTO
        22 002075   000004 756100                    STQ     4,,PR0

  19081 22 002076   000005 236000 23                 LDQ     5
        22 002077   200102 470500                    LDP0    POSITION$,,AUTO
        22 002100   000007 756100                    STQ     7,,PR0

  19082 22 002101   200102 470500                    LDP0    POSITION$,,AUTO
        22 002102   000001 756100                    STQ     1,,PR0

  19083 22 002103   000005 236000 23                 LDQ     5
        22 002104   200102 470500                    LDP0    POSITION$,,AUTO
        22 002105   000002 756100                    STQ     2,,PR0

  19085 22 002106   000133 236000 xsym               LDQ     COMCOM+91
        22 002107   200102 470500                    LDP0    POSITION$,,AUTO
        22 002110   000005 756100                    STQ     5,,PR0

  19086 22 002111   000134 236000 xsym               LDQ     COMCOM+92
        22 002112   200102 470500                    LDP0    POSITION$,,AUTO
        22 002113   000006 756100                    STQ     6,,PR0

     1642    19098    4               CALL Z8AT$CREATE_TEMP_WITH_BASE (%SCALAR, POSITION$ -> LX_ETT_ITEM.ETT$
             19098                         ) ;

  19098 22 002114   200102 236100                    LDQ     POSITION$,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:289  
        22 002115   000001 036003                    ADLQ    1,DU
        22 002116   000017 235000 23                 LDA     15
        22 002117   200652 757100                    STAQ    ID2_ST$+1,,AUTO
        22 002120   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002121   000015 631400 23                 EPPR1   13
        22 002122   000000 701000 xent               TSX1    Z8AT$CREATE_TEMP_WITH_BASE
        22 002123   000000 011000                    NOP     0

     1643    19099    4                DELIMS$ = UNSTRING$ -> UNSTRING_STMT.DELIM_LIST$ -> LX_LIST.HEAD$ ;

  19099 22 002124   200003 470500                    LDP0    @UNSTRING$,,AUTO
        22 002125   000000 471500                    LDP1    0,,PR0
        22 002126   100003 473500                    LDP3    3,,PR1
        22 002127   300004 236100                    LDQ     4,,PR3
        22 002130   200036 756100                    STQ     DELIMS$,,AUTO

     1644    19100
     1645    19101    4                IF NOT ID1_ST$ -> SCALAR.B.KANJI   THEN

  19101 22 002131   200045 471500                    LDP1    ID1_ST$,,AUTO
        22 002132   100003 236100                    LDQ     3,,PR1
        22 002133   001000 316007                    CANQ    512,DL
        22 002134   002172 601000 22                 TNZ     s:19110

     1646    19102    5                  DO;

     1647    19103
     1648    19104    5                    CALL Z8EY$SUBSTR (ID1$, ID6_PLUS_ID7$, ADDR(NIL), SUBSTR$) ;

  19104 22 002135   000005 236000 23                 LDQ     5
        22 002136   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 002137   200106 633500                    EPPR3   SUBSTR$,,AUTO
        22 002140   200657 453500                    STP3    ID2_ST$+6,,AUTO
        22 002141   200652 634500                    EPPR4   ID2_ST$+1,,AUTO
        22 002142   200656 454500                    STP4    ID2_ST$+5,,AUTO
        22 002143   200053 635500                    EPPR5   ID6_PLUS_ID7$,,AUTO
        22 002144   200655 455500                    STP5    ID2_ST$+4,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:290  
        22 002145   200044 636500                    EPPR6   ID1$,,AUTO
        22 002146   200654 456500                    STP6    ID2_ST$+3,,AUTO
        22 002147   200654 630500                    EPPR0   ID2_ST$+3,,AUTO
        22 002150   000027 631400 23                 EPPR1   23
        22 002151   000000 701000 xent               TSX1    Z8EY$SUBSTR
        22 002152   000000 011000                    NOP     0

     1649    19105
     1650    19106    5                   CALL Z8EZ$SEARCH (POSITION$, TABLEVAL$, TABLE$, SUBSTR$, END_INTO$)
             19106                             ;

  19106 22 002153   200041 630500                    EPPR0   END_INTO$,,AUTO
        22 002154   200656 450500                    STP0    ID2_ST$+5,,AUTO
        22 002155   200106 631500                    EPPR1   SUBSTR$,,AUTO
        22 002156   200655 451500                    STP1    ID2_ST$+4,,AUTO
        22 002157   200107 633500                    EPPR3   TABLE$,,AUTO
        22 002160   200654 453500                    STP3    ID2_ST$+3,,AUTO
        22 002161   200110 634500                    EPPR4   TABLEVAL$,,AUTO
        22 002162   200653 454500                    STP4    ID2_ST$+2,,AUTO
        22 002163   200102 635500                    EPPR5   POSITION$,,AUTO
        22 002164   200652 455500                    STP5    ID2_ST$+1,,AUTO
        22 002165   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002166   000032 631400 23                 EPPR1   26
        22 002167   000000 701000 xent               TSX1    Z8EZ$SEARCH
        22 002170   000000 011000                    NOP     0

     1651    19107    5                  END;

  19107 22 002171   002200 710000 22                 TRA     s:19122

     1652    19108    4                ELSE
     1653    19109    5                  DO;

     1654    19110    5                    CALL KANJI_INDEX( POSITION$,

  19110 22 002172   200036 633500                    EPPR3   DELIMS$,,AUTO
        22 002173   200552 453500                    STP3    @COUNT$+1,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:291  
        22 002174   200102 634500                    EPPR4   POSITION$,,AUTO
        22 002175   200551 454500                    STP4    SUB_ONE+9,,AUTO
        22 002176   006175 701000 22                 TSX1    KANJI_INDEX
        22 002177   000000 011000                    NOP     0

     1655    19111    5                                      DELIMS$ );
     1656    19112           /*            %INIT_BINARY_OP( @POINTER = COMPARISON$,
     1657    19113                                          @OP = %OP_GREATER_THAN_OR_EQUAL,
     1658    19114                                          @LOP$ = LENGTH_ID1$,
     1659    19115                                          @ROP$ = POSITION$ );
     1660    19116                         CALL Z8EK$BRANCH_TRUE( END_INTO$,
     1661    19117                                                COMPARISON$ );  */
     1662    19118    5                  END;

     1663    19119
     1664    19120                     /* ID6 = ID6 + POSITION */
     1665    19121
     1666    19122    4                CALL ADD_A_AND_B_GIVING_C (ID6$, POSITION$, ID6$) ;

  19122 22 002200   200052 630500                    EPPR0   ID6$,,AUTO
        22 002201   200565 450500                    STP0    @B$+1,,AUTO
        22 002202   200102 631500                    EPPR1   POSITION$,,AUTO
        22 002203   200564 451500                    STP1    @A$+1,,AUTO
        22 002204   200052 633500                    EPPR3   ID6$,,AUTO
        22 002205   200563 453500                    STP3    COUNT+5,,AUTO
        22 002206   006115 701000 22                 TSX1    ADD_A_AND_B_GIVING_C
        22 002207   000000 011000                    NOP     0

     1667    19123
     1668    19124    5                IF ALL_LENGTH_1 THEN DO ;

  19124 22 002210   200023 234100                    SZN     ALL_LENGTH_1,,AUTO
        22 002211   002323 605000 22                 TPL     s:19169

     1669    19125                       /* ID4 = SUBSTR (ID1, ID7, ID6) */
     1670    19126
     1671    19127    5                  CALL Z8EY$SUBSTR (ID1$, ID7$, ID6$, SUBSTR$) ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:292  

  19127 22 002212   200106 630500                    EPPR0   SUBSTR$,,AUTO
        22 002213   200655 450500                    STP0    ID2_ST$+4,,AUTO
        22 002214   200052 631500                    EPPR1   ID6$,,AUTO
        22 002215   200654 451500                    STP1    ID2_ST$+3,,AUTO
        22 002216   200054 633500                    EPPR3   ID7$,,AUTO
        22 002217   200653 453500                    STP3    ID2_ST$+2,,AUTO
        22 002220   200044 634500                    EPPR4   ID1$,,AUTO
        22 002221   200652 454500                    STP4    ID2_ST$+1,,AUTO
        22 002222   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002223   000027 631400 23                 EPPR1   23
        22 002224   000000 701000 xent               TSX1    Z8EY$SUBSTR
        22 002225   000000 011000                    NOP     0

     1672    19128    5                  CALL Z8E7$MOVE (ID4$, SUBSTR$) ;

  19128 22 002226   200106 630500                    EPPR0   SUBSTR$,,AUTO
        22 002227   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 002230   200050 631500                    EPPR1   ID4$,,AUTO
        22 002231   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 002232   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002233   000015 631400 23                 EPPR1   13
        22 002234   000000 701000 xent               TSX1    Z8E7$MOVE
        22 002235   000000 011000                    NOP     0

     1673    19129
     1674    19130    6                  IF TALLYING THEN DO ;

  19130 22 002236   200112 234100                    SZN     TALLYING,,AUTO
        22 002237   002250 605000 22                 TPL     s:19138

     1675    19131
     1676    19132                         /* ID8 = ID8 + 1 */
     1677    19133
     1678    19134    6                    CALL ADD_A_AND_B_GIVING_C (ID8$, ONE$, ID8$) ;

  19134 22 002240   200055 630500                    EPPR0   ID8$,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:293  
        22 002241   200565 450500                    STP0    @B$+1,,AUTO
        22 002242   200074 631500                    EPPR1   ONE$,,AUTO
        22 002243   200564 451500                    STP1    @A$+1,,AUTO
        22 002244   200055 633500                    EPPR3   ID8$,,AUTO
        22 002245   200563 453500                    STP3    COUNT+5,,AUTO
        22 002246   006115 701000 22                 TSX1    ADD_A_AND_B_GIVING_C
        22 002247   000000 011000                    NOP     0

     1679    19135
     1680    19136    6                  END ; /* TALLYING */

     1681    19137
     1682    19138    6                  IF DELIMITER THEN DO ;

  19138 22 002250   200034 234100                    SZN     DELIMITER,,AUTO
        22 002251   002262 605000 22                 TPL     s:19146

     1683    19139
     1684    19140                         /* ID5 = TABLEVAL */
     1685    19141
     1686    19142    6                    CALL Z8E7$MOVE (ID5$, TABLEVAL$) ;

  19142 22 002252   200110 630500                    EPPR0   TABLEVAL$,,AUTO
        22 002253   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 002254   200051 631500                    EPPR1   ID5$,,AUTO
        22 002255   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 002256   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002257   000015 631400 23                 EPPR1   13
        22 002260   000000 701000 xent               TSX1    Z8E7$MOVE
        22 002261   000000 011000                    NOP     0

     1687    19143
     1688    19144    6                  END ; /* DELIMITER */

     1689    19145
     1690    19146    5                  IF POINTER OR INTO_NO ~= INTO_MAX

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:294  
  19146 22 002262   200100 234100                    SZN     POINTER,,AUTO
        22 002263   002271 604000 22                 TMI     s:19151
        22 002264   200062 236100                    LDQ     INTO_NO,,AUTO
        22 002265   200063 116100                    CMPQ    INTO_MAX,,AUTO
        22 002266   002271 601000 22                 TNZ     s:19151
        22 002267   200076 234100                    SZN     OVERFLOW,,AUTO
        22 002270   002301 605000 22                 TPL     s:19157

     1691    19147    6                  OR OVERFLOW THEN DO ;

     1692    19148
     1693    19149                         /* ID7 = ID7 + ID6 + 1 */
     1694    19150
     1695    19151    6                    CALL ADD_A_AND_B_GIVING_C ( ID6_PLUS_ID7$, ONE$, ID7$) ;

  19151 22 002271   200054 630500                    EPPR0   ID7$,,AUTO
        22 002272   200565 450500                    STP0    @B$+1,,AUTO
        22 002273   200074 631500                    EPPR1   ONE$,,AUTO
        22 002274   200564 451500                    STP1    @A$+1,,AUTO
        22 002275   200053 633500                    EPPR3   ID6_PLUS_ID7$,,AUTO
        22 002276   200563 453500                    STP3    COUNT+5,,AUTO
        22 002277   006115 701000 22                 TSX1    ADD_A_AND_B_GIVING_C
        22 002300   000000 011000                    NOP     0

     1696    19152
     1697    19153    6                  END ; /* OVERFLOW, POINTER, or not last INTO guy */

     1698    19154
     1699    19155                       /* GOTO EXIT_INTO_LOOP */
     1700    19156
     1701    19157    6                  IF EXIT_INTO_LOOP$ = ADDR(NIL) THEN DO ;

  19157 22 002301   200042 236100                    LDQ     EXIT_INTO_LOOP$,,AUTO
        22 002302   000005 116000 23                 CMPQ    5
        22 002303   002314 601000 22                 TNZ     s:19163

     1702    19158
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:295  
     1703    19159    6                    CALL Z8AT$CREATE_TEMPORARY (%PARA, EXIT_INTO_LOOP$) ;

  19159 22 002304   200042 630500                    EPPR0   EXIT_INTO_LOOP$,,AUTO
        22 002305   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 002306   000025 236000 23                 LDQ     21
        22 002307   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 002310   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002311   000015 631400 23                 EPPR1   13
        22 002312   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        22 002313   000000 011000                    NOP     0

     1704    19160
     1705    19161    6                  END ;

     1706    19162
     1707    19163    5                  CALL Z8EK$BRANCH (EXIT_INTO_LOOP$) ;

  19163 22 002314   200042 630500                    EPPR0   EXIT_INTO_LOOP$,,AUTO
        22 002315   200652 450500                    STP0    ID2_ST$+1,,AUTO
        22 002316   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002317   000013 631400 23                 EPPR1   11
        22 002320   000000 701000 xent               TSX1    Z8EK$BRANCH
        22 002321   000000 011000                    NOP     0

     1708    19164
     1709    19165    5                END ; /* All id2's length = 1 & no ALL's */

  19165 22 002322   002717 710000 22                 TRA     s:20762

     1710    19166
     1711    19167    5                ELSE DO ; /* ALL "BY" LENGTHS ARE NOT ONE BYTE */

     1712    19168
     1713    19169    5                  DELIMS$ = UNSTRING$ -> UNSTRING_STMT.DELIM_LIST$ -> LX_LIST.HEAD$ ;

  19169 22 002323   200003 470500                    LDP0    @UNSTRING$,,AUTO
        22 002324   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:296  
        22 002325   100003 473500                    LDP3    3,,PR1
        22 002326   300004 236100                    LDQ     4,,PR3
        22 002327   200036 756100                    STQ     DELIMS$,,AUTO

     1714    19170
     1715    19171    6                  DO WHILE (DELIMS$ ~= ADDR(NIL)) ;

  19171 22 002330   002672 710000 22                 TRA     s:20421

     1716    19172
     1717    19173    6                    CALL PREPARE_ID2 (DELIMS$, ID2$) ;

  19173 22 002331   200046 630500                    EPPR0   ID2$,,AUTO
        22 002332   200650 450500                    STP0    @DELIMITED$+1,,AUTO
        22 002333   200036 631500                    EPPR1   DELIMS$,,AUTO
        22 002334   200647 451500                    STP1    DELIMS$$+3,,AUTO
        22 002335   005455 701000 22                 TSX1    PREPARE_ID2
        22 002336   000000 011000                    NOP     0

     1718    19174
     1719    19175                         /* IF SUBSTR (ID1, ID6+ID7, LENGTH(ID2)) = ID2
     1720    19176                            THEN DO / * NOTE: ONE-BASED SUBSTR */
     1721    19177
     1722    19178    6                    IF NOT ID1_ST$ -> SCALAR.B.KANJI   THEN

  19178 22 002337   200045 470500                    LDP0    ID1_ST$,,AUTO
        22 002340   000003 236100                    LDQ     3,,PR0
        22 002341   001000 316007                    CANQ    512,DL
        22 002342   002432 601000 22                 TNZ     s:19223

     1723    19179    7                      DO;

     1724    19180    7                        CALL Z8EY$SUBSTR (ID1$, ID6_PLUS_ID7$, LENGTH_ID2$, SUBSTR$) ;

  19180 22 002343   200106 631500                    EPPR1   SUBSTR$,,AUTO
        22 002344   200655 451500                    STP1    ID2_ST$+4,,AUTO
        22 002345   200066 633500                    EPPR3   LENGTH_ID2$,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:297  
        22 002346   200654 453500                    STP3    ID2_ST$+3,,AUTO
        22 002347   200053 634500                    EPPR4   ID6_PLUS_ID7$,,AUTO
        22 002350   200653 454500                    STP4    ID2_ST$+2,,AUTO
        22 002351   200044 635500                    EPPR5   ID1$,,AUTO
        22 002352   200652 455500                    STP5    ID2_ST$+1,,AUTO
        22 002353   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002354   000027 631400 23                 EPPR1   23
        22 002355   000000 701000 xent               TSX1    Z8EY$SUBSTR
        22 002356   000000 011000                    NOP     0

     1725    19181
     1726    19182                             %IF_THEN_DO (@LOP = SUBSTR$,
     1727    19183                                          @REL = %OP_EQUAL,
     1728    19184                                          @ROP = ID2$,
     1729    19185                                          @LAB = END_IF$) ;

  19191 22 002357   200210 630500                    EPPR0   COMPARISON,,AUTO
        22 002360   200026 450500                    STP0    COMPARISON$,,AUTO

  19199 22 002361   000005 220003                    LDX0    5,DU
        22 002362   000000 740100                    STX0    0,,PR0

  19200 22 002363   000000 221003                    LDX1    0,DU
        22 002364   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 002365   000000 441100                    SXL1    0,,PR0

  19207 22 002366   200106 470500                    LDP0    SUBSTR$,,AUTO
        22 002367   200026 471500                    LDP1    COMPARISON$,,AUTO
        22 002370   000005 235100                    LDA     5,,PR0
        22 002371   100005 755100                    STA     5,,PR1

  19208 22 002372   200106 470500                    LDP0    SUBSTR$,,AUTO
        22 002373   200026 471500                    LDP1    COMPARISON$,,AUTO
        22 002374   000006 235100                    LDA     6,,PR0
        22 002375   100006 755100                    STA     6,,PR1

  19209 22 002376   200046 236100                    LDQ     ID2$,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:298  
        22 002377   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 002400   000002 756100                    STQ     2,,PR0

  19210 22 002401   200106 236100                    LDQ     SUBSTR$,,AUTO
        22 002402   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 002403   000001 756100                    STQ     1,,PR0

  19211 22 002404   000027 235007                    LDA     23,DL
        22 002405   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 002406   000003 755100                    STA     3,,PR0

  19212 22 002407   000005 236000 23                 LDQ     5
        22 002410   200026 470500                    LDP0    COMPARISON$,,AUTO
        22 002411   000007 756100                    STQ     7,,PR0

  19215 22 002412   200040 630500                    EPPR0   END_IF$,,AUTO
        22 002413   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 002414   000025 236000 23                 LDQ     21
        22 002415   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 002416   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002417   000015 631400 23                 EPPR1   13
        22 002420   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        22 002421   000000 011000                    NOP     0

  19216 22 002422   200026 630500                    EPPR0   COMPARISON$,,AUTO
        22 002423   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 002424   200040 631500                    EPPR1   END_IF$,,AUTO
        22 002425   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 002426   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002427   000015 631400 23                 EPPR1   13
        22 002430   000000 701000 xent               TSX1    Z8EK$BRANCH_FALSE
        22 002431   000000 011000                    NOP     0

     1730    19219    7                      END;

     1731    19220
     1732    19221                         /* ID4 = SUBSTR (ID1, ID7, ID6) [ONE-BASED SUBSTR] */
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:299  
     1733    19222
     1734    19223    6                    CALL Z8EY$SUBSTR (ID1$, ID7$, ID6$, SUBSTR$) ;

  19223 22 002432   200106 630500                    EPPR0   SUBSTR$,,AUTO
        22 002433   200655 450500                    STP0    ID2_ST$+4,,AUTO
        22 002434   200052 631500                    EPPR1   ID6$,,AUTO
        22 002435   200654 451500                    STP1    ID2_ST$+3,,AUTO
        22 002436   200054 633500                    EPPR3   ID7$,,AUTO
        22 002437   200653 453500                    STP3    ID2_ST$+2,,AUTO
        22 002440   200044 634500                    EPPR4   ID1$,,AUTO
        22 002441   200652 454500                    STP4    ID2_ST$+1,,AUTO
        22 002442   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002443   000027 631400 23                 EPPR1   23
        22 002444   000000 701000 xent               TSX1    Z8EY$SUBSTR
        22 002445   000000 011000                    NOP     0

     1735    19224    6                    CALL Z8E7$MOVE (ID4$, SUBSTR$) ;

  19224 22 002446   200106 630500                    EPPR0   SUBSTR$,,AUTO
        22 002447   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 002450   200050 631500                    EPPR1   ID4$,,AUTO
        22 002451   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 002452   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002453   000015 631400 23                 EPPR1   13
        22 002454   000000 701000 xent               TSX1    Z8E7$MOVE
        22 002455   000000 011000                    NOP     0

     1736    19225
     1737    19226    7                    IF TALLYING THEN DO ; /* ID8 EXISTS */

  19226 22 002456   200112 234100                    SZN     TALLYING,,AUTO
        22 002457   002470 605000 22                 TPL     s:19234

     1738    19227
     1739    19228                           /* ADD 1 TO ID8 */
     1740    19229
     1741    19230    7                      CALL ADD_A_AND_B_GIVING_C (ID8$, ONE$, ID8$) ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:300  

  19230 22 002460   200055 630500                    EPPR0   ID8$,,AUTO
        22 002461   200565 450500                    STP0    @B$+1,,AUTO
        22 002462   200074 631500                    EPPR1   ONE$,,AUTO
        22 002463   200564 451500                    STP1    @A$+1,,AUTO
        22 002464   200055 633500                    EPPR3   ID8$,,AUTO
        22 002465   200563 453500                    STP3    COUNT+5,,AUTO
        22 002466   006115 701000 22                 TSX1    ADD_A_AND_B_GIVING_C
        22 002467   000000 011000                    NOP     0

     1742    19231
     1743    19232    7                    END ; /* TALLYING */

     1744    19233
     1745    19234    7                    IF DELIMITER THEN DO ; /* ID5 EXISTS */

  19234 22 002470   200034 234100                    SZN     DELIMITER,,AUTO
        22 002471   002602 605000 22                 TPL     s:20016

     1746    19235
     1747    19236                           /* ID5 = ID2 */
     1748    19237
     1749    19238          /*               B.ALL TURNED OFF BY PREPARE_ID2
     1750    19239                           CALL Z8E7$MOVE (ID5$, ID2$) ;
     1751    19240          */
     1752    19241    7                      IF ID5$ -> LX_ETT_ITEM.TYPE = %TYE OR ID5$ -> LX_ETT_ITEM.TYPE =
             19241                               %TYB THEN

  19241 22 002472   200051 470500                    LDP0    ID5$,,AUTO
        22 002473   000004 235100                    LDA     4,,PR0
        22 002474   000006 115007                    CMPA    6,DL
        22 002475   002500 600000 22                 TZE     s:19243
        22 002476   000014 115007                    CMPA    12,DL
        22 002477   002554 601000 22                 TNZ     s:19945

     1753    19242    8                        DO ;

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:301  
     1754    19243    8                          IF ID5$ -> LX_ETT_ITEM.TYPE = %TYE

  19243 22 002500   000006 115007                    CMPA    6,DL
        22 002501   002513 601000 22                 TNZ     s:19245

     1755    19244    8                            THEN CALL Z8CO$CREATE_LIBRARY_BASE (%OP_ASCII_TO_EBCDIC,
             19244                                     TABLE_ETT$) ;

  19244 22 002502   200111 631500                    EPPR1   TABLE_ETT$,,AUTO
        22 002503   200653 451500                    STP1    ID2_ST$+2,,AUTO
        22 002504   000046 236000 23                 LDQ     38
        22 002505   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 002506   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002507   000015 631400 23                 EPPR1   13
        22 002510   000000 701000 xent               TSX1    Z8CO$CREATE_LIBRARY_BASE
        22 002511   000000 011000                    NOP     0
        22 002512   002523 710000 22                 TRA     s:19521

     1756    19245    8                            ELSE CALL Z8CO$CREATE_LIBRARY_BASE (%OP_ASCII_TO_GBCD,
             19245                                     TABLE_ETT$) ;

  19245 22 002513   200111 631500                    EPPR1   TABLE_ETT$,,AUTO
        22 002514   200653 451500                    STP1    ID2_ST$+2,,AUTO
        22 002515   000050 236000 23                 LDQ     40
        22 002516   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 002517   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002520   000015 631400 23                 EPPR1   13
        22 002521   000000 701000 xent               TSX1    Z8CO$CREATE_LIBRARY_BASE
        22 002522   000000 011000                    NOP     0

     1757    19246                               %NEW_ILL (@ID    = %MVT,
     1758    19247                                         @FROM  = ID2$ -> LX_ETT_ITEM.ETT$,
     1759    19248                                         @TABLE = TABLE_ETT$,
     1760    19249                                         @TO    = ID5$ -> LX_ETT_ITEM.ETT$) ;

  19521 22 002523   000034 236000 23                 LDQ     28
        22 002524   200652 756100                    STQ     ID2_ST$+1,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:302  
        22 002525   200051 236100                    LDQ     ID5$,,AUTO
        22 002526   000001 036003                    ADLQ    1,DU
        22 002527   200657 756100                    STQ     ID2_ST$+6,,AUTO
        22 002530   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002531   200656 450500                    STP0    ID2_ST$+5,,AUTO
        22 002532   000052 237000 23                 LDAQ    42
        22 002533   200654 757100                    STAQ    ID2_ST$+3,,AUTO
        22 002534   000011 236000 23                 LDQ     9
        22 002535   200653 756100                    STQ     ID2_ST$+2,,AUTO
        22 002536   200653 630500                    EPPR0   ID2_ST$+2,,AUTO
        22 002537   000032 631400 23                 EPPR1   26
        22 002540   000000 701000 xent               TSX1    Z8AN$NEW_ILL1
        22 002541   000000 011000                    NOP     0

  19522 22 002542   200046 470500                    LDP0    ID2$,,AUTO
        22 002543   000001 236100                    LDQ     1,,PR0
        22 002544   000000 471400 7                  LDP1    ILL$
        22 002545   100001 756100                    STQ     1,,PR1

  19523 22 002546   200111 236100                    LDQ     TABLE_ETT$,,AUTO
        22 002547   100002 756100                    STQ     2,,PR1

  19524 22 002550   200051 470500                    LDP0    ID5$,,AUTO
        22 002551   000001 236100                    LDQ     1,,PR0
        22 002552   100003 756100                    STQ     3,,PR1

     1761    19628    8                        END ;

  19628 22 002553   002602 710000 22                 TRA     s:20016

     1762    19629    7                      ELSE
     1763    19630                             %NEW_ILL (@ID  = %MVAN,
     1764    19631                                       @LOP = ID5$ -> LX_ETT_ITEM.ETT$,
     1765    19632                                       @ROP = ID2$ -> LX_ETT_ITEM.ETT$) ;

  19945 22 002554   000034 236000 23                 LDQ     28
        22 002555   200652 756100                    STQ     ID2_ST$+1,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:303  
        22 002556   200051 236100                    LDQ     ID5$,,AUTO
        22 002557   000001 036003                    ADLQ    1,DU
        22 002560   200657 756100                    STQ     ID2_ST$+6,,AUTO
        22 002561   200652 631500                    EPPR1   ID2_ST$+1,,AUTO
        22 002562   200656 451500                    STP1    ID2_ST$+5,,AUTO
        22 002563   000056 237000 23                 LDAQ    46
        22 002564   200654 757100                    STAQ    ID2_ST$+3,,AUTO
        22 002565   000011 236000 23                 LDQ     9
        22 002566   200653 756100                    STQ     ID2_ST$+2,,AUTO
        22 002567   200653 630500                    EPPR0   ID2_ST$+2,,AUTO
        22 002570   000032 631400 23                 EPPR1   26
        22 002571   000000 701000 xent               TSX1    Z8AN$NEW_ILL1
        22 002572   000000 011000                    NOP     0

  19948 22 002573   200051 470500                    LDP0    ID5$,,AUTO
        22 002574   000001 236100                    LDQ     1,,PR0
        22 002575   000000 471400 7                  LDP1    ILL$
        22 002576   100001 756100                    STQ     1,,PR1

  19949 22 002577   200046 470500                    LDP0    ID2$,,AUTO
        22 002600   000001 236100                    LDQ     1,,PR0
        22 002601   100002 756100                    STQ     2,,PR1

     1766    20011
     1767    20012    7                    END ; /* DELIMITER */

     1768    20013
     1769    20014                         /* ID7 = ID7 + ID6 + LENGTH (ID2) */
     1770    20015
     1771    20016    6                    CALL ADD_A_AND_B_GIVING_C (ID6_PLUS_ID7$, LENGTH_ID2$, ID7$) ;

  20016 22 002602   200054 630500                    EPPR0   ID7$,,AUTO
        22 002603   200565 450500                    STP0    @B$+1,,AUTO
        22 002604   200066 631500                    EPPR1   LENGTH_ID2$,,AUTO
        22 002605   200564 451500                    STP1    @A$+1,,AUTO
        22 002606   200053 633500                    EPPR3   ID6_PLUS_ID7$,,AUTO
        22 002607   200563 453500                    STP3    COUNT+5,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:304  
        22 002610   006115 701000 22                 TSX1    ADD_A_AND_B_GIVING_C
        22 002611   000000 011000                    NOP     0

     1772    20017
     1773    20018    7                    IF ALL THEN DO ;

  20018 22 002612   200021 234100                    SZN     ALL,,AUTO
        22 002613   002616 605000 22                 TPL     s:20026

     1774    20019
     1775    20020    7                      CALL CREATE_ALL_DO_WHILE ;

  20020 22 002614   004033 701000 22                 TSX1    CREATE_ALL_DO_WHILE
        22 002615   000000 011000                    NOP     0

     1776    20021
     1777    20022    7                    END ; /* ALL */

     1778    20023
     1779    20024                         /* GOTO EXIT_INTO_LOOP */
     1780    20025
     1781    20026    7                    IF EXIT_INTO_LOOP$ = ADDR(NIL) THEN DO ;

  20026 22 002616   200042 236100                    LDQ     EXIT_INTO_LOOP$,,AUTO
        22 002617   000005 116000 23                 CMPQ    5
        22 002620   002631 601000 22                 TNZ     s:20032

     1782    20027
     1783    20028    7                      CALL Z8AT$CREATE_TEMPORARY (%PARA, EXIT_INTO_LOOP$) ;

  20028 22 002621   200042 630500                    EPPR0   EXIT_INTO_LOOP$,,AUTO
        22 002622   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 002623   000025 236000 23                 LDQ     21
        22 002624   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 002625   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002626   000015 631400 23                 EPPR1   13
        22 002627   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:305  
        22 002630   000000 011000                    NOP     0

     1784    20029
     1785    20030    7                    END ;

     1786    20031
     1787    20032    6                    CALL Z8EK$BRANCH (EXIT_INTO_LOOP$) ;

  20032 22 002631   200042 630500                    EPPR0   EXIT_INTO_LOOP$,,AUTO
        22 002632   200652 450500                    STP0    ID2_ST$+1,,AUTO
        22 002633   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002634   000013 631400 23                 EPPR1   11
        22 002635   000000 701000 xent               TSX1    Z8EK$BRANCH
        22 002636   000000 011000                    NOP     0

     1788    20033
     1789    20034    6                    IF END_IF$ ~= ADDR(NIL)  THEN

  20034 22 002637   200040 236100                    LDQ     END_IF$,,AUTO
        22 002640   000005 116000 23                 CMPQ    5
        22 002641   002661 600000 22                 TZE     s:20417

     1790    20035    7                      DO;

     1791    20036                             %NEW_ILL (@ID = %DEFLB, @LOP = END_IF$) ;

  20357 22 002642   000034 236000 23                 LDQ     28
        22 002643   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 002644   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002645   200657 450500                    STP0    ID2_ST$+6,,AUTO
        22 002646   000037 236000 23                 LDQ     31
        22 002647   200656 756100                    STQ     ID2_ST$+5,,AUTO
        22 002650   000044 237000 23                 LDAQ    36
        22 002651   200654 757100                    STAQ    ID2_ST$+3,,AUTO
        22 002652   200654 630500                    EPPR0   ID2_ST$+3,,AUTO
        22 002653   000027 631400 23                 EPPR1   23
        22 002654   000000 701000 xent               TSX1    Z8AN$NEW_ILL
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:306  
        22 002655   000000 011000                    NOP     0

  20366 22 002656   200040 236100                    LDQ     END_IF$,,AUTO
        22 002657   000000 470400 7                  LDP0    ILL$
        22 002660   000001 756100                    STQ     1,,PR0

     1792    20415    7                      END;

     1793    20416
     1794    20417    6                    DELIMS$ = DELIMS$ -> LX_ITEM.LINK ;

  20417 22 002661   200036 470500                    LDP0    DELIMS$,,AUTO
        22 002662   000007 236100                    LDQ     7,,PR0
        22 002663   200036 756100                    STQ     DELIMS$,,AUTO

     1795    20418    6                    IF ID1_ST$ -> SCALAR.B.KANJI  THEN

  20418 22 002664   200045 470500                    LDP0    ID1_ST$,,AUTO
        22 002665   000003 236100                    LDQ     3,,PR0
        22 002666   001000 316007                    CANQ    512,DL
        22 002667   002672 600000 22                 TZE     s:20421

     1796    20419    6                      DELIMS$ = ADDR(NIL);

  20419 22 002670   000005 236000 23                 LDQ     5
        22 002671   200036 756100                    STQ     DELIMS$,,AUTO

     1797    20420
     1798    20421    6                  END ; /* WHILE DELIMS$ <> NIL */

  20421 22 002672   200036 236100                    LDQ     DELIMS$,,AUTO
        22 002673   000005 116000 23                 CMPQ    5
        22 002674   002331 601000 22                 TNZ     s:19173

     1799    20422
     1800    20423    5                  IF NOT ID1_ST$ -> SCALAR.B.KANJI  THEN

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:307  
  20423 22 002675   200045 470500                    LDP0    ID1_ST$,,AUTO
        22 002676   000003 236100                    LDQ     3,,PR0
        22 002677   001000 316007                    CANQ    512,DL
        22 002700   002717 601000 22                 TNZ     s:20762

     1801    20424    6                    DO;

     1802    20425                                 /*  Kanji always compares the whole string
     1803    20426                                     so this will never be hit.            */
     1804    20427                           /* ID6 = ID6 + 1 */
     1805    20428
     1806    20429    6                      CALL ADD_A_AND_B_GIVING_C (ID6$, ONE$, ID6$) ;

  20429 22 002701   200052 631500                    EPPR1   ID6$,,AUTO
        22 002702   200565 451500                    STP1    @B$+1,,AUTO
        22 002703   200074 633500                    EPPR3   ONE$,,AUTO
        22 002704   200564 453500                    STP3    @A$+1,,AUTO
        22 002705   200052 634500                    EPPR4   ID6$,,AUTO
        22 002706   200563 454500                    STP4    COUNT+5,,AUTO
        22 002707   006115 701000 22                 TSX1    ADD_A_AND_B_GIVING_C
        22 002710   000000 011000                    NOP     0

     1807    20430
     1808    20431                           /* GOTO INTO_LABEL */
     1809    20432
     1810    20433    6                      CALL Z8EK$BRANCH (INTO_LABEL$) ;

  20433 22 002711   200060 630500                    EPPR0   INTO_LABEL$,,AUTO
        22 002712   200652 450500                    STP0    ID2_ST$+1,,AUTO
        22 002713   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002714   000013 631400 23                 EPPR1   11
        22 002715   000000 701000 xent               TSX1    Z8EK$BRANCH
        22 002716   000000 011000                    NOP     0

     1811    20434
     1812    20435    6                    END;

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:308  
     1813    20436
     1814    20437    5                END ; /* ALL "BY" LENGTHS ARE NOT ONE BYTE */

     1815    20438
     1816    20439                     /* END_INTO: */
     1817    20440
     1818    20441                     %NEW_ILL( @ID = %DEFLB, @LOP = END_INTO$) ;

  20762 22 002717   000034 236000 23                 LDQ     28
        22 002720   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 002721   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002722   200657 450500                    STP0    ID2_ST$+6,,AUTO
        22 002723   000037 236000 23                 LDQ     31
        22 002724   200656 756100                    STQ     ID2_ST$+5,,AUTO
        22 002725   000044 237000 23                 LDAQ    36
        22 002726   200654 757100                    STAQ    ID2_ST$+3,,AUTO
        22 002727   200654 630500                    EPPR0   ID2_ST$+3,,AUTO
        22 002730   000027 631400 23                 EPPR1   23
        22 002731   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        22 002732   000000 011000                    NOP     0

  20771 22 002733   200041 236100                    LDQ     END_INTO$,,AUTO
        22 002734   000000 470400 7                  LDP0    ILL$
        22 002735   000001 756100                    STQ     1,,PR0

     1819    20820
     1820    20821    5                IF DELIMITER THEN DO ;

  20821 22 002736   200034 234100                    SZN     DELIMITER,,AUTO
        22 002737   002750 605000 22                 TPL     s:20831

     1821    20822
     1822    20823                       /* ID5 = ' ' */
     1823    20824
     1824    20825
     1825    20826    5                  CALL Z8E7$MOVE (ID5$, SPACE_LX$) ;

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:309  
  20826 22 002740   200105 631500                    EPPR1   SPACE_LX$,,AUTO
        22 002741   200653 451500                    STP1    ID2_ST$+2,,AUTO
        22 002742   200051 633500                    EPPR3   ID5$,,AUTO
        22 002743   200652 453500                    STP3    ID2_ST$+1,,AUTO
        22 002744   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 002745   000015 631400 23                 EPPR1   13
        22 002746   000000 701000 xent               TSX1    Z8E7$MOVE
        22 002747   000000 011000                    NOP     0

     1826    20827
     1827    20828    5                END ; /* DELIMITER */

     1828    20829                     /*  If kanji, calculate the number of bytes to move  */
     1829    20830
     1830    20831    4                IF ID1_ST$ -> SCALAR.B.KANJI     THEN

  20831 22 002750   200045 470500                    LDP0    ID1_ST$,,AUTO
        22 002751   000003 236100                    LDQ     3,,PR0
        22 002752   001000 316007                    CANQ    512,DL
        22 002753   003030 600000 22                 TZE     s:21599

     1831    20832    5                  DO;

     1832    20833                         %NEW_ILL( @ID  = %AD2I,
     1833    20834                                   @LOP = POSITION$ -> LX_ETT_ITEM.ETT$,
     1834    20835                                   @ROP = ONE$ -> LX_ETT_ITEM.ETT$);

  21148 22 002754   000034 236000 23                 LDQ     28
        22 002755   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 002756   200102 236100                    LDQ     POSITION$,,AUTO
        22 002757   000001 036003                    ADLQ    1,DU
        22 002760   200657 756100                    STQ     ID2_ST$+6,,AUTO
        22 002761   200652 631500                    EPPR1   ID2_ST$+1,,AUTO
        22 002762   200656 451500                    STP1    ID2_ST$+5,,AUTO
        22 002763   000060 237000 23                 LDAQ    48
        22 002764   200654 757100                    STAQ    ID2_ST$+3,,AUTO
        22 002765   000011 236000 23                 LDQ     9
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:310  
        22 002766   200653 756100                    STQ     ID2_ST$+2,,AUTO
        22 002767   200653 630500                    EPPR0   ID2_ST$+2,,AUTO
        22 002770   000032 631400 23                 EPPR1   26
        22 002771   000000 701000 xent               TSX1    Z8AN$NEW_ILL1
        22 002772   000000 011000                    NOP     0

  21151 22 002773   200102 470500                    LDP0    POSITION$,,AUTO
        22 002774   000001 236100                    LDQ     1,,PR0
        22 002775   000000 471400 7                  LDP1    ILL$
        22 002776   100001 756100                    STQ     1,,PR1

  21152 22 002777   200074 470500                    LDP0    ONE$,,AUTO
        22 003000   000001 236100                    LDQ     1,,PR0
        22 003001   100002 756100                    STQ     2,,PR1

     1835    21214                         %NEW_ILL( @ID  = %SB2I,
     1836    21215                                   @LOP = POSITION$ -> LX_ETT_ITEM.ETT$,
     1837    21216                                   @ROP = ID7$ -> LX_ETT_ITEM.ETT$ );

  21529 22 003002   000034 236000 23                 LDQ     28
        22 003003   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 003004   200102 236100                    LDQ     POSITION$,,AUTO
        22 003005   000001 036003                    ADLQ    1,DU
        22 003006   200657 756100                    STQ     ID2_ST$+6,,AUTO
        22 003007   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 003010   200656 450500                    STP0    ID2_ST$+5,,AUTO
        22 003011   000064 237000 23                 LDAQ    52
        22 003012   200654 757100                    STAQ    ID2_ST$+3,,AUTO
        22 003013   000011 236000 23                 LDQ     9
        22 003014   200653 756100                    STQ     ID2_ST$+2,,AUTO
        22 003015   200653 630500                    EPPR0   ID2_ST$+2,,AUTO
        22 003016   000032 631400 23                 EPPR1   26
        22 003017   000000 701000 xent               TSX1    Z8AN$NEW_ILL1
        22 003020   000000 011000                    NOP     0

  21532 22 003021   200102 470500                    LDP0    POSITION$,,AUTO
        22 003022   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:311  
        22 003023   000000 471400 7                  LDP1    ILL$
        22 003024   100001 756100                    STQ     1,,PR1

  21533 22 003025   200054 470500                    LDP0    ID7$,,AUTO
        22 003026   000001 236100                    LDQ     1,,PR0
        22 003027   100002 756100                    STQ     2,,PR1

     1838    21595    5                  END;

     1839    21596
     1840    21597                     /* ID6 = ID6 + POSITION */
     1841    21598
     1842    21599    4                CALL ADD_A_AND_B_GIVING_C (ID6$, POSITION$, ID6$) ;

  21599 22 003030   200052 630500                    EPPR0   ID6$,,AUTO
        22 003031   200565 450500                    STP0    @B$+1,,AUTO
        22 003032   200102 631500                    EPPR1   POSITION$,,AUTO
        22 003033   200564 451500                    STP1    @A$+1,,AUTO
        22 003034   200052 633500                    EPPR3   ID6$,,AUTO
        22 003035   200563 453500                    STP3    COUNT+5,,AUTO
        22 003036   006115 701000 22                 TSX1    ADD_A_AND_B_GIVING_C
        22 003037   000000 011000                    NOP     0

     1843    21600
     1844    21601                     /* ID4 = SUBSTR (ID1, ID7, ID6) */
     1845    21602
     1846    21603    4                CALL Z8EY$SUBSTR (ID1$, ID7$, ID6$, SUBSTR$) ;

  21603 22 003040   200106 630500                    EPPR0   SUBSTR$,,AUTO
        22 003041   200655 450500                    STP0    ID2_ST$+4,,AUTO
        22 003042   200052 631500                    EPPR1   ID6$,,AUTO
        22 003043   200654 451500                    STP1    ID2_ST$+3,,AUTO
        22 003044   200054 633500                    EPPR3   ID7$,,AUTO
        22 003045   200653 453500                    STP3    ID2_ST$+2,,AUTO
        22 003046   200044 634500                    EPPR4   ID1$,,AUTO
        22 003047   200652 454500                    STP4    ID2_ST$+1,,AUTO
        22 003050   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:312  
        22 003051   000027 631400 23                 EPPR1   23
        22 003052   000000 701000 xent               TSX1    Z8EY$SUBSTR
        22 003053   000000 011000                    NOP     0

     1847    21604    4                CALL Z8E7$MOVE (ID4$, SUBSTR$) ;

  21604 22 003054   200106 630500                    EPPR0   SUBSTR$,,AUTO
        22 003055   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 003056   200050 631500                    EPPR1   ID4$,,AUTO
        22 003057   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 003060   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 003061   000015 631400 23                 EPPR1   13
        22 003062   000000 701000 xent               TSX1    Z8E7$MOVE
        22 003063   000000 011000                    NOP     0

     1848    21605
     1849    21606    5                IF TALLYING THEN DO ;

  21606 22 003064   200112 234100                    SZN     TALLYING,,AUTO
        22 003065   003076 605000 22                 TPL     s:21616

     1850    21607
     1851    21608                       /* ID8 = ID8 + 1 */
     1852    21609
     1853    21610    5                  CALL ADD_A_AND_B_GIVING_C (ID8$, ONE$, ID8$) ;

  21610 22 003066   200055 630500                    EPPR0   ID8$,,AUTO
        22 003067   200565 450500                    STP0    @B$+1,,AUTO
        22 003070   200074 631500                    EPPR1   ONE$,,AUTO
        22 003071   200564 451500                    STP1    @A$+1,,AUTO
        22 003072   200055 633500                    EPPR3   ID8$,,AUTO
        22 003073   200563 453500                    STP3    COUNT+5,,AUTO
        22 003074   006115 701000 22                 TSX1    ADD_A_AND_B_GIVING_C
        22 003075   000000 011000                    NOP     0

     1854    21611
     1855    21612    5                END ; /* TALLYING */
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:313  

     1856    21613
     1857    21614                     /* ID7 = ID7 + ID6 */
     1858    21615
     1859    21616    4                CALL Z8E5$MATH_PACK (ID6_PLUS_ID7$, ADD$) ;

  21616 22 003076   200017 630500                    EPPR0   ADD$,,AUTO
        22 003077   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 003100   200053 631500                    EPPR1   ID6_PLUS_ID7$,,AUTO
        22 003101   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 003102   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 003103   000015 631400 23                 EPPR1   13
        22 003104   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        22 003105   000000 011000                    NOP     0

     1860    21617    4                CALL Z8E7$MOVE (ID7$, ADD$) ;

  21617 22 003106   200017 630500                    EPPR0   ADD$,,AUTO
        22 003107   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 003110   200054 631500                    EPPR1   ID7$,,AUTO
        22 003111   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 003112   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 003113   000015 631400 23                 EPPR1   13
        22 003114   000000 701000 xent               TSX1    Z8E7$MOVE
        22 003115   000000 011000                    NOP     0

     1861    21618
     1862    21619                     /* GOTO NOT_OVERFLOW */
     1863    21620
     1864    21621    4                CALL Z8EK$BRANCH( NOT_OVERFLOW_LABEL$ );

  21621 22 003116   200073 630500                    EPPR0   NOT_OVERFLOW_LABEL$,,AUTO
        22 003117   200652 450500                    STP0    ID2_ST$+1,,AUTO
        22 003120   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 003121   000013 631400 23                 EPPR1   11
        22 003122   000000 701000 xent               TSX1    Z8EK$BRANCH
        22 003123   000000 011000                    NOP     0
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:314  

     1865    21622
     1866    21623    4              END ; /* DELIMITED */

  21623 22 003124   003276 710000 22                 TRA     s:21719

     1867    21624
     1868    21625    4              ELSE DO ; /* NO DELIMITED CLAUSE */

     1869    21626
     1870    21627                     /* ID4 = SUBSTR (ID1, ID7, MIN (LENGTH(ID4), LENGTH(ID1) + 1 - ID7) */
     1871    21628
     1872    21629                     %INIT_BINARY_OP (@POINTER = ADD$,
     1873    21630                                      @LOP$    = LENGTH_ID1$,
     1874    21631                                      @OP      = %OP_PLUS,
     1875    21632                                      @ROP$    = ONE$,
     1876    21633                                      @LINE    = "ID1$ -> LX_ETT_ITEM.LINE",
     1877    21634                                      @COLUMN  = "ID1$ -> LX_ETT_ITEM.COLUMN") ;

  21636 22 003125   000005 220003                    LDX0    5,DU
        22 003126   200017 470500                    LDP0    ADD$,,AUTO
        22 003127   000000 740100                    STX0    0,,PR0

  21637 22 003130   000000 221003                    LDX1    0,DU
        22 003131   200017 470500                    LDP0    ADD$,,AUTO
        22 003132   000000 441100                    SXL1    0,,PR0

  21644 22 003133   200044 470500                    LDP0    ID1$,,AUTO
        22 003134   200017 471500                    LDP1    ADD$,,AUTO
        22 003135   000005 235100                    LDA     5,,PR0
        22 003136   100005 755100                    STA     5,,PR1

  21645 22 003137   200044 470500                    LDP0    ID1$,,AUTO
        22 003140   200017 471500                    LDP1    ADD$,,AUTO
        22 003141   000006 235100                    LDA     6,,PR0
        22 003142   100006 755100                    STA     6,,PR1

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:315  
  21646 22 003143   200074 236100                    LDQ     ONE$,,AUTO
        22 003144   200017 470500                    LDP0    ADD$,,AUTO
        22 003145   000002 756100                    STQ     2,,PR0

  21647 22 003146   200065 236100                    LDQ     LENGTH_ID1$,,AUTO
        22 003147   200017 470500                    LDP0    ADD$,,AUTO
        22 003150   000001 756100                    STQ     1,,PR0

  21648 22 003151   000020 235007                    LDA     16,DL
        22 003152   200017 470500                    LDP0    ADD$,,AUTO
        22 003153   000003 755100                    STA     3,,PR0

  21649 22 003154   000005 236000 23                 LDQ     5
        22 003155   200017 470500                    LDP0    ADD$,,AUTO
        22 003156   000007 756100                    STQ     7,,PR0

     1878    21652
     1879    21653                     %INIT_BINARY_OP (@POINTER = SUB$,
     1880    21654                                      @LOP$    = ADD$,
     1881    21655                                      @OP      = %OP_BINARY_MINUS,
     1882    21656                                      @ROP$    = ID7$,
     1883    21657                                      @LINE    = "ID1$ -> LX_ETT_ITEM.LINE",
     1884    21658                                      @COLUMN  = "ID1$ -> LX_ETT_ITEM.COLUMN") ;

  21660 22 003157   200020 470500                    LDP0    SUB$,,AUTO
        22 003160   000000 740100                    STX0    0,,PR0

  21661 22 003161   000000 441100                    SXL1    0,,PR0

  21668 22 003162   200044 471500                    LDP1    ID1$,,AUTO
        22 003163   100005 235100                    LDA     5,,PR1
        22 003164   000005 755100                    STA     5,,PR0

  21669 22 003165   200044 471500                    LDP1    ID1$,,AUTO
        22 003166   100006 235100                    LDA     6,,PR1
        22 003167   000006 755100                    STA     6,,PR0

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:316  
  21670 22 003170   200054 236100                    LDQ     ID7$,,AUTO
        22 003171   000002 756100                    STQ     2,,PR0

  21671 22 003172   200017 236100                    LDQ     ADD$,,AUTO
        22 003173   000001 756100                    STQ     1,,PR0

  21672 22 003174   000021 235007                    LDA     17,DL
        22 003175   000003 755100                    STA     3,,PR0

  21673 22 003176   000005 236000 23                 LDQ     5
        22 003177   000007 756100                    STQ     7,,PR0

     1885    21676
     1886    21677                     %INIT_BINARY_OP (@POINTER = MIN$,
     1887    21678                                      @LOP$    = LENGTH_ID4$,
     1888    21679                                      @OP      = %OP_MINIMUM,
     1889    21680                                      @ROP$    = SUB$,
     1890    21681                                      @LINE    = "ID4$ -> LX_ETT_ITEM.LINE",
     1891    21682                                      @COLUMN  = "ID4$ -> LX_ETT_ITEM.COLUMN") ;

  21684 22 003200   200072 471500                    LDP1    MIN$,,AUTO
        22 003201   100000 740100                    STX0    0,,PR1

  21685 22 003202   200072 471500                    LDP1    MIN$,,AUTO
        22 003203   100000 441100                    SXL1    0,,PR1

  21692 22 003204   200050 471500                    LDP1    ID4$,,AUTO
        22 003205   200072 473500                    LDP3    MIN$,,AUTO
        22 003206   100005 235100                    LDA     5,,PR1
        22 003207   300005 755100                    STA     5,,PR3

  21693 22 003210   200050 471500                    LDP1    ID4$,,AUTO
        22 003211   200072 473500                    LDP3    MIN$,,AUTO
        22 003212   100006 235100                    LDA     6,,PR1
        22 003213   300006 755100                    STA     6,,PR3

  21694 22 003214   200020 236100                    LDQ     SUB$,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:317  
        22 003215   200072 471500                    LDP1    MIN$,,AUTO
        22 003216   100002 756100                    STQ     2,,PR1

  21695 22 003217   200067 236100                    LDQ     LENGTH_ID4$,,AUTO
        22 003220   200072 471500                    LDP1    MIN$,,AUTO
        22 003221   100001 756100                    STQ     1,,PR1

  21696 22 003222   000034 235007                    LDA     28,DL
        22 003223   200072 471500                    LDP1    MIN$,,AUTO
        22 003224   100003 755100                    STA     3,,PR1

  21697 22 003225   000005 236000 23                 LDQ     5
        22 003226   200072 471500                    LDP1    MIN$,,AUTO
        22 003227   100007 756100                    STQ     7,,PR1

     1892    21700
     1893    21701    4                CALL Z8EY$SUBSTR (ID1$, ID7$, MIN$, SUBSTR$) ;

  21701 22 003230   200106 631500                    EPPR1   SUBSTR$,,AUTO
        22 003231   200655 451500                    STP1    ID2_ST$+4,,AUTO
        22 003232   200072 633500                    EPPR3   MIN$,,AUTO
        22 003233   200654 453500                    STP3    ID2_ST$+3,,AUTO
        22 003234   200054 634500                    EPPR4   ID7$,,AUTO
        22 003235   200653 454500                    STP4    ID2_ST$+2,,AUTO
        22 003236   200044 635500                    EPPR5   ID1$,,AUTO
        22 003237   200652 455500                    STP5    ID2_ST$+1,,AUTO
        22 003240   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 003241   000027 631400 23                 EPPR1   23
        22 003242   000000 701000 xent               TSX1    Z8EY$SUBSTR
        22 003243   000000 011000                    NOP     0

     1894    21702    4                CALL Z8E7$MOVE (ID4$, SUBSTR$) ;

  21702 22 003244   200106 630500                    EPPR0   SUBSTR$,,AUTO
        22 003245   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 003246   200050 631500                    EPPR1   ID4$,,AUTO
        22 003247   200652 451500                    STP1    ID2_ST$+1,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:318  
        22 003250   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 003251   000015 631400 23                 EPPR1   13
        22 003252   000000 701000 xent               TSX1    Z8E7$MOVE
        22 003253   000000 011000                    NOP     0

     1895    21703
     1896    21704                     /* ID7 = ID7 + MIN (LENGTH(ID4), LENGTH(ID1) - ID7) */
     1897    21705
     1898    21706    4                CALL ADD_A_AND_B_GIVING_C (ID7$, MIN$, ID7$) ;

  21706 22 003254   200054 630500                    EPPR0   ID7$,,AUTO
        22 003255   200565 450500                    STP0    @B$+1,,AUTO
        22 003256   200072 631500                    EPPR1   MIN$,,AUTO
        22 003257   200564 451500                    STP1    @A$+1,,AUTO
        22 003260   200054 633500                    EPPR3   ID7$,,AUTO
        22 003261   200563 453500                    STP3    COUNT+5,,AUTO
        22 003262   006115 701000 22                 TSX1    ADD_A_AND_B_GIVING_C
        22 003263   000000 011000                    NOP     0

     1899    21707
     1900    21708    5                IF TALLYING THEN DO ;

  21708 22 003264   200112 234100                    SZN     TALLYING,,AUTO
        22 003265   003276 605000 22                 TPL     s:21719

     1901    21709                       /* ID8 = ID8 + 1 */
     1902    21710
     1903    21711    5                  CALL ADD_A_AND_B_GIVING_C (ID8$, ONE$, ID8$) ;

  21711 22 003266   200055 630500                    EPPR0   ID8$,,AUTO
        22 003267   200565 450500                    STP0    @B$+1,,AUTO
        22 003270   200074 631500                    EPPR1   ONE$,,AUTO
        22 003271   200564 451500                    STP1    @A$+1,,AUTO
        22 003272   200055 633500                    EPPR3   ID8$,,AUTO
        22 003273   200563 453500                    STP3    COUNT+5,,AUTO
        22 003274   006115 701000 22                 TSX1    ADD_A_AND_B_GIVING_C
        22 003275   000000 011000                    NOP     0
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:319  

     1904    21712
     1905    21713    5                END ; /* TALLYING */

     1906    21714
     1907    21715    4              END ; /* NO DELIMITED CLAUSE */

     1908    21716
     1909    21717                   /* EXIT_INTO_LOOP: */
     1910    21718
     1911    21719    4              IF EXIT_INTO_LOOP$ ~= ADDR(NIL) THEN DO ;

  21719 22 003276   200042 236100                    LDQ     EXIT_INTO_LOOP$,,AUTO
        22 003277   000005 116000 23                 CMPQ    5
        22 003300   003322 600000 22                 TZE     s:22104

     1912    21720
     1913    21721                     %NEW_ILL (@ID = %DEFLB, @LOP = EXIT_INTO_LOOP$) ;

  22042 22 003301   000034 236000 23                 LDQ     28
        22 003302   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 003303   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 003304   200657 450500                    STP0    ID2_ST$+6,,AUTO
        22 003305   000037 236000 23                 LDQ     31
        22 003306   200656 756100                    STQ     ID2_ST$+5,,AUTO
        22 003307   000044 237000 23                 LDAQ    36
        22 003310   200654 757100                    STAQ    ID2_ST$+3,,AUTO
        22 003311   200654 630500                    EPPR0   ID2_ST$+3,,AUTO
        22 003312   000027 631400 23                 EPPR1   23
        22 003313   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        22 003314   000000 011000                    NOP     0

  22051 22 003315   200042 236100                    LDQ     EXIT_INTO_LOOP$,,AUTO
        22 003316   000000 470400 7                  LDP0    ILL$
        22 003317   000001 756100                    STQ     1,,PR0

     1914    22100    4                EXIT_INTO_LOOP$ = ADDR(NIL) ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:320  

  22100 22 003320   000005 236000 23                 LDQ     5
        22 003321   200042 756100                    STQ     EXIT_INTO_LOOP$,,AUTO

     1915    22101
     1916    22102    4              END ;

     1917    22103
     1918    22104    3              INTO_LIST$ = INTO_LIST$ -> LX_LIST.LINK ;

  22104 22 003322   200061 470500                    LDP0    INTO_LIST$,,AUTO
        22 003323   000007 236100                    LDQ     7,,PR0
        22 003324   200061 756100                    STQ     INTO_LIST$,,AUTO

     1919    22105
     1920    22106    3            END ; /* WHILE INTO_LIST <> NIL */

  22106 22 003325   000005 116000 23                 CMPQ    5
        22 003326   001605 601000 22                 TNZ     s:18578

     1921    22107
     1922    22108          %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:321  
     1923    22109                 /* UNSTRING WRAPUP */
     1924    22110
     1925    22111    3            IF OVERFLOW   THEN DO ;

  22111 22 003327   200076 234100                    SZN     OVERFLOW,,AUTO
        22 003330   003364 605000 22                 TPL     s:22464

     1926    22112
     1927    22113                   /* IF ID7 <= LENGTH(ID1) THEN DO */
     1928    22114
     1929    22115                   %INIT_BINARY_OP( @POINTER = "ADDR(COMPARISON)",
     1930    22116                                    @LOP$ = ID7$,
     1931    22117                                    @OP = %OP_GREATER_THAN,
     1932    22118                                    @ROP$ = LENGTH_ID1$,
     1933    22119                                    @LINE = ID7$ -> LX_ETT_ITEM.LINE,
     1934    22120                                    @COLUMN = ID7$ -> LX_ETT_ITEM.COLUMN );

  22122 22 003331   000005 220003                    LDX0    5,DU
        22 003332   200210 740100                    STX0    COMPARISON,,AUTO

  22123 22 003333   000000 221003                    LDX1    0,DU
        22 003334   200210 441100                    SXL1    COMPARISON,,AUTO

  22130 22 003335   200054 470500                    LDP0    ID7$,,AUTO
        22 003336   000005 235100                    LDA     5,,PR0
        22 003337   200215 755100                    STA     COMPARISON+5,,AUTO

  22131 22 003340   000006 235100                    LDA     6,,PR0
        22 003341   200216 755100                    STA     COMPARISON+6,,AUTO

  22132 22 003342   200065 236100                    LDQ     LENGTH_ID1$,,AUTO
        22 003343   200212 756100                    STQ     COMPARISON+2,,AUTO

  22133 22 003344   200054 236100                    LDQ     ID7$,,AUTO
        22 003345   200211 756100                    STQ     COMPARISON+1,,AUTO

  22134 22 003346   000030 235007                    LDA     24,DL
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:322  
        22 003347   200213 755100                    STA     COMPARISON+3,,AUTO

  22135 22 003350   000005 236000 23                 LDQ     5
        22 003351   200217 756100                    STQ     COMPARISON+7,,AUTO

     1935    22138
     1936    22139    3              CALL Z8EK$BRANCH_FALSE( OVERFLOW_LABEL$, ADDR(COMPARISON));

  22139 22 003352   200210 631500                    EPPR1   COMPARISON,,AUTO
        22 003353   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 003354   200652 633500                    EPPR3   ID2_ST$+1,,AUTO
        22 003355   200655 453500                    STP3    ID2_ST$+4,,AUTO
        22 003356   200077 634500                    EPPR4   OVERFLOW_LABEL$,,AUTO
        22 003357   200654 454500                    STP4    ID2_ST$+3,,AUTO
        22 003360   200654 630500                    EPPR0   ID2_ST$+3,,AUTO
        22 003361   000015 631400 23                 EPPR1   13
        22 003362   000000 701000 xent               TSX1    Z8EK$BRANCH_FALSE
        22 003363   000000 011000                    NOP     0

     1937    22140
     1938    22141    3            END ; /* OVERFLOW */

     1939    22142
     1940    22143                 %NEW_ILL( @ID = %DEFLB, @LOP = NOT_OVERFLOW_LABEL$ );

  22464 22 003364   000034 236000 23                 LDQ     28
        22 003365   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 003366   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 003367   200657 450500                    STP0    ID2_ST$+6,,AUTO
        22 003370   000037 236000 23                 LDQ     31
        22 003371   200656 756100                    STQ     ID2_ST$+5,,AUTO
        22 003372   000044 237000 23                 LDAQ    36
        22 003373   200654 757100                    STAQ    ID2_ST$+3,,AUTO
        22 003374   200654 630500                    EPPR0   ID2_ST$+3,,AUTO
        22 003375   000027 631400 23                 EPPR1   23
        22 003376   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        22 003377   000000 011000                    NOP     0
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:323  

  22473 22 003400   200073 236100                    LDQ     NOT_OVERFLOW_LABEL$,,AUTO
        22 003401   000000 470400 7                  LDP0    ILL$
        22 003402   000001 756100                    STQ     1,,PR0

     1941    22522
     1942    22523    2            IF ID1_ST$ -> SCALAR.B.KANJI    THEN

  22523 22 003403   200045 471500                    LDP1    ID1_ST$,,AUTO
        22 003404   100003 236100                    LDQ     3,,PR1
        22 003405   001000 316007                    CANQ    512,DL
        22 003406   003546 600000 22                 TZE     s:22598

     1943    22524    3              DO;

     1944    22525
     1945    22526                     %INIT_BINARY_OP( @POINTER = PLUS_ONE$,
     1946    22527                                      @OP  = %OP_PLUS,
     1947    22528                                      @LOP$ = ID7$,
     1948    22529                                      @ROP$ = ONE$ );

  22531 22 003407   000005 220003                    LDX0    5,DU
        22 003410   200122 473500                    LDP3    PLUS_ONE$,,AUTO
        22 003411   300000 740100                    STX0    0,,PR3

  22532 22 003412   000000 221003                    LDX1    0,DU
        22 003413   300000 441100                    SXL1    0,,PR3

  22539 22 003414   000133 235000 xsym               LDA     COMCOM+91
        22 003415   300005 755100                    STA     5,,PR3

  22540 22 003416   000134 236000 xsym               LDQ     COMCOM+92
        22 003417   300006 756100                    STQ     6,,PR3

  22541 22 003420   200074 236100                    LDQ     ONE$,,AUTO
        22 003421   300002 756100                    STQ     2,,PR3

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:324  
  22542 22 003422   200054 236100                    LDQ     ID7$,,AUTO
        22 003423   300001 756100                    STQ     1,,PR3

  22543 22 003424   000020 235007                    LDA     16,DL
        22 003425   300003 755100                    STA     3,,PR3

  22544 22 003426   000005 236000 23                 LDQ     5
        22 003427   300007 756100                    STQ     7,,PR3

     1949    22547                     %INIT_BINARY_OP( @POINTER = ID7_DIVIDE_2$,
     1950    22548                                      @OP  = %OP_SLASH,
     1951    22549                                      @LOP$ = PLUS_ONE$,
     1952    22550                                      @ROP$ = TWO$ );

  22552 22 003430   200117 470500                    LDP0    ID7_DIVIDE_2$,,AUTO
        22 003431   000000 740100                    STX0    0,,PR0

  22553 22 003432   200117 470500                    LDP0    ID7_DIVIDE_2$,,AUTO
        22 003433   000000 441100                    SXL1    0,,PR0

  22560 22 003434   000133 236000 xsym               LDQ     COMCOM+91
        22 003435   200117 470500                    LDP0    ID7_DIVIDE_2$,,AUTO
        22 003436   000005 756100                    STQ     5,,PR0

  22561 22 003437   000134 236000 xsym               LDQ     COMCOM+92
        22 003440   200117 470500                    LDP0    ID7_DIVIDE_2$,,AUTO
        22 003441   000006 756100                    STQ     6,,PR0

  22562 22 003442   200115 236100                    LDQ     TWO$,,AUTO
        22 003443   200117 470500                    LDP0    ID7_DIVIDE_2$,,AUTO
        22 003444   000002 756100                    STQ     2,,PR0

  22563 22 003445   200122 236100                    LDQ     PLUS_ONE$,,AUTO
        22 003446   200117 470500                    LDP0    ID7_DIVIDE_2$,,AUTO
        22 003447   000001 756100                    STQ     1,,PR0

  22564 22 003450   000023 235007                    LDA     19,DL
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:325  
        22 003451   200117 470500                    LDP0    ID7_DIVIDE_2$,,AUTO
        22 003452   000003 755100                    STA     3,,PR0

  22565 22 003453   000005 236000 23                 LDQ     5
        22 003454   200117 470500                    LDP0    ID7_DIVIDE_2$,,AUTO
        22 003455   000007 756100                    STQ     7,,PR0

     1953    22568
     1954    22569    3                CALL Z8E5$MATH_PACK( ID7_DIVIDE_2$, ID7_DIVIDE_2$ );

  22569 22 003456   200117 630500                    EPPR0   ID7_DIVIDE_2$,,AUTO
        22 003457   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 003460   200117 634500                    EPPR4   ID7_DIVIDE_2$,,AUTO
        22 003461   200652 454500                    STP4    ID2_ST$+1,,AUTO
        22 003462   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 003463   000015 631400 23                 EPPR1   13
        22 003464   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        22 003465   000000 011000                    NOP     0

     1955    22570    3                CALL Z8E7$MOVE( ID7$, ID7_DIVIDE_2$ );

  22570 22 003466   200117 630500                    EPPR0   ID7_DIVIDE_2$,,AUTO
        22 003467   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 003470   200054 631500                    EPPR1   ID7$,,AUTO
        22 003471   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 003472   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 003473   000015 631400 23                 EPPR1   13
        22 003474   000000 701000 xent               TSX1    Z8E7$MOVE
        22 003475   000000 011000                    NOP     0

     1956    22571
     1957    22572                     %INIT_BINARY_OP( @POINTER = ID6_DIVIDE_2$,
     1958    22573                                      @OP  = %OP_SLASH,
     1959    22574                                      @LOP$ = ID6$,
     1960    22575                                      @ROP$ = TWO$ );

  22577 22 003476   000005 220003                    LDX0    5,DU
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:326  
        22 003477   200120 470500                    LDP0    ID6_DIVIDE_2$,,AUTO
        22 003500   000000 740100                    STX0    0,,PR0

  22578 22 003501   000000 221003                    LDX1    0,DU
        22 003502   200120 470500                    LDP0    ID6_DIVIDE_2$,,AUTO
        22 003503   000000 441100                    SXL1    0,,PR0

  22585 22 003504   000133 235000 xsym               LDA     COMCOM+91
        22 003505   200120 470500                    LDP0    ID6_DIVIDE_2$,,AUTO
        22 003506   000005 755100                    STA     5,,PR0

  22586 22 003507   000134 235000 xsym               LDA     COMCOM+92
        22 003510   200120 470500                    LDP0    ID6_DIVIDE_2$,,AUTO
        22 003511   000006 755100                    STA     6,,PR0

  22587 22 003512   200115 236100                    LDQ     TWO$,,AUTO
        22 003513   200120 470500                    LDP0    ID6_DIVIDE_2$,,AUTO
        22 003514   000002 756100                    STQ     2,,PR0

  22588 22 003515   200052 236100                    LDQ     ID6$,,AUTO
        22 003516   200120 470500                    LDP0    ID6_DIVIDE_2$,,AUTO
        22 003517   000001 756100                    STQ     1,,PR0

  22589 22 003520   000023 235007                    LDA     19,DL
        22 003521   200120 470500                    LDP0    ID6_DIVIDE_2$,,AUTO
        22 003522   000003 755100                    STA     3,,PR0

  22590 22 003523   000005 236000 23                 LDQ     5
        22 003524   200120 470500                    LDP0    ID6_DIVIDE_2$,,AUTO
        22 003525   000007 756100                    STQ     7,,PR0

     1961    22593
     1962    22594    3                CALL Z8E5$MATH_PACK( ID6_DIVIDE_2$, ID6_DIVIDE_2$ );

  22594 22 003526   200120 630500                    EPPR0   ID6_DIVIDE_2$,,AUTO
        22 003527   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 003530   200120 631500                    EPPR1   ID6_DIVIDE_2$,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:327  
        22 003531   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 003532   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 003533   000015 631400 23                 EPPR1   13
        22 003534   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        22 003535   000000 011000                    NOP     0

     1963    22595    3                CALL Z8E7$MOVE( ID6$, ID6_DIVIDE_2$ );

  22595 22 003536   200120 630500                    EPPR0   ID6_DIVIDE_2$,,AUTO
        22 003537   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 003540   200052 631500                    EPPR1   ID6$,,AUTO
        22 003541   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 003542   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 003543   000015 631400 23                 EPPR1   13
        22 003544   000000 701000 xent               TSX1    Z8E7$MOVE
        22 003545   000000 011000                    NOP     0

     1964    22596
     1965    22597    3              END;

     1966    22598    2            IF NOT_ON_OVERFLOW$ ~= ADDR(NIL)    THEN

  22598 22 003546   200005 470500                    LDP0    @NOT_ON_OVERFLOW$,,AUTO
        22 003547   000000 236100                    LDQ     0,,PR0
        22 003550   000005 116000 23                 CMPQ    5
        22 003551   003572 600000 22                 TZE     s:22620

     1967    22599    3              DO;

     1968    22600                     %APPEND_ILS_LIST( @FROM$ = NOT_ON_OVERFLOW$,
     1969    22601                                       @TO$ = "ADDR(O1COM.ILS_LIST)" );

  22607 22 003552   000000 471500                    LDP1    0,,PR0
        22 003553   100001 236100                    LDQ     1,,PR1
        22 003554   000005 116000 23                 CMPQ    5
        22 003555   003572 600000 22                 TZE     s:22620

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:328  
  22608 22 003556   000017 236000 xsym               LDQ     O1COM+15
        22 003557   000005 116000 23                 CMPQ    5
        22 003560   003564 601000 22                 TNZ     s:22612

  22609 22 003561   100001 236100                    LDQ     1,,PR1
        22 003562   000017 756000 xsym               STQ     O1COM+15

  22610 22 003563   003567 710000 22                 TRA     s:22614

  22612 22 003564   100001 236100                    LDQ     1,,PR1
        22 003565   000020 473400 xsym               LDP3    O1COM+16
        22 003566   300002 756100                    STQ     2,,PR3

  22614 22 003567   000000 471500                    LDP1    0,,PR0
        22 003570   100002 236100                    LDQ     2,,PR1
        22 003571   000020 756000 xsym               STQ     O1COM+16

     1970    22618    3              END;

     1971    22619
     1972    22620    2            CALL Z8EK$BRANCH( END_UNSTRING$ );

  22620 22 003572   200043 631500                    EPPR1   END_UNSTRING$,,AUTO
        22 003573   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 003574   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 003575   000013 631400 23                 EPPR1   11
        22 003576   000000 701000 xent               TSX1    Z8EK$BRANCH
        22 003577   000000 011000                    NOP     0

     1973    22621
     1974    22622    2            IF OVERFLOW OR POINTER THEN

  22622 22 003600   200076 234100                    SZN     OVERFLOW,,AUTO
        22 003601   003604 604000 22                 TMI     s:22945
        22 003602   200100 234100                    SZN     POINTER,,AUTO
        22 003603   003766 605000 22                 TPL     s:23081

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:329  
     1975    22623    3              DO;

     1976    22624                     %NEW_ILL (@ID = %DEFLB, @LOP = OVERFLOW_LABEL$) ;

  22945 22 003604   000034 236000 23                 LDQ     28
        22 003605   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 003606   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 003607   200657 450500                    STP0    ID2_ST$+6,,AUTO
        22 003610   000037 236000 23                 LDQ     31
        22 003611   200656 756100                    STQ     ID2_ST$+5,,AUTO
        22 003612   000044 237000 23                 LDAQ    36
        22 003613   200654 757100                    STAQ    ID2_ST$+3,,AUTO
        22 003614   200654 630500                    EPPR0   ID2_ST$+3,,AUTO
        22 003615   000027 631400 23                 EPPR1   23
        22 003616   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        22 003617   000000 011000                    NOP     0

  22954 22 003620   200077 236100                    LDQ     OVERFLOW_LABEL$,,AUTO
        22 003621   000000 470400 7                  LDP0    ILL$
        22 003622   000001 756100                    STQ     1,,PR0

     1977    23003
     1978    23004    3                IF ID1_ST$ -> SCALAR.B.KANJI   THEN

  23004 22 003623   200045 471500                    LDP1    ID1_ST$,,AUTO
        22 003624   100003 236100                    LDQ     3,,PR1
        22 003625   001000 316007                    CANQ    512,DL
        22 003626   003766 600000 22                 TZE     s:23081

     1979    23005    4                  DO;

     1980    23006
     1981    23007                         %INIT_BINARY_OP( @POINTER = PLUS_ONE$,
     1982    23008                                          @OP  = %OP_PLUS,
     1983    23009                                          @LOP$ = ID7$,
     1984    23010                                          @ROP$ = ONE$ );

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:330  
  23012 22 003627   000005 220003                    LDX0    5,DU
        22 003630   200122 473500                    LDP3    PLUS_ONE$,,AUTO
        22 003631   300000 740100                    STX0    0,,PR3

  23013 22 003632   000000 221003                    LDX1    0,DU
        22 003633   300000 441100                    SXL1    0,,PR3

  23020 22 003634   000133 235000 xsym               LDA     COMCOM+91
        22 003635   300005 755100                    STA     5,,PR3

  23021 22 003636   000134 236000 xsym               LDQ     COMCOM+92
        22 003637   300006 756100                    STQ     6,,PR3

  23022 22 003640   200074 236100                    LDQ     ONE$,,AUTO
        22 003641   300002 756100                    STQ     2,,PR3

  23023 22 003642   200054 236100                    LDQ     ID7$,,AUTO
        22 003643   300001 756100                    STQ     1,,PR3

  23024 22 003644   000020 235007                    LDA     16,DL
        22 003645   300003 755100                    STA     3,,PR3

  23025 22 003646   000005 236000 23                 LDQ     5
        22 003647   300007 756100                    STQ     7,,PR3

     1985    23028                         %INIT_BINARY_OP( @POINTER = ID7_DIVIDE_2$,
     1986    23029                                          @OP  = %OP_SLASH,
     1987    23030                                          @LOP$ = PLUS_ONE$,
     1988    23031                                          @ROP$ = TWO$ );

  23033 22 003650   200117 470500                    LDP0    ID7_DIVIDE_2$,,AUTO
        22 003651   000000 740100                    STX0    0,,PR0

  23034 22 003652   200117 470500                    LDP0    ID7_DIVIDE_2$,,AUTO
        22 003653   000000 441100                    SXL1    0,,PR0

  23041 22 003654   000133 236000 xsym               LDQ     COMCOM+91
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:331  
        22 003655   200117 470500                    LDP0    ID7_DIVIDE_2$,,AUTO
        22 003656   000005 756100                    STQ     5,,PR0

  23042 22 003657   000134 236000 xsym               LDQ     COMCOM+92
        22 003660   200117 470500                    LDP0    ID7_DIVIDE_2$,,AUTO
        22 003661   000006 756100                    STQ     6,,PR0

  23043 22 003662   200115 236100                    LDQ     TWO$,,AUTO
        22 003663   200117 470500                    LDP0    ID7_DIVIDE_2$,,AUTO
        22 003664   000002 756100                    STQ     2,,PR0

  23044 22 003665   200122 236100                    LDQ     PLUS_ONE$,,AUTO
        22 003666   200117 470500                    LDP0    ID7_DIVIDE_2$,,AUTO
        22 003667   000001 756100                    STQ     1,,PR0

  23045 22 003670   000023 235007                    LDA     19,DL
        22 003671   200117 470500                    LDP0    ID7_DIVIDE_2$,,AUTO
        22 003672   000003 755100                    STA     3,,PR0

  23046 22 003673   000005 236000 23                 LDQ     5
        22 003674   200117 470500                    LDP0    ID7_DIVIDE_2$,,AUTO
        22 003675   000007 756100                    STQ     7,,PR0

     1989    23049
     1990    23050    4                    CALL Z8E5$MATH_PACK( ID7_DIVIDE_2$, ID7_DIVIDE_2$ );

  23050 22 003676   200117 630500                    EPPR0   ID7_DIVIDE_2$,,AUTO
        22 003677   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 003700   200117 634500                    EPPR4   ID7_DIVIDE_2$,,AUTO
        22 003701   200652 454500                    STP4    ID2_ST$+1,,AUTO
        22 003702   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 003703   000015 631400 23                 EPPR1   13
        22 003704   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        22 003705   000000 011000                    NOP     0

     1991    23051    4                    CALL Z8E7$MOVE( ID7$, ID7_DIVIDE_2$ );

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:332  
  23051 22 003706   200117 630500                    EPPR0   ID7_DIVIDE_2$,,AUTO
        22 003707   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 003710   200054 631500                    EPPR1   ID7$,,AUTO
        22 003711   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 003712   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 003713   000015 631400 23                 EPPR1   13
        22 003714   000000 701000 xent               TSX1    Z8E7$MOVE
        22 003715   000000 011000                    NOP     0

     1992    23052
     1993    23053                         %INIT_BINARY_OP( @POINTER = ID6_DIVIDE_2$,
     1994    23054                                          @OP  = %OP_SLASH,
     1995    23055                                          @LOP$ = ID6$,
     1996    23056                                          @ROP$ = TWO$ );

  23058 22 003716   000005 220003                    LDX0    5,DU
        22 003717   200120 470500                    LDP0    ID6_DIVIDE_2$,,AUTO
        22 003720   000000 740100                    STX0    0,,PR0

  23059 22 003721   000000 221003                    LDX1    0,DU
        22 003722   200120 470500                    LDP0    ID6_DIVIDE_2$,,AUTO
        22 003723   000000 441100                    SXL1    0,,PR0

  23066 22 003724   000133 235000 xsym               LDA     COMCOM+91
        22 003725   200120 470500                    LDP0    ID6_DIVIDE_2$,,AUTO
        22 003726   000005 755100                    STA     5,,PR0

  23067 22 003727   000134 235000 xsym               LDA     COMCOM+92
        22 003730   200120 470500                    LDP0    ID6_DIVIDE_2$,,AUTO
        22 003731   000006 755100                    STA     6,,PR0

  23068 22 003732   200115 236100                    LDQ     TWO$,,AUTO
        22 003733   200120 470500                    LDP0    ID6_DIVIDE_2$,,AUTO
        22 003734   000002 756100                    STQ     2,,PR0

  23069 22 003735   200052 236100                    LDQ     ID6$,,AUTO
        22 003736   200120 470500                    LDP0    ID6_DIVIDE_2$,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:333  
        22 003737   000001 756100                    STQ     1,,PR0

  23070 22 003740   000023 235007                    LDA     19,DL
        22 003741   200120 470500                    LDP0    ID6_DIVIDE_2$,,AUTO
        22 003742   000003 755100                    STA     3,,PR0

  23071 22 003743   000005 236000 23                 LDQ     5
        22 003744   200120 470500                    LDP0    ID6_DIVIDE_2$,,AUTO
        22 003745   000007 756100                    STQ     7,,PR0

     1997    23074
     1998    23075    4                    CALL Z8E5$MATH_PACK( ID6_DIVIDE_2$, ID6_DIVIDE_2$ );

  23075 22 003746   200120 630500                    EPPR0   ID6_DIVIDE_2$,,AUTO
        22 003747   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 003750   200120 631500                    EPPR1   ID6_DIVIDE_2$,,AUTO
        22 003751   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 003752   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 003753   000015 631400 23                 EPPR1   13
        22 003754   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        22 003755   000000 011000                    NOP     0

     1999    23076    4                    CALL Z8E7$MOVE( ID6$, ID6_DIVIDE_2$ );

  23076 22 003756   200120 630500                    EPPR0   ID6_DIVIDE_2$,,AUTO
        22 003757   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 003760   200052 631500                    EPPR1   ID6$,,AUTO
        22 003761   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 003762   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 003763   000015 631400 23                 EPPR1   13
        22 003764   000000 701000 xent               TSX1    Z8E7$MOVE
        22 003765   000000 011000                    NOP     0

     2000    23077
     2001    23078    4                  END;

     2002    23079    3              END;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:334  

     2003    23080
     2004    23081    3            IF ON_OVERFLOW$ ~= ADDR(NIL)   THEN DO ;

  23081 22 003766   200004 470500                    LDP0    @ON_OVERFLOW$,,AUTO
        22 003767   000000 236100                    LDQ     0,,PR0
        22 003770   000005 116000 23                 CMPQ    5
        22 003771   004012 600000 22                 TZE     s:23425

     2005    23082
     2006    23083                   %APPEND_ILS_LIST (@TO$   = "ADDR(O1COM.ILS_LIST)",
     2007    23084                                     @FROM$ = ON_OVERFLOW$) ;

  23090 22 003772   000000 471500                    LDP1    0,,PR0
        22 003773   100001 236100                    LDQ     1,,PR1
        22 003774   000005 116000 23                 CMPQ    5
        22 003775   004012 600000 22                 TZE     s:23425

  23091 22 003776   000017 236000 xsym               LDQ     O1COM+15
        22 003777   000005 116000 23                 CMPQ    5
        22 004000   004004 601000 22                 TNZ     s:23095

  23092 22 004001   100001 236100                    LDQ     1,,PR1
        22 004002   000017 756000 xsym               STQ     O1COM+15

  23093 22 004003   004007 710000 22                 TRA     s:23097

  23095 22 004004   100001 236100                    LDQ     1,,PR1
        22 004005   000020 473400 xsym               LDP3    O1COM+16
        22 004006   300002 756100                    STQ     2,,PR3

  23097 22 004007   000000 471500                    LDP1    0,,PR0
        22 004010   100002 236100                    LDQ     2,,PR1
        22 004011   000020 756000 xsym               STQ     O1COM+16

     2008    23101
     2009    23102    3            END ; /* OVERFLOW */
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:335  

     2010    23103
     2011    23104                 %NEW_ILL (@ID = %DEFLB, @LOP = END_UNSTRING$) ;

  23425 22 004012   000034 236000 23                 LDQ     28
        22 004013   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 004014   200652 631500                    EPPR1   ID2_ST$+1,,AUTO
        22 004015   200657 451500                    STP1    ID2_ST$+6,,AUTO
        22 004016   000037 236000 23                 LDQ     31
        22 004017   200656 756100                    STQ     ID2_ST$+5,,AUTO
        22 004020   000044 237000 23                 LDAQ    36
        22 004021   200654 757100                    STAQ    ID2_ST$+3,,AUTO
        22 004022   200654 630500                    EPPR0   ID2_ST$+3,,AUTO
        22 004023   000027 631400 23                 EPPR1   23
        22 004024   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        22 004025   000000 011000                    NOP     0

  23434 22 004026   200043 236100                    LDQ     END_UNSTRING$,,AUTO
        22 004027   000000 470400 7                  LDP0    ILL$
        22 004030   000001 756100                    STQ     1,,PR0

     2012    23483
     2013    23484    2          END ; /* Not optimizable */

     2014    23485
     2015    23486    1          RETURN ;

  23486 22 004031   000000 702200 xent               TSX2  ! X66_ARET

  23425 22 004032                       BAD_UNSTRING null
     2016    23487
     2017    23488    1   BAD_UNSTRING: ;
     2018    23489
     2019    23490    1          RETURN ;

  23490 22 004032   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:336  
     2020    23491
     2021    23492        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:337  
     2022    23493    1   CREATE_ALL_DO_WHILE: PROC ;

  23493 22 004033   200550 741300       CREATE_ALL_* STX1  ! SUB_ONE+8,,AUTO

     2023    23494
     2024    23495        /*I*   NAME: CREATE_ALL_DO_WHILE
     2025    23496
     2026    23497        DESCRIPTION: Create the ILL for the following DO WHILE:
     2027    23498
     2028    23499                  DO WHILE (ID7 + LENGTH(ID2) <= LENGTH(ID1) + 1
     2029    23500                       AND  SUBSTR (ID1, ID7, LENGTH(ID2)) = ID2) ;
     2030    23501                    ADD Length(id2) TO id7
     2031    23502                  END
     2032    23503
     2033    23504                  SIX STEPS TO CREATING A DO WHILE:
     2034    23505                  (1) SAVE O1COM.ILS_LIST
     2035    23506                  (2) SET O1COM.ILS_LIST TO NIL
     2036    23507                  (3) CREATE LOOP BODY
     2037    23508                  (4) SAVE O1COM.ILS_LIST (THE BODY)
     2038    23509                  (5) RESTORE O1COM.ILS_LIST
     2039    23510                  (6) CALL Z8EQ$CREATE_DO_WHILE (CONDITION, BODY)
     2040    23511               */
     2041    23512
     2042    23513    2          DCL  LENGTH_ID1_PLUS_1$  PTR ;
     2043    23514               %DCL_AUTO_LX_ITEM (@NAME = LENGTH_ID1_PLUS_1) ;
     2044    23518
     2045    23519    2          LENGTH_ID1_PLUS_1$ = ADDR (LENGTH_ID1_PLUS_1) ;

  23519 22 004034   200552 630500                    EPPR0   LENGTH_ID1_PLUS_1,,AUTO
        22 004035   200551 450500                    STP0    LENGTH_ID1_PLUS_1$,,AUTO

     2046    23520
     2047    23521
     2048    23522    2          SAVED_ILS_LIST = O1COM.ILS_LIST ;

  23522 22 004036   000100 100400                    MLR     fill='000'O
        22 004037   000016 000040 xsym               ADSC9   O1COM+14                 cn=0,n=32
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:338  
        22 004040   200130 000040                    ADSC9   SAVED_ILS_LIST,,AUTO     cn=0,n=32

     2049    23523               %INIT_ILS_LIST (@POINTER = "ADDR(O1COM.ILS_LIST)") ;

  23525 22 004041   000007 220003                    LDX0    7,DU
        22 004042   000016 740000 xsym               STX0    O1COM+14

  23526 22 004043   000005 236000 23                 LDQ     5
        22 004044   000017 756000 xsym               STQ     O1COM+15

  23527 22 004045   000020 756000 xsym               STQ     O1COM+16

  23528 22 004046   000025 756000 xsym               STQ     O1COM+21

     2050    23531
     2051    23532               /*V* DO_BODY: ADD Length(id2) TO id7 */
     2052    23533
     2053    23534    2          CALL ADD_A_AND_B_GIVING_C ( ID7$, LENGTH_ID2$, ID7$) ;

  23534 22 004047   200054 631500                    EPPR1   ID7$,,AUTO
        22 004050   200565 451500                    STP1    @B$+1,,AUTO
        22 004051   200066 633500                    EPPR3   LENGTH_ID2$,,AUTO
        22 004052   200564 453500                    STP3    @A$+1,,AUTO
        22 004053   200054 634500                    EPPR4   ID7$,,AUTO
        22 004054   200563 454500                    STP4    COUNT+5,,AUTO
        22 004055   006115 701000 22                 TSX1    ADD_A_AND_B_GIVING_C
        22 004056   000000 011000                    NOP     0

     2054    23535
     2055    23536               /*V* WRAPUP DO WHILE */
     2056    23537
     2057    23538    2          DO_BODY_ILS_LIST = O1COM.ILS_LIST ;

  23538 22 004057   000100 100400                    MLR     fill='000'O
        22 004060   000016 000040 xsym               ADSC9   O1COM+14                 cn=0,n=32
        22 004061   200140 000040                    ADSC9   DO_BODY_ILS_LIST,,AUTO   cn=0,n=32

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:339  
     2058    23539    2          O1COM.ILS_LIST = SAVED_ILS_LIST ;

  23539 22 004062   000000 100500                    MLR     fill='000'O
        22 004063   200130 000040                    ADSC9   SAVED_ILS_LIST,,AUTO     cn=0,n=32
        22 004064   000016 000040 xsym               ADSC9   O1COM+14                 cn=0,n=32

     2059    23540
     2060    23541               %INIT_BINARY_OP (@POINTER = LENGTH_ID1_PLUS_1$,
     2061    23542                                @LOP$    = LENGTH_ID1$,
     2062    23543                                @OP      = %OP_PLUS,
     2063    23544                                @ROP$    = ONE$,
     2064    23545                                @LINE    = "ID1$ -> LX_ETT_ITEM.LINE",
     2065    23546                                @COLUMN  = "ID1$ -> LX_ETT_ITEM.COLUMN") ;

  23548 22 004065   000005 220003                    LDX0    5,DU
        22 004066   200551 470500                    LDP0    LENGTH_ID1_PLUS_1$,,AUTO
        22 004067   000000 740100                    STX0    0,,PR0

  23549 22 004070   000000 221003                    LDX1    0,DU
        22 004071   000000 441100                    SXL1    0,,PR0

  23556 22 004072   200044 471500                    LDP1    ID1$,,AUTO
        22 004073   100005 235100                    LDA     5,,PR1
        22 004074   000005 755100                    STA     5,,PR0

  23557 22 004075   200044 471500                    LDP1    ID1$,,AUTO
        22 004076   100006 235100                    LDA     6,,PR1
        22 004077   000006 755100                    STA     6,,PR0

  23558 22 004100   200074 236100                    LDQ     ONE$,,AUTO
        22 004101   000002 756100                    STQ     2,,PR0

  23559 22 004102   200065 236100                    LDQ     LENGTH_ID1$,,AUTO
        22 004103   000001 756100                    STQ     1,,PR0

  23560 22 004104   000020 235007                    LDA     16,DL
        22 004105   000003 755100                    STA     3,,PR0
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:340  

  23561 22 004106   000005 236000 23                 LDQ     5
        22 004107   000007 756100                    STQ     7,,PR0

     2066    23564
     2067    23565               %INIT_BINARY_OP (@POINTER = ADD$,
     2068    23566                                @LOP$    = ID7$,
     2069    23567                                @OP      = %OP_PLUS,
     2070    23568                                @ROP$    = LENGTH_ID2$,
     2071    23569                                @LINE    = "ID2$ -> LX_ETT_ITEM.LINE",
     2072    23570                                @COLUMN  = "ID2$ -> LX_ETT_ITEM.COLUMN") ;

  23572 22 004110   200017 471500                    LDP1    ADD$,,AUTO
        22 004111   100000 740100                    STX0    0,,PR1

  23573 22 004112   200017 471500                    LDP1    ADD$,,AUTO
        22 004113   100000 441100                    SXL1    0,,PR1

  23580 22 004114   200046 471500                    LDP1    ID2$,,AUTO
        22 004115   200017 473500                    LDP3    ADD$,,AUTO
        22 004116   100005 235100                    LDA     5,,PR1
        22 004117   300005 755100                    STA     5,,PR3

  23581 22 004120   200046 471500                    LDP1    ID2$,,AUTO
        22 004121   200017 473500                    LDP3    ADD$,,AUTO
        22 004122   100006 235100                    LDA     6,,PR1
        22 004123   300006 755100                    STA     6,,PR3

  23582 22 004124   200066 236100                    LDQ     LENGTH_ID2$,,AUTO
        22 004125   200017 471500                    LDP1    ADD$,,AUTO
        22 004126   100002 756100                    STQ     2,,PR1

  23583 22 004127   200054 236100                    LDQ     ID7$,,AUTO
        22 004130   200017 471500                    LDP1    ADD$,,AUTO
        22 004131   100001 756100                    STQ     1,,PR1

  23584 22 004132   000020 235007                    LDA     16,DL
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:341  
        22 004133   200017 471500                    LDP1    ADD$,,AUTO
        22 004134   100003 755100                    STA     3,,PR1

  23585 22 004135   000005 236000 23                 LDQ     5
        22 004136   200017 471500                    LDP1    ADD$,,AUTO
        22 004137   100007 756100                    STQ     7,,PR1

     2073    23588
     2074    23589               %INIT_BINARY_OP (@POINTER = COMPARISON$,
     2075    23590                                @LOP$    = ADD$,
     2076    23591                                @OP      = %OP_LESS_THAN_OR_EQUAL,
     2077    23592                                @ROP$    = LENGTH_ID1_PLUS_1$,
     2078    23593                                @LINE    = "ID1$ -> LX_ETT_ITEM.LINE",
     2079    23594                                @COLUMN  = "ID1$ -> LX_ETT_ITEM.COLUMN") ;

  23596 22 004140   200026 471500                    LDP1    COMPARISON$,,AUTO
        22 004141   100000 740100                    STX0    0,,PR1

  23597 22 004142   200026 471500                    LDP1    COMPARISON$,,AUTO
        22 004143   100000 441100                    SXL1    0,,PR1

  23604 22 004144   200044 471500                    LDP1    ID1$,,AUTO
        22 004145   200026 473500                    LDP3    COMPARISON$,,AUTO
        22 004146   100005 235100                    LDA     5,,PR1
        22 004147   300005 755100                    STA     5,,PR3

  23605 22 004150   200044 471500                    LDP1    ID1$,,AUTO
        22 004151   200026 473500                    LDP3    COMPARISON$,,AUTO
        22 004152   100006 235100                    LDA     6,,PR1
        22 004153   300006 755100                    STA     6,,PR3

  23606 22 004154   200551 236100                    LDQ     LENGTH_ID1_PLUS_1$,,AUTO
        22 004155   200026 471500                    LDP1    COMPARISON$,,AUTO
        22 004156   100002 756100                    STQ     2,,PR1

  23607 22 004157   200017 236100                    LDQ     ADD$,,AUTO
        22 004160   200026 471500                    LDP1    COMPARISON$,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:342  
        22 004161   100001 756100                    STQ     1,,PR1

  23608 22 004162   000032 235007                    LDA     26,DL
        22 004163   200026 471500                    LDP1    COMPARISON$,,AUTO
        22 004164   100003 755100                    STA     3,,PR1

  23609 22 004165   000005 236000 23                 LDQ     5
        22 004166   200026 471500                    LDP1    COMPARISON$,,AUTO
        22 004167   100007 756100                    STQ     7,,PR1

     2080    23612
     2081    23613    2          CALL Z8EY$SUBSTR (ID1$, ID7$, LENGTH_ID2$, SUBSTR$) ;

  23613 22 004170   200106 631500                    EPPR1   SUBSTR$,,AUTO
        22 004171   200655 451500                    STP1    ID2_ST$+4,,AUTO
        22 004172   200066 633500                    EPPR3   LENGTH_ID2$,,AUTO
        22 004173   200654 453500                    STP3    ID2_ST$+3,,AUTO
        22 004174   200054 634500                    EPPR4   ID7$,,AUTO
        22 004175   200653 454500                    STP4    ID2_ST$+2,,AUTO
        22 004176   200044 635500                    EPPR5   ID1$,,AUTO
        22 004177   200652 455500                    STP5    ID2_ST$+1,,AUTO
        22 004200   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 004201   000027 631400 23                 EPPR1   23
        22 004202   000000 701000 xent               TSX1    Z8EY$SUBSTR
        22 004203   000000 011000                    NOP     0

     2082    23614
     2083    23615               %INIT_BINARY_OP (@POINTER = COMPARISON2$,
     2084    23616                                @LOP$    = SUBSTR$,
     2085    23617                                @OP      = %OP_EQUAL,
     2086    23618                                @ROP$    = ID2$,
     2087    23619                                @LINE    = "ID2$ -> LX_ETT_ITEM.LINE",
     2088    23620                                @COLUMN  = "ID2$ -> LX_ETT_ITEM.COLUMN") ;

  23622 22 004204   000005 220003                    LDX0    5,DU
        22 004205   200027 470500                    LDP0    COMPARISON2$,,AUTO
        22 004206   000000 740100                    STX0    0,,PR0
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:343  

  23623 22 004207   000000 221003                    LDX1    0,DU
        22 004210   000000 441100                    SXL1    0,,PR0

  23630 22 004211   200046 471500                    LDP1    ID2$,,AUTO
        22 004212   100005 235100                    LDA     5,,PR1
        22 004213   000005 755100                    STA     5,,PR0

  23631 22 004214   200046 471500                    LDP1    ID2$,,AUTO
        22 004215   100006 235100                    LDA     6,,PR1
        22 004216   000006 755100                    STA     6,,PR0

  23632 22 004217   200046 236100                    LDQ     ID2$,,AUTO
        22 004220   000002 756100                    STQ     2,,PR0

  23633 22 004221   200106 236100                    LDQ     SUBSTR$,,AUTO
        22 004222   000001 756100                    STQ     1,,PR0

  23634 22 004223   000027 235007                    LDA     23,DL
        22 004224   000003 755100                    STA     3,,PR0

  23635 22 004225   000005 236000 23                 LDQ     5
        22 004226   000007 756100                    STQ     7,,PR0

     2089    23638
     2090    23639               %INIT_BINARY_OP (@POINTER = AND$,
     2091    23640                                @LOP$    = COMPARISON$,
     2092    23641                                @OP      = %OP_AND,
     2093    23642                                @ROP$    = COMPARISON2$,
     2094    23643                                @LINE    = "ID2$ -> LX_ETT_ITEM.LINE",
     2095    23644                                @COLUMN  = "ID2$ -> LX_ETT_ITEM.COLUMN") ;

  23646 22 004227   200024 471500                    LDP1    AND$,,AUTO
        22 004230   100000 740100                    STX0    0,,PR1

  23647 22 004231   200024 471500                    LDP1    AND$,,AUTO
        22 004232   100000 441100                    SXL1    0,,PR1
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:344  

  23654 22 004233   200046 471500                    LDP1    ID2$,,AUTO
        22 004234   200024 473500                    LDP3    AND$,,AUTO
        22 004235   100005 235100                    LDA     5,,PR1
        22 004236   300005 755100                    STA     5,,PR3

  23655 22 004237   200046 471500                    LDP1    ID2$,,AUTO
        22 004240   200024 473500                    LDP3    AND$,,AUTO
        22 004241   100006 235100                    LDA     6,,PR1
        22 004242   300006 755100                    STA     6,,PR3

  23656 22 004243   200027 236100                    LDQ     COMPARISON2$,,AUTO
        22 004244   200024 471500                    LDP1    AND$,,AUTO
        22 004245   100002 756100                    STQ     2,,PR1

  23657 22 004246   200026 236100                    LDQ     COMPARISON$,,AUTO
        22 004247   200024 471500                    LDP1    AND$,,AUTO
        22 004250   100001 756100                    STQ     1,,PR1

  23658 22 004251   000016 235007                    LDA     14,DL
        22 004252   200024 471500                    LDP1    AND$,,AUTO
        22 004253   100003 755100                    STA     3,,PR1

  23659 22 004254   000005 236000 23                 LDQ     5
        22 004255   200024 471500                    LDP1    AND$,,AUTO
        22 004256   100007 756100                    STQ     7,,PR1

     2096    23662
     2097    23663    2          CALL Z8EQ$CREATE_DO_WHILE (AND$, ADDR(DO_BODY_ILS_LIST)) ;

  23663 22 004257   200140 631500                    EPPR1   DO_BODY_ILS_LIST,,AUTO
        22 004260   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 004261   200652 633500                    EPPR3   ID2_ST$+1,,AUTO
        22 004262   200655 453500                    STP3    ID2_ST$+4,,AUTO
        22 004263   200024 634500                    EPPR4   AND$,,AUTO
        22 004264   200654 454500                    STP4    ID2_ST$+3,,AUTO
        22 004265   200654 630500                    EPPR0   ID2_ST$+3,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:345  
        22 004266   000015 631400 23                 EPPR1   13
        22 004267   000000 701000 xent               TSX1    Z8EQ$CREATE_DO_WHILE
        22 004270   000000 011000                    NOP     0

     2098    23664
     2099    23665    2   END CREATE_ALL_DO_WHILE ;

  23665 22 004271   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 004272   000001 702211                    TSX2  ! 1,X1

     2100    23666
     2101    23667        %EJECT;                                                     /*#30498*/
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:346  
     2102    23668        /*I*   NAME: GET_CHAR
     2103    23669        DESCRIPTION: Given a ptr to an LX_ETT_ITEM, get the first character
     2104    23670                     of the constant represented by the LX_ETT_ITEM.
     2105    23671        */
     2106    23672
     2107    23673    1   GET_CHAR: PROC (ID$, ID_CHAR) ;

  23673 22 004273   200550 741300       GET_CHAR     STX1  ! SUB_ONE+8,,AUTO

     2108    23674
     2109    23675    2   DCL    ID$             PTR ;      /* INPUT:  ptr to an LX_ETT_ITEM */
     2110    23676    2   DCL    ID_CHAR$        PTR ;      /* SCRATCH: ptr to the char string */
     2111    23677    2   DCL    ID_CHAR         CHAR (1) ; /* OUTPUT: the character */
     2112    23678
     2113    23679    2          ID_CHAR$ = ID$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP ;

  23679 22 004274   200551 470500                    LDP0    @ID$,,AUTO
        22 004275   000000 471500                    LDP1    0,,PR0
        22 004276   100001 473500                    LDP3    1,,PR1
        22 004277   300001 236100                    LDQ     1,,PR3
        22 004300   200553 756100                    STQ     ID_CHAR$,,AUTO

     2114    23680               %GET_CONSTANT_ADDRESS (@CONSTANT = ID_CHAR$,
     2115    23681                                      @STRING   = ID_CHAR$) ;

  23683 22 004301   200553 474500                    LDP4    ID_CHAR$,,AUTO
        22 004302   400003 234100                    SZN     3,,PR4
        22 004303   004310 605000 22                 TPL     s:23686

  23684 22 004304   400010 475500                    LDP5    8,,PR4
        22 004305   500001 636500                    EPPR6   1,,PR5
        22 004306   200553 456500                    STP6    ID_CHAR$,,AUTO
        22 004307   004312 710000 22                 TRA     s:23689

  23686 22 004310   000010 036003                    ADLQ    8,DU
        22 004311   200553 756100                    STQ     ID_CHAR$,,AUTO

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:347  
     2116    23689    2          ID_CHAR = SUBSTR (ID_CHAR$ -> CHARS, 0, 1) ;

  23689 22 004312   200553 474500                    LDP4    ID_CHAR$,,AUTO
        22 004313   200552 475500                    LDP5    @ID_CHAR,,AUTO
        22 004314   040100 100500                    MLR     fill='040'O
        22 004315   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
        22 004316   500000 000001                    ADSC9   0,,PR5                   cn=0,n=1

     2117    23690
     2118    23691    2   END GET_CHAR ;

  23691 22 004317   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 004320   000001 702211                    TSX2  ! 1,X1

     2119    23692        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:348  
     2120    23693
     2121    23694        /*I*   NAME: MOVE
     2122    23695
     2123    23696        DESCRIPTION: Move Substring (id1$, offset) to id4$
     2124    23697
     2125    23698        */
     2126    23699
     2127    23700    1   MOVE: PROC (ID1$, ID4$, LENGTH, OFFSET) ;

  23700 22 004321   200550 741300       MOVE         STX1  ! SUB_ONE+8,,AUTO

     2128    23701
     2129    23702    2        DCL  ID4$               PTR ;
     2130    23703    2        DCL  ID1$               PTR ;
     2131    23704    2        DCL  OFFSET             SBIN WORD ;
     2132    23705    2        DCL  LENGTH             SBIN WORD ;
     2133    23706    2        DCL  RESULT$            PTR ;
     2134    23707    2        DCL  ORIGINAL_ID1_ETT$  PTR ;
     2135    23708
     2136    23709    2        ORIGINAL_ID1_ETT$ = ID1$ -> LX_ETT_ITEM.ETT$ ;

  23709 22 004322   200551 470500                    LDP0    @ID1$,,AUTO
        22 004323   000000 471500                    LDP1    0,,PR0
        22 004324   100001 236100                    LDQ     1,,PR1
        22 004325   200556 756100                    STQ     ORIGINAL_ID1_ETT$,,AUTO

     2137    23710
     2138    23711    3        IF OFFSET ~= 0 THEN DO ;

  23711 22 004326   200554 473500                    LDP3    @OFFSET,,AUTO
        22 004327   300000 235100                    LDA     0,,PR3
        22 004330   004347 600000 22                 TZE     s:23720

     2139    23712
     2140    23713    3          CALL Z8AF$NEW_OFF (ID1$ -> LX_ETT_ITEM.ETT$,

  23713 22 004331   200555 634500                    EPPR4   RESULT$,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:349  
        22 004332   200654 454500                    STP4    ID2_ST$+3,,AUTO
        22 004333   200554 236100                    LDQ     @OFFSET,,AUTO
        22 004334   200653 756100                    STQ     ID2_ST$+2,,AUTO
        22 004335   100001 635500                    EPPR5   1,,PR1
        22 004336   200652 455500                    STP5    ID2_ST$+1,,AUTO
        22 004337   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 004340   000000 631400 23                 EPPR1   0
        22 004341   000000 701000 xent               TSX1    Z8AF$NEW_OFF
        22 004342   000000 011000                    NOP     0

     2141    23714    3                             OFFSET,
     2142    23715    3                             RESULT$) ;
     2143    23716    3          ID1$ -> LX_ETT_ITEM.ETT$ = RESULT$ ;

  23716 22 004343   200551 470500                    LDP0    @ID1$,,AUTO
        22 004344   000000 471500                    LDP1    0,,PR0
        22 004345   200555 236100                    LDQ     RESULT$,,AUTO
        22 004346   100001 756100                    STQ     1,,PR1

     2144    23717
     2145    23718    3        END ; /* Offset <> 0 */

     2146    23719
     2147    23720    3        IF ID1_LENGTH - OFFSET < LENGTH THEN DO ;

  23720 22 004347   200554 471500                    LDP1    @OFFSET,,AUTO
        22 004350   200064 236100                    LDQ     ID1_LENGTH,,AUTO
        22 004351   100000 136100                    SBLQ    0,,PR1
        22 004352   200553 473500                    LDP3    @LENGTH,,AUTO
        22 004353   300000 116100                    CMPQ    0,,PR3
        22 004354   004401 605000 22                 TPL     s:23730

     2148    23721
     2149    23722    3          CALL Z8AF$NEW_FISS (ID1$ -> LX_ETT_ITEM.ETT$,

  23722 22 004355   000000 474500                    LDP4    0,,PR0
        22 004356   200064 236100                    LDQ     ID1_LENGTH,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:350  
        22 004357   100000 136100                    SBLQ    0,,PR1
        22 004360   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 004361   200555 635500                    EPPR5   RESULT$,,AUTO
        22 004362   200657 455500                    STP5    ID2_ST$+6,,AUTO
        22 004363   000021 236000 23                 LDQ     17
        22 004364   200656 756100                    STQ     ID2_ST$+5,,AUTO
        22 004365   200652 636500                    EPPR6   ID2_ST$+1,,AUTO
        22 004366   200655 456500                    STP6    ID2_ST$+4,,AUTO
        22 004367   400001 637500                    EPPR7   1,,PR4
        22 004370   200654 457500                    STP7    ID2_ST$+3,,AUTO
        22 004371   200654 630500                    EPPR0   ID2_ST$+3,,AUTO
        22 004372   000027 631400 23                 EPPR1   23
        22 004373   000000 701000 xent               TSX1    Z8AF$NEW_FISS
        22 004374   000000 011000                    NOP     0

     2150    23723    3                              ID1_LENGTH - OFFSET,
     2151    23724    3                              %ALPHA_NUMERIC_FISS,
     2152    23725    3                              RESULT$) ;
     2153    23726    3          ID1$ -> LX_ETT_ITEM.ETT$ = RESULT$ ;

  23726 22 004375   200551 470500                    LDP0    @ID1$,,AUTO
        22 004376   000000 471500                    LDP1    0,,PR0
        22 004377   200555 236100                    LDQ     RESULT$,,AUTO
        22 004400   100001 756100                    STQ     1,,PR1

     2154    23727
     2155    23728    3        END ;

     2156    23729
     2157    23730    2        CALL Z8E7$MOVE (ID4$, ID1$) ;

  23730 22 004401   200551 236100                    LDQ     @ID1$,,AUTO
        22 004402   200552 235100                    LDA     @ID4$,,AUTO
        22 004403   200652 757100                    STAQ    ID2_ST$+1,,AUTO
        22 004404   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 004405   000015 631400 23                 EPPR1   13
        22 004406   000000 701000 xent               TSX1    Z8E7$MOVE
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:351  
        22 004407   000000 011000                    NOP     0

     2158    23731
     2159    23732    2        ID1$ -> LX_ETT_ITEM.ETT$ = ORIGINAL_ID1_ETT$ ;

  23732 22 004410   200551 470500                    LDP0    @ID1$,,AUTO
        22 004411   000000 471500                    LDP1    0,,PR0
        22 004412   200556 236100                    LDQ     ORIGINAL_ID1_ETT$,,AUTO
        22 004413   100001 756100                    STQ     1,,PR1

     2160    23733    2        OFFSET = OFFSET + LENGTH ; /* ready for next call to MOVE */

  23733 22 004414   200554 471500                    LDP1    @OFFSET,,AUTO
        22 004415   200553 473500                    LDP3    @LENGTH,,AUTO
        22 004416   100000 236100                    LDQ     0,,PR1
        22 004417   300000 036100                    ADLQ    0,,PR3
        22 004420   100000 756100                    STQ     0,,PR1

     2161    23734
     2162    23735    2   END MOVE ;

  23735 22 004421   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 004422   000001 702211                    TSX2  ! 1,X1

     2163    23736
     2164    23737        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:352  
     2165    23738        /*I*   NAME: VALIDATE_IDn, n = 1 -> 8
     2166    23739
     2167    23740        DESCRIPTION: These routines are used by Pass 2 of Z8EZ$UNSTRING.
     2168    23741                     They validate the semantics of each identifier.
     2169    23742
     2170    23743        */
     2171    23744
     2172    23745        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:353  
     2173    23746    1   VALIDATE_ID1: PROC (ID1$) ;

  23746 22 004423   200550 741300       VALIDATE_ID1 STX1  ! SUB_ONE+8,,AUTO

     2174    23747
     2175    23748    2        DCL ID1$      PTR;
     2176    23749
     2177    23750    3          IF ID1$ -> LX_ITEM.B.ERROR THEN DO ;

  23750 22 004424   200551 470500                    LDP0    @ID1$,,AUTO
        22 004425   000000 471500                    LDP1    0,,PR0
        22 004426   100000 236100                    LDQ     0,,PR1
        22 004427   400000 316007                    CANQ    -131072,DL
        22 004430   004433 600000 22                 TZE     s:23755

     2178    23751    3            PRODUCE_UNSTRING_ILS = FALSE ;

  23751 22 004431   200103 450100                    STZ     PRODUCE_UNSTRING_ILS,,AUTO

     2179    23752    3            RETURN ;

  23752 22 004432   000001 702211                    TSX2  ! 1,X1

     2180    23753    3          END ;
     2181    23754
     2182    23755    3          DO CASE (ID1$ -> LX_ETT_ITEM.TYPE) ;

  23755 22 004433   100004 235100                    LDA     4,,PR1
        22 004434   000006 135007                    SBLA    6,DL
        22 004435   000011 115007                    CMPA    9,DL
        22 004436   004440 602005 22                 TNC     s:23755+5,AL
        22 004437   004467 710000 22                 TRA     s:23763
        22 004440   004451 710000 22                 TRA     s:23757
        22 004441   004467 710000 22                 TRA     s:23763
        22 004442   004451 710000 22                 TRA     s:23757
        22 004443   004467 710000 22                 TRA     s:23763
        22 004444   004467 710000 22                 TRA     s:23763
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:354  
        22 004445   004467 710000 22                 TRA     s:23763
        22 004446   004451 710000 22                 TRA     s:23757
        22 004447   004467 710000 22                 TRA     s:23763
        22 004450   004451 710000 22                 TRA     s:23757

     2183    23756    3            CASE (%TYA, %TYN, %TYE, %TYB) ;

     2184    23757    3              CALL Z8AU$TYPE_DESCRIPTOR (ID1$ -> LX_ETT_ITEM.ETT$,

  23757 22 004451   200124 633500                    EPPR3   TYPE_DESC,,AUTO
        22 004452   200653 453500                    STP3    ID2_ST$+2,,AUTO
        22 004453   100001 634500                    EPPR4   1,,PR1
        22 004454   200652 454500                    STP4    ID2_ST$+1,,AUTO
        22 004455   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 004456   000015 631400 23                 EPPR1   13
        22 004457   000000 701000 xent               TSX1    Z8AU$TYPE_DESCRIPTOR
        22 004460   000000 011000                    NOP     0

     2185    23758    3                                         TYPE_DESC) ;
     2186    23759    3              IF TYPE_DESC.SIZ$ ~= ADDR(NIL)

  23759 22 004461   200126 236100                    LDQ     TYPE_DESC+2,,AUTO
        22 004462   000005 116000 23                 CMPQ    5
        22 004463   004465 600000 22                 TZE     s:23761

     2187    23760    3              THEN OPTIMIZABLE = FALSE ;

  23760 22 004464   200075 450100                    STZ     OPTIMIZABLE,,AUTO

     2188    23761    3              RETURN ;

  23761 22 004465   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 004466   000001 702211                    TSX2  ! 1,X1

     2189    23762    3            CASE (ELSE) ;

     2190    23763    3              CALL Z8AE$ERROR (%E$ALPHANUMERIC_TYPE_EXPECTED,
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:355  

  23763 22 004467   100006 633500                    EPPR3   6,,PR1
        22 004470   200654 453500                    STP3    ID2_ST$+3,,AUTO
        22 004471   100005 634500                    EPPR4   5,,PR1
        22 004472   200653 454500                    STP4    ID2_ST$+2,,AUTO
        22 004473   000066 236000 23                 LDQ     54
        22 004474   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 004475   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 004476   000000 631400 23                 EPPR1   0
        22 004477   000000 701000 xent               TSX1    Z8AE$ERROR
        22 004500   000000 011000                    NOP     0

     2191    23764    3                               ID1$ -> LX_ETT_ITEM.LINE,
     2192    23765    3                               ID1$ -> LX_ETT_ITEM.COLUMN) ;
     2193    23766    3              PRODUCE_UNSTRING_ILS = FALSE ;

  23766 22 004501   200103 450100                    STZ     PRODUCE_UNSTRING_ILS,,AUTO

     2194    23767    3          END ;

     2195    23768
     2196    23769    2   END VALIDATE_ID1;

  23769 22 004502   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 004503   000001 702211                    TSX2  ! 1,X1

     2197    23770        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:356  
     2198    23771    1   VALIDATE_ID2: PROC (ID2$) ;

  23771 22 004504   200550 741300       VALIDATE_ID2 STX1  ! SUB_ONE+8,,AUTO

     2199    23772
     2200    23773    2        DCL ID2$      PTR;
     2201    23774
     2202    23775    3          IF ID2$ -> LX_ITEM.B.ERROR THEN DO ;

  23775 22 004505   200551 470500                    LDP0    @ID2$,,AUTO
        22 004506   000000 471500                    LDP1    0,,PR0
        22 004507   100000 236100                    LDQ     0,,PR1
        22 004510   400000 316007                    CANQ    -131072,DL
        22 004511   004514 600000 22                 TZE     s:23780

     2203    23776    3            PRODUCE_UNSTRING_ILS = FALSE ;

  23776 22 004512   200103 450100                    STZ     PRODUCE_UNSTRING_ILS,,AUTO

     2204    23777    3            RETURN ;

  23777 22 004513   000001 702211                    TSX2  ! 1,X1

     2205    23778    3          END ;
     2206    23779
     2207    23780    2          IF ID2$ -> LX_ITEM.B.ALL

  23780 22 004514   040000 316007                    CANQ    16384,DL
        22 004515   004517 600000 22                 TZE     s:23783

     2208    23781    2          THEN ALL_LENGTH_1 = FALSE ;

  23781 22 004516   200023 450100                    STZ     ALL_LENGTH_1,,AUTO

     2209    23782
     2210    23783    3          DO CASE (ID2$ -> LX_ITEM.ID) ;

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:357  
  23783 22 004517   100000 220100                    LDX0    0,,PR1
        22 004520   000005 100003                    CMPX0   5,DU
        22 004521   004523 602010 22                 TNC     s:23783+4,X0
        22 004522   004610 710000 22                 TRA     s:23811
        22 004523   004612 710000 22                 TRA     s:23816
        22 004524   004610 710000 22                 TRA     s:23811
        22 004525   004610 710000 22                 TRA     s:23811
        22 004526   004610 710000 22                 TRA     s:23811
        22 004527   004530 710000 22                 TRA     s:23792

     2211    23784
     2212    23785    3            CASE (%LX_TERMINAL) ;

     2213    23786
     2214    23787                       /*#31092*/
     2215    23788                       /* Will be taken care of by PREPARE_ID2  */
     2216    23789
     2217    23790    3            CASE (%LX_ETT_ITEM) ;

     2218    23791
     2219    23792    3              ALL_ID2S_ARE_CONSTANT = FALSE ;

  23792 22 004530   200022 450100                    STZ     ALL_ID2S_ARE_CONSTANT,,AUTO

     2220    23793
     2221    23794    4              DO CASE (ID2$ -> LX_ETT_ITEM.TYPE) ;

  23794 22 004531   100004 235100                    LDA     4,,PR1
        22 004532   000006 135007                    SBLA    6,DL
        22 004533   000011 115007                    CMPA    9,DL
        22 004534   004536 602005 22                 TNC     s:23794+5,AL
        22 004535   004574 710000 22                 TRA     s:23803
        22 004536   004547 710000 22                 TRA     s:23796
        22 004537   004574 710000 22                 TRA     s:23803
        22 004540   004547 710000 22                 TRA     s:23796
        22 004541   004574 710000 22                 TRA     s:23803
        22 004542   004574 710000 22                 TRA     s:23803
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:358  
        22 004543   004574 710000 22                 TRA     s:23803
        22 004544   004547 710000 22                 TRA     s:23796
        22 004545   004574 710000 22                 TRA     s:23803
        22 004546   004547 710000 22                 TRA     s:23796

     2222    23795    4                CASE (%TYA, %TYN, %TYE, %TYB) ;

     2223    23796    4                  CALL Z8AU$TYPE_DESCRIPTOR (ID2$ -> LX_ETT_ITEM.ETT$,

  23796 22 004547   200124 633500                    EPPR3   TYPE_DESC,,AUTO
        22 004550   200653 453500                    STP3    ID2_ST$+2,,AUTO
        22 004551   100001 634500                    EPPR4   1,,PR1
        22 004552   200652 454500                    STP4    ID2_ST$+1,,AUTO
        22 004553   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 004554   000015 631400 23                 EPPR1   13
        22 004555   000000 701000 xent               TSX1    Z8AU$TYPE_DESCRIPTOR
        22 004556   000000 011000                    NOP     0

     2224    23797    4                                             TYPE_DESC) ;
     2225    23798    4                  IF ID2$ -> LX_ETT_ITEM.ETT$ -> ETT.ID ~= %TRIAD

  23798 22 004557   200551 470500                    LDP0    @ID2$,,AUTO
        22 004560   000000 471500                    LDP1    0,,PR0
        22 004561   100001 473500                    LDP3    1,,PR1
        22 004562   300000 220100                    LDX0    0,,PR3
        22 004563   000015 100003                    CMPX0   13,DU
        22 004564   004571 601000 22                 TNZ     s:23800
        22 004565   200125 236100                    LDQ     TYPE_DESC+1,,AUTO
        22 004566   007777 376007                    ANQ     4095,DL
        22 004567   000001 116007                    CMPQ    1,DL
        22 004570   004572 600000 22                 TZE     s:23801

     2226    23799    4                  OR TYPE_DESC.DESC.ADSC.N ~= 1
     2227    23800    4                  THEN ALL_LENGTH_1 = FALSE ;

  23800 22 004571   200023 450100                    STZ     ALL_LENGTH_1,,AUTO

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:359  
     2228    23801    4                  RETURN ;

  23801 22 004572   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 004573   000001 702211                    TSX2  ! 1,X1

     2229    23802    4                CASE (ELSE) ;

     2230    23803    4                  CALL Z8AE$ERROR (%E$ALPHANUMERIC_TYPE_EXPECTED,

  23803 22 004574   100006 633500                    EPPR3   6,,PR1
        22 004575   200654 453500                    STP3    ID2_ST$+3,,AUTO
        22 004576   100005 634500                    EPPR4   5,,PR1
        22 004577   200653 454500                    STP4    ID2_ST$+2,,AUTO
        22 004600   000066 236000 23                 LDQ     54
        22 004601   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 004602   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 004603   000000 631400 23                 EPPR1   0
        22 004604   000000 701000 xent               TSX1    Z8AE$ERROR
        22 004605   000000 011000                    NOP     0

     2231    23804    4                                   ID2$ -> LX_ETT_ITEM.LINE,
     2232    23805    4                                   ID2$ -> LX_ETT_ITEM.COLUMN) ;
     2233    23806    4                  PRODUCE_UNSTRING_ILS = FALSE ;

  23806 22 004606   200103 450100                    STZ     PRODUCE_UNSTRING_ILS,,AUTO

     2234    23807    4              END ;

  23807 22 004607   004612 710000 22                 TRA     s:23816

     2235    23808
     2236    23809    3            CASE (ELSE) ;

     2237    23810
     2238    23811    3              ALL_ID2S_ARE_CONSTANT = FALSE ;

  23811 22 004610   200022 450100                    STZ     ALL_ID2S_ARE_CONSTANT,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:360  

     2239    23812    3              ALL_LENGTH_1 = FALSE ;

  23812 22 004611   200023 450100                    STZ     ALL_LENGTH_1,,AUTO

     2240    23813
     2241    23814    3          END ; /* Case */

     2242    23815
     2243    23816    2   END VALIDATE_ID2;

  23816 22 004612   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 004613   000001 702211                    TSX2  ! 1,X1

     2244    23817        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:361  
     2245    23818    1   VALIDATE_ID4: PROC (ID4$) ;

  23818 22 004614   200550 741300       VALIDATE_ID4 STX1  ! SUB_ONE+8,,AUTO

     2246    23819
     2247    23820    2        DCL ID4$      PTR;
     2248    23821
     2249    23822    3          IF ID4$ -> LX_ITEM.B.ERROR THEN DO ;

  23822 22 004615   200551 470500                    LDP0    @ID4$,,AUTO
        22 004616   000000 471500                    LDP1    0,,PR0
        22 004617   100000 236100                    LDQ     0,,PR1
        22 004620   400000 316007                    CANQ    -131072,DL
        22 004621   004624 600000 22                 TZE     s:23827

     2250    23823    3            PRODUCE_UNSTRING_ILS = FALSE ;

  23823 22 004622   200103 450100                    STZ     PRODUCE_UNSTRING_ILS,,AUTO

     2251    23824    3            RETURN ;

  23824 22 004623   000001 702211                    TSX2  ! 1,X1

     2252    23825    3          END ;
     2253    23826
     2254    23827    2        IF ID4$ -> LX_ETT_ITEM.TYPE ~= %TYA

  23827 22 004624   100004 235100                    LDA     4,,PR1
        22 004625   000010 115007                    CMPA    8,DL
        22 004626   004632 600000 22                 TZE     s:23831
        22 004627   000016 115007                    CMPA    14,DL
        22 004630   004632 600000 22                 TZE     s:23831

     2255    23828    2        AND ID4$ -> LX_ETT_ITEM.TYPE ~= %TYN
     2256    23829    2        THEN OPTIMIZABLE = FALSE ;

  23829 22 004631   200075 450100                    STZ     OPTIMIZABLE,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:362  

     2257    23830
     2258    23831    2        CALL Z8CO$DISPL_CHECK(ID4$) ALTRET (BAD);

  23831 22 004632   200551 630500                    EPPR0   @ID4$,,AUTO
        22 004633   000013 631400 23                 EPPR1   11
        22 004634   000000 701000 xent               TSX1    Z8CO$DISPL_CHECK
        22 004635   004723 702000 22                 TSX2    BAD

     2259    23832
     2260    23833    2        IF ID4$ -> LX_ITEM.ID = %LX_ETT_ITEM THEN

  23833 22 004636   200551 470500                    LDP0    @ID4$,,AUTO
        22 004637   000000 471500                    LDP1    0,,PR0
        22 004640   100000 220100                    LDX0    0,,PR1
        22 004641   000004 100003                    CMPX0   4,DU
        22 004642   004703 601000 22                 TNZ     s:23840

     2261    23834    3          DO CASE(ID4$ -> LX_ETT_ITEM.TYPE);

  23834 22 004643   100004 235100                    LDA     4,,PR1
        22 004644   000024 115007                    CMPA    20,DL
        22 004645   004647 602005 22                 TNC     s:23834+4,AL
        22 004646   004703 710000 22                 TRA     s:23840
        22 004647   004673 710000 22                 TRA     s:23836
        22 004650   004703 710000 22                 TRA     s:23840
        22 004651   004703 710000 22                 TRA     s:23840
        22 004652   004673 710000 22                 TRA     s:23836
        22 004653   004703 710000 22                 TRA     s:23840
        22 004654   004703 710000 22                 TRA     s:23840
        22 004655   004703 710000 22                 TRA     s:23840
        22 004656   004703 710000 22                 TRA     s:23840
        22 004657   004703 710000 22                 TRA     s:23840
        22 004660   004703 710000 22                 TRA     s:23840
        22 004661   004703 710000 22                 TRA     s:23840
        22 004662   004673 710000 22                 TRA     s:23836
        22 004663   004703 710000 22                 TRA     s:23840
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:363  
        22 004664   004703 710000 22                 TRA     s:23840
        22 004665   004703 710000 22                 TRA     s:23840
        22 004666   004703 710000 22                 TRA     s:23840
        22 004667   004703 710000 22                 TRA     s:23840
        22 004670   004703 710000 22                 TRA     s:23840
        22 004671   004703 710000 22                 TRA     s:23840
        22 004672   004673 710000 22                 TRA     s:23836

     2262    23835    3            CASE(%TYD, %TYO, %TYF, %TYC);

     2263    23836    3              CALL INTEGER_CHECK(ID4$);

  23836 22 004673   200551 236100                    LDQ     @ID4$,,AUTO
        22 004674   200553 756100                    STQ     @LENGTH,,AUTO
        22 004675   005300 701000 22                 TSX1    INTEGER_CHECK
        22 004676   000000 011000                    NOP     0

     2264    23837    3              CALL Z8CO$P_CHECK(ID4$) ALTRET (BAD);

  23837 22 004677   200551 630500                    EPPR0   @ID4$,,AUTO
        22 004700   000013 631400 23                 EPPR1   11
        22 004701   000000 701000 xent               TSX1    Z8CO$P_CHECK
        22 004702   004723 702000 22                 TSX2    BAD

     2265    23838    3          END /* Case */;

     2266    23839
     2267    23840    2        CALL Z8AU$TYPE_DESCRIPTOR (ID4$ -> LX_ETT_ITEM.ETT$,

  23840 22 004703   200551 470500                    LDP0    @ID4$,,AUTO
        22 004704   000000 471500                    LDP1    0,,PR0
        22 004705   200124 633500                    EPPR3   TYPE_DESC,,AUTO
        22 004706   200653 453500                    STP3    ID2_ST$+2,,AUTO
        22 004707   100001 634500                    EPPR4   1,,PR1
        22 004710   200652 454500                    STP4    ID2_ST$+1,,AUTO
        22 004711   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 004712   000015 631400 23                 EPPR1   13
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:364  
        22 004713   000000 701000 xent               TSX1    Z8AU$TYPE_DESCRIPTOR
        22 004714   000000 011000                    NOP     0

     2268    23841    2                                   TYPE_DESC) ;
     2269    23842    2        IF TYPE_DESC.SIZ$ ~= ADDR(NIL)

  23842 22 004715   200126 236100                    LDQ     TYPE_DESC+2,,AUTO
        22 004716   000005 116000 23                 CMPQ    5
        22 004717   004721 600000 22                 TZE     s:23845

     2270    23843    2        THEN OPTIMIZABLE = FALSE ;

  23843 22 004720   200075 450100                    STZ     OPTIMIZABLE,,AUTO

     2271    23844
     2272    23845    2        RETURN;

  23845 22 004721   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 004722   000001 702211                    TSX2  ! 1,X1

     2273    23846
     2274    23847    2   BAD:
     2275    23848    2        PRODUCE_UNSTRING_ILS = FALSE;

  23848 22 004723   200103 450100       BAD          STZ     PRODUCE_UNSTRING_ILS,,AUTO

     2276    23849
     2277    23850    2   END VALIDATE_ID4;

  23850 22 004724   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 004725   000001 702211                    TSX2  ! 1,X1

     2278    23851        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:365  
     2279    23852    1   VALIDATE_ID5: PROC (ID5$) ;

  23852 22 004726   200550 741300       VALIDATE_ID5 STX1  ! SUB_ONE+8,,AUTO

     2280    23853
     2281    23854    2        DCL ID5$      PTR;
     2282    23855
     2283    23856    3          DO CASE (ID5$ -> LX_ITEM.ID) ;

  23856 22 004727   200551 470500                    LDP0    @ID5$,,AUTO
        22 004730   000000 471500                    LDP1    0,,PR0
        22 004731   100000 220100                    LDX0    0,,PR1
        22 004732   000005 100003                    CMPX0   5,DU
        22 004733   004735 602010 22                 TNC     s:23856+6,X0
        22 004734   005021 710000 22                 TRA     s:23887
        22 004735   005026 710000 22                 TRA     s:23892
        22 004736   005021 710000 22                 TRA     s:23887
        22 004737   005021 710000 22                 TRA     s:23887
        22 004740   005021 710000 22                 TRA     s:23887
        22 004741   004742 710000 22                 TRA     s:23862

     2284    23857
     2285    23858    3            CASE (%LX_TERMINAL) ; /* EMPTY */

     2286    23859
     2287    23860    3            CASE (%LX_ETT_ITEM) ;

     2288    23861
     2289    23862    3              OPTIMIZABLE = FALSE ;

  23862 22 004742   200075 450100                    STZ     OPTIMIZABLE,,AUTO

     2290    23863    4              IF ID5$ -> LX_ITEM.B.ERROR THEN DO ;

  23863 22 004743   100000 236100                    LDQ     0,,PR1
        22 004744   400000 316007                    CANQ    -131072,DL
        22 004745   004750 600000 22                 TZE     s:23868
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:366  

     2291    23864    4                PRODUCE_UNSTRING_ILS = FALSE ;

  23864 22 004746   200103 450100                    STZ     PRODUCE_UNSTRING_ILS,,AUTO

     2292    23865    4                RETURN ;

  23865 22 004747   000001 702211                    TSX2  ! 1,X1

     2293    23866    4              END ;
     2294    23867
     2295    23868    4              DO CASE (ID5$ -> LX_ETT_ITEM.TYPE) ;

  23868 22 004750   100004 235100                    LDA     4,,PR1
        22 004751   000006 135007                    SBLA    6,DL
        22 004752   000011 115007                    CMPA    9,DL
        22 004753   004755 602005 22                 TNC     s:23868+5,AL
        22 004754   004766 710000 22                 TRA     s:23872
        22 004755   005001 710000 22                 TRA     s:23878
        22 004756   004766 710000 22                 TRA     s:23872
        22 004757   005001 710000 22                 TRA     s:23878
        22 004760   004766 710000 22                 TRA     s:23872
        22 004761   004766 710000 22                 TRA     s:23872
        22 004762   004766 710000 22                 TRA     s:23872
        22 004763   005001 710000 22                 TRA     s:23878
        22 004764   004766 710000 22                 TRA     s:23872
        22 004765   005001 710000 22                 TRA     s:23878

     2296    23869    4                CASE (%TYA, %TYN, %TYE, %TYB) ;

     2297    23870                       /* OK */
     2298    23871    4                CASE (ELSE) ;

     2299    23872    4                  CALL Z8AE$ERROR (%E$ALPHANUMERIC_TYPE_EXPECTED,

  23872 22 004766   100006 633500                    EPPR3   6,,PR1
        22 004767   200654 453500                    STP3    ID2_ST$+3,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:367  
        22 004770   100005 634500                    EPPR4   5,,PR1
        22 004771   200653 454500                    STP4    ID2_ST$+2,,AUTO
        22 004772   000066 236000 23                 LDQ     54
        22 004773   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 004774   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 004775   000000 631400 23                 EPPR1   0
        22 004776   000000 701000 xent               TSX1    Z8AE$ERROR
        22 004777   000000 011000                    NOP     0

     2300    23873    4                                   ID5$ -> LX_ETT_ITEM.LINE,
     2301    23874    4                                   ID5$ -> LX_ETT_ITEM.COLUMN) ;
     2302    23875    4                  PRODUCE_UNSTRING_ILS = FALSE ;

  23875 22 005000   200103 450100                    STZ     PRODUCE_UNSTRING_ILS,,AUTO

     2303    23876    4              END ;

     2304    23877
     2305    23878    4              IF DELIMITED = FALSE THEN DO ;

  23878 22 005001   200033 234100                    SZN     DELIMITED,,AUTO
        22 005002   005026 604000 22                 TMI     s:23892

     2306    23879    4                CALL Z8AE$ERROR (%E$ILLEGAL_DELIMITER_CLAUSE,

  23879 22 005003   200551 470500                    LDP0    @ID5$,,AUTO
        22 005004   000000 471500                    LDP1    0,,PR0
        22 005005   100006 633500                    EPPR3   6,,PR1
        22 005006   200654 453500                    STP3    ID2_ST$+3,,AUTO
        22 005007   100005 634500                    EPPR4   5,,PR1
        22 005010   200653 454500                    STP4    ID2_ST$+2,,AUTO
        22 005011   000070 236000 23                 LDQ     56
        22 005012   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 005013   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 005014   000000 631400 23                 EPPR1   0
        22 005015   000000 701000 xent               TSX1    Z8AE$ERROR
        22 005016   000000 011000                    NOP     0
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:368  

     2307    23880    4                                 ID5$ -> LX_ETT_ITEM.LINE,
     2308    23881    4                                 ID5$ -> LX_ETT_ITEM.COLUMN) ;
     2309    23882    4                PRODUCE_UNSTRING_ILS = FALSE ;

  23882 22 005017   200103 450100                    STZ     PRODUCE_UNSTRING_ILS,,AUTO

     2310    23883    4              END ;

  23883 22 005020   005026 710000 22                 TRA     s:23892

     2311    23884
     2312    23885    3            CASE (ELSE) ;

     2313    23886
     2314    23887    3              CALL Z8AE$ERROR (%E$UNEXPECTED_CASE) ;

  23887 22 005021   000072 630400 23                 EPPR0   58
        22 005022   000013 631400 23                 EPPR1   11
        22 005023   000000 701000 xent               TSX1    Z8AE$ERROR
        22 005024   000000 011000                    NOP     0

     2315    23888    3              PRODUCE_UNSTRING_ILS = FALSE ;

  23888 22 005025   200103 450100                    STZ     PRODUCE_UNSTRING_ILS,,AUTO

     2316    23889
     2317    23890    3          END ; /* Case of id5's ID */

     2318    23891
     2319    23892    2   END VALIDATE_ID5;

  23892 22 005026   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 005027   000001 702211                    TSX2  ! 1,X1

     2320    23893        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:369  
     2321    23894    1   VALIDATE_ID6: PROC (ID6$) ;

  23894 22 005030   200550 741300       VALIDATE_ID6 STX1  ! SUB_ONE+8,,AUTO

     2322    23895
     2323    23896    2        DCL ID6$      PTR;
     2324    23897
     2325    23898    3          DO CASE (ID6$ -> LX_ITEM.ID) ;

  23898 22 005031   200551 470500                    LDP0    @ID6$,,AUTO
        22 005032   000000 471500                    LDP1    0,,PR0
        22 005033   100000 220100                    LDX0    0,,PR1
        22 005034   000005 100003                    CMPX0   5,DU
        22 005035   005037 602010 22                 TNC     s:23898+6,X0
        22 005036   005100 710000 22                 TRA     s:23922
        22 005037   005105 710000 22                 TRA     s:23927
        22 005040   005100 710000 22                 TRA     s:23922
        22 005041   005100 710000 22                 TRA     s:23922
        22 005042   005100 710000 22                 TRA     s:23922
        22 005043   005044 710000 22                 TRA     s:23904

     2326    23899
     2327    23900    3            CASE (%LX_TERMINAL) ; /* EMPTY */

     2328    23901
     2329    23902    3            CASE (%LX_ETT_ITEM) ;

     2330    23903
     2331    23904    3              OPTIMIZABLE = FALSE ;

  23904 22 005044   200075 450100                    STZ     OPTIMIZABLE,,AUTO

     2332    23905    4              IF ID6$ -> LX_ITEM.B.ERROR THEN DO ;

  23905 22 005045   100000 236100                    LDQ     0,,PR1
        22 005046   400000 316007                    CANQ    -131072,DL
        22 005047   005052 600000 22                 TZE     s:23910
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:370  

     2333    23906    4                PRODUCE_UNSTRING_ILS = FALSE ;

  23906 22 005050   200103 450100                    STZ     PRODUCE_UNSTRING_ILS,,AUTO

     2334    23907    4                RETURN ;

  23907 22 005051   000001 702211                    TSX2  ! 1,X1

     2335    23908    4              END ;
     2336    23909
     2337    23910    4              IF DELIMITED = FALSE THEN DO ;

  23910 22 005052   200033 234100                    SZN     DELIMITED,,AUTO
        22 005053   005067 604000 22                 TMI     s:23917

     2338    23911    4                CALL Z8AE$ERROR (%E$ILLEGAL_COUNT_CLAUSE,

  23911 22 005054   100006 633500                    EPPR3   6,,PR1
        22 005055   200654 453500                    STP3    ID2_ST$+3,,AUTO
        22 005056   100005 634500                    EPPR4   5,,PR1
        22 005057   200653 454500                    STP4    ID2_ST$+2,,AUTO
        22 005060   000074 236000 23                 LDQ     60
        22 005061   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 005062   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 005063   000000 631400 23                 EPPR1   0
        22 005064   000000 701000 xent               TSX1    Z8AE$ERROR
        22 005065   000000 011000                    NOP     0

     2339    23912    4                                 ID6$ -> LX_ETT_ITEM.LINE,
     2340    23913    4                                 ID6$ -> LX_ETT_ITEM.COLUMN) ;
     2341    23914    4                PRODUCE_UNSTRING_ILS = FALSE ;

  23914 22 005066   200103 450100                    STZ     PRODUCE_UNSTRING_ILS,,AUTO

     2342    23915    4              END ;

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:371  
     2343    23916
     2344    23917    3              CALL Z8CO$INTEGER_CHECK (ID6$) ALTRET (BAD) ;

  23917 22 005067   200551 630500                    EPPR0   @ID6$,,AUTO
        22 005070   000013 631400 23                 EPPR1   11
        22 005071   000000 701000 xent               TSX1    Z8CO$INTEGER_CHECK
        22 005072   005107 702000 22                 TSX2    BAD

     2345    23918    3              CALL Z8CO$P_CHECK       (ID6$) ALTRET (BAD) ;

  23918 22 005073   200551 630500                    EPPR0   @ID6$,,AUTO
        22 005074   000013 631400 23                 EPPR1   11
        22 005075   000000 701000 xent               TSX1    Z8CO$P_CHECK
        22 005076   005107 702000 22                 TSX2    BAD
        22 005077   005105 710000 22                 TRA     s:23927

     2346    23919
     2347    23920    3            CASE (ELSE) ;

     2348    23921
     2349    23922    3              CALL Z8AE$ERROR (%E$UNEXPECTED_CASE) ;

  23922 22 005100   000072 630400 23                 EPPR0   58
        22 005101   000013 631400 23                 EPPR1   11
        22 005102   000000 701000 xent               TSX1    Z8AE$ERROR
        22 005103   000000 011000                    NOP     0

     2350    23923    3              PRODUCE_UNSTRING_ILS = FALSE ;

  23923 22 005104   200103 450100                    STZ     PRODUCE_UNSTRING_ILS,,AUTO

     2351    23924
     2352    23925    3          END ; /* Case of id6's ID */

     2353    23926
     2354    23927    2          RETURN ;

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:372  
  23927 22 005105   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 005106   000001 702211                    TSX2  ! 1,X1

     2355    23928
     2356    23929    2   BAD:   PRODUCE_UNSTRING_ILS = FALSE ;

  23929 22 005107   200103 450100       BAD          STZ     PRODUCE_UNSTRING_ILS,,AUTO

     2357    23930
     2358    23931    2   END VALIDATE_ID6;

  23931 22 005110   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 005111   000001 702211                    TSX2  ! 1,X1

     2359    23932        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:373  
     2360    23933    1   VALIDATE_ID7: PROC (ID7$, ID1$) ;

  23933 22 005112   200550 741300       VALIDATE_ID7 STX1  ! SUB_ONE+8,,AUTO

     2361    23934
     2362    23935    2        DCL ID7$    PTR;
     2363    23936    2        DCL ID1$    PTR;
     2364    23937
     2365    23938    2        DCL ETT$$   PTR;
     2366    23939    2        DCL ID7_MAX SBIN WORD;
     2367    23940    2        DCL ID1_LEN SBIN WORD;
     2368    23941
     2369    23942    2        POINTER = ID7$ ~= ADDR (NIL) ;

  23942 22 005113   400000 220003                    LDX0    -131072,DU
        22 005114   200551 470500                    LDP0    @ID7$,,AUTO
        22 005115   000000 236100                    LDQ     0,,PR0
        22 005116   000005 116000 23                 CMPQ    5
        22 005117   005121 601000 22                 TNZ     s:23942+6
        22 005120   000000 220003                    LDX0    0,DU
        22 005121   000000 636010                    EAQ     0,X0
        22 005122   200100 756100                    STQ     POINTER,,AUTO

     2370    23943
     2371    23944    2        IF POINTER THEN

  23944 22 005123   200100 234100                    SZN     POINTER,,AUTO
        22 005124   005215 605000 22                 TPL     s:23972

     2372    23945    3          DO;

     2373    23946
     2374    23947    3            OPTIMIZABLE = FALSE ;

  23947 22 005125   200075 450100                    STZ     OPTIMIZABLE,,AUTO

     2375    23948    4            IF ID7$ -> LX_ITEM.B.ERROR THEN DO ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:374  

  23948 22 005126   000000 471500                    LDP1    0,,PR0
        22 005127   100000 236100                    LDQ     0,,PR1
        22 005130   400000 316007                    CANQ    -131072,DL
        22 005131   005134 600000 22                 TZE     s:23953

     2376    23949    4              PRODUCE_UNSTRING_ILS = FALSE ;

  23949 22 005132   200103 450100                    STZ     PRODUCE_UNSTRING_ILS,,AUTO

     2377    23950    4              RETURN ;

  23950 22 005133   000001 702211                    TSX2  ! 1,X1

     2378    23951    4            END ;
     2379    23952
     2380    23953    3            CALL Z8CO$INTEGER_CHECK(ID7$) ALTRET (BAD);

  23953 22 005134   200551 630500                    EPPR0   @ID7$,,AUTO
        22 005135   000013 631400 23                 EPPR1   11
        22 005136   000000 701000 xent               TSX1    Z8CO$INTEGER_CHECK
        22 005137   005217 702000 22                 TSX2    BAD

     2381    23954    3            CALL Z8CO$P_CHECK(ID7$) ALTRET (BAD);

  23954 22 005140   200551 630500                    EPPR0   @ID7$,,AUTO
        22 005141   000013 631400 23                 EPPR1   11
        22 005142   000000 701000 xent               TSX1    Z8CO$P_CHECK
        22 005143   005217 702000 22                 TSX2    BAD

     2382    23955
     2383    23956    3            CALL Z8EZ$MAX_VALUE(ID7$, ID7_MAX);

  23956 22 005144   200554 630500                    EPPR0   ID7_MAX,,AUTO
        22 005145   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 005146   200551 236100                    LDQ     @ID7$,,AUTO
        22 005147   200652 756100                    STQ     ID2_ST$+1,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:375  
        22 005150   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 005151   000015 631400 23                 EPPR1   13
        22 005152   000000 701000 xent               TSX1    Z8EZ$MAX_VALUE
        22 005153   000000 011000                    NOP     0

     2384    23957    3            CALL Z8AU$LENGTH_ETT(ID1$ -> LX_ETT_ITEM.ETT$, ETT$$);

  23957 22 005154   200552 470500                    LDP0    @ID1$,,AUTO
        22 005155   000000 471500                    LDP1    0,,PR0
        22 005156   200553 633500                    EPPR3   ETT$$,,AUTO
        22 005157   200653 453500                    STP3    ID2_ST$+2,,AUTO
        22 005160   100001 634500                    EPPR4   1,,PR1
        22 005161   200652 454500                    STP4    ID2_ST$+1,,AUTO
        22 005162   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 005163   000015 631400 23                 EPPR1   13
        22 005164   000000 701000 xent               TSX1    Z8AU$LENGTH_ETT
        22 005165   000000 011000                    NOP     0

     2385    23958
     2386    23959    4            IF ETT$$ -> ETT.ID = %TRIAD THEN DO ; /* Size is constant */

  23959 22 005166   200553 470500                    LDP0    ETT$$,,AUTO
        22 005167   000000 220100                    LDX0    0,,PR0
        22 005170   000015 100003                    CMPX0   13,DU
        22 005171   005215 601000 22                 TNZ     s:23972

     2387    23960
     2388    23961    4              ID1_LEN = ETT$$ -> ETT.LOP -> CONST.CONSTI.WORD1 ;

  23961 22 005172   000001 471500                    LDP1    1,,PR0
        22 005173   100010 235100                    LDA     8,,PR1
        22 005174   200555 755100                    STA     ID1_LEN,,AUTO

     2389    23962
     2390    23963    5              IF ID7_MAX < (1 + ID1_LEN) THEN DO ;

  23963 22 005175   200554 236100                    LDQ     ID7_MAX,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:376  
        22 005176   200555 116100                    CMPQ    ID1_LEN,,AUTO
        22 005177   005215 605400 22                 TPNZ    s:23972

     2391    23964    5                CALL Z8AE$ERROR (%E$ID7_TOO_SMALL,

  23964 22 005200   200551 473500                    LDP3    @ID7$,,AUTO
        22 005201   300000 474500                    LDP4    0,,PR3
        22 005202   400006 635500                    EPPR5   6,,PR4
        22 005203   200654 455500                    STP5    ID2_ST$+3,,AUTO
        22 005204   400005 631500                    EPPR1   5,,PR4
        22 005205   200653 451500                    STP1    ID2_ST$+2,,AUTO
        22 005206   000076 236000 23                 LDQ     62
        22 005207   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 005210   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 005211   000000 631400 23                 EPPR1   0
        22 005212   000000 701000 xent               TSX1    Z8AE$ERROR
        22 005213   000000 011000                    NOP     0

     2392    23965    5                                 ID7$ -> LX_ETT_ITEM.LINE,
     2393    23966    5                                 ID7$ -> LX_ETT_ITEM.COLUMN) ;
     2394    23967    5                PRODUCE_UNSTRING_ILS = FALSE ;

  23967 22 005214   200103 450100                    STZ     PRODUCE_UNSTRING_ILS,,AUTO

     2395    23968    5              END ; /* ID7 max size < ID1 length + 1 */

     2396    23969    4            END ; /* Size is a constant */

     2397    23970    3          END ; /* POINTER clause exists */

     2398    23971
     2399    23972    2        RETURN;

  23972 22 005215   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 005216   000001 702211                    TSX2  ! 1,X1

     2400    23973
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:377  
     2401    23974    2   BAD:
     2402    23975    2        PRODUCE_UNSTRING_ILS = FALSE;

  23975 22 005217   200103 450100       BAD          STZ     PRODUCE_UNSTRING_ILS,,AUTO

     2403    23976
     2404    23977    2   END VALIDATE_ID7;

  23977 22 005220   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 005221   000001 702211                    TSX2  ! 1,X1

     2405    23978        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:378  
     2406    23979    1   VALIDATE_ID8: PROC (ID8$) ;

  23979 22 005222   200550 741300       VALIDATE_ID8 STX1  ! SUB_ONE+8,,AUTO

     2407    23980
     2408    23981    2          DCL ID8$      PTR;
     2409    23982
     2410    23983    2        TALLYING = ID8$ ~= ADDR(NIL) ;

  23983 22 005223   400000 220003                    LDX0    -131072,DU
        22 005224   200551 470500                    LDP0    @ID8$,,AUTO
        22 005225   000000 236100                    LDQ     0,,PR0
        22 005226   000005 116000 23                 CMPQ    5
        22 005227   005231 601000 22                 TNZ     s:23983+6
        22 005230   000000 220003                    LDX0    0,DU
        22 005231   000000 636010                    EAQ     0,X0
        22 005232   200112 756100                    STQ     TALLYING,,AUTO

     2411    23984
     2412    23985    3        IF TALLYING THEN DO ;

  23985 22 005233   200112 234100                    SZN     TALLYING,,AUTO
        22 005234   005273 605000 22                 TPL     s:24011

     2413    23986
     2414    23987    3          OPTIMIZABLE = FALSE ;

  23987 22 005235   200075 450100                    STZ     OPTIMIZABLE,,AUTO

     2415    23988    4          IF ID8$ -> LX_ITEM.B.ERROR THEN DO ;

  23988 22 005236   000000 471500                    LDP1    0,,PR0
        22 005237   100000 236100                    LDQ     0,,PR1
        22 005240   400000 316007                    CANQ    -131072,DL
        22 005241   005244 600000 22                 TZE     s:23993

     2416    23989    4            PRODUCE_UNSTRING_ILS = FALSE ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:379  

  23989 22 005242   200103 450100                    STZ     PRODUCE_UNSTRING_ILS,,AUTO

     2417    23990    4            RETURN ;

  23990 22 005243   000001 702211                    TSX2  ! 1,X1

     2418    23991    4          END ;
     2419    23992
     2420    23993    4          DO CASE (ID8$ -> LX_ITEM.ID) ;

  23993 22 005244   100000 220100                    LDX0    0,,PR1
        22 005245   000005 100003                    CMPX0   5,DU
        22 005246   005250 602010 22                 TNC     s:23993+4,X0
        22 005247   005266 710000 22                 TRA     s:24004
        22 005250   005273 710000 22                 TRA     s:24011
        22 005251   005266 710000 22                 TRA     s:24004
        22 005252   005266 710000 22                 TRA     s:24004
        22 005253   005266 710000 22                 TRA     s:24004
        22 005254   005255 710000 22                 TRA     s:23999

     2421    23994
     2422    23995    4            CASE (%LX_TERMINAL) ; /* EMPTY */

     2423    23996
     2424    23997    4            CASE (%LX_ETT_ITEM) ;

     2425    23998
     2426    23999    4              CALL Z8CO$INTEGER_CHECK (ID8$) ALTRET (BAD) ;

  23999 22 005255   200551 630500                    EPPR0   @ID8$,,AUTO
        22 005256   000013 631400 23                 EPPR1   11
        22 005257   000000 701000 xent               TSX1    Z8CO$INTEGER_CHECK
        22 005260   005275 702000 22                 TSX2    BAD

     2427    24000    4              CALL Z8CO$P_CHECK       (ID8$) ALTRET (BAD) ;

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:380  
  24000 22 005261   200551 630500                    EPPR0   @ID8$,,AUTO
        22 005262   000013 631400 23                 EPPR1   11
        22 005263   000000 701000 xent               TSX1    Z8CO$P_CHECK
        22 005264   005275 702000 22                 TSX2    BAD
        22 005265   005273 710000 22                 TRA     s:24011

     2428    24001
     2429    24002    4            CASE (ELSE) ;

     2430    24003
     2431    24004    4              CALL Z8AE$ERROR (%E$UNEXPECTED_CASE) ;

  24004 22 005266   000072 630400 23                 EPPR0   58
        22 005267   000013 631400 23                 EPPR1   11
        22 005270   000000 701000 xent               TSX1    Z8AE$ERROR
        22 005271   000000 011000                    NOP     0

     2432    24005    4              PRODUCE_UNSTRING_ILS = FALSE ;

  24005 22 005272   200103 450100                    STZ     PRODUCE_UNSTRING_ILS,,AUTO

     2433    24006
     2434    24007    4          END ; /* Case of id6's ID */

     2435    24008
     2436    24009    3        END ;

     2437    24010
     2438    24011    2        RETURN ;

  24011 22 005273   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 005274   000001 702211                    TSX2  ! 1,X1

     2439    24012
     2440    24013    2   BAD:   PRODUCE_UNSTRING_ILS = FALSE ;

  24013 22 005275   200103 450100       BAD          STZ     PRODUCE_UNSTRING_ILS,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:381  

     2441    24014
     2442    24015    2   END VALIDATE_ID8;

  24015 22 005276   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 005277   000001 702211                    TSX2  ! 1,X1

     2443    24016        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:382  
     2444    24017        /*I*   NAME: INTEGER_CHECK
     2445    24018
     2446    24019        DESCRIPTION: This routine issues a warning message if the identifier
     2447    24020                     is not an integer variable.
     2448    24021
     2449    24022        */
     2450    24023    1   INTEGER_CHECK:PROC(ID$);

  24023 22 005300   200552 741300       INTEGER_CHE* STX1  ! @ID1$,,AUTO

     2451    24024
     2452    24025    2        DCL ID$ PTR;
     2453    24026
     2454    24027    2        CALL Z8CO$INTEGER_CHECK_NO_ERROR (ID$)

  24027 22 005301   200553 630500                    EPPR0   @ID$,,AUTO
        22 005302   000013 631400 23                 EPPR1   11
        22 005303   000000 701000 xent               TSX1    Z8CO$INTEGER_CHECK_NO_ERROR
        22 005304   005306 702000 22                 TSX2    s:24042
        22 005305   005325 710000 22                 TRA     s:24064

     2455    24028    3          WHENALTRETURN DO;

     2456    24029                 %CONDITIONAL_ERROR (@LX_ITEM$ = ID$,
     2457    24030                                     @ERROR#   = %E$SHOULD_BE_INTEGER,
     2458    24031                                     @LINE     = ID$ -> LX_ETT_ITEM.LINE,
     2459    24032                                     @COLUMN   = ID$ -> LX_ETT_ITEM.COLUMN);

  24042 22 005306   200553 470500                    LDP0    @ID$,,AUTO
        22 005307   000000 471500                    LDP1    0,,PR0
        22 005310   100000 236100                    LDQ     0,,PR1
        22 005311   400000 316007                    CANQ    -131072,DL
        22 005312   005325 601000 22                 TNZ     s:24064

  24044 22 005313   100006 633500                    EPPR3   6,,PR1
        22 005314   200654 453500                    STP3    ID2_ST$+3,,AUTO
        22 005315   100005 634500                    EPPR4   5,,PR1
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:383  
        22 005316   200653 454500                    STP4    ID2_ST$+2,,AUTO
        22 005317   000100 236000 23                 LDQ     64
        22 005320   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 005321   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 005322   000000 631400 23                 EPPR1   0
        22 005323   000000 701000 xent               TSX1    Z8AE$ERROR
        22 005324   000000 011000                    NOP     0

     2460    24062    3          END;

     2461    24063
     2462    24064    2   END INTEGER_CHECK;

  24064 22 005325   200552 221300                    LDX1  ! @ID1$,,AUTO
        22 005326   000001 702211                    TSX2  ! 1,X1

     2463    24065        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:384  
     2464    24066        /*I*   NAME: PREPARE_IDn, n = 1 -> 8
     2465    24067
     2466    24068        DESCRIPTION: These routines are used by Pass 3 of Z8EZ$UNSTRING.
     2467    24069                     They prepare each operand for use by the general
     2468    24070                     STRING algorithm.  This includes conversions from
     2469    24071                     one type to another, setting the type for a constant,
     2470    24072                     and finding the length of an operand.
     2471    24073
     2472    24074        */
     2473    24075
     2474    24076        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:385  
     2475    24077    1   PREPARE_ID1: PROC (IDENT$, ID1$) ;

  24077 22 005327   200550 741300       PREPARE_ID1  STX1  ! SUB_ONE+8,,AUTO

     2476    24078
     2477    24079    2   DCL  ID1$      PTR ;
     2478    24080    2   DCL  IDENT$    PTR ;
     2479    24081    2   DCL  ID1_ST$   PTR ;
     2480    24082
     2481    24083
     2482    24084    3          IF IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.ID = %SSOP THEN DO ;

  24084 22 005330   200551 470500                    LDP0    @IDENT$,,AUTO
        22 005331   000000 471500                    LDP1    0,,PR0
        22 005332   100001 473500                    LDP3    1,,PR1
        22 005333   300000 220100                    LDX0    0,,PR3
        22 005334   000005 100003                    CMPX0   5,DU
        22 005335   005434 601000 22                 TNZ     s:24115

     2483    24085                 %INIT_LX_ETT_ITEM (@POINTER = ID1$, @TYPE = %TYA) ;

  24087 22 005336   200552 474500                    LDP4    @ID1$,,AUTO
        22 005337   400000 475500                    LDP5    0,,PR4
        22 005340   000004 222003                    LDX2    4,DU
        22 005341   500000 742100                    STX2    0,,PR5

  24088 22 005342   400000 471500                    LDP1    0,,PR4
        22 005343   000000 220003                    LDX0    0,DU
        22 005344   100000 440100                    SXL0    0,,PR1

  24089 22 005345   400000 471500                    LDP1    0,,PR4
        22 005346   000010 235007                    LDA     8,DL
        22 005347   100004 755100                    STA     4,,PR1

  24090 22 005350   400000 471500                    LDP1    0,,PR4
        22 005351   000005 236000 23                 LDQ     5
        22 005352   100007 756100                    STQ     7,,PR1
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:386  

  24091 22 005353   400000 471500                    LDP1    0,,PR4
        22 005354   100001 756100                    STQ     1,,PR1

  24092 22 005355   400000 471500                    LDP1    0,,PR4
        22 005356   000005 236000 23                 LDQ     5
        22 005357   100002 756100                    STQ     2,,PR1

  24094 22 005360   400000 471500                    LDP1    0,,PR4
        22 005361   000133 236000 xsym               LDQ     COMCOM+91
        22 005362   100005 756100                    STQ     5,,PR1

  24095 22 005363   400000 471500                    LDP1    0,,PR4
        22 005364   000134 236000 xsym               LDQ     COMCOM+92
        22 005365   100006 756100                    STQ     6,,PR1

     2484    24107    3            CALL Z8AT$CREATE_TEMP_WITH_BASE (%SCALAR, ID1$ -> LX_ETT_ITEM.ETT$) ;

  24107 22 005366   400000 471500                    LDP1    0,,PR4
        22 005367   100001 633500                    EPPR3   1,,PR1
        22 005370   200653 453500                    STP3    ID2_ST$+2,,AUTO
        22 005371   000017 236000 23                 LDQ     15
        22 005372   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 005373   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 005374   000015 631400 23                 EPPR1   13
        22 005375   000000 701000 xent               TSX1    Z8AT$CREATE_TEMP_WITH_BASE
        22 005376   000000 011000                    NOP     0

     2485    24108    3            ID1_ST$ = ID1$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP ;

  24108 22 005377   200552 470500                    LDP0    @ID1$,,AUTO
        22 005400   000000 471500                    LDP1    0,,PR0
        22 005401   100001 473500                    LDP3    1,,PR1
        22 005402   300001 236100                    LDQ     1,,PR3
        22 005403   200553 756100                    STQ     ID1_ST$,,AUTO

     2486    24109    3            ID1_ST$ -> VARIABLE.TYPE = %TYA ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:387  

  24109 22 005404   000010 220003                    LDX0    8,DU
        22 005405   200553 474500                    LDP4    ID1_ST$,,AUTO
        22 005406   400002 740100                    STX0    2,,PR4

     2487    24110    3            CALL Z8AU$TYPE_DESCRIPTOR (IDENT$ -> LX_ETT_ITEM.ETT$, TYPE_DESC) ;

  24110 22 005407   200551 471500                    LDP1    @IDENT$,,AUTO
        22 005410   100000 473500                    LDP3    0,,PR1
        22 005411   200124 635500                    EPPR5   TYPE_DESC,,AUTO
        22 005412   200653 455500                    STP5    ID2_ST$+2,,AUTO
        22 005413   300001 636500                    EPPR6   1,,PR3
        22 005414   200652 456500                    STP6    ID2_ST$+1,,AUTO
        22 005415   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 005416   000015 631400 23                 EPPR1   13
        22 005417   000000 701000 xent               TSX1    Z8AU$TYPE_DESCRIPTOR
        22 005420   000000 011000                    NOP     0

     2488    24111    3            ID1_ST$ -> VARIABLE.ADSC.N = TYPE_DESC.DESC.ADSC.N ;

  24111 22 005421   200553 470500                    LDP0    ID1_ST$,,AUTO
        22 005422   200125 236100                    LDQ     TYPE_DESC+1,,AUTO
        22 005423   000001 752103                    STCQ    1,'03'O,PR0

     2489    24112    3            CALL Z8E7$MOVE (ID1$, IDENT$) ;

  24112 22 005424   200551 236100                    LDQ     @IDENT$,,AUTO
        22 005425   200552 235100                    LDA     @ID1$,,AUTO
        22 005426   200652 757100                    STAQ    ID2_ST$+1,,AUTO
        22 005427   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 005430   000015 631400 23                 EPPR1   13
        22 005431   000000 701000 xent               TSX1    Z8E7$MOVE
        22 005432   000000 011000                    NOP     0

     2490    24113    3          END ;

  24113 22 005433   005441 710000 22                 TRA     s:24118
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:388  

     2491    24114    3          ELSE DO ; /* ID1 IS NOT SUBSCRIPTED */

     2492    24115    3            ID1$ -> LX_ETT_ITEM = IDENT$ -> LX_ETT_ITEM ;

  24115 22 005434   200552 474500                    LDP4    @ID1$,,AUTO
        22 005435   400000 475500                    LDP5    0,,PR4
        22 005436   000100 100500                    MLR     fill='000'O
        22 005437   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32
        22 005440   500000 000040                    ADSC9   0,,PR5                   cn=0,n=32

     2493    24116    3          END ;

     2494    24117
     2495    24118    2          CALL Z8AU$LENGTH (ID1$ -> LX_ETT_ITEM.ETT$, LENGTH_ID1$) ;

  24118 22 005441   200552 470500                    LDP0    @ID1$,,AUTO
        22 005442   000000 471500                    LDP1    0,,PR0
        22 005443   200065 633500                    EPPR3   LENGTH_ID1$,,AUTO
        22 005444   200653 453500                    STP3    ID2_ST$+2,,AUTO
        22 005445   100001 634500                    EPPR4   1,,PR1
        22 005446   200652 454500                    STP4    ID2_ST$+1,,AUTO
        22 005447   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 005450   000015 631400 23                 EPPR1   13
        22 005451   000000 701000 xent               TSX1    Z8AU$LENGTH
        22 005452   000000 011000                    NOP     0

     2496    24119
     2497    24120    2   END PREPARE_ID1  ;

  24120 22 005453   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 005454   000001 702211                    TSX2  ! 1,X1

     2498    24121
     2499    24122        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:389  
     2500    24123    1   PREPARE_ID2: PROC (DELIMITED$, ID2$) ;

  24123 22 005455   200646 741300       PREPARE_ID2  STX1  ! DELIMS$$+2,,AUTO

     2501    24124
     2502    24125    2   DCL  DELIMITED$  PTR ;
     2503    24126    2   DCL  ID2$        PTR ;
     2504    24127    2   DCL  ID2_ST$     PTR ;
     2505    24128
     2506    24129    2          IF  DELIMITED$ -> LX_ITEM.ID = %LX_ETT_ITEM

  24129 22 005456   200647 470500                    LDP0    @DELIMITED$,,AUTO
        22 005457   000000 471500                    LDP1    0,,PR0
        22 005460   100000 220100                    LDX0    0,,PR1
        22 005461   000004 100003                    CMPX0   4,DU
        22 005462   005573 601000 22                 TNZ     s:24162
        22 005463   100001 473500                    LDP3    1,,PR1
        22 005464   300000 222100                    LDX2    0,,PR3
        22 005465   000005 102003                    CMPX2   5,DU
        22 005466   005573 601000 22                 TNZ     s:24162

     2507    24130    3          AND DELIMITED$ -> LX_ETT_ITEM.ETT$ -> ETT.ID = %SSOP THEN DO ;

     2508    24131                 %INIT_LX_ETT_ITEM (@POINTER = ID2$, @TYPE = %TYA) ;

  24133 22 005467   200650 474500                    LDP4    @ID2$,,AUTO
        22 005470   400000 475500                    LDP5    0,,PR4
        22 005471   000004 223003                    LDX3    4,DU
        22 005472   500000 743100                    STX3    0,,PR5

  24134 22 005473   400000 471500                    LDP1    0,,PR4
        22 005474   000000 220003                    LDX0    0,DU
        22 005475   100000 440100                    SXL0    0,,PR1

  24135 22 005476   400000 471500                    LDP1    0,,PR4
        22 005477   000010 235007                    LDA     8,DL
        22 005500   100004 755100                    STA     4,,PR1
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:390  

  24136 22 005501   400000 471500                    LDP1    0,,PR4
        22 005502   000005 236000 23                 LDQ     5
        22 005503   100007 756100                    STQ     7,,PR1

  24137 22 005504   400000 471500                    LDP1    0,,PR4
        22 005505   100001 756100                    STQ     1,,PR1

  24138 22 005506   400000 471500                    LDP1    0,,PR4
        22 005507   000005 236000 23                 LDQ     5
        22 005510   100002 756100                    STQ     2,,PR1

  24140 22 005511   400000 471500                    LDP1    0,,PR4
        22 005512   000133 236000 xsym               LDQ     COMCOM+91
        22 005513   100005 756100                    STQ     5,,PR1

  24141 22 005514   400000 471500                    LDP1    0,,PR4
        22 005515   000134 236000 xsym               LDQ     COMCOM+92
        22 005516   100006 756100                    STQ     6,,PR1

     2509    24153    3            CALL Z8AT$CREATE_TEMP_WITH_BASE (%SCALAR, ID2$ -> LX_ETT_ITEM.ETT$) ;

  24153 22 005517   400000 471500                    LDP1    0,,PR4
        22 005520   100001 633500                    EPPR3   1,,PR1
        22 005521   200653 453500                    STP3    ID2_ST$+2,,AUTO
        22 005522   000017 236000 23                 LDQ     15
        22 005523   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 005524   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 005525   000015 631400 23                 EPPR1   13
        22 005526   000000 701000 xent               TSX1    Z8AT$CREATE_TEMP_WITH_BASE
        22 005527   000000 011000                    NOP     0

     2510    24154    3            ID2_ST$ = ID2$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP ;

  24154 22 005530   200650 470500                    LDP0    @ID2$,,AUTO
        22 005531   000000 471500                    LDP1    0,,PR0
        22 005532   100001 473500                    LDP3    1,,PR1
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:391  
        22 005533   300001 236100                    LDQ     1,,PR3
        22 005534   200651 756100                    STQ     ID2_ST$,,AUTO

     2511    24155    3            ID2_ST$ -> VARIABLE.TYPE = %TYA ;

  24155 22 005535   000010 220003                    LDX0    8,DU
        22 005536   200651 474500                    LDP4    ID2_ST$,,AUTO
        22 005537   400002 740100                    STX0    2,,PR4

     2512    24156    3            CALL Z8AU$TYPE_DESCRIPTOR (DELIMITED$ -> LX_ETT_ITEM.ETT$, TYPE_DESC) ;

  24156 22 005540   200647 471500                    LDP1    @DELIMITED$,,AUTO
        22 005541   100000 473500                    LDP3    0,,PR1
        22 005542   200124 635500                    EPPR5   TYPE_DESC,,AUTO
        22 005543   200653 455500                    STP5    ID2_ST$+2,,AUTO
        22 005544   300001 636500                    EPPR6   1,,PR3
        22 005545   200652 456500                    STP6    ID2_ST$+1,,AUTO
        22 005546   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 005547   000015 631400 23                 EPPR1   13
        22 005550   000000 701000 xent               TSX1    Z8AU$TYPE_DESCRIPTOR
        22 005551   000000 011000                    NOP     0

     2513    24157    3            ID2_ST$ -> VARIABLE.ADSC.N = TYPE_DESC.DESC.ADSC.N ;

  24157 22 005552   200651 470500                    LDP0    ID2_ST$,,AUTO
        22 005553   200125 236100                    LDQ     TYPE_DESC+1,,AUTO
        22 005554   000001 752103                    STCQ    1,'03'O,PR0

     2514    24158    3            CALL Z8E7$MOVE (ID2$, DELIMITED$) ;

  24158 22 005555   200647 236100                    LDQ     @DELIMITED$,,AUTO
        22 005556   200650 235100                    LDA     @ID2$,,AUTO
        22 005557   200652 757100                    STAQ    ID2_ST$+1,,AUTO
        22 005560   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 005561   000015 631400 23                 EPPR1   13
        22 005562   000000 701000 xent               TSX1    Z8E7$MOVE
        22 005563   000000 011000                    NOP     0
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:392  

     2515    24159    3            DELIMITED$ -> LX_ETT_ITEM.ETT$ = ID2$ -> LX_ETT_ITEM.ETT$ ;

  24159 22 005564   200647 470500                    LDP0    @DELIMITED$,,AUTO
        22 005565   000000 471500                    LDP1    0,,PR0
        22 005566   200650 473500                    LDP3    @ID2$,,AUTO
        22 005567   300000 474500                    LDP4    0,,PR3
        22 005570   400001 236100                    LDQ     1,,PR4
        22 005571   100001 756100                    STQ     1,,PR1

     2516    24160    3          END ;

  24160 22 005572   005600 710000 22                 TRA     s:24165

     2517    24161    3          ELSE DO ; /* ID2 IS NOT SUBSCRIPTED */

     2518    24162    3            ID2$ -> LX_ETT_ITEM = DELIMITED$ -> LX_ETT_ITEM ;

  24162 22 005573   200650 473500                    LDP3    @ID2$,,AUTO
        22 005574   300000 474500                    LDP4    0,,PR3
        22 005575   000100 100500                    MLR     fill='000'O
        22 005576   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32
        22 005577   400000 000040                    ADSC9   0,,PR4                   cn=0,n=32

     2519    24163    3          END ;

     2520    24164
     2521    24165    2          ALL = DELIMITED$ -> LX_ITEM.B.ALL ;

  24165 22 005600   000000 471500                    LDP1    0,,PR0
        22 005601   100000 236100                    LDQ     0,,PR1
        22 005602   000025 736000                    QLS     21
        22 005603   400000 376003                    ANQ     -131072,DU
        22 005604   200021 756100                    STQ     ALL,,AUTO

     2522    24166    2          ID2$ -> LX_ITEM.B.ALL = '0'B ;

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:393  
  24166 22 005605   300000 474500                    LDP4    0,,PR3
        22 005606   000101 236000 23                 LDQ     65
        22 005607   400000 356100                    ANSQ    0,,PR4

     2523    24167
     2524    24168    2          IF ID2$ -> LX_ETT_ITEM.TYPE ~= %TYA

  24168 22 005610   300000 471500                    LDP1    0,,PR3
        22 005611   100004 235100                    LDA     4,,PR1
        22 005612   000010 115007                    CMPA    8,DL
        22 005613   005627 600000 22                 TZE     s:24173
        22 005614   000016 115007                    CMPA    14,DL
        22 005615   005627 600000 22                 TZE     s:24173

     2525    24169    3          AND ID2$ -> LX_ETT_ITEM.TYPE ~= %TYN THEN DO ;

     2526    24170    3            CALL Z8EV$CONVERT_TYA (ID2$, ID2$, ID1$) ;

  24170 22 005616   200044 634500                    EPPR4   ID1$,,AUTO
        22 005617   200654 454500                    STP4    ID2_ST$+3,,AUTO
        22 005620   200650 236100                    LDQ     @ID2$,,AUTO
        22 005621   200650 235100                    LDA     @ID2$,,AUTO
        22 005622   200652 757100                    STAQ    ID2_ST$+1,,AUTO
        22 005623   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 005624   000000 631400 23                 EPPR1   0
        22 005625   000000 701000 xent               TSX1    Z8EV$CONVERT_TYA
        22 005626   000000 011000                    NOP     0

     2527    24171    3          END ;

     2528    24172
     2529    24173    2          CALL Z8AU$LENGTH (ID2$ -> LX_ETT_ITEM.ETT$, LENGTH_ID2$) ;

  24173 22 005627   200650 470500                    LDP0    @ID2$,,AUTO
        22 005630   000000 471500                    LDP1    0,,PR0
        22 005631   200066 633500                    EPPR3   LENGTH_ID2$,,AUTO
        22 005632   200653 453500                    STP3    ID2_ST$+2,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:394  
        22 005633   100001 634500                    EPPR4   1,,PR1
        22 005634   200652 454500                    STP4    ID2_ST$+1,,AUTO
        22 005635   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 005636   000015 631400 23                 EPPR1   13
        22 005637   000000 701000 xent               TSX1    Z8AU$LENGTH
        22 005640   000000 011000                    NOP     0

     2530    24174                                                            /*#31092*/
     2531    24175    2          IF ID2$ -> LX_ETT_ITEM.ETT$ -> ETT.ID = %TRIAD   AND

  24175 22 005641   200650 470500                    LDP0    @ID2$,,AUTO
        22 005642   000000 471500                    LDP1    0,,PR0
        22 005643   100001 473500                    LDP3    1,,PR1
        22 005644   300000 220100                    LDX0    0,,PR3
        22 005645   000015 100003                    CMPX0   13,DU
        22 005646   005657 601000 22                 TNZ     s:24180
        22 005647   300001 474500                    LDP4    1,,PR3
        22 005650   400000 221100                    LDX1    0,,PR4
        22 005651   000767 101003                    CMPX1   503,DU
        22 005652   005657 601000 22                 TNZ     s:24180
        22 005653   400001 236100                    LDQ     1,,PR4
        22 005654   000077 376007                    ANQ     63,DL
        22 005655   000001 116007                    CMPQ    1,DL
        22 005656   005660 600000 22                 TZE     s:24182

     2532    24176    2             ID2$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP -> ST.ID = %CONST  AND
     2533    24177    2             ID2$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP -> ST.NDSC.N = 1   THEN;
     2534    24178                  /* O.K. */
     2535    24179    2          ELSE
     2536    24180    2            ALL_LENGTH_1 = FALSE;

  24180 22 005657   200023 450100                    STZ     ALL_LENGTH_1,,AUTO

     2537    24181
     2538    24182    2   END PREPARE_ID2  ;

  24182 22 005660   200646 221300                    LDX1  ! DELIMS$$+2,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:395  
        22 005661   000001 702211                    TSX2  ! 1,X1

     2539    24183
     2540    24184        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:396  
     2541    24185    1   PREPARE_ID4: PROC (INTO$, ID4$) ;

  24185 22 005662   200550 741300       PREPARE_ID4  STX1  ! SUB_ONE+8,,AUTO

     2542    24186
     2543    24187    2   DCL  INTO$  PTR ;
     2544    24188    2   DCL  ID4$   PTR ;
     2545    24189
     2546    24190    2          ID4$ -> LX_ETT_ITEM = INTO$ -> LX_ETT_ITEM ;

  24190 22 005663   200552 470500                    LDP0    @ID4$,,AUTO
        22 005664   000000 471500                    LDP1    0,,PR0
        22 005665   200551 473500                    LDP3    @INTO$,,AUTO
        22 005666   300000 474500                    LDP4    0,,PR3
        22 005667   000100 100500                    MLR     fill='000'O
        22 005670   400000 000040                    ADSC9   0,,PR4                   cn=0,n=32
        22 005671   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32

     2547    24191
     2548    24192    2          CALL Z8AU$LENGTH (ID4$ -> LX_ETT_ITEM.ETT$, LENGTH_ID4$) ;

  24192 22 005672   000000 471500                    LDP1    0,,PR0
        22 005673   200067 634500                    EPPR4   LENGTH_ID4$,,AUTO
        22 005674   200653 454500                    STP4    ID2_ST$+2,,AUTO
        22 005675   100001 635500                    EPPR5   1,,PR1
        22 005676   200652 455500                    STP5    ID2_ST$+1,,AUTO
        22 005677   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 005700   000015 631400 23                 EPPR1   13
        22 005701   000000 701000 xent               TSX1    Z8AU$LENGTH
        22 005702   000000 011000                    NOP     0

     2549    24193
     2550    24194    2   END PREPARE_ID4  ;

  24194 22 005703   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 005704   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:397  
     2551    24195
     2552    24196        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:398  
     2553    24197    1   PREPARE_ID5:  PROC (DELIMITER$, ID5$) ;

  24197 22 005705   200550 741300       PREPARE_ID5  STX1  ! SUB_ONE+8,,AUTO

     2554    24198
     2555    24199    2   DCL  DELIMITER$  PTR ;
     2556    24200    2   DCL  ID5$        PTR ;
     2557    24201
     2558    24202    3        IF DELIMITER$ -> LX_ITEM.ID = %LX_TERMINAL THEN DO ;

  24202 22 005706   200551 470500                    LDP0    @DELIMITER$,,AUTO
        22 005707   000000 471500                    LDP1    0,,PR0
        22 005710   100000 220100                    LDX0    0,,PR1
        22 005711   005714 601000 22                 TNZ     s:24206

     2559    24203    3          DELIMITER = FALSE ;

  24203 22 005712   200034 450100                    STZ     DELIMITER,,AUTO

     2560    24204    3        END ;

  24204 22 005713   005723 710000 22                 TRA     s:24210

     2561    24205    3        ELSE DO ;

     2562    24206    3          DELIMITER = TRUE ;

  24206 22 005714   400000 236003                    LDQ     -131072,DU
        22 005715   200034 756100                    STQ     DELIMITER,,AUTO

     2563    24207    3          ID5$ -> LX_ETT_ITEM = DELIMITER$ -> LX_ETT_ITEM ;

  24207 22 005716   200552 473500                    LDP3    @ID5$,,AUTO
        22 005717   300000 474500                    LDP4    0,,PR3
        22 005720   000100 100500                    MLR     fill='000'O
        22 005721   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32
        22 005722   400000 000040                    ADSC9   0,,PR4                   cn=0,n=32
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:399  

     2564    24208    3        END ;

     2565    24209
     2566    24210    2   END PREPARE_ID5 ;

  24210 22 005723   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 005724   000001 702211                    TSX2  ! 1,X1

     2567    24211
     2568    24212        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:400  
     2569    24213    1   PREPARE_ID6: PROC (COUNT$, ID6$) ;

  24213 22 005725   200550 741300       PREPARE_ID6  STX1  ! SUB_ONE+8,,AUTO

     2570    24214
     2571    24215    2   DCL  COUNT$  PTR ;
     2572    24216    2   DCL  ID6$    PTR ;
     2573    24217
     2574    24218    3        IF COUNT$ -> LX_ITEM.ID = %LX_TERMINAL THEN DO ; /* EMPTY */

  24218 22 005726   200551 470500                    LDP0    @COUNT$,,AUTO
        22 005727   000000 471500                    LDP1    0,,PR0
        22 005730   100000 220100                    LDX0    0,,PR1
        22 005731   005775 601000 22                 TNZ     s:24246

     2575    24219    3            COUNT = FALSE ;

  24219 22 005732   200030 450100                    STZ     COUNT,,AUTO

     2576    24220                 %INIT_LX_ETT_ITEM (@POINTER = ID6$, @TYPE = %TYI) ;

  24222 22 005733   200552 473500                    LDP3    @ID6$,,AUTO
        22 005734   300000 474500                    LDP4    0,,PR3
        22 005735   000004 222003                    LDX2    4,DU
        22 005736   400000 742100                    STX2    0,,PR4

  24223 22 005737   300000 471500                    LDP1    0,,PR3
        22 005740   000000 220003                    LDX0    0,DU
        22 005741   100000 440100                    SXL0    0,,PR1

  24224 22 005742   300000 471500                    LDP1    0,,PR3
        22 005743   000001 235007                    LDA     1,DL
        22 005744   100004 755100                    STA     4,,PR1

  24225 22 005745   300000 471500                    LDP1    0,,PR3
        22 005746   000005 236000 23                 LDQ     5
        22 005747   100007 756100                    STQ     7,,PR1
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:401  

  24226 22 005750   300000 471500                    LDP1    0,,PR3
        22 005751   100001 756100                    STQ     1,,PR1

  24227 22 005752   300000 471500                    LDP1    0,,PR3
        22 005753   000005 236000 23                 LDQ     5
        22 005754   100002 756100                    STQ     2,,PR1

  24229 22 005755   300000 471500                    LDP1    0,,PR3
        22 005756   000133 236000 xsym               LDQ     COMCOM+91
        22 005757   100005 756100                    STQ     5,,PR1

  24230 22 005760   300000 471500                    LDP1    0,,PR3
        22 005761   000134 236000 xsym               LDQ     COMCOM+92
        22 005762   100006 756100                    STQ     6,,PR1

     2577    24242    3            CALL Z8AT$CREATE_TEMP_WITH_BASE (%SCALAR, ID6$ -> LX_ETT_ITEM.ETT$) ;

  24242 22 005763   300000 471500                    LDP1    0,,PR3
        22 005764   100001 634500                    EPPR4   1,,PR1
        22 005765   200653 454500                    STP4    ID2_ST$+2,,AUTO
        22 005766   000017 236000 23                 LDQ     15
        22 005767   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 005770   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 005771   000015 631400 23                 EPPR1   13
        22 005772   000000 701000 xent               TSX1    Z8AT$CREATE_TEMP_WITH_BASE
        22 005773   000000 011000                    NOP     0

     2578    24243    3          END ;

  24243 22 005774   006004 710000 22                 TRA     s:24250

     2579    24244
     2580    24245    3          ELSE DO ;

     2581    24246    3            COUNT = TRUE ;

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:402  
  24246 22 005775   400000 236003                    LDQ     -131072,DU
        22 005776   200030 756100                    STQ     COUNT,,AUTO

     2582    24247    3            ID6$ -> LX_ETT_ITEM = COUNT$ -> LX_ETT_ITEM ;

  24247 22 005777   200552 473500                    LDP3    @ID6$,,AUTO
        22 006000   300000 474500                    LDP4    0,,PR3
        22 006001   000100 100500                    MLR     fill='000'O
        22 006002   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32
        22 006003   400000 000040                    ADSC9   0,,PR4                   cn=0,n=32

     2583    24248    3          END ;

     2584    24249
     2585    24250    2   END PREPARE_ID6 ;

  24250 22 006004   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 006005   000001 702211                    TSX2  ! 1,X1

     2586    24251
     2587    24252        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:403  
     2588    24253    1   PREPARE_ID7: PROC (POINTER$, ID7$) ;

  24253 22 006006   200550 741300       PREPARE_ID7  STX1  ! SUB_ONE+8,,AUTO

     2589    24254
     2590    24255    2   DCL  POINTER$  PTR ;
     2591    24256    2   DCL  ID7$      PTR ;
     2592    24257
     2593    24258
     2594    24259    3          IF POINTER = FALSE THEN DO ;

  24259 22 006007   200100 234100                    SZN     POINTER,,AUTO
        22 006010   006063 604000 22                 TMI     s:24295

     2595    24260
     2596    24261                 %INIT_LX_ETT_ITEM (@POINTER = ID7$, @TYPE = %TYI) ;

  24263 22 006011   200552 470500                    LDP0    @ID7$,,AUTO
        22 006012   000000 471500                    LDP1    0,,PR0
        22 006013   000004 220003                    LDX0    4,DU
        22 006014   100000 740100                    STX0    0,,PR1

  24264 22 006015   000000 471500                    LDP1    0,,PR0
        22 006016   000000 221003                    LDX1    0,DU
        22 006017   100000 441100                    SXL1    0,,PR1

  24265 22 006020   000000 471500                    LDP1    0,,PR0
        22 006021   000001 235007                    LDA     1,DL
        22 006022   100004 755100                    STA     4,,PR1

  24266 22 006023   000000 471500                    LDP1    0,,PR0
        22 006024   000005 236000 23                 LDQ     5
        22 006025   100007 756100                    STQ     7,,PR1

  24267 22 006026   000000 471500                    LDP1    0,,PR0
        22 006027   100001 756100                    STQ     1,,PR1

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:404  
  24268 22 006030   000000 471500                    LDP1    0,,PR0
        22 006031   000005 236000 23                 LDQ     5
        22 006032   100002 756100                    STQ     2,,PR1

  24270 22 006033   000000 471500                    LDP1    0,,PR0
        22 006034   000133 236000 xsym               LDQ     COMCOM+91
        22 006035   100005 756100                    STQ     5,,PR1

  24271 22 006036   000000 471500                    LDP1    0,,PR0
        22 006037   000134 236000 xsym               LDQ     COMCOM+92
        22 006040   100006 756100                    STQ     6,,PR1

     2597    24283    3            CALL Z8AT$CREATE_TEMP_WITH_BASE (%SCALAR, ID7$ -> LX_ETT_ITEM.ETT$) ;

  24283 22 006041   000000 471500                    LDP1    0,,PR0
        22 006042   100001 633500                    EPPR3   1,,PR1
        22 006043   200653 453500                    STP3    ID2_ST$+2,,AUTO
        22 006044   000017 236000 23                 LDQ     15
        22 006045   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 006046   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 006047   000015 631400 23                 EPPR1   13
        22 006050   000000 701000 xent               TSX1    Z8AT$CREATE_TEMP_WITH_BASE
        22 006051   000000 011000                    NOP     0

     2598    24284    3            CALL Z8E7$MOVE (ID7$, ONE$) ; /* ID7 = 1 */

  24284 22 006052   200074 630500                    EPPR0   ONE$,,AUTO
        22 006053   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 006054   200552 236100                    LDQ     @ID7$,,AUTO
        22 006055   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 006056   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 006057   000015 631400 23                 EPPR1   13
        22 006060   000000 701000 xent               TSX1    Z8E7$MOVE
        22 006061   000000 011000                    NOP     0

     2599    24285
     2600    24286    3          END ;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:405  

  24286 22 006062   006072 710000 22                 TRA     s:24299

     2601    24287
     2602    24288    3          ELSE DO ;

     2603    24289
     2604    24290                 /*N* IF ID7 IS SUBSCRIPTED, MOVE IT TO TEMP, THEN
     2605    24291                      MOVE TEMP BACK TO ID7 AFTER UNSTRING????
     2606    24292                      OR USE ADDR TO FIND EFFECTIVE ADDRESS.
     2607    24293                 */
     2608    24294
     2609    24295    3            ID7$ -> LX_ETT_ITEM = POINTER$ -> LX_ETT_ITEM ;

  24295 22 006063   200552 470500                    LDP0    @ID7$,,AUTO
        22 006064   000000 471500                    LDP1    0,,PR0
        22 006065   200551 473500                    LDP3    @POINTER$,,AUTO
        22 006066   300000 474500                    LDP4    0,,PR3
        22 006067   000100 100500                    MLR     fill='000'O
        22 006070   400000 000040                    ADSC9   0,,PR4                   cn=0,n=32
        22 006071   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32

     2610    24296
     2611    24297    3          END ;

     2612    24298
     2613    24299    2   END PREPARE_ID7 ;

  24299 22 006072   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 006073   000001 702211                    TSX2  ! 1,X1

     2614    24300
     2615    24301        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:406  
     2616    24302    1   PREPARE_ID8: PROC (TALLYING$, ID8$) ;

  24302 22 006074   200550 741300       PREPARE_ID8  STX1  ! SUB_ONE+8,,AUTO

     2617    24303
     2618    24304    2   DCL  TALLYING$  PTR ;
     2619    24305    2   DCL  ID8$       PTR ;
     2620    24306
     2621    24307
     2622    24308    3          IF TALLYING$ = ADDR (NIL) THEN DO ;

  24308 22 006075   200551 470500                    LDP0    @TALLYING$,,AUTO
        22 006076   000000 236100                    LDQ     0,,PR0
        22 006077   000005 116000 23                 CMPQ    5
        22 006100   006103 601000 22                 TNZ     s:24313

     2623    24309    3            TALLYING = FALSE ;

  24309 22 006101   200112 450100                    STZ     TALLYING,,AUTO

     2624    24310    3          END ;

  24310 22 006102   006113 710000 22                 TRA     s:24318

     2625    24311
     2626    24312    3          ELSE DO ;

     2627    24313    3            TALLYING = TRUE ;

  24313 22 006103   400000 236003                    LDQ     -131072,DU
        22 006104   200112 756100                    STQ     TALLYING,,AUTO

     2628    24314                 /*N* SEE COMMENT IN PREPARE ID7 */
     2629    24315    3            ID8$ -> LX_ETT_ITEM = TALLYING$ -> LX_ETT_ITEM ;

  24315 22 006105   200552 471500                    LDP1    @ID8$,,AUTO
        22 006106   100000 473500                    LDP3    0,,PR1
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:407  
        22 006107   000000 474500                    LDP4    0,,PR0
        22 006110   000100 100500                    MLR     fill='000'O
        22 006111   400000 000040                    ADSC9   0,,PR4                   cn=0,n=32
        22 006112   300000 000040                    ADSC9   0,,PR3                   cn=0,n=32

     2630    24316    3          END ;

     2631    24317
     2632    24318    2   END PREPARE_ID8 ;

  24318 22 006113   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 006114   000001 702211                    TSX2  ! 1,X1

     2633    24319
     2634    24320        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:408  
     2635    24321        /*I*   NAME: ADD_A_AND_B_GIVING_C
     2636    24322
     2637    24323        DESCRIPTION: Generate ILL/ETT to add two operands and save the result.
     2638    24324
     2639    24325        */
     2640    24326
     2641    24327    1   ADD_A_AND_B_GIVING_C: PROC (A$, B$, C$) ;

  24327 22 006115   200562 741300       ADD_A_AND_B* STX1  ! COUNT+4,,AUTO

     2642    24328
     2643    24329    2   DCL  A$    PTR ; /* LX_ETT_ITEMS */
     2644    24330    2   DCL  B$    PTR ;
     2645    24331    2   DCL  C$    PTR ;
     2646    24332    2   DCL  ADD$  PTR ;
     2647    24333
     2648    24334        %DCL_AUTO_LX_ITEM (@NAME = ADD) ;
     2649    24338
     2650    24339               /*V* C = A + B */
     2651    24340
     2652    24341    2          ADD$ = ADDR(ADD) ;

  24341 22 006116   200570 630500                    EPPR0   ADD,,AUTO
        22 006117   200566 450500                    STP0    ADD$,,AUTO

     2653    24342
     2654    24343               %INIT_BINARY_OP (@POINTER = ADD$,
     2655    24344                                @LOP$    = A$,
     2656    24345                                @OP      = %OP_PLUS,
     2657    24346                                @ROP$    = B$,
     2658    24347                                @LINE    = "A$ -> LX_ETT_ITEM.LINE",
     2659    24348                                @COLUMN  = "A$ -> LX_ETT_ITEM.COLUMN") ;

  24350 22 006120   000005 220003                    LDX0    5,DU
        22 006121   000000 740100                    STX0    0,,PR0

  24351 22 006122   000000 221003                    LDX1    0,DU
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:409  
        22 006123   200566 470500                    LDP0    ADD$,,AUTO
        22 006124   000000 441100                    SXL1    0,,PR0

  24358 22 006125   200563 470500                    LDP0    @A$,,AUTO
        22 006126   000000 471500                    LDP1    0,,PR0
        22 006127   200566 473500                    LDP3    ADD$,,AUTO
        22 006130   100005 235100                    LDA     5,,PR1
        22 006131   300005 755100                    STA     5,,PR3

  24359 22 006132   000000 471500                    LDP1    0,,PR0
        22 006133   200566 473500                    LDP3    ADD$,,AUTO
        22 006134   100006 235100                    LDA     6,,PR1
        22 006135   300006 755100                    STA     6,,PR3

  24360 22 006136   200564 471500                    LDP1    @B$,,AUTO
        22 006137   100000 236100                    LDQ     0,,PR1
        22 006140   200566 473500                    LDP3    ADD$,,AUTO
        22 006141   300002 756100                    STQ     2,,PR3

  24361 22 006142   000000 236100                    LDQ     0,,PR0
        22 006143   200566 473500                    LDP3    ADD$,,AUTO
        22 006144   300001 756100                    STQ     1,,PR3

  24362 22 006145   000020 235007                    LDA     16,DL
        22 006146   200566 473500                    LDP3    ADD$,,AUTO
        22 006147   300003 755100                    STA     3,,PR3

  24363 22 006150   000005 236000 23                 LDQ     5
        22 006151   200566 473500                    LDP3    ADD$,,AUTO
        22 006152   300007 756100                    STQ     7,,PR3

     2660    24366
     2661    24367    2          CALL Z8E5$MATH_PACK (ADD$, ADD$) ;

  24367 22 006153   200566 633500                    EPPR3   ADD$,,AUTO
        22 006154   200653 453500                    STP3    ID2_ST$+2,,AUTO
        22 006155   200566 634500                    EPPR4   ADD$,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:410  
        22 006156   200652 454500                    STP4    ID2_ST$+1,,AUTO
        22 006157   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 006160   000015 631400 23                 EPPR1   13
        22 006161   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        22 006162   000000 011000                    NOP     0

     2662    24368    2          CALL Z8E7$MOVE (C$, ADD$) ;

  24368 22 006163   200566 630500                    EPPR0   ADD$,,AUTO
        22 006164   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 006165   200565 236100                    LDQ     @C$,,AUTO
        22 006166   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 006167   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 006170   000015 631400 23                 EPPR1   13
        22 006171   000000 701000 xent               TSX1    Z8E7$MOVE
        22 006172   000000 011000                    NOP     0

     2663    24369
     2664    24370    2   END ADD_A_AND_B_GIVING_C ;

  24370 22 006173   200562 221300                    LDX1  ! COUNT+4,,AUTO
        22 006174   000001 702211                    TSX2  ! 1,X1

     2665    24371        %EJECT;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:411  
     2666    24372        /*===========*/
     2667    24373    1     KANJI_INDEX : PROC ( COUNT$, DELIMS$ );

  24373 22 006175   200550 741300       KANJI_INDEX  STX1  ! SUB_ONE+8,,AUTO

     2668    24374        /*===========*/
     2669    24375
     2670    24376    2   DCL BEGAIN_INDEX$       PTR;
     2671    24377    2   DCL END_INDEX$          PTR;
     2672    24378
     2673    24379        %DCL_AUTO_LX_ITEM( @NAME = COUNT );
     2674    24383        %DCL_AUTO_LX_ITEM( @NAME = SUB );
     2675    24387        %DCL_AUTO_LX_ITEM( @NAME = COMPARISON );
     2676    24391        %DCL_AUTO_LX_ITEM( @NAME = LENGTH_ID1 );
     2677    24395        %DCL_AUTO_LX_ITEM( @NAME = LENGTH_ID2 );
     2678    24399        %DCL_AUTO_LX_ITEM( @NAME = SUB_STR );
     2679    24403
     2680    24404    2   DCL COUNT$              PTR;
     2681    24405    2   DCL COUNT_BASE$         PTR;
     2682    24406    2   DCL SUBSTR$             PTR;
     2683    24407    2   DCL SUB$                PTR;
     2684    24408    2   DCL COMPARISON$         PTR;
     2685    24409    2   DCL LENGTH_ID1$         PTR;
     2686    24410    2   DCL LENGTH_ID2$         PTR;
     2687    24411    2   DCL DELIMS$             PTR;
     2688    24412    2   DCL DELIMS$$            PTR;
     2689    24413
     2690    24414
     2691    24415    2   DELIMS$$ = DELIMS$;

  24415 22 006176   200552 470500                    LDP0    @DELIMS$,,AUTO
        22 006177   000000 236100                    LDQ     0,,PR0
        22 006200   200644 756100                    STQ     DELIMS$$,,AUTO

     2692    24416    2   SUB$ = ADDR( SUB );

  24416 22 006201   200566 631500                    EPPR1   SUB,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:412  
        22 006202   200640 451500                    STP1    SUB$,,AUTO

     2693    24417    2   SUBSTR$ = ADDR( SUB_STR );

  24417 22 006203   200626 633500                    EPPR3   SUB_STR,,AUTO
        22 006204   200637 453500                    STP3    SUBSTR$,,AUTO

     2694    24418
     2695    24419    2   CALL Z8AT$CREATE_TEMPORARY( %PARA, BEGAIN_INDEX$ );

  24419 22 006205   200553 634500                    EPPR4   BEGAIN_INDEX$,,AUTO
        22 006206   200653 454500                    STP4    ID2_ST$+2,,AUTO
        22 006207   000025 236000 23                 LDQ     21
        22 006210   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 006211   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 006212   000015 631400 23                 EPPR1   13
        22 006213   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        22 006214   000000 011000                    NOP     0

     2696    24420    2   CALL Z8AT$CREATE_TEMPORARY( %PARA, END_INDEX$ );

  24420 22 006215   200554 630500                    EPPR0   END_INDEX$,,AUTO
        22 006216   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 006217   000025 236000 23                 LDQ     21
        22 006220   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 006221   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 006222   000015 631400 23                 EPPR1   13
        22 006223   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        22 006224   000000 011000                    NOP     0

     2697    24421
     2698    24422    2   LENGTH_ID1$ = ADDR( LENGTH_ID1 );

  24422 22 006225   200606 630500                    EPPR0   LENGTH_ID1,,AUTO
        22 006226   200642 450500                    STP0    LENGTH_ID1$,,AUTO

     2699    24423    2   CALL Z8AU$LENGTH( ID1$ -> LX_ETT_ITEM.ETT$,
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:413  

  24423 22 006227   200642 631500                    EPPR1   LENGTH_ID1$,,AUTO
        22 006230   200653 451500                    STP1    ID2_ST$+2,,AUTO
        22 006231   200044 236100                    LDQ     ID1$,,AUTO
        22 006232   000001 036003                    ADLQ    1,DU
        22 006233   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 006234   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 006235   000015 631400 23                 EPPR1   13
        22 006236   000000 701000 xent               TSX1    Z8AU$LENGTH
        22 006237   000000 011000                    NOP     0

     2700    24424    2                     LENGTH_ID1$ );
     2701    24425
     2702    24426        %NEW_ILL( @ID  = %MVII,
     2703    24427                  @LOP = COUNT$ -> LX_ETT_ITEM.ETT$,
     2704    24428                  @ROP = ID7$ -> LX_ETT_ITEM.ETT$ );

  24741 22 006240   200551 470500                    LDP0    @COUNT$,,AUTO
        22 006241   000000 471500                    LDP1    0,,PR0
        22 006242   000034 236000 23                 LDQ     28
        22 006243   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 006244   100001 633500                    EPPR3   1,,PR1
        22 006245   200657 453500                    STP3    ID2_ST$+6,,AUTO
        22 006246   200652 631500                    EPPR1   ID2_ST$+1,,AUTO
        22 006247   200656 451500                    STP1    ID2_ST$+5,,AUTO
        22 006250   000104 237000 23                 LDAQ    68
        22 006251   200654 757100                    STAQ    ID2_ST$+3,,AUTO
        22 006252   000011 236000 23                 LDQ     9
        22 006253   200653 756100                    STQ     ID2_ST$+2,,AUTO
        22 006254   200653 630500                    EPPR0   ID2_ST$+2,,AUTO
        22 006255   000032 631400 23                 EPPR1   26
        22 006256   000000 701000 xent               TSX1    Z8AN$NEW_ILL1
        22 006257   000000 011000                    NOP     0

  24744 22 006260   200551 470500                    LDP0    @COUNT$,,AUTO
        22 006261   000000 471500                    LDP1    0,,PR0
        22 006262   100001 236100                    LDQ     1,,PR1
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:414  
        22 006263   000000 473400 7                  LDP3    ILL$
        22 006264   300001 756100                    STQ     1,,PR3

  24745 22 006265   200054 471500                    LDP1    ID7$,,AUTO
        22 006266   100001 236100                    LDQ     1,,PR1
        22 006267   300002 756100                    STQ     2,,PR3

     2705    24807
     2706    24808        %NEW_ILL( @ID  = %SB2I,
     2707    24809                  @LOP = COUNT$ -> LX_ETT_ITEM.ETT$,
     2708    24810                  @ROP = ONE$ -> LX_ETT_ITEM.ETT$ );

  25123 22 006270   000000 471500                    LDP1    0,,PR0
        22 006271   000034 236000 23                 LDQ     28
        22 006272   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 006273   100001 634500                    EPPR4   1,,PR1
        22 006274   200657 454500                    STP4    ID2_ST$+6,,AUTO
        22 006275   200652 631500                    EPPR1   ID2_ST$+1,,AUTO
        22 006276   200656 451500                    STP1    ID2_ST$+5,,AUTO
        22 006277   000064 237000 23                 LDAQ    52
        22 006300   200654 757100                    STAQ    ID2_ST$+3,,AUTO
        22 006301   000011 236000 23                 LDQ     9
        22 006302   200653 756100                    STQ     ID2_ST$+2,,AUTO
        22 006303   200653 630500                    EPPR0   ID2_ST$+2,,AUTO
        22 006304   000032 631400 23                 EPPR1   26
        22 006305   000000 701000 xent               TSX1    Z8AN$NEW_ILL1
        22 006306   000000 011000                    NOP     0

  25126 22 006307   200551 470500                    LDP0    @COUNT$,,AUTO
        22 006310   000000 471500                    LDP1    0,,PR0
        22 006311   100001 236100                    LDQ     1,,PR1
        22 006312   000000 473400 7                  LDP3    ILL$
        22 006313   300001 756100                    STQ     1,,PR3

  25127 22 006314   200074 471500                    LDP1    ONE$,,AUTO
        22 006315   100001 236100                    LDQ     1,,PR1
        22 006316   300002 756100                    STQ     2,,PR3
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:415  

     2709    25189
     2710    25190        %NEW_ILL( @ID  = %DEFLB,
     2711    25191                  @LOP = BEGAIN_INDEX$ );

  25512 22 006317   000034 236000 23                 LDQ     28
        22 006320   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 006321   200652 631500                    EPPR1   ID2_ST$+1,,AUTO
        22 006322   200657 451500                    STP1    ID2_ST$+6,,AUTO
        22 006323   000037 236000 23                 LDQ     31
        22 006324   200656 756100                    STQ     ID2_ST$+5,,AUTO
        22 006325   000044 237000 23                 LDAQ    36
        22 006326   200654 757100                    STAQ    ID2_ST$+3,,AUTO
        22 006327   200654 630500                    EPPR0   ID2_ST$+3,,AUTO
        22 006330   000027 631400 23                 EPPR1   23
        22 006331   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        22 006332   000000 011000                    NOP     0

  25521 22 006333   200553 236100                    LDQ     BEGAIN_INDEX$,,AUTO
        22 006334   000000 470400 7                  LDP0    ILL$
        22 006335   000001 756100                    STQ     1,,PR0

     2712    25570
     2713    25571        %INIT_BINARY_OP( @POINTER = SUB$,
     2714    25572                         @LOP$    = LENGTH_ID1$,
     2715    25573                         @ROP$    = TWO$,
     2716    25574                         @OP      = %OP_BINARY_MINUS,
     2717    25575                         @LINE    = "ID1$ -> LX_ETT_ITEM.LINE",
     2718    25576                         @COLUMN  = "ID1$ -> LX_ETT_ITEM.COLUMN" );

  25578 22 006336   000005 220003                    LDX0    5,DU
        22 006337   200640 471500                    LDP1    SUB$,,AUTO
        22 006340   100000 740100                    STX0    0,,PR1

  25579 22 006341   000000 221003                    LDX1    0,DU
        22 006342   100000 441100                    SXL1    0,,PR1

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:416  
  25586 22 006343   200044 470500                    LDP0    ID1$,,AUTO
        22 006344   000005 235100                    LDA     5,,PR0
        22 006345   100005 755100                    STA     5,,PR1

  25587 22 006346   200044 470500                    LDP0    ID1$,,AUTO
        22 006347   000006 235100                    LDA     6,,PR0
        22 006350   100006 755100                    STA     6,,PR1

  25588 22 006351   200115 236100                    LDQ     TWO$,,AUTO
        22 006352   100002 756100                    STQ     2,,PR1

  25589 22 006353   200642 236100                    LDQ     LENGTH_ID1$,,AUTO
        22 006354   100001 756100                    STQ     1,,PR1

  25590 22 006355   000021 235007                    LDA     17,DL
        22 006356   100003 755100                    STA     3,,PR1

  25591 22 006357   000005 236000 23                 LDQ     5
        22 006360   100007 756100                    STQ     7,,PR1

     2719    25594
     2720    25595        %IF_THEN_DO( @LOP = COUNT$,
     2721    25596                     @ROP = SUB$,
     2722    25597                     @REL = %OP_LESS_THAN_OR_EQUAL,
     2723    25598                     @LAB = END_INTO$ );

  25604 22 006361   200576 630500                    EPPR0   COMPARISON,,AUTO
        22 006362   200641 450500                    STP0    COMPARISON$,,AUTO

  25612 22 006363   000000 740100                    STX0    0,,PR0

  25613 22 006364   200641 470500                    LDP0    COMPARISON$,,AUTO
        22 006365   000000 441100                    SXL1    0,,PR0

  25620 22 006366   200551 470500                    LDP0    @COUNT$,,AUTO
        22 006367   000000 473500                    LDP3    0,,PR0
        22 006370   200641 474500                    LDP4    COMPARISON$,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:417  
        22 006371   300005 235100                    LDA     5,,PR3
        22 006372   400005 755100                    STA     5,,PR4

  25621 22 006373   000000 473500                    LDP3    0,,PR0
        22 006374   200641 474500                    LDP4    COMPARISON$,,AUTO
        22 006375   300006 235100                    LDA     6,,PR3
        22 006376   400006 755100                    STA     6,,PR4

  25622 22 006377   200640 236100                    LDQ     SUB$,,AUTO
        22 006400   200641 473500                    LDP3    COMPARISON$,,AUTO
        22 006401   300002 756100                    STQ     2,,PR3

  25623 22 006402   000000 236100                    LDQ     0,,PR0
        22 006403   200641 473500                    LDP3    COMPARISON$,,AUTO
        22 006404   300001 756100                    STQ     1,,PR3

  25624 22 006405   000032 235007                    LDA     26,DL
        22 006406   200641 473500                    LDP3    COMPARISON$,,AUTO
        22 006407   300003 755100                    STA     3,,PR3

  25625 22 006410   000005 236000 23                 LDQ     5
        22 006411   200641 473500                    LDP3    COMPARISON$,,AUTO
        22 006412   300007 756100                    STQ     7,,PR3

  25628 22 006413   200041 633500                    EPPR3   END_INTO$,,AUTO
        22 006414   200653 453500                    STP3    ID2_ST$+2,,AUTO
        22 006415   000025 236000 23                 LDQ     21
        22 006416   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 006417   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 006420   000015 631400 23                 EPPR1   13
        22 006421   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        22 006422   000000 011000                    NOP     0

  25629 22 006423   200641 630500                    EPPR0   COMPARISON$,,AUTO
        22 006424   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 006425   200041 631500                    EPPR1   END_INTO$,,AUTO
        22 006426   200652 451500                    STP1    ID2_ST$+1,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:418  
        22 006427   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 006430   000015 631400 23                 EPPR1   13
        22 006431   000000 701000 xent               TSX1    Z8EK$BRANCH_FALSE
        22 006432   000000 011000                    NOP     0

     2724    25632
     2725    25633    2   LENGTH_ID2$ = ADDR( LENGTH_ID2 );

  25633 22 006433   200616 630500                    EPPR0   LENGTH_ID2,,AUTO
        22 006434   200643 450500                    STP0    LENGTH_ID2$,,AUTO

     2726    25634    2   COMPARISON$ = ADDR( COMPARISON );

  25634 22 006435   200576 631500                    EPPR1   COMPARISON,,AUTO
        22 006436   200641 451500                    STP1    COMPARISON$,,AUTO

     2727    25635
     2728    25636    3   DO WHILE DELIMS$$ ~= ADDR(NIL);

  25636 22 006437   006540 710000 22                 TRA     s:25675

     2729    25637
     2730    25638    3     CALL PREPARE_ID2( DELIMS$$, ID2$ );

  25638 22 006440   200046 630500                    EPPR0   ID2$,,AUTO
        22 006441   200650 450500                    STP0    @ID2$,,AUTO
        22 006442   200644 631500                    EPPR1   DELIMS$$,,AUTO
        22 006443   200647 451500                    STP1    @DELIMITED$,,AUTO
        22 006444   005455 701000 22                 TSX1    PREPARE_ID2
        22 006445   000000 011000                    NOP     0

     2731    25639    3     CALL Z8AU$LENGTH( ID2$ -> LX_ETT_ITEM.ETT$,

  25639 22 006446   200643 630500                    EPPR0   LENGTH_ID2$,,AUTO
        22 006447   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 006450   200046 236100                    LDQ     ID2$,,AUTO
        22 006451   000001 036003                    ADLQ    1,DU
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:419  
        22 006452   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 006453   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 006454   000015 631400 23                 EPPR1   13
        22 006455   000000 701000 xent               TSX1    Z8AU$LENGTH
        22 006456   000000 011000                    NOP     0

     2732    25640    3                       LENGTH_ID2$ );
     2733    25641
     2734    25642    3     CALL Z8EA$SUBSTR_ZERO( ID1$,

  25642 22 006457   200637 630500                    EPPR0   SUBSTR$,,AUTO
        22 006460   200655 450500                    STP0    ID2_ST$+4,,AUTO
        22 006461   200643 631500                    EPPR1   LENGTH_ID2$,,AUTO
        22 006462   200654 451500                    STP1    ID2_ST$+3,,AUTO
        22 006463   200551 236100                    LDQ     @COUNT$,,AUTO
        22 006464   200653 756100                    STQ     ID2_ST$+2,,AUTO
        22 006465   200044 633500                    EPPR3   ID1$,,AUTO
        22 006466   200652 453500                    STP3    ID2_ST$+1,,AUTO
        22 006467   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 006470   000027 631400 23                 EPPR1   23
        22 006471   000000 701000 xent               TSX1    Z8EA$SUBSTR_ZERO
        22 006472   000000 011000                    NOP     0

     2735    25643    3                            COUNT$,
     2736    25644    3                            LENGTH_ID2$,
     2737    25645    3                            SUBSTR$ );
     2738    25646
     2739    25647          %INIT_BINARY_OP( @POINTER = COMPARISON$,
     2740    25648                           @LOP$    = SUBSTR$,
     2741    25649                           @OP      = %OP_EQUAL,
     2742    25650                           @ROP$    = ID2$,
     2743    25651                           @LINE    = "ID2$ -> LX_ETT_ITEM.LINE",
     2744    25652                           @COLUMN  = "ID2$ -> LX_ETT_ITEM.COLUMN" );

  25654 22 006473   000005 220003                    LDX0    5,DU
        22 006474   200641 470500                    LDP0    COMPARISON$,,AUTO
        22 006475   000000 740100                    STX0    0,,PR0
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:420  

  25655 22 006476   000000 221003                    LDX1    0,DU
        22 006477   200641 470500                    LDP0    COMPARISON$,,AUTO
        22 006500   000000 441100                    SXL1    0,,PR0

  25662 22 006501   200046 470500                    LDP0    ID2$,,AUTO
        22 006502   200641 471500                    LDP1    COMPARISON$,,AUTO
        22 006503   000005 235100                    LDA     5,,PR0
        22 006504   100005 755100                    STA     5,,PR1

  25663 22 006505   200046 470500                    LDP0    ID2$,,AUTO
        22 006506   200641 471500                    LDP1    COMPARISON$,,AUTO
        22 006507   000006 235100                    LDA     6,,PR0
        22 006510   100006 755100                    STA     6,,PR1

  25664 22 006511   200046 236100                    LDQ     ID2$,,AUTO
        22 006512   200641 470500                    LDP0    COMPARISON$,,AUTO
        22 006513   000002 756100                    STQ     2,,PR0

  25665 22 006514   200637 236100                    LDQ     SUBSTR$,,AUTO
        22 006515   200641 470500                    LDP0    COMPARISON$,,AUTO
        22 006516   000001 756100                    STQ     1,,PR0

  25666 22 006517   000027 235007                    LDA     23,DL
        22 006520   200641 470500                    LDP0    COMPARISON$,,AUTO
        22 006521   000003 755100                    STA     3,,PR0

  25667 22 006522   000005 236000 23                 LDQ     5
        22 006523   200641 470500                    LDP0    COMPARISON$,,AUTO
        22 006524   000007 756100                    STQ     7,,PR0

     2745    25670
     2746    25671    3     CALL Z8EK$BRANCH_TRUE( END_INDEX$,

  25671 22 006525   200641 630500                    EPPR0   COMPARISON$,,AUTO
        22 006526   200653 450500                    STP0    ID2_ST$+2,,AUTO
        22 006527   200554 631500                    EPPR1   END_INDEX$,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:421  
        22 006530   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 006531   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 006532   000015 631400 23                 EPPR1   13
        22 006533   000000 701000 xent               TSX1    Z8EK$BRANCH_TRUE
        22 006534   000000 011000                    NOP     0

     2747    25672    3                            COMPARISON$ );
     2748    25673    3     DELIMS$$ = DELIMS$$ -> LX_ITEM.LINK;

  25673 22 006535   200644 470500                    LDP0    DELIMS$$,,AUTO
        22 006536   000007 236100                    LDQ     7,,PR0
        22 006537   200644 756100                    STQ     DELIMS$$,,AUTO

     2749    25674
     2750    25675    3   END;

  25675 22 006540   200644 236100                    LDQ     DELIMS$$,,AUTO
        22 006541   000005 116000 23                 CMPQ    5
        22 006542   006440 601000 22                 TNZ     s:25638

     2751    25676
     2752    25677        %NEW_ILL( @ID  = %AD2I,
     2753    25678                  @LOP = COUNT$ -> LX_ETT_ITEM.ETT$,
     2754    25679                  @ROP = TWO$ -> LX_ETT_ITEM.ETT$ );

  25992 22 006543   200551 470500                    LDP0    @COUNT$,,AUTO
        22 006544   000000 471500                    LDP1    0,,PR0
        22 006545   000034 236000 23                 LDQ     28
        22 006546   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 006547   100001 633500                    EPPR3   1,,PR1
        22 006550   200657 453500                    STP3    ID2_ST$+6,,AUTO
        22 006551   200652 631500                    EPPR1   ID2_ST$+1,,AUTO
        22 006552   200656 451500                    STP1    ID2_ST$+5,,AUTO
        22 006553   000060 237000 23                 LDAQ    48
        22 006554   200654 757100                    STAQ    ID2_ST$+3,,AUTO
        22 006555   000011 236000 23                 LDQ     9
        22 006556   200653 756100                    STQ     ID2_ST$+2,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:422  
        22 006557   200653 630500                    EPPR0   ID2_ST$+2,,AUTO
        22 006560   000032 631400 23                 EPPR1   26
        22 006561   000000 701000 xent               TSX1    Z8AN$NEW_ILL1
        22 006562   000000 011000                    NOP     0

  25995 22 006563   200551 470500                    LDP0    @COUNT$,,AUTO
        22 006564   000000 471500                    LDP1    0,,PR0
        22 006565   100001 236100                    LDQ     1,,PR1
        22 006566   000000 473400 7                  LDP3    ILL$
        22 006567   300001 756100                    STQ     1,,PR3

  25996 22 006570   200115 471500                    LDP1    TWO$,,AUTO
        22 006571   100001 236100                    LDQ     1,,PR1
        22 006572   300002 756100                    STQ     2,,PR3

     2755    26058
     2756    26059    2   CALL Z8EK$BRANCH( BEGAIN_INDEX$ );

  26059 22 006573   200553 631500                    EPPR1   BEGAIN_INDEX$,,AUTO
        22 006574   200652 451500                    STP1    ID2_ST$+1,,AUTO
        22 006575   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 006576   000013 631400 23                 EPPR1   11
        22 006577   000000 701000 xent               TSX1    Z8EK$BRANCH
        22 006600   000000 011000                    NOP     0

     2757    26060
     2758    26061        %NEW_ILL( @ID = %DEFLB,
     2759    26062                  @LOP = END_INDEX$ );

  26383 22 006601   000034 236000 23                 LDQ     28
        22 006602   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 006603   200652 630500                    EPPR0   ID2_ST$+1,,AUTO
        22 006604   200657 450500                    STP0    ID2_ST$+6,,AUTO
        22 006605   000037 236000 23                 LDQ     31
        22 006606   200656 756100                    STQ     ID2_ST$+5,,AUTO
        22 006607   000044 237000 23                 LDAQ    36
        22 006610   200654 757100                    STAQ    ID2_ST$+3,,AUTO
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:423  
        22 006611   200654 630500                    EPPR0   ID2_ST$+3,,AUTO
        22 006612   000027 631400 23                 EPPR1   23
        22 006613   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        22 006614   000000 011000                    NOP     0

  26392 22 006615   200554 236100                    LDQ     END_INDEX$,,AUTO
        22 006616   000000 470400 7                  LDP0    ILL$
        22 006617   000001 756100                    STQ     1,,PR0

     2760    26441
     2761    26442        %NEW_ILL( @ID = %AD2I,
     2762    26443                  @LOP = COUNT$ -> LX_ETT_ITEM.ETT$,
     2763    26444                  @ROP = ONE$ -> LX_ETT_ITEM.ETT$ );

  26757 22 006620   200551 471500                    LDP1    @COUNT$,,AUTO
        22 006621   100000 473500                    LDP3    0,,PR1
        22 006622   000034 236000 23                 LDQ     28
        22 006623   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 006624   300001 634500                    EPPR4   1,,PR3
        22 006625   200657 454500                    STP4    ID2_ST$+6,,AUTO
        22 006626   200652 633500                    EPPR3   ID2_ST$+1,,AUTO
        22 006627   200656 453500                    STP3    ID2_ST$+5,,AUTO
        22 006630   000060 237000 23                 LDAQ    48
        22 006631   200654 757100                    STAQ    ID2_ST$+3,,AUTO
        22 006632   000011 236000 23                 LDQ     9
        22 006633   200653 756100                    STQ     ID2_ST$+2,,AUTO
        22 006634   200653 630500                    EPPR0   ID2_ST$+2,,AUTO
        22 006635   000032 631400 23                 EPPR1   26
        22 006636   000000 701000 xent               TSX1    Z8AN$NEW_ILL1
        22 006637   000000 011000                    NOP     0

  26760 22 006640   200551 470500                    LDP0    @COUNT$,,AUTO
        22 006641   000000 471500                    LDP1    0,,PR0
        22 006642   100001 236100                    LDQ     1,,PR1
        22 006643   000000 473400 7                  LDP3    ILL$
        22 006644   300001 756100                    STQ     1,,PR3

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:424  
  26761 22 006645   200074 471500                    LDP1    ONE$,,AUTO
        22 006646   100001 236100                    LDQ     1,,PR1
        22 006647   300002 756100                    STQ     2,,PR3

     2764    26823
     2765    26824        %NEW_ILL( @ID  = %SB2I,
     2766    26825                  @LOP = COUNT$ -> LX_ETT_ITEM.ETT$,
     2767    26826                  @ROP = ID7$ -> LX_ETT_ITEM.ETT$ );

  27139 22 006650   000000 471500                    LDP1    0,,PR0
        22 006651   000034 236000 23                 LDQ     28
        22 006652   200652 756100                    STQ     ID2_ST$+1,,AUTO
        22 006653   100001 634500                    EPPR4   1,,PR1
        22 006654   200657 454500                    STP4    ID2_ST$+6,,AUTO
        22 006655   200652 631500                    EPPR1   ID2_ST$+1,,AUTO
        22 006656   200656 451500                    STP1    ID2_ST$+5,,AUTO
        22 006657   000064 237000 23                 LDAQ    52
        22 006660   200654 757100                    STAQ    ID2_ST$+3,,AUTO
        22 006661   000011 236000 23                 LDQ     9
        22 006662   200653 756100                    STQ     ID2_ST$+2,,AUTO
        22 006663   200653 630500                    EPPR0   ID2_ST$+2,,AUTO
        22 006664   000032 631400 23                 EPPR1   26
        22 006665   000000 701000 xent               TSX1    Z8AN$NEW_ILL1
        22 006666   000000 011000                    NOP     0

  27142 22 006667   200551 470500                    LDP0    @COUNT$,,AUTO
        22 006670   000000 471500                    LDP1    0,,PR0
        22 006671   100001 236100                    LDQ     1,,PR1
        22 006672   000000 473400 7                  LDP3    ILL$
        22 006673   300001 756100                    STQ     1,,PR3

  27143 22 006674   200054 471500                    LDP1    ID7$,,AUTO
        22 006675   100001 236100                    LDQ     1,,PR1
        22 006676   300002 756100                    STQ     2,,PR3

     2768    27205
     2769    27206    2   END KANJI_INDEX;
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:425  

  27206 22 006677   200550 221300                    LDX1  ! SUB_ONE+8,,AUTO
        22 006700   000001 702211                    TSX2  ! 1,X1
     2770    27207
     2771    27208    1   END Z8EZ$UNSTRING ;
     2772    27209        %EOD ;

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:426  
--  Include file information  --

   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LIBRARY.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_ILS_LIST.:Z8A6TOU  is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EZ$UNSTRING.
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:427  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 ITERATION

  ****  Section 001 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 002 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 003 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 004 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:428  
  ****  Section 005 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 006 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ST_

  ****  Section 007 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 008 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILL_

  ****  Section 009 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 010 LblCom HEAD_ETT$

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:429  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 011 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 012 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ETT_

  ****  Section 013 LblCom ILS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILS$

  ****  Section 014 LblCom ILS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILS_

  ****  Section 015 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:430  

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 016 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 LTS_

  ****  Section 017 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 018 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 DNT_

  ****  Section 019 LblCom DNT_BUCKET_NUMBER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 DNT_BUCKET_NUMBER

  ****  Section 020 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 DNT_OF_1$
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:431  

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   563-0-0/w PTR         r     1 @A$                      564-0-0/w PTR         r     1 @B$
   565-0-0/w PTR         r     1 @C$                      551-0-0/w PTR         r     1 @COUNT$
   551-0-0/w PTR         r     1 @COUNT$                  647-0-0/w PTR         r     1 @DELIMITED$
   551-0-0/w PTR         r     1 @DELIMITER$              552-0-0/w PTR         r     1 @DELIMS$
   551-0-0/w PTR         r     1 @ID$                     553-0-0/w PTR         r     1 @ID$
   551-0-0/w PTR         r     1 @ID1$                    551-0-0/w PTR         r     1 @ID1$
   552-0-0/w PTR         r     1 @ID1$                    552-0-0/w PTR         r     1 @ID1$
   551-0-0/w PTR         r     1 @ID2$                    650-0-0/w PTR         r     1 @ID2$
   552-0-0/w PTR         r     1 @ID4$                    551-0-0/w PTR         r     1 @ID4$
   552-0-0/w PTR         r     1 @ID4$                    551-0-0/w PTR         r     1 @ID5$
   552-0-0/w PTR         r     1 @ID5$                    551-0-0/w PTR         r     1 @ID6$
   552-0-0/w PTR         r     1 @ID6$                    551-0-0/w PTR         r     1 @ID7$
   552-0-0/w PTR         r     1 @ID7$                    551-0-0/w PTR         r     1 @ID8$
   552-0-0/w PTR         r     1 @ID8$                    551-0-0/w PTR         r     1 @IDENT$
   552-0-0/w PTR         r     1 @ID_CHAR                 551-0-0/w PTR         r     1 @INTO$
   553-0-0/w PTR         r     1 @LENGTH                    5-0-0/w PTR         r     1 @NOT_ON_OVERFLOW$
   554-0-0/w PTR         r     1 @OFFSET                    4-0-0/w PTR         r     1 @ON_OVERFLOW$
   551-0-0/w PTR         r     1 @POINTER$                551-0-0/w PTR         r     1 @TALLYING$
     3-0-0/w PTR         r     1 @UNSTRING$                *0-0-0/w PTR         r     1 A$
   150-0-0/d STRC(288)   r     1 ADD                      570-0-0/d STRC(288)   r     1 ADD
    17-0-0/w PTR         r     1 ADD$                     566-0-0/w PTR         r     1 ADD$
    21-0-0/b BIT         r     1 ALL
    22-0-0/b BIT         r     1 ALL_ID2S_ARE_CONSTANT
    23-0-0/b BIT         r     1 ALL_LENGTH_1              24-0-0/w PTR         r     1 AND$
   170-0-0/d STRC(288)   r     1 ANDD                      25-0-0/w PTR         r     1 ASCBIN$
   200-0-0/d STRC(288)   r     1 ASC_BIN                   *0-0-0/w PTR         r     1 B$
   553-0-0/w PTR         r     1 BEGAIN_INDEX$             *0-0-0/w PTR         r     1 C$
   210-0-0/d STRC(288)   r     1 COMPARISON               576-0-0/d STRC(288)   r     1 COMPARISON
    26-0-0/w PTR         r     1 COMPARISON$              641-0-0/w PTR         r     1 COMPARISON$
   220-0-0/d STRC(288)   r     1 COMPARISON2               27-0-0/w PTR         r     1 COMPARISON2$
    30-0-0/b BIT         r     1 COUNT                    556-0-0/d STRC(288)         1 COUNT
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:432  
    31-0-0/w PTR         r     1 COUNT$                    *0-0-0/w PTR         r     1 COUNT$
    *0-0-0/w PTR         r     1 COUNT$                   636-0-0/w PTR               1 COUNT_BASE$
    32-0-0/w SBIN        r     1 CURRENT_OFFSET            33-0-0/b BIT         r     1 DELIMITED
    *0-0-0/w PTR         r     1 DELIMITED$                34-0-0/b BIT         r     1 DELIMITER
    35-0-0/w PTR         r     1 DELIMITER$                *0-0-0/w PTR         r     1 DELIMITER$
    36-0-0/w PTR         r     1 DELIMS$                   *0-0-0/w PTR         r     1 DELIMS$
   644-0-0/w PTR         r     1 DELIMS$$                  37-0-0/w PTR               1 DNT$$
   140-0-0/d STRC(288)   r     1 DO_BODY_ILS_LIST          40-0-0/w PTR         r     1 END_IF$
   554-0-0/w PTR         r     1 END_INDEX$                41-0-0/w PTR         r     1 END_INTO$
    43-0-0/w PTR         r     1 END_UNSTRING$            553-0-0/w PTR         r     1 ETT$$
    42-0-0/w PTR         r     1 EXIT_INTO_LOOP$           *0-0-0/w PTR         r     1 ID$
    *0-0-0/w PTR         r     1 ID$                      230-0-0/d STRC(288)   r     1 ID1
    44-0-0/w PTR         r     1 ID1$                      *0-0-0/w PTR         r     1 ID1$
    *0-0-0/w PTR         r     1 ID1$                      *0-0-0/w PTR         r     1 ID1$
    *0-0-0/w PTR         r     1 ID1$                     555-0-0/w SBIN        r     1 ID1_LEN
    64-0-0/w SBIN        r     1 ID1_LENGTH                45-0-0/w PTR         r     1 ID1_ST$
   553-0-0/w PTR         r     1 ID1_ST$                  240-0-0/d STRC(288)   r     1 ID2
    46-0-0/w PTR         r     1 ID2$                      *0-0-0/w PTR         r     1 ID2$
    *0-0-0/w PTR         r     1 ID2$                      47-0-0/c CHAR        r     1 ID2_CHAR
   651-0-0/w PTR         r     1 ID2_ST$                  250-0-0/d STRC(288)   r     1 ID4
    50-0-0/w PTR         r     1 ID4$                      *0-0-0/w PTR         r     1 ID4$
    *0-0-0/w PTR         r     1 ID4$                      *0-0-0/w PTR         r     1 ID4$
   260-0-0/d STRC(288)   r     1 ID5                       51-0-0/w PTR         r     1 ID5$
    *0-0-0/w PTR         r     1 ID5$                      *0-0-0/w PTR         r     1 ID5$
   270-0-0/d STRC(288)   r     1 ID6                       52-0-0/w PTR         r     1 ID6$
    *0-0-0/w PTR         r     1 ID6$                      *0-0-0/w PTR         r     1 ID6$
   430-0-0/d STRC(288)   r     1 ID6_DIVIDE_2             120-0-0/w PTR         r     1 ID6_DIVIDE_2$
   300-0-0/d STRC(288)   r     1 ID6_PLUS_ID7              53-0-0/w PTR         r     1 ID6_PLUS_ID7$
   310-0-0/d STRC(288)   r     1 ID7                       54-0-0/w PTR         r     1 ID7$
    *0-0-0/w PTR         r     1 ID7$                      *0-0-0/w PTR         r     1 ID7$
   420-0-0/d STRC(288)   r     1 ID7_DIVIDE_2             117-0-0/w PTR         r     1 ID7_DIVIDE_2$
   554-0-0/w SBIN        r     1 ID7_MAX                  121-0-0/w PTR               1 ID7_ST$
   410-0-0/d STRC(288)   r     1 ID7_TIMES_2              116-0-0/w PTR         r     1 ID7_TIMES_2$
   320-0-0/d STRC(288)   r     1 ID8                       55-0-0/w PTR         r     1 ID8$
    *0-0-0/w PTR         r     1 ID8$                      *0-0-0/w PTR         r     1 ID8$
    56-0-0/w PTR         r     1 IDENT$                    *0-0-0/w PTR         r     1 IDENT$
    *0-0-0/c CHAR        r     1 ID_CHAR                  553-0-0/w PTR         r     1 ID_CHAR$
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:433  
    57-0-0/w PTR         r     1 INTO$                     *0-0-0/w PTR         r     1 INTO$
    60-0-0/w PTR         r     1 INTO_LABEL$               61-0-0/w PTR         r     1 INTO_LIST$
    63-0-0/w SBIN        r     1 INTO_MAX                  62-0-0/w SBIN        r     1 INTO_NO
    *0-0-0/w SBIN        r     1 LENGTH                   330-0-0/d STRC(288)   r     1 LENGTH_ID1
   606-0-0/d STRC(288)   r     1 LENGTH_ID1                65-0-0/w PTR         r     1 LENGTH_ID1$
   642-0-0/w PTR         r     1 LENGTH_ID1$              552-0-0/d STRC(288)   r     1 LENGTH_ID1_PLUS_1
   551-0-0/w PTR         r     1 LENGTH_ID1_PLUS_1$       340-0-0/d STRC(288)   r     1 LENGTH_ID2
   616-0-0/d STRC(288)   r     1 LENGTH_ID2                66-0-0/w PTR         r     1 LENGTH_ID2$
   643-0-0/w PTR         r     1 LENGTH_ID2$              350-0-0/d STRC(288)   r     1 LENGTH_ID4
    67-0-0/w PTR         r     1 LENGTH_ID4$              360-0-0/d STRC(288)   r     1 LOW
    70-0-0/b BIT         r     1 LOW_VALUE_DELIM           71-0-0/w PTR         r     1 LTS$$
   370-0-0/d STRC(288)   r     1 MIN                       72-0-0/w PTR         r     1 MIN$
     6-0-0/w STRC(324)         1 NAME                      *0-0-0/w PTR         r     1 NOT_ON_OVERFLOW$
    73-0-0/w PTR         r     1 NOT_OVERFLOW_LABEL$       *0-0-0/w SBIN        r     1 OFFSET
   400-0-0/d STRC(288)   r     1 ONE                       74-0-0/w PTR         r     1 ONE$
    *0-0-0/w PTR         r     1 ON_OVERFLOW$              75-0-0/b BIT         r     1 OPTIMIZABLE
   556-0-0/w PTR         r     1 ORIGINAL_ID1_ETT$         76-0-0/b BIT         r     1 OVERFLOW
    77-0-0/w PTR         r     1 OVERFLOW_LABEL$          530-0-0/d STRC(288)   r     1 PLUS_ONE
   122-0-0/w PTR         r     1 PLUS_ONE$                100-0-0/b BIT         r     1 POINTER
   101-0-0/w PTR         r     1 POINTER$                  *0-0-0/w PTR         r     1 POINTER$
   440-0-0/d STRC(288)   r     1 POSITION                 102-0-0/w PTR         r     1 POSITION$
   103-0-0/b BIT         r     1 PRODUCE_UNSTRING_ILS     555-0-0/w PTR         r     1 RESULT$
   130-0-0/d STRC(288)   r     1 SAVED_ILS_LIST           450-0-0/d STRC(288)   r     1 SPACE_LX
   105-0-0/w PTR         r     1 SPACE_LX$                104-0-0/w PTR         r     1 ST$$
   160-0-0/d STRC(288)   r     1 SUB                      566-0-0/d STRC(288)   r     1 SUB
    20-0-0/w PTR         r     1 SUB$                     640-0-0/w PTR         r     1 SUB$
   106-0-0/w PTR         r     1 SUBSTR$                  637-0-0/w PTR         r     1 SUBSTR$
   540-0-0/d STRC(288)   r     1 SUB_ONE                  123-0-0/w PTR         r     1 SUB_ONE$
   460-0-0/d STRC(288)   r     1 SUB_STR                  626-0-0/d STRC(288)   r     1 SUB_STR
   470-0-0/d STRC(288)   r     1 TABLE                    107-0-0/w PTR         r     1 TABLE$
   500-0-0/d STRC(288)   r     1 TABLEVAL                 110-0-0/w PTR         r     1 TABLEVAL$
   111-0-0/w PTR         r     1 TABLE_ETT$               112-0-0/b BIT         r     1 TALLYING
   113-0-0/w PTR         r     1 TALLYING$                 *0-0-0/w PTR         r     1 TALLYING$
   510-0-0/d STRC(288)   r     1 TWO                      115-0-0/w PTR         r     1 TWO$
   124-0-0/w STRC(144)   r     1 TYPE_DESC                 *0-0-0/w PTR         r     1 UNSTRING$
   520-0-0/d STRC(288)   r     1 ZERO                     114-0-0/w PTR         r     1 ZERO$

PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:434  
  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w UBIN              1 ILL_STEP(0:144)
     0-0-0/w UBIN              1 ILS_STEP_TABLE(0:2)
     0-0-0/w UBIN              1 LTS_STEP(0:37)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(288)         1 ADD_STMT
     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(144)         1 ALTER_LTS
     0-0-0/w STRC(3672)        1 ALT_KEY                    0-0-0/w STRC(36864)       1 ARGLIST
     0-0-0/w STRC(396)         1 ARRAY                      0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS
     0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(108)   r     1 BINARY_ILL
     0-0-0/w STRC(288)   r     1 BINARY_OP                  0-0-0/w STRC(396)         1 BLOCK
     0-0-0/w STRC(144)         1 BRANCH_ILL                 0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(216)         1 CCOSU
     0-0-0/w STRC(396)         1 CD                         0-0-0/w STRC(288)         1 CD_LTS
     0-0-0/w CHAR(4096)  r     1 CHARS                      0-0-0/w STRC(396)         1 CLASS
     0-0-0/w STRC(108)         1 CODED_MOVE                 0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)   r     1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)         1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:435  
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(144)         1 DEFLB                      0-0-0/w STRC(288)         1 DELETE_STMT
     0-0-0/w STRC(108)         1 DEPENDING_SIZE             0-0-0/w STRC(5472)        1 DIMS
     0-0-0/w STRC(288)         1 DIVIDE_STMT                0-0-0/w STRC(396)         1 DML_ITEM
     0-0-0/w STRC(216)         1 DML_REC                    0-0-0/w ASTR(180)   r     1 DNT
     0-0-0/w STRC(144)         1 DOEND                      0-0-0/w STRC(396)         1 DO_N
     0-0-0/w STRC(180)         1 DV4I                       0-0-0/w STRC(180)         1 ENTRY_ILL
     0-0-0/w STRC(180)   r     1 ETT                        0-0-0/w STRC(108)         1 EVALU
     0-0-0/w STRC(73836)       1 EVALUATE                   0-0-0/w STRC(396)         1 FD
     0-0-0/w STRC(1692)        1 FILE_LTS                   0-0-0/w STRC(144)         1 GO
     0-0-0/w STRC(180)         1 ILL                        0-0-0/w STRC              1 ILL_NO_OPS
     0-0-0/w STRC(180)   r     1 ILS                        0-0-0/w STRC(288)   r     1 ILS_LIST
     0-0-0/w STRC(108)         1 INDEXES                    0-0-0/w STRC(360)         1 INIT_LTS
     0-0-0/w STRC(288)         1 INSPECT_1_STMT             0-0-0/w STRC(288)         1 INSPECT_2_STMT
     0-0-0/w STRC(288)         1 INSPECT_4_STMT             0-0-0/w STRC(396)         1 INTDEF
     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN           0-0-0/w STRC(144)         1 KEY
     0-0-0/w STRC(396)         1 LABEL                      0-0-0/w STRC(288)         1 LA_ITEM
     0-0-0/w STRC(36864) r     1 LCNST                      0-0-0/w STRC(108)         1 LINOI
     0-0-0/w STRC(72)          1 LONG                       0-0-0/w STRC        r     1 LTS
     0-0-0/w STRC(360)         1 LTSS                       0-0-0/w STRC(36936)       1 LTS_PTR_ARRAY
     0-0-0/w STRC(504)         1 LX_CD_INPUT                0-0-0/w STRC(324)         1 LX_CD_I_O
     0-0-0/w STRC(396)         1 LX_CD_OUTPUT               0-0-0/w STRC(288)   r     1 LX_ETT_ITEM
     0-0-0/w STRC(288)   r     1 LX_ITEM                    0-0-0/w STRC(288)         1 LX_LARGE
     0-0-0/w STRC(288)   r     1 LX_LIST                    0-0-0/w STRC(1224)        1 LX_REC_DECL
     0-0-0/w STRC(864)         1 LX_REPORT_REC              0-0-0/w STRC(288)   r     1 LX_TERMINAL
     0-0-0/w STRC(72)    r     1 MFILL                      0-0-0/w STRC(396)         1 MNEMONIC
     0-0-0/w STRC(288)         1 MULTIPLY_STMT              0-0-0/w STRC(180)         1 MULTI_GO
     0-0-0/w STRC(180)         1 MVEAL                      0-0-0/w STRC(108)         1 MVFIL
     0-0-0/w STRC(72)          1 MVIIS                      0-0-0/w STRC(144)         1 NEL
     0-0-0/w STRC(216)         1 OPEN_LTS                   0-0-0/w STRC(144)         1 OPN
     0-0-0/w STRC(180)         1 OS_CALL                    0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(396)         1 PARA                       0-0-0/w STRC(216)         1 PFORM
     0-0-0/w STRC(144)         1 PINC                       0-0-0/w STRC(144)         1 PREOFF
     0-0-0/w STRC(108)         1 PRESET                     0-0-0/w STRC(144)         1 PRIME
     0-0-0/w STRC(396)         1 PROC_                      0-0-0/w STRC(396)         1 PROC_DEF
     0-0-0/w STRC(900)         1 PROC_SUPP                  0-0-0/w STRC(144)         1 P_A_PRESET
     0-0-0/w STRC(144)         1 P_P_PRESET                 0-0-0/w STRC(396)         1 RD
PL6.E3A0      #002=Z8EZ$UNSTRING File=Z8EZ.:Z8A6TSI                              SAT 08/09/97 13:03 Page:436  
     0-0-0/w STRC(288)         1 READ_STMT                  0-0-0/w STRC(216)         1 REF
     0-0-0/w STRC(144)         1 REMEM                      0-0-0/w STRC(108)         1 RENAMES
     0-0-0/w STRC(720)         1 REPORT_01_LTS              0-0-0/w STRC(432)         1 REPORT_ELEM_LTS
     0-0-0/w STRC(252)         1 REPORT_GRP_LTS             0-0-0/w STRC(1332)        1 REPORT_LTS
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(144)         1 RVA_LTS
     0-0-0/w STRC(396)   r     1 SCALAR                     0-0-0/w STRC(144)         1 SCOPE
     0-0-0/w STRC(396)         1 SD                         0-0-0/w STRC(216)         1 SEARCH_
     0-0-0/w STRC(396)         1 SECTION                    0-0-0/w STRC(396)         1 SEGMENT
     0-0-0/w STRC(360)         1 SEGMENT_LTS                0-0-0/w STRC(396)   r     1 ST
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(72)          1 STP2
     0-0-0/w STRC(252)         1 STRING_STMT                0-0-0/w STRC(288)         1 SUBTRACT_STMT
     0-0-0/w STRC(252)         1 SUM_LTS                    0-0-0/w STRC(396)         1 SWITCH
     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR              0-0-0/w STRC(396)         1 SYMDEF_
     0-0-0/w STRC(396)         1 SYMREF_                    0-0-0/w STRC(396)         1 TEMP
     0-0-0/w STRC(144)   r     1 TRINARY_ILL                0-0-0/w STRC(72)    r     1 UNARY_ILL
     0-0-0/w STRC(288)         1 UNARY_OP                   0-0-0/w STRC(288)   r     1 UNSTRING_STMT
     0-0-0/d STRC(612)         1 USE                        0-0-0/w STRC(216)         1 USER_CALL
     0-0-0/w STRC(252)         1 USE_SUPP                   0-0-0/w STRC(108)         1 VAL
     0-0-0/w STRC(108)         1 VAL_END                    0-0-0/w STRC(396)   r     1 VARIABLE
     0-0-0/w STRC(72)          1 WHEN                       0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EZ$UNSTRING requires 3521 words for executable code.
   Procedure Z8EZ$UNSTRING requires 432 words of local(AUTO) storage.

PL6.E3A0      #003=Z8EZ$SEARCH File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:07 Page:437  
     2773        1        /*T***********************************************************/
     2774        2        /*T*                                                         */
     2775        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2776        4        /*T*                                                         */
     2777        5        /*T***********************************************************/
     2778        6
     2779        7        Z8EZ$SEARCH: PROC (POSITION$, TABLEVAL$, TABLE$, CLUE$, ALTRET$) ;
     2780        8
     2781        9        /*D*   NAME: Z8EZ$SEARCH
     2782       10
     2783       11        DESCRIPTION: SEE PL/6 SEARCH BUILTIN.
     2784       12        */
     2785       13
     2786       14        %SET PHASE = 1 ;
     2787       15        %INCLUDE Z8A_DEFC ;
     2788       83        %INCLUDE Z8A_SUPP_MAC ;
     2789     2483        %INCLUDE Z8A_TYPES ;
     2790     2657        %INCLUDE Z8E_MACROS ;
     2791     3332        %INCLUDE Z8A_ILL ;
     2792     4025        %INCLUDE Z8A_ST ;
     2793     7684        %INCLUDE Z8E_STACKS ;
     2794     9950        %INCLUDE Z8E_O1COM ;
     2795    10711
     2796    10712    1   DCL  POSITION$         PTR ; /* OUTPUT ARG */
     2797    10713    1   DCL  TABLEVAL$         PTR ; /* OUTPUT ARG */
     2798    10714    1   DCL  TABLE$            PTR ; /* INPUT ARG */
     2799    10715    1   DCL  CLUE$             PTR ; /* INPUT ARG */
     2800    10716    1   DCL  ALTRET$           PTR ; /* OUTPUT ARG */
     2801    10717
     2802    10718    2        IF TABLEVAL$ = ADDR(NIL) THEN DO ;
     2803    10719               %NEW_ILL (@ID  = %SEARCH,
     2804    10720                         @LOP = CLUE$ -> LX_ETT_ITEM.ETT$,
     2805    10721                         @ROP = TABLE$ -> LX_ETT_ITEM.ETT$,
     2806    10722                         @TO  = POSITION$ -> LX_ETT_ITEM.ETT$,
     2807    10723                         @ALTRET = ALTRET$) ;
     2808    11102    2        END ;
     2809    11103    2        ELSE DO ;
PL6.E3A0      #003=Z8EZ$SEARCH File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:07 Page:438  
     2810    11104               %NEW_ILL (@ID = %SEARCH,
     2811    11105                         @LOP = CLUE$ -> LX_ETT_ITEM.ETT$,
     2812    11106                         @ROP = TABLE$ -> LX_ETT_ITEM.ETT$,
     2813    11107                         @TO  = POSITION$ -> LX_ETT_ITEM.ETT$,
     2814    11108                         @TABLEVAL = TABLEVAL$ -> LX_ETT_ITEM.ETT$,
     2815    11109                         @ALTRET = ALTRET$) ;
     2816    11488    2          TABLEVAL$ -> LX_ETT_ITEM.TYPE = %TYA ;
     2817    11489    2        END ;
     2818    11490
     2819    11491    1        POSITION$ -> LX_ETT_ITEM.TYPE = %TYI ;
     2820    11492
     2821    11493    2        IF ALTRET$ ~= ADDR(NIL) THEN DO ;
     2822    11494    2          ALTRET$ -> PARA.B.REFERENCED = '1'B ;
     2823    11495    2        END ;
     2824    11496
     2825    11497    1   END Z8EZ$SEARCH ;
     2826    11498        %EOD;

PL6.E3A0      #003=Z8EZ$SEARCH File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:07 Page:439  
--  Include file information  --

   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EZ$SEARCH.

   Procedure Z8EZ$SEARCH requires 94 words for executable code.
   Procedure Z8EZ$SEARCH requires 16 words of local(AUTO) storage.

PL6.E3A0      #003=Z8EZ$SEARCH File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:07 Page:440  

 Object Unit name= Z8EZ$SEARCH                                File name= Z8EZ.:Z8A6TOU
 UTS= AUG 09 '97 13:07:57.68 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  ILL$
    2  LblCom even  none     5      5  ILL_
    3  LblCom even  none     1      1  ST$
    4  LblCom even  none     5      5  ST_
    5  LblCom even  none    90    132  LEX_SYMBOL
    6  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
    7  LblCom even  none    90    132  TEMP_LEX_SYMBOL
    8  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
    9   Proc  even  none    94    136  Z8EZ$SEARCH
   10  RoData even  none    14     16  Z8EZ$SEARCH

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     9      0   yes            yes      Std        5  Z8EZ$SEARCH

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       5 Z8AN$NEW_ILL1
         yes           Std       6 Z8AN$NEW_ILL2
                       nStd      0 X66_AUTO_5
                       nStd      0 X66_ARET
PL6.E3A0      #003=Z8EZ$SEARCH File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:07 Page:441  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    ILL_STEP                              O1COM                                 HIER_STK_PTR
     HIER_STK                              PAGE_FORMAT                           REP_STK_PTR
     REP_STK

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #003=Z8EZ$SEARCH File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:07 Page:442  


     2773        1        /*T***********************************************************/
     2774        2        /*T*                                                         */
     2775        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2776        4        /*T*                                                         */
     2777        5        /*T***********************************************************/
     2778        6
     2779        7        Z8EZ$SEARCH: PROC (POSITION$, TABLEVAL$, TABLE$, CLUE$, ALTRET$) ;

      7  9 000000   000000 700200 xent  Z8EZ$SEARCH  TSX0  ! X66_AUTO_5
         9 000001   000020 000005                    ZERO    16,5

     2780        8
     2781        9        /*D*   NAME: Z8EZ$SEARCH
     2782       10
     2783       11        DESCRIPTION: SEE PL/6 SEARCH BUILTIN.
     2784       12        */
     2785       13
     2786       14        %SET PHASE = 1 ;
     2787       15        %INCLUDE Z8A_DEFC ;
     2788       83        %INCLUDE Z8A_SUPP_MAC ;
     2789     2483        %INCLUDE Z8A_TYPES ;
     2790     2657        %INCLUDE Z8E_MACROS ;
     2791     3332        %INCLUDE Z8A_ILL ;
     2792     4025        %INCLUDE Z8A_ST ;
     2793     7684        %INCLUDE Z8E_STACKS ;
     2794     9950        %INCLUDE Z8E_O1COM ;
     2795    10711
     2796    10712    1   DCL  POSITION$         PTR ; /* OUTPUT ARG */
     2797    10713    1   DCL  TABLEVAL$         PTR ; /* OUTPUT ARG */
     2798    10714    1   DCL  TABLE$            PTR ; /* INPUT ARG */
     2799    10715    1   DCL  CLUE$             PTR ; /* INPUT ARG */
     2800    10716    1   DCL  ALTRET$           PTR ; /* OUTPUT ARG */
     2801    10717
     2802    10718    2        IF TABLEVAL$ = ADDR(NIL) THEN DO ;

  10718  9 000002   200004 470500                    LDP0    @TABLEVAL$,,AUTO
PL6.E3A0      #003=Z8EZ$SEARCH File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:07 Page:443  
         9 000003   000000 236100                    LDQ     0,,PR0
         9 000004   000000 116000 10                 CMPQ    0
         9 000005   000051 601000 9                  TNZ     s:11396

     2803    10719               %NEW_ILL (@ID  = %SEARCH,
     2804    10720                         @LOP = CLUE$ -> LX_ETT_ITEM.ETT$,
     2805    10721                         @ROP = TABLE$ -> LX_ETT_ITEM.ETT$,
     2806    10722                         @TO  = POSITION$ -> LX_ETT_ITEM.ETT$,
     2807    10723                         @ALTRET = ALTRET$) ;

  11007  9 000006   200003 471500                    LDP1    @POSITION$,,AUTO
         9 000007   100000 473500                    LDP3    0,,PR1
         9 000010   000004 236000 10                 LDQ     4
         9 000011   200010 756100                    STQ     @ALTRET$+1,,AUTO
         9 000012   300001 634500                    EPPR4   1,,PR3
         9 000013   200015 454500                    STP4    @ALTRET$+6,,AUTO
         9 000014   200010 633500                    EPPR3   @ALTRET$+1,,AUTO
         9 000015   200014 453500                    STP3    @ALTRET$+5,,AUTO
         9 000016   000006 237000 10                 LDAQ    6
         9 000017   200012 757100                    STAQ    @ALTRET$+3,,AUTO
         9 000020   000010 236000 10                 LDQ     8
         9 000021   200011 756100                    STQ     @ALTRET$+2,,AUTO
         9 000022   200011 630500                    EPPR0   @ALTRET$+2,,AUTO
         9 000023   000001 631400 10                 EPPR1   1
         9 000024   000000 701000 xent               TSX1    Z8AN$NEW_ILL1
         9 000025   000000 011000                    NOP     0

  11013  9 000026   200006 470500                    LDP0    @CLUE$,,AUTO
         9 000027   000000 471500                    LDP1    0,,PR0
         9 000030   100001 236100                    LDQ     1,,PR1
         9 000031   000000 473400 1                  LDP3    ILL$
         9 000032   300001 756100                    STQ     1,,PR3

  11014  9 000033   200005 471500                    LDP1    @TABLE$,,AUTO
         9 000034   100000 474500                    LDP4    0,,PR1
         9 000035   400001 236100                    LDQ     1,,PR4
         9 000036   300002 756100                    STQ     2,,PR3
PL6.E3A0      #003=Z8EZ$SEARCH File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:07 Page:444  

  11015  9 000037   200003 474500                    LDP4    @POSITION$,,AUTO
         9 000040   400000 475500                    LDP5    0,,PR4
         9 000041   500001 236100                    LDQ     1,,PR5
         9 000042   300003 756100                    STQ     3,,PR3

  11017  9 000043   000000 236000 10                 LDQ     0
         9 000044   300004 756100                    STQ     4,,PR3

  11024  9 000045   200007 475500                    LDP5    @ALTRET$,,AUTO
         9 000046   500000 236100                    LDQ     0,,PR5
         9 000047   300005 756100                    STQ     5,,PR3

     2808    11102    2        END ;

  11102  9 000050   000123 710000 9                  TRA     s:11491

     2809    11103    2        ELSE DO ;

     2810    11104               %NEW_ILL (@ID = %SEARCH,
     2811    11105                         @LOP = CLUE$ -> LX_ETT_ITEM.ETT$,
     2812    11106                         @ROP = TABLE$ -> LX_ETT_ITEM.ETT$,
     2813    11107                         @TO  = POSITION$ -> LX_ETT_ITEM.ETT$,
     2814    11108                         @TABLEVAL = TABLEVAL$ -> LX_ETT_ITEM.ETT$,
     2815    11109                         @ALTRET = ALTRET$) ;

  11396  9 000051   200003 471500                    LDP1    @POSITION$,,AUTO
         9 000052   100000 473500                    LDP3    0,,PR1
         9 000053   000000 474500                    LDP4    0,,PR0
         9 000054   000004 236000 10                 LDQ     4
         9 000055   200010 756100                    STQ     @ALTRET$+1,,AUTO
         9 000056   400001 635500                    EPPR5   1,,PR4
         9 000057   200017 455500                    STP5    @ALTRET$+8,,AUTO
         9 000060   300001 634500                    EPPR4   1,,PR3
         9 000061   200016 454500                    STP4    @ALTRET$+7,,AUTO
         9 000062   200010 633500                    EPPR3   @ALTRET$+1,,AUTO
         9 000063   200015 453500                    STP3    @ALTRET$+6,,AUTO
PL6.E3A0      #003=Z8EZ$SEARCH File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:07 Page:445  
         9 000064   000007 236000 10                 LDQ     7
         9 000065   200014 756100                    STQ     @ALTRET$+5,,AUTO
         9 000066   000014 237000 10                 LDAQ    12
         9 000067   200012 757100                    STAQ    @ALTRET$+3,,AUTO
         9 000070   200012 630500                    EPPR0   @ALTRET$+3,,AUTO
         9 000071   000011 631400 10                 EPPR1   9
         9 000072   000000 701000 xent               TSX1    Z8AN$NEW_ILL2
         9 000073   000000 011000                    NOP     0

  11399  9 000074   200006 470500                    LDP0    @CLUE$,,AUTO
         9 000075   000000 471500                    LDP1    0,,PR0
         9 000076   100001 236100                    LDQ     1,,PR1
         9 000077   000000 473400 1                  LDP3    ILL$
         9 000100   300001 756100                    STQ     1,,PR3

  11400  9 000101   200005 471500                    LDP1    @TABLE$,,AUTO
         9 000102   100000 474500                    LDP4    0,,PR1
         9 000103   400001 236100                    LDQ     1,,PR4
         9 000104   300002 756100                    STQ     2,,PR3

  11401  9 000105   200003 474500                    LDP4    @POSITION$,,AUTO
         9 000106   400000 475500                    LDP5    0,,PR4
         9 000107   500001 236100                    LDQ     1,,PR5
         9 000110   300003 756100                    STQ     3,,PR3

  11405  9 000111   200004 475500                    LDP5    @TABLEVAL$,,AUTO
         9 000112   500000 476500                    LDP6    0,,PR5
         9 000113   600001 236100                    LDQ     1,,PR6
         9 000114   300004 756100                    STQ     4,,PR3

  11410  9 000115   200007 476500                    LDP6    @ALTRET$,,AUTO
         9 000116   600000 236100                    LDQ     0,,PR6
         9 000117   300005 756100                    STQ     5,,PR3

     2816    11488    2          TABLEVAL$ -> LX_ETT_ITEM.TYPE = %TYA ;

  11488  9 000120   500000 477500                    LDP7    0,,PR5
PL6.E3A0      #003=Z8EZ$SEARCH File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:07 Page:446  
         9 000121   000010 235007                    LDA     8,DL
         9 000122   700004 755100                    STA     4,,PR7

     2817    11489    2        END ;

     2818    11490
     2819    11491    1        POSITION$ -> LX_ETT_ITEM.TYPE = %TYI ;

  11491  9 000123   400000 475500                    LDP5    0,,PR4
         9 000124   000001 235007                    LDA     1,DL
         9 000125   500004 755100                    STA     4,,PR5

     2820    11492
     2821    11493    2        IF ALTRET$ ~= ADDR(NIL) THEN DO ;

  11493  9 000126   200007 475500                    LDP5    @ALTRET$,,AUTO
         9 000127   500000 236100                    LDQ     0,,PR5
         9 000130   000000 116000 10                 CMPQ    0
         9 000131   000135 600000 9                  TZE     s:11497

     2822    11494    2          ALTRET$ -> PARA.B.REFERENCED = '1'B ;

  11494  9 000132   500000 476500                    LDP6    0,,PR5
         9 000133   400000 236003                    LDQ     -131072,DU
         9 000134   600003 256100                    ORSQ    3,,PR6

     2823    11495    2        END ;

     2824    11496
     2825    11497    1   END Z8EZ$SEARCH ;

  11497  9 000135   000000 702200 xent               TSX2  ! X66_ARET
     2826    11498        %EOD;

PL6.E3A0      #003=Z8EZ$SEARCH File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:07 Page:447  
--  Include file information  --

   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EZ$SEARCH.
PL6.E3A0      #003=Z8EZ$SEARCH File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:07 Page:448  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 002 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILL_

  ****  Section 003 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 004 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

PL6.E3A0      #003=Z8EZ$SEARCH File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:07 Page:449  
  ****  Section 005 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 006 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 007 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 008 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     7-0-0/w PTR         r     1 @ALTRET$                   6-0-0/w PTR         r     1 @CLUE$
     3-0-0/w PTR         r     1 @POSITION$                 5-0-0/w PTR         r     1 @TABLE$
     4-0-0/w PTR         r     1 @TABLEVAL$                *0-0-0/w PTR         r     1 ALTRET$
    *0-0-0/w PTR         r     1 CLUE$                     *0-0-0/w PTR         r     1 POSITION$
PL6.E3A0      #003=Z8EZ$SEARCH File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:07 Page:450  
    *0-0-0/w PTR         r     1 TABLE$                    *0-0-0/w PTR         r     1 TABLEVAL$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w UBIN              1 ILL_STEP(0:144)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(288)         1 ADD_STMT
     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(396)         1 ARRAY
     0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(108)         1 BINARY_ILL                 0-0-0/w STRC(288)         1 BINARY_OP
     0-0-0/w STRC(396)         1 BLOCK                      0-0-0/w STRC(144)         1 BRANCH_ILL
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(216)         1 CCOSU
     0-0-0/w STRC(396)         1 CD                         0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(396)         1 CLASS                      0-0-0/w STRC(108)         1 CODED_MOVE
     0-0-0/w STRC(288)         1 COMPUTE_STMT               0-0-0/w STRC(396)         1 CONDITION
     0-0-0/w STRC(396)         1 CONST                      0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(396)         1 DB                         0-0-0/w STRC(396)         1 DCB_
     0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER         0-0-0/w STRC(252)         1 DEFERED_ID_TREE
     0-0-0/w STRC(288)         1 DEFERED_QUAL_ID            0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(144)         1 DEFLB                      0-0-0/w STRC(288)         1 DELETE_STMT
     0-0-0/w STRC(288)         1 DIVIDE_STMT                0-0-0/w STRC(396)         1 DML_ITEM
     0-0-0/w STRC(144)         1 DOEND                      0-0-0/w STRC(396)         1 DO_N
     0-0-0/w STRC(180)         1 DV4I                       0-0-0/w STRC(180)         1 ENTRY_ILL
     0-0-0/w STRC(108)         1 EVALU                      0-0-0/w STRC(396)         1 FD
PL6.E3A0      #003=Z8EZ$SEARCH File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:07 Page:451  
     0-0-0/w STRC(144)         1 GO                         0-0-0/w STRC(180)         1 ILL
     0-0-0/w STRC              1 ILL_NO_OPS                 0-0-0/w STRC(288)         1 ILS_LIST
     0-0-0/w STRC(288)         1 INSPECT_1_STMT             0-0-0/w STRC(288)         1 INSPECT_2_STMT
     0-0-0/w STRC(288)         1 INSPECT_4_STMT             0-0-0/w STRC(396)         1 INTDEF
     0-0-0/w STRC(396)         1 LABEL                      0-0-0/w STRC(288)         1 LA_ITEM
     0-0-0/w STRC(108)         1 LINOI                      0-0-0/w STRC(504)         1 LX_CD_INPUT
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)   r     1 LX_ETT_ITEM                0-0-0/w STRC(288)         1 LX_ITEM
     0-0-0/w STRC(288)         1 LX_LARGE                   0-0-0/w STRC(288)         1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
     0-0-0/w STRC(288)         1 LX_TERMINAL                0-0-0/w STRC(72)          1 MFILL
     0-0-0/w STRC(396)         1 MNEMONIC                   0-0-0/w STRC(288)         1 MULTIPLY_STMT
     0-0-0/w STRC(180)         1 MULTI_GO                   0-0-0/w STRC(180)         1 MVEAL
     0-0-0/w STRC(108)         1 MVFIL                      0-0-0/w STRC(72)          1 MVIIS
     0-0-0/w STRC(180)         1 OS_CALL                    0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(396)   r     1 PARA                       0-0-0/w STRC(216)         1 PFORM
     0-0-0/w STRC(144)         1 PINC                       0-0-0/w STRC(144)         1 PREOFF
     0-0-0/w STRC(108)         1 PRESET                     0-0-0/w STRC(396)         1 PROC_
     0-0-0/w STRC(396)         1 PROC_DEF                   0-0-0/w STRC(144)         1 P_A_PRESET
     0-0-0/w STRC(144)         1 P_P_PRESET                 0-0-0/w STRC(396)         1 RD
     0-0-0/w STRC(288)         1 READ_STMT                  0-0-0/w STRC(144)         1 REMEM
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(396)         1 SCALAR
     0-0-0/w STRC(144)         1 SCOPE                      0-0-0/w STRC(396)         1 SD
     0-0-0/w STRC(216)   r     1 SEARCH_                    0-0-0/w STRC(396)         1 SECTION
     0-0-0/w STRC(396)         1 SEGMENT                    0-0-0/w STRC(396)         1 ST
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(72)          1 STP2
     0-0-0/w STRC(252)         1 STRING_STMT                0-0-0/w STRC(288)         1 SUBTRACT_STMT
     0-0-0/w STRC(396)         1 SWITCH                     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR
     0-0-0/w STRC(396)         1 SYMDEF_                    0-0-0/w STRC(396)         1 SYMREF_
     0-0-0/w STRC(396)         1 TEMP                       0-0-0/w STRC(144)         1 TRINARY_ILL
     0-0-0/w STRC(72)          1 UNARY_ILL                  0-0-0/w STRC(288)         1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/w STRC(216)         1 USER_CALL
     0-0-0/w STRC(108)         1 VAL                        0-0-0/w STRC(108)         1 VAL_END
     0-0-0/w STRC(396)         1 VARIABLE                   0-0-0/w STRC(72)          1 WHEN
     0-0-0/w STRC(288)         1 WRITE_STMT

PL6.E3A0      #003=Z8EZ$SEARCH File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:07 Page:452  

   Procedure Z8EZ$SEARCH requires 94 words for executable code.
   Procedure Z8EZ$SEARCH requires 16 words of local(AUTO) storage.

PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:453  
     2827        1        /*T***********************************************************/
     2828        2        /*T*                                                         */
     2829        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2830        4        /*T*                                                         */
     2831        5        /*T***********************************************************/
     2832        6        Z8EZ$VALUES:PROC(ITEM$, VALUE);
     2833        7
     2834        8    1        DCL ITEM$        PTR;
     2835        9    1        DCL VALUE        SBIN WORD;
     2836       10
     2837       11
     2838       12             %EQU PHASE = 0;
     2839       13             %INCLUDE Z8A_DEFC;
     2840       81             %INCLUDE Z8A_SUPP_MAC;
     2841     2481             %INCLUDE Z8A_TYPES;
     2842     2655             %INCLUDE Z8A_DESC;
     2843     2701             %INCLUDE Z8A_ST;
     2844     6360
     2845     6361    1        DCL Z8AU$TYPE_DESCRIPTOR                     ENTRY(2);
     2846     6362
     2847     6363    1        DCL I           SBIN WORD;
     2848     6364
     2849     6365    1        DCL 1 TYPE_DESC ALIGNED,
     2850     6366                   %TYPE_DESC;
     2851     6400
     2852     6401             %EQU  MAX_SBIN = 34359738367 ; /* 34,359,738,367 = 2^35 - 1 */
     2853     6402             %EQU  MAX_SD10 = 3435973836  ; /*  3,435,973,836 = 2^35 / 10 */
     2854     6403
     2855     6404        %EJECT;
PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:454  
     2856     6405    1   Z8EZ$MAX_VALUE:ENTRY(ITEM$, VALUE);
     2857     6406
     2858     6407    1        CALL Z8AU$TYPE_DESCRIPTOR(ITEM$, TYPE_DESC);
     2859     6408
     2860     6409    2        DO CASE(TYPE_DESC.TYPE);
     2861     6410    2          CASE(%TYI);
     2862     6411    2            VALUE = %MAX_SBIN;
     2863     6412
     2864     6413    2          CASE(%TYH);
     2865     6414    2            VALUE = 131071;
     2866     6415
     2867     6416    2          CASE(%TYK);
     2868     6417    2            VALUE = 2147483647;
     2869     6418
     2870     6419    2          CASE(%TYJ);
     2871     6420    2            VALUE = 32767;
     2872     6421
     2873     6422    2          CASE(%TYD, %TYO, %TYF, %TYC);
     2874     6423                 %UNPACK_NDSC( @DESC       = TYPE_DESC.DESC,
     2875     6424                               @LENGTH     = LENGTH );
     2876     6479
     2877     6480    2            VALUE = 10;
     2878     6481
     2879     6482    3   MAX_DEC: DO I = 2 TO LENGTH;
     2880     6483    3              IF VALUE > %MAX_SD10 THEN
     2881     6484    4                DO;
     2882     6485    4                  VALUE = %MAX_SBIN;
     2883     6486    4                  EXIT MAX_DEC;
     2884     6487    4                END; /* VALUE > Max_SBIN / 10 */
     2885     6488    3              ELSE
     2886     6489    3                VALUE = VALUE * 10;
     2887     6490    3            END; /* MAX_DEC */
     2888     6491
     2889     6492    2            VALUE = VALUE - 1;
     2890     6493
     2891     6494    2        END /* Case */;
     2892     6495
PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:455  
     2893     6496    1        RETURN;
     2894     6497
     2895     6498        %EJECT;
PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:456  
     2896     6499    1   Z8EZ$MIN_VALU:ENTRY(ITEM$, VALUE);
     2897     6500
     2898     6501
     2899     6502    1        CALL Z8AU$TYPE_DESCRIPTOR(ITEM$, TYPE_DESC);
     2900     6503
     2901     6504    2        DO CASE(TYPE_DESC.TYPE);
     2902     6505    2          CASE(%TYI);
     2903     6506    2            VALUE = BITBIN('400000000000'O);
     2904     6507
     2905     6508    2          CASE(%TYH);
     2906     6509    2            VALUE = - 131072;
     2907     6510
     2908     6511    2          CASE(%TYK);
     2909     6512    2            VALUE = - 2147483648;
     2910     6513
     2911     6514    2          CASE(%TYJ);
     2912     6515    2            VALUE = - 32768;
     2913     6516
     2914     6517    2          CASE(%TYD, %TYF, %TYC);
     2915     6518                 %UNPACK_NDSC( @DESC      = TYPE_DESC.DESC ,
     2916     6519                               @SIGN      = SIGN ,
     2917     6520                               @LENGTH    = LENGTH );
     2918     6575
     2919     6576    2            IF SIGN = %NO_SIGN THEN
     2920     6577    2              VALUE = 0;
     2921     6578    2            ELSE
     2922     6579    3              DO;
     2923     6580    3                VALUE = 10;
     2924     6581
     2925     6582    4   MIN_DEC:     DO I = 2 TO LENGTH;
     2926     6583    4                  IF VALUE > %MAX_SD10 THEN
     2927     6584    5                    DO;
     2928     6585    5                      VALUE = %MAX_SBIN;
     2929     6586    5                      EXIT MIN_DEC;
     2930     6587    5                    END; /* VALUE > Max_SBIN / 10 */
     2931     6588    4                  ELSE
     2932     6589    4                    VALUE = VALUE * 10;
PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:457  
     2933     6590    4                END; /* MIN_DEC */
     2934     6591    3                VALUE = - (VALUE - 1);
     2935     6592    3              END;
     2936     6593
     2937     6594    2          CASE(%TYO);
     2938     6595    2            LENGTH = TYPE_DESC.DESC.NDSC.N;
     2939     6596    2            VALUE = 10;
     2940     6597
     2941     6598    3   MIN_TYO: DO I = 2 TO LENGTH;
     2942     6599    3              IF VALUE > %MAX_SD10 THEN
     2943     6600    4                DO;
     2944     6601    4                  VALUE = %MAX_SBIN;
     2945     6602    4                  EXIT MIN_TYO;
     2946     6603    4                END; /* VALUE > Max_SBIN / 10 */
     2947     6604    3              ELSE
     2948     6605    3                VALUE = VALUE * 10;
     2949     6606    3            END; /* MIN_TYO */
     2950     6607
     2951     6608    2            VALUE = - (VALUE - 1) ;
     2952     6609
     2953     6610    2        END /* Case */;
     2954     6611    1        RETURN;
     2955     6612
     2956     6613    1   END Z8EZ$VALUES;

PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:458  
--  Include file information  --

   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DESC.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EZ$VALUES.

   Procedure Z8EZ$VALUES requires 252 words for executable code.
   Procedure Z8EZ$VALUES requires 20 words of local(AUTO) storage.

    No errors detected in file Z8EZ.:Z8A6TSI    .

PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:459  

 Object Unit name= Z8EZ$VALUES                                File name= Z8EZ.:Z8A6TOU
 UTS= AUG 09 '97 13:09:23.08 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  ST$
    2  LblCom even  none     5      5  ST_
    3  RoData even  UTS      1      1  Z8EZ$VALUES
    4   Proc  even  none   252    374  Z8EZ$VALUES
    5  RoData even  none     5      5  Z8EZ$VALUES

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        2  Z8EZ$VALUES
     4      3                  yes      Std        2  Z8EZ$MAX_VALUE
     4    153                  yes      Std        2  Z8EZ$MIN_VALU

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 Z8AU$TYPE_DESCRIPTOR
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:460  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID
PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:461  


     2827        1        /*T***********************************************************/
     2828        2        /*T*                                                         */
     2829        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2830        4        /*T*                                                         */
     2831        5        /*T***********************************************************/
     2832        6        Z8EZ$VALUES:PROC(ITEM$, VALUE);

      6  4 000000   000000 700200 xent  Z8EZ$VALUES  TSX0  ! X66_AUTO_2
         4 000001   000024 000002                    ZERO    20,2
         4 000002   000005 710000 4                  TRA     s:6407

     2833        7
     2834        8    1        DCL ITEM$        PTR;
     2835        9    1        DCL VALUE        SBIN WORD;
     2836       10
     2837       11
     2838       12             %EQU PHASE = 0;
     2839       13             %INCLUDE Z8A_DEFC;
     2840       81             %INCLUDE Z8A_SUPP_MAC;
     2841     2481             %INCLUDE Z8A_TYPES;
     2842     2655             %INCLUDE Z8A_DESC;
     2843     2701             %INCLUDE Z8A_ST;
     2844     6360
     2845     6361    1        DCL Z8AU$TYPE_DESCRIPTOR                     ENTRY(2);
     2846     6362
     2847     6363    1        DCL I           SBIN WORD;
     2848     6364
     2849     6365    1        DCL 1 TYPE_DESC ALIGNED,
     2850     6366                   %TYPE_DESC;
     2851     6400
     2852     6401             %EQU  MAX_SBIN = 34359738367 ; /* 34,359,738,367 = 2^35 - 1 */
     2853     6402             %EQU  MAX_SD10 = 3435973836  ; /*  3,435,973,836 = 2^35 / 10 */
     2854     6403
     2855     6404        %EJECT;
PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:462  
     2856     6405    1   Z8EZ$MAX_VALUE:ENTRY(ITEM$, VALUE);

   6405  4 000003   000000 700200 xent  Z8EZ$MAX_VA* TSX0  ! X66_AUTO_2
         4 000004   000024 000002                    ZERO    20,2

     2857     6406
     2858     6407    1        CALL Z8AU$TYPE_DESCRIPTOR(ITEM$, TYPE_DESC);

   6407  4 000005   200016 630500                    EPPR0   TYPE_DESC,,AUTO
         4 000006   200023 450500                    STP0    TYPE_DESC+5,,AUTO
         4 000007   200003 236100                    LDQ     @ITEM$,,AUTO
         4 000010   200022 756100                    STQ     TYPE_DESC+4,,AUTO
         4 000011   200022 630500                    EPPR0   TYPE_DESC+4,,AUTO
         4 000012   000000 631400 5                  EPPR1   0
         4 000013   000000 701000 xent               TSX1    Z8AU$TYPE_DESCRIPTOR
         4 000014   000000 011000                    NOP     0

     2859     6408
     2860     6409    2        DO CASE(TYPE_DESC.TYPE);

   6409  4 000015   200016 235100                    LDA     TYPE_DESC,,AUTO
         4 000016   000024 115007                    CMPA    20,DL
         4 000017   000021 602005 4                  TNC     s:6409+4,AL
         4 000020   000152 710000 4                  TRA     s:6496
         4 000021   000065 710000 4                  TRA     s:6431
         4 000022   000045 710000 4                  TRA     s:6411
         4 000023   000061 710000 4                  TRA     s:6420
         4 000024   000065 710000 4                  TRA     s:6431
         4 000025   000152 710000 4                  TRA     s:6496
         4 000026   000152 710000 4                  TRA     s:6496
         4 000027   000152 710000 4                  TRA     s:6496
         4 000030   000051 710000 4                  TRA     s:6414
         4 000031   000152 710000 4                  TRA     s:6496
         4 000032   000152 710000 4                  TRA     s:6496
         4 000033   000152 710000 4                  TRA     s:6496
         4 000034   000065 710000 4                  TRA     s:6431
         4 000035   000152 710000 4                  TRA     s:6496
PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:463  
         4 000036   000152 710000 4                  TRA     s:6496
         4 000037   000152 710000 4                  TRA     s:6496
         4 000040   000055 710000 4                  TRA     s:6417
         4 000041   000152 710000 4                  TRA     s:6496
         4 000042   000152 710000 4                  TRA     s:6496
         4 000043   000152 710000 4                  TRA     s:6496
         4 000044   000065 710000 4                  TRA     s:6431

     2861     6410    2          CASE(%TYI);

     2862     6411    2            VALUE = %MAX_SBIN;

   6411  4 000045   000001 236000 5                  LDQ     1
         4 000046   200004 470500                    LDP0    @VALUE,,AUTO
         4 000047   000000 756100                    STQ     0,,PR0
         4 000050   000152 710000 4                  TRA     s:6496

     2863     6412
     2864     6413    2          CASE(%TYH);

     2865     6414    2            VALUE = 131071;

   6414  4 000051   377777 236007                    LDQ     131071,DL
         4 000052   200004 470500                    LDP0    @VALUE,,AUTO
         4 000053   000000 756100                    STQ     0,,PR0
         4 000054   000152 710000 4                  TRA     s:6496

     2866     6415
     2867     6416    2          CASE(%TYK);

     2868     6417    2            VALUE = 2147483647;

   6417  4 000055   000002 236000 5                  LDQ     2
         4 000056   200004 470500                    LDP0    @VALUE,,AUTO
         4 000057   000000 756100                    STQ     0,,PR0
         4 000060   000152 710000 4                  TRA     s:6496

PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:464  
     2869     6418
     2870     6419    2          CASE(%TYJ);

     2871     6420    2            VALUE = 32767;

   6420  4 000061   077777 236007                    LDQ     32767,DL
         4 000062   200004 470500                    LDP0    @VALUE,,AUTO
         4 000063   000000 756100                    STQ     0,,PR0
         4 000064   000152 710000 4                  TRA     s:6496

     2872     6421
     2873     6422    2          CASE(%TYD, %TYO, %TYF, %TYC);

     2874     6423                 %UNPACK_NDSC( @DESC       = TYPE_DESC.DESC,
     2875     6424                               @LENGTH     = LENGTH );

   6431  4 000065   200017 236100                    LDQ     TYPE_DESC+1,,AUTO
         4 000066   000014 772000                    QRL     12
         4 000067   000003 376007                    ANQ     3,DL
         4 000070   000004 116007                    CMPQ    4,DL
         4 000071   000073 602006 4                  TNC     s:6431+6,QL
         4 000072   000124 710000 4                  TRA     s:6480
         4 000073   000110 710000 4                  TRA     s:6455
         4 000074   000103 710000 4                  TRA     s:6438
         4 000075   000103 710000 4                  TRA     s:6438
         4 000076   000077 710000 4                  TRA     s:6433

   6433  4 000077   200017 236100                    LDQ     TYPE_DESC+1,,AUTO
         4 000100   000077 376007                    ANQ     63,DL
         4 000101   200012 756100                    STQ     LENGTH,,AUTO
         4 000102   000124 710000 4                  TRA     s:6480

   6438  4 000103   200017 236100                    LDQ     TYPE_DESC+1,,AUTO
         4 000104   000077 376007                    ANQ     63,DL
         4 000105   000001 136007                    SBLQ    1,DL
         4 000106   200012 756100                    STQ     LENGTH,,AUTO
         4 000107   000124 710000 4                  TRA     s:6480
PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:465  

   6455  4 000110   200017 236100                    LDQ     TYPE_DESC+1,,AUTO
         4 000111   040000 316007                    CANQ    16384,DL
         4 000112   000120 600000 4                  TZE     s:6458

   6456  4 000113   200017 236100                    LDQ     TYPE_DESC+1,,AUTO
         4 000114   000077 376007                    ANQ     63,DL
         4 000115   000003 136007                    SBLQ    3,DL
         4 000116   200012 756100                    STQ     LENGTH,,AUTO
         4 000117   000124 710000 4                  TRA     s:6480

   6458  4 000120   200017 236100                    LDQ     TYPE_DESC+1,,AUTO
         4 000121   000077 376007                    ANQ     63,DL
         4 000122   000002 136007                    SBLQ    2,DL
         4 000123   200012 756100                    STQ     LENGTH,,AUTO

     2876     6479
     2877     6480    2            VALUE = 10;

   6480  4 000124   000012 236007                    LDQ     10,DL
         4 000125   200004 470500                    LDP0    @VALUE,,AUTO
         4 000126   000000 756100                    STQ     0,,PR0

     2878     6481
     2879     6482    3   MAX_DEC: DO I = 2 TO LENGTH;

   6482  4 000127   000002 235007       MAX_DEC      LDA     2,DL
         4 000130   200015 755100                    STA     I,,AUTO
         4 000131   000145 710000 4                  TRA     s:6490+1

     2880     6483    3              IF VALUE > %MAX_SD10 THEN

   6483  4 000132   200004 470500                    LDP0    @VALUE,,AUTO
         4 000133   000000 235100                    LDA     0,,PR0
         4 000134   000003 115000 5                  CMPA    3
         4 000135   000141 604400 4                  TMOZ    s:6489

PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:466  
     2881     6484    4                DO;

     2882     6485    4                  VALUE = %MAX_SBIN;

   6485  4 000136   000001 236000 5                  LDQ     1
         4 000137   000000 756100                    STQ     0,,PR0

     2883     6486    4                  EXIT MAX_DEC;

   6486  4 000140   000150 710000 4                  TRA     s:6492

     2884     6487    4                END; /* VALUE > Max_SBIN / 10 */
     2885     6488    3              ELSE
     2886     6489    3                VALUE = VALUE * 10;

   6489  4 000141   000000 236100                    LDQ     0,,PR0
         4 000142   000012 402007                    MPY     10,DL
         4 000143   000000 756100                    STQ     0,,PR0

     2887     6490    3            END; /* MAX_DEC */

   6490  4 000144   200015 054100                    AOS     I,,AUTO
         4 000145   200015 236100                    LDQ     I,,AUTO
         4 000146   200012 116100                    CMPQ    LENGTH,,AUTO
         4 000147   000132 604400 4                  TMOZ    s:6483

     2888     6491
     2889     6492    2            VALUE = VALUE - 1;

   6492  4 000150   000001 336007                    LCQ     1,DL
         4 000151   000000 056100                    ASQ     0,,PR0

     2890     6493
     2891     6494    2        END /* Case */;

     2892     6495
     2893     6496    1        RETURN;
PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:467  

   6496  4 000152   000000 702200 xent               TSX2  ! X66_ARET

     2894     6497
     2895     6498        %EJECT;
PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:468  
     2896     6499    1   Z8EZ$MIN_VALU:ENTRY(ITEM$, VALUE);

   6499  4 000153   000000 700200 xent  Z8EZ$MIN_VA* TSX0  ! X66_AUTO_2
         4 000154   000024 000002                    ZERO    20,2

     2897     6500
     2898     6501
     2899     6502    1        CALL Z8AU$TYPE_DESCRIPTOR(ITEM$, TYPE_DESC);

   6502  4 000155   200016 630500                    EPPR0   TYPE_DESC,,AUTO
         4 000156   200023 450500                    STP0    TYPE_DESC+5,,AUTO
         4 000157   200003 236100                    LDQ     @ITEM$,,AUTO
         4 000160   200022 756100                    STQ     TYPE_DESC+4,,AUTO
         4 000161   200022 630500                    EPPR0   TYPE_DESC+4,,AUTO
         4 000162   000000 631400 5                  EPPR1   0
         4 000163   000000 701000 xent               TSX1    Z8AU$TYPE_DESCRIPTOR
         4 000164   000000 011000                    NOP     0

     2900     6503
     2901     6504    2        DO CASE(TYPE_DESC.TYPE);

   6504  4 000165   200016 235100                    LDA     TYPE_DESC,,AUTO
         4 000166   000024 115007                    CMPA    20,DL
         4 000167   000171 602005 4                  TNC     s:6504+4,AL
         4 000170   000373 710000 4                  TRA     s:6611
         4 000171   000235 710000 4                  TRA     s:6527
         4 000172   000215 710000 4                  TRA     s:6506
         4 000173   000231 710000 4                  TRA     s:6515
         4 000174   000340 710000 4                  TRA     s:6595
         4 000175   000373 710000 4                  TRA     s:6611
         4 000176   000373 710000 4                  TRA     s:6611
         4 000177   000373 710000 4                  TRA     s:6611
         4 000200   000221 710000 4                  TRA     s:6509
         4 000201   000373 710000 4                  TRA     s:6611
         4 000202   000373 710000 4                  TRA     s:6611
         4 000203   000373 710000 4                  TRA     s:6611
         4 000204   000235 710000 4                  TRA     s:6527
PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:469  
         4 000205   000373 710000 4                  TRA     s:6611
         4 000206   000373 710000 4                  TRA     s:6611
         4 000207   000373 710000 4                  TRA     s:6611
         4 000210   000225 710000 4                  TRA     s:6512
         4 000211   000373 710000 4                  TRA     s:6611
         4 000212   000373 710000 4                  TRA     s:6611
         4 000213   000373 710000 4                  TRA     s:6611
         4 000214   000235 710000 4                  TRA     s:6527

     2902     6505    2          CASE(%TYI);

     2903     6506    2            VALUE = BITBIN('400000000000'O);

   6506  4 000215   000000 236000 3                  LDQ     0
         4 000216   200004 470500                    LDP0    @VALUE,,AUTO
         4 000217   000000 756100                    STQ     0,,PR0
         4 000220   000373 710000 4                  TRA     s:6611

     2904     6507
     2905     6508    2          CASE(%TYH);

     2906     6509    2            VALUE = - 131072;

   6509  4 000221   400000 336007                    LCQ     -131072,DL
         4 000222   200004 470500                    LDP0    @VALUE,,AUTO
         4 000223   000000 756100                    STQ     0,,PR0
         4 000224   000373 710000 4                  TRA     s:6611

     2907     6510
     2908     6511    2          CASE(%TYK);

     2909     6512    2            VALUE = - 2147483648;

   6512  4 000225   760000 236003                    LDQ     -8192,DU
         4 000226   200004 470500                    LDP0    @VALUE,,AUTO
         4 000227   000000 756100                    STQ     0,,PR0
         4 000230   000373 710000 4                  TRA     s:6611
PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:470  

     2910     6513
     2911     6514    2          CASE(%TYJ);

     2912     6515    2            VALUE = - 32768;

   6515  4 000231   100000 336007                    LCQ     32768,DL
         4 000232   200004 470500                    LDP0    @VALUE,,AUTO
         4 000233   000000 756100                    STQ     0,,PR0
         4 000234   000373 710000 4                  TRA     s:6611

     2913     6516
     2914     6517    2          CASE(%TYD, %TYF, %TYC);

     2915     6518                 %UNPACK_NDSC( @DESC      = TYPE_DESC.DESC ,
     2916     6519                               @SIGN      = SIGN ,
     2917     6520                               @LENGTH    = LENGTH );

   6527  4 000235   200017 236100                    LDQ     TYPE_DESC+1,,AUTO
         4 000236   000014 772000                    QRL     12
         4 000237   000003 376007                    ANQ     3,DL
         4 000240   000004 116007                    CMPQ    4,DL
         4 000241   000243 602006 4                  TNC     s:6527+6,QL
         4 000242   000274 710000 4                  TRA     s:6570
         4 000243   000260 710000 4                  TRA     s:6551
         4 000244   000253 710000 4                  TRA     s:6534
         4 000245   000253 710000 4                  TRA     s:6534
         4 000246   000247 710000 4                  TRA     s:6529

   6529  4 000247   200017 236100                    LDQ     TYPE_DESC+1,,AUTO
         4 000250   000077 376007                    ANQ     63,DL
         4 000251   200012 756100                    STQ     LENGTH,,AUTO
         4 000252   000274 710000 4                  TRA     s:6570

   6534  4 000253   200017 236100                    LDQ     TYPE_DESC+1,,AUTO
         4 000254   000077 376007                    ANQ     63,DL
         4 000255   000001 136007                    SBLQ    1,DL
PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:471  
         4 000256   200012 756100                    STQ     LENGTH,,AUTO
         4 000257   000274 710000 4                  TRA     s:6570

   6551  4 000260   200017 236100                    LDQ     TYPE_DESC+1,,AUTO
         4 000261   040000 316007                    CANQ    16384,DL
         4 000262   000270 600000 4                  TZE     s:6554

   6552  4 000263   200017 236100                    LDQ     TYPE_DESC+1,,AUTO
         4 000264   000077 376007                    ANQ     63,DL
         4 000265   000003 136007                    SBLQ    3,DL
         4 000266   200012 756100                    STQ     LENGTH,,AUTO
         4 000267   000274 710000 4                  TRA     s:6570

   6554  4 000270   200017 236100                    LDQ     TYPE_DESC+1,,AUTO
         4 000271   000077 376007                    ANQ     63,DL
         4 000272   000002 136007                    SBLQ    2,DL
         4 000273   200012 756100                    STQ     LENGTH,,AUTO

   6570  4 000274   200017 236100                    LDQ     TYPE_DESC+1,,AUTO
         4 000275   000026 736000                    QLS     22
         4 000276   600000 376003                    ANQ     -65536,DU
         4 000277   200006 756100                    STQ     SIGN,,AUTO

     2918     6575
     2919     6576    2            IF SIGN = %NO_SIGN THEN

   6576  4 000300   200006 236100                    LDQ     SIGN,,AUTO
         4 000301   600000 376003                    ANQ     -65536,DU
         4 000302   600000 116003                    CMPQ    -65536,DU
         4 000303   000307 601000 4                  TNZ     s:6580

     2920     6577    2              VALUE = 0;

   6577  4 000304   200004 470500                    LDP0    @VALUE,,AUTO
         4 000305   000000 450100                    STZ     0,,PR0
         4 000306   000373 710000 4                  TRA     s:6611

PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:472  
     2921     6578    2            ELSE
     2922     6579    3              DO;

     2923     6580    3                VALUE = 10;

   6580  4 000307   000012 236007                    LDQ     10,DL
         4 000310   200004 470500                    LDP0    @VALUE,,AUTO
         4 000311   000000 756100                    STQ     0,,PR0

     2924     6581
     2925     6582    4   MIN_DEC:     DO I = 2 TO LENGTH;

   6582  4 000312   000002 235007       MIN_DEC      LDA     2,DL
         4 000313   200015 755100                    STA     I,,AUTO
         4 000314   000330 710000 4                  TRA     s:6590+1

     2926     6583    4                  IF VALUE > %MAX_SD10 THEN

   6583  4 000315   200004 470500                    LDP0    @VALUE,,AUTO
         4 000316   000000 235100                    LDA     0,,PR0
         4 000317   000003 115000 5                  CMPA    3
         4 000320   000324 604400 4                  TMOZ    s:6589

     2927     6584    5                    DO;

     2928     6585    5                      VALUE = %MAX_SBIN;

   6585  4 000321   000001 236000 5                  LDQ     1
         4 000322   000000 756100                    STQ     0,,PR0

     2929     6586    5                      EXIT MIN_DEC;

   6586  4 000323   000333 710000 4                  TRA     s:6591

     2930     6587    5                    END; /* VALUE > Max_SBIN / 10 */
     2931     6588    4                  ELSE
     2932     6589    4                    VALUE = VALUE * 10;
PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:473  

   6589  4 000324   000000 236100                    LDQ     0,,PR0
         4 000325   000012 402007                    MPY     10,DL
         4 000326   000000 756100                    STQ     0,,PR0

     2933     6590    4                END; /* MIN_DEC */

   6590  4 000327   200015 054100                    AOS     I,,AUTO
         4 000330   200015 236100                    LDQ     I,,AUTO
         4 000331   200012 116100                    CMPQ    LENGTH,,AUTO
         4 000332   000315 604400 4                  TMOZ    s:6583

     2934     6591    3                VALUE = - (VALUE - 1);

   6591  4 000333   000000 235100                    LDA     0,,PR0
         4 000334   000004 675000 5                  ERA     4
         4 000335   000002 035007                    ADLA    2,DL
         4 000336   000000 755100                    STA     0,,PR0

     2935     6592    3              END;

   6592  4 000337   000373 710000 4                  TRA     s:6611

     2936     6593
     2937     6594    2          CASE(%TYO);

     2938     6595    2            LENGTH = TYPE_DESC.DESC.NDSC.N;

   6595  4 000340   200017 236100                    LDQ     TYPE_DESC+1,,AUTO
         4 000341   000077 376007                    ANQ     63,DL
         4 000342   200012 756100                    STQ     LENGTH,,AUTO

     2939     6596    2            VALUE = 10;

   6596  4 000343   000012 235007                    LDA     10,DL
         4 000344   200004 470500                    LDP0    @VALUE,,AUTO
         4 000345   000000 755100                    STA     0,,PR0
PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:474  

     2940     6597
     2941     6598    3   MIN_TYO: DO I = 2 TO LENGTH;

   6598  4 000346   000002 235007       MIN_TYO      LDA     2,DL
         4 000347   200015 755100                    STA     I,,AUTO
         4 000350   000364 710000 4                  TRA     s:6606+1

     2942     6599    3              IF VALUE > %MAX_SD10 THEN

   6599  4 000351   200004 470500                    LDP0    @VALUE,,AUTO
         4 000352   000000 235100                    LDA     0,,PR0
         4 000353   000003 115000 5                  CMPA    3
         4 000354   000360 604400 4                  TMOZ    s:6605

     2943     6600    4                DO;

     2944     6601    4                  VALUE = %MAX_SBIN;

   6601  4 000355   000001 236000 5                  LDQ     1
         4 000356   000000 756100                    STQ     0,,PR0

     2945     6602    4                  EXIT MIN_TYO;

   6602  4 000357   000367 710000 4                  TRA     s:6608

     2946     6603    4                END; /* VALUE > Max_SBIN / 10 */
     2947     6604    3              ELSE
     2948     6605    3                VALUE = VALUE * 10;

   6605  4 000360   000000 236100                    LDQ     0,,PR0
         4 000361   000012 402007                    MPY     10,DL
         4 000362   000000 756100                    STQ     0,,PR0

     2949     6606    3            END; /* MIN_TYO */

   6606  4 000363   200015 054100                    AOS     I,,AUTO
PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:475  
         4 000364   200015 236100                    LDQ     I,,AUTO
         4 000365   200012 116100                    CMPQ    LENGTH,,AUTO
         4 000366   000351 604400 4                  TMOZ    s:6599

     2950     6607
     2951     6608    2            VALUE = - (VALUE - 1) ;

   6608  4 000367   000000 235100                    LDA     0,,PR0
         4 000370   000004 675000 5                  ERA     4
         4 000371   000002 035007                    ADLA    2,DL
         4 000372   000000 755100                    STA     0,,PR0

     2952     6609
     2953     6610    2        END /* Case */;

     2954     6611    1        RETURN;

   6611  4 000373   000000 702200 xent               TSX2  ! X66_ARET
     2955     6612
     2956     6613    1   END Z8EZ$VALUES;

PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:476  
--  Include file information  --

   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DESC.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EZ$VALUES.
PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:477  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 002 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @ITEM$                     4-0-0/w PTR         r     1 @VALUE
    13-0-0/w UBIN              1 CN                         5-0-0/w STRC              1 DESC
    15-0-0/w SBIN        r     1 I                         *0-0-0/w PTR         r     1 ITEM$
    12-0-0/w SBIN        r     1 LENGTH                    14-0-0/w UBIN              1 SA
    11-0-0/w SBIN              1 SCALE                      6-0-0/w BIT (2)     r     1 SIGN
    10-0-0/w BIT (2)           1 TA                         7-0-0/w BIT               1 TN
    16-0-0/w STRC(144)   r     1 TYPE_DESC                 *0-0-0/w SBIN        r     1 VALUE

  ****  BASED and DCB variables  ****
PL6.E3A0      #004=Z8EZ$VALUES File=Z8EZ.:Z8A6TSI                                SAT 08/09/97 13:09 Page:478  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(396)         1 ARRAY
     0-0-0/w STRC(396)         1 BLOCK                      0-0-0/w STRC(396)         1 CD
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(396)         1 CLASS
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)         1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(396)         1 DML_ITEM
     0-0-0/w STRC(396)         1 FD                         0-0-0/w STRC(396)         1 INTDEF
     0-0-0/w STRC(396)         1 LABEL                      0-0-0/w STRC(396)         1 MNEMONIC
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(396)         1 PARA
     0-0-0/w STRC(396)         1 PROC_                      0-0-0/w STRC(396)         1 PROC_DEF
     0-0-0/w STRC(396)         1 RD                         0-0-0/w STRC(396)         1 SCALAR
     0-0-0/w STRC(396)         1 SD                         0-0-0/w STRC(396)         1 SECTION
     0-0-0/w STRC(396)         1 SEGMENT                    0-0-0/w STRC(396)         1 ST
     0-0-0/w STRC(396)         1 SWITCH                     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR
     0-0-0/w STRC(396)         1 SYMDEF_                    0-0-0/w STRC(396)         1 SYMREF_
     0-0-0/w STRC(396)         1 TEMP                       0-0-0/w STRC(396)         1 VARIABLE


   Procedure Z8EZ$VALUES requires 252 words for executable code.
   Procedure Z8EZ$VALUES requires 20 words of local(AUTO) storage.

    No errors detected in file Z8EZ.:Z8A6TSI    .
