VERSION E05

PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:1    
        1        1        /*M*    XSJ$JOBINFO    Batch Job Status Reporting routine                     */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=8,IND=2,THI=2,ENU=2,CSU=2,DTI=4,DCI=4,ECU=4,AND */
        8        8        /*P*    NAME:    XSJ$JOBINFO
        9        9                PURPOSE:    This module contains entry points which will permit the
       10       10                         caller to create, open, read, and update (given privilege)
       11       11                         the :JOBSTATS file in the :SYS account; this file contains
       12       12                         the final status of all batch jobs run during the
       13       13                         past three days (at least).  The records are purged
       14       14                         from the file by GHOST1, and thus at certain times,
       15       15                         there are extant records more than three days old.
       16       16
       17       17
       18       18                DESCRIPTION: The :JOBSTATS file contains two basic types of
       19       19                        records, all  of which are unique to a job. These
       20       20                        records are:
       21       21                        Information: TYPE# = TYP_INFO#. This record contains
       22       22                                most of the job-specific information. See
       23       23                                XSJ_JOBINFO for its structure.
       24       24                        Jobname:     TYPE# = TYP_NAME#. This record maps
       25       25                                JOBNAMEs to SYSIDS. The record contains only
       26       26                                a two-byte SYSID.
       27       27        */
       28       28        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:2    
       29       29        XSJ$JOBINFO:
       30       30                PROC(PARM)    ALTRET;
       31       31        %INCLUDE XSJ_MAC_C;
       32      110        /*******************************************************************************
       33      111        *                             PARAMETER                                        *
       34      112        *******************************************************************************/
       35      113        %XSJ_PARAM(  FPTN = PARM,
       36      114                      STCLASS ="");
       37      131        /*******************************************************************************
       38      132        *                             INCLUDE FILES                                    *
       39      133        *******************************************************************************/
       40      134                %INCLUDE CP_6;
       41      215                %INCLUDE CP_6_SUBS;
       42      755        /**/
       43      756                %INCLUDE B$JIT;
       44     1046        /**/
       45     1047                %INCLUDE F_ERRORS_C;
       46     1287        /**/
       47     1288                %INCLUDE XSJ_SUBS_C;
       48     1315        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:3    
       49     1316        /*******************************************************************************
       50     1317        *                             SYMREF DATA                                      *
       51     1318        *******************************************************************************/
       52     1319    1   DCL     B$JIT$      PTR   SYMREF;
       53     1320    1   DCL B$TCB$ PTR SYMREF;
       54     1321        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:4    
       55     1322        /*******************************************************************************
       56     1323        *                             AUTO DATA                                        *
       57     1324        *******************************************************************************/
       58     1325    1   DCL     I     SBIN     WORD;
       59     1326        %XSJ_INFOKEY( FPTN=K_INFO,
       60     1327                      STCLASS = AUTO);
       61     1340        /**/
       62     1341        %XSJ_NAMEKEY( FPTN=K_NAME,
       63     1342                      STCLASS = AUTO);
       64     1356        /**/
       65     1357        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:5    
       66     1358        /*******************************************************************************
       67     1359        *                             SYSTEM SERVICE FPTS (AUTO)                       *
       68     1360        *******************************************************************************/
       69     1361        %FPT_CLOSE(   FPTN = CLS_STATS,
       70     1362                      STCLASS = AUTO);
       71     1404        /**/
       72     1405        %FPT_OPEN(    FPTN = OPEN_STATS,
       73     1406                      STCLASS = AUTO);
       74     1515        /**/
       75     1516        %FPT_READ(    FPTN = READ_STATS,
       76     1517                      STCLASS = AUTO);
       77     1556        /**/
       78     1557        %FPT_WRITE(   FPTN = WRITE_STATS,
       79     1558                      STCLASS = AUTO);
       80     1589        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:6    
       81     1590        /*******************************************************************************
       82     1591        *                             SYSTEM SERVICE FPTS (CONSTANT)                   *
       83     1592        *******************************************************************************/
       84     1593        %FPT_CLOSE(   FPTN = C_CLS_STATS,
       85     1594                      DISP = SAVE,
       86     1595                      TYPE = 'I ',
       87     1596                      STCLASS = CONSTANT);
       88     1638        /**/
       89     1639        %FPT_OPEN(    FPTN = C_OPEN_STATS,
       90     1640                      NAME = C_STATS_FID,
       91     1641                      ACCT = C_SYSACCT,
       92     1642                      SN = C_SYSPACK,
       93     1643                      ASN = FILE,
       94     1644                      FUN = CREATE,
       95     1645                      CTG = YES,
       96     1646                      EXIST = ERROR,
       97     1647                      ORG = KEYED,
       98     1648                      ACS = DIRECT,
       99     1649                      SHARE = ALL,
      100     1650                      TYPE = 'I ',
      101     1651                      ACCESS = ACCESS_LIST,
      102     1652                      ACSVEH = ACSVEH_LIST,
      103     1653                      STCLASS = CONSTANT);
      104     1762        %VLP_ATTR(FPTN=ACSVEH_LIST,STCLASS=CONSTANT);
      105     1776        %VLP_ACSVEH        (STCLASS=CONSTANT,
      106     1777                 READ      = YES,
      107     1778                 WNEW      = YES,
      108     1779                 UPD       = YES,
      109     1780                 DELR      = NO,
      110     1781                 DELF      = NO,
      111     1782                 REATTR    = NO,
      112     1783                 VEHICLE   = 'IBEX',
      113     1784                 LAST      =";");
      114     1801        %VLP_ATTR(FPTN = ACCESS_LIST,STCLASS = CONSTANT);
      115     1815               %VLP_ACCESS(STCLASS = CONSTANT,
      116     1816                           READ = YES,
      117     1817                           DELR = YES,
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:7    
      118     1818                           WNEW = YES,
      119     1819                           UPD = YES,
      120     1820                           DELF = YES,
      121     1821                           REATTR = YES,
      122     1822                           ACCT = ':SYS',
      123     1823                      LAST=",");
      124     1840        %VLP_ACCESS             (STCLASS=CONSTANT,
      125     1841                 READ      = YES,
      126     1842                 DELR      = NO,
      127     1843                 WNEW      = NO,
      128     1844                 UPD       = NO,
      129     1845                 DELF      = NO,
      130     1846                 EXEC      = YES,
      131     1847                 ACCT      = '?',
      132     1848                 LAST      =";");
      133     1865        /**/
      134     1866        %FPT_READ(    FPTN = C_READ_STATS,
      135     1867                      KEYS = YES,
      136     1868                      STCLASS = CONSTANT);
      137     1907        /**/
      138     1908        %FPT_WRITE(   FPTN = C_WRITE_STATS,
      139     1909                      NEWKEY = YES,
      140     1910                      ONEWKEY = YES,
      141     1911                      STCLASS = CONSTANT);
      142     1942        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:8    
      143     1943        /*******************************************************************************
      144     1944        *                             CONSTANT DATA                                    *
      145     1945        *******************************************************************************/
      146     1946        %XSJ_INFOKEY( FPTN = C_K_INFO,
      147     1947                      STCLASS = CONSTANT);
      148     1960        %XSJ_NAMEKEY( FPTN = C_K_NAME,
      149     1961                      STCLASS = CONSTANT);
      150     1975        %VLP_NAME(    FPTN = C_STATS_FID,
      151     1976                      STCLASS = CONSTANT,
      152     1977                      NAME = ':JOBSTATS');
      153     2004        %VLP_ACCT(    FPTN = C_SYSACCT,
      154     2005                      STCLASS = CONSTANT,
      155     2006                      ACCT = ':SYS');
      156     2019        %VLP_SN(      FPTN = C_SYSPACK,
      157     2020                      STCLASS = CONSTANT,
      158     2021                      SN = 'SYS   ');
      159     2034        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:9    
      160     2035        /*******************************************************************************
      161     2036        *                             MISCELLANEOUS                                    *
      162     2037        *******************************************************************************/
      163     2038    1   DCL B$CHAR8 CHAR(8) BASED UNAL;
      164     2039    1   DCL B$CHAR31 CHAR(31) BASED UNAL;
      165     2040        %B$TCB;
      166     2043        %B$ALT;
      167     2051        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:10   
      168     2052        /*******************************************************************************
      169     2053        *                             BEGIN PROCEDURE                                  *
      170     2054        *******************************************************************************/
      171     2055        /*F* NAME:         XSJ$NEWFILE
      172     2056             PURPOSE:      To create a new copy of the job status file
      173     2057             DESCRIPTION:  This routine is called by GHOST1 when the jobstats
      174     2058                           file is being re-created. */
      175     2059        /*D* NAME:         XSJ$NEWFILE
      176     2060             CALL:         XSJ$NEWFILE (PARAM)
      177     2061                INPUT:  PARAM - A structure defined by the XSJ$PARAM macro.
      178     2062                        The following fields are used:
      179     2063                        PARAM.DCB# - The DCB number to use  for status file I/O
      180     2064                           The DCB is opened CTG=NO, EXIST=NEWFILE. */
      181     2065    1   XSJ$NEWFILE: ENTRY(PARM) ALTRET;
      182     2066        /**/
      183     2067    1           OPEN_STATS=C_OPEN_STATS;
      184     2068    1           OPEN_STATS.V_=VECTOR(OPEN_STATS.V);
      185     2069    1           OPEN_STATS.V.DCB#=PARM.DCB#;
      186     2070    1           OPEN_STATS.V.CTG#='0'B;
      187     2071    1           OPEN_STATS.V.EXIST#=%NEWFILE#;
      188     2072    1           CALL M$OPEN (OPEN_STATS) ALTRET(ALTRT);
      189     2073    1           RETURN;
      190     2074        /**/
      191     2075        /*F*    NAME:   XSJ$CREATE
      192     2076                PURPOSE: To create the job status file.
      193     2077                DESCRIPTION: This routine is called by the SLUG ghost during
      194     2078                        system initialization, thus making it impossible for
      195     2079                        other non-privileged, non-:SYS users to successfully
      196     2080                        call this routine.  */
      197     2081        /*D*    NAME:   XSJ$CREATE
      198     2082                CALL:   XSJ$CREATE(PARAM)
      199     2083                INPUT:  PARAM - A structure defined by the XSJ$PARAM macro.
      200     2084                        The following fields are used:
      201     2085                        PARAM.DCB# - The DCB number to use  for status file I/O
      202     2086                OUTPUT: None.
      203     2087        */
      204     2088    1   XSJ$CREATE:
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:11   
      205     2089    1           ENTRY(PARM)   ALTRET;
      206     2090        /**/
      207     2091    1           OPEN_STATS = C_OPEN_STATS;
      208     2092    1           OPEN_STATS.V_ = VECTOR(OPEN_STATS.V);
      209     2093    1           OPEN_STATS.V.DCB#=PARM.DCB#;
      210     2094    1           CALL M$OPEN (OPEN_STATS) ALTRET(E_CREATE);
      211     2095    1           CALL CLOSEIT ALTRET(ALTRT);
      212     2096    1           GOTO UPD_OPEN;
      213     2097        /**/
      214     2098    1   E_CREATE:
      215     2099    1           IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$CREATERR
      216     2100    1             THEN
      217     2101    2               DO;
      218     2102    2   ALTRT:        ;
      219     2103    2                 ALTRETURN;
      220     2104    2               END;
      221     2105    2             ELSE DO;
      222     2106    2   UPD_OPEN:     ;
      223     2107    2                 OPEN_STATS.V.FUN# = %UPDATE#;
      224     2108    2                 CALL M$OPEN (OPEN_STATS) ALTRET(ALTRT);
      225     2109    2                 RETURN;
      226     2110    2               END;
      227     2111        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:12   
      228     2112        /*F*    NAME:   XSJ$OPEN
      229     2113                PURPOSE: To open the job status file.
      230     2114                DESCRIPTION: The :JOBSTATS file is opened SHARE ALL in the
      231     2115                        mode indicated by the caller. Updating the file is
      232     2116                        restricted to processors in :SYS and those with
      233     2117                        the PR_FMSEC# privilege.                           */
      234     2118        /*D*    NAME:   XSJ$OPEN
      235     2119                CALL:   XSJ$OPEN(PARAM)
      236     2120                INPUT:  PARAM - A structure defined by the XSJ$PARAM macro.
      237     2121                        The following fields are used:
      238     2122                        PARAM.DCB# - The DCB number to use  for status file I/O
      239     2123                        PARAM.MODE# - The mode (from CP_6_SUBS) in which to open
      240     2124                                      the file.
      241     2125        */
      242     2126    1   XSJ$OPEN:
      243     2127    1           ENTRY(PARM)   ALTRET;
      244     2128        /**/
      245     2129    1           OPEN_STATS = C_OPEN_STATS;
      246     2130    1           GOTO OPENIT;
      247     2131        /**/
      248     2132        /*F* NAME:         XSJ$OPENF
      249     2133             PURPOSE:      To open the job status file with FPARAMs
      250     2134             DESCRIPTION:  Like XSJ$OPEN but FPARAMs are passed to the caller,
      251     2135                           and the SHARE is taken from PARAM. */
      252     2136        /*D* NAME:         XSJ$OPENF
      253     2137             CALL:         XSJ$OPENF(PARAM)
      254     2138                INPUT:  PARAM - A structure defined by the XSJ$PARAM macro.
      255     2139                        The following fields are used:
      256     2140                        PARAM.DCB# - The DCB number to use  for status file I/O
      257     2141                        PARAM.MODE# - The mode (from CP_6_SUBS) in which to open
      258     2142                                      the file.
      259     2143                        PARAM.SHARE# - Used to select SHARE on the open
      260     2144                        PARAM.FPARAM_ - Vector framing the caller's FPARAM
      261     2145                                        buffer. */
      262     2146    1   XSJ$OPENF: ENTRY(PARM) ALTRET;
      263     2147        /**/
      264     2148    1           OPEN_STATS=C_OPEN_STATS;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:13   
      265     2149    1           OPEN_STATS.FPARAM_=PARM.FPARAM_;
      266     2150    1           OPEN_STATS.V.SHARE#=PARM.SHARE#;
      267     2151    1   OPENIT: ;
      268     2152    1           OPEN_STATS.V_ = VECTOR(OPEN_STATS.V);
      269     2153    1           OPEN_STATS.V.FUN# = PARM.MODE#;
      270     2154    1           OPEN_STATS.V.DCB# = PARM.DCB#;
      271     2155    1           CALL M$OPEN(OPEN_STATS) ALTRET(ALTRT);
      272     2156    1           RETURN;
      273     2157        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:14   
      274     2158        /*F*    NAME:   XSJ$READ
      275     2159                PURPOSE: To read a record of a given type from the job status file.
      276     2160                DESCRIPTION: The record indicated by TYPE# and other parameters
      277     2161                        is read into the buffer supplied by the caller.    */
      278     2162        /*D*    NAME:   XSJ$READ
      279     2163                CALL:   XSJ$READ(PARAM)
      280     2164                INPUT:  PARAM - A structure defined by the XSJ$PARAM macro.
      281     2165                        The following fields are used:
      282     2166                        PARAM.DCB# - The DCB number to use  for status file I/O
      283     2167                        PARAM.BUF_ - VECTOR(user buffer to read into)
      284     2168                        PARAM.TYPE# - The type (from XSJ_SUBS_C) of the record
      285     2169                                to be read. Determines which of the following
      286     2170                                parameters are required.
      287     2171                        PARAM.SYSID# - For %TYP_INFO#: The SYSID of the job whose
      288     2172                                information record is to be returned.
      289     2173                        PARAM.NAME$ - For %TYP_NAME#: PTR to the JOBNAME of the job
      290     2174                                whose JOBNAME record is to be read.
      291     2175                        PARAM.ACCT$ - For %TYP_NAME#: PTR to the ACCT of the job
      292     2176                                whose JOBNAME record is to be read.
      293     2177        */
      294     2178    1   XSJ$READ:
      295     2179    1           ENTRY(PARM)   ALTRET;
      296     2180        /**/
      297     2181    1           READ_STATS = C_READ_STATS;
      298     2182    2           DO CASE (PARM.TYPE#);
      299     2183    2             CASE(%TYP_INFO#);             /* Read job information record        */
      300     2184    2               K_INFO = C_K_INFO;
      301     2185    2               K_INFO.SYSID#=PARM.SYSID#;
      302     2186    2               READ_STATS.KEY_ = VECTOR(K_INFO);
      303     2187    2             CASE(%TYP_NAME#);             /* Read job name record               */
      304     2188    2               K_NAME = C_K_NAME;
      305     2189    2               K_NAME.JOBNAME# = PARM.NAME$->B$CHAR31;
      306     2190    2               K_NAME.ACCT# = PARM.ACCT$->B$CHAR8;
      307     2191    2               READ_STATS.KEY_ = VECTOR(K_NAME);
      308     2192    2           END;
      309     2193    1           READ_STATS.V_ = VECTOR(READ_STATS.V);
      310     2194    1           READ_STATS.BUF_ = PARM.BUF_;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:15   
      311     2195    1           READ_STATS.V.DCB# = PARM.DCB#;
      312     2196    1           CALL M$READ(READ_STATS) ALTRET(ALTRT);
      313     2197    1           RETURN;
      314     2198        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:16   
      315     2199        /*F*    NAME:   XSJ$WRITE
      316     2200                PURPOSE: To write a record of the indicated type to the job
      317     2201                        status file.
      318     2202                DESCRIPTION: A record of the type indicated by TYPE# plus
      319     2203                        other passed information is written to :JOBSTATS from
      320     2204                        a buffer passed by the caller.                     */
      321     2205        /*D*    NAME:   XSJ$WRITE
      322     2206                CALL:   XSJ$WRITE(PARAM)
      323     2207                INPUT:  PARAM - A structure defined by the XSJ$PARAM macro.
      324     2208                        The following fields are used:
      325     2209                        PARAM.DCB# - The DCB number to use  for status file I/O
      326     2210                        PARAM.BUF_ - VECTOR(user buffer to write from)
      327     2211                        PARAM.TYPE# - The type (from XSJ_SUBS_C) of the record
      328     2212                                to be written. Determines which of the following
      329     2213                                parameters are required.
      330     2214                        PARAM.SYSID# - For %TYP_INFO#: The SYSID of the job whose
      331     2215                                information record is to be written.
      332     2216                        PARAM.NAME$ - For %TYP_NAME#: PTR to the JOBNAME of the job
      333     2217                                whose JOBNAME record is to be written.
      334     2218                        PARAM.ACCT$ - For %TYP_NAME#: PTR to the ACCT of the job
      335     2219                                whose JOBNAME record is to be written.
      336     2220        */
      337     2221    1   XSJ$WRITE:
      338     2222    1           ENTRY(PARM)   ALTRET;
      339     2223        /**/
      340     2224    1           WRITE_STATS = C_WRITE_STATS;
      341     2225    2           DO CASE (PARM.TYPE#);
      342     2226    2             CASE(%TYP_INFO#);             /* Write job information record       */
      343     2227    2               K_INFO = C_K_INFO;
      344     2228    2               K_INFO.SYSID#=PARM.SYSID#;
      345     2229    2               WRITE_STATS.KEY_ = VECTOR(K_INFO);
      346     2230    2             CASE(%TYP_NAME#);             /* Write job name record              */
      347     2231    2               K_NAME = C_K_NAME;
      348     2232    2               K_NAME.JOBNAME# = PARM.NAME$->B$CHAR31;
      349     2233    2               K_NAME.ACCT# = PARM.ACCT$->B$CHAR8;
      350     2234    2               WRITE_STATS.KEY_ = VECTOR(K_NAME);
      351     2235    2           END;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:17   
      352     2236    1           WRITE_STATS.V_ = VECTOR(WRITE_STATS.V);
      353     2237    1           WRITE_STATS.BUF_ = PARM.BUF_;
      354     2238    1           WRITE_STATS.V.DCB# = PARM.DCB#;
      355     2239    1           CALL M$WRITE(WRITE_STATS)  ALTRET(ALTRT);
      356     2240    1           RETURN;
      357     2241        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:18   
      358     2242        /*F*    NAME:   XSJ$CLOSE
      359     2243                PURPOSE: To close the job status file.
      360     2244                DESCRIPTION: The DCB indicated by the passed DCB# is closed
      361     2245                        with SAVE specified.                               */
      362     2246        /*D*    NAME:   XSJ$CLOSE
      363     2247                CALL:   XSJ$CLOSE(PARAM)
      364     2248                INPUT:  PARAM - A structure defined by the XSJ$PARAM macro.
      365     2249                        The following fields are used:
      366     2250                        PARAM.DCB# - The DCB number to use  for status file I/O
      367     2251        */
      368     2252    1   XSJ$CLOSE:
      369     2253    1           ENTRY(PARM)   ALTRET;
      370     2254        /**/
      371     2255
      372     2256    1           CALL CLOSEIT ALTRET(ALTRT);
      373     2257    1           RETURN;
      374     2258
      375     2259    1   CLOSEIT: PROC ALTRET;
      376     2260    2           CLS_STATS = C_CLS_STATS;
      377     2261    2           CLS_STATS.V_ = VECTOR(CLS_STATS.V);
      378     2262    2           CLS_STATS.V.DCB# = PARM.DCB#;
      379     2263    2           CALL M$CLOSE(CLS_STATS) ALTRET(E_M$CLOSE);
      380     2264    2           RETURN;
      381     2265    2   E_M$CLOSE:
      382     2266    2           ALTRETURN;
      383     2267    2   END CLOSEIT;
      384     2268        /*F* NAME:         XSJ$SCRATCH
      385     2269             PURPOSE:      To delete the job status file
      386     2270             DESCRIPTION:  The DCB indicated by the passed DCB# is closed
      387     2271                           with SCRATCH specified. */
      388     2272        /*D* NAME:         XSJ$SCRATCH
      389     2273             CALL:         XSJ$SCRATCH(PARAM)
      390     2274                INPUT:  PARAM - A structure defined by the XSJ$PARAM macro.
      391     2275                        The following fields are used:
      392     2276                        PARAM.DCB# - The DCB number to use  for status file I/O
      393     2277        */
      394     2278    1   XSJ$SCRATCH: ENTRY(PARM) ALTRET;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:19   
      395     2279        /**/
      396     2280    1           CLS_STATS=C_CLS_STATS;
      397     2281    1           CLS_STATS.V_ = VECTOR(CLS_STATS.V);
      398     2282    1           CLS_STATS.V.DCB# = PARM.DCB#;
      399     2283    1           CLS_STATS.V.DISP#=%SCRATCH#;
      400     2284    1           CALL M$CLOSE(CLS_STATS) ALTRET(ALTRT);
      401     2285    1           RETURN;
      402     2286        /**/
      403     2287    1   END     XSJ$JOBINFO;

PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:20   
--  Include file information  --

   XSJ_SUBS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XSJ_MAC_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure XSJ$JOBINFO.

   Procedure XSJ$JOBINFO requires 251 words for executable code.
   Procedure XSJ$JOBINFO requires 136 words of local(AUTO) storage.

    No errors detected in file XSJ$JOBINFO.:E05TSI    .

PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:21   

 Object Unit name= XSJ$JOBINFO                                File name= XSJ$JOBINFO.:E05TOU
 UTS= JUL 30 '97 09:10:07.88 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    146    222  XSJ$JOBINFO
    2   Proc  even  none   251    373  XSJ$JOBINFO
    3  RoData even  none     6      6  XSJ$JOBINFO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  XSJ$JOBINFO
     2      3          yes     yes      Std        1  XSJ$NEWFILE
     2     31          yes     yes      Std        1  XSJ$CREATE
     2     73          yes     yes      Std        1  XSJ$OPEN
     2    101          yes     yes      Std        1  XSJ$OPENF
     2    136          yes     yes      Std        1  XSJ$READ
     2    226          yes     yes      Std        1  XSJ$WRITE
     2    316          yes     yes      Std        1  XSJ$CLOSE
     2    347          yes     yes      Std        1  XSJ$SCRATCH

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:22   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$JIT$                                B$TCB$

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:23   


        1        1        /*M*    XSJ$JOBINFO    Batch Job Status Reporting routine                     */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=8,IND=2,THI=2,ENU=2,CSU=2,DTI=4,DCI=4,ECU=4,AND */
        8        8        /*P*    NAME:    XSJ$JOBINFO
        9        9                PURPOSE:    This module contains entry points which will permit the
       10       10                         caller to create, open, read, and update (given privilege)
       11       11                         the :JOBSTATS file in the :SYS account; this file contains
       12       12                         the final status of all batch jobs run during the
       13       13                         past three days (at least).  The records are purged
       14       14                         from the file by GHOST1, and thus at certain times,
       15       15                         there are extant records more than three days old.
       16       16
       17       17
       18       18                DESCRIPTION: The :JOBSTATS file contains two basic types of
       19       19                        records, all  of which are unique to a job. These
       20       20                        records are:
       21       21                        Information: TYPE# = TYP_INFO#. This record contains
       22       22                                most of the job-specific information. See
       23       23                                XSJ_JOBINFO for its structure.
       24       24                        Jobname:     TYPE# = TYP_NAME#. This record maps
       25       25                                JOBNAMEs to SYSIDS. The record contains only
       26       26                                a two-byte SYSID.
       27       27        */
       28       28        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:24   
       29       29        XSJ$JOBINFO:
       30       30                PROC(PARM)    ALTRET;

     30  2 000000   000000 700200 xent  XSJ$JOBINFO  TSX0  ! X66_AUTO_1
         2 000001   000210 000001                    ZERO    136,1
         2 000002   000005 710000 2                  TRA     s:2067

       31       31        %INCLUDE XSJ_MAC_C;
       32      110        /*******************************************************************************
       33      111        *                             PARAMETER                                        *
       34      112        *******************************************************************************/
       35      113        %XSJ_PARAM(  FPTN = PARM,
       36      114                      STCLASS ="");
       37      131        /*******************************************************************************
       38      132        *                             INCLUDE FILES                                    *
       39      133        *******************************************************************************/
       40      134                %INCLUDE CP_6;
       41      215                %INCLUDE CP_6_SUBS;
       42      755        /**/
       43      756                %INCLUDE B$JIT;
       44     1046        /**/
       45     1047                %INCLUDE F_ERRORS_C;
       46     1287        /**/
       47     1288                %INCLUDE XSJ_SUBS_C;
       48     1315        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:25   
       49     1316        /*******************************************************************************
       50     1317        *                             SYMREF DATA                                      *
       51     1318        *******************************************************************************/
       52     1319    1   DCL     B$JIT$      PTR   SYMREF;
       53     1320    1   DCL B$TCB$ PTR SYMREF;
       54     1321        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:26   
       55     1322        /*******************************************************************************
       56     1323        *                             AUTO DATA                                        *
       57     1324        *******************************************************************************/
       58     1325    1   DCL     I     SBIN     WORD;
       59     1326        %XSJ_INFOKEY( FPTN=K_INFO,
       60     1327                      STCLASS = AUTO);
       61     1340        /**/
       62     1341        %XSJ_NAMEKEY( FPTN=K_NAME,
       63     1342                      STCLASS = AUTO);
       64     1356        /**/
       65     1357        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:27   
       66     1358        /*******************************************************************************
       67     1359        *                             SYSTEM SERVICE FPTS (AUTO)                       *
       68     1360        *******************************************************************************/
       69     1361        %FPT_CLOSE(   FPTN = CLS_STATS,
       70     1362                      STCLASS = AUTO);
       71     1404        /**/
       72     1405        %FPT_OPEN(    FPTN = OPEN_STATS,
       73     1406                      STCLASS = AUTO);
       74     1515        /**/
       75     1516        %FPT_READ(    FPTN = READ_STATS,
       76     1517                      STCLASS = AUTO);
       77     1556        /**/
       78     1557        %FPT_WRITE(   FPTN = WRITE_STATS,
       79     1558                      STCLASS = AUTO);
       80     1589        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:28   
       81     1590        /*******************************************************************************
       82     1591        *                             SYSTEM SERVICE FPTS (CONSTANT)                   *
       83     1592        *******************************************************************************/
       84     1593        %FPT_CLOSE(   FPTN = C_CLS_STATS,
       85     1594                      DISP = SAVE,
       86     1595                      TYPE = 'I ',
       87     1596                      STCLASS = CONSTANT);
       88     1638        /**/
       89     1639        %FPT_OPEN(    FPTN = C_OPEN_STATS,
       90     1640                      NAME = C_STATS_FID,
       91     1641                      ACCT = C_SYSACCT,
       92     1642                      SN = C_SYSPACK,
       93     1643                      ASN = FILE,
       94     1644                      FUN = CREATE,
       95     1645                      CTG = YES,
       96     1646                      EXIST = ERROR,
       97     1647                      ORG = KEYED,
       98     1648                      ACS = DIRECT,
       99     1649                      SHARE = ALL,
      100     1650                      TYPE = 'I ',
      101     1651                      ACCESS = ACCESS_LIST,
      102     1652                      ACSVEH = ACSVEH_LIST,
      103     1653                      STCLASS = CONSTANT);
      104     1762        %VLP_ATTR(FPTN=ACSVEH_LIST,STCLASS=CONSTANT);
      105     1776        %VLP_ACSVEH        (STCLASS=CONSTANT,
      106     1777                 READ      = YES,
      107     1778                 WNEW      = YES,
      108     1779                 UPD       = YES,
      109     1780                 DELR      = NO,
      110     1781                 DELF      = NO,
      111     1782                 REATTR    = NO,
      112     1783                 VEHICLE   = 'IBEX',
      113     1784                 LAST      =";");
      114     1801        %VLP_ATTR(FPTN = ACCESS_LIST,STCLASS = CONSTANT);
      115     1815               %VLP_ACCESS(STCLASS = CONSTANT,
      116     1816                           READ = YES,
      117     1817                           DELR = YES,
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:29   
      118     1818                           WNEW = YES,
      119     1819                           UPD = YES,
      120     1820                           DELF = YES,
      121     1821                           REATTR = YES,
      122     1822                           ACCT = ':SYS',
      123     1823                      LAST=",");
      124     1840        %VLP_ACCESS             (STCLASS=CONSTANT,
      125     1841                 READ      = YES,
      126     1842                 DELR      = NO,
      127     1843                 WNEW      = NO,
      128     1844                 UPD       = NO,
      129     1845                 DELF      = NO,
      130     1846                 EXEC      = YES,
      131     1847                 ACCT      = '?',
      132     1848                 LAST      =";");
      133     1865        /**/
      134     1866        %FPT_READ(    FPTN = C_READ_STATS,
      135     1867                      KEYS = YES,
      136     1868                      STCLASS = CONSTANT);
      137     1907        /**/
      138     1908        %FPT_WRITE(   FPTN = C_WRITE_STATS,
      139     1909                      NEWKEY = YES,
      140     1910                      ONEWKEY = YES,
      141     1911                      STCLASS = CONSTANT);
      142     1942        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:30   
      143     1943        /*******************************************************************************
      144     1944        *                             CONSTANT DATA                                    *
      145     1945        *******************************************************************************/
      146     1946        %XSJ_INFOKEY( FPTN = C_K_INFO,
      147     1947                      STCLASS = CONSTANT);
      148     1960        %XSJ_NAMEKEY( FPTN = C_K_NAME,
      149     1961                      STCLASS = CONSTANT);
      150     1975        %VLP_NAME(    FPTN = C_STATS_FID,
      151     1976                      STCLASS = CONSTANT,
      152     1977                      NAME = ':JOBSTATS');
      153     2004        %VLP_ACCT(    FPTN = C_SYSACCT,
      154     2005                      STCLASS = CONSTANT,
      155     2006                      ACCT = ':SYS');
      156     2019        %VLP_SN(      FPTN = C_SYSPACK,
      157     2020                      STCLASS = CONSTANT,
      158     2021                      SN = 'SYS   ');
      159     2034        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:31   
      160     2035        /*******************************************************************************
      161     2036        *                             MISCELLANEOUS                                    *
      162     2037        *******************************************************************************/
      163     2038    1   DCL B$CHAR8 CHAR(8) BASED UNAL;
      164     2039    1   DCL B$CHAR31 CHAR(31) BASED UNAL;
      165     2040        %B$TCB;
      166     2043        %B$ALT;
      167     2051        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:32   
      168     2052        /*******************************************************************************
      169     2053        *                             BEGIN PROCEDURE                                  *
      170     2054        *******************************************************************************/
      171     2055        /*F* NAME:         XSJ$NEWFILE
      172     2056             PURPOSE:      To create a new copy of the job status file
      173     2057             DESCRIPTION:  This routine is called by GHOST1 when the jobstats
      174     2058                           file is being re-created. */
      175     2059        /*D* NAME:         XSJ$NEWFILE
      176     2060             CALL:         XSJ$NEWFILE (PARAM)
      177     2061                INPUT:  PARAM - A structure defined by the XSJ$PARAM macro.
      178     2062                        The following fields are used:
      179     2063                        PARAM.DCB# - The DCB number to use  for status file I/O
      180     2064                           The DCB is opened CTG=NO, EXIST=NEWFILE. */
      181     2065    1   XSJ$NEWFILE: ENTRY(PARM) ALTRET;

   2065  2 000003   000000 700200 xent  XSJ$NEWFILE  TSX0  ! X66_AUTO_1
         2 000004   000210 000001                    ZERO    136,1

      182     2066        /**/
      183     2067    1           OPEN_STATS=C_OPEN_STATS;

   2067  2 000005   000100 100400                    MLR     fill='000'O
         2 000006   000036 000350 1                  ADSC9   C_OPEN_STATS             cn=0,n=232
         2 000007   200060 000350                    ADSC9   OPEN_STATS,,AUTO         cn=0,n=232

      184     2068    1           OPEN_STATS.V_=VECTOR(OPEN_STATS.V);

   2068  2 000010   000000 235000 3                  LDA     0
         2 000011   200206 452500                    STP2    WRITE_STATS+14,,AUTO
         2 000012   200206 236100                    LDQ     WRITE_STATS+14,,AUTO
         2 000013   000124 036003                    ADLQ    84,DU
         2 000014   200060 757100                    STAQ    OPEN_STATS,,AUTO

      185     2069    1           OPEN_STATS.V.DCB#=PARM.DCB#;

   2069  2 000015   200003 470500                    LDP0    @PARM,,AUTO
         2 000016   000005 220100                    LDX0    5,,PR0
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:33   
         2 000017   200124 740100                    STX0    OPEN_STATS+36,,AUTO

      186     2070    1           OPEN_STATS.V.CTG#='0'B;

   2070  2 000020   000001 236000 3                  LDQ     1
         2 000021   200124 356100                    ANSQ    OPEN_STATS+36,,AUTO

      187     2071    1           OPEN_STATS.V.EXIST#=%NEWFILE#;

   2071  2 000022   000600 236007                    LDQ     384,DL
         2 000023   200124 256100                    ORSQ    OPEN_STATS+36,,AUTO

      188     2072    1           CALL M$OPEN (OPEN_STATS) ALTRET(ALTRT);

   2072  2 000024   200060 630500                    EPPR0   OPEN_STATS,,AUTO
         2 000025   450000 713400                    CLIMB   alt,open
         2 000026   410400 401760                    pmme    nvectors=18
         2 000027   000063 702000 2                  TSX2    ALTRT

      189     2073    1           RETURN;

   2073  2 000030   000000 702200 xent               TSX2  ! X66_ARET

      190     2074        /**/
      191     2075        /*F*    NAME:   XSJ$CREATE
      192     2076                PURPOSE: To create the job status file.
      193     2077                DESCRIPTION: This routine is called by the SLUG ghost during
      194     2078                        system initialization, thus making it impossible for
      195     2079                        other non-privileged, non-:SYS users to successfully
      196     2080                        call this routine.  */
      197     2081        /*D*    NAME:   XSJ$CREATE
      198     2082                CALL:   XSJ$CREATE(PARAM)
      199     2083                INPUT:  PARAM - A structure defined by the XSJ$PARAM macro.
      200     2084                        The following fields are used:
      201     2085                        PARAM.DCB# - The DCB number to use  for status file I/O
      202     2086                OUTPUT: None.
      203     2087        */
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:34   
      204     2088    1   XSJ$CREATE:
      205     2089    1           ENTRY(PARM)   ALTRET;

   2089  2 000031   000000 700200 xent  XSJ$CREATE   TSX0  ! X66_AUTO_1
         2 000032   000210 000001                    ZERO    136,1

      206     2090        /**/
      207     2091    1           OPEN_STATS = C_OPEN_STATS;

   2091  2 000033   000100 100400                    MLR     fill='000'O
         2 000034   000036 000350 1                  ADSC9   C_OPEN_STATS             cn=0,n=232
         2 000035   200060 000350                    ADSC9   OPEN_STATS,,AUTO         cn=0,n=232

      208     2092    1           OPEN_STATS.V_ = VECTOR(OPEN_STATS.V);

   2092  2 000036   000000 235000 3                  LDA     0
         2 000037   200206 452500                    STP2    WRITE_STATS+14,,AUTO
         2 000040   200206 236100                    LDQ     WRITE_STATS+14,,AUTO
         2 000041   000124 036003                    ADLQ    84,DU
         2 000042   200060 757100                    STAQ    OPEN_STATS,,AUTO

      209     2093    1           OPEN_STATS.V.DCB#=PARM.DCB#;

   2093  2 000043   200003 470500                    LDP0    @PARM,,AUTO
         2 000044   000005 220100                    LDX0    5,,PR0
         2 000045   200124 740100                    STX0    OPEN_STATS+36,,AUTO

      210     2094    1           CALL M$OPEN (OPEN_STATS) ALTRET(E_CREATE);

   2094  2 000046   200060 630500                    EPPR0   OPEN_STATS,,AUTO
         2 000047   450000 713400                    CLIMB   alt,open
         2 000050   410400 401760                    pmme    nvectors=18
         2 000051   000055 702000 2                  TSX2    E_CREATE

      211     2095    1           CALL CLOSEIT ALTRET(ALTRT);

   2095  2 000052   000323 701000 2                  TSX1    CLOSEIT
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:35   
         2 000053   000063 702000 2                  TSX2    ALTRT

      212     2096    1           GOTO UPD_OPEN;

   2096  2 000054   000064 710000 2                  TRA     UPD_OPEN

      213     2097        /**/
      214     2098    1   E_CREATE:
      215     2099    1           IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$CREATERR

   2099  2 000055   000000 470400 xsym  E_CREATE     LDP0    B$TCB$
         2 000056   000000 471500                    LDP1    0,,PR0
         2 000057   100102 236100                    LDQ     66,,PR1
         2 000060   377770 376007                    ANQ     131064,DL
         2 000061   001560 116007                    CMPQ    880,DL
         2 000062   000064 600000 2                  TZE     UPD_OPEN

      216     2100    1             THEN
      217     2101    2               DO;

   2093  2 000063                       ALTRT        null
      218     2102    2   ALTRT:        ;
      219     2103    2                 ALTRETURN;

   2103  2 000063   000000 702200 xent               TSX2  ! X66_AALT

      220     2104    2               END;
      221     2105    2             ELSE DO;

   2094  2 000064                       UPD_OPEN     null
      222     2106    2   UPD_OPEN:     ;
      223     2107    2                 OPEN_STATS.V.FUN# = %UPDATE#;

   2107  2 000064   001000 236007                    LDQ     512,DL
         2 000065   200125 552110                    STBQ    OPEN_STATS+37,'10'O,AUTO

      224     2108    2                 CALL M$OPEN (OPEN_STATS) ALTRET(ALTRT);
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:36   

   2108  2 000066   200060 630500                    EPPR0   OPEN_STATS,,AUTO
         2 000067   450000 713400                    CLIMB   alt,open
         2 000070   410400 401760                    pmme    nvectors=18
         2 000071   000063 702000 2                  TSX2    ALTRT

      225     2109    2                 RETURN;

   2109  2 000072   000000 702200 xent               TSX2  ! X66_ARET

      226     2110    2               END;
      227     2111        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:37   
      228     2112        /*F*    NAME:   XSJ$OPEN
      229     2113                PURPOSE: To open the job status file.
      230     2114                DESCRIPTION: The :JOBSTATS file is opened SHARE ALL in the
      231     2115                        mode indicated by the caller. Updating the file is
      232     2116                        restricted to processors in :SYS and those with
      233     2117                        the PR_FMSEC# privilege.                           */
      234     2118        /*D*    NAME:   XSJ$OPEN
      235     2119                CALL:   XSJ$OPEN(PARAM)
      236     2120                INPUT:  PARAM - A structure defined by the XSJ$PARAM macro.
      237     2121                        The following fields are used:
      238     2122                        PARAM.DCB# - The DCB number to use  for status file I/O
      239     2123                        PARAM.MODE# - The mode (from CP_6_SUBS) in which to open
      240     2124                                      the file.
      241     2125        */
      242     2126    1   XSJ$OPEN:
      243     2127    1           ENTRY(PARM)   ALTRET;

   2127  2 000073   000000 700200 xent  XSJ$OPEN     TSX0  ! X66_AUTO_1
         2 000074   000210 000001                    ZERO    136,1

      244     2128        /**/
      245     2129    1           OPEN_STATS = C_OPEN_STATS;

   2129  2 000075   000100 100400                    MLR     fill='000'O
         2 000076   000036 000350 1                  ADSC9   C_OPEN_STATS             cn=0,n=232
         2 000077   200060 000350                    ADSC9   OPEN_STATS,,AUTO         cn=0,n=232

      246     2130    1           GOTO OPENIT;

   2130  2 000100   000116 710000 2                  TRA     OPENIT

      247     2131        /**/
      248     2132        /*F* NAME:         XSJ$OPENF
      249     2133             PURPOSE:      To open the job status file with FPARAMs
      250     2134             DESCRIPTION:  Like XSJ$OPEN but FPARAMs are passed to the caller,
      251     2135                           and the SHARE is taken from PARAM. */
      252     2136        /*D* NAME:         XSJ$OPENF
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:38   
      253     2137             CALL:         XSJ$OPENF(PARAM)
      254     2138                INPUT:  PARAM - A structure defined by the XSJ$PARAM macro.
      255     2139                        The following fields are used:
      256     2140                        PARAM.DCB# - The DCB number to use  for status file I/O
      257     2141                        PARAM.MODE# - The mode (from CP_6_SUBS) in which to open
      258     2142                                      the file.
      259     2143                        PARAM.SHARE# - Used to select SHARE on the open
      260     2144                        PARAM.FPARAM_ - Vector framing the caller's FPARAM
      261     2145                                        buffer. */
      262     2146    1   XSJ$OPENF: ENTRY(PARM) ALTRET;

   2146  2 000101   000000 700200 xent  XSJ$OPENF    TSX0  ! X66_AUTO_1
         2 000102   000210 000001                    ZERO    136,1

      263     2147        /**/
      264     2148    1           OPEN_STATS=C_OPEN_STATS;

   2148  2 000103   000100 100400                    MLR     fill='000'O
         2 000104   000036 000350 1                  ADSC9   C_OPEN_STATS             cn=0,n=232
         2 000105   200060 000350                    ADSC9   OPEN_STATS,,AUTO         cn=0,n=232

      265     2149    1           OPEN_STATS.FPARAM_=PARM.FPARAM_;

   2149  2 000106   200003 470500                    LDP0    @PARM,,AUTO
         2 000107   000006 237100                    LDAQ    6,,PR0
         2 000110   200110 757100                    STAQ    OPEN_STATS+24,,AUTO

      266     2150    1           OPEN_STATS.V.SHARE#=PARM.SHARE#;

   2150  2 000111   000005 236100                    LDQ     5,,PR0
         2 000112   000003 736000                    QLS     3
         2 000113   200124 676100                    ERQ     OPEN_STATS+36,,AUTO
         2 000114   000030 376007                    ANQ     24,DL
         2 000115   200124 656100                    ERSQ    OPEN_STATS+36,,AUTO

   2150  2 000116                       OPENIT       null
      267     2151    1   OPENIT: ;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:39   
      268     2152    1           OPEN_STATS.V_ = VECTOR(OPEN_STATS.V);

   2152  2 000116   000000 235000 3                  LDA     0
         2 000117   200206 452500                    STP2    WRITE_STATS+14,,AUTO
         2 000120   200206 236100                    LDQ     WRITE_STATS+14,,AUTO
         2 000121   000124 036003                    ADLQ    84,DU
         2 000122   200060 757100                    STAQ    OPEN_STATS,,AUTO

      269     2153    1           OPEN_STATS.V.FUN# = PARM.MODE#;

   2153  2 000123   200003 470500                    LDP0    @PARM,,AUTO
         2 000124   000004 236100                    LDQ     4,,PR0
         2 000125   000022 772000                    QRL     18
         2 000126   200125 552110                    STBQ    OPEN_STATS+37,'10'O,AUTO

      270     2154    1           OPEN_STATS.V.DCB# = PARM.DCB#;

   2154  2 000127   000005 220100                    LDX0    5,,PR0
         2 000130   200124 740100                    STX0    OPEN_STATS+36,,AUTO

      271     2155    1           CALL M$OPEN(OPEN_STATS) ALTRET(ALTRT);

   2155  2 000131   200060 630500                    EPPR0   OPEN_STATS,,AUTO
         2 000132   450000 713400                    CLIMB   alt,open
         2 000133   410400 401760                    pmme    nvectors=18
         2 000134   000063 702000 2                  TSX2    ALTRT

      272     2156    1           RETURN;

   2156  2 000135   000000 702200 xent               TSX2  ! X66_ARET

      273     2157        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:40   
      274     2158        /*F*    NAME:   XSJ$READ
      275     2159                PURPOSE: To read a record of a given type from the job status file.
      276     2160                DESCRIPTION: The record indicated by TYPE# and other parameters
      277     2161                        is read into the buffer supplied by the caller.    */
      278     2162        /*D*    NAME:   XSJ$READ
      279     2163                CALL:   XSJ$READ(PARAM)
      280     2164                INPUT:  PARAM - A structure defined by the XSJ$PARAM macro.
      281     2165                        The following fields are used:
      282     2166                        PARAM.DCB# - The DCB number to use  for status file I/O
      283     2167                        PARAM.BUF_ - VECTOR(user buffer to read into)
      284     2168                        PARAM.TYPE# - The type (from XSJ_SUBS_C) of the record
      285     2169                                to be read. Determines which of the following
      286     2170                                parameters are required.
      287     2171                        PARAM.SYSID# - For %TYP_INFO#: The SYSID of the job whose
      288     2172                                information record is to be returned.
      289     2173                        PARAM.NAME$ - For %TYP_NAME#: PTR to the JOBNAME of the job
      290     2174                                whose JOBNAME record is to be read.
      291     2175                        PARAM.ACCT$ - For %TYP_NAME#: PTR to the ACCT of the job
      292     2176                                whose JOBNAME record is to be read.
      293     2177        */
      294     2178    1   XSJ$READ:
      295     2179    1           ENTRY(PARM)   ALTRET;

   2179  2 000136   000000 700200 xent  XSJ$READ     TSX0  ! X66_AUTO_1
         2 000137   000210 000001                    ZERO    136,1

      296     2180        /**/
      297     2181    1           READ_STATS = C_READ_STATS;

   2181  2 000140   000100 100400                    MLR     fill='000'O
         2 000141   000142 000070 1                  ADSC9   C_READ_STATS             cn=0,n=56
         2 000142   200152 000070                    ADSC9   READ_STATS,,AUTO         cn=0,n=56

      298     2182    2           DO CASE (PARM.TYPE#);

   2182  2 000143   200003 470500                    LDP0    @PARM,,AUTO
         2 000144   000004 220100                    LDX0    4,,PR0
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:41   
         2 000145   000777 360003                    ANX0    511,DU
         2 000146   000003 100003                    CMPX0   3,DU
         2 000147   000151 602010 2                  TNC     s:2182+6,X0
         2 000150   000210 710000 2                  TRA     s:2193
         2 000151   000210 710000 2                  TRA     s:2193
         2 000152   000154 710000 2                  TRA     s:2184
         2 000153   000170 710000 2                  TRA     s:2188

      299     2183    2             CASE(%TYP_INFO#);             /* Read job information record        */

      300     2184    2               K_INFO = C_K_INFO;

   2184  2 000154   000174 236000 1                  LDQ     C_K_INFO
         2 000155   000002 376000 3                  ANQ     2
         2 000156   200005 756100                    STQ     K_INFO,,AUTO

      301     2185    2               K_INFO.SYSID#=PARM.SYSID#;

   2185  2 000157   000004 236100                    LDQ     4,,PR0
         2 000160   000011 736000                    QLS     9
         2 000161   200005 552130                    STBQ    K_INFO,'30'O,AUTO

      302     2186    2               READ_STATS.KEY_ = VECTOR(K_INFO);

   2186  2 000162   777640 235007                    LDA     -96,DL
         2 000163   200206 452500                    STP2    WRITE_STATS+14,,AUTO
         2 000164   200206 236100                    LDQ     WRITE_STATS+14,,AUTO
         2 000165   000005 036003                    ADLQ    5,DU
         2 000166   200154 757100                    STAQ    READ_STATS+2,,AUTO
         2 000167   000210 710000 2                  TRA     s:2193

      303     2187    2             CASE(%TYP_NAME#);             /* Read job name record               */

      304     2188    2               K_NAME = C_K_NAME;

   2188  2 000170   000100 100400                    MLR     fill='000'O
         2 000171   000175 000051 1                  ADSC9   C_K_NAME                 cn=0,n=41
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:42   
         2 000172   200006 000051                    ADSC9   K_NAME,,AUTO             cn=0,n=41

      305     2189    2               K_NAME.JOBNAME# = PARM.NAME$->B$CHAR31;

   2189  2 000173   000003 471500                    LDP1    3,,PR0
         2 000174   040100 100500                    MLR     fill='040'O
         2 000175   100000 000037                    ADSC9   0,,PR1                   cn=0,n=31
         2 000176   200006 400037                    ADSC9   K_NAME,,AUTO             cn=2,n=31

      306     2190    2               K_NAME.ACCT# = PARM.ACCT$->B$CHAR8;

   2190  2 000177   000002 471500                    LDP1    2,,PR0
         2 000200   040100 100500                    MLR     fill='040'O
         2 000201   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         2 000202   200016 200010                    ADSC9   K_NAME+8,,AUTO           cn=1,n=8

      307     2191    2               READ_STATS.KEY_ = VECTOR(K_NAME);

   2191  2 000203   000003 235000 3                  LDA     3
         2 000204   200206 452500                    STP2    WRITE_STATS+14,,AUTO
         2 000205   200206 236100                    LDQ     WRITE_STATS+14,,AUTO
         2 000206   000006 036003                    ADLQ    6,DU
         2 000207   200154 757100                    STAQ    READ_STATS+2,,AUTO

      308     2192    2           END;

      309     2193    1           READ_STATS.V_ = VECTOR(READ_STATS.V);

   2193  2 000210   000004 235000 3                  LDA     4
         2 000211   200206 452500                    STP2    WRITE_STATS+14,,AUTO
         2 000212   200206 236100                    LDQ     WRITE_STATS+14,,AUTO
         2 000213   000162 036003                    ADLQ    114,DU
         2 000214   200152 757100                    STAQ    READ_STATS,,AUTO

      310     2194    1           READ_STATS.BUF_ = PARM.BUF_;

   2194  2 000215   000000 237100                    LDAQ    0,,PR0
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:43   
         2 000216   200156 757100                    STAQ    READ_STATS+4,,AUTO

      311     2195    1           READ_STATS.V.DCB# = PARM.DCB#;

   2195  2 000217   000005 220100                    LDX0    5,,PR0
         2 000220   200162 740100                    STX0    READ_STATS+8,,AUTO

      312     2196    1           CALL M$READ(READ_STATS) ALTRET(ALTRT);

   2196  2 000221   200152 630500                    EPPR0   READ_STATS,,AUTO
         2 000222   440000 713400                    CLIMB   alt,read
         2 000223   401400 401760                    pmme    nvectors=4
         2 000224   000063 702000 2                  TSX2    ALTRT

      313     2197    1           RETURN;

   2197  2 000225   000000 702200 xent               TSX2  ! X66_ARET

      314     2198        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:44   
      315     2199        /*F*    NAME:   XSJ$WRITE
      316     2200                PURPOSE: To write a record of the indicated type to the job
      317     2201                        status file.
      318     2202                DESCRIPTION: A record of the type indicated by TYPE# plus
      319     2203                        other passed information is written to :JOBSTATS from
      320     2204                        a buffer passed by the caller.                     */
      321     2205        /*D*    NAME:   XSJ$WRITE
      322     2206                CALL:   XSJ$WRITE(PARAM)
      323     2207                INPUT:  PARAM - A structure defined by the XSJ$PARAM macro.
      324     2208                        The following fields are used:
      325     2209                        PARAM.DCB# - The DCB number to use  for status file I/O
      326     2210                        PARAM.BUF_ - VECTOR(user buffer to write from)
      327     2211                        PARAM.TYPE# - The type (from XSJ_SUBS_C) of the record
      328     2212                                to be written. Determines which of the following
      329     2213                                parameters are required.
      330     2214                        PARAM.SYSID# - For %TYP_INFO#: The SYSID of the job whose
      331     2215                                information record is to be written.
      332     2216                        PARAM.NAME$ - For %TYP_NAME#: PTR to the JOBNAME of the job
      333     2217                                whose JOBNAME record is to be written.
      334     2218                        PARAM.ACCT$ - For %TYP_NAME#: PTR to the ACCT of the job
      335     2219                                whose JOBNAME record is to be written.
      336     2220        */
      337     2221    1   XSJ$WRITE:
      338     2222    1           ENTRY(PARM)   ALTRET;

   2222  2 000226   000000 700200 xent  XSJ$WRITE    TSX0  ! X66_AUTO_1
         2 000227   000210 000001                    ZERO    136,1

      339     2223        /**/
      340     2224    1           WRITE_STATS = C_WRITE_STATS;

   2224  2 000230   000100 100400                    MLR     fill='000'O
         2 000231   000160 000060 1                  ADSC9   C_WRITE_STATS            cn=0,n=48
         2 000232   200170 000060                    ADSC9   WRITE_STATS,,AUTO        cn=0,n=48

      341     2225    2           DO CASE (PARM.TYPE#);

PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:45   
   2225  2 000233   200003 470500                    LDP0    @PARM,,AUTO
         2 000234   000004 220100                    LDX0    4,,PR0
         2 000235   000777 360003                    ANX0    511,DU
         2 000236   000003 100003                    CMPX0   3,DU
         2 000237   000241 602010 2                  TNC     s:2225+6,X0
         2 000240   000300 710000 2                  TRA     s:2236
         2 000241   000300 710000 2                  TRA     s:2236
         2 000242   000244 710000 2                  TRA     s:2227
         2 000243   000260 710000 2                  TRA     s:2231

      342     2226    2             CASE(%TYP_INFO#);             /* Write job information record       */

      343     2227    2               K_INFO = C_K_INFO;

   2227  2 000244   000174 236000 1                  LDQ     C_K_INFO
         2 000245   000002 376000 3                  ANQ     2
         2 000246   200005 756100                    STQ     K_INFO,,AUTO

      344     2228    2               K_INFO.SYSID#=PARM.SYSID#;

   2228  2 000247   000004 236100                    LDQ     4,,PR0
         2 000250   000011 736000                    QLS     9
         2 000251   200005 552130                    STBQ    K_INFO,'30'O,AUTO

      345     2229    2               WRITE_STATS.KEY_ = VECTOR(K_INFO);

   2229  2 000252   777640 235007                    LDA     -96,DL
         2 000253   200206 452500                    STP2    WRITE_STATS+14,,AUTO
         2 000254   200206 236100                    LDQ     WRITE_STATS+14,,AUTO
         2 000255   000005 036003                    ADLQ    5,DU
         2 000256   200172 757100                    STAQ    WRITE_STATS+2,,AUTO
         2 000257   000300 710000 2                  TRA     s:2236

      346     2230    2             CASE(%TYP_NAME#);             /* Write job name record              */

      347     2231    2               K_NAME = C_K_NAME;

PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:46   
   2231  2 000260   000100 100400                    MLR     fill='000'O
         2 000261   000175 000051 1                  ADSC9   C_K_NAME                 cn=0,n=41
         2 000262   200006 000051                    ADSC9   K_NAME,,AUTO             cn=0,n=41

      348     2232    2               K_NAME.JOBNAME# = PARM.NAME$->B$CHAR31;

   2232  2 000263   000003 471500                    LDP1    3,,PR0
         2 000264   040100 100500                    MLR     fill='040'O
         2 000265   100000 000037                    ADSC9   0,,PR1                   cn=0,n=31
         2 000266   200006 400037                    ADSC9   K_NAME,,AUTO             cn=2,n=31

      349     2233    2               K_NAME.ACCT# = PARM.ACCT$->B$CHAR8;

   2233  2 000267   000002 471500                    LDP1    2,,PR0
         2 000270   040100 100500                    MLR     fill='040'O
         2 000271   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         2 000272   200016 200010                    ADSC9   K_NAME+8,,AUTO           cn=1,n=8

      350     2234    2               WRITE_STATS.KEY_ = VECTOR(K_NAME);

   2234  2 000273   000003 235000 3                  LDA     3
         2 000274   200206 452500                    STP2    WRITE_STATS+14,,AUTO
         2 000275   200206 236100                    LDQ     WRITE_STATS+14,,AUTO
         2 000276   000006 036003                    ADLQ    6,DU
         2 000277   200172 757100                    STAQ    WRITE_STATS+2,,AUTO

      351     2235    2           END;

      352     2236    1           WRITE_STATS.V_ = VECTOR(WRITE_STATS.V);

   2236  2 000300   000005 235000 3                  LDA     5
         2 000301   200206 452500                    STP2    WRITE_STATS+14,,AUTO
         2 000302   200206 236100                    LDQ     WRITE_STATS+14,,AUTO
         2 000303   000200 036003                    ADLQ    128,DU
         2 000304   200170 757100                    STAQ    WRITE_STATS,,AUTO

      353     2237    1           WRITE_STATS.BUF_ = PARM.BUF_;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:47   

   2237  2 000305   000000 237100                    LDAQ    0,,PR0
         2 000306   200174 757100                    STAQ    WRITE_STATS+4,,AUTO

      354     2238    1           WRITE_STATS.V.DCB# = PARM.DCB#;

   2238  2 000307   000005 220100                    LDX0    5,,PR0
         2 000310   200200 740100                    STX0    WRITE_STATS+8,,AUTO

      355     2239    1           CALL M$WRITE(WRITE_STATS)  ALTRET(ALTRT);

   2239  2 000311   200170 630500                    EPPR0   WRITE_STATS,,AUTO
         2 000312   440001 713400                    CLIMB   alt,write
         2 000313   401400 401760                    pmme    nvectors=4
         2 000314   000063 702000 2                  TSX2    ALTRT

      356     2240    1           RETURN;

   2240  2 000315   000000 702200 xent               TSX2  ! X66_ARET

      357     2241        %EJECT;
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:48   
      358     2242        /*F*    NAME:   XSJ$CLOSE
      359     2243                PURPOSE: To close the job status file.
      360     2244                DESCRIPTION: The DCB indicated by the passed DCB# is closed
      361     2245                        with SAVE specified.                               */
      362     2246        /*D*    NAME:   XSJ$CLOSE
      363     2247                CALL:   XSJ$CLOSE(PARAM)
      364     2248                INPUT:  PARAM - A structure defined by the XSJ$PARAM macro.
      365     2249                        The following fields are used:
      366     2250                        PARAM.DCB# - The DCB number to use  for status file I/O
      367     2251        */
      368     2252    1   XSJ$CLOSE:
      369     2253    1           ENTRY(PARM)   ALTRET;

   2253  2 000316   000000 700200 xent  XSJ$CLOSE    TSX0  ! X66_AUTO_1
         2 000317   000210 000001                    ZERO    136,1

      370     2254        /**/
      371     2255
      372     2256    1           CALL CLOSEIT ALTRET(ALTRT);

   2256  2 000320   000323 701000 2                  TSX1    CLOSEIT
         2 000321   000063 702000 2                  TSX2    ALTRT

      373     2257    1           RETURN;

   2257  2 000322   000000 702200 xent               TSX2  ! X66_ARET

      374     2258
      375     2259    1   CLOSEIT: PROC ALTRET;

   2259  2 000323   200204 741300       CLOSEIT      STX1  ! WRITE_STATS+12,,AUTO

      376     2260    2           CLS_STATS = C_CLS_STATS;

   2260  2 000324   000100 100400                    MLR     fill='000'O
         2 000325   000000 000170 1                  ADSC9   C_CLS_STATS              cn=0,n=120
         2 000326   200022 000170                    ADSC9   CLS_STATS,,AUTO          cn=0,n=120
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:49   

      377     2261    2           CLS_STATS.V_ = VECTOR(CLS_STATS.V);

   2261  2 000327   000005 235000 3                  LDA     5
         2 000330   200206 452500                    STP2    WRITE_STATS+14,,AUTO
         2 000331   200206 236100                    LDQ     WRITE_STATS+14,,AUTO
         2 000332   000054 036003                    ADLQ    44,DU
         2 000333   200022 757100                    STAQ    CLS_STATS,,AUTO

      378     2262    2           CLS_STATS.V.DCB# = PARM.DCB#;

   2262  2 000334   200003 470500                    LDP0    @PARM,,AUTO
         2 000335   000005 220100                    LDX0    5,,PR0
         2 000336   200054 740100                    STX0    CLS_STATS+26,,AUTO

      379     2263    2           CALL M$CLOSE(CLS_STATS) ALTRET(E_M$CLOSE);

   2263  2 000337   200022 630500                    EPPR0   CLS_STATS,,AUTO
         2 000340   450001 713400                    CLIMB   alt,close
         2 000341   406000 401760                    pmme    nvectors=13
         2 000342   000345 702000 2                  TSX2    E_M$CLOSE

      380     2264    2           RETURN;

   2264  2 000343   200204 221300                    LDX1  ! WRITE_STATS+12,,AUTO
         2 000344   000001 702211                    TSX2  ! 1,X1

      381     2265    2   E_M$CLOSE:
      382     2266    2           ALTRETURN;

   2266  2 000345   200204 221300       E_M$CLOSE    LDX1  ! WRITE_STATS+12,,AUTO
         2 000346   000000 702211                    TSX2  ! 0,X1

      383     2267    2   END CLOSEIT;
      384     2268        /*F* NAME:         XSJ$SCRATCH
      385     2269             PURPOSE:      To delete the job status file
      386     2270             DESCRIPTION:  The DCB indicated by the passed DCB# is closed
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:50   
      387     2271                           with SCRATCH specified. */
      388     2272        /*D* NAME:         XSJ$SCRATCH
      389     2273             CALL:         XSJ$SCRATCH(PARAM)
      390     2274                INPUT:  PARAM - A structure defined by the XSJ$PARAM macro.
      391     2275                        The following fields are used:
      392     2276                        PARAM.DCB# - The DCB number to use  for status file I/O
      393     2277        */
      394     2278    1   XSJ$SCRATCH: ENTRY(PARM) ALTRET;

   2278  2 000347   000000 700200 xent  XSJ$SCRATCH  TSX0  ! X66_AUTO_1
         2 000350   000210 000001                    ZERO    136,1

      395     2279        /**/
      396     2280    1           CLS_STATS=C_CLS_STATS;

   2280  2 000351   000100 100400                    MLR     fill='000'O
         2 000352   000000 000170 1                  ADSC9   C_CLS_STATS              cn=0,n=120
         2 000353   200022 000170                    ADSC9   CLS_STATS,,AUTO          cn=0,n=120

      397     2281    1           CLS_STATS.V_ = VECTOR(CLS_STATS.V);

   2281  2 000354   000005 235000 3                  LDA     5
         2 000355   200206 452500                    STP2    WRITE_STATS+14,,AUTO
         2 000356   200206 236100                    LDQ     WRITE_STATS+14,,AUTO
         2 000357   000054 036003                    ADLQ    44,DU
         2 000360   200022 757100                    STAQ    CLS_STATS,,AUTO

      398     2282    1           CLS_STATS.V.DCB# = PARM.DCB#;

   2282  2 000361   200003 470500                    LDP0    @PARM,,AUTO
         2 000362   000005 220100                    LDX0    5,,PR0
         2 000363   200054 740100                    STX0    CLS_STATS+26,,AUTO

      399     2283    1           CLS_STATS.V.DISP#=%SCRATCH#;

   2283  2 000364   000001 236007                    LDQ     1,DL
         2 000365   200054 552104                    STBQ    CLS_STATS+26,'04'O,AUTO
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:51   

      400     2284    1           CALL M$CLOSE(CLS_STATS) ALTRET(ALTRT);

   2284  2 000366   200022 630500                    EPPR0   CLS_STATS,,AUTO
         2 000367   450001 713400                    CLIMB   alt,close
         2 000370   406000 401760                    pmme    nvectors=13
         2 000371   000063 702000 2                  TSX2    ALTRT

      401     2285    1           RETURN;

   2285  2 000372   000000 702200 xent               TSX2  ! X66_ARET
      402     2286        /**/
      403     2287    1   END     XSJ$JOBINFO;

PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:52   
--  Include file information  --

   XSJ_SUBS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XSJ_MAC_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure XSJ$JOBINFO.
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:53   

 **** Variables and constants ****

  ****  Section 001 RoData XSJ$JOBINFO

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   133-0-0/w STRC(216)   r     1 ACCESS_LIST              130-0-0/w STRC(99)    r     1 ACSVEH_LIST
     0-0-0/d STRC(1080)  r     1 C_CLS_STATS              174-0-0/w STRC(27)    r     1 C_K_INFO
   175-0-0/w STRC(369)   r     1 C_K_NAME                  36-0-0/d STRC(2088)  r     1 C_OPEN_STATS
   142-0-0/d STRC(504)   r     1 C_READ_STATS             210-0-0/c STRC(90)    r     1 C_STATS_FID
   213-0-0/c STRC(72)    r     1 C_SYSACCT                216-0-0/d STRC(90)    r     1 C_SYSPACK
   160-0-0/d STRC(432)   r     1 C_WRITE_STATS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @PARM                     22-0-0/d STRC(1080)  r     1 CLS_STATS
     5-0-0/w STRC(27)    r     1 K_INFO                     6-0-0/w STRC(369)   r     1 K_NAME
    60-0-0/d STRC(2088)  r     1 OPEN_STATS                *0-0-0/d STRC(288)   r     1 PARM
   152-0-0/d STRC(504)   r     1 READ_STATS               170-0-0/d STRC(432)   r     1 WRITE_STATS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/c CHAR(31)    r     1 B$CHAR31
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:54   
     0-0-0/c CHAR(8)     r     1 B$CHAR8                    0-0-0/w STRC(144)   r     1 B$TCB


   Procedure XSJ$JOBINFO requires 251 words for executable code.
   Procedure XSJ$JOBINFO requires 136 words of local(AUTO) storage.

    No errors detected in file XSJ$JOBINFO.:E05TSI    .
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:55   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:56   
          MINI XREF LISTING

ACCESS_LIST
      1812**DCL      1720--DCLINIT
ACCESS_LIST.Q
      1813**DCL      1812--DCLINIT
ACSVEH_LIST
      1773**DCL      1721--DCLINIT
ACSVEH_LIST.Q
      1774**DCL      1773--DCLINIT
ALTRT
      2093**LABEL    2072--CALLALT  2095--CALLALT  2108--CALLALT  2155--CALLALT  2196--CALLALT  2239--CALLALT
      2256--CALLALT  2284--CALLALT
B$ALT.CODE
      2045**DCL      2045--REDEF    2046--REDEF    2046--REDEF
B$ALT.ERR.CODE
      2047**DCL      2099>>IF
B$ALT.ERR.ERR#
      2047**DCL      2047--REDEF
B$ALT.EVID
      2046**DCL      2046--REDEF    2046--REDEF
B$CHAR31
      2039**DCL      2189>>ASSIGN   2232>>ASSIGN
B$CHAR8
      2038**DCL      2190>>ASSIGN   2233>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
       864**DCL       864--REDEF
B$JIT.ERR.MID
       771**DCL       771--REDEF
B$JIT.JRESPEAK
       932**DCL       933--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      1041**DCL      1041--REDEF    1042--REDEF
B$JIT.PNR
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:57   
       945**DCL       945--REDEF
B$JIT.TSLINE
      1039**DCL      1040--REDEF
B$JIT$
      1319**DCL       765--IMP-PTR
B$TCB.ALT$
      2041**DCL      2099>>IF
B$TCB$
      1320**DCL      2099>>IF
CLOSEIT
      2259**PROC     2095--CALL     2256--CALL
CLS_STATS
      1385**DCL      2260<<ASSIGN   2263<>CALL     2280<<ASSIGN   2284<>CALL
CLS_STATS.SN_
      1385**DCL      1385--REDEF
CLS_STATS.UTL_
      1386**DCL      1386--REDEF
CLS_STATS.V
      1390**DCL      2261--ASSIGN   2281--ASSIGN
CLS_STATS.V.DCB#
      1391**DCL      2262<<ASSIGN   2282<<ASSIGN
CLS_STATS.V.DISP#
      1394**DCL      2283<<ASSIGN
CLS_STATS.V.EXPIRE#
      1400**DCL      1400--REDEF
CLS_STATS.V.TYPE#
      1398**DCL      1398--REDEF
CLS_STATS.V.XTNSIZE#
      1395**DCL      1395--REDEF    1397--REDEF
CLS_STATS.V_
      1385**DCL      2261<<ASSIGN   2281<<ASSIGN
C_CLS_STATS
      1619**DCL      2260>>ASSIGN   2280>>ASSIGN
C_CLS_STATS.SN_
      1619**DCL      1619--REDEF
C_CLS_STATS.UTL_
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:58   
      1620**DCL      1620--REDEF
C_CLS_STATS.V
      1624**DCL      1619--DCLINIT
C_CLS_STATS.V.EXPIRE#
      1634**DCL      1634--REDEF
C_CLS_STATS.V.TYPE#
      1632**DCL      1632--REDEF
C_CLS_STATS.V.XTNSIZE#
      1629**DCL      1629--REDEF    1631--REDEF
C_K_INFO
      1958**DCL      2184>>ASSIGN   2227>>ASSIGN
C_K_NAME
      1972**DCL      2188>>ASSIGN   2231>>ASSIGN
C_OPEN_STATS
      1718**DCL      2067>>ASSIGN   2091>>ASSIGN   2129>>ASSIGN   2148>>ASSIGN
C_OPEN_STATS.ACSVEH_
      1720**DCL      1721--REDEF
C_OPEN_STATS.ALTKEYS_
      1726**DCL      1727--REDEF    1727--REDEF
C_OPEN_STATS.HDR_
      1725**DCL      1726--REDEF
C_OPEN_STATS.TAB_
      1724**DCL      1725--REDEF
C_OPEN_STATS.UHL_
      1718**DCL      1719--REDEF    1719--REDEF
C_OPEN_STATS.V
      1727**DCL      1718--DCLINIT
C_OPEN_STATS.V.FSN#
      1758**DCL      1758--REDEF    1758--REDEF
C_OPEN_STATS.WSN_
      1724**DCL      1724--REDEF
C_READ_STATS
      1885**DCL      2181>>ASSIGN
C_READ_STATS.STATION_
      1888**DCL      1889--REDEF
C_READ_STATS.V
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:59   
      1889**DCL      1885--DCLINIT
C_READ_STATS.V.DVBYTE.REREAD#
      1900**DCL      1900--REDEF
C_READ_STATS.V.INDX#
      1898**DCL      1898--REDEF
C_STATS_FID
      2002**DCL      1719--DCLINIT
C_SYSACCT
      2017**DCL      1723--DCLINIT
C_SYSPACK
      2032**DCL      1718--DCLINIT
C_WRITE_STATS
      1928**DCL      2224>>ASSIGN
C_WRITE_STATS.STATION_
      1930**DCL      1930--REDEF
C_WRITE_STATS.V
      1931**DCL      1928--DCLINIT
C_WRITE_STATS.V.DVBYTE.VFC#
      1937**DCL      1937--REDEF
E_CREATE
      2099**LABEL    2094--CALLALT
E_M$CLOSE IN PROCEDURE CLOSEIT
      2266**LABEL    2263--CALLALT
K_INFO
      1338**DCL      2184<<ASSIGN   2186--ASSIGN   2227<<ASSIGN   2229--ASSIGN
K_INFO.SYSID#
      1338**DCL      2185<<ASSIGN   2228<<ASSIGN
K_NAME
      1353**DCL      2188<<ASSIGN   2191--ASSIGN   2231<<ASSIGN   2234--ASSIGN
K_NAME.ACCT#
      1354**DCL      2190<<ASSIGN   2233<<ASSIGN
K_NAME.JOBNAME#
      1353**DCL      2189<<ASSIGN   2232<<ASSIGN
M$CLOSE
       143**DCL-ENT  2263--CALL     2284--CALL
M$OPEN
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:60   
       143**DCL-ENT  2072--CALL     2094--CALL     2108--CALL     2155--CALL
M$READ
       144**DCL-ENT  2196--CALL
M$WRITE
       144**DCL-ENT  2239--CALL
OPENIT
      2150**LABEL    2130--GOTO
OPEN_STATS
      1471**DCL      2067<<ASSIGN   2072<>CALL     2091<<ASSIGN   2094<>CALL     2108<>CALL     2129<<ASSIGN
      2148<<ASSIGN   2155<>CALL
OPEN_STATS.ACSVEH_
      1473**DCL      1474--REDEF
OPEN_STATS.ALTKEYS_
      1479**DCL      1480--REDEF    1480--REDEF
OPEN_STATS.FPARAM_
      1476**DCL      2149<<ASSIGN
OPEN_STATS.HDR_
      1478**DCL      1479--REDEF
OPEN_STATS.TAB_
      1477**DCL      1478--REDEF
OPEN_STATS.UHL_
      1471**DCL      1472--REDEF    1472--REDEF
OPEN_STATS.V
      1480**DCL      2068--ASSIGN   2092--ASSIGN   2152--ASSIGN
OPEN_STATS.V.CTG#
      1484**DCL      2070<<ASSIGN
OPEN_STATS.V.DCB#
      1480**DCL      2069<<ASSIGN   2093<<ASSIGN   2154<<ASSIGN
OPEN_STATS.V.EXIST#
      1484**DCL      2071<<ASSIGN
OPEN_STATS.V.FSN#
      1511**DCL      1511--REDEF    1511--REDEF
OPEN_STATS.V.FUN#
      1490**DCL      2107<<ASSIGN   2153<<ASSIGN
OPEN_STATS.V.SHARE#
      1485**DCL      2150<<ASSIGN
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:61   
OPEN_STATS.V_
      1471**DCL      2068<<ASSIGN   2092<<ASSIGN   2152<<ASSIGN
OPEN_STATS.WSN_
      1477**DCL      1477--REDEF
PARM
       125**DCL        29--PROC     2065--ENTRY    2088--ENTRY    2126--ENTRY    2146--ENTRY    2178--ENTRY
      2221--ENTRY    2252--ENTRY    2278--ENTRY
PARM.ACCT$
       126**DCL      2190>>ASSIGN   2233>>ASSIGN
PARM.BUF_
       125**DCL      2194>>ASSIGN   2237>>ASSIGN
PARM.DCB#
       128**DCL      2069>>ASSIGN   2093>>ASSIGN   2154>>ASSIGN   2195>>ASSIGN   2238>>ASSIGN   2262>>ASSIGN
      2282>>ASSIGN
PARM.FPARAM_
       129**DCL      2149>>ASSIGN
PARM.MODE#
       127**DCL      2153>>ASSIGN
PARM.NAME$
       127**DCL      2189>>ASSIGN   2232>>ASSIGN
PARM.SHARE#
       129**DCL      2150>>ASSIGN
PARM.SYSID#
       128**DCL      2185>>ASSIGN   2228>>ASSIGN
PARM.TYPE#
       127**DCL      2182>>DOCASE   2225>>DOCASE
READ_STATS
      1534**DCL      2181<<ASSIGN   2196<>CALL
READ_STATS.BUF_
      1536**DCL      2194<<ASSIGN
READ_STATS.KEY_
      1534**DCL      2186<<ASSIGN   2191<<ASSIGN
READ_STATS.STATION_
      1537**DCL      1538--REDEF
READ_STATS.V
      1538**DCL      2193--ASSIGN
PL6.E3A0      #001=XSJ$JOBINFO File=XSJ$JOBINFO.:E05TSI                          WED 07/30/97 09:10 Page:62   
READ_STATS.V.DCB#
      1538**DCL      2195<<ASSIGN
READ_STATS.V.DVBYTE.REREAD#
      1549**DCL      1549--REDEF
READ_STATS.V.INDX#
      1547**DCL      1547--REDEF
READ_STATS.V_
      1534**DCL      2193<<ASSIGN
UPD_OPEN
      2094**LABEL    2096--GOTO
WRITE_STATS
      1575**DCL      2224<<ASSIGN   2239<>CALL
WRITE_STATS.BUF_
      1575**DCL      2237<<ASSIGN
WRITE_STATS.KEY_
      1575**DCL      2229<<ASSIGN   2234<<ASSIGN
WRITE_STATS.STATION_
      1577**DCL      1577--REDEF
WRITE_STATS.V
      1578**DCL      2236--ASSIGN
WRITE_STATS.V.DCB#
      1578**DCL      2238<<ASSIGN
WRITE_STATS.V.DVBYTE.VFC#
      1584**DCL      1584--REDEF
WRITE_STATS.V_
      1575**DCL      2236<<ASSIGN
