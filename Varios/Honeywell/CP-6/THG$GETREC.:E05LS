VERSION E05

PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:1    
        1        1        /*M* THG$GETREC - ROUTINE TO ACCESS FILES FOR ELAN */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        THG$GETREC: PROC(FILE,KEY_NAME,UTS,DONT_CLOSE) ALTRET;
        8        8        /**/
        9        9        /* PARAMS */
       10       10    1   DCL FILE UBIN;
       11       11    1   DCL KEY_NAME CHAR(8);
       12       12    1   DCL UTS UBIN WORD;
       13       13    1   DCL DONT_CLOSE SBIN;
       14       14        /**/
       15       15        /**/
       16       16        /* INCLUDE FILES */
       17       17        %INCLUDE EL$TABLES;
       18      340        %INCLUDE CP_6;
       19      421        %INCLUDE F$DCB;
       20      470        %INCLUDE B_ERRORS_C;
       21     1597        %INCLUDE TH_SUBS_C;
       22     1979        %INCLUDE TH_DATA_R;
       23     2057        %INCLUDE XS_MACRO_C;
       24     2101        %INCLUDE EL_SUBS_C;
       25     2185        /**/
       26     2186        /* ENTRY DEFS */
       27     2187    1   DCL THM$ERRMSG ENTRY(1);
       28     2188    1   DCL XSA$PFIL ENTRY(2) ALTRET;
       29     2189    1   DCL XSA$READ ENTRY(2) ALTRET;
       30     2190    1   DCL XSA$OPEN ENTRY(2) ALTRET;
       31     2191    1   DCL XSA$CLOSE ENTRY(2) ALTRET;
       32     2192    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
       33     2193        /**/
       34     2194        /* DCBS */
       35     2195    1   DCL M$ERRLOG DCB;
       36     2196    1   DCL M$DEVHIST DCB;
       37     2197    1   DCL M$CFG DCB;
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:2    
       38     2198        /**/
       39     2199        /* VARS */
       40     2200    1   DCL B$TCB$ PTR SYMREF;
       41     2201    1   DCL IO_MASK(0:35) UBIN(8) UNAL;
       42     2202    1   DCL IO_MASK1(0:287) REDEF IO_MASK BIT(1);
       43     2203    1   DCL I SBIN;
       44     2204    1   DCL MEM_TEXT CHAR(8) CONSTANT INIT('MEM     ');
       45     2205    1   DCL PASSED_FLAG BIT(1);
       46     2206    1   DCL EXC_FLAG BIT(1);
       47     2207    1   DCL 1 FEPERR_CODE_F_M,
       48     2208    1         2 FCG UBIN(12) UNAL,
       49     2209    1         2 MID UBIN(6) UNAL;
       50     2210    1   DCL FEPERR_FCG(0:2) REDEF FEPERR_CODE_F_M BIT(6);
       51     2211    1   DCL FEPERR_CODE CHAR(3);
       52     2212    1   DCL FEP_FCG_W UBIN WORD;
       53     2213    1   DCL FEP_FCG UBIN(6) UNAL;
       54     2214    1   DCL INFO$ PTR CONSTANT INIT(ADDR(TH_RECORD_BUF.INFO));
       55     2215    1   DCL M$CONFIG$ PTR;
       56     2216    1   DCL M$DEVHIST$ PTR;
       57     2217    1   DCL CHAR_BASE CHAR(8) BASED;
       58     2218    1   DCL TEMP$ PTR;
       59     2219    1   DCL TYPE_VEC(0:%NTYPES) UBIN BYTE UNAL CONSTANT INIT(511,%EL_CMPSTRT,%EL_MOUNT,
       60     2220    1                                             %EL_DSMT,%EL_TIMESTAMP,%EL_OPER,
       61     2221    1                                             %EL_REX,%EL_FWLOAD,%EL_DIAG,
       62     2222    1                                             %EL_SYSCON,%EL_SYSID,%EL_MPCSTAT,
       63     2223    1                                             %EL_ANLZ,%EL_ZAP,%EL_DEVSTAT,%EL_CHANTRAN,
       64     2224    1                                             %EL_MSOSSAYS,%EL_CP6SAYS,%EL_IOERR,%
              2224                                                      EL_EDAC,
       65     2225    1                                             %EL_FEPERR,%EL_PROCERR,%EL_SPURINT,%
              2225                                                      EL_FEPFLT,
       66     2226    1                                             %EL_SCREECH,%EL_FI,%EL_OSFI,%EL_FEPCRASH,
       67     2227    1                                             %EL_GABRT,%EL_SUA,%EL_SNAP,%EL_CGERR,
       68     2228    1                                             %EL_FEPDUMP,%EL_LOST,%EL_CHNGAARD,
       69     2229    1                                             %EL_DEVSTAT,%EL_DEVSTAT,%EL_MIRROR);
       70     2230    1   DCL CHAR_VEC REDEF TYPE_VEC CHAR(%(NTYPES+1));
       71     2231        /**/
       72     2232    1   DCL 1 CONFIG_KEY STATIC,
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:3    
       73     2233    1         2 C UBIN BYTE UNAL,
       74     2234    1         2 TXT CHAR(8);
       75     2235    1   DCL 1 DEVHIST_KEY8 STATIC ALIGNED,
       76     2236    1         2 C UBIN BYTE UNAL INIT(12),
       77     2237    1         2 TXT CHAR(8) UNAL,
       78     2238    1         2 UTS UBIN WORD UNAL;
       79     2239    1   DCL HEAD_KEY BIT(18) CONSTANT INIT('001000'O);
       80     2240    1   DCL THRESH_KEY BIT(18) CONSTANT INIT('001001'O);
       81     2241    1   DCL MAINT_KEY BIT(18) CONSTANT INIT('001002'O);
       82     2242    1   DCL UTS_KEY BIT(18) CONSTANT INIT('001003'O);
       83     2243    1   DCL RET_KEY CHAR(8) STATIC INIT(' ');
       84     2244    1   DCL 1 FEPNAME STATIC ALIGNED,
       85     2245    1         2 * CHAR(3) UNAL INIT('FEP'),
       86     2246    1         2 FEP# CHAR(5) UNAL INIT(' ');
       87     2247    1   DCL TEMPNUM CHAR(5);
       88     2248    1   DCL HEXNUM UBIN(16) UNAL;
       89     2249    1   DCL 1 TERMINAL_CHAN ,
       90     2250    1         2 A UBIN(8) UNAL,
       91     2251    1         2 B UBIN(8) UNAL;
       92     2252    1   DCL CHAN_CHAR CHAR(1);
       93     2253    1   DCL CHAN_NUM UBIN ;
       94     2254    1   DCL J SBIN;
       95     2255    1   DCL FOUND BIT(1);
       96     2256        /**/
       97     2257        /* FPT DEFINITIONS */
       98     2258        %FPT_OPEN (FPTN=OPEN_DEVHIST,
       99     2259                   STCLASS=CONSTANT,
      100     2260                   DCB=M$DEVHIST,
      101     2261                   NAME=DEVHIST,
      102     2262                   ACCT=DEVHIST_ACCT,
      103     2263                   FUN=IN,
      104     2264                   ASN=FILE,
      105     2265                   ORG=KEYED);
      106     2374        %FPT_READ (FPTN=READ_DEVHIST,
      107     2375                   DCB=M$DEVHIST,
      108     2376                   BUF=RECORD_BUF,
      109     2377                   STCLASS=STATIC,
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:4    
      110     2378                   KEYS=YES);
      111     2417        %FPT_CLOSE (FPTN=CLOSE_DEVHIST,
      112     2418                    STCLASS=CONSTANT,
      113     2419                    DCB=M$DEVHIST);
      114     2461        %FPT_OPEN (FPTN=OPEN_CONFIG,
      115     2462                   STCLASS=CONSTANT,
      116     2463                     DCB = M$CFG,
      117     2464                   NAME=CONFIG,
      118     2465                   ACCT=SYSACCT,
      119     2466                   FUN=IN,
      120     2467                   ASN=FILE,
      121     2468                   SHARE=ALL,
      122     2469                   ORG=KEYED);
      123     2578        %FPT_OPEN (FPTN=TH_OPEN_ERRLOG,
      124     2579                   STCLASS=SYMREF);
      125     2688        %FPT_CLOSE (FPTN=TH_CLOSE_ERRLOG,
      126     2689                    STCLASS=SYMREF);
      127     2731        %FPT_READ (FPTN=READ_CONFIG,
      128     2732                     DCB = M$CFG,
      129     2733                   BUF=RECORD_BUF,
      130     2734                   STCLASS=STATIC,
      131     2735                   KEYS=YES);
      132     2774        %FPT_CLOSE (FPTN=CLOSE_CONFIG,
      133     2775                    STCLASS=CONSTANT,
      134     2776                     DCB = M$CFG);
      135     2818        %VLP_NAME (FPTN=DEVHIST,
      136     2819                   STCLASS=CONSTANT,
      137     2820                   NAME=':DEVHIST');
      138     2847        %VLP_NAME (FPTN=CONFIG,
      139     2848                   STCLASS=CONSTANT,
      140     2849                   NAME=':CONFIG');
      141     2876        %VLP_ACCT (FPTN=SYSTAC,
      142     2877                   STCLASS=CONSTANT,
      143     2878                   ACCT=':SYSTAC');
      144     2891        %VLP_ACCT (FPTN=SYSACCT,
      145     2892                   STCLASS=CONSTANT,
      146     2893                   ACCT=':SYS');
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:5    
      147     2906        %FPT_READ (FPTN=READ_ERRLOG,
      148     2907                   STCLASS=CONSTANT,
      149     2908                   DCB=M$ERRLOG,
      150     2909                   BUF=TH_RECORD_BUF);
      151     2948        %FPT_PFIL (DCB=M$ERRLOG,
      152     2949                   STCLASS=STATIC,
      153     2950                   BOF=YES);
      154     2965        %FPT_PRECORD (FPTN=PRECORD,
      155     2966                      DCB=M$DEVHIST,
      156     2967                      KEYR=YES,
      157     2968                      KEYS=YES);
      158     2989        %FPT_PRECORD(FPTN=ERRLOG_PRECORD, DCB=M$ERRLOG, KEYS=NO, N=-1);
      159     3010        /**/
      160     3011        /* MACROS */
      161     3012        %EL$ENTRY (NAME=TH_RECORD_BUF,
      162     3013                   INFOSZ=4096,
      163     3014                   STCLASS="STATIC SYMDEF");
      164     3018    1   DCL RECORD_BUF (0:1028) REDEF TH_RECORD_BUF UBIN WORD;
      165     3019        %EL$IOERR (STCLASS="BASED(INFO$)");
      166     3029        %EL$FILERR (STCLASS="BASED(INFO$)");
      167     3036        %EL$FWLOAD (STCLASS="BASED(INFO$)");
      168     3039        %EL$MTDMT (STCLASS="BASED(INFO$)");
      169     3042        %EL$SYSCON (STCLASS="BASED(INFO$)");
      170     3046        %EL$MPCSTATS (STCLASS="BASED(INFO$)");
      171     3049        %EL$DEVSTATS (STCLASS="BASED(INFO$)");
      172     3052        %EL$FEPERR (STCLASS="BASED(INFO$)");
      173     3131        %EL$FEPFLT (STCLASS="BASED(INFO$)");
      174     3134        %EL$FECRASH (STCLASS="BASED(INFO$)");
      175     3139        %EL$FEPDUMP (STCLASS="BASED(INFO$)");
      176     3143        %EL$SCREECH (STCLASS="BASED(INFO$)");
      177     3149        %B$TCB;
      178     3152        %B$ALT;
      179     3160        %XSA_PARAM (FPTN=TH_XSA_PARAM,
      180     3161                    STCLASS=SYMREF);
      181     3191        /**/
      182     3192        %EJECT;
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:6    
      183     3193    2        DO CASE(FILE);
      184     3194    2           CASE(%ERRLOG);
      185     3195    2              PASSED_FLAG = %FALSE;
      186     3196    2              IF TH_CHANGE_FILE
      187     3197    3              THEN DO;
      188     3198    3                 FPT_PFIL.V.BOF# = '1'B;
      189     3199    3                 CALL M$PFIL(FPT_PFIL);
      190     3200    3                 CALL M$READ(READ_ERRLOG) ALTRET(BAG_IT);
      191     3201    3                 TH_CONSTRAINTS.START = TH_RECORD_BUF.UTS;
      192     3202    3                 FPT_PFIL.V.BOF# = '0'B;
      193     3203    3                 CALL M$PFIL(FPT_PFIL);
      194     3204    3                 CALL M$PRECORD(ERRLOG_PRECORD);
      195     3205    3                 CALL M$READ(READ_ERRLOG) ALTRET(BAG_IT);
      196     3206    3                 TH_CONSTRAINTS.STOP = TH_RECORD_BUF.UTS;
      197     3207    3                 RETURN;
      198     3208    3                 END;
      199     3209    2              IF TH_BOF
      200     3210    3              THEN DO;
      201     3211    3                 TH_BOF = %NO;
      202     3212    3                 CALL XSA$CLOSE(TH_CLOSE_ERRLOG,TH_XSA_PARAM) ALTRET(XSA_ERR);
      203     3213    3                 CALL XSA$OPEN(TH_OPEN_ERRLOG,TH_XSA_PARAM) ALTRET(XSA_ERR);
      204     3214    3                 END;                      /* IF TH_BOF                          */
      205     3215    3              DO WHILE(NOT(PASSED_FLAG));
      206     3216    3                 CALL XSA$READ(READ_ERRLOG,TH_XSA_PARAM) ALTRET(READ_ERR);
      207     3217    3              CALL INDEX(TH_ITYPE,BINASC(TH_RECORD_BUF.TYPE),CHAR_VEC);
      208     3218    3                 PASSED_FLAG = %TRUE;
      209     3219
      210     3220                                                /* CHECK FOR TIME                     */
      211     3221    3                 IF TH_RECORD_BUF.UTS < TH_CONSTRAINTS.START
      212     3222    3                 THEN GOTO NOT_PASSED;
      213     3223    3                 IF TH_RECORD_BUF.UTS > TH_CONSTRAINTS.STOP
      214     3224    3                 THEN GOTO ERRLOG_EOF;
      215     3225
      216     3226                                                /* CHECK FOR ERROR TYPE               */
      217     3227    3                 IF TH_CONSTRAINTS.NTYPES > 0
      218     3228    3                    THEN                   /* CHECK ERROR TYPES                  */
      219     3229    4                    DO;
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:7    
      220     3230    5                       DO I = 0 TO TH_CONSTRAINTS.NTYPES - 1;
      221     3231    5                          IF TH_RECORD_BUF.TYPEC = TH_CONSTRAINTS.TYPESC(I)
      222     3232    5                          THEN GOTO FOUND_NTYPES;
      223     3233    5                       END;                /* DO I                               */
      224     3234    4                    GOTO NOT_PASSED;
      225     3235    4                    END;                   /* IF                                 */
      226     3236    3   FOUND_NTYPES: ;
      227     3237    3                 IF TH_CHECK_DEVNM
      228     3238    4                 THEN DO;                  /* CHECK FOR DEVICE                   */
      229     3239    5                       DO CASE(TH_ITYPE);
      230     3240    5                          CASE(%TH_FI);
      231     3241    5                             TEMP$ = ADDR(EL$FILERR.DEVNM);
      232     3242    5                          CASE(%TH_FWLOAD);
      233     3243    5                             TEMP$ = ADDR(EL$FWLOAD.DEVNM);
      234     3244    5                          CASE(%TH_IOERR);
      235     3245    5                             TEMP$ = ADDR(EL$IOERR.DEVNM);
      236     3246    5                          CASE(%TH_MOUNT,%TH_DSMT);
      237     3247    5                             TEMP$ = ADDR(EL$MTDMT.DEVNAME);
      238     3248    5                          CASE(%TH_SYSCON);
      239     3249    5                             TEMP$ = ADDR(EL$SYSCON.DEVNM);
      240     3250    5                          CASE(%TH_MPCSTAT);
      241     3251    5                             TEMP$ = ADDR(EL$MPCSTATS.MPCNAME);
      242     3252    5                          CASE(%TH_DEVSTATS);
      243     3253    5                             TEMP$ = ADDR(EL$DEVSTATS.DEVNM);
      244     3254    5                          CASE(%TH_EDAC);
      245     3255    5                             TEMP$ = ADDR(MEM_TEXT);
      246     3256    5                          CASE(%TH_FEPFLT);
      247     3257    5                             CALL BINCHAR(TEMPNUM,EL$FEPFLT.FEP#);
      248     3258    5                             GOTO FEPNM;
      249     3259    5                          CASE(%TH_FEPERR);
      250     3260    5                             CALL BINCHAR(TEMPNUM,EL$FEPERR.STATDATA.NODE);
      251     3261    5                             GOTO FEPNM;
      252     3262    5                          CASE(%TH_FEPEVENT);
      253     3263    5                             CALL BINCHAR(TEMPNUM,EL$FECRASH.FENM.FEP#);
      254     3264    5              FEPNM:         I = 0;
      255     3265    6                             DO WHILE(SUBSTR(TEMPNUM,I,1) = '0' AND I < 4);
      256     3266    6                                I = I + 1;
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:8    
      257     3267    6                                END;  /* DO WHILE */
      258     3268    5                             CALL INSERT(FEPNAME.FEP#,,,SUBSTR(TEMPNUM,I));
      259     3269    5                             TEMP$ = ADDR(FEPNAME);
      260     3270    5                          CASE(%TH_FEPDUMP);
      261     3271    5                             CALL BINCHAR(TEMPNUM,EL$FEPDUMP.FEP);
      262     3272    5                       GOTO FEPNM;
      263     3273    5                     CASE(%TH_SCREECH);
      264     3274    5                            IF SUBSTR(TH_CONSTRAINTS.DEVNM,0,3) = 'FEP'
      265     3275    5                                 AND
      266     3276    5                                 EL$SCREECH.SCODE.ERR.SEV = 3
      267     3277    5                            THEN
      268     3278    6                            DO;
      269     3279    6                                 CALL BINCHAR(TEMPNUM,EL$SCREECH.SNAPU#);
      270     3280    6                                 GOTO FEPNM;
      271     3281    6                                 END;
      272     3282    5                       GOTO NOT_PASSED;
      273     3283    5                          CASE(ELSE);
      274     3284    5                             GOTO NOT_PASSED;
      275     3285    5                       END;                /* DO CASE TH_ITYPE                   */
      276     3286    4                       IF TH_CONSTRAINTS.DEVNM ~= TEMP$->CHAR_BASE
      277     3287    4                       THEN GOTO NOT_PASSED;
      278     3288    4                    END;                   /* IF                                 */
      279     3289
      280     3290                                               /* CHECK FOR MATCH AND EXCLUDE         */
      281     3291    3                 IF TH_ITYPE = %TH_FI AND TH_FIERR_M_SET
      282     3292    4                    THEN DO;
      283     3293    4                      IF (TH_CONSTRAINTS.M_COD_SET
      284     3294    4                         AND TH_CONSTRAINTS.M_COD ~= EL$FILERR.CODE)
      285     3295    4                      OR (TH_CONSTRAINTS.M_REA_SET
      286     3296    4                         AND TH_CONSTRAINTS.M_REA ~= EL$FILERR.REASON)
      287     3297    4                      OR (TH_CONSTRAINTS.M_ACT_SET
      288     3298    4                         AND TH_CONSTRAINTS.M_ACT ~= EL$FILERR.ACTION)
      289     3299    4                      THEN GOTO NOT_PASSED;
      290     3300    4                    END;
      291     3301    3                 IF TH_ITYPE = %TH_FI AND TH_FIERR_E_SET
      292     3302    4                    THEN DO;
      293     3303    4                      IF (TH_CONSTRAINTS.E_COD_SET
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:9    
      294     3304    4                         AND TH_CONSTRAINTS.E_COD ~= EL$FILERR.CODE)
      295     3305    4                      OR (TH_CONSTRAINTS.E_REA_SET
      296     3306    4                         AND TH_CONSTRAINTS.E_REA ~= EL$FILERR.REASON)
      297     3307    4                      OR (TH_CONSTRAINTS.E_ACT_SET
      298     3308    4                         AND TH_CONSTRAINTS.E_ACT ~= EL$FILERR.ACTION)
      299     3309    4                      THEN GOTO NOT_EXCLUDED;
      300     3310    4                      ELSE GOTO NOT_PASSED;
      301     3311    4                    END;
      302     3312    3                 IF TH_ITYPE = %TH_IOERR AND TH_IOERR_M_OR_E_SET
      303     3313    4                 THEN DO;                 /* CHECK MATCH AND EXCLUDE             */
      304     3314    4                    IF TH_IOERR_M_SET
      305     3315    5                    THEN DO;                    /* CHECK MATCH                   */
      306     3316    5                       IF (TH_CONSTRAINTS.M_MAJ_S
      307     3317    5                           AND TH_CONSTRAINTS.M_MAJ ~= EL$IOERR.XSTATUS.MAJOR)
      308     3318    5                         OR (TH_CONSTRAINTS.M_SUB_S
      309     3319    5                           AND TH_CONSTRAINTS.M_SUB ~= EL$IOERR.XSTATUS.MINOR)
      310     3320    5                         OR (TH_CONSTRAINTS.M_MED_S
      311     3321    5                           AND TH_CONSTRAINTS.M_MED ~= EL$IOERR.SN)
      312     3322    5                       THEN GOTO NOT_PASSED;
      313     3323    5                       IF TH_IOERR_M_BY_B_SET
      314     3324    6                       THEN DO;
      315     3325    6                          IO_MASK = EL$IOERR.EXTST;
      316     3326    7                          DO I = 0 TO 207;
      317     3327    7                             IF TH_CONSTRAINTS.M_BY_B_SET(I)
      318     3328    7                               AND IO_MASK1(I) ~= TH_CONSTRAINTS.M_BY_B_VEC(I)
      319     3329    7                             THEN GOTO NOT_PASSED;
      320     3330    7                             END;                     /* DO I = 0 TO 207         */
      321     3331    6                          END;                  /* IF TH_IOERR_M_BY_B_SET        */
      322     3332    5                       END;                    /* CHECK MATCH                    */
      323     3333    4                    IF TH_IOERR_E_SET
      324     3334    5                    THEN DO;                 /* CHECK EXCLUDE                    */
      325     3335    5                       IF (TH_CONSTRAINTS.E_MAJ_S
      326     3336    5                           AND TH_CONSTRAINTS.E_MAJ ~= EL$IOERR.XSTATUS.MAJOR)
      327     3337    5                         OR (TH_CONSTRAINTS.E_SUB_S
      328     3338    5                           AND TH_CONSTRAINTS.E_SUB ~= EL$IOERR.XSTATUS.MINOR)
      329     3339    5                         OR (TH_CONSTRAINTS.E_MED_S
      330     3340    5                           AND TH_CONSTRAINTS.E_MED ~= EL$IOERR.SN)
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:10   
      331     3341    5                       THEN GOTO NOT_EXCLUDED;
      332     3342    5                       IF TH_IOERR_E_BY_B_SET
      333     3343    6                       THEN DO;
      334     3344    6                          IO_MASK = EL$IOERR.EXTST;
      335     3345    7                          DO I = 0 TO 207;
      336     3346    7                             IF TH_CONSTRAINTS.E_BY_B_SET(I)
      337     3347    7                               AND IO_MASK1(I) ~= TH_CONSTRAINTS.E_BY_B_VEC(I)
      338     3348    7                             THEN GOTO NOT_EXCLUDED;
      339     3349    7                             END;                     /* DO I = 0 TO 207         */
      340     3350    6                          END;                  /* IF TH_IOERR_E_BY_B_SET        */
      341     3351    5                       GOTO NOT_PASSED;
      342     3352    5                    END;                        /* OF CHECK EXCLUDE              */
      343     3353    4                 END;                      /* OF CHECK MATCH AND EXCLUDE         */
      344     3354    3   NOT_EXCLUDED: ;
      345     3355    3            IF (TH_ITYPE = %TH_FEPERR)
      346     3356    3              AND TH_FEPERR_M_OR_E_SET
      347     3357    4              THEN DO;
      348     3358    4           FEPERR_CODE_F_M.FCG = BITBIN( EL$FEPERR.STATDATA.ERRCODE.FCG );
      349     3359    4           FEPERR_CODE_F_M.MID = BITBIN( EL$FEPERR.STATDATA.ERRCODE.MID );
      350     3360    4                 IF (TH_CONSTRAINTS.M_FEP_SET)
      351     3361    4                   THEN
      352     3362    4                      IF TH_CONSTRAINTS.M_FEP_N > 0 AND
      353     3363    4                         TH_CONSTRAINTS.M_FEP_N < 4
      354     3364    5                         THEN DO;
      355     3365    5                           FEPERR_CODE = ' ';
      356     3366    6                           DO I = 0 TO TH_CONSTRAINTS.M_FEP_N - 1;
      357     3367    6                                FEP_FCG_W = BITBIN(FEPERR_FCG(I));
      358     3368    6                                FEP_FCG = FEP_FCG_W;
      359     3369    6                                CALL INSERT(FEPERR_CODE,I,1,BINASC(FEP_FCG+64));
      360     3370    6                           END;
      361     3371    5                           I = 0;
      362     3372    5                           J = 0;
      363     3373    6                           DO WHILE(I < TH_LAST_MATCH.COUNT - 1);
      364     3374    6                             CALL INDEX(I,'=',SUBSTR(TH_LAST_MATCH.TEXT,I));
      365     3375    6                             I = I + J + 1;
      366     3376    7                               DO WHILE(SUBSTR(TH_LAST_MATCH.TEXT,I,1) = ' ');
      367     3377    7                                 I = I + 1;
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:11   
      368     3378    7                               END; /* do while */
      369     3379    6                             TH_CONSTRAINTS.M_FEP = SUBSTR(TH_LAST_MATCH.TEXT,I,3);
      370     3380    6                             IF(FEPERR_CODE = TH_CONSTRAINTS.M_FEP)
      371     3381    6                             THEN GOTO FOUND_FEP;
      372     3382
      373     3383    6                             I = I + 3;
      374     3384    6                             J = I;
      375     3385    6                           END;  /* do while */
      376     3386    5                           GOTO NOT_PASSED;
      377     3387    5   FOUND_FEP: ;
      378     3388    5                         END;
      379     3389    4                 IF (TH_CONSTRAINTS.E_FEP_SET)
      380     3390    4                   THEN
      381     3391    4                      IF TH_CONSTRAINTS.E_FEP_N > 0 AND
      382     3392    4                         TH_CONSTRAINTS.E_FEP_N < 4
      383     3393    5                         THEN DO;
      384     3394    5                           FEPERR_CODE = ' ';
      385     3395    6                           DO I = 0 TO TH_CONSTRAINTS.E_FEP_N - 1;
      386     3396    6                                FEP_FCG_W = BITBIN(FEPERR_FCG(I));
      387     3397    6                                FEP_FCG = FEP_FCG_W;
      388     3398    6                                CALL INSERT(FEPERR_CODE,I,1,BINASC(FEP_FCG+64));
      389     3399    6                           END;
      390     3400    5                           IF (FEPERR_CODE=TH_CONSTRAINTS.E_FEP)
      391     3401    5                              THEN GOTO NOT_PASSED;
      392     3402    5                         END;
      393     3403    4            FOUND='0'B;
      394     3404    4   TERMINAL_CHAN.A = EL$FEPERR.STATDATA.TERMID.TERM.CHANNEL.BYT(0);
      395     3405    4   TERMINAL_CHAN.B = EL$FEPERR.STATDATA.TERMID.TERM.CHANNEL.BYT(1);
      396     3406    4                 IF TH_CONSTRAINTS.M_CHAN_SET
      397     3407    5                   THEN DO;
      398     3408    6          DO J=0 TO TH_M_CHAN_TOTAL-1;
      399     3409    6                      HEXNUM = 0;
      400     3410    7                      DO I = 0 TO 3;
      401     3411    7            CHAN_CHAR=SUBSTR(TH_M_CHAN.TEXT(J),I,1);
      402     3412    7                        CALL CHARBIN(CHAN_NUM,CHAN_CHAR);
      403     3413    7                        IF CHAN_CHAR = 'A' OR CHAN_CHAR = 'B' OR
      404     3414    7                           CHAN_CHAR = 'C' OR CHAN_CHAR = 'D' OR
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:12   
      405     3415    7                           CHAN_CHAR = 'E'  OR CHAN_CHAR = 'F'
      406     3416    7                             THEN CHAN_NUM = CHAN_NUM + 9;
      407     3417    7                        HEXNUM = HEXNUM * 16 + CHAN_NUM;
      408     3418    7                      END;
      409     3419    6            IF HEXNUM = BITBIN( TERMINAL_CHAN ) AND TH_M_CHAN.FLAG(J)
      410     3420    6                THEN FOUND = '1'B;
      411     3421    6         END; /* DO J = 0 TO  */
      412     3422    5         IF FOUND
      413     3423    5            THEN
      414     3424    5                FOUND='0'B;
      415     3425    5            ELSE GOTO NOT_PASSED;
      416     3426    5                   END;
      417     3427    4                 IF TH_CONSTRAINTS.E_CHAN_SET
      418     3428    5                   THEN DO;
      419     3429    5                      HEXNUM = 0;
      420     3430    6                      DO I = 0 TO 3;
      421     3431    6                        CHAN_CHAR = SUBSTR(TH_CONSTRAINTS.E_CHAN,I,1);
      422     3432    6                        CALL CHARBIN(CHAN_NUM,CHAN_CHAR);
      423     3433    6                        IF CHAN_CHAR = 'A' OR CHAN_CHAR = 'B' OR
      424     3434    6                           CHAN_CHAR = 'C' OR CHAN_CHAR = 'D' OR
      425     3435    6                           CHAN_CHAR = 'E'  OR CHAN_CHAR = 'F'
      426     3436    6                             THEN CHAN_NUM = CHAN_NUM + 9;
      427     3437    6                        HEXNUM = HEXNUM * 16 + CHAN_NUM;
      428     3438    6                      END;
      429     3439    5                      IF HEXNUM = BITBIN( TERMINAL_CHAN )
      430     3440    5                           THEN GOTO NOT_PASSED;
      431     3441    5                   END;
      432     3442    4              END;
      433     3443    4           DO NEVER;
      434     3444    4   NOT_PASSED: ;
      435     3445    4              PASSED_FLAG = %FALSE;
      436     3446    4              END;
      437     3447    3              END;                         /* DO WHILE                           */
      438     3448    2              TH_RECORD.BOUND = TH_XSA_PARAM.ARS# - 1;
      439     3449    2              TH_INFO.BOUND = TH_XSA_PARAM.ARS# - 21;
      440     3450    2              TH_LASTUTS = TH_RECORD_BUF.UTS;
      441     3451    2              RETURN;
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:13   
      442     3452    2   XSA_ERR:   CALL XUR$ERRMSG(TH_XSA_PARAM.ERR);
      443     3453    2              RETURN;
      444     3454    2   READ_ERR:  TH_LAST_REQID = 0;
      445     3455    2              IF TH_XSA_PARAM.ERR.CODE ~= %E$EOF
      446     3456    3              THEN DO;
      447     3457    3                 CALL XUR$ERRMSG(TH_XSA_PARAM.ERR);
      448     3458    3                 RETURN;
      449     3459    3                 END;
      450     3460    2   ERRLOG_EOF: ;
      451     3461    2              ALTRETURN;
      452     3462    2           CASE(%CONFIG);
      453     3463    2            M$CONFIG$ = DCBADDR(DCBNUM(M$CFG));
      454     3464    2              TH_RECORD = VECTOR(RECORD_BUF);
      455     3465    2              IF KEY_NAME = '0'
      456     3466    2                 THEN                      /* HEAD RECORD                        */
      457     3467    3                 DO;
      458     3468    3                    READ_CONFIG.KEY_ = VECTOR(HEAD_KEY);
      459     3469    3                 END;
      460     3470    2                 ELSE                      /* BUILD KEY                          */
      461     3471    3                 DO;
      462     3472    3                    IF SUBSTR(KEY_NAME,0,3) = 'IOM'
      463     3473    3                       THEN                /* IOM RECORD                         */
      464     3474    4                       DO;
      465     3475    4                          CONFIG_KEY.C = 4;
      466     3476    4                       END;
      467     3477    3                       ELSE
      468     3478    3                    IF (SUBSTR(KEY_NAME,0,2) = 'UC') OR
      469     3479    3                       (SUBSTR(KEY_NAME,0,2) = 'TC') OR
      470     3480    3                       (SUBSTR(KEY_NAME,0,2) = 'DC')
      471     3481    3                       THEN                /* MPC RECORD                         */
      472     3482    4                       DO;
      473     3483    4                          CONFIG_KEY.C = 8;
      474     3484    4                       END;
      475     3485    3                       ELSE                /* DEVICE RECORD                      */
      476     3486    4                       DO;
      477     3487    4                          CONFIG_KEY.C = 8;
      478     3488    4                       END;
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:14   
      479     3489    3                    CONFIG_KEY.TXT = KEY_NAME;
      480     3490    3                    READ_CONFIG.KEY_ = VECTOR(CONFIG_KEY);
      481     3491    3                 END;                      /* IF KEY_NAME = '0'                  */
      482     3492    2          IF NOT M$CONFIG$->F$DCB.FCD THEN
      483     3493    2              CALL M$OPEN(OPEN_CONFIG) ALTRET(BAG_IT);
      484     3494    2              CALL M$READ(READ_CONFIG) ALTRET(BAG_IT);
      485     3495    2              TH_RECORD.BOUND = M$CONFIG$->F$DCB.ARS - 1;
      486     3496    2              CALL M$CLOSE(CLOSE_CONFIG);
      487     3497    2           CASE(%DEVHIST);
      488     3498    2              M$DEVHIST$ = DCBADDR(DCBNUM(M$DEVHIST));
      489     3499    2              TH_RECORD = VECTOR(RECORD_BUF);
      490     3500    2              IF NOT M$DEVHIST$->F$DCB.FCD
      491     3501    2              THEN CALL M$OPEN(OPEN_DEVHIST) ALTRET(BAG_IT);
      492     3502    2              IF ADDR(UTS) = ADDR(NIL)
      493     3503    2                 THEN                      /* NON-UTS RECORD TO READ             */
      494     3504    3                 DO;
      495     3505    3                    IF KEY_NAME = '0'      /* HEAD RECORD                        */
      496     3506    3                       THEN READ_DEVHIST.KEY_ = VECTOR(HEAD_KEY);
      497     3507    3                       ELSE
      498     3508    3                    IF KEY_NAME = '1'      /* THRESH RECORD                      */
      499     3509    3                       THEN READ_DEVHIST.KEY_ = VECTOR(THRESH_KEY);
      500     3510    3                       ELSE
      501     3511    3                    IF KEY_NAME = '2'      /* MAINT RECORD                       */
      502     3512    3                       THEN READ_DEVHIST.KEY_ = VECTOR(MAINT_KEY);
      503     3513    3                       ELSE
      504     3514    3                    IF KEY_NAME = '3'      /* UTS RECORD                         */
      505     3515    3                       THEN READ_DEVHIST.KEY_ = VECTOR(UTS_KEY);
      506     3516    3                       ELSE READ_DEVHIST.KEY_ = VECTOR(NIL);
      507     3517    3                    CALL M$READ(READ_DEVHIST) ALTRET(L1);
      508     3518    4                    DO NEVER;
      509     3519    4              L1:      IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY
      510     3520    4                          THEN GOTO BAG_IT;
      511     3521    4                          ELSE CALL THM$ERRMSG;
      512     3522    4                    END;                   /* DO NEVER                           */
      513     3523    3                 END;                      /* IF ADDR(UTS) = ADDR(NIL)           */
      514     3524    2                 ELSE                      /* UTS IS PRESENT                     */
      515     3525    3                 DO;
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:15   
      516     3526    3                    IF UTS = BITBIN('777777777777'O)
      517     3527    3                       THEN                /* DONT CARE ABOUT UTS                */
      518     3528    4                       DO;
      519     3529    4                          DEVHIST_KEY8.C = 12;
      520     3530    4                          DEVHIST_KEY8.TXT = KEY_NAME;
      521     3531    4                          DEVHIST_KEY8.UTS = 0;
      522     3532    4                          PRECORD.KEY_ = VECTOR(DEVHIST_KEY8);
      523     3533    4                          CALL M$PRECORD(PRECORD) ALTRET(NO_KEY);
      524     3534    4                    NO_KEY:  IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY
      525     3535    4                                THEN
      526     3536    5                                DO;
      527     3537    5                                   RET_KEY = DEVHIST_KEY8.TXT;
      528     3538    5                                   IF RET_KEY = KEY_NAME AND DEVHIST_KEY8.C ~= 0
      529     3539    5                                      THEN
      530     3540    6                                      DO;
      531     3541    6                                         READ_DEVHIST.V.KEYS# = %NO;
      532     3542    6                                         CALL M$READ(READ_DEVHIST);
      533     3543    6                                      END;
      534     3544    5                                      ELSE GOTO BAG_IT;
      535     3545    5                                END;       /* IF ERRCODE = NOKEY                 */
      536     3546    4                       END;                /* IF UTS = -1                        */
      537     3547    3                       ELSE                /* BUILD KEY WITH UTS                 */
      538     3548    4                       DO;
      539     3549    4                          DEVHIST_KEY8.TXT = KEY_NAME;
      540     3550    4                          DEVHIST_KEY8.UTS = UTS;
      541     3551    4                          READ_DEVHIST.KEY_ = VECTOR(DEVHIST_KEY8);
      542     3552    4                          CALL M$READ(READ_DEVHIST) ALTRET(L3);
      543     3553    5                          DO NEVER;
      544     3554    5                 L3:
      545     3555    5                             IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY
      546     3556    5                                THEN GOTO BAG_IT;
      547     3557    5                                ELSE CALL THM$ERRMSG;
      548     3558    5                          END;             /* DO NEVER                           */
      549     3559    4                       END;
      550     3560    3                 END;
      551     3561    2              TH_RECORD.BOUND = M$DEVHIST$->F$DCB.ARS - 1;
      552     3562    2              READ_DEVHIST.V.KEYS# = %YES;
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:16   
      553     3563    2           CASE(%MEDHIST);
      554     3564                                                /* UNIMPLIMENTED AS YET               */
      555     3565    2           CASE(%OCHIST);
      556     3566                                                /* UNIMPLIMENTED AS YET               */
      557     3567    2        END;                               /* DO CASE                            */
      558     3568    1        RETURN;
      559     3569    1   BAG_IT:
      560     3570    2        DO CASE(FILE);
      561     3571    2           CASE(%ERRLOG);
      562     3572    2              /* DO NOTHING */;
      563     3573    2           CASE(%CONFIG);
      564     3574    2              IF M$CONFIG$->F$DCB.FCD
      565     3575    2                 THEN CALL M$CLOSE(CLOSE_CONFIG);
      566     3576    2           CASE(%DEVHIST);
      567     3577    2           CASE(%MEDHIST);
      568     3578    2              /* DO NOTHING */;
      569     3579    2           CASE(%OCHIST);
      570     3580    2              /* DO NOTHING */;
      571     3581    2        END;                               /* DO CASE FILE                       */
      572     3582    1        ALTRETURN;
      573     3583    1   THG$CLOSE: ENTRY ALTRET;
      574     3584    1        CALL M$CLOSE(CLOSE_DEVHIST);
      575     3585    1        RETURN;
      576     3586    1   END THG$GETREC;
      577     3587        %EOD;

PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:17   
--  Include file information  --

   EL_SUBS_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   EL$TABLES.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THG$GETREC.

   Procedure THG$GETREC requires 981 words for executable code.
   Procedure THG$GETREC requires 38 words of local(AUTO) storage.

PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:18   

 Object Unit name= THG$GETREC                                 File name= THG$GETREC.:E05TOU
 UTS= JUL 30 '97 06:13:13.44 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$ERRLOG
    2   DCB   even  none     0      0  M$DEVHIST
    3   DCB   even  none     0      0  M$CFG
    4  RoData even  UTS    223    337  THG$GETREC
    5   Data  even  none  1093   2105  THG$GETREC
    6   Proc  even  none   981   1725  THG$GETREC
    7  RoData even  none    38     46  THG$GETREC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes    yes     yes      Std        4  THG$GETREC
     6   1717          yes     yes      Std        0  THG$CLOSE

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    5    100  TH_RECORD_BUF
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:19   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 XSA$READ
         yes           Std       1 THM$ERRMSG
 yes     yes           Std       2 XSA$CLOSE
 yes     yes           Std       2 XSA$OPEN
 yes     yes           Std       7 XUR$ERRMSG
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_4
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TH_CONSTRAINTS                        TH_BOF
     TH_RECORD                             TH_INFO                               TH_ITYPE
     TH_LASTUTS                            TH_LAST_MATCH                         TH_LAST_REQID
     TH_XSA_BUF_VECTOR                     TH_IOERR_M_BY_B_SET                   TH_IOERR_E_BY_B_SET
     TH_IOERR_M_SET                        TH_IOERR_E_SET                        TH_IOERR_M_OR_E_SET
     TH_FEPERR_M_OR_E_SET                  TH_FIERR_M_SET                        TH_FIERR_E_SET
     TH_CHECK_DEVNM                        DEVHIST_ACCT                          TH_CHANGE_FILE
     TH_M_CHAN                             TH_M_CHAN_TOTAL                       M$ERRLOG
     M$DEVHIST                             M$CFG                                 B$TCB$
     TH_OPEN_ERRLOG                        TH_CLOSE_ERRLOG                       TH_XSA_PARAM
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:20   


        1        1        /*M* THG$GETREC - ROUTINE TO ACCESS FILES FOR ELAN */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        THG$GETREC: PROC(FILE,KEY_NAME,UTS,DONT_CLOSE) ALTRET;

      7  6 000000   000000 700200 xent  THG$GETREC   TSX0  ! X66_AUTO_4
         6 000001   000046 000004                    ZERO    38,4

        8        8        /**/
        9        9        /* PARAMS */
       10       10    1   DCL FILE UBIN;
       11       11    1   DCL KEY_NAME CHAR(8);
       12       12    1   DCL UTS UBIN WORD;
       13       13    1   DCL DONT_CLOSE SBIN;
       14       14        /**/
       15       15        /**/
       16       16        /* INCLUDE FILES */
       17       17        %INCLUDE EL$TABLES;
       18      340        %INCLUDE CP_6;
       19      421        %INCLUDE F$DCB;
       20      470        %INCLUDE B_ERRORS_C;
       21     1597        %INCLUDE TH_SUBS_C;
       22     1979        %INCLUDE TH_DATA_R;
       23     2057        %INCLUDE XS_MACRO_C;
       24     2101        %INCLUDE EL_SUBS_C;
       25     2185        /**/
       26     2186        /* ENTRY DEFS */
       27     2187    1   DCL THM$ERRMSG ENTRY(1);
       28     2188    1   DCL XSA$PFIL ENTRY(2) ALTRET;
       29     2189    1   DCL XSA$READ ENTRY(2) ALTRET;
       30     2190    1   DCL XSA$OPEN ENTRY(2) ALTRET;
       31     2191    1   DCL XSA$CLOSE ENTRY(2) ALTRET;
       32     2192    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:21   
       33     2193        /**/
       34     2194        /* DCBS */
       35     2195    1   DCL M$ERRLOG DCB;
       36     2196    1   DCL M$DEVHIST DCB;
       37     2197    1   DCL M$CFG DCB;
       38     2198        /**/
       39     2199        /* VARS */
       40     2200    1   DCL B$TCB$ PTR SYMREF;
       41     2201    1   DCL IO_MASK(0:35) UBIN(8) UNAL;
       42     2202    1   DCL IO_MASK1(0:287) REDEF IO_MASK BIT(1);
       43     2203    1   DCL I SBIN;
       44     2204    1   DCL MEM_TEXT CHAR(8) CONSTANT INIT('MEM     ');
       45     2205    1   DCL PASSED_FLAG BIT(1);
       46     2206    1   DCL EXC_FLAG BIT(1);
       47     2207    1   DCL 1 FEPERR_CODE_F_M,
       48     2208    1         2 FCG UBIN(12) UNAL,
       49     2209    1         2 MID UBIN(6) UNAL;
       50     2210    1   DCL FEPERR_FCG(0:2) REDEF FEPERR_CODE_F_M BIT(6);
       51     2211    1   DCL FEPERR_CODE CHAR(3);
       52     2212    1   DCL FEP_FCG_W UBIN WORD;
       53     2213    1   DCL FEP_FCG UBIN(6) UNAL;
       54     2214    1   DCL INFO$ PTR CONSTANT INIT(ADDR(TH_RECORD_BUF.INFO));
       55     2215    1   DCL M$CONFIG$ PTR;
       56     2216    1   DCL M$DEVHIST$ PTR;
       57     2217    1   DCL CHAR_BASE CHAR(8) BASED;
       58     2218    1   DCL TEMP$ PTR;
       59     2219    1   DCL TYPE_VEC(0:%NTYPES) UBIN BYTE UNAL CONSTANT INIT(511,%EL_CMPSTRT,%EL_MOUNT,
       60     2220    1                                             %EL_DSMT,%EL_TIMESTAMP,%EL_OPER,
       61     2221    1                                             %EL_REX,%EL_FWLOAD,%EL_DIAG,
       62     2222    1                                             %EL_SYSCON,%EL_SYSID,%EL_MPCSTAT,
       63     2223    1                                            %EL_ANLZ,%EL_ZAP,%EL_DEVSTAT,%EL_CHANTRAN,
       64     2224    1                                             %EL_MSOSSAYS,%EL_CP6SAYS,%EL_IOERR,%
              2224                                                      EL_EDAC,
       65     2225    1                                             %EL_FEPERR,%EL_PROCERR,%EL_SPURINT,%
              2225                                                      EL_FEPFLT,
       66     2226    1                                             %EL_SCREECH,%EL_FI,%EL_OSFI,%EL_FEPCRASH,
       67     2227    1                                             %EL_GABRT,%EL_SUA,%EL_SNAP,%EL_CGERR,
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:22   
       68     2228    1                                             %EL_FEPDUMP,%EL_LOST,%EL_CHNGAARD,
       69     2229    1                                             %EL_DEVSTAT,%EL_DEVSTAT,%EL_MIRROR);
       70     2230    1   DCL CHAR_VEC REDEF TYPE_VEC CHAR(%(NTYPES+1));
       71     2231        /**/
       72     2232    1   DCL 1 CONFIG_KEY STATIC,
       73     2233    1         2 C UBIN BYTE UNAL,
       74     2234    1         2 TXT CHAR(8);
       75     2235    1   DCL 1 DEVHIST_KEY8 STATIC ALIGNED,
       76     2236    1         2 C UBIN BYTE UNAL INIT(12),
       77     2237    1         2 TXT CHAR(8) UNAL,
       78     2238    1         2 UTS UBIN WORD UNAL;
       79     2239    1   DCL HEAD_KEY BIT(18) CONSTANT INIT('001000'O);
       80     2240    1   DCL THRESH_KEY BIT(18) CONSTANT INIT('001001'O);
       81     2241    1   DCL MAINT_KEY BIT(18) CONSTANT INIT('001002'O);
       82     2242    1   DCL UTS_KEY BIT(18) CONSTANT INIT('001003'O);
       83     2243    1   DCL RET_KEY CHAR(8) STATIC INIT(' ');
       84     2244    1   DCL 1 FEPNAME STATIC ALIGNED,
       85     2245    1         2 * CHAR(3) UNAL INIT('FEP'),
       86     2246    1         2 FEP# CHAR(5) UNAL INIT(' ');
       87     2247    1   DCL TEMPNUM CHAR(5);
       88     2248    1   DCL HEXNUM UBIN(16) UNAL;
       89     2249    1   DCL 1 TERMINAL_CHAN ,
       90     2250    1         2 A UBIN(8) UNAL,
       91     2251    1         2 B UBIN(8) UNAL;
       92     2252    1   DCL CHAN_CHAR CHAR(1);
       93     2253    1   DCL CHAN_NUM UBIN ;
       94     2254    1   DCL J SBIN;
       95     2255    1   DCL FOUND BIT(1);
       96     2256        /**/
       97     2257        /* FPT DEFINITIONS */
       98     2258        %FPT_OPEN (FPTN=OPEN_DEVHIST,
       99     2259                   STCLASS=CONSTANT,
      100     2260                   DCB=M$DEVHIST,
      101     2261                   NAME=DEVHIST,
      102     2262                   ACCT=DEVHIST_ACCT,
      103     2263                   FUN=IN,
      104     2264                   ASN=FILE,
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:23   
      105     2265                   ORG=KEYED);
      106     2374        %FPT_READ (FPTN=READ_DEVHIST,
      107     2375                   DCB=M$DEVHIST,
      108     2376                   BUF=RECORD_BUF,
      109     2377                   STCLASS=STATIC,
      110     2378                   KEYS=YES);
      111     2417        %FPT_CLOSE (FPTN=CLOSE_DEVHIST,
      112     2418                    STCLASS=CONSTANT,
      113     2419                    DCB=M$DEVHIST);
      114     2461        %FPT_OPEN (FPTN=OPEN_CONFIG,
      115     2462                   STCLASS=CONSTANT,
      116     2463                     DCB = M$CFG,
      117     2464                   NAME=CONFIG,
      118     2465                   ACCT=SYSACCT,
      119     2466                   FUN=IN,
      120     2467                   ASN=FILE,
      121     2468                   SHARE=ALL,
      122     2469                   ORG=KEYED);
      123     2578        %FPT_OPEN (FPTN=TH_OPEN_ERRLOG,
      124     2579                   STCLASS=SYMREF);
      125     2688        %FPT_CLOSE (FPTN=TH_CLOSE_ERRLOG,
      126     2689                    STCLASS=SYMREF);
      127     2731        %FPT_READ (FPTN=READ_CONFIG,
      128     2732                     DCB = M$CFG,
      129     2733                   BUF=RECORD_BUF,
      130     2734                   STCLASS=STATIC,
      131     2735                   KEYS=YES);
      132     2774        %FPT_CLOSE (FPTN=CLOSE_CONFIG,
      133     2775                    STCLASS=CONSTANT,
      134     2776                     DCB = M$CFG);
      135     2818        %VLP_NAME (FPTN=DEVHIST,
      136     2819                   STCLASS=CONSTANT,
      137     2820                   NAME=':DEVHIST');
      138     2847        %VLP_NAME (FPTN=CONFIG,
      139     2848                   STCLASS=CONSTANT,
      140     2849                   NAME=':CONFIG');
      141     2876        %VLP_ACCT (FPTN=SYSTAC,
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:24   
      142     2877                   STCLASS=CONSTANT,
      143     2878                   ACCT=':SYSTAC');
      144     2891        %VLP_ACCT (FPTN=SYSACCT,
      145     2892                   STCLASS=CONSTANT,
      146     2893                   ACCT=':SYS');
      147     2906        %FPT_READ (FPTN=READ_ERRLOG,
      148     2907                   STCLASS=CONSTANT,
      149     2908                   DCB=M$ERRLOG,
      150     2909                   BUF=TH_RECORD_BUF);
      151     2948        %FPT_PFIL (DCB=M$ERRLOG,
      152     2949                   STCLASS=STATIC,
      153     2950                   BOF=YES);
      154     2965        %FPT_PRECORD (FPTN=PRECORD,
      155     2966                      DCB=M$DEVHIST,
      156     2967                      KEYR=YES,
      157     2968                      KEYS=YES);
      158     2989        %FPT_PRECORD(FPTN=ERRLOG_PRECORD, DCB=M$ERRLOG, KEYS=NO, N=-1);
      159     3010        /**/
      160     3011        /* MACROS */
      161     3012        %EL$ENTRY (NAME=TH_RECORD_BUF,
      162     3013                   INFOSZ=4096,
      163     3014                   STCLASS="STATIC SYMDEF");
      164     3018    1   DCL RECORD_BUF (0:1028) REDEF TH_RECORD_BUF UBIN WORD;
      165     3019        %EL$IOERR (STCLASS="BASED(INFO$)");
      166     3029        %EL$FILERR (STCLASS="BASED(INFO$)");
      167     3036        %EL$FWLOAD (STCLASS="BASED(INFO$)");
      168     3039        %EL$MTDMT (STCLASS="BASED(INFO$)");
      169     3042        %EL$SYSCON (STCLASS="BASED(INFO$)");
      170     3046        %EL$MPCSTATS (STCLASS="BASED(INFO$)");
      171     3049        %EL$DEVSTATS (STCLASS="BASED(INFO$)");
      172     3052        %EL$FEPERR (STCLASS="BASED(INFO$)");
      173     3131        %EL$FEPFLT (STCLASS="BASED(INFO$)");
      174     3134        %EL$FECRASH (STCLASS="BASED(INFO$)");
      175     3139        %EL$FEPDUMP (STCLASS="BASED(INFO$)");
      176     3143        %EL$SCREECH (STCLASS="BASED(INFO$)");
      177     3149        %B$TCB;
      178     3152        %B$ALT;
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:25   
      179     3160        %XSA_PARAM (FPTN=TH_XSA_PARAM,
      180     3161                    STCLASS=SYMREF);
      181     3191        /**/
      182     3192        %EJECT;
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:26   
      183     3193    2        DO CASE(FILE);

   3193  6 000002   200003 470500                    LDP0    @FILE,,AUTO
         6 000003   000000 235100                    LDA     0,,PR0
         6 000004   000005 115007                    CMPA    5,DL
         6 000005   000007 602005 6                  TNC     s:3193+5,AL
         6 000006   001675 710000 6                  TRA     s:3568
         6 000007   001675 710000 6                  TRA     s:3568
         6 000010   001675 710000 6                  TRA     s:3568
         6 000011   001357 710000 6                  TRA     s:3463
         6 000012   000014 710000 6                  TRA     s:3195
         6 000013   001462 710000 6                  TRA     s:3498

      184     3194    2           CASE(%ERRLOG);

      185     3195    2              PASSED_FLAG = %FALSE;

   3195  6 000014   200020 450100                    STZ     PASSED_FLAG,,AUTO

      186     3196    2              IF TH_CHANGE_FILE

   3196  6 000015   000000 234000 xsym               SZN     TH_CHANGE_FILE
         6 000016   000055 605000 6                  TPL     s:3209

      187     3197    3              THEN DO;

      188     3198    3                 FPT_PFIL.V.BOF# = '1'B;

   3198  6 000017   400000 236007                    LDQ     -131072,DL
         6 000020   000052 256000 5                  ORSQ    FPT_PFIL+2

      189     3199    3                 CALL M$PFIL(FPT_PFIL);

   3199  6 000021   000050 630400 5                  EPPR0   FPT_PFIL
         6 000022   040004 713400                    CLIMB   16388
         6 000023   400000 401760                    pmme    nvectors=1

PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:27   
      190     3200    3                 CALL M$READ(READ_ERRLOG) ALTRET(BAG_IT);

   3200  6 000024   000314 630400 4                  EPPR0   READ_ERRLOG
         6 000025   440000 713400                    CLIMB   alt,read
         6 000026   401400 401760                    pmme    nvectors=4
         6 000027   001676 702000 6                  TSX2    BAG_IT

      191     3201    3                 TH_CONSTRAINTS.START = TH_RECORD_BUF.UTS;

   3201  6 000030   000100 235000 5                  LDA     TH_RECORD_BUF
         6 000031   000101 236000 5                  LDQ     TH_RECORD_BUF+1
         6 000032   000011 773000                    LRL     9
         6 000033   000012 756000 xsym               STQ     TH_CONSTRAINTS+10

      192     3202    3                 FPT_PFIL.V.BOF# = '0'B;

   3202  6 000034   000000 236000 7                  LDQ     0
         6 000035   000052 356000 5                  ANSQ    FPT_PFIL+2

      193     3203    3                 CALL M$PFIL(FPT_PFIL);

   3203  6 000036   000050 630400 5                  EPPR0   FPT_PFIL
         6 000037   040004 713400                    CLIMB   16388
         6 000040   400000 401760                    pmme    nvectors=1

      194     3204    3                 CALL M$PRECORD(ERRLOG_PRECORD);

   3204  6 000041   000066 630400 5                  EPPR0   ERRLOG_PRECORD
         6 000042   040003 713400                    CLIMB   16387
         6 000043   401000 401760                    pmme    nvectors=3

      195     3205    3                 CALL M$READ(READ_ERRLOG) ALTRET(BAG_IT);

   3205  6 000044   000314 630400 4                  EPPR0   READ_ERRLOG
         6 000045   440000 713400                    CLIMB   alt,read
         6 000046   401400 401760                    pmme    nvectors=4
         6 000047   001676 702000 6                  TSX2    BAG_IT
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:28   

      196     3206    3                 TH_CONSTRAINTS.STOP = TH_RECORD_BUF.UTS;

   3206  6 000050   000100 235000 5                  LDA     TH_RECORD_BUF
         6 000051   000101 236000 5                  LDQ     TH_RECORD_BUF+1
         6 000052   000011 773000                    LRL     9
         6 000053   000013 756000 xsym               STQ     TH_CONSTRAINTS+11

      197     3207    3                 RETURN;

   3207  6 000054   000000 702200 xent               TSX2  ! X66_ARET

      198     3208    3                 END;
      199     3209    2              IF TH_BOF

   3209  6 000055   000000 234000 xsym               SZN     TH_BOF
         6 000056   000070 605000 6                  TPL     s:3215

      200     3210    3              THEN DO;

      201     3211    3                 TH_BOF = %NO;

   3211  6 000057   000000 450000 xsym               STZ     TH_BOF

      202     3212    3                 CALL XSA$CLOSE(TH_CLOSE_ERRLOG,TH_XSA_PARAM) ALTRET(XSA_ERR);

   3212  6 000060   000001 630400 7                  EPPR0   1
         6 000061   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 000062   000000 701000 xent               TSX1    XSA$CLOSE
         6 000063   001337 702000 6                  TSX2    XSA_ERR

      203     3213    3                 CALL XSA$OPEN(TH_OPEN_ERRLOG,TH_XSA_PARAM) ALTRET(XSA_ERR);

   3213  6 000064   000003 630400 7                  EPPR0   3
         6 000065   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 000066   000000 701000 xent               TSX1    XSA$OPEN
         6 000067   001337 702000 6                  TSX2    XSA_ERR
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:29   

      204     3214    3                 END;                      /* IF TH_BOF                          */

      205     3215    3              DO WHILE(NOT(PASSED_FLAG));

   3215  6 000070   001314 710000 6                  TRA     s:3447

      206     3216    3                 CALL XSA$READ(READ_ERRLOG,TH_XSA_PARAM) ALTRET(READ_ERR);

   3216  6 000071   000005 630400 7                  EPPR0   5
         6 000072   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 000073   000000 701000 xent               TSX1    XSA$READ
         6 000074   001344 702000 6                  TSX2    READ_ERR

      207     3217    3              CALL INDEX(TH_ITYPE,BINASC(TH_RECORD_BUF.TYPE),CHAR_VEC);

   3217  6 000075   000000 124400                    SCM     mask='000'O
         6 000076   000003 000046 4                  ADSC9   TYPE_VEC                 cn=0,n=38
         6 000077   000100 000001 5                  ADSC9   TH_RECORD_BUF            cn=0,n=1
         6 000100   000000 000000 xsym               ARG     TH_ITYPE

      208     3218    3                 PASSED_FLAG = %TRUE;

   3218  6 000101   400000 236003                    LDQ     -131072,DU
         6 000102   200020 756100                    STQ     PASSED_FLAG,,AUTO

      209     3219
      210     3220                                                /* CHECK FOR TIME                     */
      211     3221    3                 IF TH_RECORD_BUF.UTS < TH_CONSTRAINTS.START

   3221  6 000103   000100 235000 5                  LDA     TH_RECORD_BUF
         6 000104   000101 236000 5                  LDQ     TH_RECORD_BUF+1
         6 000105   000011 773000                    LRL     9
         6 000106   000012 116000 xsym               CMPQ    TH_CONSTRAINTS+10
         6 000107   001313 602000 6                  TNC     NOT_PASSED

      212     3222    3                 THEN GOTO NOT_PASSED;
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:30   
      213     3223    3                 IF TH_RECORD_BUF.UTS > TH_CONSTRAINTS.STOP

   3223  6 000110   000013 116000 xsym               CMPQ    TH_CONSTRAINTS+11
         6 000111   000113 600000 6                  TZE     s:3227
         6 000112   001356 603000 6                  TRC     ERRLOG_EOF

      214     3224    3                 THEN GOTO ERRLOG_EOF;
      215     3225
      216     3226                                                /* CHECK FOR ERROR TYPE               */
      217     3227    3                 IF TH_CONSTRAINTS.NTYPES > 0

   3227  6 000113   000000 235000 xsym               LDA     TH_CONSTRAINTS
         6 000114   000131 604400 6                  TMOZ    FOUND_NTYPES

      218     3228    3                    THEN                   /* CHECK ERROR TYPES                  */
      219     3229    4                    DO;

      220     3230    5                       DO I = 0 TO TH_CONSTRAINTS.NTYPES - 1;

   3230  6 000115   200017 450100                    STZ     I,,AUTO
         6 000116   000125 710000 6                  TRA     s:3233+1

      221     3231    5                          IF TH_RECORD_BUF.TYPEC = TH_CONSTRAINTS.TYPESC(I)

   3231  6 000117   200017 235100                    LDA     I,,AUTO
         6 000120   040005 106400                    CMPC    fill='040'O
         6 000121   000100 000001 5                  ADSC9   TH_RECORD_BUF            cn=0,n=1
         6 000122   000001 000001 xsym               ADSC9   TH_CONSTRAINTS+1,A       cn=0,n=1
         6 000123   000131 600000 6                  TZE     FOUND_NTYPES

      222     3232    5                          THEN GOTO FOUND_NTYPES;
      223     3233    5                       END;                /* DO I                               */

   3233  6 000124   200017 054100                    AOS     I,,AUTO
         6 000125   200017 236100                    LDQ     I,,AUTO
         6 000126   000000 116000 xsym               CMPQ    TH_CONSTRAINTS
         6 000127   000117 604000 6                  TMI     s:3231
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:31   

      224     3234    4                    GOTO NOT_PASSED;

   3234  6 000130   001313 710000 6                  TRA     NOT_PASSED

   3227  6 000131                       FOUND_NTYPES null
      225     3235    4                    END;                   /* IF                                 */
      226     3236    3   FOUND_NTYPES: ;
      227     3237    3                 IF TH_CHECK_DEVNM

   3237  6 000131   000000 234000 xsym               SZN     TH_CHECK_DEVNM
         6 000132   000346 605000 6                  TPL     s:3291

      228     3238    4                 THEN DO;                  /* CHECK FOR DEVICE                   */

      229     3239    5                       DO CASE(TH_ITYPE);

   3239  6 000133   000000 235000 xsym               LDA     TH_ITYPE
         6 000134   000041 115007                    CMPA    33,DL
         6 000135   000137 602005 6                  TNC     s:3239+4,AL
         6 000136   000340 710000 6                  TRA     s:3284
         6 000137   000340 710000 6                  TRA     s:3284
         6 000140   000340 710000 6                  TRA     s:3284
         6 000141   000213 710000 6                  TRA     s:3247
         6 000142   000213 710000 6                  TRA     s:3247
         6 000143   000340 710000 6                  TRA     s:3284
         6 000144   000340 710000 6                  TRA     s:3284
         6 000145   000340 710000 6                  TRA     s:3284
         6 000146   000204 710000 6                  TRA     s:3243
         6 000147   000340 710000 6                  TRA     s:3284
         6 000150   000217 710000 6                  TRA     s:3249
         6 000151   000340 710000 6                  TRA     s:3284
         6 000152   000223 710000 6                  TRA     s:3251
         6 000153   000340 710000 6                  TRA     s:3284
         6 000154   000340 710000 6                  TRA     s:3284
         6 000155   000226 710000 6                  TRA     s:3253
         6 000156   000340 710000 6                  TRA     s:3284
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:32   
         6 000157   000340 710000 6                  TRA     s:3284
         6 000160   000340 710000 6                  TRA     s:3284
         6 000161   000207 710000 6                  TRA     s:3245
         6 000162   000231 710000 6                  TRA     s:3255
         6 000163   000245 710000 6                  TRA     s:3260
         6 000164   000340 710000 6                  TRA     s:3284
         6 000165   000340 710000 6                  TRA     s:3284
         6 000166   000234 710000 6                  TRA     s:3257
         6 000167   000317 710000 6                  TRA     s:3274
         6 000170   000200 710000 6                  TRA     s:3241
         6 000171   000340 710000 6                  TRA     s:3284
         6 000172   000256 710000 6                  TRA     s:3263
         6 000173   000340 710000 6                  TRA     s:3284
         6 000174   000340 710000 6                  TRA     s:3284
         6 000175   000340 710000 6                  TRA     s:3284
         6 000176   000340 710000 6                  TRA     s:3284
         6 000177   000307 710000 6                  TRA     s:3271

      230     3240    5                          CASE(%TH_FI);

      231     3241    5                             TEMP$ = ADDR(EL$FILERR.DEVNM);

   3241  6 000200   000002 236000 4                  LDQ     INFO$
         6 000201   000017 036003                    ADLQ    15,DU
         6 000202   200030 756100                    STQ     TEMP$,,AUTO
         6 000203   000341 710000 6                  TRA     s:3286

      232     3242    5                          CASE(%TH_FWLOAD);

      233     3243    5                             TEMP$ = ADDR(EL$FWLOAD.DEVNM);

   3243  6 000204   000002 236000 4                  LDQ     INFO$
         6 000205   200030 756100                    STQ     TEMP$,,AUTO
         6 000206   000341 710000 6                  TRA     s:3286

      234     3244    5                          CASE(%TH_IOERR);

PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:33   
      235     3245    5                             TEMP$ = ADDR(EL$IOERR.DEVNM);

   3245  6 000207   000002 236000 4                  LDQ     INFO$
         6 000210   000024 036003                    ADLQ    20,DU
         6 000211   200030 756100                    STQ     TEMP$,,AUTO
         6 000212   000341 710000 6                  TRA     s:3286

      236     3246    5                          CASE(%TH_MOUNT,%TH_DSMT);

      237     3247    5                             TEMP$ = ADDR(EL$MTDMT.DEVNAME);

   3247  6 000213   000002 236000 4                  LDQ     INFO$
         6 000214   000004 036003                    ADLQ    4,DU
         6 000215   200030 756100                    STQ     TEMP$,,AUTO
         6 000216   000341 710000 6                  TRA     s:3286

      238     3248    5                          CASE(%TH_SYSCON);

      239     3249    5                             TEMP$ = ADDR(EL$SYSCON.DEVNM);

   3249  6 000217   000002 236000 4                  LDQ     INFO$
         6 000220   000001 036003                    ADLQ    1,DU
         6 000221   200030 756100                    STQ     TEMP$,,AUTO
         6 000222   000341 710000 6                  TRA     s:3286

      240     3250    5                          CASE(%TH_MPCSTAT);

      241     3251    5                             TEMP$ = ADDR(EL$MPCSTATS.MPCNAME);

   3251  6 000223   000002 236000 4                  LDQ     INFO$
         6 000224   200030 756100                    STQ     TEMP$,,AUTO
         6 000225   000341 710000 6                  TRA     s:3286

      242     3252    5                          CASE(%TH_DEVSTATS);

      243     3253    5                             TEMP$ = ADDR(EL$DEVSTATS.DEVNM);

PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:34   
   3253  6 000226   000002 236000 4                  LDQ     INFO$
         6 000227   200030 756100                    STQ     TEMP$,,AUTO
         6 000230   000341 710000 6                  TRA     s:3286

      244     3254    5                          CASE(%TH_EDAC);

      245     3255    5                             TEMP$ = ADDR(MEM_TEXT);

   3255  6 000231   000007 236000 7                  LDQ     7
         6 000232   200030 756100                    STQ     TEMP$,,AUTO
         6 000233   000341 710000 6                  TRA     s:3286

      246     3256    5                          CASE(%TH_FEPFLT);

      247     3257    5                             CALL BINCHAR(TEMPNUM,EL$FEPFLT.FEP#);

   3257  6 000234   000002 470400 4                  LDP0    INFO$
         6 000235   000000 236100                    LDQ     0,,PR0
         6 000236   000032 376000 xsym               ANQ     B_VECTNIL+26
         6 000237   000000 235003                    LDA     0,DU
         6 000240   200042 757100                    STAQ    FOUND+2,,AUTO
         6 000241   000100 301500                    BTD
         6 000242   200042 000010                    NDSC9   FOUND+2,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         6 000243   200031 030005                    NDSC9   TEMPNUM,,AUTO            cn=0,s=nosgn,sf=0,n=5

      248     3258    5                             GOTO FEPNM;

   3258  6 000244   000265 710000 6                  TRA     FEPNM

      249     3259    5                          CASE(%TH_FEPERR);

      250     3260    5                             CALL BINCHAR(TEMPNUM,EL$FEPERR.STATDATA.NODE);

   3260  6 000245   000002 470400 4                  LDP0    INFO$
         6 000246   000000 236100                    LDQ     0,,PR0
         6 000247   000024 772000                    QRL     20
         6 000250   000000 235003                    LDA     0,DU
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:35   
         6 000251   200042 757100                    STAQ    FOUND+2,,AUTO
         6 000252   000100 301500                    BTD
         6 000253   200042 000010                    NDSC9   FOUND+2,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         6 000254   200031 030005                    NDSC9   TEMPNUM,,AUTO            cn=0,s=nosgn,sf=0,n=5

      251     3261    5                             GOTO FEPNM;

   3261  6 000255   000265 710000 6                  TRA     FEPNM

      252     3262    5                          CASE(%TH_FEPEVENT);

      253     3263    5                             CALL BINCHAR(TEMPNUM,EL$FECRASH.FENM.FEP#);

   3263  6 000256   000002 470400 4                  LDP0    INFO$
         6 000257   000001 235100                    LDA     1,,PR0
         6 000260   000044 773000                    LRL     36
         6 000261   200042 757100                    STAQ    FOUND+2,,AUTO
         6 000262   000100 301500                    BTD
         6 000263   200042 000010                    NDSC9   FOUND+2,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         6 000264   200031 030005                    NDSC9   TEMPNUM,,AUTO            cn=0,s=nosgn,sf=0,n=5

      254     3264    5              FEPNM:         I = 0;

   3264  6 000265   200017 450100       FEPNM        STZ     I,,AUTO

      255     3265    6                             DO WHILE(SUBSTR(TEMPNUM,I,1) = '0' AND I < 4);

   3265  6 000266   000270 710000 6                  TRA     s:3267

      256     3266    6                                I = I + 1;

   3266  6 000267   200017 054100                    AOS     I,,AUTO

      257     3267    6                                END;  /* DO WHILE */

   3267  6 000270   200017 235100                    LDA     I,,AUTO
         6 000271   040000 106505                    CMPC    fill='040'O
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:36   
         6 000272   200031 000001                    ADSC9   TEMPNUM,A,AUTO           cn=0,n=1
         6 000273   000010 000001 7                  ADSC9   8                        cn=0,n=1
         6 000274   000277 601000 6                  TNZ     s:3268
         6 000275   000004 115007                    CMPA    4,DL
         6 000276   000267 604000 6                  TMI     s:3266

      258     3268    5                             CALL INSERT(FEPNAME.FEP#,,,SUBSTR(TEMPNUM,I));

   3268  6 000277   777772 620005                    EAX0    -6,AL
         6 000300   777777 660003                    ERX0    -1,DU
         6 000301   040000 100545                    MLR     fill='040'O
         6 000302   200031 000010                    ADSC9   TEMPNUM,A,AUTO           cn=0,n=*X0
         6 000303   000011 600005 5                  ADSC9   FEPNAME                  cn=3,n=5

      259     3269    5                             TEMP$ = ADDR(FEPNAME);

   3269  6 000304   000011 236000 7                  LDQ     9
         6 000305   200030 756100                    STQ     TEMP$,,AUTO
         6 000306   000341 710000 6                  TRA     s:3286

      260     3270    5                          CASE(%TH_FEPDUMP);

      261     3271    5                             CALL BINCHAR(TEMPNUM,EL$FEPDUMP.FEP);

   3271  6 000307   000002 470400 4                  LDP0    INFO$
         6 000310   000000 235100                    LDA     0,,PR0
         6 000311   000044 773000                    LRL     36
         6 000312   200042 757100                    STAQ    FOUND+2,,AUTO
         6 000313   000100 301500                    BTD
         6 000314   200042 000010                    NDSC9   FOUND+2,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         6 000315   200031 030005                    NDSC9   TEMPNUM,,AUTO            cn=0,s=nosgn,sf=0,n=5

      262     3272    5                       GOTO FEPNM;

   3272  6 000316   000265 710000 6                  TRA     FEPNM

      263     3273    5                     CASE(%TH_SCREECH);
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:37   

      264     3274    5                            IF SUBSTR(TH_CONSTRAINTS.DEVNM,0,3) = 'FEP'

   3274  6 000317   000010 236000 xsym               LDQ     TH_CONSTRAINTS+8
         6 000320   000332 676000 4                  ERQ     READ_ERRLOG+14
         6 000321   000012 376000 7                  ANQ     10
         6 000322   000337 601000 6                  TNZ     s:3282
         6 000323   000002 470400 4                  LDP0    INFO$
         6 000324   000000 236100                    LDQ     0,,PR0
         6 000325   000007 376007                    ANQ     7,DL
         6 000326   000003 116007                    CMPQ    3,DL
         6 000327   000337 601000 6                  TNZ     s:3282

      265     3275    5                                 AND
      266     3276    5                                 EL$SCREECH.SCODE.ERR.SEV = 3
      267     3277    5                            THEN
      268     3278    6                            DO;

      269     3279    6                                 CALL BINCHAR(TEMPNUM,EL$SCREECH.SNAPU#);

   3279  6 000330   000002 235100                    LDA     2,,PR0
         6 000331   000044 773000                    LRL     36
         6 000332   200042 757100                    STAQ    FOUND+2,,AUTO
         6 000333   000100 301500                    BTD
         6 000334   200042 000010                    NDSC9   FOUND+2,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         6 000335   200031 030005                    NDSC9   TEMPNUM,,AUTO            cn=0,s=nosgn,sf=0,n=5

      270     3280    6                                 GOTO FEPNM;

   3280  6 000336   000265 710000 6                  TRA     FEPNM

      271     3281    6                                 END;
      272     3282    5                       GOTO NOT_PASSED;

   3282  6 000337   001313 710000 6                  TRA     NOT_PASSED

      273     3283    5                          CASE(ELSE);
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:38   

      274     3284    5                             GOTO NOT_PASSED;

   3284  6 000340   001313 710000 6                  TRA     NOT_PASSED

      275     3285    5                       END;                /* DO CASE TH_ITYPE                   */

      276     3286    4                       IF TH_CONSTRAINTS.DEVNM ~= TEMP$->CHAR_BASE

   3286  6 000341   200030 470500                    LDP0    TEMP$,,AUTO
         6 000342   040100 106400                    CMPC    fill='040'O
         6 000343   000010 000010 xsym               ADSC9   TH_CONSTRAINTS+8         cn=0,n=8
         6 000344   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 000345   001313 601000 6                  TNZ     NOT_PASSED

      277     3287    4                       THEN GOTO NOT_PASSED;
      278     3288    4                    END;                   /* IF                                 */

      279     3289
      280     3290                                               /* CHECK FOR MATCH AND EXCLUDE         */
      281     3291    3                 IF TH_ITYPE = %TH_FI AND TH_FIERR_M_SET

   3291  6 000346   000000 235000 xsym               LDA     TH_ITYPE
         6 000347   000031 115007                    CMPA    25,DL
         6 000350   000421 601000 6                  TNZ     s:3301
         6 000351   000000 234000 xsym               SZN     TH_FIERR_M_SET
         6 000352   000421 605000 6                  TPL     s:3301

      282     3292    4                    THEN DO;

      283     3293    4                      IF (TH_CONSTRAINTS.M_COD_SET

   3293  6 000353   000065 236000 xsym               LDQ     TH_CONSTRAINTS+53
         6 000354   000200 316003                    CANQ    128,DU
         6 000355   000367 600000 6                  TZE     s:3293+12
         6 000356   000002 470400 4                  LDP0    INFO$
         6 000357   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:39   
         6 000360   000033 772000                    QRL     27
         6 000361   200042 756100                    STQ     FOUND+2,,AUTO
         6 000362   000065 236000 xsym               LDQ     TH_CONSTRAINTS+53
         6 000363   000032 772000                    QRL     26
         6 000364   000777 376007                    ANQ     511,DL
         6 000365   200042 116100                    CMPQ    FOUND+2,,AUTO
         6 000366   001313 601000 6                  TNZ     NOT_PASSED
         6 000367   000065 236000 xsym               LDQ     TH_CONSTRAINTS+53
         6 000370   100000 316007                    CANQ    32768,DL
         6 000371   000404 600000 6                  TZE     s:3293+25
         6 000372   000002 470400 4                  LDP0    INFO$
         6 000373   000000 236100                    LDQ     0,,PR0
         6 000374   000022 772000                    QRL     18
         6 000375   000777 376007                    ANQ     511,DL
         6 000376   200043 756100                    STQ     FOUND+3,,AUTO
         6 000377   000065 236000 xsym               LDQ     TH_CONSTRAINTS+53
         6 000400   000020 772000                    QRL     16
         6 000401   000777 376007                    ANQ     511,DL
         6 000402   200043 116100                    CMPQ    FOUND+3,,AUTO
         6 000403   001313 601000 6                  TNZ     NOT_PASSED
         6 000404   000065 236000 xsym               LDQ     TH_CONSTRAINTS+53
         6 000405   000040 316007                    CANQ    32,DL
         6 000406   000421 600000 6                  TZE     s:3301
         6 000407   000002 470400 4                  LDP0    INFO$
         6 000410   000000 236100                    LDQ     0,,PR0
         6 000411   000011 772000                    QRL     9
         6 000412   000777 376007                    ANQ     511,DL
         6 000413   200044 756100                    STQ     FOUND+4,,AUTO
         6 000414   000065 236000 xsym               LDQ     TH_CONSTRAINTS+53
         6 000415   000006 772000                    QRL     6
         6 000416   000777 376007                    ANQ     511,DL
         6 000417   200044 116100                    CMPQ    FOUND+4,,AUTO
         6 000420   001313 601000 6                  TNZ     NOT_PASSED

      284     3294    4                         AND TH_CONSTRAINTS.M_COD ~= EL$FILERR.CODE)
      285     3295    4                      OR (TH_CONSTRAINTS.M_REA_SET
      286     3296    4                         AND TH_CONSTRAINTS.M_REA ~= EL$FILERR.REASON)
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:40   
      287     3297    4                      OR (TH_CONSTRAINTS.M_ACT_SET
      288     3298    4                         AND TH_CONSTRAINTS.M_ACT ~= EL$FILERR.ACTION)
      289     3299    4                      THEN GOTO NOT_PASSED;
      290     3300    4                    END;

      291     3301    3                 IF TH_ITYPE = %TH_FI AND TH_FIERR_E_SET

   3301  6 000421   000031 115007                    CMPA    25,DL
         6 000422   000475 601000 6                  TNZ     s:3312
         6 000423   000000 234000 xsym               SZN     TH_FIERR_E_SET
         6 000424   000475 605000 6                  TPL     s:3312

      292     3302    4                    THEN DO;

      293     3303    4                      IF (TH_CONSTRAINTS.E_COD_SET

   3303  6 000425   000066 236000 xsym               LDQ     TH_CONSTRAINTS+54
         6 000426   020000 316003                    CANQ    8192,DU
         6 000427   000442 600000 6                  TZE     s:3303+13
         6 000430   000002 470400 4                  LDP0    INFO$
         6 000431   000000 236100                    LDQ     0,,PR0
         6 000432   000033 772000                    QRL     27
         6 000433   200042 756100                    STQ     FOUND+2,,AUTO
         6 000434   000065 235000 xsym               LDA     TH_CONSTRAINTS+53
         6 000435   000066 236000 xsym               LDQ     TH_CONSTRAINTS+54
         6 000436   000040 773000                    LRL     32
         6 000437   000777 376007                    ANQ     511,DL
         6 000440   200042 116100                    CMPQ    FOUND+2,,AUTO
         6 000441   000657 601000 6                  TNZ     NOT_EXCLUDED
         6 000442   000066 236000 xsym               LDQ     TH_CONSTRAINTS+54
         6 000443   000010 316003                    CANQ    8,DU
         6 000444   000457 600000 6                  TZE     s:3303+26
         6 000445   000002 470400 4                  LDP0    INFO$
         6 000446   000000 236100                    LDQ     0,,PR0
         6 000447   000022 772000                    QRL     18
         6 000450   000777 376007                    ANQ     511,DL
         6 000451   200043 756100                    STQ     FOUND+3,,AUTO
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:41   
         6 000452   000066 236000 xsym               LDQ     TH_CONSTRAINTS+54
         6 000453   000026 772000                    QRL     22
         6 000454   000777 376007                    ANQ     511,DL
         6 000455   200043 116100                    CMPQ    FOUND+3,,AUTO
         6 000456   000657 601000 6                  TNZ     NOT_EXCLUDED
         6 000457   000066 236000 xsym               LDQ     TH_CONSTRAINTS+54
         6 000460   004000 316007                    CANQ    2048,DL
         6 000461   000474 600000 6                  TZE     s:3310
         6 000462   000002 470400 4                  LDP0    INFO$
         6 000463   000000 236100                    LDQ     0,,PR0
         6 000464   000011 772000                    QRL     9
         6 000465   000777 376007                    ANQ     511,DL
         6 000466   200044 756100                    STQ     FOUND+4,,AUTO
         6 000467   000066 236000 xsym               LDQ     TH_CONSTRAINTS+54
         6 000470   000014 772000                    QRL     12
         6 000471   000777 376007                    ANQ     511,DL
         6 000472   200044 116100                    CMPQ    FOUND+4,,AUTO
         6 000473   000657 601000 6                  TNZ     NOT_EXCLUDED

      294     3304    4                         AND TH_CONSTRAINTS.E_COD ~= EL$FILERR.CODE)
      295     3305    4                      OR (TH_CONSTRAINTS.E_REA_SET
      296     3306    4                         AND TH_CONSTRAINTS.E_REA ~= EL$FILERR.REASON)
      297     3307    4                      OR (TH_CONSTRAINTS.E_ACT_SET
      298     3308    4                         AND TH_CONSTRAINTS.E_ACT ~= EL$FILERR.ACTION)
      299     3309    4                      THEN GOTO NOT_EXCLUDED;
      300     3310    4                      ELSE GOTO NOT_PASSED;

   3310  6 000474   001313 710000 6                  TRA     NOT_PASSED

      301     3311    4                    END;
      302     3312    3                 IF TH_ITYPE = %TH_IOERR AND TH_IOERR_M_OR_E_SET

   3312  6 000475   000022 115007                    CMPA    18,DL
         6 000476   000657 601000 6                  TNZ     NOT_EXCLUDED
         6 000477   000000 234000 xsym               SZN     TH_IOERR_M_OR_E_SET
         6 000500   000657 605000 6                  TPL     NOT_EXCLUDED

PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:42   
      303     3313    4                 THEN DO;                 /* CHECK MATCH AND EXCLUDE             */

      304     3314    4                    IF TH_IOERR_M_SET

   3314  6 000501   000000 234000 xsym               SZN     TH_IOERR_M_SET
         6 000502   000565 605000 6                  TPL     s:3333

      305     3315    5                    THEN DO;                    /* CHECK MATCH                   */

      306     3316    5                       IF (TH_CONSTRAINTS.M_MAJ_S

   3316  6 000503   000014 236000 xsym               LDQ     TH_CONSTRAINTS+12
         6 000504   004000 316003                    CANQ    2048,DU
         6 000505   000512 600000 6                  TZE     s:3316+7
         6 000506   000002 470400 4                  LDP0    INFO$
         6 000507   000001 676100                    ERQ     1,,PR0
         6 000510   770000 376003                    ANQ     -4096,DU
         6 000511   001313 601000 6                  TNZ     NOT_PASSED
         6 000512   000014 236000 xsym               LDQ     TH_CONSTRAINTS+12
         6 000513   000020 316003                    CANQ    16,DU
         6 000514   000522 600000 6                  TZE     s:3316+15
         6 000515   000002 470400 4                  LDP0    INFO$
         6 000516   000100 066400                    CMPB    filb='0'B
         6 000517   000014 070006 xsym               BDSC    TH_CONSTRAINTS+12        by=0,bit=7,n=6
         6 000520   000001 060006                    BDSC    1,,PR0                   by=0,bit=6,n=6
         6 000521   001313 601000 6                  TNZ     NOT_PASSED
         6 000522   000016 234000 xsym               SZN     TH_CONSTRAINTS+14
         6 000523   000531 605000 6                  TPL     s:3323
         6 000524   000002 470400 4                  LDP0    INFO$
         6 000525   040100 106400                    CMPC    fill='040'O
         6 000526   000014 400006 xsym               ADSC9   TH_CONSTRAINTS+12        cn=2,n=6
         6 000527   000026 000006                    ADSC9   22,,PR0                  cn=0,n=6
         6 000530   001313 601000 6                  TNZ     NOT_PASSED

      307     3317    5                           AND TH_CONSTRAINTS.M_MAJ ~= EL$IOERR.XSTATUS.MAJOR)
      308     3318    5                         OR (TH_CONSTRAINTS.M_SUB_S
      309     3319    5                           AND TH_CONSTRAINTS.M_SUB ~= EL$IOERR.XSTATUS.MINOR)
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:43   
      310     3320    5                         OR (TH_CONSTRAINTS.M_MED_S
      311     3321    5                           AND TH_CONSTRAINTS.M_MED ~= EL$IOERR.SN)
      312     3322    5                       THEN GOTO NOT_PASSED;
      313     3323    5                       IF TH_IOERR_M_BY_B_SET

   3323  6 000531   000000 234000 xsym               SZN     TH_IOERR_M_BY_B_SET
         6 000532   000565 605000 6                  TPL     s:3333

      314     3324    6                       THEN DO;

      315     3325    6                          IO_MASK = EL$IOERR.EXTST;

   3325  6 000533   000002 470400 4                  LDP0    INFO$
         6 000534   000100 100500                    MLR     fill='000'O
         6 000535   000013 000040                    ADSC9   11,,PR0                  cn=0,n=32
         6 000536   200007 000040                    ADSC9   IO_MASK,,AUTO            cn=0,n=32

      316     3326    7                          DO I = 0 TO 207;

   3326  6 000537   200017 450100                    STZ     I,,AUTO

      317     3327    7                             IF TH_CONSTRAINTS.M_BY_B_SET(I)

   3327  6 000540   200017 235100                    LDA     I,,AUTO
         6 000541   000543 605000 6                  TPL     s:3327+3
         6 000542   000044 035003                    ADLA    36,DU
         6 000543   000000 066405                    CMPB    filb='0'B
         6 000544   000026 010001 xsym               BDSC    TH_CONSTRAINTS+22,A      by=0,bit=1,n=1
         6 000545   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         6 000546   000561 600000 6                  TZE     s:3330
         6 000547   200017 235100                    LDA     I,,AUTO
         6 000550   000552 605000 6                  TPL     s:3327+10
         6 000551   000044 035003                    ADLA    36,DU
         6 000552   200017 236100                    LDQ     I,,AUTO
         6 000553   000555 605000 6                  TPL     s:3327+13
         6 000554   000044 036003                    ADLQ    36,DU
         6 000555   000006 066505                    CMPB    filb='0'B
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:44   
         6 000556   200007 000001                    BDSC    IO_MASK,A,AUTO           by=0,bit=0,n=1
         6 000557   000016 010001 xsym               BDSC    TH_CONSTRAINTS+14,Q      by=0,bit=1,n=1
         6 000560   001313 601000 6                  TNZ     NOT_PASSED

      318     3328    7                               AND IO_MASK1(I) ~= TH_CONSTRAINTS.M_BY_B_VEC(I)
      319     3329    7                             THEN GOTO NOT_PASSED;
      320     3330    7                             END;                     /* DO I = 0 TO 207         */

   3330  6 000561   200017 054100                    AOS     I,,AUTO
         6 000562   200017 235100                    LDA     I,,AUTO
         6 000563   000317 115007                    CMPA    207,DL
         6 000564   000540 604400 6                  TMOZ    s:3327

      321     3331    6                          END;                  /* IF TH_IOERR_M_BY_B_SET        */

      322     3332    5                       END;                    /* CHECK MATCH                    */

      323     3333    4                    IF TH_IOERR_E_SET

   3333  6 000565   000000 234000 xsym               SZN     TH_IOERR_E_SET
         6 000566   000657 605000 6                  TPL     NOT_EXCLUDED

      324     3334    5                    THEN DO;                 /* CHECK EXCLUDE                    */

      325     3335    5                       IF (TH_CONSTRAINTS.E_MAJ_S

   3335  6 000567   000036 236000 xsym               LDQ     TH_CONSTRAINTS+30
         6 000570   002000 316003                    CANQ    1024,DU
         6 000571   000603 600000 6                  TZE     s:3335+12
         6 000572   000002 470400 4                  LDP0    INFO$
         6 000573   000001 236100                    LDQ     1,,PR0
         6 000574   000036 772000                    QRL     30
         6 000575   200042 756100                    STQ     FOUND+2,,AUTO
         6 000576   000036 236000 xsym               LDQ     TH_CONSTRAINTS+30
         6 000577   000035 772000                    QRL     29
         6 000600   000077 376007                    ANQ     63,DL
         6 000601   200042 116100                    CMPQ    FOUND+2,,AUTO
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:45   
         6 000602   000657 601000 6                  TNZ     NOT_EXCLUDED
         6 000603   000036 236000 xsym               LDQ     TH_CONSTRAINTS+30
         6 000604   000010 316003                    CANQ    8,DU
         6 000605   000613 600000 6                  TZE     s:3335+20
         6 000606   000002 470400 4                  LDP0    INFO$
         6 000607   000100 066400                    CMPB    filb='0'B
         6 000610   000036 100006 xsym               BDSC    TH_CONSTRAINTS+30        by=0,bit=8,n=6
         6 000611   000001 060006                    BDSC    1,,PR0                   by=0,bit=6,n=6
         6 000612   000657 601000 6                  TNZ     NOT_EXCLUDED
         6 000613   000040 234000 xsym               SZN     TH_CONSTRAINTS+32
         6 000614   000622 605000 6                  TPL     s:3342
         6 000615   000002 470400 4                  LDP0    INFO$
         6 000616   040100 106400                    CMPC    fill='040'O
         6 000617   000036 400006 xsym               ADSC9   TH_CONSTRAINTS+30        cn=2,n=6
         6 000620   000026 000006                    ADSC9   22,,PR0                  cn=0,n=6
         6 000621   000657 601000 6                  TNZ     NOT_EXCLUDED

      326     3336    5                           AND TH_CONSTRAINTS.E_MAJ ~= EL$IOERR.XSTATUS.MAJOR)
      327     3337    5                         OR (TH_CONSTRAINTS.E_SUB_S
      328     3338    5                           AND TH_CONSTRAINTS.E_SUB ~= EL$IOERR.XSTATUS.MINOR)
      329     3339    5                         OR (TH_CONSTRAINTS.E_MED_S
      330     3340    5                           AND TH_CONSTRAINTS.E_MED ~= EL$IOERR.SN)
      331     3341    5                       THEN GOTO NOT_EXCLUDED;
      332     3342    5                       IF TH_IOERR_E_BY_B_SET

   3342  6 000622   000000 234000 xsym               SZN     TH_IOERR_E_BY_B_SET
         6 000623   000656 605000 6                  TPL     s:3351

      333     3343    6                       THEN DO;

      334     3344    6                          IO_MASK = EL$IOERR.EXTST;

   3344  6 000624   000002 470400 4                  LDP0    INFO$
         6 000625   000100 100500                    MLR     fill='000'O
         6 000626   000013 000040                    ADSC9   11,,PR0                  cn=0,n=32
         6 000627   200007 000040                    ADSC9   IO_MASK,,AUTO            cn=0,n=32

PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:46   
      335     3345    7                          DO I = 0 TO 207;

   3345  6 000630   200017 450100                    STZ     I,,AUTO

      336     3346    7                             IF TH_CONSTRAINTS.E_BY_B_SET(I)

   3346  6 000631   200017 235100                    LDA     I,,AUTO
         6 000632   000634 605000 6                  TPL     s:3346+3
         6 000633   000044 035003                    ADLA    36,DU
         6 000634   000000 066405                    CMPB    filb='0'B
         6 000635   000050 010001 xsym               BDSC    TH_CONSTRAINTS+40,A      by=0,bit=1,n=1
         6 000636   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         6 000637   000652 600000 6                  TZE     s:3349
         6 000640   200017 235100                    LDA     I,,AUTO
         6 000641   000643 605000 6                  TPL     s:3346+10
         6 000642   000044 035003                    ADLA    36,DU
         6 000643   200017 236100                    LDQ     I,,AUTO
         6 000644   000646 605000 6                  TPL     s:3346+13
         6 000645   000044 036003                    ADLQ    36,DU
         6 000646   000006 066505                    CMPB    filb='0'B
         6 000647   200007 000001                    BDSC    IO_MASK,A,AUTO           by=0,bit=0,n=1
         6 000650   000040 010001 xsym               BDSC    TH_CONSTRAINTS+32,Q      by=0,bit=1,n=1
         6 000651   000657 601000 6                  TNZ     NOT_EXCLUDED

      337     3347    7                               AND IO_MASK1(I) ~= TH_CONSTRAINTS.E_BY_B_VEC(I)
      338     3348    7                             THEN GOTO NOT_EXCLUDED;
      339     3349    7                             END;                     /* DO I = 0 TO 207         */

   3349  6 000652   200017 054100                    AOS     I,,AUTO
         6 000653   200017 235100                    LDA     I,,AUTO
         6 000654   000317 115007                    CMPA    207,DL
         6 000655   000631 604400 6                  TMOZ    s:3346

      340     3350    6                          END;                  /* IF TH_IOERR_E_BY_B_SET        */

      341     3351    5                       GOTO NOT_PASSED;

PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:47   
   3351  6 000656   001313 710000 6                  TRA     NOT_PASSED

   3348  6 000657                       NOT_EXCLUDED null
      342     3352    5                    END;                        /* OF CHECK EXCLUDE              */
      343     3353    4                 END;                      /* OF CHECK MATCH AND EXCLUDE         */
      344     3354    3   NOT_EXCLUDED: ;
      345     3355    3            IF (TH_ITYPE = %TH_FEPERR)

   3355  6 000657   000000 235000 xsym               LDA     TH_ITYPE
         6 000660   000024 115007                    CMPA    20,DL
         6 000661   001312 601000 6                  TNZ     s:3443
         6 000662   000000 234000 xsym               SZN     TH_FEPERR_M_OR_E_SET
         6 000663   001312 605000 6                  TPL     s:3443

      346     3356    3              AND TH_FEPERR_M_OR_E_SET
      347     3357    4              THEN DO;

      348     3358    4           FEPERR_CODE_F_M.FCG = BITBIN( EL$FEPERR.STATDATA.ERRCODE.FCG );

   3358  6 000664   000002 470400 4                  LDP0    INFO$
         6 000665   000001 236100                    LDQ     1,,PR0
         6 000666   000030 772000                    QRL     24
         6 000667   000030 736000                    QLS     24
         6 000670   200022 752160                    STCQ    FEPERR_CODE_F_M,'60'O,AUTO

      349     3359    4           FEPERR_CODE_F_M.MID = BITBIN( EL$FEPERR.STATDATA.ERRCODE.MID );

   3359  6 000671   000001 236100                    LDQ     1,,PR0
         6 000672   000022 772000                    QRL     18
         6 000673   000077 376007                    ANQ     63,DL
         6 000674   000022 736000                    QLS     18
         6 000675   200022 752110                    STCQ    FEPERR_CODE_F_M,'10'O,AUTO

      350     3360    4                 IF (TH_CONSTRAINTS.M_FEP_SET)

   3360  6 000676   000061 234000 xsym               SZN     TH_CONSTRAINTS+49
         6 000677   001014 605000 6                  TPL     FOUND_FEP
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:48   

      351     3361    4                   THEN
      352     3362    4                      IF TH_CONSTRAINTS.M_FEP_N > 0 AND

   3362  6 000700   000061 236000 xsym               LDQ     TH_CONSTRAINTS+49
         6 000701   377400 316003                    CANQ    130816,DU
         6 000702   001014 600000 6                  TZE     FOUND_FEP
         6 000703   000061 236000 xsym               LDQ     TH_CONSTRAINTS+49
         6 000704   377400 376003                    ANQ     130816,DU
         6 000705   002000 116003                    CMPQ    1024,DU
         6 000706   001014 603000 6                  TRC     FOUND_FEP

      353     3363    4                         TH_CONSTRAINTS.M_FEP_N < 4
      354     3364    5                         THEN DO;

      355     3365    5                           FEPERR_CODE = ' ';

   3365  6 000707   000013 236000 7                  LDQ     11
         6 000710   200023 756100                    STQ     FEPERR_CODE,,AUTO

      356     3366    6                           DO I = 0 TO TH_CONSTRAINTS.M_FEP_N - 1;

   3366  6 000711   200017 450100                    STZ     I,,AUTO
         6 000712   000740 710000 6                  TRA     s:3370+1

      357     3367    6                                FEP_FCG_W = BITBIN(FEPERR_FCG(I));

   3367  6 000713   200017 235100                    LDA     I,,AUTO
         6 000714   000716 605000 6                  TPL     s:3367+3
         6 000715   000006 035003                    ADLA    6,DU
         6 000716   000100 101505                    MRL     fill='000'O
         6 000717   200022 020001                    ADSC6   FEPERR_CODE_F_M,A,AUTO   cn=0,n=1
         6 000720   200042 020006                    ADSC6   FOUND+2,,AUTO            cn=0,n=6
         6 000721   200042 236100                    LDQ     FOUND+2,,AUTO
         6 000722   200024 756100                    STQ     FEP_FCG_W,,AUTO

      358     3368    6                                FEP_FCG = FEP_FCG_W;
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:49   

   3368  6 000723   000036 736000                    QLS     30
         6 000724   200025 756100                    STQ     FEP_FCG,,AUTO

      359     3369    6                                CALL INSERT(FEPERR_CODE,I,1,BINASC(FEP_FCG+64));

   3369  6 000725   200025 236100                    LDQ     FEP_FCG,,AUTO
         6 000726   000036 772000                    QRL     30
         6 000727   000100 036007                    ADLQ    64,DL
         6 000730   000033 736000                    QLS     27
         6 000731   000014 276000 7                  ORQ     12
         6 000732   200042 756100                    STQ     FOUND+2,,AUTO
         6 000733   200017 235100                    LDA     I,,AUTO
         6 000734   040105 100500                    MLR     fill='040'O
         6 000735   200042 000004                    ADSC9   FOUND+2,,AUTO            cn=0,n=4
         6 000736   200023 000001                    ADSC9   FEPERR_CODE,A,AUTO       cn=0,n=1

      360     3370    6                           END;

   3370  6 000737   200017 054100                    AOS     I,,AUTO
         6 000740   000061 236000 xsym               LDQ     TH_CONSTRAINTS+49
         6 000741   000032 772000                    QRL     26
         6 000742   000777 376007                    ANQ     511,DL
         6 000743   200017 116100                    CMPQ    I,,AUTO
         6 000744   000713 605400 6                  TPNZ    s:3367

      361     3371    5                           I = 0;

   3371  6 000745   200017 450100                    STZ     I,,AUTO

      362     3372    5                           J = 0;

   3372  6 000746   200037 450100                    STZ     J,,AUTO

      363     3373    6                           DO WHILE(I < TH_LAST_MATCH.COUNT - 1);

   3373  6 000747   001006 710000 6                  TRA     s:3385
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:50   

      364     3374    6                             CALL INDEX(I,'=',SUBSTR(TH_LAST_MATCH.TEXT,I));

   3374  6 000750   200017 720100                    LXL0    I,,AUTO
         6 000751   777610 620010                    EAX0    -120,X0
         6 000752   777777 660003                    ERX0    -1,DU
         6 000753   200017 235100                    LDA     I,,AUTO
         6 000754   000000 124445                    SCM     mask='000'O
         6 000755   000000 200010 xsym               ADSC9   TH_LAST_MATCH,A          cn=1,n=*X0
         6 000756   000015 000001 7                  ADSC9   13                       cn=0,n=1
         6 000757   200017 000100                    ARG     I,,AUTO

      365     3375    6                             I = I + J + 1;

   3375  6 000760   200017 236100                    LDQ     I,,AUTO
         6 000761   200037 036100                    ADLQ    J,,AUTO
         6 000762   000001 036007                    ADLQ    1,DL
         6 000763   200017 756100                    STQ     I,,AUTO

      366     3376    7                               DO WHILE(SUBSTR(TH_LAST_MATCH.TEXT,I,1) = ' ');

   3376  6 000764   000766 710000 6                  TRA     s:3378

      367     3377    7                                 I = I + 1;

   3377  6 000765   200017 054100                    AOS     I,,AUTO

      368     3378    7                               END; /* do while */

   3378  6 000766   200017 235100                    LDA     I,,AUTO
         6 000767   040000 106405                    CMPC    fill='040'O
         6 000770   000000 200001 xsym               ADSC9   TH_LAST_MATCH,A          cn=1,n=1
         6 000771   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000772   000765 600000 6                  TZE     s:3377

      369     3379    6                             TH_CONSTRAINTS.M_FEP = SUBSTR(TH_LAST_MATCH.TEXT,I,3);

PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:51   
   3379  6 000773   040000 100405                    MLR     fill='040'O
         6 000774   000000 200003 xsym               ADSC9   TH_LAST_MATCH,A          cn=1,n=3
         6 000775   000060 200003 xsym               ADSC9   TH_CONSTRAINTS+48        cn=1,n=3

      370     3380    6                             IF(FEPERR_CODE = TH_CONSTRAINTS.M_FEP)

   3380  6 000776   040000 106500                    CMPC    fill='040'O
         6 000777   200023 000003                    ADSC9   FEPERR_CODE,,AUTO        cn=0,n=3
         6 001000   000060 200003 xsym               ADSC9   TH_CONSTRAINTS+48        cn=1,n=3
         6 001001   001014 600000 6                  TZE     FOUND_FEP

      371     3381    6                             THEN GOTO FOUND_FEP;
      372     3382
      373     3383    6                             I = I + 3;

   3383  6 001002   000003 236007                    LDQ     3,DL
         6 001003   200017 056100                    ASQ     I,,AUTO

      374     3384    6                             J = I;

   3384  6 001004   200017 235100                    LDA     I,,AUTO
         6 001005   200037 755100                    STA     J,,AUTO

      375     3385    6                           END;  /* do while */

   3385  6 001006   000000 236000 xsym               LDQ     TH_LAST_MATCH
         6 001007   000033 772000                    QRL     27
         6 001010   000001 136007                    SBLQ    1,DL
         6 001011   200017 116100                    CMPQ    I,,AUTO
         6 001012   000750 605400 6                  TPNZ    s:3374

      376     3386    5                           GOTO NOT_PASSED;

   3386  6 001013   001313 710000 6                  TRA     NOT_PASSED

   3379  6 001014                       FOUND_FEP    null
      377     3387    5   FOUND_FEP: ;
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:52   
      378     3388    5                         END;

      379     3389    4                 IF (TH_CONSTRAINTS.E_FEP_SET)

   3389  6 001014   000063 236000 xsym               LDQ     TH_CONSTRAINTS+51
         6 001015   400000 316007                    CANQ    -131072,DL
         6 001016   001067 600000 6                  TZE     s:3403

      380     3390    4                   THEN
      381     3391    4                      IF TH_CONSTRAINTS.E_FEP_N > 0 AND

   3391  6 001017   377400 316007                    CANQ    130816,DL
         6 001020   001067 600000 6                  TZE     s:3403
         6 001021   000063 236000 xsym               LDQ     TH_CONSTRAINTS+51
         6 001022   377400 376007                    ANQ     130816,DL
         6 001023   002000 116007                    CMPQ    1024,DL
         6 001024   001067 603000 6                  TRC     s:3403

      382     3392    4                         TH_CONSTRAINTS.E_FEP_N < 4
      383     3393    5                         THEN DO;

      384     3394    5                           FEPERR_CODE = ' ';

   3394  6 001025   000013 236000 7                  LDQ     11
         6 001026   200023 756100                    STQ     FEPERR_CODE,,AUTO

      385     3395    6                           DO I = 0 TO TH_CONSTRAINTS.E_FEP_N - 1;

   3395  6 001027   200017 450100                    STZ     I,,AUTO
         6 001030   001056 710000 6                  TRA     s:3399+1

      386     3396    6                                FEP_FCG_W = BITBIN(FEPERR_FCG(I));

   3396  6 001031   200017 235100                    LDA     I,,AUTO
         6 001032   001034 605000 6                  TPL     s:3396+3
         6 001033   000006 035003                    ADLA    6,DU
         6 001034   000100 101505                    MRL     fill='000'O
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:53   
         6 001035   200022 020001                    ADSC6   FEPERR_CODE_F_M,A,AUTO   cn=0,n=1
         6 001036   200042 020006                    ADSC6   FOUND+2,,AUTO            cn=0,n=6
         6 001037   200042 236100                    LDQ     FOUND+2,,AUTO
         6 001040   200024 756100                    STQ     FEP_FCG_W,,AUTO

      387     3397    6                                FEP_FCG = FEP_FCG_W;

   3397  6 001041   000036 736000                    QLS     30
         6 001042   200025 756100                    STQ     FEP_FCG,,AUTO

      388     3398    6                                CALL INSERT(FEPERR_CODE,I,1,BINASC(FEP_FCG+64));

   3398  6 001043   200025 236100                    LDQ     FEP_FCG,,AUTO
         6 001044   000036 772000                    QRL     30
         6 001045   000100 036007                    ADLQ    64,DL
         6 001046   000033 736000                    QLS     27
         6 001047   000014 276000 7                  ORQ     12
         6 001050   200042 756100                    STQ     FOUND+2,,AUTO
         6 001051   200017 235100                    LDA     I,,AUTO
         6 001052   040105 100500                    MLR     fill='040'O
         6 001053   200042 000004                    ADSC9   FOUND+2,,AUTO            cn=0,n=4
         6 001054   200023 000001                    ADSC9   FEPERR_CODE,A,AUTO       cn=0,n=1

      389     3399    6                           END;

   3399  6 001055   200017 054100                    AOS     I,,AUTO
         6 001056   000063 236000 xsym               LDQ     TH_CONSTRAINTS+51
         6 001057   000010 772000                    QRL     8
         6 001060   000777 376007                    ANQ     511,DL
         6 001061   200017 116100                    CMPQ    I,,AUTO
         6 001062   001031 605400 6                  TPNZ    s:3396

      390     3400    5                           IF (FEPERR_CODE=TH_CONSTRAINTS.E_FEP)

   3400  6 001063   040000 106500                    CMPC    fill='040'O
         6 001064   200023 000003                    ADSC9   FEPERR_CODE,,AUTO        cn=0,n=3
         6 001065   000062 600003 xsym               ADSC9   TH_CONSTRAINTS+50        cn=3,n=3
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:54   
         6 001066   001313 600000 6                  TZE     NOT_PASSED

      391     3401    5                              THEN GOTO NOT_PASSED;
      392     3402    5                         END;

      393     3403    4            FOUND='0'B;

   3403  6 001067   200040 450100                    STZ     FOUND,,AUTO

      394     3404    4   TERMINAL_CHAN.A = EL$FEPERR.STATDATA.TERMID.TERM.CHANNEL.BYT(0);

   3404  6 001070   000002 470400 4                  LDP0    INFO$
         6 001071   000005 236100                    LDQ     5,,PR0
         6 001072   000023 736000                    QLS     19
         6 001073   200034 676100                    ERQ     TERMINAL_CHAN,,AUTO
         6 001074   776000 376003                    ANQ     -1024,DU
         6 001075   200034 656100                    ERSQ    TERMINAL_CHAN,,AUTO

      395     3405    4   TERMINAL_CHAN.B = EL$FEPERR.STATDATA.TERMID.TERM.CHANNEL.BYT(1);

   3405  6 001076   000005 236100                    LDQ     5,,PR0
         6 001077   000024 736000                    QLS     20
         6 001100   200034 676100                    ERQ     TERMINAL_CHAN,,AUTO
         6 001101   001774 376003                    ANQ     1020,DU
         6 001102   200034 656100                    ERSQ    TERMINAL_CHAN,,AUTO

      396     3406    4                 IF TH_CONSTRAINTS.M_CHAN_SET

   3406  6 001103   000062 236000 xsym               LDQ     TH_CONSTRAINTS+50
         6 001104   400000 316007                    CANQ    -131072,DL
         6 001105   001223 600000 6                  TZE     s:3427

      397     3407    5                   THEN DO;

      398     3408    6          DO J=0 TO TH_M_CHAN_TOTAL-1;

   3408  6 001106   200037 450100                    STZ     J,,AUTO
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:55   
         6 001107   001213 710000 6                  TRA     s:3421+1

      399     3409    6                      HEXNUM = 0;

   3409  6 001110   200033 450100                    STZ     HEXNUM,,AUTO

      400     3410    7                      DO I = 0 TO 3;

   3410  6 001111   200017 450100                    STZ     I,,AUTO

      401     3411    7            CHAN_CHAR=SUBSTR(TH_M_CHAN.TEXT(J),I,1);

   3411  6 001112   200037 236100                    LDQ     J,,AUTO
         6 001113   000005 402007                    MPY     5,DL
         6 001114   200017 036100                    ADLQ    I,,AUTO
         6 001115   040100 100406                    MLR     fill='040'O
         6 001116   000000 000001 xsym               ADSC9   TH_M_CHAN,Q              cn=0,n=1
         6 001117   200035 000001                    ADSC9   CHAN_CHAR,,AUTO          cn=0,n=1

      402     3412    7                        CALL CHARBIN(CHAN_NUM,CHAN_CHAR);

   3412  6 001120   000100 305500                    DTB
         6 001121   200035 030001                    NDSC9   CHAN_CHAR,,AUTO          cn=0,s=nosgn,sf=0,n=1
         6 001122   200036 000004                    NDSC9   CHAN_NUM,,AUTO           cn=0,s=lsgnf,sf=0,n=4

      403     3413    7                        IF CHAN_CHAR = 'A' OR CHAN_CHAR = 'B' OR

   3413  6 001123   200035 236100                    LDQ     CHAN_CHAR,,AUTO
         6 001124   777000 376003                    ANQ     -512,DU
         6 001125   101000 116003                    CMPQ    33280,DU
         6 001126   001153 600000 6                  TZE     s:3416
         6 001127   200035 236100                    LDQ     CHAN_CHAR,,AUTO
         6 001130   777000 376003                    ANQ     -512,DU
         6 001131   102000 116003                    CMPQ    33792,DU
         6 001132   001153 600000 6                  TZE     s:3416
         6 001133   200035 236100                    LDQ     CHAN_CHAR,,AUTO
         6 001134   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:56   
         6 001135   103000 116003                    CMPQ    34304,DU
         6 001136   001153 600000 6                  TZE     s:3416
         6 001137   200035 236100                    LDQ     CHAN_CHAR,,AUTO
         6 001140   777000 376003                    ANQ     -512,DU
         6 001141   104000 116003                    CMPQ    34816,DU
         6 001142   001153 600000 6                  TZE     s:3416
         6 001143   200035 236100                    LDQ     CHAN_CHAR,,AUTO
         6 001144   777000 376003                    ANQ     -512,DU
         6 001145   105000 116003                    CMPQ    35328,DU
         6 001146   001153 600000 6                  TZE     s:3416
         6 001147   200035 236100                    LDQ     CHAN_CHAR,,AUTO
         6 001150   777000 376003                    ANQ     -512,DU
         6 001151   106000 116003                    CMPQ    35840,DU
         6 001152   001156 601000 6                  TNZ     s:3417

      404     3414    7                           CHAN_CHAR = 'C' OR CHAN_CHAR = 'D' OR
      405     3415    7                           CHAN_CHAR = 'E'  OR CHAN_CHAR = 'F'
      406     3416    7                             THEN CHAN_NUM = CHAN_NUM + 9;

   3416  6 001153   200036 235100                    LDA     CHAN_NUM,,AUTO
         6 001154   000011 035007                    ADLA    9,DL
         6 001155   200036 755100                    STA     CHAN_NUM,,AUTO

      407     3417    7                        HEXNUM = HEXNUM * 16 + CHAN_NUM;

   3417  6 001156   200033 236100                    LDQ     HEXNUM,,AUTO
         6 001157   000020 772000                    QRL     16
         6 001160   000016 376000 7                  ANQ     14
         6 001161   200036 036100                    ADLQ    CHAN_NUM,,AUTO
         6 001162   000024 736000                    QLS     20
         6 001163   200033 756100                    STQ     HEXNUM,,AUTO

      408     3418    7                      END;

   3418  6 001164   200017 054100                    AOS     I,,AUTO
         6 001165   200017 235100                    LDA     I,,AUTO
         6 001166   000003 115007                    CMPA    3,DL
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:57   
         6 001167   001112 604400 6                  TMOZ    s:3411

      409     3419    6            IF HEXNUM = BITBIN( TERMINAL_CHAN ) AND TH_M_CHAN.FLAG(J)

   3419  6 001170   200034 236100                    LDQ     TERMINAL_CHAN,,AUTO
         6 001171   000024 772000                    QRL     20
         6 001172   200042 756100                    STQ     FOUND+2,,AUTO
         6 001173   200033 236100                    LDQ     HEXNUM,,AUTO
         6 001174   000024 772000                    QRL     20
         6 001175   200042 116100                    CMPQ    FOUND+2,,AUTO
         6 001176   001212 601000 6                  TNZ     s:3421
         6 001177   200037 236100                    LDQ     J,,AUTO
         6 001200   000055 402007                    MPY     45,DL
         6 001201   000000 116003                    CMPQ    0,DU
         6 001202   001204 605000 6                  TPL     s:3419+12
         6 001203   000044 036003                    ADLQ    36,DU
         6 001204   000000 066406                    CMPB    filb='0'B
         6 001205   000001 000001 xsym               BDSC    TH_M_CHAN+1,Q            by=0,bit=0,n=1
         6 001206   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         6 001207   001212 600000 6                  TZE     s:3421

      410     3420    6                THEN FOUND = '1'B;

   3420  6 001210   400000 236003                    LDQ     -131072,DU
         6 001211   200040 756100                    STQ     FOUND,,AUTO

      411     3421    6         END; /* DO J = 0 TO  */

   3421  6 001212   200037 054100                    AOS     J,,AUTO
         6 001213   000000 236000 xsym               LDQ     TH_M_CHAN_TOTAL
         6 001214   000037 772000                    QRL     31
         6 001215   200037 116100                    CMPQ    J,,AUTO
         6 001216   001110 605400 6                  TPNZ    s:3409

      412     3422    5         IF FOUND

   3422  6 001217   200040 234100                    SZN     FOUND,,AUTO
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:58   
         6 001220   001313 605000 6                  TPL     NOT_PASSED

      413     3423    5            THEN
      414     3424    5                FOUND='0'B;

   3424  6 001221   200040 450100                    STZ     FOUND,,AUTO
         6 001222   001223 710000 6                  TRA     s:3427

      415     3425    5            ELSE GOTO NOT_PASSED;
      416     3426    5                   END;
      417     3427    4                 IF TH_CONSTRAINTS.E_CHAN_SET

   3427  6 001223   000065 234000 xsym               SZN     TH_CONSTRAINTS+53
         6 001224   001312 605000 6                  TPL     s:3443

      418     3428    5                   THEN DO;

      419     3429    5                      HEXNUM = 0;

   3429  6 001225   200033 450100                    STZ     HEXNUM,,AUTO

      420     3430    6                      DO I = 0 TO 3;

   3430  6 001226   200017 450100                    STZ     I,,AUTO

      421     3431    6                        CHAN_CHAR = SUBSTR(TH_CONSTRAINTS.E_CHAN,I,1);

   3431  6 001227   200017 235100                    LDA     I,,AUTO
         6 001230   040100 100405                    MLR     fill='040'O
         6 001231   000064 000001 xsym               ADSC9   TH_CONSTRAINTS+52,A      cn=0,n=1
         6 001232   200035 000001                    ADSC9   CHAN_CHAR,,AUTO          cn=0,n=1

      422     3432    6                        CALL CHARBIN(CHAN_NUM,CHAN_CHAR);

   3432  6 001233   000100 305500                    DTB
         6 001234   200035 030001                    NDSC9   CHAN_CHAR,,AUTO          cn=0,s=nosgn,sf=0,n=1
         6 001235   200036 000004                    NDSC9   CHAN_NUM,,AUTO           cn=0,s=lsgnf,sf=0,n=4
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:59   

      423     3433    6                        IF CHAN_CHAR = 'A' OR CHAN_CHAR = 'B' OR

   3433  6 001236   200035 236100                    LDQ     CHAN_CHAR,,AUTO
         6 001237   777000 376003                    ANQ     -512,DU
         6 001240   101000 116003                    CMPQ    33280,DU
         6 001241   001266 600000 6                  TZE     s:3436
         6 001242   200035 236100                    LDQ     CHAN_CHAR,,AUTO
         6 001243   777000 376003                    ANQ     -512,DU
         6 001244   102000 116003                    CMPQ    33792,DU
         6 001245   001266 600000 6                  TZE     s:3436
         6 001246   200035 236100                    LDQ     CHAN_CHAR,,AUTO
         6 001247   777000 376003                    ANQ     -512,DU
         6 001250   103000 116003                    CMPQ    34304,DU
         6 001251   001266 600000 6                  TZE     s:3436
         6 001252   200035 236100                    LDQ     CHAN_CHAR,,AUTO
         6 001253   777000 376003                    ANQ     -512,DU
         6 001254   104000 116003                    CMPQ    34816,DU
         6 001255   001266 600000 6                  TZE     s:3436
         6 001256   200035 236100                    LDQ     CHAN_CHAR,,AUTO
         6 001257   777000 376003                    ANQ     -512,DU
         6 001260   105000 116003                    CMPQ    35328,DU
         6 001261   001266 600000 6                  TZE     s:3436
         6 001262   200035 236100                    LDQ     CHAN_CHAR,,AUTO
         6 001263   777000 376003                    ANQ     -512,DU
         6 001264   106000 116003                    CMPQ    35840,DU
         6 001265   001271 601000 6                  TNZ     s:3437

      424     3434    6                           CHAN_CHAR = 'C' OR CHAN_CHAR = 'D' OR
      425     3435    6                           CHAN_CHAR = 'E'  OR CHAN_CHAR = 'F'
      426     3436    6                             THEN CHAN_NUM = CHAN_NUM + 9;

   3436  6 001266   200036 236100                    LDQ     CHAN_NUM,,AUTO
         6 001267   000011 036007                    ADLQ    9,DL
         6 001270   200036 756100                    STQ     CHAN_NUM,,AUTO

      427     3437    6                        HEXNUM = HEXNUM * 16 + CHAN_NUM;
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:60   

   3437  6 001271   200033 236100                    LDQ     HEXNUM,,AUTO
         6 001272   000020 772000                    QRL     16
         6 001273   000016 376000 7                  ANQ     14
         6 001274   200036 036100                    ADLQ    CHAN_NUM,,AUTO
         6 001275   000024 736000                    QLS     20
         6 001276   200033 756100                    STQ     HEXNUM,,AUTO

      428     3438    6                      END;

   3438  6 001277   200017 054100                    AOS     I,,AUTO
         6 001300   200017 235100                    LDA     I,,AUTO
         6 001301   000003 115007                    CMPA    3,DL
         6 001302   001227 604400 6                  TMOZ    s:3431

      429     3439    5                      IF HEXNUM = BITBIN( TERMINAL_CHAN )

   3439  6 001303   200034 236100                    LDQ     TERMINAL_CHAN,,AUTO
         6 001304   000024 772000                    QRL     20
         6 001305   200042 756100                    STQ     FOUND+2,,AUTO
         6 001306   200033 236100                    LDQ     HEXNUM,,AUTO
         6 001307   000024 772000                    QRL     20
         6 001310   200042 116100                    CMPQ    FOUND+2,,AUTO
         6 001311   001313 600000 6                  TZE     NOT_PASSED

      430     3440    5                           THEN GOTO NOT_PASSED;
      431     3441    5                   END;

      432     3442    4              END;

      433     3443    4           DO NEVER;

   3443  6 001312   001314 710000 6                  TRA     s:3447

   3440  6 001313                       NOT_PASSED   null
      434     3444    4   NOT_PASSED: ;
      435     3445    4              PASSED_FLAG = %FALSE;
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:61   

   3445  6 001313   200020 450100                    STZ     PASSED_FLAG,,AUTO

      436     3446    4              END;

      437     3447    3              END;                         /* DO WHILE                           */

   3447  6 001314   200020 234100                    SZN     PASSED_FLAG,,AUTO
         6 001315   000071 605000 6                  TPL     s:3216

      438     3448    2              TH_RECORD.BOUND = TH_XSA_PARAM.ARS# - 1;

   3448  6 001316   000000 236000 xsym               LDQ     TH_XSA_PARAM
         6 001317   000001 136007                    SBLQ    1,DL
         6 001320   000020 736000                    QLS     16
         6 001321   000000 676000 xsym               ERQ     TH_RECORD
         6 001322   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 001323   000000 656000 xsym               ERSQ    TH_RECORD

      439     3449    2              TH_INFO.BOUND = TH_XSA_PARAM.ARS# - 21;

   3449  6 001324   000000 236000 xsym               LDQ     TH_XSA_PARAM
         6 001325   000025 136007                    SBLQ    21,DL
         6 001326   000020 736000                    QLS     16
         6 001327   000000 676000 xsym               ERQ     TH_INFO
         6 001330   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 001331   000000 656000 xsym               ERSQ    TH_INFO

      440     3450    2              TH_LASTUTS = TH_RECORD_BUF.UTS;

   3450  6 001332   000100 235000 5                  LDA     TH_RECORD_BUF
         6 001333   000101 236000 5                  LDQ     TH_RECORD_BUF+1
         6 001334   000011 773000                    LRL     9
         6 001335   000000 756000 xsym               STQ     TH_LASTUTS

      441     3451    2              RETURN;

PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:62   
   3451  6 001336   000000 702200 xent               TSX2  ! X66_ARET

      442     3452    2   XSA_ERR:   CALL XUR$ERRMSG(TH_XSA_PARAM.ERR);

   3452  6 001337   000017 630400 7     XSA_ERR      EPPR0   15
         6 001340   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 001341   000000 701000 xent               TSX1    XUR$ERRMSG
         6 001342   000000 011000                    NOP     0

      443     3453    2              RETURN;

   3453  6 001343   000000 702200 xent               TSX2  ! X66_ARET

      444     3454    2   READ_ERR:  TH_LAST_REQID = 0;

   3454  6 001344   000000 450000 xsym  READ_ERR     STZ     TH_LAST_REQID

      445     3455    2              IF TH_XSA_PARAM.ERR.CODE ~= %E$EOF

   3455  6 001345   000001 236000 xsym               LDQ     TH_XSA_PARAM+1
         6 001346   377770 376007                    ANQ     131064,DL
         6 001347   000060 116007                    CMPQ    48,DL
         6 001350   001356 600000 6                  TZE     ERRLOG_EOF

      446     3456    3              THEN DO;

      447     3457    3                 CALL XUR$ERRMSG(TH_XSA_PARAM.ERR);

   3457  6 001351   000017 630400 7                  EPPR0   15
         6 001352   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 001353   000000 701000 xent               TSX1    XUR$ERRMSG
         6 001354   000000 011000                    NOP     0

      448     3458    3                 RETURN;

   3458  6 001355   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:63   
   3455  6 001356                       ERRLOG_EOF   null
      449     3459    3                 END;
      450     3460    2   ERRLOG_EOF: ;
      451     3461    2              ALTRETURN;

   3461  6 001356   000000 702200 xent               TSX2  ! X66_AALT

      452     3462    2           CASE(%CONFIG);

      453     3463    2            M$CONFIG$ = DCBADDR(DCBNUM(M$CFG));

   3463  6 001357   000000 236007 xsym               LDQ     M$CFG,DL
         6 001360   000020 471400 7                  LDP1    16
         6 001361   100000 473500                    LDP3    0,,PR1
         6 001362   300000 236106                    LDQ     0,QL,PR3
         6 001363   200026 756100                    STQ     M$CONFIG$,,AUTO

      454     3464    2              TH_RECORD = VECTOR(RECORD_BUF);

   3464  6 001364   000022 237000 7                  LDAQ    18
         6 001365   000000 757000 xsym               STAQ    TH_RECORD

      455     3465    2              IF KEY_NAME = '0'

   3465  6 001366   200004 474500                    LDP4    @KEY_NAME,,AUTO
         6 001367   040000 106500                    CMPC    fill='040'O
         6 001370   400000 000010                    ADSC9   0,,PR4                   cn=0,n=8
         6 001371   000010 000001 7                  ADSC9   8                        cn=0,n=1
         6 001372   001376 601000 6                  TNZ     s:3472

      456     3466    2                 THEN                      /* HEAD RECORD                        */
      457     3467    3                 DO;

      458     3468    3                    READ_CONFIG.KEY_ = VECTOR(HEAD_KEY);

   3468  6 001373   000024 237000 7                  LDAQ    20
         6 001374   000034 757000 5                  STAQ    READ_CONFIG+2
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:64   

      459     3469    3                 END;

   3469  6 001375   001433 710000 6                  TRA     s:3492

      460     3470    2                 ELSE                      /* BUILD KEY                          */
      461     3471    3                 DO;

      462     3472    3                    IF SUBSTR(KEY_NAME,0,3) = 'IOM'

   3472  6 001376   040000 106500                    CMPC    fill='040'O
         6 001377   400000 000003                    ADSC9   0,,PR4                   cn=0,n=3
         6 001400   000333 000003 4                  ADSC9   READ_ERRLOG+15           cn=0,n=3
         6 001401   001405 601000 6                  TNZ     s:3478

      463     3473    3                       THEN                /* IOM RECORD                         */
      464     3474    4                       DO;

      465     3475    4                          CONFIG_KEY.C = 4;

   3475  6 001402   004000 236003                    LDQ     2048,DU
         6 001403   000000 552040 5                  STBQ    CONFIG_KEY,'40'O

      466     3476    4                       END;

   3476  6 001404   001426 710000 6                  TRA     s:3489

      467     3477    3                       ELSE
      468     3478    3                    IF (SUBSTR(KEY_NAME,0,2) = 'UC') OR

   3478  6 001405   040000 106500                    CMPC    fill='040'O
         6 001406   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2
         6 001407   000334 000002 4                  ADSC9   READ_ERRLOG+16           cn=0,n=2
         6 001410   001421 600000 6                  TZE     s:3483
         6 001411   040000 106500                    CMPC    fill='040'O
         6 001412   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2
         6 001413   000335 000002 4                  ADSC9   READ_ERRLOG+17           cn=0,n=2
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:65   
         6 001414   001421 600000 6                  TZE     s:3483
         6 001415   040000 106500                    CMPC    fill='040'O
         6 001416   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2
         6 001417   000336 000002 4                  ADSC9   READ_ERRLOG+18           cn=0,n=2
         6 001420   001424 601000 6                  TNZ     s:3487

      469     3479    3                       (SUBSTR(KEY_NAME,0,2) = 'TC') OR
      470     3480    3                       (SUBSTR(KEY_NAME,0,2) = 'DC')
      471     3481    3                       THEN                /* MPC RECORD                         */
      472     3482    4                       DO;

      473     3483    4                          CONFIG_KEY.C = 8;

   3483  6 001421   010000 236003                    LDQ     4096,DU
         6 001422   000000 552040 5                  STBQ    CONFIG_KEY,'40'O

      474     3484    4                       END;

   3484  6 001423   001426 710000 6                  TRA     s:3489

      475     3485    3                       ELSE                /* DEVICE RECORD                      */
      476     3486    4                       DO;

      477     3487    4                          CONFIG_KEY.C = 8;

   3487  6 001424   010000 236003                    LDQ     4096,DU
         6 001425   000000 552040 5                  STBQ    CONFIG_KEY,'40'O

      478     3488    4                       END;

      479     3489    3                    CONFIG_KEY.TXT = KEY_NAME;

   3489  6 001426   040000 100500                    MLR     fill='040'O
         6 001427   400000 000010                    ADSC9   0,,PR4                   cn=0,n=8
         6 001430   000000 200010 5                  ADSC9   CONFIG_KEY               cn=1,n=8

      480     3490    3                    READ_CONFIG.KEY_ = VECTOR(CONFIG_KEY);
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:66   

   3490  6 001431   000026 237000 7                  LDAQ    22
         6 001432   000034 757000 5                  STAQ    READ_CONFIG+2

      481     3491    3                 END;                      /* IF KEY_NAME = '0'                  */

      482     3492    2          IF NOT M$CONFIG$->F$DCB.FCD THEN

   3492  6 001433   200026 475500                    LDP5    M$CONFIG$,,AUTO
         6 001434   500031 236100                    LDQ     25,,PR5
         6 001435   020000 316007                    CANQ    8192,DL
         6 001436   001443 601000 6                  TNZ     s:3494

      483     3493    2              CALL M$OPEN(OPEN_CONFIG) ALTRET(BAG_IT);

   3493  6 001437   000152 630400 4                  EPPR0   OPEN_CONFIG
         6 001440   450000 713400                    CLIMB   alt,open
         6 001441   410400 401760                    pmme    nvectors=18
         6 001442   001676 702000 6                  TSX2    BAG_IT

      484     3494    2              CALL M$READ(READ_CONFIG) ALTRET(BAG_IT);

   3494  6 001443   000032 630400 5                  EPPR0   READ_CONFIG
         6 001444   440000 713400                    CLIMB   alt,read
         6 001445   401400 401760                    pmme    nvectors=4
         6 001446   001676 702000 6                  TSX2    BAG_IT

      485     3495    2              TH_RECORD.BOUND = M$CONFIG$->F$DCB.ARS - 1;

   3495  6 001447   200026 470500                    LDP0    M$CONFIG$,,AUTO
         6 001450   000000 236100                    LDQ     0,,PR0
         6 001451   000001 136007                    SBLQ    1,DL
         6 001452   000020 736000                    QLS     16
         6 001453   000000 676000 xsym               ERQ     TH_RECORD
         6 001454   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 001455   000000 656000 xsym               ERSQ    TH_RECORD

PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:67   
      486     3496    2              CALL M$CLOSE(CLOSE_CONFIG);

   3496  6 001456   000244 630400 4                  EPPR0   CLOSE_CONFIG
         6 001457   050001 713400                    CLIMB   close
         6 001460   406000 401760                    pmme    nvectors=13
         6 001461   001675 710000 6                  TRA     s:3568

      487     3497    2           CASE(%DEVHIST);

      488     3498    2              M$DEVHIST$ = DCBADDR(DCBNUM(M$DEVHIST));

   3498  6 001462   000000 236007 xsym               LDQ     M$DEVHIST,DL
         6 001463   000020 471400 7                  LDP1    16
         6 001464   100000 473500                    LDP3    0,,PR1
         6 001465   300000 236106                    LDQ     0,QL,PR3
         6 001466   200027 756100                    STQ     M$DEVHIST$,,AUTO

      489     3499    2              TH_RECORD = VECTOR(RECORD_BUF);

   3499  6 001467   000022 237000 7                  LDAQ    18
         6 001470   000000 757000 xsym               STAQ    TH_RECORD

      490     3500    2              IF NOT M$DEVHIST$->F$DCB.FCD

   3500  6 001471   200027 474500                    LDP4    M$DEVHIST$,,AUTO
         6 001472   400031 236100                    LDQ     25,,PR4
         6 001473   020000 316007                    CANQ    8192,DL
         6 001474   001501 601000 6                  TNZ     s:3502

      491     3501    2              THEN CALL M$OPEN(OPEN_DEVHIST) ALTRET(BAG_IT);

   3501  6 001475   000022 630400 4                  EPPR0   OPEN_DEVHIST
         6 001476   450000 713400                    CLIMB   alt,open
         6 001477   410400 401760                    pmme    nvectors=18
         6 001500   001676 702000 6                  TSX2    BAG_IT

      492     3502    2              IF ADDR(UTS) = ADDR(NIL)
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:68   

   3502  6 001501   200005 236100                    LDQ     @UTS,,AUTO
         6 001502   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 001503   001562 601000 6                  TNZ     s:3526

      493     3503    2                 THEN                      /* NON-UTS RECORD TO READ             */
      494     3504    3                 DO;

      495     3505    3                    IF KEY_NAME = '0'      /* HEAD RECORD                        */

   3505  6 001504   200004 470500                    LDP0    @KEY_NAME,,AUTO
         6 001505   040000 106500                    CMPC    fill='040'O
         6 001506   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 001507   000010 000001 7                  ADSC9   8                        cn=0,n=1
         6 001510   001514 601000 6                  TNZ     s:3508

      496     3506    3                       THEN READ_DEVHIST.KEY_ = VECTOR(HEAD_KEY);

   3506  6 001511   000024 237000 7                  LDAQ    20
         6 001512   000016 757000 5                  STAQ    READ_DEVHIST+2
         6 001513   001543 710000 6                  TRA     s:3517

      497     3507    3                       ELSE
      498     3508    3                    IF KEY_NAME = '1'      /* THRESH RECORD                      */

   3508  6 001514   040000 106500                    CMPC    fill='040'O
         6 001515   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 001516   000030 000001 7                  ADSC9   24                       cn=0,n=1
         6 001517   001523 601000 6                  TNZ     s:3511

      499     3509    3                       THEN READ_DEVHIST.KEY_ = VECTOR(THRESH_KEY);

   3509  6 001520   000032 237000 7                  LDAQ    26
         6 001521   000016 757000 5                  STAQ    READ_DEVHIST+2
         6 001522   001543 710000 6                  TRA     s:3517

      500     3510    3                       ELSE
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:69   
      501     3511    3                    IF KEY_NAME = '2'      /* MAINT RECORD                       */

   3511  6 001523   040000 106500                    CMPC    fill='040'O
         6 001524   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 001525   000031 000001 7                  ADSC9   25                       cn=0,n=1
         6 001526   001532 601000 6                  TNZ     s:3514

      502     3512    3                       THEN READ_DEVHIST.KEY_ = VECTOR(MAINT_KEY);

   3512  6 001527   000034 237000 7                  LDAQ    28
         6 001530   000016 757000 5                  STAQ    READ_DEVHIST+2
         6 001531   001543 710000 6                  TRA     s:3517

      503     3513    3                       ELSE
      504     3514    3                    IF KEY_NAME = '3'      /* UTS RECORD                         */

   3514  6 001532   040000 106500                    CMPC    fill='040'O
         6 001533   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 001534   000036 000001 7                  ADSC9   30                       cn=0,n=1
         6 001535   001541 601000 6                  TNZ     s:3516

      505     3515    3                       THEN READ_DEVHIST.KEY_ = VECTOR(UTS_KEY);

   3515  6 001536   000040 237000 7                  LDAQ    32
         6 001537   000016 757000 5                  STAQ    READ_DEVHIST+2
         6 001540   001543 710000 6                  TRA     s:3517

      506     3516    3                       ELSE READ_DEVHIST.KEY_ = VECTOR(NIL);

   3516  6 001541   000042 237000 7                  LDAQ    34
         6 001542   000016 757000 5                  STAQ    READ_DEVHIST+2

      507     3517    3                    CALL M$READ(READ_DEVHIST) ALTRET(L1);

   3517  6 001543   000014 630400 5                  EPPR0   READ_DEVHIST
         6 001544   440000 713400                    CLIMB   alt,read
         6 001545   401400 401760                    pmme    nvectors=4
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:70   
         6 001546   001550 702000 6                  TSX2    L1

      508     3518    4                    DO NEVER;

   3518  6 001547   001663 710000 6                  TRA     s:3561

      509     3519    4              L1:      IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY

   3519  6 001550   000000 470400 xsym  L1           LDP0    B$TCB$
         6 001551   000000 471500                    LDP1    0,,PR0
         6 001552   100102 236100                    LDQ     66,,PR1
         6 001553   377770 376007                    ANQ     131064,DL
         6 001554   001020 116007                    CMPQ    528,DL
         6 001555   001676 600000 6                  TZE     BAG_IT

      510     3520    4                          THEN GOTO BAG_IT;
      511     3521    4                          ELSE CALL THM$ERRMSG;

   3521  6 001556   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 001557   000000 701000 xent               TSX1    THM$ERRMSG
         6 001560   000000 011000                    NOP     0

      512     3522    4                    END;                   /* DO NEVER                           */

      513     3523    3                 END;                      /* IF ADDR(UTS) = ADDR(NIL)           */

   3523  6 001561   001663 710000 6                  TRA     s:3561

      514     3524    2                 ELSE                      /* UTS IS PRESENT                     */
      515     3525    3                 DO;

      516     3526    3                    IF UTS = BITBIN('777777777777'O)

   3526  6 001562   200005 470500                    LDP0    @UTS,,AUTO
         6 001563   000000 236100                    LDQ     0,,PR0
         6 001564   000027 116000 xsym               CMPQ    B_VECTNIL+23
         6 001565   001634 601000 6                  TNZ     s:3549
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:71   

      517     3527    3                       THEN                /* DONT CARE ABOUT UTS                */
      518     3528    4                       DO;

      519     3529    4                          DEVHIST_KEY8.C = 12;

   3529  6 001566   014000 236003                    LDQ     6144,DU
         6 001567   000003 552040 5                  STBQ    DEVHIST_KEY8,'40'O

      520     3530    4                          DEVHIST_KEY8.TXT = KEY_NAME;

   3530  6 001570   200004 471500                    LDP1    @KEY_NAME,,AUTO
         6 001571   040000 100500                    MLR     fill='040'O
         6 001572   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         6 001573   000003 200010 5                  ADSC9   DEVHIST_KEY8             cn=1,n=8

      521     3531    4                          DEVHIST_KEY8.UTS = 0;

   3531  6 001574   000000 100400                    MLR     fill='000'O
         6 001575   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         6 001576   000005 200004 5                  ADSC9   DEVHIST_KEY8+2           cn=1,n=4

      522     3532    4                          PRECORD.KEY_ = VECTOR(DEVHIST_KEY8);

   3532  6 001577   000044 237000 7                  LDAQ    36
         6 001600   000056 757000 5                  STAQ    PRECORD+2

      523     3533    4                          CALL M$PRECORD(PRECORD) ALTRET(NO_KEY);

   3533  6 001601   000054 630400 5                  EPPR0   PRECORD
         6 001602   440003 713400                    CLIMB   alt,+16387
         6 001603   401000 401760                    pmme    nvectors=3
         6 001604   001605 702000 6                  TSX2    NO_KEY

      524     3534    4                    NO_KEY:  IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY

   3534  6 001605   000000 470400 xsym  NO_KEY       LDP0    B$TCB$
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:72   
         6 001606   000000 471500                    LDP1    0,,PR0
         6 001607   100102 236100                    LDQ     66,,PR1
         6 001610   377770 376007                    ANQ     131064,DL
         6 001611   001020 116007                    CMPQ    528,DL
         6 001612   001663 601000 6                  TNZ     s:3561

      525     3535    4                                THEN
      526     3536    5                                DO;

      527     3537    5                                   RET_KEY = DEVHIST_KEY8.TXT;

   3537  6 001613   040000 100400                    MLR     fill='040'O
         6 001614   000003 200010 5                  ADSC9   DEVHIST_KEY8             cn=1,n=8
         6 001615   000007 000010 5                  ADSC9   RET_KEY                  cn=0,n=8

      528     3538    5                                   IF RET_KEY = KEY_NAME AND DEVHIST_KEY8.C ~= 0

   3538  6 001616   200004 473500                    LDP3    @KEY_NAME,,AUTO
         6 001617   040100 106400                    CMPC    fill='040'O
         6 001620   000007 000010 5                  ADSC9   RET_KEY                  cn=0,n=8
         6 001621   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
         6 001622   001676 601000 6                  TNZ     BAG_IT
         6 001623   000003 236000 5                  LDQ     DEVHIST_KEY8
         6 001624   777000 316003                    CANQ    -512,DU
         6 001625   001676 600000 6                  TZE     BAG_IT

      529     3539    5                                      THEN
      530     3540    6                                      DO;

      531     3541    6                                         READ_DEVHIST.V.KEYS# = %NO;

   3541  6 001626   000037 236000 7                  LDQ     31
         6 001627   000024 356000 5                  ANSQ    READ_DEVHIST+8

      532     3542    6                                         CALL M$READ(READ_DEVHIST);

   3542  6 001630   000014 630400 5                  EPPR0   READ_DEVHIST
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:73   
         6 001631   040000 713400                    CLIMB   read
         6 001632   401400 401760                    pmme    nvectors=4

      533     3543    6                                      END;

   3543  6 001633   001663 710000 6                  TRA     s:3561

      534     3544    5                                      ELSE GOTO BAG_IT;
      535     3545    5                                END;       /* IF ERRCODE = NOKEY                 */
      536     3546    4                       END;                /* IF UTS = -1                        */
      537     3547    3                       ELSE                /* BUILD KEY WITH UTS                 */
      538     3548    4                       DO;

      539     3549    4                          DEVHIST_KEY8.TXT = KEY_NAME;

   3549  6 001634   200004 471500                    LDP1    @KEY_NAME,,AUTO
         6 001635   040000 100500                    MLR     fill='040'O
         6 001636   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         6 001637   000003 200010 5                  ADSC9   DEVHIST_KEY8             cn=1,n=8

      540     3550    4                          DEVHIST_KEY8.UTS = UTS;

   3550  6 001640   000000 100500                    MLR     fill='000'O
         6 001641   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         6 001642   000005 200004 5                  ADSC9   DEVHIST_KEY8+2           cn=1,n=4

      541     3551    4                          READ_DEVHIST.KEY_ = VECTOR(DEVHIST_KEY8);

   3551  6 001643   000044 237000 7                  LDAQ    36
         6 001644   000016 757000 5                  STAQ    READ_DEVHIST+2

      542     3552    4                          CALL M$READ(READ_DEVHIST) ALTRET(L3);

   3552  6 001645   000014 630400 5                  EPPR0   READ_DEVHIST
         6 001646   440000 713400                    CLIMB   alt,read
         6 001647   401400 401760                    pmme    nvectors=4
         6 001650   001652 702000 6                  TSX2    L3
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:74   

      543     3553    5                          DO NEVER;

   3553  6 001651   001663 710000 6                  TRA     s:3561

      544     3554    5                 L3:
      545     3555    5                             IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY

   3555  6 001652   000000 470400 xsym  L3           LDP0    B$TCB$
         6 001653   000000 471500                    LDP1    0,,PR0
         6 001654   100102 236100                    LDQ     66,,PR1
         6 001655   377770 376007                    ANQ     131064,DL
         6 001656   001020 116007                    CMPQ    528,DL
         6 001657   001676 600000 6                  TZE     BAG_IT

      546     3556    5                                THEN GOTO BAG_IT;
      547     3557    5                                ELSE CALL THM$ERRMSG;

   3557  6 001660   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 001661   000000 701000 xent               TSX1    THM$ERRMSG
         6 001662   000000 011000                    NOP     0

      548     3558    5                          END;             /* DO NEVER                           */

      549     3559    4                       END;

      550     3560    3                 END;

      551     3561    2              TH_RECORD.BOUND = M$DEVHIST$->F$DCB.ARS - 1;

   3561  6 001663   200027 470500                    LDP0    M$DEVHIST$,,AUTO
         6 001664   000000 236100                    LDQ     0,,PR0
         6 001665   000001 136007                    SBLQ    1,DL
         6 001666   000020 736000                    QLS     16
         6 001667   000000 676000 xsym               ERQ     TH_RECORD
         6 001670   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 001671   000000 656000 xsym               ERSQ    TH_RECORD
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:75   

      552     3562    2              READ_DEVHIST.V.KEYS# = %YES;

   3562  6 001672   200000 236007                    LDQ     65536,DL
         6 001673   000024 256000 5                  ORSQ    READ_DEVHIST+8
         6 001674   001675 710000 6                  TRA     s:3568

      553     3563    2           CASE(%MEDHIST);

      554     3564                                                /* UNIMPLIMENTED AS YET               */
      555     3565    2           CASE(%OCHIST);

      556     3566                                                /* UNIMPLIMENTED AS YET               */
      557     3567    2        END;                               /* DO CASE                            */

      558     3568    1        RETURN;

   3568  6 001675   000000 702200 xent               TSX2  ! X66_ARET

      559     3569    1   BAG_IT:
      560     3570    2        DO CASE(FILE);

   3570  6 001676   200003 470500       BAG_IT       LDP0    @FILE,,AUTO
         6 001677   000000 235100                    LDA     0,,PR0
         6 001700   000003 115007                    CMPA    3,DL
         6 001701   001703 602005 6                  TNC     BAG_IT+5,AL
         6 001702   001716 710000 6                  TRA     s:3582
         6 001703   001716 710000 6                  TRA     s:3582
         6 001704   001716 710000 6                  TRA     s:3582
         6 001705   001706 710000 6                  TRA     s:3574

      561     3571    2           CASE(%ERRLOG);

      562     3572    2              /* DO NOTHING */;
      563     3573    2           CASE(%CONFIG);

      564     3574    2              IF M$CONFIG$->F$DCB.FCD
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:76   

   3574  6 001706   200026 471500                    LDP1    M$CONFIG$,,AUTO
         6 001707   100031 236100                    LDQ     25,,PR1
         6 001710   020000 316007                    CANQ    8192,DL
         6 001711   001716 600000 6                  TZE     s:3582

      565     3575    2                 THEN CALL M$CLOSE(CLOSE_CONFIG);

   3575  6 001712   000244 630400 4                  EPPR0   CLOSE_CONFIG
         6 001713   050001 713400                    CLIMB   close
         6 001714   406000 401760                    pmme    nvectors=13
         6 001715   001716 710000 6                  TRA     s:3582

      566     3576    2           CASE(%DEVHIST);

      567     3577    2           CASE(%MEDHIST);

      568     3578    2              /* DO NOTHING */;
      569     3579    2           CASE(%OCHIST);

      570     3580    2              /* DO NOTHING */;
      571     3581    2        END;                               /* DO CASE FILE                       */

      572     3582    1        ALTRETURN;

   3582  6 001716   000000 702200 xent               TSX2  ! X66_AALT

      573     3583    1   THG$CLOSE: ENTRY ALTRET;

   3583  6 001717   000000 700200 xent  THG$CLOSE    TSX0  ! X66_AUTO_4
         6 001720   000046 000004                    ZERO    38,4

      574     3584    1        CALL M$CLOSE(CLOSE_DEVHIST);

   3584  6 001721   000114 630400 4                  EPPR0   CLOSE_DEVHIST
         6 001722   050001 713400                    CLIMB   close
         6 001723   406000 401760                    pmme    nvectors=13
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:77   

      575     3585    1        RETURN;

   3585  6 001724   000000 702200 xent               TSX2  ! X66_ARET
      576     3586    1   END THG$GETREC;
      577     3587        %EOD;

PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:78   
--  Include file information  --

   EL_SUBS_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   EL$TABLES.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THG$GETREC.
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:79   

 **** Variables and constants ****

  ****  Section 004 RoData THG$GETREC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/c CHAR(38)    r     1 CHAR_VEC                 244-0-0/d STRC(1080)  r     1 CLOSE_CONFIG
   114-0-0/d STRC(1080)  r     1 CLOSE_DEVHIST            305-0-0/c STRC(72)    r     1 CONFIG
   302-0-0/c STRC(81)    r     1 DEVHIST                   15-0-0/b BIT (18)    r     1 HEAD_KEY
     2-0-0/w PTR         r     1 INFO$                     17-0-0/b BIT (18)    r     1 MAINT_KEY
     0-0-0/c CHAR(8)     r     1 MEM_TEXT                 152-0-0/d STRC(2088)  r     1 OPEN_CONFIG
    22-0-0/d STRC(2088)  r     1 OPEN_DEVHIST             314-0-0/d STRC(504)   r     1 READ_ERRLOG
   311-0-0/c STRC(72)    r     1 SYSACCT                   16-0-0/b BIT (18)    r     1 THRESH_KEY
     3-0-0/b UBIN(9)     r     1 TYPE_VEC(0:37)
    20-0-0/b BIT (18)    r     1 UTS_KEY

  ****  Section 005  Data  THG$GETREC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(81)    r     1 CONFIG_KEY                 3-0-0/w STRC(117)   r     1 DEVHIST_KEY8
    66-0-0/d STRC(360)   r     1 ERRLOG_PRECORD            11-0-0/w STRC(72)    r     1 FEPNAME
    50-0-0/d STRC(144)   r     1 FPT_PFIL                  54-0-0/d STRC(360)   r     1 PRECORD
    32-0-0/d STRC(504)   r     1 READ_CONFIG               14-0-0/d STRC(504)   r     1 READ_DEVHIST
   100-0-0/w UBIN        r     1 RECORD_BUF(0:1028)
     7-0-0/c CHAR(8)     r     1 RET_KEY                  100-0-0/w STRC(37044) r     1 TH_RECORD_BUF

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w PTR         r     1 @DONT_CLOSE                3-0-0/w PTR         r     1 @FILE
     4-0-0/w PTR         r     1 @KEY_NAME                  5-0-0/w PTR         r     1 @UTS
    35-0-0/c CHAR        r     1 CHAN_CHAR                 36-0-0/w UBIN        r     1 CHAN_NUM
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:80   
    *0-0-0/w SBIN        r     1 DONT_CLOSE                23-0-0/c CHAR(3)     r     1 FEPERR_CODE
    22-0-0/b STRC(18)    r     1 FEPERR_CODE_F_M
    22-0-0/b BIT (6)     r     1 FEPERR_FCG(0:2)
    25-0-0/b UBIN(6)     r     1 FEP_FCG                   24-0-0/w UBIN        r     1 FEP_FCG_W
    *0-0-0/w UBIN        r     1 FILE                      40-0-0/b BIT         r     1 FOUND
    33-0-0/b UBIN(16)    r     1 HEXNUM                    17-0-0/w SBIN        r     1 I
     7-0-0/b UBIN(8)     r     1 IO_MASK(0:35)              7-0-0/b BIT         r     1 IO_MASK1(0:287)
    37-0-0/w SBIN        r     1 J                         *0-0-0/c CHAR(8)     r     1 KEY_NAME
    26-0-0/w PTR         r     1 M$CONFIG$                 27-0-0/w PTR         r     1 M$DEVHIST$
    20-0-0/b BIT         r     1 PASSED_FLAG               30-0-0/w PTR         r     1 TEMP$
    31-0-0/c CHAR(5)     r     1 TEMPNUM                   34-0-0/b STRC(16)    r     1 TERMINAL_CHAN
    *0-0-0/w UBIN        r     1 UTS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/c STRC(72)    r     1 DEVHIST_ACCT
     0-0-0/b BIT         r     1 TH_BOF                     0-0-0/b BIT         r     1 TH_CHANGE_FILE
     0-0-0/b BIT         r     1 TH_CHECK_DEVNM             0-0-0/d STRC(1080)  r     1 TH_CLOSE_ERRLOG
     0-0-0/d STRC(1971)  r     1 TH_CONSTRAINTS             0-0-0/b BIT         r     1 TH_FEPERR_M_OR_E_SET
     0-0-0/b BIT         r     1 TH_FIERR_E_SET             0-0-0/b BIT         r     1 TH_FIERR_M_SET
     0-0-0/d STRC(72)    r     1 TH_INFO                    0-0-0/b BIT         r     1 TH_IOERR_E_BY_B_SET
     0-0-0/b BIT         r     1 TH_IOERR_E_SET             0-0-0/b BIT         r     1 TH_IOERR_M_BY_B_SET
     0-0-0/b BIT         r     1 TH_IOERR_M_OR_E_SET        0-0-0/b BIT         r     1 TH_IOERR_M_SET
     0-0-0/w UBIN        r     1 TH_ITYPE                   0-0-0/w UBIN        r     1 TH_LASTUTS
     0-0-0/w STRC(1080)  r     1 TH_LAST_MATCH              0-0-0/w UBIN        r     1 TH_LAST_REQID
     0-0-0/c STRC(37)    r     1 TH_M_CHAN(0:9)
     0-0-0/w UBIN(5)     r     1 TH_M_CHAN_TOTAL            0-0-0/d STRC(2088)  r     1 TH_OPEN_ERRLOG
     0-0-0/d STRC(72)    r     1 TH_RECORD                  0-0-0/d STRC(504)   r     1 TH_XSA_PARAM

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:81   
     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/c CHAR(8)     r     1 CHAR_BASE                  0-0-0/w STRC(756)   r     1 EL$DEVSTATS
     0-0-0/w STRC(180)   r     1 EL$FECRASH                 0-0-0/w STRC(1521)  r     1 EL$FEPDUMP
     0-0-0/w STRC(1224)  r     1 EL$FEPERR                  0-0-0/w STRC(72)    r     1 EL$FEPFLT
     0-0-0/w STRC(1044)  r     1 EL$FILERR                  0-0-0/w STRC(73)    r     1 EL$FWLOAD
     0-0-0/w STRC(1080)  r     1 EL$IOERR                   0-0-0/w STRC(1332)  r     1 EL$MPCSTATS
     0-0-0/w STRC(252)   r     1 EL$MTDMT                   0-0-0/d STRC(468)   r     1 EL$SCREECH
     0-0-0/w STRC(306)   r     1 EL$SYSCON                  0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$CFG                      0-0-0N  NULL        r     1 M$DEVHIST
     0-0-0N  NULL        r     1 M$ERRLOG


   Procedure THG$GETREC requires 981 words for executable code.
   Procedure THG$GETREC requires 38 words of local(AUTO) storage.
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:82   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:83   
          MINI XREF LISTING

B$ALT.CODE
      3154**DCL      3154--REDEF    3155--REDEF    3155--REDEF
B$ALT.ERR.CODE
      3156**DCL      3519>>IF       3534>>IF       3555>>IF
B$ALT.ERR.ERR#
      3156**DCL      3156--REDEF
B$ALT.EVID
      3155**DCL      3155--REDEF    3155--REDEF
B$TCB.ALT$
      3150**DCL      3519>>IF       3534>>IF       3555>>IF
B$TCB$
      2200**DCL      3519>>IF       3534>>IF       3555>>IF
BAG_IT
      3570**LABEL    3200--CALLALT  3205--CALLALT  3493--CALLALT  3494--CALLALT  3501--CALLALT  3520--GOTO
      3544--GOTO     3556--GOTO
CHAN_CHAR
      2252**DCL      3411<<ASSIGN   3412>>CALLBLT  3413>>IF       3413>>IF       3413>>IF       3413>>IF
      3413>>IF       3413>>IF       3431<<ASSIGN   3432>>CALLBLT  3433>>IF       3433>>IF       3433>>IF
      3433>>IF       3433>>IF       3433>>IF
CHAN_NUM
      2253**DCL      3412<<CALLBLT  3416<<ASSIGN   3416>>ASSIGN   3417>>ASSIGN   3432<<CALLBLT  3436<<ASSIGN
      3436>>ASSIGN   3437>>ASSIGN
CHAR_BASE
      2217**DCL      3286>>IF
CHAR_VEC
      2230**DCL      3217>>CALLBLT
CLOSE_CONFIG
      2799**DCL      3496<>CALL     3575<>CALL
CLOSE_CONFIG.SN_
      2799**DCL      2799--REDEF
CLOSE_CONFIG.UTL_
      2800**DCL      2800--REDEF
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:84   
CLOSE_CONFIG.V
      2804**DCL      2799--DCLINIT
CLOSE_CONFIG.V.EXPIRE#
      2814**DCL      2814--REDEF
CLOSE_CONFIG.V.TYPE#
      2812**DCL      2812--REDEF
CLOSE_CONFIG.V.XTNSIZE#
      2809**DCL      2809--REDEF    2811--REDEF
CLOSE_DEVHIST
      2442**DCL      3584<>CALL
CLOSE_DEVHIST.SN_
      2442**DCL      2442--REDEF
CLOSE_DEVHIST.UTL_
      2443**DCL      2443--REDEF
CLOSE_DEVHIST.V
      2447**DCL      2442--DCLINIT
CLOSE_DEVHIST.V.EXPIRE#
      2457**DCL      2457--REDEF
CLOSE_DEVHIST.V.TYPE#
      2455**DCL      2455--REDEF
CLOSE_DEVHIST.V.XTNSIZE#
      2452**DCL      2452--REDEF    2454--REDEF
CONFIG
      2874**DCL      2535--DCLINIT
CONFIG_KEY
      2232**DCL      3490--ASSIGN
CONFIG_KEY.C
      2233**DCL      3475<<ASSIGN   3483<<ASSIGN   3487<<ASSIGN
CONFIG_KEY.TXT
      2234**DCL      3489<<ASSIGN
DEVHIST
      2845**DCL      2331--DCLINIT
DEVHIST_ACCT
      2052**DCL      2335--DCLINIT
DEVHIST_KEY8
      2235**DCL      3532--ASSIGN   3551--ASSIGN
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:85   
DEVHIST_KEY8.C
      2236**DCL      3529<<ASSIGN   3538>>IF
DEVHIST_KEY8.TXT
      2237**DCL      3530<<ASSIGN   3537>>ASSIGN   3549<<ASSIGN
DEVHIST_KEY8.UTS
      2238**DCL      3531<<ASSIGN   3550<<ASSIGN
DONT_CLOSE
        13**DCL         7--PROC
EL$DEVSTATS.DEVNM
      3050**DCL      3253--ASSIGN
EL$FECRASH.FENM.FEP#
      3136**DCL      3263>>CALLBLT
EL$FEPDUMP.FEP
      3140**DCL      3271>>CALLBLT
EL$FEPERR.STATDATA.ERRCODE.FCG
      3082**DCL      3358>>ASSIGN
EL$FEPERR.STATDATA.ERRCODE.MID
      3095**DCL      3359>>ASSIGN
EL$FEPERR.STATDATA.NODE
      3053**DCL      3260>>CALLBLT
EL$FEPERR.STATDATA.TERMID.TERM
      3118**DCL      3127--REDEF
EL$FEPERR.STATDATA.TERMID.TERM.CHANNEL.BYT
      3120**DCL      3404>>ASSIGN   3405>>ASSIGN
EL$FEPFLT.FEP#
      3132**DCL      3257>>CALLBLT
EL$FILERR.ACTION
      3030**DCL      3293>>IF       3303>>IF
EL$FILERR.CODE
      3030**DCL      3293>>IF       3303>>IF
EL$FILERR.DEVNM
      3033**DCL      3241--ASSIGN
EL$FILERR.REASON
      3030**DCL      3293>>IF       3303>>IF
EL$FWLOAD.DEVNM
      3037**DCL      3243--ASSIGN
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:86   
EL$IOERR.DEVNM
      3025**DCL      3245--ASSIGN
EL$IOERR.EXTST
      3024**DCL      3325>>ASSIGN   3344>>ASSIGN
EL$IOERR.SEEK
      3024**DCL      3025--REDEF
EL$IOERR.SN
      3025**DCL      3316>>IF       3335>>IF
EL$IOERR.STATUS
      3020**DCL      3021--REDEF
EL$IOERR.XSTATUS.MAJOR
      3021**DCL      3316>>IF       3335>>IF
EL$IOERR.XSTATUS.MINOR
      3021**DCL      3316>>IF       3335>>IF
EL$MPCSTATS.MPCNAME
      3047**DCL      3251--ASSIGN
EL$MTDMT.DEVNAME
      3040**DCL      3247--ASSIGN
EL$SCREECH.SCODE.ERR.SEV
      3144**DCL      3274>>IF
EL$SCREECH.SNAPU#
      3144**DCL      3279>>CALLBLT
EL$SYSCON.DEVNM
      3043**DCL      3249--ASSIGN
ERRLOG_EOF
      3455**LABEL    3224--GOTO
ERRLOG_PRECORD
      3000**DCL      3204<>CALL
ERRLOG_PRECORD.V
      3002**DCL      3000--DCLINIT
F$DCB.ACTPOS
       447**DCL       447--REDEF
F$DCB.ARS
       422**DCL       422--REDEF    3495>>ASSIGN   3561>>ASSIGN
F$DCB.ATTR
       440**DCL       441--REDEF
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:87   
F$DCB.BORROW
       455**DCL       455--REDEF     455--REDEF     455--REDEF
F$DCB.DCBNAME.L
       469**DCL       469--IMP-SIZ
F$DCB.EOMCHAR
       426**DCL       426--REDEF
F$DCB.FCD
       435**DCL      3492>>IF       3500>>IF       3574>>IF
F$DCB.FLDID
       450**DCL       450--REDEF
F$DCB.FORM$
       444**DCL       444--REDEF
F$DCB.FSECT
       460**DCL       460--REDEF
F$DCB.FSN
       437**DCL       437--REDEF     437--REDEF     438--REDEF
F$DCB.HEADER$
       443**DCL       443--REDEF
F$DCB.IXTNSIZE
       441**DCL       441--REDEF
F$DCB.LASTSTA$
       431**DCL       431--REDEF
F$DCB.LVL
       456**DCL       456--REDEF
F$DCB.NAME.C
       431**DCL       431--REDEF
F$DCB.NOEOF
       452**DCL       452--REDEF
F$DCB.NRECS
       442**DCL       442--REDEF
F$DCB.NRECX
       461**DCL       461--REDEF
F$DCB.OHDR
       453**DCL       453--REDEF
F$DCB.ORG
       436**DCL       436--REDEF
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:88   
F$DCB.PRECNO
       459**DCL       459--REDEF
F$DCB.RCSZ
       464**DCL       464--REDEF
F$DCB.RES
       432**DCL       432--REDEF
F$DCB.SETX
       444**DCL       444--REDEF
F$DCB.TAB$
       443**DCL       444--REDEF
F$DCB.TDA
       458**DCL       458--REDEF
F$DCB.WSN
       433**DCL       433--REDEF
FEPERR_CODE
      2211**DCL      3365<<ASSIGN   3369<<CALLBLT  3380>>IF       3394<<ASSIGN   3398<<CALLBLT  3400>>IF
FEPERR_CODE_F_M
      2207**DCL      2210--REDEF
FEPERR_CODE_F_M.FCG
      2208**DCL      3358<<ASSIGN
FEPERR_CODE_F_M.MID
      2209**DCL      3359<<ASSIGN
FEPERR_FCG
      2210**DCL      3367>>ASSIGN   3396>>ASSIGN
FEPNAME
      2244**DCL      3269--ASSIGN
FEPNAME.FEP#
      2246**DCL      3268<<CALLBLT
FEPNM
      3264**LABEL    3258--GOTO     3261--GOTO     3272--GOTO     3280--GOTO
FEP_FCG
      2213**DCL      3368<<ASSIGN   3369>>CALLBLT  3397<<ASSIGN   3398>>CALLBLT
FEP_FCG_W
      2212**DCL      3367<<ASSIGN   3368>>ASSIGN   3396<<ASSIGN   3397>>ASSIGN
FILE
        10**DCL         7--PROC     3193>>DOCASE   3570>>DOCASE
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:89   
FOUND
      2255**DCL      3403<<ASSIGN   3420<<ASSIGN   3422>>IF       3424<<ASSIGN
FOUND_FEP
      3379**LABEL    3381--GOTO
FOUND_NTYPES
      3227**LABEL    3232--GOTO
FPT_PFIL
      2961**DCL      3199<>CALL     3203<>CALL
FPT_PFIL.V
      2961**DCL      2961--DCLINIT
FPT_PFIL.V.BOF#
      2962**DCL      3198<<ASSIGN   3202<<ASSIGN
HEAD_KEY
      2239**DCL      3468--ASSIGN   3506--ASSIGN
HEXNUM
      2248**DCL      3409<<ASSIGN   3417<<ASSIGN   3417>>ASSIGN   3419>>IF       3429<<ASSIGN   3437<<ASSIGN
      3437>>ASSIGN   3439>>IF
I
      2203**DCL      3230<<DOINDEX  3231>>IF       3264<<ASSIGN   3265>>DOWHILE  3265>>DOWHILE  3266<<ASSIGN
      3266>>ASSIGN   3268>>CALLBLT  3326<<DOINDEX  3327>>IF       3327>>IF       3327>>IF       3345<<DOINDEX
      3346>>IF       3346>>IF       3346>>IF       3366<<DOINDEX  3367>>ASSIGN   3369>>CALLBLT  3371<<ASSIGN
      3373>>DOWHILE  3374<<CALLBLT  3374>>CALLBLT  3375<<ASSIGN   3375>>ASSIGN   3376>>DOWHILE  3377<<ASSIGN
      3377>>ASSIGN   3379>>ASSIGN   3383<<ASSIGN   3383>>ASSIGN   3384>>ASSIGN   3395<<DOINDEX  3396>>ASSIGN
      3398>>CALLBLT  3410<<DOINDEX  3411>>ASSIGN   3430<<DOINDEX  3431>>ASSIGN
INFO$
      2214**DCL      3020--IMP-PTR  3030--IMP-PTR  3037--IMP-PTR  3040--IMP-PTR  3043--IMP-PTR  3047--IMP-PTR
      3050--IMP-PTR  3053--IMP-PTR  3132--IMP-PTR  3135--IMP-PTR  3140--IMP-PTR  3144--IMP-PTR  3241>>ASSIGN
      3243>>ASSIGN   3245>>ASSIGN   3247>>ASSIGN   3249>>ASSIGN   3251>>ASSIGN   3253>>ASSIGN   3257>>CALLBLT
      3260>>CALLBLT  3263>>CALLBLT  3271>>CALLBLT  3274>>IF       3279>>CALLBLT  3293>>IF       3293>>IF
      3293>>IF       3303>>IF       3303>>IF       3303>>IF       3316>>IF       3316>>IF       3316>>IF
      3325>>ASSIGN   3335>>IF       3335>>IF       3335>>IF       3344>>ASSIGN   3358>>ASSIGN   3359>>ASSIGN
      3404>>ASSIGN   3405>>ASSIGN
IO_MASK
      2201**DCL      2202--REDEF    3325<<ASSIGN   3344<<ASSIGN
IO_MASK1
      2202**DCL      3327>>IF       3346>>IF
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:90   
J
      2254**DCL      3372<<ASSIGN   3375>>ASSIGN   3384<<ASSIGN   3408<<DOINDEX  3411>>ASSIGN   3419>>IF
KEY_NAME
        11**DCL         7--PROC     3465>>IF       3472>>IF       3478>>IF       3478>>IF       3478>>IF
      3489>>ASSIGN   3505>>IF       3508>>IF       3511>>IF       3514>>IF       3530>>ASSIGN   3538>>IF
      3549>>ASSIGN
L1
      3519**LABEL    3517--CALLALT
L3
      3555**LABEL    3552--CALLALT
M$CFG
      2197**DCL      3463--ASSIGN
M$CLOSE
       349**DCL-ENT  3496--CALL     3575--CALL     3584--CALL
M$CONFIG$
      2215**DCL      3463<<ASSIGN   3492>>IF       3495>>ASSIGN   3574>>IF
M$DEVHIST
      2196**DCL      3498--ASSIGN
M$DEVHIST$
      2216**DCL      3498<<ASSIGN   3500>>IF       3561>>ASSIGN
M$OPEN
       349**DCL-ENT  3493--CALL     3501--CALL
M$PFIL
       351**DCL-ENT  3199--CALL     3203--CALL
M$PRECORD
       353**DCL-ENT  3204--CALL     3533--CALL
M$READ
       350**DCL-ENT  3200--CALL     3205--CALL     3494--CALL     3517--CALL     3542--CALL     3552--CALL
MAINT_KEY
      2241**DCL      3512--ASSIGN
MEM_TEXT
      2204**DCL      3255--ASSIGN
NOT_EXCLUDED
      3348**LABEL    3309--GOTO     3341--GOTO     3348--GOTO
NOT_PASSED
      3440**LABEL    3222--GOTO     3234--GOTO     3282--GOTO     3284--GOTO     3287--GOTO     3299--GOTO
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:91   
      3310--GOTO     3322--GOTO     3329--GOTO     3351--GOTO     3386--GOTO     3401--GOTO     3425--GOTO
      3440--GOTO
NO_KEY
      3534**LABEL    3533--CALLALT
OPEN_CONFIG
      2534**DCL      3493<>CALL
OPEN_CONFIG.ACSVEH_
      2536**DCL      2537--REDEF
OPEN_CONFIG.ALTKEYS_
      2542**DCL      2543--REDEF    2543--REDEF
OPEN_CONFIG.HDR_
      2541**DCL      2542--REDEF
OPEN_CONFIG.TAB_
      2540**DCL      2541--REDEF
OPEN_CONFIG.UHL_
      2534**DCL      2535--REDEF    2535--REDEF
OPEN_CONFIG.V
      2543**DCL      2534--DCLINIT
OPEN_CONFIG.V.FSN#
      2574**DCL      2574--REDEF    2574--REDEF
OPEN_CONFIG.WSN_
      2540**DCL      2540--REDEF
OPEN_DEVHIST
      2330**DCL      3501<>CALL
OPEN_DEVHIST.ACSVEH_
      2332**DCL      2333--REDEF
OPEN_DEVHIST.ALTKEYS_
      2338**DCL      2339--REDEF    2339--REDEF
OPEN_DEVHIST.HDR_
      2337**DCL      2338--REDEF
OPEN_DEVHIST.TAB_
      2336**DCL      2337--REDEF
OPEN_DEVHIST.UHL_
      2330**DCL      2331--REDEF    2331--REDEF
OPEN_DEVHIST.V
      2339**DCL      2330--DCLINIT
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:92   
OPEN_DEVHIST.V.FSN#
      2370**DCL      2370--REDEF    2370--REDEF
OPEN_DEVHIST.WSN_
      2336**DCL      2336--REDEF
PASSED_FLAG
      2205**DCL      3195<<ASSIGN   3215>>DOWHILE  3218<<ASSIGN   3445<<ASSIGN
PRECORD
      2979**DCL      3533<>CALL
PRECORD.KEY_
      2979**DCL      3532<<ASSIGN
PRECORD.V
      2981**DCL      2979--DCLINIT
READ_CONFIG
      2752**DCL      3494<>CALL
READ_CONFIG.KEY_
      2752**DCL      3468<<ASSIGN   3490<<ASSIGN
READ_CONFIG.STATION_
      2755**DCL      2756--REDEF
READ_CONFIG.V
      2756**DCL      2752--DCLINIT
READ_CONFIG.V.DVBYTE.REREAD#
      2767**DCL      2767--REDEF
READ_CONFIG.V.INDX#
      2765**DCL      2765--REDEF
READ_DEVHIST
      2395**DCL      3517<>CALL     3542<>CALL     3552<>CALL
READ_DEVHIST.KEY_
      2395**DCL      3506<<ASSIGN   3509<<ASSIGN   3512<<ASSIGN   3515<<ASSIGN   3516<<ASSIGN   3551<<ASSIGN
READ_DEVHIST.STATION_
      2398**DCL      2399--REDEF
READ_DEVHIST.V
      2399**DCL      2395--DCLINIT
READ_DEVHIST.V.DVBYTE.REREAD#
      2410**DCL      2410--REDEF
READ_DEVHIST.V.INDX#
      2408**DCL      2408--REDEF
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:93   
READ_DEVHIST.V.KEYS#
      2400**DCL      3541<<ASSIGN   3562<<ASSIGN
READ_ERR
      3454**LABEL    3216--CALLALT
READ_ERRLOG
      2926**DCL      3200<>CALL     3205<>CALL     3216<>CALL
READ_ERRLOG.STATION_
      2929**DCL      2930--REDEF
READ_ERRLOG.V
      2930**DCL      2926--DCLINIT
READ_ERRLOG.V.DVBYTE.REREAD#
      2941**DCL      2941--REDEF
READ_ERRLOG.V.INDX#
      2939**DCL      2939--REDEF
RECORD_BUF
      3018**DCL      2397--DCLINIT  2398--DCLINIT  2754--DCLINIT  2755--DCLINIT  3464--ASSIGN   3499--ASSIGN
RET_KEY
      2243**DCL      3537<<ASSIGN   3538>>IF
SYSACCT
      2904**DCL      2539--DCLINIT
TEMP$
      2218**DCL      3241<<ASSIGN   3243<<ASSIGN   3245<<ASSIGN   3247<<ASSIGN   3249<<ASSIGN   3251<<ASSIGN
      3253<<ASSIGN   3255<<ASSIGN   3269<<ASSIGN   3286>>IF
TEMPNUM
      2247**DCL      3257<<CALLBLT  3260<<CALLBLT  3263<<CALLBLT  3265>>DOWHILE  3268>>CALLBLT  3271<<CALLBLT
      3279<<CALLBLT
TERMINAL_CHAN
      2249**DCL      3419>>IF       3439>>IF
TERMINAL_CHAN.A
      2250**DCL      3404<<ASSIGN
TERMINAL_CHAN.B
      2251**DCL      3405<<ASSIGN
THM$ERRMSG
      2187**DCL-ENT  3521--CALL     3557--CALL
THRESH_KEY
      2240**DCL      3509--ASSIGN
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:94   
TH_BOF
      2015**DCL      3209>>IF       3211<<ASSIGN
TH_CHANGE_FILE
      2054**DCL      3196>>IF
TH_CHECK_DEVNM
      2025**DCL      3237>>IF
TH_CLOSE_ERRLOG
      2712**DCL      3212<>CALL
TH_CLOSE_ERRLOG.SN_
      2712**DCL      2712--REDEF
TH_CLOSE_ERRLOG.UTL_
      2713**DCL      2713--REDEF
TH_CLOSE_ERRLOG.V.EXPIRE#
      2727**DCL      2727--REDEF
TH_CLOSE_ERRLOG.V.TYPE#
      2725**DCL      2725--REDEF
TH_CLOSE_ERRLOG.V.XTNSIZE#
      2722**DCL      2722--REDEF    2724--REDEF
TH_CONSTRAINTS.DEVNM
      1987**DCL      3274>>IF       3286>>IF
TH_CONSTRAINTS.E_ACT
      1994**DCL      3303>>IF
TH_CONSTRAINTS.E_ACT_SET
      1994**DCL      3303>>IF
TH_CONSTRAINTS.E_BY_B
      1990**DCL      1990--REDEF
TH_CONSTRAINTS.E_BY_B_SET
      1991**DCL      3346>>IF
TH_CONSTRAINTS.E_BY_B_VEC
      1990**DCL      3346>>IF
TH_CONSTRAINTS.E_CHAN
      1992**DCL      3431>>ASSIGN
TH_CONSTRAINTS.E_CHAN_SET
      1992**DCL      3427>>IF
TH_CONSTRAINTS.E_COD
      1993**DCL      3303>>IF
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:95   
TH_CONSTRAINTS.E_COD_SET
      1993**DCL      3303>>IF
TH_CONSTRAINTS.E_FEP
      1992**DCL      3400>>IF
TH_CONSTRAINTS.E_FEP_N
      1992**DCL      3391>>IF       3391>>IF       3395>>DOINDEX
TH_CONSTRAINTS.E_FEP_SET
      1992**DCL      3389>>IF
TH_CONSTRAINTS.E_MAJ
      1989**DCL      3335>>IF
TH_CONSTRAINTS.E_MAJ_S
      1990**DCL      3335>>IF
TH_CONSTRAINTS.E_MED
      1990**DCL      3335>>IF
TH_CONSTRAINTS.E_MED_S
      1990**DCL      3335>>IF
TH_CONSTRAINTS.E_REA
      1993**DCL      3303>>IF
TH_CONSTRAINTS.E_REA_SET
      1994**DCL      3303>>IF
TH_CONSTRAINTS.E_SUB
      1990**DCL      3335>>IF
TH_CONSTRAINTS.E_SUB_S
      1990**DCL      3335>>IF
TH_CONSTRAINTS.M_ACT
      1993**DCL      3293>>IF
TH_CONSTRAINTS.M_ACT_SET
      1993**DCL      3293>>IF
TH_CONSTRAINTS.M_BY_B
      1989**DCL      1989--REDEF
TH_CONSTRAINTS.M_BY_B_SET
      1989**DCL      3327>>IF
TH_CONSTRAINTS.M_BY_B_VEC
      1989**DCL      3327>>IF
TH_CONSTRAINTS.M_CHAN_SET
      1991**DCL      3406>>IF
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:96   
TH_CONSTRAINTS.M_COD
      1992**DCL      3293>>IF
TH_CONSTRAINTS.M_COD_SET
      1992**DCL      3293>>IF
TH_CONSTRAINTS.M_FEP
      1991**DCL      3379<<ASSIGN   3380>>IF
TH_CONSTRAINTS.M_FEP_N
      1991**DCL      3362>>IF       3362>>IF       3366>>DOINDEX
TH_CONSTRAINTS.M_FEP_SET
      1991**DCL      3360>>IF
TH_CONSTRAINTS.M_MAJ
      1988**DCL      3316>>IF
TH_CONSTRAINTS.M_MAJ_S
      1988**DCL      3316>>IF
TH_CONSTRAINTS.M_MED
      1988**DCL      3316>>IF
TH_CONSTRAINTS.M_MED_S
      1989**DCL      3316>>IF
TH_CONSTRAINTS.M_REA
      1993**DCL      3293>>IF
TH_CONSTRAINTS.M_REA_SET
      1993**DCL      3293>>IF
TH_CONSTRAINTS.M_SUB
      1988**DCL      3316>>IF
TH_CONSTRAINTS.M_SUB_S
      1988**DCL      3316>>IF
TH_CONSTRAINTS.NTYPES
      1987**DCL      3227>>IF       3230>>DOINDEX
TH_CONSTRAINTS.START
      1988**DCL      3201<<ASSIGN   3221>>IF
TH_CONSTRAINTS.STOP
      1988**DCL      3206<<ASSIGN   3223>>IF
TH_CONSTRAINTS.TYPES
      1987**DCL      1987--REDEF
TH_CONSTRAINTS.TYPESC
      1987**DCL      3231>>IF
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:97   
TH_DEFAULT.E_BY_B
      1998**DCL      1998--REDEF
TH_DEFAULT.M_BY_B
      1997**DCL      1997--REDEF
TH_DEFAULT.TYPES
      1995**DCL      1995--REDEF
TH_FEPERR_M_OR_E_SET
      2024**DCL      3355>>IF
TH_FIERR_E_SET
      2025**DCL      3301>>IF
TH_FIERR_M_SET
      2025**DCL      3291>>IF
TH_INFO.BOUND
      2016**DCL      3449<<ASSIGN
TH_IOERR_E_BY_B_SET
      2023**DCL      3342>>IF
TH_IOERR_E_SET
      2024**DCL      3333>>IF
TH_IOERR_M_BY_B_SET
      2023**DCL      3323>>IF
TH_IOERR_M_OR_E_SET
      2024**DCL      3312>>IF
TH_IOERR_M_SET
      2024**DCL      3314>>IF
TH_ITYPE
      2017**DCL      3217<<CALLBLT  3239>>DOCASE   3291>>IF       3301>>IF       3312>>IF       3355>>IF
TH_LASTUTS
      2017**DCL      3450<<ASSIGN
TH_LAST_MATCH.COUNT
      2020**DCL      3373>>DOWHILE
TH_LAST_MATCH.TEXT
      2020**DCL      3374>>CALLBLT  3376>>DOWHILE  3379>>ASSIGN
TH_LAST_REQID
      2021**DCL      3454<<ASSIGN
TH_M_CHAN.FLAG
      2055**DCL      3419>>IF
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:98   
TH_M_CHAN.TEXT
      2055**DCL      3411>>ASSIGN
TH_M_CHAN_TOTAL
      2055**DCL      3408>>DOINDEX
TH_OPEN_ERRLOG
      2644**DCL      3213<>CALL
TH_OPEN_ERRLOG.ACSVEH_
      2646**DCL      2647--REDEF
TH_OPEN_ERRLOG.ALTKEYS_
      2652**DCL      2653--REDEF    2653--REDEF
TH_OPEN_ERRLOG.HDR_
      2651**DCL      2652--REDEF
TH_OPEN_ERRLOG.TAB_
      2650**DCL      2651--REDEF
TH_OPEN_ERRLOG.UHL_
      2644**DCL      2645--REDEF    2645--REDEF
TH_OPEN_ERRLOG.V.FSN#
      2684**DCL      2684--REDEF    2684--REDEF
TH_OPEN_ERRLOG.WSN_
      2650**DCL      2650--REDEF
TH_RECORD
      2015**DCL      3464<<ASSIGN   3499<<ASSIGN
TH_RECORD.BOUND
      2015**DCL      3448<<ASSIGN   3495<<ASSIGN   3561<<ASSIGN
TH_RECORD_BUF
      3015**DCL      2928--DCLINIT  2929--DCLINIT  3018--REDEF
TH_RECORD_BUF.INFO
      3016**DCL      2214--DCLINIT
TH_RECORD_BUF.TYPE
      3015**DCL      3015--REDEF    3217>>CALLBLT
TH_RECORD_BUF.TYPEC
      3015**DCL      3231>>IF
TH_RECORD_BUF.UTS
      3015**DCL      3201>>ASSIGN   3206>>ASSIGN   3221>>IF       3223>>IF       3450>>ASSIGN
TH_SAVE.E_BY_B
      2006**DCL      2006--REDEF
PL6.E3A0      #001=THG$GETREC File=THG$GETREC.:E05TSI                            WED 07/30/97 06:13 Page:99   
TH_SAVE.M_BY_B
      2004**DCL      2004--REDEF
TH_SAVE.TYPES
      2002**DCL      2003--REDEF
TH_XSA_BUF_VECTOR
      2022**DCL      2022--REDEF
TH_XSA_PARAM
      3169**DCL      3212<>CALL     3213<>CALL     3216<>CALL
TH_XSA_PARAM.ARS#
      3173**DCL      3448>>ASSIGN   3449>>ASSIGN
TH_XSA_PARAM.EOMCHAR#
      3185**DCL      3186--REDEF
TH_XSA_PARAM.ERR
      3173**DCL      3452<>CALL     3457<>CALL
TH_XSA_PARAM.ERR.CODE
      3174**DCL      3455>>IF
TH_XSA_PARAM.SIG1
      3179**DCL      3179--REDEF
TH_XSA_PARAM.SIG2
      3179**DCL      3180--REDEF
TYPE_VEC
      2219**DCL      2230--REDEF
UTS
        12**DCL         7--PROC     3502--IF       3526>>IF       3550>>ASSIGN
UTS_KEY
      2242**DCL      3515--ASSIGN
XSA$CLOSE
      2191**DCL-ENT  3212--CALL
XSA$OPEN
      2190**DCL-ENT  3213--CALL
XSA$READ
      2189**DCL-ENT  3216--CALL
XSA_ERR
      3452**LABEL    3212--CALLALT  3213--CALLALT
XUR$ERRMSG
      2192**DCL-ENT  3452--CALL     3457--CALL

PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:100  
      578        1        /*M* THG$OPENXSA - ROUTINES TO USE FAST SEQUENTIAL FILE ACCESS FOR ELAN  */
      579        2        /*T***********************************************************/
      580        3        /*T*                                                         */
      581        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      582        5        /*T*                                                         */
      583        6        /*T***********************************************************/
      584        7        THG$OPENXSA: PROC(ERRLOG_DATE) ALTRET;
      585        8    1   DCL ERRLOG_DATE UBIN;
      586        9    1   DCL TEMP_UTS UBIN;
      587       10    1   DCL TEMP_DATE CHAR(8);
      588       11        /**/
      589       12        /* INCLUDE FILES */
      590       13        %INCLUDE CP_6;
      591       94        %INCLUDE CP_6_SUBS;
      592      634        %INCLUDE EL$TABLES;
      593      957        %INCLUDE F$DCB;
      594     1006        %INCLUDE TH_DATA_R;
      595     1084        %INCLUDE TH_SUBS_C;
      596     1466        %INCLUDE XS_MACRO_C;
      597     1510        %INCLUDE XUD_UTS_M;
      598     1592        /**/
      599     1593        /* ENTRY DEFS */
      600     1594    1   DCL THM$ERRMSG ENTRY(1);
      601     1595    1   DCL XSA$OPEN ENTRY(2) ALTRET;
      602     1596    1   DCL XSA$PRECORD ENTRY(2) ALTRET;
      603     1597    1   DCL XSA$CLOSE ENTRY(2) ALTRET;
      604     1598    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
      605     1599        /**/
      606     1600        /* DCBS */
      607     1601    1   DCL M$ERRLOG DCB;
      608     1602        /**/
      609     1603        /* VARIABLES */
      610     1604    1   DCL ERRLOGDATE UBIN STATIC;
      611     1605    1   DCL ANSDATE CHAR(6) STATIC;
      612     1606    1   DCL TODAYDATE CHAR(6) STATIC;
      613     1607    1   DCL 1 FSF_BUF BASED(TH_XSA_BUF.P$),
      614     1608    1         2 KEYS (0:1023) UBIN,
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:101  
      615     1609    1         2 DATA (0:1023) UBIN;
      616     1610        /**/
      617     1611        /* MACRO INVOCATIONS */
      618     1612        %XSA_PARAM (FPTN=TH_XSA_PARAM,
      619     1613                    STCLASS="STATIC SYMDEF");
      620     1643        %EL$ENTRY (NAME=TH_RECORD_BUF,
      621     1644                   INFOSZ=4096,
      622     1645                   STCLASS=SYMREF);
      623     1649        %XUD$UTS_ENTRIES;
      624     1681        %XUD_UTS_EQU;
      625     1692        /**/
      626     1693        /* FPT DEFINITIONS */
      627     1694        %FPT_TIME (FPTN=ANS_DATE,
      628     1695                   STCLASS=CONSTANT,
      629     1696                   SOURCE=UTS,
      630     1697                   TSTAMP=ERRLOGDATE,
      631     1698                   DEST=ANS,
      632     1699                   DATE=ANSDATE);
      633     1718        %FPT_TIME (FPTN=TODAY_DATE,
      634     1719                   STCLASS=CONSTANT,
      635     1720                   SOURCE=CLOCK,
      636     1721                   DEST=ANS,
      637     1722                   DATE=TODAYDATE);
      638     1741        %FPT_OPEN (FPTN=TH_OPEN_ERRLOG,
      639     1742                   STCLASS="STATIC SYMDEF",
      640     1743                   ACS=SEQUEN,
      641     1744                   NAME=TH_VLP_ERRLOG,
      642     1745                   ACCT=VLP_SYSTAC,
      643     1746                   ASN=FILE,
      644     1747                   FUN=IN,
      645     1748                   DCB=M$ERRLOG);
      646     1857        %FPT_PRECORD (FPTN=POSITION_ERRLOG,
      647     1858                      DCB=M$ERRLOG,
      648     1859                      KEY=TH_CONSTRAINTS.START,
      649     1860                      KEYS=YES,
      650     1861                      STCLASS=CONSTANT);
      651     1882        %FPT_CLOSE (FPTN=TH_CLOSE_ERRLOG,
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:102  
      652     1883                    STCLASS="CONSTANT SYMDEF",
      653     1884                    DCB=M$ERRLOG);
      654     1926        %FPT_GDS (FPTN=GET_XSA_BUF,
      655     1927                  FREE=YES,
      656     1928                  RESULTS=TH_XSA_BUF_VECTOR,
      657     1929                  SEGSIZE="SIZEW(FSF_BUF)",
      658     1930                  STCLASS=STATIC);
      659     1946        %VLP_NAME (FPTN=TH_VLP_ERRLOGX,
      660     1947                   STCLASS=SYMREF);
      661     1974        %VLP_ACCT (FPTN=TH_VLP_ACCT,
      662     1975                   STCLASS = SYMREF);
      663     1988        %VLP_NAME (FPTN=TH_VLP_ERRLOG,
      664     1989                   STCLASS="STATIC SYMDEF",
      665     1990                   NAME=':ERRLOG????????');
      666     2017        %EJECT;
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:103  
      667     2018    1        ERRLOGDATE = ERRLOG_DATE;
      668     2019    1        IF TH_XSA_BUF.P$ = ADDR(NIL)
      669     2020    2        THEN DO;
      670     2021    2           CALL M$GDS(GET_XSA_BUF) ALTRET(PMME_ERR);
      671     2022    2           TH_XSA_PARAM.KBUF_ = VECTOR(FSF_BUF.KEYS);
      672     2023    2           TH_XSA_PARAM.BBUF_ = VECTOR(FSF_BUF.DATA);
      673     2024    2           END;
      674     2025    1        IF TH_M$ERRLOG$->F$DCB.FCD
      675     2026    1        THEN CALL XSA$CLOSE(TH_CLOSE_ERRLOG,TH_XSA_PARAM) ALTRET(XSA_ERR);
      676     2027    1        CALL M$TIME(ANS_DATE);
      677     2028    1        IF ASCBIN(SUBSTR(ANSDATE,0,1)) < 55 THEN
      678     2029    1         CALL CONCAT(TEMP_DATE,'20',ANSDATE);
      679     2030    1        ELSE
      680     2031    1         CALL CONCAT(TEMP_DATE,'19',ANSDATE);
      681     2032
      682     2033    1        CALL INSERT(TH_VLP_ERRLOG.NAME#,7,8,TEMP_DATE);
      683     2034    1        CALL M$TIME(TODAY_DATE);
      684     2035    1        IF ASCBIN(SUBSTR(TODAYDATE,0,1)) < 55 THEN
      685     2036    1         CALL CONCAT(TEMP_DATE,'20',TODAYDATE);
      686     2037    1        ELSE
      687     2038    1         CALL CONCAT(TEMP_DATE,'19',TODAYDATE);
      688     2039    1        IF TODAYDATE = ANSDATE
      689     2040    1        THEN TH_OPEN_ERRLOG.V.SHARE# = %ALL#;
      690     2041    1        ELSE TH_OPEN_ERRLOG.V.SHARE# = %IN#;
      691     2042    1        CALL XSA$OPEN(TH_OPEN_ERRLOG,TH_XSA_PARAM) ALTRET(OPEN_ERR);
      692     2043    1        TH_RECORD = VECTOR(TH_RECORD_BUF);
      693     2044    1        TH_INFO = TH_RECORD;
      694     2045    1        TH_INFO.PTR$ = PINCRW(TH_INFO.PTR$,5);
      695     2046    1        TH_HDR = TH_RECORD;
      696     2047    1        TH_HDR.BOUND = 19;
      697     2048    1        IF TH_CONSTRAINTS.M_BY_B_SET ~= '0'B
      698     2049    1        THEN TH_IOERR_M_BY_B_SET = %TRUE;
      699     2050    1        ELSE TH_IOERR_M_BY_B_SET = %FALSE;
      700     2051    1        IF TH_CONSTRAINTS.E_BY_B_SET ~= '0'B
      701     2052    1        THEN TH_IOERR_E_BY_B_SET = %TRUE;
      702     2053    1        ELSE TH_IOERR_E_BY_B_SET = %FALSE;
      703     2054    1        IF TH_CONSTRAINTS.M_MAJ_S
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:104  
      704     2055    1          OR TH_CONSTRAINTS.M_SUB_S
      705     2056    1          OR TH_CONSTRAINTS.M_MED_S
      706     2057    1          OR TH_IOERR_M_BY_B_SET
      707     2058    1        THEN TH_IOERR_M_SET = %TRUE;
      708     2059    1        ELSE TH_IOERR_M_SET = %FALSE;
      709     2060    1        IF TH_CONSTRAINTS.E_MAJ_S
      710     2061    1          OR TH_CONSTRAINTS.E_SUB_S
      711     2062    1          OR TH_CONSTRAINTS.E_MED_S
      712     2063    1          OR TH_IOERR_E_BY_B_SET
      713     2064    1        THEN TH_IOERR_E_SET = %TRUE;
      714     2065    1        ELSE TH_IOERR_E_SET = %FALSE;
      715     2066    1      IF TH_IOERR_M_SET OR TH_IOERR_E_SET
      716     2067    1        THEN TH_IOERR_M_OR_E_SET = %TRUE;
      717     2068    1        ELSE TH_IOERR_M_OR_E_SET = %FALSE;
      718     2069    1        IF TH_CONSTRAINTS.M_FEP_SET
      719     2070    1          OR TH_CONSTRAINTS.E_FEP_SET
      720     2071    1          OR TH_CONSTRAINTS.M_CHAN_SET
      721     2072    1          OR TH_CONSTRAINTS.E_CHAN_SET
      722     2073    1        THEN TH_FEPERR_M_OR_E_SET = %TRUE;
      723     2074    1        ELSE TH_FEPERR_M_OR_E_SET = %FALSE;
      724     2075    1        IF TH_CONSTRAINTS.M_COD_SET
      725     2076    1           OR TH_CONSTRAINTS.M_REA_SET
      726     2077    1           OR TH_CONSTRAINTS.M_ACT_SET
      727     2078    1           THEN TH_FIERR_M_SET = %TRUE;
      728     2079    1           ELSE TH_FIERR_M_SET = %FALSE;
      729     2080    1        IF TH_CONSTRAINTS.E_COD_SET
      730     2081    1           OR TH_CONSTRAINTS.E_REA_SET
      731     2082    1           OR TH_CONSTRAINTS.E_ACT_SET
      732     2083    1           THEN TH_FIERR_E_SET = %TRUE;
      733     2084    1           ELSE TH_FIERR_E_SET = %FALSE;
      734     2085    1        RETURN;
      735     2086    1   OPEN_ERR: ;
      736     2087    1        ALTRETURN;
      737     2088    1   PMME_ERR: ;
      738     2089    1        CALL THM$ERRMSG;
      739     2090    1        RETURN;
      740     2091        %EJECT;
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:105  
      741     2092    1   THG$PRECORDXSA: ENTRY(ERRLOG_DATE) ALTRET;
      742     2093    1        CALL XUD$UTS_DIFF_SEC (TEMP_UTS, ERRLOG_DATE, 0);
      743     2094    1        TEMP_UTS = TEMP_UTS / 86400;
      744     2095    1        CALL XUD$UTS_ADJ_25TH (TEMP_UTS, 0, TEMP_UTS*%UTS_25TH_DAY#);
      745     2096    1        CALL XUD$UTS_DIFF (TEMP_UTS, ERRLOG_DATE, TEMP_UTS);
      746     2097    1        IF ERRLOG_DATE = TH_CONSTRAINTS.START
      747     2098    1          AND TEMP_UTS ~= 0
      748     2099    2        THEN DO;
      749     2100    2           CALL XSA$PRECORD(POSITION_ERRLOG,TH_XSA_PARAM) ALTRET(KEY_ERR);
      750     2101    2   KEY_ERR: ;
      751     2102    2           TH_BOF = %NO;
      752     2103    2           END;
      753     2104    1        ELSE TH_BOF = %YES;
      754     2105    1        RETURN;
      755     2106        %EJECT;
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:106  
      756     2107    1   THG$CLOSEXSA: ENTRY ALTRET;
      757     2108    1        IF TH_M$ERRLOG$->F$DCB.FCD
      758     2109    1        THEN CALL XSA$CLOSE(TH_CLOSE_ERRLOG,TH_XSA_PARAM) ALTRET(XSA_ERR);
      759     2110    1        IF TH_XSA_BUF.P$ ~= ADDR(NIL) AND NOT TH_IOERR_FLG AND NOT TH_FEPERR_FLG
      760     2111    2        THEN DO; GET_XSA_BUF.V.SEGSIZE# = 2048;
      761     2112    2                 CALL M$FDS(GET_XSA_BUF) ALTRET(PMME_ERR);
      762     2113    2        END;
      763     2114    2        ELSE IF TH_XSA_BUF.P$ ~= ADDR(NIL) THEN DO;
      764     2115    2           GET_XSA_BUF.V.SEGSIZE# = 1024;
      765     2116    2           CALL M$FDS(GET_XSA_BUF) ALTRET(PMME_ERR);
      766     2117    2           GET_XSA_BUF.V.SEGSIZE# = 2048;
      767     2118    2        END;
      768     2119    1        RETURN;
      769     2120    1   XSA_ERR: ;
      770     2121    1        CALL XUR$ERRMSG(TH_XSA_PARAM.ERR);
      771     2122    1        RETURN;
      772     2123    1   END THG$OPENXSA;

PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:107  
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   EL$TABLES.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THG$OPENXSA.

   Procedure THG$OPENXSA requires 281 words for executable code.
   Procedure THG$OPENXSA requires 12 words of local(AUTO) storage.

    No errors detected in file THG$GETREC.:E05TSI    .

PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:108  

 Object Unit name= THG$OPENXSA                                File name= THG$GETREC.:E05TOU
 UTS= JUL 30 '97 06:14:58.28 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$ERRLOG
    2   Data  even  none    88    130  THG$OPENXSA
    3  RoData even  UTS     66    102  THG$OPENXSA
    4   Proc  even  none   281    431  THG$OPENXSA
    5  RoData even  none    14     16  THG$OPENXSA

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        1  THG$OPENXSA
     4    274          yes     yes      Std        1  THG$PRECORDXSA
     4    361          yes     yes      Std        0  THG$CLOSEXSA

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    2      6  TH_XSA_PARAM                       2     24  TH_OPEN_ERRLOG
    3     42  TH_CLOSE_ERRLOG                    2    124  TH_VLP_ERRLOG
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:109  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 XUD$UTS_DIFF_SEC
         yes           Std       1 THM$ERRMSG
 yes     yes           Std       3 XUD$UTS_ADJ_25TH
 yes     yes           Std       2 XSA$PRECORD
 yes     yes           Std       2 XSA$CLOSE
 yes     yes           Std       2 XSA$OPEN
 yes     yes           Std       3 XUD$UTS_DIFF
 yes     yes           Std       7 XUR$ERRMSG
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TH_CONSTRAINTS                        TH_BOF
     TH_RECORD                             TH_INFO                               TH_HDR
     TH_XSA_BUF_VECTOR                     TH_IOERR_M_BY_B_SET                   TH_IOERR_E_BY_B_SET
     TH_IOERR_M_SET                        TH_IOERR_E_SET                        TH_IOERR_M_OR_E_SET
     TH_FEPERR_M_OR_E_SET                  TH_FIERR_M_SET                        TH_FIERR_E_SET
     TH_M$ERRLOG$                          TH_IOERR_FLG                          TH_FEPERR_FLG
     VLP_SYSTAC                            M$ERRLOG                              TH_RECORD_BUF
     TH_VLP_ERRLOGX                        B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:110  


      578        1        /*M* THG$OPENXSA - ROUTINES TO USE FAST SEQUENTIAL FILE ACCESS FOR ELAN  */
      579        2        /*T***********************************************************/
      580        3        /*T*                                                         */
      581        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      582        5        /*T*                                                         */
      583        6        /*T***********************************************************/
      584        7        THG$OPENXSA: PROC(ERRLOG_DATE) ALTRET;

      7  4 000000   000000 700200 xent  THG$OPENXSA  TSX0  ! X66_AUTO_1
         4 000001   000014 000001                    ZERO    12,1

      585        8    1   DCL ERRLOG_DATE UBIN;
      586        9    1   DCL TEMP_UTS UBIN;
      587       10    1   DCL TEMP_DATE CHAR(8);
      588       11        /**/
      589       12        /* INCLUDE FILES */
      590       13        %INCLUDE CP_6;
      591       94        %INCLUDE CP_6_SUBS;
      592      634        %INCLUDE EL$TABLES;
      593      957        %INCLUDE F$DCB;
      594     1006        %INCLUDE TH_DATA_R;
      595     1084        %INCLUDE TH_SUBS_C;
      596     1466        %INCLUDE XS_MACRO_C;
      597     1510        %INCLUDE XUD_UTS_M;
      598     1592        /**/
      599     1593        /* ENTRY DEFS */
      600     1594    1   DCL THM$ERRMSG ENTRY(1);
      601     1595    1   DCL XSA$OPEN ENTRY(2) ALTRET;
      602     1596    1   DCL XSA$PRECORD ENTRY(2) ALTRET;
      603     1597    1   DCL XSA$CLOSE ENTRY(2) ALTRET;
      604     1598    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
      605     1599        /**/
      606     1600        /* DCBS */
      607     1601    1   DCL M$ERRLOG DCB;
      608     1602        /**/
      609     1603        /* VARIABLES */
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:111  
      610     1604    1   DCL ERRLOGDATE UBIN STATIC;
      611     1605    1   DCL ANSDATE CHAR(6) STATIC;
      612     1606    1   DCL TODAYDATE CHAR(6) STATIC;
      613     1607    1   DCL 1 FSF_BUF BASED(TH_XSA_BUF.P$),
      614     1608    1         2 KEYS (0:1023) UBIN,
      615     1609    1         2 DATA (0:1023) UBIN;
      616     1610        /**/
      617     1611        /* MACRO INVOCATIONS */
      618     1612        %XSA_PARAM (FPTN=TH_XSA_PARAM,
      619     1613                    STCLASS="STATIC SYMDEF");
      620     1643        %EL$ENTRY (NAME=TH_RECORD_BUF,
      621     1644                   INFOSZ=4096,
      622     1645                   STCLASS=SYMREF);
      623     1649        %XUD$UTS_ENTRIES;
      624     1681        %XUD_UTS_EQU;
      625     1692        /**/
      626     1693        /* FPT DEFINITIONS */
      627     1694        %FPT_TIME (FPTN=ANS_DATE,
      628     1695                   STCLASS=CONSTANT,
      629     1696                   SOURCE=UTS,
      630     1697                   TSTAMP=ERRLOGDATE,
      631     1698                   DEST=ANS,
      632     1699                   DATE=ANSDATE);
      633     1718        %FPT_TIME (FPTN=TODAY_DATE,
      634     1719                   STCLASS=CONSTANT,
      635     1720                   SOURCE=CLOCK,
      636     1721                   DEST=ANS,
      637     1722                   DATE=TODAYDATE);
      638     1741        %FPT_OPEN (FPTN=TH_OPEN_ERRLOG,
      639     1742                   STCLASS="STATIC SYMDEF",
      640     1743                   ACS=SEQUEN,
      641     1744                   NAME=TH_VLP_ERRLOG,
      642     1745                   ACCT=VLP_SYSTAC,
      643     1746                   ASN=FILE,
      644     1747                   FUN=IN,
      645     1748                   DCB=M$ERRLOG);
      646     1857        %FPT_PRECORD (FPTN=POSITION_ERRLOG,
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:112  
      647     1858                      DCB=M$ERRLOG,
      648     1859                      KEY=TH_CONSTRAINTS.START,
      649     1860                      KEYS=YES,
      650     1861                      STCLASS=CONSTANT);
      651     1882        %FPT_CLOSE (FPTN=TH_CLOSE_ERRLOG,
      652     1883                    STCLASS="CONSTANT SYMDEF",
      653     1884                    DCB=M$ERRLOG);
      654     1926        %FPT_GDS (FPTN=GET_XSA_BUF,
      655     1927                  FREE=YES,
      656     1928                  RESULTS=TH_XSA_BUF_VECTOR,
      657     1929                  SEGSIZE="SIZEW(FSF_BUF)",
      658     1930                  STCLASS=STATIC);
      659     1946        %VLP_NAME (FPTN=TH_VLP_ERRLOGX,
      660     1947                   STCLASS=SYMREF);
      661     1974        %VLP_ACCT (FPTN=TH_VLP_ACCT,
      662     1975                   STCLASS = SYMREF);
      663     1988        %VLP_NAME (FPTN=TH_VLP_ERRLOG,
      664     1989                   STCLASS="STATIC SYMDEF",
      665     1990                   NAME=':ERRLOG????????');
      666     2017        %EJECT;
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:113  
      667     2018    1        ERRLOGDATE = ERRLOG_DATE;

   2018  4 000002   200003 470500                    LDP0    @ERRLOG_DATE,,AUTO
         4 000003   000000 235100                    LDA     0,,PR0
         4 000004   000000 755000 2                  STA     ERRLOGDATE

      668     2019    1        IF TH_XSA_BUF.P$ = ADDR(NIL)

   2019  4 000005   000001 236000 xsym               LDQ     TH_XSA_BUF_VECTOR+1
         4 000006   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000007   000023 601000 4                  TNZ     s:2025

      669     2020    2        THEN DO;

      670     2021    2           CALL M$GDS(GET_XSA_BUF) ALTRET(PMME_ERR);

   2021  4 000010   000116 630400 2                  EPPR0   GET_XSA_BUF
         4 000011   430001 713400                    CLIMB   alt,gds
         4 000012   400400 401760                    pmme    nvectors=2
         4 000013   000270 702000 4                  TSX2    PMME_ERR

      671     2022    2           TH_XSA_PARAM.KBUF_ = VECTOR(FSF_BUF.KEYS);

   2022  4 000014   000000 235000 5                  LDA     0
         4 000015   000001 236000 xsym               LDQ     TH_XSA_BUF_VECTOR+1
         4 000016   000010 757000 2                  STAQ    TH_XSA_PARAM+2

      672     2023    2           TH_XSA_PARAM.BBUF_ = VECTOR(FSF_BUF.DATA);

   2023  4 000017   000000 235000 5                  LDA     0
         4 000020   000001 236000 xsym               LDQ     TH_XSA_BUF_VECTOR+1
         4 000021   002000 036003                    ADLQ    1024,DU
         4 000022   000012 757000 2                  STAQ    TH_XSA_PARAM+4

      673     2024    2           END;

      674     2025    1        IF TH_M$ERRLOG$->F$DCB.FCD
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:114  

   2025  4 000023   000000 470400 xsym               LDP0    TH_M$ERRLOG$
         4 000024   000031 236100                    LDQ     25,,PR0
         4 000025   020000 316007                    CANQ    8192,DL
         4 000026   000033 600000 4                  TZE     s:2027

      675     2026    1        THEN CALL XSA$CLOSE(TH_CLOSE_ERRLOG,TH_XSA_PARAM) ALTRET(XSA_ERR);

   2026  4 000027   000001 630400 5                  EPPR0   1
         4 000030   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000031   000000 701000 xent               TSX1    XSA$CLOSE
         4 000032   000424 702000 4                  TSX2    XSA_ERR

      676     2027    1        CALL M$TIME(ANS_DATE);

   2027  4 000033   000000 630400 3                  EPPR0   ANS_DATE
         4 000034   020004 713400                    CLIMB   8196
         4 000035   402000 401760                    pmme    nvectors=5

      677     2028    1        IF ASCBIN(SUBSTR(ANSDATE,0,1)) < 55 THEN

   2028  4 000036   000001 236000 2                  LDQ     ANSDATE
         4 000037   000033 772000                    QRL     27
         4 000040   000067 116007                    CMPQ    55,DL
         4 000041   000050 603000 4                  TRC     s:2031

      678     2029    1         CALL CONCAT(TEMP_DATE,'20',ANSDATE);

   2029  4 000042   000100 220000 3                  LDX0    TH_CLOSE_ERRLOG+30
         4 000043   200005 740100                    STX0    TEMP_DATE,,AUTO
         4 000044   040100 100400                    MLR     fill='040'O
         4 000045   000001 000006 2                  ADSC9   ANSDATE                  cn=0,n=6
         4 000046   200005 400006                    ADSC9   TEMP_DATE,,AUTO          cn=2,n=6
         4 000047   000055 710000 4                  TRA     s:2033

      679     2030    1        ELSE
      680     2031    1         CALL CONCAT(TEMP_DATE,'19',ANSDATE);
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:115  

   2031  4 000050   000101 220000 3                  LDX0    TH_CLOSE_ERRLOG+31
         4 000051   200005 740100                    STX0    TEMP_DATE,,AUTO
         4 000052   040100 100400                    MLR     fill='040'O
         4 000053   000001 000006 2                  ADSC9   ANSDATE                  cn=0,n=6
         4 000054   200005 400006                    ADSC9   TEMP_DATE,,AUTO          cn=2,n=6

      681     2032
      682     2033    1        CALL INSERT(TH_VLP_ERRLOG.NAME#,7,8,TEMP_DATE);

   2033  4 000055   040000 100500                    MLR     fill='040'O
         4 000056   200005 000010                    ADSC9   TEMP_DATE,,AUTO          cn=0,n=8
         4 000057   000126 000010 2                  ADSC9   TH_VLP_ERRLOG+2          cn=0,n=8

      683     2034    1        CALL M$TIME(TODAY_DATE);

   2034  4 000060   000014 630400 3                  EPPR0   TODAY_DATE
         4 000061   020004 713400                    CLIMB   8196
         4 000062   402000 401760                    pmme    nvectors=5

      684     2035    1        IF ASCBIN(SUBSTR(TODAYDATE,0,1)) < 55 THEN

   2035  4 000063   000003 236000 2                  LDQ     TODAYDATE
         4 000064   000033 772000                    QRL     27
         4 000065   000067 116007                    CMPQ    55,DL
         4 000066   000075 603000 4                  TRC     s:2038

      685     2036    1         CALL CONCAT(TEMP_DATE,'20',TODAYDATE);

   2036  4 000067   000100 220000 3                  LDX0    TH_CLOSE_ERRLOG+30
         4 000070   200005 740100                    STX0    TEMP_DATE,,AUTO
         4 000071   040100 100400                    MLR     fill='040'O
         4 000072   000003 000006 2                  ADSC9   TODAYDATE                cn=0,n=6
         4 000073   200005 400006                    ADSC9   TEMP_DATE,,AUTO          cn=2,n=6
         4 000074   000102 710000 4                  TRA     s:2039

      686     2037    1        ELSE
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:116  
      687     2038    1         CALL CONCAT(TEMP_DATE,'19',TODAYDATE);

   2038  4 000075   000101 220000 3                  LDX0    TH_CLOSE_ERRLOG+31
         4 000076   200005 740100                    STX0    TEMP_DATE,,AUTO
         4 000077   040100 100400                    MLR     fill='040'O
         4 000100   000003 000006 2                  ADSC9   TODAYDATE                cn=0,n=6
         4 000101   200005 400006                    ADSC9   TEMP_DATE,,AUTO          cn=2,n=6

      688     2039    1        IF TODAYDATE = ANSDATE

   2039  4 000102   040000 106400                    CMPC    fill='040'O
         4 000103   000003 000006 2                  ADSC9   TODAYDATE                cn=0,n=6
         4 000104   000001 000006 2                  ADSC9   ANSDATE                  cn=0,n=6
         4 000105   000113 601000 4                  TNZ     s:2041

      689     2040    1        THEN TH_OPEN_ERRLOG.V.SHARE# = %ALL#;

   2040  4 000106   000070 236000 2                  LDQ     TH_OPEN_ERRLOG+36
         4 000107   000003 376000 5                  ANQ     3
         4 000110   000010 276007                    ORQ     8,DL
         4 000111   000070 756000 2                  STQ     TH_OPEN_ERRLOG+36
         4 000112   000117 710000 4                  TRA     s:2042

      690     2041    1        ELSE TH_OPEN_ERRLOG.V.SHARE# = %IN#;

   2041  4 000113   000070 236000 2                  LDQ     TH_OPEN_ERRLOG+36
         4 000114   000003 376000 5                  ANQ     3
         4 000115   000020 276007                    ORQ     16,DL
         4 000116   000070 756000 2                  STQ     TH_OPEN_ERRLOG+36

      691     2042    1        CALL XSA$OPEN(TH_OPEN_ERRLOG,TH_XSA_PARAM) ALTRET(OPEN_ERR);

   2042  4 000117   000004 630400 5                  EPPR0   4
         4 000120   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000121   000000 701000 xent               TSX1    XSA$OPEN
         4 000122   000267 702000 4                  TSX2    OPEN_ERR

PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:117  
      692     2043    1        TH_RECORD = VECTOR(TH_RECORD_BUF);

   2043  4 000123   000006 237000 5                  LDAQ    6
         4 000124   000000 757000 xsym               STAQ    TH_RECORD

      693     2044    1        TH_INFO = TH_RECORD;

   2044  4 000125   000000 237000 xsym               LDAQ    TH_RECORD
         4 000126   000000 757000 xsym               STAQ    TH_INFO

      694     2045    1        TH_INFO.PTR$ = PINCRW(TH_INFO.PTR$,5);

   2045  4 000127   000001 236000 xsym               LDQ     TH_INFO+1
         4 000130   000005 036003                    ADLQ    5,DU
         4 000131   000001 756000 xsym               STQ     TH_INFO+1

      695     2046    1        TH_HDR = TH_RECORD;

   2046  4 000132   000000 237000 xsym               LDAQ    TH_RECORD
         4 000133   000000 757000 xsym               STAQ    TH_HDR

      696     2047    1        TH_HDR.BOUND = 19;

   2047  4 000134   000000 236000 xsym               LDQ     TH_HDR
         4 000135   177777 376007                    ANQ     65535,DL
         4 000136   000010 276000 5                  ORQ     8
         4 000137   000000 756000 xsym               STQ     TH_HDR

      697     2048    1        IF TH_CONSTRAINTS.M_BY_B_SET ~= '0'B

   2048  4 000140   000000 066400                    CMPB    filb='0'B
         4 000141   000026 010440 xsym               BDSC    TH_CONSTRAINTS+22        by=0,bit=1,n=288
         4 000142   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 000143   000147 600000 4                  TZE     s:2050

      698     2049    1        THEN TH_IOERR_M_BY_B_SET = %TRUE;

PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:118  
   2049  4 000144   400000 236003                    LDQ     -131072,DU
         4 000145   000000 756000 xsym               STQ     TH_IOERR_M_BY_B_SET
         4 000146   000150 710000 4                  TRA     s:2051

      699     2050    1        ELSE TH_IOERR_M_BY_B_SET = %FALSE;

   2050  4 000147   000000 450000 xsym               STZ     TH_IOERR_M_BY_B_SET

      700     2051    1        IF TH_CONSTRAINTS.E_BY_B_SET ~= '0'B

   2051  4 000150   000000 066400                    CMPB    filb='0'B
         4 000151   000050 010440 xsym               BDSC    TH_CONSTRAINTS+40        by=0,bit=1,n=288
         4 000152   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 000153   000157 600000 4                  TZE     s:2053

      701     2052    1        THEN TH_IOERR_E_BY_B_SET = %TRUE;

   2052  4 000154   400000 236003                    LDQ     -131072,DU
         4 000155   000000 756000 xsym               STQ     TH_IOERR_E_BY_B_SET
         4 000156   000160 710000 4                  TRA     s:2054

      702     2053    1        ELSE TH_IOERR_E_BY_B_SET = %FALSE;

   2053  4 000157   000000 450000 xsym               STZ     TH_IOERR_E_BY_B_SET

      703     2054    1        IF TH_CONSTRAINTS.M_MAJ_S

   2054  4 000160   000014 236000 xsym               LDQ     TH_CONSTRAINTS+12
         4 000161   004000 316003                    CANQ    2048,DU
         4 000162   000171 601000 4                  TNZ     s:2058
         4 000163   000020 316003                    CANQ    16,DU
         4 000164   000171 601000 4                  TNZ     s:2058
         4 000165   000016 234000 xsym               SZN     TH_CONSTRAINTS+14
         4 000166   000171 604000 4                  TMI     s:2058
         4 000167   000000 234000 xsym               SZN     TH_IOERR_M_BY_B_SET
         4 000170   000174 605000 4                  TPL     s:2059

PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:119  
      704     2055    1          OR TH_CONSTRAINTS.M_SUB_S
      705     2056    1          OR TH_CONSTRAINTS.M_MED_S
      706     2057    1          OR TH_IOERR_M_BY_B_SET
      707     2058    1        THEN TH_IOERR_M_SET = %TRUE;

   2058  4 000171   400000 236003                    LDQ     -131072,DU
         4 000172   000000 756000 xsym               STQ     TH_IOERR_M_SET
         4 000173   000175 710000 4                  TRA     s:2060

      708     2059    1        ELSE TH_IOERR_M_SET = %FALSE;

   2059  4 000174   000000 450000 xsym               STZ     TH_IOERR_M_SET

      709     2060    1        IF TH_CONSTRAINTS.E_MAJ_S

   2060  4 000175   000036 236000 xsym               LDQ     TH_CONSTRAINTS+30
         4 000176   002000 316003                    CANQ    1024,DU
         4 000177   000206 601000 4                  TNZ     s:2064
         4 000200   000010 316003                    CANQ    8,DU
         4 000201   000206 601000 4                  TNZ     s:2064
         4 000202   000040 234000 xsym               SZN     TH_CONSTRAINTS+32
         4 000203   000206 604000 4                  TMI     s:2064
         4 000204   000000 234000 xsym               SZN     TH_IOERR_E_BY_B_SET
         4 000205   000211 605000 4                  TPL     s:2065

      710     2061    1          OR TH_CONSTRAINTS.E_SUB_S
      711     2062    1          OR TH_CONSTRAINTS.E_MED_S
      712     2063    1          OR TH_IOERR_E_BY_B_SET
      713     2064    1        THEN TH_IOERR_E_SET = %TRUE;

   2064  4 000206   400000 236003                    LDQ     -131072,DU
         4 000207   000000 756000 xsym               STQ     TH_IOERR_E_SET
         4 000210   000212 710000 4                  TRA     s:2066

      714     2065    1        ELSE TH_IOERR_E_SET = %FALSE;

   2065  4 000211   000000 450000 xsym               STZ     TH_IOERR_E_SET
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:120  

      715     2066    1      IF TH_IOERR_M_SET OR TH_IOERR_E_SET

   2066  4 000212   000000 234000 xsym               SZN     TH_IOERR_M_SET
         4 000213   000216 604000 4                  TMI     s:2067
         4 000214   000000 234000 xsym               SZN     TH_IOERR_E_SET
         4 000215   000221 605000 4                  TPL     s:2068

      716     2067    1        THEN TH_IOERR_M_OR_E_SET = %TRUE;

   2067  4 000216   400000 236003                    LDQ     -131072,DU
         4 000217   000000 756000 xsym               STQ     TH_IOERR_M_OR_E_SET
         4 000220   000222 710000 4                  TRA     s:2069

      717     2068    1        ELSE TH_IOERR_M_OR_E_SET = %FALSE;

   2068  4 000221   000000 450000 xsym               STZ     TH_IOERR_M_OR_E_SET

      718     2069    1        IF TH_CONSTRAINTS.M_FEP_SET

   2069  4 000222   000061 234000 xsym               SZN     TH_CONSTRAINTS+49
         4 000223   000234 604000 4                  TMI     s:2073
         4 000224   000063 236000 xsym               LDQ     TH_CONSTRAINTS+51
         4 000225   400000 316007                    CANQ    -131072,DL
         4 000226   000234 601000 4                  TNZ     s:2073
         4 000227   000062 236000 xsym               LDQ     TH_CONSTRAINTS+50
         4 000230   400000 316007                    CANQ    -131072,DL
         4 000231   000234 601000 4                  TNZ     s:2073
         4 000232   000065 234000 xsym               SZN     TH_CONSTRAINTS+53
         4 000233   000237 605000 4                  TPL     s:2074

      719     2070    1          OR TH_CONSTRAINTS.E_FEP_SET
      720     2071    1          OR TH_CONSTRAINTS.M_CHAN_SET
      721     2072    1          OR TH_CONSTRAINTS.E_CHAN_SET
      722     2073    1        THEN TH_FEPERR_M_OR_E_SET = %TRUE;

   2073  4 000234   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:121  
         4 000235   000000 756000 xsym               STQ     TH_FEPERR_M_OR_E_SET
         4 000236   000240 710000 4                  TRA     s:2075

      723     2074    1        ELSE TH_FEPERR_M_OR_E_SET = %FALSE;

   2074  4 000237   000000 450000 xsym               STZ     TH_FEPERR_M_OR_E_SET

      724     2075    1        IF TH_CONSTRAINTS.M_COD_SET

   2075  4 000240   000065 236000 xsym               LDQ     TH_CONSTRAINTS+53
         4 000241   000200 316003                    CANQ    128,DU
         4 000242   000247 601000 4                  TNZ     s:2078
         4 000243   100000 316007                    CANQ    32768,DL
         4 000244   000247 601000 4                  TNZ     s:2078
         4 000245   000040 316007                    CANQ    32,DL
         4 000246   000252 600000 4                  TZE     s:2079

      725     2076    1           OR TH_CONSTRAINTS.M_REA_SET
      726     2077    1           OR TH_CONSTRAINTS.M_ACT_SET
      727     2078    1           THEN TH_FIERR_M_SET = %TRUE;

   2078  4 000247   400000 236003                    LDQ     -131072,DU
         4 000250   000000 756000 xsym               STQ     TH_FIERR_M_SET
         4 000251   000253 710000 4                  TRA     s:2080

      728     2079    1           ELSE TH_FIERR_M_SET = %FALSE;

   2079  4 000252   000000 450000 xsym               STZ     TH_FIERR_M_SET

      729     2080    1        IF TH_CONSTRAINTS.E_COD_SET

   2080  4 000253   000066 236000 xsym               LDQ     TH_CONSTRAINTS+54
         4 000254   020000 316003                    CANQ    8192,DU
         4 000255   000262 601000 4                  TNZ     s:2083
         4 000256   000010 316003                    CANQ    8,DU
         4 000257   000262 601000 4                  TNZ     s:2083
         4 000260   004000 316007                    CANQ    2048,DL
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:122  
         4 000261   000265 600000 4                  TZE     s:2084

      730     2081    1           OR TH_CONSTRAINTS.E_REA_SET
      731     2082    1           OR TH_CONSTRAINTS.E_ACT_SET
      732     2083    1           THEN TH_FIERR_E_SET = %TRUE;

   2083  4 000262   400000 236003                    LDQ     -131072,DU
         4 000263   000000 756000 xsym               STQ     TH_FIERR_E_SET
         4 000264   000266 710000 4                  TRA     s:2085

      733     2084    1           ELSE TH_FIERR_E_SET = %FALSE;

   2084  4 000265   000000 450000 xsym               STZ     TH_FIERR_E_SET

      734     2085    1        RETURN;

   2085  4 000266   000000 702200 xent               TSX2  ! X66_ARET

   2080  4 000267                       OPEN_ERR     null
      735     2086    1   OPEN_ERR: ;
      736     2087    1        ALTRETURN;

   2087  4 000267   000000 702200 xent               TSX2  ! X66_AALT

   2080  4 000270                       PMME_ERR     null
      737     2088    1   PMME_ERR: ;
      738     2089    1        CALL THM$ERRMSG;

   2089  4 000270   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000271   000000 701000 xent               TSX1    THM$ERRMSG
         4 000272   000000 011000                    NOP     0

      739     2090    1        RETURN;

   2090  4 000273   000000 702200 xent               TSX2  ! X66_ARET

      740     2091        %EJECT;
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:123  
      741     2092    1   THG$PRECORDXSA: ENTRY(ERRLOG_DATE) ALTRET;

   2092  4 000274   000000 700200 xent  THG$PRECORD* TSX0  ! X66_AUTO_1
         4 000275   000014 000001                    ZERO    12,1

      742     2093    1        CALL XUD$UTS_DIFF_SEC (TEMP_UTS, ERRLOG_DATE, 0);

   2093  4 000276   000011 236000 5                  LDQ     9
         4 000277   200012 756100                    STQ     TEMP_DATE+5,,AUTO
         4 000300   200003 236100                    LDQ     @ERRLOG_DATE,,AUTO
         4 000301   200011 756100                    STQ     TEMP_DATE+4,,AUTO
         4 000302   200004 630500                    EPPR0   TEMP_UTS,,AUTO
         4 000303   200010 450500                    STP0    TEMP_DATE+3,,AUTO
         4 000304   200010 630500                    EPPR0   TEMP_DATE+3,,AUTO
         4 000305   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000306   000000 701000 xent               TSX1    XUD$UTS_DIFF_SEC
         4 000307   000000 011000                    NOP     0

      743     2094    1        TEMP_UTS = TEMP_UTS / 86400;

   2094  4 000310   200004 236100                    LDQ     TEMP_UTS,,AUTO
         4 000311   000001 772000                    QRL     1
         4 000312   124300 506007                    DIV     43200,DL
         4 000313   200004 756100                    STQ     TEMP_UTS,,AUTO

      744     2095    1        CALL XUD$UTS_ADJ_25TH (TEMP_UTS, 0, TEMP_UTS*%UTS_25TH_DAY#);

   2095  4 000314   000012 402000 5                  MPY     10
         4 000315   200010 756100                    STQ     TEMP_DATE+3,,AUTO
         4 000316   200010 630500                    EPPR0   TEMP_DATE+3,,AUTO
         4 000317   200013 450500                    STP0    TEMP_DATE+6,,AUTO
         4 000320   000011 236000 5                  LDQ     9
         4 000321   200012 756100                    STQ     TEMP_DATE+5,,AUTO
         4 000322   200004 631500                    EPPR1   TEMP_UTS,,AUTO
         4 000323   200011 451500                    STP1    TEMP_DATE+4,,AUTO
         4 000324   200011 630500                    EPPR0   TEMP_DATE+4,,AUTO
         4 000325   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:124  
         4 000326   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         4 000327   000000 011000                    NOP     0

      745     2096    1        CALL XUD$UTS_DIFF (TEMP_UTS, ERRLOG_DATE, TEMP_UTS);

   2096  4 000330   200004 630500                    EPPR0   TEMP_UTS,,AUTO
         4 000331   200012 450500                    STP0    TEMP_DATE+5,,AUTO
         4 000332   200003 236100                    LDQ     @ERRLOG_DATE,,AUTO
         4 000333   200011 756100                    STQ     TEMP_DATE+4,,AUTO
         4 000334   200004 631500                    EPPR1   TEMP_UTS,,AUTO
         4 000335   200010 451500                    STP1    TEMP_DATE+3,,AUTO
         4 000336   200010 630500                    EPPR0   TEMP_DATE+3,,AUTO
         4 000337   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000340   000000 701000 xent               TSX1    XUD$UTS_DIFF
         4 000341   000000 011000                    NOP     0

      746     2097    1        IF ERRLOG_DATE = TH_CONSTRAINTS.START

   2097  4 000342   200003 470500                    LDP0    @ERRLOG_DATE,,AUTO
         4 000343   000000 236100                    LDQ     0,,PR0
         4 000344   000012 116000 xsym               CMPQ    TH_CONSTRAINTS+10
         4 000345   000356 601000 4                  TNZ     s:2104
         4 000346   200004 235100                    LDA     TEMP_UTS,,AUTO
         4 000347   000356 600000 4                  TZE     s:2104

      747     2098    1          AND TEMP_UTS ~= 0
      748     2099    2        THEN DO;

      749     2100    2           CALL XSA$PRECORD(POSITION_ERRLOG,TH_XSA_PARAM) ALTRET(KEY_ERR);

   2100  4 000350   000013 630400 5                  EPPR0   11
         4 000351   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000352   000000 701000 xent               TSX1    XSA$PRECORD
         4 000353   000354 702000 4                  TSX2    KEY_ERR

   2100  4 000354                       KEY_ERR      null
      750     2101    2   KEY_ERR: ;
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:125  
      751     2102    2           TH_BOF = %NO;

   2102  4 000354   000000 450000 xsym               STZ     TH_BOF

      752     2103    2           END;

   2103  4 000355   000360 710000 4                  TRA     s:2105

      753     2104    1        ELSE TH_BOF = %YES;

   2104  4 000356   400000 236003                    LDQ     -131072,DU
         4 000357   000000 756000 xsym               STQ     TH_BOF

      754     2105    1        RETURN;

   2105  4 000360   000000 702200 xent               TSX2  ! X66_ARET

      755     2106        %EJECT;
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:126  
      756     2107    1   THG$CLOSEXSA: ENTRY ALTRET;

   2107  4 000361   000000 700200 xent  THG$CLOSEXSA TSX0  ! X66_AUTO_1
         4 000362   000014 000001                    ZERO    12,1

      757     2108    1        IF TH_M$ERRLOG$->F$DCB.FCD

   2108  4 000363   000000 470400 xsym               LDP0    TH_M$ERRLOG$
         4 000364   000031 236100                    LDQ     25,,PR0
         4 000365   020000 316007                    CANQ    8192,DL
         4 000366   000373 600000 4                  TZE     s:2110

      758     2109    1        THEN CALL XSA$CLOSE(TH_CLOSE_ERRLOG,TH_XSA_PARAM) ALTRET(XSA_ERR);

   2109  4 000367   000001 630400 5                  EPPR0   1
         4 000370   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000371   000000 701000 xent               TSX1    XSA$CLOSE
         4 000372   000424 702000 4                  TSX2    XSA_ERR

      759     2110    1        IF TH_XSA_BUF.P$ ~= ADDR(NIL) AND NOT TH_IOERR_FLG AND NOT TH_FEPERR_FLG

   2110  4 000373   000001 236000 xsym               LDQ     TH_XSA_BUF_VECTOR+1
         4 000374   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000375   000411 600000 4                  TZE     s:2114
         4 000376   000000 234000 xsym               SZN     TH_IOERR_FLG
         4 000377   000411 604000 4                  TMI     s:2114
         4 000400   000000 234000 xsym               SZN     TH_FEPERR_FLG
         4 000401   000411 604000 4                  TMI     s:2114

      760     2111    2        THEN DO; GET_XSA_BUF.V.SEGSIZE# = 2048;

   2111  4 000402   004000 220003                    LDX0    2048,DU
         4 000403   000122 440000 2                  SXL0    GET_XSA_BUF+4

      761     2112    2                 CALL M$FDS(GET_XSA_BUF) ALTRET(PMME_ERR);

   2112  4 000404   000116 630400 2                  EPPR0   GET_XSA_BUF
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:127  
         4 000405   430002 713400                    CLIMB   alt,fds
         4 000406   400400 401760                    pmme    nvectors=2
         4 000407   000270 702000 4                  TSX2    PMME_ERR

      762     2113    2        END;

   2113  4 000410   000423 710000 4                  TRA     s:2119

      763     2114    2        ELSE IF TH_XSA_BUF.P$ ~= ADDR(NIL) THEN DO;

   2114  4 000411   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000412   000423 600000 4                  TZE     s:2119

      764     2115    2           GET_XSA_BUF.V.SEGSIZE# = 1024;

   2115  4 000413   002000 220003                    LDX0    1024,DU
         4 000414   000122 440000 2                  SXL0    GET_XSA_BUF+4

      765     2116    2           CALL M$FDS(GET_XSA_BUF) ALTRET(PMME_ERR);

   2116  4 000415   000116 630400 2                  EPPR0   GET_XSA_BUF
         4 000416   430002 713400                    CLIMB   alt,fds
         4 000417   400400 401760                    pmme    nvectors=2
         4 000420   000270 702000 4                  TSX2    PMME_ERR

      766     2117    2           GET_XSA_BUF.V.SEGSIZE# = 2048;

   2117  4 000421   004000 220003                    LDX0    2048,DU
         4 000422   000122 440000 2                  SXL0    GET_XSA_BUF+4

      767     2118    2        END;

      768     2119    1        RETURN;

   2119  4 000423   000000 702200 xent               TSX2  ! X66_ARET

   2115  4 000424                       XSA_ERR      null
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:128  
      769     2120    1   XSA_ERR: ;
      770     2121    1        CALL XUR$ERRMSG(TH_XSA_PARAM.ERR);

   2121  4 000424   000015 630400 5                  EPPR0   13
         4 000425   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000426   000000 701000 xent               TSX1    XUR$ERRMSG
         4 000427   000000 011000                    NOP     0

      771     2122    1        RETURN;

   2122  4 000430   000000 702200 xent               TSX2  ! X66_ARET
      772     2123    1   END THG$OPENXSA;

PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:129  
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   EL$TABLES.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THG$OPENXSA.
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:130  

 **** Variables and constants ****

  ****  Section 002  Data  THG$OPENXSA

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/c CHAR(6)     r     1 ANSDATE                    0-0-0/w UBIN        r     1 ERRLOGDATE
   116-0-0/d STRC(216)   r     1 GET_XSA_BUF               24-0-0/d STRC(2088)  r     1 TH_OPEN_ERRLOG
   124-0-0/c STRC(144)   r     1 TH_VLP_ERRLOG              6-0-0/d STRC(504)   r     1 TH_XSA_PARAM
     3-0-0/c CHAR(6)     r     1 TODAYDATE

  ****  Section 003 RoData THG$OPENXSA

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(432)   r     1 ANS_DATE                  30-0-0/d STRC(360)   r     1 POSITION_ERRLOG
    42-0-0/d STRC(1080)  r     1 TH_CLOSE_ERRLOG           14-0-0/d STRC(432)   r     1 TODAY_DATE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @ERRLOG_DATE              *0-0-0/w UBIN        r     1 ERRLOG_DATE
     5-0-0/c CHAR(8)     r     1 TEMP_DATE                  4-0-0/w UBIN        r     1 TEMP_UTS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 TH_BOF                     0-0-0/d STRC(1971)  r     1 TH_CONSTRAINTS
     0-0-0/b BIT         r     1 TH_FEPERR_FLG              0-0-0/b BIT         r     1 TH_FEPERR_M_OR_E_SET
     0-0-0/b BIT         r     1 TH_FIERR_E_SET             0-0-0/b BIT         r     1 TH_FIERR_M_SET
     0-0-0/d STRC(72)    r     1 TH_HDR                     0-0-0/d STRC(72)    r     1 TH_INFO
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:131  
     0-0-0/b BIT         r     1 TH_IOERR_E_BY_B_SET        0-0-0/b BIT         r     1 TH_IOERR_E_SET
     0-0-0/b BIT         r     1 TH_IOERR_FLG               0-0-0/b BIT         r     1 TH_IOERR_M_BY_B_SET
     0-0-0/b BIT         r     1 TH_IOERR_M_OR_E_SET        0-0-0/b BIT         r     1 TH_IOERR_M_SET
     0-0-0/w PTR         r     1 TH_M$ERRLOG$               0-0-0/d STRC(72)    r     1 TH_RECORD
     0-0-0/w STRC(37044) r     1 TH_RECORD_BUF              0-0-0/c ASTR(9)     r     1 TH_VLP_ERRLOGX
     0-0-0/w STRC(72)    r     1 TH_XSA_BUF                 0-0-0/w BIT (72)    r     1 TH_XSA_BUF_VECTOR
     0-0-0/c STRC(72)    r     1 VLP_SYSTAC

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(73728) r     1 FSF_BUF
     0-0-0N  NULL        r     1 M$ERRLOG


   Procedure THG$OPENXSA requires 281 words for executable code.
   Procedure THG$OPENXSA requires 12 words of local(AUTO) storage.

    No errors detected in file THG$GETREC.:E05TSI    .
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:132  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:133  
          MINI XREF LISTING

ANSDATE
      1605**DCL      1710--DCLINIT  1711--DCLINIT  2028>>IF       2029>>CALLBLT  2031>>CALLBLT  2039>>IF
ANS_DATE
      1710**DCL      2027<>CALL
ANS_DATE.V
      1714**DCL      1710--DCLINIT
ERRLOGDATE
      1604**DCL      1714--DCLINIT  2018<<ASSIGN
ERRLOG_DATE
         8**DCL         7--PROC     2018>>ASSIGN   2092--ENTRY    2093<>CALL     2096<>CALL     2097>>IF
F$DCB.ACTPOS
       983**DCL       983--REDEF
F$DCB.ARS
       958**DCL       958--REDEF
F$DCB.ATTR
       976**DCL       977--REDEF
F$DCB.BORROW
       991**DCL       991--REDEF     991--REDEF     991--REDEF
F$DCB.DCBNAME.L
      1005**DCL      1005--IMP-SIZ
F$DCB.EOMCHAR
       962**DCL       962--REDEF
F$DCB.FCD
       971**DCL      2025>>IF       2108>>IF
F$DCB.FLDID
       986**DCL       986--REDEF
F$DCB.FORM$
       980**DCL       980--REDEF
F$DCB.FSECT
       996**DCL       996--REDEF
F$DCB.FSN
       973**DCL       973--REDEF     973--REDEF     974--REDEF
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:134  
F$DCB.HEADER$
       979**DCL       979--REDEF
F$DCB.IXTNSIZE
       977**DCL       977--REDEF
F$DCB.LASTSTA$
       967**DCL       967--REDEF
F$DCB.LVL
       992**DCL       992--REDEF
F$DCB.NAME.C
       967**DCL       967--REDEF
F$DCB.NOEOF
       988**DCL       988--REDEF
F$DCB.NRECS
       978**DCL       978--REDEF
F$DCB.NRECX
       997**DCL       997--REDEF
F$DCB.OHDR
       989**DCL       989--REDEF
F$DCB.ORG
       972**DCL       972--REDEF
F$DCB.PRECNO
       995**DCL       995--REDEF
F$DCB.RCSZ
      1000**DCL      1000--REDEF
F$DCB.RES
       968**DCL       968--REDEF
F$DCB.SETX
       980**DCL       980--REDEF
F$DCB.TAB$
       979**DCL       980--REDEF
F$DCB.TDA
       994**DCL       994--REDEF
F$DCB.WSN
       969**DCL       969--REDEF
FSF_BUF
      1607**DCL      1944--DCLINIT
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:135  
FSF_BUF.DATA
      1609**DCL      2023--ASSIGN
FSF_BUF.KEYS
      1608**DCL      2022--ASSIGN
GET_XSA_BUF
      1941**DCL      2021<>CALL     2112<>CALL     2116<>CALL
GET_XSA_BUF.V
      1941**DCL      1941--DCLINIT
GET_XSA_BUF.V.SEGSIZE#
      1944**DCL      2111<<ASSIGN   2115<<ASSIGN   2117<<ASSIGN
KEY_ERR
      2100**LABEL    2100--CALLALT
M$FDS
        57**DCL-ENT  2112--CALL     2116--CALL
M$GDS
        57**DCL-ENT  2021--CALL
M$TIME
        89**DCL-ENT  2027--CALL     2034--CALL
OPEN_ERR
      2080**LABEL    2042--CALLALT
PMME_ERR
      2080**LABEL    2021--CALLALT  2112--CALLALT  2116--CALLALT
POSITION_ERRLOG
      1872**DCL      2100<>CALL
POSITION_ERRLOG.V
      1874**DCL      1872--DCLINIT
TEMP_DATE
        10**DCL      2029<<CALLBLT  2031<<CALLBLT  2033>>CALLBLT  2036<<CALLBLT  2038<<CALLBLT
TEMP_UTS
         9**DCL      2093<>CALL     2094<<ASSIGN   2094>>ASSIGN   2095<>CALL     2095>>CALL     2096<>CALL
      2096<>CALL     2097>>IF
THM$ERRMSG
      1594**DCL-ENT  2089--CALL
TH_BOF
      1042**DCL      2102<<ASSIGN   2104<<ASSIGN
TH_CLOSE_ERRLOG
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:136  
      1907**DCL      2026<>CALL     2109<>CALL
TH_CLOSE_ERRLOG.SN_
      1907**DCL      1907--REDEF
TH_CLOSE_ERRLOG.UTL_
      1908**DCL      1908--REDEF
TH_CLOSE_ERRLOG.V
      1912**DCL      1907--DCLINIT
TH_CLOSE_ERRLOG.V.EXPIRE#
      1922**DCL      1922--REDEF
TH_CLOSE_ERRLOG.V.TYPE#
      1920**DCL      1920--REDEF
TH_CLOSE_ERRLOG.V.XTNSIZE#
      1917**DCL      1917--REDEF    1919--REDEF
TH_CONSTRAINTS.E_ACT_SET
      1021**DCL      2080>>IF
TH_CONSTRAINTS.E_BY_B
      1017**DCL      1017--REDEF
TH_CONSTRAINTS.E_BY_B_SET
      1018**DCL      2051>>IF
TH_CONSTRAINTS.E_CHAN_SET
      1019**DCL      2069>>IF
TH_CONSTRAINTS.E_COD_SET
      1020**DCL      2080>>IF
TH_CONSTRAINTS.E_FEP_SET
      1019**DCL      2069>>IF
TH_CONSTRAINTS.E_MAJ_S
      1017**DCL      2060>>IF
TH_CONSTRAINTS.E_MED_S
      1017**DCL      2060>>IF
TH_CONSTRAINTS.E_REA_SET
      1021**DCL      2080>>IF
TH_CONSTRAINTS.E_SUB_S
      1017**DCL      2060>>IF
TH_CONSTRAINTS.M_ACT_SET
      1020**DCL      2075>>IF
TH_CONSTRAINTS.M_BY_B
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:137  
      1016**DCL      1016--REDEF
TH_CONSTRAINTS.M_BY_B_SET
      1016**DCL      2048>>IF
TH_CONSTRAINTS.M_CHAN_SET
      1018**DCL      2069>>IF
TH_CONSTRAINTS.M_COD_SET
      1019**DCL      2075>>IF
TH_CONSTRAINTS.M_FEP_SET
      1018**DCL      2069>>IF
TH_CONSTRAINTS.M_MAJ_S
      1015**DCL      2054>>IF
TH_CONSTRAINTS.M_MED_S
      1016**DCL      2054>>IF
TH_CONSTRAINTS.M_REA_SET
      1020**DCL      2075>>IF
TH_CONSTRAINTS.M_SUB_S
      1015**DCL      2054>>IF
TH_CONSTRAINTS.START
      1015**DCL      1872--DCLINIT  1873--DCLINIT  2097>>IF
TH_CONSTRAINTS.TYPES
      1014**DCL      1014--REDEF
TH_DEFAULT.E_BY_B
      1025**DCL      1025--REDEF
TH_DEFAULT.M_BY_B
      1024**DCL      1024--REDEF
TH_DEFAULT.TYPES
      1022**DCL      1022--REDEF
TH_FEPERR_FLG
      1053**DCL      2110>>IF
TH_FEPERR_M_OR_E_SET
      1051**DCL      2073<<ASSIGN   2074<<ASSIGN
TH_FIERR_E_SET
      1052**DCL      2083<<ASSIGN   2084<<ASSIGN
TH_FIERR_M_SET
      1052**DCL      2078<<ASSIGN   2079<<ASSIGN
TH_HDR
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:138  
      1043**DCL      2046<<ASSIGN
TH_HDR.BOUND
      1043**DCL      2047<<ASSIGN
TH_INFO
      1043**DCL      2044<<ASSIGN
TH_INFO.PTR$
      1043**DCL      2045<<ASSIGN   2045>>ASSIGN
TH_IOERR_E_BY_B_SET
      1050**DCL      2052<<ASSIGN   2053<<ASSIGN   2060>>IF
TH_IOERR_E_SET
      1051**DCL      2064<<ASSIGN   2065<<ASSIGN   2066>>IF
TH_IOERR_FLG
      1053**DCL      2110>>IF
TH_IOERR_M_BY_B_SET
      1050**DCL      2049<<ASSIGN   2050<<ASSIGN   2054>>IF
TH_IOERR_M_OR_E_SET
      1051**DCL      2067<<ASSIGN   2068<<ASSIGN
TH_IOERR_M_SET
      1051**DCL      2058<<ASSIGN   2059<<ASSIGN   2066>>IF
TH_M$ERRLOG$
      1052**DCL      2025>>IF       2108>>IF
TH_OPEN_ERRLOG
      1813**DCL      2042<>CALL
TH_OPEN_ERRLOG.ACSVEH_
      1815**DCL      1816--REDEF
TH_OPEN_ERRLOG.ALTKEYS_
      1821**DCL      1822--REDEF    1822--REDEF
TH_OPEN_ERRLOG.HDR_
      1820**DCL      1821--REDEF
TH_OPEN_ERRLOG.TAB_
      1819**DCL      1820--REDEF
TH_OPEN_ERRLOG.UHL_
      1813**DCL      1814--REDEF    1814--REDEF
TH_OPEN_ERRLOG.V
      1822**DCL      1813--DCLINIT
TH_OPEN_ERRLOG.V.FSN#
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:139  
      1853**DCL      1853--REDEF    1853--REDEF
TH_OPEN_ERRLOG.V.SHARE#
      1827**DCL      2040<<ASSIGN   2041<<ASSIGN
TH_OPEN_ERRLOG.WSN_
      1819**DCL      1819--REDEF
TH_RECORD
      1042**DCL      2043<<ASSIGN   2044>>ASSIGN   2046>>ASSIGN
TH_RECORD_BUF
      1646**DCL      2043--ASSIGN
TH_RECORD_BUF.TYPE
      1646**DCL      1646--REDEF
TH_SAVE.E_BY_B
      1033**DCL      1033--REDEF
TH_SAVE.M_BY_B
      1031**DCL      1031--REDEF
TH_SAVE.TYPES
      1029**DCL      1030--REDEF
TH_VLP_ERRLOG
      2015**DCL      1814--DCLINIT
TH_VLP_ERRLOG.NAME#
      2015**DCL      2033<<CALLBLT
TH_VLP_ERRLOGX.L#
      1972**DCL      1972--IMP-SIZ
TH_XSA_BUF.P$
      1050**DCL      1607--IMP-PTR  2019>>IF       2022>>ASSIGN   2023>>ASSIGN   2110>>IF       2114>>IF
TH_XSA_BUF_VECTOR
      1049**DCL      1049--REDEF    1941--DCLINIT
TH_XSA_PARAM
      1621**DCL      2026<>CALL     2042<>CALL     2100<>CALL     2109<>CALL
TH_XSA_PARAM.BBUF_
      1629**DCL      2023<<ASSIGN
TH_XSA_PARAM.EOMCHAR#
      1637**DCL      1638--REDEF
TH_XSA_PARAM.ERR
      1625**DCL      2121<>CALL
TH_XSA_PARAM.KBUF_
PL6.E3A0      #002=THG$OPENXSA File=THG$GETREC.:E05TSI                           WED 07/30/97 06:14 Page:140  
      1627**DCL      2022<<ASSIGN
TH_XSA_PARAM.SIG1
      1631**DCL      1631--REDEF
TH_XSA_PARAM.SIG2
      1631**DCL      1632--REDEF
TODAYDATE
      1606**DCL      1733--DCLINIT  1734--DCLINIT  2035>>IF       2036>>CALLBLT  2038>>CALLBLT  2039>>IF
TODAY_DATE
      1733**DCL      2034<>CALL
TODAY_DATE.V
      1737**DCL      1733--DCLINIT
VLP_SYSTAC
      1066**DCL      1818--DCLINIT
XSA$CLOSE
      1597**DCL-ENT  2026--CALL     2109--CALL
XSA$OPEN
      1595**DCL-ENT  2042--CALL
XSA$PRECORD
      1596**DCL-ENT  2100--CALL
XSA_ERR
      2115**LABEL    2026--CALLALT  2109--CALLALT
XUD$UTS_ADJ_25TH
      1674**DCL-ENT  2095--CALL
XUD$UTS_DIFF
      1650**DCL-ENT  2096--CALL
XUD$UTS_DIFF_SEC
      1656**DCL-ENT  2093--CALL
XUR$ERRMSG
      1598**DCL-ENT  2121--CALL
