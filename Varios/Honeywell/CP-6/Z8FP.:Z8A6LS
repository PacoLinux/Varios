VERSION A06

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:1    
        1        1        /*M*   Z8FP$PFORM_CHECKING                                          */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8               NAME: Z8FP$PFORM_CHECKING
        9        9        DESCRIPTION: Check all remianing PFORMs. Convert to CBL-74 style if
       10       10                     need be, but whenever possible make it an optimized PERFORM
       11       11                     using %GO_SUB.
       12       12        */
       13       13        /*D*
       14       14               NAME:  Z8FP$PFORM_CHECKING
       15       15               CALL:  CALL Z8FP$PFORM_CHECKING ;
       16       16          INTERFACE:  Z8AT$CREATE_TEMPORARY is called to create switches and scalars.
       17       17                      Z8AF$NEW_BASE is called to create BASEs.
       18       18
       19       19              INPUT:  COMCOM.H_PFORM is the top of the linked list of PFORM items.
       20       20
       21       21        DESCRIPTION:  This procedure looks at all of the PFORMs left in the program
       22       22                      after Z8FF$FLOW_ANALYSIS.  Z8FF$FLOW_ANALYSIS may copy some
       23       23                      performs in line or transfer them in line.  The PFORMs are looked
       24       24                      at to see if how they should be set up.
       25       25
       26       26                      There are two options in the way they are set up.
       27       27
       28       28                           1. Optimized PERFORM.
       29       29                              Set up as straight transfers in Phase 4 (code generation).
       30       30                              The PFORM item is replaced with a GO_SUB item, and
       31       31                              SUB_ENTRY and SUB_END items are set up at beginning
       32       32                              and end of the PERFORMed code.
       33       33
       34       34                           2. COBOL 74 PERFORM.
       35       35                              Set up as transfers using POINTER variables.  The PFORM
       36       36                              item is deleted from the ILL but GOs, DEFLBs, and PRESETs
       37       37                              are used.
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:2    
       38       38
       39       39         REFERENCES:  Design note 27, 'Perform format 1.'
       40       40        */
       41       41        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:3    
       42       42        Z8FP$PFORM_CHECKING: PROC ;
       43       43        %EQU PHASE = 2 ;
       44       44        %EQU FIXED_SEGMENT = 0;
       45       45        %INCLUDE Z9A_SUPP_MAC;
       46      334        %INCLUDE Z8A_DEFC ;
       47      402        %INCLUDE Z8A_SUPP_MAC ;
       48     2802        %INCLUDE Z8A_COMCOM ;
       49     3452        %INCLUDE Z8A_ETT ;
       50     3753        %INCLUDE Z8A_ILL ;
       51     4446        %INCLUDE Z8A_ILS ;
       52     4555        %INCLUDE Z8A_LTS ;
       53     6632        %INCLUDE Z8A_ST ;
       54    10291        %INCLUDE Z8A_TYPES ;
       55    10465        %INCLUDE Z8F_O2COM ;
       56    10575
       57    10576    1   DCL  Z8AT$CREATE_TEMPORARY ENTRY(2) ;
       58    10577    1   DCL  Z8AF$NEW_BASE         ENTRY(3) ; /* LOP, ROP, RETURN */
       59    10578
       60    10579    1   DCL  PFORM_ILL$         PTR AUTO ;
       61    10580    1   DCL  START_LABEL$       PTR AUTO ;
       62    10581    1   DCL  END_LABEL$         PTR AUTO ;
       63    10582    1   DCL  END_LABEL_74$      PTR AUTO ;
       64    10583    1   DCL  END_TEMP$          PTR AUTO ;
       65    10584    1   DCL  PFORM_ILS$         PTR ;
       66    10585    1   DCL  DEFLB_FOLLOWS      BOOLEAN ;
       67    10586    1   DCL  LABEL_AFTER_PFORM$ PTR ;
       68    10587    1   DCL  ALTER_LBL$         PTR ;
       69    10588    1   DCL  ENTRY$             PTR ; /* PTR to a %ENTRY's ILS item */
       70    10589    1   DCL  ALTER$             PTR ; /* PTR to a %ALTER for a CBL-74 PERFORM */
       71    10590    1   DCL  TEMP$              PTR ;
       72    10591    1   DCL  BASEP$             PTR ;
       73    10592    1   DCL  CURRENT_PROC$      PTR ; /* PTR to current Proc_ ST item */
       74    10593    1   DCL  REFRESH_SEGMENT    BOOLEAN;
       75    10594    1   DCL  SEGMENT_LTS$       PTR;
       76    10595    1   DCL  SUB_TAIL$          PTR;
       77    10596    1   DCL  NEW_LABEL$         PTR;
       78    10597    1   DCL  TO_SEG_NO#         SBIN WORD;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:4    
       79    10598    1   DCL  FROM_SEG_NO#       SBIN WORD;
       80    10599    1   DCL  END_SEG_NO#        SBIN WORD;
       81    10600    1   DCL  PRE_ALTER_CHANGE   BOOLEAN;
       82    10601    1   DCL  POST_ALTER_CHANGE  BOOLEAN;
       83    10602    1   DCL  PERFORM_CHANGE     BOOLEAN;
       84    10603
       85    10604        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:5    
       86    10605
       87    10606         %MACRO RSV_ILS_ILL (@ILS_ITEM = %OPN,
       88    10607                             @ILL_ITEM = %LINOI);
       89    10608           DO;
       90    10609             %RESERVE_ILS (ITEM = @ILS_ITEM,
       91    10610                           POINTER = SUB_TAIL$ -> ILS.NEXT);
       92    10611
       93    10612             %RESERVE_ILL (ITEM = @ILL_ITEM,
       94    10613                           POINTER = SUB_TAIL$ -> ILS.NEXT -> ILS.ILL$);
       95    10614
       96    10615             SUB_TAIL$ = SUB_TAIL$ -> ILS.NEXT;
       97    10616           END;
       98    10617         %MEND;
       99    10618
      100    10619        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:6    
      101    10620    1   PFORM_LIST_MARKING: PROC ;
      102    10621
      103    10622        /*I*
      104    10623               NAME:  PFORM_LIST_MARKING
      105    10624               CALL:  CALL PFORM_LIST_MARKING ;
      106    10625
      107    10626              INPUT:  COMCOM.H_PFORM is the pointer to the top of the linked list of
      108    10627                      PFORMs.
      109    10628
      110    10629        DESCRIPTION:  This procedure looks at all the PERFORMs in the program to see
      111    10630                      which are nested.  The end label is marked as containing a PFORM
      112    10631                      if the start label contains one.  All of the interior labels
      113    10632                      between the starting and end ending labels are checked for nested
      114    10633                      performs.  If any of them contains a perform then the start label
      115    10634                      is marked as such.
      116    10635        */
      117    10636
      118    10637    2   DCL  INTERIOR_PFORM_LBL$  PTR ;
      119    10638        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:7    
      120    10639    2          O2COM.PFORM_LIST$ = COMCOM.H_PFORM ;
      121    10640
      122    10641    3          DO UNTIL O2COM.PFORM_LIST$ = ADDR(NIL) ;
      123    10642
      124    10643    3            START_LABEL$ = O2COM.PFORM_LIST$->ILS.ILL$->ILL.LOP ;
      125    10644    3            END_LABEL$ = O2COM.PFORM_LIST$->ILS.ILL$->ILL.ROP ;
      126    10645
      127    10646    3            END_LABEL$->LABEL.B.PFORM_NESTED = START_LABEL$->LABEL.B.PFORM_NESTED ;
      128    10647
      129    10648    3            TEMP$ = START_LABEL$->LABEL.PREV_ILS$ ;
      130    10649                 %NEXT_NON_SUPPORT (POINTER=TEMP$) ;
      131    10664    3            INTERIOR_PFORM_LBL$ = TEMP$->ILS.ILL$->ILL.LBL ;
      132    10665
      133    10666    3   CHECK_NESTING:
      134    10667    4            DO WHILE INTERIOR_PFORM_LBL$ ~= ADDR(NIL) ;
      135    10668    4              IF INTERIOR_PFORM_LBL$->ILS.ILL$->ILL.LOP = END_LABEL$ THEN
      136    10669    4                  EXIT CHECK_NESTING ;
      137    10670                            /* Usually control will leave this loop via the EXIT
      138    10671                               statement. It leaves by satisfying the WHILE condition
      139    10672                               only in case of a backward PERFORM. It is set up this
      140    10673                               way so as to guarantee that the 2 conditions are
      141    10674                               checked in the right order.                           */
      142    10675    4              IF INTERIOR_PFORM_LBL$->ILS.ILL$->ILL.LOP->LABEL.B.GOTO_LABEL AND
      143    10676    4                ~INTERIOR_PFORM_LBL$->ILS.ILL$->ILL.LOP->LABEL.B.COMPILER_CREATED
      144    10677    4                  THEN START_LABEL$->LABEL.B.GOTO_LABEL = TRUE ;
      145    10678    4              INTERIOR_PFORM_LBL$->ILS.ILL$->ILL.LOP->LABEL.B.INTERIOR_PFORM_LBL =
      146    10679    4                  TRUE ;
      147    10680
      148    10681    4              IF INTERIOR_PFORM_LBL$->ILS.ILL$->ILL.LOP->LABEL.B.PFORM_NESTED THEN
      149    10682    4                START_LABEL$->LABEL.B.PFORM_NESTED = TRUE ;
      150    10683
      151    10684    4              INTERIOR_PFORM_LBL$ = INTERIOR_PFORM_LBL$->ILS.ILL$->ILL.LBL ;
      152    10685
      153    10686    4            END ;
      154    10687    4            IF INTERIOR_PFORM_LBL$ = ADDR(NIL) THEN DO ;
      155    10688                                      /* Backward PERFORM, i.e., start label appears
      156    10689                                         after end label. User deserves whatever
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:8    
      157    10690                                         he/she gets. All bets are off.
      158    10691                                         So are all optimizations.                   */
      159    10692    4                START_LABEL$->LABEL.B.BACKWARD_PFORM = TRUE ;
      160    10693    4            END ;
      161    10694
      162    10695    3            O2COM.PFORM_LIST$ = O2COM.PFORM_LIST$->ILS.ILL$->PFORM.PFORM_LIST$ ;
      163    10696    3          END ;
      164    10697
      165    10698    2   END PFORM_LIST_MARKING ;
      166    10699        %EJECT;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:9    
      167    10700    1   CREATE_ITEM_ILS: PROC (ITEM_TYPE, ITEM_LOP$, ITEM_ROP$) ;
      168    10701
      169    10702    2   DCL ITEM_TYPE   UBIN WORD ; /* Type of ILL item being created */
      170    10703    2   DCL ITEM_LOP$   PTR       ; /* Left operand value of ILL entry */
      171    10704    2   DCL ITEM_ROP$   PTR       ; /* Right operand value of ILL entry */
      172    10705
      173    10706        /*I*
      174    10707               NAME:  CREATE_ITEM_ILS
      175    10708               CALL:  CALL CREATE_ITEM_ILS(ITEM_TYPE, ITEM_LOP$, ITEM_ROP$) ;
      176    10709
      177    10710              INPUT:  ITEM_TYPE - Type of ILL item to be created.
      178    10711                      ITEM_LOP$ - Left operand of ILL entry.
      179    10712                      ITEM_ROP$ - Right operand of ILL entry.
      180    10713
      181    10714        DESCRIPTION:  This procedure reserves the ILS and ILL entries to be linked in
      182    10715                      the ILS chain.  The ILS and ILL entries are linked together and
      183    10716                      the ILL entry is assigned.
      184    10717        */
      185    10718
      186    10719
      187    10720               %RESERVE_ILS(ITEM=%OPN, POINTER=PFORM_ILS$->ILS.NEXT) ;
      188    10749               %NEXT_ILS (POINTER=PFORM_ILS$) ;
      189    10754
      190    10755               %RESERVE_ILL(ITEM=ITEM_TYPE, POINTER=PFORM_ILS$->ILS.ILL$) ;
      191    10765    2          PFORM_ILS$->ILS.ILL$->ILL.LOP = ITEM_LOP$ ;
      192    10766    2          PFORM_ILS$->ILS.ILL$->ILL.ROP = ITEM_ROP$ ;
      193    10767
      194    10768    2   END CREATE_ITEM_ILS ;
      195    10769        %EJECT;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:10   
      196    10770        /*V*
      197    10771            CREATE_LINOI_AND_DEFLB - An ILS and LINOI entry are created first and then
      198    10772                                     assigned with the appropiate line numbers, etc.
      199    10773                                     Another ILS item (OPA) is created to link the DEFLB
      200    10774                                     in.  The DEFLB item is created for the ALTER label.
      201    10775                                     The new ILS item cannot be OPN because
      202    10776                                     Z8FL$LABEL_REFERENCE has already been called,
      203    10777                                     and it is too late for this label to be added
      204    10778                                     to the label list (COMCOM.H_LBL->list).
      205    10779        */
      206    10780
      207    10781        %MACRO CREATE_LINOI_AND_DEFLB (AT=PFORM_ILS$, LBL1=ALTER_LBL$) ;
      208    10782        %LSET NN=CHARTEXT(CONCAT(TEXTCHAR(AT),'->ILS.NEXT'));
      209    10783        %LSET II=CHARTEXT(CONCAT(TEXTCHAR(AT),'->ILS.ILL$'));
      210    10784               DO ;
      211    10785                 LBL1->LABEL.B.REFERENCED = TRUE ;
      212    10786                 LBL1->LABEL.PREV_ILS$ = AT ;
      213    10787                 LBL1->LABEL.PROC$ = CURRENT_PROC$ ;
      214    10788                 %RESERVE_ILS(ITEM=%OPN, POINTER=%NN) ;
      215    10789                 %NEXT_ILS (POINTER=AT) ;
      216    10790
      217    10791                 %RESERVE_ILL(ITEM=%LINOI, POINTER=%II) ;
      218    10792                 AT->ILS.ILL$->LINOI.PREV_LINE = ILS$->ILS.ILL$->LINOI.PREV_LINE ;
      219    10793                 AT->ILS.ILL$->LINOI.LINE_NO = ILS$->ILS.ILL$->LINOI.PREV_LINE ;
      220    10794                 AT->ILS.ILL$->LINOI.PREV_COL = ILS$->ILS.ILL$->LINOI.PREV_COL ;
      221    10795                 AT->ILS.ILL$->LINOI.COLUMN_NO = ILS$->ILS.ILL$->LINOI.PREV_COL ;
      222    10796
      223    10797                 %RESERVE_ILS(ITEM=%OPA, POINTER=%NN) ;
      224    10798                 %NEXT_ILS (POINTER=AT) ;
      225    10799                 AT->ILS.B.CDEF = TRUE ;
      226    10800                 AT->ILS.DEF = ADDR(NIL) ;
      227    10801
      228    10802                 %RESERVE_ILL(ITEM=%DEFLB, POINTER=%II) ;
      229    10803                 AT->ILS.ILL$->ILL.LOP = LBL1 ;
      230    10804                 AT->ILS.ILL$->ILL.LBL = ADDR (NIL) ;
      231    10805               END ;
      232    10806        %MEND ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:11   
      233    10807        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:12   
      234    10808    1   SET_UP_COBOL_74_PFORM: PROC ;
      235    10809
      236    10810        /*I*
      237    10811               NAME:  SET_UP_COBOL_74_PFORM
      238    10812               CALL:  CALL SET_UP_COBOL_74_PFORM ;
      239    10813          INTERFACE:  Z8AT$CREATE_TEMPORARY is called to create a POINTER variable.
      240    10814                      Z8AF$NEW_BASE is called to enter a BASE item into the ETT
      241    10815                      for the pointer variable.
      242    10816
      243    10817              INPUT:  PFORM_ILS$        -- Pointer to the PFORM item's ILS entry.
      244    10818                      START_LABEL$      -- Pointer to the PFORM's starting label.
      245    10819                      END_LABEL$        -- Pointer to the PFORM's ending label.
      246    10820
      247    10821        DESCRIPTION:  The outer procedure has determined a COBOL74 PERFORM must be used.
      248    10822                      This procedure creates all the items needed to set up this type of
      249    10823                      perform.
      250    10824        */
      251    10825
      252    10826
      253    10827    2   DCL  POINTER$           PTR ;
      254    10828    2   DCL  LINOI$             PTR ; /* PTR to ILS for first LINOI after ENTRY */
      255    10829    2   DCL  DO_ILS$            PTR ; /* PTR to ILS for DO2 item */
      256    10830        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:13   
      257    10831        /*V*
      258    10832            COBOL_74_PFORM_SET_UP -- The pointers are assigned so that the needed items
      259    10833                                     can be inserted in the ILS where the PFORM item
      260    10834                                     was before.  This also involves linking the PFORM
      261    10835                                     item out of the ILS as it is no longer used.
      262    10836
      263    10837                                     The pointer variables must also be created for the
      264    10838                                     end label.  If the label has already been set up
      265    10839                                     as a COBOL 74 end then we can extract the POINTER
      266    10840                                     variable otherwise a new one is created.  The
      267    10841                                     LABEL to be used in the transfer back from the
      268    10842                                     PFORM paragraph is created.
      269    10843        */
      270    10844
      271    10845                            /* First take care of the pointer variable. */
      272    10846    2          IF END_LABEL$->LABEL.B.PFORM_74_END THEN
      273    10847    2            POINTER$ = END_LABEL$->LABEL.POINTER$->ETT.LOP ;
      274    10848    2          ELSE
      275    10849    3            DO ;
      276    10850    3              CALL Z8AT$CREATE_TEMPORARY(%POINTER, POINTER$) ;
      277    10851    3              POINTER$->VARIABLE.NDSC.N = %BYTES_PER_WORD ;
      278    10852    3              POINTER$->VARIABLE.TYPE = %TYP ;
      279    10853                   %INCREMENT_STORAGE_CNT(@ITEM$=POINTER$) ;
      280    10863    3            END ;
      281    10864
      282    10865    2          CALL Z8AF$NEW_BASE (POINTER$, ADDR(NIL), POINTER$) ;
      283    10866
      284    10867                       /* Done with pointer variable. Now create a return label. */
      285    10868    2          CALL Z8AT$CREATE_TEMPORARY(%PARA, ALTER_LBL$) ;
      286    10869        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:14   
      287    10870        /*V*
      288    10871            PERFORM_EXIT -- Find end of PERFORMed code. If this paragraph or section
      289    10872                            is also the end of an optimized PERFORM then back up to
      290    10873                            before the SUB_END so the GO will be put where it
      291    10874                            belongs and the pointer will be ALTERed to continue to the
      292    10875                            right place in the fall thru case. Then insert the GO
      293    10876                            unless one has already been put there from another
      294    10877                            COBOL-74 style PERFORM.
      295    10878        */
      296    10879
      297    10880    2          END_LABEL_74$ = END_LABEL$ ;
      298    10881    2          IF NOT END_LABEL$->LABEL.B.PFORM_74_END
      299    10882    3            THEN DO ;
      300    10883    3              PFORM_ILS$ = END_LABEL$->LABEL.PREV_ILS$ ;
      301    10884    3              ILS$ = PFORM_ILS$ ;
      302    10885                   %NEXT_ILS ;
      303    10890    4              IF END_LABEL$->LABEL.B.PFORM_END THEN DO ;
      304    10891    4                TEMP$ = PFORM_ILS$->ILS.ILL$ ; /* Save ADDR(SUB_END) ILL */
      305    10892    4                PFORM_ILS$->ILS.ILL$ = ADDR (NIL) ; /* Delete the SUB_END */
      306    10893    4              END ;
      307    10894                                           /* Insert %GO at end of PERFORM group     */
      308    10895                   %RESERVE_ILS(ITEM = %OPN, POINTER = PFORM_ILS$->ILS.NEXT) ;
      309    10924                   %NEXT_ILS(POINTER = PFORM_ILS$) ;
      310    10929                   %RESERVE_ILL(ITEM = %LINOI, POINTER = PFORM_ILS$->ILS.ILL$) ;
      311    10939    3              PFORM_ILS$->ILS.ILL$->LINOI = ILS$->ILS.ILL$->LINOI ;
      312    10940    3              CALL CREATE_ITEM_ILS(%GO, POINTER$, ADDR(NIL)) ;
      313    10941    3              PFORM_ILS$->ILS.ILL$->ILL.CODE = %GO_ALTERED ;
      314    10942
      315    10943                   %CHECK_VIRTUAL_ALTERED_GO;
      316    10948
      317    10949    4              IF END_LABEL$->LABEL.B.PFORM_END THEN DO ;
      318    10950    4                CALL Z8AT$CREATE_TEMPORARY (%PARA, END_LABEL_74$) ;
      319    10951                     %CREATE_LINOI_AND_DEFLB (LBL1=END_LABEL_74$) ;
      320    11056    4                END_LABEL$->LABEL.PREV_ILS$ = PFORM_ILS$ ;
      321    11057                     /* In this case, LABEL.PREV_ILS$ points to some place
      322    11058                        other than the immediate previous ILS item. It is known that
      323    11059                        after this nobody else needs the field, and what this
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:15   
      324    11060                        internal procedure needs is the ILS item for the previous
      325    11061                        DEFLB. */
      326    11062                     %RESERVE_ILS (ITEM=%OPN, POINTER=PFORM_ILS$->ILS.NEXT) ;
      327    11091                     %NEXT_ILS (POINTER=PFORM_ILS$) ;
      328    11096    4                PFORM_ILS$->ILS.ILL$ = TEMP$ ; /* Reinsert the SUB_END. */
      329    11097    4              END ;
      330    11098    3              ELSE END_LABEL$->LABEL.PREV_ILS$ = PFORM_ILS$ ;
      331    11099    3              PFORM_ILS$->ILS.NEXT = ILS$ ;
      332    11100    3            END ;
      333    11101    2          ELSE IF END_LABEL$->LABEL.B.PFORM_END
      334    11102    2              THEN END_LABEL_74$ = END_LABEL$->LABEL.PREV_ILS$->ILS.ILL$->ILL.LOP ;
      335    11103                        /* Sure enough, needed the previous DEFLB's ILS address. */
      336    11104                   /* Get ILS address for CBL-74 exit label. */
      337    11105
      338    11106    2          PFORM_ILS$ = O2COM.PFORM_LIST$ ;
      339    11107    2          ILS$ = PFORM_ILS$ ;
      340    11108               %NEXT_ILS ;
      341    11113    2            START_LABEL$->LABEL.B.COBOL_74_PFORM = TRUE ;
      342    11114        %EJECT;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:16   
      343    11115        /*V*
      344    11116            COBOL_74_PFORM_CREATION -- Instead of the PFORM item in the ILS that was
      345    11117                                       there we insert the following items.
      346    11118
      347    11119                                           ALTER SWITCH TO ALTER_LBL.
      348    11120                                           GO TO START_LABEL.
      349    11121                                        ALTER_LBL.
      350    11122                                           ALTER SWITCH TO END_LABEL.
      351    11123                                           PRESET SWITCH TO END_LABEL.
      352    11124
      353    11125                                        If OPTZ and PERFORM n TIMES then:
      354    11126
      355    11127                                           ALTER switch TO ALTER_LBL.
      356    11128                                           DO2.
      357    11129                                           GO TO START_LABEL.
      358    11130                                        ALTER_LBL.
      359    11131                                           DOEND.
      360    11132                                           ALTER switch TO END_LABEL.
      361    11133                                           PRESET switch TO END_LABEL.
      362    11134
      363    11135                                       The appropriate bits are then assigned for the
      364    11136                                       start and end labels.
      365    11137        */
      366    11138
      367    11139    3          IF PFORM_ILL$->PFORM.DO$ ~= ADDR (NIL) THEN DO ;
      368    11140    3            PFORM_ILS$ = PFORM_ILL$->PFORM.DO$ ;
      369    11141    3            TEMP$ = PFORM_ILS$->ILS.ILL$ ; /* Save ADDR(LINOI) */
      370    11142    3            DO_ILS$ = PFORM_ILS$ ;
      371    11143                 %NEXT_ILS (POINTER=DO_ILS$) ; /* ADDR (ILS) for DO2 */
      372    11148    3          END ;
      373    11149
      374    11150    2          CALL OVERLAY_PERFORM_CHECK;
      375    11151
      376    11152
      377    11153               %SET LISTMAC = '1'B;
      378    11154
      379    11155               %PRE_PERFORM_ALTER;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:17   
             11156    3      DO;
             11157    3          IF PRE_ALTER_CHANGE THEN
             11158    4            DO;
             11159    4              CALL GEN_ALTER_CHANGE (ALTER_LBL$,
             11160    4                                     FROM_SEG_NO#,
             11161    4                                     NEW_LABEL$);
             11162    4              CALL CREATE_ITEM_ILS (%ALTER, POINTER$, NEW_LABEL$);
             11163    4            END;
             11164    3          ELSE
             11165    3            CALL CREATE_ITEM_ILS(%ALTER, POINTER$, ALTER_LBL$) ;
             11166    3      END;
      380    11168
      381    11169               %SET LISTMAC = '0'B;
      382    11170
      383    11171
      384    11172        /*  If an independent segment will be brought in, the alter switches
      385    11173            in that independent segment need to be refreshed.              */
      386    11174
      387    11175    2          CALL SEGMENT_CHECK (SEGMENT_LTS$, %MAX_FIXED_SEG# + 1);
      388    11176
      389    11177    2          IF REFRESH_SEGMENT THEN
      390    11178    2            CALL RESET_OVERLAY (SEGMENT_LTS$);
      391    11179
      392    11180    3          IF PFORM_ILL$->PFORM.DO$ ~= ADDR (NIL) THEN DO ;
      393    11181                 %RESERVE_ILS (ITEM=%OPN, POINTER=PFORM_ILS$->ILS.NEXT) ;
      394    11210                 %NEXT_ILS (POINTER=PFORM_ILS$) ;
      395    11215    3            PFORM_ILS$->ILS.ILL$ = TEMP$ ;
      396    11216    3            PFORM_ILS$->ILS.NEXT = DO_ILS$ ; /* LINOI and DO2 go here. */
      397    11217                 %NEXT_NON_LINOI (POINTER=PFORM_ILS$) ;
      398    11227    3          END ;
      399    11228
      400    11229               %SET LISTMAC = '1'B;
      401    11230
      402    11231               %PERFORM_TO_GO;
             11232    3      DO;
             11233               %RESERVE_ILS(ITEM = %OPN, POINTER = PFORM_ILS$->ILS.NEXT);
             11234    4          DO ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:18   
             11235                 %IF VARIABLE ;
             11243                 %ELSE ;
             11244                   %IF ITEM % = %OPN;
             11245                      %LSET @ILS_SIZE = CHARTEXT('SIZEW(OPN)');
             11246                   %ELSEIF ITEM = %OPV
             11252                   %ENDIF;
             11253    4              IF ILS_.BOTTOM + %@ILS_SIZE >= ILS_.FLOOR
             11254    4              THEN CALL Z8AR$RESERVER(ADDR(ILS_));
             11255    4              POINTER = PINCRW (ILS_.FIRST, ILS_.BOTTOM) ;
             11256    4              ILS_.BOTTOM = ILS_.BOTTOM + %@ILS_SIZE ;
             11257    4              POINTER->ILS.ID = ITEM % ;
             11258    4              POINTER->ILS.NEXT = ADDR(NIL);
             11259                 %ENDIF ;
             11260    4          END ;
             11262               %NEXT_ILS(POINTER = PFORM_ILS$) ;
             11263    4          DO ; /* Next ILS entry in the ILS chain */
             11264    4            POINTER = POINTER->ILS.NEXT ;
             11265    4          END ;
             11267               %RESERVE_ILL(ITEM = %LINOI, POINTER = PFORM_ILS$->ILS.ILL$);
             11268    4        DO;
             11269    4          ITERATION = ILL_STEP(ITEM% - %FIRST_ILL);
             11270    4          IF ILL_.BOTTOM + ITERATION >= ILL_.FLOOR THEN
             11271    4            CALL Z8AR$RESERVER(ADDR(ILL_));
             11272    4          POINTER = PINCRW(ILL_.FIRST, ILL_.BOTTOM);
             11273    4          ILL_.BOTTOM = ILL_.BOTTOM + ITERATION;
             11274    4          POINTER -> ILL.ID = ITEM %;
             11275    4        END;
             11277    3          PFORM_ILS$->ILS.ILL$->LINOI.PREV_LINE = COMCOM.CURRENT.LINE;
             11278    3          PFORM_ILS$->ILS.ILL$->LINOI.LINE_NO = COMCOM.CURRENT.LINE;
             11279    3          PFORM_ILS$->ILS.ILL$->LINOI.PREV_COL = COMCOM.CURRENT.COLUMN;
             11280    3          PFORM_ILS$->ILS.ILL$->LINOI.COLUMN_NO = COMCOM.CURRENT.COLUMN;
             11281    3          IF PERFORM_CHANGE THEN
             11282    4            DO;
             11283    4              CALL GEN_ALTER_CHANGE (START_LABEL$,
             11284    4                                     TO_SEG_NO#,
             11285    4                                     NEW_LABEL$);
             11286    4              CALL CREATE_ITEM_ILS (%GO, NEW_LABEL$, ADDR(NIL));
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:19   
             11287    4            END;
             11288    3          ELSE
             11289    3            CALL CREATE_ITEM_ILS(%GO, START_LABEL$, ADDR(NIL)) ;
             11290    3      END;
      403    11292
      404    11293               %SET LISTMAC = '0'B;
      405    11294
      406    11295    2          PFORM_ILS$->ILS.ILL$->ILL.CODE = %GO_UNCONDITIONAL ;
      407    11296               %CREATE_LINOI_AND_DEFLB ;
      408    11401    3          IF PFORM_ILL$->PFORM.DO$ ~= ADDR (NIL) THEN DO ;
      409    11402    3            PFORM_ILS$->ILS.NEXT = ILS$ ;
      410    11403                 /* The ALTER and PRESET go after the DOEND in this case. */
      411    11404    4            DO UNTIL PFORM_ILS$->ILS.ILL$->ILL.ID = %DOEND ;
      412    11405                   %NEXT_ILS (POINTER=PFORM_ILS$) ;
      413    11410    4            END ;
      414    11411    3            ILS$ = PFORM_ILS$->ILS.NEXT ;
      415    11412    3          END ;
      416    11413
      417    11414               %SET LISTMAC = '1'B;
      418    11415
      419    11416               %POST_PERFORM_ALTER;
             11417    3      DO;
             11418    3          IF POST_ALTER_CHANGE THEN
             11419    4            DO;
             11420    4              CALL GEN_ALTER_CHANGE (END_LABEL_74$,
             11421    4                                     END_SEG_NO#,
             11422    4                                     NEW_LABEL$);
             11423    4              CALL CREATE_ITEM_ILS (%ALTER, POINTER$, NEW_LABEL$);
             11424    4            END;
             11425    3          ELSE
             11426    3            CALL CREATE_ITEM_ILS(%ALTER, POINTER$, END_LABEL_74$) ;
             11427    3      END;
      420    11429
      421    11430               %SET LISTMAC = '0'B;
      422    11431
      423    11432    2          IF NOT (END_LABEL$->LABEL.B.PFORM_74_END) THEN
      424    11433    3            DO ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:20   
      425    11434    3              END_LABEL$->LABEL.B.GOTO_LABEL = TRUE ;
      426    11435    3              END_LABEL$->LABEL.POINTER$ = POINTER$ ;
      427    11436    3              CALL CREATE_ITEM_ILS(%PTR_SET, POINTER$->ETT.LOP, END_LABEL_74$) ;
      428    11437    3              END_LABEL$->LABEL.B.PFORM_74_END = TRUE ;
      429    11438    3              IF CURRENT_PROC$->PROC_.PROC_DEF$->PROC_DEF.ID = %INTDEF
      430    11439    3                THEN ENTRY$ = COMCOM.INT_SUB$ ;
      431    11440    3                ELSE ENTRY$ = COMCOM.H_ENTRY$ ;
      432    11441                     /* The subroutine entries need to initialize the PERFORM, too. */
      433    11442    3              ALTER$ = ADDR (NIL) ;
      434    11443    4              DO UNTIL ENTRY$ = ADDR (NIL) ;
      435    11444    4                IF ENTRY$->ILS.ILL$->ENTRY_ILL.LOP->PROC_DEF.PROC$
      436    11445    5                    = CURRENT_PROC$ THEN DO ;
      437    11446    5                  LINOI$ = ENTRY$ ;
      438    11447    6                  DO UNTIL LINOI$->ILS.ILL$->ILL.ID = %LINOI ;
      439    11448                         %NEXT_ILS (POINTER=LINOI$) ;
      440    11453    6                  END ;
      441    11454    6                  IF ALTER$ = ADDR(NIL) THEN DO ;
      442    11455                         %RESERVE_ILL (ITEM=%ALTER, POINTER=ALTER$) ;
      443    11465    6                    ALTER$->ILL.LOP = POINTER$ ;
      444    11466    6                    ALTER$->ILL.ROP = END_LABEL_74$ ;
      445    11467    6                  END ;
      446    11468                       %RESERVE_ILS (ITEM=%OPN, POINTER=TEMP$) ;
      447    11497                       %RESERVE_ILL (ITEM=%LINOI, POINTER=TEMP$->ILS.ILL$) ;
      448    11507    5                  TEMP$->ILS.ILL$->LINOI = LINOI$->ILS.ILL$->LINOI ;
      449    11508    5                  TEMP$->ILS.ILL$->LINOI.LINE_NO = LINOI$->ILS.ILL$->LINOI.PREV_LINE ;
      450    11509    5                  TEMP$->ILS.ILL$->LINOI.COLUMN_NO = LINOI$->ILS.ILL$->LINOI.PREV_COL ;
      451    11510    5                  TEMP$->ILS.ILL$->LINOI.TYPE = %NO_STATEMENT_TYPE ;
      452    11511                       %RESERVE_ILS (ITEM=%OPN, POINTER=TEMP$->ILS.NEXT) ;
      453    11540    5                  TEMP$->ILS.NEXT->ILS.ILL$ = ALTER$ ;
      454    11541    5                  TEMP$->ILS.NEXT->ILS.NEXT = ENTRY$->ILS.NEXT ;
      455    11542    5                  ENTRY$->ILS.NEXT = TEMP$ ;
      456    11543    5                END ;
      457    11544    4                ENTRY$ = ENTRY$->ILS.ILL$->ENTRY_ILL.PREV_ENTRY_ILS$ ;
      458    11545    4              END ;
      459    11546    3            END ;
      460    11547
      461    11548    2          PFORM_ILS$->ILS.NEXT = ILS$ ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:21   
      462    11549
      463    11550    2          TEMP$ = PFORM_ILS$;
      464    11551
      465    11552               %NEXT_NON_SUPPORT (POINTER = TEMP$);
      466    11567
      467    11568    2          IF TEMP$ -> ILS.ILL$ -> ILL.ID = %DEFLB THEN
      468    11569    2            TEMP$ -> ILS.ILL$ -> ILL.LOP -> LABEL.PREV_ILS$ = PFORM_ILS$;
      469    11570
      470    11571
      471    11572    2   END SET_UP_COBOL_74_PFORM ;
      472    11573        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:22   
      473    11574    1   SET_UP_OPTIMIZED_PFORM: PROC ;
      474    11575
      475    11576        /*I*
      476    11577               NAME:  SET_UP_OPTIMIZED_PFORM
      477    11578               CALL:  CALL SET_UP_OPTIMIZED_PFORM ;
      478    11579          INTERFACE:  Z8AT$CREATE_TEMPORARY is called to create a safestore
      479    11580                      location for the return address.
      480    11581                      Z8AF$NEW_BASE is called to enter a BASE item into the ETT
      481    11582                      for the temp.
      482    11583
      483    11584              INPUT:  PFORM_ILS$        -- Pointer to the PFORM item's ILS entry.
      484    11585                      START_LABEL$      -- Pointer to the PFORM's starting label.
      485    11586                      END_LABEL$        -- Pointer to the PFORM's ending label.
      486    11587
      487    11588        DESCRIPTION:  The outer procedure has determined that this PERFORM can be
      488    11589                      optimized. This procedure sets up all the items needed for this
      489    11590                      type of PERFORM.
      490    11591        */
      491    11592        %EJECT;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:23   
      492    11593        /*V*
      493    11594            SET_UP_OPTIMIZED_PFORM -- The PFORM item is unlinked from the ILS as it
      494    11595                                      is no longer used. A GO_SUB item is
      495    11596                                      inserted in its place. If it has not already
      496    11597                                      been done then:
      497    11598                                      A temp location is reserved for safestoring
      498    11599                                      the return address in case it is necessary.
      499    11600                                      A SUB_ENTRY item is inserted after the
      500    11601                                      start label. A SUB_END item is inserted
      501    11602                                      before the end label.
      502    11603        */
      503    11604
      504    11605    2   DCL GO_ILL$ PTR ;
      505    11606
      506    11607
      507    11608               %VIRTUAL_SEGMENT_CHECK;
      508    11613
      509    11614    2          CALL SEGMENT_CHECK (SEGMENT_LTS$,
      510    11615    2                  COMCOM.SEG_LIMIT);
      511    11616
      512    11617    2          IF REFRESH_SEGMENT THEN
      513    11618    3            DO;
      514    11619    3              PFORM_ILL$ -> ILL.CODE = 0;
      515    11620    3              RETURN;
      516    11621    3            END;
      517    11622
      518    11623               %RESERVE_ILS(ITEM=%OPA, POINTER=PFORM_ILS$->ILS.NEXT) ;
      519    11652               %NEXT_ILS (POINTER=PFORM_ILS$) ;
      520    11657    2          PFORM_ILS$->ILS.DEF = ADDR(NIL) ;
      521    11658    2          PFORM_ILS$->ILS.B.CDEF = TRUE ;
      522    11659               %RESERVE_ILL(ITEM=%GO_SUB, POINTER=PFORM_ILS$->ILS.ILL$) ;
      523    11669              /* PFORM_ILS$->ILS.ILL$->ILL.LOP will be set later. */
      524    11670    2          GO_ILL$ = PFORM_ILS$->ILS.ILL$ ;
      525    11671    2          PFORM_ILS$->ILS.NEXT = ILS$ ;
      526    11672    2          IF DEFLB_FOLLOWS
      527    11673    2            THEN LABEL_AFTER_PFORM$->LABEL.PREV_ILS$ = PFORM_ILS$ ;
      528    11674    2          PFORM_ILS$ = START_LABEL$->LABEL.PREV_ILS$ ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:24   
      529    11675    2          ILS$ = PFORM_ILS$ ;
      530    11676               %NEXT_ILS ;
      531    11681    2          TEMP$ = ILS$ ;
      532    11682               %NEXT_NON_SUPPORT (POINTER=TEMP$) ;
      533    11697        /*V*
      534    11698            GENERATE_SUB_ENTRY -- Perhaps a PERFORM to this paragraph has already
      535    11699                                  been compiled. If so, the SUB_ENTRY and SUB_END
      536    11700                                  items already exist and TEMP$ points to the
      537    11701                                  SUB_ENTRY. Else generate the SUB_ENTRY
      538    11702                                  and SUB_END now; if START_LABEL$->LABEL.B.FALL_THRU
      539    11703                                  then also generate a SUB_PREP.
      540    11704        */
      541    11705    2          IF ILS$->ILS.ILL$->ILL.ID ~= %SUB_ENTRY
      542    11706    3            THEN DO ;
      543    11707
      544    11708    3              IF START_LABEL$->LABEL.B.PFORM_NESTED
      545    11709    4                THEN DO ; /* Generate temp only if Phase 4 will need it. */
      546    11710    4                  CALL Z8AT$CREATE_TEMPORARY(%SCALAR, END_TEMP$) ;
      547    11711                       %INCREMENT_STORAGE_CNT(@ITEM$=END_TEMP$) ;
      548    11721
      549    11722    4                  END_TEMP$->VARIABLE.TYPE = %TYI ;
      550    11723    4                  END_TEMP$->VARIABLE.NDSC.N = %COMP6_LENGTH ;
      551    11724
      552    11725    4                  CALL Z8AF$NEW_BASE (END_TEMP$,
      553    11726    4                                      ADDR(NIL),
      554    11727    4                                      END_TEMP$) ;
      555    11728    4                END ;
      556    11729    3                ELSE END_TEMP$ = ADDR (NIL) ;
      557    11730    3              IF START_LABEL$->LABEL.B.FALL_THRU
      558    11731    4                THEN DO;
      559    11732    4                  END_LABEL$->LABEL.B.GOTO_LABEL = TRUE ;
      560    11733    4                  CALL CREATE_ITEM_ILS (%SUB_PREP, END_LABEL$, ADDR(NIL)) ;
      561    11734    4                END;
      562    11735    3              CALL Z8AT$CREATE_TEMPORARY(%PARA, ALTER_LBL$) ; /*#30708*/
      563    11736                   %CREATE_LINOI_AND_DEFLB ;
      564    11841    3              START_LABEL$->LABEL.PREV_ILS$ = PFORM_ILS$ ;
      565    11842                   /* LABEL.PREV_ILS$ needs to point here, not to the immediate
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:25   
      566    11843                      prior ILS item (for SUB_ENTRY) so that if another PERFORM of
      567    11844                      the same paragraph or section occurs and is to be optimized,
      568    11845                      the GO_SUB's LOP can be set to point to this created label.
      569    11846                      After Z8FP nobody will ever need LABEL.PREV_ILS$ again. */
      570    11847    3              GO_ILL$->ILL.LOP = ALTER_LBL$ ;
      571    11848    3              CALL CREATE_ITEM_ILS (%SUB_ENTRY, START_LABEL$, END_TEMP$) ;
      572    11849    3              PFORM_ILS$->ILS.NEXT = ILS$ ;
      573    11850    3              PFORM_ILS$ = END_LABEL$->LABEL.PREV_ILS$ ;
      574    11851    3              ILS$ = PFORM_ILS$ ;
      575    11852                   %NEXT_ILS ;
      576    11857                   %RESERVE_ILS (ITEM=%OPN,POINTER="PFORM_ILS$->ILS.NEXT") ;
      577    11886                   %NEXT_ILS (POINTER=PFORM_ILS$) ;
      578    11891                   %RESERVE_ILL (ITEM=%LINOI,POINTER="PFORM_ILS$->ILS.ILL$") ;
      579    11901    3              PFORM_ILS$ -> ILS.ILL$ -> LINOI.PREV_LINE = COMCOM.CURRENT.LINE ;
      580    11902    3              PFORM_ILS$ -> ILS.ILL$ -> LINOI.LINE_NO = COMCOM.CURRENT.LINE ;
      581    11903    3              PFORM_ILS$ -> ILS.ILL$ -> LINOI.PREV_COL = COMCOM.CURRENT.COLUMN ;
      582    11904    3              PFORM_ILS$ -> ILS.ILL$ -> LINOI.COLUMN_NO = COMCOM.CURRENT.COLUMN ;
      583    11905    3              CALL CREATE_ITEM_ILS (%SUB_END, START_LABEL$, END_TEMP$) ;
      584    11906    3              PFORM_ILS$->ILS.NEXT = ILS$ ;
      585    11907    3              END_LABEL$->LABEL.PREV_ILS$ = PFORM_ILS$ ;
      586    11908    3            END ;
      587    11909    2          ELSE
      588    11910    2            GO_ILL$->ILL.LOP = PFORM_ILS$->ILS.ILL$->ILL.LOP ;
      589    11911    2          START_LABEL$->LABEL.B.PFORM_START = TRUE ;
      590    11912    2          END_LABEL$->LABEL.B.PFORM_END = TRUE ;
      591    11913    2          START_LABEL$->LABEL.P_END$ = END_LABEL$ ;
      592    11914    2          END_LABEL$->LABEL.B.PFORM_NESTED = START_LABEL$->LABEL.B.PFORM_NESTED ;
      593    11915    2   END SET_UP_OPTIMIZED_PFORM ;
      594    11916        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:26   
      595    11917
      596    11918         /*=============*/
      597    11919    1      SEGMENT_CHECK: PROC (SEG_LTS$, SEGMENT_LIMIT);
      598    11920         /*=============*/
      599    11921
      600    11922         /*I*
      601    11923
      602    11924               NAME: SEGMENT_CHECK
      603    11925
      604    11926          DESCRIPTION: This routine checks if the program control will
      605    11927                       flow into a different independent segment and
      606    11928                       set the bit REFRESH_SEGMENT on if it is true.
      607    11929         */
      608    11930
      609    11931
      610    11932    2   DCL PFORM_SEG$     PTR;
      611    11933    2   DCL SEG_LTS$       PTR;
      612    11934    2   DCL SEGMENT_LIMIT  SBIN WORD;
      613    11935
      614    11936
      615    11937    2          REFRESH_SEGMENT = FALSE;
      616    11938    2          SEG_LTS$ = ADDR(NIL);
      617    11939
      618    11940    2          IF COMCOM.SEGMENTC <= 1 THEN
      619    11941    2            RETURN;
      620    11942
      621    11943    2          IF START_LABEL$ -> LABEL.ID = %SECTION THEN
      622    11944    2            SEG_LTS$ = START_LABEL$ -> SECTION.SEGMENT$;
      623    11945    2          ELSE
      624    11946    2            IF START_LABEL$ -> LABEL.SECTION$ ~= ADDR(NIL) THEN
      625    11947    2              SEG_LTS$ = START_LABEL$ -> LABEL.SECTION$ -> SECTION.SEGMENT$;
      626    11948
      627    11949    2          IF SEG_LTS$ ~= ADDR(NIL) AND
      628    11950    2             SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO# >= SEGMENT_LIMIT THEN
      629    11951    3            DO;
      630    11952    3              PFORM_SEG$ = ADDR(NIL);
      631    11953
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:27   
      632    11954    3              IF PFORM_ILL$ -> PFORM.BRANCH$ -> ILS.ID = %SECTION THEN
      633    11955    3                PFORM_SEG$ = PFORM_ILL$ -> PFORM.BRANCH$ -> SECTION.SEGMENT$;
      634    11956
      635    11957    3              IF PFORM_SEG$ ~= ADDR(NIL) AND
      636    11958    3                 PFORM_SEG$ -> SEGMENT_LTS.SEGMENT_NO# ~=
      637    11959    3                 SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO# THEN
      638    11960    3                REFRESH_SEGMENT = TRUE;
      639    11961
      640    11962    3            END;
      641    11963
      642    11964    2    END SEGMENT_CHECK;
      643    11965         %EJECT;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:28   
      644    11966
      645    11967         /*=============*/
      646    11968    1      RESET_OVERLAY: PROC (SEG_LTS$);
      647    11969         /*=============*/
      648    11970
      649    11971         /*I*
      650    11972
      651    11973               NAME: RESET_OVERLAY
      652    11974
      653    11975          DESCRIPTION: This routine generates the subroutine call to call
      654    11976                       the subroutine that wiill refresh the alter switches
      655    11977                       in the independent segment indicated by SEG_LTS$.
      656    11978         */
      657    11979
      658    11980
      659    11981    2   DCL SEG_LTS$       PTR;
      660    11982    2   DCL SEG_NO#        SBIN WORD;
      661    11983    2   DCL ARRAY$         PTR;
      662    11984    2   DCL CALL_LABEL$    PTR;
      663    11985
      664    11986
      665    11987
      666    11988    2          SEG_NO# = SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO#;
      667    11989    2          ARRAY$ = CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.SEG_ARRAY$;
      668    11990    2          CALL_LABEL$ = ARRAY$ -> LTS_PTR_ARRAY.P$(SEG_NO#) -> SEGMENT_LTS.SUB_LABEL$;
      669    11991
      670    11992    2          IF CALL_LABEL$ ~= ADDR(NIL) THEN
      671    11993    3            DO;
      672    11994
      673    11995                   %GET_RESET_OVERLAY;
      674    12001
      675    12002    3            END;
      676    12003
      677    12004    2    END RESET_OVERLAY;
      678    12005         %EJECT;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:29   
      679    12006
      680    12007         /*================*/
      681    12008    1      GEN_ALTER_CHANGE: PROC (LABEL$$, SEG_NO#, CHANGE_LABEL$);
      682    12009         /*================*/
      683    12010
      684    12011
      685    12012    2   DCL LABEL$$            PTR;
      686    12013    2   DCL SEG_NO#            SBIN WORD;
      687    12014    2   DCL CHANGE_LABEL$      PTR;
      688    12015    2   DCL TRA_END_LABEL$     PTR;
      689    12016    2   DCL PREV_ILS_NEXT$     PTR;
      690    12017    2   DCL ENTRY_LINOI$       PTR;
      691    12018
      692    12019             /* pick up the label on the top of the procedure division,
      693    12020                detail see Z8FJ main program.                          */
      694    12021
      695    12022    2      TRA_END_LABEL$ = CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.SEG_ARRAY$ ->
      696    12023    2                       LTS_PTR_ARRAY.P$ (1) -> ILS.ILL$ -> ILL.LOP;
      697    12024
      698    12025    2      CALL Z8AT$CREATE_TEMPORARY (%PARA, CHANGE_LABEL$);
      699    12026
      700    12027    2      CHANGE_LABEL$ -> LABEL.B.REFERENCED = TRUE;
      701    12028    2      CHANGE_LABEL$ -> LABEL.B.GOTO_LABEL = TRUE;
      702    12029    2      CHANGE_LABEL$ -> LABEL.B.ONE_REF = TRUE;
      703    12030    2      CHANGE_LABEL$ -> LABEL.PROC$        = CURRENT_PROC$;
      704    12031    2      SUB_TAIL$ = TRA_END_LABEL$ -> LABEL.PREV_ILS$;
      705    12032    2      CHANGE_LABEL$ -> LABEL.PREV_ILS$ = SUB_TAIL$;
      706    12033    2      PREV_ILS_NEXT$ = SUB_TAIL$ -> ILS.NEXT;
      707    12034
      708    12035           %FIND_LINE_NO (@START_ITEM$ = SUB_TAIL$);
      709    12051    2      ENTRY_LINOI$ = O2COM.LINE_NO$ -> ILS.ILL$;
      710    12052
      711    12053           %RSV_ILS_ILL (@ILL_ITEM = %LINOI);
      712    12099
      713    12100    2      SUB_TAIL$ -> ILS.ILL$ -> LINOI = O2COM.LINE_NO$ -> ILS.ILL$ -> LINOI;
      714    12101           %RSV_ILS_ILL (@ILL_ITEM = %DEFLB);
      715    12147
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:30   
      716    12148    2      SUB_TAIL$ -> ILS.ILL$ -> ILL.LOP = CHANGE_LABEL$;
      717    12149
      718    12150           %OVERLAY_ALTERED_GO (@ARG1 = LABEL$$,
      719    12151                                @ARG2 = SEG_NO#);
      720    12160
      721    12161    2      SUB_TAIL$ -> ILS.NEXT = PREV_ILS_NEXT$;
      722    12162    2      TRA_END_LABEL$ -> LABEL.PREV_ILS$ = SUB_TAIL$;
      723    12163
      724    12164    2    END GEN_ALTER_CHANGE;
      725    12165         %EJECT;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:31   
      726    12166
      727    12167         /*=====================*/
      728    12168    1      OVERLAY_PERFORM_CHECK: PROC;
      729    12169         /*=====================*/
      730    12170
      731    12171
      732    12172    2   DCL SEG_LTS$           PTR;
      733    12173
      734    12174
      735    12175
      736    12176    2      PRE_ALTER_CHANGE = FALSE;
      737    12177    2      POST_ALTER_CHANGE = FALSE;
      738    12178    2      PERFORM_CHANGE = FALSE;
      739    12179                /* IF ON CP-6 THEN RETURN */
      740    12180           %CP6_RETURN_CHECK;
      741    12186
      742    12187           %FIND_LINE_NO (@START_ITEM$ = O2COM.PFORM_LIST$ -> ILS.NEXT);
      743    12203
      744    12204    2      IF START_LABEL$ -> LABEL.ID = %SECTION THEN
      745    12205    2        SEG_LTS$ = START_LABEL$ -> SECTION.SEGMENT$;
      746    12206    2      ELSE
      747    12207    2        IF START_LABEL$ -> LABEL.SECTION$ ~= ADDR(NIL) THEN
      748    12208    2          SEG_LTS$ = START_LABEL$ -> LABEL.SECTION$ -> SECTION.SEGMENT$;
      749    12209
      750    12210    2      IF SEG_LTS$ ~= ADDR(NIL) AND
      751    12211    2        SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO# >= COMCOM.SEG_LIMIT THEN
      752    12212    2        TO_SEG_NO# = SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO#;
      753    12213    2      ELSE
      754    12214    2        TO_SEG_NO# = %FIXED_SEGMENT;
      755    12215
      756    12216    2      IF PFORM_ILL$ -> PFORM.BRANCH$ -> ILS.ID = %SECTION THEN
      757    12217    2        SEG_LTS$ = PFORM_ILL$ -> PFORM.BRANCH$ -> SECTION.SEGMENT$;
      758    12218
      759    12219    2      IF SEG_LTS$ ~= ADDR(NIL) AND
      760    12220    2        SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO# >= COMCOM.SEG_LIMIT THEN
      761    12221    3        DO;
      762    12222    3          FROM_SEG_NO# = SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO#;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:32   
      763    12223    3          IF FROM_SEG_NO# ~= TO_SEG_NO# THEN
      764    12224    4            DO;
      765    12225    4              PRE_ALTER_CHANGE = TRUE;
      766    12226    4              POST_ALTER_CHANGE = TRUE;
      767    12227    4          END;
      768    12228    3        END;
      769    12229    2      ELSE
      770    12230    2        FROM_SEG_NO# = %FIXED_SEGMENT;
      771    12231
      772    12232    2      IF FROM_SEG_NO# ~= TO_SEG_NO# AND
      773    12233    2        TO_SEG_NO# ~= %FIXED_SEGMENT THEN
      774    12234    2        PERFORM_CHANGE = TRUE;
      775    12235
      776    12236    2      IF END_LABEL$ -> LABEL.SECTION$ ~= ADDR(NIL) THEN
      777    12237    2        END_SEG_NO# = END_LABEL$ -> LABEL.SECTION$ -> SECTION.SEGMENT$ ->
      778    12238    2                      SEGMENT_LTS.SEGMENT_NO#;
      779    12239    2      ELSE
      780    12240    2        END_SEG_NO# = TO_SEG_NO#;
      781    12241
      782    12242    2      IF END_SEG_NO# < COMCOM.SEG_LIMIT  THEN
      783    12243    2        POST_ALTER_CHANGE = FALSE;
      784    12244
      785    12245    2    END OVERLAY_PERFORM_CHECK;
      786    12246         %EJECT;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:33   
      787    12247
      788    12248
      789    12249                   /*          MAIN PROGRAM                 */
      790    12250
      791    12251
      792    12252        /*V*
      793    12253            MAIN_PROGRAM_PRESET -- PFORM_LIST_MARKING is called to mark all of the
      794    12254                                   performed labels as either containing nested performs
      795    12255                                   or not.
      796    12256        */
      797    12257
      798    12258    1          CALL PFORM_LIST_MARKING ;
      799    12259        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:34   
      800    12260        /*V*
      801    12261            MAIN_PROGRAM_LOOP -- All of the performs are looked at to see how they will
      802    12262                                 be set up.  If any of these conditions exist then a
      803    12263                                 COBOL 74 PFORM is used.
      804    12264
      805    12265                                   1.  The start label is the destination of a GO TO.
      806    12266
      807    12267                                   2.  Either the start label or the end label has a
      808    12268                                       perform nested within.
      809    12269
      810    12270                                   3.  Backward PERFORM, i.e., start label appears
      811    12271                                       after end label in program.
      812    12272
      813    12273                                If none of the above conditions are met then an
      814    12274                                optimized perform is used.  This involves creating a
      815    12275                                temporary scalar entry and marking the appropiate
      816    12276                                bits in the starting and ending labels. The PFORM is
      817    12277                                replaced by a GO_SUB, and SUB_ENTRY and SUB_END items
      818    12278                                and if necessary then a SUB_PREP are created.
      819    12279        */
      820    12280        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:35   
      821    12281    1          O2COM.PFORM_LIST$ = COMCOM.H_PFORM ;
      822    12282
      823    12283    2          DO UNTIL O2COM.PFORM_LIST$ = ADDR(NIL) ;
      824    12284    2            PFORM_ILL$ = O2COM.PFORM_LIST$->ILS.ILL$ ;
      825    12285    2            START_LABEL$ = PFORM_ILL$->ILL.LOP ;
      826    12286    2            CURRENT_PROC$ = START_LABEL$->LABEL.PROC$ ;
      827    12287    2            END_LABEL$ = PFORM_ILL$->ILL.ROP ;
      828    12288    2            PFORM_ILS$ = O2COM.PFORM_LIST$ ;
      829    12289    2            ILS$ = PFORM_ILS$ ;
      830    12290                 %NEXT_ILS ;
      831    12295    2            DEFLB_FOLLOWS = FALSE ; /* Usual case */
      832    12296    2            TEMP$ = PFORM_ILS$ ;
      833    12297                 %NEXT_NON_SUPPORT (POINTER=TEMP$) ;
      834    12312    3            IF TEMP$->ILS.ILL$->ILL.ID = %DEFLB THEN DO;
      835    12313    3              DEFLB_FOLLOWS = TRUE ; /* Next statement is a label. */
      836    12314    3              LABEL_AFTER_PFORM$ = TEMP$->ILS.ILL$->ILL.LOP ;
      837    12315    3            END;
      838    12316
      839    12317    2            IF START_LABEL$->LABEL.B.GOTO_LABEL OR
      840    12318    2               START_LABEL$->LABEL.B.BACKWARD_PFORM OR
      841    12319    2               START_LABEL$->LABEL.B.INTERIOR_PFORM_LBL OR
      842    12320    2               END_LABEL$->LABEL.B.INTERIOR_PFORM_LBL
      843    12321    2              THEN PFORM_ILL$->ILL.CODE = 0 ;
      844    12322                          /* COBOL-74 PERFORM - Wait till next loop. */
      845    12323    2            ELSE
      846    12324    3              DO ;
      847    12325    3                PFORM_ILL$->ILL.CODE = 1; /* Flag this as optimized. */
      848    12326    3                TEMP$ = PFORM_ILS$ ;
      849    12327    4                DO UNTIL TEMP$ -> ILS.ILL$ -> ILL.ID = %LINOI ;
      850    12328    5                  DO UNTIL TEMP$ -> ILS.ILL$ ~= ADDR (NIL) ;
      851    12329                         %NEXT_ILS (POINTER=TEMP$) ;
      852    12334    5                  END ;
      853    12335    4                END ;
      854    12336    3                COMCOM.CURRENT.LINE = TEMP$ -> ILS.ILL$ -> LINOI.PREV_LINE ;
      855    12337    3                COMCOM.CURRENT.COLUMN = TEMP$ -> ILS.ILL$ -> LINOI.PREV_COL ;
      856    12338    3                CALL SET_UP_OPTIMIZED_PFORM ;
      857    12339    3              END ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:36   
      858    12340
      859    12341    2            O2COM.PFORM_LIST$ = PFORM_ILL$->PFORM.PFORM_LIST$ ;
      860    12342    2          END ;
      861    12343
      862    12344    1          O2COM.PFORM_LIST$ = COMCOM.H_PFORM ; /* Get ready to scan list again*/
      863    12345    2          DO UNTIL O2COM.PFORM_LIST$ = ADDR(NIL) ;
      864    12346    2            PFORM_ILL$ = O2COM.PFORM_LIST$->ILS.ILL$ ;
      865    12347    2            O2COM.PFORM_LIST$->ILS.ILL$ = ADDR (NIL) ; /* PFORM will be deleted */
      866    12348    2            IF PFORM_ILL$->ILL.CODE = 0 THEN /* This PFORM wasn't optimized. */
      867    12349    3              DO ;
      868    12350    3                START_LABEL$ = PFORM_ILL$->ILL.LOP ;
      869    12351    3                CURRENT_PROC$ = START_LABEL$->LABEL.PROC$ ;
      870    12352    3                END_LABEL$ = PFORM_ILL$->ILL.ROP ;
      871    12353    3                PFORM_ILS$ = O2COM.PFORM_LIST$ ;
      872    12354    3                ILS$ = PFORM_ILS$ ;
      873    12355    4                DO UNTIL ILS$ -> ILS.ILL$ -> ILL.ID = %LINOI ;
      874    12356    5                  DO UNTIL ILS$ -> ILS.ILL$ ~= ADDR (NIL) ;
      875    12357                     %NEXT_ILS ;
      876    12362    5                  END ;
      877    12363    4                END ;
      878    12364    3                COMCOM.CURRENT.LINE = ILS$ -> ILS.ILL$ -> LINOI.PREV_LINE ;
      879    12365    3                COMCOM.CURRENT.COLUMN = ILS$ -> ILS.ILL$ -> LINOI.PREV_COL ;
      880    12366
      881    12367    3                CALL SET_UP_COBOL_74_PFORM ;
      882    12368
      883    12369    3              END ;
      884    12370    2            O2COM.PFORM_LIST$ = PFORM_ILL$->PFORM.PFORM_LIST$ ;
      885    12371    2          END;
      886    12372
      887    12373    1   END Z8FP$PFORM_CHECKING ;

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:37   
--  Include file information  --

   Z8F_O2COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9A_SUPP_MAC.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure Z8FP$PFORM_CHECKING.

   Procedure Z8FP$PFORM_CHECKING requires 2104 words for executable code.
   Procedure Z8FP$PFORM_CHECKING requires 52 words of local(AUTO) storage.

    No errors detected in file Z8FP.:Z8A6TSI    .

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:38   

 Object Unit name= Z8FP$PFORM_CHECKING                        File name= Z8FP.:Z8A6TOU
 UTS= AUG 09 '97 13:10:56.32 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  ETT$
    2  LblCom even  none     1      1  HEAD_ETT$
    3  LblCom even  none   512   1000  ETT_BUCKETS
    4  LblCom even  none     5      5  ETT_
    5  LblCom even  none     1      1  ILL$
    6  LblCom even  none     5      5  ILL_
    7  LblCom even  none     1      1  ILS$
    8  LblCom even  none     5      5  ILS_
    9  LblCom even  none     1      1  LTS$
   10  LblCom even  none     5      5  LTS_
   11  LblCom even  none     1      1  ST$
   12  LblCom even  none     5      5  ST_
   13  LblCom even  none    12     14  O2COM
   14   Proc  even  none  2104   4070  Z8FP$PFORM_CHECKING
   15  RoData even  none    27     33  Z8FP$PFORM_CHECKING

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    14      0   yes            yes      Std        0  Z8FP$PFORM_CHECKING
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:39   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 Z8AR$RESERVER
         yes           Std       2 Z8AT$CREATE_TEMPORARY
         yes           Std       3 Z8AF$NEW_BASE
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                           r    ILL_STEP                         r    ILS_STEP_TABLE
r    LTS_STEP

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:40   


        1        1        /*M*   Z8FP$PFORM_CHECKING                                          */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8               NAME: Z8FP$PFORM_CHECKING
        9        9        DESCRIPTION: Check all remianing PFORMs. Convert to CBL-74 style if
       10       10                     need be, but whenever possible make it an optimized PERFORM
       11       11                     using %GO_SUB.
       12       12        */
       13       13        /*D*
       14       14               NAME:  Z8FP$PFORM_CHECKING
       15       15               CALL:  CALL Z8FP$PFORM_CHECKING ;
       16       16          INTERFACE:  Z8AT$CREATE_TEMPORARY is called to create switches and scalars.
       17       17                      Z8AF$NEW_BASE is called to create BASEs.
       18       18
       19       19              INPUT:  COMCOM.H_PFORM is the top of the linked list of PFORM items.
       20       20
       21       21        DESCRIPTION:  This procedure looks at all of the PFORMs left in the program
       22       22                      after Z8FF$FLOW_ANALYSIS.  Z8FF$FLOW_ANALYSIS may copy some
       23       23                      performs in line or transfer them in line.  The PFORMs are looked
       24       24                      at to see if how they should be set up.
       25       25
       26       26                      There are two options in the way they are set up.
       27       27
       28       28                           1. Optimized PERFORM.
       29       29                              Set up as straight transfers in Phase 4 (code generation).
       30       30                              The PFORM item is replaced with a GO_SUB item, and
       31       31                              SUB_ENTRY and SUB_END items are set up at beginning
       32       32                              and end of the PERFORMed code.
       33       33
       34       34                           2. COBOL 74 PERFORM.
       35       35                              Set up as transfers using POINTER variables.  The PFORM
       36       36                              item is deleted from the ILL but GOs, DEFLBs, and PRESETs
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:41   
       37       37                              are used.
       38       38
       39       39         REFERENCES:  Design note 27, 'Perform format 1.'
       40       40        */
       41       41        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:42   
       42       42        Z8FP$PFORM_CHECKING: PROC ;

     42 14 000000   000000 700200 xent  Z8FP$PFORM_* TSX0  ! X66_AUTO_0
        14 000001   000064 000000                    ZERO    52,0
        14 000002   003651 710000 14                 TRA     s:12258

       43       43        %EQU PHASE = 2 ;
       44       44        %EQU FIXED_SEGMENT = 0;
       45       45        %INCLUDE Z9A_SUPP_MAC;
       46      334        %INCLUDE Z8A_DEFC ;
       47      402        %INCLUDE Z8A_SUPP_MAC ;
       48     2802        %INCLUDE Z8A_COMCOM ;
       49     3452        %INCLUDE Z8A_ETT ;
       50     3753        %INCLUDE Z8A_ILL ;
       51     4446        %INCLUDE Z8A_ILS ;
       52     4555        %INCLUDE Z8A_LTS ;
       53     6632        %INCLUDE Z8A_ST ;
       54    10291        %INCLUDE Z8A_TYPES ;
       55    10465        %INCLUDE Z8F_O2COM ;
       56    10575
       57    10576    1   DCL  Z8AT$CREATE_TEMPORARY ENTRY(2) ;
       58    10577    1   DCL  Z8AF$NEW_BASE         ENTRY(3) ; /* LOP, ROP, RETURN */
       59    10578
       60    10579    1   DCL  PFORM_ILL$         PTR AUTO ;
       61    10580    1   DCL  START_LABEL$       PTR AUTO ;
       62    10581    1   DCL  END_LABEL$         PTR AUTO ;
       63    10582    1   DCL  END_LABEL_74$      PTR AUTO ;
       64    10583    1   DCL  END_TEMP$          PTR AUTO ;
       65    10584    1   DCL  PFORM_ILS$         PTR ;
       66    10585    1   DCL  DEFLB_FOLLOWS      BOOLEAN ;
       67    10586    1   DCL  LABEL_AFTER_PFORM$ PTR ;
       68    10587    1   DCL  ALTER_LBL$         PTR ;
       69    10588    1   DCL  ENTRY$             PTR ; /* PTR to a %ENTRY's ILS item */
       70    10589    1   DCL  ALTER$             PTR ; /* PTR to a %ALTER for a CBL-74 PERFORM */
       71    10590    1   DCL  TEMP$              PTR ;
       72    10591    1   DCL  BASEP$             PTR ;
       73    10592    1   DCL  CURRENT_PROC$      PTR ; /* PTR to current Proc_ ST item */
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:43   
       74    10593    1   DCL  REFRESH_SEGMENT    BOOLEAN;
       75    10594    1   DCL  SEGMENT_LTS$       PTR;
       76    10595    1   DCL  SUB_TAIL$          PTR;
       77    10596    1   DCL  NEW_LABEL$         PTR;
       78    10597    1   DCL  TO_SEG_NO#         SBIN WORD;
       79    10598    1   DCL  FROM_SEG_NO#       SBIN WORD;
       80    10599    1   DCL  END_SEG_NO#        SBIN WORD;
       81    10600    1   DCL  PRE_ALTER_CHANGE   BOOLEAN;
       82    10601    1   DCL  POST_ALTER_CHANGE  BOOLEAN;
       83    10602    1   DCL  PERFORM_CHANGE     BOOLEAN;
       84    10603
       85    10604        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:44   
       86    10605
       87    10606         %MACRO RSV_ILS_ILL (@ILS_ITEM = %OPN,
       88    10607                             @ILL_ITEM = %LINOI);
       89    10608           DO;
       90    10609             %RESERVE_ILS (ITEM = @ILS_ITEM,
       91    10610                           POINTER = SUB_TAIL$ -> ILS.NEXT);
       92    10611
       93    10612             %RESERVE_ILL (ITEM = @ILL_ITEM,
       94    10613                           POINTER = SUB_TAIL$ -> ILS.NEXT -> ILS.ILL$);
       95    10614
       96    10615             SUB_TAIL$ = SUB_TAIL$ -> ILS.NEXT;
       97    10616           END;
       98    10617         %MEND;
       99    10618
      100    10619        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:45   
      101    10620    1   PFORM_LIST_MARKING: PROC ;

  10620 14 000003   200034 741300       PFORM_LIST_* STX1  ! PERFORM_CHANGE+2,,AUTO

      102    10621
      103    10622        /*I*
      104    10623               NAME:  PFORM_LIST_MARKING
      105    10624               CALL:  CALL PFORM_LIST_MARKING ;
      106    10625
      107    10626              INPUT:  COMCOM.H_PFORM is the pointer to the top of the linked list of
      108    10627                      PFORMs.
      109    10628
      110    10629        DESCRIPTION:  This procedure looks at all the PERFORMs in the program to see
      111    10630                      which are nested.  The end label is marked as containing a PFORM
      112    10631                      if the start label contains one.  All of the interior labels
      113    10632                      between the starting and end ending labels are checked for nested
      114    10633                      performs.  If any of them contains a perform then the start label
      115    10634                      is marked as such.
      116    10635        */
      117    10636
      118    10637    2   DCL  INTERIOR_PFORM_LBL$  PTR ;
      119    10638        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:46   
      120    10639    2          O2COM.PFORM_LIST$ = COMCOM.H_PFORM ;

  10639 14 000004   000126 236000 xsym               LDQ     COMCOM+86
        14 000005   000001 756000 13                 STQ     O2COM+1

      121    10640
      122    10641    3          DO UNTIL O2COM.PFORM_LIST$ = ADDR(NIL) ;

      123    10642
      124    10643    3            START_LABEL$ = O2COM.PFORM_LIST$->ILS.ILL$->ILL.LOP ;

  10643 14 000006   000001 470400 13                 LDP0    O2COM+1
        14 000007   000003 471500                    LDP1    3,,PR0
        14 000010   100001 236100                    LDQ     1,,PR1
        14 000011   200004 756100                    STQ     START_LABEL$,,AUTO

      125    10644    3            END_LABEL$ = O2COM.PFORM_LIST$->ILS.ILL$->ILL.ROP ;

  10644 14 000012   000003 471500                    LDP1    3,,PR0
        14 000013   100002 236100                    LDQ     2,,PR1
        14 000014   200005 756100                    STQ     END_LABEL$,,AUTO

      126    10645
      127    10646    3            END_LABEL$->LABEL.B.PFORM_NESTED = START_LABEL$->LABEL.B.PFORM_NESTED ;

  10646 14 000015   200005 471500                    LDP1    END_LABEL$,,AUTO
        14 000016   200004 473500                    LDP3    START_LABEL$,,AUTO
        14 000017   300003 236100                    LDQ     3,,PR3
        14 000020   100003 676100                    ERQ     3,,PR1
        14 000021   000100 376003                    ANQ     64,DU
        14 000022   100003 656100                    ERSQ    3,,PR1

      128    10647
      129    10648    3            TEMP$ = START_LABEL$->LABEL.PREV_ILS$ ;

  10648 14 000023   200004 471500                    LDP1    START_LABEL$,,AUTO
        14 000024   100010 236100                    LDQ     8,,PR1
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:47   
        14 000025   200016 756100                    STQ     TEMP$,,AUTO

      130    10649                 %NEXT_NON_SUPPORT (POINTER=TEMP$) ;

  10659 14 000026   200016 470500                    LDP0    TEMP$,,AUTO
        14 000027   000002 236100                    LDQ     2,,PR0
        14 000030   200016 756100                    STQ     TEMP$,,AUTO

  10662 14 000031   200016 470500                    LDP0    TEMP$,,AUTO
        14 000032   000003 236100                    LDQ     3,,PR0
        14 000033   000000 116000 15                 CMPQ    0
        14 000034   000026 600000 14                 TZE     s:10659
        14 000035   000003 471500                    LDP1    3,,PR0
        14 000036   100000 220100                    LDX0    0,,PR1
        14 000037   000343 100003                    CMPX0   227,DU
        14 000040   000026 600000 14                 TZE     s:10659
        14 000041   000422 100003                    CMPX0   274,DU
        14 000042   000026 600000 14                 TZE     s:10659
        14 000043   000446 100003                    CMPX0   294,DU
        14 000044   000026 600000 14                 TZE     s:10659
        14 000045   000336 100003                    CMPX0   222,DU
        14 000046   000026 600000 14                 TZE     s:10659
        14 000047   000420 100003                    CMPX0   272,DU
        14 000050   000026 600000 14                 TZE     s:10659
        14 000051   000373 100003                    CMPX0   251,DU
        14 000052   000026 600000 14                 TZE     s:10659

      131    10664    3            INTERIOR_PFORM_LBL$ = TEMP$->ILS.ILL$->ILL.LBL ;

  10664 14 000053   100002 236100                    LDQ     2,,PR1
        14 000054   200035 756100                    STQ     INTERIOR_PFORM_LBL$,,AUTO

      132    10665
      133    10666    3   CHECK_NESTING:
      134    10667    4            DO WHILE INTERIOR_PFORM_LBL$ ~= ADDR(NIL) ;

  10667 14 000055   000116 710000 14    CHECK_NESTI* TRA     s:10686
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:48   

      135    10668    4              IF INTERIOR_PFORM_LBL$->ILS.ILL$->ILL.LOP = END_LABEL$ THEN

  10668 14 000056   200035 470500                    LDP0    INTERIOR_PFORM_LBL$,,AUTO
        14 000057   000003 471500                    LDP1    3,,PR0
        14 000060   100001 236100                    LDQ     1,,PR1
        14 000061   200005 116100                    CMPQ    END_LABEL$,,AUTO
        14 000062   000120 600000 14                 TZE     s:10687

      136    10669    4                  EXIT CHECK_NESTING ;
      137    10670                            /* Usually control will leave this loop via the EXIT
      138    10671                               statement. It leaves by satisfying the WHILE condition
      139    10672                               only in case of a backward PERFORM. It is set up this
      140    10673                               way so as to guarantee that the 2 conditions are
      141    10674                               checked in the right order.                           */
      142    10675    4              IF INTERIOR_PFORM_LBL$->ILS.ILL$->ILL.LOP->LABEL.B.GOTO_LABEL AND

  10675 14 000063   100001 473500                    LDP3    1,,PR1
        14 000064   300003 236100                    LDQ     3,,PR3
        14 000065   040000 316003                    CANQ    16384,DU
        14 000066   000077 600000 14                 TZE     s:10678
        14 000067   300003 236100                    LDQ     3,,PR3
        14 000070   000002 736000                    QLS     2
        14 000071   400000 376003                    ANQ     -131072,DU
        14 000072   400000 676003                    ERQ     -131072,DU
        14 000073   000077 600000 14                 TZE     s:10678

      143    10676    4                ~INTERIOR_PFORM_LBL$->ILS.ILL$->ILL.LOP->LABEL.B.COMPILER_CREATED
      144    10677    4                  THEN START_LABEL$->LABEL.B.GOTO_LABEL = TRUE ;

  10677 14 000074   200004 474500                    LDP4    START_LABEL$,,AUTO
        14 000075   040000 236003                    LDQ     16384,DU
        14 000076   400003 256100                    ORSQ    3,,PR4

      145    10678    4              INTERIOR_PFORM_LBL$->ILS.ILL$->ILL.LOP->LABEL.B.INTERIOR_PFORM_LBL =

  10678 14 000077   000003 471500                    LDP1    3,,PR0
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:49   
        14 000100   100001 473500                    LDP3    1,,PR1
        14 000101   000001 236003                    LDQ     1,DU
        14 000102   300003 256100                    ORSQ    3,,PR3

      146    10679    4                  TRUE ;
      147    10680
      148    10681    4              IF INTERIOR_PFORM_LBL$->ILS.ILL$->ILL.LOP->LABEL.B.PFORM_NESTED THEN

  10681 14 000103   000003 471500                    LDP1    3,,PR0
        14 000104   100001 473500                    LDP3    1,,PR1
        14 000105   300003 236100                    LDQ     3,,PR3
        14 000106   000100 316003                    CANQ    64,DU
        14 000107   000113 600000 14                 TZE     s:10684

      149    10682    4                START_LABEL$->LABEL.B.PFORM_NESTED = TRUE ;

  10682 14 000110   200004 474500                    LDP4    START_LABEL$,,AUTO
        14 000111   000100 236003                    LDQ     64,DU
        14 000112   400003 256100                    ORSQ    3,,PR4

      150    10683
      151    10684    4              INTERIOR_PFORM_LBL$ = INTERIOR_PFORM_LBL$->ILS.ILL$->ILL.LBL ;

  10684 14 000113   000003 471500                    LDP1    3,,PR0
        14 000114   100002 236100                    LDQ     2,,PR1
        14 000115   200035 756100                    STQ     INTERIOR_PFORM_LBL$,,AUTO

      152    10685
      153    10686    4            END ;

  10686 14 000116   000000 116000 15                 CMPQ    0
        14 000117   000056 601000 14                 TNZ     s:10668

      154    10687    4            IF INTERIOR_PFORM_LBL$ = ADDR(NIL) THEN DO ;

  10687 14 000120   200035 236100                    LDQ     INTERIOR_PFORM_LBL$,,AUTO
        14 000121   000000 116000 15                 CMPQ    0
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:50   
        14 000122   000126 601000 14                 TNZ     s:10695

      155    10688                                      /* Backward PERFORM, i.e., start label appears
      156    10689                                         after end label. User deserves whatever
      157    10690                                         he/she gets. All bets are off.
      158    10691                                         So are all optimizations.                   */
      159    10692    4                START_LABEL$->LABEL.B.BACKWARD_PFORM = TRUE ;

  10692 14 000123   200004 470500                    LDP0    START_LABEL$,,AUTO
        14 000124   200000 236007                    LDQ     65536,DL
        14 000125   000003 256100                    ORSQ    3,,PR0

      160    10693    4            END ;

      161    10694
      162    10695    3            O2COM.PFORM_LIST$ = O2COM.PFORM_LIST$->ILS.ILL$->PFORM.PFORM_LIST$ ;

  10695 14 000126   000001 470400 13                 LDP0    O2COM+1
        14 000127   000003 471500                    LDP1    3,,PR0
        14 000130   100004 236100                    LDQ     4,,PR1
        14 000131   000001 756000 13                 STQ     O2COM+1

      163    10696    3          END ;

  10696 14 000132   000000 116000 15                 CMPQ    0
        14 000133   000006 601000 14                 TNZ     s:10643

      164    10697
      165    10698    2   END PFORM_LIST_MARKING ;

  10698 14 000134   200034 221300                    LDX1  ! PERFORM_CHANGE+2,,AUTO
        14 000135   000001 702211                    TSX2  ! 1,X1

      166    10699        %EJECT;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:51   
      167    10700    1   CREATE_ITEM_ILS: PROC (ITEM_TYPE, ITEM_LOP$, ITEM_ROP$) ;

  10700 14 000136   200046 741300       CREATE_ITEM* STX1  ! PREV_ILS_NEXT$+1,,AUTO

      168    10701
      169    10702    2   DCL ITEM_TYPE   UBIN WORD ; /* Type of ILL item being created */
      170    10703    2   DCL ITEM_LOP$   PTR       ; /* Left operand value of ILL entry */
      171    10704    2   DCL ITEM_ROP$   PTR       ; /* Right operand value of ILL entry */
      172    10705
      173    10706        /*I*
      174    10707               NAME:  CREATE_ITEM_ILS
      175    10708               CALL:  CALL CREATE_ITEM_ILS(ITEM_TYPE, ITEM_LOP$, ITEM_ROP$) ;
      176    10709
      177    10710              INPUT:  ITEM_TYPE - Type of ILL item to be created.
      178    10711                      ITEM_LOP$ - Left operand of ILL entry.
      179    10712                      ITEM_ROP$ - Right operand of ILL entry.
      180    10713
      181    10714        DESCRIPTION:  This procedure reserves the ILS and ILL entries to be linked in
      182    10715                      the ILS chain.  The ILS and ILL entries are linked together and
      183    10716                      the ILL entry is assigned.
      184    10717        */
      185    10718
      186    10719
      187    10720               %RESERVE_ILS(ITEM=%OPN, POINTER=PFORM_ILS$->ILS.NEXT) ;

  10740 14 000137   000002 236000 8                  LDQ     ILS_+2
        14 000140   000004 036007                    ADLQ    4,DL
        14 000141   000003 116000 8                  CMPQ    ILS_+3
        14 000142   000153 602000 14                 TNC     s:10742

  10741 14 000143   000002 236000 15                 LDQ     2
        14 000144   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 000145   200052 630500                    EPPR0   @ITEM_ROP$+1,,AUTO
        14 000146   200053 450500                    STP0    @ITEM_ROP$+2,,AUTO
        14 000147   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 000150   000001 631400 15                 EPPR1   1
        14 000151   000000 701000 xent               TSX1    Z8AR$RESERVER
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:52   
        14 000152   000000 011000                    NOP     0

  10742 14 000153   000002 236000 8                  LDQ     ILS_+2
        14 000154   000022 736000                    QLS     18
        14 000155   000001 036000 8                  ADLQ    ILS_+1
        14 000156   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 000157   000002 756100                    STQ     2,,PR0

  10743 14 000160   000002 235000 8                  LDA     ILS_+2
        14 000161   000004 035007                    ADLA    4,DL
        14 000162   000002 755000 8                  STA     ILS_+2

  10744 14 000163   000002 471500                    LDP1    2,,PR0
        14 000164   000740 220003                    LDX0    480,DU
        14 000165   100000 740100                    STX0    0,,PR1

  10745 14 000166   000002 471500                    LDP1    2,,PR0
        14 000167   000000 236000 15                 LDQ     0
        14 000170   100002 756100                    STQ     2,,PR1

      188    10749               %NEXT_ILS (POINTER=PFORM_ILS$) ;

  10751 14 000171   000002 236100                    LDQ     2,,PR0
        14 000172   200010 756100                    STQ     PFORM_ILS$,,AUTO

      189    10754
      190    10755               %RESERVE_ILL(ITEM=ITEM_TYPE, POINTER=PFORM_ILS$->ILS.ILL$) ;

  10757 14 000173   200047 470500                    LDP0    @ITEM_TYPE,,AUTO
        14 000174   000000 721100                    LXL1    0,,PR0
        14 000175   777552 235011 xsym               LDA     ILL_STEP-150,X1
        14 000176   000000 755000 0                  STA     ITERATION

  10758 14 000177   000002 236000 6                  LDQ     ILL_+2
        14 000200   000000 036000 0                  ADLQ    ITERATION
        14 000201   000003 116000 6                  CMPQ    ILL_+3
        14 000202   000213 604000 14                 TMI     s:10760
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:53   

  10759 14 000203   000003 236000 15                 LDQ     3
        14 000204   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 000205   200052 631500                    EPPR1   @ITEM_ROP$+1,,AUTO
        14 000206   200053 451500                    STP1    @ITEM_ROP$+2,,AUTO
        14 000207   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 000210   000001 631400 15                 EPPR1   1
        14 000211   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 000212   000000 011000                    NOP     0

  10760 14 000213   000002 236000 6                  LDQ     ILL_+2
        14 000214   000022 736000                    QLS     18
        14 000215   000001 036000 6                  ADLQ    ILL_+1
        14 000216   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 000217   000003 756100                    STQ     3,,PR0

  10761 14 000220   000002 236000 6                  LDQ     ILL_+2
        14 000221   000000 036000 0                  ADLQ    ITERATION
        14 000222   000002 756000 6                  STQ     ILL_+2

  10762 14 000223   000003 471500                    LDP1    3,,PR0
        14 000224   200047 473500                    LDP3    @ITEM_TYPE,,AUTO
        14 000225   300000 720100                    LXL0    0,,PR3
        14 000226   100000 740100                    STX0    0,,PR1

      191    10765    2          PFORM_ILS$->ILS.ILL$->ILL.LOP = ITEM_LOP$ ;

  10765 14 000227   000003 471500                    LDP1    3,,PR0
        14 000230   200050 474500                    LDP4    @ITEM_LOP$,,AUTO
        14 000231   400000 236100                    LDQ     0,,PR4
        14 000232   100001 756100                    STQ     1,,PR1

      192    10766    2          PFORM_ILS$->ILS.ILL$->ILL.ROP = ITEM_ROP$ ;

  10766 14 000233   000003 471500                    LDP1    3,,PR0
        14 000234   200051 475500                    LDP5    @ITEM_ROP$,,AUTO
        14 000235   500000 236100                    LDQ     0,,PR5
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:54   
        14 000236   100002 756100                    STQ     2,,PR1

      193    10767
      194    10768    2   END CREATE_ITEM_ILS ;

  10768 14 000237   200046 221300                    LDX1  ! PREV_ILS_NEXT$+1,,AUTO
        14 000240   000001 702211                    TSX2  ! 1,X1

      195    10769        %EJECT;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:55   
      196    10770        /*V*
      197    10771            CREATE_LINOI_AND_DEFLB - An ILS and LINOI entry are created first and then
      198    10772                                     assigned with the appropiate line numbers, etc.
      199    10773                                     Another ILS item (OPA) is created to link the DEFLB
      200    10774                                     in.  The DEFLB item is created for the ALTER label.
      201    10775                                     The new ILS item cannot be OPN because
      202    10776                                     Z8FL$LABEL_REFERENCE has already been called,
      203    10777                                     and it is too late for this label to be added
      204    10778                                     to the label list (COMCOM.H_LBL->list).
      205    10779        */
      206    10780
      207    10781        %MACRO CREATE_LINOI_AND_DEFLB (AT=PFORM_ILS$, LBL1=ALTER_LBL$) ;
      208    10782        %LSET NN=CHARTEXT(CONCAT(TEXTCHAR(AT),'->ILS.NEXT'));
      209    10783        %LSET II=CHARTEXT(CONCAT(TEXTCHAR(AT),'->ILS.ILL$'));
      210    10784               DO ;
      211    10785                 LBL1->LABEL.B.REFERENCED = TRUE ;
      212    10786                 LBL1->LABEL.PREV_ILS$ = AT ;
      213    10787                 LBL1->LABEL.PROC$ = CURRENT_PROC$ ;
      214    10788                 %RESERVE_ILS(ITEM=%OPN, POINTER=%NN) ;
      215    10789                 %NEXT_ILS (POINTER=AT) ;
      216    10790
      217    10791                 %RESERVE_ILL(ITEM=%LINOI, POINTER=%II) ;
      218    10792                 AT->ILS.ILL$->LINOI.PREV_LINE = ILS$->ILS.ILL$->LINOI.PREV_LINE ;
      219    10793                 AT->ILS.ILL$->LINOI.LINE_NO = ILS$->ILS.ILL$->LINOI.PREV_LINE ;
      220    10794                 AT->ILS.ILL$->LINOI.PREV_COL = ILS$->ILS.ILL$->LINOI.PREV_COL ;
      221    10795                 AT->ILS.ILL$->LINOI.COLUMN_NO = ILS$->ILS.ILL$->LINOI.PREV_COL ;
      222    10796
      223    10797                 %RESERVE_ILS(ITEM=%OPA, POINTER=%NN) ;
      224    10798                 %NEXT_ILS (POINTER=AT) ;
      225    10799                 AT->ILS.B.CDEF = TRUE ;
      226    10800                 AT->ILS.DEF = ADDR(NIL) ;
      227    10801
      228    10802                 %RESERVE_ILL(ITEM=%DEFLB, POINTER=%II) ;
      229    10803                 AT->ILS.ILL$->ILL.LOP = LBL1 ;
      230    10804                 AT->ILS.ILL$->ILL.LBL = ADDR (NIL) ;
      231    10805               END ;
      232    10806        %MEND ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:56   
      233    10807        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:57   
      234    10808    1   SET_UP_COBOL_74_PFORM: PROC ;

  10808 14 000241   200034 741300       SET_UP_COBO* STX1  ! PERFORM_CHANGE+2,,AUTO

      235    10809
      236    10810        /*I*
      237    10811               NAME:  SET_UP_COBOL_74_PFORM
      238    10812               CALL:  CALL SET_UP_COBOL_74_PFORM ;
      239    10813          INTERFACE:  Z8AT$CREATE_TEMPORARY is called to create a POINTER variable.
      240    10814                      Z8AF$NEW_BASE is called to enter a BASE item into the ETT
      241    10815                      for the pointer variable.
      242    10816
      243    10817              INPUT:  PFORM_ILS$        -- Pointer to the PFORM item's ILS entry.
      244    10818                      START_LABEL$      -- Pointer to the PFORM's starting label.
      245    10819                      END_LABEL$        -- Pointer to the PFORM's ending label.
      246    10820
      247    10821        DESCRIPTION:  The outer procedure has determined a COBOL74 PERFORM must be used.
      248    10822                      This procedure creates all the items needed to set up this type of
      249    10823                      perform.
      250    10824        */
      251    10825
      252    10826
      253    10827    2   DCL  POINTER$           PTR ;
      254    10828    2   DCL  LINOI$             PTR ; /* PTR to ILS for first LINOI after ENTRY */
      255    10829    2   DCL  DO_ILS$            PTR ; /* PTR to ILS for DO2 item */
      256    10830        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:58   
      257    10831        /*V*
      258    10832            COBOL_74_PFORM_SET_UP -- The pointers are assigned so that the needed items
      259    10833                                     can be inserted in the ILS where the PFORM item
      260    10834                                     was before.  This also involves linking the PFORM
      261    10835                                     item out of the ILS as it is no longer used.
      262    10836
      263    10837                                     The pointer variables must also be created for the
      264    10838                                     end label.  If the label has already been set up
      265    10839                                     as a COBOL 74 end then we can extract the POINTER
      266    10840                                     variable otherwise a new one is created.  The
      267    10841                                     LABEL to be used in the transfer back from the
      268    10842                                     PFORM paragraph is created.
      269    10843        */
      270    10844
      271    10845                            /* First take care of the pointer variable. */
      272    10846    2          IF END_LABEL$->LABEL.B.PFORM_74_END THEN

  10846 14 000242   200005 470500                    LDP0    END_LABEL$,,AUTO
        14 000243   000003 236100                    LDQ     3,,PR0
        14 000244   000010 316003                    CANQ    8,DU
        14 000245   000252 600000 14                 TZE     s:10850

      273    10847    2            POINTER$ = END_LABEL$->LABEL.POINTER$->ETT.LOP ;

  10847 14 000246   000005 471500                    LDP1    5,,PR0
        14 000247   100001 236100                    LDQ     1,,PR1
        14 000250   200035 756100                    STQ     POINTER$,,AUTO
        14 000251   000300 710000 14                 TRA     s:10865

      274    10848    2          ELSE
      275    10849    3            DO ;

      276    10850    3              CALL Z8AT$CREATE_TEMPORARY(%POINTER, POINTER$) ;

  10850 14 000252   200035 631500                    EPPR1   POINTER$,,AUTO
        14 000253   200053 451500                    STP1    @ITEM_ROP$+2,,AUTO
        14 000254   000006 236000 15                 LDQ     6
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:59   
        14 000255   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 000256   200052 630500                    EPPR0   @ITEM_ROP$+1,,AUTO
        14 000257   000004 631400 15                 EPPR1   4
        14 000260   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        14 000261   000000 011000                    NOP     0

      277    10851    3              POINTER$->VARIABLE.NDSC.N = %BYTES_PER_WORD ;

  10851 14 000262   200035 470500                    LDP0    POINTER$,,AUTO
        14 000263   000004 236007                    LDQ     4,DL
        14 000264   000001 752101                    STCQ    1,'01'O,PR0

      278    10852    3              POINTER$->VARIABLE.TYPE = %TYP ;

  10852 14 000265   000022 220003                    LDX0    18,DU
        14 000266   200035 470500                    LDP0    POINTER$,,AUTO
        14 000267   000002 740100                    STX0    2,,PR0

      279    10853                   %INCREMENT_STORAGE_CNT(@ITEM$=POINTER$) ;

  10855 14 000270   000145 470400 xsym               LDP0    COMCOM+101
        14 000271   000002 221100                    LDX1    2,,PR0
        14 000272   200035 471500                    LDP1    POINTER$,,AUTO
        14 000273   100001 741100                    STX1    1,,PR1

  10856 14 000274   000145 470400 xsym               LDP0    COMCOM+101
        14 000275   000002 221100                    LDX1    2,,PR0
        14 000276   000001 622011                    EAX2    1,X1
        14 000277   000002 742100                    STX2    2,,PR0

      280    10863    3            END ;

      281    10864
      282    10865    2          CALL Z8AF$NEW_BASE (POINTER$, ADDR(NIL), POINTER$) ;

  10865 14 000300   000000 236000 15                 LDQ     0
        14 000301   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:60   
        14 000302   200035 630500                    EPPR0   POINTER$,,AUTO
        14 000303   200055 450500                    STP0    @ITEM_ROP$+4,,AUTO
        14 000304   200052 631500                    EPPR1   @ITEM_ROP$+1,,AUTO
        14 000305   200054 451500                    STP1    @ITEM_ROP$+3,,AUTO
        14 000306   200035 633500                    EPPR3   POINTER$,,AUTO
        14 000307   200053 453500                    STP3    @ITEM_ROP$+2,,AUTO
        14 000310   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 000311   000007 631400 15                 EPPR1   7
        14 000312   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        14 000313   000000 011000                    NOP     0

      283    10866
      284    10867                       /* Done with pointer variable. Now create a return label. */
      285    10868    2          CALL Z8AT$CREATE_TEMPORARY(%PARA, ALTER_LBL$) ;

  10868 14 000314   200013 630500                    EPPR0   ALTER_LBL$,,AUTO
        14 000315   200053 450500                    STP0    @ITEM_ROP$+2,,AUTO
        14 000316   000011 236000 15                 LDQ     9
        14 000317   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 000320   200052 630500                    EPPR0   @ITEM_ROP$+1,,AUTO
        14 000321   000004 631400 15                 EPPR1   4
        14 000322   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        14 000323   000000 011000                    NOP     0

      286    10869        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:61   
      287    10870        /*V*
      288    10871            PERFORM_EXIT -- Find end of PERFORMed code. If this paragraph or section
      289    10872                            is also the end of an optimized PERFORM then back up to
      290    10873                            before the SUB_END so the GO will be put where it
      291    10874                            belongs and the pointer will be ALTERed to continue to the
      292    10875                            right place in the fall thru case. Then insert the GO
      293    10876                            unless one has already been put there from another
      294    10877                            COBOL-74 style PERFORM.
      295    10878        */
      296    10879
      297    10880    2          END_LABEL_74$ = END_LABEL$ ;

  10880 14 000324   200005 236100                    LDQ     END_LABEL$,,AUTO
        14 000325   200006 756100                    STQ     END_LABEL_74$,,AUTO

      298    10881    2          IF NOT END_LABEL$->LABEL.B.PFORM_74_END

  10881 14 000326   200005 470500                    LDP0    END_LABEL$,,AUTO
        14 000327   000003 236100                    LDQ     3,,PR0
        14 000330   000010 316003                    CANQ    8,DU
        14 000331   000764 601000 14                 TNZ     s:11101

      299    10882    3            THEN DO ;

      300    10883    3              PFORM_ILS$ = END_LABEL$->LABEL.PREV_ILS$ ;

  10883 14 000332   000010 236100                    LDQ     8,,PR0
        14 000333   200010 756100                    STQ     PFORM_ILS$,,AUTO

      301    10884    3              ILS$ = PFORM_ILS$ ;

  10884 14 000334   000000 756000 7                  STQ     ILS$

      302    10885                   %NEXT_ILS ;

  10887 14 000335   000000 471400 7                  LDP1    ILS$
        14 000336   100002 236100                    LDQ     2,,PR1
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:62   
        14 000337   000000 756000 7                  STQ     ILS$

      303    10890    4              IF END_LABEL$->LABEL.B.PFORM_END THEN DO ;

  10890 14 000340   000003 236100                    LDQ     3,,PR0
        14 000341   000200 316003                    CANQ    128,DU
        14 000342   000350 600000 14                 TZE     s:10915

      304    10891    4                TEMP$ = PFORM_ILS$->ILS.ILL$ ; /* Save ADDR(SUB_END) ILL */

  10891 14 000343   200010 471500                    LDP1    PFORM_ILS$,,AUTO
        14 000344   100003 236100                    LDQ     3,,PR1
        14 000345   200016 756100                    STQ     TEMP$,,AUTO

      305    10892    4                PFORM_ILS$->ILS.ILL$ = ADDR (NIL) ; /* Delete the SUB_END */

  10892 14 000346   000000 236000 15                 LDQ     0
        14 000347   100003 756100                    STQ     3,,PR1

      306    10893    4              END ;

      307    10894                                           /* Insert %GO at end of PERFORM group     */
      308    10895                   %RESERVE_ILS(ITEM = %OPN, POINTER = PFORM_ILS$->ILS.NEXT) ;

  10915 14 000350   000002 236000 8                  LDQ     ILS_+2
        14 000351   000004 036007                    ADLQ    4,DL
        14 000352   000003 116000 8                  CMPQ    ILS_+3
        14 000353   000364 602000 14                 TNC     s:10917

  10916 14 000354   000002 236000 15                 LDQ     2
        14 000355   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 000356   200052 630500                    EPPR0   @ITEM_ROP$+1,,AUTO
        14 000357   200053 450500                    STP0    @ITEM_ROP$+2,,AUTO
        14 000360   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 000361   000001 631400 15                 EPPR1   1
        14 000362   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 000363   000000 011000                    NOP     0
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:63   

  10917 14 000364   000002 236000 8                  LDQ     ILS_+2
        14 000365   000022 736000                    QLS     18
        14 000366   000001 036000 8                  ADLQ    ILS_+1
        14 000367   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 000370   000002 756100                    STQ     2,,PR0

  10918 14 000371   000002 235000 8                  LDA     ILS_+2
        14 000372   000004 035007                    ADLA    4,DL
        14 000373   000002 755000 8                  STA     ILS_+2

  10919 14 000374   000002 471500                    LDP1    2,,PR0
        14 000375   000740 220003                    LDX0    480,DU
        14 000376   100000 740100                    STX0    0,,PR1

  10920 14 000377   000002 471500                    LDP1    2,,PR0
        14 000400   000000 236000 15                 LDQ     0
        14 000401   100002 756100                    STQ     2,,PR1

      309    10924                   %NEXT_ILS(POINTER = PFORM_ILS$) ;

  10926 14 000402   000002 236100                    LDQ     2,,PR0
        14 000403   200010 756100                    STQ     PFORM_ILS$,,AUTO

      310    10929                   %RESERVE_ILL(ITEM = %LINOI, POINTER = PFORM_ILS$->ILS.ILL$) ;

  10931 14 000404   000145 235000 xsym               LDA     ILL_STEP+101
        14 000405   000000 755000 0                  STA     ITERATION

  10932 14 000406   000002 236000 6                  LDQ     ILL_+2
        14 000407   000000 036000 0                  ADLQ    ITERATION
        14 000410   000003 116000 6                  CMPQ    ILL_+3
        14 000411   000422 604000 14                 TMI     s:10934

  10933 14 000412   000003 236000 15                 LDQ     3
        14 000413   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 000414   200052 630500                    EPPR0   @ITEM_ROP$+1,,AUTO
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:64   
        14 000415   200053 450500                    STP0    @ITEM_ROP$+2,,AUTO
        14 000416   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 000417   000001 631400 15                 EPPR1   1
        14 000420   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 000421   000000 011000                    NOP     0

  10934 14 000422   000002 236000 6                  LDQ     ILL_+2
        14 000423   000022 736000                    QLS     18
        14 000424   000001 036000 6                  ADLQ    ILL_+1
        14 000425   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 000426   000003 756100                    STQ     3,,PR0

  10935 14 000427   000002 236000 6                  LDQ     ILL_+2
        14 000430   000000 036000 0                  ADLQ    ITERATION
        14 000431   000002 756000 6                  STQ     ILL_+2

  10936 14 000432   000003 471500                    LDP1    3,,PR0
        14 000433   000373 220003                    LDX0    251,DU
        14 000434   100000 740100                    STX0    0,,PR1

      311    10939    3              PFORM_ILS$->ILS.ILL$->LINOI = ILS$->ILS.ILL$->LINOI ;

  10939 14 000435   000003 471500                    LDP1    3,,PR0
        14 000436   000000 473400 7                  LDP3    ILS$
        14 000437   300003 474500                    LDP4    3,,PR3
        14 000440   000100 100500                    MLR     fill='000'O
        14 000441   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12
        14 000442   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      312    10940    3              CALL CREATE_ITEM_ILS(%GO, POINTER$, ADDR(NIL)) ;

  10940 14 000443   000000 236000 15                 LDQ     0
        14 000444   200056 756100                    STQ     @ITEM_ROP$+5,,AUTO
        14 000445   200056 631500                    EPPR1   @ITEM_ROP$+5,,AUTO
        14 000446   200051 451500                    STP1    @ITEM_ROP$,,AUTO
        14 000447   200035 633500                    EPPR3   POINTER$,,AUTO
        14 000450   200050 453500                    STP3    @ITEM_LOP$,,AUTO
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:65   
        14 000451   000013 236000 15                 LDQ     11
        14 000452   200047 756100                    STQ     @ITEM_TYPE,,AUTO
        14 000453   000136 701000 14                 TSX1    CREATE_ITEM_ILS
        14 000454   000000 011000                    NOP     0

      313    10941    3              PFORM_ILS$->ILS.ILL$->ILL.CODE = %GO_ALTERED ;

  10941 14 000455   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 000456   000003 471500                    LDP1    3,,PR0
        14 000457   000020 220003                    LDX0    16,DU
        14 000460   100000 440100                    SXL0    0,,PR1

      314    10942
      315    10943                   %CHECK_VIRTUAL_ALTERED_GO;

      316    10948
      317    10949    4              IF END_LABEL$->LABEL.B.PFORM_END THEN DO ;

  10949 14 000461   200005 471500                    LDP1    END_LABEL$,,AUTO
        14 000462   100003 236100                    LDQ     3,,PR1
        14 000463   000200 316003                    CANQ    128,DU
        14 000464   000757 600000 14                 TZE     s:11098

      318    10950    4                CALL Z8AT$CREATE_TEMPORARY (%PARA, END_LABEL_74$) ;

  10950 14 000465   200006 633500                    EPPR3   END_LABEL_74$,,AUTO
        14 000466   200053 453500                    STP3    @ITEM_ROP$+2,,AUTO
        14 000467   000011 236000 15                 LDQ     9
        14 000470   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 000471   200052 630500                    EPPR0   @ITEM_ROP$+1,,AUTO
        14 000472   000004 631400 15                 EPPR1   4
        14 000473   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        14 000474   000000 011000                    NOP     0

      319    10951                     %CREATE_LINOI_AND_DEFLB (LBL1=END_LABEL_74$) ;

  10955 14 000475   200006 470500                    LDP0    END_LABEL_74$,,AUTO
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:66   
        14 000476   400000 236003                    LDQ     -131072,DU
        14 000477   000003 256100                    ORSQ    3,,PR0

  10956 14 000500   200010 236100                    LDQ     PFORM_ILS$,,AUTO
        14 000501   200006 470500                    LDP0    END_LABEL_74$,,AUTO
        14 000502   000010 756100                    STQ     8,,PR0

  10957 14 000503   200020 236100                    LDQ     CURRENT_PROC$,,AUTO
        14 000504   000011 756100                    STQ     9,,PR0

  10978 14 000505   000002 236000 8                  LDQ     ILS_+2
        14 000506   000004 036007                    ADLQ    4,DL
        14 000507   000003 116000 8                  CMPQ    ILS_+3
        14 000510   000521 602000 14                 TNC     s:10980

  10979 14 000511   000002 236000 15                 LDQ     2
        14 000512   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 000513   200052 631500                    EPPR1   @ITEM_ROP$+1,,AUTO
        14 000514   200053 451500                    STP1    @ITEM_ROP$+2,,AUTO
        14 000515   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 000516   000001 631400 15                 EPPR1   1
        14 000517   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 000520   000000 011000                    NOP     0

  10980 14 000521   000002 236000 8                  LDQ     ILS_+2
        14 000522   000022 736000                    QLS     18
        14 000523   000001 036000 8                  ADLQ    ILS_+1
        14 000524   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 000525   000002 756100                    STQ     2,,PR0

  10981 14 000526   000002 235000 8                  LDA     ILS_+2
        14 000527   000004 035007                    ADLA    4,DL
        14 000530   000002 755000 8                  STA     ILS_+2

  10982 14 000531   000002 471500                    LDP1    2,,PR0
        14 000532   000740 220003                    LDX0    480,DU
        14 000533   100000 740100                    STX0    0,,PR1
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:67   

  10983 14 000534   000002 471500                    LDP1    2,,PR0
        14 000535   000000 236000 15                 LDQ     0
        14 000536   100002 756100                    STQ     2,,PR1

  10989 14 000537   000002 236100                    LDQ     2,,PR0
        14 000540   200010 756100                    STQ     PFORM_ILS$,,AUTO

  10994 14 000541   000145 235000 xsym               LDA     ILL_STEP+101
        14 000542   000000 755000 0                  STA     ITERATION

  10995 14 000543   000002 236000 6                  LDQ     ILL_+2
        14 000544   000000 036000 0                  ADLQ    ITERATION
        14 000545   000003 116000 6                  CMPQ    ILL_+3
        14 000546   000557 604000 14                 TMI     s:10997

  10996 14 000547   000003 236000 15                 LDQ     3
        14 000550   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 000551   200052 630500                    EPPR0   @ITEM_ROP$+1,,AUTO
        14 000552   200053 450500                    STP0    @ITEM_ROP$+2,,AUTO
        14 000553   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 000554   000001 631400 15                 EPPR1   1
        14 000555   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 000556   000000 011000                    NOP     0

  10997 14 000557   000002 236000 6                  LDQ     ILL_+2
        14 000560   000022 736000                    QLS     18
        14 000561   000001 036000 6                  ADLQ    ILL_+1
        14 000562   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 000563   000003 756100                    STQ     3,,PR0

  10998 14 000564   000002 236000 6                  LDQ     ILL_+2
        14 000565   000000 036000 0                  ADLQ    ITERATION
        14 000566   000002 756000 6                  STQ     ILL_+2

  10999 14 000567   000003 471500                    LDP1    3,,PR0
        14 000570   000373 220003                    LDX0    251,DU
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:68   
        14 000571   100000 740100                    STX0    0,,PR1

  11002 14 000572   000003 471500                    LDP1    3,,PR0
        14 000573   000000 473400 7                  LDP3    ILS$
        14 000574   300003 474500                    LDP4    3,,PR3
        14 000575   400000 721100                    LXL1    0,,PR4
        14 000576   100000 441100                    SXL1    0,,PR1

  11003 14 000577   000003 471500                    LDP1    3,,PR0
        14 000600   000000 473400 7                  LDP3    ILS$
        14 000601   300003 474500                    LDP4    3,,PR3
        14 000602   400000 721100                    LXL1    0,,PR4
        14 000603   100001 441100                    SXL1    1,,PR1

  11004 14 000604   000003 471500                    LDP1    3,,PR0
        14 000605   300003 474500                    LDP4    3,,PR3
        14 000606   400002 721100                    LXL1    2,,PR4
        14 000607   100002 441100                    SXL1    2,,PR1

  11005 14 000610   000003 471500                    LDP1    3,,PR0
        14 000611   300003 474500                    LDP4    3,,PR3
        14 000612   400002 721100                    LXL1    2,,PR4
        14 000613   100001 741100                    STX1    1,,PR1

  11026 14 000614   000002 236000 8                  LDQ     ILS_+2
        14 000615   000005 036007                    ADLQ    5,DL
        14 000616   000003 116000 8                  CMPQ    ILS_+3
        14 000617   000630 602000 14                 TNC     s:11028

  11027 14 000620   000002 236000 15                 LDQ     2
        14 000621   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 000622   200052 631500                    EPPR1   @ITEM_ROP$+1,,AUTO
        14 000623   200053 451500                    STP1    @ITEM_ROP$+2,,AUTO
        14 000624   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 000625   000001 631400 15                 EPPR1   1
        14 000626   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 000627   000000 011000                    NOP     0
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:69   

  11028 14 000630   000002 236000 8                  LDQ     ILS_+2
        14 000631   000022 736000                    QLS     18
        14 000632   000001 036000 8                  ADLQ    ILS_+1
        14 000633   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 000634   000002 756100                    STQ     2,,PR0

  11029 14 000635   000002 235000 8                  LDA     ILS_+2
        14 000636   000005 035007                    ADLA    5,DL
        14 000637   000002 755000 8                  STA     ILS_+2

  11030 14 000640   000002 471500                    LDP1    2,,PR0
        14 000641   000742 220003                    LDX0    482,DU
        14 000642   100000 740100                    STX0    0,,PR1

  11031 14 000643   000002 471500                    LDP1    2,,PR0
        14 000644   000000 236000 15                 LDQ     0
        14 000645   100002 756100                    STQ     2,,PR1

  11037 14 000646   000002 236100                    LDQ     2,,PR0
        14 000647   200010 756100                    STQ     PFORM_ILS$,,AUTO

  11040 14 000650   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 000651   400000 236003                    LDQ     -131072,DU
        14 000652   000001 256100                    ORSQ    1,,PR0

  11041 14 000653   000000 236000 15                 LDQ     0
        14 000654   000004 756100                    STQ     4,,PR0

  11044 14 000655   000120 235000 xsym               LDA     ILL_STEP+80
        14 000656   000000 755000 0                  STA     ITERATION

  11045 14 000657   000002 236000 6                  LDQ     ILL_+2
        14 000660   000000 036000 0                  ADLQ    ITERATION
        14 000661   000003 116000 6                  CMPQ    ILL_+3
        14 000662   000673 604000 14                 TMI     s:11047

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:70   
  11046 14 000663   000003 236000 15                 LDQ     3
        14 000664   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 000665   200052 631500                    EPPR1   @ITEM_ROP$+1,,AUTO
        14 000666   200053 451500                    STP1    @ITEM_ROP$+2,,AUTO
        14 000667   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 000670   000001 631400 15                 EPPR1   1
        14 000671   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 000672   000000 011000                    NOP     0

  11047 14 000673   000002 236000 6                  LDQ     ILL_+2
        14 000674   000022 736000                    QLS     18
        14 000675   000001 036000 6                  ADLQ    ILL_+1
        14 000676   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 000677   000003 756100                    STQ     3,,PR0

  11048 14 000700   000002 236000 6                  LDQ     ILL_+2
        14 000701   000000 036000 0                  ADLQ    ITERATION
        14 000702   000002 756000 6                  STQ     ILL_+2

  11049 14 000703   000003 471500                    LDP1    3,,PR0
        14 000704   000346 220003                    LDX0    230,DU
        14 000705   100000 740100                    STX0    0,,PR1

  11052 14 000706   000003 471500                    LDP1    3,,PR0
        14 000707   200006 236100                    LDQ     END_LABEL_74$,,AUTO
        14 000710   100001 756100                    STQ     1,,PR1

  11053 14 000711   000003 471500                    LDP1    3,,PR0
        14 000712   000000 236000 15                 LDQ     0
        14 000713   100002 756100                    STQ     2,,PR1

      320    11056    4                END_LABEL$->LABEL.PREV_ILS$ = PFORM_ILS$ ;

  11056 14 000714   200010 236100                    LDQ     PFORM_ILS$,,AUTO
        14 000715   200005 471500                    LDP1    END_LABEL$,,AUTO
        14 000716   100010 756100                    STQ     8,,PR1

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:71   
      321    11057                     /* In this case, LABEL.PREV_ILS$ points to some place
      322    11058                        other than the immediate previous ILS item. It is known that
      323    11059                        after this nobody else needs the field, and what this
      324    11060                        internal procedure needs is the ILS item for the previous
      325    11061                        DEFLB. */
      326    11062                     %RESERVE_ILS (ITEM=%OPN, POINTER=PFORM_ILS$->ILS.NEXT) ;

  11082 14 000717   000002 236000 8                  LDQ     ILS_+2
        14 000720   000004 036007                    ADLQ    4,DL
        14 000721   000003 116000 8                  CMPQ    ILS_+3
        14 000722   000733 602000 14                 TNC     s:11084

  11083 14 000723   000002 236000 15                 LDQ     2
        14 000724   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 000725   200052 633500                    EPPR3   @ITEM_ROP$+1,,AUTO
        14 000726   200053 453500                    STP3    @ITEM_ROP$+2,,AUTO
        14 000727   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 000730   000001 631400 15                 EPPR1   1
        14 000731   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 000732   000000 011000                    NOP     0

  11084 14 000733   000002 236000 8                  LDQ     ILS_+2
        14 000734   000022 736000                    QLS     18
        14 000735   000001 036000 8                  ADLQ    ILS_+1
        14 000736   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 000737   000002 756100                    STQ     2,,PR0

  11085 14 000740   000002 235000 8                  LDA     ILS_+2
        14 000741   000004 035007                    ADLA    4,DL
        14 000742   000002 755000 8                  STA     ILS_+2

  11086 14 000743   000002 471500                    LDP1    2,,PR0
        14 000744   000740 220003                    LDX0    480,DU
        14 000745   100000 740100                    STX0    0,,PR1

  11087 14 000746   000002 471500                    LDP1    2,,PR0
        14 000747   000000 236000 15                 LDQ     0
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:72   
        14 000750   100002 756100                    STQ     2,,PR1

      327    11091                     %NEXT_ILS (POINTER=PFORM_ILS$) ;

  11093 14 000751   000002 236100                    LDQ     2,,PR0
        14 000752   200010 756100                    STQ     PFORM_ILS$,,AUTO

      328    11096    4                PFORM_ILS$->ILS.ILL$ = TEMP$ ; /* Reinsert the SUB_END. */

  11096 14 000753   200016 236100                    LDQ     TEMP$,,AUTO
        14 000754   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 000755   000003 756100                    STQ     3,,PR0

      329    11097    4              END ;

  11097 14 000756   000761 710000 14                 TRA     s:11099

      330    11098    3              ELSE END_LABEL$->LABEL.PREV_ILS$ = PFORM_ILS$ ;

  11098 14 000757   200010 236100                    LDQ     PFORM_ILS$,,AUTO
        14 000760   100010 756100                    STQ     8,,PR1

      331    11099    3              PFORM_ILS$->ILS.NEXT = ILS$ ;

  11099 14 000761   000000 236000 7                  LDQ     ILS$
        14 000762   000002 756100                    STQ     2,,PR0

      332    11100    3            END ;

  11100 14 000763   000772 710000 14                 TRA     s:11106

      333    11101    2          ELSE IF END_LABEL$->LABEL.B.PFORM_END

  11101 14 000764   000200 316003                    CANQ    128,DU
        14 000765   000772 600000 14                 TZE     s:11106

      334    11102    2              THEN END_LABEL_74$ = END_LABEL$->LABEL.PREV_ILS$->ILS.ILL$->ILL.LOP ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:73   

  11102 14 000766   000010 471500                    LDP1    8,,PR0
        14 000767   100003 473500                    LDP3    3,,PR1
        14 000770   300001 236100                    LDQ     1,,PR3
        14 000771   200006 756100                    STQ     END_LABEL_74$,,AUTO

      335    11103                        /* Sure enough, needed the previous DEFLB's ILS address. */
      336    11104                   /* Get ILS address for CBL-74 exit label. */
      337    11105
      338    11106    2          PFORM_ILS$ = O2COM.PFORM_LIST$ ;

  11106 14 000772   000001 236000 13                 LDQ     O2COM+1
        14 000773   200010 756100                    STQ     PFORM_ILS$,,AUTO

      339    11107    2          ILS$ = PFORM_ILS$ ;

  11107 14 000774   000000 756000 7                  STQ     ILS$

      340    11108               %NEXT_ILS ;

  11110 14 000775   000000 470400 7                  LDP0    ILS$
        14 000776   000002 236100                    LDQ     2,,PR0
        14 000777   000000 756000 7                  STQ     ILS$

      341    11113    2            START_LABEL$->LABEL.B.COBOL_74_PFORM = TRUE ;

  11113 14 001000   200004 470500                    LDP0    START_LABEL$,,AUTO
        14 001001   000020 236003                    LDQ     16,DU
        14 001002   000003 256100                    ORSQ    3,,PR0

      342    11114        %EJECT;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:74   
      343    11115        /*V*
      344    11116            COBOL_74_PFORM_CREATION -- Instead of the PFORM item in the ILS that was
      345    11117                                       there we insert the following items.
      346    11118
      347    11119                                           ALTER SWITCH TO ALTER_LBL.
      348    11120                                           GO TO START_LABEL.
      349    11121                                        ALTER_LBL.
      350    11122                                           ALTER SWITCH TO END_LABEL.
      351    11123                                           PRESET SWITCH TO END_LABEL.
      352    11124
      353    11125                                        If OPTZ and PERFORM n TIMES then:
      354    11126
      355    11127                                           ALTER switch TO ALTER_LBL.
      356    11128                                           DO2.
      357    11129                                           GO TO START_LABEL.
      358    11130                                        ALTER_LBL.
      359    11131                                           DOEND.
      360    11132                                           ALTER switch TO END_LABEL.
      361    11133                                           PRESET switch TO END_LABEL.
      362    11134
      363    11135                                       The appropriate bits are then assigned for the
      364    11136                                       start and end labels.
      365    11137        */
      366    11138
      367    11139    3          IF PFORM_ILL$->PFORM.DO$ ~= ADDR (NIL) THEN DO ;

  11139 14 001003   200003 470500                    LDP0    PFORM_ILL$,,AUTO
        14 001004   000005 236100                    LDQ     5,,PR0
        14 001005   000000 116000 15                 CMPQ    0
        14 001006   001020 600000 14                 TZE     s:11150

      368    11140    3            PFORM_ILS$ = PFORM_ILL$->PFORM.DO$ ;

  11140 14 001007   200010 756100                    STQ     PFORM_ILS$,,AUTO

      369    11141    3            TEMP$ = PFORM_ILS$->ILS.ILL$ ; /* Save ADDR(LINOI) */

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:75   
  11141 14 001010   200010 471500                    LDP1    PFORM_ILS$,,AUTO
        14 001011   100003 236100                    LDQ     3,,PR1
        14 001012   200016 756100                    STQ     TEMP$,,AUTO

      370    11142    3            DO_ILS$ = PFORM_ILS$ ;

  11142 14 001013   200010 236100                    LDQ     PFORM_ILS$,,AUTO
        14 001014   200037 756100                    STQ     DO_ILS$,,AUTO

      371    11143                 %NEXT_ILS (POINTER=DO_ILS$) ; /* ADDR (ILS) for DO2 */

  11145 14 001015   200037 473500                    LDP3    DO_ILS$,,AUTO
        14 001016   300002 236100                    LDQ     2,,PR3
        14 001017   200037 756100                    STQ     DO_ILS$,,AUTO

      372    11148    3          END ;

      373    11149
      374    11150    2          CALL OVERLAY_PERFORM_CHECK;

  11150 14 001020   003501 701000 14                 TSX1    OVERLAY_PERFORM_CHECK
        14 001021   000000 011000                    NOP     0

      375    11151
      376    11152
      377    11153               %SET LISTMAC = '1'B;
      378    11154
      379    11155               %PRE_PERFORM_ALTER;
             11156    3      DO;

             11157    3          IF PRE_ALTER_CHANGE THEN

  11157 14 001022   200030 234100                    SZN     PRE_ALTER_CHANGE,,AUTO
        14 001023   001045 605000 14                 TPL     s:11165

             11158    4            DO;

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:76   
             11159    4              CALL GEN_ALTER_CHANGE (ALTER_LBL$,

  11159 14 001024   200024 630500                    EPPR0   NEW_LABEL$,,AUTO
        14 001025   200043 450500                    STP0    @SEG_NO#+1,,AUTO
        14 001026   200026 631500                    EPPR1   FROM_SEG_NO#,,AUTO
        14 001027   200042 451500                    STP1    SEG_LTS$+1,,AUTO
        14 001030   200013 633500                    EPPR3   ALTER_LBL$,,AUTO
        14 001031   200041 453500                    STP3    DO_ILS$+2,,AUTO
        14 001032   003170 701000 14                 TSX1    GEN_ALTER_CHANGE
        14 001033   000000 011000                    NOP     0

             11160    4                                     FROM_SEG_NO#,
             11161    4                                     NEW_LABEL$);
             11162    4              CALL CREATE_ITEM_ILS (%ALTER, POINTER$, NEW_LABEL$);

  11162 14 001034   200024 630500                    EPPR0   NEW_LABEL$,,AUTO
        14 001035   200051 450500                    STP0    @ITEM_ROP$,,AUTO
        14 001036   200035 631500                    EPPR1   POINTER$,,AUTO
        14 001037   200050 451500                    STP1    @ITEM_LOP$,,AUTO
        14 001040   000015 236000 15                 LDQ     13
        14 001041   200047 756100                    STQ     @ITEM_TYPE,,AUTO
        14 001042   000136 701000 14                 TSX1    CREATE_ITEM_ILS
        14 001043   000000 011000                    NOP     0

             11163    4            END;

  11163 14 001044   001055 710000 14                 TRA     s:11175

             11164    3          ELSE
             11165    3            CALL CREATE_ITEM_ILS(%ALTER, POINTER$, ALTER_LBL$) ;

  11165 14 001045   200013 630500                    EPPR0   ALTER_LBL$,,AUTO
        14 001046   200051 450500                    STP0    @ITEM_ROP$,,AUTO
        14 001047   200035 631500                    EPPR1   POINTER$,,AUTO
        14 001050   200050 451500                    STP1    @ITEM_LOP$,,AUTO
        14 001051   000015 236000 15                 LDQ     13
        14 001052   200047 756100                    STQ     @ITEM_TYPE,,AUTO
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:77   
        14 001053   000136 701000 14                 TSX1    CREATE_ITEM_ILS
        14 001054   000000 011000                    NOP     0

             11166    3      END;

      380    11168
      381    11169               %SET LISTMAC = '0'B;
      382    11170
      383    11171
      384    11172        /*  If an independent segment will be brought in, the alter switches
      385    11173            in that independent segment need to be refreshed.              */
      386    11174
      387    11175    2          CALL SEGMENT_CHECK (SEGMENT_LTS$, %MAX_FIXED_SEG# + 1);

  11175 14 001055   000017 236000 15                 LDQ     15
        14 001056   200042 756100                    STQ     SEG_LTS$+1,,AUTO
        14 001057   200022 630500                    EPPR0   SEGMENT_LTS$,,AUTO
        14 001060   200041 450500                    STP0    DO_ILS$+2,,AUTO
        14 001061   003047 701000 14                 TSX1    SEGMENT_CHECK
        14 001062   000000 011000                    NOP     0

      388    11176
      389    11177    2          IF REFRESH_SEGMENT THEN

  11177 14 001063   200021 234100                    SZN     REFRESH_SEGMENT,,AUTO
        14 001064   001071 605000 14                 TPL     s:11180

      390    11178    2            CALL RESET_OVERLAY (SEGMENT_LTS$);

  11178 14 001065   200022 630500                    EPPR0   SEGMENT_LTS$,,AUTO
        14 001066   200041 450500                    STP0    DO_ILS$+2,,AUTO
        14 001067   003131 701000 14                 TSX1    RESET_OVERLAY
        14 001070   000000 011000                    NOP     0

      391    11179
      392    11180    3          IF PFORM_ILL$->PFORM.DO$ ~= ADDR (NIL) THEN DO ;

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:78   
  11180 14 001071   200003 470500                    LDP0    PFORM_ILL$,,AUTO
        14 001072   000005 236100                    LDQ     5,,PR0
        14 001073   000000 116000 15                 CMPQ    0
        14 001074   001151 600000 14                 TZE     s:11253

      393    11181                 %RESERVE_ILS (ITEM=%OPN, POINTER=PFORM_ILS$->ILS.NEXT) ;

  11201 14 001075   000002 236000 8                  LDQ     ILS_+2
        14 001076   000004 036007                    ADLQ    4,DL
        14 001077   000003 116000 8                  CMPQ    ILS_+3
        14 001100   001111 602000 14                 TNC     s:11203

  11202 14 001101   000002 236000 15                 LDQ     2
        14 001102   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 001103   200052 631500                    EPPR1   @ITEM_ROP$+1,,AUTO
        14 001104   200053 451500                    STP1    @ITEM_ROP$+2,,AUTO
        14 001105   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 001106   000001 631400 15                 EPPR1   1
        14 001107   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 001110   000000 011000                    NOP     0

  11203 14 001111   000002 236000 8                  LDQ     ILS_+2
        14 001112   000022 736000                    QLS     18
        14 001113   000001 036000 8                  ADLQ    ILS_+1
        14 001114   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 001115   000002 756100                    STQ     2,,PR0

  11204 14 001116   000002 235000 8                  LDA     ILS_+2
        14 001117   000004 035007                    ADLA    4,DL
        14 001120   000002 755000 8                  STA     ILS_+2

  11205 14 001121   000002 471500                    LDP1    2,,PR0
        14 001122   000740 220003                    LDX0    480,DU
        14 001123   100000 740100                    STX0    0,,PR1

  11206 14 001124   000002 471500                    LDP1    2,,PR0
        14 001125   000000 236000 15                 LDQ     0
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:79   
        14 001126   100002 756100                    STQ     2,,PR1

      394    11210                 %NEXT_ILS (POINTER=PFORM_ILS$) ;

  11212 14 001127   000002 236100                    LDQ     2,,PR0
        14 001130   200010 756100                    STQ     PFORM_ILS$,,AUTO

      395    11215    3            PFORM_ILS$->ILS.ILL$ = TEMP$ ;

  11215 14 001131   200016 236100                    LDQ     TEMP$,,AUTO
        14 001132   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 001133   000003 756100                    STQ     3,,PR0

      396    11216    3            PFORM_ILS$->ILS.NEXT = DO_ILS$ ; /* LINOI and DO2 go here. */

  11216 14 001134   200037 236100                    LDQ     DO_ILS$,,AUTO
        14 001135   000002 756100                    STQ     2,,PR0

      397    11217                 %NEXT_NON_LINOI (POINTER=PFORM_ILS$) ;

  11222 14 001136   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 001137   000002 236100                    LDQ     2,,PR0
        14 001140   200010 756100                    STQ     PFORM_ILS$,,AUTO

  11225 14 001141   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 001142   000003 236100                    LDQ     3,,PR0
        14 001143   000000 116000 15                 CMPQ    0
        14 001144   001136 600000 14                 TZE     s:11222
        14 001145   000003 471500                    LDP1    3,,PR0
        14 001146   100000 220100                    LDX0    0,,PR1
        14 001147   000373 100003                    CMPX0   251,DU
        14 001150   001136 600000 14                 TZE     s:11222

      398    11227    3          END ;

      399    11228
      400    11229               %SET LISTMAC = '1'B;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:80   
      401    11230
      402    11231               %PERFORM_TO_GO;
             11232    3      DO;

             11233               %RESERVE_ILS(ITEM = %OPN, POINTER = PFORM_ILS$->ILS.NEXT);
             11234    4          DO ;

             11235                 %IF VARIABLE ;
             11243                 %ELSE ;
             11244                   %IF ITEM % = %OPN;
             11245                      %LSET @ILS_SIZE = CHARTEXT('SIZEW(OPN)');
             11246                   %ELSEIF ITEM = %OPV
             11252                   %ENDIF;
             11253    4              IF ILS_.BOTTOM + %@ILS_SIZE >= ILS_.FLOOR

  11253 14 001151   000002 236000 8                  LDQ     ILS_+2
        14 001152   000004 036007                    ADLQ    4,DL
        14 001153   000003 116000 8                  CMPQ    ILS_+3
        14 001154   001165 602000 14                 TNC     s:11255

             11254    4              THEN CALL Z8AR$RESERVER(ADDR(ILS_));

  11254 14 001155   000002 236000 15                 LDQ     2
        14 001156   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 001157   200052 630500                    EPPR0   @ITEM_ROP$+1,,AUTO
        14 001160   200053 450500                    STP0    @ITEM_ROP$+2,,AUTO
        14 001161   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 001162   000001 631400 15                 EPPR1   1
        14 001163   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 001164   000000 011000                    NOP     0

             11255    4              POINTER = PINCRW (ILS_.FIRST, ILS_.BOTTOM) ;

  11255 14 001165   000002 236000 8                  LDQ     ILS_+2
        14 001166   000022 736000                    QLS     18
        14 001167   000001 036000 8                  ADLQ    ILS_+1
        14 001170   200010 470500                    LDP0    PFORM_ILS$,,AUTO
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:81   
        14 001171   000002 756100                    STQ     2,,PR0

             11256    4              ILS_.BOTTOM = ILS_.BOTTOM + %@ILS_SIZE ;

  11256 14 001172   000002 235000 8                  LDA     ILS_+2
        14 001173   000004 035007                    ADLA    4,DL
        14 001174   000002 755000 8                  STA     ILS_+2

             11257    4              POINTER->ILS.ID = ITEM % ;

  11257 14 001175   000002 471500                    LDP1    2,,PR0
        14 001176   000740 220003                    LDX0    480,DU
        14 001177   100000 740100                    STX0    0,,PR1

             11258    4              POINTER->ILS.NEXT = ADDR(NIL);

  11258 14 001200   000002 471500                    LDP1    2,,PR0
        14 001201   000000 236000 15                 LDQ     0
        14 001202   100002 756100                    STQ     2,,PR1

             11259                 %ENDIF ;
             11260    4          END ;

             11262               %NEXT_ILS(POINTER = PFORM_ILS$) ;
             11263    4          DO ; /* Next ILS entry in the ILS chain */

             11264    4            POINTER = POINTER->ILS.NEXT ;

  11264 14 001203   000002 236100                    LDQ     2,,PR0
        14 001204   200010 756100                    STQ     PFORM_ILS$,,AUTO

             11265    4          END ;

             11267               %RESERVE_ILL(ITEM = %LINOI, POINTER = PFORM_ILS$->ILS.ILL$);
             11268    4        DO;

             11269    4          ITERATION = ILL_STEP(ITEM% - %FIRST_ILL);
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:82   

  11269 14 001205   000145 235000 xsym               LDA     ILL_STEP+101
        14 001206   000000 755000 0                  STA     ITERATION

             11270    4          IF ILL_.BOTTOM + ITERATION >= ILL_.FLOOR THEN

  11270 14 001207   000002 236000 6                  LDQ     ILL_+2
        14 001210   000000 036000 0                  ADLQ    ITERATION
        14 001211   000003 116000 6                  CMPQ    ILL_+3
        14 001212   001223 604000 14                 TMI     s:11272

             11271    4            CALL Z8AR$RESERVER(ADDR(ILL_));

  11271 14 001213   000003 236000 15                 LDQ     3
        14 001214   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 001215   200052 630500                    EPPR0   @ITEM_ROP$+1,,AUTO
        14 001216   200053 450500                    STP0    @ITEM_ROP$+2,,AUTO
        14 001217   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 001220   000001 631400 15                 EPPR1   1
        14 001221   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 001222   000000 011000                    NOP     0

             11272    4          POINTER = PINCRW(ILL_.FIRST, ILL_.BOTTOM);

  11272 14 001223   000002 236000 6                  LDQ     ILL_+2
        14 001224   000022 736000                    QLS     18
        14 001225   000001 036000 6                  ADLQ    ILL_+1
        14 001226   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 001227   000003 756100                    STQ     3,,PR0

             11273    4          ILL_.BOTTOM = ILL_.BOTTOM + ITERATION;

  11273 14 001230   000002 236000 6                  LDQ     ILL_+2
        14 001231   000000 036000 0                  ADLQ    ITERATION
        14 001232   000002 756000 6                  STQ     ILL_+2

             11274    4          POINTER -> ILL.ID = ITEM %;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:83   

  11274 14 001233   000003 471500                    LDP1    3,,PR0
        14 001234   000373 220003                    LDX0    251,DU
        14 001235   100000 740100                    STX0    0,,PR1

             11275    4        END;

             11277    3          PFORM_ILS$->ILS.ILL$->LINOI.PREV_LINE = COMCOM.CURRENT.LINE;

  11277 14 001236   000003 471500                    LDP1    3,,PR0
        14 001237   000133 721000 xsym               LXL1    COMCOM+91
        14 001240   100000 441100                    SXL1    0,,PR1

             11278    3          PFORM_ILS$->ILS.ILL$->LINOI.LINE_NO = COMCOM.CURRENT.LINE;

  11278 14 001241   000003 471500                    LDP1    3,,PR0
        14 001242   000133 721000 xsym               LXL1    COMCOM+91
        14 001243   100001 441100                    SXL1    1,,PR1

             11279    3          PFORM_ILS$->ILS.ILL$->LINOI.PREV_COL = COMCOM.CURRENT.COLUMN;

  11279 14 001244   000003 471500                    LDP1    3,,PR0
        14 001245   000134 721000 xsym               LXL1    COMCOM+92
        14 001246   100002 441100                    SXL1    2,,PR1

             11280    3          PFORM_ILS$->ILS.ILL$->LINOI.COLUMN_NO = COMCOM.CURRENT.COLUMN;

  11280 14 001247   000003 471500                    LDP1    3,,PR0
        14 001250   000134 721000 xsym               LXL1    COMCOM+92
        14 001251   100001 741100                    STX1    1,,PR1

             11281    3          IF PERFORM_CHANGE THEN

  11281 14 001252   200032 234100                    SZN     PERFORM_CHANGE,,AUTO
        14 001253   001277 605000 14                 TPL     s:11289

             11282    4            DO;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:84   

             11283    4              CALL GEN_ALTER_CHANGE (START_LABEL$,

  11283 14 001254   200024 631500                    EPPR1   NEW_LABEL$,,AUTO
        14 001255   200043 451500                    STP1    @SEG_NO#+1,,AUTO
        14 001256   200025 633500                    EPPR3   TO_SEG_NO#,,AUTO
        14 001257   200042 453500                    STP3    SEG_LTS$+1,,AUTO
        14 001260   200004 634500                    EPPR4   START_LABEL$,,AUTO
        14 001261   200041 454500                    STP4    DO_ILS$+2,,AUTO
        14 001262   003170 701000 14                 TSX1    GEN_ALTER_CHANGE
        14 001263   000000 011000                    NOP     0

             11284    4                                     TO_SEG_NO#,
             11285    4                                     NEW_LABEL$);
             11286    4              CALL CREATE_ITEM_ILS (%GO, NEW_LABEL$, ADDR(NIL));

  11286 14 001264   000000 236000 15                 LDQ     0
        14 001265   200057 756100                    STQ     @ITEM_ROP$+6,,AUTO
        14 001266   200057 630500                    EPPR0   @ITEM_ROP$+6,,AUTO
        14 001267   200051 450500                    STP0    @ITEM_ROP$,,AUTO
        14 001270   200024 631500                    EPPR1   NEW_LABEL$,,AUTO
        14 001271   200050 451500                    STP1    @ITEM_LOP$,,AUTO
        14 001272   000013 236000 15                 LDQ     11
        14 001273   200047 756100                    STQ     @ITEM_TYPE,,AUTO
        14 001274   000136 701000 14                 TSX1    CREATE_ITEM_ILS
        14 001275   000000 011000                    NOP     0

             11287    4            END;

  11287 14 001276   001311 710000 14                 TRA     s:11295

             11288    3          ELSE
             11289    3            CALL CREATE_ITEM_ILS(%GO, START_LABEL$, ADDR(NIL)) ;

  11289 14 001277   000000 236000 15                 LDQ     0
        14 001300   200060 756100                    STQ     @ITEM_ROP$+7,,AUTO
        14 001301   200060 631500                    EPPR1   @ITEM_ROP$+7,,AUTO
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:85   
        14 001302   200051 451500                    STP1    @ITEM_ROP$,,AUTO
        14 001303   200004 633500                    EPPR3   START_LABEL$,,AUTO
        14 001304   200050 453500                    STP3    @ITEM_LOP$,,AUTO
        14 001305   000013 236000 15                 LDQ     11
        14 001306   200047 756100                    STQ     @ITEM_TYPE,,AUTO
        14 001307   000136 701000 14                 TSX1    CREATE_ITEM_ILS
        14 001310   000000 011000                    NOP     0

             11290    3      END;

      403    11292
      404    11293               %SET LISTMAC = '0'B;
      405    11294
      406    11295    2          PFORM_ILS$->ILS.ILL$->ILL.CODE = %GO_UNCONDITIONAL ;

  11295 14 001311   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 001312   000003 471500                    LDP1    3,,PR0
        14 001313   000000 220003                    LDX0    0,DU
        14 001314   100000 440100                    SXL0    0,,PR1

      407    11296               %CREATE_LINOI_AND_DEFLB ;

  11300 14 001315   200013 471500                    LDP1    ALTER_LBL$,,AUTO
        14 001316   400000 236003                    LDQ     -131072,DU
        14 001317   100003 256100                    ORSQ    3,,PR1

  11301 14 001320   200010 236100                    LDQ     PFORM_ILS$,,AUTO
        14 001321   200013 471500                    LDP1    ALTER_LBL$,,AUTO
        14 001322   100010 756100                    STQ     8,,PR1

  11302 14 001323   200020 236100                    LDQ     CURRENT_PROC$,,AUTO
        14 001324   200013 471500                    LDP1    ALTER_LBL$,,AUTO
        14 001325   100011 756100                    STQ     9,,PR1

  11323 14 001326   000002 236000 8                  LDQ     ILS_+2
        14 001327   000004 036007                    ADLQ    4,DL
        14 001330   000003 116000 8                  CMPQ    ILS_+3
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:86   
        14 001331   001342 602000 14                 TNC     s:11325

  11324 14 001332   000002 236000 15                 LDQ     2
        14 001333   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 001334   200052 631500                    EPPR1   @ITEM_ROP$+1,,AUTO
        14 001335   200053 451500                    STP1    @ITEM_ROP$+2,,AUTO
        14 001336   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 001337   000001 631400 15                 EPPR1   1
        14 001340   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 001341   000000 011000                    NOP     0

  11325 14 001342   000002 236000 8                  LDQ     ILS_+2
        14 001343   000022 736000                    QLS     18
        14 001344   000001 036000 8                  ADLQ    ILS_+1
        14 001345   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 001346   000002 756100                    STQ     2,,PR0

  11326 14 001347   000002 235000 8                  LDA     ILS_+2
        14 001350   000004 035007                    ADLA    4,DL
        14 001351   000002 755000 8                  STA     ILS_+2

  11327 14 001352   000002 471500                    LDP1    2,,PR0
        14 001353   000740 220003                    LDX0    480,DU
        14 001354   100000 740100                    STX0    0,,PR1

  11328 14 001355   000002 471500                    LDP1    2,,PR0
        14 001356   000000 236000 15                 LDQ     0
        14 001357   100002 756100                    STQ     2,,PR1

  11334 14 001360   000002 236100                    LDQ     2,,PR0
        14 001361   200010 756100                    STQ     PFORM_ILS$,,AUTO

  11339 14 001362   000145 235000 xsym               LDA     ILL_STEP+101
        14 001363   000000 755000 0                  STA     ITERATION

  11340 14 001364   000002 236000 6                  LDQ     ILL_+2
        14 001365   000000 036000 0                  ADLQ    ITERATION
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:87   
        14 001366   000003 116000 6                  CMPQ    ILL_+3
        14 001367   001400 604000 14                 TMI     s:11342

  11341 14 001370   000003 236000 15                 LDQ     3
        14 001371   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 001372   200052 630500                    EPPR0   @ITEM_ROP$+1,,AUTO
        14 001373   200053 450500                    STP0    @ITEM_ROP$+2,,AUTO
        14 001374   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 001375   000001 631400 15                 EPPR1   1
        14 001376   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 001377   000000 011000                    NOP     0

  11342 14 001400   000002 236000 6                  LDQ     ILL_+2
        14 001401   000022 736000                    QLS     18
        14 001402   000001 036000 6                  ADLQ    ILL_+1
        14 001403   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 001404   000003 756100                    STQ     3,,PR0

  11343 14 001405   000002 236000 6                  LDQ     ILL_+2
        14 001406   000000 036000 0                  ADLQ    ITERATION
        14 001407   000002 756000 6                  STQ     ILL_+2

  11344 14 001410   000003 471500                    LDP1    3,,PR0
        14 001411   000373 220003                    LDX0    251,DU
        14 001412   100000 740100                    STX0    0,,PR1

  11347 14 001413   000003 471500                    LDP1    3,,PR0
        14 001414   000000 473400 7                  LDP3    ILS$
        14 001415   300003 474500                    LDP4    3,,PR3
        14 001416   400000 721100                    LXL1    0,,PR4
        14 001417   100000 441100                    SXL1    0,,PR1

  11348 14 001420   000003 471500                    LDP1    3,,PR0
        14 001421   000000 473400 7                  LDP3    ILS$
        14 001422   300003 474500                    LDP4    3,,PR3
        14 001423   400000 721100                    LXL1    0,,PR4
        14 001424   100001 441100                    SXL1    1,,PR1
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:88   

  11349 14 001425   000003 471500                    LDP1    3,,PR0
        14 001426   300003 474500                    LDP4    3,,PR3
        14 001427   400002 721100                    LXL1    2,,PR4
        14 001430   100002 441100                    SXL1    2,,PR1

  11350 14 001431   000003 471500                    LDP1    3,,PR0
        14 001432   300003 474500                    LDP4    3,,PR3
        14 001433   400002 721100                    LXL1    2,,PR4
        14 001434   100001 741100                    STX1    1,,PR1

  11371 14 001435   000002 236000 8                  LDQ     ILS_+2
        14 001436   000005 036007                    ADLQ    5,DL
        14 001437   000003 116000 8                  CMPQ    ILS_+3
        14 001440   001451 602000 14                 TNC     s:11373

  11372 14 001441   000002 236000 15                 LDQ     2
        14 001442   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 001443   200052 631500                    EPPR1   @ITEM_ROP$+1,,AUTO
        14 001444   200053 451500                    STP1    @ITEM_ROP$+2,,AUTO
        14 001445   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 001446   000001 631400 15                 EPPR1   1
        14 001447   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 001450   000000 011000                    NOP     0

  11373 14 001451   000002 236000 8                  LDQ     ILS_+2
        14 001452   000022 736000                    QLS     18
        14 001453   000001 036000 8                  ADLQ    ILS_+1
        14 001454   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 001455   000002 756100                    STQ     2,,PR0

  11374 14 001456   000002 235000 8                  LDA     ILS_+2
        14 001457   000005 035007                    ADLA    5,DL
        14 001460   000002 755000 8                  STA     ILS_+2

  11375 14 001461   000002 471500                    LDP1    2,,PR0
        14 001462   000742 220003                    LDX0    482,DU
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:89   
        14 001463   100000 740100                    STX0    0,,PR1

  11376 14 001464   000002 471500                    LDP1    2,,PR0
        14 001465   000000 236000 15                 LDQ     0
        14 001466   100002 756100                    STQ     2,,PR1

  11382 14 001467   000002 236100                    LDQ     2,,PR0
        14 001470   200010 756100                    STQ     PFORM_ILS$,,AUTO

  11385 14 001471   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 001472   400000 236003                    LDQ     -131072,DU
        14 001473   000001 256100                    ORSQ    1,,PR0

  11386 14 001474   000000 236000 15                 LDQ     0
        14 001475   000004 756100                    STQ     4,,PR0

  11389 14 001476   000120 235000 xsym               LDA     ILL_STEP+80
        14 001477   000000 755000 0                  STA     ITERATION

  11390 14 001500   000002 236000 6                  LDQ     ILL_+2
        14 001501   000000 036000 0                  ADLQ    ITERATION
        14 001502   000003 116000 6                  CMPQ    ILL_+3
        14 001503   001514 604000 14                 TMI     s:11392

  11391 14 001504   000003 236000 15                 LDQ     3
        14 001505   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 001506   200052 631500                    EPPR1   @ITEM_ROP$+1,,AUTO
        14 001507   200053 451500                    STP1    @ITEM_ROP$+2,,AUTO
        14 001510   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 001511   000001 631400 15                 EPPR1   1
        14 001512   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 001513   000000 011000                    NOP     0

  11392 14 001514   000002 236000 6                  LDQ     ILL_+2
        14 001515   000022 736000                    QLS     18
        14 001516   000001 036000 6                  ADLQ    ILL_+1
        14 001517   200010 470500                    LDP0    PFORM_ILS$,,AUTO
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:90   
        14 001520   000003 756100                    STQ     3,,PR0

  11393 14 001521   000002 236000 6                  LDQ     ILL_+2
        14 001522   000000 036000 0                  ADLQ    ITERATION
        14 001523   000002 756000 6                  STQ     ILL_+2

  11394 14 001524   000003 471500                    LDP1    3,,PR0
        14 001525   000346 220003                    LDX0    230,DU
        14 001526   100000 740100                    STX0    0,,PR1

  11397 14 001527   000003 471500                    LDP1    3,,PR0
        14 001530   200013 236100                    LDQ     ALTER_LBL$,,AUTO
        14 001531   100001 756100                    STQ     1,,PR1

  11398 14 001532   000003 471500                    LDP1    3,,PR0
        14 001533   000000 236000 15                 LDQ     0
        14 001534   100002 756100                    STQ     2,,PR1

      408    11401    3          IF PFORM_ILL$->PFORM.DO$ ~= ADDR (NIL) THEN DO ;

  11401 14 001535   200003 471500                    LDP1    PFORM_ILL$,,AUTO
        14 001536   100005 236100                    LDQ     5,,PR1
        14 001537   000000 116000 15                 CMPQ    0
        14 001540   001555 600000 14                 TZE     s:11418

      409    11402    3            PFORM_ILS$->ILS.NEXT = ILS$ ;

  11402 14 001541   000000 236000 7                  LDQ     ILS$
        14 001542   000002 756100                    STQ     2,,PR0

      410    11403                 /* The ALTER and PRESET go after the DOEND in this case. */
      411    11404    4            DO UNTIL PFORM_ILS$->ILS.ILL$->ILL.ID = %DOEND ;

      412    11405                   %NEXT_ILS (POINTER=PFORM_ILS$) ;

  11407 14 001543   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 001544   000002 236100                    LDQ     2,,PR0
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:91   
        14 001545   200010 756100                    STQ     PFORM_ILS$,,AUTO

      413    11410    4            END ;

  11410 14 001546   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 001547   000003 471500                    LDP1    3,,PR0
        14 001550   100000 220100                    LDX0    0,,PR1
        14 001551   000403 100003                    CMPX0   259,DU
        14 001552   001543 601000 14                 TNZ     s:11407

      414    11411    3            ILS$ = PFORM_ILS$->ILS.NEXT ;

  11411 14 001553   000002 236100                    LDQ     2,,PR0
        14 001554   000000 756000 7                  STQ     ILS$

      415    11412    3          END ;

      416    11413
      417    11414               %SET LISTMAC = '1'B;
      418    11415
      419    11416               %POST_PERFORM_ALTER;
             11417    3      DO;

             11418    3          IF POST_ALTER_CHANGE THEN

  11418 14 001555   200031 234100                    SZN     POST_ALTER_CHANGE,,AUTO
        14 001556   001600 605000 14                 TPL     s:11426

             11419    4            DO;

             11420    4              CALL GEN_ALTER_CHANGE (END_LABEL_74$,

  11420 14 001557   200024 631500                    EPPR1   NEW_LABEL$,,AUTO
        14 001560   200043 451500                    STP1    @SEG_NO#+1,,AUTO
        14 001561   200027 633500                    EPPR3   END_SEG_NO#,,AUTO
        14 001562   200042 453500                    STP3    SEG_LTS$+1,,AUTO
        14 001563   200006 634500                    EPPR4   END_LABEL_74$,,AUTO
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:92   
        14 001564   200041 454500                    STP4    DO_ILS$+2,,AUTO
        14 001565   003170 701000 14                 TSX1    GEN_ALTER_CHANGE
        14 001566   000000 011000                    NOP     0

             11421    4                                     END_SEG_NO#,
             11422    4                                     NEW_LABEL$);
             11423    4              CALL CREATE_ITEM_ILS (%ALTER, POINTER$, NEW_LABEL$);

  11423 14 001567   200024 630500                    EPPR0   NEW_LABEL$,,AUTO
        14 001570   200051 450500                    STP0    @ITEM_ROP$,,AUTO
        14 001571   200035 631500                    EPPR1   POINTER$,,AUTO
        14 001572   200050 451500                    STP1    @ITEM_LOP$,,AUTO
        14 001573   000015 236000 15                 LDQ     13
        14 001574   200047 756100                    STQ     @ITEM_TYPE,,AUTO
        14 001575   000136 701000 14                 TSX1    CREATE_ITEM_ILS
        14 001576   000000 011000                    NOP     0

             11424    4            END;

  11424 14 001577   001610 710000 14                 TRA     s:11432

             11425    3          ELSE
             11426    3            CALL CREATE_ITEM_ILS(%ALTER, POINTER$, END_LABEL_74$) ;

  11426 14 001600   200006 631500                    EPPR1   END_LABEL_74$,,AUTO
        14 001601   200051 451500                    STP1    @ITEM_ROP$,,AUTO
        14 001602   200035 633500                    EPPR3   POINTER$,,AUTO
        14 001603   200050 453500                    STP3    @ITEM_LOP$,,AUTO
        14 001604   000015 236000 15                 LDQ     13
        14 001605   200047 756100                    STQ     @ITEM_TYPE,,AUTO
        14 001606   000136 701000 14                 TSX1    CREATE_ITEM_ILS
        14 001607   000000 011000                    NOP     0

             11427    3      END;

      420    11429
      421    11430               %SET LISTMAC = '0'B;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:93   
      422    11431
      423    11432    2          IF NOT (END_LABEL$->LABEL.B.PFORM_74_END) THEN

  11432 14 001610   200005 470500                    LDP0    END_LABEL$,,AUTO
        14 001611   000003 236100                    LDQ     3,,PR0
        14 001612   000010 316003                    CANQ    8,DU
        14 001613   002103 601000 14                 TNZ     s:11548

      424    11433    3            DO ;

      425    11434    3              END_LABEL$->LABEL.B.GOTO_LABEL = TRUE ;

  11434 14 001614   040000 236003                    LDQ     16384,DU
        14 001615   000003 256100                    ORSQ    3,,PR0

      426    11435    3              END_LABEL$->LABEL.POINTER$ = POINTER$ ;

  11435 14 001616   200035 236100                    LDQ     POINTER$,,AUTO
        14 001617   200005 470500                    LDP0    END_LABEL$,,AUTO
        14 001620   000005 756100                    STQ     5,,PR0

      427    11436    3              CALL CREATE_ITEM_ILS(%PTR_SET, POINTER$->ETT.LOP, END_LABEL_74$) ;

  11436 14 001621   200006 630500                    EPPR0   END_LABEL_74$,,AUTO
        14 001622   200051 450500                    STP0    @ITEM_ROP$,,AUTO
        14 001623   200035 236100                    LDQ     POINTER$,,AUTO
        14 001624   000001 036003                    ADLQ    1,DU
        14 001625   200050 756100                    STQ     @ITEM_LOP$,,AUTO
        14 001626   000021 236000 15                 LDQ     17
        14 001627   200047 756100                    STQ     @ITEM_TYPE,,AUTO
        14 001630   000136 701000 14                 TSX1    CREATE_ITEM_ILS
        14 001631   000000 011000                    NOP     0

      428    11437    3              END_LABEL$->LABEL.B.PFORM_74_END = TRUE ;

  11437 14 001632   200005 470500                    LDP0    END_LABEL$,,AUTO
        14 001633   000010 236003                    LDQ     8,DU
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:94   
        14 001634   000003 256100                    ORSQ    3,,PR0

      429    11438    3              IF CURRENT_PROC$->PROC_.PROC_DEF$->PROC_DEF.ID = %INTDEF

  11438 14 001635   200020 470500                    LDP0    CURRENT_PROC$,,AUTO
        14 001636   000006 471500                    LDP1    6,,PR0
        14 001637   100000 220100                    LDX0    0,,PR1
        14 001640   000776 100003                    CMPX0   510,DU
        14 001641   001645 601000 14                 TNZ     s:11440

      430    11439    3                THEN ENTRY$ = COMCOM.INT_SUB$ ;

  11439 14 001642   000361 236000 xsym               LDQ     COMCOM+241
        14 001643   200014 756100                    STQ     ENTRY$,,AUTO
        14 001644   001647 710000 14                 TRA     s:11442

      431    11440    3                ELSE ENTRY$ = COMCOM.H_ENTRY$ ;

  11440 14 001645   000423 236000 xsym               LDQ     COMCOM+275
        14 001646   200014 756100                    STQ     ENTRY$,,AUTO

      432    11441                     /* The subroutine entries need to initialize the PERFORM, too. */
      433    11442    3              ALTER$ = ADDR (NIL) ;

  11442 14 001647   000000 236000 15                 LDQ     0
        14 001650   200015 756100                    STQ     ALTER$,,AUTO

      434    11443    4              DO UNTIL ENTRY$ = ADDR (NIL) ;

      435    11444    4                IF ENTRY$->ILS.ILL$->ENTRY_ILL.LOP->PROC_DEF.PROC$

  11444 14 001651   200014 470500                    LDP0    ENTRY$,,AUTO
        14 001652   000003 471500                    LDP1    3,,PR0
        14 001653   100001 473500                    LDP3    1,,PR1
        14 001654   300011 236100                    LDQ     9,,PR3
        14 001655   200020 116100                    CMPQ    CURRENT_PROC$,,AUTO
        14 001656   002075 601000 14                 TNZ     s:11544
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:95   

      436    11445    5                    = CURRENT_PROC$ THEN DO ;

      437    11446    5                  LINOI$ = ENTRY$ ;

  11446 14 001657   200014 236100                    LDQ     ENTRY$,,AUTO
        14 001660   200036 756100                    STQ     LINOI$,,AUTO

      438    11447    6                  DO UNTIL LINOI$->ILS.ILL$->ILL.ID = %LINOI ;

      439    11448                         %NEXT_ILS (POINTER=LINOI$) ;

  11450 14 001661   200036 470500                    LDP0    LINOI$,,AUTO
        14 001662   000002 236100                    LDQ     2,,PR0
        14 001663   200036 756100                    STQ     LINOI$,,AUTO

      440    11453    6                  END ;

  11453 14 001664   200036 470500                    LDP0    LINOI$,,AUTO
        14 001665   000003 471500                    LDP1    3,,PR0
        14 001666   100000 220100                    LDX0    0,,PR1
        14 001667   000373 100003                    CMPX0   251,DU
        14 001670   001661 601000 14                 TNZ     s:11450

      441    11454    6                  IF ALTER$ = ADDR(NIL) THEN DO ;

  11454 14 001671   200015 236100                    LDQ     ALTER$,,AUTO
        14 001672   000000 116000 15                 CMPQ    0
        14 001673   001730 601000 14                 TNZ     s:11488

      442    11455                         %RESERVE_ILL (ITEM=%ALTER, POINTER=ALTER$) ;

  11457 14 001674   000164 235000 xsym               LDA     ILL_STEP+116
        14 001675   000000 755000 0                  STA     ITERATION

  11458 14 001676   000002 236000 6                  LDQ     ILL_+2
        14 001677   000000 036000 0                  ADLQ    ITERATION
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:96   
        14 001700   000003 116000 6                  CMPQ    ILL_+3
        14 001701   001712 604000 14                 TMI     s:11460

  11459 14 001702   000003 236000 15                 LDQ     3
        14 001703   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 001704   200052 631500                    EPPR1   @ITEM_ROP$+1,,AUTO
        14 001705   200053 451500                    STP1    @ITEM_ROP$+2,,AUTO
        14 001706   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 001707   000001 631400 15                 EPPR1   1
        14 001710   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 001711   000000 011000                    NOP     0

  11460 14 001712   000002 236000 6                  LDQ     ILL_+2
        14 001713   000022 736000                    QLS     18
        14 001714   000001 036000 6                  ADLQ    ILL_+1
        14 001715   200015 756100                    STQ     ALTER$,,AUTO

  11461 14 001716   000002 236000 6                  LDQ     ILL_+2
        14 001717   000000 036000 0                  ADLQ    ITERATION
        14 001720   000002 756000 6                  STQ     ILL_+2

  11462 14 001721   000412 220003                    LDX0    266,DU
        14 001722   200015 470500                    LDP0    ALTER$,,AUTO
        14 001723   000000 740100                    STX0    0,,PR0

      443    11465    6                    ALTER$->ILL.LOP = POINTER$ ;

  11465 14 001724   200035 236100                    LDQ     POINTER$,,AUTO
        14 001725   000001 756100                    STQ     1,,PR0

      444    11466    6                    ALTER$->ILL.ROP = END_LABEL_74$ ;

  11466 14 001726   200006 236100                    LDQ     END_LABEL_74$,,AUTO
        14 001727   000002 756100                    STQ     2,,PR0

      445    11467    6                  END ;

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:97   
      446    11468                       %RESERVE_ILS (ITEM=%OPN, POINTER=TEMP$) ;

  11488 14 001730   000002 236000 8                  LDQ     ILS_+2
        14 001731   000004 036007                    ADLQ    4,DL
        14 001732   000003 116000 8                  CMPQ    ILS_+3
        14 001733   001744 602000 14                 TNC     s:11490

  11489 14 001734   000002 236000 15                 LDQ     2
        14 001735   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 001736   200052 630500                    EPPR0   @ITEM_ROP$+1,,AUTO
        14 001737   200053 450500                    STP0    @ITEM_ROP$+2,,AUTO
        14 001740   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 001741   000001 631400 15                 EPPR1   1
        14 001742   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 001743   000000 011000                    NOP     0

  11490 14 001744   000002 236000 8                  LDQ     ILS_+2
        14 001745   000022 736000                    QLS     18
        14 001746   000001 036000 8                  ADLQ    ILS_+1
        14 001747   200016 756100                    STQ     TEMP$,,AUTO

  11491 14 001750   000002 235000 8                  LDA     ILS_+2
        14 001751   000004 035007                    ADLA    4,DL
        14 001752   000002 755000 8                  STA     ILS_+2

  11492 14 001753   000740 220003                    LDX0    480,DU
        14 001754   200016 470500                    LDP0    TEMP$,,AUTO
        14 001755   000000 740100                    STX0    0,,PR0

  11493 14 001756   000000 236000 15                 LDQ     0
        14 001757   000002 756100                    STQ     2,,PR0

      447    11497                       %RESERVE_ILL (ITEM=%LINOI, POINTER=TEMP$->ILS.ILL$) ;

  11499 14 001760   000145 235000 xsym               LDA     ILL_STEP+101
        14 001761   000000 755000 0                  STA     ITERATION

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:98   
  11500 14 001762   000002 236000 6                  LDQ     ILL_+2
        14 001763   000000 036000 0                  ADLQ    ITERATION
        14 001764   000003 116000 6                  CMPQ    ILL_+3
        14 001765   001776 604000 14                 TMI     s:11502

  11501 14 001766   000003 236000 15                 LDQ     3
        14 001767   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 001770   200052 631500                    EPPR1   @ITEM_ROP$+1,,AUTO
        14 001771   200053 451500                    STP1    @ITEM_ROP$+2,,AUTO
        14 001772   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 001773   000001 631400 15                 EPPR1   1
        14 001774   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 001775   000000 011000                    NOP     0

  11502 14 001776   000002 236000 6                  LDQ     ILL_+2
        14 001777   000022 736000                    QLS     18
        14 002000   000001 036000 6                  ADLQ    ILL_+1
        14 002001   200016 470500                    LDP0    TEMP$,,AUTO
        14 002002   000003 756100                    STQ     3,,PR0

  11503 14 002003   000002 236000 6                  LDQ     ILL_+2
        14 002004   000000 036000 0                  ADLQ    ITERATION
        14 002005   000002 756000 6                  STQ     ILL_+2

  11504 14 002006   000003 471500                    LDP1    3,,PR0
        14 002007   000373 220003                    LDX0    251,DU
        14 002010   100000 740100                    STX0    0,,PR1

      448    11507    5                  TEMP$->ILS.ILL$->LINOI = LINOI$->ILS.ILL$->LINOI ;

  11507 14 002011   000003 471500                    LDP1    3,,PR0
        14 002012   200036 473500                    LDP3    LINOI$,,AUTO
        14 002013   300003 474500                    LDP4    3,,PR3
        14 002014   000100 100500                    MLR     fill='000'O
        14 002015   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12
        14 002016   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:99   
      449    11508    5                  TEMP$->ILS.ILL$->LINOI.LINE_NO = LINOI$->ILS.ILL$->LINOI.PREV_LINE ;

  11508 14 002017   000003 471500                    LDP1    3,,PR0
        14 002020   300003 474500                    LDP4    3,,PR3
        14 002021   400000 721100                    LXL1    0,,PR4
        14 002022   100001 441100                    SXL1    1,,PR1

      450    11509    5                 TEMP$->ILS.ILL$->LINOI.COLUMN_NO = LINOI$->ILS.ILL$->LINOI.PREV_COL ;

  11509 14 002023   000003 471500                    LDP1    3,,PR0
        14 002024   300003 474500                    LDP4    3,,PR3
        14 002025   400002 721100                    LXL1    2,,PR4
        14 002026   100001 741100                    STX1    1,,PR1

      451    11510    5                  TEMP$->ILS.ILL$->LINOI.TYPE = %NO_STATEMENT_TYPE ;

  11510 14 002027   000003 471500                    LDP1    3,,PR0
        14 002030   000000 221003                    LDX1    0,DU
        14 002031   100002 741100                    STX1    2,,PR1

      452    11511                       %RESERVE_ILS (ITEM=%OPN, POINTER=TEMP$->ILS.NEXT) ;

  11531 14 002032   000002 236000 8                  LDQ     ILS_+2
        14 002033   000004 036007                    ADLQ    4,DL
        14 002034   000003 116000 8                  CMPQ    ILS_+3
        14 002035   002046 602000 14                 TNC     s:11533

  11532 14 002036   000002 236000 15                 LDQ     2
        14 002037   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 002040   200052 631500                    EPPR1   @ITEM_ROP$+1,,AUTO
        14 002041   200053 451500                    STP1    @ITEM_ROP$+2,,AUTO
        14 002042   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 002043   000001 631400 15                 EPPR1   1
        14 002044   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 002045   000000 011000                    NOP     0

  11533 14 002046   000002 236000 8                  LDQ     ILS_+2
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:100  
        14 002047   000022 736000                    QLS     18
        14 002050   000001 036000 8                  ADLQ    ILS_+1
        14 002051   200016 470500                    LDP0    TEMP$,,AUTO
        14 002052   000002 756100                    STQ     2,,PR0

  11534 14 002053   000002 235000 8                  LDA     ILS_+2
        14 002054   000004 035007                    ADLA    4,DL
        14 002055   000002 755000 8                  STA     ILS_+2

  11535 14 002056   000002 471500                    LDP1    2,,PR0
        14 002057   000740 220003                    LDX0    480,DU
        14 002060   100000 740100                    STX0    0,,PR1

  11536 14 002061   000002 471500                    LDP1    2,,PR0
        14 002062   000000 236000 15                 LDQ     0
        14 002063   100002 756100                    STQ     2,,PR1

      453    11540    5                  TEMP$->ILS.NEXT->ILS.ILL$ = ALTER$ ;

  11540 14 002064   000002 471500                    LDP1    2,,PR0
        14 002065   200015 236100                    LDQ     ALTER$,,AUTO
        14 002066   100003 756100                    STQ     3,,PR1

      454    11541    5                  TEMP$->ILS.NEXT->ILS.NEXT = ENTRY$->ILS.NEXT ;

  11541 14 002067   000002 471500                    LDP1    2,,PR0
        14 002070   200014 473500                    LDP3    ENTRY$,,AUTO
        14 002071   300002 236100                    LDQ     2,,PR3
        14 002072   100002 756100                    STQ     2,,PR1

      455    11542    5                  ENTRY$->ILS.NEXT = TEMP$ ;

  11542 14 002073   200016 236100                    LDQ     TEMP$,,AUTO
        14 002074   300002 756100                    STQ     2,,PR3

      456    11543    5                END ;

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:101  
      457    11544    4                ENTRY$ = ENTRY$->ILS.ILL$->ENTRY_ILL.PREV_ENTRY_ILS$ ;

  11544 14 002075   200014 470500                    LDP0    ENTRY$,,AUTO
        14 002076   000003 471500                    LDP1    3,,PR0
        14 002077   100003 236100                    LDQ     3,,PR1
        14 002100   200014 756100                    STQ     ENTRY$,,AUTO

      458    11545    4              END ;

  11545 14 002101   000000 116000 15                 CMPQ    0
        14 002102   001651 601000 14                 TNZ     s:11444

      459    11546    3            END ;

      460    11547
      461    11548    2          PFORM_ILS$->ILS.NEXT = ILS$ ;

  11548 14 002103   000000 236000 7                  LDQ     ILS$
        14 002104   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 002105   000002 756100                    STQ     2,,PR0

      462    11549
      463    11550    2          TEMP$ = PFORM_ILS$;

  11550 14 002106   200010 236100                    LDQ     PFORM_ILS$,,AUTO
        14 002107   200016 756100                    STQ     TEMP$,,AUTO

      464    11551
      465    11552               %NEXT_NON_SUPPORT (POINTER = TEMP$);

  11562 14 002110   200016 470500                    LDP0    TEMP$,,AUTO
        14 002111   000002 236100                    LDQ     2,,PR0
        14 002112   200016 756100                    STQ     TEMP$,,AUTO

  11565 14 002113   200016 470500                    LDP0    TEMP$,,AUTO
        14 002114   000003 236100                    LDQ     3,,PR0
        14 002115   000000 116000 15                 CMPQ    0
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:102  
        14 002116   002110 600000 14                 TZE     s:11562
        14 002117   000003 471500                    LDP1    3,,PR0
        14 002120   100000 220100                    LDX0    0,,PR1
        14 002121   000343 100003                    CMPX0   227,DU
        14 002122   002110 600000 14                 TZE     s:11562
        14 002123   000422 100003                    CMPX0   274,DU
        14 002124   002110 600000 14                 TZE     s:11562
        14 002125   000446 100003                    CMPX0   294,DU
        14 002126   002110 600000 14                 TZE     s:11562
        14 002127   000336 100003                    CMPX0   222,DU
        14 002130   002110 600000 14                 TZE     s:11562
        14 002131   000420 100003                    CMPX0   272,DU
        14 002132   002110 600000 14                 TZE     s:11562
        14 002133   000373 100003                    CMPX0   251,DU
        14 002134   002110 600000 14                 TZE     s:11562

      466    11567
      467    11568    2          IF TEMP$ -> ILS.ILL$ -> ILL.ID = %DEFLB THEN

  11568 14 002135   000346 100003                    CMPX0   230,DU
        14 002136   002142 601000 14                 TNZ     s:11572

      468    11569    2            TEMP$ -> ILS.ILL$ -> ILL.LOP -> LABEL.PREV_ILS$ = PFORM_ILS$;

  11569 14 002137   100001 473500                    LDP3    1,,PR1
        14 002140   200010 236100                    LDQ     PFORM_ILS$,,AUTO
        14 002141   300010 756100                    STQ     8,,PR3

      469    11570
      470    11571
      471    11572    2   END SET_UP_COBOL_74_PFORM ;

  11572 14 002142   200034 221300                    LDX1  ! PERFORM_CHANGE+2,,AUTO
        14 002143   000001 702211                    TSX2  ! 1,X1

      472    11573        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:103  
      473    11574    1   SET_UP_OPTIMIZED_PFORM: PROC ;

  11574 14 002144   200034 741300       SET_UP_OPTI* STX1  ! PERFORM_CHANGE+2,,AUTO

      474    11575
      475    11576        /*I*
      476    11577               NAME:  SET_UP_OPTIMIZED_PFORM
      477    11578               CALL:  CALL SET_UP_OPTIMIZED_PFORM ;
      478    11579          INTERFACE:  Z8AT$CREATE_TEMPORARY is called to create a safestore
      479    11580                      location for the return address.
      480    11581                      Z8AF$NEW_BASE is called to enter a BASE item into the ETT
      481    11582                      for the temp.
      482    11583
      483    11584              INPUT:  PFORM_ILS$        -- Pointer to the PFORM item's ILS entry.
      484    11585                      START_LABEL$      -- Pointer to the PFORM's starting label.
      485    11586                      END_LABEL$        -- Pointer to the PFORM's ending label.
      486    11587
      487    11588        DESCRIPTION:  The outer procedure has determined that this PERFORM can be
      488    11589                      optimized. This procedure sets up all the items needed for this
      489    11590                      type of PERFORM.
      490    11591        */
      491    11592        %EJECT;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:104  
      492    11593        /*V*
      493    11594            SET_UP_OPTIMIZED_PFORM -- The PFORM item is unlinked from the ILS as it
      494    11595                                      is no longer used. A GO_SUB item is
      495    11596                                      inserted in its place. If it has not already
      496    11597                                      been done then:
      497    11598                                      A temp location is reserved for safestoring
      498    11599                                      the return address in case it is necessary.
      499    11600                                      A SUB_ENTRY item is inserted after the
      500    11601                                      start label. A SUB_END item is inserted
      501    11602                                      before the end label.
      502    11603        */
      503    11604
      504    11605    2   DCL GO_ILL$ PTR ;
      505    11606
      506    11607
      507    11608               %VIRTUAL_SEGMENT_CHECK;

      508    11613
      509    11614    2          CALL SEGMENT_CHECK (SEGMENT_LTS$,

  11614 14 002145   000022 236000 15                 LDQ     18
        14 002146   200042 756100                    STQ     SEG_LTS$+1,,AUTO
        14 002147   200022 630500                    EPPR0   SEGMENT_LTS$,,AUTO
        14 002150   200041 450500                    STP0    DO_ILS$+2,,AUTO
        14 002151   003047 701000 14                 TSX1    SEGMENT_CHECK
        14 002152   000000 011000                    NOP     0

      510    11615    2                  COMCOM.SEG_LIMIT);
      511    11616
      512    11617    2          IF REFRESH_SEGMENT THEN

  11617 14 002153   200021 234100                    SZN     REFRESH_SEGMENT,,AUTO
        14 002154   002162 605000 14                 TPL     s:11643

      513    11618    3            DO;

      514    11619    3              PFORM_ILL$ -> ILL.CODE = 0;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:105  

  11619 14 002155   000000 220003                    LDX0    0,DU
        14 002156   200003 470500                    LDP0    PFORM_ILL$,,AUTO
        14 002157   000000 440100                    SXL0    0,,PR0

      515    11620    3              RETURN;

  11620 14 002160   200034 221300                    LDX1  ! PERFORM_CHANGE+2,,AUTO
        14 002161   000001 702211                    TSX2  ! 1,X1

      516    11621    3            END;
      517    11622
      518    11623               %RESERVE_ILS(ITEM=%OPA, POINTER=PFORM_ILS$->ILS.NEXT) ;

  11643 14 002162   000002 236000 8                  LDQ     ILS_+2
        14 002163   000005 036007                    ADLQ    5,DL
        14 002164   000003 116000 8                  CMPQ    ILS_+3
        14 002165   002176 602000 14                 TNC     s:11645

  11644 14 002166   000002 236000 15                 LDQ     2
        14 002167   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 002170   200052 630500                    EPPR0   @ITEM_ROP$+1,,AUTO
        14 002171   200053 450500                    STP0    @ITEM_ROP$+2,,AUTO
        14 002172   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 002173   000001 631400 15                 EPPR1   1
        14 002174   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 002175   000000 011000                    NOP     0

  11645 14 002176   000002 236000 8                  LDQ     ILS_+2
        14 002177   000022 736000                    QLS     18
        14 002200   000001 036000 8                  ADLQ    ILS_+1
        14 002201   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 002202   000002 756100                    STQ     2,,PR0

  11646 14 002203   000002 235000 8                  LDA     ILS_+2
        14 002204   000005 035007                    ADLA    5,DL
        14 002205   000002 755000 8                  STA     ILS_+2
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:106  

  11647 14 002206   000002 471500                    LDP1    2,,PR0
        14 002207   000742 220003                    LDX0    482,DU
        14 002210   100000 740100                    STX0    0,,PR1

  11648 14 002211   000002 471500                    LDP1    2,,PR0
        14 002212   000000 236000 15                 LDQ     0
        14 002213   100002 756100                    STQ     2,,PR1

      519    11652               %NEXT_ILS (POINTER=PFORM_ILS$) ;

  11654 14 002214   000002 236100                    LDQ     2,,PR0
        14 002215   200010 756100                    STQ     PFORM_ILS$,,AUTO

      520    11657    2          PFORM_ILS$->ILS.DEF = ADDR(NIL) ;

  11657 14 002216   000000 236000 15                 LDQ     0
        14 002217   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 002220   000004 756100                    STQ     4,,PR0

      521    11658    2          PFORM_ILS$->ILS.B.CDEF = TRUE ;

  11658 14 002221   400000 236003                    LDQ     -131072,DU
        14 002222   000001 256100                    ORSQ    1,,PR0

      522    11659               %RESERVE_ILL(ITEM=%GO_SUB, POINTER=PFORM_ILS$->ILS.ILL$) ;

  11661 14 002223   000130 235000 xsym               LDA     ILL_STEP+88
        14 002224   000000 755000 0                  STA     ITERATION

  11662 14 002225   000002 236000 6                  LDQ     ILL_+2
        14 002226   000000 036000 0                  ADLQ    ITERATION
        14 002227   000003 116000 6                  CMPQ    ILL_+3
        14 002230   002241 604000 14                 TMI     s:11664

  11663 14 002231   000003 236000 15                 LDQ     3
        14 002232   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:107  
        14 002233   200052 631500                    EPPR1   @ITEM_ROP$+1,,AUTO
        14 002234   200053 451500                    STP1    @ITEM_ROP$+2,,AUTO
        14 002235   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 002236   000001 631400 15                 EPPR1   1
        14 002237   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 002240   000000 011000                    NOP     0

  11664 14 002241   000002 236000 6                  LDQ     ILL_+2
        14 002242   000022 736000                    QLS     18
        14 002243   000001 036000 6                  ADLQ    ILL_+1
        14 002244   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 002245   000003 756100                    STQ     3,,PR0

  11665 14 002246   000002 236000 6                  LDQ     ILL_+2
        14 002247   000000 036000 0                  ADLQ    ITERATION
        14 002250   000002 756000 6                  STQ     ILL_+2

  11666 14 002251   000003 471500                    LDP1    3,,PR0
        14 002252   000356 220003                    LDX0    238,DU
        14 002253   100000 740100                    STX0    0,,PR1

      523    11669              /* PFORM_ILS$->ILS.ILL$->ILL.LOP will be set later. */
      524    11670    2          GO_ILL$ = PFORM_ILS$->ILS.ILL$ ;

  11670 14 002254   000003 236100                    LDQ     3,,PR0
        14 002255   200035 756100                    STQ     GO_ILL$,,AUTO

      525    11671    2          PFORM_ILS$->ILS.NEXT = ILS$ ;

  11671 14 002256   000000 236000 7                  LDQ     ILS$
        14 002257   000002 756100                    STQ     2,,PR0

      526    11672    2          IF DEFLB_FOLLOWS

  11672 14 002260   200011 234100                    SZN     DEFLB_FOLLOWS,,AUTO
        14 002261   002265 605000 14                 TPL     s:11674

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:108  
      527    11673    2            THEN LABEL_AFTER_PFORM$->LABEL.PREV_ILS$ = PFORM_ILS$ ;

  11673 14 002262   200010 236100                    LDQ     PFORM_ILS$,,AUTO
        14 002263   200012 471500                    LDP1    LABEL_AFTER_PFORM$,,AUTO
        14 002264   100010 756100                    STQ     8,,PR1

      528    11674    2          PFORM_ILS$ = START_LABEL$->LABEL.PREV_ILS$ ;

  11674 14 002265   200004 471500                    LDP1    START_LABEL$,,AUTO
        14 002266   100010 236100                    LDQ     8,,PR1
        14 002267   200010 756100                    STQ     PFORM_ILS$,,AUTO

      529    11675    2          ILS$ = PFORM_ILS$ ;

  11675 14 002270   000000 756000 7                  STQ     ILS$

      530    11676               %NEXT_ILS ;

  11678 14 002271   000000 470400 7                  LDP0    ILS$
        14 002272   000002 236100                    LDQ     2,,PR0
        14 002273   000000 756000 7                  STQ     ILS$

      531    11681    2          TEMP$ = ILS$ ;

  11681 14 002274   200016 756100                    STQ     TEMP$,,AUTO

      532    11682               %NEXT_NON_SUPPORT (POINTER=TEMP$) ;

  11692 14 002275   200016 470500                    LDP0    TEMP$,,AUTO
        14 002276   000002 236100                    LDQ     2,,PR0
        14 002277   200016 756100                    STQ     TEMP$,,AUTO

  11695 14 002300   200016 470500                    LDP0    TEMP$,,AUTO
        14 002301   000003 236100                    LDQ     3,,PR0
        14 002302   000000 116000 15                 CMPQ    0
        14 002303   002275 600000 14                 TZE     s:11692
        14 002304   000003 471500                    LDP1    3,,PR0
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:109  
        14 002305   100000 220100                    LDX0    0,,PR1
        14 002306   000343 100003                    CMPX0   227,DU
        14 002307   002275 600000 14                 TZE     s:11692
        14 002310   000422 100003                    CMPX0   274,DU
        14 002311   002275 600000 14                 TZE     s:11692
        14 002312   000446 100003                    CMPX0   294,DU
        14 002313   002275 600000 14                 TZE     s:11692
        14 002314   000336 100003                    CMPX0   222,DU
        14 002315   002275 600000 14                 TZE     s:11692
        14 002316   000420 100003                    CMPX0   272,DU
        14 002317   002275 600000 14                 TZE     s:11692
        14 002320   000373 100003                    CMPX0   251,DU
        14 002321   002275 600000 14                 TZE     s:11692

      533    11697        /*V*
      534    11698            GENERATE_SUB_ENTRY -- Perhaps a PERFORM to this paragraph has already
      535    11699                                  been compiled. If so, the SUB_ENTRY and SUB_END
      536    11700                                  items already exist and TEMP$ points to the
      537    11701                                  SUB_ENTRY. Else generate the SUB_ENTRY
      538    11702                                  and SUB_END now; if START_LABEL$->LABEL.B.FALL_THRU
      539    11703                                  then also generate a SUB_PREP.
      540    11704        */
      541    11705    2          IF ILS$->ILS.ILL$->ILL.ID ~= %SUB_ENTRY

  11705 14 002322   000000 473400 7                  LDP3    ILS$
        14 002323   300003 474500                    LDP4    3,,PR3
        14 002324   400000 221100                    LDX1    0,,PR4
        14 002325   000357 101003                    CMPX1   239,DU
        14 002326   003021 600000 14                 TZE     s:11910

      542    11706    3            THEN DO ;

      543    11707
      544    11708    3              IF START_LABEL$->LABEL.B.PFORM_NESTED

  11708 14 002327   200004 475500                    LDP5    START_LABEL$,,AUTO
        14 002330   500003 236100                    LDQ     3,,PR5
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:110  
        14 002331   000100 316003                    CANQ    64,DU
        14 002332   002376 600000 14                 TZE     s:11729

      545    11709    4                THEN DO ; /* Generate temp only if Phase 4 will need it. */

      546    11710    4                  CALL Z8AT$CREATE_TEMPORARY(%SCALAR, END_TEMP$) ;

  11710 14 002333   200007 636500                    EPPR6   END_TEMP$,,AUTO
        14 002334   200053 456500                    STP6    @ITEM_ROP$+2,,AUTO
        14 002335   000024 236000 15                 LDQ     20
        14 002336   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 002337   200052 630500                    EPPR0   @ITEM_ROP$+1,,AUTO
        14 002340   000004 631400 15                 EPPR1   4
        14 002341   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        14 002342   000000 011000                    NOP     0

      547    11711                       %INCREMENT_STORAGE_CNT(@ITEM$=END_TEMP$) ;

  11713 14 002343   000145 470400 xsym               LDP0    COMCOM+101
        14 002344   000002 220100                    LDX0    2,,PR0
        14 002345   200007 471500                    LDP1    END_TEMP$,,AUTO
        14 002346   100001 740100                    STX0    1,,PR1

  11714 14 002347   000145 470400 xsym               LDP0    COMCOM+101
        14 002350   000002 220100                    LDX0    2,,PR0
        14 002351   000001 621010                    EAX1    1,X0
        14 002352   000002 741100                    STX1    2,,PR0

      548    11721
      549    11722    4                  END_TEMP$->VARIABLE.TYPE = %TYI ;

  11722 14 002353   000001 220003                    LDX0    1,DU
        14 002354   200007 470500                    LDP0    END_TEMP$,,AUTO
        14 002355   000002 740100                    STX0    2,,PR0

      550    11723    4                  END_TEMP$->VARIABLE.NDSC.N = %COMP6_LENGTH ;

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:111  
  11723 14 002356   200007 470500                    LDP0    END_TEMP$,,AUTO
        14 002357   000004 236007                    LDQ     4,DL
        14 002360   000001 752101                    STCQ    1,'01'O,PR0

      551    11724
      552    11725    4                  CALL Z8AF$NEW_BASE (END_TEMP$,

  11725 14 002361   000000 236000 15                 LDQ     0
        14 002362   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 002363   200007 630500                    EPPR0   END_TEMP$,,AUTO
        14 002364   200055 450500                    STP0    @ITEM_ROP$+4,,AUTO
        14 002365   200052 631500                    EPPR1   @ITEM_ROP$+1,,AUTO
        14 002366   200054 451500                    STP1    @ITEM_ROP$+3,,AUTO
        14 002367   200007 633500                    EPPR3   END_TEMP$,,AUTO
        14 002370   200053 453500                    STP3    @ITEM_ROP$+2,,AUTO
        14 002371   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 002372   000007 631400 15                 EPPR1   7
        14 002373   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        14 002374   000000 011000                    NOP     0

      553    11726    4                                      ADDR(NIL),
      554    11727    4                                      END_TEMP$) ;
      555    11728    4                END ;

  11728 14 002375   002400 710000 14                 TRA     s:11730

      556    11729    3                ELSE END_TEMP$ = ADDR (NIL) ;

  11729 14 002376   000000 236000 15                 LDQ     0
        14 002377   200007 756100                    STQ     END_TEMP$,,AUTO

      557    11730    3              IF START_LABEL$->LABEL.B.FALL_THRU

  11730 14 002400   200004 470500                    LDP0    START_LABEL$,,AUTO
        14 002401   000003 236100                    LDQ     3,,PR0
        14 002402   002000 316003                    CANQ    1024,DU
        14 002403   002421 600000 14                 TZE     s:11735
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:112  

      558    11731    4                THEN DO;

      559    11732    4                  END_LABEL$->LABEL.B.GOTO_LABEL = TRUE ;

  11732 14 002404   200005 471500                    LDP1    END_LABEL$,,AUTO
        14 002405   040000 236003                    LDQ     16384,DU
        14 002406   100003 256100                    ORSQ    3,,PR1

      560    11733    4                  CALL CREATE_ITEM_ILS (%SUB_PREP, END_LABEL$, ADDR(NIL)) ;

  11733 14 002407   000000 236000 15                 LDQ     0
        14 002410   200061 756100                    STQ     @ITEM_ROP$+8,,AUTO
        14 002411   200061 630500                    EPPR0   @ITEM_ROP$+8,,AUTO
        14 002412   200051 450500                    STP0    @ITEM_ROP$,,AUTO
        14 002413   200005 631500                    EPPR1   END_LABEL$,,AUTO
        14 002414   200050 451500                    STP1    @ITEM_LOP$,,AUTO
        14 002415   000026 236000 15                 LDQ     22
        14 002416   200047 756100                    STQ     @ITEM_TYPE,,AUTO
        14 002417   000136 701000 14                 TSX1    CREATE_ITEM_ILS
        14 002420   000000 011000                    NOP     0

      561    11734    4                END;

      562    11735    3              CALL Z8AT$CREATE_TEMPORARY(%PARA, ALTER_LBL$) ; /*#30708*/

  11735 14 002421   200013 630500                    EPPR0   ALTER_LBL$,,AUTO
        14 002422   200053 450500                    STP0    @ITEM_ROP$+2,,AUTO
        14 002423   000011 236000 15                 LDQ     9
        14 002424   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 002425   200052 630500                    EPPR0   @ITEM_ROP$+1,,AUTO
        14 002426   000004 631400 15                 EPPR1   4
        14 002427   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        14 002430   000000 011000                    NOP     0

      563    11736                   %CREATE_LINOI_AND_DEFLB ;

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:113  
  11740 14 002431   200013 470500                    LDP0    ALTER_LBL$,,AUTO
        14 002432   400000 236003                    LDQ     -131072,DU
        14 002433   000003 256100                    ORSQ    3,,PR0

  11741 14 002434   200010 236100                    LDQ     PFORM_ILS$,,AUTO
        14 002435   200013 470500                    LDP0    ALTER_LBL$,,AUTO
        14 002436   000010 756100                    STQ     8,,PR0

  11742 14 002437   200020 236100                    LDQ     CURRENT_PROC$,,AUTO
        14 002440   200013 470500                    LDP0    ALTER_LBL$,,AUTO
        14 002441   000011 756100                    STQ     9,,PR0

  11763 14 002442   000002 236000 8                  LDQ     ILS_+2
        14 002443   000004 036007                    ADLQ    4,DL
        14 002444   000003 116000 8                  CMPQ    ILS_+3
        14 002445   002456 602000 14                 TNC     s:11765

  11764 14 002446   000002 236000 15                 LDQ     2
        14 002447   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 002450   200052 630500                    EPPR0   @ITEM_ROP$+1,,AUTO
        14 002451   200053 450500                    STP0    @ITEM_ROP$+2,,AUTO
        14 002452   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 002453   000001 631400 15                 EPPR1   1
        14 002454   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 002455   000000 011000                    NOP     0

  11765 14 002456   000002 236000 8                  LDQ     ILS_+2
        14 002457   000022 736000                    QLS     18
        14 002460   000001 036000 8                  ADLQ    ILS_+1
        14 002461   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 002462   000002 756100                    STQ     2,,PR0

  11766 14 002463   000002 235000 8                  LDA     ILS_+2
        14 002464   000004 035007                    ADLA    4,DL
        14 002465   000002 755000 8                  STA     ILS_+2

  11767 14 002466   000002 471500                    LDP1    2,,PR0
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:114  
        14 002467   000740 220003                    LDX0    480,DU
        14 002470   100000 740100                    STX0    0,,PR1

  11768 14 002471   000002 471500                    LDP1    2,,PR0
        14 002472   000000 236000 15                 LDQ     0
        14 002473   100002 756100                    STQ     2,,PR1

  11774 14 002474   000002 236100                    LDQ     2,,PR0
        14 002475   200010 756100                    STQ     PFORM_ILS$,,AUTO

  11779 14 002476   000145 235000 xsym               LDA     ILL_STEP+101
        14 002477   000000 755000 0                  STA     ITERATION

  11780 14 002500   000002 236000 6                  LDQ     ILL_+2
        14 002501   000000 036000 0                  ADLQ    ITERATION
        14 002502   000003 116000 6                  CMPQ    ILL_+3
        14 002503   002514 604000 14                 TMI     s:11782

  11781 14 002504   000003 236000 15                 LDQ     3
        14 002505   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 002506   200052 630500                    EPPR0   @ITEM_ROP$+1,,AUTO
        14 002507   200053 450500                    STP0    @ITEM_ROP$+2,,AUTO
        14 002510   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 002511   000001 631400 15                 EPPR1   1
        14 002512   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 002513   000000 011000                    NOP     0

  11782 14 002514   000002 236000 6                  LDQ     ILL_+2
        14 002515   000022 736000                    QLS     18
        14 002516   000001 036000 6                  ADLQ    ILL_+1
        14 002517   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 002520   000003 756100                    STQ     3,,PR0

  11783 14 002521   000002 236000 6                  LDQ     ILL_+2
        14 002522   000000 036000 0                  ADLQ    ITERATION
        14 002523   000002 756000 6                  STQ     ILL_+2

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:115  
  11784 14 002524   000003 471500                    LDP1    3,,PR0
        14 002525   000373 220003                    LDX0    251,DU
        14 002526   100000 740100                    STX0    0,,PR1

  11787 14 002527   000003 471500                    LDP1    3,,PR0
        14 002530   000000 473400 7                  LDP3    ILS$
        14 002531   300003 474500                    LDP4    3,,PR3
        14 002532   400000 721100                    LXL1    0,,PR4
        14 002533   100000 441100                    SXL1    0,,PR1

  11788 14 002534   000003 471500                    LDP1    3,,PR0
        14 002535   000000 473400 7                  LDP3    ILS$
        14 002536   300003 474500                    LDP4    3,,PR3
        14 002537   400000 721100                    LXL1    0,,PR4
        14 002540   100001 441100                    SXL1    1,,PR1

  11789 14 002541   000003 471500                    LDP1    3,,PR0
        14 002542   300003 474500                    LDP4    3,,PR3
        14 002543   400002 721100                    LXL1    2,,PR4
        14 002544   100002 441100                    SXL1    2,,PR1

  11790 14 002545   000003 471500                    LDP1    3,,PR0
        14 002546   300003 474500                    LDP4    3,,PR3
        14 002547   400002 721100                    LXL1    2,,PR4
        14 002550   100001 741100                    STX1    1,,PR1

  11811 14 002551   000002 236000 8                  LDQ     ILS_+2
        14 002552   000005 036007                    ADLQ    5,DL
        14 002553   000003 116000 8                  CMPQ    ILS_+3
        14 002554   002565 602000 14                 TNC     s:11813

  11812 14 002555   000002 236000 15                 LDQ     2
        14 002556   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 002557   200052 631500                    EPPR1   @ITEM_ROP$+1,,AUTO
        14 002560   200053 451500                    STP1    @ITEM_ROP$+2,,AUTO
        14 002561   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 002562   000001 631400 15                 EPPR1   1
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:116  
        14 002563   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 002564   000000 011000                    NOP     0

  11813 14 002565   000002 236000 8                  LDQ     ILS_+2
        14 002566   000022 736000                    QLS     18
        14 002567   000001 036000 8                  ADLQ    ILS_+1
        14 002570   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 002571   000002 756100                    STQ     2,,PR0

  11814 14 002572   000002 235000 8                  LDA     ILS_+2
        14 002573   000005 035007                    ADLA    5,DL
        14 002574   000002 755000 8                  STA     ILS_+2

  11815 14 002575   000002 471500                    LDP1    2,,PR0
        14 002576   000742 220003                    LDX0    482,DU
        14 002577   100000 740100                    STX0    0,,PR1

  11816 14 002600   000002 471500                    LDP1    2,,PR0
        14 002601   000000 236000 15                 LDQ     0
        14 002602   100002 756100                    STQ     2,,PR1

  11822 14 002603   000002 236100                    LDQ     2,,PR0
        14 002604   200010 756100                    STQ     PFORM_ILS$,,AUTO

  11825 14 002605   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 002606   400000 236003                    LDQ     -131072,DU
        14 002607   000001 256100                    ORSQ    1,,PR0

  11826 14 002610   000000 236000 15                 LDQ     0
        14 002611   000004 756100                    STQ     4,,PR0

  11829 14 002612   000120 235000 xsym               LDA     ILL_STEP+80
        14 002613   000000 755000 0                  STA     ITERATION

  11830 14 002614   000002 236000 6                  LDQ     ILL_+2
        14 002615   000000 036000 0                  ADLQ    ITERATION
        14 002616   000003 116000 6                  CMPQ    ILL_+3
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:117  
        14 002617   002630 604000 14                 TMI     s:11832

  11831 14 002620   000003 236000 15                 LDQ     3
        14 002621   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 002622   200052 631500                    EPPR1   @ITEM_ROP$+1,,AUTO
        14 002623   200053 451500                    STP1    @ITEM_ROP$+2,,AUTO
        14 002624   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 002625   000001 631400 15                 EPPR1   1
        14 002626   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 002627   000000 011000                    NOP     0

  11832 14 002630   000002 236000 6                  LDQ     ILL_+2
        14 002631   000022 736000                    QLS     18
        14 002632   000001 036000 6                  ADLQ    ILL_+1
        14 002633   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 002634   000003 756100                    STQ     3,,PR0

  11833 14 002635   000002 236000 6                  LDQ     ILL_+2
        14 002636   000000 036000 0                  ADLQ    ITERATION
        14 002637   000002 756000 6                  STQ     ILL_+2

  11834 14 002640   000003 471500                    LDP1    3,,PR0
        14 002641   000346 220003                    LDX0    230,DU
        14 002642   100000 740100                    STX0    0,,PR1

  11837 14 002643   000003 471500                    LDP1    3,,PR0
        14 002644   200013 236100                    LDQ     ALTER_LBL$,,AUTO
        14 002645   100001 756100                    STQ     1,,PR1

  11838 14 002646   000003 471500                    LDP1    3,,PR0
        14 002647   000000 236000 15                 LDQ     0
        14 002650   100002 756100                    STQ     2,,PR1

      564    11841    3              START_LABEL$->LABEL.PREV_ILS$ = PFORM_ILS$ ;

  11841 14 002651   200010 236100                    LDQ     PFORM_ILS$,,AUTO
        14 002652   200004 471500                    LDP1    START_LABEL$,,AUTO
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:118  
        14 002653   100010 756100                    STQ     8,,PR1

      565    11842                   /* LABEL.PREV_ILS$ needs to point here, not to the immediate
      566    11843                      prior ILS item (for SUB_ENTRY) so that if another PERFORM of
      567    11844                      the same paragraph or section occurs and is to be optimized,
      568    11845                      the GO_SUB's LOP can be set to point to this created label.
      569    11846                      After Z8FP nobody will ever need LABEL.PREV_ILS$ again. */
      570    11847    3              GO_ILL$->ILL.LOP = ALTER_LBL$ ;

  11847 14 002654   200013 236100                    LDQ     ALTER_LBL$,,AUTO
        14 002655   200035 473500                    LDP3    GO_ILL$,,AUTO
        14 002656   300001 756100                    STQ     1,,PR3

      571    11848    3              CALL CREATE_ITEM_ILS (%SUB_ENTRY, START_LABEL$, END_TEMP$) ;

  11848 14 002657   200007 631500                    EPPR1   END_TEMP$,,AUTO
        14 002660   200051 451500                    STP1    @ITEM_ROP$,,AUTO
        14 002661   200004 634500                    EPPR4   START_LABEL$,,AUTO
        14 002662   200050 454500                    STP4    @ITEM_LOP$,,AUTO
        14 002663   000030 236000 15                 LDQ     24
        14 002664   200047 756100                    STQ     @ITEM_TYPE,,AUTO
        14 002665   000136 701000 14                 TSX1    CREATE_ITEM_ILS
        14 002666   000000 011000                    NOP     0

      572    11849    3              PFORM_ILS$->ILS.NEXT = ILS$ ;

  11849 14 002667   000000 236000 7                  LDQ     ILS$
        14 002670   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 002671   000002 756100                    STQ     2,,PR0

      573    11850    3              PFORM_ILS$ = END_LABEL$->LABEL.PREV_ILS$ ;

  11850 14 002672   200005 471500                    LDP1    END_LABEL$,,AUTO
        14 002673   100010 236100                    LDQ     8,,PR1
        14 002674   200010 756100                    STQ     PFORM_ILS$,,AUTO

      574    11851    3              ILS$ = PFORM_ILS$ ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:119  

  11851 14 002675   000000 756000 7                  STQ     ILS$

      575    11852                   %NEXT_ILS ;

  11854 14 002676   000000 470400 7                  LDP0    ILS$
        14 002677   000002 236100                    LDQ     2,,PR0
        14 002700   000000 756000 7                  STQ     ILS$

      576    11857                   %RESERVE_ILS (ITEM=%OPN,POINTER="PFORM_ILS$->ILS.NEXT") ;

  11877 14 002701   000002 236000 8                  LDQ     ILS_+2
        14 002702   000004 036007                    ADLQ    4,DL
        14 002703   000003 116000 8                  CMPQ    ILS_+3
        14 002704   002715 602000 14                 TNC     s:11879

  11878 14 002705   000002 236000 15                 LDQ     2
        14 002706   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 002707   200052 630500                    EPPR0   @ITEM_ROP$+1,,AUTO
        14 002710   200053 450500                    STP0    @ITEM_ROP$+2,,AUTO
        14 002711   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 002712   000001 631400 15                 EPPR1   1
        14 002713   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 002714   000000 011000                    NOP     0

  11879 14 002715   000002 236000 8                  LDQ     ILS_+2
        14 002716   000022 736000                    QLS     18
        14 002717   000001 036000 8                  ADLQ    ILS_+1
        14 002720   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 002721   000002 756100                    STQ     2,,PR0

  11880 14 002722   000002 235000 8                  LDA     ILS_+2
        14 002723   000004 035007                    ADLA    4,DL
        14 002724   000002 755000 8                  STA     ILS_+2

  11881 14 002725   000002 471500                    LDP1    2,,PR0
        14 002726   000740 220003                    LDX0    480,DU
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:120  
        14 002727   100000 740100                    STX0    0,,PR1

  11882 14 002730   000002 471500                    LDP1    2,,PR0
        14 002731   000000 236000 15                 LDQ     0
        14 002732   100002 756100                    STQ     2,,PR1

      577    11886                   %NEXT_ILS (POINTER=PFORM_ILS$) ;

  11888 14 002733   000002 236100                    LDQ     2,,PR0
        14 002734   200010 756100                    STQ     PFORM_ILS$,,AUTO

      578    11891                   %RESERVE_ILL (ITEM=%LINOI,POINTER="PFORM_ILS$->ILS.ILL$") ;

  11893 14 002735   000145 235000 xsym               LDA     ILL_STEP+101
        14 002736   000000 755000 0                  STA     ITERATION

  11894 14 002737   000002 236000 6                  LDQ     ILL_+2
        14 002740   000000 036000 0                  ADLQ    ITERATION
        14 002741   000003 116000 6                  CMPQ    ILL_+3
        14 002742   002753 604000 14                 TMI     s:11896

  11895 14 002743   000003 236000 15                 LDQ     3
        14 002744   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 002745   200052 630500                    EPPR0   @ITEM_ROP$+1,,AUTO
        14 002746   200053 450500                    STP0    @ITEM_ROP$+2,,AUTO
        14 002747   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 002750   000001 631400 15                 EPPR1   1
        14 002751   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 002752   000000 011000                    NOP     0

  11896 14 002753   000002 236000 6                  LDQ     ILL_+2
        14 002754   000022 736000                    QLS     18
        14 002755   000001 036000 6                  ADLQ    ILL_+1
        14 002756   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 002757   000003 756100                    STQ     3,,PR0

  11897 14 002760   000002 236000 6                  LDQ     ILL_+2
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:121  
        14 002761   000000 036000 0                  ADLQ    ITERATION
        14 002762   000002 756000 6                  STQ     ILL_+2

  11898 14 002763   000003 471500                    LDP1    3,,PR0
        14 002764   000373 220003                    LDX0    251,DU
        14 002765   100000 740100                    STX0    0,,PR1

      579    11901    3              PFORM_ILS$ -> ILS.ILL$ -> LINOI.PREV_LINE = COMCOM.CURRENT.LINE ;

  11901 14 002766   000003 471500                    LDP1    3,,PR0
        14 002767   000133 721000 xsym               LXL1    COMCOM+91
        14 002770   100000 441100                    SXL1    0,,PR1

      580    11902    3              PFORM_ILS$ -> ILS.ILL$ -> LINOI.LINE_NO = COMCOM.CURRENT.LINE ;

  11902 14 002771   000003 471500                    LDP1    3,,PR0
        14 002772   000133 721000 xsym               LXL1    COMCOM+91
        14 002773   100001 441100                    SXL1    1,,PR1

      581    11903    3              PFORM_ILS$ -> ILS.ILL$ -> LINOI.PREV_COL = COMCOM.CURRENT.COLUMN ;

  11903 14 002774   000003 471500                    LDP1    3,,PR0
        14 002775   000134 721000 xsym               LXL1    COMCOM+92
        14 002776   100002 441100                    SXL1    2,,PR1

      582    11904    3              PFORM_ILS$ -> ILS.ILL$ -> LINOI.COLUMN_NO = COMCOM.CURRENT.COLUMN ;

  11904 14 002777   000003 471500                    LDP1    3,,PR0
        14 003000   000134 721000 xsym               LXL1    COMCOM+92
        14 003001   100001 741100                    STX1    1,,PR1

      583    11905    3              CALL CREATE_ITEM_ILS (%SUB_END, START_LABEL$, END_TEMP$) ;

  11905 14 003002   200007 631500                    EPPR1   END_TEMP$,,AUTO
        14 003003   200051 451500                    STP1    @ITEM_ROP$,,AUTO
        14 003004   200004 633500                    EPPR3   START_LABEL$,,AUTO
        14 003005   200050 453500                    STP3    @ITEM_LOP$,,AUTO
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:122  
        14 003006   000032 236000 15                 LDQ     26
        14 003007   200047 756100                    STQ     @ITEM_TYPE,,AUTO
        14 003010   000136 701000 14                 TSX1    CREATE_ITEM_ILS
        14 003011   000000 011000                    NOP     0

      584    11906    3              PFORM_ILS$->ILS.NEXT = ILS$ ;

  11906 14 003012   000000 236000 7                  LDQ     ILS$
        14 003013   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 003014   000002 756100                    STQ     2,,PR0

      585    11907    3              END_LABEL$->LABEL.PREV_ILS$ = PFORM_ILS$ ;

  11907 14 003015   200010 236100                    LDQ     PFORM_ILS$,,AUTO
        14 003016   200005 471500                    LDP1    END_LABEL$,,AUTO
        14 003017   100010 756100                    STQ     8,,PR1

      586    11908    3            END ;

  11908 14 003020   003026 710000 14                 TRA     s:11911

      587    11909    2          ELSE
      588    11910    2            GO_ILL$->ILL.LOP = PFORM_ILS$->ILS.ILL$->ILL.LOP ;

  11910 14 003021   200010 475500                    LDP5    PFORM_ILS$,,AUTO
        14 003022   500003 476500                    LDP6    3,,PR5
        14 003023   600001 236100                    LDQ     1,,PR6
        14 003024   200035 477500                    LDP7    GO_ILL$,,AUTO
        14 003025   700001 756100                    STQ     1,,PR7

      589    11911    2          START_LABEL$->LABEL.B.PFORM_START = TRUE ;

  11911 14 003026   200004 470500                    LDP0    START_LABEL$,,AUTO
        14 003027   000400 236003                    LDQ     256,DU
        14 003030   000003 256100                    ORSQ    3,,PR0

      590    11912    2          END_LABEL$->LABEL.B.PFORM_END = TRUE ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:123  

  11912 14 003031   200005 470500                    LDP0    END_LABEL$,,AUTO
        14 003032   000200 236003                    LDQ     128,DU
        14 003033   000003 256100                    ORSQ    3,,PR0

      591    11913    2          START_LABEL$->LABEL.P_END$ = END_LABEL$ ;

  11913 14 003034   200005 236100                    LDQ     END_LABEL$,,AUTO
        14 003035   200004 470500                    LDP0    START_LABEL$,,AUTO
        14 003036   000001 756100                    STQ     1,,PR0

      592    11914    2          END_LABEL$->LABEL.B.PFORM_NESTED = START_LABEL$->LABEL.B.PFORM_NESTED ;

  11914 14 003037   200005 470500                    LDP0    END_LABEL$,,AUTO
        14 003040   200004 471500                    LDP1    START_LABEL$,,AUTO
        14 003041   100003 236100                    LDQ     3,,PR1
        14 003042   000003 676100                    ERQ     3,,PR0
        14 003043   000100 376003                    ANQ     64,DU
        14 003044   000003 656100                    ERSQ    3,,PR0

      593    11915    2   END SET_UP_OPTIMIZED_PFORM ;

  11915 14 003045   200034 221300                    LDX1  ! PERFORM_CHANGE+2,,AUTO
        14 003046   000001 702211                    TSX2  ! 1,X1

      594    11916        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:124  
      595    11917
      596    11918         /*=============*/
      597    11919    1      SEGMENT_CHECK: PROC (SEG_LTS$, SEGMENT_LIMIT);

  11919 14 003047   200040 741300       SEGMENT_CHE* STX1  ! DO_ILS$+1,,AUTO

      598    11920         /*=============*/
      599    11921
      600    11922         /*I*
      601    11923
      602    11924               NAME: SEGMENT_CHECK
      603    11925
      604    11926          DESCRIPTION: This routine checks if the program control will
      605    11927                       flow into a different independent segment and
      606    11928                       set the bit REFRESH_SEGMENT on if it is true.
      607    11929         */
      608    11930
      609    11931
      610    11932    2   DCL PFORM_SEG$     PTR;
      611    11933    2   DCL SEG_LTS$       PTR;
      612    11934    2   DCL SEGMENT_LIMIT  SBIN WORD;
      613    11935
      614    11936
      615    11937    2          REFRESH_SEGMENT = FALSE;

  11937 14 003050   200021 450100                    STZ     REFRESH_SEGMENT,,AUTO

      616    11938    2          SEG_LTS$ = ADDR(NIL);

  11938 14 003051   000000 236000 15                 LDQ     0
        14 003052   200041 470500                    LDP0    @SEG_LTS$,,AUTO
        14 003053   000000 756100                    STQ     0,,PR0

      617    11939
      618    11940    2          IF COMCOM.SEGMENTC <= 1 THEN

  11940 14 003054   000314 235000 xsym               LDA     COMCOM+204
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:125  
        14 003055   000001 115007                    CMPA    1,DL
        14 003056   003061 605400 14                 TPNZ    s:11943

      619    11941    2            RETURN;

  11941 14 003057   200040 221300                    LDX1  ! DO_ILS$+1,,AUTO
        14 003060   000001 702211                    TSX2  ! 1,X1

      620    11942
      621    11943    2          IF START_LABEL$ -> LABEL.ID = %SECTION THEN

  11943 14 003061   200004 471500                    LDP1    START_LABEL$,,AUTO
        14 003062   100000 220100                    LDX0    0,,PR1
        14 003063   000770 100003                    CMPX0   504,DU
        14 003064   003070 601000 14                 TNZ     s:11946

      622    11944    2            SEG_LTS$ = START_LABEL$ -> SECTION.SEGMENT$;

  11944 14 003065   100007 236100                    LDQ     7,,PR1
        14 003066   000000 756100                    STQ     0,,PR0
        14 003067   003076 710000 14                 TRA     s:11949

      623    11945    2          ELSE
      624    11946    2            IF START_LABEL$ -> LABEL.SECTION$ ~= ADDR(NIL) THEN

  11946 14 003070   100007 236100                    LDQ     7,,PR1
        14 003071   000000 116000 15                 CMPQ    0
        14 003072   003076 600000 14                 TZE     s:11949

      625    11947    2              SEG_LTS$ = START_LABEL$ -> LABEL.SECTION$ -> SECTION.SEGMENT$;

  11947 14 003073   100007 473500                    LDP3    7,,PR1
        14 003074   300007 236100                    LDQ     7,,PR3
        14 003075   000000 756100                    STQ     0,,PR0

      626    11948
      627    11949    2          IF SEG_LTS$ ~= ADDR(NIL) AND
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:126  

  11949 14 003076   000000 236100                    LDQ     0,,PR0
        14 003077   000000 116000 15                 CMPQ    0
        14 003100   003127 600000 14                 TZE     s:11964
        14 003101   000000 471500                    LDP1    0,,PR0
        14 003102   200042 473500                    LDP3    @SEGMENT_LIMIT,,AUTO
        14 003103   100002 236100                    LDQ     2,,PR1
        14 003104   300000 116100                    CMPQ    0,,PR3
        14 003105   003127 604000 14                 TMI     s:11964

      628    11950    2             SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO# >= SEGMENT_LIMIT THEN
      629    11951    3            DO;

      630    11952    3              PFORM_SEG$ = ADDR(NIL);

  11952 14 003106   000000 236000 15                 LDQ     0
        14 003107   200043 756100                    STQ     PFORM_SEG$,,AUTO

      631    11953
      632    11954    3              IF PFORM_ILL$ -> PFORM.BRANCH$ -> ILS.ID = %SECTION THEN

  11954 14 003110   200003 474500                    LDP4    PFORM_ILL$,,AUTO
        14 003111   400003 475500                    LDP5    3,,PR4
        14 003112   500000 220100                    LDX0    0,,PR5
        14 003113   000770 100003                    CMPX0   504,DU
        14 003114   003117 601000 14                 TNZ     s:11957

      633    11955    3                PFORM_SEG$ = PFORM_ILL$ -> PFORM.BRANCH$ -> SECTION.SEGMENT$;

  11955 14 003115   500007 236100                    LDQ     7,,PR5
        14 003116   200043 756100                    STQ     PFORM_SEG$,,AUTO

      634    11956
      635    11957    3              IF PFORM_SEG$ ~= ADDR(NIL) AND

  11957 14 003117   000000 116000 15                 CMPQ    0
        14 003120   003127 600000 14                 TZE     s:11964
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:127  
        14 003121   200043 476500                    LDP6    PFORM_SEG$,,AUTO
        14 003122   600002 236100                    LDQ     2,,PR6
        14 003123   100002 116100                    CMPQ    2,,PR1
        14 003124   003127 600000 14                 TZE     s:11964

      636    11958    3                 PFORM_SEG$ -> SEGMENT_LTS.SEGMENT_NO# ~=
      637    11959    3                 SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO# THEN
      638    11960    3                REFRESH_SEGMENT = TRUE;

  11960 14 003125   400000 236003                    LDQ     -131072,DU
        14 003126   200021 756100                    STQ     REFRESH_SEGMENT,,AUTO

      639    11961
      640    11962    3            END;

      641    11963
      642    11964    2    END SEGMENT_CHECK;

  11964 14 003127   200040 221300                    LDX1  ! DO_ILS$+1,,AUTO
        14 003130   000001 702211                    TSX2  ! 1,X1

      643    11965         %EJECT;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:128  
      644    11966
      645    11967         /*=============*/
      646    11968    1      RESET_OVERLAY: PROC (SEG_LTS$);

  11968 14 003131   200040 741300       RESET_OVERL* STX1  ! DO_ILS$+1,,AUTO

      647    11969         /*=============*/
      648    11970
      649    11971         /*I*
      650    11972
      651    11973               NAME: RESET_OVERLAY
      652    11974
      653    11975          DESCRIPTION: This routine generates the subroutine call to call
      654    11976                       the subroutine that wiill refresh the alter switches
      655    11977                       in the independent segment indicated by SEG_LTS$.
      656    11978         */
      657    11979
      658    11980
      659    11981    2   DCL SEG_LTS$       PTR;
      660    11982    2   DCL SEG_NO#        SBIN WORD;
      661    11983    2   DCL ARRAY$         PTR;
      662    11984    2   DCL CALL_LABEL$    PTR;
      663    11985
      664    11986
      665    11987
      666    11988    2          SEG_NO# = SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO#;

  11988 14 003132   200041 470500                    LDP0    @SEG_LTS$,,AUTO
        14 003133   000000 471500                    LDP1    0,,PR0
        14 003134   100002 235100                    LDA     2,,PR1
        14 003135   200042 755100                    STA     SEG_NO#,,AUTO

      667    11989    2          ARRAY$ = CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.SEG_ARRAY$;

  11989 14 003136   200020 473500                    LDP3    CURRENT_PROC$,,AUTO
        14 003137   300001 474500                    LDP4    1,,PR3
        14 003140   400014 236100                    LDQ     12,,PR4
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:129  
        14 003141   200043 756100                    STQ     ARRAY$,,AUTO

      668    11990    2          CALL_LABEL$ = ARRAY$ -> LTS_PTR_ARRAY.P$(SEG_NO#) -> SEGMENT_LTS.SUB_LABEL$;

  11990 14 003142   200043 475500                    LDP5    ARRAY$,,AUTO
        14 003143   500002 476505                    LDP6    2,AL,PR5
        14 003144   600007 236100                    LDQ     7,,PR6
        14 003145   200044 756100                    STQ     CALL_LABEL$,,AUTO

      669    11991
      670    11992    2          IF CALL_LABEL$ ~= ADDR(NIL) THEN

  11992 14 003146   000000 116000 15                 CMPQ    0
        14 003147   003166 600000 14                 TZE     s:12004

      671    11993    3            DO;

      672    11994
      673    11995                   %GET_RESET_OVERLAY;

  11997 14 003150   000000 236000 15                 LDQ     0
        14 003151   200062 756100                    STQ     @ITEM_ROP$+9,,AUTO
        14 003152   200062 631500                    EPPR1   @ITEM_ROP$+9,,AUTO
        14 003153   200051 451500                    STP1    @ITEM_ROP$,,AUTO
        14 003154   200044 634500                    EPPR4   CALL_LABEL$,,AUTO
        14 003155   200050 454500                    STP4    @ITEM_LOP$,,AUTO
        14 003156   000013 236000 15                 LDQ     11
        14 003157   200047 756100                    STQ     @ITEM_TYPE,,AUTO
        14 003160   000136 701000 14                 TSX1    CREATE_ITEM_ILS
        14 003161   000000 011000                    NOP     0

  11998 14 003162   200010 470500                    LDP0    PFORM_ILS$,,AUTO
        14 003163   000003 471500                    LDP1    3,,PR0
        14 003164   000030 220003                    LDX0    24,DU
        14 003165   100000 440100                    SXL0    0,,PR1

      674    12001
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:130  
      675    12002    3            END;

      676    12003
      677    12004    2    END RESET_OVERLAY;

  12004 14 003166   200040 221300                    LDX1  ! DO_ILS$+1,,AUTO
        14 003167   000001 702211                    TSX2  ! 1,X1

      678    12005         %EJECT;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:131  
      679    12006
      680    12007         /*================*/
      681    12008    1      GEN_ALTER_CHANGE: PROC (LABEL$$, SEG_NO#, CHANGE_LABEL$);

  12008 14 003170   200040 741300       GEN_ALTER_C* STX1  ! DO_ILS$+1,,AUTO

      682    12009         /*================*/
      683    12010
      684    12011
      685    12012    2   DCL LABEL$$            PTR;
      686    12013    2   DCL SEG_NO#            SBIN WORD;
      687    12014    2   DCL CHANGE_LABEL$      PTR;
      688    12015    2   DCL TRA_END_LABEL$     PTR;
      689    12016    2   DCL PREV_ILS_NEXT$     PTR;
      690    12017    2   DCL ENTRY_LINOI$       PTR;
      691    12018
      692    12019             /* pick up the label on the top of the procedure division,
      693    12020                detail see Z8FJ main program.                          */
      694    12021
      695    12022    2      TRA_END_LABEL$ = CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.SEG_ARRAY$ ->

  12022 14 003171   200020 470500                    LDP0    CURRENT_PROC$,,AUTO
        14 003172   000001 471500                    LDP1    1,,PR0
        14 003173   100014 473500                    LDP3    12,,PR1
        14 003174   300003 474500                    LDP4    3,,PR3
        14 003175   400003 475500                    LDP5    3,,PR4
        14 003176   500001 236100                    LDQ     1,,PR5
        14 003177   200044 756100                    STQ     TRA_END_LABEL$,,AUTO

      696    12023    2                       LTS_PTR_ARRAY.P$ (1) -> ILS.ILL$ -> ILL.LOP;
      697    12024
      698    12025    2      CALL Z8AT$CREATE_TEMPORARY (%PARA, CHANGE_LABEL$);

  12025 14 003200   200043 236100                    LDQ     @CHANGE_LABEL$,,AUTO
        14 003201   000011 235000 15                 LDA     9
        14 003202   200052 757100                    STAQ    @ITEM_ROP$+1,,AUTO
        14 003203   200052 630500                    EPPR0   @ITEM_ROP$+1,,AUTO
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:132  
        14 003204   000004 631400 15                 EPPR1   4
        14 003205   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        14 003206   000000 011000                    NOP     0

      699    12026
      700    12027    2      CHANGE_LABEL$ -> LABEL.B.REFERENCED = TRUE;

  12027 14 003207   200043 470500                    LDP0    @CHANGE_LABEL$,,AUTO
        14 003210   000000 471500                    LDP1    0,,PR0
        14 003211   400000 236003                    LDQ     -131072,DU
        14 003212   100003 256100                    ORSQ    3,,PR1

      701    12028    2      CHANGE_LABEL$ -> LABEL.B.GOTO_LABEL = TRUE;

  12028 14 003213   000000 471500                    LDP1    0,,PR0
        14 003214   040000 236003                    LDQ     16384,DU
        14 003215   100003 256100                    ORSQ    3,,PR1

      702    12029    2      CHANGE_LABEL$ -> LABEL.B.ONE_REF = TRUE;

  12029 14 003216   000000 471500                    LDP1    0,,PR0
        14 003217   010000 236003                    LDQ     4096,DU
        14 003220   100003 256100                    ORSQ    3,,PR1

      703    12030    2      CHANGE_LABEL$ -> LABEL.PROC$        = CURRENT_PROC$;

  12030 14 003221   000000 471500                    LDP1    0,,PR0
        14 003222   200020 236100                    LDQ     CURRENT_PROC$,,AUTO
        14 003223   100011 756100                    STQ     9,,PR1

      704    12031    2      SUB_TAIL$ = TRA_END_LABEL$ -> LABEL.PREV_ILS$;

  12031 14 003224   200044 471500                    LDP1    TRA_END_LABEL$,,AUTO
        14 003225   100010 236100                    LDQ     8,,PR1
        14 003226   200023 756100                    STQ     SUB_TAIL$,,AUTO

      705    12032    2      CHANGE_LABEL$ -> LABEL.PREV_ILS$ = SUB_TAIL$;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:133  

  12032 14 003227   000000 473500                    LDP3    0,,PR0
        14 003230   300010 756100                    STQ     8,,PR3

      706    12033    2      PREV_ILS_NEXT$ = SUB_TAIL$ -> ILS.NEXT;

  12033 14 003231   200023 473500                    LDP3    SUB_TAIL$,,AUTO
        14 003232   300002 236100                    LDQ     2,,PR3
        14 003233   200045 756100                    STQ     PREV_ILS_NEXT$,,AUTO

      707    12034
      708    12035           %FIND_LINE_NO (@START_ITEM$ = SUB_TAIL$);

  12037 14 003234   200023 236100                    LDQ     SUB_TAIL$,,AUTO
        14 003235   000004 756000 13                 STQ     O2COM+4

  12038 14 003236   000004 474400 13                 LDP4    O2COM+4
        14 003237   400003 475500                    LDP5    3,,PR4
        14 003240   500000 220100                    LDX0    0,,PR5
        14 003241   000373 100003                    CMPX0   251,DU
        14 003242   003256 600000 14                 TZE     s:12047

  12042 14 003243   000004 470400 13                 LDP0    O2COM+4
        14 003244   000002 236100                    LDQ     2,,PR0
        14 003245   000004 756000 13                 STQ     O2COM+4

  12045 14 003246   000004 470400 13                 LDP0    O2COM+4
        14 003247   000003 236100                    LDQ     3,,PR0
        14 003250   000000 116000 15                 CMPQ    0
        14 003251   003243 600000 14                 TZE     s:12042

  12046 14 003252   000003 471500                    LDP1    3,,PR0
        14 003253   100000 220100                    LDX0    0,,PR1
        14 003254   000373 100003                    CMPX0   251,DU
        14 003255   003243 601000 14                 TNZ     s:12042

  12047 14 003256   000004 470400 13                 LDP0    O2COM+4
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:134  
        14 003257   000003 471500                    LDP1    3,,PR0
        14 003260   100000 236100                    LDQ     0,,PR1
        14 003261   777777 376007                    ANQ     -1,DL
        14 003262   000133 756000 xsym               STQ     COMCOM+91

  12048 14 003263   000003 471500                    LDP1    3,,PR0
        14 003264   100002 236100                    LDQ     2,,PR1
        14 003265   777777 376007                    ANQ     -1,DL
        14 003266   000134 756000 xsym               STQ     COMCOM+92

      709    12051    2      ENTRY_LINOI$ = O2COM.LINE_NO$ -> ILS.ILL$;

  12051 14 003267   000003 236100                    LDQ     3,,PR0
        14 003270   200046 756100                    STQ     ENTRY_LINOI$,,AUTO

      710    12052
      711    12053           %RSV_ILS_ILL (@ILL_ITEM = %LINOI);

  12076 14 003271   000002 236000 8                  LDQ     ILS_+2
        14 003272   000004 036007                    ADLQ    4,DL
        14 003273   000003 116000 8                  CMPQ    ILS_+3
        14 003274   003305 602000 14                 TNC     s:12078

  12077 14 003275   000002 236000 15                 LDQ     2
        14 003276   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 003277   200052 631500                    EPPR1   @ITEM_ROP$+1,,AUTO
        14 003300   200053 451500                    STP1    @ITEM_ROP$+2,,AUTO
        14 003301   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 003302   000001 631400 15                 EPPR1   1
        14 003303   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 003304   000000 011000                    NOP     0

  12078 14 003305   000002 236000 8                  LDQ     ILS_+2
        14 003306   000022 736000                    QLS     18
        14 003307   000001 036000 8                  ADLQ    ILS_+1
        14 003310   200023 470500                    LDP0    SUB_TAIL$,,AUTO
        14 003311   000002 756100                    STQ     2,,PR0
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:135  

  12079 14 003312   000002 235000 8                  LDA     ILS_+2
        14 003313   000004 035007                    ADLA    4,DL
        14 003314   000002 755000 8                  STA     ILS_+2

  12080 14 003315   000002 471500                    LDP1    2,,PR0
        14 003316   000740 220003                    LDX0    480,DU
        14 003317   100000 740100                    STX0    0,,PR1

  12081 14 003320   000002 471500                    LDP1    2,,PR0
        14 003321   000000 236000 15                 LDQ     0
        14 003322   100002 756100                    STQ     2,,PR1

  12088 14 003323   000145 235000 xsym               LDA     ILL_STEP+101
        14 003324   000000 755000 0                  STA     ITERATION

  12089 14 003325   000002 236000 6                  LDQ     ILL_+2
        14 003326   000000 036000 0                  ADLQ    ITERATION
        14 003327   000003 116000 6                  CMPQ    ILL_+3
        14 003330   003341 604000 14                 TMI     s:12091

  12090 14 003331   000003 236000 15                 LDQ     3
        14 003332   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 003333   200052 631500                    EPPR1   @ITEM_ROP$+1,,AUTO
        14 003334   200053 451500                    STP1    @ITEM_ROP$+2,,AUTO
        14 003335   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 003336   000001 631400 15                 EPPR1   1
        14 003337   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 003340   000000 011000                    NOP     0

  12091 14 003341   200023 470500                    LDP0    SUB_TAIL$,,AUTO
        14 003342   000002 471500                    LDP1    2,,PR0
        14 003343   000002 236000 6                  LDQ     ILL_+2
        14 003344   000022 736000                    QLS     18
        14 003345   000001 036000 6                  ADLQ    ILL_+1
        14 003346   100003 756100                    STQ     3,,PR1

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:136  
  12092 14 003347   000002 236000 6                  LDQ     ILL_+2
        14 003350   000000 036000 0                  ADLQ    ITERATION
        14 003351   000002 756000 6                  STQ     ILL_+2

  12093 14 003352   000002 471500                    LDP1    2,,PR0
        14 003353   100003 473500                    LDP3    3,,PR1
        14 003354   000373 220003                    LDX0    251,DU
        14 003355   300000 740100                    STX0    0,,PR3

  12096 14 003356   000002 236100                    LDQ     2,,PR0
        14 003357   200023 756100                    STQ     SUB_TAIL$,,AUTO

      712    12099
      713    12100    2      SUB_TAIL$ -> ILS.ILL$ -> LINOI = O2COM.LINE_NO$ -> ILS.ILL$ -> LINOI;

  12100 14 003360   200023 470500                    LDP0    SUB_TAIL$,,AUTO
        14 003361   000003 471500                    LDP1    3,,PR0
        14 003362   000004 473400 13                 LDP3    O2COM+4
        14 003363   300003 474500                    LDP4    3,,PR3
        14 003364   000100 100500                    MLR     fill='000'O
        14 003365   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12
        14 003366   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      714    12101           %RSV_ILS_ILL (@ILL_ITEM = %DEFLB);

  12124 14 003367   000002 236000 8                  LDQ     ILS_+2
        14 003370   000004 036007                    ADLQ    4,DL
        14 003371   000003 116000 8                  CMPQ    ILS_+3
        14 003372   003403 602000 14                 TNC     s:12126

  12125 14 003373   000002 236000 15                 LDQ     2
        14 003374   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 003375   200052 631500                    EPPR1   @ITEM_ROP$+1,,AUTO
        14 003376   200053 451500                    STP1    @ITEM_ROP$+2,,AUTO
        14 003377   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 003400   000001 631400 15                 EPPR1   1
        14 003401   000000 701000 xent               TSX1    Z8AR$RESERVER
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:137  
        14 003402   000000 011000                    NOP     0

  12126 14 003403   000002 236000 8                  LDQ     ILS_+2
        14 003404   000022 736000                    QLS     18
        14 003405   000001 036000 8                  ADLQ    ILS_+1
        14 003406   200023 470500                    LDP0    SUB_TAIL$,,AUTO
        14 003407   000002 756100                    STQ     2,,PR0

  12127 14 003410   000002 235000 8                  LDA     ILS_+2
        14 003411   000004 035007                    ADLA    4,DL
        14 003412   000002 755000 8                  STA     ILS_+2

  12128 14 003413   000002 471500                    LDP1    2,,PR0
        14 003414   000740 220003                    LDX0    480,DU
        14 003415   100000 740100                    STX0    0,,PR1

  12129 14 003416   000002 471500                    LDP1    2,,PR0
        14 003417   000000 236000 15                 LDQ     0
        14 003420   100002 756100                    STQ     2,,PR1

  12136 14 003421   000120 235000 xsym               LDA     ILL_STEP+80
        14 003422   000000 755000 0                  STA     ITERATION

  12137 14 003423   000002 236000 6                  LDQ     ILL_+2
        14 003424   000000 036000 0                  ADLQ    ITERATION
        14 003425   000003 116000 6                  CMPQ    ILL_+3
        14 003426   003437 604000 14                 TMI     s:12139

  12138 14 003427   000003 236000 15                 LDQ     3
        14 003430   200052 756100                    STQ     @ITEM_ROP$+1,,AUTO
        14 003431   200052 631500                    EPPR1   @ITEM_ROP$+1,,AUTO
        14 003432   200053 451500                    STP1    @ITEM_ROP$+2,,AUTO
        14 003433   200053 630500                    EPPR0   @ITEM_ROP$+2,,AUTO
        14 003434   000001 631400 15                 EPPR1   1
        14 003435   000000 701000 xent               TSX1    Z8AR$RESERVER
        14 003436   000000 011000                    NOP     0

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:138  
  12139 14 003437   200023 470500                    LDP0    SUB_TAIL$,,AUTO
        14 003440   000002 471500                    LDP1    2,,PR0
        14 003441   000002 236000 6                  LDQ     ILL_+2
        14 003442   000022 736000                    QLS     18
        14 003443   000001 036000 6                  ADLQ    ILL_+1
        14 003444   100003 756100                    STQ     3,,PR1

  12140 14 003445   000002 236000 6                  LDQ     ILL_+2
        14 003446   000000 036000 0                  ADLQ    ITERATION
        14 003447   000002 756000 6                  STQ     ILL_+2

  12141 14 003450   000002 471500                    LDP1    2,,PR0
        14 003451   100003 473500                    LDP3    3,,PR1
        14 003452   000346 220003                    LDX0    230,DU
        14 003453   300000 740100                    STX0    0,,PR3

  12144 14 003454   000002 236100                    LDQ     2,,PR0
        14 003455   200023 756100                    STQ     SUB_TAIL$,,AUTO

      715    12147
      716    12148    2      SUB_TAIL$ -> ILS.ILL$ -> ILL.LOP = CHANGE_LABEL$;

  12148 14 003456   200023 470500                    LDP0    SUB_TAIL$,,AUTO
        14 003457   000003 471500                    LDP1    3,,PR0
        14 003460   200043 473500                    LDP3    @CHANGE_LABEL$,,AUTO
        14 003461   300000 236100                    LDQ     0,,PR3
        14 003462   100001 756100                    STQ     1,,PR1

      717    12149
      718    12150           %OVERLAY_ALTERED_GO (@ARG1 = LABEL$$,
      719    12151                                @ARG2 = SEG_NO#);

  12153 14 003463   200041 471500                    LDP1    @LABEL$$,,AUTO
        14 003464   100000 236100                    LDQ     0,,PR1
        14 003465   000000 116000 15                 CMPQ    0
        14 003466   003472 600000 14                 TZE     s:12161
        14 003467   200042 474500                    LDP4    @SEG_NO#,,AUTO
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:139  
        14 003470   400000 235100                    LDA     0,,PR4
        14 003471   003472 601000 14                 TNZ     s:12161

      720    12160
      721    12161    2      SUB_TAIL$ -> ILS.NEXT = PREV_ILS_NEXT$;

  12161 14 003472   200045 236100                    LDQ     PREV_ILS_NEXT$,,AUTO
        14 003473   000002 756100                    STQ     2,,PR0

      722    12162    2      TRA_END_LABEL$ -> LABEL.PREV_ILS$ = SUB_TAIL$;

  12162 14 003474   200023 236100                    LDQ     SUB_TAIL$,,AUTO
        14 003475   200044 474500                    LDP4    TRA_END_LABEL$,,AUTO
        14 003476   400010 756100                    STQ     8,,PR4

      723    12163
      724    12164    2    END GEN_ALTER_CHANGE;

  12164 14 003477   200040 221300                    LDX1  ! DO_ILS$+1,,AUTO
        14 003500   000001 702211                    TSX2  ! 1,X1

      725    12165         %EJECT;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:140  
      726    12166
      727    12167         /*=====================*/
      728    12168    1      OVERLAY_PERFORM_CHECK: PROC;

  12168 14 003501   200040 741300       OVERLAY_PER* STX1  ! DO_ILS$+1,,AUTO

      729    12169         /*=====================*/
      730    12170
      731    12171
      732    12172    2   DCL SEG_LTS$           PTR;
      733    12173
      734    12174
      735    12175
      736    12176    2      PRE_ALTER_CHANGE = FALSE;

  12176 14 003502   200030 450100                    STZ     PRE_ALTER_CHANGE,,AUTO

      737    12177    2      POST_ALTER_CHANGE = FALSE;

  12177 14 003503   200031 450100                    STZ     POST_ALTER_CHANGE,,AUTO

      738    12178    2      PERFORM_CHANGE = FALSE;

  12178 14 003504   200032 450100                    STZ     PERFORM_CHANGE,,AUTO

      739    12179                /* IF ON CP-6 THEN RETURN */
      740    12180           %CP6_RETURN_CHECK;

  12182 14 003505   200032 234100                    SZN     PERFORM_CHANGE,,AUTO
        14 003506   003510 604000 14                 TMI     s:12189

  12183 14 003507   000001 702211                    TSX2  ! 1,X1

      741    12186
      742    12187           %FIND_LINE_NO (@START_ITEM$ = O2COM.PFORM_LIST$ -> ILS.NEXT);

  12189 14 003510   000001 470400 13                 LDP0    O2COM+1
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:141  
        14 003511   000002 236100                    LDQ     2,,PR0
        14 003512   000004 756000 13                 STQ     O2COM+4

  12190 14 003513   000004 471400 13                 LDP1    O2COM+4
        14 003514   100003 473500                    LDP3    3,,PR1
        14 003515   300000 220100                    LDX0    0,,PR3
        14 003516   000373 100003                    CMPX0   251,DU
        14 003517   003533 600000 14                 TZE     s:12199

  12194 14 003520   000004 470400 13                 LDP0    O2COM+4
        14 003521   000002 236100                    LDQ     2,,PR0
        14 003522   000004 756000 13                 STQ     O2COM+4

  12197 14 003523   000004 470400 13                 LDP0    O2COM+4
        14 003524   000003 236100                    LDQ     3,,PR0
        14 003525   000000 116000 15                 CMPQ    0
        14 003526   003520 600000 14                 TZE     s:12194

  12198 14 003527   000003 471500                    LDP1    3,,PR0
        14 003530   100000 220100                    LDX0    0,,PR1
        14 003531   000373 100003                    CMPX0   251,DU
        14 003532   003520 601000 14                 TNZ     s:12194

  12199 14 003533   000004 470400 13                 LDP0    O2COM+4
        14 003534   000003 471500                    LDP1    3,,PR0
        14 003535   100000 236100                    LDQ     0,,PR1
        14 003536   777777 376007                    ANQ     -1,DL
        14 003537   000133 756000 xsym               STQ     COMCOM+91

  12200 14 003540   000003 471500                    LDP1    3,,PR0
        14 003541   100002 236100                    LDQ     2,,PR1
        14 003542   777777 376007                    ANQ     -1,DL
        14 003543   000134 756000 xsym               STQ     COMCOM+92

      743    12203
      744    12204    2      IF START_LABEL$ -> LABEL.ID = %SECTION THEN

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:142  
  12204 14 003544   200004 471500                    LDP1    START_LABEL$,,AUTO
        14 003545   100000 220100                    LDX0    0,,PR1
        14 003546   000770 100003                    CMPX0   504,DU
        14 003547   003553 601000 14                 TNZ     s:12207

      745    12205    2        SEG_LTS$ = START_LABEL$ -> SECTION.SEGMENT$;

  12205 14 003550   100007 236100                    LDQ     7,,PR1
        14 003551   200041 756100                    STQ     SEG_LTS$,,AUTO
        14 003552   003561 710000 14                 TRA     s:12210

      746    12206    2      ELSE
      747    12207    2        IF START_LABEL$ -> LABEL.SECTION$ ~= ADDR(NIL) THEN

  12207 14 003553   100007 236100                    LDQ     7,,PR1
        14 003554   000000 116000 15                 CMPQ    0
        14 003555   003561 600000 14                 TZE     s:12210

      748    12208    2          SEG_LTS$ = START_LABEL$ -> LABEL.SECTION$ -> SECTION.SEGMENT$;

  12208 14 003556   100007 473500                    LDP3    7,,PR1
        14 003557   300007 236100                    LDQ     7,,PR3
        14 003560   200041 756100                    STQ     SEG_LTS$,,AUTO

      749    12209
      750    12210    2      IF SEG_LTS$ ~= ADDR(NIL) AND

  12210 14 003561   200041 236100                    LDQ     SEG_LTS$,,AUTO
        14 003562   000000 116000 15                 CMPQ    0
        14 003563   003572 600000 14                 TZE     s:12214
        14 003564   200041 473500                    LDP3    SEG_LTS$,,AUTO
        14 003565   300002 236100                    LDQ     2,,PR3
        14 003566   000502 116000 xsym               CMPQ    COMCOM+322
        14 003567   003572 604000 14                 TMI     s:12214

      751    12211    2        SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO# >= COMCOM.SEG_LIMIT THEN
      752    12212    2        TO_SEG_NO# = SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO#;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:143  

  12212 14 003570   200025 756100                    STQ     TO_SEG_NO#,,AUTO
        14 003571   003573 710000 14                 TRA     s:12216

      753    12213    2      ELSE
      754    12214    2        TO_SEG_NO# = %FIXED_SEGMENT;

  12214 14 003572   200025 450100                    STZ     TO_SEG_NO#,,AUTO

      755    12215
      756    12216    2      IF PFORM_ILL$ -> PFORM.BRANCH$ -> ILS.ID = %SECTION THEN

  12216 14 003573   200003 473500                    LDP3    PFORM_ILL$,,AUTO
        14 003574   300003 474500                    LDP4    3,,PR3
        14 003575   400000 220100                    LDX0    0,,PR4
        14 003576   000770 100003                    CMPX0   504,DU
        14 003577   003602 601000 14                 TNZ     s:12219

      757    12217    2        SEG_LTS$ = PFORM_ILL$ -> PFORM.BRANCH$ -> SECTION.SEGMENT$;

  12217 14 003600   400007 236100                    LDQ     7,,PR4
        14 003601   200041 756100                    STQ     SEG_LTS$,,AUTO

      758    12218
      759    12219    2      IF SEG_LTS$ ~= ADDR(NIL) AND

  12219 14 003602   200041 236100                    LDQ     SEG_LTS$,,AUTO
        14 003603   000000 116000 15                 CMPQ    0
        14 003604   003620 600000 14                 TZE     s:12230
        14 003605   200041 475500                    LDP5    SEG_LTS$,,AUTO
        14 003606   500002 236100                    LDQ     2,,PR5
        14 003607   000502 116000 xsym               CMPQ    COMCOM+322
        14 003610   003620 604000 14                 TMI     s:12230

      760    12220    2        SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO# >= COMCOM.SEG_LIMIT THEN
      761    12221    3        DO;

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:144  
      762    12222    3          FROM_SEG_NO# = SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO#;

  12222 14 003611   200026 756100                    STQ     FROM_SEG_NO#,,AUTO

      763    12223    3          IF FROM_SEG_NO# ~= TO_SEG_NO# THEN

  12223 14 003612   200025 116100                    CMPQ    TO_SEG_NO#,,AUTO
        14 003613   003621 600000 14                 TZE     s:12232

      764    12224    4            DO;

      765    12225    4              PRE_ALTER_CHANGE = TRUE;

  12225 14 003614   400000 236003                    LDQ     -131072,DU
        14 003615   200030 756100                    STQ     PRE_ALTER_CHANGE,,AUTO

      766    12226    4              POST_ALTER_CHANGE = TRUE;

  12226 14 003616   200031 756100                    STQ     POST_ALTER_CHANGE,,AUTO

      767    12227    4          END;

      768    12228    3        END;

  12228 14 003617   003621 710000 14                 TRA     s:12232

      769    12229    2      ELSE
      770    12230    2        FROM_SEG_NO# = %FIXED_SEGMENT;

  12230 14 003620   200026 450100                    STZ     FROM_SEG_NO#,,AUTO

      771    12231
      772    12232    2      IF FROM_SEG_NO# ~= TO_SEG_NO# AND

  12232 14 003621   200026 236100                    LDQ     FROM_SEG_NO#,,AUTO
        14 003622   200025 116100                    CMPQ    TO_SEG_NO#,,AUTO
        14 003623   003630 600000 14                 TZE     s:12236
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:145  
        14 003624   200025 235100                    LDA     TO_SEG_NO#,,AUTO
        14 003625   003630 600000 14                 TZE     s:12236

      773    12233    2        TO_SEG_NO# ~= %FIXED_SEGMENT THEN
      774    12234    2        PERFORM_CHANGE = TRUE;

  12234 14 003626   400000 236003                    LDQ     -131072,DU
        14 003627   200032 756100                    STQ     PERFORM_CHANGE,,AUTO

      775    12235
      776    12236    2      IF END_LABEL$ -> LABEL.SECTION$ ~= ADDR(NIL) THEN

  12236 14 003630   200005 474500                    LDP4    END_LABEL$,,AUTO
        14 003631   400007 236100                    LDQ     7,,PR4
        14 003632   000000 116000 15                 CMPQ    0
        14 003633   003641 600000 14                 TZE     s:12240

      777    12237    2        END_SEG_NO# = END_LABEL$ -> LABEL.SECTION$ -> SECTION.SEGMENT$ ->

  12237 14 003634   400007 475500                    LDP5    7,,PR4
        14 003635   500007 476500                    LDP6    7,,PR5
        14 003636   600002 235100                    LDA     2,,PR6
        14 003637   200027 755100                    STA     END_SEG_NO#,,AUTO
        14 003640   003643 710000 14                 TRA     s:12242

      778    12238    2                      SEGMENT_LTS.SEGMENT_NO#;
      779    12239    2      ELSE
      780    12240    2        END_SEG_NO# = TO_SEG_NO#;

  12240 14 003641   200025 235100                    LDA     TO_SEG_NO#,,AUTO
        14 003642   200027 755100                    STA     END_SEG_NO#,,AUTO

      781    12241
      782    12242    2      IF END_SEG_NO# < COMCOM.SEG_LIMIT  THEN

  12242 14 003643   200027 236100                    LDQ     END_SEG_NO#,,AUTO
        14 003644   000502 116000 xsym               CMPQ    COMCOM+322
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:146  
        14 003645   003647 605000 14                 TPL     s:12245

      783    12243    2        POST_ALTER_CHANGE = FALSE;

  12243 14 003646   200031 450100                    STZ     POST_ALTER_CHANGE,,AUTO

      784    12244
      785    12245    2    END OVERLAY_PERFORM_CHECK;

  12245 14 003647   200040 221300                    LDX1  ! DO_ILS$+1,,AUTO
        14 003650   000001 702211                    TSX2  ! 1,X1

      786    12246         %EJECT;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:147  
      787    12247
      788    12248
      789    12249                   /*          MAIN PROGRAM                 */
      790    12250
      791    12251
      792    12252        /*V*
      793    12253            MAIN_PROGRAM_PRESET -- PFORM_LIST_MARKING is called to mark all of the
      794    12254                                   performed labels as either containing nested performs
      795    12255                                   or not.
      796    12256        */
      797    12257
      798    12258    1          CALL PFORM_LIST_MARKING ;

  12258 14 003651   000003 701000 14                 TSX1    PFORM_LIST_MARKING
        14 003652   000000 011000                    NOP     0

      799    12259        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:148  
      800    12260        /*V*
      801    12261            MAIN_PROGRAM_LOOP -- All of the performs are looked at to see how they will
      802    12262                                 be set up.  If any of these conditions exist then a
      803    12263                                 COBOL 74 PFORM is used.
      804    12264
      805    12265                                   1.  The start label is the destination of a GO TO.
      806    12266
      807    12267                                   2.  Either the start label or the end label has a
      808    12268                                       perform nested within.
      809    12269
      810    12270                                   3.  Backward PERFORM, i.e., start label appears
      811    12271                                       after end label in program.
      812    12272
      813    12273                                If none of the above conditions are met then an
      814    12274                                optimized perform is used.  This involves creating a
      815    12275                                temporary scalar entry and marking the appropiate
      816    12276                                bits in the starting and ending labels. The PFORM is
      817    12277                                replaced by a GO_SUB, and SUB_ENTRY and SUB_END items
      818    12278                                and if necessary then a SUB_PREP are created.
      819    12279        */
      820    12280        %EJECT ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:149  
      821    12281    1          O2COM.PFORM_LIST$ = COMCOM.H_PFORM ;

  12281 14 003653   000126 236000 xsym               LDQ     COMCOM+86
        14 003654   000001 756000 13                 STQ     O2COM+1

      822    12282
      823    12283    2          DO UNTIL O2COM.PFORM_LIST$ = ADDR(NIL) ;

      824    12284    2            PFORM_ILL$ = O2COM.PFORM_LIST$->ILS.ILL$ ;

  12284 14 003655   000001 470400 13                 LDP0    O2COM+1
        14 003656   000003 236100                    LDQ     3,,PR0
        14 003657   200003 756100                    STQ     PFORM_ILL$,,AUTO

      825    12285    2            START_LABEL$ = PFORM_ILL$->ILL.LOP ;

  12285 14 003660   200003 471500                    LDP1    PFORM_ILL$,,AUTO
        14 003661   100001 236100                    LDQ     1,,PR1
        14 003662   200004 756100                    STQ     START_LABEL$,,AUTO

      826    12286    2            CURRENT_PROC$ = START_LABEL$->LABEL.PROC$ ;

  12286 14 003663   200004 473500                    LDP3    START_LABEL$,,AUTO
        14 003664   300011 236100                    LDQ     9,,PR3
        14 003665   200020 756100                    STQ     CURRENT_PROC$,,AUTO

      827    12287    2            END_LABEL$ = PFORM_ILL$->ILL.ROP ;

  12287 14 003666   100002 236100                    LDQ     2,,PR1
        14 003667   200005 756100                    STQ     END_LABEL$,,AUTO

      828    12288    2            PFORM_ILS$ = O2COM.PFORM_LIST$ ;

  12288 14 003670   000001 236000 13                 LDQ     O2COM+1
        14 003671   200010 756100                    STQ     PFORM_ILS$,,AUTO

      829    12289    2            ILS$ = PFORM_ILS$ ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:150  

  12289 14 003672   000000 756000 7                  STQ     ILS$

      830    12290                 %NEXT_ILS ;

  12292 14 003673   000000 474400 7                  LDP4    ILS$
        14 003674   400002 236100                    LDQ     2,,PR4
        14 003675   000000 756000 7                  STQ     ILS$

      831    12295    2            DEFLB_FOLLOWS = FALSE ; /* Usual case */

  12295 14 003676   200011 450100                    STZ     DEFLB_FOLLOWS,,AUTO

      832    12296    2            TEMP$ = PFORM_ILS$ ;

  12296 14 003677   200010 236100                    LDQ     PFORM_ILS$,,AUTO
        14 003700   200016 756100                    STQ     TEMP$,,AUTO

      833    12297                 %NEXT_NON_SUPPORT (POINTER=TEMP$) ;

  12307 14 003701   200016 470500                    LDP0    TEMP$,,AUTO
        14 003702   000002 236100                    LDQ     2,,PR0
        14 003703   200016 756100                    STQ     TEMP$,,AUTO

  12310 14 003704   200016 470500                    LDP0    TEMP$,,AUTO
        14 003705   000003 236100                    LDQ     3,,PR0
        14 003706   000000 116000 15                 CMPQ    0
        14 003707   003701 600000 14                 TZE     s:12307
        14 003710   000003 471500                    LDP1    3,,PR0
        14 003711   100000 220100                    LDX0    0,,PR1
        14 003712   000343 100003                    CMPX0   227,DU
        14 003713   003701 600000 14                 TZE     s:12307
        14 003714   000422 100003                    CMPX0   274,DU
        14 003715   003701 600000 14                 TZE     s:12307
        14 003716   000446 100003                    CMPX0   294,DU
        14 003717   003701 600000 14                 TZE     s:12307
        14 003720   000336 100003                    CMPX0   222,DU
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:151  
        14 003721   003701 600000 14                 TZE     s:12307
        14 003722   000420 100003                    CMPX0   272,DU
        14 003723   003701 600000 14                 TZE     s:12307
        14 003724   000373 100003                    CMPX0   251,DU
        14 003725   003701 600000 14                 TZE     s:12307

      834    12312    3            IF TEMP$->ILS.ILL$->ILL.ID = %DEFLB THEN DO;

  12312 14 003726   000346 100003                    CMPX0   230,DU
        14 003727   003734 601000 14                 TNZ     s:12317

      835    12313    3              DEFLB_FOLLOWS = TRUE ; /* Next statement is a label. */

  12313 14 003730   400000 236003                    LDQ     -131072,DU
        14 003731   200011 756100                    STQ     DEFLB_FOLLOWS,,AUTO

      836    12314    3              LABEL_AFTER_PFORM$ = TEMP$->ILS.ILL$->ILL.LOP ;

  12314 14 003732   100001 236100                    LDQ     1,,PR1
        14 003733   200012 756100                    STQ     LABEL_AFTER_PFORM$,,AUTO

      837    12315    3            END;

      838    12316
      839    12317    2            IF START_LABEL$->LABEL.B.GOTO_LABEL OR

  12317 14 003734   200004 473500                    LDP3    START_LABEL$,,AUTO
        14 003735   300003 236100                    LDQ     3,,PR3
        14 003736   040000 316003                    CANQ    16384,DU
        14 003737   003750 601000 14                 TNZ     s:12321
        14 003740   200000 316007                    CANQ    65536,DL
        14 003741   003750 601000 14                 TNZ     s:12321
        14 003742   000001 316003                    CANQ    1,DU
        14 003743   003750 601000 14                 TNZ     s:12321
        14 003744   200005 474500                    LDP4    END_LABEL$,,AUTO
        14 003745   400003 236100                    LDQ     3,,PR4
        14 003746   000001 316003                    CANQ    1,DU
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:152  
        14 003747   003754 600000 14                 TZE     s:12325

      840    12318    2               START_LABEL$->LABEL.B.BACKWARD_PFORM OR
      841    12319    2               START_LABEL$->LABEL.B.INTERIOR_PFORM_LBL OR
      842    12320    2               END_LABEL$->LABEL.B.INTERIOR_PFORM_LBL
      843    12321    2              THEN PFORM_ILL$->ILL.CODE = 0 ;

  12321 14 003750   000000 221003                    LDX1    0,DU
        14 003751   200003 474500                    LDP4    PFORM_ILL$,,AUTO
        14 003752   400000 441100                    SXL1    0,,PR4
        14 003753   004005 710000 14                 TRA     s:12341

      844    12322                          /* COBOL-74 PERFORM - Wait till next loop. */
      845    12323    2            ELSE
      846    12324    3              DO ;

      847    12325    3                PFORM_ILL$->ILL.CODE = 1; /* Flag this as optimized. */

  12325 14 003754   000001 221003                    LDX1    1,DU
        14 003755   200003 475500                    LDP5    PFORM_ILL$,,AUTO
        14 003756   500000 441100                    SXL1    0,,PR5

      848    12326    3                TEMP$ = PFORM_ILS$ ;

  12326 14 003757   200010 236100                    LDQ     PFORM_ILS$,,AUTO
        14 003760   200016 756100                    STQ     TEMP$,,AUTO

      849    12327    4                DO UNTIL TEMP$ -> ILS.ILL$ -> ILL.ID = %LINOI ;

      850    12328    5                  DO UNTIL TEMP$ -> ILS.ILL$ ~= ADDR (NIL) ;

      851    12329                         %NEXT_ILS (POINTER=TEMP$) ;

  12331 14 003761   200016 470500                    LDP0    TEMP$,,AUTO
        14 003762   000002 236100                    LDQ     2,,PR0
        14 003763   200016 756100                    STQ     TEMP$,,AUTO

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:153  
      852    12334    5                  END ;

  12334 14 003764   200016 470500                    LDP0    TEMP$,,AUTO
        14 003765   000003 236100                    LDQ     3,,PR0
        14 003766   000000 116000 15                 CMPQ    0
        14 003767   003761 600000 14                 TZE     s:12331

      853    12335    4                END ;

  12335 14 003770   000003 471500                    LDP1    3,,PR0
        14 003771   100000 220100                    LDX0    0,,PR1
        14 003772   000373 100003                    CMPX0   251,DU
        14 003773   003761 601000 14                 TNZ     s:12331

      854    12336    3                COMCOM.CURRENT.LINE = TEMP$ -> ILS.ILL$ -> LINOI.PREV_LINE ;

  12336 14 003774   100000 236100                    LDQ     0,,PR1
        14 003775   777777 376007                    ANQ     -1,DL
        14 003776   000133 756000 xsym               STQ     COMCOM+91

      855    12337    3                COMCOM.CURRENT.COLUMN = TEMP$ -> ILS.ILL$ -> LINOI.PREV_COL ;

  12337 14 003777   000003 471500                    LDP1    3,,PR0
        14 004000   100002 236100                    LDQ     2,,PR1
        14 004001   777777 376007                    ANQ     -1,DL
        14 004002   000134 756000 xsym               STQ     COMCOM+92

      856    12338    3                CALL SET_UP_OPTIMIZED_PFORM ;

  12338 14 004003   002144 701000 14                 TSX1    SET_UP_OPTIMIZED_PFORM
        14 004004   000000 011000                    NOP     0

      857    12339    3              END ;

      858    12340
      859    12341    2            O2COM.PFORM_LIST$ = PFORM_ILL$->PFORM.PFORM_LIST$ ;

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:154  
  12341 14 004005   200003 470500                    LDP0    PFORM_ILL$,,AUTO
        14 004006   000004 236100                    LDQ     4,,PR0
        14 004007   000001 756000 13                 STQ     O2COM+1

      860    12342    2          END ;

  12342 14 004010   000000 116000 15                 CMPQ    0
        14 004011   003655 601000 14                 TNZ     s:12284

      861    12343
      862    12344    1          O2COM.PFORM_LIST$ = COMCOM.H_PFORM ; /* Get ready to scan list again*/

  12344 14 004012   000126 236000 xsym               LDQ     COMCOM+86
        14 004013   000001 756000 13                 STQ     O2COM+1

      863    12345    2          DO UNTIL O2COM.PFORM_LIST$ = ADDR(NIL) ;

      864    12346    2            PFORM_ILL$ = O2COM.PFORM_LIST$->ILS.ILL$ ;

  12346 14 004014   000001 470400 13                 LDP0    O2COM+1
        14 004015   000003 236100                    LDQ     3,,PR0
        14 004016   200003 756100                    STQ     PFORM_ILL$,,AUTO

      865    12347    2            O2COM.PFORM_LIST$->ILS.ILL$ = ADDR (NIL) ; /* PFORM will be deleted */

  12347 14 004017   000000 236000 15                 LDQ     0
        14 004020   000003 756100                    STQ     3,,PR0

      866    12348    2            IF PFORM_ILL$->ILL.CODE = 0 THEN /* This PFORM wasn't optimized. */

  12348 14 004021   200003 471500                    LDP1    PFORM_ILL$,,AUTO
        14 004022   100000 720100                    LXL0    0,,PR1
        14 004023   004062 601000 14                 TNZ     s:12370

      867    12349    3              DO ;

      868    12350    3                START_LABEL$ = PFORM_ILL$->ILL.LOP ;
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:155  

  12350 14 004024   100001 236100                    LDQ     1,,PR1
        14 004025   200004 756100                    STQ     START_LABEL$,,AUTO

      869    12351    3                CURRENT_PROC$ = START_LABEL$->LABEL.PROC$ ;

  12351 14 004026   200004 473500                    LDP3    START_LABEL$,,AUTO
        14 004027   300011 236100                    LDQ     9,,PR3
        14 004030   200020 756100                    STQ     CURRENT_PROC$,,AUTO

      870    12352    3                END_LABEL$ = PFORM_ILL$->ILL.ROP ;

  12352 14 004031   100002 236100                    LDQ     2,,PR1
        14 004032   200005 756100                    STQ     END_LABEL$,,AUTO

      871    12353    3                PFORM_ILS$ = O2COM.PFORM_LIST$ ;

  12353 14 004033   000001 236000 13                 LDQ     O2COM+1
        14 004034   200010 756100                    STQ     PFORM_ILS$,,AUTO

      872    12354    3                ILS$ = PFORM_ILS$ ;

  12354 14 004035   000000 756000 7                  STQ     ILS$

      873    12355    4                DO UNTIL ILS$ -> ILS.ILL$ -> ILL.ID = %LINOI ;

      874    12356    5                  DO UNTIL ILS$ -> ILS.ILL$ ~= ADDR (NIL) ;

      875    12357                     %NEXT_ILS ;

  12359 14 004036   000000 470400 7                  LDP0    ILS$
        14 004037   000002 236100                    LDQ     2,,PR0
        14 004040   000000 756000 7                  STQ     ILS$

      876    12362    5                  END ;

  12362 14 004041   000000 470400 7                  LDP0    ILS$
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:156  
        14 004042   000003 236100                    LDQ     3,,PR0
        14 004043   000000 116000 15                 CMPQ    0
        14 004044   004036 600000 14                 TZE     s:12359

      877    12363    4                END ;

  12363 14 004045   000003 471500                    LDP1    3,,PR0
        14 004046   100000 220100                    LDX0    0,,PR1
        14 004047   000373 100003                    CMPX0   251,DU
        14 004050   004036 601000 14                 TNZ     s:12359

      878    12364    3                COMCOM.CURRENT.LINE = ILS$ -> ILS.ILL$ -> LINOI.PREV_LINE ;

  12364 14 004051   100000 236100                    LDQ     0,,PR1
        14 004052   777777 376007                    ANQ     -1,DL
        14 004053   000133 756000 xsym               STQ     COMCOM+91

      879    12365    3                COMCOM.CURRENT.COLUMN = ILS$ -> ILS.ILL$ -> LINOI.PREV_COL ;

  12365 14 004054   000003 471500                    LDP1    3,,PR0
        14 004055   100002 236100                    LDQ     2,,PR1
        14 004056   777777 376007                    ANQ     -1,DL
        14 004057   000134 756000 xsym               STQ     COMCOM+92

      880    12366
      881    12367    3                CALL SET_UP_COBOL_74_PFORM ;

  12367 14 004060   000241 701000 14                 TSX1    SET_UP_COBOL_74_PFORM
        14 004061   000000 011000                    NOP     0

      882    12368
      883    12369    3              END ;

      884    12370    2            O2COM.PFORM_LIST$ = PFORM_ILL$->PFORM.PFORM_LIST$ ;

  12370 14 004062   200003 470500                    LDP0    PFORM_ILL$,,AUTO
        14 004063   000004 236100                    LDQ     4,,PR0
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:157  
        14 004064   000001 756000 13                 STQ     O2COM+1

      885    12371    2          END;

  12371 14 004065   000000 116000 15                 CMPQ    0
        14 004066   004014 601000 14                 TNZ     s:12346

      886    12372
      887    12373    1   END Z8FP$PFORM_CHECKING ;

  12373 14 004067   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:158  
--  Include file information  --

   Z8F_O2COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9A_SUPP_MAC.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure Z8FP$PFORM_CHECKING.
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:159  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 ITERATION

  ****  Section 001 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 002 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 003 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 004 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ETT_

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:160  
  ****  Section 005 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 006 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ILL_

  ****  Section 007 LblCom ILS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILS$

  ****  Section 008 LblCom ILS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ILS_

  ****  Section 009 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 010 LblCom LTS_

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:161  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 LTS_

  ****  Section 011 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 012 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 013 LblCom O2COM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(432)   r     1 O2COM

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    43-0-0/w PTR         r     1 @CHANGE_LABEL$            50-0-0/w PTR         r     1 @ITEM_LOP$
    51-0-0/w PTR         r     1 @ITEM_ROP$                47-0-0/w PTR         r     1 @ITEM_TYPE
    41-0-0/w PTR         r     1 @LABEL$$                  42-0-0/w PTR         r     1 @SEGMENT_LIMIT
    41-0-0/w PTR         r     1 @SEG_LTS$                 41-0-0/w PTR         r     1 @SEG_LTS$
    42-0-0/w PTR         r     1 @SEG_NO#                  15-0-0/w PTR         r     1 ALTER$
    13-0-0/w PTR         r     1 ALTER_LBL$                43-0-0/w PTR         r     1 ARRAY$
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:162  
    17-0-0/w PTR               1 BASEP$                    44-0-0/w PTR         r     1 CALL_LABEL$
    *0-0-0/w PTR         r     1 CHANGE_LABEL$             20-0-0/w PTR         r     1 CURRENT_PROC$
    11-0-0/b BIT         r     1 DEFLB_FOLLOWS             37-0-0/w PTR         r     1 DO_ILS$
     5-0-0/w PTR         r     1 END_LABEL$                 6-0-0/w PTR         r     1 END_LABEL_74$
    27-0-0/w SBIN        r     1 END_SEG_NO#                7-0-0/w PTR         r     1 END_TEMP$
    14-0-0/w PTR         r     1 ENTRY$                    46-0-0/w PTR         r     1 ENTRY_LINOI$
    26-0-0/w SBIN        r     1 FROM_SEG_NO#              35-0-0/w PTR         r     1 GO_ILL$
    35-0-0/w PTR         r     1 INTERIOR_PFORM_LBL$       *0-0-0/w PTR         r     1 ITEM_LOP$
    *0-0-0/w PTR         r     1 ITEM_ROP$                 *0-0-0/w UBIN        r     1 ITEM_TYPE
    *0-0-0/w PTR         r     1 LABEL$$                   12-0-0/w PTR         r     1 LABEL_AFTER_PFORM$
    36-0-0/w PTR         r     1 LINOI$                    24-0-0/w PTR         r     1 NEW_LABEL$
    32-0-0/b BIT         r     1 PERFORM_CHANGE             3-0-0/w PTR         r     1 PFORM_ILL$
    10-0-0/w PTR         r     1 PFORM_ILS$                43-0-0/w PTR         r     1 PFORM_SEG$
    35-0-0/w PTR         r     1 POINTER$                  31-0-0/b BIT         r     1 POST_ALTER_CHANGE
    45-0-0/w PTR         r     1 PREV_ILS_NEXT$            30-0-0/b BIT         r     1 PRE_ALTER_CHANGE
    21-0-0/b BIT         r     1 REFRESH_SEGMENT           *0-0-0/w SBIN        r     1 SEGMENT_LIMIT
    22-0-0/w PTR         r     1 SEGMENT_LTS$              *0-0-0/w PTR         r     1 SEG_LTS$
    *0-0-0/w PTR         r     1 SEG_LTS$                  41-0-0/w PTR         r     1 SEG_LTS$
    42-0-0/w SBIN        r     1 SEG_NO#                   *0-0-0/w SBIN        r     1 SEG_NO#
     4-0-0/w PTR         r     1 START_LABEL$              23-0-0/w PTR         r     1 SUB_TAIL$
    16-0-0/w PTR         r     1 TEMP$                     25-0-0/w SBIN        r     1 TO_SEG_NO#
    44-0-0/w PTR         r     1 TRA_END_LABEL$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM                     0-0-0/w UBIN        r     1 ILL_STEP(0:144)
     0-0-0/w UBIN              1 ILS_STEP_TABLE(0:2)
     0-0-0/w UBIN              1 LTS_STEP(0:37)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:163  
     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(396)         1 ALPHABET
     0-0-0/w STRC(144)         1 ALTER_LTS                  0-0-0/w STRC(3672)        1 ALT_KEY
     0-0-0/w STRC(36864)       1 ARGLIST                    0-0-0/w STRC(396)         1 ARRAY
     0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS           0-0-0/w STRC(288)         1 BASE_LTS
     0-0-0/w STRC(108)         1 BINARY_ILL                 0-0-0/w STRC(396)   r     1 BLOCK
     0-0-0/w STRC(144)         1 BRANCH_ILL                 0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(216)         1 CCOSU                      0-0-0/w STRC(396)         1 CD
     0-0-0/w STRC(288)         1 CD_LTS                     0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(396)         1 CLASS                      0-0-0/w STRC(108)         1 CODED_MOVE
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)         1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)         1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(144)         1 DEFLB
     0-0-0/w STRC(108)         1 DEPENDING_SIZE             0-0-0/w STRC(5472)        1 DIMS
     0-0-0/w STRC(396)         1 DML_ITEM                   0-0-0/w STRC(216)         1 DML_REC
     0-0-0/w STRC(144)         1 DOEND                      0-0-0/w STRC(396)         1 DO_N
     0-0-0/w STRC(180)         1 DV4I                       0-0-0/w STRC(180)   r     1 ENTRY_ILL
     0-0-0/w STRC(180)   r     1 ETT                        0-0-0/w STRC(108)         1 EVALU
     0-0-0/w STRC(73836)       1 EVALUATE                   0-0-0/w STRC(396)         1 FD
     0-0-0/w STRC(1692)        1 FILE_LTS                   0-0-0/w STRC(144)         1 GO
     0-0-0/w STRC(180)   r     1 ILL                        0-0-0/w STRC              1 ILL_NO_OPS
     0-0-0/w STRC(180)   r     1 ILS                        0-0-0/w STRC(108)         1 INDEXES
     0-0-0/w STRC(360)         1 INIT_LTS                   0-0-0/w STRC(396)         1 INTDEF
     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN           0-0-0/w STRC(144)         1 KEY
     0-0-0/w STRC(396)   r     1 LABEL                      0-0-0/w STRC(36864)       1 LCNST
     0-0-0/w STRC(108)   r     1 LINOI                      0-0-0/w STRC(72)          1 LONG
     0-0-0/w STRC              1 LTS                        0-0-0/w STRC(360)         1 LTSS
     0-0-0/w STRC(36936) r     1 LTS_PTR_ARRAY              0-0-0/w STRC(72)          1 MFILL
     0-0-0/w STRC(396)         1 MNEMONIC                   0-0-0/w STRC(180)         1 MULTI_GO
     0-0-0/w STRC(180)         1 MVEAL                      0-0-0/w STRC(108)         1 MVFIL
     0-0-0/w STRC(72)          1 MVIIS                      0-0-0/w STRC(144)         1 NEL
     0-0-0/w STRC(216)         1 OPEN_LTS                   0-0-0/w STRC(144)   r     1 OPN
     0-0-0/w STRC(180)         1 OS_CALL                    0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(396)         1 PARA                       0-0-0/w STRC(216)   r     1 PFORM
     0-0-0/w STRC(144)         1 PINC                       0-0-0/w STRC(144)         1 PREOFF
     0-0-0/w STRC(108)         1 PRESET                     0-0-0/w STRC(144)         1 PRIME
     0-0-0/w STRC(396)   r     1 PROC_                      0-0-0/w STRC(396)   r     1 PROC_DEF
PL6.E3A0      #001=Z8FP$PFORM_CHECKING File=Z8FP.:Z8A6TSI                        SAT 08/09/97 13:10 Page:164  
     0-0-0/w STRC(900)   r     1 PROC_SUPP                  0-0-0/w STRC(144)         1 P_A_PRESET
     0-0-0/w STRC(144)         1 P_P_PRESET                 0-0-0/w STRC(396)         1 RD
     0-0-0/w STRC(216)         1 REF                        0-0-0/w STRC(144)         1 REMEM
     0-0-0/w STRC(108)         1 RENAMES                    0-0-0/w STRC(720)         1 REPORT_01_LTS
     0-0-0/w STRC(432)         1 REPORT_ELEM_LTS            0-0-0/w STRC(252)         1 REPORT_GRP_LTS
     0-0-0/w STRC(1332)        1 REPORT_LTS                 0-0-0/w STRC(144)         1 RVA_LTS
     0-0-0/w STRC(396)         1 SCALAR                     0-0-0/w STRC(144)         1 SCOPE
     0-0-0/w STRC(396)         1 SD                         0-0-0/w STRC(216)         1 SEARCH_
     0-0-0/w STRC(396)   r     1 SECTION                    0-0-0/w STRC(396)         1 SEGMENT
     0-0-0/w STRC(360)   r     1 SEGMENT_LTS                0-0-0/w STRC(396)   r     1 ST
     0-0-0/w STRC(72)          1 STP2                       0-0-0/w STRC(252)         1 SUM_LTS
     0-0-0/w STRC(396)         1 SWITCH                     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR
     0-0-0/w STRC(396)         1 SYMDEF_                    0-0-0/w STRC(396)         1 SYMREF_
     0-0-0/w STRC(396)         1 TEMP                       0-0-0/w STRC(144)         1 TRINARY_ILL
     0-0-0/w STRC(72)          1 UNARY_ILL                  0-0-0/d STRC(612)         1 USE
     0-0-0/w STRC(216)         1 USER_CALL                  0-0-0/w STRC(252)         1 USE_SUPP
     0-0-0/w STRC(108)         1 VAL                        0-0-0/w STRC(108)         1 VAL_END
     0-0-0/w STRC(396)   r     1 VARIABLE                   0-0-0/w STRC(72)          1 WHEN


   Procedure Z8FP$PFORM_CHECKING requires 2104 words for executable code.
   Procedure Z8FP$PFORM_CHECKING requires 52 words of local(AUTO) storage.

    No errors detected in file Z8FP.:Z8A6TSI    .
