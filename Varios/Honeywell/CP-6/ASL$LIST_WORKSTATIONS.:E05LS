VERSION E05

PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:1    
        1        1        /*M* ASL$LIST_ALL_WSNS:  routine to handle LIST WSN cmd. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASL$LIST_ALL_WORKSTATIONS: PROC;
       10       10        /**********************************************************/
       11       11
       12       12        /*D* NAME:     ASL$LIST_ALL_WSNS
       13       13             CALL:     CALL ASL$LIST_ALL_WSNS
       14       14             INPUT:    Nothing is passed.
       15       15             OUTPUT:   Nothing is returned.
       16       16             DESCRIPTION:  ASL$LIST_ALL_WSNS is a subroutine to handle
       17       17                           the LIST WSN command for SUPER.
       18       18                           Workstation records are stored in the :WSN.:SYS
       19       19                           file and have keys that look like the following:
       20       20                                 'xxxxxxxx*' where the x signifies
       21       21                                 a character from the alphanumeric character
       22       22                                 set plus the special characters ':$*' and
       23       23                                 is of length 8 or less.  If the workstation name
       24       24                                 is less than 8 characters, the key is
       25       25                                 blank padded on the right to 8 characters.
       26       26                           This routine will either read a single workstation
       27       27                           record or it will cycle through all of the workstation
       28       28                           records looking for matches
       29       29                           to the selection criteria as input in the
       30       30                           LIST/DISPLAY command.  If a match is found
       31       31                           this routine will do either
       32       32                           of two things.  It will call the display routine
       33       33                           if the command was a DISPLAY command, or it will
       34       34                           put the vector framing the workstation name into the
       35       35                           formatter vector list.
       36       36
       37       37                  MEMORY REQUIREMENTS:
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:2    
       38       38                           For all of the routines that deal with listing/
       39       39                           displaying workstations:
       40       40
       41       41                            ASL$LIST_ALL_WSNS
       42       42                            ASL$DISP_ONE_WSN
       43       43
       44       44                            The workstationname record will be read into
       45       45                            data segment 1.  The name will be used by the
       46       46                            ASL$LIST_ALL_WSNS, while the other info
       47       47                            will be used by the ASL$DISP_ONE_WSN
       48       48                            routine.
       49       49        */
       50       50        /********************************************************************/
       51       51        /*   Include files   include files   include files   include files  */
       52       52        /********************************************************************/
       53       53        %INCLUDE AS_PERR_C;
       54      655        %INCLUDE AS_SUPER_C;
       55     1090        %INCLUDE AS_SUBS_C;
       56     2504        %INCLUDE AS_MAC_C;
       57     2584        %INCLUDE AS_ENTRIES_M;
       58     3634        %INCLUDE OCI_SUBS_C;
       59     3732        %INCLUDE AS_SSUBS_C;
       60     3824        %INCLUDE B_ERRORS_C;
       61     4951        %INCLUDE CP_6_SUBS;
       62     5491        %INCLUDE KL_SUPER_C;
       63     8393        %INCLUDE XU_MACRO_C;
       64    11499        %INCLUDE XU_FORMAT_C;
       65    11661        %INCLUDE AS_SUPER_R;
       66    14677        /********************************************************************/
       67    14678        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       68    14679        /********************************************************************/
       69    14680        %ASW$PREC_WSN ;
       70    14683        %ASW$READ_WSN ;
       71    14686        %ASW$READ_WSN_SEQ ;
       72    14689        %ASH$ERROR ;
       73    14692        %ASH$WARN ;
       74    14695        %ASH$INFO ;
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:3    
       75    14698        %ASL$DISP_ONE_WORKSTATION ;
       76    14701        %ASB$WILD_MATCH ;
       77    14704    1   DCL X$FORMAT ENTRY(1) ;
       78    14705        /********************************************************************/
       79    14706        /*   Local based     local based     local based     local based    */
       80    14707        /********************************************************************/
       81    14708        %PARSE$OUT ( NAME = P$B, STCLASS = "BASED(NODE$)",
       82    14709                     NDTYPE = TYPE, NSUBLKS = NSUBLKS);
       83    14754        %PARSE$SYM ( NAME = P$S, STCLASS = BASED);
       84    14792        /********************************************************************/
       85    14793        /*   Auto data       auto data       auto data       auto data      */
       86    14794        /********************************************************************/
       87    14795    1   DCL ALL_WSNS                 BIT(1);
       88    14796    1   DCL 1 BEGIN_KEY ,
       89    14797    1          2 COUNT               UBIN BYTE,
       90    14798    1          2 TEXT                CHAR(8);
       91    14799    1   DCL CODE2                    UBIN;
       92    14800    1   DCL CURRENT_WSN              CHAR(8);
       93    14801    1   DCL DISP                     BIT(1);
       94    14802    1   DCL DISP_WSNS                SBIN;
       95    14803    1   DCL 1 END_KEY ,
       96    14804    1          2 COUNT               UBIN BYTE,
       97    14805    1          2 TEXT                CHAR(8);
       98    14806    1   DCL FOUND                    BIT(1);
       99    14807    1   DCL I                        UBIN;
      100    14808    1   DCL J                        UBIN;
      101    14809    1   DCL JCL                      BIT(1);
      102    14810    1   DCL 1 TNAME ,
      103    14811    1          2 COUNT               UBIN BYTE,
      104    14812    1          2 TEXT                CHAR(8);
      105    14813    1   DCL WILD_CARD                BIT(1);
      106    14814    1   DCL WSN_ARS                  UBIN;
      107    14815        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:4    
      108    14816        /********************************************************************/
      109    14817        /*   Constant data   constant data   constant data   constant data  */
      110    14818        /********************************************************************/
      111    14819    1   DCL WSN_STR                  CHAR(0) CONSTANT INIT ('workstation');
      112    14820    1   DCL WSNS_STR                 CHAR(0) CONSTANT INIT ('workstations');
      113    14821    1   DCL LIST_STR                 CHAR(0) CONSTANT INIT ('listed');
      114    14822    1   DCL DISPLAY_STR              CHAR(0) CONSTANT INIT ('displayed');
      115    14823        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:5    
      116    14824        /********************************************************************/
      117    14825        /*   Procedure       procedure       procedure       procedure      */
      118    14826        /********************************************************************/
      119    14827    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;
      120    14828    1   JCL = %NO#;
      121    14829    1   WILD_CARD = %NO#;
      122    14830    1   TNAME.TEXT = '?';
      123    14831    1   TNAME.COUNT = 1;
      124    14832    1   DISP_WSNS = 0;
      125    14833
      126    14834    2   DO SELECT (CODE);
      127    14835
      128    14836    2      SELECT (%LIST_ALL_VAL);
      129    14837
      130    14838    2      DISP = %NO#;
      131    14839
      132    14840    2      SELECT (%DISPLAY_ALL_VAL);
      133    14841
      134    14842    2      DISP = %YES#;
      135    14843    2      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN
      136    14844    2         JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL);
      137    14845    2      ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN
      138    14846    2            JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL);
      139    14847
      140    14848    2      SELECT (%LIST_WSN_VAL);
      141    14849
      142    14850    2      DISP = %NO#;
      143    14851    2      JCL = %NO#;
      144    14852    3      IF P_PCB.OUT$->P$B.NSUBLKS > 1 THEN DO;
      145    14853    3         TNAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;
      146    14854    3         TNAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;
      147    14855    3         END; /*  Number of sublocks > 1  */
      148    14856
      149    14857    2      SELECT (%DISPLAY_WSN_VAL);
      150    14858
      151    14859    2      DISP = %YES#;
      152    14860    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:6    
      153    14861    3         CODE2 = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;
      154    14862
      155    14863    4         DO SELECT (CODE2);
      156    14864
      157    14865    4            SELECT (%WSN_NAME_WILD_VAL);
      158    14866
      159    14867    4            TNAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;
      160    14868    4            TNAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;
      161    14869
      162    14870    4            SELECT (%JCL_VAL);
      163    14871
      164    14872    4            JCL = %YES#;
      165    14873
      166    14874    4            END;  /* Do case (CODE2) */
      167    14875
      168    14876    3         END;  /*  Do i  */
      169    14877
      170    14878    2      END;  /*  Do case (code)  */
      171    14879
      172    14880    1   IF TNAME.TEXT = '?' THEN
      173    14881    1      ALL_WSNS = %YES#;
      174    14882    2   ELSE DO;
      175    14883    2      ALL_WSNS = %NO#;
      176    14884    2      BEGIN_KEY.TEXT = ' ';
      177    14885    3      CALL INDEX (I,'?',TNAME.TEXT) WHENRETURN DO;
      178    14886    3         BEGIN_KEY.TEXT = SUBSTR(TNAME.TEXT,0,I);
      179    14887    3         BEGIN_KEY.COUNT = 8;
      180    14888    3         CALL CONCAT (END_KEY.TEXT,SUBSTR(TNAME.TEXT,0,I),'~');
      181    14889    3         END_KEY.COUNT = I + 1;
      182    14890    3         WILD_CARD = %YES#;
      183    14891    3         END;  /*  Whenreturn from index  */
      184    14892    3      WHENALTRETURN DO;
      185    14893    3         WILD_CARD = %NO#;
      186    14894    3         END;  /* Whenaltreturn  */
      187    14895    2      END;  /*  Else  */
      188    14896
      189    14897    1   FDS.NVECS# = 0;
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:7    
      190    14898    1   FDS.WRAPTAB# = 1;
      191    14899    2   IF JCL THEN DO;
      192    14900    2      CALL CONCAT (FMT_BUF, '%1/"', WSNS_STR, '%1/');
      193    14901    2      FDS.FMT_.BOUND = LENGTHC (WSNS_STR) + 6;
      194    14902    2      END;   /*  Jcl  */
      195    14903    2   ELSE DO;
      196    14904    2      CALL CONCAT (FMT_BUF, '%1/', WSNS_STR, '%1/');
      197    14905    2      FDS.FMT_.BOUND = LENGTHC (WSNS_STR) + 5;
      198    14906    2      END; /*  Not jcl  */
      199    14907    1   FDS.TABDFLT# = 10;
      200    14908    1   CALL X$FORMAT (FDS);
      201    14909
      202    14910    2   IF ALL_WSNS THEN DO;
      203    14911    2      USERS_KEY = '001000'O;     /* To precord to begin of workstations */
      204    14912    2      END;  /*  ALL_WSNS  */
      205    14913    2   ELSE IF WILD_CARD THEN DO;
      206    14914    2         CALL CONCAT (USERS_KEY.TXTC,BEGIN_KEY.TEXT,'*');
      207    14915    2         USERS_KEY.COUNT = 9;
      208    14916    2         END; /*  WILD_CARD  */
      209    14917    2      ELSE DO;  /*  Single wsn  */
      210    14918    2         CALL CONCAT (USERS_KEY.TXTC,TNAME.TEXT,'*');
      211    14919    2         USERS_KEY.COUNT = 9;
      212    14920    2         WSN_ARS = DSEG1SIZE;
      213    14921    2         CALL ASW$READ_WSN (DSEG1$,WSN_ARS)
      214    14922    3         WHENRETURN DO;
      215    14923    3            IF DISP THEN
      216    14924    4            DO;
      217    14925    4               CALL ASL$DISP_ONE_WORKSTATION (JCL);
      218    14926    4               END; /*  If disp  */
      219    14927    4            ELSE DO;
      220    14928    4               CALL CONCAT (FMT_BUF, SUBSTR(TNAME.TEXT,0,TNAME.COUNT), '%1/');
      221    14929    4               FDS.FMT_.BOUND = TNAME.COUNT + 2;
      222    14930    4               CALL X$FORMAT (FDS);
      223    14931    4               END; /*  Else  disp  */
      224    14932    3            END;  /*  Whenreturn  */
      225    14933    3         WHENALTRETURN DO;
      226    14934    3            IF MERR_CODE.CODE = %E$NOKEY
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:8    
      227    14935    4            THEN DO;
      228    14936        /*E* ERROR:   ASL-E$WSN_NO_EXIST-C
      229    14937             MESSAGE: The WSN %U1 does not exist.
      230    14938        */
      231    14939    4               AS_FIELD1.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;
      232    14940    4               AS_FIELD1.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;
      233    14941                    %SCREAM( ERR#=E$WSN_NO_EXIST, MID='L', LEVEL=ERROR );
      234    14956    4               END;  /*  Error = nokey  */
      235    14957    4            ELSE DO;
      236    14958    4               CALL ASH$ERROR( MERR_CODE );
      237    14959    4               END;  /* Error ~= nokey */
      238    14960    3            END;  /*  Whenaltreturn  */
      239    14961    2         RETURN;
      240    14962    2         END; /*  Else  */
      241    14963    1   CALL ASW$PREC_WSN ;
      242    14964    2   DO FOREVER;
      243    14965
      244    14966    3      DO UNTIL (USERS_KEY.COUNT = 9);
      245    14967    3         WSN_ARS = DSEG1SIZE;
      246    14968    3         CALL ASW$READ_WSN_SEQ (DSEG1$,WSN_ARS)
      247    14969    4         WHENALTRETURN DO;
      248    14970    4            IF MERR_CODE.CODE ~= %E$EOF THEN CALL ASH$ERROR(MERR_CODE);
      249    14971    4            GOTO FINISH_UP;
      250    14972    4            END;  /*  Whenaltreturn  */
      251    14973    3         END;  /*  Do until we find a wsn record  */
      252    14974    2      CALL INDEX (I, ' ',USERS_KEY.TXTC,0);
      253    14975    2      IF I > 8 THEN I = 8;
      254    14976    2      CURRENT_WSN = SUBSTR(USERS_KEY.TXTC,0,I);
      255    14977    3      IF WILD_CARD THEN DO;
      256    14978    3         J = TNAME.COUNT;
      257    14979    3         CALL ASB$WILD_MATCH (I, CURRENT_WSN, J, TNAME.TEXT)
      258    14980    4         WHENALTRETURN DO;
      259    14981    4            IF CURRENT_WSN > END_KEY.TEXT THEN
      260    14982    4               GOTO FINISH_UP;
      261    14983    4            ELSE
      262    14984    4               GOTO END_FOREVER;
      263    14985    4            END;  /*  Whenaltreturn  */
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:9    
      264    14986    3         END;  /*  WILD_CARD  */
      265    14987    2      IF DISP THEN
      266    14988    3      DO;
      267    14989    3         CALL ASL$DISP_ONE_WORKSTATION (JCL);
      268    14990    3         END; /*  If disp  */
      269    14991    3      ELSE DO;
      270    14992    4         IF DISP_WSNS = 0 THEN DO;
      271    14993    4            CALL CONCAT (FMT_BUF, '%\', SUBSTR(CURRENT_WSN,0,I));
      272    14994    4            FDS.FMT_.BOUND = I + 1;
      273    14995    4            END;  /*  DISP_WSNS = 0  */
      274    14996    4         ELSE DO;
      275    14997    4            CALL CONCAT (FMT_BUF, '%\%-%10R', SUBSTR(CURRENT_WSN,0,I));
      276    14998    4            FDS.FMT_.BOUND = I + 7;
      277    14999    4            END;  /*  Else  */
      278    15000    3         CALL X$FORMAT (FDS);
      279    15001    3         END; /*  Else  disp  */
      280    15002    2      DISP_WSNS = DISP_WSNS + 1;
      281    15003    2   END_FOREVER:
      282    15004    2      END;  /*  Do forever  */
      283    15005    1   FINISH_UP:
      284    15006    2   IF NOT DISP THEN DO;
      285    15007    2      FMT_BUF = '%\%/';
      286    15008    2      FDS.FMT_.BOUND = 3;
      287    15009    2      FDS.NVECS# = 0;
      288    15010    2      CALL X$FORMAT(FDS);
      289    15011    2      END; /*  If not disp  */
      290    15012    2   IF NOT JCL THEN DO;
      291    15013    2      FMT_VEC(0) = VECTOR (DISP_WSNS);
      292    15014    2      IF DISP_WSNS = 1 THEN
      293    15015    3      DO;
      294    15016    3         FMT_VEC(1) = VECTOR (WSN_STR);
      295    15017    3         END; /*  DISP_WSNS = 1  */
      296    15018    3      ELSE DO;
      297    15019    3         FMT_VEC(1) = VECTOR (WSNS_STR);
      298    15020    3         END; /*  DISP_WSNS ~= 1  */
      299    15021    2      IF DISP THEN
      300    15022    3      DO;
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:10   
      301    15023    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);
      302    15024    3         END; /*  If disp  */
      303    15025    3      ELSE DO;
      304    15026    3         FMT_VEC(2) = VECTOR (LIST_STR);
      305    15027    3         END; /*  If ~ disp  */
      306    15028    2      FDS.NVECS# = 3;
      307    15029    2      FMT_BUF = '   %5D %A %A.';
      308    15030    2      FDS.FMT_.BOUND = 12;
      309    15031    2      CALL X$FORMAT(FDS);
      310    15032    2      END; /* Not jcl */
      311    15033    1   FDS.WRAPTAB# = 4;
      312    15034    1   RETURN;
      313    15035    1   END ASL$LIST_ALL_WORKSTATIONS;
      314    15036        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:11   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_WORKSTATIONS.

   Procedure ASL$LIST_ALL_WORKSTATIONS requires 450 words for executable code.
   Procedure ASL$LIST_ALL_WORKSTATIONS requires 28 words of local(AUTO) storage.

PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:12   

 Object Unit name= ASL$LIST_ALL_WORKSTATIONS                  File name= ASL$LIST_WORKSTATIONS.:E05TOU
 UTS= JUL 29 '97 10:24:56.44 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS     21     25  ASL$LIST_ALL_WORKSTATIONS
    2   Proc  even  none   450    702  ASL$LIST_ALL_WORKSTATIONS
    3  RoData even  none    20     24  ASL$LIST_ALL_WORKSTATIONS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  ASL$LIST_ALL_WORKSTATIONS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       2 ASW$READ_WSN
         yes           Std       1 X$FORMAT
         yes           Std       1 ASL$DISP_ONE_WORKSTATION
         yes           Std       2 ASH$ERROR
 yes     yes           Std       0 ASW$PREC_WSN
 yes     yes           Std       4 ASB$WILD_MATCH
 yes     yes           Std       2 ASW$READ_WSN_SEQ
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:13   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     USERS_KEY                             FDS                                   FMT_BUF
     FMT_VEC                               NODE$                                 CODE
     ERR_CODE                              AS_FIELD1                             REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG1$
     DSEG1SIZE                             P_PCB                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:14   


        1        1        /*M* ASL$LIST_ALL_WSNS:  routine to handle LIST WSN cmd. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASL$LIST_ALL_WORKSTATIONS: PROC;

      9  2 000000   000000 700200 xent  ASL$LIST_AL* TSX0  ! X66_AUTO_0
         2 000001   000034 000000                    ZERO    28,0

       10       10        /**********************************************************/
       11       11
       12       12        /*D* NAME:     ASL$LIST_ALL_WSNS
       13       13             CALL:     CALL ASL$LIST_ALL_WSNS
       14       14             INPUT:    Nothing is passed.
       15       15             OUTPUT:   Nothing is returned.
       16       16             DESCRIPTION:  ASL$LIST_ALL_WSNS is a subroutine to handle
       17       17                           the LIST WSN command for SUPER.
       18       18                           Workstation records are stored in the :WSN.:SYS
       19       19                           file and have keys that look like the following:
       20       20                                 'xxxxxxxx*' where the x signifies
       21       21                                 a character from the alphanumeric character
       22       22                                 set plus the special characters ':$*' and
       23       23                                 is of length 8 or less.  If the workstation name
       24       24                                 is less than 8 characters, the key is
       25       25                                 blank padded on the right to 8 characters.
       26       26                           This routine will either read a single workstation
       27       27                           record or it will cycle through all of the workstation
       28       28                           records looking for matches
       29       29                           to the selection criteria as input in the
       30       30                           LIST/DISPLAY command.  If a match is found
       31       31                           this routine will do either
       32       32                           of two things.  It will call the display routine
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:15   
       33       33                           if the command was a DISPLAY command, or it will
       34       34                           put the vector framing the workstation name into the
       35       35                           formatter vector list.
       36       36
       37       37                  MEMORY REQUIREMENTS:
       38       38                           For all of the routines that deal with listing/
       39       39                           displaying workstations:
       40       40
       41       41                            ASL$LIST_ALL_WSNS
       42       42                            ASL$DISP_ONE_WSN
       43       43
       44       44                            The workstationname record will be read into
       45       45                            data segment 1.  The name will be used by the
       46       46                            ASL$LIST_ALL_WSNS, while the other info
       47       47                            will be used by the ASL$DISP_ONE_WSN
       48       48                            routine.
       49       49        */
       50       50        /********************************************************************/
       51       51        /*   Include files   include files   include files   include files  */
       52       52        /********************************************************************/
       53       53        %INCLUDE AS_PERR_C;
       54      655        %INCLUDE AS_SUPER_C;
       55     1090        %INCLUDE AS_SUBS_C;
       56     2504        %INCLUDE AS_MAC_C;
       57     2584        %INCLUDE AS_ENTRIES_M;
       58     3634        %INCLUDE OCI_SUBS_C;
       59     3732        %INCLUDE AS_SSUBS_C;
       60     3824        %INCLUDE B_ERRORS_C;
       61     4951        %INCLUDE CP_6_SUBS;
       62     5491        %INCLUDE KL_SUPER_C;
       63     8393        %INCLUDE XU_MACRO_C;
       64    11499        %INCLUDE XU_FORMAT_C;
       65    11661        %INCLUDE AS_SUPER_R;
       66    14677        /********************************************************************/
       67    14678        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       68    14679        /********************************************************************/
       69    14680        %ASW$PREC_WSN ;
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:16   
       70    14683        %ASW$READ_WSN ;
       71    14686        %ASW$READ_WSN_SEQ ;
       72    14689        %ASH$ERROR ;
       73    14692        %ASH$WARN ;
       74    14695        %ASH$INFO ;
       75    14698        %ASL$DISP_ONE_WORKSTATION ;
       76    14701        %ASB$WILD_MATCH ;
       77    14704    1   DCL X$FORMAT ENTRY(1) ;
       78    14705        /********************************************************************/
       79    14706        /*   Local based     local based     local based     local based    */
       80    14707        /********************************************************************/
       81    14708        %PARSE$OUT ( NAME = P$B, STCLASS = "BASED(NODE$)",
       82    14709                     NDTYPE = TYPE, NSUBLKS = NSUBLKS);
       83    14754        %PARSE$SYM ( NAME = P$S, STCLASS = BASED);
       84    14792        /********************************************************************/
       85    14793        /*   Auto data       auto data       auto data       auto data      */
       86    14794        /********************************************************************/
       87    14795    1   DCL ALL_WSNS                 BIT(1);
       88    14796    1   DCL 1 BEGIN_KEY ,
       89    14797    1          2 COUNT               UBIN BYTE,
       90    14798    1          2 TEXT                CHAR(8);
       91    14799    1   DCL CODE2                    UBIN;
       92    14800    1   DCL CURRENT_WSN              CHAR(8);
       93    14801    1   DCL DISP                     BIT(1);
       94    14802    1   DCL DISP_WSNS                SBIN;
       95    14803    1   DCL 1 END_KEY ,
       96    14804    1          2 COUNT               UBIN BYTE,
       97    14805    1          2 TEXT                CHAR(8);
       98    14806    1   DCL FOUND                    BIT(1);
       99    14807    1   DCL I                        UBIN;
      100    14808    1   DCL J                        UBIN;
      101    14809    1   DCL JCL                      BIT(1);
      102    14810    1   DCL 1 TNAME ,
      103    14811    1          2 COUNT               UBIN BYTE,
      104    14812    1          2 TEXT                CHAR(8);
      105    14813    1   DCL WILD_CARD                BIT(1);
      106    14814    1   DCL WSN_ARS                  UBIN;
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:17   
      107    14815        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:18   
      108    14816        /********************************************************************/
      109    14817        /*   Constant data   constant data   constant data   constant data  */
      110    14818        /********************************************************************/
      111    14819    1   DCL WSN_STR                  CHAR(0) CONSTANT INIT ('workstation');
      112    14820    1   DCL WSNS_STR                 CHAR(0) CONSTANT INIT ('workstations');
      113    14821    1   DCL LIST_STR                 CHAR(0) CONSTANT INIT ('listed');
      114    14822    1   DCL DISPLAY_STR              CHAR(0) CONSTANT INIT ('displayed');
      115    14823        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:19   
      116    14824        /********************************************************************/
      117    14825        /*   Procedure       procedure       procedure       procedure      */
      118    14826        /********************************************************************/
      119    14827    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;

  14827  2 000002   000003 470400 xsym               LDP0    P_PCB+3
         2 000003   000003 471500                    LDP1    3,,PR0
         2 000004   100000 236100                    LDQ     0,,PR1
         2 000005   777777 376007                    ANQ     -1,DL
         2 000006   000000 756000 xsym               STQ     CODE

      120    14828    1   JCL = %NO#;

  14828  2 000007   200022 450100                    STZ     JCL,,AUTO

      121    14829    1   WILD_CARD = %NO#;

  14829  2 000010   200026 450100                    STZ     WILD_CARD,,AUTO

      122    14830    1   TNAME.TEXT = '?';

  14830  2 000011   000000 235000 3                  LDA     0
         2 000012   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 000013   200024 757100                    STAQ    TNAME+1,,AUTO

      123    14831    1   TNAME.COUNT = 1;

  14831  2 000014   001000 236003                    LDQ     512,DU
         2 000015   200023 756100                    STQ     TNAME,,AUTO

      124    14832    1   DISP_WSNS = 0;

  14832  2 000016   200013 450100                    STZ     DISP_WSNS,,AUTO

      125    14833
      126    14834    2   DO SELECT (CODE);

PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:20   
  14834  2 000017   000000 236000 xsym               LDQ     CODE
         2 000020   000022 116007                    CMPQ    18,DL
         2 000021   000032 602000 2                  TNC     s:14834+11
         2 000022   000035 600000 2                  TZE     s:14838
         2 000023   000144 116007                    CMPQ    100,DL
         2 000024   000027 602000 2                  TNC     s:14834+8
         2 000025   000037 600000 2                  TZE     s:14842
         2 000026   000164 710000 2                  TRA     s:14880
         2 000027   000143 116007                    CMPQ    99,DL
         2 000030   000164 601000 2                  TNZ     s:14880
         2 000031   000113 710000 2                  TRA     s:14859
         2 000032   000003 116007                    CMPQ    3,DL
         2 000033   000164 601000 2                  TNZ     s:14880
         2 000034   000071 710000 2                  TRA     s:14850

      127    14835
      128    14836    2      SELECT (%LIST_ALL_VAL);

      129    14837
      130    14838    2      DISP = %NO#;

  14838  2 000035   200012 450100                    STZ     DISP,,AUTO
         2 000036   000164 710000 2                  TRA     s:14880

      131    14839
      132    14840    2      SELECT (%DISPLAY_ALL_VAL);

      133    14841
      134    14842    2      DISP = %YES#;

  14842  2 000037   400000 236003                    LDQ     -131072,DU
         2 000040   200012 756100                    STQ     DISP,,AUTO

      135    14843    2      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN

  14843  2 000041   000003 471500                    LDP1    3,,PR0
         2 000042   100001 220100                    LDX0    1,,PR1
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:21   
         2 000043   000002 100003                    CMPX0   2,DU
         2 000044   000056 601000 2                  TNZ     s:14845

      136    14844    2         JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL);

  14844  2 000045   100004 473500                    LDP3    4,,PR1
         2 000046   400000 221003                    LDX1    -131072,DU
         2 000047   300000 722100                    LXL2    0,,PR3
         2 000050   000001 102003                    CMPX2   1,DU
         2 000051   000053 600000 2                  TZE     s:14844+6
         2 000052   000000 221003                    LDX1    0,DU
         2 000053   000000 636011                    EAQ     0,X1
         2 000054   200022 756100                    STQ     JCL,,AUTO
         2 000055   000164 710000 2                  TRA     s:14880

      137    14845    2      ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN

  14845  2 000056   000000 100003                    CMPX0   0,DU
         2 000057   000164 600000 2                  TZE     s:14880

      138    14846    2            JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL);

  14846  2 000060   100003 473500                    LDP3    3,,PR1
         2 000061   400000 221003                    LDX1    -131072,DU
         2 000062   300000 722100                    LXL2    0,,PR3
         2 000063   000001 102003                    CMPX2   1,DU
         2 000064   000066 600000 2                  TZE     s:14846+6
         2 000065   000000 221003                    LDX1    0,DU
         2 000066   000000 636011                    EAQ     0,X1
         2 000067   200022 756100                    STQ     JCL,,AUTO
         2 000070   000164 710000 2                  TRA     s:14880

      139    14847
      140    14848    2      SELECT (%LIST_WSN_VAL);

      141    14849
      142    14850    2      DISP = %NO#;
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:22   

  14850  2 000071   200012 450100                    STZ     DISP,,AUTO

      143    14851    2      JCL = %NO#;

  14851  2 000072   200022 450100                    STZ     JCL,,AUTO

      144    14852    3      IF P_PCB.OUT$->P$B.NSUBLKS > 1 THEN DO;

  14852  2 000073   000001 220100                    LDX0    1,,PR0
         2 000074   000002 100003                    CMPX0   2,DU
         2 000075   000164 602000 2                  TNC     s:14880

      145    14853    3         TNAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;

  14853  2 000076   000004 471500                    LDP1    4,,PR0
         2 000077   100004 236100                    LDQ     4,,PR1
         2 000100   000033 772000                    QRL     27
         2 000101   000000 621006                    EAX1    0,QL
         2 000102   040100 100540                    MLR     fill='040'O
         2 000103   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         2 000104   200024 000010                    ADSC9   TNAME+1,,AUTO            cn=0,n=8

      146    14854    3         TNAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;

  14854  2 000105   000004 471500                    LDP1    4,,PR0
         2 000106   100004 236100                    LDQ     4,,PR1
         2 000107   000033 772000                    QRL     27
         2 000110   000033 736000                    QLS     27
         2 000111   200023 756100                    STQ     TNAME,,AUTO

      147    14855    3         END; /*  Number of sublocks > 1  */

  14855  2 000112   000164 710000 2                  TRA     s:14880

      148    14856
      149    14857    2      SELECT (%DISPLAY_WSN_VAL);
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:23   

      150    14858
      151    14859    2      DISP = %YES#;

  14859  2 000113   400000 236003                    LDQ     -131072,DU
         2 000114   200012 756100                    STQ     DISP,,AUTO

      152    14860    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;

  14860  2 000115   000001 235007                    LDA     1,DL
         2 000116   200020 755100                    STA     I,,AUTO
         2 000117   000157 710000 2                  TRA     s:14876+3

      153    14861    3         CODE2 = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;

  14861  2 000120   000003 470400 xsym               LDP0    P_PCB+3
         2 000121   200020 720100                    LXL0    I,,AUTO
         2 000122   000003 471510                    LDP1    3,X0,PR0
         2 000123   100000 236100                    LDQ     0,,PR1
         2 000124   777777 376007                    ANQ     -1,DL
         2 000125   200007 756100                    STQ     CODE2,,AUTO

      154    14862
      155    14863    4         DO SELECT (CODE2);

  14863  2 000126   000313 116007                    CMPQ    203,DL
         2 000127   000132 602000 2                  TNC     s:14863+4
         2 000130   000135 600000 2                  TZE     s:14867
         2 000131   000154 710000 2                  TRA     s:14876
         2 000132   000001 116007                    CMPQ    1,DL
         2 000133   000154 601000 2                  TNZ     s:14876
         2 000134   000152 710000 2                  TRA     s:14872

      156    14864
      157    14865    4            SELECT (%WSN_NAME_WILD_VAL);

      158    14866
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:24   
      159    14867    4            TNAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;

  14867  2 000135   000004 473500                    LDP3    4,,PR0
         2 000136   300004 236100                    LDQ     4,,PR3
         2 000137   000033 772000                    QRL     27
         2 000140   000000 621006                    EAX1    0,QL
         2 000141   040100 100540                    MLR     fill='040'O
         2 000142   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         2 000143   200024 000010                    ADSC9   TNAME+1,,AUTO            cn=0,n=8

      160    14868    4            TNAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;

  14868  2 000144   000004 471500                    LDP1    4,,PR0
         2 000145   100004 236100                    LDQ     4,,PR1
         2 000146   000033 772000                    QRL     27
         2 000147   000033 736000                    QLS     27
         2 000150   200023 756100                    STQ     TNAME,,AUTO
         2 000151   000154 710000 2                  TRA     s:14876

      161    14869
      162    14870    4            SELECT (%JCL_VAL);

      163    14871
      164    14872    4            JCL = %YES#;

  14872  2 000152   400000 236003                    LDQ     -131072,DU
         2 000153   200022 756100                    STQ     JCL,,AUTO

      165    14873
      166    14874    4            END;  /* Do case (CODE2) */

      167    14875
      168    14876    3         END;  /*  Do i  */

  14876  2 000154   200020 235100                    LDA     I,,AUTO
         2 000155   000001 035007                    ADLA    1,DL
         2 000156   200020 755100                    STA     I,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:25   
         2 000157   000001 236100                    LDQ     1,,PR0
         2 000160   000022 772000                    QRL     18
         2 000161   200020 116100                    CMPQ    I,,AUTO
         2 000162   000164 600000 2                  TZE     s:14880
         2 000163   000120 603000 2                  TRC     s:14861

      169    14877
      170    14878    2      END;  /*  Do case (code)  */

      171    14879
      172    14880    1   IF TNAME.TEXT = '?' THEN

  14880  2 000164   200024 237100                    LDAQ    TNAME+1,,AUTO
         2 000165   000002 117000 3                  CMPAQ   2
         2 000166   000172 601000 2                  TNZ     s:14883

      173    14881    1      ALL_WSNS = %YES#;

  14881  2 000167   400000 236003                    LDQ     -131072,DU
         2 000170   200003 756100                    STQ     ALL_WSNS,,AUTO
         2 000171   000234 710000 2                  TRA     s:14897

      174    14882    2   ELSE DO;

      175    14883    2      ALL_WSNS = %NO#;

  14883  2 000172   200003 450100                    STZ     ALL_WSNS,,AUTO

      176    14884    2      BEGIN_KEY.TEXT = ' ';

  14884  2 000173   000035 235000 xsym               LDA     B_VECTNIL+29
         2 000174   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 000175   200005 755100                    STA     BEGIN_KEY+1,,AUTO
         2 000176   200006 756100                    STQ     BEGIN_KEY+2,,AUTO

      177    14885    3      CALL INDEX (I,'?',TNAME.TEXT) WHENRETURN DO;

PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:26   
  14885  2 000177   000000 124500                    SCM     mask='000'O
         2 000200   200024 000010                    ADSC9   TNAME+1,,AUTO            cn=0,n=8
         2 000201   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000202   200020 000100                    ARG     I,,AUTO
         2 000203   000233 606400 2                  TTN     s:14893

      178    14886    3         BEGIN_KEY.TEXT = SUBSTR(TNAME.TEXT,0,I);

  14886  2 000204   200020 720100                    LXL0    I,,AUTO
         2 000205   040100 100540                    MLR     fill='040'O
         2 000206   200024 000010                    ADSC9   TNAME+1,,AUTO            cn=0,n=*X0
         2 000207   200005 000010                    ADSC9   BEGIN_KEY+1,,AUTO        cn=0,n=8

      179    14887    3         BEGIN_KEY.COUNT = 8;

  14887  2 000210   010000 236003                    LDQ     4096,DU
         2 000211   200004 756100                    STQ     BEGIN_KEY,,AUTO

      180    14888    3         CALL CONCAT (END_KEY.TEXT,SUBSTR(TNAME.TEXT,0,I),'~');

  14888  2 000212   040100 100540                    MLR     fill='040'O
         2 000213   200024 000010                    ADSC9   TNAME+1,,AUTO            cn=0,n=*X0
         2 000214   200015 000010                    ADSC9   END_KEY+1,,AUTO          cn=0,n=8
         2 000215   200020 236100                    LDQ     I,,AUTO
         2 000216   000010 116007                    CMPQ    8,DL
         2 000217   000225 603000 2                  TRC     s:14889
         2 000220   777767 621006                    EAX1    -9,QL
         2 000221   777777 661003                    ERX1    -1,DU
         2 000222   040146 100400                    MLR     fill='040'O
         2 000223   000001 000001 3                  ADSC9   1                        cn=0,n=1
         2 000224   200015 000011                    ADSC9   END_KEY+1,Q,AUTO         cn=0,n=*X1

      181    14889    3         END_KEY.COUNT = I + 1;

  14889  2 000225   000001 036007                    ADLQ    1,DL
         2 000226   000033 736000                    QLS     27
         2 000227   200014 756100                    STQ     END_KEY,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:27   

      182    14890    3         WILD_CARD = %YES#;

  14890  2 000230   400000 236003                    LDQ     -131072,DU
         2 000231   200026 756100                    STQ     WILD_CARD,,AUTO

      183    14891    3         END;  /*  Whenreturn from index  */

  14891  2 000232   000234 710000 2                  TRA     s:14897

      184    14892    3      WHENALTRETURN DO;

      185    14893    3         WILD_CARD = %NO#;

  14893  2 000233   200026 450100                    STZ     WILD_CARD,,AUTO

      186    14894    3         END;  /* Whenaltreturn  */

      187    14895    2      END;  /*  Else  */

      188    14896
      189    14897    1   FDS.NVECS# = 0;

  14897  2 000234   000011 450000 xsym               STZ     FDS+9

      190    14898    1   FDS.WRAPTAB# = 1;

  14898  2 000235   000001 235007                    LDA     1,DL
         2 000236   000016 755000 xsym               STA     FDS+14

      191    14899    2   IF JCL THEN DO;

  14899  2 000237   200022 234100                    SZN     JCL,,AUTO
         2 000240   000256 605000 2                  TPL     s:14904

      192    14900    2      CALL CONCAT (FMT_BUF, '%1/"', WSNS_STR, '%1/');

PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:28   
  14900  2 000241   000013 236000 1                  LDQ     DISPLAY_STR+3
         2 000242   000000 756000 xsym               STQ     FMT_BUF
         2 000243   040000 100400                    MLR     fill='040'O
         2 000244   000003 000014 1                  ADSC9   WSNS_STR                 cn=0,n=12
         2 000245   000001 000014 xsym               ADSC9   FMT_BUF+1                cn=0,n=12
         2 000246   040000 100400                    MLR     fill='040'O
         2 000247   000013 000003 1                  ADSC9   DISPLAY_STR+3            cn=0,n=3
         2 000250   000004 000357 xsym               ADSC9   FMT_BUF+4                cn=0,n=239

      193    14901    2      FDS.FMT_.BOUND = LENGTHC (WSNS_STR) + 6;

  14901  2 000251   000000 236000 xsym               LDQ     FDS
         2 000252   177777 376007                    ANQ     65535,DL
         2 000253   000004 276000 3                  ORQ     4
         2 000254   000000 756000 xsym               STQ     FDS

      194    14902    2      END;   /*  Jcl  */

  14902  2 000255   000274 710000 2                  TRA     s:14907

      195    14903    2   ELSE DO;

      196    14904    2      CALL CONCAT (FMT_BUF, '%1/', WSNS_STR, '%1/');

  14904  2 000256   000013 236000 1                  LDQ     DISPLAY_STR+3
         2 000257   000005 376000 3                  ANQ     5
         2 000260   000040 276007                    ORQ     32,DL
         2 000261   000000 756000 xsym               STQ     FMT_BUF
         2 000262   040000 100400                    MLR     fill='040'O
         2 000263   000003 000014 1                  ADSC9   WSNS_STR                 cn=0,n=12
         2 000264   000000 600014 xsym               ADSC9   FMT_BUF                  cn=3,n=12
         2 000265   040000 100400                    MLR     fill='040'O
         2 000266   000013 000003 1                  ADSC9   DISPLAY_STR+3            cn=0,n=3
         2 000267   000003 600360 xsym               ADSC9   FMT_BUF+3                cn=3,n=240

      197    14905    2      FDS.FMT_.BOUND = LENGTHC (WSNS_STR) + 5;

PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:29   
  14905  2 000270   000000 236000 xsym               LDQ     FDS
         2 000271   177777 376007                    ANQ     65535,DL
         2 000272   000006 276000 3                  ORQ     6
         2 000273   000000 756000 xsym               STQ     FDS

      198    14906    2      END; /*  Not jcl  */

      199    14907    1   FDS.TABDFLT# = 10;

  14907  2 000274   000012 235007                    LDA     10,DL
         2 000275   000017 755000 xsym               STA     FDS+15

      200    14908    1   CALL X$FORMAT (FDS);

  14908  2 000276   000007 630400 3                  EPPR0   7
         2 000277   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000300   000000 701000 xent               TSX1    X$FORMAT
         2 000301   000000 011000                    NOP     0

      201    14909
      202    14910    2   IF ALL_WSNS THEN DO;

  14910  2 000302   200003 234100                    SZN     ALL_WSNS,,AUTO
         2 000303   000310 605000 2                  TPL     s:14913

      203    14911    2      USERS_KEY = '001000'O;     /* To precord to begin of workstations */

  14911  2 000304   000000 100400                    MLR     fill='000'O
         2 000305   000033 000002 xsym               ADSC9   B_VECTNIL+27             cn=0,n=2
         2 000306   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      204    14912    2      END;  /*  ALL_WSNS  */

  14912  2 000307   000437 710000 2                  TRA     s:14963

      205    14913    2   ELSE IF WILD_CARD THEN DO;

PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:30   
  14913  2 000310   200026 234100                    SZN     WILD_CARD,,AUTO
         2 000311   000323 605000 2                  TPL     s:14918

      206    14914    2         CALL CONCAT (USERS_KEY.TXTC,BEGIN_KEY.TEXT,'*');

  14914  2 000312   040000 100500                    MLR     fill='040'O
         2 000313   200005 000010                    ADSC9   BEGIN_KEY+1,,AUTO        cn=0,n=8
         2 000314   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000315   040000 100400                    MLR     fill='040'O
         2 000316   000010 000001 3                  ADSC9   8                        cn=0,n=1
         2 000317   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      207    14915    2         USERS_KEY.COUNT = 9;

  14915  2 000320   011000 236003                    LDQ     4608,DU
         2 000321   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      208    14916    2         END; /*  WILD_CARD  */

  14916  2 000322   000437 710000 2                  TRA     s:14963

      209    14917    2      ELSE DO;  /*  Single wsn  */

      210    14918    2         CALL CONCAT (USERS_KEY.TXTC,TNAME.TEXT,'*');

  14918  2 000323   040000 100500                    MLR     fill='040'O
         2 000324   200024 000010                    ADSC9   TNAME+1,,AUTO            cn=0,n=8
         2 000325   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000326   040000 100400                    MLR     fill='040'O
         2 000327   000010 000001 3                  ADSC9   8                        cn=0,n=1
         2 000330   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      211    14919    2         USERS_KEY.COUNT = 9;

  14919  2 000331   011000 236003                    LDQ     4608,DU
         2 000332   000000 552040 xsym               STBQ    USERS_KEY,'40'O

PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:31   
      212    14920    2         WSN_ARS = DSEG1SIZE;

  14920  2 000333   000000 235000 xsym               LDA     DSEG1SIZE
         2 000334   200027 755100                    STA     WSN_ARS,,AUTO

      213    14921    2         CALL ASW$READ_WSN (DSEG1$,WSN_ARS)

  14921  2 000335   200027 630500                    EPPR0   WSN_ARS,,AUTO
         2 000336   200031 450500                    STP0    WSN_ARS+2,,AUTO
         2 000337   000011 236000 3                  LDQ     9
         2 000340   200030 756100                    STQ     WSN_ARS+1,,AUTO
         2 000341   200030 630500                    EPPR0   WSN_ARS+1,,AUTO
         2 000342   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000343   000000 701000 xent               TSX1    ASW$READ_WSN
         2 000344   000407 702000 2                  TSX2    s:14934

      214    14922    3         WHENRETURN DO;

      215    14923    3            IF DISP THEN

  14923  2 000345   200012 234100                    SZN     DISP,,AUTO
         2 000346   000356 605000 2                  TPL     s:14928

      216    14924    4            DO;

      217    14925    4               CALL ASL$DISP_ONE_WORKSTATION (JCL);

  14925  2 000347   200022 630500                    EPPR0   JCL,,AUTO
         2 000350   200030 450500                    STP0    WSN_ARS+1,,AUTO
         2 000351   200030 630500                    EPPR0   WSN_ARS+1,,AUTO
         2 000352   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000353   000000 701000 xent               TSX1    ASL$DISP_ONE_WORKSTATION
         2 000354   000000 011000                    NOP     0

      218    14926    4               END; /*  If disp  */

  14926  2 000355   000406 710000 2                  TRA     s:14932
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:32   

      219    14927    4            ELSE DO;

      220    14928    4               CALL CONCAT (FMT_BUF, SUBSTR(TNAME.TEXT,0,TNAME.COUNT), '%1/');

  14928  2 000356   200023 236100                    LDQ     TNAME,,AUTO
         2 000357   000033 772000                    QRL     27
         2 000360   000000 620006                    EAX0    0,QL
         2 000361   040000 100540                    MLR     fill='040'O
         2 000362   200024 000010                    ADSC9   TNAME+1,,AUTO            cn=0,n=*X0
         2 000363   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255
         2 000364   000377 116007                    CMPQ    255,DL
         2 000365   000373 603000 2                  TRC     s:14929
         2 000366   777400 620006                    EAX0    -256,QL
         2 000367   777777 660003                    ERX0    -1,DU
         2 000370   040046 100400                    MLR     fill='040'O
         2 000371   000013 000003 1                  ADSC9   DISPLAY_STR+3            cn=0,n=3
         2 000372   000000 000010 xsym               ADSC9   FMT_BUF,Q                cn=0,n=*X0

      221    14929    4               FDS.FMT_.BOUND = TNAME.COUNT + 2;

  14929  2 000373   200023 236100                    LDQ     TNAME,,AUTO
         2 000374   000033 772000                    QRL     27
         2 000375   000002 036007                    ADLQ    2,DL
         2 000376   000020 736000                    QLS     16
         2 000377   000000 676000 xsym               ERQ     FDS
         2 000400   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000401   000000 656000 xsym               ERSQ    FDS

      222    14930    4               CALL X$FORMAT (FDS);

  14930  2 000402   000007 630400 3                  EPPR0   7
         2 000403   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000404   000000 701000 xent               TSX1    X$FORMAT
         2 000405   000000 011000                    NOP     0

      223    14931    4               END; /*  Else  disp  */
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:33   

      224    14932    3            END;  /*  Whenreturn  */

  14932  2 000406   000436 710000 2                  TRA     s:14961

      225    14933    3         WHENALTRETURN DO;

      226    14934    3            IF MERR_CODE.CODE = %E$NOKEY

  14934  2 000407   000000 236000 xsym               LDQ     ERR_CODE
         2 000410   377770 376007                    ANQ     131064,DL
         2 000411   001020 116007                    CMPQ    528,DL
         2 000412   000432 601000 2                  TNZ     s:14958

      227    14935    4            THEN DO;

      228    14936        /*E* ERROR:   ASL-E$WSN_NO_EXIST-C
      229    14937             MESSAGE: The WSN %U1 does not exist.
      230    14938        */
      231    14939    4               AS_FIELD1.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;

  14939  2 000413   000003 470400 xsym               LDP0    P_PCB+3
         2 000414   000004 471500                    LDP1    4,,PR0
         2 000415   100004 236100                    LDQ     4,,PR1
         2 000416   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      232    14940    4               AS_FIELD1.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;

  14940  2 000417   100004 236100                    LDQ     4,,PR1
         2 000420   000033 772000                    QRL     27
         2 000421   000000 620006                    EAX0    0,QL
         2 000422   040000 100540                    MLR     fill='040'O
         2 000423   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         2 000424   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      233    14941                    %SCREAM( ERR#=E$WSN_NO_EXIST, MID='L', LEVEL=ERROR );

PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:34   
  14953  2 000425   000012 630400 3                  EPPR0   10
         2 000426   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000427   000000 701000 xent               TSX1    ASH$ERROR
         2 000430   000000 011000                    NOP     0

      234    14956    4               END;  /*  Error = nokey  */

  14956  2 000431   000436 710000 2                  TRA     s:14961

      235    14957    4            ELSE DO;

      236    14958    4               CALL ASH$ERROR( MERR_CODE );

  14958  2 000432   000013 630400 3                  EPPR0   11
         2 000433   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000434   000000 701000 xent               TSX1    ASH$ERROR
         2 000435   000000 011000                    NOP     0

      237    14959    4               END;  /* Error ~= nokey */

      238    14960    3            END;  /*  Whenaltreturn  */

      239    14961    2         RETURN;

  14961  2 000436   000000 702200 xent               TSX2  ! X66_ARET

      240    14962    2         END; /*  Else  */
      241    14963    1   CALL ASW$PREC_WSN ;

  14963  2 000437   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000440   000000 701000 xent               TSX1    ASW$PREC_WSN
         2 000441   000000 011000                    NOP     0

      242    14964    2   DO FOREVER;

      243    14965
      244    14966    3      DO UNTIL (USERS_KEY.COUNT = 9);
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:35   

      245    14967    3         WSN_ARS = DSEG1SIZE;

  14967  2 000442   000000 235000 xsym               LDA     DSEG1SIZE
         2 000443   200027 755100                    STA     WSN_ARS,,AUTO

      246    14968    3         CALL ASW$READ_WSN_SEQ (DSEG1$,WSN_ARS)

  14968  2 000444   200027 630500                    EPPR0   WSN_ARS,,AUTO
         2 000445   200031 450500                    STP0    WSN_ARS+2,,AUTO
         2 000446   000011 236000 3                  LDQ     9
         2 000447   200030 756100                    STQ     WSN_ARS+1,,AUTO
         2 000450   200030 630500                    EPPR0   WSN_ARS+1,,AUTO
         2 000451   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000452   000000 701000 xent               TSX1    ASW$READ_WSN_SEQ
         2 000453   000455 702000 2                  TSX2    s:14970
         2 000454   000466 710000 2                  TRA     s:14973

      247    14969    4         WHENALTRETURN DO;

      248    14970    4            IF MERR_CODE.CODE ~= %E$EOF THEN CALL ASH$ERROR(MERR_CODE);

  14970  2 000455   000000 236000 xsym               LDQ     ERR_CODE
         2 000456   377770 376007                    ANQ     131064,DL
         2 000457   000060 116007                    CMPQ    48,DL
         2 000460   000465 600000 2                  TZE     s:14971

  14970  2 000461   000013 630400 3                  EPPR0   11
         2 000462   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000463   000000 701000 xent               TSX1    ASH$ERROR
         2 000464   000000 011000                    NOP     0

      249    14971    4            GOTO FINISH_UP;

  14971  2 000465   000611 710000 2                  TRA     FINISH_UP

      250    14972    4            END;  /*  Whenaltreturn  */
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:36   
      251    14973    3         END;  /*  Do until we find a wsn record  */

  14973  2 000466   000000 236000 xsym               LDQ     USERS_KEY
         2 000467   777000 376003                    ANQ     -512,DU
         2 000470   011000 116003                    CMPQ    4608,DU
         2 000471   000442 601000 2                  TNZ     s:14967

      252    14974    2      CALL INDEX (I, ' ',USERS_KEY.TXTC,0);

  14974  2 000472   000000 124400                    SCM     mask='000'O
         2 000473   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         2 000474   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000475   200020 000100                    ARG     I,,AUTO

      253    14975    2      IF I > 8 THEN I = 8;

  14975  2 000476   200020 235100                    LDA     I,,AUTO
         2 000477   000011 115007                    CMPA    9,DL
         2 000500   000503 602000 2                  TNC     s:14976

  14975  2 000501   000010 235007                    LDA     8,DL
         2 000502   200020 755100                    STA     I,,AUTO

      254    14976    2      CURRENT_WSN = SUBSTR(USERS_KEY.TXTC,0,I);

  14976  2 000503   000000 620005                    EAX0    0,AL
         2 000504   040100 100440                    MLR     fill='040'O
         2 000505   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=*X0
         2 000506   200010 000010                    ADSC9   CURRENT_WSN,,AUTO        cn=0,n=8

      255    14977    3      IF WILD_CARD THEN DO;

  14977  2 000507   200026 234100                    SZN     WILD_CARD,,AUTO
         2 000510   000536 605000 2                  TPL     s:14987

      256    14978    3         J = TNAME.COUNT;

PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:37   
  14978  2 000511   200023 236100                    LDQ     TNAME,,AUTO
         2 000512   000033 772000                    QRL     27
         2 000513   200021 756100                    STQ     J,,AUTO

      257    14979    3         CALL ASB$WILD_MATCH (I, CURRENT_WSN, J, TNAME.TEXT)

  14979  2 000514   200024 630500                    EPPR0   TNAME+1,,AUTO
         2 000515   200033 450500                    STP0    WSN_ARS+4,,AUTO
         2 000516   200021 631500                    EPPR1   J,,AUTO
         2 000517   200032 451500                    STP1    WSN_ARS+3,,AUTO
         2 000520   200010 633500                    EPPR3   CURRENT_WSN,,AUTO
         2 000521   200031 453500                    STP3    WSN_ARS+2,,AUTO
         2 000522   200020 634500                    EPPR4   I,,AUTO
         2 000523   200030 454500                    STP4    WSN_ARS+1,,AUTO
         2 000524   200030 630500                    EPPR0   WSN_ARS+1,,AUTO
         2 000525   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000526   000000 701000 xent               TSX1    ASB$WILD_MATCH
         2 000527   000531 702000 2                  TSX2    s:14981
         2 000530   000536 710000 2                  TRA     s:14987

      258    14980    4         WHENALTRETURN DO;

      259    14981    4            IF CURRENT_WSN > END_KEY.TEXT THEN

  14981  2 000531   040100 106500                    CMPC    fill='040'O
         2 000532   200015 000010                    ADSC9   END_KEY+1,,AUTO          cn=0,n=8
         2 000533   200010 000010                    ADSC9   CURRENT_WSN,,AUTO        cn=0,n=8
         2 000534   000611 602000 2                  TNC     FINISH_UP

      260    14982    4               GOTO FINISH_UP;
      261    14983    4            ELSE
      262    14984    4               GOTO END_FOREVER;

  14984  2 000535   000610 710000 2                  TRA     END_FOREVER

      263    14985    4            END;  /*  Whenaltreturn  */
      264    14986    3         END;  /*  WILD_CARD  */
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:38   

      265    14987    2      IF DISP THEN

  14987  2 000536   200012 234100                    SZN     DISP,,AUTO
         2 000537   000547 605000 2                  TPL     s:14992

      266    14988    3      DO;

      267    14989    3         CALL ASL$DISP_ONE_WORKSTATION (JCL);

  14989  2 000540   200022 630500                    EPPR0   JCL,,AUTO
         2 000541   200030 450500                    STP0    WSN_ARS+1,,AUTO
         2 000542   200030 630500                    EPPR0   WSN_ARS+1,,AUTO
         2 000543   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000544   000000 701000 xent               TSX1    ASL$DISP_ONE_WORKSTATION
         2 000545   000000 011000                    NOP     0

      268    14990    3         END; /*  If disp  */

  14990  2 000546   000607 710000 2                  TRA     s:15002

      269    14991    3      ELSE DO;

      270    14992    4         IF DISP_WSNS = 0 THEN DO;

  14992  2 000547   200013 235100                    LDA     DISP_WSNS,,AUTO
         2 000550   000566 601000 2                  TNZ     s:14997

      271    14993    4            CALL CONCAT (FMT_BUF, '%\', SUBSTR(CURRENT_WSN,0,I));

  14993  2 000551   000015 220000 1                  LDX0    DISPLAY_STR+5
         2 000552   000000 740000 xsym               STX0    FMT_BUF
         2 000553   200020 721100                    LXL1    I,,AUTO
         2 000554   040000 100540                    MLR     fill='040'O
         2 000555   200010 000011                    ADSC9   CURRENT_WSN,,AUTO        cn=0,n=*X1
         2 000556   000000 400375 xsym               ADSC9   FMT_BUF                  cn=2,n=253

PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:39   
      272    14994    4            FDS.FMT_.BOUND = I + 1;

  14994  2 000557   200020 236100                    LDQ     I,,AUTO
         2 000560   000001 036007                    ADLQ    1,DL
         2 000561   000020 736000                    QLS     16
         2 000562   000000 676000 xsym               ERQ     FDS
         2 000563   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000564   000000 656000 xsym               ERSQ    FDS

      273    14995    4            END;  /*  DISP_WSNS = 0  */

  14995  2 000565   000603 710000 2                  TRA     s:15000

      274    14996    4         ELSE DO;

      275    14997    4            CALL CONCAT (FMT_BUF, '%\%-%10R', SUBSTR(CURRENT_WSN,0,I));

  14997  2 000566   000016 237000 1                  LDAQ    DISPLAY_STR+6
         2 000567   000000 755000 xsym               STA     FMT_BUF
         2 000570   000001 756000 xsym               STQ     FMT_BUF+1
         2 000571   200020 720100                    LXL0    I,,AUTO
         2 000572   040000 100540                    MLR     fill='040'O
         2 000573   200010 000010                    ADSC9   CURRENT_WSN,,AUTO        cn=0,n=*X0
         2 000574   000002 000367 xsym               ADSC9   FMT_BUF+2                cn=0,n=247

      276    14998    4            FDS.FMT_.BOUND = I + 7;

  14998  2 000575   200020 236100                    LDQ     I,,AUTO
         2 000576   000007 036007                    ADLQ    7,DL
         2 000577   000020 736000                    QLS     16
         2 000600   000000 676000 xsym               ERQ     FDS
         2 000601   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000602   000000 656000 xsym               ERSQ    FDS

      277    14999    4            END;  /*  Else  */

      278    15000    3         CALL X$FORMAT (FDS);
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:40   

  15000  2 000603   000007 630400 3                  EPPR0   7
         2 000604   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000605   000000 701000 xent               TSX1    X$FORMAT
         2 000606   000000 011000                    NOP     0

      279    15001    3         END; /*  Else  disp  */

      280    15002    2      DISP_WSNS = DISP_WSNS + 1;

  15002  2 000607   200013 054100                    AOS     DISP_WSNS,,AUTO

      281    15003    2   END_FOREVER:
      282    15004    2      END;  /*  Do forever  */

  15004  2 000610   000442 710000 2     END_FOREVER  TRA     s:14967

      283    15005    1   FINISH_UP:
      284    15006    2   IF NOT DISP THEN DO;

  15006  2 000611   200012 234100       FINISH_UP    SZN     DISP,,AUTO
         2 000612   000627 604000 2                  TMI     s:15012

      285    15007    2      FMT_BUF = '%\%/';

  15007  2 000613   040000 100400                    MLR     fill='040'O
         2 000614   000020 000004 1                  ADSC9   DISPLAY_STR+8            cn=0,n=4
         2 000615   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      286    15008    2      FDS.FMT_.BOUND = 3;

  15008  2 000616   000000 236000 xsym               LDQ     FDS
         2 000617   177777 376007                    ANQ     65535,DL
         2 000620   600000 276007                    ORQ     -65536,DL
         2 000621   000000 756000 xsym               STQ     FDS

      287    15009    2      FDS.NVECS# = 0;
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:41   

  15009  2 000622   000011 450000 xsym               STZ     FDS+9

      288    15010    2      CALL X$FORMAT(FDS);

  15010  2 000623   000007 630400 3                  EPPR0   7
         2 000624   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000625   000000 701000 xent               TSX1    X$FORMAT
         2 000626   000000 011000                    NOP     0

      289    15011    2      END; /*  If not disp  */

      290    15012    2   IF NOT JCL THEN DO;

  15012  2 000627   200022 234100                    SZN     JCL,,AUTO
         2 000630   000677 604000 2                  TMI     s:15033

      291    15013    2      FMT_VEC(0) = VECTOR (DISP_WSNS);

  15013  2 000631   777640 235007                    LDA     -96,DL
         2 000632   200030 452500                    STP2    WSN_ARS+1,,AUTO
         2 000633   200030 236100                    LDQ     WSN_ARS+1,,AUTO
         2 000634   000013 036003                    ADLQ    11,DU
         2 000635   000000 755000 xsym               STA     FMT_VEC
         2 000636   000001 756000 xsym               STQ     FMT_VEC+1

      292    15014    2      IF DISP_WSNS = 1 THEN

  15014  2 000637   200013 235100                    LDA     DISP_WSNS,,AUTO
         2 000640   000001 115007                    CMPA    1,DL
         2 000641   000646 601000 2                  TNZ     s:15019

      293    15015    3      DO;

      294    15016    3         FMT_VEC(1) = VECTOR (WSN_STR);

  15016  2 000642   000014 237000 3                  LDAQ    12
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:42   
         2 000643   000002 755000 xsym               STA     FMT_VEC+2
         2 000644   000003 756000 xsym               STQ     FMT_VEC+3

      295    15017    3         END; /*  DISP_WSNS = 1  */

  15017  2 000645   000651 710000 2                  TRA     s:15021

      296    15018    3      ELSE DO;

      297    15019    3         FMT_VEC(1) = VECTOR (WSNS_STR);

  15019  2 000646   000016 237000 3                  LDAQ    14
         2 000647   000002 755000 xsym               STA     FMT_VEC+2
         2 000650   000003 756000 xsym               STQ     FMT_VEC+3

      298    15020    3         END; /*  DISP_WSNS ~= 1  */

      299    15021    2      IF DISP THEN

  15021  2 000651   200012 234100                    SZN     DISP,,AUTO
         2 000652   000657 605000 2                  TPL     s:15026

      300    15022    3      DO;

      301    15023    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);

  15023  2 000653   000020 237000 3                  LDAQ    16
         2 000654   000004 755000 xsym               STA     FMT_VEC+4
         2 000655   000005 756000 xsym               STQ     FMT_VEC+5

      302    15024    3         END; /*  If disp  */

  15024  2 000656   000662 710000 2                  TRA     s:15028

      303    15025    3      ELSE DO;

      304    15026    3         FMT_VEC(2) = VECTOR (LIST_STR);
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:43   

  15026  2 000657   000022 237000 3                  LDAQ    18
         2 000660   000004 755000 xsym               STA     FMT_VEC+4
         2 000661   000005 756000 xsym               STQ     FMT_VEC+5

      305    15027    3         END; /*  If ~ disp  */

      306    15028    2      FDS.NVECS# = 3;

  15028  2 000662   000003 235007                    LDA     3,DL
         2 000663   000011 755000 xsym               STA     FDS+9

      307    15029    2      FMT_BUF = '   %5D %A %A.';

  15029  2 000664   040000 100400                    MLR     fill='040'O
         2 000665   000021 000015 1                  ADSC9   DISPLAY_STR+9            cn=0,n=13
         2 000666   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      308    15030    2      FDS.FMT_.BOUND = 12;

  15030  2 000667   000000 236000 xsym               LDQ     FDS
         2 000670   177777 376007                    ANQ     65535,DL
         2 000671   000003 276003                    ORQ     3,DU
         2 000672   000000 756000 xsym               STQ     FDS

      309    15031    2      CALL X$FORMAT(FDS);

  15031  2 000673   000007 630400 3                  EPPR0   7
         2 000674   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000675   000000 701000 xent               TSX1    X$FORMAT
         2 000676   000000 011000                    NOP     0

      310    15032    2      END; /* Not jcl */

      311    15033    1   FDS.WRAPTAB# = 4;

  15033  2 000677   000004 235007                    LDA     4,DL
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:44   
         2 000700   000016 755000 xsym               STA     FDS+14

      312    15034    1   RETURN;

  15034  2 000701   000000 702200 xent               TSX2  ! X66_ARET
      313    15035    1   END ASL$LIST_ALL_WORKSTATIONS;
      314    15036        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:45   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_WORKSTATIONS.
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:46   

 **** Variables and constants ****

  ****  Section 001 RoData ASL$LIST_ALL_WORKSTATIONS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    10-0-0/c CHAR(9)     r     1 DISPLAY_STR                6-0-0/c CHAR(6)     r     1 LIST_STR
     3-0-0/c CHAR(12)    r     1 WSNS_STR                   0-0-0/c CHAR(11)    r     1 WSN_STR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/b BIT         r     1 ALL_WSNS                   4-0-0/w STRC(108)   r     1 BEGIN_KEY
     7-0-0/w UBIN        r     1 CODE2                     10-0-0/c CHAR(8)     r     1 CURRENT_WSN
    12-0-0/b BIT         r     1 DISP                      13-0-0/w SBIN        r     1 DISP_WSNS
    14-0-0/w STRC(108)   r     1 END_KEY                   20-0-0/w UBIN        r     1 I
    21-0-0/w UBIN        r     1 J                         22-0-0/b BIT         r     1 JCL
    23-0-0/w STRC(108)   r     1 TNAME                     26-0-0/b BIT         r     1 WILD_CARD
    27-0-0/w UBIN        r     1 WSN_ARS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w UBIN        r     1 CODE
     0-0-0/w PTR         r     1 DSEG1$                     0-0-0/w UBIN        r     1 DSEG1SIZE
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/w STRC(1080)  r     1 FDS
     0-0-0/c CHAR(255)   r     1 FMT_BUF                    0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)
     0-0-0/b STRC        r     1 MERR_CODE                  0-0-0/w PTR         r     1 NODE$
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:47   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 P$B                        0-0-0/w ASTR(153)   r     1 P$S


   Procedure ASL$LIST_ALL_WORKSTATIONS requires 450 words for executable code.
   Procedure ASL$LIST_ALL_WORKSTATIONS requires 28 words of local(AUTO) storage.
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:48   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:49   
          MINI XREF LISTING

ALL_WSNS
     14795**DCL     14881<<ASSIGN  14883<<ASSIGN  14910>>IF
ASA_BRKS_LOC
     11825**DCL     11825--REDEF
ASB$WILD_MATCH
     14702**DCL-ENT 14979--CALL
ASH$ERROR
     14690**DCL-ENT 14953--CALL    14958--CALL    14970--CALL
ASL$DISP_ONE_WORKSTATION
     14699**DCL-ENT 14925--CALL    14989--CALL
ASW$PREC_WSN
     14681**DCL-ENT 14963--CALL
ASW$READ_WSN
     14684**DCL-ENT 14921--CALL
ASW$READ_WSN_SEQ
     14687**DCL-ENT 14968--CALL
AS_DEFAULT.BANNER_PERM
     12518**DCL     12519--REDEF
AS_DEFAULT.BUDGET.MACCT
     12423**DCL     12427--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     12436**DCL     12439--REDEF
AS_DEFAULT.BUDGET.PACCUM
     12419**DCL     12421--REDEF
AS_DEFAULT.BUDGET.PMAXC
     12414**DCL     12416--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     12534**DCL     12535--REDEF   12536--REDEF
AS_DEFAULT_DREC.PASSWORD
     13788**DCL     13792--REDEF
AS_DEFAULT_DREC.RENAME
     13811**DCL     13812--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:50   
AS_DFLT.BANNER_PERM
     12340**DCL     12341--REDEF
AS_DFLT.BUDGET.MACCT
     12245**DCL     12249--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     12258**DCL     12261--REDEF
AS_DFLT.BUDGET.PACCUM
     12241**DCL     12243--REDEF
AS_DFLT.BUDGET.PMAXC
     12236**DCL     12238--REDEF
AS_DFLT.SETUP_CHRA.TXT
     12356**DCL     12357--REDEF   12358--REDEF
AS_FE_MODE
     11691**DCL     11692--REDEF
AS_FIELD1.COUNT
     11822**DCL     14939<<ASSIGN
AS_FIELD1.TEXT
     11822**DCL     14940<<ASSIGN
AS_MODE
     11688**DCL     11690--REDEF
AS_MOD_USER.ACCESS
     14553**DCL     14554--REDEF
AS_MOD_USER.BANNER
     14540**DCL     14541--REDEF
AS_MOD_USER.BANNER_PERM
     14542**DCL     14543--REDEF
AS_MOD_USER.BILL
     14548**DCL     14549--REDEF
AS_MOD_USER.CPROC
     14544**DCL     14545--REDEF
AS_MOD_USER.FEBILL
     14624**DCL     14625--REDEF
AS_MOD_USER.FECXTMEM
     14641**DCL     14642--REDEF
AS_MOD_USER.FEMINTS
     14626**DCL     14627--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:51   
AS_MOD_USER.FEMMEM
     14637**DCL     14638--REDEF
AS_MOD_USER.FEMTIME
     14635**DCL     14636--REDEF
AS_MOD_USER.FEPPRIV
     14632**DCL     14634--REDEF
AS_MOD_USER.FEPRIV
     14629**DCL     14631--REDEF
AS_MOD_USER.FORCE_BIT
     14538**DCL     14539--REDEF
AS_MOD_USER.KEY
     14620**DCL     14622--REDEF
AS_MOD_USER.LASTCPROC
     14546**DCL     14547--REDEF
AS_MOD_USER.LIMITS.DO_
     14594**DCL     14595--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     14610**DCL     14611--REDEF
AS_MOD_USER.LIMITS.LO
     14590**DCL     14591--REDEF
AS_MOD_USER.LIMITS.MEM
     14586**DCL     14587--REDEF
AS_MOD_USER.LIMITS.MPRIO
     14614**DCL     14615--REDEF
AS_MOD_USER.LIMITS.PDIS
     14602**DCL     14603--REDEF
AS_MOD_USER.LIMITS.PO
     14598**DCL     14599--REDEF
AS_MOD_USER.LIMITS.TDIS
     14606**DCL     14607--REDEF
AS_MOD_USER.LIMITS.TIME
     14582**DCL     14583--REDEF
AS_MOD_USER.MAXENQ
     14563**DCL     14564--REDEF
AS_MOD_USER.PERM_BIT
     14536**DCL     14537--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:52   
AS_MOD_USER.PPRIV
     14558**DCL     14560--REDEF
AS_MOD_USER.PRIOB
     14565**DCL     14566--REDEF
AS_MOD_USER.PRIV
     14555**DCL     14557--REDEF
AS_MOD_USER.QUAN
     14561**DCL     14562--REDEF
AS_MOD_USER.SETUP
     14534**DCL     14535--REDEF
AS_PROJECT.BANNER_PERM
     12874**DCL     12875--REDEF
AS_PROJECT.BUDGET.MACCT
     12779**DCL     12783--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12792**DCL     12795--REDEF
AS_PROJECT.BUDGET.PACCUM
     12775**DCL     12777--REDEF
AS_PROJECT.BUDGET.PMAXC
     12770**DCL     12772--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12890**DCL     12891--REDEF   12892--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     13052**DCL     13053--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12957**DCL     12961--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12970**DCL     12973--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12953**DCL     12955--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12948**DCL     12950--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     13068**DCL     13069--REDEF   13070--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     14274**DCL     14278--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:53   
AS_PROJECT_DFLT_DREC.RENAME
     14297**DCL     14298--REDEF
AS_PROJECT_DREC.PASSWORD
     14112**DCL     14116--REDEF
AS_PROJECT_DREC.RENAME
     14135**DCL     14136--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12696**DCL     12697--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     12601**DCL     12605--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     12614**DCL     12617--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     12597**DCL     12599--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     12592**DCL     12594--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12712**DCL     12713--REDEF   12714--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13950**DCL     13954--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13973**DCL     13974--REDEF
AS_USERS.BANNER_PERM
     12162**DCL     12163--REDEF
AS_USERS.BUDGET.MACCT
     12067**DCL     12071--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     12080**DCL     12083--REDEF
AS_USERS.BUDGET.PACCUM
     12063**DCL     12065--REDEF
AS_USERS.BUDGET.PMAXC
     12058**DCL     12060--REDEF
AS_USERS.SETUP_CHRA.TXT
     12178**DCL     12179--REDEF   12180--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     13230**DCL     13231--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:54   
AS_USERS_CONSTANT.BUDGET.MACCT
     13135**DCL     13139--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     13148**DCL     13151--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     13131**DCL     13133--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     13126**DCL     13128--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     13246**DCL     13247--REDEF   13248--REDEF
BEGIN_KEY.COUNT
     14797**DCL     14887<<ASSIGN
BEGIN_KEY.TEXT
     14798**DCL     14884<<ASSIGN  14886<<ASSIGN  14914>>CALLBLT
CODE
     11818**DCL     14827<<ASSIGN  14834>>DOSELCT
CODE2
     14799**DCL     14861<<ASSIGN  14863>>DOSELCT
CURRENT_WSN
     14800**DCL     14976<<ASSIGN  14979<>CALL    14981>>IF      14993>>CALLBLT 14997>>CALLBLT
DISP
     14801**DCL     14838<<ASSIGN  14842<<ASSIGN  14850<<ASSIGN  14859<<ASSIGN  14923>>IF      14987>>IF
     15006>>IF      15021>>IF
DISPLAY_STR
     14822**DCL     15023--ASSIGN
DISP_WSNS
     14802**DCL     14832<<ASSIGN  14992>>IF      15002<<ASSIGN  15002>>ASSIGN  15013--ASSIGN  15014>>IF
DSEG1$
     11826**DCL     14921<>CALL    14968<>CALL
DSEG1SIZE
     11827**DCL     14920>>ASSIGN  14967>>ASSIGN
END_FOREVER
     15004**LABEL   14984--GOTO
END_KEY.COUNT
     14804**DCL     14889<<ASSIGN
END_KEY.TEXT
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:55   
     14805**DCL     14888<<CALLBLT 14981>>IF
ERR_CODE
     11820**DCL     11821--REDEF
FDS
     11717**DCL     14908<>CALL    14930<>CALL    15000<>CALL    15010<>CALL    15031<>CALL
FDS.FMT_.BOUND
     11722**DCL     14901<<ASSIGN  14905<<ASSIGN  14929<<ASSIGN  14994<<ASSIGN  14998<<ASSIGN  15008<<ASSIGN
     15030<<ASSIGN
FDS.NVECS#
     11745**DCL     14897<<ASSIGN  15009<<ASSIGN  15028<<ASSIGN
FDS.TABDFLT#
     11783**DCL     14907<<ASSIGN
FDS.WRAPTAB#
     11780**DCL     14898<<ASSIGN  15033<<ASSIGN
FINISH_UP
     15006**LABEL   14971--GOTO    14982--GOTO
FMT_BUF
     11816**DCL     14900<<CALLBLT 14904<<CALLBLT 14928<<CALLBLT 14993<<CALLBLT 14997<<CALLBLT 15007<<ASSIGN
     15029<<ASSIGN
FMT_VEC
     11816**DCL     15013<<ASSIGN  15016<<ASSIGN  15019<<ASSIGN  15023<<ASSIGN  15026<<ASSIGN
I
     14807**DCL     14860<<DOINDEX 14861>>ASSIGN  14885<<CALLBLT 14886>>ASSIGN  14888>>CALLBLT 14889>>ASSIGN
     14974<<CALLBLT 14975>>IF      14975<<ASSIGN  14976>>ASSIGN  14979<>CALL    14993>>CALLBLT 14994>>ASSIGN
     14997>>CALLBLT 14998>>ASSIGN
J
     14808**DCL     14978<<ASSIGN  14979<>CALL
JCL
     14809**DCL     14828<<ASSIGN  14844<<ASSIGN  14846<<ASSIGN  14851<<ASSIGN  14872<<ASSIGN  14899>>IF
     14925<>CALL    14989<>CALL    15012>>IF
KL_DEFAULT.PASSWORD
     14436**DCL     14440--REDEF
KL_DEFAULT.RENAME
     14459**DCL     14460--REDEF
KL_DFLT.PASSWORD
     13626**DCL     13630--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:56   
KL_DFLT.RENAME
     13649**DCL     13650--REDEF
KL_DREC.PASSWORD
     13464**DCL     13468--REDEF
KL_DREC.RENAME
     13487**DCL     13488--REDEF
KL_DREC_CNT.PASSWORD
     13351**DCL     13355--REDEF
KL_DREC_CNT.RENAME
     13374**DCL     13375--REDEF
LIST_STR
     14821**DCL     15026--ASSIGN
MERR_CODE
     11821**DCL     14958<>CALL    14970<>CALL
MERR_CODE.CODE
     11821**DCL     14934>>IF      14970>>IF
NODE$
     11818**DCL     14715--IMP-PTR
P$B.CODE
     14723**DCL     14827>>ASSIGN  14844>>ASSIGN  14846>>ASSIGN  14861>>ASSIGN
P$B.NSUBLKS
     14727**DCL     14843>>IF      14845>>IF      14852>>IF      14860>>DOINDEX
P$B.SUBLK$
     14748**DCL     14827>>ASSIGN  14843>>IF      14844>>ASSIGN  14844>>ASSIGN  14845>>IF      14846>>ASSIGN
     14846>>ASSIGN  14853>>ASSIGN  14853>>ASSIGN  14854>>ASSIGN  14861>>ASSIGN  14867>>ASSIGN  14867>>ASSIGN
     14868>>ASSIGN  14939>>ASSIGN  14940>>ASSIGN  14940>>ASSIGN
P$S.COUNT
     14784**DCL     14787--IMP-SIZ 14853>>ASSIGN  14854>>ASSIGN  14867>>ASSIGN  14868>>ASSIGN  14939>>ASSIGN
     14940>>ASSIGN
P$S.TEXT
     14787**DCL     14853>>ASSIGN  14867>>ASSIGN  14940>>ASSIGN
PROJ_KEY.TEXT
     11698**DCL     11698--REDEF
PROJ_KEY.TXT.PROJECT
     11698**DCL     11698--REDEF
P_PCB.OUT$
PL6.E3A0      #001=ASL$LIST_ALL_WORKSTATIONS File=ASL$LIST_WORKSTATIONS.:E05TSI  TUE 07/29/97 10:24 Page:57   
     11866**DCL     14827>>ASSIGN  14843>>IF      14844>>ASSIGN  14845>>IF      14846>>ASSIGN  14852>>IF
     14853>>ASSIGN  14853>>ASSIGN  14854>>ASSIGN  14860>>DOINDEX 14861>>ASSIGN  14867>>ASSIGN  14867>>ASSIGN
     14868>>ASSIGN  14939>>ASSIGN  14940>>ASSIGN  14940>>ASSIGN
REMEM_VAR
     11824**DCL     11824--REDEF
REM_FCMD
     11824**DCL     11825--REDEF
TNAME.COUNT
     14811**DCL     14831<<ASSIGN  14854<<ASSIGN  14868<<ASSIGN  14928>>CALLBLT 14929>>ASSIGN  14978>>ASSIGN
TNAME.TEXT
     14812**DCL     14830<<ASSIGN  14853<<ASSIGN  14867<<ASSIGN  14880>>IF      14885>>CALLBLT 14886>>ASSIGN
     14888>>CALLBLT 14918>>CALLBLT 14928>>CALLBLT 14979<>CALL
USERS_KEY
     11695**DCL     14911<<ASSIGN
USERS_KEY.COUNT
     11695**DCL     14915<<ASSIGN  14919<<ASSIGN  14966>>DOUNTIL
USERS_KEY.TEXT
     11695**DCL     11696--REDEF   11696--REDEF   11696--REDEF   11697--REDEF
USERS_KEY.TXTC
     11696**DCL     14914<<CALLBLT 14918<<CALLBLT 14974>>CALLBLT 14976>>ASSIGN
WILD_CARD
     14813**DCL     14829<<ASSIGN  14890<<ASSIGN  14893<<ASSIGN  14913>>IF      14977>>IF
WSNS_STR
     14820**DCL     14900>>CALLBLT 14901--ASSIGN  14904>>CALLBLT 14905--ASSIGN  15019--ASSIGN
WSN_ARS
     14814**DCL     14920<<ASSIGN  14921<>CALL    14967<<ASSIGN  14968<>CALL
WSN_STR
     14819**DCL     15016--ASSIGN
X$FORMAT
     14704**DCL-ENT 14908--CALL    14930--CALL    15000--CALL    15010--CALL    15031--CALL

PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:58   
      315        1        /*T***********************************************************/
      316        2        /*T*                                                         */
      317        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      318        4        /*T*                                                         */
      319        5        /*T***********************************************************/
      320        6        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:59   
      321        7        /*M* ASL$DISP_ONE_WSN: routine to handle DISP WSN cmd  */
      322        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
      323        9              ECU=3,CSU=3,SDI=3                                           */
      324       10        ASL$DISP_ONE_WORKSTATION: PROC (JCL) ;
      325       11        /**********************************************************/
      326       12
      327       13        /*D* NAME:     ASL$DISP_ONE_WSN
      328       14             CALL:     CALL ASL$DISP_ONE_WSN (JCL)
      329       15             INPUT:
      330       16                       JCL - bit set if JCL option was specified on command.
      331       17             OUTPUT:   Nothing is returned.
      332       18             DESCRIPTION:  ASL$DISP_ONE_WSN is a subroutine to handle
      333       19                           the DISP WSN command for SUPER.
      334       20                           ASL$DISP_ONE_WSN will display the wsn
      335       21                           name and any devices hooked to it.
      336       22                           The wsn record is already in data segment 1.
      337       23        */
      338       24        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:60   
      339       25        /********************************************************************/
      340       26        /*   Include files   include files   include files   include files  */
      341       27        /********************************************************************/
      342       28        %INCLUDE AS_PERR_C;
      343      630        %INCLUDE AS_SUPER_C;
      344     1065        %INCLUDE AS_SUBS_C;
      345     2479        %INCLUDE AS_MAC_C;
      346     2559        %INCLUDE AS_ENTRIES_M;
      347     3609        %INCLUDE AS_SSUBS_C;
      348     3701        %INCLUDE B_ERRORS_C;
      349     4828        %INCLUDE CP_6_SUBS;
      350     5368        %INCLUDE KL_SUPER_C;
      351     8270        %INCLUDE XU_MACRO_C;
      352    11376        %INCLUDE XU_FORMAT_C;
      353    11538        %INCLUDE AS_SUPER_R;
      354    14554        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:61   
      355    14555        /********************************************************************/
      356    14556        /*   Parameters      parameters      parameters      parameters     */
      357    14557        /********************************************************************/
      358    14558    1   DCL JCL     BIT(1);
      359    14559        /********************************************************************/
      360    14560        /*   Static data     static data     static data     static data    */
      361    14561        /********************************************************************/
      362    14562    1   DCL WSNHDR$                  PTR STATIC;
      363    14563    1   DCL P$                       PTR  STATIC;
      364    14564        /********************************************************************/
      365    14565        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      366    14566        /********************************************************************/
      367    14567        %ASB$READ_HLP;
      368    14570        %ASB$WRITE_LO ;
      369    14573        %ASH$ERROR;
      370    14576        %ASW$PREC_AND_SKIP_WSN ;
      371    14579        %ASW$READ_WSN;
      372    14582        %ASH$WARN;
      373    14585    1   DCL X$FORMAT ENTRY(1) ;
      374    14586        /********************************************************************/
      375    14587        /*   Local based     local based     local based     local based    */
      376    14588        /********************************************************************/
      377    14589    1   DCL CHAR$8                   CHAR(8) BASED;
      378    14590        %KL_DREC   ( NAME = KL$DREC,
      379    14591                     STCLASS = "BASED(DSEG3$)",
      380    14592                     LAST    = ";");
      381    14705        %KL_WSNHDR ( NAME = KL$WSNHDR, STCLASS = "BASED(WSNHDR$)");
      382    14716        %KL_INDIRECT_WSN ( NAME = KL$INDIRECT_WSN, STCLASS = "BASED(WSNHDR$)");
      383    14724        %KL_WSNDEV ( NAME = KL$WSNDEV, STCLASS = "BASED(DSEG2$)");
      384    14729        %KL_ACBLK  ( NAME = KL$ACBLK, STCLASS = "BASED(P$)");
      385    14734        %KL_WTBLK  ( NAME = KL$WTBLK, STCLASS = "BASED(P$)");
      386    14768        %KL_TWSNREC ( NAME = KL$TWSNREC, STCLASS = "BASED(DSEG3$)");
      387    14793        %KL_WSNCVT (NAME = KL$WSNCVT, STCLASS="BASED(DSEG3$)");
      388    14800        /********************************************************************/
      389    14801        /*   Auto data       auto data       auto data       auto data      */
      390    14802        /********************************************************************/
      391    14803    1   DCL I                        SBIN;
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:62   
      392    14804    1   DCL J                        SBIN;
      393    14805    1   DCL K                        SBIN;
      394    14806    1   DCL REPEATS                  SBIN;
      395    14807    1   DCL WSNDEV_ARS               SBIN;
      396    14808    1   DCL SAVE_KEY                 CHAR(9);
      397    14809    1   DCL TYPE                     CHAR(2);
      398    14810    1   DCL NUM                      CHAR(2);
      399    14811    1   DCL TWSN_CHRS                CHAR(4);
      400    14812    1   DCL FOUND                    BIT(1);
      401    14813    1   DCL DEV                      CHAR(4);
      402    14814    1   DCL ZERO                     SBIN;
      403    14815    1   DCL BLANK                    CHAR (1);
      404    14816        /********************************************************************/
      405    14817        /*   Constant data   constant data   constant data   constant data  */
      406    14818        /********************************************************************/
      407    14819    1   DCL INDIRECT_STR             CHAR(0) CONSTANT INIT('INDIRECT');
      408    14820    1   DCL INOUT_STR                CHAR(0) CONSTANT INIT('INOUT');
      409    14821    1   DCL IN_STR                   CHAR(0) CONSTANT INIT('IN');
      410    14822    1   DCL OUT_STR                  CHAR(0) CONSTANT INIT('OUT');
      411    14823    1   DCL NONE_STR                 CHAR(0) CONSTANT INIT('NONE');
      412    14824    1   DCL WSN_HDR_FMT              CHAR(0) CONSTANT INIT('%>A');
      413    14825    1   DCL WSN_JCL_FMT              CHAR(0) CONSTANT INIT
      414    14826    1             ('CREATE WSN %>A');
      415    14827    1   DCL FOR_STAT_FMT              CHAR(0) CONSTANT INIT
      416    14828    1             (' FOR STATION %>A');
      417    14829    1   DCL FOR_INDIRECT_FMT         CHAR(0) CONSTANT INIT
      418    14830    1             (' FOR INDIRECT WSN %>A@%>A');
      419    14831    1   DCL WSN_DEV_HDR              CHAR(0) CONSTANT INIT
      420    14832    1           ('   TYPE  DFORM   IO    PROFILE      ATTR');
      421    14833    1   DCL WSN_DFORM_JCL            CHAR(0) CONSTANT INIT
      422    14834    1           ('  DFORM %>A %>A');
      423    14835    1   DCL WSN_DEVICE_JCL            CHAR(0) CONSTANT INIT
      424    14836    1           ('  DEVICE = %>A@%>A');
      425    14837    1   DCL WSN_DEV_FMT              CHAR(0) CONSTANT INIT('%5-%A%11-%A%18-%A%24-%A');
      426    14838    1   DCL WSN_ACC_FMT              CHAR(0) CONSTANT INIT('  ACCESS=%>A%N(,%>A%)');
      427    14839    1   DCL WSN_ATTR_FMT             CHAR(0) CONSTANT INIT('%38-%>A%N(,%>A%)');
      428    14840    1   DCL 1 ATTR_TBL(0:7) CONSTANT,
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:63   
      429    14841    1          2 MASK BIT(18) UNAL INIT
      430    14842    1            (%ATTR_LOWERCASE#,%ATTR_BIN#,%ATTR_APL#,%ATTR_TRUOVRPRT#,
      431    14843    1            %ATTR_NATL#,%ATTR_UPPERCASE#,%ATTR_NOXLATE#,%ATTR_TRANSLGL#,'0'B*0),
      432    14844    1          2 ATTR CHAR(10) INIT
      433    14845    1           ('LOWERCASE','BINARY','APL','OVERPRINT',
      434    14846    1            'NATIONAL','UPPERCASE','NOXLATE','TRANSLGL',' '*0);
      435    14847        /********************************************************************/
      436    14848        /*   Procedure       procedure       procedure       procedure      */
      437    14849        /********************************************************************/
      438    14850    1   WSNHDR$ = DSEG1$;
      439    14851    1   ZERO = 0;
      440    14852    1   BLANK = ' ';
      441    14853    1   FMT_VEC(0) = VECTOR(ADDR(USERS_KEY.TW)->CHAR$8);
      442    14854    1   SAVE_KEY = SUBSTR (USERS_KEY.TXTC,0,9);
      443    14855    2   IF NOT JCL THEN DO;
      444    14856    2      CALL ASB$WRITE_LO(' ',1);
      445    14857    2      CALL ASB$WRITE_LO(' ',1);
      446    14858    2      FMT_BUF = WSN_HDR_FMT;
      447    14859    2      FDS.FMT_.BOUND = SIZEC(WSN_HDR_FMT)-1;
      448    14860    2      FDS.NVECS# = 1;
      449    14861    2      P$ = PINCRW(WSNHDR$,KL$WSNHDR.ACCSDISP);
      450    14862    2      IF KL$ACBLK.ACCTS>0
      451    14863    2      THEN                     /* Do access controls                    */
      452    14864    2         CALL ADD_ACCLIST;
      453    14865    2      CALL X$FORMAT(FDS);
      454    14866    2      CALL ASB$WRITE_LO(' ',1);
      455    14867    3      IF KL$WSNHDR.INDIRECT# THEN DO;
      456    14868    3         FMT_BUF = '%>A %>A @ %>A';
      457    14869    3         FDS.FMT_.BOUND = 12;
      458    14870    3         FDS.NVECS# = 3;
      459    14871    3         FMT_VEC (0) = VECTOR ( INDIRECT_STR );
      460    14872    3         FMT_VEC (1) = VECTOR ( KL$INDIRECT_WSN.INDIRECT_WSN );
      461    14873    3         FMT_VEC (2) = VECTOR ( KL$INDIRECT_WSN.NODE );
      462    14874    3         CALL X$FORMAT ( FDS );
      463    14875    3         END; /*  INDIRECT#  */
      464    14876    3      ELSE DO;
      465    14877    3         CALL ASB$WRITE_LO(WSN_DEV_HDR,SIZEC(WSN_DEV_HDR));
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:64   
      466    14878        /**
      467    14879         ** Do the device types
      468    14880         **/
      469    14881    4         DO I=0 TO KL$WSNHDR.NTYP-1;
      470    14882    4            CALL CONCAT(FMT_BUF,WSN_DEV_FMT,WSN_ATTR_FMT);
      471    14883    4            FDS.FMT_.BOUND = SIZEC(WSN_DEV_FMT) + SIZEC(WSN_ATTR_FMT) -1;
      472    14884    4            FDS.NVECS# = 4;
      473    14885    4            P$ = PINCRW(WSNHDR$,KL$WSNHDR.TYPS.DISP(I));
      474    14886    4            FMT_VEC(0) = VECTOR(KL$WSNHDR.TYPS.TYP(I));
      475    14887    4            FMT_VEC(1) = VECTOR(KL$WTBLK.FNAME);
      476    14888    4            IF KL$WTBLK.IO.INPUT
      477    14889    4            THEN
      478    14890    4               IF KL$WTBLK.IO.OUTPUT
      479    14891    4               THEN
      480    14892    4                  FMT_VEC(2) = VECTOR(INOUT_STR);
      481    14893    4               ELSE
      482    14894    4                  FMT_VEC(2) = VECTOR(IN_STR);
      483    14895    4            ELSE
      484    14896    4               IF KL$WTBLK.IO.OUTPUT
      485    14897    4               THEN
      486    14898    4                  FMT_VEC(2) = VECTOR(OUT_STR);
      487    14899    4               ELSE
      488    14900    4                  FMT_VEC(2) = VECTOR(NONE_STR);
      489    14901    4            FMT_VEC(3) = VECTOR (KL$WTBLK.PNAME.TXT);
      490    14902    4            FMT_VEC(4) = VECTOR(BLANK);
      491    14903    4            FMT_VEC(5) = VECTOR(ZERO);
      492    14904    5            DO J=0 TO KL$WTBLK.NATR-1;
      493    14905    5               REPEATS = -1;
      494    14906    6               DO K=0 TO 7;
      495    14907    6                  IF ATTR_TBL.MASK(K) & KL$WTBLK.ATTRS(J)
      496    14908    7                  THEN DO;        /* This attribute exists              */
      497    14909    7                     FMT_VEC(FDS.NVECS#) = VECTOR(ATTR_TBL.ATTR(K));
      498    14910    7                     FDS.NVECS# = FDS.NVECS# + 1;
      499    14911    7                     REPEATS = REPEATS + 1;
      500    14912    7                     IF REPEATS=0
      501    14913    8                     THEN DO;
      502    14914    8                        FMT_VEC(FDS.NVECS#) = VECTOR(REPEATS);
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:65   
      503    14915    8                        FDS.NVECS# = FDS.NVECS# + 1;
      504    14916    8                        END; /*  Repeats = 0  */
      505    14917    7                     END; /*  This attribute exists  */
      506    14918    6                  END; /*  Do k = 0 to 7  */
      507    14919    5               IF FDS.NVECS# = 4 THEN FDS.NVECS# = 6;
      508    14920    5               CALL X$FORMAT(FDS);
      509    14921    5               FMT_BUF = WSN_ATTR_FMT;
      510    14922    5               FDS.FMT_.BOUND = SIZEC(WSN_ATTR_FMT) - 1;
      511    14923    5               FDS.NVECS# = 0;
      512    14924    5               END; /*  Do j  */
      513    14925    4            END; /*  Do i  */
      514    14926    3         END; /*  Not indirect  */
      515    14927    2      END;  /*  Not jcl  */
      516    14928    2   ELSE DO;   /*  Jcl  */
      517    14929    2      FMT_BUF = WSN_JCL_FMT;
      518    14930    2      FDS.FMT_.BOUND = SIZEC(WSN_JCL_FMT)-1;
      519    14931    2      FDS.NVECS# = 1;
      520    14932    3      IF KL$WSNHDR.INDIRECT# THEN DO;
      521    14933    3         SUBSTR (FMT_BUF,FDS.FMT_.BOUND+1,SIZEC(FOR_INDIRECT_FMT)) = FOR_INDIRECT_FMT;
      522    14934    3         FDS.FMT_.BOUND = FDS.FMT_.BOUND + SIZEC (FOR_INDIRECT_FMT);
      523    14935    3         FDS.NVECS# = 3;
      524    14936    3         FMT_VEC (1) = VECTOR ( KL$INDIRECT_WSN.INDIRECT_WSN );
      525    14937    3         FMT_VEC (2) = VECTOR ( KL$INDIRECT_WSN.NODE );
      526    14938    3         END;  /*  INDIRECT#  */
      527    14939    2      ELSE
      528    14940    3         IF KL$WSNHDR.TNAME ~= ' ' THEN DO;
      529    14941    3            SUBSTR (FMT_BUF,FDS.FMT_.BOUND+1, SIZEC(FOR_STAT_FMT)) = FOR_STAT_FMT;
      530    14942    3            FDS.FMT_.BOUND = FDS.FMT_.BOUND + SIZEC(FOR_STAT_FMT);
      531    14943    3            FDS.NVECS# = 2;
      532    14944    3            FMT_VEC ( 1 ) = VECTOR (KL$WSNHDR.TNAME);
      533    14945    3            END; /*  Non blank station name  */
      534    14946    2      CALL X$FORMAT (FDS);
      535    14947    2      FMT_BUF = '   ';
      536    14948    2      FDS.FMT_.BOUND = 2;
      537    14949    2      FDS.NVECS# = 0;
      538    14950    2      P$ = PINCRW(WSNHDR$,KL$WSNHDR.ACCSDISP);
      539    14951    2      IF KL$ACBLK.ACCTS>0
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:66   
      540    14952    3      THEN DO;                       /* Access controls                    */
      541    14953    3         CALL ADD_ACCLIST;
      542    14954    3         CALL X$FORMAT(FDS);
      543    14955    3         END;
      544    14956        /**
      545    14957         **   Do the device commands
      546    14958         **/
      547    14959        /**/
      548    14960        /*        Read wsndev record from :WSN          */
      549    14961        /*        If not found give error message       */
      550    14962        /**/
      551    14963    3      IF NOT KL$WSNHDR.INDIRECT# THEN DO;
      552    14964    3         SUBSTR (USERS_KEY.TXTC,8,7) = 'DEVICES';
      553    14965    3         USERS_KEY.COUNT = 15;
      554    14966    3         WSNDEV_ARS = DSEG2SIZE;
      555    14967    4         CALL ASW$READ_WSN( DSEG2$, WSNDEV_ARS ) WHENALTRETURN DO;
      556    14968        /*E*  ERROR:     ASL-E$NOWSNDEV-C
      557    14969              MESSAGE:   WSN containing DEVICE names does not exist.
      558    14970        */
      559    14971                 %SCREAM( ERR#=E$NOWSNDEV, LEVEL=ERROR, MID='L' );
      560    14986    4            RETURN ;
      561    14987    4            END; /* WSNDEV_ERR altret from ASW$READ_WSN */
      562    14988        /**
      563    14989         **   Find the devices type, number, and station name
      564    14990         **/
      565    14991    3         FMT_BUF = WSN_DEVICE_JCL;
      566    14992    3         FDS.FMT_.BOUND = SIZEC (WSN_DEVICE_JCL) - 1;
      567    14993    3         FDS.NVECS# = 2;
      568    14994    4         DO I = 0 TO KL$WSNDEV.NDEV - 1;
      569    14995    4            FOUND = %NO#;
      570    14996    4            SUBSTR (USERS_KEY.TXTC,0,8) = KL$WSNDEV.DEV(I);
      571    14997    4            USERS_KEY.COUNT = 8;
      572    14998    4            WSNDEV_ARS = DSEG3SIZE;
      573    14999    4            CALL ASB$READ_HLP (DSEG3$, WSNDEV_ARS, 3)
      574    15000    5            WHENALTRETURN DO;
      575    15001    5               SUBSTR (USERS_KEY.TXTC,8,1) = '*';
      576    15002    5               USERS_KEY.COUNT = 9;
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:67   
      577    15003    5               CALL ASB$READ_HLP (DSEG3$, WSNDEV_ARS, 3)
      578    15004    6               WHENALTRETURN DO;
      579    15005        /*  must be an iom connected device or it doesn't exist*/
      580    15006    6                  TYPE = SUBSTR (KL$WSNDEV.DEV(I),0,2);
      581    15007    6                  NUM = SUBSTR (KL$WSNDEV.DEV(I),2,2);
      582    15008    6                  TWSN_CHRS = SUBSTR (KL$WSNDEV.DEV(I),4,4);
      583    15009    6                  IF ((SUBSTR (TYPE,0,1) > '@') AND (SUBSTR (TYPE,0,1) < '{'))
      584    15010    6                       AND((SUBSTR (TYPE,1,1) > '@') AND (SUBSTR (TYPE,1,1) < '{'))
      585    15011    7                  THEN DO;
      586    15012    7                     IF ((SUBSTR (NUM,0,1) > '/') AND (SUBSTR (NUM,0,1) < ':'))
      587    15013    7                          AND((SUBSTR (NUM,1,1) > '/') AND (SUBSTR (NUM,1,1) < ':'))
      588    15014    8                     THEN DO;
      589    15015    8                        CALL CONCAT (USERS_KEY.TXTC,'TWSN',TWSN_CHRS);
      590    15016    8                        USERS_KEY.COUNT = 8;
      591    15017    8                        CALL ASB$READ_HLP (DSEG3$, WSNDEV_ARS, 3)
      592    15018    9                        WHENALTRETURN DO;
      593    15019        /*E* ERROR: ASL-E$NODEV-C
      594    15020           MESSAGE: %U1 does not exist.
      595    15021           MESSAGE1: %U1 was found in the wsn device record but wasn't
      596    15022                     found in :HLP.
      597    15023        */
      598    15024    9   NODEV_ERR:
      599    15025    9                           AS_FIELD1.COUNT = 8;
      600    15026    9                           AS_FIELD1.TEXT = KL$WSNDEV.DEV(I);
      601    15027                                %SCREAM (ERR#=E$NODEV, LEVEL=WARN, MID='L');
      602    15042    9                           GOTO LOOP_END;
      603    15043    9                           END; /* Whenaltreturn from 3RD ASB$READ_HLP  */
      604    15044    8                        J = 0;
      605    15045    9                        DO WHILE (J < KL$TWSNREC.NDEV) AND (NOT FOUND);
      606    15046    9                           IF KL$TWSNREC.DEVS.TYP(J) = TYPE THEN
      607    15047    9                              IF KL$TWSNREC.DEVS.NUM(J) = NUM THEN
      608    15048    9                                 FOUND = %YES#;
      609    15049    9                           J = J + 1;
      610    15050    9                           END; /*  Do while j < KL$TWSNREC.NDEV and not found  */
      611    15051    8                        IF NOT FOUND THEN GOTO NODEV_ERR;
      612    15052    8                        END; /*  Num is two digits */
      613    15053    7                     END; /*  Type is two characters */
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:68   
      614    15054    6                  END; /* Whenaltreturn from 2ND ASB$READ_HLP  */
      615    15055    5               END; /* Whenaltreturn from 1ST ASB$READ_HLP  */
      616    15056    4            IF USERS_KEY.COUNT = 8 THEN
      617    15057    4               FMT_VEC ( 0 ) = VECTOR (SUBSTR (KL$WSNDEV.DEV(I),0,4) );
      618    15058    4            ELSE
      619    15059    4               FMT_VEC ( 0 ) = VECTOR ( SUBSTR (KL$DREC.RENAME,0,4) );
      620    15060    5            IF FOUND THEN DO; /* Need the 'TERM' record  */
      621    15061    5               DEV = SUBSTR (KL$WSNDEV.DEV(I),0,4);
      622    15062    5               FMT_VEC ( 0 ) = VECTOR ( DEV );
      623    15063    5               USERS_KEY.TXTC = 'TERM';
      624    15064    5               USERS_KEY.COUNT = 4;
      625    15065    5               WSNDEV_ARS = DSEG3SIZE;
      626    15066    5               CALL ASB$READ_HLP (DSEG3$, WSNDEV_ARS, 3)
      627    15067    6               WHENRETURN DO;
      628    15068    6                  CALL CHARBIN (J,TWSN_CHRS);
      629    15069    6                  FMT_VEC ( 1 ) = VECTOR ( KL$WSNCVT.WSN(J) );
      630    15070    6                  END; /* Whenreturn from READ_HLP */
      631    15071    6               WHENALTRETURN DO;
      632    15072    6                  CALL ASH$ERROR (MERR_CODE);
      633    15073    6                  RETURN;
      634    15074    6                  END; /* Whenaltreturn from READ_HLP */
      635    15075    5               END; /*  If found  */
      636    15076    4            ELSE
      637    15077    4               FMT_VEC ( 1 ) = VECTOR ( KL$DREC.SNAME );
      638    15078    4            CALL X$FORMAT (FDS);
      639    15079    4   LOOP_END:
      640    15080    4            END; /*  Loop through all of the wsns devices  */
      641    15081        /**
      642    15082         ** Do the default forms
      643    15083         **/
      644    15084    4         DO I=0 TO KL$WSNHDR.NTYP-1;
      645    15085    4            P$ = PINCRW(WSNHDR$,KL$WSNHDR.TYPS.DISP(I));
      646    15086    5            IF KL$WTBLK.FNAME ~= ' ' THEN DO;
      647    15087    5               FMT_BUF = WSN_DFORM_JCL;
      648    15088    5               FDS.FMT_.BOUND = SIZEC(WSN_DFORM_JCL) - 1;
      649    15089    5               FDS.NVECS# = 2;
      650    15090    5               FMT_VEC(0) = VECTOR(KL$WSNHDR.TYPS.TYP(I));
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:69   
      651    15091    5               FMT_VEC(1) = VECTOR(KL$WTBLK.FNAME);
      652    15092    5               CALL X$FORMAT(FDS);
      653    15093    5               END; /* Formname not blank  */
      654    15094    4            END; /* Do number of types in wsn header  */
      655    15095    3         SUBSTR (USERS_KEY.TXTC,0,9) = SAVE_KEY;
      656    15096    3         USERS_KEY.COUNT = 9;
      657    15097    3         CALL ASW$PREC_AND_SKIP_WSN
      658    15098    4         WHENALTRETURN DO;
      659    15099    4            CALL ASH$ERROR (MERR_CODE);
      660    15100    4            END; /*  Whenaltreturn from ASW$PREC_AND_SKIP_WSN  */
      661    15101    3         END; /*  Not INDIRECT#  */
      662    15102    2      END;   /*  Jcl  */
      663    15103    1   CALL ASB$WRITE_LO (' ',1);
      664    15104    1   RETURN;
      665    15105        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:70   
      666    15106    1   ADD_ACCLIST: PROC;
      667    15107    2   DCL REPEATS SBIN;
      668    15108    2   DCL I SBIN;
      669    15109    2   CALL INSERT(FMT_BUF,FDS.FMT_.BOUND+1,SIZEC(WSN_ACC_FMT),
      670    15110    2        WSN_ACC_FMT);
      671    15111    2   FDS.FMT_.BOUND = FDS.FMT_.BOUND + SIZEC(WSN_ACC_FMT);
      672    15112    2   FMT_VEC(FDS.NVECS#) = VECTOR(KL$ACBLK.LIST(0));
      673    15113    2   FMT_VEC(FDS.NVECS#+1) = VECTOR(REPEATS);
      674    15114    2   FDS.NVECS# = FDS.NVECS# + 2;
      675    15115    2   REPEATS = 0;
      676    15116    3   DO I=1 TO KL$ACBLK.ACCTS-1;
      677    15117    3      FMT_VEC(FDS.NVECS#) = VECTOR(KL$ACBLK.LIST(I));
      678    15118    3      FDS.NVECS# = FDS.NVECS# + 1;
      679    15119    3      REPEATS = REPEATS + 1;
      680    15120    3      END;
      681    15121    2   RETURN;
      682    15122    2   END ADD_ACCLIST;
      683    15123    1   END ASL$DISP_ONE_WORKSTATION;

PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:71   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_WORKSTATION.

   Procedure ASL$DISP_ONE_WORKSTATION requires 680 words for executable code.
   Procedure ASL$DISP_ONE_WORKSTATION requires 28 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_WORKSTATIONS.:E05TSI    .

PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:72   

 Object Unit name= ASL$DISP_ONE_WORKSTATION                   File name= ASL$LIST_WORKSTATIONS.:E05TOU
 UTS= JUL 29 '97 10:27:00.28 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1   Data  even  none     2      2  ASL$DISP_ONE_WORKSTATION
    2  RoData even  UTS     93    135  ASL$DISP_ONE_WORKSTATION
    3   Proc  even  none   680   1250  ASL$DISP_ONE_WORKSTATION
    4  RoData even  none    35     43  ASL$DISP_ONE_WORKSTATION

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        1  ASL$DISP_ONE_WORKSTATION

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASB$WRITE_LO
 yes     yes           Std       2 ASW$READ_WSN
         yes           Std       1 X$FORMAT
 yes     yes           Std       3 ASB$READ_HLP
         yes           Std       2 ASH$ERROR
         yes           Std       2 ASH$WARN
 yes     yes           Std       0 ASW$PREC_AND_SKIP_WSN
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:73   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     USERS_KEY                             FDS                                   FMT_BUF
     FMT_VEC                               ERR_CODE                              AS_FIELD1
     REMEM_VAR                             REM_FCMD                              ASA_BRKS_LOC
     DSEG1$                                DSEG2$                                DSEG2SIZE
     DSEG3$                                DSEG3SIZE                             B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:74   


      315        1        /*T***********************************************************/
      316        2        /*T*                                                         */
      317        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      318        4        /*T*                                                         */
      319        5        /*T***********************************************************/
      320        6        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:75   
      321        7        /*M* ASL$DISP_ONE_WSN: routine to handle DISP WSN cmd  */
      322        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
      323        9              ECU=3,CSU=3,SDI=3                                           */
      324       10        ASL$DISP_ONE_WORKSTATION: PROC (JCL) ;

     10  3 000000   000000 700200 xent  ASL$DISP_ON* TSX0  ! X66_AUTO_1
         3 000001   000034 000001                    ZERO    28,1

      325       11        /**********************************************************/
      326       12
      327       13        /*D* NAME:     ASL$DISP_ONE_WSN
      328       14             CALL:     CALL ASL$DISP_ONE_WSN (JCL)
      329       15             INPUT:
      330       16                       JCL - bit set if JCL option was specified on command.
      331       17             OUTPUT:   Nothing is returned.
      332       18             DESCRIPTION:  ASL$DISP_ONE_WSN is a subroutine to handle
      333       19                           the DISP WSN command for SUPER.
      334       20                           ASL$DISP_ONE_WSN will display the wsn
      335       21                           name and any devices hooked to it.
      336       22                           The wsn record is already in data segment 1.
      337       23        */
      338       24        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:76   
      339       25        /********************************************************************/
      340       26        /*   Include files   include files   include files   include files  */
      341       27        /********************************************************************/
      342       28        %INCLUDE AS_PERR_C;
      343      630        %INCLUDE AS_SUPER_C;
      344     1065        %INCLUDE AS_SUBS_C;
      345     2479        %INCLUDE AS_MAC_C;
      346     2559        %INCLUDE AS_ENTRIES_M;
      347     3609        %INCLUDE AS_SSUBS_C;
      348     3701        %INCLUDE B_ERRORS_C;
      349     4828        %INCLUDE CP_6_SUBS;
      350     5368        %INCLUDE KL_SUPER_C;
      351     8270        %INCLUDE XU_MACRO_C;
      352    11376        %INCLUDE XU_FORMAT_C;
      353    11538        %INCLUDE AS_SUPER_R;
      354    14554        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:77   
      355    14555        /********************************************************************/
      356    14556        /*   Parameters      parameters      parameters      parameters     */
      357    14557        /********************************************************************/
      358    14558    1   DCL JCL     BIT(1);
      359    14559        /********************************************************************/
      360    14560        /*   Static data     static data     static data     static data    */
      361    14561        /********************************************************************/
      362    14562    1   DCL WSNHDR$                  PTR STATIC;
      363    14563    1   DCL P$                       PTR  STATIC;
      364    14564        /********************************************************************/
      365    14565        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      366    14566        /********************************************************************/
      367    14567        %ASB$READ_HLP;
      368    14570        %ASB$WRITE_LO ;
      369    14573        %ASH$ERROR;
      370    14576        %ASW$PREC_AND_SKIP_WSN ;
      371    14579        %ASW$READ_WSN;
      372    14582        %ASH$WARN;
      373    14585    1   DCL X$FORMAT ENTRY(1) ;
      374    14586        /********************************************************************/
      375    14587        /*   Local based     local based     local based     local based    */
      376    14588        /********************************************************************/
      377    14589    1   DCL CHAR$8                   CHAR(8) BASED;
      378    14590        %KL_DREC   ( NAME = KL$DREC,
      379    14591                     STCLASS = "BASED(DSEG3$)",
      380    14592                     LAST    = ";");
      381    14705        %KL_WSNHDR ( NAME = KL$WSNHDR, STCLASS = "BASED(WSNHDR$)");
      382    14716        %KL_INDIRECT_WSN ( NAME = KL$INDIRECT_WSN, STCLASS = "BASED(WSNHDR$)");
      383    14724        %KL_WSNDEV ( NAME = KL$WSNDEV, STCLASS = "BASED(DSEG2$)");
      384    14729        %KL_ACBLK  ( NAME = KL$ACBLK, STCLASS = "BASED(P$)");
      385    14734        %KL_WTBLK  ( NAME = KL$WTBLK, STCLASS = "BASED(P$)");
      386    14768        %KL_TWSNREC ( NAME = KL$TWSNREC, STCLASS = "BASED(DSEG3$)");
      387    14793        %KL_WSNCVT (NAME = KL$WSNCVT, STCLASS="BASED(DSEG3$)");
      388    14800        /********************************************************************/
      389    14801        /*   Auto data       auto data       auto data       auto data      */
      390    14802        /********************************************************************/
      391    14803    1   DCL I                        SBIN;
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:78   
      392    14804    1   DCL J                        SBIN;
      393    14805    1   DCL K                        SBIN;
      394    14806    1   DCL REPEATS                  SBIN;
      395    14807    1   DCL WSNDEV_ARS               SBIN;
      396    14808    1   DCL SAVE_KEY                 CHAR(9);
      397    14809    1   DCL TYPE                     CHAR(2);
      398    14810    1   DCL NUM                      CHAR(2);
      399    14811    1   DCL TWSN_CHRS                CHAR(4);
      400    14812    1   DCL FOUND                    BIT(1);
      401    14813    1   DCL DEV                      CHAR(4);
      402    14814    1   DCL ZERO                     SBIN;
      403    14815    1   DCL BLANK                    CHAR (1);
      404    14816        /********************************************************************/
      405    14817        /*   Constant data   constant data   constant data   constant data  */
      406    14818        /********************************************************************/
      407    14819    1   DCL INDIRECT_STR             CHAR(0) CONSTANT INIT('INDIRECT');
      408    14820    1   DCL INOUT_STR                CHAR(0) CONSTANT INIT('INOUT');
      409    14821    1   DCL IN_STR                   CHAR(0) CONSTANT INIT('IN');
      410    14822    1   DCL OUT_STR                  CHAR(0) CONSTANT INIT('OUT');
      411    14823    1   DCL NONE_STR                 CHAR(0) CONSTANT INIT('NONE');
      412    14824    1   DCL WSN_HDR_FMT              CHAR(0) CONSTANT INIT('%>A');
      413    14825    1   DCL WSN_JCL_FMT              CHAR(0) CONSTANT INIT
      414    14826    1             ('CREATE WSN %>A');
      415    14827    1   DCL FOR_STAT_FMT              CHAR(0) CONSTANT INIT
      416    14828    1             (' FOR STATION %>A');
      417    14829    1   DCL FOR_INDIRECT_FMT         CHAR(0) CONSTANT INIT
      418    14830    1             (' FOR INDIRECT WSN %>A@%>A');
      419    14831    1   DCL WSN_DEV_HDR              CHAR(0) CONSTANT INIT
      420    14832    1           ('   TYPE  DFORM   IO    PROFILE      ATTR');
      421    14833    1   DCL WSN_DFORM_JCL            CHAR(0) CONSTANT INIT
      422    14834    1           ('  DFORM %>A %>A');
      423    14835    1   DCL WSN_DEVICE_JCL            CHAR(0) CONSTANT INIT
      424    14836    1           ('  DEVICE = %>A@%>A');
      425    14837    1   DCL WSN_DEV_FMT              CHAR(0) CONSTANT INIT('%5-%A%11-%A%18-%A%24-%A');
      426    14838    1   DCL WSN_ACC_FMT              CHAR(0) CONSTANT INIT('  ACCESS=%>A%N(,%>A%)');
      427    14839    1   DCL WSN_ATTR_FMT             CHAR(0) CONSTANT INIT('%38-%>A%N(,%>A%)');
      428    14840    1   DCL 1 ATTR_TBL(0:7) CONSTANT,
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:79   
      429    14841    1          2 MASK BIT(18) UNAL INIT
      430    14842    1            (%ATTR_LOWERCASE#,%ATTR_BIN#,%ATTR_APL#,%ATTR_TRUOVRPRT#,
      431    14843    1            %ATTR_NATL#,%ATTR_UPPERCASE#,%ATTR_NOXLATE#,%ATTR_TRANSLGL#,'0'B*0),
      432    14844    1          2 ATTR CHAR(10) INIT
      433    14845    1           ('LOWERCASE','BINARY','APL','OVERPRINT',
      434    14846    1            'NATIONAL','UPPERCASE','NOXLATE','TRANSLGL',' '*0);
      435    14847        /********************************************************************/
      436    14848        /*   Procedure       procedure       procedure       procedure      */
      437    14849        /********************************************************************/
      438    14850    1   WSNHDR$ = DSEG1$;

  14850  3 000002   000000 236000 xsym               LDQ     DSEG1$
         3 000003   000000 756000 1                  STQ     WSNHDR$

      439    14851    1   ZERO = 0;

  14851  3 000004   200021 450100                    STZ     ZERO,,AUTO

      440    14852    1   BLANK = ' ';

  14852  3 000005   040000 236003                    LDQ     16384,DU
         3 000006   200022 756100                    STQ     BLANK,,AUTO

      441    14853    1   FMT_VEC(0) = VECTOR(ADDR(USERS_KEY.TW)->CHAR$8);

  14853  3 000007   000000 237000 4                  LDAQ    0
         3 000010   000000 755000 xsym               STA     FMT_VEC
         3 000011   000001 756000 xsym               STQ     FMT_VEC+1

      442    14854    1   SAVE_KEY = SUBSTR (USERS_KEY.TXTC,0,9);

  14854  3 000012   040100 100400                    MLR     fill='040'O
         3 000013   000000 200011 xsym               ADSC9   USERS_KEY                cn=1,n=9
         3 000014   200011 000011                    ADSC9   SAVE_KEY,,AUTO           cn=0,n=9

      443    14855    2   IF NOT JCL THEN DO;

PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:80   
  14855  3 000015   200003 470500                    LDP0    @JCL,,AUTO
         3 000016   000000 066500                    CMPB    filb='0'B
         3 000017   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         3 000020   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000021   000352 601000 3                  TNZ     s:14929

      444    14856    2      CALL ASB$WRITE_LO(' ',1);

  14856  3 000022   000002 630400 4                  EPPR0   2
         3 000023   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000024   000000 701000 xent               TSX1    ASB$WRITE_LO
         3 000025   000000 011000                    NOP     0

      445    14857    2      CALL ASB$WRITE_LO(' ',1);

  14857  3 000026   000002 630400 4                  EPPR0   2
         3 000027   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000030   000000 701000 xent               TSX1    ASB$WRITE_LO
         3 000031   000000 011000                    NOP     0

      446    14858    2      FMT_BUF = WSN_HDR_FMT;

  14858  3 000032   040000 100400                    MLR     fill='040'O
         3 000033   000007 000003 2                  ADSC9   WSN_HDR_FMT              cn=0,n=3
         3 000034   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      447    14859    2      FDS.FMT_.BOUND = SIZEC(WSN_HDR_FMT)-1;

  14859  3 000035   000000 236000 xsym               LDQ     FDS
         3 000036   177777 376007                    ANQ     65535,DL
         3 000037   400000 276007                    ORQ     -131072,DL
         3 000040   000000 756000 xsym               STQ     FDS

      448    14860    2      FDS.NVECS# = 1;

  14860  3 000041   000001 235007                    LDA     1,DL
         3 000042   000011 755000 xsym               STA     FDS+9
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:81   

      449    14861    2      P$ = PINCRW(WSNHDR$,KL$WSNHDR.ACCSDISP);

  14861  3 000043   000000 470400 1                  LDP0    WSNHDR$
         3 000044   000000 720100                    LXL0    0,,PR0
         3 000045   000000 636010                    EAQ     0,X0
         3 000046   000000 036000 1                  ADLQ    WSNHDR$
         3 000047   000001 756000 1                  STQ     P$

      450    14862    2      IF KL$ACBLK.ACCTS>0

  14862  3 000050   000001 471400 1                  LDP1    P$
         3 000051   100000 235100                    LDA     0,,PR1
         3 000052   000055 600000 3                  TZE     s:14865

      451    14863    2      THEN                     /* Do access controls                    */
      452    14864    2         CALL ADD_ACCLIST;

  14864  3 000053   001165 701000 3                  TSX1    ADD_ACCLIST
         3 000054   000000 011000                    NOP     0

      453    14865    2      CALL X$FORMAT(FDS);

  14865  3 000055   000004 630400 4                  EPPR0   4
         3 000056   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000057   000000 701000 xent               TSX1    X$FORMAT
         3 000060   000000 011000                    NOP     0

      454    14866    2      CALL ASB$WRITE_LO(' ',1);

  14866  3 000061   000002 630400 4                  EPPR0   2
         3 000062   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000063   000000 701000 xent               TSX1    ASB$WRITE_LO
         3 000064   000000 011000                    NOP     0

      455    14867    3      IF KL$WSNHDR.INDIRECT# THEN DO;

PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:82   
  14867  3 000065   000000 470400 1                  LDP0    WSNHDR$
         3 000066   000000 234100                    SZN     0,,PR0
         3 000067   000123 605000 3                  TPL     s:14877

      456    14868    3         FMT_BUF = '%>A %>A @ %>A';

  14868  3 000070   040000 100400                    MLR     fill='040'O
         3 000071   000122 000015 2                  ADSC9   ATTR_TBL+24              cn=0,n=13
         3 000072   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      457    14869    3         FDS.FMT_.BOUND = 12;

  14869  3 000073   000000 236000 xsym               LDQ     FDS
         3 000074   177777 376007                    ANQ     65535,DL
         3 000075   000003 276003                    ORQ     3,DU
         3 000076   000000 756000 xsym               STQ     FDS

      458    14870    3         FDS.NVECS# = 3;

  14870  3 000077   000003 235007                    LDA     3,DL
         3 000100   000011 755000 xsym               STA     FDS+9

      459    14871    3         FMT_VEC (0) = VECTOR ( INDIRECT_STR );

  14871  3 000101   000006 237000 4                  LDAQ    6
         3 000102   000000 755000 xsym               STA     FMT_VEC
         3 000103   000001 756000 xsym               STQ     FMT_VEC+1

      460    14872    3         FMT_VEC (1) = VECTOR ( KL$INDIRECT_WSN.INDIRECT_WSN );

  14872  3 000104   000000 235000 4                  LDA     0
         3 000105   000000 236000 1                  LDQ     WSNHDR$
         3 000106   000003 036003                    ADLQ    3,DU
         3 000107   000002 755000 xsym               STA     FMT_VEC+2
         3 000110   000003 756000 xsym               STQ     FMT_VEC+3

      461    14873    3         FMT_VEC (2) = VECTOR ( KL$INDIRECT_WSN.NODE );
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:83   

  14873  3 000111   000000 235000 4                  LDA     0
         3 000112   000000 236000 1                  LDQ     WSNHDR$
         3 000113   000001 036003                    ADLQ    1,DU
         3 000114   000004 755000 xsym               STA     FMT_VEC+4
         3 000115   000005 756000 xsym               STQ     FMT_VEC+5

      462    14874    3         CALL X$FORMAT ( FDS );

  14874  3 000116   000004 630400 4                  EPPR0   4
         3 000117   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000120   000000 701000 xent               TSX1    X$FORMAT
         3 000121   000000 011000                    NOP     0

      463    14875    3         END; /*  INDIRECT#  */

  14875  3 000122   001160 710000 3                  TRA     s:15103

      464    14876    3      ELSE DO;

      465    14877    3         CALL ASB$WRITE_LO(WSN_DEV_HDR,SIZEC(WSN_DEV_HDR));

  14877  3 000123   000011 630400 4                  EPPR0   9
         3 000124   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000125   000000 701000 xent               TSX1    ASB$WRITE_LO
         3 000126   000000 011000                    NOP     0

      466    14878        /**
      467    14879         ** Do the device types
      468    14880         **/
      469    14881    4         DO I=0 TO KL$WSNHDR.NTYP-1;

  14881  3 000127   200004 450100                    STZ     I,,AUTO
         3 000130   000344 710000 3                  TRA     s:14925+1

      470    14882    4            CALL CONCAT(FMT_BUF,WSN_DEV_FMT,WSN_ATTR_FMT);

PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:84   
  14882  3 000131   040000 100400                    MLR     fill='040'O
         3 000132   000052 000027 2                  ADSC9   WSN_DEV_FMT              cn=0,n=23
         3 000133   000000 000027 xsym               ADSC9   FMT_BUF                  cn=0,n=23
         3 000134   040000 100400                    MLR     fill='040'O
         3 000135   000066 000020 2                  ADSC9   WSN_ATTR_FMT             cn=0,n=16
         3 000136   000005 600350 xsym               ADSC9   FMT_BUF+5                cn=3,n=232

      471    14883    4            FDS.FMT_.BOUND = SIZEC(WSN_DEV_FMT) + SIZEC(WSN_ATTR_FMT) -1;

  14883  3 000137   000000 236000 xsym               LDQ     FDS
         3 000140   177777 376007                    ANQ     65535,DL
         3 000141   000013 276000 4                  ORQ     11
         3 000142   000000 756000 xsym               STQ     FDS

      472    14884    4            FDS.NVECS# = 4;

  14884  3 000143   000004 235007                    LDA     4,DL
         3 000144   000011 755000 xsym               STA     FDS+9

      473    14885    4            P$ = PINCRW(WSNHDR$,KL$WSNHDR.TYPS.DISP(I));

  14885  3 000145   000000 470400 1                  LDP0    WSNHDR$
         3 000146   200004 720100                    LXL0    I,,AUTO
         3 000147   000004 721110                    LXL1    4,X0,PR0
         3 000150   000000 636011                    EAQ     0,X1
         3 000151   000000 036000 1                  ADLQ    WSNHDR$
         3 000152   000001 756000 1                  STQ     P$

      474    14886    4            FMT_VEC(0) = VECTOR(KL$WSNHDR.TYPS.TYP(I));

  14886  3 000153   377640 235007                    LDA     130976,DL
         3 000154   200004 236100                    LDQ     I,,AUTO
         3 000155   000022 736000                    QLS     18
         3 000156   000004 036003                    ADLQ    4,DU
         3 000157   000000 036000 1                  ADLQ    WSNHDR$
         3 000160   000000 755000 xsym               STA     FMT_VEC
         3 000161   000001 756000 xsym               STQ     FMT_VEC+1
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:85   

      475    14887    4            FMT_VEC(1) = VECTOR(KL$WTBLK.FNAME);

  14887  3 000162   000014 235000 4                  LDA     12
         3 000163   000001 236000 1                  LDQ     P$
         3 000164   000002 036003                    ADLQ    2,DU
         3 000165   000002 755000 xsym               STA     FMT_VEC+2
         3 000166   000003 756000 xsym               STQ     FMT_VEC+3

      476    14888    4            IF KL$WTBLK.IO.INPUT

  14888  3 000167   000001 471400 1                  LDP1    P$
         3 000170   100003 236100                    LDQ     3,,PR1
         3 000171   000400 316007                    CANQ    256,DL
         3 000172   000205 600000 3                  TZE     s:14896

      477    14889    4            THEN
      478    14890    4               IF KL$WTBLK.IO.OUTPUT

  14890  3 000173   000200 316007                    CANQ    128,DL
         3 000174   000201 600000 3                  TZE     s:14894

      479    14891    4               THEN
      480    14892    4                  FMT_VEC(2) = VECTOR(INOUT_STR);

  14892  3 000175   000016 237000 4                  LDAQ    14
         3 000176   000004 755000 xsym               STA     FMT_VEC+4
         3 000177   000005 756000 xsym               STQ     FMT_VEC+5
         3 000200   000216 710000 3                  TRA     s:14901

      481    14893    4               ELSE
      482    14894    4                  FMT_VEC(2) = VECTOR(IN_STR);

  14894  3 000201   000020 237000 4                  LDAQ    16
         3 000202   000004 755000 xsym               STA     FMT_VEC+4
         3 000203   000005 756000 xsym               STQ     FMT_VEC+5
         3 000204   000216 710000 3                  TRA     s:14901
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:86   

      483    14895    4            ELSE
      484    14896    4               IF KL$WTBLK.IO.OUTPUT

  14896  3 000205   000200 316007                    CANQ    128,DL
         3 000206   000213 600000 3                  TZE     s:14900

      485    14897    4               THEN
      486    14898    4                  FMT_VEC(2) = VECTOR(OUT_STR);

  14898  3 000207   000022 237000 4                  LDAQ    18
         3 000210   000004 755000 xsym               STA     FMT_VEC+4
         3 000211   000005 756000 xsym               STQ     FMT_VEC+5
         3 000212   000216 710000 3                  TRA     s:14901

      487    14899    4               ELSE
      488    14900    4                  FMT_VEC(2) = VECTOR(NONE_STR);

  14900  3 000213   000024 237000 4                  LDAQ    20
         3 000214   000004 755000 xsym               STA     FMT_VEC+4
         3 000215   000005 756000 xsym               STQ     FMT_VEC+5

      489    14901    4            FMT_VEC(3) = VECTOR (KL$WTBLK.PNAME.TXT);

  14901  3 000216   000015 235000 4                  LDA     13
         3 000217   000001 236000 1                  LDQ     P$
         3 000220   000026 036000 4                  ADLQ    22
         3 000221   000006 755000 xsym               STA     FMT_VEC+6
         3 000222   000007 756000 xsym               STQ     FMT_VEC+7

      490    14902    4            FMT_VEC(4) = VECTOR(BLANK);

  14902  3 000223   177640 235007                    LDA     65440,DL
         3 000224   200030 452500                    STP2    I+2,,AUTO
         3 000225   200030 236100                    LDQ     I+2,,AUTO
         3 000226   000022 036003                    ADLQ    18,DU
         3 000227   000010 755000 xsym               STA     FMT_VEC+8
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:87   
         3 000230   000011 756000 xsym               STQ     FMT_VEC+9

      491    14903    4            FMT_VEC(5) = VECTOR(ZERO);

  14903  3 000231   777640 235007                    LDA     -96,DL
         3 000232   200030 452500                    STP2    I+2,,AUTO
         3 000233   200030 236100                    LDQ     I+2,,AUTO
         3 000234   000021 036003                    ADLQ    17,DU
         3 000235   000012 755000 xsym               STA     FMT_VEC+10
         3 000236   000013 756000 xsym               STQ     FMT_VEC+11

      492    14904    5            DO J=0 TO KL$WTBLK.NATR-1;

  14904  3 000237   200005 450100                    STZ     J,,AUTO
         3 000240   000336 710000 3                  TRA     s:14924+1

      493    14905    5               REPEATS = -1;

  14905  3 000241   000001 335007                    LCA     1,DL
         3 000242   200007 755100                    STA     REPEATS,,AUTO

      494    14906    6               DO K=0 TO 7;

  14906  3 000243   200006 450100                    STZ     K,,AUTO

      495    14907    6                  IF ATTR_TBL.MASK(K) & KL$WTBLK.ATTRS(J)

  14907  3 000244   200005 235100                    LDA     J,,AUTO
         3 000245   000001 735000                    ALS     1
         3 000246   000001 470400 1                  LDP0    P$
         3 000247   000100 100505                    MLR     fill='000'O
         3 000250   000005 000002                    ADSC9   5,A,PR0                  cn=0,n=2
         3 000251   200030 000004                    ADSC9   I+2,,AUTO                cn=0,n=4
         3 000252   200006 236100                    LDQ     K,,AUTO
         3 000253   000003 402007                    MPY     3,DL
         3 000254   000072 236006 2                  LDQ     ATTR_TBL,QL
         3 000255   777777 376003                    ANQ     -1,DU
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:88   
         3 000256   200030 376100                    ANQ     I+2,,AUTO
         3 000257   000310 600000 3                  TZE     s:14918

      496    14908    7                  THEN DO;        /* This attribute exists              */

      497    14909    7                     FMT_VEC(FDS.NVECS#) = VECTOR(ATTR_TBL.ATTR(K));

  14909  3 000260   000011 235000 xsym               LDA     FDS+9
         3 000261   000001 735000                    ALS     1
         3 000262   000000 620005                    EAX0    0,AL
         3 000263   000027 235000 4                  LDA     23
         3 000264   200006 236100                    LDQ     K,,AUTO
         3 000265   200030 755100                    STA     I+2,,AUTO
         3 000266   000003 402003                    MPY     3,DU
         3 000267   000030 036000 4                  ADLQ    24
         3 000270   200030 235100                    LDA     I+2,,AUTO
         3 000271   000000 755010 xsym               STA     FMT_VEC,X0
         3 000272   000001 756010 xsym               STQ     FMT_VEC+1,X0

      498    14910    7                     FDS.NVECS# = FDS.NVECS# + 1;

  14910  3 000273   000011 054000 xsym               AOS     FDS+9

      499    14911    7                     REPEATS = REPEATS + 1;

  14911  3 000274   200007 054100                    AOS     REPEATS,,AUTO

      500    14912    7                     IF REPEATS=0

  14912  3 000275   000310 601000 3                  TNZ     s:14918

      501    14913    8                     THEN DO;

      502    14914    8                        FMT_VEC(FDS.NVECS#) = VECTOR(REPEATS);

  14914  3 000276   000011 235000 xsym               LDA     FDS+9
         3 000277   000001 735000                    ALS     1
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:89   
         3 000300   000000 620005                    EAX0    0,AL
         3 000301   777640 235007                    LDA     -96,DL
         3 000302   200030 452500                    STP2    I+2,,AUTO
         3 000303   200030 236100                    LDQ     I+2,,AUTO
         3 000304   000007 036003                    ADLQ    7,DU
         3 000305   000000 755010 xsym               STA     FMT_VEC,X0
         3 000306   000001 756010 xsym               STQ     FMT_VEC+1,X0

      503    14915    8                        FDS.NVECS# = FDS.NVECS# + 1;

  14915  3 000307   000011 054000 xsym               AOS     FDS+9

      504    14916    8                        END; /*  Repeats = 0  */

      505    14917    7                     END; /*  This attribute exists  */

      506    14918    6                  END; /*  Do k = 0 to 7  */

  14918  3 000310   200006 054100                    AOS     K,,AUTO
         3 000311   200006 235100                    LDA     K,,AUTO
         3 000312   000007 115007                    CMPA    7,DL
         3 000313   000244 604400 3                  TMOZ    s:14907

      507    14919    5               IF FDS.NVECS# = 4 THEN FDS.NVECS# = 6;

  14919  3 000314   000011 236000 xsym               LDQ     FDS+9
         3 000315   000004 116007                    CMPQ    4,DL
         3 000316   000321 601000 3                  TNZ     s:14920

  14919  3 000317   000006 235007                    LDA     6,DL
         3 000320   000011 755000 xsym               STA     FDS+9

      508    14920    5               CALL X$FORMAT(FDS);

  14920  3 000321   000004 630400 4                  EPPR0   4
         3 000322   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000323   000000 701000 xent               TSX1    X$FORMAT
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:90   
         3 000324   000000 011000                    NOP     0

      509    14921    5               FMT_BUF = WSN_ATTR_FMT;

  14921  3 000325   040000 100400                    MLR     fill='040'O
         3 000326   000066 000020 2                  ADSC9   WSN_ATTR_FMT             cn=0,n=16
         3 000327   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      510    14922    5               FDS.FMT_.BOUND = SIZEC(WSN_ATTR_FMT) - 1;

  14922  3 000330   000000 236000 xsym               LDQ     FDS
         3 000331   177777 376007                    ANQ     65535,DL
         3 000332   000031 276000 4                  ORQ     25
         3 000333   000000 756000 xsym               STQ     FDS

      511    14923    5               FDS.NVECS# = 0;

  14923  3 000334   000011 450000 xsym               STZ     FDS+9

      512    14924    5               END; /*  Do j  */

  14924  3 000335   200005 054100                    AOS     J,,AUTO
         3 000336   000001 470400 1                  LDP0    P$
         3 000337   200005 236100                    LDQ     J,,AUTO
         3 000340   000241 604000 3                  TMI     s:14905
         3 000341   000004 116100                    CMPQ    4,,PR0
         3 000342   000241 602000 3                  TNC     s:14905

      513    14925    4            END; /*  Do i  */

  14925  3 000343   200004 054100                    AOS     I,,AUTO
         3 000344   000000 470400 1                  LDP0    WSNHDR$
         3 000345   200004 236100                    LDQ     I,,AUTO
         3 000346   000131 604000 3                  TMI     s:14882
         3 000347   000003 116100                    CMPQ    3,,PR0
         3 000350   000131 602000 3                  TNC     s:14882

PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:91   
      514    14926    3         END; /*  Not indirect  */

      515    14927    2      END;  /*  Not jcl  */

  14927  3 000351   001160 710000 3                  TRA     s:15103

      516    14928    2   ELSE DO;   /*  Jcl  */

      517    14929    2      FMT_BUF = WSN_JCL_FMT;

  14929  3 000352   040000 100400                    MLR     fill='040'O
         3 000353   000010 000016 2                  ADSC9   WSN_JCL_FMT              cn=0,n=14
         3 000354   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      518    14930    2      FDS.FMT_.BOUND = SIZEC(WSN_JCL_FMT)-1;

  14930  3 000355   000000 236000 xsym               LDQ     FDS
         3 000356   177777 376007                    ANQ     65535,DL
         3 000357   000032 276000 4                  ORQ     26
         3 000360   000000 756000 xsym               STQ     FDS

      519    14931    2      FDS.NVECS# = 1;

  14931  3 000361   000001 235007                    LDA     1,DL
         3 000362   000011 755000 xsym               STA     FDS+9

      520    14932    3      IF KL$WSNHDR.INDIRECT# THEN DO;

  14932  3 000363   000000 471400 1                  LDP1    WSNHDR$
         3 000364   100000 234100                    SZN     0,,PR1
         3 000365   000415 605000 3                  TPL     s:14940

      521    14933    3         SUBSTR (FMT_BUF,FDS.FMT_.BOUND+1,SIZEC(FOR_INDIRECT_FMT)) = FOR_INDIRECT_FMT;

  14933  3 000366   000000 236000 xsym               LDQ     FDS
         3 000367   000020 772000                    QRL     16
         3 000370   040006 100400                    MLR     fill='040'O
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:92   
         3 000371   000020 000031 2                  ADSC9   FOR_INDIRECT_FMT         cn=0,n=25
         3 000372   000000 200031 xsym               ADSC9   FMT_BUF,Q                cn=1,n=25

      522    14934    3         FDS.FMT_.BOUND = FDS.FMT_.BOUND + SIZEC (FOR_INDIRECT_FMT);

  14934  3 000373   000031 036007                    ADLQ    25,DL
         3 000374   000020 736000                    QLS     16
         3 000375   000000 676000 xsym               ERQ     FDS
         3 000376   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 000377   000000 656000 xsym               ERSQ    FDS

      523    14935    3         FDS.NVECS# = 3;

  14935  3 000400   000003 236007                    LDQ     3,DL
         3 000401   000011 756000 xsym               STQ     FDS+9

      524    14936    3         FMT_VEC (1) = VECTOR ( KL$INDIRECT_WSN.INDIRECT_WSN );

  14936  3 000402   000000 235000 4                  LDA     0
         3 000403   000000 236000 1                  LDQ     WSNHDR$
         3 000404   000003 036003                    ADLQ    3,DU
         3 000405   000002 755000 xsym               STA     FMT_VEC+2
         3 000406   000003 756000 xsym               STQ     FMT_VEC+3

      525    14937    3         FMT_VEC (2) = VECTOR ( KL$INDIRECT_WSN.NODE );

  14937  3 000407   000000 235000 4                  LDA     0
         3 000410   000000 236000 1                  LDQ     WSNHDR$
         3 000411   000001 036003                    ADLQ    1,DU
         3 000412   000004 755000 xsym               STA     FMT_VEC+4
         3 000413   000005 756000 xsym               STQ     FMT_VEC+5

      526    14938    3         END;  /*  INDIRECT#  */

  14938  3 000414   000442 710000 3                  TRA     s:14946

      527    14939    2      ELSE
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:93   
      528    14940    3         IF KL$WSNHDR.TNAME ~= ' ' THEN DO;

  14940  3 000415   040000 106500                    CMPC    fill='040'O
         3 000416   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         3 000417   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000420   000442 600000 3                  TZE     s:14946

      529    14941    3            SUBSTR (FMT_BUF,FDS.FMT_.BOUND+1, SIZEC(FOR_STAT_FMT)) = FOR_STAT_FMT;

  14941  3 000421   000000 236000 xsym               LDQ     FDS
         3 000422   000020 772000                    QRL     16
         3 000423   040006 100400                    MLR     fill='040'O
         3 000424   000014 000020 2                  ADSC9   FOR_STAT_FMT             cn=0,n=16
         3 000425   000000 200020 xsym               ADSC9   FMT_BUF,Q                cn=1,n=16

      530    14942    3            FDS.FMT_.BOUND = FDS.FMT_.BOUND + SIZEC(FOR_STAT_FMT);

  14942  3 000426   000020 036007                    ADLQ    16,DL
         3 000427   000020 736000                    QLS     16
         3 000430   000000 676000 xsym               ERQ     FDS
         3 000431   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 000432   000000 656000 xsym               ERSQ    FDS

      531    14943    3            FDS.NVECS# = 2;

  14943  3 000433   000002 236007                    LDQ     2,DL
         3 000434   000011 756000 xsym               STQ     FDS+9

      532    14944    3            FMT_VEC ( 1 ) = VECTOR (KL$WSNHDR.TNAME);

  14944  3 000435   000000 235000 4                  LDA     0
         3 000436   000000 236000 1                  LDQ     WSNHDR$
         3 000437   000001 036003                    ADLQ    1,DU
         3 000440   000002 755000 xsym               STA     FMT_VEC+2
         3 000441   000003 756000 xsym               STQ     FMT_VEC+3

      533    14945    3            END; /*  Non blank station name  */
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:94   

      534    14946    2      CALL X$FORMAT (FDS);

  14946  3 000442   000004 630400 4                  EPPR0   4
         3 000443   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000444   000000 701000 xent               TSX1    X$FORMAT
         3 000445   000000 011000                    NOP     0

      535    14947    2      FMT_BUF = '   ';

  14947  3 000446   040000 100400                    MLR     fill='040'O
         3 000447   000126 000003 2                  ADSC9   ATTR_TBL+28              cn=0,n=3
         3 000450   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      536    14948    2      FDS.FMT_.BOUND = 2;

  14948  3 000451   000000 236000 xsym               LDQ     FDS
         3 000452   177777 376007                    ANQ     65535,DL
         3 000453   400000 276007                    ORQ     -131072,DL
         3 000454   000000 756000 xsym               STQ     FDS

      537    14949    2      FDS.NVECS# = 0;

  14949  3 000455   000011 450000 xsym               STZ     FDS+9

      538    14950    2      P$ = PINCRW(WSNHDR$,KL$WSNHDR.ACCSDISP);

  14950  3 000456   000000 470400 1                  LDP0    WSNHDR$
         3 000457   000000 720100                    LXL0    0,,PR0
         3 000460   000000 636010                    EAQ     0,X0
         3 000461   000000 036000 1                  ADLQ    WSNHDR$
         3 000462   000001 756000 1                  STQ     P$

      539    14951    2      IF KL$ACBLK.ACCTS>0

  14951  3 000463   000001 471400 1                  LDP1    P$
         3 000464   100000 235100                    LDA     0,,PR1
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:95   
         3 000465   000474 600000 3                  TZE     s:14963

      540    14952    3      THEN DO;                       /* Access controls                    */

      541    14953    3         CALL ADD_ACCLIST;

  14953  3 000466   001165 701000 3                  TSX1    ADD_ACCLIST
         3 000467   000000 011000                    NOP     0

      542    14954    3         CALL X$FORMAT(FDS);

  14954  3 000470   000004 630400 4                  EPPR0   4
         3 000471   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000472   000000 701000 xent               TSX1    X$FORMAT
         3 000473   000000 011000                    NOP     0

      543    14955    3         END;

      544    14956        /**
      545    14957         **   Do the device commands
      546    14958         **/
      547    14959        /**/
      548    14960        /*        Read wsndev record from :WSN          */
      549    14961        /*        If not found give error message       */
      550    14962        /**/
      551    14963    3      IF NOT KL$WSNHDR.INDIRECT# THEN DO;

  14963  3 000474   000000 470400 1                  LDP0    WSNHDR$
         3 000475   000000 234100                    SZN     0,,PR0
         3 000476   001160 604000 3                  TMI     s:15103

      552    14964    3         SUBSTR (USERS_KEY.TXTC,8,7) = 'DEVICES';

  14964  3 000477   040000 100400                    MLR     fill='040'O
         3 000500   000127 000007 2                  ADSC9   ATTR_TBL+29              cn=0,n=7
         3 000501   000002 200007 xsym               ADSC9   USERS_KEY+2              cn=1,n=7

PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:96   
      553    14965    3         USERS_KEY.COUNT = 15;

  14965  3 000502   017000 236003                    LDQ     7680,DU
         3 000503   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      554    14966    3         WSNDEV_ARS = DSEG2SIZE;

  14966  3 000504   000000 235000 xsym               LDA     DSEG2SIZE
         3 000505   200010 755100                    STA     WSNDEV_ARS,,AUTO

      555    14967    4         CALL ASW$READ_WSN( DSEG2$, WSNDEV_ARS ) WHENALTRETURN DO;

  14967  3 000506   200010 631500                    EPPR1   WSNDEV_ARS,,AUTO
         3 000507   200031 451500                    STP1    I+3,,AUTO
         3 000510   000033 236000 4                  LDQ     27
         3 000511   200030 756100                    STQ     I+2,,AUTO
         3 000512   200030 630500                    EPPR0   I+2,,AUTO
         3 000513   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000514   000000 701000 xent               TSX1    ASW$READ_WSN
         3 000515   000517 702000 3                  TSX2    s:14983
         3 000516   000524 710000 3                  TRA     s:14991

      556    14968        /*E*  ERROR:     ASL-E$NOWSNDEV-C
      557    14969              MESSAGE:   WSN containing DEVICE names does not exist.
      558    14970        */
      559    14971                 %SCREAM( ERR#=E$NOWSNDEV, LEVEL=ERROR, MID='L' );

  14983  3 000517   000034 630400 4                  EPPR0   28
         3 000520   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000521   000000 701000 xent               TSX1    ASH$ERROR
         3 000522   000000 011000                    NOP     0

      560    14986    4            RETURN ;

  14986  3 000523   000000 702200 xent               TSX2  ! X66_ARET

      561    14987    4            END; /* WSNDEV_ERR altret from ASW$READ_WSN */
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:97   
      562    14988        /**
      563    14989         **   Find the devices type, number, and station name
      564    14990         **/
      565    14991    3         FMT_BUF = WSN_DEVICE_JCL;

  14991  3 000524   040000 100400                    MLR     fill='040'O
         3 000525   000045 000022 2                  ADSC9   WSN_DEVICE_JCL           cn=0,n=18
         3 000526   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      566    14992    3         FDS.FMT_.BOUND = SIZEC (WSN_DEVICE_JCL) - 1;

  14992  3 000527   000000 236000 xsym               LDQ     FDS
         3 000530   177777 376007                    ANQ     65535,DL
         3 000531   000035 276000 4                  ORQ     29
         3 000532   000000 756000 xsym               STQ     FDS

      567    14993    3         FDS.NVECS# = 2;

  14993  3 000533   000002 235007                    LDA     2,DL
         3 000534   000011 755000 xsym               STA     FDS+9

      568    14994    4         DO I = 0 TO KL$WSNDEV.NDEV - 1;

  14994  3 000535   200004 450100                    STZ     I,,AUTO
         3 000536   001062 710000 3                  TRA     LOOP_END+1

      569    14995    4            FOUND = %NO#;

  14995  3 000537   200017 450100                    STZ     FOUND,,AUTO

      570    14996    4            SUBSTR (USERS_KEY.TXTC,0,8) = KL$WSNDEV.DEV(I);

  14996  3 000540   200004 235100                    LDA     I,,AUTO
         3 000541   000003 735000                    ALS     3
         3 000542   000000 470400 xsym               LDP0    DSEG2$
         3 000543   040000 100505                    MLR     fill='040'O
         3 000544   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=8
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:98   
         3 000545   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8

      571    14997    4            USERS_KEY.COUNT = 8;

  14997  3 000546   010000 236003                    LDQ     4096,DU
         3 000547   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      572    14998    4            WSNDEV_ARS = DSEG3SIZE;

  14998  3 000550   000000 235000 xsym               LDA     DSEG3SIZE
         3 000551   200010 755100                    STA     WSNDEV_ARS,,AUTO

      573    14999    4            CALL ASB$READ_HLP (DSEG3$, WSNDEV_ARS, 3)

  14999  3 000552   000036 236000 4                  LDQ     30
         3 000553   200032 756100                    STQ     I+4,,AUTO
         3 000554   200010 631500                    EPPR1   WSNDEV_ARS,,AUTO
         3 000555   200031 451500                    STP1    I+3,,AUTO
         3 000556   000037 236000 4                  LDQ     31
         3 000557   200030 756100                    STQ     I+2,,AUTO
         3 000560   200030 630500                    EPPR0   I+2,,AUTO
         3 000561   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000562   000000 701000 xent               TSX1    ASB$READ_HLP
         3 000563   000565 702000 3                  TSX2    s:15001
         3 000564   000750 710000 3                  TRA     s:15056

      574    15000    5            WHENALTRETURN DO;

      575    15001    5               SUBSTR (USERS_KEY.TXTC,8,1) = '*';

  15001  3 000565   000052 236003                    LDQ     42,DU
         3 000566   000002 552020 xsym               STBQ    USERS_KEY+2,'20'O

      576    15002    5               USERS_KEY.COUNT = 9;

  15002  3 000567   011000 236003                    LDQ     4608,DU
         3 000570   000000 552040 xsym               STBQ    USERS_KEY,'40'O
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:99   

      577    15003    5               CALL ASB$READ_HLP (DSEG3$, WSNDEV_ARS, 3)

  15003  3 000571   000036 236000 4                  LDQ     30
         3 000572   200032 756100                    STQ     I+4,,AUTO
         3 000573   200010 630500                    EPPR0   WSNDEV_ARS,,AUTO
         3 000574   200031 450500                    STP0    I+3,,AUTO
         3 000575   000037 236000 4                  LDQ     31
         3 000576   200030 756100                    STQ     I+2,,AUTO
         3 000577   200030 630500                    EPPR0   I+2,,AUTO
         3 000600   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000601   000000 701000 xent               TSX1    ASB$READ_HLP
         3 000602   000604 702000 3                  TSX2    s:15006
         3 000603   000750 710000 3                  TRA     s:15056

      578    15004    6               WHENALTRETURN DO;

      579    15005        /*  must be an iom connected device or it doesn't exist*/
      580    15006    6                  TYPE = SUBSTR (KL$WSNDEV.DEV(I),0,2);

  15006  3 000604   200004 235100                    LDA     I,,AUTO
         3 000605   000001 735000                    ALS     1
         3 000606   000000 470400 xsym               LDP0    DSEG2$
         3 000607   000001 220105                    LDX0    1,AL,PR0
         3 000610   200014 740100                    STX0    TYPE,,AUTO

      581    15007    6                  NUM = SUBSTR (KL$WSNDEV.DEV(I),2,2);

  15007  3 000611   000001 721105                    LXL1    1,AL,PR0
         3 000612   200015 741100                    STX1    NUM,,AUTO

      582    15008    6                  TWSN_CHRS = SUBSTR (KL$WSNDEV.DEV(I),4,4);

  15008  3 000613   000002 236105                    LDQ     2,AL,PR0
         3 000614   200016 756100                    STQ     TWSN_CHRS,,AUTO

      583    15009    6                  IF ((SUBSTR (TYPE,0,1) > '@') AND (SUBSTR (TYPE,0,1) < '{'))
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:100  

  15009  3 000615   200014 236100                    LDQ     TYPE,,AUTO
         3 000616   777000 376003                    ANQ     -512,DU
         3 000617   100000 116003                    CMPQ    32768,DU
         3 000620   000750 602000 3                  TNC     s:15056
         3 000621   000750 600000 3                  TZE     s:15056
         3 000622   200014 236100                    LDQ     TYPE,,AUTO
         3 000623   777000 376003                    ANQ     -512,DU
         3 000624   173000 116003                    CMPQ    62976,DU
         3 000625   000750 603000 3                  TRC     s:15056
         3 000626   200014 236100                    LDQ     TYPE,,AUTO
         3 000627   000777 376003                    ANQ     511,DU
         3 000630   000100 116003                    CMPQ    64,DU
         3 000631   000750 602000 3                  TNC     s:15056
         3 000632   000750 600000 3                  TZE     s:15056
         3 000633   200014 236100                    LDQ     TYPE,,AUTO
         3 000634   000777 376003                    ANQ     511,DU
         3 000635   000173 116003                    CMPQ    123,DU
         3 000636   000750 603000 3                  TRC     s:15056

      584    15010    6                       AND((SUBSTR (TYPE,1,1) > '@') AND (SUBSTR (TYPE,1,1) < '{'))
      585    15011    7                  THEN DO;

      586    15012    7                     IF ((SUBSTR (NUM,0,1) > '/') AND (SUBSTR (NUM,0,1) < ':'))

  15012  3 000637   200015 236100                    LDQ     NUM,,AUTO
         3 000640   777000 376003                    ANQ     -512,DU
         3 000641   057000 116003                    CMPQ    24064,DU
         3 000642   000750 602000 3                  TNC     s:15056
         3 000643   000750 600000 3                  TZE     s:15056
         3 000644   200015 236100                    LDQ     NUM,,AUTO
         3 000645   777000 376003                    ANQ     -512,DU
         3 000646   072000 116003                    CMPQ    29696,DU
         3 000647   000750 603000 3                  TRC     s:15056
         3 000650   200015 236100                    LDQ     NUM,,AUTO
         3 000651   000777 376003                    ANQ     511,DU
         3 000652   000057 116003                    CMPQ    47,DU
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:101  
         3 000653   000750 602000 3                  TNC     s:15056
         3 000654   000750 600000 3                  TZE     s:15056
         3 000655   200015 236100                    LDQ     NUM,,AUTO
         3 000656   000777 376003                    ANQ     511,DU
         3 000657   000072 116003                    CMPQ    58,DU
         3 000660   000750 603000 3                  TRC     s:15056

      587    15013    7                          AND((SUBSTR (NUM,1,1) > '/') AND (SUBSTR (NUM,1,1) < ':'))
      588    15014    8                     THEN DO;

      589    15015    8                        CALL CONCAT (USERS_KEY.TXTC,'TWSN',TWSN_CHRS);

  15015  3 000661   040000 100400                    MLR     fill='040'O
         3 000662   000132 000004 2                  ADSC9   ATTR_TBL+32              cn=0,n=4
         3 000663   000000 200004 xsym               ADSC9   USERS_KEY                cn=1,n=4
         3 000664   040000 100500                    MLR     fill='040'O
         3 000665   200016 000004                    ADSC9   TWSN_CHRS,,AUTO          cn=0,n=4
         3 000666   000001 200045 xsym               ADSC9   USERS_KEY+1              cn=1,n=37

      590    15016    8                        USERS_KEY.COUNT = 8;

  15016  3 000667   010000 236003                    LDQ     4096,DU
         3 000670   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      591    15017    8                        CALL ASB$READ_HLP (DSEG3$, WSNDEV_ARS, 3)

  15017  3 000671   000036 236000 4                  LDQ     30
         3 000672   200032 756100                    STQ     I+4,,AUTO
         3 000673   200010 630500                    EPPR0   WSNDEV_ARS,,AUTO
         3 000674   200031 450500                    STP0    I+3,,AUTO
         3 000675   000037 236000 4                  LDQ     31
         3 000676   200030 756100                    STQ     I+2,,AUTO
         3 000677   200030 630500                    EPPR0   I+2,,AUTO
         3 000700   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000701   000000 701000 xent               TSX1    ASB$READ_HLP
         3 000702   000704 702000 3                  TSX2    NODEV_ERR
         3 000703   000721 710000 3                  TRA     s:15044
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:102  

      592    15018    9                        WHENALTRETURN DO;

      593    15019        /*E* ERROR: ASL-E$NODEV-C
      594    15020           MESSAGE: %U1 does not exist.
      595    15021           MESSAGE1: %U1 was found in the wsn device record but wasn't
      596    15022                     found in :HLP.
      597    15023        */
      598    15024    9   NODEV_ERR:
      599    15025    9                           AS_FIELD1.COUNT = 8;

  15025  3 000704   010000 236003       NODEV_ERR    LDQ     4096,DU
         3 000705   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      600    15026    9                           AS_FIELD1.TEXT = KL$WSNDEV.DEV(I);

  15026  3 000706   200004 235100                    LDA     I,,AUTO
         3 000707   000003 735000                    ALS     3
         3 000710   000000 470400 xsym               LDP0    DSEG2$
         3 000711   040000 100505                    MLR     fill='040'O
         3 000712   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=8
         3 000713   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      601    15027                                %SCREAM (ERR#=E$NODEV, LEVEL=WARN, MID='L');

  15037  3 000714   000040 630400 4                  EPPR0   32
         3 000715   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000716   000000 701000 xent               TSX1    ASH$WARN
         3 000717   000000 011000                    NOP     0

      602    15042    9                           GOTO LOOP_END;

  15042  3 000720   001061 710000 3                  TRA     LOOP_END

      603    15043    9                           END; /* Whenaltreturn from 3RD ASB$READ_HLP  */
      604    15044    8                        J = 0;

PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:103  
  15044  3 000721   200005 450100                    STZ     J,,AUTO

      605    15045    9                        DO WHILE (J < KL$TWSNREC.NDEV) AND (NOT FOUND);

  15045  3 000722   000737 710000 3                  TRA     s:15050

      606    15046    9                           IF KL$TWSNREC.DEVS.TYP(J) = TYPE THEN

  15046  3 000723   200005 236100                    LDQ     J,,AUTO
         3 000724   000013 402007                    MPY     11,DL
         3 000725   000000 470400 xsym               LDP0    DSEG3$
         3 000726   000005 220106                    LDX0    5,QL,PR0
         3 000727   200014 100100                    CMPX0   TYPE,,AUTO
         3 000730   000736 601000 3                  TNZ     s:15049

      607    15047    9                              IF KL$TWSNREC.DEVS.NUM(J) = NUM THEN

  15047  3 000731   000005 721106                    LXL1    5,QL,PR0
         3 000732   200015 101100                    CMPX1   NUM,,AUTO
         3 000733   000736 601000 3                  TNZ     s:15049

      608    15048    9                                 FOUND = %YES#;

  15048  3 000734   400000 236003                    LDQ     -131072,DU
         3 000735   200017 756100                    STQ     FOUND,,AUTO

      609    15049    9                           J = J + 1;

  15049  3 000736   200005 054100                    AOS     J,,AUTO

      610    15050    9                           END; /*  Do while j < KL$TWSNREC.NDEV and not found  */

  15050  3 000737   000000 470400 xsym               LDP0    DSEG3$
         3 000740   200005 236100                    LDQ     J,,AUTO
         3 000741   000744 604000 3                  TMI     s:15050+5
         3 000742   000004 116100                    CMPQ    4,,PR0
         3 000743   000746 603000 3                  TRC     s:15051
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:104  
         3 000744   200017 234100                    SZN     FOUND,,AUTO
         3 000745   000723 605000 3                  TPL     s:15046

      611    15051    8                        IF NOT FOUND THEN GOTO NODEV_ERR;

  15051  3 000746   200017 234100                    SZN     FOUND,,AUTO
         3 000747   000704 605000 3                  TPL     NODEV_ERR

      612    15052    8                        END; /*  Num is two digits */

      613    15053    7                     END; /*  Type is two characters */

      614    15054    6                  END; /* Whenaltreturn from 2ND ASB$READ_HLP  */

      615    15055    5               END; /* Whenaltreturn from 1ST ASB$READ_HLP  */

      616    15056    4            IF USERS_KEY.COUNT = 8 THEN

  15056  3 000750   000000 236000 xsym               LDQ     USERS_KEY
         3 000751   777000 376003                    ANQ     -512,DU
         3 000752   010000 116003                    CMPQ    4096,DU
         3 000753   000764 601000 3                  TNZ     s:15059

      617    15057    4               FMT_VEC ( 0 ) = VECTOR (SUBSTR (KL$WSNDEV.DEV(I),0,4) );

  15057  3 000754   777640 235007                    LDA     -96,DL
         3 000755   200004 236100                    LDQ     I,,AUTO
         3 000756   000023 736000                    QLS     19
         3 000757   000001 036003                    ADLQ    1,DU
         3 000760   000000 036000 xsym               ADLQ    DSEG2$
         3 000761   000000 755000 xsym               STA     FMT_VEC
         3 000762   000001 756000 xsym               STQ     FMT_VEC+1
         3 000763   000771 710000 3                  TRA     s:15060

      618    15058    4            ELSE
      619    15059    4               FMT_VEC ( 0 ) = VECTOR ( SUBSTR (KL$DREC.RENAME,0,4) );

PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:105  
  15059  3 000764   777640 235007                    LDA     -96,DL
         3 000765   000000 236000 xsym               LDQ     DSEG3$
         3 000766   000011 036003                    ADLQ    9,DU
         3 000767   000000 755000 xsym               STA     FMT_VEC
         3 000770   000001 756000 xsym               STQ     FMT_VEC+1

      620    15060    5            IF FOUND THEN DO; /* Need the 'TERM' record  */

  15060  3 000771   200017 234100                    SZN     FOUND,,AUTO
         3 000772   001050 605000 3                  TPL     s:15077

      621    15061    5               DEV = SUBSTR (KL$WSNDEV.DEV(I),0,4);

  15061  3 000773   200004 235100                    LDA     I,,AUTO
         3 000774   000001 735000                    ALS     1
         3 000775   000000 470400 xsym               LDP0    DSEG2$
         3 000776   000001 236105                    LDQ     1,AL,PR0
         3 000777   200020 756100                    STQ     DEV,,AUTO

      622    15062    5               FMT_VEC ( 0 ) = VECTOR ( DEV );

  15062  3 001000   777640 235007                    LDA     -96,DL
         3 001001   200030 452500                    STP2    I+2,,AUTO
         3 001002   200030 236100                    LDQ     I+2,,AUTO
         3 001003   000020 036003                    ADLQ    16,DU
         3 001004   000000 755000 xsym               STA     FMT_VEC
         3 001005   000001 756000 xsym               STQ     FMT_VEC+1

      623    15063    5               USERS_KEY.TXTC = 'TERM';

  15063  3 001006   040000 100400                    MLR     fill='040'O
         3 001007   000134 000004 2                  ADSC9   ATTR_TBL+34              cn=0,n=4
         3 001010   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41

      624    15064    5               USERS_KEY.COUNT = 4;

  15064  3 001011   004000 236003                    LDQ     2048,DU
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:106  
         3 001012   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      625    15065    5               WSNDEV_ARS = DSEG3SIZE;

  15065  3 001013   000000 235000 xsym               LDA     DSEG3SIZE
         3 001014   200010 755100                    STA     WSNDEV_ARS,,AUTO

      626    15066    5               CALL ASB$READ_HLP (DSEG3$, WSNDEV_ARS, 3)

  15066  3 001015   000036 236000 4                  LDQ     30
         3 001016   200032 756100                    STQ     I+4,,AUTO
         3 001017   200010 631500                    EPPR1   WSNDEV_ARS,,AUTO
         3 001020   200031 451500                    STP1    I+3,,AUTO
         3 001021   000037 236000 4                  LDQ     31
         3 001022   200030 756100                    STQ     I+2,,AUTO
         3 001023   200030 630500                    EPPR0   I+2,,AUTO
         3 001024   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 001025   000000 701000 xent               TSX1    ASB$READ_HLP
         3 001026   001042 702000 3                  TSX2    s:15072

      627    15067    6               WHENRETURN DO;

      628    15068    6                  CALL CHARBIN (J,TWSN_CHRS);

  15068  3 001027   000100 305500                    DTB
         3 001030   200016 030004                    NDSC9   TWSN_CHRS,,AUTO          cn=0,s=nosgn,sf=0,n=4
         3 001031   200005 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      629    15069    6                  FMT_VEC ( 1 ) = VECTOR ( KL$WSNCVT.WSN(J) );

  15069  3 001032   000000 235000 4                  LDA     0
         3 001033   200005 236100                    LDQ     J,,AUTO
         3 001034   000023 736000                    QLS     19
         3 001035   000002 036003                    ADLQ    2,DU
         3 001036   000000 036000 xsym               ADLQ    DSEG3$
         3 001037   000002 755000 xsym               STA     FMT_VEC+2
         3 001040   000003 756000 xsym               STQ     FMT_VEC+3
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:107  

      630    15070    6                  END; /* Whenreturn from READ_HLP */

  15070  3 001041   001047 710000 3                  TRA     s:15075

      631    15071    6               WHENALTRETURN DO;

      632    15072    6                  CALL ASH$ERROR (MERR_CODE);

  15072  3 001042   000041 630400 4                  EPPR0   33
         3 001043   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001044   000000 701000 xent               TSX1    ASH$ERROR
         3 001045   000000 011000                    NOP     0

      633    15073    6                  RETURN;

  15073  3 001046   000000 702200 xent               TSX2  ! X66_ARET

      634    15074    6                  END; /* Whenaltreturn from READ_HLP */
      635    15075    5               END; /*  If found  */

  15075  3 001047   001055 710000 3                  TRA     s:15078

      636    15076    4            ELSE
      637    15077    4               FMT_VEC ( 1 ) = VECTOR ( KL$DREC.SNAME );

  15077  3 001050   000000 235000 4                  LDA     0
         3 001051   000000 236000 xsym               LDQ     DSEG3$
         3 001052   000015 036003                    ADLQ    13,DU
         3 001053   000002 755000 xsym               STA     FMT_VEC+2
         3 001054   000003 756000 xsym               STQ     FMT_VEC+3

      638    15078    4            CALL X$FORMAT (FDS);

  15078  3 001055   000004 630400 4                  EPPR0   4
         3 001056   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001057   000000 701000 xent               TSX1    X$FORMAT
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:108  
         3 001060   000000 011000                    NOP     0

      639    15079    4   LOOP_END:
      640    15080    4            END; /*  Loop through all of the wsns devices  */

  15080  3 001061   200004 054100       LOOP_END     AOS     I,,AUTO
         3 001062   000000 470400 xsym               LDP0    DSEG2$
         3 001063   200004 236100                    LDQ     I,,AUTO
         3 001064   000537 604000 3                  TMI     s:14995
         3 001065   000000 116100                    CMPQ    0,,PR0
         3 001066   000537 602000 3                  TNC     s:14995

      641    15081        /**
      642    15082         ** Do the default forms
      643    15083         **/
      644    15084    4         DO I=0 TO KL$WSNHDR.NTYP-1;

  15084  3 001067   200004 450100                    STZ     I,,AUTO
         3 001070   001136 710000 3                  TRA     s:15094+1

      645    15085    4            P$ = PINCRW(WSNHDR$,KL$WSNHDR.TYPS.DISP(I));

  15085  3 001071   000000 470400 1                  LDP0    WSNHDR$
         3 001072   200004 720100                    LXL0    I,,AUTO
         3 001073   000004 721110                    LXL1    4,X0,PR0
         3 001074   000000 636011                    EAQ     0,X1
         3 001075   000000 036000 1                  ADLQ    WSNHDR$
         3 001076   000001 756000 1                  STQ     P$

      646    15086    5            IF KL$WTBLK.FNAME ~= ' ' THEN DO;

  15086  3 001077   000001 471400 1                  LDP1    P$
         3 001100   040000 106500                    CMPC    fill='040'O
         3 001101   100002 000006                    ADSC9   2,,PR1                   cn=0,n=6
         3 001102   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001103   001135 600000 3                  TZE     s:15094

PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:109  
      647    15087    5               FMT_BUF = WSN_DFORM_JCL;

  15087  3 001104   040000 100400                    MLR     fill='040'O
         3 001105   000041 000017 2                  ADSC9   WSN_DFORM_JCL            cn=0,n=15
         3 001106   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      648    15088    5               FDS.FMT_.BOUND = SIZEC(WSN_DFORM_JCL) - 1;

  15088  3 001107   000000 236000 xsym               LDQ     FDS
         3 001110   177777 376007                    ANQ     65535,DL
         3 001111   000042 276000 4                  ORQ     34
         3 001112   000000 756000 xsym               STQ     FDS

      649    15089    5               FDS.NVECS# = 2;

  15089  3 001113   000002 235007                    LDA     2,DL
         3 001114   000011 755000 xsym               STA     FDS+9

      650    15090    5               FMT_VEC(0) = VECTOR(KL$WSNHDR.TYPS.TYP(I));

  15090  3 001115   377640 235007                    LDA     130976,DL
         3 001116   200004 236100                    LDQ     I,,AUTO
         3 001117   000022 736000                    QLS     18
         3 001120   000004 036003                    ADLQ    4,DU
         3 001121   000000 036000 1                  ADLQ    WSNHDR$
         3 001122   000000 755000 xsym               STA     FMT_VEC
         3 001123   000001 756000 xsym               STQ     FMT_VEC+1

      651    15091    5               FMT_VEC(1) = VECTOR(KL$WTBLK.FNAME);

  15091  3 001124   000014 235000 4                  LDA     12
         3 001125   000001 236000 1                  LDQ     P$
         3 001126   000002 036003                    ADLQ    2,DU
         3 001127   000002 755000 xsym               STA     FMT_VEC+2
         3 001130   000003 756000 xsym               STQ     FMT_VEC+3

      652    15092    5               CALL X$FORMAT(FDS);
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:110  

  15092  3 001131   000004 630400 4                  EPPR0   4
         3 001132   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001133   000000 701000 xent               TSX1    X$FORMAT
         3 001134   000000 011000                    NOP     0

      653    15093    5               END; /* Formname not blank  */

      654    15094    4            END; /* Do number of types in wsn header  */

  15094  3 001135   200004 054100                    AOS     I,,AUTO
         3 001136   000000 470400 1                  LDP0    WSNHDR$
         3 001137   200004 236100                    LDQ     I,,AUTO
         3 001140   001071 604000 3                  TMI     s:15085
         3 001141   000003 116100                    CMPQ    3,,PR0
         3 001142   001071 602000 3                  TNC     s:15085

      655    15095    3         SUBSTR (USERS_KEY.TXTC,0,9) = SAVE_KEY;

  15095  3 001143   040000 100500                    MLR     fill='040'O
         3 001144   200011 000011                    ADSC9   SAVE_KEY,,AUTO           cn=0,n=9
         3 001145   000000 200011 xsym               ADSC9   USERS_KEY                cn=1,n=9

      656    15096    3         USERS_KEY.COUNT = 9;

  15096  3 001146   011000 236003                    LDQ     4608,DU
         3 001147   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      657    15097    3         CALL ASW$PREC_AND_SKIP_WSN

  15097  3 001150   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 001151   000000 701000 xent               TSX1    ASW$PREC_AND_SKIP_WSN
         3 001152   001154 702000 3                  TSX2    s:15099
         3 001153   001160 710000 3                  TRA     s:15103

      658    15098    4         WHENALTRETURN DO;

PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:111  
      659    15099    4            CALL ASH$ERROR (MERR_CODE);

  15099  3 001154   000041 630400 4                  EPPR0   33
         3 001155   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001156   000000 701000 xent               TSX1    ASH$ERROR
         3 001157   000000 011000                    NOP     0

      660    15100    4            END; /*  Whenaltreturn from ASW$PREC_AND_SKIP_WSN  */

      661    15101    3         END; /*  Not INDIRECT#  */

      662    15102    2      END;   /*  Jcl  */

      663    15103    1   CALL ASB$WRITE_LO (' ',1);

  15103  3 001160   000002 630400 4                  EPPR0   2
         3 001161   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001162   000000 701000 xent               TSX1    ASB$WRITE_LO
         3 001163   000000 011000                    NOP     0

      664    15104    1   RETURN;

  15104  3 001164   000000 702200 xent               TSX2  ! X66_ARET

      665    15105        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:112  
      666    15106    1   ADD_ACCLIST: PROC;

  15106  3 001165   200024 741300       ADD_ACCLIST  STX1  ! BLANK+2,,AUTO

      667    15107    2   DCL REPEATS SBIN;
      668    15108    2   DCL I SBIN;
      669    15109    2   CALL INSERT(FMT_BUF,FDS.FMT_.BOUND+1,SIZEC(WSN_ACC_FMT),

  15109  3 001166   000000 236000 xsym               LDQ     FDS
         3 001167   000020 772000                    QRL     16
         3 001170   040006 100400                    MLR     fill='040'O
         3 001171   000060 000025 2                  ADSC9   WSN_ACC_FMT              cn=0,n=21
         3 001172   000000 200025 xsym               ADSC9   FMT_BUF,Q                cn=1,n=21

      670    15110    2        WSN_ACC_FMT);
      671    15111    2   FDS.FMT_.BOUND = FDS.FMT_.BOUND + SIZEC(WSN_ACC_FMT);

  15111  3 001173   000025 036007                    ADLQ    21,DL
         3 001174   000020 736000                    QLS     16
         3 001175   000000 676000 xsym               ERQ     FDS
         3 001176   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 001177   000000 656000 xsym               ERSQ    FDS

      672    15112    2   FMT_VEC(FDS.NVECS#) = VECTOR(KL$ACBLK.LIST(0));

  15112  3 001200   000011 235000 xsym               LDA     FDS+9
         3 001201   000001 735000                    ALS     1
         3 001202   000000 620005                    EAX0    0,AL
         3 001203   000000 235000 4                  LDA     0
         3 001204   000001 236000 1                  LDQ     P$
         3 001205   000001 036003                    ADLQ    1,DU
         3 001206   000000 755010 xsym               STA     FMT_VEC,X0
         3 001207   000001 756010 xsym               STQ     FMT_VEC+1,X0

      673    15113    2   FMT_VEC(FDS.NVECS#+1) = VECTOR(REPEATS);

  15113  3 001210   777640 235007                    LDA     -96,DL
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:113  
         3 001211   200030 452500                    STP2    I+2,,AUTO
         3 001212   200030 236100                    LDQ     I+2,,AUTO
         3 001213   000025 036003                    ADLQ    21,DU
         3 001214   000002 755010 xsym               STA     FMT_VEC+2,X0
         3 001215   000003 756010 xsym               STQ     FMT_VEC+3,X0

      674    15114    2   FDS.NVECS# = FDS.NVECS# + 2;

  15114  3 001216   000002 236007                    LDQ     2,DL
         3 001217   000011 056000 xsym               ASQ     FDS+9

      675    15115    2   REPEATS = 0;

  15115  3 001220   200025 450100                    STZ     REPEATS,,AUTO

      676    15116    3   DO I=1 TO KL$ACBLK.ACCTS-1;

  15116  3 001221   000001 235007                    LDA     1,DL
         3 001222   200026 755100                    STA     I,,AUTO
         3 001223   001241 710000 3                  TRA     s:15120+1

      677    15117    3      FMT_VEC(FDS.NVECS#) = VECTOR(KL$ACBLK.LIST(I));

  15117  3 001224   000011 235000 xsym               LDA     FDS+9
         3 001225   000001 735000                    ALS     1
         3 001226   000000 620005                    EAX0    0,AL
         3 001227   000000 235000 4                  LDA     0
         3 001230   200026 236100                    LDQ     I,,AUTO
         3 001231   000023 736000                    QLS     19
         3 001232   000001 036003                    ADLQ    1,DU
         3 001233   000001 036000 1                  ADLQ    P$
         3 001234   000000 755010 xsym               STA     FMT_VEC,X0
         3 001235   000001 756010 xsym               STQ     FMT_VEC+1,X0

      678    15118    3      FDS.NVECS# = FDS.NVECS# + 1;

  15118  3 001236   000011 054000 xsym               AOS     FDS+9
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:114  

      679    15119    3      REPEATS = REPEATS + 1;

  15119  3 001237   200025 054100                    AOS     REPEATS,,AUTO

      680    15120    3      END;

  15120  3 001240   200026 054100                    AOS     I,,AUTO
         3 001241   000001 470400 1                  LDP0    P$
         3 001242   200026 236100                    LDQ     I,,AUTO
         3 001243   001224 604000 3                  TMI     s:15117
         3 001244   000000 116100                    CMPQ    0,,PR0
         3 001245   001224 602000 3                  TNC     s:15117

      681    15121    2   RETURN;

  15121  3 001246   200024 221300                    LDX1  ! BLANK+2,,AUTO
         3 001247   000001 702211                    TSX2  ! 1,X1
      682    15122    2   END ADD_ACCLIST;
      683    15123    1   END ASL$DISP_ONE_WORKSTATION;

PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:115  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_WORKSTATION.
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:116  

 **** Variables and constants ****

  ****  Section 001  Data  ASL$DISP_ONE_WORKSTATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/w PTR         r     1 P$                         0-0-0/w PTR         r     1 WSNHDR$

  ****  Section 002 RoData ASL$DISP_ONE_WORKSTATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    72-0-0/c STRC(108)   r     1 ATTR_TBL(0:7)
    20-0-0/c CHAR(25)    r     1 FOR_INDIRECT_FMT          14-0-0/c CHAR(16)    r     1 FOR_STAT_FMT
     0-0-0/c CHAR(8)     r     1 INDIRECT_STR               2-0-0/c CHAR(5)     r     1 INOUT_STR
     4-0-0/c CHAR(2)     r     1 IN_STR                     6-0-0/c CHAR(4)     r     1 NONE_STR
     5-0-0/c CHAR(3)     r     1 OUT_STR                   60-0-0/c CHAR(21)    r     1 WSN_ACC_FMT
    66-0-0/c CHAR(16)    r     1 WSN_ATTR_FMT              45-0-0/c CHAR(18)    r     1 WSN_DEVICE_JCL
    52-0-0/c CHAR(23)    r     1 WSN_DEV_FMT               27-0-0/c CHAR(40)    r     1 WSN_DEV_HDR
    41-0-0/c CHAR(15)    r     1 WSN_DFORM_JCL              7-0-0/c CHAR(3)     r     1 WSN_HDR_FMT
    10-0-0/c CHAR(14)    r     1 WSN_JCL_FMT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @JCL                      22-0-0/c CHAR        r     1 BLANK
    20-0-0/c CHAR(4)     r     1 DEV                       17-0-0/b BIT         r     1 FOUND
     4-0-0/w SBIN        r     1 I                         26-0-0/w SBIN        r     1 I
     5-0-0/w SBIN        r     1 J                         *0-0-0/b BIT         r     1 JCL
     6-0-0/w SBIN        r     1 K                         15-0-0/c CHAR(2)     r     1 NUM
     7-0-0/w SBIN        r     1 REPEATS                   25-0-0/w SBIN        r     1 REPEATS
    11-0-0/c CHAR(9)     r     1 SAVE_KEY                  16-0-0/c CHAR(4)     r     1 TWSN_CHRS
    14-0-0/c CHAR(2)     r     1 TYPE                      10-0-0/w SBIN        r     1 WSNDEV_ARS
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:117  
    21-0-0/w SBIN        r     1 ZERO

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w PTR         r     1 DSEG1$
     0-0-0/w PTR         r     1 DSEG2$                     0-0-0/w UBIN        r     1 DSEG2SIZE
     0-0-0/w PTR         r     1 DSEG3$                     0-0-0/w UBIN        r     1 DSEG3SIZE
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/w STRC(1080)  r     1 FDS
     0-0-0/c CHAR(255)   r     1 FMT_BUF                    0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)
     0-0-0/b STRC        r     1 MERR_CODE                  0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(8)     r     1 CHAR$8                     0-0-0/w STRC(108)   r     1 KL$ACBLK
     0-0-0/w STRC(576)   r     1 KL$DREC                    0-0-0/w STRC(180)   r     1 KL$INDIRECT_WSN
     0-0-0/w STRC(576)   r     1 KL$TWSNREC                 0-0-0/w STRC(144)   r     1 KL$WSNCVT
     0-0-0/w STRC(108)   r     1 KL$WSNDEV                  0-0-0/w STRC(180)   r     1 KL$WSNHDR
     0-0-0/w STRC(576)   r     1 KL$WTBLK


   Procedure ASL$DISP_ONE_WORKSTATION requires 680 words for executable code.
   Procedure ASL$DISP_ONE_WORKSTATION requires 28 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_WORKSTATIONS.:E05TSI    .
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:118  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:119  
          MINI XREF LISTING

ADD_ACCLIST
     15106**PROC    14864--CALL    14953--CALL
ASA_BRKS_LOC
     11702**DCL     11702--REDEF
ASB$READ_HLP
     14568**DCL-ENT 14999--CALL    15003--CALL    15017--CALL    15066--CALL
ASB$WRITE_LO
     14571**DCL-ENT 14856--CALL    14857--CALL    14866--CALL    14877--CALL    15103--CALL
ASH$ERROR
     14574**DCL-ENT 14983--CALL    15072--CALL    15099--CALL
ASH$WARN
     14583**DCL-ENT 15037--CALL
ASW$PREC_AND_SKIP_WSN
     14577**DCL-ENT 15097--CALL
ASW$READ_WSN
     14580**DCL-ENT 14967--CALL
AS_DEFAULT.BANNER_PERM
     12395**DCL     12396--REDEF
AS_DEFAULT.BUDGET.MACCT
     12300**DCL     12304--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     12313**DCL     12316--REDEF
AS_DEFAULT.BUDGET.PACCUM
     12296**DCL     12298--REDEF
AS_DEFAULT.BUDGET.PMAXC
     12291**DCL     12293--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     12411**DCL     12412--REDEF   12413--REDEF
AS_DEFAULT_DREC.PASSWORD
     13665**DCL     13669--REDEF
AS_DEFAULT_DREC.RENAME
     13688**DCL     13689--REDEF
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:120  
AS_DFLT.BANNER_PERM
     12217**DCL     12218--REDEF
AS_DFLT.BUDGET.MACCT
     12122**DCL     12126--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     12135**DCL     12138--REDEF
AS_DFLT.BUDGET.PACCUM
     12118**DCL     12120--REDEF
AS_DFLT.BUDGET.PMAXC
     12113**DCL     12115--REDEF
AS_DFLT.SETUP_CHRA.TXT
     12233**DCL     12234--REDEF   12235--REDEF
AS_FE_MODE
     11568**DCL     11569--REDEF
AS_FIELD1.COUNT
     11699**DCL     15025<<ASSIGN
AS_FIELD1.TEXT
     11699**DCL     15026<<ASSIGN
AS_MODE
     11565**DCL     11567--REDEF
AS_MOD_USER.ACCESS
     14430**DCL     14431--REDEF
AS_MOD_USER.BANNER
     14417**DCL     14418--REDEF
AS_MOD_USER.BANNER_PERM
     14419**DCL     14420--REDEF
AS_MOD_USER.BILL
     14425**DCL     14426--REDEF
AS_MOD_USER.CPROC
     14421**DCL     14422--REDEF
AS_MOD_USER.FEBILL
     14501**DCL     14502--REDEF
AS_MOD_USER.FECXTMEM
     14518**DCL     14519--REDEF
AS_MOD_USER.FEMINTS
     14503**DCL     14504--REDEF
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:121  
AS_MOD_USER.FEMMEM
     14514**DCL     14515--REDEF
AS_MOD_USER.FEMTIME
     14512**DCL     14513--REDEF
AS_MOD_USER.FEPPRIV
     14509**DCL     14511--REDEF
AS_MOD_USER.FEPRIV
     14506**DCL     14508--REDEF
AS_MOD_USER.FORCE_BIT
     14415**DCL     14416--REDEF
AS_MOD_USER.KEY
     14497**DCL     14499--REDEF
AS_MOD_USER.LASTCPROC
     14423**DCL     14424--REDEF
AS_MOD_USER.LIMITS.DO_
     14471**DCL     14472--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     14487**DCL     14488--REDEF
AS_MOD_USER.LIMITS.LO
     14467**DCL     14468--REDEF
AS_MOD_USER.LIMITS.MEM
     14463**DCL     14464--REDEF
AS_MOD_USER.LIMITS.MPRIO
     14491**DCL     14492--REDEF
AS_MOD_USER.LIMITS.PDIS
     14479**DCL     14480--REDEF
AS_MOD_USER.LIMITS.PO
     14475**DCL     14476--REDEF
AS_MOD_USER.LIMITS.TDIS
     14483**DCL     14484--REDEF
AS_MOD_USER.LIMITS.TIME
     14459**DCL     14460--REDEF
AS_MOD_USER.MAXENQ
     14440**DCL     14441--REDEF
AS_MOD_USER.PERM_BIT
     14413**DCL     14414--REDEF
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:122  
AS_MOD_USER.PPRIV
     14435**DCL     14437--REDEF
AS_MOD_USER.PRIOB
     14442**DCL     14443--REDEF
AS_MOD_USER.PRIV
     14432**DCL     14434--REDEF
AS_MOD_USER.QUAN
     14438**DCL     14439--REDEF
AS_MOD_USER.SETUP
     14411**DCL     14412--REDEF
AS_PROJECT.BANNER_PERM
     12751**DCL     12752--REDEF
AS_PROJECT.BUDGET.MACCT
     12656**DCL     12660--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12669**DCL     12672--REDEF
AS_PROJECT.BUDGET.PACCUM
     12652**DCL     12654--REDEF
AS_PROJECT.BUDGET.PMAXC
     12647**DCL     12649--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12767**DCL     12768--REDEF   12769--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     12929**DCL     12930--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12834**DCL     12838--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12847**DCL     12850--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12830**DCL     12832--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12825**DCL     12827--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     12945**DCL     12946--REDEF   12947--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     14151**DCL     14155--REDEF
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:123  
AS_PROJECT_DFLT_DREC.RENAME
     14174**DCL     14175--REDEF
AS_PROJECT_DREC.PASSWORD
     13989**DCL     13993--REDEF
AS_PROJECT_DREC.RENAME
     14012**DCL     14013--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12573**DCL     12574--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     12478**DCL     12482--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     12491**DCL     12494--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     12474**DCL     12476--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     12469**DCL     12471--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12589**DCL     12590--REDEF   12591--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13827**DCL     13831--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13850**DCL     13851--REDEF
AS_USERS.BANNER_PERM
     12039**DCL     12040--REDEF
AS_USERS.BUDGET.MACCT
     11944**DCL     11948--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     11957**DCL     11960--REDEF
AS_USERS.BUDGET.PACCUM
     11940**DCL     11942--REDEF
AS_USERS.BUDGET.PMAXC
     11935**DCL     11937--REDEF
AS_USERS.SETUP_CHRA.TXT
     12055**DCL     12056--REDEF   12057--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     13107**DCL     13108--REDEF
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:124  
AS_USERS_CONSTANT.BUDGET.MACCT
     13012**DCL     13016--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     13025**DCL     13028--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     13008**DCL     13010--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     13003**DCL     13005--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     13123**DCL     13124--REDEF   13125--REDEF
ATTR_TBL.ATTR
     14844**DCL     14909--ASSIGN
ATTR_TBL.MASK
     14841**DCL     14907>>IF
BLANK
     14815**DCL     14852<<ASSIGN  14902--ASSIGN
CHAR$8
     14589**DCL     14853--ASSIGN
DEV
     14813**DCL     15061<<ASSIGN  15062--ASSIGN
DSEG1$
     11703**DCL     14850>>ASSIGN
DSEG2$
     11704**DCL     14725--IMP-PTR 14967<>CALL    14994>>DOINDEX 14996>>ASSIGN  15006>>ASSIGN  15007>>ASSIGN
     15008>>ASSIGN  15026>>ASSIGN  15057>>ASSIGN  15061>>ASSIGN
DSEG2SIZE
     11704**DCL     14966>>ASSIGN
DSEG3$
     11704**DCL     14605--IMP-PTR 14769--IMP-PTR 14794--IMP-PTR 14999<>CALL    15003<>CALL    15017<>CALL
     15045>>DOWHILE 15046>>IF      15047>>IF      15059>>ASSIGN  15066<>CALL    15069>>ASSIGN  15077>>ASSIGN
DSEG3SIZE
     11704**DCL     14998>>ASSIGN  15065>>ASSIGN
ERR_CODE
     11697**DCL     11698--REDEF
FDS
     11594**DCL     14865<>CALL    14874<>CALL    14920<>CALL    14946<>CALL    14954<>CALL    15078<>CALL
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:125  
     15092<>CALL
FDS.FMT_.BOUND
     11599**DCL     14859<<ASSIGN  14869<<ASSIGN  14883<<ASSIGN  14922<<ASSIGN  14930<<ASSIGN  14933>>ASSIGN
     14934<<ASSIGN  14934>>ASSIGN  14941>>ASSIGN  14942<<ASSIGN  14942>>ASSIGN  14948<<ASSIGN  14992<<ASSIGN
     15088<<ASSIGN  15109>>CALLBLT 15111<<ASSIGN  15111>>ASSIGN
FDS.NVECS#
     11622**DCL     14860<<ASSIGN  14870<<ASSIGN  14884<<ASSIGN  14909>>ASSIGN  14910<<ASSIGN  14910>>ASSIGN
     14914>>ASSIGN  14915<<ASSIGN  14915>>ASSIGN  14919>>IF      14919<<ASSIGN  14923<<ASSIGN  14931<<ASSIGN
     14935<<ASSIGN  14943<<ASSIGN  14949<<ASSIGN  14993<<ASSIGN  15089<<ASSIGN  15112>>ASSIGN  15113>>ASSIGN
     15114<<ASSIGN  15114>>ASSIGN  15117>>ASSIGN  15118<<ASSIGN  15118>>ASSIGN
FMT_BUF
     11693**DCL     14858<<ASSIGN  14868<<ASSIGN  14882<<CALLBLT 14921<<ASSIGN  14929<<ASSIGN  14933<<ASSIGN
     14941<<ASSIGN  14947<<ASSIGN  14991<<ASSIGN  15087<<ASSIGN  15109<<CALLBLT
FMT_VEC
     11693**DCL     14853<<ASSIGN  14871<<ASSIGN  14872<<ASSIGN  14873<<ASSIGN  14886<<ASSIGN  14887<<ASSIGN
     14892<<ASSIGN  14894<<ASSIGN  14898<<ASSIGN  14900<<ASSIGN  14901<<ASSIGN  14902<<ASSIGN  14903<<ASSIGN
     14909<<ASSIGN  14914<<ASSIGN  14936<<ASSIGN  14937<<ASSIGN  14944<<ASSIGN  15057<<ASSIGN  15059<<ASSIGN
     15062<<ASSIGN  15069<<ASSIGN  15077<<ASSIGN  15090<<ASSIGN  15091<<ASSIGN  15112<<ASSIGN  15113<<ASSIGN
     15117<<ASSIGN
FOR_INDIRECT_FMT
     14829**DCL     14933--ASSIGN  14933>>ASSIGN  14934--ASSIGN
FOR_STAT_FMT
     14827**DCL     14941--ASSIGN  14941>>ASSIGN  14942--ASSIGN
FOUND
     14812**DCL     14995<<ASSIGN  15045>>DOWHILE 15048<<ASSIGN  15051>>IF      15060>>IF
I
     14803**DCL     14881<<DOINDEX 14885>>ASSIGN  14886>>ASSIGN  14994<<DOINDEX 14996>>ASSIGN  15006>>ASSIGN
     15007>>ASSIGN  15008>>ASSIGN  15026>>ASSIGN  15057>>ASSIGN  15061>>ASSIGN  15084<<DOINDEX 15085>>ASSIGN
     15090>>ASSIGN
I IN PROCEDURE ADD_ACCLIST
     15108**DCL     15116<<DOINDEX 15117>>ASSIGN
INDIRECT_STR
     14819**DCL     14871--ASSIGN
INOUT_STR
     14820**DCL     14892--ASSIGN
IN_STR
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:126  
     14821**DCL     14894--ASSIGN
J
     14804**DCL     14904<<DOINDEX 14907>>IF      15044<<ASSIGN  15045>>DOWHILE 15046>>IF      15047>>IF
     15049<<ASSIGN  15049>>ASSIGN  15068<<CALLBLT 15069>>ASSIGN
JCL
     14558**DCL        10--PROC    14855>>IF
K
     14805**DCL     14906<<DOINDEX 14907>>IF      14909>>ASSIGN
KL$ACBLK.ACCTS
     14731**DCL     14862>>IF      14951>>IF      15116>>DOINDEX
KL$ACBLK.LIST
     14732**DCL     15112--ASSIGN  15117--ASSIGN
KL$DREC.PASSWORD
     14663**DCL     14667--REDEF
KL$DREC.RENAME
     14686**DCL     14687--REDEF   15059--ASSIGN
KL$DREC.SNAME
     14700**DCL     15077--ASSIGN
KL$INDIRECT_WSN.INDIRECT_WSN
     14722**DCL     14872--ASSIGN  14936--ASSIGN
KL$INDIRECT_WSN.NODE
     14721**DCL     14873--ASSIGN  14937--ASSIGN
KL$TWSNREC.DEVS.NUM
     14775**DCL     15047>>IF
KL$TWSNREC.DEVS.TYP
     14774**DCL     15046>>IF
KL$TWSNREC.NDEV
     14772**DCL     15045>>DOWHILE
KL$WSNCVT.WSN
     14798**DCL     15069--ASSIGN
KL$WSNDEV.DEV
     14727**DCL     14996>>ASSIGN  15006>>ASSIGN  15007>>ASSIGN  15008>>ASSIGN  15026>>ASSIGN  15057--ASSIGN
     15061>>ASSIGN
KL$WSNDEV.NDEV
     14726**DCL     14994>>DOINDEX
KL$WSNHDR.ACCSDISP
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:127  
     14709**DCL     14861>>ASSIGN  14950>>ASSIGN
KL$WSNHDR.INDIRECT#
     14707**DCL     14867>>IF      14932>>IF      14963>>IF
KL$WSNHDR.NTYP
     14711**DCL     14881>>DOINDEX 15084>>DOINDEX
KL$WSNHDR.TNAME
     14710**DCL     14940>>IF      14944--ASSIGN
KL$WSNHDR.TYPS.DISP
     14714**DCL     14885>>ASSIGN  15085>>ASSIGN
KL$WSNHDR.TYPS.TYP
     14713**DCL     14886--ASSIGN  15090--ASSIGN
KL$WTBLK.ATTRS
     14761**DCL     14907>>IF
KL$WTBLK.FNAME
     14750**DCL     14887--ASSIGN  15086>>IF      15091--ASSIGN
KL$WTBLK.IO.INPUT
     14755**DCL     14888>>IF
KL$WTBLK.IO.OUTPUT
     14756**DCL     14890>>IF      14896>>IF
KL$WTBLK.NATR
     14759**DCL     14904>>DOINDEX
KL$WTBLK.PNAME.TXT
     14766**DCL     14901--ASSIGN
KL_DEFAULT.PASSWORD
     14313**DCL     14317--REDEF
KL_DEFAULT.RENAME
     14336**DCL     14337--REDEF
KL_DFLT.PASSWORD
     13503**DCL     13507--REDEF
KL_DFLT.RENAME
     13526**DCL     13527--REDEF
KL_DREC.PASSWORD
     13341**DCL     13345--REDEF
KL_DREC.RENAME
     13364**DCL     13365--REDEF
KL_DREC_CNT.PASSWORD
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:128  
     13228**DCL     13232--REDEF
KL_DREC_CNT.RENAME
     13251**DCL     13252--REDEF
LOOP_END
     15080**LABEL   15042--GOTO
MERR_CODE
     11698**DCL     15072<>CALL    15099<>CALL
NODEV_ERR
     15025**LABEL   15051--GOTO
NONE_STR
     14823**DCL     14900--ASSIGN
NUM
     14810**DCL     15007<<ASSIGN  15012>>IF      15012>>IF      15012>>IF      15012>>IF      15047>>IF
OUT_STR
     14822**DCL     14898--ASSIGN
P$
     14563**DCL     14730--IMP-PTR 14747--IMP-PTR 14861<<ASSIGN  14862>>IF      14885<<ASSIGN  14887>>ASSIGN
     14888>>IF      14890>>IF      14896>>IF      14901>>ASSIGN  14904>>DOINDEX 14907>>IF      14950<<ASSIGN
     14951>>IF      15085<<ASSIGN  15086>>IF      15091>>ASSIGN  15112>>ASSIGN  15116>>DOINDEX 15117>>ASSIGN
PROJ_KEY.TEXT
     11575**DCL     11575--REDEF
PROJ_KEY.TXT.PROJECT
     11575**DCL     11575--REDEF
REMEM_VAR
     11701**DCL     11701--REDEF
REM_FCMD
     11701**DCL     11702--REDEF
REPEATS
     14806**DCL     14905<<ASSIGN  14911<<ASSIGN  14911>>ASSIGN  14912>>IF      14914--ASSIGN
REPEATS IN PROCEDURE ADD_ACCLIST
     15107**DCL     15113--ASSIGN  15115<<ASSIGN  15119<<ASSIGN  15119>>ASSIGN
SAVE_KEY
     14808**DCL     14854<<ASSIGN  15095>>ASSIGN
TWSN_CHRS
     14811**DCL     15008<<ASSIGN  15015>>CALLBLT 15068>>CALLBLT
TYPE
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:129  
     14809**DCL     15006<<ASSIGN  15009>>IF      15009>>IF      15009>>IF      15009>>IF      15046>>IF
USERS_KEY.COUNT
     11572**DCL     14965<<ASSIGN  14997<<ASSIGN  15002<<ASSIGN  15016<<ASSIGN  15056>>IF      15064<<ASSIGN
     15096<<ASSIGN
USERS_KEY.TEXT
     11572**DCL     11573--REDEF   11573--REDEF   11573--REDEF   11574--REDEF
USERS_KEY.TW
     11573**DCL     14853--ASSIGN
USERS_KEY.TXTC
     11573**DCL     14854>>ASSIGN  14964<<ASSIGN  14996<<ASSIGN  15001<<ASSIGN  15015<<CALLBLT 15063<<ASSIGN
     15095<<ASSIGN
WSNDEV_ARS
     14807**DCL     14966<<ASSIGN  14967<>CALL    14998<<ASSIGN  14999<>CALL    15003<>CALL    15017<>CALL
     15065<<ASSIGN  15066<>CALL
WSNHDR$
     14562**DCL     14706--IMP-PTR 14717--IMP-PTR 14850<<ASSIGN  14861>>ASSIGN  14861>>ASSIGN  14867>>IF
     14872>>ASSIGN  14873>>ASSIGN  14881>>DOINDEX 14885>>ASSIGN  14885>>ASSIGN  14886>>ASSIGN  14932>>IF
     14936>>ASSIGN  14937>>ASSIGN  14940>>IF      14944>>ASSIGN  14950>>ASSIGN  14950>>ASSIGN  14963>>IF
     15084>>DOINDEX 15085>>ASSIGN  15085>>ASSIGN  15090>>ASSIGN
WSN_ACC_FMT
     14838**DCL     15109--CALLBLT 15109>>CALLBLT 15111--ASSIGN
WSN_ATTR_FMT
     14839**DCL     14882>>CALLBLT 14883--ASSIGN  14921>>ASSIGN  14922--ASSIGN
WSN_DEVICE_JCL
     14835**DCL     14991>>ASSIGN  14992--ASSIGN
WSN_DEV_FMT
     14837**DCL     14882>>CALLBLT 14883--ASSIGN
WSN_DEV_HDR
     14831**DCL     14877<>CALL    14877--CALL
WSN_DFORM_JCL
     14833**DCL     15087>>ASSIGN  15088--ASSIGN
WSN_HDR_FMT
     14824**DCL     14858>>ASSIGN  14859--ASSIGN
WSN_JCL_FMT
     14825**DCL     14929>>ASSIGN  14930--ASSIGN
X$FORMAT
PL6.E3A0      #002=ASL$DISP_ONE_WORKSTATION File=ASL$LIST_WORKSTATIONS.:E05TSI   TUE 07/29/97 10:27 Page:130  
     14585**DCL-ENT 14865--CALL    14874--CALL    14920--CALL    14946--CALL    14954--CALL    15078--CALL
     15092--CALL
ZERO
     14814**DCL     14851<<ASSIGN  14903--ASSIGN
