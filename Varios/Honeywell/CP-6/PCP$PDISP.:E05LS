VERSION E05

PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:1    
        1        1        /*M*     PCP$PDISP - CONTROL MODULE TO DISPLAY INDIVIDUAL PARAMETERS  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*/
        8        8        PCP$PDISP: PROC(DISP_TBL) ALTRET;
        9        9        /**/
       10       10    1   DCL 1 DISP_TBL,
       11       11    1         2 INDX UBIN WORD,
       12       12    1         2 PARM(0:99) ALIGNED,
       13       13    1           3 CAT UBIN(9) UNAL,
       14       14    1           3 PARM UBIN(9) UNAL,
       15       15    1           3 INDEXLO UBIN(9) UNAL,
       16       16    1           3 INDEXHI UBIN(9) UNAL,
       17       17    1           3 RESINDX SBIN HALF UNAL;
       18       18        /**/
       19       19        /*********************************************************************/
       20       20        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
       21       21        /*********************************************************************/
       22       22        %INCLUDE PC_SUBS_C;
       23      354        %INCLUDE PC_PERR_C;
       24      387        %INCLUDE CP_6;
       25      468        %INCLUDE CP_6_SUBS;
       26     1008        %INCLUDE JM$STRUCT;
       27     1753        %INCLUDE B_SEGIDS_C;
       28     2292        %INCLUDE FR_DATA_R;
       29     2324        %INCLUDE UD_EQU_E;
       30     2713        %INCLUDE XUD_UTS_M;
       31     2795        /**/
       32     2796        %SUB PSURES_OFFSET = 4;
       33     2797        %SUB MMINDX=0;
       34     2798        %XUD_UTS_EQU;
       35     2809        %EJECT;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:2    
       36     2810        /***************************************************************************/
       37     2811        /*   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   */
       38     2812        /***************************************************************************/
       39     2813        /**/
       40     2814    1   DCL TEMPTEXT CHAR(12) STATIC;
       41     2815    1   DCL 1 TEMPTEXT_ARRAY(0:11) REDEF TEMPTEXT CHAR(1);
       42     2816        /**/
       43     2817    1   DCL TEXT_INDEX SBIN WORD STATIC;
       44     2818    1   DCL TEXT_BUF CHAR(132) STATIC;
       45     2819        /**/
       46     2820    1   DCL 1 TEXT_C STATIC,
       47     2821    1         2 COUNT UBIN(9) UNAL,
       48     2822    1         2 TEXT CHAR(31) UNAL;
       49     2823        /**/
       50     2824    1   DCL 1 TEXTC_OPAREN STATIC,
       51     2825    1         2 COUNT UBIN(9) UNAL INIT(1),
       52     2826    1         2 TEXT CHAR(1) UNAL INIT('(');
       53     2827    1   DCL 1 TEXTC_CPAREN STATIC,
       54     2828    1         2 COUNT UBIN(9) UNAL INIT(1),
       55     2829    1         2 TEXT CHAR(1) UNAL INIT(')');
       56     2830    1   DCL 1 TEXTC_EQUALS STATIC,
       57     2831    1         2 COUNT UBIN(9) UNAL INIT(1),
       58     2832    1         2 TEXT CHAR(1) UNAL INIT('=');
       59     2833    1   DCL 1 TEXTC_COMMA STATIC,
       60     2834    1         2 COUNT UBIN(9) UNAL INIT(1),
       61     2835    1         2 TEXT  CHAR(1) UNAL INIT(',');
       62     2836    1   DCL 1 TEXTC_MINUS STATIC,
       63     2837    1         2 COUNT UBIN(9) UNAL INIT(1),
       64     2838    1         2 TEXT  CHAR(1) UNAL INIT('-');
       65     2839    1   DCL 1 TEXTC_NONE STATIC,
       66     2840    1         2 COUNT UBIN(9) UNAL INIT(4),
       67     2841    1         2 TEXT  CHAR(4) UNAL INIT('NONE');
       68     2842    1   DCL 1 TEXTC_ALL  STATIC,
       69     2843    1         2 COUNT UBIN(9) UNAL INIT(3),
       70     2844    1         2 TEXT  CHAR(3) UNAL INIT('ALL');
       71     2845        /**/
       72     2846    1   DCL I SBIN STATIC;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:3    
       73     2847    1   DCL J SBIN STATIC;
       74     2848    1   DCL K SBIN STATIC;
       75     2849    1   DCL CURUTS UBIN WORD STATIC;
       76     2850        /**/
       77     2851    1   DCL 1 FLAGVAL_TEXTC(0:1) STATIC ALIGNED,
       78     2852    1         2 COUNT UBIN BYTE UNAL INIT(2,3),
       79     2853    1         2 TEXT  CHAR(11)  UNAL INIT('NO','YES');
       80     2854    1   DCL 1 ANSPROTVAL_TEXTC(0:2) STATIC ALIGNED,
       81     2855    1         2 COUNT UBIN BYTE UNAL INIT(11,4,4),
       82     2856    1         2 TEXT  CHAR(11)  UNAL INIT('UNPROTECTED','SEMI','FULL');
       83     2857    1   DCL 1 AUTOSHAREVAL_TEXTC(0:2) STATIC ALIGNED,
       84     2858    1         2 COUNT UBIN BYTE UNAL INIT(2,3,4),
       85     2859    1         2 TEXT  CHAR(11)  UNAL INIT('RU','ALL','NONE');
       86     2860    1   DCL 1 LOGFILEVAL_TEXTC(0:2) STATIC ALIGNED,
       87     2861    1         2 COUNT UBIN BYTE UNAL INIT(2,3,5),
       88     2862    1         2 TEXT  CHAR(11)  UNAL INIT('NO','YES','MAYBE');
       89     2863    1   DCL 1 LOGACCVAL_TEXTC(0:4) STATIC ALIGNED,
       90     2864    1         2 COUNT UBIN BYTE UNAL INIT(4,8,10,6,3),
       91     2865    1         2 TEXT  CHAR(11)  UNAL INIT('NONE','FAILEDPW','FAILEDPWNE',
       92     2866    1                                     'FAILED','ALL');
       93     2867    1   DCL 1 LOGEXVAL_TEXTC(0:1) STATIC ALIGNED,
       94     2868    1         2 COUNT UBIN BYTE UNAL INIT(4,3),
       95     2869    1         2 TEXT  CHAR(11)  UNAL INIT('NONE','ALL');
       96     2870        /* The order in the PRIVVAL textc table must correspond to the order
       97     2871           of the bits in the appropriate security mask word.             */
       98     2872    1   DCL 1 PRIVVAL_TEXTC(0:35) STATIC ALIGNED, /* bits defined in the JIT */
       99     2873    1         2 COUNT UBIN BYTE UNAL INIT(5*3,6*2,0*7,4,7*2,0,6,5,3,0,6,
      100     2874    1                                     4*2,2,6,4,3,4,2,3*2,0,4,6,4,6),
      101     2875    1         2 TEXT  CHAR(11)  UNAL INIT('FMEFT',
      102     2876    1                                     'FMBLK',
      103     2877    1                                     'FMSEC',
      104     2878    1                                     'FMDIAG',
      105     2879    1                                     'FMREAD',
      106     2880    1                                     ' '*7,
      107     2881    1                                     'SNAP',
      108     2882    1                                     'SCREECH',
      109     2883    1                                     'DISPJOB',
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:4    
      110     2884    1                                     ' ',
      111     2885    1                                     'SYSCON',
      112     2886    1                                     'ASAVE',
      113     2887    1                                     'GPP',
      114     2888    1                                     ' ',
      115     2889    1                                     'SYSLOG',
      116     2890    1                                     'MFEP',
      117     2891    1                                     'CFEP',
      118     2892    1                                     'CQ',
      119     2893    1                                     'INTCON',
      120     2894    1                                     'IOQW',
      121     2895    1                                     'IOQ',
      122     2896    1                                     'EXPM',
      123     2897    1                                     'PM',
      124     2898    1                                     'TND',
      125     2899    1                                     'JIT',
      126     2900    1                                     ' ',
      127     2901    1                                     'MSYS',
      128     2902    1                                     'MAXMEM',
      129     2903    1                                     'EXMM',
      130     2904    1                                     'SPCLMM');
      131     2905    1   DCL 1 LOGLISTVAL_TEXTC(0:3) STATIC ALIGNED,
      132     2906    1         2 COUNT UBIN BYTE UNAL INIT(4,6,7,3),
      133     2907    1         2 TEXT  CHAR(11)  UNAL INIT('NONE','DENIED','GRANTED','ALL');
      134     2908    1   DCL 1 TEXTC_TBL(0:0) BASED ALIGNED,
      135     2909    1         2 COUNT UBIN BYTE UNAL,
      136     2910    1         2 TEXT  CHAR(11)  UNAL;
      137     2911    1   DCL TEXT_TBL$(0:7) PTR STATIC INIT(ADDR(FLAGVAL_TEXTC),
      138     2912    1                                      ADDR(ANSPROTVAL_TEXTC),
      139     2913    1                                      ADDR(AUTOSHAREVAL_TEXTC),
      140     2914    1                                      ADDR(LOGFILEVAL_TEXTC),
      141     2915    1                                      ADDR(LOGACCVAL_TEXTC),
      142     2916    1                                      ADDR(LOGEXVAL_TEXTC),
      143     2917    1                                      ADDR(PRIVVAL_TEXTC),
      144     2918    1                                      ADDR(LOGLISTVAL_TEXTC));
      145     2919    1   DCL TEMP$ PTR STATIC;
      146     2920
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:5    
      147     2921
      148     2922        /* MONSER_TBL contains: (1) the control values from ES_MONSERTBL since
      149     2923           the one word VALUE won't work in this case. These are internally
      150     2924           indexed for our convenience, but are set and displayed as a list
      151     2925           of monitor services, unlike the other indexed stuff. (2) Ptrs to
      152     2926           individual FCG tables. These are addr(nil) if we don't log any
      153     2927           pmmes in that category in the security log. (3) Count of how many
      154     2928           pmmes in that category are logged and, therefore, need text.
      155     2929           All this means that if pmmes are added to the list to be logged,
      156     2930           these tables will require updating/expanding for the generalized
      157     2931           code below to work.                                            */
      158     2932    1   DCL 1 MONSER_TBL ALIGNED STATIC,
      159     2933    1         2 VAL (0:%MAX_FCG#) BIT(36),
      160     2934    1         2 FCG$(0:%MAX_FCG#) PTR INIT(ADDR(JS_TBL),   /*  0 - JS  */
      161     2935    1                                      ADDR(NIL),      /*  1 - UE  */
      162     2936    1                                      ADDR(UM_TBL),   /*  2 - UM  */
      163     2937    1                                      ADDR(MM_TBL),   /*  3 - MM  */
      164     2938    1                                      ADDR(NIL),      /*  4 - FM1 */
      165     2939    1                                      ADDR(NIL),      /*  5 - FM2 */
      166     2940    1                                      ADDR(FM3_TBL),  /*  6 - FM3 */
      167     2941    1                                      ADDR(TD_TBL),   /*  7 - TD  */
      168     2942    1                                      ADDR(NIL),      /*  8 - KC  */
      169     2943    1                                      ADDR(NIL),      /*  9 - OT  */
      170     2944    1                                      ADDR(OC_TBL),   /* 10 - OC  */
      171     2945    1                                      ADDR(NIL),      /* 11 - KL  */
      172     2946    1                                      ADDR(PH_TBL),   /* 12 - PH  */
      173     2947    1                                      ADDR(FR_TBL),   /* 13 - FR  */
      174     2948    1                                      ADDR(KI_TBL),   /* 14 - KI  */
      175     2949    1                                      ADDR(NIL)*0),   /* 15 - FO  */
      176     2950                                                           /* new ones? */
      177     2951    1         2 CNT (0:%MAX_FCG#) UBIN BYTE UNAL INIT(1,   /*  0 - JS  */
      178     2952    1                                                 0,   /*  1 - UE  */
      179     2953    1                                                 3,   /*  2 - UM  */
      180     2954    1                                                 11,  /*  3 - MM  */
      181     2955    1                                                 0,   /*  4 - FM1 */
      182     2956    1                                                 0,   /*  5 - FM2 */
      183     2957    1                                                 1,   /*  6 - FM3 */
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:6    
      184     2958    1                                                 8,   /*  7 - TD  */
      185     2959    1                                                 0,   /*  8 - KC  */
      186     2960    1                                                 0,   /*  9 - OT  */
      187     2961    1                                                 1,   /* 10 - OC  */
      188     2962    1                                                 0,   /* 11 - KL  */
      189     2963    1                                                 4,   /* 12 - PH  */
      190     2964    1                                                 1,   /* 13 - FR  */
      191     2965    1                                                 3,   /* 14 - KI  */
      192     2966    1                                                 0*0);/* 15 - FO  */
      193     2967                                                           /* new ones? */
      194     2968        /**/
      195     2969        /* FCG tables */
      196     2970        /**/
      197     2971    1   DCL 1 FCG_TBL(0:0) ALIGNED BASED,
      198     2972    1         2 CODE    UBIN BYTE UNAL,
      199     2973    1         2 TEXTC,
      200     2974    1           3 COUNT UBIN BYTE UNAL,
      201     2975    1           3 TEXT  CHAR(11)  UNAL;
      202     2976
      203     2977    1   DCL 1 JS_TBL STATIC ALIGNED,
      204     2978    1         2 CODE    UBIN BYTE UNAL INIT(%C$SCREECH#),
      205     2979    1         2 TEXTC,
      206     2980    1           3 COUNT UBIN BYTE UNAL INIT(9),
      207     2981    1           3 TEXT  CHAR(11)  UNAL INIT('M$SCREECH');
      208     2982
      209     2983    1   DCL 1 UM_TBL(0:2) STATIC ALIGNED,
      210     2984    1         2 CODE    UBIN BYTE UNAL INIT(%C$SPRIV#,
      211     2985    1                                       %C$RUE#,
      212     2986    1                                       %C$GJOB#),
      213     2987    1         2 TEXTC,
      214     2988    1           3 COUNT UBIN BYTE UNAL INIT( 7,
      215     2989    1                                        5,
      216     2990    1                                        6),
      217     2991    1           3 TEXT  CHAR(11)  UNAL INIT('M$SPRIV',
      218     2992    1                                       'M$RUE',
      219     2993    1                                       'M$GJOB');
      220     2994
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:7    
      221     2995    1   DCL 1 MM_TBL(0:10) STATIC ALIGNED,
      222     2996    1         2 CODE    UBIN BYTE UNAL INIT(%C$STLPP#,
      223     2997    1                                       %C$RSPP#,
      224     2998    1                                       %C$CVM#,
      225     2999    1                                       %C$SMPRT#,
      226     3000    1                                       %C$SSC#,
      227     3001    1                                       %C$SAD#,
      228     3002    1                                       %C$BADPP#,
      229     3003    1                                       %C$GOODPP#,
      230     3004    1                                       %C$GBPL#,
      231     3005    1                                       %C$MPL#,
      232     3006    1                                       %C$UMPL#),
      233     3007    1         2 TEXTC,
      234     3008    1           3 COUNT UBIN BYTE UNAL INIT( 7,
      235     3009    1                                        6,
      236     3010    1                                        5,
      237     3011    1                                        7,
      238     3012    1                                        5,
      239     3013    1                                        5,
      240     3014    1                                        7,
      241     3015    1                                        8,
      242     3016    1                                        6,
      243     3017    1                                        5,
      244     3018    1                                        6),
      245     3019    1           3 TEXT  CHAR(11)  UNAL INIT('M$STLPP',
      246     3020    1                                       'M$RSPP',
      247     3021    1                                       'M$CVM',
      248     3022    1                                       'M$SMPRT',
      249     3023    1                                       'M$SSC',
      250     3024    1                                       'M$SAD',
      251     3025    1                                       'M$BADPP',
      252     3026    1                                       'M$GOODPP',
      253     3027    1                                       'M$GBPL',
      254     3028    1                                       'M$MPL',
      255     3029    1                                       'M$UMPL');
      256     3030
      257     3031    1   DCL 1 FM3_TBL STATIC ALIGNED,
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:8    
      258     3032    1         2 CODE    UBIN BYTE UNAL INIT(%C$MADMUCK#),
      259     3033    1         2 TEXTC,
      260     3034    1           3 COUNT UBIN BYTE UNAL INIT(9),
      261     3035    1           3 TEXT  CHAR(11)  UNAL INIT('M$MADMUCK');
      262     3036
      263     3037    1   DCL 1 TD_TBL(0:7) STATIC ALIGNED,
      264     3038    1         2 CODE    UBIN BYTE UNAL INIT(%C$RDSYSLOG#,
      265     3039    1                                       %C$WRSYSLOG#,
      266     3040    1                                       %C$TDOPEN#,
      267     3041    1                                       %C$TDCLOSE#,
      268     3042    1                                       %C$TDIO#,
      269     3043    1                                       %C$TDREQCPU#,
      270     3044    1                                       %C$IOQ#,
      271     3045    1                                       %C$SYSCON#),
      272     3046    1         2 TEXTC,
      273     3047    1           3 COUNT UBIN BYTE UNAL INIT(10,
      274     3048    1                                       10,
      275     3049    1                                        8,
      276     3050    1                                        9,
      277     3051    1                                        6,
      278     3052    1                                       10,
      279     3053    1                                        5,
      280     3054    1                                        8),
      281     3055    1           3 TEXT  CHAR(11)  UNAL INIT('M$RDSYSLOG',
      282     3056    1                                       'M$WRSYSLOG',
      283     3057    1                                       'M$TDOPEN',
      284     3058    1                                       'M$TDCLOSE',
      285     3059    1                                       'M$TDIO',
      286     3060    1                                       'M$TDREQCPU',
      287     3061    1                                       'M$IOQ',
      288     3062    1                                       'M$SYSCON');
      289     3063
      290     3064    1   DCL 1 OC_TBL STATIC ALIGNED,
      291     3065    1         2 CODE    UBIN BYTE UNAL INIT(%C$OCMSG#),
      292     3066    1         2 TEXTC,
      293     3067    1           3 COUNT UBIN BYTE UNAL INIT(7),
      294     3068    1           3 TEXT  CHAR(11)  UNAL INIT('M$OCMSG');
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:9    
      295     3069
      296     3070    1   DCL 1 PH_TBL(0:3) STATIC ALIGNED,
      297     3071    1         2 CODE    UBIN BYTE UNAL INIT(%C$SMOUSE#,
      298     3072    1                                       %C$XMOUSE#,
      299     3073    1                                       %C$GETMOUSE#,
      300     3074    1                                       %C$GETPM#),
      301     3075    1         2 TEXTC,
      302     3076    1           3 COUNT UBIN BYTE UNAL INIT( 8,
      303     3077    1                                        8,
      304     3078    1                                       10,
      305     3079    1                                        7),
      306     3080    1           3 TEXT  CHAR(11)  UNAL INIT('M$SMOUSE',
      307     3081    1                                       'M$XMOUSE',
      308     3082    1                                       'M$GETMOUSE',
      309     3083    1                                       'M$GETPM');
      310     3084
      311     3085    1   DCL 1 FR_TBL STATIC ALIGNED,
      312     3086    1         2 CODE    UBIN BYTE UNAL INIT(%C$LIMIT#),
      313     3087    1         2 TEXTC,
      314     3088    1           3 COUNT UBIN BYTE UNAL INIT(7),
      315     3089    1           3 TEXT  CHAR(11)  UNAL INIT('M$LIMIT');
      316     3090
      317     3091    1   DCL 1 KI_TBL(0:2) STATIC ALIGNED,
      318     3092    1         2 CODE    UBIN BYTE UNAL INIT(%C$FEBOOT#,
      319     3093    1                                       %C$FEDUMP#,
      320     3094    1                                       %C$FECTL#),
      321     3095    1         2 TEXTC,
      322     3096    1           3 COUNT UBIN BYTE UNAL INIT( 8,
      323     3097    1                                        8,
      324     3098    1                                        7),
      325     3099    1           3 TEXT  CHAR(11)  UNAL INIT('M$FEBOOT',
      326     3100    1                                       'M$FEDUMP',
      327     3101    1                                       'M$FECTL');
      328     3102
      329     3103        %EJECT;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:10   
      330     3104        /**********************************************************************/
      331     3105        /*   BASED DATA   BASED DATA   BASED DATA   BASED DATA   BASED DATA   */
      332     3106        /**********************************************************************/
      333     3107        /**/
      334     3108        %F$DCB;
      335     3165        %JM_PART (FPTN=JM$PT,STCLASS=BASED);
      336     3220        /**/
      337     3221    1   DCL 1 P$TBL(0:0) BASED ALIGNED,
      338     3222    1         2 FLAGS,
      339     3223    1           3 PRINT BIT(1) UNAL,
      340     3224    1           3 DISPONLY BIT(1) UNAL,
      341     3225    1           3 INDX BIT(1) UNAL,
      342     3226    1           3 RES BIT(1) UNAL,
      343     3227    1           3 MAXCONST BIT(1) UNAL,
      344     3228    1           3 MINCONST BIT(1) UNAL,
      345     3229    1           3 VALTEXT BIT(1) UNAL,
      346     3230    1           3 VALTEXTLIST BIT(1) UNAL,
      347     3231    1           3 INTINDX BIT(1) UNAL,
      348     3232    1           3 * BIT(9) UNAL,
      349     3233    1         2 VALCODE UBIN(18) UNAL,
      350     3234    1         2 RESPTR$ PTR ALIGNED,
      351     3235    1         2 TEXT ALIGNED,
      352     3236    1           3 COUNT UBIN(9) UNAL,
      353     3237    1           3 TEXT CHAR(19) UNAL,
      354     3238    1         2 PTR$ PTR,
      355     3239    1         2 REPTR$ REDEF PTR$,
      356     3240    1           3 ADDRESS UBIN(24) UNAL,
      357     3241    1           3 SEGID UBIN(12) UNAL,
      358     3242    1         2 PSUPTR$ PTR,
      359     3243    1         2 REPSUPTR$ REDEF PSUPTR$,
      360     3244    1           3 ADDRESS UBIN(24) UNAL,
      361     3245    1           3 SEGID UBIN(12) UNAL,
      362     3246    1         2 MAX UBIN WORD UNAL,
      363     3247    1         2 MIN UBIN WORD UNAL,
      364     3248    1         2 MULT UBIN WORD UNAL;
      365     3249        /**/
      366     3250    1   DCL 1 TEXTC$INDX(0:0) BASED ALIGNED,
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:11   
      367     3251    1         2 COUNT UBIN(9) UNAL,
      368     3252    1         2 TEXT CHAR(3) UNAL;
      369     3253        /**/
      370     3254    1   DCL B$TABLE(0:0) UBIN WORD BASED ALIGNED;
      371     3255    1   DCL B$MONSER(0:0) BIT(36) BASED ALIGNED;
      372     3256    1   DCL B$BITS(0:0) BIT(1) UNAL BASED;
      373     3257    1   DCL 1 B$PTR(0:0) BASED ALIGNED,
      374     3258    1         2 ADDRESS UBIN(24) UNAL,
      375     3259    1         2 SEGID UBIN(12) UNAL;
      376     3260        /**/
      377     3261    1   DCL B$CHAR4 CHAR(4) BASED;
      378     3262        %EJECT;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:12   
      379     3263        /***********************************************************************/
      380     3264        /*    ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   */
      381     3265        /**********************************************************************/
      382     3266        /**/
      383     3267    1   DCL PCE$ERROR ENTRY(2) ALTRET;
      384     3268    1   DCL PCW$WRITE ENTRY(2) ALTRET;
      385     3269    1   DCL PCR$RESTEXT ENTRY(2);
      386     3270        /**/
      387     3271        /********************************************************************/
      388     3272        /*   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   */
      389     3273        /********************************************************************/
      390     3274        /**/
      391     3275    1   DCL M$LO DCB;                           /* ALL OUTPUT                         */
      392     3276        /**/
      393     3277        /*****************************************************************/
      394     3278        /*   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   */
      395     3279        /*****************************************************************/
      396     3280        /**/
      397     3281    1   DCL SYSTEM$ PTR SYMREF;
      398     3282    1   DCL PART$ PTR SYMREF;
      399     3283    1   DCL RES$ PTR SYMREF;
      400     3284    1   DCL EX$ PTR SYMREF;
      401     3285        /**/
      402     3286    1   DCL PDT$ PTR SYMREF;
      403     3287        /**/
      404     3288    1   DCL MONPTR$ PTR SYMREF;
      405     3289    1   DCL 1 MONPTR REDEF MONPTR$,
      406     3290    1         2 ADDRESS UBIN(24) UNAL,
      407     3291    1         2 SEGID UBIN(12) UNAL;
      408     3292    1   DCL MONPART$ PTR SYMREF;
      409     3293        /**/
      410     3294    1   DCL RES_TEXT(0:3) CHAR(2) SYMREF;
      411     3295        /**/
      412     3296    1   DCL 1 RESTEXT_C SYMREF,
      413     3297    1         2 COUNT UBIN(9) UNAL,
      414     3298    1         2 TEXT CHAR(12) UNAL;
      415     3299        /**/
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:13   
      416     3300    1   DCL TPSYS BIT(1) SYMREF;
      417     3301        /**/
      418     3302    1   DCL MAX_CLMN SBIN WORD SYMREF;
      419     3303    1   DCL CUR_CLMN SBIN WORD SYMREF;
      420     3304    1   DCL PRINT_BUF CHAR(132) SYMREF;
      421     3305        /**/
      422     3306        /* MONITOR SYMREFS */
      423     3307        /**/
      424     3308        %EJECT;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:14   
      425     3309        /********************************************************************/
      426     3310        /*   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   */
      427     3311        /********************************************************************/
      428     3312        /**/
      429     3313        %FPT_TIME (FPTN=CUR_UTS,
      430     3314                   SOURCE=CLOCK,
      431     3315                   TSTAMP=CURUTS,
      432     3316                   DEST=UTS);
      433     3335        /**/
      434     3336        %FPT_PLATEN (FPTN=PLATEN_FPT,
      435     3337                     PLATEN=PLATEN_VLP);
      436     3362        /**/
      437     3363        %VLP_PLATEN (FPTN=PLATEN_VLP);
      438     3385        /**/
      439     3386        %EJECT;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:15   
      440     3387        /*****************************************************************************/
      441     3388        /*   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   */
      442     3389        /*****************************************************************************/
      443     3390        /**/
      444     3391    1           TEMP$ = DCBADDR(DCBNUM(M$LO));
      445     3392    1           IF (TEMP$ -> F$DCB.ASN# = %DEVICE#) THEN I = TEMP$ -> F$DCB.WIDTH#;
      446     3393    1           ELSE I = 80;
      447     3394        /**/
      448     3395    1           MAX_CLMN = (I/%CLMN_WIDTH) - 1;
      449     3396        /**/
      450     3397    2           IF (MAX_CLMN < 0) THEN DO;
      451     3398    2              CALL PCE$ERROR (%E$P_PLATEN2SMALL,2);
      452     3399    2              ALTRETURN;
      453     3400    2              END;
      454     3401        /**/
      455     3402    1           CUR_CLMN = 0;
      456     3403        /**/
      457     3404    2           DO J = 0 TO DISP_TBL.INDX;
      458     3405    3              DO CASE (DISP_TBL.PARM.CAT(J));
      459     3406        /**/
      460     3407    3               CASE (%PC_SYSTEM);
      461     3408    4                 IF (SYSTEM$ -> P$TBL.FLAGS.INDX(DISP_TBL.PARM.PARM(J))) THEN DO;
      462     3409    5                    IF (DISP_TBL.PARM.INDEXLO(J) = %PC_ALLOPT) THEN DO;
              3409                             /* ALL INDEXES */
      463     3410    5                       IF (TPSYS) THEN I = %PC_MAXMODE;
      464     3411    5                       ELSE I = %PC_MAXMODE - 1;
      465     3412    6                       DO K = 1 TO I;
      466     3413    6                          CALL BUILD_TEXT(SYSTEM$,J,K);
      467     3414    6                          CALL PRINT_TEXT(%PC_ADDTEXT);
      468     3415    6                          END;
      469     3416    5                       END;
      470     3417        /**/
      471     3418    4                    ELSE DO K = DISP_TBL.PARM.INDEXLO(J) TO
      472     3419    5                         DISP_TBL.PARM.INDEXHI(J);
      473     3420    5                       CALL BUILD_TEXT(SYSTEM$,J,K);
      474     3421    5                       CALL PRINT_TEXT(%PC_ADDTEXT);
      475     3422    5                       END;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:16   
      476     3423        /**/
      477     3424    4                    END;
      478     3425        /**/
      479     3426    4                 ELSE DO;                  /* NOT INDEXED                        */
      480     3427    4                    K = -1;
      481     3428    4                    CALL BUILD_TEXT(SYSTEM$,J,K);
      482     3429    5                    IF SYSTEM$->P$TBL.FLAGS.VALTEXTLIST(DISP_TBL.PARM.PARM(J)) THEN DO;
      483     3430    5                       TEXT_INDEX=TEXT_INDEX-1;
      484     3431    5                       CALL PRINT_TEXT(%PC_FLUSH);
      485     3432    5                       END;
      486     3433    4                    ELSE CALL PRINT_TEXT(%PC_ADDTEXT);
      487     3434    4                    END;
      488     3435        /**/
      489     3436    3               CASE (%PC_RESOURCE);
      490     3437    4                 IF (RES$ -> P$TBL.FLAGS.INDX(DISP_TBL.PARM.PARM(J))) THEN DO;
      491     3438    5                    IF (DISP_TBL.PARM.INDEXLO(J) = %PC_ALLOPT) THEN DO;
              3438                             /* ALL INDEXES */
      492     3439    5                       IF (TPSYS) THEN I = %PC_MAXMODE;
      493     3440    5                       ELSE I = %PC_MAXMODE - 1;
      494     3441    6                       DO K = 1 TO I;
      495     3442    6                          CALL BUILD_TEXT(RES$,J,K);
      496     3443    6                          CALL PRINT_TEXT(%PC_ADDTEXT);
      497     3444    6                          END;
      498     3445    5                       END;
      499     3446        /**/
      500     3447    4                    ELSE DO K = DISP_TBL.PARM.INDEXLO(J) TO
      501     3448    5                         DISP_TBL.PARM.INDEXHI(J);
      502     3449    5                       CALL BUILD_TEXT(RES$,J,K);
      503     3450    5                       CALL PRINT_TEXT(%PC_ADDTEXT);
      504     3451    5                       END;
      505     3452        /**/
      506     3453    4                    END;
      507     3454        /**/
      508     3455    4                 ELSE DO;                  /* NOT INDEXED                        */
      509     3456    4                    K = -1;
      510     3457    4                    CALL BUILD_TEXT(RES$,J,K);
      511     3458    4                    CALL PRINT_TEXT(%PC_ADDTEXT);
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:17   
      512     3459    4                    END;
      513     3460        /**/
      514     3461    3               CASE (%PC_PARTITION,%PC_PDTCAT);
      515     3462    3                 IF (DISP_TBL.PARM.INDEXLO(J) = %PC_ALLOPT) THEN /* ALL PARTITIONS */
      516     3463    4                 DO K = 0 TO 15;
      517     3464    4                    CALL BUILD_TEXT(PART$,J,K);
      518     3465    4                    CALL PRINT_TEXT(%PC_ADDTEXT);
      519     3466    4                    END;
      520     3467        /**/
      521     3468    3                 ELSE DO K = DISP_TBL.PARM.INDEXLO(J) TO
      522     3469    4                      DISP_TBL.PARM.INDEXHI(J);
      523     3470    4                    CALL BUILD_TEXT(PART$,J,K);
      524     3471    4                    CALL PRINT_TEXT(%PC_ADDTEXT);
      525     3472    4                    END;
      526     3473        /**/
      527     3474    3               CASE (%PC_EXCEPTION);
      528     3475    3                 IF (DISP_TBL.PARM.INDEXLO(J) = %PC_ALLOPT) THEN /* ALL INDEXES  */
      529     3476    4                 DO K = 0 TO %PC_MAXDOMAIN;
      530     3477    4                    CALL BUILD_TEXT(EX$,J,K);
      531     3478    4                    CALL PRINT_TEXT(%PC_ADDTEXT);
      532     3479    4                    END;
      533     3480        /**/
      534     3481    3                 ELSE DO K = DISP_TBL.PARM.INDEXLO(J) TO
      535     3482    4                      DISP_TBL.PARM.INDEXHI(J);
      536     3483    4                    CALL BUILD_TEXT(EX$,J,K);
      537     3484    4                    CALL PRINT_TEXT(%PC_ADDTEXT);
      538     3485    4                    END;
      539     3486        /**/
      540     3487    3               END;
      541     3488    2              END;
      542     3489        /**/
      543     3490    2           IF (CUR_CLMN ~= 0) THEN DO;
      544     3491    2              CALL PCW$WRITE(PRINT_BUF,(CUR_CLMN)*%CLMN_WIDTH) ALTRET (DISPLAY_ERR);
      545     3492    2              CUR_CLMN = 0;
      546     3493    2              PRINT_BUF = ' ';
      547     3494    2              END;
      548     3495    1           CALL PCW$WRITE(PRINT_BUF,1) ALTRET(DISPLAY_ERR); /* BLANK LINE        */
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:18   
      549     3496    1           RETURN;
      550     3497        /**/
      551     3498    1   DISPLAY_ERR:
      552     3499    1           ALTRETURN;
      553     3500        %EJECT;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:19   
      554     3501        /**/
      555     3502    1   BUILD_TEXT: PROC(PTR$,DISPX,INDX);
      556     3503        /**/
      557     3504    2   DCL PTR$ PTR;                           /* PTR TO PARAM TBL        */
      558     3505    2   DCL DISPX SBIN WORD;                    /* INDEX TO PARAM          */
      559     3506    2   DCL INDX SBIN WORD;                     /* INDEX TO USE            */
      560     3507        /**/
      561     3508    2   DCL START SBIN WORD;
      562     3509    2   DCL TBL$ PTR;
      563     3510    2   DCL I SBIN WORD;
      564     3511    2   DCL FCG SBIN WORD;
      565     3512    2   DCL CODE SBIN WORD;
      566     3513    2   DCL VALUE SBIN WORD;
      567     3514    2   DCL VALUE_BIT(0:35) REDEF VALUE BIT(1);
      568     3515    2   DCL VAL$ PTR;
      569     3516    2   DCL ALL_OFF BIT(1) ALIGNED;
      570     3517    2   DCL ALL_ON BIT(1) ALIGNED;
      571     3518    2   DCL SOME_ON(0:%MAX_FCG#) BIT(1) UNAL;
      572     3519        /**/
      573     3520    2           TEXT_INDEX = 0;
      574     3521    2           TEXT_BUF = ' ';
      575     3522        /**/
      576     3523    2           CALL INSERT_TEXT(PTR$ -> P$TBL.TEXT(DISP_TBL.PARM.PARM(DISPX)));
      577     3524        /**/
      578     3525    3           IF (DISP_TBL.PARM.RESINDX(DISPX) ~= -1) THEN DO; /* RESOURCE         */
      579     3526    3              I = DISP_TBL.PARM.RESINDX(DISPX);
      580     3527    3              CALL PCR$RESTEXT(I,RESTEXT_C);
      581     3528    3              CALL INSERT_TEXT(RESTEXT_C);
      582     3529    3              END;
      583     3530        /**/
      584     3531    3           IF (INDX ~= -1) THEN DO;        /* ADD INDEX TEXT                     */
      585     3532    3              CALL INSERT_TEXT(TEXTC_OPAREN);
      586     3533    3              CALL INSERT_TEXT(PTR$ -> P$TBL.PTR$(0) -> TEXTC$INDX(INDX));
      587     3534    3              CALL INSERT_TEXT(TEXTC_CPAREN);
      588     3535    3              END;
      589     3536    2           ELSE INDX = 0;
      590     3537        /**/
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:20   
      591     3538    2           CALL INSERT_TEXT(TEXTC_EQUALS);
      592     3539        /**/
      593     3540    3           IF (PTR$ = SYSTEM$)OR(PTR$ = EX$) THEN DO;
      594     3541    3              MONPTR.ADDRESS = PTR$ -> P$TBL.REPTR$.ADDRESS(DISP_TBL.PARM.PARM(DISPX));
      595     3542    3              VALUE = MONPTR$ -> B$TABLE(INDX);
      596     3543    3              CALL M$TIME (CUR_UTS);
      597     3544    3              IF (CURUTS >= %UTS_CUSP#) AND
      598     3545    3                 (PTR$ = SYSTEM$) AND
      599     3546    3                 (((DISP_TBL.PARM.PARM(DISPX) >= %PC_EXPTIME_LO) AND
      600     3547    3                  (DISP_TBL.PARM.PARM(DISPX) <= %PC_EXPTIME_HI)) OR
      601     3548    3                  (DISP_TBL.PARM.PARM(DISPX) = %PC_PROTECTSECLOG)) THEN
      602     3549    3                 VALUE = VALUE * 4;          /* 1/25 -> 1/100 */
      603     3550    3              VALUE = VALUE/(PTR$ -> P$TBL.MULT(DISP_TBL.PARM.PARM(DISPX)));
      604     3551    4              IF PTR$->P$TBL.FLAGS.VALTEXT(DISP_TBL.PARM.PARM(DISPX)) THEN DO;
      605     3552    4                 TEXT_C = TEXT_TBL$(PTR$->P$TBL.VALCODE(DISP_TBL.PARM.PARM(DISPX)))->
              3552                          TEXTC_TBL(VALUE);
      606     3553    4                 GOTO STUFF_IT;
      607     3554    4                 END;  /* IF VALTEXT */
      608     3555                   /* Print bit masks in a form humans can read. */
      609     3556    4              ELSE IF PTR$->P$TBL.FLAGS.VALTEXTLIST(DISP_TBL.PARM.PARM(DISPX)) THEN DO;
      610     3557    5                 IF PTR$->P$TBL.FLAGS.INTINDX(DISP_TBL.PARM.PARM(DISPX)) THEN DO;
      611     3558                      /* Have to turn a table of bit masks into a form
      612     3559                         humans can read. E.g., a list of monitor services
      613     3560                         to be logged in the security log.                */
      614     3561    6                    IF PTR$->P$TBL.VALCODE(DISP_TBL.PARM.PARM(DISPX))=%PC_MONSERVAL
              3561                             THEN DO;
      615     3562    7                       DO FCG=0 TO %MAX_FCG#;
      616     3563    7                          MONSER_TBL.VAL(FCG)=MONPTR$->B$MONSER(FCG);
      617     3564    7                          END;
      618     3565    6                       SOME_ON='0'B;
      619     3566    6                       ALL_OFF='1'B;
      620     3567    6                       ALL_ON='1'B;
      621     3568    7                       DO FCG=0 TO %MAX_FCG#;
      622     3569    8                          IF MONSER_TBL.VAL(FCG) THEN DO;
      623     3570    8                             ALL_OFF='0'B;
      624     3571    8                             SOME_ON(FCG)='1'B;
      625     3572    8                             IF MONSER_TBL.VAL(FCG)~='777777777777'O THEN
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:21   
      626     3573    8                                ALL_ON='0'B;
      627     3574    8                             END;
      628     3575    7                          END;
      629     3576    6                       IF ALL_OFF THEN
      630     3577    6                          TEXT_C=TEXTC_NONE;
      631     3578    6                       ELSE IF ALL_ON THEN
      632     3579    6                          TEXT_C=TEXTC_ALL;
      633     3580    7                       ELSE DO; /* Print monser list */
      634     3581    7                          START=TEXT_INDEX;
      635     3582    7                          CALL INSERT_TEXT(TEXTC_OPAREN);
      636     3583    8                          DO FCG=0 TO %MAX_FCG#;
      637     3584    8                             IF NOT SOME_ON(FCG) THEN
      638     3585    8                                GOTO SKIP;
      639     3586    8                             TBL$=MONSER_TBL.FCG$(FCG);
      640     3587    8                             IF TBL$=ADDR(NIL) THEN
      641     3588    8                                GOTO SKIP; /* Oops. Forgot a table. */
      642     3589    8                             VAL$=ADDR(MONSER_TBL.VAL(FCG));
      643     3590    9                             DO CODE=0 TO 35;
      644     3591    9                                IF VAL$->B$BITS(CODE) THEN
      645     3592   10                ILOOP:             DO I=0 TO MONSER_TBL.CNT(FCG)-1;
      646     3593   11                                      IF TBL$->FCG_TBL.CODE(I)=CODE THEN DO;
      647     3594   11                                         CALL ADD_TO_LIST(START,TBL$->FCG_TBL.TEXTC(I))
              3594                                                  ;
      648     3595   11                                         EXIT ILOOP;
      649     3596   11                                         END;
      650     3597   10                                      END ILOOP;
      651     3598    9                                END; /* Do CODE */
      652     3599    8                SKIP:;
      653     3600    8                             END; /* Do FCG */
      654     3601    7                          TEXT_INDEX=TEXT_INDEX-1;
      655     3602    7                          TEXT_C=TEXTC_CPAREN;
      656     3603    7                          END;  /* Print monser list */
      657     3604    6                       END; /* If %PC_MONSERVAL */
      658     3605    5                    END; /* If INTINDX */
      659     3606    5                 ELSE DO; /* Not internally indexed */
      660     3607                         /* Single word bit mask. E.g., privilege bits. */
      661     3608    5                    TBL$=TEXT_TBL$(PTR$->P$TBL.VALCODE(DISP_TBL.PARM.PARM(DISPX)));
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:22   
      662     3609    5                    IF PTR$->P$TBL.TEXT.TEXT(DISP_TBL.PARM.PARM(DISPX))='STEPPRIVMASK'
              3609                             OR
      663     3610    5                       PTR$->P$TBL.TEXT.TEXT(DISP_TBL.PARM.PARM(DISPX))='PRIVMASK'
      664     3611    5                       THEN VALUE_BIT=~VALUE_BIT; /* Flip bits to make it easier */
      665     3612    5                    IF BINBIT(VALUE,36)='0'B THEN
      666     3613    5                       TEXT_C=TEXTC_NONE;
      667     3614    5                    ELSE IF BINBIT(VALUE,36)='777777777777'O THEN
      668     3615    5                       TEXT_C=TEXTC_ALL;
      669     3616    6                    ELSE DO; /* Have to print the list */
      670     3617                            /* This could be long and may not fit into column
      671     3618                               format, so list it instead.                    */
      672     3619    6                       START=TEXT_INDEX;
      673     3620    6                       CALL INSERT_TEXT(TEXTC_OPAREN);
      674     3621    7                       DO I=0 TO 35;
      675     3622    7                          IF VALUE_BIT(I) THEN
      676     3623    7                             CALL ADD_TO_LIST(START,TBL$->TEXTC_TBL(I));
      677     3624    7                          END;
      678     3625    6                       TEXT_INDEX=TEXT_INDEX-1;
      679     3626    6                       TEXT_C=TEXTC_CPAREN;
      680     3627    6                       END;
      681     3628    5                    END; /* not internally indexed */
      682     3629    4                 GOTO STUFF_IT;
      683     3630    4                 END;
      684     3631    4              ELSE DO;
      685     3632    5                 IF DISP_TBL.PARM.PARM(DISPX) = %PC_TIMEZONE THEN DO;
      686     3633    5                    TEXT_C.COUNT = 4;
      687     3634    5                    TEXT_C.TEXT = ADDR(VALUE)->B$CHAR4;
      688     3635    5                    GOTO STUFF_IT;
      689     3636    5                    END;
      690     3637    4                 IF VALUE < 0 THEN
      691     3638    4                    CALL INSERT_TEXT(TEXTC_MINUS);
      692     3639    4                 CALL BINCHAR(TEMPTEXT,VALUE);
      693     3640    4                 END;
      694     3641    3              END;
      695     3642        /**/
      696     3643    3           ELSE IF (PTR$ = RES$) THEN DO;
      697     3644    4                 IF (DISP_TBL.PARM.RESINDX(DISPX) = MMINDX) THEN DO; /* MEMORY  */
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:23   
      698     3645    4                    IF (DISP_TBL.PARM.PARM(DISPX) = %PC_MAXRES) THEN
      699     3646    4                       MONPTR$ = ADDR(FR_MEMM);
      700     3647    4                    ELSE IF (DISP_TBL.PARM.PARM(DISPX) = %PC_CURRES) THEN
      701     3648    4                          MONPTR$ = ADDR(FR_MEMC);
      702     3649    4                       ELSE MONPTR$ = ADDR(FR_MEMM);
      703     3650    4                    MONPTR.SEGID = BITBIN(%SPCL1SID);
      704     3651    4                    VALUE = MONPTR$ -> B$TABLE(INDX);
      705     3652    4                    END;
      706     3653        /**/
      707     3654    4                 ELSE IF (DISP_TBL.PARM.RESINDX(DISPX) < PSURES_OFFSET) THEN DO;
      708     3655    4                       MONPTR.ADDRESS = RES$ -> P$TBL.REPTR$.ADDRESS(DISP_TBL.PARM.PARM
              3655                                (DISPX));
      709     3656    4                       MONPTR.ADDRESS = MONPTR$ -> B$PTR.ADDRESS(INDX);
      710     3657    4                       VALUE = MONPTR$ -> B$TABLE(DISP_TBL.PARM.RESINDX(DISPX)-1);
      711     3658    4                       END;
      712     3659    4                    ELSE DO;               /* PSUEDO RES                         */
      713     3660    4                       MONPTR.ADDRESS = RES$ -> P$TBL.REPSUPTR$.ADDRESS(DISP_TBL.PARM.
              3660                                PARM(DISPX));
      714     3661    4                       MONPTR.ADDRESS = MONPTR$ -> B$PTR.ADDRESS(INDX);
      715     3662    4                       VALUE = MONPTR$ -> B$TABLE(DISP_TBL.PARM.RESINDX(DISPX)-
              3662                                PSURES_OFFSET);
      716     3663    4                       END;
      717     3664        /**/
      718     3665    4                 IF PTR$->P$TBL.FLAGS.VALTEXT(DISP_TBL.PARM.PARM(DISPX)) THEN DO;
      719     3666    4                    TEXT_C = TEXT_TBL$(PTR$->P$TBL.VALCODE(DISP_TBL.PARM.PARM(DISPX)))
              3666                             ->TEXTC_TBL(VALUE);
      720     3667    4                    GOTO STUFF_IT;
      721     3668    4                    END;  /* IF VALTEXT */
      722     3669    3                    ELSE CALL BINCHAR(TEMPTEXT,VALUE);
      723     3670    3                 END;
      724     3671        /**/
      725     3672    3              ELSE IF (PTR$ = PART$) THEN DO;
      726     3673    3                    IF (DISP_TBL.PARM.CAT(DISPX) = %PC_PDTCAT) THEN
      727     3674    3                       MONPTR$ = PINCRW(PDT$,SIZEW(JM$PT)*INDX);
      728     3675    3                    ELSE MONPTR$ = PINCRW(MONPART$,SIZEW(JM$PT)*INDX);
      729     3676    4                    DO CASE (DISP_TBL.PARM.PARM(DISPX));
      730     3677        /**/
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:24   
      731     3678    4                     CASE (%PC_PMINTI);
      732     3679    4                       VALUE = MONPTR$ -> JM$PT.TL;
      733     3680    4                       VALUE = VALUE/(PART$ -> P$TBL.MULT(%PC_PMINTI));
      734     3681        /**/
      735     3682    4                     CASE (%PC_PMAXTI);
      736     3683    4                       VALUE = MONPTR$ -> JM$PT.TU;
      737     3684    4                       VALUE = VALUE/(PART$ -> P$TBL.MULT(%PC_PMAXTI));
      738     3685        /**/
      739     3686    4                     CASE (%PC_PMINRES);
      740     3687    4                       VALUE = MONPTR$ -> JM$PT.RMIN(DISP_TBL.PARM.RESINDX(DISPX));
      741     3688        /**/
      742     3689    4                     CASE (%PC_PMAXRES);
      743     3690    4                       VALUE = MONPTR$ -> JM$PT.RMAX(DISP_TBL.PARM.RESINDX(DISPX));
      744     3691        /**/
      745     3692    4                     CASE (%PC_PLOCK);
      746     3693    4                       IF (MONPTR$ -> JM$PT.FLG.LOCK) THEN VALUE = 1;
      747     3694    4                       ELSE VALUE = 0;
      748     3695    4                       TEXT_C = FLAGVAL_TEXTC(VALUE);
      749     3696    4                       GOTO STUFF_IT;
      750     3697        /**/
      751     3698    4                     CASE (%PC_PQUAN);
      752     3699    4                       VALUE = MONPTR$ -> JM$PT.QUAN;
      753     3700    4                       VALUE = VALUE/(PART$ -> P$TBL.MULT(%PC_PQUAN));
      754     3701        /**/
      755     3702    4                     CASE (%PC_PPRIO);
      756     3703    4                       VALUE = MONPTR$ -> JM$PT.XPRIO;
      757     3704        /**/
      758     3705    4                     CASE (%PC_PMAXACCT);
      759     3706    4                       VALUE = MONPTR$ -> JM$PT.MAX1ACCT;
      760     3707        /**/
      761     3708    4                     CASE (%PC_PJMAX);
      762     3709    4                       VALUE = MONPTR$ -> JM$PT.MAX;
      763     3710        /**/
      764     3711    4                     CASE (%PC_PJCUR);
      765     3712    4                       VALUE = MONPTR$ -> JM$PT.CUR;
      766     3713        /**/
      767     3714    4                     CASE (%PC_PJCTOT);
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:25   
      768     3715    4                       VALUE = MONPTR$ -> JM$PT.CPTOT;
      769     3716        /**/
      770     3717    4                     CASE (%PC_PJTOT);
      771     3718    4                       VALUE = MONPTR$ -> JM$PT.TOT;
      772     3719    4                     END;
      773     3720        /**/
      774     3721    3                    CALL BINCHAR(TEMPTEXT,VALUE);
      775     3722    3                    END;
      776     3723        /**/
      777     3724    2           I = 0;
      778     3725    2           MONPTR.SEGID = BITBIN(%SPCL1SID);
      779     3726    3           DO WHILE ((I < SIZEC(TEMPTEXT)-1)AND(TEMPTEXT_ARRAY(I) = '0'));
      780     3727    3              I = I + 1;
      781     3728    3              END;
      782     3729        /**/
      783     3730    2           TEXT_C.COUNT = SIZEC(TEMPTEXT) - I;
      784     3731    2           TEXT_C.TEXT = SUBSTR(TEMPTEXT,I,SIZEC(TEMPTEXT)-I+1);
      785     3732        /**/
      786     3733    2   STUFF_IT:
      787     3734    2           CALL INSERT_TEXT(TEXT_C);
      788     3735    2           RETURN;
      789     3736        %EJECT;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:26   
      790     3737    2   INSERT_TEXT: PROC(TEXT_C);
      791     3738        /**/
      792     3739    3   DCL 1 TEXT_C,
      793     3740    3         2 COUNT UBIN(9) UNAL,
      794     3741    3         2 TEXT CHAR(31) UNAL;
      795     3742        /**/
      796     3743    3           CALL INSERT (TEXT_BUF,TEXT_INDEX,TEXT_C.COUNT,SUBSTR(TEXT_C.TEXT,0,TEXT_C.
              3743                    COUNT));
      797     3744        /**/
      798     3745    3           TEXT_INDEX = TEXT_INDEX + TEXT_C.COUNT;
      799     3746    3   END INSERT_TEXT;
      800     3747        %EJECT;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:27   
      801     3748    2   ADD_TO_LIST: PROC(START,TEXTC);
      802     3749        /**/
      803     3750    3   DCL START SBIN WORD;
      804     3751    3   DCL 1 TEXTC,
      805     3752    3         2 COUNT UBIN BYTE UNAL,
      806     3753    3         2 TEXT  CHAR(11)  UNAL;
      807     3754        /**/
      808     3755    4           IF (TEXT_INDEX+TEXTC.COUNT+1)/%CLMN_WIDTH > MAX_CLMN THEN DO;
      809     3756    4              TEXT_INDEX=TEXT_INDEX-1;
      810     3757    4              CALL PRINT_TEXT(%PC_FLUSH);
      811     3758    4              TEXT_C.COUNT=START+1;
      812     3759    4              TEXT_C.TEXT=' ';
      813     3760    4              TEXT_INDEX=0;
      814     3761    4              CALL INSERT_TEXT(TEXT_C);
      815     3762    4              END;
      816     3763    3           TEXT_C=TEXTC;
      817     3764    3           CALL INSERT_TEXT(TEXT_C);
      818     3765    3           CALL INSERT_TEXT(TEXTC_COMMA);
      819     3766    3           RETURN;
      820     3767    3   END ADD_TO_LIST;
      821     3768    2   END BUILD_TEXT;
      822     3769        %EJECT;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:28   
      823     3770        /**/
      824     3771    1   PRINT_TEXT: PROC(PRINT_PARAM) ALTRET;
      825     3772        /**/
      826     3773    2   DCL PRINT_PARAM SBIN WORD;
      827     3774        /**/
      828     3775    3           IF (CUR_CLMN + TEXT_INDEX/%CLMN_WIDTH) > MAX_CLMN THEN DO;
      829     3776    3              CALL PCW$WRITE(PRINT_BUF,(CUR_CLMN)*%CLMN_WIDTH) ALTRET (PRINT_ERR);
      830     3777    3              CUR_CLMN = 0;
      831     3778    3              PRINT_BUF = ' ';
      832     3779    3              END;
      833     3780        /**/
      834     3781    2           CALL INSERT(PRINT_BUF,CUR_CLMN*%CLMN_WIDTH,TEXT_INDEX+1,
      835     3782    2             SUBSTR(TEXT_BUF,0,TEXT_INDEX+1));
      836     3783        /**/
      837     3784    2           CUR_CLMN = CUR_CLMN + ((TEXT_INDEX)/%CLMN_WIDTH)+1;
      838     3785        /**/
      839     3786    3           IF (PRINT_PARAM = %PC_FLUSH) THEN DO;
      840     3787    3              CALL PCW$WRITE(PRINT_BUF,(CUR_CLMN)*%CLMN_WIDTH) ALTRET (PRINT_ERR);
      841     3788    3              CUR_CLMN = 0;
      842     3789    3              PRINT_BUF = ' ';
      843     3790    3              END;
      844     3791        /**/
      845     3792    2           RETURN;
      846     3793        /**/
      847     3794    2   PRINT_ERR:
      848     3795    2           ALTRETURN;
      849     3796    2   END PRINT_TEXT;
      850     3797    1   END PCP$PDISP;

PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:29   
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   UD_EQU_E.:E05TOU  is referenced.
   FR_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   JM$STRUCT.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   PC_PERR_C.:E05TOU  is referenced.
   PC_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure PCP$PDISP.

   Procedure PCP$PDISP requires 1145 words for executable code.
   Procedure PCP$PDISP requires 28 words of local(AUTO) storage.

    No errors detected in file PCP$PDISP.:E05TSI    .

PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:30   

 Object Unit name= PCP$PDISP                                  File name= PCP$PDISP.:E05TOU
 UTS= JUL 30 '97 04:21:06.88 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   432    660  PCP$PDISP
    2   DCB   even  none     0      0  M$LO
    3  RoData even  UTS      4      4  PCP$PDISP
    4   Proc  even  none  1145   2171  PCP$PDISP
    5  RoData even  none    25     31  PCP$PDISP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        1  PCP$PDISP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 PCE$ERROR
 yes     yes           Std       2 PCW$WRITE
         yes           Std       2 PCR$RESTEXT
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:31   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  FR_MEMC                               FR_MEMM
     M$LO                                  SYSTEM$                               PART$
     RES$                                  EX$                                   PDT$
     MONPTR$                               MONPART$                              RESTEXT_C
     TPSYS                                 MAX_CLMN                              CUR_CLMN
     PRINT_BUF                             B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:32   


        1        1        /*M*     PCP$PDISP - CONTROL MODULE TO DISPLAY INDIVIDUAL PARAMETERS  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*/
        8        8        PCP$PDISP: PROC(DISP_TBL) ALTRET;

      8  4 000000   000000 700200 xent  PCP$PDISP    TSX0  ! X66_AUTO_1
         4 000001   000034 000001                    ZERO    28,1

        9        9        /**/
       10       10    1   DCL 1 DISP_TBL,
       11       11    1         2 INDX UBIN WORD,
       12       12    1         2 PARM(0:99) ALIGNED,
       13       13    1           3 CAT UBIN(9) UNAL,
       14       14    1           3 PARM UBIN(9) UNAL,
       15       15    1           3 INDEXLO UBIN(9) UNAL,
       16       16    1           3 INDEXHI UBIN(9) UNAL,
       17       17    1           3 RESINDX SBIN HALF UNAL;
       18       18        /**/
       19       19        /*********************************************************************/
       20       20        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
       21       21        /*********************************************************************/
       22       22        %INCLUDE PC_SUBS_C;
       23      354        %INCLUDE PC_PERR_C;
       24      387        %INCLUDE CP_6;
       25      468        %INCLUDE CP_6_SUBS;
       26     1008        %INCLUDE JM$STRUCT;
       27     1753        %INCLUDE B_SEGIDS_C;
       28     2292        %INCLUDE FR_DATA_R;
       29     2324        %INCLUDE UD_EQU_E;
       30     2713        %INCLUDE XUD_UTS_M;
       31     2795        /**/
       32     2796        %SUB PSURES_OFFSET = 4;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:33   
       33     2797        %SUB MMINDX=0;
       34     2798        %XUD_UTS_EQU;
       35     2809        %EJECT;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:34   
       36     2810        /***************************************************************************/
       37     2811        /*   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   */
       38     2812        /***************************************************************************/
       39     2813        /**/
       40     2814    1   DCL TEMPTEXT CHAR(12) STATIC;
       41     2815    1   DCL 1 TEMPTEXT_ARRAY(0:11) REDEF TEMPTEXT CHAR(1);
       42     2816        /**/
       43     2817    1   DCL TEXT_INDEX SBIN WORD STATIC;
       44     2818    1   DCL TEXT_BUF CHAR(132) STATIC;
       45     2819        /**/
       46     2820    1   DCL 1 TEXT_C STATIC,
       47     2821    1         2 COUNT UBIN(9) UNAL,
       48     2822    1         2 TEXT CHAR(31) UNAL;
       49     2823        /**/
       50     2824    1   DCL 1 TEXTC_OPAREN STATIC,
       51     2825    1         2 COUNT UBIN(9) UNAL INIT(1),
       52     2826    1         2 TEXT CHAR(1) UNAL INIT('(');
       53     2827    1   DCL 1 TEXTC_CPAREN STATIC,
       54     2828    1         2 COUNT UBIN(9) UNAL INIT(1),
       55     2829    1         2 TEXT CHAR(1) UNAL INIT(')');
       56     2830    1   DCL 1 TEXTC_EQUALS STATIC,
       57     2831    1         2 COUNT UBIN(9) UNAL INIT(1),
       58     2832    1         2 TEXT CHAR(1) UNAL INIT('=');
       59     2833    1   DCL 1 TEXTC_COMMA STATIC,
       60     2834    1         2 COUNT UBIN(9) UNAL INIT(1),
       61     2835    1         2 TEXT  CHAR(1) UNAL INIT(',');
       62     2836    1   DCL 1 TEXTC_MINUS STATIC,
       63     2837    1         2 COUNT UBIN(9) UNAL INIT(1),
       64     2838    1         2 TEXT  CHAR(1) UNAL INIT('-');
       65     2839    1   DCL 1 TEXTC_NONE STATIC,
       66     2840    1         2 COUNT UBIN(9) UNAL INIT(4),
       67     2841    1         2 TEXT  CHAR(4) UNAL INIT('NONE');
       68     2842    1   DCL 1 TEXTC_ALL  STATIC,
       69     2843    1         2 COUNT UBIN(9) UNAL INIT(3),
       70     2844    1         2 TEXT  CHAR(3) UNAL INIT('ALL');
       71     2845        /**/
       72     2846    1   DCL I SBIN STATIC;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:35   
       73     2847    1   DCL J SBIN STATIC;
       74     2848    1   DCL K SBIN STATIC;
       75     2849    1   DCL CURUTS UBIN WORD STATIC;
       76     2850        /**/
       77     2851    1   DCL 1 FLAGVAL_TEXTC(0:1) STATIC ALIGNED,
       78     2852    1         2 COUNT UBIN BYTE UNAL INIT(2,3),
       79     2853    1         2 TEXT  CHAR(11)  UNAL INIT('NO','YES');
       80     2854    1   DCL 1 ANSPROTVAL_TEXTC(0:2) STATIC ALIGNED,
       81     2855    1         2 COUNT UBIN BYTE UNAL INIT(11,4,4),
       82     2856    1         2 TEXT  CHAR(11)  UNAL INIT('UNPROTECTED','SEMI','FULL');
       83     2857    1   DCL 1 AUTOSHAREVAL_TEXTC(0:2) STATIC ALIGNED,
       84     2858    1         2 COUNT UBIN BYTE UNAL INIT(2,3,4),
       85     2859    1         2 TEXT  CHAR(11)  UNAL INIT('RU','ALL','NONE');
       86     2860    1   DCL 1 LOGFILEVAL_TEXTC(0:2) STATIC ALIGNED,
       87     2861    1         2 COUNT UBIN BYTE UNAL INIT(2,3,5),
       88     2862    1         2 TEXT  CHAR(11)  UNAL INIT('NO','YES','MAYBE');
       89     2863    1   DCL 1 LOGACCVAL_TEXTC(0:4) STATIC ALIGNED,
       90     2864    1         2 COUNT UBIN BYTE UNAL INIT(4,8,10,6,3),
       91     2865    1         2 TEXT  CHAR(11)  UNAL INIT('NONE','FAILEDPW','FAILEDPWNE',
       92     2866    1                                     'FAILED','ALL');
       93     2867    1   DCL 1 LOGEXVAL_TEXTC(0:1) STATIC ALIGNED,
       94     2868    1         2 COUNT UBIN BYTE UNAL INIT(4,3),
       95     2869    1         2 TEXT  CHAR(11)  UNAL INIT('NONE','ALL');
       96     2870        /* The order in the PRIVVAL textc table must correspond to the order
       97     2871           of the bits in the appropriate security mask word.             */
       98     2872    1   DCL 1 PRIVVAL_TEXTC(0:35) STATIC ALIGNED, /* bits defined in the JIT */
       99     2873    1         2 COUNT UBIN BYTE UNAL INIT(5*3,6*2,0*7,4,7*2,0,6,5,3,0,6,
      100     2874    1                                     4*2,2,6,4,3,4,2,3*2,0,4,6,4,6),
      101     2875    1         2 TEXT  CHAR(11)  UNAL INIT('FMEFT',
      102     2876    1                                     'FMBLK',
      103     2877    1                                     'FMSEC',
      104     2878    1                                     'FMDIAG',
      105     2879    1                                     'FMREAD',
      106     2880    1                                     ' '*7,
      107     2881    1                                     'SNAP',
      108     2882    1                                     'SCREECH',
      109     2883    1                                     'DISPJOB',
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:36   
      110     2884    1                                     ' ',
      111     2885    1                                     'SYSCON',
      112     2886    1                                     'ASAVE',
      113     2887    1                                     'GPP',
      114     2888    1                                     ' ',
      115     2889    1                                     'SYSLOG',
      116     2890    1                                     'MFEP',
      117     2891    1                                     'CFEP',
      118     2892    1                                     'CQ',
      119     2893    1                                     'INTCON',
      120     2894    1                                     'IOQW',
      121     2895    1                                     'IOQ',
      122     2896    1                                     'EXPM',
      123     2897    1                                     'PM',
      124     2898    1                                     'TND',
      125     2899    1                                     'JIT',
      126     2900    1                                     ' ',
      127     2901    1                                     'MSYS',
      128     2902    1                                     'MAXMEM',
      129     2903    1                                     'EXMM',
      130     2904    1                                     'SPCLMM');
      131     2905    1   DCL 1 LOGLISTVAL_TEXTC(0:3) STATIC ALIGNED,
      132     2906    1         2 COUNT UBIN BYTE UNAL INIT(4,6,7,3),
      133     2907    1         2 TEXT  CHAR(11)  UNAL INIT('NONE','DENIED','GRANTED','ALL');
      134     2908    1   DCL 1 TEXTC_TBL(0:0) BASED ALIGNED,
      135     2909    1         2 COUNT UBIN BYTE UNAL,
      136     2910    1         2 TEXT  CHAR(11)  UNAL;
      137     2911    1   DCL TEXT_TBL$(0:7) PTR STATIC INIT(ADDR(FLAGVAL_TEXTC),
      138     2912    1                                      ADDR(ANSPROTVAL_TEXTC),
      139     2913    1                                      ADDR(AUTOSHAREVAL_TEXTC),
      140     2914    1                                      ADDR(LOGFILEVAL_TEXTC),
      141     2915    1                                      ADDR(LOGACCVAL_TEXTC),
      142     2916    1                                      ADDR(LOGEXVAL_TEXTC),
      143     2917    1                                      ADDR(PRIVVAL_TEXTC),
      144     2918    1                                      ADDR(LOGLISTVAL_TEXTC));
      145     2919    1   DCL TEMP$ PTR STATIC;
      146     2920
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:37   
      147     2921
      148     2922        /* MONSER_TBL contains: (1) the control values from ES_MONSERTBL since
      149     2923           the one word VALUE won't work in this case. These are internally
      150     2924           indexed for our convenience, but are set and displayed as a list
      151     2925           of monitor services, unlike the other indexed stuff. (2) Ptrs to
      152     2926           individual FCG tables. These are addr(nil) if we don't log any
      153     2927           pmmes in that category in the security log. (3) Count of how many
      154     2928           pmmes in that category are logged and, therefore, need text.
      155     2929           All this means that if pmmes are added to the list to be logged,
      156     2930           these tables will require updating/expanding for the generalized
      157     2931           code below to work.                                            */
      158     2932    1   DCL 1 MONSER_TBL ALIGNED STATIC,
      159     2933    1         2 VAL (0:%MAX_FCG#) BIT(36),
      160     2934    1         2 FCG$(0:%MAX_FCG#) PTR INIT(ADDR(JS_TBL),   /*  0 - JS  */
      161     2935    1                                      ADDR(NIL),      /*  1 - UE  */
      162     2936    1                                      ADDR(UM_TBL),   /*  2 - UM  */
      163     2937    1                                      ADDR(MM_TBL),   /*  3 - MM  */
      164     2938    1                                      ADDR(NIL),      /*  4 - FM1 */
      165     2939    1                                      ADDR(NIL),      /*  5 - FM2 */
      166     2940    1                                      ADDR(FM3_TBL),  /*  6 - FM3 */
      167     2941    1                                      ADDR(TD_TBL),   /*  7 - TD  */
      168     2942    1                                      ADDR(NIL),      /*  8 - KC  */
      169     2943    1                                      ADDR(NIL),      /*  9 - OT  */
      170     2944    1                                      ADDR(OC_TBL),   /* 10 - OC  */
      171     2945    1                                      ADDR(NIL),      /* 11 - KL  */
      172     2946    1                                      ADDR(PH_TBL),   /* 12 - PH  */
      173     2947    1                                      ADDR(FR_TBL),   /* 13 - FR  */
      174     2948    1                                      ADDR(KI_TBL),   /* 14 - KI  */
      175     2949    1                                      ADDR(NIL)*0),   /* 15 - FO  */
      176     2950                                                           /* new ones? */
      177     2951    1         2 CNT (0:%MAX_FCG#) UBIN BYTE UNAL INIT(1,   /*  0 - JS  */
      178     2952    1                                                 0,   /*  1 - UE  */
      179     2953    1                                                 3,   /*  2 - UM  */
      180     2954    1                                                 11,  /*  3 - MM  */
      181     2955    1                                                 0,   /*  4 - FM1 */
      182     2956    1                                                 0,   /*  5 - FM2 */
      183     2957    1                                                 1,   /*  6 - FM3 */
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:38   
      184     2958    1                                                 8,   /*  7 - TD  */
      185     2959    1                                                 0,   /*  8 - KC  */
      186     2960    1                                                 0,   /*  9 - OT  */
      187     2961    1                                                 1,   /* 10 - OC  */
      188     2962    1                                                 0,   /* 11 - KL  */
      189     2963    1                                                 4,   /* 12 - PH  */
      190     2964    1                                                 1,   /* 13 - FR  */
      191     2965    1                                                 3,   /* 14 - KI  */
      192     2966    1                                                 0*0);/* 15 - FO  */
      193     2967                                                           /* new ones? */
      194     2968        /**/
      195     2969        /* FCG tables */
      196     2970        /**/
      197     2971    1   DCL 1 FCG_TBL(0:0) ALIGNED BASED,
      198     2972    1         2 CODE    UBIN BYTE UNAL,
      199     2973    1         2 TEXTC,
      200     2974    1           3 COUNT UBIN BYTE UNAL,
      201     2975    1           3 TEXT  CHAR(11)  UNAL;
      202     2976
      203     2977    1   DCL 1 JS_TBL STATIC ALIGNED,
      204     2978    1         2 CODE    UBIN BYTE UNAL INIT(%C$SCREECH#),
      205     2979    1         2 TEXTC,
      206     2980    1           3 COUNT UBIN BYTE UNAL INIT(9),
      207     2981    1           3 TEXT  CHAR(11)  UNAL INIT('M$SCREECH');
      208     2982
      209     2983    1   DCL 1 UM_TBL(0:2) STATIC ALIGNED,
      210     2984    1         2 CODE    UBIN BYTE UNAL INIT(%C$SPRIV#,
      211     2985    1                                       %C$RUE#,
      212     2986    1                                       %C$GJOB#),
      213     2987    1         2 TEXTC,
      214     2988    1           3 COUNT UBIN BYTE UNAL INIT( 7,
      215     2989    1                                        5,
      216     2990    1                                        6),
      217     2991    1           3 TEXT  CHAR(11)  UNAL INIT('M$SPRIV',
      218     2992    1                                       'M$RUE',
      219     2993    1                                       'M$GJOB');
      220     2994
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:39   
      221     2995    1   DCL 1 MM_TBL(0:10) STATIC ALIGNED,
      222     2996    1         2 CODE    UBIN BYTE UNAL INIT(%C$STLPP#,
      223     2997    1                                       %C$RSPP#,
      224     2998    1                                       %C$CVM#,
      225     2999    1                                       %C$SMPRT#,
      226     3000    1                                       %C$SSC#,
      227     3001    1                                       %C$SAD#,
      228     3002    1                                       %C$BADPP#,
      229     3003    1                                       %C$GOODPP#,
      230     3004    1                                       %C$GBPL#,
      231     3005    1                                       %C$MPL#,
      232     3006    1                                       %C$UMPL#),
      233     3007    1         2 TEXTC,
      234     3008    1           3 COUNT UBIN BYTE UNAL INIT( 7,
      235     3009    1                                        6,
      236     3010    1                                        5,
      237     3011    1                                        7,
      238     3012    1                                        5,
      239     3013    1                                        5,
      240     3014    1                                        7,
      241     3015    1                                        8,
      242     3016    1                                        6,
      243     3017    1                                        5,
      244     3018    1                                        6),
      245     3019    1           3 TEXT  CHAR(11)  UNAL INIT('M$STLPP',
      246     3020    1                                       'M$RSPP',
      247     3021    1                                       'M$CVM',
      248     3022    1                                       'M$SMPRT',
      249     3023    1                                       'M$SSC',
      250     3024    1                                       'M$SAD',
      251     3025    1                                       'M$BADPP',
      252     3026    1                                       'M$GOODPP',
      253     3027    1                                       'M$GBPL',
      254     3028    1                                       'M$MPL',
      255     3029    1                                       'M$UMPL');
      256     3030
      257     3031    1   DCL 1 FM3_TBL STATIC ALIGNED,
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:40   
      258     3032    1         2 CODE    UBIN BYTE UNAL INIT(%C$MADMUCK#),
      259     3033    1         2 TEXTC,
      260     3034    1           3 COUNT UBIN BYTE UNAL INIT(9),
      261     3035    1           3 TEXT  CHAR(11)  UNAL INIT('M$MADMUCK');
      262     3036
      263     3037    1   DCL 1 TD_TBL(0:7) STATIC ALIGNED,
      264     3038    1         2 CODE    UBIN BYTE UNAL INIT(%C$RDSYSLOG#,
      265     3039    1                                       %C$WRSYSLOG#,
      266     3040    1                                       %C$TDOPEN#,
      267     3041    1                                       %C$TDCLOSE#,
      268     3042    1                                       %C$TDIO#,
      269     3043    1                                       %C$TDREQCPU#,
      270     3044    1                                       %C$IOQ#,
      271     3045    1                                       %C$SYSCON#),
      272     3046    1         2 TEXTC,
      273     3047    1           3 COUNT UBIN BYTE UNAL INIT(10,
      274     3048    1                                       10,
      275     3049    1                                        8,
      276     3050    1                                        9,
      277     3051    1                                        6,
      278     3052    1                                       10,
      279     3053    1                                        5,
      280     3054    1                                        8),
      281     3055    1           3 TEXT  CHAR(11)  UNAL INIT('M$RDSYSLOG',
      282     3056    1                                       'M$WRSYSLOG',
      283     3057    1                                       'M$TDOPEN',
      284     3058    1                                       'M$TDCLOSE',
      285     3059    1                                       'M$TDIO',
      286     3060    1                                       'M$TDREQCPU',
      287     3061    1                                       'M$IOQ',
      288     3062    1                                       'M$SYSCON');
      289     3063
      290     3064    1   DCL 1 OC_TBL STATIC ALIGNED,
      291     3065    1         2 CODE    UBIN BYTE UNAL INIT(%C$OCMSG#),
      292     3066    1         2 TEXTC,
      293     3067    1           3 COUNT UBIN BYTE UNAL INIT(7),
      294     3068    1           3 TEXT  CHAR(11)  UNAL INIT('M$OCMSG');
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:41   
      295     3069
      296     3070    1   DCL 1 PH_TBL(0:3) STATIC ALIGNED,
      297     3071    1         2 CODE    UBIN BYTE UNAL INIT(%C$SMOUSE#,
      298     3072    1                                       %C$XMOUSE#,
      299     3073    1                                       %C$GETMOUSE#,
      300     3074    1                                       %C$GETPM#),
      301     3075    1         2 TEXTC,
      302     3076    1           3 COUNT UBIN BYTE UNAL INIT( 8,
      303     3077    1                                        8,
      304     3078    1                                       10,
      305     3079    1                                        7),
      306     3080    1           3 TEXT  CHAR(11)  UNAL INIT('M$SMOUSE',
      307     3081    1                                       'M$XMOUSE',
      308     3082    1                                       'M$GETMOUSE',
      309     3083    1                                       'M$GETPM');
      310     3084
      311     3085    1   DCL 1 FR_TBL STATIC ALIGNED,
      312     3086    1         2 CODE    UBIN BYTE UNAL INIT(%C$LIMIT#),
      313     3087    1         2 TEXTC,
      314     3088    1           3 COUNT UBIN BYTE UNAL INIT(7),
      315     3089    1           3 TEXT  CHAR(11)  UNAL INIT('M$LIMIT');
      316     3090
      317     3091    1   DCL 1 KI_TBL(0:2) STATIC ALIGNED,
      318     3092    1         2 CODE    UBIN BYTE UNAL INIT(%C$FEBOOT#,
      319     3093    1                                       %C$FEDUMP#,
      320     3094    1                                       %C$FECTL#),
      321     3095    1         2 TEXTC,
      322     3096    1           3 COUNT UBIN BYTE UNAL INIT( 8,
      323     3097    1                                        8,
      324     3098    1                                        7),
      325     3099    1           3 TEXT  CHAR(11)  UNAL INIT('M$FEBOOT',
      326     3100    1                                       'M$FEDUMP',
      327     3101    1                                       'M$FECTL');
      328     3102
      329     3103        %EJECT;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:42   
      330     3104        /**********************************************************************/
      331     3105        /*   BASED DATA   BASED DATA   BASED DATA   BASED DATA   BASED DATA   */
      332     3106        /**********************************************************************/
      333     3107        /**/
      334     3108        %F$DCB;
      335     3165        %JM_PART (FPTN=JM$PT,STCLASS=BASED);
      336     3220        /**/
      337     3221    1   DCL 1 P$TBL(0:0) BASED ALIGNED,
      338     3222    1         2 FLAGS,
      339     3223    1           3 PRINT BIT(1) UNAL,
      340     3224    1           3 DISPONLY BIT(1) UNAL,
      341     3225    1           3 INDX BIT(1) UNAL,
      342     3226    1           3 RES BIT(1) UNAL,
      343     3227    1           3 MAXCONST BIT(1) UNAL,
      344     3228    1           3 MINCONST BIT(1) UNAL,
      345     3229    1           3 VALTEXT BIT(1) UNAL,
      346     3230    1           3 VALTEXTLIST BIT(1) UNAL,
      347     3231    1           3 INTINDX BIT(1) UNAL,
      348     3232    1           3 * BIT(9) UNAL,
      349     3233    1         2 VALCODE UBIN(18) UNAL,
      350     3234    1         2 RESPTR$ PTR ALIGNED,
      351     3235    1         2 TEXT ALIGNED,
      352     3236    1           3 COUNT UBIN(9) UNAL,
      353     3237    1           3 TEXT CHAR(19) UNAL,
      354     3238    1         2 PTR$ PTR,
      355     3239    1         2 REPTR$ REDEF PTR$,
      356     3240    1           3 ADDRESS UBIN(24) UNAL,
      357     3241    1           3 SEGID UBIN(12) UNAL,
      358     3242    1         2 PSUPTR$ PTR,
      359     3243    1         2 REPSUPTR$ REDEF PSUPTR$,
      360     3244    1           3 ADDRESS UBIN(24) UNAL,
      361     3245    1           3 SEGID UBIN(12) UNAL,
      362     3246    1         2 MAX UBIN WORD UNAL,
      363     3247    1         2 MIN UBIN WORD UNAL,
      364     3248    1         2 MULT UBIN WORD UNAL;
      365     3249        /**/
      366     3250    1   DCL 1 TEXTC$INDX(0:0) BASED ALIGNED,
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:43   
      367     3251    1         2 COUNT UBIN(9) UNAL,
      368     3252    1         2 TEXT CHAR(3) UNAL;
      369     3253        /**/
      370     3254    1   DCL B$TABLE(0:0) UBIN WORD BASED ALIGNED;
      371     3255    1   DCL B$MONSER(0:0) BIT(36) BASED ALIGNED;
      372     3256    1   DCL B$BITS(0:0) BIT(1) UNAL BASED;
      373     3257    1   DCL 1 B$PTR(0:0) BASED ALIGNED,
      374     3258    1         2 ADDRESS UBIN(24) UNAL,
      375     3259    1         2 SEGID UBIN(12) UNAL;
      376     3260        /**/
      377     3261    1   DCL B$CHAR4 CHAR(4) BASED;
      378     3262        %EJECT;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:44   
      379     3263        /***********************************************************************/
      380     3264        /*    ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   */
      381     3265        /**********************************************************************/
      382     3266        /**/
      383     3267    1   DCL PCE$ERROR ENTRY(2) ALTRET;
      384     3268    1   DCL PCW$WRITE ENTRY(2) ALTRET;
      385     3269    1   DCL PCR$RESTEXT ENTRY(2);
      386     3270        /**/
      387     3271        /********************************************************************/
      388     3272        /*   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   */
      389     3273        /********************************************************************/
      390     3274        /**/
      391     3275    1   DCL M$LO DCB;                           /* ALL OUTPUT                         */
      392     3276        /**/
      393     3277        /*****************************************************************/
      394     3278        /*   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   */
      395     3279        /*****************************************************************/
      396     3280        /**/
      397     3281    1   DCL SYSTEM$ PTR SYMREF;
      398     3282    1   DCL PART$ PTR SYMREF;
      399     3283    1   DCL RES$ PTR SYMREF;
      400     3284    1   DCL EX$ PTR SYMREF;
      401     3285        /**/
      402     3286    1   DCL PDT$ PTR SYMREF;
      403     3287        /**/
      404     3288    1   DCL MONPTR$ PTR SYMREF;
      405     3289    1   DCL 1 MONPTR REDEF MONPTR$,
      406     3290    1         2 ADDRESS UBIN(24) UNAL,
      407     3291    1         2 SEGID UBIN(12) UNAL;
      408     3292    1   DCL MONPART$ PTR SYMREF;
      409     3293        /**/
      410     3294    1   DCL RES_TEXT(0:3) CHAR(2) SYMREF;
      411     3295        /**/
      412     3296    1   DCL 1 RESTEXT_C SYMREF,
      413     3297    1         2 COUNT UBIN(9) UNAL,
      414     3298    1         2 TEXT CHAR(12) UNAL;
      415     3299        /**/
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:45   
      416     3300    1   DCL TPSYS BIT(1) SYMREF;
      417     3301        /**/
      418     3302    1   DCL MAX_CLMN SBIN WORD SYMREF;
      419     3303    1   DCL CUR_CLMN SBIN WORD SYMREF;
      420     3304    1   DCL PRINT_BUF CHAR(132) SYMREF;
      421     3305        /**/
      422     3306        /* MONITOR SYMREFS */
      423     3307        /**/
      424     3308        %EJECT;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:46   
      425     3309        /********************************************************************/
      426     3310        /*   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   */
      427     3311        /********************************************************************/
      428     3312        /**/
      429     3313        %FPT_TIME (FPTN=CUR_UTS,
      430     3314                   SOURCE=CLOCK,
      431     3315                   TSTAMP=CURUTS,
      432     3316                   DEST=UTS);
      433     3335        /**/
      434     3336        %FPT_PLATEN (FPTN=PLATEN_FPT,
      435     3337                     PLATEN=PLATEN_VLP);
      436     3362        /**/
      437     3363        %VLP_PLATEN (FPTN=PLATEN_VLP);
      438     3385        /**/
      439     3386        %EJECT;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:47   
      440     3387        /*****************************************************************************/
      441     3388        /*   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   */
      442     3389        /*****************************************************************************/
      443     3390        /**/
      444     3391    1           TEMP$ = DCBADDR(DCBNUM(M$LO));

   3391  4 000002   000000 236007 xsym               LDQ     M$LO,DL
         4 000003   000000 470400 5                  LDP0    0
         4 000004   000000 471500                    LDP1    0,,PR0
         4 000005   100000 236106                    LDQ     0,QL,PR1
         4 000006   000357 756000 1                  STQ     TEMP$

      445     3392    1           IF (TEMP$ -> F$DCB.ASN# = %DEVICE#) THEN I = TEMP$ -> F$DCB.WIDTH#;

   3392  4 000007   000357 473400 1                  LDP3    TEMP$
         4 000010   300032 236100                    LDQ     26,,PR3
         4 000011   777000 376007                    ANQ     -512,DL
         4 000012   003000 116007                    CMPQ    1536,DL
         4 000013   000020 601000 4                  TNZ     s:3393

   3392  4 000014   300004 236100                    LDQ     4,,PR3
         4 000015   000777 376007                    ANQ     511,DL
         4 000016   000065 756000 1                  STQ     I
         4 000017   000022 710000 4                  TRA     s:3395

      446     3393    1           ELSE I = 80;

   3393  4 000020   000120 235007                    LDA     80,DL
         4 000021   000065 755000 1                  STA     I

      447     3394        /**/
      448     3395    1           MAX_CLMN = (I/%CLMN_WIDTH) - 1;

   3395  4 000022   000065 236000 1                  LDQ     I
         4 000023   000014 506007                    DIV     12,DL
         4 000024   000001 136007                    SBLQ    1,DL
         4 000025   000000 756000 xsym               STQ     MAX_CLMN
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:48   

      449     3396        /**/
      450     3397    2           IF (MAX_CLMN < 0) THEN DO;

   3397  4 000026   000034 605000 4                  TPL     s:3402

      451     3398    2              CALL PCE$ERROR (%E$P_PLATEN2SMALL,2);

   3398  4 000027   000002 630400 5                  EPPR0   2
         4 000030   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000031   000000 701000 xent               TSX1    PCE$ERROR
         4 000032   000000 011000                    NOP     0

      452     3399    2              ALTRETURN;

   3399  4 000033   000000 702200 xent               TSX2  ! X66_AALT

      453     3400    2              END;
      454     3401        /**/
      455     3402    1           CUR_CLMN = 0;

   3402  4 000034   000000 450000 xsym               STZ     CUR_CLMN

      456     3403        /**/
      457     3404    2           DO J = 0 TO DISP_TBL.INDX;

   3404  4 000035   000066 450000 1                  STZ     J
         4 000036   000461 710000 4                  TRA     s:3488+1

      458     3405    3              DO CASE (DISP_TBL.PARM.CAT(J));

   3405  4 000037   000066 235000 1                  LDA     J
         4 000040   000001 735000                    ALS     1
         4 000041   200003 470500                    LDP0    @DISP_TBL,,AUTO
         4 000042   000001 236105                    LDQ     1,AL,PR0
         4 000043   000033 772000                    QRL     27
         4 000044   000010 116007                    CMPQ    8,DL
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:49   
         4 000045   000047 602006 4                  TNC     s:3405+8,QL
         4 000046   000460 710000 4                  TRA     s:3488
         4 000047   000460 710000 4                  TRA     s:3488
         4 000050   000057 710000 4                  TRA     s:3408
         4 000051   000215 710000 4                  TRA     s:3437
         4 000052   000331 710000 4                  TRA     s:3462
         4 000053   000460 710000 4                  TRA     s:3488
         4 000054   000405 710000 4                  TRA     s:3475
         4 000055   000460 710000 4                  TRA     s:3488
         4 000056   000331 710000 4                  TRA     s:3462

      459     3406        /**/
      460     3407    3               CASE (%PC_SYSTEM);

      461     3408    4                 IF (SYSTEM$ -> P$TBL.FLAGS.INDX(DISP_TBL.PARM.PARM(J))) THEN DO;

   3408  4 000057   000001 236105                    LDQ     1,AL,PR0
         4 000060   000022 772000                    QRL     18
         4 000061   000777 376007                    ANQ     511,DL
         4 000062   000014 402007                    MPY     12,DL
         4 000063   000000 471400 xsym               LDP1    SYSTEM$
         4 000064   100000 236106                    LDQ     0,QL,PR1
         4 000065   100000 316003                    CANQ    32768,DU
         4 000066   000156 600000 4                  TZE     s:3427

      462     3409    5                    IF (DISP_TBL.PARM.INDEXLO(J) = %PC_ALLOPT) THEN DO;
              3409                             /* ALL INDEXES */

   3409  4 000067   000066 235000 1                  LDA     J
         4 000070   000001 735000                    ALS     1
         4 000071   000001 236105                    LDQ     1,AL,PR0
         4 000072   777000 376007                    ANQ     -512,DL
         4 000073   145000 116007                    CMPQ    51712,DL
         4 000074   000126 601000 4                  TNZ     s:3418

      463     3410    5                       IF (TPSYS) THEN I = %PC_MAXMODE;

PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:50   
   3410  4 000075   000000 234000 xsym               SZN     TPSYS
         4 000076   000102 605000 4                  TPL     s:3411

   3410  4 000077   000004 235007                    LDA     4,DL
         4 000100   000065 755000 1                  STA     I
         4 000101   000104 710000 4                  TRA     s:3412

      464     3411    5                       ELSE I = %PC_MAXMODE - 1;

   3411  4 000102   000003 235007                    LDA     3,DL
         4 000103   000065 755000 1                  STA     I

      465     3412    6                       DO K = 1 TO I;

   3412  4 000104   000001 236007                    LDQ     1,DL
         4 000105   000067 756000 1                  STQ     K
         4 000106   000122 710000 4                  TRA     s:3415+1

      466     3413    6                          CALL BUILD_TEXT(SYSTEM$,J,K);

   3413  4 000107   000004 237000 5                  LDAQ    4
         4 000110   200006 757100                    STAQ    @PTR$+1,,AUTO
         4 000111   000006 236000 5                  LDQ     6
         4 000112   200005 756100                    STQ     @DISP_TBL+2,,AUTO
         4 000113   000515 701000 4                  TSX1    BUILD_TEXT
         4 000114   000000 011000                    NOP     0

      467     3414    6                          CALL PRINT_TEXT(%PC_ADDTEXT);

   3414  4 000115   000007 236000 5                  LDQ     7
         4 000116   200027 756100                    STQ     @TEXTC+3,,AUTO
         4 000117   002102 701000 4                  TSX1    PRINT_TEXT
         4 000120   000000 011000                    NOP     0

      468     3415    6                          END;

   3415  4 000121   000067 054000 1                  AOS     K
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:51   
         4 000122   000067 236000 1                  LDQ     K
         4 000123   000065 116000 1                  CMPQ    I
         4 000124   000107 604400 4                  TMOZ    s:3413

      469     3416    5                       END;

   3416  4 000125   000460 710000 4                  TRA     s:3488

      470     3417        /**/
      471     3418    4                    ELSE DO K = DISP_TBL.PARM.INDEXLO(J) TO

   3418  4 000126   000001 236105                    LDQ     1,AL,PR0
         4 000127   000011 772000                    QRL     9
         4 000130   000777 376007                    ANQ     511,DL
         4 000131   000067 756000 1                  STQ     K
         4 000132   000146 710000 4                  TRA     s:3422+1

      472     3419    5                         DISP_TBL.PARM.INDEXHI(J);
      473     3420    5                       CALL BUILD_TEXT(SYSTEM$,J,K);

   3420  4 000133   000004 237000 5                  LDAQ    4
         4 000134   200006 757100                    STAQ    @PTR$+1,,AUTO
         4 000135   000006 236000 5                  LDQ     6
         4 000136   200005 756100                    STQ     @DISP_TBL+2,,AUTO
         4 000137   000515 701000 4                  TSX1    BUILD_TEXT
         4 000140   000000 011000                    NOP     0

      474     3421    5                       CALL PRINT_TEXT(%PC_ADDTEXT);

   3421  4 000141   000007 236000 5                  LDQ     7
         4 000142   200027 756100                    STQ     @TEXTC+3,,AUTO
         4 000143   002102 701000 4                  TSX1    PRINT_TEXT
         4 000144   000000 011000                    NOP     0

      475     3422    5                       END;

   3422  4 000145   000067 054000 1                  AOS     K
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:52   
         4 000146   000066 235000 1                  LDA     J
         4 000147   000001 735000                    ALS     1
         4 000150   200003 470500                    LDP0    @DISP_TBL,,AUTO
         4 000151   000001 236105                    LDQ     1,AL,PR0
         4 000152   000777 376007                    ANQ     511,DL
         4 000153   000067 116000 1                  CMPQ    K
         4 000154   000133 605000 4                  TPL     s:3420

      476     3423        /**/
      477     3424    4                    END;

   3424  4 000155   000460 710000 4                  TRA     s:3488

      478     3425        /**/
      479     3426    4                 ELSE DO;                  /* NOT INDEXED                        */

      480     3427    4                    K = -1;

   3427  4 000156   000001 335007                    LCA     1,DL
         4 000157   000067 755000 1                  STA     K

      481     3428    4                    CALL BUILD_TEXT(SYSTEM$,J,K);

   3428  4 000160   000004 237000 5                  LDAQ    4
         4 000161   200006 757100                    STAQ    @PTR$+1,,AUTO
         4 000162   000006 236000 5                  LDQ     6
         4 000163   200005 756100                    STQ     @DISP_TBL+2,,AUTO
         4 000164   000515 701000 4                  TSX1    BUILD_TEXT
         4 000165   000000 011000                    NOP     0

      482     3429    5                   IF SYSTEM$->P$TBL.FLAGS.VALTEXTLIST(DISP_TBL.PARM.PARM(J)) THEN DO;

   3429  4 000166   000066 235000 1                  LDA     J
         4 000167   000001 735000                    ALS     1
         4 000170   200003 470500                    LDP0    @DISP_TBL,,AUTO
         4 000171   000001 236105                    LDQ     1,AL,PR0
         4 000172   000022 772000                    QRL     18
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:53   
         4 000173   000777 376007                    ANQ     511,DL
         4 000174   000014 402007                    MPY     12,DL
         4 000175   000000 471400 xsym               LDP1    SYSTEM$
         4 000176   100000 236106                    LDQ     0,QL,PR1
         4 000177   002000 316003                    CANQ    1024,DU
         4 000200   000210 600000 4                  TZE     s:3433

      483     3430    5                       TEXT_INDEX=TEXT_INDEX-1;

   3430  4 000201   000001 336007                    LCQ     1,DL
         4 000202   000003 056000 1                  ASQ     TEXT_INDEX

      484     3431    5                       CALL PRINT_TEXT(%PC_FLUSH);

   3431  4 000203   000003 236000 5                  LDQ     3
         4 000204   200027 756100                    STQ     @TEXTC+3,,AUTO
         4 000205   002102 701000 4                  TSX1    PRINT_TEXT
         4 000206   000000 011000                    NOP     0

      485     3432    5                       END;

   3432  4 000207   000460 710000 4                  TRA     s:3488

      486     3433    4                    ELSE CALL PRINT_TEXT(%PC_ADDTEXT);

   3433  4 000210   000007 236000 5                  LDQ     7
         4 000211   200027 756100                    STQ     @TEXTC+3,,AUTO
         4 000212   002102 701000 4                  TSX1    PRINT_TEXT
         4 000213   000000 011000                    NOP     0

      487     3434    4                    END;

   3434  4 000214   000460 710000 4                  TRA     s:3488

      488     3435        /**/
      489     3436    3               CASE (%PC_RESOURCE);

PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:54   
      490     3437    4                 IF (RES$ -> P$TBL.FLAGS.INDX(DISP_TBL.PARM.PARM(J))) THEN DO;

   3437  4 000215   000001 236105                    LDQ     1,AL,PR0
         4 000216   000022 772000                    QRL     18
         4 000217   000777 376007                    ANQ     511,DL
         4 000220   000014 402007                    MPY     12,DL
         4 000221   000000 471400 xsym               LDP1    RES$
         4 000222   100000 236106                    LDQ     0,QL,PR1
         4 000223   100000 316003                    CANQ    32768,DU
         4 000224   000314 600000 4                  TZE     s:3456

      491     3438    5                    IF (DISP_TBL.PARM.INDEXLO(J) = %PC_ALLOPT) THEN DO;
              3438                             /* ALL INDEXES */

   3438  4 000225   000066 235000 1                  LDA     J
         4 000226   000001 735000                    ALS     1
         4 000227   000001 236105                    LDQ     1,AL,PR0
         4 000230   777000 376007                    ANQ     -512,DL
         4 000231   145000 116007                    CMPQ    51712,DL
         4 000232   000264 601000 4                  TNZ     s:3447

      492     3439    5                       IF (TPSYS) THEN I = %PC_MAXMODE;

   3439  4 000233   000000 234000 xsym               SZN     TPSYS
         4 000234   000240 605000 4                  TPL     s:3440

   3439  4 000235   000004 235007                    LDA     4,DL
         4 000236   000065 755000 1                  STA     I
         4 000237   000242 710000 4                  TRA     s:3441

      493     3440    5                       ELSE I = %PC_MAXMODE - 1;

   3440  4 000240   000003 235007                    LDA     3,DL
         4 000241   000065 755000 1                  STA     I

      494     3441    6                       DO K = 1 TO I;

PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:55   
   3441  4 000242   000001 236007                    LDQ     1,DL
         4 000243   000067 756000 1                  STQ     K
         4 000244   000260 710000 4                  TRA     s:3444+1

      495     3442    6                          CALL BUILD_TEXT(RES$,J,K);

   3442  4 000245   000004 237000 5                  LDAQ    4
         4 000246   200006 757100                    STAQ    @PTR$+1,,AUTO
         4 000247   000010 236000 5                  LDQ     8
         4 000250   200005 756100                    STQ     @DISP_TBL+2,,AUTO
         4 000251   000515 701000 4                  TSX1    BUILD_TEXT
         4 000252   000000 011000                    NOP     0

      496     3443    6                          CALL PRINT_TEXT(%PC_ADDTEXT);

   3443  4 000253   000007 236000 5                  LDQ     7
         4 000254   200027 756100                    STQ     @TEXTC+3,,AUTO
         4 000255   002102 701000 4                  TSX1    PRINT_TEXT
         4 000256   000000 011000                    NOP     0

      497     3444    6                          END;

   3444  4 000257   000067 054000 1                  AOS     K
         4 000260   000067 236000 1                  LDQ     K
         4 000261   000065 116000 1                  CMPQ    I
         4 000262   000245 604400 4                  TMOZ    s:3442

      498     3445    5                       END;

   3445  4 000263   000460 710000 4                  TRA     s:3488

      499     3446        /**/
      500     3447    4                    ELSE DO K = DISP_TBL.PARM.INDEXLO(J) TO

   3447  4 000264   000001 236105                    LDQ     1,AL,PR0
         4 000265   000011 772000                    QRL     9
         4 000266   000777 376007                    ANQ     511,DL
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:56   
         4 000267   000067 756000 1                  STQ     K
         4 000270   000304 710000 4                  TRA     s:3451+1

      501     3448    5                         DISP_TBL.PARM.INDEXHI(J);
      502     3449    5                       CALL BUILD_TEXT(RES$,J,K);

   3449  4 000271   000004 237000 5                  LDAQ    4
         4 000272   200006 757100                    STAQ    @PTR$+1,,AUTO
         4 000273   000010 236000 5                  LDQ     8
         4 000274   200005 756100                    STQ     @DISP_TBL+2,,AUTO
         4 000275   000515 701000 4                  TSX1    BUILD_TEXT
         4 000276   000000 011000                    NOP     0

      503     3450    5                       CALL PRINT_TEXT(%PC_ADDTEXT);

   3450  4 000277   000007 236000 5                  LDQ     7
         4 000300   200027 756100                    STQ     @TEXTC+3,,AUTO
         4 000301   002102 701000 4                  TSX1    PRINT_TEXT
         4 000302   000000 011000                    NOP     0

      504     3451    5                       END;

   3451  4 000303   000067 054000 1                  AOS     K
         4 000304   000066 235000 1                  LDA     J
         4 000305   000001 735000                    ALS     1
         4 000306   200003 470500                    LDP0    @DISP_TBL,,AUTO
         4 000307   000001 236105                    LDQ     1,AL,PR0
         4 000310   000777 376007                    ANQ     511,DL
         4 000311   000067 116000 1                  CMPQ    K
         4 000312   000271 605000 4                  TPL     s:3449

      505     3452        /**/
      506     3453    4                    END;

   3453  4 000313   000460 710000 4                  TRA     s:3488

      507     3454        /**/
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:57   
      508     3455    4                 ELSE DO;                  /* NOT INDEXED                        */

      509     3456    4                    K = -1;

   3456  4 000314   000001 335007                    LCA     1,DL
         4 000315   000067 755000 1                  STA     K

      510     3457    4                    CALL BUILD_TEXT(RES$,J,K);

   3457  4 000316   000004 237000 5                  LDAQ    4
         4 000317   200006 757100                    STAQ    @PTR$+1,,AUTO
         4 000320   000010 236000 5                  LDQ     8
         4 000321   200005 756100                    STQ     @DISP_TBL+2,,AUTO
         4 000322   000515 701000 4                  TSX1    BUILD_TEXT
         4 000323   000000 011000                    NOP     0

      511     3458    4                    CALL PRINT_TEXT(%PC_ADDTEXT);

   3458  4 000324   000007 236000 5                  LDQ     7
         4 000325   200027 756100                    STQ     @TEXTC+3,,AUTO
         4 000326   002102 701000 4                  TSX1    PRINT_TEXT
         4 000327   000000 011000                    NOP     0

      512     3459    4                    END;

   3459  4 000330   000460 710000 4                  TRA     s:3488

      513     3460        /**/
      514     3461    3               CASE (%PC_PARTITION,%PC_PDTCAT);

      515     3462    3                 IF (DISP_TBL.PARM.INDEXLO(J) = %PC_ALLOPT) THEN /* ALL PARTITIONS */

   3462  4 000331   000001 236105                    LDQ     1,AL,PR0
         4 000332   777000 376007                    ANQ     -512,DL
         4 000333   145000 116007                    CMPQ    51712,DL
         4 000334   000355 601000 4                  TNZ     s:3468

PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:58   
      516     3463    4                 DO K = 0 TO 15;

   3463  4 000335   000067 450000 1                  STZ     K

      517     3464    4                    CALL BUILD_TEXT(PART$,J,K);

   3464  4 000336   000004 237000 5                  LDAQ    4
         4 000337   200006 757100                    STAQ    @PTR$+1,,AUTO
         4 000340   000011 236000 5                  LDQ     9
         4 000341   200005 756100                    STQ     @DISP_TBL+2,,AUTO
         4 000342   000515 701000 4                  TSX1    BUILD_TEXT
         4 000343   000000 011000                    NOP     0

      518     3465    4                    CALL PRINT_TEXT(%PC_ADDTEXT);

   3465  4 000344   000007 236000 5                  LDQ     7
         4 000345   200027 756100                    STQ     @TEXTC+3,,AUTO
         4 000346   002102 701000 4                  TSX1    PRINT_TEXT
         4 000347   000000 011000                    NOP     0

      519     3466    4                    END;

   3466  4 000350   000067 054000 1                  AOS     K
         4 000351   000067 235000 1                  LDA     K
         4 000352   000017 115007                    CMPA    15,DL
         4 000353   000336 604400 4                  TMOZ    s:3464
         4 000354   000460 710000 4                  TRA     s:3488

      520     3467        /**/
      521     3468    3                 ELSE DO K = DISP_TBL.PARM.INDEXLO(J) TO

   3468  4 000355   000001 236105                    LDQ     1,AL,PR0
         4 000356   000011 772000                    QRL     9
         4 000357   000777 376007                    ANQ     511,DL
         4 000360   000067 756000 1                  STQ     K
         4 000361   000375 710000 4                  TRA     s:3472+1

PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:59   
      522     3469    4                      DISP_TBL.PARM.INDEXHI(J);
      523     3470    4                    CALL BUILD_TEXT(PART$,J,K);

   3470  4 000362   000004 237000 5                  LDAQ    4
         4 000363   200006 757100                    STAQ    @PTR$+1,,AUTO
         4 000364   000011 236000 5                  LDQ     9
         4 000365   200005 756100                    STQ     @DISP_TBL+2,,AUTO
         4 000366   000515 701000 4                  TSX1    BUILD_TEXT
         4 000367   000000 011000                    NOP     0

      524     3471    4                    CALL PRINT_TEXT(%PC_ADDTEXT);

   3471  4 000370   000007 236000 5                  LDQ     7
         4 000371   200027 756100                    STQ     @TEXTC+3,,AUTO
         4 000372   002102 701000 4                  TSX1    PRINT_TEXT
         4 000373   000000 011000                    NOP     0

      525     3472    4                    END;

   3472  4 000374   000067 054000 1                  AOS     K
         4 000375   000066 235000 1                  LDA     J
         4 000376   000001 735000                    ALS     1
         4 000377   200003 470500                    LDP0    @DISP_TBL,,AUTO
         4 000400   000001 236105                    LDQ     1,AL,PR0
         4 000401   000777 376007                    ANQ     511,DL
         4 000402   000067 116000 1                  CMPQ    K
         4 000403   000362 605000 4                  TPL     s:3470
         4 000404   000460 710000 4                  TRA     s:3488

      526     3473        /**/
      527     3474    3               CASE (%PC_EXCEPTION);

      528     3475    3                 IF (DISP_TBL.PARM.INDEXLO(J) = %PC_ALLOPT) THEN /* ALL INDEXES  */

   3475  4 000405   000001 236105                    LDQ     1,AL,PR0
         4 000406   777000 376007                    ANQ     -512,DL
         4 000407   145000 116007                    CMPQ    51712,DL
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:60   
         4 000410   000431 601000 4                  TNZ     s:3481

      529     3476    4                 DO K = 0 TO %PC_MAXDOMAIN;

   3476  4 000411   000067 450000 1                  STZ     K

      530     3477    4                    CALL BUILD_TEXT(EX$,J,K);

   3477  4 000412   000004 237000 5                  LDAQ    4
         4 000413   200006 757100                    STAQ    @PTR$+1,,AUTO
         4 000414   000012 236000 5                  LDQ     10
         4 000415   200005 756100                    STQ     @DISP_TBL+2,,AUTO
         4 000416   000515 701000 4                  TSX1    BUILD_TEXT
         4 000417   000000 011000                    NOP     0

      531     3478    4                    CALL PRINT_TEXT(%PC_ADDTEXT);

   3478  4 000420   000007 236000 5                  LDQ     7
         4 000421   200027 756100                    STQ     @TEXTC+3,,AUTO
         4 000422   002102 701000 4                  TSX1    PRINT_TEXT
         4 000423   000000 011000                    NOP     0

      532     3479    4                    END;

   3479  4 000424   000067 054000 1                  AOS     K
         4 000425   000067 235000 1                  LDA     K
         4 000426   000003 115007                    CMPA    3,DL
         4 000427   000412 604400 4                  TMOZ    s:3477
         4 000430   000460 710000 4                  TRA     s:3488

      533     3480        /**/
      534     3481    3                 ELSE DO K = DISP_TBL.PARM.INDEXLO(J) TO

   3481  4 000431   000001 236105                    LDQ     1,AL,PR0
         4 000432   000011 772000                    QRL     9
         4 000433   000777 376007                    ANQ     511,DL
         4 000434   000067 756000 1                  STQ     K
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:61   
         4 000435   000451 710000 4                  TRA     s:3485+1

      535     3482    4                      DISP_TBL.PARM.INDEXHI(J);
      536     3483    4                    CALL BUILD_TEXT(EX$,J,K);

   3483  4 000436   000004 237000 5                  LDAQ    4
         4 000437   200006 757100                    STAQ    @PTR$+1,,AUTO
         4 000440   000012 236000 5                  LDQ     10
         4 000441   200005 756100                    STQ     @DISP_TBL+2,,AUTO
         4 000442   000515 701000 4                  TSX1    BUILD_TEXT
         4 000443   000000 011000                    NOP     0

      537     3484    4                    CALL PRINT_TEXT(%PC_ADDTEXT);

   3484  4 000444   000007 236000 5                  LDQ     7
         4 000445   200027 756100                    STQ     @TEXTC+3,,AUTO
         4 000446   002102 701000 4                  TSX1    PRINT_TEXT
         4 000447   000000 011000                    NOP     0

      538     3485    4                    END;

   3485  4 000450   000067 054000 1                  AOS     K
         4 000451   000066 235000 1                  LDA     J
         4 000452   000001 735000                    ALS     1
         4 000453   200003 470500                    LDP0    @DISP_TBL,,AUTO
         4 000454   000001 236105                    LDQ     1,AL,PR0
         4 000455   000777 376007                    ANQ     511,DL
         4 000456   000067 116000 1                  CMPQ    K
         4 000457   000436 605000 4                  TPL     s:3483

      539     3486        /**/
      540     3487    3               END;

      541     3488    2              END;

   3488  4 000460   000066 054000 1                  AOS     J
         4 000461   200003 470500                    LDP0    @DISP_TBL,,AUTO
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:62   
         4 000462   000000 236100                    LDQ     0,,PR0
         4 000463   000037 604000 4                  TMI     s:3405
         4 000464   000066 116000 1                  CMPQ    J
         4 000465   000037 605000 4                  TPL     s:3405

      542     3489        /**/
      543     3490    2           IF (CUR_CLMN ~= 0) THEN DO;

   3490  4 000466   000000 235000 xsym               LDA     CUR_CLMN
         4 000467   000507 600000 4                  TZE     s:3495

      544     3491    2              CALL PCW$WRITE(PRINT_BUF,(CUR_CLMN)*%CLMN_WIDTH) ALTRET (DISPLAY_ERR);

   3491  4 000470   000000 236000 xsym               LDQ     CUR_CLMN
         4 000471   000014 402007                    MPY     12,DL
         4 000472   200030 756100                    STQ     @PRINT_PARAM+1,,AUTO
         4 000473   200030 631500                    EPPR1   @PRINT_PARAM+1,,AUTO
         4 000474   200033 451500                    STP1    @PRINT_PARAM+4,,AUTO
         4 000475   000013 236000 5                  LDQ     11
         4 000476   200032 756100                    STQ     @PRINT_PARAM+3,,AUTO
         4 000477   200032 630500                    EPPR0   @PRINT_PARAM+3,,AUTO
         4 000500   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000501   000000 701000 xent               TSX1    PCW$WRITE
         4 000502   000514 702000 4                  TSX2    DISPLAY_ERR

      545     3492    2              CUR_CLMN = 0;

   3492  4 000503   000000 450000 xsym               STZ     CUR_CLMN

      546     3493    2              PRINT_BUF = ' ';

   3493  4 000504   040000 100400                    MLR     fill='040'O
         4 000505   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000506   000000 000204 xsym               ADSC9   PRINT_BUF                cn=0,n=132

      547     3494    2              END;

PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:63   
      548     3495    1           CALL PCW$WRITE(PRINT_BUF,1) ALTRET(DISPLAY_ERR); /* BLANK LINE        */

   3495  4 000507   000014 630400 5                  EPPR0   12
         4 000510   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000511   000000 701000 xent               TSX1    PCW$WRITE
         4 000512   000514 702000 4                  TSX2    DISPLAY_ERR

      549     3496    1           RETURN;

   3496  4 000513   000000 702200 xent               TSX2  ! X66_ARET

      550     3497        /**/
      551     3498    1   DISPLAY_ERR:
      552     3499    1           ALTRETURN;

   3499  4 000514   000000 702200 xent  DISPLAY_ERR  TSX2  ! X66_AALT

      553     3500        %EJECT;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:64   
      554     3501        /**/
      555     3502    1   BUILD_TEXT: PROC(PTR$,DISPX,INDX);

   3502  4 000515   200004 741300       BUILD_TEXT   STX1  ! @DISP_TBL+1,,AUTO

      556     3503        /**/
      557     3504    2   DCL PTR$ PTR;                           /* PTR TO PARAM TBL        */
      558     3505    2   DCL DISPX SBIN WORD;                    /* INDEX TO PARAM          */
      559     3506    2   DCL INDX SBIN WORD;                     /* INDEX TO USE            */
      560     3507        /**/
      561     3508    2   DCL START SBIN WORD;
      562     3509    2   DCL TBL$ PTR;
      563     3510    2   DCL I SBIN WORD;
      564     3511    2   DCL FCG SBIN WORD;
      565     3512    2   DCL CODE SBIN WORD;
      566     3513    2   DCL VALUE SBIN WORD;
      567     3514    2   DCL VALUE_BIT(0:35) REDEF VALUE BIT(1);
      568     3515    2   DCL VAL$ PTR;
      569     3516    2   DCL ALL_OFF BIT(1) ALIGNED;
      570     3517    2   DCL ALL_ON BIT(1) ALIGNED;
      571     3518    2   DCL SOME_ON(0:%MAX_FCG#) BIT(1) UNAL;
      572     3519        /**/
      573     3520    2           TEXT_INDEX = 0;

   3520  4 000516   000003 450000 1                  STZ     TEXT_INDEX

      574     3521    2           TEXT_BUF = ' ';

   3521  4 000517   040000 100400                    MLR     fill='040'O
         4 000520   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000521   000004 000204 1                  ADSC9   TEXT_BUF                 cn=0,n=132

      575     3522        /**/
      576     3523    2           CALL INSERT_TEXT(PTR$ -> P$TBL.TEXT(DISP_TBL.PARM.PARM(DISPX)));

   3523  4 000522   200006 470500                    LDP0    @DISPX,,AUTO
         4 000523   000000 235100                    LDA     0,,PR0
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:65   
         4 000524   000001 735000                    ALS     1
         4 000525   200005 471500                    LDP1    @PTR$,,AUTO
         4 000526   100000 473500                    LDP3    0,,PR1
         4 000527   200003 474500                    LDP4    @DISP_TBL,,AUTO
         4 000530   400001 236105                    LDQ     1,AL,PR4
         4 000531   000022 772000                    QRL     18
         4 000532   000777 376007                    ANQ     511,DL
         4 000533   000014 402007                    MPY     12,DL
         4 000534   300002 635506                    EPPR5   2,QL,PR3
         4 000535   200027 455500                    STP5    @TEXTC+3,,AUTO
         4 000536   002001 701000 4                  TSX1    INSERT_TEXT
         4 000537   000000 011000                    NOP     0

      577     3524        /**/
      578     3525    3           IF (DISP_TBL.PARM.RESINDX(DISPX) ~= -1) THEN DO; /* RESOURCE         */

   3525  4 000540   200006 470500                    LDP0    @DISPX,,AUTO
         4 000541   000000 235100                    LDA     0,,PR0
         4 000542   000001 735000                    ALS     1
         4 000543   200003 471500                    LDP1    @DISP_TBL,,AUTO
         4 000544   100002 220105                    LDX0    2,AL,PR1
         4 000545   777777 100003                    CMPX0   -1,DU
         4 000546   000570 600000 4                  TZE     s:3531

      579     3526    3              I = DISP_TBL.PARM.RESINDX(DISPX);

   3526  4 000547   000000 235100                    LDA     0,,PR0
         4 000550   000001 735000                    ALS     1
         4 000551   100002 236105                    LDQ     2,AL,PR1
         4 000552   000022 732000                    QRS     18
         4 000553   200012 756100                    STQ     I,,AUTO

      580     3527    3              CALL PCR$RESTEXT(I,RESTEXT_C);

   3527  4 000554   000016 236000 5                  LDQ     14
         4 000555   200031 756100                    STQ     @PRINT_PARAM+2,,AUTO
         4 000556   200012 633500                    EPPR3   I,,AUTO
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:66   
         4 000557   200030 453500                    STP3    @PRINT_PARAM+1,,AUTO
         4 000560   200030 630500                    EPPR0   @PRINT_PARAM+1,,AUTO
         4 000561   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000562   000000 701000 xent               TSX1    PCR$RESTEXT
         4 000563   000000 011000                    NOP     0

      581     3528    3              CALL INSERT_TEXT(RESTEXT_C);

   3528  4 000564   000016 236000 5                  LDQ     14
         4 000565   200027 756100                    STQ     @TEXTC+3,,AUTO
         4 000566   002001 701000 4                  TSX1    INSERT_TEXT
         4 000567   000000 011000                    NOP     0

      582     3529    3              END;

      583     3530        /**/
      584     3531    3           IF (INDX ~= -1) THEN DO;        /* ADD INDEX TEXT                     */

   3531  4 000570   200007 470500                    LDP0    @INDX,,AUTO
         4 000571   000000 235100                    LDA     0,,PR0
         4 000572   000027 115000 xsym               CMPA    B_VECTNIL+23
         4 000573   000616 600000 4                  TZE     s:3536

      585     3532    3              CALL INSERT_TEXT(TEXTC_OPAREN);

   3532  4 000574   000017 236000 5                  LDQ     15
         4 000575   200027 756100                    STQ     @TEXTC+3,,AUTO
         4 000576   002001 701000 4                  TSX1    INSERT_TEXT
         4 000577   000000 011000                    NOP     0

      586     3533    3              CALL INSERT_TEXT(PTR$ -> P$TBL.PTR$(0) -> TEXTC$INDX(INDX));

   3533  4 000600   200005 470500                    LDP0    @PTR$,,AUTO
         4 000601   000000 471500                    LDP1    0,,PR0
         4 000602   100007 473500                    LDP3    7,,PR1
         4 000603   200007 474500                    LDP4    @INDX,,AUTO
         4 000604   400000 720100                    LXL0    0,,PR4
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:67   
         4 000605   300000 635510                    EPPR5   0,X0,PR3
         4 000606   200027 455500                    STP5    @TEXTC+3,,AUTO
         4 000607   002001 701000 4                  TSX1    INSERT_TEXT
         4 000610   000000 011000                    NOP     0

      587     3534    3              CALL INSERT_TEXT(TEXTC_CPAREN);

   3534  4 000611   000020 236000 5                  LDQ     16
         4 000612   200027 756100                    STQ     @TEXTC+3,,AUTO
         4 000613   002001 701000 4                  TSX1    INSERT_TEXT
         4 000614   000000 011000                    NOP     0

      588     3535    3              END;

   3535  4 000615   000617 710000 4                  TRA     s:3538

      589     3536    2           ELSE INDX = 0;

   3536  4 000616   000000 450100                    STZ     0,,PR0

      590     3537        /**/
      591     3538    2           CALL INSERT_TEXT(TEXTC_EQUALS);

   3538  4 000617   000021 236000 5                  LDQ     17
         4 000620   200027 756100                    STQ     @TEXTC+3,,AUTO
         4 000621   002001 701000 4                  TSX1    INSERT_TEXT
         4 000622   000000 011000                    NOP     0

      592     3539        /**/
      593     3540    3           IF (PTR$ = SYSTEM$)OR(PTR$ = EX$) THEN DO;

   3540  4 000623   200005 470500                    LDP0    @PTR$,,AUTO
         4 000624   000000 236100                    LDQ     0,,PR0
         4 000625   000000 116000 xsym               CMPQ    SYSTEM$
         4 000626   000631 600000 4                  TZE     s:3541
         4 000627   000000 116000 xsym               CMPQ    EX$
         4 000630   001347 601000 4                  TNZ     s:3643
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:68   

      594     3541    3             MONPTR.ADDRESS = PTR$ -> P$TBL.REPTR$.ADDRESS(DISP_TBL.PARM.PARM(DISPX));

   3541  4 000631   200006 471500                    LDP1    @DISPX,,AUTO
         4 000632   100000 235100                    LDA     0,,PR1
         4 000633   000001 735000                    ALS     1
         4 000634   000000 473500                    LDP3    0,,PR0
         4 000635   200003 474500                    LDP4    @DISP_TBL,,AUTO
         4 000636   400001 236105                    LDQ     1,AL,PR4
         4 000637   000022 772000                    QRL     18
         4 000640   000777 376007                    ANQ     511,DL
         4 000641   000014 402007                    MPY     12,DL
         4 000642   300007 236106                    LDQ     7,QL,PR3
         4 000643   000000 752074 xsym               STCQ    MONPTR$,'74'O

      595     3542    3              VALUE = MONPTR$ -> B$TABLE(INDX);

   3542  4 000644   200007 473500                    LDP3    @INDX,,AUTO
         4 000645   300000 720100                    LXL0    0,,PR3
         4 000646   000000 475400 xsym               LDP5    MONPTR$
         4 000647   500000 235110                    LDA     0,X0,PR5
         4 000650   200015 755100                    STA     VALUE,,AUTO

      596     3543    3              CALL M$TIME (CUR_UTS);

   3543  4 000651   000630 630400 1                  EPPR0   CUR_UTS
         4 000652   020004 713400                    CLIMB   8196
         4 000653   402000 401760                    pmme    nvectors=5

      597     3544    3              IF (CURUTS >= %UTS_CUSP#) AND

   3544  4 000654   000070 236000 1                  LDQ     CURUTS
         4 000655   000000 116000 3                  CMPQ    0
         4 000656   000712 602000 4                  TNC     s:3550
         4 000657   200005 470500                    LDP0    @PTR$,,AUTO
         4 000660   000000 236100                    LDQ     0,,PR0
         4 000661   000000 116000 xsym               CMPQ    SYSTEM$
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:69   
         4 000662   000712 601000 4                  TNZ     s:3550
         4 000663   200006 471500                    LDP1    @DISPX,,AUTO
         4 000664   100000 235100                    LDA     0,,PR1
         4 000665   000001 735000                    ALS     1
         4 000666   200003 473500                    LDP3    @DISP_TBL,,AUTO
         4 000667   300001 236105                    LDQ     1,AL,PR3
         4 000670   000777 376003                    ANQ     511,DU
         4 000671   000031 116003                    CMPQ    25,DU
         4 000672   000701 602000 4                  TNC     s:3544+21
         4 000673   100000 235100                    LDA     0,,PR1
         4 000674   000001 735000                    ALS     1
         4 000675   300001 236105                    LDQ     1,AL,PR3
         4 000676   000777 376003                    ANQ     511,DU
         4 000677   000043 116003                    CMPQ    35,DU
         4 000700   000707 602000 4                  TNC     s:3549
         4 000701   100000 235100                    LDA     0,,PR1
         4 000702   000001 735000                    ALS     1
         4 000703   300001 236105                    LDQ     1,AL,PR3
         4 000704   000777 376003                    ANQ     511,DU
         4 000705   000064 116003                    CMPQ    52,DU
         4 000706   000712 601000 4                  TNZ     s:3550

      598     3545    3                 (PTR$ = SYSTEM$) AND
      599     3546    3                 (((DISP_TBL.PARM.PARM(DISPX) >= %PC_EXPTIME_LO) AND
      600     3547    3                  (DISP_TBL.PARM.PARM(DISPX) <= %PC_EXPTIME_HI)) OR
      601     3548    3                  (DISP_TBL.PARM.PARM(DISPX) = %PC_PROTECTSECLOG)) THEN
      602     3549    3                 VALUE = VALUE * 4;          /* 1/25 -> 1/100 */

   3549  4 000707   200015 235100                    LDA     VALUE,,AUTO
         4 000710   000002 735000                    ALS     2
         4 000711   200015 755100                    STA     VALUE,,AUTO

      603     3550    3              VALUE = VALUE/(PTR$ -> P$TBL.MULT(DISP_TBL.PARM.PARM(DISPX)));

   3550  4 000712   200006 470500                    LDP0    @DISPX,,AUTO
         4 000713   000000 235100                    LDA     0,,PR0
         4 000714   000001 735000                    ALS     1
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:70   
         4 000715   200005 471500                    LDP1    @PTR$,,AUTO
         4 000716   100000 473500                    LDP3    0,,PR1
         4 000717   200003 474500                    LDP4    @DISP_TBL,,AUTO
         4 000720   400001 236105                    LDQ     1,AL,PR4
         4 000721   000022 772000                    QRL     18
         4 000722   000777 376007                    ANQ     511,DL
         4 000723   000014 402007                    MPY     12,DL
         4 000724   000000 620006                    EAX0    0,QL
         4 000725   200015 236100                    LDQ     VALUE,,AUTO
         4 000726   300013 235110                    LDA     11,X0,PR3
         4 000727   000732 605000 4                  TPL     s:3550+16
         4 000730   000000 236003                    LDQ     0,DU
         4 000731   000733 710000 4                  TRA     s:3550+17
         4 000732   300013 506110                    DIV     11,X0,PR3
         4 000733   200015 756100                    STQ     VALUE,,AUTO

      604     3551    4              IF PTR$->P$TBL.FLAGS.VALTEXT(DISP_TBL.PARM.PARM(DISPX)) THEN DO;

   3551  4 000734   000000 235100                    LDA     0,,PR0
         4 000735   000001 735000                    ALS     1
         4 000736   100000 473500                    LDP3    0,,PR1
         4 000737   400001 236105                    LDQ     1,AL,PR4
         4 000740   000022 772000                    QRL     18
         4 000741   000777 376007                    ANQ     511,DL
         4 000742   000014 402007                    MPY     12,DL
         4 000743   300000 236106                    LDQ     0,QL,PR3
         4 000744   004000 316003                    CANQ    2048,DU
         4 000745   000764 600000 4                  TZE     s:3556

      605     3552    4                 TEXT_C = TEXT_TBL$(PTR$->P$TBL.VALCODE(DISP_TBL.PARM.PARM(DISPX)))->
              3552                          TEXTC_TBL(VALUE);

   3552  4 000746   000000 235100                    LDA     0,,PR0
         4 000747   000001 735000                    ALS     1
         4 000750   400001 236105                    LDQ     1,AL,PR4
         4 000751   000022 772000                    QRL     18
         4 000752   000777 376007                    ANQ     511,DL
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:71   
         4 000753   000014 402007                    MPY     12,DL
         4 000754   300000 720106                    LXL0    0,QL,PR3
         4 000755   000347 475410 1                  LDP5    TEXT_TBL$,X0
         4 000756   200015 236100                    LDQ     VALUE,,AUTO
         4 000757   000014 402007                    MPY     12,DL
         4 000760   000000 100506                    MLR     fill='000'O
         4 000761   500000 000014                    ADSC9   0,Q,PR5                  cn=0,n=12
         4 000762   000045 000040 1                  ADSC9   TEXT_C                   cn=0,n=32

      606     3553    4                 GOTO STUFF_IT;

   3553  4 000763   001773 710000 4                  TRA     STUFF_IT

      607     3554    4                 END;  /* IF VALTEXT */
      608     3555                   /* Print bit masks in a form humans can read. */
      609     3556    4             ELSE IF PTR$->P$TBL.FLAGS.VALTEXTLIST(DISP_TBL.PARM.PARM(DISPX)) THEN DO;

   3556  4 000764   000000 235100                    LDA     0,,PR0
         4 000765   000001 735000                    ALS     1
         4 000766   400001 236105                    LDQ     1,AL,PR4
         4 000767   000022 772000                    QRL     18
         4 000770   000777 376007                    ANQ     511,DL
         4 000771   000014 402007                    MPY     12,DL
         4 000772   300000 236106                    LDQ     0,QL,PR3
         4 000773   002000 316003                    CANQ    1024,DU
         4 000774   001321 600000 4                  TZE     s:3632

      610     3557    5                 IF PTR$->P$TBL.FLAGS.INTINDX(DISP_TBL.PARM.PARM(DISPX)) THEN DO;

   3557  4 000775   000000 235100                    LDA     0,,PR0
         4 000776   000001 735000                    ALS     1
         4 000777   400001 236105                    LDQ     1,AL,PR4
         4 001000   000022 772000                    QRL     18
         4 001001   000777 376007                    ANQ     511,DL
         4 001002   000014 402007                    MPY     12,DL
         4 001003   300000 430106                    FSZN    0,QL,PR3
         4 001004   001202 605000 4                  TPL     s:3608
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:72   

      611     3558                      /* Have to turn a table of bit masks into a form
      612     3559                         humans can read. E.g., a list of monitor services
      613     3560                         to be logged in the security log.                */
      614     3561    6                    IF PTR$->P$TBL.VALCODE(DISP_TBL.PARM.PARM(DISPX))=%PC_MONSERVAL
              3561                             THEN DO;

   3561  4 001005   000000 235100                    LDA     0,,PR0
         4 001006   000001 735000                    ALS     1
         4 001007   400001 236105                    LDQ     1,AL,PR4
         4 001010   000022 772000                    QRL     18
         4 001011   000777 376007                    ANQ     511,DL
         4 001012   000014 402007                    MPY     12,DL
         4 001013   300000 720106                    LXL0    0,QL,PR3
         4 001014   000010 100003                    CMPX0   8,DU
         4 001015   001320 601000 4                  TNZ     s:3629

      615     3562    7                       DO FCG=0 TO %MAX_FCG#;

   3562  4 001016   200013 450100                    STZ     FCG,,AUTO

      616     3563    7                          MONSER_TBL.VAL(FCG)=MONPTR$->B$MONSER(FCG);

   3563  4 001017   000000 470400 xsym               LDP0    MONPTR$
         4 001020   200013 720100                    LXL0    FCG,,AUTO
         4 001021   000000 236110                    LDQ     0,X0,PR0
         4 001022   000360 756010 1                  STQ     MONSER_TBL,X0

      617     3564    7                          END;

   3564  4 001023   200013 054100                    AOS     FCG,,AUTO
         4 001024   200013 235100                    LDA     FCG,,AUTO
         4 001025   000017 115007                    CMPA    15,DL
         4 001026   001017 604400 4                  TMOZ    s:3563

      618     3565    6                       SOME_ON='0'B;

PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:73   
   3565  4 001027   000022 236000 5                  LDQ     18
         4 001030   200021 356100                    ANSQ    SOME_ON,,AUTO

      619     3566    6                       ALL_OFF='1'B;

   3566  4 001031   400000 236003                    LDQ     -131072,DU
         4 001032   200017 756100                    STQ     ALL_OFF,,AUTO

      620     3567    6                       ALL_ON='1'B;

   3567  4 001033   200020 756100                    STQ     ALL_ON,,AUTO

      621     3568    7                       DO FCG=0 TO %MAX_FCG#;

   3568  4 001034   200013 450100                    STZ     FCG,,AUTO

      622     3569    8                          IF MONSER_TBL.VAL(FCG) THEN DO;

   3569  4 001035   200013 720100                    LXL0    FCG,,AUTO
         4 001036   000360 235010 1                  LDA     MONSER_TBL,X0
         4 001037   001053 600000 4                  TZE     s:3575

      623     3570    8                             ALL_OFF='0'B;

   3570  4 001040   200017 450100                    STZ     ALL_OFF,,AUTO

      624     3571    8                             SOME_ON(FCG)='1'B;

   3571  4 001041   200013 236100                    LDQ     FCG,,AUTO
         4 001042   001044 605000 4                  TPL     s:3571+3
         4 001043   000044 036003                    ADLQ    36,DU
         4 001044   003106 060400                    CSL     bolr='003'O
         4 001045   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         4 001046   200021 000001                    BDSC    SOME_ON,Q,AUTO           by=0,bit=0,n=1

      625     3572    8                             IF MONSER_TBL.VAL(FCG)~='777777777777'O THEN

PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:74   
   3572  4 001047   000360 236010 1                  LDQ     MONSER_TBL,X0
         4 001050   000027 116000 xsym               CMPQ    B_VECTNIL+23
         4 001051   001053 600000 4                  TZE     s:3575

      626     3573    8                                ALL_ON='0'B;

   3573  4 001052   200020 450100                    STZ     ALL_ON,,AUTO

      627     3574    8                             END;

      628     3575    7                          END;

   3575  4 001053   200013 054100                    AOS     FCG,,AUTO
         4 001054   200013 235100                    LDA     FCG,,AUTO
         4 001055   000017 115007                    CMPA    15,DL
         4 001056   001035 604400 4                  TMOZ    s:3569

      629     3576    6                       IF ALL_OFF THEN

   3576  4 001057   200017 234100                    SZN     ALL_OFF,,AUTO
         4 001060   001065 605000 4                  TPL     s:3578

      630     3577    6                          TEXT_C=TEXTC_NONE;

   3577  4 001061   000000 100400                    MLR     fill='000'O
         4 001062   000062 000005 1                  ADSC9   TEXTC_NONE               cn=0,n=5
         4 001063   000045 000040 1                  ADSC9   TEXT_C                   cn=0,n=32
         4 001064   001320 710000 4                  TRA     s:3629

      631     3578    6                       ELSE IF ALL_ON THEN

   3578  4 001065   200020 234100                    SZN     ALL_ON,,AUTO
         4 001066   001073 605000 4                  TPL     s:3581

      632     3579    6                          TEXT_C=TEXTC_ALL;

   3579  4 001067   000000 100400                    MLR     fill='000'O
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:75   
         4 001070   000064 000004 1                  ADSC9   TEXTC_ALL                cn=0,n=4
         4 001071   000045 000040 1                  ADSC9   TEXT_C                   cn=0,n=32
         4 001072   001320 710000 4                  TRA     s:3629

      633     3580    7                       ELSE DO; /* Print monser list */

      634     3581    7                          START=TEXT_INDEX;

   3581  4 001073   000003 236000 1                  LDQ     TEXT_INDEX
         4 001074   200010 756100                    STQ     START,,AUTO

      635     3582    7                          CALL INSERT_TEXT(TEXTC_OPAREN);

   3582  4 001075   000017 236000 5                  LDQ     15
         4 001076   200027 756100                    STQ     @TEXTC+3,,AUTO
         4 001077   002001 701000 4                  TSX1    INSERT_TEXT
         4 001100   000000 011000                    NOP     0

      636     3583    8                          DO FCG=0 TO %MAX_FCG#;

   3583  4 001101   200013 450100                    STZ     FCG,,AUTO

      637     3584    8                             IF NOT SOME_ON(FCG) THEN

   3584  4 001102   200013 235100                    LDA     FCG,,AUTO
         4 001103   001105 605000 4                  TPL     s:3584+3
         4 001104   000044 035003                    ADLA    36,DU
         4 001105   000000 066505                    CMPB    filb='0'B
         4 001106   200021 000001                    BDSC    SOME_ON,A,AUTO           by=0,bit=0,n=1
         4 001107   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 001110   001170 600000 4                  TZE     SKIP

      638     3585    8                                GOTO SKIP;
      639     3586    8                             TBL$=MONSER_TBL.FCG$(FCG);

   3586  4 001111   200013 720100                    LXL0    FCG,,AUTO
         4 001112   000400 236010 1                  LDQ     MONSER_TBL+16,X0
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:76   
         4 001113   200011 756100                    STQ     TBL$,,AUTO

      640     3587    8                             IF TBL$=ADDR(NIL) THEN

   3587  4 001114   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 001115   001170 600000 4                  TZE     SKIP

      641     3588    8                                GOTO SKIP; /* Oops. Forgot a table. */
      642     3589    8                             VAL$=ADDR(MONSER_TBL.VAL(FCG));

   3589  4 001116   000360 630410 1                  EPPR0   MONSER_TBL,X0
         4 001117   200016 450500                    STP0    VAL$,,AUTO

      643     3590    9                             DO CODE=0 TO 35;

   3590  4 001120   200014 450100                    STZ     CODE,,AUTO

      644     3591    9                                IF VAL$->B$BITS(CODE) THEN

   3591  4 001121   200014 235100                    LDA     CODE,,AUTO
         4 001122   001124 605000 4                  TPL     s:3591+3
         4 001123   000044 035003                    ADLA    36,DU
         4 001124   200016 470500                    LDP0    VAL$,,AUTO
         4 001125   000000 066505                    CMPB    filb='0'B
         4 001126   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         4 001127   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 001130   001164 600000 4                  TZE     s:3598

      645     3592   10                ILOOP:             DO I=0 TO MONSER_TBL.CNT(FCG)-1;

   3592  4 001131   200012 450100       ILOOP        STZ     I,,AUTO
         4 001132   001155 710000 4                  TRA     s:3597+1

      646     3593   11                                      IF TBL$->FCG_TBL.CODE(I)=CODE THEN DO;

   3593  4 001133   200012 235100                    LDA     I,,AUTO
         4 001134   000002 735000                    ALS     2
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:77   
         4 001135   200011 470500                    LDP0    TBL$,,AUTO
         4 001136   000000 236105                    LDQ     0,AL,PR0
         4 001137   000033 772000                    QRL     27
         4 001140   200014 116100                    CMPQ    CODE,,AUTO
         4 001141   001154 601000 4                  TNZ     s:3597

      647     3594   11                                        CALL ADD_TO_LIST(START,TBL$->FCG_TBL.TEXTC(I))
              3594                                                  ;

   3594  4 001142   200012 236100                    LDQ     I,,AUTO
         4 001143   000024 736000                    QLS     20
         4 001144   200000 036007                    ADLQ    65536,DL
         4 001145   200011 036100                    ADLQ    TBL$,,AUTO
         4 001146   200024 756100                    STQ     @START+1,,AUTO
         4 001147   200010 631500                    EPPR1   START,,AUTO
         4 001150   200023 451500                    STP1    SOME_ON+2,,AUTO
         4 001151   002026 701000 4                  TSX1    ADD_TO_LIST
         4 001152   000000 011000                    NOP     0

      648     3595   11                                         EXIT ILOOP;

   3595  4 001153   001164 710000 4                  TRA     s:3598

      649     3596   11                                         END;
      650     3597   10                                      END ILOOP;

   3597  4 001154   200012 054100                    AOS     I,,AUTO
         4 001155   200013 235100                    LDA     FCG,,AUTO
         4 001156   000100 101405                    MRL     fill='000'O
         4 001157   000420 000001 1                  ADSC9   MONSER_TBL+32,A          cn=0,n=1
         4 001160   200030 000004                    ADSC9   @PRINT_PARAM+1,,AUTO     cn=0,n=4
         4 001161   200030 236100                    LDQ     @PRINT_PARAM+1,,AUTO
         4 001162   200012 116100                    CMPQ    I,,AUTO
         4 001163   001133 605400 4                  TPNZ    s:3593

      651     3598    9                                END; /* Do CODE */

PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:78   
   3598  4 001164   200014 054100                    AOS     CODE,,AUTO
         4 001165   200014 235100                    LDA     CODE,,AUTO
         4 001166   000043 115007                    CMPA    35,DL
         4 001167   001121 604400 4                  TMOZ    s:3591

   3594  4 001170                       SKIP         null
      652     3599    8                SKIP:;
      653     3600    8                             END; /* Do FCG */

   3600  4 001170   200013 054100                    AOS     FCG,,AUTO
         4 001171   200013 235100                    LDA     FCG,,AUTO
         4 001172   000017 115007                    CMPA    15,DL
         4 001173   001102 604400 4                  TMOZ    s:3584

      654     3601    7                          TEXT_INDEX=TEXT_INDEX-1;

   3601  4 001174   000001 336007                    LCQ     1,DL
         4 001175   000003 056000 1                  ASQ     TEXT_INDEX

      655     3602    7                          TEXT_C=TEXTC_CPAREN;

   3602  4 001176   000000 100400                    MLR     fill='000'O
         4 001177   000056 000002 1                  ADSC9   TEXTC_CPAREN             cn=0,n=2
         4 001200   000045 000040 1                  ADSC9   TEXT_C                   cn=0,n=32

      656     3603    7                          END;  /* Print monser list */

      657     3604    6                       END; /* If %PC_MONSERVAL */

      658     3605    5                    END; /* If INTINDX */

   3605  4 001201   001320 710000 4                  TRA     s:3629

      659     3606    5                 ELSE DO; /* Not internally indexed */

      660     3607                         /* Single word bit mask. E.g., privilege bits. */
      661     3608    5                    TBL$=TEXT_TBL$(PTR$->P$TBL.VALCODE(DISP_TBL.PARM.PARM(DISPX)));
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:79   

   3608  4 001202   000000 235100                    LDA     0,,PR0
         4 001203   000001 735000                    ALS     1
         4 001204   400001 236105                    LDQ     1,AL,PR4
         4 001205   000022 772000                    QRL     18
         4 001206   000777 376007                    ANQ     511,DL
         4 001207   000014 402007                    MPY     12,DL
         4 001210   300000 720106                    LXL0    0,QL,PR3
         4 001211   000347 236010 1                  LDQ     TEXT_TBL$,X0
         4 001212   200011 756100                    STQ     TBL$,,AUTO

      662     3609    5                    IF PTR$->P$TBL.TEXT.TEXT(DISP_TBL.PARM.PARM(DISPX))='STEPPRIVMASK'
              3609                             OR

   3609  4 001213   000000 235100                    LDA     0,,PR0
         4 001214   000001 735000                    ALS     1
         4 001215   400001 236105                    LDQ     1,AL,PR4
         4 001216   000022 772000                    QRL     18
         4 001217   000777 376007                    ANQ     511,DL
         4 001220   000014 402007                    MPY     12,DL
         4 001221   000002 736000                    QLS     2
         4 001222   040000 106506                    CMPC    fill='040'O
         4 001223   300002 200023                    ADSC9   2,Q,PR3                  cn=1,n=19
         4 001224   000001 000014 3                  ADSC9   1                        cn=0,n=12
         4 001225   001241 600000 4                  TZE     s:3611
         4 001226   000000 235100                    LDA     0,,PR0
         4 001227   000001 735000                    ALS     1
         4 001230   400001 236105                    LDQ     1,AL,PR4
         4 001231   000022 772000                    QRL     18
         4 001232   000777 376007                    ANQ     511,DL
         4 001233   000014 402007                    MPY     12,DL
         4 001234   000002 736000                    QLS     2
         4 001235   040000 106506                    CMPC    fill='040'O
         4 001236   300002 200023                    ADSC9   2,Q,PR3                  cn=1,n=19
         4 001237   000002 000010 3                  ADSC9   2                        cn=0,n=8
         4 001240   001244 601000 4                  TNZ     s:3612

PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:80   
      663     3610    5                       PTR$->P$TBL.TEXT.TEXT(DISP_TBL.PARM.PARM(DISPX))='PRIVMASK'
      664     3611    5                       THEN VALUE_BIT=~VALUE_BIT; /* Flip bits to make it easier */

   3611  4 001241   200015 236100                    LDQ     VALUE,,AUTO
         4 001242   000027 676000 xsym               ERQ     B_VECTNIL+23
         4 001243   200015 756100                    STQ     VALUE,,AUTO

      665     3612    5                    IF BINBIT(VALUE,36)='0'B THEN

   3612  4 001244   200015 235100                    LDA     VALUE,,AUTO
         4 001245   001252 601000 4                  TNZ     s:3614

      666     3613    5                       TEXT_C=TEXTC_NONE;

   3613  4 001246   000000 100400                    MLR     fill='000'O
         4 001247   000062 000005 1                  ADSC9   TEXTC_NONE               cn=0,n=5
         4 001250   000045 000040 1                  ADSC9   TEXT_C                   cn=0,n=32
         4 001251   001320 710000 4                  TRA     s:3629

      667     3614    5                    ELSE IF BINBIT(VALUE,36)='777777777777'O THEN

   3614  4 001252   200015 236100                    LDQ     VALUE,,AUTO
         4 001253   000027 116000 xsym               CMPQ    B_VECTNIL+23
         4 001254   001261 601000 4                  TNZ     s:3619

      668     3615    5                       TEXT_C=TEXTC_ALL;

   3615  4 001255   000000 100400                    MLR     fill='000'O
         4 001256   000064 000004 1                  ADSC9   TEXTC_ALL                cn=0,n=4
         4 001257   000045 000040 1                  ADSC9   TEXT_C                   cn=0,n=32
         4 001260   001320 710000 4                  TRA     s:3629

      669     3616    6                    ELSE DO; /* Have to print the list */

      670     3617                            /* This could be long and may not fit into column
      671     3618                               format, so list it instead.                    */
      672     3619    6                       START=TEXT_INDEX;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:81   

   3619  4 001261   000003 235000 1                  LDA     TEXT_INDEX
         4 001262   200010 755100                    STA     START,,AUTO

      673     3620    6                       CALL INSERT_TEXT(TEXTC_OPAREN);

   3620  4 001263   000017 236000 5                  LDQ     15
         4 001264   200027 756100                    STQ     @TEXTC+3,,AUTO
         4 001265   002001 701000 4                  TSX1    INSERT_TEXT
         4 001266   000000 011000                    NOP     0

      674     3621    7                       DO I=0 TO 35;

   3621  4 001267   200012 450100                    STZ     I,,AUTO

      675     3622    7                          IF VALUE_BIT(I) THEN

   3622  4 001270   200012 235100                    LDA     I,,AUTO
         4 001271   001273 605000 4                  TPL     s:3622+3
         4 001272   000044 035003                    ADLA    36,DU
         4 001273   000000 066505                    CMPB    filb='0'B
         4 001274   200015 000001                    BDSC    VALUE,A,AUTO             by=0,bit=0,n=1
         4 001275   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 001276   001307 600000 4                  TZE     s:3624

      676     3623    7                             CALL ADD_TO_LIST(START,TBL$->TEXTC_TBL(I));

   3623  4 001277   200012 236100                    LDQ     I,,AUTO
         4 001300   000003 402003                    MPY     3,DU
         4 001301   200011 036100                    ADLQ    TBL$,,AUTO
         4 001302   200024 756100                    STQ     @START+1,,AUTO
         4 001303   200010 630500                    EPPR0   START,,AUTO
         4 001304   200023 450500                    STP0    SOME_ON+2,,AUTO
         4 001305   002026 701000 4                  TSX1    ADD_TO_LIST
         4 001306   000000 011000                    NOP     0

      677     3624    7                          END;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:82   

   3624  4 001307   200012 054100                    AOS     I,,AUTO
         4 001310   200012 235100                    LDA     I,,AUTO
         4 001311   000043 115007                    CMPA    35,DL
         4 001312   001270 604400 4                  TMOZ    s:3622

      678     3625    6                       TEXT_INDEX=TEXT_INDEX-1;

   3625  4 001313   000001 336007                    LCQ     1,DL
         4 001314   000003 056000 1                  ASQ     TEXT_INDEX

      679     3626    6                       TEXT_C=TEXTC_CPAREN;

   3626  4 001315   000000 100400                    MLR     fill='000'O
         4 001316   000056 000002 1                  ADSC9   TEXTC_CPAREN             cn=0,n=2
         4 001317   000045 000040 1                  ADSC9   TEXT_C                   cn=0,n=32

      680     3627    6                       END;

      681     3628    5                    END; /* not internally indexed */

      682     3629    4                 GOTO STUFF_IT;

   3629  4 001320   001773 710000 4                  TRA     STUFF_IT

      683     3630    4                 END;
      684     3631    4              ELSE DO;

      685     3632    5                 IF DISP_TBL.PARM.PARM(DISPX) = %PC_TIMEZONE THEN DO;

   3632  4 001321   000000 235100                    LDA     0,,PR0
         4 001322   000001 735000                    ALS     1
         4 001323   400001 236105                    LDQ     1,AL,PR4
         4 001324   000777 376003                    ANQ     511,DU
         4 001325   000067 116003                    CMPQ    55,DU
         4 001326   001335 601000 4                  TNZ     s:3637

PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:83   
      686     3633    5                    TEXT_C.COUNT = 4;

   3633  4 001327   004000 236003                    LDQ     2048,DU
         4 001330   000045 552040 1                  STBQ    TEXT_C,'40'O

      687     3634    5                    TEXT_C.TEXT = ADDR(VALUE)->B$CHAR4;

   3634  4 001331   040000 100500                    MLR     fill='040'O
         4 001332   200015 000004                    ADSC9   VALUE,,AUTO              cn=0,n=4
         4 001333   000045 200037 1                  ADSC9   TEXT_C                   cn=1,n=31

      688     3635    5                    GOTO STUFF_IT;

   3635  4 001334   001773 710000 4                  TRA     STUFF_IT

      689     3636    5                    END;
      690     3637    4                 IF VALUE < 0 THEN

   3637  4 001335   200015 235100                    LDA     VALUE,,AUTO
         4 001336   001343 605000 4                  TPL     s:3639

      691     3638    4                    CALL INSERT_TEXT(TEXTC_MINUS);

   3638  4 001337   000023 236000 5                  LDQ     19
         4 001340   200027 756100                    STQ     @TEXTC+3,,AUTO
         4 001341   002001 701000 4                  TSX1    INSERT_TEXT
         4 001342   000000 011000                    NOP     0

      692     3639    4                 CALL BINCHAR(TEMPTEXT,VALUE);

   3639  4 001343   000000 301500                    BTD
         4 001344   200015 000004                    NDSC9   VALUE,,AUTO              cn=0,s=lsgnf,sf=0,n=4
         4 001345   000000 030014 1                  NDSC9   TEMPTEXT                 cn=0,s=nosgn,sf=0,n=12

      693     3640    4                 END;

      694     3641    3              END;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:84   

   3641  4 001346   001746 710000 4                  TRA     s:3724

      695     3642        /**/
      696     3643    3           ELSE IF (PTR$ = RES$) THEN DO;

   3643  4 001347   000000 116000 xsym               CMPQ    RES$
         4 001350   001525 601000 4                  TNZ     s:3672

      697     3644    4                 IF (DISP_TBL.PARM.RESINDX(DISPX) = MMINDX) THEN DO; /* MEMORY  */

   3644  4 001351   200006 471500                    LDP1    @DISPX,,AUTO
         4 001352   100000 235100                    LDA     0,,PR1
         4 001353   000001 735000                    ALS     1
         4 001354   200003 473500                    LDP3    @DISP_TBL,,AUTO
         4 001355   300002 220105                    LDX0    2,AL,PR3
         4 001356   001413 601000 4                  TNZ     s:3654

      698     3645    4                    IF (DISP_TBL.PARM.PARM(DISPX) = %PC_MAXRES) THEN

   3645  4 001357   100000 235100                    LDA     0,,PR1
         4 001360   000001 735000                    ALS     1
         4 001361   300001 236105                    LDQ     1,AL,PR3
         4 001362   000777 376003                    ANQ     511,DU
         4 001363   000001 116003                    CMPQ    1,DU
         4 001364   001370 601000 4                  TNZ     s:3647

      699     3646    4                       MONPTR$ = ADDR(FR_MEMM);

   3646  4 001365   000024 236000 5                  LDQ     20
         4 001366   000000 756000 xsym               STQ     MONPTR$
         4 001367   001403 710000 4                  TRA     s:3650

      700     3647    4                    ELSE IF (DISP_TBL.PARM.PARM(DISPX) = %PC_CURRES) THEN

   3647  4 001370   100000 235100                    LDA     0,,PR1
         4 001371   000001 735000                    ALS     1
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:85   
         4 001372   300001 236105                    LDQ     1,AL,PR3
         4 001373   000777 376003                    ANQ     511,DU
         4 001374   000002 116003                    CMPQ    2,DU
         4 001375   001401 601000 4                  TNZ     s:3649

      701     3648    4                          MONPTR$ = ADDR(FR_MEMC);

   3648  4 001376   000025 236000 5                  LDQ     21
         4 001377   000000 756000 xsym               STQ     MONPTR$
         4 001400   001403 710000 4                  TRA     s:3650

      702     3649    4                       ELSE MONPTR$ = ADDR(FR_MEMM);

   3649  4 001401   000024 236000 5                  LDQ     20
         4 001402   000000 756000 xsym               STQ     MONPTR$

      703     3650    4                    MONPTR.SEGID = BITBIN(%SPCL1SID);

   3650  4 001403   006021 236007                    LDQ     3089,DL
         4 001404   000000 752003 xsym               STCQ    MONPTR$,'03'O

      704     3651    4                    VALUE = MONPTR$ -> B$TABLE(INDX);

   3651  4 001405   200007 474500                    LDP4    @INDX,,AUTO
         4 001406   400000 720100                    LXL0    0,,PR4
         4 001407   000000 475400 xsym               LDP5    MONPTR$
         4 001410   500000 235110                    LDA     0,X0,PR5
         4 001411   200015 755100                    STA     VALUE,,AUTO

      705     3652    4                    END;

   3652  4 001412   001471 710000 4                  TRA     s:3665

      706     3653        /**/
      707     3654    4                 ELSE IF (DISP_TBL.PARM.RESINDX(DISPX) < PSURES_OFFSET) THEN DO;

   3654  4 001413   100000 235100                    LDA     0,,PR1
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:86   
         4 001414   000001 735000                    ALS     1
         4 001415   300002 220105                    LDX0    2,AL,PR3
         4 001416   000004 100003                    CMPX0   4,DU
         4 001417   001445 605000 4                  TPL     s:3660

      708     3655    4                      MONPTR.ADDRESS = RES$ -> P$TBL.REPTR$.ADDRESS(DISP_TBL.PARM.PARM
              3655                                (DISPX));

   3655  4 001420   100000 235100                    LDA     0,,PR1
         4 001421   000001 735000                    ALS     1
         4 001422   300001 236105                    LDQ     1,AL,PR3
         4 001423   000022 772000                    QRL     18
         4 001424   000777 376007                    ANQ     511,DL
         4 001425   000014 402007                    MPY     12,DL
         4 001426   000000 474400 xsym               LDP4    RES$
         4 001427   400007 236106                    LDQ     7,QL,PR4
         4 001430   000000 752074 xsym               STCQ    MONPTR$,'74'O

      709     3656    4                       MONPTR.ADDRESS = MONPTR$ -> B$PTR.ADDRESS(INDX);

   3656  4 001431   200007 475500                    LDP5    @INDX,,AUTO
         4 001432   500000 720100                    LXL0    0,,PR5
         4 001433   000000 476400 xsym               LDP6    MONPTR$
         4 001434   600000 236110                    LDQ     0,X0,PR6
         4 001435   000000 752074 xsym               STCQ    MONPTR$,'74'O

      710     3657    4                       VALUE = MONPTR$ -> B$TABLE(DISP_TBL.PARM.RESINDX(DISPX)-1);

   3657  4 001436   100000 235100                    LDA     0,,PR1
         4 001437   000001 735000                    ALS     1
         4 001440   300002 220105                    LDX0    2,AL,PR3
         4 001441   000000 476400 xsym               LDP6    MONPTR$
         4 001442   677777 235110                    LDA     -1,X0,PR6
         4 001443   200015 755100                    STA     VALUE,,AUTO

      711     3658    4                       END;

PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:87   
   3658  4 001444   001471 710000 4                  TRA     s:3665

      712     3659    4                    ELSE DO;               /* PSUEDO RES                         */

      713     3660    4                       MONPTR.ADDRESS = RES$ -> P$TBL.REPSUPTR$.ADDRESS(DISP_TBL.PARM.
              3660                                PARM(DISPX));

   3660  4 001445   100000 235100                    LDA     0,,PR1
         4 001446   000001 735000                    ALS     1
         4 001447   300001 236105                    LDQ     1,AL,PR3
         4 001450   000022 772000                    QRL     18
         4 001451   000777 376007                    ANQ     511,DL
         4 001452   000014 402007                    MPY     12,DL
         4 001453   000000 474400 xsym               LDP4    RES$
         4 001454   400010 236106                    LDQ     8,QL,PR4
         4 001455   000000 752074 xsym               STCQ    MONPTR$,'74'O

      714     3661    4                       MONPTR.ADDRESS = MONPTR$ -> B$PTR.ADDRESS(INDX);

   3661  4 001456   200007 475500                    LDP5    @INDX,,AUTO
         4 001457   500000 720100                    LXL0    0,,PR5
         4 001460   000000 476400 xsym               LDP6    MONPTR$
         4 001461   600000 236110                    LDQ     0,X0,PR6
         4 001462   000000 752074 xsym               STCQ    MONPTR$,'74'O

      715     3662    4                       VALUE = MONPTR$ -> B$TABLE(DISP_TBL.PARM.RESINDX(DISPX)-
              3662                                PSURES_OFFSET);

   3662  4 001463   100000 235100                    LDA     0,,PR1
         4 001464   000001 735000                    ALS     1
         4 001465   300002 220105                    LDX0    2,AL,PR3
         4 001466   000000 476400 xsym               LDP6    MONPTR$
         4 001467   677774 235110                    LDA     -4,X0,PR6
         4 001470   200015 755100                    STA     VALUE,,AUTO

      716     3663    4                       END;

PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:88   
      717     3664        /**/
      718     3665    4                 IF PTR$->P$TBL.FLAGS.VALTEXT(DISP_TBL.PARM.PARM(DISPX)) THEN DO;

   3665  4 001471   100000 235100                    LDA     0,,PR1
         4 001472   000001 735000                    ALS     1
         4 001473   000000 474500                    LDP4    0,,PR0
         4 001474   300001 236105                    LDQ     1,AL,PR3
         4 001475   000022 772000                    QRL     18
         4 001476   000777 376007                    ANQ     511,DL
         4 001477   000014 402007                    MPY     12,DL
         4 001500   400000 236106                    LDQ     0,QL,PR4
         4 001501   004000 316003                    CANQ    2048,DU
         4 001502   001521 600000 4                  TZE     s:3669

      719     3666    4                    TEXT_C = TEXT_TBL$(PTR$->P$TBL.VALCODE(DISP_TBL.PARM.PARM(DISPX)))
              3666                             ->TEXTC_TBL(VALUE);

   3666  4 001503   100000 235100                    LDA     0,,PR1
         4 001504   000001 735000                    ALS     1
         4 001505   300001 236105                    LDQ     1,AL,PR3
         4 001506   000022 772000                    QRL     18
         4 001507   000777 376007                    ANQ     511,DL
         4 001510   000014 402007                    MPY     12,DL
         4 001511   400000 720106                    LXL0    0,QL,PR4
         4 001512   000347 475410 1                  LDP5    TEXT_TBL$,X0
         4 001513   200015 236100                    LDQ     VALUE,,AUTO
         4 001514   000014 402007                    MPY     12,DL
         4 001515   000000 100506                    MLR     fill='000'O
         4 001516   500000 000014                    ADSC9   0,Q,PR5                  cn=0,n=12
         4 001517   000045 000040 1                  ADSC9   TEXT_C                   cn=0,n=32

      720     3667    4                    GOTO STUFF_IT;

   3667  4 001520   001773 710000 4                  TRA     STUFF_IT

      721     3668    4                    END;  /* IF VALTEXT */
      722     3669    3                    ELSE CALL BINCHAR(TEMPTEXT,VALUE);
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:89   

   3669  4 001521   000000 301500                    BTD
         4 001522   200015 000004                    NDSC9   VALUE,,AUTO              cn=0,s=lsgnf,sf=0,n=4
         4 001523   000000 030014 1                  NDSC9   TEMPTEXT                 cn=0,s=nosgn,sf=0,n=12

      723     3670    3                 END;

   3670  4 001524   001746 710000 4                  TRA     s:3724

      724     3671        /**/
      725     3672    3              ELSE IF (PTR$ = PART$) THEN DO;

   3672  4 001525   000000 116000 xsym               CMPQ    PART$
         4 001526   001746 601000 4                  TNZ     s:3724

      726     3673    3                    IF (DISP_TBL.PARM.CAT(DISPX) = %PC_PDTCAT) THEN

   3673  4 001527   200006 471500                    LDP1    @DISPX,,AUTO
         4 001530   100000 235100                    LDA     0,,PR1
         4 001531   000001 735000                    ALS     1
         4 001532   200003 473500                    LDP3    @DISP_TBL,,AUTO
         4 001533   300001 236105                    LDQ     1,AL,PR3
         4 001534   777000 376003                    ANQ     -512,DU
         4 001535   007000 116003                    CMPQ    3584,DU
         4 001536   001545 601000 4                  TNZ     s:3675

      727     3674    3                       MONPTR$ = PINCRW(PDT$,SIZEW(JM$PT)*INDX);

   3674  4 001537   200007 474500                    LDP4    @INDX,,AUTO
         4 001540   400000 236100                    LDQ     0,,PR4
         4 001541   000023 402003                    MPY     19,DU
         4 001542   000000 036000 xsym               ADLQ    PDT$
         4 001543   000000 756000 xsym               STQ     MONPTR$
         4 001544   001552 710000 4                  TRA     s:3676

      728     3675    3                    ELSE MONPTR$ = PINCRW(MONPART$,SIZEW(JM$PT)*INDX);

PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:90   
   3675  4 001545   200007 474500                    LDP4    @INDX,,AUTO
         4 001546   400000 236100                    LDQ     0,,PR4
         4 001547   000023 402003                    MPY     19,DU
         4 001550   000000 036000 xsym               ADLQ    MONPART$
         4 001551   000000 756000 xsym               STQ     MONPTR$

      729     3676    4                    DO CASE (DISP_TBL.PARM.PARM(DISPX));

   3676  4 001552   100000 235100                    LDA     0,,PR1
         4 001553   000001 735000                    ALS     1
         4 001554   300001 220105                    LDX0    1,AL,PR3
         4 001555   000777 360003                    ANX0    511,DU
         4 001556   000015 100003                    CMPX0   13,DU
         4 001557   001561 602010 4                  TNC     s:3676+7,X0
         4 001560   001743 710000 4                  TRA     s:3721
         4 001561   001743 710000 4                  TRA     s:3721
         4 001562   001576 710000 4                  TRA     s:3679
         4 001563   001612 710000 4                  TRA     s:3683
         4 001564   001626 710000 4                  TRA     s:3687
         4 001565   001640 710000 4                  TRA     s:3690
         4 001566   001652 710000 4                  TRA     s:3693
         4 001567   001670 710000 4                  TRA     s:3699
         4 001570   001704 710000 4                  TRA     s:3703
         4 001571   001712 710000 4                  TRA     s:3706
         4 001572   001717 710000 4                  TRA     s:3709
         4 001573   001724 710000 4                  TRA     s:3712
         4 001574   001732 710000 4                  TRA     s:3715
         4 001575   001737 710000 4                  TRA     s:3718

      730     3677        /**/
      731     3678    4                     CASE (%PC_PMINTI);

      732     3679    4                       VALUE = MONPTR$ -> JM$PT.TL;

   3679  4 001576   000000 475400 xsym               LDP5    MONPTR$
         4 001577   500000 235100                    LDA     0,,PR5
         4 001600   200015 755100                    STA     VALUE,,AUTO
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:91   

      733     3680    4                       VALUE = VALUE/(PART$ -> P$TBL.MULT(%PC_PMINTI));

   3680  4 001601   000000 476400 xsym               LDP6    PART$
         4 001602   200015 236100                    LDQ     VALUE,,AUTO
         4 001603   600027 235100                    LDA     23,,PR6
         4 001604   001607 605000 4                  TPL     s:3680+6
         4 001605   000000 236003                    LDQ     0,DU
         4 001606   001610 710000 4                  TRA     s:3680+7
         4 001607   600027 506100                    DIV     23,,PR6
         4 001610   200015 756100                    STQ     VALUE,,AUTO
         4 001611   001743 710000 4                  TRA     s:3721

      734     3681        /**/
      735     3682    4                     CASE (%PC_PMAXTI);

      736     3683    4                       VALUE = MONPTR$ -> JM$PT.TU;

   3683  4 001612   000000 475400 xsym               LDP5    MONPTR$
         4 001613   500001 235100                    LDA     1,,PR5
         4 001614   200015 755100                    STA     VALUE,,AUTO

      737     3684    4                       VALUE = VALUE/(PART$ -> P$TBL.MULT(%PC_PMAXTI));

   3684  4 001615   000000 476400 xsym               LDP6    PART$
         4 001616   200015 236100                    LDQ     VALUE,,AUTO
         4 001617   600043 235100                    LDA     35,,PR6
         4 001620   001623 605000 4                  TPL     s:3684+6
         4 001621   000000 236003                    LDQ     0,DU
         4 001622   001624 710000 4                  TRA     s:3684+7
         4 001623   600043 506100                    DIV     35,,PR6
         4 001624   200015 756100                    STQ     VALUE,,AUTO
         4 001625   001743 710000 4                  TRA     s:3721

      738     3685        /**/
      739     3686    4                     CASE (%PC_PMINRES);

PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:92   
      740     3687    4                       VALUE = MONPTR$ -> JM$PT.RMIN(DISP_TBL.PARM.RESINDX(DISPX));

   3687  4 001626   100000 235100                    LDA     0,,PR1
         4 001627   000001 735000                    ALS     1
         4 001630   300002 236105                    LDQ     2,AL,PR3
         4 001631   000022 732000                    QRS     18
         4 001632   000001 736000                    QLS     1
         4 001633   000000 475400 xsym               LDP5    MONPTR$
         4 001634   000100 101506                    MRL     fill='000'O
         4 001635   500015 000002                    ADSC9   13,Q,PR5                 cn=0,n=2
         4 001636   200015 000004                    ADSC9   VALUE,,AUTO              cn=0,n=4
         4 001637   001743 710000 4                  TRA     s:3721

      741     3688        /**/
      742     3689    4                     CASE (%PC_PMAXRES);

      743     3690    4                       VALUE = MONPTR$ -> JM$PT.RMAX(DISP_TBL.PARM.RESINDX(DISPX));

   3690  4 001640   100000 235100                    LDA     0,,PR1
         4 001641   000001 735000                    ALS     1
         4 001642   300002 236105                    LDQ     2,AL,PR3
         4 001643   000022 732000                    QRS     18
         4 001644   000001 736000                    QLS     1
         4 001645   000000 475400 xsym               LDP5    MONPTR$
         4 001646   000100 101506                    MRL     fill='000'O
         4 001647   500007 000002                    ADSC9   7,Q,PR5                  cn=0,n=2
         4 001650   200015 000004                    ADSC9   VALUE,,AUTO              cn=0,n=4
         4 001651   001743 710000 4                  TRA     s:3721

      744     3691        /**/
      745     3692    4                     CASE (%PC_PLOCK);

      746     3693    4                       IF (MONPTR$ -> JM$PT.FLG.LOCK) THEN VALUE = 1;

   3693  4 001652   000000 475400 xsym               LDP5    MONPTR$
         4 001653   500004 236100                    LDQ     4,,PR5
         4 001654   000001 316007                    CANQ    1,DL
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:93   
         4 001655   001661 600000 4                  TZE     s:3694

   3693  4 001656   000001 235007                    LDA     1,DL
         4 001657   200015 755100                    STA     VALUE,,AUTO
         4 001660   001662 710000 4                  TRA     s:3695

      747     3694    4                       ELSE VALUE = 0;

   3694  4 001661   200015 450100                    STZ     VALUE,,AUTO

      748     3695    4                       TEXT_C = FLAGVAL_TEXTC(VALUE);

   3695  4 001662   200015 236100                    LDQ     VALUE,,AUTO
         4 001663   000014 402007                    MPY     12,DL
         4 001664   000000 100406                    MLR     fill='000'O
         4 001665   000071 000014 1                  ADSC9   FLAGVAL_TEXTC,Q          cn=0,n=12
         4 001666   000045 000040 1                  ADSC9   TEXT_C                   cn=0,n=32

      749     3696    4                       GOTO STUFF_IT;

   3696  4 001667   001773 710000 4                  TRA     STUFF_IT

      750     3697        /**/
      751     3698    4                     CASE (%PC_PQUAN);

      752     3699    4                       VALUE = MONPTR$ -> JM$PT.QUAN;

   3699  4 001670   000000 475400 xsym               LDP5    MONPTR$
         4 001671   500002 235100                    LDA     2,,PR5
         4 001672   200015 755100                    STA     VALUE,,AUTO

      753     3700    4                       VALUE = VALUE/(PART$ -> P$TBL.MULT(%PC_PQUAN));

   3700  4 001673   000000 476400 xsym               LDP6    PART$
         4 001674   200015 236100                    LDQ     VALUE,,AUTO
         4 001675   600123 235100                    LDA     83,,PR6
         4 001676   001701 605000 4                  TPL     s:3700+6
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:94   
         4 001677   000000 236003                    LDQ     0,DU
         4 001700   001702 710000 4                  TRA     s:3700+7
         4 001701   600123 506100                    DIV     83,,PR6
         4 001702   200015 756100                    STQ     VALUE,,AUTO
         4 001703   001743 710000 4                  TRA     s:3721

      754     3701        /**/
      755     3702    4                     CASE (%PC_PPRIO);

      756     3703    4                       VALUE = MONPTR$ -> JM$PT.XPRIO;

   3703  4 001704   000000 475400 xsym               LDP5    MONPTR$
         4 001705   500004 236100                    LDQ     4,,PR5
         4 001706   000011 772000                    QRL     9
         4 001707   000777 376007                    ANQ     511,DL
         4 001710   200015 756100                    STQ     VALUE,,AUTO
         4 001711   001743 710000 4                  TRA     s:3721

      757     3704        /**/
      758     3705    4                     CASE (%PC_PMAXACCT);

      759     3706    4                       VALUE = MONPTR$ -> JM$PT.MAX1ACCT;

   3706  4 001712   000000 475400 xsym               LDP5    MONPTR$
         4 001713   500005 236100                    LDQ     5,,PR5
         4 001714   000777 376007                    ANQ     511,DL
         4 001715   200015 756100                    STQ     VALUE,,AUTO
         4 001716   001743 710000 4                  TRA     s:3721

      760     3707        /**/
      761     3708    4                     CASE (%PC_PJMAX);

      762     3709    4                       VALUE = MONPTR$ -> JM$PT.MAX;

   3709  4 001717   000000 475400 xsym               LDP5    MONPTR$
         4 001720   500003 236100                    LDQ     3,,PR5
         4 001721   000033 772000                    QRL     27
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:95   
         4 001722   200015 756100                    STQ     VALUE,,AUTO
         4 001723   001743 710000 4                  TRA     s:3721

      763     3710        /**/
      764     3711    4                     CASE (%PC_PJCUR);

      765     3712    4                       VALUE = MONPTR$ -> JM$PT.CUR;

   3712  4 001724   000000 475400 xsym               LDP5    MONPTR$
         4 001725   500003 236100                    LDQ     3,,PR5
         4 001726   000022 772000                    QRL     18
         4 001727   000777 376007                    ANQ     511,DL
         4 001730   200015 756100                    STQ     VALUE,,AUTO
         4 001731   001743 710000 4                  TRA     s:3721

      766     3713        /**/
      767     3714    4                     CASE (%PC_PJCTOT);

      768     3715    4                       VALUE = MONPTR$ -> JM$PT.CPTOT;

   3715  4 001732   000000 475400 xsym               LDP5    MONPTR$
         4 001733   500003 236100                    LDQ     3,,PR5
         4 001734   777777 376007                    ANQ     -1,DL
         4 001735   200015 756100                    STQ     VALUE,,AUTO
         4 001736   001743 710000 4                  TRA     s:3721

      769     3716        /**/
      770     3717    4                     CASE (%PC_PJTOT);

      771     3718    4                       VALUE = MONPTR$ -> JM$PT.TOT;

   3718  4 001737   000000 475400 xsym               LDP5    MONPTR$
         4 001740   500004 236100                    LDQ     4,,PR5
         4 001741   000022 772000                    QRL     18
         4 001742   200015 756100                    STQ     VALUE,,AUTO

      772     3719    4                     END;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:96   

      773     3720        /**/
      774     3721    3                    CALL BINCHAR(TEMPTEXT,VALUE);

   3721  4 001743   000000 301500                    BTD
         4 001744   200015 000004                    NDSC9   VALUE,,AUTO              cn=0,s=lsgnf,sf=0,n=4
         4 001745   000000 030014 1                  NDSC9   TEMPTEXT                 cn=0,s=nosgn,sf=0,n=12

      775     3722    3                    END;

      776     3723        /**/
      777     3724    2           I = 0;

   3724  4 001746   200012 450100                    STZ     I,,AUTO

      778     3725    2           MONPTR.SEGID = BITBIN(%SPCL1SID);

   3725  4 001747   006021 236007                    LDQ     3089,DL
         4 001750   000000 752003 xsym               STCQ    MONPTR$,'03'O

      779     3726    3           DO WHILE ((I < SIZEC(TEMPTEXT)-1)AND(TEMPTEXT_ARRAY(I) = '0'));

   3726  4 001751   001753 710000 4                  TRA     s:3728

      780     3727    3              I = I + 1;

   3727  4 001752   200012 054100                    AOS     I,,AUTO

      781     3728    3              END;

   3728  4 001753   200012 235100                    LDA     I,,AUTO
         4 001754   000013 115007                    CMPA    11,DL
         4 001755   001762 605000 4                  TPL     s:3730
         4 001756   040000 106405                    CMPC    fill='040'O
         4 001757   000000 000001 1                  ADSC9   TEMPTEXT,A               cn=0,n=1
         4 001760   000026 000001 5                  ADSC9   22                       cn=0,n=1
         4 001761   001752 600000 4                  TZE     s:3727
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:97   

      782     3729        /**/
      783     3730    2           TEXT_C.COUNT = SIZEC(TEMPTEXT) - I;

   3730  4 001762   000014 236007                    LDQ     12,DL
         4 001763   200012 136100                    SBLQ    I,,AUTO
         4 001764   000033 736000                    QLS     27
         4 001765   000045 552040 1                  STBQ    TEXT_C,'40'O

      784     3731    2           TEXT_C.TEXT = SUBSTR(TEMPTEXT,I,SIZEC(TEMPTEXT)-I+1);

   3731  4 001766   777762 620005                    EAX0    -14,AL
         4 001767   777777 660003                    ERX0    -1,DU
         4 001770   040000 100445                    MLR     fill='040'O
         4 001771   000000 000010 1                  ADSC9   TEMPTEXT,A               cn=0,n=*X0
         4 001772   000045 200037 1                  ADSC9   TEXT_C                   cn=1,n=31

      785     3732        /**/
      786     3733    2   STUFF_IT:
      787     3734    2           CALL INSERT_TEXT(TEXT_C);

   3734  4 001773   000027 236000 5     STUFF_IT     LDQ     23
         4 001774   200027 756100                    STQ     @TEXTC+3,,AUTO
         4 001775   002001 701000 4                  TSX1    INSERT_TEXT
         4 001776   000000 011000                    NOP     0

      788     3735    2           RETURN;

   3735  4 001777   200004 221300                    LDX1  ! @DISP_TBL+1,,AUTO
         4 002000   000001 702211                    TSX2  ! 1,X1

      789     3736        %EJECT;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:98   
      790     3737    2   INSERT_TEXT: PROC(TEXT_C);

   3737  4 002001   200026 741300       INSERT_TEXT  STX1  ! @TEXTC+2,,AUTO

      791     3738        /**/
      792     3739    3   DCL 1 TEXT_C,
      793     3740    3         2 COUNT UBIN(9) UNAL,
      794     3741    3         2 TEXT CHAR(31) UNAL;
      795     3742        /**/
      796     3743    3           CALL INSERT (TEXT_BUF,TEXT_INDEX,TEXT_C.COUNT,SUBSTR(TEXT_C.TEXT,0,TEXT_C.
              3743                    COUNT));

   3743  4 002002   200027 470500                    LDP0    @TEXT_C,,AUTO
         4 002003   000100 101500                    MRL     fill='000'O
         4 002004   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         4 002005   200030 000002                    ADSC9   @PRINT_PARAM+1,,AUTO     cn=0,n=2
         4 002006   200030 220100                    LDX0    @PRINT_PARAM+1,,AUTO
         4 002007   000100 101500                    MRL     fill='000'O
         4 002010   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         4 002011   200031 000002                    ADSC9   @PRINT_PARAM+2,,AUTO     cn=0,n=2
         4 002012   200031 222100                    LDX2    @PRINT_PARAM+2,,AUTO
         4 002013   000003 235000 1                  LDA     TEXT_INDEX
         4 002014   040045 100540                    MLR     fill='040'O
         4 002015   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         4 002016   000004 000012 1                  ADSC9   TEXT_BUF,A               cn=0,n=*X2

      797     3744        /**/
      798     3745    3           TEXT_INDEX = TEXT_INDEX + TEXT_C.COUNT;

   3745  4 002017   000100 101500                    MRL     fill='000'O
         4 002020   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         4 002021   200030 000004                    ADSC9   @PRINT_PARAM+1,,AUTO     cn=0,n=4
         4 002022   200030 236100                    LDQ     @PRINT_PARAM+1,,AUTO
         4 002023   000003 036000 1                  ADLQ    TEXT_INDEX
         4 002024   000003 756000 1                  STQ     TEXT_INDEX

      799     3746    3   END INSERT_TEXT;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:99   

   3746  4 002025   000001 702211                    TSX2  ! 1,X1

      800     3747        %EJECT;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:100  
      801     3748    2   ADD_TO_LIST: PROC(START,TEXTC);

   3748  4 002026   200022 741300       ADD_TO_LIST  STX1  ! SOME_ON+1,,AUTO

      802     3749        /**/
      803     3750    3   DCL START SBIN WORD;
      804     3751    3   DCL 1 TEXTC,
      805     3752    3         2 COUNT UBIN BYTE UNAL,
      806     3753    3         2 TEXT  CHAR(11)  UNAL;
      807     3754        /**/
      808     3755    4           IF (TEXT_INDEX+TEXTC.COUNT+1)/%CLMN_WIDTH > MAX_CLMN THEN DO;

   3755  4 002027   200024 470500                    LDP0    @TEXTC,,AUTO
         4 002030   000100 101500                    MRL     fill='000'O
         4 002031   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         4 002032   200030 000004                    ADSC9   @PRINT_PARAM+1,,AUTO     cn=0,n=4
         4 002033   200030 236100                    LDQ     @PRINT_PARAM+1,,AUTO
         4 002034   000003 036000 1                  ADLQ    TEXT_INDEX
         4 002035   000001 036007                    ADLQ    1,DL
         4 002036   000014 506007                    DIV     12,DL
         4 002037   000000 116000 xsym               CMPQ    MAX_CLMN
         4 002040   002064 604400 4                  TMOZ    s:3763

      809     3756    4              TEXT_INDEX=TEXT_INDEX-1;

   3756  4 002041   000001 336007                    LCQ     1,DL
         4 002042   000003 056000 1                  ASQ     TEXT_INDEX

      810     3757    4              CALL PRINT_TEXT(%PC_FLUSH);

   3757  4 002043   000003 236000 5                  LDQ     3
         4 002044   200027 756100                    STQ     @TEXT_C,,AUTO
         4 002045   002102 701000 4                  TSX1    PRINT_TEXT
         4 002046   000000 011000                    NOP     0

      811     3758    4              TEXT_C.COUNT=START+1;

PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:101  
   3758  4 002047   200023 470500                    LDP0    @START,,AUTO
         4 002050   000000 236100                    LDQ     0,,PR0
         4 002051   000001 036007                    ADLQ    1,DL
         4 002052   000033 736000                    QLS     27
         4 002053   000045 552040 1                  STBQ    TEXT_C,'40'O

      812     3759    4              TEXT_C.TEXT=' ';

   3759  4 002054   040000 100400                    MLR     fill='040'O
         4 002055   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 002056   000045 200037 1                  ADSC9   TEXT_C                   cn=1,n=31

      813     3760    4              TEXT_INDEX=0;

   3760  4 002057   000003 450000 1                  STZ     TEXT_INDEX

      814     3761    4              CALL INSERT_TEXT(TEXT_C);

   3761  4 002060   000027 236000 5                  LDQ     23
         4 002061   200027 756100                    STQ     @TEXT_C,,AUTO
         4 002062   002001 701000 4                  TSX1    INSERT_TEXT
         4 002063   000000 011000                    NOP     0

      815     3762    4              END;

      816     3763    3           TEXT_C=TEXTC;

   3763  4 002064   200024 470500                    LDP0    @TEXTC,,AUTO
         4 002065   000000 100500                    MLR     fill='000'O
         4 002066   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12
         4 002067   000045 000040 1                  ADSC9   TEXT_C                   cn=0,n=32

      817     3764    3           CALL INSERT_TEXT(TEXT_C);

   3764  4 002070   000027 236000 5                  LDQ     23
         4 002071   200027 756100                    STQ     @TEXT_C,,AUTO
         4 002072   002001 701000 4                  TSX1    INSERT_TEXT
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:102  
         4 002073   000000 011000                    NOP     0

      818     3765    3           CALL INSERT_TEXT(TEXTC_COMMA);

   3765  4 002074   000030 236000 5                  LDQ     24
         4 002075   200027 756100                    STQ     @TEXT_C,,AUTO
         4 002076   002001 701000 4                  TSX1    INSERT_TEXT
         4 002077   000000 011000                    NOP     0

      819     3766    3           RETURN;

   3766  4 002100   200022 221300                    LDX1  ! SOME_ON+1,,AUTO
         4 002101   000001 702211                    TSX2  ! 1,X1

      820     3767    3   END ADD_TO_LIST;
      821     3768    2   END BUILD_TEXT;
      822     3769        %EJECT;
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:103  
      823     3770        /**/
      824     3771    1   PRINT_TEXT: PROC(PRINT_PARAM) ALTRET;

   3771  4 002102   200026 741300       PRINT_TEXT   STX1  ! @TEXTC+2,,AUTO

      825     3772        /**/
      826     3773    2   DCL PRINT_PARAM SBIN WORD;
      827     3774        /**/
      828     3775    3           IF (CUR_CLMN + TEXT_INDEX/%CLMN_WIDTH) > MAX_CLMN THEN DO;

   3775  4 002103   000003 236000 1                  LDQ     TEXT_INDEX
         4 002104   000014 506007                    DIV     12,DL
         4 002105   000000 036000 xsym               ADLQ    CUR_CLMN
         4 002106   000000 116000 xsym               CMPQ    MAX_CLMN
         4 002107   002127 604400 4                  TMOZ    s:3781

      829     3776    3              CALL PCW$WRITE(PRINT_BUF,(CUR_CLMN)*%CLMN_WIDTH) ALTRET (PRINT_ERR);

   3776  4 002110   000000 236000 xsym               LDQ     CUR_CLMN
         4 002111   000014 402007                    MPY     12,DL
         4 002112   200030 756100                    STQ     @PRINT_PARAM+1,,AUTO
         4 002113   200030 630500                    EPPR0   @PRINT_PARAM+1,,AUTO
         4 002114   200033 450500                    STP0    @PRINT_PARAM+4,,AUTO
         4 002115   000013 236000 5                  LDQ     11
         4 002116   200032 756100                    STQ     @PRINT_PARAM+3,,AUTO
         4 002117   200032 630500                    EPPR0   @PRINT_PARAM+3,,AUTO
         4 002120   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002121   000000 701000 xent               TSX1    PCW$WRITE
         4 002122   002167 702000 4                  TSX2    PRINT_ERR

      830     3777    3              CUR_CLMN = 0;

   3777  4 002123   000000 450000 xsym               STZ     CUR_CLMN

      831     3778    3              PRINT_BUF = ' ';

   3778  4 002124   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:104  
         4 002125   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 002126   000000 000204 xsym               ADSC9   PRINT_BUF                cn=0,n=132

      832     3779    3              END;

      833     3780        /**/
      834     3781    2           CALL INSERT(PRINT_BUF,CUR_CLMN*%CLMN_WIDTH,TEXT_INDEX+1,

   3781  4 002127   000003 720000 1                  LXL0    TEXT_INDEX
         4 002130   000001 621010                    EAX1    1,X0
         4 002131   000000 236000 xsym               LDQ     CUR_CLMN
         4 002132   000014 402007                    MPY     12,DL
         4 002133   040046 100440                    MLR     fill='040'O
         4 002134   000004 000011 1                  ADSC9   TEXT_BUF                 cn=0,n=*X1
         4 002135   000000 000011 xsym               ADSC9   PRINT_BUF,Q              cn=0,n=*X1

      835     3782    2             SUBSTR(TEXT_BUF,0,TEXT_INDEX+1));
      836     3783        /**/
      837     3784    2           CUR_CLMN = CUR_CLMN + ((TEXT_INDEX)/%CLMN_WIDTH)+1;

   3784  4 002136   000003 236000 1                  LDQ     TEXT_INDEX
         4 002137   000014 506007                    DIV     12,DL
         4 002140   000000 036000 xsym               ADLQ    CUR_CLMN
         4 002141   000001 036007                    ADLQ    1,DL
         4 002142   000000 756000 xsym               STQ     CUR_CLMN

      838     3785        /**/
      839     3786    3           IF (PRINT_PARAM = %PC_FLUSH) THEN DO;

   3786  4 002143   200027 470500                    LDP0    @PRINT_PARAM,,AUTO
         4 002144   000000 235100                    LDA     0,,PR0
         4 002145   000002 115007                    CMPA    2,DL
         4 002146   002165 601000 4                  TNZ     s:3792

      840     3787    3              CALL PCW$WRITE(PRINT_BUF,(CUR_CLMN)*%CLMN_WIDTH) ALTRET (PRINT_ERR);

   3787  4 002147   000014 402007                    MPY     12,DL
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:105  
         4 002150   200030 756100                    STQ     @PRINT_PARAM+1,,AUTO
         4 002151   200030 631500                    EPPR1   @PRINT_PARAM+1,,AUTO
         4 002152   200033 451500                    STP1    @PRINT_PARAM+4,,AUTO
         4 002153   000013 236000 5                  LDQ     11
         4 002154   200032 756100                    STQ     @PRINT_PARAM+3,,AUTO
         4 002155   200032 630500                    EPPR0   @PRINT_PARAM+3,,AUTO
         4 002156   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002157   000000 701000 xent               TSX1    PCW$WRITE
         4 002160   002167 702000 4                  TSX2    PRINT_ERR

      841     3788    3              CUR_CLMN = 0;

   3788  4 002161   000000 450000 xsym               STZ     CUR_CLMN

      842     3789    3              PRINT_BUF = ' ';

   3789  4 002162   040000 100400                    MLR     fill='040'O
         4 002163   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 002164   000000 000204 xsym               ADSC9   PRINT_BUF                cn=0,n=132

      843     3790    3              END;

      844     3791        /**/
      845     3792    2           RETURN;

   3792  4 002165   200026 221300                    LDX1  ! @TEXTC+2,,AUTO
         4 002166   000001 702211                    TSX2  ! 1,X1

      846     3793        /**/
      847     3794    2   PRINT_ERR:
      848     3795    2           ALTRETURN;

   3795  4 002167   200026 221300       PRINT_ERR    LDX1  ! @TEXTC+2,,AUTO
         4 002170   000000 702211                    TSX2  ! 0,X1
      849     3796    2   END PRINT_TEXT;
      850     3797    1   END PCP$PDISP;

PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:106  
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   UD_EQU_E.:E05TOU  is referenced.
   FR_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   JM$STRUCT.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   PC_PERR_C.:E05TOU  is referenced.
   PC_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure PCP$PDISP.
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:107  

 **** Variables and constants ****

  ****  Section 001  Data  PCP$PDISP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    77-0-0/w STRC(108)   r     1 ANSPROTVAL_TEXTC(0:2)
   110-0-0/w STRC(108)   r     1 AUTOSHAREVAL_TEXTC(0:2)
    70-0-0/w UBIN        r     1 CURUTS                   630-0-0/d STRC(432)   r     1 CUR_UTS
    71-0-0/w STRC(108)   r     1 FLAGVAL_TEXTC(0:1)
   520-0-0/w STRC(117)   r     1 FM3_TBL                  610-0-0/w STRC(117)   r     1 FR_TBL
    65-0-0/w SBIN        r     1 I                         66-0-0/w SBIN        r     1 J
   424-0-0/w STRC(117)   r     1 JS_TBL                    67-0-0/w SBIN        r     1 K
   614-0-0/w STRC(117)   r     1 KI_TBL(0:2)
   132-0-0/w STRC(108)   r     1 LOGACCVAL_TEXTC(0:4)
   151-0-0/w STRC(108)   r     1 LOGEXVAL_TEXTC(0:1)
   121-0-0/w STRC(108)   r     1 LOGFILEVAL_TEXTC(0:2)
   333-0-0/w STRC(108)   r     1 LOGLISTVAL_TEXTC(0:3)
   444-0-0/w STRC(117)   r     1 MM_TBL(0:10)             360-0-0/w STRC(1296)  r     1 MONSER_TBL
   564-0-0/w STRC(117)   r     1 OC_TBL                   570-0-0/w STRC(117)   r     1 PH_TBL(0:3)
   644-0-0/d STRC(288)   r     1 PLATEN_FPT               654-0-0/d STRC(144)   r     1 PLATEN_VLP
   157-0-0/w STRC(108)   r     1 PRIVVAL_TEXTC(0:35)
   524-0-0/w STRC(117)   r     1 TD_TBL(0:7)              357-0-0/w PTR         r     1 TEMP$
     0-0-0/c CHAR(12)    r     1 TEMPTEXT
     0-0-0/c CHAR        r     1 TEMPTEXT_ARRAY(0:11)
    64-0-0/c STRC        r     1 TEXTC_ALL                 60-0-0/c STRC(18)    r     1 TEXTC_COMMA
    56-0-0/c STRC(18)    r     1 TEXTC_CPAREN              57-0-0/c STRC(18)    r     1 TEXTC_EQUALS
    61-0-0/c STRC(18)    r     1 TEXTC_MINUS               62-0-0/c STRC(45)    r     1 TEXTC_NONE
    55-0-0/c STRC(18)    r     1 TEXTC_OPAREN               4-0-0/c CHAR(132)   r     1 TEXT_BUF
    45-0-0/c STRC(288)   r     1 TEXT_C                     3-0-0/w SBIN        r     1 TEXT_INDEX
   347-0-0/w PTR         r     1 TEXT_TBL$(0:7)
   430-0-0/w STRC(117)   r     1 UM_TBL(0:2)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:108  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w PTR         r     1 @DISPX                     3-0-0/w PTR         r     1 @DISP_TBL
     7-0-0/w PTR         r     1 @INDX                     27-0-0/w PTR         r     1 @PRINT_PARAM
     5-0-0/w PTR         r     1 @PTR$                     23-0-0/w PTR         r     1 @START
    24-0-0/w PTR         r     1 @TEXTC                    27-0-0/w PTR         r     1 @TEXT_C
    17-0-0/w BIT         r     1 ALL_OFF                   20-0-0/w BIT         r     1 ALL_ON
    14-0-0/w SBIN        r     1 CODE                      *0-0-0/w SBIN        r     1 DISPX
    *0-0-0/w STRC(7236)  r     1 DISP_TBL                  13-0-0/w SBIN        r     1 FCG
    12-0-0/w SBIN        r     1 I                         *0-0-0/w SBIN        r     1 INDX
    *0-0-0/w SBIN        r     1 PRINT_PARAM               *0-0-0/w PTR         r     1 PTR$
    21-0-0/b BIT         r     1 SOME_ON(0:15)             10-0-0/w SBIN        r     1 START
    *0-0-0/w SBIN        r     1 START                     11-0-0/w PTR         r     1 TBL$
    *0-0-0/c STRC(108)   r     1 TEXTC                     *0-0-0/c STRC(288)   r     1 TEXT_C
    16-0-0/w PTR         r     1 VAL$                      15-0-0/w SBIN        r     1 VALUE
    15-0-0/w BIT         r     1 VALUE_BIT(0:35)

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 CUR_CLMN                   0-0-0/w PTR         r     1 EX$
     0-0-0/w SBIN        r     1 FR_MEMC(0:0)
     0-0-0/w SBIN        r     1 FR_MEMM(0:0)
     0-0-0/w SBIN        r     1 MAX_CLMN                   0-0-0/w PTR         r     1 MONPART$
     0-0-0/w STRC        r     1 MONPTR                     0-0-0/w PTR         r     1 MONPTR$
     0-0-0/w PTR         r     1 PART$                      0-0-0/w PTR         r     1 PDT$
     0-0-0/c CHAR(132)   r     1 PRINT_BUF                  0-0-0/w PTR         r     1 RES$
     0-0-0/c STRC(117)   r     1 RESTEXT_C                  0-0-0/w PTR         r     1 SYSTEM$
     0-0-0/b BIT         r     1 TPSYS

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:109  
     0-0-0/b BIT         r     1 B$BITS(0:0)                0-0-0/c CHAR(4)     r     1 B$CHAR4
     0-0-0/w BIT         r     1 B$MONSER(0:0)
     0-0-0/w STRC        r     1 B$PTR(0:0)
     0-0-0/w UBIN        r     1 B$TABLE(0:0)
     0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/w STRC(117)   r     1 FCG_TBL(0:0)
     0-0-0/w STRC(684)   r     1 JM$PT                      0-0-0N  NULL        r     1 M$LO
     0-0-0N  NULL        r     1 M$UC                       0-0-0/w STRC(432)   r     1 P$TBL(0:0)
     0-0-0/w STRC        r     1 TEXTC$INDX(0:0)
     0-0-0/w STRC(108)   r     1 TEXTC_TBL(0:0)


   Procedure PCP$PDISP requires 1145 words for executable code.
   Procedure PCP$PDISP requires 28 words of local(AUTO) storage.

    No errors detected in file PCP$PDISP.:E05TSI    .
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:110  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:111  
          MINI XREF LISTING

ADD_TO_LIST IN PROCEDURE BUILD_TEXT
      3748**PROC     3594--CALL     3623--CALL
ALL_OFF IN PROCEDURE BUILD_TEXT
      3516**DCL      3566<<ASSIGN   3570<<ASSIGN   3576>>IF
ALL_ON IN PROCEDURE BUILD_TEXT
      3517**DCL      3567<<ASSIGN   3573<<ASSIGN   3578>>IF
ANSPROTVAL_TEXTC
      2854**DCL      2912--DCLINIT
AUTOSHAREVAL_TEXTC
      2857**DCL      2913--DCLINIT
B$BITS
      3256**DCL      3591>>IF
B$CHAR4
      3261**DCL      3634>>ASSIGN
B$MONSER
      3255**DCL      3563>>ASSIGN
B$PTR.ADDRESS
      3258**DCL      3656>>ASSIGN   3661>>ASSIGN
B$TABLE
      3254**DCL      3542>>ASSIGN   3651>>ASSIGN   3657>>ASSIGN   3662>>ASSIGN
BUILD_TEXT
      3502**PROC     3413--CALL     3420--CALL     3428--CALL     3442--CALL     3449--CALL     3457--CALL
      3464--CALL     3470--CALL     3477--CALL     3483--CALL
CODE IN PROCEDURE BUILD_TEXT
      3512**DCL      3590<<DOINDEX  3591>>IF       3593>>IF
CURUTS
      2849**DCL      3331--DCLINIT  3544>>IF
CUR_CLMN
      3303**DCL      3402<<ASSIGN   3490>>IF       3491>>CALL     3492<<ASSIGN   3775>>IF       3776>>CALL
      3777<<ASSIGN   3781>>CALLBLT  3784<<ASSIGN   3784>>ASSIGN   3787>>CALL     3788<<ASSIGN
CUR_UTS
      3327**DCL      3543<>CALL
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:112  
CUR_UTS.V
      3331**DCL      3327--DCLINIT
DISPLAY_ERR
      3499**LABEL    3491--CALLALT  3495--CALLALT
DISPX IN PROCEDURE BUILD_TEXT
      3505**DCL      3502--PROC     3523>>CALL     3525>>IF       3526>>ASSIGN   3541>>ASSIGN   3544>>IF
      3544>>IF       3544>>IF       3550>>ASSIGN   3551>>IF       3552>>ASSIGN   3556>>IF       3557>>IF
      3561>>IF       3608>>ASSIGN   3609>>IF       3609>>IF       3632>>IF       3644>>IF       3645>>IF
      3647>>IF       3654>>IF       3655>>ASSIGN   3657>>ASSIGN   3660>>ASSIGN   3662>>ASSIGN   3665>>IF
      3666>>ASSIGN   3673>>IF       3676>>DOCASE   3687>>ASSIGN   3690>>ASSIGN
DISP_TBL
        10**DCL         8--PROC
DISP_TBL.INDX
        11**DCL      3404>>DOINDEX
DISP_TBL.PARM.CAT
        13**DCL      3405>>DOCASE   3673>>IF
DISP_TBL.PARM.INDEXHI
        16**DCL      3418>>DOINDEX  3447>>DOINDEX  3468>>DOINDEX  3481>>DOINDEX
DISP_TBL.PARM.INDEXLO
        15**DCL      3409>>IF       3418>>DOINDEX  3438>>IF       3447>>DOINDEX  3462>>IF       3468>>DOINDEX
      3475>>IF       3481>>DOINDEX
DISP_TBL.PARM.PARM
        14**DCL      3408>>IF       3429>>IF       3437>>IF       3523>>CALL     3541>>ASSIGN   3544>>IF
      3544>>IF       3544>>IF       3550>>ASSIGN   3551>>IF       3552>>ASSIGN   3556>>IF       3557>>IF
      3561>>IF       3608>>ASSIGN   3609>>IF       3609>>IF       3632>>IF       3645>>IF       3647>>IF
      3655>>ASSIGN   3660>>ASSIGN   3665>>IF       3666>>ASSIGN   3676>>DOCASE
DISP_TBL.PARM.RESINDX
        17**DCL      3525>>IF       3526>>ASSIGN   3644>>IF       3654>>IF       3657>>ASSIGN   3662>>ASSIGN
      3687>>ASSIGN   3690>>ASSIGN
EX$
      3284**DCL      3477<>CALL     3483<>CALL     3540>>IF
F$DCB.ACTPOS
      3141**DCL      3141--REDEF
F$DCB.ARS#
      3115**DCL      3115--REDEF
F$DCB.ASN#
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:113  
      3130**DCL      3392>>IF
F$DCB.ATTR
      3134**DCL      3135--REDEF
F$DCB.BORROW
      3149**DCL      3149--REDEF    3149--REDEF    3149--REDEF
F$DCB.DCBNAME.L
      3163**DCL      3163--IMP-SIZ
F$DCB.EOMCHAR#
      3119**DCL      3119--REDEF
F$DCB.FLDID
      3144**DCL      3144--REDEF
F$DCB.FORM$
      3138**DCL      3138--REDEF
F$DCB.FSECT
      3154**DCL      3154--REDEF
F$DCB.FSN#
      3131**DCL      3131--REDEF    3131--REDEF    3132--REDEF
F$DCB.HEADER$
      3137**DCL      3137--REDEF
F$DCB.IXTNSIZE#
      3135**DCL      3135--REDEF
F$DCB.LASTSTA$
      3124**DCL      3124--REDEF
F$DCB.LVL
      3150**DCL      3150--REDEF
F$DCB.NAME#.C
      3125**DCL      3125--REDEF
F$DCB.NOEOF
      3147**DCL      3147--REDEF
F$DCB.NRECS#
      3136**DCL      3136--REDEF
F$DCB.NRECX
      3155**DCL      3155--REDEF
F$DCB.OHDR
      3147**DCL      3147--REDEF
F$DCB.ORG#
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:114  
      3130**DCL      3130--REDEF
F$DCB.PRECNO
      3153**DCL      3153--REDEF
F$DCB.RCSZ
      3159**DCL      3159--REDEF
F$DCB.RES#
      3126**DCL      3126--REDEF
F$DCB.SETX
      3138**DCL      3138--REDEF
F$DCB.TAB$
      3138**DCL      3138--REDEF
F$DCB.TDA
      3152**DCL      3153--REDEF
F$DCB.WIDTH#
      3122**DCL      3392>>ASSIGN
F$DCB.WSN#
      3126**DCL      3126--REDEF
FCG IN PROCEDURE BUILD_TEXT
      3511**DCL      3562<<DOINDEX  3563>>ASSIGN   3563>>ASSIGN   3568<<DOINDEX  3569>>IF       3571>>ASSIGN
      3572>>IF       3583<<DOINDEX  3584>>IF       3586>>ASSIGN   3589>>ASSIGN   3592>>DOINDEX
FCG_TBL.CODE
      2972**DCL      3593>>IF
FCG_TBL.TEXTC
      2973**DCL      3594<>CALL
FLAGVAL_TEXTC
      2851**DCL      2911--DCLINIT  3695>>ASSIGN
FM3_TBL
      3031**DCL      2940--DCLINIT
FR_MEMC
      2309**DCL      3648--ASSIGN
FR_MEMM
      2310**DCL      3646--ASSIGN   3649--ASSIGN
FR_TBL
      3085**DCL      2947--DCLINIT
I
      2846**DCL      3392<<ASSIGN   3393<<ASSIGN   3395>>ASSIGN   3410<<ASSIGN   3411<<ASSIGN   3412>>DOINDEX
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:115  
      3439<<ASSIGN   3440<<ASSIGN   3441>>DOINDEX
I IN PROCEDURE BUILD_TEXT
      3510**DCL      3526<<ASSIGN   3527<>CALL     3592<<DOINDEX  3593>>IF       3594>>CALL     3621<<DOINDEX
      3622>>IF       3623>>CALL     3724<<ASSIGN   3726>>DOWHILE  3726>>DOWHILE  3727<<ASSIGN   3727>>ASSIGN
      3730>>ASSIGN   3731>>ASSIGN   3731>>ASSIGN
ILOOP IN PROCEDURE BUILD_TEXT
      3592**LABEL    3595--EXIT
INDX IN PROCEDURE BUILD_TEXT
      3506**DCL      3502--PROC     3531>>IF       3533>>CALL     3536<<ASSIGN   3542>>ASSIGN   3651>>ASSIGN
      3656>>ASSIGN   3661>>ASSIGN   3674>>ASSIGN   3675>>ASSIGN
INSERT_TEXT IN PROCEDURE BUILD_TEXT
      3737**PROC     3523--CALL     3528--CALL     3532--CALL     3533--CALL     3534--CALL     3538--CALL
      3582--CALL     3620--CALL     3638--CALL     3734--CALL     3761--CALL     3764--CALL     3765--CALL
J
      2847**DCL      3404<<DOINDEX  3405>>DOCASE   3408>>IF       3409>>IF       3413<>CALL     3418>>DOINDEX
      3418>>DOINDEX  3420<>CALL     3428<>CALL     3429>>IF       3437>>IF       3438>>IF       3442<>CALL
      3447>>DOINDEX  3447>>DOINDEX  3449<>CALL     3457<>CALL     3462>>IF       3464<>CALL     3468>>DOINDEX
      3468>>DOINDEX  3470<>CALL     3475>>IF       3477<>CALL     3481>>DOINDEX  3481>>DOINDEX  3483<>CALL
JM$PT
      3180**DCL      3674--ASSIGN   3675--ASSIGN
JM$PT.CPTOT
      3195**DCL      3715>>ASSIGN
JM$PT.CUR
      3193**DCL      3712>>ASSIGN
JM$PT.FLG.LOCK
      3205**DCL      3693>>IF
JM$PT.MAX
      3191**DCL      3709>>ASSIGN
JM$PT.MAX1ACCT
      3208**DCL      3706>>ASSIGN
JM$PT.QUAN
      3189**DCL      3699>>ASSIGN
JM$PT.RMAX
      3214**DCL      3690>>ASSIGN
JM$PT.RMIN
      3217**DCL      3687>>ASSIGN
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:116  
JM$PT.TL
      3185**DCL      3679>>ASSIGN
JM$PT.TOT
      3198**DCL      3718>>ASSIGN
JM$PT.TU
      3187**DCL      3683>>ASSIGN
JM$PT.XPRIO
      3200**DCL      3703>>ASSIGN
JS_TBL
      2977**DCL      2934--DCLINIT
K
      2848**DCL      3412<<DOINDEX  3413<>CALL     3418<<DOINDEX  3420<>CALL     3427<<ASSIGN   3428<>CALL
      3441<<DOINDEX  3442<>CALL     3447<<DOINDEX  3449<>CALL     3456<<ASSIGN   3457<>CALL     3463<<DOINDEX
      3464<>CALL     3468<<DOINDEX  3470<>CALL     3476<<DOINDEX  3477<>CALL     3481<<DOINDEX  3483<>CALL
KI_TBL
      3091**DCL      2948--DCLINIT
LOGACCVAL_TEXTC
      2863**DCL      2915--DCLINIT
LOGEXVAL_TEXTC
      2867**DCL      2916--DCLINIT
LOGFILEVAL_TEXTC
      2860**DCL      2914--DCLINIT
LOGLISTVAL_TEXTC
      2905**DCL      2918--DCLINIT
M$LO
      3275**DCL      3391--ASSIGN
M$TIME
       463**DCL-ENT  3543--CALL
MAX_CLMN
      3302**DCL      3395<<ASSIGN   3397>>IF       3755>>IF       3775>>IF
MM_TBL
      2995**DCL      2937--DCLINIT
MONPART$
      3292**DCL      3675>>ASSIGN
MONPTR.ADDRESS
      3290**DCL      3541<<ASSIGN   3655<<ASSIGN   3656<<ASSIGN   3660<<ASSIGN   3661<<ASSIGN
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:117  
MONPTR.SEGID
      3291**DCL      3650<<ASSIGN   3725<<ASSIGN
MONPTR$
      3288**DCL      3289--REDEF    3542>>ASSIGN   3563>>ASSIGN   3646<<ASSIGN   3648<<ASSIGN   3649<<ASSIGN
      3651>>ASSIGN   3656>>ASSIGN   3657>>ASSIGN   3661>>ASSIGN   3662>>ASSIGN   3674<<ASSIGN   3675<<ASSIGN
      3679>>ASSIGN   3683>>ASSIGN   3687>>ASSIGN   3690>>ASSIGN   3693>>IF       3699>>ASSIGN   3703>>ASSIGN
      3706>>ASSIGN   3709>>ASSIGN   3712>>ASSIGN   3715>>ASSIGN   3718>>ASSIGN
MONSER_TBL.CNT
      2951**DCL      3592>>DOINDEX
MONSER_TBL.FCG$
      2934**DCL      3586>>ASSIGN
MONSER_TBL.VAL
      2933**DCL      3563<<ASSIGN   3569>>IF       3572>>IF       3589--ASSIGN
OC_TBL
      3064**DCL      2944--DCLINIT
P$TBL.FLAGS.INDX
      3225**DCL      3408>>IF       3437>>IF
P$TBL.FLAGS.INTINDX
      3231**DCL      3557>>IF
P$TBL.FLAGS.VALTEXT
      3229**DCL      3551>>IF       3665>>IF
P$TBL.FLAGS.VALTEXTLIST
      3230**DCL      3429>>IF       3556>>IF
P$TBL.MULT
      3248**DCL      3550>>ASSIGN   3680>>ASSIGN   3684>>ASSIGN   3700>>ASSIGN
P$TBL.PSUPTR$
      3242**DCL      3243--REDEF
P$TBL.PTR$
      3238**DCL      3239--REDEF    3533>>CALL
P$TBL.REPSUPTR$.ADDRESS
      3244**DCL      3660>>ASSIGN
P$TBL.REPTR$.ADDRESS
      3240**DCL      3541>>ASSIGN   3655>>ASSIGN
P$TBL.TEXT
      3235**DCL      3523<>CALL
P$TBL.TEXT.TEXT
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:118  
      3237**DCL      3609>>IF       3609>>IF
P$TBL.VALCODE
      3233**DCL      3552>>ASSIGN   3561>>IF       3608>>ASSIGN   3666>>ASSIGN
PART$
      3282**DCL      3464<>CALL     3470<>CALL     3672>>IF       3680>>ASSIGN   3684>>ASSIGN   3700>>ASSIGN
PCE$ERROR
      3267**DCL-ENT  3398--CALL
PCR$RESTEXT
      3269**DCL-ENT  3527--CALL
PCW$WRITE
      3268**DCL-ENT  3491--CALL     3495--CALL     3776--CALL     3787--CALL
PDT$
      3286**DCL      3674>>ASSIGN
PH_TBL
      3070**DCL      2946--DCLINIT
PLATEN_FPT.V
      3360**DCL      3354--DCLINIT
PLATEN_VLP
      3380**DCL      3358--DCLINIT
PRINT_BUF
      3304**DCL      3491<>CALL     3493<<ASSIGN   3495<>CALL     3776<>CALL     3778<<ASSIGN   3781<<CALLBLT
      3787<>CALL     3789<<ASSIGN
PRINT_ERR IN PROCEDURE PRINT_TEXT
      3795**LABEL    3776--CALLALT  3787--CALLALT
PRINT_PARAM IN PROCEDURE PRINT_TEXT
      3773**DCL      3771--PROC     3786>>IF
PRINT_TEXT
      3771**PROC     3414--CALL     3421--CALL     3431--CALL     3433--CALL     3443--CALL     3450--CALL
      3458--CALL     3465--CALL     3471--CALL     3478--CALL     3484--CALL     3757--CALL
PRIVVAL_TEXTC
      2872**DCL      2917--DCLINIT
PTR$ IN PROCEDURE BUILD_TEXT
      3504**DCL      3502--PROC     3523>>CALL     3533>>CALL     3540>>IF       3540>>IF       3541>>ASSIGN
      3544>>IF       3550>>ASSIGN   3551>>IF       3552>>ASSIGN   3556>>IF       3557>>IF       3561>>IF
      3608>>ASSIGN   3609>>IF       3609>>IF       3643>>IF       3665>>IF       3666>>ASSIGN   3672>>IF
RES$
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:119  
      3283**DCL      3437>>IF       3442<>CALL     3449<>CALL     3457<>CALL     3643>>IF       3655>>ASSIGN
      3660>>ASSIGN
RESTEXT_C
      3296**DCL      3527<>CALL     3528<>CALL
SKIP IN PROCEDURE BUILD_TEXT
      3594**LABEL    3585--GOTO     3588--GOTO
SOME_ON IN PROCEDURE BUILD_TEXT
      3518**DCL      3565<<ASSIGN   3571<<ASSIGN   3584>>IF
START IN PROCEDURE ADD_TO_LIST
      3750**DCL      3748--PROC     3758>>ASSIGN
START IN PROCEDURE BUILD_TEXT
      3508**DCL      3581<<ASSIGN   3594<>CALL     3619<<ASSIGN   3623<>CALL
STUFF_IT IN PROCEDURE BUILD_TEXT
      3734**LABEL    3553--GOTO     3629--GOTO     3635--GOTO     3667--GOTO     3696--GOTO
SYSTEM$
      3281**DCL      3408>>IF       3413<>CALL     3420<>CALL     3428<>CALL     3429>>IF       3540>>IF
      3544>>IF
TBL$ IN PROCEDURE BUILD_TEXT
      3509**DCL      3586<<ASSIGN   3587>>IF       3593>>IF       3594>>CALL     3608<<ASSIGN   3623>>CALL
TD_TBL
      3037**DCL      2941--DCLINIT
TEMP$
      2919**DCL      3391<<ASSIGN   3392>>IF       3392>>ASSIGN
TEMPTEXT
      2814**DCL      2815--REDEF    3639<<CALLBLT  3669<<CALLBLT  3721<<CALLBLT  3726--DOWHILE  3730--ASSIGN
      3731>>ASSIGN   3731--ASSIGN
TEMPTEXT_ARRAY
      2815**DCL      3726>>DOWHILE
TEXTC IN PROCEDURE ADD_TO_LIST
      3751**DCL      3748--PROC     3763>>ASSIGN
TEXTC.COUNT IN PROCEDURE ADD_TO_LIST
      3752**DCL      3755>>IF
TEXTC$INDX
      3250**DCL      3533<>CALL
TEXTC_ALL
      2842**DCL      3579>>ASSIGN   3615>>ASSIGN
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:120  
TEXTC_COMMA
      2833**DCL      3765<>CALL
TEXTC_CPAREN
      2827**DCL      3534<>CALL     3602>>ASSIGN   3626>>ASSIGN
TEXTC_EQUALS
      2830**DCL      3538<>CALL
TEXTC_MINUS
      2836**DCL      3638<>CALL
TEXTC_NONE
      2839**DCL      3577>>ASSIGN   3613>>ASSIGN
TEXTC_OPAREN
      2824**DCL      3532<>CALL     3582<>CALL     3620<>CALL
TEXTC_TBL
      2908**DCL      3552>>ASSIGN   3623<>CALL     3666>>ASSIGN
TEXT_BUF
      2818**DCL      3521<<ASSIGN   3743<<CALLBLT  3781>>CALLBLT
TEXT_C
      2820**DCL      3552<<ASSIGN   3577<<ASSIGN   3579<<ASSIGN   3602<<ASSIGN   3613<<ASSIGN   3615<<ASSIGN
      3626<<ASSIGN   3666<<ASSIGN   3695<<ASSIGN   3734<>CALL     3761<>CALL     3763<<ASSIGN   3764<>CALL
TEXT_C.COUNT
      2821**DCL      3633<<ASSIGN   3730<<ASSIGN   3758<<ASSIGN
TEXT_C.TEXT
      2822**DCL      3634<<ASSIGN   3731<<ASSIGN   3759<<ASSIGN
TEXT_C IN PROCEDURE INSERT_TEXT
      3739**DCL      3737--PROC
TEXT_C.COUNT IN PROCEDURE INSERT_TEXT
      3740**DCL      3743>>CALLBLT  3743>>CALLBLT  3745>>ASSIGN
TEXT_C.TEXT IN PROCEDURE INSERT_TEXT
      3741**DCL      3743>>CALLBLT
TEXT_INDEX
      2817**DCL      3430<<ASSIGN   3430>>ASSIGN   3520<<ASSIGN   3581>>ASSIGN   3601<<ASSIGN   3601>>ASSIGN
      3619>>ASSIGN   3625<<ASSIGN   3625>>ASSIGN   3743>>CALLBLT  3745<<ASSIGN   3745>>ASSIGN   3755>>IF
      3756<<ASSIGN   3756>>ASSIGN   3760<<ASSIGN   3775>>IF       3781>>CALLBLT  3781>>CALLBLT  3784>>ASSIGN
TEXT_TBL$
      2911**DCL      3552>>ASSIGN   3608>>ASSIGN   3666>>ASSIGN
TPSYS
PL6.E3A0      #001=PCP$PDISP File=PCP$PDISP.:E05TSI                              WED 07/30/97 04:21 Page:121  
      3300**DCL      3410>>IF       3439>>IF
UM_TBL
      2983**DCL      2936--DCLINIT
VAL$ IN PROCEDURE BUILD_TEXT
      3515**DCL      3589<<ASSIGN   3591>>IF
VALUE IN PROCEDURE BUILD_TEXT
      3513**DCL      3514--REDEF    3542<<ASSIGN   3549<<ASSIGN   3549>>ASSIGN   3550<<ASSIGN   3550>>ASSIGN
      3552>>ASSIGN   3612>>IF       3614>>IF       3634--ASSIGN   3637>>IF       3639>>CALLBLT  3651<<ASSIGN
      3657<<ASSIGN   3662<<ASSIGN   3666>>ASSIGN   3669>>CALLBLT  3679<<ASSIGN   3680<<ASSIGN   3680>>ASSIGN
      3683<<ASSIGN   3684<<ASSIGN   3684>>ASSIGN   3687<<ASSIGN   3690<<ASSIGN   3693<<ASSIGN   3694<<ASSIGN
      3695>>ASSIGN   3699<<ASSIGN   3700<<ASSIGN   3700>>ASSIGN   3703<<ASSIGN   3706<<ASSIGN   3709<<ASSIGN
      3712<<ASSIGN   3715<<ASSIGN   3718<<ASSIGN   3721>>CALLBLT
VALUE_BIT IN PROCEDURE BUILD_TEXT
      3514**DCL      3611<<ASSIGN   3611>>ASSIGN   3622>>IF
