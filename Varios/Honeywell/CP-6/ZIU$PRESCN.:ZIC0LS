
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:1    
        1        1        /*M* ZIU$PRESCN  IDSII  INPUT ROUTINE (BUILD ROLL RECS) FOR SORT IN ROLL */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        ZIU$PRESCN: PROC(ROLL_REC,RECSIZE) NOAUTO ALTRET;
        8        8
        9        9    1   DCL 1 ROLL_REC,
       10       10    1         2 START UBIN WORD,
       11       11    1         2 USER# UBIN BYTE UNAL;
       12       12    1   DCL RECSIZE UBIN WORD;
       13       13
       14       14    1   DCL CURR_TIME UBIN STATIC ALIGNED;
       15       15    1   DCL ROLL_CMPLT_TIME UBIN SYMREF ALIGNED;
       16       16
       17       17    1   DCL 1 M_JRNL SYMREF ALIGNED,
       18       18    1         2 N,
       19       19    1           3 L UBIN BYTE UNAL,
       20       20    1           3 C CHAR(7) UNAL,
       21       21    1         2 DCB# UBIN HALF UNAL;
       22       22
       23       23    1   DCL 1 JRNL_BUF SYMREF ALIGNED, /* Journal input buf */
       24       24    1         2 VAL CHAR(4096) UNAL;
       25       25    1   DCL BREAK_FLAG SBIN(36) SYMREF ALIGNED;
       26       26
       27       27    1   DCL USRIDX SBIN WORD STATIC INIT(0);
       28       28    1   DCL END_OF_JOURNAL BIT(1) UNAL STATIC INIT('0'B);
       29       29    1   DCL BAD_FILE BIT(1) UNAL SYMREF;
       30       30    1   DCL B$TCB$ PTR SYMREF;
       31       31
       32       32         %INCLUDE ZI$JRNL;
       33      140         %JRNL_REC;
       34      215         %INCLUDE ZI_DBU_ROLL;
       35      299         %ROLL_SUBS;
       36      318         %ROLL_LIST;
       37      377         %INCLUDE ZI_GLOBAL_DBUTIL;
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:2    
       38      555         %SYS_FUNC;
       39      647         %INCLUDE ZI$DIR;
       40      804         %DIR;
       41      948         %INCLUDE CP_6_SUBS;
       42     1488         %INCLUDE B_ERRORS_C;
       43     2615         %INCLUDE CP_6;
       44     2696         %B$TCB;
       45     2699         %B$EXCFR;
       46     2717
       47     2718    1   DCL SYS_FUNC_READ ENTRY ALTRET;
       48     2719    1   DCL STORE_FID ENTRY(1) ALTRET;
       49     2720    1   DCL FIND_FID ENTRY(1) ALTRET;
       50     2721    1   DCL OPEN_FID ENTRY ALTRET;
       51     2722    1   DCL ASSOC_DCB ENTRY(1) ALTRET;
       52     2723    1   DCL QUE_UP ENTRY(1);
       53     2724    1   DCL ZIU$CGTOPN ENTRY(2) ALTRET;
       54     2725
       55     2726
       56     2727        /*
       57     2728                    Prescan  procedure   input for sort.
       58     2729        */
       59     2730    1       RECSIZE=5; /*  SIZE OF RECORD INPUT RECORD */
       60     2731    1       IF ~END_OF_JOURNAL THEN
       61     2732    2       DO;
       62     2733    2           JRNL$ = ADDR(JRNL_BUF);
       63     2734    2           CALL READ_JRNL ALTRET(END_OF_JRNL);
       64     2735    3           DO WHILE(CURR_TIME < ROLL_CMPLT_TIME AND ~END_OF_JOURNAL);
       65     2736
       66     2737    3               IF BREAK_FLAG > 0 THEN
       67     2738    3                   UNWIND TO BRK_ROLL; /* Check for break condition */
       68     2739
       69     2740
       70     2741    4               DO CASE(JREC.TYPE);
       71     2742    4               CASE(T#FID);
       72     2743    4                   CALL FIND_FID(FIDX);
       73     2744    4                   IF FIDX = -1 THEN /* FID not previously entered */
       74     2745    5                   DO;
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:3    
       75     2746    5                       CALL STORE_FID(FIDX)
       76     2747    5                          ALTRET(ALTRTN);
       77     2748    5                       CALL ASSOC_DCB(FIDX) ALTRET(ALTRTN);
       78     2749    5                       CALL QUE_UP(FIDX);
       79     2750    5                       IF FILE.COMGROUP THEN
       80     2751    5                           CALL ZIU$CGTOPN(,FIDLIST.DCB#(FIDX)) ALTRET(NO_OPEN);
       81     2752    6                       ELSE DO; /* not CG */
       82     2753    6                           TESTSF = %YES#;
       83     2754    6                           CALL OPEN_FID ALTRET(NO_OPEN);
       84     2755    6                           IF FILE.KEYED = %YES# THEN
       85     2756    7                           DO;
       86     2757    7                               CALL INSERT(FILE.ID.NAME#.C,FILE.ID.NAME#.L,1,':');
       87     2758    7                               FILE.ID.NAME#.L = FILE.ID.NAME#.L + 1;
       88     2759    7                               CALL STORE_FID(FIDX);
       89     2760         /*  Note that the FIDX returned should be 1 greater
       90     2761            than the previous one just stored. */
       91     2762    7                               CALL ASSOC_DCB(FIDX) ALTRET(ALTRTN);
       92     2763    7                               CALL QUE_UP(FIDX);
       93     2764    7                               TESTSF = %YES#;
       94     2765    7                               CALL OPEN_FID ALTRET(NO_OPEN);
       95     2766    7                               END;
       96     2767    6                           END;
       97     2768    5                       END;
       98     2769    5                   DO NEVER;
       99     2770    5   NO_OPEN:            BAD_FILE = %YES#;
      100     2771    5                       END;
      101     2772
      102     2773    4               CASE(T#BGN);
      103     2774    4                   IF USER.SYSID(BERC.USER#) ~= 0 THEN
      104     2775    5                   DO; /* New begin user before old one finished */
      105     2776    5                       ROLL_REC.START = USER.RLBK_START(BERC.USER#);
      106     2777    5                       ROLL_REC.USER# = BERC.USER#;
      107     2778    5                       USER.SYSID(BERC.USER#) = BERC.SYSID;
      108     2779    5                       USER.RLBK_START(BERC.USER#) = BERC.TIME;
      109     2780    5                       RETURN;
      110     2781    5                       END;
      111     2782    4                   USER.SYSID(BERC.USER#) = BERC.SYSID;
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:4    
      112     2783    4                   USER.RLBK_START(BERC.USER#) = BERC.TIME;
      113     2784    4               CASE(T#CKPT);
      114     2785    4                   USER.RLBK_START(CKPT.USER#) = CKPT.TIME;
      115     2786    4               CASE(T#ROL);
      116     2787    4                   ROLL_REC.START = USER.RLBK_START(BERC.USER#);
      117     2788    4                   ROLL_REC.USER# = BERC.USER#;
      118     2789    4                   USER.RLBK_START(BERC.USER#) = BERC.TIME;
      119     2790    4                   RETURN; /* Return to sort with built input rec */
      120     2791    4               CASE(T#END);
      121     2792    4                   USER.SYSID(BERC.USER#) = 0;
      122     2793    4               CASE(ELSE);
      123     2794         /*   NO  ACTION */
      124     2795    4                   END;
      125     2796
      126     2797    3               CALL READ_JRNL ALTRET(END_OF_JRNL);
      127     2798
      128     2799    4               DO NEVER;
      129     2800    4   END_OF_JRNL:
      130     2801    4                   IF ERRCODESF.ERR# = %E$EOF THEN
      131     2802    4                       END_OF_JOURNAL = %YES#;
      132     2803    4                   ELSE
      133     2804    4                       ALTRETURN;
      134     2805    4                   END;
      135     2806    3               END;
      136     2807    2           END;
      137     2808    1       ELSE
      138     2809    1           END_OF_JOURNAL = %YES#;
      139     2810    2       DO WHILE(USRIDX < NO.USERS);
      140     2811    2           IF USER.SYSID(USRIDX) > 0 THEN
      141     2812    3           DO;
      142     2813    3               ROLL_REC.START = USER.RLBK_START(USRIDX) ;
      143     2814    3               ROLL_REC.USER# = USRIDX;
      144     2815    3               USRIDX = USRIDX + 1; /* Must increment before return */
      145     2816    3               RETURN;
      146     2817    3               END;
      147     2818    2           USRIDX = USRIDX + 1;
      148     2819    2           END;
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:5    
      149     2820    1   ALTRTN:
      150     2821    1       END_OF_JOURNAL = %NO#; /* RESET FLAG */
      151     2822    1       ALTRETURN; /* Indicate end of input to sort */
      152     2823
      153     2824        %EJECT;
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:6    
      154     2825        /*
      155     2826                          READ JOURNAL PROCEDURE
      156     2827        */
      157     2828    1   READ_JRNL: PROC ALTRET;
      158     2829
      159     2830    2       JRNL_BUF = '0'B;
      160     2831
      161     2832    2   /**/ DCBSF = M_JRNL.DCB#;
      162     2833    2   /**/ BUFSF = VECTOR(JRNL_BUF);
      163     2834    2   /**/ BUFLNSF = 4096;
      164     2835    2   /**/ FULLSF = '0'B;
      165     2836    2   /**/ FSA_FLAG = %YES#; /*  fast seq access */
      166     2837    2   /**/ ENCRP_SEEDSF = ZI$DIR.ENCP_SEED;
      167     2838    2       CALL SYS_FUNC_READ ALTRET(EOF);
      168     2839    2       IF JREC.TYPE ~= T#FID THEN
      169     2840    2           CURR_TIME = JREC.TIME;
      170     2841    2       RETURN;
      171     2842    2   EOF:
      172     2843    2       ALTRETURN;
      173     2844    2   END READ_JRNL;
      174     2845    1   END ZIU$PRESCN;

PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:7    
--  Include file information  --

   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   ZI$DIR.:ZIC0TOU  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   ZI_DBU_ROLL.:ZIC0TOU  is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$PRESCN.

   Procedure ZIU$PRESCN requires 262 words for executable code.
   Procedure ZIU$PRESCN is declared NOAUTO and requires 10 words of local(STATIC) storage.

    No errors detected in file ZIU$PRESCN.:ZIC0TSI    .

PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:8    

 Object Unit name= ZIU$PRESCN                                 File name= ZIU$PRESCN.:ZIC0TOU
 UTS= SEP 05 '97 13:19:46.12 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    10     12  ZIU$PRESCN
    1   DCB   even  none     0      0  M$UC
    2   Proc  even  none   262    406  ZIU$PRESCN
    3  RoData even  none    10     12  ZIU$PRESCN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        2  ZIU$PRESCN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 FIND_FID
         yes           Std       1 QUE_UP
 yes     yes           Std       2 ZIU$CGTOPN
 yes     yes           Std       1 STORE_FID
 yes     yes           Std       0 OPEN_FID
 yes     yes           Std       1 ASSOC_DCB
 yes     yes           Std       0 SYS_FUNC_READ
                       nStd      0 X66_STATIC_2
                       nStd      0 X66_SUNWIND
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:9    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROLL_CMPLT_TIME                       M_JRNL                                JRNL_BUF
     BREAK_FLAG                            BAD_FILE                              B$TCB$
     JRNL$                                 FID$                                  DCBLIST$
     USER$                                 FID_INDXS$                            FID_INDXS
     NXT_AVIL_FIDSLOT                      NXT_AVIL_DCBSLOT                      LAST_UNUSED_DCBSLOT
     USER                                  NO                                    FIRST
     LAST                                  MAX_DCBINDX                           MAX_FIDINDX
     FIDX                                  DCBX                                  BRK_ROLL
     BLKLSF                                KEYLSF                                KEYXSF
     DCBSF                                 ORGSF                                 KEYSF
     KEYVSF                                ACSSF                                 NOTIMESF
     FUNSF                                 ASNSF                                 TESTSF
     XTENSIZESF                            DISPSF                                WAITSF
     VFCSF                                 FULLSF                                BKUPSF
     BUFLNSF                               BUFSF                                 SOURCESF
     DESTSF                                DATESF                                TIMESF
     UTSSF                                 DAYSF                                 TSTAMPSF
     ENCRP_SEEDSF                          ERRCODESF                             MSGCODE
     INCL_ERR                              ERR_INSERT                            FIDSF_RD
     ACNT                                  EXISTSF                               SHARESF
     DCBNMSF                               KEYRSF                                NO_KEYSF
     REASGNSF                              CARRY_ATTRIBUTESF                     SUBMESSF
     SPKY_OPNSF                            POSSF                                 ERRFLGSF
     MERGESF                               FSA_FLAG                              RELGSF
     UNUSED                                HELPCODE                              COUNTSF
     INDEXSF                               GAP                                   PSNSF
     ACNTSF                                KEY_SHADWSF                           ZI$DIR
     SCHEMA_ACTIVE                         RECORD_LIST                           SET_LIST
     RETAIN_LIST                           DUMP_FID                              ALTKY
     INIT_RG                               KEY_RNG                               ITEM_LIST
     M$UC
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:10   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:11   


        1        1        /*M* ZIU$PRESCN  IDSII  INPUT ROUTINE (BUILD ROLL RECS) FOR SORT IN ROLL */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        ZIU$PRESCN: PROC(ROLL_REC,RECSIZE) NOAUTO ALTRET;

      7  2 000000   000000 700200 xent  ZIU$PRESCN   TSX0  ! X66_STATIC_2
         2 000001   000000 000002 0                  ZERO    0,2

        8        8
        9        9    1   DCL 1 ROLL_REC,
       10       10    1         2 START UBIN WORD,
       11       11    1         2 USER# UBIN BYTE UNAL;
       12       12    1   DCL RECSIZE UBIN WORD;
       13       13
       14       14    1   DCL CURR_TIME UBIN STATIC ALIGNED;
       15       15    1   DCL ROLL_CMPLT_TIME UBIN SYMREF ALIGNED;
       16       16
       17       17    1   DCL 1 M_JRNL SYMREF ALIGNED,
       18       18    1         2 N,
       19       19    1           3 L UBIN BYTE UNAL,
       20       20    1           3 C CHAR(7) UNAL,
       21       21    1         2 DCB# UBIN HALF UNAL;
       22       22
       23       23    1   DCL 1 JRNL_BUF SYMREF ALIGNED, /* Journal input buf */
       24       24    1         2 VAL CHAR(4096) UNAL;
       25       25    1   DCL BREAK_FLAG SBIN(36) SYMREF ALIGNED;
       26       26
       27       27    1   DCL USRIDX SBIN WORD STATIC INIT(0);
       28       28    1   DCL END_OF_JOURNAL BIT(1) UNAL STATIC INIT('0'B);
       29       29    1   DCL BAD_FILE BIT(1) UNAL SYMREF;
       30       30    1   DCL B$TCB$ PTR SYMREF;
       31       31
       32       32         %INCLUDE ZI$JRNL;
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:12   
       33      140         %JRNL_REC;
       34      215         %INCLUDE ZI_DBU_ROLL;
       35      299         %ROLL_SUBS;
       36      318         %ROLL_LIST;
       37      377         %INCLUDE ZI_GLOBAL_DBUTIL;
       38      555         %SYS_FUNC;
       39      647         %INCLUDE ZI$DIR;
       40      804         %DIR;
       41      948         %INCLUDE CP_6_SUBS;
       42     1488         %INCLUDE B_ERRORS_C;
       43     2615         %INCLUDE CP_6;
       44     2696         %B$TCB;
       45     2699         %B$EXCFR;
       46     2717
       47     2718    1   DCL SYS_FUNC_READ ENTRY ALTRET;
       48     2719    1   DCL STORE_FID ENTRY(1) ALTRET;
       49     2720    1   DCL FIND_FID ENTRY(1) ALTRET;
       50     2721    1   DCL OPEN_FID ENTRY ALTRET;
       51     2722    1   DCL ASSOC_DCB ENTRY(1) ALTRET;
       52     2723    1   DCL QUE_UP ENTRY(1);
       53     2724    1   DCL ZIU$CGTOPN ENTRY(2) ALTRET;
       54     2725
       55     2726
       56     2727        /*
       57     2728                    Prescan  procedure   input for sort.
       58     2729        */
       59     2730    1       RECSIZE=5; /*  SIZE OF RECORD INPUT RECORD */

   2730  2 000002   000005 235007                    LDA     5,DL
         2 000003   000002 470400 0                  LDP0    @RECSIZE
         2 000004   000000 755100                    STA     0,,PR0

       60     2731    1       IF ~END_OF_JOURNAL THEN

   2731  2 000005   000005 236000 0                  LDQ     END_OF_JOURNAL
         2 000006   400000 376003                    ANQ     -131072,DU
         2 000007   400000 676003                    ERQ     -131072,DU
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:13   
         2 000010   000316 600000 2                  TZE     s:2809

       61     2732    2       DO;

       62     2733    2           JRNL$ = ADDR(JRNL_BUF);

   2733  2 000011   000000 236000 3                  LDQ     0
         2 000012   000000 756000 xsym               STQ     JRNL$

       63     2734    2           CALL READ_JRNL ALTRET(END_OF_JRNL);

   2734  2 000013   000347 701000 2                  TSX1    READ_JRNL
         2 000014   000275 702000 2                  TSX2    END_OF_JRNL

       64     2735    3           DO WHILE(CURR_TIME < ROLL_CMPLT_TIME AND ~END_OF_JOURNAL);

   2735  2 000015   000306 710000 2                  TRA     s:2806

       65     2736
       66     2737    3               IF BREAK_FLAG > 0 THEN

   2737  2 000016   000000 235000 xsym               LDA     BREAK_FLAG
         2 000017   000026 604400 2                  TMOZ    s:2741

       67     2738    3                   UNWIND TO BRK_ROLL; /* Check for break condition */

   2738  2 000020   000000 100600                    MLR   ! fill='000'O
         2 000021   000000 000010 xsym               ADSC9   BRK_ROLL                 cn=0,n=8
         2 000022   000010 000010 0                  ADSC9   END_OF_JOURNAL+3         cn=0,n=8
         2 000023   000010 237200 0                  LDAQ  ! END_OF_JOURNAL+3
         2 000024   000000 700200 xent               TSX0  ! X66_SUNWIND
         2 000025   000000 000200                    ZERO    0,128

       68     2739
       69     2740
       70     2741    4               DO CASE(JREC.TYPE);

PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:14   
   2741  2 000026   000000 470400 xsym               LDP0    JRNL$
         2 000027   000001 236100                    LDQ     1,,PR0
         2 000030   000033 772000                    QRL     27
         2 000031   000015 116007                    CMPQ    13,DL
         2 000032   000034 602006 2                  TNC     s:2741+6,QL
         2 000033   000272 710000 2                  TRA     s:2797
         2 000034   000272 710000 2                  TRA     s:2797
         2 000035   000161 710000 2                  TRA     s:2774
         2 000036   000263 710000 2                  TRA     s:2792
         2 000037   000051 710000 2                  TRA     s:2743
         2 000040   000272 710000 2                  TRA     s:2797
         2 000041   000272 710000 2                  TRA     s:2797
         2 000042   000272 710000 2                  TRA     s:2797
         2 000043   000272 710000 2                  TRA     s:2797
         2 000044   000272 710000 2                  TRA     s:2797
         2 000045   000272 710000 2                  TRA     s:2797
         2 000046   000272 710000 2                  TRA     s:2797
         2 000047   000236 710000 2                  TRA     s:2787
         2 000050   000227 710000 2                  TRA     s:2785

       71     2742    4               CASE(T#FID);

       72     2743    4                   CALL FIND_FID(FIDX);

   2743  2 000051   000002 630400 3                  EPPR0   2
         2 000052   000001 631400 3                  EPPR1   1
         2 000053   000000 701000 xent               TSX1    FIND_FID
         2 000054   000000 011000                    NOP     0

       73     2744    4                   IF FIDX = -1 THEN /* FID not previously entered */

   2744  2 000055   000000 235000 xsym               LDA     FIDX
         2 000056   000003 115000 3                  CMPA    3
         2 000057   000155 601000 2                  TNZ     s:2769

       74     2745    5                   DO;

PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:15   
       75     2746    5                       CALL STORE_FID(FIDX)

   2746  2 000060   000002 630400 3                  EPPR0   2
         2 000061   000001 631400 3                  EPPR1   1
         2 000062   000000 701000 xent               TSX1    STORE_FID
         2 000063   000344 702000 2                  TSX2    ALTRTN

       76     2747    5                          ALTRET(ALTRTN);
       77     2748    5                       CALL ASSOC_DCB(FIDX) ALTRET(ALTRTN);

   2748  2 000064   000002 630400 3                  EPPR0   2
         2 000065   000001 631400 3                  EPPR1   1
         2 000066   000000 701000 xent               TSX1    ASSOC_DCB
         2 000067   000344 702000 2                  TSX2    ALTRTN

       78     2749    5                       CALL QUE_UP(FIDX);

   2749  2 000070   000002 630400 3                  EPPR0   2
         2 000071   000001 631400 3                  EPPR1   1
         2 000072   000000 701000 xent               TSX1    QUE_UP
         2 000073   000000 011000                    NOP     0

       79     2750    5                       IF FILE.COMGROUP THEN

   2750  2 000074   000000 470400 xsym               LDP0    JRNL$
         2 000075   000003 236100                    LDQ     3,,PR0
         2 000076   020000 316003                    CANQ    8192,DU
         2 000077   000113 600000 2                  TZE     s:2753

       80     2751    5                           CALL ZIU$CGTOPN(,FIDLIST.DCB#(FIDX)) ALTRET(NO_OPEN);

   2751  2 000100   000000 236000 xsym               LDQ     FIDX
         2 000101   000021 402003                    MPY     17,DU
         2 000102   000017 036003                    ADLQ    15,DU
         2 000103   000000 036000 xsym               ADLQ    FID$
         2 000104   000005 235000 3                  LDA     5
         2 000105   000010 757000 0                  STAQ    END_OF_JOURNAL+3
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:16   
         2 000106   000010 630400 0                  EPPR0   END_OF_JOURNAL+3
         2 000107   000004 631400 3                  EPPR1   4
         2 000110   000000 701000 xent               TSX1    ZIU$CGTOPN
         2 000111   000156 702000 2                  TSX2    NO_OPEN
         2 000112   000155 710000 2                  TRA     s:2769

       81     2752    6                       ELSE DO; /* not CG */

       82     2753    6                           TESTSF = %YES#;

   2753  2 000113   400000 236003                    LDQ     -131072,DU
         2 000114   000000 756000 xsym               STQ     TESTSF

       83     2754    6                           CALL OPEN_FID ALTRET(NO_OPEN);

   2754  2 000115   000006 631400 3                  EPPR1   6
         2 000116   000000 701000 xent               TSX1    OPEN_FID
         2 000117   000156 702000 2                  TSX2    NO_OPEN

       84     2755    6                           IF FILE.KEYED = %YES# THEN

   2755  2 000120   000000 470400 xsym               LDP0    JRNL$
         2 000121   000003 234100                    SZN     3,,PR0
         2 000122   000155 605000 2                  TPL     s:2769

       85     2756    7                           DO;

       86     2757    7                               CALL INSERT(FILE.ID.NAME#.C,FILE.ID.NAME#.L,1,':');

   2757  2 000123   000010 236100                    LDQ     8,,PR0
         2 000124   000777 376007                    ANQ     511,DL
         2 000125   040106 100400                    MLR     fill='040'O
         2 000126   000007 000001 3                  ADSC9   7                        cn=0,n=1
         2 000127   000011 000001                    ADSC9   9,Q,PR0                  cn=0,n=1

       87     2758    7                               FILE.ID.NAME#.L = FILE.ID.NAME#.L + 1;

PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:17   
   2758  2 000130   000000 470400 xsym               LDP0    JRNL$
         2 000131   000010 236100                    LDQ     8,,PR0
         2 000132   000001 036007                    ADLQ    1,DL
         2 000133   000010 552104                    STBQ    8,'04'O,PR0

       88     2759    7                               CALL STORE_FID(FIDX);

   2759  2 000134   000002 630400 3                  EPPR0   2
         2 000135   000001 631400 3                  EPPR1   1
         2 000136   000000 701000 xent               TSX1    STORE_FID
         2 000137   000000 011000                    NOP     0

       89     2760         /*  Note that the FIDX returned should be 1 greater
       90     2761            than the previous one just stored. */
       91     2762    7                               CALL ASSOC_DCB(FIDX) ALTRET(ALTRTN);

   2762  2 000140   000002 630400 3                  EPPR0   2
         2 000141   000001 631400 3                  EPPR1   1
         2 000142   000000 701000 xent               TSX1    ASSOC_DCB
         2 000143   000344 702000 2                  TSX2    ALTRTN

       92     2763    7                               CALL QUE_UP(FIDX);

   2763  2 000144   000002 630400 3                  EPPR0   2
         2 000145   000001 631400 3                  EPPR1   1
         2 000146   000000 701000 xent               TSX1    QUE_UP
         2 000147   000000 011000                    NOP     0

       93     2764    7                               TESTSF = %YES#;

   2764  2 000150   400000 236003                    LDQ     -131072,DU
         2 000151   000000 756000 xsym               STQ     TESTSF

       94     2765    7                               CALL OPEN_FID ALTRET(NO_OPEN);

   2765  2 000152   000006 631400 3                  EPPR1   6
         2 000153   000000 701000 xent               TSX1    OPEN_FID
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:18   
         2 000154   000156 702000 2                  TSX2    NO_OPEN

       95     2766    7                               END;

       96     2767    6                           END;

       97     2768    5                       END;

       98     2769    5                   DO NEVER;

   2769  2 000155   000272 710000 2                  TRA     s:2797

       99     2770    5   NO_OPEN:            BAD_FILE = %YES#;

   2770  2 000156   400000 236003       NO_OPEN      LDQ     -131072,DU
         2 000157   000000 756000 xsym               STQ     BAD_FILE

      100     2771    5                       END;

   2771  2 000160   000272 710000 2                  TRA     s:2797

      101     2772
      102     2773    4               CASE(T#BGN);

      103     2774    4                   IF USER.SYSID(BERC.USER#) ~= 0 THEN

   2774  2 000161   000001 236100                    LDQ     1,,PR0
         2 000162   000022 772000                    QRL     18
         2 000163   000777 376007                    ANQ     511,DL
         2 000164   000005 402007                    MPY     5,DL
         2 000165   000000 220006 xsym               LDX0    USER,QL
         2 000166   000216 600000 2                  TZE     s:2782

      104     2775    5                   DO; /* New begin user before old one finished */

      105     2776    5                       ROLL_REC.START = USER.RLBK_START(BERC.USER#);

PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:19   
   2776  2 000167   000001 471400 0                  LDP1    @ROLL_REC
         2 000170   000001 235006 xsym               LDA     USER+1,QL
         2 000171   100000 755100                    STA     0,,PR1

      106     2777    5                       ROLL_REC.USER# = BERC.USER#;

   2777  2 000172   000000 470400 xsym               LDP0    JRNL$
         2 000173   000001 236100                    LDQ     1,,PR0
         2 000174   000022 772000                    QRL     18
         2 000175   000777 376007                    ANQ     511,DL
         2 000176   000033 736000                    QLS     27
         2 000177   100001 756100                    STQ     1,,PR1

      107     2778    5                       USER.SYSID(BERC.USER#) = BERC.SYSID;

   2778  2 000200   000001 236100                    LDQ     1,,PR0
         2 000201   000022 772000                    QRL     18
         2 000202   000777 376007                    ANQ     511,DL
         2 000203   000005 402007                    MPY     5,DL
         2 000204   000001 720100                    LXL0    1,,PR0
         2 000205   000000 740006 xsym               STX0    USER,QL

      108     2779    5                       USER.RLBK_START(BERC.USER#) = BERC.TIME;

   2779  2 000206   000001 236100                    LDQ     1,,PR0
         2 000207   000022 772000                    QRL     18
         2 000210   000777 376007                    ANQ     511,DL
         2 000211   000005 402007                    MPY     5,DL
         2 000212   000000 235100                    LDA     0,,PR0
         2 000213   000001 755006 xsym               STA     USER+1,QL

      109     2780    5                       RETURN;

   2780  2 000214   000000 221200 0                  LDX1  ! 0
         2 000215   000001 702211                    TSX2  ! 1,X1

      110     2781    5                       END;
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:20   
      111     2782    4                   USER.SYSID(BERC.USER#) = BERC.SYSID;

   2782  2 000216   000001 721100                    LXL1    1,,PR0
         2 000217   000000 741006 xsym               STX1    USER,QL

      112     2783    4                   USER.RLBK_START(BERC.USER#) = BERC.TIME;

   2783  2 000220   000001 236100                    LDQ     1,,PR0
         2 000221   000022 772000                    QRL     18
         2 000222   000777 376007                    ANQ     511,DL
         2 000223   000005 402007                    MPY     5,DL
         2 000224   000000 235100                    LDA     0,,PR0
         2 000225   000001 755006 xsym               STA     USER+1,QL
         2 000226   000272 710000 2                  TRA     s:2797

      113     2784    4               CASE(T#CKPT);

      114     2785    4                   USER.RLBK_START(CKPT.USER#) = CKPT.TIME;

   2785  2 000227   000001 236100                    LDQ     1,,PR0
         2 000230   000022 772000                    QRL     18
         2 000231   000777 376007                    ANQ     511,DL
         2 000232   000005 402007                    MPY     5,DL
         2 000233   000000 235100                    LDA     0,,PR0
         2 000234   000001 755006 xsym               STA     USER+1,QL
         2 000235   000272 710000 2                  TRA     s:2797

      115     2786    4               CASE(T#ROL);

      116     2787    4                   ROLL_REC.START = USER.RLBK_START(BERC.USER#);

   2787  2 000236   000001 236100                    LDQ     1,,PR0
         2 000237   000022 772000                    QRL     18
         2 000240   000777 376007                    ANQ     511,DL
         2 000241   000005 402007                    MPY     5,DL
         2 000242   000001 471400 0                  LDP1    @ROLL_REC
         2 000243   000001 235006 xsym               LDA     USER+1,QL
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:21   
         2 000244   100000 755100                    STA     0,,PR1

      117     2788    4                   ROLL_REC.USER# = BERC.USER#;

   2788  2 000245   000000 470400 xsym               LDP0    JRNL$
         2 000246   000001 236100                    LDQ     1,,PR0
         2 000247   000022 772000                    QRL     18
         2 000250   000777 376007                    ANQ     511,DL
         2 000251   000033 736000                    QLS     27
         2 000252   100001 756100                    STQ     1,,PR1

      118     2789    4                   USER.RLBK_START(BERC.USER#) = BERC.TIME;

   2789  2 000253   000001 236100                    LDQ     1,,PR0
         2 000254   000022 772000                    QRL     18
         2 000255   000777 376007                    ANQ     511,DL
         2 000256   000005 402007                    MPY     5,DL
         2 000257   000000 235100                    LDA     0,,PR0
         2 000260   000001 755006 xsym               STA     USER+1,QL

      119     2790    4                   RETURN; /* Return to sort with built input rec */

   2790  2 000261   000000 221200 0                  LDX1  ! 0
         2 000262   000001 702211                    TSX2  ! 1,X1

      120     2791    4               CASE(T#END);

      121     2792    4                   USER.SYSID(BERC.USER#) = 0;

   2792  2 000263   000001 236100                    LDQ     1,,PR0
         2 000264   000022 772000                    QRL     18
         2 000265   000777 376007                    ANQ     511,DL
         2 000266   000005 402007                    MPY     5,DL
         2 000267   000000 220003                    LDX0    0,DU
         2 000270   000000 740006 xsym               STX0    USER,QL
         2 000271   000272 710000 2                  TRA     s:2797

PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:22   
      122     2793    4               CASE(ELSE);

      123     2794         /*   NO  ACTION */
      124     2795    4                   END;

      125     2796
      126     2797    3               CALL READ_JRNL ALTRET(END_OF_JRNL);

   2797  2 000272   000347 701000 2                  TSX1    READ_JRNL
         2 000273   000275 702000 2                  TSX2    END_OF_JRNL

      127     2798
      128     2799    4               DO NEVER;

   2799  2 000274   000306 710000 2                  TRA     s:2806

      129     2800    4   END_OF_JRNL:
      130     2801    4                   IF ERRCODESF.ERR# = %E$EOF THEN

   2801  2 000275   000000 236000 xsym  END_OF_JRNL  LDQ     ERRCODESF
         2 000276   377770 376007                    ANQ     131064,DL
         2 000277   000060 116007                    CMPQ    48,DL
         2 000300   000304 601000 2                  TNZ     s:2804

      131     2802    4                       END_OF_JOURNAL = %YES#;

   2802  2 000301   400000 236003                    LDQ     -131072,DU
         2 000302   000005 756000 0                  STQ     END_OF_JOURNAL
         2 000303   000306 710000 2                  TRA     s:2806

      132     2803    4                   ELSE
      133     2804    4                       ALTRETURN;

   2804  2 000304   000000 221200 0                  LDX1  ! 0
         2 000305   000000 702211                    TSX2  ! 0,X1

      134     2805    4                   END;
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:23   

      135     2806    3               END;

   2806  2 000306   000003 236000 0                  LDQ     CURR_TIME
         2 000307   000000 116000 xsym               CMPQ    ROLL_CMPLT_TIME
         2 000310   000315 603000 2                  TRC     s:2807
         2 000311   000005 236000 0                  LDQ     END_OF_JOURNAL
         2 000312   400000 376003                    ANQ     -131072,DU
         2 000313   400000 676003                    ERQ     -131072,DU
         2 000314   000016 601000 2                  TNZ     s:2737

      136     2807    2           END;

   2807  2 000315   000320 710000 2                  TRA     s:2810

      137     2808    1       ELSE
      138     2809    1           END_OF_JOURNAL = %YES#;

   2809  2 000316   400000 236003                    LDQ     -131072,DU
         2 000317   000005 756000 0                  STQ     END_OF_JOURNAL

      139     2810    2       DO WHILE(USRIDX < NO.USERS);

   2810  2 000320   000004 236000 0                  LDQ     USRIDX
         2 000321   000000 116000 xsym               CMPQ    NO
         2 000322   000344 605000 2                  TPL     ALTRTN

      140     2811    2           IF USER.SYSID(USRIDX) > 0 THEN

   2811  2 000323   000004 236000 0                  LDQ     USRIDX
         2 000324   000005 402007                    MPY     5,DL
         2 000325   000000 220006 xsym               LDX0    USER,QL
         2 000326   000340 600000 2                  TZE     s:2818

      141     2812    3           DO;

      142     2813    3               ROLL_REC.START = USER.RLBK_START(USRIDX) ;
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:24   

   2813  2 000327   000001 470400 0                  LDP0    @ROLL_REC
         2 000330   000001 235006 xsym               LDA     USER+1,QL
         2 000331   000000 755100                    STA     0,,PR0

      143     2814    3               ROLL_REC.USER# = USRIDX;

   2814  2 000332   000004 235000 0                  LDA     USRIDX
         2 000333   000033 735000                    ALS     27
         2 000334   000001 755100                    STA     1,,PR0

      144     2815    3               USRIDX = USRIDX + 1; /* Must increment before return */

   2815  2 000335   000004 054000 0                  AOS     USRIDX

      145     2816    3               RETURN;

   2816  2 000336   000000 221200 0                  LDX1  ! 0
         2 000337   000001 702211                    TSX2  ! 1,X1

      146     2817    3               END;
      147     2818    2           USRIDX = USRIDX + 1;

   2818  2 000340   000004 054000 0                  AOS     USRIDX

      148     2819    2           END;

   2819  2 000341   000004 236000 0                  LDQ     USRIDX
         2 000342   000000 116000 xsym               CMPQ    NO
         2 000343   000323 604000 2                  TMI     s:2811

      149     2820    1   ALTRTN:
      150     2821    1       END_OF_JOURNAL = %NO#; /* RESET FLAG */

   2821  2 000344   000005 450000 0     ALTRTN       STZ     END_OF_JOURNAL

      151     2822    1       ALTRETURN; /* Indicate end of input to sort */
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:25   

   2822  2 000345   000000 221200 0                  LDX1  ! 0
         2 000346   000000 702211                    TSX2  ! 0,X1

      152     2823
      153     2824        %EJECT;
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:26   
      154     2825        /*
      155     2826                          READ JOURNAL PROCEDURE
      156     2827        */
      157     2828    1   READ_JRNL: PROC ALTRET;

   2828  2 000347   000006 741200 0     READ_JRNL    STX1  ! END_OF_JOURNAL+1

      158     2829
      159     2830    2       JRNL_BUF = '0'B;

   2830  2 000350   010000 220003                    LDX0    4096,DU
         2 000351   000040 100400                    MLR     fill='000'O
         2 000352   000006 000001 3                  ADSC9   6                        cn=0,n=1
         2 000353   000000 000010 xsym               ADSC9   JRNL_BUF                 cn=0,n=*X0

      160     2831
      161     2832    2   /**/ DCBSF = M_JRNL.DCB#;

   2832  2 000354   000002 222000 xsym               LDX2    M_JRNL+2
         2 000355   000000 742000 xsym               STX2    DCBSF

      162     2833    2   /**/ BUFSF = VECTOR(JRNL_BUF);

   2833  2 000356   000010 237000 3                  LDAQ    8
         2 000357   000000 755000 xsym               STA     BUFSF
         2 000360   000001 756000 xsym               STQ     BUFSF+1

      163     2834    2   /**/ BUFLNSF = 4096;

   2834  2 000361   010000 235007                    LDA     4096,DL
         2 000362   000000 755000 xsym               STA     BUFLNSF

      164     2835    2   /**/ FULLSF = '0'B;

   2835  2 000363   000000 450000 xsym               STZ     FULLSF

      165     2836    2   /**/ FSA_FLAG = %YES#; /*  fast seq access */
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:27   

   2836  2 000364   400000 236003                    LDQ     -131072,DU
         2 000365   000000 756000 xsym               STQ     FSA_FLAG

      166     2837    2   /**/ ENCRP_SEEDSF = ZI$DIR.ENCP_SEED;

   2837  2 000366   000027 236000 xsym               LDQ     ZI$DIR+23
         2 000367   000000 756000 xsym               STQ     ENCRP_SEEDSF

      167     2838    2       CALL SYS_FUNC_READ ALTRET(EOF);

   2838  2 000370   000006 631400 3                  EPPR1   6
         2 000371   000000 701000 xent               TSX1    SYS_FUNC_READ
         2 000372   000404 702000 2                  TSX2    EOF

      168     2839    2       IF JREC.TYPE ~= T#FID THEN

   2839  2 000373   000000 470400 xsym               LDP0    JRNL$
         2 000374   000001 236100                    LDQ     1,,PR0
         2 000375   777000 376003                    ANQ     -512,DU
         2 000376   003000 116003                    CMPQ    1536,DU
         2 000377   000402 600000 2                  TZE     s:2841

      169     2840    2           CURR_TIME = JREC.TIME;

   2840  2 000400   000000 235100                    LDA     0,,PR0
         2 000401   000003 755000 0                  STA     CURR_TIME

      170     2841    2       RETURN;

   2841  2 000402   000006 221200 0                  LDX1  ! END_OF_JOURNAL+1
         2 000403   000001 702211                    TSX2  ! 1,X1

      171     2842    2   EOF:
      172     2843    2       ALTRETURN;

   2843  2 000404   000006 221200 0     EOF          LDX1  ! END_OF_JOURNAL+1
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:28   
         2 000405   000000 702211                    TSX2  ! 0,X1

USRIDX
 Sect OctLoc
   0     004   000000 000000                                                    ....

END_OF_JOURNAL
 Sect OctLoc
   0     005   0***** ******                                                    ....

(unnamed)
 Sect OctLoc
   3     000   000000 006000   000001 000000   000000 006000   777777 777777    ................
   3     004   000002 000000   000000 006014   000000 000000   072040 040040    ............:
   3     010   001777 777640   000000 006000                                    ........
      173     2844    2   END READ_JRNL;
      174     2845    1   END ZIU$PRESCN;

PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:29   
--  Include file information  --

   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   ZI$DIR.:ZIC0TOU  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   ZI_DBU_ROLL.:ZIC0TOU  is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$PRESCN.

   Procedure ZIU$PRESCN requires 262 words for executable code.
   Procedure ZIU$PRESCN is declared NOAUTO and requires 10 words of local(STATIC) storage.

    No errors detected in file ZIU$PRESCN.:ZIC0TSI    .
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:30   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:31   
          MINI XREF LISTING

ALTRTN
      2821**LABEL    2746--CALLALT  2748--CALLALT  2762--CALLALT
ASSOC_DCB
      2722**DCL-ENT  2748--CALL     2762--CALL
B$EXCFR.ASL
      2700**DCL      2700--REDEF
B$EXCFR.ERR.ERR#
      2714**DCL      2714--REDEF
B$EXCFR.EVID
      2713**DCL      2713--REDEF    2714--REDEF
B$EXCFR.IR
      2701**DCL      2701--REDEF
B$EXCFR.PREVSZ
      2700**DCL      2700--REDEF
B$EXCFR.SUBC
      2712**DCL      2712--REDEF    2713--REDEF    2713--REDEF
BAD_FILE
        29**DCL      2770<<ASSIGN
BERC.DCB#
       183**DCL       184--REDEF
BERC.SYSID
       184**DCL      2778>>ASSIGN   2782>>ASSIGN
BERC.TIME
       180**DCL      2779>>ASSIGN   2783>>ASSIGN   2789>>ASSIGN
BERC.USER#
       182**DCL      2774>>IF       2776>>ASSIGN   2777>>ASSIGN   2778>>ASSIGN   2779>>ASSIGN   2782>>ASSIGN
      2783>>ASSIGN   2787>>ASSIGN   2788>>ASSIGN   2789>>ASSIGN   2792>>ASSIGN
BREAK_FLAG
        25**DCL      2737>>IF
BRK_ROLL
       375**DCL      2738>>UNWIND
BUFLNSF
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:32   
       585**DCL      2834<<ASSIGN
BUFSF
       586**DCL      2833<<ASSIGN
CKPT.TIME
       186**DCL      2785>>ASSIGN
CKPT.USER#
       188**DCL      2785>>ASSIGN
COUNTSF
       636**DCL       637--REDEF
CURR_TIME
        14**DCL      2735>>DOWHILE  2840<<ASSIGN
DCBLIST$
       326**DCL       349--IMP-PTR
DCBSF
       565**DCL      2832<<ASSIGN
ENCRP_SEEDSF
       594**DCL       595--REDEF    2837<<ASSIGN
END_OF_JOURNAL
        28**DCL      2731>>IF       2735>>DOWHILE  2802<<ASSIGN   2809<<ASSIGN   2821<<ASSIGN
END_OF_JRNL
      2801**LABEL    2734--CALLALT  2797--CALLALT
EOF IN PROCEDURE READ_JRNL
      2843**LABEL    2838--CALLALT
ERRCODESF
       596**DCL       601--REDEF
ERRCODESF.ERR#
       599**DCL      2801>>IF
FID$
       325**DCL       329--IMP-PTR  2751>>CALL
FIDLIST.CRPT
       338**DCL       339--REDEF
FIDLIST.DCB#
       340**DCL      2751<>CALL
FIDSF_RD
       612**DCL       613--REDEF
FIDX
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:33   
       373**DCL      2743<>CALL     2744>>IF       2746<>CALL     2748<>CALL     2749<>CALL     2751>>CALL
      2759<>CALL     2762<>CALL     2763<>CALL
FILE.COMGROUP
       152**DCL      2750>>IF
FILE.ID.NAME#.C
       161**DCL      2757<<CALLBLT
FILE.ID.NAME#.L
       160**DCL      2757>>CALLBLT  2758<<ASSIGN   2758>>ASSIGN
FILE.KEYED
       148**DCL      2755>>IF
FIND_FID
      2720**DCL-ENT  2743--CALL
FSA_FLAG
       627**DCL      2836<<ASSIGN
FULLSF
       583**DCL      2835<<ASSIGN
HELPCODE
       630**DCL       635--REDEF
JREC.LENGTH
       168**DCL       171--IMP-SIZ
JREC.TIME
       163**DCL      2840>>ASSIGN
JREC.TYPE
       164**DCL      2741>>DOCASE   2839>>IF
JRNL$
       141**DCL       142--IMP-PTR   162--IMP-PTR   172--IMP-PTR   179--IMP-PTR   185--IMP-PTR  2733<<ASSIGN
      2741>>DOCASE   2750>>IF       2755>>IF       2757>>CALLBLT  2757>>CALLBLT  2758>>ASSIGN   2758>>ASSIGN
      2774>>IF       2776>>ASSIGN   2777>>ASSIGN   2778>>ASSIGN   2778>>ASSIGN   2779>>ASSIGN   2779>>ASSIGN
      2782>>ASSIGN   2782>>ASSIGN   2783>>ASSIGN   2783>>ASSIGN   2785>>ASSIGN   2785>>ASSIGN   2787>>ASSIGN
      2788>>ASSIGN   2789>>ASSIGN   2789>>ASSIGN   2792>>ASSIGN   2839>>IF       2840>>ASSIGN
JRNL_BUF
        23**DCL      2733--ASSIGN   2830<<ASSIGN   2833--ASSIGN
KEYVSF
       568**DCL       573--REDEF
KEYVSF.WD_ONE
       570**DCL       571--REDEF
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:34   
MSGCODE
       602**DCL       603--REDEF
M_JRNL.DCB#
        21**DCL      2832>>ASSIGN
NO.USERS
       362**DCL      2810>>DOWHILE
NO_OPEN
      2770**LABEL    2751--CALLALT  2754--CALLALT  2765--CALLALT
OPEN_FID
      2721**DCL-ENT  2754--CALL     2765--CALL
QUE_UP
      2723**DCL-ENT  2749--CALL     2763--CALL
READ_JRNL
      2828**PROC     2734--CALL     2797--CALL
RECSIZE
        12**DCL         7--PROC     2730<<ASSIGN
ROLL_CMPLT_TIME
        15**DCL      2735>>DOWHILE
ROLL_REC
         9**DCL         7--PROC
ROLL_REC.START
        10**DCL      2776<<ASSIGN   2787<<ASSIGN   2813<<ASSIGN
ROLL_REC.USER#
        11**DCL      2777<<ASSIGN   2788<<ASSIGN   2814<<ASSIGN
STORE_FID
      2719**DCL-ENT  2746--CALL     2759--CALL
SYS_FUNC_READ
      2718**DCL-ENT  2838--CALL
TESTSF
       578**DCL      2753<<ASSIGN   2764<<ASSIGN
USER.RLBK_START
       356**DCL      2776>>ASSIGN   2779<<ASSIGN   2783<<ASSIGN   2785<<ASSIGN   2787>>ASSIGN   2789<<ASSIGN
      2813>>ASSIGN
USER.SYSID
       354**DCL      2774>>IF       2778<<ASSIGN   2782<<ASSIGN   2792<<ASSIGN   2811>>IF
USRIDX
PL6.E3A0      #001=ZIU$PRESCN File=ZIU$PRESCN.:ZIC0TSI                           FRI 09/05/97 13:19 Page:35   
        27**DCL      2810>>DOWHILE  2811>>IF       2813>>ASSIGN   2814>>ASSIGN   2815<<ASSIGN   2815>>ASSIGN
      2818<<ASSIGN   2818>>ASSIGN
ZI$DIR.ALTKEY
       876**DCL       877--REDEF     878--REDEF
ZI$DIR.AREAFID
       842**DCL       843--REDEF
ZI$DIR.DATE
       881**DCL       885--REDEF
ZI$DIR.DEST_SEED
       837**DCL       838--REDEF     839--REDEF
ZI$DIR.ENCP_SEED
       834**DCL       835--REDEF     836--REDEF    2837>>ASSIGN
ZI$DIR.REPRT_ZERO
       868**DCL       869--REDEF
ZI$DIR.SCHFID
       840**DCL       841--REDEF
ZI$DIR.TIME
       886**DCL       891--REDEF
ZIU$CGTOPN
      2724**DCL-ENT  2751--CALL
