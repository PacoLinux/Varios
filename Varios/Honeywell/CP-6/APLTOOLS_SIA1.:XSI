$COM*T***********************************************************************
$COM*T*                                                                     *
$COM*T*                Copyright (c) Bull HN Information Systems Inc., 1989 *
$COM*T*                                                                     *
$COM*T***********************************************************************
)TERM INPUT 4
 
;'        Function: COPYRIGHTSI'
 
 
    " Debug COPYRIGHTSI NOTICE;IN;UIN;Read;SI;UI;OU;CD;In;Inr;Key;R;UICARD;CENTER;DATENTIME;INSERT;NB;OPENS;READ;REPLACE;WRTLS;WRTOU;DB
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QPDEF COPYRIGHTV $DMD OPENS $DMD UIN_Read[3 4 5] $DMD CD_'$' $DMD $GO(0=DB_$QNC 'Debug')/nd $DMD DB_Debug
[3]  nd:OUTWIDTH $DMD UICARD_' ',DATENTIME,'  ',(3$TAK$QUA),'   $NECOPYRIGHT'
[4]  mid:$GO ((0=$TAKIN),(CD,2 6$R 'COM*M*COM*T*')&.=7$TAKIN_READ)/done mid tm
[5]  $COM  File doesn't start with *M* or *T*, So let's add *T* !
[6]   0 INSERT CD,'COM*T*',70$R '*'
[7]   INSERT CD,'COM*T*',(69$R ' '),'*'
[8]   INSERT CD,'COM*T* ',(68 CENTER NOTICE),'*'
[9]   INSERT CD,'COM*T*',(69$R ' '),'*'
[10]  INSERT CD,'COM*T*',70$R '*'
[11]  $GO next
[12] $COM  Now, Lets See if we have to update the trademark!
[13] tm:In_Read
[14]  $GO ((0=$TAKIN),(CD,'COM*T*')$OR.$NE7$TAKIN_READ)/done btm
[15]  $GO ((0=$TAKIN),(CD,'COM*T*')$OR.$NE7$TAKIN_READ)/done btm
[16] $COM  This should be the *T* record to update!
[17]  Inr_Read               $COM   Remember this place
[18]  $GO ((0=$TAKIN),(CD,'COM*T*')$OR.$NE7$TAKIN_READ)/done btm
[19]  $GO ((0=$TAKIN),(CD,'COM*T*')$OR.$NE7$TAKIN_READ)/done btm
[20]  (Read In)_Inr Read $DMD REPLACE CD,'COM*T* ',(68 CENTER NOTICE),'*'
[21]  Read_In $DMD $GO lp
[22] btm:'*** Unrecognized *T* notice at start of File, unable to update'
[23] $COM
[24] $COM    Main loop.  Get a record and check for function header.
[25] $COM                If a function header...
[26] $COM                   Next record should be a tm notice,
[27] $COM                   If not, insert one, if it is replace it.
[28] $COM
[29] lp:$GO (0=$TAKIN_READ)/done
[30] next:$GO (('$"'$NE$TAKR)$OR3>$R R_NB IN)/lp
[31] rem:In_$TAKRead     $COM     Remember insertion point if nothing follows
[32]  $GO (0=$TAKIN_READ)/ins
[33]  $GO (('['$NE$TAKR)$OR(CD,'COM*T*')$NE7$TAKNB(R$I ']')$DRPR_NB IN)/ins
[34]  REPLACE((-1+IN$I '$')$TAKIN),CD,'COM*T* ',NOTICE
[35]  $GO lp
[36] ins:$GO ((('[0'&.=2$TAKIN)&($TAK2$DRPIN)$E ';]'),DB=2)/rem ine
[37]  (In$-1)INSERT '[.001] ',CD,'COM*T* ',NOTICE
[38]  $GO lp
[39] ine:' **** Preceding function does not have a *T* notice!'
[40]  $GO lp
[41] done:$QFCLEAR $DMD $GO 0
    "
 
$COM  $QFCLEAR        39
$COM  $QPDEF           2
$COM  $QUA             3
$COM  CD               0     2_    4     6     7     8     9    10    14
$COM                  15    18    19    20    33    34    37
$COM  CENTER           0     8    20
$COM  COPYRIGHTV    2
$COM  DATENTIME        0     3
$COM  IN               0     4     4_   14    14_   15    15_   18    18_
$COM                  19    19_   29_   30    32_   33    34    34    36
$COM                  36
$COM  INSERT           0     6     7     8     9    10    37
$COM  In               0    13_   20    21    31_   37
$COM  Inr              0    17_   20
$COM  Key              0
$COM  NB               0    30    33    33
$COM  NOTICE           0     8    20    34    37
$COM  OPENS            0     2
$COM  OU               0
$COM  R                0    30    30_   33    33    33_
$COM  READ             0     4    14    15    18    19    29    32
$COM  REPLACE          0    20    34
$COM  Read             0     2]   13    17    20    20    21_   31
$COM  SI               0
$COM  UI               0
$COM  UICARD           0     3_
$COM  UIN              0     2_
$COM  WRTLS            0
$COM  WRTOU            0
$COM  btm             14    15    18    19    22:
$COM  done             4    14    15    18    19    29    39:
$COM  ins             32    33    36:
$COM  lp              21    29:   30    35    38
$COM  mid              4:    4
$COM  next            11    30:
$COM  rem             31:   36
$COM  tm               4    13:
 
 
 
' ********  Package:   COPYRIGHTV      ********'
 
 
 
 
 
 
;'        Function: CENTER   '
 
 
    " R_N CENTER CV
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_N$TAK((0$MAX($MINN%2)$-$MIN0.5#$R CV)$R ' '),CV
    "
 
$COM  CV   0     2     2
$COM  N    0     2     2
$COM  R    0_    2_
 
 
 
;'        Function: DATENTIME'
 
 
    " R_DATENTIME
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_1$DRP-1$DRP,'3(</>,ZI2),< >,2(ZI2,<:>)' $QFMT 1 5$R $QTS[2 3 1 4 5]$-0 0 1900 0 0
    "
 
$COM  $QFMT   2
$COM  $QTS    2]
$COM  R       0_    2_
 
 
 
;'        Function: INSERT   '
 
 
    " A INSERT L
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $GO (0=$QNC 'A')/wn
[3]   (A#1000)WRTOU(12$TAK'+',($FMTA)),' ',UICARD $DMD Key_2+A#1000
[4]  wn:Key WRTOU L $DMD Key_Key+1
    "
 
$COM  $QNC      2
$COM  A         0     3     3     3
$COM  Key       3_    4     4_    4
$COM  L         0     4
$COM  UICARD    3
$COM  WRTOU     3     4
$COM  wn        2     4:
 
 
 
;'        Function: NB       '
 
 
    " R_NB R
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_(-1+(' '$NER)$I 1)$DRP(1$-(' '$NE$REVR)$I 1)$DRPR
    "
 
$COM  R    0_    0     2_    2     2     2
 
 
 
;'        Function: OPENS    '
 
 
    " OPENS;$QIO
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_1 $DMD SI_$QUNSET 'SI' $DMD UI_$QUNSET 'UI' $DMD OU_$QUNSET 'OU'
[3]   SI_(-1+SI$I ',')$TAKSI $DMD UI_(-1+UI$I ',')$TAKUI $DMD OU_(-1+OU$I ',')$TAKOU
[4]   Read_1 0 2 0 0 0 0 1 0
[5]   (SI,',IN')$QFOPEN 1 $DMD SI_1
[6]   (OU,',CREATE,ERROR')$QFOPEN 3 $DMD OU_3
[7]   $GO ('ME$NE'$EQVUI)/nui
[8]   (UI,',IN')$QFOPEN 2 $DMD UI_2
[9]   $GO 0
[10] nui:UI_SI $DMD Read[2]_999999999
    "
 
$COM  $QFOPEN      5     6     8
$COM  $QIO         0     2_
$COM  $QUNSET      2     2     2
$COM  OU           2_    3_    3     3     6     6_
$COM  Read         4_   10]_
$COM  SI           2_    3_    3     3     5     5_   10
$COM  UI           2_    3_    3     3     7     8     8_   10_
$COM  nui          7    10:
 
 
 
;'        Function: OUTWIDTH'
 
 
    " R_OUTWIDTH;OUT
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $GO ($QONL&(3 3$R 'UC$NEME$NELO$NE')&.=3$TAKOUT_$QUNSET 'M$LO')/onl
[3]   $GO (0$NE$R R_$QSSS OUT ',WIDTH=')/sww
[4]   R_110 $DMD $GO ($QONL=0)/0
[5]  onl:$GO (0$NE$R R_$QSSS OUT ',WWID=')/sww
[6]   R_30$MAX300$MIN$QTATTR[7]
[7]   $GO 0
[8]  sww:R_$QFI(-1+$MIN/OUT$I ',$"')$TAKOUT_(OUT$I '=')$DRPOUT_R$DRPOUT
    "
 
$COM  $QFI      7
$COM  $QONL     1     3
$COM  $QPW      3
$COM  $QSSS     2     4
$COM  $QTATTR   5]
$COM  $QUNSET   1
$COM  OUT       0     1_    2     4     7     7_    7     7_    7
$COM  R         0_    2_    3_    4_    5_    7_    7
$COM  onl       1     4:
$COM  sww       2     4     7:
 
 
 
;'        Function: READ     '
 
 
    " R_READ;$QIO;SIPOSITION;ENDSI;UILINES;UIS;UI1;UI2;FROMSI;INCOMMAND;LS;KEY;RK;Z
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_0 $DMD (1 2$R ioerr 79)$QSM 'READ'
[3]   (SIPOSITION ENDSI UIS UI1 UI2 FROMSI INCOMMAND LS KEY)_Read
[4]   $GO INCOMMAND/tryui
[5]   $GO (SIPOSITION<ENDSI)/readsi $DMD $GO (2$NEUIS)/tryui
[6]   ENDSI_1+UI2
[7]  ll:R_$QFREAD SI '' 0 3 $DMD $GO (ENDSI>SIPOSITION_Read[0]_Read[0]+1)/ll
[8]  tryui:Read[6]_INCOMMAND_1 $DMD Read[5]_FROMSI_0
[9]   $GO ('+'$NE1$TAKR_$QFREAD UI '' 0 3)/ok2
[10]  Read[6]_INCOMMAND_0 $DMD $GO ($OR/(2 4$R '+END+end')&.=4$TAKR)/endofui
[11]  $GO (1 2$OR.=$R UILINES_$QFI 1$DRPZ\(Z_R$NE',')/R_(R$I ' ')$TAKR)/ok1
[12]  'Bad UI file format, skipping rest of UI' $DMD $GO endofui
[13] ok1:(UIS UI1 UI2)_Read[2 3 4]_3$TAK($R UILINES),UILINES
[14]  Read[1]_UI1+1=UIS $DMD $GO 1
[15] readsi:R_$QFREAD SI '' 0 3 $DMD Read[0]_SIPOSITION_SIPOSITION+Read[5]_FROMSI_1
[16] ok2:$GO (2=$TBRZ_RK_$QFRKEY UI SI[FROMSI],2)/ok3
[17]  Z_9$TAK(9 3$-FROMSI#4 3)$FMT(RK,SIPOSITION$-1)[FROMSI]%1000 1[FROMSI]
[18] ok3:WRTLS LS/'  ',(Z,'* '[FROMSI]),' ',R $DMD Read[8]_$ENCRK
[19]  $GO 0
[20] ioerr:$GO ((-1$TAK$QERN)=tryui+1)/badui $DMD R_0/0 $DMD $GO 0
[21] badui:'+END supplied '
[22] endofui:Read[1 6]_99999999 0 $DMD $GO 1
[23] $COM
[24] $COM    NAME:          READ
[25] $COM    PURPOSE:       To read SI and UI files.
[26] $COM
[27] $COM    DESCRIPTION:   The global variables:
[28] $COM
[29] $COM                   SI    ....  File tie number for source input
[30] $COM                   UI    ....  File tie number for update input
[31] $COM                   Read  ....  Vector of READ state information:
[32] $COM                               [1] (1) Current SI record
[33] $COM                               [2] (0) SI record to stop and get
[34] $COM                                       next UI record at.
[35] $COM                               [3] (1) Number of number in last
[36] $COM                                       "+" card update record (1,2).
[37] $COM                               [4] (0) First UI line number from "+".
[38] $COM                               [5] (0) Second UI line number from "+".
[39] $COM                               [6] (0) 1 if record from SI, or
[40] $COM                                       0 if record from UI.
[41] $COM                               [7] (0) 1 if reading from UI returning
[42] $COM                                       records (until next "+").
[43] $COM                               [8] (1) 1 if a listing is to be made
[44] $COM                                       via the WRTLS function.
[45] $COM                               [9] (0) Key of record last returned.
[46] $COM
    "
 
$COM  $QERN        20
$COM  $QFI         11
$COM  $QFREAD       7     9    15
$COM  $QFRKEY      16
$COM  $QIO          0     2_
$COM  $QSM          2
$COM  ENDSI         0     3     5     6_    7
$COM  FROMSI        0     3     8_   15_   16    17    17    17    18
$COM  INCOMMAND     0     3     4     8_   10_
$COM  KEY           0     3
$COM  LS            0     3    18
$COM  R             0_    7_    9_   10    11    11_   11    11    15_   18
$COM               20_
$COM  RK            0    16_   17    18
$COM  Read          3     7]_   7]    8]_   8]_  10]_  13]_  14]_  15]_  15]_
$COM               18]_  22]_
$COM  SI            7    15    16]
$COM  SIPOSITION    0     3     5     7_   15_   15    17
$COM  UI            9    16
$COM  UILINES       0    11_   13    13
$COM  UIS           0     3     5    13    14
$COM  UI1           0     3    13    14
$COM  UI2           0     3     6    13
$COM  WRTLS        18
$COM  Z             0    11    11_   16_   17_   18
$COM  badui        20    21:
$COM  endofui      10    12    22:
$COM  ioerr         2    20:
$COM  ll            7:    7
$COM  ok1          11    13:
$COM  ok2           9    16:
$COM  ok3          16    18:
$COM  readsi        5    15:
$COM  tryui         4     5     8:   20
 
 
 
;'        Function: REPLACE  '
 
 
    " REPLACE L;Z
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $GO (Read[6]=0)/ui
[3]   (1000#Read[1]$-1)WRTOU(12$TAK'+',Z,',',(Z_$FMTRead[1]$-1)),' ',UICARD
[4]   (100+1000#Read[1]$-1)WRTOU L
[5]   $GO 0
[6]  ui:(Read[9])WRTOU L
[7]   $GO 0
    "
 
$COM  L        0     4     6
$COM  Read     2]    3]    3]    4]    6]
$COM  UICARD   3
$COM  WRTOU    3     4     6
$COM  Z        0     3     3_
$COM  ui       2     6:
 
 
 
;'        Function: WRTLS    '
 
 
    " WRTLS R
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R
    "
 
$COM  R   0     2
 
 
 
;'        Function: WRTOU    '
 
 
    " K WRTOU L
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   (DB$NE 0)/'Key: ',($FMTK),':  record: ',L
[3]   L $QFWRITE OU K 0 3
    "
 
$COM  $QFWRITE   3
$COM  Debug      2
$COM  K          0     2     3
$COM  L          0     2     3
$COM  OU         3
 
 
 
COPYRIGHTV_'CENTER   DATENTIMEINSERT   NB       OPENS    READ     REPLAC'
_$QEX $QPNAMES COPYRIGHTV_$QPACK 10 9$RCOPYRIGHTV,'E  WRTLS    WRTOU    OUTWIDTH '
' ********  Package:   FILEV        ********'
 
 
 
 
 
 
;'        Function: FATTRS   '
 
 
    " R_FATTRS N;OP
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   N_$QTLEX N ' ,'
[3]   OP_'OLDFILE' 'NEWFILE' 'ERROR' 'ALL' 'NONE' 'SHAREIN' 'FILE' 'SCRATCH'
[4]   OP_OP,'NAMED' 'UPDATE' 'IN' 'CREATE' 'CONSEC' 'KEYED' 'RANDOM' 'UR'
[5]   OP_OP,'RELATIVE' 'INDEXED' 'IDS' 'SYMB' 'FPRG' 'CG' 'IREL' 'RESTRICT'
[6]   OP_OP,'FIXED' 'VARIABLE' 'UNDEF' 'FREE' 'JRNL' 'DIRECT' 'SEQUEN' 'BLOCK'
[7]   OP_OP,'CTG' 'COMP' 'SCRUB' 'REASSIGN' 'LOAD' 'DELETE'
[8]   R_'' $DMD $GO (0=$R N_(~N$E OP)/N)/0
[9]   R_(1+1<$R N)$DSC' is not a legal option' ' are not legal options'
[10]  N_'''',$"N,$"''''
[11]  N_-1$DRP$TAK,/N,$"','
[12]  R_N,R
    "
 
$COM  $QTLEX   2
$COM  N        0     2_    2     8_    8     8     9    10_   10    11_   11
$COM          12
$COM  OP       0     3_    4_    4     5_    5     6_    6     7_    7     8
$COM  R        0_    8_    9_   12_   12
 
 
;'        Function: FNUM     '
 
 
    " R_FNUM N;M
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_'' $DMD $GO (N&.=' ')/0
[3]   $GO (0$NE$R R_(1$NE$R M_$QFI N)/'Illegal Tie number')/0
[4]   $GO (0$NE$R R_(1$NE$QVI N)/'Illegal Tie number')/0
[5]   $GO (0$NE$R R_((M<0)$ORM>-1+2*35)/'Illegal Tie number')/0
[6]   $GO 0
    "
 
$COM  $QFI   3
$COM  $QVI   4
$COM  M      0     3_    5     5
$COM  N      0     2     3     4
$COM  R      0_    2_    3_    4_    5_
 
 
;'        Function: FOPEN    '
 
 
    " R_FOPEN N;Q
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_'' $DMD N_(1$-(' '=$REVN)$I 0)$DRP(-1+(N=' ')$I 0)$DRPN
[3]   $GO ((3>+/N='.')&(' '&.=N)$OR'*'=$TAKN)/0
[4]   R_'Illegal filename'
[5]   $GO ((3<$R N)$OR0=$R N_$QTLEX N '.')/0
[6]   R_'Filename must consist of alphnumerics and $_, $-, :, and $'
[7]   Q_($TAKN)$E '0123456789$_$-:$',$QAV[,65 98$SC.+$I 26]
[8]   $GO ((0=$R Q)$OR0$E Q)/0
[9]   R_'Account must consist of ASCII non-control characters'
[10]  $GO (1=$R N)/done
[11]  Q_(2$DSCN)$E $QAV[33+$I 94]
[12]  $GO (0$E Q)/0
[13] done:$GO 0,R_''
    "
 
$COM  $QAV     7]   11]
$COM  $QTLEX   5
$COM  N        0     2_    2     2     2     3     3     3     5     5_    5
$COM           7    10    11
$COM  Q        0     7_    8     8    11_   12
$COM  R        0_    2_    4_    6_    9_   13_
$COM  done    10    13:
 
 
;'        Function: FPROCESS '
 
 
    " R_FPROCESS IN;XSTAT;I
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   XSTAT_,FSTAT $DMD XSTAT[FSCR$I IN[;1]]_IN[;2]
[3]   FCH_FCH&&/FSTAT$EQV$"XSTAT_($R FSTAT)$R XSTAT
[4]   FSTAT_XSTAT $DMD R_''
[5]   $GO (~0$E FCH)/CHANGE_0
[6]  lp:I_FCH$I 0
[7]   $GO (0$NE$R R_(FSCR[-2 -1 0+3#I],I)FSTRM FSTAT[I;])/0
[8]   FCH[I]_1
[9]   $GO (0$E FCH)/lp
    "
 
$COM  CHANGE   5_
$COM  FCH      3_    3     5     6     8]_   9
$COM  FSCR     2     7]
$COM  FSTAT    2     3     3     4_    7]
$COM  FSTRM    7
$COM  I        0     6_    7     7     7     8
$COM  IN       0     2]    2]
$COM  R        0_    4_    7_
$COM  XSTAT    0     2_    2]_   3_    3     4
$COM  lp       6:    9
 
 
;'        Function: FSTRM    '
 
 
    " R_FNS FSTRM TFO;T;F;O
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_0/0 $DMD (fio,[1.5]69+$I 9)$QSM 'FSTRM'
[3]   (T F O)_TFO
[4]   $GO (' '&.=T,F,O)/0
[5]   $GO (0$NE$R T_$QFI T)/gt
[6]   WSFILES FWRITERR 'An integer tie number must be entered'
[7]   $GO 0,R_1$TAKFNS
[8]  gt:$GO (T$E $QFNUMS)/ot
[9]   $GO (' '$OR.$NEF)/gf
[10]  WSFILES FWRITERR 'A filename is required'
[11]  $GO 0,R_FNS[,2]
[12] gf:(F,(' '$OR.$NEO)/',',O)$QFOPEN T $DMD CHANGE_1
[13]  $Q1_(FNS[3])(VFOPTS T)
[14]  FSEL_(~FSEL$E FNS[1 3])/FSEL
[15]  $GO 0
[16] ot:$GO (' '&.=F)/cf
[17]  $QFCLOSE T $DMD $GO gt
[18] cf:$QFCLOSE T $DMD CHANGE_1
[19]  $Q1_(FNS[1])'  ' $DMD $Q1_(FNS[2])'  ' $DMD $Q1_(FNS[3])'  '
[20]  FSTAT[FNS[4];]_$ENC'' $DMD FSEL_FSEL,FNS[1 3]
[21]  $GO 0
[22] fio:R_FNS[2]
[23]  WSFILES FWRITERR($XEC')?')
[24]  $GO 0
    "
 
$COM  $QFCLOSE   17    18
$COM  $QFI        5
$COM  $QFNUMS     8
$COM  $QFOPEN    12
$COM  $QSM        2
$COM  CHANGE     12_   18_
$COM  F           0     3     4     9    12    16
$COM  FNS         0     7    11]   13]   14]   19]   19]   19]   20]   20]
$COM             22]
$COM  FSEL       14_   14    14    20_   20
$COM  FSTAT      20]_
$COM  FWRITERR    6    10    23
$COM  O           0     3     4    12    12
$COM  R           0_    2_    7_   11_   22_
$COM  T           0     3     4     5_    5     8    12    13    17    18
$COM  TFO         0     3
$COM  VFOPTS     13
$COM  WSFILES     6    10    23
$COM  cf         16    18:
$COM  fio         2    22:
$COM  gf          9    12:
$COM  gt          5     8:   17
$COM  ot          8    16:
 
 
;'        Function: VFILEINIT'
 
 
    " VFILEINIT F;$QIO;IND
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   MAXFID_7 $DMD $QIO_1
[3]   IND_'[',$"($FMT$"$I MAXFID),$"']'
[4]   FFNUMS_F[F[;8]$I ($ENC'FNUM'),$"IND;1]
[5]   FFIDS_F[F[;8]$I ($ENC'FID'),$"IND;1]
[6]   FFOPTS_F[F[;8]$I ($ENC'FINFO'),$"IND;1]
[7]   FSCR_,FFNUMS,FFIDS,[1.5]FFOPTS
    "
 
$COM  $QIO      0     2_
$COM  F         0     4]    4]    5]    5]    6]    6]
$COM  FFIDS     5_    7
$COM  FFNUMS    4_    7
$COM  FFOPTS    6_    7
$COM  FSCR      7_
$COM  IND       0     3_    4     5     6
$COM  MAXFID    2_    3
 
 
;'        Function: VFILES   '
 
 
    " R_VFILES F;NUMS;I;$QIO;FN;TN;FO
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_1 $DMD MAXFID_7
[3]   $Q1_(F[;8]$I $ENC'TS')(,'G<99/99/99 >,G<99:99:99>' $QFMT($IB25),[1.5],+/$QTS[4 5 6]#10000 100 1)
[4]   R_FFNUMS,FFIDS,FFOPTS $DMD FSTAT_MAXFID 3$R $ENC''
[5]   $GO (0=$R NUMS_$QFNUMS)/0
[6]   I_$R NUMS_(MAXFID$MIN$R NUMS)$TAKNUMS
[7]   $Q1_(I$TAKFFNUMS),[1.5]FN_$FMT$"NUMS
[8]   $Q1_(I$TAKFFIDS),[1.5]TN_$QFID$"NUMS
[9]   $Q1_(I$TAKFFOPTS),[1.5]FO_VFOPTS$"NUMS
[10]  R_(I$DRPFFNUMS),FFIDS,I$DRPFFOPTS
[11]  FSTAT_FN,TN,[1.5]FO
[12]  FSTAT_FSTAT,[1]((MAXFID$-I),3)$R $ENC''
    "
 
$COM  $QFID     8
$COM  $QFMT     3
$COM  $QFNUMS   5
$COM  $QIO      0     2_
$COM  $QTS      3]
$COM  F         0     3]
$COM  FFIDS     4     8    10
$COM  FFNUMS    4     7    10
$COM  FFOPTS    4     9    10
$COM  FN        0     7_   11
$COM  FO        0     9_   11
$COM  FSTAT     4_   11_   12_   12
$COM  I         0     6_    7     8     9    10    10    12
$COM  MAXFID    2_    4     6    12
$COM  NUMS      0     5_    6_    6     6     7     8     9
$COM  R         0_    4_   10_
$COM  TN        0     8_   11
$COM  VFOPTS    9
 
 
;'        Function: VFOPTS   '
 
 
    " R_VFOPTS N;FOPTS;L;LO;M;MO;O;P;RO;Z
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   Z_$QUNSET 'F$',$FMTN
[3]   Z_(Z$I ',')$DRPZ
[4]   M_$MAX/L_P$-0,-1$DRPP_(Z=',')/$I $R Z_Z,','
[5]   Z_(($R L),M)$R (,L$SC.$GE$I M)\Z
[6]   MO_$MAX/LO_0$MAX-1+(Z='=')$MAX.#$I M
[7]   O_(' ',,Z)[1+(LO$SC.$GE$I MO)#((-1+$I $R L)#-1$TAK$R Z)$SC.+$I MO]
[8]   FOPTS_5 5$R 'FUN  ORG  DISP SHAREEXIST'
[9]   RO_(P_$OR$RD1((5 MO)$TAKFOPTS)&.=$TPSO)$RD1Z
[10]  R_(,(2+P/LO)$SC.$LE$I -1$TAK$R RO)/,RO
[11]  FOPTS_3 4$R 'CTG COMPLOAD'
[12]  RO_(P_$OR$RD1((3 MO)$TAKFOPTS)&.=$TPSO)$RD1Z
[13]  R_R,,('Y'=(,RO)[(2+P/LO)+(-1+$I +/P)#-1$TAK$R RO])$RD1P$RD1O,','
[14]  R_-1$DRP(R$NE' ')/R
    "
 
$COM  $QUNSET   2
$COM  FOPTS     0     8_    9    11_   12
$COM  L         0     4_    5     5     7
$COM  LO        0     6_    7    10    13
$COM  M         0     4_    5     5     6
$COM  MO        0     6_    7     7     9    12
$COM  N         0     2
$COM  O         0     7_    9    12    13
$COM  P         0     4     4_    9_   10    12_   13    13    13
$COM  R         0_   10_   13_   13    14_   14    14
$COM  RO        0     9_   10    10    12_   13    13
$COM  Z         0     2_    3_    3     3     4     4_    4     5_    5
$COM            6     7     7     9    12
 
 
;'        Function: WSFILES  '
 
 
$COM***   WSFILES version:  09:55  11/12/86   ***
 
WSFILES_1 12$R     1  1 60 18  0 0 ''                                                                               'TS'            1 (0/0)   ''       (0/0)
WSFILES_WSFILES,[1] 5 11  5 74 -8 0 ''                                                                               'ERROR$_MESSAGE' 1 (0/0)   ''       (0/0)
WSFILES_WSFILES,[1] 6  1 31  9  0 2 'APL Files'                                                                      (,'*')          2 (0/0)   ''       (0/0)
WSFILES_WSFILES,[1] 7  2  1  3 32 2 'Tie'                                                                            (,'*')          2 (0/0)   ''       (0/0)
WSFILES_WSFILES,[1] 8  2 12 15 32 2 'File$-Identifier'                                                                (,'*')          2 (0/0)   ''       (0/0)
WSFILES_WSFILES,[1] 9  2 50  7 32 2 'Options'                                                                        (,'*')          2 (0/0)   ''       (0/0)
WSFILES_WSFILES,[1]10 11  1  2 32 2 '=='                                                                             (,'*')          2 (0/0)   ''       (0/0)
WSFILES_WSFILES,[1]11 12  1 78  0 2 '==============================================================================' (,'*')          2 (0/0)   ''       (0/0)
WSFILES_WSFILES,[1] 2  3  1  8  0 0 ''                                                                               'FNUM[1]'       0 (2 1 7) 'FNUM'   (0/0)
WSFILES_WSFILES,[1]23  4  1  8  0 0 ''                                                                               'FNUM[2]'       0 (2 1 7) 'FNUM'   (0/0)
WSFILES_WSFILES,[1]24  5  1  8  0 0 ''                                                                               'FNUM[3]'       0 (2 1 7) 'FNUM'   (0/0)
WSFILES_WSFILES,[1]25  6  1  8  0 0 ''                                                                               'FNUM[4]'       0 (2 1 7) 'FNUM'   (0/0)
WSFILES_WSFILES,[1]26  7  1  8  0 0 ''                                                                               'FNUM[5]'       0 (2 1 7) 'FNUM'   (0/0)
WSFILES_WSFILES,[1]27  8  1  8  0 0 ''                                                                               'FNUM[6]'       0 (2 1 7) 'FNUM'   (0/0)
WSFILES_WSFILES,[1]28  9  1  8  0 0 ''                                                                               'FNUM[7]'       0 (2 1 7) 'FNUM'   (0/0)
WSFILES_WSFILES,[1] 3  3 11 35  0 0 ''                                                                               'FID[1]'        0 (3 1 7) 'FOPEN'  (0/0)
WSFILES_WSFILES,[1]30  4 11 35  0 0 ''                                                                               'FID[2]'        0 (3 1 7) 'FOPEN'  (0/0)
WSFILES_WSFILES,[1]31  5 11 35  0 0 ''                                                                               'FID[3]'        0 (3 1 7) 'FOPEN'  (0/0)
WSFILES_WSFILES,[1]32  6 11 35  0 0 ''                                                                               'FID[4]'        0 (3 1 7) 'FOPEN'  (0/0)
WSFILES_WSFILES,[1]33  7 11 35  0 0 ''                                                                               'FID[5]'        0 (3 1 7) 'FOPEN'  (0/0)
WSFILES_WSFILES,[1]34  8 11 35  0 0 ''                                                                               'FID[6]'        0 (3 1 7) 'FOPEN'  (0/0)
WSFILES_WSFILES,[1]35  9 11 35  0 0 ''                                                                               'FID[7]'        0 (3 1 7) 'FOPEN'  (0/0)
WSFILES_WSFILES,[1] 4  3 49 30  0 0 ''                                                                               'FINFO[1]'      0 (4 1 7) 'FATTRS' (0/0)
WSFILES_WSFILES,[1]37  4 49 30  0 0 ''                                                                               'FINFO[2]'      0 (4 1 7) 'FATTRS' (0/0)
WSFILES_WSFILES,[1]38  5 49 30  0 0 ''                                                                               'FINFO[3]'      0 (4 1 7) 'FATTRS' (0/0)
WSFILES_WSFILES,[1]39  6 49 30  0 0 ''                                                                               'FINFO[4]'      0 (4 1 7) 'FATTRS' (0/0)
WSFILES_WSFILES,[1]40  7 49 30  0 0 ''                                                                               'FINFO[5]'      0 (4 1 7) 'FATTRS' (0/0)
WSFILES_WSFILES,[1]41  8 49 30  0 0 ''                                                                               'FINFO[6]'      0 (4 1 7) 'FATTRS' (0/0)
WSFILES_WSFILES,[1]42  9 49 30  0 0 ''                                                                               'FINFO[7]'      0 (4 1 7) 'FATTRS' (0/0)
 
 
 
FILEV  _'FATTRS   FNUM     FOPEN    FPROCESS FSTRM    VFILEINITVFILES'
_$QEX $QPNAMES FILEV  _$QPACK 9 9$RFILEV  ,'   VFOPTS   WSFILES  '
' ********  Package:   FITV         ********'
 
 
 
 
 
 
;'        Function: CODE13   '
 
 
    " R_CODE13 N;I;J;V
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   ' ***** Processor Attribute Information ***** ',($FMT$R N),' bytes'
[3]   $GO ((0=&/N$E $QAV[32+$I 96])$OR0$NE80|$R N)/nmove
[4]   I_(I$E 0 80 160)/I_-1+$QSSS N 'BEAM'
[5]   $GO ((J_'SUCK'$OR.$NE4$TAKN)&0=$R I)/nmove
[6]   $GO ((J=1)&I&.$NE0 80)/nmove
[7]   $GO J/l1 $DMD I_(~I$E 0 80)/I
[8]   'Input Cmd: ',4$TAKN
[9]   '    Logon: ',4$DRP69$TAKN
[10]  $DSC'Tran: ' ' NSC: ' ' NFA: ' ' NLN: ',$"('No' 'Yes')[1+-4$TAK1 1 $QCVT N[72]]
[11]  '     Node: ',N[72+$I 8]
[12]  J_80 $DMD $GO l2
[13] l1:I_(($R I)$MIN1)$TAK((I=80)/I),(I=0)/I $DMD J_0
[14] l2:$GO (J>I)/l3
[15]  '     File: ',(-48+$QAV$I N[1+J])$TAK(J+1)$DRPN $DMD J_J+80
[16] l3:$GO (0=$R I)/l4
[17]  'Output Cmd: ',N[I+$I 4]
[18]  '     Logon: ',N[I+4+$I 67]
[19]  V_1 1 $QCVT N[I+72]
[20]  '       How: ',(1+2$DCD-2$TAKV)$DSC'To' 'On' 'Into' 'Over'
[21]  '       Kin: ',(1+5$DSCV)$DSC'No' 'Yes'
[22]  '      DDNF: ',(1+3$DSCV)$DSC'No' 'Yes'
[23]  '      Node: ',N[I+72+$I 8]
[24]  '      File: ',(-48+$QAV$I N[I+80])$TAK(I+81)$DRPN
[25]  J_J+160
[26] l4:$GO (J$GE$R N)/0                     $COM Done!
[27]  $GO ('MAIL'$OR.$NEN[J+$I 4])/nall     $COM Error!
[28]  '*  Mail to: ',('ISR'$I N[J+5])$DSC'Initiator' 'Sender' 'Receiver' 'XXX'
[29]  '      Node: ',N[J+72+$I 8]
[30]  '   Mailbox: ',(-48+$QAV$I N[81+J])$TAK(81+J)$DRPN $DMD J_J+160
[31]  $GO l4
[32] nall:' ' $DMD '**** Uninterpreted portion of CODE13' $DMD N_J$DRPN
[33] nmove:' ' $DMD OCT N
    "
 
$COM  $QAV     3]   15    24    30
$COM  $QCVT   10    19
$COM  $QSSS    4
$COM  I        0     4_    4     4_    5     6     7_    7     7    13_   13
$COM          13    13    13    13    14    16    17    18    19    23    24
$COM          24
$COM  J        0     5_    6     7    12_   13_   14    15    15    15_   15
$COM          25_   25    26    27    28    29    30    30    30_   30    32
$COM  N        0     2     3     3     4     5     8     9    10]   11]   15]
$COM          15    17]   18]   19]   23]   24]   24    26    27]   28]   29]
$COM          30]   30    32_   32    33
$COM  OCT     33
$COM  R        0_
$COM  V        0    19_   20    21    22
$COM  l1       7    13:
$COM  l2      12    14:
$COM  l3      14    16:
$COM  l4      16    26:   31
$COM  nall    27    32:
$COM  nmove    3     5     6    33:
 
 
;'        Function: CODE09   '
 
 
    " R_CODE09 N;V
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   N_($MIN(($R N)%10),10)$R N
[3]   V_CODEACC$"$ENC[2]N[;$I 2]
[4]   R_N[;2+$I 8],'=',$DSCV
    "
 
$COM  CODEACC   3
$COM  N         0     2_    2     2     3]    4]
$COM  R         0_    4_
$COM  V         0     3_    4
 
 
;'        Function: CODE10   '
 
 
    " R_CODE10 N;V;Q
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   Q_R_0$R 0
[3]   $GO (3>$R N)/0
[4]  lp:Q_Q,$ENC2$TAKN
[5]   R_R,$ENC(V_3 9 $QCVT N[3])$TAK3$DRPN
[6]   $GO (3<$R N_(V+3)$DRPN)/lp
[7]  end:R_($DSCR),'=',$DSCCODEACC$"Q
    "
 
$COM  $QCVT      5
$COM  CODEACC    7
$COM  N          0     3     4     5]    5     6_    6
$COM  Q          0     2_    4_    4     7
$COM  R          0_    2_    5_    5     7_    7
$COM  V          0     5_    6
$COM  end        7:
$COM  lp         4:    6
 
 
;'        Function: CODEACC  '
 
 
    " R_CODEACC N
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_'Read' 'Delr' 'Wnew' 'Upd' 'Delf' 'NoList' 'ReAttr' 'Exec' 'Create'
[3]   R_R,'Au' 'AuRd' 'TcTl',6$R '**' '**'
[4]   R_2$DRP$TAK,/' ',',',$"(1 1 $QCVT N)/R
    "
 
$COM  $QCVT   4
$COM  N       0     4
$COM  R       0_    2_    3_    3     4_    4
 
 
;'        Function: CODE06   '
 
 
    " R_CODE06 N;V;Q
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_'Time=' 'Reel=' 'Cross=' 'Inactive=' 'FSN='
[3]   V_(TSDATE UTS 3 36 $QCVT 4$TAKN)(N[4+$I 6])
[4]   V_V,('No' 'Yes')[1+2$TAK1 1 $QCVT N[11]]
[5]   V_V,$ENC$FMT2$DCD4$DRP1 1 $QCVT N[11 12]
[6]   R_$DSCR,$"V
    "
 
$COM  $QCVT     3     4     5
$COM  N         0     3     3]    4]    5]
$COM  Q         0
$COM  R         0_    2_    6_    6
$COM  TSDATE    3
$COM  UTS       3
$COM  V         0     3_    4_    4     5_    5     6
 
 
;'        Function: CODE16   '
 
 
    " R_CODE16 N;V;Q;Z
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_'Form=' 'Device=' 'Dens=' 'RecNo=' 'PageNo=' 'LineNo=' 'PageBase='
[3]   R_R,'Lines=' 'NotCol1=' 'CoMode=' 'NSdev=' 'NSform=' 'NSddf=' 'F01='
[4]   R_R,'F02=' 'Banner_Charges=' 'ContForm=' 'Copies=' 'Banner_Repeats='
[5]   R_R,'SeqCol=' 'SeqID=' 'NBanner_Recs=' 'Dev=' 'WSN=' 'Oldtabs='
[6]   R_R,'StepPageNo=' 'StepRecNo=' 'Dvfc=' 'Width=' 'Good=' 'IWL='
[7]   R_R,'VfcIm.Line=' 'VfcIm.Next='
[8]   V_(6$TAKN)(1$DRP$TAK,/' ',(1 1 $QCVT N[13])/CODEDEVS)($FMT2$DCD6$TAK1 1 $QCVT N[15])
[9]   V_V,($ENC$FMT3 36 $QCVT N[16+$I 4]),$FMT$"3 18 $QCVT N[20+$I 8]
[10]  V_V,('No' 'Yes')[1+1 1 $QCVT N[29]]
[11]  V_V,$FMT$"3 9 $QCVT N[30 31 32]
[12]  V_V,(N[32+$I 4])($FMT3 18 $QCVT N[37 38])(N[39 40])(N[40+$I 8])
[13]  V_V,(CODEUBIN9 N[48+$I 32])($FMT3 18 $QCVT N[81 82])
[14]  V_V,($FMT3 36 $QCVT N[84+$I 4])('''',N[89],'''')($FMT3 9 $QCVT N[90])
[15]  V_V,(('No' 'Yes')[1+$TAKZ]),($ENC$FMT2$DCD1$DRPZ_1 1 $QCVT N[91])
[16]  V_V,(CODEUBIN9 N[92+$I 32])(CODEUBIN9 N[124+$I 32])
[17]  R_$DSCR,$"V
    "
 
$COM  $QCVT        8     8     9     9    10    11    12    13    14    14
$COM              15
$COM  CODEDEVS     8
$COM  CODEUBIN9   13    16    16
$COM  N            0     8     8]    8]    9]    9]   10]   11]   12]   12]
$COM              12]   12]   13]   13]   14]   14]   14]   15]   16]   16]
$COM  Q            0
$COM  R            0_    2_    3_    3     4_    4     5_    5     6_    6
$COM               7_    7    17_   17
$COM  V            0     8_    9_    9    10_   10    11_   11    12_   12
$COM              13_   13    14_   14    15_   15    16_   16    17
$COM  Z            0    15    15_
 
 
;'        Function: CODEDEVS '
 
 
    " R_CODEDEVS
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_'LP' 'CP' 'IC' 'XEQ' 'UCOUT' 'GR' '**' '**' '**'
    "
 
$COM  R   0_    2_
 
 
;'        Function: CODEUBIN9'
 
 
    " R_CODEUBIN9 N;Z
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_(Z$NE' ')/Z_1$DRP,'<,>,I3' $QFMT(1,1$DRP0$NEZ)/Z_3 9 $QCVT N
    "
 
$COM  $QCVT   2
$COM  $QFMT   2
$COM  N       0     2
$COM  R       0_    2_
$COM  Z       0     2     2_    2     2_
 
 
;'        Function: CODE15   '
 
 
    " R_CODE15 N;Z
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_'CGORG=' 'QISS='
[3]   R_$DSCR,$"(CODEORGS[$QAV$I $TAKN]),(('No' 'Yes')[1+1=$TAK1 1 $QCVT N[2]])
    "
 
$COM  $QAV        3
$COM  $QCVT       3
$COM  CODEORGS    3]
$COM  N           0     3     3]
$COM  R           0_    2_    3_    3
$COM  Z           0
 
 
;'        Function: CODE02   '
 
 
    " R_CODE02 N;V
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_'Lslide' 'Lrdlo' 'Spare' 'Slide' 'TdaLvl' 'TDA' 'GDA' 'KEYX' 'KEYL'
[3]   V_$FMT$"$QAV$I 5$TAKN
[4]   V_V,$FMT$"3 27 $QCVT N[,5 9$SC.+$I 3]
[5]   $GO (13>$R N)/ni
[6]   V_V,$ENC$FMT3 18 $QCVT N[13 14]
[7]   V_V,$ENC$FMT$QAV$I N[15]
[8]   $GO ok
[9]  ni:R_-2$DRPR
[10] ok:R_$DSCR,$"'=',$"V
    "
 
$COM  $QAV    3     7
$COM  $QCVT   4     6
$COM  N       0     3     4]    5     6]    7]
$COM  R       0_    2_    9_    9    10_   10
$COM  V       0     3_    4_    4     6_    6     7_    7    10
$COM  ni      5     9:
$COM  ok      8    10:
 
 
;'        Function: CODE03   '
 
 
    " R_CODE03 N;TP;V;Z
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   TP_'Delf' 'Nolist' 'Buf' '**' 'Bad' 'QS' '**' '**' 'Archive' 'Bupm' 'Nbuf'
[3]   TP_TP,'Active' 'Tpb' 'Terminate' 'Fetch' '**' '**' '**'
[4]   V_$ENC($QAV$I $TAKN)$DSCCODEORGS
[5]   R_'Org' 'Ugrans' 'Desc' 'Type' 'Nrecs' 'Rcsz' 'Ngaval' 'Comp' 'Ghstacs'
[6]   R_R,'Lda' 'XTNSIZE' 'Recl' 'Nstamp' 'Expire'
[7]   V_V,$ENC$FMT3 27 $QCVT N[1+$I 3]
[8]   V_V,2$DRP$",/' ',',',$"(Z_1 1 $QCVT N[4+$I 2])/TP
[9]   V_V,$ENCN[7 8]
[10]  V_V,$ENC$FMT3 36 $QCVT N[8+$I 4]
[11]  V_V,$ENC$FMT$QAV$I N[13]
[12]  V_V,$ENC$FMT3 27 $QCVT N[14 15 16]
[13]  V_V,('No' 'Yes')[1+1=$TAKZ_1 1 $QCVT N[17]]
[14]  V_V,$ENC$FMT2$DCD5$DRPZ
[15]  V_V,$ENC$FMT3 27 $QCVT N[17+$I 3]
[16]  V_V,$ENC$FMT3 18 $QCVT N[20+$I 2]
[17]  V_V,$ENC$FMT3 18 $QCVT N[22+$I 2]
[18]  V_V,$ENC$FMT3 36 $QCVT N[24+$I 4]
[19]  V_V,$ENC$FMT3 18 $QCVT N[28+$I 2]
[20]  R_$DSCR,$"'=',$"V
    "
 
$COM  $QAV        4    11
$COM  $QCVT       7     8    10    12    13    15    16    17    18    19
$COM  CODEORGS    4
$COM  N           0     4     7]    8]    9]   10]   11]   12]   13]   15]
$COM             16]   17]   18]   19]
$COM  R           0_    5_    6_    6    20_   20
$COM  TP          0     2_    3_    3     8
$COM  V           0     4_    7_    7     8_    8     9_    9    10_   10
$COM             11_   11    12_   12    13_   13    14_   14    15_   15
$COM             16_   16    17_   17    18_   18    19_   19    20
$COM  Z           0     8_   13_   14
 
 
;'        Function: CODE04   '
 
 
    " R_CODE04 N;V
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_'Access=' 'Modify=' 'Create=' 'Creator='
[3]   V_TSDATE$"UTS$"3 36 $QCVT 12$TAKN
[4]   $GO (13>$R N)/ok
[5]   V_V,$ENC8$TAK12$DRPN
[6]   $GO end
[7]  ok:R_-1$DRPR
[8]   R_$DSCR,$"V
    "
 
$COM  $QCVT     3
$COM  N         0     3     4     5
$COM  R         0_    2_    7_    7     8_    8
$COM  TSDATE    3
$COM  UTS       3
$COM  V         0     3_    5_    5     8
$COM  end       6
$COM  ok        4     7:
 
 
;'        Function: CODE05   '
 
 
    " R_CODE05 N;V;Z
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_'Backup Time=' '       Reel=' 'EFT   Cross=' '        FSN='
[3]   V_$ENCTSDATE UTS$TAK3 36 $QCVT 4$TAKN
[4]   V_V,$ENCN[4+$I 6]
[5]   V_V,('No' 'Yes')[1+1=$TAKZ_1 1 $QCVT N[11]]
[6]   V_V,$ENC$FMT2$DCD-14$TAKZ
[7]   R_$DSCR,$"V
    "
 
$COM  $QCVT     3     5
$COM  N         0     3     4]    5]
$COM  R         0_    2_    7_    7
$COM  TSDATE    3
$COM  UTS       3
$COM  V         0     3_    4_    4     5_    5     6_    6     7
$COM  Z         0     5_    6
 
 
;'        Function: CODENAMES'
 
 
    " R_CODENAMES
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_'CODE01  (Not in Fparam)' 'Code02  (Keyed Files)' 'Code03  (Always Available)'
[3]   R_R,'Code04  (Dates - Access,Modify,Creation)' 'Code05  (Backup Info)'
[4]   R_R,'Code06  (Stow Info)' 'Code07  (Password)' 'Code08  (Altkeys)'
[5]   R_R,'Code09  (Access Controls)' 'Code10  (Access vehicles)'
[6]   R_R,'Code11  (Uattr Info)' 'Code12  (*****)' 'Code13  (Processor)'
[7]   R_R,'Code14  (Account/Directory)' 'Code15  (Comgroup)'
[8]   R_R,'Code16  (Device Attributes)' 'Code17  (FPRG)' 'Code18  (*****)'
[9]   R_R,'Code19  (1-IREL Keys)' 'Code20  (2-IREL Keys)' 'Code21  (VLP_IRREC)'
[10]  R_$DSCR
    "
 
$COM  R   0_    2_    3_    3     4_    4     5_    5     6_    6     7_
$COM      7     8_    8     9_    9    10_   10
 
 
;'        Function: CODEORGS '
 
 
    " R_CODEORGS
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_'*******' 'Consecutive' 'Keyed' 'Random' 'UR' 'Relative' 'Indexed'
[3]   R_R,'IDS' 'Terminal' 'Symb' 'Fprg' 'CG' 'Handler' 'IREL' '**' 'Fixed'
[4]   R_R,'Variable' 'Undef' 'Restrict' 'Free' 'DBGDCB' 'DBGCG' 'DBGSYSID'
[5]   R_R,'SE' 'X364' 'Form' '**' '**' '**' '**' '**' '**'
    "
 
$COM  R   0_    2_    3_    3     4_    4     5_    5
 
 
;'        Function: NB       '
 
 
    " R_NB R
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_(-1+(R$NE' ')$I 1)$DRPR_(1$-(' '$NE$REVR)$I 1)$DRPR
    "
 
$COM  R    0_    0     2_    2     2_    2     2
 
 
;'        Function: OCT      '
 
 
    " R_B OCT N;$QIO;C;D;AV;W
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_0 $DMD $GO (0$NE$QNC 'B')/go $DMD B_0
[3]  go:AV_512$R '.'
[4]   AV[$QAV$I C]_C_'$ !''()*+,/0123456789:;<=>?$_$-'
[5]   AV[$QAV$I C]_C_'@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]'
[6]   AV[$QAV$I C]_C_'abcdefghijklmnopqrstuvwxyz{|}~'
[7]   $GO ($QTT=1)/1+$QLC $DMD AV[AV$I '$_$-']_'_-'
[8]   W_1$MAX-1$TAK((7+17#$I 8)<$QPW)/$I 8 $DMD C_12#W $DMD D_4#W
[9]   R_'01234567'[,$TPS8 8 8$ECD$QAV$I N_,2 9 $QCVT N]
[10]  R_((13#W)$R 0,12$R 1)\(($MAX($R R)%C),C)$R R_(C#$MAX($R R)%C)$TAKR
[11]  R_R,' ','*',((($MAX($R N)%D),D)$R N_(D#$MAX($R N)%D)$TAKN_AV[$QAV$I N]),'*'
[12]  R_'01234567'[$TPS8 8 8 8$ECDB+W#$I 1$TAK$R R],R
    "
 
$COM  $QAV    4     5     6     9    11
$COM  $QCVT   9
$COM  $QIO    0     2_
$COM  $QLC    7
$COM  $QNC    2
$COM  $QPW    8
$COM  $QTT    7
$COM  AV      0     3_    4]_   5]_   6]_   7]_   7    11]
$COM  B       0     2_   12
$COM  C       0     4     4_    5     5_    6     6_    8_   10    10    10
$COM         10
$COM  D       0     8_   11    11    11    11
$COM  N       0     9_    9    11    11_   11    11_   11
$COM  R       0_    9_   10_   10    10_   10    10    11_   11    12_   12
$COM         12
$COM  W       0     8_    8     8    10    12
$COM  go      2     3:
 
 
;'        Function: TSDATE   '
 
 
    " R_TSDATE N;M
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   M_'Jan' 'Feb' 'Mar' 'Apr' 'May' 'June' 'July' 'Aug' 'Sept' 'Oct' 'Nov' 'Dec'
[3]   R_(N[2]$DSCM),' ',($FMTN[3]),', ',($FMTN[1]),' at ',1$DRP,'<:>,ZI2' $QFMT N[4 5 6]
    "
 
$COM  $QFMT   3
$COM  M       0     2_    3
$COM  N       0     3]    3]    3]    3]
$COM  R       0_    3_
 
 
;'        Function: UTS      '
 
 
    " R_UTS R;$QIO;Y;M;D;MD;R1;R2;m;n
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_1
[3]   R1_365+''$R R_0 24 60 60 100$ECDR_R+(R<0)#2*36
[4]   Y_1977+(4#$MINR1%1461)+R2_3$MIN$MIN(1461|R1)%365
[5]   D_366|(1461|R1)+R2
[6]   M_+/(MD_+\0,28+3,(0$NE.=4 100 400|Y),9$R 5$R 3 2)$LED
[7]   D_D$-MD[M]$-1
[8]   R_Y,M,D,1$DRPR
    "
 
$COM  $QIO    0     2_
$COM  D       0     5_    6     7_    7     8
$COM  M       0     6_    7     8
$COM  MD      0     6_    7]
$COM  R       0_    0     3_    3_    3     3     8_    8
$COM  R1      0     3_    4     4     5
$COM  R2      0     4_    5
$COM  Y       0     4_    6     8
$COM  m       0
$COM  n       0
 
 
FITV   _'CODE13   CODE09   CODE10   CODEACC  CODE06   CODE16   CODEDE'
FITV   _FITV   ,'VS CODEUBIN9CODE15   CODE02   CODE03   CODE04   CODE05   COD'
_$QEX $QPNAMES FITV   _$QPACK 19 9$RFITV   ,'ENAMESCODEORGS NB       OCT      TSDATE   UTS      '
' ********  Package:   STATUSV      ********'
 
 
 
 
 
 
;'        Function: VWSSTATUS'
 
 
    " VWSSTATUS F;N
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $Q1_(F[;8]$I $ENC'WSID')$QWSID
[3]   $Q1_(F[;8]$I $ENC'IO')($FMTQIO)
[4]   $Q1_(F[;8]$I $ENC'CT')($QSSR(,'E10.4' $QFMT $QCT)'-' '$-')
[5]   $Q1_(F[;8]$I $ENC'PW')($FMT$QPW)
[6]   $Q1_(F[;8]$I $ENC'PP')($FMT$QPP)
[7]   $Q1_(F[;8]$I $ENC'RL')((-1+(N$NE' ')$I 1)$DRPN_,'I11' $QFMT $QRL)
[8]   $Q1_(F[;8]$I $ENC'LX')$QLX
[9]   $Q1_(F[;8]$I $ENC'WA')($FMT$QWA)
[10]  $Q1_(F[;8]$I $ENC'FNS')($FMT$TAK$R $QNL 3)
[11]  $Q1_(F[;8]$I $ENC'VARS')($FMT0$MAX-2+$TAK$R $QNL 2)
[12]  $Q1_(F[;8]$I $ENC'SI')($FMT0$MAX-2+$R $IB27)
[13]  $Q1_(F[;8]$I $ENC'FNUMS')($FMT$R $QFNUMS)
[14]  $Q1_(F[;8]$I $ENC'SVNAMES')($FMT+/0$NE$QSVO $QNL 2)
[15]  $Q1_(F[;8]$I $ENC'ERROR$_MESSAGE')('  ')
    "
 
$COM  $QCT      4
$COM  $QFMT     4     7
$COM  $QFNUMS  13
$COM  $QLX      8
$COM  $QNL     10    11    14
$COM  $QPP      6
$COM  $QPW      5
$COM  $QRL      7
$COM  $QSSR     4
$COM  $QSVO    14
$COM  $QWA      9
$COM  $QWSID    2
$COM  F         0     2]    3]    4]    5]    6]    7]    8]    9]   10]
$COM           11]   12]   13]   14]   15]
$COM  N         0     7     7_
$COM  QIO       3
 
 
;'        Function: VIO      '
 
 
    " R_VIO N
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   (1 2$R 0 0)$QSM 'VIO'
[3]   R_'The Index$-Origin must be 0 or 1'
[4]   $GO (1$NE$R N_($QVI N)/$QFI N)/0
[5]   R_0/QIO_N
    "
 
$COM  $QFI   4
$COM  $QSM   2
$COM  $QVI   4
$COM  N      0     4_    4     4     5
$COM  QIO    5_
$COM  R      0_    3_    5_
 
 
;'        Function: VCT      '
 
 
    " R_VCT N
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   (1 2$R 0 0)$QSM 'VCT'
[3]   R_'The Comparison$-Tolerance must be between 0 and 1E$-12'
[4]   $QCT_($QVI N)/$QFI N_$QSSR N '$-' '-'
[5]   R_''
    "
 
$COM  $QCT    4_
$COM  $QFI    4
$COM  $QSM    2
$COM  $QSSR   4
$COM  $QVI    4
$COM  N       0     4     4_    4
$COM  R       0_    3_    5_
 
 
;'        Function: VLX      '
 
 
    " R_VLX NN;M;N
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   (1 2$R 0 0)$QSM 'VLX' $DMD N_' ',(-1+NN$I '$COM')$TAKNN_0 $QTSQZ NN
[3]   $GO (1$NE-1$TAKM_~$NE\N='''')/q
[4]   $GO ((0$NE-1$TAK+\(M&N='(')$-M&N=')'),0$NE-1$TAK+\(M&N='[')$-M&N=']')/p b
[5]   $QLX_NN
[6]   $GO 0,R_''
[7]  q:R_'Latent Expression contains unbalanced quotes.' $DMD $GO 0
[8]  p:R_'Latent Expression contains unbalanced parenthesis.' $DMD $GO 0
[9]  b:R_'Latent Expression contains unbalanced brackets.' $DMD $GO 0
    "
 
$COM  $QLX     5_
$COM  $QSM     2
$COM  $QTSQZ   2
$COM  M        0     3_    4     4     4     4
$COM  N        0     2_    3     4     4     4     4
$COM  NN       0     2     2_    2     5
$COM  R        0_    6_    7_    8_    9_
$COM  b        4     9:
$COM  p        4     8:
$COM  q        3     7:
 
 
;'        Function: VPP      '
 
 
    " R_VPP N
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   (1 2$R 0 0)$QSM 'VPP'
[3]   R_'The Print$-Precision must be between 1 and 20'
[4]   $QPP_($QVI N)/$QFI N
[5]   R_''
    "
 
$COM  $QFI   4
$COM  $QPP   4_
$COM  $QSM   2
$COM  $QVI   4
$COM  N      0     4     4
$COM  R      0_    3_    5_
 
 
;'        Function: VPW      '
 
 
    " R_VPW N
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   (1 2$R 0 0)$QSM 'VPW'
[3]   R_'The Print$-Width must be between 30 and 390'
[4]   $QPW_($QVI N)/$QFI N
[5]   R_''
    "
 
$COM  $QFI   4
$COM  $QPW   4_
$COM  $QSM   2
$COM  $QVI   4
$COM  N      0     4     4
$COM  R      0_    3_    5_
 
 
;'        Function: VRL      '
 
 
    " R_VRL N
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   (1 2$R 0 0)$QSM 'VRL'
[3]   R_'The Random Number Seed must be between 1 and 34359738367'
[4]   $QRL_($QVI N)/$QFI N
[5]   R_''
    "
 
$COM  $QFI   4
$COM  $QRL   4_
$COM  $QSM   2
$COM  $QVI   4
$COM  N      0     4     4
$COM  R      0_    3_    5_
 
 
;'        Function: VWSID    '
 
 
    " R_VWSID NM
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   (1 2$R 0 0)$QSM 'VWSID'
[3]   R_'That''s not a legal workspace name!'
[4]   _$XEC')WSID ',NM
[5]   $GO 0,R_''
    "
 
$COM  $QSM   2
$COM  NM     0     4
$COM  R      0_    3_    5_
 
 
;'        Function: WSSTATUS '
 
 
$COM***   WSSTATUS version:  14:31  11/11/86   ***
 
WSSTATUS_1 12$R        1  1 21 40 64 0 ''                                                                      'WSID'          0 (0/0) 'VWSID' (0/0)
WSSTATUS_WSSTATUS,[1] 2  3 15  1  0 0 ''                                                                      'IO'            0 (0/0) 'VIO'   (0/0)
WSSTATUS_WSSTATUS,[1] 3  3 49 21  0 0 ''                                                                      'CT'            0 (0/0) 'VCT'   (0/0)
WSSTATUS_WSSTATUS,[1] 4  4 15  3  0 0 ''                                                                      'PW'            0 (0/0) 'VPW'   (0/0)
WSSTATUS_WSSTATUS,[1] 5  4 49  2  0 0 ''                                                                      'PP'            0 (0/0) 'VPP'   (0/0)
WSSTATUS_WSSTATUS,[1] 6  5 15 11  0 0 ''                                                                      'RL'            0 (0/0) 'VRL'   (0/0)
WSSTATUS_WSSTATUS,[1] 7  6 20 50  0 0 ''                                                                      'LX'            0 (0/0) 'VLX'   (0/0)
WSSTATUS_WSSTATUS,[1] 8  8 22  6  0 0 ''                                                                      'WA'            1 (0/0) ''      (0/0)
WSSTATUS_WSSTATUS,[1] 9  8 49  3  0 0 ''                                                                      'FNS'           1 (0/0) ''      (0/0)
WSSTATUS_WSSTATUS,[1]10  8 65  3  0 0 ''                                                                      'VARS'          1 (0/0) ''      (0/0)
WSSTATUS_WSSTATUS,[1]11  9 25  3  0 0 ''                                                                      'SI'            1 (0/0) ''      (0/0)
WSSTATUS_WSSTATUS,[1]12  9 49  3  0 0 ''                                                                      'FNUMS'         1 (0/0) ''      (0/0)
WSSTATUS_WSSTATUS,[1]13  9 65  3  0 0 ''                                                                      'SVNAMES'       1 (0/0) ''      (0/0)
WSSTATUS_WSSTATUS,[1]14 11  1 69 -8 0 ''                                                                      'ERROR$_MESSAGE' 1 (0/0) ''      (0/0)
WSSTATUS_WSSTATUS,[1]15  1  9 10 32 2 'Workspace:'                                                            '*'           2 (0/0) ''      (0/0)
WSSTATUS_WSSTATUS,[1]16  3  1 13 32 2 'Index$-Origin:'                                                         '*'           2 (0/0) ''      (0/0)
WSSTATUS_WSSTATUS,[1]17  3 27 21 32 2 'Comparison$-Tolerance:'                                                 '*'           2 (0/0) ''      (0/0)
WSSTATUS_WSSTATUS,[1]18  4  1 13 32 2 'Platen$-Width:'                                                         '*'           2 (0/0) ''      (0/0)
WSSTATUS_WSSTATUS,[1]19  4 32 16 32 2 'Print$-Precision:'                                                      '*'           2 (0/0) ''      (0/0)
WSSTATUS_WSSTATUS,[1]20  5  1 12 32 2 'Random$-Seed:'                                                          '*'           2 (0/0) ''      (0/0)
WSSTATUS_WSSTATUS,[1]21  6  1 18 32 2 'Latent$-Expression:'                                                    '*'           2 (0/0) ''      (0/0)
WSSTATUS_WSSTATUS,[1]22  8  1 20 32 2 'Workspace$-Available:'                                                  '*'           2 (0/0) ''      (0/0)
WSSTATUS_WSSTATUS,[1]23  8 29 19 32 2 '(bytes)  Functions:'                                                   '*'           2 (0/0) ''      (0/0)
WSSTATUS_WSSTATUS,[1]24  8 54 10 32 2 'Variables:'                                                            '*'           2 (0/0) ''      (0/0)
WSSTATUS_WSSTATUS,[1]25  9  1 22 32 2 'State$-Indicator Depth:'                                                '*'           2 (0/0) ''      (0/0)
WSSTATUS_WSSTATUS,[1]26  9 42  6 32 2 'Files:'                                                                '*'           2 (0/0) ''      (0/0)
WSSTATUS_WSSTATUS,[1]27  9 57  7 32 2 'Shares:'                                                               '*'           2 (0/0) ''      (0/0)
WSSTATUS_WSSTATUS,[1]28 12  1 69 64 2 '=====================================================================' '*'           2 (0/0) ''      (0/0)
 
 
 
STATUSV_'VWSSTATUSVIO      VCT      VLX      VPP      VPW      VRL   '
_$QEX $QPNAMES STATUSV_$QPACK 9 9$RSTATUSV,'   VWSID    WSSTATUS '
 
 
 
 
;'        Function: ACCDEFN     '
 
 
    " R_ACCDEFN
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_12 6$R '      Read  DelR  Wnew  UpdR  DelF  NolistReattrExec  Fstac Drop  Update'
    "
 
$COM  R    0_    2_
 
 
;'        Function: BUILDNL     '
 
 
    " R_S BUILDNL X;I
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $GO (0=$QNC 'S')/D $DMD S_' ,'
[3]  D:R_(($R I),$MAX/I)$R (,(I_(I$NE0)/I)$SC.$GE$I $MAX/I_-1+(I,1+$R X)$-0,I_(~I)/$I $R I)\R_(I_~X$E S)/X
[4]  $COM
[5]  $COM    THIS FUNCTION TAKES A CHARACTER VECTOR LEFT AND RIGHT
[6]  $COM ARGUMENT AND PRODUCES A CHARACTER MATRIX RESULT.  THE
[7]  $COM LEFT ARGUMENT IS THE LIST OF DELIMITERS, THE RIGHT ARGUMENT
[8]  $COM IS THE NAMES SEPARATED BY DELIMITERS.
    "
 
$COM  $QNC   2
$COM  D      2     3:
$COM  I      0     3     3     3_    3     3     3_    3     3_    3     3
$COM         3_
$COM  R      0_    3_    3_
$COM  S      0     2_    3
$COM  X      0     3     3     3
 
 
;'        Function: COPYRIGHT   '
 
 
    " COPYRIGHT T;O;f;N;I;J;$QIO;V;SM;R;P;Z
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_1
[3]   O_$R T_'$COM*T*  COPYRIGHT, (C) ',T,', ',$FMT1$TAK$QTS
[4]   f_$QNL 3 $DMD Z_0
[5]  n:I_0 $DMD J_1$TAK$R f
[6]  l:$GO (0$E R_$R V_$QCR f[I_I+1;])/lx $DMD SM_$QSM f[I;]
[7]   $GO ('$COM*T* '&.=5$TAKV[2;])/1+$QLC $DMD V_(2$NE$I 1+R[1])$XP1V $DMD SM[;1]_SM[;1]+SM[;1]>0
[8]   $GO (O<R[2])/1+$QLC $DMD V_((1$TAK$R V),R[2]_O)$TAKV
[9]   V[2;]_R[2]$TAKT
[10]  $QFX V $DMD SM $QSM f[I;]
[11] lx:$GO (J$NEI)/l
[12]  $GO (Z$NE0)/p
[13]  P_(2=$TAK$"$R $"$R $"$XEC$"($ENC'$QPNAMES '),$"$ENC[2]P)$RD1P_$QNL 2
[14]  $GO (0$E $R P)/0 $DMD Z_$QIO
[15] np:$GO (0$E $R f_$XEC'(3=$QPNC ',I,')$RD1$QPNAMES ',I_P[Z;])/sp
[16]  $XEC'f $QPDEF ',I $DMD '*** Package: ',I,' ***' $DMD $GO n
[17] p:I_P[Z;] $DMD $XECI,'_',I,' $QPINS $QPACK f' $DMD _$QEX f
[18] sp:$GO (($TAK$R P)$GEZ_Z+1)/np
    "
 
$COM  $QCR   6
$COM  $QEX  17
$COM  $QFX  10
$COM  $QIO   0     2_   14
$COM  $QLC   7     8
$COM  $QNL   4    13
$COM  $QSM   6    10
$COM  $QTS   3
$COM  I      0     5_    6_    6     6    10    11    15    15_   16    16
$COM        17_   17    17
$COM  J      0     5_   11
$COM  N      0
$COM  O      0     3_    8     8
$COM  P      0    13_   13    13_   14    15]   17]   18
$COM  R      0     6_    7]    8]    8]_   9]
$COM  SM     0     6_    7]_   7]    7]   10
$COM  T      0     3_    3     9
$COM  V      0     6_    7]    7_    7     8_    8     8     9]_  10
$COM  Z      0     4_   12    14_   15    17    18_   18
$COM  f      0     4_    5     6]    6]   10]   15_   17
$COM  l      6:   11
$COM  lx     6    11:
$COM  n      5:   16
$COM  np    15:   18
$COM  p     12    17:
$COM  sp    15    18:
 
 
;'        Function: DISPACCESS  '
 
 
    " R_DISPACCESS ACM;$QIO;L;N;NMS;RC;RS;SZ
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_1
[3]   L_'Right argument must be a File Access MATRIX'
[4]   L $QERS((17$NE-1$TAK$R ACM)$OR2$NE$R $R ACM)/1202
[5]   R_(((RC_$TAK$R ACM),8)$R $I 8)#'Y'=0 9$DRPACM
[6]   L_(NMS$NE' ')$MAX.#1+$I -1$TAK$R NMS_ACCDEFN
[7]   L_$MAX/RS_+/SZ_L[1+R]
[8]   R_(,SZ$SC.$GE$I 7)/,',',NMS[1+R;]
[9]   R_0 1$DRP(RC,L)$R (,RS$SC.$GE$I L)\R
[10]  R_(($-+/' '=L)$REVL_0 -9$DRPACM),'=',R
    "
(1 2$R -1 900)$QSM 'DISPACCESS  '
 
$COM  $QERS      4
$COM  $QIO       0     2_
$COM  ACCDEFN    6
$COM  ACM        0     4     4     5     5    10
$COM  L          0     3_    4     6_    7_    7]    9     9    10    10_
$COM  N          0
$COM  NMS        0     6     6_    8]
$COM  R          0_    5_    7     8_    8     9_    9    10_   10
$COM  RC         0     5_    9
$COM  RS         0     7_    9
$COM  SZ         0     7_    8
 
 
;'        Function: DISPRECFIELD'
 
 
    " R_DISPRECFIELD N;$QIO;A
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_1
[3]   R_RECFDTYPES[N[;1]+1;]
[4]   R_'?' REPCHAR R(N[;2])
[5]   R_'&' REPCHAR R(N[;3])
    "
 
$COM  $QIO          0     2_
$COM  A             0
$COM  N             0     3]    4]    5]
$COM  R             0_    3_    4_    4     5_    5
$COM  RECFDTYPES    3]
$COM  REPCHAR       4     5
 
 
;'        Function: FILES    '
 
 
    " FILES;Tie;FFNUMS;FFIDS;FFOPTS;IN;MAXFID;FSTAT;FSEL;FSCR;FERR;FCH;CHANGE;WSFILES;FATTRS;FNUM;FOPEN;FPROCESS;FSTRM;VFILEINIT;VFILES;VFOPTS
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QPDEF FILEV $DMD WSFILES FORMPUT 1 $DMD FERR_0/FCH_1
[3]   VFILEINIT WSFILES       $COM Init: MAXFID, FFNUMS, FFIDS, FFOPTS, FSCR
[4]   FSEL_VFILES WSFILES $DMD CHANGE_0
[5]  lp:IN_WSFILES FORMREAD 1,FERR,FSEL
[6]   $GO (0$NE$R ,FERR_FPROCESS IN)/lp
[7]   $GO (0$NECHANGE)/lp
[8]   FORMRLS 1
    "
 
$COM  $QPDEF       2
$COM  CHANGE       0     4_    7
$COM  FATTRS       0
$COM  FCH          0     2_
$COM  FERR         0     2_    5     6_
$COM  FFIDS        0
$COM  FFNUMS       0
$COM  FFOPTS       0
$COM  FILEV        2
$COM  FNUM         0
$COM  FOPEN        0
$COM  FORMPUT      2
$COM  FORMREAD     5
$COM  FORMRLS      8
$COM  FPROCESS     0     6
$COM  FSCR         0
$COM  FSEL         0     4_    5
$COM  FSTAT        0
$COM  FSTRM        0
$COM  IN           0     5_    6
$COM  MAXFID       0
$COM  Tie          0
$COM  VFILEINIT    0     3
$COM  VFILES       0     4
$COM  VFOPTS       0
$COM  WSFILES      0     2     3     4     5
$COM  lp           5:    6     7
 
 
;'        Function: FIT      '
 
 
    " FIT N;CMDS;DOCT;F;NC;CODES;FH;FN;FF;PROMPT;IN;Q;Z;CODE02;CODE03;CODE04;CODE05;CODE06;CODE09;CODE10;CODE13;CODE15;CODE16;CODEACC;CODEDEVS;CODEUBIN9;CODENAMES;CODEORGS;NB;OCT;TSDATE;UTS
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $GO ((1=$R ,N)&1$GE$R $R N)/ok
[3]   'Only one file stream at a time!' $DMD $GO 0
[4]  ok:$GO (N$E $QFNUMS)/gf
[5]   'That file stream is not open' $DMD $GO 0
[6]  gf:F_$QFFIT N $DMD $QPDEF FITV $DMD DOCT_0
[7]   NC_2$DCD5$TAK1 1 $QCVT$TAKF $DMD CMDS_'END' 'QUIT' 'OCTAL' 'DOCTAL' 'NOCTAL' 'HELP'
[8]   CODES_2$DCD$TPS(FH_1 1 $QCVT(NC,4)$R F[4+$I 4#NC])[;$I 5]
[9]   CODES_CODES,[1.5]2$DCD$TPSFH[;6+$I 10]
[10]  CODES_CODES,2$DCD$TPSFH[;16+$I 10]
[11]  CODES_CODES,2$DCD$TPSFH[;26+$I 10] $DMD PROMPT_'Enter Fparam Number: '
[12] lp:' ' $DMD $QQ_PROMPT $DMD FF_F $DMD $GO (0$NEIN_NB$QQ)/anlz
[13]  'Available Codes are:'
[14]  CODENAMES[CODES[;1];],' ',$FMTCODES $DMD $GO lp
[15] anlz:$GO (((1$MAX$R IN)$TAK$"CMDS)$EQV$"$ENCIN)/0 0 oct do no help
[16]  $GO ((0$OR.=$QVI IN)$OR1$NE$R Z_$QFI IN)/er
[17]  $GO (~Z$E CODES[;1])/ern $DMD Q_CODES[;1]$I Z
[18]  FF_F[(CODES[Q;4]#4)+$I CODES[Q;3]#4] $DMD ' ' $DMD CODENAMES[Z;]
[19]  $GO (3$NE$QNC FN_'CODE',,'ZI2' $QFMT Z)/erh
[20]  $XECFN,' FF' $DMD $GO DOCT/oct $DMD $GO lp
[21] do:DOCT_1 $DMD $GO lp
[22] no:DOCT_0 $DMD $GO lp
[23] help:'Commands are:'
[24]  'END     ...   Exit this program'
[25]  'OCTAL   ...   Display entire FIT in octal'
[26]  'DOCTAL  ...   Formatted displays include octal'
[27]  'NOCTAL  ...   Formatted display exclude octal (default)'
[28]  'HELP    ...   This message'
[29]  'or an integer number to display a particular FIT entry' $DMD $GO lp
[30] er:'A single legal Fparam number must be entered.' $DMD $GO lp
[31] ern:'File: ''',($QFID N),''' does not contain that fparam number.'
[32]  $GO lp
[33] erh:'I don''t understand how to format a ''',FN,''' entry.'
[34] oct:OCT FF $DMD $GO lp
    "
 
$COM  $QCVT        7     8
$COM  $QFFIT       6
$COM  $QFI        16
$COM  $QFID       31
$COM  $QFMT       19
$COM  $QFNUMS      4
$COM  $QNC        19
$COM  $QPDEF       6
$COM  $QVI        16
$COM  CMDS         0     7_   15
$COM  CODEACC      0
$COM  CODEDEVS     0
$COM  CODENAMES    0    14]   18]
$COM  CODEORGS     0
$COM  CODES        0     8_    9_    9    10_   10    11_   11    14]   14
$COM              17]   17]   18]   18]
$COM  CODEUBIN9    0
$COM  CODE02       0
$COM  CODE03       0
$COM  CODE04       0
$COM  CODE05       0
$COM  CODE06       0
$COM  CODE09       0
$COM  CODE10       0
$COM  CODE13       0
$COM  CODE15       0
$COM  CODE16       0
$COM  DOCT         0     6_   20    21_   22_
$COM  F            0     6_    7     8]   12    18]
$COM  FF           0    12_   18_   34
$COM  FH           0     8_    9]   10]   11]
$COM  FITV         6
$COM  FN           0    19_   20    33
$COM  IN           0    12_   15    15    16    16
$COM  N            0     2     2     4     6    31
$COM  NB           0    12
$COM  NC           0     7_    8     8
$COM  OCT          0    34
$COM  PROMPT       0    11_   12
$COM  Q            0    17_   18    18
$COM  TSDATE       0
$COM  UTS          0
$COM  Z            0    16_   17    17    18    19
$COM  anlz        12    15:
$COM  do          15    21:
$COM  er          16    30:
$COM  erh         19    33:
$COM  ern         17    31:
$COM  gf           4     6:
$COM  help        15    23:
$COM  lp          12:   14    20    21    22    29    30    32    34
$COM  no          15    22:
$COM  oct         15    20    34:
$COM  ok           2     4:
 
 
;'        Function: FORMPUT  '
 
 
    " {R}_F FORMPUT N;P;W;$QIO
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_1 $DMD (2 2$R de de io,[1.5]4 7 30)$QSM 'FORMPUT'
[3]   P_'$Q1$Q2$Q3$Q4$Q5$Q6$Q7$Q8$Q9$Q0'[$TAKN]
[4]   W_,'ZI2,<,FWIN=UC01>' $QFMT 10+$TAKN
[5]   $GO (0=$R R_1$DRPN)/go $DMD W_,'ZI2' $QFMT$TAKR
[6]  go:$XEC')SET ',P,' UC',W,',ORG=FORM,WLEN=',$FMT$MAX/F[;2]
[7]   ((($TAK$R F),7)$TAKF)$QBFLD N
[8]   $GO 0
[9]  de:$GO 0,R_4
[10] io:$GO 0,R_(3 2 4 5)[1051 1401 113$I $QFI $QERX[5+$I 5]]
    "
 
$COM  $QBFLD   7
$COM  $QERX   10]
$COM  $QFI    10
$COM  $QFMT    4     5
$COM  $QIO     0     2_
$COM  $QSM     2
$COM  F        0     6]    7     7
$COM  N        0     3     4     5     7
$COM  P        0     3_    6
$COM  R        0     5_    5     9_   10_
$COM  W        0     4_    5_    6
$COM  de       2     2     9:
$COM  go       5     6:
$COM  io       2    10:
 
 
;'        Function: FORMREAD '
 
 
    " R_f FORMREAD S;A;E;G;M;N;P;Q;T;W;X;Y;Z
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   G_P_,R_W_0 2$R Y_0 $DMD M_'<$TAKR[>,Q<;2]>I6' $DMD Q_$R f $DMD Z_$TAKS
[3]   A_'$Q0$Q1$Q2$Q3$Q4$Q5$Q6$Q7$Q8$Q9'[1+Z]
[4]   $GO (0=$R S_(1$DRP,S),(1$GE$R ,S)/(f[;9]<1)/f[;1])/0
[5]  lp:(P,S)$QBSFLD Z $DMD R_$XECA $DMD $GO (Q[2]<11)/0
[6]   G_(($TAK$R R)$R 1),(N_~W[;1]$E R[;1])/G $DMD R_R,[1]N$RD1W
[7]   T_G&(E_$DSCf[N_f[;1]$I R[;1];11])$OR.$NE' '
[8]   E_$XEC$"$ENC[2]T$RD1E,M $QFMT$I $TAK$R R
[9]   $GO (0=$R N_(T\X_0$NE$TAK$"$R $"E)/N)/x
[10]  P_f[$TAKN;1] $DMD W_R $DMD G_R[;1]$E f[N;1]
[11]  $GO (Q[1]<T_f[;8]$I $ENC'ERROR$_MESSAGE')/q
[12]  $XECA,'_(Y_f[T;1]),1$TAK X/E' $DMD $GO lp
[13] q:$Q_$TAKX/E $DMD $GO lp
[14] x:$GO (Y=0)/0 $DMD Y $QBXFLD Z 3
    "
 
$COM  $Q       13_
$COM  $QBSFLD   5
$COM  $QBXFLD  14
$COM  $QFMT     8
$COM  A         0     3_    5    12
$COM  E         0     7_    8_    8     9    13
$COM  G         0     2_    6_    6     7    10_
$COM  M         0     2_    8
$COM  N         0     6_    6     7_    9_    9    10    10
$COM  P         0     2_    5    10_
$COM  Q         0     2_    5]   11]
$COM  R         0_    2_    5_    6     6]    6_    6     7]    8    10
$COM           10]
$COM  S         0     2     4_    4     4     5
$COM  T         0     7_    8     9    11_
$COM  W         0     2_    6]    6    10_
$COM  X         0     9_   13
$COM  Y         0     2_   14    14
$COM  Z         0     2_    3     5    14
$COM  f         0     2     4]    4]    7]    7]   10]   10]   11]
$COM  lp        5:   12    13
$COM  q        11    13:
$COM  x         9    14:
 
 
;'        Function: FORMRLS  '
 
 
    " {R}_F FORMRLS N;P;Q;W
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $GO (0=$R N)/R_0
[3]   _$QBCLOSE$"N
[4]   $GO 0
    "
 
$COM  $QBCLOSE   3
$COM  F          0
$COM  N          0     2     3
$COM  P          0
$COM  Q          0
$COM  R          0     2_
$COM  W          0
 
 
;'        Function: FWRITERR '
 
 
    " F FWRITERR M;T
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $GO (($TAK$R F)<T_F[;8]$I $ENC'ERROR$_MESSAGE')/q
[3]   $Q1_(F[T;1])($QSSR M($QAV[14])' ')
[4]   $GO 0
[5]  q:$Q_M $DMD $GO 0
    "
 
$COM  $Q      5_
$COM  $QAV    3]
$COM  $QSSR   3
$COM  F       0     2     2]    3]
$COM  M       0     3     5
$COM  T       0     2_    3
$COM  q       2     5:
 
 
;'        Function: FUNCLIST    '
 
 
    " FUNCLIST;X;$QIO;I;J;n;s;P;V;Z;$QPW;$QPP
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_1 $DMD $QPW_300 $DMD J_-1$TAK$RX_$QNL 3 $DMD Z_I_0 $DMD s_3 1$R' '
[3]   J_$TAK$RX_(&/X$OR.$NE$TPS(2,J)$TAK2 8$R'FUNCLISTXREF    ')$RD1X
[4]   (1 2$RE,35)$QSM 'FUNCLIST' $COM  SIDETRACK ON DEFN ERROR
[5]   V_$XEC')TERM OUTPUT 4' $DMD ')TERM INPUT 4' $DMD $QPP_16
[6]  L:$GO(J<I_I+1)/xx $DMD s $DMD ';''        Function: ',X[I;],'''' $DMD ' ' $DMD ' '
[7]   V_$XEC'"',X[I;],'[$Q]"'
[8]   (~($I($RV)+$Rn)$E($I$Rn)+n_((~$NE\''''=V)&V$E'$E$O$I$R$GO')/$I$RV)\V
[9]   (0$NE$R($QSSS(V;'$QERS')),$QSSS(V;'CHECK '))/'(1 2$R -1 900)$QSM ','''',X[I;],''''
[10]  $QPW_73 $DMD V_' ',[$QIO]'$COM',' ',' ',XREF X[I;] $DMD $QPW_300 $DMD V
[11]  $QVFC '0' $DMD $GOL
[12] E:'''',X[I;],' *** NOT LISTED ***''' $DMD $QVFC '0' $DMD $GOL
[13] xx:s $DMD $GO(Z$NE0)/p
[14]  P_(2=$TAK$"$R$"$R$"$XEC$"($ENC'$QPNAMES '),$"$ENC[2]P)$RD1P_$QNL 2
[15]  $GO(0$E$RP)/xxx $DMD Z_$QIO
[16] np:$XEC'$QPDEF ',V_P[Z;] $DMD J_$TAK$RX_$XEC'$QPNAMES ',V $DMD I_0
[17]  ''' ********  Package:   ',V,'      ********''' $DMD s $DMD $GOL
[18] p:J_$RX_$XEC'$QPNAMES ',V_P[Z;] $DMD I_0 $DMD $GO(60>$RX_,X)/px
[19] pl:V,'_',(I/V,','),'''',(60$TAKX),'''' $DMD I_1
[20]  $GO(60<$RX_60$DRPX)/pl
[21] px:'_$QEX $QPNAMES ',V,'_$QPACK ',($FMTJ),'$R',(I/V,','),'''',X,''''
[22]  $GO(($TAK$RP)$GEZ_Z+1)/np
[23] xxx:'$QPP_10' $DMD '$QCT_',$FMT$QCT $DMD '$QLX_''',$QLX,''''
[24]  '$QPW_80'
[25]  '$XEC '')TERM INPUT '',$FMT $QTT' $DMD V_$XEC')TERM OUTPUT ',$FMT$QTT
[26]  ')SET INPUT ME'
    "
 
$COM $QCT   23
$COM $QIO    0     2_   10    15
$COM $QLX   23
$COM $QNL    2    14
$COM $QPP    0     5_
$COM $QPW    0     2_   10_   10_
$COM $QSM    4
$COM $QSSS   9     9
$COM $QTT   25
$COM $QVFC  11    12
$COM E       4    12:
$COM I       0     2_    6_    6     6     7     9    10    12    16_   18_
$COM        19    19_   21
$COM J       0     2_    3_    3     6    16_   18_   21
$COM L       6:   11    12    17
$COM P       0    14_   14    14_   15    16]   18]   22
$COM V       0     5_    7_    8     8     8     8     8     9     9    10_
$COM        10    16_   16    17    18_   19    19    21    21    25_
$COM X       0     2_    3_    3     3     6]    7]    9]   10]   12]   16_
$COM        18_   18_   18    19    20_   20    21
$COM XREF   10
$COM Z       0     2_   13    15_   16    18    22_   22
$COM n       0     8     8     8_
$COM np     16:   22
$COM p      13    18:
$COM pl     19:   20
$COM px     18    21:
$COM s       0     2_    6    13    17
$COM xx      6    13:
$COM xxx    15    23:
 
 
;'        Function: GENACCESS   '
 
 
    " R_GENACCESS ACM;ACC;ACL;I;NM;NN;SEP;ROWS;T;$QIO
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_1
[3]   $GO ((2$NE$R $R ACM),,1$OR.$NE+/ACM='=')/erm erq $DMD ROWS_$TAK$R ACM
[4]   ACM_(+/&\' '=ACM)$REVACM
[5]   $GO (0=ACL_9$MIN(ACM='=')$MAX.#-1+$I -1$TAK$R ACM)/erq
[6]   ACC_(ROWS,9)$R (T_,ACL$SC.$GE$I 9)\(,ACL$SC.$GE$I -1$TAK$R ACM)/,ACM
[7]   ACM_($R ACM)$R T\(T_,(ACL+1)$SC.<$I -1$TAK$R ACM)/,ACM
[8]   ACM_(+/&\ACM=' ')$REVACM
[9]   NM_TRUP(,SEP_~ACM$E ' ,;')/,ACM_' ',($OR$RD1ACM$NE' ')/ACM
[10]  I_-1+(1$DRPI,1+$R ,ACM)$-I_(~,SEP)/$I $R ,SEP
[11]  NN_10#(T_I$NE0)/(~,SEP)/,$TPS($REV$R SEP)$R $I $TAK$R SEP
[12]  NM_(($R I),$MAX/0,I)$R (,I$SC.$GE$I $MAX/0,I_T/I)\NM
[13]  $GO (1$NE+$RD1T_(TRUP ACCDEFN)&.=$TPS(($TAK$R NM),6)$TAKNM)/ero
[14]  T_(0 1 2 3 4 5 6 7 8 7 2 4)[($I $TAK$R T)$MAX.#T]
[15]  R_ACC,'NY'[1+((10#$I $TAK$R ACC)$SC.+$I 8)$E NN+T]
[16]  $GO 0
[17] erq:'Row Syntax:   account=priv,priv,priv' $QERS 1201
[18] ero:('Illegal access permision: ',1$DRP,',',(1$NE+$RD1T)$RD1NM)$QERS 1201
[19] erm:'Right argument must be a matrix' $QERS 1201
    "
(1 2$R -1 900)$QSM 'GENACCESS   '
 
$COM  $QERS     17    18    19
$COM  $QIO       0     2_
$COM  ACC        0     6_   15    15
$COM  ACCDEFN   13
$COM  ACL        0     5_    6     6     7
$COM  ACM        0     3     3     3     4_    4     4     5     5     6
$COM             6     7_    7     7     7     8_    8     8     9     9_
$COM             9     9    10
$COM  I          0    10_   10    10_   11    12    12    12    12_   12
$COM  NM         0     9_   12_   12    13    13    18
$COM  NN         0    11_   15
$COM  R          0_   15_
$COM  ROWS       0     3_    6
$COM  SEP        0     9_   10    10    11    11    11
$COM  T          0     6_    7     7_   11_   12    13_   14_   14    14
$COM            15    18
$COM  TRUP       9    13
$COM  erm        3    19:
$COM  ero       13    18:
$COM  erq        3     5    17:
 
 
;'        Function: GENRECFIELD '
 
 
    " RM_GENRECFIELD M;ROWS;T;CL;I;J;NM;NN;SEP;TY;R;DEFLENS;TYPEOPTN
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   (1 2$R era 0)$QSM 'GENRECFIELD'
[3]   DEFLENS_36 8 36 4 8 63 16 16 16 $DMD TYPEOPTN_0 32 0 8 0 2 0 4 0 1 16
[4]   ROWS_$TAK$R M
[5]   M_(+/&\' '=M)$REVM
[6]   CL_9$MIN(<\(M,' ')$E ' ,;().=:+*')$MAX.#-1+$I 1+-1$TAK$R M
[7]   R_(ROWS,9)$R (T_,CL$SC.$GE$I 9)\TRUP(,CL$SC.$GE$I -1$TAK$R M)/,M
[8]   M_($R M)$R T\(T_,CL$SC.<$I -1$TAK$R M)/,M
[9]   $GO (~0$E R_($I 9)$MAX.#RECFTYPES&.=$TPSR)/tok
[10]  '*** Unknown types: ',1$DRP,',',(T_0=R)$RD1R
[11]  '***                found on lines: ',$FMTT/$I $R R
[12]  M_(~T)$RD1M $DMD R_(~T)/R
[13] tok:M_(+/&\M=' ')$REVM
[14]  T_$OR$RD1M$NE' '
[15]  M_' ',(($OR\T)&$REV$OR\$REVT)/M
[16]  NM_TRUP(,SEP_(0<+\(M='(')$-M=')')$OR~M$E ' ,;.')/,M
[17]  I_12$MIN-1+(1$DRPI,1+$R ,M)$-I_(~,SEP)/$I $R ,SEP
[18]  NN_(T_I$NE0)/(~,SEP)/,$TPS($REV$R SEP)$R $I ROWS
[19]  NM_(($R I),12)$R (,(I_(I$NE0)/I)$SC.$GE$I 12)\NM
[20]  T_NM[;1]$NE'('
[21]  $GO (0$E +$RD1I_RECFOPTS&.=$TPST$RD1NM)/ero
[22]  $GO (,CL_I&~$TPSRECFTYPECHK[T/R[NN];])/et
[23]  J_$MAX/0,SEP_+/($I ROWS)$SC.=T/NN $DMD CL_$R SEP
[24]  RM_(,RECFTYPEMAPS)[(64#R$-1)+1++/(CL,J)$R (,SEP$SC.$GE$I J)\TYPEOPTN[($I 11)$MAX.#I]]
[25]  $GO ((RM$OR.<0),1$OR.<SEP_+/($I ROWS)$SC.=(~T)/NN)/erc erp
[26]  RM_RM,SEP$XP11 0$DRP$DSC$XEC$"($ENC'0 0 0'),$ENC[2](~T)$RD1NM
[27]  RM[J/$I ROWS;2]_(J_RM[;2]=0)/DEFLENS[R]
[28]  RM[((22=RM[;1])&511<RM[;2])/$I ROWS;1]_56
[29]  $GO 0
[30] ero:'Unknown option: ',1$DRP,',',(0=+$RD1I)$RD1T$RD1NM $DMD $GO er
[31] et:'Illegal Option/Type combination on line: ',$FMT(M_$OR$RD1CL)/NN
[32]  '    Incorrect Option: ',1$DRP,',',M$RD1T$RD1NM $DMD $GO er
[33] erp:'Line ',($FMT(1<SEP)/$I ROWS),' contains illegal parenthesis'
[34]  $GO er
[35] era:'Incorrect data size in Parenthesis' $DMD $GO er
[36] erc:'Conflicting options on line: ',(RM<0)/$I ROWS
[37] er:$QEX 'RM' $DMD $GO 0
    "
 
$COM  $QEX           37
$COM  $QSM            2
$COM  CL              0     6_    7     7     8    22_   23_   24    31
$COM  DEFLENS         0     3_   27]
$COM  I               0    17_   17    17_   18    19    19_   19    19
$COM                 21_   22    24    30
$COM  J               0    23_   24    24    27    27_
$COM  M               0     4     5_    5     5     6     6     7     7
$COM                  8_    8     8     8    12_   12    13_   13    13
$COM                 14    15_   15    16    16    16    16    17    31_
$COM                 32
$COM  NM              0    16_   19_   19    20]   21    26    30    32
$COM  NN              0    18_   22    23    25    31
$COM  R               0     7_    9_    9    10    10    11    12_   12
$COM                 22]   24    27
$COM  RECFOPTS       21
$COM  RECFTYPECHK    22]
$COM  RECFTYPEMAPS   24
$COM  RECFTYPES       9
$COM  RM              0_   24_   25    26_   26    27]_  27]   28]_  28]
$COM                 28]   36
$COM  ROWS            0     4_    7    18    23    25    27    28    33
$COM                 36
$COM  SEP             0    16_   17    17    18    18    23_   23    24
$COM                 25_   26    33
$COM  T               0     7_    8     8_   10_   11    12    12    14_
$COM                 15    15    18_   20_   21    22    23    25    26
$COM                 30    32
$COM  TRUP            7    16
$COM  TY              0
$COM  TYPEOPTN        0     3_   24]
$COM  er             30    32    34    35    37:
$COM  era             2    35:
$COM  erc            25    36:
$COM  ero            21    30:
$COM  erp            25    33:
$COM  et             22    31:
$COM  tok             9    13:
 
 
;'        Function: HELP        '
 
 
    " HFID HELP N;$QIO;NOKEY;AV;CNTR;CR;K;KEY;KV;L;PKEY;POS;PX;RKEY;RPK;STREAM;LN;LR;DR;FF;X0;LOOP;PW;RA
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_1 $DMD STREAM_282144 $DMD (bfd keyerr,[1.5]73 79)$QSM 'HELP'
[3]   AV_$QAV $DMD AV[96+$I 26]_AV[64+(32#$QTT$NE1)+$I 26]
[4]   AV[198 217,($QTT$NE1)/207 206]_$QAV[36 96,($QTT$NE1)/46 35]
[5]   $GO (0$NE$QNC 'HFID')/f $DMD HFID_'HELP:APLANAR:.X' $COM Get HELP process
[6]  f:HFID_HFID,',IN,DIRECT' $DMD FF_$QAV[512] $DMD X0_$QAV[1]
[7]   K_+\(N='(')$-N=')'
[8]   $GO (((K$OR.>1)$ORK$OR.<0),~$OR/K)/er,nofid
[9]   $QFCLOSE(STREAM$E $QFNUMS)/STREAM
[10]  PX_1$DRP(K&N$NE' ')/N
[11]  HFID_'HELP:',(L$TAKPX),':',((L_-1+PX$I '.')$DRPPX),',IN,DIRECT'
[12]  N_(~K$OR0,-1$DRPK)/N $DMD $GO ('?'$E HFID)/files
[13] nofid:$GO (STREAM$E $QFNUMS)/gotfid $DMD HFID $QFOPEN STREAM
[14] $COM Obtain TOPIC and possibly Sub-TOPIC
[15] gotfid:PKEY_$TAKN_$QTLEX N ' ' '$-' '''''' $DMD DR_'$-'=''$R $TAK1$DRPN
[16]  $GO (('?'=$TAKPKEY),'TOPICS'$EQVPKEY)/qu,topics
[17]  CNTR_3$R X0 $DMD PX_512
[18] $COM  Process TOPIC, determine True KEY in file
[19]  NOKEY_su $DMD RPK_-3+$R RKEY_PKEY,CNTR
[20]  L_$QFREAD(STREAM;PKEY,(0=$R PKEY)/0;0 3) $DMD $GO ((0=$R PKEY),1)/sb,gs
[21] su:NOKEY_not $DMD L_$QFREAD STREAM '' 0 3
[22]  $GO (PKEY$OR.$NERPK$TAKK_-3$DRPKEY_2 9 $QCVT $QFRKEY STREAM,2)/not
[23]  RPK_$R PKEY_K $DMD RKEY_KEY
[24]  $GO (0=3 27 $QCVT -3$TAKKEY)/sb
[25] gs: $COM  Topic is a Synonym.
[26]  NOKEY_not $DMD RPK_$R PKEY_-3$DRPRKEY_L,CNTR
[27]  L_$QFREAD(STREAM RKEY 0 3)
[28] sb: $COM  Locate Sub-topic if specified
[29]  $GO (0=$R N_1$DRPN)/start $DMD $GO (~DR)/sbt
[30]  RA_31$R FF $DMD PX_10000000000 $DMD $GO (0=$R N_1$DRPN)/start
[31]  RA_$TAKN $DMD RA[$R RA]_$QAV[511$MIN1+$QAV$I -1$TAKRA] $DMD $GO start
[32] sbt:NOKEY_nst $DMD KV_$R K_PKEY,' ',$TAKN
[33]  L_$QFI 5$TAK$QFREAD(STREAM K 0 3) $DMD $GO gst
[34] nst:NOKEY_est $DMD L_$QFI 5$TAK$QFREAD STREAM '' 0 3
[35]  $GO (K$OR.$NEKV$TAK2 9 $QCVT $QFRKEY STREAM,2)/est
[36] gst:PX_512#1+1$TAKL $DMD NOKEY_est
[37]  L_$QFREAD(STREAM(PKEY,1$DRP2 9 $QCVT PX$-512)0 3) $DMD $GO start
[38] est:AV $QXL ' No such Sub-topic.' $DMD PX_512
[39]  NOKEY_er $DMD L_$QFREAD(STREAM RKEY 0 3)
[40] start: $COM Main LOOP Start, L := 1st line, PKEY := Topic
[41]  NOKEY_dx $DMD RPK_$R PKEY_-3$DRP2 9 $QCVT $QFRKEY STREAM,2
[42] lp:AV $QXL L
[43]  L_$QFREAD STREAM '' 0 3
[44]  KV_3 -27 $QCVT -3$TAKKEY_2 9 $QCVT LR_$QFRKEY STREAM,2
[45]  $GO ((PKEY$OR.$NERPK$TAKKEY)$OR(PX$LEKV)$ORRPK$NE-3+$R KEY)/done
[46]  RKEY_LR $DMD $GO lp
[47] done:$GO (~DR)/dx $DMD NOKEY_gnt $DMD L_$QFREAD STREAM(PKEY,' ',9$R FF)0 3
[48] gnt:NOKEY_dx $DMD L_$QFREAD STREAM '' 0 3
[49]  KEY_$QFRKEY STREAM 2 $DMD $GO (0$NE3 27 $QCVT -3$TAKKEY)/gnt
[50]  RPK_$R PKEY_-3$DRPKEY $DMD $GO (1=$TAK$QSCP RA PKEY)/dx
[51]  ' ' $DMD $GO lp
[52] dx:' ' $DMD NOKEY_0 $DMD L_$QFREAD STREAM RKEY 0 3
[53]  $GO 0
[54] qu: $COM Handle ? and ??
[55]  RPK_$R PKEY_-3$DRPKEY_2 9 $QCVT RKEY_$QFRKEY STREAM,2
[56]  PX_1024+512#$MIN(3 -27 $QCVT -3$TAKKEY)%512
[57]  NOKEY_nomore $DMD L_$QFREAD STREAM '' 0 3
[58]  KV_3 -27 $QCVT -3$TAKKEY_2 9 $QCVT $QFRKEY STREAM,2
[59]  $GO ((PKEY$OR.$NERPK$TAKKEY)$ORRPK$NE-3+$R KEY)/nomore
[60]  RKEY_$QFRKEY STREAM,2 $DMD NOKEY_dx $DMD DR_0
[61]  PX_PX+100000000#'?'=K_1$TAK1$DRP$TAKN
[62]  $GO (' ?'$OR.=K)/lp $DMD $GO er
[63] topics:K_0$R KV_' ' $DMD CR_$QAV[14] $DMD L_N $DMD PX_10+N_POS_0 $DMD LN_30$R FF
[64]  $GO (0=$R L_1$DRPL)/LOOP_tl $DMD KV_$TAKL $DMD $GO ((1$NE$R L)$OR'?'$E KV)/tr
[65]  RKEY_$R PKEY_KV $DMD NOKEY_tu
[66]  L_$QFREAD STREAM PKEY 0 3 $DMD $GO gts
[67] tu:NOKEY_not $DMD L_$QFREAD STREAM '' 0 3
[68]  $GO (~PKEY$EQVRKEY$TAKK_-3$DRPKEY_2 9 $QCVT $QFRKEY STREAM 2)/not
[69]  RKEY_$R PKEY_K
[70]  $GO (0=3 27 $QCVT -3$TAKKEY)/gt
[71] gts:NOKEY_not $DMD RKEY_$R PKEY_-3$DRPKEY_L
[72]  L_$QFREAD STREAM(PKEY,3$R X0)0 3
[73] gt:LOOP_stl $DMD K_'' $DMD NOKEY_stl $DMD _$QFREAD STREAM(PKEY,' ')0 3
[74] stl:NOKEY_td $DMD L_$QFREAD STREAM '' 0 3
[75]  $GO ((~PKEY$EQVRKEY$TAKKEY_2 9 $QCVT $QFRKEY STREAM 2),0$OR.=$QVI L)/td stl
[76]  KV_(RKEY$DRPKEY),'   ' $DMD $GO trv
[77] tr:KV_($-'?'=-1$TAKKV)$DRPKV $DMD KV[$R KV]_$QAV[1$MAX-1+$QAV$I RA_-1$TAKKV]
[78]  LN_KV $DMD LN[$R LN]_$QAV[1$MAX1+$QAV$I RA] $DMD KV_31$TAKKV,31$R FF
[79]  $GO (0=$R L_1$DRPL)/LOOP_tl $DMD LN_30$R FF
[80]  $GO (0=$R L_('$-'=$TAK$TAKL)$DRPL)/tl $DMD LN_31$TAK($TAKL),LN
[81] tl:NOKEY_et $DMD L_$QFREAD(STREAM(KV,N/' ',3$R FF)0 3)
[82] et:NOKEY_td $DMD L_$QFREAD STREAM '' 0 3 $DMD KV_$QFRKEY STREAM,2
[83]  $GO (2=$TAK$QSCP(KV_(0=$TAK0/KV)$DRP2 9 $QCVT KV)LN)/td
[84]  $GO (0$NE3 -27 $QCVT -3$TAKKV)/tl
[85] trv:K_K,((L_$QPW<POS+RPK+6)/CR),(RPK_PX#$MAX(1+$R KV)%PX)$TAKKV_-3$DRPKV
[86]  POS_RPK+POS#~L $DMD N_1 $DMD $GO LOOP
[87] td:AV $QXL K
[88]  $GO 0
[89] files:$GO (((' '$OR.$NEN)$OR1<+/HFID='?'),'.'$E HFID)/ef fl $DMD HFID_((-1+HFID$I ',')$TAKHFID),'.'
[90] fl:L_(1$-K)$REV0 -1$DRP(K_(L$NE' ')$MAX.#$I 26)$REVL_0 14$DRP$QFLIB(-1+HFID$I ',')$TAKHFID
[91]  N_$MAX/0,K_10#$MAXK%10
[92]  LR_1+-1$TAKLN_$MIN(-1++\K)%PW_10#$MIN$QPW%10
[93]  RA_PW$-+/((-1+$I LR)$SC.=LN)#(LR,$R K)$R K
[94]  (LN/K)_RA+(LN_LN$NE1$DRPLN,-1)/K
[95]  $GO ((N=0)$OR(0<RA_-1$TAKRA)&(-1$TAKK)$LEN_$MAX/0,-1$DRPK)/hfo
[96]  L_L,[1](($MAXRA%N),-1$TAK$R L)$R ' '
[97]  K[$R K]_K[$R K]$-RA $DMD K_K,((0$NEN|RA)/N|RA),(-1+$MAX(RA+1)%N)$R N
[98] hfo:L_(,K$SC.$GE$I N)/,(($R L)[1],N_$MAX/0,K)$TAKL
[99]  L_0 -1$DRP(LR,PW)$R L
[100]  AV $QXL L
[101]  $GO 0
[102] keyerr:$GO NOKEY
[103] not:AV $QXL ' No such topic.' $DMD $GO 0
[104] nomore:AV $QXL ' No further HELP exists for that topic' $DMD $GO done
[105] er:AV $QXL ' Syntax error' $DMD $GO 0
[106] bfd:AV $QXL 'No HELP exists for: ',(~$REV<\$REV':'=K)/K_(K$I ':')$DRP(-1+K$I ',')$TAKK_HFID
[107]  $GO 0
[108] ef:AV $QXL ' Incorrect usage of ? (wildcard).' $DMD $GO 0
    "
 
$COM  $QAV           3     4]    6]    6]   31]   31    63]   77]   77    78]
$COM                78
$COM  $QCVT         22    24    35    37    41    44    44    49    55    56
$COM                58    58    68    70    75    83    84
$COM  $QFCLOSE       9
$COM  $QFI          33    34
$COM  $QFLIB        90
$COM  $QFNUMS        9    13
$COM  $QFOPEN       13
$COM  $QFREAD       20    21    27    33    34    37    39    43    47    48
$COM                52    57    66    67    72    73    74    81    82
$COM  $QFRKEY       22    35    41    44    49    55    58    60    68    75
$COM                82
$COM  $QIO           0     2_
$COM  $QNC           5
$COM  $QPW          85    92
$COM  $QSCP         50    83
$COM  $QSM           2
$COM  $QTLEX        15
$COM  $QTT           3     4     4
$COM  $QVI          75
$COM  $QXL          38    42    87   100   103   104   105   106   108
$COM  AV             0     3_    3]_   3]    4]_  38    42    87   100   103
$COM               104   105   106   108
$COM  CNTR           0    17_   19    26
$COM  CR             0    63_   85
$COM  DR             0    15_   29    47    60_
$COM  FF             0     6_   30    47    63    78    79    81
$COM  HFID           0     5_    6_    6    11_   12    13    89    89    89_
$COM                89    89    90    90   106
$COM  K              0     7_    8     8     8    10    12    12    22_   23
$COM                32_   33    35    61_   62    63_   68_   69    73_   85_
$COM                85    87    90    90_   91_   91    92    93    93    94
$COM                94    95    95    97]_  97    97]   97    97_   97    98
$COM                98   106   106_  106   106   106_
$COM  KEY            0    22_   23    24    44_   45    45    49_   49    50
$COM                55_   56    58_   59    59    68_   70    71_   75_   76
$COM  KV             0    32_   35    44_   45    58_   63_   64_   64    65
$COM                76_   77_   77    77    77]_  77    77    78    78_   78
$COM                81    82_   83_   83    83    84    85    85_   85
$COM  L              0    11    11_   20_   21_   26    27_   33_   34_   36
$COM                37_   39_   42    43_   47_   48_   52_   57_   63_   64_
$COM                64    64    64    66_   67_   71    72_   74_   75    79_
$COM                79    80_   80    80    80    81_   82_   85_   86    90_
$COM                90    90_   96_   96    96    98_   98    98    99_   99
$COM               100
$COM  LN             0    63_   78_   78]_  78    79_   80_   80    83    92_
$COM                93    94    94_   94    94
$COM  LOOP           0    64_   73_   79_   86
$COM  LR             0    44_   46    92_   93    93    99
$COM  N              0     7     7    10    10    12_   12    15_   15    15
$COM                29_   29    30_   30    31    32    61    63    63_   81
$COM                86_   89    91_   95    95_   96    97    97    97    97
$COM                98    98_
$COM  NOKEY          0    19_   21_   26_   32_   34_   36_   39_   41_   47_
$COM                48_   52_   57_   60_   65_   67_   71_   73_   74_   81_
$COM                82_  102
$COM  PKEY           0    15_   16    16    19    20    20    20    22    23_
$COM                26_   32    37    41_   45    47    50_   50    55_   59
$COM                65_   66    68    69_   71_   72    73    75
$COM  POS            0    63_   85    86_   86
$COM  PW             0    92_   93    99
$COM  PX             0    10_   11    11    11    17_   30_   36_   37    38_
$COM                45    56_   61_   61    63_   85    85
$COM  RA             0    30_   31_   31]_  31    31    50    77_   78    93_
$COM                94    95_   95    96    97    97    97    97
$COM  RKEY           0    19_   23_   26_   27    39    46_   52    55_   60_
$COM                65_   68    69_   71_   75    76
$COM  RPK            0    19_   22    23_   26_   41_   45    45    50_   55_
$COM                59    59    85    85_   86
$COM  STREAM         0     2_    9     9    13    13    20    21    22    27
$COM                33    34    35    37    39    41    43    44    47    48
$COM                49    52    55    57    58    60    66    67    68    72
$COM                73    74    75    81    82    82
$COM  X0             0     6_   17    72
$COM  bfd            2   106:
$COM  done          45    47:  104
$COM  dx            41    47    48    50    52:   60
$COM  ef            89   108:
$COM  er             8    39    62   105:
$COM  est           34    35    36    38:
$COM  et            81    82:
$COM  f              5     6:
$COM  files         12    89:
$COM  fl            89    90:
$COM  gnt           47    48:   49
$COM  gotfid        13    15:
$COM  gs            20    25:
$COM  gst           33    36:
$COM  gt            70    73:
$COM  gts           66    71:
$COM  hfo           95    98:
$COM  keyerr         2   102:
$COM  lp            42:   46    51    62
$COM  nofid          8    13:
$COM  nomore        57    59   104:
$COM  not           21    22    26    67    68    71   103:
$COM  nst           32    34:
$COM  qu            16    54:
$COM  sb            20    24    28:
$COM  sbt           29    32:
$COM  start         29    30    31    37    40:
$COM  stl           73    73    74:   75
$COM  su            19    21:
$COM  td            74    75    82    83    87:
$COM  tl            64    79    80    81:   84
$COM  topics        16    63:
$COM  tr            64    77:
$COM  trv           76    85:
$COM  tu            65    67:
 
 
;'        Function: HELPSI      '
 
 
    " HELPSI F;TL;START;TOPIC;IN;KEY;KL;I;FIERR;ST;K;SS;STN;STS;SYMS
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   (nf fi,[1.5]73 79)$QSM 'HELPSI'
[3]   $QFCLOSE(1$E $QFNUMS)/1 $DMD (F,',IN')$QFOPEN 1
[4]   FIERR_STN_ST_TL_START_0 $DMD TOPIC_'' $DMD SYMS_HELPSYMS 1
[5]   $Q1_'.*A*'
[6]  lp:IN_$QFREAD 1 '' 0 3 $DMD KEY_$QFRKEY 1 2
[7]   $GO (0$NE0\0/KEY)/txt
[8]   $GO (KEY=START)/wr
[9]  wb:SS_'' $DMD $GO (STN<ST_ST+1)/wrb $DMD SS_ST$DSCSTS
[10] wrb:$Q1_,(2 4$R '.*B*.*T*')[1+$QAV[2]=$TAKTOPIC;],' ',SS
[11]  START_3 27 $QCVT -3$TAKKEY
[12] wr:$Q1_IN $DMD START_START+1
[13]  $GO lp
[14] txt:$GO ((TL$NEKL)$OR(I$TAKTOPIC)$OR.$NE(I_TL$MAXKL_-3+$R KEY)$TAKKEY)/new
[15]  $GO (START=3 27 $QCVT -3$TAKKEY)/wr
[16]  $GO wb
[17] new:TOPIC_KL$TAKKEY $DMD TL_KL $DMD $GO (0$NESTART_3 27 $QCVT -3$TAKKEY)/lp
[18]  STS_(ST_STN_0)$R $ENC'' $DMD FIERR_sts $DMD _$QFREAD 1(TOPIC,' ')0 3
[19] sts:FIERR_stx $DMD I_$QFI $QFREAD 1 '' 0 3
[20]  $GO ((0$OR.=I),(TOPIC,' ')$OR.$NE(KL+1)$TAKK_$QFRKEY 1 2)/stx
[21]  STS_(STN_I$MAX$R STS)$TAKSTS $DMD STS[I]_$ENC(KL+1)$DRPK
[22]  $GO sts
[23] stx:IN_$QFREAD 1 KEY 0 3                 $COM Reposition file
[24]  FIERR_0
[25]  $GO ($QAV[2]$OR.$NETOPIC)/wtop
[26]  $Q1_'.*M*' $DMD $GO wr
[27] wtop:KL_'' $DMD $GO (0=$R I_(($ENCTOPIC)$EQV$"SYMS[;1])/SYMS[;2])/wtn
[28]  KL_$TAK,/I
[29] wtn:$Q1_'.*K* ',TOPIC,KL
[30]  $GO wr
[31] nf:($XEC')?')$QERS 801
[32] fi:$GO FIERR
    "
(1 2$R -1 900)$QSM 'HELPSI  '
 
$COM  $QAV       10]   25]
$COM  $QCVT      11    15    17
$COM  $QERS      31
$COM  $QFCLOSE    3
$COM  $QFI       19
$COM  $QFNUMS     3
$COM  $QFOPEN     3
$COM  $QFREAD     6    18    19    23
$COM  $QFRKEY     6    20
$COM  $QSM        2
$COM  F           0     3
$COM  FIERR       0     4_   18_   19_   24_   32
$COM  HELPSYMS    4
$COM  I           0    14    14_   19_   20    21    21    27_   28
$COM  IN          0     6_   12    23_
$COM  K           0    20_   21
$COM  KEY         0     6_    7     8    11    14    14    15    17    17
$COM             23
$COM  KL          0    14    14_   17    17    20    21    27_   28_   29
$COM  SS          0     9_    9_   10
$COM  ST          0     4_    9_    9     9    18_
$COM  START       0     4_    8    11_   12_   12    15    17_
$COM  STN         0     4_    9    18_   21_
$COM  STS         0     9    18_   21_   21    21    21]_
$COM  SYMS        0     4_   27]   27]
$COM  TL          0     4_   14    14    17_
$COM  TOPIC       0     4_   10    14    17_   18    20    25    27    29
$COM  fi          2    32:
$COM  lp          6:   13    17
$COM  new        14    17:
$COM  nf          2    31:
$COM  sts        18    19:   22
$COM  stx        19    20    23:
$COM  txt         7    14:
$COM  wb          9:   16
$COM  wr          8    12:   15    26    30
$COM  wrb         9    10:
$COM  wtn        27    29:
$COM  wtop       25    27:
 
 
;'        Function: HELPSYMS    '
 
 
    " R_HELPSYMS F;ER;IN;K
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   (1 2$R fi 79)$QSM 'HELPSYMS' $DMD R_0 2$R 0
[3]   ER_go $DMD _$QFREAD 1(,' ')0 3
[4]  go:ER_done $DMD IN_$QFREAD 1 '' 0 3 $DMD K_$QFRKEY 1 2
[5]   $GO (0=3 27 $QCVT -3$TAKK)/ok
[6]  $COM    IN -- real topic
[7]  $COM    KEY -- synonym
[8]   R_R,[1]IN(' ',K)
[9]   $GO go
[10] ok:ER_go $DMD _$QFREAD 1((-3$DRPK),3$R $QAV[512])0 3
[11] fi:$GO ER
[12] done:ER_0 $DMD _$QFREAD 1($QAV[1])0 3
    "
 
$COM  $QAV     10]   12]
$COM  $QCVT     5
$COM  $QFREAD   3     4    10    12
$COM  $QFRKEY   4
$COM  $QSM      2
$COM  ER        0     3_    4_   10_   11    12_
$COM  F         0
$COM  IN        0     4_    8
$COM  K         0     4_    5     8    10
$COM  R         0_    2_    8_    8
$COM  done      4    12:
$COM  fi        2    11:
$COM  go        3     4:    9    10
$COM  ok        5    10:
 
 
;'        Function: INPUT       '
 
 
    " R_INPUT F;IN;I;J;$QIO
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $XEC')SET $Q1 ',F,',FUN=IN' $DMD (1 2$R io 30)$QSM 'INPUT'
[3]   $QIO_1 $DMD R_0 0$R I_J_0
[4]  l:$GO x#$I 0=$TAKIN_$Q1
[5]   R_((I,J)$TAKR),[1](J_$MAX/J,$R IN)$TAKIN $DMD I_I+1
[6]   $GO l
[7]  x:$XEC')SET $Q1 ME' $DMD $GO 0
[8]  io:($XEC')?')$QERS 1202
    "
(1 2$R -1 900)$QSM 'INPUT       '
 
$COM  $QERS   8
$COM  $QIO    0     3_
$COM  $QSM    2
$COM  F       0     2
$COM  I       0     3_    5     5_    5
$COM  IN      0     4_    5     5
$COM  J       0     3_    5     5_    5
$COM  R       0_    3_    5_    5
$COM  io      2     8:
$COM  l       4:    6
$COM  x       4     7:
 
 
;'        Function: OCT         '
 
 
    " R_B OCT N;$QIO;C;D;AV;W
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_0 $DMD $GO (0$NE$QNC 'B')/go $DMD B_0
[3]  go:AV_512$R '.'
[4]   AV[$QAV$I C]_C_'$ !''()*+,/0123456789:;<=>?$_$-'
[5]   AV[$QAV$I C]_C_'@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]'
[6]   AV[$QAV$I C]_C_'abcdefghijklmnopqrstuvwxyz{|}~'
[7]   $GO ($QTT=1)/1+$QLC $DMD AV[AV$I '$_$-']_'_-'
[8]   W_1$MAX-1$TAK((7+17#$I 8)<$QPW)/$I 8 $DMD C_12#W $DMD D_4#W
[9]   R_'01234567'[,$TPS8 8 8$ECD$QAV$I N_,2 9 $QCVT N]
[10]  R_((13#W)$R 0,12$R 1)\(($MAX($R R)%C),C)$R R_(C#$MAX($R R)%C)$TAKR
[11]  R_R,' ','*',((($MAX($R N)%D),D)$R N_(D#$MAX($R N)%D)$TAKN_AV[$QAV$I N]),'*'
[12]  R_'01234567'[$TPS8 8 8 8$ECDB+W#$I 1$TAK$R R],R
    "
 
$COM  $QAV    4     5     6     9    11
$COM  $QCVT   9
$COM  $QIO    0     2_
$COM  $QLC    7
$COM  $QNC    2
$COM  $QPW    8
$COM  $QTT    7
$COM  AV      0     3_    4]_   5]_   6]_   7]_   7    11]
$COM  B       0     2_   12
$COM  C       0     4     4_    5     5_    6     6_    8_   10    10    10
$COM         10
$COM  D       0     8_   11    11    11    11
$COM  N       0     9_    9    11    11_   11    11_   11
$COM  R       0_    9_   10_   10    10_   10    10    11_   11    12_   12
$COM         12
$COM  W       0     8_    8     8    10    12
$COM  go      2     3:
 
 
;'        Function: RECFDTYPES  '
 
 
    " Z_RECFDTYPES
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   Z_64 42$R 42$TAK'*'
[3]   Z[1;]_42$TAK'NoType(?)'
[4]   Z[2;]_42$TAK'Integer(?) Signed'
[5]   Z[3;]_42$TAK'Integer(72) Signed'
[6]   Z[4;]_42$TAK'Real'
[7]   Z[5;]_42$TAK'Double'
[8]   Z[10;]_42$TAK'Decimal(?,&) Packed Leading Signed'
[9]   Z[11;]_42$TAK'Decimal(?) Packed Float'
[10]  Z[22;]_42$TAK'Char(?)'
[11]  Z[23;]_42$TAK'Char(511) Varying'
[12]  Z[25;]_42$TAK'Integer(?) Unsigned'
[13]  Z[26;]_42$TAK'Decimal(?,&) Packed Trailing Signed'
[14]  Z[32;]_42$TAK'Decimal(?,&) Packed Trailing Signed'
[15]  Z[41;]_42$TAK'Decimal(?,&) Packed Unsigned'
[16]  Z[42;]_42$TAK'Decimal(?,&) Unsigned'
[17]  Z[43;]_42$TAK'Decimal(?,&) Leading Signed'
[18]  Z[44;]_42$TAK'Decimal(?,&) Trailing Signed'
[19]  Z[45;]_42$TAK'Decimal(?,&) Leading Overpunched Signed'
[20]  Z[46;]_42$TAK'Decimal(?,&) Trailing Overpunched Signed'
[21]  Z[48;]_42$TAK'*LIST*'
[22]  Z[49;]_42$TAK'*VLIST*'
[23]  Z[51;]_42$TAK'Decimal(?) Float'
[24]  Z[52;]_42$TAK'Decimal(?,&) Packed Decimal Leading Signed'
[25]  Z[55;]_42$TAK'Date'
[26]  Z[56;]_42$TAK'UTS'
[27]  Z[57;]_42$TAK'Char(65533) Varying'
[28]  Z[58;]_42$TAK'Timespan'
    "
 
$COM  Z    0_    2_    3]_   4]_   5]_   6]_   7]_   8]_   9]_  10]_  11]_
$COM      12]_  13]_  14]_  15]_  16]_  17]_  18]_  19]_  20]_  21]_  22]_
$COM      23]_  24]_  25]_  26]_  27]_  28]_
 
 
;'        Function: RECFOPTS    '
 
 
    " R_RECFOPTS
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_$DSC'' 'VARYING' 'UNPACKED' 'PACKED' 'LEADING' 'TRAILING' 'SEPARATE' 'OVERPUNCHED ' 'SIGNED' 'UNSIGNED' 'FLOAT'
    "
 
$COM  R   0_    2_
 
 
;'        Function: RECFTYPECHK '
 
 
    " R_RECFTYPECHK;NULL
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_$I 11 $DMD NULL_R$E ''
[3]   R_NULL,(R$E 2),(R$E 9 10),NULL,NULL,(R$E 2+$I 9),NULL,NULL,NULL
[4]   R_9 11$R R
    "
 
$COM  NULL   0     2_    3     3     3     3     3     3
$COM  R      0_    2_    2     3_    3     3     3     4_    4
 
 
;'        Function: RECFTYPEMAPS'
 
 
    " R_RECFTYPEMAPS;N;P;Q;S;T
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   S_63$TAKP_Q_N_64$R -1 $DMD Q[1 33]_21 22 $DMD P[1 2]_1 24
[3]   R_(0,S),Q,P,(3,S),(4,S)
[4]   Q_N $DMD Q[1 2 3 5 7 9 10 11 17 25]_42 41 43 44 45 11 40 25 50 10
[5]   R_R,Q,(54,S),(55,S),(57,S)
[6]   R_9 64$R R
    "
 
$COM  N    0     2_    4
$COM  P    0     2_    2]_   3
$COM  Q    0     2_    2]_   3     4_    4]_   5
$COM  R    0_    3_    5_    5     6_    6
$COM  S    0     2_    3     3     3     5     5     5
$COM  T    0
 
 
;'        Function: RECFTYPES   '
 
 
    " R_RECFTYPES
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_$DSC'NOTYPE' 'CHAR' 'INTEGER' 'REAL' 'DOUBLE' 'DECIMAL' 'DATE' 'UTS' 'TIMESPAN '
    "
 
$COM  R   0_    2_
 
 
;'        Function: REPCHAR     '
 
 
    " R_Z REPCHAR N;A;B;C;D;E;F;L
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   E_-1+$MAX/0,D_6$-+/' '=C_'I6' $QFMT(B_+/A_Z=R_$TAKN)/2$DSCN
[3]   L_L+E#$MIN(L_(,A)/$I $R ,A)%-1$TAK$R R $DMD A_(R$NE2),(B\D)$SC.>$I E
[4]   A_,A $DMD A[(,D$SC.>$I E)/,L$SC.+$I E]_0
[5]   R_A\,R
[6]   R[(,D$SC.$GE$I E+1)/,L$SC.+-1+$I E+1]_(,(6$-D)$SC.<$I 6)/,C
[7]   R_((0,E)+$R $TAKN)$R R
    "
 
$COM  $QFMT   2
$COM  A       0     2_    3     3     3_    4_    4     4]_   5
$COM  B       0     2_    3
$COM  C       0     2_    6
$COM  D       0     2_    3     4     6     6
$COM  E       0     2_    3     3     4     4     6     6     7
$COM  F       0
$COM  L       0     3_    3     3_    4     6
$COM  N       0     2     2     7
$COM  R       0_    2_    3     3     5_    5     6]_   7_    7
$COM  Z       0     2
 
 
;'        Function: STATUS   '
 
 
    " STATUS;VCT;VIO;VLX;VPP;VPW;VRL;VWSID;VWSSTATUS;WSSTATUS;QIO
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QPDEF STATUSV $DMD WSSTATUS FORMPUT 1
[3]   QIO_$QIO $DMD $QIO_1 $DMD VWSSTATUS WSSTATUS
[4]  lp:$GO (1$NE$TAK$R WSSTATUS FORMREAD 1)/lp
[5]   FORMRLS 1
[6]   $QIO_QIO
    "
 
$COM  $QIO         3     3_    6_
$COM  $QPDEF       2
$COM  FORMPUT      2
$COM  FORMREAD     4
$COM  FORMRLS      5
$COM  QIO          0     3_    6
$COM  STATUSV      2
$COM  VCT          0
$COM  VIO          0
$COM  VLX          0
$COM  VPP          0
$COM  VPW          0
$COM  VRL          0
$COM  VWSID        0
$COM  VWSSTATUS    0     3
$COM  WSSTATUS     0     2     3     4
$COM  lp           4:    4
 
 
;'        Function: TERMATTR    '
 
 
    " R_TERMATTR;T
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   (1 2$R io 30)$QSM 'TERMATTR'
[3]   R_'' $DMD T_$QTATTR
[4]   R_R,' Speed=',($FMTT[1]),'cps'
[5]   R_R,', Parity=',($QIO+T[2])$DSC'none' 'odd' 'even' 'one' 'zero'
[6]   R_R,', Connection=',($QIO+T[3])$DSC'Dialup' 'Hardwired' 'Network'
[7]   R_R,T[4]/',Multidrop'
[8]   R_R,', CharSet=',($QIO+T[5])$DSC'Ascii' 'APLb' 'APLt'
[9]   R_R,T[6]/',Lowercase'
[10]  R_R,', Width=',($FMTT[7]),', Height=',$FMTT[8]
[11]  R_R,(T[9]=1)/', BlankErases'
[12]  R_R,T[10]/', Scroll'
[13]  R_R,T[11]/', Wrap'
[14]  R_R,T[12]/', Retypovr'
[15]  R_R,T[13]/', Editovr'
[16]  R_R,T[14]/', Echo'
[17]  $GO 0
[18] io:($XEC')?')$QERS 1202
    "
(1 2$R -1 900)$QSM 'TERMATTR    '
 
$COM  $QERS    18
$COM  $QIO      5     6     8
$COM  $QSM      2
$COM  $QTATTR   3
$COM  R         0_    3_    4_    4     5_    5     6_    6     7_    7
$COM            8_    8     9_    9    10_   10    11_   11    12_   12
$COM           13_   13    14_   14    15_   15    16_   16
$COM  T         0     3_    4]    5]    6]    7]    8]    9]   10]   10]
$COM           11]   12]   13]   14]   15]   16]
$COM  io        2    18:
 
 
;'        Function: TRUP        '
 
 
    " R_TRUP R;A
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   A_$QAV $DMD A[-1+(A$I 'a')+$I 26]_A[-1+(A$I 'A')+$I 26]
[3]   R_A $QXL R
    "
 
$COM  $QAV   2
$COM  $QXL   3
$COM  A      0     2_    2]_   2     2]    2     3
$COM  R      0_    0     3_    3
 
 
;'        Function: UTS         '
 
 
    " R_UTS R;$QIO;Y;M;D;MD;R1;R2;m;n
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_1
[3]   R1_365+''$R R_0 24 60 60 100$ECDR_R+(R<0)#2*36
[4]   Y_1977+(4#$MINR1%1461)+R2_3$MIN$MIN(1461|R1)%365
[5]   D_366|(1461|R1)+R2
[6]   M_+/(MD_+\0,28+3,(0$NE.=4 100 400|Y),9$R 5$R 3 2)$LED
[7]   D_D$-MD[M]$-1
[8]   R_Y,M,D,1$DRPR
    "
 
$COM  $QIO    0     2_
$COM  D       0     5_    6     7_    7     8
$COM  M       0     6_    7     8
$COM  MD      0     6_    7]
$COM  R       0_    0     3_    3_    3     3     8_    8
$COM  R1      0     3_    4     4     5
$COM  R2      0     4_    5
$COM  Y       0     4_    6     8
$COM  m       0
$COM  n       0
 
 
;'        Function: WINDOWS     '
 
 
    " R_WINDOWS
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_'<UC>,ZI2,< Position=(>,I2,<,>,I2,<),Wlength=>,I2,<,Wwidth=>,I2'
[3]   R_R,',<,MinLength=>,I2,<,MinWidth=>,I2'
[4]   R_R $QFMT $QTWINDOW[;$I 7]
    "
 
$COM  $QFMT       4
$COM  $QTWINDOW   4]
$COM  R           0_    2_    3_    3     4_    4
 
 
;'        Function: XREF        '
 
 
    " R_XREF F;$QIO;A;B;C;D;E;G;H;I;J;K
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_1
[3]   $GO (0$E $R R_(''$R -1$TAK$QAV),$QCR F_(' '$NEF)/F)$DRPLF
[4]   '<',F,'> IS ',(B/'LOCKED.'),(~B_3=$QNC F)/'NOT A FUNCTION.'
[5]   R_0 0$R '' $DMD $GO 0
[6]  LF:E_1$DRPR[1;]
[7]   E_(1$-(' '=$REVE)$I 0)$DRPE
[8]   I_$REV(-1+E$I ';')$TAKE
[9]   E[($I $R F)+($R I)$-($R F)+(' '$E I)#I$I ' ']_' '
[10]  B_$NE\R$E ''''
[11]  B_B$NOR$OR\B<R$E '$COM'
[12]  H_' $QABCDEFGHIJKLMNOPQRSTUVWXYZ$DLT$_abcdefghijklmnopqrstuvwxyz$UDL-0123456789'
[13]  R_E,(1$DRP$R R)$DRP((,B)/,R),' '
[14]  I_R$E 1$DRPH
[15]  R_(I$OR(-1$REVI)$OR(R$E '[',-1$TAK$QAV)$ORC$OR-1$REVC_R$E ']')/R
[16]  I_R$E 1$DRPH
[17]  G_(0,-1$DRPR[G]$E 1$DRP-11$DRPH)/G_(I$NE-1$REVI)/$I $R R
[18]  D_+\(R$E '[')$-R$E ']'
[19]  K_R[($R R)$MIN1++/$OR\$REV<\(B$SC.<$I $R R)&(D[B_(R[G]='[')/G]$-1)$SC.=D]
[20]  A_((R$E -1$TAK$QAV)/$I $R R)+.<(1,($R G),1)$R G
[21]  A_2$REV':]_ '[':[_'$I R[G],[1.5](G$E B)\K],4 0$FMTA
[22]  R_-1$DRP(I$OR0,-1$DRPI)/R
[23]  K_(~B_R$E 1$DRPH)/$I $R R
[24]  I_-1+$MAX/K_(K,1+$R R)$-0,K
[25]  $GO (0$E $R R_(($R K),I)$R (,K$SC.>$I I)\B/R)/0
[26]  B_$I 1$TAK$R R_(R[;1]$E -11$DRPH)/[1]R
[27]  J_$R I_$I I
[28] LS:B_B[$GU68$DCD-1+$TPSH$I R[B;($-J$MIN8)$TAKI]]
[29]  $GO (0$NEJ_$R I_-8$DRPI)/LS
[30]  R_R[B;] $DMD A_A[B;]
[31]  K_$MAX/0,E_(1$DRPB,1+$R C)$-B_C/$I $R C_$OR/R$NE' ',[1]-1 0$DRPR
[32] $COM MAKE RESULT PRINT PRETTY
[33]  H_(31$R 0),481$R 1
[34]  H[$QAV$I '$_$Q$DLT$UDL']_2 2 4 4
[35] LT:G_K$MIN$MIN($QPW$-1+D_$MAX/0,+/H[$QAV$I R])%6
[36]  B_$MAXE%G
[37]  R_(($I +/B)$E +\-1$DRP1,B)$XP1C$RD1R
[38]  I_B/G$MINE
[39]  I[(+\B)]_(G#0=K)+K_G|E
[40]  K_$MAX/0,I
[41]  A_,(($I K#$R I)$E (,(K$-I)$SC.<$I K)/,(K#-1+$I $R I)$SC.+$REV$I K)$XP1A
[42]  A_A[(6#K#-1+$I $R I)$SC.+$I K#6]
[43]  I_D$-+/-1+I_H[$QAV$I R]
[44]  D_($R R)[1] $DMD H_($R A)[2]
[45]  G_I+(-1+$I K[1])#-1$TAKK_$R R_(D,H+$MAX/I)$TAKR
[46]  R_,R
[47]  R[,G$SC.+$I H]_,A
[48]  R_K$R R
    "
 
$COM  $QAV   3    15    20    34    35    43
$COM  $QCR   3
$COM  $QIO   0     2_
$COM  $QNC   4
$COM  $QPW  35
$COM  A      0    20_   21_   21    30_   30]   41_   41    42_   42]   44
$COM        47
$COM  B      0     4     4_   10_   11_   11    11    13    19    19_   21
$COM        23_   25    26_   28_   28]   28    30    30    31    31_   36_
$COM        37    37    38    39
$COM  C      0    15    15_   31    31    31_   37
$COM  D      0    18_   19]   19    35_   43    44_   45
$COM  E      0     6_    7_    7     7     8     8     9]_  13    31_   36
$COM        38    39
$COM  F      0     3_    3     3     4     4     9     9
$COM  G      0    17_   17    17_   19    19    20    20    21    21    35_
$COM        36    38    39    39    45_   47
$COM  H      0    12_   14    16    17    23    26    28    33_   34]_  35]
$COM        43]   44_   45    47
$COM  I      0     8_    9     9     9    14_   15    15    16_   17    17
$COM        22    22    24_   25    25    27_   27    28    29_   29    38_
$COM        39]_  40    41    41    41    42    43_   43_   45    45
$COM  J      0    27_   28    29_
$COM  K      0    19_   21    23_   24_   24    24    25    25    31_   35
$COM        39    39_   40_   41    41    41    41    41    42    42    45]
$COM        45_   48
$COM  LF     3     6:
$COM  LS    28:   29
$COM  LT    35:
$COM  R      0_    3_    5_    6]   10    11    13_   13    13    14    15_
$COM        15    15    15    16    17]   17    18    18    19]   19    19
$COM        19]   20    20    21]   22_   22    23    23    24    25_   25
$COM        26_   26]   26    28]   30_   30]   31    31    35    37_   37
$COM        43    44    45_   45    46_   46    47]_  48_   48
 
 
$QLX_' '
 
 
 
 
 
 
 
;'        Function: WSLOC   '
 
 
    " A WSLOC B;CR;F;FN;I;J;LN;M;P;X;$QIO
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_1
[3]   $GO (0$NE$QNC 'A')/ok $DMD A_$QNL 3 $DMD $GO m
[4]  ok:$GO (2=$R $R A)/m $DMD A_$DSC$QTLEX(,A)' '
[5]  m:$GO (0=M_$TAK$R A)/0 $DMD F_0
[6]  l:$GO (M<F_F+1)/0
[7]   $GO (0 1 2 3 4=$QNC FN_A[F;])/l l c f l
[8]   '**** What''s ''',FN,'''' $DMD $GO l
[9]  c:'''',FN,''' is a character array!' $DMD $GO l
[10] f:$GO (0=$R P_$QSSS(,CR_$QCR FN)B)/l $DMD I_1 $DMD J_-1$TAK$R CR
[11]  FN_(-1+(' '=FN)$I 0)$DRP(1$-(' '=$REVFN)$I 0)$DRPFN
[12] fl:FN,'[',($FMT-1+LN),'] ',(1$-(' '=$REVX)$I 0)$DRPX_,CR[LN_$MAXP[I]%J;]
[13]  $GO (($R P)$GEI_I+1)/fl $DMD $GO l
    "
 
$COM  $QCR    10
$COM  $QIO     0     2_
$COM  $QNC     3     7
$COM  $QNL     3
$COM  $QSSS   10
$COM  $QTLEX   4
$COM  A        0     3_    4     4_    4     5     7]
$COM  B        0    10
$COM  CR       0    10_   10    12]
$COM  F        0     5_    6_    6     7
$COM  FN       0     7_    8     9    10    11_   11    11    11    12
$COM  I        0    10_   12    13_   13
$COM  J        0    10_   12
$COM  LN       0    12    12_
$COM  M        0     5_    6
$COM  P        0    10_   12]   13
$COM  X        0    12    12_
$COM  c        7     9:
$COM  f        7    10:
$COM  fl      12:   13
$COM  l        6:    7     7     7     8     9    10    13
$COM  m        3     4     5:
$COM  ok       3     4:
 
 
 
 
;'        Function: DCB     '
 
 
    " R_D DCB N;NAME;FID;ACCT;RES;STATUS;ORG;O;FUN
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_'' $DMD $GO (N=0)/0 $DMD R_(2 0$FMTD),' '
[3]   NAME_2 9 $QCVT $QPEEK 3,(N+8),10
[4]   FID_(FID$OR.$NE' ')/FID_(3 9 $QCVT$TAKNAME)$TAK1$DRPNAME $DMD ACCT_32$DRPNAME
[5]   RES_2 9 $QCVT $QPEEK 3,(N+22),1
[6]   O_' ' 'CONSEC' 'KEYED' 'RANDOM' 'UR' 'RELATIVE' 'INDEX' 'IDS' 'TERM'
[7]   O_O,'SYMB' 'FPRG' 'CG' 'HAND' 'IREL' '**' 'FIXED' 'VAR' 'UNDEF' 'RESTRICT'
[8]   O_$DSCO,'FREE' 'DBGDCB' 'DBGCG' 'DBGSYSID' '**' 'X364'
[9]   STATUS_$QPEEK 3,(N+25),1 $DMD ORG_$TAKFUN_1+3 9 $QCVT $QPEEK 3,(N+26),1
[10]  ORG_O[ORG;],' ' $DMD FUN_($DSC' ' 'UPDATE ' 'IN ' 'CREATE ')[FUN[2];]
[11]  NAME_2 9 $QCVT $QPEEK 3,(N+96),8 $DMD D_2$DCD4$DRP1 1 $QCVT NAME[1]
[12]  NAME_32$TAKD$TAK1$DRPNAME
[13]  R_R,' ',FUN,(1+23$DSC1 1 $QCVT STATUS)$DSC'Closed ' 'Open   '
[14]  R_R,NAME,' ',RES,' ',ORG,(0$NE$R FID)/FID,'.',ACCT
    "
 
$COM  $QCVT     3     4     5     9    11    11    13
$COM  $QPEEK    3     5     9     9    11
$COM  ACCT      0     4_   14
$COM  D         0     2    11_   12
$COM  FID       0     4_    4     4_   14    14
$COM  FUN       0     9_   10_   10]   13
$COM  N         0     2     3     5     9     9    11
$COM  NAME      0     3_    4     4     4    11_   11]   12_   12    14
$COM  O         0     6_    7_    7     8_    8    10]
$COM  ORG       0     9_   10_   10    14
$COM  R         0_    2_    2_   13_   13    14_   14
$COM  RES       0     5_   14
$COM  STATUS    0     9_   13
 
 
 
;'        Function: ROSEG   '
 
 
    " ROSEG;BASE;STREAMS;DCBPTRS;I;$QIO;J
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_1
[3]   BASE_$MIN($QPEEK 3 0 3)%262144
[4]   STREAMS_16 4$R 2 9 $QCVT $QPEEK 3 44 16
[5]   STREAMS_(STREAMS$OR.$NE' ')$RD1STREAMS
[6]   I_0$NEDCBPTRS_$MIN($QPEEK 3,BASE[1 3])%262144
[7]   'Read Only Segment has ',($FMT+/I),' DCBs allocated of ',$FMTBASE[3]
[8]   ' '
[9]   J_&$RD1' '=I_$DSC(I/-1+$I $R DCBPTRS)DCB$"I/DCBPTRS
[10]  (~J&J=0,-1$DRPJ)/I
    "
 
$COM  $QCVT      4
$COM  $QIO       0     2_
$COM  $QPEEK     3     4     6
$COM  BASE       0     3_    6]    7]
$COM  DCB        9
$COM  DCBPTRS    0     6_    9     9
$COM  I          0     6_    7     9_    9     9    10
$COM  J          0     9_   10    10    10
$COM  STREAMS    0     4_    5_    5     5
 
 
 
 
 
;'        Function: TEXLIST '
 
 
    " IN TEXLIST OUT;A;B;J;P;APLMAC;APLSPEC;APLI;TEXALPHA;APLINIT;MAPTEX;LOWERCASE
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $XEC')SET $Q1 ',IN,',FUN=IN' $DMD $XEC')SET $Q2 ',OUT,',FUN=C'
[3]   _$QPDEF TEXPACK $DMD APLINIT $DMD P_(J_0)$R ' '
[4]   $Q2_'\input apldefs:tex \hsize 7.75in $R !dvilg ... (Hoff=50...'
[5]   $Q2_'{\obeylines \obeyspaces \apl \let =\ $R explicit blanks'
[6]  lp:$GO ((0=$TAKA),' '&.=A_$Q1)/stop bl $COM $DMD P_(2#J_-1+(A=' ')$I 0)$R '\ '
[7]  wr:$Q2_P,MAPTEX 0 $QTSQZ J$DRPA
[8]   $GO lp
[9]  bl:$Q2_'\vskip10pt' $DMD $GO lp
[10] stop:$Q2_'}\bye'
[11]  $XEC')SET $Q1 ME' $DMD $XEC')SET $Q2 ME'
    "
 
$COM  $QPDEF       3
$COM  $QTSQZ       7
$COM  A            0     6     6_    7
$COM  APLI         0
$COM  APLINIT      0     3
$COM  APLMAC       0
$COM  APLSPEC      0
$COM  B            0
$COM  IN           0     2
$COM  J            0     3_    7
$COM  LOWERCASE    0
$COM  MAPTEX       0     7
$COM  OUT          0     2
$COM  P            0     3_    7
$COM  TEXALPHA     0
$COM  TEXPACK      3
$COM  bl           6     9:
$COM  lp           6:    8     9
$COM  stop         6    10:
$COM  wr           7:
 
 
 
' ********  Package:   TEXPACK      ********'
 
 
 
 
 
 
;'        Function: APLINIT  '
 
 
    " APLINIT
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   TEXALPHA_'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
[3]   APLSPEC_'abcdefghijklmnopqrstuvwxyz$Q0$Q1$Q2$Q3$Q4$Q5$Q6$Q7$Q8$Q9$'
[4]   APLSPEC_APLSPEC,'-\&$_{}~'
[5]   APLSPEC_APLSPEC,'$"$-$LE$RD1$EQV$XP1$GE$NE$OR#$LTK%$RTK$REV$NND$XEC'
[6]   APLSPEC_APLSPEC,'$COM$LOK$IB$UDL$GD$GU$NOR$QQ$MDV$FMT$RV1$DMD@$DCD$CAP'
[7]   APLSPEC_APLSPEC,'$MIN$E"$DLT$I$SC'
[8]   APLSPEC_APLSPEC,'$Q|$ECD$O$R$MAX$DRP$CUP$W$DSC$TAK$ENC$LOG_$GO$TPS'
[9]   APLSPEC_APLSPEC,'$FND$FDI$TBR$NQV'
[10] $COM Now the macros:
[11]  APLMAC_,(26 3$R '\au'),'abcdefghijklmnopqrstuvwxyz'
[12]  APLMAC_APLMAC,,(10 4$R '\aqb'),'0123456789'
[13]  APLMAC_APLMAC,'\adol'
[14]  APLMAC_APLMAC,'\ahmi\axpd\aand\au\aobr\acbr\anot'
[15]  APLMAC_APLMAC,'\adrs\amns\ale\ardf\aeqv\axpf\age\ane\aor\atms\altk'
[16]  APLMAC_APLMAC,'\adiv\artk\arev\annd\axec'
[17]  APLMAC_APLMAC,'\acom\alok\aib\audl\agd\agu\anor\aqq\amdv\afmt\arvf'
[18]  APLMAC_APLMAC,'\admd\aalf\adcd\acap\amin\aeps\adel\adlt\ai\asc'
[19]  APLMAC_APLMAC,'\aq\aabs\aecd\ao\ar\amax\adrp\acup\aw\adsc\atak\aenc'
[20]  APLMAC_APLMAC,'\alog\ais\ago\atps\afnd\afdi\atbr\anqv{}'
[21] $COM Now setup APLI which indicates in column 1 the starting
[22] $COM index of each macro and in column 2 the length of the macro.
[23]  $GO (($R APLSPEC)=$R APLI_-1+('\'=APLMAC)/$I $R APLMAC_$QSSR APLMAC '\' '{}\' 2)/ok
[24]  'Macro Count does not equal Characters to be replaced' $QERS 802
[25] ok:APLI_APLI,[1.5](1$DRPAPLI,$R APLMAC)$-APLI+2
[26]  APLMAC_APLMAC,'\'
[27]  $GO (0=$QNC 'LOWERCASE')/0 $DMD $GO (0=LOWERCASE)/0 $DMD APLSPEC[$I 26]_-1$TAK$QAV
[28]  TEXALPHA_'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'
    "
(1 2$R -1 900)$QSM 'APLINIT  '
 
$COM  $QAV        27
$COM  $QERS       24
$COM  $QNC        27
$COM  $QSSR       23
$COM  APLI        23_   25_   25    25    25
$COM  APLMAC      11_   12_   12    13_   13    14_   14    15_   15    16_
$COM              16    17_   17    18_   18    19_   19    20_   20    23
$COM              23_   23    25    26_   26
$COM  APLSPEC      3_    4_    4     5_    5     6_    6     7_    7     8_
$COM               8     9_    9    23    27]_
$COM  LOWERCASE   27
$COM  TEXALPHA     2_   28_
$COM  ok          23    25:
 
 
 
;'        Function: MAPTEX   '
 
 
    " R_MAPTEX R;A;C;E;F;G;L;M;N;Q
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $GO (0=$R A_(C_R$E APLSPEC)/$I E_$R R)/0
[3]   A_A++\0,-1$DRPQ_-1+L_APLI[G_APLSPEC$I C/R;2]+2#(R,' ')[A+1]$E TEXALPHA
[4]   R_(~($I E++/Q)$E F_(N_,L$SC.$GE$I M)/,A$SC.+-1+$I M_$MAX/L)\(~C)/R
[5]   R[F]_APLMAC[N/,APLI[G;1]$SC.+$I M]
    "
 
$COM  A          0     2_    3_    3     3     4
$COM  APLI       3]    5]
$COM  APLMAC     5]
$COM  APLSPEC    2     3
$COM  C          0     2_    3     4
$COM  E          0     2_    4
$COM  F          0     4_    5
$COM  G          0     3_    5
$COM  L          0     3_    4     4
$COM  M          0     4     4_    5
$COM  N          0     4_    5
$COM  Q          0     3_    4
$COM  R          0_    0     2     2     3     3     4_    4     5]_
$COM  TEXALPHA   3
 
 
 
;'        Variable: LOWERCASE'
 
 
LOWERCASE_1
 
 
 
_$QEX $QPNAMES TEXPACK_$QPACK 3 9$R'APLINIT  MAPTEX   LOWERCASE'
 
 
 
 
;'        Function: GETEQUS  '
 
 
    " R_GETEQUS F;C;EQVALS;EQNAMES;IN;NODES;REMCMNT;DOEQU;EQUVAL;EQNODES
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $XEC')SET $Q2 ',F,',FUN=IN' $DMD EQVALS_0/C_0 $DMD EQNAMES_''
[3]   'REMCMNT DOEQU EQUVAL PARSEEQU' $QPDEF PARSEPACK $DMD EQNODES_PARSEEQU
[4]   (1 2$R lp 4)$QSM 'GETEQUS'
[5]  lp:$GO (0=$TAKIN_$Q2)/end
[6]   (C IN)_REMCMNT(C/'/*'),IN
[7]   $GO (' '&.=IN)/lp
[8]   $GO (0=$R NODES_4$DRP4$DSCEQNODES(,4)$QPARSE IN)/lp
[9]   DOEQU NODES
[10]  $GO lp
[11] end:R_EQNAMES EQVALS
    "
 
$COM  $QPARSE      8
$COM  $QPDEF       3
$COM  $QSM         4
$COM  C            0     2_    6     6
$COM  DOEQU        0     9
$COM  EQNAMES      0     2_   11
$COM  EQNODES      0     3_    8
$COM  EQUVAL       0
$COM  EQVALS       0     2_   11
$COM  F            0     2
$COM  IN           0     5_    6     6     7     8
$COM  NODES        0     8_    9
$COM  PARSEEQU     3
$COM  PARSEPACK    3
$COM  R            0_   11_
$COM  REMCMNT      0     6
$COM  end          5    11:
$COM  lp           4     5:    7     8    10
 
 
 
;'        Function: LINKNODES'
 
 
    " {R}_DEBUG LINKNODES FID;LINK;MAP;SETUPOU;FOLD;GETHEAD;OPENFID;OUDEFN;OUPROG;OUREF;OUSECTION;OUSEG;PROGRELSECT;AND;FINDNAMES;MAKEMAT;OUNAME;OUREAD
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QPDEF LINKPACK
[3]   $GO (0$NE$QNC 'DEBUG')/deb
[4]   R_LINK FID
[5]   $GO 0
[6]  deb:R_1 LINK FID
[7]   $GO 0
    "
 
$COM  $QNC           3
$COM  $QPDEF         2
$COM  AND            0
$COM  DEBUG          0
$COM  FID            0     4     6
$COM  FINDNAMES      0
$COM  FOLD           0
$COM  GETHEAD        0
$COM  LINK           0     4     6
$COM  LINKPACK       2
$COM  MAKEMAT        0
$COM  MAP            0
$COM  OPENFID        0
$COM  OUDEFN         0
$COM  OUNAME         0
$COM  OUPROG         0
$COM  OUREAD         0
$COM  OUREF          0
$COM  OUSECTION      0
$COM  OUSEG          0
$COM  PROGRELSECT    0
$COM  R              0     4_    6_
$COM  SETUPOU        0
$COM  deb            3     6:
 
 
 
;'        Function: MAPNODES '
 
 
    " R_MAPNODES T;I;J;LOC;N;FOLD;NODEINFO
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   'FOLD' $QPDEF LINKPACK $DMD 'NODEINFO' $QPDEF PARSEPACK
[3]   (R LOC)_NODEINFO T
[4]   R_R[I_$GUR;] $DMD LOC_LOC[I]
[5]   R_FOLD R,' ',$FMT(($R LOC),1)$R LOC
    "
 
$COM  $QPDEF       2     2
$COM  FOLD         0     5
$COM  I            0     4_    4
$COM  J            0
$COM  LINKPACK     2
$COM  LOC          0     3     4_    4]    5     5
$COM  N            0
$COM  NODEINFO     0     3
$COM  PARSEPACK    2
$COM  R            0_    3     4_    4]    4     5_    5
$COM  T            0     3
 
 
 
;'        Function: PARSE    '
 
 
    " POS PARSE NODES;SETINP;GETINP;DISPNODE;AND;NODETYPES;GETNODENAME;GETNODES;NODEINFO;NODECODE;REMCMNT;DOEQU;EQUVAL;IN;N;QED;POSN;R;Z;XPRMPT;TT;NAMES;LOCS;EQNAMES;EQVALS;NODEPOSN
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   (brk er,[1.5]100 0)$QSM 'PARSE' $DMD NODEPOSN_QED_-1 $DMD TT_$QTT
[3]   $QPDEF PARSEPACK $DMD _$XEC')TERM 1' $DMD SETINP
[4]   NODES_GETNODES NODES $DMD EQNAMES_EQVALS_'' $DMD QED_0
[5]   POSN_,4 $DMD $GO (0=$QNC 'POS')/lp $DMD POSN_NODES GETNODENAME POS
[6]  lp:$GO (0=$R IN_GETINP ':')/stop
[7]   $GO (0=$TAKR_NODES POSN $QPARSE IN)/disp
[8]   (R[2]$TAKIN),'<$-$- ?? $-$->',R[2]$DRPIN
[9]   ' ' $DMD 3$DSCR
[10]  $GO lp
[11] disp:(R[2]<$R IN)/'* Unused input: ''',(R[2]$DRPIN),''''
[12]  0 DISPNODE 4$DSCR $DMD $GO lp
[13] $COM Exceptional condition handling
[14] brk:$GO (QED<0)/stop $DMD $GO (0$NE$QNC 'NAMES')/gnm
[15]  (NAMES LOCS)_NODEINFO NODES
[16] gnm:NODEPOSN_($R LOCS)|NODEPOSN+1
[17]  ' ' $DMD '** ',NAMES[1+$TAKNODEPOSN;],' **' $DMD ' '
[18]  POSN_,LOCS[1+NODEPOSN]
[19]  $GO lp
[20] er:$GO ($QERN[1]>199)/ero
[21]  ' ** System Err **' $DMD $QERM $DMD $QERF,'[',($FMT$QERN[2]),']'
[22]  $QERL $DMD ((-1+$QERP)$R ' '),'&'
[23]  $GO stop
[24] ero:$QERM
[25] stop:_$XEC')TERM ',$FMTTT
    "
 
$COM  $QERF         21
$COM  $QERL         22
$COM  $QERM         21    24
$COM  $QERN         20]   21]
$COM  $QERP         22
$COM  $QNC           5    14
$COM  $QPARSE        7
$COM  $QPDEF         3
$COM  $QSM           2
$COM  $QTT           2
$COM  AND            0
$COM  DISPNODE       0    12
$COM  DOEQU          0
$COM  EQNAMES        0     4_
$COM  EQUVAL         0
$COM  EQVALS         0     4_
$COM  GETINP         0     6
$COM  GETNODENAME    0     5
$COM  GETNODES       0     4
$COM  IN             0     6_    7     8     8    11    11
$COM  LOCS           0    15    16    18]
$COM  N              0
$COM  NAMES          0    15    17]
$COM  NODECODE       0
$COM  NODEINFO       0    15
$COM  NODEPOSN       0     2_   16_   16    17    18
$COM  NODES          0     4_    4     5     7    15
$COM  NODETYPES      0
$COM  PARSEPACK      3
$COM  POS            0     5
$COM  POSN           0     5_    5_    7    18_
$COM  QED            0     2_    4_   14
$COM  R              0     7_    8]    8]    9    11]   11]   12
$COM  REMCMNT        0
$COM  SETINP         0     3
$COM  TT             0     2_   25
$COM  XPRMPT         0
$COM  Z              0
$COM  brk            2    14:
$COM  disp           7    11:
$COM  er             2    20:
$COM  ero           20    24:
$COM  gnm           14    16:
$COM  lp             5     6:   10    12    19
$COM  stop           6    14    23    25:
 
 
 
' ********  Package:   LINKPACK       ********'
 
 
 
 
 
 
;'        Function: LINK       '
 
 
    " PROG_DEBUG LINK FID;DNAMES;RNAMES;SNAMES;DREFS;DDEFS;SECTS;SECTKNT;REL;NL;F;OP;O;J
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   DEBUG_0$NE$QNC 'DEBUG'
[3]   RNAMES_' ',[1]DNAMES_SNAMES_0 1$R ' '
[4]   DREFS_1,[1]DDEFS_SECTS_0 3$R SECTKNT_0
[5]   PROG_2 9 $QCVT 0+0 0 0 0 $DMD REL_0 5$R 0
[6]  $COM
[7]  $COM    DNAMES, RNAMES, SNAMES .... are character matrices containing
[8]  $COM                                Symdefs, Symrefs and Section names.
[9]  $COM
[10] $COM    DDEFS  ....     is an integer matrix containing the section number,
[11] $COM                    offset and index in DNAMES of a symdef.
[12] $COM
[13] $COM    DREFS  ....     is an integer matrix containing a found flag,
[14] $COM                    the definition offset, and the index in Rnames
[15] $COM                    of a Symref.
[16] $COM
[17] $COM    SECTS  ....     is an integer matrix containing the section size,
[18] $COM                    name index and offset in PROG.
[19] $COM
[20] $COM    PROG   ....     the load image.
[21] $COM
[22] $COM    REL    ....     relocation directives containing the relocation:
[23] $COM                    type, field, op, operand, and displacement in PROG.
[24] $COM
[25]  J_$QTLEX FID ' ,'
[26] lp:SETUPOU$TAKJ
[27]  $GO (0$NE$R J_1$DRPJ)/lp
[28]  $GO (0=$R J_(NL_(REL[;1]=3)&0=REL[;2])/$I $TAK$R REL)/nsr
[29]  '******************************************'
[30]  '****      Unresolved references:      ****'
[31]  '******************************************'
[32]  ' '
[33]  ' ',' ',' ',' ',' ',(~($I $TAK$R RNAMES)$E 1+REL[J;3])$RD1RNAMES
[34] nsr:$GO (0=$TAK$R REL_(~NL)$RD1REL)/x
[35]  ' '
[36]  '***********************************************************************'
[37]  '***  Unable to apply the following types of relocation directives   ***'
[38]  '***********************************************************************'
[39]  ' '
[40]  J_(~&/J=1$RV1J)$RD1J_REL[$GUREL[;1 2];1 2]
[41]  F_6 9$R 'LeftHalf RightHalfSegID    Yfield   word     *unknown*'
[42]  O_8 9$R 'Reloc2   Section  Entref   Symref   Constant Segdef   Segref   *unknown*'
[43]  O[1+7$MAXJ[;1];],' ','a','n','d',' ',F[1+5$MAXJ[;2];]
[44]  ' '
[45] x:' ' $DMD MAP
[46]  PROG[12+$I 4]_2 9 $QCVT($R PROG)%4
[47]  J_(DNAMES$NE' ')$MAX.#$I -1$TAK$R DNAMES
[48]  F_0 2$DRP2 9 $QCVT DDEFS[;,2]+SECTS[1+DDEFS[;1];,3]
[49]  PROG_PROG,2$DRP2 9 $QCVT$TAK$R DNAMES
[50]  PROG_PROG,(,(J+3)$SC.$GE$I 3+$MAX/0,J)/,F,$QAV[J+1],DNAMES
[51]  PROG_3$DRP3 36 $QCVT(4#$MAX($R PROG)%4)$TAKPROG
    "
 
$COM  $QAV      50]
$COM  $QCVT      5    46    48    49    51
$COM  $QNC       2
$COM  $QTLEX    25
$COM  DDEFS      0     4_   48]   48]
$COM  DEBUG      0     2_
$COM  DNAMES     0     3_   47    47    49    50
$COM  DREFS      0     4_
$COM  F          0    41_   43]   48_   50
$COM  FID        0    25
$COM  J          0    25_   26    27_   27    28_   33    40_   40    40
$COM            40_   43]   43]   47_   50    50    50
$COM  MAP       45
$COM  NL         0    28_   34
$COM  O          0    42_   43]
$COM  OP         0
$COM  PROG       0_    5_   46]_  46    49_   49    50_   50    51_   51
$COM            51
$COM  REL        0     5_   28]   28]   28    33]   34_   34    40]   40]
$COM  RNAMES     0     3_   33    33
$COM  SECTKNT    0     4_
$COM  SECTS      0     4_   48]
$COM  SETUPOU   26
$COM  SNAMES     0     3_
$COM  lp        26:   27
$COM  nsr       28    34:
$COM  x         34    45:
 
 
 
;'        Function: MAP        '
 
 
    " R_MAP;W;Z
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_DNAMES,' ',$FMTDDEFS[;,2]+SECTS[1+DDEFS[;1];,3]
[3]   R_FOLD R[$GUR;]
    "
 
$COM  DDEFS    2]    2]
$COM  DNAMES   2
$COM  FOLD     3
$COM  R        0_    2_    3_    3]    3
$COM  SECTS    2]
$COM  W        0
$COM  Z        0
 
 
 
;'        Function: SETUPOU    '
 
 
    " SETUPOU F;N;HEAD;UTS;XX;DEFBASE;REFMAP;HKEY;NEWDEFS;NEWREFS;PROGBASE;REFBASE;SECTBASE;SEV
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]  $COM   Input:   File Identifier
[3]  $COM
[4]  $COM   Output:  HEAD  ...   Text of head record
[5]  $COM            XX    ...   O'777',UTS
[6]  $COM            DNAMES...   Symdef names
[7]  $COM            RNAMES...   Symref names
[8]  $COM            SNAMES...   Section names
[9]  $COM            DDEFS ...   Section_num,Offset,Name_num
[10] $COM            SECTS ...   Size,Name_num
[11] $COM            PROG  ...   Program memory image
[12] $COM            REL   ...   Relocation directives: optyp,field,op,oprnd,dsp
[13] $COM
[14]  $GO (0=$R XX_F OPENFID N_1)/gh $DMD XX $DMD $GO 0
[15] gh:DEBUG/'File: ',F $DMD DEBUG/' '
[16]  $GO (0$NE$R HEAD_GETHEAD N)/next
[17]  ('''',($QFID 1),''' is not an object unit!') $DMD $GO 0
[18] next:XX_(-1$TAK$QAV),UTS_4$TAKHEAD
[19]  $GO (36 9&.=3 9 $QCVT HEAD[5 6])/tok
[20]  $GO (36=3 9 $QCVT HEAD[5])/np
[21]  'Must be a host object unit' $DMD $GO 0
[22] tok:$GO (0=SEV_3 18 $QCVT HEAD[12 13])/sok
[23]  '''',($QFID N),''' has severity: ',$FMTSEV
[24] sok:OUSECTION N
[25]  OUDEFN N
[26]  OUREF N
[27]  OUSEG N
[28]  OUPROG N
[29]  PROGRELSECT
[30]  PROG_(8#$MAX($R PROG)%8)$TAKPROG
[31]  $GO nxt
[32] np:' Skipping: ',1$DRPHKEY
[33] nxt:XX_$QFREAD N HKEY 0 3          $COM Reposition to head rec
[34]  $GO (0=$R HEAD_GETHEAD N)/0 $DMD HKEY_$QFRKEY N,2
[35]  $GO next
    "
 
$COM  $QAV          18
$COM  $QCVT         19    20    22
$COM  $QFID         17    23
$COM  $QFREAD       33
$COM  $QFRKEY       34
$COM  DEBUG         15    15
$COM  DEFBASE        0
$COM  F              0    14    15
$COM  GETHEAD       16    34
$COM  HEAD           0    16_   18    19]   20]   22]   34_
$COM  HKEY           0    32    33    34_
$COM  N              0    14_   16    23    24    25    26    27    28    33
$COM                34    34
$COM  NEWDEFS        0
$COM  NEWREFS        0
$COM  OPENFID       14
$COM  OUDEFN        25
$COM  OUPROG        28
$COM  OUREF         26
$COM  OUSECTION     24
$COM  OUSEG         27
$COM  PROG          30_   30    30
$COM  PROGBASE       0
$COM  PROGRELSECT   29
$COM  REFBASE        0
$COM  REFMAP         0
$COM  SECTBASE       0
$COM  SEV            0    22_   23
$COM  UTS            0    18_
$COM  XX             0    14_   14    18_   33_
$COM  gh            14    15:
$COM  next          16    18:   35
$COM  np            20    32:
$COM  nxt           31    33:
$COM  sok           22    24:
$COM  tok           19    22:
 
 
 
;'        Function: FOLD       '
 
 
    " R_N FOLD R;W;Z
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $GO (0$NE$QNC 'N')/ok $DMD N_$QPW
[3]  ok:$GO (1$GEW_$MIN$QPW%6+Z_-1$TAK$R R)/x
[4]   R_(($TAK$R R),Z+6)$TAKR
[5]   W_($MAX($TAK$R R)%W),W#Z+6
[6]   R_W$R (#/W)$TAK,R
[7]  x:W_$QAV $DMD W[$QAV$I '$_$-$NE$"']_-4$TAK'$_$-$NE$"',(1$NE$QTT)/'_-#"'
[8]   R_W $QXL R
    "
 
$COM  $QAV   7     7
$COM  $QNC   2
$COM  $QPW   2     3
$COM  $QTT   7
$COM  $QXL   8
$COM  N      0     2_
$COM  R      0_    0     3     4_    4     4     5     6_    6     8_    8
$COM  W      0     3_    5_    5     5     6     6     7_    7]_   8
$COM  Z      0     3_    4     5
$COM  ok     2     3:
$COM  x      3     7:
 
 
 
;'        Function: GETHEAD    '
 
 
    " R_GETHEAD N
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]  nc:(1 2$R io 79)$QSM 'GETHEAD' $DMD R_''
[3]  ok:R_$QFREAD N '' 0 3 $DMD HKEY_2 9 $QCVT $QFRKEY N,2
[4]   $GO (0$NE$R R_('$"'=$TAKHKEY)/R)/0
[5]   (1 2$R nc 79)$QSM 'GETHEAD'
[6]   $GO ((3 9 $QCVT '$"')<3 9 $QCVT HKEY[1])/0
[7]   R_$QFREAD N(HKEY_,'$"')0 3 $DMD $GO 0
[8]  io:R_'' $DMD $GO 0
    "
 
$COM  $QCVT     3     6     6
$COM  $QFREAD   3     7
$COM  $QFRKEY   3
$COM  $QSM      2     5
$COM  HKEY      3_    4     6]    7_
$COM  N         0     3     3     7
$COM  R         0_    2_    3_    4_    4     7_    8_
$COM  io        2     8:
$COM  nc        2:    5
$COM  ok        3:
 
 
 
;'        Function: OPENFID    '
 
 
    " {R}_F OPENFID N
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   (io,[1.5]71 73 75 76 77 78)$QSM 'OPENFID'
[3]   $QFCLOSE(N$E $QFNUMS)/N
[4]   (F,',IN')$QFOPEN N
[5]   $GO 0,R_''
[6]  io:R_$XEC')?'
    "
 
$COM  $QFCLOSE   3
$COM  $QFNUMS    3
$COM  $QFOPEN    4
$COM  $QSM       2
$COM  F          0     4
$COM  N          0     3     3     4
$COM  R          0     5_    6_
$COM  io         2     6:
 
 
 
;'        Function: OUDEFN     '
 
 
    " OUDEFN N;M;Z;I;J;K;NEWDEFS
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   M_$TAK$R Z_8 MAKEMAT OUREAD N,6 $DMD DEFBASE_$TAK$R DNAMES
[3]  $COM      sect#, offset, name#
[4]   J_(SECTBASE+3 9 $QCVT Z[;2]),(3 18 $QCVT Z[;3 4]),DEFBASE+$I M
[5]   DDEFS_DDEFS,[1]J
[6]  $COM    names
[7]   DNAMES_DNAMES AND NEWDEFS_(3 18 $QCVT,Z[;4+$I 2])OUNAME N,1
[8]   $GO (0=DEBUG)/nodebug
[9]   '  * Definitions'
[10]  '  -- Def -- Section --- Offset --- Name -------------------'
[11]  (8 0 11 0 11 0$FMTJ[;3 1 2]),' ',' ',' ',' ',' ',NEWDEFS
[12]  ' '
[13] nodebug:
[14]  $GO (0$E $R RNAMES)/add
[15]  K_($I $TAK$R RNAMES)$MAX.#RNAMES FINDNAMES NEWDEFS
[16]  $GO (0=$R J_DEFBASE+(K$NE0)/$I $R K)/add $DMD I_(K$NE0)/K
[17]  DREFS[I;$I 2]_1,DDEFS[J;,2]+SECTS[,1+DDEFS[J;1];,3]
[18] add:$GO (0=$R J_(K=0)/$I $R K)/0
[19]  I_1,(DDEFS[J;,2]+SECTS[,1+DDEFS[J;1];,3]),($TAK$R RNAMES)+$I $R J
[20]  DREFS_DREFS,[1]I
[21]  RNAMES_RNAMES AND NEWDEFS[J;]
    "
 
$COM  $QCVT        4     4     7
$COM  AND          7    21
$COM  DDEFS        5_    5    17]   17]   19]   19]
$COM  DEBUG        8
$COM  DEFBASE      2_    4    16
$COM  DNAMES       2     7_    7
$COM  DREFS       17]_  20_   20
$COM  FINDNAMES   15
$COM  I            0    16_   17    19_   20
$COM  J            0     4_    5    11]   16_   17    17    18_   19    19
$COM              19    21
$COM  K            0    15_   16    16    16    16    18    18
$COM  M            0     2_    4
$COM  MAKEMAT      2
$COM  N            0     2     7
$COM  NEWDEFS      0     7_   11    15    21]
$COM  OUNAME       7
$COM  OUREAD       2
$COM  RNAMES      14    15    15    19    21_   21
$COM  SECTBASE     4
$COM  SECTS       17]   19]
$COM  Z            0     2_    4]    4]    7]
$COM  add         14    16    18:
$COM  nodebug      8    13:
 
 
 
;'        Function: OUPROG     '
 
 
    " OUPROG N;BASE;J;K;KEY;R;S;TYPE;Z;PROGBASE
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   (1 2$R nk 79)$QSM 'OUPROG'
[3]   Z_'' $DMD Z_$QFREAD N,($ENCXX,TYPE_$QAV[10+$QIO]),0 3
[4]  nk:(1 2$R 0 79)$QSM 'OUPROG' $DMD BASE_$R PROG
[5]  lp:Z_$QFREAD N,'' 0 3 $DMD KEY_$QFRKEY N,2
[6]   $GO ((KEY[6]$NETYPE)$ORXX$OR.$NE5$TAKKEY)/0
[7]   $GO (0$NE3 9 $QCVT KEY[11])/reloc
[8]   PROG_PROG,((PROGBASE_BASE+4#3 18 $QCVT KEY[8+$I 2])$-$R PROG)$R $TAK$QAV
[9]   PROG_PROG,Z
[10]  $GO lp
[11] reloc:Z_36 MAKEMAT 1 1 $QCVT Z
[12]  J_(3 4 $QCVT Z[;$I 8]),Z[;5],(3 9 $QCVT Z[;9+$I 9]),3 18 $QCVT Z[;18+$I 18]
[13]  $GO (0$E K_J[;1])/norel
[14]  S_(K=1)/$I $R K
[15]  J[S;4]_J[S;4]+SECTBASE
[16]  S_(K=3)/$I $R K
[17]  J[S;4]_REFMAP[1+J[S;4]]
[18]  J[;5]_J[;5]+PROGBASE%4
[19]  REL_REL,[1]J
[20]  $GO lp
[21] norel:'******* Cannot handle a relocation directive ********' $QERS 999
    "
(1 2$R -1 900)$QSM 'OUPROG     '
 
$COM  $QAV        3]    8
$COM  $QCVT       7     8    11    12    12    12
$COM  $QERS      21
$COM  $QFREAD     3     5
$COM  $QFRKEY     5
$COM  $QIO        3
$COM  $QSM        2     4
$COM  BASE        0     4_    8
$COM  J           0    12_   13]   15]_  15]   17]_  17]   18]_  18]   19
$COM  K           0    13_   14    14    16    16
$COM  KEY         0     5_    6]    6     7]    8]
$COM  MAKEMAT    11
$COM  N           0     3     5     5
$COM  PROG        4     8_    8     8     9_    9
$COM  PROGBASE    0     8_   18
$COM  R           0
$COM  REFMAP     17]
$COM  REL        19_   19
$COM  S           0    14_   15    15    16_   17    17
$COM  SECTBASE   15
$COM  TYPE        0     3_    6
$COM  XX          3     6
$COM  Z           0     3_    3_    5_    9    11_   11    12]   12]   12]
$COM             12]
$COM  lp          5:   10    20
$COM  nk          2     4:
$COM  norel      13    21:
$COM  reloc       7    11:
 
 
 
;'        Function: OUREF      '
 
 
    " OUREF N;Z;M;I;NEWREFS;J;NR;NEW
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   M_$TAK$R Z_4 MAKEMAT OUREAD N,7 $DMD NR_$TAK$R RNAMES
[3]   NEWREFS_(3 18 $QCVT,Z[;$I 2])OUNAME N,2
[4]   NEW_0=I_($I NR)$MAX.#RNAMES FINDNAMES NEWREFS
[5]   REFMAP_-1+I+NEW#NR++\NEW
[6]  $COM     found, offset, name#
[7]   J_0,0,[1.5]NR+$I +/NEW
[8]   DREFS_DREFS,[1]J
[9]  $COM
[10]  RNAMES_RNAMES AND NEW$RD1NEWREFS
[11]  $GO ((0$E $R REFMAP)$OR0=DEBUG)/0
[12]  '  * REFs'
[13]  '  -- Ref -- Ok --- Offset --- Name ---------------------'
[14]  (8 0 6 0 11 0$FMTDREFS[1+REFMAP;3 1 2]),' ',' ',' ',' ',' ',RNAMES[DREFS[1+REFMAP;3];]
[15]  ' '
    "
 
$COM  $QCVT        3
$COM  AND         10
$COM  DEBUG       11
$COM  DREFS        8_    8    14]   14]
$COM  FINDNAMES    4
$COM  I            0     4_    5
$COM  J            0     7_    8
$COM  M            0     2_
$COM  MAKEMAT      2
$COM  N            0     2     3
$COM  NEW          0     4_    5     5     7    10
$COM  NEWREFS      0     3_    4    10
$COM  NR           0     2_    4     5     7
$COM  OUNAME       3
$COM  OUREAD       2
$COM  REFMAP       5_   11    14    14
$COM  RNAMES       2     4    10_   10    14]
$COM  Z            0     2_    3]
 
 
 
;'        Function: OUSECTION  '
 
 
    " OUSECTION N;I;J;Z
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   I_$TAK$R Z_8 MAKEMAT OUREAD N,3
[3]   J_(3 18 $QCVT Z[;2+$I 2]),(SECTKNT+$I I)
[4]   J_J,(0,-1$DRP+\J[;1])+($R PROG)%4
[5]   SECTS_SECTS,[1]J
[6]   SNAMES_SNAMES AND(3 18 $QCVT,Z[;4+$I 2])OUNAME N,1
[7]   SECTBASE_SECTKNT $DMD SECTKNT_SECTKNT+I
[8]   $GO (0=DEBUG)/0
[9]   '* OUSECTION'
[10]  '-- Num --- Size -- Base -- Name --------------'
[11]  (6 0 9 0 8 0$FMT(1$-($I I)$-SECTKNT),J[;1 3]),' ',' ',' ',' ',SNAMES[J[;2];]
[12]  ' '
    "
 
$COM  $QCVT       3     6
$COM  AND         6
$COM  DEBUG       8
$COM  I           0     2_    3     7    11
$COM  J           0     3_    4_    4     4]    5    11]   11]
$COM  MAKEMAT     2
$COM  N           0     2     6
$COM  OUNAME      6
$COM  OUREAD      2
$COM  PROG        4
$COM  SECTBASE    7_
$COM  SECTKNT     3     7     7_    7    11
$COM  SECTS       5_    5
$COM  SNAMES      6_    6    11]
$COM  Z           0     2_    3]    6]
 
 
 
;'        Function: OUSEG      '
 
 
    " OUSEG N;Z;J;M
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   M_$TAK$R Z_4 MAKEMAT OUREAD N,9
[3]   J_(3 18 $QCVT,Z[;$I 2])OUNAME N,2
[4]   $GO ('ISSID'$EQV,J)/0
[5]   'Reference to non-instruction segment!'
    "
 
$COM  $QCVT      3
$COM  J          0     3_    4
$COM  M          0     2_
$COM  MAKEMAT    2
$COM  N          0     2     3
$COM  OUNAME     3
$COM  OUREAD     2
$COM  Z          0     2_    3]
 
 
 
;'        Function: PROGRELSECT'
 
 
    " PROGRELSECT;Z;J;T;NREL;I;LOOSE;NL;ISSID
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   Z_PROG
[3]  $COM  First relocate by section with half words
[4]   J_(LOOSE_(REL[;1]=1)&2>REL[;2])/NREL_$I $TAK$R REL
[5]   I_((2#REL[J;2])+4#REL[J;5])$SC.+$I 2
[6]   Z[I]_0 2$DRP2 9 $QCVT(SECTS[1+REL[J;4];,3]#1 -1[1+REL[J;,3]])+3 18 $QCVT Z[I]
[7]  $COM  Now relocate by section with full words
[8]  $COM  J_(NL_(REL[;1]=1)&4=REL[;2])/NREL $DMD LOOSE_LOOSE$ORNL
[9]  $COM  I_(4#REL[J;5])$SC.+$I  4
[10] $COM Z[I]_2 9 $QCVT(SECTS[REL[J;4];,3]#1 -1[1+REL[J;,3]])+3 36 $QCVT Z[I]
[11] $COM  Now for every section being relocated by segref and field RightHalf
[12]  J_(NL_(REL[;1]=6)&1=REL[;2])/NREL $DMD LOOSE_LOOSE$ORNL
[13]  I_(2+4#REL[J;5])$SC.+$I 2 $DMD ISSID_2048         $COM ISSID ==>  AS0SID
[14]  Z[I]_0 2$DRP2 9 $QCVT ISSID+3 18 $QCVT Z[I]
[15] $COM Z[I]_2 9 $QCVT(0 -12$DRPT),0 24$DRP1 1 $QCVT ISSID+3 12 $QCVT 0 6$DRPT_1 1 $QCVT Z[I]
[16] $COM  Now for the resolved refs
[17]  $GO (0=$R J_(NL_(3=REL[;1])&(0=REL[;2])&0$NEDREFS[1+REL[;4];1])/NREL)/nr
[18]  I_((2#REL[J;2])+4#REL[J;5])$SC.+$I 2 $DMD LOOSE_LOOSE$ORNL
[19]  Z[I]_0 2$DRP2 9 $QCVT(DREFS[1+REL[J;4];,2]#1 -1[1+REL[J;,3]])+3 18 $QCVT Z[I]
[20] nr:REL_(~LOOSE)$RD1REL
[21]  PROG_Z
    "
 
$COM  $QCVT    6     6    14    14    19    19
$COM  DREFS   17]   19]
$COM  I        0     5_    6     6    13_   14    14    18_   19    19
$COM  ISSID    0    13_   14
$COM  J        0     4_    5     5     6     6    12_   13    17_   18    18
$COM          19    19
$COM  LOOSE    0     4_   12_   12    18_   18    20
$COM  NL       0    12_   12    17_   18
$COM  NREL     0     4_   12    17
$COM  PROG     2    21_
$COM  REL      4]    4]    4     5]    5]    6]    6]   12]   12]   13]   17]
$COM          17]   17]   18]   18]   19]   19]   20_   20
$COM  SECTS    6]
$COM  T        0
$COM  Z        0     2_    6]_   6]   14]_  14]   19]_  19]   21
$COM  nr      17    20:
 
 
 
;'        Function: AND        '
 
 
    " R_A AND B;I;J
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   (1 2$R le 6)$QSM 'AND'
[3]   R_A,[1]B
[4]   $GO 0
[5]  le:I_($R A)[2]$MAX($R B)[2]
[6]   R_((($TAK$R A),I)$TAKA),[1](($TAK$R B),I)$TAKB
    "
 
$COM  $QSM   2
$COM  A      0     3     5     6     6
$COM  B      0     3     5     6     6
$COM  I      0     5_    6     6
$COM  J      0
$COM  R      0_    3_    6_
$COM  le     2     5:
 
 
 
;'        Function: FINDNAMES  '
 
 
    " R_A FINDNAMES B;M;I;MYNAME
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   (1 2$R le 6)$QSM MYNAME_'FINDNAMES'
[3]  go:R_A&.=$TPSB
[4]   $GO 0
[5]  le:$GO (I=M_($R A)[2]$MAXI_2$DSC$R B)/xrn
[6]   B_(($TAK$R B),M)$TAKB $DMD $GO go
[7]  xrn:A_(($TAK$R A),M)$TAKA $DMD $GO go
    "
 
$COM  $QSM      2
$COM  A         0     3     5     7_    7     7
$COM  B         0     3     5     6_    6     6
$COM  I         0     5     5_
$COM  M         0     5_    6     7
$COM  MYNAME    0     2_
$COM  R         0_    3_
$COM  go        3:    6     7
$COM  le        2     5:
$COM  xrn       5     7:
 
 
 
;'        Function: MAKEMAT    '
 
 
    " R_A MAKEMAT B
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_((($R B)%A),A)$R B
    "
 
$COM  A   0     2     2
$COM  B   0     2     2
$COM  R   0_    2_
 
 
 
;'        Function: OUNAME     '
 
 
    " R_I OUNAME N;K;L;M;Z;$QIO
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $QIO_1
[3]   Z_OUREAD N
[4]   M_$MAX/0,L_3 9 $QCVT Z[(-2+4#$I ($R Z)%4)[1+I]]
[5]   K_2+I#4
[6]   Z_(($I $R Z)$E (,L$SC.$GE$I M)/,K$SC.+$I M)/Z
[7]   R_(($R I),M)$R (,L$SC.$GE$I M)\Z
    "
 
$COM  $QCVT     4
$COM  $QIO      0     2_
$COM  I         0     4     5     7
$COM  K         0     5_    6
$COM  L         0     4_    6     7
$COM  M         0     4_    6     6     7     7
$COM  N         0     3
$COM  OUREAD    3
$COM  R         0_    7_
$COM  Z         0     3_    4]    4     6_    6     6     7
 
 
 
;'        Function: OUREAD     '
 
 
    " R_OUREAD N;KEY;TYPE;Z
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   (1 2$R nk 79)$QSM 'OUREAD'
[3]   R_'' $DMD R_$QFREAD N[1],($ENCXX,TYPE_$QAV[N[2]+$QIO]),0 3
[4]  nk:(1 2$R 0 79)$QSM 'OUREAD'
[5]  lp:Z_$QFREAD N[1],'' 0 3 $DMD KEY_6$TAK$QFRKEY N[1],2
[6]   $GO ((KEY[6]$NETYPE)$ORXX$OR.$NE5$TAKKEY)/0
[7]   R_R,Z
[8]   $GO lp
    "
 
$COM  $QAV      3]
$COM  $QFREAD   3     5
$COM  $QFRKEY   5
$COM  $QIO      3
$COM  $QSM      2     4
$COM  KEY       0     5_    6]    6
$COM  N         0     3]    3]    5]    5]
$COM  R         0_    3_    3_    7_    7
$COM  TYPE      0     3_    6
$COM  XX        3     6
$COM  Z         0     5_    7
$COM  lp        5:    8
$COM  nk        2     4:
 
 
 
LINKPACK _'LINK       MAP        SETUPOU    FOLD       GETHEAD    OPENF'
LINKPACK _LINKPACK ,'ID    OUDEFN     OUPROG     OUREF      OUSECTION  OUSEG     '
LINKPACK _LINKPACK ,' PROGRELSECTAND        FINDNAMES  MAKEMAT    OUNAME     OURE'
_$QEX $QPNAMES LINKPACK _$QPACK 17 11$RLINKPACK ,'AD     '
' ********  Package:   PARSEPACK      ********'
 
 
 
 
 
 
;'        Function: NODEINFO   '
 
 
    " R_NODEINFO N;AND;I;J;LOC;T
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   'AND' $QPDEF LINKPACK
[3]   N_2 9 $QCVT(-3+N[1])$DRPN
[4]   R_0 5$R ' ' $DMD LOC_0/J_0 $DMD $GO (0=T_3 18 $QCVT N[1 2])/e
[5]   N_2$DRPN
[6]  lp:LOC_LOC,3 18 $QCVT N[1 2]
[7]   R_R AND(1,I)$R N[3+$I I_3 9 $QCVT N[3]]
[8]   $GO ((0$NE$R N_(3+I)$DRPN)&T>J_J+1)/lp
[9]  e:R_R LOC
    "
 
$COM  $QCVT       3     4     6     7
$COM  $QPDEF      2
$COM  AND         0     7
$COM  I           0     7     7_    8
$COM  J           0     4_    8_    8
$COM  LINKPACK    2
$COM  LOC         0     4_    6_    6     9
$COM  N           0     3_    3]    3     4]    5_    5     6]    7]    7]
$COM              8_    8
$COM  R           0_    4_    7_    7     9_    9
$COM  T           0     4_    8
$COM  e           4     9:
$COM  lp          6:    8
 
 
 
;'        Function: AND        '
 
 
    " R_A AND B;I;J
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   (1 2$R le 6)$QSM 'AND'
[3]   R_A,[1]B
[4]   $GO 0
[5]  le:I_($R A)[2]$MAX($R B)[2]
[6]   R_((($TAK$R A),I)$TAKA),[1](($TAK$R B),I)$TAKB
    "
 
$COM  $QSM   2
$COM  A      0     3     5     6     6
$COM  B      0     3     5     6     6
$COM  I      0     5_    6     6
$COM  J      0
$COM  R      0_    3_    6_
$COM  le     2     5:
 
 
 
;'        Function: DISPNODE   '
 
 
    " R_N DISPNODE NODE;L;S
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_(2 0$FMTN),' $- ',(9$TAK(NODE[1]+1)$DSCNODETYPES),'@ ',$FMTNODE[3]
[3]   R_R,', Code=',NODECODE NODE[2]
[4]   R_R,(0$NEL)/' (',($FMTL_$R S),') ''',(S_4$DSCNODE),''''
[5]   R_(1,$R R)$R R
[6]   $GO (0=$R NODE_4$DRPNODE)/0 $DMD N_0
[7]  lp:L_$R S_N DISPNODE$TAKNODE
[8]   R_R AND('+',(-1+L[1])$R ' |'[1+1<$R NODE]),S
[9]   N_N+1
[10]  $GO (0$NE$R NODE_1$DRPNODE)/lp
    "
 
$COM  AND         8
$COM  DISPNODE    7
$COM  L           0     4     4_    7_    8]
$COM  N           0     2     6_    7     9_    9
$COM  NODE        0     2]    2]    3]    4     6_    6     7     8    10_
$COM             10
$COM  NODECODE    3
$COM  NODETYPES   2
$COM  R           0_    2_    3_    3     4_    4     5_    5     5     8_
$COM              8
$COM  S           0     4     4_    7_    8
$COM  lp          7:   10
 
 
 
;'        Function: NODETYPES  '
 
 
    " R_NODETYPES
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_'*unused*' 'Altern' 'Koncat' 'List' 'Literal' 'Dstring' 'Eol' 'Blank'
[3]   R_R,($ENC'RALTERN'),7$R R[1]
[4]   R_R,'Null' 'Oct' 'Dec' 'Alpha' 'Alnum' 'Sym' 'Fid' 'Asym' 'PL6sym' 'Hex'
[5]   R_R,'Jobname' 'Account' 'Rtext',R[1 1]
    "
 
$COM  R   0_    2_    3_    3     3]    4_    4     5_    5     5]
 
 
 
;'        Function: GETNODENAME'
 
 
    " RS_NODES GETNODENAME LF;IN;I;J;K;TEQU;OPENFID;ERRS;FOLD;R
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   'OPENFID' $QPDEF LINKPACK
[3]   $GO (0=$TAK0/RS_R_,$TAKLF)/x $DMD RS_,4 $DMD ERRS_0
[4]   $GO (1<$EQVR)/eh $DMD $GO (' '$OR.$NE$TAK0/$ENCR)/eh
[5]   (NAMES LOCS)_NODEINFO NODES $DMD (I J)_$R NAMES
[6]   $GO (' '$OR.$NER)/lok
[7]  gi:$GO (' '&.=R_GETINP 'Node? ')/gi
[8]  lok:$GO ((2<$R TEQU),(,'*')$EQV$TAKTEQU_$QTLEX R ' ,')/er nn
[9]   $GO (J<$R R_$TAKTEQU)/nf
[10]  $GO (0=$R K_(NAMES&.=J$TAKR)/$I I)/nf $DMD RS_LOCS[K]
[11] nn:$GO (1$GE$R TEQU)/x $DMD K_2$DSCTEQU $DMD $GO vf
[12]  K_$TAKTEQU $DMD $GO vf
[13] gf:$GO (' '&.=K_GETINP 'EQUs? ')/0
[14] vf:$GO (0=$R I_K OPENFID 1)/ge $DMD I $DMD $GO gf
[15] ge:(EQNAMES EQVALS)_GETEQUS K $DMD $GO 0
[16] nf:'''',R,''' is not there!' $DMD $GO (2$NEERRS_ERRS+1)/gi
[17]  'Legal node names are:' $DMD 'FOLD' $QPDEF LINKPACK $DMD FOLD NAMES
[18]  $GO gi
[19] eh:'Incorrect left argument to PARSE' $QERS 910
[20] x:$GO (1$GE$R ,LF)/0 $DMD $GO ((0=$R K),1$GE$EQVK_2$DSCLF)/gf vf
[21]  $GO (2$NE$R K)/eh
[22]  (EQNAMES EQVALS)_K $DMD $GO 0
    "
(1 2$R -1 900)$QSM 'GETNODENAME'
 
$COM  $QERS      19
$COM  $QPDEF      2    17
$COM  $QTLEX      8
$COM  EQNAMES    15    22
$COM  EQVALS     15    22
$COM  ERRS        0     3_   16_   16
$COM  FOLD        0    17
$COM  GETEQUS    15
$COM  GETINP      7    13
$COM  I           0     5    10    14_   14
$COM  IN          0
$COM  J           0     5     9    10
$COM  K           0    10_   10    11_   12_   13_   14    15    20    20_
$COM             21    22
$COM  LF          0     3    20    20
$COM  LINKPACK    2    17
$COM  LOCS        5    10]
$COM  NAMES       5     5    10    17
$COM  NODEINFO    5
$COM  NODES       0     5
$COM  OPENFID     0    14
$COM  R           0     3_    4     4     6     7_    8     9_   10    16
$COM  RS          0_    3_    3_   10_
$COM  TEQU        0     8     8_    9    11    11    12
$COM  eh          4     4    19:   21
$COM  er          8
$COM  ge         14    15:
$COM  gf         13:   14    20
$COM  gi          7:    7    16    18
$COM  lok         6     8:
$COM  nf          9    10    16:
$COM  nn          8    11:
$COM  vf         11    12    14:   20
$COM  x           3    11    20:
 
 
 
;'        Function: GETNODES   '
 
 
    " N_GETNODES N;I;IN;OPENFID;T;XX;F
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $GO ((0=$TAK0/N)&0<$R N)/0
[3]   'OPENFID' $QPDEF LINKPACK
[4]   $GO (0$NE$R N)/pi $DMD N_''
[5]  gi:$GO ((T&0=$R N),T_' '&.=IN_GETINP ' Fid? ')/gi xi
[6]   $GO (~1$E F_0$NE$TAK$"$R $"XX_(T_$QTLEX IN ' ,')OPENFID$"1)/fok
[7]   $DSCF/XX $DMD N_N,,' ',$DSC(~F)/T $DMD $GO gi
[8]  pi:$GO (1<$EQVN)/eh $DMD $GO (' '&.=$TAK0/$ENCN)/xi
[9]  eh:'Eh? Incorrect PARSE argument' $DMD $GO 1,N_''
[10] fok:N_N,' ',IN $DMD $GO gi
[11] xi:$GO (4$GE$TAKN_LINKNODES N)/eh
    "
 
$COM  $QPDEF       3
$COM  $QTLEX       6
$COM  F            0     6_    7     7
$COM  GETINP       5
$COM  I            0
$COM  IN           0     5_    6    10
$COM  LINKNODES   11
$COM  LINKPACK     3
$COM  N            0_    0     2     2     4     4_    5     7_    7     8
$COM               8     9_   10_   10    11_   11
$COM  OPENFID      0     6
$COM  T            0     5     5_    6_    7
$COM  XX           0     6_    7
$COM  eh           8     9:   11
$COM  fok          6    10:
$COM  gi           5:    5     7    10
$COM  pi           4     8:
$COM  xi           5     8    11:
 
 
 
;'        Function: SETINP     '
 
 
    " SETINP
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   XPRMPT_$QONL
[3]   $XEC')SET $Q1 ME' $DMD $QBVFC 1 1 $DMD $QBECHO 1 1
    "
 
$COM  $QBECHO   3
$COM  $QBVFC    3
$COM  $QONL     2
$COM  XPRMPT    2_
 
 
 
;'        Function: GETINP     '
 
 
    " R_GETINP P
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $GO (0=XPRMPT)/in $DMD $Q1_'@',P
[3]  in:$GO (0$NE$TAKR_$Q1)/0
[4]   $QERS 100
    "
(1 2$R -1 900)$QSM 'GETINP     '
 
$COM  $QERS     4
$COM  P         0     2
$COM  R         0_    3_
$COM  XPRMPT    2
$COM  in        2     3:
 
 
 
;'        Function: DOEQU      '
 
 
    " R_DOEQU N;NAME;VAL;I;J
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   NAME_(2$DSCN)[4]              $COM     Name being defined
[3]   $GO ((1 2$DSCN)$ORJ_($R EQNAMES)<I_EQNAMES$I NAME)/ok
[4]   '*** ''',($TAKNAME),''' is being reEQU''ed illegally!'
[5]  ok:VAL_EQUVAL 2$DRPN
[6]   $GO (~J)/ins $DMD EQNAMES_EQNAMES,NAME $DMD EQVALS_EQVALS,0
[7]  ins:EQVALS[I]_VAL
[8]   $GO 0
    "
 
$COM  EQNAMES   3     3     6_    6
$COM  EQUVAL    5
$COM  EQVALS    6_    6     7]_
$COM  I         0     3_    7
$COM  J         0     3_    6
$COM  N         0     2     3     5
$COM  NAME      0     2_    3     4     6
$COM  R         0_
$COM  VAL       0     5_    7
$COM  ins       6     7:
$COM  ok        3     5:
 
 
 
;'        Function: EQUVAL     '
 
 
    " R_R EQUVAL B;NODE;I
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $GO (0=$R B)/0
[3]   $GO (0 1 2 3=2$DSCNODE_1$DSCB)/dec name plus minus
[4]   '* * Equ System Error * * * ' $DMD $GO 0
[5]  dec:R_($QFI 4$DSCNODE)EQUVAL 1$DRPB $DMD $GO 0
[6]  name:$GO (($R EQNAMES)<I_EQNAMES$I NODE[4])/nf
[7]   R_(EQVALS[I])EQUVAL 1$DRPB $DMD $GO 0
[8]  plus:R_(R+EQUVAL B[,2])EQUVAL 2$DRPB $DMD $GO 0
[9]  minus:R_(R$-EQUVAL B[,2])EQUVAL 2$DRPB $DMD $GO 0
[10] nf:' Name: ''',(4$DSCNODE),''' is not defined: 0 used.'
[11]  R_0 EQUVAL 1$DRPB $DMD $GO 0
    "
 
$COM  $QFI       5
$COM  B          0     2     3     5     7     8]    8     9]    9    11
$COM  EQNAMES    6     6
$COM  EQUVAL     5     7     8     8     9     9    11
$COM  EQVALS     7]
$COM  I          0     6_    7
$COM  NODE       0     3_    5     6]   10
$COM  R          0_    0     5_    7_    8_    8     9_    9    11_
$COM  dec        3     5:
$COM  minus      3     9:
$COM  name       3     6:
$COM  nf         6    10:
$COM  plus       3     8:
 
 
 
;'        Function: REMCMNT    '
 
 
    " R_REMCMNT R;P;Q;L;INCOMMENT
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $GO (0=$R P_$QSSS R '/*')/e
[3]   Q_1+$QSSS R '*/'
[4]   INCOMMENT_($R Q)$NE$R P_(L$NE-1$DRP-1,L_+/P$SC.<Q)/P
[5]   R_(~$OR$RD1(P$SC.$LE$I $R R)&(Q,INCOMMENT/$R R)$SC.$GE$I $R R)/R
[6]   R_INCOMMENT R $DMD $GO 0
[7]  e:R_0 R $DMD $GO 0
    "
 
$COM  $QSSS        2     3
$COM  INCOMMENT    0     4_    5     6
$COM  L            0     4     4_
$COM  P            0     2_    4_    4     4     5
$COM  Q            0     3_    4     4     5
$COM  R            0_    0     2     3     5_    5     5     5     5     6_
$COM               6     7_    7
$COM  e            2     7:
 
 
 
;'        Function: NODECODE   '
 
 
    " R_NODECODE N;I
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   $GO (($R EQVALS)<I_EQVALS$I N)/fmt
[3]   R_(I$DSCEQNAMES),' ' $DMD R_(6$MAX$R R)$TAKR $DMD $GO 0
[4]  fmt:R_,'LI6' $QFMT N
    "
 
$COM  $QFMT      4
$COM  EQNAMES    3
$COM  EQVALS     2     2
$COM  I          0     2_    3
$COM  N          0     2     4
$COM  R          0_    3_    3_    3     3     4_
$COM  fmt        2     4:
 
 
 
;'        Function: PARSEEQU   '
 
 
    " R_PARSEEQU
[1]  $COM*T* Copyright (c) Bull HN Information Systems Inc., 1989
[2]   R_46 -34292301824 2623488 6031360 3409920 6293504
[3]   R_R,3934208 8657174528 4458496 5244928 -25702694912 150208512
[4]   R_R,-25702694912 149684224 -25149046784 546605649 11408506880 -25149046783
[5]   R_R,546612805 11274289152 -16575430652 8657174528 7079936 8652800
[6]   R_R,-34292498432 9439232 7866368 -34024062976 9963520 6293504
[7]   R_R,-34292498432 9701376 7866368 -16575823872 -16575430655 8657174528
[8]   R_R,10749952 11274240 -25165823998 145489920 -25165823997 146014208
[9]   R_R,4303372320 262148 957653589 12768287300
[10]  $GO 0
[11] $COM /*   These nodes attempt to accept a simplified version of
[12] $COM      PL6 pre$-processor $R SET and $R EQU expressions.  The expressions
[13] $COM      are limited to  (decimal | name) +/$- (decimal|name).
[14] $COM */
[15] $COM
[16] $COM EQU$_CMD    =  (EQU | SET) ANAME '=' EXPR ';'
[17] $COM
[18] $COM EQU     (0)   =  '$REQU'
[19] $COM SET     (1)   =  '$RSET'
[20] $COM
[21] $COM ANAME   (4)   =  .PL6sym
[22] $COM
[23] $COM EXPR          =  ( CONSTANT [OPR EXPR]  | SYMBOL [OPR EXPR])
[24] $COM
[25] $COM CONSTANT (0)  =  .dec
[26] $COM SYMBOL   (1)  =  .PL6sym
[27] $COM
[28] $COM OPR           =  (PLUS | MINUS)
[29] $COM PLUS     (2)  =  '+'
[30] $COM MINUS    (3)  =  '$-'
    "
 
$COM  R              0_    2_    3_    3     4_    4     5_    5     6_    6
$COM                 7_    7     8_    8     9_    9
 
 
 
PARSEPACK_'NODEINFO   AND        DISPNODE   NODETYPES  GETNODENAMEGETNO'
PARSEPACK_PARSEPACK,'DES   SETINP     GETINP     DOEQU      EQUVAL     REMCMNT   '
_$QEX $QPNAMES PARSEPACK_$QPACK 13 11$RPARSEPACK,' NODECODE   PARSEEQU   '
$QPW_80
$XEC ')TERM INPUT ',$FMT $QTT
)SET INPUT ME
