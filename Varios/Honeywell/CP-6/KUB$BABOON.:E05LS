VERSION E05

PL6.E3A0      #001=KUB$WRITE File=KUB$BABOON.:E05TSI                             WED 07/30/97 01:51 Page:1    
        1        1        /*M* KUB$BABOON Handling for monitor DCB station BABOON */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /*P* NAME: KUB$BABOON
        9        9             PURPOSE:
       10       10                  KUB$BABOON contains the procedures necessary to init, read
       11       11                  and write the monitor DCB station, BABOON
       12       12             DESCRIPTION:
       13       13                  None.
       14       14        */
       15       15        KUB$WRITE: PROC (BUF, LEN, STA) ALTRET;
       16       16        /*F* NAME:        KUB$WRITE
       17       17             PURPOSE:     To write through the BABOON monitor DCB station on NETCG
       18       18             INPUT:       BUF - Buffer to write
       19       19                          LEN - Character length of BUF
       20       20                          STA - Station name on HLPCG to write this message to
       21       21             DESCRIPTION: KUB$WRITE writes the message passed in BUF of length,
       22       22                          LEN, to station, STA, on comgroup HLPCG through
       23       23                          station, BABOON. If the write fails, KUB$WRITE will
       24       24                          ALTRET otherwise it will RETURN normally.
       25       25        */
       26       26    1   DCL BUF CHAR(LEN) UNAL;
       27       27    1   DCL LEN UBIN WORD;
       28       28    1   DCL STA CHAR(8) UNAL;
       29       29        /*  */
       30       30    1   DCL KQX$SAVASR ENTRY(1);
       31       31    1   DCL KQX$RESASR ENTRY(1);
       32       32    1   DCL NIO$QUE ENTRY(1) ALTRET;
       33       33    1   DCL NIQ$GET ENTRY(1) ALTRET;
       34       34    1   DCL NIQ$REL ENTRY(1) ALTRET;
       35       35        /*  */
       36       36    1   DCL ALTFLG BIT(1) ALIGNED;
PL6.E3A0      #001=KUB$WRITE File=KUB$BABOON.:E05TSI                             WED 07/30/97 01:51 Page:2    
       37       37    1   DCL Q$ PTR;
       38       38    1   DCL ASRTEMP BIT(72) DALIGNED;
       39       39        /*  */
       40       40    1   DCL NK_BABOONLDX UBIN WORD SYMREF;      /* LDCTX of station BABOON            */
       41       41        /*  */
       42       42        %INCLUDE CP_6_SUBS;
       43      582        %INCLUDE N$REQ;
       44      656        %INCLUDE N_FC_C;
       45      693        %INCLUDE KC_CP6;
       46     1253        %VLP_STATION (FPTN=CSTA,STCLASS=CONSTANT);
       47     1280        %VLP_STATION (FPTN=ASTA,STCLASS="");
       48     1307        %N$REQ;
       49     1365
       50     1366    1         CALL NIQ$GET (Q$) ALTRET (JUSTALT); /* Get an IOQ packet             */
       51     1367    1         Q$ -> N$REQ.OPFLG = OP_BPF|OP_HOLD;     /* Set BPF and HOLD          */
       52     1368    1         Q$ -> N$REQ.DLA.DCTX = NK_BABOONLDX; /* Set DCT index                 */
       53     1369    1         Q$ -> N$REQ.FC = %N_WRITE;      /*  Function is write                 */
       54     1370    1         Q$ -> N$REQ.DVE.DVBYTE = %DVBYTE_BP#;   /* Preserve blanks in message */
       55     1371    1         Q$ -> N$REQ.BUF$ = ADDR (BUF);  /* Buffer pointer                     */
       56     1372    1         Q$ -> N$REQ.BUFSIZE = LEN;      /* Buffer length                      */
       57     1373    1         Q$->N$REQ.NOALT='1'B;
       58     1374    1         ASTA=CSTA;
       59     1375    1         ASTA.STATION#=STA;
       60     1376    1         Q$->N$REQ.STATION.LSTA$=ADDR(ASTA);
       61     1377    1         CALL KQX$SAVASR (ASRTEMP);
       62     1378    1         CALL NIO$QUE (Q$->N$REQ);       /* WRITE THRU HLPCG                   */
       63     1379    1         CALL KQX$RESASR (ASRTEMP);
       64     1380    1         IF Q$->N$REQ.TYC=%TYC_EGV
       65     1381    1         THEN ALTFLG='0'B;
       66     1382    1         ELSE ALTFLG='1'B;
       67     1383    1         CALL NIQ$REL(Q$);
       68     1384    1         IF ALTFLG
       69     1385    1         THEN
       70     1386    1   JUSTALT: ALTRETURN;
       71     1387    1         ELSE RETURN;
       72     1388    1   END KUB$WRITE;
       73     1389        %EOD;
PL6.E3A0      #001=KUB$WRITE File=KUB$BABOON.:E05TSI                             WED 07/30/97 01:51 Page:3    

PL6.E3A0      #001=KUB$WRITE File=KUB$BABOON.:E05TSI                             WED 07/30/97 01:51 Page:4    
--  Include file information  --

   KC_CP6.:E05TOU  is referenced.
   N_FC_C.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure KUB$WRITE.

   Procedure KUB$WRITE requires 79 words for executable code.
   Procedure KUB$WRITE requires 20 words of local(AUTO) storage.

PL6.E3A0      #001=KUB$WRITE File=KUB$BABOON.:E05TSI                             WED 07/30/97 01:51 Page:5    

 Object Unit name= KUB$WRITE                                  File name= KUB$BABOON.:E05TOU
 UTS= JUL 30 '97 01:51:53.00 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      8     10  KUB$WRITE
    1   Proc  even  none    79    117  KUB$WRITE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        3  KUB$WRITE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 NIQ$GET
         yes           Std       1 KQX$SAVASR
 yes     yes           Std       1 NIO$QUE
 yes     yes           Std       1 NIQ$REL
         yes           Std       1 KQX$RESASR
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #001=KUB$WRITE File=KUB$BABOON.:E05TSI                             WED 07/30/97 01:51 Page:6    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NK_BABOONLDX                          B_VECTNIL
PL6.E3A0      #001=KUB$WRITE File=KUB$BABOON.:E05TSI                             WED 07/30/97 01:51 Page:7    


        1        1        /*M* KUB$BABOON Handling for monitor DCB station BABOON */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7       /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /*P* NAME: KUB$BABOON
        9        9             PURPOSE:
       10       10                  KUB$BABOON contains the procedures necessary to init, read
       11       11                  and write the monitor DCB station, BABOON
       12       12             DESCRIPTION:
       13       13                  None.
       14       14        */
       15       15        KUB$WRITE: PROC (BUF, LEN, STA) ALTRET;

     15  1 000000   000000 700200 xent  KUB$WRITE    TSX0  ! X66_AUTO_3
         1 000001   000024 000003                    ZERO    20,3

       16       16        /*F* NAME:        KUB$WRITE
       17       17             PURPOSE:     To write through the BABOON monitor DCB station on NETCG
       18       18             INPUT:       BUF - Buffer to write
       19       19                          LEN - Character length of BUF
       20       20                          STA - Station name on HLPCG to write this message to
       21       21             DESCRIPTION: KUB$WRITE writes the message passed in BUF of length,
       22       22                          LEN, to station, STA, on comgroup HLPCG through
       23       23                          station, BABOON. If the write fails, KUB$WRITE will
       24       24                          ALTRET otherwise it will RETURN normally.
       25       25        */
       26       26    1   DCL BUF CHAR(LEN) UNAL;
       27       27    1   DCL LEN UBIN WORD;
       28       28    1   DCL STA CHAR(8) UNAL;
       29       29        /*  */
       30       30    1   DCL KQX$SAVASR ENTRY(1);
       31       31    1   DCL KQX$RESASR ENTRY(1);
PL6.E3A0      #001=KUB$WRITE File=KUB$BABOON.:E05TSI                             WED 07/30/97 01:51 Page:8    
       32       32    1   DCL NIO$QUE ENTRY(1) ALTRET;
       33       33    1   DCL NIQ$GET ENTRY(1) ALTRET;
       34       34    1   DCL NIQ$REL ENTRY(1) ALTRET;
       35       35        /*  */
       36       36    1   DCL ALTFLG BIT(1) ALIGNED;
       37       37    1   DCL Q$ PTR;
       38       38    1   DCL ASRTEMP BIT(72) DALIGNED;
       39       39        /*  */
       40       40    1   DCL NK_BABOONLDX UBIN WORD SYMREF;      /* LDCTX of station BABOON            */
       41       41        /*  */
       42       42        %INCLUDE CP_6_SUBS;
       43      582        %INCLUDE N$REQ;
       44      656        %INCLUDE N_FC_C;
       45      693        %INCLUDE KC_CP6;
       46     1253        %VLP_STATION (FPTN=CSTA,STCLASS=CONSTANT);
       47     1280        %VLP_STATION (FPTN=ASTA,STCLASS="");
       48     1307        %N$REQ;
       49     1365
       50     1366    1         CALL NIQ$GET (Q$) ALTRET (JUSTALT); /* Get an IOQ packet             */

   1366  1 000002   200007 630500                    EPPR0   Q$,,AUTO
         1 000003   200022 450500                    STP0    ASTA+8,,AUTO
         1 000004   200022 630500                    EPPR0   ASTA+8,,AUTO
         1 000005   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000006   000000 701000 xent               TSX1    NIQ$GET
         1 000007   000115 702000 1                  TSX2    JUSTALT

       51     1367    1         Q$ -> N$REQ.OPFLG = OP_BPF|OP_HOLD;     /* Set BPF and HOLD          */

   1367  1 000010   200007 470500                    LDP0    Q$,,AUTO
         1 000011   000014 236007                    LDQ     12,DL
         1 000012   000004 552104                    STBQ    4,'04'O,PR0

       52     1368    1         Q$ -> N$REQ.DLA.DCTX = NK_BABOONLDX; /* Set DCT index                 */

   1368  1 000013   200007 470500                    LDP0    Q$,,AUTO
         1 000014   000000 236000 xsym               LDQ     NK_BABOONLDX
PL6.E3A0      #001=KUB$WRITE File=KUB$BABOON.:E05TSI                             WED 07/30/97 01:51 Page:9    
         1 000015   000025 736000                    QLS     21
         1 000016   000001 676100                    ERQ     1,,PR0
         1 000017   777770 376003                    ANQ     -8,DU
         1 000020   000001 656100                    ERSQ    1,,PR0

       53     1369    1         Q$ -> N$REQ.FC = %N_WRITE;      /*  Function is write                 */

   1369  1 000021   200007 470500                    LDP0    Q$,,AUTO
         1 000022   000015 236007                    LDQ     13,DL
         1 000023   000003 552104                    STBQ    3,'04'O,PR0

       54     1370    1         Q$ -> N$REQ.DVE.DVBYTE = %DVBYTE_BP#;   /* Preserve blanks in message */

   1370  1 000024   200007 470500                    LDP0    Q$,,AUTO
         1 000025   200000 236003                    LDQ     65536,DU
         1 000026   000031 552140                    STBQ    25,'40'O,PR0

       55     1371    1         Q$ -> N$REQ.BUF$ = ADDR (BUF);  /* Buffer pointer                     */

   1371  1 000027   200003 236100                    LDQ     @BUF,,AUTO
         1 000030   000005 756100                    STQ     5,,PR0

       56     1372    1         Q$ -> N$REQ.BUFSIZE = LEN;      /* Buffer length                      */

   1372  1 000031   200004 470500                    LDP0    @LEN,,AUTO
         1 000032   200007 471500                    LDP1    Q$,,AUTO
         1 000033   000000 236100                    LDQ     0,,PR0
         1 000034   000020 736000                    QLS     16
         1 000035   100004 676100                    ERQ     4,,PR1
         1 000036   000034 376000 xsym               ANQ     B_VECTNIL+28
         1 000037   100004 656100                    ERSQ    4,,PR1

       57     1373    1         Q$->N$REQ.NOALT='1'B;

   1373  1 000040   200007 471500                    LDP1    Q$,,AUTO
         1 000041   100000 236007                    LDQ     32768,DL
         1 000042   100004 256100                    ORSQ    4,,PR1
PL6.E3A0      #001=KUB$WRITE File=KUB$BABOON.:E05TSI                             WED 07/30/97 01:51 Page:10   

       58     1374    1         ASTA=CSTA;

   1374  1 000043   000100 100400                    MLR     fill='000'O
         1 000044   000000 000040 0                  ADSC9   CSTA                     cn=0,n=32
         1 000045   200012 000040                    ADSC9   ASTA,,AUTO               cn=0,n=32

       59     1375    1         ASTA.STATION#=STA;

   1375  1 000046   200005 471500                    LDP1    @STA,,AUTO
         1 000047   040100 100500                    MLR     fill='040'O
         1 000050   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         1 000051   200012 000010                    ADSC9   ASTA,,AUTO               cn=0,n=8

       60     1376    1         Q$->N$REQ.STATION.LSTA$=ADDR(ASTA);

   1376  1 000052   200012 633500                    EPPR3   ASTA,,AUTO
         1 000053   200007 474500                    LDP4    Q$,,AUTO
         1 000054   400013 453500                    STP3    11,,PR4

       61     1377    1         CALL KQX$SAVASR (ASRTEMP);

   1377  1 000055   200010 635500                    EPPR5   ASRTEMP,,AUTO
         1 000056   200022 455500                    STP5    ASTA+8,,AUTO
         1 000057   200022 630500                    EPPR0   ASTA+8,,AUTO
         1 000060   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000061   000000 701000 xent               TSX1    KQX$SAVASR
         1 000062   000000 011000                    NOP     0

       62     1378    1         CALL NIO$QUE (Q$->N$REQ);       /* WRITE THRU HLPCG                   */

   1378  1 000063   200007 630500                    EPPR0   Q$,,AUTO
         1 000064   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000065   000000 701000 xent               TSX1    NIO$QUE
         1 000066   000000 011000                    NOP     0

       63     1379    1         CALL KQX$RESASR (ASRTEMP);
PL6.E3A0      #001=KUB$WRITE File=KUB$BABOON.:E05TSI                             WED 07/30/97 01:51 Page:11   

   1379  1 000067   200010 630500                    EPPR0   ASRTEMP,,AUTO
         1 000070   200022 450500                    STP0    ASTA+8,,AUTO
         1 000071   200022 630500                    EPPR0   ASTA+8,,AUTO
         1 000072   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000073   000000 701000 xent               TSX1    KQX$RESASR
         1 000074   000000 011000                    NOP     0

       64     1380    1         IF Q$->N$REQ.TYC=%TYC_EGV

   1380  1 000075   200007 470500                    LDP0    Q$,,AUTO
         1 000076   000021 236100                    LDQ     17,,PR0
         1 000077   000030 116000 xsym               CMPQ    B_VECTNIL+24
         1 000100   000103 601000 1                  TNZ     s:1382

       65     1381    1         THEN ALTFLG='0'B;

   1381  1 000101   200006 450100                    STZ     ALTFLG,,AUTO
         1 000102   000105 710000 1                  TRA     s:1383

       66     1382    1         ELSE ALTFLG='1'B;

   1382  1 000103   400000 236003                    LDQ     -131072,DU
         1 000104   200006 756100                    STQ     ALTFLG,,AUTO

       67     1383    1         CALL NIQ$REL(Q$);

   1383  1 000105   200007 631500                    EPPR1   Q$,,AUTO
         1 000106   200022 451500                    STP1    ASTA+8,,AUTO
         1 000107   200022 630500                    EPPR0   ASTA+8,,AUTO
         1 000110   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000111   000000 701000 xent               TSX1    NIQ$REL
         1 000112   000000 011000                    NOP     0

       68     1384    1         IF ALTFLG

   1384  1 000113   200006 234100                    SZN     ALTFLG,,AUTO
PL6.E3A0      #001=KUB$WRITE File=KUB$BABOON.:E05TSI                             WED 07/30/97 01:51 Page:12   
         1 000114   000116 605000 1                  TPL     s:1387

       69     1385    1         THEN
       70     1386    1   JUSTALT: ALTRETURN;

   1386  1 000115   000000 702200 xent  JUSTALT      TSX2  ! X66_AALT

       71     1387    1         ELSE RETURN;

   1387  1 000116   000000 702200 xent               TSX2  ! X66_ARET

CSTA
 Sect OctLoc
   0     000   040040 040040   040040 040040   040040 040040   040040 040040
   0     004   001000 000000   000000 000000   000000 000000   000000 000000    ................
       72     1388    1   END KUB$WRITE;
       73     1389        %EOD;

PL6.E3A0      #001=KUB$WRITE File=KUB$BABOON.:E05TSI                             WED 07/30/97 01:51 Page:13   
--  Include file information  --

   KC_CP6.:E05TOU  is referenced.
   N_FC_C.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure KUB$WRITE.
PL6.E3A0      #001=KUB$WRITE File=KUB$BABOON.:E05TSI                             WED 07/30/97 01:51 Page:14   

 **** Variables and constants ****

  ****  Section 000 RoData KUB$WRITE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)   r     1 CSTA

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @BUF                       4-0-0/w PTR         r     1 @LEN
     5-0-0/w PTR         r     1 @STA                       6-0-0/w BIT         r     1 ALTFLG
    10-0-0/d BIT (72)    r     1 ASRTEMP                   12-0-0/w STRC(288)   r     1 ASTA
    *0-0-0/c ACHR        r     1 BUF                       *0-0-0/w UBIN        r     1 LEN
     7-0-0/w PTR         r     1 Q$                        *0-0-0/c CHAR(8)     r     1 STA

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 NK_BABOONLDX

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(1080)  r     1 N$REQ


   Procedure KUB$WRITE requires 79 words for executable code.
PL6.E3A0      #001=KUB$WRITE File=KUB$BABOON.:E05TSI                             WED 07/30/97 01:51 Page:15   
   Procedure KUB$WRITE requires 20 words of local(AUTO) storage.
PL6.E3A0      #001=KUB$WRITE File=KUB$BABOON.:E05TSI                             WED 07/30/97 01:51 Page:16   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KUB$WRITE File=KUB$BABOON.:E05TSI                             WED 07/30/97 01:51 Page:17   
          MINI XREF LISTING

ALTFLG
        36**DCL      1381<<ASSIGN   1382<<ASSIGN   1384>>IF
ASRTEMP
        38**DCL      1377<>CALL     1379<>CALL
ASTA
      1292**DCL      1374<<ASSIGN   1376--ASSIGN
ASTA.MSGIDXT
      1302**DCL      1305--REDEF
ASTA.STATION#
      1296**DCL      1375<<ASSIGN
BUF
        26**DCL        15--PROC     1371--ASSIGN
CSTA
      1265**DCL      1374>>ASSIGN
CSTA.MSGIDXT
      1275**DCL      1278--REDEF
JUSTALT
      1386**LABEL    1366--CALLALT
KQX$RESASR
        31**DCL-ENT  1379--CALL
KQX$SAVASR
        30**DCL-ENT  1377--CALL
LEN
        27**DCL        15--PROC       26--IMP-SIZ  1372>>ASSIGN
N$REQ
      1316**DCL      1378<>CALL
N$REQ.BUF$
      1325**DCL      1371<<ASSIGN
N$REQ.BUFADDR
      1325**DCL      1326--REDEF    1326--REDEF
N$REQ.BUFSIZE
      1319**DCL      1372<<ASSIGN
PL6.E3A0      #001=KUB$WRITE File=KUB$BABOON.:E05TSI                             WED 07/30/97 01:51 Page:18   
N$REQ.DLA.DCTX
      1316**DCL      1368<<ASSIGN
N$REQ.DLA.DRELADDR
      1317**DCL      1317--REDEF
N$REQ.DVE.DVBYTE
      1351**DCL      1370<<ASSIGN
N$REQ.DVE.EOMCHAR
      1354**DCL      1355--REDEF
N$REQ.EAINFO
      1348**DCL      1348--REDEF
N$REQ.EAINFOX
      1348**DCL      1349--REDEF
N$REQ.EVNTINFO
      1349**DCL      1349--REDEF
N$REQ.FC
      1319**DCL      1369<<ASSIGN
N$REQ.NOALT
      1319**DCL      1373<<ASSIGN
N$REQ.OPFLG
      1322**DCL      1367<<ASSIGN
N$REQ.STATION.LSTA$
      1329**DCL      1376<<ASSIGN
N$REQ.STATUS
      1330**DCL      1336--REDEF
N$REQ.TYC
      1338**DCL      1380>>IF
NIO$QUE
        32**DCL-ENT  1378--CALL
NIQ$GET
        33**DCL-ENT  1366--CALL
NIQ$REL
        34**DCL-ENT  1383--CALL
NK_BABOONLDX
        40**DCL      1368>>ASSIGN
Q$
        37**DCL      1366<>CALL     1367>>ASSIGN   1368>>ASSIGN   1369>>ASSIGN   1370>>ASSIGN   1371>>ASSIGN
PL6.E3A0      #001=KUB$WRITE File=KUB$BABOON.:E05TSI                             WED 07/30/97 01:51 Page:19   
      1372>>ASSIGN   1373>>ASSIGN   1376>>ASSIGN   1378>>CALL     1380>>IF       1383<>CALL
STA
        28**DCL        15--PROC     1375>>ASSIGN

PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:20   
       74        1        /*T***********************************************************/
       75        2        /*T*                                                         */
       76        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       77        4        /*T*                                                         */
       78        5        /*T***********************************************************/
       79        6        KUB$EA: PROC (N$REQ);
       80        7        /*F* NAME: KUB$EA
       81        8             PURPOSE:
       82        9                  KUB$EA receives all message written to the BABOON station on
       83       10                  NETCG (currently HLPCG).
       84       11             DESCRIPTION:
       85       12                  To aid in control of the network, there is a monitor DCB
       86       13                  station, BABOON, connected to NETCG. Whenever a message is
       87       14                  written to this station, KUB$EA receives it and
       88       15                  performs the appropriate action.
       89       16        */
       90       17        %INCLUDE CP_6;
       91     5576        %INCLUDE HF_LOCK_C;
       92     5590        %INCLUDE N$REQ;
       93     5664        %N$REQ (STCLASS=" ");
       94     5722        %INCLUDE KI_SUBS_C;
       95     5858        %INCLUDE KL_AFCN_C;
       96     5959        %INCLUDE KL_MACRO_C;
       97     9311        %INCLUDE KUB_DATA_R;
       98     9348        %INCLUDE K_DATA_R;
       99    10059        %INCLUDE K_REASON_C;
      100    10085        %INCLUDE K_ADDRESS_M;
      101    10588        %INCLUDE K_SUBS_C;
      102    10621        %INCLUDE NK$LDCT;
      103    10723        %INCLUDE NK_LDCT_R;
      104    10732        %INCLUDE NK_SUBS;
      105    10757        %INCLUDE N_FC_C;
      106    10794        %INCLUDE SS_SCHED_C;
      107    11027        %KL_CWNAK (FPTN=KL$CWNAK,STCLASS="BASED(MSG$)");
      108    11092        %KL_ADMSR (NAME=KL$ADMES,STCLASS="BASED(MSG$)");
      109    11098        %KL_SGNRSP(FPTN=KL$SGNRSP,STCLASS="BASED(MSG$)");
      110    11233        %KL_SETNODE(FPTN=KL$SETNODE,STCLASS="BASED(MSG$)");
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:21   
      111    11279        %KL_NODEINFO (FPTN=KL$NODEINFO,STCLASS="BASED(MSG$)");
      112    11303        %KL_NODECHG (FPTN=KL$NODECHG,STCLASS="BASED(MSG$)");
      113    11327        %KL_UPDOSI(FPTN=KL$UPDOSI,STCLASS="BASED(MSG$)");
      114    11536        %KL_OSILINKCHG(FPTN=KL$OSILINKCHG,STCLASS="BASED(MSG$)");
      115    11659        %NK$LDCT (STCLASS="BASED(LDCT$)");
      116    11705    1   DCL 1 B$MSG BASED,
      117    11706    1         2 TEXT CHAR(SIZE) UNAL;
      118    11707    1   DCL SIZE UBIN;
      119    11708    1   DCL MSG$ PTR;
      120    11709    1   DCL LDCT$ PTR;
      121    11710    1   DCL ASRTEMP BIT(72) DALIGNED;
      122    11711        %VLR_MONINFO (FPTN=B_MONINFO,STCLASS=SYMREF);
      123    11729    1   DCL FEX UBIN WORD;
      124    11730        %K$RWPARM (NAME=K$RWPARM,STCLASS="");
      125    12046    1   DCL NODE# UBIN;
      126    12047    1   DCL LNKNODE UBIN;
      127    12048    1   DCL QOS UBIN;
      128    12049    1   DCL KIN$NODECHG ENTRY(3) ALTRET;
      129    12050    1   DCL KIN$SET_NODE ENTRY(3) ALTRET;
      130    12051    1   DCL KCD$DSCTRM ENTRY(2);
      131    12052    1   DCL KCO$TRMGO ENTRY(1) ALTRET;
      132    12053    1   DCL KIP$SENDALL ENTRY(3) ALTRET;
      133    12054    1   DCL KIQ$FESTRT ENTRY(1);
      134    12055    1   DCL KIQ$FESTOP ENTRY(2);
      135    12056    1   DCL KQX$RESASR ENTRY(1);
      136    12057    1   DCL KQX$SAVASR ENTRY(1);
      137    12058    1   DCL NIO$QUE ENTRY(1) ALTRET;
      138    12059    1   DCL SC_BABOON ENTRY CONV(2,0);
      139    12060    1   DCL SSR$RUE ENTRY(4);
      140    12061    1   DCL SSR$REG ENTRY(3) ALTRET;
      141    12062    1   DCL KIA$NETERR2ERR ENTRY(2);
      142    12063    1   DCL KIA$OQFL ENTRY(1) ALTRET;
      143    12064    1   DCL KIN$OSICHG ENTRY(1) ALTRET;
      144    12065    1   DCL KIN$OSILINKCHG ENTRY(1) ALTRET;
      145    12066    1   DCL KIS$SEND ENTRY(1) ALTRET;
      146    12067    1   DCL NKL$RELDCT ENTRY(1) ALTRET;
      147    12068        /**/
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:22   
      148    12069    1         MSG$=ADDR(KUB_MSG);
      149    12070    2           DO CASE (KUB_MSG.FCN);
      150    12071
      151    12072    2             CASE (IGA_SALL);
      152    12073    2   SENDALL:    ;
      153    12074    2               SIZE = N$REQ.ARSIZE + LENGTHC(KL$ADMES.MSG_) - LENGTHC (KL$ADMES);
      154    12075    2               IF KL$ADMES.TYP ~= 0
      155    12076    3               THEN DO;
      156    12077    3                 NODE# = KL$ADMES.TYP;
      157    12078    3                 CALL KIP$SENDALL(KL$ADMES.MSG_,SIZE,NODE#);
      158    12079    3                 END;
      159    12080    2               ELSE
      160    12081    2                CALL KIP$SENDALL(KL$ADMES.MSG_,SIZE);
      161    12082
      162    12083
      163    12084    2             CASE (IGA_SGNRSP);       /* SIGNON response */
      164    12085    2               LDCT$ = NK$LDCT$(KL$SGNRSP.LDCTX);
      165    12086    2               IF LDCT$ ~= ADDR(NIL)
      166    12087    3               THEN DO;
      167    12088                      %LOCK (G=LDCT$->NK$LDCT.LOCK);
      168    12091    3   RETRY:        ;
      169    12092    3                 K$RWPARM = K_RWPARM_CON;
      170    12093    3                 IF KL$SGNRSP.ERRCODE='0'B
      171    12094    3                 THEN K$RWPARM.ERR=%K_REASON_NORMAL;
      172    12095    3                 ELSE K$RWPARM.ERR=%K_REASON_USRREJ;
      173    12096    3                 K$RWPARM.UHDR$ = ADDR(KL$SGNRSP);
      174    12097    3                 K$RWPARM.UHDRSZ = N$REQ.ARSIZE;
      175    12098    3                 K$RWPARM.LDCT$=LDCT$;
      176    12099    3                 K$RWPARM.FUNCTION=%K_CONNECT_ACK;
      177    12100    3                 CALL KIS$SEND (K$RWPARM)
      178    12101    4                 WHENALTRETURN DO;
      179    12102    5                   CALL KIA$OQFL (NK$LDCT) WHENRETURN DO;
      180    12103    5                     GOTO RETRY;
      181    12104    5                     END;
      182    12105    4                   END;
      183    12106                      %UNLOCK (G=LDCT$->NK$LDCT.LOCK);
      184    12109    3                 IF KL$SGNRSP.ERRCODE = '0'B AND K$RWPARM.ERR = %K_REASON_NORMAL
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:23   
      185    12110    3                 THEN CALL KCO$TRMGO(LDCT$);
      186    12111    3                 ELSE IF KL$SGNRSP.ERRCODE ~= '0'B /* cg connection not established */
      187    12112    3                  THEN CALL NKL$RELDCT(LDCT$);
      188    12113    3                 END;
      189    12114
      190    12115    2             CASE (IGA_HDR);
      191    12116    2               SIZE = N$REQ.ARSIZE + LENGTHC(KL$ADMES.MSG_) - LENGTHC(KL$ADMES);
      192    12117    2               K_HEADER.CNT = SIZE;
      193    12118    2               K_HEADER.TEXT = ADDR(KL$ADMES.MSG_)->B$MSG.TEXT;
      194    12119
      195    12120    2             CASE (IGA_BCST);
      196    12121    2               SIZE = N$REQ.ARSIZE + LENGTHC(KL$ADMES.MSG_) - LENGTHC(KL$ADMES);
      197    12122    2               K_HEADER.CNT = SIZE;
      198    12123    2               K_HEADER.TEXT = ADDR(KL$ADMES.MSG_)->B$MSG.TEXT;
      199    12124    2               GOTO SENDALL;
      200    12125
      201    12126    2             CASE (IGA_SETNODE);
      202    12127    2               IF KL$SETNODE.MY_NODE
      203    12128    3               THEN DO;
      204    12129    3                 B_MONINFO.NODE# = KL$SETNODE.NODE#;
      205    12130    3                 K_NODE# = KL$SETNODE.NODE#;
      206    12131    3                 B_MONINFO.NODE_NAME = KL$SETNODE.NODE_NAME;
      207    12132    3                 END;
      208    12133    3               ELSE DO;
      209    12134    3                 NODE# = KL$SETNODE.NODE#;
      210    12135    3                 CALL KIN$SET_NODE (KL$SETNODE.NODE_NAME,NODE#,KL$SETNODE.HOST_NODE);
      211    12136    3                 END;
      212    12137
      213    12138    2             CASE (IGA_LINKUP);
      214    12139    2               FEX = KUB_MSG.NODE;
      215    12140    2               CALL KIQ$FESTRT (FEX);
      216    12141
      217    12142    2             CASE (IGA_LINKDWN);
      218    12143    2               FEX = KUB_MSG.NODE;
      219    12144    2               CALL KIQ$FESTOP (FEX,KIER_STOP);
      220    12145
      221    12146    2             CASE (IGA_ABRTUSER);
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:24   
      222    12147
      223    12148    2             CASE (IGA_CWNAK);
      224    12149    2               LDCT$=NK$LDCT$(KL$CWNAK.NETADR.LDX.BYT(0)*256+KL$CWNAK.NETADR.LDX.BYT(1)
             12149                        );
      225    12150                    %LOCK (G=K_LOCK);
      226    12153    2               IF LDCT$~=ADDR(NIL)
      227    12154    2               AND KL$CWNAK.NETADR.GENERATION = NK$LDCT.GENERATION
      228    12155    2               AND NK$LDCT.LKFLG.REGGED
      229    12156    3               THEN DO;
      230    12157    3                 CALL KIA$NETERR2ERR(KL$CWNAK.NETERR,NK$LDCT.ERR);
      231    12158    3                 CALL SSR$RUE(%SS_CIC,NK$LDCT.USER);
      232    12159    3                 NK$LDCT.LKFLG.REGGED = '0'B;
      233    12160    3                 END;
      234    12161                    %UNLOCK (G=K_LOCK);
      235    12164
      236    12165    2             CASE (IGA_NODECHG);
      237    12166    2               NODE# = KL$NODECHG.NODE;
      238    12167    2               QOS = KL$NODECHG.QOS;
      239    12168    2               LNKNODE = KL$NODECHG.MYNODE;
      240    12169    2   RETRY_KIN:  ;
      241    12170    2               CALL KIN$NODECHG(NODE#,LNKNODE,QOS)
      242    12171    3               WHENALTRETURN DO;
      243    12172    3                 CALL SSR$REG(%SS_SL,,1);
      244    12173    3                 GOTO RETRY_KIN;
      245    12174    3                 END;
      246    12175
      247    12176    2             CASE (IGA_NODEINFO);
      248    12177
      249    12178    2             CASE(IGA_UPDOSI,IGA_DELOSI);
      250    12179    3               CALL KIN$OSICHG(KL$UPDOSI) WHENALTRETURN DO;
      251    12180                   /* ignore them for now */
      252    12181    3                 END;
      253    12182
      254    12183    2             CASE(IGA_OSILINKCHG);
      255    12184    3               CALL KIN$OSILINKCHG(KL$OSILINKCHG) WHENALTRETURN DO;
      256    12185    3                 END;
      257    12186    2             CASE (ELSE);
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:25   
      258    12187
      259    12188    2           END;
      260    12189    1         N$REQ.STATION.LSTA$=ADDR(KUB_STA);
      261    12190    1         N$REQ.OPFLG.REQ='1'B;
      262    12191    1         RETURN;
      263    12192    1   END KUB$EA;
      264    12193        %EOD;

PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:26   
--  Include file information  --

   SS_SCHED_C.:E05TOU  is referenced.
   N_FC_C.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   NK_LDCT_R.:E05TOU  cannot be made into a system file and is referenced.
   NK$LDCT.:E05TOU  is referenced.
   K_SUBS_C.:E05TOU  is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   K_REASON_C.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   K_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KUB_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KUB$EA.

   Procedure KUB$EA requires 393 words for executable code.
   Procedure KUB$EA requires 60 words of local(AUTO) storage.

PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:27   

 Object Unit name= KUB$EA                                     File name= KUB$BABOON.:E05TOU
 UTS= JUL 30 '97 01:52:08.76 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none   393    611  KUB$EA
    2  RoData even  none    12     14  KUB$EA

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  KUB$EA
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:28   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 KIP$SENDALL
         yes           Std       1 HFC$UNLOCK
 yes     yes           Std       3 SSR$REG
         yes           Std       1 HFC$LOCK
 yes     yes           Std       1 KIS$SEND
 yes     yes           Std       1 KIA$OQFL
 yes     yes           Std       1 KCO$TRMGO
 yes     yes           Std       3 KIN$NODECHG
 yes     yes           Std       3 KIN$SET_NODE
 yes     yes           Std       1 KIN$OSICHG
 yes     yes           Std       1 NKL$RELDCT
         yes           Std       1 KIQ$FESTRT
         yes           Std       2 KIQ$FESTOP
         yes           Std       4 SSR$RUE
 yes     yes           Std       1 KIN$OSILINKCHG
         yes           Std       2 KIA$NETERR2ERR
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  KUB_MSG                               KUB_STA
r    K_RWPARM_CON                          K_LOCK                                K_NODE#
     K_HEADER                              N$DCT$$                               B_MONINFO
     B_VECTNIL
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:29   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:30   


       74        1        /*T***********************************************************/
       75        2        /*T*                                                         */
       76        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       77        4        /*T*                                                         */
       78        5        /*T***********************************************************/
       79        6        KUB$EA: PROC (N$REQ);

      6  1 000000   000000 700200 xent  KUB$EA       TSX0  ! X66_AUTO_1
         1 000001   000074 000001                    ZERO    60,1

       80        7        /*F* NAME: KUB$EA
       81        8             PURPOSE:
       82        9                  KUB$EA receives all message written to the BABOON station on
       83       10                  NETCG (currently HLPCG).
       84       11             DESCRIPTION:
       85       12                  To aid in control of the network, there is a monitor DCB
       86       13                  station, BABOON, connected to NETCG. Whenever a message is
       87       14                  written to this station, KUB$EA receives it and
       88       15                  performs the appropriate action.
       89       16        */
       90       17        %INCLUDE CP_6;
       91     5576        %INCLUDE HF_LOCK_C;
       92     5590        %INCLUDE N$REQ;
       93     5664        %N$REQ (STCLASS=" ");
       94     5722        %INCLUDE KI_SUBS_C;
       95     5858        %INCLUDE KL_AFCN_C;
       96     5959        %INCLUDE KL_MACRO_C;
       97     9311        %INCLUDE KUB_DATA_R;
       98     9348        %INCLUDE K_DATA_R;
       99    10059        %INCLUDE K_REASON_C;
      100    10085        %INCLUDE K_ADDRESS_M;
      101    10588        %INCLUDE K_SUBS_C;
      102    10621        %INCLUDE NK$LDCT;
      103    10723        %INCLUDE NK_LDCT_R;
      104    10732        %INCLUDE NK_SUBS;
      105    10757        %INCLUDE N_FC_C;
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:31   
      106    10794        %INCLUDE SS_SCHED_C;
      107    11027        %KL_CWNAK (FPTN=KL$CWNAK,STCLASS="BASED(MSG$)");
      108    11092        %KL_ADMSR (NAME=KL$ADMES,STCLASS="BASED(MSG$)");
      109    11098        %KL_SGNRSP(FPTN=KL$SGNRSP,STCLASS="BASED(MSG$)");
      110    11233        %KL_SETNODE(FPTN=KL$SETNODE,STCLASS="BASED(MSG$)");
      111    11279        %KL_NODEINFO (FPTN=KL$NODEINFO,STCLASS="BASED(MSG$)");
      112    11303        %KL_NODECHG (FPTN=KL$NODECHG,STCLASS="BASED(MSG$)");
      113    11327        %KL_UPDOSI(FPTN=KL$UPDOSI,STCLASS="BASED(MSG$)");
      114    11536        %KL_OSILINKCHG(FPTN=KL$OSILINKCHG,STCLASS="BASED(MSG$)");
      115    11659        %NK$LDCT (STCLASS="BASED(LDCT$)");
      116    11705    1   DCL 1 B$MSG BASED,
      117    11706    1         2 TEXT CHAR(SIZE) UNAL;
      118    11707    1   DCL SIZE UBIN;
      119    11708    1   DCL MSG$ PTR;
      120    11709    1   DCL LDCT$ PTR;
      121    11710    1   DCL ASRTEMP BIT(72) DALIGNED;
      122    11711        %VLR_MONINFO (FPTN=B_MONINFO,STCLASS=SYMREF);
      123    11729    1   DCL FEX UBIN WORD;
      124    11730        %K$RWPARM (NAME=K$RWPARM,STCLASS="");
      125    12046    1   DCL NODE# UBIN;
      126    12047    1   DCL LNKNODE UBIN;
      127    12048    1   DCL QOS UBIN;
      128    12049    1   DCL KIN$NODECHG ENTRY(3) ALTRET;
      129    12050    1   DCL KIN$SET_NODE ENTRY(3) ALTRET;
      130    12051    1   DCL KCD$DSCTRM ENTRY(2);
      131    12052    1   DCL KCO$TRMGO ENTRY(1) ALTRET;
      132    12053    1   DCL KIP$SENDALL ENTRY(3) ALTRET;
      133    12054    1   DCL KIQ$FESTRT ENTRY(1);
      134    12055    1   DCL KIQ$FESTOP ENTRY(2);
      135    12056    1   DCL KQX$RESASR ENTRY(1);
      136    12057    1   DCL KQX$SAVASR ENTRY(1);
      137    12058    1   DCL NIO$QUE ENTRY(1) ALTRET;
      138    12059    1   DCL SC_BABOON ENTRY CONV(2,0);
      139    12060    1   DCL SSR$RUE ENTRY(4);
      140    12061    1   DCL SSR$REG ENTRY(3) ALTRET;
      141    12062    1   DCL KIA$NETERR2ERR ENTRY(2);
      142    12063    1   DCL KIA$OQFL ENTRY(1) ALTRET;
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:32   
      143    12064    1   DCL KIN$OSICHG ENTRY(1) ALTRET;
      144    12065    1   DCL KIN$OSILINKCHG ENTRY(1) ALTRET;
      145    12066    1   DCL KIS$SEND ENTRY(1) ALTRET;
      146    12067    1   DCL NKL$RELDCT ENTRY(1) ALTRET;
      147    12068        /**/
      148    12069    1         MSG$=ADDR(KUB_MSG);

  12069  1 000002   000000 236000 2                  LDQ     0
         1 000003   200005 756100                    STQ     MSG$,,AUTO

      149    12070    2           DO CASE (KUB_MSG.FCN);

  12070  1 000004   000000 236000 xsym               LDQ     KUB_MSG
         1 000005   000033 772000                    QRL     27
         1 000006   000011 136007                    SBLQ    9,DL
         1 000007   000122 116007                    CMPQ    82,DL
         1 000010   000012 602006 1                  TNC     s:12070+6,QL
         1 000011   000603 710000 1                  TRA     s:12189
         1 000012   000134 710000 1                  TRA     SENDALL
         1 000013   000603 710000 1                  TRA     s:12189
         1 000014   000335 710000 1                  TRA     s:12121
         1 000015   000603 710000 1                  TRA     s:12189
         1 000016   000603 710000 1                  TRA     s:12189
         1 000017   000603 710000 1                  TRA     s:12189
         1 000020   000320 710000 1                  TRA     s:12116
         1 000021   000603 710000 1                  TRA     s:12189
         1 000022   000603 710000 1                  TRA     s:12189
         1 000023   000603 710000 1                  TRA     s:12189
         1 000024   000603 710000 1                  TRA     s:12189
         1 000025   000603 710000 1                  TRA     s:12189
         1 000026   000603 710000 1                  TRA     s:12189
         1 000027   000603 710000 1                  TRA     s:12189
         1 000030   000603 710000 1                  TRA     s:12189
         1 000031   000603 710000 1                  TRA     s:12189
         1 000032   000603 710000 1                  TRA     s:12189
         1 000033   000603 710000 1                  TRA     s:12189
         1 000034   000603 710000 1                  TRA     s:12189
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:33   
         1 000035   000435 710000 1                  TRA     s:12149
         1 000036   000405 710000 1                  TRA     s:12139
         1 000037   000420 710000 1                  TRA     s:12143
         1 000040   000603 710000 1                  TRA     s:12189
         1 000041   000603 710000 1                  TRA     s:12189
         1 000042   000603 710000 1                  TRA     s:12189
         1 000043   000603 710000 1                  TRA     s:12189
         1 000044   000603 710000 1                  TRA     s:12189
         1 000045   000603 710000 1                  TRA     s:12189
         1 000046   000352 710000 1                  TRA     s:12127
         1 000047   000603 710000 1                  TRA     s:12189
         1 000050   000603 710000 1                  TRA     s:12189
         1 000051   000603 710000 1                  TRA     s:12189
         1 000052   000526 710000 1                  TRA     s:12166
         1 000053   000603 710000 1                  TRA     s:12189
         1 000054   000603 710000 1                  TRA     s:12189
         1 000055   000603 710000 1                  TRA     s:12189
         1 000056   000603 710000 1                  TRA     s:12189
         1 000057   000603 710000 1                  TRA     s:12189
         1 000060   000603 710000 1                  TRA     s:12189
         1 000061   000603 710000 1                  TRA     s:12189
         1 000062   000603 710000 1                  TRA     s:12189
         1 000063   000603 710000 1                  TRA     s:12189
         1 000064   000603 710000 1                  TRA     s:12189
         1 000065   000603 710000 1                  TRA     s:12189
         1 000066   000603 710000 1                  TRA     s:12189
         1 000067   000603 710000 1                  TRA     s:12189
         1 000070   000603 710000 1                  TRA     s:12189
         1 000071   000603 710000 1                  TRA     s:12189
         1 000072   000603 710000 1                  TRA     s:12189
         1 000073   000603 710000 1                  TRA     s:12189
         1 000074   000603 710000 1                  TRA     s:12189
         1 000075   000603 710000 1                  TRA     s:12189
         1 000076   000603 710000 1                  TRA     s:12189
         1 000077   000603 710000 1                  TRA     s:12189
         1 000100   000603 710000 1                  TRA     s:12189
         1 000101   000177 710000 1                  TRA     s:12085
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:34   
         1 000102   000603 710000 1                  TRA     s:12189
         1 000103   000603 710000 1                  TRA     s:12189
         1 000104   000603 710000 1                  TRA     s:12189
         1 000105   000603 710000 1                  TRA     s:12189
         1 000106   000603 710000 1                  TRA     s:12189
         1 000107   000603 710000 1                  TRA     s:12189
         1 000110   000603 710000 1                  TRA     s:12189
         1 000111   000603 710000 1                  TRA     s:12189
         1 000112   000603 710000 1                  TRA     s:12189
         1 000113   000603 710000 1                  TRA     s:12189
         1 000114   000603 710000 1                  TRA     s:12189
         1 000115   000603 710000 1                  TRA     s:12189
         1 000116   000603 710000 1                  TRA     s:12189
         1 000117   000603 710000 1                  TRA     s:12189
         1 000120   000603 710000 1                  TRA     s:12189
         1 000121   000603 710000 1                  TRA     s:12189
         1 000122   000603 710000 1                  TRA     s:12189
         1 000123   000603 710000 1                  TRA     s:12189
         1 000124   000603 710000 1                  TRA     s:12189
         1 000125   000603 710000 1                  TRA     s:12189
         1 000126   000603 710000 1                  TRA     s:12189
         1 000127   000567 710000 1                  TRA     s:12179
         1 000130   000567 710000 1                  TRA     s:12179
         1 000131   000603 710000 1                  TRA     s:12189
         1 000132   000603 710000 1                  TRA     s:12189
         1 000133   000575 710000 1                  TRA     s:12184

      150    12071
      151    12072    2             CASE (IGA_SALL);

      152    12073    2   SENDALL:    ;

  12073  1 000134                       SENDALL      null
      153    12074    2               SIZE = N$REQ.ARSIZE + LENGTHC(KL$ADMES.MSG_) - LENGTHC (KL$ADMES);

  12074  1 000134   200003 470500                    LDP0    @N$REQ,,AUTO
         1 000135   000027 236100                    LDQ     23,,PR0
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:35   
         1 000136   000020 772000                    QRL     16
         1 000137   000002 136007                    SBLQ    2,DL
         1 000140   200004 756100                    STQ     SIZE,,AUTO

      154    12075    2               IF KL$ADMES.TYP ~= 0

  12075  1 000141   200005 471500                    LDP1    MSG$,,AUTO
         1 000142   100000 236100                    LDQ     0,,PR1
         1 000143   000777 316003                    CANQ    511,DU
         1 000144   000165 600000 1                  TZE     s:12081

      155    12076    3               THEN DO;

      156    12077    3                 NODE# = KL$ADMES.TYP;

  12077  1 000145   100000 236100                    LDQ     0,,PR1
         1 000146   000022 772000                    QRL     18
         1 000147   000777 376007                    ANQ     511,DL
         1 000150   200064 756100                    STQ     NODE#,,AUTO

      157    12078    3                 CALL KIP$SENDALL(KL$ADMES.MSG_,SIZE,NODE#);

  12078  1 000151   200064 633500                    EPPR3   NODE#,,AUTO
         1 000152   200072 453500                    STP3    QOS+4,,AUTO
         1 000153   200004 634500                    EPPR4   SIZE,,AUTO
         1 000154   200071 454500                    STP4    QOS+3,,AUTO
         1 000155   200005 236100                    LDQ     MSG$,,AUTO
         1 000156   400000 036007                    ADLQ    -131072,DL
         1 000157   200070 756100                    STQ     QOS+2,,AUTO
         1 000160   200070 630500                    EPPR0   QOS+2,,AUTO
         1 000161   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000162   000000 701000 xent               TSX1    KIP$SENDALL
         1 000163   000000 011000                    NOP     0

      158    12079    3                 END;

  12079  1 000164   000603 710000 1                  TRA     s:12189
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:36   

      159    12080    2               ELSE
      160    12081    2                CALL KIP$SENDALL(KL$ADMES.MSG_,SIZE);

  12081  1 000165   200004 633500                    EPPR3   SIZE,,AUTO
         1 000166   200071 453500                    STP3    QOS+3,,AUTO
         1 000167   200005 236100                    LDQ     MSG$,,AUTO
         1 000170   400000 036007                    ADLQ    -131072,DL
         1 000171   200070 756100                    STQ     QOS+2,,AUTO
         1 000172   200070 630500                    EPPR0   QOS+2,,AUTO
         1 000173   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000174   000000 701000 xent               TSX1    KIP$SENDALL
         1 000175   000000 011000                    NOP     0
         1 000176   000603 710000 1                  TRA     s:12189

      161    12082
      162    12083
      163    12084    2             CASE (IGA_SGNRSP);       /* SIGNON response */

      164    12085    2               LDCT$ = NK$LDCT$(KL$SGNRSP.LDCTX);

  12085  1 000177   200005 470500                    LDP0    MSG$,,AUTO
         1 000200   000000 235100                    LDA     0,,PR0
         1 000201   000001 236100                    LDQ     1,,PR0
         1 000202   000022 773000                    LRL     18
         1 000203   000000 471400 xsym               LDP1    N$DCT$$
         1 000204   100000 236106                    LDQ     0,QL,PR1
         1 000205   200006 756100                    STQ     LDCT$,,AUTO

      165    12086    2               IF LDCT$ ~= ADDR(NIL)

  12086  1 000206   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000207   000603 600000 1                  TZE     s:12189

      166    12087    3               THEN DO;

      167    12088                      %LOCK (G=LDCT$->NK$LDCT.LOCK);
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:37   

  12089  1 000210   000020 036003                    ADLQ    16,DU
         1 000211   200070 756100                    STQ     QOS+2,,AUTO
         1 000212   200070 630500                    EPPR0   QOS+2,,AUTO
         1 000213   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000214   000000 701000 xent               TSX1    HFC$LOCK
         1 000215   000000 011000                    NOP     0

  12089  1 000216                       RETRY        null
      168    12091    3   RETRY:        ;
      169    12092    3                 K$RWPARM = K_RWPARM_CON;

  12092  1 000216   000100 100400                    MLR     fill='000'O
         1 000217   000000 000234 xsym               ADSC9   K_RWPARM_CON             cn=0,n=156
         1 000220   200014 000234                    ADSC9   K$RWPARM,,AUTO           cn=0,n=156

      170    12093    3                 IF KL$SGNRSP.ERRCODE='0'B

  12093  1 000221   200005 470500                    LDP0    MSG$,,AUTO
         1 000222   000000 106500                    CMPC    fill='000'O
         1 000223   000002 400004                    ADSC9   2,,PR0                   cn=2,n=4
         1 000224   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         1 000225   000230 601000 1                  TNZ     s:12095

      171    12094    3                 THEN K$RWPARM.ERR=%K_REASON_NORMAL;

  12094  1 000226   200027 450100                    STZ     K$RWPARM+11,,AUTO
         1 000227   000232 710000 1                  TRA     s:12096

      172    12095    3                 ELSE K$RWPARM.ERR=%K_REASON_USRREJ;

  12095  1 000230   000005 235007                    LDA     5,DL
         1 000231   200027 755100                    STA     K$RWPARM+11,,AUTO

      173    12096    3                 K$RWPARM.UHDR$ = ADDR(KL$SGNRSP);

  12096  1 000232   200005 236100                    LDQ     MSG$,,AUTO
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:38   
         1 000233   200030 756100                    STQ     K$RWPARM+12,,AUTO

      174    12097    3                 K$RWPARM.UHDRSZ = N$REQ.ARSIZE;

  12097  1 000234   200003 471500                    LDP1    @N$REQ,,AUTO
         1 000235   100027 236100                    LDQ     23,,PR1
         1 000236   000020 772000                    QRL     16
         1 000237   200031 756100                    STQ     K$RWPARM+13,,AUTO

      175    12098    3                 K$RWPARM.LDCT$=LDCT$;

  12098  1 000240   200006 236100                    LDQ     LDCT$,,AUTO
         1 000241   200032 756100                    STQ     K$RWPARM+14,,AUTO

      176    12099    3                 K$RWPARM.FUNCTION=%K_CONNECT_ACK;

  12099  1 000242   000012 235007                    LDA     10,DL
         1 000243   200034 755100                    STA     K$RWPARM+16,,AUTO

      177    12100    3                 CALL KIS$SEND (K$RWPARM)

  12100  1 000244   200014 633500                    EPPR3   K$RWPARM,,AUTO
         1 000245   200070 453500                    STP3    QOS+2,,AUTO
         1 000246   200070 630500                    EPPR0   QOS+2,,AUTO
         1 000247   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000250   000000 701000 xent               TSX1    KIS$SEND
         1 000251   000253 702000 1                  TSX2    s:12102
         1 000252   000260 710000 1                  TRA     s:12107

      178    12101    4                 WHENALTRETURN DO;

      179    12102    5                   CALL KIA$OQFL (NK$LDCT) WHENRETURN DO;

  12102  1 000253   200006 630500                    EPPR0   LDCT$,,AUTO
         1 000254   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000255   000000 701000 xent               TSX1    KIA$OQFL
         1 000256   000260 702000 1                  TSX2    s:12107
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:39   

      180    12103    5                     GOTO RETRY;

  12103  1 000257   000216 710000 1                  TRA     RETRY

      181    12104    5                     END;
      182    12105    4                   END;

      183    12106                      %UNLOCK (G=LDCT$->NK$LDCT.LOCK);

  12107  1 000260   200006 236100                    LDQ     LDCT$,,AUTO
         1 000261   000020 036003                    ADLQ    16,DU
         1 000262   200070 756100                    STQ     QOS+2,,AUTO
         1 000263   200070 630500                    EPPR0   QOS+2,,AUTO
         1 000264   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000265   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000266   000000 011000                    NOP     0

      184    12109    3                 IF KL$SGNRSP.ERRCODE = '0'B AND K$RWPARM.ERR = %K_REASON_NORMAL

  12109  1 000267   200005 470500                    LDP0    MSG$,,AUTO
         1 000270   000000 106500                    CMPC    fill='000'O
         1 000271   000002 400004                    ADSC9   2,,PR0                   cn=2,n=4
         1 000272   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         1 000273   000305 601000 1                  TNZ     s:12111
         1 000274   200027 235100                    LDA     K$RWPARM+11,,AUTO
         1 000275   000305 601000 1                  TNZ     s:12111

      185    12110    3                 THEN CALL KCO$TRMGO(LDCT$);

  12110  1 000276   200006 631500                    EPPR1   LDCT$,,AUTO
         1 000277   200070 451500                    STP1    QOS+2,,AUTO
         1 000300   200070 630500                    EPPR0   QOS+2,,AUTO
         1 000301   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000302   000000 701000 xent               TSX1    KCO$TRMGO
         1 000303   000000 011000                    NOP     0
         1 000304   000603 710000 1                  TRA     s:12189
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:40   

      186    12111    3                 ELSE IF KL$SGNRSP.ERRCODE ~= '0'B /* cg connection not established */

  12111  1 000305   000000 106500                    CMPC    fill='000'O
         1 000306   000002 400004                    ADSC9   2,,PR0                   cn=2,n=4
         1 000307   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         1 000310   000603 600000 1                  TZE     s:12189

      187    12112    3                  THEN CALL NKL$RELDCT(LDCT$);

  12112  1 000311   200006 631500                    EPPR1   LDCT$,,AUTO
         1 000312   200070 451500                    STP1    QOS+2,,AUTO
         1 000313   200070 630500                    EPPR0   QOS+2,,AUTO
         1 000314   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000315   000000 701000 xent               TSX1    NKL$RELDCT
         1 000316   000000 011000                    NOP     0

      188    12113    3                 END;

  12113  1 000317   000603 710000 1                  TRA     s:12189

      189    12114
      190    12115    2             CASE (IGA_HDR);

      191    12116    2               SIZE = N$REQ.ARSIZE + LENGTHC(KL$ADMES.MSG_) - LENGTHC(KL$ADMES);

  12116  1 000320   200003 470500                    LDP0    @N$REQ,,AUTO
         1 000321   000027 236100                    LDQ     23,,PR0
         1 000322   000020 772000                    QRL     16
         1 000323   000002 136007                    SBLQ    2,DL
         1 000324   200004 756100                    STQ     SIZE,,AUTO

      192    12117    2               K_HEADER.CNT = SIZE;

  12117  1 000325   000033 736000                    QLS     27
         1 000326   000000 552040 xsym               STBQ    K_HEADER,'40'O

PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:41   
      193    12118    2               K_HEADER.TEXT = ADDR(KL$ADMES.MSG_)->B$MSG.TEXT;

  12118  1 000327   200005 471500                    LDP1    MSG$,,AUTO
         1 000330   200004 720100                    LXL0    SIZE,,AUTO
         1 000331   040000 100540                    MLR     fill='040'O
         1 000332   100000 400010                    ADSC9   0,,PR1                   cn=2,n=*X0
         1 000333   000000 200170 xsym               ADSC9   K_HEADER                 cn=1,n=120
         1 000334   000603 710000 1                  TRA     s:12189

      194    12119
      195    12120    2             CASE (IGA_BCST);

      196    12121    2               SIZE = N$REQ.ARSIZE + LENGTHC(KL$ADMES.MSG_) - LENGTHC(KL$ADMES);

  12121  1 000335   200003 470500                    LDP0    @N$REQ,,AUTO
         1 000336   000027 236100                    LDQ     23,,PR0
         1 000337   000020 772000                    QRL     16
         1 000340   000002 136007                    SBLQ    2,DL
         1 000341   200004 756100                    STQ     SIZE,,AUTO

      197    12122    2               K_HEADER.CNT = SIZE;

  12122  1 000342   000033 736000                    QLS     27
         1 000343   000000 552040 xsym               STBQ    K_HEADER,'40'O

      198    12123    2               K_HEADER.TEXT = ADDR(KL$ADMES.MSG_)->B$MSG.TEXT;

  12123  1 000344   200005 471500                    LDP1    MSG$,,AUTO
         1 000345   200004 720100                    LXL0    SIZE,,AUTO
         1 000346   040000 100540                    MLR     fill='040'O
         1 000347   100000 400010                    ADSC9   0,,PR1                   cn=2,n=*X0
         1 000350   000000 200170 xsym               ADSC9   K_HEADER                 cn=1,n=120

      199    12124    2               GOTO SENDALL;

  12124  1 000351   000134 710000 1                  TRA     SENDALL

PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:42   
      200    12125
      201    12126    2             CASE (IGA_SETNODE);

      202    12127    2               IF KL$SETNODE.MY_NODE

  12127  1 000352   200005 470500                    LDP0    MSG$,,AUTO
         1 000353   000000 236100                    LDQ     0,,PR0
         1 000354   000200 316007                    CANQ    128,DL
         1 000355   000366 600000 1                  TZE     s:12134

      203    12128    3               THEN DO;

      204    12129    3                 B_MONINFO.NODE# = KL$SETNODE.NODE#;

  12129  1 000356   000001 235100                    LDA     1,,PR0
         1 000357   000011 755000 xsym               STA     B_MONINFO+9

      205    12130    3                 K_NODE# = KL$SETNODE.NODE#;

  12130  1 000360   000001 235100                    LDA     1,,PR0
         1 000361   000000 755000 xsym               STA     K_NODE#

      206    12131    3                 B_MONINFO.NODE_NAME = KL$SETNODE.NODE_NAME;

  12131  1 000362   040000 100500                    MLR     fill='040'O
         1 000363   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
         1 000364   000012 000010 xsym               ADSC9   B_MONINFO+10             cn=0,n=8

      207    12132    3                 END;

  12132  1 000365   000603 710000 1                  TRA     s:12189

      208    12133    3               ELSE DO;

      209    12134    3                 NODE# = KL$SETNODE.NODE#;

  12134  1 000366   000001 235100                    LDA     1,,PR0
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:43   
         1 000367   200064 755100                    STA     NODE#,,AUTO

      210    12135    3                 CALL KIN$SET_NODE (KL$SETNODE.NODE_NAME,NODE#,KL$SETNODE.HOST_NODE);

  12135  1 000370   200005 236100                    LDQ     MSG$,,AUTO
         1 000371   620000 036007                    ADLQ    -57344,DL
         1 000372   200072 756100                    STQ     QOS+4,,AUTO
         1 000373   200064 631500                    EPPR1   NODE#,,AUTO
         1 000374   200071 451500                    STP1    QOS+3,,AUTO
         1 000375   200005 236100                    LDQ     MSG$,,AUTO
         1 000376   000002 036003                    ADLQ    2,DU
         1 000377   200070 756100                    STQ     QOS+2,,AUTO
         1 000400   200070 630500                    EPPR0   QOS+2,,AUTO
         1 000401   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000402   000000 701000 xent               TSX1    KIN$SET_NODE
         1 000403   000000 011000                    NOP     0

      211    12136    3                 END;

  12136  1 000404   000603 710000 1                  TRA     s:12189

      212    12137
      213    12138    2             CASE (IGA_LINKUP);

      214    12139    2               FEX = KUB_MSG.NODE;

  12139  1 000405   000000 236000 xsym               LDQ     KUB_MSG
         1 000406   000022 772000                    QRL     18
         1 000407   000777 376007                    ANQ     511,DL
         1 000410   200012 756100                    STQ     FEX,,AUTO

      215    12140    2               CALL KIQ$FESTRT (FEX);

  12140  1 000411   200012 630500                    EPPR0   FEX,,AUTO
         1 000412   200070 450500                    STP0    QOS+2,,AUTO
         1 000413   200070 630500                    EPPR0   QOS+2,,AUTO
         1 000414   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:44   
         1 000415   000000 701000 xent               TSX1    KIQ$FESTRT
         1 000416   000000 011000                    NOP     0
         1 000417   000603 710000 1                  TRA     s:12189

      216    12141
      217    12142    2             CASE (IGA_LINKDWN);

      218    12143    2               FEX = KUB_MSG.NODE;

  12143  1 000420   000000 236000 xsym               LDQ     KUB_MSG
         1 000421   000022 772000                    QRL     18
         1 000422   000777 376007                    ANQ     511,DL
         1 000423   200012 756100                    STQ     FEX,,AUTO

      219    12144    2               CALL KIQ$FESTOP (FEX,KIER_STOP);

  12144  1 000424   000002 236000 2                  LDQ     2
         1 000425   200071 756100                    STQ     QOS+3,,AUTO
         1 000426   200012 630500                    EPPR0   FEX,,AUTO
         1 000427   200070 450500                    STP0    QOS+2,,AUTO
         1 000430   200070 630500                    EPPR0   QOS+2,,AUTO
         1 000431   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000432   000000 701000 xent               TSX1    KIQ$FESTOP
         1 000433   000000 011000                    NOP     0
         1 000434   000603 710000 1                  TRA     s:12189

      220    12145
      221    12146    2             CASE (IGA_ABRTUSER);

      222    12147
      223    12148    2             CASE (IGA_CWNAK);

      224    12149    2              LDCT$=NK$LDCT$(KL$CWNAK.NETADR.LDX.BYT(0)*256+KL$CWNAK.NETADR.LDX.BYT(1)
             12149                        );

  12149  1 000435   200005 470500                    LDP0    MSG$,,AUTO
         1 000436   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:45   
         1 000437   000022 772000                    QRL     18
         1 000440   000377 376007                    ANQ     255,DL
         1 000441   200070 756100                    STQ     QOS+2,,AUTO
         1 000442   000001 236100                    LDQ     1,,PR0
         1 000443   000023 772000                    QRL     19
         1 000444   177400 376007                    ANQ     65280,DL
         1 000445   200070 036100                    ADLQ    QOS+2,,AUTO
         1 000446   000000 471400 xsym               LDP1    N$DCT$$
         1 000447   100000 236106                    LDQ     0,QL,PR1
         1 000450   200006 756100                    STQ     LDCT$,,AUTO

      225    12150                    %LOCK (G=K_LOCK);

  12151  1 000451   000003 630400 2                  EPPR0   3
         1 000452   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000453   000000 701000 xent               TSX1    HFC$LOCK
         1 000454   000000 011000                    NOP     0

      226    12153    2               IF LDCT$~=ADDR(NIL)

  12153  1 000455   200006 236100                    LDQ     LDCT$,,AUTO
         1 000456   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000457   000521 600000 1                  TZE     s:12162
         1 000460   200006 470500                    LDP0    LDCT$,,AUTO
         1 000461   000014 236100                    LDQ     12,,PR0
         1 000462   000022 772000                    QRL     18
         1 000463   000377 376007                    ANQ     255,DL
         1 000464   200070 756100                    STQ     QOS+2,,AUTO
         1 000465   200005 471500                    LDP1    MSG$,,AUTO
         1 000466   100000 236100                    LDQ     0,,PR1
         1 000467   000777 376007                    ANQ     511,DL
         1 000470   200070 116100                    CMPQ    QOS+2,,AUTO
         1 000471   000521 601000 1                  TNZ     s:12162
         1 000472   000011 236100                    LDQ     9,,PR0
         1 000473   100000 316003                    CANQ    32768,DU
         1 000474   000521 600000 1                  TZE     s:12162

PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:46   
      227    12154    2               AND KL$CWNAK.NETADR.GENERATION = NK$LDCT.GENERATION
      228    12155    2               AND NK$LDCT.LKFLG.REGGED
      229    12156    3               THEN DO;

      230    12157    3                 CALL KIA$NETERR2ERR(KL$CWNAK.NETERR,NK$LDCT.ERR);

  12157  1 000475   200006 236100                    LDQ     LDCT$,,AUTO
         1 000476   200071 756100                    STQ     QOS+3,,AUTO
         1 000477   200005 236100                    LDQ     MSG$,,AUTO
         1 000500   000004 036000 2                  ADLQ    4
         1 000501   200070 756100                    STQ     QOS+2,,AUTO
         1 000502   200070 630500                    EPPR0   QOS+2,,AUTO
         1 000503   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000504   000000 701000 xent               TSX1    KIA$NETERR2ERR
         1 000505   000000 011000                    NOP     0

      231    12158    3                 CALL SSR$RUE(%SS_CIC,NK$LDCT.USER);

  12158  1 000506   200006 236100                    LDQ     LDCT$,,AUTO
         1 000507   000005 036000 2                  ADLQ    5
         1 000510   000006 235000 2                  LDA     6
         1 000511   200070 757100                    STAQ    QOS+2,,AUTO
         1 000512   200070 630500                    EPPR0   QOS+2,,AUTO
         1 000513   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000514   000000 701000 xent               TSX1    SSR$RUE
         1 000515   000000 011000                    NOP     0

      232    12159    3                 NK$LDCT.LKFLG.REGGED = '0'B;

  12159  1 000516   200006 470500                    LDP0    LDCT$,,AUTO
         1 000517   000007 236000 2                  LDQ     7
         1 000520   000011 356100                    ANSQ    9,,PR0

      233    12160    3                 END;

      234    12161                    %UNLOCK (G=K_LOCK);

PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:47   
  12162  1 000521   000003 630400 2                  EPPR0   3
         1 000522   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000523   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000524   000000 011000                    NOP     0
         1 000525   000603 710000 1                  TRA     s:12189

      235    12164
      236    12165    2             CASE (IGA_NODECHG);

      237    12166    2               NODE# = KL$NODECHG.NODE;

  12166  1 000526   200005 470500                    LDP0    MSG$,,AUTO
         1 000527   000001 236100                    LDQ     1,,PR0
         1 000530   000033 772000                    QRL     27
         1 000531   200064 756100                    STQ     NODE#,,AUTO

      238    12167    2               QOS = KL$NODECHG.QOS;

  12167  1 000532   000001 236100                    LDQ     1,,PR0
         1 000533   000011 772000                    QRL     9
         1 000534   000777 376007                    ANQ     511,DL
         1 000535   200066 756100                    STQ     QOS,,AUTO

      239    12168    2               LNKNODE = KL$NODECHG.MYNODE;

  12168  1 000536   000000 236100                    LDQ     0,,PR0
         1 000537   000777 376007                    ANQ     511,DL
         1 000540   200065 756100                    STQ     LNKNODE,,AUTO

  12168  1 000541                       RETRY_KIN    null
      240    12169    2   RETRY_KIN:  ;
      241    12170    2               CALL KIN$NODECHG(NODE#,LNKNODE,QOS)

  12170  1 000541   200066 630500                    EPPR0   QOS,,AUTO
         1 000542   200072 450500                    STP0    QOS+4,,AUTO
         1 000543   200065 631500                    EPPR1   LNKNODE,,AUTO
         1 000544   200071 451500                    STP1    QOS+3,,AUTO
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:48   
         1 000545   200064 633500                    EPPR3   NODE#,,AUTO
         1 000546   200070 453500                    STP3    QOS+2,,AUTO
         1 000547   200070 630500                    EPPR0   QOS+2,,AUTO
         1 000550   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000551   000000 701000 xent               TSX1    KIN$NODECHG
         1 000552   000554 702000 1                  TSX2    s:12172
         1 000553   000566 710000 1                  TRA     s:12173+1

      242    12171    3               WHENALTRETURN DO;

      243    12172    3                 CALL SSR$REG(%SS_SL,,1);

  12172  1 000554   000011 236000 2                  LDQ     9
         1 000555   200072 756100                    STQ     QOS+4,,AUTO
         1 000556   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000557   000012 235000 2                  LDA     10
         1 000560   200070 757100                    STAQ    QOS+2,,AUTO
         1 000561   200070 630500                    EPPR0   QOS+2,,AUTO
         1 000562   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000563   000000 701000 xent               TSX1    SSR$REG
         1 000564   000000 011000                    NOP     0

      244    12173    3                 GOTO RETRY_KIN;

  12173  1 000565   000541 710000 1                  TRA     RETRY_KIN
         1 000566   000603 710000 1                  TRA     s:12189

      245    12174    3                 END;
      246    12175
      247    12176    2             CASE (IGA_NODEINFO);

      248    12177
      249    12178    2             CASE(IGA_UPDOSI,IGA_DELOSI);

      250    12179    3               CALL KIN$OSICHG(KL$UPDOSI) WHENALTRETURN DO;

  12179  1 000567   200005 630500                    EPPR0   MSG$,,AUTO
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:49   
         1 000570   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000571   000000 701000 xent               TSX1    KIN$OSICHG
         1 000572   000574 702000 1                  TSX2    s:12181
         1 000573   000574 710000 1                  TRA     s:12181

      251    12180                   /* ignore them for now */
      252    12181    3                 END;

  12181  1 000574   000603 710000 1                  TRA     s:12189

      253    12182
      254    12183    2             CASE(IGA_OSILINKCHG);

      255    12184    3               CALL KIN$OSILINKCHG(KL$OSILINKCHG) WHENALTRETURN DO;

  12184  1 000575   200005 630500                    EPPR0   MSG$,,AUTO
         1 000576   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000577   000000 701000 xent               TSX1    KIN$OSILINKCHG
         1 000600   000602 702000 1                  TSX2    s:12185
         1 000601   000602 710000 1                  TRA     s:12185

      256    12185    3                 END;

  12185  1 000602   000603 710000 1                  TRA     s:12189

      257    12186    2             CASE (ELSE);

      258    12187
      259    12188    2           END;

      260    12189    1         N$REQ.STATION.LSTA$=ADDR(KUB_STA);

  12189  1 000603   000013 236000 2                  LDQ     11
         1 000604   200003 470500                    LDP0    @N$REQ,,AUTO
         1 000605   000013 756100                    STQ     11,,PR0

      261    12190    1         N$REQ.OPFLG.REQ='1'B;
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:50   

  12190  1 000606   000002 236007                    LDQ     2,DL
         1 000607   000004 256100                    ORSQ    4,,PR0

      262    12191    1         RETURN;

  12191  1 000610   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   2     000   000000 006000   000000 000015   000001 006000   000000 006000    ................
   2     004   000001 400000   000007 200000   000007 006000   677777 777777    ................
   2     010   000000 000031   000003 006000   000010 006000   000000 006000    ................
      263    12192    1   END KUB$EA;
      264    12193        %EOD;

PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:51   
--  Include file information  --

   SS_SCHED_C.:E05TOU  is referenced.
   N_FC_C.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   NK_LDCT_R.:E05TOU  cannot be made into a system file and is referenced.
   NK$LDCT.:E05TOU  is referenced.
   K_SUBS_C.:E05TOU  is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   K_REASON_C.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   K_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KUB_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KUB$EA.
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:52   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @N$REQ                    12-0-0/w UBIN        r     1 FEX
    14-0-0/d STRC(1404)  r     1 K$RWPARM                   6-0-0/w PTR         r     1 LDCT$
    65-0-0/w UBIN        r     1 LNKNODE                    5-0-0/w PTR         r     1 MSG$
    *0-0-0/d STRC(1080)  r     1 N$REQ                     64-0-0/w UBIN        r     1 NODE#
    66-0-0/w UBIN        r     1 QOS                        4-0-0/w UBIN        r     1 SIZE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(540)   r     1 B_MONINFO                  0-0-0/c STRC(2304)  r     1 KUB_MSG
     0-0-0/w STRC(288)   r     1 KUB_STA                    0-0-0/c STRC(1089)  r     1 K_HEADER
     0-0-0/b BIT (72)    r     1 K_LOCK                     0-0-0/w UBIN        r     1 K_NODE#
     0-0-0/d STRC(1404)  r     1 K_RWPARM_CON               0-0-0/w PTR         r     1 N$DCT$$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ASTR(0)     r     1 B$MSG                      0-0-0/w STRC(1098)  r     1 KL$ADMES
     0-0-0/w STRC(108)   r     1 KL$CWNAK                   0-0-0/w STRC(63)    r     1 KL$NODECHG
     0-0-0/w STRC(288)   r     1 KL$OSILINKCHG              0-0-0/w STRC(144)   r     1 KL$SETNODE
     0-0-0/w STRC(297)   r     1 KL$SGNRSP                  0-0-0/w STRC(540)   r     1 KL$UPDOSI
     0-0-0/d STRC(864)   r     1 NK$LDCT
     0-0-0/w PTR         r     1 NK$LDCT$(0:0)

PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:53   

   Procedure KUB$EA requires 393 words for executable code.
   Procedure KUB$EA requires 60 words of local(AUTO) storage.
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:54   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:55   
          MINI XREF LISTING

B$MSG.TEXT
     11706**DCL     12118>>ASSIGN  12123>>ASSIGN
B_MONINFO.NODE#
     11725**DCL     12129<<ASSIGN
B_MONINFO.NODE_NAME
     11725**DCL     12131<<ASSIGN
FEX
     11729**DCL     12139<<ASSIGN  12140<>CALL    12143<<ASSIGN  12144<>CALL
HFC$LOCK
      5589**DCL-ENT 12089--CALL    12151--CALL
HFC$UNLOCK
      5589**DCL-ENT 12107--CALL    12162--CALL
K$RWPARM
     11751**DCL     12092<<ASSIGN  12100<>CALL
K$RWPARM.BLKREC
     11777**DCL     11802--REDEF
K$RWPARM.BLKREC.BLKU#
     11778**DCL     11780--REDEF
K$RWPARM.BLKREC.RECU#
     11790**DCL     11792--REDEF
K$RWPARM.DVE.DVBYTE.VFC
     11817**DCL     11818--REDEF
K$RWPARM.DVE.EOMCHAR
     11825**DCL     11829--REDEF
K$RWPARM.ERR
     11889**DCL     11894--REDEF   12094<<ASSIGN  12095<<ASSIGN  12109>>IF
K$RWPARM.FC
     11853**DCL     11854--REDEF
K$RWPARM.FLDID
     12035**DCL     12036--REDEF
K$RWPARM.FPT$
     11916**DCL     11923--REDEF
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:56   
K$RWPARM.FUNCTION
     11930**DCL     12099<<ASSIGN
K$RWPARM.KEYTYPE
     12042**DCL     12043--REDEF
K$RWPARM.LDCT$
     11912**DCL     12098<<ASSIGN
K$RWPARM.MSG$
     11752**DCL     11758--REDEF
K$RWPARM.MSGID
     11864**DCL     11869--REDEF
K$RWPARM.MSGIDXT
     11877**DCL     11881--REDEF
K$RWPARM.ORG
     12013**DCL     12014--REDEF
K$RWPARM.THDRSZ
     11957**DCL     11961--REDEF
K$RWPARM.UHDR$
     11902**DCL     12096<<ASSIGN
K$RWPARM.UHDRSZ
     11907**DCL     12097<<ASSIGN
K$RWPARM.VDOFLGS
     12015**DCL     12026--REDEF
KCO$TRMGO
     12052**DCL-ENT 12110--CALL
KIA$NETERR2ERR
     12062**DCL-ENT 12157--CALL
KIA$OQFL
     12063**DCL-ENT 12102--CALL
KIN$NODECHG
     12049**DCL-ENT 12170--CALL
KIN$OSICHG
     12064**DCL-ENT 12179--CALL
KIN$OSILINKCHG
     12065**DCL-ENT 12184--CALL
KIN$SET_NODE
     12050**DCL-ENT 12135--CALL
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:57   
KIP$SENDALL
     12053**DCL-ENT 12078--CALL    12081--CALL
KIQ$FESTOP
     12055**DCL-ENT 12144--CALL
KIQ$FESTRT
     12054**DCL-ENT 12140--CALL
KIS$SEND
     12066**DCL-ENT 12100--CALL
KL$ADMES
     11093**DCL     12074--ASSIGN  12116--ASSIGN  12121--ASSIGN
KL$ADMES.MSG_
     11096**DCL     12074--ASSIGN  12078<>CALL    12081<>CALL    12116--ASSIGN  12118--ASSIGN  12121--ASSIGN
     12123--ASSIGN
KL$ADMES.TYP
     11095**DCL     12075>>IF      12077>>ASSIGN
KL$CWNAK.NETADR.GENERATION
     11046**DCL     12153>>IF
KL$CWNAK.NETADR.LDX.BYT
     11050**DCL     12149>>ASSIGN  12149>>ASSIGN
KL$CWNAK.NETERR
     11070**DCL     12157<>CALL
KL$NODECHG.MYNODE
     11322**DCL     12168>>ASSIGN
KL$NODECHG.NODE
     11323**DCL     12166>>ASSIGN
KL$NODECHG.QOS
     11325**DCL     12167>>ASSIGN
KL$OSILINKCHG
     11553**DCL     12184<>CALL
KL$OSILINKCHG.TERMID.TERM
     11645**DCL     11654--REDEF
KL$SETNODE.HOST_NODE
     11260**DCL     12135<>CALL
KL$SETNODE.MY_NODE
     11255**DCL     12127>>IF
KL$SETNODE.NODE#
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:58   
     11272**DCL     12129>>ASSIGN  12130>>ASSIGN  12134>>ASSIGN
KL$SETNODE.NODE_NAME
     11276**DCL     12131>>ASSIGN  12135<>CALL
KL$SGNRSP
     11113**DCL     12096--ASSIGN
KL$SGNRSP.ERRCODE
     11167**DCL     12093>>IF      12109>>IF      12111>>IF
KL$SGNRSP.LDCTX
     11129**DCL     12085>>ASSIGN
KL$SGNRSP.NMID
     11126**DCL     11129--REDEF
KL$SGNRSP.TERMID.TERM
     11216**DCL     11225--REDEF
KL$UPDOSI
     11344**DCL     12179<>CALL
KL$UPDOSI.LNSAP.ADDRESS_N
     11498**DCL     11499--REDEF
KL$UPDOSI.MYNODE#
     11379**DCL     11381--REDEF
KL$UPDOSI.NODE#
     11382**DCL     11384--REDEF
KL$UPDOSI.NSAP.ADDRESS_N
     11442**DCL     11443--REDEF
KUB_MSG
      9319**DCL     12069--ASSIGN
KUB_MSG.FCN
      9319**DCL     12070>>DOCASE
KUB_MSG.NODE
      9319**DCL     12139>>ASSIGN  12143>>ASSIGN
KUB_STA
      9332**DCL     12189--ASSIGN
KUB_STA.MSGIDXT
      9342**DCL      9345--REDEF
K_HEADER.CNT
     10058**DCL     12117<<ASSIGN  12122<<ASSIGN
K_HEADER.TEXT
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:59   
     10058**DCL     12118<<ASSIGN  12123<<ASSIGN
K_LOCK
     10058**DCL     12151<>CALL    12162<>CALL
K_NODE#
     10058**DCL     12130<<ASSIGN
K_RWPARM_CON
      9763**DCL     12092>>ASSIGN
K_RWPARM_CON.BLKREC
      9789**DCL      9814--REDEF
K_RWPARM_CON.BLKREC.BLKU#
      9790**DCL      9792--REDEF
K_RWPARM_CON.BLKREC.RECU#
      9802**DCL      9804--REDEF
K_RWPARM_CON.DVE.DVBYTE.VFC
      9829**DCL      9830--REDEF
K_RWPARM_CON.DVE.EOMCHAR
      9837**DCL      9841--REDEF
K_RWPARM_CON.ERR
      9901**DCL      9906--REDEF
K_RWPARM_CON.FC
      9865**DCL      9866--REDEF
K_RWPARM_CON.FLDID
     10047**DCL     10048--REDEF
K_RWPARM_CON.FPT$
      9928**DCL      9935--REDEF
K_RWPARM_CON.KEYTYPE
     10054**DCL     10055--REDEF
K_RWPARM_CON.MSG$
      9764**DCL      9770--REDEF
K_RWPARM_CON.MSGID
      9876**DCL      9881--REDEF
K_RWPARM_CON.MSGIDXT
      9889**DCL      9893--REDEF
K_RWPARM_CON.ORG
     10025**DCL     10026--REDEF
K_RWPARM_CON.THDRSZ
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:60   
      9969**DCL      9973--REDEF
K_RWPARM_CON.VDOFLGS
     10027**DCL     10038--REDEF
LDCT$
     11709**DCL     11672--IMP-PTR 12085<<ASSIGN  12086>>IF      12089>>CALL    12098>>ASSIGN  12102>>CALL
     12107>>CALL    12110<>CALL    12112<>CALL    12149<<ASSIGN  12153>>IF      12153>>IF      12153>>IF
     12157>>CALL    12158>>CALL    12159>>ASSIGN
LNKNODE
     12047**DCL     12168<<ASSIGN  12170<>CALL
MSG$
     11708**DCL     11040--IMP-PTR 11093--IMP-PTR 11113--IMP-PTR 11248--IMP-PTR 11294--IMP-PTR 11318--IMP-PTR
     11344--IMP-PTR 11553--IMP-PTR 12069<<ASSIGN  12075>>IF      12077>>ASSIGN  12078>>CALL    12081>>CALL
     12085>>ASSIGN  12093>>IF      12096>>ASSIGN  12109>>IF      12111>>IF      12118>>ASSIGN  12123>>ASSIGN
     12127>>IF      12129>>ASSIGN  12130>>ASSIGN  12131>>ASSIGN  12134>>ASSIGN  12135>>CALL    12135>>CALL
     12149>>ASSIGN  12149>>ASSIGN  12153>>IF      12157>>CALL    12166>>ASSIGN  12167>>ASSIGN  12168>>ASSIGN
     12179>>CALL    12184>>CALL
N$DCT$$
     10730**DCL     10730--IMP-PTR 12085>>ASSIGN  12149>>ASSIGN
N$REQ
      5673**DCL         6--PROC
N$REQ.ARSIZE
      5706**DCL     12074>>ASSIGN  12097>>ASSIGN  12116>>ASSIGN  12121>>ASSIGN
N$REQ.BUFADDR
      5682**DCL      5683--REDEF    5683--REDEF
N$REQ.DLA.DRELADDR
      5674**DCL      5674--REDEF
N$REQ.DVE.EOMCHAR
      5711**DCL      5712--REDEF
N$REQ.EAINFO
      5705**DCL      5705--REDEF
N$REQ.EAINFOX
      5705**DCL      5706--REDEF
N$REQ.EVNTINFO
      5706**DCL      5706--REDEF
N$REQ.OPFLG.REQ
      5681**DCL     12190<<ASSIGN
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:61   
N$REQ.STATION.LSTA$
      5686**DCL     12189<<ASSIGN
N$REQ.STATUS
      5687**DCL      5693--REDEF
NK$LDCT
     11672**DCL     12102<>CALL
NK$LDCT.DDT$
     11674**DCL     11674--REDEF
NK$LDCT.ERR
     11673**DCL     12157<>CALL
NK$LDCT.GENERATION
     11695**DCL     12153>>IF
NK$LDCT.IOQ$
     11673**DCL     11674--REDEF
NK$LDCT.LDCTX
     11675**DCL     11675--REDEF
NK$LDCT.LKFLG.ABORTED
     11687**DCL     11688--REDEF
NK$LDCT.LKFLG.REGGED
     11688**DCL     12153>>IF      12159<<ASSIGN
NK$LDCT.LOCK
     11700**DCL     12089<>CALL    12107<>CALL
NK$LDCT.RLCID.LDCTX
     11697**DCL     11697--REDEF
NK$LDCT.STA$
     11693**DCL     11694--REDEF
NK$LDCT.SYMB$
     11672**DCL     11672--REDEF   11672--REDEF   11673--REDEF
NK$LDCT.USER
     11682**DCL     12158<>CALL
NK$LDCT$
     10730**DCL     12085>>ASSIGN  12149>>ASSIGN
NKL$RELDCT
     12067**DCL-ENT 12112--CALL
NODE#
     12046**DCL     12077<<ASSIGN  12078<>CALL    12134<<ASSIGN  12135<>CALL    12166<<ASSIGN  12170<>CALL
PL6.E3A0      #002=KUB$EA File=KUB$BABOON.:E05TSI                                WED 07/30/97 01:52 Page:62   
QOS
     12048**DCL     12167<<ASSIGN  12170<>CALL
RETRY
     12089**LABEL   12103--GOTO
RETRY_KIN
     12168**LABEL   12173--GOTO
SENDALL
     12073**LABEL   12124--GOTO
SIZE
     11707**DCL     11706--IMP-SIZ 12074<<ASSIGN  12078<>CALL    12081<>CALL    12116<<ASSIGN  12117>>ASSIGN
     12118>>ASSIGN  12121<<ASSIGN  12122>>ASSIGN  12123>>ASSIGN
SSR$REG
     12061**DCL-ENT 12172--CALL
SSR$RUE
     12060**DCL-ENT 12158--CALL

PL6.E3A0      #003=KUB$INIT File=KUB$BABOON.:E05TSI                              WED 07/30/97 01:53 Page:63   
      265        1        /*T***********************************************************/
      266        2        /*T*                                                         */
      267        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      268        4        /*T*                                                         */
      269        5        /*T***********************************************************/
      270        6        /*K* NAME: KUB$INIT
      271        7             PURPOSE:
      272        8                  To initialize the BABOON monitor DCB station on NETCG
      273        9             DESCRIPTION:
      274       10                  KUB$INIT is called at init time to start up the BABOON
      275       11                  monitor DCB station. It obtains an IOQ packet and posts a
      276       12                  no-wait read on the NETCG comgroup.
      277       13        */
      278       14        KUB$INIT: PROC;
      279       15        %INCLUDE KC_CP6;
      280      575        %INCLUDE KUB_DATA_R;
      281      612        %INCLUDE N$REQ;
      282      686        %INCLUDE N_FC_C;
      283      723        %N$REQ;
      284      781    1   DCL KUB$EA ENTRY(1);
      285      782    1   DCL NIQ$GET ENTRY(1) ALTRET;
      286      783    1   DCL NIO$QUE ENTRY(1) ALTRET;
      287      784        /* Symdef items */
      288      785        /* Symref items */
      289      786    1   DCL NK_BABOONLDX UBIN WORD SYMREF;
      290      787
      291      788    1         CALL NIQ$GET (KUB_IOQ$);
      292      789    1         KUB_IOQ$ -> N$REQ.OPFLG = OP_EA|OP_BPF|OP_HOLD;  /* EA, BPF, HOLD        */
      293      790    1         KUB_IOQ$ -> N$REQ.DLA.DCTX = NK_BABOONLDX;
               790                  /* LDCT index of station 'BABOON' */
      294      791    1         KUB_IOQ$ -> N$REQ.BUF$ = ADDR(KUB_MSG); /* buffer pointer                */
      295      792    1         KUB_IOQ$ -> N$REQ.BUFSIZE = SIZEC (KUB_MSG); /* buffer size              */
      296      793    1         KUB_IOQ$ -> N$REQ.FC = %N_RDASC;      /* function is read                   */
      297      794    1         KUB_IOQ$ -> N$REQ.EAENTRY = ENTADDR (KUB$EA); /* end-action routine     */
      298      795    1         KUB_IOQ$->N$REQ.STATION.LSTA$=ADDR(KUB_STA);
      299      796    1         KUB_IOQ$->N$REQ.NOALT='1'B;
      300      797    1         CALL NIO$QUE (KUB_IOQ$->N$REQ);
PL6.E3A0      #003=KUB$INIT File=KUB$BABOON.:E05TSI                              WED 07/30/97 01:53 Page:64   
      301      798    1         RETURN;
      302      799    1   END KUB$INIT;

PL6.E3A0      #003=KUB$INIT File=KUB$BABOON.:E05TSI                              WED 07/30/97 01:53 Page:65   
--  Include file information  --

   N_FC_C.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   KUB_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KC_CP6.:E05TOU  is referenced.
      No diagnostics issued in procedure KUB$INIT.

   Procedure KUB$INIT requires 33 words for executable code.
   Procedure KUB$INIT requires 4 words of local(AUTO) storage.

    No errors detected in file KUB$BABOON.:E05TSI    .

PL6.E3A0      #003=KUB$INIT File=KUB$BABOON.:E05TSI                              WED 07/30/97 01:53 Page:66   

 Object Unit name= KUB$INIT                                   File name= KUB$BABOON.:E05TOU
 UTS= JUL 30 '97 01:53:13.88 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    33     41  KUB$INIT
    1  RoData even  none     3      3  KUB$INIT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        0  KUB$INIT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 NIQ$GET
 yes     yes           Std       1 NIO$QUE
         yes           Std       1 KUB$EA
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KUB_MSG                               KUB_STA                               KUB_IOQ$
     NK_BABOONLDX                          B_VECTNIL
PL6.E3A0      #003=KUB$INIT File=KUB$BABOON.:E05TSI                              WED 07/30/97 01:53 Page:67   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #003=KUB$INIT File=KUB$BABOON.:E05TSI                              WED 07/30/97 01:53 Page:68   


      265        1        /*T***********************************************************/
      266        2        /*T*                                                         */
      267        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      268        4        /*T*                                                         */
      269        5        /*T***********************************************************/
      270        6        /*K* NAME: KUB$INIT
      271        7             PURPOSE:
      272        8                  To initialize the BABOON monitor DCB station on NETCG
      273        9             DESCRIPTION:
      274       10                  KUB$INIT is called at init time to start up the BABOON
      275       11                  monitor DCB station. It obtains an IOQ packet and posts a
      276       12                  no-wait read on the NETCG comgroup.
      277       13        */
      278       14        KUB$INIT: PROC;

     14  0 000000   000000 700200 xent  KUB$INIT     TSX0  ! X66_AUTO_0
         0 000001   000004 000000                    ZERO    4,0

      279       15        %INCLUDE KC_CP6;
      280      575        %INCLUDE KUB_DATA_R;
      281      612        %INCLUDE N$REQ;
      282      686        %INCLUDE N_FC_C;
      283      723        %N$REQ;
      284      781    1   DCL KUB$EA ENTRY(1);
      285      782    1   DCL NIQ$GET ENTRY(1) ALTRET;
      286      783    1   DCL NIO$QUE ENTRY(1) ALTRET;
      287      784        /* Symdef items */
      288      785        /* Symref items */
      289      786    1   DCL NK_BABOONLDX UBIN WORD SYMREF;
      290      787
      291      788    1         CALL NIQ$GET (KUB_IOQ$);

    788  0 000002   000000 630400 1                  EPPR0   0
         0 000003   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000004   000000 701000 xent               TSX1    NIQ$GET
         0 000005   000000 011000                    NOP     0
PL6.E3A0      #003=KUB$INIT File=KUB$BABOON.:E05TSI                              WED 07/30/97 01:53 Page:69   

      292      789    1         KUB_IOQ$ -> N$REQ.OPFLG = OP_EA|OP_BPF|OP_HOLD;  /* EA, BPF, HOLD        */

    789  0 000006   000000 470400 xsym               LDP0    KUB_IOQ$
         0 000007   000054 236007                    LDQ     44,DL
         0 000010   000004 552104                    STBQ    4,'04'O,PR0

      293      790    1         KUB_IOQ$ -> N$REQ.DLA.DCTX = NK_BABOONLDX;
               790                  /* LDCT index of station 'BABOON' */

    790  0 000011   000000 236000 xsym               LDQ     NK_BABOONLDX
         0 000012   000025 736000                    QLS     21
         0 000013   000001 676100                    ERQ     1,,PR0
         0 000014   777770 376003                    ANQ     -8,DU
         0 000015   000001 656100                    ERSQ    1,,PR0

      294      791    1         KUB_IOQ$ -> N$REQ.BUF$ = ADDR(KUB_MSG); /* buffer pointer                */

    791  0 000016   000001 236000 1                  LDQ     1
         0 000017   000005 756100                    STQ     5,,PR0

      295      792    1         KUB_IOQ$ -> N$REQ.BUFSIZE = SIZEC (KUB_MSG); /* buffer size              */

    792  0 000020   000004 236100                    LDQ     4,,PR0
         0 000021   177777 376007                    ANQ     65535,DL
         0 000022   000100 276003                    ORQ     64,DU
         0 000023   000004 756100                    STQ     4,,PR0

      296      793    1         KUB_IOQ$ -> N$REQ.FC = %N_RDASC;      /* function is read                  */

    793  0 000024   000004 236007                    LDQ     4,DL
         0 000025   000003 552104                    STBQ    3,'04'O,PR0

      297      794    1         KUB_IOQ$ -> N$REQ.EAENTRY = ENTADDR (KUB$EA); /* end-action routine     */

    794  0 000026   000000 636000 xent               EAQ     KUB$EA
         0 000027   000023 756100                    STQ     19,,PR0
PL6.E3A0      #003=KUB$INIT File=KUB$BABOON.:E05TSI                              WED 07/30/97 01:53 Page:70   

      298      795    1         KUB_IOQ$->N$REQ.STATION.LSTA$=ADDR(KUB_STA);

    795  0 000030   000002 236000 1                  LDQ     2
         0 000031   000013 756100                    STQ     11,,PR0

      299      796    1         KUB_IOQ$->N$REQ.NOALT='1'B;

    796  0 000032   100000 236007                    LDQ     32768,DL
         0 000033   000004 256100                    ORSQ    4,,PR0

      300      797    1         CALL NIO$QUE (KUB_IOQ$->N$REQ);

    797  0 000034   000000 630400 xsym               EPPR0   KUB_IOQ$
         0 000035   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000036   000000 701000 xent               TSX1    NIO$QUE
         0 000037   000000 011000                    NOP     0

      301      798    1         RETURN;

    798  0 000040   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   1     000   000000 006000   000000 006000   000000 006000                    ............
      302      799    1   END KUB$INIT;

PL6.E3A0      #003=KUB$INIT File=KUB$BABOON.:E05TSI                              WED 07/30/97 01:53 Page:71   
--  Include file information  --

   N_FC_C.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   KUB_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KC_CP6.:E05TOU  is referenced.
      No diagnostics issued in procedure KUB$INIT.
PL6.E3A0      #003=KUB$INIT File=KUB$BABOON.:E05TSI                              WED 07/30/97 01:53 Page:72   

 **** Variables and constants ****

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KUB_IOQ$                   0-0-0/c STRC(2304)  r     1 KUB_MSG
     0-0-0/w STRC(288)   r     1 KUB_STA                    0-0-0/w UBIN        r     1 NK_BABOONLDX

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(1080)  r     1 N$REQ


   Procedure KUB$INIT requires 33 words for executable code.
   Procedure KUB$INIT requires 4 words of local(AUTO) storage.

    No errors detected in file KUB$BABOON.:E05TSI    .
PL6.E3A0      #003=KUB$INIT File=KUB$BABOON.:E05TSI                              WED 07/30/97 01:53 Page:73   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=KUB$INIT File=KUB$BABOON.:E05TSI                              WED 07/30/97 01:53 Page:74   
          MINI XREF LISTING

KUB$EA
       781**DCL-ENT   794--ASSIGN
KUB_IOQ$
       611**DCL       788<>CALL      789>>ASSIGN    790>>ASSIGN    791>>ASSIGN    792>>ASSIGN    793>>ASSIGN
       794>>ASSIGN    795>>ASSIGN    796>>ASSIGN    797>>CALL
KUB_MSG
       583**DCL       791--ASSIGN    792--ASSIGN
KUB_STA
       596**DCL       795--ASSIGN
KUB_STA.MSGIDXT
       606**DCL       609--REDEF
N$REQ
       732**DCL       797<>CALL
N$REQ.BUF$
       741**DCL       791<<ASSIGN
N$REQ.BUFADDR
       741**DCL       742--REDEF     742--REDEF
N$REQ.BUFSIZE
       735**DCL       792<<ASSIGN
N$REQ.DLA.DCTX
       732**DCL       790<<ASSIGN
N$REQ.DLA.DRELADDR
       733**DCL       733--REDEF
N$REQ.DVE.EOMCHAR
       770**DCL       771--REDEF
N$REQ.EAENTRY
       763**DCL       794<<ASSIGN
N$REQ.EAINFO
       764**DCL       764--REDEF
N$REQ.EAINFOX
       764**DCL       765--REDEF
N$REQ.EVNTINFO
PL6.E3A0      #003=KUB$INIT File=KUB$BABOON.:E05TSI                              WED 07/30/97 01:53 Page:75   
       765**DCL       765--REDEF
N$REQ.FC
       735**DCL       793<<ASSIGN
N$REQ.NOALT
       735**DCL       796<<ASSIGN
N$REQ.OPFLG
       738**DCL       789<<ASSIGN
N$REQ.STATION.LSTA$
       745**DCL       795<<ASSIGN
N$REQ.STATUS
       746**DCL       752--REDEF
NIO$QUE
       783**DCL-ENT   797--CALL
NIQ$GET
       782**DCL-ENT   788--CALL
NK_BABOONLDX
       786**DCL       790>>ASSIGN
