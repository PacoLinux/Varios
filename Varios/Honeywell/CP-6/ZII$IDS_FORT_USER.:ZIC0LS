
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        /****************************************************************/
        7        7        /*                                                              */
        8        8        /*    I-D-S/II INTERFACE MODULE WITH FORTRAN/PL6 USERS          */
        9        9        /*                                                              */
       10       10        /****************************************************************/
       11       11        %MACRO GEN_PARAMS(TYPE=0); /* GENERATE SOURCE CODES FOR ALL ARGUMENTS */
       12       12         %SET PARAM# = %PARAM# + 1;
       13       13         %IF %PARAM# > %PARAMETERS;
       14       14         %SET PARAM# = 1;
       15       15         %ENDIF;
       16       16         %SET DIGITS = %PARAM# /10 + 1; /* NUMBER OF DIGITS */
       17       17         %SET ARG = CONCAT('A',BINCHAR(%PARAM#,%DIGITS));
       18       18         %IF TYPE = 0; /* GENERATE ARGUMENTS LIST */
       19       19         %IF %PARAM# < %PARAMETERS;
       20       20         %CHARTEXT(ARG),
       21       21         %ELSE;
       22       22         %CHARTEXT(ARG) );
       23       23         %ENDIF;
       24       24         %ELSEIF TYPE = 1;
       25       25         %IF %PARAM# < 4;
       26       26        DCL %CHARTEXT(ARG) (0:0) SBIN CALIGNED;
       27       27         %ELSE;
       28       28        DCL %CHARTEXT(ARG) SBIN CALIGNED;
       29       29         %ENDIF;
       30       30         %ELSEIF TYPE = 2;
       31       31            CALL CHK_ARG(%CHARTEXT(ARG)) ALTRET(END_OF_ARGS);
       32       32         %ELSE
       33       33         %ERROR('UNKNOWN TYPE IN MACRO GEN_PARAMS CALL');
       34       34         %ENDIF;
       35       35         %IF %PARAM# < %PARAMETERS;
       36       36            %GEN_PARAMS(TYPE=TYPE); /* KEEP GENERATING */
       37       37         %ENDIF;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:2    
       38       38        %MEND;
       39       39
       40       40        %EQU PARAMETERS = 20; /* MUST BE A MUTIPLE OF 4 */
       41       41        %EQU TYPE_BITS=2;
       42       42        %SET PARAM#=0;
       43       43         %EQU PARAMETERS_TIMES_TWO=%PARAMETERS*2;
       44       44        ZII$FORT_PL6: PROC(
       45       45               %GEN_PARAMS;
       46      586        %GEN_PARAMS(TYPE=1); /* GEN ALL DCL OF ARGUEMENTS */
       47     1127         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:3    
       48     1128        /** DEFINE CONTENTS OF KEY-WORDS IN SNA **/
       49     1129         %EQU ALL=2;
       50     1130         %EQU ANY=3;
       51     1131         %EQU AREANAME=4;
       52     1132         %EQU AREA=5;
       53     1133         %EQU CURRENCY=6;
       54     1134         %EQU CURRENT=7;
       55     1135         %EQU DBKEY=8;
       56     1136         %EQU DUPLICATE=9;
       57     1137         %EQU FIRST=10;
       58     1138         %EQU INCLUDING=11;
       59     1139         %EQU ITEM=12;
       60     1140         %EQU LAST=13;
       61     1141         %EQU LOAD=14;
       62     1142         %EQU NEXT=15;
       63     1143         %EQU NOSHALL=16;
       64     1144         %EQU ONLY=17;
       65     1145         %EQU OWNER=18;
       66     1146         %EQU PRIOR=19;
       67     1147         %EQU RECORD=20;
       68     1148         %EQU RETRIEVAL=12;
       69     1149         %EQU SET=22;
       70     1150         %EQU SETS=23;
       71     1151         %EQU SHAREALL=24;
       72     1152         %EQU SHAREANY=25;
       73     1153         %EQU SHAREIN=26;
       74     1154         %EQU UPDATE=27;
       75     1155         %EQU USING=28;
       76     1156         %EQU WITHIN=29;
       77     1157         %EQU SHCUR=30;
       78     1158         %EQU SHINCUR=31;
       79     1159        %EQU SNA_SIZE=30;
       80     1160         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:4    
       81     1161        /***************************************************************/
       82     1162        /*                                                             */
       83     1163        /*  SPECIAL NAME AREA (SNA) -  EXTROOT                         */
       84     1164        /*                                                             */
       85     1165        /***************************************************************/
       86     1166    1   DCL 1 SNA EXTROOT,
       87     1167    1         2 ALL SBIN INIT(%ALL),
       88     1168    1         2 ANY SBIN INIT(%ANY),
       89     1169    1         2 CURRENCY SBIN INIT(%CURRENCY),
       90     1170    1         2 CURRENT SBIN INIT(%CURRENT),
       91     1171    1         2 DBKEY SBIN INIT(%DBKEY),
       92     1172    1         2 DUPLICATE SBIN INIT(%DUPLICATE),
       93     1173    1         2 FIRST SBIN INIT(%FIRST),
       94     1174    1         2 INCLUDING SBIN INIT(%INCLUDING),
       95     1175    1         2 ITEM SBIN INIT(%ITEM),
       96     1176    1         2 LAST SBIN INIT(%LAST),
       97     1177    1         2 LOAD SBIN INIT(%LOAD),
       98     1178    1         2 NEXT SBIN INIT(%NEXT),
       99     1179    1         2 NOSHALL SBIN INIT(%NOSHALL),
      100     1180    1         2 ONLY SBIN INIT(%ONLY),
      101     1181    1         2 OWNER SBIN INIT(%OWNER),
      102     1182    1         2 PRIOR SBIN INIT(%PRIOR),
      103     1183    1         2 AREA SBIN INIT(%AREA),
      104     1184    1         2 AREANAME SBIN INIT(%AREANAME),
      105     1185    1         2 RECORD SBIN INIT(%RECORD),
      106     1186    1         2 RETRIEVAL SBIN INIT(%RETRIEVAL),
      107     1187    1         2 SET SBIN INIT(%SET),
      108     1188    1         2 SETS SBIN INIT(%SETS),
      109     1189    1         2 SHAREALL SBIN INIT(%SHAREALL),
      110     1190    1         2 SHAREANY SBIN INIT(%SHAREANY),
      111     1191    1         2 SHAREIN SBIN INIT(%SHAREIN),
      112     1192    1         2 UPDATE SBIN INIT(%UPDATE),
      113     1193    1         2 USING SBIN INIT(%USING),
      114     1194    1         2 WITHIN SBIN INIT(%WITHIN),
      115     1195    1         2 SHCUR SBIN INIT(%SHCUR),
      116     1196    1         2 SHINCUR SBIN INIT(%SHINCUR);
      117     1197        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:5    
      118     1198        /****************************************************************/
      119     1199        /*                                                              */
      120     1200        /*    DEFINE THE BASED STRUCTURE INTO A DYNAMIC PAGE            */
      121     1201        /*                                                              */
      122     1202        /****************************************************************/
      123     1203    1   DCL 1 ARG(0:0) BASED(ARG$) ALIGNED,
      124     1204    1         2 OFFSET UBIN HALF CALIGNED,
      125     1205    1         2 TYPE UBIN HALF CALIGNED;
      126     1206
      127     1207        /******************************************************************/
      128     1208        /*                                                                */
      129     1209        /*      COMMON FPT IS RESERVED TO 2*(%PARAMETERS)+10 WORDS        */
      130     1210        /*      IT IS UPDATED WHEN DOING MOST OF IDS_CALLS                */
      131     1211        /*                                                                */
      132     1212        /******************************************************************/
      133     1213    1   DCL 1 FPTS BASED(FPT$) DALIGNED, /* DALIGNED SO VECTOR IT RIGHT */
      134     1214    1         2 V_ VECTOR ALIGNED,
      135     1215    1         2 IA_ VECTOR ALIGNED,
      136     1216    1         2 UWA_ VECTOR ALIGNED,
      137     1217    1         2 RVA_ VECTOR ALIGNED,
      138     1218    1         2 USEP_ VECTOR ALIGNED,
      139     1219    1         2 V DALIGNED,
      140     1220    1           3 *(0:9) SBIN,
      141     1221    1           3 FPARAM (0:%PARAMETERS) SBIN WORD,
      142     1222    1           3 ARG(0:%PARAMETERS) PTR;
      143     1223
      144     1224    1   DCL 1 RLCW_SAVE BASED(RLCW$) ALIGNED,
      145     1225    1         2 * UBIN HALF UNAL,
      146     1226    1         2 AC_INDICATORS BIT(1) UNAL,
      147     1227    1         2 SC_INDICATORS BIT(1) UNAL,
      148     1228    1         2 RC_INDICATORS BIT(1) UNAL,
      149     1229    1         2 * BIT(7) UNAL,
      150     1230    1         2 N_SETS# UBIN(8) UNAL,
      151     1231    1         2 RETAIN_LIST(0:0) SBIN HALF CALIGNED;
      152     1232
      153     1233        /***************************************************************/
      154     1234        /*                                                             */
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:6    
      155     1235        /*  USE PROCEDURE TABLE (USEP) - GENERATED BEFORE HIA          */
      156     1236        /*                                                             */
      157     1237        /***************************************************************/
      158     1238    1   DCL 1 USEP BASED(USEP$) DALIGNED, /* MUST BE DALIGNED */
      159     1239    1         2 FLAG BIT(1) UNAL,
      160     1240    1         2 M UBIN(17) UNAL,
      161     1241    1         2 * SBIN HALF CALIGNED,
      162     1242    1         2 UC(0:200) ALIGNED, /* ALLOW 200 ENTRIES */
      163     1243    1           3 UCW_PRV,
      164     1244    1             4 PT UBIN BYTE CALIGNED,
      165     1245    1             4 PB BIT(9) CALIGNED,
      166     1246    1             4 A UBIN HALF CALIGNED,
      167     1247    1           3 UCW_USE REDEF UCW_PRV,
      168     1248    1             4 PT UBIN BYTE CALIGNED,
      169     1249    1             4 CODE UBIN(27) CALIGNED,
      170     1250    1           3 ENT$ PTR ALIGNED;
      171     1251        %INCLUDE B_SEGIDS_C;
      172     1790        %INCLUDE CP_6_SUBS;
      173     2330        %INCLUDE B_ERRORS_C;
      174     3457    1   DCL B$DS8$_B BIT(36) STATIC INIT('000000006013'O);
      175     3458    1   DCL B$DS8$ REDEF B$DS8$_B PTR;
      176     3459
      177     3460    1   DCL RVA_TYPE(0:0) UBIN(%TYPE_BITS) UNAL BASED(TYPE$);
      178     3461    1   DCL RVA_TYPEC CHAR(IX) BASED(TYPE$);
      179     3462    1   DCL IX UBIN STATIC;
      180     3463
      181     3464         %EQU FPT_SIZE=10+2*(%PARAMETERS+1)+10;
      182     3465         %EQU RLCW_SIZE=1+%PARAMETERS/2;
      183     3466         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:7    
      184     3467        /****************************************************************/
      185     3468        /*                                                              */
      186     3469        /*    WORKING SPACE FOR INTERFACE MODULE                        */
      187     3470        /*                                                              */
      188     3471        /****************************************************************/
      189     3472    1   DCL IDSSYSERR SBIN STATIC SYMDEF; /* FOR MON ERR_CODE IN IA(5) */
      190     3473    1   DCL CHAR7 CHAR(7) BASED;
      191     3474    1   DCL CHAR_V CHAR(K) BASED(PT$) UNAL;
      192     3475    1   DCL B$TCB$ PTR SYMREF;
      193     3476
      194     3477    1   DCL I SBIN STATIC;
      195     3478    1   DCL K SBIN STATIC;
      196     3479    1   DCL J SBIN STATIC;
      197     3480    1   DCL 1 REDEF_J REDEF J,
      198     3481    1         2 BIT9 BIT(9) UNAL,
      199     3482    1         2 * BIT(9) UNAL,
      200     3483    1         2 NAME SBIN HALF UNAL;
      201     3484    1   DCL SBIN36 SBIN WORD BASED;
      202     3485    1   DCL AUTO_FRAME(0:0) SBIN HALF UNAL BASED(B$AUTO$);
      203     3486    1   DCL ANAME_ (0:7) SBIN BASED;
      204     3487    1   DCL DEADLOCK_RET BIT(72) STATIC INIT('000000006004000000000000'O);
      205     3488    1   DCL 1 DK_RET REDEF DEADLOCK_RET,
      206     3489    1         2 AUTO_OFFSET UBIN HALF UNAL,
      207     3490    1         2 SEG# UBIN HALF UNAL,
      208     3491    1         2 RET_ADDR UBIN HALF UNAL,
      209     3492    1         2 * UBIN HALF UNAL;
      210     3493    1   DCL P$ PTR BASED;
      211     3494    1   DCL AUTO$ BIT(36) STATIC ALIGNED INIT('000000006004'O);
      212     3495    1   DCL B$AUTO$ REDEF AUTO$ PTR ALIGNED; /* SIMULATE B$AUTO$ */
      213     3496    1   DCL PT$ PTR STATIC;
      214     3497    1   DCL EPTR$ REDEF PT$ EPTR;
      215     3498    1   DCL 1 REDEF_PT REDEF PT$,
      216     3499    1         2 ADR UBIN HALF UNAL,
      217     3500    1         2 SEG# BIT(18) UNAL;
      218     3501    1   DCL E$ EPTR STATIC;
      219     3502    1   DCL 1 REDEF_E$ REDEF E$,
      220     3503    1         2 ADR UBIN HALF UNAL,
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:8    
      221     3504    1         2 * UBIN HALF UNAL;
      222     3505    1   DCL NINE_WORDS SBIN STATIC INIT(324); /* 9 WORDS = 324 BITS */
      223     3506    1   DCL CLEAR_BITS BIT(NINE_WORDS) BASED ALIGNED;
      224     3507    1   DCL NO_ARGS SBIN STATIC;
      225     3508    1   DCL 1 FPT_SHORT STATIC DALIGNED,
      226     3509    1         2 VEC1 BIT(72) INIT(VECTOR(I)),
      227     3510    1         2 VEC2 BIT(72),
      228     3511    1         2 VEC3 BIT(72);
      229     3512    1   DCL CHK_NBF_ROL_CRPT$ PTR STATIC INIT(ADDR(FPT_SHORT));
      230     3513    1   DCL IDS_ADR(0:7) UBIN HALF STATIC;
      231     3514    1   DCL IDS_BIT9(0:7) BIT(9) STATIC UNAL INIT('400'O,'200'O,'100'O,'040'O,
      232     3515    1    '020'O,'010'O,'010'O,'004'O);
      233     3516
      234     3517    1   DCL RETAIN_SWITCH SBIN STATIC INIT(0);
      235     3518    1   DCL II SBIN STATIC;
      236     3519    1   DCL LOW REDEF II SBIN;
      237     3520    1   DCL JJ SBIN STATIC;
      238     3521    1   DCL HIGH REDEF JJ SBIN;
      239     3522    1   DCL KK SBIN STATIC;
      240     3523    1   DCL SDSDCB UBIN STATIC;
      241     3524    1   DCL SUBDCB UBIN STATIC;
      242     3525    1   DCL SDSFLAG BIT(1) STATIC INIT('0'B);
      243     3526        %INCLUDE FM$FIT;
      244     3747        %FM$FIT;
      245     3750        %CODE04;
      246     3758    1   DCL FPBUF CHAR(4096) STATIC;
      247     3759    1   DCL FIT$ PTR;
      248     3760    1   DCL RVA (0:0) SBIN WORD BASED(RVA$);
      249     3761    1   DCL RVA_HALF(0:0) UBIN HALF HALIGNED BASED(RVA$);
      250     3762    1   DCL IA_HALF(0:0) UBIN HALF CALIGNED BASED(IA$);
      251     3763    1   DCL UWA (0:0) SBIN BASED(UWA$);
      252     3764
      253     3765    1   DCL UWA_SIZE SBIN STATIC;
      254     3766    1   DCL RVA_SIZE SBIN STATIC;
      255     3767    1   DCL NULL_OFFSET SBIN STATIC;
      256     3768        %INCLUDE ZI$USER;
      257     3913         %IA (STCLASS="STATIC");
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:9    
      258     3962    1   DCL 1 IAR$ REDEF IA$,
      259     3963    1         2 * BIT(24) UNAL,
      260     3964    1         2 SEGID BIT(12) UNAL;
      261     3965    1   DCL UWA$ PTR STATIC;
      262     3966    1   DCL RVA$ PTR STATIC;
      263     3967    1   DCL FPT$ PTR STATIC;
      264     3968    1   DCL ARG$ PTR STATIC;
      265     3969    1   DCL USEP$ PTR STATIC;
      266     3970    1   DCL KEY$ PTR STATIC;
      267     3971    1   DCL RLCW$ PTR STATIC;
      268     3972    1   DCL TYPE$ PTR STATIC;
      269     3973
      270     3974        %EQU AREA_NAME=31;
      271     3975        %EQU SET_NAME=32;
      272     3976        %EQU RECORD_NAME=33;
      273     3977        %EQU FIELD_NAME=34;
      274     3978        %EQU ELSE_NAME=1;
      275     3979        %EQU AREA_NAME_NET=0;
      276     3980        %EQU SET_NAME_NET=1;
      277     3981        %EQU RECORD_NAME_NET=2;
      278     3982        %EQU FIELD_NAME_NET=3;
      279     3983        %EQU ON=1;
      280     3984        %EQU OFF=0;
      281     3985        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:10   
      282     3986        /****************************************************************/
      283     3987        /*                                                              */
      284     3988        /*    INCLUDE ZI_DBCS TO INVOKE IDS FPTS AND ENTRY DEFS         */
      285     3989        /*                                                              */
      286     3990        /****************************************************************/
      287     3991        %INCLUDE ZI_DBCS;
      288     4604         %USER;
      289     4615        %IPT_ACC(STCLASS="BASED(FPT$)");
      290     4628        %IPT_ACN(STCLASS="BASED(FPT$)");
      291     4642        %IPT_CALC(STCLASS="BASED(FPT$)");
      292     4654        %IPT_CHK(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      293     4664        %IPT_CON(STCLASS="BASED(FPT$)");
      294     4677        %IPT_CRPT(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      295     4686        %IPT_DIS(STCLASS="BASED(FPT$)");
      296     4699        %IPT_ERS(STCLASS="BASED(FPT$)");
      297     4711        %IPT_ETC(STCLASS="BASED(FPT$)");
      298     4724        %IPT_FAA(STCLASS="BASED(FPT$)");
      299     4741        %IPT_FAS(STCLASS="BASED(FPT$)");
      300     4758        %IPT_FCD(STCLASS="BASED(FPT$)");
      301     4773        %IPT_FCR(STCLASS="BASED(FPT$)");
      302     4787        %IPT_FCT(STCLASS="BASED(FPT$)");
      303     4802        %IPT_FDC(STCLASS="BASED(FPT$)");
      304     4817        %IPT_FDP(STCLASS="BASED(FPT$)");
      305     4833        %IPT_FDR(STCLASS="BASED(FPT$)");
      306     4849        %IPT_FIN(STCLASS="BASED(FPT$)");
      307     4862        %IPT_FKC(STCLASS="BASED(FPT$)");
      308     4879        %IPT_FKY(STCLASS="BASED(FPT$)");
      309     4896        %IPT_FOR(STCLASS="BASED(FPT$)");
      310     4911        %IPT_FRA(STCLASS="BASED(FPT$)");
      311     4928        %IPT_FRI(STCLASS="BASED(FPT$)");
      312     4945        %IPT_FRS(STCLASS="BASED(FPT$)");
      313     4962        %IPT_FUI(STCLASS="BASED(FPT$)");
      314     4978        %IPT_GET(STCLASS="BASED(FPT$)");
      315     4990        %IPT_GTF(STCLASS="BASED(FPT$)");
      316     5003        %IPT_HIA(STCLASS="BASED(FPT$)");
      317     5014        %IPT_IFM(STCLASS="BASED(FPT$)");
      318     5026        %IPT_IFT(STCLASS="BASED(FPT$)");
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:11   
      319     5038        %IPT_INA(STCLASS="BASED(FPT$)");
      320     5052        %IPT_IST(STCLASS="BASED(FPT$)");
      321     5065        %IPT_MOD(STCLASS="BASED(FPT$)");
      322     5081        %IPT_NBF(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      323     5091        %IPT_KEEP(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      324     5100        %IPT_REDUCEQ(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      325     5109        %IPT_RDY(STCLASS="BASED(FPT$)");
      326     5123        %IPT_ROL(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      327     5132        %IPT_STO(STCLASS="BASED(FPT$)");
      328     5147        %IPT_TRON(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      329     5156        %IPT_TROFF(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      330     5165        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:12   
      331     5166        /****************************************************************/
      332     5167        /*                                                              */
      333     5168        /*    INCLUDE CP_6 TO DO M$GDP AND M$ERR                        */
      334     5169        /*                                                              */
      335     5170        /****************************************************************/
      336     5171    1   DCL M$DO DCB;
      337     5172    1   DCL 1 PAGE_VECTOR STATIC DALIGNED,
      338     5173    1         2 * BIT(36),
      339     5174    1         2 ADR PTR INIT(ADDR(NIL));
      340     5175    1   DCL 1 ERR_CODE STATIC,
      341     5176    1         2 * BIT(18) UNAL INIT('321111'O),
      342     5177    1         2 ERR_NO UBIN(15) UNAL,
      343     5178    1         2 * UBIN(3) UNAL INIT(3);
      344     5179
      345     5180        %INCLUDE CP_6;
      346     5261
      347     5262
      348     5263        %FPT_GDP(PAGES=1,RESULTS=PAGE_VECTOR);
      349     5277
      350     5278        %VLP_NAME(FPTN=FILE_NAME,LEN=9,NAME=':ZIERRMSG');
      351     5305        %VLP_ACCT(FPTN=FILE_ACCT,ACCT=':SYS ');
      352     5318        %FPT_ERRMSG(OUTDCB1=M$DO,CODE=ERR_CODE,FILEACCT=FILE_ACCT,
      353     5319         FILENAME=FILE_NAME,INCLCODE=YES);
      354     5346        %FPT_YC;
      355     5363        %B$TCB;
      356     5366        %B$EXCFR;
      357     5384
      358     5385        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:13   
      359     5386        /**     INTERNAL SUBROUTINE TO RETURN A POFFW      **/
      360     5387        /**     WITH ADDITIONAL SEGMENT NUMBER CHECK       **/
      361     5388
      362     5389    1   P_OFF_W: PROC(A,B);
      363     5390    2   DCL 1 A ALIGNED,
      364     5391    2         2 ADR UBIN HALF UNAL,
      365     5392    2         2 * BIT(6) UNAL,
      366     5393    2         2 SEG UBIN(12) UNAL;
      367     5394    2   DCL 1 B ALIGNED,
      368     5395    2         2 ADR UBIN HALF UNAL,
      369     5396    2         2 * BIT(6) UNAL,
      370     5397    2         2 SEG UBIN(12) UNAL;
      371     5398
      372     5399    2       IF A.SEG=B.SEG THEN
      373     5400    2           I=A.ADR-B.ADR;
      374     5401    2       ELSE
      375     5402    2           I=-1;
      376     5403    2   END P_OFF_W;
      377     5404
      378     5405        /**     INTERNAL SUBROUTINE TO RETURN A VECTOR   **/
      379     5406
      380     5407    1   VEC_MAKER: PROC(A,B,C);
      381     5408    2   DCL A UBIN;
      382     5409    2   DCL B SBIN;
      383     5410    2   DCL 1 C ALIGNED,
      384     5411    2         2 V_SIZE UBIN(20) UNAL,
      385     5412    2         2 * UBIN(16) UNAL,
      386     5413    2         2 * UBIN UNAL;
      387     5414    2       C=VECTOR(A);
      388     5415    2       C.V_SIZE=(B+1)*4-1;
      389     5416    2   END VEC_MAKER;
      390     5417        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:14   
      391     5418    1   SDS$OPEN: PROC;
      392     5419
      393     5420        /*****************************************************/
      394     5421        /*                                                   */
      395     5422        /*  Procedure to open the shared data segment (SDS). */
      396     5423        /*                                                   */
      397     5424        /*****************************************************/
      398     5425
      399     5426        %F$DCB(STCLASS="BASED");
      400     5483        %FPT_FDS(FPTN=FPT_FDS,RESULTS=VEC,SEGSIZE=262143);
      401     5498        %FPT_GETDCB(FPTN=FPT_GETDCB,DCBNAME=SDS_NAME,DCBNUM=SDSDCB);
      402     5513        %FPT_RELDCB(FPTN=FPT_RELDCB);
      403     5527        %FPT_OPEN(FPTN=OPEN_SDS,ASN=FILE,EXIST=OLDFILE,FUN=IN,ACS=DS8,
      404     5528         FPARAM=FPBUF);
      405     5637        %VLP_NAME(FPTN=SDS_NAME,NAME=' ',LEN=31);
      406     5664        %VLP_NAME(FPTN=VLP_NAME,NAME=' ',LEN=31);
      407     5691        %VLP_VECTOR(FPTN=VEC,SEGID='6013'O);
      408     5706        /*  DCB name for SDS open is subschema-name||'$'  */
      409     5707    2       SDS_NAME.L# = 31;
      410     5708    2       SDS_NAME.NAME# = IA.SSNAME;
      411     5709    3       DO WHILE(SUBSTR(SDS_NAME.NAME#,SDS_NAME.L#-1,1) = ' ');
      412     5710    3           SDS_NAME.L# = SDS_NAME.L# - 1;
      413     5711    3           END;
      414     5712    2       CALL INSERT(SDS_NAME.NAME#,SDS_NAME.L#,1,'$');
      415     5713    2       SDS_NAME.L# = SDS_NAME.L# + 1;
      416     5714        /*  Get a dcb for the SDS */
      417     5715    2       FPT_GETDCB.V.TEST# = %NO#;
      418     5716    2       FPT_GETDCB.V.MERGE# = %YES#;
      419     5717    2       CALL M$GETDCB(FPT_GETDCB);
      420     5718
      421     5719        /*  If dcb for SDS is open, just return */
      422     5720    2       IF DCBADDR(SDSDCB)->F$DCB.FCD# THEN
      423     5721    2           RETURN;
      424     5722    2       OPEN_SDS.V.DCB# = SDSDCB;
      425     5723
      426     5724        /*  Free unitialized RVA  */
      427     5725    2       CALL M$FDS(FPT_FDS);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:15   
      428     5726
      429     5727    3       IF DCBADDR(SDSDCB)->F$DCB.ASN# ~= %FILE# THEN DO;
      430     5728        /*      Set up the file name for open of SDS file */
      431     5729    3           VLP_NAME.L# = SDS_NAME.L# - 1;
      432     5730    3           VLP_NAME.NAME# = IA.SSNAME;
      433     5731
      434     5732        /*      Now, prepare for and get the dcb for the subschema so we can pull
      435     5733                the subschema file name out of the dcb */
      436     5734    3           FPT_GETDCB.DCBNAME_ = VECTOR(VLP_NAME);
      437     5735    3           FPT_GETDCB.DCBNUM_ = VECTOR(SUBDCB);
      438     5736    3           FPT_GETDCB.V.MERGE# = %YES#;
      439     5737    3           CALL M$GETDCB(FPT_GETDCB);
      440     5738    4           IF DCBADDR(SUBDCB)->F$DCB.ASN# = %FILE# THEN DO;
      441     5739        /*      SET statement for subschema provided.  Get subschema file name
      442     5740                from DCB and frame the ACCOUNT specification in DCB */
      443     5741    4               VLP_NAME = DCBADDR(SUBDCB)->F$DCB.NAME#;
      444     5742    4               OPEN_SDS.ACCT_ = VECTOR(DCBADDR(SUBDCB)->F$DCB.ACCT#);
      445     5743    4               END;
      446     5744    4           ELSE DO;
      447     5745        /*          No SET statement provided.  Use IA.SSNAME for subschema
      448     5746                    file name and provide no ACCOUNT specification.  */
      449     5747    4               OPEN_SDS.ACCT_ = VECTOR(NIL);
      450     5748        /*          Now we have the subschema file name.  The name of the SDS
      451     5749                    will be 'subschema-name$' so put the '$' on the end */
      452     5750    4               CALL INSERT(VLP_NAME.NAME#,VLP_NAME.L#,1,'$');
      453     5751    4               VLP_NAME.L# = VLP_NAME.L# + 1;
      454     5752    4               END;
      455     5753        /*      Frame the name of the SDS for the open   */
      456     5754    3           OPEN_SDS.NAME_ = VECTOR(VLP_NAME);
      457     5755        /*      Free up the DCB used to obtain the subschema SET info  */
      458     5756    3           FPT_RELDCB.V.DCB# = SUBDCB;
      459     5757    3           CALL M$RELDCB(FPT_RELDCB);
      460     5758    3           END;
      461     5759    2       CALL M$OPEN(OPEN_SDS)
      462     5760    3       WHENRETURN DO;
      463     5761        /*  Check to determine whether the RVA data segment predates the
      464     5762            subschema file.  If so, access is denied. */
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:16   
      465     5763    3           J=1;
      466     5764    3           FIT$ = ADDR(FPBUF);
      467     5765    4           DO WHILE(FIT$->FM$FIT.CODES.CODE(J)~=4);
      468     5766    4               J = J + 1;
      469     5767    4               END;
      470     5768    3           FIT$ = PINCRW(FIT$, FIT$->FM$FIT.CODES.ITEMX(J));
      471     5769    4           IF FIT$->CODE04.CREATION.TIME < IA.SSTDT(1) THEN DO;
      472     5770    4               CALL ARG_ERROR(5013);
      473     5771        /*E*   ERROR:   ZII-5013-1
      474     5772              MESSAGE:  RVA data segment file predates subschema file. */
      475     5773    4               CALL M$XXX;
      476     5774    4               END;
      477     5775    3           END;
      478     5776    3       WHENALTRETURN DO;
      479     5777        /*E*   ERROR:   ZII-5014-1
      480     5778              MESSAGE:  Unable to open RVA shared data segment file. */
      481     5779    3           CALL ARG_ERROR(5014);
      482     5780    3           CALL M$MERC;
      483     5781    3           END;
      484     5782    2       RETURN;
      485     5783    2   END SDS$OPEN;
      486     5784         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:17   
      487     5785        /******************************************************************/
      488     5786        /*                                                                */
      489     5787        /*      INTERNAL SUBROUTINE  CHK_ARG                              */
      490     5788        /*                                                                */
      491     5789        /******************************************************************/
      492     5790    1   CHK_ARG: PROC(A) ALTRET;
      493     5791
      494     5792    2   DCL A UBIN;
      495     5793
      496     5794    2       FPTS.V.ARG(NO_ARGS)=ADDR(A);
      497     5795    2       IF ADDR(A)=ADDR(NIL) THEN ALTRETURN;
      498     5796    2       CALL P_OFF_W(ADDR(A),RVA$);
      499     5797    2       IF I>0 AND I<=RVA_SIZE THEN
      500     5798    3       DO;
      501     5799    3           ARG.OFFSET(NO_ARGS)=I;
      502     5800    3           ARG.TYPE(NO_ARGS)=%AREA_NAME+RVA_TYPE(I);
      503     5801    3           END;
      504     5802    2       ELSE
      505     5803    3       DO;
      506     5804    3           CALL P_OFF_W(ADDR(A),ADDR(SNA));
      507     5805    3           IF I>=0 AND I<%SNA_SIZE THEN
      508     5806    3               ARG.TYPE(NO_ARGS)=A;
      509     5807    3           ELSE
      510     5808    4           DO;
      511     5809    4               CALL P_OFF_W(ADDR(A),UWA$);
      512     5810    4               ARG.TYPE(NO_ARGS)=%ELSE_NAME;
      513     5811    4               IF I>=48 AND I<UWA_SIZE THEN
      514     5812    5               DO;
      515     5813    5                   I=POFFC(ADDR(A),UWA$)*2;
      516     5814    5                   LOW=2;
      517     5815    5                   HIGH=RVA_SIZE-1;
      518     5816    5   BINARY_SEARCH: /* BINARY SEARCH THRU RVA */
      519     5817    5                   IF LOW>HIGH THEN CALL ARG_ERROR(2);
      520     5818        /*     ERROR:  ZII-2-1
      521     5819              MESSAGE: RVA and UWA are inconsistent.   */
      522     5820    5                   K=LOW+(HIGH-LOW)/2;
      523     5821    5                   J=RVA(K);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:18   
      524     5822    5                   IF REDEF_J.NAME<I THEN
      525     5823    6                   DO;
      526     5824    6                       LOW=K+1;
      527     5825    6                       GOTO BINARY_SEARCH;
      528     5826    6                       END;
      529     5827    5                   IF REDEF_J.NAME>I THEN
      530     5828    6                   DO;
      531     5829    6                       HIGH=K-1;
      532     5830    6                       GOTO BINARY_SEARCH;
      533     5831    6                       END;
      534     5832    5                   IF RVA_TYPE(K)=%RECORD_NAME_NET THEN
      535     5833    6                   DO;
      536     5834    6                       K=K+1;
      537     5835    6                       IF RVA_TYPE(K)=%RECORD_NAME_NET THEN CALL ARG_ERROR(2);
      538     5836    6                       END;
      539     5837    5                   ARG.OFFSET(NO_ARGS)=K;
      540     5838    5                   ARG.TYPE(NO_ARGS)=%AREA_NAME+RVA_TYPE(K);
      541     5839    5                   END;
      542     5840    4               END;
      543     5841    3           END;
      544     5842    2       NO_ARGS=NO_ARGS+1;
      545     5843    2   END CHK_ARG;
      546     5844         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:19   
      547     5845        /************************************************************/
      548     5846        /*                                                          */
      549     5847        /*    INTERNAL SUBROUTINE TO SETUP ARG'S LIST               */
      550     5848        /*                                                          */
      551     5849        /*    1. DETERMINE THE NUMBER OF PARAMETERS PASSED          */
      552     5850        /*    2. SAVE EACH ARG'S ADDRESS, AND CONVERT INTO RVA ADDR */
      553     5851        /*       IF IT IS A FIELD-NAME                              */
      554     5852        /*                                                          */
      555     5853        /************************************************************/
      556     5854
      557     5855    1   SET_ARGS: PROC;
      558     5856
      559     5857    2       IA_HALF(13)=AUTO_FRAME(-2*(AUTO_FRAME(1)+1));
      560     5858    2   SET_ARGS1: ENTRY; /* FOR USEPROC, CALLED BEFORE INVOKE */
      561     5859    2       IF PAGE_VECTOR.ADR=ADDR(NIL) THEN CALL ARG_ERROR(10);
      562     5860        /*    ERROR: ZII-10-7
      563     5861              MESSAGE: INVOKE CALL is not performed as your 1st IDS statement.  */
      564     5862    2       NO_ARGS=0;
      565     5863            %GEN_PARAMS(TYPE=2); /* CALL CHK_ARG(A1 TO A20); */
      566     6404    2   END_OF_ARGS: ADDR(FPTS.V)->CLEAR_BITS='0'B;
      567     6405
      568     6406    2   END SET_ARGS;
      569     6407         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:20   
      570     6408        /*******************************************************************/
      571     6409        /*                                                                 */
      572     6410        /*    ARG_ERROR: READ ERROR MESSAGE AND ABORT THE JOB              */
      573     6411        /*                                                                 */
      574     6412        /*******************************************************************/
      575     6413
      576     6414    1   ARG_ERROR: PROC(ERR_NO);
      577     6415
      578     6416    2   DCL ERR_NO UBIN;
      579     6417    2   DCL ERRMSG_BUF CHAR(120) AUTO ALIGNED;
      580     6418
      581     6419    2       ERR_CODE.ERR_NO=ERR_NO;
      582     6420    2       FPT_ERRMSG.BUF_=VECTOR(ERRMSG_BUF);
      583     6421    2       CALL M$ERRMSG(FPT_ERRMSG);
      584     6422    2       CALL M$ERR;
      585     6423    2   END ARG_ERROR;
      586     6424         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:21   
      587     6425        /****************************************************************/
      588     6426        /*                                                              */
      589     6427        /*    GET A PAGE OF DYNAMIC MEMORY AT THE VERY 1ST IDS CALL     */
      590     6428        /*                                                              */
      591     6429        /****************************************************************/
      592     6430
      593     6431    1   GET_A_PAGE: PROC;
      594     6432
      595     6433    2       CALL M$GDP(FPT_GDP) ALTRET(OUT_OF_MEMORY);
      596     6434    2       FPT$=PAGE_VECTOR.ADR;
      597     6435    2       ARG$=ADDR(FPTS.V.FPARAM(0));
      598     6436    2       RLCW$=PINCRW(FPT$,%FPT_SIZE);
      599     6437    2       TYPE$=PINCRW(RLCW$,%RLCW_SIZE);
      600     6438    2       FPTS.V_=VECTOR(FPTS.V);
      601     6439    2       FPT_ERRMSG.BUF_=FPTS.V_; /* M$ERRMSG USE THIS AREA TOO */
      602     6440    2       RETURN;
      603     6441
      604     6442        /*    ERROR: ZII-5-1
      605     6443              MESSAGE: Failed to get a dynamic page, core limit exceeded.  */
      606     6444
      607     6445    2   OUT_OF_MEMORY:
      608     6446    2       CALL ARG_ERROR(5);
      609     6447    2   END GET_A_PAGE;
      610     6448         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:22   
      611     6449        /****************************************************************/
      612     6450        /*                                                              */
      613     6451        /*    CALL PRIVACY(RECORD,IDS-NAME1,PRIVACY-KEY,REC-NAME)       */
      614     6452        /*                                                              */
      615     6453        /*      IDS-NAME1: CONNECT,DISCONNECT,STORE,ERASE               */
      616     6454        /*                 MODIFY,FIND,GET                              */
      617     6455        /*                                                              */
      618     6456        /*    CALL PRIVACY(SET,CONNECT,PRIVACY-KEY,SET-NAME1,....)      */
      619     6457        /*                     DISCONNECT                               */
      620     6458        /*                     FIND                                     */
      621     6459        /*                                                              */
      622     6460        /*    CALL PRIVACY(ITEM,MODIFY/GET,PRIVACY-KEY,ITEM-1,...)      */
      623     6461        /*                                                              */
      624     6462        /****************************************************************/
      625     6463
      626     6464    1   PRIVACY: ENTRY(
      627     6465               %GEN_PARAMS;
      628     7006
      629     7007        /*    ERROR: ZII-15-1
      630     7008              MESSAGE: Syntax error detected in PRIVACY CALL. */
      631     7009
      632     7010    1       CALL SET_ARGS;
      633     7011    1       IF A1(0)=SNA.SET THEN
      634     7012    1           K=1;
      635     7013    1       ELSE
      636     7014    1           IF A1(0)=SNA.RECORD THEN
      637     7015    1               K=2;
      638     7016    1           ELSE
      639     7017    1               IF A1(0)=SNA.ITEM THEN
      640     7018    1                   K=3;
      641     7019    1               ELSE
      642     7020    1                   CALL ARG_ERROR(15); /* UNKNOWN FIRST ARGUMENT */
      643     7021
      644     7022    1       JJ=NO_ARGS-1; /* START FROM THE END OF ARG_LIST */
      645     7023    2       DO WHILE(ARG.TYPE(JJ)-%SET_NAME+1=K);
      646     7024    2           JJ=JJ-1;
      647     7025    2           END;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:23   
      648     7026    1       IF (K<3 AND JJ=NO_ARGS-1) THEN
      649     7027    2       DO; /* IN CASE NO REC OR SET SPECIFIED IN THE LIST */
      650     7028    2           ARG.OFFSET(NO_ARGS)=0; /* FOR ALL REC OR SETS */
      651     7029    2           NO_ARGS=NO_ARGS+1; /* MAKE A FAKE ARGUMENT */
      652     7030    2           END;
      653     7031
      654     7032    1       KK=USEP.M;
      655     7033    2       DO I=1 TO JJ-1; /* LOOP THRU IDS ROUTINE ADDR */
      656     7034    2           PT$=FPTS.V.ARG(I);
      657     7035    2           J=0;
      658     7036    3           DO WHILE(J<8 AND IDS_ADR(J)~=REDEF_PT.ADR);
      659     7037    3               J=J+1;
      660     7038    3               END;
      661     7039    2           IF J=8 THEN CALL ARG_ERROR(15); /* UNKNOWN IDS ROUTINE */
      662     7040    3           DO II=JJ+1 TO NO_ARGS-1; /* LOOP THRU REC OR SET OR ITEM LIST */
      663     7041    3               USEP.UC.UCW_PRV.PT(KK)=K;
      664     7042    3               USEP.UC.UCW_PRV.PB(KK)=IDS_BIT9(J);
      665     7043    3               USEP.UC.UCW_PRV.A(KK)=RVA_HALF(2*ARG.OFFSET(II)+1);
      666     7044    3               USEP.UC.ENT$(KK)=FPTS.V.ARG(JJ); /* USER PROCEDURE ADDR */
      667     7045    3               KK=KK+1;
      668     7046    3               END;
      669     7047    2           END;
      670     7048    1       USEP.M=KK;
      671     7049    1       RETURN;
      672     7050         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:24   
      673     7051        /**************************************************************/
      674     7052        /*                                                            */
      675     7053        /*    CALL USE(SUBROUTINE-NAME,ERROR-1,ERROR-2,...)           */
      676     7054        /*                                                            */
      677     7055        /*    1.   GENERATE ENTRY POINTS IN 'USEP' TABLE              */
      678     7056        /*    2.   SAVE SUBROUITNE ADDRESSES IN 'EPTR_SAVE' TABLE     */
      679     7057        /*                                                            */
      680     7058        /**************************************************************/
      681     7059
      682     7060    1   USEPROC: ENTRY(
      683     7061               %GEN_PARAMS;
      684     7602
      685     7603    1       CALL SET_ARGS1;
      686     7604    2       DO I=1 TO NO_ARGS-1;
      687     7605    2           IF ARG.TYPE(I)=SNA.ALL THEN
      688     7606    2               J=0; /* USEPROC FOR ALL OTHERS */
      689     7607    2           ELSE
      690     7608    2               CALL CHARBIN(J,FPTS.V.ARG(I)->CHAR7);
      691     7609    2           USEP.UC.UCW_USE.PT(USEP.M)=6;
      692     7610    2           USEP.UC.UCW_USE.CODE(USEP.M)=J;
      693     7611    2           USEP.UC.ENT$(USEP.M)=FPTS.V.ARG(0);
      694     7612    2           USEP.M=USEP.M+1;
      695     7613    2           END;
      696     7614    1       RETURN;
      697     7615         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:25   
      698     7616        /****************************************************************/
      699     7617        /*                                                              */
      700     7618        /*    CALL RETAIN( AREA                               )         */
      701     7619        /*                 SETS                                         */
      702     7620        /*                 RECORD                                       */
      703     7621        /*                 SET-NAME1,SET-NAME2,.....                    */
      704     7622        /*                                                              */
      705     7623        /*         1.  SAVE RETAINING CONTROL LIST.                     */
      706     7624        /*         2.  SET SWITCH ON, RETAINING LIST WILL BE USED ON    */
      707     7625        /*             NEXT IDS CALL WITH RETAIN CURRENCY OPTION        */
      708     7626        /*                                                              */
      709     7627        /****************************************************************/
      710     7628
      711     7629    1   RETAIN: ENTRY(
      712     7630               %GEN_PARAMS;
      713     8171
      714     8172    1       ADDR(RLCW_SAVE)->SBIN36=0;
      715     8173    1       CALL SET_ARGS;
      716     8174        /*    ERROR: ZII-20-1
      717     8175              MESSAGE: Syntax error in RETAIN CALL.  */
      718     8176    1       K=0;
      719     8177    2       DO WHILE (K<NO_ARGS);
      720     8178    2           IF ARG.TYPE(K)=%SET_NAME THEN
      721     8179    3           DO;
      722     8180    3               RLCW_SAVE.RETAIN_LIST(RLCW_SAVE.N_SETS#)=ARG.OFFSET(K);
      723     8181    3               RLCW_SAVE.N_SETS#=RLCW_SAVE.N_SETS#+1;
      724     8182    3               END;
      725     8183    2           ELSE
      726     8184    2               IF ARG.TYPE(K)=SNA.AREA THEN
      727     8185    2                   RLCW_SAVE.AC_INDICATORS='1'B;
      728     8186    2               ELSE
      729     8187    2                   IF ARG.TYPE(K)=SNA.SETS THEN
      730     8188    2                       RLCW_SAVE.SC_INDICATORS='1'B;
      731     8189    2                   ELSE
      732     8190    2                       IF ARG.TYPE(K)=SNA.RECORD THEN
      733     8191    2                           RLCW_SAVE.RC_INDICATORS='1'B;
      734     8192    2                       ELSE
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:26   
      735     8193    2                           CALL ARG_ERROR(20);
      736     8194    2           K=K+1;
      737     8195    2           END;
      738     8196    1       RETAIN_SWITCH=%ON;
      739     8197    1       RETURN;
      740     8198
      741     8199    1   IDSSET: ENTRY(A1,A2);
      742     8200
      743     8201    1       PT$=ADDR(A1);
      744     8202    1       K=256;
      745     8203    1       CALL INDEX(I,'SET ',CHAR_V);
      746     8204    1       A2(0)=1;
      747     8205    1       IF I=K THEN RETURN; /* NOT A LEGAL SET COMMAND */
      748     8206    1       K=K-I;
      749     8207    1       PT$=PINCRC(PT$,I);
      750     8208    1       I=4;
      751     8209    2       DO J=1 TO 2;
      752     8210    3           DO WHILE(SUBSTR(CHAR_V,I,1)=' ' AND I<K);
      753     8211    3               I=I+1;
      754     8212    3               END;
      755     8213    2           CALL INDEX1(I,' ',CHAR_V,I+1);
      756     8214    2           END;
      757     8215    1       IF SUBSTR(CHAR_V,I-1,1)='.' THEN I=I-1;
      758     8216    1       K=I;
      759     8217    1       FPT_YC.CMD_=VECTOR(CHAR_V);
      760     8218    1       CALL M$YC(FPT_YC) ALTRET(YC_ERROR);
      761     8219    1       A2(0)=0; /* NORMAL FLAG */
      762     8220    1       RETURN;
      763     8221    1   YC_ERROR: A2(0)=ADDR(B$TCB$->B$TCB.ALT$->B$EXCFR.ERR.FCG)->SBIN36;
      764     8222    1       RETURN;
      765     8223         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:27   
      766     8224        /**   INTERNAL SUBROUTINE TO SETUP RETAIN CONTROL LIST   **/
      767     8225
      768     8226    1   CHK_RETAIN: PROC(RLCW,OFFSET);
      769     8227
      770     8228    2   DCL 1 RLCW,
      771     8229    2         2 FLAGS SBIN WORD,
      772     8230    2         2 LISTS (0:0),
      773     8231    2           3 RVA_OFFSET# SBIN HALF UNAL,
      774     8232    2           3 MBZ UBIN HALF UNAL;
      775     8233    2   DCL OFFSET SBIN HALF CALIGNED;
      776     8234
      777     8235    2       IF RETAIN_SWITCH=%OFF THEN
      778     8236    2           RLCW.FLAGS=0;
      779     8237    2       ELSE
      780     8238    3       DO;
      781     8239    3           RETAIN_SWITCH=%OFF;
      782     8240    3           RLCW.FLAGS=ADDR(RLCW_SAVE)->SBIN36;
      783     8241    4           DO II=OFFSET TO RLCW_SAVE.N_SETS#+OFFSET-1;
      784     8242    4               RLCW.LISTS.RVA_OFFSET#(II)=RLCW_SAVE.RETAIN_LIST(II-OFFSET);
      785     8243    4               RLCW.LISTS.MBZ(II)=0;
      786     8244    4               END;
      787     8245    3           END;
      788     8246    2   END CHK_RETAIN;
      789     8247         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:28   
      790     8248        /**************************************************************/
      791     8249        /*                                                            */
      792     8250        /*    CALL READY([AREA-1[,AREA-2[,....]],FUN-OPT,[MODE-OPT])  */
      793     8251        /*                                                            */
      794     8252        /*    FUN-OPT: LOAD, UPDATE, OR RETRIEVAL                     */
      795     8253        /*    MODE-OPT: SHAREALL,SHAREANY,NOSHARE, OR SHAREIN.        */
      796     8254        /*                                                            */
      797     8255        /**************************************************************/
      798     8256
      799     8257    1   READY: ENTRY(
      800     8258               %GEN_PARAMS;
      801     8799
      802     8800    1       CALL SET_ARGS;
      803     8801        /*    ERROR: ZII-25-1
      804     8802              MESSAGE: Syntax error in READY CALL.
      805     8803                       Required option LOAD/UPDATE/RETRIEVAL missing.  */
      806     8804    1       J=2;
      807     8805    1       I=ARG.TYPE(NO_ARGS-1);
      808     8806    1       IF I=SNA.NOSHALL THEN
      809     8807                %CLIMB(FCN=SHNO,PARAMS=0);
      810     8821    1       ELSE
      811     8822    1           IF I=SNA.SHAREALL THEN
      812     8823                    %CLIMB(FCN=SHALL,PARAMS=0);
      813     8837    1           ELSE
      814     8838    1               IF I=SNA.SHAREIN THEN
      815     8839                        %CLIMB(FCN=SHIN,PARAMS=0);
      816     8853    1               ELSE
      817     8854    1                   IF I=SNA.SHAREANY THEN
      818     8855                            %CLIMB(FCN=SHANY,PARAMS=0);
      819     8869    1                   ELSE
      820     8870    1                       IF I=SNA.SHCUR THEN
      821     8871                                %CLIMB(FCN=SHCUR,PARAMS=0);
      822     8885    1                       ELSE
      823     8886    1                           IF I=SNA.SHINCUR THEN
      824     8887                                    %CLIMB(FCN=SHINCUR,PARAMS=0);
      825     8901    1                           ELSE
      826     8902    1                               J=1;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:29   
      827     8903
      828     8904    1       I=ARG.TYPE(NO_ARGS-J);
      829     8905    1       IF I=SNA.UPDATE THEN
      830     8906    1           IPT_RDY.V.RDCW.READY_OPTION#='010'B;
      831     8907    1       ELSE
      832     8908    1           IF I=SNA.RETRIEVAL THEN
      833     8909    1               IPT_RDY.V.RDCW.READY_OPTION#='100'B;
      834     8910    1           ELSE
      835     8911    1               IF I=SNA.LOAD THEN
      836     8912    1                   IPT_RDY.V.RDCW.READY_OPTION#='001'B;
      837     8913    1               ELSE
      838     8914    1                   CALL ARG_ERROR(25);
      839     8915
      840     8916        /*    ERROR: ZII-30-1
      841     8917              MESSAGE: Arguments in CALL READY are not all AREA-NAMEs. */
      842     8918    2       DO I=0 TO NO_ARGS-J-1;
      843     8919    2           IF ARG.TYPE(I)~=%AREA_NAME THEN CALL ARG_ERROR(30);
      844     8920    2           IPT_RDY.V.AC_OFFSETS.RVA_OFFSET#(I)=ARG.OFFSET(I);
      845     8921    2           END;
      846     8922    1       IPT_RDY.V.RDCW.AREAS_TO_READY#=I;
      847     8923    1       VBASE(IPT_RDY.V_) = ADDR(IPT_RDY.V);
      848     8924    1       VBOUND(IPT_RDY.V_) = SIZEC(IPT_RDY.V.RDCW) +
      849     8925    1          SIZEC(IPT_RDY.V.AC_OFFSETS) * I;
      850     8926         /* I computed from previous DO */
      851     8927            %CLIMB(FCN=RDY);
      852     8941    1       DK_RET.AUTO_OFFSET=-1*(AUTO_FRAME(-2*(AUTO_FRAME(1)+1)+1)+1);
      853     8942    2       DO WHILE (IA_HALF(15)>0);
      854     8943    2           REDEF_PT.ADR=IA_HALF(14); /* GET ADDR FROM IA */
      855     8944    2           REDEF_PT.SEG#='006000'O; /* INSTRUCTION SEG # */
      856     8945    2           CALL EPTR$;
      857     8946    2           IPT_ETC.V_ = VECTOR(IPT_ETC.V);
      858     8947                %CLIMB(FCN=ETC);
      859     8961    2           END;
      860     8962    1       RETAIN_SWITCH=%OFF; /* RESET RETAIN CONTROL FLAG */
      861     8963    1       GOTO COMMON_RETURN;
      862     8964         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:30   
      863     8965        /**************************************************************/
      864     8966        /*                                                            */
      865     8967        /*    CALL FINISH([AREA-1,[AREA-2,....,],])                   */
      866     8968        /*                                                            */
      867     8969        /**************************************************************/
      868     8970    1   FINISH: ENTRY(
      869     8971               %GEN_PARAMS;
      870     9512
      871     9513    1       CALL SET_ARGS;
      872     9514        /*    ERROR: ZII-35-1
      873     9515              MESSAGE: Arguments in CALL FINISH are not all AREA-NAMES. */
      874     9516    2       DO I=0 TO NO_ARGS-1;
      875     9517    2           IF ARG.TYPE(I)~=%AREA_NAME THEN CALL ARG_ERROR(35);
      876     9518    2           IPT_FIN.V.AC_OFFSETS.RVA_OFFSET#(I)=ARG.OFFSET(I);
      877     9519    2           END;
      878     9520    1       IPT_FIN.V.ALCW.N_AREAS#=I;
      879     9521    1       VBASE (IPT_FIN.V_) = ADDR(IPT_FIN.V);
      880     9522    1       VBOUND(IPT_FIN.V_) = SIZEC(IPT_FIN.V.ALCW) +
      881     9523    1          SIZEC(IPT_FIN.V.AC_OFFSETS) * I;
      882     9524         /* I computed from previous DO */
      883     9525            %CLIMB(FCN=FIN);
      884     9539    1       DK_RET.AUTO_OFFSET=-1*(AUTO_FRAME(-2*(AUTO_FRAME(1)+1)+1)+1);
      885     9540    1       GOTO COMMON_RETURN;
      886     9541
      887     9542    1   CALC: ENTRY(A1,A2);
      888     9543
      889     9544    1       CALL SET_ARGS1;
      890     9545    1       IF NO_ARGS~=2 OR ARG.TYPE(0)~=%RECORD_NAME THEN CALL ARG_ERROR(37);
      891     9546        /*    ERROR: ZII-37-1
      892     9547              MESSAGE: Argument count error, or the 1st argument is not
      893     9548                       a RECORD-NAME in CALL CALC. */
      894     9549    1       IPT_CALC.V_=VECTOR(IPT_CALC.V);
      895     9550    1       IPT_CALC.DBK_=VECTOR(A2(0));
      896     9551    1       IPT_CALC.V.UWA_OFFSET=RVA_HALF(ARG.OFFSET(0)*2+1)/8;
      897     9552            %CLIMB(FCN=CALC);
      898     9566    1       IPT_CALC.V_=VECTOR(FPTS.V);
      899     9567    1       RETURN;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:31   
      900     9568         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:32   
      901     9569    1   ACCEPT: ENTRY(A1,A2,A3);
      902     9570
      903     9571    1       CALL SET_ARGS;
      904     9572        /*****************************************************************/
      905     9573        /*                                                               */
      906     9574        /*    CALL ACCEPT(IDENT-1,[REC-NAME],AREANAME)                   */
      907     9575        /*                                   SET-NAME                    */
      908     9576        /*                                   IDENT-2                     */
      909     9577        /*         IDENT-1: LOCATION TO RECEIVE THE AREA'S TEXT NAME     */
      910     9578        /*         IDENT-2: LOCATION CONTAINS A DBKEY TO IDENT THE AREA  */
      911     9579        /*                                                               */
      912     9580        /*****************************************************************/
      913     9581    1       IF ARG.TYPE(NO_ARGS-1)=SNA.AREANAME THEN
      914     9582    2       DO;
      915     9583    2           IPT_ACN.DBK_=VECTOR(NIL);
      916     9584    2           IPT_ACN.ANAME_=VECTOR(ADDR(A1)->ANAME_);
      917     9585    3           DO CASE(ARG.TYPE(1)-%AREA_NAME);
      918     9586
      919     9587    3           CASE(%RECORD_NAME_NET);
      920     9588    3               IPT_ACN.V.NCW.CI#=1;
      921     9589    3               IPT_ACN.V.RVA_ITEM.OFFSET#=ARG.OFFSET(1);
      922     9590    3           CASE(%SET_NAME_NET);
      923     9591    3               IPT_ACN.V.NCW.CI#=3;
      924     9592    3               IPT_ACN.V.RVA_ITEM.OFFSET#=ARG.OFFSET(1);
      925     9593    3           CASE(ELSE);
      926     9594    3               IPT_ACN.V.RVA_ITEM.OFFSET#=NULL_OFFSET;
      927     9595    3               IF NO_ARGS=3 THEN IPT_ACN.V.NCW.CI#=2;
      928     9596    3               ELSE IPT_ACN.V.NCW.CI#=0;
      929     9597    3               IPT_ACN.DBK_=VECTOR(A2(0));
      930     9598    3               END;
      931     9599    2           IPT_ACN.V.NCW.AREA_NME_SIZE#=30;
      932     9600    2           IPT_ACN.V_=VECTOR(IPT_ACN.V);
      933     9601                %CLIMB(FCN=ACN);
      934     9615    2           END;
      935     9616    1       ELSE
      936     9617        /****************************************************************/
      937     9618        /*                                                              */
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:33   
      938     9619        /*    CALL ACCEPT(IDENTIFIER,[REC-NAME],CURRENCY)               */
      939     9620        /*                            SET-NAME  NEXT                    */
      940     9621        /*                            AREA-NAME PRIOR                   */
      941     9622        /*                                      OWNER                   */
      942     9623        /*                                                              */
      943     9624        /****************************************************************/
      944     9625    2       DO;
      945     9626    2           IPT_ACC.DBK_=VECTOR(A1(0));
      946     9627    3           DO CASE(NO_ARGS);
      947     9628
      948     9629    3           CASE(2);
      949     9630    3               IF ARG.TYPE(1)~=SNA.CURRENCY THEN CALL ARG_ERROR(40);
      950     9631        /*   ERROR: ZII-40-1
      951     9632              MESSAGE: Bad 2nd argument in ACCEPT CALL.
      952     9633                       The correct syntax is
      953     9634                       CALL ACCEPT(RETURNED-IDENTIFIER,CURRENCY)  */
      954     9635    3               IPT_ACC.V.RVA_ITEM.OFFSET#=NULL_OFFSET;
      955     9636    3               IPT_ACC.V.CCW.SCI#=0;
      956     9637    3           CASE(3);
      957     9638    3               IPT_ACC.V.RVA_ITEM.OFFSET#=ARG.OFFSET(1);
      958     9639    4               DO CASE(ARG.TYPE(1)-%AREA_NAME);
      959     9640
      960     9641    4               CASE(%RECORD_NAME_NET);
      961     9642    4                   IF ARG.TYPE(2)=SNA.CURRENCY THEN
      962     9643    4                       IPT_ACC.V.CCW.SCI#=1;
      963     9644    4                   ELSE
      964     9645    4                       CALL ARG_ERROR(41);
      965     9646    4               CASE(%AREA_NAME_NET);
      966     9647    4                   IF ARG.TYPE(2)=SNA.CURRENCY THEN
      967     9648    4                       IPT_ACC.V.CCW.SCI#=2;
      968     9649    4                   ELSE
      969     9650    4                       CALL ARG_ERROR(41);
      970     9651    4               CASE(%SET_NAME_NET);
      971     9652    4                   IF ARG.TYPE(2)=SNA.CURRENCY THEN
      972     9653    4                       IPT_ACC.V.CCW.SCI#=3;
      973     9654    4                   ELSE
      974     9655    4                       IF ARG.TYPE(2)=SNA.NEXT THEN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:34   
      975     9656    4                           IPT_ACC.V.CCW.SCI#=4;
      976     9657    4                       ELSE
      977     9658    4                           IF ARG.TYPE(2)=SNA.PRIOR THEN
      978     9659    4                               IPT_ACC.V.CCW.SCI#=5;
      979     9660    4                           ELSE
      980     9661    4                               IF ARG.TYPE(2)=SNA.OWNER THEN
      981     9662    4                                   IPT_ACC.V.CCW.SCI#=6;
      982     9663    4                               ELSE
      983     9664    4                                   CALL ARG_ERROR(43);
      984     9665    4               CASE(ELSE);
      985     9666    4                   CALL ARG_ERROR(44);
      986     9667    4                   END;
      987     9668    3           CASE(ELSE);
      988     9669    3               CALL ARG_ERROR(45);
      989     9670    3               END;
      990     9671
      991     9672        /*    ERROR: ZII-41-1
      992     9673              MESSAGE: Bad 3rd argument in ACCEPT CALL.
      993     9674                       The correct syntax is
      994     9675                       CALL ACCEPT(RETURN-VARIABLE,RECORD-NAME/AREA-NAME,CURRENCY) */
      995     9676        /*    ERROR: ZII-43-1
      996     9677              MESSAGE: Required keyword CURRENCY/NEXT/PRIOR/OWNER missing
      997     9678                       in ACCEPT CALL with 2nd argument a SET-NAME.  */
      998     9679        /*    ERROR: ZII-44-1
      999     9680              MESSAGE: Bad 2nd argument in ACCEPT CALL.
     1000     9681                       Must be a RECORD-NAME/SET-NAME/AREA-NAME.  */
     1001     9682        /*    ERROR: ZII-45-1
     1002     9683              MESSAGE: Number of arguments passed to ACCEPT CALL is less than  2.  */
     1003     9684
     1004     9685    2           IPT_ACC.V_=VECTOR(IPT_ACC.V);
     1005     9686                %CLIMB(FCN=ACC);
     1006     9700    2           END;
     1007     9701    1       FPTS.V_=VECTOR(FPTS.V);
     1008     9702    1       GOTO COMMON_RETURN;
     1009     9703         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:35   
     1010     9704    1   STORE: ENTRY(A1);
     1011     9705
     1012     9706        /*    ERROR: ZII-50-1
     1013     9707              MESSAGE: The argument in STORE CALL is not a RECORD-NAME. */
     1014     9708    1       CALL SET_ARGS;
     1015     9709    1       IF NO_ARGS~=1 OR ARG.TYPE(0)~=%RECORD_NAME THEN CALL ARG_ERROR(50);
     1016     9710    1       IPT_STO.V.RC.RC_OFFSET#=ARG.OFFSET(0);
     1017     9711    1       IPT_STO.V_ = VECTOR(IPT_STO.V);
     1018     9712    1       CALL CHK_RETAIN(IPT_STO.V.RLCW,0);
     1019     9713            %CLIMB(FCN=STO);
     1020     9727    1       GOTO COMMON_RETURN;
     1021     9728
     1022     9729    1   CHECK: ENTRY(A1,A2);
     1023     9730
     1024     9731    1       CALL SET_ARGS;
     1025     9732    1       IF NO_ARGS=0 OR NO_ARGS>2 THEN
     1026     9733    1           CALL ARG_ERROR(53);
     1027     9734    1       IPT_CHK.CHKPT_NUMBER_=VECTOR(A1(0));
     1028     9735        /*    ERROR: ZII-53-1
     1029     9736              MESSAGE: Argument count error in CHECK CALL.
     1030     9737                       The correct format is
     1031     9738                       CALL CHECK(checkpoint-number [,returned-status]) */
     1032     9739    1       IF ADDR(A2)=ADDR(NIL) THEN
     1033     9740    1           IPT_CHK.ERROR_=VECTOR(PINCRW(UWA$,1)->CHAR7);
     1034     9741    1       ELSE
     1035     9742    1           IPT_CHK.ERROR_=VECTOR(ADDR(A2)->CHAR7);
     1036     9743    1       IPT_CHK.IA_=FPTS.IA_;
     1037     9744            %CLIMB(FCN=CHK);
     1038     9758    1       DK_RET.AUTO_OFFSET=-1*(AUTO_FRAME(-2*(AUTO_FRAME(1)+1)+1)+1);
     1039     9759    1       GOTO COMMON_RETURN;
     1040     9760         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:36   
     1041     9761    1   ERASER: ENTRY(A1,A2);
     1042     9762
     1043     9763        /*    ERROR: ZII-55-1
     1044     9764              MESSAGE: Bad arguments found in ERASE CALL.
     1045     9765                       The correct syntax is CALL ERASE([RECORD-NAME][,ALL]). */
     1046     9766    1       CALL SET_ARGS;
     1047     9767    1       IPT_ERS.V.RC.RC_OFFSET#=NULL_OFFSET;
     1048     9768    1       IF NO_ARGS>0 THEN
     1049     9769    2       DO;
     1050     9770    2           IF ARG.TYPE(0)=%RECORD_NAME THEN
     1051     9771    2               IPT_ERS.V.RC.RC_OFFSET#=ARG.OFFSET(0);
     1052     9772    2           ELSE IF ARG.TYPE(0)=SNA.ALL THEN
     1053     9773    2                   IPT_ERS.V.ECW.EC_BIT#='1'B;
     1054     9774    2               ELSE CALL ARG_ERROR(55);
     1055     9775    2           IF ADDR(A2)=ADDR(SNA.ALL) THEN IPT_ERS.V.ECW.EC_BIT#='1'B;
     1056     9776    2           END;
     1057     9777    1       IPT_ERS.V_ = VECTOR(IPT_ERS.V);
     1058     9778    1       IPT_FCR.V_ = VECTOR(IPT_FCR.V);
     1059     9779            %CLIMB(FCN=ERS);
     1060     9793    1       GOTO COMMON_RETURN;
     1061     9794         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:37   
     1062     9795        /**   COMMON CALLING SEQUENCES FOR 'CALL FIND(DBKEY)'   **/
     1063     9796
     1064     9797    1   FINDBKEY: PROC;
     1065     9798
     1066     9799    2       CALL CHK_RETAIN(IPT_FDR.V.RLCW,0);
     1067     9800    3       IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;
     1068     9801    3           VBASE(IPT_FDR.V_) = ADDR(IPT_FDR.V);
     1069     9802    3           VBOUND(IPT_FDR.V_) = SIZEC(IPT_FDR.V.RC) +
     1070     9803    3              SIZEC(IPT_FDR.V.RLCW) +
     1071     9804    3              SIZEC(IPT_FDR.V.RETENTION_LIST) *
     1072     9805    3              (RLCW_SAVE.N_SETS#);
     1073     9806         /* no parms from retention list */
     1074     9807    3           END;
     1075     9808    3       ELSE DO;
     1076     9809    3           IPT_FDR.V_ = VECTOR(IPT_FDR.V);
     1077     9810    3           END;
     1078     9811            %CLIMB(FCN=FDR);
     1079     9825    2       FPTS.V_=VECTOR(FPTS.V);
     1080     9826    2   END;
     1081     9827
     1082     9828    1   FIND: ENTRY(
     1083     9829               %GEN_PARAMS;
     1084    10370
     1085    10371    1       CALL SET_ARGS;
     1086    10372    1       IF NO_ARGS=1 AND ARG.TYPE(0)=SNA.CURRENT THEN
     1087    10373    2       DO;
     1088    10374    2           CALL CHK_RETAIN(IPT_FCR.V.RLCW,0); /* CALL FIND(CURRENT) */
     1089    10375                %CLIMB(FCN=FCR); /* FIND CURRENT OF RUN */
     1090    10389    2           GOTO COMMON_RETURN;
     1091    10390    2           END;
     1092    10391        /*    ERROR: ZII-60-1
     1093    10392              MESSAGE: Syntax error in FIND CALL.
     1094    10393                       Argument count is less than 2.  */
     1095    10394    1       IF NO_ARGS<2 THEN CALL ARG_ERROR(60);
     1096    10395    1       IF ARG.TYPE(NO_ARGS-2)=SNA.USING THEN
     1097    10396    2       DO;
     1098    10397        /**************************************************************/
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:38   
     1099    10398        /*                                                            */
     1100    10399        /*     TYPE OF FIND: USING KEY (KEY IN INDEX)                 */
     1101    10400        /*                                                            */
     1102    10401        /*                FIRST[,REC-NAME]                            */
     1103    10402        /*     CALL FIND(<NEXT [,REC-NAME]>,USING,KEY-NAME)           */
     1104    10403        /*                  REC-NAME                                  */
     1105    10404        /*                                                            */
     1106    10405        /**************************************************************/
     1107    10406
     1108    10407    2           IF ARG.TYPE(0)=%RECORD_NAME THEN
     1109    10408    3           DO;
     1110    10409    3               IF ARG.TYPE(2)~=%SET_NAME THEN CALL ARG_ERROR(65);
     1111    10410        /*    ERROR: ZII-65-1
     1112    10411              MESSAGE: Bad 3rd argument in FIND CALL.
     1113    10412                       The correct syntax is CALL FIND(RECORD-NAME,USING,KEY-NAME) */
     1114    10413    3               IPT_FUI.V.RC.RC_OFFSET#=ARG.OFFSET(0);
     1115    10414    3               IPT_FUI.V.SC.SC_OFFSET#=ARG.OFFSET(2);
     1116    10415    4               IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;
     1117    10416    4                   VBASE(IPT_FUI.V_) = ADDR(IPT_FUI.V);
     1118    10417    4                   VBOUND(IPT_FUI.V_) = SIZEC(IPT_FUI.V.RC) +
     1119    10418    4                      SIZEC(IPT_FUI.V.SC) +
     1120    10419    4                      SIZEC(IPT_FUI.V.RLCW) +
     1121    10420    4                      SIZEC(IPT_FUI.V.RETENTION_LIST) *
     1122    10421    4                      (RLCW_SAVE.N_SETS#);
     1123    10422         /* no parms from retention list */
     1124    10423    4                   END;
     1125    10424    4               ELSE DO;
     1126    10425    4                   IPT_FUI.V_ = VECTOR(IPT_FUI.V);
     1127    10426    4                   END;
     1128    10427    3               CALL CHK_RETAIN(IPT_FUI.V.RLCW,0);
     1129    10428                    %CLIMB(FCN=FUI);
     1130    10442    3               END;
     1131    10443    2           ELSE
     1132    10444    3           DO;
     1133    10445    3               IF ARG.TYPE(0)=SNA.FIRST THEN
     1134    10446    3                   IPT_FRI.V.FCW.RECORD_LOCATION#=0;
     1135    10447    3               ELSE
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:39   
     1136    10448    3                   IF ARG.TYPE(0)=SNA.NEXT THEN
     1137    10449    3                       IPT_FRI.V.FCW.RECORD_LOCATION#=1;
     1138    10450    3                   ELSE
     1139    10451    3                       CALL ARG_ERROR(70);
     1140    10452        /*    ERROR: ZII-70-1
     1141    10453              MESSAGE: Required keyword FIRST/NEXT missing in
     1142    10454                       CALL FIND(NEXT/FIRST,[RECORD-NAME],USING,KEY-NAME) */
     1143    10455    3               IF ARG.TYPE(2)=SNA.USING THEN
     1144    10456    4               DO;
     1145    10457    4                   IF ARG.TYPE(1)~=%RECORD_NAME OR ARG.TYPE(3)~=%SET_NAME THEN
     1146    10458    4                       CALL ARG_ERROR(75);
     1147    10459        /*    ERROR: ZII-75-1
     1148    10460              MESSAGE: The 2nd argument in FIND CALL is not a RECORD-NAME,
     1149    10461                       or the 4th argument is not a SET-NAME.
     1150    10462                       The correct syntax is
     1151    10463                       CALL FIND(NEXT/FIRST,RECORD-NAME,USING,KEY-NAME) */
     1152    10464    4                   IPT_FRI.V.RC.RC_OFFSET#=ARG.OFFSET(1);
     1153    10465    4                   IPT_FRI.V.SC.SC_OFFSET#=ARG.OFFSET(3);
     1154    10466    4                   END;
     1155    10467    3               ELSE IF NO_ARGS=3 AND ARG.TYPE(2)=%SET_NAME THEN
     1156    10468    4                   DO;
     1157    10469    4                       IPT_FRI.V.RC.RC_OFFSET#=NULL_OFFSET;
     1158    10470    4                       IPT_FRI.V.SC.SC_OFFSET#=ARG.OFFSET(2);
     1159    10471    4                       END;
     1160    10472    3                   ELSE
     1161    10473    3                       CALL ARG_ERROR(80);
     1162    10474        /*    ERROR: ZII-80-1
     1163    10475              MESSAGE: 3rd argument in FIND CALL is not a KEY-NAME.
     1164    10476                       The correct syntax is
     1165    10477                       CALL FIND(FIRST/NEXT,USING,KEY-NAME)  */
     1166    10478    3               CALL CHK_RETAIN(IPT_FRI.V.RLCW,0);
     1167    10479    4               IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;
     1168    10480    4                   VBASE(IPT_FRI.V_) = ADDR(IPT_FRI.V);
     1169    10481    4                   VBOUND(IPT_FRI.V_) = SIZEC(IPT_FRI.V.FCW) +
     1170    10482    4                      SIZEC(IPT_FRI.V.RC) +
     1171    10483    4                      SIZEC(IPT_FRI.V.SC) +
     1172    10484    4                      SIZEC(IPT_FRI.V.RLCW) +
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:40   
     1173    10485    4                      SIZEC(IPT_FRI.V.RETENTION_LIST) *
     1174    10486    4                      (RLCW_SAVE.N_SETS#);
     1175    10487    4                   END;
     1176    10488         /* no parms from retention list */
     1177    10489    4               ELSE DO;
     1178    10490    4                   IPT_FRI.V_ = VECTOR(IPT_FRI.V);
     1179    10491    4                   END;
     1180    10492                    %CLIMB(FCN=FRI);
     1181    10506    3               END;
     1182    10507    2           END;
     1183    10508         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:41   
     1184    10509    1       ELSE
     1185    10510    2       DO;
     1186    10511    3           DO CASE(ARG.TYPE(0));
     1187    10512    3           CASE(%RECORD_NAME);
     1188    10513    3               IF ARG.TYPE(1)=SNA.DBKEY THEN
     1189    10514    4               DO;
     1190    10515
     1191    10516        /****************************************************************/
     1192    10517        /*                                                              */
     1193    10518        /*            TYPE OF FIND: DIRECT BY GIVING DBKEY              */
     1194    10519        /*                                                              */
     1195    10520        /*            CALL FIND(REC-NAME,DBKEY,IDENTIFIER)              */
     1196    10521        /*                                                              */
     1197    10522        /****************************************************************/
     1198    10523
     1199    10524    4                   IPT_FDR.V.RC.RC_OFFSET#=ARG.OFFSET(0);
     1200    10525    4                   IPT_FDR.DBK_=VECTOR(A3);
     1201    10526    4                   CALL FINDBKEY;
     1202    10527    4                   END;
     1203    10528    3               ELSE IF ARG.TYPE(1)=SNA.WITHIN THEN
     1204    10529    4                   DO;
     1205    10530
     1206    10531        /***************************************************************/
     1207    10532        /*                                                             */
     1208    10533        /*            TYPE OF FIND: WITH KEY WITHIN CURRENT SET        */
     1209    10534        /*                                                             */
     1210    10535        /*            CALL FIND(REC-NAME,WITHIN,SET-NAME,[CURRENT]     */
     1211    10536        /*                      [,IDENT-5],[IDENT-6],....])            */
     1212    10537        /*                                                             */
     1213    10538        /***************************************************************/
     1214    10539
     1215    10540    4                       IF ARG.TYPE(2)~=%SET_NAME THEN CALL ARG_ERROR(85);
     1216    10541        /*    ERROR: ZII-85-1
     1217    10542              MESSAGE: 3rd argument in FIND CALL is not a SET-NAME.
     1218    10543                       The correct syntax is
     1219    10544                       CALL FIND(RECORD-NAME,WITHIN,SET-NAME,[CURRENT],...) */
     1220    10545    4                       IPT_FKC.V.RC.RC_OFFSET#=ARG.OFFSET(0);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:42   
     1221    10546    4                       IPT_FKC.V.SC.SC_OFFSET#=ARG.OFFSET(2);
     1222    10547    4                       IF NO_ARGS>3 AND ARG.TYPE(3)=SNA.CURRENT THEN
     1223    10548    4                           I=4; ELSE I=3;
     1224    10549    5                       DO J=I TO NO_ARGS-1;
     1225    10550        /*    ERROR: ZII-90-1
     1226    10551              MESSAGE: The variable length argument list in FIND CALL
     1227    10552                       does not contain all FIELD-NAMES. The correct syntax is
     1228    10553                       CALL FIND(REC-NAME,WITHIN,SET-NAME,FIELD-NAME,....).  */
     1229    10554    5                           IF ARG.TYPE(J)~=%FIELD_NAME THEN CALL ARG_ERROR(90);
     1230    10555    5                           IPT_FKC.V.FL_RL_LIST.RVA_OFFSET#(J-I)=ARG.OFFSET(J);
     1231    10556    5                           END;
     1232    10557    4                       IPT_FKC.V.FLCW.N_FIELDS#=NO_ARGS-I;
     1233    10558    4                       CALL CHK_RETAIN(IPT_FKC.V.RLCW,IPT_FKC.V.FLCW.N_FIELDS#);
     1234    10559    5                       DO CASE(I);
     1235    10560    5                       CASE(3);
     1236    10561    5                           IPT_FKY.V_ = VECTOR(IPT_FKY.V);
     1237    10562                                %CLIMB(FCN=FKY);
     1238    10576    5                       CASE(ELSE);
     1239    10577    6                           IF RLCW_SAVE.N_SETS# + IPT_FKC.V.FLCW.N_FIELDS# ~= 0 THEN DO
             10577                                    ;
     1240    10578    6                               VBASE(IPT_FKC.V_) = ADDR(IPT_FKC.V);
     1241    10579    6                               VBOUND(IPT_FKC.V_) = SIZEC(IPT_FKC.V.RC) +
     1242    10580    6                                  SIZEC(IPT_FKC.V.SC) +
     1243    10581    6                                  SIZEC(IPT_FKC.V.FLCW) +
     1244    10582    6                                  SIZEC(IPT_FKC.V.RLCW) +
     1245    10583    6                                  SIZEC(IPT_FKC.V.FL_RL_LIST) *
     1246    10584    6                                  (RLCW_SAVE.N_SETS# + IPT_FKC.V.FLCW.N_FIELDS# - 1);
     1247    10585    6                               END;
     1248    10586    6                           ELSE DO;
     1249    10587    6                               IPT_FKC.V_ = VECTOR(IPT_FKC.V);
     1250    10588    6                               END;
     1251    10589                                %CLIMB(FCN=FKC);
     1252    10603    5                           END;
     1253    10604    4                       END;
     1254    10605    3                   ELSE CALL ARG_ERROR(95);
     1255    10606        /*    ERROR: ZII-95-1
     1256    10607              MESSAGE: Unknown type of FIND.
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:43   
     1257    10608                       Required keyword DBKEY/WITHIN missing after
     1258    10609                       the 1st argument of a RECORD-NAME.  */
     1259    10610         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:44   
     1260    10611    3           CASE(%DBKEY);
     1261    10612
     1262    10613        /****************************************************************/
     1263    10614        /*                                                              */
     1264    10615        /*            TYPE OF FIND: DIRECT BY GIVING DBKEY              */
     1265    10616        /*                                                              */
     1266    10617        /*            CALL FIND(DBKEY,IDENTIFIER)                       */
     1267    10618        /*                                                              */
     1268    10619        /****************************************************************/
     1269    10620
     1270    10621    3               IPT_FDR.V.RC.RC_OFFSET#=NULL_OFFSET;
     1271    10622    3               IPT_FDR.DBK_=VECTOR(A2);
     1272    10623    3               CALL FINDBKEY;
     1273    10624    3           CASE(%ANY,%DUPLICATE);
     1274    10625        /**************************************************************/
     1275    10626        /*                                                            */
     1276    10627        /*       TYPE OF FIND: WITH CALC KEY                          */
     1277    10628        /*                                                            */
     1278    10629        /*       CALL FIND(ANY/DUPANY,REC-NAME)                       */
     1279    10630        /*                                                            */
     1280    10631        /**************************************************************/
     1281    10632
     1282    10633    3               IF ARG.TYPE(1)=%RECORD_NAME THEN
     1283    10634    4               DO;
     1284    10635    4                   IF NO_ARGS>2 THEN CALL ARG_ERROR(100);
     1285    10636        /*    ERROR: ZII-100-1
     1286    10637              MESSAGE: Argument count error in FIND CALL.
     1287    10638                       The correct syntax is
     1288    10639                       CALL FIND(ANY/DUPLICATE,RECORD-NAME). */
     1289    10640    4                   IPT_FDC.V.RC.RC_OFFSET#=ARG.OFFSET(1);
     1290    10641    4                   CALL CHK_RETAIN(IPT_FDC.V.RLCW,0);
     1291    10642    5                   IF A1(0)=SNA.ANY THEN DO;
     1292    10643    6                       IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;
     1293    10644    6                           VBASE(IPT_FDC.V_) = ADDR(IPT_FDC.V);
     1294    10645    6                           VBOUND(IPT_FDC.V_) = SIZEC(IPT_FDC.V.RC) +
     1295    10646    6                              SIZEC(IPT_FDC.V.RLCW) +
     1296    10647    6                              SIZEC(IPT_FDC.V.RETENTION_LIST) *
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:45   
     1297    10648    6                              (RLCW_SAVE.N_SETS#);
     1298    10649    6                           END;
     1299    10650    6                       ELSE DO;
     1300    10651    6                           IPT_FDC.V_ = VECTOR(IPT_FDC.V);
     1301    10652    6                           END;
     1302    10653                            %CLIMB(FCN=FDC);
     1303    10667    5                       END;
     1304    10668    5                   ELSE DO;
     1305    10669    5                       IPT_FCD.V_ = VECTOR(IPT_FCD.V);
     1306    10670                            %CLIMB(FCN=FCD);
     1307    10684    5                       END;
     1308    10685    4                   END;
     1309    10686    3               ELSE
     1310    10687    4               DO;
     1311    10688         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:46   
     1312    10689        /*************************************************************/
     1313    10690        /*                                                           */
     1314    10691        /*       TYPE OF FIND: DUPLICATE RECORD WITHIN A SET         */
     1315    10692        /*                                                           */
     1316    10693        /*       CALL FIND(DUPSET,SET-NAME,IDENT-2,[IDENT-3],...])   */
     1317    10694        /*                                                           */
     1318    10695        /*************************************************************/
     1319    10696
     1320    10697    4                   IF ARG.TYPE(1)~=%SET_NAME OR NO_ARGS<3 THEN CALL ARG_ERROR(105);
     1321    10698        /*    ERROR: ZII-105-1
     1322    10699              MESSAGE: Argument count error, or the 2nd argument in
     1323    10700                     CALL FIND(DUPLICATE,SET-NAME,FIELD-NAME1,....)
     1324    10701                     is not a SET-NAME.  */
     1325    10702    4                   IPT_FDP.V.SC.SC_OFFSET#=ARG.OFFSET(1);
     1326    10703    4                   IPT_FDP.V.FLCW.N_FIELDS#=NO_ARGS-2;
     1327    10704    5                   DO I=0 TO NO_ARGS-3;
     1328    10705    5                       IF ARG.TYPE(I+2)~=%FIELD_NAME THEN CALL ARG_ERROR(110);
     1329    10706        /*    ERROR: ZII-110-1
     1330    10707            MESSAGE: The variable length list in FIND CALL does not contain all FIELD-NAMES.
     1331    10708                       The correct syntax is
     1332    10709                       CALL FIND(DUPSET,SET-NAME,FIELD-NAME1,....)  */
     1333    10710    5                       IPT_FDP.V.FL_RL_LIST.RVA_OFFSET#(I)=ARG.OFFSET(I+2);
     1334    10711    5                       END;
     1335    10712    4                   CALL CHK_RETAIN(IPT_FDP.V.RLCW,IPT_FDP.V.FLCW.N_FIELDS#);
     1336    10713    5                   IF RLCW_SAVE.N_SETS# + IPT_FDP.V.FLCW.N_FIELDS# ~= 0 THEN DO;
     1337    10714    5                       VBASE(IPT_FDP.V_) = ADDR(IPT_FDP.V);
     1338    10715    5                       VBOUND(IPT_FDP.V_) = SIZEC(IPT_FDP.V.SC) +
     1339    10716    5                          SIZEC(IPT_FDP.V.FLCW) +
     1340    10717    5                          SIZEC(IPT_FDP.V.RLCW) +
     1341    10718    5                          SIZEC(IPT_FDP.V.FL_RL_LIST) *
     1342    10719    5                          (RLCW_SAVE.N_SETS# + IPT_FDP.V.FLCW.N_FIELDS# - 1);
     1343    10720    5                       END;
     1344    10721    5                   ELSE DO;
     1345    10722    5                       IPT_FDP.V_ = VECTOR(IPT_FDP.V);
     1346    10723    5                       END;
     1347    10724                        %CLIMB(FCN=FDP);
     1348    10738    4                   END;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:47   
     1349    10739         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:48   
     1350    10740    3           CASE(%NEXT,%PRIOR,%CURRENT);
     1351    10741    3               IF NO_ARGS=2 AND ARG.TYPE(1)=%RECORD_NAME AND A1(0)=SNA.CURRENT THEN
     1352    10742
     1353    10743        /******************************************************************/
     1354    10744        /*                                                                */
     1355    10745        /*       TYPE OF FIND: CURRENT OF RECORD                          */
     1356    10746        /*                                                                */
     1357    10747        /*       CALL FIND(CURRENT,REC-NAME)                              */
     1358    10748        /*                                                                */
     1359    10749        /******************************************************************/
     1360    10750    4               DO;
     1361    10751    4                   IPT_FCT.V.RC.RC_OFFSET#=ARG.OFFSET(1);
     1362    10752    4                   CALL CHK_RETAIN(IPT_FCT.V.RLCW,0);
     1363    10753    5                   IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;
     1364    10754    5                       VBASE(IPT_FCT.V_) = ADDR(IPT_FCT.V);
     1365    10755    5                       VBOUND(IPT_FCT.V_) = SIZEC(IPT_FCT.V.RC) +
     1366    10756    5                          SIZEC(IPT_FCT.V.RLCW) +
     1367    10757    5                          SIZEC(IPT_FCT.V.RETENTION_LIST) *
     1368    10758    5                          (RLCW_SAVE.N_SETS#);
     1369    10759    5                       END;
     1370    10760    5                   ELSE DO;
     1371    10761    5                       IPT_FCT.V_ = VECTOR(IPT_FCT.V);
     1372    10762    5                       END;
     1373    10763                        %CLIMB(FCN=FCT);
     1374    10777    4                   END;
     1375    10778    3               ELSE
     1376    10779         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:49   
     1377    10780        /****************************************************************/
     1378    10781        /*                                                              */
     1379    10782        /*       TYPE OF FIND: RELATIVE TO A SET OR A AREA              */
     1380    10783        /*                                                              */
     1381    10784        /*                 PRIOR                                        */
     1382    10785        /*       CALL FIND(CURRENT,[REC-NAME],SET-NAME)                 */
     1383    10786        /*                 NEXT               AREA-NAME                 */
     1384    10787        /*                                                              */
     1385    10788        /****************************************************************/
     1386    10789    4               DO;
     1387    10790    4                   IF ARG.TYPE(0)=SNA.PRIOR THEN
     1388    10791    4                       IPT_FRS.V.FCW.RECORD_LOCATION#=0;
     1389    10792    4                   ELSE
     1390    10793    4                       IF ARG.TYPE(0)=SNA.CURRENT THEN
     1391    10794    4                           IPT_FRS.V.FCW.RECORD_LOCATION#=1;
     1392    10795    4                       ELSE
     1393    10796    4                           IPT_FRS.V.FCW.RECORD_LOCATION#=2;
     1394    10797    5                   DO CASE(NO_ARGS);
     1395    10798
     1396    10799    5                   CASE(3);
     1397    10800    5                       IF ARG.TYPE(1)~=%RECORD_NAME THEN CALL ARG_ERROR(115);
     1398    10801        /*    ERROR: ZII-115-1
     1399    10802              MESSAGE: Argument count error, or 2nd argument in
     1400    10803                       CALL FIND(PRIOR/CURRENT/NEXT,RECORD-NAME,SET-NAME/AREA-NAME)
     1401    10804                       is not a RECORD-NAME.  */
     1402    10805    5                       IPT_FRS.V.RC.RC_OFFSET#=ARG.OFFSET(1);
     1403    10806    5                       IPT_FRS.V.SC.SC_OFFSET#=ARG.OFFSET(2);
     1404    10807    5                   CASE(2);
     1405    10808    5                       IPT_FRS.V.RC.RC_OFFSET#=NULL_OFFSET;
     1406    10809    5                       IPT_FRS.V.SC.SC_OFFSET#=ARG.OFFSET(1);
     1407    10810    5                   CASE(ELSE);
     1408    10811    5                       CALL ARG_ERROR(115);
     1409    10812    5                       END;
     1410    10813    4                   CALL CHK_RETAIN(IPT_FRS.V.RLCW,0);
     1411    10814    5                   DO CASE(ARG.TYPE(NO_ARGS-1)-%AREA_NAME);
     1412    10815
     1413    10816    5                   CASE(%AREA_NAME_NET);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:50   
     1414    10817    5                       IPT_FRA.V_ = VECTOR(IPT_FRA.V);
     1415    10818                            %CLIMB(FCN=FRA);
     1416    10832    5                   CASE(%SET_NAME_NET);
     1417    10833    5                       VBASE(IPT_FRS.V_) = ADDR(IPT_FRS.V);
     1418    10834    5                       VBOUND(IPT_FRS.V_) = SIZEC(IPT_FRS.V.FCW) +
     1419    10835    5                          SIZEC(IPT_FRS.V.RC) +
     1420    10836    5                          SIZEC(IPT_FRS.V.SC) +
     1421    10837    5                          SIZEC(IPT_FRS.V.RLCW) +
     1422    10838    5                          SIZEC(IPT_FRS.V.RETENTION_LIST) *
     1423    10839    5                          (RLCW_SAVE.N_SETS#);
     1424    10840                            %CLIMB(FCN=FRS);
     1425    10854    5                   CASE(ELSE);
     1426    10855    5                       CALL ARG_ERROR(120);
     1427    10856        /*    ERROR: ZII-120-1
     1428    10857              MESSAGE: The last argument in
     1429    10858                       CALL FIND(NEXT/PRIOR/CURRENT,[REC-NAME],SET-NAME/AREA-NAME)
     1430    10859                       is neither a SET-NAME nor an AREA-NAME.  */
     1431    10860    5                       END;
     1432    10861    4                   END;
     1433    10862         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:51   
     1434    10863    3           CASE(%OWNER);
     1435    10864
     1436    10865        /***************************************************************/
     1437    10866        /*                                                             */
     1438    10867        /*       TYPE OF FIND: OWNER OF A SET                          */
     1439    10868        /*                                                             */
     1440    10869        /*       CALL FIND(OWNER,SET-NAME)                             */
     1441    10870        /*                                                             */
     1442    10871        /***************************************************************/
     1443    10872
     1444    10873    3               IF ARG.TYPE(1)~=%SET_NAME OR NO_ARGS>2 THEN CALL ARG_ERROR(125);
     1445    10874        /*    ERROR: ZII-125-1
     1446    10875              MESSAGE: Argument count error, or the 2nd argument in
     1447    10876                       CALL FIND(OWNER,SET-NAME) is not a SET-NAME. */
     1448    10877    3               IPT_FOR.V.SC.SC_OFFSET#=ARG.OFFSET(1);
     1449    10878    3               CALL CHK_RETAIN(IPT_FOR.V.RLCW,0);
     1450    10879    4               IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;
     1451    10880    4                   VBASE(IPT_FOR.V_) = ADDR(IPT_FOR.V);
     1452    10881    4                   VBOUND(IPT_FOR.V_) = SIZEC(IPT_FOR.V.SC) +
     1453    10882    4                      SIZEC(IPT_FOR.V.RLCW) +
     1454    10883    4                      SIZEC(IPT_FOR.V.RETENTION_LIST) *
     1455    10884    4                      (RLCW_SAVE.N_SETS#);
     1456    10885    4                   END;
     1457    10886    4               ELSE DO;
     1458    10887    4                   IPT_FOR.V_ = VECTOR(IPT_FOR.V);
     1459    10888    4                   END;
     1460    10889                    %CLIMB(FCN=FOR);
     1461    10903    3           CASE(ELSE);
     1462    10904         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:52   
     1463    10905        /**************************************************************/
     1464    10906        /*                                                            */
     1465    10907        /*       TYPE OF FIND: I-TH NUMBER WITHIN A SET OR A AREA     */
     1466    10908        /*                                                            */
     1467    10909        /*       CALL FIND(FIRST,[REC-NAME],SET-NAME )                */
     1468    10910        /*                 LAST             AREA-NAME                 */
     1469    10911        /*                 INTEGER                                    */
     1470    10912        /*                 IDENTIFIER                                 */
     1471    10913        /*                                                            */
     1472    10914        /**************************************************************/
     1473    10915
     1474    10916    3               IPT_FAA.V.AC.AC_OFFSET#=ARG.OFFSET(NO_ARGS-1);
     1475    10917    3               IF ARG.TYPE(0)=%LAST THEN
     1476    10918
     1477    10919    3                   IPT_FAS.V.RECORD_NUMBER#=-1;
     1478    10920    3               ELSE
     1479    10921    3                   IF ARG.TYPE(0)=%FIRST THEN
     1480    10922    3                       IPT_FAS.V.RECORD_NUMBER#=1;
     1481    10923    3                   ELSE
     1482    10924    3                       IPT_FAS.V.RECORD_NUMBER#=A1(0);
     1483    10925    3               IF NO_ARGS>2 AND ARG.TYPE(1)=%RECORD_NAME THEN
     1484    10926    3                   IPT_FAS.V.RC.RC_OFFSET#=ARG.OFFSET(1);
     1485    10927    3               ELSE
     1486    10928    3                   IPT_FAS.V.RC.RC_OFFSET#=NULL_OFFSET;
     1487    10929    3               CALL CHK_RETAIN(IPT_FAS.V.RLCW,0);
     1488    10930    3               IF NO_ARGS>3 THEN CALL ARG_ERROR(130);
     1489    10931    4               DO CASE(ARG.TYPE(NO_ARGS-1)-%AREA_NAME);
     1490    10932
     1491    10933    4               CASE(%AREA_NAME_NET);
     1492    10934    5                   IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;
     1493    10935    5                       VBASE(IPT_FAA.V_) = ADDR(IPT_FAA.V);
     1494    10936    5                       VBOUND(IPT_FAA.V_) = SIZEC(IPT_FAA.V.RECORD_NUMBER#) +
     1495    10937    5                          SIZEC(IPT_FAA.V.RC) +
     1496    10938    5                          SIZEC(IPT_FAA.V.AC) +
     1497    10939    5                          SIZEC(IPT_FAA.V.RLCW) +
     1498    10940    5                          SIZEC(IPT_FAA.V.RETENTION_LIST) *
     1499    10941    5                          (RLCW_SAVE.N_SETS#);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:53   
     1500    10942    5                       END;
     1501    10943    5                   ELSE DO;
     1502    10944    5                       IPT_FAA.V_ = VECTOR(IPT_FAA.V);
     1503    10945    5                       END;
     1504    10946                        %CLIMB(FCN=FAA);
     1505    10960    4               CASE(%SET_NAME_NET);
     1506    10961    4                   IPT_FAS.V_ = VECTOR(IPT_FAS.V);
     1507    10962                        %CLIMB(FCN=FAS);
     1508    10976    4               CASE(ELSE);
     1509    10977    4                   CALL ARG_ERROR(130);
     1510    10978        /*    ERROR: ZII-130-1
     1511    10979              MESSAGE: Argument count error, or the last argument in
     1512    10980                       CALL FIND(FIRST/LAST/FORT-VAR,[REC-NAME],SET-NAME/AREA-NAME)
     1513    10981                       is neither a SET-NAME nor an AREA-NAME. */
     1514    10982    4                   END;
     1515    10983    3               END;
     1516    10984    2           END;
     1517    10985    1       GOTO COMMON_RETURN;
     1518    10986         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:54   
     1519    10987        /***************************************************************/
     1520    10988        /*                                                             */
     1521    10989        /*     CALLING SEQUENCE FOR GET:                               */
     1522    10990        /*          1. CALL GET                                        */
     1523    10991        /*          2. CALL GET(REC-NAME)                              */
     1524    10992        /*          3. CALL GET(FIELD-1,[FIELD-2],.....])              */
     1525    10993        /*                                                             */
     1526    10994        /***************************************************************/
     1527    10995
     1528    10996    1   GET: ENTRY(
     1529    10997               %GEN_PARAMS;
     1530    11538
     1531    11539    1       CALL SET_ARGS;
     1532    11540    1       IF NO_ARGS>0 AND ARG.TYPE(0)=%FIELD_NAME THEN
     1533    11541    2       DO;
     1534    11542    2           IPT_GTF.V.FLCW.N_FIELDS#=NO_ARGS;
     1535    11543    3           DO I=0 TO NO_ARGS-1;
     1536    11544    3               IF ARG.TYPE(I)~=%FIELD_NAME THEN CALL ARG_ERROR(140);
     1537    11545        /*    ERROR: ZII-140-1
     1538    11546              MESSAGE: The argument list in GET CALL does not contain all FIELD-NAMES.
     1539    11547                       The correct syntax is CALL GET(FIELD-NAME,....). */
     1540    11548    3               IPT_GTF.V.FIELD_LIST.RVA_OFFSET#(I)=ARG.OFFSET(I);
     1541    11549    3               END;
     1542    11550    3           IF NO_ARGS > 1 THEN DO;
     1543    11551    3               VBASE(IPT_GTF.V_) = ADDR(IPT_GTF.V);
     1544    11552    3               VBOUND(IPT_GTF.V_) = SIZEC(IPT_GTF.V.FLCW) +
     1545    11553    3                  SIZEC(IPT_GTF.V.FIELD_LIST) * (NO_ARGS);
     1546    11554    3               END;
     1547    11555    3           ELSE DO;
     1548    11556    3               IPT_GTF.V_ = VECTOR(IPT_GTF.V);
     1549    11557    3               END; /* only use binding for dynamic structure */
     1550    11558                %CLIMB(FCN=GTF);
     1551    11572    2           END;
     1552    11573    1       ELSE
     1553    11574    2       DO;
     1554    11575    2           IF NO_ARGS=0 THEN
     1555    11576    2               IPT_GET.V.RC.RC_OFFSET#=NULL_OFFSET;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:55   
     1556    11577    2           ELSE
     1557    11578    2               IF ARG.TYPE(0)=%RECORD_NAME THEN
     1558    11579    2                   IPT_GET.V.RC.RC_OFFSET#=ARG.OFFSET(0);
     1559    11580    2               ELSE CALL ARG_ERROR(145);
     1560    11581        /*    ERROR: ZII-145-1
     1561    11582              MESSAGE: Unknown 1st argument in GET CALL.
     1562    11583                       It is neither a RECORD-NAME nor a FIELD-NAME.  */
     1563    11584    2           IPT_GET.V_ = VECTOR(IPT_GET.V);
     1564    11585                %CLIMB(FCN=GET);
     1565    11599    2           END;
     1566    11600    1       GOTO COMMON_RETURN;
     1567    11601         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:56   
     1568    11602    1   MODIFY: ENTRY(
     1569    11603               %GEN_PARAMS;
     1570    12144
     1571    12145        /******************************************************************/
     1572    12146        /*                                                                */
     1573    12147        /*    CALL MODIFY([REC-NAME],[INCLUDING,ALL             ])        */
     1574    12148        /*                           ONLY      SET-NAME1,[...]            */
     1575    12149        /*                                                                */
     1576    12150        /*    CALL MODIFY(IDENT-1,[IDENT-2],...,,[INCLUDING,ALL       ])  */
     1577    12151        /*                                                SET-NAME-LIST   */
     1578    12152        /*                                                                */
     1579    12153        /******************************************************************/
     1580    12154
     1581    12155    1       CALL SET_ARGS;
     1582    12156    1       IPT_MOD.V.RC.RC_OFFSET#=NULL_OFFSET;
     1583    12157    1       IF NO_ARGS>0 THEN
     1584    12158    2       DO;
     1585    12159    2           K=0;
     1586    12160    2           KK = 0; /* count dynamic structures */
     1587    12161    2           IF ARG.TYPE(0)=%RECORD_NAME THEN
     1588    12162    3           DO;
     1589    12163    3               K=1;
     1590    12164    3               KK = 1;
     1591    12165    3               IPT_MOD.V.RC.RC_OFFSET#=ARG.OFFSET(0);
     1592    12166    3               END;
     1593    12167    2           ELSE
     1594    12168    3           DO;
     1595    12169    4               DO WHILE(ARG.TYPE(K)=%FIELD_NAME AND K<NO_ARGS);
     1596    12170    4                   IPT_MOD.V.FL_SL_LIST.RVA_OFFSET#(K)=ARG.OFFSET(K);
     1597    12171    4                   IPT_MOD.V.FLCW.N_FIELDS#=IPT_MOD.V.FLCW.N_FIELDS#+1;
     1598    12172    4                   K=K+1;
     1599    12173    4                   KK = KK + 1;
     1600    12174    4                   END;
     1601    12175    3               END;
     1602    12176    2           IF K<NO_ARGS-1 AND (ARG.TYPE(K)=SNA.ONLY OR ARG.TYPE(K)=SNA.INCLUDING) THEN
     1603    12177    3           DO;
     1604    12178    3               IF ARG.TYPE(K)=SNA.ONLY THEN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:57   
     1605    12179    4               DO;
     1606    12180    4                   IPT_MOD.V.MCW.MC_BIT0#='1'B;
     1607    12181    4                   IF IPT_MOD.V.FLCW.N_FIELDS#>0 THEN CALL ARG_ERROR(153);
     1608    12182    4                   END;
     1609    12183        /*    ERROR: ZII-153-1
     1610    12184              MESSAGE: Keyword ONLY not legal in MODIFY CALL
     1611    12185                       in conjunction with FIELD-NAME list.  */
     1612    12186    3               K=K+1;
     1613    12187    3               IF ARG.TYPE(K)=SNA.ALL THEN
     1614    12188    3                   IPT_MOD.V.MCW.MC_BIT1#='1'B;
     1615    12189    3               ELSE
     1616    12190    4               DO;
     1617    12191    5                   DO WHILE (K<NO_ARGS);
     1618    12192    5                       IF ARG.TYPE(K)~=%SET_NAME THEN CALL ARG_ERROR(150);
     1619    12193        /*    ERROR: ZII-150-1
     1620    12194              MESSAGE: Bad arguments found in MODIFY CALL
     1621    12195                       after keyword ONLY/INCLUDING.              */
     1622    12196    5                       IPT_MOD.V.FL_SL_LIST.RVA_OFFSET#
     1623    12197    5                          (IPT_MOD.V.FLCW.N_FIELDS#+IPT_MOD.V.SLCW.N_SETS#)
     1624    12198    5                          =ARG.OFFSET(K);
     1625    12199    5                       IPT_MOD.V.SLCW.N_SETS#=IPT_MOD.V.SLCW.N_SETS#+1;
     1626    12200    5                       K=K+1;
     1627    12201    5                       KK = KK + 1;
     1628    12202    5                       END;
     1629    12203    4                   END;
     1630    12204    3               END;
     1631    12205    2           ELSE
     1632    12206    2               IF K<NO_ARGS THEN CALL ARG_ERROR(155);
     1633    12207        /*    ERROR: ZII-155-1
     1634    12208              MESSAGE: Bad arguments found in MODIFY CALL.  */
     1635    12209    2           END;
     1636    12210    1       IPT_MOD.V_ = VECTOR(IPT_MOD.V);
     1637    12211    2       IF KK ~= 0 THEN DO;
     1638    12212    2           VBASE(IPT_MOD.V_) = ADDR(IPT_MOD.V);
     1639    12213    2           VBOUND(IPT_MOD.V_) = SIZEC(IPT_MOD.V.RC) +
     1640    12214    2              SIZEC(IPT_MOD.V.MCW) +
     1641    12215    2              SIZEC(IPT_MOD.V.FLCW) +
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:58   
     1642    12216    2              SIZEC(IPT_MOD.V.SLCW) +
     1643    12217    2              SIZEC(IPT_MOD.V.FL_SL_LIST) * KK;
     1644    12218    2           END;
     1645    12219    2       ELSE DO;
     1646    12220    2           IPT_MOD.V = VECTOR(IPT_MOD.V);
     1647    12221    2           END;
     1648    12222            %CLIMB(FCN=MOD);
     1649    12236    1       GOTO COMMON_RETURN;
     1650    12237         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:59   
     1651    12238        /**   INTERNAL COMMON SUBROUTINE FOR CONNECT AND DISCONNECT   **/
     1652    12239
     1653    12240    1   CON_DIS: PROC ALTRET;
     1654    12241
     1655    12242    2       CALL SET_ARGS;
     1656    12243
     1657    12244    3       DO CASE(NO_ARGS);
     1658    12245
     1659    12246    3       CASE(2);
     1660    12247    3           IF ARG.TYPE(0)~=%RECORD_NAME OR ARG.TYPE(1)~=%SET_NAME THEN CALL ARG_ERROR(
             12247                    160);
     1661    12248        /*    ERROR: ZII-160-1
     1662    12249              MESSAGE: Bad arguments found in CONNECT/DISCONNECT CALL.
     1663    12250                       The correct syntax is
     1664    12251                       CALL CONNECT/DISCONNECT(RECORD-NAME,SET-NAME). */
     1665    12252    3           IPT_CON.V.RC.RC_OFFSET#=ARG.OFFSET(0);
     1666    12253    3           IPT_CON.V.SC.SC_OFFSET#=ARG.OFFSET(1);
     1667    12254    3       CASE(1);
     1668    12255    3           IF ARG.TYPE(0)~=%SET_NAME THEN CALL ARG_ERROR(165);
     1669    12256        /*    ERROR: ZII-165-1
     1670    12257              MESSAGE: The only argument in CONNECT/DISCONNECT CALL
     1671    12258                       is not a SET-NAME.  */
     1672    12259    3           IPT_CON.V.RC.RC_OFFSET#=NULL_OFFSET;
     1673    12260    3           IPT_CON.V.SC.SC_OFFSET#=ARG.OFFSET(0);
     1674    12261    3       CASE(ELSE);
     1675    12262    3           CALL ARG_ERROR(170);
     1676    12263        /*    ERROR: ZII-170-1
     1677    12264              MESSAGE: Wrong number of arguments in CONNECT/DISCONNECT CALL. */
     1678    12265    3           END;
     1679    12266    2   END CON_DIS;
     1680    12267
     1681    12268    1   CONNECT: ENTRY(A1,A2);
     1682    12269
     1683    12270    1       IPT_CON.V_ = VECTOR(IPT_CON.V);
     1684    12271    1       CALL CON_DIS;
     1685    12272            %CLIMB(FCN=CON);
     1686    12286    1       GOTO COMMON_RETURN;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:60   
     1687    12287
     1688    12288    1   DISCONNECT: ENTRY(A1,A2);
     1689    12289    1   DISCONNE: ENTRY(A1,A2);
     1690    12290
     1691    12291    1       IPT_DIS.V_ = VECTOR(IPT_DIS.V);
     1692    12292    1       CALL CON_DIS;
     1693    12293            %CLIMB(FCN=DIS);
     1694    12307    1       GOTO COMMON_RETURN;
     1695    12308         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:61   
     1696    12309    1   COMMON_RETURN: /*  CHK IA(7) SEE IF ANY CLEAN-UP TO DO */
     1697    12310
     1698    12311    1       IDSSYSERR = PINCRW(IA$,5) -> SBIN36; /* MON ERR_CODE */
     1699    12312    1       IF IA_HALF(14)>0 THEN
     1700    12313    2       DO;
     1701    12314    2           REDEF_PT.ADR=IA_HALF(14); /* GET ADDR FROM IA */
     1702    12315    2           IA_HALF(14) = 0; /* RESET FLAG */
     1703    12316    2           REDEF_PT.SEG#='006000'O; /* INSTRUCTION SEG # */
     1704    12317    2           CALL EPTR$;
     1705    12318    2           END;
     1706    12319    1       IF IA_HALF(12)>0 THEN /* RETURN FROM ROLL BACK */
     1707    12320    2       DO;
     1708    12321    2           IA_HALF(12)=0; /* RESET FLAG */
     1709    12322    2           DK_RET.RET_ADDR=IA_HALF(13); /* ASL PUT RETADDR THERE */
     1710    12323    2           UNWIND TO DEADLOCK_RET;
     1711    12324    2           END;
     1712    12325    1       RETURN;
     1713    12326         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:62   
     1714    12327        /**   COMMON SUBROUTINE FOR IFT OR IST   **/
     1715    12328    1   DO_IF: PROC(A) ALTRET;
     1716    12329    2   DCL A BIT(2) ALIGNED;
     1717    12330
     1718    12331    2       CALL SET_ARGS;
     1719    12332    2       IPT_IST.V.TDW=A;
     1720    12333    3       DO CASE(NO_ARGS);
     1721    12334    3       CASE(1);
     1722    12335    3           IPT_IFT.V_ = VECTOR(IPT_IFT.V);
     1723    12336                %CLIMB(FCN=IFT);
     1724    12350    3           A1(0)=-1*UWA(0); /* UWA=0 IF F,1 IF T(FORTRAN WANT -1) */
     1725    12351    3       CASE(2);
     1726    12352    3           IF ARG.TYPE(0)~=%SET_NAME THEN CALL ARG_ERROR(175);
     1727    12353        /*    ERROR: ZII-175-1
     1728    12354              MESSAGE: The 1st argument in IFOWNER/IFMEMBER/IFTENANT CALL
     1729    12355                       is not a SET-NAME but two arguments specified.  */
     1730    12356    3           IPT_IST.V.SC.SC_OFFSET#=ARG.OFFSET(0);
     1731    12357    3           IPT_IST.V_ = VECTOR(IPT_IST.V);
     1732    12358                %CLIMB(FCN=IST);
     1733    12372    3           A2(0)=-1*UWA(0);
     1734    12373    3       CASE(ELSE);
     1735    12374    3           CALL ARG_ERROR(180);
     1736    12375        /*    ERROR: ZII-180-1
     1737    12376              MESSAGE: Wrong number of arguments in
     1738    12377                       IFOWNER/IFMEMBER/IFTENANT CALL.  */
     1739    12378    3           END;
     1740    12379    2   END DO_IF;
     1741    12380         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:63   
     1742    12381    1   IFEMPTY: ENTRY(A1,A2);
     1743    12382
     1744    12383    1       CALL P_OFF_W(ADDR(A1),RVA$);
     1745    12384    1       IF I<=0 OR I>RVA_SIZE OR RVA_TYPE(I)~=%SET_NAME_NET THEN CALL ARG_ERROR(185);
     1746    12385        /*    ERROR: ZII-185-1
     1747    12386              MESSAGE: The 1st argument in IFEMPTY CALL is not a SET-NAME. */
     1748    12387    1       IPT_IFM.V.SC.SC_OFFSET#=I;
     1749    12388    1       IPT_IFM.V_ = VECTOR(IPT_IFM.V);
     1750    12389            %CLIMB(FCN=IFM);
     1751    12403    1       IF ADDR(A2(0))=ADDR(NIL) THEN CALL ARG_ERROR(190);
     1752    12404        /*    ERROR: ZII-190-3
     1753    12405              MESSAGE: Wrong number of arguments in IFEMPTY CALL.
     1754    12406                       The correct syntax is
     1755    12407                       CALL IFEMPTY(SET-NAME,LOGIC-RESULT).  */
     1756    12408    1       A2(0)=-1*UWA(0);
     1757    12409    1       GOTO COMMON_RETURN;
     1758    12410
     1759    12411    1   IFMEMBER: ENTRY(A1,A2);
     1760    12412
     1761    12413    1       CALL DO_IF('01'B);
     1762    12414    1       GOTO COMMON_RETURN;
     1763    12415
     1764    12416    1   IFOWNER: ENTRY(A1,A2);
     1765    12417
     1766    12418    1       CALL DO_IF('10'B);
     1767    12419    1       GOTO COMMON_RETURN;
     1768    12420
     1769    12421    1   IFTENANT: ENTRY(A1,A2);
     1770    12422
     1771    12423    1       CALL DO_IF('11'B);
     1772    12424    1       GOTO COMMON_RETURN;
     1773    12425        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:64   
     1774    12426    1   BUFFERS: ENTRY(A1,A2);
     1775    12427
     1776    12428    1       IPT_NBF.BUFFS_REQ_=VECTOR(A1(0));
     1777    12429    1       IPT_NBF.BUFFS_ALLOC_=VECTOR(A2(0));
     1778    12430            %CLIMB(FCN=NBF);
     1779    12444    1       GOTO COMMON_RETURN;
     1780    12445    1   CRPT: ENTRY(A1);
     1781    12446
     1782    12447    1       FPT_SHORT.VEC1=VECTOR(FPT_SHORT.VEC2);
     1783    12448    1       ADDR(FPT_SHORT.VEC2)->SBIN36=A1(0); /* MAKE SURE SEED IS DALIGNED */
     1784    12449            %CLIMB(FCN=CRPT);
     1785    12463    1       GOTO COMMON_RETURN;
     1786    12464
     1787    12465    1   ROLL: ENTRY(A1);
     1788    12466
     1789    12467    1       IF ADDR(A1)=ADDR(NIL) THEN
     1790    12468    1           FPT_SHORT.VEC1=VECTOR(PINCRW(UWA$,1)->CHAR7);
     1791    12469    1       ELSE
     1792    12470    1           FPT_SHORT.VEC1=VECTOR(ADDR(A1)->CHAR7);
     1793    12471    1       FPT_SHORT.VEC2=FPTS.IA_;
     1794    12472            %CLIMB(FCN=ROL);
     1795    12486    1       GOTO COMMON_RETURN;
     1796    12487    1   KEEP: ENTRY;
     1797    12488
     1798    12489    1       IPT_KEEP.ERROR_=VECTOR(PINCRW(UWA$,1)->CHAR7);
     1799    12490            %CLIMB(FCN=KEEP);
     1800    12504    1       GOTO COMMON_RETURN;
     1801    12505
     1802    12506    1   REDUCEQ: ENTRY;
     1803    12507
     1804    12508            %CLIMB(FCN=REDUCEQ);
     1805    12522    1       GOTO COMMON_RETURN;
     1806    12523        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:65   
     1807    12524    1   RPTSTATS: ENTRY;
     1808    12525
     1809    12526            %CLIMB(FCN=RPT,PARAMS=0);
     1810    12540    1       RETURN;
     1811    12541
     1812    12542    1   STATSON: ENTRY;
     1813    12543
     1814    12544            %CLIMB(FCN=STON,PARAMS=0);
     1815    12558    1       RETURN;
     1816    12559
     1817    12560    1   STATSOFF: ENTRY;
     1818    12561
     1819    12562            %CLIMB(FCN=STOFF,PARAMS=0);
     1820    12576    1       RETURN;
     1821    12577
     1822    12578    1   TRACE_COMMON: PROC;
     1823    12579
     1824    12580    2       IF ADDR(A1)=ADDR(NIL) THEN
     1825    12581    2           I=0; /* NO TRACE OPTION SPECIFIED */
     1826    12582    2       ELSE
     1827    12583    2           I=A1(0);
     1828    12584    2       FPT_SHORT.VEC1=VECTOR(I);
     1829    12585    2   END TRACE_COMMON;
     1830    12586
     1831    12587    1   TRACEOFF: ENTRY(A1);
     1832    12588
     1833    12589    1       CALL TRACE_COMMON;
     1834    12590            %CLIMB(FCN=TROFF);
     1835    12604    1       RETURN;
     1836    12605
     1837    12606    1   TRACEON: ENTRY(A1);
     1838    12607
     1839    12608    1       CALL TRACE_COMMON;
     1840    12609            %CLIMB(FCN=TRON);
     1841    12623    1       RETURN;
     1842    12624        /**************************************************************/
     1843    12625        /*                                                            */
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:66   
     1844    12626        /*    CALL INVOKE(IA,UWA,RVA)                                 */
     1845    12627        /*                                                            */
     1846    12628        /*    1. REMEMBER UWA$ AND RVA$.  2.  DO A CLIMB TO 'HIA'     */
     1847    12629        /*                                                            */
     1848    12630        /**************************************************************/
     1849    12631
     1850    12632    1   INVOKE: ENTRY(A1,A2,A3);
     1851    12633
     1852    12634    1       IA$=ADDR(A1);
     1853    12635    1       UWA$=ADDR(A2);
     1854    12636    1       RVA$=ADDR(A3);
     1855    12637    1       IF RVA$ = B$DS8$ THEN
     1856    12638    1           CALL SDS$OPEN;
     1857    12639    1       IF PAGE_VECTOR.ADR=ADDR(NIL) THEN
     1858    12640    1           CALL GET_A_PAGE;
     1859    12641    1       IF RVA_HALF(0)<131072 THEN
     1860    12642    1           RVA_SIZE=RVA_HALF(0);
     1861    12643    1       ELSE
     1862    12644    1           RVA_SIZE=RVA_HALF(0)-131072;
     1863    12645    1       UWA_SIZE=A1(1);
     1864    12646    1       CALL VEC_MAKER(A1,47,FPTS.IA_);
     1865    12647    1       CALL VEC_MAKER(A2,UWA_SIZE,FPTS.UWA_);
     1866    12648    1       CALL VEC_MAKER(A3,RVA_SIZE,FPTS.RVA_);
     1867    12649    1       IF RVA_HALF(0)<131072 OR
     1868    12650    2          (RVA$ = B$DS8$ & ~ SDSFLAG) THEN DO;
     1869    12651    2           SDSFLAG = '1'B;
     1870    12652    3           IF RVA$ = B$DS8$ THEN DO;
     1871    12653        /*          Set up NULL_OFFSET and RVA_TYPE table DBACS supplied
     1872    12654                    data in shared data segment file buffers */
     1873    12655    3               PT$ = PINCRW(RVA$, RVA_SIZE+1);
     1874    12656    3               NULL_OFFSET = PT$->SBIN36;
     1875    12657    3               PT$ = PINCRW(PT$, 1);
     1876    12658    3               IX = (RVA_SIZE+1)*%TYPE_BITS/9 + 1;
     1877    12659    3               RVA_TYPEC = PT$->RVA_TYPEC;
     1878    12660    3               END;
     1879    12661    3           ELSE DO;
     1880    12662    4               DO I=1 TO RVA_SIZE;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:67   
     1881    12663    4                   RVA_TYPE(I)=RVA_HALF(2*I);
     1882    12664    4                   IF RVA_HALF(2*I)=4 THEN
     1883    12665    4                       NULL_OFFSET=I;
     1884    12666    4                   END;
     1885    12667    3               END;
     1886    12668    2           I=%FPT_SIZE+%RLCW_SIZE+RVA_SIZE/(36/%TYPE_BITS)+1;
     1887    12669    2           IF MOD(I,2)=0 THEN
     1888    12670    2               USEP$=PINCRW(FPT$,I);
     1889    12671    2           ELSE
     1890    12672    2               USEP$=PINCRW(FPT$,I+1);
     1891    12673    2           USEP.M=0;
     1892    12674    2           USEP.FLAG='0'B;
     1893    12675    2           FPTS.USEP_=VECTOR(USEP);
     1894    12676    2           E$=ENTADDR(GET);
     1895    12677    2           IDS_ADR(0)=REDEF_E$.ADR;
     1896    12678    2           E$=ENTADDR(MODIFY);
     1897    12679    2           IDS_ADR(1)=REDEF_E$.ADR;
     1898    12680    2           E$=ENTADDR(STORE);
     1899    12681    2           IDS_ADR(2)=REDEF_E$.ADR;
     1900    12682    2           E$=ENTADDR(ERASER);
     1901    12683    2           IDS_ADR(3)=REDEF_E$.ADR;
     1902    12684    2           E$=ENTADDR(CONNECT);
     1903    12685    2           IDS_ADR(4)=REDEF_E$.ADR;
     1904    12686    2           E$=ENTADDR(DISCONNE);
     1905    12687    2           IDS_ADR(5)=REDEF_E$.ADR;
     1906    12688    2           E$=ENTADDR(DISCONNECT);
     1907    12689    2           IDS_ADR(6)=REDEF_E$.ADR;
     1908    12690    2           E$=ENTADDR(FIND);
     1909    12691    2           IDS_ADR(7)=REDEF_E$.ADR;
     1910    12692    2           END;
     1911    12693    1   HIA:
     1912    12694            %CLIMB(FCN=HIA);
     1913    12708    1       GOTO COMMON_RETURN;
     1914    12709    1   END ZII$FORT_PL6;
     1915    12710
     1916    12711
     1917    12712
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:68   
     1918    12713
     1919    12714
     1920    12715
     1921    12716
     1922    12717
     1923    12718

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:69   
--  Include file information  --

   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI_DBCS.:ZIC0TOU  is referenced.
   ZI$USER.:ZIC0TOU  is referenced.
   FM$FIT.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   B_SEGIDS_C.:LIB_E05  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZII$FORT_PL6.

   Procedure ZII$FORT_PL6 requires 3129 words for executable code.
   Procedure ZII$FORT_PL6 requires 70 words of local(AUTO) storage.

    No errors detected in file ZII$IDS_FORT_USER.:ZIC0TSI    .

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:70   

 Object Unit name= ZII$FORT_PL6                               File name= ZII$IDS_FORT_USER.:ZIC0TOU
 UTS= SEP 05 '97 12:27:46.72 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RtLbCm even  none    30     36  SNA
    1   Data  even  none  1218   2302  ZII$FORT_PL6
    2   DCB   even  none     0      0  M$DO
    3   DCB   even  none     0      0  M$UC
    4  RoData even  UTS      1      1  ZII$FORT_PL6
    5   Proc  even  none  3129   6071  ZII$FORT_PL6
    6  RoData even  none   141    215  ZII$FORT_PL6

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes            yes      Std       20  ZII$FORT_PL6
     5    776                  yes      Std       20  PRIVACY
     5   1211                  yes      Std       20  USEPROC
     5   1302                  yes      Std       20  RETAIN
     5   1400                  yes      Std        2  IDSSET
     5   1617                  yes      Std       20  READY
     5   2075                  yes      Std       20  FINISH
     5   2171                  yes      Std        2  CALC
     5   2245                  yes      Std        3  ACCEPT
     5   2520                  yes      Std        1  STORE
     5   2563                  yes      Std        2  CHECK
     5   2647                  yes      Std        2  ERASER
     5   2777                  yes      Std       20  FIND
     5   4422                  yes      Std       20  GET
     5   4546                  yes      Std       20  MODIFY
     5   5046                  yes      Std        2  CONNECT
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:71   
     5   5064                  yes      Std        2  DISCONNECT
     5   5067                  yes      Std        2  DISCONNE
     5   5254                  yes      Std        2  IFEMPTY
     5   5343                  yes      Std        2  IFMEMBER
     5   5352                  yes      Std        2  IFOWNER
     5   5361                  yes      Std        2  IFTENANT
     5   5370                  yes      Std        2  BUFFERS
     5   5406                  yes      Std        1  CRPT
     5   5423                  yes      Std        1  ROLL
     5   5447                  yes      Std        0  KEEP
     5   5463                  yes      Std        0  REDUCEQ
     5   5472                  yes      Std        0  RPTSTATS
     5   5500                  yes      Std        0  STATSON
     5   5506                  yes      Std        0  STATSOFF
     5   5531                  yes      Std        1  TRACEOFF
     5   5542                  yes      Std        1  TRACEON
     5   5553                  yes      Std        3  INVOKE

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1      2  IDSSYSERR
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:72   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 U$SHIN
         yes           Std       0 U$SHCUR
         yes           Std       1 U$IFM
         yes           Std       1 U$TRON
         yes           Std       0 U$SHINCUR
         yes           Std       1 U$ACN
         yes           Std       1 U$CON
         yes           Std       1 U$REDUCEQ
         yes           Std       1 U$ACC
         yes           Std       1 U$FRS
         yes           Std       1 U$FCD
         yes           Std       1 U$GET
         yes           Std       1 U$NBF
         yes           Std       0 U$SHNO
         yes           Std       1 U$FRI
         yes           Std       1 U$ERS
         yes           Std       1 U$FKY
         yes           Std       1 U$FDP
         yes           Std       1 U$MOD
         yes           Std       1 U$FAS
         yes           Std       1 U$HIA
         yes           Std       1 U$FDC
         yes           Std       1 U$KEEP
         yes           Std       0 U$STON
         yes           Std       0 U$SHALL
         yes           Std       0 U$SHANY
         yes           Std       1 U$RDY
         yes           Std       1 U$FKC
         yes           Std       1 U$FOR
         yes           Std       0 U$STOFF
         yes           Std       1 U$FUI
         yes           Std       1 U$GTF
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:73   
         yes           Std       1 U$ROL
         yes           Std       1 U$FIN
         yes           Std       1 U$FCR
         yes           Std       1 U$FCT
         yes           Std       1 U$CRPT
         yes           Std       1 U$TROFF
         yes           Std       1 U$FRA
         yes           Std       1 U$DIS
         yes           Std       1 U$ETC
         yes           Std       1 U$CALC
         yes           Std       1 U$STO
         yes           Std       0 U$RPT
         yes           Std       1 U$CHK
         yes           Std       1 U$FAA
         yes           Std       1 U$FDR
         yes           Std       1 U$IFT
         yes           Std       1 U$IST
         yes           Std      20 GET
         yes           Std      20 MODIFY
         yes           Std       1 STORE
         yes           Std       2 ERASER
         yes           Std       2 CONNECT
         yes           Std       2 DISCONNE
         yes           Std       2 DISCONNECT
         yes           Std      20 FIND
                       nStd      0 X66_AUTO_N
                       nStd      0 X66_ARET
                       nStd      0 X66_INDEX
                       nStd      0 X66_AUNWIND

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$TCB$                                M$DO                                  M$UC
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:74   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:75   


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        /****************************************************************/
        7        7        /*                                                              */
        8        8        /*    I-D-S/II INTERFACE MODULE WITH FORTRAN/PL6 USERS          */
        9        9        /*                                                              */
       10       10        /****************************************************************/
       11       11        %MACRO GEN_PARAMS(TYPE=0); /* GENERATE SOURCE CODES FOR ALL ARGUMENTS */
       12       12         %SET PARAM# = %PARAM# + 1;
       13       13         %IF %PARAM# > %PARAMETERS;
       14       14         %SET PARAM# = 1;
       15       15         %ENDIF;
       16       16         %SET DIGITS = %PARAM# /10 + 1; /* NUMBER OF DIGITS */
       17       17         %SET ARG = CONCAT('A',BINCHAR(%PARAM#,%DIGITS));
       18       18         %IF TYPE = 0; /* GENERATE ARGUMENTS LIST */
       19       19         %IF %PARAM# < %PARAMETERS;
       20       20         %CHARTEXT(ARG),
       21       21         %ELSE;
       22       22         %CHARTEXT(ARG) );
       23       23         %ENDIF;
       24       24         %ELSEIF TYPE = 1;
       25       25         %IF %PARAM# < 4;
       26       26        DCL %CHARTEXT(ARG) (0:0) SBIN CALIGNED;
       27       27         %ELSE;
       28       28        DCL %CHARTEXT(ARG) SBIN CALIGNED;
       29       29         %ENDIF;
       30       30         %ELSEIF TYPE = 2;
       31       31            CALL CHK_ARG(%CHARTEXT(ARG)) ALTRET(END_OF_ARGS);
       32       32         %ELSE
       33       33         %ERROR('UNKNOWN TYPE IN MACRO GEN_PARAMS CALL');
       34       34         %ENDIF;
       35       35         %IF %PARAM# < %PARAMETERS;
       36       36            %GEN_PARAMS(TYPE=TYPE); /* KEEP GENERATING */
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:76   
       37       37         %ENDIF;
       38       38        %MEND;
       39       39
       40       40        %EQU PARAMETERS = 20; /* MUST BE A MUTIPLE OF 4 */
       41       41        %EQU TYPE_BITS=2;
       42       42        %SET PARAM#=0;
       43       43         %EQU PARAMETERS_TIMES_TWO=%PARAMETERS*2;
       44       44        ZII$FORT_PL6: PROC(

     44  5 000000   000000 700200 xent  ZII$FORT_PL6 TSX0  ! X66_AUTO_N
         5 000001   000106 000024                    ZERO    70,20
         5 000002   000775 710000 5                  TRA     s:6447+2

       45       45               %GEN_PARAMS;
       46      586        %GEN_PARAMS(TYPE=1); /* GEN ALL DCL OF ARGUEMENTS */
       47     1127         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:77   
       48     1128        /** DEFINE CONTENTS OF KEY-WORDS IN SNA **/
       49     1129         %EQU ALL=2;
       50     1130         %EQU ANY=3;
       51     1131         %EQU AREANAME=4;
       52     1132         %EQU AREA=5;
       53     1133         %EQU CURRENCY=6;
       54     1134         %EQU CURRENT=7;
       55     1135         %EQU DBKEY=8;
       56     1136         %EQU DUPLICATE=9;
       57     1137         %EQU FIRST=10;
       58     1138         %EQU INCLUDING=11;
       59     1139         %EQU ITEM=12;
       60     1140         %EQU LAST=13;
       61     1141         %EQU LOAD=14;
       62     1142         %EQU NEXT=15;
       63     1143         %EQU NOSHALL=16;
       64     1144         %EQU ONLY=17;
       65     1145         %EQU OWNER=18;
       66     1146         %EQU PRIOR=19;
       67     1147         %EQU RECORD=20;
       68     1148         %EQU RETRIEVAL=12;
       69     1149         %EQU SET=22;
       70     1150         %EQU SETS=23;
       71     1151         %EQU SHAREALL=24;
       72     1152         %EQU SHAREANY=25;
       73     1153         %EQU SHAREIN=26;
       74     1154         %EQU UPDATE=27;
       75     1155         %EQU USING=28;
       76     1156         %EQU WITHIN=29;
       77     1157         %EQU SHCUR=30;
       78     1158         %EQU SHINCUR=31;
       79     1159        %EQU SNA_SIZE=30;
       80     1160         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:78   
       81     1161        /***************************************************************/
       82     1162        /*                                                             */
       83     1163        /*  SPECIAL NAME AREA (SNA) -  EXTROOT                         */
       84     1164        /*                                                             */
       85     1165        /***************************************************************/
       86     1166    1   DCL 1 SNA EXTROOT,
       87     1167    1         2 ALL SBIN INIT(%ALL),
       88     1168    1         2 ANY SBIN INIT(%ANY),
       89     1169    1         2 CURRENCY SBIN INIT(%CURRENCY),
       90     1170    1         2 CURRENT SBIN INIT(%CURRENT),
       91     1171    1         2 DBKEY SBIN INIT(%DBKEY),
       92     1172    1         2 DUPLICATE SBIN INIT(%DUPLICATE),
       93     1173    1         2 FIRST SBIN INIT(%FIRST),
       94     1174    1         2 INCLUDING SBIN INIT(%INCLUDING),
       95     1175    1         2 ITEM SBIN INIT(%ITEM),
       96     1176    1         2 LAST SBIN INIT(%LAST),
       97     1177    1         2 LOAD SBIN INIT(%LOAD),
       98     1178    1         2 NEXT SBIN INIT(%NEXT),
       99     1179    1         2 NOSHALL SBIN INIT(%NOSHALL),
      100     1180    1         2 ONLY SBIN INIT(%ONLY),
      101     1181    1         2 OWNER SBIN INIT(%OWNER),
      102     1182    1         2 PRIOR SBIN INIT(%PRIOR),
      103     1183    1         2 AREA SBIN INIT(%AREA),
      104     1184    1         2 AREANAME SBIN INIT(%AREANAME),
      105     1185    1         2 RECORD SBIN INIT(%RECORD),
      106     1186    1         2 RETRIEVAL SBIN INIT(%RETRIEVAL),
      107     1187    1         2 SET SBIN INIT(%SET),
      108     1188    1         2 SETS SBIN INIT(%SETS),
      109     1189    1         2 SHAREALL SBIN INIT(%SHAREALL),
      110     1190    1         2 SHAREANY SBIN INIT(%SHAREANY),
      111     1191    1         2 SHAREIN SBIN INIT(%SHAREIN),
      112     1192    1         2 UPDATE SBIN INIT(%UPDATE),
      113     1193    1         2 USING SBIN INIT(%USING),
      114     1194    1         2 WITHIN SBIN INIT(%WITHIN),
      115     1195    1         2 SHCUR SBIN INIT(%SHCUR),
      116     1196    1         2 SHINCUR SBIN INIT(%SHINCUR);
      117     1197        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:79   
      118     1198        /****************************************************************/
      119     1199        /*                                                              */
      120     1200        /*    DEFINE THE BASED STRUCTURE INTO A DYNAMIC PAGE            */
      121     1201        /*                                                              */
      122     1202        /****************************************************************/
      123     1203    1   DCL 1 ARG(0:0) BASED(ARG$) ALIGNED,
      124     1204    1         2 OFFSET UBIN HALF CALIGNED,
      125     1205    1         2 TYPE UBIN HALF CALIGNED;
      126     1206
      127     1207        /******************************************************************/
      128     1208        /*                                                                */
      129     1209        /*      COMMON FPT IS RESERVED TO 2*(%PARAMETERS)+10 WORDS        */
      130     1210        /*      IT IS UPDATED WHEN DOING MOST OF IDS_CALLS                */
      131     1211        /*                                                                */
      132     1212        /******************************************************************/
      133     1213    1   DCL 1 FPTS BASED(FPT$) DALIGNED, /* DALIGNED SO VECTOR IT RIGHT */
      134     1214    1         2 V_ VECTOR ALIGNED,
      135     1215    1         2 IA_ VECTOR ALIGNED,
      136     1216    1         2 UWA_ VECTOR ALIGNED,
      137     1217    1         2 RVA_ VECTOR ALIGNED,
      138     1218    1         2 USEP_ VECTOR ALIGNED,
      139     1219    1         2 V DALIGNED,
      140     1220    1           3 *(0:9) SBIN,
      141     1221    1           3 FPARAM (0:%PARAMETERS) SBIN WORD,
      142     1222    1           3 ARG(0:%PARAMETERS) PTR;
      143     1223
      144     1224    1   DCL 1 RLCW_SAVE BASED(RLCW$) ALIGNED,
      145     1225    1         2 * UBIN HALF UNAL,
      146     1226    1         2 AC_INDICATORS BIT(1) UNAL,
      147     1227    1         2 SC_INDICATORS BIT(1) UNAL,
      148     1228    1         2 RC_INDICATORS BIT(1) UNAL,
      149     1229    1         2 * BIT(7) UNAL,
      150     1230    1         2 N_SETS# UBIN(8) UNAL,
      151     1231    1         2 RETAIN_LIST(0:0) SBIN HALF CALIGNED;
      152     1232
      153     1233        /***************************************************************/
      154     1234        /*                                                             */
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:80   
      155     1235        /*  USE PROCEDURE TABLE (USEP) - GENERATED BEFORE HIA          */
      156     1236        /*                                                             */
      157     1237        /***************************************************************/
      158     1238    1   DCL 1 USEP BASED(USEP$) DALIGNED, /* MUST BE DALIGNED */
      159     1239    1         2 FLAG BIT(1) UNAL,
      160     1240    1         2 M UBIN(17) UNAL,
      161     1241    1         2 * SBIN HALF CALIGNED,
      162     1242    1         2 UC(0:200) ALIGNED, /* ALLOW 200 ENTRIES */
      163     1243    1           3 UCW_PRV,
      164     1244    1             4 PT UBIN BYTE CALIGNED,
      165     1245    1             4 PB BIT(9) CALIGNED,
      166     1246    1             4 A UBIN HALF CALIGNED,
      167     1247    1           3 UCW_USE REDEF UCW_PRV,
      168     1248    1             4 PT UBIN BYTE CALIGNED,
      169     1249    1             4 CODE UBIN(27) CALIGNED,
      170     1250    1           3 ENT$ PTR ALIGNED;
      171     1251        %INCLUDE B_SEGIDS_C;
      172     1790        %INCLUDE CP_6_SUBS;
      173     2330        %INCLUDE B_ERRORS_C;
      174     3457    1   DCL B$DS8$_B BIT(36) STATIC INIT('000000006013'O);
      175     3458    1   DCL B$DS8$ REDEF B$DS8$_B PTR;
      176     3459
      177     3460    1   DCL RVA_TYPE(0:0) UBIN(%TYPE_BITS) UNAL BASED(TYPE$);
      178     3461    1   DCL RVA_TYPEC CHAR(IX) BASED(TYPE$);
      179     3462    1   DCL IX UBIN STATIC;
      180     3463
      181     3464         %EQU FPT_SIZE=10+2*(%PARAMETERS+1)+10;
      182     3465         %EQU RLCW_SIZE=1+%PARAMETERS/2;
      183     3466         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:81   
      184     3467        /****************************************************************/
      185     3468        /*                                                              */
      186     3469        /*    WORKING SPACE FOR INTERFACE MODULE                        */
      187     3470        /*                                                              */
      188     3471        /****************************************************************/
      189     3472    1   DCL IDSSYSERR SBIN STATIC SYMDEF; /* FOR MON ERR_CODE IN IA(5) */
      190     3473    1   DCL CHAR7 CHAR(7) BASED;
      191     3474    1   DCL CHAR_V CHAR(K) BASED(PT$) UNAL;
      192     3475    1   DCL B$TCB$ PTR SYMREF;
      193     3476
      194     3477    1   DCL I SBIN STATIC;
      195     3478    1   DCL K SBIN STATIC;
      196     3479    1   DCL J SBIN STATIC;
      197     3480    1   DCL 1 REDEF_J REDEF J,
      198     3481    1         2 BIT9 BIT(9) UNAL,
      199     3482    1         2 * BIT(9) UNAL,
      200     3483    1         2 NAME SBIN HALF UNAL;
      201     3484    1   DCL SBIN36 SBIN WORD BASED;
      202     3485    1   DCL AUTO_FRAME(0:0) SBIN HALF UNAL BASED(B$AUTO$);
      203     3486    1   DCL ANAME_ (0:7) SBIN BASED;
      204     3487    1   DCL DEADLOCK_RET BIT(72) STATIC INIT('000000006004000000000000'O);
      205     3488    1   DCL 1 DK_RET REDEF DEADLOCK_RET,
      206     3489    1         2 AUTO_OFFSET UBIN HALF UNAL,
      207     3490    1         2 SEG# UBIN HALF UNAL,
      208     3491    1         2 RET_ADDR UBIN HALF UNAL,
      209     3492    1         2 * UBIN HALF UNAL;
      210     3493    1   DCL P$ PTR BASED;
      211     3494    1   DCL AUTO$ BIT(36) STATIC ALIGNED INIT('000000006004'O);
      212     3495    1   DCL B$AUTO$ REDEF AUTO$ PTR ALIGNED; /* SIMULATE B$AUTO$ */
      213     3496    1   DCL PT$ PTR STATIC;
      214     3497    1   DCL EPTR$ REDEF PT$ EPTR;
      215     3498    1   DCL 1 REDEF_PT REDEF PT$,
      216     3499    1         2 ADR UBIN HALF UNAL,
      217     3500    1         2 SEG# BIT(18) UNAL;
      218     3501    1   DCL E$ EPTR STATIC;
      219     3502    1   DCL 1 REDEF_E$ REDEF E$,
      220     3503    1         2 ADR UBIN HALF UNAL,
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:82   
      221     3504    1         2 * UBIN HALF UNAL;
      222     3505    1   DCL NINE_WORDS SBIN STATIC INIT(324); /* 9 WORDS = 324 BITS */
      223     3506    1   DCL CLEAR_BITS BIT(NINE_WORDS) BASED ALIGNED;
      224     3507    1   DCL NO_ARGS SBIN STATIC;
      225     3508    1   DCL 1 FPT_SHORT STATIC DALIGNED,
      226     3509    1         2 VEC1 BIT(72) INIT(VECTOR(I)),
      227     3510    1         2 VEC2 BIT(72),
      228     3511    1         2 VEC3 BIT(72);
      229     3512    1   DCL CHK_NBF_ROL_CRPT$ PTR STATIC INIT(ADDR(FPT_SHORT));
      230     3513    1   DCL IDS_ADR(0:7) UBIN HALF STATIC;
      231     3514    1   DCL IDS_BIT9(0:7) BIT(9) STATIC UNAL INIT('400'O,'200'O,'100'O,'040'O,
      232     3515    1    '020'O,'010'O,'010'O,'004'O);
      233     3516
      234     3517    1   DCL RETAIN_SWITCH SBIN STATIC INIT(0);
      235     3518    1   DCL II SBIN STATIC;
      236     3519    1   DCL LOW REDEF II SBIN;
      237     3520    1   DCL JJ SBIN STATIC;
      238     3521    1   DCL HIGH REDEF JJ SBIN;
      239     3522    1   DCL KK SBIN STATIC;
      240     3523    1   DCL SDSDCB UBIN STATIC;
      241     3524    1   DCL SUBDCB UBIN STATIC;
      242     3525    1   DCL SDSFLAG BIT(1) STATIC INIT('0'B);
      243     3526        %INCLUDE FM$FIT;
      244     3747        %FM$FIT;
      245     3750        %CODE04;
      246     3758    1   DCL FPBUF CHAR(4096) STATIC;
      247     3759    1   DCL FIT$ PTR;
      248     3760    1   DCL RVA (0:0) SBIN WORD BASED(RVA$);
      249     3761    1   DCL RVA_HALF(0:0) UBIN HALF HALIGNED BASED(RVA$);
      250     3762    1   DCL IA_HALF(0:0) UBIN HALF CALIGNED BASED(IA$);
      251     3763    1   DCL UWA (0:0) SBIN BASED(UWA$);
      252     3764
      253     3765    1   DCL UWA_SIZE SBIN STATIC;
      254     3766    1   DCL RVA_SIZE SBIN STATIC;
      255     3767    1   DCL NULL_OFFSET SBIN STATIC;
      256     3768        %INCLUDE ZI$USER;
      257     3913         %IA (STCLASS="STATIC");
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:83   
      258     3962    1   DCL 1 IAR$ REDEF IA$,
      259     3963    1         2 * BIT(24) UNAL,
      260     3964    1         2 SEGID BIT(12) UNAL;
      261     3965    1   DCL UWA$ PTR STATIC;
      262     3966    1   DCL RVA$ PTR STATIC;
      263     3967    1   DCL FPT$ PTR STATIC;
      264     3968    1   DCL ARG$ PTR STATIC;
      265     3969    1   DCL USEP$ PTR STATIC;
      266     3970    1   DCL KEY$ PTR STATIC;
      267     3971    1   DCL RLCW$ PTR STATIC;
      268     3972    1   DCL TYPE$ PTR STATIC;
      269     3973
      270     3974        %EQU AREA_NAME=31;
      271     3975        %EQU SET_NAME=32;
      272     3976        %EQU RECORD_NAME=33;
      273     3977        %EQU FIELD_NAME=34;
      274     3978        %EQU ELSE_NAME=1;
      275     3979        %EQU AREA_NAME_NET=0;
      276     3980        %EQU SET_NAME_NET=1;
      277     3981        %EQU RECORD_NAME_NET=2;
      278     3982        %EQU FIELD_NAME_NET=3;
      279     3983        %EQU ON=1;
      280     3984        %EQU OFF=0;
      281     3985        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:84   
      282     3986        /****************************************************************/
      283     3987        /*                                                              */
      284     3988        /*    INCLUDE ZI_DBCS TO INVOKE IDS FPTS AND ENTRY DEFS         */
      285     3989        /*                                                              */
      286     3990        /****************************************************************/
      287     3991        %INCLUDE ZI_DBCS;
      288     4604         %USER;
      289     4615        %IPT_ACC(STCLASS="BASED(FPT$)");
      290     4628        %IPT_ACN(STCLASS="BASED(FPT$)");
      291     4642        %IPT_CALC(STCLASS="BASED(FPT$)");
      292     4654        %IPT_CHK(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      293     4664        %IPT_CON(STCLASS="BASED(FPT$)");
      294     4677        %IPT_CRPT(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      295     4686        %IPT_DIS(STCLASS="BASED(FPT$)");
      296     4699        %IPT_ERS(STCLASS="BASED(FPT$)");
      297     4711        %IPT_ETC(STCLASS="BASED(FPT$)");
      298     4724        %IPT_FAA(STCLASS="BASED(FPT$)");
      299     4741        %IPT_FAS(STCLASS="BASED(FPT$)");
      300     4758        %IPT_FCD(STCLASS="BASED(FPT$)");
      301     4773        %IPT_FCR(STCLASS="BASED(FPT$)");
      302     4787        %IPT_FCT(STCLASS="BASED(FPT$)");
      303     4802        %IPT_FDC(STCLASS="BASED(FPT$)");
      304     4817        %IPT_FDP(STCLASS="BASED(FPT$)");
      305     4833        %IPT_FDR(STCLASS="BASED(FPT$)");
      306     4849        %IPT_FIN(STCLASS="BASED(FPT$)");
      307     4862        %IPT_FKC(STCLASS="BASED(FPT$)");
      308     4879        %IPT_FKY(STCLASS="BASED(FPT$)");
      309     4896        %IPT_FOR(STCLASS="BASED(FPT$)");
      310     4911        %IPT_FRA(STCLASS="BASED(FPT$)");
      311     4928        %IPT_FRI(STCLASS="BASED(FPT$)");
      312     4945        %IPT_FRS(STCLASS="BASED(FPT$)");
      313     4962        %IPT_FUI(STCLASS="BASED(FPT$)");
      314     4978        %IPT_GET(STCLASS="BASED(FPT$)");
      315     4990        %IPT_GTF(STCLASS="BASED(FPT$)");
      316     5003        %IPT_HIA(STCLASS="BASED(FPT$)");
      317     5014        %IPT_IFM(STCLASS="BASED(FPT$)");
      318     5026        %IPT_IFT(STCLASS="BASED(FPT$)");
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:85   
      319     5038        %IPT_INA(STCLASS="BASED(FPT$)");
      320     5052        %IPT_IST(STCLASS="BASED(FPT$)");
      321     5065        %IPT_MOD(STCLASS="BASED(FPT$)");
      322     5081        %IPT_NBF(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      323     5091        %IPT_KEEP(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      324     5100        %IPT_REDUCEQ(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      325     5109        %IPT_RDY(STCLASS="BASED(FPT$)");
      326     5123        %IPT_ROL(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      327     5132        %IPT_STO(STCLASS="BASED(FPT$)");
      328     5147        %IPT_TRON(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      329     5156        %IPT_TROFF(STCLASS="BASED(CHK_NBF_ROL_CRPT$)");
      330     5165        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:86   
      331     5166        /****************************************************************/
      332     5167        /*                                                              */
      333     5168        /*    INCLUDE CP_6 TO DO M$GDP AND M$ERR                        */
      334     5169        /*                                                              */
      335     5170        /****************************************************************/
      336     5171    1   DCL M$DO DCB;
      337     5172    1   DCL 1 PAGE_VECTOR STATIC DALIGNED,
      338     5173    1         2 * BIT(36),
      339     5174    1         2 ADR PTR INIT(ADDR(NIL));
      340     5175    1   DCL 1 ERR_CODE STATIC,
      341     5176    1         2 * BIT(18) UNAL INIT('321111'O),
      342     5177    1         2 ERR_NO UBIN(15) UNAL,
      343     5178    1         2 * UBIN(3) UNAL INIT(3);
      344     5179
      345     5180        %INCLUDE CP_6;
      346     5261
      347     5262
      348     5263        %FPT_GDP(PAGES=1,RESULTS=PAGE_VECTOR);
      349     5277
      350     5278        %VLP_NAME(FPTN=FILE_NAME,LEN=9,NAME=':ZIERRMSG');
      351     5305        %VLP_ACCT(FPTN=FILE_ACCT,ACCT=':SYS ');
      352     5318        %FPT_ERRMSG(OUTDCB1=M$DO,CODE=ERR_CODE,FILEACCT=FILE_ACCT,
      353     5319         FILENAME=FILE_NAME,INCLCODE=YES);
      354     5346        %FPT_YC;
      355     5363        %B$TCB;
      356     5366        %B$EXCFR;
      357     5384
      358     5385        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:87   
      359     5386        /**     INTERNAL SUBROUTINE TO RETURN A POFFW      **/
      360     5387        /**     WITH ADDITIONAL SEGMENT NUMBER CHECK       **/
      361     5388
      362     5389    1   P_OFF_W: PROC(A,B);

   5389  5 000003   200036 741300       P_OFF_W      STX1  ! @A+1,,AUTO

      363     5390    2   DCL 1 A ALIGNED,
      364     5391    2         2 ADR UBIN HALF UNAL,
      365     5392    2         2 * BIT(6) UNAL,
      366     5393    2         2 SEG UBIN(12) UNAL;
      367     5394    2   DCL 1 B ALIGNED,
      368     5395    2         2 ADR UBIN HALF UNAL,
      369     5396    2         2 * BIT(6) UNAL,
      370     5397    2         2 SEG UBIN(12) UNAL;
      371     5398
      372     5399    2       IF A.SEG=B.SEG THEN

   5399  5 000004   200040 470500                    LDP0    @B,,AUTO
         5 000005   200037 471500                    LDP1    @A,,AUTO
         5 000006   100000 236100                    LDQ     0,,PR1
         5 000007   000000 676100                    ERQ     0,,PR0
         5 000010   007777 376007                    ANQ     4095,DL
         5 000011   000022 601000 5                  TNZ     s:5402

      373     5400    2           I=A.ADR-B.ADR;

   5400  5 000012   000000 236100                    LDQ     0,,PR0
         5 000013   000022 772000                    QRL     18
         5 000014   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 000015   100000 236100                    LDQ     0,,PR1
         5 000016   000022 772000                    QRL     18
         5 000017   200076 136100                    SBLQ    ERRMSG_BUF+30,,AUTO
         5 000020   000003 756000 1                  STQ     I
         5 000021   000024 710000 5                  TRA     s:5403

      374     5401    2       ELSE
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:88   
      375     5402    2           I=-1;

   5402  5 000022   000001 335007                    LCA     1,DL
         5 000023   000003 755000 1                  STA     I

      376     5403    2   END P_OFF_W;

   5403  5 000024   000001 702211                    TSX2  ! 1,X1

      377     5404
      378     5405        /**     INTERNAL SUBROUTINE TO RETURN A VECTOR   **/
      379     5406
      380     5407    1   VEC_MAKER: PROC(A,B,C);

   5407  5 000025   200030 741300       VEC_MAKER    STX1  ! FIT$+1,,AUTO

      381     5408    2   DCL A UBIN;
      382     5409    2   DCL B SBIN;
      383     5410    2   DCL 1 C ALIGNED,
      384     5411    2         2 V_SIZE UBIN(20) UNAL,
      385     5412    2         2 * UBIN(16) UNAL,
      386     5413    2         2 * UBIN UNAL;
      387     5414    2       C=VECTOR(A);

   5414  5 000026   777640 235007                    LDA     -96,DL
         5 000027   200031 236100                    LDQ     @A,,AUTO
         5 000030   200033 470500                    LDP0    @C,,AUTO
         5 000031   000000 755100                    STA     0,,PR0
         5 000032   000001 756100                    STQ     1,,PR0

      388     5415    2       C.V_SIZE=(B+1)*4-1;

   5415  5 000033   200032 471500                    LDP1    @B,,AUTO
         5 000034   100000 236100                    LDQ     0,,PR1
         5 000035   000002 736000                    QLS     2
         5 000036   000003 036007                    ADLQ    3,DL
         5 000037   000020 736000                    QLS     16
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:89   
         5 000040   000000 676100                    ERQ     0,,PR0
         5 000041   000000 376000 6                  ANQ     0
         5 000042   000000 656100                    ERSQ    0,,PR0

      389     5416    2   END VEC_MAKER;

   5416  5 000043   200030 221300                    LDX1  ! FIT$+1,,AUTO
         5 000044   000001 702211                    TSX2  ! 1,X1

      390     5417        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:90   
      391     5418    1   SDS$OPEN: PROC;

   5418  5 000045   200030 741300       SDS$OPEN     STX1  ! FIT$+1,,AUTO

      392     5419
      393     5420        /*****************************************************/
      394     5421        /*                                                   */
      395     5422        /*  Procedure to open the shared data segment (SDS). */
      396     5423        /*                                                   */
      397     5424        /*****************************************************/
      398     5425
      399     5426        %F$DCB(STCLASS="BASED");
      400     5483        %FPT_FDS(FPTN=FPT_FDS,RESULTS=VEC,SEGSIZE=262143);
      401     5498        %FPT_GETDCB(FPTN=FPT_GETDCB,DCBNAME=SDS_NAME,DCBNUM=SDSDCB);
      402     5513        %FPT_RELDCB(FPTN=FPT_RELDCB);
      403     5527        %FPT_OPEN(FPTN=OPEN_SDS,ASN=FILE,EXIST=OLDFILE,FUN=IN,ACS=DS8,
      404     5528         FPARAM=FPBUF);
      405     5637        %VLP_NAME(FPTN=SDS_NAME,NAME=' ',LEN=31);
      406     5664        %VLP_NAME(FPTN=VLP_NAME,NAME=' ',LEN=31);
      407     5691        %VLP_VECTOR(FPTN=VEC,SEGID='6013'O);
      408     5706        /*  DCB name for SDS open is subschema-name||'$'  */
      409     5707    2       SDS_NAME.L# = 31;

   5707  5 000046   037000 236003                    LDQ     15872,DU
         5 000047   002260 552040 1                  STBQ    SDS_NAME,'40'O

      410     5708    2       SDS_NAME.NAME# = IA.SSNAME;

   5708  5 000050   002051 470400 1                  LDP0    IA$
         5 000051   040000 100500                    MLR     fill='040'O
         5 000052   000022 000036                    ADSC9   18,,PR0                  cn=0,n=30
         5 000053   002260 200037 1                  ADSC9   SDS_NAME                 cn=1,n=31

      411     5709    3       DO WHILE(SUBSTR(SDS_NAME.NAME#,SDS_NAME.L#-1,1) = ' ');

   5709  5 000054   000060 710000 5                  TRA     s:5711

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:91   
      412     5710    3           SDS_NAME.L# = SDS_NAME.L# - 1;

   5710  5 000055   002260 236000 1                  LDQ     SDS_NAME
         5 000056   777000 036003                    ADLQ    -512,DU
         5 000057   002260 552040 1                  STBQ    SDS_NAME,'40'O

      413     5711    3           END;

   5711  5 000060   002260 236000 1                  LDQ     SDS_NAME
         5 000061   000033 772000                    QRL     27
         5 000062   040000 106406                    CMPC    fill='040'O
         5 000063   002260 000001 1                  ADSC9   SDS_NAME,Q               cn=0,n=1
         5 000064   000001 000001 6                  ADSC9   1                        cn=0,n=1
         5 000065   000055 600000 5                  TZE     s:5710

      414     5712    2       CALL INSERT(SDS_NAME.NAME#,SDS_NAME.L#,1,'$');

   5712  5 000066   040006 100400                    MLR     fill='040'O
         5 000067   000002 000001 6                  ADSC9   2                        cn=0,n=1
         5 000070   002260 200001 1                  ADSC9   SDS_NAME,Q               cn=1,n=1

      415     5713    2       SDS_NAME.L# = SDS_NAME.L# + 1;

   5713  5 000071   002260 236000 1                  LDQ     SDS_NAME
         5 000072   001000 036003                    ADLQ    512,DU
         5 000073   002260 552040 1                  STBQ    SDS_NAME,'40'O

      416     5714        /*  Get a dcb for the SDS */
      417     5715    2       FPT_GETDCB.V.TEST# = %NO#;

   5715  5 000074   000003 236000 6                  LDQ     3
         5 000075   002160 356000 1                  ANSQ    FPT_GETDCB+6

      418     5716    2       FPT_GETDCB.V.MERGE# = %YES#;

   5716  5 000076   400000 236007                    LDQ     -131072,DL
         5 000077   002160 256000 1                  ORSQ    FPT_GETDCB+6
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:92   

      419     5717    2       CALL M$GETDCB(FPT_GETDCB);

   5717  5 000100   002152 630400 1                  EPPR0   FPT_GETDCB
         5 000101   060002 713400                    CLIMB   24578
         5 000102   401000 401760                    pmme    nvectors=3

      420     5718
      421     5719        /*  If dcb for SDS is open, just return */
      422     5720    2       IF DCBADDR(SDSDCB)->F$DCB.FCD# THEN

   5720  5 000103   000004 470400 6                  LDP0    4
         5 000104   000000 471500                    LDP1    0,,PR0
         5 000105   000043 720000 1                  LXL0    SDSDCB
         5 000106   100000 473510                    LDP3    0,X0,PR1
         5 000107   300031 236100                    LDQ     25,,PR3
         5 000110   020000 316007                    CANQ    8192,DL
         5 000111   000114 600000 5                  TZE     s:5722

      423     5721    2           RETURN;

   5721  5 000112   200030 221300                    LDX1  ! FIT$+1,,AUTO
         5 000113   000001 702211                    TSX2  ! 1,X1

      424     5722    2       OPEN_SDS.V.DCB# = SDSDCB;

   5722  5 000114   002232 740000 1                  STX0    OPEN_SDS+36

      425     5723
      426     5724        /*  Free unitialized RVA  */
      427     5725    2       CALL M$FDS(FPT_FDS);

   5725  5 000115   002144 630400 1                  EPPR0   FPT_FDS
         5 000116   030002 713400                    CLIMB   fds
         5 000117   400400 401760                    pmme    nvectors=2

      428     5726
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:93   
      429     5727    3       IF DCBADDR(SDSDCB)->F$DCB.ASN# ~= %FILE# THEN DO;

   5727  5 000120   000004 470400 6                  LDP0    4
         5 000121   000000 471500                    LDP1    0,,PR0
         5 000122   000043 720000 1                  LXL0    SDSDCB
         5 000123   100000 473510                    LDP3    0,X0,PR1
         5 000124   300032 236100                    LDQ     26,,PR3
         5 000125   777000 376007                    ANQ     -512,DL
         5 000126   001000 116007                    CMPQ    512,DL
         5 000127   000214 600000 5                  TZE     s:5759

      430     5728        /*      Set up the file name for open of SDS file */
      431     5729    3           VLP_NAME.L# = SDS_NAME.L# - 1;

   5729  5 000130   002260 236000 1                  LDQ     SDS_NAME
         5 000131   000033 772000                    QRL     27
         5 000132   000001 136007                    SBLQ    1,DL
         5 000133   000033 736000                    QLS     27
         5 000134   002270 552040 1                  STBQ    VLP_NAME,'40'O

      432     5730    3           VLP_NAME.NAME# = IA.SSNAME;

   5730  5 000135   002051 474400 1                  LDP4    IA$
         5 000136   040000 100500                    MLR     fill='040'O
         5 000137   400022 000036                    ADSC9   18,,PR4                  cn=0,n=30
         5 000140   002270 200037 1                  ADSC9   VLP_NAME                 cn=1,n=31

      433     5731
      434     5732        /*      Now, prepare for and get the dcb for the subschema so we can pull
      435     5733                the subschema file name out of the dcb */
      436     5734    3           FPT_GETDCB.DCBNAME_ = VECTOR(VLP_NAME);

   5734  5 000141   000006 237000 6                  LDAQ    6
         5 000142   002154 757000 1                  STAQ    FPT_GETDCB+2

      437     5735    3           FPT_GETDCB.DCBNUM_ = VECTOR(SUBDCB);

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:94   
   5735  5 000143   000010 237000 6                  LDAQ    8
         5 000144   002156 757000 1                  STAQ    FPT_GETDCB+4

      438     5736    3           FPT_GETDCB.V.MERGE# = %YES#;

   5736  5 000145   400000 236007                    LDQ     -131072,DL
         5 000146   002160 256000 1                  ORSQ    FPT_GETDCB+6

      439     5737    3           CALL M$GETDCB(FPT_GETDCB);

   5737  5 000147   002152 630400 1                  EPPR0   FPT_GETDCB
         5 000150   060002 713400                    CLIMB   24578
         5 000151   401000 401760                    pmme    nvectors=3

      440     5738    4           IF DCBADDR(SUBDCB)->F$DCB.ASN# = %FILE# THEN DO;

   5738  5 000152   000004 470400 6                  LDP0    4
         5 000153   000000 471500                    LDP1    0,,PR0
         5 000154   000044 720000 1                  LXL0    SUBDCB
         5 000155   100000 473510                    LDP3    0,X0,PR1
         5 000156   300032 236100                    LDQ     26,,PR3
         5 000157   777000 376007                    ANQ     -512,DL
         5 000160   001000 116007                    CMPQ    512,DL
         5 000161   000173 601000 5                  TNZ     s:5747

      441     5739        /*      SET statement for subschema provided.  Get subschema file name
      442     5740                from DCB and frame the ACCOUNT specification in DCB */
      443     5741    4               VLP_NAME = DCBADDR(SUBDCB)->F$DCB.NAME#;

   5741  5 000162   000000 100500                    MLR     fill='000'O
         5 000163   300010 000040                    ADSC9   8,,PR3                   cn=0,n=32
         5 000164   002270 000040 1                  ADSC9   VLP_NAME                 cn=0,n=32

      444     5742    4               OPEN_SDS.ACCT_ = VECTOR(DCBADDR(SUBDCB)->F$DCB.ACCT#);

   5742  5 000165   000012 235000 6                  LDA     10
         5 000166   200076 453500                    STP3    ERRMSG_BUF+30,,AUTO
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:95   
         5 000167   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 000170   000020 036003                    ADLQ    16,DU
         5 000171   002212 757000 1                  STAQ    OPEN_SDS+20

      445     5743    4               END;

   5743  5 000172   000205 710000 5                  TRA     s:5754

      446     5744    4           ELSE DO;

      447     5745        /*          No SET statement provided.  Use IA.SSNAME for subschema
      448     5746                    file name and provide no ACCOUNT specification.  */
      449     5747    4               OPEN_SDS.ACCT_ = VECTOR(NIL);

   5747  5 000173   000014 237000 6                  LDAQ    12
         5 000174   002212 757000 1                  STAQ    OPEN_SDS+20

      450     5748        /*          Now we have the subschema file name.  The name of the SDS
      451     5749                    will be 'subschema-name$' so put the '$' on the end */
      452     5750    4               CALL INSERT(VLP_NAME.NAME#,VLP_NAME.L#,1,'$');

   5750  5 000175   002270 236000 1                  LDQ     VLP_NAME
         5 000176   000033 772000                    QRL     27
         5 000177   040006 100400                    MLR     fill='040'O
         5 000200   000002 000001 6                  ADSC9   2                        cn=0,n=1
         5 000201   002270 200001 1                  ADSC9   VLP_NAME,Q               cn=1,n=1

      453     5751    4               VLP_NAME.L# = VLP_NAME.L# + 1;

   5751  5 000202   002270 236000 1                  LDQ     VLP_NAME
         5 000203   001000 036003                    ADLQ    512,DU
         5 000204   002270 552040 1                  STBQ    VLP_NAME,'40'O

      454     5752    4               END;

      455     5753        /*      Frame the name of the SDS for the open   */
      456     5754    3           OPEN_SDS.NAME_ = VECTOR(VLP_NAME);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:96   

   5754  5 000205   000006 237000 6                  LDAQ    6
         5 000206   002174 757000 1                  STAQ    OPEN_SDS+6

      457     5755        /*      Free up the DCB used to obtain the subschema SET info  */
      458     5756    3           FPT_RELDCB.V.DCB# = SUBDCB;

   5756  5 000207   000044 720000 1                  LXL0    SUBDCB
         5 000210   002164 740000 1                  STX0    FPT_RELDCB+2

      459     5757    3           CALL M$RELDCB(FPT_RELDCB);

   5757  5 000211   002162 630400 1                  EPPR0   FPT_RELDCB
         5 000212   060003 713400                    CLIMB   24579
         5 000213   400000 401760                    pmme    nvectors=1

      460     5758    3           END;

      461     5759    2       CALL M$OPEN(OPEN_SDS)

   5759  5 000214   002166 630400 1                  EPPR0   OPEN_SDS
         5 000215   450000 713400                    CLIMB   alt,open
         5 000216   410400 401760                    pmme    nvectors=18
         5 000217   000262 702000 5                  TSX2    s:5779

      462     5760    3       WHENRETURN DO;

      463     5761        /*  Check to determine whether the RVA data segment predates the
      464     5762            subschema file.  If so, access is denied. */
      465     5763    3           J=1;

   5763  5 000220   000001 235007                    LDA     1,DL
         5 000221   000005 755000 1                  STA     J

      466     5764    3           FIT$ = ADDR(FPBUF);

   5764  5 000222   000013 236000 6                  LDQ     11
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:97   
         5 000223   200027 756100                    STQ     FIT$,,AUTO

      467     5765    4           DO WHILE(FIT$->FM$FIT.CODES.CODE(J)~=4);

   5765  5 000224   200027 470500                    LDP0    FIT$,,AUTO
         5 000225   000000 236105                    LDQ     0,AL,PR0
         5 000226   760000 376003                    ANQ     -8192,DU
         5 000227   100000 116003                    CMPQ    32768,DU
         5 000230   000240 600000 5                  TZE     s:5768

      468     5766    4               J = J + 1;

   5766  5 000231   000005 054000 1                  AOS     J

      469     5767    4               END;

   5767  5 000232   200027 470500                    LDP0    FIT$,,AUTO
         5 000233   000005 720000 1                  LXL0    J
         5 000234   000000 236110                    LDQ     0,X0,PR0
         5 000235   760000 376003                    ANQ     -8192,DU
         5 000236   100000 116003                    CMPQ    32768,DU
         5 000237   000231 601000 5                  TNZ     s:5766

      470     5768    3           FIT$ = PINCRW(FIT$, FIT$->FM$FIT.CODES.ITEMX(J));

   5768  5 000240   000005 720000 1                  LXL0    J
         5 000241   000000 721110                    LXL1    0,X0,PR0
         5 000242   001777 361003                    ANX1    1023,DU
         5 000243   000000 636011                    EAQ     0,X1
         5 000244   200027 036100                    ADLQ    FIT$,,AUTO
         5 000245   200027 756100                    STQ     FIT$,,AUTO

      471     5769    4           IF FIT$->CODE04.CREATION.TIME < IA.SSTDT(1) THEN DO;

   5769  5 000246   200027 470500                    LDP0    FIT$,,AUTO
         5 000247   002051 471400 1                  LDP1    IA$
         5 000250   000002 236100                    LDQ     2,,PR0
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:98   
         5 000251   100055 116100                    CMPQ    45,,PR1
         5 000252   000261 603000 5                  TRC     s:5775

      472     5770    4               CALL ARG_ERROR(5013);

   5770  5 000253   000017 236000 6                  LDQ     15
         5 000254   200037 756100                    STQ     @A,,AUTO
         5 000255   000715 701000 5                  TSX1    ARG_ERROR
         5 000256   000000 011000                    NOP     0

      473     5771        /*E*   ERROR:   ZII-5013-1
      474     5772              MESSAGE:  RVA data segment file predates subschema file. */
      475     5773    4               CALL M$XXX;

   5773  5 000257   000003 713400                    CLIMB   3
         5 000260   000000 401760                    pmme    nvectors=0

      476     5774    4               END;

      477     5775    3           END;

   5775  5 000261   000270 710000 5                  TRA     s:5782

      478     5776    3       WHENALTRETURN DO;

      479     5777        /*E*   ERROR:   ZII-5014-1
      480     5778              MESSAGE:  Unable to open RVA shared data segment file. */
      481     5779    3           CALL ARG_ERROR(5014);

   5779  5 000262   000021 236000 6                  LDQ     17
         5 000263   200037 756100                    STQ     @A,,AUTO
         5 000264   000715 701000 5                  TSX1    ARG_ERROR
         5 000265   000000 011000                    NOP     0

      482     5780    3           CALL M$MERC;

   5780  5 000266   010007 713400                    CLIMB   4103
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:99   
         5 000267   000000 401760                    pmme    nvectors=0

      483     5781    3           END;

      484     5782    2       RETURN;

   5782  5 000270   200030 221300                    LDX1  ! FIT$+1,,AUTO
         5 000271   000001 702211                    TSX2  ! 1,X1

      485     5783    2   END SDS$OPEN;
      486     5784         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:100  
      487     5785        /******************************************************************/
      488     5786        /*                                                                */
      489     5787        /*      INTERNAL SUBROUTINE  CHK_ARG                              */
      490     5788        /*                                                                */
      491     5789        /******************************************************************/
      492     5790    1   CHK_ARG: PROC(A) ALTRET;

   5790  5 000272   200034 741300       CHK_ARG      STX1  ! @RLCW+1,,AUTO

      493     5791
      494     5792    2   DCL A UBIN;
      495     5793
      496     5794    2       FPTS.V.ARG(NO_ARGS)=ADDR(A);

   5794  5 000273   200035 236100                    LDQ     @A,,AUTO
         5 000274   002054 470400 1                  LDP0    FPT$
         5 000275   000014 720000 1                  LXL0    NO_ARGS
         5 000276   000051 756110                    STQ     41,X0,PR0

      497     5795    2       IF ADDR(A)=ADDR(NIL) THEN ALTRETURN;

   5795  5 000277   000015 116000 6                  CMPQ    13
         5 000300   000303 601000 5                  TNZ     s:5796

   5795  5 000301   200034 221300                    LDX1  ! @RLCW+1,,AUTO
         5 000302   000000 702211                    TSX2  ! 0,X1

      498     5796    2       CALL P_OFF_W(ADDR(A),RVA$);

   5796  5 000303   200100 756100                    STQ     ERRMSG_BUF+32,,AUTO
         5 000304   000022 236000 6                  LDQ     18
         5 000305   200040 756100                    STQ     @B,,AUTO
         5 000306   200100 631500                    EPPR1   ERRMSG_BUF+32,,AUTO
         5 000307   200037 451500                    STP1    @A,,AUTO
         5 000310   000003 701000 5                  TSX1    P_OFF_W
         5 000311   000000 011000                    NOP     0

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:101  
      499     5797    2       IF I>0 AND I<=RVA_SIZE THEN

   5797  5 000312   000003 235000 1                  LDA     I
         5 000313   000337 604400 5                  TMOZ    s:5804
         5 000314   000003 236000 1                  LDQ     I
         5 000315   002047 116000 1                  CMPQ    RVA_SIZE
         5 000316   000337 605400 5                  TPNZ    s:5804

      500     5798    3       DO;

      501     5799    3           ARG.OFFSET(NO_ARGS)=I;

   5799  5 000317   000000 620006                    EAX0    0,QL
         5 000320   002055 470400 1                  LDP0    ARG$
         5 000321   000014 721000 1                  LXL1    NO_ARGS
         5 000322   000000 740111                    STX0    0,X1,PR0

      502     5800    3           ARG.TYPE(NO_ARGS)=%AREA_NAME+RVA_TYPE(I);

   5800  5 000323   000003 235000 1                  LDA     I
         5 000324   000001 735000                    ALS     1
         5 000325   000327 605000 5                  TPL     s:5800+4
         5 000326   000044 035003                    ADLA    36,DU
         5 000327   002061 471400 1                  LDP1    TYPE$
         5 000330   003100 061505                    CSR     bolr='003'O
         5 000331   100000 000002                    BDSC    0,A,PR1                  by=0,bit=0,n=2
         5 000332   200076 000022                    BDSC    ERRMSG_BUF+30,,AUTO      by=0,bit=0,n=18
         5 000333   200076 220100                    LDX0    ERRMSG_BUF+30,,AUTO
         5 000334   000037 622010                    EAX2    31,X0
         5 000335   000000 442111                    SXL2    0,X1,PR0

      503     5801    3           END;

   5801  5 000336   000532 710000 5                  TRA     s:5842

      504     5802    2       ELSE
      505     5803    3       DO;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:102  

      506     5804    3           CALL P_OFF_W(ADDR(A),ADDR(SNA));

   5804  5 000337   200035 236100                    LDQ     @A,,AUTO
         5 000340   200101 756100                    STQ     ERRMSG_BUF+33,,AUTO
         5 000341   000023 236000 6                  LDQ     19
         5 000342   200102 756100                    STQ     ERRMSG_BUF+34,,AUTO
         5 000343   200102 630500                    EPPR0   ERRMSG_BUF+34,,AUTO
         5 000344   200040 450500                    STP0    @B,,AUTO
         5 000345   200101 631500                    EPPR1   ERRMSG_BUF+33,,AUTO
         5 000346   200037 451500                    STP1    @A,,AUTO
         5 000347   000003 701000 5                  TSX1    P_OFF_W
         5 000350   000000 011000                    NOP     0

      507     5805    3           IF I>=0 AND I<%SNA_SIZE THEN

   5805  5 000351   000003 235000 1                  LDA     I
         5 000352   000363 604000 5                  TMI     s:5809
         5 000353   000036 115007                    CMPA    30,DL
         5 000354   000363 605000 5                  TPL     s:5809

      508     5806    3               ARG.TYPE(NO_ARGS)=A;

   5806  5 000355   200035 470500                    LDP0    @A,,AUTO
         5 000356   000000 720100                    LXL0    0,,PR0
         5 000357   002055 471400 1                  LDP1    ARG$
         5 000360   000014 721000 1                  LXL1    NO_ARGS
         5 000361   100000 440111                    SXL0    0,X1,PR1
         5 000362   000532 710000 5                  TRA     s:5842

      509     5807    3           ELSE
      510     5808    4           DO;

      511     5809    4               CALL P_OFF_W(ADDR(A),UWA$);

   5809  5 000363   200035 236100                    LDQ     @A,,AUTO
         5 000364   200103 756100                    STQ     ERRMSG_BUF+35,,AUTO
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:103  
         5 000365   000024 236000 6                  LDQ     20
         5 000366   200040 756100                    STQ     @B,,AUTO
         5 000367   200103 630500                    EPPR0   ERRMSG_BUF+35,,AUTO
         5 000370   200037 450500                    STP0    @A,,AUTO
         5 000371   000003 701000 5                  TSX1    P_OFF_W
         5 000372   000000 011000                    NOP     0

      512     5810    4               ARG.TYPE(NO_ARGS)=%ELSE_NAME;

   5810  5 000373   000001 220003                    LDX0    1,DU
         5 000374   002055 470400 1                  LDP0    ARG$
         5 000375   000014 721000 1                  LXL1    NO_ARGS
         5 000376   000000 440111                    SXL0    0,X1,PR0

      513     5811    4               IF I>=48 AND I<UWA_SIZE THEN

   5811  5 000377   000003 235000 1                  LDA     I
         5 000400   000060 115007                    CMPA    48,DL
         5 000401   000532 604000 5                  TMI     s:5842
         5 000402   000003 236000 1                  LDQ     I
         5 000403   002046 116000 1                  CMPQ    UWA_SIZE
         5 000404   000532 605000 5                  TPL     s:5842

      514     5812    5               DO;

      515     5813    5                   I=POFFC(ADDR(A),UWA$)*2;

   5813  5 000405   200035 236100                    LDQ     @A,,AUTO
         5 000406   000020 772000                    QRL     16
         5 000407   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 000410   002052 236000 1                  LDQ     UWA$
         5 000411   000020 772000                    QRL     16
         5 000412   200077 756100                    STQ     ERRMSG_BUF+31,,AUTO
         5 000413   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 000414   200077 136100                    SBLQ    ERRMSG_BUF+31,,AUTO
         5 000415   000001 736000                    QLS     1
         5 000416   000003 756000 1                  STQ     I
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:104  

      516     5814    5                   LOW=2;

   5814  5 000417   000002 235007                    LDA     2,DL
         5 000420   000040 755000 1                  STA     II

      517     5815    5                   HIGH=RVA_SIZE-1;

   5815  5 000421   002047 235000 1                  LDA     RVA_SIZE
         5 000422   000001 135007                    SBLA    1,DL
         5 000423   000041 755000 1                  STA     JJ

      518     5816    5   BINARY_SEARCH: /* BINARY SEARCH THRU RVA */
      519     5817    5                   IF LOW>HIGH THEN CALL ARG_ERROR(2);

   5817  5 000424   000040 236000 1     BINARY_SEAR* LDQ     II
         5 000425   000041 116000 1                  CMPQ    JJ
         5 000426   000433 604400 5                  TMOZ    s:5820

   5817  5 000427   000026 236000 6                  LDQ     22
         5 000430   200037 756100                    STQ     @A,,AUTO
         5 000431   000715 701000 5                  TSX1    ARG_ERROR
         5 000432   000000 011000                    NOP     0

      520     5818        /*     ERROR:  ZII-2-1
      521     5819              MESSAGE: RVA and UWA are inconsistent.   */
      522     5820    5                   K=LOW+(HIGH-LOW)/2;

   5820  5 000433   000041 236000 1                  LDQ     JJ
         5 000434   000040 136000 1                  SBLQ    II
         5 000435   000002 506007                    DIV     2,DL
         5 000436   000040 036000 1                  ADLQ    II
         5 000437   000004 756000 1                  STQ     K

      523     5821    5                   J=RVA(K);

   5821  5 000440   002053 470400 1                  LDP0    RVA$
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:105  
         5 000441   000000 235106                    LDA     0,QL,PR0
         5 000442   000005 755000 1                  STA     J

      524     5822    5                   IF REDEF_J.NAME<I THEN

   5822  5 000443   000005 236000 1                  LDQ     J
         5 000444   000022 736000                    QLS     18
         5 000445   000022 732000                    QRS     18
         5 000446   000003 116000 1                  CMPQ    I
         5 000447   000454 605000 5                  TPL     s:5827

      525     5823    6                   DO;

      526     5824    6                       LOW=K+1;

   5824  5 000450   000004 235000 1                  LDA     K
         5 000451   000001 035007                    ADLA    1,DL
         5 000452   000040 755000 1                  STA     II

      527     5825    6                       GOTO BINARY_SEARCH;

   5825  5 000453   000424 710000 5                  TRA     BINARY_SEARCH

      528     5826    6                       END;
      529     5827    5                   IF REDEF_J.NAME>I THEN

   5827  5 000454   000461 604400 5                  TMOZ    s:5832

      530     5828    6                   DO;

      531     5829    6                       HIGH=K-1;

   5829  5 000455   000004 235000 1                  LDA     K
         5 000456   000001 135007                    SBLA    1,DL
         5 000457   000041 755000 1                  STA     JJ

      532     5830    6                       GOTO BINARY_SEARCH;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:106  

   5830  5 000460   000424 710000 5                  TRA     BINARY_SEARCH

      533     5831    6                       END;
      534     5832    5                   IF RVA_TYPE(K)=%RECORD_NAME_NET THEN

   5832  5 000461   000004 235000 1                  LDA     K
         5 000462   000001 735000                    ALS     1
         5 000463   000465 605000 5                  TPL     s:5832+4
         5 000464   000044 035003                    ADLA    36,DU
         5 000465   002061 471400 1                  LDP1    TYPE$
         5 000466   003100 061505                    CSR     bolr='003'O
         5 000467   100000 000002                    BDSC    0,A,PR1                  by=0,bit=0,n=2
         5 000470   200076 000044                    BDSC    ERRMSG_BUF+30,,AUTO      by=0,bit=0,n=36
         5 000471   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 000472   000002 116007                    CMPQ    2,DL
         5 000473   000513 601000 5                  TNZ     s:5837

      535     5833    6                   DO;

      536     5834    6                       K=K+1;

   5834  5 000474   000004 054000 1                  AOS     K

      537     5835    6                       IF RVA_TYPE(K)=%RECORD_NAME_NET THEN CALL ARG_ERROR(2);

   5835  5 000475   000004 235000 1                  LDA     K
         5 000476   000001 735000                    ALS     1
         5 000477   000501 605000 5                  TPL     s:5835+4
         5 000500   000044 035003                    ADLA    36,DU
         5 000501   003100 061505                    CSR     bolr='003'O
         5 000502   100000 000002                    BDSC    0,A,PR1                  by=0,bit=0,n=2
         5 000503   200076 000044                    BDSC    ERRMSG_BUF+30,,AUTO      by=0,bit=0,n=36
         5 000504   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 000505   000002 116007                    CMPQ    2,DL
         5 000506   000513 601000 5                  TNZ     s:5837

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:107  
   5835  5 000507   000026 236000 6                  LDQ     22
         5 000510   200037 756100                    STQ     @A,,AUTO
         5 000511   000715 701000 5                  TSX1    ARG_ERROR
         5 000512   000000 011000                    NOP     0

      538     5836    6                       END;

      539     5837    5                   ARG.OFFSET(NO_ARGS)=K;

   5837  5 000513   000004 720000 1                  LXL0    K
         5 000514   002055 470400 1                  LDP0    ARG$
         5 000515   000014 721000 1                  LXL1    NO_ARGS
         5 000516   000000 740111                    STX0    0,X1,PR0

      540     5838    5                   ARG.TYPE(NO_ARGS)=%AREA_NAME+RVA_TYPE(K);

   5838  5 000517   000004 235000 1                  LDA     K
         5 000520   000001 735000                    ALS     1
         5 000521   000523 605000 5                  TPL     s:5838+4
         5 000522   000044 035003                    ADLA    36,DU
         5 000523   002061 471400 1                  LDP1    TYPE$
         5 000524   003100 061505                    CSR     bolr='003'O
         5 000525   100000 000002                    BDSC    0,A,PR1                  by=0,bit=0,n=2
         5 000526   200076 000022                    BDSC    ERRMSG_BUF+30,,AUTO      by=0,bit=0,n=18
         5 000527   200076 222100                    LDX2    ERRMSG_BUF+30,,AUTO
         5 000530   000037 623012                    EAX3    31,X2
         5 000531   000000 443111                    SXL3    0,X1,PR0

      541     5839    5                   END;

      542     5840    4               END;

      543     5841    3           END;

      544     5842    2       NO_ARGS=NO_ARGS+1;

   5842  5 000532   000014 054000 1                  AOS     NO_ARGS
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:108  

      545     5843    2   END CHK_ARG;

   5843  5 000533   200034 221300                    LDX1  ! @RLCW+1,,AUTO
         5 000534   000001 702211                    TSX2  ! 1,X1

      546     5844         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:109  
      547     5845        /************************************************************/
      548     5846        /*                                                          */
      549     5847        /*    INTERNAL SUBROUTINE TO SETUP ARG'S LIST               */
      550     5848        /*                                                          */
      551     5849        /*    1. DETERMINE THE NUMBER OF PARAMETERS PASSED          */
      552     5850        /*    2. SAVE EACH ARG'S ADDRESS, AND CONVERT INTO RVA ADDR */
      553     5851        /*       IF IT IS A FIELD-NAME                              */
      554     5852        /*                                                          */
      555     5853        /************************************************************/
      556     5854
      557     5855    1   SET_ARGS: PROC;

   5855  5 000535   200032 741300       SET_ARGS     STX1  ! @B,,AUTO

      558     5856
      559     5857    2       IA_HALF(13)=AUTO_FRAME(-2*(AUTO_FRAME(1)+1));

   5857  5 000536   000010 470400 1                  LDP0    AUTO$
         5 000537   003100 060500                    CSL     bolr='003'O
         5 000540   000000 400022                    BDSC    0,,PR0                   by=2,bit=0,n=18
         5 000541   200076 000044                    BDSC    ERRMSG_BUF+30,,AUTO      by=0,bit=0,n=36
         5 000542   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 000543   000022 732000                    QRS     18
         5 000544   000027 402000 6                  MPY     23
         5 000545   000000 116003                    CMPQ    0,DU
         5 000546   000550 605000 5                  TPL     s:5857+10
         5 000547   000044 036003                    ADLQ    36,DU
         5 000550   002051 471400 1                  LDP1    IA$
         5 000551   003100 060506                    CSL     bolr='003'O
         5 000552   077777 000022                    BDSC    -1,Q,PR0                 by=0,bit=0,n=18
         5 000553   100006 400022                    BDSC    6,,PR1                   by=2,bit=0,n=18
         5 000554   000556 710000 5                  TRA     s:5859

      560     5858    2   SET_ARGS1: ENTRY; /* FOR USEPROC, CALLED BEFORE INVOKE */

   5858  5 000555   200032 741300       SET_ARGS1    STX1  ! @B,,AUTO

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:110  
      561     5859    2       IF PAGE_VECTOR.ADR=ADDR(NIL) THEN CALL ARG_ERROR(10);

   5859  5 000556   002063 236000 1                  LDQ     PAGE_VECTOR+1
         5 000557   000015 116000 6                  CMPQ    13
         5 000560   000565 601000 5                  TNZ     s:5862

   5859  5 000561   000031 236000 6                  LDQ     25
         5 000562   200037 756100                    STQ     @A,,AUTO
         5 000563   000715 701000 5                  TSX1    ARG_ERROR
         5 000564   000000 011000                    NOP     0

      562     5860        /*    ERROR: ZII-10-7
      563     5861              MESSAGE: INVOKE CALL is not performed as your 1st IDS statement.  */
      564     5862    2       NO_ARGS=0;

   5862  5 000565   000014 450000 1                  STZ     NO_ARGS

      565     5863            %GEN_PARAMS(TYPE=2); /* CALL CHK_ARG(A1 TO A20); */

   5883  5 000566   200003 236100                    LDQ     @A1,,AUTO
         5 000567   200035 756100                    STQ     @A,,AUTO
         5 000570   000272 701000 5                  TSX1    CHK_ARG
         5 000571   000706 702000 5                  TSX2    END_OF_ARGS

   5908  5 000572   200004 236100                    LDQ     @A2,,AUTO
         5 000573   200035 756100                    STQ     @A,,AUTO
         5 000574   000272 701000 5                  TSX1    CHK_ARG
         5 000575   000706 702000 5                  TSX2    END_OF_ARGS

   5933  5 000576   200005 236100                    LDQ     @A3,,AUTO
         5 000577   200035 756100                    STQ     @A,,AUTO
         5 000600   000272 701000 5                  TSX1    CHK_ARG
         5 000601   000706 702000 5                  TSX2    END_OF_ARGS

   5958  5 000602   200006 236100                    LDQ     @A4,,AUTO
         5 000603   200035 756100                    STQ     @A,,AUTO
         5 000604   000272 701000 5                  TSX1    CHK_ARG
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:111  
         5 000605   000706 702000 5                  TSX2    END_OF_ARGS

   5983  5 000606   200007 236100                    LDQ     @A5,,AUTO
         5 000607   200035 756100                    STQ     @A,,AUTO
         5 000610   000272 701000 5                  TSX1    CHK_ARG
         5 000611   000706 702000 5                  TSX2    END_OF_ARGS

   6008  5 000612   200010 236100                    LDQ     @A6,,AUTO
         5 000613   200035 756100                    STQ     @A,,AUTO
         5 000614   000272 701000 5                  TSX1    CHK_ARG
         5 000615   000706 702000 5                  TSX2    END_OF_ARGS

   6033  5 000616   200011 236100                    LDQ     @A7,,AUTO
         5 000617   200035 756100                    STQ     @A,,AUTO
         5 000620   000272 701000 5                  TSX1    CHK_ARG
         5 000621   000706 702000 5                  TSX2    END_OF_ARGS

   6058  5 000622   200012 236100                    LDQ     @A8,,AUTO
         5 000623   200035 756100                    STQ     @A,,AUTO
         5 000624   000272 701000 5                  TSX1    CHK_ARG
         5 000625   000706 702000 5                  TSX2    END_OF_ARGS

   6083  5 000626   200013 236100                    LDQ     @A9,,AUTO
         5 000627   200035 756100                    STQ     @A,,AUTO
         5 000630   000272 701000 5                  TSX1    CHK_ARG
         5 000631   000706 702000 5                  TSX2    END_OF_ARGS

   6108  5 000632   200014 236100                    LDQ     @A10,,AUTO
         5 000633   200035 756100                    STQ     @A,,AUTO
         5 000634   000272 701000 5                  TSX1    CHK_ARG
         5 000635   000706 702000 5                  TSX2    END_OF_ARGS

   6133  5 000636   200015 236100                    LDQ     @A11,,AUTO
         5 000637   200035 756100                    STQ     @A,,AUTO
         5 000640   000272 701000 5                  TSX1    CHK_ARG
         5 000641   000706 702000 5                  TSX2    END_OF_ARGS

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:112  
   6158  5 000642   200016 236100                    LDQ     @A12,,AUTO
         5 000643   200035 756100                    STQ     @A,,AUTO
         5 000644   000272 701000 5                  TSX1    CHK_ARG
         5 000645   000706 702000 5                  TSX2    END_OF_ARGS

   6183  5 000646   200017 236100                    LDQ     @A13,,AUTO
         5 000647   200035 756100                    STQ     @A,,AUTO
         5 000650   000272 701000 5                  TSX1    CHK_ARG
         5 000651   000706 702000 5                  TSX2    END_OF_ARGS

   6208  5 000652   200020 236100                    LDQ     @A14,,AUTO
         5 000653   200035 756100                    STQ     @A,,AUTO
         5 000654   000272 701000 5                  TSX1    CHK_ARG
         5 000655   000706 702000 5                  TSX2    END_OF_ARGS

   6233  5 000656   200021 236100                    LDQ     @A15,,AUTO
         5 000657   200035 756100                    STQ     @A,,AUTO
         5 000660   000272 701000 5                  TSX1    CHK_ARG
         5 000661   000706 702000 5                  TSX2    END_OF_ARGS

   6258  5 000662   200022 236100                    LDQ     @A16,,AUTO
         5 000663   200035 756100                    STQ     @A,,AUTO
         5 000664   000272 701000 5                  TSX1    CHK_ARG
         5 000665   000706 702000 5                  TSX2    END_OF_ARGS

   6283  5 000666   200023 236100                    LDQ     @A17,,AUTO
         5 000667   200035 756100                    STQ     @A,,AUTO
         5 000670   000272 701000 5                  TSX1    CHK_ARG
         5 000671   000706 702000 5                  TSX2    END_OF_ARGS

   6308  5 000672   200024 236100                    LDQ     @A18,,AUTO
         5 000673   200035 756100                    STQ     @A,,AUTO
         5 000674   000272 701000 5                  TSX1    CHK_ARG
         5 000675   000706 702000 5                  TSX2    END_OF_ARGS

   6333  5 000676   200025 236100                    LDQ     @A19,,AUTO
         5 000677   200035 756100                    STQ     @A,,AUTO
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:113  
         5 000700   000272 701000 5                  TSX1    CHK_ARG
         5 000701   000706 702000 5                  TSX2    END_OF_ARGS

   6358  5 000702   200026 236100                    LDQ     @A020,,AUTO
         5 000703   200035 756100                    STQ     @A,,AUTO
         5 000704   000272 701000 5                  TSX1    CHK_ARG
         5 000705   000706 702000 5                  TSX2    END_OF_ARGS

      566     6404    2   END_OF_ARGS: ADDR(FPTS.V)->CLEAR_BITS='0'B;

   6404  5 000706   002054 470400 1     END_OF_ARGS  LDP0    FPT$
         5 000707   000013 720000 1                  LXL0    NINE_WORDS
         5 000710   003140 060400                    CSL     bolr='003'O
         5 000711   000032 000001 6                  BDSC    26                       by=0,bit=0,n=1
         5 000712   000012 000010                    BDSC    10,,PR0                  by=0,bit=0,n=*X0

      567     6405
      568     6406    2   END SET_ARGS;

   6406  5 000713   200032 221300                    LDX1  ! @B,,AUTO
         5 000714   000001 702211                    TSX2  ! 1,X1

      569     6407         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:114  
      570     6408        /*******************************************************************/
      571     6409        /*                                                                 */
      572     6410        /*    ARG_ERROR: READ ERROR MESSAGE AND ABORT THE JOB              */
      573     6411        /*                                                                 */
      574     6412        /*******************************************************************/
      575     6413
      576     6414    1   ARG_ERROR: PROC(ERR_NO);

   6414  5 000715   200036 741300       ARG_ERROR    STX1  ! @A+1,,AUTO

      577     6415
      578     6416    2   DCL ERR_NO UBIN;
      579     6417    2   DCL ERRMSG_BUF CHAR(120) AUTO ALIGNED;
      580     6418
      581     6419    2       ERR_CODE.ERR_NO=ERR_NO;

   6419  5 000716   200037 470500                    LDP0    @ERR_NO,,AUTO
         5 000717   000000 236100                    LDQ     0,,PR0
         5 000720   000003 736000                    QLS     3
         5 000721   002064 676000 1                  ERQ     ERR_CODE
         5 000722   777770 376007                    ANQ     -8,DL
         5 000723   002064 656000 1                  ERSQ    ERR_CODE

      582     6420    2       FPT_ERRMSG.BUF_=VECTOR(ERRMSG_BUF);

   6420  5 000724   000033 235000 6                  LDA     27
         5 000725   200076 452500                    STP2    ERRMSG_BUF+30,,AUTO
         5 000726   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 000727   000040 036003                    ADLQ    32,DU
         5 000730   002106 757000 1                  STAQ    FPT_ERRMSG+4

      583     6421    2       CALL M$ERRMSG(FPT_ERRMSG);

   6421  5 000731   002102 630400 1                  EPPR0   FPT_ERRMSG
         5 000732   020000 713400                    CLIMB   8192
         5 000733   405000 401760                    pmme    nvectors=11

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:115  
      584     6422    2       CALL M$ERR;

   6422  5 000734   000002 713400                    CLIMB   err
         5 000735   000000 401760                    pmme    nvectors=0

      585     6423    2   END ARG_ERROR;

   6423  5 000736   200036 221300                    LDX1  ! @A+1,,AUTO
         5 000737   000001 702211                    TSX2  ! 1,X1

      586     6424         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:116  
      587     6425        /****************************************************************/
      588     6426        /*                                                              */
      589     6427        /*    GET A PAGE OF DYNAMIC MEMORY AT THE VERY 1ST IDS CALL     */
      590     6428        /*                                                              */
      591     6429        /****************************************************************/
      592     6430
      593     6431    1   GET_A_PAGE: PROC;

   6431  5 000740   200030 741300       GET_A_PAGE   STX1  ! FIT$+1,,AUTO

      594     6432
      595     6433    2       CALL M$GDP(FPT_GDP) ALTRET(OUT_OF_MEMORY);

   6433  5 000741   002066 630400 1                  EPPR0   FPT_GDP
         5 000742   430003 713400                    CLIMB   alt,+12291
         5 000743   400400 401760                    pmme    nvectors=2
         5 000744   000767 702000 5                  TSX2    OUT_OF_MEMORY

      596     6434    2       FPT$=PAGE_VECTOR.ADR;

   6434  5 000745   002063 236000 1                  LDQ     PAGE_VECTOR+1
         5 000746   002054 756000 1                  STQ     FPT$

      597     6435    2       ARG$=ADDR(FPTS.V.FPARAM(0));

   6435  5 000747   000024 036003                    ADLQ    20,DU
         5 000750   002055 756000 1                  STQ     ARG$

      598     6436    2       RLCW$=PINCRW(FPT$,%FPT_SIZE);

   6436  5 000751   002054 236000 1                  LDQ     FPT$
         5 000752   000076 036003                    ADLQ    62,DU
         5 000753   002060 756000 1                  STQ     RLCW$

      599     6437    2       TYPE$=PINCRW(RLCW$,%RLCW_SIZE);

   6437  5 000754   000013 036003                    ADLQ    11,DU
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:117  
         5 000755   002061 756000 1                  STQ     TYPE$

      600     6438    2       FPTS.V_=VECTOR(FPTS.V);

   6438  5 000756   000034 235000 6                  LDA     28
         5 000757   002054 236000 1                  LDQ     FPT$
         5 000760   000012 036003                    ADLQ    10,DU
         5 000761   002054 470400 1                  LDP0    FPT$
         5 000762   000000 757100                    STAQ    0,,PR0

      601     6439    2       FPT_ERRMSG.BUF_=FPTS.V_; /* M$ERRMSG USE THIS AREA TOO */

   6439  5 000763   000000 237100                    LDAQ    0,,PR0
         5 000764   002106 757000 1                  STAQ    FPT_ERRMSG+4

      602     6440    2       RETURN;

   6440  5 000765   200030 221300                    LDX1  ! FIT$+1,,AUTO
         5 000766   000001 702211                    TSX2  ! 1,X1

      603     6441
      604     6442        /*    ERROR: ZII-5-1
      605     6443              MESSAGE: Failed to get a dynamic page, core limit exceeded.  */
      606     6444
      607     6445    2   OUT_OF_MEMORY:
      608     6446    2       CALL ARG_ERROR(5);

   6446  5 000767   000036 236000 6     OUT_OF_MEMO* LDQ     30
         5 000770   200037 756100                    STQ     @ERR_NO,,AUTO
         5 000771   000715 701000 5                  TSX1    ARG_ERROR
         5 000772   000000 011000                    NOP     0

      609     6447    2   END GET_A_PAGE;

   6447  5 000773   200030 221300                    LDX1  ! FIT$+1,,AUTO
         5 000774   000001 702211                    TSX2  ! 1,X1
         5 000775   001000 710000 5                  TRA     s:7010
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:118  

      610     6448         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:119  
      611     6449        /****************************************************************/
      612     6450        /*                                                              */
      613     6451        /*    CALL PRIVACY(RECORD,IDS-NAME1,PRIVACY-KEY,REC-NAME)       */
      614     6452        /*                                                              */
      615     6453        /*      IDS-NAME1: CONNECT,DISCONNECT,STORE,ERASE               */
      616     6454        /*                 MODIFY,FIND,GET                              */
      617     6455        /*                                                              */
      618     6456        /*    CALL PRIVACY(SET,CONNECT,PRIVACY-KEY,SET-NAME1,....)      */
      619     6457        /*                     DISCONNECT                               */
      620     6458        /*                     FIND                                     */
      621     6459        /*                                                              */
      622     6460        /*    CALL PRIVACY(ITEM,MODIFY/GET,PRIVACY-KEY,ITEM-1,...)      */
      623     6461        /*                                                              */
      624     6462        /****************************************************************/
      625     6463
      626     6464    1   PRIVACY: ENTRY(

   6464  5 000776   000000 700200 xent  PRIVACY      TSX0  ! X66_AUTO_N
         5 000777   000106 000024                    ZERO    70,20

      627     6465               %GEN_PARAMS;
      628     7006
      629     7007        /*    ERROR: ZII-15-1
      630     7008              MESSAGE: Syntax error detected in PRIVACY CALL. */
      631     7009
      632     7010    1       CALL SET_ARGS;

   7010  5 001000   000535 701000 5                  TSX1    SET_ARGS
         5 001001   000000 011000                    NOP     0

      633     7011    1       IF A1(0)=SNA.SET THEN

   7011  5 001002   200003 470500                    LDP0    @A1,,AUTO
         5 001003   000100 100500                    MLR     fill='000'O
         5 001004   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         5 001005   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 001006   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:120  
         5 001007   000024 116000 0                  CMPQ    SNA+20
         5 001010   001014 601000 5                  TNZ     s:7014

      634     7012    1           K=1;

   7012  5 001011   000001 235007                    LDA     1,DL
         5 001012   000004 755000 1                  STA     K
         5 001013   001042 710000 5                  TRA     s:7022

      635     7013    1       ELSE
      636     7014    1           IF A1(0)=SNA.RECORD THEN

   7014  5 001014   000100 100500                    MLR     fill='000'O
         5 001015   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         5 001016   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 001017   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 001020   000022 116000 0                  CMPQ    SNA+18
         5 001021   001025 601000 5                  TNZ     s:7017

      637     7015    1               K=2;

   7015  5 001022   000002 235007                    LDA     2,DL
         5 001023   000004 755000 1                  STA     K
         5 001024   001042 710000 5                  TRA     s:7022

      638     7016    1           ELSE
      639     7017    1               IF A1(0)=SNA.ITEM THEN

   7017  5 001025   000100 100500                    MLR     fill='000'O
         5 001026   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         5 001027   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 001030   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 001031   000010 116000 0                  CMPQ    SNA+8
         5 001032   001036 601000 5                  TNZ     s:7020

      640     7018    1                   K=3;

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:121  
   7018  5 001033   000003 235007                    LDA     3,DL
         5 001034   000004 755000 1                  STA     K
         5 001035   001042 710000 5                  TRA     s:7022

      641     7019    1               ELSE
      642     7020    1                   CALL ARG_ERROR(15); /* UNKNOWN FIRST ARGUMENT */

   7020  5 001036   000040 236000 6                  LDQ     32
         5 001037   200037 756100                    STQ     @A+2,,AUTO
         5 001040   000715 701000 5                  TSX1    ARG_ERROR
         5 001041   000000 011000                    NOP     0

      643     7021
      644     7022    1       JJ=NO_ARGS-1; /* START FROM THE END OF ARG_LIST */

   7022  5 001042   000014 235000 1                  LDA     NO_ARGS
         5 001043   000001 135007                    SBLA    1,DL
         5 001044   000041 755000 1                  STA     JJ

      645     7023    2       DO WHILE(ARG.TYPE(JJ)-%SET_NAME+1=K);

   7023  5 001045   001050 710000 5                  TRA     s:7025

      646     7024    2           JJ=JJ-1;

   7024  5 001046   000001 336007                    LCQ     1,DL
         5 001047   000041 056000 1                  ASQ     JJ

      647     7025    2           END;

   7025  5 001050   002055 470400 1                  LDP0    ARG$
         5 001051   000041 720000 1                  LXL0    JJ
         5 001052   000000 236110                    LDQ     0,X0,PR0
         5 001053   777777 376007                    ANQ     -1,DL
         5 001054   000037 136007                    SBLQ    31,DL
         5 001055   000004 116000 1                  CMPQ    K
         5 001056   001046 600000 5                  TZE     s:7024
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:122  

      648     7026    1       IF (K<3 AND JJ=NO_ARGS-1) THEN

   7026  5 001057   000004 235000 1                  LDA     K
         5 001060   000003 115007                    CMPA    3,DL
         5 001061   001072 605000 5                  TPL     s:7032
         5 001062   000014 236000 1                  LDQ     NO_ARGS
         5 001063   000001 136007                    SBLQ    1,DL
         5 001064   000041 116000 1                  CMPQ    JJ
         5 001065   001072 601000 5                  TNZ     s:7032

      649     7027    2       DO; /* IN CASE NO REC OR SET SPECIFIED IN THE LIST */

      650     7028    2           ARG.OFFSET(NO_ARGS)=0; /* FOR ALL REC OR SETS */

   7028  5 001066   000000 221003                    LDX1    0,DU
         5 001067   000014 722000 1                  LXL2    NO_ARGS
         5 001070   000000 741112                    STX1    0,X2,PR0

      651     7029    2           NO_ARGS=NO_ARGS+1; /* MAKE A FAKE ARGUMENT */

   7029  5 001071   000014 054000 1                  AOS     NO_ARGS

      652     7030    2           END;

      653     7031
      654     7032    1       KK=USEP.M;

   7032  5 001072   002056 471400 1                  LDP1    USEP$
         5 001073   100000 236100                    LDQ     0,,PR1
         5 001074   000022 772000                    QRL     18
         5 001075   377777 376007                    ANQ     131071,DL
         5 001076   000042 756000 1                  STQ     KK

      655     7033    2       DO I=1 TO JJ-1; /* LOOP THRU IDS ROUTINE ADDR */

   7033  5 001077   000001 235007                    LDA     1,DL
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:123  
         5 001100   000003 755000 1                  STA     I
         5 001101   001177 710000 5                  TRA     s:7047+1

      656     7034    2           PT$=FPTS.V.ARG(I);

   7034  5 001102   002054 470400 1                  LDP0    FPT$
         5 001103   000003 720000 1                  LXL0    I
         5 001104   000051 236110                    LDQ     41,X0,PR0
         5 001105   000011 756000 1                  STQ     PT$

      657     7035    2           J=0;

   7035  5 001106   000005 450000 1                  STZ     J

      658     7036    3           DO WHILE(J<8 AND IDS_ADR(J)~=REDEF_PT.ADR);

   7036  5 001107   001111 710000 5                  TRA     s:7038

      659     7037    3               J=J+1;

   7037  5 001110   000005 054000 1                  AOS     J

      660     7038    3               END;

   7038  5 001111   000005 235000 1                  LDA     J
         5 001112   000010 115007                    CMPA    8,DL
         5 001113   001117 605000 5                  TPL     s:7039
         5 001114   000025 220005 1                  LDX0    IDS_ADR,AL
         5 001115   000011 100000 1                  CMPX0   PT$
         5 001116   001110 601000 5                  TNZ     s:7037

      661     7039    2           IF J=8 THEN CALL ARG_ERROR(15); /* UNKNOWN IDS ROUTINE */

   7039  5 001117   000005 235000 1                  LDA     J
         5 001120   000010 115007                    CMPA    8,DL
         5 001121   001126 601000 5                  TNZ     s:7040

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:124  
   7039  5 001122   000040 236000 6                  LDQ     32
         5 001123   200037 756100                    STQ     @A+2,,AUTO
         5 001124   000715 701000 5                  TSX1    ARG_ERROR
         5 001125   000000 011000                    NOP     0

      662     7040    3           DO II=JJ+1 TO NO_ARGS-1; /* LOOP THRU REC OR SET OR ITEM LIST */

   7040  5 001126   000041 235000 1                  LDA     JJ
         5 001127   000001 035007                    ADLA    1,DL
         5 001130   000040 755000 1                  STA     II
         5 001131   001173 710000 5                  TRA     s:7046+1

      663     7041    3               USEP.UC.UCW_PRV.PT(KK)=K;

   7041  5 001132   000042 235000 1                  LDA     KK
         5 001133   000001 735000                    ALS     1
         5 001134   002056 470400 1                  LDP0    USEP$
         5 001135   000004 236000 1                  LDQ     K
         5 001136   000033 736000                    QLS     27
         5 001137   000001 676105                    ERQ     1,AL,PR0
         5 001140   777000 376003                    ANQ     -512,DU
         5 001141   000001 656105                    ERSQ    1,AL,PR0

      664     7042    3               USEP.UC.UCW_PRV.PB(KK)=IDS_BIT9(J);

   7042  5 001142   000002 735000                    ALS     2
         5 001143   000005 236000 1                  LDQ     J
         5 001144   000105 100406                    MLR     fill='000'O
         5 001145   000035 000001 1                  ADSC9   IDS_BIT9,Q               cn=0,n=1
         5 001146   000001 200001                    ADSC9   1,A,PR0                  cn=1,n=1

      665     7043    3               USEP.UC.UCW_PRV.A(KK)=RVA_HALF(2*ARG.OFFSET(II)+1);

   7043  5 001147   000042 235000 1                  LDA     KK
         5 001150   000001 735000                    ALS     1
         5 001151   002055 471400 1                  LDP1    ARG$
         5 001152   000040 720000 1                  LXL0    II
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:125  
         5 001153   100000 236110                    LDQ     0,X0,PR1
         5 001154   000022 772000                    QRL     18
         5 001155   000002 736000                    QLS     2
         5 001156   000002 735000                    ALS     2
         5 001157   002053 473400 1                  LDP3    RVA$
         5 001160   000105 100506                    MLR     fill='000'O
         5 001161   300000 400002                    ADSC9   0,Q,PR3                  cn=2,n=2
         5 001162   000001 400002                    ADSC9   1,A,PR0                  cn=2,n=2

      666     7044    3               USEP.UC.ENT$(KK)=FPTS.V.ARG(JJ); /* USER PROCEDURE ADDR */

   7044  5 001163   000042 235000 1                  LDA     KK
         5 001164   000001 735000                    ALS     1
         5 001165   002054 473400 1                  LDP3    FPT$
         5 001166   000041 721000 1                  LXL1    JJ
         5 001167   300051 236111                    LDQ     41,X1,PR3
         5 001170   000002 756105                    STQ     2,AL,PR0

      667     7045    3               KK=KK+1;

   7045  5 001171   000042 054000 1                  AOS     KK

      668     7046    3               END;

   7046  5 001172   000040 054000 1                  AOS     II
         5 001173   000040 236000 1                  LDQ     II
         5 001174   000014 116000 1                  CMPQ    NO_ARGS
         5 001175   001132 604000 5                  TMI     s:7041

      669     7047    2           END;

   7047  5 001176   000003 054000 1                  AOS     I
         5 001177   000003 236000 1                  LDQ     I
         5 001200   000041 116000 1                  CMPQ    JJ
         5 001201   001102 604000 5                  TMI     s:7034

      670     7048    1       USEP.M=KK;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:126  

   7048  5 001202   002056 470400 1                  LDP0    USEP$
         5 001203   000042 236000 1                  LDQ     KK
         5 001204   000022 736000                    QLS     18
         5 001205   000000 676100                    ERQ     0,,PR0
         5 001206   377777 376003                    ANQ     131071,DU
         5 001207   000000 656100                    ERSQ    0,,PR0

      671     7049    1       RETURN;

   7049  5 001210   000000 702200 xent               TSX2  ! X66_ARET

      672     7050         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:127  
      673     7051        /**************************************************************/
      674     7052        /*                                                            */
      675     7053        /*    CALL USE(SUBROUTINE-NAME,ERROR-1,ERROR-2,...)           */
      676     7054        /*                                                            */
      677     7055        /*    1.   GENERATE ENTRY POINTS IN 'USEP' TABLE              */
      678     7056        /*    2.   SAVE SUBROUITNE ADDRESSES IN 'EPTR_SAVE' TABLE     */
      679     7057        /*                                                            */
      680     7058        /**************************************************************/
      681     7059
      682     7060    1   USEPROC: ENTRY(

   7060  5 001211   000000 700200 xent  USEPROC      TSX0  ! X66_AUTO_N
         5 001212   000106 000024                    ZERO    70,20

      683     7061               %GEN_PARAMS;
      684     7602
      685     7603    1       CALL SET_ARGS1;

   7603  5 001213   000555 701000 5                  TSX1    SET_ARGS1
         5 001214   000000 011000                    NOP     0

      686     7604    2       DO I=1 TO NO_ARGS-1;

   7604  5 001215   000001 235007                    LDA     1,DL
         5 001216   000003 755000 1                  STA     I
         5 001217   001276 710000 5                  TRA     s:7613+1

      687     7605    2           IF ARG.TYPE(I)=SNA.ALL THEN

   7605  5 001220   002055 470400 1                  LDP0    ARG$
         5 001221   000003 720000 1                  LXL0    I
         5 001222   000000 236110                    LDQ     0,X0,PR0
         5 001223   777777 376007                    ANQ     -1,DL
         5 001224   000000 116000 0                  CMPQ    SNA
         5 001225   001230 601000 5                  TNZ     s:7608

      688     7606    2               J=0; /* USEPROC FOR ALL OTHERS */
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:128  

   7606  5 001226   000005 450000 1                  STZ     J
         5 001227   001235 710000 5                  TRA     s:7609

      689     7607    2           ELSE
      690     7608    2               CALL CHARBIN(J,FPTS.V.ARG(I)->CHAR7);

   7608  5 001230   002054 471400 1                  LDP1    FPT$
         5 001231   100051 473510                    LDP3    41,X0,PR1
         5 001232   000000 305500                    DTB
         5 001233   300000 030007                    NDSC9   0,,PR3                   cn=0,s=nosgn,sf=0,n=7
         5 001234   000005 000004 1                  NDSC9   J                        cn=0,s=lsgnf,sf=0,n=4

      691     7609    2           USEP.UC.UCW_USE.PT(USEP.M)=6;

   7609  5 001235   002056 471400 1                  LDP1    USEP$
         5 001236   100000 221100                    LDX1    0,,PR1
         5 001237   377777 361003                    ANX1    131071,DU
         5 001240   000000 635011                    EAA     0,X1
         5 001241   000021 771000                    ARL     17
         5 001242   100001 236105                    LDQ     1,AL,PR1
         5 001243   000041 376000 6                  ANQ     33
         5 001244   006000 276003                    ORQ     3072,DU
         5 001245   100001 756105                    STQ     1,AL,PR1

      692     7610    2           USEP.UC.UCW_USE.CODE(USEP.M)=J;

   7610  5 001246   100000 220100                    LDX0    0,,PR1
         5 001247   377777 360003                    ANX0    131071,DU
         5 001250   000000 635010                    EAA     0,X0
         5 001251   000021 771000                    ARL     17
         5 001252   000005 236000 1                  LDQ     J
         5 001253   100001 676105                    ERQ     1,AL,PR1
         5 001254   000041 376000 6                  ANQ     33
         5 001255   100001 656105                    ERSQ    1,AL,PR1

      693     7611    2           USEP.UC.ENT$(USEP.M)=FPTS.V.ARG(0);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:129  

   7611  5 001256   100000 220100                    LDX0    0,,PR1
         5 001257   377777 360003                    ANX0    131071,DU
         5 001260   000000 635010                    EAA     0,X0
         5 001261   000021 771000                    ARL     17
         5 001262   002054 473400 1                  LDP3    FPT$
         5 001263   300051 236100                    LDQ     41,,PR3
         5 001264   100002 756105                    STQ     2,AL,PR1

      694     7612    2           USEP.M=USEP.M+1;

   7612  5 001265   100000 236100                    LDQ     0,,PR1
         5 001266   000022 772000                    QRL     18
         5 001267   377777 376007                    ANQ     131071,DL
         5 001270   000001 036007                    ADLQ    1,DL
         5 001271   000022 736000                    QLS     18
         5 001272   100000 676100                    ERQ     0,,PR1
         5 001273   377777 376003                    ANQ     131071,DU
         5 001274   100000 656100                    ERSQ    0,,PR1

      695     7613    2           END;

   7613  5 001275   000003 054000 1                  AOS     I
         5 001276   000003 236000 1                  LDQ     I
         5 001277   000014 116000 1                  CMPQ    NO_ARGS
         5 001300   001220 604000 5                  TMI     s:7605

      696     7614    1       RETURN;

   7614  5 001301   000000 702200 xent               TSX2  ! X66_ARET

      697     7615         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:130  
      698     7616        /****************************************************************/
      699     7617        /*                                                              */
      700     7618        /*    CALL RETAIN( AREA                               )         */
      701     7619        /*                 SETS                                         */
      702     7620        /*                 RECORD                                       */
      703     7621        /*                 SET-NAME1,SET-NAME2,.....                    */
      704     7622        /*                                                              */
      705     7623        /*         1.  SAVE RETAINING CONTROL LIST.                     */
      706     7624        /*         2.  SET SWITCH ON, RETAINING LIST WILL BE USED ON    */
      707     7625        /*             NEXT IDS CALL WITH RETAIN CURRENCY OPTION        */
      708     7626        /*                                                              */
      709     7627        /****************************************************************/
      710     7628
      711     7629    1   RETAIN: ENTRY(

   7629  5 001302   000000 700200 xent  RETAIN       TSX0  ! X66_AUTO_N
         5 001303   000106 000024                    ZERO    70,20

      712     7630               %GEN_PARAMS;
      713     8171
      714     8172    1       ADDR(RLCW_SAVE)->SBIN36=0;

   8172  5 001304   002060 470400 1                  LDP0    RLCW$
         5 001305   000000 450100                    STZ     0,,PR0

      715     8173    1       CALL SET_ARGS;

   8173  5 001306   000535 701000 5                  TSX1    SET_ARGS
         5 001307   000000 011000                    NOP     0

      716     8174        /*    ERROR: ZII-20-1
      717     8175              MESSAGE: Syntax error in RETAIN CALL.  */
      718     8176    1       K=0;

   8176  5 001310   000004 450000 1                  STZ     K

      719     8177    2       DO WHILE (K<NO_ARGS);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:131  

   8177  5 001311   000004 236000 1                  LDQ     K
         5 001312   000014 116000 1                  CMPQ    NO_ARGS
         5 001313   001375 605000 5                  TPL     s:8196

      720     8178    2           IF ARG.TYPE(K)=%SET_NAME THEN

   8178  5 001314   002055 470400 1                  LDP0    ARG$
         5 001315   000004 720000 1                  LXL0    K
         5 001316   000000 721110                    LXL1    0,X0,PR0
         5 001317   000040 101003                    CMPX1   32,DU
         5 001320   001341 601000 5                  TNZ     s:8184

      721     8179    3           DO;

      722     8180    3               RLCW_SAVE.RETAIN_LIST(RLCW_SAVE.N_SETS#)=ARG.OFFSET(K);

   8180  5 001321   002060 471400 1                  LDP1    RLCW$
         5 001322   100000 236100                    LDQ     0,,PR1
         5 001323   000377 376007                    ANQ     255,DL
         5 001324   000004 235000 1                  LDA     K
         5 001325   000002 735000                    ALS     2
         5 001326   000001 736000                    QLS     1
         5 001327   000106 100505                    MLR     fill='000'O
         5 001330   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2
         5 001331   100001 000002                    ADSC9   1,Q,PR1                  cn=0,n=2

      723     8181    3               RLCW_SAVE.N_SETS#=RLCW_SAVE.N_SETS#+1;

   8181  5 001332   100000 236100                    LDQ     0,,PR1
         5 001333   000377 376007                    ANQ     255,DL
         5 001334   000001 036007                    ADLQ    1,DL
         5 001335   100000 676100                    ERQ     0,,PR1
         5 001336   000377 376007                    ANQ     255,DL
         5 001337   100000 656100                    ERSQ    0,,PR1

      724     8182    3               END;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:132  

   8182  5 001340   001371 710000 5                  TRA     s:8194

      725     8183    2           ELSE
      726     8184    2               IF ARG.TYPE(K)=SNA.AREA THEN

   8184  5 001341   000000 236110                    LDQ     0,X0,PR0
         5 001342   777777 376007                    ANQ     -1,DL
         5 001343   000020 116000 0                  CMPQ    SNA+16
         5 001344   001351 601000 5                  TNZ     s:8187

      727     8185    2                   RLCW_SAVE.AC_INDICATORS='1'B;

   8185  5 001345   002060 471400 1                  LDP1    RLCW$
         5 001346   400000 236007                    LDQ     -131072,DL
         5 001347   100000 256100                    ORSQ    0,,PR1
         5 001350   001371 710000 5                  TRA     s:8194

      728     8186    2               ELSE
      729     8187    2                   IF ARG.TYPE(K)=SNA.SETS THEN

   8187  5 001351   000025 116000 0                  CMPQ    SNA+21
         5 001352   001357 601000 5                  TNZ     s:8190

      730     8188    2                       RLCW_SAVE.SC_INDICATORS='1'B;

   8188  5 001353   002060 471400 1                  LDP1    RLCW$
         5 001354   200000 236007                    LDQ     65536,DL
         5 001355   100000 256100                    ORSQ    0,,PR1
         5 001356   001371 710000 5                  TRA     s:8194

      731     8189    2                   ELSE
      732     8190    2                       IF ARG.TYPE(K)=SNA.RECORD THEN

   8190  5 001357   000022 116000 0                  CMPQ    SNA+18
         5 001360   001365 601000 5                  TNZ     s:8193

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:133  
      733     8191    2                           RLCW_SAVE.RC_INDICATORS='1'B;

   8191  5 001361   002060 471400 1                  LDP1    RLCW$
         5 001362   100000 236007                    LDQ     32768,DL
         5 001363   100000 256100                    ORSQ    0,,PR1
         5 001364   001371 710000 5                  TRA     s:8194

      734     8192    2                       ELSE
      735     8193    2                           CALL ARG_ERROR(20);

   8193  5 001365   000043 236000 6                  LDQ     35
         5 001366   200037 756100                    STQ     @A+2,,AUTO
         5 001367   000715 701000 5                  TSX1    ARG_ERROR
         5 001370   000000 011000                    NOP     0

      736     8194    2           K=K+1;

   8194  5 001371   000004 054000 1                  AOS     K

      737     8195    2           END;

   8195  5 001372   000004 236000 1                  LDQ     K
         5 001373   000014 116000 1                  CMPQ    NO_ARGS
         5 001374   001314 604000 5                  TMI     s:8178

      738     8196    1       RETAIN_SWITCH=%ON;

   8196  5 001375   000001 235007                    LDA     1,DL
         5 001376   000037 755000 1                  STA     RETAIN_SWITCH

      739     8197    1       RETURN;

   8197  5 001377   000000 702200 xent               TSX2  ! X66_ARET

      740     8198
      741     8199    1   IDSSET: ENTRY(A1,A2);

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:134  
   8199  5 001400   000000 700200 xent  IDSSET       TSX0  ! X66_AUTO_N
         5 001401   000106 000024                    ZERO    70,20

      742     8200
      743     8201    1       PT$=ADDR(A1);

   8201  5 001402   200003 236100                    LDQ     @A1,,AUTO
         5 001403   000011 756000 1                  STQ     PT$

      744     8202    1       K=256;

   8202  5 001404   000400 235007                    LDA     256,DL
         5 001405   000004 755000 1                  STA     K

      745     8203    1       CALL INDEX(I,'SET ',CHAR_V);

   8203  5 001406   000003 631400 1                  EPPR1   I
         5 001407   000000 633400 4                  EPPR3   0
         5 001410   000004 223003                    LDX3    4,DU
         5 001411   000011 470400 1                  LDP0    PT$
         5 001412   000000 620005                    EAX0    0,AL
         5 001413   000000 236003                    LDQ     0,DU
         5 001414   000000 701000 xent               TSX1    X66_INDEX
         5 001415   000000 011000                    NOP     0

      746     8204    1       A2(0)=1;

   8204  5 001416   200004 471500                    LDP1    @A2,,AUTO
         5 001417   000100 100400                    MLR     fill='000'O
         5 001420   000044 000004 6                  ADSC9   36                       cn=0,n=4
         5 001421   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4

      747     8205    1       IF I=K THEN RETURN; /* NOT A LEGAL SET COMMAND */

   8205  5 001422   000003 236000 1                  LDQ     I
         5 001423   000004 116000 1                  CMPQ    K
         5 001424   001426 601000 5                  TNZ     s:8206
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:135  

   8205  5 001425   000000 702200 xent               TSX2  ! X66_ARET

      748     8206    1       K=K-I;

   8206  5 001426   000004 236000 1                  LDQ     K
         5 001427   000003 136000 1                  SBLQ    I
         5 001430   000004 756000 1                  STQ     K

      749     8207    1       PT$=PINCRC(PT$,I);

   8207  5 001431   000003 236000 1                  LDQ     I
         5 001432   000020 736000                    QLS     16
         5 001433   000011 036000 1                  ADLQ    PT$
         5 001434   000011 756000 1                  STQ     PT$

      750     8208    1       I=4;

   8208  5 001435   000004 235007                    LDA     4,DL
         5 001436   000003 755000 1                  STA     I

      751     8209    2       DO J=1 TO 2;

   8209  5 001437   000001 235007                    LDA     1,DL
         5 001440   000005 755000 1                  STA     J

      752     8210    3           DO WHILE(SUBSTR(CHAR_V,I,1)=' ' AND I<K);

   8210  5 001441   001443 710000 5                  TRA     s:8212

      753     8211    3               I=I+1;

   8211  5 001442   000003 054000 1                  AOS     I

      754     8212    3               END;

   8212  5 001443   000011 470400 1                  LDP0    PT$
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:136  
         5 001444   000003 235000 1                  LDA     I
         5 001445   040000 106505                    CMPC    fill='040'O
         5 001446   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         5 001447   000001 000001 6                  ADSC9   1                        cn=0,n=1
         5 001450   001454 601000 5                  TNZ     s:8213
         5 001451   000003 236000 1                  LDQ     I
         5 001452   000004 116000 1                  CMPQ    K
         5 001453   001442 604000 5                  TMI     s:8211

      755     8213    2           CALL INDEX1(I,' ',CHAR_V,I+1);

   8213  5 001454   000004 236000 1                  LDQ     K
         5 001455   000003 136000 1                  SBLQ    I
         5 001456   777777 620006                    EAX0    -1,QL
         5 001457   000003 236000 1                  LDQ     I
         5 001460   000001 036007                    ADLQ    1,DL
         5 001461   000000 124545                    SCM     mask='000'O
         5 001462   000000 200010                    ADSC9   0,A,PR0                  cn=1,n=*X0
         5 001463   000001 000001 6                  ADSC9   1                        cn=0,n=1
         5 001464   000003 000000 1                  ARG     I
         5 001465   000003 056000 1                  ASQ     I

      756     8214    2           END;

   8214  5 001466   000005 054000 1                  AOS     J
         5 001467   000005 235000 1                  LDA     J
         5 001470   000002 115007                    CMPA    2,DL
         5 001471   001441 604400 5                  TMOZ    s:8210

      757     8215    1       IF SUBSTR(CHAR_V,I-1,1)='.' THEN I=I-1;

   8215  5 001472   000003 236000 1                  LDQ     I
         5 001473   040000 106506                    CMPC    fill='040'O
         5 001474   077777 600001                    ADSC9   -1,Q,PR0                 cn=3,n=1
         5 001475   000045 000001 6                  ADSC9   37                       cn=0,n=1
         5 001476   001501 601000 5                  TNZ     s:8216

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:137  
   8215  5 001477   000001 336007                    LCQ     1,DL
         5 001500   000003 056000 1                  ASQ     I

      758     8216    1       K=I;

   8216  5 001501   000003 236000 1                  LDQ     I
         5 001502   000004 756000 1                  STQ     K

      759     8217    1       FPT_YC.CMD_=VECTOR(CHAR_V);

   8217  5 001503   000004 235000 1                  LDA     K
         5 001504   000020 735000                    ALS     16
         5 001505   000140 135007                    SBLA    96,DL
         5 001506   000011 236000 1                  LDQ     PT$
         5 001507   002134 757000 1                  STAQ    FPT_YC

      760     8218    1       CALL M$YC(FPT_YC) ALTRET(YC_ERROR);

   8218  5 001510   002134 630400 1                  EPPR0   FPT_YC
         5 001511   400011 713400                    CLIMB   alt,+9
         5 001512   401000 401760                    pmme    nvectors=3
         5 001513   001521 702000 5                  TSX2    YC_ERROR

      761     8219    1       A2(0)=0; /* NORMAL FLAG */

   8219  5 001514   200004 470500                    LDP0    @A2,,AUTO
         5 001515   000100 100400                    MLR     fill='000'O
         5 001516   000032 000004 6                  ADSC9   26                       cn=0,n=4
         5 001517   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

      762     8220    1       RETURN;

   8220  5 001520   000000 702200 xent               TSX2  ! X66_ARET

      763     8221    1   YC_ERROR: A2(0)=ADDR(B$TCB$->B$TCB.ALT$->B$EXCFR.ERR.FCG)->SBIN36;

   8221  5 001521   000000 470400 xsym  YC_ERROR     LDP0    B$TCB$
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:138  
         5 001522   000000 471500                    LDP1    0,,PR0
         5 001523   200004 473500                    LDP3    @A2,,AUTO
         5 001524   000100 100500                    MLR     fill='000'O
         5 001525   100102 000004                    ADSC9   66,,PR1                  cn=0,n=4
         5 001526   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4

      764     8222    1       RETURN;

   8222  5 001527   000000 702200 xent               TSX2  ! X66_ARET

      765     8223         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:139  
      766     8224        /**   INTERNAL SUBROUTINE TO SETUP RETAIN CONTROL LIST   **/
      767     8225
      768     8226    1   CHK_RETAIN: PROC(RLCW,OFFSET);

   8226  5 001530   200032 741300       CHK_RETAIN   STX1  ! @B,,AUTO

      769     8227
      770     8228    2   DCL 1 RLCW,
      771     8229    2         2 FLAGS SBIN WORD,
      772     8230    2         2 LISTS (0:0),
      773     8231    2           3 RVA_OFFSET# SBIN HALF UNAL,
      774     8232    2           3 MBZ UBIN HALF UNAL;
      775     8233    2   DCL OFFSET SBIN HALF CALIGNED;
      776     8234
      777     8235    2       IF RETAIN_SWITCH=%OFF THEN

   8235  5 001531   000037 235000 1                  LDA     RETAIN_SWITCH
         5 001532   001536 601000 5                  TNZ     s:8239

      778     8236    2           RLCW.FLAGS=0;

   8236  5 001533   200033 470500                    LDP0    @RLCW,,AUTO
         5 001534   000000 450100                    STZ     0,,PR0
         5 001535   001615 710000 5                  TRA     s:8246

      779     8237    2       ELSE
      780     8238    3       DO;

      781     8239    3           RETAIN_SWITCH=%OFF;

   8239  5 001536   000037 450000 1                  STZ     RETAIN_SWITCH

      782     8240    3           RLCW.FLAGS=ADDR(RLCW_SAVE)->SBIN36;

   8240  5 001537   002060 470400 1                  LDP0    RLCW$
         5 001540   200033 471500                    LDP1    @RLCW,,AUTO
         5 001541   000000 235100                    LDA     0,,PR0
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:140  
         5 001542   100000 755100                    STA     0,,PR1

      783     8241    4           DO II=OFFSET TO RLCW_SAVE.N_SETS#+OFFSET-1;

   8241  5 001543   200034 473500                    LDP3    @OFFSET,,AUTO
         5 001544   000100 100500                    MLR     fill='000'O
         5 001545   300000 000002                    ADSC9   0,,PR3                   cn=0,n=2
         5 001546   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 001547   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 001550   000022 732000                    QRS     18
         5 001551   000040 756000 1                  STQ     II
         5 001552   001600 710000 5                  TRA     s:8244+1

      784     8242    4               RLCW.LISTS.RVA_OFFSET#(II)=RLCW_SAVE.RETAIN_LIST(II-OFFSET);

   8242  5 001553   200034 470500                    LDP0    @OFFSET,,AUTO
         5 001554   000100 100500                    MLR     fill='000'O
         5 001555   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         5 001556   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 001557   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 001560   000022 732000                    QRS     18
         5 001561   200077 756100                    STQ     ERRMSG_BUF+31,,AUTO
         5 001562   000040 236000 1                  LDQ     II
         5 001563   200077 136100                    SBLQ    ERRMSG_BUF+31,,AUTO
         5 001564   000001 736000                    QLS     1
         5 001565   000040 235000 1                  LDA     II
         5 001566   000002 735000                    ALS     2
         5 001567   002060 471400 1                  LDP1    RLCW$
         5 001570   200033 473500                    LDP3    @RLCW,,AUTO
         5 001571   000105 100506                    MLR     fill='000'O
         5 001572   100001 000002                    ADSC9   1,Q,PR1                  cn=0,n=2
         5 001573   300001 000002                    ADSC9   1,A,PR3                  cn=0,n=2

      785     8243    4               RLCW.LISTS.MBZ(II)=0;

   8243  5 001574   000000 220003                    LDX0    0,DU
         5 001575   000040 721000 1                  LXL1    II
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:141  
         5 001576   300001 440111                    SXL0    1,X1,PR3

      786     8244    4               END;

   8244  5 001577   000040 054000 1                  AOS     II
         5 001600   200034 470500                    LDP0    @OFFSET,,AUTO
         5 001601   000100 100500                    MLR     fill='000'O
         5 001602   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         5 001603   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 001604   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 001605   000022 732000                    QRS     18
         5 001606   200077 756100                    STQ     ERRMSG_BUF+31,,AUTO
         5 001607   002060 471400 1                  LDP1    RLCW$
         5 001610   100000 236100                    LDQ     0,,PR1
         5 001611   000377 376007                    ANQ     255,DL
         5 001612   200077 036100                    ADLQ    ERRMSG_BUF+31,,AUTO
         5 001613   000040 116000 1                  CMPQ    II
         5 001614   001553 605400 5                  TPNZ    s:8242

      787     8245    3           END;

      788     8246    2   END CHK_RETAIN;

   8246  5 001615   200032 221300                    LDX1  ! @B,,AUTO
         5 001616   000001 702211                    TSX2  ! 1,X1

      789     8247         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:142  
      790     8248        /**************************************************************/
      791     8249        /*                                                            */
      792     8250        /*    CALL READY([AREA-1[,AREA-2[,....]],FUN-OPT,[MODE-OPT])  */
      793     8251        /*                                                            */
      794     8252        /*    FUN-OPT: LOAD, UPDATE, OR RETRIEVAL                     */
      795     8253        /*    MODE-OPT: SHAREALL,SHAREANY,NOSHARE, OR SHAREIN.        */
      796     8254        /*                                                            */
      797     8255        /**************************************************************/
      798     8256
      799     8257    1   READY: ENTRY(

   8257  5 001617   000000 700200 xent  READY        TSX0  ! X66_AUTO_N
         5 001620   000106 000024                    ZERO    70,20

      800     8258               %GEN_PARAMS;
      801     8799
      802     8800    1       CALL SET_ARGS;

   8800  5 001621   000535 701000 5                  TSX1    SET_ARGS
         5 001622   000000 011000                    NOP     0

      803     8801        /*    ERROR: ZII-25-1
      804     8802              MESSAGE: Syntax error in READY CALL.
      805     8803                       Required option LOAD/UPDATE/RETRIEVAL missing.  */
      806     8804    1       J=2;

   8804  5 001623   000002 235007                    LDA     2,DL
         5 001624   000005 755000 1                  STA     J

      807     8805    1       I=ARG.TYPE(NO_ARGS-1);

   8805  5 001625   002055 470400 1                  LDP0    ARG$
         5 001626   000014 720000 1                  LXL0    NO_ARGS
         5 001627   077777 236110                    LDQ     -1,X0,PR0
         5 001630   777777 376007                    ANQ     -1,DL
         5 001631   000003 756000 1                  STQ     I

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:143  
      808     8806    1       IF I=SNA.NOSHALL THEN

   8806  5 001632   000014 116000 0                  CMPQ    SNA+12
         5 001633   001640 601000 5                  TNZ     s:8822

      809     8807                %CLIMB(FCN=SHNO,PARAMS=0);

   8818  5 001634   000032 631400 6                  EPPR1   26
         5 001635   000000 701000 xent               TSX1    U$SHNO
         5 001636   000000 011000                    NOP     0
         5 001637   001700 710000 5                  TRA     s:8904

      810     8821    1       ELSE
      811     8822    1           IF I=SNA.SHAREALL THEN

   8822  5 001640   000026 116000 0                  CMPQ    SNA+22
         5 001641   001646 601000 5                  TNZ     s:8838

      812     8823                    %CLIMB(FCN=SHALL,PARAMS=0);

   8834  5 001642   000032 631400 6                  EPPR1   26
         5 001643   000000 701000 xent               TSX1    U$SHALL
         5 001644   000000 011000                    NOP     0
         5 001645   001700 710000 5                  TRA     s:8904

      813     8837    1           ELSE
      814     8838    1               IF I=SNA.SHAREIN THEN

   8838  5 001646   000030 116000 0                  CMPQ    SNA+24
         5 001647   001654 601000 5                  TNZ     s:8854

      815     8839                        %CLIMB(FCN=SHIN,PARAMS=0);

   8850  5 001650   000032 631400 6                  EPPR1   26
         5 001651   000000 701000 xent               TSX1    U$SHIN
         5 001652   000000 011000                    NOP     0
         5 001653   001700 710000 5                  TRA     s:8904
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:144  

      816     8853    1               ELSE
      817     8854    1                   IF I=SNA.SHAREANY THEN

   8854  5 001654   000027 116000 0                  CMPQ    SNA+23
         5 001655   001662 601000 5                  TNZ     s:8870

      818     8855                            %CLIMB(FCN=SHANY,PARAMS=0);

   8866  5 001656   000032 631400 6                  EPPR1   26
         5 001657   000000 701000 xent               TSX1    U$SHANY
         5 001660   000000 011000                    NOP     0
         5 001661   001700 710000 5                  TRA     s:8904

      819     8869    1                   ELSE
      820     8870    1                       IF I=SNA.SHCUR THEN

   8870  5 001662   000034 116000 0                  CMPQ    SNA+28
         5 001663   001670 601000 5                  TNZ     s:8886

      821     8871                                %CLIMB(FCN=SHCUR,PARAMS=0);

   8882  5 001664   000032 631400 6                  EPPR1   26
         5 001665   000000 701000 xent               TSX1    U$SHCUR
         5 001666   000000 011000                    NOP     0
         5 001667   001700 710000 5                  TRA     s:8904

      822     8885    1                       ELSE
      823     8886    1                           IF I=SNA.SHINCUR THEN

   8886  5 001670   000035 116000 0                  CMPQ    SNA+29
         5 001671   001676 601000 5                  TNZ     s:8902

      824     8887                                    %CLIMB(FCN=SHINCUR,PARAMS=0);

   8898  5 001672   000032 631400 6                  EPPR1   26
         5 001673   000000 701000 xent               TSX1    U$SHINCUR
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:145  
         5 001674   000000 011000                    NOP     0
         5 001675   001700 710000 5                  TRA     s:8904

      825     8901    1                           ELSE
      826     8902    1                               J=1;

   8902  5 001676   000001 235007                    LDA     1,DL
         5 001677   000005 755000 1                  STA     J

      827     8903
      828     8904    1       I=ARG.TYPE(NO_ARGS-J);

   8904  5 001700   000014 236000 1                  LDQ     NO_ARGS
         5 001701   000005 136000 1                  SBLQ    J
         5 001702   002055 470400 1                  LDP0    ARG$
         5 001703   000000 236106                    LDQ     0,QL,PR0
         5 001704   777777 376007                    ANQ     -1,DL
         5 001705   000003 756000 1                  STQ     I

      829     8905    1       IF I=SNA.UPDATE THEN

   8905  5 001706   000031 116000 0                  CMPQ    SNA+25
         5 001707   001716 601000 5                  TNZ     s:8908

      830     8906    1           IPT_RDY.V.RDCW.READY_OPTION#='010'B;

   8906  5 001710   002054 471400 1                  LDP1    FPT$
         5 001711   100012 236100                    LDQ     10,,PR1
         5 001712   000046 376000 6                  ANQ     38
         5 001713   000010 276003                    ORQ     8,DU
         5 001714   100012 756100                    STQ     10,,PR1
         5 001715   001742 710000 5                  TRA     s:8918

      831     8907    1       ELSE
      832     8908    1           IF I=SNA.RETRIEVAL THEN

   8908  5 001716   000023 116000 0                  CMPQ    SNA+19
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:146  
         5 001717   001726 601000 5                  TNZ     s:8911

      833     8909    1               IPT_RDY.V.RDCW.READY_OPTION#='100'B;

   8909  5 001720   002054 471400 1                  LDP1    FPT$
         5 001721   100012 236100                    LDQ     10,,PR1
         5 001722   000046 376000 6                  ANQ     38
         5 001723   000020 276003                    ORQ     16,DU
         5 001724   100012 756100                    STQ     10,,PR1
         5 001725   001742 710000 5                  TRA     s:8918

      834     8910    1           ELSE
      835     8911    1               IF I=SNA.LOAD THEN

   8911  5 001726   000012 116000 0                  CMPQ    SNA+10
         5 001727   001736 601000 5                  TNZ     s:8914

      836     8912    1                   IPT_RDY.V.RDCW.READY_OPTION#='001'B;

   8912  5 001730   002054 471400 1                  LDP1    FPT$
         5 001731   100012 236100                    LDQ     10,,PR1
         5 001732   000046 376000 6                  ANQ     38
         5 001733   000004 276003                    ORQ     4,DU
         5 001734   100012 756100                    STQ     10,,PR1
         5 001735   001742 710000 5                  TRA     s:8918

      837     8913    1               ELSE
      838     8914    1                   CALL ARG_ERROR(25);

   8914  5 001736   000050 236000 6                  LDQ     40
         5 001737   200037 756100                    STQ     @A+2,,AUTO
         5 001740   000715 701000 5                  TSX1    ARG_ERROR
         5 001741   000000 011000                    NOP     0

      839     8915
      840     8916        /*    ERROR: ZII-30-1
      841     8917              MESSAGE: Arguments in CALL READY are not all AREA-NAMEs. */
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:147  
      842     8918    2       DO I=0 TO NO_ARGS-J-1;

   8918  5 001742   000003 450000 1                  STZ     I
         5 001743   001763 710000 5                  TRA     s:8921+1

      843     8919    2           IF ARG.TYPE(I)~=%AREA_NAME THEN CALL ARG_ERROR(30);

   8919  5 001744   002055 470400 1                  LDP0    ARG$
         5 001745   000003 720000 1                  LXL0    I
         5 001746   000000 721110                    LXL1    0,X0,PR0
         5 001747   000037 101003                    CMPX1   31,DU
         5 001750   001755 600000 5                  TZE     s:8920

   8919  5 001751   000052 236000 6                  LDQ     42
         5 001752   200037 756100                    STQ     @A+2,,AUTO
         5 001753   000715 701000 5                  TSX1    ARG_ERROR
         5 001754   000000 011000                    NOP     0

      844     8920    2           IPT_RDY.V.AC_OFFSETS.RVA_OFFSET#(I)=ARG.OFFSET(I);

   8920  5 001755   002055 470400 1                  LDP0    ARG$
         5 001756   000003 720000 1                  LXL0    I
         5 001757   000000 221110                    LDX1    0,X0,PR0
         5 001760   002054 471400 1                  LDP1    FPT$
         5 001761   100013 741110                    STX1    11,X0,PR1

      845     8921    2           END;

   8921  5 001762   000003 054000 1                  AOS     I
         5 001763   000014 236000 1                  LDQ     NO_ARGS
         5 001764   000005 136000 1                  SBLQ    J
         5 001765   000003 116000 1                  CMPQ    I
         5 001766   001744 605400 5                  TPNZ    s:8919

      846     8922    1       IPT_RDY.V.RDCW.AREAS_TO_READY#=I;

   8922  5 001767   000003 720000 1                  LXL0    I
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:148  
         5 001770   002054 470400 1                  LDP0    FPT$
         5 001771   000012 440100                    SXL0    10,,PR0

      847     8923    1       VBASE(IPT_RDY.V_) = ADDR(IPT_RDY.V);

   8923  5 001772   002054 236000 1                  LDQ     FPT$
         5 001773   000012 036003                    ADLQ    10,DU
         5 001774   000001 756100                    STQ     1,,PR0

      848     8924    1       VBOUND(IPT_RDY.V_) = SIZEC(IPT_RDY.V.RDCW) +

   8924  5 001775   000003 236000 1                  LDQ     I
         5 001776   000002 736000                    QLS     2
         5 001777   000004 036007                    ADLQ    4,DL
         5 002000   000020 736000                    QLS     16
         5 002001   000000 676100                    ERQ     0,,PR0
         5 002002   000000 376000 6                  ANQ     0
         5 002003   000000 656100                    ERSQ    0,,PR0

      849     8925    1          SIZEC(IPT_RDY.V.AC_OFFSETS) * I;
      850     8926         /* I computed from previous DO */
      851     8927            %CLIMB(FCN=RDY);

   8935  5 002004   002054 630400 1                  EPPR0   FPT$
         5 002005   000053 631400 6                  EPPR1   43
         5 002006   000000 701000 xent               TSX1    U$RDY
         5 002007   000000 011000                    NOP     0

      852     8941    1       DK_RET.AUTO_OFFSET=-1*(AUTO_FRAME(-2*(AUTO_FRAME(1)+1)+1)+1);

   8941  5 002010   000010 470400 1                  LDP0    AUTO$
         5 002011   003100 060500                    CSL     bolr='003'O
         5 002012   000000 400022                    BDSC    0,,PR0                   by=2,bit=0,n=18
         5 002013   200076 000044                    BDSC    ERRMSG_BUF+30,,AUTO      by=0,bit=0,n=36
         5 002014   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 002015   000022 732000                    QRS     18
         5 002016   000027 402000 6                  MPY     23
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:149  
         5 002017   000000 116003                    CMPQ    0,DU
         5 002020   002022 605000 5                  TPL     s:8941+10
         5 002021   000044 036003                    ADLQ    36,DU
         5 002022   003100 060506                    CSL     bolr='003'O
         5 002023   077777 400022                    BDSC    -1,Q,PR0                 by=2,bit=0,n=18
         5 002024   200077 000044                    BDSC    ERRMSG_BUF+31,,AUTO      by=0,bit=0,n=36
         5 002025   200077 236100                    LDQ     ERRMSG_BUF+31,,AUTO
         5 002026   000022 732000                    QRS     18
         5 002027   000054 676000 6                  ERQ     44
         5 002030   000000 620006                    EAX0    0,QL
         5 002031   000006 740000 1                  STX0    DEADLOCK_RET

      853     8942    2       DO WHILE (IA_HALF(15)>0);

   8942  5 002032   002051 471400 1                  LDP1    IA$
         5 002033   000100 101500                    MRL     fill='000'O
         5 002034   100007 400002                    ADSC9   7,,PR1                   cn=2,n=2
         5 002035   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 002036   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 002037   000000 116003                    CMPQ    0,DU
         5 002040   002073 600000 5                  TZE     s:8962

      854     8943    2           REDEF_PT.ADR=IA_HALF(14); /* GET ADDR FROM IA */

   8943  5 002041   002051 470400 1                  LDP0    IA$
         5 002042   000000 100500                    MLR     fill='000'O
         5 002043   000007 000002                    ADSC9   7,,PR0                   cn=0,n=2
         5 002044   000011 000002 1                  ADSC9   PT$                      cn=0,n=2

      855     8944    2           REDEF_PT.SEG#='006000'O; /* INSTRUCTION SEG # */

   8944  5 002045   006000 220003                    LDX0    3072,DU
         5 002046   000011 440000 1                  SXL0    PT$

      856     8945    2           CALL EPTR$;

   8945  5 002047   000011 221000 1                  LDX1    PT$
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:150  
         5 002050   000032 631400 6                  EPPR1   26
         5 002051   000000 701011                    TSX1    0,X1
         5 002052   000000 011000                    NOP     0

      857     8946    2           IPT_ETC.V_ = VECTOR(IPT_ETC.V);

   8946  5 002053   000012 235000 6                  LDA     10
         5 002054   002054 236000 1                  LDQ     FPT$
         5 002055   000012 036003                    ADLQ    10,DU
         5 002056   002054 470400 1                  LDP0    FPT$
         5 002057   000000 757100                    STAQ    0,,PR0

      858     8947                %CLIMB(FCN=ETC);

   8955  5 002060   002054 630400 1                  EPPR0   FPT$
         5 002061   000053 631400 6                  EPPR1   43
         5 002062   000000 701000 xent               TSX1    U$ETC
         5 002063   000000 011000                    NOP     0

      859     8961    2           END;

   8961  5 002064   002051 470400 1                  LDP0    IA$
         5 002065   000100 101500                    MRL     fill='000'O
         5 002066   000007 400002                    ADSC9   7,,PR0                   cn=2,n=2
         5 002067   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 002070   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 002071   000000 116003                    CMPQ    0,DU
         5 002072   002041 601000 5                  TNZ     s:8943

      860     8962    1       RETAIN_SWITCH=%OFF; /* RESET RETAIN CONTROL FLAG */

   8962  5 002073   000037 450000 1                  STZ     RETAIN_SWITCH

      861     8963    1       GOTO COMMON_RETURN;

   8963  5 002074   005105 710000 5                  TRA     COMMON_RETURN

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:151  
      862     8964         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:152  
      863     8965        /**************************************************************/
      864     8966        /*                                                            */
      865     8967        /*    CALL FINISH([AREA-1,[AREA-2,....,],])                   */
      866     8968        /*                                                            */
      867     8969        /**************************************************************/
      868     8970    1   FINISH: ENTRY(

   8970  5 002075   000000 700200 xent  FINISH       TSX0  ! X66_AUTO_N
         5 002076   000106 000024                    ZERO    70,20

      869     8971               %GEN_PARAMS;
      870     9512
      871     9513    1       CALL SET_ARGS;

   9513  5 002077   000535 701000 5                  TSX1    SET_ARGS
         5 002100   000000 011000                    NOP     0

      872     9514        /*    ERROR: ZII-35-1
      873     9515              MESSAGE: Arguments in CALL FINISH are not all AREA-NAMES. */
      874     9516    2       DO I=0 TO NO_ARGS-1;

   9516  5 002101   000003 450000 1                  STZ     I
         5 002102   002122 710000 5                  TRA     s:9519+1

      875     9517    2           IF ARG.TYPE(I)~=%AREA_NAME THEN CALL ARG_ERROR(35);

   9517  5 002103   002055 470400 1                  LDP0    ARG$
         5 002104   000003 720000 1                  LXL0    I
         5 002105   000000 721110                    LXL1    0,X0,PR0
         5 002106   000037 101003                    CMPX1   31,DU
         5 002107   002114 600000 5                  TZE     s:9518

   9517  5 002110   000056 236000 6                  LDQ     46
         5 002111   200037 756100                    STQ     @A+2,,AUTO
         5 002112   000715 701000 5                  TSX1    ARG_ERROR
         5 002113   000000 011000                    NOP     0

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:153  
      876     9518    2           IPT_FIN.V.AC_OFFSETS.RVA_OFFSET#(I)=ARG.OFFSET(I);

   9518  5 002114   002055 470400 1                  LDP0    ARG$
         5 002115   000003 720000 1                  LXL0    I
         5 002116   000000 221110                    LDX1    0,X0,PR0
         5 002117   002054 471400 1                  LDP1    FPT$
         5 002120   100013 741110                    STX1    11,X0,PR1

      877     9519    2           END;

   9519  5 002121   000003 054000 1                  AOS     I
         5 002122   000003 236000 1                  LDQ     I
         5 002123   000014 116000 1                  CMPQ    NO_ARGS
         5 002124   002103 604000 5                  TMI     s:9517

      878     9520    1       IPT_FIN.V.ALCW.N_AREAS#=I;

   9520  5 002125   000000 620006                    EAX0    0,QL
         5 002126   002054 470400 1                  LDP0    FPT$
         5 002127   000012 740100                    STX0    10,,PR0

      879     9521    1       VBASE (IPT_FIN.V_) = ADDR(IPT_FIN.V);

   9521  5 002130   002054 236000 1                  LDQ     FPT$
         5 002131   000012 036003                    ADLQ    10,DU
         5 002132   000001 756100                    STQ     1,,PR0

      880     9522    1       VBOUND(IPT_FIN.V_) = SIZEC(IPT_FIN.V.ALCW) +

   9522  5 002133   000003 236000 1                  LDQ     I
         5 002134   000002 736000                    QLS     2
         5 002135   000004 036007                    ADLQ    4,DL
         5 002136   000020 736000                    QLS     16
         5 002137   000000 676100                    ERQ     0,,PR0
         5 002140   000000 376000 6                  ANQ     0
         5 002141   000000 656100                    ERSQ    0,,PR0

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:154  
      881     9523    1          SIZEC(IPT_FIN.V.AC_OFFSETS) * I;
      882     9524         /* I computed from previous DO */
      883     9525            %CLIMB(FCN=FIN);

   9533  5 002142   002054 630400 1                  EPPR0   FPT$
         5 002143   000053 631400 6                  EPPR1   43
         5 002144   000000 701000 xent               TSX1    U$FIN
         5 002145   000000 011000                    NOP     0

      884     9539    1       DK_RET.AUTO_OFFSET=-1*(AUTO_FRAME(-2*(AUTO_FRAME(1)+1)+1)+1);

   9539  5 002146   000010 470400 1                  LDP0    AUTO$
         5 002147   003100 060500                    CSL     bolr='003'O
         5 002150   000000 400022                    BDSC    0,,PR0                   by=2,bit=0,n=18
         5 002151   200076 000044                    BDSC    ERRMSG_BUF+30,,AUTO      by=0,bit=0,n=36
         5 002152   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 002153   000022 732000                    QRS     18
         5 002154   000027 402000 6                  MPY     23
         5 002155   000000 116003                    CMPQ    0,DU
         5 002156   002160 605000 5                  TPL     s:9539+10
         5 002157   000044 036003                    ADLQ    36,DU
         5 002160   003100 060506                    CSL     bolr='003'O
         5 002161   077777 400022                    BDSC    -1,Q,PR0                 by=2,bit=0,n=18
         5 002162   200077 000044                    BDSC    ERRMSG_BUF+31,,AUTO      by=0,bit=0,n=36
         5 002163   200077 236100                    LDQ     ERRMSG_BUF+31,,AUTO
         5 002164   000022 732000                    QRS     18
         5 002165   000054 676000 6                  ERQ     44
         5 002166   000000 620006                    EAX0    0,QL
         5 002167   000006 740000 1                  STX0    DEADLOCK_RET

      885     9540    1       GOTO COMMON_RETURN;

   9540  5 002170   005105 710000 5                  TRA     COMMON_RETURN

      886     9541
      887     9542    1   CALC: ENTRY(A1,A2);

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:155  
   9542  5 002171   000000 700200 xent  CALC         TSX0  ! X66_AUTO_N
         5 002172   000106 000024                    ZERO    70,20

      888     9543
      889     9544    1       CALL SET_ARGS1;

   9544  5 002173   000555 701000 5                  TSX1    SET_ARGS1
         5 002174   000000 011000                    NOP     0

      890     9545    1       IF NO_ARGS~=2 OR ARG.TYPE(0)~=%RECORD_NAME THEN CALL ARG_ERROR(37);

   9545  5 002175   000014 235000 1                  LDA     NO_ARGS
         5 002176   000002 115007                    CMPA    2,DL
         5 002177   002204 601000 5                  TNZ     s:9545+7
         5 002200   002055 470400 1                  LDP0    ARG$
         5 002201   000000 720100                    LXL0    0,,PR0
         5 002202   000041 100003                    CMPX0   33,DU
         5 002203   002210 600000 5                  TZE     s:9549

   9545  5 002204   000060 236000 6                  LDQ     48
         5 002205   200037 756100                    STQ     @A+2,,AUTO
         5 002206   000715 701000 5                  TSX1    ARG_ERROR
         5 002207   000000 011000                    NOP     0

      891     9546        /*    ERROR: ZII-37-1
      892     9547              MESSAGE: Argument count error, or the 1st argument is not
      893     9548                       a RECORD-NAME in CALL CALC. */
      894     9549    1       IPT_CALC.V_=VECTOR(IPT_CALC.V);

   9549  5 002210   000012 235000 6                  LDA     10
         5 002211   002054 236000 1                  LDQ     FPT$
         5 002212   000014 036003                    ADLQ    12,DU
         5 002213   002054 470400 1                  LDP0    FPT$
         5 002214   000000 757100                    STAQ    0,,PR0

      895     9550    1       IPT_CALC.DBK_=VECTOR(A2(0));

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:156  
   9550  5 002215   777640 235007                    LDA     -96,DL
         5 002216   200004 236100                    LDQ     @A2,,AUTO
         5 002217   000012 757100                    STAQ    10,,PR0

      896     9551    1       IPT_CALC.V.UWA_OFFSET=RVA_HALF(ARG.OFFSET(0)*2+1)/8;

   9551  5 002220   002055 471400 1                  LDP1    ARG$
         5 002221   100000 236100                    LDQ     0,,PR1
         5 002222   000022 772000                    QRL     18
         5 002223   000002 736000                    QLS     2
         5 002224   002053 473400 1                  LDP3    RVA$
         5 002225   000100 101506                    MRL     fill='000'O
         5 002226   300000 400002                    ADSC9   0,Q,PR3                  cn=2,n=2
         5 002227   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 002230   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 002231   000003 772000                    QRL     3
         5 002232   000014 756100                    STQ     12,,PR0

      897     9552            %CLIMB(FCN=CALC);

   9560  5 002233   002054 630400 1                  EPPR0   FPT$
         5 002234   000053 631400 6                  EPPR1   43
         5 002235   000000 701000 xent               TSX1    U$CALC
         5 002236   000000 011000                    NOP     0

      898     9566    1       IPT_CALC.V_=VECTOR(FPTS.V);

   9566  5 002237   000034 235000 6                  LDA     28
         5 002240   002054 236000 1                  LDQ     FPT$
         5 002241   000012 036003                    ADLQ    10,DU
         5 002242   002054 470400 1                  LDP0    FPT$
         5 002243   000000 757100                    STAQ    0,,PR0

      899     9567    1       RETURN;

   9567  5 002244   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:157  
      900     9568         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:158  
      901     9569    1   ACCEPT: ENTRY(A1,A2,A3);

   9569  5 002245   000000 700200 xent  ACCEPT       TSX0  ! X66_AUTO_N
         5 002246   000106 000024                    ZERO    70,20

      902     9570
      903     9571    1       CALL SET_ARGS;

   9571  5 002247   000535 701000 5                  TSX1    SET_ARGS
         5 002250   000000 011000                    NOP     0

      904     9572        /*****************************************************************/
      905     9573        /*                                                               */
      906     9574        /*    CALL ACCEPT(IDENT-1,[REC-NAME],AREANAME)                   */
      907     9575        /*                                   SET-NAME                    */
      908     9576        /*                                   IDENT-2                     */
      909     9577        /*         IDENT-1: LOCATION TO RECEIVE THE AREA'S TEXT NAME     */
      910     9578        /*         IDENT-2: LOCATION CONTAINS A DBKEY TO IDENT THE AREA  */
      911     9579        /*                                                               */
      912     9580        /*****************************************************************/
      913     9581    1       IF ARG.TYPE(NO_ARGS-1)=SNA.AREANAME THEN

   9581  5 002251   002055 470400 1                  LDP0    ARG$
         5 002252   000014 720000 1                  LXL0    NO_ARGS
         5 002253   077777 236110                    LDQ     -1,X0,PR0
         5 002254   777777 376007                    ANQ     -1,DL
         5 002255   000021 116000 0                  CMPQ    SNA+17
         5 002256   002340 601000 5                  TNZ     s:9626

      914     9582    2       DO;

      915     9583    2           IPT_ACN.DBK_=VECTOR(NIL);

   9583  5 002257   000014 237000 6                  LDAQ    12
         5 002260   002054 471400 1                  LDP1    FPT$
         5 002261   100014 757100                    STAQ    12,,PR1

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:159  
      916     9584    2           IPT_ACN.ANAME_=VECTOR(ADDR(A1)->ANAME_);

   9584  5 002262   000006 235000 6                  LDA     6
         5 002263   200003 236100                    LDQ     @A1,,AUTO
         5 002264   100012 757100                    STAQ    10,,PR1

      917     9585    3           DO CASE(ARG.TYPE(1)-%AREA_NAME);

   9585  5 002265   000001 236100                    LDQ     1,,PR0
         5 002266   777777 376007                    ANQ     -1,DL
         5 002267   000037 136007                    SBLQ    31,DL
         5 002270   000003 116007                    CMPQ    3,DL
         5 002271   002273 602006 5                  TNC     s:9585+6,QL
         5 002272   002310 710000 5                  TRA     s:9594
         5 002273   002310 710000 5                  TRA     s:9594
         5 002274   002303 710000 5                  TRA     s:9591
         5 002275   002276 710000 5                  TRA     s:9588

      918     9586
      919     9587    3           CASE(%RECORD_NAME_NET);

      920     9588    3               IPT_ACN.V.NCW.CI#=1;

   9588  5 002276   000001 221003                    LDX1    1,DU
         5 002277   100016 741100                    STX1    14,,PR1

      921     9589    3               IPT_ACN.V.RVA_ITEM.OFFSET#=ARG.OFFSET(1);

   9589  5 002300   000001 222100                    LDX2    1,,PR0
         5 002301   100020 742100                    STX2    16,,PR1
         5 002302   002325 710000 5                  TRA     s:9599

      922     9590    3           CASE(%SET_NAME_NET);

      923     9591    3               IPT_ACN.V.NCW.CI#=3;

   9591  5 002303   000003 221003                    LDX1    3,DU
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:160  
         5 002304   100016 741100                    STX1    14,,PR1

      924     9592    3               IPT_ACN.V.RVA_ITEM.OFFSET#=ARG.OFFSET(1);

   9592  5 002305   000001 222100                    LDX2    1,,PR0
         5 002306   100020 742100                    STX2    16,,PR1
         5 002307   002325 710000 5                  TRA     s:9599

      925     9593    3           CASE(ELSE);

      926     9594    3               IPT_ACN.V.RVA_ITEM.OFFSET#=NULL_OFFSET;

   9594  5 002310   002050 721000 1                  LXL1    NULL_OFFSET
         5 002311   100020 741100                    STX1    16,,PR1

      927     9595    3               IF NO_ARGS=3 THEN IPT_ACN.V.NCW.CI#=2;

   9595  5 002312   000014 236000 1                  LDQ     NO_ARGS
         5 002313   000003 116007                    CMPQ    3,DL
         5 002314   002320 601000 5                  TNZ     s:9596

   9595  5 002315   000002 222003                    LDX2    2,DU
         5 002316   100016 742100                    STX2    14,,PR1
         5 002317   002322 710000 5                  TRA     s:9597

      928     9596    3               ELSE IPT_ACN.V.NCW.CI#=0;

   9596  5 002320   000000 222003                    LDX2    0,DU
         5 002321   100016 742100                    STX2    14,,PR1

      929     9597    3               IPT_ACN.DBK_=VECTOR(A2(0));

   9597  5 002322   777640 235007                    LDA     -96,DL
         5 002323   200004 236100                    LDQ     @A2,,AUTO
         5 002324   100014 757100                    STAQ    12,,PR1

      930     9598    3               END;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:161  

      931     9599    2           IPT_ACN.V.NCW.AREA_NME_SIZE#=30;

   9599  5 002325   000036 221003                    LDX1    30,DU
         5 002326   100016 441100                    SXL1    14,,PR1

      932     9600    2           IPT_ACN.V_=VECTOR(IPT_ACN.V);

   9600  5 002327   000061 235000 6                  LDA     49
         5 002330   002054 236000 1                  LDQ     FPT$
         5 002331   000016 036003                    ADLQ    14,DU
         5 002332   100000 757100                    STAQ    0,,PR1

      933     9601                %CLIMB(FCN=ACN);

   9609  5 002333   002054 630400 1                  EPPR0   FPT$
         5 002334   000053 631400 6                  EPPR1   43
         5 002335   000000 701000 xent               TSX1    U$ACN
         5 002336   000000 011000                    NOP     0

      934     9615    2           END;

   9615  5 002337   002512 710000 5                  TRA     s:9701

      935     9616    1       ELSE
      936     9617        /****************************************************************/
      937     9618        /*                                                              */
      938     9619        /*    CALL ACCEPT(IDENTIFIER,[REC-NAME],CURRENCY)               */
      939     9620        /*                            SET-NAME  NEXT                    */
      940     9621        /*                            AREA-NAME PRIOR                   */
      941     9622        /*                                      OWNER                   */
      942     9623        /*                                                              */
      943     9624        /****************************************************************/
      944     9625    2       DO;

      945     9626    2           IPT_ACC.DBK_=VECTOR(A1(0));

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:162  
   9626  5 002340   777640 235007                    LDA     -96,DL
         5 002341   200003 236100                    LDQ     @A1,,AUTO
         5 002342   002054 471400 1                  LDP1    FPT$
         5 002343   100012 757100                    STAQ    10,,PR1

      946     9627    3           DO CASE(NO_ARGS);

   9627  5 002344   000014 235000 1                  LDA     NO_ARGS
         5 002345   000004 115007                    CMPA    4,DL
         5 002346   002350 602005 5                  TNC     s:9627+4,AL
         5 002347   002475 710000 5                  TRA     s:9669
         5 002350   002475 710000 5                  TRA     s:9669
         5 002351   002475 710000 5                  TRA     s:9669
         5 002352   002354 710000 5                  TRA     s:9630
         5 002353   002372 710000 5                  TRA     s:9638

      947     9628
      948     9629    3           CASE(2);

      949     9630    3               IF ARG.TYPE(1)~=SNA.CURRENCY THEN CALL ARG_ERROR(40);

   9630  5 002354   000001 236100                    LDQ     1,,PR0
         5 002355   777777 376007                    ANQ     -1,DL
         5 002356   000002 116000 0                  CMPQ    SNA+2
         5 002357   002364 600000 5                  TZE     s:9635

   9630  5 002360   000063 236000 6                  LDQ     51
         5 002361   200037 756100                    STQ     @A+2,,AUTO
         5 002362   000715 701000 5                  TSX1    ARG_ERROR
         5 002363   000000 011000                    NOP     0

      950     9631        /*   ERROR: ZII-40-1
      951     9632              MESSAGE: Bad 2nd argument in ACCEPT CALL.
      952     9633                       The correct syntax is
      953     9634                       CALL ACCEPT(RETURNED-IDENTIFIER,CURRENCY)  */
      954     9635    3               IPT_ACC.V.RVA_ITEM.OFFSET#=NULL_OFFSET;

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:163  
   9635  5 002364   002050 720000 1                  LXL0    NULL_OFFSET
         5 002365   002054 470400 1                  LDP0    FPT$
         5 002366   000016 740100                    STX0    14,,PR0

      955     9636    3               IPT_ACC.V.CCW.SCI#=0;

   9636  5 002367   000000 221003                    LDX1    0,DU
         5 002370   000014 741100                    STX1    12,,PR0
         5 002371   002501 710000 5                  TRA     s:9685

      956     9637    3           CASE(3);

      957     9638    3               IPT_ACC.V.RVA_ITEM.OFFSET#=ARG.OFFSET(1);

   9638  5 002372   000001 221100                    LDX1    1,,PR0
         5 002373   100016 741100                    STX1    14,,PR1

      958     9639    4               DO CASE(ARG.TYPE(1)-%AREA_NAME);

   9639  5 002374   000001 236100                    LDQ     1,,PR0
         5 002375   777777 376007                    ANQ     -1,DL
         5 002376   000037 136007                    SBLQ    31,DL
         5 002377   000003 116007                    CMPQ    3,DL
         5 002400   002402 602006 5                  TNC     s:9639+6,QL
         5 002401   002470 710000 5                  TRA     s:9666
         5 002402   002421 710000 5                  TRA     s:9647
         5 002403   002435 710000 5                  TRA     s:9652
         5 002404   002405 710000 5                  TRA     s:9642

      959     9640
      960     9641    4               CASE(%RECORD_NAME_NET);

      961     9642    4                   IF ARG.TYPE(2)=SNA.CURRENCY THEN

   9642  5 002405   000002 236100                    LDQ     2,,PR0
         5 002406   777777 376007                    ANQ     -1,DL
         5 002407   000002 116000 0                  CMPQ    SNA+2
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:164  
         5 002410   002414 601000 5                  TNZ     s:9645

      962     9643    4                       IPT_ACC.V.CCW.SCI#=1;

   9643  5 002411   000001 222003                    LDX2    1,DU
         5 002412   100014 742100                    STX2    12,,PR1
         5 002413   002501 710000 5                  TRA     s:9685

      963     9644    4                   ELSE
      964     9645    4                       CALL ARG_ERROR(41);

   9645  5 002414   000065 236000 6                  LDQ     53
         5 002415   200037 756100                    STQ     @A+2,,AUTO
         5 002416   000715 701000 5                  TSX1    ARG_ERROR
         5 002417   000000 011000                    NOP     0
         5 002420   002501 710000 5                  TRA     s:9685

      965     9646    4               CASE(%AREA_NAME_NET);

      966     9647    4                   IF ARG.TYPE(2)=SNA.CURRENCY THEN

   9647  5 002421   000002 236100                    LDQ     2,,PR0
         5 002422   777777 376007                    ANQ     -1,DL
         5 002423   000002 116000 0                  CMPQ    SNA+2
         5 002424   002430 601000 5                  TNZ     s:9650

      967     9648    4                       IPT_ACC.V.CCW.SCI#=2;

   9648  5 002425   000002 222003                    LDX2    2,DU
         5 002426   100014 742100                    STX2    12,,PR1
         5 002427   002501 710000 5                  TRA     s:9685

      968     9649    4                   ELSE
      969     9650    4                       CALL ARG_ERROR(41);

   9650  5 002430   000065 236000 6                  LDQ     53
         5 002431   200037 756100                    STQ     @A+2,,AUTO
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:165  
         5 002432   000715 701000 5                  TSX1    ARG_ERROR
         5 002433   000000 011000                    NOP     0
         5 002434   002501 710000 5                  TRA     s:9685

      970     9651    4               CASE(%SET_NAME_NET);

      971     9652    4                   IF ARG.TYPE(2)=SNA.CURRENCY THEN

   9652  5 002435   000002 236100                    LDQ     2,,PR0
         5 002436   777777 376007                    ANQ     -1,DL
         5 002437   000002 116000 0                  CMPQ    SNA+2
         5 002440   002444 601000 5                  TNZ     s:9655

      972     9653    4                       IPT_ACC.V.CCW.SCI#=3;

   9653  5 002441   000003 222003                    LDX2    3,DU
         5 002442   100014 742100                    STX2    12,,PR1
         5 002443   002501 710000 5                  TRA     s:9685

      973     9654    4                   ELSE
      974     9655    4                       IF ARG.TYPE(2)=SNA.NEXT THEN

   9655  5 002444   000013 116000 0                  CMPQ    SNA+11
         5 002445   002451 601000 5                  TNZ     s:9658

      975     9656    4                           IPT_ACC.V.CCW.SCI#=4;

   9656  5 002446   000004 222003                    LDX2    4,DU
         5 002447   100014 742100                    STX2    12,,PR1
         5 002450   002501 710000 5                  TRA     s:9685

      976     9657    4                       ELSE
      977     9658    4                           IF ARG.TYPE(2)=SNA.PRIOR THEN

   9658  5 002451   000017 116000 0                  CMPQ    SNA+15
         5 002452   002456 601000 5                  TNZ     s:9661

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:166  
      978     9659    4                               IPT_ACC.V.CCW.SCI#=5;

   9659  5 002453   000005 222003                    LDX2    5,DU
         5 002454   100014 742100                    STX2    12,,PR1
         5 002455   002501 710000 5                  TRA     s:9685

      979     9660    4                           ELSE
      980     9661    4                               IF ARG.TYPE(2)=SNA.OWNER THEN

   9661  5 002456   000016 116000 0                  CMPQ    SNA+14
         5 002457   002463 601000 5                  TNZ     s:9664

      981     9662    4                                   IPT_ACC.V.CCW.SCI#=6;

   9662  5 002460   000006 222003                    LDX2    6,DU
         5 002461   100014 742100                    STX2    12,,PR1
         5 002462   002501 710000 5                  TRA     s:9685

      982     9663    4                               ELSE
      983     9664    4                                   CALL ARG_ERROR(43);

   9664  5 002463   000067 236000 6                  LDQ     55
         5 002464   200037 756100                    STQ     @A+2,,AUTO
         5 002465   000715 701000 5                  TSX1    ARG_ERROR
         5 002466   000000 011000                    NOP     0
         5 002467   002501 710000 5                  TRA     s:9685

      984     9665    4               CASE(ELSE);

      985     9666    4                   CALL ARG_ERROR(44);

   9666  5 002470   000071 236000 6                  LDQ     57
         5 002471   200037 756100                    STQ     @A+2,,AUTO
         5 002472   000715 701000 5                  TSX1    ARG_ERROR
         5 002473   000000 011000                    NOP     0

      986     9667    4                   END;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:167  

   9667  5 002474   002501 710000 5                  TRA     s:9685

      987     9668    3           CASE(ELSE);

      988     9669    3               CALL ARG_ERROR(45);

   9669  5 002475   000073 236000 6                  LDQ     59
         5 002476   200037 756100                    STQ     @A+2,,AUTO
         5 002477   000715 701000 5                  TSX1    ARG_ERROR
         5 002500   000000 011000                    NOP     0

      989     9670    3               END;

      990     9671
      991     9672        /*    ERROR: ZII-41-1
      992     9673              MESSAGE: Bad 3rd argument in ACCEPT CALL.
      993     9674                       The correct syntax is
      994     9675                       CALL ACCEPT(RETURN-VARIABLE,RECORD-NAME/AREA-NAME,CURRENCY) */
      995     9676        /*    ERROR: ZII-43-1
      996     9677              MESSAGE: Required keyword CURRENCY/NEXT/PRIOR/OWNER missing
      997     9678                       in ACCEPT CALL with 2nd argument a SET-NAME.  */
      998     9679        /*    ERROR: ZII-44-1
      999     9680              MESSAGE: Bad 2nd argument in ACCEPT CALL.
     1000     9681                       Must be a RECORD-NAME/SET-NAME/AREA-NAME.  */
     1001     9682        /*    ERROR: ZII-45-1
     1002     9683              MESSAGE: Number of arguments passed to ACCEPT CALL is less than  2.  */
     1003     9684
     1004     9685    2           IPT_ACC.V_=VECTOR(IPT_ACC.V);

   9685  5 002501   000061 235000 6                  LDA     49
         5 002502   002054 236000 1                  LDQ     FPT$
         5 002503   000014 036003                    ADLQ    12,DU
         5 002504   002054 470400 1                  LDP0    FPT$
         5 002505   000000 757100                    STAQ    0,,PR0

     1005     9686                %CLIMB(FCN=ACC);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:168  

   9694  5 002506   002054 630400 1                  EPPR0   FPT$
         5 002507   000053 631400 6                  EPPR1   43
         5 002510   000000 701000 xent               TSX1    U$ACC
         5 002511   000000 011000                    NOP     0

     1006     9700    2           END;

     1007     9701    1       FPTS.V_=VECTOR(FPTS.V);

   9701  5 002512   000034 235000 6                  LDA     28
         5 002513   002054 236000 1                  LDQ     FPT$
         5 002514   000012 036003                    ADLQ    10,DU
         5 002515   002054 470400 1                  LDP0    FPT$
         5 002516   000000 757100                    STAQ    0,,PR0

     1008     9702    1       GOTO COMMON_RETURN;

   9702  5 002517   005105 710000 5                  TRA     COMMON_RETURN

     1009     9703         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:169  
     1010     9704    1   STORE: ENTRY(A1);

   9704  5 002520   000000 700200 xent  STORE        TSX0  ! X66_AUTO_N
         5 002521   000106 000024                    ZERO    70,20

     1011     9705
     1012     9706        /*    ERROR: ZII-50-1
     1013     9707              MESSAGE: The argument in STORE CALL is not a RECORD-NAME. */
     1014     9708    1       CALL SET_ARGS;

   9708  5 002522   000535 701000 5                  TSX1    SET_ARGS
         5 002523   000000 011000                    NOP     0

     1015     9709    1       IF NO_ARGS~=1 OR ARG.TYPE(0)~=%RECORD_NAME THEN CALL ARG_ERROR(50);

   9709  5 002524   000014 235000 1                  LDA     NO_ARGS
         5 002525   000001 115007                    CMPA    1,DL
         5 002526   002533 601000 5                  TNZ     s:9709+7
         5 002527   002055 470400 1                  LDP0    ARG$
         5 002530   000000 720100                    LXL0    0,,PR0
         5 002531   000041 100003                    CMPX0   33,DU
         5 002532   002537 600000 5                  TZE     s:9710

   9709  5 002533   000075 236000 6                  LDQ     61
         5 002534   200037 756100                    STQ     @A+2,,AUTO
         5 002535   000715 701000 5                  TSX1    ARG_ERROR
         5 002536   000000 011000                    NOP     0

     1016     9710    1       IPT_STO.V.RC.RC_OFFSET#=ARG.OFFSET(0);

   9710  5 002537   002055 470400 1                  LDP0    ARG$
         5 002540   000000 220100                    LDX0    0,,PR0
         5 002541   002054 471400 1                  LDP1    FPT$
         5 002542   100012 740100                    STX0    10,,PR1

     1017     9711    1       IPT_STO.V_ = VECTOR(IPT_STO.V);

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:170  
   9711  5 002543   000061 235000 6                  LDA     49
         5 002544   002054 236000 1                  LDQ     FPT$
         5 002545   000012 036003                    ADLQ    10,DU
         5 002546   100000 757100                    STAQ    0,,PR1

     1018     9712    1       CALL CHK_RETAIN(IPT_STO.V.RLCW,0);

   9712  5 002547   000076 236000 6                  LDQ     62
         5 002550   200034 756100                    STQ     @RLCW+1,,AUTO
         5 002551   002054 236000 1                  LDQ     FPT$
         5 002552   000013 036003                    ADLQ    11,DU
         5 002553   200033 756100                    STQ     @B+1,,AUTO
         5 002554   001530 701000 5                  TSX1    CHK_RETAIN
         5 002555   000000 011000                    NOP     0

     1019     9713            %CLIMB(FCN=STO);

   9721  5 002556   002054 630400 1                  EPPR0   FPT$
         5 002557   000053 631400 6                  EPPR1   43
         5 002560   000000 701000 xent               TSX1    U$STO
         5 002561   000000 011000                    NOP     0

     1020     9727    1       GOTO COMMON_RETURN;

   9727  5 002562   005105 710000 5                  TRA     COMMON_RETURN

     1021     9728
     1022     9729    1   CHECK: ENTRY(A1,A2);

   9729  5 002563   000000 700200 xent  CHECK        TSX0  ! X66_AUTO_N
         5 002564   000106 000024                    ZERO    70,20

     1023     9730
     1024     9731    1       CALL SET_ARGS;

   9731  5 002565   000535 701000 5                  TSX1    SET_ARGS
         5 002566   000000 011000                    NOP     0
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:171  

     1025     9732    1       IF NO_ARGS=0 OR NO_ARGS>2 THEN

   9732  5 002567   000014 235000 1                  LDA     NO_ARGS
         5 002570   002573 600000 5                  TZE     s:9733
         5 002571   000002 115007                    CMPA    2,DL
         5 002572   002577 604400 5                  TMOZ    s:9734

     1026     9733    1           CALL ARG_ERROR(53);

   9733  5 002573   000100 236000 6                  LDQ     64
         5 002574   200037 756100                    STQ     @A+2,,AUTO
         5 002575   000715 701000 5                  TSX1    ARG_ERROR
         5 002576   000000 011000                    NOP     0

     1027     9734    1       IPT_CHK.CHKPT_NUMBER_=VECTOR(A1(0));

   9734  5 002577   777640 235007                    LDA     -96,DL
         5 002600   200003 236100                    LDQ     @A1,,AUTO
         5 002601   000024 470400 1                  LDP0    CHK_NBF_ROL_CRPT$
         5 002602   000004 757100                    STAQ    4,,PR0

     1028     9735        /*    ERROR: ZII-53-1
     1029     9736              MESSAGE: Argument count error in CHECK CALL.
     1030     9737                       The correct format is
     1031     9738                       CALL CHECK(checkpoint-number [,returned-status]) */
     1032     9739    1       IF ADDR(A2)=ADDR(NIL) THEN

   9739  5 002603   200004 236100                    LDQ     @A2,,AUTO
         5 002604   000015 116000 6                  CMPQ    13
         5 002605   002613 601000 5                  TNZ     s:9742

     1033     9740    1           IPT_CHK.ERROR_=VECTOR(PINCRW(UWA$,1)->CHAR7);

   9740  5 002606   000101 235000 6                  LDA     65
         5 002607   002052 236000 1                  LDQ     UWA$
         5 002610   000001 036003                    ADLQ    1,DU
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:172  
         5 002611   000000 757100                    STAQ    0,,PR0
         5 002612   002615 710000 5                  TRA     s:9743

     1034     9741    1       ELSE
     1035     9742    1           IPT_CHK.ERROR_=VECTOR(ADDR(A2)->CHAR7);

   9742  5 002613   000101 235000 6                  LDA     65
         5 002614   000000 757100                    STAQ    0,,PR0

     1036     9743    1       IPT_CHK.IA_=FPTS.IA_;

   9743  5 002615   002054 471400 1                  LDP1    FPT$
         5 002616   100002 237100                    LDAQ    2,,PR1
         5 002617   000002 757100                    STAQ    2,,PR0

     1037     9744            %CLIMB(FCN=CHK);

   9752  5 002620   000024 630400 1                  EPPR0   CHK_NBF_ROL_CRPT$
         5 002621   000053 631400 6                  EPPR1   43
         5 002622   000000 701000 xent               TSX1    U$CHK
         5 002623   000000 011000                    NOP     0

     1038     9758    1       DK_RET.AUTO_OFFSET=-1*(AUTO_FRAME(-2*(AUTO_FRAME(1)+1)+1)+1);

   9758  5 002624   000010 470400 1                  LDP0    AUTO$
         5 002625   003100 060500                    CSL     bolr='003'O
         5 002626   000000 400022                    BDSC    0,,PR0                   by=2,bit=0,n=18
         5 002627   200076 000044                    BDSC    ERRMSG_BUF+30,,AUTO      by=0,bit=0,n=36
         5 002630   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 002631   000022 732000                    QRS     18
         5 002632   000027 402000 6                  MPY     23
         5 002633   000000 116003                    CMPQ    0,DU
         5 002634   002636 605000 5                  TPL     s:9758+10
         5 002635   000044 036003                    ADLQ    36,DU
         5 002636   003100 060506                    CSL     bolr='003'O
         5 002637   077777 400022                    BDSC    -1,Q,PR0                 by=2,bit=0,n=18
         5 002640   200077 000044                    BDSC    ERRMSG_BUF+31,,AUTO      by=0,bit=0,n=36
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:173  
         5 002641   200077 236100                    LDQ     ERRMSG_BUF+31,,AUTO
         5 002642   000022 732000                    QRS     18
         5 002643   000054 676000 6                  ERQ     44
         5 002644   000000 620006                    EAX0    0,QL
         5 002645   000006 740000 1                  STX0    DEADLOCK_RET

     1039     9759    1       GOTO COMMON_RETURN;

   9759  5 002646   005105 710000 5                  TRA     COMMON_RETURN

     1040     9760         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:174  
     1041     9761    1   ERASER: ENTRY(A1,A2);

   9761  5 002647   000000 700200 xent  ERASER       TSX0  ! X66_AUTO_N
         5 002650   000106 000024                    ZERO    70,20

     1042     9762
     1043     9763        /*    ERROR: ZII-55-1
     1044     9764              MESSAGE: Bad arguments found in ERASE CALL.
     1045     9765                       The correct syntax is CALL ERASE([RECORD-NAME][,ALL]). */
     1046     9766    1       CALL SET_ARGS;

   9766  5 002651   000535 701000 5                  TSX1    SET_ARGS
         5 002652   000000 011000                    NOP     0

     1047     9767    1       IPT_ERS.V.RC.RC_OFFSET#=NULL_OFFSET;

   9767  5 002653   002050 720000 1                  LXL0    NULL_OFFSET
         5 002654   002054 470400 1                  LDP0    FPT$
         5 002655   000012 740100                    STX0    10,,PR0

     1048     9768    1       IF NO_ARGS>0 THEN

   9768  5 002656   000014 235000 1                  LDA     NO_ARGS
         5 002657   002710 604400 5                  TMOZ    s:9777

     1049     9769    2       DO;

     1050     9770    2           IF ARG.TYPE(0)=%RECORD_NAME THEN

   9770  5 002660   002055 471400 1                  LDP1    ARG$
         5 002661   100000 721100                    LXL1    0,,PR1
         5 002662   000041 101003                    CMPX1   33,DU
         5 002663   002667 601000 5                  TNZ     s:9772

     1051     9771    2               IPT_ERS.V.RC.RC_OFFSET#=ARG.OFFSET(0);

   9771  5 002664   100000 222100                    LDX2    0,,PR1
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:175  
         5 002665   000012 742100                    STX2    10,,PR0
         5 002666   002702 710000 5                  TRA     s:9775

     1052     9772    2           ELSE IF ARG.TYPE(0)=SNA.ALL THEN

   9772  5 002667   100000 236100                    LDQ     0,,PR1
         5 002670   777777 376007                    ANQ     -1,DL
         5 002671   000000 116000 0                  CMPQ    SNA
         5 002672   002676 601000 5                  TNZ     s:9774

     1053     9773    2                   IPT_ERS.V.ECW.EC_BIT#='1'B;

   9773  5 002673   400000 236003                    LDQ     -131072,DU
         5 002674   000013 256100                    ORSQ    11,,PR0
         5 002675   002702 710000 5                  TRA     s:9775

     1054     9774    2               ELSE CALL ARG_ERROR(55);

   9774  5 002676   000103 236000 6                  LDQ     67
         5 002677   200037 756100                    STQ     @A+2,,AUTO
         5 002700   000715 701000 5                  TSX1    ARG_ERROR
         5 002701   000000 011000                    NOP     0

     1055     9775    2           IF ADDR(A2)=ADDR(SNA.ALL) THEN IPT_ERS.V.ECW.EC_BIT#='1'B;

   9775  5 002702   000023 236000 6                  LDQ     19
         5 002703   200004 116100                    CMPQ    @A2,,AUTO
         5 002704   002710 601000 5                  TNZ     s:9777

   9775  5 002705   002054 470400 1                  LDP0    FPT$
         5 002706   400000 236003                    LDQ     -131072,DU
         5 002707   000013 256100                    ORSQ    11,,PR0

     1056     9776    2           END;

     1057     9777    1       IPT_ERS.V_ = VECTOR(IPT_ERS.V);

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:176  
   9777  5 002710   000012 235000 6                  LDA     10
         5 002711   002054 236000 1                  LDQ     FPT$
         5 002712   000012 036003                    ADLQ    10,DU
         5 002713   002054 470400 1                  LDP0    FPT$
         5 002714   000000 757100                    STAQ    0,,PR0

     1058     9778    1       IPT_FCR.V_ = VECTOR(IPT_FCR.V);

   9778  5 002715   000012 235000 6                  LDA     10
         5 002716   002054 236000 1                  LDQ     FPT$
         5 002717   000012 036003                    ADLQ    10,DU
         5 002720   000000 757100                    STAQ    0,,PR0

     1059     9779            %CLIMB(FCN=ERS);

   9787  5 002721   002054 630400 1                  EPPR0   FPT$
         5 002722   000053 631400 6                  EPPR1   43
         5 002723   000000 701000 xent               TSX1    U$ERS
         5 002724   000000 011000                    NOP     0

     1060     9793    1       GOTO COMMON_RETURN;

   9793  5 002725   005105 710000 5                  TRA     COMMON_RETURN

     1061     9794         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:177  
     1062     9795        /**   COMMON CALLING SEQUENCES FOR 'CALL FIND(DBKEY)'   **/
     1063     9796
     1064     9797    1   FINDBKEY: PROC;

   9797  5 002726   200030 741300       FINDBKEY     STX1  ! FIT$+1,,AUTO

     1065     9798
     1066     9799    2       CALL CHK_RETAIN(IPT_FDR.V.RLCW,0);

   9799  5 002727   000076 236000 6                  LDQ     62
         5 002730   200034 756100                    STQ     @OFFSET,,AUTO
         5 002731   002054 236000 1                  LDQ     FPT$
         5 002732   000016 036003                    ADLQ    14,DU
         5 002733   200033 756100                    STQ     @RLCW,,AUTO
         5 002734   001530 701000 5                  TSX1    CHK_RETAIN
         5 002735   000000 011000                    NOP     0

     1067     9800    3       IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;

   9800  5 002736   002060 470400 1                  LDP0    RLCW$
         5 002737   000000 236100                    LDQ     0,,PR0
         5 002740   000377 316007                    CANQ    255,DL
         5 002741   002757 600000 5                  TZE     s:9809

     1068     9801    3           VBASE(IPT_FDR.V_) = ADDR(IPT_FDR.V);

   9801  5 002742   002054 236000 1                  LDQ     FPT$
         5 002743   000014 036003                    ADLQ    12,DU
         5 002744   002054 471400 1                  LDP1    FPT$
         5 002745   100001 756100                    STQ     1,,PR1

     1069     9802    3           VBOUND(IPT_FDR.V_) = SIZEC(IPT_FDR.V.RC) +

   9802  5 002746   000000 236100                    LDQ     0,,PR0
         5 002747   000002 736000                    QLS     2
         5 002750   001774 376007                    ANQ     1020,DL
         5 002751   000010 036007                    ADLQ    8,DL
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:178  
         5 002752   000020 736000                    QLS     16
         5 002753   100000 676100                    ERQ     0,,PR1
         5 002754   000000 376000 6                  ANQ     0
         5 002755   100000 656100                    ERSQ    0,,PR1

     1070     9803    3              SIZEC(IPT_FDR.V.RLCW) +
     1071     9804    3              SIZEC(IPT_FDR.V.RETENTION_LIST) *
     1072     9805    3              (RLCW_SAVE.N_SETS#);
     1073     9806         /* no parms from retention list */
     1074     9807    3           END;

   9807  5 002756   002764 710000 5                  TRA     s:9819

     1075     9808    3       ELSE DO;

     1076     9809    3           IPT_FDR.V_ = VECTOR(IPT_FDR.V);

   9809  5 002757   000061 235000 6                  LDA     49
         5 002760   002054 236000 1                  LDQ     FPT$
         5 002761   000014 036003                    ADLQ    12,DU
         5 002762   002054 471400 1                  LDP1    FPT$
         5 002763   100000 757100                    STAQ    0,,PR1

     1077     9810    3           END;

     1078     9811            %CLIMB(FCN=FDR);

   9819  5 002764   002054 630400 1                  EPPR0   FPT$
         5 002765   000053 631400 6                  EPPR1   43
         5 002766   000000 701000 xent               TSX1    U$FDR
         5 002767   000000 011000                    NOP     0

     1079     9825    2       FPTS.V_=VECTOR(FPTS.V);

   9825  5 002770   000034 235000 6                  LDA     28
         5 002771   002054 236000 1                  LDQ     FPT$
         5 002772   000012 036003                    ADLQ    10,DU
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:179  
         5 002773   002054 470400 1                  LDP0    FPT$
         5 002774   000000 757100                    STAQ    0,,PR0

     1080     9826    2   END;

   9826  5 002775   200030 221300                    LDX1  ! FIT$+1,,AUTO
         5 002776   000001 702211                    TSX2  ! 1,X1

     1081     9827
     1082     9828    1   FIND: ENTRY(

   9828  5 002777   000000 700200 xent  FIND         TSX0  ! X66_AUTO_N
         5 003000   000106 000024                    ZERO    70,20

     1083     9829               %GEN_PARAMS;
     1084    10370
     1085    10371    1       CALL SET_ARGS;

  10371  5 003001   000535 701000 5                  TSX1    SET_ARGS
         5 003002   000000 011000                    NOP     0

     1086    10372    1       IF NO_ARGS=1 AND ARG.TYPE(0)=SNA.CURRENT THEN

  10372  5 003003   000014 235000 1                  LDA     NO_ARGS
         5 003004   000001 115007                    CMPA    1,DL
         5 003005   003027 601000 5                  TNZ     s:10394
         5 003006   002055 470400 1                  LDP0    ARG$
         5 003007   000000 236100                    LDQ     0,,PR0
         5 003010   777777 376007                    ANQ     -1,DL
         5 003011   000003 116000 0                  CMPQ    SNA+3
         5 003012   003027 601000 5                  TNZ     s:10394

     1087    10373    2       DO;

     1088    10374    2           CALL CHK_RETAIN(IPT_FCR.V.RLCW,0); /* CALL FIND(CURRENT) */

  10374  5 003013   000076 236000 6                  LDQ     62
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:180  
         5 003014   200034 756100                    STQ     @RLCW+1,,AUTO
         5 003015   002054 236000 1                  LDQ     FPT$
         5 003016   000012 036003                    ADLQ    10,DU
         5 003017   200033 756100                    STQ     @B+1,,AUTO
         5 003020   001530 701000 5                  TSX1    CHK_RETAIN
         5 003021   000000 011000                    NOP     0

     1089    10375                %CLIMB(FCN=FCR); /* FIND CURRENT OF RUN */

  10383  5 003022   002054 630400 1                  EPPR0   FPT$
         5 003023   000053 631400 6                  EPPR1   43
         5 003024   000000 701000 xent               TSX1    U$FCR
         5 003025   000000 011000                    NOP     0

     1090    10389    2           GOTO COMMON_RETURN;

  10389  5 003026   005105 710000 5                  TRA     COMMON_RETURN

     1091    10390    2           END;
     1092    10391        /*    ERROR: ZII-60-1
     1093    10392              MESSAGE: Syntax error in FIND CALL.
     1094    10393                       Argument count is less than 2.  */
     1095    10394    1       IF NO_ARGS<2 THEN CALL ARG_ERROR(60);

  10394  5 003027   000002 115007                    CMPA    2,DL
         5 003030   003035 605000 5                  TPL     s:10395

  10394  5 003031   000105 236000 6                  LDQ     69
         5 003032   200037 756100                    STQ     @A+2,,AUTO
         5 003033   000715 701000 5                  TSX1    ARG_ERROR
         5 003034   000000 011000                    NOP     0

     1096    10395    1       IF ARG.TYPE(NO_ARGS-2)=SNA.USING THEN

  10395  5 003035   002055 470400 1                  LDP0    ARG$
         5 003036   000014 720000 1                  LXL0    NO_ARGS
         5 003037   077776 236110                    LDQ     -2,X0,PR0
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:181  
         5 003040   777777 376007                    ANQ     -1,DL
         5 003041   000032 116000 0                  CMPQ    SNA+26
         5 003042   003255 601000 5                  TNZ     s:10511

     1097    10396    2       DO;

     1098    10397        /**************************************************************/
     1099    10398        /*                                                            */
     1100    10399        /*     TYPE OF FIND: USING KEY (KEY IN INDEX)                 */
     1101    10400        /*                                                            */
     1102    10401        /*                FIRST[,REC-NAME]                            */
     1103    10402        /*     CALL FIND(<NEXT [,REC-NAME]>,USING,KEY-NAME)           */
     1104    10403        /*                  REC-NAME                                  */
     1105    10404        /*                                                            */
     1106    10405        /**************************************************************/
     1107    10406
     1108    10407    2           IF ARG.TYPE(0)=%RECORD_NAME THEN

  10407  5 003043   000000 721100                    LXL1    0,,PR0
         5 003044   000041 101003                    CMPX1   33,DU
         5 003045   003123 601000 5                  TNZ     s:10445

     1109    10408    3           DO;

     1110    10409    3               IF ARG.TYPE(2)~=%SET_NAME THEN CALL ARG_ERROR(65);

  10409  5 003046   000002 722100                    LXL2    2,,PR0
         5 003047   000040 102003                    CMPX2   32,DU
         5 003050   003055 600000 5                  TZE     s:10413

  10409  5 003051   000107 236000 6                  LDQ     71
         5 003052   200037 756100                    STQ     @A+2,,AUTO
         5 003053   000715 701000 5                  TSX1    ARG_ERROR
         5 003054   000000 011000                    NOP     0

     1111    10410        /*    ERROR: ZII-65-1
     1112    10411              MESSAGE: Bad 3rd argument in FIND CALL.
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:182  
     1113    10412                       The correct syntax is CALL FIND(RECORD-NAME,USING,KEY-NAME) */
     1114    10413    3               IPT_FUI.V.RC.RC_OFFSET#=ARG.OFFSET(0);

  10413  5 003055   002055 470400 1                  LDP0    ARG$
         5 003056   000000 220100                    LDX0    0,,PR0
         5 003057   002054 471400 1                  LDP1    FPT$
         5 003060   100012 740100                    STX0    10,,PR1

     1115    10414    3               IPT_FUI.V.SC.SC_OFFSET#=ARG.OFFSET(2);

  10414  5 003061   000002 221100                    LDX1    2,,PR0
         5 003062   100013 741100                    STX1    11,,PR1

     1116    10415    4               IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;

  10415  5 003063   002060 473400 1                  LDP3    RLCW$
         5 003064   300000 236100                    LDQ     0,,PR3
         5 003065   000377 316007                    CANQ    255,DL
         5 003066   003103 600000 5                  TZE     s:10425

     1117    10416    4                   VBASE(IPT_FUI.V_) = ADDR(IPT_FUI.V);

  10416  5 003067   002054 236000 1                  LDQ     FPT$
         5 003070   000012 036003                    ADLQ    10,DU
         5 003071   100001 756100                    STQ     1,,PR1

     1118    10417    4                   VBOUND(IPT_FUI.V_) = SIZEC(IPT_FUI.V.RC) +

  10417  5 003072   300000 236100                    LDQ     0,,PR3
         5 003073   000002 736000                    QLS     2
         5 003074   001774 376007                    ANQ     1020,DL
         5 003075   000014 036007                    ADLQ    12,DL
         5 003076   000020 736000                    QLS     16
         5 003077   100000 676100                    ERQ     0,,PR1
         5 003100   000000 376000 6                  ANQ     0
         5 003101   100000 656100                    ERSQ    0,,PR1

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:183  
     1119    10418    4                      SIZEC(IPT_FUI.V.SC) +
     1120    10419    4                      SIZEC(IPT_FUI.V.RLCW) +
     1121    10420    4                      SIZEC(IPT_FUI.V.RETENTION_LIST) *
     1122    10421    4                      (RLCW_SAVE.N_SETS#);
     1123    10422         /* no parms from retention list */
     1124    10423    4                   END;

  10423  5 003102   003107 710000 5                  TRA     s:10427

     1125    10424    4               ELSE DO;

     1126    10425    4                   IPT_FUI.V_ = VECTOR(IPT_FUI.V);

  10425  5 003103   000061 235000 6                  LDA     49
         5 003104   002054 236000 1                  LDQ     FPT$
         5 003105   000012 036003                    ADLQ    10,DU
         5 003106   100000 757100                    STAQ    0,,PR1

     1127    10426    4                   END;

     1128    10427    3               CALL CHK_RETAIN(IPT_FUI.V.RLCW,0);

  10427  5 003107   000076 236000 6                  LDQ     62
         5 003110   200034 756100                    STQ     @RLCW+1,,AUTO
         5 003111   002054 236000 1                  LDQ     FPT$
         5 003112   000014 036003                    ADLQ    12,DU
         5 003113   200033 756100                    STQ     @B+1,,AUTO
         5 003114   001530 701000 5                  TSX1    CHK_RETAIN
         5 003115   000000 011000                    NOP     0

     1129    10428                    %CLIMB(FCN=FUI);

  10436  5 003116   002054 630400 1                  EPPR0   FPT$
         5 003117   000053 631400 6                  EPPR1   43
         5 003120   000000 701000 xent               TSX1    U$FUI
         5 003121   000000 011000                    NOP     0

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:184  
     1130    10442    3               END;

  10442  5 003122   004421 710000 5                  TRA     s:10985

     1131    10443    2           ELSE
     1132    10444    3           DO;

     1133    10445    3               IF ARG.TYPE(0)=SNA.FIRST THEN

  10445  5 003123   000000 236100                    LDQ     0,,PR0
         5 003124   777777 376007                    ANQ     -1,DL
         5 003125   000006 116000 0                  CMPQ    SNA+6
         5 003126   003133 601000 5                  TNZ     s:10448

     1134    10446    3                   IPT_FRI.V.FCW.RECORD_LOCATION#=0;

  10446  5 003127   000000 222003                    LDX2    0,DU
         5 003130   002054 471400 1                  LDP1    FPT$
         5 003131   100012 742100                    STX2    10,,PR1
         5 003132   003145 710000 5                  TRA     s:10455

     1135    10447    3               ELSE
     1136    10448    3                   IF ARG.TYPE(0)=SNA.NEXT THEN

  10448  5 003133   000013 116000 0                  CMPQ    SNA+11
         5 003134   003141 601000 5                  TNZ     s:10451

     1137    10449    3                       IPT_FRI.V.FCW.RECORD_LOCATION#=1;

  10449  5 003135   000001 222003                    LDX2    1,DU
         5 003136   002054 471400 1                  LDP1    FPT$
         5 003137   100012 742100                    STX2    10,,PR1
         5 003140   003145 710000 5                  TRA     s:10455

     1138    10450    3                   ELSE
     1139    10451    3                       CALL ARG_ERROR(70);

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:185  
  10451  5 003141   000111 236000 6                  LDQ     73
         5 003142   200037 756100                    STQ     @A+2,,AUTO
         5 003143   000715 701000 5                  TSX1    ARG_ERROR
         5 003144   000000 011000                    NOP     0

     1140    10452        /*    ERROR: ZII-70-1
     1141    10453              MESSAGE: Required keyword FIRST/NEXT missing in
     1142    10454                       CALL FIND(NEXT/FIRST,[RECORD-NAME],USING,KEY-NAME) */
     1143    10455    3               IF ARG.TYPE(2)=SNA.USING THEN

  10455  5 003145   002055 470400 1                  LDP0    ARG$
         5 003146   000002 236100                    LDQ     2,,PR0
         5 003147   777777 376007                    ANQ     -1,DL
         5 003150   000032 116000 0                  CMPQ    SNA+26
         5 003151   003173 601000 5                  TNZ     s:10467

     1144    10456    4               DO;

     1145    10457    4                   IF ARG.TYPE(1)~=%RECORD_NAME OR ARG.TYPE(3)~=%SET_NAME THEN

  10457  5 003152   000001 720100                    LXL0    1,,PR0
         5 003153   000041 100003                    CMPX0   33,DU
         5 003154   003160 601000 5                  TNZ     s:10458
         5 003155   000003 721100                    LXL1    3,,PR0
         5 003156   000040 101003                    CMPX1   32,DU
         5 003157   003164 600000 5                  TZE     s:10464

     1146    10458    4                       CALL ARG_ERROR(75);

  10458  5 003160   000113 236000 6                  LDQ     75
         5 003161   200037 756100                    STQ     @A+2,,AUTO
         5 003162   000715 701000 5                  TSX1    ARG_ERROR
         5 003163   000000 011000                    NOP     0

     1147    10459        /*    ERROR: ZII-75-1
     1148    10460              MESSAGE: The 2nd argument in FIND CALL is not a RECORD-NAME,
     1149    10461                       or the 4th argument is not a SET-NAME.
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:186  
     1150    10462                       The correct syntax is
     1151    10463                       CALL FIND(NEXT/FIRST,RECORD-NAME,USING,KEY-NAME) */
     1152    10464    4                   IPT_FRI.V.RC.RC_OFFSET#=ARG.OFFSET(1);

  10464  5 003164   002055 470400 1                  LDP0    ARG$
         5 003165   000001 220100                    LDX0    1,,PR0
         5 003166   002054 471400 1                  LDP1    FPT$
         5 003167   100013 740100                    STX0    11,,PR1

     1153    10465    4                   IPT_FRI.V.SC.SC_OFFSET#=ARG.OFFSET(3);

  10465  5 003170   000003 221100                    LDX1    3,,PR0
         5 003171   100014 741100                    STX1    12,,PR1

     1154    10466    4                   END;

  10466  5 003172   003213 710000 5                  TRA     s:10478

     1155    10467    3               ELSE IF NO_ARGS=3 AND ARG.TYPE(2)=%SET_NAME THEN

  10467  5 003173   000014 235000 1                  LDA     NO_ARGS
         5 003174   000003 115007                    CMPA    3,DL
         5 003175   003207 601000 5                  TNZ     s:10473
         5 003176   000002 720100                    LXL0    2,,PR0
         5 003177   000040 100003                    CMPX0   32,DU
         5 003200   003207 601000 5                  TNZ     s:10473

     1156    10468    4                   DO;

     1157    10469    4                       IPT_FRI.V.RC.RC_OFFSET#=NULL_OFFSET;

  10469  5 003201   002050 721000 1                  LXL1    NULL_OFFSET
         5 003202   002054 471400 1                  LDP1    FPT$
         5 003203   100013 741100                    STX1    11,,PR1

     1158    10470    4                       IPT_FRI.V.SC.SC_OFFSET#=ARG.OFFSET(2);

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:187  
  10470  5 003204   000002 220100                    LDX0    2,,PR0
         5 003205   100014 740100                    STX0    12,,PR1

     1159    10471    4                       END;

  10471  5 003206   003213 710000 5                  TRA     s:10478

     1160    10472    3                   ELSE
     1161    10473    3                       CALL ARG_ERROR(80);

  10473  5 003207   000115 236000 6                  LDQ     77
         5 003210   200037 756100                    STQ     @A+2,,AUTO
         5 003211   000715 701000 5                  TSX1    ARG_ERROR
         5 003212   000000 011000                    NOP     0

     1162    10474        /*    ERROR: ZII-80-1
     1163    10475              MESSAGE: 3rd argument in FIND CALL is not a KEY-NAME.
     1164    10476                       The correct syntax is
     1165    10477                       CALL FIND(FIRST/NEXT,USING,KEY-NAME)  */
     1166    10478    3               CALL CHK_RETAIN(IPT_FRI.V.RLCW,0);

  10478  5 003213   000076 236000 6                  LDQ     62
         5 003214   200034 756100                    STQ     @RLCW+1,,AUTO
         5 003215   002054 236000 1                  LDQ     FPT$
         5 003216   000015 036003                    ADLQ    13,DU
         5 003217   200033 756100                    STQ     @B+1,,AUTO
         5 003220   001530 701000 5                  TSX1    CHK_RETAIN
         5 003221   000000 011000                    NOP     0

     1167    10479    4               IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;

  10479  5 003222   002060 470400 1                  LDP0    RLCW$
         5 003223   000000 236100                    LDQ     0,,PR0
         5 003224   000377 316007                    CANQ    255,DL
         5 003225   003243 600000 5                  TZE     s:10490

     1168    10480    4                   VBASE(IPT_FRI.V_) = ADDR(IPT_FRI.V);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:188  

  10480  5 003226   002054 236000 1                  LDQ     FPT$
         5 003227   000012 036003                    ADLQ    10,DU
         5 003230   002054 471400 1                  LDP1    FPT$
         5 003231   100001 756100                    STQ     1,,PR1

     1169    10481    4                   VBOUND(IPT_FRI.V_) = SIZEC(IPT_FRI.V.FCW) +

  10481  5 003232   000000 236100                    LDQ     0,,PR0
         5 003233   000002 736000                    QLS     2
         5 003234   001774 376007                    ANQ     1020,DL
         5 003235   000020 036007                    ADLQ    16,DL
         5 003236   000020 736000                    QLS     16
         5 003237   100000 676100                    ERQ     0,,PR1
         5 003240   000000 376000 6                  ANQ     0
         5 003241   100000 656100                    ERSQ    0,,PR1

     1170    10482    4                      SIZEC(IPT_FRI.V.RC) +
     1171    10483    4                      SIZEC(IPT_FRI.V.SC) +
     1172    10484    4                      SIZEC(IPT_FRI.V.RLCW) +
     1173    10485    4                      SIZEC(IPT_FRI.V.RETENTION_LIST) *
     1174    10486    4                      (RLCW_SAVE.N_SETS#);
     1175    10487    4                   END;

  10487  5 003242   003250 710000 5                  TRA     s:10500

     1176    10488         /* no parms from retention list */
     1177    10489    4               ELSE DO;

     1178    10490    4                   IPT_FRI.V_ = VECTOR(IPT_FRI.V);

  10490  5 003243   000116 235000 6                  LDA     78
         5 003244   002054 236000 1                  LDQ     FPT$
         5 003245   000012 036003                    ADLQ    10,DU
         5 003246   002054 471400 1                  LDP1    FPT$
         5 003247   100000 757100                    STAQ    0,,PR1

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:189  
     1179    10491    4                   END;

     1180    10492                    %CLIMB(FCN=FRI);

  10500  5 003250   002054 630400 1                  EPPR0   FPT$
         5 003251   000053 631400 6                  EPPR1   43
         5 003252   000000 701000 xent               TSX1    U$FRI
         5 003253   000000 011000                    NOP     0

     1181    10506    3               END;

     1182    10507    2           END;

  10507  5 003254   004421 710000 5                  TRA     s:10985

     1183    10508         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:190  
     1184    10509    1       ELSE
     1185    10510    2       DO;

     1186    10511    3           DO CASE(ARG.TYPE(0));

  10511  5 003255   000000 721100                    LXL1    0,,PR0
         5 003256   000042 101003                    CMPX1   34,DU
         5 003257   003261 602011 5                  TNC     s:10511+4,X1
         5 003260   004263 710000 5                  TRA     s:10916
         5 003261   004263 710000 5                  TRA     s:10916
         5 003262   004263 710000 5                  TRA     s:10916
         5 003263   004263 710000 5                  TRA     s:10916
         5 003264   003540 710000 5                  TRA     s:10633
         5 003265   004263 710000 5                  TRA     s:10916
         5 003266   004263 710000 5                  TRA     s:10916
         5 003267   004263 710000 5                  TRA     s:10916
         5 003270   003760 710000 5                  TRA     s:10741
         5 003271   003527 710000 5                  TRA     s:10621
         5 003272   003540 710000 5                  TRA     s:10633
         5 003273   004263 710000 5                  TRA     s:10916
         5 003274   004263 710000 5                  TRA     s:10916
         5 003275   004263 710000 5                  TRA     s:10916
         5 003276   004263 710000 5                  TRA     s:10916
         5 003277   004263 710000 5                  TRA     s:10916
         5 003300   003760 710000 5                  TRA     s:10741
         5 003301   004263 710000 5                  TRA     s:10916
         5 003302   004263 710000 5                  TRA     s:10916
         5 003303   004203 710000 5                  TRA     s:10873
         5 003304   003760 710000 5                  TRA     s:10741
         5 003305   004263 710000 5                  TRA     s:10916
         5 003306   004263 710000 5                  TRA     s:10916
         5 003307   004263 710000 5                  TRA     s:10916
         5 003310   004263 710000 5                  TRA     s:10916
         5 003311   004263 710000 5                  TRA     s:10916
         5 003312   004263 710000 5                  TRA     s:10916
         5 003313   004263 710000 5                  TRA     s:10916
         5 003314   004263 710000 5                  TRA     s:10916
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:191  
         5 003315   004263 710000 5                  TRA     s:10916
         5 003316   004263 710000 5                  TRA     s:10916
         5 003317   004263 710000 5                  TRA     s:10916
         5 003320   004263 710000 5                  TRA     s:10916
         5 003321   004263 710000 5                  TRA     s:10916
         5 003322   003323 710000 5                  TRA     s:10513

     1187    10512    3           CASE(%RECORD_NAME);

     1188    10513    3               IF ARG.TYPE(1)=SNA.DBKEY THEN

  10513  5 003323   000001 236100                    LDQ     1,,PR0
         5 003324   777777 376007                    ANQ     -1,DL
         5 003325   000004 116000 0                  CMPQ    SNA+4
         5 003326   003340 601000 5                  TNZ     s:10528

     1189    10514    4               DO;

     1190    10515
     1191    10516        /****************************************************************/
     1192    10517        /*                                                              */
     1193    10518        /*            TYPE OF FIND: DIRECT BY GIVING DBKEY              */
     1194    10519        /*                                                              */
     1195    10520        /*            CALL FIND(REC-NAME,DBKEY,IDENTIFIER)              */
     1196    10521        /*                                                              */
     1197    10522        /****************************************************************/
     1198    10523
     1199    10524    4                   IPT_FDR.V.RC.RC_OFFSET#=ARG.OFFSET(0);

  10524  5 003327   000000 222100                    LDX2    0,,PR0
         5 003330   002054 471400 1                  LDP1    FPT$
         5 003331   100014 742100                    STX2    12,,PR1

     1200    10525    4                   IPT_FDR.DBK_=VECTOR(A3);

  10525  5 003332   777640 235007                    LDA     -96,DL
         5 003333   200005 236100                    LDQ     @A3,,AUTO
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:192  
         5 003334   100012 757100                    STAQ    10,,PR1

     1201    10526    4                   CALL FINDBKEY;

  10526  5 003335   002726 701000 5                  TSX1    FINDBKEY
         5 003336   000000 011000                    NOP     0

     1202    10527    4                   END;

  10527  5 003337   004421 710000 5                  TRA     s:10985

     1203    10528    3               ELSE IF ARG.TYPE(1)=SNA.WITHIN THEN

  10528  5 003340   000033 116000 0                  CMPQ    SNA+27
         5 003341   003522 601000 5                  TNZ     s:10605

     1204    10529    4                   DO;

     1205    10530
     1206    10531        /***************************************************************/
     1207    10532        /*                                                             */
     1208    10533        /*            TYPE OF FIND: WITH KEY WITHIN CURRENT SET        */
     1209    10534        /*                                                             */
     1210    10535        /*            CALL FIND(REC-NAME,WITHIN,SET-NAME,[CURRENT]     */
     1211    10536        /*                      [,IDENT-5],[IDENT-6],....])            */
     1212    10537        /*                                                             */
     1213    10538        /***************************************************************/
     1214    10539
     1215    10540    4                       IF ARG.TYPE(2)~=%SET_NAME THEN CALL ARG_ERROR(85);

  10540  5 003342   000002 722100                    LXL2    2,,PR0
         5 003343   000040 102003                    CMPX2   32,DU
         5 003344   003351 600000 5                  TZE     s:10545

  10540  5 003345   000120 236000 6                  LDQ     80
         5 003346   200037 756100                    STQ     @A+2,,AUTO
         5 003347   000715 701000 5                  TSX1    ARG_ERROR
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:193  
         5 003350   000000 011000                    NOP     0

     1216    10541        /*    ERROR: ZII-85-1
     1217    10542              MESSAGE: 3rd argument in FIND CALL is not a SET-NAME.
     1218    10543                       The correct syntax is
     1219    10544                       CALL FIND(RECORD-NAME,WITHIN,SET-NAME,[CURRENT],...) */
     1220    10545    4                       IPT_FKC.V.RC.RC_OFFSET#=ARG.OFFSET(0);

  10545  5 003351   002055 470400 1                  LDP0    ARG$
         5 003352   000000 220100                    LDX0    0,,PR0
         5 003353   002054 471400 1                  LDP1    FPT$
         5 003354   100012 740100                    STX0    10,,PR1

     1221    10546    4                       IPT_FKC.V.SC.SC_OFFSET#=ARG.OFFSET(2);

  10546  5 003355   000002 221100                    LDX1    2,,PR0
         5 003356   100013 741100                    STX1    11,,PR1

     1222    10547    4                       IF NO_ARGS>3 AND ARG.TYPE(3)=SNA.CURRENT THEN

  10547  5 003357   000014 235000 1                  LDA     NO_ARGS
         5 003360   000003 115007                    CMPA    3,DL
         5 003361   003371 604400 5                  TMOZ    s:10548+3
         5 003362   000003 236100                    LDQ     3,,PR0
         5 003363   777777 376007                    ANQ     -1,DL
         5 003364   000003 116000 0                  CMPQ    SNA+3
         5 003365   003371 601000 5                  TNZ     s:10548+3

     1223    10548    4                           I=4; ELSE I=3;

  10548  5 003366   000004 235007                    LDA     4,DL
         5 003367   000003 755000 1                  STA     I
         5 003370   003373 710000 5                  TRA     s:10549

  10548  5 003371   000003 236007                    LDQ     3,DL
         5 003372   000003 756000 1                  STQ     I

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:194  
     1224    10549    5                       DO J=I TO NO_ARGS-1;

  10549  5 003373   000003 235000 1                  LDA     I
         5 003374   000005 755000 1                  STA     J
         5 003375   003417 710000 5                  TRA     s:10556+1

     1225    10550        /*    ERROR: ZII-90-1
     1226    10551              MESSAGE: The variable length argument list in FIND CALL
     1227    10552                       does not contain all FIELD-NAMES. The correct syntax is
     1228    10553                       CALL FIND(REC-NAME,WITHIN,SET-NAME,FIELD-NAME,....).  */
     1229    10554    5                           IF ARG.TYPE(J)~=%FIELD_NAME THEN CALL ARG_ERROR(90);

  10554  5 003376   002055 470400 1                  LDP0    ARG$
         5 003377   000005 720000 1                  LXL0    J
         5 003400   000000 721110                    LXL1    0,X0,PR0
         5 003401   000042 101003                    CMPX1   34,DU
         5 003402   003407 600000 5                  TZE     s:10555

  10554  5 003403   000122 236000 6                  LDQ     82
         5 003404   200037 756100                    STQ     @A+2,,AUTO
         5 003405   000715 701000 5                  TSX1    ARG_ERROR
         5 003406   000000 011000                    NOP     0

     1230    10555    5                           IPT_FKC.V.FL_RL_LIST.RVA_OFFSET#(J-I)=ARG.OFFSET(J);

  10555  5 003407   000005 236000 1                  LDQ     J
         5 003410   000003 136000 1                  SBLQ    I
         5 003411   002055 470400 1                  LDP0    ARG$
         5 003412   000005 720000 1                  LXL0    J
         5 003413   000000 221110                    LDX1    0,X0,PR0
         5 003414   002054 471400 1                  LDP1    FPT$
         5 003415   100016 741106                    STX1    14,QL,PR1

     1231    10556    5                           END;

  10556  5 003416   000005 054000 1                  AOS     J
         5 003417   000005 236000 1                  LDQ     J
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:195  
         5 003420   000014 116000 1                  CMPQ    NO_ARGS
         5 003421   003376 604000 5                  TMI     s:10554

     1232    10557    4                       IPT_FKC.V.FLCW.N_FIELDS#=NO_ARGS-I;

  10557  5 003422   000014 236000 1                  LDQ     NO_ARGS
         5 003423   000003 136000 1                  SBLQ    I
         5 003424   000000 620006                    EAX0    0,QL
         5 003425   100014 740100                    STX0    12,,PR1

     1233    10558    4                       CALL CHK_RETAIN(IPT_FKC.V.RLCW,IPT_FKC.V.FLCW.N_FIELDS#);

  10558  5 003426   002054 236000 1                  LDQ     FPT$
         5 003427   000014 036003                    ADLQ    12,DU
         5 003430   200034 756100                    STQ     @RLCW+1,,AUTO
         5 003431   002054 236000 1                  LDQ     FPT$
         5 003432   000015 036003                    ADLQ    13,DU
         5 003433   200033 756100                    STQ     @B+1,,AUTO
         5 003434   001530 701000 5                  TSX1    CHK_RETAIN
         5 003435   000000 011000                    NOP     0

     1234    10559    5                       DO CASE(I);

  10559  5 003436   000003 235000 1                  LDA     I
         5 003437   000004 115007                    CMPA    4,DL
         5 003440   003442 602005 5                  TNC     s:10559+4,AL
         5 003441   003460 710000 5                  TRA     s:10577
         5 003442   003460 710000 5                  TRA     s:10577
         5 003443   003460 710000 5                  TRA     s:10577
         5 003444   003460 710000 5                  TRA     s:10577
         5 003445   003446 710000 5                  TRA     s:10561

     1235    10560    5                       CASE(3);

     1236    10561    5                           IPT_FKY.V_ = VECTOR(IPT_FKY.V);

  10561  5 003446   000116 235000 6                  LDA     78
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:196  
         5 003447   002054 236000 1                  LDQ     FPT$
         5 003450   000012 036003                    ADLQ    10,DU
         5 003451   002054 470400 1                  LDP0    FPT$
         5 003452   000000 757100                    STAQ    0,,PR0

     1237    10562                                %CLIMB(FCN=FKY);

  10570  5 003453   002054 630400 1                  EPPR0   FPT$
         5 003454   000053 631400 6                  EPPR1   43
         5 003455   000000 701000 xent               TSX1    U$FKY
         5 003456   000000 011000                    NOP     0
         5 003457   004421 710000 5                  TRA     s:10985

     1238    10576    5                       CASE(ELSE);

     1239    10577    6                          IF RLCW_SAVE.N_SETS# + IPT_FKC.V.FLCW.N_FIELDS# ~= 0 THEN DO
             10577                                    ;

  10577  5 003460   002054 470400 1                  LDP0    FPT$
         5 003461   000014 236100                    LDQ     12,,PR0
         5 003462   000022 732000                    QRS     18
         5 003463   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 003464   002060 471400 1                  LDP1    RLCW$
         5 003465   100000 236100                    LDQ     0,,PR1
         5 003466   000377 376007                    ANQ     255,DL
         5 003467   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 003470   003511 600000 5                  TZE     s:10587

     1240    10578    6                               VBASE(IPT_FKC.V_) = ADDR(IPT_FKC.V);

  10578  5 003471   002054 236000 1                  LDQ     FPT$
         5 003472   000012 036003                    ADLQ    10,DU
         5 003473   000001 756100                    STQ     1,,PR0

     1241    10579    6                               VBOUND(IPT_FKC.V_) = SIZEC(IPT_FKC.V.RC) +

  10579  5 003474   000014 236100                    LDQ     12,,PR0
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:197  
         5 003475   000022 732000                    QRS     18
         5 003476   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 003477   100000 236100                    LDQ     0,,PR1
         5 003500   000377 376007                    ANQ     255,DL
         5 003501   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 003502   000002 736000                    QLS     2
         5 003503   000014 036007                    ADLQ    12,DL
         5 003504   000020 736000                    QLS     16
         5 003505   000000 676100                    ERQ     0,,PR0
         5 003506   000000 376000 6                  ANQ     0
         5 003507   000000 656100                    ERSQ    0,,PR0

     1242    10580    6                                  SIZEC(IPT_FKC.V.SC) +
     1243    10581    6                                  SIZEC(IPT_FKC.V.FLCW) +
     1244    10582    6                                  SIZEC(IPT_FKC.V.RLCW) +
     1245    10583    6                                  SIZEC(IPT_FKC.V.FL_RL_LIST) *
     1246    10584    6                                  (RLCW_SAVE.N_SETS# + IPT_FKC.V.FLCW.N_FIELDS# - 1);
     1247    10585    6                               END;

  10585  5 003510   003515 710000 5                  TRA     s:10597

     1248    10586    6                           ELSE DO;

     1249    10587    6                               IPT_FKC.V_ = VECTOR(IPT_FKC.V);

  10587  5 003511   000116 235000 6                  LDA     78
         5 003512   002054 236000 1                  LDQ     FPT$
         5 003513   000012 036003                    ADLQ    10,DU
         5 003514   000000 757100                    STAQ    0,,PR0

     1250    10588    6                               END;

     1251    10589                                %CLIMB(FCN=FKC);

  10597  5 003515   002054 630400 1                  EPPR0   FPT$
         5 003516   000053 631400 6                  EPPR1   43
         5 003517   000000 701000 xent               TSX1    U$FKC
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:198  
         5 003520   000000 011000                    NOP     0

     1252    10603    5                           END;

     1253    10604    4                       END;

  10604  5 003521   004421 710000 5                  TRA     s:10985

     1254    10605    3                   ELSE CALL ARG_ERROR(95);

  10605  5 003522   000124 236000 6                  LDQ     84
         5 003523   200037 756100                    STQ     @A+2,,AUTO
         5 003524   000715 701000 5                  TSX1    ARG_ERROR
         5 003525   000000 011000                    NOP     0
         5 003526   004421 710000 5                  TRA     s:10985

     1255    10606        /*    ERROR: ZII-95-1
     1256    10607              MESSAGE: Unknown type of FIND.
     1257    10608                       Required keyword DBKEY/WITHIN missing after
     1258    10609                       the 1st argument of a RECORD-NAME.  */
     1259    10610         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:199  
     1260    10611    3           CASE(%DBKEY);

     1261    10612
     1262    10613        /****************************************************************/
     1263    10614        /*                                                              */
     1264    10615        /*            TYPE OF FIND: DIRECT BY GIVING DBKEY              */
     1265    10616        /*                                                              */
     1266    10617        /*            CALL FIND(DBKEY,IDENTIFIER)                       */
     1267    10618        /*                                                              */
     1268    10619        /****************************************************************/
     1269    10620
     1270    10621    3               IPT_FDR.V.RC.RC_OFFSET#=NULL_OFFSET;

  10621  5 003527   002050 722000 1                  LXL2    NULL_OFFSET
         5 003530   002054 471400 1                  LDP1    FPT$
         5 003531   100014 742100                    STX2    12,,PR1

     1271    10622    3               IPT_FDR.DBK_=VECTOR(A2);

  10622  5 003532   777640 235007                    LDA     -96,DL
         5 003533   200004 236100                    LDQ     @A2,,AUTO
         5 003534   100012 757100                    STAQ    10,,PR1

     1272    10623    3               CALL FINDBKEY;

  10623  5 003535   002726 701000 5                  TSX1    FINDBKEY
         5 003536   000000 011000                    NOP     0
         5 003537   004421 710000 5                  TRA     s:10985

     1273    10624    3           CASE(%ANY,%DUPLICATE);

     1274    10625        /**************************************************************/
     1275    10626        /*                                                            */
     1276    10627        /*       TYPE OF FIND: WITH CALC KEY                          */
     1277    10628        /*                                                            */
     1278    10629        /*       CALL FIND(ANY/DUPANY,REC-NAME)                       */
     1279    10630        /*                                                            */
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:200  
     1280    10631        /**************************************************************/
     1281    10632
     1282    10633    3               IF ARG.TYPE(1)=%RECORD_NAME THEN

  10633  5 003540   000001 722100                    LXL2    1,,PR0
         5 003541   000041 102003                    CMPX2   33,DU
         5 003542   003641 601000 5                  TNZ     s:10697

     1283    10634    4               DO;

     1284    10635    4                   IF NO_ARGS>2 THEN CALL ARG_ERROR(100);

  10635  5 003543   000014 235000 1                  LDA     NO_ARGS
         5 003544   000002 115007                    CMPA    2,DL
         5 003545   003552 604400 5                  TMOZ    s:10640

  10635  5 003546   000126 236000 6                  LDQ     86
         5 003547   200037 756100                    STQ     @A+2,,AUTO
         5 003550   000715 701000 5                  TSX1    ARG_ERROR
         5 003551   000000 011000                    NOP     0

     1285    10636        /*    ERROR: ZII-100-1
     1286    10637              MESSAGE: Argument count error in FIND CALL.
     1287    10638                       The correct syntax is
     1288    10639                       CALL FIND(ANY/DUPLICATE,RECORD-NAME). */
     1289    10640    4                   IPT_FDC.V.RC.RC_OFFSET#=ARG.OFFSET(1);

  10640  5 003552   002055 470400 1                  LDP0    ARG$
         5 003553   000001 220100                    LDX0    1,,PR0
         5 003554   002054 471400 1                  LDP1    FPT$
         5 003555   100012 740100                    STX0    10,,PR1

     1290    10641    4                   CALL CHK_RETAIN(IPT_FDC.V.RLCW,0);

  10641  5 003556   000076 236000 6                  LDQ     62
         5 003557   200034 756100                    STQ     @RLCW+1,,AUTO
         5 003560   002054 236000 1                  LDQ     FPT$
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:201  
         5 003561   000013 036003                    ADLQ    11,DU
         5 003562   200033 756100                    STQ     @B+1,,AUTO
         5 003563   001530 701000 5                  TSX1    CHK_RETAIN
         5 003564   000000 011000                    NOP     0

     1291    10642    5                   IF A1(0)=SNA.ANY THEN DO;

  10642  5 003565   200003 470500                    LDP0    @A1,,AUTO
         5 003566   000100 100500                    MLR     fill='000'O
         5 003567   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         5 003570   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 003571   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 003572   000001 116000 0                  CMPQ    SNA+1
         5 003573   003627 601000 5                  TNZ     s:10669

     1292    10643    6                       IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;

  10643  5 003574   002060 471400 1                  LDP1    RLCW$
         5 003575   100000 236100                    LDQ     0,,PR1
         5 003576   000377 316007                    CANQ    255,DL
         5 003577   003615 600000 5                  TZE     s:10651

     1293    10644    6                           VBASE(IPT_FDC.V_) = ADDR(IPT_FDC.V);

  10644  5 003600   002054 236000 1                  LDQ     FPT$
         5 003601   000012 036003                    ADLQ    10,DU
         5 003602   002054 473400 1                  LDP3    FPT$
         5 003603   300001 756100                    STQ     1,,PR3

     1294    10645    6                           VBOUND(IPT_FDC.V_) = SIZEC(IPT_FDC.V.RC) +

  10645  5 003604   100000 236100                    LDQ     0,,PR1
         5 003605   000002 736000                    QLS     2
         5 003606   001774 376007                    ANQ     1020,DL
         5 003607   000010 036007                    ADLQ    8,DL
         5 003610   000020 736000                    QLS     16
         5 003611   300000 676100                    ERQ     0,,PR3
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:202  
         5 003612   000000 376000 6                  ANQ     0
         5 003613   300000 656100                    ERSQ    0,,PR3

     1295    10646    6                              SIZEC(IPT_FDC.V.RLCW) +
     1296    10647    6                              SIZEC(IPT_FDC.V.RETENTION_LIST) *
     1297    10648    6                              (RLCW_SAVE.N_SETS#);
     1298    10649    6                           END;

  10649  5 003614   003622 710000 5                  TRA     s:10661

     1299    10650    6                       ELSE DO;

     1300    10651    6                           IPT_FDC.V_ = VECTOR(IPT_FDC.V);

  10651  5 003615   000061 235000 6                  LDA     49
         5 003616   002054 236000 1                  LDQ     FPT$
         5 003617   000012 036003                    ADLQ    10,DU
         5 003620   002054 473400 1                  LDP3    FPT$
         5 003621   300000 757100                    STAQ    0,,PR3

     1301    10652    6                           END;

     1302    10653                            %CLIMB(FCN=FDC);

  10661  5 003622   002054 630400 1                  EPPR0   FPT$
         5 003623   000053 631400 6                  EPPR1   43
         5 003624   000000 701000 xent               TSX1    U$FDC
         5 003625   000000 011000                    NOP     0

     1303    10667    5                       END;

  10667  5 003626   004421 710000 5                  TRA     s:10985

     1304    10668    5                   ELSE DO;

     1305    10669    5                       IPT_FCD.V_ = VECTOR(IPT_FCD.V);

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:203  
  10669  5 003627   000061 235000 6                  LDA     49
         5 003630   002054 236000 1                  LDQ     FPT$
         5 003631   000012 036003                    ADLQ    10,DU
         5 003632   002054 471400 1                  LDP1    FPT$
         5 003633   100000 757100                    STAQ    0,,PR1

     1306    10670                            %CLIMB(FCN=FCD);

  10678  5 003634   002054 630400 1                  EPPR0   FPT$
         5 003635   000053 631400 6                  EPPR1   43
         5 003636   000000 701000 xent               TSX1    U$FCD
         5 003637   000000 011000                    NOP     0

     1307    10684    5                       END;

     1308    10685    4                   END;

  10685  5 003640   004421 710000 5                  TRA     s:10985

     1309    10686    3               ELSE
     1310    10687    4               DO;

     1311    10688         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:204  
     1312    10689        /*************************************************************/
     1313    10690        /*                                                           */
     1314    10691        /*       TYPE OF FIND: DUPLICATE RECORD WITHIN A SET         */
     1315    10692        /*                                                           */
     1316    10693        /*       CALL FIND(DUPSET,SET-NAME,IDENT-2,[IDENT-3],...])   */
     1317    10694        /*                                                           */
     1318    10695        /*************************************************************/
     1319    10696
     1320    10697    4                   IF ARG.TYPE(1)~=%SET_NAME OR NO_ARGS<3 THEN CALL ARG_ERROR(105);

  10697  5 003641   000040 102003                    CMPX2   32,DU
         5 003642   003646 601000 5                  TNZ     s:10697+5
         5 003643   000014 235000 1                  LDA     NO_ARGS
         5 003644   000003 115007                    CMPA    3,DL
         5 003645   003652 605000 5                  TPL     s:10702

  10697  5 003646   000130 236000 6                  LDQ     88
         5 003647   200037 756100                    STQ     @A+2,,AUTO
         5 003650   000715 701000 5                  TSX1    ARG_ERROR
         5 003651   000000 011000                    NOP     0

     1321    10698        /*    ERROR: ZII-105-1
     1322    10699              MESSAGE: Argument count error, or the 2nd argument in
     1323    10700                     CALL FIND(DUPLICATE,SET-NAME,FIELD-NAME1,....)
     1324    10701                     is not a SET-NAME.  */
     1325    10702    4                   IPT_FDP.V.SC.SC_OFFSET#=ARG.OFFSET(1);

  10702  5 003652   002055 470400 1                  LDP0    ARG$
         5 003653   000001 220100                    LDX0    1,,PR0
         5 003654   002054 471400 1                  LDP1    FPT$
         5 003655   100012 740100                    STX0    10,,PR1

     1326    10703    4                   IPT_FDP.V.FLCW.N_FIELDS#=NO_ARGS-2;

  10703  5 003656   000014 721000 1                  LXL1    NO_ARGS
         5 003657   777776 622011                    EAX2    -2,X1
         5 003660   100013 742100                    STX2    11,,PR1
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:205  

     1327    10704    5                   DO I=0 TO NO_ARGS-3;

  10704  5 003661   000003 450000 1                  STZ     I
         5 003662   003702 710000 5                  TRA     s:10711+1

     1328    10705    5                       IF ARG.TYPE(I+2)~=%FIELD_NAME THEN CALL ARG_ERROR(110);

  10705  5 003663   002055 470400 1                  LDP0    ARG$
         5 003664   000003 720000 1                  LXL0    I
         5 003665   000002 721110                    LXL1    2,X0,PR0
         5 003666   000042 101003                    CMPX1   34,DU
         5 003667   003674 600000 5                  TZE     s:10710

  10705  5 003670   000132 236000 6                  LDQ     90
         5 003671   200037 756100                    STQ     @A+2,,AUTO
         5 003672   000715 701000 5                  TSX1    ARG_ERROR
         5 003673   000000 011000                    NOP     0

     1329    10706        /*    ERROR: ZII-110-1
     1330    10707           MESSAGE: The variable length list in FIND CALL does not contain all FIELD-NAMES.
     1331    10708                       The correct syntax is
     1332    10709                       CALL FIND(DUPSET,SET-NAME,FIELD-NAME1,....)  */
     1333    10710    5                       IPT_FDP.V.FL_RL_LIST.RVA_OFFSET#(I)=ARG.OFFSET(I+2);

  10710  5 003674   002055 470400 1                  LDP0    ARG$
         5 003675   000003 720000 1                  LXL0    I
         5 003676   000002 221110                    LDX1    2,X0,PR0
         5 003677   002054 471400 1                  LDP1    FPT$
         5 003700   100015 741110                    STX1    13,X0,PR1

     1334    10711    5                       END;

  10711  5 003701   000003 054000 1                  AOS     I
         5 003702   000014 236000 1                  LDQ     NO_ARGS
         5 003703   000003 136007                    SBLQ    3,DL
         5 003704   000003 116000 1                  CMPQ    I
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:206  
         5 003705   003663 605000 5                  TPL     s:10705

     1335    10712    4                   CALL CHK_RETAIN(IPT_FDP.V.RLCW,IPT_FDP.V.FLCW.N_FIELDS#);

  10712  5 003706   002054 236000 1                  LDQ     FPT$
         5 003707   000013 036003                    ADLQ    11,DU
         5 003710   200034 756100                    STQ     @RLCW+1,,AUTO
         5 003711   002054 236000 1                  LDQ     FPT$
         5 003712   000014 036003                    ADLQ    12,DU
         5 003713   200033 756100                    STQ     @B+1,,AUTO
         5 003714   001530 701000 5                  TSX1    CHK_RETAIN
         5 003715   000000 011000                    NOP     0

     1336    10713    5                   IF RLCW_SAVE.N_SETS# + IPT_FDP.V.FLCW.N_FIELDS# ~= 0 THEN DO;

  10713  5 003716   002054 470400 1                  LDP0    FPT$
         5 003717   000013 236100                    LDQ     11,,PR0
         5 003720   000022 732000                    QRS     18
         5 003721   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 003722   002060 471400 1                  LDP1    RLCW$
         5 003723   100000 236100                    LDQ     0,,PR1
         5 003724   000377 376007                    ANQ     255,DL
         5 003725   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 003726   003747 600000 5                  TZE     s:10722

     1337    10714    5                       VBASE(IPT_FDP.V_) = ADDR(IPT_FDP.V);

  10714  5 003727   002054 236000 1                  LDQ     FPT$
         5 003730   000012 036003                    ADLQ    10,DU
         5 003731   000001 756100                    STQ     1,,PR0

     1338    10715    5                       VBOUND(IPT_FDP.V_) = SIZEC(IPT_FDP.V.SC) +

  10715  5 003732   000013 236100                    LDQ     11,,PR0
         5 003733   000022 732000                    QRS     18
         5 003734   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 003735   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:207  
         5 003736   000377 376007                    ANQ     255,DL
         5 003737   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 003740   000002 736000                    QLS     2
         5 003741   000010 036007                    ADLQ    8,DL
         5 003742   000020 736000                    QLS     16
         5 003743   000000 676100                    ERQ     0,,PR0
         5 003744   000000 376000 6                  ANQ     0
         5 003745   000000 656100                    ERSQ    0,,PR0

     1339    10716    5                          SIZEC(IPT_FDP.V.FLCW) +
     1340    10717    5                          SIZEC(IPT_FDP.V.RLCW) +
     1341    10718    5                          SIZEC(IPT_FDP.V.FL_RL_LIST) *
     1342    10719    5                          (RLCW_SAVE.N_SETS# + IPT_FDP.V.FLCW.N_FIELDS# - 1);
     1343    10720    5                       END;

  10720  5 003746   003753 710000 5                  TRA     s:10732

     1344    10721    5                   ELSE DO;

     1345    10722    5                       IPT_FDP.V_ = VECTOR(IPT_FDP.V);

  10722  5 003747   000061 235000 6                  LDA     49
         5 003750   002054 236000 1                  LDQ     FPT$
         5 003751   000012 036003                    ADLQ    10,DU
         5 003752   000000 757100                    STAQ    0,,PR0

     1346    10723    5                       END;

     1347    10724                        %CLIMB(FCN=FDP);

  10732  5 003753   002054 630400 1                  EPPR0   FPT$
         5 003754   000053 631400 6                  EPPR1   43
         5 003755   000000 701000 xent               TSX1    U$FDP
         5 003756   000000 011000                    NOP     0

     1348    10738    4                   END;

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:208  
  10738  5 003757   004421 710000 5                  TRA     s:10985

     1349    10739         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:209  
     1350    10740    3           CASE(%NEXT,%PRIOR,%CURRENT);

     1351    10741    3               IF NO_ARGS=2 AND ARG.TYPE(1)=%RECORD_NAME AND A1(0)=SNA.CURRENT THEN

  10741  5 003760   000014 235000 1                  LDA     NO_ARGS
         5 003761   000002 115007                    CMPA    2,DL
         5 003762   004042 601000 5                  TNZ     s:10790
         5 003763   000001 722100                    LXL2    1,,PR0
         5 003764   000041 102003                    CMPX2   33,DU
         5 003765   004042 601000 5                  TNZ     s:10790
         5 003766   200003 471500                    LDP1    @A1,,AUTO
         5 003767   000100 100500                    MLR     fill='000'O
         5 003770   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         5 003771   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 003772   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 003773   000003 116000 0                  CMPQ    SNA+3
         5 003774   004042 601000 5                  TNZ     s:10790

     1352    10742
     1353    10743        /******************************************************************/
     1354    10744        /*                                                                */
     1355    10745        /*       TYPE OF FIND: CURRENT OF RECORD                          */
     1356    10746        /*                                                                */
     1357    10747        /*       CALL FIND(CURRENT,REC-NAME)                              */
     1358    10748        /*                                                                */
     1359    10749        /******************************************************************/
     1360    10750    4               DO;

     1361    10751    4                   IPT_FCT.V.RC.RC_OFFSET#=ARG.OFFSET(1);

  10751  5 003775   000001 221100                    LDX1    1,,PR0
         5 003776   002054 473400 1                  LDP3    FPT$
         5 003777   300012 741100                    STX1    10,,PR3

     1362    10752    4                   CALL CHK_RETAIN(IPT_FCT.V.RLCW,0);

  10752  5 004000   000076 236000 6                  LDQ     62
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:210  
         5 004001   200034 756100                    STQ     @RLCW+1,,AUTO
         5 004002   002054 236000 1                  LDQ     FPT$
         5 004003   000013 036003                    ADLQ    11,DU
         5 004004   200033 756100                    STQ     @B+1,,AUTO
         5 004005   001530 701000 5                  TSX1    CHK_RETAIN
         5 004006   000000 011000                    NOP     0

     1363    10753    5                   IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;

  10753  5 004007   002060 470400 1                  LDP0    RLCW$
         5 004010   000000 236100                    LDQ     0,,PR0
         5 004011   000377 316007                    CANQ    255,DL
         5 004012   004030 600000 5                  TZE     s:10761

     1364    10754    5                       VBASE(IPT_FCT.V_) = ADDR(IPT_FCT.V);

  10754  5 004013   002054 236000 1                  LDQ     FPT$
         5 004014   000012 036003                    ADLQ    10,DU
         5 004015   002054 471400 1                  LDP1    FPT$
         5 004016   100001 756100                    STQ     1,,PR1

     1365    10755    5                       VBOUND(IPT_FCT.V_) = SIZEC(IPT_FCT.V.RC) +

  10755  5 004017   000000 236100                    LDQ     0,,PR0
         5 004020   000002 736000                    QLS     2
         5 004021   001774 376007                    ANQ     1020,DL
         5 004022   000010 036007                    ADLQ    8,DL
         5 004023   000020 736000                    QLS     16
         5 004024   100000 676100                    ERQ     0,,PR1
         5 004025   000000 376000 6                  ANQ     0
         5 004026   100000 656100                    ERSQ    0,,PR1

     1366    10756    5                          SIZEC(IPT_FCT.V.RLCW) +
     1367    10757    5                          SIZEC(IPT_FCT.V.RETENTION_LIST) *
     1368    10758    5                          (RLCW_SAVE.N_SETS#);
     1369    10759    5                       END;

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:211  
  10759  5 004027   004035 710000 5                  TRA     s:10771

     1370    10760    5                   ELSE DO;

     1371    10761    5                       IPT_FCT.V_ = VECTOR(IPT_FCT.V);

  10761  5 004030   000061 235000 6                  LDA     49
         5 004031   002054 236000 1                  LDQ     FPT$
         5 004032   000012 036003                    ADLQ    10,DU
         5 004033   002054 471400 1                  LDP1    FPT$
         5 004034   100000 757100                    STAQ    0,,PR1

     1372    10762    5                       END;

     1373    10763                        %CLIMB(FCN=FCT);

  10771  5 004035   002054 630400 1                  EPPR0   FPT$
         5 004036   000053 631400 6                  EPPR1   43
         5 004037   000000 701000 xent               TSX1    U$FCT
         5 004040   000000 011000                    NOP     0

     1374    10777    4                   END;

  10777  5 004041   004421 710000 5                  TRA     s:10985

     1375    10778    3               ELSE
     1376    10779         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:212  
     1377    10780        /****************************************************************/
     1378    10781        /*                                                              */
     1379    10782        /*       TYPE OF FIND: RELATIVE TO A SET OR A AREA              */
     1380    10783        /*                                                              */
     1381    10784        /*                 PRIOR                                        */
     1382    10785        /*       CALL FIND(CURRENT,[REC-NAME],SET-NAME)                 */
     1383    10786        /*                 NEXT               AREA-NAME                 */
     1384    10787        /*                                                              */
     1385    10788        /****************************************************************/
     1386    10789    4               DO;

     1387    10790    4                   IF ARG.TYPE(0)=SNA.PRIOR THEN

  10790  5 004042   000000 236100                    LDQ     0,,PR0
         5 004043   777777 376007                    ANQ     -1,DL
         5 004044   000017 116000 0                  CMPQ    SNA+15
         5 004045   004052 601000 5                  TNZ     s:10793

     1388    10791    4                       IPT_FRS.V.FCW.RECORD_LOCATION#=0;

  10791  5 004046   000000 221003                    LDX1    0,DU
         5 004047   002054 471400 1                  LDP1    FPT$
         5 004050   100012 741100                    STX1    10,,PR1
         5 004051   004063 710000 5                  TRA     s:10797

     1389    10792    4                   ELSE
     1390    10793    4                       IF ARG.TYPE(0)=SNA.CURRENT THEN

  10793  5 004052   000003 116000 0                  CMPQ    SNA+3
         5 004053   004060 601000 5                  TNZ     s:10796

     1391    10794    4                           IPT_FRS.V.FCW.RECORD_LOCATION#=1;

  10794  5 004054   000001 221003                    LDX1    1,DU
         5 004055   002054 471400 1                  LDP1    FPT$
         5 004056   100012 741100                    STX1    10,,PR1
         5 004057   004063 710000 5                  TRA     s:10797
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:213  

     1392    10795    4                       ELSE
     1393    10796    4                           IPT_FRS.V.FCW.RECORD_LOCATION#=2;

  10796  5 004060   000002 221003                    LDX1    2,DU
         5 004061   002054 471400 1                  LDP1    FPT$
         5 004062   100012 741100                    STX1    10,,PR1

     1394    10797    5                   DO CASE(NO_ARGS);

  10797  5 004063   000004 115007                    CMPA    4,DL
         5 004064   004066 602005 5                  TNC     s:10797+3,AL
         5 004065   004115 710000 5                  TRA     s:10811
         5 004066   004115 710000 5                  TRA     s:10811
         5 004067   004115 710000 5                  TRA     s:10811
         5 004070   004110 710000 5                  TRA     s:10808
         5 004071   004072 710000 5                  TRA     s:10800

     1395    10798
     1396    10799    5                   CASE(3);

     1397    10800    5                       IF ARG.TYPE(1)~=%RECORD_NAME THEN CALL ARG_ERROR(115);

  10800  5 004072   000001 722100                    LXL2    1,,PR0
         5 004073   000041 102003                    CMPX2   33,DU
         5 004074   004101 600000 5                  TZE     s:10805

  10800  5 004075   000134 236000 6                  LDQ     92
         5 004076   200037 756100                    STQ     @A+2,,AUTO
         5 004077   000715 701000 5                  TSX1    ARG_ERROR
         5 004100   000000 011000                    NOP     0

     1398    10801        /*    ERROR: ZII-115-1
     1399    10802              MESSAGE: Argument count error, or 2nd argument in
     1400    10803                       CALL FIND(PRIOR/CURRENT/NEXT,RECORD-NAME,SET-NAME/AREA-NAME)
     1401    10804                       is not a RECORD-NAME.  */
     1402    10805    5                       IPT_FRS.V.RC.RC_OFFSET#=ARG.OFFSET(1);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:214  

  10805  5 004101   002055 470400 1                  LDP0    ARG$
         5 004102   000001 220100                    LDX0    1,,PR0
         5 004103   002054 471400 1                  LDP1    FPT$
         5 004104   100013 740100                    STX0    11,,PR1

     1403    10806    5                       IPT_FRS.V.SC.SC_OFFSET#=ARG.OFFSET(2);

  10806  5 004105   000002 221100                    LDX1    2,,PR0
         5 004106   100014 741100                    STX1    12,,PR1
         5 004107   004121 710000 5                  TRA     s:10813

     1404    10807    5                   CASE(2);

     1405    10808    5                       IPT_FRS.V.RC.RC_OFFSET#=NULL_OFFSET;

  10808  5 004110   002050 722000 1                  LXL2    NULL_OFFSET
         5 004111   100013 742100                    STX2    11,,PR1

     1406    10809    5                       IPT_FRS.V.SC.SC_OFFSET#=ARG.OFFSET(1);

  10809  5 004112   000001 223100                    LDX3    1,,PR0
         5 004113   100014 743100                    STX3    12,,PR1
         5 004114   004121 710000 5                  TRA     s:10813

     1407    10810    5                   CASE(ELSE);

     1408    10811    5                       CALL ARG_ERROR(115);

  10811  5 004115   000134 236000 6                  LDQ     92
         5 004116   200037 756100                    STQ     @A+2,,AUTO
         5 004117   000715 701000 5                  TSX1    ARG_ERROR
         5 004120   000000 011000                    NOP     0

     1409    10812    5                       END;

     1410    10813    4                   CALL CHK_RETAIN(IPT_FRS.V.RLCW,0);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:215  

  10813  5 004121   000076 236000 6                  LDQ     62
         5 004122   200034 756100                    STQ     @RLCW+1,,AUTO
         5 004123   002054 236000 1                  LDQ     FPT$
         5 004124   000015 036003                    ADLQ    13,DU
         5 004125   200033 756100                    STQ     @B+1,,AUTO
         5 004126   001530 701000 5                  TSX1    CHK_RETAIN
         5 004127   000000 011000                    NOP     0

     1411    10814    5                   DO CASE(ARG.TYPE(NO_ARGS-1)-%AREA_NAME);

  10814  5 004130   002055 470400 1                  LDP0    ARG$
         5 004131   000014 720000 1                  LXL0    NO_ARGS
         5 004132   077777 236110                    LDQ     -1,X0,PR0
         5 004133   777777 376007                    ANQ     -1,DL
         5 004134   000037 136007                    SBLQ    31,DL
         5 004135   000002 116007                    CMPQ    2,DL
         5 004136   004140 602006 5                  TNC     s:10814+8,QL
         5 004137   004176 710000 5                  TRA     s:10855
         5 004140   004142 710000 5                  TRA     s:10817
         5 004141   004154 710000 5                  TRA     s:10833

     1412    10815
     1413    10816    5                   CASE(%AREA_NAME_NET);

     1414    10817    5                       IPT_FRA.V_ = VECTOR(IPT_FRA.V);

  10817  5 004142   000116 235000 6                  LDA     78
         5 004143   002054 236000 1                  LDQ     FPT$
         5 004144   000012 036003                    ADLQ    10,DU
         5 004145   002054 471400 1                  LDP1    FPT$
         5 004146   100000 757100                    STAQ    0,,PR1

     1415    10818                            %CLIMB(FCN=FRA);

  10826  5 004147   002054 630400 1                  EPPR0   FPT$
         5 004150   000053 631400 6                  EPPR1   43
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:216  
         5 004151   000000 701000 xent               TSX1    U$FRA
         5 004152   000000 011000                    NOP     0
         5 004153   004421 710000 5                  TRA     s:10985

     1416    10832    5                   CASE(%SET_NAME_NET);

     1417    10833    5                       VBASE(IPT_FRS.V_) = ADDR(IPT_FRS.V);

  10833  5 004154   002054 236000 1                  LDQ     FPT$
         5 004155   000012 036003                    ADLQ    10,DU
         5 004156   002054 471400 1                  LDP1    FPT$
         5 004157   100001 756100                    STQ     1,,PR1

     1418    10834    5                       VBOUND(IPT_FRS.V_) = SIZEC(IPT_FRS.V.FCW) +

  10834  5 004160   002060 473400 1                  LDP3    RLCW$
         5 004161   300000 236100                    LDQ     0,,PR3
         5 004162   000002 736000                    QLS     2
         5 004163   001774 376007                    ANQ     1020,DL
         5 004164   000020 036007                    ADLQ    16,DL
         5 004165   000020 736000                    QLS     16
         5 004166   100000 676100                    ERQ     0,,PR1
         5 004167   000000 376000 6                  ANQ     0
         5 004170   100000 656100                    ERSQ    0,,PR1

     1419    10835    5                          SIZEC(IPT_FRS.V.RC) +
     1420    10836    5                          SIZEC(IPT_FRS.V.SC) +
     1421    10837    5                          SIZEC(IPT_FRS.V.RLCW) +
     1422    10838    5                          SIZEC(IPT_FRS.V.RETENTION_LIST) *
     1423    10839    5                          (RLCW_SAVE.N_SETS#);
     1424    10840                            %CLIMB(FCN=FRS);

  10848  5 004171   002054 630400 1                  EPPR0   FPT$
         5 004172   000053 631400 6                  EPPR1   43
         5 004173   000000 701000 xent               TSX1    U$FRS
         5 004174   000000 011000                    NOP     0
         5 004175   004421 710000 5                  TRA     s:10985
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:217  

     1425    10854    5                   CASE(ELSE);

     1426    10855    5                       CALL ARG_ERROR(120);

  10855  5 004176   000136 236000 6                  LDQ     94
         5 004177   200037 756100                    STQ     @A+2,,AUTO
         5 004200   000715 701000 5                  TSX1    ARG_ERROR
         5 004201   000000 011000                    NOP     0

     1427    10856        /*    ERROR: ZII-120-1
     1428    10857              MESSAGE: The last argument in
     1429    10858                       CALL FIND(NEXT/PRIOR/CURRENT,[REC-NAME],SET-NAME/AREA-NAME)
     1430    10859                       is neither a SET-NAME nor an AREA-NAME.  */
     1431    10860    5                       END;

     1432    10861    4                   END;

  10861  5 004202   004421 710000 5                  TRA     s:10985

     1433    10862         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:218  
     1434    10863    3           CASE(%OWNER);

     1435    10864
     1436    10865        /***************************************************************/
     1437    10866        /*                                                             */
     1438    10867        /*       TYPE OF FIND: OWNER OF A SET                          */
     1439    10868        /*                                                             */
     1440    10869        /*       CALL FIND(OWNER,SET-NAME)                             */
     1441    10870        /*                                                             */
     1442    10871        /***************************************************************/
     1443    10872
     1444    10873    3               IF ARG.TYPE(1)~=%SET_NAME OR NO_ARGS>2 THEN CALL ARG_ERROR(125);

  10873  5 004203   000001 722100                    LXL2    1,,PR0
         5 004204   000040 102003                    CMPX2   32,DU
         5 004205   004211 601000 5                  TNZ     s:10873+6
         5 004206   000014 235000 1                  LDA     NO_ARGS
         5 004207   000002 115007                    CMPA    2,DL
         5 004210   004215 604400 5                  TMOZ    s:10877

  10873  5 004211   000140 236000 6                  LDQ     96
         5 004212   200037 756100                    STQ     @A+2,,AUTO
         5 004213   000715 701000 5                  TSX1    ARG_ERROR
         5 004214   000000 011000                    NOP     0

     1445    10874        /*    ERROR: ZII-125-1
     1446    10875              MESSAGE: Argument count error, or the 2nd argument in
     1447    10876                       CALL FIND(OWNER,SET-NAME) is not a SET-NAME. */
     1448    10877    3               IPT_FOR.V.SC.SC_OFFSET#=ARG.OFFSET(1);

  10877  5 004215   002055 470400 1                  LDP0    ARG$
         5 004216   000001 220100                    LDX0    1,,PR0
         5 004217   002054 471400 1                  LDP1    FPT$
         5 004220   100012 740100                    STX0    10,,PR1

     1449    10878    3               CALL CHK_RETAIN(IPT_FOR.V.RLCW,0);

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:219  
  10878  5 004221   000076 236000 6                  LDQ     62
         5 004222   200034 756100                    STQ     @RLCW+1,,AUTO
         5 004223   002054 236000 1                  LDQ     FPT$
         5 004224   000013 036003                    ADLQ    11,DU
         5 004225   200033 756100                    STQ     @B+1,,AUTO
         5 004226   001530 701000 5                  TSX1    CHK_RETAIN
         5 004227   000000 011000                    NOP     0

     1450    10879    4               IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;

  10879  5 004230   002060 470400 1                  LDP0    RLCW$
         5 004231   000000 236100                    LDQ     0,,PR0
         5 004232   000377 316007                    CANQ    255,DL
         5 004233   004251 600000 5                  TZE     s:10887

     1451    10880    4                   VBASE(IPT_FOR.V_) = ADDR(IPT_FOR.V);

  10880  5 004234   002054 236000 1                  LDQ     FPT$
         5 004235   000012 036003                    ADLQ    10,DU
         5 004236   002054 471400 1                  LDP1    FPT$
         5 004237   100001 756100                    STQ     1,,PR1

     1452    10881    4                   VBOUND(IPT_FOR.V_) = SIZEC(IPT_FOR.V.SC) +

  10881  5 004240   000000 236100                    LDQ     0,,PR0
         5 004241   000002 736000                    QLS     2
         5 004242   001774 376007                    ANQ     1020,DL
         5 004243   000010 036007                    ADLQ    8,DL
         5 004244   000020 736000                    QLS     16
         5 004245   100000 676100                    ERQ     0,,PR1
         5 004246   000000 376000 6                  ANQ     0
         5 004247   100000 656100                    ERSQ    0,,PR1

     1453    10882    4                      SIZEC(IPT_FOR.V.RLCW) +
     1454    10883    4                      SIZEC(IPT_FOR.V.RETENTION_LIST) *
     1455    10884    4                      (RLCW_SAVE.N_SETS#);
     1456    10885    4                   END;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:220  

  10885  5 004250   004256 710000 5                  TRA     s:10897

     1457    10886    4               ELSE DO;

     1458    10887    4                   IPT_FOR.V_ = VECTOR(IPT_FOR.V);

  10887  5 004251   000061 235000 6                  LDA     49
         5 004252   002054 236000 1                  LDQ     FPT$
         5 004253   000012 036003                    ADLQ    10,DU
         5 004254   002054 471400 1                  LDP1    FPT$
         5 004255   100000 757100                    STAQ    0,,PR1

     1459    10888    4                   END;

     1460    10889                    %CLIMB(FCN=FOR);

  10897  5 004256   002054 630400 1                  EPPR0   FPT$
         5 004257   000053 631400 6                  EPPR1   43
         5 004260   000000 701000 xent               TSX1    U$FOR
         5 004261   000000 011000                    NOP     0
         5 004262   004421 710000 5                  TRA     s:10985

     1461    10903    3           CASE(ELSE);

     1462    10904         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:221  
     1463    10905        /**************************************************************/
     1464    10906        /*                                                            */
     1465    10907        /*       TYPE OF FIND: I-TH NUMBER WITHIN A SET OR A AREA     */
     1466    10908        /*                                                            */
     1467    10909        /*       CALL FIND(FIRST,[REC-NAME],SET-NAME )                */
     1468    10910        /*                 LAST             AREA-NAME                 */
     1469    10911        /*                 INTEGER                                    */
     1470    10912        /*                 IDENTIFIER                                 */
     1471    10913        /*                                                            */
     1472    10914        /**************************************************************/
     1473    10915
     1474    10916    3               IPT_FAA.V.AC.AC_OFFSET#=ARG.OFFSET(NO_ARGS-1);

  10916  5 004263   077777 222110                    LDX2    -1,X0,PR0
         5 004264   002054 471400 1                  LDP1    FPT$
         5 004265   100014 742100                    STX2    12,,PR1

     1475    10917    3               IF ARG.TYPE(0)=%LAST THEN

  10917  5 004266   000000 721100                    LXL1    0,,PR0
         5 004267   000015 101003                    CMPX1   13,DU
         5 004270   004274 601000 5                  TNZ     s:10921

     1476    10918
     1477    10919    3                   IPT_FAS.V.RECORD_NUMBER#=-1;

  10919  5 004271   000001 335007                    LCA     1,DL
         5 004272   100012 755100                    STA     10,,PR1
         5 004273   004305 710000 5                  TRA     s:10925

     1478    10920    3               ELSE
     1479    10921    3                   IF ARG.TYPE(0)=%FIRST THEN

  10921  5 004274   000012 101003                    CMPX1   10,DU
         5 004275   004301 601000 5                  TNZ     s:10924

     1480    10922    3                       IPT_FAS.V.RECORD_NUMBER#=1;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:222  

  10922  5 004276   000001 235007                    LDA     1,DL
         5 004277   100012 755100                    STA     10,,PR1
         5 004300   004305 710000 5                  TRA     s:10925

     1481    10923    3                   ELSE
     1482    10924    3                       IPT_FAS.V.RECORD_NUMBER#=A1(0);

  10924  5 004301   200003 473500                    LDP3    @A1,,AUTO
         5 004302   000100 100500                    MLR     fill='000'O
         5 004303   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4
         5 004304   100012 000004                    ADSC9   10,,PR1                  cn=0,n=4

     1483    10925    3               IF NO_ARGS>2 AND ARG.TYPE(1)=%RECORD_NAME THEN

  10925  5 004305   000014 235000 1                  LDA     NO_ARGS
         5 004306   000002 115007                    CMPA    2,DL
         5 004307   004316 604400 5                  TMOZ    s:10928
         5 004310   000001 721100                    LXL1    1,,PR0
         5 004311   000041 101003                    CMPX1   33,DU
         5 004312   004316 601000 5                  TNZ     s:10928

     1484    10926    3                   IPT_FAS.V.RC.RC_OFFSET#=ARG.OFFSET(1);

  10926  5 004313   000001 223100                    LDX3    1,,PR0
         5 004314   100013 743100                    STX3    11,,PR1
         5 004315   004320 710000 5                  TRA     s:10929

     1485    10927    3               ELSE
     1486    10928    3                   IPT_FAS.V.RC.RC_OFFSET#=NULL_OFFSET;

  10928  5 004316   002050 721000 1                  LXL1    NULL_OFFSET
         5 004317   100013 741100                    STX1    11,,PR1

     1487    10929    3               CALL CHK_RETAIN(IPT_FAS.V.RLCW,0);

  10929  5 004320   000076 236000 6                  LDQ     62
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:223  
         5 004321   200034 756100                    STQ     @RLCW+1,,AUTO
         5 004322   002054 236000 1                  LDQ     FPT$
         5 004323   000015 036003                    ADLQ    13,DU
         5 004324   200033 756100                    STQ     @B+1,,AUTO
         5 004325   001530 701000 5                  TSX1    CHK_RETAIN
         5 004326   000000 011000                    NOP     0

     1488    10930    3               IF NO_ARGS>3 THEN CALL ARG_ERROR(130);

  10930  5 004327   000014 235000 1                  LDA     NO_ARGS
         5 004330   000003 115007                    CMPA    3,DL
         5 004331   004336 604400 5                  TMOZ    s:10931

  10930  5 004332   000142 236000 6                  LDQ     98
         5 004333   200037 756100                    STQ     @A+2,,AUTO
         5 004334   000715 701000 5                  TSX1    ARG_ERROR
         5 004335   000000 011000                    NOP     0

     1489    10931    4               DO CASE(ARG.TYPE(NO_ARGS-1)-%AREA_NAME);

  10931  5 004336   002055 470400 1                  LDP0    ARG$
         5 004337   000014 720000 1                  LXL0    NO_ARGS
         5 004340   077777 236110                    LDQ     -1,X0,PR0
         5 004341   777777 376007                    ANQ     -1,DL
         5 004342   000037 136007                    SBLQ    31,DL
         5 004343   000002 116007                    CMPQ    2,DL
         5 004344   004346 602006 5                  TNC     s:10931+8,QL
         5 004345   004415 710000 5                  TRA     s:10977
         5 004346   004350 710000 5                  TRA     s:10934
         5 004347   004403 710000 5                  TRA     s:10961

     1490    10932
     1491    10933    4               CASE(%AREA_NAME_NET);

     1492    10934    5                   IF RLCW_SAVE.N_SETS# ~= 0 THEN DO;

  10934  5 004350   002060 471400 1                  LDP1    RLCW$
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:224  
         5 004351   100000 236100                    LDQ     0,,PR1
         5 004352   000377 316007                    CANQ    255,DL
         5 004353   004371 600000 5                  TZE     s:10944

     1493    10935    5                       VBASE(IPT_FAA.V_) = ADDR(IPT_FAA.V);

  10935  5 004354   002054 236000 1                  LDQ     FPT$
         5 004355   000012 036003                    ADLQ    10,DU
         5 004356   002054 473400 1                  LDP3    FPT$
         5 004357   300001 756100                    STQ     1,,PR3

     1494    10936    5                       VBOUND(IPT_FAA.V_) = SIZEC(IPT_FAA.V.RECORD_NUMBER#) +

  10936  5 004360   100000 236100                    LDQ     0,,PR1
         5 004361   000002 736000                    QLS     2
         5 004362   001774 376007                    ANQ     1020,DL
         5 004363   000020 036007                    ADLQ    16,DL
         5 004364   000020 736000                    QLS     16
         5 004365   300000 676100                    ERQ     0,,PR3
         5 004366   000000 376000 6                  ANQ     0
         5 004367   300000 656100                    ERSQ    0,,PR3

     1495    10937    5                          SIZEC(IPT_FAA.V.RC) +
     1496    10938    5                          SIZEC(IPT_FAA.V.AC) +
     1497    10939    5                          SIZEC(IPT_FAA.V.RLCW) +
     1498    10940    5                          SIZEC(IPT_FAA.V.RETENTION_LIST) *
     1499    10941    5                          (RLCW_SAVE.N_SETS#);
     1500    10942    5                       END;

  10942  5 004370   004376 710000 5                  TRA     s:10954

     1501    10943    5                   ELSE DO;

     1502    10944    5                       IPT_FAA.V_ = VECTOR(IPT_FAA.V);

  10944  5 004371   000116 235000 6                  LDA     78
         5 004372   002054 236000 1                  LDQ     FPT$
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:225  
         5 004373   000012 036003                    ADLQ    10,DU
         5 004374   002054 473400 1                  LDP3    FPT$
         5 004375   300000 757100                    STAQ    0,,PR3

     1503    10945    5                       END;

     1504    10946                        %CLIMB(FCN=FAA);

  10954  5 004376   002054 630400 1                  EPPR0   FPT$
         5 004377   000053 631400 6                  EPPR1   43
         5 004400   000000 701000 xent               TSX1    U$FAA
         5 004401   000000 011000                    NOP     0
         5 004402   004421 710000 5                  TRA     s:10985

     1505    10960    4               CASE(%SET_NAME_NET);

     1506    10961    4                   IPT_FAS.V_ = VECTOR(IPT_FAS.V);

  10961  5 004403   000116 235000 6                  LDA     78
         5 004404   002054 236000 1                  LDQ     FPT$
         5 004405   000012 036003                    ADLQ    10,DU
         5 004406   002054 471400 1                  LDP1    FPT$
         5 004407   100000 757100                    STAQ    0,,PR1

     1507    10962                        %CLIMB(FCN=FAS);

  10970  5 004410   002054 630400 1                  EPPR0   FPT$
         5 004411   000053 631400 6                  EPPR1   43
         5 004412   000000 701000 xent               TSX1    U$FAS
         5 004413   000000 011000                    NOP     0
         5 004414   004421 710000 5                  TRA     s:10985

     1508    10976    4               CASE(ELSE);

     1509    10977    4                   CALL ARG_ERROR(130);

  10977  5 004415   000142 236000 6                  LDQ     98
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:226  
         5 004416   200037 756100                    STQ     @A+2,,AUTO
         5 004417   000715 701000 5                  TSX1    ARG_ERROR
         5 004420   000000 011000                    NOP     0

     1510    10978        /*    ERROR: ZII-130-1
     1511    10979              MESSAGE: Argument count error, or the last argument in
     1512    10980                       CALL FIND(FIRST/LAST/FORT-VAR,[REC-NAME],SET-NAME/AREA-NAME)
     1513    10981                       is neither a SET-NAME nor an AREA-NAME. */
     1514    10982    4                   END;

     1515    10983    3               END;

     1516    10984    2           END;

     1517    10985    1       GOTO COMMON_RETURN;

  10985  5 004421   005105 710000 5                  TRA     COMMON_RETURN

     1518    10986         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:227  
     1519    10987        /***************************************************************/
     1520    10988        /*                                                             */
     1521    10989        /*     CALLING SEQUENCE FOR GET:                               */
     1522    10990        /*          1. CALL GET                                        */
     1523    10991        /*          2. CALL GET(REC-NAME)                              */
     1524    10992        /*          3. CALL GET(FIELD-1,[FIELD-2],.....])              */
     1525    10993        /*                                                             */
     1526    10994        /***************************************************************/
     1527    10995
     1528    10996    1   GET: ENTRY(

  10996  5 004422   000000 700200 xent  GET          TSX0  ! X66_AUTO_N
         5 004423   000106 000024                    ZERO    70,20

     1529    10997               %GEN_PARAMS;
     1530    11538
     1531    11539    1       CALL SET_ARGS;

  11539  5 004424   000535 701000 5                  TSX1    SET_ARGS
         5 004425   000000 011000                    NOP     0

     1532    11540    1       IF NO_ARGS>0 AND ARG.TYPE(0)=%FIELD_NAME THEN

  11540  5 004426   000014 235000 1                  LDA     NO_ARGS
         5 004427   004512 604400 5                  TMOZ    s:11575
         5 004430   002055 470400 1                  LDP0    ARG$
         5 004431   000000 720100                    LXL0    0,,PR0
         5 004432   000042 100003                    CMPX0   34,DU
         5 004433   004512 601000 5                  TNZ     s:11575

     1533    11541    2       DO;

     1534    11542    2           IPT_GTF.V.FLCW.N_FIELDS#=NO_ARGS;

  11542  5 004434   000000 621005                    EAX1    0,AL
         5 004435   002054 471400 1                  LDP1    FPT$
         5 004436   100012 741100                    STX1    10,,PR1
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:228  

     1535    11543    3           DO I=0 TO NO_ARGS-1;

  11543  5 004437   000003 450000 1                  STZ     I
         5 004440   004460 710000 5                  TRA     s:11549+1

     1536    11544    3               IF ARG.TYPE(I)~=%FIELD_NAME THEN CALL ARG_ERROR(140);

  11544  5 004441   002055 470400 1                  LDP0    ARG$
         5 004442   000003 720000 1                  LXL0    I
         5 004443   000000 721110                    LXL1    0,X0,PR0
         5 004444   000042 101003                    CMPX1   34,DU
         5 004445   004452 600000 5                  TZE     s:11548

  11544  5 004446   000144 236000 6                  LDQ     100
         5 004447   200037 756100                    STQ     @A+2,,AUTO
         5 004450   000715 701000 5                  TSX1    ARG_ERROR
         5 004451   000000 011000                    NOP     0

     1537    11545        /*    ERROR: ZII-140-1
     1538    11546              MESSAGE: The argument list in GET CALL does not contain all FIELD-NAMES.
     1539    11547                       The correct syntax is CALL GET(FIELD-NAME,....). */
     1540    11548    3               IPT_GTF.V.FIELD_LIST.RVA_OFFSET#(I)=ARG.OFFSET(I);

  11548  5 004452   002055 470400 1                  LDP0    ARG$
         5 004453   000003 720000 1                  LXL0    I
         5 004454   000000 221110                    LDX1    0,X0,PR0
         5 004455   002054 471400 1                  LDP1    FPT$
         5 004456   100013 741110                    STX1    11,X0,PR1

     1541    11549    3               END;

  11549  5 004457   000003 054000 1                  AOS     I
         5 004460   000003 236000 1                  LDQ     I
         5 004461   000014 116000 1                  CMPQ    NO_ARGS
         5 004462   004441 604000 5                  TMI     s:11544

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:229  
     1542    11550    3           IF NO_ARGS > 1 THEN DO;

  11550  5 004463   000014 235000 1                  LDA     NO_ARGS
         5 004464   000001 115007                    CMPA    1,DL
         5 004465   004501 604400 5                  TMOZ    s:11556

     1543    11551    3               VBASE(IPT_GTF.V_) = ADDR(IPT_GTF.V);

  11551  5 004466   002054 236000 1                  LDQ     FPT$
         5 004467   000012 036003                    ADLQ    10,DU
         5 004470   100001 756100                    STQ     1,,PR1

     1544    11552    3               VBOUND(IPT_GTF.V_) = SIZEC(IPT_GTF.V.FLCW) +

  11552  5 004471   000014 236000 1                  LDQ     NO_ARGS
         5 004472   000002 736000                    QLS     2
         5 004473   000004 036007                    ADLQ    4,DL
         5 004474   000020 736000                    QLS     16
         5 004475   100000 676100                    ERQ     0,,PR1
         5 004476   000000 376000 6                  ANQ     0
         5 004477   100000 656100                    ERSQ    0,,PR1

     1545    11553    3                  SIZEC(IPT_GTF.V.FIELD_LIST) * (NO_ARGS);
     1546    11554    3               END;

  11554  5 004500   004505 710000 5                  TRA     s:11566

     1547    11555    3           ELSE DO;

     1548    11556    3               IPT_GTF.V_ = VECTOR(IPT_GTF.V);

  11556  5 004501   000012 235000 6                  LDA     10
         5 004502   002054 236000 1                  LDQ     FPT$
         5 004503   000012 036003                    ADLQ    10,DU
         5 004504   100000 757100                    STAQ    0,,PR1

     1549    11557    3               END; /* only use binding for dynamic structure */
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:230  

     1550    11558                %CLIMB(FCN=GTF);

  11566  5 004505   002054 630400 1                  EPPR0   FPT$
         5 004506   000053 631400 6                  EPPR1   43
         5 004507   000000 701000 xent               TSX1    U$GTF
         5 004510   000000 011000                    NOP     0

     1551    11572    2           END;

  11572  5 004511   004545 710000 5                  TRA     s:11600

     1552    11573    1       ELSE
     1553    11574    2       DO;

     1554    11575    2           IF NO_ARGS=0 THEN

  11575  5 004512   000000 115003                    CMPA    0,DU
         5 004513   004520 601000 5                  TNZ     s:11578

     1555    11576    2               IPT_GET.V.RC.RC_OFFSET#=NULL_OFFSET;

  11576  5 004514   002050 720000 1                  LXL0    NULL_OFFSET
         5 004515   002054 470400 1                  LDP0    FPT$
         5 004516   000012 740100                    STX0    10,,PR0
         5 004517   004534 710000 5                  TRA     s:11584

     1556    11577    2           ELSE
     1557    11578    2               IF ARG.TYPE(0)=%RECORD_NAME THEN

  11578  5 004520   002055 470400 1                  LDP0    ARG$
         5 004521   000000 720100                    LXL0    0,,PR0
         5 004522   000041 100003                    CMPX0   33,DU
         5 004523   004530 601000 5                  TNZ     s:11580

     1558    11579    2                   IPT_GET.V.RC.RC_OFFSET#=ARG.OFFSET(0);

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:231  
  11579  5 004524   000000 221100                    LDX1    0,,PR0
         5 004525   002054 471400 1                  LDP1    FPT$
         5 004526   100012 741100                    STX1    10,,PR1
         5 004527   004534 710000 5                  TRA     s:11584

     1559    11580    2               ELSE CALL ARG_ERROR(145);

  11580  5 004530   000146 236000 6                  LDQ     102
         5 004531   200037 756100                    STQ     @A+2,,AUTO
         5 004532   000715 701000 5                  TSX1    ARG_ERROR
         5 004533   000000 011000                    NOP     0

     1560    11581        /*    ERROR: ZII-145-1
     1561    11582              MESSAGE: Unknown 1st argument in GET CALL.
     1562    11583                       It is neither a RECORD-NAME nor a FIELD-NAME.  */
     1563    11584    2           IPT_GET.V_ = VECTOR(IPT_GET.V);

  11584  5 004534   000012 235000 6                  LDA     10
         5 004535   002054 236000 1                  LDQ     FPT$
         5 004536   000012 036003                    ADLQ    10,DU
         5 004537   002054 470400 1                  LDP0    FPT$
         5 004540   000000 757100                    STAQ    0,,PR0

     1564    11585                %CLIMB(FCN=GET);

  11593  5 004541   002054 630400 1                  EPPR0   FPT$
         5 004542   000053 631400 6                  EPPR1   43
         5 004543   000000 701000 xent               TSX1    U$GET
         5 004544   000000 011000                    NOP     0

     1565    11599    2           END;

     1566    11600    1       GOTO COMMON_RETURN;

  11600  5 004545   005105 710000 5                  TRA     COMMON_RETURN

     1567    11601         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:232  
     1568    11602    1   MODIFY: ENTRY(

  11602  5 004546   000000 700200 xent  MODIFY       TSX0  ! X66_AUTO_N
         5 004547   000106 000024                    ZERO    70,20

     1569    11603               %GEN_PARAMS;
     1570    12144
     1571    12145        /******************************************************************/
     1572    12146        /*                                                                */
     1573    12147        /*    CALL MODIFY([REC-NAME],[INCLUDING,ALL             ])        */
     1574    12148        /*                           ONLY      SET-NAME1,[...]            */
     1575    12149        /*                                                                */
     1576    12150        /*    CALL MODIFY(IDENT-1,[IDENT-2],...,,[INCLUDING,ALL       ])  */
     1577    12151        /*                                                SET-NAME-LIST   */
     1578    12152        /*                                                                */
     1579    12153        /******************************************************************/
     1580    12154
     1581    12155    1       CALL SET_ARGS;

  12155  5 004550   000535 701000 5                  TSX1    SET_ARGS
         5 004551   000000 011000                    NOP     0

     1582    12156    1       IPT_MOD.V.RC.RC_OFFSET#=NULL_OFFSET;

  12156  5 004552   002050 720000 1                  LXL0    NULL_OFFSET
         5 004553   002054 470400 1                  LDP0    FPT$
         5 004554   000012 740100                    STX0    10,,PR0

     1583    12157    1       IF NO_ARGS>0 THEN

  12157  5 004555   000014 235000 1                  LDA     NO_ARGS
         5 004556   004727 604400 5                  TMOZ    s:12210

     1584    12158    2       DO;

     1585    12159    2           K=0;

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:233  
  12159  5 004557   000004 450000 1                  STZ     K

     1586    12160    2           KK = 0; /* count dynamic structures */

  12160  5 004560   000042 450000 1                  STZ     KK

     1587    12161    2           IF ARG.TYPE(0)=%RECORD_NAME THEN

  12161  5 004561   002055 471400 1                  LDP1    ARG$
         5 004562   100000 721100                    LXL1    0,,PR1
         5 004563   000041 101003                    CMPX1   33,DU
         5 004564   004573 601000 5                  TNZ     s:12169

     1588    12162    3           DO;

     1589    12163    3               K=1;

  12163  5 004565   000001 236007                    LDQ     1,DL
         5 004566   000004 756000 1                  STQ     K

     1590    12164    3               KK = 1;

  12164  5 004567   000042 756000 1                  STQ     KK

     1591    12165    3               IPT_MOD.V.RC.RC_OFFSET#=ARG.OFFSET(0);

  12165  5 004570   100000 222100                    LDX2    0,,PR1
         5 004571   000012 742100                    STX2    10,,PR0

     1592    12166    3               END;

  12166  5 004572   004616 710000 5                  TRA     s:12176

     1593    12167    2           ELSE
     1594    12168    3           DO;

     1595    12169    4               DO WHILE(ARG.TYPE(K)=%FIELD_NAME AND K<NO_ARGS);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:234  

  12169  5 004573   004606 710000 5                  TRA     s:12174

     1596    12170    4                   IPT_MOD.V.FL_SL_LIST.RVA_OFFSET#(K)=ARG.OFFSET(K);

  12170  5 004574   002055 470400 1                  LDP0    ARG$
         5 004575   000004 720000 1                  LXL0    K
         5 004576   000000 221110                    LDX1    0,X0,PR0
         5 004577   002054 471400 1                  LDP1    FPT$
         5 004600   100016 741110                    STX1    14,X0,PR1

     1597    12171    4                   IPT_MOD.V.FLCW.N_FIELDS#=IPT_MOD.V.FLCW.N_FIELDS#+1;

  12171  5 004601   100014 222100                    LDX2    12,,PR1
         5 004602   000001 623012                    EAX3    1,X2
         5 004603   100014 743100                    STX3    12,,PR1

     1598    12172    4                   K=K+1;

  12172  5 004604   000004 054000 1                  AOS     K

     1599    12173    4                   KK = KK + 1;

  12173  5 004605   000042 054000 1                  AOS     KK

     1600    12174    4                   END;

  12174  5 004606   002055 470400 1                  LDP0    ARG$
         5 004607   000004 720000 1                  LXL0    K
         5 004610   000000 721110                    LXL1    0,X0,PR0
         5 004611   000042 101003                    CMPX1   34,DU
         5 004612   004616 601000 5                  TNZ     s:12176
         5 004613   000004 236000 1                  LDQ     K
         5 004614   000014 116000 1                  CMPQ    NO_ARGS
         5 004615   004574 604000 5                  TMI     s:12170

     1601    12175    3               END;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:235  

     1602    12176    2           IF K<NO_ARGS-1 AND (ARG.TYPE(K)=SNA.ONLY OR ARG.TYPE(K)=SNA.INCLUDING) THEN

  12176  5 004616   000014 236000 1                  LDQ     NO_ARGS
         5 004617   000001 136007                    SBLQ    1,DL
         5 004620   000004 116000 1                  CMPQ    K
         5 004621   004720 604400 5                  TMOZ    s:12206
         5 004622   002055 470400 1                  LDP0    ARG$
         5 004623   000004 720000 1                  LXL0    K
         5 004624   000000 236110                    LDQ     0,X0,PR0
         5 004625   777777 376007                    ANQ     -1,DL
         5 004626   000015 116000 0                  CMPQ    SNA+13
         5 004627   004632 600000 5                  TZE     s:12178
         5 004630   000007 116000 0                  CMPQ    SNA+7
         5 004631   004720 601000 5                  TNZ     s:12206

     1603    12177    3           DO;

     1604    12178    3               IF ARG.TYPE(K)=SNA.ONLY THEN

  12178  5 004632   000015 116000 0                  CMPQ    SNA+13
         5 004633   004645 601000 5                  TNZ     s:12186

     1605    12179    4               DO;

     1606    12180    4                   IPT_MOD.V.MCW.MC_BIT0#='1'B;

  12180  5 004634   002054 471400 1                  LDP1    FPT$
         5 004635   400000 236003                    LDQ     -131072,DU
         5 004636   100013 256100                    ORSQ    11,,PR1

     1607    12181    4                   IF IPT_MOD.V.FLCW.N_FIELDS#>0 THEN CALL ARG_ERROR(153);

  12181  5 004637   100014 221100                    LDX1    12,,PR1
         5 004640   004645 604400 5                  TMOZ    s:12186

  12181  5 004641   000150 236000 6                  LDQ     104
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:236  
         5 004642   200037 756100                    STQ     @A+2,,AUTO
         5 004643   000715 701000 5                  TSX1    ARG_ERROR
         5 004644   000000 011000                    NOP     0

     1608    12182    4                   END;

     1609    12183        /*    ERROR: ZII-153-1
     1610    12184              MESSAGE: Keyword ONLY not legal in MODIFY CALL
     1611    12185                       in conjunction with FIELD-NAME list.  */
     1612    12186    3               K=K+1;

  12186  5 004645   000004 054000 1                  AOS     K

     1613    12187    3               IF ARG.TYPE(K)=SNA.ALL THEN

  12187  5 004646   002055 470400 1                  LDP0    ARG$
         5 004647   000004 720000 1                  LXL0    K
         5 004650   000000 236110                    LDQ     0,X0,PR0
         5 004651   777777 376007                    ANQ     -1,DL
         5 004652   000000 116000 0                  CMPQ    SNA
         5 004653   004660 601000 5                  TNZ     s:12191

     1614    12188    3                   IPT_MOD.V.MCW.MC_BIT1#='1'B;

  12188  5 004654   002054 471400 1                  LDP1    FPT$
         5 004655   200000 236003                    LDQ     65536,DU
         5 004656   100013 256100                    ORSQ    11,,PR1
         5 004657   004727 710000 5                  TRA     s:12210

     1615    12189    3               ELSE
     1616    12190    4               DO;

     1617    12191    5                   DO WHILE (K<NO_ARGS);

  12191  5 004660   000004 236000 1                  LDQ     K
         5 004661   000014 116000 1                  CMPQ    NO_ARGS
         5 004662   004727 605000 5                  TPL     s:12210
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:237  

     1618    12192    5                       IF ARG.TYPE(K)~=%SET_NAME THEN CALL ARG_ERROR(150);

  12192  5 004663   002055 470400 1                  LDP0    ARG$
         5 004664   000004 720000 1                  LXL0    K
         5 004665   000000 721110                    LXL1    0,X0,PR0
         5 004666   000040 101003                    CMPX1   32,DU
         5 004667   004674 600000 5                  TZE     s:12196

  12192  5 004670   000152 236000 6                  LDQ     106
         5 004671   200037 756100                    STQ     @A+2,,AUTO
         5 004672   000715 701000 5                  TSX1    ARG_ERROR
         5 004673   000000 011000                    NOP     0

     1619    12193        /*    ERROR: ZII-150-1
     1620    12194              MESSAGE: Bad arguments found in MODIFY CALL
     1621    12195                       after keyword ONLY/INCLUDING.              */
     1622    12196    5                       IPT_MOD.V.FL_SL_LIST.RVA_OFFSET#

  12196  5 004674   002054 470400 1                  LDP0    FPT$
         5 004675   000015 236100                    LDQ     13,,PR0
         5 004676   000022 732000                    QRS     18
         5 004677   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 004700   000014 236100                    LDQ     12,,PR0
         5 004701   000022 732000                    QRS     18
         5 004702   200076 036100                    ADLQ    ERRMSG_BUF+30,,AUTO
         5 004703   002055 471400 1                  LDP1    ARG$
         5 004704   000004 720000 1                  LXL0    K
         5 004705   100000 221110                    LDX1    0,X0,PR1
         5 004706   000016 741106                    STX1    14,QL,PR0

     1623    12197    5                          (IPT_MOD.V.FLCW.N_FIELDS#+IPT_MOD.V.SLCW.N_SETS#)
     1624    12198    5                          =ARG.OFFSET(K);
     1625    12199    5                       IPT_MOD.V.SLCW.N_SETS#=IPT_MOD.V.SLCW.N_SETS#+1;

  12199  5 004707   000015 221100                    LDX1    13,,PR0
         5 004710   000001 622011                    EAX2    1,X1
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:238  
         5 004711   000015 742100                    STX2    13,,PR0

     1626    12200    5                       K=K+1;

  12200  5 004712   000004 054000 1                  AOS     K

     1627    12201    5                       KK = KK + 1;

  12201  5 004713   000042 054000 1                  AOS     KK

     1628    12202    5                       END;

  12202  5 004714   000004 236000 1                  LDQ     K
         5 004715   000014 116000 1                  CMPQ    NO_ARGS
         5 004716   004663 604000 5                  TMI     s:12192

     1629    12203    4                   END;

     1630    12204    3               END;

  12204  5 004717   004727 710000 5                  TRA     s:12210

     1631    12205    2           ELSE
     1632    12206    2               IF K<NO_ARGS THEN CALL ARG_ERROR(155);

  12206  5 004720   000004 236000 1                  LDQ     K
         5 004721   000014 116000 1                  CMPQ    NO_ARGS
         5 004722   004727 605000 5                  TPL     s:12210

  12206  5 004723   000154 236000 6                  LDQ     108
         5 004724   200037 756100                    STQ     @A+2,,AUTO
         5 004725   000715 701000 5                  TSX1    ARG_ERROR
         5 004726   000000 011000                    NOP     0

     1633    12207        /*    ERROR: ZII-155-1
     1634    12208              MESSAGE: Bad arguments found in MODIFY CALL.  */
     1635    12209    2           END;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:239  

     1636    12210    1       IPT_MOD.V_ = VECTOR(IPT_MOD.V);

  12210  5 004727   000116 235000 6                  LDA     78
         5 004730   002054 236000 1                  LDQ     FPT$
         5 004731   000012 036003                    ADLQ    10,DU
         5 004732   002054 470400 1                  LDP0    FPT$
         5 004733   000000 757100                    STAQ    0,,PR0

     1637    12211    2       IF KK ~= 0 THEN DO;

  12211  5 004734   000042 235000 1                  LDA     KK
         5 004735   004751 600000 5                  TZE     s:12220

     1638    12212    2           VBASE(IPT_MOD.V_) = ADDR(IPT_MOD.V);

  12212  5 004736   002054 236000 1                  LDQ     FPT$
         5 004737   000012 036003                    ADLQ    10,DU
         5 004740   000001 756100                    STQ     1,,PR0

     1639    12213    2           VBOUND(IPT_MOD.V_) = SIZEC(IPT_MOD.V.RC) +

  12213  5 004741   000042 236000 1                  LDQ     KK
         5 004742   000002 736000                    QLS     2
         5 004743   000020 036007                    ADLQ    16,DL
         5 004744   000020 736000                    QLS     16
         5 004745   000000 676100                    ERQ     0,,PR0
         5 004746   000000 376000 6                  ANQ     0
         5 004747   000000 656100                    ERSQ    0,,PR0

     1640    12214    2              SIZEC(IPT_MOD.V.MCW) +
     1641    12215    2              SIZEC(IPT_MOD.V.FLCW) +
     1642    12216    2              SIZEC(IPT_MOD.V.SLCW) +
     1643    12217    2              SIZEC(IPT_MOD.V.FL_SL_LIST) * KK;
     1644    12218    2           END;

  12218  5 004750   004760 710000 5                  TRA     s:12230
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:240  

     1645    12219    2       ELSE DO;

     1646    12220    2           IPT_MOD.V = VECTOR(IPT_MOD.V);

  12220  5 004751   000116 235000 6                  LDA     78
         5 004752   002054 236000 1                  LDQ     FPT$
         5 004753   000012 036003                    ADLQ    10,DU
         5 004754   200076 757100                    STAQ    ERRMSG_BUF+30,,AUTO
         5 004755   000100 100500                    MLR     fill='000'O
         5 004756   200076 000010                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=8
         5 004757   000012 000024                    ADSC9   10,,PR0                  cn=0,n=20

     1647    12221    2           END;

     1648    12222            %CLIMB(FCN=MOD);

  12230  5 004760   002054 630400 1                  EPPR0   FPT$
         5 004761   000053 631400 6                  EPPR1   43
         5 004762   000000 701000 xent               TSX1    U$MOD
         5 004763   000000 011000                    NOP     0

     1649    12236    1       GOTO COMMON_RETURN;

  12236  5 004764   005105 710000 5                  TRA     COMMON_RETURN

     1650    12237         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:241  
     1651    12238        /**   INTERNAL COMMON SUBROUTINE FOR CONNECT AND DISCONNECT   **/
     1652    12239
     1653    12240    1   CON_DIS: PROC ALTRET;

  12240  5 004765   200030 741300       CON_DIS      STX1  ! FIT$+1,,AUTO

     1654    12241
     1655    12242    2       CALL SET_ARGS;

  12242  5 004766   000535 701000 5                  TSX1    SET_ARGS
         5 004767   000000 011000                    NOP     0

     1656    12243
     1657    12244    3       DO CASE(NO_ARGS);

  12244  5 004770   000014 235000 1                  LDA     NO_ARGS
         5 004771   000003 115007                    CMPA    3,DL
         5 004772   004774 602005 5                  TNC     s:12244+4,AL
         5 004773   005040 710000 5                  TRA     s:12262
         5 004774   005040 710000 5                  TRA     s:12262
         5 004775   005021 710000 5                  TRA     s:12255
         5 004776   004777 710000 5                  TRA     s:12247

     1658    12245
     1659    12246    3       CASE(2);

     1660    12247    3           IF ARG.TYPE(0)~=%RECORD_NAME OR ARG.TYPE(1)~=%SET_NAME THEN CALL ARG_ERROR(
             12247                    160);

  12247  5 004777   002055 470400 1                  LDP0    ARG$
         5 005000   000000 720100                    LXL0    0,,PR0
         5 005001   000041 100003                    CMPX0   33,DU
         5 005002   005006 601000 5                  TNZ     s:12247+7
         5 005003   000001 721100                    LXL1    1,,PR0
         5 005004   000040 101003                    CMPX1   32,DU
         5 005005   005012 600000 5                  TZE     s:12252

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:242  
  12247  5 005006   000156 236000 6                  LDQ     110
         5 005007   200037 756100                    STQ     @ERR_NO,,AUTO
         5 005010   000715 701000 5                  TSX1    ARG_ERROR
         5 005011   000000 011000                    NOP     0

     1661    12248        /*    ERROR: ZII-160-1
     1662    12249              MESSAGE: Bad arguments found in CONNECT/DISCONNECT CALL.
     1663    12250                       The correct syntax is
     1664    12251                       CALL CONNECT/DISCONNECT(RECORD-NAME,SET-NAME). */
     1665    12252    3           IPT_CON.V.RC.RC_OFFSET#=ARG.OFFSET(0);

  12252  5 005012   002055 470400 1                  LDP0    ARG$
         5 005013   000000 220100                    LDX0    0,,PR0
         5 005014   002054 471400 1                  LDP1    FPT$
         5 005015   100012 740100                    STX0    10,,PR1

     1666    12253    3           IPT_CON.V.SC.SC_OFFSET#=ARG.OFFSET(1);

  12253  5 005016   000001 221100                    LDX1    1,,PR0
         5 005017   100013 741100                    STX1    11,,PR1
         5 005020   005044 710000 5                  TRA     s:12266

     1667    12254    3       CASE(1);

     1668    12255    3           IF ARG.TYPE(0)~=%SET_NAME THEN CALL ARG_ERROR(165);

  12255  5 005021   002055 470400 1                  LDP0    ARG$
         5 005022   000000 720100                    LXL0    0,,PR0
         5 005023   000040 100003                    CMPX0   32,DU
         5 005024   005031 600000 5                  TZE     s:12259

  12255  5 005025   000160 236000 6                  LDQ     112
         5 005026   200037 756100                    STQ     @ERR_NO,,AUTO
         5 005027   000715 701000 5                  TSX1    ARG_ERROR
         5 005030   000000 011000                    NOP     0

     1669    12256        /*    ERROR: ZII-165-1
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:243  
     1670    12257              MESSAGE: The only argument in CONNECT/DISCONNECT CALL
     1671    12258                       is not a SET-NAME.  */
     1672    12259    3           IPT_CON.V.RC.RC_OFFSET#=NULL_OFFSET;

  12259  5 005031   002050 720000 1                  LXL0    NULL_OFFSET
         5 005032   002054 470400 1                  LDP0    FPT$
         5 005033   000012 740100                    STX0    10,,PR0

     1673    12260    3           IPT_CON.V.SC.SC_OFFSET#=ARG.OFFSET(0);

  12260  5 005034   002055 471400 1                  LDP1    ARG$
         5 005035   100000 221100                    LDX1    0,,PR1
         5 005036   000013 741100                    STX1    11,,PR0
         5 005037   005044 710000 5                  TRA     s:12266

     1674    12261    3       CASE(ELSE);

     1675    12262    3           CALL ARG_ERROR(170);

  12262  5 005040   000162 236000 6                  LDQ     114
         5 005041   200037 756100                    STQ     @ERR_NO,,AUTO
         5 005042   000715 701000 5                  TSX1    ARG_ERROR
         5 005043   000000 011000                    NOP     0

     1676    12263        /*    ERROR: ZII-170-1
     1677    12264              MESSAGE: Wrong number of arguments in CONNECT/DISCONNECT CALL. */
     1678    12265    3           END;

     1679    12266    2   END CON_DIS;

  12266  5 005044   200030 221300                    LDX1  ! FIT$+1,,AUTO
         5 005045   000001 702211                    TSX2  ! 1,X1

     1680    12267
     1681    12268    1   CONNECT: ENTRY(A1,A2);

  12268  5 005046   000000 700200 xent  CONNECT      TSX0  ! X66_AUTO_N
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:244  
         5 005047   000106 000024                    ZERO    70,20

     1682    12269
     1683    12270    1       IPT_CON.V_ = VECTOR(IPT_CON.V);

  12270  5 005050   000012 235000 6                  LDA     10
         5 005051   002054 236000 1                  LDQ     FPT$
         5 005052   000012 036003                    ADLQ    10,DU
         5 005053   002054 470400 1                  LDP0    FPT$
         5 005054   000000 757100                    STAQ    0,,PR0

     1684    12271    1       CALL CON_DIS;

  12271  5 005055   004765 701000 5                  TSX1    CON_DIS
         5 005056   000000 011000                    NOP     0

     1685    12272            %CLIMB(FCN=CON);

  12280  5 005057   002054 630400 1                  EPPR0   FPT$
         5 005060   000053 631400 6                  EPPR1   43
         5 005061   000000 701000 xent               TSX1    U$CON
         5 005062   000000 011000                    NOP     0

     1686    12286    1       GOTO COMMON_RETURN;

  12286  5 005063   005105 710000 5                  TRA     COMMON_RETURN

     1687    12287
     1688    12288    1   DISCONNECT: ENTRY(A1,A2);

  12288  5 005064   000000 700200 xent  DISCONNECT   TSX0  ! X66_AUTO_N
         5 005065   000106 000024                    ZERO    70,20
         5 005066   005071 710000 5                  TRA     s:12291

     1689    12289    1   DISCONNE: ENTRY(A1,A2);

  12289  5 005067   000000 700200 xent  DISCONNE     TSX0  ! X66_AUTO_N
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:245  
         5 005070   000106 000024                    ZERO    70,20

     1690    12290
     1691    12291    1       IPT_DIS.V_ = VECTOR(IPT_DIS.V);

  12291  5 005071   000012 235000 6                  LDA     10
         5 005072   002054 236000 1                  LDQ     FPT$
         5 005073   000012 036003                    ADLQ    10,DU
         5 005074   002054 470400 1                  LDP0    FPT$
         5 005075   000000 757100                    STAQ    0,,PR0

     1692    12292    1       CALL CON_DIS;

  12292  5 005076   004765 701000 5                  TSX1    CON_DIS
         5 005077   000000 011000                    NOP     0

     1693    12293            %CLIMB(FCN=DIS);

  12301  5 005100   002054 630400 1                  EPPR0   FPT$
         5 005101   000053 631400 6                  EPPR1   43
         5 005102   000000 701000 xent               TSX1    U$DIS
         5 005103   000000 011000                    NOP     0

     1694    12307    1       GOTO COMMON_RETURN;

  12307  5 005104   005105 710000 5                  TRA     COMMON_RETURN

     1695    12308         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:246  
     1696    12309    1   COMMON_RETURN: /*  CHK IA(7) SEE IF ANY CLEAN-UP TO DO */
     1697    12310
     1698    12311    1       IDSSYSERR = PINCRW(IA$,5) -> SBIN36; /* MON ERR_CODE */

  12311  5 005105   002051 470400 1     COMMON_RETU* LDP0    IA$
         5 005106   000005 235100                    LDA     5,,PR0
         5 005107   000002 755000 1                  STA     IDSSYSERR

     1699    12312    1       IF IA_HALF(14)>0 THEN

  12312  5 005110   000100 101500                    MRL     fill='000'O
         5 005111   000007 000002                    ADSC9   7,,PR0                   cn=0,n=2
         5 005112   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 005113   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 005114   000000 116003                    CMPQ    0,DU
         5 005115   005132 600000 5                  TZE     s:12319

     1700    12313    2       DO;

     1701    12314    2           REDEF_PT.ADR=IA_HALF(14); /* GET ADDR FROM IA */

  12314  5 005116   000000 100500                    MLR     fill='000'O
         5 005117   000007 000002                    ADSC9   7,,PR0                   cn=0,n=2
         5 005120   000011 000002 1                  ADSC9   PT$                      cn=0,n=2

     1702    12315    2           IA_HALF(14) = 0; /* RESET FLAG */

  12315  5 005121   000100 101400                    MRL     fill='000'O
         5 005122   000032 000004 6                  ADSC9   26                       cn=0,n=4
         5 005123   000007 000002                    ADSC9   7,,PR0                   cn=0,n=2

     1703    12316    2           REDEF_PT.SEG#='006000'O; /* INSTRUCTION SEG # */

  12316  5 005124   006000 220003                    LDX0    3072,DU
         5 005125   000011 440000 1                  SXL0    PT$

     1704    12317    2           CALL EPTR$;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:247  

  12317  5 005126   000011 221000 1                  LDX1    PT$
         5 005127   000032 631400 6                  EPPR1   26
         5 005130   000000 701011                    TSX1    0,X1
         5 005131   000000 011000                    NOP     0

     1705    12318    2           END;

     1706    12319    1       IF IA_HALF(12)>0 THEN /* RETURN FROM ROLL BACK */

  12319  5 005132   002051 470400 1                  LDP0    IA$
         5 005133   000100 101500                    MRL     fill='000'O
         5 005134   000006 000002                    ADSC9   6,,PR0                   cn=0,n=2
         5 005135   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 005136   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 005137   000000 116003                    CMPQ    0,DU
         5 005140   005152 600000 5                  TZE     s:12325

     1707    12320    2       DO;

     1708    12321    2           IA_HALF(12)=0; /* RESET FLAG */

  12321  5 005141   000100 101400                    MRL     fill='000'O
         5 005142   000032 000004 6                  ADSC9   26                       cn=0,n=4
         5 005143   000006 000002                    ADSC9   6,,PR0                   cn=0,n=2

     1709    12322    2           DK_RET.RET_ADDR=IA_HALF(13); /* ASL PUT RETADDR THERE */

  12322  5 005144   000000 100500                    MLR     fill='000'O
         5 005145   000006 400002                    ADSC9   6,,PR0                   cn=2,n=2
         5 005146   000007 000002 1                  ADSC9   DEADLOCK_RET+1           cn=0,n=2

     1710    12323    2           UNWIND TO DEADLOCK_RET;

  12323  5 005147   000006 237200 1                  LDAQ  ! DEADLOCK_RET
         5 005150   000000 700200 xent               TSX0  ! X66_AUNWIND
         5 005151   000000 000200                    ZERO    0,128
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:248  

     1711    12324    2           END;
     1712    12325    1       RETURN;

  12325  5 005152   000000 702200 xent               TSX2  ! X66_ARET

     1713    12326         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:249  
     1714    12327        /**   COMMON SUBROUTINE FOR IFT OR IST   **/
     1715    12328    1   DO_IF: PROC(A) ALTRET;

  12328  5 005153   200030 741300       DO_IF        STX1  ! FIT$+1,,AUTO

     1716    12329    2   DCL A BIT(2) ALIGNED;
     1717    12330
     1718    12331    2       CALL SET_ARGS;

  12331  5 005154   000535 701000 5                  TSX1    SET_ARGS
         5 005155   000000 011000                    NOP     0

     1719    12332    2       IPT_IST.V.TDW=A;

  12332  5 005156   200031 470500                    LDP0    @A,,AUTO
         5 005157   000000 236100                    LDQ     0,,PR0
         5 005160   600000 376003                    ANQ     -65536,DU
         5 005161   002054 471400 1                  LDP1    FPT$
         5 005162   100012 756100                    STQ     10,,PR1

     1720    12333    3       DO CASE(NO_ARGS);

  12333  5 005163   000014 235000 1                  LDA     NO_ARGS
         5 005164   000003 115007                    CMPA    3,DL
         5 005165   005167 602005 5                  TNC     s:12333+4,AL
         5 005166   005246 710000 5                  TRA     s:12374
         5 005167   005246 710000 5                  TRA     s:12374
         5 005170   005172 710000 5                  TRA     s:12335
         5 005171   005212 710000 5                  TRA     s:12352

     1721    12334    3       CASE(1);

     1722    12335    3           IPT_IFT.V_ = VECTOR(IPT_IFT.V);

  12335  5 005172   000012 235000 6                  LDA     10
         5 005173   002054 236000 1                  LDQ     FPT$
         5 005174   000012 036003                    ADLQ    10,DU
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:250  
         5 005175   100000 757100                    STAQ    0,,PR1

     1723    12336                %CLIMB(FCN=IFT);

  12344  5 005176   002054 630400 1                  EPPR0   FPT$
         5 005177   000053 631400 6                  EPPR1   43
         5 005200   000000 701000 xent               TSX1    U$IFT
         5 005201   000000 011000                    NOP     0

     1724    12350    3           A1(0)=-1*UWA(0); /* UWA=0 IF F,1 IF T(FORTRAN WANT -1) */

  12350  5 005202   002052 470400 1                  LDP0    UWA$
         5 005203   000000 336100                    LCQ     0,,PR0
         5 005204   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 005205   200003 471500                    LDP1    @A1,,AUTO
         5 005206   000100 100500                    MLR     fill='000'O
         5 005207   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 005210   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         5 005211   005252 710000 5                  TRA     s:12379

     1725    12351    3       CASE(2);

     1726    12352    3           IF ARG.TYPE(0)~=%SET_NAME THEN CALL ARG_ERROR(175);

  12352  5 005212   002055 473400 1                  LDP3    ARG$
         5 005213   300000 720100                    LXL0    0,,PR3
         5 005214   000040 100003                    CMPX0   32,DU
         5 005215   005222 600000 5                  TZE     s:12356

  12352  5 005216   000164 236000 6                  LDQ     116
         5 005217   200037 756100                    STQ     @ERR_NO,,AUTO
         5 005220   000715 701000 5                  TSX1    ARG_ERROR
         5 005221   000000 011000                    NOP     0

     1727    12353        /*    ERROR: ZII-175-1
     1728    12354              MESSAGE: The 1st argument in IFOWNER/IFMEMBER/IFTENANT CALL
     1729    12355                       is not a SET-NAME but two arguments specified.  */
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:251  
     1730    12356    3           IPT_IST.V.SC.SC_OFFSET#=ARG.OFFSET(0);

  12356  5 005222   002055 470400 1                  LDP0    ARG$
         5 005223   000000 220100                    LDX0    0,,PR0
         5 005224   002054 471400 1                  LDP1    FPT$
         5 005225   100013 740100                    STX0    11,,PR1

     1731    12357    3           IPT_IST.V_ = VECTOR(IPT_IST.V);

  12357  5 005226   000012 235000 6                  LDA     10
         5 005227   002054 236000 1                  LDQ     FPT$
         5 005230   000012 036003                    ADLQ    10,DU
         5 005231   100000 757100                    STAQ    0,,PR1

     1732    12358                %CLIMB(FCN=IST);

  12366  5 005232   002054 630400 1                  EPPR0   FPT$
         5 005233   000053 631400 6                  EPPR1   43
         5 005234   000000 701000 xent               TSX1    U$IST
         5 005235   000000 011000                    NOP     0

     1733    12372    3           A2(0)=-1*UWA(0);

  12372  5 005236   002052 470400 1                  LDP0    UWA$
         5 005237   000000 336100                    LCQ     0,,PR0
         5 005240   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 005241   200004 471500                    LDP1    @A2,,AUTO
         5 005242   000100 100500                    MLR     fill='000'O
         5 005243   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 005244   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         5 005245   005252 710000 5                  TRA     s:12379

     1734    12373    3       CASE(ELSE);

     1735    12374    3           CALL ARG_ERROR(180);

  12374  5 005246   000166 236000 6                  LDQ     118
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:252  
         5 005247   200037 756100                    STQ     @ERR_NO,,AUTO
         5 005250   000715 701000 5                  TSX1    ARG_ERROR
         5 005251   000000 011000                    NOP     0

     1736    12375        /*    ERROR: ZII-180-1
     1737    12376              MESSAGE: Wrong number of arguments in
     1738    12377                       IFOWNER/IFMEMBER/IFTENANT CALL.  */
     1739    12378    3           END;

     1740    12379    2   END DO_IF;

  12379  5 005252   200030 221300                    LDX1  ! FIT$+1,,AUTO
         5 005253   000001 702211                    TSX2  ! 1,X1

     1741    12380         %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:253  
     1742    12381    1   IFEMPTY: ENTRY(A1,A2);

  12381  5 005254   000000 700200 xent  IFEMPTY      TSX0  ! X66_AUTO_N
         5 005255   000106 000024                    ZERO    70,20

     1743    12382
     1744    12383    1       CALL P_OFF_W(ADDR(A1),RVA$);

  12383  5 005256   200003 236100                    LDQ     @A1,,AUTO
         5 005257   200104 756100                    STQ     ERRMSG_BUF+36,,AUTO
         5 005260   000022 236000 6                  LDQ     18
         5 005261   200040 756100                    STQ     @ERR_NO+1,,AUTO
         5 005262   200104 630500                    EPPR0   ERRMSG_BUF+36,,AUTO
         5 005263   200037 450500                    STP0    @A+2,,AUTO
         5 005264   000003 701000 5                  TSX1    P_OFF_W
         5 005265   000000 011000                    NOP     0

     1745    12384    1       IF I<=0 OR I>RVA_SIZE OR RVA_TYPE(I)~=%SET_NAME_NET THEN CALL ARG_ERROR(185);

  12384  5 005266   000003 235000 1                  LDA     I
         5 005267   005305 604400 5                  TMOZ    s:12384+15
         5 005270   000003 236000 1                  LDQ     I
         5 005271   002047 116000 1                  CMPQ    RVA_SIZE
         5 005272   005305 605400 5                  TPNZ    s:12384+15
         5 005273   000001 735000                    ALS     1
         5 005274   005276 605000 5                  TPL     s:12384+8
         5 005275   000044 035003                    ADLA    36,DU
         5 005276   002061 470400 1                  LDP0    TYPE$
         5 005277   003100 061505                    CSR     bolr='003'O
         5 005300   000000 000002                    BDSC    0,A,PR0                  by=0,bit=0,n=2
         5 005301   200076 000044                    BDSC    ERRMSG_BUF+30,,AUTO      by=0,bit=0,n=36
         5 005302   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 005303   000001 116007                    CMPQ    1,DL
         5 005304   005311 600000 5                  TZE     s:12387

  12384  5 005305   000170 236000 6                  LDQ     120
         5 005306   200037 756100                    STQ     @A+2,,AUTO
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:254  
         5 005307   000715 701000 5                  TSX1    ARG_ERROR
         5 005310   000000 011000                    NOP     0

     1746    12385        /*    ERROR: ZII-185-1
     1747    12386              MESSAGE: The 1st argument in IFEMPTY CALL is not a SET-NAME. */
     1748    12387    1       IPT_IFM.V.SC.SC_OFFSET#=I;

  12387  5 005311   000003 720000 1                  LXL0    I
         5 005312   002054 470400 1                  LDP0    FPT$
         5 005313   000012 740100                    STX0    10,,PR0

     1749    12388    1       IPT_IFM.V_ = VECTOR(IPT_IFM.V);

  12388  5 005314   000012 235000 6                  LDA     10
         5 005315   002054 236000 1                  LDQ     FPT$
         5 005316   000012 036003                    ADLQ    10,DU
         5 005317   000000 757100                    STAQ    0,,PR0

     1750    12389            %CLIMB(FCN=IFM);

  12397  5 005320   002054 630400 1                  EPPR0   FPT$
         5 005321   000053 631400 6                  EPPR1   43
         5 005322   000000 701000 xent               TSX1    U$IFM
         5 005323   000000 011000                    NOP     0

     1751    12403    1       IF ADDR(A2(0))=ADDR(NIL) THEN CALL ARG_ERROR(190);

  12403  5 005324   200004 236100                    LDQ     @A2,,AUTO
         5 005325   000015 116000 6                  CMPQ    13
         5 005326   005333 601000 5                  TNZ     s:12408

  12403  5 005327   000172 236000 6                  LDQ     122
         5 005330   200037 756100                    STQ     @A+2,,AUTO
         5 005331   000715 701000 5                  TSX1    ARG_ERROR
         5 005332   000000 011000                    NOP     0

     1752    12404        /*    ERROR: ZII-190-3
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:255  
     1753    12405              MESSAGE: Wrong number of arguments in IFEMPTY CALL.
     1754    12406                       The correct syntax is
     1755    12407                       CALL IFEMPTY(SET-NAME,LOGIC-RESULT).  */
     1756    12408    1       A2(0)=-1*UWA(0);

  12408  5 005333   002052 470400 1                  LDP0    UWA$
         5 005334   000000 336100                    LCQ     0,,PR0
         5 005335   200076 756100                    STQ     ERRMSG_BUF+30,,AUTO
         5 005336   200004 471500                    LDP1    @A2,,AUTO
         5 005337   000100 100500                    MLR     fill='000'O
         5 005340   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 005341   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4

     1757    12409    1       GOTO COMMON_RETURN;

  12409  5 005342   005105 710000 5                  TRA     COMMON_RETURN

     1758    12410
     1759    12411    1   IFMEMBER: ENTRY(A1,A2);

  12411  5 005343   000000 700200 xent  IFMEMBER     TSX0  ! X66_AUTO_N
         5 005344   000106 000024                    ZERO    70,20

     1760    12412
     1761    12413    1       CALL DO_IF('01'B);

  12413  5 005345   000174 236000 6                  LDQ     124
         5 005346   200031 756100                    STQ     FIT$+2,,AUTO
         5 005347   005153 701000 5                  TSX1    DO_IF
         5 005350   000000 011000                    NOP     0

     1762    12414    1       GOTO COMMON_RETURN;

  12414  5 005351   005105 710000 5                  TRA     COMMON_RETURN

     1763    12415
     1764    12416    1   IFOWNER: ENTRY(A1,A2);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:256  

  12416  5 005352   000000 700200 xent  IFOWNER      TSX0  ! X66_AUTO_N
         5 005353   000106 000024                    ZERO    70,20

     1765    12417
     1766    12418    1       CALL DO_IF('10'B);

  12418  5 005354   000176 236000 6                  LDQ     126
         5 005355   200031 756100                    STQ     FIT$+2,,AUTO
         5 005356   005153 701000 5                  TSX1    DO_IF
         5 005357   000000 011000                    NOP     0

     1767    12419    1       GOTO COMMON_RETURN;

  12419  5 005360   005105 710000 5                  TRA     COMMON_RETURN

     1768    12420
     1769    12421    1   IFTENANT: ENTRY(A1,A2);

  12421  5 005361   000000 700200 xent  IFTENANT     TSX0  ! X66_AUTO_N
         5 005362   000106 000024                    ZERO    70,20

     1770    12422
     1771    12423    1       CALL DO_IF('11'B);

  12423  5 005363   000200 236000 6                  LDQ     128
         5 005364   200031 756100                    STQ     FIT$+2,,AUTO
         5 005365   005153 701000 5                  TSX1    DO_IF
         5 005366   000000 011000                    NOP     0

     1772    12424    1       GOTO COMMON_RETURN;

  12424  5 005367   005105 710000 5                  TRA     COMMON_RETURN

     1773    12425        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:257  
     1774    12426    1   BUFFERS: ENTRY(A1,A2);

  12426  5 005370   000000 700200 xent  BUFFERS      TSX0  ! X66_AUTO_N
         5 005371   000106 000024                    ZERO    70,20

     1775    12427
     1776    12428    1       IPT_NBF.BUFFS_REQ_=VECTOR(A1(0));

  12428  5 005372   777640 235007                    LDA     -96,DL
         5 005373   200003 236100                    LDQ     @A1,,AUTO
         5 005374   000024 470400 1                  LDP0    CHK_NBF_ROL_CRPT$
         5 005375   000000 757100                    STAQ    0,,PR0

     1777    12429    1       IPT_NBF.BUFFS_ALLOC_=VECTOR(A2(0));

  12429  5 005376   777640 235007                    LDA     -96,DL
         5 005377   200004 236100                    LDQ     @A2,,AUTO
         5 005400   000002 757100                    STAQ    2,,PR0

     1778    12430            %CLIMB(FCN=NBF);

  12438  5 005401   000024 630400 1                  EPPR0   CHK_NBF_ROL_CRPT$
         5 005402   000053 631400 6                  EPPR1   43
         5 005403   000000 701000 xent               TSX1    U$NBF
         5 005404   000000 011000                    NOP     0

     1779    12444    1       GOTO COMMON_RETURN;

  12444  5 005405   005105 710000 5                  TRA     COMMON_RETURN

     1780    12445    1   CRPT: ENTRY(A1);

  12445  5 005406   000000 700200 xent  CRPT         TSX0  ! X66_AUTO_N
         5 005407   000106 000024                    ZERO    70,20

     1781    12446
     1782    12447    1       FPT_SHORT.VEC1=VECTOR(FPT_SHORT.VEC2);
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:258  

  12447  5 005410   000202 237000 6                  LDAQ    130
         5 005411   000016 757000 1                  STAQ    FPT_SHORT

     1783    12448    1       ADDR(FPT_SHORT.VEC2)->SBIN36=A1(0); /* MAKE SURE SEED IS DALIGNED */

  12448  5 005412   200003 470500                    LDP0    @A1,,AUTO
         5 005413   000000 100500                    MLR     fill='000'O
         5 005414   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         5 005415   000020 000004 1                  ADSC9   FPT_SHORT+2              cn=0,n=4

     1784    12449            %CLIMB(FCN=CRPT);

  12457  5 005416   000024 630400 1                  EPPR0   CHK_NBF_ROL_CRPT$
         5 005417   000053 631400 6                  EPPR1   43
         5 005420   000000 701000 xent               TSX1    U$CRPT
         5 005421   000000 011000                    NOP     0

     1785    12463    1       GOTO COMMON_RETURN;

  12463  5 005422   005105 710000 5                  TRA     COMMON_RETURN

     1786    12464
     1787    12465    1   ROLL: ENTRY(A1);

  12465  5 005423   000000 700200 xent  ROLL         TSX0  ! X66_AUTO_N
         5 005424   000106 000024                    ZERO    70,20

     1788    12466
     1789    12467    1       IF ADDR(A1)=ADDR(NIL) THEN

  12467  5 005425   200003 236100                    LDQ     @A1,,AUTO
         5 005426   000015 116000 6                  CMPQ    13
         5 005427   005435 601000 5                  TNZ     s:12470

     1790    12468    1           FPT_SHORT.VEC1=VECTOR(PINCRW(UWA$,1)->CHAR7);

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:259  
  12468  5 005430   000101 235000 6                  LDA     65
         5 005431   002052 236000 1                  LDQ     UWA$
         5 005432   000001 036003                    ADLQ    1,DU
         5 005433   000016 757000 1                  STAQ    FPT_SHORT
         5 005434   005437 710000 5                  TRA     s:12471

     1791    12469    1       ELSE
     1792    12470    1           FPT_SHORT.VEC1=VECTOR(ADDR(A1)->CHAR7);

  12470  5 005435   000101 235000 6                  LDA     65
         5 005436   000016 757000 1                  STAQ    FPT_SHORT

     1793    12471    1       FPT_SHORT.VEC2=FPTS.IA_;

  12471  5 005437   002054 470400 1                  LDP0    FPT$
         5 005440   000002 237100                    LDAQ    2,,PR0
         5 005441   000020 757000 1                  STAQ    FPT_SHORT+2

     1794    12472            %CLIMB(FCN=ROL);

  12480  5 005442   000024 630400 1                  EPPR0   CHK_NBF_ROL_CRPT$
         5 005443   000053 631400 6                  EPPR1   43
         5 005444   000000 701000 xent               TSX1    U$ROL
         5 005445   000000 011000                    NOP     0

     1795    12486    1       GOTO COMMON_RETURN;

  12486  5 005446   005105 710000 5                  TRA     COMMON_RETURN

     1796    12487    1   KEEP: ENTRY;

  12487  5 005447   000000 700200 xent  KEEP         TSX0  ! X66_AUTO_N
         5 005450   000106 000024                    ZERO    70,20

     1797    12488
     1798    12489    1       IPT_KEEP.ERROR_=VECTOR(PINCRW(UWA$,1)->CHAR7);

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:260  
  12489  5 005451   000101 235000 6                  LDA     65
         5 005452   002052 236000 1                  LDQ     UWA$
         5 005453   000001 036003                    ADLQ    1,DU
         5 005454   000024 470400 1                  LDP0    CHK_NBF_ROL_CRPT$
         5 005455   000000 757100                    STAQ    0,,PR0

     1799    12490            %CLIMB(FCN=KEEP);

  12498  5 005456   000024 630400 1                  EPPR0   CHK_NBF_ROL_CRPT$
         5 005457   000053 631400 6                  EPPR1   43
         5 005460   000000 701000 xent               TSX1    U$KEEP
         5 005461   000000 011000                    NOP     0

     1800    12504    1       GOTO COMMON_RETURN;

  12504  5 005462   005105 710000 5                  TRA     COMMON_RETURN

     1801    12505
     1802    12506    1   REDUCEQ: ENTRY;

  12506  5 005463   000000 700200 xent  REDUCEQ      TSX0  ! X66_AUTO_N
         5 005464   000106 000024                    ZERO    70,20

     1803    12507
     1804    12508            %CLIMB(FCN=REDUCEQ);

  12516  5 005465   000024 630400 1                  EPPR0   CHK_NBF_ROL_CRPT$
         5 005466   000053 631400 6                  EPPR1   43
         5 005467   000000 701000 xent               TSX1    U$REDUCEQ
         5 005470   000000 011000                    NOP     0

     1805    12522    1       GOTO COMMON_RETURN;

  12522  5 005471   005105 710000 5                  TRA     COMMON_RETURN

     1806    12523        %EJECT;
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:261  
     1807    12524    1   RPTSTATS: ENTRY;

  12524  5 005472   000000 700200 xent  RPTSTATS     TSX0  ! X66_AUTO_N
         5 005473   000106 000024                    ZERO    70,20

     1808    12525
     1809    12526            %CLIMB(FCN=RPT,PARAMS=0);

  12537  5 005474   000032 631400 6                  EPPR1   26
         5 005475   000000 701000 xent               TSX1    U$RPT
         5 005476   000000 011000                    NOP     0

     1810    12540    1       RETURN;

  12540  5 005477   000000 702200 xent               TSX2  ! X66_ARET

     1811    12541
     1812    12542    1   STATSON: ENTRY;

  12542  5 005500   000000 700200 xent  STATSON      TSX0  ! X66_AUTO_N
         5 005501   000106 000024                    ZERO    70,20

     1813    12543
     1814    12544            %CLIMB(FCN=STON,PARAMS=0);

  12555  5 005502   000032 631400 6                  EPPR1   26
         5 005503   000000 701000 xent               TSX1    U$STON
         5 005504   000000 011000                    NOP     0

     1815    12558    1       RETURN;

  12558  5 005505   000000 702200 xent               TSX2  ! X66_ARET

     1816    12559
     1817    12560    1   STATSOFF: ENTRY;

  12560  5 005506   000000 700200 xent  STATSOFF     TSX0  ! X66_AUTO_N
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:262  
         5 005507   000106 000024                    ZERO    70,20

     1818    12561
     1819    12562            %CLIMB(FCN=STOFF,PARAMS=0);

  12573  5 005510   000032 631400 6                  EPPR1   26
         5 005511   000000 701000 xent               TSX1    U$STOFF
         5 005512   000000 011000                    NOP     0

     1820    12576    1       RETURN;

  12576  5 005513   000000 702200 xent               TSX2  ! X66_ARET

     1821    12577
     1822    12578    1   TRACE_COMMON: PROC;

  12578  5 005514   200030 741300       TRACE_COMMON STX1  ! FIT$+1,,AUTO

     1823    12579
     1824    12580    2       IF ADDR(A1)=ADDR(NIL) THEN

  12580  5 005515   200003 236100                    LDQ     @A1,,AUTO
         5 005516   000015 116000 6                  CMPQ    13
         5 005517   005522 601000 5                  TNZ     s:12583

     1825    12581    2           I=0; /* NO TRACE OPTION SPECIFIED */

  12581  5 005520   000003 450000 1                  STZ     I
         5 005521   005526 710000 5                  TRA     s:12584

     1826    12582    2       ELSE
     1827    12583    2           I=A1(0);

  12583  5 005522   200003 470500                    LDP0    @A1,,AUTO
         5 005523   000000 100500                    MLR     fill='000'O
         5 005524   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         5 005525   000003 000004 1                  ADSC9   I                        cn=0,n=4
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:263  

     1828    12584    2       FPT_SHORT.VEC1=VECTOR(I);

  12584  5 005526   000204 237000 6                  LDAQ    132
         5 005527   000016 757000 1                  STAQ    FPT_SHORT

     1829    12585    2   END TRACE_COMMON;

  12585  5 005530   000001 702211                    TSX2  ! 1,X1

     1830    12586
     1831    12587    1   TRACEOFF: ENTRY(A1);

  12587  5 005531   000000 700200 xent  TRACEOFF     TSX0  ! X66_AUTO_N
         5 005532   000106 000024                    ZERO    70,20

     1832    12588
     1833    12589    1       CALL TRACE_COMMON;

  12589  5 005533   005514 701000 5                  TSX1    TRACE_COMMON
         5 005534   000000 011000                    NOP     0

     1834    12590            %CLIMB(FCN=TROFF);

  12598  5 005535   000024 630400 1                  EPPR0   CHK_NBF_ROL_CRPT$
         5 005536   000053 631400 6                  EPPR1   43
         5 005537   000000 701000 xent               TSX1    U$TROFF
         5 005540   000000 011000                    NOP     0

     1835    12604    1       RETURN;

  12604  5 005541   000000 702200 xent               TSX2  ! X66_ARET

     1836    12605
     1837    12606    1   TRACEON: ENTRY(A1);

  12606  5 005542   000000 700200 xent  TRACEON      TSX0  ! X66_AUTO_N
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:264  
         5 005543   000106 000024                    ZERO    70,20

     1838    12607
     1839    12608    1       CALL TRACE_COMMON;

  12608  5 005544   005514 701000 5                  TSX1    TRACE_COMMON
         5 005545   000000 011000                    NOP     0

     1840    12609            %CLIMB(FCN=TRON);

  12617  5 005546   000024 630400 1                  EPPR0   CHK_NBF_ROL_CRPT$
         5 005547   000053 631400 6                  EPPR1   43
         5 005550   000000 701000 xent               TSX1    U$TRON
         5 005551   000000 011000                    NOP     0

     1841    12623    1       RETURN;

  12623  5 005552   000000 702200 xent               TSX2  ! X66_ARET

     1842    12624        /**************************************************************/
     1843    12625        /*                                                            */
     1844    12626        /*    CALL INVOKE(IA,UWA,RVA)                                 */
     1845    12627        /*                                                            */
     1846    12628        /*    1. REMEMBER UWA$ AND RVA$.  2.  DO A CLIMB TO 'HIA'     */
     1847    12629        /*                                                            */
     1848    12630        /**************************************************************/
     1849    12631
     1850    12632    1   INVOKE: ENTRY(A1,A2,A3);

  12632  5 005553   000000 700200 xent  INVOKE       TSX0  ! X66_AUTO_N
         5 005554   000106 000024                    ZERO    70,20

     1851    12633
     1852    12634    1       IA$=ADDR(A1);

  12634  5 005555   200003 236100                    LDQ     @A1,,AUTO
         5 005556   002051 756000 1                  STQ     IA$
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:265  

     1853    12635    1       UWA$=ADDR(A2);

  12635  5 005557   200004 236100                    LDQ     @A2,,AUTO
         5 005560   002052 756000 1                  STQ     UWA$

     1854    12636    1       RVA$=ADDR(A3);

  12636  5 005561   200005 236100                    LDQ     @A3,,AUTO
         5 005562   002053 756000 1                  STQ     RVA$

     1855    12637    1       IF RVA$ = B$DS8$ THEN

  12637  5 005563   000000 116000 1                  CMPQ    B$DS8$_B
         5 005564   005567 601000 5                  TNZ     s:12639

     1856    12638    1           CALL SDS$OPEN;

  12638  5 005565   000045 701000 5                  TSX1    SDS$OPEN
         5 005566   000000 011000                    NOP     0

     1857    12639    1       IF PAGE_VECTOR.ADR=ADDR(NIL) THEN

  12639  5 005567   002063 236000 1                  LDQ     PAGE_VECTOR+1
         5 005570   000015 116000 6                  CMPQ    13
         5 005571   005574 601000 5                  TNZ     s:12641

     1858    12640    1           CALL GET_A_PAGE;

  12640  5 005572   000740 701000 5                  TSX1    GET_A_PAGE
         5 005573   000000 011000                    NOP     0

     1859    12641    1       IF RVA_HALF(0)<131072 THEN

  12641  5 005574   002053 470400 1                  LDP0    RVA$
         5 005575   000100 101500                    MRL     fill='000'O
         5 005576   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:266  
         5 005577   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 005600   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 005601   400000 116007                    CMPQ    -131072,DL
         5 005602   005607 605000 5                  TPL     s:12644

     1860    12642    1           RVA_SIZE=RVA_HALF(0);

  12642  5 005603   000000 101500                    MRL     fill='000'O
         5 005604   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         5 005605   002047 000004 1                  ADSC9   RVA_SIZE                 cn=0,n=4
         5 005606   005615 710000 5                  TRA     s:12645

     1861    12643    1       ELSE
     1862    12644    1           RVA_SIZE=RVA_HALF(0)-131072;

  12644  5 005607   000100 101500                    MRL     fill='000'O
         5 005610   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         5 005611   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 005612   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 005613   400000 136007                    SBLQ    -131072,DL
         5 005614   002047 756000 1                  STQ     RVA_SIZE

     1863    12645    1       UWA_SIZE=A1(1);

  12645  5 005615   200003 471500                    LDP1    @A1,,AUTO
         5 005616   000000 100500                    MLR     fill='000'O
         5 005617   100001 000004                    ADSC9   1,,PR1                   cn=0,n=4
         5 005620   002046 000004 1                  ADSC9   UWA_SIZE                 cn=0,n=4

     1864    12646    1       CALL VEC_MAKER(A1,47,FPTS.IA_);

  12646  5 005621   002054 236000 1                  LDQ     FPT$
         5 005622   000002 036003                    ADLQ    2,DU
         5 005623   000207 235000 6                  LDA     135
         5 005624   200032 757100                    STAQ    @A+1,,AUTO
         5 005625   200003 236100                    LDQ     @A1,,AUTO
         5 005626   200031 756100                    STQ     FIT$+2,,AUTO
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:267  
         5 005627   000025 701000 5                  TSX1    VEC_MAKER
         5 005630   000000 011000                    NOP     0

     1865    12647    1       CALL VEC_MAKER(A2,UWA_SIZE,FPTS.UWA_);

  12647  5 005631   002054 236000 1                  LDQ     FPT$
         5 005632   000004 036003                    ADLQ    4,DU
         5 005633   000210 235000 6                  LDA     136
         5 005634   200032 757100                    STAQ    @A+1,,AUTO
         5 005635   200004 236100                    LDQ     @A2,,AUTO
         5 005636   200031 756100                    STQ     FIT$+2,,AUTO
         5 005637   000025 701000 5                  TSX1    VEC_MAKER
         5 005640   000000 011000                    NOP     0

     1866    12648    1       CALL VEC_MAKER(A3,RVA_SIZE,FPTS.RVA_);

  12648  5 005641   002054 236000 1                  LDQ     FPT$
         5 005642   000006 036003                    ADLQ    6,DU
         5 005643   000211 235000 6                  LDA     137
         5 005644   200032 757100                    STAQ    @A+1,,AUTO
         5 005645   200005 236100                    LDQ     @A3,,AUTO
         5 005646   200031 756100                    STQ     FIT$+2,,AUTO
         5 005647   000025 701000 5                  TSX1    VEC_MAKER
         5 005650   000000 011000                    NOP     0

     1867    12649    1       IF RVA_HALF(0)<131072 OR

  12649  5 005651   002053 470400 1                  LDP0    RVA$
         5 005652   000100 101500                    MRL     fill='000'O
         5 005653   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         5 005654   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 005655   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 005656   400000 116007                    CMPQ    -131072,DL
         5 005657   005674 604000 5                  TMI     s:12651
         5 005660   400000 220003                    LDX0    -131072,DU
         5 005661   002053 236000 1                  LDQ     RVA$
         5 005662   000000 116000 1                  CMPQ    B$DS8$_B
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:268  
         5 005663   005665 600000 5                  TZE     s:12649+12
         5 005664   000000 220003                    LDX0    0,DU
         5 005665   000045 236000 1                  LDQ     SDSFLAG
         5 005666   400000 376003                    ANQ     -131072,DU
         5 005667   400000 676003                    ERQ     -131072,DU
         5 005670   200077 756100                    STQ     ERRMSG_BUF+31,,AUTO
         5 005671   000000 636010                    EAQ     0,X0
         5 005672   200077 376100                    ANQ     ERRMSG_BUF+31,,AUTO
         5 005673   006064 600000 5                  TZE     HIA

     1868    12650    2          (RVA$ = B$DS8$ & ~ SDSFLAG) THEN DO;

     1869    12651    2           SDSFLAG = '1'B;

  12651  5 005674   400000 236003                    LDQ     -131072,DU
         5 005675   000045 756000 1                  STQ     SDSFLAG

     1870    12652    3           IF RVA$ = B$DS8$ THEN DO;

  12652  5 005676   002053 236000 1                  LDQ     RVA$
         5 005677   000000 116000 1                  CMPQ    B$DS8$_B
         5 005700   005731 601000 5                  TNZ     s:12662

     1871    12653        /*          Set up NULL_OFFSET and RVA_TYPE table DBACS supplied
     1872    12654                    data in shared data segment file buffers */
     1873    12655    3               PT$ = PINCRW(RVA$, RVA_SIZE+1);

  12655  5 005701   002047 236000 1                  LDQ     RVA_SIZE
         5 005702   000022 736000                    QLS     18
         5 005703   000001 036003                    ADLQ    1,DU
         5 005704   002053 036000 1                  ADLQ    RVA$
         5 005705   000011 756000 1                  STQ     PT$

     1874    12656    3               NULL_OFFSET = PT$->SBIN36;

  12656  5 005706   000011 471400 1                  LDP1    PT$
         5 005707   100000 235100                    LDA     0,,PR1
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:269  
         5 005710   002050 755000 1                  STA     NULL_OFFSET

     1875    12657    3               PT$ = PINCRW(PT$, 1);

  12657  5 005711   000001 036003                    ADLQ    1,DU
         5 005712   000011 756000 1                  STQ     PT$

     1876    12658    3               IX = (RVA_SIZE+1)*%TYPE_BITS/9 + 1;

  12658  5 005713   002047 236000 1                  LDQ     RVA_SIZE
         5 005714   000001 736000                    QLS     1
         5 005715   000002 036007                    ADLQ    2,DL
         5 005716   000011 506007                    DIV     9,DL
         5 005717   000001 036007                    ADLQ    1,DL
         5 005720   000001 756000 1                  STQ     IX

     1877    12659    3               RVA_TYPEC = PT$->RVA_TYPEC;

  12659  5 005721   000011 471400 1                  LDP1    PT$
         5 005722   000000 620006                    EAX0    0,QL
         5 005723   002061 473400 1                  LDP3    TYPE$
         5 005724   000001 721000 1                  LXL1    IX
         5 005725   040140 100540                    MLR     fill='040'O
         5 005726   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         5 005727   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1

     1878    12660    3               END;

  12660  5 005730   005771 710000 5                  TRA     s:12668

     1879    12661    3           ELSE DO;

     1880    12662    4               DO I=1 TO RVA_SIZE;

  12662  5 005731   000001 235007                    LDA     1,DL
         5 005732   000003 755000 1                  STA     I
         5 005733   005766 710000 5                  TRA     s:12666+1
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:270  

     1881    12663    4                   RVA_TYPE(I)=RVA_HALF(2*I);

  12663  5 005734   000003 236000 1                  LDQ     I
         5 005735   000044 402007                    MPY     36,DL
         5 005736   000000 116003                    CMPQ    0,DU
         5 005737   005741 605000 5                  TPL     s:12663+5
         5 005740   000044 036003                    ADLQ    36,DU
         5 005741   000003 235000 1                  LDA     I
         5 005742   000001 735000                    ALS     1
         5 005743   005745 605000 5                  TPL     s:12663+9
         5 005744   000044 035003                    ADLA    36,DU
         5 005745   002053 470400 1                  LDP0    RVA$
         5 005746   002061 471400 1                  LDP1    TYPE$
         5 005747   003105 061506                    CSR     bolr='003'O
         5 005750   000000 000022                    BDSC    0,Q,PR0                  by=0,bit=0,n=18
         5 005751   100000 000002                    BDSC    0,A,PR1                  by=0,bit=0,n=2

     1882    12664    4                   IF RVA_HALF(2*I)=4 THEN

  12664  5 005752   000003 235000 1                  LDA     I
         5 005753   000002 735000                    ALS     2
         5 005754   002053 470400 1                  LDP0    RVA$
         5 005755   000100 101505                    MRL     fill='000'O
         5 005756   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2
         5 005757   200076 000004                    ADSC9   ERRMSG_BUF+30,,AUTO      cn=0,n=4
         5 005760   200076 236100                    LDQ     ERRMSG_BUF+30,,AUTO
         5 005761   000004 116007                    CMPQ    4,DL
         5 005762   005765 601000 5                  TNZ     s:12666

     1883    12665    4                       NULL_OFFSET=I;

  12665  5 005763   000003 236000 1                  LDQ     I
         5 005764   002050 756000 1                  STQ     NULL_OFFSET

     1884    12666    4                   END;

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:271  
  12666  5 005765   000003 054000 1                  AOS     I
         5 005766   000003 236000 1                  LDQ     I
         5 005767   002047 116000 1                  CMPQ    RVA_SIZE
         5 005770   005734 604400 5                  TMOZ    s:12663

     1885    12667    3               END;

     1886    12668    2           I=%FPT_SIZE+%RLCW_SIZE+RVA_SIZE/(36/%TYPE_BITS)+1;

  12668  5 005771   002047 236000 1                  LDQ     RVA_SIZE
         5 005772   000022 506007                    DIV     18,DL
         5 005773   000112 036007                    ADLQ    74,DL
         5 005774   000003 756000 1                  STQ     I

     1887    12669    2           IF MOD(I,2)=0 THEN

  12669  5 005775   000002 506007                    DIV     2,DL
         5 005776   000044 733000                    LRS     36
         5 005777   000000 116003                    CMPQ    0,DU
         5 006000   006006 601000 5                  TNZ     s:12672

     1888    12670    2               USEP$=PINCRW(FPT$,I);

  12670  5 006001   000003 236000 1                  LDQ     I
         5 006002   000022 736000                    QLS     18
         5 006003   002054 036000 1                  ADLQ    FPT$
         5 006004   002056 756000 1                  STQ     USEP$
         5 006005   006013 710000 5                  TRA     s:12673

     1889    12671    2           ELSE
     1890    12672    2               USEP$=PINCRW(FPT$,I+1);

  12672  5 006006   000003 236000 1                  LDQ     I
         5 006007   000022 736000                    QLS     18
         5 006010   000001 036003                    ADLQ    1,DU
         5 006011   002054 036000 1                  ADLQ    FPT$
         5 006012   002056 756000 1                  STQ     USEP$
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:272  

     1891    12673    2           USEP.M=0;

  12673  5 006013   002056 470400 1                  LDP0    USEP$
         5 006014   000212 236000 6                  LDQ     138
         5 006015   000000 356100                    ANSQ    0,,PR0

     1892    12674    2           USEP.FLAG='0'B;

  12674  5 006016   000213 236000 6                  LDQ     139
         5 006017   000000 356100                    ANSQ    0,,PR0

     1893    12675    2           FPTS.USEP_=VECTOR(USEP);

  12675  5 006020   000214 235000 6                  LDA     140
         5 006021   002056 236000 1                  LDQ     USEP$
         5 006022   002054 471400 1                  LDP1    FPT$
         5 006023   100010 757100                    STAQ    8,,PR1

     1894    12676    2           E$=ENTADDR(GET);

  12676  5 006024   004422 636000 5                  EAQ     s:10996
         5 006025   000012 756000 1                  STQ     E$

     1895    12677    2           IDS_ADR(0)=REDEF_E$.ADR;

  12677  5 006026   000012 220000 1                  LDX0    E$
         5 006027   000025 740000 1                  STX0    IDS_ADR

     1896    12678    2           E$=ENTADDR(MODIFY);

  12678  5 006030   004546 636000 5                  EAQ     s:11602
         5 006031   000012 756000 1                  STQ     E$

     1897    12679    2           IDS_ADR(1)=REDEF_E$.ADR;

  12679  5 006032   000012 221000 1                  LDX1    E$
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:273  
         5 006033   000026 741000 1                  STX1    IDS_ADR+1

     1898    12680    2           E$=ENTADDR(STORE);

  12680  5 006034   002520 636000 5                  EAQ     s:9704
         5 006035   000012 756000 1                  STQ     E$

     1899    12681    2           IDS_ADR(2)=REDEF_E$.ADR;

  12681  5 006036   000012 222000 1                  LDX2    E$
         5 006037   000027 742000 1                  STX2    IDS_ADR+2

     1900    12682    2           E$=ENTADDR(ERASER);

  12682  5 006040   002647 636000 5                  EAQ     s:9761
         5 006041   000012 756000 1                  STQ     E$

     1901    12683    2           IDS_ADR(3)=REDEF_E$.ADR;

  12683  5 006042   000012 223000 1                  LDX3    E$
         5 006043   000030 743000 1                  STX3    IDS_ADR+3

     1902    12684    2           E$=ENTADDR(CONNECT);

  12684  5 006044   005046 636000 5                  EAQ     s:12268
         5 006045   000012 756000 1                  STQ     E$

     1903    12685    2           IDS_ADR(4)=REDEF_E$.ADR;

  12685  5 006046   000012 224000 1                  LDX4    E$
         5 006047   000031 744000 1                  STX4    IDS_ADR+4

     1904    12686    2           E$=ENTADDR(DISCONNE);

  12686  5 006050   005067 636000 5                  EAQ     s:12289
         5 006051   000012 756000 1                  STQ     E$

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:274  
     1905    12687    2           IDS_ADR(5)=REDEF_E$.ADR;

  12687  5 006052   000012 225000 1                  LDX5    E$
         5 006053   000032 745000 1                  STX5    IDS_ADR+5

     1906    12688    2           E$=ENTADDR(DISCONNECT);

  12688  5 006054   005064 636000 5                  EAQ     s:12288
         5 006055   000012 756000 1                  STQ     E$

     1907    12689    2           IDS_ADR(6)=REDEF_E$.ADR;

  12689  5 006056   000012 226000 1                  LDX6    E$
         5 006057   000033 746000 1                  STX6    IDS_ADR+6

     1908    12690    2           E$=ENTADDR(FIND);

  12690  5 006060   002777 636000 5                  EAQ     s:9828
         5 006061   000012 756000 1                  STQ     E$

     1909    12691    2           IDS_ADR(7)=REDEF_E$.ADR;

  12691  5 006062   000012 227000 1                  LDX7    E$
         5 006063   000034 747000 1                  STX7    IDS_ADR+7

     1910    12692    2           END;

     1911    12693    1   HIA:
     1912    12694            %CLIMB(FCN=HIA);

  12702  5 006064   002054 630400 1     HIA          EPPR0   FPT$
         5 006065   000053 631400 6                  EPPR1   43
         5 006066   000000 701000 xent               TSX1    U$HIA
         5 006067   000000 011000                    NOP     0

     1913    12708    1       GOTO COMMON_RETURN;

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:275  
  12708  5 006070   005105 710000 5                  TRA     COMMON_RETURN

SNA
 Sect OctLoc
   0     000   000000 000002   000000 000003   000000 000006   000000 000007    ................
   0     004   000000 000010   000000 000011   000000 000012   000000 000013    ................
   0     010   000000 000014   000000 000015   000000 000016   000000 000017    ................
   0     014   000000 000020   000000 000021   000000 000022   000000 000023    ................
   0     020   000000 000005   000000 000004   000000 000024   000000 000014    ................
   0     024   000000 000026   000000 000027   000000 000030   000000 000031    ................
   0     030   000000 000032   000000 000033   000000 000034   000000 000035    ................
   0     034   000000 000036   000000 000037                                    ........

B$DS8$_B
 Sect OctLoc
   1     000   000000 006013                                                    ....

DEADLOCK_RET
 Sect OctLoc
   1     006   000000 006004   000000 000000                                    ........

AUTO$
 Sect OctLoc
   1     010   000000 006004                                                    ....

NINE_WORDS
 Sect OctLoc
   1     013   000000 000504                                                    ....

FPT_SHORT
 Sect OctLoc
   1     016   000000 777640   000003 006000   ****** ******   ****** ******    ................
   1     022   ****** ******   ****** ******                                    ........

CHK_NBF_ROL_CRPT$
 Sect OctLoc
   1     024   000016 006000                                                    ....
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:276  

IDS_ADR
 Sect OctLoc
   1     025   ****** ******   ****** ******   ****** ******   ****** ******    ................

IDS_BIT9
 Sect OctLoc
   1     035   400200 100040   020010 010004                                    ..@ ....

RETAIN_SWITCH
 Sect OctLoc
   1     037   000000 000000                                                    ....

SDSFLAG
 Sect OctLoc
   1     045   0***** ******                                                    ....

FPBUF
 Sect OctLoc
   1     046   ****** ******   ****** ******   ****** ******   ****** ******    ................

PAGE_VECTOR
 Sect OctLoc
   1    2062   ****** ******   000000 006014                                    ........

ERR_CODE
 Sect OctLoc
   1    2064   321111 *****3                                                    .I..

FPT_GDP
 Sect OctLoc
   1    2066   000001 777640   002072 006000   000001 777640   002062 006000    .....:.......2..
   1    2072   000000 000001   ****** ******                                    ........

FILE_NAME
 Sect OctLoc
   1    2074   011072 132111   105122 122115   123107 ******                    .:ZIERRMSG..
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:277  

FILE_ACCT
 Sect OctLoc
   1    2077   072123 131123   040040 040040                                    :SYS

FPT_ERRMSG
 Sect OctLoc
   1    2102   000003 777640   002130 006000   000000 777640   002064 006000    .....X.......4..
   1    2106   000000 177640   000000 006014   000002 377640   002074 006000    .............<..
   1    2112   000001 777640   002077 006000   000000 177640   000000 006014    .....?..........
   1    2116   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1    2126*  000000 177640   000000 006014   000000 000000   000000 000000    ................
   1    2132   375000 030001   040000 000000                                    .... ...

FPT_YC
 Sect OctLoc
   1    2134   000000 177640   000000 006014   000001 777640   002142 006000    .............b..
   1    2140   000000 177640   000000 006014   000000 000000   0***** ******    ................

FPT_FDS
 Sect OctLoc
   1    2144   000001 777640   002150 006000   000001 777640   002300 006000    .....h..........
   1    2150   000000 777777   ****** ******                                    ........

FPT_GETDCB
 Sect OctLoc
   1    2152   000001 777640   002160 006000   000007 777640   002260 006000    .....p..........
   1    2156   000000 777640   000043 006000   000000 000000   000000 000000    .....#..........

FPT_RELDCB
 Sect OctLoc
   1    2162   000001 777640   002164 006000   000000 000000   000000 000000    .....t..........

OPEN_SDS
 Sect OctLoc
   1    2166   000025 777640   002232 006000   000000 177640   000000 006014    ................
   1    2172   000000 177640   000000 006014   000000 177640   000000 006014    ................
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:278  
   1    2216*  001777 777640   000046 006000   000000 177640   000000 006014    .....&..........
   1    2222   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1    2232*  000000 000442   000000 002001   252525 000013   000040 252520    ............. ..
   1    2236   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   1    2242   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1    2246   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   1    2252   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1    2256   000000 000000   ****** ******                                    ........

SDS_NAME
 Sect OctLoc
   1    2260   001040 040040   040040 040040   040040 040040   040040 040040    .
   1    2264   040040 040040   040040 040040   040040 040040   040040 040040

VLP_NAME
 Sect OctLoc
   1    2270   001040 040040   040040 040040   040040 040040   040040 040040    .
   1    2274   040040 040040   040040 040040   040040 040040   040040 040040

VEC
 Sect OctLoc
   1    2300   000000 177640   000000 006013                                    ........

(unnamed)
 Sect OctLoc
   4     000   123105 124040                                                    SET

(unnamed)
 Sect OctLoc
   6     000   777777 600000   040040 040040   044040 040040   777777 577777    ....    $   ....
   6     004   000000 006003   000000 000000   000007 777640   002270 006000    ................
   6     010   000000 777640   000044 006000   000001 777640   000046 006000    .....$.......&..
   6     014   000000 177640   000000 006014   000000 011625   000016 006000    ................
   6     020   000000 011626   000020 006000   002053 006000   000000 006000    .........+......
   6     024   002052 006000   000000 000002   000025 006000   777777 777734    .*..............
   6     030   000000 000012   000030 006000   000000 000000   000035 777640    ................
   6     034   000063 777640   000000 000005   000035 006000   000000 000017    .3..............
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:279  
   6     040   000037 006000   000777 777777   000000 000024   000042 006000    ............."..
   6     044   000000 000001   056040 040040   777743 777777   000000 000031    .....   ........
   6     050   000047 006000   000000 000036   000051 006000   000001 000000    .'.......)......
   6     054   777777 777777   000000 000043   000055 006000   000000 000045    .......#.-.....%
   6     060   000057 006000   000003 777640   000000 000050   000062 006000    ./.........(.2..
   6     064   000000 000051   000064 006000   000000 000053   000066 006000    ...).4.....+.6..
   6     070   000000 000054   000070 006000   000000 000055   000072 006000    ...,.8.....-.:..
   6     074   000000 000062   000074 006000   000032 006000   000000 000065    ...2.<.........5
   6     100   000077 006000   000001 577640   000000 000067   000102 006000    .?.........7.B..
   6     104   000000 000074   000104 006000   000000 000101   000106 006000    ...<.D.....A.F..
   6     110   000000 000106   000110 006000   000000 000113   000112 006000    ...F.H.....K.J..
   6     114   000000 000120   000114 006000   000005 777640   000000 000125    ...P.L.........U
   6     120   000117 006000   000000 000132   000121 006000   000000 000137    .O.....Z.Q....._
   6     124   000123 006000   000000 000144   000125 006000   000000 000151    .S.....d.U.....i
   6     130   000127 006000   000000 000156   000131 006000   000000 000163    .W.....n.Y.....s
   6     134   000133 006000   000000 000170   000135 006000   000000 000175    .[.....x.].....}
   6     140   000137 006000   000000 000202   000141 006000   000000 000214    ._.......a......
   6     144   000143 006000   000000 000221   000145 006000   000000 000231    .c.......e......
   6     150   000147 006000   000000 000226   000151 006000   000000 000233    .g.......i......
   6     154   000153 006000   000000 000240   000155 006000   000000 000245    .k.......m......
   6     160   000157 006000   000000 000252   000161 006000   000000 000257    .o.......q......
   6     164   000163 006000   000000 000264   000165 006000   000000 000271    .s.......u......
   6     170   000167 006000   000000 000276   000171 006000   200000 000000    .w.......y......
   6     174   000173 006000   400000 000000   000175 006000   600000 000000    .{.......}......
   6     200   000177 006000   000000 000000   000001 777640   000020 006000    ................
   6     204   000000 777640   000003 006000   000000 000057   000206 006000    .........../....
   6     210   002046 006000   002047 006000   400000 777777   377777 777777    .&...'..........
   6     214   000623 777640                                                    ....
     1914    12709    1   END ZII$FORT_PL6;
     1915    12710
     1916    12711
     1917    12712
     1918    12713
     1919    12714
     1920    12715
     1921    12716
     1922    12717
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:280  
     1923    12718

PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:281  
--  Include file information  --

   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI_DBCS.:ZIC0TOU  is referenced.
   ZI$USER.:ZIC0TOU  is referenced.
   FM$FIT.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   B_SEGIDS_C.:LIB_E05  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZII$FORT_PL6.

   Procedure ZII$FORT_PL6 requires 3129 words for executable code.
   Procedure ZII$FORT_PL6 requires 70 words of local(AUTO) storage.

    No errors detected in file ZII$IDS_FORT_USER.:ZIC0TSI    .
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:282  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:283  
          MINI XREF LISTING

A IN PROCEDURE CHK_ARG
      5792**DCL      5790--PROC     5794--ASSIGN   5795--IF       5796--CALL     5804--CALL     5806>>ASSIGN
      5809--CALL     5813--ASSIGN
A IN PROCEDURE DO_IF
     12329**DCL     12328--PROC    12332>>ASSIGN
A IN PROCEDURE P_OFF_W
      5390**DCL      5389--PROC
A.ADR IN PROCEDURE P_OFF_W
      5391**DCL      5400>>ASSIGN
A.SEG IN PROCEDURE P_OFF_W
      5393**DCL      5399>>IF
A IN PROCEDURE VEC_MAKER
      5408**DCL      5407--PROC     5414--ASSIGN
A020
      1078**DCL        44--PROC     6358<>CALL     6464--ENTRY    7060--ENTRY    7629--ENTRY    8257--ENTRY
      8970--ENTRY    9828--ENTRY   10996--ENTRY   11602--ENTRY
A1
       601**DCL        44--PROC     5883<>CALL     6464--ENTRY    7011>>IF       7014>>IF       7017>>IF
      7060--ENTRY    7629--ENTRY    8199--ENTRY    8201--ASSIGN   8257--ENTRY    8970--ENTRY    9542--ENTRY
      9569--ENTRY    9584--ASSIGN   9626--ASSIGN   9704--ENTRY    9729--ENTRY    9734--ASSIGN   9761--ENTRY
      9828--ENTRY   10642>>IF      10741>>IF      10924>>ASSIGN  10996--ENTRY   11602--ENTRY   12268--ENTRY
     12288--ENTRY   12289--ENTRY   12350<<ASSIGN  12381--ENTRY   12383--CALL    12411--ENTRY   12416--ENTRY
     12421--ENTRY   12426--ENTRY   12428--ASSIGN  12445--ENTRY   12448>>ASSIGN  12465--ENTRY   12467--IF
     12470--ASSIGN  12580--IF      12583>>ASSIGN  12587--ENTRY   12606--ENTRY   12632--ENTRY   12634--ASSIGN
     12645>>ASSIGN  12646<>CALL
A10
       828**DCL        44--PROC     6108<>CALL     6464--ENTRY    7060--ENTRY    7629--ENTRY    8257--ENTRY
      8970--ENTRY    9828--ENTRY   10996--ENTRY   11602--ENTRY
A11
       853**DCL        44--PROC     6133<>CALL     6464--ENTRY    7060--ENTRY    7629--ENTRY    8257--ENTRY
      8970--ENTRY    9828--ENTRY   10996--ENTRY   11602--ENTRY
A12
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:284  
       878**DCL        44--PROC     6158<>CALL     6464--ENTRY    7060--ENTRY    7629--ENTRY    8257--ENTRY
      8970--ENTRY    9828--ENTRY   10996--ENTRY   11602--ENTRY
A13
       903**DCL        44--PROC     6183<>CALL     6464--ENTRY    7060--ENTRY    7629--ENTRY    8257--ENTRY
      8970--ENTRY    9828--ENTRY   10996--ENTRY   11602--ENTRY
A14
       928**DCL        44--PROC     6208<>CALL     6464--ENTRY    7060--ENTRY    7629--ENTRY    8257--ENTRY
      8970--ENTRY    9828--ENTRY   10996--ENTRY   11602--ENTRY
A15
       953**DCL        44--PROC     6233<>CALL     6464--ENTRY    7060--ENTRY    7629--ENTRY    8257--ENTRY
      8970--ENTRY    9828--ENTRY   10996--ENTRY   11602--ENTRY
A16
       978**DCL        44--PROC     6258<>CALL     6464--ENTRY    7060--ENTRY    7629--ENTRY    8257--ENTRY
      8970--ENTRY    9828--ENTRY   10996--ENTRY   11602--ENTRY
A17
      1003**DCL        44--PROC     6283<>CALL     6464--ENTRY    7060--ENTRY    7629--ENTRY    8257--ENTRY
      8970--ENTRY    9828--ENTRY   10996--ENTRY   11602--ENTRY
A18
      1028**DCL        44--PROC     6308<>CALL     6464--ENTRY    7060--ENTRY    7629--ENTRY    8257--ENTRY
      8970--ENTRY    9828--ENTRY   10996--ENTRY   11602--ENTRY
A19
      1053**DCL        44--PROC     6333<>CALL     6464--ENTRY    7060--ENTRY    7629--ENTRY    8257--ENTRY
      8970--ENTRY    9828--ENTRY   10996--ENTRY   11602--ENTRY
A2
       626**DCL        44--PROC     5908<>CALL     6464--ENTRY    7060--ENTRY    7629--ENTRY    8199--ENTRY
      8204<<ASSIGN   8219<<ASSIGN   8221<<ASSIGN   8257--ENTRY    8970--ENTRY    9542--ENTRY    9550--ASSIGN
      9569--ENTRY    9597--ASSIGN   9729--ENTRY    9739--IF       9742--ASSIGN   9761--ENTRY    9775--IF
      9828--ENTRY   10622--ASSIGN  10996--ENTRY   11602--ENTRY   12268--ENTRY   12288--ENTRY   12289--ENTRY
     12372<<ASSIGN  12381--ENTRY   12403--IF      12408<<ASSIGN  12411--ENTRY   12416--ENTRY   12421--ENTRY
     12426--ENTRY   12429--ASSIGN  12632--ENTRY   12635--ASSIGN  12647<>CALL
A3
       651**DCL        44--PROC     5933<>CALL     6464--ENTRY    7060--ENTRY    7629--ENTRY    8257--ENTRY
      8970--ENTRY    9569--ENTRY    9828--ENTRY   10525--ASSIGN  10996--ENTRY   11602--ENTRY   12632--ENTRY
     12636--ASSIGN  12648<>CALL
A4
       678**DCL        44--PROC     5958<>CALL     6464--ENTRY    7060--ENTRY    7629--ENTRY    8257--ENTRY
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:285  
      8970--ENTRY    9828--ENTRY   10996--ENTRY   11602--ENTRY
A5
       703**DCL        44--PROC     5983<>CALL     6464--ENTRY    7060--ENTRY    7629--ENTRY    8257--ENTRY
      8970--ENTRY    9828--ENTRY   10996--ENTRY   11602--ENTRY
A6
       728**DCL        44--PROC     6008<>CALL     6464--ENTRY    7060--ENTRY    7629--ENTRY    8257--ENTRY
      8970--ENTRY    9828--ENTRY   10996--ENTRY   11602--ENTRY
A7
       753**DCL        44--PROC     6033<>CALL     6464--ENTRY    7060--ENTRY    7629--ENTRY    8257--ENTRY
      8970--ENTRY    9828--ENTRY   10996--ENTRY   11602--ENTRY
A8
       778**DCL        44--PROC     6058<>CALL     6464--ENTRY    7060--ENTRY    7629--ENTRY    8257--ENTRY
      8970--ENTRY    9828--ENTRY   10996--ENTRY   11602--ENTRY
A9
       803**DCL        44--PROC     6083<>CALL     6464--ENTRY    7060--ENTRY    7629--ENTRY    8257--ENTRY
      8970--ENTRY    9828--ENTRY   10996--ENTRY   11602--ENTRY
ANAME_
      3486**DCL      9584--ASSIGN
ARG.OFFSET
      1204**DCL      5799<<ASSIGN   5837<<ASSIGN   7028<<ASSIGN   7043>>ASSIGN   8180>>ASSIGN   8920>>ASSIGN
      9518>>ASSIGN   9551>>ASSIGN   9589>>ASSIGN   9592>>ASSIGN   9638>>ASSIGN   9710>>ASSIGN   9771>>ASSIGN
     10413>>ASSIGN  10414>>ASSIGN  10464>>ASSIGN  10465>>ASSIGN  10470>>ASSIGN  10524>>ASSIGN  10545>>ASSIGN
     10546>>ASSIGN  10555>>ASSIGN  10640>>ASSIGN  10702>>ASSIGN  10710>>ASSIGN  10751>>ASSIGN  10805>>ASSIGN
     10806>>ASSIGN  10809>>ASSIGN  10877>>ASSIGN  10916>>ASSIGN  10926>>ASSIGN  11548>>ASSIGN  11579>>ASSIGN
     12165>>ASSIGN  12170>>ASSIGN  12196>>ASSIGN  12252>>ASSIGN  12253>>ASSIGN  12260>>ASSIGN  12356>>ASSIGN
ARG.TYPE
      1205**DCL      5800<<ASSIGN   5806<<ASSIGN   5810<<ASSIGN   5838<<ASSIGN   7023>>DOWHILE  7605>>IF
      8178>>IF       8184>>IF       8187>>IF       8190>>IF       8805>>ASSIGN   8904>>ASSIGN   8919>>IF
      9517>>IF       9545>>IF       9581>>IF       9585>>DOCASE   9630>>IF       9639>>DOCASE   9642>>IF
      9647>>IF       9652>>IF       9655>>IF       9658>>IF       9661>>IF       9709>>IF       9770>>IF
      9772>>IF      10372>>IF      10395>>IF      10407>>IF      10409>>IF      10445>>IF      10448>>IF
     10455>>IF      10457>>IF      10457>>IF      10467>>IF      10511>>DOCASE  10513>>IF      10528>>IF
     10540>>IF      10547>>IF      10554>>IF      10633>>IF      10697>>IF      10705>>IF      10741>>IF
     10790>>IF      10793>>IF      10800>>IF      10814>>DOCASE  10873>>IF      10917>>IF      10921>>IF
     10925>>IF      10931>>DOCASE  11540>>IF      11544>>IF      11578>>IF      12161>>IF      12169>>DOWHILE
     12176>>IF      12176>>IF      12178>>IF      12187>>IF      12192>>IF      12247>>IF      12247>>IF
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:286  
     12255>>IF      12352>>IF
ARG$
      3968**DCL      1203--IMP-PTR  5799>>ASSIGN   5800>>ASSIGN   5806>>ASSIGN   5810>>ASSIGN   5837>>ASSIGN
      5838>>ASSIGN   6435<<ASSIGN   7023>>DOWHILE  7028>>ASSIGN   7043>>ASSIGN   7605>>IF       8178>>IF
      8180>>ASSIGN   8184>>IF       8187>>IF       8190>>IF       8805>>ASSIGN   8904>>ASSIGN   8919>>IF
      8920>>ASSIGN   9517>>IF       9518>>ASSIGN   9545>>IF       9551>>ASSIGN   9581>>IF       9585>>DOCASE
      9589>>ASSIGN   9592>>ASSIGN   9630>>IF       9638>>ASSIGN   9639>>DOCASE   9642>>IF       9647>>IF
      9652>>IF       9655>>IF       9658>>IF       9661>>IF       9709>>IF       9710>>ASSIGN   9770>>IF
      9771>>ASSIGN   9772>>IF      10372>>IF      10395>>IF      10407>>IF      10409>>IF      10413>>ASSIGN
     10414>>ASSIGN  10445>>IF      10448>>IF      10455>>IF      10457>>IF      10457>>IF      10464>>ASSIGN
     10465>>ASSIGN  10467>>IF      10470>>ASSIGN  10511>>DOCASE  10513>>IF      10524>>ASSIGN  10528>>IF
     10540>>IF      10545>>ASSIGN  10546>>ASSIGN  10547>>IF      10554>>IF      10555>>ASSIGN  10633>>IF
     10640>>ASSIGN  10697>>IF      10702>>ASSIGN  10705>>IF      10710>>ASSIGN  10741>>IF      10751>>ASSIGN
     10790>>IF      10793>>IF      10800>>IF      10805>>ASSIGN  10806>>ASSIGN  10809>>ASSIGN  10814>>DOCASE
     10873>>IF      10877>>ASSIGN  10916>>ASSIGN  10917>>IF      10921>>IF      10925>>IF      10926>>ASSIGN
     10931>>DOCASE  11540>>IF      11544>>IF      11548>>ASSIGN  11578>>IF      11579>>ASSIGN  12161>>IF
     12165>>ASSIGN  12169>>DOWHILE 12170>>ASSIGN  12176>>IF      12176>>IF      12178>>IF      12187>>IF
     12192>>IF      12196>>ASSIGN  12247>>IF      12247>>IF      12252>>ASSIGN  12253>>ASSIGN  12255>>IF
     12260>>ASSIGN  12352>>IF      12356>>ASSIGN
ARG_ERROR
      6414**PROC     5770--CALL     5779--CALL     5817--CALL     5835--CALL     5859--CALL     6446--CALL
      7020--CALL     7039--CALL     8193--CALL     8914--CALL     8919--CALL     9517--CALL     9545--CALL
      9630--CALL     9645--CALL     9650--CALL     9664--CALL     9666--CALL     9669--CALL     9709--CALL
      9733--CALL     9774--CALL    10394--CALL    10409--CALL    10451--CALL    10458--CALL    10473--CALL
     10540--CALL    10554--CALL    10605--CALL    10635--CALL    10697--CALL    10705--CALL    10800--CALL
     10811--CALL    10855--CALL    10873--CALL    10930--CALL    10977--CALL    11544--CALL    11580--CALL
     12181--CALL    12192--CALL    12206--CALL    12247--CALL    12255--CALL    12262--CALL    12352--CALL
     12374--CALL    12384--CALL    12403--CALL
AUTO$
      3494**DCL      3495--REDEF
AUTO_FRAME
      3485**DCL      5857>>ASSIGN   5857>>ASSIGN   8941>>ASSIGN   8941>>ASSIGN   9539>>ASSIGN   9539>>ASSIGN
      9758>>ASSIGN   9758>>ASSIGN
B IN PROCEDURE P_OFF_W
      5394**DCL      5389--PROC
B.ADR IN PROCEDURE P_OFF_W
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:287  
      5395**DCL      5400>>ASSIGN
B.SEG IN PROCEDURE P_OFF_W
      5397**DCL      5399>>IF
B IN PROCEDURE VEC_MAKER
      5409**DCL      5407--PROC     5415>>ASSIGN
B$AUTO$
      3495**DCL      3485--IMP-PTR  5857>>ASSIGN   5857>>ASSIGN   8941>>ASSIGN   8941>>ASSIGN   9539>>ASSIGN
      9539>>ASSIGN   9758>>ASSIGN   9758>>ASSIGN
B$DS8$
      3458**DCL     12637>>IF      12649>>IF      12652>>IF
B$DS8$_B
      3457**DCL      3458--REDEF
B$EXCFR.ASL
      5367**DCL      5367--REDEF
B$EXCFR.ERR.ERR#
      5381**DCL      5381--REDEF
B$EXCFR.ERR.FCG
      5381**DCL      8221--ASSIGN
B$EXCFR.EVID
      5380**DCL      5380--REDEF    5381--REDEF
B$EXCFR.IR
      5368**DCL      5368--REDEF
B$EXCFR.PREVSZ
      5367**DCL      5367--REDEF
B$EXCFR.SUBC
      5379**DCL      5379--REDEF    5380--REDEF    5380--REDEF
B$TCB.ALT$
      5364**DCL      8221>>ASSIGN
B$TCB$
      3475**DCL      8221>>ASSIGN
BINARY_SEARCH IN PROCEDURE CHK_ARG
      5817**LABEL    5825--GOTO     5830--GOTO
C IN PROCEDURE VEC_MAKER
      5410**DCL      5407--PROC     5414<<ASSIGN
C.V_SIZE IN PROCEDURE VEC_MAKER
      5411**DCL      5415<<ASSIGN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:288  
CHAR7
      3473**DCL      7608>>CALLBLT  9740--ASSIGN   9742--ASSIGN  12468--ASSIGN  12470--ASSIGN  12489--ASSIGN
CHAR_V
      3474**DCL      8203>>CALLBLT  8210>>DOWHILE  8213>>CALLBLT  8215>>IF       8217--ASSIGN
CHK_ARG
      5790**PROC     5883--CALL     5908--CALL     5933--CALL     5958--CALL     5983--CALL     6008--CALL
      6033--CALL     6058--CALL     6083--CALL     6108--CALL     6133--CALL     6158--CALL     6183--CALL
      6208--CALL     6233--CALL     6258--CALL     6283--CALL     6308--CALL     6333--CALL     6358--CALL
CHK_NBF_ROL_CRPT$
      3512**DCL      4661--IMP-PTR  4684--IMP-PTR  5088--IMP-PTR  5098--IMP-PTR  5107--IMP-PTR  5130--IMP-PTR
      5154--IMP-PTR  5163--IMP-PTR  9734>>ASSIGN   9740>>ASSIGN   9742>>ASSIGN   9743>>ASSIGN   9752>>CALL
     12428>>ASSIGN  12429>>ASSIGN  12438>>CALL    12457>>CALL    12480>>CALL    12489>>ASSIGN  12498>>CALL
     12516>>CALL    12598>>CALL    12617>>CALL
CHK_RETAIN
      8226**PROC     9712--CALL     9799--CALL    10374--CALL    10427--CALL    10478--CALL    10558--CALL
     10641--CALL    10712--CALL    10752--CALL    10813--CALL    10878--CALL    10929--CALL
CLEAR_BITS
      3506**DCL      6404<<ASSIGN
CODE04.CREATION.TIME
      3755**DCL      5769>>IF
COMMON_RETURN
     12311**LABEL    8963--GOTO     9540--GOTO     9702--GOTO     9727--GOTO     9759--GOTO     9793--GOTO
     10389--GOTO    10985--GOTO    11600--GOTO    12236--GOTO    12286--GOTO    12307--GOTO    12409--GOTO
     12414--GOTO    12419--GOTO    12424--GOTO    12444--GOTO    12463--GOTO    12486--GOTO    12504--GOTO
     12522--GOTO    12708--GOTO
CONNECT
     12268**ENTRY   12684--ASSIGN
CON_DIS
     12240**PROC    12271--CALL    12292--CALL
DEADLOCK_RET
      3487**DCL      3488--REDEF   12323>>UNWIND
DISCONNE
     12289**ENTRY   12686--ASSIGN
DISCONNECT
     12288**ENTRY   12688--ASSIGN
DK_RET.AUTO_OFFSET
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:289  
      3489**DCL      8941<<ASSIGN   9539<<ASSIGN   9758<<ASSIGN
DK_RET.RET_ADDR
      3491**DCL     12322<<ASSIGN
DO_IF
     12328**PROC    12413--CALL    12418--CALL    12423--CALL
E$
      3501**DCL      3502--REDEF   12676<<ASSIGN  12678<<ASSIGN  12680<<ASSIGN  12682<<ASSIGN  12684<<ASSIGN
     12686<<ASSIGN  12688<<ASSIGN  12690<<ASSIGN
END_OF_ARGS IN PROCEDURE SET_ARGS
      6404**LABEL    5883--CALLALT  5908--CALLALT  5933--CALLALT  5958--CALLALT  5983--CALLALT  6008--CALLALT
      6033--CALLALT  6058--CALLALT  6083--CALLALT  6108--CALLALT  6133--CALLALT  6158--CALLALT  6183--CALLALT
      6208--CALLALT  6233--CALLALT  6258--CALLALT  6283--CALLALT  6308--CALLALT  6333--CALLALT  6358--CALLALT
EPTR$
      3497**DCL      8945>>CALL    12317>>CALL
ERASER
      9761**ENTRY   12682--ASSIGN
ERRMSG_BUF IN PROCEDURE ARG_ERROR
      6417**DCL      6420--ASSIGN
ERR_CODE
      5175**DCL      5330--DCLINIT
ERR_CODE.ERR_NO
      5177**DCL      6419<<ASSIGN
ERR_NO IN PROCEDURE ARG_ERROR
      6416**DCL      6414--PROC     6419>>ASSIGN
F$DCB.ACCT# IN PROCEDURE SDS$OPEN
      5443**DCL      5742--ASSIGN
F$DCB.ACTPOS IN PROCEDURE SDS$OPEN
      5459**DCL      5459--REDEF
F$DCB.ARS# IN PROCEDURE SDS$OPEN
      5433**DCL      5433--REDEF
F$DCB.ASN# IN PROCEDURE SDS$OPEN
      5448**DCL      5727>>IF       5738>>IF
F$DCB.ATTR IN PROCEDURE SDS$OPEN
      5452**DCL      5453--REDEF
F$DCB.BORROW IN PROCEDURE SDS$OPEN
      5467**DCL      5467--REDEF    5467--REDEF    5467--REDEF
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:290  
F$DCB.DCBNAME.L IN PROCEDURE SDS$OPEN
      5481**DCL      5481--IMP-SIZ
F$DCB.EOMCHAR# IN PROCEDURE SDS$OPEN
      5437**DCL      5437--REDEF
F$DCB.FCD# IN PROCEDURE SDS$OPEN
      5446**DCL      5720>>IF
F$DCB.FLDID IN PROCEDURE SDS$OPEN
      5462**DCL      5462--REDEF
F$DCB.FORM$ IN PROCEDURE SDS$OPEN
      5456**DCL      5456--REDEF
F$DCB.FSECT IN PROCEDURE SDS$OPEN
      5472**DCL      5472--REDEF
F$DCB.FSN# IN PROCEDURE SDS$OPEN
      5449**DCL      5449--REDEF    5449--REDEF    5450--REDEF
F$DCB.HEADER$ IN PROCEDURE SDS$OPEN
      5455**DCL      5455--REDEF
F$DCB.IXTNSIZE# IN PROCEDURE SDS$OPEN
      5453**DCL      5453--REDEF
F$DCB.LASTSTA$ IN PROCEDURE SDS$OPEN
      5442**DCL      5442--REDEF
F$DCB.LVL IN PROCEDURE SDS$OPEN
      5468**DCL      5468--REDEF
F$DCB.NAME# IN PROCEDURE SDS$OPEN
      5443**DCL      5741>>ASSIGN
F$DCB.NAME#.C IN PROCEDURE SDS$OPEN
      5443**DCL      5443--REDEF
F$DCB.NOEOF IN PROCEDURE SDS$OPEN
      5465**DCL      5465--REDEF
F$DCB.NRECS# IN PROCEDURE SDS$OPEN
      5454**DCL      5454--REDEF
F$DCB.NRECX IN PROCEDURE SDS$OPEN
      5473**DCL      5473--REDEF
F$DCB.OHDR IN PROCEDURE SDS$OPEN
      5465**DCL      5465--REDEF
F$DCB.ORG# IN PROCEDURE SDS$OPEN
      5448**DCL      5448--REDEF
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:291  
F$DCB.PRECNO IN PROCEDURE SDS$OPEN
      5471**DCL      5471--REDEF
F$DCB.RCSZ IN PROCEDURE SDS$OPEN
      5477**DCL      5477--REDEF
F$DCB.RES# IN PROCEDURE SDS$OPEN
      5444**DCL      5444--REDEF
F$DCB.SETX IN PROCEDURE SDS$OPEN
      5456**DCL      5456--REDEF
F$DCB.TAB$ IN PROCEDURE SDS$OPEN
      5456**DCL      5456--REDEF
F$DCB.TDA IN PROCEDURE SDS$OPEN
      5470**DCL      5471--REDEF
F$DCB.WSN# IN PROCEDURE SDS$OPEN
      5444**DCL      5444--REDEF
FILE_ACCT
      5316**DCL      5331--DCLINIT
FILE_NAME
      5303**DCL      5331--DCLINIT
FIND
      9828**ENTRY   12690--ASSIGN
FINDBKEY
      9797**PROC    10526--CALL    10623--CALL
FIT$
      3759**DCL      5764<<ASSIGN   5765>>DOWHILE  5768<<ASSIGN   5768>>ASSIGN   5768>>ASSIGN   5769>>IF
FM$FIT.CODES.CODE
      3748**DCL      5765>>DOWHILE
FM$FIT.CODES.ITEMX
      3748**DCL      5768>>ASSIGN
FPBUF
      3758**DCL      5598--DCLINIT  5764--ASSIGN
FPT$
      3967**DCL      1213--IMP-PTR  4622--IMP-PTR  4635--IMP-PTR  4649--IMP-PTR  4671--IMP-PTR  4693--IMP-PTR
      4706--IMP-PTR  4718--IMP-PTR  4731--IMP-PTR  4748--IMP-PTR  4765--IMP-PTR  4780--IMP-PTR  4794--IMP-PTR
      4809--IMP-PTR  4824--IMP-PTR  4840--IMP-PTR  4856--IMP-PTR  4869--IMP-PTR  4886--IMP-PTR  4903--IMP-PTR
      4918--IMP-PTR  4935--IMP-PTR  4952--IMP-PTR  4969--IMP-PTR  4985--IMP-PTR  4997--IMP-PTR  5010--IMP-PTR
      5021--IMP-PTR  5033--IMP-PTR  5045--IMP-PTR  5059--IMP-PTR  5072--IMP-PTR  5116--IMP-PTR  5139--IMP-PTR
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:292  
      5794>>ASSIGN   6404>>ASSIGN   6434<<ASSIGN   6435>>ASSIGN   6436>>ASSIGN   6438>>ASSIGN   6438>>ASSIGN
      6439>>ASSIGN   7034>>ASSIGN   7044>>ASSIGN   7608>>CALLBLT  7611>>ASSIGN   8906>>ASSIGN   8909>>ASSIGN
      8912>>ASSIGN   8920>>ASSIGN   8922>>ASSIGN   8923>>ASSIGN   8923>>ASSIGN   8924>>ASSIGN   8935>>CALL
      8946>>ASSIGN   8946>>ASSIGN   8955>>CALL     9518>>ASSIGN   9520>>ASSIGN   9521>>ASSIGN   9521>>ASSIGN
      9522>>ASSIGN   9533>>CALL     9549>>ASSIGN   9549>>ASSIGN   9550>>ASSIGN   9551>>ASSIGN   9560>>CALL
      9566>>ASSIGN   9566>>ASSIGN   9583>>ASSIGN   9584>>ASSIGN   9588>>ASSIGN   9589>>ASSIGN   9591>>ASSIGN
      9592>>ASSIGN   9594>>ASSIGN   9595>>ASSIGN   9596>>ASSIGN   9597>>ASSIGN   9599>>ASSIGN   9600>>ASSIGN
      9600>>ASSIGN   9609>>CALL     9626>>ASSIGN   9635>>ASSIGN   9636>>ASSIGN   9638>>ASSIGN   9643>>ASSIGN
      9648>>ASSIGN   9653>>ASSIGN   9656>>ASSIGN   9659>>ASSIGN   9662>>ASSIGN   9685>>ASSIGN   9685>>ASSIGN
      9694>>CALL     9701>>ASSIGN   9701>>ASSIGN   9710>>ASSIGN   9711>>ASSIGN   9711>>ASSIGN   9712>>CALL
      9721>>CALL     9743>>ASSIGN   9767>>ASSIGN   9771>>ASSIGN   9773>>ASSIGN   9775>>ASSIGN   9777>>ASSIGN
      9777>>ASSIGN   9778>>ASSIGN   9778>>ASSIGN   9787>>CALL     9799>>CALL     9801>>ASSIGN   9801>>ASSIGN
      9802>>ASSIGN   9809>>ASSIGN   9809>>ASSIGN   9819>>CALL     9825>>ASSIGN   9825>>ASSIGN  10374>>CALL
     10383>>CALL    10413>>ASSIGN  10414>>ASSIGN  10416>>ASSIGN  10416>>ASSIGN  10417>>ASSIGN  10425>>ASSIGN
     10425>>ASSIGN  10427>>CALL    10436>>CALL    10446>>ASSIGN  10449>>ASSIGN  10464>>ASSIGN  10465>>ASSIGN
     10469>>ASSIGN  10470>>ASSIGN  10478>>CALL    10480>>ASSIGN  10480>>ASSIGN  10481>>ASSIGN  10490>>ASSIGN
     10490>>ASSIGN  10500>>CALL    10524>>ASSIGN  10525>>ASSIGN  10545>>ASSIGN  10546>>ASSIGN  10555>>ASSIGN
     10557>>ASSIGN  10558>>CALL    10558>>CALL    10561>>ASSIGN  10561>>ASSIGN  10570>>CALL    10577>>IF
     10578>>ASSIGN  10578>>ASSIGN  10579>>ASSIGN  10579>>ASSIGN  10587>>ASSIGN  10587>>ASSIGN  10597>>CALL
     10621>>ASSIGN  10622>>ASSIGN  10640>>ASSIGN  10641>>CALL    10644>>ASSIGN  10644>>ASSIGN  10645>>ASSIGN
     10651>>ASSIGN  10651>>ASSIGN  10661>>CALL    10669>>ASSIGN  10669>>ASSIGN  10678>>CALL    10702>>ASSIGN
     10703>>ASSIGN  10710>>ASSIGN  10712>>CALL    10712>>CALL    10713>>IF      10714>>ASSIGN  10714>>ASSIGN
     10715>>ASSIGN  10715>>ASSIGN  10722>>ASSIGN  10722>>ASSIGN  10732>>CALL    10751>>ASSIGN  10752>>CALL
     10754>>ASSIGN  10754>>ASSIGN  10755>>ASSIGN  10761>>ASSIGN  10761>>ASSIGN  10771>>CALL    10791>>ASSIGN
     10794>>ASSIGN  10796>>ASSIGN  10805>>ASSIGN  10806>>ASSIGN  10808>>ASSIGN  10809>>ASSIGN  10813>>CALL
     10817>>ASSIGN  10817>>ASSIGN  10826>>CALL    10833>>ASSIGN  10833>>ASSIGN  10834>>ASSIGN  10848>>CALL
     10877>>ASSIGN  10878>>CALL    10880>>ASSIGN  10880>>ASSIGN  10881>>ASSIGN  10887>>ASSIGN  10887>>ASSIGN
     10897>>CALL    10916>>ASSIGN  10919>>ASSIGN  10922>>ASSIGN  10924>>ASSIGN  10926>>ASSIGN  10928>>ASSIGN
     10929>>CALL    10935>>ASSIGN  10935>>ASSIGN  10936>>ASSIGN  10944>>ASSIGN  10944>>ASSIGN  10954>>CALL
     10961>>ASSIGN  10961>>ASSIGN  10970>>CALL    11542>>ASSIGN  11548>>ASSIGN  11551>>ASSIGN  11551>>ASSIGN
     11552>>ASSIGN  11556>>ASSIGN  11556>>ASSIGN  11566>>CALL    11576>>ASSIGN  11579>>ASSIGN  11584>>ASSIGN
     11584>>ASSIGN  11593>>CALL    12156>>ASSIGN  12165>>ASSIGN  12170>>ASSIGN  12171>>ASSIGN  12171>>ASSIGN
     12180>>ASSIGN  12181>>IF      12188>>ASSIGN  12196>>ASSIGN  12196>>ASSIGN  12196>>ASSIGN  12199>>ASSIGN
     12199>>ASSIGN  12210>>ASSIGN  12210>>ASSIGN  12212>>ASSIGN  12212>>ASSIGN  12213>>ASSIGN  12220>>ASSIGN
     12220>>ASSIGN  12230>>CALL    12252>>ASSIGN  12253>>ASSIGN  12259>>ASSIGN  12260>>ASSIGN  12270>>ASSIGN
     12270>>ASSIGN  12280>>CALL    12291>>ASSIGN  12291>>ASSIGN  12301>>CALL    12332>>ASSIGN  12335>>ASSIGN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:293  
     12335>>ASSIGN  12344>>CALL    12356>>ASSIGN  12357>>ASSIGN  12357>>ASSIGN  12366>>CALL    12387>>ASSIGN
     12388>>ASSIGN  12388>>ASSIGN  12397>>CALL    12471>>ASSIGN  12646>>CALL    12647>>CALL    12648>>CALL
     12670>>ASSIGN  12672>>ASSIGN  12675>>ASSIGN  12702>>CALL
FPTS.IA_
      1215**DCL      9743>>ASSIGN  12471>>ASSIGN  12646<>CALL
FPTS.RVA_
      1217**DCL     12648<>CALL
FPTS.USEP_
      1218**DCL     12675<<ASSIGN
FPTS.UWA_
      1216**DCL     12647<>CALL
FPTS.V
      1219**DCL      6404--ASSIGN   6438--ASSIGN   9566--ASSIGN   9701--ASSIGN   9825--ASSIGN
FPTS.V.ARG
      1222**DCL      5794<<ASSIGN   7034>>ASSIGN   7044>>ASSIGN   7608>>CALLBLT  7611>>ASSIGN
FPTS.V.FPARAM
      1221**DCL      6435--ASSIGN
FPTS.V_
      1214**DCL      6438<<ASSIGN   6439>>ASSIGN   9701<<ASSIGN   9825<<ASSIGN
FPT_ERRMSG
      5330**DCL      6421<>CALL
FPT_ERRMSG.BUF_
      5330**DCL      6420<<ASSIGN   6439<<ASSIGN
FPT_ERRMSG.V
      5334**DCL      5330--DCLINIT
FPT_FDS IN PROCEDURE SDS$OPEN
      5494**DCL      5725<>CALL
FPT_FDS.V IN PROCEDURE SDS$OPEN
      5494**DCL      5494--DCLINIT
FPT_GDP
      5274**DCL      6433<>CALL
FPT_GDP.V
      5274**DCL      5274--DCLINIT
FPT_GETDCB IN PROCEDURE SDS$OPEN
      5509**DCL      5717<>CALL     5737<>CALL
FPT_GETDCB.DCBNAME_ IN PROCEDURE SDS$OPEN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:294  
      5509**DCL      5734<<ASSIGN
FPT_GETDCB.DCBNUM_ IN PROCEDURE SDS$OPEN
      5509**DCL      5735<<ASSIGN
FPT_GETDCB.V IN PROCEDURE SDS$OPEN
      5510**DCL      5509--DCLINIT
FPT_GETDCB.V.MERGE# IN PROCEDURE SDS$OPEN
      5510**DCL      5716<<ASSIGN   5736<<ASSIGN
FPT_GETDCB.V.TEST# IN PROCEDURE SDS$OPEN
      5511**DCL      5715<<ASSIGN
FPT_RELDCB IN PROCEDURE SDS$OPEN
      5524**DCL      5757<>CALL
FPT_RELDCB.V IN PROCEDURE SDS$OPEN
      5524**DCL      5524--DCLINIT
FPT_RELDCB.V.DCB# IN PROCEDURE SDS$OPEN
      5524**DCL      5756<<ASSIGN
FPT_SHORT
      3508**DCL      3512--DCLINIT
FPT_SHORT.VEC1
      3509**DCL     12447<<ASSIGN  12468<<ASSIGN  12470<<ASSIGN  12584<<ASSIGN
FPT_SHORT.VEC2
      3510**DCL     12447--ASSIGN  12448--ASSIGN  12471<<ASSIGN
FPT_YC
      5359**DCL      8218<>CALL
FPT_YC.CMD_
      5359**DCL      8217<<ASSIGN
FPT_YC.V
      5360**DCL      5359--DCLINIT
GET
     10996**ENTRY   12676--ASSIGN
GET_A_PAGE
      6431**PROC    12640--CALL
HIGH
      3521**DCL      5815<<ASSIGN   5817>>IF       5820>>ASSIGN   5829<<ASSIGN
I
      3477**DCL      3509--DCLINIT  5400<<ASSIGN   5402<<ASSIGN   5797>>IF       5797>>IF       5799>>ASSIGN
      5800>>ASSIGN   5805>>IF       5805>>IF       5811>>IF       5811>>IF       5813<<ASSIGN   5822>>IF
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:295  
      5827>>IF       7033<<DOINDEX  7034>>ASSIGN   7604<<DOINDEX  7605>>IF       7608>>CALLBLT  8203<<CALLBLT
      8205>>IF       8206>>ASSIGN   8207>>ASSIGN   8208<<ASSIGN   8210>>DOWHILE  8210>>DOWHILE  8211<<ASSIGN
      8211>>ASSIGN   8213<<CALLBLT  8213>>CALLBLT  8215>>IF       8215<<ASSIGN   8215>>ASSIGN   8216>>ASSIGN
      8805<<ASSIGN   8806>>IF       8822>>IF       8838>>IF       8854>>IF       8870>>IF       8886>>IF
      8904<<ASSIGN   8905>>IF       8908>>IF       8911>>IF       8918<<DOINDEX  8919>>IF       8920>>ASSIGN
      8920>>ASSIGN   8922>>ASSIGN   8924>>ASSIGN   9516<<DOINDEX  9517>>IF       9518>>ASSIGN   9518>>ASSIGN
      9520>>ASSIGN   9522>>ASSIGN  10548<<ASSIGN  10548<<ASSIGN  10549>>DOINDEX 10555>>ASSIGN  10557>>ASSIGN
     10559>>DOCASE  10704<<DOINDEX 10705>>IF      10710>>ASSIGN  10710>>ASSIGN  11543<<DOINDEX 11544>>IF
     11548>>ASSIGN  11548>>ASSIGN  12384>>IF      12384>>IF      12384>>IF      12387>>ASSIGN  12581<<ASSIGN
     12583<<ASSIGN  12584--ASSIGN  12662<<DOINDEX 12663>>ASSIGN  12663>>ASSIGN  12664>>IF      12665>>ASSIGN
     12668<<ASSIGN  12669>>IF      12670>>ASSIGN  12672>>ASSIGN
IA.SNAME
      3938**DCL      3939--REDEF
IA.SSDT
      3950**DCL      3951--REDEF
IA.SSNAME
      3941**DCL      3942--REDEF    5708>>ASSIGN   5730>>ASSIGN
IA.SSTDT
      3951**DCL      5769>>IF
IA$
      3952**DCL      3762--IMP-PTR  3917--IMP-PTR  3962--REDEF    5708>>ASSIGN   5730>>ASSIGN   5769>>IF
      5857>>ASSIGN   8942>>DOWHILE  8943>>ASSIGN  12311>>ASSIGN  12312>>IF      12314>>ASSIGN  12315>>ASSIGN
     12319>>IF      12321>>ASSIGN  12322>>ASSIGN  12634<<ASSIGN
IA_HALF
      3762**DCL      5857<<ASSIGN   8942>>DOWHILE  8943>>ASSIGN  12312>>IF      12314>>ASSIGN  12315<<ASSIGN
     12319>>IF      12321<<ASSIGN  12322>>ASSIGN
IDSSYSERR
      3472**DCL     12311<<ASSIGN
IDS_ADR
      3513**DCL      7036>>DOWHILE 12677<<ASSIGN  12679<<ASSIGN  12681<<ASSIGN  12683<<ASSIGN  12685<<ASSIGN
     12687<<ASSIGN  12689<<ASSIGN  12691<<ASSIGN
IDS_BIT9
      3514**DCL      7042>>ASSIGN
II
      3518**DCL      3519--REDEF    7040<<DOINDEX  7043>>ASSIGN   8241<<DOINDEX  8242>>ASSIGN   8242>>ASSIGN
      8243>>ASSIGN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:296  
IPT_ACC
      4622**DCL      9694<>CALL
IPT_ACC.DBK_
      4624**DCL      9626<<ASSIGN
IPT_ACC.V
      4624**DCL      9685--ASSIGN
IPT_ACC.V.CCW.SCI#
      4624**DCL      9636<<ASSIGN   9643<<ASSIGN   9648<<ASSIGN   9653<<ASSIGN   9656<<ASSIGN   9659<<ASSIGN
      9662<<ASSIGN
IPT_ACC.V.RVA_ITEM.OFFSET#
      4625**DCL      9635<<ASSIGN   9638<<ASSIGN
IPT_ACC.V_
      4622**DCL      9685<<ASSIGN
IPT_ACN
      4635**DCL      9609<>CALL
IPT_ACN.ANAME_
      4637**DCL      9584<<ASSIGN
IPT_ACN.DBK_
      4637**DCL      9583<<ASSIGN   9597<<ASSIGN
IPT_ACN.V
      4638**DCL      9600--ASSIGN
IPT_ACN.V.NCW.AREA_NME_SIZE#
      4638**DCL      9599<<ASSIGN
IPT_ACN.V.NCW.CI#
      4638**DCL      9588<<ASSIGN   9591<<ASSIGN   9595<<ASSIGN   9596<<ASSIGN
IPT_ACN.V.RVA_ITEM.OFFSET#
      4639**DCL      9589<<ASSIGN   9592<<ASSIGN   9594<<ASSIGN
IPT_ACN.V_
      4635**DCL      9600<<ASSIGN
IPT_CALC
      4649**DCL      9560<>CALL
IPT_CALC.DBK_
      4651**DCL      9550<<ASSIGN
IPT_CALC.V
      4651**DCL      9549--ASSIGN
IPT_CALC.V.UWA_OFFSET
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:297  
      4651**DCL      9551<<ASSIGN
IPT_CALC.V_
      4649**DCL      9549<<ASSIGN   9566<<ASSIGN
IPT_CHK
      4661**DCL      9752<>CALL
IPT_CHK.CHKPT_NUMBER_
      4661**DCL      9734<<ASSIGN
IPT_CHK.ERROR_
      4661**DCL      9740<<ASSIGN   9742<<ASSIGN
IPT_CHK.IA_
      4661**DCL      9743<<ASSIGN
IPT_CON
      4671**DCL     12280<>CALL
IPT_CON.V
      4673**DCL     12270--ASSIGN
IPT_CON.V.RC.RC_OFFSET#
      4673**DCL     12252<<ASSIGN  12259<<ASSIGN
IPT_CON.V.SC.SC_OFFSET#
      4674**DCL     12253<<ASSIGN  12260<<ASSIGN
IPT_CON.V_
      4671**DCL     12270<<ASSIGN
IPT_CRPT
      4684**DCL     12457<>CALL
IPT_DIS
      4693**DCL     12301<>CALL
IPT_DIS.V
      4695**DCL     12291--ASSIGN
IPT_DIS.V_
      4693**DCL     12291<<ASSIGN
IPT_ERS
      4706**DCL      9787<>CALL
IPT_ERS.V
      4708**DCL      9777--ASSIGN
IPT_ERS.V.ECW.EC_BIT#
      4709**DCL      9773<<ASSIGN   9775<<ASSIGN
IPT_ERS.V.RC.RC_OFFSET#
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:298  
      4708**DCL      9767<<ASSIGN   9771<<ASSIGN
IPT_ERS.V_
      4706**DCL      9777<<ASSIGN
IPT_ETC
      4718**DCL      8955<>CALL
IPT_ETC.V
      4720**DCL      8946--ASSIGN
IPT_ETC.V_
      4718**DCL      8946<<ASSIGN
IPT_FAA
      4731**DCL     10954<>CALL
IPT_FAA.V
      4733**DCL     10935--ASSIGN  10944--ASSIGN
IPT_FAA.V.AC
      4734**DCL     10936--ASSIGN
IPT_FAA.V.AC.AC_OFFSET#
      4734**DCL     10916<<ASSIGN
IPT_FAA.V.RC
      4733**DCL     10936--ASSIGN
IPT_FAA.V.RECORD_NUMBER#
      4733**DCL     10936--ASSIGN
IPT_FAA.V.RETENTION_LIST
      4738**DCL     10936--ASSIGN
IPT_FAA.V.RLCW
      4735**DCL     10936--ASSIGN
IPT_FAA.V_
      4731**DCL     10935<<ASSIGN  10936<<ASSIGN  10944<<ASSIGN
IPT_FAS
      4748**DCL     10970<>CALL
IPT_FAS.V
      4750**DCL     10961--ASSIGN
IPT_FAS.V.RC.RC_OFFSET#
      4750**DCL     10926<<ASSIGN  10928<<ASSIGN
IPT_FAS.V.RECORD_NUMBER#
      4750**DCL     10919<<ASSIGN  10922<<ASSIGN  10924<<ASSIGN
IPT_FAS.V.RLCW
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:299  
      4752**DCL     10929<>CALL
IPT_FAS.V_
      4748**DCL     10961<<ASSIGN
IPT_FCD
      4765**DCL     10678<>CALL
IPT_FCD.V
      4767**DCL     10669--ASSIGN
IPT_FCD.V_
      4765**DCL     10669<<ASSIGN
IPT_FCR
      4780**DCL     10383<>CALL
IPT_FCR.V
      4782**DCL      9778--ASSIGN
IPT_FCR.V.RLCW
      4782**DCL     10374<>CALL
IPT_FCR.V_
      4780**DCL      9778<<ASSIGN
IPT_FCT
      4794**DCL     10771<>CALL
IPT_FCT.V
      4796**DCL     10754--ASSIGN  10761--ASSIGN
IPT_FCT.V.RC
      4796**DCL     10755--ASSIGN
IPT_FCT.V.RC.RC_OFFSET#
      4796**DCL     10751<<ASSIGN
IPT_FCT.V.RETENTION_LIST
      4799**DCL     10755--ASSIGN
IPT_FCT.V.RLCW
      4797**DCL     10752<>CALL    10755--ASSIGN
IPT_FCT.V_
      4794**DCL     10754<<ASSIGN  10755<<ASSIGN  10761<<ASSIGN
IPT_FDC
      4809**DCL     10661<>CALL
IPT_FDC.V
      4811**DCL     10644--ASSIGN  10651--ASSIGN
IPT_FDC.V.RC
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:300  
      4811**DCL     10645--ASSIGN
IPT_FDC.V.RC.RC_OFFSET#
      4811**DCL     10640<<ASSIGN
IPT_FDC.V.RETENTION_LIST
      4814**DCL     10645--ASSIGN
IPT_FDC.V.RLCW
      4812**DCL     10641<>CALL    10645--ASSIGN
IPT_FDC.V_
      4809**DCL     10644<<ASSIGN  10645<<ASSIGN  10651<<ASSIGN
IPT_FDP
      4824**DCL     10732<>CALL
IPT_FDP.V
      4826**DCL     10714--ASSIGN  10722--ASSIGN
IPT_FDP.V.FLCW
      4827**DCL     10715--ASSIGN
IPT_FDP.V.FLCW.N_FIELDS#
      4827**DCL     10703<<ASSIGN  10712<>CALL    10713>>IF      10715>>ASSIGN
IPT_FDP.V.FL_RL_LIST
      4830**DCL     10715--ASSIGN
IPT_FDP.V.FL_RL_LIST.RVA_OFFSET#
      4830**DCL     10710<<ASSIGN
IPT_FDP.V.RLCW
      4828**DCL     10712<>CALL    10715--ASSIGN
IPT_FDP.V.SC
      4826**DCL     10715--ASSIGN
IPT_FDP.V.SC.SC_OFFSET#
      4826**DCL     10702<<ASSIGN
IPT_FDP.V_
      4824**DCL     10714<<ASSIGN  10715<<ASSIGN  10722<<ASSIGN
IPT_FDR
      4840**DCL      9819<>CALL
IPT_FDR.DBK_
      4842**DCL     10525<<ASSIGN  10622<<ASSIGN
IPT_FDR.V
      4842**DCL      9801--ASSIGN   9809--ASSIGN
IPT_FDR.V.RC
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:301  
      4842**DCL      9802--ASSIGN
IPT_FDR.V.RC.RC_OFFSET#
      4842**DCL     10524<<ASSIGN  10621<<ASSIGN
IPT_FDR.V.RETENTION_LIST
      4846**DCL      9802--ASSIGN
IPT_FDR.V.RLCW
      4843**DCL      9799<>CALL     9802--ASSIGN
IPT_FDR.V_
      4840**DCL      9801<<ASSIGN   9802<<ASSIGN   9809<<ASSIGN
IPT_FIN
      4856**DCL      9533<>CALL
IPT_FIN.V
      4858**DCL      9521--ASSIGN
IPT_FIN.V.AC_OFFSETS
      4859**DCL      9522--ASSIGN
IPT_FIN.V.AC_OFFSETS.RVA_OFFSET#
      4859**DCL      9518<<ASSIGN
IPT_FIN.V.ALCW
      4858**DCL      9522--ASSIGN
IPT_FIN.V.ALCW.N_AREAS#
      4858**DCL      9520<<ASSIGN
IPT_FIN.V_
      4856**DCL      9521<<ASSIGN   9522<<ASSIGN
IPT_FKC
      4869**DCL     10597<>CALL
IPT_FKC.V
      4871**DCL     10578--ASSIGN  10587--ASSIGN
IPT_FKC.V.FLCW
      4873**DCL     10579--ASSIGN
IPT_FKC.V.FLCW.N_FIELDS#
      4873**DCL     10557<<ASSIGN  10558<>CALL    10577>>IF      10579>>ASSIGN
IPT_FKC.V.FL_RL_LIST
      4876**DCL     10579--ASSIGN
IPT_FKC.V.FL_RL_LIST.RVA_OFFSET#
      4876**DCL     10555<<ASSIGN
IPT_FKC.V.RC
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:302  
      4871**DCL     10579--ASSIGN
IPT_FKC.V.RC.RC_OFFSET#
      4871**DCL     10545<<ASSIGN
IPT_FKC.V.RLCW
      4873**DCL     10558<>CALL    10579--ASSIGN
IPT_FKC.V.SC
      4872**DCL     10579--ASSIGN
IPT_FKC.V.SC.SC_OFFSET#
      4872**DCL     10546<<ASSIGN
IPT_FKC.V_
      4869**DCL     10578<<ASSIGN  10579<<ASSIGN  10587<<ASSIGN
IPT_FKY
      4886**DCL     10570<>CALL
IPT_FKY.V
      4888**DCL     10561--ASSIGN
IPT_FKY.V_
      4886**DCL     10561<<ASSIGN
IPT_FOR
      4903**DCL     10897<>CALL
IPT_FOR.V
      4905**DCL     10880--ASSIGN  10887--ASSIGN
IPT_FOR.V.RETENTION_LIST
      4908**DCL     10881--ASSIGN
IPT_FOR.V.RLCW
      4906**DCL     10878<>CALL    10881--ASSIGN
IPT_FOR.V.SC
      4905**DCL     10881--ASSIGN
IPT_FOR.V.SC.SC_OFFSET#
      4905**DCL     10877<<ASSIGN
IPT_FOR.V_
      4903**DCL     10880<<ASSIGN  10881<<ASSIGN  10887<<ASSIGN
IPT_FRA
      4918**DCL     10826<>CALL
IPT_FRA.V
      4920**DCL     10817--ASSIGN
IPT_FRA.V_
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:303  
      4918**DCL     10817<<ASSIGN
IPT_FRI
      4935**DCL     10500<>CALL
IPT_FRI.V
      4937**DCL     10480--ASSIGN  10490--ASSIGN
IPT_FRI.V.FCW
      4937**DCL     10481--ASSIGN
IPT_FRI.V.FCW.RECORD_LOCATION#
      4937**DCL     10446<<ASSIGN  10449<<ASSIGN
IPT_FRI.V.RC
      4938**DCL     10481--ASSIGN
IPT_FRI.V.RC.RC_OFFSET#
      4938**DCL     10464<<ASSIGN  10469<<ASSIGN
IPT_FRI.V.RETENTION_LIST
      4942**DCL     10481--ASSIGN
IPT_FRI.V.RLCW
      4939**DCL     10478<>CALL    10481--ASSIGN
IPT_FRI.V.SC
      4939**DCL     10481--ASSIGN
IPT_FRI.V.SC.SC_OFFSET#
      4939**DCL     10465<<ASSIGN  10470<<ASSIGN
IPT_FRI.V_
      4935**DCL     10480<<ASSIGN  10481<<ASSIGN  10490<<ASSIGN
IPT_FRS
      4952**DCL     10848<>CALL
IPT_FRS.V
      4954**DCL     10833--ASSIGN
IPT_FRS.V.FCW
      4954**DCL     10834--ASSIGN
IPT_FRS.V.FCW.RECORD_LOCATION#
      4954**DCL     10791<<ASSIGN  10794<<ASSIGN  10796<<ASSIGN
IPT_FRS.V.RC
      4955**DCL     10834--ASSIGN
IPT_FRS.V.RC.RC_OFFSET#
      4955**DCL     10805<<ASSIGN  10808<<ASSIGN
IPT_FRS.V.RETENTION_LIST
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:304  
      4959**DCL     10834--ASSIGN
IPT_FRS.V.RLCW
      4956**DCL     10813<>CALL    10834--ASSIGN
IPT_FRS.V.SC
      4956**DCL     10834--ASSIGN
IPT_FRS.V.SC.SC_OFFSET#
      4956**DCL     10806<<ASSIGN  10809<<ASSIGN
IPT_FRS.V_
      4952**DCL     10833<<ASSIGN  10834<<ASSIGN
IPT_FUI
      4969**DCL     10436<>CALL
IPT_FUI.V
      4971**DCL     10416--ASSIGN  10425--ASSIGN
IPT_FUI.V.RC
      4971**DCL     10417--ASSIGN
IPT_FUI.V.RC.RC_OFFSET#
      4971**DCL     10413<<ASSIGN
IPT_FUI.V.RETENTION_LIST
      4975**DCL     10417--ASSIGN
IPT_FUI.V.RLCW
      4973**DCL     10417--ASSIGN  10427<>CALL
IPT_FUI.V.SC
      4972**DCL     10417--ASSIGN
IPT_FUI.V.SC.SC_OFFSET#
      4972**DCL     10414<<ASSIGN
IPT_FUI.V_
      4969**DCL     10416<<ASSIGN  10417<<ASSIGN  10425<<ASSIGN
IPT_GET
      4985**DCL     11593<>CALL
IPT_GET.V
      4987**DCL     11584--ASSIGN
IPT_GET.V.RC.RC_OFFSET#
      4987**DCL     11576<<ASSIGN  11579<<ASSIGN
IPT_GET.V_
      4985**DCL     11584<<ASSIGN
IPT_GTF
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:305  
      4997**DCL     11566<>CALL
IPT_GTF.V
      4999**DCL     11551--ASSIGN  11556--ASSIGN
IPT_GTF.V.FIELD_LIST
      5000**DCL     11552--ASSIGN
IPT_GTF.V.FIELD_LIST.RVA_OFFSET#
      5000**DCL     11548<<ASSIGN
IPT_GTF.V.FLCW
      4999**DCL     11552--ASSIGN
IPT_GTF.V.FLCW.N_FIELDS#
      4999**DCL     11542<<ASSIGN
IPT_GTF.V_
      4997**DCL     11551<<ASSIGN  11552<<ASSIGN  11556<<ASSIGN
IPT_HIA
      5010**DCL     12702<>CALL
IPT_IFM
      5021**DCL     12397<>CALL
IPT_IFM.V
      5023**DCL     12388--ASSIGN
IPT_IFM.V.SC.SC_OFFSET#
      5023**DCL     12387<<ASSIGN
IPT_IFM.V_
      5021**DCL     12388<<ASSIGN
IPT_IFT
      5033**DCL     12344<>CALL
IPT_IFT.V
      5035**DCL     12335--ASSIGN
IPT_IFT.V_
      5033**DCL     12335<<ASSIGN
IPT_IST
      5059**DCL     12366<>CALL
IPT_IST.V
      5061**DCL     12357--ASSIGN
IPT_IST.V.SC.SC_OFFSET#
      5062**DCL     12356<<ASSIGN
IPT_IST.V.TDW
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:306  
      5061**DCL     12332<<ASSIGN
IPT_IST.V_
      5059**DCL     12357<<ASSIGN
IPT_KEEP
      5098**DCL     12498<>CALL
IPT_KEEP.ERROR_
      5098**DCL     12489<<ASSIGN
IPT_MOD
      5072**DCL     12230<>CALL
IPT_MOD.V
      5074**DCL     12210--ASSIGN  12212--ASSIGN  12220<<ASSIGN  12220--ASSIGN
IPT_MOD.V.FLCW
      5076**DCL     12213--ASSIGN
IPT_MOD.V.FLCW.N_FIELDS#
      5076**DCL     12171<<ASSIGN  12171>>ASSIGN  12181>>IF      12196>>ASSIGN
IPT_MOD.V.FL_SL_LIST
      5077**DCL     12213--ASSIGN
IPT_MOD.V.FL_SL_LIST.RVA_OFFSET#
      5078**DCL     12170<<ASSIGN  12196<<ASSIGN
IPT_MOD.V.MCW
      5075**DCL     12213--ASSIGN
IPT_MOD.V.MCW.MC_BIT0#
      5075**DCL     12180<<ASSIGN
IPT_MOD.V.MCW.MC_BIT1#
      5075**DCL     12188<<ASSIGN
IPT_MOD.V.RC
      5074**DCL     12213--ASSIGN
IPT_MOD.V.RC.RC_OFFSET#
      5074**DCL     12156<<ASSIGN  12165<<ASSIGN
IPT_MOD.V.SLCW
      5077**DCL     12213--ASSIGN
IPT_MOD.V.SLCW.N_SETS#
      5077**DCL     12196>>ASSIGN  12199<<ASSIGN  12199>>ASSIGN
IPT_MOD.V_
      5072**DCL     12210<<ASSIGN  12212<<ASSIGN  12213<<ASSIGN
IPT_NBF
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:307  
      5088**DCL     12438<>CALL
IPT_NBF.BUFFS_ALLOC_
      5088**DCL     12429<<ASSIGN
IPT_NBF.BUFFS_REQ_
      5088**DCL     12428<<ASSIGN
IPT_RDY
      5116**DCL      8935<>CALL
IPT_RDY.V
      5118**DCL      8923--ASSIGN
IPT_RDY.V.AC_OFFSETS
      5119**DCL      8924--ASSIGN
IPT_RDY.V.AC_OFFSETS.RVA_OFFSET#
      5120**DCL      8920<<ASSIGN
IPT_RDY.V.RDCW
      5118**DCL      8924--ASSIGN
IPT_RDY.V.RDCW.AREAS_TO_READY#
      5119**DCL      8922<<ASSIGN
IPT_RDY.V.RDCW.READY_OPTION#
      5118**DCL      8906<<ASSIGN   8909<<ASSIGN   8912<<ASSIGN
IPT_RDY.V_
      5116**DCL      8923<<ASSIGN   8924<<ASSIGN
IPT_REDUCEQ
      5107**DCL     12516<>CALL
IPT_ROL
      5130**DCL     12480<>CALL
IPT_STO
      5139**DCL      9721<>CALL
IPT_STO.V
      5141**DCL      9711--ASSIGN
IPT_STO.V.RC.RC_OFFSET#
      5141**DCL      9710<<ASSIGN
IPT_STO.V.RLCW
      5142**DCL      9712<>CALL
IPT_STO.V_
      5139**DCL      9711<<ASSIGN
IPT_TROFF
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:308  
      5163**DCL     12598<>CALL
IPT_TRON
      5154**DCL     12617<>CALL
IX
      3462**DCL      3461--IMP-SIZ 12658<<ASSIGN  12659>>ASSIGN  12659>>ASSIGN
J
      3479**DCL      3480--REDEF    5763<<ASSIGN   5765>>DOWHILE  5766<<ASSIGN   5766>>ASSIGN   5768>>ASSIGN
      5821<<ASSIGN   7035<<ASSIGN   7036>>DOWHILE  7036>>DOWHILE  7037<<ASSIGN   7037>>ASSIGN   7039>>IF
      7042>>ASSIGN   7606<<ASSIGN   7608<<CALLBLT  7610>>ASSIGN   8209<<DOINDEX  8804<<ASSIGN   8902<<ASSIGN
      8904>>ASSIGN   8918>>DOINDEX 10549<<DOINDEX 10554>>IF      10555>>ASSIGN  10555>>ASSIGN
JJ
      3520**DCL      3521--REDEF    7022<<ASSIGN   7023>>DOWHILE  7024<<ASSIGN   7024>>ASSIGN   7026>>IF
      7033>>DOINDEX  7040>>DOINDEX  7044>>ASSIGN
K
      3478**DCL      3474--IMP-SIZ  5820<<ASSIGN   5821>>ASSIGN   5824>>ASSIGN   5829>>ASSIGN   5832>>IF
      5834<<ASSIGN   5834>>ASSIGN   5835>>IF       5837>>ASSIGN   5838>>ASSIGN   7012<<ASSIGN   7015<<ASSIGN
      7018<<ASSIGN   7023>>DOWHILE  7026>>IF       7041>>ASSIGN   8176<<ASSIGN   8177>>DOWHILE  8178>>IF
      8180>>ASSIGN   8184>>IF       8187>>IF       8190>>IF       8194<<ASSIGN   8194>>ASSIGN   8202<<ASSIGN
      8203>>CALLBLT  8205>>IF       8206<<ASSIGN   8206>>ASSIGN   8210>>DOWHILE  8210>>DOWHILE  8213>>CALLBLT
      8215>>IF       8216<<ASSIGN   8217>>ASSIGN  12159<<ASSIGN  12163<<ASSIGN  12169>>DOWHILE 12169>>DOWHILE
     12170>>ASSIGN  12170>>ASSIGN  12172<<ASSIGN  12172>>ASSIGN  12176>>IF      12176>>IF      12176>>IF
     12178>>IF      12186<<ASSIGN  12186>>ASSIGN  12187>>IF      12191>>DOWHILE 12192>>IF      12196>>ASSIGN
     12200<<ASSIGN  12200>>ASSIGN  12206>>IF
KK
      3522**DCL      7032<<ASSIGN   7041>>ASSIGN   7042>>ASSIGN   7043>>ASSIGN   7044>>ASSIGN   7045<<ASSIGN
      7045>>ASSIGN   7048>>ASSIGN  12160<<ASSIGN  12164<<ASSIGN  12173<<ASSIGN  12173>>ASSIGN  12201<<ASSIGN
     12201>>ASSIGN  12211>>IF      12213>>ASSIGN
LOW
      3519**DCL      5814<<ASSIGN   5817>>IF       5820>>ASSIGN   5820>>ASSIGN   5824<<ASSIGN
M$ERR
      5201**DCL-ENT  6422--CALL
M$ERRMSG
      5252**DCL-ENT  6421--CALL
M$FDS
      5224**DCL-ENT  5725--CALL
M$GDP
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:309  
      5225**DCL-ENT  6433--CALL
M$GETDCB
      5195**DCL-ENT  5717--CALL     5737--CALL
M$MERC
      5245**DCL-ENT  5780--CALL
M$OPEN
      5189**DCL-ENT  5759--CALL
M$RELDCB
      5195**DCL-ENT  5757--CALL
M$XXX
      5201**DCL-ENT  5773--CALL
M$YC
      5203**DCL-ENT  8218--CALL
MODIFY
     11602**ENTRY   12678--ASSIGN
NINE_WORDS
      3505**DCL      3506--IMP-SIZ  6404>>ASSIGN
NO_ARGS
      3507**DCL      5794>>ASSIGN   5799>>ASSIGN   5800>>ASSIGN   5806>>ASSIGN   5810>>ASSIGN   5837>>ASSIGN
      5838>>ASSIGN   5842<<ASSIGN   5842>>ASSIGN   5862<<ASSIGN   7022>>ASSIGN   7026>>IF       7028>>ASSIGN
      7029<<ASSIGN   7029>>ASSIGN   7040>>DOINDEX  7604>>DOINDEX  8177>>DOWHILE  8805>>ASSIGN   8904>>ASSIGN
      8918>>DOINDEX  9516>>DOINDEX  9545>>IF       9581>>IF       9595>>IF       9627>>DOCASE   9709>>IF
      9732>>IF       9732>>IF       9768>>IF      10372>>IF      10394>>IF      10395>>IF      10467>>IF
     10547>>IF      10549>>DOINDEX 10557>>ASSIGN  10635>>IF      10697>>IF      10703>>ASSIGN  10704>>DOINDEX
     10741>>IF      10797>>DOCASE  10814>>DOCASE  10873>>IF      10916>>ASSIGN  10925>>IF      10930>>IF
     10931>>DOCASE  11540>>IF      11542>>ASSIGN  11543>>DOINDEX 11550>>IF      11552>>ASSIGN  11575>>IF
     12157>>IF      12169>>DOWHILE 12176>>IF      12191>>DOWHILE 12206>>IF      12244>>DOCASE  12333>>DOCASE
NULL_OFFSET
      3767**DCL      9594>>ASSIGN   9635>>ASSIGN   9767>>ASSIGN  10469>>ASSIGN  10621>>ASSIGN  10808>>ASSIGN
     10928>>ASSIGN  11576>>ASSIGN  12156>>ASSIGN  12259>>ASSIGN  12656<<ASSIGN  12665<<ASSIGN
OFFSET IN PROCEDURE CHK_RETAIN
      8233**DCL      8226--PROC     8241>>DOINDEX  8241>>DOINDEX  8242>>ASSIGN
OPEN_SDS IN PROCEDURE SDS$OPEN
      5593**DCL      5759<>CALL
OPEN_SDS.ACCT_ IN PROCEDURE SDS$OPEN
      5597**DCL      5742<<ASSIGN   5747<<ASSIGN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:310  
OPEN_SDS.ACSVEH_ IN PROCEDURE SDS$OPEN
      5595**DCL      5596--REDEF
OPEN_SDS.ALTKEYS_ IN PROCEDURE SDS$OPEN
      5601**DCL      5602--REDEF    5602--REDEF
OPEN_SDS.HDR_ IN PROCEDURE SDS$OPEN
      5600**DCL      5601--REDEF
OPEN_SDS.NAME_ IN PROCEDURE SDS$OPEN
      5594**DCL      5754<<ASSIGN
OPEN_SDS.TAB_ IN PROCEDURE SDS$OPEN
      5599**DCL      5600--REDEF
OPEN_SDS.UHL_ IN PROCEDURE SDS$OPEN
      5593**DCL      5594--REDEF    5594--REDEF
OPEN_SDS.V IN PROCEDURE SDS$OPEN
      5602**DCL      5593--DCLINIT
OPEN_SDS.V.DCB# IN PROCEDURE SDS$OPEN
      5602**DCL      5722<<ASSIGN
OPEN_SDS.V.FSN# IN PROCEDURE SDS$OPEN
      5633**DCL      5633--REDEF    5633--REDEF
OPEN_SDS.WSN_ IN PROCEDURE SDS$OPEN
      5599**DCL      5599--REDEF
OUT_OF_MEMORY IN PROCEDURE GET_A_PAGE
      6446**LABEL    6433--CALLALT
PAGE_VECTOR
      5172**DCL      5274--DCLINIT
PAGE_VECTOR.ADR
      5174**DCL      5859>>IF       6434>>ASSIGN  12639>>IF
PT$
      3496**DCL      3474--IMP-PTR  3497--REDEF    3498--REDEF    7034<<ASSIGN   8201<<ASSIGN   8203>>CALLBLT
      8207<<ASSIGN   8207>>ASSIGN   8210>>DOWHILE  8213>>CALLBLT  8215>>IF       8217>>ASSIGN  12655<<ASSIGN
     12656>>ASSIGN  12657<<ASSIGN  12657>>ASSIGN  12659>>ASSIGN
P_OFF_W
      5389**PROC     5796--CALL     5804--CALL     5809--CALL    12383--CALL
REDEF_E$.ADR
      3503**DCL     12677>>ASSIGN  12679>>ASSIGN  12681>>ASSIGN  12683>>ASSIGN  12685>>ASSIGN  12687>>ASSIGN
     12689>>ASSIGN  12691>>ASSIGN
REDEF_J.NAME
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:311  
      3483**DCL      5822>>IF       5827>>IF
REDEF_PT.ADR
      3499**DCL      7036>>DOWHILE  8943<<ASSIGN  12314<<ASSIGN
REDEF_PT.SEG#
      3500**DCL      8944<<ASSIGN  12316<<ASSIGN
RETAIN_SWITCH
      3517**DCL      8196<<ASSIGN   8235>>IF       8239<<ASSIGN   8962<<ASSIGN
RLCW IN PROCEDURE CHK_RETAIN
      8228**DCL      8226--PROC
RLCW.FLAGS IN PROCEDURE CHK_RETAIN
      8229**DCL      8236<<ASSIGN   8240<<ASSIGN
RLCW.LISTS.MBZ IN PROCEDURE CHK_RETAIN
      8232**DCL      8243<<ASSIGN
RLCW.LISTS.RVA_OFFSET# IN PROCEDURE CHK_RETAIN
      8231**DCL      8242<<ASSIGN
RLCW$
      3971**DCL      1224--IMP-PTR  6436<<ASSIGN   6437>>ASSIGN   8172>>ASSIGN   8180>>ASSIGN   8180>>ASSIGN
      8181>>ASSIGN   8181>>ASSIGN   8185>>ASSIGN   8188>>ASSIGN   8191>>ASSIGN   8240>>ASSIGN   8241>>DOINDEX
      8242>>ASSIGN   9800>>IF       9802>>ASSIGN  10415>>IF      10417>>ASSIGN  10479>>IF      10481>>ASSIGN
     10577>>IF      10579>>ASSIGN  10643>>IF      10645>>ASSIGN  10713>>IF      10715>>ASSIGN  10753>>IF
     10755>>ASSIGN  10834>>ASSIGN  10879>>IF      10881>>ASSIGN  10934>>IF      10936>>ASSIGN
RLCW_SAVE
      1224**DCL      8172--ASSIGN   8240--ASSIGN
RLCW_SAVE.AC_INDICATORS
      1226**DCL      8185<<ASSIGN
RLCW_SAVE.N_SETS#
      1230**DCL      8180>>ASSIGN   8181<<ASSIGN   8181>>ASSIGN   8241>>DOINDEX  9800>>IF       9802>>ASSIGN
     10415>>IF      10417>>ASSIGN  10479>>IF      10481>>ASSIGN  10577>>IF      10579>>ASSIGN  10643>>IF
     10645>>ASSIGN  10713>>IF      10715>>ASSIGN  10753>>IF      10755>>ASSIGN  10834>>ASSIGN  10879>>IF
     10881>>ASSIGN  10934>>IF      10936>>ASSIGN
RLCW_SAVE.RC_INDICATORS
      1228**DCL      8191<<ASSIGN
RLCW_SAVE.RETAIN_LIST
      1231**DCL      8180<<ASSIGN   8242>>ASSIGN
RLCW_SAVE.SC_INDICATORS
      1227**DCL      8188<<ASSIGN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:312  
RVA
      3760**DCL      5821>>ASSIGN
RVA$
      3966**DCL      3760--IMP-PTR  3761--IMP-PTR  5796<>CALL     5821>>ASSIGN   7043>>ASSIGN   9551>>ASSIGN
     12383<>CALL    12636<<ASSIGN  12637>>IF      12641>>IF      12642>>ASSIGN  12644>>ASSIGN  12649>>IF
     12649>>IF      12652>>IF      12655>>ASSIGN  12663>>ASSIGN  12664>>IF
RVA_HALF
      3761**DCL      7043>>ASSIGN   9551>>ASSIGN  12641>>IF      12642>>ASSIGN  12644>>ASSIGN  12649>>IF
     12663>>ASSIGN  12664>>IF
RVA_SIZE
      3766**DCL      5797>>IF       5815>>ASSIGN  12384>>IF      12642<<ASSIGN  12644<<ASSIGN  12648<>CALL
     12655>>ASSIGN  12658>>ASSIGN  12662>>DOINDEX 12668>>ASSIGN
RVA_TYPE
      3460**DCL      5800>>ASSIGN   5832>>IF       5835>>IF       5838>>ASSIGN  12384>>IF      12663<<ASSIGN
RVA_TYPEC
      3461**DCL     12659<<ASSIGN  12659>>ASSIGN
SBIN36
      3484**DCL      8172<<ASSIGN   8221>>ASSIGN   8240>>ASSIGN  12311>>ASSIGN  12448<<ASSIGN  12656>>ASSIGN
SDS$OPEN
      5418**PROC    12638--CALL
SDSDCB
      3523**DCL      5510--DCLINIT  5720--IF       5722>>ASSIGN   5727--IF
SDSFLAG
      3525**DCL     12649>>IF      12651<<ASSIGN
SDS_NAME IN PROCEDURE SDS$OPEN
      5662**DCL      5509--DCLINIT
SDS_NAME.L# IN PROCEDURE SDS$OPEN
      5662**DCL      5707<<ASSIGN   5709>>DOWHILE  5710<<ASSIGN   5710>>ASSIGN   5712>>CALLBLT  5713<<ASSIGN
      5713>>ASSIGN   5729>>ASSIGN
SDS_NAME.NAME# IN PROCEDURE SDS$OPEN
      5662**DCL      5708<<ASSIGN   5709>>DOWHILE  5712<<CALLBLT
SET_ARGS
      5855**PROC     7010--CALL     8173--CALL     8800--CALL     9513--CALL     9571--CALL     9708--CALL
      9731--CALL     9766--CALL    10371--CALL    11539--CALL    12155--CALL    12242--CALL    12331--CALL
SET_ARGS1 IN PROCEDURE SET_ARGS
      5858**ENTRY    7603--CALL     9544--CALL
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:313  
SNA
      1166**DCL      5804--CALL
SNA.ALL
      1167**DCL      7605>>IF       9772>>IF       9775--IF      12187>>IF
SNA.ANY
      1168**DCL     10642>>IF
SNA.AREA
      1183**DCL      8184>>IF
SNA.AREANAME
      1184**DCL      9581>>IF
SNA.CURRENCY
      1169**DCL      9630>>IF       9642>>IF       9647>>IF       9652>>IF
SNA.CURRENT
      1170**DCL     10372>>IF      10547>>IF      10741>>IF      10793>>IF
SNA.DBKEY
      1171**DCL     10513>>IF
SNA.FIRST
      1173**DCL     10445>>IF
SNA.INCLUDING
      1174**DCL     12176>>IF
SNA.ITEM
      1175**DCL      7017>>IF
SNA.LOAD
      1177**DCL      8911>>IF
SNA.NEXT
      1178**DCL      9655>>IF      10448>>IF
SNA.NOSHALL
      1179**DCL      8806>>IF
SNA.ONLY
      1180**DCL     12176>>IF      12178>>IF
SNA.OWNER
      1181**DCL      9661>>IF
SNA.PRIOR
      1182**DCL      9658>>IF      10790>>IF
SNA.RECORD
      1185**DCL      7014>>IF       8190>>IF
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:314  
SNA.RETRIEVAL
      1186**DCL      8908>>IF
SNA.SET
      1187**DCL      7011>>IF
SNA.SETS
      1188**DCL      8187>>IF
SNA.SHAREALL
      1189**DCL      8822>>IF
SNA.SHAREANY
      1190**DCL      8854>>IF
SNA.SHAREIN
      1191**DCL      8838>>IF
SNA.SHCUR
      1195**DCL      8870>>IF
SNA.SHINCUR
      1196**DCL      8886>>IF
SNA.UPDATE
      1192**DCL      8905>>IF
SNA.USING
      1193**DCL     10395>>IF      10455>>IF
SNA.WITHIN
      1194**DCL     10528>>IF
STORE
      9704**ENTRY   12680--ASSIGN
SUBDCB
      3524**DCL      5735--ASSIGN   5738--IF       5741--ASSIGN   5742--ASSIGN   5756>>ASSIGN
TRACE_COMMON
     12578**PROC    12589--CALL    12608--CALL
TYPE$
      3972**DCL      3460--IMP-PTR  3461--IMP-PTR  5800>>ASSIGN   5832>>IF       5835>>IF       5838>>ASSIGN
      6437<<ASSIGN  12384>>IF      12659>>ASSIGN  12663>>ASSIGN
U$ACC
      4607**DCL-ENT  9694--CALL
U$ACN
      4607**DCL-ENT  9609--CALL
U$CALC
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:315  
      4613**DCL-ENT  9560--CALL
U$CHK
      4610**DCL-ENT  9752--CALL
U$CON
      4607**DCL-ENT 12280--CALL
U$CRPT
      4612**DCL-ENT 12457--CALL
U$DIS
      4607**DCL-ENT 12301--CALL
U$ERS
      4606**DCL-ENT  9787--CALL
U$ETC
      4613**DCL-ENT  8955--CALL
U$FAA
      4609**DCL-ENT 10954--CALL
U$FAS
      4609**DCL-ENT 10970--CALL
U$FCD
      4608**DCL-ENT 10678--CALL
U$FCR
      4609**DCL-ENT 10383--CALL
U$FCT
      4608**DCL-ENT 10771--CALL
U$FDC
      4608**DCL-ENT 10661--CALL
U$FDP
      4608**DCL-ENT 10732--CALL
U$FDR
      4609**DCL-ENT  9819--CALL
U$FIN
      4606**DCL-ENT  9533--CALL
U$FKC
      4608**DCL-ENT 10597--CALL
U$FKY
      4608**DCL-ENT 10570--CALL
U$FOR
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:316  
      4608**DCL-ENT 10897--CALL
U$FRA
      4609**DCL-ENT 10826--CALL
U$FRI
      4610**DCL-ENT 10500--CALL
U$FRS
      4609**DCL-ENT 10848--CALL
U$FUI
      4609**DCL-ENT 10436--CALL
U$GET
      4610**DCL-ENT 11593--CALL
U$GTF
      4610**DCL-ENT 11566--CALL
U$HIA
      4606**DCL-ENT 12702--CALL
U$IFM
      4607**DCL-ENT 12397--CALL
U$IFT
      4607**DCL-ENT 12344--CALL
U$IST
      4607**DCL-ENT 12366--CALL
U$KEEP
      4612**DCL-ENT 12498--CALL
U$MOD
      4606**DCL-ENT 12230--CALL
U$NBF
      4612**DCL-ENT 12438--CALL
U$RDY
      4606**DCL-ENT  8935--CALL
U$REDUCEQ
      4612**DCL-ENT 12516--CALL
U$ROL
      4606**DCL-ENT 12480--CALL
U$RPT
      4612**DCL-ENT 12537--CALL
U$SHALL
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:317  
      4611**DCL-ENT  8834--CALL
U$SHANY
      4611**DCL-ENT  8866--CALL
U$SHCUR
      4611**DCL-ENT  8882--CALL
U$SHIN
      4611**DCL-ENT  8850--CALL
U$SHINCUR
      4612**DCL-ENT  8898--CALL
U$SHNO
      4611**DCL-ENT  8818--CALL
U$STO
      4606**DCL-ENT  9721--CALL
U$STOFF
      4611**DCL-ENT 12573--CALL
U$STON
      4610**DCL-ENT 12555--CALL
U$TROFF
      4610**DCL-ENT 12598--CALL
U$TRON
      4610**DCL-ENT 12617--CALL
USEP
      1238**DCL     12675--ASSIGN
USEP.FLAG
      1239**DCL     12674<<ASSIGN
USEP.M
      1240**DCL      7032>>ASSIGN   7048<<ASSIGN   7609>>ASSIGN   7610>>ASSIGN   7611>>ASSIGN   7612<<ASSIGN
      7612>>ASSIGN  12673<<ASSIGN
USEP.UC.ENT$
      1250**DCL      7044<<ASSIGN   7611<<ASSIGN
USEP.UC.UCW_PRV
      1243**DCL      1247--REDEF
USEP.UC.UCW_PRV.A
      1246**DCL      7043<<ASSIGN
USEP.UC.UCW_PRV.PB
      1245**DCL      7042<<ASSIGN
PL6.E3A0      #001=ZII$FORT_PL6 File=ZII$IDS_FORT_USER.:ZIC0TSI                  FRI 09/05/97 12:27 Page:318  
USEP.UC.UCW_PRV.PT
      1244**DCL      7041<<ASSIGN
USEP.UC.UCW_USE.CODE
      1249**DCL      7610<<ASSIGN
USEP.UC.UCW_USE.PT
      1248**DCL      7609<<ASSIGN
USEP$
      3969**DCL      1238--IMP-PTR  7032>>ASSIGN   7041>>ASSIGN   7042>>ASSIGN   7043>>ASSIGN   7044>>ASSIGN
      7048>>ASSIGN   7609>>ASSIGN   7609>>ASSIGN   7610>>ASSIGN   7610>>ASSIGN   7611>>ASSIGN   7611>>ASSIGN
      7612>>ASSIGN   7612>>ASSIGN  12670<<ASSIGN  12672<<ASSIGN  12673>>ASSIGN  12674>>ASSIGN  12675>>ASSIGN
UWA
      3763**DCL     12350>>ASSIGN  12372>>ASSIGN  12408>>ASSIGN
UWA$
      3965**DCL      3763--IMP-PTR  5809<>CALL     5813>>ASSIGN   9740>>ASSIGN  12350>>ASSIGN  12372>>ASSIGN
     12408>>ASSIGN  12468>>ASSIGN  12489>>ASSIGN  12635<<ASSIGN
UWA_SIZE
      3765**DCL      5811>>IF      12645<<ASSIGN  12647<>CALL
VEC IN PROCEDURE SDS$OPEN
      5702**DCL      5494--DCLINIT
VEC.W2 IN PROCEDURE SDS$OPEN
      5703**DCL      5704--REDEF
VEC_MAKER
      5407**PROC    12646--CALL    12647--CALL    12648--CALL
VLP_NAME IN PROCEDURE SDS$OPEN
      5689**DCL      5734--ASSIGN   5741<<ASSIGN   5754--ASSIGN
VLP_NAME.L# IN PROCEDURE SDS$OPEN
      5689**DCL      5729<<ASSIGN   5750>>CALLBLT  5751<<ASSIGN   5751>>ASSIGN
VLP_NAME.NAME# IN PROCEDURE SDS$OPEN
      5689**DCL      5730<<ASSIGN   5750<<CALLBLT
YC_ERROR
      8221**LABEL    8218--CALLALT
