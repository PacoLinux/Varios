VERSION E05

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:1    
        1        1        /*M* NIT$TAPE - MAG TAPE HANDLER */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR */
        8        8        NIT$POSTER: PROC(PAR,INTLVL,STATUS);
        9        9        /*D*  NAME:   NIT$POSTER
       10       10              INTERFACE:  NIT$DEVSCHED
       11       11                          NIO$SPCOMP
       12       12                          NIO$COMP
       13       13                          NIK$OPMSG
       14       14                          NIF$ANMPC
       15       15                          NIQ$RELS
       16       16                          NIQ$GETS
       17       17                          NIS$MASK
       18       18              ENVIRONMENT:    MONITOR LINKAGE SEGMENT
       19       19              INPUT:  N$DCT - Device control table
       20       20                      NI$REQ - IOS request packet
       21       21                      NI$DQH - Driver queue header
       22       22                      NI$SQH - Scheduler queue header
       23       23              DESCRIPTION:
       24       24                  This routine handles all fault channel, terminate, marker (do
       25       25              nothing) and special interrupts from mag tapes.  It is also called
       26       26              by the lost interrupt poller to handle lost interrupts and to
       27       27              repost defered packets.
       28       28        */
       29       29        /*
       30       30              Includes
       31       31        */
       32       32        %INCLUDE                CP_6_SUBS ;
       33      572        %INCLUDE                EL_SUBS_C ;
       34      656        %INCLUDE                FR$RAT ;
       35      709        %INCLUDE                HF_DATA_R ;
       36      752        %INCLUDE                HF_LOCK_C ;
       37      766        %INCLUDE                NI$ERRLOG ;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:2    
       38      832        %INCLUDE                NI_DATA_C ;
       39      945        %INCLUDE                NI_DATA_R ;
       40     1382        %INCLUDE                NI_MACROS_C ;
       41     1649        %INCLUDE                N_FC_C ;
       42     1686        %INCLUDE                OC_SUBS_C ;
       43     2417        %INCLUDE                PM$NI ;
       44     2441        /*
       45     2442              Parameters
       46     2443        */
       47     2444    1   DCL 1 INTLVL          UBIN(18) PARAM ;
       48     2445    1   DCL 1 PAR             SBIN PARAM ;
       49     2446        %STATUS               ( NAME=STATUS, STCLASS=PARAM ) ;
       50     2513        /*
       51     2514              Entries
       52     2515        */
       53     2516    1   DCL 1 NIA$LOGERR        ENTRY(4) ;
       54     2517    1   DCL 1 NIA$SPURINT       ENTRY(4) ;
       55     2518    1   DCL 1 NIO$SPCOMP        ENTRY(1) ;
       56     2519    1   DCL 1 NIO$COMP          ENTRY(2) ;
       57     2520    1   DCL 1 NIO$DCWBLD        ENTRY(1) ALTRET ;
       58     2521    1   DCL 1 NIK$OPMSG         ENTRY(5) ;
       59     2522    1   DCL 1 NIF$ANFAULT       ENTRY(3) ALTRET ;
       60     2523    1   DCL 1 NIF$ANIOM         ENTRY(2) ALTRET ;
       61     2524    1   DCL 1 NIQ$REL           ENTRY(1) ALTRET ;
       62     2525    1   DCL 1 NIQ$GET           ENTRY(1) ALTRET ;
       63     2526    1   DCL 1 NIS$MASK          ENTRY(2) ;
       64     2527    1   DCL 1 NIT$DEVSCHED      ENTRY(2) ;
       65     2528    1   DCL 1 NIT$DEVSCHEDL     ENTRY(2) ;
       66     2529    1   DCL 1 NIW$LDFW          ENTRY(2) ALTRET ;
       67     2530    1   DCL 1 NIW$MPCSTOP       ENTRY(1) ;
       68     2531    1   DCL 1 OCI$MK_STTM       ENTRY(1) ;
       69     2532    1   DCL 1 PMN$COLLECT       ENTRY(3) ;
       70     2533        /*
       71     2534              Auto
       72     2535        */
       73     2536    1   DCL 1 CHANTIME          SBIN ALIGNED AUTO ;
       74     2537    1   DCL 1 DCT$              PTR ALIGNED AUTO ;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:3    
       75     2538    1   DCL 1 DQH$              PTR ALIGNED AUTO ;
       76     2539    1   DCL 1 EXTST$            PTR ALIGNED AUTO ;
       77     2540    1   DCL 1 I                 SBIN ALIGNED AUTO ;
       78     2541    1   DCL 1 IOS$              PTR ALIGNED AUTO ;
       79     2542    1   DCL 1 MNSTAT(0:5)       BIT(1) UNAL AUTO ;
       80     2543    1   DCL 1 NEWSTATE          UBIN ALIGNED AUTO ;
       81     2544        %NI$EXTST               ( NAME=NI$EXTST, STCLASS=AUTO ) ;
       82     2578    1   DCL 1 RCVR              ALIGNED AUTO,
       83     2579    1         2 RETRY           BIT(1),
       84     2580    1         2 REPOS           BIT(1),
       85     2581    1         2 NOINC           BIT(1),
       86     2582    1         2 LOGERR          BIT(1),
       87     2583    1         2 FREPOS          BIT(1),
       88     2584    1         2 OPMSG           BIT(1),
       89     2585    1         2 NEWCH           BIT(1),
       90     2586    1         2 EXTST           BIT(1),
       91     2587    1         2 EOT             BIT(1),
       92     2588    1         2 SETDENS         BIT(1),
       93     2589    1         2 *               BIT(26);
       94     2590    1   DCL 1 REQ$              PTR ALIGNED AUTO ;
       95     2591    1   DCL 1 REPOS$            PTR ALIGNED AUTO ;
       96     2592    1   DCL 1 SETDENS$          PTR ALIGNED AUTO ;
       97     2593    1   DCL 1 SQH$              PTR ALIGNED AUTO ;
       98     2594        /*
       99     2595              Based
      100     2596        */
      101     2597        %NI$DCT                 ( NAME=DCT, STCLASS="BASED(DCT$)" ) ;
      102     2645        %NI$DQH                 ( NAME=DQH, STCLASS="BASED(DQH$)" ) ;
      103     2668        %NI$IOM                 ( NAME=IOM ) ;
      104     2673        %NI$REQ                 ( NAME=IOS, STCLASS="BASED(IOS$)" ) ;
      105     2698        %NI$IOSTAT              ( NAME=IOSTAT ) ;
      106     2707        %NI$MBX                 ( NAME=MBX, STCLASS=BASED ) ;
      107     2726        %NI$CHT ;
      108     2729        %NI$IOERR               ( NAME=NI$IOERR, STCLASS=BASED ) ;
      109     2783        %FR$RAT                 ( NAME=RAT, STCLASS=BASED ) ;
      110     2823        %N$REQ                  ( NAME=REQ, STCLASS="BASED(REQ$)" ) ;
      111     2881        %NI$SQH                 ( NAME=SQH, STCLASS="BASED(SQH$)" ) ;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:4    
      112     2894        /*
      113     2895              Constants
      114     2896        */
      115     2897        %SUB RETRY#='400'O;
      116     2898        %SUB REPOS#='200'O;
      117     2899        %SUB NOINC#='100'O;
      118     2900        %SUB LOGERR#='040'O;
      119     2901        %SUB FREPOS#='020'O;
      120     2902        %SUB OPMSG#='010'O;
      121     2903        %SUB NEWCH#='004'O;
      122     2904        %SUB EXTST#='002'O;
      123     2905        %SUB EOT#='001'O;
      124     2906        %SUB SETDENS#='0004'O;
      125     2907        /**/
      126     2908        %SUB NEVER="WHILE ('0'B)";
      127     2909        %SUB FOREVER="WHILE ('1'B)";
      128     2910        /**/
      129     2911        %SUB RTY_READ_SRB=1;
      130     2912        %SUB RTY_WRITE_SRB=2;
      131     2913        %SUB RTY_WRITE_SRF=3;
      132     2914        %SUB RTY_WRITE_ERASE=4;
      133     2915        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:5    
      134     2916    2           DO INHIBIT;
      135     2917        /*    DQH$, REQ$ and DCT$ are set up based on the value of INTLVL. */
      136     2918    3              DO CASE (INTLVL);
      137     2919    3               CASE(%OVERHEAD,%TERMINATE,%LOST);
      138     2920    3                 DQH$=ADDR(PAR);
      139     2921    3                 SQH$=DQH.SQH$;
      140     2922                      %LOCK (G#=SQH.GATE);
      141     2925    3                 IF  DQH.STATE ~= %BUSY
      142     2926    4                 THEN DO ;
      143     2927    4                    IF  ADDR(STATUS) ~= ADDR(NIL)
      144     2928    4                    THEN
      145     2929    4                       CALL NIA$SPURINT ( DQH, EL_SPURINT, INTLVL, STATUS ) ;
      146     2930    4                    ELSE IF  INTLVL = %TERMINATE
      147     2931    4                         AND DQH.IOSTATUS$ ~= ADDR(NIL)
      148     2932    4                       THEN
      149     2933    4                          CALL NIA$SPURINT ( DQH, EL_SPURINT, INTLVL, DQH.IOSTATUS$->
              2933                                   IOSTAT.STATUS ) ;
      150     2934    4                       ELSE
      151     2935    4                          CALL NIA$SPURINT ( DQH, EL_SPURINT, INTLVL, NI_DBLZERO ) ;
      152     2936                         %UNLOCK ( G#=SQH.GATE ) ;
      153     2939    4                    RETURN ;
      154     2940    4                    END ;
      155     2941    3                 REQ$=DQH.IO$;
      156     2942    3                 DCT$=REQ.DCT$;
      157     2943    3                 CALL PMN$COLLECT(DQH.PM,%PM_IDLE,CHANTIME);
      158     2944    3                 IF HW_IMX THEN
      159     2945    3                    REQ.FLPW=DQH.IOSTATUS$->IOSTAT.LPW_RESIDUE;
      160     2946    3                 ELSE
      161     2947    3                    REQ.FLPW=DQH.MBX$->MBX.LPW;
      162     2948    4                 IF INTLVL=%TERMINATE THEN DO;
      163     2949    4                    REQ.STATUS=DQH.IOSTATUS$->IOSTAT.STATUS;
      164     2950    4                    IF HW_IOP THEN    /* ignore IOP generated lost interrupt */
      165     2951    4                       IF REQ.STATUS.MAJOR = %READY AND
      166     2952    5                         REQ.STATUS.IOM.CHANNEL = %LOSTINT THEN DO;
      167     2953                               %UNLOCK (G#=SQH.GATE);
      168     2956    5                          RETURN;
      169     2957    5                          END;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:6    
      170     2958    4                    END;
      171     2959    4                 ELSE DO;
      172     2960    4                    REQ.STATUS=STATUS;
      173     2961    5                    IF REQ.STATUS.MAJOR=%LOST_INTERRUPT THEN DO;
      174     2962    5                       CALL NIS$MASK(DQH,%IMX_CCW_MASK_CHAN);
      175     2963    5                       END;
      176     2964    4                    END;
      177     2965    3                 NI$EXTST.EXTST=DQH.IOSTATUS$->IOSTAT.EXTST;
              2965                          /* MEANINGFUL FOR IOP/IMX */
      178     2966    3                 IF REQ.IOFLG.REL THEN DQH.MPC$->DCT.DFLG.MPCSUSPENDED='0'B;
      179     2967    3                 CALL RELCHAN;
      180     2968                      %UNLOCK (G#=SQH.GATE);
      181     2971    3                 IF DCT.SQ$=ADDR(NIL) THEN
      182     2972    3                    CALL PMN$COLLECT(DCT.PM,%PM_IDLE);
      183     2973    3                 ELSE
      184     2974    3                    CALL PMN$COLLECT(DCT.PM,%PM_WAIT);
      185     2975    3               CASE(%MARKER);
      186     2976    3                 DQH$=ADDR(PAR);
      187     2977    3                 IF DQH.IO$=ADDR(NIL) THEN
      188     2978    3                    CALL NIA$SPURINT(DQH,EL_SPURINT,INTLVL,NI_DBLZERO);
      189     2979    3                 ELSE
      190     2980    3                    CALL NIA$SPURINT(DQH,EL_SPURINT,INTLVL,DQH.IOSTATUS$->IOSTAT.STATUS
              2980                             );
      191     2981    3                 RETURN;
      192     2982    3               CASE(%SPECIAL);
      193     2983    3                 IF ADDR(STATUS)=ADDR(NIL) THEN
      194     2984    3                    RETURN;
      195     2985    3                 DQH$=ADDR(PAR);
      196     2986    3                 SQH$=DQH.SQH$;
      197     2987    4                 DO I=SQH.FDCT TO SQH.FDCT+SQH.NDCT-1;
      198     2988    4                    DCT$=N$DCT$(I);
      199     2989    5                    IF DCT.DVN=SPSTAT.DVN AND DCT.TYPE~=%DV_MPC THEN DO;
      200     2990                            %LOCK (G#=SQH.GATE);
      201     2993    6                       IF NOT DCT.SPSTAT.PRESENCE THEN DO;
      202     2994    6                          DCT.SPSTAT=STATUS;
      203     2995                               %UNLOCK (G#=SQH.GATE);
      204     2998    7                          IF DCT.SPSTAT.CODE & '000020'O AND DCT.STATE=%SPWAIT THEN DO;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:7    
              2998                                   /* TAPE READY */
      205     2999    8                             IF DCT.MT.SETDENS$~=ADDR(NIL) THEN DO;
      206     3000    8                                IF DCT.MT.SETDENS$->REQ.DQH$->DQH.LA~=DQH.LA OR
      207     3001    8                                  DCT.MT.SETDENS$->REQ.DQH$->DQH.MPC$~=DQH.MPC$ THEN
      208     3002    8                                   GOTO SKIP_SPEC;
      209     3003    8                                END;
      210     3004    8                             IF DCT.MSG#>0 THEN DO;
      211     3005    8                                CALL OCI$MK_STTM(DCT.MSG#);
      212     3006    8                                DCT.MSG#=0;
      213     3007    8                                END;
      214     3008    7                             CALL NIT$DEVSCHED(DCT,%IDLE);
      215     3009    7   SKIP_SPEC:                END;
      216     3010    6                          ELSE IF DCT.SPSTAT.CODE & '000100'O THEN
              3010                                   /* REWIND COMPLETE */
      217     3011    6                                DCT.MT.RWC='1'B;
      218     3012    6                             ELSE IF DCT.MT.FREPOS$=ADDR(NIL) AND NOT
      219     3013    6                                  ((DCT.SPSTAT.CODE&'200000'O) AND DCT.RAT$->RAT.FLG.
              3013                                           RUP) THEN
      220     3014                                   /* IGNORE FIPS SPECIAL POLLING TAPE-READY INTERRUPT
      221     3015                                      IF TAPE RESOURCE IS IN USE                         */
      222     3016    6                                   CALL NIO$SPCOMP(DCT);
      223     3017    6                          DCT.SPSTAT.PRESENCE='0'B;
      224     3018    6                          END;
      225     3019    6                       ELSE DO;
      226     3020                               %UNLOCK (G#=SQH.GATE);
      227     3023    6                          END;
      228     3024    5                       RETURN;
      229     3025    5                       END;
      230     3026    4                    END;
      231     3027    3                 CALL NIA$SPURINT(DQH,EL_SPURINT,INTLVL,STATUS);
      232     3028    3                 RETURN;
      233     3029    3               CASE(%REPOST);
      234     3030    3                 REQ$=ADDR(PAR);
      235     3031    3                 DCT$=REQ.DCT$;
      236     3032    3                 DQH$=DCT.DQH$;
      237     3033    3                 SQH$=DCT.SQH$;
      238     3034    3                 NI$EXTST.EXTST='0'B;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:8    
      239     3035    3               END;                        /* CASE INTLVL                        */
      240     3036    2              END;                         /* INHIBIT                            */
      241     3037        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:9    
      242     3038    2           IF REQ.STATUS.MAJOR=%DEVICE_BUSY AND (REQ.STATUS.MINOR & '05'O) THEN DO;
      243     3039                                                /* LOAD OR REWIND IN PROGRESS */
      244     3040                   %LOCK (G#=SQH.GATE);
      245     3043    3              IF REQ$~=DCT.MT.FREPOS$ AND REQ$~=DCT.MT.SETDENS$ THEN DO;
      246     3044                      %REQUEUE (P#=REQ,Q#=DCT.SQ$);
      247     3047    3                 END;
      248     3048    3              IF DCT.MT.RWC THEN DO;
      249     3049    3                 DCT.MT.RWC='0'B;
      250     3050    3                 CALL NIT$DEVSCHEDL(DCT,%IDLE);
      251     3051    3                 END;
      252     3052    3              ELSE DO;
      253     3053    3                 CALL NIT$DEVSCHEDL(DCT,%SPWAIT);
      254     3054    3                 END;
      255     3055    2              RETURN;
      256     3056    2              END;
      257     3057    1           REQ.TYC='0'B;
      258     3058    1           RCVR='0'B;
      259     3059    1           EXTST$=ADDR(NIL);
      260     3060    1           REPOS$=ADDR(NIL);
      261     3061    1           SETDENS$=ADDR(NIL);
      262     3062    1           NEWSTATE=%IDLE;
      263     3063    1           IF REQ.FC=%N_RQSTAT OR REQ.FC=%N_EXTST OR REQ.COMP=%COMP_TD THEN
      264     3064    1              GOTO BYPASS_STATUS_ANALYSIS;
      265     3065    2           IF REQ.STATUS.POWEROFF THEN DO;
      266     3066    2              RCVR=RETRY#|LOGERR#|OPMSG#|FREPOS#;
      267     3067    2              NEWSTATE=%MPCWAIT;
      268     3068    2              IF  HW_IMX
      269     3069    2                AND DCT.CTYP = %C_IPC
      270     3070    3              THEN DO ;
      271     3071    3                 DQH.MPC$->DCT.DFLG.MPCSTOP = '0'B ;
      272     3072    3                 DQH.MPC$->DCT.DFLG.RELOAD  = '0'B ;
      273     3073    3                 CALL NIW$MPCSTOP ( DQH.MPC$->DCT ) ;
      274     3074    3                 CALL NIK$OPMSG ( DCT, POWEROFF_MSG#, M_TAPE, %KIWAIT, REQ ) ;
      275     3075    3                 END ;
      276     3076    3              ELSE DO ;
      277     3077    3                 CALL NIW$LDFW ( DQH.MPC$->DCT, '0'B ) ;
      278     3078    3                 END ;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:10   
      279     3079    2              END;
      280     3080    2           ELSE DO CASE(REQ.STATUS.MAJOR);
      281     3081    2            CASE(%READY);
      282     3082    3              IF NOT REQ.STATUS.PRESENCE THEN DO;
      283     3083    3                 REQ.TYC.IOERR='1'B;
      284     3084    3                 END;
      285     3085    2              IF REQ.STATUS.MINOR & '02'O THEN REQ.TYC.BOT='1'B;
      286     3086    3              IF REQ.STATUS.MINOR='14'O THEN DO;
      287     3087    3                 REQ.TYC.IOERR='1'B;
      288     3088    3                 RCVR=RETRY#|LOGERR#|REPOS#;
      289     3089    3                 END;
      290     3090    3              IF REQ.STATUS.IOM THEN DO;
      291     3091    3                 CALL NIF$ANIOM(REQ,RCVR.RETRY) ALTRET(IOM_ALT);
      292     3092    4                 DO NEVER;
      293     3093    4   IOM_ALT:         NEWSTATE=%KIWAIT;
      294     3094    4                    END;
      295     3095    3                 IF RCVR.RETRY THEN RCVR=%(RETRY#|LOGERR#|REPOS#);
      296     3096    3                 ELSE RCVR=LOGERR#;
      297     3097    3                 END;
      298     3098    2            CASE(%DEVICE_BUSY);
      299     3099    2              REQ.TYC.IOERR='1'B;
      300     3100    2              RCVR = %( RETRY# | LOGERR# ) ;
      301     3101    2            CASE(%ATTENTION);
      302     3102    2              MNSTAT=REQ.STATUS.MINOR;
      303     3103    3              DO I=0 TO 5;
      304     3104    4                 IF MNSTAT(I) THEN DO CASE(I);
      305     3105    4                  CASE(0,4); /* 0=UNDEFINED, 4=OFF LINE */;
      306     3106    4                    REQ.TYC.IOERR='1'B;
      307     3107    4                    RCVR=RETRY#|FREPOS#|LOGERR#;
      308     3108    4                    NEWSTATE=%KIWAIT;
      309     3109    4                  CASE(1); /* BLANK TAPE ON WRITE */;
      310     3110    4                    REQ.TYC.IOERR='1'B;
      311     3111    4                    RCVR=RETRY#|LOGERR#;
      312     3112    4                  CASE(2,3);               /* 2=DEVICE CHECK, 3=STANDBY */
      313     3113    4                    REQ.TYC.IOERR='1'B;
      314     3114    4                    RCVR=RETRY#|FREPOS#|LOGERR#|EXTST#;
      315     3115    4                    NEWSTATE=%KIWAIT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:11   
      316     3116    4                  CASE(5);                 /* WRITE PROTECTED */
      317     3117    4                    REQ.TYC.PROT='1'B;
      318     3118    4                  END;
      319     3119    3                 END;
      320     3120    2            CASE(%DATA_ALERT);
      321     3121    2              MNSTAT=REQ.STATUS.MINOR;
      322     3122    3              DO I=0 TO 5;
      323     3123    4                 IF MNSTAT(I) THEN DO CASE(I);
      324     3124    4                  CASE(0);                 /* EOT */
      325     3125    4                    REQ.TYC.EOT='1'B;
      326     3126    4                  CASE(1,2);               /* PARITY ERROR */
      327     3127    4                    REQ.TYC.IOERR='1'B;
      328     3128    4                    RCVR=RETRY#|REPOS#|LOGERR#|EXTST#;
      329     3129    4                  CASE(3);                 /* TRANSMISSION PARITY ERROR */
      330     3130    4                    REQ.TYC.IOERR='1'B;
      331     3131    4                    RCVR=RETRY#|REPOS#|LOGERR#;
      332     3132    4                  CASE(4); /* BLANK TAPE ON READ */;
      333     3133    4                    REQ.TYC.BLNKTP='1'B;
      334     3134    4                  CASE(5);                 /* TRANSFER TIMING ERROR */
      335     3135    5                    IF MNSTAT(4) THEN DO;  /* BIT DURING ERASE */
      336     3136    5                       REQ.TYC.BLNKTP='0'B;
      337     3137    5                       REQ.TYC.IOERR='1'B;
      338     3138    5                       END;
      339     3139    5                    ELSE DO;               /* TRANSFER TIMING ERROR */
      340     3140    5                       REQ.TYC.IOERR='1'B;
      341     3141    5                       RCVR=RETRY#|REPOS#|LOGERR#;
      342     3142    5                       END;
      343     3143    4                  END;
      344     3144    3                 END;
      345     3145    3              IF REQ.TYC.EOT AND RCVR.REPOS THEN DO;
      346     3146    3                 RCVR.EOT='1'B;
      347     3147    3                 END;
      348     3148    2            CASE(%END_OF_FILE);
      349     3149    3              IF REQ.STATUS.MINOR='23'O OR REQ.STATUS.MINOR='17'O THEN DO;
      350     3150    3                 REQ.TYC.EOF='1'B;
      351     3151    3                 END;
      352     3152    3              ELSE IF REQ.STATUS.MINOR='77'O THEN DO;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:12   
      353     3153    3                    REQ.TYC.IOERR='1'B;
      354     3154    3                    RCVR=RETRY#|REPOS#|LOGERR#|EXTST#;
      355     3155    3                    END;
      356     3156    3                 ELSE DO;
      357     3157    3                    REQ.TYC.IOERR='1'B;
      358     3158    3                    IF REQ.STATUS.MINOR~='04'O THEN RCVR=RETRY#|LOGERR#;
      359     3159    3                    END;
      360     3160    2            CASE(%COMMAND_REJECT);
      361     3161    3              IF REQ.STATUS.MINOR='00'O OR REQ.STATUS.MINOR & '43'O THEN DO;
      362     3162    3                 REQ.TYC.IOERR='1'B;
      363     3163    3                 RCVR=RETRY#|LOGERR#;
      364     3164    3                 END;
      365     3165    3              IF REQ.STATUS.MINOR & '20'O THEN DO;
      366     3166    3                 REQ.TYC.FRAW='1'B;
      367     3167    3                 END;
      368     3168    3              IF REQ.STATUS.MINOR & '10'O THEN DO;
      369     3169    3                 REQ.TYC.BOT='1'B;
      370     3170    3                 END;
      371     3171    3              IF REQ.STATUS.MINOR & '04'O THEN DO;
      372     3172    3                 REQ.TYC.IOERR='1'B;
      373     3173    3                 RCVR=RETRY#|LOGERR#|REPOS#;
      374     3174    3                 END;
      375     3175    2            CASE(%LOST_INTERRUPT);
      376     3176    2              REQ.TYC.TIMO='1'B;
      377     3177    2              NEWSTATE=%KIWAIT;
      378     3178    2              RCVR=RETRY#|FREPOS#|LOGERR#|OPMSG#;
      379     3179    2            CASE(%MPC_ATTENTION);
      380     3180    3              DO CASE(BITBIN(REQ.STATUS.MINOR));
      381     3181    3               CASE(1,2,3);
      382     3182    3                 NEWSTATE=%KIWAIT;
      383     3183    3                 RCVR=RETRY#|REPOS#|LOGERR#|OPMSG#;
      384     3184    3                 REQ.TYC.IOERR='1'B;
      385     3185    3               CASE(8);
      386     3186    3                 REQ.TYC.IOERR='1'B;
      387     3187    3                 IF DCT.RAT$->RAT.FLG.RUP THEN /* DON'T LOG ERROR IF AVRING */
      388     3188    3                    RCVR=LOGERR#|RETRY#|REPOS#;
      389     3189    3               CASE(12,13,14,15);
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:13   
      390     3190    3                 REQ.TYC.IOERR='1'B;
      391     3191    3                 RCVR=RETRY#|REPOS#|LOGERR#;
      392     3192    3               CASE(17);
      393     3193    3                 REQ.TYC.IOERR='1'B;
      394     3194    3                 RCVR=REPOS#|LOGERR#|OPMSG#;
      395     3195    3               CASE(16,ELSE);
      396     3196    3                 REQ.TYC.IOERR='1'B;
      397     3197    3                 RCVR=RETRY#|FREPOS#|LOGERR#|EXTST#;
      398     3198    3               END;                        /* CASE MINOR */
      399     3199    2            CASE(%MPC_DATA_ALERT);
      400     3200    3              DO CASE(BITBIN(REQ.STATUS.MINOR));
      401     3201    3               CASE(1,2,3,4,20,ELSE);
      402     3202    3                 REQ.TYC.IOERR='1'B;
      403     3203    3                 RCVR=RETRY#|REPOS#|LOGERR#;
      404     3204    3               CASE(9,16,17,18,19,32);
      405     3205    3                 REQ.TYC.IOERR='1'B;
      406     3206    3                 RCVR=RETRY#|REPOS#|LOGERR#|EXTST#;
      407     3207    3               CASE(8);
      408     3208    3                 REQ.TYC.IOERR='1'B;
      409     3209    3                 RCVR=RETRY#|FREPOS#|LOGERR#|EXTST#;
      410     3210    3               END/* CASE MINOR */;
      411     3211    2            CASE(%SPECIAL_INTERRUPT);
      412     3212    2              RETURN;
      413     3213    2            CASE(%MPC_COMMAND_REJECT);
      414     3214    3              DO CASE(BITBIN(REQ.STATUS.MINOR));
      415     3215    3               CASE(0);          /* FIPS indeterminate density                 */
      416     3216    3                 REQ.TYC.IOERR='1'B;
      417     3217    3                 RCVR=RETRY#|SETDENS#|LOGERR#;  /*N* SHOULD WE DO SETDENS? */
      418     3218    3               CASE(1,2,3,4,ELSE);
      419     3219    3                 REQ.TYC.IOERR='1'B;
      420     3220    3                 RCVR=RETRY#|REPOS#|LOGERR#;
      421     3221    3               END;
      422     3222    2            CASE(%SYSTEM_FAULT);
      423     3223    2              RCVR=%LOGERR#;
      424     3224    2              CALL NIF$ANFAULT(REQ,RCVR.RETRY,RCVR.FREPOS) ALTRET(FLT_ALT);
      425     3225    3              DO NEVER;
      426     3226    3   FLT_ALT:      NEWSTATE=%KIWAIT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:14   
      427     3227    3                 END;
      428     3228    2              IF NOT RCVR.FREPOS THEN RCVR.REPOS='1'B;
      429     3229    2            CASE(ELSE);
      430     3230    2              REQ.TYC.IOERR='1'B;
      431     3231    2              RCVR=LOGERR#;
      432     3232    2            END/* CASE MAJOR */;
      433     3233        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:15   
      434     3234    1   BYPASS_STATUS_ANALYSIS: ;
      435     3235    2           DO CASE(REQ.COMP);
      436     3236    2            CASE(%COMP_REG);               /* REGULAR IO REQUESTS */
      437     3237    2              RCVR.REPOS=RCVR.REPOS & ~REQ.STATUS.ININT;
      438     3238    3              IF RCVR.RETRY THEN DO;
      439     3239    3                 IF NOT REQ.TYC THEN REQ.TYC.IOERR='1'B;
      440     3240    3                 CALL BGNRETRY ALTRET(REPOST);
      441     3241    3                 IF NOT RCVR.NOINC THEN REQ.ERRCT=REQ.ERRCT+1;
      442     3242    4                 IF REQ.ERRCT>8 THEN DO;
      443     3243    4                    RCVR.RETRY='0'B;
      444     3244    4                    END;
      445     3245    3                 END;
      446     3246    3              ELSE DO;                     /* NOT RCVR.RETRY */
      447     3247    3                 CALL CHECK_DONE;
      448     3248    3                 CALL UPDATE_POS;
      449     3249    3                 END;
      450     3250    2              IF NEWSTATE>%IDLE THEN RCVR.OPMSG='1'B;
      451     3251    2            CASE(%COMP_FREPOS);
      452     3252    3              IF RCVR.RETRY THEN DO;
      453     3253    3                 CALL BGNFREPOS;
      454     3254    3                 NEWSTATE=%KIWAIT;
      455     3255    3                 CALL NIK$OPMSG(DCT,MT_MSG#,M_TAPE,NEWSTATE,REQ);
      456     3256    3                 END;
      457     3257    3              ELSE DO;
      458     3258    3                 CALL CHECK_DONE ALTRET(FREPOS_CONT);
      459     3259    4                 DO CASE(REQ.POSTER);
      460     3260    4                  CASE(%FREPOS_REWIND);
      461     3261    4                    IF DCT.MT.POS.FILECNT=0 THEN GOTO FREPOS_SPR;
      462     3262    4                    REQ.FC=%N_SPFILE;
      463     3263    4                    REQ.RCT=DCT.MT.POS.FILECNT;
      464     3264    4                    REQ.POSTER=%FREPOS_SPF;
      465     3265    4                    CALL NIO$DCWBLD(REQ);
      466     3266    4                  CASE(%FREPOS_SPF);
      467     3267    4   FREPOS_SPR:      IF DCT.MT.POS.CRECCNT=0 THEN GOTO FREPOS_DONE;
      468     3268    4                    REQ.FC=%N_SPREC;
      469     3269    4                    REQ.RCT=DCT.MT.POS.CRECCNT;
      470     3270    4                    REQ.POSTER=%FREPOS_SPR;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:16   
      471     3271    4                    CALL NIO$DCWBLD(REQ);
      472     3272    4                  CASE(%FREPOS_SPR);
      473     3273    4   FREPOS_DONE:     REQ$->REQ.IOQFLG.IOQUED = '0'B ;
      474     3274    4                    CALL NIQ$REL ( REQ$ ) ;
      475     3275    4                    DCT.MT.FREPOS$=ADDR(NIL);
      476     3276    4                  END;
      477     3277    3   FREPOS_CONT:  END;
      478     3278    2              RCVR='0'B;                   /* RESET RCVR */
      479     3279    2              REQ$=ADDR(NIL);
      480     3280    2            CASE(%COMP_SETDENS);
      481     3281    3              IF RCVR.RETRY THEN DO;
      482     3282    3                 CALL BGNFREPOS;
      483     3283    3                 NEWSTATE=%KIWAIT;
      484     3284    3                 CALL NIK$OPMSG(DCT,MT_MSG#,M_TAPE,NEWSTATE,DCT.MT.FREPOS$->REQ);
      485     3285    3                 END;
      486     3286    3              ELSE DO;
      487     3287    3                 CALL CHECK_DONE ALTRET(SETDENS_CONT);
      488     3288    3                 END;
      489     3289    2              REQ$->REQ.IOQFLG.IOQUED = '0'B ;
      490     3290    2              CALL NIQ$REL (REQ$);
      491     3291    2              DCT.MT.SETDENS$=ADDR(NIL);
      492     3292    2   SETDENS_CONT:
      493     3293    2              RCVR='0'B;
      494     3294    2              REQ$=ADDR(NIL);
      495     3295    2            CASE(%COMP_IOS);
      496     3296    3              IF REQ.FC=%N_EXTST THEN DO;
      497     3297    3                 NEWSTATE=REQ.EAINFOX;
      498     3298    3                 DCT.MT.FREPOS$=REQ.EAINFOP$;
      499     3299    3                 RCVR='0'B;
      500     3300    3                 REQ$->REQ.IOQFLG.IOQUED = '0'B ;
      501     3301    3                 CALL NIQ$REL(REQ$);
      502     3302    3                 REQ$=ADDR(NIL);
      503     3303    3                 END;
      504     3304    3              ELSE DO;                     /* NOT EXTST */
      505     3305    4                 IF RCVR.RETRY THEN DO;
      506     3306    4                    RCVR.RETRY='0'B;
      507     3307    4                    RCVR.FREPOS='1'B;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:17   
      508     3308    4                    NEWSTATE=%KIWAIT;
      509     3309    4                    RCVR.OPMSG='1'B;
      510     3310    4                    END;
      511     3311    4                 ELSE DO;
      512     3312    4                    CALL CHECK_DONE ALTRET(IOS_CONT);
      513     3313    5                    DO CASE(REQ.POSTER);
      514     3314    5                     CASE(RTY_READ_SRB);
      515     3315    5                     CASE(RTY_WRITE_SRB);
      516     3316    5                       REQ.FC=%N_ERASE;
      517     3317    5                       CALL NIO$DCWBLD(REQ);
      518     3318    5                       RCVR.RETRY='1'B;
      519     3319    5                       REQ.POSTER=RTY_WRITE_ERASE;
      520     3320    5                     CASE(RTY_WRITE_ERASE);
      521     3321    6                       IF REQ.EAINFO>0 THEN DO;
      522     3322    6                          REQ.EAINFO=REQ.EAINFO-1;
      523     3323    6                          RCVR.RETRY='1'B;
      524     3324    6                          END;
      525     3325    5                     END;
      526     3326    4   IOS_CONT:        END;
      527     3327    3                 END;                      /* NOT EXTST */
      528     3328    2            CASE(%COMP_TD);
      529     3329    2              REQ.EAINFO=CHANTIME;
      530     3330    2              RCVR='0'B;
      531     3331    2            END;                           /* CASE REQ.COMP */
      532     3332    1           IF RCVR.FREPOS THEN CALL BGNFREPOS ALTRET(REPOST);
      533     3333    1           IF RCVR.SETDENS THEN
      534     3334    1              CALL SETDENS;
      535     3335    2           IF REQ$~=ADDR(NIL) THEN DO;
      536     3336    3              IF RCVR.OPMSG THEN DO;
      537     3337    3                 CALL NIK$OPMSG(DCT,MT_MSG#,M_TAPE,NEWSTATE,REQ);
      538     3338    3                 END;
      539     3339    3              IF RCVR.LOGERR THEN DO;
      540     3340    3                 CALL NIA$LOGERR(REQ,EL_IOERR);
      541     3341    3                 END;
      542     3342    3              IF REQ.ERR$~=ADDR(NIL) THEN DO;
      543     3343    4                 IF NOT REQ.ERR$->NI$IOERR.GOTEXTST THEN DO;
      544     3344    5                    IF HW_EXT_STATUS THEN DO;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:18   
      545     3345    6                       IF NI$EXTST.EXTSTT.WRD(0)~=0 THEN DO;
      546     3346    6                          REQ.ERR$->NI$IOERR.EXTST=NI$EXTST.EXTST;
      547     3347    6                          REQ.ERR$->NI$IOERR.GOTEXTST='1'B;
      548     3348    6                          END;
      549     3349    5                       END;
      550     3350    5                    ELSE IF RCVR.EXTST THEN DO;
      551     3351    5                          CALL NIQ$GET(EXTST$) ALTRET(NOEXTST);
      552     3352    5                          EXTST$->REQ.FC=%N_EXTST;
      553     3353    5                          EXTST$->REQ.OPFLG=OP_BPF;
      554     3354    5                          EXTST$->REQ.BUF$=ADDR(REQ.ERR$->NI$IOERR.EXTST);
      555     3355    5                          EXTST$->REQ.BUFSIZE=SIZEC(NI$IOERR.EXTST);
      556     3356    5                          EXTST$->REQ.DLA=REQ.DLA;
      557     3357    5                          EXTST$->REQ.COMP=%COMP_IOS;
      558     3358    5                          CALL NIO$DCWBLD(EXTST$->REQ) ALTRET(NOEXTST0);
      559     3359    5                          REQ.ERR$->NI$IOERR.GOTEXTST='1'B;
      560     3360    5                          EXTST$->REQ.EAINFOP$=DCT.MT.FREPOS$;
      561     3361    5                          DCT.MT.FREPOS$=ADDR(NIL);
      562     3362    5                          EXTST$->REQ.EAINFOX=NEWSTATE;
      563     3363    5                          NEWSTATE=%IDLE;
      564     3364    6                          DO NEVER;
      565     3365    6   NOEXTST0:                 CALL NIQ$REL(EXTST$);
      566     3366    6                             END;
      567     3367    5   NOEXTST:               END;
      568     3368    4                    END;
      569     3369    3                 END;
      570     3370    3              IF RCVR.RETRY THEN DO;
      571     3371                      %LOCK (G#=SQH.GATE);
      572     3374                      %REQUEUE (P#=REQ,Q#=DCT.SQ$);
      573     3377                      %UNLOCK (G#=SQH.GATE);
      574     3380    3                 END;
      575     3381    2              ELSE CALL NIO$COMP(REQ,NI$EXTST);
      576     3382    2              END;                         /* IF REQ$ */
      577     3383                %LOCK (G#=SQH.GATE);
      578     3386    2           IF REPOS$~=ADDR(NIL) THEN DO;
      579     3387                   %REQUEUE (P#="REPOS$->REQ",Q#=DCT.SQ$);
      580     3390    2              END;
      581     3391    2           IF SETDENS$~=ADDR(NIL) THEN DO;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:19   
      582     3392                   %REQUEUE (P#="SETDENS$->REQ",Q#=DCT.SQ$);
      583     3395    2              END;
      584     3396    2           IF EXTST$~=ADDR(NIL) THEN DO;
      585     3397                   %REQUEUE (P#="EXTST$->REQ",Q#=DCT.SQ$);
      586     3400    2              END;
      587     3401                %UNLOCK (G#=SQH.GATE);
      588     3404    1           CALL NIT$DEVSCHED(DCT,NEWSTATE);
      589     3405    1           RETURN;
      590     3406        /**/
      591     3407    1   REPOST:
      592     3408    1           CALL SETREPOST;
      593     3409    1           CALL NIT$DEVSCHED(DCT,NEWSTATE);
      594     3410    1           RETURN;
      595     3411        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:20   
      596     3412    1   BGNRETRY: PROC ALTRET;
      597     3413    3           IF RCVR.REPOS THEN DO CASE(REQ.FC);
      598     3414    3            CASE(%N_DCWLIST,%N_WRFM);
      599     3415    3              CALL BGNFREPOS ALTRET(REPOST);
      600     3416    3            CASE(%N_RDBIN,%N_RDASC,%N_READ);
      601     3417    3              CALL GETRTY ALTRET(REPOST);
      602     3418    3              REPOS$->REQ.FC=%N_SPREC;
      603     3419    3              REPOS$->REQ.RCT=-1;
      604     3420    3              REPOS$->REQ.POSTER=RTY_READ_SRB;
      605     3421    3              CALL NIO$DCWBLD(REPOS$->REQ) ALTRET(REPOST);
      606     3422    3            CASE(%N_WRBIN,%N_WRASC,%N_WRITE);
      607     3423    3              CALL GETRTY ALTRET(REPOST);
      608     3424    3              REPOS$->REQ.FC=%N_SPREC;
      609     3425    3              REPOS$->REQ.RCT=-1;
      610     3426    3              REPOS$->REQ.POSTER=RTY_WRITE_SRB;
      611     3427    3              REPOS$->REQ.EAINFO=1;        /* SET NUMBER OF ERASES */
      612     3428    3              CALL NIO$DCWBLD(REPOS$->REQ) ALTRET(REPOST);
      613     3429    3            CASE(%N_REWIND,%N_UNLOAD,%N_LDTAPE);
      614     3430    3              RCVR.FREPOS='0'B;
      615     3431    3            CASE(%N_SPFILE,%N_SPREC);
      616     3432    3              CALL BGNFREPOS ALTRET(REPOST);
      617     3433    3            CASE(ELSE);
      618     3434    3              RCVR.RETRY='0'B;
      619     3435    3            END;
      620     3436    2           RETURN;
      621     3437    2   REPOST: ALTRETURN;
      622     3438    2   END BGNRETRY;
      623     3439        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:21   
      624     3440    1   SETREPOST: PROC;
      625     3441    3           IF EXTST$ ~= ADDR(NIL) THEN DO ;
      626     3442    3              EXTST$->REQ.IOQFLG.IOQUED = '0'B ;
      627     3443    3              CALL NIQ$REL ( EXTST$ ) ;
      628     3444    3              END ;
      629     3445    3           IF REPOS$ ~= ADDR(NIL) THEN DO ;
      630     3446    3              REPOS$->REQ.IOQFLG.IOQUED = '0'B ;
      631     3447    3              CALL NIQ$REL ( REPOS$ ) ;
      632     3448    3              END ;
      633     3449                %LOCK (G#=NI$RP.GATE);
      634     3452                %ENQUEUE(Q#=NI$RP.RP$,P#=REQ);
      635     3455                %UNLOCK(G#=NI$RP.GATE);
      636     3458    2           NEWSTATE=%SUSPENDED;
      637     3459    2           REQ$=ADDR(NIL);
      638     3460    2           RETURN;
      639     3461    2   END SETREPOST;
      640     3462        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:22   
      641     3463    1   GETRTY: PROC ALTRET;
      642     3464    2           CALL NIQ$GET(REPOS$) ALTRET(REPOST);
      643     3465    2           REPOS$->REQ.DLA=REQ.DLA;
      644     3466    2           REPOS$->REQ.COMP=%COMP_IOS;
      645     3467    2           RETURN;
      646     3468    2   REPOST:
      647     3469    2           ALTRETURN;
      648     3470    2   END GETRTY;
      649     3471        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:23   
      650     3472    1   RELCHAN: PROC;
      651     3473    2           DQH.STATE=%IDLE;
      652     3474    2           DQH.MREC='0'B;
      653     3475    3           IF DQH.CHANSTATE THEN DO;
      654     3476    4              IF DQH.CHANSTATE.STOP THEN DO;
      655     3477                      %UNLOCK (G#=SQH.GATE);
      656     3480    4                 CALL NIW$MPCSTOP(DQH.MPC$->DCT);
      657     3481                      %LOCK (G#=SQH.GATE);
      658     3484    4                 END;
      659     3485    3              END;
      660     3486    3           ELSE IF NOT DQH.STATUS.DOWN THEN DO;
      661     3487                      %ENQUEUE (P#=DQH,Q#=SQH.CQ$);
      662     3490    3                 END;
      663     3491    2           RETURN;
      664     3492    2   END RELCHAN;
      665     3493        /**/
      666     3494        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:24   
      667     3495    1   BGNFREPOS: PROC ALTRET;
      668     3496        /**/
      669     3497    2   DCL P$ PTR;
      670     3498        /**/
      671     3499    3           IF DCT.MT.FREPOS$=ADDR(NIL) THEN DO;
      672     3500    3              CALL NIQ$GET(P$) ALTRET(REPOST);
      673     3501    3              DCT.MT.FREPOS$=P$;
      674     3502    3              END;
      675     3503    3           ELSE DO;
      676     3504    3              P$=DCT.MT.FREPOS$;
      677     3505    3              END;
      678     3506    2           P$->REQ.COMP=%COMP_FREPOS;
      679     3507    2           P$->REQ.POSTER=%FREPOS_REWIND;
      680     3508    2           P$->REQ.FC=%N_REWIND;
      681     3509    2           P$->REQ.DLA=REQ.DLA;
      682     3510    2           CALL NIO$DCWBLD(P$->REQ) ALTRET(REPOST);
      683     3511    2           RETURN;
      684     3512    2   REPOST: ALTRETURN;
      685     3513    2   END BGNFREPOS;
      686     3514        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:25   
      687     3515    1   UPDATE_POS: PROC;
      688     3516    3           DO CASE(REQ.FC);
      689     3517    3            CASE(%N_RDBIN,%N_WRBIN,%N_RDASC,%N_WRASC,%N_READ,%N_WRITE);
      690     3518    4              IF REQ.TYC.EOF THEN DO;
      691     3519    4                 DCT.MT.POS.FILECNT=DCT.MT.POS.FILECNT+1;
      692     3520    4                 DCT.MT.POS.LRECCNT=DCT.MT.POS.CRECCNT;
      693     3521    4                 DCT.MT.LVALID=~DCT.MT.PLOST;
      694     3522    4                 DCT.MT.POS.CRECCNT=0;
      695     3523    4                 END;
      696     3524    4              ELSE DO;
      697     3525    4                 DCT.MT.POS.CRECCNT=DCT.MT.POS.CRECCNT+1;
      698     3526    4                 END;
      699     3527    3            CASE(%N_REWIND,%N_UNLOAD,%N_LDTAPE);
      700     3528    3              DCT.MT.POS='0'B;
      701     3529    3              DCT.MT.LVALID='0'B;
      702     3530    3              DCT.MT.PLOST='0'B;
      703     3531    3            CASE(%N_DCWLIST);
      704     3532    3              DCT.MT.PLOST='1'B;
      705     3533    3            CASE(%N_WRFM);
      706     3534    3              DCT.MT.POS.FILECNT=DCT.MT.POS.FILECNT+1;
      707     3535    3              DCT.MT.POS.LRECCNT=DCT.MT.POS.CRECCNT;
      708     3536    3              DCT.MT.LVALID=~DCT.MT.PLOST;
      709     3537    3              DCT.MT.POS.CRECCNT=0;
      710     3538    3              DCT.MT.PLOST='1'B;
      711     3539    3            CASE(%N_SPREC,%N_SPFILE);
      712     3540    3              I=REQ.IOS$->IOS.IDCW.RCNT(0)-REQ.STATUS.RCR;
      713     3541    4              IF REQ.RCT<0 THEN DO;
      714     3542    5                 IF REQ.TYC.BOT THEN DO;
      715     3543    5                    DCT.MT.POS='0'B;
      716     3544    5                    DCT.MT.PLOST='0'B;
      717     3545    5                    DCT.MT.LVALID='0'B;
      718     3546    5                    END;
      719     3547    5                 ELSE IF REQ.TYC.EOF THEN DO;
      720     3548    5                       DCT.MT.POS.FILECNT=DCT.MT.POS.FILECNT-1;
      721     3549    5                       DCT.MT.POS.CRECCNT=DCT.MT.POS.LRECCNT;
      722     3550    5                       DCT.MT.PLOST=~DCT.MT.LVALID;
      723     3551    5                       DCT.MT.LVALID='0'B;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:26   
      724     3552    5                       END;
      725     3553    5                    ELSE DO;
      726     3554    5                       DCT.MT.POS.CRECCNT=DCT.MT.POS.CRECCNT-I;
      727     3555    5                       END;
      728     3556    4                 END;
      729     3557    4              ELSE DO;
      730     3558    5                 IF REQ.TYC.EOF THEN DO;
      731     3559    5                    DCT.MT.POS.FILECNT=DCT.MT.POS.FILECNT+1;
      732     3560    5                    DCT.MT.POS.LRECCNT=DCT.MT.POS.CRECCNT;
      733     3561    5                    DCT.MT.LVALID=~DCT.MT.PLOST;
      734     3562    5                    DCT.MT.POS.CRECCNT=0;
      735     3563    5                    DCT.MT.PLOST='0'B;
      736     3564    5                    END;
      737     3565    5                 ELSE DO;
      738     3566    5                    DCT.MT.POS.CRECCNT=DCT.MT.POS.CRECCNT+I;
      739     3567    5                    END;
      740     3568    4                 END;
      741     3569    3            END;
      742     3570    2   END UPDATE_POS;
      743     3571        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:27   
      744     3572    1   CHECK_DONE: PROC ALTRET;
      745     3573    2   DCL ERRBITS BIT(36) CONSTANT ALIGNED INIT(%(TYC_OPER|TYC_BLNKTP|TYC_IOERR|TYC_MTRAP|
              3573            TYC_TIMO|TYC_FRAW));
      746     3574        /**/
      747     3575    2   DCL IOCHANX UBIN;
      748     3576    2   DCL I SBIN;
      749     3577    2   DCL J SBIN;
      750     3578        /**/
      751     3579        /*  SOME TAPE COMMANDS REQUIRE SEVERAL I/OS TO GET THEM COMPLETED.
      752     3580            THIS ROUTINE CHECKS THESE COMMANDS FOR COMPLETION AND ALTRETURNS
      753     3581            IF THEY ARE NOT DONE AFTER SETTING UP THE REQUEST TO PERFORM
      754     3582            THE NEXT STEP.  IT ALSO SAVES THE DENSITY SET FOR THE DEVICE.  */
      755     3583        /**/
      756     3584    3           DO CASE(REQ.FC);
      757     3585    3            CASE(%N_SPREC);
      758     3586    3              REQ.ARCT=REQ.ARCT+REQ.IOS$->IOS.IDCW.RCNT(0)-REQ.STATUS.RCR;
      759     3587    3              IF REQ.RCT<0 THEN I=-REQ.RCT;
      760     3588    3              ELSE I=REQ.RCT;
      761     3589    4              IF NOT (REQ.TYC & (ERRBITS|%TYC_EOF|%TYC_BOT)) AND REQ.ARCT~=I THEN DO;
      762     3590    4                 IF I-REQ.ARCT<63 THEN REQ.IOS$->IOS.IDCW.RCNT(0)=I-REQ.ARCT;
      763     3591    4                 RCVR.RETRY='1'B;
      764     3592    4                 ALTRETURN;
      765     3593    4                 END;
      766     3594    4              ELSE DO;
      767     3595    4                 IF REQ.TYC.EOF THEN REQ.ARCT=REQ.ARCT-1;
      768     3596    5                 ELSE IF REQ.TYC.BOT THEN DO;
      769     3597    5                       IF REQ.STATUS.MAJOR=0 THEN REQ.ARCT=REQ.ARCT-1;
      770     3598    5                       ELSE REQ.ARCT=REQ.ARCT-2;
      771     3599    5                       END;
      772     3600    4                 IF REQ.ARCT<0 THEN REQ.ARCT=0;
      773     3601    4                 REQ.ARSIZE=REQ.ARCT;
      774     3602    4                 IF REQ.TYC.BOT AND DCT.FIPS THEN
      775     3603    4                    RCVR.SETDENS='1'B;
      776     3604    4                 END;
      777     3605    3            CASE(%N_SPFILE);
      778     3606    3              IF REQ.TYC.EOF THEN REQ.ARCT=REQ.ARCT+1;
      779     3607    3              IF REQ.RCT<0 THEN I=-REQ.RCT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:28   
      780     3608    3              ELSE I=REQ.RCT;
      781     3609    4              IF NOT (REQ.TYC & (ERRBITS|%TYC_BOT)) AND REQ.ARCT~=I THEN DO;
      782     3610    4                 RCVR.RETRY='1'B;
      783     3611    4                 ALTRETURN;
      784     3612    4                 END;
      785     3613    4              ELSE DO;
      786     3614    4                 REQ.ARSIZE=REQ.ARCT;
      787     3615    4                 IF REQ.TYC.BOT AND DCT.FIPS THEN
      788     3616    4                    RCVR.SETDENS='1'B;
      789     3617    4                 END;
      790     3618    3            CASE(%N_SD800,%N_SD1600,%N_SD6250);
      791     3619                                      /* keeps track of current density for device */
      792     3620    3              DCT.MT.CURDENS=REQ.FC;
      793     3621                   /*N*  The following code handles a maximum of two physical channels
      794     3622                         per FIPS tape subsystem:  either two physical channels
      795     3623                         connected to one controller or two controllers, each  having
      796     3624                         a single physical channel.  (This is done by setting FIPS_DENS_DONE
      797     3625                         to '0'B prior to the first set density command and setting
      798     3626                         it to '1'B when the second path is found.  End action of the
      799     3627                         second IO will reset this mechanism.)
      800     3628
      801     3629                         If more physical paths need to be supported, the mechanism
      802     3630                         will have to be changed such that each path contains a flag
      803     3631                         that gets set when it has been "densitized";  when all paths
      804     3632                         are done, all the flags must be cleared.
      805     3633                       */
      806     3634    4              IF DQH.MPC$->DCT.FIPS AND NOT REQ.FIPS_DENS_DONE THEN DO;
      807     3635    5                 DO J = 0 TO 1;
      808     3636    6                    IF DQH.SQH$->SQH.MPC$(J) ~= ADDR(NIL) THEN DO;
      809     3637    7                       DO I = 0 TO %N_CHANSPERMPC-1;
      810     3638    7                          IOCHANX=DQH.SQH$->SQH.MPC$(J)->DCT.MPC.IOCHANX(I);
      811     3639    8                          IF IOCHANX > 0 THEN DO;
      812     3640    8                             IF (NI$CHT.DQH$(IOCHANX)->DQH.LA~=DQH.LA OR
      813     3641    8                               NI$CHT.DQH$(IOCHANX)->DQH.MPC$~=DQH.MPC$) AND
      814     3642    9                               NOT NI$CHT.DQH$(IOCHANX)->DQH.STATUS.DOWN THEN DO;
      815     3643    9                                REQ.FIPS_DENS_DONE='1'B;
      816     3644    9                                REQ.DQH$=NI$CHT.DQH$(IOCHANX);
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:29   
      817     3645    9                                RCVR.RETRY='1'B;
      818     3646    9                                ALTRETURN;
      819     3647    9                                END;
      820     3648    8                             END;
      821     3649    7                          END;
      822     3650    6                       END;
      823     3651    5                    END;
      824     3652    4                 END;
      825     3653    3              REQ.FIPS_DENS_DONE='0'B;
      826     3654    3            CASE(%N_REWIND);
      827     3655    3              IF DCT.FIPS THEN
      828     3656    3                 RCVR.SETDENS='1'B;
      829     3657    3            END;
      830     3658    3           IF RCVR.SETDENS THEN DO;
      831     3659    4              CALL SETDENS WHENRETURN DO;
      832     3660    4                 DCT.MT.SETDENS$=SETDENS$;
      833     3661    4                 SETDENS$=ADDR(NIL);
      834     3662    4                 END;
      835     3663    3              RCVR.SETDENS='0'B;
      836     3664    3              END;
      837     3665    2           RETURN;
      838     3666    2   END CHECK_DONE;
      839     3667        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:30   
      840     3668    1   SETDENS: PROC ALTRET;
      841     3669
      842     3670    3           CALL NIQ$GET(SETDENS$) WHENALTRETURN DO;
      843     3671    3              ALTRETURN;
      844     3672    3              END;
      845     3673    2           SETDENS$->REQ.FC=DCT.MT.CURDENS;
      846     3674    2           SETDENS$->REQ.DLA.DCTX=DCT.DCTX;
      847     3675    2           SETDENS$->REQ.DQH$=DQH$;
      848     3676    2           SETDENS$->REQ.COMP=%COMP_SETDENS;
      849     3677    3           CALL NIO$DCWBLD(SETDENS$->REQ) WHENALTRETURN DO;
      850     3678    3              CALL NIQ$REL(SETDENS$);
      851     3679    3              ALTRETURN;
      852     3680    3              END;
      853     3681    2           RETURN;
      854     3682    2   END SETDENS;
      855     3683    1   END NIT$POSTER;
      856     3684        %EOD;

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:31   
--  Include file information  --

   PM$NI.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   N_FC_C.:E05TOU  is referenced.
   NI_MACROS_C.:E05TOU  cannot be made into a system file and is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   NI$ERRLOG.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   HF_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FR$RAT.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure NIT$POSTER.

   Procedure NIT$POSTER requires 2021 words for executable code.
   Procedure NIT$POSTER requires 40 words of local(AUTO) storage.

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:32   

 Object Unit name= NIT$POSTER                                 File name= NIT$TAPE.:E05TOU
 UTS= JUL 30 '97 03:37:53.12 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      4      4  NIT$POSTER
    1   Proc  even  none  2021   3745  NIT$POSTER
    2  RoData even  none    27     33  NIT$POSTER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        3  NIT$POSTER
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:33   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 HFC$LOCK
         yes           Std       4 NIA$SPURINT
         yes           Std       1 HFC$UNLOCK
         yes           Std       2 NIS$MASK
         yes           Std       2 NIM$REQUEUE
         yes           Std       3 PMN$COLLECT
         yes           Std       1 OCI$MK_STTM
         yes           Std       1 NIW$MPCSTOP
 yes     yes           Std       1 NIQ$REL
 yes     yes           Std       1 NIQ$GET
         yes           Std       1 NIO$SPCOMP
 yes     yes           Std       2 NIW$LDFW
 yes     yes           Std       2 NIF$ANIOM
 yes     yes           Std       3 NIF$ANFAULT
         yes           Std       2 NIO$COMP
         yes           Std       2 NIT$DEVSCHED
         yes           Std       2 NIT$DEVSCHEDL
         yes           Std       4 NIA$LOGERR
         yes           Std       5 NIK$OPMSG
 yes     yes           Std       1 NIO$DCWBLD
         yes           Std       2 NIM$ENQUEUE
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:34   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     HW_IOP                                HW_EXT_STATUS                         HW_IMX
     N$DCT$$                               N$FQ$                                 NI$CHT$
     NI$FQ$                                NI$IBUF$                              NI$RP$
     NI_DBLZERO                            B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:35   


        1        1        /*M* NIT$TAPE - MAG TAPE HANDLER */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR */
        8        8        NIT$POSTER: PROC(PAR,INTLVL,STATUS);

      8  1 000000   000000 700200 xent  NIT$POSTER   TSX0  ! X66_AUTO_3
         1 000001   000050 000003                    ZERO    40,3

        9        9        /*D*  NAME:   NIT$POSTER
       10       10              INTERFACE:  NIT$DEVSCHED
       11       11                          NIO$SPCOMP
       12       12                          NIO$COMP
       13       13                          NIK$OPMSG
       14       14                          NIF$ANMPC
       15       15                          NIQ$RELS
       16       16                          NIQ$GETS
       17       17                          NIS$MASK
       18       18              ENVIRONMENT:    MONITOR LINKAGE SEGMENT
       19       19              INPUT:  N$DCT - Device control table
       20       20                      NI$REQ - IOS request packet
       21       21                      NI$DQH - Driver queue header
       22       22                      NI$SQH - Scheduler queue header
       23       23              DESCRIPTION:
       24       24                  This routine handles all fault channel, terminate, marker (do
       25       25              nothing) and special interrupts from mag tapes.  It is also called
       26       26              by the lost interrupt poller to handle lost interrupts and to
       27       27              repost defered packets.
       28       28        */
       29       29        /*
       30       30              Includes
       31       31        */
       32       32        %INCLUDE                CP_6_SUBS ;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:36   
       33      572        %INCLUDE                EL_SUBS_C ;
       34      656        %INCLUDE                FR$RAT ;
       35      709        %INCLUDE                HF_DATA_R ;
       36      752        %INCLUDE                HF_LOCK_C ;
       37      766        %INCLUDE                NI$ERRLOG ;
       38      832        %INCLUDE                NI_DATA_C ;
       39      945        %INCLUDE                NI_DATA_R ;
       40     1382        %INCLUDE                NI_MACROS_C ;
       41     1649        %INCLUDE                N_FC_C ;
       42     1686        %INCLUDE                OC_SUBS_C ;
       43     2417        %INCLUDE                PM$NI ;
       44     2441        /*
       45     2442              Parameters
       46     2443        */
       47     2444    1   DCL 1 INTLVL          UBIN(18) PARAM ;
       48     2445    1   DCL 1 PAR             SBIN PARAM ;
       49     2446        %STATUS               ( NAME=STATUS, STCLASS=PARAM ) ;
       50     2513        /*
       51     2514              Entries
       52     2515        */
       53     2516    1   DCL 1 NIA$LOGERR        ENTRY(4) ;
       54     2517    1   DCL 1 NIA$SPURINT       ENTRY(4) ;
       55     2518    1   DCL 1 NIO$SPCOMP        ENTRY(1) ;
       56     2519    1   DCL 1 NIO$COMP          ENTRY(2) ;
       57     2520    1   DCL 1 NIO$DCWBLD        ENTRY(1) ALTRET ;
       58     2521    1   DCL 1 NIK$OPMSG         ENTRY(5) ;
       59     2522    1   DCL 1 NIF$ANFAULT       ENTRY(3) ALTRET ;
       60     2523    1   DCL 1 NIF$ANIOM         ENTRY(2) ALTRET ;
       61     2524    1   DCL 1 NIQ$REL           ENTRY(1) ALTRET ;
       62     2525    1   DCL 1 NIQ$GET           ENTRY(1) ALTRET ;
       63     2526    1   DCL 1 NIS$MASK          ENTRY(2) ;
       64     2527    1   DCL 1 NIT$DEVSCHED      ENTRY(2) ;
       65     2528    1   DCL 1 NIT$DEVSCHEDL     ENTRY(2) ;
       66     2529    1   DCL 1 NIW$LDFW          ENTRY(2) ALTRET ;
       67     2530    1   DCL 1 NIW$MPCSTOP       ENTRY(1) ;
       68     2531    1   DCL 1 OCI$MK_STTM       ENTRY(1) ;
       69     2532    1   DCL 1 PMN$COLLECT       ENTRY(3) ;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:37   
       70     2533        /*
       71     2534              Auto
       72     2535        */
       73     2536    1   DCL 1 CHANTIME          SBIN ALIGNED AUTO ;
       74     2537    1   DCL 1 DCT$              PTR ALIGNED AUTO ;
       75     2538    1   DCL 1 DQH$              PTR ALIGNED AUTO ;
       76     2539    1   DCL 1 EXTST$            PTR ALIGNED AUTO ;
       77     2540    1   DCL 1 I                 SBIN ALIGNED AUTO ;
       78     2541    1   DCL 1 IOS$              PTR ALIGNED AUTO ;
       79     2542    1   DCL 1 MNSTAT(0:5)       BIT(1) UNAL AUTO ;
       80     2543    1   DCL 1 NEWSTATE          UBIN ALIGNED AUTO ;
       81     2544        %NI$EXTST               ( NAME=NI$EXTST, STCLASS=AUTO ) ;
       82     2578    1   DCL 1 RCVR              ALIGNED AUTO,
       83     2579    1         2 RETRY           BIT(1),
       84     2580    1         2 REPOS           BIT(1),
       85     2581    1         2 NOINC           BIT(1),
       86     2582    1         2 LOGERR          BIT(1),
       87     2583    1         2 FREPOS          BIT(1),
       88     2584    1         2 OPMSG           BIT(1),
       89     2585    1         2 NEWCH           BIT(1),
       90     2586    1         2 EXTST           BIT(1),
       91     2587    1         2 EOT             BIT(1),
       92     2588    1         2 SETDENS         BIT(1),
       93     2589    1         2 *               BIT(26);
       94     2590    1   DCL 1 REQ$              PTR ALIGNED AUTO ;
       95     2591    1   DCL 1 REPOS$            PTR ALIGNED AUTO ;
       96     2592    1   DCL 1 SETDENS$          PTR ALIGNED AUTO ;
       97     2593    1   DCL 1 SQH$              PTR ALIGNED AUTO ;
       98     2594        /*
       99     2595              Based
      100     2596        */
      101     2597        %NI$DCT                 ( NAME=DCT, STCLASS="BASED(DCT$)" ) ;
      102     2645        %NI$DQH                 ( NAME=DQH, STCLASS="BASED(DQH$)" ) ;
      103     2668        %NI$IOM                 ( NAME=IOM ) ;
      104     2673        %NI$REQ                 ( NAME=IOS, STCLASS="BASED(IOS$)" ) ;
      105     2698        %NI$IOSTAT              ( NAME=IOSTAT ) ;
      106     2707        %NI$MBX                 ( NAME=MBX, STCLASS=BASED ) ;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:38   
      107     2726        %NI$CHT ;
      108     2729        %NI$IOERR               ( NAME=NI$IOERR, STCLASS=BASED ) ;
      109     2783        %FR$RAT                 ( NAME=RAT, STCLASS=BASED ) ;
      110     2823        %N$REQ                  ( NAME=REQ, STCLASS="BASED(REQ$)" ) ;
      111     2881        %NI$SQH                 ( NAME=SQH, STCLASS="BASED(SQH$)" ) ;
      112     2894        /*
      113     2895              Constants
      114     2896        */
      115     2897        %SUB RETRY#='400'O;
      116     2898        %SUB REPOS#='200'O;
      117     2899        %SUB NOINC#='100'O;
      118     2900        %SUB LOGERR#='040'O;
      119     2901        %SUB FREPOS#='020'O;
      120     2902        %SUB OPMSG#='010'O;
      121     2903        %SUB NEWCH#='004'O;
      122     2904        %SUB EXTST#='002'O;
      123     2905        %SUB EOT#='001'O;
      124     2906        %SUB SETDENS#='0004'O;
      125     2907        /**/
      126     2908        %SUB NEVER="WHILE ('0'B)";
      127     2909        %SUB FOREVER="WHILE ('1'B)";
      128     2910        /**/
      129     2911        %SUB RTY_READ_SRB=1;
      130     2912        %SUB RTY_WRITE_SRB=2;
      131     2913        %SUB RTY_WRITE_SRF=3;
      132     2914        %SUB RTY_WRITE_ERASE=4;
      133     2915        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:39   
      134     2916    2           DO INHIBIT;

      135     2917        /*    DQH$, REQ$ and DCT$ are set up based on the value of INTLVL. */
      136     2918    3              DO CASE (INTLVL);

   2918  1 000002   200004 470700                    LDP0  ! @INTLVL,,AUTO
         1 000003   000000 220300                    LDX0  ! 0,,PR0
         1 000004   000006 100203                    CMPX0 ! 6,DU
         1 000005   000007 602210 1                  TNC   ! s:2918+5,X0
         1 000006   000554 710200 1                  TRA   ! s:3038
         1 000007   000015 710200 1                  TRA   ! s:2920
         1 000010   000015 710200 1                  TRA   ! s:2920
         1 000011   000270 710200 1                  TRA   ! s:2976
         1 000012   000325 710200 1                  TRA   ! s:2983
         1 000013   000015 710200 1                  TRA   ! s:2920
         1 000014   000537 710200 1                  TRA   ! s:3030

      137     2919    3               CASE(%OVERHEAD,%TERMINATE,%LOST);

      138     2920    3                 DQH$=ADDR(PAR);

   2920  1 000015   200003 236300                    LDQ   ! @PAR,,AUTO
         1 000016   200010 756300                    STQ   ! DQH$,,AUTO

      139     2921    3                 SQH$=DQH.SQH$;

   2921  1 000017   200010 471700                    LDP1  ! DQH$,,AUTO
         1 000020   100013 236300                    LDQ   ! 11,,PR1
         1 000021   200032 756300                    STQ   ! SQH$,,AUTO

      140     2922                      %LOCK (G#=SQH.GATE);

   2923  1 000022   200032 630700                    EPPR0 ! SQH$,,AUTO
         1 000023   000017 631600 xsym               EPPR1 ! B_VECTNIL+15
         1 000024   000000 701200 xent               TSX1  ! HFC$LOCK
         1 000025   000000 011200                    NOP   ! 0

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:40   
      141     2925    3                 IF  DQH.STATE ~= %BUSY

   2925  1 000026   200010 470700                    LDP0  ! DQH$,,AUTO
         1 000027   000001 236300                    LDQ   ! 1,,PR0
         1 000030   000077 376207                    ANQ   ! 63,DL
         1 000031   000005 116207                    CMPQ  ! 5,DL
         1 000032   000112 600200 1                  TZE   ! s:2941

      142     2926    4                 THEN DO ;

      143     2927    4                    IF  ADDR(STATUS) ~= ADDR(NIL)

   2927  1 000033   200005 236300                    LDQ   ! @STATUS,,AUTO
         1 000034   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
         1 000035   000050 600200 1                  TZE   ! s:2930

      144     2928    4                    THEN
      145     2929    4                       CALL NIA$SPURINT ( DQH, EL_SPURINT, INTLVL, STATUS ) ;

   2929  1 000036   200004 237300                    LDAQ  ! @INTLVL,,AUTO
         1 000037   200044 757300                    STAQ  ! J+5,,AUTO
         1 000040   000001 236200 2                  LDQ   ! 1
         1 000041   200010 235300                    LDA   ! DQH$,,AUTO
         1 000042   200042 757300                    STAQ  ! J+3,,AUTO
         1 000043   200042 630700                    EPPR0 ! J+3,,AUTO
         1 000044   000022 631600 xsym               EPPR1 ! B_VECTNIL+18
         1 000045   000000 701200 xent               TSX1  ! NIA$SPURINT
         1 000046   000000 011200                    NOP   ! 0
         1 000047   000105 710200 1                  TRA   ! s:2937

      146     2930    4                    ELSE IF  INTLVL = %TERMINATE

   2930  1 000050   200004 471700                    LDP1  ! @INTLVL,,AUTO
         1 000051   100000 220300                    LDX0  ! 0,,PR1
         1 000052   000001 100203                    CMPX0 ! 1,DU
         1 000053   000073 601200 1                  TNZ   ! s:2935
         1 000054   000016 236300                    LDQ   ! 14,,PR0
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:41   
         1 000055   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
         1 000056   000073 600200 1                  TZE   ! s:2935

      147     2931    4                         AND DQH.IOSTATUS$ ~= ADDR(NIL)
      148     2932    4                       THEN
      149     2933    4                          CALL NIA$SPURINT ( DQH, EL_SPURINT, INTLVL, DQH.IOSTATUS$->
              2933                                   IOSTAT.STATUS ) ;

   2933  1 000057   000016 473700                    LDP3  ! 14,,PR0
         1 000060   200045 453700                    STP3  ! J+6,,AUTO
         1 000061   200004 236300                    LDQ   ! @INTLVL,,AUTO
         1 000062   200044 756300                    STQ   ! J+5,,AUTO
         1 000063   000001 236200 2                  LDQ   ! 1
         1 000064   200010 235300                    LDA   ! DQH$,,AUTO
         1 000065   200042 757300                    STAQ  ! J+3,,AUTO
         1 000066   200042 630700                    EPPR0 ! J+3,,AUTO
         1 000067   000022 631600 xsym               EPPR1 ! B_VECTNIL+18
         1 000070   000000 701200 xent               TSX1  ! NIA$SPURINT
         1 000071   000000 011200                    NOP   ! 0
         1 000072   000105 710200 1                  TRA   ! s:2937

      150     2934    4                       ELSE
      151     2935    4                          CALL NIA$SPURINT ( DQH, EL_SPURINT, INTLVL, NI_DBLZERO ) ;

   2935  1 000073   000002 236200 2                  LDQ   ! 2
         1 000074   200004 235300                    LDA   ! @INTLVL,,AUTO
         1 000075   200044 757300                    STAQ  ! J+5,,AUTO
         1 000076   000001 236200 2                  LDQ   ! 1
         1 000077   200010 235300                    LDA   ! DQH$,,AUTO
         1 000100   200042 757300                    STAQ  ! J+3,,AUTO
         1 000101   200042 630700                    EPPR0 ! J+3,,AUTO
         1 000102   000022 631600 xsym               EPPR1 ! B_VECTNIL+18
         1 000103   000000 701200 xent               TSX1  ! NIA$SPURINT
         1 000104   000000 011200                    NOP   ! 0

      152     2936                         %UNLOCK ( G#=SQH.GATE ) ;

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:42   
   2937  1 000105   200032 630700                    EPPR0 ! SQH$,,AUTO
         1 000106   000017 631600 xsym               EPPR1 ! B_VECTNIL+15
         1 000107   000000 701200 xent               TSX1  ! HFC$UNLOCK
         1 000110   000000 011200                    NOP   ! 0

      153     2939    4                    RETURN ;

   2939  1 000111   000000 702200 xent               TSX2  ! X66_ARET

      154     2940    4                    END ;
      155     2941    3                 REQ$=DQH.IO$;

   2941  1 000112   000014 236300                    LDQ   ! 12,,PR0
         1 000113   200027 756300                    STQ   ! REQ$,,AUTO

      156     2942    3                 DCT$=REQ.DCT$;

   2942  1 000114   200027 471700                    LDP1  ! REQ$,,AUTO
         1 000115   100002 236300                    LDQ   ! 2,,PR1
         1 000116   200007 756300                    STQ   ! DCT$,,AUTO

      157     2943    3                 CALL PMN$COLLECT(DQH.PM,%PM_IDLE,CHANTIME);

   2943  1 000117   200006 633700                    EPPR3 ! CHANTIME,,AUTO
         1 000120   200044 453700                    STP3  ! J+5,,AUTO
         1 000121   000003 236200 2                  LDQ   ! 3
         1 000122   200043 756300                    STQ   ! J+4,,AUTO
         1 000123   200010 236300                    LDQ   ! DQH$,,AUTO
         1 000124   000002 036203                    ADLQ  ! 2,DU
         1 000125   200042 756300                    STQ   ! J+3,,AUTO
         1 000126   200042 630700                    EPPR0 ! J+3,,AUTO
         1 000127   000021 631600 xsym               EPPR1 ! B_VECTNIL+17
         1 000130   000000 701200 xent               TSX1  ! PMN$COLLECT
         1 000131   000000 011200                    NOP   ! 0

      158     2944    3                 IF HW_IMX THEN

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:43   
   2944  1 000132   000000 234200 xsym               SZN   ! HW_IMX
         1 000133   000142 605200 1                  TPL   ! s:2947

      159     2945    3                    REQ.FLPW=DQH.IOSTATUS$->IOSTAT.LPW_RESIDUE;

   2945  1 000134   200010 470700                    LDP0  ! DQH$,,AUTO
         1 000135   000016 471700                    LDP1  ! 14,,PR0
         1 000136   100003 236300                    LDQ   ! 3,,PR1
         1 000137   200027 473700                    LDP3  ! REQ$,,AUTO
         1 000140   300016 756300                    STQ   ! 14,,PR3
         1 000141   000147 710200 1                  TRA   ! s:2948

      160     2946    3                 ELSE
      161     2947    3                    REQ.FLPW=DQH.MBX$->MBX.LPW;

   2947  1 000142   200010 470700                    LDP0  ! DQH$,,AUTO
         1 000143   000021 471700                    LDP1  ! 17,,PR0
         1 000144   100000 236300                    LDQ   ! 0,,PR1
         1 000145   200027 473700                    LDP3  ! REQ$,,AUTO
         1 000146   300016 756300                    STQ   ! 14,,PR3

      162     2948    4                 IF INTLVL=%TERMINATE THEN DO;

   2948  1 000147   200004 471700                    LDP1  ! @INTLVL,,AUTO
         1 000150   100000 220300                    LDX0  ! 0,,PR1
         1 000151   000001 100203                    CMPX0 ! 1,DU
         1 000152   000176 601200 1                  TNZ   ! s:2960

      163     2949    4                    REQ.STATUS=DQH.IOSTATUS$->IOSTAT.STATUS;

   2949  1 000153   000016 473700                    LDP3  ! 14,,PR0
         1 000154   300000 237300                    LDAQ  ! 0,,PR3
         1 000155   200027 474700                    LDP4  ! REQ$,,AUTO
         1 000156   400014 757300                    STAQ  ! 12,,PR4

      164     2950    4                    IF HW_IOP THEN    /* ignore IOP generated lost interrupt */

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:44   
   2950  1 000157   000000 234200 xsym               SZN   ! HW_IOP
         1 000160   000216 605200 1                  TPL   ! s:2965

      165     2951    4                       IF REQ.STATUS.MAJOR = %READY AND

   2951  1 000161   200027 473700                    LDP3  ! REQ$,,AUTO
         1 000162   300014 236300                    LDQ   ! 12,,PR3
         1 000163   170000 316203                    CANQ  ! 61440,DU
         1 000164   000216 601200 1                  TNZ   ! s:2965
         1 000165   300014 236300                    LDQ   ! 12,,PR3
         1 000166   700000 376207                    ANQ   ! -32768,DL
         1 000167   400000 116207                    CMPQ  ! -131072,DL
         1 000170   000216 601200 1                  TNZ   ! s:2965

      166     2952    5                         REQ.STATUS.IOM.CHANNEL = %LOSTINT THEN DO;

      167     2953                               %UNLOCK (G#=SQH.GATE);

   2954  1 000171   200032 630700                    EPPR0 ! SQH$,,AUTO
         1 000172   000017 631600 xsym               EPPR1 ! B_VECTNIL+15
         1 000173   000000 701200 xent               TSX1  ! HFC$UNLOCK
         1 000174   000000 011200                    NOP   ! 0

      168     2956    5                          RETURN;

   2956  1 000175   000000 702200 xent               TSX2  ! X66_ARET

      169     2957    5                          END;
      170     2958    4                    END;
      171     2959    4                 ELSE DO;

      172     2960    4                    REQ.STATUS=STATUS;

   2960  1 000176   200005 473700                    LDP3  ! @STATUS,,AUTO
         1 000177   300000 237300                    LDAQ  ! 0,,PR3
         1 000200   200027 474700                    LDP4  ! REQ$,,AUTO
         1 000201   400014 757300                    STAQ  ! 12,,PR4
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:45   

      173     2961    5                    IF REQ.STATUS.MAJOR=%LOST_INTERRUPT THEN DO;

   2961  1 000202   200027 474700                    LDP4  ! REQ$,,AUTO
         1 000203   400014 236300                    LDQ   ! 12,,PR4
         1 000204   170000 376203                    ANQ   ! 61440,DU
         1 000205   100000 116203                    CMPQ  ! 32768,DU
         1 000206   000216 601200 1                  TNZ   ! s:2965

      174     2962    5                       CALL NIS$MASK(DQH,%IMX_CCW_MASK_CHAN);

   2962  1 000207   000004 236200 2                  LDQ   ! 4
         1 000210   200010 235300                    LDA   ! DQH$,,AUTO
         1 000211   200042 757300                    STAQ  ! J+3,,AUTO
         1 000212   200042 630700                    EPPR0 ! J+3,,AUTO
         1 000213   000020 631600 xsym               EPPR1 ! B_VECTNIL+16
         1 000214   000000 701200 xent               TSX1  ! NIS$MASK
         1 000215   000000 011200                    NOP   ! 0

      175     2963    5                       END;

      176     2964    4                    END;

      177     2965    3                 NI$EXTST.EXTST=DQH.IOSTATUS$->IOSTAT.EXTST;
              2965                          /* MEANINGFUL FOR IOP/IMX */

   2965  1 000216   200010 470700                    LDP0  ! DQH$,,AUTO
         1 000217   000016 471700                    LDP1  ! 14,,PR0
         1 000220   000100 100700                    MLR   ! fill='000'O
         1 000221   100010 000040                    ADSC9   8,,PR1                   cn=0,n=32
         1 000222   200016 000040                    ADSC9   NI$EXTST,,AUTO           cn=0,n=32

      178     2966    3                 IF REQ.IOFLG.REL THEN DQH.MPC$->DCT.DFLG.MPCSUSPENDED='0'B;

   2966  1 000223   200027 471700                    LDP1  ! REQ$,,AUTO
         1 000224   100004 236300                    LDQ   ! 4,,PR1
         1 000225   002000 316207                    CANQ  ! 1024,DL
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:46   
         1 000226   000232 600200 1                  TZE   ! s:2967

   2966  1 000227   000015 473700                    LDP3  ! 13,,PR0
         1 000230   000005 236200 2                  LDQ   ! 5
         1 000231   300006 356300                    ANSQ  ! 6,,PR3

      179     2967    3                 CALL RELCHAN;

   2967  1 000232   002736 701200 1                  TSX1  ! RELCHAN
         1 000233   000000 011200                    NOP   ! 0

      180     2968                      %UNLOCK (G#=SQH.GATE);

   2969  1 000234   200032 630700                    EPPR0 ! SQH$,,AUTO
         1 000235   000017 631600 xsym               EPPR1 ! B_VECTNIL+15
         1 000236   000000 701200 xent               TSX1  ! HFC$UNLOCK
         1 000237   000000 011200                    NOP   ! 0

      181     2971    3                 IF DCT.SQ$=ADDR(NIL) THEN

   2971  1 000240   200007 470700                    LDP0  ! DCT$,,AUTO
         1 000241   000001 236300                    LDQ   ! 1,,PR0
         1 000242   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
         1 000243   000256 601200 1                  TNZ   ! s:2974

      182     2972    3                    CALL PMN$COLLECT(DCT.PM,%PM_IDLE);

   2972  1 000244   000003 236200 2                  LDQ   ! 3
         1 000245   200043 756300                    STQ   ! J+4,,AUTO
         1 000246   200007 236300                    LDQ   ! DCT$,,AUTO
         1 000247   000010 036203                    ADLQ  ! 8,DU
         1 000250   200042 756300                    STQ   ! J+3,,AUTO
         1 000251   200042 630700                    EPPR0 ! J+3,,AUTO
         1 000252   000020 631600 xsym               EPPR1 ! B_VECTNIL+16
         1 000253   000000 701200 xent               TSX1  ! PMN$COLLECT
         1 000254   000000 011200                    NOP   ! 0
         1 000255   000554 710200 1                  TRA   ! s:3038
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:47   

      183     2973    3                 ELSE
      184     2974    3                    CALL PMN$COLLECT(DCT.PM,%PM_WAIT);

   2974  1 000256   000006 236200 2                  LDQ   ! 6
         1 000257   200043 756300                    STQ   ! J+4,,AUTO
         1 000260   200007 236300                    LDQ   ! DCT$,,AUTO
         1 000261   000010 036203                    ADLQ  ! 8,DU
         1 000262   200042 756300                    STQ   ! J+3,,AUTO
         1 000263   200042 630700                    EPPR0 ! J+3,,AUTO
         1 000264   000020 631600 xsym               EPPR1 ! B_VECTNIL+16
         1 000265   000000 701200 xent               TSX1  ! PMN$COLLECT
         1 000266   000000 011200                    NOP   ! 0
         1 000267   000554 710200 1                  TRA   ! s:3038

      185     2975    3               CASE(%MARKER);

      186     2976    3                 DQH$=ADDR(PAR);

   2976  1 000270   200003 236300                    LDQ   ! @PAR,,AUTO
         1 000271   200010 756300                    STQ   ! DQH$,,AUTO

      187     2977    3                 IF DQH.IO$=ADDR(NIL) THEN

   2977  1 000272   200010 471700                    LDP1  ! DQH$,,AUTO
         1 000273   100014 236300                    LDQ   ! 12,,PR1
         1 000274   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
         1 000275   000311 601200 1                  TNZ   ! s:2980

      188     2978    3                    CALL NIA$SPURINT(DQH,EL_SPURINT,INTLVL,NI_DBLZERO);

   2978  1 000276   000002 236200 2                  LDQ   ! 2
         1 000277   200004 235300                    LDA   ! @INTLVL,,AUTO
         1 000300   200044 757300                    STAQ  ! J+5,,AUTO
         1 000301   000001 236200 2                  LDQ   ! 1
         1 000302   200010 235300                    LDA   ! DQH$,,AUTO
         1 000303   200042 757300                    STAQ  ! J+3,,AUTO
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:48   
         1 000304   200042 630700                    EPPR0 ! J+3,,AUTO
         1 000305   000022 631600 xsym               EPPR1 ! B_VECTNIL+18
         1 000306   000000 701200 xent               TSX1  ! NIA$SPURINT
         1 000307   000000 011200                    NOP   ! 0
         1 000310   000324 710200 1                  TRA   ! s:2981

      189     2979    3                 ELSE
      190     2980    3                   CALL NIA$SPURINT(DQH,EL_SPURINT,INTLVL,DQH.IOSTATUS$->IOSTAT.STATUS
              2980                             );

   2980  1 000311   100016 473700                    LDP3  ! 14,,PR1
         1 000312   200045 453700                    STP3  ! J+6,,AUTO
         1 000313   200004 236300                    LDQ   ! @INTLVL,,AUTO
         1 000314   200044 756300                    STQ   ! J+5,,AUTO
         1 000315   000001 236200 2                  LDQ   ! 1
         1 000316   200010 235300                    LDA   ! DQH$,,AUTO
         1 000317   200042 757300                    STAQ  ! J+3,,AUTO
         1 000320   200042 630700                    EPPR0 ! J+3,,AUTO
         1 000321   000022 631600 xsym               EPPR1 ! B_VECTNIL+18
         1 000322   000000 701200 xent               TSX1  ! NIA$SPURINT
         1 000323   000000 011200                    NOP   ! 0

      191     2981    3                 RETURN;

   2981  1 000324   000000 702200 xent               TSX2  ! X66_ARET

      192     2982    3               CASE(%SPECIAL);

      193     2983    3                 IF ADDR(STATUS)=ADDR(NIL) THEN

   2983  1 000325   200005 236300                    LDQ   ! @STATUS,,AUTO
         1 000326   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
         1 000327   000331 601200 1                  TNZ   ! s:2985

      194     2984    3                    RETURN;

   2984  1 000330   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:49   

      195     2985    3                 DQH$=ADDR(PAR);

   2985  1 000331   200003 236300                    LDQ   ! @PAR,,AUTO
         1 000332   200010 756300                    STQ   ! DQH$,,AUTO

      196     2986    3                 SQH$=DQH.SQH$;

   2986  1 000333   200010 471700                    LDP1  ! DQH$,,AUTO
         1 000334   100013 236300                    LDQ   ! 11,,PR1
         1 000335   200032 756300                    STQ   ! SQH$,,AUTO

      197     2987    4                 DO I=SQH.FDCT TO SQH.FDCT+SQH.NDCT-1;

   2987  1 000336   200032 473700                    LDP3  ! SQH$,,AUTO
         1 000337   300002 236300                    LDQ   ! 2,,PR3
         1 000340   000022 772200                    QRL   ! 18
         1 000341   200012 756300                    STQ   ! I,,AUTO
         1 000342   000513 710200 1                  TRA   ! s:3026+1

      198     2988    4                    DCT$=N$DCT$(I);

   2988  1 000343   000000 470600 xsym               LDP0  ! N$DCT$$
         1 000344   200012 720300                    LXL0  ! I,,AUTO
         1 000345   000000 236310                    LDQ   ! 0,X0,PR0
         1 000346   200007 756300                    STQ   ! DCT$,,AUTO

      199     2989    5                    IF DCT.DVN=SPSTAT.DVN AND DCT.TYPE~=%DV_MPC THEN DO;

   2989  1 000347   200005 471700                    LDP1  ! @STATUS,,AUTO
         1 000350   100000 236300                    LDQ   ! 0,,PR1
         1 000351   000022 772200                    QRL   ! 18
         1 000352   000077 376207                    ANQ   ! 63,DL
         1 000353   200042 756300                    STQ   ! J+3,,AUTO
         1 000354   200007 473700                    LDP3  ! DCT$,,AUTO
         1 000355   300007 236300                    LDQ   ! 7,,PR3
         1 000356   000030 772200                    QRL   ! 24
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:50   
         1 000357   000077 376207                    ANQ   ! 63,DL
         1 000360   200042 116300                    CMPQ  ! J+3,,AUTO
         1 000361   000512 601200 1                  TNZ   ! s:3026
         1 000362   300007 236300                    LDQ   ! 7,,PR3
         1 000363   007700 376207                    ANQ   ! 4032,DL
         1 000364   000700 116207                    CMPQ  ! 448,DL
         1 000365   000512 600200 1                  TZE   ! s:3026

      200     2990                            %LOCK (G#=SQH.GATE);

   2991  1 000366   200032 630700                    EPPR0 ! SQH$,,AUTO
         1 000367   000017 631600 xsym               EPPR1 ! B_VECTNIL+15
         1 000370   000000 701200 xent               TSX1  ! HFC$LOCK
         1 000371   000000 011200                    NOP   ! 0

      201     2993    6                       IF NOT DCT.SPSTAT.PRESENCE THEN DO;

   2993  1 000372   200007 470700                    LDP0  ! DCT$,,AUTO
         1 000373   000017 234300                    SZN   ! 15,,PR0
         1 000374   000505 604200 1                  TMI   ! s:3021

      202     2994    6                          DCT.SPSTAT=STATUS;

   2994  1 000375   200005 471700                    LDP1  ! @STATUS,,AUTO
         1 000376   100000 236300                    LDQ   ! 0,,PR1
         1 000377   000017 756300                    STQ   ! 15,,PR0

      203     2995                               %UNLOCK (G#=SQH.GATE);

   2996  1 000400   200032 630700                    EPPR0 ! SQH$,,AUTO
         1 000401   000017 631600 xsym               EPPR1 ! B_VECTNIL+15
         1 000402   000000 701200 xent               TSX1  ! HFC$UNLOCK
         1 000403   000000 011200                    NOP   ! 0

      204     2998    7                         IF DCT.SPSTAT.CODE & '000020'O AND DCT.STATE=%SPWAIT THEN DO;
              2998                                   /* TAPE READY */

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:51   
   2998  1 000404   200007 470700                    LDP0  ! DCT$,,AUTO
         1 000405   000017 720300                    LXL0  ! 15,,PR0
         1 000406   000020 360203                    ANX0  ! 16,DU
         1 000407   000455 600200 1                  TZE   ! s:3010
         1 000410   000007 236300                    LDQ   ! 7,,PR0
         1 000411   000077 376207                    ANQ   ! 63,DL
         1 000412   000003 116207                    CMPQ  ! 3,DL
         1 000413   000455 601200 1                  TNZ   ! s:3010

      205     2999    8                             IF DCT.MT.SETDENS$~=ADDR(NIL) THEN DO;

   2999  1 000414   000042 236300                    LDQ   ! 34,,PR0
         1 000415   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
         1 000416   000431 600200 1                  TZE   ! s:3004

      206     3000    8                                IF DCT.MT.SETDENS$->REQ.DQH$->DQH.LA~=DQH.LA OR

   3000  1 000417   000042 471700                    LDP1  ! 34,,PR0
         1 000420   100020 473700                    LDP3  ! 16,,PR1
         1 000421   200010 474700                    LDP4  ! DQH$,,AUTO
         1 000422   300020 236300                    LDQ   ! 16,,PR3
         1 000423   400020 676300                    ERQ   ! 16,,PR4
         1 000424   003000 376203                    ANQ   ! 1536,DU
         1 000425   000454 601200 1                  TNZ   ! SKIP_SPEC
         1 000426   300015 236300                    LDQ   ! 13,,PR3
         1 000427   400015 116300                    CMPQ  ! 13,,PR4
         1 000430   000454 601200 1                  TNZ   ! SKIP_SPEC

      207     3001    8                                  DCT.MT.SETDENS$->REQ.DQH$->DQH.MPC$~=DQH.MPC$ THEN
      208     3002    8                                   GOTO SKIP_SPEC;
      209     3003    8                                END;

      210     3004    8                             IF DCT.MSG#>0 THEN DO;

   3004  1 000431   000027 720300                    LXL0  ! 23,,PR0
         1 000432   000445 600200 1                  TZE   ! s:3008

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:52   
      211     3005    8                                CALL OCI$MK_STTM(DCT.MSG#);

   3005  1 000433   200007 236300                    LDQ   ! DCT$,,AUTO
         1 000434   000007 036200 2                  ADLQ  ! 7
         1 000435   200042 756300                    STQ   ! J+3,,AUTO
         1 000436   200042 630700                    EPPR0 ! J+3,,AUTO
         1 000437   000017 631600 xsym               EPPR1 ! B_VECTNIL+15
         1 000440   000000 701200 xent               TSX1  ! OCI$MK_STTM
         1 000441   000000 011200                    NOP   ! 0

      212     3006    8                                DCT.MSG#=0;

   3006  1 000442   000000 220203                    LDX0  ! 0,DU
         1 000443   200007 470700                    LDP0  ! DCT$,,AUTO
         1 000444   000027 440300                    SXL0  ! 23,,PR0

      213     3007    8                                END;

      214     3008    7                             CALL NIT$DEVSCHED(DCT,%IDLE);

   3008  1 000445   000003 236200 2                  LDQ   ! 3
         1 000446   200007 235300                    LDA   ! DCT$,,AUTO
         1 000447   200042 757300                    STAQ  ! J+3,,AUTO
         1 000450   200042 630700                    EPPR0 ! J+3,,AUTO
         1 000451   000020 631600 xsym               EPPR1 ! B_VECTNIL+16
         1 000452   000000 701200 xent               TSX1  ! NIT$DEVSCHED
         1 000453   000000 011200                    NOP   ! 0

      215     3009    7   SKIP_SPEC:                END;

   3009  1 000454   000501 710200 1     SKIP_SPEC    TRA   ! s:3017

      216     3010    6                          ELSE IF DCT.SPSTAT.CODE & '000100'O THEN
              3010                                   /* REWIND COMPLETE */

   3010  1 000455   000017 720300                    LXL0  ! 15,,PR0
         1 000456   000100 360203                    ANX0  ! 64,DU
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:53   
         1 000457   000463 600200 1                  TZE   ! s:3012

      217     3011    6                                DCT.MT.RWC='1'B;

   3011  1 000460   400000 236203                    LDQ   ! -131072,DU
         1 000461   000030 256300                    ORSQ  ! 24,,PR0
         1 000462   000501 710200 1                  TRA   ! s:3017

      218     3012    6                             ELSE IF DCT.MT.FREPOS$=ADDR(NIL) AND NOT

   3012  1 000463   000031 236300                    LDQ   ! 25,,PR0
         1 000464   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
         1 000465   000501 601200 1                  TNZ   ! s:3017
         1 000466   000017 720300                    LXL0  ! 15,,PR0
         1 000467   200000 360203                    ANX0  ! 65536,DU
         1 000470   000475 600200 1                  TZE   ! s:3016
         1 000471   000005 471700                    LDP1  ! 5,,PR0
         1 000472   100010 236300                    LDQ   ! 8,,PR1
         1 000473   000004 316207                    CANQ  ! 4,DL
         1 000474   000501 601200 1                  TNZ   ! s:3017

      219     3013    6                                  ((DCT.SPSTAT.CODE&'200000'O) AND DCT.RAT$->RAT.FLG.
              3013                                           RUP) THEN
      220     3014                                   /* IGNORE FIPS SPECIAL POLLING TAPE-READY INTERRUPT
      221     3015                                      IF TAPE RESOURCE IS IN USE                         */
      222     3016    6                                   CALL NIO$SPCOMP(DCT);

   3016  1 000475   200007 630700                    EPPR0 ! DCT$,,AUTO
         1 000476   000017 631600 xsym               EPPR1 ! B_VECTNIL+15
         1 000477   000000 701200 xent               TSX1  ! NIO$SPCOMP
         1 000500   000000 011200                    NOP   ! 0

      223     3017    6                          DCT.SPSTAT.PRESENCE='0'B;

   3017  1 000501   200007 470700                    LDP0  ! DCT$,,AUTO
         1 000502   000031 236200 xsym               LDQ   ! B_VECTNIL+25
         1 000503   000017 356300                    ANSQ  ! 15,,PR0
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:54   

      224     3018    6                          END;

   3018  1 000504   000511 710200 1                  TRA   ! s:3024

      225     3019    6                       ELSE DO;

      226     3020                               %UNLOCK (G#=SQH.GATE);

   3021  1 000505   200032 630700                    EPPR0 ! SQH$,,AUTO
         1 000506   000017 631600 xsym               EPPR1 ! B_VECTNIL+15
         1 000507   000000 701200 xent               TSX1  ! HFC$UNLOCK
         1 000510   000000 011200                    NOP   ! 0

      227     3023    6                          END;

      228     3024    5                       RETURN;

   3024  1 000511   000000 702200 xent               TSX2  ! X66_ARET

      229     3025    5                       END;
      230     3026    4                    END;

   3026  1 000512   200012 054300                    AOS   ! I,,AUTO
         1 000513   200032 470700                    LDP0  ! SQH$,,AUTO
         1 000514   000002 236300                    LDQ   ! 2,,PR0
         1 000515   777777 376207                    ANQ   ! -1,DL
         1 000516   200042 756300                    STQ   ! J+3,,AUTO
         1 000517   000002 236300                    LDQ   ! 2,,PR0
         1 000520   000022 772200                    QRL   ! 18
         1 000521   200042 036300                    ADLQ  ! J+3,,AUTO
         1 000522   000343 604200 1                  TMI   ! s:2988
         1 000523   200012 116300                    CMPQ  ! I,,AUTO
         1 000524   000343 605600 1                  TPNZ  ! s:2988

      231     3027    3                 CALL NIA$SPURINT(DQH,EL_SPURINT,INTLVL,STATUS);

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:55   
   3027  1 000525   200004 237300                    LDAQ  ! @INTLVL,,AUTO
         1 000526   200044 757300                    STAQ  ! J+5,,AUTO
         1 000527   000001 236200 2                  LDQ   ! 1
         1 000530   200010 235300                    LDA   ! DQH$,,AUTO
         1 000531   200042 757300                    STAQ  ! J+3,,AUTO
         1 000532   200042 630700                    EPPR0 ! J+3,,AUTO
         1 000533   000022 631600 xsym               EPPR1 ! B_VECTNIL+18
         1 000534   000000 701200 xent               TSX1  ! NIA$SPURINT
         1 000535   000000 011200                    NOP   ! 0

      232     3028    3                 RETURN;

   3028  1 000536   000000 702200 xent               TSX2  ! X66_ARET

      233     3029    3               CASE(%REPOST);

      234     3030    3                 REQ$=ADDR(PAR);

   3030  1 000537   200003 236300                    LDQ   ! @PAR,,AUTO
         1 000540   200027 756300                    STQ   ! REQ$,,AUTO

      235     3031    3                 DCT$=REQ.DCT$;

   3031  1 000541   200027 471700                    LDP1  ! REQ$,,AUTO
         1 000542   100002 236300                    LDQ   ! 2,,PR1
         1 000543   200007 756300                    STQ   ! DCT$,,AUTO

      236     3032    3                 DQH$=DCT.DQH$;

   3032  1 000544   200007 473700                    LDP3  ! DCT$,,AUTO
         1 000545   300023 236300                    LDQ   ! 19,,PR3
         1 000546   200010 756300                    STQ   ! DQH$,,AUTO

      237     3033    3                 SQH$=DCT.SQH$;

   3033  1 000547   300022 236300                    LDQ   ! 18,,PR3
         1 000550   200032 756300                    STQ   ! SQH$,,AUTO
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:56   

      238     3034    3                 NI$EXTST.EXTST='0'B;

   3034  1 000551   000100 100600                    MLR   ! fill='000'O
         1 000552   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000553   200016 000040                    ADSC9   NI$EXTST,,AUTO           cn=0,n=32

      239     3035    3               END;                        /* CASE INTLVL                        */

      240     3036    2              END;                         /* INHIBIT                            */

      241     3037        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:57   
      242     3038    2           IF REQ.STATUS.MAJOR=%DEVICE_BUSY AND (REQ.STATUS.MINOR & '05'O) THEN DO;

   3038  1 000554   200027 470500                    LDP0    REQ$,,AUTO
         1 000555   000014 236100                    LDQ     12,,PR0
         1 000556   170000 376003                    ANQ     61440,DU
         1 000557   010000 116003                    CMPQ    4096,DU
         1 000560   000635 601000 1                  TNZ     s:3057
         1 000561   000014 236100                    LDQ     12,,PR0
         1 000562   000006 736000                    QLS     6
         1 000563   770000 376003                    ANQ     -4096,DU
         1 000564   050000 376003                    ANQ     20480,DU
         1 000565   000635 600000 1                  TZE     s:3057

      243     3039                                                /* LOAD OR REWIND IN PROGRESS */
      244     3040                   %LOCK (G#=SQH.GATE);

   3041  1 000566   200032 630500                    EPPR0   SQH$,,AUTO
         1 000567   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000570   000000 701000 xent               TSX1    HFC$LOCK
         1 000571   000000 011000                    NOP     0

      245     3043    3              IF REQ$~=DCT.MT.FREPOS$ AND REQ$~=DCT.MT.SETDENS$ THEN DO;

   3043  1 000572   200007 470500                    LDP0    DCT$,,AUTO
         1 000573   200027 236100                    LDQ     REQ$,,AUTO
         1 000574   000031 116100                    CMPQ    25,,PR0
         1 000575   000610 600000 1                  TZE     s:3048
         1 000576   000042 116100                    CMPQ    34,,PR0
         1 000577   000610 600000 1                  TZE     s:3048

      246     3044                      %REQUEUE (P#=REQ,Q#=DCT.SQ$);

   3045  1 000600   200007 236100                    LDQ     DCT$,,AUTO
         1 000601   000001 036003                    ADLQ    1,DU
         1 000602   200027 235100                    LDA     REQ$,,AUTO
         1 000603   200042 757100                    STAQ    J+3,,AUTO
         1 000604   200042 630500                    EPPR0   J+3,,AUTO
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:58   
         1 000605   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000606   000000 701000 xent               TSX1    NIM$REQUEUE
         1 000607   000000 011000                    NOP     0

      247     3047    3                 END;

      248     3048    3              IF DCT.MT.RWC THEN DO;

   3048  1 000610   200007 470500                    LDP0    DCT$,,AUTO
         1 000611   000030 234100                    SZN     24,,PR0
         1 000612   000625 605000 1                  TPL     s:3053

      249     3049    3                 DCT.MT.RWC='0'B;

   3049  1 000613   000031 236000 xsym               LDQ     B_VECTNIL+25
         1 000614   000030 356100                    ANSQ    24,,PR0

      250     3050    3                 CALL NIT$DEVSCHEDL(DCT,%IDLE);

   3050  1 000615   000003 236000 2                  LDQ     3
         1 000616   200007 235100                    LDA     DCT$,,AUTO
         1 000617   200042 757100                    STAQ    J+3,,AUTO
         1 000620   200042 630500                    EPPR0   J+3,,AUTO
         1 000621   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000622   000000 701000 xent               TSX1    NIT$DEVSCHEDL
         1 000623   000000 011000                    NOP     0

      251     3051    3                 END;

   3051  1 000624   000634 710000 1                  TRA     s:3055

      252     3052    3              ELSE DO;

      253     3053    3                 CALL NIT$DEVSCHEDL(DCT,%SPWAIT);

   3053  1 000625   000010 236000 2                  LDQ     8
         1 000626   200007 235100                    LDA     DCT$,,AUTO
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:59   
         1 000627   200042 757100                    STAQ    J+3,,AUTO
         1 000630   200042 630500                    EPPR0   J+3,,AUTO
         1 000631   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000632   000000 701000 xent               TSX1    NIT$DEVSCHEDL
         1 000633   000000 011000                    NOP     0

      254     3054    3                 END;

      255     3055    2              RETURN;

   3055  1 000634   000000 702200 xent               TSX2  ! X66_ARET

      256     3056    2              END;
      257     3057    1           REQ.TYC='0'B;

   3057  1 000635   000021 450100                    STZ     17,,PR0

      258     3058    1           RCVR='0'B;

   3058  1 000636   200026 450100                    STZ     RCVR,,AUTO

      259     3059    1           EXTST$=ADDR(NIL);

   3059  1 000637   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000640   200011 756100                    STQ     EXTST$,,AUTO

      260     3060    1           REPOS$=ADDR(NIL);

   3060  1 000641   200030 756100                    STQ     REPOS$,,AUTO

      261     3061    1           SETDENS$=ADDR(NIL);

   3061  1 000642   200031 756100                    STQ     SETDENS$,,AUTO

      262     3062    1           NEWSTATE=%IDLE;

   3062  1 000643   200015 450100                    STZ     NEWSTATE,,AUTO
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:60   

      263     3063    1           IF REQ.FC=%N_RQSTAT OR REQ.FC=%N_EXTST OR REQ.COMP=%COMP_TD THEN

   3063  1 000644   200027 470500                    LDP0    REQ$,,AUTO
         1 000645   000003 236100                    LDQ     3,,PR0
         1 000646   000777 376007                    ANQ     511,DL
         1 000647   000001 116007                    CMPQ    1,DL
         1 000650   001607 600000 1                  TZE     BYPASS_STATUS_ANALYSIS
         1 000651   000033 116007                    CMPQ    27,DL
         1 000652   001607 600000 1                  TZE     BYPASS_STATUS_ANALYSIS
         1 000653   000027 236100                    LDQ     23,,PR0
         1 000654   177000 376007                    ANQ     65024,DL
         1 000655   004000 116007                    CMPQ    2048,DL
         1 000656   001607 600000 1                  TZE     BYPASS_STATUS_ANALYSIS

      264     3064    1              GOTO BYPASS_STATUS_ANALYSIS;
      265     3065    2           IF REQ.STATUS.POWEROFF THEN DO;

   3065  1 000657   000014 236100                    LDQ     12,,PR0
         1 000660   200000 316003                    CANQ    65536,DU
         1 000661   000740 600000 1                  TZE     s:3080

      266     3066    2              RCVR=RETRY#|LOGERR#|OPMSG#|FREPOS#;

   3066  1 000662   470000 236003                    LDQ     -102400,DU
         1 000663   200026 756100                    STQ     RCVR,,AUTO

      267     3067    2              NEWSTATE=%MPCWAIT;

   3067  1 000664   000007 235007                    LDA     7,DL
         1 000665   200015 755100                    STA     NEWSTATE,,AUTO

      268     3068    2              IF  HW_IMX

   3068  1 000666   000000 234000 xsym               SZN     HW_IMX
         1 000667   000726 605000 1                  TPL     s:3077
         1 000670   200007 471500                    LDP1    DCT$,,AUTO
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:61   
         1 000671   100007 236100                    LDQ     7,,PR1
         1 000672   070000 376003                    ANQ     28672,DU
         1 000673   020000 116003                    CMPQ    8192,DU
         1 000674   000726 601000 1                  TNZ     s:3077

      269     3069    2                AND DCT.CTYP = %C_IPC
      270     3070    3              THEN DO ;

      271     3071    3                 DQH.MPC$->DCT.DFLG.MPCSTOP = '0'B ;

   3071  1 000675   200010 473500                    LDP3    DQH$,,AUTO
         1 000676   300015 474500                    LDP4    13,,PR3
         1 000677   000011 236000 2                  LDQ     9
         1 000700   400006 356100                    ANSQ    6,,PR4

      272     3072    3                 DQH.MPC$->DCT.DFLG.RELOAD  = '0'B ;

   3072  1 000701   300015 470500                    LDP0    13,,PR3
         1 000702   000012 236000 2                  LDQ     10
         1 000703   000006 356100                    ANSQ    6,,PR0

      273     3073    3                 CALL NIW$MPCSTOP ( DQH.MPC$->DCT ) ;

   3073  1 000704   300015 470500                    LDP0    13,,PR3
         1 000705   200042 450500                    STP0    J+3,,AUTO
         1 000706   200042 630500                    EPPR0   J+3,,AUTO
         1 000707   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000710   000000 701000 xent               TSX1    NIW$MPCSTOP
         1 000711   000000 011000                    NOP     0

      274     3074    3                 CALL NIK$OPMSG ( DCT, POWEROFF_MSG#, M_TAPE, %KIWAIT, REQ ) ;

   3074  1 000712   200027 236100                    LDQ     REQ$,,AUTO
         1 000713   200046 756100                    STQ     J+7,,AUTO
         1 000714   000016 237000 2                  LDAQ    14
         1 000715   200044 757100                    STAQ    J+5,,AUTO
         1 000716   000015 236000 2                  LDQ     13
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:62   
         1 000717   200007 235100                    LDA     DCT$,,AUTO
         1 000720   200042 757100                    STAQ    J+3,,AUTO
         1 000721   200042 630500                    EPPR0   J+3,,AUTO
         1 000722   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 000723   000000 701000 xent               TSX1    NIK$OPMSG
         1 000724   000000 011000                    NOP     0

      275     3075    3                 END ;

   3075  1 000725   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS

      276     3076    3              ELSE DO ;

      277     3077    3                 CALL NIW$LDFW ( DQH.MPC$->DCT, '0'B ) ;

   3077  1 000726   200010 471500                    LDP1    DQH$,,AUTO
         1 000727   100015 473500                    LDP3    13,,PR1
         1 000730   000003 236000 2                  LDQ     3
         1 000731   200043 756100                    STQ     J+4,,AUTO
         1 000732   200042 453500                    STP3    J+3,,AUTO
         1 000733   200042 630500                    EPPR0   J+3,,AUTO
         1 000734   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000735   000000 701000 xent               TSX1    NIW$LDFW
         1 000736   000000 011000                    NOP     0

      278     3078    3                 END ;

      279     3079    2              END;

   3079  1 000737   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS

      280     3080    2           ELSE DO CASE(REQ.STATUS.MAJOR);

   3080  1 000740   000014 236100                    LDQ     12,,PR0
         1 000741   000036 772000                    QRL     30
         1 000742   000017 376007                    ANQ     15,DL
         1 000743   000020 116007                    CMPQ    16,DL
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:63   
         1 000744   000746 602006 1                  TNC     s:3080+6,QL
         1 000745   001603 710000 1                  TRA     s:3230
         1 000746   000766 710000 1                  TRA     s:3082
         1 000747   001042 710000 1                  TRA     s:3099
         1 000750   001047 710000 1                  TRA     s:3102
         1 000751   001132 710000 1                  TRA     s:3121
         1 000752   001240 710000 1                  TRA     s:3149
         1 000753   001276 710000 1                  TRA     s:3161
         1 000754   001603 710000 1                  TRA     s:3230
         1 000755   001603 710000 1                  TRA     s:3230
         1 000756   001345 710000 1                  TRA     s:3176
         1 000757   001603 710000 1                  TRA     s:3230
         1 000760   001354 710000 1                  TRA     s:3180
         1 000761   001444 710000 1                  TRA     s:3200
         1 000762   001603 710000 1                  TRA     s:3230
         1 000763   001533 710000 1                  TRA     s:3214
         1 000764   001532 710000 1                  TRA     s:3212
         1 000765   001554 710000 1                  TRA     s:3223

      281     3081    2            CASE(%READY);

      282     3082    3              IF NOT REQ.STATUS.PRESENCE THEN DO;

   3082  1 000766   000014 234100                    SZN     12,,PR0
         1 000767   000772 604000 1                  TMI     s:3085

      283     3083    3                 REQ.TYC.IOERR='1'B;

   3083  1 000770   001000 236003                    LDQ     512,DU
         1 000771   000021 256100                    ORSQ    17,,PR0

      284     3084    3                 END;

      285     3085    2              IF REQ.STATUS.MINOR & '02'O THEN REQ.TYC.BOT='1'B;

   3085  1 000772   200027 470500                    LDP0    REQ$,,AUTO
         1 000773   000014 236100                    LDQ     12,,PR0
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:64   
         1 000774   000006 736000                    QLS     6
         1 000775   770000 376003                    ANQ     -4096,DU
         1 000776   020000 376003                    ANQ     8192,DU
         1 000777   001002 600000 1                  TZE     s:3086

   3085  1 001000   040000 236003                    LDQ     16384,DU
         1 001001   000021 256100                    ORSQ    17,,PR0

      286     3086    3              IF REQ.STATUS.MINOR='14'O THEN DO;

   3086  1 001002   200027 470500                    LDP0    REQ$,,AUTO
         1 001003   000014 236100                    LDQ     12,,PR0
         1 001004   007700 376003                    ANQ     4032,DU
         1 001005   001400 116003                    CMPQ    768,DU
         1 001006   001013 601000 1                  TNZ     s:3090

      287     3087    3                 REQ.TYC.IOERR='1'B;

   3087  1 001007   001000 236003                    LDQ     512,DU
         1 001010   000021 256100                    ORSQ    17,,PR0

      288     3088    3                 RCVR=RETRY#|LOGERR#|REPOS#;

   3088  1 001011   640000 236003                    LDQ     -49152,DU
         1 001012   200026 756100                    STQ     RCVR,,AUTO

      289     3089    3                 END;

      290     3090    3              IF REQ.STATUS.IOM THEN DO;

   3090  1 001013   200027 470500                    LDP0    REQ$,,AUTO
         1 001014   000014 236100                    LDQ     12,,PR0
         1 001015   770000 316007                    CANQ    -4096,DL
         1 001016   001607 600000 1                  TZE     BYPASS_STATUS_ANALYSIS

      291     3091    3                 CALL NIF$ANIOM(REQ,RCVR.RETRY) ALTRET(IOM_ALT);

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:65   
   3091  1 001017   200026 631500                    EPPR1   RCVR,,AUTO
         1 001020   200043 451500                    STP1    J+4,,AUTO
         1 001021   200027 236100                    LDQ     REQ$,,AUTO
         1 001022   200042 756100                    STQ     J+3,,AUTO
         1 001023   200042 630500                    EPPR0   J+3,,AUTO
         1 001024   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001025   000000 701000 xent               TSX1    NIF$ANIOM
         1 001026   001030 702000 1                  TSX2    IOM_ALT

      292     3092    4                 DO NEVER;

   3092  1 001027   001032 710000 1                  TRA     s:3095

      293     3093    4   IOM_ALT:         NEWSTATE=%KIWAIT;

   3093  1 001030   000004 235007       IOM_ALT      LDA     4,DL
         1 001031   200015 755100                    STA     NEWSTATE,,AUTO

      294     3094    4                    END;

      295     3095    3                 IF RCVR.RETRY THEN RCVR=%(RETRY#|LOGERR#|REPOS#);

   3095  1 001032   200026 234100                    SZN     RCVR,,AUTO
         1 001033   001037 605000 1                  TPL     s:3096

   3095  1 001034   640000 236003                    LDQ     -49152,DU
         1 001035   200026 756100                    STQ     RCVR,,AUTO
         1 001036   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS

      296     3096    3                 ELSE RCVR=LOGERR#;

   3096  1 001037   040000 236003                    LDQ     16384,DU
         1 001040   200026 756100                    STQ     RCVR,,AUTO

      297     3097    3                 END;

   3097  1 001041   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:66   

      298     3098    2            CASE(%DEVICE_BUSY);

      299     3099    2              REQ.TYC.IOERR='1'B;

   3099  1 001042   001000 236003                    LDQ     512,DU
         1 001043   000021 256100                    ORSQ    17,,PR0

      300     3100    2              RCVR = %( RETRY# | LOGERR# ) ;

   3100  1 001044   440000 236003                    LDQ     -114688,DU
         1 001045   200026 756100                    STQ     RCVR,,AUTO
         1 001046   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS

      301     3101    2            CASE(%ATTENTION);

      302     3102    2              MNSTAT=REQ.STATUS.MINOR;

   3102  1 001047   000014 236100                    LDQ     12,,PR0
         1 001050   000006 736000                    QLS     6
         1 001051   200014 752140                    STCQ    MNSTAT,'40'O,AUTO

      303     3103    3              DO I=0 TO 5;

   3103  1 001052   200012 450100                    STZ     I,,AUTO

      304     3104    4                 IF MNSTAT(I) THEN DO CASE(I);

   3104  1 001053   200012 235100                    LDA     I,,AUTO
         1 001054   001056 605000 1                  TPL     s:3104+3
         1 001055   000044 035003                    ADLA    36,DU
         1 001056   000000 066505                    CMPB    filb='0'B
         1 001057   200014 000001                    BDSC    MNSTAT,A,AUTO            by=0,bit=0,n=1
         1 001060   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 001061   001125 600000 1                  TZE     s:3119

   3104  1 001062   200012 235100                    LDA     I,,AUTO
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:67   
         1 001063   000006 115007                    CMPA    6,DL
         1 001064   001066 602005 1                  TNC     s:3104+11,AL
         1 001065   001125 710000 1                  TRA     s:3119
         1 001066   001074 710000 1                  TRA     s:3106
         1 001067   001104 710000 1                  TRA     s:3110
         1 001070   001112 710000 1                  TRA     s:3113
         1 001071   001112 710000 1                  TRA     s:3113
         1 001072   001074 710000 1                  TRA     s:3106
         1 001073   001122 710000 1                  TRA     s:3117

      305     3105    4                  CASE(0,4); /* 0=UNDEFINED, 4=OFF LINE */;

      306     3106    4                    REQ.TYC.IOERR='1'B;

   3106  1 001074   200027 470500                    LDP0    REQ$,,AUTO
         1 001075   001000 236003                    LDQ     512,DU
         1 001076   000021 256100                    ORSQ    17,,PR0

      307     3107    4                    RCVR=RETRY#|FREPOS#|LOGERR#;

   3107  1 001077   460000 236003                    LDQ     -106496,DU
         1 001100   200026 756100                    STQ     RCVR,,AUTO

      308     3108    4                    NEWSTATE=%KIWAIT;

   3108  1 001101   000004 235007                    LDA     4,DL
         1 001102   200015 755100                    STA     NEWSTATE,,AUTO
         1 001103   001125 710000 1                  TRA     s:3119

      309     3109    4                  CASE(1); /* BLANK TAPE ON WRITE */;

      310     3110    4                    REQ.TYC.IOERR='1'B;

   3110  1 001104   200027 470500                    LDP0    REQ$,,AUTO
         1 001105   001000 236003                    LDQ     512,DU
         1 001106   000021 256100                    ORSQ    17,,PR0

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:68   
      311     3111    4                    RCVR=RETRY#|LOGERR#;

   3111  1 001107   440000 236003                    LDQ     -114688,DU
         1 001110   200026 756100                    STQ     RCVR,,AUTO
         1 001111   001125 710000 1                  TRA     s:3119

      312     3112    4                  CASE(2,3);               /* 2=DEVICE CHECK, 3=STANDBY */

      313     3113    4                    REQ.TYC.IOERR='1'B;

   3113  1 001112   200027 470500                    LDP0    REQ$,,AUTO
         1 001113   001000 236003                    LDQ     512,DU
         1 001114   000021 256100                    ORSQ    17,,PR0

      314     3114    4                    RCVR=RETRY#|FREPOS#|LOGERR#|EXTST#;

   3114  1 001115   462000 236003                    LDQ     -105472,DU
         1 001116   200026 756100                    STQ     RCVR,,AUTO

      315     3115    4                    NEWSTATE=%KIWAIT;

   3115  1 001117   000004 235007                    LDA     4,DL
         1 001120   200015 755100                    STA     NEWSTATE,,AUTO
         1 001121   001125 710000 1                  TRA     s:3119

      316     3116    4                  CASE(5);                 /* WRITE PROTECTED */

      317     3117    4                    REQ.TYC.PROT='1'B;

   3117  1 001122   200027 470500                    LDP0    REQ$,,AUTO
         1 001123   000004 236003                    LDQ     4,DU
         1 001124   000021 256100                    ORSQ    17,,PR0

      318     3118    4                  END;

      319     3119    3                 END;

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:69   
   3119  1 001125   200012 054100                    AOS     I,,AUTO
         1 001126   200012 235100                    LDA     I,,AUTO
         1 001127   000005 115007                    CMPA    5,DL
         1 001130   001053 604400 1                  TMOZ    s:3104
         1 001131   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS

      320     3120    2            CASE(%DATA_ALERT);

      321     3121    2              MNSTAT=REQ.STATUS.MINOR;

   3121  1 001132   000014 236100                    LDQ     12,,PR0
         1 001133   000006 736000                    QLS     6
         1 001134   200014 752140                    STCQ    MNSTAT,'40'O,AUTO

      322     3122    3              DO I=0 TO 5;

   3122  1 001135   200012 450100                    STZ     I,,AUTO

      323     3123    4                 IF MNSTAT(I) THEN DO CASE(I);

   3123  1 001136   200012 235100                    LDA     I,,AUTO
         1 001137   001141 605000 1                  TPL     s:3123+3
         1 001140   000044 035003                    ADLA    36,DU
         1 001141   000000 066505                    CMPB    filb='0'B
         1 001142   200014 000001                    BDSC    MNSTAT,A,AUTO            by=0,bit=0,n=1
         1 001143   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 001144   001222 600000 1                  TZE     s:3144

   3123  1 001145   200012 235100                    LDA     I,,AUTO
         1 001146   000006 115007                    CMPA    6,DL
         1 001147   001151 602005 1                  TNC     s:3123+11,AL
         1 001150   001222 710000 1                  TRA     s:3144
         1 001151   001157 710000 1                  TRA     s:3125
         1 001152   001163 710000 1                  TRA     s:3127
         1 001153   001163 710000 1                  TRA     s:3127
         1 001154   001171 710000 1                  TRA     s:3130
         1 001155   001177 710000 1                  TRA     s:3133
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:70   
         1 001156   001203 710000 1                  TRA     s:3135

      324     3124    4                  CASE(0);                 /* EOT */

      325     3125    4                    REQ.TYC.EOT='1'B;

   3125  1 001157   200027 470500                    LDP0    REQ$,,AUTO
         1 001160   100000 236003                    LDQ     32768,DU
         1 001161   000021 256100                    ORSQ    17,,PR0
         1 001162   001222 710000 1                  TRA     s:3144

      326     3126    4                  CASE(1,2);               /* PARITY ERROR */

      327     3127    4                    REQ.TYC.IOERR='1'B;

   3127  1 001163   200027 470500                    LDP0    REQ$,,AUTO
         1 001164   001000 236003                    LDQ     512,DU
         1 001165   000021 256100                    ORSQ    17,,PR0

      328     3128    4                    RCVR=RETRY#|REPOS#|LOGERR#|EXTST#;

   3128  1 001166   642000 236003                    LDQ     -48128,DU
         1 001167   200026 756100                    STQ     RCVR,,AUTO
         1 001170   001222 710000 1                  TRA     s:3144

      329     3129    4                  CASE(3);                 /* TRANSMISSION PARITY ERROR */

      330     3130    4                    REQ.TYC.IOERR='1'B;

   3130  1 001171   200027 470500                    LDP0    REQ$,,AUTO
         1 001172   001000 236003                    LDQ     512,DU
         1 001173   000021 256100                    ORSQ    17,,PR0

      331     3131    4                    RCVR=RETRY#|REPOS#|LOGERR#;

   3131  1 001174   640000 236003                    LDQ     -49152,DU
         1 001175   200026 756100                    STQ     RCVR,,AUTO
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:71   
         1 001176   001222 710000 1                  TRA     s:3144

      332     3132    4                  CASE(4); /* BLANK TAPE ON READ */;

      333     3133    4                    REQ.TYC.BLNKTP='1'B;

   3133  1 001177   200027 470500                    LDP0    REQ$,,AUTO
         1 001200   010000 236003                    LDQ     4096,DU
         1 001201   000021 256100                    ORSQ    17,,PR0
         1 001202   001222 710000 1                  TRA     s:3144

      334     3134    4                  CASE(5);                 /* TRANSFER TIMING ERROR */

      335     3135    5                    IF MNSTAT(4) THEN DO;  /* BIT DURING ERASE */

   3135  1 001203   200014 236100                    LDQ     MNSTAT,,AUTO
         1 001204   020000 316003                    CANQ    8192,DU
         1 001205   001215 600000 1                  TZE     s:3140

      336     3136    5                       REQ.TYC.BLNKTP='0'B;

   3136  1 001206   200027 470500                    LDP0    REQ$,,AUTO
         1 001207   000020 236000 2                  LDQ     16
         1 001210   000021 356100                    ANSQ    17,,PR0

      337     3137    5                       REQ.TYC.IOERR='1'B;

   3137  1 001211   200027 470500                    LDP0    REQ$,,AUTO
         1 001212   001000 236003                    LDQ     512,DU
         1 001213   000021 256100                    ORSQ    17,,PR0

      338     3138    5                       END;

   3138  1 001214   001222 710000 1                  TRA     s:3144

      339     3139    5                    ELSE DO;               /* TRANSFER TIMING ERROR */

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:72   
      340     3140    5                       REQ.TYC.IOERR='1'B;

   3140  1 001215   200027 470500                    LDP0    REQ$,,AUTO
         1 001216   001000 236003                    LDQ     512,DU
         1 001217   000021 256100                    ORSQ    17,,PR0

      341     3141    5                       RCVR=RETRY#|REPOS#|LOGERR#;

   3141  1 001220   640000 236003                    LDQ     -49152,DU
         1 001221   200026 756100                    STQ     RCVR,,AUTO

      342     3142    5                       END;

      343     3143    4                  END;

      344     3144    3                 END;

   3144  1 001222   200012 054100                    AOS     I,,AUTO
         1 001223   200012 235100                    LDA     I,,AUTO
         1 001224   000005 115007                    CMPA    5,DL
         1 001225   001136 604400 1                  TMOZ    s:3123

      345     3145    3              IF REQ.TYC.EOT AND RCVR.REPOS THEN DO;

   3145  1 001226   200027 470500                    LDP0    REQ$,,AUTO
         1 001227   000021 236100                    LDQ     17,,PR0
         1 001230   100000 316003                    CANQ    32768,DU
         1 001231   001607 600000 1                  TZE     BYPASS_STATUS_ANALYSIS
         1 001232   200026 236100                    LDQ     RCVR,,AUTO
         1 001233   200000 316003                    CANQ    65536,DU
         1 001234   001607 600000 1                  TZE     BYPASS_STATUS_ANALYSIS

      346     3146    3                 RCVR.EOT='1'B;

   3146  1 001235   001000 236003                    LDQ     512,DU
         1 001236   200026 256100                    ORSQ    RCVR,,AUTO

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:73   
      347     3147    3                 END;

   3147  1 001237   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS

      348     3148    2            CASE(%END_OF_FILE);

      349     3149    3              IF REQ.STATUS.MINOR='23'O OR REQ.STATUS.MINOR='17'O THEN DO;

   3149  1 001240   000014 236100                    LDQ     12,,PR0
         1 001241   007700 376003                    ANQ     4032,DU
         1 001242   002300 116003                    CMPQ    1216,DU
         1 001243   001250 600000 1                  TZE     s:3150
         1 001244   000014 236100                    LDQ     12,,PR0
         1 001245   007700 376003                    ANQ     4032,DU
         1 001246   001700 116003                    CMPQ    960,DU
         1 001247   001253 601000 1                  TNZ     s:3152

      350     3150    3                 REQ.TYC.EOF='1'B;

   3150  1 001250   004000 236003                    LDQ     2048,DU
         1 001251   000021 256100                    ORSQ    17,,PR0

      351     3151    3                 END;

   3151  1 001252   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS

      352     3152    3              ELSE IF REQ.STATUS.MINOR='77'O THEN DO;

   3152  1 001253   000014 236100                    LDQ     12,,PR0
         1 001254   007700 376003                    ANQ     4032,DU
         1 001255   007700 116003                    CMPQ    4032,DU
         1 001256   001264 601000 1                  TNZ     s:3157

      353     3153    3                    REQ.TYC.IOERR='1'B;

   3153  1 001257   001000 236003                    LDQ     512,DU
         1 001260   000021 256100                    ORSQ    17,,PR0
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:74   

      354     3154    3                    RCVR=RETRY#|REPOS#|LOGERR#|EXTST#;

   3154  1 001261   642000 236003                    LDQ     -48128,DU
         1 001262   200026 756100                    STQ     RCVR,,AUTO

      355     3155    3                    END;

   3155  1 001263   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS

      356     3156    3                 ELSE DO;

      357     3157    3                    REQ.TYC.IOERR='1'B;

   3157  1 001264   001000 236003                    LDQ     512,DU
         1 001265   000021 256100                    ORSQ    17,,PR0

      358     3158    3                    IF REQ.STATUS.MINOR~='04'O THEN RCVR=RETRY#|LOGERR#;

   3158  1 001266   200027 470500                    LDP0    REQ$,,AUTO
         1 001267   000014 236100                    LDQ     12,,PR0
         1 001270   007700 376003                    ANQ     4032,DU
         1 001271   000400 116003                    CMPQ    256,DU
         1 001272   001607 600000 1                  TZE     BYPASS_STATUS_ANALYSIS

   3158  1 001273   440000 236003                    LDQ     -114688,DU
         1 001274   200026 756100                    STQ     RCVR,,AUTO

      359     3159    3                    END;

   3159  1 001275   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS

      360     3160    2            CASE(%COMMAND_REJECT);

      361     3161    3              IF REQ.STATUS.MINOR='00'O OR REQ.STATUS.MINOR & '43'O THEN DO;

   3161  1 001276   000014 236100                    LDQ     12,,PR0
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:75   
         1 001277   007700 316003                    CANQ    4032,DU
         1 001300   001306 600000 1                  TZE     s:3162
         1 001301   000014 236100                    LDQ     12,,PR0
         1 001302   000006 736000                    QLS     6
         1 001303   770000 376003                    ANQ     -4096,DU
         1 001304   430000 376003                    ANQ     -118784,DU
         1 001305   001312 600000 1                  TZE     s:3165

      362     3162    3                 REQ.TYC.IOERR='1'B;

   3162  1 001306   001000 236003                    LDQ     512,DU
         1 001307   000021 256100                    ORSQ    17,,PR0

      363     3163    3                 RCVR=RETRY#|LOGERR#;

   3163  1 001310   440000 236003                    LDQ     -114688,DU
         1 001311   200026 756100                    STQ     RCVR,,AUTO

      364     3164    3                 END;

      365     3165    3              IF REQ.STATUS.MINOR & '20'O THEN DO;

   3165  1 001312   200027 470500                    LDP0    REQ$,,AUTO
         1 001313   000014 236100                    LDQ     12,,PR0
         1 001314   000006 736000                    QLS     6
         1 001315   770000 376003                    ANQ     -4096,DU
         1 001316   200000 376003                    ANQ     65536,DU
         1 001317   001322 600000 1                  TZE     s:3168

      366     3166    3                 REQ.TYC.FRAW='1'B;

   3166  1 001320   000002 236003                    LDQ     2,DU
         1 001321   000021 256100                    ORSQ    17,,PR0

      367     3167    3                 END;

      368     3168    3              IF REQ.STATUS.MINOR & '10'O THEN DO;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:76   

   3168  1 001322   200027 470500                    LDP0    REQ$,,AUTO
         1 001323   000014 236100                    LDQ     12,,PR0
         1 001324   000006 736000                    QLS     6
         1 001325   770000 376003                    ANQ     -4096,DU
         1 001326   100000 376003                    ANQ     32768,DU
         1 001327   001332 600000 1                  TZE     s:3171

      369     3169    3                 REQ.TYC.BOT='1'B;

   3169  1 001330   040000 236003                    LDQ     16384,DU
         1 001331   000021 256100                    ORSQ    17,,PR0

      370     3170    3                 END;

      371     3171    3              IF REQ.STATUS.MINOR & '04'O THEN DO;

   3171  1 001332   200027 470500                    LDP0    REQ$,,AUTO
         1 001333   000014 236100                    LDQ     12,,PR0
         1 001334   000006 736000                    QLS     6
         1 001335   770000 376003                    ANQ     -4096,DU
         1 001336   040000 376003                    ANQ     16384,DU
         1 001337   001607 600000 1                  TZE     BYPASS_STATUS_ANALYSIS

      372     3172    3                 REQ.TYC.IOERR='1'B;

   3172  1 001340   001000 236003                    LDQ     512,DU
         1 001341   000021 256100                    ORSQ    17,,PR0

      373     3173    3                 RCVR=RETRY#|LOGERR#|REPOS#;

   3173  1 001342   640000 236003                    LDQ     -49152,DU
         1 001343   200026 756100                    STQ     RCVR,,AUTO

      374     3174    3                 END;

   3174  1 001344   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:77   

      375     3175    2            CASE(%LOST_INTERRUPT);

      376     3176    2              REQ.TYC.TIMO='1'B;

   3176  1 001345   000010 236003                    LDQ     8,DU
         1 001346   000021 256100                    ORSQ    17,,PR0

      377     3177    2              NEWSTATE=%KIWAIT;

   3177  1 001347   000004 235007                    LDA     4,DL
         1 001350   200015 755100                    STA     NEWSTATE,,AUTO

      378     3178    2              RCVR=RETRY#|FREPOS#|LOGERR#|OPMSG#;

   3178  1 001351   470000 236003                    LDQ     -102400,DU
         1 001352   200026 756100                    STQ     RCVR,,AUTO
         1 001353   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS

      379     3179    2            CASE(%MPC_ATTENTION);

      380     3180    3              DO CASE(BITBIN(REQ.STATUS.MINOR));

   3180  1 001354   000014 236100                    LDQ     12,,PR0
         1 001355   000030 772000                    QRL     24
         1 001356   000077 376007                    ANQ     63,DL
         1 001357   000022 116007                    CMPQ    18,DL
         1 001360   001362 602006 1                  TNC     s:3180+6,QL
         1 001361   001437 710000 1                  TRA     s:3196
         1 001362   001437 710000 1                  TRA     s:3196
         1 001363   001404 710000 1                  TRA     s:3182
         1 001364   001404 710000 1                  TRA     s:3182
         1 001365   001404 710000 1                  TRA     s:3182
         1 001366   001437 710000 1                  TRA     s:3196
         1 001367   001437 710000 1                  TRA     s:3196
         1 001370   001437 710000 1                  TRA     s:3196
         1 001371   001437 710000 1                  TRA     s:3196
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:78   
         1 001372   001413 710000 1                  TRA     s:3186
         1 001373   001437 710000 1                  TRA     s:3196
         1 001374   001437 710000 1                  TRA     s:3196
         1 001375   001437 710000 1                  TRA     s:3196
         1 001376   001425 710000 1                  TRA     s:3190
         1 001377   001425 710000 1                  TRA     s:3190
         1 001400   001425 710000 1                  TRA     s:3190
         1 001401   001425 710000 1                  TRA     s:3190
         1 001402   001437 710000 1                  TRA     s:3196
         1 001403   001432 710000 1                  TRA     s:3193

      381     3181    3               CASE(1,2,3);

      382     3182    3                 NEWSTATE=%KIWAIT;

   3182  1 001404   000004 235007                    LDA     4,DL
         1 001405   200015 755100                    STA     NEWSTATE,,AUTO

      383     3183    3                 RCVR=RETRY#|REPOS#|LOGERR#|OPMSG#;

   3183  1 001406   650000 236003                    LDQ     -45056,DU
         1 001407   200026 756100                    STQ     RCVR,,AUTO

      384     3184    3                 REQ.TYC.IOERR='1'B;

   3184  1 001410   001000 236003                    LDQ     512,DU
         1 001411   000021 256100                    ORSQ    17,,PR0
         1 001412   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS

      385     3185    3               CASE(8);

      386     3186    3                 REQ.TYC.IOERR='1'B;

   3186  1 001413   001000 236003                    LDQ     512,DU
         1 001414   000021 256100                    ORSQ    17,,PR0

      387     3187    3                 IF DCT.RAT$->RAT.FLG.RUP THEN /* DON'T LOG ERROR IF AVRING */
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:79   

   3187  1 001415   200007 470500                    LDP0    DCT$,,AUTO
         1 001416   000005 471500                    LDP1    5,,PR0
         1 001417   100010 236100                    LDQ     8,,PR1
         1 001420   000004 316007                    CANQ    4,DL
         1 001421   001607 600000 1                  TZE     BYPASS_STATUS_ANALYSIS

      388     3188    3                    RCVR=LOGERR#|RETRY#|REPOS#;

   3188  1 001422   640000 236003                    LDQ     -49152,DU
         1 001423   200026 756100                    STQ     RCVR,,AUTO
         1 001424   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS

      389     3189    3               CASE(12,13,14,15);

      390     3190    3                 REQ.TYC.IOERR='1'B;

   3190  1 001425   001000 236003                    LDQ     512,DU
         1 001426   000021 256100                    ORSQ    17,,PR0

      391     3191    3                 RCVR=RETRY#|REPOS#|LOGERR#;

   3191  1 001427   640000 236003                    LDQ     -49152,DU
         1 001430   200026 756100                    STQ     RCVR,,AUTO
         1 001431   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS

      392     3192    3               CASE(17);

      393     3193    3                 REQ.TYC.IOERR='1'B;

   3193  1 001432   001000 236003                    LDQ     512,DU
         1 001433   000021 256100                    ORSQ    17,,PR0

      394     3194    3                 RCVR=REPOS#|LOGERR#|OPMSG#;

   3194  1 001434   250000 236003                    LDQ     86016,DU
         1 001435   200026 756100                    STQ     RCVR,,AUTO
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:80   
         1 001436   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS

      395     3195    3               CASE(16,ELSE);

      396     3196    3                 REQ.TYC.IOERR='1'B;

   3196  1 001437   001000 236003                    LDQ     512,DU
         1 001440   000021 256100                    ORSQ    17,,PR0

      397     3197    3                 RCVR=RETRY#|FREPOS#|LOGERR#|EXTST#;

   3197  1 001441   462000 236003                    LDQ     -105472,DU
         1 001442   200026 756100                    STQ     RCVR,,AUTO

      398     3198    3               END;                        /* CASE MINOR */

   3198  1 001443   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS

      399     3199    2            CASE(%MPC_DATA_ALERT);

      400     3200    3              DO CASE(BITBIN(REQ.STATUS.MINOR));

   3200  1 001444   000014 236100                    LDQ     12,,PR0
         1 001445   000030 772000                    QRL     24
         1 001446   000077 376007                    ANQ     63,DL
         1 001447   000041 116007                    CMPQ    33,DL
         1 001450   001452 602006 1                  TNC     s:3200+6,QL
         1 001451   001513 710000 1                  TRA     s:3202
         1 001452   001513 710000 1                  TRA     s:3202
         1 001453   001513 710000 1                  TRA     s:3202
         1 001454   001513 710000 1                  TRA     s:3202
         1 001455   001513 710000 1                  TRA     s:3202
         1 001456   001513 710000 1                  TRA     s:3202
         1 001457   001513 710000 1                  TRA     s:3202
         1 001460   001513 710000 1                  TRA     s:3202
         1 001461   001513 710000 1                  TRA     s:3202
         1 001462   001525 710000 1                  TRA     s:3208
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:81   
         1 001463   001520 710000 1                  TRA     s:3205
         1 001464   001513 710000 1                  TRA     s:3202
         1 001465   001513 710000 1                  TRA     s:3202
         1 001466   001513 710000 1                  TRA     s:3202
         1 001467   001513 710000 1                  TRA     s:3202
         1 001470   001513 710000 1                  TRA     s:3202
         1 001471   001513 710000 1                  TRA     s:3202
         1 001472   001520 710000 1                  TRA     s:3205
         1 001473   001520 710000 1                  TRA     s:3205
         1 001474   001520 710000 1                  TRA     s:3205
         1 001475   001520 710000 1                  TRA     s:3205
         1 001476   001513 710000 1                  TRA     s:3202
         1 001477   001513 710000 1                  TRA     s:3202
         1 001500   001513 710000 1                  TRA     s:3202
         1 001501   001513 710000 1                  TRA     s:3202
         1 001502   001513 710000 1                  TRA     s:3202
         1 001503   001513 710000 1                  TRA     s:3202
         1 001504   001513 710000 1                  TRA     s:3202
         1 001505   001513 710000 1                  TRA     s:3202
         1 001506   001513 710000 1                  TRA     s:3202
         1 001507   001513 710000 1                  TRA     s:3202
         1 001510   001513 710000 1                  TRA     s:3202
         1 001511   001513 710000 1                  TRA     s:3202
         1 001512   001520 710000 1                  TRA     s:3205

      401     3201    3               CASE(1,2,3,4,20,ELSE);

      402     3202    3                 REQ.TYC.IOERR='1'B;

   3202  1 001513   001000 236003                    LDQ     512,DU
         1 001514   000021 256100                    ORSQ    17,,PR0

      403     3203    3                 RCVR=RETRY#|REPOS#|LOGERR#;

   3203  1 001515   640000 236003                    LDQ     -49152,DU
         1 001516   200026 756100                    STQ     RCVR,,AUTO
         1 001517   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:82   

      404     3204    3               CASE(9,16,17,18,19,32);

      405     3205    3                 REQ.TYC.IOERR='1'B;

   3205  1 001520   001000 236003                    LDQ     512,DU
         1 001521   000021 256100                    ORSQ    17,,PR0

      406     3206    3                 RCVR=RETRY#|REPOS#|LOGERR#|EXTST#;

   3206  1 001522   642000 236003                    LDQ     -48128,DU
         1 001523   200026 756100                    STQ     RCVR,,AUTO
         1 001524   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS

      407     3207    3               CASE(8);

      408     3208    3                 REQ.TYC.IOERR='1'B;

   3208  1 001525   001000 236003                    LDQ     512,DU
         1 001526   000021 256100                    ORSQ    17,,PR0

      409     3209    3                 RCVR=RETRY#|FREPOS#|LOGERR#|EXTST#;

   3209  1 001527   462000 236003                    LDQ     -105472,DU
         1 001530   200026 756100                    STQ     RCVR,,AUTO

      410     3210    3               END/* CASE MINOR */;

   3210  1 001531   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS

      411     3211    2            CASE(%SPECIAL_INTERRUPT);

      412     3212    2              RETURN;

   3212  1 001532   000000 702200 xent               TSX2  ! X66_ARET

      413     3213    2            CASE(%MPC_COMMAND_REJECT);
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:83   

      414     3214    3              DO CASE(BITBIN(REQ.STATUS.MINOR));

   3214  1 001533   000014 236100                    LDQ     12,,PR0
         1 001534   000030 772000                    QRL     24
         1 001535   000077 376007                    ANQ     63,DL
         1 001536   000001 116007                    CMPQ    1,DL
         1 001537   001541 602006 1                  TNC     s:3214+6,QL
         1 001540   001547 710000 1                  TRA     s:3219
         1 001541   001542 710000 1                  TRA     s:3216

      415     3215    3               CASE(0);          /* FIPS indeterminate density                 */

      416     3216    3                 REQ.TYC.IOERR='1'B;

   3216  1 001542   001000 236003                    LDQ     512,DU
         1 001543   000021 256100                    ORSQ    17,,PR0

      417     3217    3                 RCVR=RETRY#|SETDENS#|LOGERR#;  /*N* SHOULD WE DO SETDENS? */

   3217  1 001544   440400 236003                    LDQ     -114432,DU
         1 001545   200026 756100                    STQ     RCVR,,AUTO
         1 001546   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS

      418     3218    3               CASE(1,2,3,4,ELSE);

      419     3219    3                 REQ.TYC.IOERR='1'B;

   3219  1 001547   001000 236003                    LDQ     512,DU
         1 001550   000021 256100                    ORSQ    17,,PR0

      420     3220    3                 RCVR=RETRY#|REPOS#|LOGERR#;

   3220  1 001551   640000 236003                    LDQ     -49152,DU
         1 001552   200026 756100                    STQ     RCVR,,AUTO

      421     3221    3               END;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:84   

   3221  1 001553   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS

      422     3222    2            CASE(%SYSTEM_FAULT);

      423     3223    2              RCVR=%LOGERR#;

   3223  1 001554   040000 236003                    LDQ     16384,DU
         1 001555   200026 756100                    STQ     RCVR,,AUTO

      424     3224    2              CALL NIF$ANFAULT(REQ,RCVR.RETRY,RCVR.FREPOS) ALTRET(FLT_ALT);

   3224  1 001556   200045 452500                    STP2    J+6,,AUTO
         1 001557   200045 236100                    LDQ     J+6,,AUTO
         1 001560   000021 036000 2                  ADLQ    17
         1 001561   200044 756100                    STQ     J+5,,AUTO
         1 001562   200026 631500                    EPPR1   RCVR,,AUTO
         1 001563   200043 451500                    STP1    J+4,,AUTO
         1 001564   200027 236100                    LDQ     REQ$,,AUTO
         1 001565   200042 756100                    STQ     J+3,,AUTO
         1 001566   200042 630500                    EPPR0   J+3,,AUTO
         1 001567   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 001570   000000 701000 xent               TSX1    NIF$ANFAULT
         1 001571   001573 702000 1                  TSX2    FLT_ALT

      425     3225    3              DO NEVER;

   3225  1 001572   001575 710000 1                  TRA     s:3228

      426     3226    3   FLT_ALT:      NEWSTATE=%KIWAIT;

   3226  1 001573   000004 235007       FLT_ALT      LDA     4,DL
         1 001574   200015 755100                    STA     NEWSTATE,,AUTO

      427     3227    3                 END;

      428     3228    2              IF NOT RCVR.FREPOS THEN RCVR.REPOS='1'B;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:85   

   3228  1 001575   200026 236100                    LDQ     RCVR,,AUTO
         1 001576   020000 316003                    CANQ    8192,DU
         1 001577   001607 601000 1                  TNZ     BYPASS_STATUS_ANALYSIS

   3228  1 001600   200000 236003                    LDQ     65536,DU
         1 001601   200026 256100                    ORSQ    RCVR,,AUTO
         1 001602   001607 710000 1                  TRA     BYPASS_STATUS_ANALYSIS

      429     3229    2            CASE(ELSE);

      430     3230    2              REQ.TYC.IOERR='1'B;

   3230  1 001603   001000 236003                    LDQ     512,DU
         1 001604   000021 256100                    ORSQ    17,,PR0

      431     3231    2              RCVR=LOGERR#;

   3231  1 001605   040000 236003                    LDQ     16384,DU
         1 001606   200026 756100                    STQ     RCVR,,AUTO

      432     3232    2            END/* CASE MAJOR */;

   3227  1 001607                       BYPASS_STAT* null
      433     3233        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:86   
      434     3234    1   BYPASS_STATUS_ANALYSIS: ;
      435     3235    2           DO CASE(REQ.COMP);

   3235  1 001607   200027 470500                    LDP0    REQ$,,AUTO
         1 001610   000027 236100                    LDQ     23,,PR0
         1 001611   000011 772000                    QRL     9
         1 001612   000177 376007                    ANQ     127,DL
         1 001613   000010 116007                    CMPQ    8,DL
         1 001614   001616 602006 1                  TNC     BYPASS_STATUS_ANALYSIS+7,QL
         1 001615   002172 710000 1                  TRA     s:3332
         1 001616   001626 710000 1                  TRA     s:3237
         1 001617   002172 710000 1                  TRA     s:3332
         1 001620   002172 710000 1                  TRA     s:3332
         1 001621   002067 710000 1                  TRA     s:3296
         1 001622   002167 710000 1                  TRA     s:3329
         1 001623   001703 710000 1                  TRA     s:3252
         1 001624   002172 710000 1                  TRA     s:3332
         1 001625   002020 710000 1                  TRA     s:3281

      436     3236    2            CASE(%COMP_REG);               /* REGULAR IO REQUESTS */

      437     3237    2              RCVR.REPOS=RCVR.REPOS & ~REQ.STATUS.ININT;

   3237  1 001626   000014 236100                    LDQ     12,,PR0
         1 001627   000020 736000                    QLS     16
         1 001630   400000 376003                    ANQ     -131072,DU
         1 001631   400000 676003                    ERQ     -131072,DU
         1 001632   200042 756100                    STQ     J+3,,AUTO
         1 001633   200026 236100                    LDQ     RCVR,,AUTO
         1 001634   000001 736000                    QLS     1
         1 001635   400000 376003                    ANQ     -131072,DU
         1 001636   200042 376100                    ANQ     J+3,,AUTO
         1 001637   000001 772000                    QRL     1
         1 001640   200026 676100                    ERQ     RCVR,,AUTO
         1 001641   200000 376003                    ANQ     65536,DU
         1 001642   200026 656100                    ERSQ    RCVR,,AUTO

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:87   
      438     3238    3              IF RCVR.RETRY THEN DO;

   3238  1 001643   200026 234100                    SZN     RCVR,,AUTO
         1 001644   001672 605000 1                  TPL     s:3247

      439     3239    3                 IF NOT REQ.TYC THEN REQ.TYC.IOERR='1'B;

   3239  1 001645   000021 235100                    LDA     17,,PR0
         1 001646   001651 601000 1                  TNZ     s:3240

   3239  1 001647   001000 236003                    LDQ     512,DU
         1 001650   000021 256100                    ORSQ    17,,PR0

      440     3240    3                 CALL BGNRETRY ALTRET(REPOST);

   3240  1 001651   002507 701000 1                  TSX1    BGNRETRY
         1 001652   002474 702000 1                  TSX2    REPOST

      441     3241    3                 IF NOT RCVR.NOINC THEN REQ.ERRCT=REQ.ERRCT+1;

   3241  1 001653   200026 236100                    LDQ     RCVR,,AUTO
         1 001654   100000 316003                    CANQ    32768,DU
         1 001655   001662 601000 1                  TNZ     s:3242

   3241  1 001656   200027 470500                    LDP0    REQ$,,AUTO
         1 001657   000003 236100                    LDQ     3,,PR0
         1 001660   001000 036003                    ADLQ    512,DU
         1 001661   000003 552140                    STBQ    3,'40'O,PR0

      442     3242    4                 IF REQ.ERRCT>8 THEN DO;

   3242  1 001662   200027 470500                    LDP0    REQ$,,AUTO
         1 001663   000003 236100                    LDQ     3,,PR0
         1 001664   777000 376003                    ANQ     -512,DU
         1 001665   011000 116003                    CMPQ    4608,DU
         1 001666   001676 602000 1                  TNC     s:3250

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:88   
      443     3243    4                    RCVR.RETRY='0'B;

   3243  1 001667   000031 236000 xsym               LDQ     B_VECTNIL+25
         1 001670   200026 356100                    ANSQ    RCVR,,AUTO

      444     3244    4                    END;

      445     3245    3                 END;

   3245  1 001671   001676 710000 1                  TRA     s:3250

      446     3246    3              ELSE DO;                     /* NOT RCVR.RETRY */

      447     3247    3                 CALL CHECK_DONE;

   3247  1 001672   003302 701000 1                  TSX1    CHECK_DONE
         1 001673   000000 011000                    NOP     0

      448     3248    3                 CALL UPDATE_POS;

   3248  1 001674   003055 701000 1                  TSX1    UPDATE_POS
         1 001675   000000 011000                    NOP     0

      449     3249    3                 END;

      450     3250    2              IF NEWSTATE>%IDLE THEN RCVR.OPMSG='1'B;

   3250  1 001676   200015 235100                    LDA     NEWSTATE,,AUTO
         1 001677   002172 600000 1                  TZE     s:3332

   3250  1 001700   010000 236003                    LDQ     4096,DU
         1 001701   200026 256100                    ORSQ    RCVR,,AUTO
         1 001702   002172 710000 1                  TRA     s:3332

      451     3251    2            CASE(%COMP_FREPOS);

      452     3252    3              IF RCVR.RETRY THEN DO;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:89   

   3252  1 001703   200026 234100                    SZN     RCVR,,AUTO
         1 001704   001727 605000 1                  TPL     s:3258

      453     3253    3                 CALL BGNFREPOS;

   3253  1 001705   003006 701000 1                  TSX1    BGNFREPOS
         1 001706   000000 011000                    NOP     0

      454     3254    3                 NEWSTATE=%KIWAIT;

   3254  1 001707   000004 235007                    LDA     4,DL
         1 001710   200015 755100                    STA     NEWSTATE,,AUTO

      455     3255    3                 CALL NIK$OPMSG(DCT,MT_MSG#,M_TAPE,NEWSTATE,REQ);

   3255  1 001711   200027 236100                    LDQ     REQ$,,AUTO
         1 001712   200046 756100                    STQ     J+7,,AUTO
         1 001713   200015 630500                    EPPR0   NEWSTATE,,AUTO
         1 001714   200045 450500                    STP0    J+6,,AUTO
         1 001715   000016 236000 2                  LDQ     14
         1 001716   200044 756100                    STQ     J+5,,AUTO
         1 001717   000023 236000 2                  LDQ     19
         1 001720   200007 235100                    LDA     DCT$,,AUTO
         1 001721   200042 757100                    STAQ    J+3,,AUTO
         1 001722   200042 630500                    EPPR0   J+3,,AUTO
         1 001723   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 001724   000000 701000 xent               TSX1    NIK$OPMSG
         1 001725   000000 011000                    NOP     0

      456     3256    3                 END;

   3256  1 001726   002014 710000 1                  TRA     FREPOS_CONT

      457     3257    3              ELSE DO;

      458     3258    3                 CALL CHECK_DONE ALTRET(FREPOS_CONT);
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:90   

   3258  1 001727   003302 701000 1                  TSX1    CHECK_DONE
         1 001730   002014 702000 1                  TSX2    FREPOS_CONT

      459     3259    4                 DO CASE(REQ.POSTER);

   3259  1 001731   200027 470500                    LDP0    REQ$,,AUTO
         1 001732   000010 720100                    LXL0    8,,PR0
         1 001733   000777 360003                    ANX0    511,DU
         1 001734   000004 100003                    CMPX0   4,DU
         1 001735   001737 602010 1                  TNC     s:3259+6,X0
         1 001736   002014 710000 1                  TRA     FREPOS_CONT
         1 001737   002014 710000 1                  TRA     FREPOS_CONT
         1 001740   001743 710000 1                  TRA     s:3261
         1 001741   001762 710000 1                  TRA     FREPOS_SPR
         1 001742   002001 710000 1                  TRA     FREPOS_DONE

      460     3260    4                  CASE(%FREPOS_REWIND);

      461     3261    4                    IF DCT.MT.POS.FILECNT=0 THEN GOTO FREPOS_SPR;

   3261  1 001743   200007 471500                    LDP1    DCT$,,AUTO
         1 001744   100037 235100                    LDA     31,,PR1
         1 001745   001762 600000 1                  TZE     FREPOS_SPR

      462     3262    4                    REQ.FC=%N_SPFILE;

   3262  1 001746   000017 236007                    LDQ     15,DL
         1 001747   000003 552104                    STBQ    3,'04'O,PR0

      463     3263    4                    REQ.RCT=DCT.MT.POS.FILECNT;

   3263  1 001750   100037 720100                    LXL0    31,,PR1
         1 001751   200027 470500                    LDP0    REQ$,,AUTO
         1 001752   000030 440100                    SXL0    24,,PR0

      464     3264    4                    REQ.POSTER=%FREPOS_SPF;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:91   

   3264  1 001753   000002 236007                    LDQ     2,DL
         1 001754   000010 552104                    STBQ    8,'04'O,PR0

      465     3265    4                    CALL NIO$DCWBLD(REQ);

   3265  1 001755   200027 630500                    EPPR0   REQ$,,AUTO
         1 001756   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001757   000000 701000 xent               TSX1    NIO$DCWBLD
         1 001760   000000 011000                    NOP     0
         1 001761   002014 710000 1                  TRA     FREPOS_CONT

      466     3266    4                  CASE(%FREPOS_SPF);

      467     3267    4   FREPOS_SPR:      IF DCT.MT.POS.CRECCNT=0 THEN GOTO FREPOS_DONE;

   3267  1 001762   200007 471500       FREPOS_SPR   LDP1    DCT$,,AUTO
         1 001763   100035 235100                    LDA     29,,PR1
         1 001764   002001 600000 1                  TZE     FREPOS_DONE

      468     3268    4                    REQ.FC=%N_SPREC;

   3268  1 001765   000016 236007                    LDQ     14,DL
         1 001766   000003 552104                    STBQ    3,'04'O,PR0

      469     3269    4                    REQ.RCT=DCT.MT.POS.CRECCNT;

   3269  1 001767   100035 720100                    LXL0    29,,PR1
         1 001770   200027 470500                    LDP0    REQ$,,AUTO
         1 001771   000030 440100                    SXL0    24,,PR0

      470     3270    4                    REQ.POSTER=%FREPOS_SPR;

   3270  1 001772   000003 236007                    LDQ     3,DL
         1 001773   000010 552104                    STBQ    8,'04'O,PR0

      471     3271    4                    CALL NIO$DCWBLD(REQ);
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:92   

   3271  1 001774   200027 630500                    EPPR0   REQ$,,AUTO
         1 001775   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001776   000000 701000 xent               TSX1    NIO$DCWBLD
         1 001777   000000 011000                    NOP     0
         1 002000   002014 710000 1                  TRA     FREPOS_CONT

      472     3272    4                  CASE(%FREPOS_SPR);

      473     3273    4   FREPOS_DONE:     REQ$->REQ.IOQFLG.IOQUED = '0'B ;

   3273  1 002001   000024 236000 2     FREPOS_DONE  LDQ     20
         1 002002   000033 356100                    ANSQ    27,,PR0

      474     3274    4                    CALL NIQ$REL ( REQ$ ) ;

   3274  1 002003   200027 631500                    EPPR1   REQ$,,AUTO
         1 002004   200042 451500                    STP1    J+3,,AUTO
         1 002005   200042 630500                    EPPR0   J+3,,AUTO
         1 002006   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002007   000000 701000 xent               TSX1    NIQ$REL
         1 002010   000000 011000                    NOP     0

      475     3275    4                    DCT.MT.FREPOS$=ADDR(NIL);

   3275  1 002011   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 002012   200007 470500                    LDP0    DCT$,,AUTO
         1 002013   000031 756100                    STQ     25,,PR0

      476     3276    4                  END;

      477     3277    3   FREPOS_CONT:  END;

   3277  1 002014                       FREPOS_CONT  null
      478     3278    2              RCVR='0'B;                   /* RESET RCVR */

   3278  1 002014   200026 450100                    STZ     RCVR,,AUTO
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:93   

      479     3279    2              REQ$=ADDR(NIL);

   3279  1 002015   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 002016   200027 756100                    STQ     REQ$,,AUTO
         1 002017   002172 710000 1                  TRA     s:3332

      480     3280    2            CASE(%COMP_SETDENS);

      481     3281    3              IF RCVR.RETRY THEN DO;

   3281  1 002020   200026 234100                    SZN     RCVR,,AUTO
         1 002021   002045 605000 1                  TPL     s:3287

      482     3282    3                 CALL BGNFREPOS;

   3282  1 002022   003006 701000 1                  TSX1    BGNFREPOS
         1 002023   000000 011000                    NOP     0

      483     3283    3                 NEWSTATE=%KIWAIT;

   3283  1 002024   000004 235007                    LDA     4,DL
         1 002025   200015 755100                    STA     NEWSTATE,,AUTO

      484     3284    3                 CALL NIK$OPMSG(DCT,MT_MSG#,M_TAPE,NEWSTATE,DCT.MT.FREPOS$->REQ);

   3284  1 002026   200007 470500                    LDP0    DCT$,,AUTO
         1 002027   000031 471500                    LDP1    25,,PR0
         1 002030   200046 451500                    STP1    J+7,,AUTO
         1 002031   200015 633500                    EPPR3   NEWSTATE,,AUTO
         1 002032   200045 453500                    STP3    J+6,,AUTO
         1 002033   000016 236000 2                  LDQ     14
         1 002034   200044 756100                    STQ     J+5,,AUTO
         1 002035   000023 236000 2                  LDQ     19
         1 002036   200007 235100                    LDA     DCT$,,AUTO
         1 002037   200042 757100                    STAQ    J+3,,AUTO
         1 002040   200042 630500                    EPPR0   J+3,,AUTO
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:94   
         1 002041   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 002042   000000 701000 xent               TSX1    NIK$OPMSG
         1 002043   000000 011000                    NOP     0

      485     3285    3                 END;

   3285  1 002044   002047 710000 1                  TRA     s:3289

      486     3286    3              ELSE DO;

      487     3287    3                 CALL CHECK_DONE ALTRET(SETDENS_CONT);

   3287  1 002045   003302 701000 1                  TSX1    CHECK_DONE
         1 002046   002063 702000 1                  TSX2    SETDENS_CONT

      488     3288    3                 END;

      489     3289    2              REQ$->REQ.IOQFLG.IOQUED = '0'B ;

   3289  1 002047   200027 470500                    LDP0    REQ$,,AUTO
         1 002050   000024 236000 2                  LDQ     20
         1 002051   000033 356100                    ANSQ    27,,PR0

      490     3290    2              CALL NIQ$REL (REQ$);

   3290  1 002052   200027 631500                    EPPR1   REQ$,,AUTO
         1 002053   200042 451500                    STP1    J+3,,AUTO
         1 002054   200042 630500                    EPPR0   J+3,,AUTO
         1 002055   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002056   000000 701000 xent               TSX1    NIQ$REL
         1 002057   000000 011000                    NOP     0

      491     3291    2              DCT.MT.SETDENS$=ADDR(NIL);

   3291  1 002060   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 002061   200007 470500                    LDP0    DCT$,,AUTO
         1 002062   000042 756100                    STQ     34,,PR0
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:95   

      492     3292    2   SETDENS_CONT:
      493     3293    2              RCVR='0'B;

   3293  1 002063   200026 450100       SETDENS_CONT STZ     RCVR,,AUTO

      494     3294    2              REQ$=ADDR(NIL);

   3294  1 002064   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 002065   200027 756100                    STQ     REQ$,,AUTO
         1 002066   002172 710000 1                  TRA     s:3332

      495     3295    2            CASE(%COMP_IOS);

      496     3296    3              IF REQ.FC=%N_EXTST THEN DO;

   3296  1 002067   000003 236100                    LDQ     3,,PR0
         1 002070   000777 376007                    ANQ     511,DL
         1 002071   000033 116007                    CMPQ    27,DL
         1 002072   002114 601000 1                  TNZ     s:3305

      497     3297    3                 NEWSTATE=REQ.EAINFOX;

   3297  1 002073   000025 235100                    LDA     21,,PR0
         1 002074   200015 755100                    STA     NEWSTATE,,AUTO

      498     3298    3                 DCT.MT.FREPOS$=REQ.EAINFOP$;

   3298  1 002075   000024 236100                    LDQ     20,,PR0
         1 002076   200007 471500                    LDP1    DCT$,,AUTO
         1 002077   100031 756100                    STQ     25,,PR1

      499     3299    3                 RCVR='0'B;

   3299  1 002100   200026 450100                    STZ     RCVR,,AUTO

      500     3300    3                 REQ$->REQ.IOQFLG.IOQUED = '0'B ;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:96   

   3300  1 002101   000024 236000 2                  LDQ     20
         1 002102   000033 356100                    ANSQ    27,,PR0

      501     3301    3                 CALL NIQ$REL(REQ$);

   3301  1 002103   200027 633500                    EPPR3   REQ$,,AUTO
         1 002104   200042 453500                    STP3    J+3,,AUTO
         1 002105   200042 630500                    EPPR0   J+3,,AUTO
         1 002106   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002107   000000 701000 xent               TSX1    NIQ$REL
         1 002110   000000 011000                    NOP     0

      502     3302    3                 REQ$=ADDR(NIL);

   3302  1 002111   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 002112   200027 756100                    STQ     REQ$,,AUTO

      503     3303    3                 END;

   3303  1 002113   002172 710000 1                  TRA     s:3332

      504     3304    3              ELSE DO;                     /* NOT EXTST */

      505     3305    4                 IF RCVR.RETRY THEN DO;

   3305  1 002114   200026 234100                    SZN     RCVR,,AUTO
         1 002115   002127 605000 1                  TPL     s:3312

      506     3306    4                    RCVR.RETRY='0'B;

   3306  1 002116   000031 236000 xsym               LDQ     B_VECTNIL+25
         1 002117   200026 356100                    ANSQ    RCVR,,AUTO

      507     3307    4                    RCVR.FREPOS='1'B;

   3307  1 002120   020000 236003                    LDQ     8192,DU
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:97   
         1 002121   200026 256100                    ORSQ    RCVR,,AUTO

      508     3308    4                    NEWSTATE=%KIWAIT;

   3308  1 002122   000004 235007                    LDA     4,DL
         1 002123   200015 755100                    STA     NEWSTATE,,AUTO

      509     3309    4                    RCVR.OPMSG='1'B;

   3309  1 002124   010000 236003                    LDQ     4096,DU
         1 002125   200026 256100                    ORSQ    RCVR,,AUTO

      510     3310    4                    END;

   3310  1 002126   002172 710000 1                  TRA     s:3332

      511     3311    4                 ELSE DO;

      512     3312    4                    CALL CHECK_DONE ALTRET(IOS_CONT);

   3312  1 002127   003302 701000 1                  TSX1    CHECK_DONE
         1 002130   002166 702000 1                  TSX2    IOS_CONT

      513     3313    5                    DO CASE(REQ.POSTER);

   3313  1 002131   200027 470500                    LDP0    REQ$,,AUTO
         1 002132   000010 720100                    LXL0    8,,PR0
         1 002133   000777 360003                    ANX0    511,DU
         1 002134   000005 100003                    CMPX0   5,DU
         1 002135   002137 602010 1                  TNC     s:3313+6,X0
         1 002136   002166 710000 1                  TRA     IOS_CONT
         1 002137   002166 710000 1                  TRA     IOS_CONT
         1 002140   002166 710000 1                  TRA     IOS_CONT
         1 002141   002144 710000 1                  TRA     s:3316
         1 002142   002166 710000 1                  TRA     IOS_CONT
         1 002143   002160 710000 1                  TRA     s:3321

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:98   
      514     3314    5                     CASE(RTY_READ_SRB);

      515     3315    5                     CASE(RTY_WRITE_SRB);

      516     3316    5                       REQ.FC=%N_ERASE;

   3316  1 002144   000034 236007                    LDQ     28,DL
         1 002145   000003 552104                    STBQ    3,'04'O,PR0

      517     3317    5                       CALL NIO$DCWBLD(REQ);

   3317  1 002146   200027 630500                    EPPR0   REQ$,,AUTO
         1 002147   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002150   000000 701000 xent               TSX1    NIO$DCWBLD
         1 002151   000000 011000                    NOP     0

      518     3318    5                       RCVR.RETRY='1'B;

   3318  1 002152   400000 236003                    LDQ     -131072,DU
         1 002153   200026 256100                    ORSQ    RCVR,,AUTO

      519     3319    5                       REQ.POSTER=RTY_WRITE_ERASE;

   3319  1 002154   200027 470500                    LDP0    REQ$,,AUTO
         1 002155   000004 236007                    LDQ     4,DL
         1 002156   000010 552104                    STBQ    8,'04'O,PR0
         1 002157   002166 710000 1                  TRA     IOS_CONT

      520     3320    5                     CASE(RTY_WRITE_ERASE);

      521     3321    6                       IF REQ.EAINFO>0 THEN DO;

   3321  1 002160   000024 235100                    LDA     20,,PR0
         1 002161   002166 600000 1                  TZE     IOS_CONT

      522     3322    6                          REQ.EAINFO=REQ.EAINFO-1;

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:99   
   3322  1 002162   000001 135007                    SBLA    1,DL
         1 002163   000024 755100                    STA     20,,PR0

      523     3323    6                          RCVR.RETRY='1'B;

   3323  1 002164   400000 236003                    LDQ     -131072,DU
         1 002165   200026 256100                    ORSQ    RCVR,,AUTO

      524     3324    6                          END;

      525     3325    5                     END;

      526     3326    4   IOS_CONT:        END;

   3326  1 002166                       IOS_CONT     null
      527     3327    3                 END;                      /* NOT EXTST */

   3327  1 002166   002172 710000 1                  TRA     s:3332

      528     3328    2            CASE(%COMP_TD);

      529     3329    2              REQ.EAINFO=CHANTIME;

   3329  1 002167   200006 235100                    LDA     CHANTIME,,AUTO
         1 002170   000024 755100                    STA     20,,PR0

      530     3330    2              RCVR='0'B;

   3330  1 002171   200026 450100                    STZ     RCVR,,AUTO

      531     3331    2            END;                           /* CASE REQ.COMP */

      532     3332    1           IF RCVR.FREPOS THEN CALL BGNFREPOS ALTRET(REPOST);

   3332  1 002172   200026 236100                    LDQ     RCVR,,AUTO
         1 002173   020000 316003                    CANQ    8192,DU
         1 002174   002177 600000 1                  TZE     s:3333
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:100  

   3332  1 002175   003006 701000 1                  TSX1    BGNFREPOS
         1 002176   002474 702000 1                  TSX2    REPOST

      533     3333    1           IF RCVR.SETDENS THEN

   3333  1 002177   200026 236100                    LDQ     RCVR,,AUTO
         1 002200   000400 316003                    CANQ    256,DU
         1 002201   002204 600000 1                  TZE     s:3335

      534     3334    1              CALL SETDENS;

   3334  1 002202   003672 701000 1                  TSX1    SETDENS
         1 002203   000000 011000                    NOP     0

      535     3335    2           IF REQ$~=ADDR(NIL) THEN DO;

   3335  1 002204   200027 236100                    LDQ     REQ$,,AUTO
         1 002205   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002206   002412 600000 1                  TZE     s:3384

      536     3336    3              IF RCVR.OPMSG THEN DO;

   3336  1 002207   200026 236100                    LDQ     RCVR,,AUTO
         1 002210   010000 316003                    CANQ    4096,DU
         1 002211   002227 600000 1                  TZE     s:3339

      537     3337    3                 CALL NIK$OPMSG(DCT,MT_MSG#,M_TAPE,NEWSTATE,REQ);

   3337  1 002212   200027 236100                    LDQ     REQ$,,AUTO
         1 002213   200046 756100                    STQ     J+7,,AUTO
         1 002214   200015 630500                    EPPR0   NEWSTATE,,AUTO
         1 002215   200045 450500                    STP0    J+6,,AUTO
         1 002216   000016 236000 2                  LDQ     14
         1 002217   200044 756100                    STQ     J+5,,AUTO
         1 002220   000023 236000 2                  LDQ     19
         1 002221   200007 235100                    LDA     DCT$,,AUTO
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:101  
         1 002222   200042 757100                    STAQ    J+3,,AUTO
         1 002223   200042 630500                    EPPR0   J+3,,AUTO
         1 002224   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 002225   000000 701000 xent               TSX1    NIK$OPMSG
         1 002226   000000 011000                    NOP     0

      538     3338    3                 END;

      539     3339    3              IF RCVR.LOGERR THEN DO;

   3339  1 002227   200026 236100                    LDQ     RCVR,,AUTO
         1 002230   040000 316003                    CANQ    16384,DU
         1 002231   002241 600000 1                  TZE     s:3342

      540     3340    3                 CALL NIA$LOGERR(REQ,EL_IOERR);

   3340  1 002232   000026 236000 2                  LDQ     22
         1 002233   200027 235100                    LDA     REQ$,,AUTO
         1 002234   200042 757100                    STAQ    J+3,,AUTO
         1 002235   200042 630500                    EPPR0   J+3,,AUTO
         1 002236   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002237   000000 701000 xent               TSX1    NIA$LOGERR
         1 002240   000000 011000                    NOP     0

      541     3341    3                 END;

      542     3342    3              IF REQ.ERR$~=ADDR(NIL) THEN DO;

   3342  1 002241   200027 470500                    LDP0    REQ$,,AUTO
         1 002242   000017 236100                    LDQ     15,,PR0
         1 002243   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002244   002357 600000 1                  TZE     NOEXTST

      543     3343    4                 IF NOT REQ.ERR$->NI$IOERR.GOTEXTST THEN DO;

   3343  1 002245   000017 471500                    LDP1    15,,PR0
         1 002246   100020 236100                    LDQ     16,,PR1
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:102  
         1 002247   020000 316003                    CANQ    8192,DU
         1 002250   002357 601000 1                  TNZ     NOEXTST

      544     3344    5                    IF HW_EXT_STATUS THEN DO;

   3344  1 002251   000000 234000 xsym               SZN     HW_EXT_STATUS
         1 002252   002265 605000 1                  TPL     s:3350

      545     3345    6                       IF NI$EXTST.EXTSTT.WRD(0)~=0 THEN DO;

   3345  1 002253   200016 235100                    LDA     NI$EXTST,,AUTO
         1 002254   002357 600000 1                  TZE     NOEXTST

      546     3346    6                          REQ.ERR$->NI$IOERR.EXTST=NI$EXTST.EXTST;

   3346  1 002255   000100 100500                    MLR     fill='000'O
         1 002256   200016 000040                    ADSC9   NI$EXTST,,AUTO           cn=0,n=32
         1 002257   100007 000040                    ADSC9   7,,PR1                   cn=0,n=32

      547     3347    6                          REQ.ERR$->NI$IOERR.GOTEXTST='1'B;

   3347  1 002260   200027 470500                    LDP0    REQ$,,AUTO
         1 002261   000017 471500                    LDP1    15,,PR0
         1 002262   020000 236003                    LDQ     8192,DU
         1 002263   100020 256100                    ORSQ    16,,PR1

      548     3348    6                          END;

      549     3349    5                       END;

   3349  1 002264   002357 710000 1                  TRA     NOEXTST

      550     3350    5                    ELSE IF RCVR.EXTST THEN DO;

   3350  1 002265   200026 236100                    LDQ     RCVR,,AUTO
         1 002266   002000 316003                    CANQ    1024,DU
         1 002267   002357 600000 1                  TZE     NOEXTST
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:103  

      551     3351    5                          CALL NIQ$GET(EXTST$) ALTRET(NOEXTST);

   3351  1 002270   200011 633500                    EPPR3   EXTST$,,AUTO
         1 002271   200042 453500                    STP3    J+3,,AUTO
         1 002272   200042 630500                    EPPR0   J+3,,AUTO
         1 002273   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002274   000000 701000 xent               TSX1    NIQ$GET
         1 002275   002357 702000 1                  TSX2    NOEXTST

      552     3352    5                          EXTST$->REQ.FC=%N_EXTST;

   3352  1 002276   200011 470500                    LDP0    EXTST$,,AUTO
         1 002277   000033 236007                    LDQ     27,DL
         1 002300   000003 552104                    STBQ    3,'04'O,PR0

      553     3353    5                          EXTST$->REQ.OPFLG=OP_BPF;

   3353  1 002301   200011 470500                    LDP0    EXTST$,,AUTO
         1 002302   000010 236007                    LDQ     8,DL
         1 002303   000004 552104                    STBQ    4,'04'O,PR0

      554     3354    5                          EXTST$->REQ.BUF$=ADDR(REQ.ERR$->NI$IOERR.EXTST);

   3354  1 002304   200027 470500                    LDP0    REQ$,,AUTO
         1 002305   000017 471500                    LDP1    15,,PR0
         1 002306   100007 633500                    EPPR3   7,,PR1
         1 002307   200011 474500                    LDP4    EXTST$,,AUTO
         1 002310   400005 453500                    STP3    5,,PR4

      555     3355    5                          EXTST$->REQ.BUFSIZE=SIZEC(NI$IOERR.EXTST);

   3355  1 002311   200011 470500                    LDP0    EXTST$,,AUTO
         1 002312   000004 236100                    LDQ     4,,PR0
         1 002313   177777 376007                    ANQ     65535,DL
         1 002314   000010 276003                    ORQ     8,DU
         1 002315   000004 756100                    STQ     4,,PR0
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:104  

      556     3356    5                          EXTST$->REQ.DLA=REQ.DLA;

   3356  1 002316   200027 470500                    LDP0    REQ$,,AUTO
         1 002317   000001 236100                    LDQ     1,,PR0
         1 002320   200011 471500                    LDP1    EXTST$,,AUTO
         1 002321   100001 756100                    STQ     1,,PR1

      557     3357    5                          EXTST$->REQ.COMP=%COMP_IOS;

   3357  1 002322   200011 470500                    LDP0    EXTST$,,AUTO
         1 002323   000027 236100                    LDQ     23,,PR0
         1 002324   000027 376000 2                  ANQ     23
         1 002325   003000 276007                    ORQ     1536,DL
         1 002326   000027 756100                    STQ     23,,PR0

      558     3358    5                          CALL NIO$DCWBLD(EXTST$->REQ) ALTRET(NOEXTST0);

   3358  1 002327   200011 630500                    EPPR0   EXTST$,,AUTO
         1 002330   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002331   000000 701000 xent               TSX1    NIO$DCWBLD
         1 002332   002351 702000 1                  TSX2    NOEXTST0

      559     3359    5                          REQ.ERR$->NI$IOERR.GOTEXTST='1'B;

   3359  1 002333   200027 470500                    LDP0    REQ$,,AUTO
         1 002334   000017 471500                    LDP1    15,,PR0
         1 002335   020000 236003                    LDQ     8192,DU
         1 002336   100020 256100                    ORSQ    16,,PR1

      560     3360    5                          EXTST$->REQ.EAINFOP$=DCT.MT.FREPOS$;

   3360  1 002337   200007 470500                    LDP0    DCT$,,AUTO
         1 002340   000031 236100                    LDQ     25,,PR0
         1 002341   200011 471500                    LDP1    EXTST$,,AUTO
         1 002342   100024 756100                    STQ     20,,PR1

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:105  
      561     3361    5                          DCT.MT.FREPOS$=ADDR(NIL);

   3361  1 002343   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 002344   000031 756100                    STQ     25,,PR0

      562     3362    5                          EXTST$->REQ.EAINFOX=NEWSTATE;

   3362  1 002345   200015 235100                    LDA     NEWSTATE,,AUTO
         1 002346   100025 755100                    STA     21,,PR1

      563     3363    5                          NEWSTATE=%IDLE;

   3363  1 002347   200015 450100                    STZ     NEWSTATE,,AUTO

      564     3364    6                          DO NEVER;

   3364  1 002350   002357 710000 1                  TRA     NOEXTST

      565     3365    6   NOEXTST0:                 CALL NIQ$REL(EXTST$);

   3365  1 002351   200011 630500       NOEXTST0     EPPR0   EXTST$,,AUTO
         1 002352   200042 450500                    STP0    J+3,,AUTO
         1 002353   200042 630500                    EPPR0   J+3,,AUTO
         1 002354   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002355   000000 701000 xent               TSX1    NIQ$REL
         1 002356   000000 011000                    NOP     0

      566     3366    6                             END;

      567     3367    5   NOEXTST:               END;

   3367  1 002357                       NOEXTST      null
      568     3368    4                    END;

      569     3369    3                 END;

      570     3370    3              IF RCVR.RETRY THEN DO;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:106  

   3370  1 002357   200026 234100                    SZN     RCVR,,AUTO
         1 002360   002402 605000 1                  TPL     s:3381

      571     3371                      %LOCK (G#=SQH.GATE);

   3372  1 002361   200032 630500                    EPPR0   SQH$,,AUTO
         1 002362   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002363   000000 701000 xent               TSX1    HFC$LOCK
         1 002364   000000 011000                    NOP     0

      572     3374                      %REQUEUE (P#=REQ,Q#=DCT.SQ$);

   3375  1 002365   200007 236100                    LDQ     DCT$,,AUTO
         1 002366   000001 036003                    ADLQ    1,DU
         1 002367   200027 235100                    LDA     REQ$,,AUTO
         1 002370   200042 757100                    STAQ    J+3,,AUTO
         1 002371   200042 630500                    EPPR0   J+3,,AUTO
         1 002372   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002373   000000 701000 xent               TSX1    NIM$REQUEUE
         1 002374   000000 011000                    NOP     0

      573     3377                      %UNLOCK (G#=SQH.GATE);

   3378  1 002375   200032 630500                    EPPR0   SQH$,,AUTO
         1 002376   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002377   000000 701000 xent               TSX1    HFC$UNLOCK
         1 002400   000000 011000                    NOP     0

      574     3380    3                 END;

   3380  1 002401   002412 710000 1                  TRA     s:3384

      575     3381    2              ELSE CALL NIO$COMP(REQ,NI$EXTST);

   3381  1 002402   200016 630500                    EPPR0   NI$EXTST,,AUTO
         1 002403   200043 450500                    STP0    J+4,,AUTO
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:107  
         1 002404   200027 236100                    LDQ     REQ$,,AUTO
         1 002405   200042 756100                    STQ     J+3,,AUTO
         1 002406   200042 630500                    EPPR0   J+3,,AUTO
         1 002407   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002410   000000 701000 xent               TSX1    NIO$COMP
         1 002411   000000 011000                    NOP     0

      576     3382    2              END;                         /* IF REQ$ */

      577     3383                %LOCK (G#=SQH.GATE);

   3384  1 002412   200032 630500                    EPPR0   SQH$,,AUTO
         1 002413   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002414   000000 701000 xent               TSX1    HFC$LOCK
         1 002415   000000 011000                    NOP     0

      578     3386    2           IF REPOS$~=ADDR(NIL) THEN DO;

   3386  1 002416   200030 236100                    LDQ     REPOS$,,AUTO
         1 002417   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002420   002431 600000 1                  TZE     s:3391

      579     3387                   %REQUEUE (P#="REPOS$->REQ",Q#=DCT.SQ$);

   3388  1 002421   200007 236100                    LDQ     DCT$,,AUTO
         1 002422   000001 036003                    ADLQ    1,DU
         1 002423   200030 235100                    LDA     REPOS$,,AUTO
         1 002424   200042 757100                    STAQ    J+3,,AUTO
         1 002425   200042 630500                    EPPR0   J+3,,AUTO
         1 002426   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002427   000000 701000 xent               TSX1    NIM$REQUEUE
         1 002430   000000 011000                    NOP     0

      580     3390    2              END;

      581     3391    2           IF SETDENS$~=ADDR(NIL) THEN DO;

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:108  
   3391  1 002431   200031 236100                    LDQ     SETDENS$,,AUTO
         1 002432   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002433   002444 600000 1                  TZE     s:3396

      582     3392                   %REQUEUE (P#="SETDENS$->REQ",Q#=DCT.SQ$);

   3393  1 002434   200007 236100                    LDQ     DCT$,,AUTO
         1 002435   000001 036003                    ADLQ    1,DU
         1 002436   200031 235100                    LDA     SETDENS$,,AUTO
         1 002437   200042 757100                    STAQ    J+3,,AUTO
         1 002440   200042 630500                    EPPR0   J+3,,AUTO
         1 002441   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002442   000000 701000 xent               TSX1    NIM$REQUEUE
         1 002443   000000 011000                    NOP     0

      583     3395    2              END;

      584     3396    2           IF EXTST$~=ADDR(NIL) THEN DO;

   3396  1 002444   200011 236100                    LDQ     EXTST$,,AUTO
         1 002445   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002446   002457 600000 1                  TZE     s:3402

      585     3397                   %REQUEUE (P#="EXTST$->REQ",Q#=DCT.SQ$);

   3398  1 002447   200007 236100                    LDQ     DCT$,,AUTO
         1 002450   000001 036003                    ADLQ    1,DU
         1 002451   200011 235100                    LDA     EXTST$,,AUTO
         1 002452   200042 757100                    STAQ    J+3,,AUTO
         1 002453   200042 630500                    EPPR0   J+3,,AUTO
         1 002454   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002455   000000 701000 xent               TSX1    NIM$REQUEUE
         1 002456   000000 011000                    NOP     0

      586     3400    2              END;

      587     3401                %UNLOCK (G#=SQH.GATE);
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:109  

   3402  1 002457   200032 630500                    EPPR0   SQH$,,AUTO
         1 002460   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002461   000000 701000 xent               TSX1    HFC$UNLOCK
         1 002462   000000 011000                    NOP     0

      588     3404    1           CALL NIT$DEVSCHED(DCT,NEWSTATE);

   3404  1 002463   200015 630500                    EPPR0   NEWSTATE,,AUTO
         1 002464   200043 450500                    STP0    J+4,,AUTO
         1 002465   200007 236100                    LDQ     DCT$,,AUTO
         1 002466   200042 756100                    STQ     J+3,,AUTO
         1 002467   200042 630500                    EPPR0   J+3,,AUTO
         1 002470   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002471   000000 701000 xent               TSX1    NIT$DEVSCHED
         1 002472   000000 011000                    NOP     0

      589     3405    1           RETURN;

   3405  1 002473   000000 702200 xent               TSX2  ! X66_ARET

      590     3406        /**/
      591     3407    1   REPOST:
      592     3408    1           CALL SETREPOST;

   3408  1 002474   002633 701000 1     REPOST       TSX1    SETREPOST
         1 002475   000000 011000                    NOP     0

      593     3409    1           CALL NIT$DEVSCHED(DCT,NEWSTATE);

   3409  1 002476   200015 630500                    EPPR0   NEWSTATE,,AUTO
         1 002477   200043 450500                    STP0    J+4,,AUTO
         1 002500   200007 236100                    LDQ     DCT$,,AUTO
         1 002501   200042 756100                    STQ     J+3,,AUTO
         1 002502   200042 630500                    EPPR0   J+3,,AUTO
         1 002503   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002504   000000 701000 xent               TSX1    NIT$DEVSCHED
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:110  
         1 002505   000000 011000                    NOP     0

      594     3410    1           RETURN;

   3410  1 002506   000000 702200 xent               TSX2  ! X66_ARET

      595     3411        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:111  
      596     3412    1   BGNRETRY: PROC ALTRET;

   3412  1 002507   200034 741300       BGNRETRY     STX1  ! SQH$+2,,AUTO

      597     3413    3           IF RCVR.REPOS THEN DO CASE(REQ.FC);

   3413  1 002510   200026 236100                    LDQ     RCVR,,AUTO
         1 002511   200000 316003                    CANQ    65536,DU
         1 002512   002627 600000 1                  TZE     s:3436

   3413  1 002513   200027 470500                    LDP0    REQ$,,AUTO
         1 002514   000003 720100                    LXL0    3,,PR0
         1 002515   000777 360003                    ANX0    511,DU
         1 002516   000030 100003                    CMPX0   24,DU
         1 002517   002521 602010 1                  TNC     s:3413+9,X0
         1 002520   002625 710000 1                  TRA     s:3434
         1 002521   002551 710000 1                  TRA     s:3415
         1 002522   002625 710000 1                  TRA     s:3434
         1 002523   002554 710000 1                  TRA     s:3417
         1 002524   002574 710000 1                  TRA     s:3423
         1 002525   002554 710000 1                  TRA     s:3417
         1 002526   002574 710000 1                  TRA     s:3423
         1 002527   002617 710000 1                  TRA     s:3430
         1 002530   002625 710000 1                  TRA     s:3434
         1 002531   002617 710000 1                  TRA     s:3430
         1 002532   002625 710000 1                  TRA     s:3434
         1 002533   002551 710000 1                  TRA     s:3415
         1 002534   002625 710000 1                  TRA     s:3434
         1 002535   002554 710000 1                  TRA     s:3417
         1 002536   002574 710000 1                  TRA     s:3423
         1 002537   002622 710000 1                  TRA     s:3432
         1 002540   002622 710000 1                  TRA     s:3432
         1 002541   002625 710000 1                  TRA     s:3434
         1 002542   002625 710000 1                  TRA     s:3434
         1 002543   002625 710000 1                  TRA     s:3434
         1 002544   002625 710000 1                  TRA     s:3434
         1 002545   002625 710000 1                  TRA     s:3434
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:112  
         1 002546   002625 710000 1                  TRA     s:3434
         1 002547   002625 710000 1                  TRA     s:3434
         1 002550   002617 710000 1                  TRA     s:3430

      598     3414    3            CASE(%N_DCWLIST,%N_WRFM);

      599     3415    3              CALL BGNFREPOS ALTRET(REPOST);

   3415  1 002551   003006 701000 1                  TSX1    BGNFREPOS
         1 002552   002631 702000 1                  TSX2    REPOST
         1 002553   002627 710000 1                  TRA     s:3436

      600     3416    3            CASE(%N_RDBIN,%N_RDASC,%N_READ);

      601     3417    3              CALL GETRTY ALTRET(REPOST);

   3417  1 002554   002712 701000 1                  TSX1    GETRTY
         1 002555   002631 702000 1                  TSX2    REPOST

      602     3418    3              REPOS$->REQ.FC=%N_SPREC;

   3418  1 002556   200030 470500                    LDP0    REPOS$,,AUTO
         1 002557   000016 236007                    LDQ     14,DL
         1 002560   000003 552104                    STBQ    3,'04'O,PR0

      603     3419    3              REPOS$->REQ.RCT=-1;

   3419  1 002561   777777 220003                    LDX0    -1,DU
         1 002562   200030 470500                    LDP0    REPOS$,,AUTO
         1 002563   000030 440100                    SXL0    24,,PR0

      604     3420    3              REPOS$->REQ.POSTER=RTY_READ_SRB;

   3420  1 002564   200030 470500                    LDP0    REPOS$,,AUTO
         1 002565   000001 236007                    LDQ     1,DL
         1 002566   000010 552104                    STBQ    8,'04'O,PR0

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:113  
      605     3421    3              CALL NIO$DCWBLD(REPOS$->REQ) ALTRET(REPOST);

   3421  1 002567   200030 630500                    EPPR0   REPOS$,,AUTO
         1 002570   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002571   000000 701000 xent               TSX1    NIO$DCWBLD
         1 002572   002631 702000 1                  TSX2    REPOST
         1 002573   002627 710000 1                  TRA     s:3436

      606     3422    3            CASE(%N_WRBIN,%N_WRASC,%N_WRITE);

      607     3423    3              CALL GETRTY ALTRET(REPOST);

   3423  1 002574   002712 701000 1                  TSX1    GETRTY
         1 002575   002631 702000 1                  TSX2    REPOST

      608     3424    3              REPOS$->REQ.FC=%N_SPREC;

   3424  1 002576   200030 470500                    LDP0    REPOS$,,AUTO
         1 002577   000016 236007                    LDQ     14,DL
         1 002600   000003 552104                    STBQ    3,'04'O,PR0

      609     3425    3              REPOS$->REQ.RCT=-1;

   3425  1 002601   777777 220003                    LDX0    -1,DU
         1 002602   200030 470500                    LDP0    REPOS$,,AUTO
         1 002603   000030 440100                    SXL0    24,,PR0

      610     3426    3              REPOS$->REQ.POSTER=RTY_WRITE_SRB;

   3426  1 002604   200030 470500                    LDP0    REPOS$,,AUTO
         1 002605   000002 236007                    LDQ     2,DL
         1 002606   000010 552104                    STBQ    8,'04'O,PR0

      611     3427    3              REPOS$->REQ.EAINFO=1;        /* SET NUMBER OF ERASES */

   3427  1 002607   000001 235007                    LDA     1,DL
         1 002610   200030 470500                    LDP0    REPOS$,,AUTO
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:114  
         1 002611   000024 755100                    STA     20,,PR0

      612     3428    3              CALL NIO$DCWBLD(REPOS$->REQ) ALTRET(REPOST);

   3428  1 002612   200030 630500                    EPPR0   REPOS$,,AUTO
         1 002613   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002614   000000 701000 xent               TSX1    NIO$DCWBLD
         1 002615   002631 702000 1                  TSX2    REPOST
         1 002616   002627 710000 1                  TRA     s:3436

      613     3429    3            CASE(%N_REWIND,%N_UNLOAD,%N_LDTAPE);

      614     3430    3              RCVR.FREPOS='0'B;

   3430  1 002617   000030 236000 2                  LDQ     24
         1 002620   200026 356100                    ANSQ    RCVR,,AUTO
         1 002621   002627 710000 1                  TRA     s:3436

      615     3431    3            CASE(%N_SPFILE,%N_SPREC);

      616     3432    3              CALL BGNFREPOS ALTRET(REPOST);

   3432  1 002622   003006 701000 1                  TSX1    BGNFREPOS
         1 002623   002631 702000 1                  TSX2    REPOST
         1 002624   002627 710000 1                  TRA     s:3436

      617     3433    3            CASE(ELSE);

      618     3434    3              RCVR.RETRY='0'B;

   3434  1 002625   000031 236000 xsym               LDQ     B_VECTNIL+25
         1 002626   200026 356100                    ANSQ    RCVR,,AUTO

      619     3435    3            END;

      620     3436    2           RETURN;

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:115  
   3436  1 002627   200034 221300                    LDX1  ! SQH$+2,,AUTO
         1 002630   000001 702211                    TSX2  ! 1,X1

      621     3437    2   REPOST: ALTRETURN;

   3437  1 002631   200034 221300       REPOST       LDX1  ! SQH$+2,,AUTO
         1 002632   000000 702211                    TSX2  ! 0,X1

      622     3438    2   END BGNRETRY;
      623     3439        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:116  
      624     3440    1   SETREPOST: PROC;

   3440  1 002633   200034 741300       SETREPOST    STX1  ! SQH$+2,,AUTO

      625     3441    3           IF EXTST$ ~= ADDR(NIL) THEN DO ;

   3441  1 002634   200011 236100                    LDQ     EXTST$,,AUTO
         1 002635   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002636   002650 600000 1                  TZE     s:3445

      626     3442    3              EXTST$->REQ.IOQFLG.IOQUED = '0'B ;

   3442  1 002637   200011 470500                    LDP0    EXTST$,,AUTO
         1 002640   000024 236000 2                  LDQ     20
         1 002641   000033 356100                    ANSQ    27,,PR0

      627     3443    3              CALL NIQ$REL ( EXTST$ ) ;

   3443  1 002642   200011 631500                    EPPR1   EXTST$,,AUTO
         1 002643   200042 451500                    STP1    J+3,,AUTO
         1 002644   200042 630500                    EPPR0   J+3,,AUTO
         1 002645   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002646   000000 701000 xent               TSX1    NIQ$REL
         1 002647   000000 011000                    NOP     0

      628     3444    3              END ;

      629     3445    3           IF REPOS$ ~= ADDR(NIL) THEN DO ;

   3445  1 002650   200030 236100                    LDQ     REPOS$,,AUTO
         1 002651   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002652   002664 600000 1                  TZE     s:3450

      630     3446    3              REPOS$->REQ.IOQFLG.IOQUED = '0'B ;

   3446  1 002653   200030 470500                    LDP0    REPOS$,,AUTO
         1 002654   000024 236000 2                  LDQ     20
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:117  
         1 002655   000033 356100                    ANSQ    27,,PR0

      631     3447    3              CALL NIQ$REL ( REPOS$ ) ;

   3447  1 002656   200030 631500                    EPPR1   REPOS$,,AUTO
         1 002657   200042 451500                    STP1    J+3,,AUTO
         1 002660   200042 630500                    EPPR0   J+3,,AUTO
         1 002661   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002662   000000 701000 xent               TSX1    NIQ$REL
         1 002663   000000 011000                    NOP     0

      632     3448    3              END ;

      633     3449                %LOCK (G#=NI$RP.GATE);

   3450  1 002664   000000 630400 xsym               EPPR0   NI$RP$
         1 002665   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002666   000000 701000 xent               TSX1    HFC$LOCK
         1 002667   000000 011000                    NOP     0

      634     3452                %ENQUEUE(Q#=NI$RP.RP$,P#=REQ);

   3453  1 002670   000000 236000 xsym               LDQ     NI$RP$
         1 002671   000002 036003                    ADLQ    2,DU
         1 002672   200027 235100                    LDA     REQ$,,AUTO
         1 002673   200042 757100                    STAQ    J+3,,AUTO
         1 002674   200042 630500                    EPPR0   J+3,,AUTO
         1 002675   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002676   000000 701000 xent               TSX1    NIM$ENQUEUE
         1 002677   000000 011000                    NOP     0

      635     3455                %UNLOCK(G#=NI$RP.GATE);

   3456  1 002700   000000 630400 xsym               EPPR0   NI$RP$
         1 002701   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002702   000000 701000 xent               TSX1    HFC$UNLOCK
         1 002703   000000 011000                    NOP     0
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:118  

      636     3458    2           NEWSTATE=%SUSPENDED;

   3458  1 002704   000006 235007                    LDA     6,DL
         1 002705   200015 755100                    STA     NEWSTATE,,AUTO

      637     3459    2           REQ$=ADDR(NIL);

   3459  1 002706   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 002707   200027 756100                    STQ     REQ$,,AUTO

      638     3460    2           RETURN;

   3460  1 002710   200034 221300                    LDX1  ! SQH$+2,,AUTO
         1 002711   000001 702211                    TSX2  ! 1,X1

      639     3461    2   END SETREPOST;
      640     3462        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:119  
      641     3463    1   GETRTY: PROC ALTRET;

   3463  1 002712   200036 741300       GETRTY       STX1  ! IOCHANX+1,,AUTO

      642     3464    2           CALL NIQ$GET(REPOS$) ALTRET(REPOST);

   3464  1 002713   200030 630500                    EPPR0   REPOS$,,AUTO
         1 002714   200042 450500                    STP0    J+3,,AUTO
         1 002715   200042 630500                    EPPR0   J+3,,AUTO
         1 002716   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002717   000000 701000 xent               TSX1    NIQ$GET
         1 002720   002734 702000 1                  TSX2    REPOST

      643     3465    2           REPOS$->REQ.DLA=REQ.DLA;

   3465  1 002721   200027 470500                    LDP0    REQ$,,AUTO
         1 002722   000001 236100                    LDQ     1,,PR0
         1 002723   200030 471500                    LDP1    REPOS$,,AUTO
         1 002724   100001 756100                    STQ     1,,PR1

      644     3466    2           REPOS$->REQ.COMP=%COMP_IOS;

   3466  1 002725   200030 470500                    LDP0    REPOS$,,AUTO
         1 002726   000027 236100                    LDQ     23,,PR0
         1 002727   000027 376000 2                  ANQ     23
         1 002730   003000 276007                    ORQ     1536,DL
         1 002731   000027 756100                    STQ     23,,PR0

      645     3467    2           RETURN;

   3467  1 002732   200036 221300                    LDX1  ! IOCHANX+1,,AUTO
         1 002733   000001 702211                    TSX2  ! 1,X1

      646     3468    2   REPOST:
      647     3469    2           ALTRETURN;

   3469  1 002734   200036 221300       REPOST       LDX1  ! IOCHANX+1,,AUTO
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:120  
         1 002735   000000 702211                    TSX2  ! 0,X1

      648     3470    2   END GETRTY;
      649     3471        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:121  
      650     3472    1   RELCHAN: PROC;

   3472  1 002736   200034 741300       RELCHAN      STX1  ! SQH$+2,,AUTO

      651     3473    2           DQH.STATE=%IDLE;

   3473  1 002737   200010 470500                    LDP0    DQH$,,AUTO
         1 002740   000000 236003                    LDQ     0,DU
         1 002741   000001 752101                    STCQ    1,'01'O,PR0

      652     3474    2           DQH.MREC='0'B;

   3474  1 002742   000031 236000 xsym               LDQ     B_VECTNIL+25
         1 002743   000001 356100                    ANSQ    1,,PR0

      653     3475    3           IF DQH.CHANSTATE THEN DO;

   3475  1 002744   000020 236100                    LDQ     16,,PR0
         1 002745   740000 316003                    CANQ    -16384,DU
         1 002746   002771 600000 1                  TZE     s:3486

      654     3476    4              IF DQH.CHANSTATE.STOP THEN DO;

   3476  1 002747   000020 234100                    SZN     16,,PR0
         1 002750   003004 605000 1                  TPL     s:3491

      655     3477                      %UNLOCK (G#=SQH.GATE);

   3478  1 002751   200032 630500                    EPPR0   SQH$,,AUTO
         1 002752   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002753   000000 701000 xent               TSX1    HFC$UNLOCK
         1 002754   000000 011000                    NOP     0

      656     3480    4                 CALL NIW$MPCSTOP(DQH.MPC$->DCT);

   3480  1 002755   200010 470500                    LDP0    DQH$,,AUTO
         1 002756   000015 471500                    LDP1    13,,PR0
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:122  
         1 002757   200042 451500                    STP1    J+3,,AUTO
         1 002760   200042 630500                    EPPR0   J+3,,AUTO
         1 002761   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002762   000000 701000 xent               TSX1    NIW$MPCSTOP
         1 002763   000000 011000                    NOP     0

      657     3481                      %LOCK (G#=SQH.GATE);

   3482  1 002764   200032 630500                    EPPR0   SQH$,,AUTO
         1 002765   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002766   000000 701000 xent               TSX1    HFC$LOCK
         1 002767   000000 011000                    NOP     0

      658     3484    4                 END;

      659     3485    3              END;

   3485  1 002770   003004 710000 1                  TRA     s:3491

      660     3486    3           ELSE IF NOT DQH.STATUS.DOWN THEN DO;

   3486  1 002771   000001 236100                    LDQ     1,,PR0
         1 002772   200000 316003                    CANQ    65536,DU
         1 002773   003004 601000 1                  TNZ     s:3491

      661     3487                      %ENQUEUE (P#=DQH,Q#=SQH.CQ$);

   3488  1 002774   200032 236100                    LDQ     SQH$,,AUTO
         1 002775   000004 036003                    ADLQ    4,DU
         1 002776   200010 235100                    LDA     DQH$,,AUTO
         1 002777   200042 757100                    STAQ    J+3,,AUTO
         1 003000   200042 630500                    EPPR0   J+3,,AUTO
         1 003001   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003002   000000 701000 xent               TSX1    NIM$ENQUEUE
         1 003003   000000 011000                    NOP     0

      662     3490    3                 END;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:123  

      663     3491    2           RETURN;

   3491  1 003004   200034 221300                    LDX1  ! SQH$+2,,AUTO
         1 003005   000001 702211                    TSX2  ! 1,X1

      664     3492    2   END RELCHAN;
      665     3493        /**/
      666     3494        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:124  
      667     3495    1   BGNFREPOS: PROC ALTRET;

   3495  1 003006   200036 741300       BGNFREPOS    STX1  ! IOCHANX+1,,AUTO

      668     3496        /**/
      669     3497    2   DCL P$ PTR;
      670     3498        /**/
      671     3499    3           IF DCT.MT.FREPOS$=ADDR(NIL) THEN DO;

   3499  1 003007   200007 470500                    LDP0    DCT$,,AUTO
         1 003010   000031 236100                    LDQ     25,,PR0
         1 003011   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 003012   003025 601000 1                  TNZ     s:3504

      672     3500    3              CALL NIQ$GET(P$) ALTRET(REPOST);

   3500  1 003013   200037 631500                    EPPR1   P$,,AUTO
         1 003014   200042 451500                    STP1    J+3,,AUTO
         1 003015   200042 630500                    EPPR0   J+3,,AUTO
         1 003016   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003017   000000 701000 xent               TSX1    NIQ$GET
         1 003020   003053 702000 1                  TSX2    REPOST

      673     3501    3              DCT.MT.FREPOS$=P$;

   3501  1 003021   200037 236100                    LDQ     P$,,AUTO
         1 003022   200007 470500                    LDP0    DCT$,,AUTO
         1 003023   000031 756100                    STQ     25,,PR0

      674     3502    3              END;

   3502  1 003024   003026 710000 1                  TRA     s:3506

      675     3503    3           ELSE DO;

      676     3504    3              P$=DCT.MT.FREPOS$;

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:125  
   3504  1 003025   200037 756100                    STQ     P$,,AUTO

      677     3505    3              END;

      678     3506    2           P$->REQ.COMP=%COMP_FREPOS;

   3506  1 003026   200037 471500                    LDP1    P$,,AUTO
         1 003027   100027 236100                    LDQ     23,,PR1
         1 003030   000027 376000 2                  ANQ     23
         1 003031   005000 276007                    ORQ     2560,DL
         1 003032   100027 756100                    STQ     23,,PR1

      679     3507    2           P$->REQ.POSTER=%FREPOS_REWIND;

   3507  1 003033   200037 471500                    LDP1    P$,,AUTO
         1 003034   000001 236007                    LDQ     1,DL
         1 003035   100010 552104                    STBQ    8,'04'O,PR1

      680     3508    2           P$->REQ.FC=%N_REWIND;

   3508  1 003036   200037 471500                    LDP1    P$,,AUTO
         1 003037   000006 236007                    LDQ     6,DL
         1 003040   100003 552104                    STBQ    3,'04'O,PR1

      681     3509    2           P$->REQ.DLA=REQ.DLA;

   3509  1 003041   200027 471500                    LDP1    REQ$,,AUTO
         1 003042   100001 236100                    LDQ     1,,PR1
         1 003043   200037 473500                    LDP3    P$,,AUTO
         1 003044   300001 756100                    STQ     1,,PR3

      682     3510    2           CALL NIO$DCWBLD(P$->REQ) ALTRET(REPOST);

   3510  1 003045   200037 630500                    EPPR0   P$,,AUTO
         1 003046   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003047   000000 701000 xent               TSX1    NIO$DCWBLD
         1 003050   003053 702000 1                  TSX2    REPOST
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:126  

      683     3511    2           RETURN;

   3511  1 003051   200036 221300                    LDX1  ! IOCHANX+1,,AUTO
         1 003052   000001 702211                    TSX2  ! 1,X1

      684     3512    2   REPOST: ALTRETURN;

   3512  1 003053   200036 221300       REPOST       LDX1  ! IOCHANX+1,,AUTO
         1 003054   000000 702211                    TSX2  ! 0,X1

      685     3513    2   END BGNFREPOS;
      686     3514        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:127  
      687     3515    1   UPDATE_POS: PROC;

   3515  1 003055   200034 741300       UPDATE_POS   STX1  ! SQH$+2,,AUTO

      688     3516    3           DO CASE(REQ.FC);

   3516  1 003056   200027 470500                    LDP0    REQ$,,AUTO
         1 003057   000003 720100                    LXL0    3,,PR0
         1 003060   000777 360003                    ANX0    511,DU
         1 003061   000030 100003                    CMPX0   24,DU
         1 003062   003064 602010 1                  TNC     s:3516+6,X0
         1 003063   003300 710000 1                  TRA     s:3570
         1 003064   003152 710000 1                  TRA     s:3532
         1 003065   003300 710000 1                  TRA     s:3570
         1 003066   003114 710000 1                  TRA     s:3518
         1 003067   003114 710000 1                  TRA     s:3518
         1 003070   003114 710000 1                  TRA     s:3518
         1 003071   003114 710000 1                  TRA     s:3518
         1 003072   003142 710000 1                  TRA     s:3528
         1 003073   003300 710000 1                  TRA     s:3570
         1 003074   003142 710000 1                  TRA     s:3528
         1 003075   003300 710000 1                  TRA     s:3570
         1 003076   003156 710000 1                  TRA     s:3534
         1 003077   003300 710000 1                  TRA     s:3570
         1 003100   003114 710000 1                  TRA     s:3518
         1 003101   003114 710000 1                  TRA     s:3518
         1 003102   003176 710000 1                  TRA     s:3540
         1 003103   003176 710000 1                  TRA     s:3540
         1 003104   003300 710000 1                  TRA     s:3570
         1 003105   003300 710000 1                  TRA     s:3570
         1 003106   003300 710000 1                  TRA     s:3570
         1 003107   003300 710000 1                  TRA     s:3570
         1 003110   003300 710000 1                  TRA     s:3570
         1 003111   003300 710000 1                  TRA     s:3570
         1 003112   003300 710000 1                  TRA     s:3570
         1 003113   003142 710000 1                  TRA     s:3528

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:128  
      689     3517    3            CASE(%N_RDBIN,%N_WRBIN,%N_RDASC,%N_WRASC,%N_READ,%N_WRITE);

      690     3518    4              IF REQ.TYC.EOF THEN DO;

   3518  1 003114   000021 236100                    LDQ     17,,PR0
         1 003115   004000 316003                    CANQ    2048,DU
         1 003116   003135 600000 1                  TZE     s:3525

      691     3519    4                 DCT.MT.POS.FILECNT=DCT.MT.POS.FILECNT+1;

   3519  1 003117   200007 471500                    LDP1    DCT$,,AUTO
         1 003120   100037 235100                    LDA     31,,PR1
         1 003121   000001 035007                    ADLA    1,DL
         1 003122   100037 755100                    STA     31,,PR1

      692     3520    4                 DCT.MT.POS.LRECCNT=DCT.MT.POS.CRECCNT;

   3520  1 003123   100035 235100                    LDA     29,,PR1
         1 003124   100036 755100                    STA     30,,PR1

      693     3521    4                 DCT.MT.LVALID=~DCT.MT.PLOST;

   3521  1 003125   100033 236100                    LDQ     27,,PR1
         1 003126   400000 376003                    ANQ     -131072,DU
         1 003127   400000 676003                    ERQ     -131072,DU
         1 003130   100034 676100                    ERQ     28,,PR1
         1 003131   400000 376003                    ANQ     -131072,DU
         1 003132   100034 656100                    ERSQ    28,,PR1

      694     3522    4                 DCT.MT.POS.CRECCNT=0;

   3522  1 003133   100035 450100                    STZ     29,,PR1

      695     3523    4                 END;

   3523  1 003134   003300 710000 1                  TRA     s:3570

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:129  
      696     3524    4              ELSE DO;

      697     3525    4                 DCT.MT.POS.CRECCNT=DCT.MT.POS.CRECCNT+1;

   3525  1 003135   200007 471500                    LDP1    DCT$,,AUTO
         1 003136   100035 235100                    LDA     29,,PR1
         1 003137   000001 035007                    ADLA    1,DL
         1 003140   100035 755100                    STA     29,,PR1

      698     3526    4                 END;

   3526  1 003141   003300 710000 1                  TRA     s:3570

      699     3527    3            CASE(%N_REWIND,%N_UNLOAD,%N_LDTAPE);

      700     3528    3              DCT.MT.POS='0'B;

   3528  1 003142   200007 471500                    LDP1    DCT$,,AUTO
         1 003143   000100 100400                    MLR     fill='000'O
         1 003144   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 003145   100035 000020                    ADSC9   29,,PR1                  cn=0,n=16

      701     3529    3              DCT.MT.LVALID='0'B;

   3529  1 003146   000031 236000 xsym               LDQ     B_VECTNIL+25
         1 003147   100034 356100                    ANSQ    28,,PR1

      702     3530    3              DCT.MT.PLOST='0'B;

   3530  1 003150   100033 356100                    ANSQ    27,,PR1
         1 003151   003300 710000 1                  TRA     s:3570

      703     3531    3            CASE(%N_DCWLIST);

      704     3532    3              DCT.MT.PLOST='1'B;

   3532  1 003152   200007 471500                    LDP1    DCT$,,AUTO
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:130  
         1 003153   400000 236003                    LDQ     -131072,DU
         1 003154   100033 256100                    ORSQ    27,,PR1
         1 003155   003300 710000 1                  TRA     s:3570

      705     3533    3            CASE(%N_WRFM);

      706     3534    3              DCT.MT.POS.FILECNT=DCT.MT.POS.FILECNT+1;

   3534  1 003156   200007 471500                    LDP1    DCT$,,AUTO
         1 003157   100037 235100                    LDA     31,,PR1
         1 003160   000001 035007                    ADLA    1,DL
         1 003161   100037 755100                    STA     31,,PR1

      707     3535    3              DCT.MT.POS.LRECCNT=DCT.MT.POS.CRECCNT;

   3535  1 003162   100035 235100                    LDA     29,,PR1
         1 003163   100036 755100                    STA     30,,PR1

      708     3536    3              DCT.MT.LVALID=~DCT.MT.PLOST;

   3536  1 003164   100033 236100                    LDQ     27,,PR1
         1 003165   400000 376003                    ANQ     -131072,DU
         1 003166   400000 676003                    ERQ     -131072,DU
         1 003167   100034 676100                    ERQ     28,,PR1
         1 003170   400000 376003                    ANQ     -131072,DU
         1 003171   100034 656100                    ERSQ    28,,PR1

      709     3537    3              DCT.MT.POS.CRECCNT=0;

   3537  1 003172   100035 450100                    STZ     29,,PR1

      710     3538    3              DCT.MT.PLOST='1'B;

   3538  1 003173   400000 236003                    LDQ     -131072,DU
         1 003174   100033 256100                    ORSQ    27,,PR1
         1 003175   003300 710000 1                  TRA     s:3570

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:131  
      711     3539    3            CASE(%N_SPREC,%N_SPFILE);

      712     3540    3              I=REQ.IOS$->IOS.IDCW.RCNT(0)-REQ.STATUS.RCR;

   3540  1 003176   000012 471500                    LDP1    10,,PR0
         1 003177   000014 236100                    LDQ     12,,PR0
         1 003200   000077 376007                    ANQ     63,DL
         1 003201   200042 756100                    STQ     J+3,,AUTO
         1 003202   100002 236100                    LDQ     2,,PR1
         1 003203   000077 376007                    ANQ     63,DL
         1 003204   200042 136100                    SBLQ    J+3,,AUTO
         1 003205   200012 756100                    STQ     I,,AUTO

      713     3541    4              IF REQ.RCT<0 THEN DO;

   3541  1 003206   000030 720100                    LXL0    24,,PR0
         1 003207   003251 605000 1                  TPL     s:3558

      714     3542    5                 IF REQ.TYC.BOT THEN DO;

   3542  1 003210   000021 236100                    LDQ     17,,PR0
         1 003211   040000 316003                    CANQ    16384,DU
         1 003212   003223 600000 1                  TZE     s:3547

      715     3543    5                    DCT.MT.POS='0'B;

   3543  1 003213   200007 471500                    LDP1    DCT$,,AUTO
         1 003214   000100 100400                    MLR     fill='000'O
         1 003215   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 003216   100035 000020                    ADSC9   29,,PR1                  cn=0,n=16

      716     3544    5                    DCT.MT.PLOST='0'B;

   3544  1 003217   000031 236000 xsym               LDQ     B_VECTNIL+25
         1 003220   100033 356100                    ANSQ    27,,PR1

      717     3545    5                    DCT.MT.LVALID='0'B;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:132  

   3545  1 003221   100034 356100                    ANSQ    28,,PR1

      718     3546    5                    END;

   3546  1 003222   003300 710000 1                  TRA     s:3570

      719     3547    5                 ELSE IF REQ.TYC.EOF THEN DO;

   3547  1 003223   004000 316003                    CANQ    2048,DU
         1 003224   003244 600000 1                  TZE     s:3554

      720     3548    5                       DCT.MT.POS.FILECNT=DCT.MT.POS.FILECNT-1;

   3548  1 003225   200007 471500                    LDP1    DCT$,,AUTO
         1 003226   100037 235100                    LDA     31,,PR1
         1 003227   000001 135007                    SBLA    1,DL
         1 003230   100037 755100                    STA     31,,PR1

      721     3549    5                       DCT.MT.POS.CRECCNT=DCT.MT.POS.LRECCNT;

   3549  1 003231   100036 235100                    LDA     30,,PR1
         1 003232   100035 755100                    STA     29,,PR1

      722     3550    5                       DCT.MT.PLOST=~DCT.MT.LVALID;

   3550  1 003233   100034 236100                    LDQ     28,,PR1
         1 003234   400000 376003                    ANQ     -131072,DU
         1 003235   400000 676003                    ERQ     -131072,DU
         1 003236   100033 676100                    ERQ     27,,PR1
         1 003237   400000 376003                    ANQ     -131072,DU
         1 003240   100033 656100                    ERSQ    27,,PR1

      723     3551    5                       DCT.MT.LVALID='0'B;

   3551  1 003241   000031 236000 xsym               LDQ     B_VECTNIL+25
         1 003242   100034 356100                    ANSQ    28,,PR1
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:133  

      724     3552    5                       END;

   3552  1 003243   003300 710000 1                  TRA     s:3570

      725     3553    5                    ELSE DO;

      726     3554    5                       DCT.MT.POS.CRECCNT=DCT.MT.POS.CRECCNT-I;

   3554  1 003244   200007 471500                    LDP1    DCT$,,AUTO
         1 003245   100035 236100                    LDQ     29,,PR1
         1 003246   200012 136100                    SBLQ    I,,AUTO
         1 003247   100035 756100                    STQ     29,,PR1

      727     3555    5                       END;

      728     3556    4                 END;

   3556  1 003250   003300 710000 1                  TRA     s:3570

      729     3557    4              ELSE DO;

      730     3558    5                 IF REQ.TYC.EOF THEN DO;

   3558  1 003251   000021 236100                    LDQ     17,,PR0
         1 003252   004000 316003                    CANQ    2048,DU
         1 003253   003274 600000 1                  TZE     s:3566

      731     3559    5                    DCT.MT.POS.FILECNT=DCT.MT.POS.FILECNT+1;

   3559  1 003254   200007 471500                    LDP1    DCT$,,AUTO
         1 003255   100037 235100                    LDA     31,,PR1
         1 003256   000001 035007                    ADLA    1,DL
         1 003257   100037 755100                    STA     31,,PR1

      732     3560    5                    DCT.MT.POS.LRECCNT=DCT.MT.POS.CRECCNT;

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:134  
   3560  1 003260   100035 235100                    LDA     29,,PR1
         1 003261   100036 755100                    STA     30,,PR1

      733     3561    5                    DCT.MT.LVALID=~DCT.MT.PLOST;

   3561  1 003262   100033 236100                    LDQ     27,,PR1
         1 003263   400000 376003                    ANQ     -131072,DU
         1 003264   400000 676003                    ERQ     -131072,DU
         1 003265   100034 676100                    ERQ     28,,PR1
         1 003266   400000 376003                    ANQ     -131072,DU
         1 003267   100034 656100                    ERSQ    28,,PR1

      734     3562    5                    DCT.MT.POS.CRECCNT=0;

   3562  1 003270   100035 450100                    STZ     29,,PR1

      735     3563    5                    DCT.MT.PLOST='0'B;

   3563  1 003271   000031 236000 xsym               LDQ     B_VECTNIL+25
         1 003272   100033 356100                    ANSQ    27,,PR1

      736     3564    5                    END;

   3564  1 003273   003300 710000 1                  TRA     s:3570

      737     3565    5                 ELSE DO;

      738     3566    5                    DCT.MT.POS.CRECCNT=DCT.MT.POS.CRECCNT+I;

   3566  1 003274   200007 471500                    LDP1    DCT$,,AUTO
         1 003275   100035 236100                    LDQ     29,,PR1
         1 003276   200012 036100                    ADLQ    I,,AUTO
         1 003277   100035 756100                    STQ     29,,PR1

      739     3567    5                    END;

      740     3568    4                 END;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:135  

      741     3569    3            END;

      742     3570    2   END UPDATE_POS;

   3570  1 003300   200034 221300                    LDX1  ! SQH$+2,,AUTO
         1 003301   000001 702211                    TSX2  ! 1,X1

      743     3571        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:136  
      744     3572    1   CHECK_DONE: PROC ALTRET;

   3572  1 003302   200034 741300       CHECK_DONE   STX1  ! SQH$+2,,AUTO

      745     3573    2  DCL ERRBITS BIT(36) CONSTANT ALIGNED INIT(%(TYC_OPER|TYC_BLNKTP|TYC_IOERR|TYC_MTRAP|
              3573            TYC_TIMO|TYC_FRAW));
      746     3574        /**/
      747     3575    2   DCL IOCHANX UBIN;
      748     3576    2   DCL I SBIN;
      749     3577    2   DCL J SBIN;
      750     3578        /**/
      751     3579        /*  SOME TAPE COMMANDS REQUIRE SEVERAL I/OS TO GET THEM COMPLETED.
      752     3580            THIS ROUTINE CHECKS THESE COMMANDS FOR COMPLETION AND ALTRETURNS
      753     3581            IF THEY ARE NOT DONE AFTER SETTING UP THE REQUEST TO PERFORM
      754     3582            THE NEXT STEP.  IT ALSO SAVES THE DENSITY SET FOR THE DEVICE.  */
      755     3583        /**/
      756     3584    3           DO CASE(REQ.FC);

   3584  1 003303   200027 470500                    LDP0    REQ$,,AUTO
         1 003304   000003 236100                    LDQ     3,,PR0
         1 003305   000777 376007                    ANQ     511,DL
         1 003306   000006 136007                    SBLQ    6,DL
         1 003307   000020 116007                    CMPQ    16,DL
         1 003310   003312 602006 1                  TNC     s:3584+7,QL
         1 003311   003654 710000 1                  TRA     s:3658
         1 003312   003646 710000 1                  TRA     s:3655
         1 003313   003654 710000 1                  TRA     s:3658
         1 003314   003654 710000 1                  TRA     s:3658
         1 003315   003654 710000 1                  TRA     s:3658
         1 003316   003654 710000 1                  TRA     s:3658
         1 003317   003654 710000 1                  TRA     s:3658
         1 003320   003654 710000 1                  TRA     s:3658
         1 003321   003654 710000 1                  TRA     s:3658
         1 003322   003332 710000 1                  TRA     s:3586
         1 003323   003464 710000 1                  TRA     s:3606
         1 003324   003654 710000 1                  TRA     s:3658
         1 003325   003654 710000 1                  TRA     s:3658
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:137  
         1 003326   003654 710000 1                  TRA     s:3658
         1 003327   003544 710000 1                  TRA     s:3620
         1 003330   003544 710000 1                  TRA     s:3620
         1 003331   003544 710000 1                  TRA     s:3620

      757     3585    3            CASE(%N_SPREC);

      758     3586    3              REQ.ARCT=REQ.ARCT+REQ.IOS$->IOS.IDCW.RCNT(0)-REQ.STATUS.RCR;

   3586  1 003332   000012 471500                    LDP1    10,,PR0
         1 003333   100002 236100                    LDQ     2,,PR1
         1 003334   000077 376007                    ANQ     63,DL
         1 003335   200042 756100                    STQ     J+3,,AUTO
         1 003336   000030 236100                    LDQ     24,,PR0
         1 003337   000022 732000                    QRS     18
         1 003340   200042 036100                    ADLQ    J+3,,AUTO
         1 003341   200043 756100                    STQ     J+4,,AUTO
         1 003342   000014 236100                    LDQ     12,,PR0
         1 003343   000077 376007                    ANQ     63,DL
         1 003344   200044 756100                    STQ     J+5,,AUTO
         1 003345   200043 236100                    LDQ     J+4,,AUTO
         1 003346   200044 136100                    SBLQ    J+5,,AUTO
         1 003347   000000 620006                    EAX0    0,QL
         1 003350   000030 740100                    STX0    24,,PR0

      759     3587    3              IF REQ.RCT<0 THEN I=-REQ.RCT;

   3587  1 003351   000030 721100                    LXL1    24,,PR0
         1 003352   003362 605000 1                  TPL     s:3588

   3587  1 003353   000030 236100                    LDQ     24,,PR0
         1 003354   000022 736000                    QLS     18
         1 003355   000022 732000                    QRS     18
         1 003356   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 003357   000001 036007                    ADLQ    1,DL
         1 003360   200036 756100                    STQ     I,,AUTO
         1 003361   003366 710000 1                  TRA     s:3589
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:138  

      760     3588    3              ELSE I=REQ.RCT;

   3588  1 003362   000030 236100                    LDQ     24,,PR0
         1 003363   000022 736000                    QLS     18
         1 003364   000022 732000                    QRS     18
         1 003365   200036 756100                    STQ     I,,AUTO

      761     3589    4              IF NOT (REQ.TYC & (ERRBITS|%TYC_EOF|%TYC_BOT)) AND REQ.ARCT~=I THEN DO;

   3589  1 003366   000000 236000 0                  LDQ     ERRBITS
         1 003367   000002 276000 0                  ORQ     ERRBITS+2
         1 003370   000003 276000 0                  ORQ     ERRBITS+3
         1 003371   000021 376100                    ANQ     17,,PR0
         1 003372   003417 601000 1                  TNZ     s:3595
         1 003373   000030 236100                    LDQ     24,,PR0
         1 003374   000022 732000                    QRS     18
         1 003375   200036 116100                    CMPQ    I,,AUTO
         1 003376   003417 600000 1                  TZE     s:3595

      762     3590    4                 IF I-REQ.ARCT<63 THEN REQ.IOS$->IOS.IDCW.RCNT(0)=I-REQ.ARCT;

   3590  1 003377   200042 756100                    STQ     J+3,,AUTO
         1 003400   200036 236100                    LDQ     I,,AUTO
         1 003401   200042 136100                    SBLQ    J+3,,AUTO
         1 003402   000077 116007                    CMPQ    63,DL
         1 003403   003413 605000 1                  TPL     s:3591

   3590  1 003404   000012 471500                    LDP1    10,,PR0
         1 003405   000030 236100                    LDQ     24,,PR0
         1 003406   000022 732000                    QRS     18
         1 003407   200042 756100                    STQ     J+3,,AUTO
         1 003410   200036 236100                    LDQ     I,,AUTO
         1 003411   200042 136100                    SBLQ    J+3,,AUTO
         1 003412   100002 752101                    STCQ    2,'01'O,PR1

      763     3591    4                 RCVR.RETRY='1'B;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:139  

   3591  1 003413   400000 236003                    LDQ     -131072,DU
         1 003414   200026 256100                    ORSQ    RCVR,,AUTO

      764     3592    4                 ALTRETURN;

   3592  1 003415   200034 221300                    LDX1  ! SQH$+2,,AUTO
         1 003416   000000 702211                    TSX2  ! 0,X1

      765     3593    4                 END;
      766     3594    4              ELSE DO;

      767     3595    4                 IF REQ.TYC.EOF THEN REQ.ARCT=REQ.ARCT-1;

   3595  1 003417   000021 236100                    LDQ     17,,PR0
         1 003420   004000 316003                    CANQ    2048,DU
         1 003421   003425 600000 1                  TZE     s:3596

   3595  1 003422   777777 622010                    EAX2    -1,X0
         1 003423   000030 742100                    STX2    24,,PR0
         1 003424   003437 710000 1                  TRA     s:3600

      768     3596    5                 ELSE IF REQ.TYC.BOT THEN DO;

   3596  1 003425   040000 316003                    CANQ    16384,DU
         1 003426   003437 600000 1                  TZE     s:3600

      769     3597    5                       IF REQ.STATUS.MAJOR=0 THEN REQ.ARCT=REQ.ARCT-1;

   3597  1 003427   000014 236100                    LDQ     12,,PR0
         1 003430   170000 316003                    CANQ    61440,DU
         1 003431   003435 601000 1                  TNZ     s:3598

   3597  1 003432   777777 622010                    EAX2    -1,X0
         1 003433   000030 742100                    STX2    24,,PR0
         1 003434   003437 710000 1                  TRA     s:3600

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:140  
      770     3598    5                       ELSE REQ.ARCT=REQ.ARCT-2;

   3598  1 003435   777776 622010                    EAX2    -2,X0
         1 003436   000030 742100                    STX2    24,,PR0

      771     3599    5                       END;

      772     3600    4                 IF REQ.ARCT<0 THEN REQ.ARCT=0;

   3600  1 003437   000030 220100                    LDX0    24,,PR0
         1 003440   003443 605000 1                  TPL     s:3601

   3600  1 003441   000000 222003                    LDX2    0,DU
         1 003442   000030 742100                    STX2    24,,PR0

      773     3601    4                 REQ.ARSIZE=REQ.ARCT;

   3601  1 003443   000030 236100                    LDQ     24,,PR0
         1 003444   000022 732000                    QRS     18
         1 003445   000020 736000                    QLS     16
         1 003446   000027 676100                    ERQ     23,,PR0
         1 003447   000034 376000 xsym               ANQ     B_VECTNIL+28
         1 003450   000027 656100                    ERSQ    23,,PR0

      774     3602    4                 IF REQ.TYC.BOT AND DCT.FIPS THEN

   3602  1 003451   200027 470500                    LDP0    REQ$,,AUTO
         1 003452   000021 236100                    LDQ     17,,PR0
         1 003453   040000 316003                    CANQ    16384,DU
         1 003454   003654 600000 1                  TZE     s:3658
         1 003455   200007 471500                    LDP1    DCT$,,AUTO
         1 003456   100007 236100                    LDQ     7,,PR1
         1 003457   200000 316003                    CANQ    65536,DU
         1 003460   003654 600000 1                  TZE     s:3658

      775     3603    4                    RCVR.SETDENS='1'B;

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:141  
   3603  1 003461   000400 236003                    LDQ     256,DU
         1 003462   200026 256100                    ORSQ    RCVR,,AUTO

      776     3604    4                 END;

   3604  1 003463   003654 710000 1                  TRA     s:3658

      777     3605    3            CASE(%N_SPFILE);

      778     3606    3              IF REQ.TYC.EOF THEN REQ.ARCT=REQ.ARCT+1;

   3606  1 003464   000021 236100                    LDQ     17,,PR0
         1 003465   004000 316003                    CANQ    2048,DU
         1 003466   003472 600000 1                  TZE     s:3607

   3606  1 003467   000030 220100                    LDX0    24,,PR0
         1 003470   000001 622010                    EAX2    1,X0
         1 003471   000030 742100                    STX2    24,,PR0

      779     3607    3              IF REQ.RCT<0 THEN I=-REQ.RCT;

   3607  1 003472   000030 720100                    LXL0    24,,PR0
         1 003473   003503 605000 1                  TPL     s:3608

   3607  1 003474   000030 236100                    LDQ     24,,PR0
         1 003475   000022 736000                    QLS     18
         1 003476   000022 732000                    QRS     18
         1 003477   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 003500   000001 036007                    ADLQ    1,DL
         1 003501   200036 756100                    STQ     I,,AUTO
         1 003502   003507 710000 1                  TRA     s:3609

      780     3608    3              ELSE I=REQ.RCT;

   3608  1 003503   000030 236100                    LDQ     24,,PR0
         1 003504   000022 736000                    QLS     18
         1 003505   000022 732000                    QRS     18
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:142  
         1 003506   200036 756100                    STQ     I,,AUTO

      781     3609    4              IF NOT (REQ.TYC & (ERRBITS|%TYC_BOT)) AND REQ.ARCT~=I THEN DO;

   3609  1 003507   000000 236000 0                  LDQ     ERRBITS
         1 003510   000003 276000 0                  ORQ     ERRBITS+3
         1 003511   000021 376100                    ANQ     17,,PR0
         1 003512   003523 601000 1                  TNZ     s:3614
         1 003513   000030 236100                    LDQ     24,,PR0
         1 003514   000022 732000                    QRS     18
         1 003515   200036 116100                    CMPQ    I,,AUTO
         1 003516   003523 600000 1                  TZE     s:3614

      782     3610    4                 RCVR.RETRY='1'B;

   3610  1 003517   400000 236003                    LDQ     -131072,DU
         1 003520   200026 256100                    ORSQ    RCVR,,AUTO

      783     3611    4                 ALTRETURN;

   3611  1 003521   200034 221300                    LDX1  ! SQH$+2,,AUTO
         1 003522   000000 702211                    TSX2  ! 0,X1

      784     3612    4                 END;
      785     3613    4              ELSE DO;

      786     3614    4                 REQ.ARSIZE=REQ.ARCT;

   3614  1 003523   000030 236100                    LDQ     24,,PR0
         1 003524   000022 732000                    QRS     18
         1 003525   000020 736000                    QLS     16
         1 003526   000027 676100                    ERQ     23,,PR0
         1 003527   000034 376000 xsym               ANQ     B_VECTNIL+28
         1 003530   000027 656100                    ERSQ    23,,PR0

      787     3615    4                 IF REQ.TYC.BOT AND DCT.FIPS THEN

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:143  
   3615  1 003531   200027 470500                    LDP0    REQ$,,AUTO
         1 003532   000021 236100                    LDQ     17,,PR0
         1 003533   040000 316003                    CANQ    16384,DU
         1 003534   003654 600000 1                  TZE     s:3658
         1 003535   200007 471500                    LDP1    DCT$,,AUTO
         1 003536   100007 236100                    LDQ     7,,PR1
         1 003537   200000 316003                    CANQ    65536,DU
         1 003540   003654 600000 1                  TZE     s:3658

      788     3616    4                    RCVR.SETDENS='1'B;

   3616  1 003541   000400 236003                    LDQ     256,DU
         1 003542   200026 256100                    ORSQ    RCVR,,AUTO

      789     3617    4                 END;

   3617  1 003543   003654 710000 1                  TRA     s:3658

      790     3618    3            CASE(%N_SD800,%N_SD1600,%N_SD6250);

      791     3619                                      /* keeps track of current density for device */
      792     3620    3              DCT.MT.CURDENS=REQ.FC;

   3620  1 003544   200007 471500                    LDP1    DCT$,,AUTO
         1 003545   000003 236100                    LDQ     3,,PR0
         1 003546   000033 736000                    QLS     27
         1 003547   100041 552140                    STBQ    33,'40'O,PR1

      793     3621                   /*N*  The following code handles a maximum of two physical channels
      794     3622                         per FIPS tape subsystem:  either two physical channels
      795     3623                         connected to one controller or two controllers, each  having
      796     3624                         a single physical channel. (This is done by setting FIPS_DENS_DONE
      797     3625                         to '0'B prior to the first set density command and setting
      798     3626                         it to '1'B when the second path is found.  End action of the
      799     3627                         second IO will reset this mechanism.)
      800     3628
      801     3629                         If more physical paths need to be supported, the mechanism
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:144  
      802     3630                         will have to be changed such that each path contains a flag
      803     3631                         that gets set when it has been "densitized";  when all paths
      804     3632                         are done, all the flags must be cleared.
      805     3633                       */
      806     3634    4              IF DQH.MPC$->DCT.FIPS AND NOT REQ.FIPS_DENS_DONE THEN DO;

   3634  1 003550   200010 473500                    LDP3    DQH$,,AUTO
         1 003551   300015 474500                    LDP4    13,,PR3
         1 003552   400007 236100                    LDQ     7,,PR4
         1 003553   200000 316003                    CANQ    65536,DU
         1 003554   003642 600000 1                  TZE     s:3653
         1 003555   000031 236100                    LDQ     25,,PR0
         1 003556   100000 316007                    CANQ    32768,DL
         1 003557   003642 601000 1                  TNZ     s:3653

      807     3635    5                 DO J = 0 TO 1;

   3635  1 003560   200037 450100                    STZ     J,,AUTO

      808     3636    6                    IF DQH.SQH$->SQH.MPC$(J) ~= ADDR(NIL) THEN DO;

   3636  1 003561   200010 470500                    LDP0    DQH$,,AUTO
         1 003562   000013 471500                    LDP1    11,,PR0
         1 003563   200037 720100                    LXL0    J,,AUTO
         1 003564   100005 236110                    LDQ     5,X0,PR1
         1 003565   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 003566   003636 600000 1                  TZE     s:3651

      809     3637    7                       DO I = 0 TO %N_CHANSPERMPC-1;

   3637  1 003567   200036 450100                    STZ     I,,AUTO
         1 003570   003633 710000 1                  TRA     s:3649+1

      810     3638    7                          IOCHANX=DQH.SQH$->SQH.MPC$(J)->DCT.MPC.IOCHANX(I);

   3638  1 003571   200010 470500                    LDP0    DQH$,,AUTO
         1 003572   000013 471500                    LDP1    11,,PR0
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:145  
         1 003573   200037 720100                    LXL0    J,,AUTO
         1 003574   100005 473510                    LDP3    5,X0,PR1
         1 003575   200036 235100                    LDA     I,,AUTO
         1 003576   000100 101505                    MRL     fill='000'O
         1 003577   300031 000001                    ADSC9   25,A,PR3                 cn=0,n=1
         1 003600   200035 000004                    ADSC9   IOCHANX,,AUTO            cn=0,n=4

      811     3639    8                          IF IOCHANX > 0 THEN DO;

   3639  1 003601   200035 236100                    LDQ     IOCHANX,,AUTO
         1 003602   003632 600000 1                  TZE     s:3649

      812     3640    8                             IF (NI$CHT.DQH$(IOCHANX)->DQH.LA~=DQH.LA OR

   3640  1 003603   200035 235100                    LDA     IOCHANX,,AUTO
         1 003604   000001 735000                    ALS     1
         1 003605   000000 474400 xsym               LDP4    NI$CHT$
         1 003606   400000 475505                    LDP5    0,AL,PR4
         1 003607   500020 236100                    LDQ     16,,PR5
         1 003610   000020 676100                    ERQ     16,,PR0
         1 003611   003000 376003                    ANQ     1536,DU
         1 003612   003616 601000 1                  TNZ     s:3640+11
         1 003613   500015 236100                    LDQ     13,,PR5
         1 003614   000015 116100                    CMPQ    13,,PR0
         1 003615   003632 600000 1                  TZE     s:3649
         1 003616   500001 236100                    LDQ     1,,PR5
         1 003617   200000 316003                    CANQ    65536,DU
         1 003620   003632 601000 1                  TNZ     s:3649

      813     3641    8                               NI$CHT.DQH$(IOCHANX)->DQH.MPC$~=DQH.MPC$) AND
      814     3642    9                               NOT NI$CHT.DQH$(IOCHANX)->DQH.STATUS.DOWN THEN DO;

      815     3643    9                                REQ.FIPS_DENS_DONE='1'B;

   3643  1 003621   200027 476500                    LDP6    REQ$,,AUTO
         1 003622   100000 236007                    LDQ     32768,DL
         1 003623   600031 256100                    ORSQ    25,,PR6
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:146  

      816     3644    9                                REQ.DQH$=NI$CHT.DQH$(IOCHANX);

   3644  1 003624   400000 236105                    LDQ     0,AL,PR4
         1 003625   600020 756100                    STQ     16,,PR6

      817     3645    9                                RCVR.RETRY='1'B;

   3645  1 003626   400000 236003                    LDQ     -131072,DU
         1 003627   200026 256100                    ORSQ    RCVR,,AUTO

      818     3646    9                                ALTRETURN;

   3646  1 003630   200034 221300                    LDX1  ! SQH$+2,,AUTO
         1 003631   000000 702211                    TSX2  ! 0,X1

      819     3647    9                                END;
      820     3648    8                             END;
      821     3649    7                          END;

   3649  1 003632   200036 054100                    AOS     I,,AUTO
         1 003633   200036 235100                    LDA     I,,AUTO
         1 003634   000017 115007                    CMPA    15,DL
         1 003635   003571 604400 1                  TMOZ    s:3638

      822     3650    6                       END;

      823     3651    5                    END;

   3651  1 003636   200037 054100                    AOS     J,,AUTO
         1 003637   200037 235100                    LDA     J,,AUTO
         1 003640   000001 115007                    CMPA    1,DL
         1 003641   003561 604400 1                  TMOZ    s:3636

      824     3652    4                 END;

      825     3653    3              REQ.FIPS_DENS_DONE='0'B;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:147  

   3653  1 003642   200027 470500                    LDP0    REQ$,,AUTO
         1 003643   000031 236000 2                  LDQ     25
         1 003644   000031 356100                    ANSQ    25,,PR0
         1 003645   003654 710000 1                  TRA     s:3658

      826     3654    3            CASE(%N_REWIND);

      827     3655    3              IF DCT.FIPS THEN

   3655  1 003646   200007 471500                    LDP1    DCT$,,AUTO
         1 003647   100007 236100                    LDQ     7,,PR1
         1 003650   200000 316003                    CANQ    65536,DU
         1 003651   003654 600000 1                  TZE     s:3658

      828     3656    3                 RCVR.SETDENS='1'B;

   3656  1 003652   000400 236003                    LDQ     256,DU
         1 003653   200026 256100                    ORSQ    RCVR,,AUTO

      829     3657    3            END;

      830     3658    3           IF RCVR.SETDENS THEN DO;

   3658  1 003654   200026 236100                    LDQ     RCVR,,AUTO
         1 003655   000400 316003                    CANQ    256,DU
         1 003656   003670 600000 1                  TZE     s:3665

      831     3659    4              CALL SETDENS WHENRETURN DO;

   3659  1 003657   003672 701000 1                  TSX1    SETDENS
         1 003660   003666 702000 1                  TSX2    s:3663

      832     3660    4                 DCT.MT.SETDENS$=SETDENS$;

   3660  1 003661   200031 236100                    LDQ     SETDENS$,,AUTO
         1 003662   200007 470500                    LDP0    DCT$,,AUTO
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:148  
         1 003663   000042 756100                    STQ     34,,PR0

      833     3661    4                 SETDENS$=ADDR(NIL);

   3661  1 003664   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 003665   200031 756100                    STQ     SETDENS$,,AUTO

      834     3662    4                 END;

      835     3663    3              RCVR.SETDENS='0'B;

   3663  1 003666   000032 236000 2                  LDQ     26
         1 003667   200026 356100                    ANSQ    RCVR,,AUTO

      836     3664    3              END;

      837     3665    2           RETURN;

   3665  1 003670   200034 221300                    LDX1  ! SQH$+2,,AUTO
         1 003671   000001 702211                    TSX2  ! 1,X1

      838     3666    2   END CHECK_DONE;
      839     3667        %EJECT;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:149  
      840     3668    1   SETDENS: PROC ALTRET;

   3668  1 003672   200040 741300       SETDENS      STX1  ! J+1,,AUTO

      841     3669
      842     3670    3           CALL NIQ$GET(SETDENS$) WHENALTRETURN DO;

   3670  1 003673   200031 630500                    EPPR0   SETDENS$,,AUTO
         1 003674   200042 450500                    STP0    J+3,,AUTO
         1 003675   200042 630500                    EPPR0   J+3,,AUTO
         1 003676   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003677   000000 701000 xent               TSX1    NIQ$GET
         1 003700   003702 702000 1                  TSX2    s:3671
         1 003701   003704 710000 1                  TRA     s:3673

      843     3671    3              ALTRETURN;

   3671  1 003702   200040 221300                    LDX1  ! J+1,,AUTO
         1 003703   000000 702211                    TSX2  ! 0,X1

      844     3672    3              END;
      845     3673    2           SETDENS$->REQ.FC=DCT.MT.CURDENS;

   3673  1 003704   200007 470500                    LDP0    DCT$,,AUTO
         1 003705   200031 471500                    LDP1    SETDENS$,,AUTO
         1 003706   000041 236100                    LDQ     33,,PR0
         1 003707   000033 772000                    QRL     27
         1 003710   100003 552104                    STBQ    3,'04'O,PR1

      846     3674    2           SETDENS$->REQ.DLA.DCTX=DCT.DCTX;

   3674  1 003711   200031 471500                    LDP1    SETDENS$,,AUTO
         1 003712   000006 236100                    LDQ     6,,PR0
         1 003713   100001 676100                    ERQ     1,,PR1
         1 003714   777770 376003                    ANQ     -8,DU
         1 003715   100001 656100                    ERSQ    1,,PR1

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:150  
      847     3675    2           SETDENS$->REQ.DQH$=DQH$;

   3675  1 003716   200010 236100                    LDQ     DQH$,,AUTO
         1 003717   200031 471500                    LDP1    SETDENS$,,AUTO
         1 003720   100020 756100                    STQ     16,,PR1

      848     3676    2           SETDENS$->REQ.COMP=%COMP_SETDENS;

   3676  1 003721   200031 471500                    LDP1    SETDENS$,,AUTO
         1 003722   100027 236100                    LDQ     23,,PR1
         1 003723   000027 376000 2                  ANQ     23
         1 003724   007000 276007                    ORQ     3584,DL
         1 003725   100027 756100                    STQ     23,,PR1

      849     3677    3           CALL NIO$DCWBLD(SETDENS$->REQ) WHENALTRETURN DO;

   3677  1 003726   200031 630500                    EPPR0   SETDENS$,,AUTO
         1 003727   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003730   000000 701000 xent               TSX1    NIO$DCWBLD
         1 003731   003733 702000 1                  TSX2    s:3678
         1 003732   003743 710000 1                  TRA     s:3681

      850     3678    3              CALL NIQ$REL(SETDENS$);

   3678  1 003733   200031 630500                    EPPR0   SETDENS$,,AUTO
         1 003734   200042 450500                    STP0    J+3,,AUTO
         1 003735   200042 630500                    EPPR0   J+3,,AUTO
         1 003736   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003737   000000 701000 xent               TSX1    NIQ$REL
         1 003740   000000 011000                    NOP     0

      851     3679    3              ALTRETURN;

   3679  1 003741   200040 221300                    LDX1  ! J+1,,AUTO
         1 003742   000000 702211                    TSX2  ! 0,X1

      852     3680    3              END;
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:151  
      853     3681    2           RETURN;

   3681  1 003743   200040 221300                    LDX1  ! J+1,,AUTO
         1 003744   000001 702211                    TSX2  ! 1,X1

ERRBITS
 Sect OctLoc
   0     000   211112 000000                                                    .J..

(unnamed)
 Sect OctLoc
   0     001   604000 000000   004000 000000   040000 000000                    ........ ...

(unnamed)
 Sect OctLoc
   2     000   000000 000315   000000 006000   000000 006000   000002 006000    ................
   2     004   000001 006000   777777 775777   000003 006000   000027 400000    ................
   2     010   000005 006000   777777 776777   777777 773777   000000 000224    ................
   2     014   100000 000000   000013 006000   000014 006000   000006 006000    @...............
   2     020   767777 777777   000026 040000   000000 000215   000022 006000    ...... .........
   2     024   577777 777777   000000 000311   000025 006000   777777 600777    ................
   2     030   757777 777777   777777 677777   777377 777777                    ............
      854     3682    2   END SETDENS;
      855     3683    1   END NIT$POSTER;
      856     3684        %EOD;

PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:152  
--  Include file information  --

   PM$NI.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   N_FC_C.:E05TOU  is referenced.
   NI_MACROS_C.:E05TOU  cannot be made into a system file and is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   NI$ERRLOG.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   HF_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FR$RAT.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure NIT$POSTER.
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:153  

 **** Variables and constants ****

  ****  Section 000 RoData NIT$POSTER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w BIT         r     1 ERRBITS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @INTLVL                    3-0-0/w PTR         r     1 @PAR
     5-0-0/w PTR         r     1 @STATUS                    6-0-0/w SBIN        r     1 CHANTIME
     7-0-0/w PTR         r     1 DCT$                      10-0-0/w PTR         r     1 DQH$
    11-0-0/w PTR         r     1 EXTST$                    12-0-0/w SBIN        r     1 I
    36-0-0/w SBIN        r     1 I                         *0-0-0/w UBIN(18)    r     1 INTLVL
    35-0-0/w UBIN        r     1 IOCHANX                   13-0-0/w PTR         r     1 IOS$
    37-0-0/w SBIN        r     1 J                         14-0-0/b BIT         r     1 MNSTAT(0:5)
    15-0-0/w UBIN        r     1 NEWSTATE                  16-0-0/w STRC(288)   r     1 NI$EXTST
    37-0-0/w PTR         r     1 P$                        *0-0-0/w SBIN        r     1 PAR
    26-0-0/w STRC        r     1 RCVR                      30-0-0/w PTR         r     1 REPOS$
    27-0-0/w PTR         r     1 REQ$                      31-0-0/w PTR         r     1 SETDENS$
    *0-0-0/d STRC(72)    r     1 SPSTAT                    32-0-0/w PTR         r     1 SQH$
    *0-0-0/d STRC(72)    r     1 STATUS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w BIT         r     1 HW_EXT_STATUS              0-0-0/w BIT         r     1 HW_IMX
     0-0-0/w BIT         r     1 HW_IOP                     0-0-0/w PTR         r     1 N$DCT$$
     0-0-0/w PTR         r     1 N$FQ$                      0-0-0/w PTR         r     1 NI$CHT$
     0-0-0/w PTR         r     1 NI$FQ$                     0-0-0/w PTR         r     1 NI$IBUF$
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:154  
     0-0-0/w PTR         r     1 NI$RP$                     0-0-0/d BIT (72)    r     1 NI_DBLZERO

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1332)  r     1 DCT                        0-0-0/w STRC(648)   r     1 DQH
     0-0-0/d STRC(504)   r     1 IOS                        0-0-0/d STRC(576)   r     1 IOSTAT
     0-0-0/d STRC(144)   r     1 MBX                        0-0-0/w PTR         r     1 N$DCT$(0:0)
     0-0-0/w STRC(72)    r     1 NI$CHT(0:127)              0-0-0/w STRC(612)   r     1 NI$IOERR
     0-0-0/w STRC(180)   r     1 NI$RP                      0-0-0/w STRC(324)   r     1 RAT
     0-0-0/d STRC(1080)  r     1 REQ                        0-0-0/w STRC(252)   r     1 SQH


   Procedure NIT$POSTER requires 2021 words for executable code.
   Procedure NIT$POSTER requires 40 words of local(AUTO) storage.
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:155  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:156  
          MINI XREF LISTING

BGNFREPOS
      3495**PROC     3253--CALL     3282--CALL     3332--CALL     3415--CALL     3432--CALL
BGNRETRY
      3412**PROC     3240--CALL
BYPASS_STATUS_ANALYSIS
      3227**LABEL    3064--GOTO
CHANTIME
      2536**DCL      2943<>CALL     3329>>ASSIGN
CHECK_DONE
      3572**PROC     3247--CALL     3258--CALL     3287--CALL     3312--CALL
DCT
      2606**DCL      3008<>CALL     3016<>CALL     3050<>CALL     3053<>CALL     3073<>CALL     3074<>CALL
      3077<>CALL     3255<>CALL     3284<>CALL     3337<>CALL     3404<>CALL     3409<>CALL     3480<>CALL
DCT.CTYP
      2614**DCL      3068>>IF
DCT.DCTX
      2607**DCL      3674>>ASSIGN
DCT.DFLG.MPCSTOP
      2611**DCL      3071<<ASSIGN
DCT.DFLG.MPCSUSPENDED
      2611**DCL      2966<<ASSIGN
DCT.DFLG.RELOAD
      2610**DCL      3072<<ASSIGN
DCT.DP
      2626**DCL      2633--REDEF    2636--REDEF    2637--REDEF    2639--REDEF    2639--REDEF    2640--REDEF
      2641--REDEF    2641--REDEF
DCT.DQH$
      2622**DCL      3032>>ASSIGN
DCT.DVN
      2615**DCL      2989>>IF
DCT.FIPS
      2614**DCL      3602>>IF       3615>>IF       3634>>IF       3655>>IF
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:157  
DCT.MPC.IOCHANX
      2634**DCL      2634--REDEF    3638>>ASSIGN
DCT.MSG#
      2626**DCL      3004>>IF       3005<>CALL     3006<<ASSIGN
DCT.MT.CURDENS
      2638**DCL      3620<<ASSIGN   3673>>ASSIGN
DCT.MT.FREPOS$
      2637**DCL      3012>>IF       3043>>IF       3275<<ASSIGN   3284>>CALL     3298<<ASSIGN   3360>>ASSIGN
      3361<<ASSIGN   3499>>IF       3501<<ASSIGN   3504>>ASSIGN
DCT.MT.LVALID
      2637**DCL      3521<<ASSIGN   3529<<ASSIGN   3536<<ASSIGN   3545<<ASSIGN   3550>>ASSIGN   3551<<ASSIGN
      3561<<ASSIGN
DCT.MT.PLOST
      2637**DCL      3521>>ASSIGN   3530<<ASSIGN   3532<<ASSIGN   3536>>ASSIGN   3538<<ASSIGN   3544<<ASSIGN
      3550<<ASSIGN   3561>>ASSIGN   3563<<ASSIGN
DCT.MT.POS
      2638**DCL      3528<<ASSIGN   3543<<ASSIGN
DCT.MT.POS.CRECCNT
      2638**DCL      3267>>IF       3269>>ASSIGN   3520>>ASSIGN   3522<<ASSIGN   3525<<ASSIGN   3525>>ASSIGN
      3535>>ASSIGN   3537<<ASSIGN   3549<<ASSIGN   3554<<ASSIGN   3554>>ASSIGN   3560>>ASSIGN   3562<<ASSIGN
      3566<<ASSIGN   3566>>ASSIGN
DCT.MT.POS.FILECNT
      2638**DCL      3261>>IF       3263>>ASSIGN   3519<<ASSIGN   3519>>ASSIGN   3534<<ASSIGN   3534>>ASSIGN
      3548<<ASSIGN   3548>>ASSIGN   3559<<ASSIGN   3559>>ASSIGN
DCT.MT.POS.LRECCNT
      2638**DCL      3520<<ASSIGN   3535<<ASSIGN   3549>>ASSIGN   3560<<ASSIGN
DCT.MT.RWC
      2637**DCL      3011<<ASSIGN   3048>>IF       3049<<ASSIGN
DCT.MT.SETDENS$
      2638**DCL      2999>>IF       3000>>IF       3000>>IF       3043>>IF       3291<<ASSIGN   3660<<ASSIGN
DCT.PM
      2617**DCL      2972<>CALL     2974<>CALL
DCT.RAT$
      2607**DCL      3012>>IF       3187>>IF
DCT.SPSTAT
      2618**DCL      2994<<ASSIGN
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:158  
DCT.SPSTAT.CODE
      2620**DCL      2998>>IF       3010>>IF       3012>>IF
DCT.SPSTAT.PRESENCE
      2618**DCL      2993>>IF       3017<<ASSIGN
DCT.SQ$
      2606**DCL      2971>>IF       3045<>CALL     3375<>CALL     3388<>CALL     3393<>CALL     3398<>CALL
DCT.SQH$
      2621**DCL      3033>>ASSIGN
DCT.STATE
      2616**DCL      2998>>IF
DCT.TYPE
      2616**DCL      2989>>IF
DCT$
      2537**DCL      2606--IMP-PTR  2942<<ASSIGN   2971>>IF       2972>>CALL     2974>>CALL     2988<<ASSIGN
      2989>>IF       2989>>IF       2993>>IF       2994>>ASSIGN   2998>>IF       2998>>IF       2999>>IF
      3000>>IF       3000>>IF       3004>>IF       3005>>CALL     3006>>ASSIGN   3008>>CALL     3010>>IF
      3011>>ASSIGN   3012>>IF       3012>>IF       3012>>IF       3016>>CALL     3017>>ASSIGN   3031<<ASSIGN
      3032>>ASSIGN   3033>>ASSIGN   3043>>IF       3043>>IF       3045>>CALL     3048>>IF       3049>>ASSIGN
      3050>>CALL     3053>>CALL     3068>>IF       3074>>CALL     3187>>IF       3255>>CALL     3261>>IF
      3263>>ASSIGN   3267>>IF       3269>>ASSIGN   3275>>ASSIGN   3284>>CALL     3284>>CALL     3291>>ASSIGN
      3298>>ASSIGN   3337>>CALL     3360>>ASSIGN   3361>>ASSIGN   3375>>CALL     3388>>CALL     3393>>CALL
      3398>>CALL     3404>>CALL     3409>>CALL     3499>>IF       3501>>ASSIGN   3504>>ASSIGN   3519>>ASSIGN
      3519>>ASSIGN   3520>>ASSIGN   3520>>ASSIGN   3521>>ASSIGN   3521>>ASSIGN   3522>>ASSIGN   3525>>ASSIGN
      3525>>ASSIGN   3528>>ASSIGN   3529>>ASSIGN   3530>>ASSIGN   3532>>ASSIGN   3534>>ASSIGN   3534>>ASSIGN
      3535>>ASSIGN   3535>>ASSIGN   3536>>ASSIGN   3536>>ASSIGN   3537>>ASSIGN   3538>>ASSIGN   3543>>ASSIGN
      3544>>ASSIGN   3545>>ASSIGN   3548>>ASSIGN   3548>>ASSIGN   3549>>ASSIGN   3549>>ASSIGN   3550>>ASSIGN
      3550>>ASSIGN   3551>>ASSIGN   3554>>ASSIGN   3554>>ASSIGN   3559>>ASSIGN   3559>>ASSIGN   3560>>ASSIGN
      3560>>ASSIGN   3561>>ASSIGN   3561>>ASSIGN   3562>>ASSIGN   3563>>ASSIGN   3566>>ASSIGN   3566>>ASSIGN
      3602>>IF       3615>>IF       3620>>ASSIGN   3655>>IF       3660>>ASSIGN   3673>>ASSIGN   3674>>ASSIGN
DQH
      2654**DCL      2929<>CALL     2933<>CALL     2935<>CALL     2962<>CALL     2978<>CALL     2980<>CALL
      3027<>CALL     3488<>CALL
DQH.CHANSTATE
      2662**DCL      3475>>IF
DQH.CHANSTATE.STOP
      2662**DCL      3476>>IF
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:159  
DQH.IO$
      2661**DCL      2941>>ASSIGN   2977>>IF
DQH.IOCHANX
      2656**DCL      2657--REDEF
DQH.IOSTATUS$
      2661**DCL      2930>>IF       2933>>CALL     2945>>ASSIGN   2949>>ASSIGN   2965>>ASSIGN   2980>>CALL
DQH.LA
      2664**DCL      3000>>IF       3000>>IF       3640>>IF       3640>>IF
DQH.MBX$
      2665**DCL      2666--REDEF    2947>>ASSIGN
DQH.MPC$
      2661**DCL      2966>>ASSIGN   3000>>IF       3000>>IF       3071>>ASSIGN   3072>>ASSIGN   3073>>CALL
      3077>>CALL     3480>>CALL     3634>>IF       3640>>IF       3640>>IF
DQH.MREC
      2654**DCL      3474<<ASSIGN
DQH.PM
      2658**DCL      2943<>CALL
DQH.SQH$
      2660**DCL      2921>>ASSIGN   2986>>ASSIGN   3636>>IF       3638>>ASSIGN
DQH.STATE
      2658**DCL      2925>>IF       3473<<ASSIGN
DQH.STATUS.DOWN
      2654**DCL      3486>>IF       3640>>IF
DQH$
      2538**DCL      2654--IMP-PTR  2920<<ASSIGN   2921>>ASSIGN   2925>>IF       2929>>CALL     2930>>IF
      2933>>CALL     2933>>CALL     2935>>CALL     2941>>ASSIGN   2943>>CALL     2945>>ASSIGN   2947>>ASSIGN
      2949>>ASSIGN   2962>>CALL     2965>>ASSIGN   2966>>ASSIGN   2976<<ASSIGN   2977>>IF       2978>>CALL
      2980>>CALL     2980>>CALL     2985<<ASSIGN   2986>>ASSIGN   3000>>IF       3000>>IF       3027>>CALL
      3032<<ASSIGN   3071>>ASSIGN   3072>>ASSIGN   3073>>CALL     3077>>CALL     3473>>ASSIGN   3474>>ASSIGN
      3475>>IF       3476>>IF       3480>>CALL     3486>>IF       3488>>CALL     3634>>IF       3636>>IF
      3638>>ASSIGN   3640>>IF       3640>>IF       3675>>ASSIGN
ERRBITS IN PROCEDURE CHECK_DONE
      3573**DCL      3589>>IF       3609>>IF
EXTST$
      2539**DCL      3059<<ASSIGN   3351<>CALL     3352>>ASSIGN   3353>>ASSIGN   3354>>ASSIGN   3355>>ASSIGN
      3356>>ASSIGN   3357>>ASSIGN   3358>>CALL     3360>>ASSIGN   3362>>ASSIGN   3365<>CALL     3396>>IF
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:160  
      3398>>CALL     3441>>IF       3442>>ASSIGN   3443<>CALL
FLT_ALT
      3226**LABEL    3224--CALLALT
FREPOS_CONT
      3277**LABEL    3258--CALLALT
FREPOS_DONE
      3273**LABEL    3267--GOTO
FREPOS_SPR
      3267**LABEL    3261--GOTO
GETRTY
      3463**PROC     3417--CALL     3423--CALL
HFC$LOCK
       765**DCL-ENT  2923--CALL     2991--CALL     3041--CALL     3372--CALL     3384--CALL     3450--CALL
      3482--CALL
HFC$UNLOCK
       765**DCL-ENT  2937--CALL     2954--CALL     2969--CALL     2996--CALL     3021--CALL     3378--CALL
      3402--CALL     3456--CALL     3478--CALL
HW_EXT_STATUS
       748**DCL      3344>>IF
HW_IMX
       751**DCL      2944>>IF       3068>>IF
HW_IOP
       748**DCL      2950>>IF
I
      2540**DCL      2987<<DOINDEX  2988>>ASSIGN   3103<<DOINDEX  3104>>IF       3104>>DOCASE   3122<<DOINDEX
      3123>>IF       3123>>DOCASE   3540<<ASSIGN   3554>>ASSIGN   3566>>ASSIGN
I IN PROCEDURE CHECK_DONE
      3576**DCL      3587<<ASSIGN   3588<<ASSIGN   3589>>IF       3590>>IF       3590>>ASSIGN   3607<<ASSIGN
      3608<<ASSIGN   3609>>IF       3637<<DOINDEX  3638>>ASSIGN
INTLVL
      2444**DCL         8--PROC     2918>>DOCASE   2929<>CALL     2930>>IF       2933<>CALL     2935<>CALL
      2948>>IF       2978<>CALL     2980<>CALL     3027<>CALL
IOCHANX IN PROCEDURE CHECK_DONE
      3575**DCL      3638<<ASSIGN   3639>>IF       3640>>IF       3640>>IF       3640>>IF       3644>>ASSIGN
IOM_ALT
      3093**LABEL    3091--CALLALT
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:161  
IOS.DCW
      2684**DCL      2687--REDEF
IOS.DCW.TALLY
      2685**DCL      2685--REDEF
IOS.IDCW.EXTA
      2687**DCL      2687--REDEF
IOS.IDCW.RCNT
      2688**DCL      3540>>ASSIGN   3586>>ASSIGN   3590<<ASSIGN
IOS.PCW
      2689**DCL      2693--REDEF
IOS.SEEK
      2694**DCL      2695--REDEF    2696--REDEF
IOS$
      2541**DCL      2682--IMP-PTR
IOSTAT.AESDCW
      2704**DCL      2704--REDEF
IOSTAT.EXTST
      2705**DCL      2965>>ASSIGN
IOSTAT.LPW_RESIDUE
      2702**DCL      2945>>ASSIGN
IOSTAT.STATUS
      2699**DCL      2933<>CALL     2949>>ASSIGN   2980<>CALL
IOS_CONT
      3326**LABEL    3312--CALLALT
J IN PROCEDURE CHECK_DONE
      3577**DCL      3635<<DOINDEX  3636>>IF       3638>>ASSIGN
MBX.DCW.CONTROL.AE
      2723**DCL      2723--REDEF
MBX.LPW
      2718**DCL      2947>>ASSIGN
MBX.LPW.CONTROL.AE
      2719**DCL      2719--REDEF
MNSTAT
      2542**DCL      3102<<ASSIGN   3104>>IF       3121<<ASSIGN   3123>>IF       3135>>IF
N$DCT$
      1377**DCL      2988>>ASSIGN
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:162  
N$DCT$$
      1243**DCL      1377--IMP-PTR  2988>>ASSIGN
N$FQ$
      1243**DCL      1378--IMP-PTR
N$REQ_INIT.BUFADDR
      1262**DCL      1263--REDEF    1263--REDEF
N$REQ_INIT.DLA.DRELADDR
      1254**DCL      1254--REDEF
N$REQ_INIT.DVE.EOMCHAR
      1291**DCL      1292--REDEF
N$REQ_INIT.EAINFO
      1285**DCL      1285--REDEF
N$REQ_INIT.EAINFOX
      1285**DCL      1286--REDEF
N$REQ_INIT.EVNTINFO
      1286**DCL      1286--REDEF
N$REQ_INIT.STATUS
      1267**DCL      1273--REDEF
NEWSTATE
      2543**DCL      3062<<ASSIGN   3067<<ASSIGN   3093<<ASSIGN   3108<<ASSIGN   3115<<ASSIGN   3177<<ASSIGN
      3182<<ASSIGN   3226<<ASSIGN   3250>>IF       3254<<ASSIGN   3255<>CALL     3283<<ASSIGN   3284<>CALL
      3297<<ASSIGN   3308<<ASSIGN   3337<>CALL     3362>>ASSIGN   3363<<ASSIGN   3404<>CALL     3409<>CALL
      3458<<ASSIGN
NI$CHT.DQH$
      2727**DCL      3640>>IF       3640>>IF       3640>>IF       3644>>ASSIGN
NI$CHT$
      1302**DCL      2727--IMP-PTR  3640>>IF       3640>>IF       3640>>IF       3644>>ASSIGN
NI$EXTST
      2549**DCL      3381<>CALL
NI$EXTST.EXTST
      2553**DCL      2555--REDEF    2557--REDEF    2965<<ASSIGN   3034<<ASSIGN   3346>>ASSIGN
NI$EXTST.EXTSTT.WRD
      2556**DCL      3345>>IF
NI$FQ$
      1303**DCL      1379--IMP-PTR
NI$IBUF$
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:163  
      1303**DCL      1379--IMP-PTR
NI$IMXMBX_INIT.PAGED_BASE
      1313**DCL      1314--REDEF    1314--REDEF
NI$IMXMBX_INIT.SIZE
      1315**DCL      1315--REDEF
NI$IOERR.EXTST
      2757**DCL      2759--REDEF    3346<<ASSIGN   3354--ASSIGN   3355--ASSIGN
NI$IOERR.GOTEXTST
      2780**DCL      3343>>IF       3347<<ASSIGN   3359<<ASSIGN
NI$REQ_INIT.DCW
      1337**DCL      1340--REDEF
NI$REQ_INIT.DCW.TALLY
      1338**DCL      1338--REDEF
NI$REQ_INIT.IDCW.EXTA
      1340**DCL      1340--REDEF
NI$REQ_INIT.PCW
      1342**DCL      1346--REDEF
NI$REQ_INIT.SEEK
      1347**DCL      1348--REDEF    1349--REDEF
NI$RP.GATE
      1381**DCL      3450<>CALL     3456<>CALL
NI$RP.RP$
      1381**DCL      3453<>CALL
NI$RP$
      1351**DCL      1381--IMP-PTR  3450>>CALL     3453>>CALL     3456>>CALL
NIA$LOGERR
      2516**DCL-ENT  3340--CALL
NIA$SPURINT
      2517**DCL-ENT  2929--CALL     2933--CALL     2935--CALL     2978--CALL     2980--CALL     3027--CALL
NIF$ANFAULT
      2522**DCL-ENT  3224--CALL
NIF$ANIOM
      2523**DCL-ENT  3091--CALL
NIK$OPMSG
      2521**DCL-ENT  3074--CALL     3255--CALL     3284--CALL     3337--CALL
NIM$ENQUEUE
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:164  
      1407**DCL-ENT  3453--CALL     3488--CALL
NIM$REQUEUE
      1408**DCL-ENT  3045--CALL     3375--CALL     3388--CALL     3393--CALL     3398--CALL
NIO$COMP
      2519**DCL-ENT  3381--CALL
NIO$DCWBLD
      2520**DCL-ENT  3265--CALL     3271--CALL     3317--CALL     3358--CALL     3421--CALL     3428--CALL
      3510--CALL     3677--CALL
NIO$SPCOMP
      2518**DCL-ENT  3016--CALL
NIQ$GET
      2525**DCL-ENT  3351--CALL     3464--CALL     3500--CALL     3670--CALL
NIQ$REL
      2524**DCL-ENT  3274--CALL     3290--CALL     3301--CALL     3365--CALL     3443--CALL     3447--CALL
      3678--CALL
NIS$MASK
      2526**DCL-ENT  2962--CALL
NIT$DEVSCHED
      2527**DCL-ENT  3008--CALL     3404--CALL     3409--CALL
NIT$DEVSCHEDL
      2528**DCL-ENT  3050--CALL     3053--CALL
NIW$LDFW
      2529**DCL-ENT  3077--CALL
NIW$MPCSTOP
      2530**DCL-ENT  3073--CALL     3480--CALL
NI_DBLZERO
      1352**DCL      2935<>CALL     2978<>CALL
NI_MBX_INIT.DCW.CONTROL.AE
      1373**DCL      1373--REDEF
NI_MBX_INIT.LPW.CONTROL.AE
      1369**DCL      1369--REDEF
NOEXTST
      3367**LABEL    3351--CALLALT
NOEXTST0
      3365**LABEL    3358--CALLALT
OCI$MK_STTM
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:165  
      2531**DCL-ENT  3005--CALL
P$ IN PROCEDURE BGNFREPOS
      3497**DCL      3500<>CALL     3501>>ASSIGN   3504<<ASSIGN   3506>>ASSIGN   3507>>ASSIGN   3508>>ASSIGN
      3509>>ASSIGN   3510>>CALL
PAR
      2445**DCL         8--PROC     2920--ASSIGN   2976--ASSIGN   2985--ASSIGN   3030--ASSIGN
PMN$COLLECT
      2532**DCL-ENT  2943--CALL     2972--CALL     2974--CALL
RAT.FLG.RUP
      2819**DCL      3012>>IF       3187>>IF
RCVR
      2578**DCL      3058<<ASSIGN   3066<<ASSIGN   3088<<ASSIGN   3095<<ASSIGN   3096<<ASSIGN   3100<<ASSIGN
      3107<<ASSIGN   3111<<ASSIGN   3114<<ASSIGN   3128<<ASSIGN   3131<<ASSIGN   3141<<ASSIGN   3154<<ASSIGN
      3158<<ASSIGN   3163<<ASSIGN   3173<<ASSIGN   3178<<ASSIGN   3183<<ASSIGN   3188<<ASSIGN   3191<<ASSIGN
      3194<<ASSIGN   3197<<ASSIGN   3203<<ASSIGN   3206<<ASSIGN   3209<<ASSIGN   3217<<ASSIGN   3220<<ASSIGN
      3223<<ASSIGN   3231<<ASSIGN   3278<<ASSIGN   3293<<ASSIGN   3299<<ASSIGN   3330<<ASSIGN
RCVR.EOT
      2587**DCL      3146<<ASSIGN
RCVR.EXTST
      2586**DCL      3350>>IF
RCVR.FREPOS
      2583**DCL      3224<>CALL     3228>>IF       3307<<ASSIGN   3332>>IF       3430<<ASSIGN
RCVR.LOGERR
      2582**DCL      3339>>IF
RCVR.NOINC
      2581**DCL      3241>>IF
RCVR.OPMSG
      2584**DCL      3250<<ASSIGN   3309<<ASSIGN   3336>>IF
RCVR.REPOS
      2580**DCL      3145>>IF       3228<<ASSIGN   3237<<ASSIGN   3237>>ASSIGN   3413>>IF
RCVR.RETRY
      2579**DCL      3091<>CALL     3095>>IF       3224<>CALL     3238>>IF       3243<<ASSIGN   3252>>IF
      3281>>IF       3305>>IF       3306<<ASSIGN   3318<<ASSIGN   3323<<ASSIGN   3370>>IF       3434<<ASSIGN
      3591<<ASSIGN   3610<<ASSIGN   3645<<ASSIGN
RCVR.SETDENS
      2588**DCL      3333>>IF       3603<<ASSIGN   3616<<ASSIGN   3656<<ASSIGN   3658>>IF       3663<<ASSIGN
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:166  
RELCHAN
      3472**PROC     2967--CALL
REPOS$
      2591**DCL      3060<<ASSIGN   3386>>IF       3388>>CALL     3418>>ASSIGN   3419>>ASSIGN   3420>>ASSIGN
      3421>>CALL     3424>>ASSIGN   3425>>ASSIGN   3426>>ASSIGN   3427>>ASSIGN   3428>>CALL     3445>>IF
      3446>>ASSIGN   3447<>CALL     3464<>CALL     3465>>ASSIGN   3466>>ASSIGN
REPOST
      3408**LABEL    3240--CALLALT  3332--CALLALT
REPOST IN PROCEDURE BGNFREPOS
      3512**LABEL    3500--CALLALT  3510--CALLALT
REPOST IN PROCEDURE BGNRETRY
      3437**LABEL    3415--CALLALT  3417--CALLALT  3421--CALLALT  3423--CALLALT  3428--CALLALT  3432--CALLALT
REPOST IN PROCEDURE GETRTY
      3469**LABEL    3464--CALLALT
REQ
      2832**DCL      3045<>CALL     3074<>CALL     3091<>CALL     3224<>CALL     3255<>CALL     3265<>CALL
      3271<>CALL     3284<>CALL     3317<>CALL     3337<>CALL     3340<>CALL     3358<>CALL     3375<>CALL
      3381<>CALL     3388<>CALL     3393<>CALL     3398<>CALL     3421<>CALL     3428<>CALL     3453<>CALL
      3510<>CALL     3677<>CALL
REQ.ARCT
      2867**DCL      3586<<ASSIGN   3586>>ASSIGN   3589>>IF       3590>>IF       3590>>ASSIGN   3595<<ASSIGN
      3595>>ASSIGN   3597<<ASSIGN   3597>>ASSIGN   3598<<ASSIGN   3598>>ASSIGN   3600>>IF       3600<<ASSIGN
      3601>>ASSIGN   3606<<ASSIGN   3606>>ASSIGN   3609>>IF       3614>>ASSIGN
REQ.ARSIZE
      2865**DCL      3601<<ASSIGN   3614<<ASSIGN
REQ.BUF$
      2841**DCL      3354<<ASSIGN
REQ.BUFADDR
      2841**DCL      2842--REDEF    2842--REDEF
REQ.BUFSIZE
      2835**DCL      3355<<ASSIGN
REQ.COMP
      2866**DCL      3063>>IF       3235>>DOCASE   3357<<ASSIGN   3466<<ASSIGN   3506<<ASSIGN   3676<<ASSIGN
REQ.DCT$
      2833**DCL      2942>>ASSIGN   3031>>ASSIGN
REQ.DLA
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:167  
      2832**DCL      3356<<ASSIGN   3356>>ASSIGN   3465<<ASSIGN   3465>>ASSIGN   3509<<ASSIGN   3509>>ASSIGN
REQ.DLA.DCTX
      2832**DCL      3674<<ASSIGN
REQ.DLA.DRELADDR
      2833**DCL      2833--REDEF
REQ.DQH$
      2854**DCL      3000>>IF       3000>>IF       3644<<ASSIGN   3675<<ASSIGN
REQ.DVE.EOMCHAR
      2870**DCL      2871--REDEF
REQ.EAINFO
      2864**DCL      2864--REDEF    3321>>IF       3322<<ASSIGN   3322>>ASSIGN   3329<<ASSIGN   3427<<ASSIGN
REQ.EAINFOP$
      2864**DCL      3298>>ASSIGN   3360<<ASSIGN
REQ.EAINFOX
      2864**DCL      2865--REDEF    3297>>ASSIGN   3362<<ASSIGN
REQ.ERR$
      2854**DCL      3342>>IF       3343>>IF       3346>>ASSIGN   3347>>ASSIGN   3354>>ASSIGN   3359>>ASSIGN
REQ.ERRCT
      2834**DCL      3241<<ASSIGN   3241>>ASSIGN   3242>>IF
REQ.EVNTINFO
      2865**DCL      2865--REDEF
REQ.FC
      2835**DCL      3063>>IF       3063>>IF       3262<<ASSIGN   3268<<ASSIGN   3296>>IF       3316<<ASSIGN
      3352<<ASSIGN   3413>>DOCASE   3418<<ASSIGN   3424<<ASSIGN   3508<<ASSIGN   3516>>DOCASE   3584>>DOCASE
      3620>>ASSIGN   3673<<ASSIGN
REQ.FIPS_DENS_DONE
      2872**DCL      3634>>IF       3643<<ASSIGN   3653<<ASSIGN
REQ.FLPW
      2853**DCL      2945<<ASSIGN   2947<<ASSIGN
REQ.IOFLG.REL
      2837**DCL      2966>>IF
REQ.IOQFLG.IOQUED
      2875**DCL      3273<<ASSIGN   3289<<ASSIGN   3300<<ASSIGN   3442<<ASSIGN   3446<<ASSIGN
REQ.IOS$
      2845**DCL      3540>>ASSIGN   3586>>ASSIGN   3590>>ASSIGN
REQ.OPFLG
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:168  
      2838**DCL      3353<<ASSIGN
REQ.POSTER
      2844**DCL      3259>>DOCASE   3264<<ASSIGN   3270<<ASSIGN   3313>>DOCASE   3319<<ASSIGN   3420<<ASSIGN
      3426<<ASSIGN   3507<<ASSIGN
REQ.RCT
      2867**DCL      3263<<ASSIGN   3269<<ASSIGN   3419<<ASSIGN   3425<<ASSIGN   3541>>IF       3587>>IF
      3587>>ASSIGN   3588>>ASSIGN   3607>>IF       3607>>ASSIGN   3608>>ASSIGN
REQ.STATUS
      2846**DCL      2852--REDEF    2949<<ASSIGN   2960<<ASSIGN
REQ.STATUS.ININT
      2848**DCL      3237>>ASSIGN
REQ.STATUS.IOM
      2849**DCL      3090>>IF
REQ.STATUS.IOM.CHANNEL
      2849**DCL      2951>>IF
REQ.STATUS.MAJOR
      2846**DCL      2951>>IF       2961>>IF       3038>>IF       3080>>DOCASE   3597>>IF
REQ.STATUS.MINOR
      2847**DCL      3038>>IF       3085>>IF       3086>>IF       3102>>ASSIGN   3121>>ASSIGN   3149>>IF
      3149>>IF       3152>>IF       3158>>IF       3161>>IF       3161>>IF       3165>>IF       3168>>IF
      3171>>IF       3180>>DOCASE   3200>>DOCASE   3214>>DOCASE
REQ.STATUS.POWEROFF
      2846**DCL      3065>>IF
REQ.STATUS.PRESENCE
      2846**DCL      3082>>IF
REQ.STATUS.RCR
      2850**DCL      3540>>ASSIGN   3586>>ASSIGN
REQ.TYC
      2854**DCL      3057<<ASSIGN   3239>>IF       3589>>IF       3609>>IF
REQ.TYC.BLNKTP
      2856**DCL      3133<<ASSIGN   3136<<ASSIGN
REQ.TYC.BOT
      2855**DCL      3085<<ASSIGN   3169<<ASSIGN   3542>>IF       3596>>IF       3602>>IF       3615>>IF
REQ.TYC.EOF
      2856**DCL      3150<<ASSIGN   3518>>IF       3547>>IF       3558>>IF       3595>>IF       3606>>IF
REQ.TYC.EOT
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:169  
      2855**DCL      3125<<ASSIGN   3145>>IF
REQ.TYC.FRAW
      2860**DCL      3166<<ASSIGN
REQ.TYC.IOERR
      2857**DCL      3083<<ASSIGN   3087<<ASSIGN   3099<<ASSIGN   3106<<ASSIGN   3110<<ASSIGN   3113<<ASSIGN
      3127<<ASSIGN   3130<<ASSIGN   3137<<ASSIGN   3140<<ASSIGN   3153<<ASSIGN   3157<<ASSIGN   3162<<ASSIGN
      3172<<ASSIGN   3184<<ASSIGN   3186<<ASSIGN   3190<<ASSIGN   3193<<ASSIGN   3196<<ASSIGN   3202<<ASSIGN
      3205<<ASSIGN   3208<<ASSIGN   3216<<ASSIGN   3219<<ASSIGN   3230<<ASSIGN   3239<<ASSIGN
REQ.TYC.PROT
      2859**DCL      3117<<ASSIGN
REQ.TYC.TIMO
      2859**DCL      3176<<ASSIGN
REQ$
      2590**DCL      2832--IMP-PTR  2941<<ASSIGN   2942>>ASSIGN   2945>>ASSIGN   2947>>ASSIGN   2949>>ASSIGN
      2951>>IF       2951>>IF       2960>>ASSIGN   2961>>IF       2966>>IF       3030<<ASSIGN   3031>>ASSIGN
      3038>>IF       3038>>IF       3043>>IF       3043>>IF       3045>>CALL     3057>>ASSIGN   3063>>IF
      3063>>IF       3063>>IF       3065>>IF       3074>>CALL     3080>>DOCASE   3082>>IF       3083>>ASSIGN
      3085>>IF       3085>>ASSIGN   3086>>IF       3087>>ASSIGN   3090>>IF       3091>>CALL     3099>>ASSIGN
      3102>>ASSIGN   3106>>ASSIGN   3110>>ASSIGN   3113>>ASSIGN   3117>>ASSIGN   3121>>ASSIGN   3125>>ASSIGN
      3127>>ASSIGN   3130>>ASSIGN   3133>>ASSIGN   3136>>ASSIGN   3137>>ASSIGN   3140>>ASSIGN   3145>>IF
      3149>>IF       3149>>IF       3150>>ASSIGN   3152>>IF       3153>>ASSIGN   3157>>ASSIGN   3158>>IF
      3161>>IF       3161>>IF       3162>>ASSIGN   3165>>IF       3166>>ASSIGN   3168>>IF       3169>>ASSIGN
      3171>>IF       3172>>ASSIGN   3176>>ASSIGN   3180>>DOCASE   3184>>ASSIGN   3186>>ASSIGN   3190>>ASSIGN
      3193>>ASSIGN   3196>>ASSIGN   3200>>DOCASE   3202>>ASSIGN   3205>>ASSIGN   3208>>ASSIGN   3214>>DOCASE
      3216>>ASSIGN   3219>>ASSIGN   3224>>CALL     3230>>ASSIGN   3235>>DOCASE   3237>>ASSIGN   3239>>IF
      3239>>ASSIGN   3241>>ASSIGN   3241>>ASSIGN   3242>>IF       3255>>CALL     3259>>DOCASE   3262>>ASSIGN
      3263>>ASSIGN   3264>>ASSIGN   3265>>CALL     3268>>ASSIGN   3269>>ASSIGN   3270>>ASSIGN   3271>>CALL
      3273>>ASSIGN   3274<>CALL     3279<<ASSIGN   3289>>ASSIGN   3290<>CALL     3294<<ASSIGN   3296>>IF
      3297>>ASSIGN   3298>>ASSIGN   3300>>ASSIGN   3301<>CALL     3302<<ASSIGN   3313>>DOCASE   3316>>ASSIGN
      3317>>CALL     3319>>ASSIGN   3321>>IF       3322>>ASSIGN   3322>>ASSIGN   3329>>ASSIGN   3335>>IF
      3337>>CALL     3340>>CALL     3342>>IF       3343>>IF       3346>>ASSIGN   3347>>ASSIGN   3354>>ASSIGN
      3356>>ASSIGN   3359>>ASSIGN   3375>>CALL     3381>>CALL     3413>>DOCASE   3453>>CALL     3459<<ASSIGN
      3465>>ASSIGN   3509>>ASSIGN   3516>>DOCASE   3518>>IF       3540>>ASSIGN   3540>>ASSIGN   3541>>IF
      3542>>IF       3547>>IF       3558>>IF       3584>>DOCASE   3586>>ASSIGN   3586>>ASSIGN   3586>>ASSIGN
      3586>>ASSIGN   3587>>IF       3587>>ASSIGN   3588>>ASSIGN   3589>>IF       3589>>IF       3590>>IF
      3590>>ASSIGN   3590>>ASSIGN   3595>>IF       3595>>ASSIGN   3595>>ASSIGN   3596>>IF       3597>>IF
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:170  
      3597>>ASSIGN   3597>>ASSIGN   3598>>ASSIGN   3598>>ASSIGN   3600>>IF       3600>>ASSIGN   3601>>ASSIGN
      3601>>ASSIGN   3602>>IF       3606>>IF       3606>>ASSIGN   3606>>ASSIGN   3607>>IF       3607>>ASSIGN
      3608>>ASSIGN   3609>>IF       3609>>IF       3614>>ASSIGN   3614>>ASSIGN   3615>>IF       3620>>ASSIGN
      3634>>IF       3643>>ASSIGN   3644>>ASSIGN   3653>>ASSIGN
SETDENS
      3668**PROC     3334--CALL     3659--CALL
SETDENS$
      2592**DCL      3061<<ASSIGN   3391>>IF       3393>>CALL     3660>>ASSIGN   3661<<ASSIGN   3670<>CALL
      3673>>ASSIGN   3674>>ASSIGN   3675>>ASSIGN   3676>>ASSIGN   3677>>CALL     3678<>CALL
SETDENS_CONT
      3293**LABEL    3287--CALLALT
SETREPOST
      3440**PROC     3408--CALL
SKIP_SPEC
      3009**LABEL    3002--GOTO
SPSTAT.DVN
      2502**DCL      2989>>IF
SQH.CQ$
      2891**DCL      3488<>CALL
SQH.DOOR
      2890**DCL      2890--REDEF
SQH.FDCT
      2890**DCL      2987>>DOINDEX  2987>>DOINDEX
SQH.GATE
      2890**DCL      2923<>CALL     2937<>CALL     2954<>CALL     2969<>CALL     2991<>CALL     2996<>CALL
      3021<>CALL     3041<>CALL     3372<>CALL     3378<>CALL     3384<>CALL     3402<>CALL     3478<>CALL
      3482<>CALL
SQH.MPC$
      2892**DCL      3636>>IF       3638>>ASSIGN
SQH.NDCT
      2891**DCL      2987>>DOINDEX
SQH$
      2593**DCL      2890--IMP-PTR  2921<<ASSIGN   2923>>CALL     2937>>CALL     2954>>CALL     2969>>CALL
      2986<<ASSIGN   2987>>DOINDEX  2987>>DOINDEX  2987>>DOINDEX  2991>>CALL     2996>>CALL     3021>>CALL
      3033<<ASSIGN   3041>>CALL     3372>>CALL     3378>>CALL     3384>>CALL     3402>>CALL     3478>>CALL
      3482>>CALL     3488>>CALL
PL6.E3A0      #001=NIT$POSTER File=NIT$TAPE.:E05TSI                              WED 07/30/97 03:37 Page:171  
STATUS
      2451**DCL         8--PROC     2476--REDEF    2492--REDEF    2927--IF       2929<>CALL     2960>>ASSIGN
      2983--IF       2994>>ASSIGN   3027<>CALL
UPDATE_POS
      3515**PROC     3248--CALL

PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:172  
      857        1        /*T***********************************************************/
      858        2        /*T*                                                         */
      859        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      860        4        /*T*                                                         */
      861        5        /*T***********************************************************/
      862        6        /*D*    ENTRY:      NIT$DEVSCHED
      863        7                            NIT$DEVSCHEDL
      864        8
      865        9                CALL:       CALL NIT$DEVSCHED(DCT,NEWSTATE);
      866       10                            CALL NIT$DEVSCHEDL(DCT,NEWSTATE);
      867       11
      868       12                ENVIRONMENT: Monitor linkage segment.  For NIT$DEVSCHEDL
      869       13                             SQH.GATE is already locked.
      870       14
      871       15                DESCRIPTION:   SQH.GATE is locked and the devices state is
      872       16                               changed to NEWSTATE.  Control then passes to
      873       17                               the SCHED code which is common to NIT$REQSCHED
      874       18                               and NIT$DEVSCHED(L).
      875       19
      876       20                               At SCHED if the device's state is IDLE and
      877       21                               there are requests pending on the device, it
      878       22                               is placed on the assign queue for the
      879       23                               subsystem and the devices state is changed
      880       24                               to requested.  Control then passes to
      881       25                               NIT$SCANAQ.
      882       26                                                                           */
      883       27        NIT$DEVSCHED: PROC (PAR, NEWSTATE);
      884       28        /*
      885       29              Includes
      886       30        */
      887       31        %INCLUDE                HF_LOCK_C ;
      888       45        %INCLUDE                NI_DATA_C ;
      889      158        %INCLUDE                NI_DATA_R ;
      890      595        %INCLUDE                NI_MACROS_C ;
      891      862        %INCLUDE                N_FC_C ;
      892      899        %INCLUDE                PM$NI ;
      893      923        /*
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:173  
      894      924              Parameters
      895      925        */
      896      926    1   DCL 1 NEWSTATE        SBIN PARAM ;
      897      927    1   DCL 1 PAR             UBIN PARAM ;
      898      928        /*
      899      929              Entries
      900      930        */
      901      931    1   DCL 1 NIS$DRIVER        ENTRY(1) ;
      902      932    1   DCL 1 NIT$REPOS         ENTRY(2) ALTRET ;
      903      933    1   DCL 1 NIW$LDFWR         ENTRY(2) ALTRET ;
      904      934    1   DCL 1 PMN$COLLECT       ENTRY(3) ;
      905      935        /*
      906      936              Auto
      907      937        */
      908      938    1   DCL 1 DCT$              PTR ALIGNED AUTO ;
      909      939    1   DCL 1 DQH$              PTR ALIGNED AUTO ;
      910      940    1   DCL 1 DVT$              PTR ALIGNED AUTO ;
      911      941    1   DCL 1 I                 UBIN(36) ALIGNED AUTO ;
      912      942    1   DCL 1 J                 UBIN(36) ALIGNED AUTO ;
      913      943    1   DCL 1 LAX               UBIN(36) ALIGNED AUTO ;
      914      944    1   DCL 1 REQ$              PTR ALIGNED AUTO ;
      915      945    1   DCL 1 SQH$              PTR ALIGNED AUTO ;
      916      946    1   DCL 1 SVDCT$            PTR ALIGNED AUTO ;
      917      947    1   DCL 1 SVDQH$            PTR ALIGNED AUTO ;
      918      948    1   DCL 1 T$                PTR ALIGNED AUTO ;
      919      949        /*
      920      950              Based
      921      951        */
      922      952        %NI$DCT                 ( NAME=DCT, STCLASS="BASED(DCT$)" ) ;
      923     1000        %NI$DQH                 ( NAME=DQH, STCLASS="BASED(DQH$)" ) ;
      924     1023        %NI$DVT                 ( NAME=DVT, STCLASS="BASED(DVT$)" ) ;
      925     1030        %NI$REQ                 ( NAME=NI$REQ ) ;
      926     1055        %N$REQ                  ( NAME=REQ, STCLASS="BASED(REQ$)" ) ;
      927     1113        %NI$SQH                 ( NAME=SQH, STCLASS="BASED(SQH$)" ) ;
      928     1126        %EJECT ;
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:174  
      929     1127    1           DCT$=ADDR(PAR);
      930     1128    1           SQH$=DCT.SQH$;
      931     1129                %LOCK (G#=SQH.GATE);
      932     1132    1           DCT.STATE=NEWSTATE;
      933     1133    1           GOTO SCHED;
      934     1134        /**/
      935     1135        %EJECT;
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:175  
      936     1136        /*D*    ENTRY:      NIT$REQSCHED
      937     1137
      938     1138                CALL:       CALL NIT$REQSCHED(N$REQ);
      939     1139
      940     1140                ENVIRONMENT: Monitor linkage segment
      941     1141
      942     1142                INPUT:      N$REQ - IOQ packet
      943     1143
      944     1144                DESCRIPTION:   NIT$REQSCHED enqueues the request on the
      945     1145                               devices scheduler queue and then goes to the
      946     1146                               common code at SCHED.
      947     1147                                                                           */
      948     1148    1   NIT$REQSCHED: ENTRY(PAR);
      949     1149    1           REQ$=ADDR(PAR);
      950     1150    1           DCT$=REQ.DCT$;
      951     1151    1           SQH$=DCT.SQH$;
      952     1152                %LOCK (G#=SQH.GATE);
      953     1155                %ENQUEUE (P#=REQ,Q#=DCT.SQ$);
      954     1158    1           GOTO SCHED;
      955     1159        %EJECT;
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:176  
      956     1160    1   NIT$DEVSCHEDL: ENTRY(PAR,NEWSTATE);
      957     1161    1           DCT$=ADDR(PAR);
      958     1162    1           SQH$=DCT.SQH$;
      959     1163    1           DCT.STATE=NEWSTATE;
      960     1164        /**/
      961     1165        /**/
      962     1166        /**/
      963     1167    1   SCHED:
      964     1168    2           IF DCT.STATE=%IDLE AND DCT.SQ$~=ADDR(NIL) THEN DO;
      965     1169                   %ENQUEUE (P#=DCT,Q#=SQH.AQ$);
      966     1172    2              DCT.STATE=%REQUESTED;
      967     1173    2              CALL PMN$COLLECT(DCT.PM,%PM_WAIT);
      968     1174    2              END;
      969     1175    1           GOTO SCANAQ;
      970     1176        %EJECT;
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:177  
      971     1177        /*D*    ENTRY:      NIT$SCANAQ
      972     1178
      973     1179                CALL:       CALL NIT$SCANAQ(SQH);
      974     1180
      975     1181                DESCRIPTION:      NIT$SCANAQ scans the subsystem assign queue
      976     1182                                  to find any requests that can be started.
      977     1183                                                                           */
      978     1184    1   NIT$SCANAQ: ENTRY(PAR);
      979     1185    1           SQH$=ADDR(PAR);
      980     1186                %LOCK (G#=SQH.GATE);
      981     1189    1   SCANAQ:
      982     1190    1           SVDCT$=ADDR(NIL);
      983     1191    1           SVDQH$=ADDR(NIL);
      984     1192    2           DO WHILE(SQH.AQ$~=ADDR(NIL));
      985     1193                   %DEQUEUE(P#=DCT$,Q#=SQH.AQ$);
      986     1200    2              DVT$=DCT.DVT$;
      987     1201    2              IF DCT.TYPE=%DV_MPC THEN
      988     1202    2                 GOTO NOTDENS1;
      989     1203    2              IF DCT.MT.SETDENS$=ADDR(NIL) THEN
      990     1204    2   NOTDENS1:
      991     1205    2                 REQ$=DCT.SQ$->REQ.FL$;
      992     1206    2              ELSE
      993     1207    2                 REQ$=DCT.MT.SETDENS$;     /* REQ.DQH$ will always be specified */
      994     1208    3              IF REQ.DQH$=ADDR(NIL) THEN DO; /* ANY CHANNEL WILL DO */
      995     1209    4   ANOTHER_CHAN: IF SQH.CQ$=ADDR(NIL) THEN DO;
      996     1210                         %ENQUEUE (P#=DCT,Q#=SVDCT$);
      997     1213    4                    END;
      998     1214    4                 ELSE DO;
      999     1215                         %DEQUEUE (P#=DQH$,Q#=SQH.CQ$);
     1000     1222    5                    IF DQH.SCHAN$->DQH.MREC THEN DO;
     1001     1223                            %ENQUEUE (P#=DQH,Q#=SVDQH$);
     1002     1226    5                       GOTO ANOTHER_CHAN;
     1003     1227    5                       END;
     1004     1228    5                    IF DCT.MT.FREPOS$=ADDR(NIL) THEN DO;
     1005     1229                            %DEQUEUE (P#=REQ$,Q#=DCT.SQ$);
     1006     1236    5                       END;
     1007     1237    5                    ELSE DO;
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:178  
     1008     1238    5                       REQ$=DCT.MT.FREPOS$;
     1009     1239    5                       END;
     1010     1240    4                    DQH.MREC=REQ.IOFLG.MREC;
     1011     1241    4                    DQH.IO$=REQ$;
     1012     1242    4                    DCT.DQH$=DQH$;
     1013     1243    4                    DCT.STATE=%BUSY;
     1014     1244    4                    IF DCT.SQ$=ADDR(NIL) THEN
     1015     1245    4                       CALL PMN$COLLECT(DCT.PM,%PM_BUSY);
     1016     1246    4                    ELSE
     1017     1247    4                       CALL PMN$COLLECT(DCT.PM,%PM_QUED);
     1018     1248    5                    IF REQ.IOS$->NI$REQ.TAPEPOS = '0'B THEN DO;
     1019     1249    5                       REQ.IOS$->NI$REQ.TAPEPOS.CRECCNT = DCT.MT.POS.CRECCNT;
     1020     1250    5                       REQ.IOS$->NI$REQ.TAPEPOS.FILECNT = DCT.MT.POS.FILECNT;
     1021     1251    5                       END;
     1022     1252    4                    IF REQ.FC = %N_REWIND THEN
     1023     1253    4                       DCT.MT.RWC = '0'B;
     1024     1254    4                    CALL NIS$DRIVER(DQH);
     1025     1255    4                    END;
     1026     1256    3                 END;
     1027     1257    3              ELSE DO;
     1028     1258    3                 DQH$=REQ.DQH$;
     1029     1259    3                 IF DQH.STATE~=%IDLE OR
     1030     1260    4                   (REQ.IOFLG.STOPMPC AND NOT DQH.MPC$->DCT.DFLG.MPCSTOP) THEN DO;
     1031     1261    4   ENQUE_DEV:
     1032     1262                         %ENQUEUE (P#=DCT,Q#=SVDCT$);
     1033     1265    4                    END;
     1034     1266    4                 ELSE DO;
     1035     1267    5                    IF DQH.FL$~=ADDR(NIL) THEN DO;
     1036     1268    5                       IF SQH.CQ$=ADDR(NIL) THEN GOTO ENQUE_DEV;
     1037     1269    5                       T$=SQH.CQ$;
     1038     1270    6                       DO WHILE(SQH.CQ$->DQH.FL$~=DQH$);
     1039     1271    6                          SQH.CQ$=SQH.CQ$->DQH.FL$;
     1040     1272    6                          IF T$=SQH.CQ$ THEN GOTO ENQUE_DEV;
     1041     1273    6                          END;
     1042     1274                            %DEQUEUE(P#=DQH$,Q#=SQH.CQ$);
     1043     1281    5                       END;
     1044     1282    4                    IF DCT.TYPE=%DV_MPC THEN
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:179  
     1045     1283    4                       GOTO NOTDENS2;
     1046     1284    4                    IF DCT.MT.SETDENS$=ADDR(NIL) THEN
     1047     1285    4   NOTDENS2:
     1048     1286                            %DEQUEUE (P#=REQ$,Q#=DCT.SQ$);
     1049     1293    4                    DQH.MREC=REQ.IOFLG.MREC;
     1050     1294    4                    DQH.IO$=REQ$;
     1051     1295    4                    DCT.DQH$=DQH$;
     1052     1296    4                    IF REQ.IOFLG.SUSP THEN DQH.MPC$->DCT.DFLG.MPCSUSPENDED='1'B;
     1053     1297    4                    DCT.STATE=%BUSY;
     1054     1298    4                    CALL PMN$COLLECT(DCT.PM,%PM_BUSY);
     1055     1299    5                    IF REQ.IOS$->NI$REQ.TAPEPOS = '0'B THEN DO;
     1056     1300    5                       REQ.IOS$->NI$REQ.TAPEPOS.CRECCNT = DCT.MT.POS.CRECCNT;
     1057     1301    5                       REQ.IOS$->NI$REQ.TAPEPOS.FILECNT = DCT.MT.POS.FILECNT;
     1058     1302    5                       END;
     1059     1303    4                    IF REQ.FC = %N_REWIND THEN
     1060     1304    4                       DCT.MT.RWC = '0'B;
     1061     1305    4                    CALL NIS$DRIVER(DQH);
     1062     1306    4                    END;
     1063     1307    3                 END;
     1064     1308    2              END;
     1065     1309    1           SQH.AQ$=SVDCT$;
     1066     1310    2           IF SVDQH$~=ADDR(NIL) THEN DO;
     1067     1311    2              IF SQH.CQ$=ADDR(NIL) THEN SQH.CQ$=SVDQH$;
     1068     1312    3              ELSE DO;
     1069     1313    3                 DQH$=SVDQH$->DQH.FL$;
     1070     1314    3                 SVDQH$->DQH.FL$=SQH.CQ$->DQH.FL$;
     1071     1315    3                 SQH.CQ$->DQH.FL$=DQH$;
     1072     1316    3                 SQH.CQ$=SVDQH$;
     1073     1317    3                 END;
     1074     1318    2              END;
     1075     1319                %UNLOCK (G#=SQH.GATE);
     1076     1322    1           RETURN;
     1077     1323    1   END NIT$DEVSCHED;

PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:180  
--  Include file information  --

   PM$NI.:E05TOU  is referenced.
   N_FC_C.:E05TOU  is referenced.
   NI_MACROS_C.:E05TOU  cannot be made into a system file and is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure NIT$DEVSCHED.

   Procedure NIT$DEVSCHED requires 378 words for executable code.
   Procedure NIT$DEVSCHED requires 18 words of local(AUTO) storage.

    No errors detected in file NIT$TAPE.:E05TSI    .

PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:181  

 Object Unit name= NIT$DEVSCHED                               File name= NIT$TAPE.:E05TOU
 UTS= JUL 30 '97 03:39:58.28 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   378    572  NIT$DEVSCHED
    1  RoData even  none     3      3  NIT$DEVSCHED

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        2  NIT$DEVSCHED
     0     20                  yes      Std        1  NIT$REQSCHED
     0     47                  yes      Std        2  NIT$DEVSCHEDL
     0    115                  yes      Std        1  NIT$SCANAQ

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 HFC$LOCK
         yes           Std       3 PMN$COLLECT
         yes           Std       1 HFC$UNLOCK
 yes     yes           Std       2 NIM$DEQUEUE
         yes           Std       1 NIS$DRIVER
         yes           Std       2 NIM$ENQUEUE
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:182  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     N$DCT$$                               N$FQ$                                 NI$FQ$
     NI$IBUF$                              NI$RP$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:183  


      857        1        /*T***********************************************************/
      858        2        /*T*                                                         */
      859        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      860        4        /*T*                                                         */
      861        5        /*T***********************************************************/
      862        6        /*D*    ENTRY:      NIT$DEVSCHED
      863        7                            NIT$DEVSCHEDL
      864        8
      865        9                CALL:       CALL NIT$DEVSCHED(DCT,NEWSTATE);
      866       10                            CALL NIT$DEVSCHEDL(DCT,NEWSTATE);
      867       11
      868       12                ENVIRONMENT: Monitor linkage segment.  For NIT$DEVSCHEDL
      869       13                             SQH.GATE is already locked.
      870       14
      871       15                DESCRIPTION:   SQH.GATE is locked and the devices state is
      872       16                               changed to NEWSTATE.  Control then passes to
      873       17                               the SCHED code which is common to NIT$REQSCHED
      874       18                               and NIT$DEVSCHED(L).
      875       19
      876       20                               At SCHED if the device's state is IDLE and
      877       21                               there are requests pending on the device, it
      878       22                               is placed on the assign queue for the
      879       23                               subsystem and the devices state is changed
      880       24                               to requested.  Control then passes to
      881       25                               NIT$SCANAQ.
      882       26                                                                           */
      883       27        NIT$DEVSCHED: PROC (PAR, NEWSTATE);

     27  0 000000   000000 700200 xent  NIT$DEVSCHED TSX0  ! X66_AUTO_2
         0 000001   000022 000002                    ZERO    18,2

      884       28        /*
      885       29              Includes
      886       30        */
      887       31        %INCLUDE                HF_LOCK_C ;
      888       45        %INCLUDE                NI_DATA_C ;
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:184  
      889      158        %INCLUDE                NI_DATA_R ;
      890      595        %INCLUDE                NI_MACROS_C ;
      891      862        %INCLUDE                N_FC_C ;
      892      899        %INCLUDE                PM$NI ;
      893      923        /*
      894      924              Parameters
      895      925        */
      896      926    1   DCL 1 NEWSTATE        SBIN PARAM ;
      897      927    1   DCL 1 PAR             UBIN PARAM ;
      898      928        /*
      899      929              Entries
      900      930        */
      901      931    1   DCL 1 NIS$DRIVER        ENTRY(1) ;
      902      932    1   DCL 1 NIT$REPOS         ENTRY(2) ALTRET ;
      903      933    1   DCL 1 NIW$LDFWR         ENTRY(2) ALTRET ;
      904      934    1   DCL 1 PMN$COLLECT       ENTRY(3) ;
      905      935        /*
      906      936              Auto
      907      937        */
      908      938    1   DCL 1 DCT$              PTR ALIGNED AUTO ;
      909      939    1   DCL 1 DQH$              PTR ALIGNED AUTO ;
      910      940    1   DCL 1 DVT$              PTR ALIGNED AUTO ;
      911      941    1   DCL 1 I                 UBIN(36) ALIGNED AUTO ;
      912      942    1   DCL 1 J                 UBIN(36) ALIGNED AUTO ;
      913      943    1   DCL 1 LAX               UBIN(36) ALIGNED AUTO ;
      914      944    1   DCL 1 REQ$              PTR ALIGNED AUTO ;
      915      945    1   DCL 1 SQH$              PTR ALIGNED AUTO ;
      916      946    1   DCL 1 SVDCT$            PTR ALIGNED AUTO ;
      917      947    1   DCL 1 SVDQH$            PTR ALIGNED AUTO ;
      918      948    1   DCL 1 T$                PTR ALIGNED AUTO ;
      919      949        /*
      920      950              Based
      921      951        */
      922      952        %NI$DCT                 ( NAME=DCT, STCLASS="BASED(DCT$)" ) ;
      923     1000        %NI$DQH                 ( NAME=DQH, STCLASS="BASED(DQH$)" ) ;
      924     1023        %NI$DVT                 ( NAME=DVT, STCLASS="BASED(DVT$)" ) ;
      925     1030        %NI$REQ                 ( NAME=NI$REQ ) ;
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:185  
      926     1055        %N$REQ                  ( NAME=REQ, STCLASS="BASED(REQ$)" ) ;
      927     1113        %NI$SQH                 ( NAME=SQH, STCLASS="BASED(SQH$)" ) ;
      928     1126        %EJECT ;
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:186  
      929     1127    1           DCT$=ADDR(PAR);

   1127  0 000002   200003 236100                    LDQ     @PAR,,AUTO
         0 000003   200005 756100                    STQ     DCT$,,AUTO

      930     1128    1           SQH$=DCT.SQH$;

   1128  0 000004   200005 470500                    LDP0    DCT$,,AUTO
         0 000005   000022 236100                    LDQ     18,,PR0
         0 000006   200014 756100                    STQ     SQH$,,AUTO

      931     1129                %LOCK (G#=SQH.GATE);

   1130  0 000007   200014 630500                    EPPR0   SQH$,,AUTO
         0 000010   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000011   000000 701000 xent               TSX1    HFC$LOCK
         0 000012   000000 011000                    NOP     0

      932     1132    1           DCT.STATE=NEWSTATE;

   1132  0 000013   200005 470500                    LDP0    DCT$,,AUTO
         0 000014   200004 471500                    LDP1    @NEWSTATE,,AUTO
         0 000015   100000 236100                    LDQ     0,,PR1
         0 000016   000007 752101                    STCQ    7,'01'O,PR0

      933     1133    1           GOTO SCHED;

   1133  0 000017   000061 710000 0                  TRA     SCHED

      934     1134        /**/
      935     1135        %EJECT;
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:187  
      936     1136        /*D*    ENTRY:      NIT$REQSCHED
      937     1137
      938     1138                CALL:       CALL NIT$REQSCHED(N$REQ);
      939     1139
      940     1140                ENVIRONMENT: Monitor linkage segment
      941     1141
      942     1142                INPUT:      N$REQ - IOQ packet
      943     1143
      944     1144                DESCRIPTION:   NIT$REQSCHED enqueues the request on the
      945     1145                               devices scheduler queue and then goes to the
      946     1146                               common code at SCHED.
      947     1147                                                                           */
      948     1148    1   NIT$REQSCHED: ENTRY(PAR);

   1148  0 000020   000000 700200 xent  NIT$REQSCHED TSX0  ! X66_AUTO_2
         0 000021   000022 000002                    ZERO    18,2

      949     1149    1           REQ$=ADDR(PAR);

   1149  0 000022   200003 236100                    LDQ     @PAR,,AUTO
         0 000023   200013 756100                    STQ     REQ$,,AUTO

      950     1150    1           DCT$=REQ.DCT$;

   1150  0 000024   200013 470500                    LDP0    REQ$,,AUTO
         0 000025   000002 236100                    LDQ     2,,PR0
         0 000026   200005 756100                    STQ     DCT$,,AUTO

      951     1151    1           SQH$=DCT.SQH$;

   1151  0 000027   200005 471500                    LDP1    DCT$,,AUTO
         0 000030   100022 236100                    LDQ     18,,PR1
         0 000031   200014 756100                    STQ     SQH$,,AUTO

      952     1152                %LOCK (G#=SQH.GATE);

   1153  0 000032   200014 630500                    EPPR0   SQH$,,AUTO
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:188  
         0 000033   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000034   000000 701000 xent               TSX1    HFC$LOCK
         0 000035   000000 011000                    NOP     0

      953     1155                %ENQUEUE (P#=REQ,Q#=DCT.SQ$);

   1156  0 000036   200005 236100                    LDQ     DCT$,,AUTO
         0 000037   000001 036003                    ADLQ    1,DU
         0 000040   200013 235100                    LDA     REQ$,,AUTO
         0 000041   200020 757100                    STAQ    T$+1,,AUTO
         0 000042   200020 630500                    EPPR0   T$+1,,AUTO
         0 000043   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000044   000000 701000 xent               TSX1    NIM$ENQUEUE
         0 000045   000000 011000                    NOP     0

      954     1158    1           GOTO SCHED;

   1158  0 000046   000061 710000 0                  TRA     SCHED

      955     1159        %EJECT;
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:189  
      956     1160    1   NIT$DEVSCHEDL: ENTRY(PAR,NEWSTATE);

   1160  0 000047   000000 700200 xent  NIT$DEVSCHE* TSX0  ! X66_AUTO_2
         0 000050   000022 000002                    ZERO    18,2

      957     1161    1           DCT$=ADDR(PAR);

   1161  0 000051   200003 236100                    LDQ     @PAR,,AUTO
         0 000052   200005 756100                    STQ     DCT$,,AUTO

      958     1162    1           SQH$=DCT.SQH$;

   1162  0 000053   200005 470500                    LDP0    DCT$,,AUTO
         0 000054   000022 236100                    LDQ     18,,PR0
         0 000055   200014 756100                    STQ     SQH$,,AUTO

      959     1163    1           DCT.STATE=NEWSTATE;

   1163  0 000056   200004 471500                    LDP1    @NEWSTATE,,AUTO
         0 000057   100000 236100                    LDQ     0,,PR1
         0 000060   000007 752101                    STCQ    7,'01'O,PR0

      960     1164        /**/
      961     1165        /**/
      962     1166        /**/
      963     1167    1   SCHED:
      964     1168    2           IF DCT.STATE=%IDLE AND DCT.SQ$~=ADDR(NIL) THEN DO;

   1168  0 000061   200005 470500       SCHED        LDP0    DCT$,,AUTO
         0 000062   000007 236100                    LDQ     7,,PR0
         0 000063   000077 316007                    CANQ    63,DL
         0 000064   000114 601000 0                  TNZ     s:1175
         0 000065   000001 236100                    LDQ     1,,PR0
         0 000066   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000067   000114 600000 0                  TZE     s:1175

      965     1169                   %ENQUEUE (P#=DCT,Q#=SQH.AQ$);
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:190  

   1170  0 000070   200014 236100                    LDQ     SQH$,,AUTO
         0 000071   000003 036003                    ADLQ    3,DU
         0 000072   200005 235100                    LDA     DCT$,,AUTO
         0 000073   200020 757100                    STAQ    T$+1,,AUTO
         0 000074   200020 630500                    EPPR0   T$+1,,AUTO
         0 000075   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000076   000000 701000 xent               TSX1    NIM$ENQUEUE
         0 000077   000000 011000                    NOP     0

      966     1172    2              DCT.STATE=%REQUESTED;

   1172  0 000100   200005 470500                    LDP0    DCT$,,AUTO
         0 000101   000001 236007                    LDQ     1,DL
         0 000102   000007 752101                    STCQ    7,'01'O,PR0

      967     1173    2              CALL PMN$COLLECT(DCT.PM,%PM_WAIT);

   1173  0 000103   000000 236000 1                  LDQ     0
         0 000104   200021 756100                    STQ     T$+2,,AUTO
         0 000105   200005 236100                    LDQ     DCT$,,AUTO
         0 000106   000010 036003                    ADLQ    8,DU
         0 000107   200020 756100                    STQ     T$+1,,AUTO
         0 000110   200020 630500                    EPPR0   T$+1,,AUTO
         0 000111   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000112   000000 701000 xent               TSX1    PMN$COLLECT
         0 000113   000000 011000                    NOP     0

      968     1174    2              END;

      969     1175    1           GOTO SCANAQ;

   1175  0 000114   000125 710000 0                  TRA     SCANAQ

      970     1176        %EJECT;
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:191  
      971     1177        /*D*    ENTRY:      NIT$SCANAQ
      972     1178
      973     1179                CALL:       CALL NIT$SCANAQ(SQH);
      974     1180
      975     1181                DESCRIPTION:      NIT$SCANAQ scans the subsystem assign queue
      976     1182                                  to find any requests that can be started.
      977     1183                                                                           */
      978     1184    1   NIT$SCANAQ: ENTRY(PAR);

   1184  0 000115   000000 700200 xent  NIT$SCANAQ   TSX0  ! X66_AUTO_2
         0 000116   000022 000002                    ZERO    18,2

      979     1185    1           SQH$=ADDR(PAR);

   1185  0 000117   200003 236100                    LDQ     @PAR,,AUTO
         0 000120   200014 756100                    STQ     SQH$,,AUTO

      980     1186                %LOCK (G#=SQH.GATE);

   1187  0 000121   200014 630500                    EPPR0   SQH$,,AUTO
         0 000122   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000123   000000 701000 xent               TSX1    HFC$LOCK
         0 000124   000000 011000                    NOP     0

      981     1189    1   SCANAQ:
      982     1190    1           SVDCT$=ADDR(NIL);

   1190  0 000125   000001 236000 xsym  SCANAQ       LDQ     B_VECTNIL+1
         0 000126   200015 756100                    STQ     SVDCT$,,AUTO

      983     1191    1           SVDQH$=ADDR(NIL);

   1191  0 000127   200016 756100                    STQ     SVDQH$,,AUTO

      984     1192    2           DO WHILE(SQH.AQ$~=ADDR(NIL));

   1192  0 000130   000533 710000 0                  TRA     s:1308
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:192  

      985     1193                   %DEQUEUE(P#=DCT$,Q#=SQH.AQ$);

   1197  0 000131   200014 236100                    LDQ     SQH$,,AUTO
         0 000132   000003 036003                    ADLQ    3,DU
         0 000133   200021 756100                    STQ     T$+2,,AUTO
         0 000134   200005 630500                    EPPR0   DCT$,,AUTO
         0 000135   200020 450500                    STP0    T$+1,,AUTO
         0 000136   200020 630500                    EPPR0   T$+1,,AUTO
         0 000137   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000140   000000 701000 xent               TSX1    NIM$DEQUEUE
         0 000141   000000 011000                    NOP     0

      986     1200    2              DVT$=DCT.DVT$;

   1200  0 000142   200005 470500                    LDP0    DCT$,,AUTO
         0 000143   000024 236100                    LDQ     20,,PR0
         0 000144   200007 756100                    STQ     DVT$,,AUTO

      987     1201    2              IF DCT.TYPE=%DV_MPC THEN

   1201  0 000145   000007 236100                    LDQ     7,,PR0
         0 000146   007700 376007                    ANQ     4032,DL
         0 000147   000700 116007                    CMPQ    448,DL
         0 000150   000154 600000 0                  TZE     NOTDENS1

      988     1202    2                 GOTO NOTDENS1;
      989     1203    2              IF DCT.MT.SETDENS$=ADDR(NIL) THEN

   1203  0 000151   000042 236100                    LDQ     34,,PR0
         0 000152   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000153   000160 601000 0                  TNZ     s:1207

      990     1204    2   NOTDENS1:
      991     1205    2                 REQ$=DCT.SQ$->REQ.FL$;

   1205  0 000154   000001 471500       NOTDENS1     LDP1    1,,PR0
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:193  
         0 000155   100000 236100                    LDQ     0,,PR1
         0 000156   200013 756100                    STQ     REQ$,,AUTO
         0 000157   000161 710000 0                  TRA     s:1208

      992     1206    2              ELSE
      993     1207    2                 REQ$=DCT.MT.SETDENS$;     /* REQ.DQH$ will always be specified */

   1207  0 000160   200013 756100                    STQ     REQ$,,AUTO

      994     1208    3              IF REQ.DQH$=ADDR(NIL) THEN DO; /* ANY CHANNEL WILL DO */

   1208  0 000161   200013 471500                    LDP1    REQ$,,AUTO
         0 000162   100020 236100                    LDQ     16,,PR1
         0 000163   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000164   000342 601000 0                  TNZ     s:1258

      995     1209    4   ANOTHER_CHAN: IF SQH.CQ$=ADDR(NIL) THEN DO;

   1209  0 000165   200014 470500       ANOTHER_CHAN LDP0    SQH$,,AUTO
         0 000166   000004 236100                    LDQ     4,,PR0
         0 000167   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000170   000202 601000 0                  TNZ     s:1219

      996     1210                         %ENQUEUE (P#=DCT,Q#=SVDCT$);

   1211  0 000171   200015 631500                    EPPR1   SVDCT$,,AUTO
         0 000172   200021 451500                    STP1    T$+2,,AUTO
         0 000173   200005 236100                    LDQ     DCT$,,AUTO
         0 000174   200020 756100                    STQ     T$+1,,AUTO
         0 000175   200020 630500                    EPPR0   T$+1,,AUTO
         0 000176   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000177   000000 701000 xent               TSX1    NIM$ENQUEUE
         0 000200   000000 011000                    NOP     0

      997     1213    4                    END;

   1213  0 000201   000533 710000 0                  TRA     s:1308
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:194  

      998     1214    4                 ELSE DO;

      999     1215                         %DEQUEUE (P#=DQH$,Q#=SQH.CQ$);

   1219  0 000202   200014 236100                    LDQ     SQH$,,AUTO
         0 000203   000004 036003                    ADLQ    4,DU
         0 000204   200021 756100                    STQ     T$+2,,AUTO
         0 000205   200006 631500                    EPPR1   DQH$,,AUTO
         0 000206   200020 451500                    STP1    T$+1,,AUTO
         0 000207   200020 630500                    EPPR0   T$+1,,AUTO
         0 000210   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000211   000000 701000 xent               TSX1    NIM$DEQUEUE
         0 000212   000000 011000                    NOP     0

     1000     1222    5                    IF DQH.SCHAN$->DQH.MREC THEN DO;

   1222  0 000213   200006 470500                    LDP0    DQH$,,AUTO
         0 000214   000012 471500                    LDP1    10,,PR0
         0 000215   100001 234100                    SZN     1,,PR1
         0 000216   000230 605000 0                  TPL     s:1228

     1001     1223                            %ENQUEUE (P#=DQH,Q#=SVDQH$);

   1224  0 000217   200016 633500                    EPPR3   SVDQH$,,AUTO
         0 000220   200021 453500                    STP3    T$+2,,AUTO
         0 000221   200006 236100                    LDQ     DQH$,,AUTO
         0 000222   200020 756100                    STQ     T$+1,,AUTO
         0 000223   200020 630500                    EPPR0   T$+1,,AUTO
         0 000224   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000225   000000 701000 xent               TSX1    NIM$ENQUEUE
         0 000226   000000 011000                    NOP     0

     1002     1226    5                       GOTO ANOTHER_CHAN;

   1226  0 000227   000165 710000 0                  TRA     ANOTHER_CHAN

PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:195  
     1003     1227    5                       END;
     1004     1228    5                    IF DCT.MT.FREPOS$=ADDR(NIL) THEN DO;

   1228  0 000230   200005 473500                    LDP3    DCT$,,AUTO
         0 000231   300031 236100                    LDQ     25,,PR3
         0 000232   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000233   000246 601000 0                  TNZ     s:1238

     1005     1229                            %DEQUEUE (P#=REQ$,Q#=DCT.SQ$);

   1233  0 000234   200005 236100                    LDQ     DCT$,,AUTO
         0 000235   000001 036003                    ADLQ    1,DU
         0 000236   200021 756100                    STQ     T$+2,,AUTO
         0 000237   200013 631500                    EPPR1   REQ$,,AUTO
         0 000240   200020 451500                    STP1    T$+1,,AUTO
         0 000241   200020 630500                    EPPR0   T$+1,,AUTO
         0 000242   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000243   000000 701000 xent               TSX1    NIM$DEQUEUE
         0 000244   000000 011000                    NOP     0

     1006     1236    5                       END;

   1236  0 000245   000247 710000 0                  TRA     s:1240

     1007     1237    5                    ELSE DO;

     1008     1238    5                       REQ$=DCT.MT.FREPOS$;

   1238  0 000246   200013 756100                    STQ     REQ$,,AUTO

     1009     1239    5                       END;

     1010     1240    4                    DQH.MREC=REQ.IOFLG.MREC;

   1240  0 000247   200006 470500                    LDP0    DQH$,,AUTO
         0 000250   200013 471500                    LDP1    REQ$,,AUTO
         0 000251   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:196  
         0 000252   000027 736000                    QLS     23
         0 000253   000001 676100                    ERQ     1,,PR0
         0 000254   400000 376003                    ANQ     -131072,DU
         0 000255   000001 656100                    ERSQ    1,,PR0

     1011     1241    4                    DQH.IO$=REQ$;

   1241  0 000256   200013 236100                    LDQ     REQ$,,AUTO
         0 000257   200006 470500                    LDP0    DQH$,,AUTO
         0 000260   000014 756100                    STQ     12,,PR0

     1012     1242    4                    DCT.DQH$=DQH$;

   1242  0 000261   200006 236100                    LDQ     DQH$,,AUTO
         0 000262   200005 471500                    LDP1    DCT$,,AUTO
         0 000263   100023 756100                    STQ     19,,PR1

     1013     1243    4                    DCT.STATE=%BUSY;

   1243  0 000264   000005 236007                    LDQ     5,DL
         0 000265   100007 752101                    STCQ    7,'01'O,PR1

     1014     1244    4                    IF DCT.SQ$=ADDR(NIL) THEN

   1244  0 000266   100001 236100                    LDQ     1,,PR1
         0 000267   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000270   000303 601000 0                  TNZ     s:1247

     1015     1245    4                       CALL PMN$COLLECT(DCT.PM,%PM_BUSY);

   1245  0 000271   000001 236000 1                  LDQ     1
         0 000272   200021 756100                    STQ     T$+2,,AUTO
         0 000273   200005 236100                    LDQ     DCT$,,AUTO
         0 000274   000010 036003                    ADLQ    8,DU
         0 000275   200020 756100                    STQ     T$+1,,AUTO
         0 000276   200020 630500                    EPPR0   T$+1,,AUTO
         0 000277   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:197  
         0 000300   000000 701000 xent               TSX1    PMN$COLLECT
         0 000301   000000 011000                    NOP     0
         0 000302   000314 710000 0                  TRA     s:1248

     1016     1246    4                    ELSE
     1017     1247    4                       CALL PMN$COLLECT(DCT.PM,%PM_QUED);

   1247  0 000303   000002 236000 1                  LDQ     2
         0 000304   200021 756100                    STQ     T$+2,,AUTO
         0 000305   200005 236100                    LDQ     DCT$,,AUTO
         0 000306   000010 036003                    ADLQ    8,DU
         0 000307   200020 756100                    STQ     T$+1,,AUTO
         0 000310   200020 630500                    EPPR0   T$+1,,AUTO
         0 000311   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000312   000000 701000 xent               TSX1    PMN$COLLECT
         0 000313   000000 011000                    NOP     0

     1018     1248    5                    IF REQ.IOS$->NI$REQ.TAPEPOS = '0'B THEN DO;

   1248  0 000314   200013 470500                    LDP0    REQ$,,AUTO
         0 000315   000012 471500                    LDP1    10,,PR0
         0 000316   100014 235100                    LDA     12,,PR1
         0 000317   000326 601000 0                  TNZ     s:1252

     1019     1249    5                       REQ.IOS$->NI$REQ.TAPEPOS.CRECCNT = DCT.MT.POS.CRECCNT;

   1249  0 000320   200005 473500                    LDP3    DCT$,,AUTO
         0 000321   300035 720100                    LXL0    29,,PR3
         0 000322   100014 740100                    STX0    12,,PR1

     1020     1250    5                       REQ.IOS$->NI$REQ.TAPEPOS.FILECNT = DCT.MT.POS.FILECNT;

   1250  0 000323   000012 471500                    LDP1    10,,PR0
         0 000324   300037 720100                    LXL0    31,,PR3
         0 000325   100014 440100                    SXL0    12,,PR1

     1021     1251    5                       END;
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:198  

     1022     1252    4                    IF REQ.FC = %N_REWIND THEN

   1252  0 000326   000003 236100                    LDQ     3,,PR0
         0 000327   000777 376007                    ANQ     511,DL
         0 000330   000006 116007                    CMPQ    6,DL
         0 000331   000335 601000 0                  TNZ     s:1254

     1023     1253    4                       DCT.MT.RWC = '0'B;

   1253  0 000332   200005 471500                    LDP1    DCT$,,AUTO
         0 000333   000031 236000 xsym               LDQ     B_VECTNIL+25
         0 000334   100030 356100                    ANSQ    24,,PR1

     1024     1254    4                    CALL NIS$DRIVER(DQH);

   1254  0 000335   200006 630500                    EPPR0   DQH$,,AUTO
         0 000336   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000337   000000 701000 xent               TSX1    NIS$DRIVER
         0 000340   000000 011000                    NOP     0

     1025     1255    4                    END;

     1026     1256    3                 END;

   1256  0 000341   000533 710000 0                  TRA     s:1308

     1027     1257    3              ELSE DO;

     1028     1258    3                 DQH$=REQ.DQH$;

   1258  0 000342   200006 756100                    STQ     DQH$,,AUTO

     1029     1259    3                 IF DQH.STATE~=%IDLE OR

   1259  0 000343   200006 473500                    LDP3    DQH$,,AUTO
         0 000344   300001 236100                    LDQ     1,,PR3
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:199  
         0 000345   000077 316007                    CANQ    63,DL
         0 000346   000356 601000 0                  TNZ     ENQUE_DEV
         0 000347   100004 236100                    LDQ     4,,PR1
         0 000350   001000 316007                    CANQ    512,DL
         0 000351   000367 600000 0                  TZE     s:1267
         0 000352   300015 474500                    LDP4    13,,PR3
         0 000353   400006 236100                    LDQ     6,,PR4
         0 000354   001000 316007                    CANQ    512,DL
         0 000355   000367 601000 0                  TNZ     s:1267

     1030     1260    4                   (REQ.IOFLG.STOPMPC AND NOT DQH.MPC$->DCT.DFLG.MPCSTOP) THEN DO;

     1031     1261    4   ENQUE_DEV:
     1032     1262                         %ENQUEUE (P#=DCT,Q#=SVDCT$);

   1263  0 000356   200015 630500       ENQUE_DEV    EPPR0   SVDCT$,,AUTO
         0 000357   200021 450500                    STP0    T$+2,,AUTO
         0 000360   200005 236100                    LDQ     DCT$,,AUTO
         0 000361   200020 756100                    STQ     T$+1,,AUTO
         0 000362   200020 630500                    EPPR0   T$+1,,AUTO
         0 000363   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000364   000000 701000 xent               TSX1    NIM$ENQUEUE
         0 000365   000000 011000                    NOP     0

     1033     1265    4                    END;

   1265  0 000366   000533 710000 0                  TRA     s:1308

     1034     1266    4                 ELSE DO;

     1035     1267    5                    IF DQH.FL$~=ADDR(NIL) THEN DO;

   1267  0 000367   300000 236100                    LDQ     0,,PR3
         0 000370   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000371   000426 600000 0                  TZE     s:1282

     1036     1268    5                       IF SQH.CQ$=ADDR(NIL) THEN GOTO ENQUE_DEV;
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:200  

   1268  0 000372   200014 474500                    LDP4    SQH$,,AUTO
         0 000373   400004 236100                    LDQ     4,,PR4
         0 000374   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000375   000356 600000 0                  TZE     ENQUE_DEV

     1037     1269    5                       T$=SQH.CQ$;

   1269  0 000376   200017 756100                    STQ     T$,,AUTO

     1038     1270    6                       DO WHILE(SQH.CQ$->DQH.FL$~=DQH$);

   1270  0 000377   400004 475500                    LDP5    4,,PR4
         0 000400   500000 236100                    LDQ     0,,PR5
         0 000401   200006 116100                    CMPQ    DQH$,,AUTO
         0 000402   000415 600000 0                  TZE     s:1278

     1039     1271    6                          SQH.CQ$=SQH.CQ$->DQH.FL$;

   1271  0 000403   200014 470500                    LDP0    SQH$,,AUTO
         0 000404   000004 471500                    LDP1    4,,PR0
         0 000405   100000 236100                    LDQ     0,,PR1
         0 000406   000004 756100                    STQ     4,,PR0

     1040     1272    6                          IF T$=SQH.CQ$ THEN GOTO ENQUE_DEV;

   1272  0 000407   200017 116100                    CMPQ    T$,,AUTO
         0 000410   000356 600000 0                  TZE     ENQUE_DEV

     1041     1273    6                          END;

   1273  0 000411   000004 471500                    LDP1    4,,PR0
         0 000412   100000 236100                    LDQ     0,,PR1
         0 000413   200006 116100                    CMPQ    DQH$,,AUTO
         0 000414   000403 601000 0                  TNZ     s:1271

     1042     1274                            %DEQUEUE(P#=DQH$,Q#=SQH.CQ$);
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:201  

   1278  0 000415   200014 236100                    LDQ     SQH$,,AUTO
         0 000416   000004 036003                    ADLQ    4,DU
         0 000417   200021 756100                    STQ     T$+2,,AUTO
         0 000420   200006 630500                    EPPR0   DQH$,,AUTO
         0 000421   200020 450500                    STP0    T$+1,,AUTO
         0 000422   200020 630500                    EPPR0   T$+1,,AUTO
         0 000423   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000424   000000 701000 xent               TSX1    NIM$DEQUEUE
         0 000425   000000 011000                    NOP     0

     1043     1281    5                       END;

     1044     1282    4                    IF DCT.TYPE=%DV_MPC THEN

   1282  0 000426   200005 470500                    LDP0    DCT$,,AUTO
         0 000427   000007 236100                    LDQ     7,,PR0
         0 000430   007700 376007                    ANQ     4032,DL
         0 000431   000700 116007                    CMPQ    448,DL
         0 000432   000436 600000 0                  TZE     NOTDENS2

     1045     1283    4                       GOTO NOTDENS2;
     1046     1284    4                    IF DCT.MT.SETDENS$=ADDR(NIL) THEN

   1284  0 000433   000042 236100                    LDQ     34,,PR0
         0 000434   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000435   000447 601000 0                  TNZ     s:1293

     1047     1285    4   NOTDENS2:
     1048     1286                            %DEQUEUE (P#=REQ$,Q#=DCT.SQ$);

   1290  0 000436   200005 236100       NOTDENS2     LDQ     DCT$,,AUTO
         0 000437   000001 036003                    ADLQ    1,DU
         0 000440   200021 756100                    STQ     T$+2,,AUTO
         0 000441   200013 631500                    EPPR1   REQ$,,AUTO
         0 000442   200020 451500                    STP1    T$+1,,AUTO
         0 000443   200020 630500                    EPPR0   T$+1,,AUTO
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:202  
         0 000444   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000445   000000 701000 xent               TSX1    NIM$DEQUEUE
         0 000446   000000 011000                    NOP     0

     1049     1293    4                    DQH.MREC=REQ.IOFLG.MREC;

   1293  0 000447   200006 470500                    LDP0    DQH$,,AUTO
         0 000450   200013 471500                    LDP1    REQ$,,AUTO
         0 000451   100004 236100                    LDQ     4,,PR1
         0 000452   000027 736000                    QLS     23
         0 000453   000001 676100                    ERQ     1,,PR0
         0 000454   400000 376003                    ANQ     -131072,DU
         0 000455   000001 656100                    ERSQ    1,,PR0

     1050     1294    4                    DQH.IO$=REQ$;

   1294  0 000456   200013 236100                    LDQ     REQ$,,AUTO
         0 000457   200006 470500                    LDP0    DQH$,,AUTO
         0 000460   000014 756100                    STQ     12,,PR0

     1051     1295    4                    DCT.DQH$=DQH$;

   1295  0 000461   200006 236100                    LDQ     DQH$,,AUTO
         0 000462   200005 471500                    LDP1    DCT$,,AUTO
         0 000463   100023 756100                    STQ     19,,PR1

     1052     1296    4                    IF REQ.IOFLG.SUSP THEN DQH.MPC$->DCT.DFLG.MPCSUSPENDED='1'B;

   1296  0 000464   200013 473500                    LDP3    REQ$,,AUTO
         0 000465   300004 236100                    LDQ     4,,PR3
         0 000466   004000 316007                    CANQ    2048,DL
         0 000467   000473 600000 0                  TZE     s:1297

   1296  0 000470   000015 474500                    LDP4    13,,PR0
         0 000471   002000 236007                    LDQ     1024,DL
         0 000472   400006 256100                    ORSQ    6,,PR4

PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:203  
     1053     1297    4                    DCT.STATE=%BUSY;

   1297  0 000473   000005 236007                    LDQ     5,DL
         0 000474   100007 752101                    STCQ    7,'01'O,PR1

     1054     1298    4                    CALL PMN$COLLECT(DCT.PM,%PM_BUSY);

   1298  0 000475   000001 236000 1                  LDQ     1
         0 000476   200021 756100                    STQ     T$+2,,AUTO
         0 000477   200005 236100                    LDQ     DCT$,,AUTO
         0 000500   000010 036003                    ADLQ    8,DU
         0 000501   200020 756100                    STQ     T$+1,,AUTO
         0 000502   200020 630500                    EPPR0   T$+1,,AUTO
         0 000503   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000504   000000 701000 xent               TSX1    PMN$COLLECT
         0 000505   000000 011000                    NOP     0

     1055     1299    5                    IF REQ.IOS$->NI$REQ.TAPEPOS = '0'B THEN DO;

   1299  0 000506   200013 470500                    LDP0    REQ$,,AUTO
         0 000507   000012 471500                    LDP1    10,,PR0
         0 000510   100014 235100                    LDA     12,,PR1
         0 000511   000520 601000 0                  TNZ     s:1303

     1056     1300    5                       REQ.IOS$->NI$REQ.TAPEPOS.CRECCNT = DCT.MT.POS.CRECCNT;

   1300  0 000512   200005 473500                    LDP3    DCT$,,AUTO
         0 000513   300035 720100                    LXL0    29,,PR3
         0 000514   100014 740100                    STX0    12,,PR1

     1057     1301    5                       REQ.IOS$->NI$REQ.TAPEPOS.FILECNT = DCT.MT.POS.FILECNT;

   1301  0 000515   000012 471500                    LDP1    10,,PR0
         0 000516   300037 720100                    LXL0    31,,PR3
         0 000517   100014 440100                    SXL0    12,,PR1

     1058     1302    5                       END;
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:204  

     1059     1303    4                    IF REQ.FC = %N_REWIND THEN

   1303  0 000520   000003 236100                    LDQ     3,,PR0
         0 000521   000777 376007                    ANQ     511,DL
         0 000522   000006 116007                    CMPQ    6,DL
         0 000523   000527 601000 0                  TNZ     s:1305

     1060     1304    4                       DCT.MT.RWC = '0'B;

   1304  0 000524   200005 471500                    LDP1    DCT$,,AUTO
         0 000525   000031 236000 xsym               LDQ     B_VECTNIL+25
         0 000526   100030 356100                    ANSQ    24,,PR1

     1061     1305    4                    CALL NIS$DRIVER(DQH);

   1305  0 000527   200006 630500                    EPPR0   DQH$,,AUTO
         0 000530   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000531   000000 701000 xent               TSX1    NIS$DRIVER
         0 000532   000000 011000                    NOP     0

     1062     1306    4                    END;

     1063     1307    3                 END;

     1064     1308    2              END;

   1308  0 000533   200014 470500                    LDP0    SQH$,,AUTO
         0 000534   000003 236100                    LDQ     3,,PR0
         0 000535   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000536   000131 601000 0                  TNZ     s:1197

     1065     1309    1           SQH.AQ$=SVDCT$;

   1309  0 000537   200015 236100                    LDQ     SVDCT$,,AUTO
         0 000540   000003 756100                    STQ     3,,PR0

PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:205  
     1066     1310    2           IF SVDQH$~=ADDR(NIL) THEN DO;

   1310  0 000541   200016 236100                    LDQ     SVDQH$,,AUTO
         0 000542   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000543   000565 600000 0                  TZE     s:1320

     1067     1311    2              IF SQH.CQ$=ADDR(NIL) THEN SQH.CQ$=SVDQH$;

   1311  0 000544   000004 236100                    LDQ     4,,PR0
         0 000545   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000546   000552 601000 0                  TNZ     s:1313

   1311  0 000547   200016 236100                    LDQ     SVDQH$,,AUTO
         0 000550   000004 756100                    STQ     4,,PR0
         0 000551   000565 710000 0                  TRA     s:1320

     1068     1312    3              ELSE DO;

     1069     1313    3                 DQH$=SVDQH$->DQH.FL$;

   1313  0 000552   200016 471500                    LDP1    SVDQH$,,AUTO
         0 000553   100000 236100                    LDQ     0,,PR1
         0 000554   200006 756100                    STQ     DQH$,,AUTO

     1070     1314    3                 SVDQH$->DQH.FL$=SQH.CQ$->DQH.FL$;

   1314  0 000555   000004 473500                    LDP3    4,,PR0
         0 000556   300000 236100                    LDQ     0,,PR3
         0 000557   100000 756100                    STQ     0,,PR1

     1071     1315    3                 SQH.CQ$->DQH.FL$=DQH$;

   1315  0 000560   000004 471500                    LDP1    4,,PR0
         0 000561   200006 236100                    LDQ     DQH$,,AUTO
         0 000562   100000 756100                    STQ     0,,PR1

     1072     1316    3                 SQH.CQ$=SVDQH$;
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:206  

   1316  0 000563   200016 236100                    LDQ     SVDQH$,,AUTO
         0 000564   000004 756100                    STQ     4,,PR0

     1073     1317    3                 END;

     1074     1318    2              END;

     1075     1319                %UNLOCK (G#=SQH.GATE);

   1320  0 000565   200014 630500                    EPPR0   SQH$,,AUTO
         0 000566   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000567   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000570   000000 011000                    NOP     0

     1076     1322    1           RETURN;

   1322  0 000571   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   1     000   000003 006000   000004 006000   000005 006000                    ............
     1077     1323    1   END NIT$DEVSCHED;

PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:207  
--  Include file information  --

   PM$NI.:E05TOU  is referenced.
   N_FC_C.:E05TOU  is referenced.
   NI_MACROS_C.:E05TOU  cannot be made into a system file and is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure NIT$DEVSCHED.
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:208  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @NEWSTATE                  3-0-0/w PTR         r     1 @PAR
     5-0-0/w PTR         r     1 DCT$                       6-0-0/w PTR         r     1 DQH$
     7-0-0/w PTR         r     1 DVT$                      *0-0-0/w SBIN        r     1 NEWSTATE
    *0-0-0/w UBIN        r     1 PAR                       13-0-0/w PTR         r     1 REQ$
    14-0-0/w PTR         r     1 SQH$                      15-0-0/w PTR         r     1 SVDCT$
    16-0-0/w PTR         r     1 SVDQH$                    17-0-0/w PTR         r     1 T$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 N$DCT$$                    0-0-0/w PTR         r     1 N$FQ$
     0-0-0/w PTR         r     1 NI$FQ$                     0-0-0/w PTR         r     1 NI$IBUF$
     0-0-0/w PTR         r     1 NI$RP$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1332)  r     1 DCT                        0-0-0/w STRC(648)   r     1 DQH
     0-0-0/d STRC(504)   r     1 NI$REQ                     0-0-0/d STRC(1080)  r     1 REQ
     0-0-0/w STRC(252)   r     1 SQH


   Procedure NIT$DEVSCHED requires 378 words for executable code.
   Procedure NIT$DEVSCHED requires 18 words of local(AUTO) storage.
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:209  

    No errors detected in file NIT$TAPE.:E05TSI    .
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:210  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:211  
          MINI XREF LISTING

ANOTHER_CHAN
      1209**LABEL    1226--GOTO
DCT
       961**DCL      1170<>CALL     1211<>CALL     1263<>CALL
DCT.DFLG.MPCSTOP
       966**DCL      1259>>IF
DCT.DFLG.MPCSUSPENDED
       966**DCL      1296<<ASSIGN
DCT.DP
       981**DCL       988--REDEF     991--REDEF     992--REDEF     994--REDEF     994--REDEF     995--REDEF
       996--REDEF     996--REDEF
DCT.DQH$
       977**DCL      1242<<ASSIGN   1295<<ASSIGN
DCT.DVT$
       977**DCL      1200>>ASSIGN
DCT.MPC.IOCHANX
       989**DCL       989--REDEF
DCT.MT.FREPOS$
       992**DCL      1228>>IF       1238>>ASSIGN
DCT.MT.POS.CRECCNT
       993**DCL      1249>>ASSIGN   1300>>ASSIGN
DCT.MT.POS.FILECNT
       993**DCL      1250>>ASSIGN   1301>>ASSIGN
DCT.MT.RWC
       992**DCL      1253<<ASSIGN   1304<<ASSIGN
DCT.MT.SETDENS$
       993**DCL      1203>>IF       1207>>ASSIGN   1284>>IF
DCT.PM
       972**DCL      1173<>CALL     1245<>CALL     1247<>CALL     1298<>CALL
DCT.SQ$
       961**DCL      1156<>CALL     1168>>IF       1205>>ASSIGN   1233<>CALL     1244>>IF       1290<>CALL
DCT.SQH$
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:212  
       976**DCL      1128>>ASSIGN   1151>>ASSIGN   1162>>ASSIGN
DCT.STATE
       971**DCL      1132<<ASSIGN   1163<<ASSIGN   1168>>IF       1172<<ASSIGN   1243<<ASSIGN   1297<<ASSIGN
DCT.TYPE
       971**DCL      1201>>IF       1282>>IF
DCT$
       938**DCL       961--IMP-PTR  1127<<ASSIGN   1128>>ASSIGN   1132>>ASSIGN   1150<<ASSIGN   1151>>ASSIGN
      1156>>CALL     1161<<ASSIGN   1162>>ASSIGN   1163>>ASSIGN   1168>>IF       1168>>IF       1170>>CALL
      1172>>ASSIGN   1173>>CALL     1197<>CALL     1200>>ASSIGN   1201>>IF       1203>>IF       1205>>ASSIGN
      1207>>ASSIGN   1211>>CALL     1228>>IF       1233>>CALL     1238>>ASSIGN   1242>>ASSIGN   1243>>ASSIGN
      1244>>IF       1245>>CALL     1247>>CALL     1249>>ASSIGN   1250>>ASSIGN   1253>>ASSIGN   1263>>CALL
      1282>>IF       1284>>IF       1290>>CALL     1295>>ASSIGN   1297>>ASSIGN   1298>>CALL     1300>>ASSIGN
      1301>>ASSIGN   1304>>ASSIGN
DQH
      1009**DCL      1224<>CALL     1254<>CALL     1305<>CALL
DQH.FL$
      1009**DCL      1267>>IF       1270>>DOWHILE  1271>>ASSIGN   1313>>ASSIGN   1314<<ASSIGN   1314>>ASSIGN
      1315<<ASSIGN
DQH.IO$
      1016**DCL      1241<<ASSIGN   1294<<ASSIGN
DQH.IOCHANX
      1011**DCL      1012--REDEF
DQH.MBX$
      1020**DCL      1021--REDEF
DQH.MPC$
      1016**DCL      1259>>IF       1296>>ASSIGN
DQH.MREC
      1009**DCL      1222>>IF       1240<<ASSIGN   1293<<ASSIGN
DQH.SCHAN$
      1015**DCL      1222>>IF
DQH.STATE
      1013**DCL      1259>>IF
DQH$
       939**DCL      1009--IMP-PTR  1219<>CALL     1222>>IF       1224>>CALL     1240>>ASSIGN   1241>>ASSIGN
      1242>>ASSIGN   1254>>CALL     1258<<ASSIGN   1259>>IF       1259>>IF       1267>>IF       1270>>DOWHILE
      1278<>CALL     1293>>ASSIGN   1294>>ASSIGN   1295>>ASSIGN   1296>>ASSIGN   1305>>CALL     1313<<ASSIGN
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:213  
      1315>>ASSIGN
DVT.MPC
      1026**DCL      1027--REDEF
DVT$
       940**DCL      1024--IMP-PTR  1200<<ASSIGN
ENQUE_DEV
      1263**LABEL    1268--GOTO     1272--GOTO
HFC$LOCK
        44**DCL-ENT  1130--CALL     1153--CALL     1187--CALL
HFC$UNLOCK
        44**DCL-ENT  1320--CALL
N$DCT$$
       456**DCL       590--IMP-PTR
N$FQ$
       456**DCL       591--IMP-PTR
N$REQ_INIT.BUFADDR
       475**DCL       476--REDEF     476--REDEF
N$REQ_INIT.DLA.DRELADDR
       467**DCL       467--REDEF
N$REQ_INIT.DVE.EOMCHAR
       504**DCL       505--REDEF
N$REQ_INIT.EAINFO
       498**DCL       498--REDEF
N$REQ_INIT.EAINFOX
       498**DCL       499--REDEF
N$REQ_INIT.EVNTINFO
       499**DCL       499--REDEF
N$REQ_INIT.STATUS
       480**DCL       486--REDEF
NEWSTATE
       926**DCL        27--PROC     1132>>ASSIGN   1160--ENTRY    1163>>ASSIGN
NI$FQ$
       516**DCL       592--IMP-PTR
NI$IBUF$
       516**DCL       592--IMP-PTR
NI$IMXMBX_INIT.PAGED_BASE
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:214  
       526**DCL       527--REDEF     527--REDEF
NI$IMXMBX_INIT.SIZE
       528**DCL       528--REDEF
NI$REQ.DCW
      1041**DCL      1044--REDEF
NI$REQ.DCW.TALLY
      1042**DCL      1042--REDEF
NI$REQ.IDCW.EXTA
      1044**DCL      1044--REDEF
NI$REQ.PCW
      1046**DCL      1050--REDEF
NI$REQ.SEEK
      1051**DCL      1052--REDEF    1053--REDEF
NI$REQ.TAPEPOS
      1053**DCL      1248>>IF       1299>>IF
NI$REQ.TAPEPOS.CRECCNT
      1053**DCL      1249<<ASSIGN   1300<<ASSIGN
NI$REQ.TAPEPOS.FILECNT
      1053**DCL      1250<<ASSIGN   1301<<ASSIGN
NI$REQ_INIT.DCW
       550**DCL       553--REDEF
NI$REQ_INIT.DCW.TALLY
       551**DCL       551--REDEF
NI$REQ_INIT.IDCW.EXTA
       553**DCL       553--REDEF
NI$REQ_INIT.PCW
       555**DCL       559--REDEF
NI$REQ_INIT.SEEK
       560**DCL       561--REDEF     562--REDEF
NI$RP$
       564**DCL       594--IMP-PTR
NIM$DEQUEUE
       619**DCL-ENT  1197--CALL     1219--CALL     1233--CALL     1278--CALL     1290--CALL
NIM$ENQUEUE
       620**DCL-ENT  1156--CALL     1170--CALL     1211--CALL     1224--CALL     1263--CALL
NIS$DRIVER
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:215  
       931**DCL-ENT  1254--CALL     1305--CALL
NI_MBX_INIT.DCW.CONTROL.AE
       586**DCL       586--REDEF
NI_MBX_INIT.LPW.CONTROL.AE
       582**DCL       582--REDEF
NOTDENS1
      1205**LABEL    1202--GOTO
NOTDENS2
      1290**LABEL    1283--GOTO
PAR
       927**DCL        27--PROC     1127--ASSIGN   1148--ENTRY    1149--ASSIGN   1160--ENTRY    1161--ASSIGN
      1184--ENTRY    1185--ASSIGN
PMN$COLLECT
       934**DCL-ENT  1173--CALL     1245--CALL     1247--CALL     1298--CALL
REQ
      1064**DCL      1156<>CALL
REQ.BUFADDR
      1073**DCL      1074--REDEF    1074--REDEF
REQ.DCT$
      1065**DCL      1150>>ASSIGN
REQ.DLA.DRELADDR
      1065**DCL      1065--REDEF
REQ.DQH$
      1086**DCL      1208>>IF       1258>>ASSIGN
REQ.DVE.EOMCHAR
      1102**DCL      1103--REDEF
REQ.EAINFO
      1096**DCL      1096--REDEF
REQ.EAINFOX
      1096**DCL      1097--REDEF
REQ.EVNTINFO
      1097**DCL      1097--REDEF
REQ.FC
      1067**DCL      1252>>IF       1303>>IF
REQ.FL$
      1064**DCL      1205>>ASSIGN
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:216  
REQ.IOFLG.MREC
      1069**DCL      1240>>ASSIGN   1293>>ASSIGN
REQ.IOFLG.STOPMPC
      1070**DCL      1259>>IF
REQ.IOFLG.SUSP
      1069**DCL      1296>>IF
REQ.IOS$
      1077**DCL      1248>>IF       1249>>ASSIGN   1250>>ASSIGN   1299>>IF       1300>>ASSIGN   1301>>ASSIGN
REQ.STATUS
      1078**DCL      1084--REDEF
REQ$
       944**DCL      1064--IMP-PTR  1149<<ASSIGN   1150>>ASSIGN   1156>>CALL     1205<<ASSIGN   1207<<ASSIGN
      1208>>IF       1233<>CALL     1238<<ASSIGN   1240>>ASSIGN   1241>>ASSIGN   1248>>IF       1249>>ASSIGN
      1250>>ASSIGN   1252>>IF       1258>>ASSIGN   1259>>IF       1290<>CALL     1293>>ASSIGN   1294>>ASSIGN
      1296>>IF       1299>>IF       1300>>ASSIGN   1301>>ASSIGN   1303>>IF
SCANAQ
      1190**LABEL    1175--GOTO
SCHED
      1168**LABEL    1133--GOTO     1158--GOTO
SQH.AQ$
      1123**DCL      1170<>CALL     1192>>DOWHILE  1197<>CALL     1309<<ASSIGN
SQH.CQ$
      1123**DCL      1209>>IF       1219<>CALL     1268>>IF       1269>>ASSIGN   1270>>DOWHILE  1271<<ASSIGN
      1271>>ASSIGN   1272>>IF       1278<>CALL     1311>>IF       1311<<ASSIGN   1314>>ASSIGN   1315>>ASSIGN
      1316<<ASSIGN
SQH.DOOR
      1122**DCL      1122--REDEF
SQH.GATE
      1122**DCL      1130<>CALL     1153<>CALL     1187<>CALL     1320<>CALL
SQH$
       945**DCL      1122--IMP-PTR  1128<<ASSIGN   1130>>CALL     1151<<ASSIGN   1153>>CALL     1162<<ASSIGN
      1170>>CALL     1185<<ASSIGN   1187>>CALL     1192>>DOWHILE  1197>>CALL     1209>>IF       1219>>CALL
      1268>>IF       1269>>ASSIGN   1270>>DOWHILE  1271>>ASSIGN   1271>>ASSIGN   1272>>IF       1278>>CALL
      1309>>ASSIGN   1311>>IF       1311>>ASSIGN   1314>>ASSIGN   1315>>ASSIGN   1316>>ASSIGN   1320>>CALL
SVDCT$
       946**DCL      1190<<ASSIGN   1211<>CALL     1263<>CALL     1309>>ASSIGN
PL6.E3A0      #002=NIT$DEVSCHED File=NIT$TAPE.:E05TSI                            WED 07/30/97 03:39 Page:217  
SVDQH$
       947**DCL      1191<<ASSIGN   1224<>CALL     1310>>IF       1311>>ASSIGN   1313>>ASSIGN   1314>>ASSIGN
      1316>>ASSIGN
T$
       948**DCL      1269<<ASSIGN   1272>>IF
