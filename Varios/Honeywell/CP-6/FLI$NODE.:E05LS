VERSION E05

PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:1    
        1        1        /*M* FLI$NODE - node interpreting routines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* THI=1,PLM=3 */
        8        8        FLI$NODE_TAPE_OD: PROC( NODE$ ) ALTRET;
        9        9        /*F*  NAME: FLI$NODE_TAPE_OD
       10       10              PURPOSE: Interpret TAPE_DEST,OD_DEST,TAPE_SOURCE,OD_SOURCE nodes.
       11       11        */
       12       12
       13       13    1   DCL NODE$ PTR ALIGNED;                  /* To TAPE_DEST node                  */
       14       14
       15       15         /***
       16       16          *** INCLUDE
       17       17          ***/
       18       18
       19       19        %INCLUDE CP_6;
       20     5578        %INCLUDE FLE_DATA_R;
       21    11529        %INCLUDE FLI_DATA_R;
       22    12943        %INCLUDE XU_MACRO_C;
       23    16049        %INCLUDE CP_6_SUBS;
       24    16589
       25    16590         /***
       26    16591          *** ENTRY
       27    16592          ***/
       28    16593
       29    16594    1   DCL FLI$RPT_ERR ENTRY(5);
       30    16595    1   DCL FLI$USE_SNLIST_NODE ENTRY(1) ALTRET;
       31    16596
       32    16597         /***
       33    16598          *** AUTO
       34    16599          ***/
       35    16600
       36    16601    1   DCL NODEX SBIN AUTO;
       37    16602    1   DCL SUBNODEX SBIN AUTO;
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:2    
       38    16603    1   DCL SUBLK$ PTR AUTO;
       39    16604    1   DCL SUBNODE$ PTR AUTO;
       40    16605    1   DCL TEMP SBIN AUTO;
       41    16606
       42    16607         /***
       43    16608          *** BASED
       44    16609          ***/
       45    16610
       46    16611        %PARSE$OUT( STCLASS="BASED(NODE$)" );
       47    16656        %PARSE$SYM( STCLASS=BASED );
       48    16694    1   DCL 1 TEXTC BASED CALIGNED,
       49    16695    1         2 L UBIN BYTE CALIGNED,
       50    16696    1         2 C CHAR(TEXTC.L);
       51    16697
       52    16698        /****************************************/
       53    16699
       54    16700         /***
       55    16701          *** Set up defaults.
       56    16702          ***/
       57    16703
       58    16704    1      TAPE_OPEN.V.OPER.MNTONLY# = %NO#;
       59    16705    1      TAPE_OPEN.V.DENSITY# = 0;
       60    16706    1      TAPE_OPEN.V.EXPIRE# = %NEVER#;
       61    16707    1      TAPE_OPEN.V.XTEND# = '0'B;
       62    16708    1      TAPE_OPEN.V.VOLACCESS# = 0;
       63    16709    1      TAPE_OPEN.V.FSN# = 0;
       64    16710    1      TAPE_OPEN.V.RES# = 'LT';
       65    16711    1      LAST_TAPE_FSN = 9999;
       66    16712    1      TAPE_OPEN.NAME_ = VECTOR(ERASE);
       67    16713    1      TAPE_OPEN.V.INITZ.SCRUB# = %YES#;
       68    16714    1      TAPE_OPEN.IFPARAM_ = VECTOR(NIL);
       69    16715    1      TAPE_OPEN.FPARAM_ = VECTOR(NIL);
       70    16716    1      TAPE_OPEN.V.VOL# = 1;
       71    16717    1      TAPE_OPEN.V.IOERROK# = '0'B;
       72    16718    1      TAPE_OPEN.V.BLKL# = DEFAULT_GRANS_PER_TAPE_BUF * 4096;
       73    16719    1      NBR_GRANS_PER_TAPE_BUF = DEFAULT_GRANS_PER_TAPE_BUF;
       74    16720    1      CT_IMAGE = ' ';                      /* Assume not "controlled" tapeset    */
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:3    
       75    16721
       76    16722    2      DO CASE( OUT$BLK.CODE );
       77    16723    2       CASE( %TAPE_DEST );                 /* Destination => output              */
       78    16724    2         TAPE_OPEN.V.RES# = 'LT';
       79    16725    2         TAPE_OPEN.V.FUN# = %CREATE#;
       80    16726    2         TAPE_OPEN.V.CVOL# = %YES#;
       81    16727    2         TAPE_OPEN.V.ASN# = %TAPE#;
       82    16728    2       CASE( %TAPE_SOURCE );               /* Source => input                    */
       83    16729    2         TAPE_OPEN.V.RES# = 'LT';
       84    16730    2         TAPE_OPEN.V.FUN# = %IN#;
       85    16731    2         TAPE_OPEN.V.CVOL# = %NO#;
       86    16732    2         TAPE_OPEN.V.ASN# = %TAPE#;
       87    16733    2       CASE( %OD_DEST );                   /* Destination => output              */
       88    16734    2         TAPE_OPEN.V.RES# = 'OD';
       89    16735    2         TAPE_OPEN.V.FUN# = %CREATE#;
       90    16736    2         TAPE_OPEN.V.CVOL# = %NO#;
       91    16737    2         TAPE_OPEN.V.ASN# = %FILE#;
       92    16738    2         LAST_TAPE_FSN = 262143;
       93    16739    2       CASE( %OD_SOURCE );                 /* Source => input                    */
       94    16740    2         TAPE_OPEN.V.RES# = 'OD';
       95    16741    2         TAPE_OPEN.V.FUN# = %IN#;
       96    16742    2         TAPE_OPEN.V.CVOL# = %NO#;
       97    16743    2         TAPE_OPEN.V.ASN# = %FILE#;
       98    16744    2         LAST_TAPE_FSN = 262143;
       99    16745    2       CASE( ELSE );                       /* Bad node passed by caller          */
      100    16746    2         CALL M$XXX;
      101    16747    2       END;
      102    16748
      103    16749         /***
      104    16750          *** Interpret nodes.
      105    16751          ***/
      106    16752
      107    16753    2      DO NODEX=0 TO OUT$BLK.NSUBLKS-1;
      108    16754    2         SUBLK$ = OUT$BLK.SUBLK$(NODEX);
      109    16755    3         DO CASE( SUBLK$->OUT$BLK.CODE );
      110    16756
      111    16757    3          CASE( %TAPE_SET, %OD_SET );
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:4    
      112    16758    3            CALL FLI_MULTI_SET ALTRET( JUSTALT );
      113    16759
      114    16760    3          CASE( %TAPE_OPTIONS,%REBUILD_TAPE_OPTIONS );
      115    16761    4            DO SUBNODEX = 0 TO SUBLK$->OUT$BLK.NSUBLKS - 1;
      116    16762    4               SUBNODE$ = SUBLK$->OUT$BLK.SUBLK$(SUBNODEX);
      117    16763
      118    16764    5               DO CASE( SUBNODE$->OUT$BLK.CODE );
      119    16765
      120    16766    5                CASE( %DENSITY );
      121    16767    5                  TAPE_OPEN.V.DENSITY# = SUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
      122    16768    5                  TAPE_OPTION.DENSITY = '1'B;
      123    16769
      124    16770    5                CASE( %VOLACCESS );
      125    16771    5                  TAPE_OPEN.V.VOLACCESS# = SUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
      126    16772    5                  TAPE_OPTION.VOLACCESS = '1'B;
      127    16773
      128    16774    5                CASE( %EXPIRE );
      129    16775    5                  IF SUBNODE$->OUT$BLK.NSUBLKS = 0
      130    16776    5                   THEN TAPE_OPEN.V.EXPIRE# = %NEVER#;
      131    16777    6                   ELSE DO;
      132    16778    6                     CALL CHARBIN( TAPE_OPEN.V.EXPIRE#,
      133    16779    6                       SUBNODE$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT );
      134    16780    6                     END;
      135    16781    5                  TAPE_OPTION.EXPIRE = '1'B;
      136    16782
      137    16783    5                CASE( %BLOCK );
      138    16784    5                  CALL CHARBIN( NBR_GRANS_PER_TAPE_BUF, SUBNODE$->OUT$BLK.SUBLK$(0)->
             16784                           OUT$SYM.TEXT );
      139    16785    5                  TAPE_OPEN.V.BLKL# = NBR_GRANS_PER_TAPE_BUF * 4096;
      140    16786    5                  TAPE_OPTION.BLOCK = '1'B;
      141    16787    5                  IF NBR_GRANS_PER_TAPE_BUF > ( 99999 / ( 4096 * 9 / 8 ) )
      142    16788    6                   THEN DO; /* 99999 is ANS limit, 4096 binary block size,
      143    16789                           9 / 8 conversion factor from binary to ASCII */
      144    16790    6                     CALL FLI$RPT_ERR ( E_BLOCK_LIMIT );
      145    16791    6                     COMMAND_ERROR = '1'B;
      146    16792    6                     END;
      147    16793
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:5    
      148    16794    5                CASE( %EXTEND );
      149    16795    5                  TAPE_OPEN.V.XTEND# = %YES#;
      150    16796
      151    16797    5                CASE( %VOL );
      152    16798    5                  CALL CHARBIN( TEMP,
      153    16799    5                    SUBNODE$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT );
      154    16800    5                  TAPE_OPEN.V.VOL# = TEMP;
      155    16801
      156    16802    5                CASE( %FSN );
      157    16803    5                  CALL CHARBIN( TEMP,
      158    16804    5                    SUBNODE$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT );
      159    16805    5                  TAPE_OPEN.V.FSN# = TEMP;
      160    16806    5                  IF SUBNODE$->OUT$BLK.NSUBLKS <= 1
      161    16807    5                   THEN LAST_TAPE_FSN = TEMP;
      162    16808    5                   ELSE CALL CHARBIN( LAST_TAPE_FSN, SUBNODE$->OUT$BLK.SUBLK$(1)->
             16808                            OUT$SYM.TEXT );
      163    16809    5                  IF TAPE_OPEN.V.FSN# > LAST_TAPE_FSN
      164    16810    6                   THEN DO;
      165    16811    6                     COMMAND_ERROR = '1'B;
      166    16812    6                     CALL FLI$RPT_ERR( E_BAD_FSN_RANGE, );
      167    16813    6                     END;
      168    16814
      169    16815    5                CASE( %LEA_TAPE );
      170    16816    5                  DISK_OPTION.LEA = '1'B;
      171    16817
      172    16818    5                CASE( %RING );
      173    16819    5                  TAPE_OPEN.V.FUN# = %CREATE#;
      174    16820
      175    16821    5                CASE( %NORING );
      176    16822    5                  TAPE_OPEN.V.FUN# = %IN#;
      177    16823
      178    16824    5                CASE( %TAPE_CHECK );
      179    16825    5                  TAPE_OPTION.CHECK = '1'B;
      180    16826    5                  TAPE_OPTION.CHECK_SPECD = '1'B;
      181    16827
      182    16828    5                CASE( %TAPE_CHECKN );
      183    16829    5                  TAPE_OPTION.CHECK = '0'B;
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:6    
      184    16830    5                  TAPE_OPTION.CHECK_SPECD = '1'B;
      185    16831
      186    16832
      187    16833    5                CASE( %PROTTYPE );
      188    16834    5                  TAPE_OPTION.PROTTYPE = SUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
      189    16835
      190    16836    5                CASE( %TAPE_DIR );
      191    16837    5                  DISK_OPTION.DIR = '1'B;
      192    16838
      193    16839    5                CASE( %NPAD );
      194    16840    5                  TAPE_OPTION.NPAD = '1'B;
      195    16841
      196    16842    5                CASE( %IOERRORCY );
      197    16843    5                  TAPE_OPTION.IOERRORC = '1'B;
      198    16844    5                  TAPE_OPTION.IOERRORC_SPECD = '1'B;
      199    16845    5                  TAPE_OPEN.V.IOERROK# = '1'B;
      200    16846
      201    16847    5                CASE( %IOERRORCN );
      202    16848    5                  TAPE_OPTION.IOERRORC = '0'B;
      203    16849    5                  TAPE_OPTION.IOERRORC_SPECD = '1'B;
      204    16850    5                  TAPE_OPEN.V.IOERROK# = '0'B;
      205    16851    5                CASE( %DUPLICATE_TAPESET );
      206    16852    5                  TAPE_OPTION.DUPLICATE_TAPESET = '1'B;
      207    16853
      208    16854    5                END;
      209    16855    4               END;
      210    16856
      211    16857    3          CASE( %EXTND );
      212    16858    3            TAPE_OPEN.V.XTEND# = %YES#;
      213    16859
      214    16860    3          END;
      215    16861    2         END;
      216    16862    1      RETURN;
      217    16863
      218    16864    1   JUSTALT: ;
      219    16865    1      ALTRETURN;
      220    16866
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:7    
      221    16867        /****************************************/
      222    16868    1   FLI_MULTI_SET: PROC ALTRET;
      223    16869        /*F*  NAME: FLI_MULTI_SET
      224    16870              PURPOSE: Process MULTI_SET node.
      225    16871        */
      226    16872
      227    16873         /***
      228    16874          *** AUTO
      229    16875          ***/
      230    16876
      231    16877    2   DCL I SBIN AUTO;
      232    16878    2   DCL TEMP SBIN AUTO;
      233    16879
      234    16880         /***
      235    16881          *** BASED
      236    16882          ***/
      237    16883
      238    16884    2   DCL CTSN CHAR(6) AUTO;
      239    16885    2   DCL 1 CTSNCHARS REDEF CTSN,
      240    16886    2         2 XXXX CHAR(4),
      241    16887    2         2 N1 UBIN BYTE CALIGNED,
      242    16888    2         2 N2 UBIN BYTE CALIGNED;
      243    16889
      244    16890        /****************************************/
      245    16891
      246    16892    3      DO SUBNODEX=0 TO SUBLK$->OUT$BLK.NSUBLKS-1;
      247    16893    3         SUBNODE$ = SUBLK$->OUT$BLK.SUBLK$(SUBNODEX);
      248    16894    3         CALL FLI$USE_SNLIST_NODE( SUBNODE$ ) ALTRET( JUSTALT );
      249    16895    3         END;
      250    16896    2      RETURN;
      251    16897
      252    16898    2   JUSTALT: ;
      253    16899    2      ALTRETURN;
      254    16900
      255    16901    2   END FLI_MULTI_SET;
      256    16902
      257    16903    1   END FLI$NODE_TAPE_OD;
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:8    
      258    16904        %EOD;

PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:9    
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FL_PERR_C.:E05TOU  is referenced.
   FLE_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLI$NODE_TAPE_OD.

   Procedure FLI$NODE_TAPE_OD requires 393 words for executable code.
   Procedure FLI$NODE_TAPE_OD requires 18 words of local(AUTO) storage.

PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:10   

 Object Unit name= FLI$NODE_TAPE_OD                           File name= FLI$NODE.:E05TOU
 UTS= JUL 29 '97 15:52:02.16 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$PRE_RET
    2   Data  even  none     6      6  FLI$NODE_TAPE_OD
    3  RoData even  UTS      2      2  FLI$NODE_TAPE_OD
    4   Proc  even  none   393    611  FLI$NODE_TAPE_OD
    5  RoData even  none    12     14  FLI$NODE_TAPE_OD

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        1  FLI$NODE_TAPE_OD

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       5 FLI$RPT_ERR
 yes     yes           Std       1 FLI$USE_SNLIST_NODE
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:11   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    E_BAD_FSN_RANGE                  r    E_BLOCK_LIMIT
     TAPE_DCBLIST$                         TAPE_OPEN                             SNVECLIST$
     COMMAND_ERROR                         NBR_GRANS_PER_TAPE_BUF                DEFAULT_GRANS_PER_TAPE_BUF
     DPLIST$                               DPRESLIST$                            DISK_FILE_SPEC$
     SPECCHARS                             DISK_OPTION                           LAST_TAPE_FSN
     EFTWORD                               TAPE_OPTION                           CT_IMAGE
     M$PRE_RET                             RET_CMDS_NAME                         B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:12   


        1        1        /*M* FLI$NODE - node interpreting routines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* THI=1,PLM=3 */
        8        8        FLI$NODE_TAPE_OD: PROC( NODE$ ) ALTRET;

      8  4 000000   000000 700200 xent  FLI$NODE_TA* TSX0  ! X66_AUTO_1
         4 000001   000022 000001                    ZERO    18,1

        9        9        /*F*  NAME: FLI$NODE_TAPE_OD
       10       10              PURPOSE: Interpret TAPE_DEST,OD_DEST,TAPE_SOURCE,OD_SOURCE nodes.
       11       11        */
       12       12
       13       13    1   DCL NODE$ PTR ALIGNED;                  /* To TAPE_DEST node                  */
       14       14
       15       15         /***
       16       16          *** INCLUDE
       17       17          ***/
       18       18
       19       19        %INCLUDE CP_6;
       20     5578        %INCLUDE FLE_DATA_R;
       21    11529        %INCLUDE FLI_DATA_R;
       22    12943        %INCLUDE XU_MACRO_C;
       23    16049        %INCLUDE CP_6_SUBS;
       24    16589
       25    16590         /***
       26    16591          *** ENTRY
       27    16592          ***/
       28    16593
       29    16594    1   DCL FLI$RPT_ERR ENTRY(5);
       30    16595    1   DCL FLI$USE_SNLIST_NODE ENTRY(1) ALTRET;
       31    16596
       32    16597         /***
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:13   
       33    16598          *** AUTO
       34    16599          ***/
       35    16600
       36    16601    1   DCL NODEX SBIN AUTO;
       37    16602    1   DCL SUBNODEX SBIN AUTO;
       38    16603    1   DCL SUBLK$ PTR AUTO;
       39    16604    1   DCL SUBNODE$ PTR AUTO;
       40    16605    1   DCL TEMP SBIN AUTO;
       41    16606
       42    16607         /***
       43    16608          *** BASED
       44    16609          ***/
       45    16610
       46    16611        %PARSE$OUT( STCLASS="BASED(NODE$)" );
       47    16656        %PARSE$SYM( STCLASS=BASED );
       48    16694    1   DCL 1 TEXTC BASED CALIGNED,
       49    16695    1         2 L UBIN BYTE CALIGNED,
       50    16696    1         2 C CHAR(TEXTC.L);
       51    16697
       52    16698        /****************************************/
       53    16699
       54    16700         /***
       55    16701          *** Set up defaults.
       56    16702          ***/
       57    16703
       58    16704    1      TAPE_OPEN.V.OPER.MNTONLY# = %NO#;

  16704  4 000002   000000 236000 5                  LDQ     0
         4 000003   000044 356000 xsym               ANSQ    TAPE_OPEN+36

       59    16705    1      TAPE_OPEN.V.DENSITY# = 0;

  16705  4 000004   000000 236003                    LDQ     0,DU
         4 000005   000066 552004 xsym               STBQ    TAPE_OPEN+54,'04'O

       60    16706    1      TAPE_OPEN.V.EXPIRE# = %NEVER#;

PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:14   
  16706  4 000006   000001 335007                    LCA     1,DL
         4 000007   000057 755000 xsym               STA     TAPE_OPEN+47

       61    16707    1      TAPE_OPEN.V.XTEND# = '0'B;

  16707  4 000010   000001 236000 5                  LDQ     1
         4 000011   000060 356000 xsym               ANSQ    TAPE_OPEN+48

       62    16708    1      TAPE_OPEN.V.VOLACCESS# = 0;

  16708  4 000012   000002 236000 5                  LDQ     2
         4 000013   000063 356000 xsym               ANSQ    TAPE_OPEN+51

       63    16709    1      TAPE_OPEN.V.FSN# = 0;

  16709  4 000014   000000 220003                    LDX0    0,DU
         4 000015   000066 740000 xsym               STX0    TAPE_OPEN+54

       64    16710    1      TAPE_OPEN.V.RES# = 'LT';

  16710  4 000016   000000 236000 3                  LDQ     0
         4 000017   777777 376003                    ANQ     -1,DU
         4 000020   040040 276007                    ORQ     16416,DL
         4 000021   000050 756000 xsym               STQ     TAPE_OPEN+40

       65    16711    1      LAST_TAPE_FSN = 9999;

  16711  4 000022   023417 235007                    LDA     9999,DL
         4 000023   000000 755000 xsym               STA     LAST_TAPE_FSN

       66    16712    1      TAPE_OPEN.NAME_ = VECTOR(ERASE);

  16712  4 000024   000004 237000 5                  LDAQ    4
         4 000025   000006 757000 xsym               STAQ    TAPE_OPEN+6

       67    16713    1      TAPE_OPEN.V.INITZ.SCRUB# = %YES#;

PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:15   
  16713  4 000026   400000 236007                    LDQ     -131072,DL
         4 000027   000044 256000 xsym               ORSQ    TAPE_OPEN+36

       68    16714    1      TAPE_OPEN.IFPARAM_ = VECTOR(NIL);

  16714  4 000030   000006 237000 5                  LDAQ    6
         4 000031   000026 757000 xsym               STAQ    TAPE_OPEN+22

       69    16715    1      TAPE_OPEN.FPARAM_ = VECTOR(NIL);

  16715  4 000032   000006 237000 5                  LDAQ    6
         4 000033   000030 757000 xsym               STAQ    TAPE_OPEN+24

       70    16716    1      TAPE_OPEN.V.VOL# = 1;

  16716  4 000034   001000 236003                    LDQ     512,DU
         4 000035   000061 552040 xsym               STBQ    TAPE_OPEN+49,'40'O

       71    16717    1      TAPE_OPEN.V.IOERROK# = '0'B;

  16717  4 000036   000003 236000 5                  LDQ     3
         4 000037   000060 356000 xsym               ANSQ    TAPE_OPEN+48

       72    16718    1      TAPE_OPEN.V.BLKL# = DEFAULT_GRANS_PER_TAPE_BUF * 4096;

  16718  4 000040   000000 235000 xsym               LDA     DEFAULT_GRANS_PER_TAPE_BUF
         4 000041   000014 735000                    ALS     12
         4 000042   000000 621005                    EAX1    0,AL
         4 000043   000052 741000 xsym               STX1    TAPE_OPEN+42

       73    16719    1      NBR_GRANS_PER_TAPE_BUF = DEFAULT_GRANS_PER_TAPE_BUF;

  16719  4 000044   000000 235000 xsym               LDA     DEFAULT_GRANS_PER_TAPE_BUF
         4 000045   000000 755000 xsym               STA     NBR_GRANS_PER_TAPE_BUF

       74    16720    1      CT_IMAGE = ' ';                      /* Assume not "controlled" tapeset    */

PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:16   
  16720  4 000046   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000047   000000 756000 xsym               STQ     CT_IMAGE

       75    16721
       76    16722    2      DO CASE( OUT$BLK.CODE );

  16722  4 000050   200003 470500                    LDP0    @NODE$,,AUTO
         4 000051   000000 471500                    LDP1    0,,PR0
         4 000052   100000 722100                    LXL2    0,,PR1
         4 000053   000026 102003                    CMPX2   22,DU
         4 000054   000056 602012 4                  TNC     s:16722+6,X2
         4 000055   000166 710000 4                  TRA     s:16746
         4 000056   000166 710000 4                  TRA     s:16746
         4 000057   000166 710000 4                  TRA     s:16746
         4 000060   000166 710000 4                  TRA     s:16746
         4 000061   000104 710000 4                  TRA     s:16724
         4 000062   000121 710000 4                  TRA     s:16729
         4 000063   000166 710000 4                  TRA     s:16746
         4 000064   000166 710000 4                  TRA     s:16746
         4 000065   000166 710000 4                  TRA     s:16746
         4 000066   000166 710000 4                  TRA     s:16746
         4 000067   000166 710000 4                  TRA     s:16746
         4 000070   000166 710000 4                  TRA     s:16746
         4 000071   000166 710000 4                  TRA     s:16746
         4 000072   000166 710000 4                  TRA     s:16746
         4 000073   000166 710000 4                  TRA     s:16746
         4 000074   000166 710000 4                  TRA     s:16746
         4 000075   000166 710000 4                  TRA     s:16746
         4 000076   000134 710000 4                  TRA     s:16734
         4 000077   000166 710000 4                  TRA     s:16746
         4 000100   000166 710000 4                  TRA     s:16746
         4 000101   000166 710000 4                  TRA     s:16746
         4 000102   000166 710000 4                  TRA     s:16746
         4 000103   000151 710000 4                  TRA     s:16740

       77    16723    2       CASE( %TAPE_DEST );                 /* Destination => output              */

PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:17   
       78    16724    2         TAPE_OPEN.V.RES# = 'LT';

  16724  4 000104   000000 236000 3                  LDQ     0
         4 000105   777777 376003                    ANQ     -1,DU
         4 000106   040040 276007                    ORQ     16416,DL
         4 000107   000050 756000 xsym               STQ     TAPE_OPEN+40

       79    16725    2         TAPE_OPEN.V.FUN# = %CREATE#;

  16725  4 000110   003000 236007                    LDQ     1536,DL
         4 000111   000045 552010 xsym               STBQ    TAPE_OPEN+37,'10'O

       80    16726    2         TAPE_OPEN.V.CVOL# = %YES#;

  16726  4 000112   000044 236000 xsym               LDQ     TAPE_OPEN+36
         4 000113   000010 376000 5                  ANQ     8
         4 000114   000004 276007                    ORQ     4,DL
         4 000115   000044 756000 xsym               STQ     TAPE_OPEN+36

       81    16727    2         TAPE_OPEN.V.ASN# = %TAPE#;

  16727  4 000116   000002 236007                    LDQ     2,DL
         4 000117   000045 552004 xsym               STBQ    TAPE_OPEN+37,'04'O
         4 000120   000170 710000 4                  TRA     s:16753

       82    16728    2       CASE( %TAPE_SOURCE );               /* Source => input                    */

       83    16729    2         TAPE_OPEN.V.RES# = 'LT';

  16729  4 000121   000000 236000 3                  LDQ     0
         4 000122   777777 376003                    ANQ     -1,DU
         4 000123   040040 276007                    ORQ     16416,DL
         4 000124   000050 756000 xsym               STQ     TAPE_OPEN+40

       84    16730    2         TAPE_OPEN.V.FUN# = %IN#;

  16730  4 000125   002000 236007                    LDQ     1024,DL
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:18   
         4 000126   000045 552010 xsym               STBQ    TAPE_OPEN+37,'10'O

       85    16731    2         TAPE_OPEN.V.CVOL# = %NO#;

  16731  4 000127   000010 236000 5                  LDQ     8
         4 000130   000044 356000 xsym               ANSQ    TAPE_OPEN+36

       86    16732    2         TAPE_OPEN.V.ASN# = %TAPE#;

  16732  4 000131   000002 236007                    LDQ     2,DL
         4 000132   000045 552004 xsym               STBQ    TAPE_OPEN+37,'04'O
         4 000133   000170 710000 4                  TRA     s:16753

       87    16733    2       CASE( %OD_DEST );                   /* Destination => output              */

       88    16734    2         TAPE_OPEN.V.RES# = 'OD';

  16734  4 000134   000001 236000 3                  LDQ     1
         4 000135   777777 376003                    ANQ     -1,DU
         4 000136   040040 276007                    ORQ     16416,DL
         4 000137   000050 756000 xsym               STQ     TAPE_OPEN+40

       89    16735    2         TAPE_OPEN.V.FUN# = %CREATE#;

  16735  4 000140   003000 236007                    LDQ     1536,DL
         4 000141   000045 552010 xsym               STBQ    TAPE_OPEN+37,'10'O

       90    16736    2         TAPE_OPEN.V.CVOL# = %NO#;

  16736  4 000142   000010 236000 5                  LDQ     8
         4 000143   000044 356000 xsym               ANSQ    TAPE_OPEN+36

       91    16737    2         TAPE_OPEN.V.ASN# = %FILE#;

  16737  4 000144   000001 236007                    LDQ     1,DL
         4 000145   000045 552004 xsym               STBQ    TAPE_OPEN+37,'04'O

PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:19   
       92    16738    2         LAST_TAPE_FSN = 262143;

  16738  4 000146   777777 235007                    LDA     -1,DL
         4 000147   000000 755000 xsym               STA     LAST_TAPE_FSN
         4 000150   000170 710000 4                  TRA     s:16753

       93    16739    2       CASE( %OD_SOURCE );                 /* Source => input                    */

       94    16740    2         TAPE_OPEN.V.RES# = 'OD';

  16740  4 000151   000001 236000 3                  LDQ     1
         4 000152   777777 376003                    ANQ     -1,DU
         4 000153   040040 276007                    ORQ     16416,DL
         4 000154   000050 756000 xsym               STQ     TAPE_OPEN+40

       95    16741    2         TAPE_OPEN.V.FUN# = %IN#;

  16741  4 000155   002000 236007                    LDQ     1024,DL
         4 000156   000045 552010 xsym               STBQ    TAPE_OPEN+37,'10'O

       96    16742    2         TAPE_OPEN.V.CVOL# = %NO#;

  16742  4 000157   000010 236000 5                  LDQ     8
         4 000160   000044 356000 xsym               ANSQ    TAPE_OPEN+36

       97    16743    2         TAPE_OPEN.V.ASN# = %FILE#;

  16743  4 000161   000001 236007                    LDQ     1,DL
         4 000162   000045 552004 xsym               STBQ    TAPE_OPEN+37,'04'O

       98    16744    2         LAST_TAPE_FSN = 262143;

  16744  4 000163   777777 235007                    LDA     -1,DL
         4 000164   000000 755000 xsym               STA     LAST_TAPE_FSN
         4 000165   000170 710000 4                  TRA     s:16753

       99    16745    2       CASE( ELSE );                       /* Bad node passed by caller          */
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:20   

      100    16746    2         CALL M$XXX;

  16746  4 000166   000003 713400                    CLIMB   3
         4 000167   000000 401760                    pmme    nvectors=0

      101    16747    2       END;

      102    16748
      103    16749         /***
      104    16750          *** Interpret nodes.
      105    16751          ***/
      106    16752
      107    16753    2      DO NODEX=0 TO OUT$BLK.NSUBLKS-1;

  16753  4 000170   200004 450100                    STZ     NODEX,,AUTO
         4 000171   000552 710000 4                  TRA     s:16861+1

      108    16754    2         SUBLK$ = OUT$BLK.SUBLK$(NODEX);

  16754  4 000172   200003 470500                    LDP0    @NODE$,,AUTO
         4 000173   000000 471500                    LDP1    0,,PR0
         4 000174   200004 720100                    LXL0    NODEX,,AUTO
         4 000175   100003 236110                    LDQ     3,X0,PR1
         4 000176   200006 756100                    STQ     SUBLK$,,AUTO

      109    16755    3         DO CASE( SUBLK$->OUT$BLK.CODE );

  16755  4 000177   200006 473500                    LDP3    SUBLK$,,AUTO
         4 000200   300000 721100                    LXL1    0,,PR3
         4 000201   000022 101003                    CMPX1   18,DU
         4 000202   000204 602011 4                  TNC     s:16755+5,X1
         4 000203   000551 710000 4                  TRA     s:16861
         4 000204   000226 710000 4                  TRA     s:16758
         4 000205   000231 710000 4                  TRA     s:16761
         4 000206   000545 710000 4                  TRA     s:16858
         4 000207   000551 710000 4                  TRA     s:16861
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:21   
         4 000210   000551 710000 4                  TRA     s:16861
         4 000211   000551 710000 4                  TRA     s:16861
         4 000212   000551 710000 4                  TRA     s:16861
         4 000213   000551 710000 4                  TRA     s:16861
         4 000214   000551 710000 4                  TRA     s:16861
         4 000215   000551 710000 4                  TRA     s:16861
         4 000216   000551 710000 4                  TRA     s:16861
         4 000217   000551 710000 4                  TRA     s:16861
         4 000220   000551 710000 4                  TRA     s:16861
         4 000221   000231 710000 4                  TRA     s:16761
         4 000222   000551 710000 4                  TRA     s:16861
         4 000223   000551 710000 4                  TRA     s:16861
         4 000224   000551 710000 4                  TRA     s:16861
         4 000225   000226 710000 4                  TRA     s:16758

      110    16756
      111    16757    3          CASE( %TAPE_SET, %OD_SET );

      112    16758    3            CALL FLI_MULTI_SET ALTRET( JUSTALT );

  16758  4 000226   000562 701000 4                  TSX1    FLI_MULTI_SET
         4 000227   000561 702000 4                  TSX2    JUSTALT
         4 000230   000551 710000 4                  TRA     s:16861

      113    16759
      114    16760    3          CASE( %TAPE_OPTIONS,%REBUILD_TAPE_OPTIONS );

      115    16761    4            DO SUBNODEX = 0 TO SUBLK$->OUT$BLK.NSUBLKS - 1;

  16761  4 000231   200005 450100                    STZ     SUBNODEX,,AUTO
         4 000232   000537 710000 4                  TRA     s:16855+1

      116    16762    4               SUBNODE$ = SUBLK$->OUT$BLK.SUBLK$(SUBNODEX);

  16762  4 000233   200006 470500                    LDP0    SUBLK$,,AUTO
         4 000234   200005 720100                    LXL0    SUBNODEX,,AUTO
         4 000235   000003 236110                    LDQ     3,X0,PR0
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:22   
         4 000236   200007 756100                    STQ     SUBNODE$,,AUTO

      117    16763
      118    16764    5               DO CASE( SUBNODE$->OUT$BLK.CODE );

  16764  4 000237   200007 471500                    LDP1    SUBNODE$,,AUTO
         4 000240   100000 721100                    LXL1    0,,PR1
         4 000241   000043 101003                    CMPX1   35,DU
         4 000242   000244 602011 4                  TNC     s:16764+5,X1
         4 000243   000536 710000 4                  TRA     s:16855
         4 000244   000307 710000 4                  TRA     s:16767
         4 000245   000401 710000 4                  TRA     s:16798
         4 000246   000414 710000 4                  TRA     s:16803
         4 000247   000315 710000 4                  TRA     s:16771
         4 000250   000326 710000 4                  TRA     s:16775
         4 000251   000345 710000 4                  TRA     s:16784
         4 000252   000374 710000 4                  TRA     s:16795
         4 000253   000500 710000 4                  TRA     s:16834
         4 000254   000455 710000 4                  TRA     s:16816
         4 000255   000460 710000 4                  TRA     s:16819
         4 000256   000463 710000 4                  TRA     s:16822
         4 000257   000536 710000 4                  TRA     s:16855
         4 000260   000536 710000 4                  TRA     s:16855
         4 000261   000511 710000 4                  TRA     s:16840
         4 000262   000536 710000 4                  TRA     s:16855
         4 000263   000536 710000 4                  TRA     s:16855
         4 000264   000536 710000 4                  TRA     s:16855
         4 000265   000536 710000 4                  TRA     s:16855
         4 000266   000536 710000 4                  TRA     s:16855
         4 000267   000536 710000 4                  TRA     s:16855
         4 000270   000536 710000 4                  TRA     s:16855
         4 000271   000536 710000 4                  TRA     s:16855
         4 000272   000536 710000 4                  TRA     s:16855
         4 000273   000536 710000 4                  TRA     s:16855
         4 000274   000536 710000 4                  TRA     s:16855
         4 000275   000536 710000 4                  TRA     s:16855
         4 000276   000536 710000 4                  TRA     s:16855
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:23   
         4 000277   000536 710000 4                  TRA     s:16855
         4 000300   000525 710000 4                  TRA     s:16848
         4 000301   000514 710000 4                  TRA     s:16843
         4 000302   000506 710000 4                  TRA     s:16837
         4 000303   000466 710000 4                  TRA     s:16825
         4 000304   000473 710000 4                  TRA     s:16829
         4 000305   000536 710000 4                  TRA     s:16855
         4 000306   000534 710000 4                  TRA     s:16852

      119    16765
      120    16766    5                CASE( %DENSITY );

      121    16767    5                  TAPE_OPEN.V.DENSITY# = SUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

  16767  4 000307   100003 473500                    LDP3    3,,PR1
         4 000310   300000 236100                    LDQ     0,,PR3
         4 000311   000066 552004 xsym               STBQ    TAPE_OPEN+54,'04'O

      122    16768    5                  TAPE_OPTION.DENSITY = '1'B;

  16768  4 000312   400000 236003                    LDQ     -131072,DU
         4 000313   000002 256000 xsym               ORSQ    TAPE_OPTION+2
         4 000314   000536 710000 4                  TRA     s:16855

      123    16769
      124    16770    5                CASE( %VOLACCESS );

      125    16771    5                  TAPE_OPEN.V.VOLACCESS# = SUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

  16771  4 000315   100003 473500                    LDP3    3,,PR1
         4 000316   300000 236100                    LDQ     0,,PR3
         4 000317   000022 736000                    QLS     18
         4 000320   000063 676000 xsym               ERQ     TAPE_OPEN+51
         4 000321   000007 376003                    ANQ     7,DU
         4 000322   000063 656000 xsym               ERSQ    TAPE_OPEN+51

      126    16772    5                  TAPE_OPTION.VOLACCESS = '1'B;
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:24   

  16772  4 000323   200000 236003                    LDQ     65536,DU
         4 000324   000002 256000 xsym               ORSQ    TAPE_OPTION+2
         4 000325   000536 710000 4                  TRA     s:16855

      127    16773
      128    16774    5                CASE( %EXPIRE );

      129    16775    5                  IF SUBNODE$->OUT$BLK.NSUBLKS = 0

  16775  4 000326   100001 222100                    LDX2    1,,PR1
         4 000327   000333 601000 4                  TNZ     s:16778

      130    16776    5                   THEN TAPE_OPEN.V.EXPIRE# = %NEVER#;

  16776  4 000330   000001 335007                    LCA     1,DL
         4 000331   000057 755000 xsym               STA     TAPE_OPEN+47
         4 000332   000342 710000 4                  TRA     s:16781

      131    16777    6                   ELSE DO;

      132    16778    6                     CALL CHARBIN( TAPE_OPEN.V.EXPIRE#,

  16778  4 000333   100003 473500                    LDP3    3,,PR1
         4 000334   300004 236100                    LDQ     4,,PR3
         4 000335   000033 772000                    QRL     27
         4 000336   000000 623006                    EAX3    0,QL
         4 000337   000000 305540                    DTB
         4 000340   300004 230013                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X3
         4 000341   000057 000004 xsym               NDSC9   TAPE_OPEN+47             cn=0,s=lsgnf,sf=0,n=4

      133    16779    6                       SUBNODE$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT );
      134    16780    6                     END;

      135    16781    5                  TAPE_OPTION.EXPIRE = '1'B;

  16781  4 000342   100000 236003                    LDQ     32768,DU
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:25   
         4 000343   000002 256000 xsym               ORSQ    TAPE_OPTION+2
         4 000344   000536 710000 4                  TRA     s:16855

      136    16782
      137    16783    5                CASE( %BLOCK );

      138    16784    5                  CALL CHARBIN( NBR_GRANS_PER_TAPE_BUF, SUBNODE$->OUT$BLK.SUBLK$(0)->
             16784                           OUT$SYM.TEXT );

  16784  4 000345   100003 473500                    LDP3    3,,PR1
         4 000346   300004 236100                    LDQ     4,,PR3
         4 000347   000033 772000                    QRL     27
         4 000350   000000 622006                    EAX2    0,QL
         4 000351   000000 305540                    DTB
         4 000352   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         4 000353   000000 000004 xsym               NDSC9   NBR_GRANS_PER_TAPE_BUF   cn=0,s=lsgnf,sf=0,n=4

      139    16785    5                  TAPE_OPEN.V.BLKL# = NBR_GRANS_PER_TAPE_BUF * 4096;

  16785  4 000354   000000 235000 xsym               LDA     NBR_GRANS_PER_TAPE_BUF
         4 000355   000014 735000                    ALS     12
         4 000356   000000 621005                    EAX1    0,AL
         4 000357   000052 741000 xsym               STX1    TAPE_OPEN+42

      140    16786    5                  TAPE_OPTION.BLOCK = '1'B;

  16786  4 000360   040000 236003                    LDQ     16384,DU
         4 000361   000002 256000 xsym               ORSQ    TAPE_OPTION+2

      141    16787    5                  IF NBR_GRANS_PER_TAPE_BUF > ( 99999 / ( 4096 * 9 / 8 ) )

  16787  4 000362   000000 235000 xsym               LDA     NBR_GRANS_PER_TAPE_BUF
         4 000363   000025 115007                    CMPA    21,DL
         4 000364   000536 604400 4                  TMOZ    s:16855

      142    16788    6                   THEN DO; /* 99999 is ANS limit, 4096 binary block size,

PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:26   
      143    16789                           9 / 8 conversion factor from binary to ASCII */
      144    16790    6                     CALL FLI$RPT_ERR ( E_BLOCK_LIMIT );

  16790  4 000365   000011 630400 5                  EPPR0   9
         4 000366   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000367   000000 701000 xent               TSX1    FLI$RPT_ERR
         4 000370   000000 011000                    NOP     0

      145    16791    6                     COMMAND_ERROR = '1'B;

  16791  4 000371   400000 236003                    LDQ     -131072,DU
         4 000372   000000 756000 xsym               STQ     COMMAND_ERROR

      146    16792    6                     END;

  16792  4 000373   000536 710000 4                  TRA     s:16855

      147    16793
      148    16794    5                CASE( %EXTEND );

      149    16795    5                  TAPE_OPEN.V.XTEND# = %YES#;

  16795  4 000374   000060 236000 xsym               LDQ     TAPE_OPEN+48
         4 000375   000001 376000 5                  ANQ     1
         4 000376   020000 276003                    ORQ     8192,DU
         4 000377   000060 756000 xsym               STQ     TAPE_OPEN+48
         4 000400   000536 710000 4                  TRA     s:16855

      150    16796
      151    16797    5                CASE( %VOL );

      152    16798    5                  CALL CHARBIN( TEMP,

  16798  4 000401   100003 473500                    LDP3    3,,PR1
         4 000402   300004 236100                    LDQ     4,,PR3
         4 000403   000033 772000                    QRL     27
         4 000404   000000 622006                    EAX2    0,QL
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:27   
         4 000405   000100 305540                    DTB
         4 000406   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         4 000407   200010 000004                    NDSC9   TEMP,,AUTO               cn=0,s=lsgnf,sf=0,n=4

      153    16799    5                    SUBNODE$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT );
      154    16800    5                  TAPE_OPEN.V.VOL# = TEMP;

  16800  4 000410   200010 236100                    LDQ     TEMP,,AUTO
         4 000411   000033 736000                    QLS     27
         4 000412   000061 552040 xsym               STBQ    TAPE_OPEN+49,'40'O
         4 000413   000536 710000 4                  TRA     s:16855

      155    16801
      156    16802    5                CASE( %FSN );

      157    16803    5                  CALL CHARBIN( TEMP,

  16803  4 000414   100003 473500                    LDP3    3,,PR1
         4 000415   300004 236100                    LDQ     4,,PR3
         4 000416   000033 772000                    QRL     27
         4 000417   000000 622006                    EAX2    0,QL
         4 000420   000100 305540                    DTB
         4 000421   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         4 000422   200010 000004                    NDSC9   TEMP,,AUTO               cn=0,s=lsgnf,sf=0,n=4

      158    16804    5                    SUBNODE$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT );
      159    16805    5                  TAPE_OPEN.V.FSN# = TEMP;

  16805  4 000423   200010 723100                    LXL3    TEMP,,AUTO
         4 000424   000066 743000 xsym               STX3    TAPE_OPEN+54

      160    16806    5                  IF SUBNODE$->OUT$BLK.NSUBLKS <= 1

  16806  4 000425   100001 221100                    LDX1    1,,PR1
         4 000426   000002 101003                    CMPX1   2,DU
         4 000427   000433 603000 4                  TRC     s:16808

PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:28   
      161    16807    5                   THEN LAST_TAPE_FSN = TEMP;

  16807  4 000430   200010 235100                    LDA     TEMP,,AUTO
         4 000431   000000 755000 xsym               STA     LAST_TAPE_FSN
         4 000432   000442 710000 4                  TRA     s:16809

      162    16808    5                   ELSE CALL CHARBIN( LAST_TAPE_FSN, SUBNODE$->OUT$BLK.SUBLK$(1)->
             16808                            OUT$SYM.TEXT );

  16808  4 000433   100004 473500                    LDP3    4,,PR1
         4 000434   300004 236100                    LDQ     4,,PR3
         4 000435   000033 772000                    QRL     27
         4 000436   000000 622006                    EAX2    0,QL
         4 000437   000000 305540                    DTB
         4 000440   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         4 000441   000000 000004 xsym               NDSC9   LAST_TAPE_FSN            cn=0,s=lsgnf,sf=0,n=4

      163    16809    5                  IF TAPE_OPEN.V.FSN# > LAST_TAPE_FSN

  16809  4 000442   000066 236000 xsym               LDQ     TAPE_OPEN+54
         4 000443   000022 772000                    QRL     18
         4 000444   000000 116000 xsym               CMPQ    LAST_TAPE_FSN
         4 000445   000536 604400 4                  TMOZ    s:16855

      164    16810    6                   THEN DO;

      165    16811    6                     COMMAND_ERROR = '1'B;

  16811  4 000446   400000 236003                    LDQ     -131072,DU
         4 000447   000000 756000 xsym               STQ     COMMAND_ERROR

      166    16812    6                     CALL FLI$RPT_ERR( E_BAD_FSN_RANGE, );

  16812  4 000450   000012 630400 5                  EPPR0   10
         4 000451   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000452   000000 701000 xent               TSX1    FLI$RPT_ERR
         4 000453   000000 011000                    NOP     0
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:29   

      167    16813    6                     END;

  16813  4 000454   000536 710000 4                  TRA     s:16855

      168    16814
      169    16815    5                CASE( %LEA_TAPE );

      170    16816    5                  DISK_OPTION.LEA = '1'B;

  16816  4 000455   040000 236003                    LDQ     16384,DU
         4 000456   000000 256000 xsym               ORSQ    DISK_OPTION
         4 000457   000536 710000 4                  TRA     s:16855

      171    16817
      172    16818    5                CASE( %RING );

      173    16819    5                  TAPE_OPEN.V.FUN# = %CREATE#;

  16819  4 000460   003000 236007                    LDQ     1536,DL
         4 000461   000045 552010 xsym               STBQ    TAPE_OPEN+37,'10'O
         4 000462   000536 710000 4                  TRA     s:16855

      174    16820
      175    16821    5                CASE( %NORING );

      176    16822    5                  TAPE_OPEN.V.FUN# = %IN#;

  16822  4 000463   002000 236007                    LDQ     1024,DL
         4 000464   000045 552010 xsym               STBQ    TAPE_OPEN+37,'10'O
         4 000465   000536 710000 4                  TRA     s:16855

      177    16823
      178    16824    5                CASE( %TAPE_CHECK );

      179    16825    5                  TAPE_OPTION.CHECK = '1'B;

PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:30   
  16825  4 000466   400000 236003                    LDQ     -131072,DU
         4 000467   000000 256000 xsym               ORSQ    TAPE_OPTION

      180    16826    5                  TAPE_OPTION.CHECK_SPECD = '1'B;

  16826  4 000470   200000 236003                    LDQ     65536,DU
         4 000471   000000 256000 xsym               ORSQ    TAPE_OPTION
         4 000472   000536 710000 4                  TRA     s:16855

      181    16827
      182    16828    5                CASE( %TAPE_CHECKN );

      183    16829    5                  TAPE_OPTION.CHECK = '0'B;

  16829  4 000473   000031 236000 xsym               LDQ     B_VECTNIL+25
         4 000474   000000 356000 xsym               ANSQ    TAPE_OPTION

      184    16830    5                  TAPE_OPTION.CHECK_SPECD = '1'B;

  16830  4 000475   200000 236003                    LDQ     65536,DU
         4 000476   000000 256000 xsym               ORSQ    TAPE_OPTION
         4 000477   000536 710000 4                  TRA     s:16855

      185    16831
      186    16832
      187    16833    5                CASE( %PROTTYPE );

      188    16834    5                  TAPE_OPTION.PROTTYPE = SUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

  16834  4 000500   100003 473500                    LDP3    3,,PR1
         4 000501   300000 236100                    LDQ     0,,PR3
         4 000502   777777 376007                    ANQ     -1,DL
         4 000503   000041 736000                    QLS     33
         4 000504   000001 756000 xsym               STQ     TAPE_OPTION+1
         4 000505   000536 710000 4                  TRA     s:16855

      189    16835
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:31   
      190    16836    5                CASE( %TAPE_DIR );

      191    16837    5                  DISK_OPTION.DIR = '1'B;

  16837  4 000506   400000 236003                    LDQ     -131072,DU
         4 000507   000000 256000 xsym               ORSQ    DISK_OPTION
         4 000510   000536 710000 4                  TRA     s:16855

      192    16838
      193    16839    5                CASE( %NPAD );

      194    16840    5                  TAPE_OPTION.NPAD = '1'B;

  16840  4 000511   020000 236003                    LDQ     8192,DU
         4 000512   000002 256000 xsym               ORSQ    TAPE_OPTION+2
         4 000513   000536 710000 4                  TRA     s:16855

      195    16841
      196    16842    5                CASE( %IOERRORCY );

      197    16843    5                  TAPE_OPTION.IOERRORC = '1'B;

  16843  4 000514   010000 236003                    LDQ     4096,DU
         4 000515   000002 256000 xsym               ORSQ    TAPE_OPTION+2

      198    16844    5                  TAPE_OPTION.IOERRORC_SPECD = '1'B;

  16844  4 000516   004000 236003                    LDQ     2048,DU
         4 000517   000002 256000 xsym               ORSQ    TAPE_OPTION+2

      199    16845    5                  TAPE_OPEN.V.IOERROK# = '1'B;

  16845  4 000520   000060 236000 xsym               LDQ     TAPE_OPEN+48
         4 000521   000003 376000 5                  ANQ     3
         4 000522   002000 276003                    ORQ     1024,DU
         4 000523   000060 756000 xsym               STQ     TAPE_OPEN+48
         4 000524   000536 710000 4                  TRA     s:16855
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:32   

      200    16846
      201    16847    5                CASE( %IOERRORCN );

      202    16848    5                  TAPE_OPTION.IOERRORC = '0'B;

  16848  4 000525   000013 236000 5                  LDQ     11
         4 000526   000002 356000 xsym               ANSQ    TAPE_OPTION+2

      203    16849    5                  TAPE_OPTION.IOERRORC_SPECD = '1'B;

  16849  4 000527   004000 236003                    LDQ     2048,DU
         4 000530   000002 256000 xsym               ORSQ    TAPE_OPTION+2

      204    16850    5                  TAPE_OPEN.V.IOERROK# = '0'B;

  16850  4 000531   000003 236000 5                  LDQ     3
         4 000532   000060 356000 xsym               ANSQ    TAPE_OPEN+48
         4 000533   000536 710000 4                  TRA     s:16855

      205    16851    5                CASE( %DUPLICATE_TAPESET );

      206    16852    5                  TAPE_OPTION.DUPLICATE_TAPESET = '1'B;

  16852  4 000534   002000 236003                    LDQ     1024,DU
         4 000535   000002 256000 xsym               ORSQ    TAPE_OPTION+2

      207    16853
      208    16854    5                END;

      209    16855    4               END;

  16855  4 000536   200005 054100                    AOS     SUBNODEX,,AUTO
         4 000537   200006 470500                    LDP0    SUBLK$,,AUTO
         4 000540   000001 236100                    LDQ     1,,PR0
         4 000541   000022 772000                    QRL     18
         4 000542   200005 116100                    CMPQ    SUBNODEX,,AUTO
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:33   
         4 000543   000233 605400 4                  TPNZ    s:16762
         4 000544   000551 710000 4                  TRA     s:16861

      210    16856
      211    16857    3          CASE( %EXTND );

      212    16858    3            TAPE_OPEN.V.XTEND# = %YES#;

  16858  4 000545   000060 236000 xsym               LDQ     TAPE_OPEN+48
         4 000546   000001 376000 5                  ANQ     1
         4 000547   020000 276003                    ORQ     8192,DU
         4 000550   000060 756000 xsym               STQ     TAPE_OPEN+48

      213    16859
      214    16860    3          END;

      215    16861    2         END;

  16861  4 000551   200004 054100                    AOS     NODEX,,AUTO
         4 000552   200003 470500                    LDP0    @NODE$,,AUTO
         4 000553   000000 471500                    LDP1    0,,PR0
         4 000554   100001 236100                    LDQ     1,,PR1
         4 000555   000022 772000                    QRL     18
         4 000556   200004 116100                    CMPQ    NODEX,,AUTO
         4 000557   000172 605400 4                  TPNZ    s:16754

      216    16862    1      RETURN;

  16862  4 000560   000000 702200 xent               TSX2  ! X66_ARET

  16851  4 000561                       JUSTALT      null
      217    16863
      218    16864    1   JUSTALT: ;
      219    16865    1      ALTRETURN;

  16865  4 000561   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:34   
      220    16866
      221    16867        /****************************************/
      222    16868    1   FLI_MULTI_SET: PROC ALTRET;

  16868  4 000562   200012 741300       FLI_MULTI_S* STX1  ! TEMP+2,,AUTO

      223    16869        /*F*  NAME: FLI_MULTI_SET
      224    16870              PURPOSE: Process MULTI_SET node.
      225    16871        */
      226    16872
      227    16873         /***
      228    16874          *** AUTO
      229    16875          ***/
      230    16876
      231    16877    2   DCL I SBIN AUTO;
      232    16878    2   DCL TEMP SBIN AUTO;
      233    16879
      234    16880         /***
      235    16881          *** BASED
      236    16882          ***/
      237    16883
      238    16884    2   DCL CTSN CHAR(6) AUTO;
      239    16885    2   DCL 1 CTSNCHARS REDEF CTSN,
      240    16886    2         2 XXXX CHAR(4),
      241    16887    2         2 N1 UBIN BYTE CALIGNED,
      242    16888    2         2 N2 UBIN BYTE CALIGNED;
      243    16889
      244    16890        /****************************************/
      245    16891
      246    16892    3      DO SUBNODEX=0 TO SUBLK$->OUT$BLK.NSUBLKS-1;

  16892  4 000563   200005 450100                    STZ     SUBNODEX,,AUTO
         4 000564   000600 710000 4                  TRA     s:16895+1

      247    16893    3         SUBNODE$ = SUBLK$->OUT$BLK.SUBLK$(SUBNODEX);

  16893  4 000565   200006 470500                    LDP0    SUBLK$,,AUTO
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:35   
         4 000566   200005 720100                    LXL0    SUBNODEX,,AUTO
         4 000567   000003 236110                    LDQ     3,X0,PR0
         4 000570   200007 756100                    STQ     SUBNODE$,,AUTO

      248    16894    3         CALL FLI$USE_SNLIST_NODE( SUBNODE$ ) ALTRET( JUSTALT );

  16894  4 000571   200007 631500                    EPPR1   SUBNODE$,,AUTO
         4 000572   200020 451500                    STP1    TEMP+8,,AUTO
         4 000573   200020 630500                    EPPR0   TEMP+8,,AUTO
         4 000574   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000575   000000 701000 xent               TSX1    FLI$USE_SNLIST_NODE
         4 000576   000607 702000 4                  TSX2    JUSTALT

      249    16895    3         END;

  16895  4 000577   200005 054100                    AOS     SUBNODEX,,AUTO
         4 000600   200006 470500                    LDP0    SUBLK$,,AUTO
         4 000601   000001 236100                    LDQ     1,,PR0
         4 000602   000022 772000                    QRL     18
         4 000603   200005 116100                    CMPQ    SUBNODEX,,AUTO
         4 000604   000565 605400 4                  TPNZ    s:16893

      250    16896    2      RETURN;

  16896  4 000605   200012 221300                    LDX1  ! TEMP+2,,AUTO
         4 000606   000001 702211                    TSX2  ! 1,X1

  16894  4 000607                       JUSTALT      null
      251    16897
      252    16898    2   JUSTALT: ;
      253    16899    2      ALTRETURN;

  16899  4 000607   200012 221300                    LDX1  ! TEMP+2,,AUTO
         4 000610   000000 702211                    TSX2  ! 0,X1
      254    16900
      255    16901    2   END FLI_MULTI_SET;
      256    16902
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:36   
      257    16903    1   END FLI$NODE_TAPE_OD;
      258    16904        %EOD;

PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:37   
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FL_PERR_C.:E05TOU  is referenced.
   FLE_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLI$NODE_TAPE_OD.
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:38   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @NODE$                    *0-0-0/w PTR         r     1 NODE$
     4-0-0/w SBIN        r     1 NODEX                      6-0-0/w PTR         r     1 SUBLK$
     7-0-0/w PTR         r     1 SUBNODE$                   5-0-0/w SBIN        r     1 SUBNODEX
    10-0-0/w SBIN        r     1 TEMP

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 COMMAND_ERROR              0-0-0/c CHAR(4)     r     1 CT_IMAGE
     0-0-0/w SBIN        r     1 DEFAULT_GRANS_PER_TAPE_BUF
     0-0-0/w PTR         r     1 DISK_FILE_SPEC$            0-0-0/w STRC(145)   r     1 DISK_OPTION
     0-0-0/w PTR         r     1 DPLIST$                    0-0-0/w PTR         r     1 DPRESLIST$
     0-0-0/w STRC        r     1 E_BAD_FSN_RANGE            0-0-0/w STRC        r     1 E_BLOCK_LIMIT
     0-0-0/w SBIN        r     1 LAST_TAPE_FSN
     0-0-0/w SBIN        r     1 NBR_GRANS_PER_TAPE_BUF
     0-0-0/c ASTR(9)     r     1 RET_CMDS_NAME              0-0-0/w PTR         r     1 SNVECLIST$
     0-0-0/w PTR         r     1 TAPE_DCBLIST$              0-0-0/d STRC(2088)  r     1 TAPE_OPEN
     0-0-0/w STRC(144)   r     1 TAPE_OPTION

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/c ASTR(9)     r     1 TEXTC

PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:39   

   Procedure FLI$NODE_TAPE_OD requires 393 words for executable code.
   Procedure FLI$NODE_TAPE_OD requires 18 words of local(AUTO) storage.
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:40   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:41   
          MINI XREF LISTING

COMMAND_ERROR
     12460**DCL     16791<<ASSIGN  16811<<ASSIGN
CTSN IN PROCEDURE FLI_MULTI_SET
     16884**DCL     16885--REDEF
CT_IMAGE
     12630**DCL     16720<<ASSIGN
DEFAULT_GRANS_PER_TAPE_BUF
     12463**DCL     16718>>ASSIGN  16719>>ASSIGN
DISK_CLOSE.SN_
     12140**DCL     12140--REDEF
DISK_CLOSE.UTL_
     12141**DCL     12141--REDEF
DISK_CLOSE.V.EXPIRE#
     12155**DCL     12155--REDEF
DISK_CLOSE.V.TYPE#
     12153**DCL     12153--REDEF
DISK_CLOSE.V.XTNSIZE#
     12150**DCL     12150--REDEF   12152--REDEF
DISK_FILE_SPEC.SPEC
     12505**DCL     12507--REDEF
DISK_FILE_SPEC.SPEC.START
     12506**DCL     12506--REDEF
DISK_FILE_SPEC.SPEC.STOP
     12507**DCL     12507--REDEF
DISK_FILE_SPEC$
     12504**DCL     12505--IMP-PTR
DISK_OPEN.ACSVEH_
     12005**DCL     12006--REDEF
DISK_OPEN.ALTKEYS_
     12011**DCL     12012--REDEF   12012--REDEF
DISK_OPEN.HDR_
     12010**DCL     12011--REDEF
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:42   
DISK_OPEN.TAB_
     12009**DCL     12010--REDEF
DISK_OPEN.UHL_
     12003**DCL     12004--REDEF   12004--REDEF
DISK_OPEN.V.FSN#
     12043**DCL     12043--REDEF   12043--REDEF
DISK_OPEN.WSN_
     12009**DCL     12009--REDEF
DISK_OPTION.DIR
     12517**DCL     16837<<ASSIGN
DISK_OPTION.LEA
     12517**DCL     16816<<ASSIGN
DISK_READ.STATION_
     12067**DCL     12068--REDEF
DISK_READ.V.DVBYTE.REREAD#
     12079**DCL     12079--REDEF
DISK_READ.V.INDX#
     12077**DCL     12077--REDEF
DISK_WRITE.STATION_
     12105**DCL     12105--REDEF
DISK_WRITE.V.DVBYTE.VFC#
     12112**DCL     12112--REDEF
DPLIST$
     12490**DCL     12502--IMP-PTR
DPRESLIST$
     12504**DCL     12504--IMP-PTR
EFTWORD
     12625**DCL     12625--REDEF
E_BAD_FSN_RANGE
      7040**DCL     16812<>CALL
E_BLOCK_LIMIT
     10416**DCL     16790<>CALL
FLI$RPT_ERR
     16594**DCL-ENT 16790--CALL    16812--CALL
FLI$USE_SNLIST_NODE
     16595**DCL-ENT 16894--CALL
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:43   
FLI_MULTI_SET
     16868**PROC    16758--CALL
FPT_EXIT.V.STEPCC#
     11930**DCL     11930--REDEF
JUSTALT
     16851**LABEL   16758--CALLALT
JUSTALT IN PROCEDURE FLI_MULTI_SET
     16894**LABEL   16894--CALLALT
LAST_TAPE_FSN
     12624**DCL     16711<<ASSIGN  16738<<ASSIGN  16744<<ASSIGN  16807<<ASSIGN  16808<<CALLBLT 16809>>IF
M$XXX
      5518**DCL-ENT 16746--CALL
NBR_GRANS_PER_TAPE_BUF
     12463**DCL     16719<<ASSIGN  16784<<CALLBLT 16785>>ASSIGN  16787>>IF
NODE$
        13**DCL         8--PROC    16617--IMP-PTR 16722>>DOCASE  16753>>DOINDEX 16754>>ASSIGN
NODEX
     16601**DCL     16753<<DOINDEX 16754>>ASSIGN
OUT$BLK.CODE
     16625**DCL     16722>>DOCASE  16755>>DOCASE  16764>>DOCASE  16767>>ASSIGN  16771>>ASSIGN  16834>>ASSIGN
OUT$BLK.NSUBLKS
     16629**DCL     16753>>DOINDEX 16761>>DOINDEX 16775>>IF      16806>>IF      16892>>DOINDEX
OUT$BLK.SUBLK$
     16650**DCL     16754>>ASSIGN  16762>>ASSIGN  16767>>ASSIGN  16771>>ASSIGN  16778>>CALLBLT 16778>>CALLBLT
     16784>>CALLBLT 16784>>CALLBLT 16798>>CALLBLT 16798>>CALLBLT 16803>>CALLBLT 16803>>CALLBLT 16808>>CALLBLT
     16808>>CALLBLT 16834>>ASSIGN  16893>>ASSIGN
OUT$SYM.COUNT
     16686**DCL     16689--IMP-SIZ 16778>>CALLBLT 16784>>CALLBLT 16798>>CALLBLT 16803>>CALLBLT 16808>>CALLBLT
OUT$SYM.TEXT
     16689**DCL     16778>>CALLBLT 16784>>CALLBLT 16798>>CALLBLT 16803>>CALLBLT 16808>>CALLBLT
PRE_RET_CLOSE.SN_
     12868**DCL     12868--REDEF
PRE_RET_CLOSE.UTL_
     12869**DCL     12869--REDEF
PRE_RET_CLOSE.V.EXPIRE#
     12883**DCL     12883--REDEF
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:44   
PRE_RET_CLOSE.V.TYPE#
     12881**DCL     12881--REDEF
PRE_RET_CLOSE.V.XTNSIZE#
     12878**DCL     12878--REDEF   12880--REDEF
PRE_RET_OPEN.ACSVEH_
     12803**DCL     12804--REDEF
PRE_RET_OPEN.ALTKEYS_
     12809**DCL     12810--REDEF   12810--REDEF
PRE_RET_OPEN.HDR_
     12808**DCL     12809--REDEF
PRE_RET_OPEN.TAB_
     12807**DCL     12808--REDEF
PRE_RET_OPEN.UHL_
     12801**DCL     12802--REDEF   12802--REDEF
PRE_RET_OPEN.V.FSN#
     12841**DCL     12841--REDEF   12841--REDEF
PRE_RET_OPEN.WSN_
     12807**DCL     12807--REDEF
PRE_RET_READ.STATION_
     12658**DCL     12659--REDEF
PRE_RET_READ.V.DVBYTE.REREAD#
     12670**DCL     12670--REDEF
PRE_RET_READ.V.INDX#
     12668**DCL     12668--REDEF
PRE_RET_WRITE.STATION_
     12696**DCL     12696--REDEF
PRE_RET_WRITE.V.DVBYTE.VFC#
     12703**DCL     12703--REDEF
RET_CMDS_NAME.L#
     12912**DCL     12912--IMP-SIZ
SNVECLIST$
     12444**DCL     12444--IMP-PTR
SPEC.START
     12508**DCL     12509--REDEF
SPEC.STOP
     12509**DCL     12510--REDEF
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:45   
SPECCHARS
     12508**DCL     12508--REDEF
SUBLK$
     16603**DCL     16754<<ASSIGN  16755>>DOCASE  16761>>DOINDEX 16762>>ASSIGN  16892>>DOINDEX 16893>>ASSIGN
SUBNODE$
     16604**DCL     16762<<ASSIGN  16764>>DOCASE  16767>>ASSIGN  16771>>ASSIGN  16775>>IF      16778>>CALLBLT
     16778>>CALLBLT 16784>>CALLBLT 16784>>CALLBLT 16798>>CALLBLT 16798>>CALLBLT 16803>>CALLBLT 16803>>CALLBLT
     16806>>IF      16808>>CALLBLT 16808>>CALLBLT 16834>>ASSIGN  16893<<ASSIGN  16894<>CALL
SUBNODEX
     16602**DCL     16761<<DOINDEX 16762>>ASSIGN  16892<<DOINDEX 16893>>ASSIGN
TAPE_CLOSE.SN_
     12361**DCL     12361--REDEF
TAPE_CLOSE.UTL_
     12362**DCL     12362--REDEF
TAPE_CLOSE.V.EXPIRE#
     12376**DCL     12376--REDEF
TAPE_CLOSE.V.TYPE#
     12374**DCL     12374--REDEF
TAPE_CLOSE.V.XTNSIZE#
     12371**DCL     12371--REDEF   12373--REDEF
TAPE_DCBLIST$
     11917**DCL     11917--IMP-PTR
TAPE_OPEN.ACSVEH_
     12226**DCL     12227--REDEF
TAPE_OPEN.ALTKEYS_
     12232**DCL     12233--REDEF   12233--REDEF
TAPE_OPEN.FPARAM_
     12229**DCL     16715<<ASSIGN
TAPE_OPEN.HDR_
     12231**DCL     12232--REDEF
TAPE_OPEN.IFPARAM_
     12229**DCL     16714<<ASSIGN
TAPE_OPEN.NAME_
     12225**DCL     16712<<ASSIGN
TAPE_OPEN.TAB_
     12230**DCL     12231--REDEF
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:46   
TAPE_OPEN.UHL_
     12224**DCL     12225--REDEF   12225--REDEF
TAPE_OPEN.V.ASN#
     12243**DCL     16727<<ASSIGN  16732<<ASSIGN  16737<<ASSIGN  16743<<ASSIGN
TAPE_OPEN.V.BLKL#
     12250**DCL     16718<<ASSIGN  16785<<ASSIGN
TAPE_OPEN.V.CVOL#
     12238**DCL     16726<<ASSIGN  16731<<ASSIGN  16736<<ASSIGN  16742<<ASSIGN
TAPE_OPEN.V.DENSITY#
     12265**DCL     16705<<ASSIGN  16767<<ASSIGN
TAPE_OPEN.V.EXPIRE#
     12253**DCL     16706<<ASSIGN  16776<<ASSIGN  16778<<CALLBLT
TAPE_OPEN.V.FSN#
     12264**DCL     12264--REDEF   12264--REDEF   16709<<ASSIGN  16805<<ASSIGN  16809>>IF
TAPE_OPEN.V.FUN#
     12243**DCL     16725<<ASSIGN  16730<<ASSIGN  16735<<ASSIGN  16741<<ASSIGN  16819<<ASSIGN  16822<<ASSIGN
TAPE_OPEN.V.INITZ.SCRUB#
     12234**DCL     16713<<ASSIGN
TAPE_OPEN.V.IOERROK#
     12255**DCL     16717<<ASSIGN  16845<<ASSIGN  16850<<ASSIGN
TAPE_OPEN.V.OPER.MNTONLY#
     12237**DCL     16704<<ASSIGN
TAPE_OPEN.V.RES#
     12248**DCL     16710<<ASSIGN  16724<<ASSIGN  16729<<ASSIGN  16734<<ASSIGN  16740<<ASSIGN
TAPE_OPEN.V.VOL#
     12258**DCL     16716<<ASSIGN  16800<<ASSIGN
TAPE_OPEN.V.VOLACCESS#
     12262**DCL     16708<<ASSIGN  16771<<ASSIGN
TAPE_OPEN.V.XTEND#
     12254**DCL     16707<<ASSIGN  16795<<ASSIGN  16858<<ASSIGN
TAPE_OPEN.WSN_
     12230**DCL     12230--REDEF
TAPE_OPTION.BLOCK
     12629**DCL     16786<<ASSIGN
TAPE_OPTION.CHECK
     12628**DCL     16825<<ASSIGN  16829<<ASSIGN
PL6.E3A0      #001=FLI$NODE_TAPE_OD File=FLI$NODE.:E05TSI                        TUE 07/29/97 15:52 Page:47   
TAPE_OPTION.CHECK_SPECD
     12628**DCL     16826<<ASSIGN  16830<<ASSIGN
TAPE_OPTION.DENSITY
     12628**DCL     16768<<ASSIGN
TAPE_OPTION.DUPLICATE_TAPESET
     12629**DCL     16852<<ASSIGN
TAPE_OPTION.EXPIRE
     12628**DCL     16781<<ASSIGN
TAPE_OPTION.IOERRORC
     12629**DCL     16843<<ASSIGN  16848<<ASSIGN
TAPE_OPTION.IOERRORC_SPECD
     12629**DCL     16844<<ASSIGN  16849<<ASSIGN
TAPE_OPTION.NPAD
     12629**DCL     16840<<ASSIGN
TAPE_OPTION.PROTTYPE
     12628**DCL     16834<<ASSIGN
TAPE_OPTION.VOLACCESS
     12628**DCL     16772<<ASSIGN
TAPE_READ.STATION_
     12288**DCL     12289--REDEF
TAPE_READ.V.DVBYTE.REREAD#
     12300**DCL     12300--REDEF
TAPE_READ.V.INDX#
     12298**DCL     12298--REDEF
TAPE_WRITE.STATION_
     12326**DCL     12326--REDEF
TAPE_WRITE.V.DVBYTE.VFC#
     12333**DCL     12333--REDEF
TEMP
     16605**DCL     16798<<CALLBLT 16800>>ASSIGN  16803<<CALLBLT 16805>>ASSIGN  16807>>ASSIGN
TEXTC.L
     16695**DCL     16696--IMP-SIZ
TVECTOR.W2
     12457**DCL     12458--REDEF

PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:48   
      259        1        /*T***********************************************************/
      260        2        /*T*                                                         */
      261        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      262        4        /*T*                                                         */
      263        5        /*T***********************************************************/
      264        6        FLI$SNLIST_NODE: PROC( NODE$, SNLIST$, SNSIZEW ) ALTRET;
      265        7        /*F*  NAME: FLI$SNLIST
      266        8              PURPOSE: Build serial number list VLP from node.
      267        9        */
      268       10
      269       11    1   DCL NODE$ PTR ALIGNED;                  /* To CT_VOL_SET or LT_VOL_SET node   */
      270       12                                                /* To CD_VOL_SET or OD_VOL_SET node   */
      271       13    1   DCL SNLIST$ PTR ALIGNED;                /* Pointer to VLP_SN area             */
      272       14    1   DCL SNSIZEW SBIN ALIGNED;          /* Returned size in words of VLP_SN built  */
      273       15
      274       16         /***
      275       17          *** INCLUDE
      276       18          ***/
      277       19
      278       20        %INCLUDE CP_6;
      279     5579        %INCLUDE FLE_DATA_R;
      280    11530        %INCLUDE FLI_DATA_R;
      281    12944        %INCLUDE XU_MACRO_C;
      282    16050
      283    16051         /***
      284    16052          *** ENTRY
      285    16053          ***/
      286    16054
      287    16055    1   DCL FLI$RPT_ERR ENTRY(5);
      288    16056
      289    16057         /***
      290    16058          *** AUTO
      291    16059          ***/
      292    16060
      293    16061    1   DCL 1 CT5FMT AUTO,                      /* CT#xxxxn                           */
      294    16062    1         2 XXXX CHAR(4),
      295    16063    1         2 N CHAR(1),
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:49   
      296    16064    1         2 NUBIN REDEF N UBIN BYTE CALIGNED;
      297    16065    1   DCL CT5FMTCHARS REDEF CT5FMT CHAR(5);
      298    16066    1   DCL 1 CT6FMT AUTO,                      /* CT#xxxxnn                          */
      299    16067    1         2 XXXX CHAR(4),
      300    16068    1         2 NN CHAR(2),
      301    16069    1         2 NNUBIN REDEF NN,
      302    16070    1           3 N1 UBIN BYTE CALIGNED,
      303    16071    1           3 N2 UBIN BYTE CALIGNED;
      304    16072    1   DCL CT6FMTCHARS REDEF CT6FMT CHAR(6);
      305    16073    1   DCL SNLISTX SBIN AUTO;             /* Index of serial number list structure   */
      306    16074    1   DCL N SBIN AUTO;
      307    16075    1   DCL NN SBIN AUTO;
      308    16076    1   DCL SUBLK$ PTR AUTO;
      309    16077
      310    16078         /***
      311    16079          *** BASED
      312    16080          ***/
      313    16081
      314    16082        %PARSE$OUT( STCLASS=BASED );
      315    16127        %PARSE$SYM( STCLASS=BASED );
      316    16165
      317    16166         /***
      318    16167          *** FPT
      319    16168          ***/
      320    16169
      321    16170        %VLP_SN( FPTN=SNLIST,
      322    16171                 STCLASS="BASED(SNLIST$)" );
      323    16184
      324    16185        /****************************************/
      325    16186
      326    16187         /***
      327    16188          *** Handle CT/CD and LT/OD separately.
      328    16189          ***/
      329    16190
      330    16191    1      IF NODE$->OUT$BLK.CODE = %CT_VOL_SET OR NODE$->OUT$BLK.CODE = %CD_VOL_SET
      331    16192    1       THEN CALL FLI_CT_SNLIST ALTRET( JUSTALT );
      332    16193    1       ELSE CALL FLI_LT_SNLIST;
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:50   
      333    16194
      334    16195    1      SNSIZEW = LENGTHC(SNLIST.NUM#) + SNLIST.NUM# * LENGTHC(SNLIST.SN#(0));
      335    16196    1      SNSIZEW = (SNSIZEW + 3) / 4;
      336    16197
      337    16198    1      RETURN;
      338    16199
      339    16200    1   JUSTALT: ;
      340    16201    1      COMMAND_ERROR = '1'B;
      341    16202    1      ALTRETURN;
      342    16203
      343    16204        /****************************************/
      344    16205
      345    16206    1   FLI_LT_SNLIST: PROC;
      346    16207
      347    16208        /********************/
      348    16209
      349    16210         /***
      350    16211          *** Put each serial number in the VLP_SN.
      351    16212          ***/
      352    16213
      353    16214    2      SNLIST.NUM# = NODE$->OUT$BLK.NSUBLKS;
      354    16215
      355    16216    3      DO SNLISTX = 0 TO SNLIST.NUM# - 1;
      356    16217    3         SNLIST.SN#(SNLISTX) = NODE$->OUT$BLK.SUBLK$(SNLISTX)->OUT$SYM.TEXT;
      357    16218    3         END;
      358    16219
      359    16220    2      RETURN;
      360    16221
      361    16222    2   END FLI_LT_SNLIST;
      362    16223
      363    16224        /****************************************/
      364    16225
      365    16226    1   FLI_CT_SNLIST: PROC ALTRET;
      366    16227
      367    16228        /********************/
      368    16229
      369    16230         /***
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:51   
      370    16231          *** Determine if CT#xxxxn/CD#xxxxn or CT#xxxxnn/CD#xxxxnn based on number of
      371    16232          *** characters.
      372    16233          ***/
      373    16234
      374    16235    2      SNLISTX = 0;
      375    16236    2      SUBLK$ = NODE$->OUT$BLK.SUBLK$(0);
      376    16237    2      IF SUBLK$->OUT$SYM.COUNT = LENGTHC('xxxxn')
      377    16238    3       THEN DO;                            /* CT#xxxxn or CD#xxxxn               */
      378    16239    3         CT5FMTCHARS = SUBLK$->OUT$SYM.TEXT;
      379    16240    3         CT_IMAGE = CT5FMT.XXXX;
      380    16241    3         IF CT5FMT.NUBIN > ASCBIN('9') OR CT5FMT.NUBIN < ASCBIN('0')
      381    16242    4          THEN DO;
      382    16243    4            IF NODE$->OUT$BLK.CODE = %CT_VOL_SET
      383    16244    4             THEN CALL FLI$RPT_ERR( E_BADCT, );
      384    16245    4             ELSE CALL FLI$RPT_ERR( E_BADCD, );
      385    16246    4            ALTRETURN;
      386    16247    4            END;
      387    16248    4         DO N = CT5FMT.NUBIN TO ASCBIN('9');
      388    16249    4            CT5FMT.NUBIN = N;
      389    16250    4            SNLIST.SN#(SNLISTX) = CT5FMTCHARS;
      390    16251    4            SNLISTX = SNLISTX + 1;
      391    16252    4            END;
      392    16253    3         END;
      393    16254    3       ELSE DO;                            /* CT#xxxxnn or CD#xxxxnn             */
      394    16255    3         IF SUBLK$->OUT$SYM.COUNT ~= LENGTHC('xxxxnn')
      395    16256    4          THEN DO;
      396    16257    4            IF NODE$->OUT$BLK.CODE = %CT_VOL_SET
      397    16258    4             THEN CALL FLI$RPT_ERR( E_BADCT, );
      398    16259    4             ELSE CALL FLI$RPT_ERR( E_BADCD, );
      399    16260    4            ALTRETURN;
      400    16261    4            END;
      401    16262    3         CT6FMTCHARS = SUBLK$->OUT$SYM.TEXT;
      402    16263    3         CT_IMAGE = CT6FMT.XXXX;
      403    16264    3         IF CT6FMT.NNUBIN.N1 >ASCBIN('9') OR CT6FMT.NNUBIN.N1 < ASCBIN('0')
      404    16265    3           OR CT6FMT.NNUBIN.N2 >ASCBIN('9') OR CT6FMT.NNUBIN.N2 < ASCBIN('0')
      405    16266    4          THEN DO;
      406    16267    4            IF NODE$->OUT$BLK.CODE = %CT_VOL_SET
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:52   
      407    16268    4             THEN CALL FLI$RPT_ERR( E_BADCT, );
      408    16269    4             ELSE CALL FLI$RPT_ERR( E_BADCD, );
      409    16270    4            ALTRETURN;
      410    16271    4            END;
      411    16272    3         CALL CHARBIN( NN, CT6FMT.NN );
      412    16273    4         DO N = NN TO 99;
      413    16274    4            CALL BINCHAR( CT6FMT.NN, N );
      414    16275    4            SNLIST.SN#(SNLISTX) = CT6FMTCHARS;
      415    16276    4            SNLISTX = SNLISTX + 1;
      416    16277    4            END;
      417    16278    3         END;
      418    16279    2      SNLIST.NUM# = SNLISTX;
      419    16280    2      RETURN;
      420    16281
      421    16282    2   END FLI_CT_SNLIST;
      422    16283
      423    16284    1   END FLI$SNLIST_NODE;
      424    16285        %EOD;

PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:53   
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FL_PERR_C.:E05TOU  is referenced.
   FLE_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLI$SNLIST_NODE.

   Procedure FLI$SNLIST_NODE requires 193 words for executable code.
   Procedure FLI$SNLIST_NODE requires 16 words of local(AUTO) storage.

PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:54   

 Object Unit name= FLI$SNLIST_NODE                            File name= FLI$NODE.:E05TOU
 UTS= JUL 29 '97 15:52:43.48 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$PRE_RET
    2   Data  even  none     6      6  FLI$SNLIST_NODE
    3  RoData even  UTS      4      4  FLI$SNLIST_NODE
    4   Proc  even  none   193    301  FLI$SNLIST_NODE
    5  RoData even  none     2      2  FLI$SNLIST_NODE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        3  FLI$SNLIST_NODE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       5 FLI$RPT_ERR
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:55   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    E_BADCT                          r    E_BADCD
     TAPE_DCBLIST$                         SNVECLIST$                            COMMAND_ERROR
     DPLIST$                               DPRESLIST$                            DISK_FILE_SPEC$
     SPECCHARS                             EFTWORD                               CT_IMAGE
     M$PRE_RET                             RET_CMDS_NAME                         B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:56   


      259        1        /*T***********************************************************/
      260        2        /*T*                                                         */
      261        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      262        4        /*T*                                                         */
      263        5        /*T***********************************************************/
      264        6        FLI$SNLIST_NODE: PROC( NODE$, SNLIST$, SNSIZEW ) ALTRET;

      6  4 000000   000000 700200 xent  FLI$SNLIST_* TSX0  ! X66_AUTO_3
         4 000001   000020 000003                    ZERO    16,3

      265        7        /*F*  NAME: FLI$SNLIST
      266        8              PURPOSE: Build serial number list VLP from node.
      267        9        */
      268       10
      269       11    1   DCL NODE$ PTR ALIGNED;                  /* To CT_VOL_SET or LT_VOL_SET node   */
      270       12                                                /* To CD_VOL_SET or OD_VOL_SET node   */
      271       13    1   DCL SNLIST$ PTR ALIGNED;                /* Pointer to VLP_SN area             */
      272       14    1   DCL SNSIZEW SBIN ALIGNED;          /* Returned size in words of VLP_SN built  */
      273       15
      274       16         /***
      275       17          *** INCLUDE
      276       18          ***/
      277       19
      278       20        %INCLUDE CP_6;
      279     5579        %INCLUDE FLE_DATA_R;
      280    11530        %INCLUDE FLI_DATA_R;
      281    12944        %INCLUDE XU_MACRO_C;
      282    16050
      283    16051         /***
      284    16052          *** ENTRY
      285    16053          ***/
      286    16054
      287    16055    1   DCL FLI$RPT_ERR ENTRY(5);
      288    16056
      289    16057         /***
      290    16058          *** AUTO
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:57   
      291    16059          ***/
      292    16060
      293    16061    1   DCL 1 CT5FMT AUTO,                      /* CT#xxxxn                           */
      294    16062    1         2 XXXX CHAR(4),
      295    16063    1         2 N CHAR(1),
      296    16064    1         2 NUBIN REDEF N UBIN BYTE CALIGNED;
      297    16065    1   DCL CT5FMTCHARS REDEF CT5FMT CHAR(5);
      298    16066    1   DCL 1 CT6FMT AUTO,                      /* CT#xxxxnn                          */
      299    16067    1         2 XXXX CHAR(4),
      300    16068    1         2 NN CHAR(2),
      301    16069    1         2 NNUBIN REDEF NN,
      302    16070    1           3 N1 UBIN BYTE CALIGNED,
      303    16071    1           3 N2 UBIN BYTE CALIGNED;
      304    16072    1   DCL CT6FMTCHARS REDEF CT6FMT CHAR(6);
      305    16073    1   DCL SNLISTX SBIN AUTO;             /* Index of serial number list structure   */
      306    16074    1   DCL N SBIN AUTO;
      307    16075    1   DCL NN SBIN AUTO;
      308    16076    1   DCL SUBLK$ PTR AUTO;
      309    16077
      310    16078         /***
      311    16079          *** BASED
      312    16080          ***/
      313    16081
      314    16082        %PARSE$OUT( STCLASS=BASED );
      315    16127        %PARSE$SYM( STCLASS=BASED );
      316    16165
      317    16166         /***
      318    16167          *** FPT
      319    16168          ***/
      320    16169
      321    16170        %VLP_SN( FPTN=SNLIST,
      322    16171                 STCLASS="BASED(SNLIST$)" );
      323    16184
      324    16185        /****************************************/
      325    16186
      326    16187         /***
      327    16188          *** Handle CT/CD and LT/OD separately.
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:58   
      328    16189          ***/
      329    16190
      330    16191    1      IF NODE$->OUT$BLK.CODE = %CT_VOL_SET OR NODE$->OUT$BLK.CODE = %CD_VOL_SET

  16191  4 000002   200003 470500                    LDP0    @NODE$,,AUTO
         4 000003   000000 471500                    LDP1    0,,PR0
         4 000004   100000 720100                    LXL0    0,,PR1
         4 000005   000010 600000 4                  TZE     s:16192
         4 000006   000022 100003                    CMPX0   18,DU
         4 000007   000013 601000 4                  TNZ     s:16193

      331    16192    1       THEN CALL FLI_CT_SNLIST ALTRET( JUSTALT );

  16192  4 000010   000072 701000 4                  TSX1    FLI_CT_SNLIST
         4 000011   000030 702000 4                  TSX2    JUSTALT
         4 000012   000015 710000 4                  TRA     s:16195

      332    16193    1       ELSE CALL FLI_LT_SNLIST;

  16193  4 000013   000033 701000 4                  TSX1    FLI_LT_SNLIST
         4 000014   000000 011000                    NOP     0

      333    16194
      334    16195    1      SNSIZEW = LENGTHC(SNLIST.NUM#) + SNLIST.NUM# * LENGTHC(SNLIST.SN#(0));

  16195  4 000015   200004 470500                    LDP0    @SNLIST$,,AUTO
         4 000016   000000 471500                    LDP1    0,,PR0
         4 000017   200005 473500                    LDP3    @SNSIZEW,,AUTO
         4 000020   100000 236100                    LDQ     0,,PR1
         4 000021   000006 402007                    MPY     6,DL
         4 000022   000004 036007                    ADLQ    4,DL
         4 000023   300000 756100                    STQ     0,,PR3

      335    16196    1      SNSIZEW = (SNSIZEW + 3) / 4;

  16196  4 000024   000003 036007                    ADLQ    3,DL
         4 000025   000004 506007                    DIV     4,DL
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:59   
         4 000026   300000 756100                    STQ     0,,PR3

      336    16197
      337    16198    1      RETURN;

  16198  4 000027   000000 702200 xent               TSX2  ! X66_ARET

  16196  4 000030                       JUSTALT      null
      338    16199
      339    16200    1   JUSTALT: ;
      340    16201    1      COMMAND_ERROR = '1'B;

  16201  4 000030   400000 236003                    LDQ     -131072,DU
         4 000031   000000 756000 xsym               STQ     COMMAND_ERROR

      341    16202    1      ALTRETURN;

  16202  4 000032   000000 702200 xent               TSX2  ! X66_AALT

      342    16203
      343    16204        /****************************************/
      344    16205
      345    16206    1   FLI_LT_SNLIST: PROC;

  16206  4 000033   200016 741300       FLI_LT_SNLI* STX1  ! SUBLK$+1,,AUTO

      346    16207
      347    16208        /********************/
      348    16209
      349    16210         /***
      350    16211          *** Put each serial number in the VLP_SN.
      351    16212          ***/
      352    16213
      353    16214    2      SNLIST.NUM# = NODE$->OUT$BLK.NSUBLKS;

  16214  4 000034   200004 470500                    LDP0    @SNLIST$,,AUTO
         4 000035   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:60   
         4 000036   200003 473500                    LDP3    @NODE$,,AUTO
         4 000037   300000 474500                    LDP4    0,,PR3
         4 000040   400001 236100                    LDQ     1,,PR4
         4 000041   000022 772000                    QRL     18
         4 000042   100000 756100                    STQ     0,,PR1

      354    16215
      355    16216    3      DO SNLISTX = 0 TO SNLIST.NUM# - 1;

  16216  4 000043   200012 450100                    STZ     SNLISTX,,AUTO
         4 000044   000064 710000 4                  TRA     s:16218+1

      356    16217    3         SNLIST.SN#(SNLISTX) = NODE$->OUT$BLK.SUBLK$(SNLISTX)->OUT$SYM.TEXT;

  16217  4 000045   200004 470500                    LDP0    @SNLIST$,,AUTO
         4 000046   000000 471500                    LDP1    0,,PR0
         4 000047   200003 473500                    LDP3    @NODE$,,AUTO
         4 000050   300000 474500                    LDP4    0,,PR3
         4 000051   200012 720100                    LXL0    SNLISTX,,AUTO
         4 000052   400003 475510                    LDP5    3,X0,PR4
         4 000053   500004 236100                    LDQ     4,,PR5
         4 000054   000033 772000                    QRL     27
         4 000055   000000 621006                    EAX1    0,QL
         4 000056   200012 236100                    LDQ     SNLISTX,,AUTO
         4 000057   000006 402007                    MPY     6,DL
         4 000060   040106 100540                    MLR     fill='040'O
         4 000061   500004 200011                    ADSC9   4,,PR5                   cn=1,n=*X1
         4 000062   100001 000006                    ADSC9   1,Q,PR1                  cn=0,n=6

      357    16218    3         END;

  16218  4 000063   200012 054100                    AOS     SNLISTX,,AUTO
         4 000064   000000 471500                    LDP1    0,,PR0
         4 000065   200012 236100                    LDQ     SNLISTX,,AUTO
         4 000066   100000 116100                    CMPQ    0,,PR1
         4 000067   000045 604000 4                  TMI     s:16217

PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:61   
      358    16219
      359    16220    2      RETURN;

  16220  4 000070   200016 221300                    LDX1  ! SUBLK$+1,,AUTO
         4 000071   000001 702211                    TSX2  ! 1,X1

      360    16221
      361    16222    2   END FLI_LT_SNLIST;
      362    16223
      363    16224        /****************************************/
      364    16225
      365    16226    1   FLI_CT_SNLIST: PROC ALTRET;

  16226  4 000072   200016 741300       FLI_CT_SNLI* STX1  ! SUBLK$+1,,AUTO

      366    16227
      367    16228        /********************/
      368    16229
      369    16230         /***
      370    16231          *** Determine if CT#xxxxn/CD#xxxxn or CT#xxxxnn/CD#xxxxnn based on number of
      371    16232          *** characters.
      372    16233          ***/
      373    16234
      374    16235    2      SNLISTX = 0;

  16235  4 000073   200012 450100                    STZ     SNLISTX,,AUTO

      375    16236    2      SUBLK$ = NODE$->OUT$BLK.SUBLK$(0);

  16236  4 000074   200003 470500                    LDP0    @NODE$,,AUTO
         4 000075   000000 471500                    LDP1    0,,PR0
         4 000076   100003 236100                    LDQ     3,,PR1
         4 000077   200015 756100                    STQ     SUBLK$,,AUTO

      376    16237    2      IF SUBLK$->OUT$SYM.COUNT = LENGTHC('xxxxn')

  16237  4 000100   200015 473500                    LDP3    SUBLK$,,AUTO
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:62   
         4 000101   300004 236100                    LDQ     4,,PR3
         4 000102   777000 376003                    ANQ     -512,DU
         4 000103   005000 116003                    CMPQ    2560,DU
         4 000104   000165 601000 4                  TNZ     s:16255

      377    16238    3       THEN DO;                            /* CT#xxxxn or CD#xxxxn               */

      378    16239    3         CT5FMTCHARS = SUBLK$->OUT$SYM.TEXT;

  16239  4 000105   300004 236100                    LDQ     4,,PR3
         4 000106   000033 772000                    QRL     27
         4 000107   000000 620006                    EAX0    0,QL
         4 000110   040100 100540                    MLR     fill='040'O
         4 000111   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         4 000112   200006 000005                    ADSC9   CT5FMT,,AUTO             cn=0,n=5

      379    16240    3         CT_IMAGE = CT5FMT.XXXX;

  16240  4 000113   200006 236100                    LDQ     CT5FMT,,AUTO
         4 000114   000000 756000 xsym               STQ     CT_IMAGE

      380    16241    3         IF CT5FMT.NUBIN > ASCBIN('9') OR CT5FMT.NUBIN < ASCBIN('0')

  16241  4 000115   200007 236100                    LDQ     CT5FMT+1,,AUTO
         4 000116   777000 376003                    ANQ     -512,DU
         4 000117   072000 116003                    CMPQ    29696,DU
         4 000120   000123 603000 4                  TRC     s:16243
         4 000121   060000 116003                    CMPQ    24576,DU
         4 000122   000141 603000 4                  TRC     s:16248

      381    16242    4          THEN DO;

      382    16243    4            IF NODE$->OUT$BLK.CODE = %CT_VOL_SET

  16243  4 000123   000000 471500                    LDP1    0,,PR0
         4 000124   100000 722100                    LXL2    0,,PR1
         4 000125   000133 601000 4                  TNZ     s:16245
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:63   

      383    16244    4             THEN CALL FLI$RPT_ERR( E_BADCT, );

  16244  4 000126   000000 630400 5                  EPPR0   0
         4 000127   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000130   000000 701000 xent               TSX1    FLI$RPT_ERR
         4 000131   000000 011000                    NOP     0
         4 000132   000137 710000 4                  TRA     s:16246

      384    16245    4             ELSE CALL FLI$RPT_ERR( E_BADCD, );

  16245  4 000133   000001 630400 5                  EPPR0   1
         4 000134   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000135   000000 701000 xent               TSX1    FLI$RPT_ERR
         4 000136   000000 011000                    NOP     0

      385    16246    4            ALTRETURN;

  16246  4 000137   200016 221300                    LDX1  ! SUBLK$+1,,AUTO
         4 000140   000000 702211                    TSX2  ! 0,X1

      386    16247    4            END;
      387    16248    4         DO N = CT5FMT.NUBIN TO ASCBIN('9');

  16248  4 000141   200007 236100                    LDQ     CT5FMT+1,,AUTO
         4 000142   000033 772000                    QRL     27
         4 000143   200013 756100                    STQ     N,,AUTO
         4 000144   000161 710000 4                  TRA     s:16252+1

      388    16249    4            CT5FMT.NUBIN = N;

  16249  4 000145   200013 236100                    LDQ     N,,AUTO
         4 000146   000033 736000                    QLS     27
         4 000147   200007 552140                    STBQ    CT5FMT+1,'40'O,AUTO

      389    16250    4            SNLIST.SN#(SNLISTX) = CT5FMTCHARS;

PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:64   
  16250  4 000150   200004 470500                    LDP0    @SNLIST$,,AUTO
         4 000151   000000 471500                    LDP1    0,,PR0
         4 000152   200012 236100                    LDQ     SNLISTX,,AUTO
         4 000153   000006 402007                    MPY     6,DL
         4 000154   040106 100500                    MLR     fill='040'O
         4 000155   200006 000005                    ADSC9   CT5FMT,,AUTO             cn=0,n=5
         4 000156   100001 000006                    ADSC9   1,Q,PR1                  cn=0,n=6

      390    16251    4            SNLISTX = SNLISTX + 1;

  16251  4 000157   200012 054100                    AOS     SNLISTX,,AUTO

      391    16252    4            END;

  16252  4 000160   200013 054100                    AOS     N,,AUTO
         4 000161   200013 235100                    LDA     N,,AUTO
         4 000162   000071 115007                    CMPA    57,DL
         4 000163   000145 604400 4                  TMOZ    s:16249

      392    16253    3         END;

  16253  4 000164   000273 710000 4                  TRA     s:16279

      393    16254    3       ELSE DO;                            /* CT#xxxxnn or CD#xxxxnn             */

      394    16255    3         IF SUBLK$->OUT$SYM.COUNT ~= LENGTHC('xxxxnn')

  16255  4 000165   006000 116003                    CMPQ    3072,DU
         4 000166   000204 600000 4                  TZE     s:16262

      395    16256    4          THEN DO;

      396    16257    4            IF NODE$->OUT$BLK.CODE = %CT_VOL_SET

  16257  4 000167   100000 720100                    LXL0    0,,PR1
         4 000170   000176 601000 4                  TNZ     s:16259

PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:65   
      397    16258    4             THEN CALL FLI$RPT_ERR( E_BADCT, );

  16258  4 000171   000000 630400 5                  EPPR0   0
         4 000172   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000173   000000 701000 xent               TSX1    FLI$RPT_ERR
         4 000174   000000 011000                    NOP     0
         4 000175   000202 710000 4                  TRA     s:16260

      398    16259    4             ELSE CALL FLI$RPT_ERR( E_BADCD, );

  16259  4 000176   000001 630400 5                  EPPR0   1
         4 000177   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000200   000000 701000 xent               TSX1    FLI$RPT_ERR
         4 000201   000000 011000                    NOP     0

      399    16260    4            ALTRETURN;

  16260  4 000202   200016 221300                    LDX1  ! SUBLK$+1,,AUTO
         4 000203   000000 702211                    TSX2  ! 0,X1

      400    16261    4            END;
      401    16262    3         CT6FMTCHARS = SUBLK$->OUT$SYM.TEXT;

  16262  4 000204   300004 236100                    LDQ     4,,PR3
         4 000205   000033 772000                    QRL     27
         4 000206   000000 620006                    EAX0    0,QL
         4 000207   040100 100540                    MLR     fill='040'O
         4 000210   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         4 000211   200010 000006                    ADSC9   CT6FMT,,AUTO             cn=0,n=6

      402    16263    3         CT_IMAGE = CT6FMT.XXXX;

  16263  4 000212   200010 236100                    LDQ     CT6FMT,,AUTO
         4 000213   000000 756000 xsym               STQ     CT_IMAGE

      403    16264    3         IF CT6FMT.NNUBIN.N1 >ASCBIN('9') OR CT6FMT.NNUBIN.N1 < ASCBIN('0')

PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:66   
  16264  4 000214   200011 236100                    LDQ     CT6FMT+1,,AUTO
         4 000215   777000 376003                    ANQ     -512,DU
         4 000216   072000 116003                    CMPQ    29696,DU
         4 000217   000230 603000 4                  TRC     s:16267
         4 000220   060000 116003                    CMPQ    24576,DU
         4 000221   000230 602000 4                  TNC     s:16267
         4 000222   200011 236100                    LDQ     CT6FMT+1,,AUTO
         4 000223   000777 376003                    ANQ     511,DU
         4 000224   000072 116003                    CMPQ    58,DU
         4 000225   000230 603000 4                  TRC     s:16267
         4 000226   000060 116003                    CMPQ    48,DU
         4 000227   000246 603000 4                  TRC     s:16272

      404    16265    3           OR CT6FMT.NNUBIN.N2 >ASCBIN('9') OR CT6FMT.NNUBIN.N2 < ASCBIN('0')
      405    16266    4          THEN DO;

      406    16267    4            IF NODE$->OUT$BLK.CODE = %CT_VOL_SET

  16267  4 000230   000000 471500                    LDP1    0,,PR0
         4 000231   100000 722100                    LXL2    0,,PR1
         4 000232   000240 601000 4                  TNZ     s:16269

      407    16268    4             THEN CALL FLI$RPT_ERR( E_BADCT, );

  16268  4 000233   000000 630400 5                  EPPR0   0
         4 000234   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000235   000000 701000 xent               TSX1    FLI$RPT_ERR
         4 000236   000000 011000                    NOP     0
         4 000237   000244 710000 4                  TRA     s:16270

      408    16269    4             ELSE CALL FLI$RPT_ERR( E_BADCD, );

  16269  4 000240   000001 630400 5                  EPPR0   1
         4 000241   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000242   000000 701000 xent               TSX1    FLI$RPT_ERR
         4 000243   000000 011000                    NOP     0

PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:67   
      409    16270    4            ALTRETURN;

  16270  4 000244   200016 221300                    LDX1  ! SUBLK$+1,,AUTO
         4 000245   000000 702211                    TSX2  ! 0,X1

      410    16271    4            END;
      411    16272    3         CALL CHARBIN( NN, CT6FMT.NN );

  16272  4 000246   000100 305500                    DTB
         4 000247   200011 030002                    NDSC9   CT6FMT+1,,AUTO           cn=0,s=nosgn,sf=0,n=2
         4 000250   200014 000004                    NDSC9   NN,,AUTO                 cn=0,s=lsgnf,sf=0,n=4

      412    16273    4         DO N = NN TO 99;

  16273  4 000251   200014 235100                    LDA     NN,,AUTO
         4 000252   200013 755100                    STA     N,,AUTO
         4 000253   000270 710000 4                  TRA     s:16277+1

      413    16274    4            CALL BINCHAR( CT6FMT.NN, N );

  16274  4 000254   000100 301500                    BTD
         4 000255   200013 000004                    NDSC9   N,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
         4 000256   200011 030002                    NDSC9   CT6FMT+1,,AUTO           cn=0,s=nosgn,sf=0,n=2

      414    16275    4            SNLIST.SN#(SNLISTX) = CT6FMTCHARS;

  16275  4 000257   200004 470500                    LDP0    @SNLIST$,,AUTO
         4 000260   000000 471500                    LDP1    0,,PR0
         4 000261   200012 236100                    LDQ     SNLISTX,,AUTO
         4 000262   000006 402007                    MPY     6,DL
         4 000263   040106 100500                    MLR     fill='040'O
         4 000264   200010 000006                    ADSC9   CT6FMT,,AUTO             cn=0,n=6
         4 000265   100001 000006                    ADSC9   1,Q,PR1                  cn=0,n=6

      415    16276    4            SNLISTX = SNLISTX + 1;

  16276  4 000266   200012 054100                    AOS     SNLISTX,,AUTO
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:68   

      416    16277    4            END;

  16277  4 000267   200013 054100                    AOS     N,,AUTO
         4 000270   200013 235100                    LDA     N,,AUTO
         4 000271   000143 115007                    CMPA    99,DL
         4 000272   000254 604400 4                  TMOZ    s:16274

      417    16278    3         END;

      418    16279    2      SNLIST.NUM# = SNLISTX;

  16279  4 000273   200004 470500                    LDP0    @SNLIST$,,AUTO
         4 000274   000000 471500                    LDP1    0,,PR0
         4 000275   200012 236100                    LDQ     SNLISTX,,AUTO
         4 000276   100000 756100                    STQ     0,,PR1

      419    16280    2      RETURN;

  16280  4 000277   200016 221300                    LDX1  ! SUBLK$+1,,AUTO
         4 000300   000001 702211                    TSX2  ! 1,X1
      420    16281
      421    16282    2   END FLI_CT_SNLIST;
      422    16283
      423    16284    1   END FLI$SNLIST_NODE;
      424    16285        %EOD;

PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:69   
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FL_PERR_C.:E05TOU  is referenced.
   FLE_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLI$SNLIST_NODE.
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:70   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @NODE$                     4-0-0/w PTR         r     1 @SNLIST$
     5-0-0/w PTR         r     1 @SNSIZEW                   6-0-0/c STRC(45)    r     1 CT5FMT
     6-0-0/c CHAR(5)     r     1 CT5FMTCHARS               10-0-0/c STRC(54)    r     1 CT6FMT
    10-0-0/c CHAR(6)     r     1 CT6FMTCHARS               13-0-0/w SBIN        r     1 N
    14-0-0/w SBIN        r     1 NN                        *0-0-0/w PTR         r     1 NODE$
    *0-0-0/w PTR         r     1 SNLIST$                   12-0-0/w SBIN        r     1 SNLISTX
    *0-0-0/w SBIN        r     1 SNSIZEW                   15-0-0/w PTR         r     1 SUBLK$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 COMMAND_ERROR              0-0-0/c CHAR(4)     r     1 CT_IMAGE
     0-0-0/w PTR         r     1 DISK_FILE_SPEC$            0-0-0/w PTR         r     1 DPLIST$
     0-0-0/w PTR         r     1 DPRESLIST$                 0-0-0/w STRC        r     1 E_BADCD
     0-0-0/w STRC        r     1 E_BADCT                    0-0-0/c ASTR(9)     r     1 RET_CMDS_NAME
     0-0-0/w PTR         r     1 SNVECLIST$                 0-0-0/w PTR         r     1 TAPE_DCBLIST$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/d STRC(90)    r     1 SNLIST


   Procedure FLI$SNLIST_NODE requires 193 words for executable code.
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:71   
   Procedure FLI$SNLIST_NODE requires 16 words of local(AUTO) storage.
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:72   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:73   
          MINI XREF LISTING

COMMAND_ERROR
     12461**DCL     16201<<ASSIGN
CT5FMT
     16061**DCL     16065--REDEF
CT5FMT.N
     16063**DCL     16064--REDEF
CT5FMT.NUBIN
     16064**DCL     16241>>IF      16241>>IF      16248>>DOINDEX 16249<<ASSIGN
CT5FMT.XXXX
     16062**DCL     16240>>ASSIGN
CT5FMTCHARS
     16065**DCL     16239<<ASSIGN  16250>>ASSIGN
CT6FMT
     16066**DCL     16072--REDEF
CT6FMT.NN
     16068**DCL     16069--REDEF   16272>>CALLBLT 16274<<CALLBLT
CT6FMT.NNUBIN.N1
     16070**DCL     16264>>IF      16264>>IF
CT6FMT.NNUBIN.N2
     16071**DCL     16264>>IF      16264>>IF
CT6FMT.XXXX
     16067**DCL     16263>>ASSIGN
CT6FMTCHARS
     16072**DCL     16262<<ASSIGN  16275>>ASSIGN
CT_IMAGE
     12631**DCL     16240<<ASSIGN  16263<<ASSIGN
DISK_CLOSE.SN_
     12141**DCL     12141--REDEF
DISK_CLOSE.UTL_
     12142**DCL     12142--REDEF
DISK_CLOSE.V.EXPIRE#
     12156**DCL     12156--REDEF
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:74   
DISK_CLOSE.V.TYPE#
     12154**DCL     12154--REDEF
DISK_CLOSE.V.XTNSIZE#
     12151**DCL     12151--REDEF   12153--REDEF
DISK_FILE_SPEC.SPEC
     12506**DCL     12508--REDEF
DISK_FILE_SPEC.SPEC.START
     12507**DCL     12507--REDEF
DISK_FILE_SPEC.SPEC.STOP
     12508**DCL     12508--REDEF
DISK_FILE_SPEC$
     12505**DCL     12506--IMP-PTR
DISK_OPEN.ACSVEH_
     12006**DCL     12007--REDEF
DISK_OPEN.ALTKEYS_
     12012**DCL     12013--REDEF   12013--REDEF
DISK_OPEN.HDR_
     12011**DCL     12012--REDEF
DISK_OPEN.TAB_
     12010**DCL     12011--REDEF
DISK_OPEN.UHL_
     12004**DCL     12005--REDEF   12005--REDEF
DISK_OPEN.V.FSN#
     12044**DCL     12044--REDEF   12044--REDEF
DISK_OPEN.WSN_
     12010**DCL     12010--REDEF
DISK_READ.STATION_
     12068**DCL     12069--REDEF
DISK_READ.V.DVBYTE.REREAD#
     12080**DCL     12080--REDEF
DISK_READ.V.INDX#
     12078**DCL     12078--REDEF
DISK_WRITE.STATION_
     12106**DCL     12106--REDEF
DISK_WRITE.V.DVBYTE.VFC#
     12113**DCL     12113--REDEF
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:75   
DPLIST$
     12491**DCL     12503--IMP-PTR
DPRESLIST$
     12505**DCL     12505--IMP-PTR
EFTWORD
     12626**DCL     12626--REDEF
E_BADCD
      5781**DCL     16245<>CALL    16259<>CALL    16269<>CALL
E_BADCT
      5736**DCL     16244<>CALL    16258<>CALL    16268<>CALL
FLI$RPT_ERR
     16055**DCL-ENT 16244--CALL    16245--CALL    16258--CALL    16259--CALL    16268--CALL    16269--CALL
FLI_CT_SNLIST
     16226**PROC    16192--CALL
FLI_LT_SNLIST
     16206**PROC    16193--CALL
FPT_EXIT.V.STEPCC#
     11931**DCL     11931--REDEF
JUSTALT
     16196**LABEL   16192--CALLALT
N
     16074**DCL     16248<<DOINDEX 16249>>ASSIGN  16273<<DOINDEX 16274>>CALLBLT
NN
     16075**DCL     16272<<CALLBLT 16273>>DOINDEX
NODE$
        11**DCL         6--PROC    16191>>IF      16191>>IF      16214>>ASSIGN  16217>>ASSIGN  16217>>ASSIGN
     16236>>ASSIGN  16243>>IF      16257>>IF      16267>>IF
OUT$BLK.CODE
     16096**DCL     16191>>IF      16191>>IF      16243>>IF      16257>>IF      16267>>IF
OUT$BLK.NSUBLKS
     16100**DCL     16214>>ASSIGN
OUT$BLK.SUBLK$
     16121**DCL     16217>>ASSIGN  16217>>ASSIGN  16236>>ASSIGN
OUT$SYM.COUNT
     16157**DCL     16160--IMP-SIZ 16217>>ASSIGN  16237>>IF      16239>>ASSIGN  16255>>IF      16262>>ASSIGN
OUT$SYM.TEXT
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:76   
     16160**DCL     16217>>ASSIGN  16239>>ASSIGN  16262>>ASSIGN
PRE_RET_CLOSE.SN_
     12869**DCL     12869--REDEF
PRE_RET_CLOSE.UTL_
     12870**DCL     12870--REDEF
PRE_RET_CLOSE.V.EXPIRE#
     12884**DCL     12884--REDEF
PRE_RET_CLOSE.V.TYPE#
     12882**DCL     12882--REDEF
PRE_RET_CLOSE.V.XTNSIZE#
     12879**DCL     12879--REDEF   12881--REDEF
PRE_RET_OPEN.ACSVEH_
     12804**DCL     12805--REDEF
PRE_RET_OPEN.ALTKEYS_
     12810**DCL     12811--REDEF   12811--REDEF
PRE_RET_OPEN.HDR_
     12809**DCL     12810--REDEF
PRE_RET_OPEN.TAB_
     12808**DCL     12809--REDEF
PRE_RET_OPEN.UHL_
     12802**DCL     12803--REDEF   12803--REDEF
PRE_RET_OPEN.V.FSN#
     12842**DCL     12842--REDEF   12842--REDEF
PRE_RET_OPEN.WSN_
     12808**DCL     12808--REDEF
PRE_RET_READ.STATION_
     12659**DCL     12660--REDEF
PRE_RET_READ.V.DVBYTE.REREAD#
     12671**DCL     12671--REDEF
PRE_RET_READ.V.INDX#
     12669**DCL     12669--REDEF
PRE_RET_WRITE.STATION_
     12697**DCL     12697--REDEF
PRE_RET_WRITE.V.DVBYTE.VFC#
     12704**DCL     12704--REDEF
RET_CMDS_NAME.L#
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:77   
     12913**DCL     12913--IMP-SIZ
SNLIST.NUM#
     16182**DCL     16195>>ASSIGN  16195--ASSIGN  16214<<ASSIGN  16216>>DOINDEX 16279<<ASSIGN
SNLIST.SN#
     16182**DCL     16195--ASSIGN  16217<<ASSIGN  16250<<ASSIGN  16275<<ASSIGN
SNLIST$
        13**DCL         6--PROC    16182--IMP-PTR 16195>>ASSIGN  16214>>ASSIGN  16216>>DOINDEX 16217>>ASSIGN
     16250>>ASSIGN  16275>>ASSIGN  16279>>ASSIGN
SNLISTX
     16073**DCL     16216<<DOINDEX 16217>>ASSIGN  16217>>ASSIGN  16217>>ASSIGN  16235<<ASSIGN  16250>>ASSIGN
     16251<<ASSIGN  16251>>ASSIGN  16275>>ASSIGN  16276<<ASSIGN  16276>>ASSIGN  16279>>ASSIGN
SNSIZEW
        14**DCL         6--PROC    16195<<ASSIGN  16196<<ASSIGN  16196>>ASSIGN
SNVECLIST$
     12445**DCL     12445--IMP-PTR
SPEC.START
     12509**DCL     12510--REDEF
SPEC.STOP
     12510**DCL     12511--REDEF
SPECCHARS
     12509**DCL     12509--REDEF
SUBLK$
     16076**DCL     16236<<ASSIGN  16237>>IF      16239>>ASSIGN  16239>>ASSIGN  16255>>IF      16262>>ASSIGN
     16262>>ASSIGN
TAPE_CLOSE.SN_
     12362**DCL     12362--REDEF
TAPE_CLOSE.UTL_
     12363**DCL     12363--REDEF
TAPE_CLOSE.V.EXPIRE#
     12377**DCL     12377--REDEF
TAPE_CLOSE.V.TYPE#
     12375**DCL     12375--REDEF
TAPE_CLOSE.V.XTNSIZE#
     12372**DCL     12372--REDEF   12374--REDEF
TAPE_DCBLIST$
     11918**DCL     11918--IMP-PTR
PL6.E3A0      #002=FLI$SNLIST_NODE File=FLI$NODE.:E05TSI                         TUE 07/29/97 15:52 Page:78   
TAPE_OPEN.ACSVEH_
     12227**DCL     12228--REDEF
TAPE_OPEN.ALTKEYS_
     12233**DCL     12234--REDEF   12234--REDEF
TAPE_OPEN.HDR_
     12232**DCL     12233--REDEF
TAPE_OPEN.TAB_
     12231**DCL     12232--REDEF
TAPE_OPEN.UHL_
     12225**DCL     12226--REDEF   12226--REDEF
TAPE_OPEN.V.FSN#
     12265**DCL     12265--REDEF   12265--REDEF
TAPE_OPEN.WSN_
     12231**DCL     12231--REDEF
TAPE_READ.STATION_
     12289**DCL     12290--REDEF
TAPE_READ.V.DVBYTE.REREAD#
     12301**DCL     12301--REDEF
TAPE_READ.V.INDX#
     12299**DCL     12299--REDEF
TAPE_WRITE.STATION_
     12327**DCL     12327--REDEF
TAPE_WRITE.V.DVBYTE.VFC#
     12334**DCL     12334--REDEF
TVECTOR.W2
     12458**DCL     12459--REDEF

PL6.E3A0      #003=FLI$USE_SNLIST_NODE File=FLI$NODE.:E05TSI                     TUE 07/29/97 15:53 Page:79   
      425        1        /*T***********************************************************/
      426        2        /*T*                                                         */
      427        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      428        4        /*T*                                                         */
      429        5        /*T***********************************************************/
      430        6        FLI$USE_SNLIST_NODE: PROC( NODE$ ) ALTRET;
      431        7        /*F*  NAME: FLI$USE_SNLIST
      432        8              PURPOSE: Inform I/O routines which serial number lists to use.
      433        9         */
      434       10
      435       11    1   DCL NODE$ PTR ALIGNED;                  /* To CT_VOL_SET or LT_VOL_SET node   */
      436       12                                                /* To CD_VOL_SET or OD_VOL_SET node   */
      437       13
      438       14         /***
      439       15          *** INCLUDE
      440       16          ***/
      441       17
      442       18        %INCLUDE CP_6;
      443     5577        %INCLUDE FLI_DATA_R;
      444     6991
      445     6992         /***
      446     6993          *** ENTRY
      447     6994          ***/
      448     6995
      449     6996    1   DCL FLI$SNLIST_NODE ENTRY(3) ALTRET; /* Builds serial number list from text   */
      450     6997    1   DCL FLI$ALLOC ENTRY(2);                 /* Get memory                         */
      451     6998
      452     6999         /***
      453     7000          *** AUTO
      454     7001          ***/
      455     7002
      456     7003    1   DCL SNSIZEW SBIN AUTO;        /* Number of words in built serial number list  */
      457     7004    1   DCL SNLIST$ PTR ALIGNED AUTO;           /* Pointer to serial number list      */
      458     7005    1   DCL SNLISTINFO$ PTR ALIGNED AUTO;       /* Pointer to serial number list info */
      459     7006
      460     7007         /***
      461     7008          *** BASED
PL6.E3A0      #003=FLI$USE_SNLIST_NODE File=FLI$NODE.:E05TSI                     TUE 07/29/97 15:53 Page:80   
      462     7009          ***/
      463     7010
      464     7011        %SNLISTINFO( STCLASS="BASED(SNLISTINFO$)" );
      465     7014
      466     7015        /***************************************/
      467     7016
      468     7017         /***
      469     7018          *** Allocate memory and build serial number list.
      470     7019          ***/
      471     7020
      472     7021    1      CALL FLI$ALLOC( %MAX_SNSIZEW, SNLIST$ );
      473     7022    1      CALL FLI$SNLIST_NODE( NODE$, SNLIST$, SNSIZEW ) ALTRET( JUSTALT );
      474     7023    1      CALL FLI$ALLOC( SNSIZEW-%MAX_SNSIZEW );
      475     7024
      476     7025    1      NBR_SNLISTS = NBR_SNLISTS + 1;
      477     7026    1      CALL FLI$ALLOC( SIZEW(SNLISTINFO), SNLISTINFO$ );
      478     7027
      479     7028    1      SNLISTINFO.SNLIST$ = SNLIST$;
      480     7029    1      SNLISTINFO.PREVINFO$ = LAST_SNLISTINFO$;
      481     7030    1      LAST_SNLISTINFO$ = SNLISTINFO$;
      482     7031    1      RETURN;
      483     7032
      484     7033    1   JUSTALT: ;
      485     7034    1      ALTRETURN;
      486     7035
      487     7036    1   END FLI$USE_SNLIST_NODE;
      488     7037        %EOD;

PL6.E3A0      #003=FLI$USE_SNLIST_NODE File=FLI$NODE.:E05TSI                     TUE 07/29/97 15:53 Page:81   
--  Include file information  --

   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLI$USE_SNLIST_NODE.

   Procedure FLI$USE_SNLIST_NODE requires 48 words for executable code.
   Procedure FLI$USE_SNLIST_NODE requires 12 words of local(AUTO) storage.

PL6.E3A0      #003=FLI$USE_SNLIST_NODE File=FLI$NODE.:E05TSI                     TUE 07/29/97 15:53 Page:82   

 Object Unit name= FLI$USE_SNLIST_NODE                        File name= FLI$NODE.:E05TOU
 UTS= JUL 29 '97 15:53:21.28 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$PRE_RET
    2   Data  even  none     6      6  FLI$USE_SNLIST_NODE
    3   Proc  even  none    48     60  FLI$USE_SNLIST_NODE
    4  RoData even  none     3      3  FLI$USE_SNLIST_NODE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        1  FLI$USE_SNLIST_NODE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 FLI$ALLOC
 yes     yes           Std       3 FLI$SNLIST_NODE
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #003=FLI$USE_SNLIST_NODE File=FLI$NODE.:E05TSI                     TUE 07/29/97 15:53 Page:83   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  LAST_SNLISTINFO$                      NBR_SNLISTS
     TAPE_DCBLIST$                         SNVECLIST$                            DPLIST$
     DPRESLIST$                            DISK_FILE_SPEC$                       SPECCHARS
     EFTWORD                               M$PRE_RET                             RET_CMDS_NAME
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #003=FLI$USE_SNLIST_NODE File=FLI$NODE.:E05TSI                     TUE 07/29/97 15:53 Page:84   


      425        1        /*T***********************************************************/
      426        2        /*T*                                                         */
      427        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      428        4        /*T*                                                         */
      429        5        /*T***********************************************************/
      430        6        FLI$USE_SNLIST_NODE: PROC( NODE$ ) ALTRET;

      6  3 000000   000000 700200 xent  FLI$USE_SNL* TSX0  ! X66_AUTO_1
         3 000001   000014 000001                    ZERO    12,1

      431        7        /*F*  NAME: FLI$USE_SNLIST
      432        8              PURPOSE: Inform I/O routines which serial number lists to use.
      433        9         */
      434       10
      435       11    1   DCL NODE$ PTR ALIGNED;                  /* To CT_VOL_SET or LT_VOL_SET node   */
      436       12                                                /* To CD_VOL_SET or OD_VOL_SET node   */
      437       13
      438       14         /***
      439       15          *** INCLUDE
      440       16          ***/
      441       17
      442       18        %INCLUDE CP_6;
      443     5577        %INCLUDE FLI_DATA_R;
      444     6991
      445     6992         /***
      446     6993          *** ENTRY
      447     6994          ***/
      448     6995
      449     6996    1   DCL FLI$SNLIST_NODE ENTRY(3) ALTRET; /* Builds serial number list from text   */
      450     6997    1   DCL FLI$ALLOC ENTRY(2);                 /* Get memory                         */
      451     6998
      452     6999         /***
      453     7000          *** AUTO
      454     7001          ***/
      455     7002
      456     7003    1   DCL SNSIZEW SBIN AUTO;        /* Number of words in built serial number list  */
PL6.E3A0      #003=FLI$USE_SNLIST_NODE File=FLI$NODE.:E05TSI                     TUE 07/29/97 15:53 Page:85   
      457     7004    1   DCL SNLIST$ PTR ALIGNED AUTO;           /* Pointer to serial number list      */
      458     7005    1   DCL SNLISTINFO$ PTR ALIGNED AUTO;       /* Pointer to serial number list info */
      459     7006
      460     7007         /***
      461     7008          *** BASED
      462     7009          ***/
      463     7010
      464     7011        %SNLISTINFO( STCLASS="BASED(SNLISTINFO$)" );
      465     7014
      466     7015        /***************************************/
      467     7016
      468     7017         /***
      469     7018          *** Allocate memory and build serial number list.
      470     7019          ***/
      471     7020
      472     7021    1      CALL FLI$ALLOC( %MAX_SNSIZEW, SNLIST$ );

   7021  3 000002   200005 630500                    EPPR0   SNLIST$,,AUTO
         3 000003   200011 450500                    STP0    SNLISTINFO$+3,,AUTO
         3 000004   000001 236000 4                  LDQ     1
         3 000005   200010 756100                    STQ     SNLISTINFO$+2,,AUTO
         3 000006   200010 630500                    EPPR0   SNLISTINFO$+2,,AUTO
         3 000007   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000010   000000 701000 xent               TSX1    FLI$ALLOC
         3 000011   000000 011000                    NOP     0

      473     7022    1      CALL FLI$SNLIST_NODE( NODE$, SNLIST$, SNSIZEW ) ALTRET( JUSTALT );

   7022  3 000012   200004 630500                    EPPR0   SNSIZEW,,AUTO
         3 000013   200012 450500                    STP0    SNLISTINFO$+4,,AUTO
         3 000014   200005 631500                    EPPR1   SNLIST$,,AUTO
         3 000015   200011 451500                    STP1    SNLISTINFO$+3,,AUTO
         3 000016   200003 236100                    LDQ     @NODE$,,AUTO
         3 000017   200010 756100                    STQ     SNLISTINFO$+2,,AUTO
         3 000020   200010 630500                    EPPR0   SNLISTINFO$+2,,AUTO
         3 000021   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000022   000000 701000 xent               TSX1    FLI$SNLIST_NODE
PL6.E3A0      #003=FLI$USE_SNLIST_NODE File=FLI$NODE.:E05TSI                     TUE 07/29/97 15:53 Page:86   
         3 000023   000057 702000 3                  TSX2    JUSTALT

      474     7023    1      CALL FLI$ALLOC( SNSIZEW-%MAX_SNSIZEW );

   7023  3 000024   200004 235100                    LDA     SNSIZEW,,AUTO
         3 000025   000227 135007                    SBLA    151,DL
         3 000026   200010 755100                    STA     SNLISTINFO$+2,,AUTO
         3 000027   200010 630500                    EPPR0   SNLISTINFO$+2,,AUTO
         3 000030   200011 450500                    STP0    SNLISTINFO$+3,,AUTO
         3 000031   200011 630500                    EPPR0   SNLISTINFO$+3,,AUTO
         3 000032   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000033   000000 701000 xent               TSX1    FLI$ALLOC
         3 000034   000000 011000                    NOP     0

      475     7024
      476     7025    1      NBR_SNLISTS = NBR_SNLISTS + 1;

   7025  3 000035   000000 054000 xsym               AOS     NBR_SNLISTS

      477     7026    1      CALL FLI$ALLOC( SIZEW(SNLISTINFO), SNLISTINFO$ );

   7026  3 000036   200006 630500                    EPPR0   SNLISTINFO$,,AUTO
         3 000037   200011 450500                    STP0    SNLISTINFO$+3,,AUTO
         3 000040   000002 236000 4                  LDQ     2
         3 000041   200010 756100                    STQ     SNLISTINFO$+2,,AUTO
         3 000042   200010 630500                    EPPR0   SNLISTINFO$+2,,AUTO
         3 000043   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000044   000000 701000 xent               TSX1    FLI$ALLOC
         3 000045   000000 011000                    NOP     0

      478     7027
      479     7028    1      SNLISTINFO.SNLIST$ = SNLIST$;

   7028  3 000046   200005 236100                    LDQ     SNLIST$,,AUTO
         3 000047   200006 470500                    LDP0    SNLISTINFO$,,AUTO
         3 000050   000000 756100                    STQ     0,,PR0

PL6.E3A0      #003=FLI$USE_SNLIST_NODE File=FLI$NODE.:E05TSI                     TUE 07/29/97 15:53 Page:87   
      480     7029    1      SNLISTINFO.PREVINFO$ = LAST_SNLISTINFO$;

   7029  3 000051   000000 236000 xsym               LDQ     LAST_SNLISTINFO$
         3 000052   200006 470500                    LDP0    SNLISTINFO$,,AUTO
         3 000053   000001 756100                    STQ     1,,PR0

      481     7030    1      LAST_SNLISTINFO$ = SNLISTINFO$;

   7030  3 000054   200006 236100                    LDQ     SNLISTINFO$,,AUTO
         3 000055   000000 756000 xsym               STQ     LAST_SNLISTINFO$

      482     7031    1      RETURN;

   7031  3 000056   000000 702200 xent               TSX2  ! X66_ARET

   7030  3 000057                       JUSTALT      null
      483     7032
      484     7033    1   JUSTALT: ;
      485     7034    1      ALTRETURN;

   7034  3 000057   000000 702200 xent               TSX2  ! X66_AALT
      486     7035
      487     7036    1   END FLI$USE_SNLIST_NODE;
      488     7037        %EOD;

PL6.E3A0      #003=FLI$USE_SNLIST_NODE File=FLI$NODE.:E05TSI                     TUE 07/29/97 15:53 Page:88   
--  Include file information  --

   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLI$USE_SNLIST_NODE.
PL6.E3A0      #003=FLI$USE_SNLIST_NODE File=FLI$NODE.:E05TSI                     TUE 07/29/97 15:53 Page:89   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @NODE$                    *0-0-0/w PTR         r     1 NODE$
     5-0-0/w PTR         r     1 SNLIST$                    6-0-0/w PTR         r     1 SNLISTINFO$
     4-0-0/w SBIN        r     1 SNSIZEW

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DISK_FILE_SPEC$            0-0-0/w PTR         r     1 DPLIST$
     0-0-0/w PTR         r     1 DPRESLIST$                 0-0-0/w PTR         r     1 LAST_SNLISTINFO$
     0-0-0/w SBIN        r     1 NBR_SNLISTS                0-0-0/c ASTR(9)     r     1 RET_CMDS_NAME
     0-0-0/w PTR         r     1 SNVECLIST$                 0-0-0/w PTR         r     1 TAPE_DCBLIST$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(72)    r     1 SNLISTINFO


   Procedure FLI$USE_SNLIST_NODE requires 48 words for executable code.
   Procedure FLI$USE_SNLIST_NODE requires 12 words of local(AUTO) storage.
PL6.E3A0      #003=FLI$USE_SNLIST_NODE File=FLI$NODE.:E05TSI                     TUE 07/29/97 15:53 Page:90   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=FLI$USE_SNLIST_NODE File=FLI$NODE.:E05TSI                     TUE 07/29/97 15:53 Page:91   
          MINI XREF LISTING

DISK_CLOSE.SN_
      6188**DCL      6188--REDEF
DISK_CLOSE.UTL_
      6189**DCL      6189--REDEF
DISK_CLOSE.V.EXPIRE#
      6203**DCL      6203--REDEF
DISK_CLOSE.V.TYPE#
      6201**DCL      6201--REDEF
DISK_CLOSE.V.XTNSIZE#
      6198**DCL      6198--REDEF    6200--REDEF
DISK_FILE_SPEC.SPEC
      6553**DCL      6555--REDEF
DISK_FILE_SPEC.SPEC.START
      6554**DCL      6554--REDEF
DISK_FILE_SPEC.SPEC.STOP
      6555**DCL      6555--REDEF
DISK_FILE_SPEC$
      6552**DCL      6553--IMP-PTR
DISK_OPEN.ACSVEH_
      6053**DCL      6054--REDEF
DISK_OPEN.ALTKEYS_
      6059**DCL      6060--REDEF    6060--REDEF
DISK_OPEN.HDR_
      6058**DCL      6059--REDEF
DISK_OPEN.TAB_
      6057**DCL      6058--REDEF
DISK_OPEN.UHL_
      6051**DCL      6052--REDEF    6052--REDEF
DISK_OPEN.V.FSN#
      6091**DCL      6091--REDEF    6091--REDEF
DISK_OPEN.WSN_
      6057**DCL      6057--REDEF
PL6.E3A0      #003=FLI$USE_SNLIST_NODE File=FLI$NODE.:E05TSI                     TUE 07/29/97 15:53 Page:92   
DISK_READ.STATION_
      6115**DCL      6116--REDEF
DISK_READ.V.DVBYTE.REREAD#
      6127**DCL      6127--REDEF
DISK_READ.V.INDX#
      6125**DCL      6125--REDEF
DISK_WRITE.STATION_
      6153**DCL      6153--REDEF
DISK_WRITE.V.DVBYTE.VFC#
      6160**DCL      6160--REDEF
DPLIST$
      6538**DCL      6550--IMP-PTR
DPRESLIST$
      6552**DCL      6552--IMP-PTR
EFTWORD
      6673**DCL      6673--REDEF
FLI$ALLOC
      6997**DCL-ENT  7021--CALL     7023--CALL     7026--CALL
FLI$SNLIST_NODE
      6996**DCL-ENT  7022--CALL
FPT_EXIT.V.STEPCC#
      5978**DCL      5978--REDEF
JUSTALT
      7030**LABEL    7022--CALLALT
LAST_SNLISTINFO$
      5961**DCL      7029>>ASSIGN   7030<<ASSIGN
NBR_SNLISTS
      5965**DCL      7025<<ASSIGN   7025>>ASSIGN
NODE$
        11**DCL         6--PROC     7022<>CALL
PRE_RET_CLOSE.SN_
      6916**DCL      6916--REDEF
PRE_RET_CLOSE.UTL_
      6917**DCL      6917--REDEF
PRE_RET_CLOSE.V.EXPIRE#
      6931**DCL      6931--REDEF
PL6.E3A0      #003=FLI$USE_SNLIST_NODE File=FLI$NODE.:E05TSI                     TUE 07/29/97 15:53 Page:93   
PRE_RET_CLOSE.V.TYPE#
      6929**DCL      6929--REDEF
PRE_RET_CLOSE.V.XTNSIZE#
      6926**DCL      6926--REDEF    6928--REDEF
PRE_RET_OPEN.ACSVEH_
      6851**DCL      6852--REDEF
PRE_RET_OPEN.ALTKEYS_
      6857**DCL      6858--REDEF    6858--REDEF
PRE_RET_OPEN.HDR_
      6856**DCL      6857--REDEF
PRE_RET_OPEN.TAB_
      6855**DCL      6856--REDEF
PRE_RET_OPEN.UHL_
      6849**DCL      6850--REDEF    6850--REDEF
PRE_RET_OPEN.V.FSN#
      6889**DCL      6889--REDEF    6889--REDEF
PRE_RET_OPEN.WSN_
      6855**DCL      6855--REDEF
PRE_RET_READ.STATION_
      6706**DCL      6707--REDEF
PRE_RET_READ.V.DVBYTE.REREAD#
      6718**DCL      6718--REDEF
PRE_RET_READ.V.INDX#
      6716**DCL      6716--REDEF
PRE_RET_WRITE.STATION_
      6744**DCL      6744--REDEF
PRE_RET_WRITE.V.DVBYTE.VFC#
      6751**DCL      6751--REDEF
RET_CMDS_NAME.L#
      6960**DCL      6960--IMP-SIZ
SNLIST$
      7004**DCL      7021<>CALL     7022<>CALL     7028>>ASSIGN
SNLISTINFO
      7012**DCL      7026--CALL
SNLISTINFO.PREVINFO$
      7012**DCL      7029<<ASSIGN
PL6.E3A0      #003=FLI$USE_SNLIST_NODE File=FLI$NODE.:E05TSI                     TUE 07/29/97 15:53 Page:94   
SNLISTINFO.SNLIST$
      7012**DCL      7028<<ASSIGN
SNLISTINFO$
      7005**DCL      7012--IMP-PTR  7026<>CALL     7028>>ASSIGN   7029>>ASSIGN   7030>>ASSIGN
SNSIZEW
      7003**DCL      7022<>CALL     7023>>CALL
SNVECLIST$
      6492**DCL      6492--IMP-PTR
SPEC.START
      6556**DCL      6557--REDEF
SPEC.STOP
      6557**DCL      6558--REDEF
SPECCHARS
      6556**DCL      6556--REDEF
TAPE_CLOSE.SN_
      6409**DCL      6409--REDEF
TAPE_CLOSE.UTL_
      6410**DCL      6410--REDEF
TAPE_CLOSE.V.EXPIRE#
      6424**DCL      6424--REDEF
TAPE_CLOSE.V.TYPE#
      6422**DCL      6422--REDEF
TAPE_CLOSE.V.XTNSIZE#
      6419**DCL      6419--REDEF    6421--REDEF
TAPE_DCBLIST$
      5965**DCL      5965--IMP-PTR
TAPE_OPEN.ACSVEH_
      6274**DCL      6275--REDEF
TAPE_OPEN.ALTKEYS_
      6280**DCL      6281--REDEF    6281--REDEF
TAPE_OPEN.HDR_
      6279**DCL      6280--REDEF
TAPE_OPEN.TAB_
      6278**DCL      6279--REDEF
TAPE_OPEN.UHL_
      6272**DCL      6273--REDEF    6273--REDEF
PL6.E3A0      #003=FLI$USE_SNLIST_NODE File=FLI$NODE.:E05TSI                     TUE 07/29/97 15:53 Page:95   
TAPE_OPEN.V.FSN#
      6312**DCL      6312--REDEF    6312--REDEF
TAPE_OPEN.WSN_
      6278**DCL      6278--REDEF
TAPE_READ.STATION_
      6336**DCL      6337--REDEF
TAPE_READ.V.DVBYTE.REREAD#
      6348**DCL      6348--REDEF
TAPE_READ.V.INDX#
      6346**DCL      6346--REDEF
TAPE_WRITE.STATION_
      6374**DCL      6374--REDEF
TAPE_WRITE.V.DVBYTE.VFC#
      6381**DCL      6381--REDEF
TVECTOR.W2
      6505**DCL      6506--REDEF

PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:96   
      489        1        /*T***********************************************************/
      490        2        /*T*                                                         */
      491        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      492        4        /*T*                                                         */
      493        5        /*T***********************************************************/
      494        6        FLI$TSN_USED: PROC( SET_NBR,SNLIST_X ) ALTRET;
      495        7        /*F*  NAME: FLI$TSN_USED
      496        8              PURPOSE: Create serial number list from *TSN_USED
      497        9        */
      498       10
      499       11    1   DCL SET_NBR SBIN;
      500       12    1   DCL SNLIST_X SBIN;                      /* Serial number list index           */
      501       13
      502       14        /***
      503       15         *** INCLUDE
      504       16         ***/
      505       17
      506       18        %INCLUDE B_ERRORS_C;
      507     1145        %INCLUDE CP_6;
      508     6704        %INCLUDE CP_6_SUBS;
      509     7244        %INCLUDE FLI_DATA_R;
      510     8658        %INCLUDE FLS_DATA_R;
      511    10458
      512    10459        /***
      513    10460         *** ENTRY
      514    10461         ***/
      515    10462
      516    10463    1   DCL FLI$RPT_ERR ENTRY(5);
      517    10464    1   DCL FLI$ALLOC ENTRY(2);
      518    10465
      519    10466        /***
      520    10467         *** AUTO
      521    10468         ***/
      522    10469
      523    10470    1   DCL M$TSN_USED$ PTR AUTO;
      524    10471    1   DCL SNLISTX SBIN AUTO;
      525    10472    1   DCL SNLIST$ PTR AUTO;
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:97   
      526    10473    1   DCL SNLIST_END BIT(1) AUTO;
      527    10474    1   DCL I SBIN AUTO;
      528    10475
      529    10476        /***
      530    10477         *** BASED
      531    10478         ***/
      532    10479
      533    10480        %F$DCB( STCLASS="BASED(M$TSN_USED$)" );
      534    10537        %VLP_SN( FPTN=VLP_SN,
      535    10538                 N=1,
      536    10539                 STCLASS="BASED(SNLIST$)" );
      537    10552
      538    10553        /***
      539    10554         *** FPT
      540    10555         ***/
      541    10556
      542    10557        %FPT_REM( FPTN=FPT_REM );
      543    10571
      544    10572        /****************************************/
      545    10573
      546    10574    1      TAPE_OPEN.V.OPER.MNTONLY# = %NO#;
      547    10575                  /*** Use density as specified on original SAVE/BACKUP/ARCHIVE ***/
      548    10576    1      TAPE_OPEN.V.XTEND# = '0'B;
      549    10577    1      TAPE_OPEN.V.FSN# = 0;
      550    10578    1      LAST_TAPE_FSN = 9999;
      551    10579    1      TAPE_OPEN.NAME_ = VECTOR(ERASE);
      552    10580    1      TAPE_OPEN.V.INITZ.SCRUB# = %YES#;
      553    10581    1      TAPE_OPEN.V.VOL# = 0;
      554    10582    1      TAPE_OPEN.V.FUN# = %IN#;
      555    10583    1      TAPE_OPEN.V.CVOL# = %NO#;
      556    10584    1      TAPE_OPEN.IFPARAM_ = VECTOR(NIL);
      557    10585    1      TAPE_OPEN.FPARAM_ = VECTOR(NIL);
      558    10586
      559    10587    1      NBR_GRANS_PER_TAPE_BUF = DEFAULT_GRANS_PER_TAPE_BUF;
      560    10588    1      M$TSN_USED$ = DCBADDR(DCBNUM(M$TSN_USED));
      561    10589
      562    10590    1      IF NOT F$DCB.FCD#
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:98   
      563    10591    2       THEN DO;
      564    10592    2         OPEN_TSN_USED.V.FUN# = %IN#;
      565    10593    2         CALL M$OPEN( OPEN_TSN_USED )
      566    10594    3          WHENALTRETURN DO;
      567    10595    3            ALTRETURN;                     /* Assume no TSN_USED                 */
      568    10596    3            END;
      569    10597    2         END;
      570    10598
      571    10599    1      CALL FLI$ALLOC( %MAX_SNSIZEW, SNLIST$ );
      572    10600
      573    10601    1      READ_TSN_USED.V.KEYS# = '1'B;
      574    10602    1      TSN_USED_KEY.L = LENGTHV(TSN_USED_KEY);
      575    10603    1      TSN_USED_KEY.RUN_NBR = 0;
      576    10604    1      TSN_USED_KEY.TSN_SET_NBR = 0;
      577    10605    1      TSN_USED_KEY.TSN_VOL = 0;
      578    10606    1      TSN_USED_KEY.TSN_SNLIST_NBR = 0;
      579    10607    1      CALL M$READ( READ_TSN_USED )
      580    10608    2       WHENRETURN DO;
      581    10609    2         RUN_NBR = TSN_USED_BUF.UTS;
      582    10610    2         END;
      583    10611    2       WHENALTRETURN DO;
      584    10612    2         RUN_NBR = 1;
      585    10613    2         END;
      586    10614
      587    10615    1      TSN_USED_KEY.RUN_NBR = RUN_NBR;
      588    10616    1      TSN_USED_KEY.L = LENGTHV(TSN_USED_KEY);
      589    10617    1      TSN_USED_KEY.TSN_SET_NBR = SET_NBR;
      590    10618    1      TSN_USED_KEY.TSN_SNLIST_NBR = SNLIST_X;
      591    10619    1      TSN_USED_KEY.TSN_VOL = 1;
      592    10620
      593    10621    1      SNLISTX = 0;
      594    10622    1      SNLIST_END = '0'B;
      595    10623    2      DO WHILE( NOT SNLIST_END );
      596    10624    2         CALL M$READ( READ_TSN_USED )
      597    10625    3          WHENRETURN DO;
      598    10626    3            IF TSN_USED_KEY.TSN_SET_NBR ~= SET_NBR
      599    10627    3              AND TSN_USED_KEY.TSN_SNLIST_NBR = SNLIST_X
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:99   
      600    10628    4             THEN DO;
      601    10629    4               SNLIST_END = '1'B;
      602    10630    4               IF TSN_USED_KEY.RUN_NBR = RUN_NBR
      603    10631    5                THEN DO;                   /* The result of a TRANSPORT/TRANSFER */
      604    10632    5                  IF TSN_USED_BUF.TSN = VLP_SN.SN#(SNLISTX-1)
      605    10633    5                   THEN LAST_TAPE_FSN = TSN_USED_BUF.FSN - 1;
      606    10634    5                  TAPE_OPEN.V.FSN# = TSN_USED_BUF.FSN;
      607    10635    5                  END;
      608    10636    4               END;
      609    10637    4             ELSE DO;
      610    10638    4               READ_TSN_USED.V.KEYS# = '0'B;
      611    10639    4               IF TSN_USED_KEY.TSN_SNLIST_NBR ~= SNLIST_X
      612    10640    4                THEN EXIT;
      613    10641    4               VLP_SN.SN#(SNLISTX) = TSN_USED_BUF.TSN;
      614    10642    4               IF TAPE_OPEN.V.FSN# = 0
      615    10643    4                THEN TAPE_OPEN.V.FSN# = TSN_USED_BUF.FSN;
      616    10644    4               SNLISTX = SNLISTX + 1;
      617    10645    4               IF F$DCB.ARS# ~= SIZEC(TSN_USED_BUF)
      618    10646    4                THEN ALTRETURN;
      619    10647    4               END;
      620    10648    3            END;
      621    10649    3          WHENALTRETURN DO;
      622    10650    3            SNLIST_END = '1'B;
      623    10651    3            END;
      624    10652    2         END;
      625    10653
      626    10654    1      IF SNLISTX = 0
      627    10655    1       THEN ALTRETURN;
      628    10656
      629    10657        /***
      630    10658         *** Remove unnecessary reels.
      631    10659         ***/
      632    10660
      633    10661    2      DO I=0 TO NBR_SNLISTS - 1;
      634    10662    2         IF VLP_SN.SN#(0) ~= TAPE_DCBLIST.DCB$(I)->F$DCB.PSN#
      635    10663    3          THEN DO;
      636    10664    3            FPT_REM.V.PSN# = TAPE_DCBLIST.DCB$(I)->F$DCB.PSN#;
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:100  
      637    10665    3            CALL M$REM( FPT_REM )
      638    10666    4             WHENALTRETURN DO;
      639    10667                                                /* This is unlikely but possible      */
      640    10668    4               END;
      641    10669    3            END;
      642    10670    2         END;
      643    10671
      644    10672    1      VLP_SN.NUM# = SNLISTX;
      645    10673    1      TVECTOR = VECTOR(VLP_SN);
      646    10674    1      TVECTOR.W1.VSIZE# = LENGTHV(VLP_SN.NUM#)
      647    10675    1        + VLP_SN.NUM# * LENGTHC(VLP_SN.SN#(0));
      648    10676    1      TAPE_OPEN.SN_ = TVECTOR;
      649    10677    1      TAPE_OPEN.V.OPER.THISF# = '1'B;
      650    10678    1      TAPE_OPEN.V.OPER.NXTF# = '1'B;
      651    10679    1      RETURN;
      652    10680
      653    10681    1   END FLI$TSN_USED;

PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:101  
--  Include file information  --

   FLS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FLI$TSN_USED.

   Procedure FLI$TSN_USED requires 198 words for executable code.
   Procedure FLI$TSN_USED requires 12 words of local(AUTO) storage.

    No errors detected in file FLI$NODE.:E05TSI    .

PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:102  

 Object Unit name= FLI$TSN_USED                               File name= FLI$NODE.:E05TOU
 UTS= JUL 29 '97 15:53:40.20 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$PRE_RET
    2   Data  even  none    24     30  FLI$TSN_USED
    3   DCB   even  none     0      0  M$TSN_USED
    4   DCB   even  none     0      0  M$STATUS
    5   DCB   even  none     0      0  M$REBUILD
    6   DCB   even  none     0      0  M$ARCHIVE
    7   DCB   even  none     0      0  M$NODATA_LIST
    8   Proc  even  none   198    306  FLI$TSN_USED
    9  RoData even  none    12     14  FLI$TSN_USED

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     8      0   yes    yes     yes      Std        2  FLI$TSN_USED

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 FLI$ALLOC
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_AALT
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:103  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  NBR_SNLISTS                           TAPE_DCBLIST$
     TAPE_OPEN                             SNVECLIST$                            TVECTOR
     NBR_GRANS_PER_TAPE_BUF                DEFAULT_GRANS_PER_TAPE_BUF            DPLIST$
     DPRESLIST$                            DISK_FILE_SPEC$                       SPECCHARS
     LAST_TAPE_FSN                         EFTWORD                               M$PRE_RET
     RET_CMDS_NAME                         M$TSN_USED                            M$STATUS
     M$REBUILD                             M$ARCHIVE                             M$NODATA_LIST
     BLK_TAG$                              BLK_TAG0$                             NBR_BYTES_TO_MOVE
     DISK_GRAN$                            BLOCK_GRAN$                      r    EFT_CVOL_FILE
r    EFT_RESTRICT_FILE                     RUN_NBR                               TSN_USED_KEY
     TSN_USED_BUF                          OPEN_TSN_USED                         TSN_USED_NAME
     READ_TSN_USED                         BACKUP_NAME                      r    ARCHIVE_NAME
r    PRIME_FILE                       r    DUAL_FILE                             REBUILD_NAME
     REBUILD_DIR_KEY                       REBUILD_KEY                           NODATA_FILE_NAME
     NODATA_KEY                            B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:104  


      489        1        /*T***********************************************************/
      490        2        /*T*                                                         */
      491        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      492        4        /*T*                                                         */
      493        5        /*T***********************************************************/
      494        6        FLI$TSN_USED: PROC( SET_NBR,SNLIST_X ) ALTRET;

      6  8 000000   000000 700200 xent  FLI$TSN_USED TSX0  ! X66_AUTO_2
         8 000001   000014 000002                    ZERO    12,2

      495        7        /*F*  NAME: FLI$TSN_USED
      496        8              PURPOSE: Create serial number list from *TSN_USED
      497        9        */
      498       10
      499       11    1   DCL SET_NBR SBIN;
      500       12    1   DCL SNLIST_X SBIN;                      /* Serial number list index           */
      501       13
      502       14        /***
      503       15         *** INCLUDE
      504       16         ***/
      505       17
      506       18        %INCLUDE B_ERRORS_C;
      507     1145        %INCLUDE CP_6;
      508     6704        %INCLUDE CP_6_SUBS;
      509     7244        %INCLUDE FLI_DATA_R;
      510     8658        %INCLUDE FLS_DATA_R;
      511    10458
      512    10459        /***
      513    10460         *** ENTRY
      514    10461         ***/
      515    10462
      516    10463    1   DCL FLI$RPT_ERR ENTRY(5);
      517    10464    1   DCL FLI$ALLOC ENTRY(2);
      518    10465
      519    10466        /***
      520    10467         *** AUTO
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:105  
      521    10468         ***/
      522    10469
      523    10470    1   DCL M$TSN_USED$ PTR AUTO;
      524    10471    1   DCL SNLISTX SBIN AUTO;
      525    10472    1   DCL SNLIST$ PTR AUTO;
      526    10473    1   DCL SNLIST_END BIT(1) AUTO;
      527    10474    1   DCL I SBIN AUTO;
      528    10475
      529    10476        /***
      530    10477         *** BASED
      531    10478         ***/
      532    10479
      533    10480        %F$DCB( STCLASS="BASED(M$TSN_USED$)" );
      534    10537        %VLP_SN( FPTN=VLP_SN,
      535    10538                 N=1,
      536    10539                 STCLASS="BASED(SNLIST$)" );
      537    10552
      538    10553        /***
      539    10554         *** FPT
      540    10555         ***/
      541    10556
      542    10557        %FPT_REM( FPTN=FPT_REM );
      543    10571
      544    10572        /****************************************/
      545    10573
      546    10574    1      TAPE_OPEN.V.OPER.MNTONLY# = %NO#;

  10574  8 000002   000000 236000 9                  LDQ     0
         8 000003   000044 356000 xsym               ANSQ    TAPE_OPEN+36

      547    10575                  /*** Use density as specified on original SAVE/BACKUP/ARCHIVE ***/
      548    10576    1      TAPE_OPEN.V.XTEND# = '0'B;

  10576  8 000004   000001 236000 9                  LDQ     1
         8 000005   000060 356000 xsym               ANSQ    TAPE_OPEN+48

      549    10577    1      TAPE_OPEN.V.FSN# = 0;
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:106  

  10577  8 000006   000000 220003                    LDX0    0,DU
         8 000007   000066 740000 xsym               STX0    TAPE_OPEN+54

      550    10578    1      LAST_TAPE_FSN = 9999;

  10578  8 000010   023417 235007                    LDA     9999,DL
         8 000011   000000 755000 xsym               STA     LAST_TAPE_FSN

      551    10579    1      TAPE_OPEN.NAME_ = VECTOR(ERASE);

  10579  8 000012   000002 237000 9                  LDAQ    2
         8 000013   000006 757000 xsym               STAQ    TAPE_OPEN+6

      552    10580    1      TAPE_OPEN.V.INITZ.SCRUB# = %YES#;

  10580  8 000014   400000 236007                    LDQ     -131072,DL
         8 000015   000044 256000 xsym               ORSQ    TAPE_OPEN+36

      553    10581    1      TAPE_OPEN.V.VOL# = 0;

  10581  8 000016   000000 236003                    LDQ     0,DU
         8 000017   000061 552040 xsym               STBQ    TAPE_OPEN+49,'40'O

      554    10582    1      TAPE_OPEN.V.FUN# = %IN#;

  10582  8 000020   002000 236007                    LDQ     1024,DL
         8 000021   000045 552010 xsym               STBQ    TAPE_OPEN+37,'10'O

      555    10583    1      TAPE_OPEN.V.CVOL# = %NO#;

  10583  8 000022   000004 236000 9                  LDQ     4
         8 000023   000044 356000 xsym               ANSQ    TAPE_OPEN+36

      556    10584    1      TAPE_OPEN.IFPARAM_ = VECTOR(NIL);

  10584  8 000024   000006 237000 9                  LDAQ    6
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:107  
         8 000025   000026 757000 xsym               STAQ    TAPE_OPEN+22

      557    10585    1      TAPE_OPEN.FPARAM_ = VECTOR(NIL);

  10585  8 000026   000006 237000 9                  LDAQ    6
         8 000027   000030 757000 xsym               STAQ    TAPE_OPEN+24

      558    10586
      559    10587    1      NBR_GRANS_PER_TAPE_BUF = DEFAULT_GRANS_PER_TAPE_BUF;

  10587  8 000030   000000 235000 xsym               LDA     DEFAULT_GRANS_PER_TAPE_BUF
         8 000031   000000 755000 xsym               STA     NBR_GRANS_PER_TAPE_BUF

      560    10588    1      M$TSN_USED$ = DCBADDR(DCBNUM(M$TSN_USED));

  10588  8 000032   000000 236007 xsym               LDQ     M$TSN_USED,DL
         8 000033   000005 470400 9                  LDP0    5
         8 000034   000000 471500                    LDP1    0,,PR0
         8 000035   100000 236106                    LDQ     0,QL,PR1
         8 000036   200005 756100                    STQ     M$TSN_USED$,,AUTO

      561    10589
      562    10590    1      IF NOT F$DCB.FCD#

  10590  8 000037   200005 473500                    LDP3    M$TSN_USED$,,AUTO
         8 000040   300031 236100                    LDQ     25,,PR3
         8 000041   020000 316007                    CANQ    8192,DL
         8 000042   000053 601000 8                  TNZ     s:10599

      563    10591    2       THEN DO;

      564    10592    2         OPEN_TSN_USED.V.FUN# = %IN#;

  10592  8 000043   002000 236007                    LDQ     1024,DL
         8 000044   000045 552010 xsym               STBQ    OPEN_TSN_USED+37,'10'O

      565    10593    2         CALL M$OPEN( OPEN_TSN_USED )
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:108  

  10593  8 000045   000000 630400 xsym               EPPR0   OPEN_TSN_USED
         8 000046   450000 713400                    CLIMB   alt,open
         8 000047   410400 401760                    pmme    nvectors=18
         8 000050   000052 702000 8                  TSX2    s:10595
         8 000051   000053 710000 8                  TRA     s:10599

      566    10594    3          WHENALTRETURN DO;

      567    10595    3            ALTRETURN;                     /* Assume no TSN_USED                 */

  10595  8 000052   000000 702200 xent               TSX2  ! X66_AALT

      568    10596    3            END;
      569    10597    2         END;

      570    10598
      571    10599    1      CALL FLI$ALLOC( %MAX_SNSIZEW, SNLIST$ );

  10599  8 000053   200007 630500                    EPPR0   SNLIST$,,AUTO
         8 000054   200013 450500                    STP0    I+2,,AUTO
         8 000055   000011 236000 9                  LDQ     9
         8 000056   200012 756100                    STQ     I+1,,AUTO
         8 000057   200012 630500                    EPPR0   I+1,,AUTO
         8 000060   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000061   000000 701000 xent               TSX1    FLI$ALLOC
         8 000062   000000 011000                    NOP     0

      572    10600
      573    10601    1      READ_TSN_USED.V.KEYS# = '1'B;

  10601  8 000063   200000 236007                    LDQ     65536,DL
         8 000064   000010 256000 xsym               ORSQ    READ_TSN_USED+8

      574    10602    1      TSN_USED_KEY.L = LENGTHV(TSN_USED_KEY);

  10602  8 000065   004000 236003                    LDQ     2048,DU
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:109  
         8 000066   000000 552040 xsym               STBQ    TSN_USED_KEY,'40'O

      575    10603    1      TSN_USED_KEY.RUN_NBR = 0;

  10603  8 000067   000000 236003                    LDQ     0,DU
         8 000070   000000 552020 xsym               STBQ    TSN_USED_KEY,'20'O

      576    10604    1      TSN_USED_KEY.TSN_SET_NBR = 0;

  10604  8 000071   000000 552010 xsym               STBQ    TSN_USED_KEY,'10'O

      577    10605    1      TSN_USED_KEY.TSN_VOL = 0;

  10605  8 000072   000000 552004 xsym               STBQ    TSN_USED_KEY,'04'O

      578    10606    1      TSN_USED_KEY.TSN_SNLIST_NBR = 0;

  10606  8 000073   000001 552040 xsym               STBQ    TSN_USED_KEY+1,'40'O

      579    10607    1      CALL M$READ( READ_TSN_USED )

  10607  8 000074   000000 630400 xsym               EPPR0   READ_TSN_USED
         8 000075   440000 713400                    CLIMB   alt,read
         8 000076   401400 401760                    pmme    nvectors=4
         8 000077   000103 702000 8                  TSX2    s:10612

      580    10608    2       WHENRETURN DO;

      581    10609    2         RUN_NBR = TSN_USED_BUF.UTS;

  10609  8 000100   000000 235000 xsym               LDA     TSN_USED_BUF
         8 000101   000000 755000 xsym               STA     RUN_NBR

      582    10610    2         END;

  10610  8 000102   000105 710000 8                  TRA     s:10615

PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:110  
      583    10611    2       WHENALTRETURN DO;

      584    10612    2         RUN_NBR = 1;

  10612  8 000103   000001 235007                    LDA     1,DL
         8 000104   000000 755000 xsym               STA     RUN_NBR

      585    10613    2         END;

      586    10614
      587    10615    1      TSN_USED_KEY.RUN_NBR = RUN_NBR;

  10615  8 000105   000000 236000 xsym               LDQ     RUN_NBR
         8 000106   000022 736000                    QLS     18
         8 000107   000000 552020 xsym               STBQ    TSN_USED_KEY,'20'O

      588    10616    1      TSN_USED_KEY.L = LENGTHV(TSN_USED_KEY);

  10616  8 000110   004000 236003                    LDQ     2048,DU
         8 000111   000000 552040 xsym               STBQ    TSN_USED_KEY,'40'O

      589    10617    1      TSN_USED_KEY.TSN_SET_NBR = SET_NBR;

  10617  8 000112   200003 470500                    LDP0    @SET_NBR,,AUTO
         8 000113   000000 236100                    LDQ     0,,PR0
         8 000114   000011 736000                    QLS     9
         8 000115   000000 552010 xsym               STBQ    TSN_USED_KEY,'10'O

      590    10618    1      TSN_USED_KEY.TSN_SNLIST_NBR = SNLIST_X;

  10618  8 000116   200004 471500                    LDP1    @SNLIST_X,,AUTO
         8 000117   100000 236100                    LDQ     0,,PR1
         8 000120   000033 736000                    QLS     27
         8 000121   000001 552040 xsym               STBQ    TSN_USED_KEY+1,'40'O

      591    10619    1      TSN_USED_KEY.TSN_VOL = 1;

PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:111  
  10619  8 000122   000001 236007                    LDQ     1,DL
         8 000123   000000 552004 xsym               STBQ    TSN_USED_KEY,'04'O

      592    10620
      593    10621    1      SNLISTX = 0;

  10621  8 000124   200006 450100                    STZ     SNLISTX,,AUTO

      594    10622    1      SNLIST_END = '0'B;

  10622  8 000125   200010 450100                    STZ     SNLIST_END,,AUTO

      595    10623    2      DO WHILE( NOT SNLIST_END );

  10623  8 000126   000225 710000 8                  TRA     s:10652

      596    10624    2         CALL M$READ( READ_TSN_USED )

  10624  8 000127   000000 630400 xsym               EPPR0   READ_TSN_USED
         8 000130   440000 713400                    CLIMB   alt,read
         8 000131   401400 401760                    pmme    nvectors=4
         8 000132   000223 702000 8                  TSX2    s:10650

      597    10625    3          WHENRETURN DO;

      598    10626    3            IF TSN_USED_KEY.TSN_SET_NBR ~= SET_NBR

  10626  8 000133   200003 470500                    LDP0    @SET_NBR,,AUTO
         8 000134   000000 236000 xsym               LDQ     TSN_USED_KEY
         8 000135   000011 772000                    QRL     9
         8 000136   000777 376007                    ANQ     511,DL
         8 000137   000000 116100                    CMPQ    0,,PR0
         8 000140   000173 600000 8                  TZE     s:10638
         8 000141   200004 471500                    LDP1    @SNLIST_X,,AUTO
         8 000142   000001 236000 xsym               LDQ     TSN_USED_KEY+1
         8 000143   000033 772000                    QRL     27
         8 000144   100000 116100                    CMPQ    0,,PR1
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:112  
         8 000145   000173 601000 8                  TNZ     s:10638

      599    10627    3              AND TSN_USED_KEY.TSN_SNLIST_NBR = SNLIST_X
      600    10628    4             THEN DO;

      601    10629    4               SNLIST_END = '1'B;

  10629  8 000146   400000 236003                    LDQ     -131072,DU
         8 000147   200010 756100                    STQ     SNLIST_END,,AUTO

      602    10630    4               IF TSN_USED_KEY.RUN_NBR = RUN_NBR

  10630  8 000150   000000 236000 xsym               LDQ     TSN_USED_KEY
         8 000151   000022 772000                    QRL     18
         8 000152   000777 376007                    ANQ     511,DL
         8 000153   000000 116000 xsym               CMPQ    RUN_NBR
         8 000154   000222 601000 8                  TNZ     s:10648

      603    10631    5                THEN DO;                   /* The result of a TRANSPORT/TRANSFER */

      604    10632    5                  IF TSN_USED_BUF.TSN = VLP_SN.SN#(SNLISTX-1)

  10632  8 000155   200006 236100                    LDQ     SNLISTX,,AUTO
         8 000156   000006 402007                    MPY     6,DL
         8 000157   200007 473500                    LDP3    SNLIST$,,AUTO
         8 000160   040106 106400                    CMPC    fill='040'O
         8 000161   000005 000006 xsym               ADSC9   TSN_USED_BUF+5           cn=0,n=6
         8 000162   377777 400006                    ADSC9   -1,Q,PR3                 cn=2,n=6
         8 000163   000170 601000 8                  TNZ     s:10634

      605    10633    5                   THEN LAST_TAPE_FSN = TSN_USED_BUF.FSN - 1;

  10633  8 000164   000006 236000 xsym               LDQ     TSN_USED_BUF+6
         8 000165   777777 376007                    ANQ     -1,DL
         8 000166   000001 136007                    SBLQ    1,DL
         8 000167   000000 756000 xsym               STQ     LAST_TAPE_FSN

PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:113  
      606    10634    5                  TAPE_OPEN.V.FSN# = TSN_USED_BUF.FSN;

  10634  8 000170   000006 720000 xsym               LXL0    TSN_USED_BUF+6
         8 000171   000066 740000 xsym               STX0    TAPE_OPEN+54

      607    10635    5                  END;

      608    10636    4               END;

  10636  8 000172   000222 710000 8                  TRA     s:10648

      609    10637    4             ELSE DO;

      610    10638    4               READ_TSN_USED.V.KEYS# = '0'B;

  10638  8 000173   000012 236000 9                  LDQ     10
         8 000174   000010 356000 xsym               ANSQ    READ_TSN_USED+8

      611    10639    4               IF TSN_USED_KEY.TSN_SNLIST_NBR ~= SNLIST_X

  10639  8 000175   200004 471500                    LDP1    @SNLIST_X,,AUTO
         8 000176   000001 236000 xsym               LDQ     TSN_USED_KEY+1
         8 000177   000033 772000                    QRL     27
         8 000200   100000 116100                    CMPQ    0,,PR1
         8 000201   000222 601000 8                  TNZ     s:10648

      612    10640    4                THEN EXIT;
      613    10641    4               VLP_SN.SN#(SNLISTX) = TSN_USED_BUF.TSN;

  10641  8 000202   200006 236100                    LDQ     SNLISTX,,AUTO
         8 000203   000006 402007                    MPY     6,DL
         8 000204   200007 473500                    LDP3    SNLIST$,,AUTO
         8 000205   040106 100400                    MLR     fill='040'O
         8 000206   000005 000006 xsym               ADSC9   TSN_USED_BUF+5           cn=0,n=6
         8 000207   300001 000006                    ADSC9   1,Q,PR3                  cn=0,n=6

      614    10642    4               IF TAPE_OPEN.V.FSN# = 0
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:114  

  10642  8 000210   000066 220000 xsym               LDX0    TAPE_OPEN+54
         8 000211   000214 601000 8                  TNZ     s:10644

      615    10643    4                THEN TAPE_OPEN.V.FSN# = TSN_USED_BUF.FSN;

  10643  8 000212   000006 721000 xsym               LXL1    TSN_USED_BUF+6
         8 000213   000066 741000 xsym               STX1    TAPE_OPEN+54

      616    10644    4               SNLISTX = SNLISTX + 1;

  10644  8 000214   200006 054100                    AOS     SNLISTX,,AUTO

      617    10645    4               IF F$DCB.ARS# ~= SIZEC(TSN_USED_BUF)

  10645  8 000215   200005 473500                    LDP3    M$TSN_USED$,,AUTO
         8 000216   300000 235100                    LDA     0,,PR3
         8 000217   000040 115007                    CMPA    32,DL
         8 000220   000222 600000 8                  TZE     s:10648

      618    10646    4                THEN ALTRETURN;

  10646  8 000221   000000 702200 xent               TSX2  ! X66_AALT

      619    10647    4               END;
      620    10648    3            END;

  10648  8 000222   000225 710000 8                  TRA     s:10652

      621    10649    3          WHENALTRETURN DO;

      622    10650    3            SNLIST_END = '1'B;

  10650  8 000223   400000 236003                    LDQ     -131072,DU
         8 000224   200010 756100                    STQ     SNLIST_END,,AUTO

      623    10651    3            END;
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:115  

      624    10652    2         END;

  10652  8 000225   200010 234100                    SZN     SNLIST_END,,AUTO
         8 000226   000127 605000 8                  TPL     s:10624

      625    10653
      626    10654    1      IF SNLISTX = 0

  10654  8 000227   200006 235100                    LDA     SNLISTX,,AUTO
         8 000230   000232 601000 8                  TNZ     s:10661

      627    10655    1       THEN ALTRETURN;

  10655  8 000231   000000 702200 xent               TSX2  ! X66_AALT

      628    10656
      629    10657        /***
      630    10658         *** Remove unnecessary reels.
      631    10659         ***/
      632    10660
      633    10661    2      DO I=0 TO NBR_SNLISTS - 1;

  10661  8 000232   200011 450100                    STZ     I,,AUTO
         8 000233   000256 710000 8                  TRA     s:10670+1

      634    10662    2         IF VLP_SN.SN#(0) ~= TAPE_DCBLIST.DCB$(I)->F$DCB.PSN#

  10662  8 000234   200011 235100                    LDA     I,,AUTO
         8 000235   000001 735000                    ALS     1
         8 000236   000000 470400 xsym               LDP0    TAPE_DCBLIST$
         8 000237   000001 471505                    LDP1    1,AL,PR0
         8 000240   200007 473500                    LDP3    SNLIST$,,AUTO
         8 000241   040100 106500                    CMPC    fill='040'O
         8 000242   300001 000006                    ADSC9   1,,PR3                   cn=0,n=6
         8 000243   100024 000006                    ADSC9   20,,PR1                  cn=0,n=6
         8 000244   000255 600000 8                  TZE     s:10670
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:116  

      635    10663    3          THEN DO;

      636    10664    3            FPT_REM.V.PSN# = TAPE_DCBLIST.DCB$(I)->F$DCB.PSN#;

  10664  8 000245   040000 100500                    MLR     fill='040'O
         8 000246   100024 000006                    ADSC9   20,,PR1                  cn=0,n=6
         8 000247   000026 400006 2                  ADSC9   FPT_REM+2                cn=2,n=6

      637    10665    3            CALL M$REM( FPT_REM )

  10665  8 000250   000024 630400 2                  EPPR0   FPT_REM
         8 000251   460006 713400                    CLIMB   alt,+24582
         8 000252   400000 401760                    pmme    nvectors=1
         8 000253   000255 702000 8                  TSX2    s:10670
         8 000254   000255 710000 8                  TRA     s:10670

      638    10666    4             WHENALTRETURN DO;

      639    10667                                                /* This is unlikely but possible      */
      640    10668    4               END;

      641    10669    3            END;

      642    10670    2         END;

  10670  8 000255   200011 054100                    AOS     I,,AUTO
         8 000256   200011 236100                    LDQ     I,,AUTO
         8 000257   000000 116000 xsym               CMPQ    NBR_SNLISTS
         8 000260   000234 604000 8                  TMI     s:10662

      643    10671
      644    10672    1      VLP_SN.NUM# = SNLISTX;

  10672  8 000261   200007 470500                    LDP0    SNLIST$,,AUTO
         8 000262   200006 235100                    LDA     SNLISTX,,AUTO
         8 000263   000000 755100                    STA     0,,PR0
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:117  

      645    10673    1      TVECTOR = VECTOR(VLP_SN);

  10673  8 000264   000013 235000 9                  LDA     11
         8 000265   200007 236100                    LDQ     SNLIST$,,AUTO
         8 000266   000000 757000 xsym               STAQ    TVECTOR

      646    10674    1      TVECTOR.W1.VSIZE# = LENGTHV(VLP_SN.NUM#)

  10674  8 000267   200007 470500                    LDP0    SNLIST$,,AUTO
         8 000270   000000 236100                    LDQ     0,,PR0
         8 000271   000006 402007                    MPY     6,DL
         8 000272   000003 036007                    ADLQ    3,DL
         8 000273   000020 736000                    QLS     16
         8 000274   000000 676000 xsym               ERQ     TVECTOR
         8 000275   000034 376000 xsym               ANQ     B_VECTNIL+28
         8 000276   000000 656000 xsym               ERSQ    TVECTOR

      647    10675    1        + VLP_SN.NUM# * LENGTHC(VLP_SN.SN#(0));
      648    10676    1      TAPE_OPEN.SN_ = TVECTOR;

  10676  8 000277   000000 237000 xsym               LDAQ    TVECTOR
         8 000300   000002 757000 xsym               STAQ    TAPE_OPEN+2

      649    10677    1      TAPE_OPEN.V.OPER.THISF# = '1'B;

  10677  8 000301   002000 236007                    LDQ     1024,DL
         8 000302   000044 256000 xsym               ORSQ    TAPE_OPEN+36

      650    10678    1      TAPE_OPEN.V.OPER.NXTF# = '1'B;

  10678  8 000303   004000 236007                    LDQ     2048,DL
         8 000304   000044 256000 xsym               ORSQ    TAPE_OPEN+36

      651    10679    1      RETURN;

  10679  8 000305   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:118  
      652    10680
      653    10681    1   END FLI$TSN_USED;

PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:119  
--  Include file information  --

   FLS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FLI$TSN_USED.
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:120  

 **** Variables and constants ****

  ****  Section 002  Data  FLI$TSN_USED

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    12-0-0/d STRC(360)   r     1 DEL_NODATA_REC            24-0-0/d STRC(144)   r     1 FPT_REM

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @SET_NBR                   4-0-0/w PTR         r     1 @SNLIST_X
    11-0-0/w SBIN        r     1 I                          5-0-0/w PTR         r     1 M$TSN_USED$
    *0-0-0/w SBIN        r     1 SET_NBR                    7-0-0/w PTR         r     1 SNLIST$
     6-0-0/w SBIN        r     1 SNLISTX                   10-0-0/b BIT         r     1 SNLIST_END
    *0-0-0/w SBIN        r     1 SNLIST_X

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ASTR(9)     r     1 ARCHIVE_NAME               0-0-0/c ASTR(9)     r     1 BACKUP_NAME
     0-0-0/w PTR         r     1 BLK_TAG$                   0-0-0/w PTR         r     1 BLK_TAG0$
     0-0-0/w PTR         r     1 BLOCK_GRAN$
     0-0-0/w SBIN        r     1 DEFAULT_GRANS_PER_TAPE_BUF
     0-0-0/w PTR         r     1 DISK_FILE_SPEC$            0-0-0/w PTR         r     1 DISK_GRAN$
     0-0-0/w PTR         r     1 DPLIST$                    0-0-0/w PTR         r     1 DPRESLIST$
     0-0-0/c ASTR(9)     r     1 DUAL_FILE                  0-0-0/c ASTR(9)     r     1 EFT_CVOL_FILE
     0-0-0/c ASTR(9)     r     1 EFT_RESTRICT_FILE          0-0-0/w SBIN        r     1 LAST_TAPE_FSN
     0-0-0/w SBIN        r     1 NBR_BYTES_TO_MOVE
     0-0-0/w SBIN        r     1 NBR_GRANS_PER_TAPE_BUF
     0-0-0/w SBIN        r     1 NBR_SNLISTS                0-0-0/c ASTR(9)     r     1 NODATA_FILE_NAME
     0-0-0/c STRC(369)   r     1 NODATA_KEY                 0-0-0/d STRC(2088)  r     1 OPEN_TSN_USED
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:121  
     0-0-0/c ASTR(9)     r     1 PRIME_FILE                 0-0-0/d STRC(504)   r     1 READ_TSN_USED
     0-0-0/c ASTR(9)     r     1 REBUILD_DIR_KEY            0-0-0/c ASTR(9)     r     1 REBUILD_KEY
     0-0-0/c ASTR(9)     r     1 REBUILD_NAME               0-0-0/c ASTR(9)     r     1 RET_CMDS_NAME
     0-0-0/w SBIN        r     1 RUN_NBR                    0-0-0/w PTR         r     1 SNVECLIST$
     0-0-0/w PTR         r     1 TAPE_DCBLIST$              0-0-0/d STRC(2088)  r     1 TAPE_OPEN
     0-0-0/w STRC(270)   r     1 TSN_USED_BUF               0-0-0/c STRC(45)    r     1 TSN_USED_KEY
     0-0-0/c ASTR(9)     r     1 TSN_USED_NAME              0-0-0/d STRC(72)    r     1 TVECTOR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$NODATA_LIST
     0-0-0N  NULL        r     1 M$TSN_USED
     0-0-0/w STRC(72)    r     1 TAPE_DCBLIST(0:0)
     0-0-0/d STRC(90)    r     1 VLP_SN


   Procedure FLI$TSN_USED requires 198 words for executable code.
   Procedure FLI$TSN_USED requires 12 words of local(AUTO) storage.

    No errors detected in file FLI$NODE.:E05TSI    .
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:122  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:123  
          MINI XREF LISTING

ARCHIVE_NAME.L#
      9550**DCL      9550--IMP-SIZ
BACKUP_NAME.L#
      9194**DCL      9194--IMP-SIZ
BLK_TAG.NAME
      8686**DCL      8686--REDEF
BLK_TAG$
      8683**DCL      8683--IMP-PTR
BLK_TAG0.NAME
      8692**DCL      8692--REDEF
BLK_TAG0$
      8689**DCL      8689--IMP-PTR
BLOCK_GRAN$
      8696**DCL      8697--IMP-PTR
CLOSE_NODATA_LIST.SN_
     10348**DCL     10348--REDEF
CLOSE_NODATA_LIST.UTL_
     10349**DCL     10349--REDEF
CLOSE_NODATA_LIST.V.EXPIRE#
     10363**DCL     10363--REDEF
CLOSE_NODATA_LIST.V.TYPE#
     10361**DCL     10361--REDEF
CLOSE_NODATA_LIST.V.XTNSIZE#
     10358**DCL     10358--REDEF   10360--REDEF
CLOSE_PRIME_DUAL.SN_
      9825**DCL      9825--REDEF
CLOSE_PRIME_DUAL.UTL_
      9826**DCL      9826--REDEF
CLOSE_PRIME_DUAL.V.EXPIRE#
      9840**DCL      9840--REDEF
CLOSE_PRIME_DUAL.V.TYPE#
      9838**DCL      9838--REDEF
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:124  
CLOSE_PRIME_DUAL.V.XTNSIZE#
      9835**DCL      9835--REDEF    9837--REDEF
CLOSE_REBUILD.SN_
     10100**DCL     10100--REDEF
CLOSE_REBUILD.UTL_
     10101**DCL     10101--REDEF
CLOSE_REBUILD.V.EXPIRE#
     10115**DCL     10115--REDEF
CLOSE_REBUILD.V.TYPE#
     10113**DCL     10113--REDEF
CLOSE_REBUILD.V.XTNSIZE#
     10110**DCL     10110--REDEF   10112--REDEF
CLOSE_STATUS.SN_
      9315**DCL      9315--REDEF
CLOSE_STATUS.UTL_
      9316**DCL      9316--REDEF
CLOSE_STATUS.V.EXPIRE#
      9330**DCL      9330--REDEF
CLOSE_STATUS.V.TYPE#
      9328**DCL      9328--REDEF
CLOSE_STATUS.V.XTNSIZE#
      9325**DCL      9325--REDEF    9327--REDEF
CLOSE_TSN_USED.SN_
      9025**DCL      9025--REDEF
CLOSE_TSN_USED.UTL_
      9026**DCL      9026--REDEF
CLOSE_TSN_USED.V.EXPIRE#
      9040**DCL      9040--REDEF
CLOSE_TSN_USED.V.TYPE#
      9038**DCL      9038--REDEF
CLOSE_TSN_USED.V.XTNSIZE#
      9035**DCL      9035--REDEF    9037--REDEF
CON_CLOSE_ARCHIVE.SN_
      9357**DCL      9357--REDEF
CON_CLOSE_ARCHIVE.UTL_
      9358**DCL      9358--REDEF
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:125  
CON_CLOSE_ARCHIVE.V.EXPIRE#
      9372**DCL      9372--REDEF
CON_CLOSE_ARCHIVE.V.TYPE#
      9370**DCL      9370--REDEF
CON_CLOSE_ARCHIVE.V.XTNSIZE#
      9367**DCL      9367--REDEF    9369--REDEF
CON_OPEN_ARCHIVE_FILE.ACSVEH_
      9444**DCL      9445--REDEF
CON_OPEN_ARCHIVE_FILE.ALTKEYS_
      9450**DCL      9451--REDEF    9451--REDEF
CON_OPEN_ARCHIVE_FILE.HDR_
      9449**DCL      9450--REDEF
CON_OPEN_ARCHIVE_FILE.TAB_
      9448**DCL      9449--REDEF
CON_OPEN_ARCHIVE_FILE.UHL_
      9442**DCL      9443--REDEF    9443--REDEF
CON_OPEN_ARCHIVE_FILE.V.FSN#
      9482**DCL      9482--REDEF    9482--REDEF
CON_OPEN_ARCHIVE_FILE.WSN_
      9448**DCL      9448--REDEF
CON_READ_ARCHIVE_FILE.STATION_
      9506**DCL      9507--REDEF
CON_READ_ARCHIVE_FILE.V.DVBYTE.REREAD#
      9518**DCL      9518--REDEF
CON_READ_ARCHIVE_FILE.V.INDX#
      9516**DCL      9516--REDEF
CVOL_UTL.ULBL#
      8785**DCL      8785--REDEF
DEFAULT_GRANS_PER_TAPE_BUF
      8178**DCL     10587>>ASSIGN
DEL_NODATA_REC.V
     10451**DCL     10448--DCLINIT
DISK_CLOSE.SN_
      7855**DCL      7855--REDEF
DISK_CLOSE.UTL_
      7856**DCL      7856--REDEF
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:126  
DISK_CLOSE.V.EXPIRE#
      7870**DCL      7870--REDEF
DISK_CLOSE.V.TYPE#
      7868**DCL      7868--REDEF
DISK_CLOSE.V.XTNSIZE#
      7865**DCL      7865--REDEF    7867--REDEF
DISK_FILE_SPEC.SPEC
      8220**DCL      8222--REDEF
DISK_FILE_SPEC.SPEC.START
      8221**DCL      8221--REDEF
DISK_FILE_SPEC.SPEC.STOP
      8222**DCL      8222--REDEF
DISK_FILE_SPEC$
      8219**DCL      8220--IMP-PTR
DISK_GRAN$
      8696**DCL      8696--IMP-PTR
DISK_OPEN.ACSVEH_
      7720**DCL      7721--REDEF
DISK_OPEN.ALTKEYS_
      7726**DCL      7727--REDEF    7727--REDEF
DISK_OPEN.HDR_
      7725**DCL      7726--REDEF
DISK_OPEN.TAB_
      7724**DCL      7725--REDEF
DISK_OPEN.UHL_
      7718**DCL      7719--REDEF    7719--REDEF
DISK_OPEN.V.FSN#
      7758**DCL      7758--REDEF    7758--REDEF
DISK_OPEN.WSN_
      7724**DCL      7724--REDEF
DISK_READ.STATION_
      7782**DCL      7783--REDEF
DISK_READ.V.DVBYTE.REREAD#
      7794**DCL      7794--REDEF
DISK_READ.V.INDX#
      7792**DCL      7792--REDEF
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:127  
DISK_WRITE.STATION_
      7820**DCL      7820--REDEF
DISK_WRITE.V.DVBYTE.VFC#
      7827**DCL      7827--REDEF
DPLIST$
      8205**DCL      8217--IMP-PTR
DPRESLIST$
      8219**DCL      8219--IMP-PTR
DUAL_FILE.L#
      9621**DCL      9621--IMP-SIZ
EFTWORD
      8340**DCL      8340--REDEF
EFT_CVOL_FILE.L#
      8745**DCL      8745--IMP-SIZ
EFT_RESTRICT_FILE.L#
      8772**DCL      8772--IMP-SIZ
F$DCB.ACTPOS
     10513**DCL     10513--REDEF
F$DCB.ARS#
     10487**DCL     10487--REDEF   10645>>IF
F$DCB.ATTR
     10506**DCL     10507--REDEF
F$DCB.BORROW
     10521**DCL     10521--REDEF   10521--REDEF   10521--REDEF
F$DCB.DCBNAME.L
     10535**DCL     10535--IMP-SIZ
F$DCB.EOMCHAR#
     10491**DCL     10491--REDEF
F$DCB.FCD#
     10500**DCL     10590>>IF
F$DCB.FLDID
     10516**DCL     10516--REDEF
F$DCB.FORM$
     10510**DCL     10510--REDEF
F$DCB.FSECT
     10526**DCL     10526--REDEF
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:128  
F$DCB.FSN#
     10503**DCL     10503--REDEF   10503--REDEF   10504--REDEF
F$DCB.HEADER$
     10509**DCL     10509--REDEF
F$DCB.IXTNSIZE#
     10507**DCL     10507--REDEF
F$DCB.LASTSTA$
     10496**DCL     10496--REDEF
F$DCB.LVL
     10522**DCL     10522--REDEF
F$DCB.NAME#.C
     10497**DCL     10497--REDEF
F$DCB.NOEOF
     10519**DCL     10519--REDEF
F$DCB.NRECS#
     10508**DCL     10508--REDEF
F$DCB.NRECX
     10527**DCL     10527--REDEF
F$DCB.OHDR
     10519**DCL     10519--REDEF
F$DCB.ORG#
     10502**DCL     10502--REDEF
F$DCB.PRECNO
     10525**DCL     10525--REDEF
F$DCB.PSN#
     10497**DCL     10662>>IF      10664>>ASSIGN
F$DCB.RCSZ
     10531**DCL     10531--REDEF
F$DCB.RES#
     10498**DCL     10498--REDEF
F$DCB.SETX
     10510**DCL     10510--REDEF
F$DCB.TAB$
     10510**DCL     10510--REDEF
F$DCB.TDA
     10524**DCL     10525--REDEF
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:129  
F$DCB.WSN#
     10498**DCL     10498--REDEF
FIT_AREA.W2
      9056**DCL      9057--REDEF
FLI$ALLOC
     10464**DCL-ENT 10599--CALL
FPT_EXIT.V.STEPCC#
      7645**DCL      7645--REDEF
FPT_REM
     10568**DCL     10665<>CALL
FPT_REM.V
     10568**DCL     10568--DCLINIT
FPT_REM.V.PSN#
     10569**DCL     10664<<ASSIGN
I
     10474**DCL     10661<<DOINDEX 10662>>IF      10664>>ASSIGN
LAST_TAPE_FSN
      8339**DCL     10578<<ASSIGN  10633<<ASSIGN
M$OPEN
      6632**DCL-ENT 10593--CALL
M$READ
      6633**DCL-ENT 10607--CALL    10624--CALL
M$REM
      6641**DCL-ENT 10665--CALL
M$TSN_USED
      8666**DCL     10588--ASSIGN
M$TSN_USED$
     10470**DCL     10481--IMP-PTR 10588<<ASSIGN  10590>>IF      10645>>IF
NBR_BYTES_TO_MOVE
      8695**DCL      8696--IMP-SIZ  8697--IMP-SIZ
NBR_GRANS_PER_TAPE_BUF
      8178**DCL     10587<<ASSIGN
NBR_SNLISTS
      7632**DCL     10661>>DOINDEX
NODATA_FILE_NAME.L#
     10310**DCL     10310--IMP-SIZ
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:130  
NODATA_KEY
     10456**DCL     10448--DCLINIT 10449--DCLINIT
OPEN_NODATA_LIST.ACSVEH_
     10243**DCL     10244--REDEF
OPEN_NODATA_LIST.ALTKEYS_
     10249**DCL     10250--REDEF   10250--REDEF
OPEN_NODATA_LIST.HDR_
     10248**DCL     10249--REDEF
OPEN_NODATA_LIST.TAB_
     10247**DCL     10248--REDEF
OPEN_NODATA_LIST.UHL_
     10241**DCL     10242--REDEF   10242--REDEF
OPEN_NODATA_LIST.V.FSN#
     10281**DCL     10281--REDEF   10281--REDEF
OPEN_NODATA_LIST.WSN_
     10247**DCL     10247--REDEF
OPEN_PRIME_DUAL.ACSVEH_
      9690**DCL      9691--REDEF
OPEN_PRIME_DUAL.ALTKEYS_
      9696**DCL      9697--REDEF    9697--REDEF
OPEN_PRIME_DUAL.HDR_
      9695**DCL      9696--REDEF
OPEN_PRIME_DUAL.TAB_
      9694**DCL      9695--REDEF
OPEN_PRIME_DUAL.UHL_
      9688**DCL      9689--REDEF    9689--REDEF
OPEN_PRIME_DUAL.V.FSN#
      9728**DCL      9728--REDEF    9728--REDEF
OPEN_PRIME_DUAL.WSN_
      9694**DCL      9694--REDEF
OPEN_REBUILD.ACSVEH_
      9925**DCL      9926--REDEF
OPEN_REBUILD.ALTKEYS_
      9931**DCL      9932--REDEF    9932--REDEF
OPEN_REBUILD.HDR_
      9930**DCL      9931--REDEF
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:131  
OPEN_REBUILD.TAB_
      9929**DCL      9930--REDEF
OPEN_REBUILD.UHL_
      9923**DCL      9924--REDEF    9924--REDEF
OPEN_REBUILD.V.FSN#
      9963**DCL      9963--REDEF    9963--REDEF
OPEN_REBUILD.WSN_
      9929**DCL      9929--REDEF
OPEN_STATUS.ACSVEH_
      9127**DCL      9128--REDEF
OPEN_STATUS.ALTKEYS_
      9133**DCL      9134--REDEF    9134--REDEF
OPEN_STATUS.HDR_
      9132**DCL      9133--REDEF
OPEN_STATUS.TAB_
      9131**DCL      9132--REDEF
OPEN_STATUS.UHL_
      9125**DCL      9126--REDEF    9126--REDEF
OPEN_STATUS.V.FSN#
      9165**DCL      9165--REDEF    9165--REDEF
OPEN_STATUS.WSN_
      9131**DCL      9131--REDEF
OPEN_TSN_USED
      8861**DCL     10593<>CALL
OPEN_TSN_USED.ACSVEH_
      8863**DCL      8864--REDEF
OPEN_TSN_USED.ALTKEYS_
      8869**DCL      8870--REDEF    8870--REDEF
OPEN_TSN_USED.HDR_
      8868**DCL      8869--REDEF
OPEN_TSN_USED.TAB_
      8867**DCL      8868--REDEF
OPEN_TSN_USED.UHL_
      8861**DCL      8862--REDEF    8862--REDEF
OPEN_TSN_USED.V.FSN#
      8901**DCL      8901--REDEF    8901--REDEF
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:132  
OPEN_TSN_USED.V.FUN#
      8880**DCL     10592<<ASSIGN
OPEN_TSN_USED.WSN_
      8867**DCL      8867--REDEF
PRE_RET_CLOSE.SN_
      8583**DCL      8583--REDEF
PRE_RET_CLOSE.UTL_
      8584**DCL      8584--REDEF
PRE_RET_CLOSE.V.EXPIRE#
      8598**DCL      8598--REDEF
PRE_RET_CLOSE.V.TYPE#
      8596**DCL      8596--REDEF
PRE_RET_CLOSE.V.XTNSIZE#
      8593**DCL      8593--REDEF    8595--REDEF
PRE_RET_OPEN.ACSVEH_
      8518**DCL      8519--REDEF
PRE_RET_OPEN.ALTKEYS_
      8524**DCL      8525--REDEF    8525--REDEF
PRE_RET_OPEN.HDR_
      8523**DCL      8524--REDEF
PRE_RET_OPEN.TAB_
      8522**DCL      8523--REDEF
PRE_RET_OPEN.UHL_
      8516**DCL      8517--REDEF    8517--REDEF
PRE_RET_OPEN.V.FSN#
      8556**DCL      8556--REDEF    8556--REDEF
PRE_RET_OPEN.WSN_
      8522**DCL      8522--REDEF
PRE_RET_READ.STATION_
      8373**DCL      8374--REDEF
PRE_RET_READ.V.DVBYTE.REREAD#
      8385**DCL      8385--REDEF
PRE_RET_READ.V.INDX#
      8383**DCL      8383--REDEF
PRE_RET_WRITE.STATION_
      8411**DCL      8411--REDEF
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:133  
PRE_RET_WRITE.V.DVBYTE.VFC#
      8418**DCL      8418--REDEF
PRIME_FILE.L#
      9594**DCL      9594--IMP-SIZ
READ_NODATA_LIST.STATION_
     10387**DCL     10388--REDEF
READ_NODATA_LIST.V.DVBYTE.REREAD#
     10399**DCL     10399--REDEF
READ_NODATA_LIST.V.INDX#
     10397**DCL     10397--REDEF
READ_PRIME_DUAL.STATION_
      9752**DCL      9753--REDEF
READ_PRIME_DUAL.V.DVBYTE.REREAD#
      9764**DCL      9764--REDEF
READ_PRIME_DUAL.V.INDX#
      9762**DCL      9762--REDEF
READ_REBUILD.STATION_
     10058**DCL     10059--REDEF
READ_REBUILD.V.DVBYTE.REREAD#
     10070**DCL     10070--REDEF
READ_REBUILD.V.INDX#
     10068**DCL     10068--REDEF
READ_STATUS.STATION_
      9273**DCL      9274--REDEF
READ_STATUS.V.DVBYTE.REREAD#
      9285**DCL      9285--REDEF
READ_STATUS.V.INDX#
      9283**DCL      9283--REDEF
READ_TSN_USED
      8980**DCL     10607<>CALL    10624<>CALL
READ_TSN_USED.STATION_
      8983**DCL      8984--REDEF
READ_TSN_USED.V.DVBYTE.REREAD#
      8995**DCL      8995--REDEF
READ_TSN_USED.V.INDX#
      8993**DCL      8993--REDEF
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:134  
READ_TSN_USED.V.KEYS#
      8985**DCL     10601<<ASSIGN  10638<<ASSIGN
REBUILD_DIR_KEY.L#
     10144**DCL     10144--IMP-SIZ
REBUILD_KEY.L#
     10171**DCL     10171--IMP-SIZ
REBUILD_NAME.L#
      9992**DCL      9992--IMP-SIZ
RET_CMDS_NAME.L#
      8627**DCL      8627--IMP-SIZ
RUN_NBR
      8789**DCL     10609<<ASSIGN  10612<<ASSIGN  10615>>ASSIGN  10630>>IF
SET_NBR
        11**DCL         6--PROC    10617>>ASSIGN  10626>>IF
SNLIST$
     10472**DCL     10550--IMP-PTR 10599<>CALL    10632>>IF      10641>>ASSIGN  10662>>IF      10672>>ASSIGN
     10673>>ASSIGN  10674>>ASSIGN
SNLISTX
     10471**DCL     10621<<ASSIGN  10632>>IF      10641>>ASSIGN  10644<<ASSIGN  10644>>ASSIGN  10654>>IF
     10672>>ASSIGN
SNLIST_END
     10473**DCL     10622<<ASSIGN  10623>>DOWHILE 10629<<ASSIGN  10650<<ASSIGN
SNLIST_X
        12**DCL         6--PROC    10618>>ASSIGN  10626>>IF      10639>>IF
SNVECLIST$
      8159**DCL      8159--IMP-PTR
SPEC.START
      8223**DCL      8224--REDEF
SPEC.STOP
      8224**DCL      8225--REDEF
SPECCHARS
      8223**DCL      8223--REDEF
TAPE_BLOCK_.W2
      8711**DCL      8712--REDEF
TAPE_CLOSE.SN_
      8076**DCL      8076--REDEF
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:135  
TAPE_CLOSE.UTL_
      8077**DCL      8077--REDEF
TAPE_CLOSE.V.EXPIRE#
      8091**DCL      8091--REDEF
TAPE_CLOSE.V.TYPE#
      8089**DCL      8089--REDEF
TAPE_CLOSE.V.XTNSIZE#
      8086**DCL      8086--REDEF    8088--REDEF
TAPE_DCBLIST.DCB$
      7632**DCL     10662>>IF      10664>>ASSIGN
TAPE_DCBLIST$
      7632**DCL      7632--IMP-PTR 10662>>IF      10664>>ASSIGN
TAPE_OPEN.ACSVEH_
      7941**DCL      7942--REDEF
TAPE_OPEN.ALTKEYS_
      7947**DCL      7948--REDEF    7948--REDEF
TAPE_OPEN.FPARAM_
      7944**DCL     10585<<ASSIGN
TAPE_OPEN.HDR_
      7946**DCL      7947--REDEF
TAPE_OPEN.IFPARAM_
      7944**DCL     10584<<ASSIGN
TAPE_OPEN.NAME_
      7940**DCL     10579<<ASSIGN
TAPE_OPEN.SN_
      7939**DCL     10676<<ASSIGN
TAPE_OPEN.TAB_
      7945**DCL      7946--REDEF
TAPE_OPEN.UHL_
      7939**DCL      7940--REDEF    7940--REDEF
TAPE_OPEN.V.CVOL#
      7953**DCL     10583<<ASSIGN
TAPE_OPEN.V.FSN#
      7979**DCL      7979--REDEF    7979--REDEF   10577<<ASSIGN  10634<<ASSIGN  10642>>IF      10643<<ASSIGN
TAPE_OPEN.V.FUN#
      7958**DCL     10582<<ASSIGN
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:136  
TAPE_OPEN.V.INITZ.SCRUB#
      7949**DCL     10580<<ASSIGN
TAPE_OPEN.V.OPER.MNTONLY#
      7952**DCL     10574<<ASSIGN
TAPE_OPEN.V.OPER.NXTF#
      7951**DCL     10678<<ASSIGN
TAPE_OPEN.V.OPER.THISF#
      7951**DCL     10677<<ASSIGN
TAPE_OPEN.V.VOL#
      7973**DCL     10581<<ASSIGN
TAPE_OPEN.V.XTEND#
      7969**DCL     10576<<ASSIGN
TAPE_OPEN.WSN_
      7945**DCL      7945--REDEF
TAPE_READ.STATION_
      8003**DCL      8004--REDEF
TAPE_READ.V.DVBYTE.REREAD#
      8015**DCL      8015--REDEF
TAPE_READ.V.INDX#
      8013**DCL      8013--REDEF
TAPE_WRITE.STATION_
      8041**DCL      8041--REDEF
TAPE_WRITE.V.DVBYTE.VFC#
      8048**DCL      8048--REDEF
TSN_USED_BUF
      8792**DCL     10645--IF
TSN_USED_BUF.FSN
      8793**DCL     10633>>ASSIGN  10634>>ASSIGN  10643>>ASSIGN
TSN_USED_BUF.TSN
      8793**DCL     10632>>IF      10641>>ASSIGN
TSN_USED_BUF.UTS
      8793**DCL     10609>>ASSIGN
TSN_USED_KEY
      8790**DCL     10602--ASSIGN  10616--ASSIGN
TSN_USED_KEY.L
      8790**DCL     10602<<ASSIGN  10616<<ASSIGN
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:137  
TSN_USED_KEY.RUN_NBR
      8790**DCL     10603<<ASSIGN  10615<<ASSIGN  10630>>IF
TSN_USED_KEY.TSN_SET_NBR
      8791**DCL     10604<<ASSIGN  10617<<ASSIGN  10626>>IF
TSN_USED_KEY.TSN_SNLIST_NBR
      8791**DCL     10606<<ASSIGN  10618<<ASSIGN  10626>>IF      10639>>IF
TSN_USED_KEY.TSN_VOL
      8791**DCL     10605<<ASSIGN  10619<<ASSIGN
TSN_USED_NAME.L#
      8930**DCL      8930--IMP-SIZ
TVECTOR
      8171**DCL     10673<<ASSIGN  10676>>ASSIGN
TVECTOR.W1.VSIZE#
      8171**DCL     10674<<ASSIGN
TVECTOR.W2
      8172**DCL      8173--REDEF
VLP_SN
     10550**DCL     10673--ASSIGN
VLP_SN.NUM#
     10550**DCL     10672<<ASSIGN  10674>>ASSIGN  10674--ASSIGN
VLP_SN.SN#
     10550**DCL     10632>>IF      10641<<ASSIGN  10662>>IF      10674--ASSIGN
WRITE_NODATA_LIST.STATION_
     10425**DCL     10425--REDEF
WRITE_NODATA_LIST.V.DVBYTE.VFC#
     10432**DCL     10432--REDEF
WRITE_PRIME_DUAL.STATION_
      9790**DCL      9790--REDEF
WRITE_PRIME_DUAL.V.DVBYTE.VFC#
      9797**DCL      9797--REDEF
WRITE_REBUILD.STATION_
     10026**DCL     10026--REDEF
WRITE_REBUILD.V.DVBYTE.VFC#
     10033**DCL     10033--REDEF
WRITE_STATUS.STATION_
      9241**DCL      9241--REDEF
PL6.E3A0      #004=FLI$TSN_USED File=FLI$NODE.:E05TSI                            TUE 07/29/97 15:53 Page:138  
WRITE_STATUS.V.DVBYTE.VFC#
      9248**DCL      9248--REDEF
WRITE_TSN_USED.STATION_
      8951**DCL      8951--REDEF
WRITE_TSN_USED.V.DVBYTE.VFC#
      8958**DCL      8958--REDEF
