VERSION E05

PL6.E3A0      #001=KYA$ADMIN File=KYA$ADMIN.:E05TSI                              WED 07/30/97 02:39 Page:1    
        1        1        /*M* KYA$ADMIN - routines to handle admin functions for URP */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*   DMR,PLM=7,IND=3,CTI=3,SDI=3,MCL=10,CSI=3,DTI=3,DCI=6,
        8        8               ECI=0,DIN=7,CSU=3,AND      */
        9        9        /*P* NAME: KYA$ADMIN - routines to handle admin functions for URP */
       10       10        KYA$ADMIN: PROC(ADMIN_FPT) ALTRET;
       11       11        /**/
       12       12        %INCLUDE LCP_6;
       13     4291        %INCLUDE KY_URP_M;
       14     4586        %INCLUDE KH$CHN;
       15     4708        %INCLUDE KV_GLBCNS_E;
       16     5049        %INCLUDE KHA_FNC_E;
       17     5149        %INCLUDE KH_MACRO_C;
       18     5892        %INCLUDE KL_MACRO_C;
       19     9244               %INCLUDE K_ID_E;
       20     9294               %INCLUDE KH$STT;
       21     9324               %INCLUDE KV$GLBCTX;
       22     9769               %INCLUDE KV_GLB_M;
       23     9891               %INCLUDE KV$GLB;
       24    10310               %INCLUDE KY_SUBS_C;
       25    10399        /**/
       26    10400        %KH$ADMIN_FPT (FPTN=ADMIN_FPT,STCLASS=PARAM);
       27    10611        /**/
       28    10612        %KV_USR_EVT_ID_E;
       29    10632        %KV_USR_FNC_E;
       30    10648               %KL_REQSTATS;
       31    10942               %K#ENTID_E;
       32    10961        /*  */
       33    10962               %INCLUDE KY_DATA_R;
       34    11757        /**/
       35    11758    1          DCL KYA$ENABLE ENTRY(1) ALTRET;
       36    11759    1          DCL KYA$DISCON ENTRY(1) ALTRET;
       37    11760    1          DCL KYA$STATS ENTRY;
PL6.E3A0      #001=KYA$ADMIN File=KYA$ADMIN.:E05TSI                              WED 07/30/97 02:39 Page:2    
       38    11761    1          DCL KYK$KEYIN ENTRY(2);
       39    11762    1          DCL KHA$SNDSTT ENTRY(2) ALTRET;
       40    11763    1          DCL KHC$XEQ2 ENTRY(1) ALTRET;
       41    11764        /**/
       42    11765    1          DCL KEYIN UBIN;
       43    11766        %KY$CTX (NAME=KY$CTX,STCLASS=BASED);
       44    11943        %KY$CTX (NAME=CTX,STCLASS=AUTO);
       45    12120        %KH$CHN (NAME=KH$CHN,STCLASS=BASED);
       46    12244    1          DCL ONEWORD UBIN WORD BASED;
       47    12245    1          DCL CURXEQTIM UBIN(32);
       48    12246        /**/
       49    12247        %EJECT;
PL6.E3A0      #001=KYA$ADMIN File=KYA$ADMIN.:E05TSI                              WED 07/30/97 02:39 Page:3    
       50    12248    2          DO CASE(ADMIN_FPT.FNC);
       51    12249    2             CASE(%KHA_FNC_ENABLE);
       52    12250    2                CALL KYA$ENABLE(ADMIN_FPT.CHN$) ALTRET(ALT);
       53    12251    2             CASE(%KHA_FNC_DISABLE,%KHA_FNC_KILL,%KHA_FNC_DISCONNECT_RQS);
       54    12252    2                CALL KYA$DISCON(ADMIN_FPT.CHN$) ALTRET(ALT);
       55    12253    2             CASE(%KHA_FNC_REQSTATS);
       56    12254    2                IF ADMIN_FPT.CTX$->KL_REQSTATS.SLCENT(%KH#ENTID_URP) AND
       57    12255    2                   ADMIN_FPT.CTX$->KL_REQSTATS.SLCENT(%KH#ENTID_VDH) THEN
       58    12256    3                   DO;
       59    12257    3                      IF ADMIN_FPT.CTX$->KL_REQSTATS.DSPENT(%KH#ENTID_URP) THEN
       60    12258    4                         DO;
       61    12259                           %IF ('0'B);
       62    12260                           %ENDIF;
       63    12261    4                            CALL KHA$SNDSTT(ADMIN_FPT.CTX$->KL_REQSTATS,VECTOR(
             12261                                     KY_STT_URP));
       64    12262    4                         END;
       65    12263    3                      IF ADMIN_FPT.CTX$->KL_REQSTATS.DSPENT(%KH#ENTID_VDH) THEN
       66    12264    4                         DO;
       67    12265    4                            CALL KHC$XEQ2(CURXEQTIM);
       68    12266    4                            KV_STT.SCHEXCTIM = CURXEQTIM - KY_STT_URP.USRSTT.
             12266                                     INPINTISATIM - KY_STT_URP.USRSTT.OTPINTISATIM;
       69    12267    4                            CALL KHA$SNDSTT(ADMIN_FPT.CTX$->KL_REQSTATS,VECTOR(KV_STT))
             12267                                     ;
       70    12268    4                         END;
       71    12269    3                   END;
       72    12270    2             CASE(%KHA_FNC_DVCERRRSP);
       73    12271                     /* kyd$discon sends a sttm to slug, but one might eek
       74    12272                        thru anyway just throw the message away if it does. */
       75    12273    2                IF (ADMIN_FPT.CHN$->KH$CHN.CTX$ = ADDR(NIL)) THEN RETURN;
       76    12274    2                CTX = ADMIN_FPT.CHN$->KH$CHN.CTX$->KY$CTX;
       77    12275    2                KEYIN = ADMIN_FPT.CTX$->ONEWORD;
       78    12276    2                CALL KYK$KEYIN(CTX,KEYIN);
       79    12277    2          END;                             /* CASE CODE */
       80    12278    1          RETURN;
       81    12279    1   ALT: /*N* ADMIN_FPT.RESULTS = error code; */
       82    12280    1          ALTRETURN;
       83    12281    1   END KYA$ADMIN;
PL6.E3A0      #001=KYA$ADMIN File=KYA$ADMIN.:E05TSI                              WED 07/30/97 02:39 Page:4    
       84    12282        %EOD;

PL6.E3A0      #001=KYA$ADMIN File=KYA$ADMIN.:E05TSI                              WED 07/30/97 02:39 Page:5    
--  Include file information  --

   KY_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KY_SUBS_C.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   KV_GLB_M.:E05TOU  is referenced.
   KV$GLBCTX.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   KY_URP_M.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KYA$ADMIN.

   Procedure KYA$ADMIN requires 199 words for executable code.
   Procedure KYA$ADMIN requires 52 words of local(AUTO) storage.

PL6.E3A0      #001=KYA$ADMIN File=KYA$ADMIN.:E05TSI                              WED 07/30/97 02:39 Page:6    

 Object Unit name= KYA$ADMIN                                  File name= KYA$ADMIN.:E05TOU
 UTS= JUL 30 '97 02:39:15.24 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   Proc  even  none   199     C7  KYA$ADMIN
    1  RoData even  none     6      6  KYA$ADMIN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        1  KYA$ADMIN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 KYA$ENABLE
 yes     yes           Std       1 KYA$DISCON
 yes     yes           Std       2 KHA$SNDSTT
 yes     yes           Std       1 KHC$XEQ2
         yes           Std       2 KYK$KEYIN
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6A_ARET
                       nStd      0 X6A_AALT
PL6.E3A0      #001=KYA$ADMIN File=KYA$ADMIN.:E05TSI                              WED 07/30/97 02:39 Page:7    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KY_STT_URP                            KV_STT                           r    G$ROS$
PL6.E3A0      #001=KYA$ADMIN File=KYA$ADMIN.:E05TSI                              WED 07/30/97 02:39 Page:8    


        1        1        /*M* KYA$ADMIN - routines to handle admin functions for URP */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*   DMR,PLM=7,IND=3,CTI=3,SDI=3,MCL=10,CSI=3,DTI=3,DCI=6,
        8        8               ECI=0,DIN=7,CSU=3,AND      */
        9        9        /*P* NAME: KYA$ADMIN - routines to handle admin functions for URP */
       10       10        KYA$ADMIN: PROC(ADMIN_FPT) ALTRET;

     10   0 000000  D380 0000 0000  xent KYA$ADMIN       LNJ,B5   X6A_AUTO_1
          0 000003       0034 0001                       DC       52,1

       11       11        /**/
       12       12        %INCLUDE LCP_6;
       13     4291        %INCLUDE KY_URP_M;
       14     4586        %INCLUDE KH$CHN;
       15     4708        %INCLUDE KV_GLBCNS_E;
       16     5049        %INCLUDE KHA_FNC_E;
       17     5149        %INCLUDE KH_MACRO_C;
       18     5892        %INCLUDE KL_MACRO_C;
       19     9244               %INCLUDE K_ID_E;
       20     9294               %INCLUDE KH$STT;
       21     9324               %INCLUDE KV$GLBCTX;
       22     9769               %INCLUDE KV_GLB_M;
       23     9891               %INCLUDE KV$GLB;
       24    10310               %INCLUDE KY_SUBS_C;
       25    10399        /**/
       26    10400        %KH$ADMIN_FPT (FPTN=ADMIN_FPT,STCLASS=PARAM);
       27    10611        /**/
       28    10612        %KV_USR_EVT_ID_E;
       29    10632        %KV_USR_FNC_E;
       30    10648               %KL_REQSTATS;
       31    10942               %K#ENTID_E;
       32    10961        /*  */
PL6.E3A0      #001=KYA$ADMIN File=KYA$ADMIN.:E05TSI                              WED 07/30/97 02:39 Page:9    
       33    10962               %INCLUDE KY_DATA_R;
       34    11757        /**/
       35    11758    1          DCL KYA$ENABLE ENTRY(1) ALTRET;
       36    11759    1          DCL KYA$DISCON ENTRY(1) ALTRET;
       37    11760    1          DCL KYA$STATS ENTRY;
       38    11761    1          DCL KYK$KEYIN ENTRY(2);
       39    11762    1          DCL KHA$SNDSTT ENTRY(2) ALTRET;
       40    11763    1          DCL KHC$XEQ2 ENTRY(1) ALTRET;
       41    11764        /**/
       42    11765    1          DCL KEYIN UBIN;
       43    11766        %KY$CTX (NAME=KY$CTX,STCLASS=BASED);
       44    11943        %KY$CTX (NAME=CTX,STCLASS=AUTO);
       45    12120        %KH$CHN (NAME=KH$CHN,STCLASS=BASED);
       46    12244    1          DCL ONEWORD UBIN WORD BASED;
       47    12245    1          DCL CURXEQTIM UBIN(32);
       48    12246        /**/
       49    12247        %EJECT;
PL6.E3A0      #001=KYA$ADMIN File=KYA$ADMIN.:E05TSI                              WED 07/30/97 02:39 Page:10   
       50    12248    2          DO CASE(ADMIN_FPT.FNC);

  12248   0 000005  ECC7 0004                            LDB,B6   @ADMIN_FPT,AUTO
          0 000007  B806                                 LDR,R3   ,B6
          0 000008  3D19                                 CMV,R3   25
          0 000009  0281 00B7                            BGE      s:12278,PREL
          0 00000B  A830 0000 0011  00                   LDR,R2   s:12248+12,R3
          0 00000E  83A0 0000 002A  00                   JMP      s:12250,R2
          0 000011       0097                            DC       s:12278,PREL
          0 000012       0000                            DC       s:12250,PREL
          0 000013       000E                            DC       s:12252,PREL
          0 000014       000E                            DC       s:12252,PREL
          0 000015       001C                            DC       s:12254,PREL
          0 000016       0097                            DC       s:12278,PREL
          0 000017       0097                            DC       s:12278,PREL
          0 000018       0097                            DC       s:12278,PREL
          0 000019       0097                            DC       s:12278,PREL
          0 00001A       0097                            DC       s:12278,PREL
          0 00001B       0097                            DC       s:12278,PREL
          0 00001C       0097                            DC       s:12278,PREL
          0 00001D       0097                            DC       s:12278,PREL
          0 00001E       000E                            DC       s:12252,PREL
          0 00001F       0097                            DC       s:12278,PREL
          0 000020       0097                            DC       s:12278,PREL
          0 000021       0097                            DC       s:12278,PREL
          0 000022       0097                            DC       s:12278,PREL
          0 000023       0097                            DC       s:12278,PREL
          0 000024       0097                            DC       s:12278,PREL
          0 000025       0097                            DC       s:12278,PREL
          0 000026       0097                            DC       s:12278,PREL
          0 000027       0097                            DC       s:12278,PREL
          0 000028       0097                            DC       s:12278,PREL
          0 000029       0071                            DC       s:12273,PREL

       51    12249    2             CASE(%KHA_FNC_ENABLE);

       52    12250    2                CALL KYA$ENABLE(ADMIN_FPT.CHN$) ALTRET(ALT);
PL6.E3A0      #001=KYA$ADMIN File=KYA$ADMIN.:E05TSI                              WED 07/30/97 02:39 Page:11   

  12250   0 00002A  DBC6 000B                            LAB,B5   11,B6
          0 00002C  DFC7 0030                            STB,B5   CURXEQTIM+3,AUTO
          0 00002E  BBC7 0030                            LAB,B3   CURXEQTIM+3,AUTO
          0 000030  CBF0 0100                            LAB,B4   256,IMO
          0 000032  E380 0000 0000  xent                 LNJ,B6   KYA$ENABLE
          0 000035       008F                            DC       s:12280,PREL
          0 000036  0F81 008A                            B        s:12278,PREL

       53    12251    2             CASE(%KHA_FNC_DISABLE,%KHA_FNC_KILL,%KHA_FNC_DISCONNECT_RQS);

       54    12252    2                CALL KYA$DISCON(ADMIN_FPT.CHN$) ALTRET(ALT);

  12252   0 000038  DBC6 000B                            LAB,B5   11,B6
          0 00003A  DFC7 0030                            STB,B5   CURXEQTIM+3,AUTO
          0 00003C  BBC7 0030                            LAB,B3   CURXEQTIM+3,AUTO
          0 00003E  CBF0 0100                            LAB,B4   256,IMO
          0 000040  E380 0000 0000  xent                 LNJ,B6   KYA$DISCON
          0 000043       0081                            DC       s:12280,PREL
          0 000044  0F81 007C                            B        s:12278,PREL

       55    12253    2             CASE(%KHA_FNC_REQSTATS);

       56    12254    2                IF ADMIN_FPT.CTX$->KL_REQSTATS.SLCENT(%KH#ENTID_URP) AND

  12254   0 000046  DCC6 0009                            LDB,B5   9,B6
          0 000048  82C5 0012                            LB,'0400'X        18,B5
          0 00004A       0400
          0 00004B  0581 0075                            BBF      s:12278,PREL
          0 00004D  82C5 0012                            LB,'0020'X        18,B5
          0 00004F       0020
          0 000050  0581 0070                            BBF      s:12278,PREL

       57    12255    2                   ADMIN_FPT.CTX$->KL_REQSTATS.SLCENT(%KH#ENTID_VDH) THEN
       58    12256    3                   DO;

       59    12257    3                      IF ADMIN_FPT.CTX$->KL_REQSTATS.DSPENT(%KH#ENTID_URP) THEN
PL6.E3A0      #001=KYA$ADMIN File=KYA$ADMIN.:E05TSI                              WED 07/30/97 02:39 Page:12   

  12257   0 000052  82C5 0010                            LB,'0400'X        16,B5
  12257   0 000054       0400
          0 000055  0581 0010                            BBF      s:12263,PREL

       60    12258    4                         DO;

       61    12259                           %IF ('0'B);
       62    12260                           %ENDIF;
       63    12261    4                            CALL KHA$SNDSTT(ADMIN_FPT.CTX$->KL_REQSTATS,VECTOR(
             12261                                     KY_STT_URP));

  12261   0 000057  CB80 0000 0000  01                   LAB,B4   0
          0 00005A  CFC7 0032                            STB,B4   CURXEQTIM+5,AUTO
          0 00005C  DFC7 0030                            STB,B5   CURXEQTIM+3,AUTO
          0 00005E  BBC7 0030                            LAB,B3   CURXEQTIM+3,AUTO
          0 000060  CBF0 0200                            LAB,B4   512,IMO
          0 000062  E380 0000 0000  xent                 LNJ,B6   KHA$SNDSTT
          0 000065       0001                            DC       s:12263,PREL

       64    12262    4                         END;

       65    12263    3                      IF ADMIN_FPT.CTX$->KL_REQSTATS.DSPENT(%KH#ENTID_VDH) THEN

  12263   0 000066  ECC7 0004                            LDB,B6   @ADMIN_FPT,AUTO
          0 000068  DCC6 0009                            LDB,B5   9,B6
          0 00006A  82C5 0010                            LB,'0020'X        16,B5
          0 00006C       0020
          0 00006D  0581 0053                            BBF      s:12278,PREL

       66    12264    4                         DO;

       67    12265    4                            CALL KHC$XEQ2(CURXEQTIM);

  12265   0 00006F  CBC7 002D                            LAB,B4   CURXEQTIM,AUTO
          0 000071  CFC7 0030                            STB,B4   CURXEQTIM+3,AUTO
          0 000073  BBC7 0030                            LAB,B3   CURXEQTIM+3,AUTO
PL6.E3A0      #001=KYA$ADMIN File=KYA$ADMIN.:E05TSI                              WED 07/30/97 02:39 Page:13   
          0 000075  CBF0 0100                            LAB,B4   256,IMO
          0 000077  E380 0000 0000  xent                 LNJ,B6   KHC$XEQ2
          0 00007A       0001                            DC       s:12266,PREL

       68    12266    4                            KV_STT.SCHEXCTIM = CURXEQTIM - KY_STT_URP.USRSTT.
             12266                                     INPINTISATIM - KY_STT_URP.USRSTT.OTPINTISATIM;

  12266   0 00007B  8CC7 002D                            LDI      CURXEQTIM,AUTO
          0 00007D  8480 0000 0018  xsym                 SID      KY_STT_URP+24
          0 000080  8480 0000 001A  xsym                 SID      KY_STT_URP+26
          0 000083  8D00 0000 003C  xsym                 SDI      KV_STT+60

       69    12267    4                           CALL KHA$SNDSTT(ADMIN_FPT.CTX$->KL_REQSTATS,VECTOR(KV_STT))
             12267                                     ;

  12267   0 000086  ECC7 0004                            LDB,B6   @ADMIN_FPT,AUTO
          0 000088  DCC6 0009                            LDB,B5   9,B6
          0 00008A  CB80 0000 0003  01                   LAB,B4   +3
          0 00008D  CFC7 0032                            STB,B4   CURXEQTIM+5,AUTO
          0 00008F  DFC7 0030                            STB,B5   CURXEQTIM+3,AUTO
          0 000091  BBC7 0030                            LAB,B3   CURXEQTIM+3,AUTO
          0 000093  CBF0 0200                            LAB,B4   512,IMO
          0 000095  E380 0000 0000  xent                 LNJ,B6   KHA$SNDSTT
          0 000098       0001                            DC       s:12269,PREL

       70    12268    4                         END;

       71    12269    3                   END;

  12269   0 000099  0F81 0027                            B        s:12278,PREL

       72    12270    2             CASE(%KHA_FNC_DVCERRRSP);

       73    12271                     /* kyd$discon sends a sttm to slug, but one might eek
       74    12272                        thru anyway just throw the message away if it does. */
       75    12273    2                IF (ADMIN_FPT.CHN$->KH$CHN.CTX$ = ADDR(NIL)) THEN RETURN;

PL6.E3A0      #001=KYA$ADMIN File=KYA$ADMIN.:E05TSI                              WED 07/30/97 02:39 Page:14   
  12273   0 00009B  DCC6 000B                            LDB,B5   11,B6
          0 00009D  8DC5 000C                            CMN      12,B5
          0 00009F  0981 0004                            BNE      s:12274,PREL

  12273   0 0000A1  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

       76    12274    2                CTX = ADMIN_FPT.CHN$->KH$CHN.CTX$->KY$CTX;

  12274   0 0000A4  CCC5 000C                            LDB,B4   12,B5
          0 0000A6  AB84                                 LAB,B2   ,B4
          0 0000A7  2C00                                 LDV,R2   0
          0 0000A8  6C4C                                 LDV,R6   76
          0 0000A9  BB87                                 LAB,B3   ,AUTO
          0 0000AA  3C0E                                 LDV,R3   14
          0 0000AB  0008                                 MMM

       77    12275    2                KEYIN = ADMIN_FPT.CTX$->ONEWORD;

  12275   0 0000AC  DCC6 0009                            LDB,B5   9,B6
          0 0000AE  E805                                 LDR,R6   ,B5
          0 0000AF  EF47 0006                            STR,R6   KEYIN,AUTO

       78    12276    2                CALL KYK$KEYIN(CTX,KEYIN);

  12276   0 0000B1  9BC7 0006                            LAB,B1   KEYIN,AUTO
          0 0000B3  9FC7 0032                            STB,B1   CURXEQTIM+5,AUTO
          0 0000B5  DBC7 0007                            LAB,B5   CTX,AUTO
          0 0000B7  DFC7 0030                            STB,B5   CURXEQTIM+3,AUTO
          0 0000B9  BBC7 0030                            LAB,B3   CURXEQTIM+3,AUTO
          0 0000BB  CBF0 0200                            LAB,B4   512,IMO
          0 0000BD  E380 0000 0000  xent                 LNJ,B6   KYK$KEYIN
          0 0000C0       0001                            DC       s:12278,PREL

       79    12277    2          END;                             /* CASE CODE */

       80    12278    1          RETURN;

PL6.E3A0      #001=KYA$ADMIN File=KYA$ADMIN.:E05TSI                              WED 07/30/97 02:39 Page:15   
  12278   0 0000C1  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

       81    12279    1   ALT: /*N* ADMIN_FPT.RESULTS = error code; */
       82    12280    1          ALTRETURN;

  12280   0 0000C4  C380 0000 0000  xent ALT             LNJ,B4   X6A_AALT
       83    12281    1   END KYA$ADMIN;
       84    12282        %EOD;

PL6.E3A0      #001=KYA$ADMIN File=KYA$ADMIN.:E05TSI                              WED 07/30/97 02:39 Page:16   
--  Include file information  --

   KY_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KY_SUBS_C.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   KV_GLB_M.:E05TOU  is referenced.
   KV$GLBCTX.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   KY_URP_M.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KYA$ADMIN.
PL6.E3A0      #001=KYA$ADMIN File=KYA$ADMIN.:E05TSI                              WED 07/30/97 02:39 Page:17   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @ADMIN_FPT                *0-0-0/w STRC(288)   r     1 ADMIN_FPT
     7-0-0/w STRC(608)   r     1 CTX                       2D-0-0/w UBIN(32)    r     1 CURXEQTIM
     6-0-0/w UBIN(16)    r     1 KEYIN

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(8960)  r     1 KV_STT                     0-0-0/w STRC(672)   r     1 KY_STT_URP

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(512)   r     1 KH$CHN                     0-0-0/w STRC(320)   r     1 KL_REQSTATS
     0-0-0/w STRC(608)   r     1 KY$CTX                     0-0-0/w UBIN(16)    r     1 ONEWORD


   Procedure KYA$ADMIN requires 199 words for executable code.
   Procedure KYA$ADMIN requires 52 words of local(AUTO) storage.
PL6.E3A0      #001=KYA$ADMIN File=KYA$ADMIN.:E05TSI                              WED 07/30/97 02:39 Page:18   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KYA$ADMIN File=KYA$ADMIN.:E05TSI                              WED 07/30/97 02:39 Page:19   
          MINI XREF LISTING

ADMIN_FPT
     10415**DCL        10--PROC
ADMIN_FPT.CHN$
     10542**DCL     12250<>CALL    12252<>CALL    12273>>IF      12274>>ASSIGN
ADMIN_FPT.CTX$
     10471**DCL     12254>>IF      12254>>IF      12257>>IF      12261>>CALL    12263>>IF      12267>>CALL
     12275>>ASSIGN
ADMIN_FPT.FNC
     10416**DCL     12248>>DOCASE
ADMIN_FPT.TERMID.TERM
     10439**DCL     10448--REDEF
ALT
     12280**LABEL   12250--CALLALT 12252--CALLALT
CTX
     11954**DCL     12274<<ASSIGN  12276<>CALL
CTX.DEFRD.STATUSW
     12096**DCL     12098--REDEF
CTX.MODE
     12045**DCL     12053--REDEF
CTX.STATUSW
     11972**DCL     11974--REDEF   11982--REDEF   11996--REDEF   12010--REDEF   12024--REDEF
CTX.VDIENB
     12110**DCL     12116--REDEF
CURXEQTIM
     12245**DCL     12265<>CALL    12266>>ASSIGN
KEYIN
     11765**DCL     12275<<ASSIGN  12276<>CALL
KH$CHN.CTX$
     12205**DCL     12273>>IF      12274>>ASSIGN
KH$CHN.TERMID.TERM
     12231**DCL     12240--REDEF
KHA$SNDSTT
PL6.E3A0      #001=KYA$ADMIN File=KYA$ADMIN.:E05TSI                              WED 07/30/97 02:39 Page:20   
     11762**DCL-ENT 12261--CALL    12267--CALL
KHC$XEQ2
     11763**DCL-ENT 12265--CALL
KL_REQSTATS
     10800**DCL     12261<>CALL    12267<>CALL
KL_REQSTATS.DSPENT
     10896**DCL     12257>>IF      12263>>IF
KL_REQSTATS.DSPMSK
     10890**DCL     10896--REDEF
KL_REQSTATS.SLCENT
     10938**DCL     12254>>IF      12254>>IF
KL_REQSTATS.SLCMSK
     10931**DCL     10938--REDEF
KV_STT
     11387**DCL     12267--CALL
KV_STT.REQSTATS.DSPMSK
     11633**DCL     11639--REDEF
KV_STT.REQSTATS.SLCMSK
     11674**DCL     11681--REDEF
KV_STT.SCHEXCTIM
     11744**DCL     12266<<ASSIGN
KY$CTX
     11777**DCL     12274>>ASSIGN
KY$CTX.DEFRD.STATUSW
     11919**DCL     11921--REDEF
KY$CTX.MODE
     11868**DCL     11876--REDEF
KY$CTX.STATUSW
     11795**DCL     11797--REDEF   11805--REDEF   11819--REDEF   11833--REDEF   11847--REDEF
KY$CTX.VDIENB
     11933**DCL     11939--REDEF
KYA$DISCON
     11759**DCL-ENT 12252--CALL
KYA$ENABLE
     11758**DCL-ENT 12250--CALL
KYK$KEYIN
PL6.E3A0      #001=KYA$ADMIN File=KYA$ADMIN.:E05TSI                              WED 07/30/97 02:39 Page:21   
     11761**DCL-ENT 12276--CALL
KY_STT_URP
     11036**DCL     12261--CALL
KY_STT_URP.REQSTATS.DSPMSK
     11282**DCL     11288--REDEF
KY_STT_URP.REQSTATS.SLCMSK
     11323**DCL     11330--REDEF
KY_STT_URP.USRSTT.INPINTISATIM
     11353**DCL     12266>>ASSIGN
KY_STT_URP.USRSTT.OTPINTISATIM
     11353**DCL     12266>>ASSIGN
ONEWORD
     12244**DCL     12275>>ASSIGN

PL6.E3A0      #002=KYA$DISCON File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:22   
       85        1        /*T***********************************************************/
       86        2        /*T*                                                         */
       87        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       88        4        /*T*                                                         */
       89        5        /*T***********************************************************/
       90        6        /*X*   DMR,PLM=7,IND=3,CTI=3,SDI=3,MCL=10,CSI=3,DTI=3,DCI=6,
       91        7               ECI=0,DIN=7,CSU=3,AND      */
       92        8        /*F*     NAME:    KYA$DISCON
       93        9                 PURPOSE: KYA$DISCON is called when a FEPCON command to
       94       10                          kill or disable a channel is received.  If VDH is
       95       11                          not executing, KYD$INIT_DISCON is called to start
       96       12                          the disconnect sequence.  If VDH is executing, the
       97       13                          reschedule bit for disconnect is set, and the call
       98       14                          to KYD$INIT_DISCON will be made from KYV$VDI.
       99       15        */
      100       16        KYA$DISCON: PROC(CHN$) ALTRET;
      101       17        /*
      102       18            Include files
      103       19        */
      104       20        %INCLUDE LCP_6;
      105     4299        %INCLUDE KH$CHN;
      106     4421        %INCLUDE KY_URP_M;
      107     4716        %INCLUDE KY_SUBS_C;
      108     4805        %INCLUDE KV_GLBCNS_E;
      109     5146        %INCLUDE KV$GLB;
      110     5565        %INCLUDE KV$GLBCTX;
      111     6010        %INCLUDE KL_MACRO_C;
      112     9362        %INCLUDE KL_AFCN_C;
      113     9463        %INCLUDE K_ID_E;
      114     9513        %K#ENTID_E;
      115     9532        %K#LYRID_E;
      116     9539        %INCLUDE KV_GLB_M;
      117     9661        /*
      118     9662            Parameters
      119     9663        */
      120     9664    1          DCL CHN$ PTR;
      121     9665        /*
PL6.E3A0      #002=KYA$DISCON File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:23   
      122     9666            Auto
      123     9667        */
      124     9668    1          DCL CTX$ PTR;
      125     9669    1          DCL OLDPTR$ PTR;
      126     9670        /*
      127     9671            Based
      128     9672        */
      129     9673        %KH$CHN (STCLASS="BASED(CHN$)");
      130     9797        %KY$CTX  ( NAME = KY$CTX, STCLASS = "BASED(CTX$)" );
      131     9974        %KV$VDI;
      132    10045        %KV$SSN;
      133    10124        %KV$STT;
      134    10518        %KV$PTR;
      135    10561        %KV$USRPRM;
      136    10612        %KV@USRENT;
      137    10632        /*
      138    10633            External interface
      139    10634        */
      140    10635    1          DCL KYD$INIT_DISCON ENTRY(1);
      141    10636        /**/
      142    10637        /* EQUs */
      143    10638        %KV_DSCRSN_E;
      144    10647        /**/
      145    10648        %EJECT;
PL6.E3A0      #002=KYA$DISCON File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:24   
      146    10649    1          CTX$ = KH$CHN.CTX$;
      147    10650    1          IF CTX$ = ADDR(NIL) THEN
      148    10651    1             RETURN;
      149    10652        /*
      150    10653                what has probably happened here is that we aborted on a
      151    10654                connect to vdi.  usually because of insufficient memory.
      152    10655                the context that the channel table points to is really
      153    10656                not there so nil it out and return.
      154    10657        */
      155    10658    1          IF KY$CTX.VDI$ = ADDR(NIL) THEN
      156    10659    2             DO;
      157    10660    2                KH$CHN.CTX$ = ADDR(NIL);
      158    10661    2                RETURN;
      159    10662    2             END;
      160    10663    1          KY$CTX.DSCRSN = %KV_DSCRSN_FRG;
      161    10664               %KV$USRENT (VDI$="KY$CTX.VDI$",DFR$=DFR,SCHRSN=1);
             10677    1           KY$CTX.VDI$->KV$VDI.USRPRM$->KV$USRPRM.STT$->KV$STT.USRENTCNT =
             10677                    KY$CTX.VDI$->KV$VDI.USRPRM$->KV$USRPRM.STT$->KV$STT.USRENTCNT + 1;
             10678    2           IF NOT KY$CTX.VDI$->KV$VDI.BSY THEN DO;
             10679    2              KY$CTX.VDI$->KV$VDI.BSY = '1'B;
             10680    2              KV@USRENT.SVDPTR$ = KV$PTR$;
             10681    2              KV$PTR$ = KY$CTX.VDI$->KV$VDI.ASNINPPTR$;
             10682    2              END;                         /* ELSE IF ~BSY                       */
             10683    2           ELSE DO;
             10684    2              KY$CTX.VDI$->KV$VDI.DFR.USR(1) = '1'B;
             10685    2           KY$CTX.VDI$->KV$VDI.USRPRM$->KV$USRPRM.STT$->KV$STT.USRENTDFRCNT =
             10685                    KY$CTX.VDI$->KV$VDI.USRPRM$->KV$USRPRM.STT$->KV$STT.USRENTDFRCNT + 1;
             10686    2              GOTO DFR;
             10687    2              END;                         /* END IF                             */
      162    10690    1          CALL KYD$INIT_DISCON(KY$CTX);
      163    10691               %KV$USREXT;
             10697    1           KV$PTR.VDI$->KV$VDI.BSY = '0'B;
             10699    1           KV$PTR$ = KV@USRENT.SVDPTR$;
      164    10701    1          RETURN;
      165    10702    1   DFR:   ;
      166    10703    1          KY$CTX.RESCHEDULE.DSC = '1'B;
      167    10704    1          RETURN;
PL6.E3A0      #002=KYA$DISCON File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:25   
      168    10705    1   END KYA$DISCON;
      169    10706        /**/
      170    10707        %EOD;

PL6.E3A0      #002=KYA$DISCON File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:26   
--  Include file information  --

   KV_GLB_M.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KV$GLBCTX.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   KY_SUBS_C.:E05TOU  is referenced.
   KY_URP_M.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KYA$DISCON.

   Procedure KYA$DISCON requires 113 words for executable code.
   Procedure KYA$DISCON requires 12 words of local(AUTO) storage.

PL6.E3A0      #002=KYA$DISCON File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:27   

 Object Unit name= KYA$DISCON                                 File name= KYA$ADMIN.:E05TOU
 UTS= JUL 30 '97 02:40:03.44 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   Proc  even  none   113     71  KYA$DISCON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        1  KYA$DISCON

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 KYD$INIT_DISCON
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6A_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KV$PTR$                          r    G$ROS$
PL6.E3A0      #002=KYA$DISCON File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:28   


       85        1        /*T***********************************************************/
       86        2        /*T*                                                         */
       87        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       88        4        /*T*                                                         */
       89        5        /*T***********************************************************/
       90        6        /*X*   DMR,PLM=7,IND=3,CTI=3,SDI=3,MCL=10,CSI=3,DTI=3,DCI=6,
       91        7               ECI=0,DIN=7,CSU=3,AND      */
       92        8        /*F*     NAME:    KYA$DISCON
       93        9                 PURPOSE: KYA$DISCON is called when a FEPCON command to
       94       10                          kill or disable a channel is received.  If VDH is
       95       11                          not executing, KYD$INIT_DISCON is called to start
       96       12                          the disconnect sequence.  If VDH is executing, the
       97       13                          reschedule bit for disconnect is set, and the call
       98       14                          to KYD$INIT_DISCON will be made from KYV$VDI.
       99       15        */
      100       16        KYA$DISCON: PROC(CHN$) ALTRET;

     16   0 000000  D380 0000 0000  xent KYA$DISCON      LNJ,B5   X6A_AUTO_1
          0 000003       000C 0001                       DC       12,1

      101       17        /*
      102       18            Include files
      103       19        */
      104       20        %INCLUDE LCP_6;
      105     4299        %INCLUDE KH$CHN;
      106     4421        %INCLUDE KY_URP_M;
      107     4716        %INCLUDE KY_SUBS_C;
      108     4805        %INCLUDE KV_GLBCNS_E;
      109     5146        %INCLUDE KV$GLB;
      110     5565        %INCLUDE KV$GLBCTX;
      111     6010        %INCLUDE KL_MACRO_C;
      112     9362        %INCLUDE KL_AFCN_C;
      113     9463        %INCLUDE K_ID_E;
      114     9513        %K#ENTID_E;
      115     9532        %K#LYRID_E;
      116     9539        %INCLUDE KV_GLB_M;
PL6.E3A0      #002=KYA$DISCON File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:29   
      117     9661        /*
      118     9662            Parameters
      119     9663        */
      120     9664    1          DCL CHN$ PTR;
      121     9665        /*
      122     9666            Auto
      123     9667        */
      124     9668    1          DCL CTX$ PTR;
      125     9669    1          DCL OLDPTR$ PTR;
      126     9670        /*
      127     9671            Based
      128     9672        */
      129     9673        %KH$CHN (STCLASS="BASED(CHN$)");
      130     9797        %KY$CTX  ( NAME = KY$CTX, STCLASS = "BASED(CTX$)" );
      131     9974        %KV$VDI;
      132    10045        %KV$SSN;
      133    10124        %KV$STT;
      134    10518        %KV$PTR;
      135    10561        %KV$USRPRM;
      136    10612        %KV@USRENT;
      137    10632        /*
      138    10633            External interface
      139    10634        */
      140    10635    1          DCL KYD$INIT_DISCON ENTRY(1);
      141    10636        /**/
      142    10637        /* EQUs */
      143    10638        %KV_DSCRSN_E;
      144    10647        /**/
      145    10648        %EJECT;
PL6.E3A0      #002=KYA$DISCON File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:30   
      146    10649    1          CTX$ = KH$CHN.CTX$;

  10649   0 000005  ECC7 0004                            LDB,B6   @CHN$,AUTO
          0 000007  DC86                                 LDB,B5   ,B6
          0 000008  CCC5 000C                            LDB,B4   12,B5
          0 00000A  CFC7 0006                            STB,B4   CTX$,AUTO

      147    10650    1          IF CTX$ = ADDR(NIL) THEN

  10650   0 00000C  8DC7 0006                            CMN      CTX$,AUTO
          0 00000E  0981 0004                            BNE      s:10658,PREL

      148    10651    1             RETURN;

  10651   0 000010  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      149    10652        /*
      150    10653                what has probably happened here is that we aborted on a
      151    10654                connect to vdi.  usually because of insufficient memory.
      152    10655                the context that the channel table points to is really
      153    10656                not there so nil it out and return.
      154    10657        */
      155    10658    1          IF KY$CTX.VDI$ = ADDR(NIL) THEN

  10658   0 000013  8DC4 0008                            CMN      8,B4
          0 000015  0981 0009                            BNE      s:10663,PREL

      156    10659    2             DO;

      157    10660    2                KH$CHN.CTX$ = ADDR(NIL);

  10660   0 000017  BB80 0000 0000                       LAB,B3   0
          0 00001A  BFC5 000C                            STB,B3   12,B5

      158    10661    2                RETURN;

  10661   0 00001C  C380 0000 0000  xent                 LNJ,B4   X6A_ARET
PL6.E3A0      #002=KYA$DISCON File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:31   

      159    10662    2             END;
      160    10663    1          KY$CTX.DSCRSN = %KV_DSCRSN_FRG;

  10663   0 00001F  6C03                                 LDV,R6   3
          0 000020  EAC4 0021                            SRM,R6,'00FF'X    33,B4
          0 000022       00FF

      161    10664               %KV$USRENT (VDI$="KY$CTX.VDI$",DFR$=DFR,SCHRSN=1);
             10677    1           KY$CTX.VDI$->KV$VDI.USRPRM$->KV$USRPRM.STT$->KV$STT.USRENTCNT =
             10677                    KY$CTX.VDI$->KV$VDI.USRPRM$->KV$USRPRM.STT$->KV$STT.USRENTCNT + 1;

  10677   0 000023  DCC4 0008                            LDB,B5   8,B4
          0 000025  BCC5 0008                            LDB,B3   8,B5
          0 000027  ACC3 0033                            LDB,B2   51,B3
          0 000029  8AC2 0039                            INC      57,B2
          0 00002B  8EC2 0038                            CAD      56,B2

             10678    2           IF NOT KY$CTX.VDI$->KV$VDI.BSY THEN DO;

  10678   0 00002D  DCC4 0008                            LDB,B5   8,B4
          0 00002F  82C5 0019                            LB,'0080'X        25,B5
          0 000031       0080
          0 000032  0501 0012                            BBT      s:10684,PREL

             10679    2              KY$CTX.VDI$->KV$VDI.BSY = '1'B;

  10679   0 000034  8945 0019                            LBT,'0080'X       25,B5
  10679   0 000036       0080

             10680    2              KV@USRENT.SVDPTR$ = KV$PTR$;

  10680   0 000037  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          0 00003A  DFC7 000A                            STB,B5   KV@USRENT,AUTO

             10681    2              KV$PTR$ = KY$CTX.VDI$->KV$VDI.ASNINPPTR$;

PL6.E3A0      #002=KYA$DISCON File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:32   
  10681   0 00003C  BCC4 0008                            LDB,B3   8,B4
          0 00003E  ACC3 0006                            LDB,B2   6,B3
          0 000040  AF80 0000 0000  xsym                 STB,B2   KV$PTR$

             10682    2              END;                         /* ELSE IF ~BSY                       */

  10682   0 000043  0F81 0010                            B        s:10690,PREL

             10683    2           ELSE DO;

             10684    2              KY$CTX.VDI$->KV$VDI.DFR.USR(1) = '1'B;

  10684   0 000045  8945 0018                            LBT,'4000'X       24,B5
  10684   0 000047       4000

             10685    2           KY$CTX.VDI$->KV$VDI.USRPRM$->KV$USRPRM.STT$->KV$STT.USRENTDFRCNT =
             10685                    KY$CTX.VDI$->KV$VDI.USRPRM$->KV$USRPRM.STT$->KV$STT.USRENTDFRCNT + 1;

  10685   0 000048  DCC4 0008                            LDB,B5   8,B4
          0 00004A  BCC5 0008                            LDB,B3   8,B5
          0 00004C  ACC3 0033                            LDB,B2   51,B3
          0 00004E  8AC2 003B                            INC      59,B2
          0 000050  8EC2 003A                            CAD      58,B2

             10686    2              GOTO DFR;

  10686   0 000052  0F81 0018                            B        s:10699,PREL

             10687    2              END;                         /* END IF                             */
      162    10690    1          CALL KYD$INIT_DISCON(KY$CTX);

  10690   0 000054  BBC7 0006                            LAB,B3   CTX$,AUTO
          0 000056  CBF0 0100                            LAB,B4   256,IMO
          0 000058  E380 0000 0000  xent                 LNJ,B6   KYD$INIT_DISCON
          0 00005B       0001                            DC       s:10697,PREL

      163    10691               %KV$USREXT;
PL6.E3A0      #002=KYA$DISCON File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:33   
             10697    1           KV$PTR.VDI$->KV$VDI.BSY = '0'B;

  10697   0 00005C  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          0 00005F  DC86                                 LDB,B5   ,B6
          0 000060  8845 0019                            LBF,'0080'X       25,B5
          0 000062       0080

             10699    1           KV$PTR$ = KV@USRENT.SVDPTR$;

  10699   0 000063  DCC7 000A                            LDB,B5   KV@USRENT,AUTO
          0 000065  DF80 0000 0000  xsym                 STB,B5   KV$PTR$

      164    10701    1          RETURN;

  10701   0 000068  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

  10699   0                              DFR             null
      165    10702    1   DFR:   ;
      166    10703    1          KY$CTX.RESCHEDULE.DSC = '1'B;

  10703   0 00006B  8944 0021            DFR             LBT,'1000'X       33,B4
  10703   0 00006D       1000

      167    10704    1          RETURN;

  10704   0 00006E  C380 0000 0000  xent                 LNJ,B4   X6A_ARET
      168    10705    1   END KYA$DISCON;
      169    10706        /**/
      170    10707        %EOD;

PL6.E3A0      #002=KYA$DISCON File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:34   
--  Include file information  --

   KV_GLB_M.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KV$GLBCTX.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   KY_SUBS_C.:E05TOU  is referenced.
   KY_URP_M.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KYA$DISCON.
PL6.E3A0      #002=KYA$DISCON File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:35   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @CHN$                     *0-0-0/w PTR         r     1 CHN$
     6-0-0/w PTR         r     1 CTX$                       A-0-0/w STRC(32)    r     1 KV@USRENT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KV$PTR$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(512)   r     1 KH$CHN                     0-0-0/w STRC(480)   r     1 KV$PTR
     0-0-0/w STRC(8960)  r     1 KV$STT                     0-0-0/w STRC(912)   r     1 KV$USRPRM
     0-0-0/w STRC(512)   r     1 KV$VDI                     0-0-0/w STRC(608)   r     1 KY$CTX


   Procedure KYA$DISCON requires 113 words for executable code.
   Procedure KYA$DISCON requires 12 words of local(AUTO) storage.
PL6.E3A0      #002=KYA$DISCON File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:36   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=KYA$DISCON File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:37   
          MINI XREF LISTING

CHN$
      9664**DCL        16--PROC     9688--IMP-PTR 10649>>ASSIGN  10660>>ASSIGN
CTX$
      9668**DCL      9808--IMP-PTR 10649<<ASSIGN  10650>>IF      10658>>IF      10663>>ASSIGN  10677>>ASSIGN
     10677>>ASSIGN  10678>>IF      10679>>ASSIGN  10681>>ASSIGN  10684>>ASSIGN  10685>>ASSIGN  10685>>ASSIGN
     10690>>CALL    10703>>ASSIGN
DFR
     10699**LABEL   10686--GOTO
KH$CHN.CTX$
      9758**DCL     10649>>ASSIGN  10660<<ASSIGN
KH$CHN.TERMID.TERM
      9784**DCL      9793--REDEF
KV$PTR.INPCNDPND
     10545**DCL     10554--REDEF   10558--REDEF
KV$PTR.LINLST$
     10541**DCL     10542--REDEF
KV$PTR.VDI$
     10539**DCL     10697>>ASSIGN
KV$PTR$
     10533**DCL     10539--IMP-PTR 10680>>ASSIGN  10681<<ASSIGN  10697>>ASSIGN  10699<<ASSIGN
KV$SSN.REDRSPCNT
     10074**DCL     10075--REDEF
KV$STT.REQSTATS.DSPMSK
     10397**DCL     10403--REDEF
KV$STT.REQSTATS.SLCMSK
     10438**DCL     10445--REDEF
KV$STT.USRENTCNT
     10507**DCL     10677<<ASSIGN  10677>>ASSIGN
KV$STT.USRENTDFRCNT
     10508**DCL     10685<<ASSIGN  10685>>ASSIGN
KV$USRPRM.STT$
     10609**DCL     10677>>ASSIGN  10677>>ASSIGN  10685>>ASSIGN  10685>>ASSIGN
PL6.E3A0      #002=KYA$DISCON File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:38   
KV$VDI.ASNINPPTR$
      9996**DCL     10681>>ASSIGN
KV$VDI.BSY
     10030**DCL     10678>>IF      10679<<ASSIGN  10697<<ASSIGN
KV$VDI.DFR.USR
     10027**DCL     10684<<ASSIGN
KV$VDI.USRPRM$
      9996**DCL     10677>>ASSIGN  10677>>ASSIGN  10685>>ASSIGN  10685>>ASSIGN
KV@USRENT.SVDPTR$
     10630**DCL     10680<<ASSIGN  10699>>ASSIGN
KY$CTX
      9808**DCL     10690<>CALL
KY$CTX.DEFRD.STATUSW
      9950**DCL      9952--REDEF
KY$CTX.DSCRSN
      9963**DCL     10663<<ASSIGN
KY$CTX.MODE
      9899**DCL      9907--REDEF
KY$CTX.RESCHEDULE.DSC
      9961**DCL     10703<<ASSIGN
KY$CTX.STATUSW
      9826**DCL      9828--REDEF    9836--REDEF    9850--REDEF    9864--REDEF    9878--REDEF
KY$CTX.VDI$
      9893**DCL     10658>>IF      10677>>ASSIGN  10677>>ASSIGN  10678>>IF      10679>>ASSIGN  10681>>ASSIGN
     10684>>ASSIGN  10685>>ASSIGN  10685>>ASSIGN
KY$CTX.VDIENB
      9964**DCL      9970--REDEF
KYD$INIT_DISCON
     10635**DCL-ENT 10690--CALL

PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:39   
      171        1        /*T***********************************************************/
      172        2        /*T*                                                         */
      173        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      174        4        /*T*                                                         */
      175        5        /*T***********************************************************/
      176        6        /*X*   DMR,PLM=7,IND=3,CTI=3,SDI=3,MCL=10,CSI=3,DTI=3,DCI=6,
      177        7               ECI=0,DIN=7,CSU=3,AND      */
      178        8
      179        9
      180       10        /*F*    NAME:    KYA$ENABLE
      181       11                PURPOSE: KYA$ENABLE is called to connect URP devices.  The
      182       12                         following functions are performed:
      183       13                            1.  Get and initialize device context.
      184       14                            2.  Initialize VDH.
      185       15                            3.  Call VDH to connect device.
      186       16                                                                           */
      187       17        KYA$ENABLE: PROC(CHN$) ALTRET;
      188       18        /**/
      189       19        /* INCLUDE FILES */
      190       20        /**/
      191       21        %INCLUDE LCP_6;
      192     4300        %INCLUDE GH_HARDWARE_M;
      193     4398        %INCLUDE KH$CHN;
      194     4520        %INCLUDE KL_MACRO_C;
      195     7872        %INCLUDE KL_SUPER_C;
      196    10774        %INCLUDE KV$GLBCTX;
      197    11219        %INCLUDE KV$VDH;
      198    11650        %INCLUDE KV$GLB;
      199    12069        %INCLUDE KV_GLB_M;
      200    12191        %INCLUDE KV$PRM;
      201    12404        %INCLUDE KV_GLBCNS_E;
      202    12745        %INCLUDE KV_PRMID_E;
      203    12919        %INCLUDE KY_URP_M;
      204    13214        %INCLUDE KY_SUBS_C;
      205    13303        %INCLUDE KH$STT;
      206    13333        %INCLUDE KL_AFCN_C;
      207    13434        %INCLUDE K_ID_E;
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:40   
      208    13484        %INCLUDE KHC_MAC_C;
      209    13525        %INCLUDE KH_MACRO_C;
      210    14268        %INCLUDE KL_CONTROL_C;
      211    14648        %K#LYRID_E;
      212    14655        %K#ENTID_E;
      213    14674
      214    14675        %INCLUDE KY_DATA_R;
      215    15470        /* EQUs */
      216    15471        %KV_PRMID_E;
      217    15627        %KV_USR_FNC_E;
      218    15643        %KV_USR_EVT_ID_E;
      219    15663        %KV_INPUNT_E;
      220    15668        %KV_VDH_EVT_ID_E;
      221    15674        /**/
      222    15675        /* BASED */
      223    15676        /**/
      224    15677        %KY$CTX (NAME=KY$CTX,STCLASS="BASED(CTX$)");
      225    15854        %KY$CTX  ( NAME = KY$NEXTCTX, STCLASS = BASED );
      226    16031        %KH$CHN (STCLASS="BASED(CHN$)");
      227    16155        %KV$VDI (NAME=KV$VDI,STCLASS="BASED(VDI$)");
      228    16226        %KV$PTR (NAME=KV$PTR,STCLASS="BASED(KV$PTR$)");
      229    16269        %KV$MRD (NAME=KV$MRD,STCLASS="BASED(MRD$)");
      230    16316        %KV$MVD (NAME=KV$MVD,STCLASS="BASED(MVD$)");
      231    16360        %KH$CTLTBL (FPTN=KH$CTLTBL,STCLASS="BASED(KH_CTLTBL$)");
      232    16572    1          DCL KH_CTLTBL$ PTR SYMREF;
      233    16573        %INHIBIT_DCLS;
      234    16585    1          DCL ONEWORD UBIN BASED;
      235    16586        /**/
      236    16587        /* AUTO */
      237    16588        /**/
      238    16589    1          DCL ABRTCODE SBIN;
      239    16590    1          DCL SIZE UBIN;
      240    16591    1          DCL T$ PTR;
      241    16592    1          DCL CHN$ PTR;
      242    16593    1          DCL CTX$ PTR;
      243    16594    1          DCL VDI$ PTR;
      244    16595    1          DCL MRD$ PTR;
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:41   
      245    16596    1          DCL MVD$ PTR;
      246    16597    1          DCL SAVEPTR$ PTR;
      247    16598        %KV$VDH_INT (NAME=KV$VDH_INT,STCLASS=AUTO);
      248    16635        %KV$VDH_CNC (NAME=KV$VDH_CNC,STCLASS=AUTO);
      249    16727        %KV$VDH_EVT (NAME=KV$VDH_EVT,STCLASS=AUTO);
      250    16762        /**/
      251    16763        /* STATIC */
      252    16764        /**/
      253    16765        %KY$CTX  ( NAME = KY_CTX, STCLASS = STATIC );
      254    16942        /**/
      255    16943        /* SYMREF */
      256    16944        /**/
      257    16945        %KV$VDH_INT (NAME=KV_VDH_INT,STCLASS=SYMREF);
      258    16982        %KV$VDH_CNC (NAME=KV_VDH_CNC,STCLASS=SYMREF);
      259    17074        %KV$VDH_EVT  ( NAME = KV_VDH_EVT, STCLASS = SYMREF );
      260    17109        %KV_DSCRSN_E;
      261    17118        /**/
      262    17119        /* EXTERNAL ROUTINES */
      263    17120        /**/
      264    17121    1          DCL KYN$ENABLE ENTRY;
      265    17122    1          DCL KYN$DISABLE ENTRY;
      266    17123    1          DCL KVB$GET2NSYS ENTRY(2) ALTRET;
      267    17124    1          DCL KVB$RLS2NSYS ENTRY(2) ALTRET;
      268    17125    1          DCL KVV$INT ENTRY(1) ALTRET;
      269    17126    1          DCL KVV$VDI ENTRY(1) ALTRET;
      270    17127        %EJECT;
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:42   
      271    17128        /*      IF KH$CHN.LGNTXT$=ADDR(NIL) THEN
      272    17129                                                  ALTRETURN; */
      273    17130        /**/
      274    17131        /* INITIALIZE DEVICE CONTEXT */
      275    17132        /**/
      276    17133    1          ABRTCODE=0;
      277    17134    1          SIZE = %KY#CTXBLKSIZ;
      278    17135    1          CALL KVB$GET2NSYS(SIZE,T$) ALTRET(NO_CTX_MEM);
      279    17136    1          KY_STT_URP.USRSTT.CTXBYTUTL = KY_STT_URP.USRSTT.CTXBYTUTL + SIZEW(KY$CTX) * 2
             17136                   ;
      280    17137    1          CTX$=T$;
      281    17138    1          KY$CTX = KY_CTX;
      282    17139    1          KY$CTX.TIMEOUT = %KY#DEV_TIMEOUT_CNT;
      283    17140    1          KY$CTX.DVC_STATE=%KY#ST_NONINIT;
      284    17141    1          KY$CTX.DVC_ID=BITBIN(KH$CHN.DVCID);
      285    17142    1          KY$CTX.CHAN=KH$CHN.CHNBIT0_9;
      286    17143    1          KY$CTX.VDIENB.STRENB(%KV_USR_FNC_EVT)='1'B;
      287    17144    1          KY$CTX.VDIENB.STRENB(%KV_USR_FNC_SETPRM)='1'B;
      288    17145    1          KY$CTX.VDIENB.EVTENB(%KV_USR_EVT_ID_LGNACP)='1'B;
      289    17146    1          KY$CTX.VDIENB.EVTENB(%KV_USR_EVT_ID_LGNRJC)='1'B;
      290    17147    1          KY$CTX.VDIENB.EVTENB(%KV_USR_EVT_ID_SCH)='1'B;
      291    17148    1          KY$CTX.VDIENB.EVTENB(%KV_USR_EVT_ID_RLSSTR)='1'B;
      292    17149    1          KY$CTX.VDIENB.EVTENB(%KV_USR_EVT_ID_RLSVDI)='1'B;
      293    17150    1          KV$VDH_INT=KV_VDH_INT;
      294    17151    1          IF KH$CHN.ATTR & %G_ATTR_UR_LP THEN
      295    17152    2             DO;
      296    17153    2                KY$CTX.VFU_LOADED = '0'B;
      297    17154    2                KY$CTX.DVCTYP = %KY#TYP_LP;
      298    17155    2             END;
      299    17156    1          ELSE
      300    17157    1             IF KH$CHN.ATTR & %G_ATTR_UR_CR THEN
      301    17158    1                KY$CTX.DVCTYP = %KY#TYP_CR;
      302    17159    1             ELSE
      303    17160    1                IF KH$CHN.ATTR & %G_ATTR_UR_CP THEN
      304    17161    1                   KY$CTX.DVCTYP = %KY#TYP_CP;
      305    17162    1          KY_STT_URP.NUMDVC(KY$CTX.DVCTYP) = KY_STT_URP.NUMDVC(KY$CTX.DVCTYP) + 1;
      306    17163               /* save the vdh pointer */
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:43   
      307    17164    1          SAVEPTR$ = KV$PTR$;
      308    17165    1          KY_USRPRM.SETPRMPSTPRC(%KV_PRMID_VFU) = '1'B;
      309    17166    1          KY_USRPRM.SETPRMPSTPRC(%KV_PRMID_PLATEN) = '1'B;
      310    17167    1          KY_USRPRM.SETPRMPSTPRC(%KV_PRMID_FIRSTLINE) = '1'B;
      311    17168    1          KY_USRPRM.SETPRMPSTPRC(%KV_PRMID_LPI) = '1'B;
      312    17169        /**/
      313    17170        /* MAKE INITIALIZE CALL TO VDH */
      314    17171        /**/
      315    17172    1          KV$VDH_INT.CHN$=CHN$;
      316    17173    1          KV$VDH_INT.USRCTX$=CTX$;
      317    17174    1          IF KH$CHN.BLOCK~=0 THEN
      318    17175    1             KV$VDH_INT.RCVFLWCTRMAXCRD = KH$CHN.BLOCK;
      319    17176    1          KV$VDH_INT.USRPRM$ = ADDR(KY_USRPRM);
      320    17177    2          CALL KVV$INT(KV$VDH_INT) WHENALTRETURN DO;
      321    17178    2                GOTO VDH_INT_ABR;
      322    17179    2             END;                          /* whenaltreturn do*/
      323    17180    1          VDI$=KV$VDH_INT.VDI$;
      324    17181    1          KY$CTX.VDI$=VDI$;
      325    17182        /**/
      326    17183        /* INITIALIZE EVENT ENABLE. */
      327    17184        /* FOR NOW THIS IS THE SAME FOR ALL URP DEVICES. */
      328    17185        /**/
      329    17186    1          KV$VDI.USREVTENB(%KV_USR_EVT_ID_CLS)='1'B;
      330    17187    1          KV$VDI.USREVTENB(%KV_USR_EVT_ID_LGNACP)='1'B;
      331    17188    1          KV$VDI.USREVTENB(%KV_USR_EVT_ID_LGNRJC)='1'B;
      332    17189    1          KV$VDI.USREVTENB(%KV_USR_EVT_ID_OPN)='1'B;
      333    17190    1          KV$VDI.USREVTENB(%KV_USR_EVT_ID_RLSSTR)='1'B;
      334    17191    1          KV$VDI.USREVTENB(%KV_USR_EVT_ID_SCH)='1'B;
      335    17192    1          KV$VDI.USREVTENB(%KV_USR_EVT_ID_RLSVDI)='0'B;
      336    17193    1          IF KY$CTX.DVCTYP = %KY#TYP_CR THEN
      337    17194    2             DO;
      338    17195    2                KV$VDI.INPUNT = %KV_INPUNT_RCR;
      339    17196    2             END;                          /* IF DVCTYP = CR */
      340    17197    1          ELSE
      341    17198    2             DO;
      342    17199    2                IF KH$CHN.BLOCK~=0 THEN
      343    17200    2                   KY$CTX.Q.UPRLIMIT = KH$CHN.BLOCK;
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:44   
      344    17201    2                ELSE
      345    17202    2                   KY$CTX.Q.UPRLIMIT = KY_BLOCK;
      346    17203    2                IF KH$CHN.UNBLOCK~=0 THEN
      347    17204    2                   KY$CTX.Q.LOWRLIMIT = KH$CHN.UNBLOCK;
      348    17205    2                ELSE
      349    17206    2                   KY$CTX.Q.LOWRLIMIT = KY_UNBLOCK;
      350    17207    2             END;                          /* ELSE
      351    17208                                                         */
      352    17209        /**/
      353    17210        /* CALL VDH TO CONNECT */
      354    17211        /**/
      355    17212    1          KV$VDH_CNC=KV_VDH_CNC;
      356    17213    1          KV$VDH_CNC.LCLENDPNTID = KH$CHN.TERMID;
      357    17214    1          KV$VDH_CNC.LCLENDPNTID.TTYP = %KLTY_URP#;
      358    17215    1          CALL KVV$VDI(KV$VDH_CNC) ALTRET(VDH_CNC_ABR);
      359    17216    1          IF KY$CTX.DVCTYP=%KY#TYP_LP THEN
      360    17217    2             DO;
      361    17218    2                KV$VDI.USEOTPBFR='1'B;
      362    17219    2                KV$VDI.USEOTPBFRBNR='1'B;
      363    17220    2                KV$VDI.USEOTPBFRTRN='1'B;
      364    17221    2                MRD$=KV$PTR.MRD$;
      365    17222    2                KV$MRD.CTNFRM='1'B;
      366    17223    2                KV$MRD.MINSP_FORPST = 0;
      367    17224    2             END;
      368    17225    1          ELSE
      369    17226    2             DO;
      370    17227    2                KV$VDI.USEOTPBFR='0'B;
      371    17228    2                KV$VDI.USEOTPBFRBNR='0'B;
      372    17229    2                KV$VDI.USEOTPBFRTRN='0'B;
      373    17230    2             END;
      374    17231    1          KH$CHN.CTX$ = CTX$;
      375    17232    1          KH$CHN.TERMID.TTYP = %KLTY_URP#;
      376    17233    1          KV$PTR$ = SAVEPTR$;
      377    17234    1          CALL KYN$DISABLE;
      378    17235    1          KY$CTX.NEXT$ = KY_FIRSTCTX$;
      379    17236    1          IF KY_FIRSTCTX$ ~= ADDR(NIL) THEN
      380    17237    2             DO;
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:45   
      381    17238    2                KY_FIRSTCTX$->KY$NEXTCTX.PRIOR$ = CTX$;
      382    17239    2             END;                          /* IF KY_FIRSTCTX$ ~= ADDR(NIL) */
      383    17240    1          KY_FIRSTCTX$ = CTX$;
      384    17241    1          CALL KYN$ENABLE;
      385    17242    1          RETURN;
      386    17243        /**/
      387    17244        /* BACK OUT FOR ONE REASON OR ANOTHER */
      388    17245        /**/
      389    17246    1   VDH_CNC_ABR:
      390    17247    1          ABRTCODE=ABRTCODE+1;
      391    17248    1          KV$VDH_EVT=KV_VDH_EVT;
      392    17249    1          KY$CTX.DSCRSN = %KV_DSCRSN_RSRSHR;
      393    17250    1          KV$VDH_EVT.ID=%KV_VDH_EVT_ID_RLSVDI;
      394    17251    1          CALL KVV$VDI(KV$VDH_EVT);
      395    17252        /*
      396    17253                nil out vdi$ so that we can use kha routines to
      397    17254                manipulate line.
      398    17255        */
      399    17256    1          RETURN;                          /* ctx mem released on end action. */
      400    17257    1   VDH_INT_ABR:
      401    17258    1          ABRTCODE=ABRTCODE+1;
      402    17259    1          T$=CTX$;
      403    17260    1          CALL KVB$RLS2NSYS(%KY#CTXBLKSIZ,T$);
      404    17261    1          KY_STT_URP.USRSTT.CTXBYTUTL = KY_STT_URP.USRSTT.CTXBYTUTL - SIZEW(KY$CTX) * 2
             17261                   ;
      405    17262    1   NO_CTX_MEM:
      406    17263    1          ABRTCODE=ABRTCODE+1;
      407    17264        /* ERROR LOG ENABLE ABORT */
      408    17265    1          RETURN;
      409    17266    1   END KYA$ENABLE;

PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:46   
--  Include file information  --

   KY_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
   KHC_MAC_C.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KY_SUBS_C.:E05TOU  is referenced.
   KY_URP_M.:E05TOU  is referenced.
   KV_PRMID_E.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   KV$PRM.:E05TOU  is referenced.
   KV_GLB_M.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   KV$VDH.:E05TOU  is referenced.
   KV$GLBCTX.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   GH_HARDWARE_M.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KYA$ENABLE.

   Procedure KYA$ENABLE requires 468 words for executable code.
   Procedure KYA$ENABLE requires 64 words of local(AUTO) storage.
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:47   

    No errors detected in file KYA$ADMIN.:E05TSI    .

PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:48   

 Object Unit name= KYA$ENABLE                                 File name= KYA$ADMIN.:E05TOU
 UTS= JUL 30 '97 02:40:50.92 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   Data  even  none    38     26  KYA$ENABLE
    1   Proc  even  none   468    1D4  KYA$ENABLE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        1  KYA$ENABLE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 KVB$GET2NSYS
 yes     yes           Std       2 KVB$RLS2NSYS
 yes     yes           Std       1 KVV$INT
 yes     yes           Std       1 KVV$VDI
         yes           Std       0 KYN$DISABLE
         yes           Std       0 KYN$ENABLE
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6A_ARET
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:49   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KY_USRPRM                             KY_FIRSTCTX$                          KY_STT_URP
     KY_BLOCK                              KY_UNBLOCK                            KV$PTR$
     KH_CTLTBL$                            KV_VDH_INT                            KV_VDH_CNC
     KV_VDH_EVT                       r    G$ROS$
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:50   


      171        1        /*T***********************************************************/
      172        2        /*T*                                                         */
      173        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      174        4        /*T*                                                         */
      175        5        /*T***********************************************************/
      176        6        /*X*   DMR,PLM=7,IND=3,CTI=3,SDI=3,MCL=10,CSI=3,DTI=3,DCI=6,
      177        7               ECI=0,DIN=7,CSU=3,AND      */
      178        8
      179        9
      180       10        /*F*    NAME:    KYA$ENABLE
      181       11                PURPOSE: KYA$ENABLE is called to connect URP devices.  The
      182       12                         following functions are performed:
      183       13                            1.  Get and initialize device context.
      184       14                            2.  Initialize VDH.
      185       15                            3.  Call VDH to connect device.
      186       16                                                                           */
      187       17        KYA$ENABLE: PROC(CHN$) ALTRET;

     17   1 000000  D380 0000 0000  xent KYA$ENABLE      LNJ,B5   X6A_AUTO_1
          1 000003       0040 0001                       DC       64,1

      188       18        /**/
      189       19        /* INCLUDE FILES */
      190       20        /**/
      191       21        %INCLUDE LCP_6;
      192     4300        %INCLUDE GH_HARDWARE_M;
      193     4398        %INCLUDE KH$CHN;
      194     4520        %INCLUDE KL_MACRO_C;
      195     7872        %INCLUDE KL_SUPER_C;
      196    10774        %INCLUDE KV$GLBCTX;
      197    11219        %INCLUDE KV$VDH;
      198    11650        %INCLUDE KV$GLB;
      199    12069        %INCLUDE KV_GLB_M;
      200    12191        %INCLUDE KV$PRM;
      201    12404        %INCLUDE KV_GLBCNS_E;
      202    12745        %INCLUDE KV_PRMID_E;
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:51   
      203    12919        %INCLUDE KY_URP_M;
      204    13214        %INCLUDE KY_SUBS_C;
      205    13303        %INCLUDE KH$STT;
      206    13333        %INCLUDE KL_AFCN_C;
      207    13434        %INCLUDE K_ID_E;
      208    13484        %INCLUDE KHC_MAC_C;
      209    13525        %INCLUDE KH_MACRO_C;
      210    14268        %INCLUDE KL_CONTROL_C;
      211    14648        %K#LYRID_E;
      212    14655        %K#ENTID_E;
      213    14674
      214    14675        %INCLUDE KY_DATA_R;
      215    15470        /* EQUs */
      216    15471        %KV_PRMID_E;
      217    15627        %KV_USR_FNC_E;
      218    15643        %KV_USR_EVT_ID_E;
      219    15663        %KV_INPUNT_E;
      220    15668        %KV_VDH_EVT_ID_E;
      221    15674        /**/
      222    15675        /* BASED */
      223    15676        /**/
      224    15677        %KY$CTX (NAME=KY$CTX,STCLASS="BASED(CTX$)");
      225    15854        %KY$CTX  ( NAME = KY$NEXTCTX, STCLASS = BASED );
      226    16031        %KH$CHN (STCLASS="BASED(CHN$)");
      227    16155        %KV$VDI (NAME=KV$VDI,STCLASS="BASED(VDI$)");
      228    16226        %KV$PTR (NAME=KV$PTR,STCLASS="BASED(KV$PTR$)");
      229    16269        %KV$MRD (NAME=KV$MRD,STCLASS="BASED(MRD$)");
      230    16316        %KV$MVD (NAME=KV$MVD,STCLASS="BASED(MVD$)");
      231    16360        %KH$CTLTBL (FPTN=KH$CTLTBL,STCLASS="BASED(KH_CTLTBL$)");
      232    16572    1          DCL KH_CTLTBL$ PTR SYMREF;
      233    16573        %INHIBIT_DCLS;
      234    16585    1          DCL ONEWORD UBIN BASED;
      235    16586        /**/
      236    16587        /* AUTO */
      237    16588        /**/
      238    16589    1          DCL ABRTCODE SBIN;
      239    16590    1          DCL SIZE UBIN;
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:52   
      240    16591    1          DCL T$ PTR;
      241    16592    1          DCL CHN$ PTR;
      242    16593    1          DCL CTX$ PTR;
      243    16594    1          DCL VDI$ PTR;
      244    16595    1          DCL MRD$ PTR;
      245    16596    1          DCL MVD$ PTR;
      246    16597    1          DCL SAVEPTR$ PTR;
      247    16598        %KV$VDH_INT (NAME=KV$VDH_INT,STCLASS=AUTO);
      248    16635        %KV$VDH_CNC (NAME=KV$VDH_CNC,STCLASS=AUTO);
      249    16727        %KV$VDH_EVT (NAME=KV$VDH_EVT,STCLASS=AUTO);
      250    16762        /**/
      251    16763        /* STATIC */
      252    16764        /**/
      253    16765        %KY$CTX  ( NAME = KY_CTX, STCLASS = STATIC );
      254    16942        /**/
      255    16943        /* SYMREF */
      256    16944        /**/
      257    16945        %KV$VDH_INT (NAME=KV_VDH_INT,STCLASS=SYMREF);
      258    16982        %KV$VDH_CNC (NAME=KV_VDH_CNC,STCLASS=SYMREF);
      259    17074        %KV$VDH_EVT  ( NAME = KV_VDH_EVT, STCLASS = SYMREF );
      260    17109        %KV_DSCRSN_E;
      261    17118        /**/
      262    17119        /* EXTERNAL ROUTINES */
      263    17120        /**/
      264    17121    1          DCL KYN$ENABLE ENTRY;
      265    17122    1          DCL KYN$DISABLE ENTRY;
      266    17123    1          DCL KVB$GET2NSYS ENTRY(2) ALTRET;
      267    17124    1          DCL KVB$RLS2NSYS ENTRY(2) ALTRET;
      268    17125    1          DCL KVV$INT ENTRY(1) ALTRET;
      269    17126    1          DCL KVV$VDI ENTRY(1) ALTRET;
      270    17127        %EJECT;
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:53   
      271    17128        /*      IF KH$CHN.LGNTXT$=ADDR(NIL) THEN
      272    17129                                                  ALTRETURN; */
      273    17130        /**/
      274    17131        /* INITIALIZE DEVICE CONTEXT */
      275    17132        /**/
      276    17133    1          ABRTCODE=0;

  17133   1 000005  8747 0008                            CL       ABRTCODE,AUTO

      277    17134    1          SIZE = %KY#CTXBLKSIZ;

  17134   1 000007  6C40                                 LDV,R6   64
          1 000008  EF47 0009                            STR,R6   SIZE,AUTO

      278    17135    1          CALL KVB$GET2NSYS(SIZE,T$) ALTRET(NO_CTX_MEM);

  17135   1 00000A  EBC7 000A                            LAB,B6   T$,AUTO
          1 00000C  EFC7 003E                            STB,B6   KV$VDH_EVT+4,AUTO
          1 00000E  DBC7 0009                            LAB,B5   SIZE,AUTO
          1 000010  DFC7 003C                            STB,B5   KV$VDH_EVT+2,AUTO
          1 000012  BBC7 003C                            LAB,B3   KV$VDH_EVT+2,AUTO
          1 000014  CBF0 0200                            LAB,B4   512,IMO
          1 000016  E380 0000 0000  xent                 LNJ,B6   KVB$GET2NSYS
          1 000019       01B6                            DC       s:17263,PREL

      279    17136    1         KY_STT_URP.USRSTT.CTXBYTUTL = KY_STT_URP.USRSTT.CTXBYTUTL + SIZEW(KY$CTX) * 2
             17136                   ;

  17136   1 00001A  8C80 0000 0020  xsym                 LDI      KY_STT_URP+32
          1 00001D  8470 0000 004C                       AID      76,IMO
          1 000020  8D00 0000 0020  xsym                 SDI      KY_STT_URP+32

      280    17137    1          CTX$=T$;

  17137   1 000023  ECC7 000A                            LDB,B6   T$,AUTO
          1 000025  EFC7 000C                            STB,B6   CTX$,AUTO

PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:54   
      281    17138    1          KY$CTX = KY_CTX;

  17138   1 000027  AB80 0000 0000  00                   LAB,B2   KY_CTX
          1 00002A  2C00                                 LDV,R2   0
          1 00002B  6C4C                                 LDV,R6   76
          1 00002C  BB86                                 LAB,B3   ,B6
          1 00002D  3C00                                 LDV,R3   0
          1 00002E  0008                                 MMM

      282    17139    1          KY$CTX.TIMEOUT = %KY#DEV_TIMEOUT_CNT;

  17139   1 00002F  6C12                                 LDV,R6   18
          1 000030  DCC7 000C                            LDB,B5   CTX$,AUTO
          1 000032  EAC5 000B                            SRM,R6,'00FF'X    11,B5
          1 000034       00FF

      283    17140    1          KY$CTX.DVC_STATE=%KY#ST_NONINIT;

  17140   1 000035  87C5 0004                            CLH      4,B5

      284    17141    1          KY$CTX.DVC_ID=BITBIN(KH$CHN.DVCID);

  17141   1 000037  CCC7 0004                            LDB,B4   @CHN$,AUTO
          1 000039  AC84                                 LDB,B2   ,B4
          1 00003A  D842 0002                            LDR,R5   2,B2
          1 00003C  DF45 0007                            STR,R5   7,B5

      285    17142    1          KY$CTX.CHAN=KH$CHN.CHNBIT0_9;

  17142   1 00003E  AC84                                 LDB,B2   ,B4
          1 00003F  C802                                 LDR,R4   ,B2
          1 000040  CAC5 000A                            SRM,R4,'FFC0'X    10,B5
          1 000042       FFC0

      286    17143    1          KY$CTX.VDIENB.STRENB(%KV_USR_FNC_EVT)='1'B;

  17143   1 000043  8945 0022                            LBT,'0800'X       34,B5
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:55   
  17143   1 000045       0800

      287    17144    1          KY$CTX.VDIENB.STRENB(%KV_USR_FNC_SETPRM)='1'B;

  17144   1 000046  8945 0022                            LBT,'0001'X       34,B5
  17144   1 000048       0001

      288    17145    1          KY$CTX.VDIENB.EVTENB(%KV_USR_EVT_ID_LGNACP)='1'B;

  17145   1 000049  8945 0023                            LBT,'0080'X       35,B5
  17145   1 00004B       0080

      289    17146    1          KY$CTX.VDIENB.EVTENB(%KV_USR_EVT_ID_LGNRJC)='1'B;

  17146   1 00004C  8945 0023                            LBT,'0040'X       35,B5
  17146   1 00004E       0040

      290    17147    1          KY$CTX.VDIENB.EVTENB(%KV_USR_EVT_ID_SCH)='1'B;

  17147   1 00004F  8945 0023                            LBT,'0008'X       35,B5
  17147   1 000051       0008

      291    17148    1          KY$CTX.VDIENB.EVTENB(%KV_USR_EVT_ID_RLSSTR)='1'B;

  17148   1 000052  8945 0023                            LBT,'0010'X       35,B5
  17148   1 000054       0010

      292    17149    1          KY$CTX.VDIENB.EVTENB(%KV_USR_EVT_ID_RLSVDI)='1'B;

  17149   1 000055  8945 0023                            LBT,'0001'X       35,B5
  17149   1 000057       0001

      293    17150    1          KV$VDH_INT=KV_VDH_INT;

  17150   1 000058  AB80 0000 0000  xsym                 LAB,B2   KV_VDH_INT
          1 00005B  2C00                                 LDV,R2   0
          1 00005C  6C16                                 LDV,R6   22
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:56   
          1 00005D  BB87                                 LAB,B3   ,AUTO
          1 00005E  3C2C                                 LDV,R3   44
          1 00005F  0008                                 MMM

      294    17151    1          IF KH$CHN.ATTR & %G_ATTR_UR_LP THEN

  17151   1 000060  DC84                                 LDB,B5   ,B4
          1 000061  E845 0005                            LDR,R6   5,B5
          1 000063  E570 8000                            AND,R6   -32768,IMO
          1 000065  6901 000B                            BEZ,R6   s:17157,PREL

      295    17152    2             DO;

      296    17153    2                KY$CTX.VFU_LOADED = '0'B;

  17153   1 000067  ACC7 000C                            LDB,B2   CTX$,AUTO
          1 000069  8842 0005                            LBF,'0040'X       5,B2
          1 00006B       0040

      297    17154    2                KY$CTX.DVCTYP = %KY#TYP_LP;

  17154   1 00006C  6C01                                 LDV,R6   1
          1 00006D  E7C2 000B                            STH,R6   11,B2

      298    17155    2             END;

  17155   1 00006F  0F81 0019                            B        s:17162,PREL

      299    17156    1          ELSE
      300    17157    1             IF KH$CHN.ATTR & %G_ATTR_UR_CR THEN

  17157   1 000071  E845 0005                            LDR,R6   5,B5
          1 000073  E570 4000                            AND,R6   16384,IMO
          1 000075  6901 0008                            BEZ,R6   s:17160,PREL

      301    17158    1                KY$CTX.DVCTYP = %KY#TYP_CR;

PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:57   
  17158   1 000077  6C03                                 LDV,R6   3
          1 000078  ACC7 000C                            LDB,B2   CTX$,AUTO
          1 00007A  E7C2 000B                            STH,R6   11,B2
          1 00007C  0F81 000C                            B        s:17162,PREL

      302    17159    1             ELSE
      303    17160    1                IF KH$CHN.ATTR & %G_ATTR_UR_CP THEN

  17160   1 00007E  E845 0005                            LDR,R6   5,B5
          1 000080  E570 2000                            AND,R6   8192,IMO
          1 000082  6901 0006                            BEZ,R6   s:17162,PREL

      304    17161    1                   KY$CTX.DVCTYP = %KY#TYP_CP;

  17161   1 000084  6C02                                 LDV,R6   2
          1 000085  ACC7 000C                            LDB,B2   CTX$,AUTO
          1 000087  E7C2 000B                            STH,R6   11,B2

      305    17162    1          KY_STT_URP.NUMDVC(KY$CTX.DVCTYP) = KY_STT_URP.NUMDVC(KY$CTX.DVCTYP) + 1;

  17162   1 000089  DCC7 000C                            LDB,B5   CTX$,AUTO
          1 00008B  B2C5 000B                            LLH,R3   11,B5
          1 00008D  BF47 003C                            STR,R3   KV$VDH_EVT+2,AUTO
          1 00008F  3001                                 SOL,R3   1
          1 000090  A847 003C                            LDR,R2   KV$VDH_EVT+2,AUTO
          1 000092  2001                                 SOL,R2   1
          1 000093  8AB0 0000 0023  xsym                 INC      KY_STT_URP+35,R3
          1 000096  8EA0 0000 0022  xsym                 CAD      KY_STT_URP+34,R2

      306    17163               /* save the vdh pointer */
      307    17164    1          SAVEPTR$ = KV$PTR$;

  17164   1 000099  AC80 0000 0000  xsym                 LDB,B2   KV$PTR$
          1 00009C  AFC7 0014                            STB,B2   SAVEPTR$,AUTO

      308    17165    1          KY_USRPRM.SETPRMPSTPRC(%KV_PRMID_VFU) = '1'B;

PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:58   
  17165   1 00009E  8900 0000 001C  xsym                 LBT,'2000'X       KY_USRPRM+28
  17165   1 0000A1       2000

      309    17166    1          KY_USRPRM.SETPRMPSTPRC(%KV_PRMID_PLATEN) = '1'B;

  17166   1 0000A2  8900 0000 001B  xsym                 LBT,'0080'X       KY_USRPRM+27
  17166   1 0000A5       0080

      310    17167    1          KY_USRPRM.SETPRMPSTPRC(%KV_PRMID_FIRSTLINE) = '1'B;

  17167   1 0000A6  8900 0000 0023  xsym                 LBT,'4000'X       KY_USRPRM+35
  17167   1 0000A9       4000

      311    17168    1          KY_USRPRM.SETPRMPSTPRC(%KV_PRMID_LPI) = '1'B;

  17168   1 0000AA  8900 0000 0025  xsym                 LBT,'0020'X       KY_USRPRM+37
  17168   1 0000AD       0020

      312    17169        /**/
      313    17170        /* MAKE INITIALIZE CALL TO VDH */
      314    17171        /**/
      315    17172    1          KV$VDH_INT.CHN$=CHN$;

  17172   1 0000AE  9C84                                 LDB,B1   ,B4
          1 0000AF  9FC7 0017                            STB,B1   KV$VDH_INT+1,AUTO

      316    17173    1          KV$VDH_INT.USRCTX$=CTX$;

  17173   1 0000B1  DFC7 0019                            STB,B5   KV$VDH_INT+3,AUTO

      317    17174    1          IF KH$CHN.BLOCK~=0 THEN

  17174   1 0000B3  EC84                                 LDB,B6   ,B4
          1 0000B4  E846 0010                            LDR,R6   16,B6
          1 0000B6  6901 0003                            BEZ,R6   s:17176,PREL

      318    17175    1             KV$VDH_INT.RCVFLWCTRMAXCRD = KH$CHN.BLOCK;
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:59   

  17175   1 0000B8  EF47 001F                            STR,R6   KV$VDH_INT+9,AUTO

      319    17176    1          KV$VDH_INT.USRPRM$ = ADDR(KY_USRPRM);

  17176   1 0000BA  EB80 0000 0000  xsym                 LAB,B6   KY_USRPRM
          1 0000BD  EFC7 001D                            STB,B6   KV$VDH_INT+7,AUTO

      320    17177    2          CALL KVV$INT(KV$VDH_INT) WHENALTRETURN DO;

  17177   1 0000BF  EBC7 0016                            LAB,B6   KV$VDH_INT,AUTO
          1 0000C1  EFC7 003C                            STB,B6   KV$VDH_EVT+2,AUTO
          1 0000C3  BBC7 003C                            LAB,B3   KV$VDH_EVT+2,AUTO
          1 0000C5  CBF0 0100                            LAB,B4   256,IMO
          1 0000C7  E380 0000 0000  xent                 LNJ,B6   KVV$INT
          1 0000CA       0003                            DC       s:17178,PREL
          1 0000CB  0F81 0003                            B        s:17180,PREL

      321    17178    2                GOTO VDH_INT_ABR;

  17178   1 0000CD  0F81 00E2                            B        s:17258,PREL

      322    17179    2             END;                          /* whenaltreturn do*/
      323    17180    1          VDI$=KV$VDH_INT.VDI$;

  17180   1 0000CF  ECC7 001B                            LDB,B6   KV$VDH_INT+5,AUTO
          1 0000D1  EFC7 000E                            STB,B6   VDI$,AUTO

      324    17181    1          KY$CTX.VDI$=VDI$;

  17181   1 0000D3  DCC7 000C                            LDB,B5   CTX$,AUTO
          1 0000D5  EFC5 0008                            STB,B6   8,B5

      325    17182        /**/
      326    17183        /* INITIALIZE EVENT ENABLE. */
      327    17184        /* FOR NOW THIS IS THE SAME FOR ALL URP DEVICES. */
      328    17185        /**/
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:60   
      329    17186    1          KV$VDI.USREVTENB(%KV_USR_EVT_ID_CLS)='1'B;

  17186   1 0000D7  8946 001E                            LBT,'0020'X       30,B6
  17186   1 0000D9       0020

      330    17187    1          KV$VDI.USREVTENB(%KV_USR_EVT_ID_LGNACP)='1'B;

  17187   1 0000DA  8946 001F                            LBT,'8000'X       31,B6
  17187   1 0000DC       8000

      331    17188    1          KV$VDI.USREVTENB(%KV_USR_EVT_ID_LGNRJC)='1'B;

  17188   1 0000DD  8946 001F                            LBT,'4000'X       31,B6
  17188   1 0000DF       4000

      332    17189    1          KV$VDI.USREVTENB(%KV_USR_EVT_ID_OPN)='1'B;

  17189   1 0000E0  8946 001F                            LBT,'2000'X       31,B6
  17189   1 0000E2       2000

      333    17190    1          KV$VDI.USREVTENB(%KV_USR_EVT_ID_RLSSTR)='1'B;

  17190   1 0000E3  8946 001F                            LBT,'1000'X       31,B6
  17190   1 0000E5       1000

      334    17191    1          KV$VDI.USREVTENB(%KV_USR_EVT_ID_SCH)='1'B;

  17191   1 0000E6  8946 001F                            LBT,'0800'X       31,B6
  17191   1 0000E8       0800

      335    17192    1          KV$VDI.USREVTENB(%KV_USR_EVT_ID_RLSVDI)='0'B;

  17192   1 0000E9  8846 001F                            LBF,'0100'X       31,B6
  17192   1 0000EB       0100

      336    17193    1          IF KY$CTX.DVCTYP = %KY#TYP_CR THEN

PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:61   
  17193   1 0000EC  E2C5 000B                            LLH,R6   11,B5
          1 0000EE  6D03                                 CMV,R6   3
          1 0000EF  0981 0007                            BNE      s:17199,PREL

      337    17194    2             DO;

      338    17195    2                KV$VDI.INPUNT = %KV_INPUNT_RCR;

  17195   1 0000F1  5C40                                 LDV,R5   64
          1 0000F2  DAC6 001D                            SRM,R5,'0060'X    29,B6
          1 0000F4       0060

      339    17196    2             END;                          /* IF DVCTYP = CR */

  17196   1 0000F5  0F81 001F                            B        s:17212,PREL

      340    17197    1          ELSE
      341    17198    2             DO;

      342    17199    2                IF KH$CHN.BLOCK~=0 THEN

  17199   1 0000F7  CCC7 0004                            LDB,B4   @CHN$,AUTO
          1 0000F9  BC84                                 LDB,B3   ,B4
          1 0000FA  D843 0010                            LDR,R5   16,B3
          1 0000FC  5901 0005                            BEZ,R5   s:17202,PREL

      343    17200    2                   KY$CTX.Q.UPRLIMIT = KH$CHN.BLOCK;

  17200   1 0000FE  DF45 0018                            STR,R5   24,B5
          1 000100  0F81 0006                            B        s:17203,PREL

      344    17201    2                ELSE
      345    17202    2                   KY$CTX.Q.UPRLIMIT = KY_BLOCK;

  17202   1 000102  C800 0000 0000  xsym                 LDR,R4   KY_BLOCK
          1 000105  CF45 0018                            STR,R4   24,B5

PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:62   
      346    17203    2                IF KH$CHN.UNBLOCK~=0 THEN

  17203   1 000107  BC84                                 LDB,B3   ,B4
          1 000108  D843 0011                            LDR,R5   17,B3
          1 00010A  5901 0005                            BEZ,R5   s:17206,PREL

      347    17204    2                   KY$CTX.Q.LOWRLIMIT = KH$CHN.UNBLOCK;

  17204   1 00010C  DF45 0019                            STR,R5   25,B5
          1 00010E  0F81 0006                            B        s:17212,PREL

      348    17205    2                ELSE
      349    17206    2                   KY$CTX.Q.LOWRLIMIT = KY_UNBLOCK;

  17206   1 000110  C800 0000 0000  xsym                 LDR,R4   KY_UNBLOCK
          1 000113  CF45 0019                            STR,R4   25,B5

      350    17207    2             END;                          /* ELSE

      351    17208                                                         */
      352    17209        /**/
      353    17210        /* CALL VDH TO CONNECT */
      354    17211        /**/
      355    17212    1          KV$VDH_CNC=KV_VDH_CNC;

  17212   1 000115  AB80 0000 0000  xsym                 LAB,B2   KV_VDH_CNC
          1 000118  2C00                                 LDV,R2   0
          1 000119  6C32                                 LDV,R6   50
          1 00011A  BB87                                 LAB,B3   ,AUTO
          1 00011B  3C42                                 LDV,R3   66
          1 00011C  0008                                 MMM

      356    17213    1          KV$VDH_CNC.LCLENDPNTID = KH$CHN.TERMID;

  17213   1 00011D  ECC7 0004                            LDB,B6   @CHN$,AUTO
          1 00011F  DC86                                 LDB,B5   ,B6
          1 000120  AB85                                 LAB,B2   ,B5
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:63   
          1 000121  2C24                                 LDV,R2   36
          1 000122  6C10                                 LDV,R6   16
          1 000123  BB87                                 LAB,B3   ,AUTO
          1 000124  3C58                                 LDV,R3   88
          1 000125  0008                                 MMM

      357    17214    1          KV$VDH_CNC.LCLENDPNTID.TTYP = %KLTY_URP#;

  17214   1 000126  6C06                                 LDV,R6   6
          1 000127  E7C7 002C                            STH,R6   KV$VDH_CNC+11,AUTO

      358    17215    1          CALL KVV$VDI(KV$VDH_CNC) ALTRET(VDH_CNC_ABR);

  17215   1 000129  CBC7 0021                            LAB,B4   KV$VDH_CNC,AUTO
          1 00012B  CFC7 003C                            STB,B4   KV$VDH_EVT+2,AUTO
          1 00012D  BBC7 003C                            LAB,B3   KV$VDH_EVT+2,AUTO
          1 00012F  CBF0 0100                            LAB,B4   256,IMO
          1 000131  E380 0000 0000  xent                 LNJ,B6   KVV$VDI
          1 000134       005C                            DC       s:17247,PREL

      359    17216    1          IF KY$CTX.DVCTYP=%KY#TYP_LP THEN

  17216   1 000135  ECC7 000C                            LDB,B6   CTX$,AUTO
          1 000137  E2C6 000B                            LLH,R6   11,B6
          1 000139  6D01                                 CMV,R6   1
          1 00013A  0981 001A                            BNE      s:17227,PREL

      360    17217    2             DO;

      361    17218    2                KV$VDI.USEOTPBFR='1'B;

  17218   1 00013C  DCC7 000E                            LDB,B5   VDI$,AUTO
          1 00013E  8945 001D                            LBT,'0200'X       29,B5
          1 000140       0200

      362    17219    2                KV$VDI.USEOTPBFRBNR='1'B;

PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:64   
  17219   1 000141  8945 001D                            LBT,'0100'X       29,B5
  17219   1 000143       0100

      363    17220    2                KV$VDI.USEOTPBFRTRN='1'B;

  17220   1 000144  8945 001D                            LBT,'0080'X       29,B5
  17220   1 000146       0080

      364    17221    2                MRD$=KV$PTR.MRD$;

  17221   1 000147  CC80 0000 0000  xsym                 LDB,B4   KV$PTR$
          1 00014A  BCC4 0008                            LDB,B3   8,B4
          1 00014C  BFC7 0010                            STB,B3   MRD$,AUTO

      365    17222    2                KV$MRD.CTNFRM='1'B;

  17222   1 00014E  8943 0018                            LBT,'0800'X       24,B3
  17222   1 000150       0800

      366    17223    2                KV$MRD.MINSP_FORPST = 0;

  17223   1 000151  87C3 000C                            CLH      12,B3

      367    17224    2             END;

  17224   1 000153  0F81 000C                            B        s:17231,PREL

      368    17225    1          ELSE
      369    17226    2             DO;

      370    17227    2                KV$VDI.USEOTPBFR='0'B;

  17227   1 000155  DCC7 000E                            LDB,B5   VDI$,AUTO
          1 000157  8845 001D                            LBF,'0200'X       29,B5
          1 000159       0200

      371    17228    2                KV$VDI.USEOTPBFRBNR='0'B;
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:65   

  17228   1 00015A  8845 001D                            LBF,'0100'X       29,B5
  17228   1 00015C       0100

      372    17229    2                KV$VDI.USEOTPBFRTRN='0'B;

  17229   1 00015D  8845 001D                            LBF,'0080'X       29,B5
  17229   1 00015F       0080

      373    17230    2             END;

      374    17231    1          KH$CHN.CTX$ = CTX$;

  17231   1 000160  CCC7 0004                            LDB,B4   @CHN$,AUTO
          1 000162  BC84                                 LDB,B3   ,B4
          1 000163  EFC3 000C                            STB,B6   12,B3

      375    17232    1          KH$CHN.TERMID.TTYP = %KLTY_URP#;

  17232   1 000165  BC84                                 LDB,B3   ,B4
          1 000166  6C06                                 LDV,R6   6
          1 000167  E7C3 0012                            STH,R6   18,B3

      376    17233    1          KV$PTR$ = SAVEPTR$;

  17233   1 000169  BCC7 0014                            LDB,B3   SAVEPTR$,AUTO
          1 00016B  BF80 0000 0000  xsym                 STB,B3   KV$PTR$

      377    17234    1          CALL KYN$DISABLE;

  17234   1 00016E  CBF0 0000                            LAB,B4   0,IMO
          1 000170  E380 0000 0000  xent                 LNJ,B6   KYN$DISABLE
          1 000173       0001                            DC       s:17235,PREL

      378    17235    1          KY$CTX.NEXT$ = KY_FIRSTCTX$;

  17235   1 000174  EC80 0000 0000  xsym                 LDB,B6   KY_FIRSTCTX$
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:66   
          1 000177  DCC7 000C                            LDB,B5   CTX$,AUTO
          1 000179  EF85                                 STB,B6   ,B5

      379    17236    1          IF KY_FIRSTCTX$ ~= ADDR(NIL) THEN

  17236   1 00017A  8D80 0000 0000  xsym                 CMN      KY_FIRSTCTX$
          1 00017D  0901 0006                            BE       s:17240,PREL

      380    17237    2             DO;

      381    17238    2                KY_FIRSTCTX$->KY$NEXTCTX.PRIOR$ = CTX$;

  17238   1 00017F  CC80 0000 0000  xsym                 LDB,B4   KY_FIRSTCTX$
          1 000182  DFC4 0002                            STB,B5   2,B4

      382    17239    2             END;                          /* IF KY_FIRSTCTX$ ~= ADDR(NIL) */

      383    17240    1          KY_FIRSTCTX$ = CTX$;

  17240   1 000184  DF80 0000 0000  xsym                 STB,B5   KY_FIRSTCTX$

      384    17241    1          CALL KYN$ENABLE;

  17241   1 000187  CBF0 0000                            LAB,B4   0,IMO
          1 000189  E380 0000 0000  xent                 LNJ,B6   KYN$ENABLE
          1 00018C       0001                            DC       s:17242,PREL

      385    17242    1          RETURN;

  17242   1 00018D  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      386    17243        /**/
      387    17244        /* BACK OUT FOR ONE REASON OR ANOTHER */
      388    17245        /**/
      389    17246    1   VDH_CNC_ABR:
      390    17247    1          ABRTCODE=ABRTCODE+1;

PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:67   
  17247   1 000190  8AC7 0008            VDH_CNC_ABR     INC      ABRTCODE,AUTO

      391    17248    1          KV$VDH_EVT=KV_VDH_EVT;

  17248   1 000192  8C80 0000 0000  xsym                 LDI      KV_VDH_EVT
          1 000195  8D47 003A                            SDI      KV$VDH_EVT,AUTO

      392    17249    1          KY$CTX.DSCRSN = %KV_DSCRSN_RSRSHR;

  17249   1 000197  5C07                                 LDV,R5   7
          1 000198  ECC7 000C                            LDB,B6   CTX$,AUTO
          1 00019A  DAC6 0021                            SRM,R5,'00FF'X    33,B6
          1 00019C       00FF

      393    17250    1          KV$VDH_EVT.ID=%KV_VDH_EVT_ID_RLSVDI;

  17250   1 00019D  4C03                                 LDV,R4   3
          1 00019E  CAC7 003A                            SRM,R4,'00FF'X    KV$VDH_EVT,AUTO
          1 0001A0       00FF

      394    17251    1          CALL KVV$VDI(KV$VDH_EVT);

  17251   1 0001A1  DBC7 003A                            LAB,B5   KV$VDH_EVT,AUTO
          1 0001A3  DFC7 003C                            STB,B5   KV$VDH_EVT+2,AUTO
          1 0001A5  BBC7 003C                            LAB,B3   KV$VDH_EVT+2,AUTO
          1 0001A7  CBF0 0100                            LAB,B4   256,IMO
          1 0001A9  E380 0000 0000  xent                 LNJ,B6   KVV$VDI
          1 0001AC       0001                            DC       s:17256,PREL

      395    17252        /*
      396    17253                nil out vdi$ so that we can use kha routines to
      397    17254                manipulate line.
      398    17255        */
      399    17256    1          RETURN;                          /* ctx mem released on end action. */

  17256   1 0001AD  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:68   
      400    17257    1   VDH_INT_ABR:
      401    17258    1          ABRTCODE=ABRTCODE+1;

  17258   1 0001B0  8AC7 0008            VDH_INT_ABR     INC      ABRTCODE,AUTO

      402    17259    1          T$=CTX$;

  17259   1 0001B2  ECC7 000C                            LDB,B6   CTX$,AUTO
          1 0001B4  EFC7 000A                            STB,B6   T$,AUTO

      403    17260    1          CALL KVB$RLS2NSYS(%KY#CTXBLKSIZ,T$);

  17260   1 0001B6  DBF0 0040                            LAB,B5   64,IMO
          1 0001B8  CBC7 000A                            LAB,B4   T$,AUTO
          1 0001BA  CFC7 003E                            STB,B4   KV$VDH_EVT+4,AUTO
          1 0001BC  DFC7 003C                            STB,B5   KV$VDH_EVT+2,AUTO
          1 0001BE  BBC7 003C                            LAB,B3   KV$VDH_EVT+2,AUTO
          1 0001C0  CBF0 0200                            LAB,B4   512,IMO
          1 0001C2  E380 0000 0000  xent                 LNJ,B6   KVB$RLS2NSYS
          1 0001C5       0001                            DC       s:17261,PREL

      404    17261    1         KY_STT_URP.USRSTT.CTXBYTUTL = KY_STT_URP.USRSTT.CTXBYTUTL - SIZEW(KY$CTX) * 2
             17261                   ;

  17261   1 0001C6  8C80 0000 0020  xsym                 LDI      KY_STT_URP+32
          1 0001C9  8470 FFFF FFB4                       AID      -76,IMO
          1 0001CC  8D00 0000 0020  xsym                 SDI      KY_STT_URP+32

      405    17262    1   NO_CTX_MEM:
      406    17263    1          ABRTCODE=ABRTCODE+1;

  17263   1 0001CF  8AC7 0008            NO_CTX_MEM      INC      ABRTCODE,AUTO

      407    17264        /* ERROR LOG ENABLE ABORT */
      408    17265    1          RETURN;

  17265   1 0001D1  C380 0000 0000  xent                 LNJ,B4   X6A_ARET
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:69   
      409    17266    1   END KYA$ENABLE;

PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:70   
--  Include file information  --

   KY_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
   KHC_MAC_C.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KY_SUBS_C.:E05TOU  is referenced.
   KY_URP_M.:E05TOU  is referenced.
   KV_PRMID_E.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   KV$PRM.:E05TOU  is referenced.
   KV_GLB_M.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   KV$VDH.:E05TOU  is referenced.
   KV$GLBCTX.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   GH_HARDWARE_M.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KYA$ENABLE.
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:71   

 **** Variables and constants ****

  ****  Section 000  Data  KYA$ENABLE

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(608)   r     1 KY_CTX

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @CHN$                      8-0-0/w SBIN(16)    r     1 ABRTCODE
    *0-0-0/w PTR         r     1 CHN$                       C-0-0/w PTR         r     1 CTX$
    21-0-0/w STRC(400)   r     1 KV$VDH_CNC                3A-0-0/w STRC(32)    r     1 KV$VDH_EVT
    16-0-0/w STRC(176)   r     1 KV$VDH_INT                10-0-0/w PTR         r     1 MRD$
    12-0-0/w PTR         r     1 MVD$                      14-0-0/w PTR         r     1 SAVEPTR$
     9-0-0/w UBIN(16)    r     1 SIZE                       A-0-0/w PTR         r     1 T$
     E-0-0/w PTR         r     1 VDI$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KH_CTLTBL$                 0-0-0/w PTR         r     1 KV$PTR$
     0-0-0/w STRC(400)   r     1 KV_VDH_CNC                 0-0-0/w STRC(32)    r     1 KV_VDH_EVT
     0-0-0/w STRC(176)   r     1 KV_VDH_INT                 0-0-0/w UBIN(16)    r     1 KY_BLOCK
     0-0-0/w PTR         r     1 KY_FIRSTCTX$               0-0-0/w STRC(672)   r     1 KY_STT_URP
     0-0-0/w UBIN(16)    r     1 KY_UNBLOCK                 0-0-0/w STRC(912)   r     1 KY_USRPRM

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:72   

     0-0-0/w STRC(512)   r     1 KH$CHN                     0-0-0/w STRC(512)   r     1 KV$MRD
     0-0-0/w STRC(480)   r     1 KV$PTR                     0-0-0/w STRC(512)   r     1 KV$VDI
     0-0-0/w STRC(608)   r     1 KY$CTX                     0-0-0/w STRC(608)   r     1 KY$NEXTCTX


   Procedure KYA$ENABLE requires 468 words for executable code.
   Procedure KYA$ENABLE requires 64 words of local(AUTO) storage.

    No errors detected in file KYA$ADMIN.:E05TSI    .
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:73   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:74   
          MINI XREF LISTING

ABRTCODE
     16589**DCL     17133<<ASSIGN  17247<<ASSIGN  17247>>ASSIGN  17258<<ASSIGN  17258>>ASSIGN  17263<<ASSIGN
     17263>>ASSIGN
CHN$
     16592**DCL        17--PROC    16046--IMP-PTR 17141>>ASSIGN  17142>>ASSIGN  17151>>IF      17157>>IF
     17160>>IF      17172>>ASSIGN  17174>>IF      17175>>ASSIGN  17199>>IF      17200>>ASSIGN  17203>>IF
     17204>>ASSIGN  17213>>ASSIGN  17231>>ASSIGN  17232>>ASSIGN
CTX$
     16593**DCL     15688--IMP-PTR 17137<<ASSIGN  17138>>ASSIGN  17139>>ASSIGN  17140>>ASSIGN  17141>>ASSIGN
     17142>>ASSIGN  17143>>ASSIGN  17144>>ASSIGN  17145>>ASSIGN  17146>>ASSIGN  17147>>ASSIGN  17148>>ASSIGN
     17149>>ASSIGN  17153>>ASSIGN  17154>>ASSIGN  17158>>ASSIGN  17161>>ASSIGN  17162>>ASSIGN  17162>>ASSIGN
     17173>>ASSIGN  17181>>ASSIGN  17193>>IF      17200>>ASSIGN  17202>>ASSIGN  17204>>ASSIGN  17206>>ASSIGN
     17216>>IF      17231>>ASSIGN  17235>>ASSIGN  17238>>ASSIGN  17240>>ASSIGN  17249>>ASSIGN  17259>>ASSIGN
KH$CHN.ATTR
     16079**DCL     17151>>IF      17157>>IF      17160>>IF
KH$CHN.BLOCK
     16122**DCL     17174>>IF      17175>>ASSIGN  17199>>IF      17200>>ASSIGN
KH$CHN.CHNBIT0_9
     16053**DCL     17142>>ASSIGN
KH$CHN.CTX$
     16116**DCL     17231<<ASSIGN
KH$CHN.DVCID
     16072**DCL     17141>>ASSIGN
KH$CHN.TERMID
     16140**DCL     17213>>ASSIGN
KH$CHN.TERMID.TERM
     16142**DCL     16151--REDEF
KH$CHN.TERMID.TTYP
     16142**DCL     17232<<ASSIGN
KH$CHN.UNBLOCK
     16122**DCL     17203>>IF      17204>>ASSIGN
KH_CTLTBL$
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:75   
     16572**DCL     16377--IMP-PTR
KV$MRD.CTNFRM
     16304**DCL     17222<<ASSIGN
KV$MRD.MINSP_FORPST
     16293**DCL     17223<<ASSIGN
KV$PTR.INPCNDPND
     16253**DCL     16262--REDEF   16266--REDEF
KV$PTR.LINLST$
     16249**DCL     16250--REDEF
KV$PTR.MRD$
     16248**DCL     17221>>ASSIGN
KV$PTR$
     16241**DCL     16247--IMP-PTR 17164>>ASSIGN  17221>>ASSIGN  17233<<ASSIGN
KV$VDH_CNC
     16662**DCL     17212<<ASSIGN  17215<>CALL
KV$VDH_CNC.LCLENDPNTID
     16712**DCL     17213<<ASSIGN
KV$VDH_CNC.LCLENDPNTID.TERM
     16714**DCL     16723--REDEF
KV$VDH_CNC.LCLENDPNTID.TTYP
     16714**DCL     17214<<ASSIGN
KV$VDH_EVT
     16754**DCL     17248<<ASSIGN  17251<>CALL
KV$VDH_EVT.ID
     16760**DCL     17250<<ASSIGN
KV$VDH_INT
     16625**DCL     17150<<ASSIGN  17177<>CALL
KV$VDH_INT.CHN$
     16631**DCL     17172<<ASSIGN
KV$VDH_INT.RCVFLWCTRMAXCRD
     16632**DCL     17175<<ASSIGN
KV$VDH_INT.USRCTX$
     16631**DCL     17173<<ASSIGN
KV$VDH_INT.USRPRM$
     16632**DCL     17176<<ASSIGN
KV$VDH_INT.VDI$
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:76   
     16632**DCL     17180>>ASSIGN
KV$VDI.INPUNT
     16217**DCL     17195<<ASSIGN
KV$VDI.USEOTPBFR
     16216**DCL     17218<<ASSIGN  17227<<ASSIGN
KV$VDI.USEOTPBFRBNR
     16216**DCL     17219<<ASSIGN  17228<<ASSIGN
KV$VDI.USEOTPBFRTRN
     16217**DCL     17220<<ASSIGN  17229<<ASSIGN
KV$VDI.USREVTENB
     16219**DCL     17186<<ASSIGN  17187<<ASSIGN  17188<<ASSIGN  17189<<ASSIGN  17190<<ASSIGN  17191<<ASSIGN
     17192<<ASSIGN
KVB$GET2NSYS
     17123**DCL-ENT 17135--CALL
KVB$RLS2NSYS
     17124**DCL-ENT 17260--CALL
KVV$INT
     17125**DCL-ENT 17177--CALL
KVV$VDI
     17126**DCL-ENT 17215--CALL    17251--CALL
KV_STT.REQSTATS.DSPMSK
     15346**DCL     15352--REDEF
KV_STT.REQSTATS.SLCMSK
     15387**DCL     15394--REDEF
KV_VDH_CNC
     17009**DCL     17212>>ASSIGN
KV_VDH_CNC.LCLENDPNTID.TERM
     17061**DCL     17070--REDEF
KV_VDH_EVT
     17101**DCL     17248>>ASSIGN
KV_VDH_INT
     16972**DCL     17150>>ASSIGN
KY$CTX
     15688**DCL     17136--ASSIGN  17138<<ASSIGN  17261--ASSIGN
KY$CTX.CHAN
     15774**DCL     17142<<ASSIGN
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:77   
KY$CTX.DEFRD.STATUSW
     15830**DCL     15832--REDEF
KY$CTX.DSCRSN
     15843**DCL     17249<<ASSIGN
KY$CTX.DVCTYP
     15776**DCL     17154<<ASSIGN  17158<<ASSIGN  17161<<ASSIGN  17162>>ASSIGN  17162>>ASSIGN  17193>>IF
     17216>>IF
KY$CTX.DVC_ID
     15772**DCL     17141<<ASSIGN
KY$CTX.DVC_STATE
     15691**DCL     17140<<ASSIGN
KY$CTX.MODE
     15779**DCL     15787--REDEF
KY$CTX.NEXT$
     15689**DCL     17235<<ASSIGN
KY$CTX.Q.LOWRLIMIT
     15807**DCL     17204<<ASSIGN  17206<<ASSIGN
KY$CTX.Q.UPRLIMIT
     15806**DCL     17200<<ASSIGN  17202<<ASSIGN
KY$CTX.STATUSW
     15706**DCL     15708--REDEF   15716--REDEF   15730--REDEF   15744--REDEF   15758--REDEF
KY$CTX.TIMEOUT
     15777**DCL     17139<<ASSIGN
KY$CTX.VDI$
     15773**DCL     17181<<ASSIGN
KY$CTX.VDIENB
     15844**DCL     15850--REDEF
KY$CTX.VDIENB.EVTENB
     15846**DCL     17145<<ASSIGN  17146<<ASSIGN  17147<<ASSIGN  17148<<ASSIGN  17149<<ASSIGN
KY$CTX.VDIENB.STRENB
     15845**DCL     17143<<ASSIGN  17144<<ASSIGN
KY$CTX.VFU_LOADED
     15698**DCL     17153<<ASSIGN
KY$NEXTCTX.DEFRD.STATUSW
     16007**DCL     16009--REDEF
KY$NEXTCTX.MODE
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:78   
     15956**DCL     15964--REDEF
KY$NEXTCTX.PRIOR$
     15867**DCL     17238<<ASSIGN
KY$NEXTCTX.STATUSW
     15883**DCL     15885--REDEF   15893--REDEF   15907--REDEF   15921--REDEF   15935--REDEF
KY$NEXTCTX.VDIENB
     16021**DCL     16027--REDEF
KYN$DISABLE
     17122**DCL-ENT 17234--CALL
KYN$ENABLE
     17121**DCL-ENT 17241--CALL
KY_BLOCK
     15467**DCL     17202>>ASSIGN
KY_CTX
     16776**DCL     17138>>ASSIGN
KY_CTX.DEFRD.STATUSW
     16918**DCL     16920--REDEF
KY_CTX.MODE
     16867**DCL     16875--REDEF
KY_CTX.STATUSW
     16794**DCL     16796--REDEF   16804--REDEF   16818--REDEF   16832--REDEF   16846--REDEF
KY_CTX.VDIENB
     16932**DCL     16938--REDEF
KY_FIRSTCTX$
     14734**DCL     17235>>ASSIGN  17236>>IF      17238>>ASSIGN  17240<<ASSIGN
KY_STT_URP.NUMDVC
     15071**DCL     17162<<ASSIGN  17162>>ASSIGN
KY_STT_URP.REQSTATS.DSPMSK
     14995**DCL     15001--REDEF
KY_STT_URP.REQSTATS.SLCMSK
     15036**DCL     15043--REDEF
KY_STT_URP.USRSTT.CTXBYTUTL
     15068**DCL     17136<<ASSIGN  17136>>ASSIGN  17261<<ASSIGN  17261>>ASSIGN
KY_UNBLOCK
     15467**DCL     17206>>ASSIGN
KY_USRPRM
PL6.E3A0      #003=KYA$ENABLE File=KYA$ADMIN.:E05TSI                             WED 07/30/97 02:40 Page:79   
     14704**DCL     17176--ASSIGN
KY_USRPRM.SETPRMPSTPRC
     14722**DCL     17165<<ASSIGN  17166<<ASSIGN  17167<<ASSIGN  17168<<ASSIGN
MRD$
     16595**DCL     16290--IMP-PTR 17221<<ASSIGN  17222>>ASSIGN  17223>>ASSIGN
MVD$
     16596**DCL     16338--IMP-PTR
NO_CTX_MEM
     17263**LABEL   17135--CALLALT
SAVEPTR$
     16597**DCL     17164<<ASSIGN  17233>>ASSIGN
SIZE
     16590**DCL     17134<<ASSIGN  17135<>CALL
T$
     16591**DCL     17135<>CALL    17137>>ASSIGN  17259<<ASSIGN  17260<>CALL
VDH_CNC_ABR
     17247**LABEL   17215--CALLALT
VDH_INT_ABR
     17258**LABEL   17178--GOTO
VDI$
     16594**DCL     16176--IMP-PTR 17180<<ASSIGN  17181>>ASSIGN  17186>>ASSIGN  17187>>ASSIGN  17188>>ASSIGN
     17189>>ASSIGN  17190>>ASSIGN  17191>>ASSIGN  17192>>ASSIGN  17195>>ASSIGN  17218>>ASSIGN  17219>>ASSIGN
     17220>>ASSIGN  17227>>ASSIGN  17228>>ASSIGN  17229>>ASSIGN
