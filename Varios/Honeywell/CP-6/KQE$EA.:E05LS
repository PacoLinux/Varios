VERSION E05

PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:1    
        1        1        /*M*  KQE$EA - Disk I/O end-action routines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /**/
        8        8        /*X* DMC,PLM=4,IND=2,SDI=2,CTI=2,ENU=0,AND,DCI=4,CSU=2,ECU=4,DTI=2,STI=0 */
        9        9        /**/
       10       10        /*P* NAME:         KQE$EA
       11       11
       12       12             PURPOSE:      Disk I/O end-action routines for comgroups
       13       13
       14       14        */
       15       15
       16       16
       17       17        KQE$RDEA: PROC(N$REQ);
       18       18
       19       19
       20       20        /**/
       21       21        /* INCLUDES */
       22       22        /**/
       23       23        %INCLUDE EL$TABLES;
       24      346        %INCLUDE HF_LOCK_C;
       25      360        %INCLUDE KC$CP6V_C;
       26      480        %INCLUDE KC_CP6;
       27     1040        %INCLUDE KQ_MAC_C;
       28     3590        %INCLUDE KQ_DATA_R;
       29     4422        %INCLUDE KQ_SUBS_C;
       30     4722        %INCLUDE N$REQ;
       31     4796        %INCLUDE N_FC_C;
       32     4833
       33     4834
       34     4835        /**/
       35     4836        /* PARAMETERS */
       36     4837        /**/
       37     4838        %N$REQ (STCLASS=);
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:2    
       38     4896
       39     4897
       40     4898        /**/
       41     4899        /* BASED STRUCTURES */
       42     4900        /**/
       43     4901        %KQ_CG (FPTN=KQ$CG,STCLASS="BASED(CG$)");
       44     5640        %KQ_DFRBLK (FPTN=KQ$DFRBLK,STCLASS="BASED(DFR$)");
       45     5690        %KQ_DGRAN  (FPTN=KQ$DGRAN,STCLASS="BASED(DGRAN$)");
       46     5837    1   DCL WRD(0:1023) UBIN BASED ALIGNED;
       47     5838
       48     5839
       49     5840        /**/
       50     5841        /* AUTO */
       51     5842        /**/
       52     5843    1   DCL CG$ PTR;
       53     5844    1   DCL DFR$ PTR;
       54     5845    1   DCL DGRAN$ PTR;
       55     5846    1   DCL DA UBIN;
       56     5847    1   DCL 1 STAMP,
       57     5848    1         2 HASH UBIN(27) UNAL,
       58     5849    1         2 GMOD UBIN(9) UNAL;
       59     5850    1   DCL 1 KEY,
       60     5851    1         2 DA UBIN,
       61     5852    1         2 GARB UBIN;
       62     5853    1   DCL KEYC REDEF KEY CHAR(8);
       63     5854    1   DCL T$ PTR;
       64     5855    1   DCL P$ PTR;
       65     5856    1   DCL HD$ PTR;
       66     5857    1   DCL TL$ PTR;
       67     5858    1   DCL I UBIN;
       68     5859    1   DCL ERRCODE UBIN;
       69     5860    1   DCL CODE UBIN;
       70     5861    1   DCL ALLOCFLG UBIN;
       71     5862    1   DCL DELAYFLG UBIN;
       72     5863    1   DCL ENTFLG UBIN;
       73     5864    1   DCL LDFR$ PTR;
       74     5865    1   DCL LDGRAN$ PTR;
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:3    
       75     5866
       76     5867
       77     5868        /**/
       78     5869        /* EXTERNAL DATA */
       79     5870        /**/
       80     5871        %EL$CGERR (NAME=KQ_ERRLOG_BFR,STCLASS=SYMREF,N=33);
       81     5875
       82     5876
       83     5877        /**/
       84     5878        /* EXTERNAL ROUTINES */
       85     5879        /**/
       86     5880    1   DCL FAF$FRTOSRNJ ENTRY(3) ALTRET;
       87     5881    1   DCL FAF$SRTODR ENTRY(2) ALTRET;
       88     5882    1   DCL KCC$BASE ENTRY;
       89     5883    1   DCL KQB$DELETENL ENTRY(3) ALTRET;
       90     5884    1   DCL KQB$INSERTNL ENTRY(3) ALTRET;
       91     5885    1   DCL KQD$ERRLOG ENTRY(1) ALTRET;
       92     5886    1   DCL KQD$FETCHDONE ENTRY(3) ALTRET;
       93     5887    1   DCL KQD$GETINIT ENTRY(1) ALTRET;
       94     5888    1   DCL KQD$GETPROCESS ENTRY(3) ALTRET;
       95     5889    1   DCL KQD$RELDFR ENTRY(2) ALTRET;
       96     5890    1   DCL KQD$RELP ENTRY(2) ALTRET;
       97     5891    1   DCL KQS$CLOCK ENTRY(1) ALTRET;
       98     5892    1   DCL KQX$LDASR ENTRY(1);
       99     5893    1   DCL KQZ$LOG ENTRY(8) ALTRET;
      100     5894    1   DCL SSS$CCAC ENTRY;
      101     5895    1   DCL SSS$SYSTIME ENTRY(1);
      102     5896    1   DCL SC_CGCACHE ENTRY CONV(2,0);
      103     5897    1   DCL SC_CGKQE ENTRY CONV(2,0);
      104     5898
      105     5899
      106     5900        /**/
      107     5901        /* EQUs */
      108     5902        /**/
      109     5903        %EQU GFLG_INIT=1;   /* See KQD$DBLK */
      110     5904
      111     5905        %EJECT;
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:4    
      112     5906
      113     5907
      114     5908        /*F* NAME:         KQE$RDEA
      115     5909
      116     5910             PURPOSE:      Disk read end-action handler
      117     5911
      118     5912        */
      119     5913
      120     5914
      121     5915        /*D* NAME:         KQE$RDEA
      122     5916
      123     5917             CALL:         Called via NIO$QUE at end-action
      124     5918
      125     5919             INPUT:        N$REQ - Queue packet
      126     5920                           N$REQ.EAINFOP$ - Ptr to defer block
      127     5921                           N$REQ.EAINFOXP$ - Ptr to comgroup context
      128     5922
      129     5923             DESCRIPTION:  Validates granule stamp, adds to disk cache
      130     5924                           tree and available chains.  Removes defer block
      131     5925                           from the active I/O list and processes it.
      132     5926                           Loops thru active I/O list and removes and
      133     5927                           processes any defer blocks for this granule.
      134     5928
      135     5929
      136     5930
      137     5931        %EJECT;
      138     5932
      139     5933
      140     5934        KQE$RDEA: ENTRY(N$REQ);
      141     5935        */
      142     5936
      143     5937    1       ENTFLG=0;  /* Called from IOQ */
      144     5938    1       GOTO COMMON;
      145     5939
      146     5940
      147     5941    1   KQE$RDEAERR: ENTRY(N$REQ);
      148     5942
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:5    
      149     5943    1       ENTFLG=1;  /* Called from KQD */
      150     5944
      151     5945    1   COMMON: ;
      152     5946    1       CALL SSS$CCAC;   /* Clear the CACHE before looking at granule */
      153     5947    1       ALLOCFLG=0;
      154     5948    1       DELAYFLG=0;
      155     5949    1       DFR$=N$REQ.EAINFOP$;
      156     5950    1       CG$=N$REQ.EAINFOXP$;
      157     5951    1       CALL KQX$LDASR(KQ$CG);
      158     5952            %LOCK (G=KQ$CG.GATE.CG);
      159     5955    1       KQ$CG.IOCNT=KQ$CG.IOCNT-1;
      160     5956            %UNLOCK (G=KQ$CG.GATE.CG);
      161     5959    1       DGRAN$=KQ$DFRBLK.DGRAN$;
      162     5960    1       DA=KQ$DFRBLK.DA;
      163     5961    1       IF KQ_LOG.DCIO THEN
      164     5962    1         CALL KQZ$LOG(KQ$CG,%KQLOG_DCRDEA,,,DFR$,DA,DGRAN$);
      165     5963        /**/
      166     5964    1       IF N$REQ.TYC='1'B THEN  /* No error */
      167     5965    2         DO;
      168     5966    2           STAMP.GMOD=DA;
      169     5967    2           STAMP.HASH=KQ$CG.GRAN.STAMP.HASH;
      170     5968    2           KEY.DA=DA;
      171     5969    2           KEY.GARB=0;
      172     5970    2           IF KQ$DGRAN.HDR.STAMP~=STAMP OR KQ$DGRAN.BTN.KEY~=KEYC THEN
      173     5971    3             DO;
      174     5972    3               CALL SC_CGCACHE;  /* Snap */
      175     5973    3               KQ$DFRBLK.ERRCODE=%KQDE_STMP;
      176     5974                    %LOCK (G=KQ_ERRLOG_GATE);
      177     5977    3               KQ_ERRLOG_BFR='0'B;
      178     5978    3               KQ_ERRLOG_BFR.CODE=%KQELOG_KQE_GSTMP;
      179     5979    3               KQ_ERRLOG_BFR.INFO(0)=BITBIN(STAMP);
      180     5980    3               ADDR(KQ_ERRLOG_BFR.INFO(1))->KQ$DGRAN=KQ$DGRAN;
      181     5981    3               KQ_ERRLOG_BFR.SIZ=1+SIZEW(KQ$DGRAN);
      182     5982    3               CALL KQD$ERRLOG(KQ$CG);
      183     5983    3               KQ$DGRAN.HDR.PTYP=%KQ_PTYP_DATA;
      184     5984    3               KQ$DGRAN.HDR.GTYP=%KQ_PTYP_DATA;
      185     5985    3               KQ$DGRAN.HDR.SELF$=DGRAN$;
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:6    
      186     5986    3               GOTO SETERR;
      187     5987    3             END;
      188     5988    2           KQ$DGRAN.HDR.SELF$=DGRAN$;
      189     5989    2           KQ$DGRAN.HDR.WRITE='0'B;
      190     5990    2           KQ$DGRAN.HDR.FORCEOUT='0'B;
      191     5991    2           KQ$DGRAN.HDR.ADDFREE='0'B;
      192     5992    2           CALL SSS$SYSTIME(KQ$DGRAN.TIME);
      193     5993    2           P$=ADDR(KQ$DGRAN.BTN);
      194     5994                %LOCK (G=KQ$CG.DTREE.GATE);
      195     5997    2           CALL KQB$INSERTNL(KQ$CG.DTREE,KEY,P$) ALTRET(INSERR);
      196     5998    2           KQ$DGRAN.HDR.CHAIN='1'B;
      197     5999    2           KQ$DGRAN.HDR.UPD='0'B;
      198     6000    2           IF DA=KQ$CG.FREEDA THEN
      199     6001    3             DO;
      200     6002    3               KQ$CG.FREEDA=KQ$DGRAN.FREEFLINK;
      201     6003    3               KQ$DGRAN.HDR.EMPTYLIST='0'B;
      202     6004    3               KQ$DGRAN.HDR.UPD='1'B;
      203     6005    3             END;
      204     6006        /**/
      205     6007    2           KQ$DGRAN.FLINK$=KQ$CG.AVAIL.HD$;
      206     6008    2           KQ$DGRAN.BLINK$=ADDR(NIL);
      207     6009    2           KQ$CG.AVAIL.HD$=DGRAN$;
      208     6010    2           IF KQ$CG.AVAIL.TL$=ADDR(NIL) THEN
      209     6011    2             KQ$CG.AVAIL.TL$=DGRAN$;
      210     6012    2           ELSE
      211     6013    2             KQ$DGRAN.FLINK$->KQ$DGRAN.BLINK$=DGRAN$;
      212     6014    2           KQ$DGRAN.BYPASSCNT=0;
      213     6015    2           KQ$DGRAN.USECNT=0;
      214     6016    2           KQ$DGRAN.ACTCNT=0;
      215     6017    2           KQ$DFRBLK.ERRCODE=0;
      216     6018    2           IF KQ$CG.GETHD$~=ADDR(NIL) THEN
      217     6019    3             DO;
      218     6020    3               ALLOCFLG=1; /* Try to allocate from this gran */
      219     6021    3               KQ$DGRAN.USECNT=1; /* Hold it til done */
      220     6022    3             END;
      221     6023    2         END;
      222     6024    1       ELSE
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:7    
      223     6025    2         DO; /* Error TYC */
      224     6026    2           IF KQ$DFRBLK.ERRCODE=0 THEN
      225     6027    2             KQ$DFRBLK.ERRCODE=%KQDE_IOERR;
      226     6028    2   SETERR: ;
      227     6029                %LOCK (G=KQ$CG.DTREE.GATE);
      228     6032    2           IF DA=KQ$CG.FREEDA THEN
      229     6033    2             KQ$CG.FREEDA=0;
      230     6034    2         END;
      231     6035        /**/
      232     6036    1       ERRCODE=KQ$DFRBLK.ERRCODE;
      233     6037    1       IF ERRCODE~=0 AND DGRAN$~=ADDR(NIL) THEN
      234     6038    2         DO; /* Didn't read anything - give back page */
      235     6039                %UNLOCK (G=KQ$CG.DTREE.GATE);
      236     6042    2           LDGRAN$=DGRAN$;
      237     6043    2           CALL KQD$RELP(KQ$CG,LDGRAN$);
      238     6044                %LOCK (G=KQ$CG.DTREE.GATE);
      239     6047    2           DGRAN$=ADDR(NIL);
      240     6048    2           KQ$DFRBLK.DGRAN$=ADDR(NIL);  /* Just to be safe */
      241     6049    2         END;
      242     6050        /**/
      243     6051    1   FNDDFR: ;
      244     6052    1       P$=KQ$CG.IOHD$;
      245     6053    1       T$=ADDR(NIL);
      246     6054    2       DO WHILE(P$~=ADDR(NIL));
      247     6055    2         IF P$=DFR$ THEN
      248     6056    3           DO; /* Found our defer block */
      249     6057    3             IF T$=ADDR(NIL) THEN
      250     6058    3               KQ$CG.IOHD$=KQ$DFRBLK.LNK$;
      251     6059    3             ELSE
      252     6060    3               T$->KQ$DFRBLK.LNK$=KQ$DFRBLK.LNK$;
      253     6061    3             IF DFR$=KQ$CG.IOTL$ THEN
      254     6062    3               KQ$CG.IOTL$=T$;
      255     6063    3             GOTO GOTDFRBLK;
      256     6064    3           END;
      257     6065    2         T$=P$;
      258     6066    2         P$=P$->KQ$DFRBLK.LNK$;
      259     6067    2       END;
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:8    
      260     6068    1       CALL SC_CGKQE;
      261     6069        /*S*  SCREECH_CODE: KQE-S$CGKQE
      262     6070              TYPE: SCREECH
      263     6071              MESSAGE: Error processing I/O end-action for comgroup
      264     6072        */
      265     6073        /**/
      266     6074    1   GOTDFRBLK: ;
      267     6075    1       CODE=KQ$DFRBLK.CODE;
      268     6076    1       IF DGRAN$~=ADDR(NIL) THEN
      269     6077    1         KQ$DGRAN.USECNT=KQ$DGRAN.USECNT+1;
      270     6078    1   GOTDFRBLK2: ;
      271     6079    1       HD$=ADDR(NIL);
      272     6080    1       TL$=ADDR(NIL);
      273     6081    1       T$=ADDR(NIL);
      274     6082    1       P$=KQ$CG.IOHD$;
      275     6083    1       IF DA~=0 AND CODE~=%KQDC_WRITE THEN
      276     6084    2         DO WHILE(P$~=ADDR(NIL));
      277     6085    2           IF P$->KQ$DFRBLK.DA=DA AND P$->KQ$DFRBLK.CODE~=%KQDC_WRITE THEN
      278     6086    3             DO; /* Found one for this disk addr */
      279     6087    3               IF T$=ADDR(NIL) THEN
      280     6088    3                 KQ$CG.IOHD$=P$->KQ$DFRBLK.LNK$;
      281     6089    3               ELSE
      282     6090    3                 T$->KQ$DFRBLK.LNK$=P$->KQ$DFRBLK.LNK$;
      283     6091    3               IF KQ$CG.IOTL$=P$ THEN
      284     6092    3                 KQ$CG.IOTL$=T$;
      285     6093    3               IF TL$=ADDR(NIL) THEN
      286     6094    3                 HD$=P$;
      287     6095    3               ELSE
      288     6096    3                 TL$->KQ$DFRBLK.LNK$=P$;
      289     6097    3               P$->KQ$DFRBLK.ERRCODE=ERRCODE;
      290     6098    3               TL$=P$;
      291     6099    3               IF DGRAN$~=ADDR(NIL) THEN
      292     6100    3                 KQ$DGRAN.USECNT=KQ$DGRAN.USECNT+1;
      293     6101    3             END;
      294     6102    2           ELSE
      295     6103    2             T$=P$;
      296     6104    2           P$=P$->KQ$DFRBLK.LNK$;
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:9    
      297     6105    2         END;
      298     6106    1       IF TL$~=ADDR(NIL) THEN
      299     6107    1         TL$->KQ$DFRBLK.LNK$=ADDR(NIL);
      300     6108        /**/
      301     6109    1       IF CODE=%KQDC_WRITE THEN
      302     6110    2         DO;
      303     6111    2           IF KQ$DGRAN.HDR.FORCEOUT THEN
      304     6112    3             DO;
      305     6113    3               IF (KQ$DGRAN.HDR.CHAIN='0'B) THEN
      306     6114    4                 DO;
      307     6115    4                   KEYC = KQ$DGRAN.BTN.KEY;
      308     6116    4                   P$ = ADDR(KQ$DGRAN.BTN);
      309     6117    4                   CALL KQB$INSERTNL(KQ$CG.DTREE,KEY,P$) ALTRET(INSERR);
      310     6118    4                   KQ$DGRAN.HDR.CHAIN='1'B;
      311     6119    4                   KQ$DGRAN.FLINK$=KQ$CG.AVAIL.HD$;
      312     6120    4                   KQ$DGRAN.BLINK$=ADDR(NIL);
      313     6121    4                   KQ$CG.AVAIL.HD$=DGRAN$;
      314     6122    4                   IF KQ$CG.AVAIL.TL$=ADDR(NIL) THEN
      315     6123    4                     KQ$CG.AVAIL.TL$=DGRAN$;
      316     6124    4                   ELSE
      317     6125    4                     KQ$DGRAN.FLINK$->KQ$DGRAN.BLINK$=DGRAN$;
      318     6126    4                 END;
      319     6127
      320     6128    3               KQ$DGRAN.HDR.FORCEOUT='0'B;
      321     6129    3               CALL SSS$SYSTIME(KQ$DGRAN.TIME);
      322     6130    3               ALLOCFLG=1; /* Try to allocate space when done */
      323     6131    3               KQ$DGRAN.USECNT=KQ$DGRAN.USECNT+1;
      324     6132    3               GOTO PROCALL;
      325     6133    3             END;
      326     6134    2           IF HD$~=ADDR(NIL) THEN
      327     6135    3             DO;
      328     6136    3               IF KQ$CG.NEEDPGTL$=ADDR(NIL) THEN
      329     6137    3                 KQ$CG.NEEDPGHD$=HD$;
      330     6138    3               ELSE
      331     6139    3                 KQ$CG.NEEDPGTL$->KQ$DFRBLK.LNK$=HD$;
      332     6140    3               KQ$CG.NEEDPGTL$=TL$;
      333     6141    3               DELAYFLG=1;
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:10   
      334     6142    3               HD$=ADDR(NIL);
      335     6143    3               KQ$CG.NEEDPGCNT=KQ$CG.NEEDPGCNT+1;
      336     6144    3             END;
      337     6145    2           IF DFR$~=ADDR(NIL) THEN
      338     6146    3             DO;
      339     6147    3               KQ$DGRAN.USECNT=KQ$DGRAN.USECNT-1;
      340     6148    3               LDFR$=DFR$;
      341     6149    3               CALL KQD$RELDFR(KQ$CG,LDFR$);
      342     6150    3               DFR$=ADDR(NIL);
      343     6151    3             END;
      344     6152    2           GOTO WREND;
      345     6153    2         END;
      346     6154        /**/
      347     6155    1   PROCALL: ;
      348     6156    1       IF DFR$~=ADDR(NIL) THEN
      349     6157    1         CALL PROCESS; /* Process initial defer block */
      350     6158    1       ELSE
      351     6159              %UNLOCK (G=KQ$CG.DTREE.GATE);
      352     6162        /**/
      353     6163    2       DO WHILE(HD$~=ADDR(NIL));
      354     6164    2         DFR$=HD$;
      355     6165    2         HD$=KQ$DFRBLK.LNK$;
      356     6166              %LOCK (G=KQ$CG.DTREE.GATE);
      357     6169    2         CALL PROCESS;
      358     6170    2       END;
      359     6171        /**/
      360     6172    1       IF ALLOCFLG~=0 THEN
      361     6173    2         DO;
      362     6174    2           IF KQ$CG.GETHD$~=ADDR(NIL) THEN
      363     6175    3             DO;
      364     6176                    %LOCK (G=KQ$CG.DTREE.GATE);
      365     6179    3               LDGRAN$=DGRAN$;
      366     6180    3               CALL KQD$GETPROCESS(KQ$CG,,LDGRAN$);
      367     6181    3             END;
      368     6182                %LOCK (G=KQ$CG.DTREE.GATE);
      369     6185    2           KQ$DGRAN.USECNT=KQ$DGRAN.USECNT-1;
      370     6186                %UNLOCK (G=KQ$CG.DTREE.GATE);
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:11   
      371     6189    2         END;
      372     6190        /**/
      373     6191    1       IF ENTFLG=0 THEN  /* If at base level, see if anything needs doing */
      374     6192    2         DO;
      375     6193    2           IF KQ$CG.BASEDELAY~=0 THEN
      376     6194    2             CALL KCC$BASE;
      377     6195    2           IF KQ$CG.GARB.DELAY>0 AND KQ$CG.DFRFREEHD$~=ADDR(NIL) THEN
      378     6196    2             CALL KQS$CLOCK(KQ$CG);
      379     6197    2         END;
      380     6198        /**/
      381     6199    1       RETURN;
      382     6200
      383     6201    1   INSERR: ;
      384     6202    1       CALL SC_CGKQE;
      385     6203
      386     6204        %EJECT;
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:12   
      387     6205
      388     6206
      389     6207        /*D* NAME:         PROCESS
      390     6208
      391     6209             CALL:         CALL PROCESS;
      392     6210
      393     6211             INPUT:        DFR$ - Ptr to defer block to process
      394     6212                           ERRCODE - Error code to set in this block
      395     6213
      396     6214             DESCRIPTION:  The error code in this defer block is set
      397     6215                           to ERRCODE.  The appropriate handler is called
      398     6216                           depending on KQ$DFRBLK.CODE.
      399     6217
      400     6218        */
      401     6219
      402     6220
      403     6221    1   PROCESS: PROC;
      404     6222
      405     6223    2       KQ$DFRBLK.ERRCODE=ERRCODE;
      406     6224        /**/
      407     6225    2       LDFR$=DFR$; LDGRAN$=DGRAN$;
      408     6226    3       DO CASE(KQ$DFRBLK.CODE);
      409     6227    3         CASE(%KQDC_FETCH,%KQDC_RENEGE,%KQDC_DEL);
      410     6228    3           CALL KQD$FETCHDONE(KQ$CG,LDFR$,LDGRAN$);
      411     6229    3         CASE(%KQDC_WRITE);
      412     6230    3           KQ$DGRAN.USECNT=KQ$DGRAN.USECNT-1;
      413     6231    3           CALL KQD$RELDFR(KQ$CG,LDFR$);
      414     6232    3           DFR$=ADDR(NIL);
      415     6233                %UNLOCK (G=KQ$CG.DTREE.GATE);
      416     6236    3         CASE(%KQDC_GETFREE,%KQDC_GETNEW);
      417     6237    3           IF DGRAN$~=ADDR(NIL) THEN
      418     6238    3             KQ$DGRAN.USECNT=KQ$DGRAN.USECNT-1;
      419     6239    3           CALL KQD$GETPROCESS(KQ$CG,LDFR$,LDGRAN$);
      420     6240    3         CASE(ELSE);
      421     6241    3           CALL SC_CGKQE;
      422     6242    3       END;
      423     6243        /**/
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:13   
      424     6244    2       RETURN;
      425     6245    2   END PROCESS;
      426     6246
      427     6247        %EJECT;
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:14   
      428     6248
      429     6249
      430     6250        /*F* NAME:         KQE$WREA
      431     6251
      432     6252             PURPOSE:      Disk write end-action handler
      433     6253
      434     6254        */
      435     6255
      436     6256
      437     6257        /*D* NAME:         KQE$WREA
      438     6258
      439     6259             CALL:         Called from NIO$QUE at end-action
      440     6260
      441     6261             INPUT:        N$REQ - Queue packet
      442     6262                           N$REQ.EAINFOXP$ - Context block pointer
      443     6263                           N$REQ.EAINFOP$ - Granule pointer
      444     6264
      445     6265             DESCRIPTION:  For fetch, renege, and delete queues a read into
      446     6266                           the buffer.  For write, releases the page.  For
      447     6267                           newgran, calls the appropriate handler.
      448     6268
      449     6269        */
      450     6270
      451     6271
      452     6272        %EJECT;
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:15   
      453     6273
      454     6274
      455     6275    1   KQE$WREA: ENTRY(N$REQ);
      456     6276
      457     6277    1       ALLOCFLG=0;
      458     6278    1       DELAYFLG=0;
      459     6279    1       ENTFLG=0;  /* Called from IOQ */
      460     6280    1       CG$=N$REQ.EAINFOXP$;
      461     6281            %LOCK (G=KQ$CG.GATE.CG);
      462     6284    1       KQ$CG.IOCNT=KQ$CG.IOCNT-1;
      463     6285            %UNLOCK (G=KQ$CG.GATE.CG);
      464     6288    1       DGRAN$=N$REQ.EAINFOP$;
      465     6289    1       CALL KQX$LDASR(KQ$CG);
      466     6290        /**/
      467     6291    1       DA=ADDR(KQ$DGRAN.BTN.KEY)->WRD(0);
      468     6292    1       DFR$=KQ$DGRAN.DFR$;
      469     6293    1       IF KQ_LOG.DCIO THEN
      470     6294    1         CALL KQZ$LOG(KQ$CG,%KQLOG_DCWREA,,,DFR$,DA,DGRAN$);
      471     6295    1       KQ$DGRAN.ACTCNT=0;
      472     6296            %LOCK (G=KQ$CG.DTREE.GATE);
      473     6299    1       KQ$DGRAN.USECNT=KQ$DGRAN.USECNT-1;
      474     6300    1       KQ$DGRAN.HDR.UPD='0'B;
      475     6301    1       KQ$DGRAN.HDR.WRITE='0'B;
      476     6302        /**/
      477     6303    1       P$=KQ$CG.IOHD$;
      478     6304    2       DO WHILE(P$~=ADDR(NIL));
      479     6305    2         IF DA=P$->KQ$DFRBLK.DA AND P$->KQ$DFRBLK.CODE~=%KQDC_WRITE THEN
      480     6306    2           KQ$DGRAN.HDR.FORCEOUT = '0'B;
      481     6307    2         P$=P$->KQ$DFRBLK.LNK$;
      482     6308    2       END;
      483     6309        /**/
      484     6310    1       IF KQ$DGRAN.HDR.ADDFREE THEN
      485     6311    2         DO;
      486     6312    2           KQ$DGRAN.HDR.ADDFREE='0'B;
      487     6313    2           KQ$CG.ADDFREE=KQ$CG.ADDFREE-1;
      488     6314    2         END;
      489     6315        /**/
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:16   
      490     6316    1       ERRCODE=0;
      491     6317        /**/
      492     6318    1       IF DFR$~=ADDR(NIL) THEN
      493     6319    2         DO;
      494     6320    2           GOTO FNDDFR;
      495     6321    2         END;
      496     6322    1       CODE=%KQDC_WRITE;
      497     6323    1       GOTO GOTDFRBLK2;
      498     6324        /**/
      499     6325    1   WREND: ;
      500     6326    1       IF KQ_LOG.DCIO THEN
      501     6327    1         CALL KQZ$LOG(KQ$CG,%KQLOG_DCREMP,,,,DA,DGRAN$);
      502     6328        /**/
      503     6329            %UNLOCK (G=KQ$CG.DTREE.GATE);
      504     6332        /**/
      505     6333    1       IF DELAYFLG~=0 THEN
      506     6334    2         DO;
      507     6335                %LOCK (G=KQ$CG.GATE.CG);
      508     6338    2           IF KQ$CG.NEEDPGHD$~=ADDR(NIL) THEN
      509     6339    2             KQ$CG.DELAY.NEEDPG='1'B;
      510     6340                %UNLOCK (G=KQ$CG.GATE.CG);
      511     6343    2         END;
      512     6344        /**/
      513     6345    1       LDGRAN$=DGRAN$;
      514     6346    1       CALL KQD$RELP(KQ$CG,LDGRAN$);
      515     6347        /**/
      516     6348    1       IF KQ$CG.GETFLG=%GFLG_INIT THEN
      517     6349    1         CALL KQD$GETINIT(KQ$CG);
      518     6350        /**/
      519     6351    1       IF KQ$CG.BASEDELAY~=0 THEN
      520     6352    1         CALL KCC$BASE; /* Do any necessary base-level work */
      521     6353        /**/
      522     6354    1       IF KQ$CG.GARB.DELAY>0 AND KQ$CG.DFRFREEHD$~=ADDR(NIL) THEN
      523     6355    1         CALL KQS$CLOCK(KQ$CG);
      524     6356        /**/
      525     6357    1       RETURN;
      526     6358        /**/
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:17   
      527     6359    1   ERR: ;
      528     6360    1       CALL SC_CGKQE;
      529     6361    1       GOTO ERR;
      530     6362
      531     6363    1   END KQE$RDEA;

PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:18   
--  Include file information  --

   N_FC_C.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   KQ_SUBS_C.:E05TOU  is referenced.
   KQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KQ_MAC_C.:E05TOU  is referenced.
   KC_CP6.:E05TOU  is referenced.
   KC$CP6V_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   EL$TABLES.:E05TOU  is referenced.
      No diagnostics issued in procedure KQE$RDEA.

   Procedure KQE$RDEA requires 857 words for executable code.
   Procedure KQE$RDEA requires 34 words of local(AUTO) storage.

    No errors detected in file KQE$EA.:E05TSI    .

PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:19   

 Object Unit name= KQE$RDEA                                   File name= KQE$EA.:E05TOU
 UTS= JUL 30 '97 01:25:32.12 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   857   1531  KQE$RDEA
    1  RoData even  none    14     16  KQE$RDEA

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        1  KQE$RDEA
     0      4                  yes      Std        1  KQE$RDEAERR
     0   1224                  yes      Std        1  KQE$WREA
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:20   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 SSS$CCAC
         yes           Std       1 KQX$LDASR
         yes           Std       1 HFC$UNLOCK
 yes     yes           Std       8 KQZ$LOG
 yes     yes           Std       1 KQD$ERRLOG
         yes           Std       1 SSS$SYSTIME
 yes     yes           Std       3 KQD$GETPROCESS
 yes     yes           Std       3 KQB$INSERTNL
         yes           Std       0 KCC$BASE
 yes     yes           Std       2 KQD$RELP
 yes     yes           Std       2 KQD$RELDFR
 yes     yes           Std       1 KQS$CLOCK
         yes           Std       1 HFC$LOCK
 yes     yes           Std       1 KQD$GETINIT
 yes     yes           Std       3 KQD$FETCHDONE
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     SC_CGCACHE                            SC_CGKQE                              KQ_LOG
     KQ_ERRLOG_GATE                        KQ_ERRLOG_BFR                         B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ASLENTSID                             ISSID
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:21   


        1        1        /*M*  KQE$EA - Disk I/O end-action routines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /**/
        8        8        /*X* DMC,PLM=4,IND=2,SDI=2,CTI=2,ENU=0,AND,DCI=4,CSU=2,ECU=4,DTI=2,STI=0 */
        9        9        /**/
       10       10        /*P* NAME:         KQE$EA
       11       11
       12       12             PURPOSE:      Disk I/O end-action routines for comgroups
       13       13
       14       14        */
       15       15
       16       16
       17       17        KQE$RDEA: PROC(N$REQ);

     17  0 000000   000000 700200 xent  KQE$RDEA     TSX0  ! X66_AUTO_1
         0 000001   000042 000001                    ZERO    34,1

       18       18
       19       19
       20       20        /**/
       21       21        /* INCLUDES */
       22       22        /**/
       23       23        %INCLUDE EL$TABLES;
       24      346        %INCLUDE HF_LOCK_C;
       25      360        %INCLUDE KC$CP6V_C;
       26      480        %INCLUDE KC_CP6;
       27     1040        %INCLUDE KQ_MAC_C;
       28     3590        %INCLUDE KQ_DATA_R;
       29     4422        %INCLUDE KQ_SUBS_C;
       30     4722        %INCLUDE N$REQ;
       31     4796        %INCLUDE N_FC_C;
       32     4833
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:22   
       33     4834
       34     4835        /**/
       35     4836        /* PARAMETERS */
       36     4837        /**/
       37     4838        %N$REQ (STCLASS=);
       38     4896
       39     4897
       40     4898        /**/
       41     4899        /* BASED STRUCTURES */
       42     4900        /**/
       43     4901        %KQ_CG (FPTN=KQ$CG,STCLASS="BASED(CG$)");
       44     5640        %KQ_DFRBLK (FPTN=KQ$DFRBLK,STCLASS="BASED(DFR$)");
       45     5690        %KQ_DGRAN  (FPTN=KQ$DGRAN,STCLASS="BASED(DGRAN$)");
       46     5837    1   DCL WRD(0:1023) UBIN BASED ALIGNED;
       47     5838
       48     5839
       49     5840        /**/
       50     5841        /* AUTO */
       51     5842        /**/
       52     5843    1   DCL CG$ PTR;
       53     5844    1   DCL DFR$ PTR;
       54     5845    1   DCL DGRAN$ PTR;
       55     5846    1   DCL DA UBIN;
       56     5847    1   DCL 1 STAMP,
       57     5848    1         2 HASH UBIN(27) UNAL,
       58     5849    1         2 GMOD UBIN(9) UNAL;
       59     5850    1   DCL 1 KEY,
       60     5851    1         2 DA UBIN,
       61     5852    1         2 GARB UBIN;
       62     5853    1   DCL KEYC REDEF KEY CHAR(8);
       63     5854    1   DCL T$ PTR;
       64     5855    1   DCL P$ PTR;
       65     5856    1   DCL HD$ PTR;
       66     5857    1   DCL TL$ PTR;
       67     5858    1   DCL I UBIN;
       68     5859    1   DCL ERRCODE UBIN;
       69     5860    1   DCL CODE UBIN;
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:23   
       70     5861    1   DCL ALLOCFLG UBIN;
       71     5862    1   DCL DELAYFLG UBIN;
       72     5863    1   DCL ENTFLG UBIN;
       73     5864    1   DCL LDFR$ PTR;
       74     5865    1   DCL LDGRAN$ PTR;
       75     5866
       76     5867
       77     5868        /**/
       78     5869        /* EXTERNAL DATA */
       79     5870        /**/
       80     5871        %EL$CGERR (NAME=KQ_ERRLOG_BFR,STCLASS=SYMREF,N=33);
       81     5875
       82     5876
       83     5877        /**/
       84     5878        /* EXTERNAL ROUTINES */
       85     5879        /**/
       86     5880    1   DCL FAF$FRTOSRNJ ENTRY(3) ALTRET;
       87     5881    1   DCL FAF$SRTODR ENTRY(2) ALTRET;
       88     5882    1   DCL KCC$BASE ENTRY;
       89     5883    1   DCL KQB$DELETENL ENTRY(3) ALTRET;
       90     5884    1   DCL KQB$INSERTNL ENTRY(3) ALTRET;
       91     5885    1   DCL KQD$ERRLOG ENTRY(1) ALTRET;
       92     5886    1   DCL KQD$FETCHDONE ENTRY(3) ALTRET;
       93     5887    1   DCL KQD$GETINIT ENTRY(1) ALTRET;
       94     5888    1   DCL KQD$GETPROCESS ENTRY(3) ALTRET;
       95     5889    1   DCL KQD$RELDFR ENTRY(2) ALTRET;
       96     5890    1   DCL KQD$RELP ENTRY(2) ALTRET;
       97     5891    1   DCL KQS$CLOCK ENTRY(1) ALTRET;
       98     5892    1   DCL KQX$LDASR ENTRY(1);
       99     5893    1   DCL KQZ$LOG ENTRY(8) ALTRET;
      100     5894    1   DCL SSS$CCAC ENTRY;
      101     5895    1   DCL SSS$SYSTIME ENTRY(1);
      102     5896    1   DCL SC_CGCACHE ENTRY CONV(2,0);
      103     5897    1   DCL SC_CGKQE ENTRY CONV(2,0);
      104     5898
      105     5899
      106     5900        /**/
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:24   
      107     5901        /* EQUs */
      108     5902        /**/
      109     5903        %EQU GFLG_INIT=1;   /* See KQD$DBLK */
      110     5904
      111     5905        %EJECT;
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:25   
      112     5906
      113     5907
      114     5908        /*F* NAME:         KQE$RDEA
      115     5909
      116     5910             PURPOSE:      Disk read end-action handler
      117     5911
      118     5912        */
      119     5913
      120     5914
      121     5915        /*D* NAME:         KQE$RDEA
      122     5916
      123     5917             CALL:         Called via NIO$QUE at end-action
      124     5918
      125     5919             INPUT:        N$REQ - Queue packet
      126     5920                           N$REQ.EAINFOP$ - Ptr to defer block
      127     5921                           N$REQ.EAINFOXP$ - Ptr to comgroup context
      128     5922
      129     5923             DESCRIPTION:  Validates granule stamp, adds to disk cache
      130     5924                           tree and available chains.  Removes defer block
      131     5925                           from the active I/O list and processes it.
      132     5926                           Loops thru active I/O list and removes and
      133     5927                           processes any defer blocks for this granule.
      134     5928
      135     5929
      136     5930
      137     5931        %EJECT;
      138     5932
      139     5933
      140     5934        KQE$RDEA: ENTRY(N$REQ);
      141     5935        */
      142     5936
      143     5937    1       ENTFLG=0;  /* Called from IOQ */

   5937  0 000002   200024 450100                    STZ     ENTFLG,,AUTO

      144     5938    1       GOTO COMMON;

PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:26   
   5938  0 000003   000010 710000 0                  TRA     COMMON

      145     5939
      146     5940
      147     5941    1   KQE$RDEAERR: ENTRY(N$REQ);

   5941  0 000004   000000 700200 xent  KQE$RDEAERR  TSX0  ! X66_AUTO_1
         0 000005   000042 000001                    ZERO    34,1

      148     5942
      149     5943    1       ENTFLG=1;  /* Called from KQD */

   5943  0 000006   000001 235007                    LDA     1,DL
         0 000007   200024 755100                    STA     ENTFLG,,AUTO

   5943  0 000010                       COMMON       null
      150     5944
      151     5945    1   COMMON: ;
      152     5946    1       CALL SSS$CCAC;   /* Clear the CACHE before looking at granule */

   5946  0 000010   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 000011   000000 701000 xent               TSX1    SSS$CCAC
         0 000012   000000 011000                    NOP     0

      153     5947    1       ALLOCFLG=0;

   5947  0 000013   200022 450100                    STZ     ALLOCFLG,,AUTO

      154     5948    1       DELAYFLG=0;

   5948  0 000014   200023 450100                    STZ     DELAYFLG,,AUTO

      155     5949    1       DFR$=N$REQ.EAINFOP$;

   5949  0 000015   200003 470500                    LDP0    @N$REQ,,AUTO
         0 000016   000024 236100                    LDQ     20,,PR0
         0 000017   200005 756100                    STQ     DFR$,,AUTO
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:27   

      156     5950    1       CG$=N$REQ.EAINFOXP$;

   5950  0 000020   000025 236100                    LDQ     21,,PR0
         0 000021   200004 756100                    STQ     CG$,,AUTO

      157     5951    1       CALL KQX$LDASR(KQ$CG);

   5951  0 000022   200004 630500                    EPPR0   CG$,,AUTO
         0 000023   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000024   000000 701000 xent               TSX1    KQX$LDASR
         0 000025   000000 011000                    NOP     0

      158     5952            %LOCK (G=KQ$CG.GATE.CG);

   5953  0 000026   200004 236100                    LDQ     CG$,,AUTO
         0 000027   000107 036003                    ADLQ    71,DU
         0 000030   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 000031   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 000032   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000033   000000 701000 xent               TSX1    HFC$LOCK
         0 000034   000000 011000                    NOP     0

      159     5955    1       KQ$CG.IOCNT=KQ$CG.IOCNT-1;

   5955  0 000035   200004 470500                    LDP0    CG$,,AUTO
         0 000036   000225 720100                    LXL0    149,,PR0
         0 000037   777777 621010                    EAX1    -1,X0
         0 000040   000225 441100                    SXL1    149,,PR0

      160     5956            %UNLOCK (G=KQ$CG.GATE.CG);

   5957  0 000041   200004 236100                    LDQ     CG$,,AUTO
         0 000042   000107 036003                    ADLQ    71,DU
         0 000043   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 000044   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 000045   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:28   
         0 000046   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000047   000000 011000                    NOP     0

      161     5959    1       DGRAN$=KQ$DFRBLK.DGRAN$;

   5959  0 000050   200005 470500                    LDP0    DFR$,,AUTO
         0 000051   000007 236100                    LDQ     7,,PR0
         0 000052   200006 756100                    STQ     DGRAN$,,AUTO

      162     5960    1       DA=KQ$DFRBLK.DA;

   5960  0 000053   000002 235100                    LDA     2,,PR0
         0 000054   200007 755100                    STA     DA,,AUTO

      163     5961    1       IF KQ_LOG.DCIO THEN

   5961  0 000055   000000 236000 xsym               LDQ     KQ_LOG
         0 000056   010000 316003                    CANQ    4096,DU
         0 000057   000100 600000 0                  TZE     s:5964

      164     5962    1         CALL KQZ$LOG(KQ$CG,%KQLOG_DCRDEA,,,DFR$,DA,DGRAN$);

   5962  0 000060   200006 631500                    EPPR1   DGRAN$,,AUTO
         0 000061   200040 451500                    STP1    LDGRAN$+10,,AUTO
         0 000062   200007 633500                    EPPR3   DA,,AUTO
         0 000063   200037 453500                    STP3    LDGRAN$+9,,AUTO
         0 000064   200005 634500                    EPPR4   DFR$,,AUTO
         0 000065   200036 454500                    STP4    LDGRAN$+8,,AUTO
         0 000066   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000067   000001 235000 xsym               LDA     B_VECTNIL+1
         0 000070   200034 757100                    STAQ    LDGRAN$+6,,AUTO
         0 000071   000001 236000 1                  LDQ     1
         0 000072   200004 235100                    LDA     CG$,,AUTO
         0 000073   200032 757100                    STAQ    LDGRAN$+4,,AUTO
         0 000074   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 000075   000025 631400 xsym               EPPR1   B_VECTNIL+21
         0 000076   000000 701000 xent               TSX1    KQZ$LOG
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:29   
         0 000077   000000 011000                    NOP     0

      165     5963        /**/
      166     5964    1       IF N$REQ.TYC='1'B THEN  /* No error */

   5964  0 000100   200003 470500                    LDP0    @N$REQ,,AUTO
         0 000101   000021 236100                    LDQ     17,,PR0
         0 000102   400000 116003                    CMPQ    -131072,DU
         0 000103   000324 601000 0                  TNZ     s:6026

      167     5965    2         DO;

      168     5966    2           STAMP.GMOD=DA;

   5966  0 000104   200007 236100                    LDQ     DA,,AUTO
         0 000105   200010 552104                    STBQ    STAMP,'04'O,AUTO

      169     5967    2           STAMP.HASH=KQ$CG.GRAN.STAMP.HASH;

   5967  0 000106   200004 471500                    LDP1    CG$,,AUTO
         0 000107   100253 236100                    LDQ     171,,PR1
         0 000110   200010 552170                    STBQ    STAMP,'70'O,AUTO

      170     5968    2           KEY.DA=DA;

   5968  0 000111   200007 235100                    LDA     DA,,AUTO
         0 000112   200011 755100                    STA     KEY,,AUTO

      171     5969    2           KEY.GARB=0;

   5969  0 000113   200012 450100                    STZ     KEY+1,,AUTO

      172     5970    2           IF KQ$DGRAN.HDR.STAMP~=STAMP OR KQ$DGRAN.BTN.KEY~=KEYC THEN

   5970  0 000114   200006 473500                    LDP3    DGRAN$,,AUTO
         0 000115   300000 236100                    LDQ     0,,PR3
         0 000116   200010 116100                    CMPQ    STAMP,,AUTO
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:30   
         0 000117   000124 601000 0                  TNZ     s:5972
         0 000120   040100 106500                    CMPC    fill='040'O
         0 000121   300011 000010                    ADSC9   9,,PR3                   cn=0,n=8
         0 000122   200011 000010                    ADSC9   KEY,,AUTO                cn=0,n=8
         0 000123   000174 600000 0                  TZE     s:5988

      173     5971    3             DO;

      174     5972    3               CALL SC_CGCACHE;  /* Snap */

   5972  0 000124   000000 713400 xsym               CLIMB   SC_CGCACHE
         0 000125   000000 600000 xsid               climb   nvectors=         0

      175     5973    3               KQ$DFRBLK.ERRCODE=%KQDE_STMP;

   5973  0 000126   200005 470500                    LDP0    DFR$,,AUTO
         0 000127   000003 236003                    LDQ     3,DU
         0 000130   000001 552120                    STBQ    1,'20'O,PR0

      176     5974                    %LOCK (G=KQ_ERRLOG_GATE);

   5975  0 000131   000002 630400 1                  EPPR0   2
         0 000132   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000133   000000 701000 xent               TSX1    HFC$LOCK
         0 000134   000000 011000                    NOP     0

      177     5977    3               KQ_ERRLOG_BFR='0'B;

   5977  0 000135   000000 100400                    MLR     fill='000'O
         0 000136   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         0 000137   000000 000274 xsym               ADSC9   KQ_ERRLOG_BFR            cn=0,n=188

      178     5978    3               KQ_ERRLOG_BFR.CODE=%KQELOG_KQE_GSTMP;

   5978  0 000140   010000 236003                    LDQ     4096,DU
         0 000141   000000 552040 xsym               STBQ    KQ_ERRLOG_BFR,'40'O

PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:31   
      179     5979    3               KQ_ERRLOG_BFR.INFO(0)=BITBIN(STAMP);

   5979  0 000142   200010 235100                    LDA     STAMP,,AUTO
         0 000143   000016 755000 xsym               STA     KQ_ERRLOG_BFR+14

      180     5980    3               ADDR(KQ_ERRLOG_BFR.INFO(1))->KQ$DGRAN=KQ$DGRAN;

   5980  0 000144   200006 470500                    LDP0    DGRAN$,,AUTO
         0 000145   000000 100500                    MLR     fill='000'O
         0 000146   000000 000200                    ADSC9   0,,PR0                   cn=0,n=128
         0 000147   000017 000200 xsym               ADSC9   KQ_ERRLOG_BFR+15         cn=0,n=128

      181     5981    3               KQ_ERRLOG_BFR.SIZ=1+SIZEW(KQ$DGRAN);

   5981  0 000150   000041 235007                    LDA     33,DL
         0 000151   000015 755000 xsym               STA     KQ_ERRLOG_BFR+13

      182     5982    3               CALL KQD$ERRLOG(KQ$CG);

   5982  0 000152   200004 630500                    EPPR0   CG$,,AUTO
         0 000153   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000154   000000 701000 xent               TSX1    KQD$ERRLOG
         0 000155   000000 011000                    NOP     0

      183     5983    3               KQ$DGRAN.HDR.PTYP=%KQ_PTYP_DATA;

   5983  0 000156   200006 470500                    LDP0    DGRAN$,,AUTO
         0 000157   000001 236100                    LDQ     1,,PR0
         0 000160   000003 376000 1                  ANQ     3
         0 000161   000001 276003                    ORQ     1,DU
         0 000162   000001 756100                    STQ     1,,PR0

      184     5984    3               KQ$DGRAN.HDR.GTYP=%KQ_PTYP_DATA;

   5984  0 000163   200006 470500                    LDP0    DGRAN$,,AUTO
         0 000164   000001 236100                    LDQ     1,,PR0
         0 000165   000004 376000 1                  ANQ     4
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:32   
         0 000166   040000 276007                    ORQ     16384,DL
         0 000167   000001 756100                    STQ     1,,PR0

      185     5985    3               KQ$DGRAN.HDR.SELF$=DGRAN$;

   5985  0 000170   200006 236100                    LDQ     DGRAN$,,AUTO
         0 000171   200006 470500                    LDP0    DGRAN$,,AUTO
         0 000172   000002 756100                    STQ     2,,PR0

      186     5986    3               GOTO SETERR;

   5986  0 000173   000332 710000 0                  TRA     SETERR

      187     5987    3             END;
      188     5988    2           KQ$DGRAN.HDR.SELF$=DGRAN$;

   5988  0 000174   200006 236100                    LDQ     DGRAN$,,AUTO
         0 000175   300002 756100                    STQ     2,,PR3

      189     5989    2           KQ$DGRAN.HDR.WRITE='0'B;

   5989  0 000176   200006 473500                    LDP3    DGRAN$,,AUTO
         0 000177   000005 236000 1                  LDQ     5
         0 000200   300001 356100                    ANSQ    1,,PR3

      190     5990    2           KQ$DGRAN.HDR.FORCEOUT='0'B;

   5990  0 000201   200006 473500                    LDP3    DGRAN$,,AUTO
         0 000202   000006 236000 1                  LDQ     6
         0 000203   300001 356100                    ANSQ    1,,PR3

      191     5991    2           KQ$DGRAN.HDR.ADDFREE='0'B;

   5991  0 000204   200006 473500                    LDP3    DGRAN$,,AUTO
         0 000205   000007 236000 1                  LDQ     7
         0 000206   300001 356100                    ANSQ    1,,PR3

PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:33   
      192     5992    2           CALL SSS$SYSTIME(KQ$DGRAN.TIME);

   5992  0 000207   200006 236100                    LDQ     DGRAN$,,AUTO
         0 000210   000024 036003                    ADLQ    20,DU
         0 000211   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 000212   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 000213   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000214   000000 701000 xent               TSX1    SSS$SYSTIME
         0 000215   000000 011000                    NOP     0

      193     5993    2           P$=ADDR(KQ$DGRAN.BTN);

   5993  0 000216   200006 236100                    LDQ     DGRAN$,,AUTO
         0 000217   000004 036003                    ADLQ    4,DU
         0 000220   200014 756100                    STQ     P$,,AUTO

      194     5994                %LOCK (G=KQ$CG.DTREE.GATE);

   5995  0 000221   200004 236100                    LDQ     CG$,,AUTO
         0 000222   000231 036003                    ADLQ    153,DU
         0 000223   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 000224   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 000225   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000226   000000 701000 xent               TSX1    HFC$LOCK
         0 000227   000000 011000                    NOP     0

      195     5997    2           CALL KQB$INSERTNL(KQ$CG.DTREE,KEY,P$) ALTRET(INSERR);

   5997  0 000230   200014 630500                    EPPR0   P$,,AUTO
         0 000231   200034 450500                    STP0    LDGRAN$+6,,AUTO
         0 000232   200011 631500                    EPPR1   KEY,,AUTO
         0 000233   200033 451500                    STP1    LDGRAN$+5,,AUTO
         0 000234   200004 236100                    LDQ     CG$,,AUTO
         0 000235   000231 036003                    ADLQ    153,DU
         0 000236   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 000237   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 000240   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:34   
         0 000241   000000 701000 xent               TSX1    KQB$INSERTNL
         0 000242   001101 702000 0                  TSX2    INSERR

      196     5998    2           KQ$DGRAN.HDR.CHAIN='1'B;

   5998  0 000243   200006 470500                    LDP0    DGRAN$,,AUTO
         0 000244   000020 236003                    LDQ     16,DU
         0 000245   000001 256100                    ORSQ    1,,PR0

      197     5999    2           KQ$DGRAN.HDR.UPD='0'B;

   5999  0 000246   200006 470500                    LDP0    DGRAN$,,AUTO
         0 000247   000010 236000 1                  LDQ     8
         0 000250   000001 356100                    ANSQ    1,,PR0

      198     6000    2           IF DA=KQ$CG.FREEDA THEN

   6000  0 000251   200004 470500                    LDP0    CG$,,AUTO
         0 000252   000226 236100                    LDQ     150,,PR0
         0 000253   000032 376000 xsym               ANQ     B_VECTNIL+26
         0 000254   200007 116100                    CMPQ    DA,,AUTO
         0 000255   000266 601000 0                  TNZ     s:6007

      199     6001    3             DO;

      200     6002    3               KQ$CG.FREEDA=KQ$DGRAN.FREEFLINK;

   6002  0 000256   200006 471500                    LDP1    DGRAN$,,AUTO
         0 000257   100023 236100                    LDQ     19,,PR1
         0 000260   000226 552134                    STBQ    150,'34'O,PR0

      201     6003    3               KQ$DGRAN.HDR.EMPTYLIST='0'B;

   6003  0 000261   000011 236000 1                  LDQ     9
         0 000262   100001 356100                    ANSQ    1,,PR1

      202     6004    3               KQ$DGRAN.HDR.UPD='1'B;
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:35   

   6004  0 000263   200006 471500                    LDP1    DGRAN$,,AUTO
         0 000264   000010 236003                    LDQ     8,DU
         0 000265   100001 256100                    ORSQ    1,,PR1

      203     6005    3             END;

      204     6006        /**/
      205     6007    2           KQ$DGRAN.FLINK$=KQ$CG.AVAIL.HD$;

   6007  0 000266   000244 236100                    LDQ     164,,PR0
         0 000267   200006 471500                    LDP1    DGRAN$,,AUTO
         0 000270   100017 756100                    STQ     15,,PR1

      206     6008    2           KQ$DGRAN.BLINK$=ADDR(NIL);

   6008  0 000271   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000272   100016 756100                    STQ     14,,PR1

      207     6009    2           KQ$CG.AVAIL.HD$=DGRAN$;

   6009  0 000273   200006 236100                    LDQ     DGRAN$,,AUTO
         0 000274   000244 756100                    STQ     164,,PR0

      208     6010    2           IF KQ$CG.AVAIL.TL$=ADDR(NIL) THEN

   6010  0 000275   000245 236100                    LDQ     165,,PR0
         0 000276   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000277   000303 601000 0                  TNZ     s:6013

      209     6011    2             KQ$CG.AVAIL.TL$=DGRAN$;

   6011  0 000300   200006 236100                    LDQ     DGRAN$,,AUTO
         0 000301   000245 756100                    STQ     165,,PR0
         0 000302   000306 710000 0                  TRA     s:6014

      210     6012    2           ELSE
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:36   
      211     6013    2             KQ$DGRAN.FLINK$->KQ$DGRAN.BLINK$=DGRAN$;

   6013  0 000303   100017 473500                    LDP3    15,,PR1
         0 000304   200006 236100                    LDQ     DGRAN$,,AUTO
         0 000305   300016 756100                    STQ     14,,PR3

      212     6014    2           KQ$DGRAN.BYPASSCNT=0;

   6014  0 000306   100020 450100                    STZ     16,,PR1

      213     6015    2           KQ$DGRAN.USECNT=0;

   6015  0 000307   100013 450100                    STZ     11,,PR1

      214     6016    2           KQ$DGRAN.ACTCNT=0;

   6016  0 000310   100022 450100                    STZ     18,,PR1

      215     6017    2           KQ$DFRBLK.ERRCODE=0;

   6017  0 000311   200005 473500                    LDP3    DFR$,,AUTO
         0 000312   000000 236003                    LDQ     0,DU
         0 000313   300001 552120                    STBQ    1,'20'O,PR3

      216     6018    2           IF KQ$CG.GETHD$~=ADDR(NIL) THEN

   6018  0 000314   000257 236100                    LDQ     175,,PR0
         0 000315   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000316   000350 600000 0                  TZE     s:6036

      217     6019    3             DO;

      218     6020    3               ALLOCFLG=1; /* Try to allocate from this gran */

   6020  0 000317   000001 235007                    LDA     1,DL
         0 000320   200022 755100                    STA     ALLOCFLG,,AUTO

PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:37   
      219     6021    3               KQ$DGRAN.USECNT=1; /* Hold it til done */

   6021  0 000321   200006 471500                    LDP1    DGRAN$,,AUTO
         0 000322   100013 755100                    STA     11,,PR1

      220     6022    3             END;

      221     6023    2         END;

   6023  0 000323   000350 710000 0                  TRA     s:6036

      222     6024    1       ELSE
      223     6025    2         DO; /* Error TYC */

      224     6026    2           IF KQ$DFRBLK.ERRCODE=0 THEN

   6026  0 000324   200005 471500                    LDP1    DFR$,,AUTO
         0 000325   100001 236100                    LDQ     1,,PR1
         0 000326   000777 316003                    CANQ    511,DU
         0 000327   000332 601000 0                  TNZ     SETERR

      225     6027    2             KQ$DFRBLK.ERRCODE=%KQDE_IOERR;

   6027  0 000330   000006 236003                    LDQ     6,DU
         0 000331   100001 552120                    STBQ    1,'20'O,PR1

   6026  0 000332                       SETERR       null
      226     6028    2   SETERR: ;
      227     6029                %LOCK (G=KQ$CG.DTREE.GATE);

   6030  0 000332   200004 236100                    LDQ     CG$,,AUTO
         0 000333   000231 036003                    ADLQ    153,DU
         0 000334   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 000335   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 000336   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000337   000000 701000 xent               TSX1    HFC$LOCK
         0 000340   000000 011000                    NOP     0
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:38   

      228     6032    2           IF DA=KQ$CG.FREEDA THEN

   6032  0 000341   200004 470500                    LDP0    CG$,,AUTO
         0 000342   000226 236100                    LDQ     150,,PR0
         0 000343   000032 376000 xsym               ANQ     B_VECTNIL+26
         0 000344   200007 116100                    CMPQ    DA,,AUTO
         0 000345   000350 601000 0                  TNZ     s:6036

      229     6033    2             KQ$CG.FREEDA=0;

   6033  0 000346   000000 236003                    LDQ     0,DU
         0 000347   000226 552134                    STBQ    150,'34'O,PR0

      230     6034    2         END;

      231     6035        /**/
      232     6036    1       ERRCODE=KQ$DFRBLK.ERRCODE;

   6036  0 000350   200005 471500                    LDP1    DFR$,,AUTO
         0 000351   100001 236100                    LDQ     1,,PR1
         0 000352   000022 772000                    QRL     18
         0 000353   000777 376007                    ANQ     511,DL
         0 000354   200020 756100                    STQ     ERRCODE,,AUTO

      233     6037    1       IF ERRCODE~=0 AND DGRAN$~=ADDR(NIL) THEN

   6037  0 000355   000415 600000 0                  TZE     FNDDFR
         0 000356   200006 236100                    LDQ     DGRAN$,,AUTO
         0 000357   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000360   000415 600000 0                  TZE     FNDDFR

      234     6038    2         DO; /* Didn't read anything - give back page */

      235     6039                %UNLOCK (G=KQ$CG.DTREE.GATE);

   6040  0 000361   200004 236100                    LDQ     CG$,,AUTO
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:39   
         0 000362   000231 036003                    ADLQ    153,DU
         0 000363   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 000364   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 000365   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000366   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000367   000000 011000                    NOP     0

      236     6042    2           LDGRAN$=DGRAN$;

   6042  0 000370   200006 236100                    LDQ     DGRAN$,,AUTO
         0 000371   200026 756100                    STQ     LDGRAN$,,AUTO

      237     6043    2           CALL KQD$RELP(KQ$CG,LDGRAN$);

   6043  0 000372   200026 630500                    EPPR0   LDGRAN$,,AUTO
         0 000373   200033 450500                    STP0    LDGRAN$+5,,AUTO
         0 000374   200004 236100                    LDQ     CG$,,AUTO
         0 000375   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 000376   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 000377   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000400   000000 701000 xent               TSX1    KQD$RELP
         0 000401   000000 011000                    NOP     0

      238     6044                %LOCK (G=KQ$CG.DTREE.GATE);

   6045  0 000402   200004 236100                    LDQ     CG$,,AUTO
         0 000403   000231 036003                    ADLQ    153,DU
         0 000404   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 000405   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 000406   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000407   000000 701000 xent               TSX1    HFC$LOCK
         0 000410   000000 011000                    NOP     0

      239     6047    2           DGRAN$=ADDR(NIL);

   6047  0 000411   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000412   200006 756100                    STQ     DGRAN$,,AUTO
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:40   

      240     6048    2           KQ$DFRBLK.DGRAN$=ADDR(NIL);  /* Just to be safe */

   6048  0 000413   200005 470500                    LDP0    DFR$,,AUTO
         0 000414   000007 756100                    STQ     7,,PR0

      241     6049    2         END;

   6047  0 000415                       FNDDFR       null
      242     6050        /**/
      243     6051    1   FNDDFR: ;
      244     6052    1       P$=KQ$CG.IOHD$;

   6052  0 000415   200004 470500                    LDP0    CG$,,AUTO
         0 000416   000246 236100                    LDQ     166,,PR0
         0 000417   200014 756100                    STQ     P$,,AUTO

      245     6053    1       T$=ADDR(NIL);

   6053  0 000420   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000421   200013 756100                    STQ     T$,,AUTO

      246     6054    2       DO WHILE(P$~=ADDR(NIL));

   6054  0 000422   000455 710000 0                  TRA     s:6067

      247     6055    2         IF P$=DFR$ THEN

   6055  0 000423   200014 236100                    LDQ     P$,,AUTO
         0 000424   200005 116100                    CMPQ    DFR$,,AUTO
         0 000425   000451 601000 0                  TNZ     s:6065

      248     6056    3           DO; /* Found our defer block */

      249     6057    3             IF T$=ADDR(NIL) THEN

   6057  0 000426   200013 236100                    LDQ     T$,,AUTO
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:41   
         0 000427   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000430   000436 601000 0                  TNZ     s:6060

      250     6058    3               KQ$CG.IOHD$=KQ$DFRBLK.LNK$;

   6058  0 000431   200005 470500                    LDP0    DFR$,,AUTO
         0 000432   000000 236100                    LDQ     0,,PR0
         0 000433   200004 471500                    LDP1    CG$,,AUTO
         0 000434   100246 756100                    STQ     166,,PR1
         0 000435   000442 710000 0                  TRA     s:6061

      251     6059    3             ELSE
      252     6060    3               T$->KQ$DFRBLK.LNK$=KQ$DFRBLK.LNK$;

   6060  0 000436   200005 470500                    LDP0    DFR$,,AUTO
         0 000437   000000 236100                    LDQ     0,,PR0
         0 000440   200013 471500                    LDP1    T$,,AUTO
         0 000441   100000 756100                    STQ     0,,PR1

      253     6061    3             IF DFR$=KQ$CG.IOTL$ THEN

   6061  0 000442   200004 470500                    LDP0    CG$,,AUTO
         0 000443   200005 236100                    LDQ     DFR$,,AUTO
         0 000444   000247 116100                    CMPQ    167,,PR0
         0 000445   000450 601000 0                  TNZ     s:6063

      254     6062    3               KQ$CG.IOTL$=T$;

   6062  0 000446   200013 236100                    LDQ     T$,,AUTO
         0 000447   000247 756100                    STQ     167,,PR0

      255     6063    3             GOTO GOTDFRBLK;

   6063  0 000450   000462 710000 0                  TRA     GOTDFRBLK

      256     6064    3           END;
      257     6065    2         T$=P$;
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:42   

   6065  0 000451   200013 756100                    STQ     T$,,AUTO

      258     6066    2         P$=P$->KQ$DFRBLK.LNK$;

   6066  0 000452   200014 470500                    LDP0    P$,,AUTO
         0 000453   000000 236100                    LDQ     0,,PR0
         0 000454   200014 756100                    STQ     P$,,AUTO

      259     6067    2       END;

   6067  0 000455   200014 236100                    LDQ     P$,,AUTO
         0 000456   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000457   000423 601000 0                  TNZ     s:6055

      260     6068    1       CALL SC_CGKQE;

   6068  0 000460   000000 713400 xsym               CLIMB   SC_CGKQE
         0 000461   000000 600000 xsid               climb   nvectors=         0

   6062  0 000462                       GOTDFRBLK    null
      261     6069        /*S*  SCREECH_CODE: KQE-S$CGKQE
      262     6070              TYPE: SCREECH
      263     6071              MESSAGE: Error processing I/O end-action for comgroup
      264     6072        */
      265     6073        /**/
      266     6074    1   GOTDFRBLK: ;
      267     6075    1       CODE=KQ$DFRBLK.CODE;

   6075  0 000462   200005 470500                    LDP0    DFR$,,AUTO
         0 000463   000001 236100                    LDQ     1,,PR0
         0 000464   000033 772000                    QRL     27
         0 000465   200021 756100                    STQ     CODE,,AUTO

      268     6076    1       IF DGRAN$~=ADDR(NIL) THEN

   6076  0 000466   200006 236100                    LDQ     DGRAN$,,AUTO
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:43   
         0 000467   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000470   000473 600000 0                  TZE     GOTDFRBLK2

      269     6077    1         KQ$DGRAN.USECNT=KQ$DGRAN.USECNT+1;

   6077  0 000471   200006 471500                    LDP1    DGRAN$,,AUTO
         0 000472   100013 054100                    AOS     11,,PR1

   6076  0 000473                       GOTDFRBLK2   null
      270     6078    1   GOTDFRBLK2: ;
      271     6079    1       HD$=ADDR(NIL);

   6079  0 000473   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000474   200015 756100                    STQ     HD$,,AUTO

      272     6080    1       TL$=ADDR(NIL);

   6080  0 000475   200016 756100                    STQ     TL$,,AUTO

      273     6081    1       T$=ADDR(NIL);

   6081  0 000476   200013 756100                    STQ     T$,,AUTO

      274     6082    1       P$=KQ$CG.IOHD$;

   6082  0 000477   200004 470500                    LDP0    CG$,,AUTO
         0 000500   000246 236100                    LDQ     166,,PR0
         0 000501   200014 756100                    STQ     P$,,AUTO

      275     6083    1       IF DA~=0 AND CODE~=%KQDC_WRITE THEN

   6083  0 000502   200007 235100                    LDA     DA,,AUTO
         0 000503   000574 600000 0                  TZE     s:6106
         0 000504   200021 235100                    LDA     CODE,,AUTO
         0 000505   000006 115007                    CMPA    6,DL
         0 000506   000574 600000 0                  TZE     s:6106

PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:44   
      276     6084    2         DO WHILE(P$~=ADDR(NIL));

   6084  0 000507   000572 710000 0                  TRA     s:6105

      277     6085    2           IF P$->KQ$DFRBLK.DA=DA AND P$->KQ$DFRBLK.CODE~=%KQDC_WRITE THEN

   6085  0 000510   200014 470500                    LDP0    P$,,AUTO
         0 000511   000002 236100                    LDQ     2,,PR0
         0 000512   200007 116100                    CMPQ    DA,,AUTO
         0 000513   000565 601000 0                  TNZ     s:6103
         0 000514   000001 236100                    LDQ     1,,PR0
         0 000515   777000 376003                    ANQ     -512,DU
         0 000516   006000 116003                    CMPQ    3072,DU
         0 000517   000565 600000 0                  TZE     s:6103

      278     6086    3             DO; /* Found one for this disk addr */

      279     6087    3               IF T$=ADDR(NIL) THEN

   6087  0 000520   200013 236100                    LDQ     T$,,AUTO
         0 000521   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000522   000527 601000 0                  TNZ     s:6090

      280     6088    3                 KQ$CG.IOHD$=P$->KQ$DFRBLK.LNK$;

   6088  0 000523   000000 236100                    LDQ     0,,PR0
         0 000524   200004 471500                    LDP1    CG$,,AUTO
         0 000525   100246 756100                    STQ     166,,PR1
         0 000526   000532 710000 0                  TRA     s:6091

      281     6089    3               ELSE
      282     6090    3                 T$->KQ$DFRBLK.LNK$=P$->KQ$DFRBLK.LNK$;

   6090  0 000527   000000 236100                    LDQ     0,,PR0
         0 000530   200013 471500                    LDP1    T$,,AUTO
         0 000531   100000 756100                    STQ     0,,PR1

PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:45   
      283     6091    3               IF KQ$CG.IOTL$=P$ THEN

   6091  0 000532   200004 470500                    LDP0    CG$,,AUTO
         0 000533   000247 236100                    LDQ     167,,PR0
         0 000534   200014 116100                    CMPQ    P$,,AUTO
         0 000535   000540 601000 0                  TNZ     s:6093

      284     6092    3                 KQ$CG.IOTL$=T$;

   6092  0 000536   200013 236100                    LDQ     T$,,AUTO
         0 000537   000247 756100                    STQ     167,,PR0

      285     6093    3               IF TL$=ADDR(NIL) THEN

   6093  0 000540   200016 236100                    LDQ     TL$,,AUTO
         0 000541   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000542   000546 601000 0                  TNZ     s:6096

      286     6094    3                 HD$=P$;

   6094  0 000543   200014 236100                    LDQ     P$,,AUTO
         0 000544   200015 756100                    STQ     HD$,,AUTO
         0 000545   000551 710000 0                  TRA     s:6097

      287     6095    3               ELSE
      288     6096    3                 TL$->KQ$DFRBLK.LNK$=P$;

   6096  0 000546   200014 236100                    LDQ     P$,,AUTO
         0 000547   200016 471500                    LDP1    TL$,,AUTO
         0 000550   100000 756100                    STQ     0,,PR1

      289     6097    3               P$->KQ$DFRBLK.ERRCODE=ERRCODE;

   6097  0 000551   200014 471500                    LDP1    P$,,AUTO
         0 000552   200020 236100                    LDQ     ERRCODE,,AUTO
         0 000553   000022 736000                    QLS     18
         0 000554   100001 552120                    STBQ    1,'20'O,PR1
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:46   

      290     6098    3               TL$=P$;

   6098  0 000555   200014 236100                    LDQ     P$,,AUTO
         0 000556   200016 756100                    STQ     TL$,,AUTO

      291     6099    3               IF DGRAN$~=ADDR(NIL) THEN

   6099  0 000557   200006 236100                    LDQ     DGRAN$,,AUTO
         0 000560   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000561   000567 600000 0                  TZE     s:6104

      292     6100    3                 KQ$DGRAN.USECNT=KQ$DGRAN.USECNT+1;

   6100  0 000562   200006 471500                    LDP1    DGRAN$,,AUTO
         0 000563   100013 054100                    AOS     11,,PR1

      293     6101    3             END;

   6101  0 000564   000567 710000 0                  TRA     s:6104

      294     6102    2           ELSE
      295     6103    2             T$=P$;

   6103  0 000565   200014 236100                    LDQ     P$,,AUTO
         0 000566   200013 756100                    STQ     T$,,AUTO

      296     6104    2           P$=P$->KQ$DFRBLK.LNK$;

   6104  0 000567   200014 470500                    LDP0    P$,,AUTO
         0 000570   000000 236100                    LDQ     0,,PR0
         0 000571   200014 756100                    STQ     P$,,AUTO

      297     6105    2         END;

   6105  0 000572   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000573   000510 601000 0                  TNZ     s:6085
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:47   

      298     6106    1       IF TL$~=ADDR(NIL) THEN

   6106  0 000574   200016 236100                    LDQ     TL$,,AUTO
         0 000575   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000576   000602 600000 0                  TZE     s:6109

      299     6107    1         TL$->KQ$DFRBLK.LNK$=ADDR(NIL);

   6107  0 000577   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000600   200016 470500                    LDP0    TL$,,AUTO
         0 000601   000000 756100                    STQ     0,,PR0

      300     6108        /**/
      301     6109    1       IF CODE=%KQDC_WRITE THEN

   6109  0 000602   200021 235100                    LDA     CODE,,AUTO
         0 000603   000006 115007                    CMPA    6,DL
         0 000604   000746 601000 0                  TNZ     PROCALL

      302     6110    2         DO;

      303     6111    2           IF KQ$DGRAN.HDR.FORCEOUT THEN

   6111  0 000605   200006 470500                    LDP0    DGRAN$,,AUTO
         0 000606   000001 236100                    LDQ     1,,PR0
         0 000607   000400 316003                    CANQ    256,DU
         0 000610   000677 600000 0                  TZE     s:6134

      304     6112    3             DO;

      305     6113    3               IF (KQ$DGRAN.HDR.CHAIN='0'B) THEN

   6113  0 000611   000020 316003                    CANQ    16,DU
         0 000612   000660 601000 0                  TNZ     s:6128

      306     6114    4                 DO;
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:48   

      307     6115    4                   KEYC = KQ$DGRAN.BTN.KEY;

   6115  0 000613   040100 100500                    MLR     fill='040'O
         0 000614   000011 000010                    ADSC9   9,,PR0                   cn=0,n=8
         0 000615   200011 000010                    ADSC9   KEY,,AUTO                cn=0,n=8

      308     6116    4                   P$ = ADDR(KQ$DGRAN.BTN);

   6116  0 000616   200006 236100                    LDQ     DGRAN$,,AUTO
         0 000617   000004 036003                    ADLQ    4,DU
         0 000620   200014 756100                    STQ     P$,,AUTO

      309     6117    4                   CALL KQB$INSERTNL(KQ$CG.DTREE,KEY,P$) ALTRET(INSERR);

   6117  0 000621   200014 631500                    EPPR1   P$,,AUTO
         0 000622   200034 451500                    STP1    LDGRAN$+6,,AUTO
         0 000623   200011 633500                    EPPR3   KEY,,AUTO
         0 000624   200033 453500                    STP3    LDGRAN$+5,,AUTO
         0 000625   200004 236100                    LDQ     CG$,,AUTO
         0 000626   000231 036003                    ADLQ    153,DU
         0 000627   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 000630   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 000631   000021 631400 xsym               EPPR1   B_VECTNIL+17
         0 000632   000000 701000 xent               TSX1    KQB$INSERTNL
         0 000633   001101 702000 0                  TSX2    INSERR

      310     6118    4                   KQ$DGRAN.HDR.CHAIN='1'B;

   6118  0 000634   200006 470500                    LDP0    DGRAN$,,AUTO
         0 000635   000020 236003                    LDQ     16,DU
         0 000636   000001 256100                    ORSQ    1,,PR0

      311     6119    4                   KQ$DGRAN.FLINK$=KQ$CG.AVAIL.HD$;

   6119  0 000637   200004 470500                    LDP0    CG$,,AUTO
         0 000640   000244 236100                    LDQ     164,,PR0
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:49   
         0 000641   200006 471500                    LDP1    DGRAN$,,AUTO
         0 000642   100017 756100                    STQ     15,,PR1

      312     6120    4                   KQ$DGRAN.BLINK$=ADDR(NIL);

   6120  0 000643   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000644   100016 756100                    STQ     14,,PR1

      313     6121    4                   KQ$CG.AVAIL.HD$=DGRAN$;

   6121  0 000645   200006 236100                    LDQ     DGRAN$,,AUTO
         0 000646   000244 756100                    STQ     164,,PR0

      314     6122    4                   IF KQ$CG.AVAIL.TL$=ADDR(NIL) THEN

   6122  0 000647   000245 236100                    LDQ     165,,PR0
         0 000650   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000651   000655 601000 0                  TNZ     s:6125

      315     6123    4                     KQ$CG.AVAIL.TL$=DGRAN$;

   6123  0 000652   200006 236100                    LDQ     DGRAN$,,AUTO
         0 000653   000245 756100                    STQ     165,,PR0
         0 000654   000660 710000 0                  TRA     s:6128

      316     6124    4                   ELSE
      317     6125    4                     KQ$DGRAN.FLINK$->KQ$DGRAN.BLINK$=DGRAN$;

   6125  0 000655   100017 473500                    LDP3    15,,PR1
         0 000656   200006 236100                    LDQ     DGRAN$,,AUTO
         0 000657   300016 756100                    STQ     14,,PR3

      318     6126    4                 END;

      319     6127
      320     6128    3               KQ$DGRAN.HDR.FORCEOUT='0'B;

PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:50   
   6128  0 000660   200006 470500                    LDP0    DGRAN$,,AUTO
         0 000661   000006 236000 1                  LDQ     6
         0 000662   000001 356100                    ANSQ    1,,PR0

      321     6129    3               CALL SSS$SYSTIME(KQ$DGRAN.TIME);

   6129  0 000663   200006 236100                    LDQ     DGRAN$,,AUTO
         0 000664   000024 036003                    ADLQ    20,DU
         0 000665   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 000666   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 000667   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000670   000000 701000 xent               TSX1    SSS$SYSTIME
         0 000671   000000 011000                    NOP     0

      322     6130    3               ALLOCFLG=1; /* Try to allocate space when done */

   6130  0 000672   000001 235007                    LDA     1,DL
         0 000673   200022 755100                    STA     ALLOCFLG,,AUTO

      323     6131    3               KQ$DGRAN.USECNT=KQ$DGRAN.USECNT+1;

   6131  0 000674   200006 470500                    LDP0    DGRAN$,,AUTO
         0 000675   000013 054100                    AOS     11,,PR0

      324     6132    3               GOTO PROCALL;

   6132  0 000676   000746 710000 0                  TRA     PROCALL

      325     6133    3             END;
      326     6134    2           IF HD$~=ADDR(NIL) THEN

   6134  0 000677   200015 236100                    LDQ     HD$,,AUTO
         0 000700   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000701   000723 600000 0                  TZE     s:6145

      327     6135    3             DO;

PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:51   
      328     6136    3               IF KQ$CG.NEEDPGTL$=ADDR(NIL) THEN

   6136  0 000702   200004 471500                    LDP1    CG$,,AUTO
         0 000703   100251 236100                    LDQ     169,,PR1
         0 000704   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000705   000711 601000 0                  TNZ     s:6139

      329     6137    3                 KQ$CG.NEEDPGHD$=HD$;

   6137  0 000706   200015 236100                    LDQ     HD$,,AUTO
         0 000707   100250 756100                    STQ     168,,PR1
         0 000710   000714 710000 0                  TRA     s:6140

      330     6138    3               ELSE
      331     6139    3                 KQ$CG.NEEDPGTL$->KQ$DFRBLK.LNK$=HD$;

   6139  0 000711   100251 473500                    LDP3    169,,PR1
         0 000712   200015 236100                    LDQ     HD$,,AUTO
         0 000713   300000 756100                    STQ     0,,PR3

      332     6140    3               KQ$CG.NEEDPGTL$=TL$;

   6140  0 000714   200016 236100                    LDQ     TL$,,AUTO
         0 000715   100251 756100                    STQ     169,,PR1

      333     6141    3               DELAYFLG=1;

   6141  0 000716   000001 235007                    LDA     1,DL
         0 000717   200023 755100                    STA     DELAYFLG,,AUTO

      334     6142    3               HD$=ADDR(NIL);

   6142  0 000720   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000721   200015 756100                    STQ     HD$,,AUTO

      335     6143    3               KQ$CG.NEEDPGCNT=KQ$CG.NEEDPGCNT+1;

PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:52   
   6143  0 000722   100252 054100                    AOS     170,,PR1

      336     6144    3             END;

      337     6145    2           IF DFR$~=ADDR(NIL) THEN

   6145  0 000723   200005 236100                    LDQ     DFR$,,AUTO
         0 000724   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000725   000745 600000 0                  TZE     s:6152

      338     6146    3             DO;

      339     6147    3               KQ$DGRAN.USECNT=KQ$DGRAN.USECNT-1;

   6147  0 000726   200006 470500                    LDP0    DGRAN$,,AUTO
         0 000727   000001 336007                    LCQ     1,DL
         0 000730   000013 056100                    ASQ     11,,PR0

      340     6148    3               LDFR$=DFR$;

   6148  0 000731   200005 236100                    LDQ     DFR$,,AUTO
         0 000732   200025 756100                    STQ     LDFR$,,AUTO

      341     6149    3               CALL KQD$RELDFR(KQ$CG,LDFR$);

   6149  0 000733   200025 631500                    EPPR1   LDFR$,,AUTO
         0 000734   200033 451500                    STP1    LDGRAN$+5,,AUTO
         0 000735   200004 236100                    LDQ     CG$,,AUTO
         0 000736   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 000737   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 000740   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000741   000000 701000 xent               TSX1    KQD$RELDFR
         0 000742   000000 011000                    NOP     0

      342     6150    3               DFR$=ADDR(NIL);

   6150  0 000743   000001 236000 xsym               LDQ     B_VECTNIL+1
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:53   
         0 000744   200005 756100                    STQ     DFR$,,AUTO

      343     6151    3             END;

      344     6152    2           GOTO WREND;

   6152  0 000745   001403 710000 0                  TRA     WREND

   6149  0 000746                       PROCALL      null
      345     6153    2         END;
      346     6154        /**/
      347     6155    1   PROCALL: ;
      348     6156    1       IF DFR$~=ADDR(NIL) THEN

   6156  0 000746   200005 236100                    LDQ     DFR$,,AUTO
         0 000747   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000750   000754 600000 0                  TZE     s:6160

      349     6157    1         CALL PROCESS; /* Process initial defer block */

   6157  0 000751   001104 701000 0                  TSX1    PROCESS
         0 000752   000000 011000                    NOP     0
         0 000753   000763 710000 0                  TRA     s:6163

      350     6158    1       ELSE
      351     6159              %UNLOCK (G=KQ$CG.DTREE.GATE);

   6160  0 000754   200004 236100                    LDQ     CG$,,AUTO
         0 000755   000231 036003                    ADLQ    153,DU
         0 000756   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 000757   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 000760   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000761   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000762   000000 011000                    NOP     0

      352     6162        /**/
      353     6163    2       DO WHILE(HD$~=ADDR(NIL));
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:54   

   6163  0 000763   001002 710000 0                  TRA     s:6170

      354     6164    2         DFR$=HD$;

   6164  0 000764   200015 236100                    LDQ     HD$,,AUTO
         0 000765   200005 756100                    STQ     DFR$,,AUTO

      355     6165    2         HD$=KQ$DFRBLK.LNK$;

   6165  0 000766   200005 470500                    LDP0    DFR$,,AUTO
         0 000767   000000 236100                    LDQ     0,,PR0
         0 000770   200015 756100                    STQ     HD$,,AUTO

      356     6166              %LOCK (G=KQ$CG.DTREE.GATE);

   6167  0 000771   200004 236100                    LDQ     CG$,,AUTO
         0 000772   000231 036003                    ADLQ    153,DU
         0 000773   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 000774   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 000775   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000776   000000 701000 xent               TSX1    HFC$LOCK
         0 000777   000000 011000                    NOP     0

      357     6169    2         CALL PROCESS;

   6169  0 001000   001104 701000 0                  TSX1    PROCESS
         0 001001   000000 011000                    NOP     0

      358     6170    2       END;

   6170  0 001002   200015 236100                    LDQ     HD$,,AUTO
         0 001003   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 001004   000764 601000 0                  TNZ     s:6164

      359     6171        /**/
      360     6172    1       IF ALLOCFLG~=0 THEN
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:55   

   6172  0 001005   200022 235100                    LDA     ALLOCFLG,,AUTO
         0 001006   001056 600000 0                  TZE     s:6191

      361     6173    2         DO;

      362     6174    2           IF KQ$CG.GETHD$~=ADDR(NIL) THEN

   6174  0 001007   200004 470500                    LDP0    CG$,,AUTO
         0 001010   000257 236100                    LDQ     175,,PR0
         0 001011   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 001012   001035 600000 0                  TZE     s:6183

      363     6175    3             DO;

      364     6176                    %LOCK (G=KQ$CG.DTREE.GATE);

   6177  0 001013   200004 236100                    LDQ     CG$,,AUTO
         0 001014   000231 036003                    ADLQ    153,DU
         0 001015   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 001016   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 001017   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 001020   000000 701000 xent               TSX1    HFC$LOCK
         0 001021   000000 011000                    NOP     0

      365     6179    3               LDGRAN$=DGRAN$;

   6179  0 001022   200006 236100                    LDQ     DGRAN$,,AUTO
         0 001023   200026 756100                    STQ     LDGRAN$,,AUTO

      366     6180    3               CALL KQD$GETPROCESS(KQ$CG,,LDGRAN$);

   6180  0 001024   200026 630500                    EPPR0   LDGRAN$,,AUTO
         0 001025   200034 450500                    STP0    LDGRAN$+6,,AUTO
         0 001026   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 001027   200004 235100                    LDA     CG$,,AUTO
         0 001030   200032 757100                    STAQ    LDGRAN$+4,,AUTO
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:56   
         0 001031   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 001032   000021 631400 xsym               EPPR1   B_VECTNIL+17
         0 001033   000000 701000 xent               TSX1    KQD$GETPROCESS
         0 001034   000000 011000                    NOP     0

      367     6181    3             END;

      368     6182                %LOCK (G=KQ$CG.DTREE.GATE);

   6183  0 001035   200004 236100                    LDQ     CG$,,AUTO
         0 001036   000231 036003                    ADLQ    153,DU
         0 001037   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 001040   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 001041   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 001042   000000 701000 xent               TSX1    HFC$LOCK
         0 001043   000000 011000                    NOP     0

      369     6185    2           KQ$DGRAN.USECNT=KQ$DGRAN.USECNT-1;

   6185  0 001044   200006 470500                    LDP0    DGRAN$,,AUTO
         0 001045   000001 336007                    LCQ     1,DL
         0 001046   000013 056100                    ASQ     11,,PR0

      370     6186                %UNLOCK (G=KQ$CG.DTREE.GATE);

   6187  0 001047   200004 236100                    LDQ     CG$,,AUTO
         0 001050   000231 036003                    ADLQ    153,DU
         0 001051   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 001052   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 001053   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 001054   000000 701000 xent               TSX1    HFC$UNLOCK
         0 001055   000000 011000                    NOP     0

      371     6189    2         END;

      372     6190        /**/
      373     6191    1       IF ENTFLG=0 THEN  /* If at base level, see if anything needs doing */
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:57   

   6191  0 001056   200024 235100                    LDA     ENTFLG,,AUTO
         0 001057   001100 601000 0                  TNZ     s:6199

      374     6192    2         DO;

      375     6193    2           IF KQ$CG.BASEDELAY~=0 THEN

   6193  0 001060   200004 470500                    LDP0    CG$,,AUTO
         0 001061   000025 235100                    LDA     21,,PR0
         0 001062   001066 600000 0                  TZE     s:6195

      376     6194    2             CALL KCC$BASE;

   6194  0 001063   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 001064   000000 701000 xent               TSX1    KCC$BASE
         0 001065   000000 011000                    NOP     0

      377     6195    2           IF KQ$CG.GARB.DELAY>0 AND KQ$CG.DFRFREEHD$~=ADDR(NIL) THEN

   6195  0 001066   200004 470500                    LDP0    CG$,,AUTO
         0 001067   000031 235100                    LDA     25,,PR0
         0 001070   001100 604400 0                  TMOZ    s:6199
         0 001071   000230 236100                    LDQ     152,,PR0
         0 001072   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 001073   001100 600000 0                  TZE     s:6199

      378     6196    2             CALL KQS$CLOCK(KQ$CG);

   6196  0 001074   200004 630500                    EPPR0   CG$,,AUTO
         0 001075   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 001076   000000 701000 xent               TSX1    KQS$CLOCK
         0 001077   000000 011000                    NOP     0

      379     6197    2         END;

      380     6198        /**/
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:58   
      381     6199    1       RETURN;

   6199  0 001100   000000 702200 xent               TSX2  ! X66_ARET

   6191  0 001101                       INSERR       null
      382     6200
      383     6201    1   INSERR: ;
      384     6202    1       CALL SC_CGKQE;

   6202  0 001101   000000 713400 xsym               CLIMB   SC_CGKQE
         0 001102   000000 600000 xsid               climb   nvectors=         0
         0 001103   001223 710000 0                  TRA     s:6244+2

      385     6203
      386     6204        %EJECT;
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:59   
      387     6205
      388     6206
      389     6207        /*D* NAME:         PROCESS
      390     6208
      391     6209             CALL:         CALL PROCESS;
      392     6210
      393     6211             INPUT:        DFR$ - Ptr to defer block to process
      394     6212                           ERRCODE - Error code to set in this block
      395     6213
      396     6214             DESCRIPTION:  The error code in this defer block is set
      397     6215                           to ERRCODE.  The appropriate handler is called
      398     6216                           depending on KQ$DFRBLK.CODE.
      399     6217
      400     6218        */
      401     6219
      402     6220
      403     6221    1   PROCESS: PROC;

   6221  0 001104   200030 741300       PROCESS      STX1  ! LDGRAN$+2,,AUTO

      404     6222
      405     6223    2       KQ$DFRBLK.ERRCODE=ERRCODE;

   6223  0 001105   200005 470500                    LDP0    DFR$,,AUTO
         0 001106   200020 236100                    LDQ     ERRCODE,,AUTO
         0 001107   000022 736000                    QLS     18
         0 001110   000001 552120                    STBQ    1,'20'O,PR0

      406     6224        /**/
      407     6225    2       LDFR$=DFR$; LDGRAN$=DGRAN$;

   6225  0 001111   200005 236100                    LDQ     DFR$,,AUTO
         0 001112   200025 756100                    STQ     LDFR$,,AUTO

   6225  0 001113   200006 236100                    LDQ     DGRAN$,,AUTO
         0 001114   200026 756100                    STQ     LDGRAN$,,AUTO

PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:60   
      408     6226    3       DO CASE(KQ$DFRBLK.CODE);

   6226  0 001115   200005 470500                    LDP0    DFR$,,AUTO
         0 001116   000001 236100                    LDQ     1,,PR0
         0 001117   000033 772000                    QRL     27
         0 001120   000013 116007                    CMPQ    11,DL
         0 001121   001123 602006 0                  TNC     s:6226+6,QL
         0 001122   001217 710000 0                  TRA     s:6241
         0 001123   001217 710000 0                  TRA     s:6241
         0 001124   001136 710000 0                  TRA     s:6228
         0 001125   001136 710000 0                  TRA     s:6228
         0 001126   001136 710000 0                  TRA     s:6228
         0 001127   001217 710000 0                  TRA     s:6241
         0 001130   001217 710000 0                  TRA     s:6241
         0 001131   001151 710000 0                  TRA     s:6230
         0 001132   001217 710000 0                  TRA     s:6241
         0 001133   001217 710000 0                  TRA     s:6241
         0 001134   001176 710000 0                  TRA     s:6237
         0 001135   001176 710000 0                  TRA     s:6237

      409     6227    3         CASE(%KQDC_FETCH,%KQDC_RENEGE,%KQDC_DEL);

      410     6228    3           CALL KQD$FETCHDONE(KQ$CG,LDFR$,LDGRAN$);

   6228  0 001136   200026 631500                    EPPR1   LDGRAN$,,AUTO
         0 001137   200034 451500                    STP1    LDGRAN$+6,,AUTO
         0 001140   200025 633500                    EPPR3   LDFR$,,AUTO
         0 001141   200033 453500                    STP3    LDGRAN$+5,,AUTO
         0 001142   200004 236100                    LDQ     CG$,,AUTO
         0 001143   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 001144   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 001145   000021 631400 xsym               EPPR1   B_VECTNIL+17
         0 001146   000000 701000 xent               TSX1    KQD$FETCHDONE
         0 001147   000000 011000                    NOP     0
         0 001150   001221 710000 0                  TRA     s:6244

      411     6229    3         CASE(%KQDC_WRITE);
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:61   

      412     6230    3           KQ$DGRAN.USECNT=KQ$DGRAN.USECNT-1;

   6230  0 001151   200006 471500                    LDP1    DGRAN$,,AUTO
         0 001152   000001 336007                    LCQ     1,DL
         0 001153   100013 056100                    ASQ     11,,PR1

      413     6231    3           CALL KQD$RELDFR(KQ$CG,LDFR$);

   6231  0 001154   200025 633500                    EPPR3   LDFR$,,AUTO
         0 001155   200033 453500                    STP3    LDGRAN$+5,,AUTO
         0 001156   200004 236100                    LDQ     CG$,,AUTO
         0 001157   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 001160   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 001161   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 001162   000000 701000 xent               TSX1    KQD$RELDFR
         0 001163   000000 011000                    NOP     0

      414     6232    3           DFR$=ADDR(NIL);

   6232  0 001164   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 001165   200005 756100                    STQ     DFR$,,AUTO

      415     6233                %UNLOCK (G=KQ$CG.DTREE.GATE);

   6234  0 001166   200004 236100                    LDQ     CG$,,AUTO
         0 001167   000231 036003                    ADLQ    153,DU
         0 001170   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 001171   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 001172   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 001173   000000 701000 xent               TSX1    HFC$UNLOCK
         0 001174   000000 011000                    NOP     0
         0 001175   001221 710000 0                  TRA     s:6244

      416     6236    3         CASE(%KQDC_GETFREE,%KQDC_GETNEW);

      417     6237    3           IF DGRAN$~=ADDR(NIL) THEN
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:62   

   6237  0 001176   200006 236100                    LDQ     DGRAN$,,AUTO
         0 001177   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 001200   001204 600000 0                  TZE     s:6239

      418     6238    3             KQ$DGRAN.USECNT=KQ$DGRAN.USECNT-1;

   6238  0 001201   200006 471500                    LDP1    DGRAN$,,AUTO
         0 001202   000001 336007                    LCQ     1,DL
         0 001203   100013 056100                    ASQ     11,,PR1

      419     6239    3           CALL KQD$GETPROCESS(KQ$CG,LDFR$,LDGRAN$);

   6239  0 001204   200026 631500                    EPPR1   LDGRAN$,,AUTO
         0 001205   200034 451500                    STP1    LDGRAN$+6,,AUTO
         0 001206   200025 633500                    EPPR3   LDFR$,,AUTO
         0 001207   200033 453500                    STP3    LDGRAN$+5,,AUTO
         0 001210   200004 236100                    LDQ     CG$,,AUTO
         0 001211   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 001212   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 001213   000021 631400 xsym               EPPR1   B_VECTNIL+17
         0 001214   000000 701000 xent               TSX1    KQD$GETPROCESS
         0 001215   000000 011000                    NOP     0
         0 001216   001221 710000 0                  TRA     s:6244

      420     6240    3         CASE(ELSE);

      421     6241    3           CALL SC_CGKQE;

   6241  0 001217   000000 713400 xsym               CLIMB   SC_CGKQE
         0 001220   000000 600000 xsid               climb   nvectors=         0

      422     6242    3       END;

      423     6243        /**/
      424     6244    2       RETURN;

PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:63   
   6244  0 001221   200030 221300                    LDX1  ! LDGRAN$+2,,AUTO
         0 001222   000001 702211                    TSX2  ! 1,X1
         0 001223   001226 710000 0                  TRA     s:6277

      425     6245    2   END PROCESS;
      426     6246
      427     6247        %EJECT;
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:64   
      428     6248
      429     6249
      430     6250        /*F* NAME:         KQE$WREA
      431     6251
      432     6252             PURPOSE:      Disk write end-action handler
      433     6253
      434     6254        */
      435     6255
      436     6256
      437     6257        /*D* NAME:         KQE$WREA
      438     6258
      439     6259             CALL:         Called from NIO$QUE at end-action
      440     6260
      441     6261             INPUT:        N$REQ - Queue packet
      442     6262                           N$REQ.EAINFOXP$ - Context block pointer
      443     6263                           N$REQ.EAINFOP$ - Granule pointer
      444     6264
      445     6265             DESCRIPTION:  For fetch, renege, and delete queues a read into
      446     6266                           the buffer.  For write, releases the page.  For
      447     6267                           newgran, calls the appropriate handler.
      448     6268
      449     6269        */
      450     6270
      451     6271
      452     6272        %EJECT;
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:65   
      453     6273
      454     6274
      455     6275    1   KQE$WREA: ENTRY(N$REQ);

   6275  0 001224   000000 700200 xent  KQE$WREA     TSX0  ! X66_AUTO_1
         0 001225   000042 000001                    ZERO    34,1

      456     6276
      457     6277    1       ALLOCFLG=0;

   6277  0 001226   200022 450100                    STZ     ALLOCFLG,,AUTO

      458     6278    1       DELAYFLG=0;

   6278  0 001227   200023 450100                    STZ     DELAYFLG,,AUTO

      459     6279    1       ENTFLG=0;  /* Called from IOQ */

   6279  0 001230   200024 450100                    STZ     ENTFLG,,AUTO

      460     6280    1       CG$=N$REQ.EAINFOXP$;

   6280  0 001231   200003 470500                    LDP0    @N$REQ,,AUTO
         0 001232   000025 236100                    LDQ     21,,PR0
         0 001233   200004 756100                    STQ     CG$,,AUTO

      461     6281            %LOCK (G=KQ$CG.GATE.CG);

   6282  0 001234   000107 036003                    ADLQ    71,DU
         0 001235   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 001236   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 001237   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 001240   000000 701000 xent               TSX1    HFC$LOCK
         0 001241   000000 011000                    NOP     0

      462     6284    1       KQ$CG.IOCNT=KQ$CG.IOCNT-1;

PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:66   
   6284  0 001242   200004 470500                    LDP0    CG$,,AUTO
         0 001243   000225 720100                    LXL0    149,,PR0
         0 001244   777777 621010                    EAX1    -1,X0
         0 001245   000225 441100                    SXL1    149,,PR0

      463     6285            %UNLOCK (G=KQ$CG.GATE.CG);

   6286  0 001246   200004 236100                    LDQ     CG$,,AUTO
         0 001247   000107 036003                    ADLQ    71,DU
         0 001250   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 001251   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 001252   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 001253   000000 701000 xent               TSX1    HFC$UNLOCK
         0 001254   000000 011000                    NOP     0

      464     6288    1       DGRAN$=N$REQ.EAINFOP$;

   6288  0 001255   200003 470500                    LDP0    @N$REQ,,AUTO
         0 001256   000024 236100                    LDQ     20,,PR0
         0 001257   200006 756100                    STQ     DGRAN$,,AUTO

      465     6289    1       CALL KQX$LDASR(KQ$CG);

   6289  0 001260   200004 630500                    EPPR0   CG$,,AUTO
         0 001261   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 001262   000000 701000 xent               TSX1    KQX$LDASR
         0 001263   000000 011000                    NOP     0

      466     6290        /**/
      467     6291    1       DA=ADDR(KQ$DGRAN.BTN.KEY)->WRD(0);

   6291  0 001264   200006 470500                    LDP0    DGRAN$,,AUTO
         0 001265   000011 235100                    LDA     9,,PR0
         0 001266   200007 755100                    STA     DA,,AUTO

      468     6292    1       DFR$=KQ$DGRAN.DFR$;

PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:67   
   6292  0 001267   000025 236100                    LDQ     21,,PR0
         0 001270   200005 756100                    STQ     DFR$,,AUTO

      469     6293    1       IF KQ_LOG.DCIO THEN

   6293  0 001271   000000 236000 xsym               LDQ     KQ_LOG
         0 001272   010000 316003                    CANQ    4096,DU
         0 001273   001314 600000 0                  TZE     s:6295

      470     6294    1         CALL KQZ$LOG(KQ$CG,%KQLOG_DCWREA,,,DFR$,DA,DGRAN$);

   6294  0 001274   200006 631500                    EPPR1   DGRAN$,,AUTO
         0 001275   200040 451500                    STP1    LDGRAN$+10,,AUTO
         0 001276   200007 633500                    EPPR3   DA,,AUTO
         0 001277   200037 453500                    STP3    LDGRAN$+9,,AUTO
         0 001300   200005 634500                    EPPR4   DFR$,,AUTO
         0 001301   200036 454500                    STP4    LDGRAN$+8,,AUTO
         0 001302   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 001303   000001 235000 xsym               LDA     B_VECTNIL+1
         0 001304   200034 757100                    STAQ    LDGRAN$+6,,AUTO
         0 001305   000013 236000 1                  LDQ     11
         0 001306   200004 235100                    LDA     CG$,,AUTO
         0 001307   200032 757100                    STAQ    LDGRAN$+4,,AUTO
         0 001310   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 001311   000025 631400 xsym               EPPR1   B_VECTNIL+21
         0 001312   000000 701000 xent               TSX1    KQZ$LOG
         0 001313   000000 011000                    NOP     0

      471     6295    1       KQ$DGRAN.ACTCNT=0;

   6295  0 001314   200006 470500                    LDP0    DGRAN$,,AUTO
         0 001315   000022 450100                    STZ     18,,PR0

      472     6296            %LOCK (G=KQ$CG.DTREE.GATE);

   6297  0 001316   200004 236100                    LDQ     CG$,,AUTO
         0 001317   000231 036003                    ADLQ    153,DU
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:68   
         0 001320   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 001321   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 001322   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 001323   000000 701000 xent               TSX1    HFC$LOCK
         0 001324   000000 011000                    NOP     0

      473     6299    1       KQ$DGRAN.USECNT=KQ$DGRAN.USECNT-1;

   6299  0 001325   200006 470500                    LDP0    DGRAN$,,AUTO
         0 001326   000001 336007                    LCQ     1,DL
         0 001327   000013 056100                    ASQ     11,,PR0

      474     6300    1       KQ$DGRAN.HDR.UPD='0'B;

   6300  0 001330   000010 236000 1                  LDQ     8
         0 001331   000001 356100                    ANSQ    1,,PR0

      475     6301    1       KQ$DGRAN.HDR.WRITE='0'B;

   6301  0 001332   200006 470500                    LDP0    DGRAN$,,AUTO
         0 001333   000005 236000 1                  LDQ     5
         0 001334   000001 356100                    ANSQ    1,,PR0

      476     6302        /**/
      477     6303    1       P$=KQ$CG.IOHD$;

   6303  0 001335   200004 470500                    LDP0    CG$,,AUTO
         0 001336   000246 236100                    LDQ     166,,PR0
         0 001337   200014 756100                    STQ     P$,,AUTO

      478     6304    2       DO WHILE(P$~=ADDR(NIL));

   6304  0 001340   001357 710000 0                  TRA     s:6308

      479     6305    2         IF DA=P$->KQ$DFRBLK.DA AND P$->KQ$DFRBLK.CODE~=%KQDC_WRITE THEN

   6305  0 001341   200014 470500                    LDP0    P$,,AUTO
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:69   
         0 001342   200007 236100                    LDQ     DA,,AUTO
         0 001343   000002 116100                    CMPQ    2,,PR0
         0 001344   001354 601000 0                  TNZ     s:6307
         0 001345   000001 236100                    LDQ     1,,PR0
         0 001346   777000 376003                    ANQ     -512,DU
         0 001347   006000 116003                    CMPQ    3072,DU
         0 001350   001354 600000 0                  TZE     s:6307

      480     6306    2           KQ$DGRAN.HDR.FORCEOUT = '0'B;

   6306  0 001351   200006 471500                    LDP1    DGRAN$,,AUTO
         0 001352   000006 236000 1                  LDQ     6
         0 001353   100001 356100                    ANSQ    1,,PR1

      481     6307    2         P$=P$->KQ$DFRBLK.LNK$;

   6307  0 001354   200014 470500                    LDP0    P$,,AUTO
         0 001355   000000 236100                    LDQ     0,,PR0
         0 001356   200014 756100                    STQ     P$,,AUTO

      482     6308    2       END;

   6308  0 001357   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 001360   001341 601000 0                  TNZ     s:6305

      483     6309        /**/
      484     6310    1       IF KQ$DGRAN.HDR.ADDFREE THEN

   6310  0 001361   200006 470500                    LDP0    DGRAN$,,AUTO
         0 001362   000001 236100                    LDQ     1,,PR0
         0 001363   000200 316003                    CANQ    128,DU
         0 001364   001373 600000 0                  TZE     s:6316

      485     6311    2         DO;

      486     6312    2           KQ$DGRAN.HDR.ADDFREE='0'B;

PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:70   
   6312  0 001365   000007 236000 1                  LDQ     7
         0 001366   000001 356100                    ANSQ    1,,PR0

      487     6313    2           KQ$CG.ADDFREE=KQ$CG.ADDFREE-1;

   6313  0 001367   200004 470500                    LDP0    CG$,,AUTO
         0 001370   000227 235100                    LDA     151,,PR0
         0 001371   000001 135007                    SBLA    1,DL
         0 001372   000227 755100                    STA     151,,PR0

      488     6314    2         END;

      489     6315        /**/
      490     6316    1       ERRCODE=0;

   6316  0 001373   200020 450100                    STZ     ERRCODE,,AUTO

      491     6317        /**/
      492     6318    1       IF DFR$~=ADDR(NIL) THEN

   6318  0 001374   200005 236100                    LDQ     DFR$,,AUTO
         0 001375   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 001376   001400 600000 0                  TZE     s:6322

      493     6319    2         DO;

      494     6320    2           GOTO FNDDFR;

   6320  0 001377   000415 710000 0                  TRA     FNDDFR

      495     6321    2         END;
      496     6322    1       CODE=%KQDC_WRITE;

   6322  0 001400   000006 235007                    LDA     6,DL
         0 001401   200021 755100                    STA     CODE,,AUTO

      497     6323    1       GOTO GOTDFRBLK2;
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:71   

   6323  0 001402   000473 710000 0                  TRA     GOTDFRBLK2

   6322  0 001403                       WREND        null
      498     6324        /**/
      499     6325    1   WREND: ;
      500     6326    1       IF KQ_LOG.DCIO THEN

   6326  0 001403   000000 236000 xsym               LDQ     KQ_LOG
         0 001404   010000 316003                    CANQ    4096,DU
         0 001405   001425 600000 0                  TZE     s:6330

      501     6327    1         CALL KQZ$LOG(KQ$CG,%KQLOG_DCREMP,,,,DA,DGRAN$);

   6327  0 001406   200006 630500                    EPPR0   DGRAN$,,AUTO
         0 001407   200040 450500                    STP0    LDGRAN$+10,,AUTO
         0 001410   200007 631500                    EPPR1   DA,,AUTO
         0 001411   200037 451500                    STP1    LDGRAN$+9,,AUTO
         0 001412   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 001413   200036 756100                    STQ     LDGRAN$+8,,AUTO
         0 001414   000001 235000 xsym               LDA     B_VECTNIL+1
         0 001415   200034 757100                    STAQ    LDGRAN$+6,,AUTO
         0 001416   000015 236000 1                  LDQ     13
         0 001417   200004 235100                    LDA     CG$,,AUTO
         0 001420   200032 757100                    STAQ    LDGRAN$+4,,AUTO
         0 001421   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 001422   000025 631400 xsym               EPPR1   B_VECTNIL+21
         0 001423   000000 701000 xent               TSX1    KQZ$LOG
         0 001424   000000 011000                    NOP     0

      502     6328        /**/
      503     6329            %UNLOCK (G=KQ$CG.DTREE.GATE);

   6330  0 001425   200004 236100                    LDQ     CG$,,AUTO
         0 001426   000231 036003                    ADLQ    153,DU
         0 001427   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 001430   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:72   
         0 001431   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 001432   000000 701000 xent               TSX1    HFC$UNLOCK
         0 001433   000000 011000                    NOP     0

      504     6332        /**/
      505     6333    1       IF DELAYFLG~=0 THEN

   6333  0 001434   200023 235100                    LDA     DELAYFLG,,AUTO
         0 001435   001462 600000 0                  TZE     s:6345

      506     6334    2         DO;

      507     6335                %LOCK (G=KQ$CG.GATE.CG);

   6336  0 001436   200004 236100                    LDQ     CG$,,AUTO
         0 001437   000107 036003                    ADLQ    71,DU
         0 001440   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 001441   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 001442   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 001443   000000 701000 xent               TSX1    HFC$LOCK
         0 001444   000000 011000                    NOP     0

      508     6338    2           IF KQ$CG.NEEDPGHD$~=ADDR(NIL) THEN

   6338  0 001445   200004 470500                    LDP0    CG$,,AUTO
         0 001446   000250 236100                    LDQ     168,,PR0
         0 001447   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 001450   001453 600000 0                  TZE     s:6341

      509     6339    2             KQ$CG.DELAY.NEEDPG='1'B;

   6339  0 001451   040000 236003                    LDQ     16384,DU
         0 001452   000020 256100                    ORSQ    16,,PR0

      510     6340                %UNLOCK (G=KQ$CG.GATE.CG);

   6341  0 001453   200004 236100                    LDQ     CG$,,AUTO
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:73   
         0 001454   000107 036003                    ADLQ    71,DU
         0 001455   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 001456   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 001457   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 001460   000000 701000 xent               TSX1    HFC$UNLOCK
         0 001461   000000 011000                    NOP     0

      511     6343    2         END;

      512     6344        /**/
      513     6345    1       LDGRAN$=DGRAN$;

   6345  0 001462   200006 236100                    LDQ     DGRAN$,,AUTO
         0 001463   200026 756100                    STQ     LDGRAN$,,AUTO

      514     6346    1       CALL KQD$RELP(KQ$CG,LDGRAN$);

   6346  0 001464   200026 630500                    EPPR0   LDGRAN$,,AUTO
         0 001465   200033 450500                    STP0    LDGRAN$+5,,AUTO
         0 001466   200004 236100                    LDQ     CG$,,AUTO
         0 001467   200032 756100                    STQ     LDGRAN$+4,,AUTO
         0 001470   200032 630500                    EPPR0   LDGRAN$+4,,AUTO
         0 001471   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 001472   000000 701000 xent               TSX1    KQD$RELP
         0 001473   000000 011000                    NOP     0

      515     6347        /**/
      516     6348    1       IF KQ$CG.GETFLG=%GFLG_INIT THEN

   6348  0 001474   200004 470500                    LDP0    CG$,,AUTO
         0 001475   000226 236100                    LDQ     150,,PR0
         0 001476   777000 376003                    ANQ     -512,DU
         0 001477   001000 116003                    CMPQ    512,DU
         0 001500   001505 601000 0                  TNZ     s:6351

      517     6349    1         CALL KQD$GETINIT(KQ$CG);

PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:74   
   6349  0 001501   200004 630500                    EPPR0   CG$,,AUTO
         0 001502   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 001503   000000 701000 xent               TSX1    KQD$GETINIT
         0 001504   000000 011000                    NOP     0

      518     6350        /**/
      519     6351    1       IF KQ$CG.BASEDELAY~=0 THEN

   6351  0 001505   200004 470500                    LDP0    CG$,,AUTO
         0 001506   000025 235100                    LDA     21,,PR0
         0 001507   001513 600000 0                  TZE     s:6354

      520     6352    1         CALL KCC$BASE; /* Do any necessary base-level work */

   6352  0 001510   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 001511   000000 701000 xent               TSX1    KCC$BASE
         0 001512   000000 011000                    NOP     0

      521     6353        /**/
      522     6354    1       IF KQ$CG.GARB.DELAY>0 AND KQ$CG.DFRFREEHD$~=ADDR(NIL) THEN

   6354  0 001513   200004 470500                    LDP0    CG$,,AUTO
         0 001514   000031 235100                    LDA     25,,PR0
         0 001515   001525 604400 0                  TMOZ    s:6357
         0 001516   000230 236100                    LDQ     152,,PR0
         0 001517   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 001520   001525 600000 0                  TZE     s:6357

      523     6355    1         CALL KQS$CLOCK(KQ$CG);

   6355  0 001521   200004 630500                    EPPR0   CG$,,AUTO
         0 001522   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 001523   000000 701000 xent               TSX1    KQS$CLOCK
         0 001524   000000 011000                    NOP     0

      524     6356        /**/
      525     6357    1       RETURN;
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:75   

   6357  0 001525   000000 702200 xent               TSX2  ! X66_ARET

   6354  0 001526                       ERR          null
      526     6358        /**/
      527     6359    1   ERR: ;
      528     6360    1       CALL SC_CGKQE;

   6360  0 001526   000000 713400 xsym               CLIMB   SC_CGKQE
         0 001527   000000 600000 xsid               climb   nvectors=         0

      529     6361    1       GOTO ERR;

   6361  0 001530   001526 710000 0                  TRA     ERR

(unnamed)
 Sect OctLoc
   1     000   000000 000051   000000 006000   000000 006000   777770 777777    ...)............
   1     004   777777 437777   777677 777777   777377 777777   777577 777777    ................
   1     010   777767 777777   777737 777777   000000 000052   000012 006000    ...........*....
   1     014   000000 000016   000014 006000                                    ........
      530     6362
      531     6363    1   END KQE$RDEA;

PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:76   
--  Include file information  --

   N_FC_C.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   KQ_SUBS_C.:E05TOU  is referenced.
   KQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KQ_MAC_C.:E05TOU  is referenced.
   KC_CP6.:E05TOU  is referenced.
   KC$CP6V_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   EL$TABLES.:E05TOU  is referenced.
      No diagnostics issued in procedure KQE$RDEA.
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:77   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @N$REQ                    22-0-0/w UBIN        r     1 ALLOCFLG
     4-0-0/w PTR         r     1 CG$                       21-0-0/w UBIN        r     1 CODE
     7-0-0/w UBIN        r     1 DA                        23-0-0/w UBIN        r     1 DELAYFLG
     5-0-0/w PTR         r     1 DFR$                       6-0-0/w PTR         r     1 DGRAN$
    24-0-0/w UBIN        r     1 ENTFLG                    20-0-0/w UBIN        r     1 ERRCODE
    15-0-0/w PTR         r     1 HD$                       11-0-0/w STRC(72)    r     1 KEY
    11-0-0/w CHAR(8)     r     1 KEYC                      25-0-0/w PTR         r     1 LDFR$
    26-0-0/w PTR         r     1 LDGRAN$                   *0-0-0/d STRC(1080)  r     1 N$REQ
    14-0-0/w PTR         r     1 P$                        10-0-0/b STRC        r     1 STAMP
    13-0-0/w PTR         r     1 T$                        16-0-0/w PTR         r     1 TL$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1692)  r     1 KQ_ERRLOG_BFR              0-0-0/b BIT (72)    r     1 KQ_ERRLOG_GATE
     0-0-0/b STRC        r     1 KQ_LOG

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(6516)  r     1 KQ$CG                      0-0-0/d STRC(288)   r     1 KQ$DFRBLK
     0-0-0/d STRC(1152)  r     1 KQ$DGRAN                   0-0-0/w UBIN        r     1 WRD(0:1023)


   Procedure KQE$RDEA requires 857 words for executable code.
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:78   
   Procedure KQE$RDEA requires 34 words of local(AUTO) storage.

    No errors detected in file KQE$EA.:E05TSI    .
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:79   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:80   
          MINI XREF LISTING

ALLOCFLG
      5861**DCL      5947<<ASSIGN   6020<<ASSIGN   6130<<ASSIGN   6172>>IF       6277<<ASSIGN
CG$
      5843**DCL      4916--IMP-PTR  5950<<ASSIGN   5951>>CALL     5953>>CALL     5955>>ASSIGN   5955>>ASSIGN
      5957>>CALL     5962>>CALL     5967>>ASSIGN   5982>>CALL     5995>>CALL     5997>>CALL     6000>>IF
      6002>>ASSIGN   6007>>ASSIGN   6009>>ASSIGN   6010>>IF       6011>>ASSIGN   6018>>IF       6030>>CALL
      6032>>IF       6033>>ASSIGN   6040>>CALL     6043>>CALL     6045>>CALL     6052>>ASSIGN   6058>>ASSIGN
      6061>>IF       6062>>ASSIGN   6082>>ASSIGN   6088>>ASSIGN   6091>>IF       6092>>ASSIGN   6117>>CALL
      6119>>ASSIGN   6121>>ASSIGN   6122>>IF       6123>>ASSIGN   6136>>IF       6137>>ASSIGN   6139>>ASSIGN
      6140>>ASSIGN   6143>>ASSIGN   6143>>ASSIGN   6149>>CALL     6160>>CALL     6167>>CALL     6174>>IF
      6177>>CALL     6180>>CALL     6183>>CALL     6187>>CALL     6193>>IF       6195>>IF       6195>>IF
      6196>>CALL     6228>>CALL     6231>>CALL     6234>>CALL     6239>>CALL     6280<<ASSIGN   6282>>CALL
      6284>>ASSIGN   6284>>ASSIGN   6286>>CALL     6289>>CALL     6294>>CALL     6297>>CALL     6303>>ASSIGN
      6313>>ASSIGN   6313>>ASSIGN   6327>>CALL     6330>>CALL     6336>>CALL     6338>>IF       6339>>ASSIGN
      6341>>CALL     6346>>CALL     6348>>IF       6349>>CALL     6351>>IF       6354>>IF       6354>>IF
      6355>>CALL
CODE
      5860**DCL      6075<<ASSIGN   6083>>IF       6109>>IF       6322<<ASSIGN
COMMON
      5943**LABEL    5938--GOTO
DA
      5846**DCL      5960<<ASSIGN   5962<>CALL     5966>>ASSIGN   5968>>ASSIGN   6000>>IF       6032>>IF
      6083>>IF       6085>>IF       6291<<ASSIGN   6294<>CALL     6305>>IF       6327<>CALL
DELAYFLG
      5862**DCL      5948<<ASSIGN   6141<<ASSIGN   6278<<ASSIGN   6333>>IF
DFR$
      5844**DCL      5653--IMP-PTR  5949<<ASSIGN   5959>>ASSIGN   5960>>ASSIGN   5962<>CALL     5973>>ASSIGN
      6017>>ASSIGN   6026>>IF       6027>>ASSIGN   6036>>ASSIGN   6048>>ASSIGN   6055>>IF       6058>>ASSIGN
      6060>>ASSIGN   6061>>IF       6075>>ASSIGN   6145>>IF       6148>>ASSIGN   6150<<ASSIGN   6156>>IF
      6164<<ASSIGN   6165>>ASSIGN   6223>>ASSIGN   6225>>ASSIGN   6226>>DOCASE   6232<<ASSIGN   6292<<ASSIGN
      6294<>CALL     6318>>IF
DGRAN$
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:81   
      5845**DCL      5703--IMP-PTR  5959<<ASSIGN   5962<>CALL     5970>>IF       5970>>IF       5980>>ASSIGN
      5983>>ASSIGN   5984>>ASSIGN   5985>>ASSIGN   5985>>ASSIGN   5988>>ASSIGN   5988>>ASSIGN   5989>>ASSIGN
      5990>>ASSIGN   5991>>ASSIGN   5992>>CALL     5993>>ASSIGN   5998>>ASSIGN   5999>>ASSIGN   6002>>ASSIGN
      6003>>ASSIGN   6004>>ASSIGN   6007>>ASSIGN   6008>>ASSIGN   6009>>ASSIGN   6011>>ASSIGN   6013>>ASSIGN
      6013>>ASSIGN   6014>>ASSIGN   6015>>ASSIGN   6016>>ASSIGN   6021>>ASSIGN   6037>>IF       6042>>ASSIGN
      6047<<ASSIGN   6076>>IF       6077>>ASSIGN   6077>>ASSIGN   6099>>IF       6100>>ASSIGN   6100>>ASSIGN
      6111>>IF       6113>>IF       6115>>ASSIGN   6116>>ASSIGN   6118>>ASSIGN   6119>>ASSIGN   6120>>ASSIGN
      6121>>ASSIGN   6123>>ASSIGN   6125>>ASSIGN   6125>>ASSIGN   6128>>ASSIGN   6129>>CALL     6131>>ASSIGN
      6131>>ASSIGN   6147>>ASSIGN   6147>>ASSIGN   6179>>ASSIGN   6185>>ASSIGN   6185>>ASSIGN   6225>>ASSIGN
      6230>>ASSIGN   6230>>ASSIGN   6237>>IF       6238>>ASSIGN   6238>>ASSIGN   6288<<ASSIGN   6291>>ASSIGN
      6292>>ASSIGN   6294<>CALL     6295>>ASSIGN   6299>>ASSIGN   6299>>ASSIGN   6300>>ASSIGN   6301>>ASSIGN
      6306>>ASSIGN   6310>>IF       6312>>ASSIGN   6327<>CALL     6345>>ASSIGN
ENTFLG
      5863**DCL      5937<<ASSIGN   5943<<ASSIGN   6191>>IF       6279<<ASSIGN
ERR
      6354**LABEL    6361--GOTO
ERRCODE
      5859**DCL      6036<<ASSIGN   6037>>IF       6097>>ASSIGN   6223>>ASSIGN   6316<<ASSIGN
FNDDFR
      6047**LABEL    6320--GOTO
GOTDFRBLK
      6062**LABEL    6063--GOTO
GOTDFRBLK2
      6076**LABEL    6323--GOTO
HD$
      5856**DCL      6079<<ASSIGN   6094<<ASSIGN   6134>>IF       6137>>ASSIGN   6139>>ASSIGN   6142<<ASSIGN
      6163>>DOWHILE  6164>>ASSIGN   6165<<ASSIGN
HFC$LOCK
       359**DCL-ENT  5953--CALL     5975--CALL     5995--CALL     6030--CALL     6045--CALL     6167--CALL
      6177--CALL     6183--CALL     6282--CALL     6297--CALL     6336--CALL
HFC$UNLOCK
       359**DCL-ENT  5957--CALL     6040--CALL     6160--CALL     6187--CALL     6234--CALL     6286--CALL
      6330--CALL     6341--CALL
INSERR
      6191**LABEL    5997--CALLALT  6117--CALLALT
KCC$BASE
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:82   
      5882**DCL-ENT  6194--CALL     6352--CALL
KEY
      5850**DCL      5853--REDEF    5997<>CALL     6117<>CALL
KEY.DA
      5851**DCL      5968<<ASSIGN
KEY.GARB
      5852**DCL      5969<<ASSIGN
KEYC
      5853**DCL      5970>>IF       6115<<ASSIGN
KQ$CG
      4916**DCL      5951<>CALL     5962<>CALL     5982<>CALL     6043<>CALL     6149<>CALL     6180<>CALL
      6196<>CALL     6228<>CALL     6231<>CALL     6239<>CALL     6289<>CALL     6294<>CALL     6327<>CALL
      6346<>CALL     6349<>CALL     6355<>CALL
KQ$CG.ADDFREE
      5477**DCL      6313<<ASSIGN   6313>>ASSIGN
KQ$CG.AUCTL.DVBYTE.REREAD
      5359**DCL      5360--REDEF
KQ$CG.AVAIL.HD$
      5547**DCL      6007>>ASSIGN   6009<<ASSIGN   6119>>ASSIGN   6121<<ASSIGN
KQ$CG.AVAIL.TL$
      5549**DCL      6010>>IF       6011<<ASSIGN   6122>>IF       6123<<ASSIGN
KQ$CG.BASEDELAY
      5026**DCL      6193>>IF       6351>>IF
KQ$CG.DELAY.NEEDPG
      4990**DCL      6339<<ASSIGN
KQ$CG.DFRFREEHD$
      5481**DCL      6195>>IF       6354>>IF
KQ$CG.DTREE
      5499**DCL      5997<>CALL     6117<>CALL
KQ$CG.DTREE.GATE
      5501**DCL      5995<>CALL     6030<>CALL     6040<>CALL     6045<>CALL     6160<>CALL     6167<>CALL
      6177<>CALL     6183<>CALL     6187<>CALL     6234<>CALL     6297<>CALL     6330<>CALL
KQ$CG.FREEDA
      5473**DCL      6000>>IF       6002<<ASSIGN   6032>>IF       6033<<ASSIGN
KQ$CG.GARB.DELAY
      5051**DCL      6195>>IF       6354>>IF
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:83   
KQ$CG.GATE.CG
      5306**DCL      5953<>CALL     5957<>CALL     6282<>CALL     6286<>CALL     6336<>CALL     6341<>CALL
KQ$CG.GETFLG
      5471**DCL      6348>>IF
KQ$CG.GETHD$
      5626**DCL      6018>>IF       6174>>IF
KQ$CG.GRAN.STAMP.HASH
      5590**DCL      5967>>ASSIGN
KQ$CG.IOCNT
      5468**DCL      5955<<ASSIGN   5955>>ASSIGN   6284<<ASSIGN   6284>>ASSIGN
KQ$CG.IOHD$
      5551**DCL      6052>>ASSIGN   6058<<ASSIGN   6082>>ASSIGN   6088<<ASSIGN   6303>>ASSIGN
KQ$CG.IOTL$
      5554**DCL      6061>>IF       6062<<ASSIGN   6091>>IF       6092<<ASSIGN
KQ$CG.NEEDPGCNT
      5567**DCL      6143<<ASSIGN   6143>>ASSIGN
KQ$CG.NEEDPGHD$
      5556**DCL      6137<<ASSIGN   6338>>IF
KQ$CG.NEEDPGTL$
      5565**DCL      6136>>IF       6139>>ASSIGN   6140<<ASSIGN
KQ$DFRBLK.CODE
      5656**DCL      6075>>ASSIGN   6085>>IF       6226>>DOCASE   6305>>IF
KQ$DFRBLK.DA
      5673**DCL      5960>>ASSIGN   6085>>IF       6305>>IF
KQ$DFRBLK.DBLK$
      5675**DCL      5677--REDEF
KQ$DFRBLK.DGRAN$
      5687**DCL      5959>>ASSIGN   6048<<ASSIGN
KQ$DFRBLK.ERRCODE
      5658**DCL      5973<<ASSIGN   6017<<ASSIGN   6026>>IF       6027<<ASSIGN   6036>>ASSIGN   6097<<ASSIGN
      6223<<ASSIGN
KQ$DFRBLK.INFO
      5683**DCL      5685--REDEF
KQ$DFRBLK.LNK$
      5654**DCL      6058>>ASSIGN   6060<<ASSIGN   6060>>ASSIGN   6066>>ASSIGN   6088>>ASSIGN   6090<<ASSIGN
      6090>>ASSIGN   6096<<ASSIGN   6104>>ASSIGN   6107<<ASSIGN   6139<<ASSIGN   6165>>ASSIGN   6307>>ASSIGN
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:84   
KQ$DGRAN
      5703**DCL      5980<<ASSIGN   5980>>ASSIGN   5981--ASSIGN
KQ$DGRAN.ACTCNT
      5814**DCL      6016<<ASSIGN   6295<<ASSIGN
KQ$DGRAN.BLINK$
      5801**DCL      6008<<ASSIGN   6013<<ASSIGN   6120<<ASSIGN   6125<<ASSIGN
KQ$DGRAN.BTN
      5776**DCL      5993--ASSIGN   6116--ASSIGN
KQ$DGRAN.BTN.KEY
      5789**DCL      5970>>IF       6115>>ASSIGN   6291--ASSIGN
KQ$DGRAN.BYPASSCNT
      5805**DCL      6014<<ASSIGN
KQ$DGRAN.DFR$
      5823**DCL      6292>>ASSIGN
KQ$DGRAN.FLINK$
      5803**DCL      6007<<ASSIGN   6013>>ASSIGN   6119<<ASSIGN   6125>>ASSIGN
KQ$DGRAN.FREEFLINK
      5816**DCL      6002>>ASSIGN
KQ$DGRAN.HDR.ADDFREE
      5732**DCL      5991<<ASSIGN   6310>>IF       6312<<ASSIGN
KQ$DGRAN.HDR.CHAIN
      5738**DCL      5998<<ASSIGN   6113>>IF       6118<<ASSIGN
KQ$DGRAN.HDR.EMPTYLIST
      5736**DCL      6003<<ASSIGN
KQ$DGRAN.HDR.FORCEOUT
      5730**DCL      5990<<ASSIGN   6111>>IF       6128<<ASSIGN   6306<<ASSIGN
KQ$DGRAN.HDR.GTYP
      5747**DCL      5984<<ASSIGN
KQ$DGRAN.HDR.PTYP
      5742**DCL      5983<<ASSIGN
KQ$DGRAN.HDR.SELF$
      5754**DCL      5985<<ASSIGN   5988<<ASSIGN
KQ$DGRAN.HDR.STAMP
      5722**DCL      5970>>IF
KQ$DGRAN.HDR.UPD
      5740**DCL      5999<<ASSIGN   6004<<ASSIGN   6300<<ASSIGN
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:85   
KQ$DGRAN.HDR.WRITE
      5734**DCL      5989<<ASSIGN   6301<<ASSIGN
KQ$DGRAN.TIME
      5818**DCL      5992<>CALL     6129<>CALL
KQ$DGRAN.USECNT
      5793**DCL      6015<<ASSIGN   6021<<ASSIGN   6077<<ASSIGN   6077>>ASSIGN   6100<<ASSIGN   6100>>ASSIGN
      6131<<ASSIGN   6131>>ASSIGN   6147<<ASSIGN   6147>>ASSIGN   6185<<ASSIGN   6185>>ASSIGN   6230<<ASSIGN
      6230>>ASSIGN   6238<<ASSIGN   6238>>ASSIGN   6299<<ASSIGN   6299>>ASSIGN
KQB$INSERTNL
      5884**DCL-ENT  5997--CALL     6117--CALL
KQD$ERRLOG
      5885**DCL-ENT  5982--CALL
KQD$FETCHDONE
      5886**DCL-ENT  6228--CALL
KQD$GETINIT
      5887**DCL-ENT  6349--CALL
KQD$GETPROCESS
      5888**DCL-ENT  6180--CALL     6239--CALL
KQD$RELDFR
      5889**DCL-ENT  6149--CALL     6231--CALL
KQD$RELP
      5890**DCL-ENT  6043--CALL     6346--CALL
KQS$CLOCK
      5891**DCL-ENT  6196--CALL     6355--CALL
KQX$LDASR
      5892**DCL-ENT  5951--CALL     6289--CALL
KQZ$LOG
      5893**DCL-ENT  5962--CALL     6294--CALL     6327--CALL
KQ_ERRLOG_BFR
      5872**DCL      5977<<ASSIGN
KQ_ERRLOG_BFR.CODE
      5872**DCL      5978<<ASSIGN
KQ_ERRLOG_BFR.INFO
      5873**DCL      5979<<ASSIGN   5980--ASSIGN
KQ_ERRLOG_BFR.SIZ
      5873**DCL      5981<<ASSIGN
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:86   
KQ_ERRLOG_GATE
      3632**DCL      5975<>CALL
KQ_IMBLK.DVE.EOMCHAR
      4264**DCL      4266--REDEF
KQ_IMBLK.KEY1
      4190**DCL      4192--REDEF
KQ_IMBLK.KEY2
      4199**DCL      4217--REDEF
KQ_IMBLK.LNK$
      4164**DCL      4166--REDEF    4172--REDEF    4176--REDEF
KQ_IMBLK.TYC
      4313**DCL      4315--REDEF
KQ_IMBLK.XSP.MREQ$
      4219**DCL      4223--REDEF
KQ_IRBLK.BUF$
      3768**DCL      3770--REDEF
KQ_IRBLK.CNACTD
      3682**DCL      3691--REDEF
KQ_IRBLK.DBLKX
      3788**DCL      3792--REDEF
KQ_IRBLK.EOFNONE
      3660**DCL      3663--REDEF
KQ_IRBLK.FROMQ
      3666**DCL      3669--REDEF
KQ_IRBLK.KEY1R
      3707**DCL      3708--REDEF
KQ_IRBLK.KEY2R
      3712**DCL      3713--REDEF
KQ_IRBLK.LATCH
      3655**DCL      3657--REDEF
KQ_IRBLK.LWRITES$
      3799**DCL      3803--REDEF
KQ_IRBLKT.CNACTD
      3868**DCL      3877--REDEF
KQ_IRBLKT.DBLK$
      3931**DCL      3935--REDEF    3938--REDEF
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:87   
KQ_IRBLKT.EOFNONE
      3846**DCL      3849--REDEF
KQ_IRBLKT.FROMQ
      3852**DCL      3855--REDEF
KQ_IRBLKT.KEY1R
      3893**DCL      3894--REDEF
KQ_IRBLKT.KEY2R
      3898**DCL      3899--REDEF
KQ_IRBLKT.LATCH
      3841**DCL      3843--REDEF
KQ_LOG.DCIO
      3621**DCL      5961>>IF       6293>>IF       6326>>IF
LDFR$
      5864**DCL      6148<<ASSIGN   6149<>CALL     6225<<ASSIGN   6228<>CALL     6231<>CALL     6239<>CALL
LDGRAN$
      5865**DCL      6042<<ASSIGN   6043<>CALL     6179<<ASSIGN   6180<>CALL     6225<<ASSIGN   6228<>CALL
      6239<>CALL     6345<<ASSIGN   6346<>CALL
N$REQ
      4847**DCL        17--PROC     5941--ENTRY    6275--ENTRY
N$REQ.BUFADDR
      4856**DCL      4857--REDEF    4857--REDEF
N$REQ.DLA.DRELADDR
      4848**DCL      4848--REDEF
N$REQ.DVE.EOMCHAR
      4885**DCL      4886--REDEF
N$REQ.EAINFO
      4879**DCL      4879--REDEF
N$REQ.EAINFOP$
      4879**DCL      5949>>ASSIGN   6288>>ASSIGN
N$REQ.EAINFOX
      4879**DCL      4880--REDEF
N$REQ.EAINFOXP$
      4880**DCL      5950>>ASSIGN   6280>>ASSIGN
N$REQ.EVNTINFO
      4880**DCL      4880--REDEF
N$REQ.STATUS
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:88   
      4861**DCL      4867--REDEF
N$REQ.TYC
      4869**DCL      5964>>IF
P$
      5855**DCL      5993<<ASSIGN   5997<>CALL     6052<<ASSIGN   6054>>DOWHILE  6055>>IF       6065>>ASSIGN
      6066<<ASSIGN   6066>>ASSIGN   6082<<ASSIGN   6084>>DOWHILE  6085>>IF       6085>>IF       6088>>ASSIGN
      6090>>ASSIGN   6091>>IF       6094>>ASSIGN   6096>>ASSIGN   6097>>ASSIGN   6098>>ASSIGN   6103>>ASSIGN
      6104<<ASSIGN   6104>>ASSIGN   6116<<ASSIGN   6117<>CALL     6303<<ASSIGN   6304>>DOWHILE  6305>>IF
      6305>>IF       6307<<ASSIGN   6307>>ASSIGN
PROCALL
      6149**LABEL    6132--GOTO
PROCESS
      6221**PROC     6157--CALL     6169--CALL
SC_CGCACHE
      5896**DCL-ENT  5972--CALL
SC_CGKQE
      5897**DCL-ENT  6068--CALL     6202--CALL     6241--CALL     6360--CALL
SETERR
      6026**LABEL    5986--GOTO
SSS$CCAC
      5894**DCL-ENT  5946--CALL
SSS$SYSTIME
      5895**DCL-ENT  5992--CALL     6129--CALL
STAMP
      5847**DCL      5970>>IF       5979>>ASSIGN
STAMP.GMOD
      5849**DCL      5966<<ASSIGN
STAMP.HASH
      5848**DCL      5967<<ASSIGN
T$
      5854**DCL      6053<<ASSIGN   6057>>IF       6060>>ASSIGN   6062>>ASSIGN   6065<<ASSIGN   6081<<ASSIGN
      6087>>IF       6090>>ASSIGN   6092>>ASSIGN   6103<<ASSIGN
TL$
      5857**DCL      6080<<ASSIGN   6093>>IF       6096>>ASSIGN   6098<<ASSIGN   6106>>IF       6107>>ASSIGN
      6140>>ASSIGN
WRD
PL6.E3A0      #001=KQE$RDEA File=KQE$EA.:E05TSI                                  WED 07/30/97 01:25 Page:89   
      5837**DCL      6291>>ASSIGN
WREND
      6322**LABEL    6152--GOTO
