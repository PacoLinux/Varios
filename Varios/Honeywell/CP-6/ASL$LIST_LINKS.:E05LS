VERSION E05

PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:1    
        1        1        /*M* ASL$LIST_ALL_LINKS:  routine to handle LIST LINK cmd. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9
       10       10        ASL$LIST_ALL_LINKS: PROC;
       11       11        /**********************************************************/
       12       12
       13       13        /*D* NAME:     ASL$LIST_ALL_LINKS
       14       14             CALL:     CALL ASL$LIST_ALL_LINKS
       15       15             INPUT:    Nothing is passed.
       16       16             OUTPUT:   Nothing is returned.
       17       17             DESCRIPTION:  ASL$LIST_ALL_LINKS is a subroutine to handle
       18       18                           the LIST LINK command for SUPER.
       19       19                           Link records are stored in the :HLP.:SYS
       20       20                           file and have keys that look like the following:
       21       21                           'xxxxxxxx*' where the x signifies
       22       22                           a character from the alphanumeric character
       23       23                           set plus the special characters ':$*' and
       24       24                           is of length 8 or less.
       25       25                           If the actual link name is less than 8
       26       26                           characters, the key will be blank padded to
       27       27                           8 characters.
       28       28                           The key is not a unique identifier for links
       29       29                           though.  Other types of objects known to
       30       30                           SUPER have the same type of key structure.
       31       31                           The unique identifier for these objects is
       32       32                           the first byte of the actual record, which
       33       33                           contains a value specified by the KLAT_?
       34       34                           EQU's found in KL_SUPER_C.  For links the
       35       35                           EQU is KLAT_LNKLINE# and its value is 6.
       36       36                           This routine will either read a single link
       37       37                           record or it will cycle through all of the link
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:2    
       38       38                           records looking for matches
       39       39                           to the selection criteria as input in the
       40       40                           LIST/DISPLAY command.  If a match is found
       41       41                           this routine will do either
       42       42                           of two things.  It will call the display routine
       43       43                           if the command was a DISPLAY command, or it will
       44       44                           put the vector framing the link name into the
       45       45                           formatter vector list.
       46       46
       47       47                  MEMORY REQUIREMENTS:
       48       48                           For all of the routines that deal with listing/
       49       49                           displaying links:
       50       50
       51       51                            ASL$LIST_ALL_LINKS
       52       52                            ASL$DISP_ONE_LINK
       53       53
       54       54                            The link record will be read into
       55       55                            data segment 1.  The name will be used by the
       56       56                            ASL$LIST_ALL_LINKS, while the other info
       57       57                            will be used by the ASL$DISP_ONE_LINK routine.
       58       58        */
       59       59        /********************************************************************/
       60       60        /*   Include files   include files   include files   include files  */
       61       61        /********************************************************************/
       62       62        %INCLUDE AS_PERR_C;
       63      664        %INCLUDE AS_SUPER_C;
       64     1099        %INCLUDE AS_SUBS_C;
       65     2513        %INCLUDE AS_MAC_C;
       66     2593        %INCLUDE AS_ENTRIES_M;
       67     3643        %INCLUDE AS_SSUBS_C;
       68     3735        %INCLUDE B_ERRORS_C;
       69     4862        %INCLUDE CP_6;
       70     4943        %INCLUDE OCI_SUBS_C;
       71     5041        %INCLUDE CP_6_SUBS;
       72     5581        %INCLUDE KL_SUPER_C;
       73     8483        %INCLUDE XU_MACRO_C;
       74    11589        %INCLUDE XU_FORMAT_C;
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:3    
       75    11751        %INCLUDE AS_SUPER_R;
       76    14767        /********************************************************************/
       77    14768        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       78    14769        /********************************************************************/
       79    14770        %ASB$PREC_HLP ;
       80    14773        %ASB$READ_HLP ;
       81    14776        %ASB$READ_HLP_SEQ ;
       82    14779        %ASH$ERROR ;
       83    14782        %ASA$ERROR ;
       84    14785        %ASL$DISP_ONE_LINK ;
       85    14788        %ASB$WILD_MATCH ;
       86    14791    1   DCL X$FORMAT ENTRY(1) ;
       87    14792        /********************************************************************/
       88    14793        /*   Local based     local based     local based     local based    */
       89    14794        /********************************************************************/
       90    14795        %PARSE$OUT ( NAME = P$B, STCLASS = "BASED(NODE$)",
       91    14796                     NDTYPE=TYPE, NSUBLKS=NSUBLKS);
       92    14841        %PARSE$SYM ( NAME = P$S, STCLASS = BASED);
       93    14879        %KL_DREC   ( NAME = LINK$DREC,
       94    14880                     STCLASS = "BASED(DSEG1$)",
       95    14881                     LAST = ";");
       96    14994        /********************************************************************/
       97    14995        /*   Auto data       auto data       auto data       auto data      */
       98    14996        /********************************************************************/
       99    14997    1   DCL ALL_LINKS              BIT(1);
      100    14998    1   DCL 1 BEGIN_KEY ,
      101    14999    1          2 COUNT             UBIN BYTE,
      102    15000    1          2 TEXT              CHAR(8);
      103    15001    1   DCL CODE2                  UBIN;
      104    15002    1   DCL CURRENT_LINK           CHAR(8);
      105    15003    1   DCL DISP                   BIT(1);
      106    15004    1   DCL DISP_LINKS             SBIN;
      107    15005    1   DCL 1 END_KEY ,
      108    15006    1          2 COUNT             UBIN BYTE,
      109    15007    1          2 TEXT              CHAR(8);
      110    15008    1   DCL I                      UBIN;
      111    15009    1   DCL J                      UBIN;
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:4    
      112    15010    1   DCL JCL                    BIT(1);
      113    15011    1   DCL 1 LINK_NAME,
      114    15012    1          2 COUNT             UBIN BYTE UNAL,
      115    15013    1          2 TEXT              CHAR(8) UNAL;
      116    15014    1   DCL WILD_CARD              BIT(1);
      117    15015        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:5    
      118    15016        /********************************************************************/
      119    15017        /*   Constant data   constant data   constant data   constant data  */
      120    15018        /********************************************************************/
      121    15019    1   DCL LINK_STR               CHAR(0) CONSTANT INIT ('link');
      122    15020    1   DCL LINKS_STR              CHAR(0) CONSTANT INIT ('links');
      123    15021    1   DCL LIST_STR               CHAR(0) CONSTANT INIT ('listed');
      124    15022    1   DCL DISPLAY_STR            CHAR(0) CONSTANT INIT ('displayed');
      125    15023        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:6    
      126    15024        /********************************************************************/
      127    15025        /*   Procedure       procedure       procedure       procedure      */
      128    15026        /********************************************************************/
      129    15027    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;
      130    15028    1   JCL = %NO#;
      131    15029    1   WILD_CARD = %NO#;
      132    15030    1   LINK_NAME.TEXT = '?';
      133    15031    1   LINK_NAME.COUNT = 1;
      134    15032    1   DISP_LINKS = 0;
      135    15033    1   DISP = %NO#;
      136    15034
      137    15035    2   DO SELECT (CODE);
      138    15036
      139    15037    2      SELECT (%LIST_ALL_VAL);
      140    15038
      141    15039    2      DISP = %NO#;
      142    15040    2      JCL = %NO#;
      143    15041
      144    15042    2      SELECT (%DISPLAY_ALL_VAL);
      145    15043
      146    15044    2      DISP = %YES#;
      147    15045    3      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN DO;
      148    15046    3         IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL THEN
      149    15047    3            JCL = %YES#;
      150    15048    4         ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN DO;
      151    15049    4               IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL THEN
      152    15050    4                  JCL = %YES#;
      153    15051    4               END; /*  Nsublks = 3  */
      154    15052    3         END; /*  Nsublks > 1  */
      155    15053
      156    15054    2      SELECT (%LIST_LINK_VAL);
      157    15055
      158    15056    2      DISP = %NO#;
      159    15057    2      JCL = %NO#;
      160    15058    3      IF P_PCB.OUT$->P$B.NSUBLKS > 1 THEN DO;
      161    15059    3         LINK_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;
      162    15060    3         LINK_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:7    
      163    15061    3         END; /*  Number of sublocks > 1  */
      164    15062
      165    15063    2      SELECT (%DISPLAY_LINK_VAL);
      166    15064
      167    15065    2      DISP = %YES#;
      168    15066    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;
      169    15067    3         CODE2 = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;
      170    15068
      171    15069    4         DO SELECT (CODE2);
      172    15070
      173    15071    4            SELECT (%LINK_NAME_WILD_VAL);
      174    15072
      175    15073    4            LINK_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;
      176    15074    4            LINK_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;
      177    15075
      178    15076    4            SELECT (%JCL_VAL);
      179    15077
      180    15078    4            JCL = %YES#;
      181    15079
      182    15080    4            END;  /* Do case (CODE2) */
      183    15081
      184    15082    3         END;  /*  Do i  */
      185    15083
      186    15084    2      END;  /*  Do case (code)  */
      187    15085
      188    15086    1   IF LINK_NAME.TEXT = '?' THEN
      189    15087    1      ALL_LINKS = %YES#;
      190    15088    2   ELSE DO;
      191    15089    2      ALL_LINKS = %NO#;
      192    15090    2      BEGIN_KEY.TEXT = ' ';
      193    15091    2      END_KEY.TEXT = ' ';
      194    15092    3      CALL INDEX (I,'?',LINK_NAME.TEXT) WHENRETURN DO;
      195    15093    3         BEGIN_KEY.TEXT = SUBSTR(LINK_NAME.TEXT,0,I);
      196    15094    3         BEGIN_KEY.COUNT = 8;
      197    15095    3         CALL CONCAT (END_KEY.TEXT,SUBSTR(LINK_NAME.TEXT,0,I),'~');
      198    15096    3         END_KEY.COUNT = I + 1;
      199    15097    3         WILD_CARD = %YES#;
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:8    
      200    15098    3         END;  /*  Whenreturn from index  */
      201    15099    3      WHENALTRETURN DO;
      202    15100    3         WILD_CARD = %NO#;
      203    15101    3         END;  /* Whenaltreturn  */
      204    15102    2      END;  /*  Else  */
      205    15103
      206    15104    1   FDS.NVECS# = 0;
      207    15105    2   IF JCL THEN DO;
      208    15106    2      CALL CONCAT (FMT_BUF, '%1/"', LINKS_STR, '%1/');
      209    15107    2      FDS.FMT_.BOUND = LENGTHC (LINKS_STR) + 6;
      210    15108    2      END;   /*  Jcl  */
      211    15109    2   ELSE DO;
      212    15110    2      CALL CONCAT (FMT_BUF, '%1/', LINKS_STR, '%1/');
      213    15111    2      FDS.FMT_.BOUND = LENGTHC (LINKS_STR) + 5;
      214    15112    2      END;  /*  Not jcl  */
      215    15113    1   FDS.TABDFLT# = 10;
      216    15114    1   CALL X$FORMAT (FDS);
      217    15115
      218    15116    2   IF ALL_LINKS THEN DO;
      219    15117    2      USERS_KEY = '001000'O;     /* To precord to begin of :HLP */
      220    15118    2      END;  /*  ALL_LINKS  */
      221    15119    2   ELSE IF WILD_CARD THEN DO;
      222    15120    2         CALL CONCAT (USERS_KEY.TXTC,BEGIN_KEY.TEXT,'*');
      223    15121    2         USERS_KEY.COUNT = 9 ;
      224    15122    2         END; /*  WILD_CARD  */
      225    15123    2      ELSE DO;  /*  Single link  */
      226    15124    2         CALL CONCAT (USERS_KEY.TXTC,LINK_NAME.TEXT,'*');
      227    15125    2         USERS_KEY.COUNT = 9 ;
      228    15126    2         I = DSEG1SIZE;
      229    15127    2         CALL ASB$READ_HLP (DSEG1$,I,1)
      230    15128    3         WHENRETURN DO;
      231    15129    4            IF LINK$DREC.ATYP ~= %KLAT_LNKLINE# THEN DO;
      232    15130                 /*E*  ERROR:    ASL-E$NOTLINK-C
      233    15131                       MESSAGE: %%U1 %is not a link.
      234    15132                       MESSAGE1: %%U1 %is a %U2.
      235    15133                 */
      236    15134    4               AS_FIELD1 = LINK_NAME;
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:9    
      237    15135                    %SCREAM( ERR#=E$NOTLINK , LEVEL=ERROR, MID='L' );
      238    15150    4               RETURN ;
      239    15151    4               END ; /* Then do */
      240    15152    3            IF DISP THEN
      241    15153    4            DO;
      242    15154    4               CALL ASL$DISP_ONE_LINK (JCL);
      243    15155    4               END; /*  If disp  */
      244    15156    4            ELSE DO;
      245    15157    4               CALL CONCAT (FMT_BUF, SUBSTR(LINK_NAME.TEXT,0,LINK_NAME.COUNT), '%1/');
      246    15158    4               FDS.FMT_.BOUND = LINK_NAME.COUNT + 2;
      247    15159    4               CALL X$FORMAT (FDS);
      248    15160    4               END; /*  Else  disp  */
      249    15161    3            END;  /*  Whenreturn  */
      250    15162    3         WHENALTRETURN DO;
      251    15163    3            IF MERR_CODE.CODE = %E$NOKEY
      252    15164    4            THEN DO;
      253    15165        /*E* ERROR:   ASL-E$LINK_NO_EXIST2-C
      254    15166             MESSAGE: Link %U1 does not exist.
      255    15167             MESSAGE1: The specified LINK does not exist.
      256    15168        */
      257    15169    4               AS_FIELD1 = LINK_NAME;
      258    15170                    %SCREAM( ERR#=E$LINK_NO_EXIST2, MID='L', LEVEL=ERROR );
      259    15185    4               END;  /*  Error = nokey  */
      260    15186    4            ELSE DO;
      261    15187    4               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );
      262    15188    4               END;  /* Error ~= nokey */
      263    15189    3            END;  /*  Whenaltreturn  */
      264    15190    2         RETURN;
      265    15191    2         END; /*  Else  */
      266    15192    1   CALL ASB$PREC_HLP ;
      267    15193    2   DO FOREVER;
      268    15194
      269    15195    3      DO UNTIL LINK$DREC.ATYP = %KLAT_LNKLINE# ;
      270    15196    3         I = DSEG1SIZE;
      271    15197    3         CALL ASB$READ_HLP_SEQ(DSEG1$,I,1)
      272    15198    4         WHENALTRETURN DO;
      273    15199    4            IF MERR_CODE.CODE ~= %E$EOF THEN CALL ASH$ERROR(MERR_CODE);
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:10   
      274    15200    4            GOTO FINISH_UP;
      275    15201    4            END;  /*  Whenaltreturn  */
      276    15202    3         END;  /*  Do until we find a link record  */
      277    15203    3      CALL INDEX (I,' ',USERS_KEY.TXTC) WHENALTRETURN DO;
      278    15204    3         I = 8;
      279    15205    3         END;  /*  Whenaltreturn  */
      280    15206    2      IF I > 8 THEN I = 8;
      281    15207    2      CURRENT_LINK = SUBSTR(USERS_KEY.TXTC,0,I);
      282    15208    3      IF WILD_CARD THEN DO;
      283    15209    3         J = LINK_NAME.COUNT;
      284    15210    3         CALL ASB$WILD_MATCH (I, CURRENT_LINK, J, LINK_NAME.TEXT)
      285    15211    4         WHENALTRETURN DO;
      286    15212    4            IF CURRENT_LINK > END_KEY.TEXT THEN
      287    15213    4               GOTO FINISH_UP;
      288    15214    4            ELSE
      289    15215    4               GOTO END_FOREVER;
      290    15216    4            END;  /*  Whenaltreturn  */
      291    15217    3         END; /*  WILD_CARD  */
      292    15218    2      IF DISP THEN
      293    15219    3      DO;
      294    15220    3         CALL ASL$DISP_ONE_LINK (JCL);
      295    15221    3         END; /*  If disp  */
      296    15222    3      ELSE DO;
      297    15223    4         IF DISP_LINKS = 0 THEN DO;
      298    15224    4            CALL CONCAT (FMT_BUF, '%\', SUBSTR(CURRENT_LINK,0,I));
      299    15225    4            FDS.FMT_.BOUND = I+1 ;
      300    15226    4            END; /*  DISP_LINKS = 0  */
      301    15227    4         ELSE DO;
      302    15228    4            CALL CONCAT (FMT_BUF, '%\%-%10R', SUBSTR(CURRENT_LINK,0,I));
      303    15229    4            FDS.FMT_.BOUND = I + 7;
      304    15230    4            END; /*  Else  */
      305    15231    3         CALL X$FORMAT (FDS);
      306    15232    3         END; /*  Else  disp  */
      307    15233    2      DISP_LINKS = DISP_LINKS + 1;
      308    15234    2   END_FOREVER:
      309    15235    2      END;  /*  Do forever  */
      310    15236    1   FINISH_UP:
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:11   
      311    15237    2   IF NOT DISP THEN DO;
      312    15238    2      FMT_BUF = '%\%/';
      313    15239    2      FDS.FMT_.BOUND = 3;
      314    15240    2      FDS.NVECS# = 0;
      315    15241    2      CALL X$FORMAT(FDS);
      316    15242    2      END; /*  If not disp  */
      317    15243    2   IF NOT JCL THEN DO;
      318    15244    2      FMT_VEC(0) = VECTOR (DISP_LINKS);
      319    15245    2      IF DISP_LINKS = 1 THEN
      320    15246    3      DO;
      321    15247    3         FMT_VEC(1) = VECTOR (LINK_STR);
      322    15248    3         END; /*  DISP_LINKS = 1  */
      323    15249    3      ELSE DO;
      324    15250    3         FMT_VEC(1) = VECTOR (LINKS_STR);
      325    15251    3         END; /*  DISP_LINKS ~= 1  */
      326    15252    2      IF DISP THEN
      327    15253    3      DO;
      328    15254    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);
      329    15255    3         END; /*  If disp  */
      330    15256    3      ELSE DO;
      331    15257    3         FMT_VEC(2) = VECTOR (LIST_STR);
      332    15258    3         END; /*  If ~ disp  */
      333    15259    2      FDS.NVECS# = 3;
      334    15260    2      FMT_BUF = '   %5D %A %A.';
      335    15261    2      FDS.FMT_.BOUND = 12;
      336    15262    2      CALL X$FORMAT(FDS);
      337    15263    2      END; /* Not jcl */
      338    15264    1   RETURN;
      339    15265    1   END ASL$LIST_ALL_LINKS;
      340    15266        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:12   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_LINKS.

   Procedure ASL$LIST_ALL_LINKS requires 459 words for executable code.
   Procedure ASL$LIST_ALL_LINKS requires 28 words of local(AUTO) storage.

PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:13   

 Object Unit name= ASL$LIST_ALL_LINKS                         File name= ASL$LIST_LINKS.:E05TOU
 UTS= JUL 29 '97 10:16:05.76 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2  RoData even  UTS     19     23  ASL$LIST_ALL_LINKS
    3   Proc  even  none   459    713  ASL$LIST_ALL_LINKS
    4  RoData even  none    24     30  ASL$LIST_ALL_LINKS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        0  ASL$LIST_ALL_LINKS
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:14   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       1 X$FORMAT
 yes     yes           Std       3 ASB$READ_HLP
         yes           Std       2 ASH$ERROR
         yes           Std       1 ASL$DISP_ONE_LINK
 yes     yes           Std       0 ASB$PREC_HLP
         yes           Std       3 ASA$ERROR
 yes     yes           Std       4 ASB$WILD_MATCH
 yes     yes           Std       3 ASB$READ_HLP_SEQ
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  USERS_KEY                             FDS
     FMT_BUF                               FMT_VEC                               NODE$
     CODE                                  ERR_CODE                              AS_FIELD1
     REMEM_VAR                             REM_FCMD                              ASA_BRKS_LOC
     DSEG1$                                DSEG1SIZE                             P_PCB
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:15   


        1        1        /*M* ASL$LIST_ALL_LINKS:  routine to handle LIST LINK cmd. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9
       10       10        ASL$LIST_ALL_LINKS: PROC;

     10  3 000000   000000 700200 xent  ASL$LIST_AL* TSX0  ! X66_AUTO_0
         3 000001   000034 000000                    ZERO    28,0

       11       11        /**********************************************************/
       12       12
       13       13        /*D* NAME:     ASL$LIST_ALL_LINKS
       14       14             CALL:     CALL ASL$LIST_ALL_LINKS
       15       15             INPUT:    Nothing is passed.
       16       16             OUTPUT:   Nothing is returned.
       17       17             DESCRIPTION:  ASL$LIST_ALL_LINKS is a subroutine to handle
       18       18                           the LIST LINK command for SUPER.
       19       19                           Link records are stored in the :HLP.:SYS
       20       20                           file and have keys that look like the following:
       21       21                           'xxxxxxxx*' where the x signifies
       22       22                           a character from the alphanumeric character
       23       23                           set plus the special characters ':$*' and
       24       24                           is of length 8 or less.
       25       25                           If the actual link name is less than 8
       26       26                           characters, the key will be blank padded to
       27       27                           8 characters.
       28       28                           The key is not a unique identifier for links
       29       29                           though.  Other types of objects known to
       30       30                           SUPER have the same type of key structure.
       31       31                           The unique identifier for these objects is
       32       32                           the first byte of the actual record, which
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:16   
       33       33                           contains a value specified by the KLAT_?
       34       34                           EQU's found in KL_SUPER_C.  For links the
       35       35                           EQU is KLAT_LNKLINE# and its value is 6.
       36       36                           This routine will either read a single link
       37       37                           record or it will cycle through all of the link
       38       38                           records looking for matches
       39       39                           to the selection criteria as input in the
       40       40                           LIST/DISPLAY command.  If a match is found
       41       41                           this routine will do either
       42       42                           of two things.  It will call the display routine
       43       43                           if the command was a DISPLAY command, or it will
       44       44                           put the vector framing the link name into the
       45       45                           formatter vector list.
       46       46
       47       47                  MEMORY REQUIREMENTS:
       48       48                           For all of the routines that deal with listing/
       49       49                           displaying links:
       50       50
       51       51                            ASL$LIST_ALL_LINKS
       52       52                            ASL$DISP_ONE_LINK
       53       53
       54       54                            The link record will be read into
       55       55                            data segment 1.  The name will be used by the
       56       56                            ASL$LIST_ALL_LINKS, while the other info
       57       57                            will be used by the ASL$DISP_ONE_LINK routine.
       58       58        */
       59       59        /********************************************************************/
       60       60        /*   Include files   include files   include files   include files  */
       61       61        /********************************************************************/
       62       62        %INCLUDE AS_PERR_C;
       63      664        %INCLUDE AS_SUPER_C;
       64     1099        %INCLUDE AS_SUBS_C;
       65     2513        %INCLUDE AS_MAC_C;
       66     2593        %INCLUDE AS_ENTRIES_M;
       67     3643        %INCLUDE AS_SSUBS_C;
       68     3735        %INCLUDE B_ERRORS_C;
       69     4862        %INCLUDE CP_6;
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:17   
       70     4943        %INCLUDE OCI_SUBS_C;
       71     5041        %INCLUDE CP_6_SUBS;
       72     5581        %INCLUDE KL_SUPER_C;
       73     8483        %INCLUDE XU_MACRO_C;
       74    11589        %INCLUDE XU_FORMAT_C;
       75    11751        %INCLUDE AS_SUPER_R;
       76    14767        /********************************************************************/
       77    14768        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       78    14769        /********************************************************************/
       79    14770        %ASB$PREC_HLP ;
       80    14773        %ASB$READ_HLP ;
       81    14776        %ASB$READ_HLP_SEQ ;
       82    14779        %ASH$ERROR ;
       83    14782        %ASA$ERROR ;
       84    14785        %ASL$DISP_ONE_LINK ;
       85    14788        %ASB$WILD_MATCH ;
       86    14791    1   DCL X$FORMAT ENTRY(1) ;
       87    14792        /********************************************************************/
       88    14793        /*   Local based     local based     local based     local based    */
       89    14794        /********************************************************************/
       90    14795        %PARSE$OUT ( NAME = P$B, STCLASS = "BASED(NODE$)",
       91    14796                     NDTYPE=TYPE, NSUBLKS=NSUBLKS);
       92    14841        %PARSE$SYM ( NAME = P$S, STCLASS = BASED);
       93    14879        %KL_DREC   ( NAME = LINK$DREC,
       94    14880                     STCLASS = "BASED(DSEG1$)",
       95    14881                     LAST = ";");
       96    14994        /********************************************************************/
       97    14995        /*   Auto data       auto data       auto data       auto data      */
       98    14996        /********************************************************************/
       99    14997    1   DCL ALL_LINKS              BIT(1);
      100    14998    1   DCL 1 BEGIN_KEY ,
      101    14999    1          2 COUNT             UBIN BYTE,
      102    15000    1          2 TEXT              CHAR(8);
      103    15001    1   DCL CODE2                  UBIN;
      104    15002    1   DCL CURRENT_LINK           CHAR(8);
      105    15003    1   DCL DISP                   BIT(1);
      106    15004    1   DCL DISP_LINKS             SBIN;
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:18   
      107    15005    1   DCL 1 END_KEY ,
      108    15006    1          2 COUNT             UBIN BYTE,
      109    15007    1          2 TEXT              CHAR(8);
      110    15008    1   DCL I                      UBIN;
      111    15009    1   DCL J                      UBIN;
      112    15010    1   DCL JCL                    BIT(1);
      113    15011    1   DCL 1 LINK_NAME,
      114    15012    1          2 COUNT             UBIN BYTE UNAL,
      115    15013    1          2 TEXT              CHAR(8) UNAL;
      116    15014    1   DCL WILD_CARD              BIT(1);
      117    15015        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:19   
      118    15016        /********************************************************************/
      119    15017        /*   Constant data   constant data   constant data   constant data  */
      120    15018        /********************************************************************/
      121    15019    1   DCL LINK_STR               CHAR(0) CONSTANT INIT ('link');
      122    15020    1   DCL LINKS_STR              CHAR(0) CONSTANT INIT ('links');
      123    15021    1   DCL LIST_STR               CHAR(0) CONSTANT INIT ('listed');
      124    15022    1   DCL DISPLAY_STR            CHAR(0) CONSTANT INIT ('displayed');
      125    15023        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:20   
      126    15024        /********************************************************************/
      127    15025        /*   Procedure       procedure       procedure       procedure      */
      128    15026        /********************************************************************/
      129    15027    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;

  15027  3 000002   000003 470400 xsym               LDP0    P_PCB+3
         3 000003   000003 471500                    LDP1    3,,PR0
         3 000004   100000 236100                    LDQ     0,,PR1
         3 000005   777777 376007                    ANQ     -1,DL
         3 000006   000000 756000 xsym               STQ     CODE

      130    15028    1   JCL = %NO#;

  15028  3 000007   200021 450100                    STZ     JCL,,AUTO

      131    15029    1   WILD_CARD = %NO#;

  15029  3 000010   200025 450100                    STZ     WILD_CARD,,AUTO

      132    15030    1   LINK_NAME.TEXT = '?';

  15030  3 000011   040100 100400                    MLR     fill='040'O
         3 000012   000000 000001 4                  ADSC9   0                        cn=0,n=1
         3 000013   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=8

      133    15031    1   LINK_NAME.COUNT = 1;

  15031  3 000014   001000 236003                    LDQ     512,DU
         3 000015   200022 552140                    STBQ    LINK_NAME,'40'O,AUTO

      134    15032    1   DISP_LINKS = 0;

  15032  3 000016   200013 450100                    STZ     DISP_LINKS,,AUTO

      135    15033    1   DISP = %NO#;

  15033  3 000017   200012 450100                    STZ     DISP,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:21   

      136    15034
      137    15035    2   DO SELECT (CODE);

  15035  3 000020   000000 236000 xsym               LDQ     CODE
         3 000021   000022 116007                    CMPQ    18,DL
         3 000022   000033 602000 3                  TNC     s:15035+11
         3 000023   000036 600000 3                  TZE     s:15039
         3 000024   000144 116007                    CMPQ    100,DL
         3 000025   000030 602000 3                  TNC     s:15035+8
         3 000026   000041 600000 3                  TZE     s:15044
         3 000027   000153 710000 3                  TRA     s:15086
         3 000030   000131 116007                    CMPQ    89,DL
         3 000031   000153 601000 3                  TNZ     s:15086
         3 000032   000104 710000 3                  TRA     s:15065
         3 000033   000014 116007                    CMPQ    12,DL
         3 000034   000153 601000 3                  TNZ     s:15086
         3 000035   000064 710000 3                  TRA     s:15056

      138    15036
      139    15037    2      SELECT (%LIST_ALL_VAL);

      140    15038
      141    15039    2      DISP = %NO#;

  15039  3 000036   200012 450100                    STZ     DISP,,AUTO

      142    15040    2      JCL = %NO#;

  15040  3 000037   200021 450100                    STZ     JCL,,AUTO
         3 000040   000153 710000 3                  TRA     s:15086

      143    15041
      144    15042    2      SELECT (%DISPLAY_ALL_VAL);

      145    15043
      146    15044    2      DISP = %YES#;
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:22   

  15044  3 000041   400000 236003                    LDQ     -131072,DU
         3 000042   200012 756100                    STQ     DISP,,AUTO

      147    15045    3      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN DO;

  15045  3 000043   000003 471500                    LDP1    3,,PR0
         3 000044   100001 220100                    LDX0    1,,PR1
         3 000045   000153 600000 3                  TZE     s:15086

      148    15046    3         IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL THEN

  15046  3 000046   100003 473500                    LDP3    3,,PR1
         3 000047   300000 721100                    LXL1    0,,PR3
         3 000050   000001 101003                    CMPX1   1,DU
         3 000051   000054 601000 3                  TNZ     s:15048

      149    15047    3            JCL = %YES#;

  15047  3 000052   200021 756100                    STQ     JCL,,AUTO
         3 000053   000153 710000 3                  TRA     s:15086

      150    15048    4         ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN DO;

  15048  3 000054   000002 100003                    CMPX0   2,DU
         3 000055   000153 601000 3                  TNZ     s:15086

      151    15049    4               IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL THEN

  15049  3 000056   100004 474500                    LDP4    4,,PR1
         3 000057   400000 722100                    LXL2    0,,PR4
         3 000060   000001 102003                    CMPX2   1,DU
         3 000061   000153 601000 3                  TNZ     s:15086

      152    15050    4                  JCL = %YES#;

  15050  3 000062   200021 756100                    STQ     JCL,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:23   

      153    15051    4               END; /*  Nsublks = 3  */

      154    15052    3         END; /*  Nsublks > 1  */

  15052  3 000063   000153 710000 3                  TRA     s:15086

      155    15053
      156    15054    2      SELECT (%LIST_LINK_VAL);

      157    15055
      158    15056    2      DISP = %NO#;

  15056  3 000064   200012 450100                    STZ     DISP,,AUTO

      159    15057    2      JCL = %NO#;

  15057  3 000065   200021 450100                    STZ     JCL,,AUTO

      160    15058    3      IF P_PCB.OUT$->P$B.NSUBLKS > 1 THEN DO;

  15058  3 000066   000001 220100                    LDX0    1,,PR0
         3 000067   000002 100003                    CMPX0   2,DU
         3 000070   000153 602000 3                  TNC     s:15086

      161    15059    3         LINK_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;

  15059  3 000071   000004 471500                    LDP1    4,,PR0
         3 000072   100004 236100                    LDQ     4,,PR1
         3 000073   000033 772000                    QRL     27
         3 000074   000000 621006                    EAX1    0,QL
         3 000075   040100 100540                    MLR     fill='040'O
         3 000076   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         3 000077   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=8

      162    15060    3         LINK_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;

PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:24   
  15060  3 000100   000004 471500                    LDP1    4,,PR0
         3 000101   100004 236100                    LDQ     4,,PR1
         3 000102   200022 552140                    STBQ    LINK_NAME,'40'O,AUTO

      163    15061    3         END; /*  Number of sublocks > 1  */

  15061  3 000103   000153 710000 3                  TRA     s:15086

      164    15062
      165    15063    2      SELECT (%DISPLAY_LINK_VAL);

      166    15064
      167    15065    2      DISP = %YES#;

  15065  3 000104   400000 236003                    LDQ     -131072,DU
         3 000105   200012 756100                    STQ     DISP,,AUTO

      168    15066    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;

  15066  3 000106   000001 235007                    LDA     1,DL
         3 000107   200017 755100                    STA     I,,AUTO
         3 000110   000146 710000 3                  TRA     s:15082+3

      169    15067    3         CODE2 = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;

  15067  3 000111   000003 470400 xsym               LDP0    P_PCB+3
         3 000112   200017 720100                    LXL0    I,,AUTO
         3 000113   000003 471510                    LDP1    3,X0,PR0
         3 000114   100000 236100                    LDQ     0,,PR1
         3 000115   777777 376007                    ANQ     -1,DL
         3 000116   200007 756100                    STQ     CODE2,,AUTO

      170    15068
      171    15069    4         DO SELECT (CODE2);

  15069  3 000117   000355 116007                    CMPQ    237,DL
         3 000120   000123 602000 3                  TNC     s:15069+4
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:25   
         3 000121   000126 600000 3                  TZE     s:15073
         3 000122   000143 710000 3                  TRA     s:15082
         3 000123   000001 116007                    CMPQ    1,DL
         3 000124   000143 601000 3                  TNZ     s:15082
         3 000125   000141 710000 3                  TRA     s:15078

      172    15070
      173    15071    4            SELECT (%LINK_NAME_WILD_VAL);

      174    15072
      175    15073    4            LINK_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;

  15073  3 000126   000004 473500                    LDP3    4,,PR0
         3 000127   300004 236100                    LDQ     4,,PR3
         3 000130   000033 772000                    QRL     27
         3 000131   000000 621006                    EAX1    0,QL
         3 000132   040100 100540                    MLR     fill='040'O
         3 000133   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         3 000134   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=8

      176    15074    4            LINK_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;

  15074  3 000135   000004 471500                    LDP1    4,,PR0
         3 000136   100004 236100                    LDQ     4,,PR1
         3 000137   200022 552140                    STBQ    LINK_NAME,'40'O,AUTO
         3 000140   000143 710000 3                  TRA     s:15082

      177    15075
      178    15076    4            SELECT (%JCL_VAL);

      179    15077
      180    15078    4            JCL = %YES#;

  15078  3 000141   400000 236003                    LDQ     -131072,DU
         3 000142   200021 756100                    STQ     JCL,,AUTO

      181    15079
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:26   
      182    15080    4            END;  /* Do case (CODE2) */

      183    15081
      184    15082    3         END;  /*  Do i  */

  15082  3 000143   200017 235100                    LDA     I,,AUTO
         3 000144   000001 035007                    ADLA    1,DL
         3 000145   200017 755100                    STA     I,,AUTO
         3 000146   000001 236100                    LDQ     1,,PR0
         3 000147   000022 772000                    QRL     18
         3 000150   200017 116100                    CMPQ    I,,AUTO
         3 000151   000153 600000 3                  TZE     s:15086
         3 000152   000111 603000 3                  TRC     s:15067

      185    15083
      186    15084    2      END;  /*  Do case (code)  */

      187    15085
      188    15086    1   IF LINK_NAME.TEXT = '?' THEN

  15086  3 000153   040000 106500                    CMPC    fill='040'O
         3 000154   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=8
         3 000155   000000 000001 4                  ADSC9   0                        cn=0,n=1
         3 000156   000162 601000 3                  TNZ     s:15089

      189    15087    1      ALL_LINKS = %YES#;

  15087  3 000157   400000 236003                    LDQ     -131072,DU
         3 000160   200003 756100                    STQ     ALL_LINKS,,AUTO
         3 000161   000230 710000 3                  TRA     s:15104

      190    15088    2   ELSE DO;

      191    15089    2      ALL_LINKS = %NO#;

  15089  3 000162   200003 450100                    STZ     ALL_LINKS,,AUTO

PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:27   
      192    15090    2      BEGIN_KEY.TEXT = ' ';

  15090  3 000163   000035 235000 xsym               LDA     B_VECTNIL+29
         3 000164   000035 236000 xsym               LDQ     B_VECTNIL+29
         3 000165   200005 755100                    STA     BEGIN_KEY+1,,AUTO
         3 000166   200006 756100                    STQ     BEGIN_KEY+2,,AUTO

      193    15091    2      END_KEY.TEXT = ' ';

  15091  3 000167   000035 235000 xsym               LDA     B_VECTNIL+29
         3 000170   000035 236000 xsym               LDQ     B_VECTNIL+29
         3 000171   200015 755100                    STA     END_KEY+1,,AUTO
         3 000172   200016 756100                    STQ     END_KEY+2,,AUTO

      194    15092    3      CALL INDEX (I,'?',LINK_NAME.TEXT) WHENRETURN DO;

  15092  3 000173   000000 124500                    SCM     mask='000'O
         3 000174   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=8
         3 000175   000000 000001 4                  ADSC9   0                        cn=0,n=1
         3 000176   200017 000100                    ARG     I,,AUTO
         3 000177   000227 606400 3                  TTN     s:15100

      195    15093    3         BEGIN_KEY.TEXT = SUBSTR(LINK_NAME.TEXT,0,I);

  15093  3 000200   200017 720100                    LXL0    I,,AUTO
         3 000201   040100 100540                    MLR     fill='040'O
         3 000202   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=*X0
         3 000203   200005 000010                    ADSC9   BEGIN_KEY+1,,AUTO        cn=0,n=8

      196    15094    3         BEGIN_KEY.COUNT = 8;

  15094  3 000204   010000 236003                    LDQ     4096,DU
         3 000205   200004 756100                    STQ     BEGIN_KEY,,AUTO

      197    15095    3         CALL CONCAT (END_KEY.TEXT,SUBSTR(LINK_NAME.TEXT,0,I),'~');

  15095  3 000206   040100 100540                    MLR     fill='040'O
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:28   
         3 000207   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=*X0
         3 000210   200015 000010                    ADSC9   END_KEY+1,,AUTO          cn=0,n=8
         3 000211   200017 236100                    LDQ     I,,AUTO
         3 000212   000010 116007                    CMPQ    8,DL
         3 000213   000221 603000 3                  TRC     s:15096
         3 000214   777767 621006                    EAX1    -9,QL
         3 000215   777777 661003                    ERX1    -1,DU
         3 000216   040146 100400                    MLR     fill='040'O
         3 000217   000001 000001 4                  ADSC9   1                        cn=0,n=1
         3 000220   200015 000011                    ADSC9   END_KEY+1,Q,AUTO         cn=0,n=*X1

      198    15096    3         END_KEY.COUNT = I + 1;

  15096  3 000221   000001 036007                    ADLQ    1,DL
         3 000222   000033 736000                    QLS     27
         3 000223   200014 756100                    STQ     END_KEY,,AUTO

      199    15097    3         WILD_CARD = %YES#;

  15097  3 000224   400000 236003                    LDQ     -131072,DU
         3 000225   200025 756100                    STQ     WILD_CARD,,AUTO

      200    15098    3         END;  /*  Whenreturn from index  */

  15098  3 000226   000230 710000 3                  TRA     s:15104

      201    15099    3      WHENALTRETURN DO;

      202    15100    3         WILD_CARD = %NO#;

  15100  3 000227   200025 450100                    STZ     WILD_CARD,,AUTO

      203    15101    3         END;  /* Whenaltreturn  */

      204    15102    2      END;  /*  Else  */

      205    15103
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:29   
      206    15104    1   FDS.NVECS# = 0;

  15104  3 000230   000011 450000 xsym               STZ     FDS+9

      207    15105    2   IF JCL THEN DO;

  15105  3 000231   200021 234100                    SZN     JCL,,AUTO
         3 000232   000250 605000 3                  TPL     s:15110

      208    15106    2      CALL CONCAT (FMT_BUF, '%1/"', LINKS_STR, '%1/');

  15106  3 000233   000010 236000 2                  LDQ     DISPLAY_STR+3
         3 000234   000000 756000 xsym               STQ     FMT_BUF
         3 000235   040000 100400                    MLR     fill='040'O
         3 000236   000001 000005 2                  ADSC9   LINKS_STR                cn=0,n=5
         3 000237   000001 000005 xsym               ADSC9   FMT_BUF+1                cn=0,n=5
         3 000240   040000 100400                    MLR     fill='040'O
         3 000241   000010 000003 2                  ADSC9   DISPLAY_STR+3            cn=0,n=3
         3 000242   000002 200366 xsym               ADSC9   FMT_BUF+2                cn=1,n=246

      209    15107    2      FDS.FMT_.BOUND = LENGTHC (LINKS_STR) + 6;

  15107  3 000243   000000 236000 xsym               LDQ     FDS
         3 000244   177777 376007                    ANQ     65535,DL
         3 000245   000002 276000 4                  ORQ     2
         3 000246   000000 756000 xsym               STQ     FDS

      210    15108    2      END;   /*  Jcl  */

  15108  3 000247   000266 710000 3                  TRA     s:15113

      211    15109    2   ELSE DO;

      212    15110    2      CALL CONCAT (FMT_BUF, '%1/', LINKS_STR, '%1/');

  15110  3 000250   000010 236000 2                  LDQ     DISPLAY_STR+3
         3 000251   000003 376000 4                  ANQ     3
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:30   
         3 000252   000040 276007                    ORQ     32,DL
         3 000253   000000 756000 xsym               STQ     FMT_BUF
         3 000254   040000 100400                    MLR     fill='040'O
         3 000255   000001 000005 2                  ADSC9   LINKS_STR                cn=0,n=5
         3 000256   000000 600005 xsym               ADSC9   FMT_BUF                  cn=3,n=5
         3 000257   040000 100400                    MLR     fill='040'O
         3 000260   000010 000003 2                  ADSC9   DISPLAY_STR+3            cn=0,n=3
         3 000261   000002 000367 xsym               ADSC9   FMT_BUF+2                cn=0,n=247

      213    15111    2      FDS.FMT_.BOUND = LENGTHC (LINKS_STR) + 5;

  15111  3 000262   000000 236000 xsym               LDQ     FDS
         3 000263   177777 376007                    ANQ     65535,DL
         3 000264   000004 276000 4                  ORQ     4
         3 000265   000000 756000 xsym               STQ     FDS

      214    15112    2      END;  /*  Not jcl  */

      215    15113    1   FDS.TABDFLT# = 10;

  15113  3 000266   000012 235007                    LDA     10,DL
         3 000267   000017 755000 xsym               STA     FDS+15

      216    15114    1   CALL X$FORMAT (FDS);

  15114  3 000270   000005 630400 4                  EPPR0   5
         3 000271   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000272   000000 701000 xent               TSX1    X$FORMAT
         3 000273   000000 011000                    NOP     0

      217    15115
      218    15116    2   IF ALL_LINKS THEN DO;

  15116  3 000274   200003 234100                    SZN     ALL_LINKS,,AUTO
         3 000275   000302 605000 3                  TPL     s:15119

      219    15117    2      USERS_KEY = '001000'O;     /* To precord to begin of :HLP */
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:31   

  15117  3 000276   000000 100400                    MLR     fill='000'O
         3 000277   000033 000002 xsym               ADSC9   B_VECTNIL+27             cn=0,n=2
         3 000300   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      220    15118    2      END;  /*  ALL_LINKS  */

  15118  3 000301   000441 710000 3                  TRA     s:15192

      221    15119    2   ELSE IF WILD_CARD THEN DO;

  15119  3 000302   200025 234100                    SZN     WILD_CARD,,AUTO
         3 000303   000315 605000 3                  TPL     s:15124

      222    15120    2         CALL CONCAT (USERS_KEY.TXTC,BEGIN_KEY.TEXT,'*');

  15120  3 000304   040000 100500                    MLR     fill='040'O
         3 000305   200005 000010                    ADSC9   BEGIN_KEY+1,,AUTO        cn=0,n=8
         3 000306   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         3 000307   040000 100400                    MLR     fill='040'O
         3 000310   000006 000001 4                  ADSC9   6                        cn=0,n=1
         3 000311   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      223    15121    2         USERS_KEY.COUNT = 9 ;

  15121  3 000312   011000 236003                    LDQ     4608,DU
         3 000313   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      224    15122    2         END; /*  WILD_CARD  */

  15122  3 000314   000441 710000 3                  TRA     s:15192

      225    15123    2      ELSE DO;  /*  Single link  */

      226    15124    2         CALL CONCAT (USERS_KEY.TXTC,LINK_NAME.TEXT,'*');

  15124  3 000315   040000 100500                    MLR     fill='040'O
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:32   
         3 000316   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=8
         3 000317   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         3 000320   040000 100400                    MLR     fill='040'O
         3 000321   000006 000001 4                  ADSC9   6                        cn=0,n=1
         3 000322   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      227    15125    2         USERS_KEY.COUNT = 9 ;

  15125  3 000323   011000 236003                    LDQ     4608,DU
         3 000324   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      228    15126    2         I = DSEG1SIZE;

  15126  3 000325   000000 235000 xsym               LDA     DSEG1SIZE
         3 000326   200017 755100                    STA     I,,AUTO

      229    15127    2         CALL ASB$READ_HLP (DSEG1$,I,1)

  15127  3 000327   000007 236000 4                  LDQ     7
         3 000330   200030 756100                    STQ     WILD_CARD+3,,AUTO
         3 000331   200017 630500                    EPPR0   I,,AUTO
         3 000332   200027 450500                    STP0    WILD_CARD+2,,AUTO
         3 000333   000010 236000 4                  LDQ     8
         3 000334   200026 756100                    STQ     WILD_CARD+1,,AUTO
         3 000335   200026 630500                    EPPR0   WILD_CARD+1,,AUTO
         3 000336   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000337   000000 701000 xent               TSX1    ASB$READ_HLP
         3 000340   000420 702000 3                  TSX2    s:15163

      230    15128    3         WHENRETURN DO;

      231    15129    4            IF LINK$DREC.ATYP ~= %KLAT_LNKLINE# THEN DO;

  15129  3 000341   000000 470400 xsym               LDP0    DSEG1$
         3 000342   000000 236100                    LDQ     0,,PR0
         3 000343   777000 376003                    ANQ     -512,DU
         3 000344   006000 116003                    CMPQ    3072,DU
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:33   
         3 000345   000356 600000 3                  TZE     s:15152

      232    15130                 /*E*  ERROR:    ASL-E$NOTLINK-C
      233    15131                       MESSAGE: %%U1 %is not a link.
      234    15132                       MESSAGE1: %%U1 %is a %U2.
      235    15133                 */
      236    15134    4               AS_FIELD1 = LINK_NAME;

  15134  3 000346   000000 100500                    MLR     fill='000'O
         3 000347   200022 000011                    ADSC9   LINK_NAME,,AUTO          cn=0,n=9
         3 000350   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      237    15135                    %SCREAM( ERR#=E$NOTLINK , LEVEL=ERROR, MID='L' );

  15147  3 000351   000011 630400 4                  EPPR0   9
         3 000352   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000353   000000 701000 xent               TSX1    ASH$ERROR
         3 000354   000000 011000                    NOP     0

      238    15150    4               RETURN ;

  15150  3 000355   000000 702200 xent               TSX2  ! X66_ARET

      239    15151    4               END ; /* Then do */
      240    15152    3            IF DISP THEN

  15152  3 000356   200012 234100                    SZN     DISP,,AUTO
         3 000357   000367 605000 3                  TPL     s:15157

      241    15153    4            DO;

      242    15154    4               CALL ASL$DISP_ONE_LINK (JCL);

  15154  3 000360   200021 631500                    EPPR1   JCL,,AUTO
         3 000361   200026 451500                    STP1    WILD_CARD+1,,AUTO
         3 000362   200026 630500                    EPPR0   WILD_CARD+1,,AUTO
         3 000363   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:34   
         3 000364   000000 701000 xent               TSX1    ASL$DISP_ONE_LINK
         3 000365   000000 011000                    NOP     0

      243    15155    4               END; /*  If disp  */

  15155  3 000366   000417 710000 3                  TRA     s:15161

      244    15156    4            ELSE DO;

      245    15157    4               CALL CONCAT (FMT_BUF, SUBSTR(LINK_NAME.TEXT,0,LINK_NAME.COUNT), '%1/');

  15157  3 000367   200022 236100                    LDQ     LINK_NAME,,AUTO
         3 000370   000033 772000                    QRL     27
         3 000371   000000 620006                    EAX0    0,QL
         3 000372   040000 100540                    MLR     fill='040'O
         3 000373   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=*X0
         3 000374   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255
         3 000375   000377 116007                    CMPQ    255,DL
         3 000376   000404 603000 3                  TRC     s:15158
         3 000377   777400 620006                    EAX0    -256,QL
         3 000400   777777 660003                    ERX0    -1,DU
         3 000401   040046 100400                    MLR     fill='040'O
         3 000402   000010 000003 2                  ADSC9   DISPLAY_STR+3            cn=0,n=3
         3 000403   000000 000010 xsym               ADSC9   FMT_BUF,Q                cn=0,n=*X0

      246    15158    4               FDS.FMT_.BOUND = LINK_NAME.COUNT + 2;

  15158  3 000404   200022 236100                    LDQ     LINK_NAME,,AUTO
         3 000405   000033 772000                    QRL     27
         3 000406   000002 036007                    ADLQ    2,DL
         3 000407   000020 736000                    QLS     16
         3 000410   000000 676000 xsym               ERQ     FDS
         3 000411   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 000412   000000 656000 xsym               ERSQ    FDS

      247    15159    4               CALL X$FORMAT (FDS);

PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:35   
  15159  3 000413   000005 630400 4                  EPPR0   5
         3 000414   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000415   000000 701000 xent               TSX1    X$FORMAT
         3 000416   000000 011000                    NOP     0

      248    15160    4               END; /*  Else  disp  */

      249    15161    3            END;  /*  Whenreturn  */

  15161  3 000417   000440 710000 3                  TRA     s:15190

      250    15162    3         WHENALTRETURN DO;

      251    15163    3            IF MERR_CODE.CODE = %E$NOKEY

  15163  3 000420   000000 236000 xsym               LDQ     ERR_CODE
         3 000421   377770 376007                    ANQ     131064,DL
         3 000422   001020 116007                    CMPQ    528,DL
         3 000423   000434 601000 3                  TNZ     s:15187

      252    15164    4            THEN DO;

      253    15165        /*E* ERROR:   ASL-E$LINK_NO_EXIST2-C
      254    15166             MESSAGE: Link %U1 does not exist.
      255    15167             MESSAGE1: The specified LINK does not exist.
      256    15168        */
      257    15169    4               AS_FIELD1 = LINK_NAME;

  15169  3 000424   000000 100500                    MLR     fill='000'O
         3 000425   200022 000011                    ADSC9   LINK_NAME,,AUTO          cn=0,n=9
         3 000426   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      258    15170                    %SCREAM( ERR#=E$LINK_NO_EXIST2, MID='L', LEVEL=ERROR );

  15182  3 000427   000012 630400 4                  EPPR0   10
         3 000430   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000431   000000 701000 xent               TSX1    ASH$ERROR
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:36   
         3 000432   000000 011000                    NOP     0

      259    15185    4               END;  /*  Error = nokey  */

  15185  3 000433   000440 710000 3                  TRA     s:15190

      260    15186    4            ELSE DO;

      261    15187    4               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );

  15187  3 000434   000014 630400 4                  EPPR0   12
         3 000435   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000436   000000 701000 xent               TSX1    ASA$ERROR
         3 000437   000000 011000                    NOP     0

      262    15188    4               END;  /* Error ~= nokey */

      263    15189    3            END;  /*  Whenaltreturn  */

      264    15190    2         RETURN;

  15190  3 000440   000000 702200 xent               TSX2  ! X66_ARET

      265    15191    2         END; /*  Else  */
      266    15192    1   CALL ASB$PREC_HLP ;

  15192  3 000441   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000442   000000 701000 xent               TSX1    ASB$PREC_HLP
         3 000443   000000 011000                    NOP     0

      267    15193    2   DO FOREVER;

      268    15194
      269    15195    3      DO UNTIL LINK$DREC.ATYP = %KLAT_LNKLINE# ;

      270    15196    3         I = DSEG1SIZE;

PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:37   
  15196  3 000444   000000 235000 xsym               LDA     DSEG1SIZE
         3 000445   200017 755100                    STA     I,,AUTO

      271    15197    3         CALL ASB$READ_HLP_SEQ(DSEG1$,I,1)

  15197  3 000446   000007 236000 4                  LDQ     7
         3 000447   200030 756100                    STQ     WILD_CARD+3,,AUTO
         3 000450   200017 630500                    EPPR0   I,,AUTO
         3 000451   200027 450500                    STP0    WILD_CARD+2,,AUTO
         3 000452   000010 236000 4                  LDQ     8
         3 000453   200026 756100                    STQ     WILD_CARD+1,,AUTO
         3 000454   200026 630500                    EPPR0   WILD_CARD+1,,AUTO
         3 000455   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000456   000000 701000 xent               TSX1    ASB$READ_HLP_SEQ
         3 000457   000461 702000 3                  TSX2    s:15199
         3 000460   000472 710000 3                  TRA     s:15202

      272    15198    4         WHENALTRETURN DO;

      273    15199    4            IF MERR_CODE.CODE ~= %E$EOF THEN CALL ASH$ERROR(MERR_CODE);

  15199  3 000461   000000 236000 xsym               LDQ     ERR_CODE
         3 000462   377770 376007                    ANQ     131064,DL
         3 000463   000060 116007                    CMPQ    48,DL
         3 000464   000471 600000 3                  TZE     s:15200

  15199  3 000465   000016 630400 4                  EPPR0   14
         3 000466   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000467   000000 701000 xent               TSX1    ASH$ERROR
         3 000470   000000 011000                    NOP     0

      274    15200    4            GOTO FINISH_UP;

  15200  3 000471   000624 710000 3                  TRA     FINISH_UP

      275    15201    4            END;  /*  Whenaltreturn  */
      276    15202    3         END;  /*  Do until we find a link record  */
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:38   

  15202  3 000472   000000 470400 xsym               LDP0    DSEG1$
         3 000473   000000 236100                    LDQ     0,,PR0
         3 000474   777000 376003                    ANQ     -512,DU
         3 000475   006000 116003                    CMPQ    3072,DU
         3 000476   000444 601000 3                  TNZ     s:15196

      277    15203    3      CALL INDEX (I,' ',USERS_KEY.TXTC) WHENALTRETURN DO;

  15203  3 000477   000000 124400                    SCM     mask='000'O
         3 000500   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         3 000501   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000502   200017 000100                    ARG     I,,AUTO
         3 000503   000505 606400 3                  TTN     s:15204
         3 000504   000507 710000 3                  TRA     s:15206

      278    15204    3         I = 8;

  15204  3 000505   000010 235007                    LDA     8,DL
         3 000506   200017 755100                    STA     I,,AUTO

      279    15205    3         END;  /*  Whenaltreturn  */

      280    15206    2      IF I > 8 THEN I = 8;

  15206  3 000507   200017 235100                    LDA     I,,AUTO
         3 000510   000011 115007                    CMPA    9,DL
         3 000511   000514 602000 3                  TNC     s:15207

  15206  3 000512   000010 236007                    LDQ     8,DL
         3 000513   200017 756100                    STQ     I,,AUTO

      281    15207    2      CURRENT_LINK = SUBSTR(USERS_KEY.TXTC,0,I);

  15207  3 000514   200017 720100                    LXL0    I,,AUTO
         3 000515   040100 100440                    MLR     fill='040'O
         3 000516   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=*X0
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:39   
         3 000517   200010 000010                    ADSC9   CURRENT_LINK,,AUTO       cn=0,n=8

      282    15208    3      IF WILD_CARD THEN DO;

  15208  3 000520   200025 234100                    SZN     WILD_CARD,,AUTO
         3 000521   000551 605000 3                  TPL     s:15218

      283    15209    3         J = LINK_NAME.COUNT;

  15209  3 000522   200022 236100                    LDQ     LINK_NAME,,AUTO
         3 000523   000033 772000                    QRL     27
         3 000524   200020 756100                    STQ     J,,AUTO

      284    15210    3         CALL ASB$WILD_MATCH (I, CURRENT_LINK, J, LINK_NAME.TEXT)

  15210  3 000525   200032 452500                    STP2    WILD_CARD+5,,AUTO
         3 000526   200032 236100                    LDQ     WILD_CARD+5,,AUTO
         3 000527   000017 036000 4                  ADLQ    15
         3 000530   200031 756100                    STQ     WILD_CARD+4,,AUTO
         3 000531   200020 630500                    EPPR0   J,,AUTO
         3 000532   200030 450500                    STP0    WILD_CARD+3,,AUTO
         3 000533   200010 631500                    EPPR1   CURRENT_LINK,,AUTO
         3 000534   200027 451500                    STP1    WILD_CARD+2,,AUTO
         3 000535   200017 633500                    EPPR3   I,,AUTO
         3 000536   200026 453500                    STP3    WILD_CARD+1,,AUTO
         3 000537   200026 630500                    EPPR0   WILD_CARD+1,,AUTO
         3 000540   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000541   000000 701000 xent               TSX1    ASB$WILD_MATCH
         3 000542   000544 702000 3                  TSX2    s:15212
         3 000543   000551 710000 3                  TRA     s:15218

      285    15211    4         WHENALTRETURN DO;

      286    15212    4            IF CURRENT_LINK > END_KEY.TEXT THEN

  15212  3 000544   040100 106500                    CMPC    fill='040'O
         3 000545   200015 000010                    ADSC9   END_KEY+1,,AUTO          cn=0,n=8
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:40   
         3 000546   200010 000010                    ADSC9   CURRENT_LINK,,AUTO       cn=0,n=8
         3 000547   000624 602000 3                  TNC     FINISH_UP

      287    15213    4               GOTO FINISH_UP;
      288    15214    4            ELSE
      289    15215    4               GOTO END_FOREVER;

  15215  3 000550   000623 710000 3                  TRA     END_FOREVER

      290    15216    4            END;  /*  Whenaltreturn  */
      291    15217    3         END; /*  WILD_CARD  */

      292    15218    2      IF DISP THEN

  15218  3 000551   200012 234100                    SZN     DISP,,AUTO
         3 000552   000562 605000 3                  TPL     s:15223

      293    15219    3      DO;

      294    15220    3         CALL ASL$DISP_ONE_LINK (JCL);

  15220  3 000553   200021 630500                    EPPR0   JCL,,AUTO
         3 000554   200026 450500                    STP0    WILD_CARD+1,,AUTO
         3 000555   200026 630500                    EPPR0   WILD_CARD+1,,AUTO
         3 000556   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000557   000000 701000 xent               TSX1    ASL$DISP_ONE_LINK
         3 000560   000000 011000                    NOP     0

      295    15221    3         END; /*  If disp  */

  15221  3 000561   000622 710000 3                  TRA     s:15233

      296    15222    3      ELSE DO;

      297    15223    4         IF DISP_LINKS = 0 THEN DO;

  15223  3 000562   200013 235100                    LDA     DISP_LINKS,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:41   
         3 000563   000601 601000 3                  TNZ     s:15228

      298    15224    4            CALL CONCAT (FMT_BUF, '%\', SUBSTR(CURRENT_LINK,0,I));

  15224  3 000564   000013 220000 2                  LDX0    DISPLAY_STR+6
         3 000565   000000 740000 xsym               STX0    FMT_BUF
         3 000566   200017 721100                    LXL1    I,,AUTO
         3 000567   040000 100540                    MLR     fill='040'O
         3 000570   200010 000011                    ADSC9   CURRENT_LINK,,AUTO       cn=0,n=*X1
         3 000571   000000 400375 xsym               ADSC9   FMT_BUF                  cn=2,n=253

      299    15225    4            FDS.FMT_.BOUND = I+1 ;

  15225  3 000572   200017 236100                    LDQ     I,,AUTO
         3 000573   000001 036007                    ADLQ    1,DL
         3 000574   000020 736000                    QLS     16
         3 000575   000000 676000 xsym               ERQ     FDS
         3 000576   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 000577   000000 656000 xsym               ERSQ    FDS

      300    15226    4            END; /*  DISP_LINKS = 0  */

  15226  3 000600   000616 710000 3                  TRA     s:15231

      301    15227    4         ELSE DO;

      302    15228    4            CALL CONCAT (FMT_BUF, '%\%-%10R', SUBSTR(CURRENT_LINK,0,I));

  15228  3 000601   000014 237000 2                  LDAQ    DISPLAY_STR+7
         3 000602   000000 755000 xsym               STA     FMT_BUF
         3 000603   000001 756000 xsym               STQ     FMT_BUF+1
         3 000604   200017 720100                    LXL0    I,,AUTO
         3 000605   040000 100540                    MLR     fill='040'O
         3 000606   200010 000010                    ADSC9   CURRENT_LINK,,AUTO       cn=0,n=*X0
         3 000607   000002 000367 xsym               ADSC9   FMT_BUF+2                cn=0,n=247

      303    15229    4            FDS.FMT_.BOUND = I + 7;
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:42   

  15229  3 000610   200017 236100                    LDQ     I,,AUTO
         3 000611   000007 036007                    ADLQ    7,DL
         3 000612   000020 736000                    QLS     16
         3 000613   000000 676000 xsym               ERQ     FDS
         3 000614   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 000615   000000 656000 xsym               ERSQ    FDS

      304    15230    4            END; /*  Else  */

      305    15231    3         CALL X$FORMAT (FDS);

  15231  3 000616   000005 630400 4                  EPPR0   5
         3 000617   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000620   000000 701000 xent               TSX1    X$FORMAT
         3 000621   000000 011000                    NOP     0

      306    15232    3         END; /*  Else  disp  */

      307    15233    2      DISP_LINKS = DISP_LINKS + 1;

  15233  3 000622   200013 054100                    AOS     DISP_LINKS,,AUTO

      308    15234    2   END_FOREVER:
      309    15235    2      END;  /*  Do forever  */

  15235  3 000623   000444 710000 3     END_FOREVER  TRA     s:15196

      310    15236    1   FINISH_UP:
      311    15237    2   IF NOT DISP THEN DO;

  15237  3 000624   200012 234100       FINISH_UP    SZN     DISP,,AUTO
         3 000625   000642 604000 3                  TMI     s:15243

      312    15238    2      FMT_BUF = '%\%/';

  15238  3 000626   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:43   
         3 000627   000016 000004 2                  ADSC9   DISPLAY_STR+9            cn=0,n=4
         3 000630   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      313    15239    2      FDS.FMT_.BOUND = 3;

  15239  3 000631   000000 236000 xsym               LDQ     FDS
         3 000632   177777 376007                    ANQ     65535,DL
         3 000633   600000 276007                    ORQ     -65536,DL
         3 000634   000000 756000 xsym               STQ     FDS

      314    15240    2      FDS.NVECS# = 0;

  15240  3 000635   000011 450000 xsym               STZ     FDS+9

      315    15241    2      CALL X$FORMAT(FDS);

  15241  3 000636   000005 630400 4                  EPPR0   5
         3 000637   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000640   000000 701000 xent               TSX1    X$FORMAT
         3 000641   000000 011000                    NOP     0

      316    15242    2      END; /*  If not disp  */

      317    15243    2   IF NOT JCL THEN DO;

  15243  3 000642   200021 234100                    SZN     JCL,,AUTO
         3 000643   000712 604000 3                  TMI     s:15264

      318    15244    2      FMT_VEC(0) = VECTOR (DISP_LINKS);

  15244  3 000644   777640 235007                    LDA     -96,DL
         3 000645   200026 452500                    STP2    WILD_CARD+1,,AUTO
         3 000646   200026 236100                    LDQ     WILD_CARD+1,,AUTO
         3 000647   000013 036003                    ADLQ    11,DU
         3 000650   000000 755000 xsym               STA     FMT_VEC
         3 000651   000001 756000 xsym               STQ     FMT_VEC+1

PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:44   
      319    15245    2      IF DISP_LINKS = 1 THEN

  15245  3 000652   200013 235100                    LDA     DISP_LINKS,,AUTO
         3 000653   000001 115007                    CMPA    1,DL
         3 000654   000661 601000 3                  TNZ     s:15250

      320    15246    3      DO;

      321    15247    3         FMT_VEC(1) = VECTOR (LINK_STR);

  15247  3 000655   000020 237000 4                  LDAQ    16
         3 000656   000002 755000 xsym               STA     FMT_VEC+2
         3 000657   000003 756000 xsym               STQ     FMT_VEC+3

      322    15248    3         END; /*  DISP_LINKS = 1  */

  15248  3 000660   000664 710000 3                  TRA     s:15252

      323    15249    3      ELSE DO;

      324    15250    3         FMT_VEC(1) = VECTOR (LINKS_STR);

  15250  3 000661   000022 237000 4                  LDAQ    18
         3 000662   000002 755000 xsym               STA     FMT_VEC+2
         3 000663   000003 756000 xsym               STQ     FMT_VEC+3

      325    15251    3         END; /*  DISP_LINKS ~= 1  */

      326    15252    2      IF DISP THEN

  15252  3 000664   200012 234100                    SZN     DISP,,AUTO
         3 000665   000672 605000 3                  TPL     s:15257

      327    15253    3      DO;

      328    15254    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);

PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:45   
  15254  3 000666   000024 237000 4                  LDAQ    20
         3 000667   000004 755000 xsym               STA     FMT_VEC+4
         3 000670   000005 756000 xsym               STQ     FMT_VEC+5

      329    15255    3         END; /*  If disp  */

  15255  3 000671   000675 710000 3                  TRA     s:15259

      330    15256    3      ELSE DO;

      331    15257    3         FMT_VEC(2) = VECTOR (LIST_STR);

  15257  3 000672   000026 237000 4                  LDAQ    22
         3 000673   000004 755000 xsym               STA     FMT_VEC+4
         3 000674   000005 756000 xsym               STQ     FMT_VEC+5

      332    15258    3         END; /*  If ~ disp  */

      333    15259    2      FDS.NVECS# = 3;

  15259  3 000675   000003 235007                    LDA     3,DL
         3 000676   000011 755000 xsym               STA     FDS+9

      334    15260    2      FMT_BUF = '   %5D %A %A.';

  15260  3 000677   040000 100400                    MLR     fill='040'O
         3 000700   000017 000015 2                  ADSC9   DISPLAY_STR+10           cn=0,n=13
         3 000701   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      335    15261    2      FDS.FMT_.BOUND = 12;

  15261  3 000702   000000 236000 xsym               LDQ     FDS
         3 000703   177777 376007                    ANQ     65535,DL
         3 000704   000003 276003                    ORQ     3,DU
         3 000705   000000 756000 xsym               STQ     FDS

      336    15262    2      CALL X$FORMAT(FDS);
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:46   

  15262  3 000706   000005 630400 4                  EPPR0   5
         3 000707   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000710   000000 701000 xent               TSX1    X$FORMAT
         3 000711   000000 011000                    NOP     0

      337    15263    2      END; /* Not jcl */

      338    15264    1   RETURN;

  15264  3 000712   000000 702200 xent               TSX2  ! X66_ARET
      339    15265    1   END ASL$LIST_ALL_LINKS;
      340    15266        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:47   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_LINKS.
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:48   

 **** Variables and constants ****

  ****  Section 002 RoData ASL$LIST_ALL_LINKS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/c CHAR(9)     r     1 DISPLAY_STR                1-0-0/c CHAR(5)     r     1 LINKS_STR
     0-0-0/c CHAR(4)     r     1 LINK_STR                   3-0-0/c CHAR(6)     r     1 LIST_STR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/b BIT         r     1 ALL_LINKS                  4-0-0/w STRC(108)   r     1 BEGIN_KEY
     7-0-0/w UBIN        r     1 CODE2                     10-0-0/c CHAR(8)     r     1 CURRENT_LINK
    12-0-0/b BIT         r     1 DISP                      13-0-0/w SBIN        r     1 DISP_LINKS
    14-0-0/w STRC(108)   r     1 END_KEY                   17-0-0/w UBIN        r     1 I
    20-0-0/w UBIN        r     1 J                         21-0-0/b BIT         r     1 JCL
    22-0-0/c STRC(81)    r     1 LINK_NAME                 25-0-0/b BIT         r     1 WILD_CARD

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w UBIN        r     1 CODE
     0-0-0/w PTR         r     1 DSEG1$                     0-0-0/w UBIN        r     1 DSEG1SIZE
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/w STRC(1080)  r     1 FDS
     0-0-0/c CHAR(255)   r     1 FMT_BUF                    0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)
     0-0-0/b STRC        r     1 MERR_CODE                  0-0-0/w PTR         r     1 NODE$
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:49   
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(576)   r     1 LINK$DREC                  0-0-0/w STRC(144)   r     1 P$B
     0-0-0/w ASTR(153)   r     1 P$S


   Procedure ASL$LIST_ALL_LINKS requires 459 words for executable code.
   Procedure ASL$LIST_ALL_LINKS requires 28 words of local(AUTO) storage.
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:50   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:51   
          MINI XREF LISTING

ALL_LINKS
     14997**DCL     15087<<ASSIGN  15089<<ASSIGN  15116>>IF
ASA$ERROR
     14783**DCL-ENT 15187--CALL
ASA_BRKS_LOC
     11915**DCL     11915--REDEF
ASB$PREC_HLP
     14771**DCL-ENT 15192--CALL
ASB$READ_HLP
     14774**DCL-ENT 15127--CALL
ASB$READ_HLP_SEQ
     14777**DCL-ENT 15197--CALL
ASB$WILD_MATCH
     14789**DCL-ENT 15210--CALL
ASH$ERROR
     14780**DCL-ENT 15147--CALL    15182--CALL    15199--CALL
ASL$DISP_ONE_LINK
     14786**DCL-ENT 15154--CALL    15220--CALL
AS_DEFAULT.BANNER_PERM
     12608**DCL     12609--REDEF
AS_DEFAULT.BUDGET.MACCT
     12513**DCL     12517--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     12526**DCL     12529--REDEF
AS_DEFAULT.BUDGET.PACCUM
     12509**DCL     12511--REDEF
AS_DEFAULT.BUDGET.PMAXC
     12504**DCL     12506--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     12624**DCL     12625--REDEF   12626--REDEF
AS_DEFAULT_DREC.PASSWORD
     13878**DCL     13882--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:52   
AS_DEFAULT_DREC.RENAME
     13901**DCL     13902--REDEF
AS_DFLT.BANNER_PERM
     12430**DCL     12431--REDEF
AS_DFLT.BUDGET.MACCT
     12335**DCL     12339--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     12348**DCL     12351--REDEF
AS_DFLT.BUDGET.PACCUM
     12331**DCL     12333--REDEF
AS_DFLT.BUDGET.PMAXC
     12326**DCL     12328--REDEF
AS_DFLT.SETUP_CHRA.TXT
     12446**DCL     12447--REDEF   12448--REDEF
AS_FE_MODE
     11781**DCL     11782--REDEF
AS_FIELD1
     11911**DCL     15134<<ASSIGN  15169<<ASSIGN
AS_MODE
     11778**DCL     11780--REDEF
AS_MOD_USER.ACCESS
     14643**DCL     14644--REDEF
AS_MOD_USER.BANNER
     14630**DCL     14631--REDEF
AS_MOD_USER.BANNER_PERM
     14632**DCL     14633--REDEF
AS_MOD_USER.BILL
     14638**DCL     14639--REDEF
AS_MOD_USER.CPROC
     14634**DCL     14635--REDEF
AS_MOD_USER.FEBILL
     14714**DCL     14715--REDEF
AS_MOD_USER.FECXTMEM
     14731**DCL     14732--REDEF
AS_MOD_USER.FEMINTS
     14716**DCL     14717--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:53   
AS_MOD_USER.FEMMEM
     14727**DCL     14728--REDEF
AS_MOD_USER.FEMTIME
     14725**DCL     14726--REDEF
AS_MOD_USER.FEPPRIV
     14722**DCL     14724--REDEF
AS_MOD_USER.FEPRIV
     14719**DCL     14721--REDEF
AS_MOD_USER.FORCE_BIT
     14628**DCL     14629--REDEF
AS_MOD_USER.KEY
     14710**DCL     14712--REDEF
AS_MOD_USER.LASTCPROC
     14636**DCL     14637--REDEF
AS_MOD_USER.LIMITS.DO_
     14684**DCL     14685--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     14700**DCL     14701--REDEF
AS_MOD_USER.LIMITS.LO
     14680**DCL     14681--REDEF
AS_MOD_USER.LIMITS.MEM
     14676**DCL     14677--REDEF
AS_MOD_USER.LIMITS.MPRIO
     14704**DCL     14705--REDEF
AS_MOD_USER.LIMITS.PDIS
     14692**DCL     14693--REDEF
AS_MOD_USER.LIMITS.PO
     14688**DCL     14689--REDEF
AS_MOD_USER.LIMITS.TDIS
     14696**DCL     14697--REDEF
AS_MOD_USER.LIMITS.TIME
     14672**DCL     14673--REDEF
AS_MOD_USER.MAXENQ
     14653**DCL     14654--REDEF
AS_MOD_USER.PERM_BIT
     14626**DCL     14627--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:54   
AS_MOD_USER.PPRIV
     14648**DCL     14650--REDEF
AS_MOD_USER.PRIOB
     14655**DCL     14656--REDEF
AS_MOD_USER.PRIV
     14645**DCL     14647--REDEF
AS_MOD_USER.QUAN
     14651**DCL     14652--REDEF
AS_MOD_USER.SETUP
     14624**DCL     14625--REDEF
AS_PROJECT.BANNER_PERM
     12964**DCL     12965--REDEF
AS_PROJECT.BUDGET.MACCT
     12869**DCL     12873--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12882**DCL     12885--REDEF
AS_PROJECT.BUDGET.PACCUM
     12865**DCL     12867--REDEF
AS_PROJECT.BUDGET.PMAXC
     12860**DCL     12862--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12980**DCL     12981--REDEF   12982--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     13142**DCL     13143--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     13047**DCL     13051--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     13060**DCL     13063--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     13043**DCL     13045--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     13038**DCL     13040--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     13158**DCL     13159--REDEF   13160--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     14364**DCL     14368--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:55   
AS_PROJECT_DFLT_DREC.RENAME
     14387**DCL     14388--REDEF
AS_PROJECT_DREC.PASSWORD
     14202**DCL     14206--REDEF
AS_PROJECT_DREC.RENAME
     14225**DCL     14226--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12786**DCL     12787--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     12691**DCL     12695--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     12704**DCL     12707--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     12687**DCL     12689--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     12682**DCL     12684--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12802**DCL     12803--REDEF   12804--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     14040**DCL     14044--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     14063**DCL     14064--REDEF
AS_USERS.BANNER_PERM
     12252**DCL     12253--REDEF
AS_USERS.BUDGET.MACCT
     12157**DCL     12161--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     12170**DCL     12173--REDEF
AS_USERS.BUDGET.PACCUM
     12153**DCL     12155--REDEF
AS_USERS.BUDGET.PMAXC
     12148**DCL     12150--REDEF
AS_USERS.SETUP_CHRA.TXT
     12268**DCL     12269--REDEF   12270--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     13320**DCL     13321--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:56   
AS_USERS_CONSTANT.BUDGET.MACCT
     13225**DCL     13229--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     13238**DCL     13241--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     13221**DCL     13223--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     13216**DCL     13218--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     13336**DCL     13337--REDEF   13338--REDEF
BEGIN_KEY.COUNT
     14999**DCL     15094<<ASSIGN
BEGIN_KEY.TEXT
     15000**DCL     15090<<ASSIGN  15093<<ASSIGN  15120>>CALLBLT
CODE
     11908**DCL     15027<<ASSIGN  15035>>DOSELCT
CODE2
     15001**DCL     15067<<ASSIGN  15069>>DOSELCT
CURRENT_LINK
     15002**DCL     15207<<ASSIGN  15210<>CALL    15212>>IF      15224>>CALLBLT 15228>>CALLBLT
DISP
     15003**DCL     15033<<ASSIGN  15039<<ASSIGN  15044<<ASSIGN  15056<<ASSIGN  15065<<ASSIGN  15152>>IF
     15218>>IF      15237>>IF      15252>>IF
DISPLAY_STR
     15022**DCL     15254--ASSIGN
DISP_LINKS
     15004**DCL     15032<<ASSIGN  15223>>IF      15233<<ASSIGN  15233>>ASSIGN  15244--ASSIGN  15245>>IF
DSEG1$
     11916**DCL     14894--IMP-PTR 15127<>CALL    15129>>IF      15195>>DOUNTIL 15197<>CALL
DSEG1SIZE
     11917**DCL     15126>>ASSIGN  15196>>ASSIGN
END_FOREVER
     15235**LABEL   15215--GOTO
END_KEY.COUNT
     15006**DCL     15096<<ASSIGN
END_KEY.TEXT
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:57   
     15007**DCL     15091<<ASSIGN  15095<<CALLBLT 15212>>IF
ERR_CODE
     11910**DCL     11911--REDEF
FDS
     11807**DCL     15114<>CALL    15159<>CALL    15231<>CALL    15241<>CALL    15262<>CALL
FDS.FMT_.BOUND
     11812**DCL     15107<<ASSIGN  15111<<ASSIGN  15158<<ASSIGN  15225<<ASSIGN  15229<<ASSIGN  15239<<ASSIGN
     15261<<ASSIGN
FDS.NVECS#
     11835**DCL     15104<<ASSIGN  15240<<ASSIGN  15259<<ASSIGN
FDS.TABDFLT#
     11873**DCL     15113<<ASSIGN
FINISH_UP
     15237**LABEL   15200--GOTO    15213--GOTO
FMT_BUF
     11906**DCL     15106<<CALLBLT 15110<<CALLBLT 15157<<CALLBLT 15224<<CALLBLT 15228<<CALLBLT 15238<<ASSIGN
     15260<<ASSIGN
FMT_VEC
     11906**DCL     15244<<ASSIGN  15247<<ASSIGN  15250<<ASSIGN  15254<<ASSIGN  15257<<ASSIGN
I
     15008**DCL     15066<<DOINDEX 15067>>ASSIGN  15092<<CALLBLT 15093>>ASSIGN  15095>>CALLBLT 15096>>ASSIGN
     15126<<ASSIGN  15127<>CALL    15196<<ASSIGN  15197<>CALL    15203<<CALLBLT 15204<<ASSIGN  15206>>IF
     15206<<ASSIGN  15207>>ASSIGN  15210<>CALL    15224>>CALLBLT 15225>>ASSIGN  15228>>CALLBLT 15229>>ASSIGN
J
     15009**DCL     15209<<ASSIGN  15210<>CALL
JCL
     15010**DCL     15028<<ASSIGN  15040<<ASSIGN  15047<<ASSIGN  15050<<ASSIGN  15057<<ASSIGN  15078<<ASSIGN
     15105>>IF      15154<>CALL    15220<>CALL    15243>>IF
KL_DEFAULT.PASSWORD
     14526**DCL     14530--REDEF
KL_DEFAULT.RENAME
     14549**DCL     14550--REDEF
KL_DFLT.PASSWORD
     13716**DCL     13720--REDEF
KL_DFLT.RENAME
     13739**DCL     13740--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:58   
KL_DREC.PASSWORD
     13554**DCL     13558--REDEF
KL_DREC.RENAME
     13577**DCL     13578--REDEF
KL_DREC_CNT.PASSWORD
     13441**DCL     13445--REDEF
KL_DREC_CNT.RENAME
     13464**DCL     13465--REDEF
LINK$DREC.ATYP
     14899**DCL     15129>>IF      15195>>DOUNTIL
LINK$DREC.PASSWORD
     14952**DCL     14956--REDEF
LINK$DREC.RENAME
     14975**DCL     14976--REDEF
LINKS_STR
     15020**DCL     15106>>CALLBLT 15107--ASSIGN  15110>>CALLBLT 15111--ASSIGN  15250--ASSIGN
LINK_NAME
     15011**DCL     15134>>ASSIGN  15169>>ASSIGN
LINK_NAME.COUNT
     15012**DCL     15031<<ASSIGN  15060<<ASSIGN  15074<<ASSIGN  15157>>CALLBLT 15158>>ASSIGN  15209>>ASSIGN
LINK_NAME.TEXT
     15013**DCL     15030<<ASSIGN  15059<<ASSIGN  15073<<ASSIGN  15086>>IF      15092>>CALLBLT 15093>>ASSIGN
     15095>>CALLBLT 15124>>CALLBLT 15157>>CALLBLT 15210<>CALL
LINK_STR
     15019**DCL     15247--ASSIGN
LIST_STR
     15021**DCL     15257--ASSIGN
MERR_CODE
     11911**DCL     15199<>CALL
MERR_CODE.CODE
     11911**DCL     15163>>IF      15199>>IF
NODE$
     11908**DCL     14802--IMP-PTR
P$B.CODE
     14810**DCL     15027>>ASSIGN  15046>>IF      15049>>IF      15067>>ASSIGN
P$B.NSUBLKS
PL6.E3A0      #001=ASL$LIST_ALL_LINKS File=ASL$LIST_LINKS.:E05TSI                TUE 07/29/97 10:16 Page:59   
     14814**DCL     15045>>IF      15048>>IF      15058>>IF      15066>>DOINDEX
P$B.SUBLK$
     14835**DCL     15027>>ASSIGN  15045>>IF      15046>>IF      15046>>IF      15048>>IF      15049>>IF
     15049>>IF      15059>>ASSIGN  15059>>ASSIGN  15060>>ASSIGN  15067>>ASSIGN  15073>>ASSIGN  15073>>ASSIGN
     15074>>ASSIGN
P$S.COUNT
     14871**DCL     14874--IMP-SIZ 15059>>ASSIGN  15060>>ASSIGN  15073>>ASSIGN  15074>>ASSIGN
P$S.TEXT
     14874**DCL     15059>>ASSIGN  15073>>ASSIGN
PROJ_KEY.TEXT
     11788**DCL     11788--REDEF
PROJ_KEY.TXT.PROJECT
     11788**DCL     11788--REDEF
P_PCB.OUT$
     11956**DCL     15027>>ASSIGN  15045>>IF      15046>>IF      15048>>IF      15049>>IF      15058>>IF
     15059>>ASSIGN  15059>>ASSIGN  15060>>ASSIGN  15066>>DOINDEX 15067>>ASSIGN  15073>>ASSIGN  15073>>ASSIGN
     15074>>ASSIGN
REMEM_VAR
     11914**DCL     11914--REDEF
REM_FCMD
     11914**DCL     11915--REDEF
USERS_KEY
     11785**DCL     15117<<ASSIGN  15187<>CALL
USERS_KEY.COUNT
     11785**DCL     15121<<ASSIGN  15125<<ASSIGN
USERS_KEY.TEXT
     11785**DCL     11786--REDEF   11786--REDEF   11786--REDEF   11787--REDEF
USERS_KEY.TXTC
     11786**DCL     15120<<CALLBLT 15124<<CALLBLT 15203>>CALLBLT 15207>>ASSIGN
WILD_CARD
     15014**DCL     15029<<ASSIGN  15097<<ASSIGN  15100<<ASSIGN  15119>>IF      15208>>IF
X$FORMAT
     14791**DCL-ENT 15114--CALL    15159--CALL    15231--CALL    15241--CALL    15262--CALL

PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:60   
      341        1        /*T***********************************************************/
      342        2        /*T*                                                         */
      343        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      344        4        /*T*                                                         */
      345        5        /*T***********************************************************/
      346        6        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:61   
      347        7        /*M* ASL$DISP_ONE_LINK: External routine to display links.    */
      348        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
      349        9              ECU=3,CSU=3,SDI=3                                           */
      350       10        ASL$DISP_ONE_LINK: PROC (JCL);
      351       11        /**********************************************************/
      352       12
      353       13        /*D* NAME:     ASL$DISP_ONE_LINK
      354       14             CALL:     CALL ASL$DISP_ONE_LINK (JCL)
      355       15             INPUT:    JCL - bit set for JCL type display.
      356       16             OUTPUT:   Nothing is returned.
      357       17             DESCRIPTION:  ASL$DISP_ONE_LINK is the routine to handle
      358       18                           the DISP LINK option for SUPER.  ASL$DISP_ONE_LINK
      359       19                           displays the link that is in data segment 1.
      360       20        */
      361       21        /********************************************************************/
      362       22        /*   Include files   include files   include files   include files  */
      363       23        /********************************************************************/
      364       24        %INCLUDE AS_PERR_C;
      365      626        %INCLUDE AS_SUPER_C;
      366     1061        %INCLUDE AS_SUBS_C;
      367     2475        %INCLUDE AS_MAC_C;
      368     2555        %INCLUDE AS_ENTRIES_M;
      369     3605        %INCLUDE OCI_SUBS_C;
      370     3703        %INCLUDE AS_SSUBS_C;
      371     3795        %INCLUDE B_ERRORS_C;
      372     4922        %INCLUDE CP_6;
      373     5003        %INCLUDE CP_6_SUBS;
      374     5543        %INCLUDE KL_SUPER_C;
      375     8445        %INCLUDE XU_MACRO_C;
      376    11551        %INCLUDE XU_FORMAT_C;
      377    11713        %INCLUDE AS_SUPER_R;
      378    14729        /********************************************************************/
      379    14730        /*   Parameters      parameters      parameters      parameters     */
      380    14731        /********************************************************************/
      381    14732    1   DCL JCL BIT(1);
      382    14733        /********************************************************************/
      383    14734        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:62   
      384    14735        /********************************************************************/
      385    14736        %ASB$WRITE_LO ;
      386    14739        %ASL$FIND_VIRCIR ;
      387    14742        %ASL$DISP_ONE_VIRCIR ;
      388    14745        %ASL$FIND_LINKDEV ;
      389    14748        %ASL$DISP_ONE_LINKDEV ;
      390    14751    1   DCL X$FORMAT ENTRY(1) ;
      391    14752        /********************************************************************/
      392    14753        /*   Local based     local based     local based     local based    */
      393    14754        /********************************************************************/
      394    14755        %KL_DREC      ( NAME      = LINK$DREC,
      395    14756                        STCLASS   = "BASED(DSEG1$)",
      396    14757                        LAST      = ",");
      397    14870        %KL_LNK       ( NAME      = LNK,
      398    14871                        LVL       = 2,
      399    14872                        STCLASS   = BASED,
      400    14873                        LAST      = ";");
      401    15097        %KL_LNKVC     ( NAME      = KL$LNKVC,
      402    15098                        LVL       = 1,
      403    15099                        STCLASS   = "BASED (VC$)" );
      404    15323    1   DCL 1 TEXT$C BASED ALIGNED,
      405    15324    1          2 CNT                 UBIN(9) UNAL ,
      406    15325    1          2 TEXT                CHAR(TEXT$C.CNT) UNAL;
      407    15326        /********************************************************************/
      408    15327        /*   Auto data       auto data       auto data       auto data      */
      409    15328        /********************************************************************/
      410    15329    1   DCL ADDRESS(0:13)          CHAR(1) ;
      411    15330    1   DCL ARS                    UBIN;
      412    15331    1   DCL HIC_TEMP               UBIN STATIC;
      413    15332    1   DCL HOC_TEMP               UBIN STATIC;
      414    15333    1   DCL I                      UBIN;
      415    15334    1   DCL J                      UBIN;
      416    15335    1   DCL LIC_TEMP               UBIN STATIC;
      417    15336    1   DCL LINKDEV$               PTR;
      418    15337    1   DCL LINK_NAME              CHAR(8);
      419    15338    1   DCL LOC_TEMP               UBIN STATIC;
      420    15339    1   DCL NEW_LINK               BIT(1);
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:63   
      421    15340    1   DCL VAL                    SBIN ;
      422    15341    1   DCL VC$                    PTR;
      423    15342        /********************************************************************/
      424    15343        /*   Constant data   constant data   constant data   constant data  */
      425    15344        /********************************************************************/
      426    15345    1   DCL DCE_STR                CHAR(0) CONSTANT INIT ('DCE');
      427    15346    1   DCL DTE_STR                CHAR(0) CONSTANT INIT ('DTE');
      428    15347    1   DCL LINK_STR               CHAR(0) CONSTANT INIT('LINK');
      429    15348    1   DCL 1 LINKDEV_NAME CONSTANT,
      430    15349    1          2 COUNT             UBIN BYTE UNAL INIT (1),
      431    15350    1          2 TEXT              CHAR(8) UNAL INIT ('?   ');
      432    15351    1   DCL LINK_HDR_JCL_FMT       CHAR(0) CONSTANT INIT
      433    15352    1            ('CREATE LINK %>A%/PRO=%>A;  ADDRESS=%>A;  MODE=%A');
      434    15353    1   DCL LINK_CHAN_JCL_FMT      CHAR(0) CONSTANT
      435    15354    1      INIT('LIC=%4D;  HIC=%4D;  LOC=%4D;  HOC=%4D;  DEFAULT VC PRO = %A');
      436    15355    1   DCL LINK_DEST_JCL_FMT      CHAR(0) CONSTANT INIT ('DEST = %>A;');
      437    15356    1   DCL LINK_QOS_JCL_FMT      CHAR(0) CONSTANT INIT ('QOS = %3D');
      438    15357    1   DCL LINK_HDR_FMT           CHAR(0) CONSTANT INIT
      439    15358    1            ('LINK %>A  PRO=%>A  ADDRESS=%>A  MODE=%A');
      440    15359    1   DCL LINK_CHAN_FMT          CHAR(0) CONSTANT
      441    15360    1      INIT('LIC=%4D   HIC=%4D   LOC=%4D   HOC=%4D  DEFAULT VC PRO = %A');
      442    15361    1   DCL LINK_DEST_FMT          CHAR(0) CONSTANT
      443    15362    1      INIT('DEST = %A   QOS = %3D');
      444    15363    1   DCL 1 VC_NAME CONSTANT,
      445    15364    1          2 COUNT             UBIN BYTE UNAL INIT (1),
      446    15365    1          2 TEXT              CHAR(4) UNAL INIT ('?   ');
      447    15366        %KL_LNKVC ( NAME = KL_LNKVC,
      448    15367                    LVL  = 1,
      449    15368                    STCLASS = CONSTANT );
      450    15592        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:64   
      451    15593        /********************************************************************/
      452    15594        /*   Procedure       procedure       procedure       procedure      */
      453    15595        /********************************************************************/
      454    15596                                                  /* List link info. */
      455    15597    1   LINK_NAME = SUBSTR (USERS_KEY.TXTC,0,8);
      456    15598    1   NEW_LINK = %YES#;
      457    15599    1   CALL ASB$WRITE_LO( AS_BLANK, 1 );
      458    15600    1   FMT_VEC(0) = VECTOR( SUBSTR(USERS_KEY.TXTC,0,8) );
      459    15601    1   FMT_VEC(1) = VECTOR(ADDR(LINK$DREC.PNAME)->TEXT$C.TEXT);
      460    15602    1   FMT_VEC(2) = VECTOR( ADDRESS ) ;
      461    15603    2   DO J = 0 TO 6 ;
      462    15604    2      VAL = LINK$DREC.LNK.ADR.ADR.BCD1#(J) ;
      463    15605    2      CALL BINCHAR( ADDRESS( J*2 ), VAL ) ;
      464    15606    2      VAL = LINK$DREC.LNK.ADR.ADR.BCD2#(J) ;
      465    15607    2      CALL BINCHAR( ADDRESS( J*2+1), VAL ) ;
      466    15608    2      END ;
      467    15609    2   DO J = LINK$DREC.LNK.ADR.LNG# TO 14;
      468    15610    2      ADDRESS (J) = ' ';
      469    15611    2      END;
      470    15612    1   IF LINK$DREC.LNK.MODE# = %LINK_DCE_VAL THEN
      471    15613    1      FMT_VEC(3) = VECTOR (DCE_STR);
      472    15614    1   ELSE
      473    15615    1      FMT_VEC(3) = VECTOR (DTE_STR);
      474    15616    2   IF JCL THEN DO;
      475    15617    2      FMT_BUF = LINK_HDR_JCL_FMT;
      476    15618    2      FDS.FMT_.BOUND = SIZEV(LINK_HDR_JCL_FMT);
      477    15619    2      END; /*  Jcl  */
      478    15620    2   ELSE DO;
      479    15621    2      FMT_BUF = LINK_HDR_FMT;
      480    15622    2      FDS.FMT_.BOUND = SIZEV(LINK_HDR_FMT);
      481    15623    2      END; /*   Not jcl   */
      482    15624    1   FDS.NVECS# = 4;
      483    15625    1   CALL X$FORMAT( FDS );
      484    15626
      485    15627    2   IF JCL THEN DO;
      486    15628    2      FMT_BUF = LINK_CHAN_JCL_FMT;
      487    15629    2      FDS.FMT_.BOUND = SIZEC (LINK_CHAN_JCL_FMT);
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:65   
      488    15630    2      END; /*  Jcl  */
      489    15631    2   ELSE DO;
      490    15632    2      FMT_BUF = LINK_CHAN_FMT;
      491    15633    2      FDS.FMT_.BOUND = SIZEC (LINK_CHAN_FMT);
      492    15634    2      END; /*  Not jcl  */
      493    15635    1   FDS.NVECS# = 5;
      494    15636    1   LIC_TEMP = LINK$DREC.LNK.LIC;
      495    15637    1   HIC_TEMP = LINK$DREC.LNK.HIC;
      496    15638    1   LOC_TEMP = LINK$DREC.LNK.LOC;
      497    15639    1   HOC_TEMP = LINK$DREC.LNK.HOC;
      498    15640    1   FMT_VEC(0) = VECTOR (LIC_TEMP);
      499    15641    1   FMT_VEC(1) = VECTOR (HIC_TEMP);
      500    15642    1   FMT_VEC(2) = VECTOR (LOC_TEMP);
      501    15643    1   FMT_VEC(3) = VECTOR (HOC_TEMP);
      502    15644    1   FMT_VEC(4) = VECTOR (LINK$DREC.LNK.DFLTVCPRO.TXT);
      503    15645    1   CALL X$FORMAT (FDS);
      504    15646
      505    15647    2   IF NOT JCL THEN DO;
      506    15648    2      FMT_BUF = LINK_DEST_FMT ;
      507    15649    2      FDS.FMT_.BOUND = SIZEV(LINK_DEST_FMT);
      508    15650    2      END; /*  Not jcl  */
      509    15651    1   FDS.NVECS# = 2;
      510    15652    1   FMT_VEC(0) = VECTOR( ADDRESS ) ;
      511    15653    2   DO J = 0 TO 6 ;
      512    15654    2      VAL = LINK$DREC.LNK.DEST.ADR.BCD0(J) ;
      513    15655    2      CALL BINCHAR( ADDRESS( J*2 ), VAL ) ;
      514    15656    2      VAL = LINK$DREC.LNK.DEST.ADR.BCD1(J) ;
      515    15657    2      CALL BINCHAR( ADDRESS( J*2+1), VAL ) ;
      516    15658    2      END ;
      517    15659
      518    15660    2   DO J = LINK$DREC.LNK.DEST.LEN TO 14;
      519    15661    2      ADDRESS (J) = ' ';
      520    15662    2      END;
      521    15663    2   IF JCL THEN DO;
      522    15664    3      IF ADDRESS(0) = ' ' THEN DO;
      523    15665    3         FMT_BUF = LINK_QOS_JCL_FMT ;
      524    15666    3         FDS.FMT_.BOUND = SIZEV(LINK_QOS_JCL_FMT);
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:66   
      525    15667    3         FMT_VEC(0) = VECTOR( LINK$DREC.LNK.QOS# );
      526    15668    3         FDS.NVECS# = 1;
      527    15669    3         END;  /*  Address is blank  */
      528    15670    3      ELSE DO;
      529    15671    3         CALL CONCAT (FMT_BUF, LINK_DEST_JCL_FMT, LINK_QOS_JCL_FMT);
      530    15672    3         FDS.FMT_.BOUND = SIZEC(LINK_DEST_JCL_FMT) + SIZEC (LINK_QOS_JCL_FMT) - 1;
      531    15673    3         FMT_VEC(1) = VECTOR( LINK$DREC.LNK.QOS# );
      532    15674    3         END;  /*  Not blank address  */
      533    15675    2      END;  /*  Jcl  */
      534    15676    2   ELSE DO;
      535    15677    3      IF ADDRESS(0) = ' ' THEN DO;
      536    15678    3         FMT_BUF = LINK_QOS_JCL_FMT ;
      537    15679    3         FDS.FMT_.BOUND = SIZEV(LINK_QOS_JCL_FMT);
      538    15680    3         FMT_VEC(0) = VECTOR( LINK$DREC.LNK.QOS# );
      539    15681    3         FDS.NVECS# = 1;
      540    15682    3         END;  /*  Address is blank  */
      541    15683    3      ELSE DO;
      542    15684    3         FMT_BUF = LINK_DEST_FMT;
      543    15685    3         FDS.FMT_.BOUND = SIZEV(LINK_DEST_FMT);
      544    15686    3         FMT_VEC(1) = VECTOR( LINK$DREC.LNK.QOS# );
      545    15687    3         END;  /*  Not blank address  */
      546    15688    2      END; /* If not jcl */
      547    15689    1   CALL X$FORMAT( FDS );
      548    15690    1   IF JCL THEN
      549    15691    1      CALL ASB$WRITE_LO ('   END',6);
      550    15692
      551    15693    1   VC$ = DSEG1$;
      552    15694    1   ARS = SIZEW (LINK$DREC) + LINK$DREC.NWINFO;
      553    15695    2   DO FOREVER;
      554    15696    2      CALL ASL$FIND_VIRCIR (DSEG1$, ARS, VC_NAME, VC$) ALTRET (END_FOREVER);
      555    15697    2      CALL ASL$DISP_ONE_VIRCIR (VC$, NEW_LINK, JCL, LINK_NAME);
      556    15698    2      NEW_LINK = %NO#;
      557    15699    2      END;  /*  Do forever  */
      558    15700    1   END_FOREVER:
      559    15701    1   LINKDEV$ = DSEG1$;
      560    15702    1   NEW_LINK = %YES#;
      561    15703    2   DO FOREVER;
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:67   
      562    15704    2      CALL ASL$FIND_LINKDEV (DSEG1$, ARS, LINKDEV_NAME, LINKDEV$) ALTRET (END_FOREVER2)
             15704               ;
      563    15705    2      CALL ASL$DISP_ONE_LINKDEV (LINKDEV$, NEW_LINK, JCL, LINK_NAME);
      564    15706    2      NEW_LINK = %NO#;
      565    15707    2      END;  /*  Do FOREVER2  */
      566    15708    1   END_FOREVER2:
      567    15709    1   RETURN ;
      568    15710    1   END ASL$DISP_ONE_LINK;

PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:68   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_LINK.

   Procedure ASL$DISP_ONE_LINK requires 363 words for executable code.
   Procedure ASL$DISP_ONE_LINK requires 22 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_LINKS.:E05TSI    .

PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:69   

 Object Unit name= ASL$DISP_ONE_LINK                          File name= ASL$LIST_LINKS.:E05TOU
 UTS= JUL 29 '97 10:17:39.32 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   Data  even  none     4      4  ASL$DISP_ONE_LINK
    3  RoData even  UTS     86    126  ASL$DISP_ONE_LINK
    4   Proc  even  none   363    553  ASL$DISP_ONE_LINK
    5  RoData even  none    32     40  ASL$DISP_ONE_LINK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        1  ASL$DISP_ONE_LINK

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASB$WRITE_LO
         yes           Std       4 ASL$DISP_ONE_VIRCIR
 yes     yes           Std       4 ASL$FIND_VIRCIR
         yes           Std       1 X$FORMAT
 yes     yes           Std       4 ASL$FIND_LINKDEV
         yes           Std       4 ASL$DISP_ONE_LINKDEV
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:70   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_BLANK                         r    AS_MODE
r    AS_FE_MODE                            M$LO                                  USERS_KEY
     FDS                                   FMT_BUF                               FMT_VEC
     ERR_CODE                              REMEM_VAR                             REM_FCMD
     ASA_BRKS_LOC                          DSEG1$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:71   


      341        1        /*T***********************************************************/
      342        2        /*T*                                                         */
      343        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      344        4        /*T*                                                         */
      345        5        /*T***********************************************************/
      346        6        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:72   
      347        7        /*M* ASL$DISP_ONE_LINK: External routine to display links.    */
      348        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
      349        9              ECU=3,CSU=3,SDI=3                                           */
      350       10        ASL$DISP_ONE_LINK: PROC (JCL);

     10  4 000000   000000 700200 xent  ASL$DISP_ON* TSX0  ! X66_AUTO_1
         4 000001   000026 000001                    ZERO    22,1

      351       11        /**********************************************************/
      352       12
      353       13        /*D* NAME:     ASL$DISP_ONE_LINK
      354       14             CALL:     CALL ASL$DISP_ONE_LINK (JCL)
      355       15             INPUT:    JCL - bit set for JCL type display.
      356       16             OUTPUT:   Nothing is returned.
      357       17             DESCRIPTION:  ASL$DISP_ONE_LINK is the routine to handle
      358       18                           the DISP LINK option for SUPER.  ASL$DISP_ONE_LINK
      359       19                           displays the link that is in data segment 1.
      360       20        */
      361       21        /********************************************************************/
      362       22        /*   Include files   include files   include files   include files  */
      363       23        /********************************************************************/
      364       24        %INCLUDE AS_PERR_C;
      365      626        %INCLUDE AS_SUPER_C;
      366     1061        %INCLUDE AS_SUBS_C;
      367     2475        %INCLUDE AS_MAC_C;
      368     2555        %INCLUDE AS_ENTRIES_M;
      369     3605        %INCLUDE OCI_SUBS_C;
      370     3703        %INCLUDE AS_SSUBS_C;
      371     3795        %INCLUDE B_ERRORS_C;
      372     4922        %INCLUDE CP_6;
      373     5003        %INCLUDE CP_6_SUBS;
      374     5543        %INCLUDE KL_SUPER_C;
      375     8445        %INCLUDE XU_MACRO_C;
      376    11551        %INCLUDE XU_FORMAT_C;
      377    11713        %INCLUDE AS_SUPER_R;
      378    14729        /********************************************************************/
      379    14730        /*   Parameters      parameters      parameters      parameters     */
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:73   
      380    14731        /********************************************************************/
      381    14732    1   DCL JCL BIT(1);
      382    14733        /********************************************************************/
      383    14734        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      384    14735        /********************************************************************/
      385    14736        %ASB$WRITE_LO ;
      386    14739        %ASL$FIND_VIRCIR ;
      387    14742        %ASL$DISP_ONE_VIRCIR ;
      388    14745        %ASL$FIND_LINKDEV ;
      389    14748        %ASL$DISP_ONE_LINKDEV ;
      390    14751    1   DCL X$FORMAT ENTRY(1) ;
      391    14752        /********************************************************************/
      392    14753        /*   Local based     local based     local based     local based    */
      393    14754        /********************************************************************/
      394    14755        %KL_DREC      ( NAME      = LINK$DREC,
      395    14756                        STCLASS   = "BASED(DSEG1$)",
      396    14757                        LAST      = ",");
      397    14870        %KL_LNK       ( NAME      = LNK,
      398    14871                        LVL       = 2,
      399    14872                        STCLASS   = BASED,
      400    14873                        LAST      = ";");
      401    15097        %KL_LNKVC     ( NAME      = KL$LNKVC,
      402    15098                        LVL       = 1,
      403    15099                        STCLASS   = "BASED (VC$)" );
      404    15323    1   DCL 1 TEXT$C BASED ALIGNED,
      405    15324    1          2 CNT                 UBIN(9) UNAL ,
      406    15325    1          2 TEXT                CHAR(TEXT$C.CNT) UNAL;
      407    15326        /********************************************************************/
      408    15327        /*   Auto data       auto data       auto data       auto data      */
      409    15328        /********************************************************************/
      410    15329    1   DCL ADDRESS(0:13)          CHAR(1) ;
      411    15330    1   DCL ARS                    UBIN;
      412    15331    1   DCL HIC_TEMP               UBIN STATIC;
      413    15332    1   DCL HOC_TEMP               UBIN STATIC;
      414    15333    1   DCL I                      UBIN;
      415    15334    1   DCL J                      UBIN;
      416    15335    1   DCL LIC_TEMP               UBIN STATIC;
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:74   
      417    15336    1   DCL LINKDEV$               PTR;
      418    15337    1   DCL LINK_NAME              CHAR(8);
      419    15338    1   DCL LOC_TEMP               UBIN STATIC;
      420    15339    1   DCL NEW_LINK               BIT(1);
      421    15340    1   DCL VAL                    SBIN ;
      422    15341    1   DCL VC$                    PTR;
      423    15342        /********************************************************************/
      424    15343        /*   Constant data   constant data   constant data   constant data  */
      425    15344        /********************************************************************/
      426    15345    1   DCL DCE_STR                CHAR(0) CONSTANT INIT ('DCE');
      427    15346    1   DCL DTE_STR                CHAR(0) CONSTANT INIT ('DTE');
      428    15347    1   DCL LINK_STR               CHAR(0) CONSTANT INIT('LINK');
      429    15348    1   DCL 1 LINKDEV_NAME CONSTANT,
      430    15349    1          2 COUNT             UBIN BYTE UNAL INIT (1),
      431    15350    1          2 TEXT              CHAR(8) UNAL INIT ('?   ');
      432    15351    1   DCL LINK_HDR_JCL_FMT       CHAR(0) CONSTANT INIT
      433    15352    1            ('CREATE LINK %>A%/PRO=%>A;  ADDRESS=%>A;  MODE=%A');
      434    15353    1   DCL LINK_CHAN_JCL_FMT      CHAR(0) CONSTANT
      435    15354    1      INIT('LIC=%4D;  HIC=%4D;  LOC=%4D;  HOC=%4D;  DEFAULT VC PRO = %A');
      436    15355    1   DCL LINK_DEST_JCL_FMT      CHAR(0) CONSTANT INIT ('DEST = %>A;');
      437    15356    1   DCL LINK_QOS_JCL_FMT      CHAR(0) CONSTANT INIT ('QOS = %3D');
      438    15357    1   DCL LINK_HDR_FMT           CHAR(0) CONSTANT INIT
      439    15358    1            ('LINK %>A  PRO=%>A  ADDRESS=%>A  MODE=%A');
      440    15359    1   DCL LINK_CHAN_FMT          CHAR(0) CONSTANT
      441    15360    1      INIT('LIC=%4D   HIC=%4D   LOC=%4D   HOC=%4D  DEFAULT VC PRO = %A');
      442    15361    1   DCL LINK_DEST_FMT          CHAR(0) CONSTANT
      443    15362    1      INIT('DEST = %A   QOS = %3D');
      444    15363    1   DCL 1 VC_NAME CONSTANT,
      445    15364    1          2 COUNT             UBIN BYTE UNAL INIT (1),
      446    15365    1          2 TEXT              CHAR(4) UNAL INIT ('?   ');
      447    15366        %KL_LNKVC ( NAME = KL_LNKVC,
      448    15367                    LVL  = 1,
      449    15368                    STCLASS = CONSTANT );
      450    15592        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:75   
      451    15593        /********************************************************************/
      452    15594        /*   Procedure       procedure       procedure       procedure      */
      453    15595        /********************************************************************/
      454    15596                                                  /* List link info. */
      455    15597    1   LINK_NAME = SUBSTR (USERS_KEY.TXTC,0,8);

  15597  4 000002   040100 100400                    MLR     fill='040'O
         4 000003   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 000004   200014 000010                    ADSC9   LINK_NAME,,AUTO          cn=0,n=8

      456    15598    1   NEW_LINK = %YES#;

  15598  4 000005   400000 236003                    LDQ     -131072,DU
         4 000006   200016 756100                    STQ     NEW_LINK,,AUTO

      457    15599    1   CALL ASB$WRITE_LO( AS_BLANK, 1 );

  15599  4 000007   000000 630400 5                  EPPR0   0
         4 000010   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000011   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 000012   000000 011000                    NOP     0

      458    15600    1   FMT_VEC(0) = VECTOR( SUBSTR(USERS_KEY.TXTC,0,8) );

  15600  4 000013   000002 237000 5                  LDAQ    2
         4 000014   000000 755000 xsym               STA     FMT_VEC
         4 000015   000001 756000 xsym               STQ     FMT_VEC+1

      459    15601    1   FMT_VEC(1) = VECTOR(ADDR(LINK$DREC.PNAME)->TEXT$C.TEXT);

  15601  4 000016   000000 470400 xsym               LDP0    DSEG1$
         4 000017   000004 236100                    LDQ     4,,PR0
         4 000020   000033 772000                    QRL     27
         4 000021   000064 737000                    LLS     52
         4 000022   000140 135007                    SBLA    96,DL
         4 000023   000000 236000 xsym               LDQ     DSEG1$
         4 000024   000004 036000 5                  ADLQ    4
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:76   
         4 000025   000002 755000 xsym               STA     FMT_VEC+2
         4 000026   000003 756000 xsym               STQ     FMT_VEC+3

      460    15602    1   FMT_VEC(2) = VECTOR( ADDRESS ) ;

  15602  4 000027   000005 235000 5                  LDA     5
         4 000030   200022 452500                    STP2    VC$+2,,AUTO
         4 000031   200022 236100                    LDQ     VC$+2,,AUTO
         4 000032   000004 036003                    ADLQ    4,DU
         4 000033   000004 755000 xsym               STA     FMT_VEC+4
         4 000034   000005 756000 xsym               STQ     FMT_VEC+5

      461    15603    2   DO J = 0 TO 6 ;

  15603  4 000035   200012 450100                    STZ     J,,AUTO

      462    15604    2      VAL = LINK$DREC.LNK.ADR.ADR.BCD1#(J) ;

  15604  4 000036   200012 236100                    LDQ     J,,AUTO
         4 000037   000011 402007                    MPY     9,DL
         4 000040   000000 470400 xsym               LDP0    DSEG1$
         4 000041   003100 061506                    CSR     bolr='003'O
         4 000042   000022 210004                    BDSC    18,Q,PR0                 by=1,bit=1,n=4
         4 000043   200017 000044                    BDSC    VAL,,AUTO                by=0,bit=0,n=36

      463    15605    2      CALL BINCHAR( ADDRESS( J*2 ), VAL ) ;

  15605  4 000044   200012 235100                    LDA     J,,AUTO
         4 000045   000001 735000                    ALS     1
         4 000046   000105 301500                    BTD
         4 000047   200017 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         4 000050   200004 030001                    NDSC9   ADDRESS,A,AUTO           cn=0,s=nosgn,sf=0,n=1

      464    15606    2      VAL = LINK$DREC.LNK.ADR.ADR.BCD2#(J) ;

  15606  4 000051   003100 061506                    CSR     bolr='003'O
         4 000052   000022 250004                    BDSC    18,Q,PR0                 by=1,bit=5,n=4
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:77   
         4 000053   200017 000044                    BDSC    VAL,,AUTO                by=0,bit=0,n=36

      465    15607    2      CALL BINCHAR( ADDRESS( J*2+1), VAL ) ;

  15607  4 000054   000105 301500                    BTD
         4 000055   200017 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         4 000056   200004 230001                    NDSC9   ADDRESS,A,AUTO           cn=1,s=nosgn,sf=0,n=1

      466    15608    2      END ;

  15608  4 000057   200012 235100                    LDA     J,,AUTO
         4 000060   000001 035007                    ADLA    1,DL
         4 000061   200012 755100                    STA     J,,AUTO
         4 000062   000007 115007                    CMPA    7,DL
         4 000063   000036 602000 4                  TNC     s:15604

      467    15609    2   DO J = LINK$DREC.LNK.ADR.LNG# TO 14;

  15609  4 000064   000022 236100                    LDQ     18,,PR0
         4 000065   000033 772000                    QRL     27
         4 000066   200012 756100                    STQ     J,,AUTO
         4 000067   000076 710000 4                  TRA     s:15611+2

      468    15610    2      ADDRESS (J) = ' ';

  15610  4 000070   200012 235100                    LDA     J,,AUTO
         4 000071   040105 100400                    MLR     fill='040'O
         4 000072   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000073   200004 000001                    ADSC9   ADDRESS,A,AUTO           cn=0,n=1

      469    15611    2      END;

  15611  4 000074   000001 035007                    ADLA    1,DL
         4 000075   200012 755100                    STA     J,,AUTO
         4 000076   200012 235100                    LDA     J,,AUTO
         4 000077   000017 115007                    CMPA    15,DL
         4 000100   000070 602000 4                  TNC     s:15610
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:78   

      470    15612    1   IF LINK$DREC.LNK.MODE# = %LINK_DCE_VAL THEN

  15612  4 000101   000000 470400 xsym               LDP0    DSEG1$
         4 000102   000026 236100                    LDQ     22,,PR0
         4 000103   200000 376003                    ANQ     65536,DU
         4 000104   200000 116003                    CMPQ    65536,DU
         4 000105   000112 601000 4                  TNZ     s:15615

      471    15613    1      FMT_VEC(3) = VECTOR (DCE_STR);

  15613  4 000106   000006 237000 5                  LDAQ    6
         4 000107   000006 755000 xsym               STA     FMT_VEC+6
         4 000110   000007 756000 xsym               STQ     FMT_VEC+7
         4 000111   000115 710000 4                  TRA     s:15616

      472    15614    1   ELSE
      473    15615    1      FMT_VEC(3) = VECTOR (DTE_STR);

  15615  4 000112   000010 237000 5                  LDAQ    8
         4 000113   000006 755000 xsym               STA     FMT_VEC+6
         4 000114   000007 756000 xsym               STQ     FMT_VEC+7

      474    15616    2   IF JCL THEN DO;

  15616  4 000115   200003 471500                    LDP1    @JCL,,AUTO
         4 000116   000000 066500                    CMPB    filb='0'B
         4 000117   100000 000001                    BDSC    0,,PR1                   by=0,bit=0,n=1
         4 000120   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 000121   000132 600000 4                  TZE     s:15621

      475    15617    2      FMT_BUF = LINK_HDR_JCL_FMT;

  15617  4 000122   040000 100400                    MLR     fill='040'O
         4 000123   000006 000060 3                  ADSC9   LINK_HDR_JCL_FMT         cn=0,n=48
         4 000124   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:79   
      476    15618    2      FDS.FMT_.BOUND = SIZEV(LINK_HDR_JCL_FMT);

  15618  4 000125   000000 236000 xsym               LDQ     FDS
         4 000126   177777 376007                    ANQ     65535,DL
         4 000127   000012 276000 5                  ORQ     10
         4 000130   000000 756000 xsym               STQ     FDS

      477    15619    2      END; /*  Jcl  */

  15619  4 000131   000141 710000 4                  TRA     s:15624

      478    15620    2   ELSE DO;

      479    15621    2      FMT_BUF = LINK_HDR_FMT;

  15621  4 000132   040000 100400                    MLR     fill='040'O
         4 000133   000047 000047 3                  ADSC9   LINK_HDR_FMT             cn=0,n=39
         4 000134   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      480    15622    2      FDS.FMT_.BOUND = SIZEV(LINK_HDR_FMT);

  15622  4 000135   000000 236000 xsym               LDQ     FDS
         4 000136   177777 376007                    ANQ     65535,DL
         4 000137   000013 276000 5                  ORQ     11
         4 000140   000000 756000 xsym               STQ     FDS

      481    15623    2      END; /*   Not jcl   */

      482    15624    1   FDS.NVECS# = 4;

  15624  4 000141   000004 235007                    LDA     4,DL
         4 000142   000011 755000 xsym               STA     FDS+9

      483    15625    1   CALL X$FORMAT( FDS );

  15625  4 000143   000014 630400 5                  EPPR0   12
         4 000144   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:80   
         4 000145   000000 701000 xent               TSX1    X$FORMAT
         4 000146   000000 011000                    NOP     0

      484    15626
      485    15627    2   IF JCL THEN DO;

  15627  4 000147   200003 470500                    LDP0    @JCL,,AUTO
         4 000150   000000 066500                    CMPB    filb='0'B
         4 000151   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         4 000152   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 000153   000164 600000 4                  TZE     s:15632

      486    15628    2      FMT_BUF = LINK_CHAN_JCL_FMT;

  15628  4 000154   040000 100400                    MLR     fill='040'O
         4 000155   000022 000073 3                  ADSC9   LINK_CHAN_JCL_FMT        cn=0,n=59
         4 000156   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      487    15629    2      FDS.FMT_.BOUND = SIZEC (LINK_CHAN_JCL_FMT);

  15629  4 000157   000000 236000 xsym               LDQ     FDS
         4 000160   177777 376007                    ANQ     65535,DL
         4 000161   000015 276000 5                  ORQ     13
         4 000162   000000 756000 xsym               STQ     FDS

      488    15630    2      END; /*  Jcl  */

  15630  4 000163   000173 710000 4                  TRA     s:15635

      489    15631    2   ELSE DO;

      490    15632    2      FMT_BUF = LINK_CHAN_FMT;

  15632  4 000164   040000 100400                    MLR     fill='040'O
         4 000165   000061 000072 3                  ADSC9   LINK_CHAN_FMT            cn=0,n=58
         4 000166   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:81   
      491    15633    2      FDS.FMT_.BOUND = SIZEC (LINK_CHAN_FMT);

  15633  4 000167   000000 236000 xsym               LDQ     FDS
         4 000170   177777 376007                    ANQ     65535,DL
         4 000171   000016 276000 5                  ORQ     14
         4 000172   000000 756000 xsym               STQ     FDS

      492    15634    2      END; /*  Not jcl  */

      493    15635    1   FDS.NVECS# = 5;

  15635  4 000173   000005 235007                    LDA     5,DL
         4 000174   000011 755000 xsym               STA     FDS+9

      494    15636    1   LIC_TEMP = LINK$DREC.LNK.LIC;

  15636  4 000175   000000 471400 xsym               LDP1    DSEG1$
         4 000176   100024 236100                    LDQ     20,,PR1
         4 000177   000022 772000                    QRL     18
         4 000200   000002 756000 2                  STQ     LIC_TEMP

      495    15637    1   HIC_TEMP = LINK$DREC.LNK.HIC;

  15637  4 000201   100024 236100                    LDQ     20,,PR1
         4 000202   777777 376007                    ANQ     -1,DL
         4 000203   000000 756000 2                  STQ     HIC_TEMP

      496    15638    1   LOC_TEMP = LINK$DREC.LNK.LOC;

  15638  4 000204   100025 236100                    LDQ     21,,PR1
         4 000205   000022 772000                    QRL     18
         4 000206   000003 756000 2                  STQ     LOC_TEMP

      497    15639    1   HOC_TEMP = LINK$DREC.LNK.HOC;

  15639  4 000207   100025 236100                    LDQ     21,,PR1
         4 000210   777777 376007                    ANQ     -1,DL
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:82   
         4 000211   000001 756000 2                  STQ     HOC_TEMP

      498    15640    1   FMT_VEC(0) = VECTOR (LIC_TEMP);

  15640  4 000212   000020 237000 5                  LDAQ    16
         4 000213   000000 755000 xsym               STA     FMT_VEC
         4 000214   000001 756000 xsym               STQ     FMT_VEC+1

      499    15641    1   FMT_VEC(1) = VECTOR (HIC_TEMP);

  15641  4 000215   000022 237000 5                  LDAQ    18
         4 000216   000002 755000 xsym               STA     FMT_VEC+2
         4 000217   000003 756000 xsym               STQ     FMT_VEC+3

      500    15642    1   FMT_VEC(2) = VECTOR (LOC_TEMP);

  15642  4 000220   000024 237000 5                  LDAQ    20
         4 000221   000004 755000 xsym               STA     FMT_VEC+4
         4 000222   000005 756000 xsym               STQ     FMT_VEC+5

      501    15643    1   FMT_VEC(3) = VECTOR (HOC_TEMP);

  15643  4 000223   000026 237000 5                  LDAQ    22
         4 000224   000006 755000 xsym               STA     FMT_VEC+6
         4 000225   000007 756000 xsym               STQ     FMT_VEC+7

      502    15644    1   FMT_VEC(4) = VECTOR (LINK$DREC.LNK.DFLTVCPRO.TXT);

  15644  4 000226   000017 235000 5                  LDA     15
         4 000227   000000 236000 xsym               LDQ     DSEG1$
         4 000230   000030 036000 5                  ADLQ    24
         4 000231   000010 755000 xsym               STA     FMT_VEC+8
         4 000232   000011 756000 xsym               STQ     FMT_VEC+9

      503    15645    1   CALL X$FORMAT (FDS);

  15645  4 000233   000014 630400 5                  EPPR0   12
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:83   
         4 000234   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000235   000000 701000 xent               TSX1    X$FORMAT
         4 000236   000000 011000                    NOP     0

      504    15646
      505    15647    2   IF NOT JCL THEN DO;

  15647  4 000237   200003 470500                    LDP0    @JCL,,AUTO
         4 000240   000000 066500                    CMPB    filb='0'B
         4 000241   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         4 000242   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 000243   000253 601000 4                  TNZ     s:15651

      506    15648    2      FMT_BUF = LINK_DEST_FMT ;

  15648  4 000244   040000 100400                    MLR     fill='040'O
         4 000245   000100 000025 3                  ADSC9   LINK_DEST_FMT            cn=0,n=21
         4 000246   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      507    15649    2      FDS.FMT_.BOUND = SIZEV(LINK_DEST_FMT);

  15649  4 000247   000000 236000 xsym               LDQ     FDS
         4 000250   177777 376007                    ANQ     65535,DL
         4 000251   000005 276003                    ORQ     5,DU
         4 000252   000000 756000 xsym               STQ     FDS

      508    15650    2      END; /*  Not jcl  */

      509    15651    1   FDS.NVECS# = 2;

  15651  4 000253   000002 235007                    LDA     2,DL
         4 000254   000011 755000 xsym               STA     FDS+9

      510    15652    1   FMT_VEC(0) = VECTOR( ADDRESS ) ;

  15652  4 000255   000005 235000 5                  LDA     5
         4 000256   200022 452500                    STP2    VC$+2,,AUTO
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:84   
         4 000257   200022 236100                    LDQ     VC$+2,,AUTO
         4 000260   000004 036003                    ADLQ    4,DU
         4 000261   000000 755000 xsym               STA     FMT_VEC
         4 000262   000001 756000 xsym               STQ     FMT_VEC+1

      511    15653    2   DO J = 0 TO 6 ;

  15653  4 000263   200012 450100                    STZ     J,,AUTO

      512    15654    2      VAL = LINK$DREC.LNK.DEST.ADR.BCD0(J) ;

  15654  4 000264   200012 236100                    LDQ     J,,AUTO
         4 000265   000011 402007                    MPY     9,DL
         4 000266   000000 470400 xsym               LDP0    DSEG1$
         4 000267   003100 061506                    CSR     bolr='003'O
         4 000270   000031 610004                    BDSC    25,Q,PR0                 by=3,bit=1,n=4
         4 000271   200017 000044                    BDSC    VAL,,AUTO                by=0,bit=0,n=36

      513    15655    2      CALL BINCHAR( ADDRESS( J*2 ), VAL ) ;

  15655  4 000272   200012 235100                    LDA     J,,AUTO
         4 000273   000001 735000                    ALS     1
         4 000274   000105 301500                    BTD
         4 000275   200017 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         4 000276   200004 030001                    NDSC9   ADDRESS,A,AUTO           cn=0,s=nosgn,sf=0,n=1

      514    15656    2      VAL = LINK$DREC.LNK.DEST.ADR.BCD1(J) ;

  15656  4 000277   003100 061506                    CSR     bolr='003'O
         4 000300   000031 650004                    BDSC    25,Q,PR0                 by=3,bit=5,n=4
         4 000301   200017 000044                    BDSC    VAL,,AUTO                by=0,bit=0,n=36

      515    15657    2      CALL BINCHAR( ADDRESS( J*2+1), VAL ) ;

  15657  4 000302   000105 301500                    BTD
         4 000303   200017 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         4 000304   200004 230001                    NDSC9   ADDRESS,A,AUTO           cn=1,s=nosgn,sf=0,n=1
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:85   

      516    15658    2      END ;

  15658  4 000305   200012 235100                    LDA     J,,AUTO
         4 000306   000001 035007                    ADLA    1,DL
         4 000307   200012 755100                    STA     J,,AUTO
         4 000310   000007 115007                    CMPA    7,DL
         4 000311   000264 602000 4                  TNC     s:15654

      517    15659
      518    15660    2   DO J = LINK$DREC.LNK.DEST.LEN TO 14;

  15660  4 000312   000031 236100                    LDQ     25,,PR0
         4 000313   000011 772000                    QRL     9
         4 000314   000777 376007                    ANQ     511,DL
         4 000315   200012 756100                    STQ     J,,AUTO
         4 000316   000325 710000 4                  TRA     s:15662+2

      519    15661    2      ADDRESS (J) = ' ';

  15661  4 000317   200012 235100                    LDA     J,,AUTO
         4 000320   040105 100400                    MLR     fill='040'O
         4 000321   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000322   200004 000001                    ADSC9   ADDRESS,A,AUTO           cn=0,n=1

      520    15662    2      END;

  15662  4 000323   000001 035007                    ADLA    1,DL
         4 000324   200012 755100                    STA     J,,AUTO
         4 000325   200012 235100                    LDA     J,,AUTO
         4 000326   000017 115007                    CMPA    15,DL
         4 000327   000317 602000 4                  TNC     s:15661

      521    15663    2   IF JCL THEN DO;

  15663  4 000330   200003 470500                    LDP0    @JCL,,AUTO
         4 000331   000000 066500                    CMPB    filb='0'B
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:86   
         4 000332   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         4 000333   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 000334   000400 600000 4                  TZE     s:15677

      522    15664    3      IF ADDRESS(0) = ' ' THEN DO;

  15664  4 000335   200004 236100                    LDQ     ADDRESS,,AUTO
         4 000336   777000 376003                    ANQ     -512,DU
         4 000337   040000 116003                    CMPQ    16384,DU
         4 000340   000360 601000 4                  TNZ     s:15671

      523    15665    3         FMT_BUF = LINK_QOS_JCL_FMT ;

  15665  4 000341   040000 100400                    MLR     fill='040'O
         4 000342   000044 000011 3                  ADSC9   LINK_QOS_JCL_FMT         cn=0,n=9
         4 000343   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      524    15666    3         FDS.FMT_.BOUND = SIZEV(LINK_QOS_JCL_FMT);

  15666  4 000344   000000 236000 xsym               LDQ     FDS
         4 000345   177777 376007                    ANQ     65535,DL
         4 000346   000002 276003                    ORQ     2,DU
         4 000347   000000 756000 xsym               STQ     FDS

      525    15667    3         FMT_VEC(0) = VECTOR( LINK$DREC.LNK.QOS# );

  15667  4 000350   177640 235007                    LDA     65440,DL
         4 000351   000000 236000 xsym               LDQ     DSEG1$
         4 000352   000031 036000 5                  ADLQ    25
         4 000353   000000 755000 xsym               STA     FMT_VEC
         4 000354   000001 756000 xsym               STQ     FMT_VEC+1

      526    15668    3         FDS.NVECS# = 1;

  15668  4 000355   000001 235007                    LDA     1,DL
         4 000356   000011 755000 xsym               STA     FDS+9

PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:87   
      527    15669    3         END;  /*  Address is blank  */

  15669  4 000357   000437 710000 4                  TRA     s:15689

      528    15670    3      ELSE DO;

      529    15671    3         CALL CONCAT (FMT_BUF, LINK_DEST_JCL_FMT, LINK_QOS_JCL_FMT);

  15671  4 000360   040000 100400                    MLR     fill='040'O
         4 000361   000041 000013 3                  ADSC9   LINK_DEST_JCL_FMT        cn=0,n=11
         4 000362   000000 000013 xsym               ADSC9   FMT_BUF                  cn=0,n=11
         4 000363   040000 100400                    MLR     fill='040'O
         4 000364   000044 000011 3                  ADSC9   LINK_QOS_JCL_FMT         cn=0,n=9
         4 000365   000002 600364 xsym               ADSC9   FMT_BUF+2                cn=3,n=244

      530    15672    3         FDS.FMT_.BOUND = SIZEC(LINK_DEST_JCL_FMT) + SIZEC (LINK_QOS_JCL_FMT) - 1;

  15672  4 000366   000000 236000 xsym               LDQ     FDS
         4 000367   177777 376007                    ANQ     65535,DL
         4 000370   000032 276000 5                  ORQ     26
         4 000371   000000 756000 xsym               STQ     FDS

      531    15673    3         FMT_VEC(1) = VECTOR( LINK$DREC.LNK.QOS# );

  15673  4 000372   177640 235007                    LDA     65440,DL
         4 000373   000000 236000 xsym               LDQ     DSEG1$
         4 000374   000031 036000 5                  ADLQ    25
         4 000375   000002 755000 xsym               STA     FMT_VEC+2
         4 000376   000003 756000 xsym               STQ     FMT_VEC+3

      532    15674    3         END;  /*  Not blank address  */

      533    15675    2      END;  /*  Jcl  */

  15675  4 000377   000437 710000 4                  TRA     s:15689

      534    15676    2   ELSE DO;
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:88   

      535    15677    3      IF ADDRESS(0) = ' ' THEN DO;

  15677  4 000400   200004 236100                    LDQ     ADDRESS,,AUTO
         4 000401   777000 376003                    ANQ     -512,DU
         4 000402   040000 116003                    CMPQ    16384,DU
         4 000403   000423 601000 4                  TNZ     s:15684

      536    15678    3         FMT_BUF = LINK_QOS_JCL_FMT ;

  15678  4 000404   040000 100400                    MLR     fill='040'O
         4 000405   000044 000011 3                  ADSC9   LINK_QOS_JCL_FMT         cn=0,n=9
         4 000406   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      537    15679    3         FDS.FMT_.BOUND = SIZEV(LINK_QOS_JCL_FMT);

  15679  4 000407   000000 236000 xsym               LDQ     FDS
         4 000410   177777 376007                    ANQ     65535,DL
         4 000411   000002 276003                    ORQ     2,DU
         4 000412   000000 756000 xsym               STQ     FDS

      538    15680    3         FMT_VEC(0) = VECTOR( LINK$DREC.LNK.QOS# );

  15680  4 000413   177640 235007                    LDA     65440,DL
         4 000414   000000 236000 xsym               LDQ     DSEG1$
         4 000415   000031 036000 5                  ADLQ    25
         4 000416   000000 755000 xsym               STA     FMT_VEC
         4 000417   000001 756000 xsym               STQ     FMT_VEC+1

      539    15681    3         FDS.NVECS# = 1;

  15681  4 000420   000001 235007                    LDA     1,DL
         4 000421   000011 755000 xsym               STA     FDS+9

      540    15682    3         END;  /*  Address is blank  */

  15682  4 000422   000437 710000 4                  TRA     s:15689
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:89   

      541    15683    3      ELSE DO;

      542    15684    3         FMT_BUF = LINK_DEST_FMT;

  15684  4 000423   040000 100400                    MLR     fill='040'O
         4 000424   000100 000025 3                  ADSC9   LINK_DEST_FMT            cn=0,n=21
         4 000425   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      543    15685    3         FDS.FMT_.BOUND = SIZEV(LINK_DEST_FMT);

  15685  4 000426   000000 236000 xsym               LDQ     FDS
         4 000427   177777 376007                    ANQ     65535,DL
         4 000430   000005 276003                    ORQ     5,DU
         4 000431   000000 756000 xsym               STQ     FDS

      544    15686    3         FMT_VEC(1) = VECTOR( LINK$DREC.LNK.QOS# );

  15686  4 000432   177640 235007                    LDA     65440,DL
         4 000433   000000 236000 xsym               LDQ     DSEG1$
         4 000434   000031 036000 5                  ADLQ    25
         4 000435   000002 755000 xsym               STA     FMT_VEC+2
         4 000436   000003 756000 xsym               STQ     FMT_VEC+3

      545    15687    3         END;  /*  Not blank address  */

      546    15688    2      END; /* If not jcl */

      547    15689    1   CALL X$FORMAT( FDS );

  15689  4 000437   000014 630400 5                  EPPR0   12
         4 000440   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000441   000000 701000 xent               TSX1    X$FORMAT
         4 000442   000000 011000                    NOP     0

      548    15690    1   IF JCL THEN

PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:90   
  15690  4 000443   200003 470500                    LDP0    @JCL,,AUTO
         4 000444   000000 066500                    CMPB    filb='0'B
         4 000445   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         4 000446   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 000447   000454 600000 4                  TZE     s:15693

      549    15691    1      CALL ASB$WRITE_LO ('   END',6);

  15691  4 000450   000033 630400 5                  EPPR0   27
         4 000451   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000452   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 000453   000000 011000                    NOP     0

      550    15692
      551    15693    1   VC$ = DSEG1$;

  15693  4 000454   000000 236000 xsym               LDQ     DSEG1$
         4 000455   200020 756100                    STQ     VC$,,AUTO

      552    15694    1   ARS = SIZEW (LINK$DREC) + LINK$DREC.NWINFO;

  15694  4 000456   000000 470400 xsym               LDP0    DSEG1$
         4 000457   000017 235100                    LDA     15,,PR0
         4 000460   000034 035007                    ADLA    28,DL
         4 000461   200010 755100                    STA     ARS,,AUTO

      553    15695    2   DO FOREVER;

      554    15696    2      CALL ASL$FIND_VIRCIR (DSEG1$, ARS, VC_NAME, VC$) ALTRET (END_FOREVER);

  15696  4 000462   200020 630500                    EPPR0   VC$,,AUTO
         4 000463   200025 450500                    STP0    VC$+5,,AUTO
         4 000464   000035 236000 5                  LDQ     29
         4 000465   200024 756100                    STQ     VC$+4,,AUTO
         4 000466   200010 631500                    EPPR1   ARS,,AUTO
         4 000467   200023 451500                    STP1    VC$+3,,AUTO
         4 000470   000036 236000 5                  LDQ     30
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:91   
         4 000471   200022 756100                    STQ     VC$+2,,AUTO
         4 000472   200022 630500                    EPPR0   VC$+2,,AUTO
         4 000473   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000474   000000 701000 xent               TSX1    ASL$FIND_VIRCIR
         4 000475   000514 702000 4                  TSX2    END_FOREVER

      555    15697    2      CALL ASL$DISP_ONE_VIRCIR (VC$, NEW_LINK, JCL, LINK_NAME);

  15697  4 000476   200014 630500                    EPPR0   LINK_NAME,,AUTO
         4 000477   200025 450500                    STP0    VC$+5,,AUTO
         4 000500   200003 236100                    LDQ     @JCL,,AUTO
         4 000501   200024 756100                    STQ     VC$+4,,AUTO
         4 000502   200016 631500                    EPPR1   NEW_LINK,,AUTO
         4 000503   200023 451500                    STP1    VC$+3,,AUTO
         4 000504   200020 633500                    EPPR3   VC$,,AUTO
         4 000505   200022 453500                    STP3    VC$+2,,AUTO
         4 000506   200022 630500                    EPPR0   VC$+2,,AUTO
         4 000507   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000510   000000 701000 xent               TSX1    ASL$DISP_ONE_VIRCIR
         4 000511   000000 011000                    NOP     0

      556    15698    2      NEW_LINK = %NO#;

  15698  4 000512   200016 450100                    STZ     NEW_LINK,,AUTO

      557    15699    2      END;  /*  Do forever  */

  15699  4 000513   000462 710000 4                  TRA     s:15696

      558    15700    1   END_FOREVER:
      559    15701    1   LINKDEV$ = DSEG1$;

  15701  4 000514   000000 236000 xsym  END_FOREVER  LDQ     DSEG1$
         4 000515   200013 756100                    STQ     LINKDEV$,,AUTO

      560    15702    1   NEW_LINK = %YES#;

PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:92   
  15702  4 000516   400000 236003                    LDQ     -131072,DU
         4 000517   200016 756100                    STQ     NEW_LINK,,AUTO

      561    15703    2   DO FOREVER;

      562    15704    2     CALL ASL$FIND_LINKDEV (DSEG1$, ARS, LINKDEV_NAME, LINKDEV$) ALTRET (END_FOREVER2)
             15704               ;

  15704  4 000520   200013 630500                    EPPR0   LINKDEV$,,AUTO
         4 000521   200025 450500                    STP0    VC$+5,,AUTO
         4 000522   000037 236000 5                  LDQ     31
         4 000523   200024 756100                    STQ     VC$+4,,AUTO
         4 000524   200010 631500                    EPPR1   ARS,,AUTO
         4 000525   200023 451500                    STP1    VC$+3,,AUTO
         4 000526   000036 236000 5                  LDQ     30
         4 000527   200022 756100                    STQ     VC$+2,,AUTO
         4 000530   200022 630500                    EPPR0   VC$+2,,AUTO
         4 000531   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000532   000000 701000 xent               TSX1    ASL$FIND_LINKDEV
         4 000533   000552 702000 4                  TSX2    END_FOREVER2

      563    15705    2      CALL ASL$DISP_ONE_LINKDEV (LINKDEV$, NEW_LINK, JCL, LINK_NAME);

  15705  4 000534   200014 630500                    EPPR0   LINK_NAME,,AUTO
         4 000535   200025 450500                    STP0    VC$+5,,AUTO
         4 000536   200003 236100                    LDQ     @JCL,,AUTO
         4 000537   200024 756100                    STQ     VC$+4,,AUTO
         4 000540   200016 631500                    EPPR1   NEW_LINK,,AUTO
         4 000541   200023 451500                    STP1    VC$+3,,AUTO
         4 000542   200013 633500                    EPPR3   LINKDEV$,,AUTO
         4 000543   200022 453500                    STP3    VC$+2,,AUTO
         4 000544   200022 630500                    EPPR0   VC$+2,,AUTO
         4 000545   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000546   000000 701000 xent               TSX1    ASL$DISP_ONE_LINKDEV
         4 000547   000000 011000                    NOP     0

      564    15706    2      NEW_LINK = %NO#;
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:93   

  15706  4 000550   200016 450100                    STZ     NEW_LINK,,AUTO

      565    15707    2      END;  /*  Do FOREVER2  */

  15707  4 000551   000520 710000 4                  TRA     s:15704

      566    15708    1   END_FOREVER2:
      567    15709    1   RETURN ;

  15709  4 000552   000000 702200 xent  END_FOREVER2 TSX2  ! X66_ARET
      568    15710    1   END ASL$DISP_ONE_LINK;

PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:94   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_LINK.
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:95   

 **** Variables and constants ****

  ****  Section 002  Data  ASL$DISP_ONE_LINK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 HIC_TEMP                   1-0-0/w UBIN        r     1 HOC_TEMP
     2-0-0/w UBIN        r     1 LIC_TEMP                   3-0-0/w UBIN        r     1 LOC_TEMP

  ****  Section 003 RoData ASL$DISP_ONE_LINK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(3)     r     1 DCE_STR                    1-0-0/c CHAR(3)     r     1 DTE_STR
     3-0-0/c STRC(81)    r     1 LINKDEV_NAME              61-0-0/c CHAR(58)    r     1 LINK_CHAN_FMT
    22-0-0/c CHAR(59)    r     1 LINK_CHAN_JCL_FMT        100-0-0/c CHAR(21)    r     1 LINK_DEST_FMT
    41-0-0/c CHAR(11)    r     1 LINK_DEST_JCL_FMT         47-0-0/c CHAR(39)    r     1 LINK_HDR_FMT
     6-0-0/c CHAR(48)    r     1 LINK_HDR_JCL_FMT          44-0-0/c CHAR(9)     r     1 LINK_QOS_JCL_FMT
   106-0-0/c STRC(45)    r     1 VC_NAME

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @JCL                       4-0-0/c CHAR        r     1 ADDRESS(0:13)
    10-0-0/w UBIN        r     1 ARS                       12-0-0/w UBIN        r     1 J
    *0-0-0/b BIT         r     1 JCL                       13-0-0/w PTR         r     1 LINKDEV$
    14-0-0/c CHAR(8)     r     1 LINK_NAME                 16-0-0/b BIT         r     1 NEW_LINK
    17-0-0/w SBIN        r     1 VAL                       20-0-0/w PTR         r     1 VC$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:96   

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/w PTR         r     1 DSEG1$
     0-0-0/w STRC(1080)  r     1 FDS                        0-0-0/c CHAR(255)   r     1 FMT_BUF
     0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)              0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1008)  r     1 LINK$DREC                  0-0-0/w ASTR(9)     r     1 TEXT$C


   Procedure ASL$DISP_ONE_LINK requires 363 words for executable code.
   Procedure ASL$DISP_ONE_LINK requires 22 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_LINKS.:E05TSI    .
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:97   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:98   
          MINI XREF LISTING

ADDRESS
     15329**DCL     15602--ASSIGN  15605<<CALLBLT 15607<<CALLBLT 15610<<ASSIGN  15652--ASSIGN  15655<<CALLBLT
     15657<<CALLBLT 15661<<ASSIGN  15664>>IF      15677>>IF
ARS
     15330**DCL     15694<<ASSIGN  15696<>CALL    15704<>CALL
ASA_BRKS_LOC
     11877**DCL     11877--REDEF
ASB$WRITE_LO
     14737**DCL-ENT 15599--CALL    15691--CALL
ASL$DISP_ONE_LINKDEV
     14749**DCL-ENT 15705--CALL
ASL$DISP_ONE_VIRCIR
     14743**DCL-ENT 15697--CALL
ASL$FIND_LINKDEV
     14746**DCL-ENT 15704--CALL
ASL$FIND_VIRCIR
     14740**DCL-ENT 15696--CALL
AS_BLANK
     11737**DCL     15599<>CALL
AS_DEFAULT.BANNER_PERM
     12570**DCL     12571--REDEF
AS_DEFAULT.BUDGET.MACCT
     12475**DCL     12479--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     12488**DCL     12491--REDEF
AS_DEFAULT.BUDGET.PACCUM
     12471**DCL     12473--REDEF
AS_DEFAULT.BUDGET.PMAXC
     12466**DCL     12468--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     12586**DCL     12587--REDEF   12588--REDEF
AS_DEFAULT_DREC.PASSWORD
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:99   
     13840**DCL     13844--REDEF
AS_DEFAULT_DREC.RENAME
     13863**DCL     13864--REDEF
AS_DFLT.BANNER_PERM
     12392**DCL     12393--REDEF
AS_DFLT.BUDGET.MACCT
     12297**DCL     12301--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     12310**DCL     12313--REDEF
AS_DFLT.BUDGET.PACCUM
     12293**DCL     12295--REDEF
AS_DFLT.BUDGET.PMAXC
     12288**DCL     12290--REDEF
AS_DFLT.SETUP_CHRA.TXT
     12408**DCL     12409--REDEF   12410--REDEF
AS_FE_MODE
     11743**DCL     11744--REDEF
AS_MODE
     11740**DCL     11742--REDEF
AS_MOD_USER.ACCESS
     14605**DCL     14606--REDEF
AS_MOD_USER.BANNER
     14592**DCL     14593--REDEF
AS_MOD_USER.BANNER_PERM
     14594**DCL     14595--REDEF
AS_MOD_USER.BILL
     14600**DCL     14601--REDEF
AS_MOD_USER.CPROC
     14596**DCL     14597--REDEF
AS_MOD_USER.FEBILL
     14676**DCL     14677--REDEF
AS_MOD_USER.FECXTMEM
     14693**DCL     14694--REDEF
AS_MOD_USER.FEMINTS
     14678**DCL     14679--REDEF
AS_MOD_USER.FEMMEM
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:100  
     14689**DCL     14690--REDEF
AS_MOD_USER.FEMTIME
     14687**DCL     14688--REDEF
AS_MOD_USER.FEPPRIV
     14684**DCL     14686--REDEF
AS_MOD_USER.FEPRIV
     14681**DCL     14683--REDEF
AS_MOD_USER.FORCE_BIT
     14590**DCL     14591--REDEF
AS_MOD_USER.KEY
     14672**DCL     14674--REDEF
AS_MOD_USER.LASTCPROC
     14598**DCL     14599--REDEF
AS_MOD_USER.LIMITS.DO_
     14646**DCL     14647--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     14662**DCL     14663--REDEF
AS_MOD_USER.LIMITS.LO
     14642**DCL     14643--REDEF
AS_MOD_USER.LIMITS.MEM
     14638**DCL     14639--REDEF
AS_MOD_USER.LIMITS.MPRIO
     14666**DCL     14667--REDEF
AS_MOD_USER.LIMITS.PDIS
     14654**DCL     14655--REDEF
AS_MOD_USER.LIMITS.PO
     14650**DCL     14651--REDEF
AS_MOD_USER.LIMITS.TDIS
     14658**DCL     14659--REDEF
AS_MOD_USER.LIMITS.TIME
     14634**DCL     14635--REDEF
AS_MOD_USER.MAXENQ
     14615**DCL     14616--REDEF
AS_MOD_USER.PERM_BIT
     14588**DCL     14589--REDEF
AS_MOD_USER.PPRIV
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:101  
     14610**DCL     14612--REDEF
AS_MOD_USER.PRIOB
     14617**DCL     14618--REDEF
AS_MOD_USER.PRIV
     14607**DCL     14609--REDEF
AS_MOD_USER.QUAN
     14613**DCL     14614--REDEF
AS_MOD_USER.SETUP
     14586**DCL     14587--REDEF
AS_PROJECT.BANNER_PERM
     12926**DCL     12927--REDEF
AS_PROJECT.BUDGET.MACCT
     12831**DCL     12835--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12844**DCL     12847--REDEF
AS_PROJECT.BUDGET.PACCUM
     12827**DCL     12829--REDEF
AS_PROJECT.BUDGET.PMAXC
     12822**DCL     12824--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12942**DCL     12943--REDEF   12944--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     13104**DCL     13105--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     13009**DCL     13013--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     13022**DCL     13025--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     13005**DCL     13007--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     13000**DCL     13002--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     13120**DCL     13121--REDEF   13122--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     14326**DCL     14330--REDEF
AS_PROJECT_DFLT_DREC.RENAME
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:102  
     14349**DCL     14350--REDEF
AS_PROJECT_DREC.PASSWORD
     14164**DCL     14168--REDEF
AS_PROJECT_DREC.RENAME
     14187**DCL     14188--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12748**DCL     12749--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     12653**DCL     12657--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     12666**DCL     12669--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     12649**DCL     12651--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     12644**DCL     12646--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12764**DCL     12765--REDEF   12766--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     14002**DCL     14006--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     14025**DCL     14026--REDEF
AS_USERS.BANNER_PERM
     12214**DCL     12215--REDEF
AS_USERS.BUDGET.MACCT
     12119**DCL     12123--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     12132**DCL     12135--REDEF
AS_USERS.BUDGET.PACCUM
     12115**DCL     12117--REDEF
AS_USERS.BUDGET.PMAXC
     12110**DCL     12112--REDEF
AS_USERS.SETUP_CHRA.TXT
     12230**DCL     12231--REDEF   12232--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     13282**DCL     13283--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:103  
     13187**DCL     13191--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     13200**DCL     13203--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     13183**DCL     13185--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     13178**DCL     13180--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     13298**DCL     13299--REDEF   13300--REDEF
DCE_STR
     15345**DCL     15613--ASSIGN
DSEG1$
     11878**DCL     14770--IMP-PTR 15601>>ASSIGN  15601>>ASSIGN  15604>>ASSIGN  15606>>ASSIGN  15609>>DOINDEX
     15612>>IF      15636>>ASSIGN  15637>>ASSIGN  15638>>ASSIGN  15639>>ASSIGN  15644>>ASSIGN  15654>>ASSIGN
     15656>>ASSIGN  15660>>DOINDEX 15667>>ASSIGN  15673>>ASSIGN  15680>>ASSIGN  15686>>ASSIGN  15693>>ASSIGN
     15694>>ASSIGN  15696<>CALL    15701>>ASSIGN  15704<>CALL
DTE_STR
     15346**DCL     15615--ASSIGN
END_FOREVER
     15701**LABEL   15696--CALLALT
END_FOREVER2
     15709**LABEL   15704--CALLALT
ERR_CODE
     11872**DCL     11873--REDEF
FDS
     11769**DCL     15625<>CALL    15645<>CALL    15689<>CALL
FDS.FMT_.BOUND
     11774**DCL     15618<<ASSIGN  15622<<ASSIGN  15629<<ASSIGN  15633<<ASSIGN  15649<<ASSIGN  15666<<ASSIGN
     15672<<ASSIGN  15679<<ASSIGN  15685<<ASSIGN
FDS.NVECS#
     11797**DCL     15624<<ASSIGN  15635<<ASSIGN  15651<<ASSIGN  15668<<ASSIGN  15681<<ASSIGN
FMT_BUF
     11868**DCL     15617<<ASSIGN  15621<<ASSIGN  15628<<ASSIGN  15632<<ASSIGN  15648<<ASSIGN  15665<<ASSIGN
     15671<<CALLBLT 15678<<ASSIGN  15684<<ASSIGN
FMT_VEC
     11868**DCL     15600<<ASSIGN  15601<<ASSIGN  15602<<ASSIGN  15613<<ASSIGN  15615<<ASSIGN  15640<<ASSIGN
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:104  
     15641<<ASSIGN  15642<<ASSIGN  15643<<ASSIGN  15644<<ASSIGN  15652<<ASSIGN  15667<<ASSIGN  15673<<ASSIGN
     15680<<ASSIGN  15686<<ASSIGN
HIC_TEMP
     15331**DCL     15637<<ASSIGN  15641--ASSIGN
HOC_TEMP
     15332**DCL     15639<<ASSIGN  15643--ASSIGN
J
     15334**DCL     15603<<DOINDEX 15604>>ASSIGN  15605>>CALLBLT 15606>>ASSIGN  15607>>CALLBLT 15609<<DOINDEX
     15610>>ASSIGN  15653<<DOINDEX 15654>>ASSIGN  15655>>CALLBLT 15656>>ASSIGN  15657>>CALLBLT 15660<<DOINDEX
     15661>>ASSIGN
JCL
     14732**DCL        10--PROC    15616>>IF      15627>>IF      15647>>IF      15663>>IF      15690>>IF
     15697<>CALL    15705<>CALL
KL$LNKVC.CUG
     15213**DCL     15257--REDEF
KL_DEFAULT.PASSWORD
     14488**DCL     14492--REDEF
KL_DEFAULT.RENAME
     14511**DCL     14512--REDEF
KL_DFLT.PASSWORD
     13678**DCL     13682--REDEF
KL_DFLT.RENAME
     13701**DCL     13702--REDEF
KL_DREC.PASSWORD
     13516**DCL     13520--REDEF
KL_DREC.RENAME
     13539**DCL     13540--REDEF
KL_DREC_CNT.PASSWORD
     13403**DCL     13407--REDEF
KL_DREC_CNT.RENAME
     13426**DCL     13427--REDEF
KL_LNKVC.CUG
     15482**DCL     15526--REDEF
LIC_TEMP
     15335**DCL     15636<<ASSIGN  15640--ASSIGN
LINK$DREC
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:105  
     14770**DCL     15694--ASSIGN
LINK$DREC.LNK.ADR.ADR.BCD1#
     15014**DCL     15604>>ASSIGN
LINK$DREC.LNK.ADR.ADR.BCD2#
     15018**DCL     15606>>ASSIGN
LINK$DREC.LNK.ADR.LNG#
     15000**DCL     15609>>DOINDEX
LINK$DREC.LNK.DEST.ADR.BCD0
     15084**DCL     15654>>ASSIGN
LINK$DREC.LNK.DEST.ADR.BCD1
     15085**DCL     15656>>ASSIGN
LINK$DREC.LNK.DEST.LEN
     15073**DCL     15660>>DOINDEX
LINK$DREC.LNK.DFLTVCPRO.TXT
     15064**DCL     15644--ASSIGN
LINK$DREC.LNK.HIC
     15028**DCL     15637>>ASSIGN
LINK$DREC.LNK.HOC
     15038**DCL     15639>>ASSIGN
LINK$DREC.LNK.LIC
     15023**DCL     15636>>ASSIGN
LINK$DREC.LNK.LOC
     15033**DCL     15638>>ASSIGN
LINK$DREC.LNK.MODE#
     15045**DCL     15612>>IF
LINK$DREC.LNK.QOS#
     15086**DCL     15667--ASSIGN  15673--ASSIGN  15680--ASSIGN  15686--ASSIGN
LINK$DREC.NWINFO
     14868**DCL     15694>>ASSIGN
LINK$DREC.PASSWORD
     14828**DCL     14832--REDEF
LINK$DREC.PNAME
     14834**DCL     15601--ASSIGN  15601--ASSIGN
LINK$DREC.RENAME
     14851**DCL     14852--REDEF
LINKDEV$
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:106  
     15336**DCL     15701<<ASSIGN  15704<>CALL    15705<>CALL
LINKDEV_NAME
     15348**DCL     15704<>CALL
LINK_CHAN_FMT
     15359**DCL     15632>>ASSIGN  15633--ASSIGN
LINK_CHAN_JCL_FMT
     15353**DCL     15628>>ASSIGN  15629--ASSIGN
LINK_DEST_FMT
     15361**DCL     15648>>ASSIGN  15649--ASSIGN  15684>>ASSIGN  15685--ASSIGN
LINK_DEST_JCL_FMT
     15355**DCL     15671>>CALLBLT 15672--ASSIGN
LINK_HDR_FMT
     15357**DCL     15621>>ASSIGN  15622--ASSIGN
LINK_HDR_JCL_FMT
     15351**DCL     15617>>ASSIGN  15618--ASSIGN
LINK_NAME
     15337**DCL     15597<<ASSIGN  15697<>CALL    15705<>CALL
LINK_QOS_JCL_FMT
     15356**DCL     15665>>ASSIGN  15666--ASSIGN  15671>>CALLBLT 15672--ASSIGN  15678>>ASSIGN  15679--ASSIGN
LOC_TEMP
     15338**DCL     15638<<ASSIGN  15642--ASSIGN
NEW_LINK
     15339**DCL     15598<<ASSIGN  15697<>CALL    15698<<ASSIGN  15702<<ASSIGN  15705<>CALL    15706<<ASSIGN
PROJ_KEY.TEXT
     11750**DCL     11750--REDEF
PROJ_KEY.TXT.PROJECT
     11750**DCL     11750--REDEF
REMEM_VAR
     11876**DCL     11876--REDEF
REM_FCMD
     11876**DCL     11877--REDEF
TEXT$C.CNT
     15324**DCL     15325--IMP-SIZ 15601>>ASSIGN
TEXT$C.TEXT
     15325**DCL     15601--ASSIGN
USERS_KEY.TEXT
PL6.E3A0      #002=ASL$DISP_ONE_LINK File=ASL$LIST_LINKS.:E05TSI                 TUE 07/29/97 10:17 Page:107  
     11747**DCL     11748--REDEF   11748--REDEF   11748--REDEF   11749--REDEF
USERS_KEY.TXTC
     11748**DCL     15597>>ASSIGN  15600--ASSIGN
VAL
     15340**DCL     15604<<ASSIGN  15605>>CALLBLT 15606<<ASSIGN  15607>>CALLBLT 15654<<ASSIGN  15655>>CALLBLT
     15656<<ASSIGN  15657>>CALLBLT
VC$
     15341**DCL     15114--IMP-PTR 15693<<ASSIGN  15696<>CALL    15697<>CALL
VC_NAME
     15363**DCL     15696<>CALL
X$FORMAT
     14751**DCL-ENT 15625--CALL    15645--CALL    15689--CALL
