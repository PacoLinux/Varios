VERSION E05

PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:1    
        1        1        /*M* QQA$FPABT - Process forms program abort messages */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QQA$FPABT:
        9        9                PROC(P_TP$EVENT);
       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE B_ERRORS_C;
       16     1277        %INCLUDE QQ_MACROS_C;
       17     1702        %INCLUDE QQ_DATA_R;
       18     1948        %INCLUDE QQ_FPABT_C;
       19     2003        %INCLUDE Q_MACRO_C;
       20     2349        %INCLUDE Q_ERRCODE_C;
       21     2372        %INCLUDE QQ_PERR_C;
       22     2533        %INCLUDE XU_FORMAT_C;
       23     2695        %INCLUDE XUG_ENTRY;
       24     2726        %INCLUDE QT_MACROS_C;
       25     2884        %PAGE(ARG="Parameters");

              2901    1   /***************************************************************************
              2902    1    *                                                                         *
              2903    1    *                                 Parameters                              *
              2904    1    *                                                                         *
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:2    
              2905    1    ***************************************************************************/

       26     2909        %TP$EVENT(FPTN=P_TP$EVENT, STCLASS=);
       27     2978        %PAGE(ARG="Externally defined routines");

              2995    1   /***************************************************************************
              2996    1    *                                                                         *
              2997    1    *                        Externally defined routines                      *
              2998    1    *                                                                         *
              2999    1    ***************************************************************************/

       28     3003    1   DCL QQC$BLDMSG ENTRY(1);
       29     3004    1   DCL QQC$BLDMSG_ERRBLK ENTRY(1);
       30     3005    1   DCL QQC$PRINT_FMTMCT ENTRY(2) ALTRET;
       31     3006    1   DCL QQC$FINDSTA ENTRY(3);
       32     3007    1   DCL QQC$SCREECH ENTRY;
       33     3008    1   DCL X$FORMAT ENTRY(1);
       34     3009        %PAGE(ARG="Symrefs");

              3026    1   /***************************************************************************
              3027    1    *                                                                         *
              3028    1    *                                  Symrefs                                *
              3029    1    *                                                                         *
              3030    1    ***************************************************************************/

       35     3034    1   DCL B$TCB$ PTR SYMREF;
       36     3035        %PAGE(ARG="DCBs");

              3052    1   /***************************************************************************
              3053    1    *                                                                         *
              3054    1    *                                    DCBs                                 *
              3055    1    *                                                                         *
              3056    1    ***************************************************************************/

       37     3060    1   DCL M$CG DCB;
       38     3061        %PAGE(ARG="Based");

PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:3    
              3078    1   /***************************************************************************
              3079    1    *                                                                         *
              3080    1    *                                   Based                                 *
              3081    1    *                                                                         *
              3082    1    ***************************************************************************/

       39     3086        %QT$FORM(STCLASS=BASED);
       40     3125    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
       41     3126
       42     3127        %SET LISTMAC = '1'B;
       43     3128        %Q_FPABT(FPTN=Q$FPABT,STCLASS="BASED(QQ_GLOBAL.CMDBUF$)");
              3129         %LSET LISTDIR='0'B;
              3143    1   DCL 1 Q$FPABT BASED(QQ_GLOBAL.CMDBUF$),
              3144    1         2 FPABTTXT# CHAR(6) /*('*FPABT')*/,
              3150    1         2 LANG# CHAR(1) CALIGNED /*(' ')*/,
              3153    1         2 MSGCNT# UBIN BYTE UNAL /*(3)*/,
              3157    1         2 MSGS(0:2) CALIGNED,
              3175    1   3 ERR CALIGNED,
              3189    1   4 FCG  BIT(12)/*('0'B)/**/ ,
              3202    1   4 MID  BIT(6)/*('0'B)/**/ ,4 MON  BIT(1)/*('0'B)/**/ ,
              3203    1   4 ERR#  UBIN(14)/*(0)/**/ UNAL,4 SEV  UBIN(3)/*(0)/**/
              3204    1   UNAL ,
              3206    1           3 U1 CALIGNED,
              3207    1             4 LEN# UBIN BYTE UNAL,
              3208    1             4 NAME# CHAR(31) CALIGNED,
              3209    1           3 U2 CALIGNED,
              3210    1             4 LEN# UBIN BYTE UNAL,
              3211    1             4 NAME# CHAR(31) CALIGNED,
              3212    1           3 U3 CALIGNED,
              3213    1             4 LEN# UBIN BYTE UNAL,
              3214    1             4 NAME# CHAR(31) CALIGNED;
       44     3216        %FP$ABT;
              3217    1   DCL 1 FPTN STCLASS,
              3218    1         2 REASON,
              3219    1           3 FCG UBIN(18) UNAL,
              3220    1           3 ERR,
              3221    1             4 * BIT(1) UNAL,
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:4    
              3222    1             4 BYTE0 UBIN(8) UNAL,
              3223    1             4 * BIT(1) UNAL,
              3224    1             4 BYTE1 UBIN(8) UNAL,
              3225    1         2 INSTR,
              3226    1           3 FCG UBIN(18) UNAL,
              3227    1           3 OPCODE,
              3228    1             4 * BIT(1) UNAL,
              3229    1             4 BYTE0 UBIN(8) UNAL,
              3230    1             4 * BIT(1) UNAL,
              3231    1             4 BYTE1 UBIN(8) UNAL,
              3232    1         2 PGM_IC CHAR(6),
              3233    1         2 INTERP_IC CHAR(6),
              3234    1         2 PGM,
              3235    1           3 NAME,
              3236    1             4 CNT,
              3237    1               5 * BIT(1) UNAL,
              3238    1               5 BYTE0 UBIN(8) UNAL,
              3239    1             4 TXT CHAR(31),
              3240    1           3 ACCT CHAR(8),
              3241    1           3 PSN CHAR(6),
              3242    1           3 MODTIME,
              3243    1             4 * BIT(1) UNAL,
              3244    1             4 BYTE0 UBIN(8) UNAL,
              3245    1             4 * BIT(1) UNAL,
              3246    1             4 BYTE1 UBIN(8) UNAL,
              3247    1             4 * BIT(1) UNAL,
              3248    1             4 BYTE2 UBIN(8) UNAL,
              3249    1             4 * BIT(1) UNAL,
              3250    1             4 BYTE3 UBIN(8) UNAL,
              3251    1             4 * BIT(1) UNAL,
              3252    1             4 BYTE4 UBIN(8) UNAL,
              3253    1         2 * CHAR(1),
              3254    1         2 DATE,
              3255    1           3 YY CHAR(2),
              3256    1           3 MM CHAR(2),
              3257    1           3 DD CHAR(2),
              3258    1         2 TIME,
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:5    
              3259    1           3 HH CHAR(2),
              3260    1           3 MM CHAR(2),
              3261    1         2 * CHAR(14);
       45     3263    1   DCL 1 VLP$FPRG BASED (P$),
       46     3264    1         2 * BIT(18),
       47     3265    1         2 PSN# CHAR(6) UNAL,
       48     3266    1         2 NAME,
       49     3267    1           3 L# UBIN BYTE UNAL,
       50     3268    1           3 C# CHAR(31),
       51     3269    1         2 ACCT# CHAR(8),
       52     3270    1         2 PASS# CHAR(8);
       53     3271        %SET LISTMAC = '0'B;
       54     3272        %TP$STATION;
       55     3345        %B$TCB;
       56     3348        %B$ALT;
       57     3356                %PAGE(ARG="Constants");

              3373    1   /***************************************************************************
              3374    1    *                                                                         *
              3375    1    *                                 Constants                               *
              3376    1    *                                                                         *
              3377    1    ***************************************************************************/

       58     3381    1   DCL 1 FORMAT1 CONSTANT,
       59     3382    1         2 * CHAR(0) INIT(
              3382                  'Time=%5..4U *Forms program abort*%/Station=%A Type=%A%/Forms program=%A')
              3382                  ,
       60     3383    1         2 * CHAR(0) INIT('%/Error:');
       61     3384
       62     3385        %PAGE(ARG="Static");

              3402    1   /***************************************************************************
              3403    1    *                                                                         *
              3404    1    *                                   Static                                *
              3405    1    *                                                                         *
              3406    1    ***************************************************************************/

PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:6    
       63     3410    1   DCL STATION CHAR(8) STATIC;
       64     3411    1   DCL FID CHAR(80) STATIC;
       65     3412
       66     3413    1   DCL UNFID_SIZE UBIN WORD STATIC;
       67     3414
       68     3415        %F_FDS(OUTPUT=QQC$PRINT_FMTMCT, DVFC=' ');
       69     3528        %PAGE(ARG="Auto");

              3545    1   /***************************************************************************
              3546    1    *                                                                         *
              3547    1    *                                    Auto                                 *
              3548    1    *                                                                         *
              3549    1    ***************************************************************************/

       70     3553    1   DCL BUF CHAR(80);
       71     3554
       72     3555    1   DCL CHAR_STRING_SIZE UBIN WORD;
       73     3556    1   DCL ALIGNED_OPCODE UBIN WORD;
       74     3557    1   DCL ALIGNED_ERRCODE UBIN WORD;
       75     3558
       76     3559    1   DCL P$  PTR;
       77     3560
       78     3561    1   DCL FOUND_FLAG BIT(1) ALIGNED;
       79     3562    1   DCL DATA_VECTRS(0:19) BIT(72);
       80     3563
       81     3564
       82     3565        %VLP_NAME(FPTN=TEXTC_STATION, LEN=8, STCLASS=);
       83     3592        %MSGBLK;
       84     3682        %B$CGAURD;
       85     3701        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:7    
              3718    1   /***************************************************************************
              3719    1    *                                                                         *
              3720    1    *                                Error codes                              *
              3721    1    *                                                                         *
              3722    1    ***************************************************************************/

       86     3726        %ERRCODE(NAME=CODE_CFPABT, CODE#=%E$CFPABT, FCG#=%FCG_QQ, MID#=%MID_A);
       87     3733        %ERRCODE(NAME=CODE_IFP, CODE#=%E$IFP, FCG#=%FCG_QQ, MID#=%MID_B);
       88     3740        %ERRCODE(NAME=CODE_FPABT_NOSTA, CODE#=%E$FPABT_NOSTA, FCG#=%FCG_QQ, MID#=%MID_A);
       89     3747        /*E*       ERROR: QQA-E$CFPABT-C
       90     3748
       91     3749                 MESSAGE: The Command Forms Program has aborted for
       92     3750                          station %U1.
       93     3751             DESCRIPTION: See the FP abort message to find out why the
       94     3752                          Command forms program has aborted.  The station
       95     3753                          will be disconnected.
       96     3754        */
       97     3755        /*E*       ERROR: QQA-E$FPABT_NOSTA-C
       98     3756
       99     3757                 MESSAGE: No station context is available for station %U1
      100     3758                          which reported a forms program abort.
      101     3759             DESCRIPTION: See the FP abort message to find out why the
      102     3760                          forms program has aborted. The station will be
      103     3761                          disconnected.
      104     3762        */
      105     3763        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:8    
              3780    1   /***************************************************************************
              3781    1    *                                                                         *
              3782    1    *                                    FPTs                                 *
              3783    1    *                                                                         *
              3784    1    ***************************************************************************/

      106     3788        %FPT_OPEN(ASN=FILE);
      107     3897
      108     3898        %FPT_UNFID(TEXTFID=FID, NAME=VLP_NAME, ACCT=VLP_ACCT, PASS=VLP_PASS,
      109     3899        ASN="FPT_OPEN.V.ASN#", SN=VLP_SN, WSN=VLP_WSN,
      110     3900        RES="FPT_OPEN.V.RES#", LEN=UNFID_SIZE);
      111     3918
      112     3919        %FPT_ACTIVATE(FPTN=FPT_DEACTIVATE, DCB=M$CG, STATION=STATION, DISCONNECT=YES);
      113     3942        %PAGE(ARG="VLPs");

              3959    1   /***************************************************************************
              3960    1    *                                                                         *
              3961    1    *                                    VLPs                                 *
              3962    1    *                                                                         *
              3963    1    ***************************************************************************/

      114     3967        %VLP_NAME;
      115     3994        %VLP_ACCT;
      116     4007        %VLP_PASS;
      117     4020        %VLP_SN;
      118     4033        %VLP_WSN;
      119     4046        %PAGE(ARG="QQA$FPABT", PAGE=YES);

PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:9    
              4063    1   /***************************************************************************
              4064    1    *                                                                         *
              4065    1    *                                 QQA$FPABT                               *
              4066    1    *                                                                         *
              4067    1    ***************************************************************************/

      120     4071    1           F_FDS.BUF_ = VECTOR(BUF);
      121     4072    1           F_FDS.VECTR$ = ADDR(DATA_VECTRS);
      122     4073    1           F_FDS.NVECS# = 3  /*  Used ta be 13  */;
      123     4074    1           F_FDS.FMT_ = VECTOR(FORMAT1);
      124     4075
      125     4076    1           DATA_VECTRS(0) = VECTOR(P_TP$EVENT.VLP_STATION.STATION#);
      126     4077
      127     4078    1           CALL QQC$FINDSTA(P_TP$EVENT.VLP_STATION.STATION#,S$, FOUND_FLAG);
      128     4079    2           IF ~FOUND_FLAG THEN DO;
      129     4080    2               CALL QQC$BLDMSG_ERRBLK(MSGBLK);
      130     4081    2               MSGBLK.ERRINFO.ERR(0) = CODE_FPABT_NOSTA;
      131     4082    2               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_STATION);
      132     4083    2               TEXTC_STATION.L# = 8;
      133     4084    2               TEXTC_STATION.NAME# = P_TP$EVENT.VLP_STATION.STATION#;
      134     4085    2               CALL QQC$BLDMSG(MSGBLK);
      135     4086    2               STATION = P_TP$EVENT.VLP_STATION.STATION#;
      136     4087    2               CALL M$DEACTIVATE(FPT_DEACTIVATE) ALTRET(DEACTIVATE_ERR);
      137     4088    2               RETURN;
      138     4089    2             END;
      139     4090    1           DATA_VECTRS(1) = VECTOR(TP$STATION.FP);
      140     4091
      141     4092    1           IF TP$STATION.FPLDTRC$ ~= ADDR(NIL)
      142     4093    1           THEN
      143     4094    2             DO;
      144     4095    2               P$ = TP$STATION.FPLDTRC$;   /* pointer to context read on LDTRC   */
      145     4096    2               VLP_NAME.L# = VLP$FPRG.NAME.L#;
      146     4097    2               VLP_NAME.NAME# = VLP$FPRG.NAME.C#;
      147     4098    2               VLP_ACCT.ACCT# = VLP$FPRG.ACCT#;
      148     4099    2               VLP_SN.SN#(0) = VLP$FPRG.PSN#;
      149     4100    2               VLP_PASS.PASS# = ' ';
      150     4101    2               CALL M$UNFID(FPT_UNFID) ALTRET(UNFID_ERR);
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:10   
      151     4102    2               CHAR_STRING_SIZE = UNFID_SIZE;
      152     4103    2             END;
      153     4104
      154     4105    1           ELSE IF TP$STATION.QT$FORM$ ~= ADDR(NIL) THEN
      155     4106    2               DO;
      156     4107    2                 VLP_NAME.L# = TP$STATION.QT$FORM$->QT$FORM.FP.NAME.COUNT;
      157     4108    2                 VLP_NAME.NAME# = TP$STATION.QT$FORM$->QT$FORM.FP.NAME.TEXT;
      158     4109    2                 VLP_ACCT.ACCT# = TP$STATION.QT$FORM$->QT$FORM.FP.ACCT;
      159     4110    2                 VLP_SN.SN#(0) = TP$STATION.QT$FORM$->QT$FORM.FP.SN;
      160     4111    2               END;
      161     4112
      162     4113    2             ELSE DO;
      163     4114    2   UNFID_ERR:
      164     4115    2                 DATA_VECTRS(2) = VECTOR(NIL);
      165     4116    2                 GOTO FRMT;
      166     4117    2               END;
      167     4118    1           VLP_PASS.PASS# = ' ';
      168     4119    1           CALL M$UNFID(FPT_UNFID) ALTRET(UNFID_ERR);
      169     4120    1           CHAR_STRING_SIZE = UNFID_SIZE;
      170     4121
      171     4122    1           DATA_VECTRS(2) = VECTOR(ADDR(FID) -> CHAR$STRING);
      172     4123
      173     4124    1   FRMT:
      174     4125    1           CALL X$FORMAT(F_FDS);
      175     4126
      176     4127    1           CALL QQC$BLDMSG_ERRBLK(MSGBLK);
      177     4128    1           CALL XUG$ERRCNVRT(Q$FPABT.MSGS.ERR(0),MSGBLK.ERRINFO.ERR(0));
      178     4129    1           IF Q$FPABT.MSGS.U1.LEN#(0) ~= 0
      179     4130    1           THEN
      180     4131    2             DO;
      181     4132    2               MSGBLK.ERRINFO.FIELD1(0) = VECTOR( Q$FPABT.MSGS.U1(0));
      182     4133    2             END;
      183     4134    1           IF Q$FPABT.MSGS.U2.LEN#(0) ~= 0
      184     4135    1           THEN
      185     4136    2             DO;
      186     4137    2               MSGBLK.ERRINFO.FIELD2(0) = VECTOR(Q$FPABT.MSGS.U2(0));
      187     4138    2             END;
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:11   
      188     4139    1           IF Q$FPABT.MSGS.U3.LEN#(0) ~= 0
      189     4140    1           THEN
      190     4141    2             DO;
      191     4142    2               MSGBLK.ERRINFO.FIELD3(0) = VECTOR(Q$FPABT.MSGS.U3(0));
      192     4143    2             END;
      193     4144    1           CALL QQC$BLDMSG(MSGBLK);
      194     4145
      195     4146    1           CALL QQC$BLDMSG_ERRBLK(MSGBLK);
      196     4147    1           CALL XUG$ERRCNVRT(Q$FPABT.MSGS.ERR(1),MSGBLK.ERRINFO.ERR(0));
      197     4148    1           IF Q$FPABT.MSGS.U1.LEN#(1) ~= 0
      198     4149    1           THEN
      199     4150    2             DO;
      200     4151    2               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(Q$FPABT.MSGS.U1(1));
      201     4152    2             END;
      202     4153    1           IF Q$FPABT.MSGS.U2.LEN#(1) ~= 0
      203     4154    1           THEN
      204     4155    2             DO;
      205     4156    2               MSGBLK.ERRINFO.FIELD2(0) = VECTOR(Q$FPABT.MSGS.U2(1));
      206     4157    2             END;
      207     4158    1           IF Q$FPABT.MSGS.U3.LEN#(1) ~= 0
      208     4159    1           THEN
      209     4160    2             DO;
      210     4161    2               MSGBLK.ERRINFO.FIELD3(0) = VECTOR(Q$FPABT.MSGS.U3(1));
      211     4162    2             END;
      212     4163    1           CALL QQC$BLDMSG(MSGBLK);
      213     4164
      214     4165    1           IF Q$FPABT.MSGCNT# > 2
      215     4166    1           THEN
      216     4167    2             DO;
      217     4168    2               CALL QQC$BLDMSG_ERRBLK(MSGBLK);
      218     4169    2               CALL XUG$ERRCNVRT(Q$FPABT.MSGS.ERR(2),MSGBLK.ERRINFO.ERR(0));
      219     4170    2               IF Q$FPABT.MSGS.U1.LEN#(2) ~= 0
      220     4171    2               THEN
      221     4172    3                 DO;
      222     4173    3                   MSGBLK.ERRINFO.FIELD1(0) = VECTOR(Q$FPABT.MSGS.U1(2));
      223     4174    3                 END;
      224     4175    2               IF Q$FPABT.MSGS.U2.LEN#(2) ~= 0
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:12   
      225     4176    2               THEN
      226     4177    3                 DO;
      227     4178    3                   MSGBLK.ERRINFO.FIELD2(0) = VECTOR(Q$FPABT.MSGS.U2(2));
      228     4179    3                 END;
      229     4180    2               IF Q$FPABT.MSGS.U3.LEN#(2) ~= 0
      230     4181    2               THEN
      231     4182    3                 DO;
      232     4183    3                   MSGBLK.ERRINFO.FIELD3(0) = VECTOR(Q$FPABT.MSGS.U3(2));
      233     4184    3                 END;
      234     4185    2               CALL QQC$BLDMSG(MSGBLK);
      235     4186    2             END;
      236     4187
      237     4188    1           IF TP$STATION.FP ~= '*DFLT' THEN
      238     4189    2             DO;
      239     4190    2               GOTO RET;
      240     4191    2             END;
      241     4192
      242     4193    1           IF TP$STATION.QT$FORM$ = ADDR(NIL) OR
      243     4194    1               TP$STATION.FPLDTRC$ = ADDR(NIL) THEN
      244     4195    2             DO;
      245     4196
      246     4197    2               CALL QQC$BLDMSG_ERRBLK(MSGBLK);
      247     4198    2               MSGBLK.ERRINFO.ERR(0) = CODE_CFPABT;
      248     4199    2               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_STATION);
      249     4200    2               TEXTC_STATION.L# = 8;
      250     4201    2               TEXTC_STATION.NAME# = TP$STATION.ID;
      251     4202    2               CALL QQC$BLDMSG(MSGBLK);
      252     4203
      253     4204    2               STATION = TP$STATION.ID;
      254     4205    2               CALL M$DEACTIVATE(FPT_DEACTIVATE) ALTRET(DEACTIVATE_ERR);
      255     4206
      256     4207    2             END;
      257     4208
      258     4209    2           DO WHILE('0'B);
      259     4210
      260     4211    2   DEACTIVATE_ERR:
      261     4212    2             IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 1154 /* E$CGAFNS */ THEN
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:13   
      262     4213    3               DO;
      263     4214    3                 GOTO MON_ERR;
      264     4215    3               END;
      265     4216    2           END /* NEVER */;
      266     4217
      267     4218    1   RET:
      268     4219    1           RETURN;
      269     4220
      270     4221    1   MON_ERR:
      271     4222    1           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      272     4223    1           CALL QQC$SCREECH;
      273     4224
      274     4225    1   END QQA$FPABT;

PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:14   
--  Include file information  --

   QT_MACROS_C.:E05TOU  is referenced.
   XUG_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   Q_MACRO_C.:E05TOU  is referenced.
   QQ_FPABT_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQA$FPABT.

   Procedure QQA$FPABT requires 394 words for executable code.
   Procedure QQA$FPABT requires 98 words of local(AUTO) storage.

    No errors detected in file QQA$FPABT.:E05TSI    .

PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:15   

 Object Unit name= QQA$FPABT                                  File name= QQA$FPABT.:E05TOU
 UTS= JUL 30 '97 05:23:01.32 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$CG
    2  RoData even  UTS     25     31  QQA$FPABT
    3   Data  even  none   168    250  QQA$FPABT
    4   Proc  even  none   394    612  QQA$FPABT
    5  RoData even  none    10     12  QQA$FPABT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        1  QQA$FPABT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 QQC$PRINT_FMTMCT
         yes           Std       1 QQC$BLDMSG
         yes           Std       1 X$FORMAT
         yes           Std       2 XUG$ERRCNVRT
         yes           Std       0 QQC$SCREECH
         yes           Std       3 QQC$FINDSTA
         yes           Std       1 QQC$BLDMSG_ERRBLK
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:16   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  QQ_GLOBAL                             B$TCB$
     M$CG                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:17   


        1        1        /*M* QQA$FPABT - Process forms program abort messages */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QQA$FPABT:
        9        9                PROC(P_TP$EVENT);

      9  4 000000   000000 700200 xent  QQA$FPABT    TSX0  ! X66_AUTO_1
         4 000001   000142 000001                    ZERO    98,1

       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE B_ERRORS_C;
       16     1277        %INCLUDE QQ_MACROS_C;
       17     1702        %INCLUDE QQ_DATA_R;
       18     1948        %INCLUDE QQ_FPABT_C;
       19     2003        %INCLUDE Q_MACRO_C;
       20     2349        %INCLUDE Q_ERRCODE_C;
       21     2372        %INCLUDE QQ_PERR_C;
       22     2533        %INCLUDE XU_FORMAT_C;
       23     2695        %INCLUDE XUG_ENTRY;
       24     2726        %INCLUDE QT_MACROS_C;
       25     2884        %PAGE(ARG="Parameters");
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:18   

              2901    1   /***************************************************************************
              2902    1    *                                                                         *
              2903    1    *                                 Parameters                              *
              2904    1    *                                                                         *
              2905    1    ***************************************************************************/

       26     2909        %TP$EVENT(FPTN=P_TP$EVENT, STCLASS=);
       27     2978        %PAGE(ARG="Externally defined routines");

              2995    1   /***************************************************************************
              2996    1    *                                                                         *
              2997    1    *                        Externally defined routines                      *
              2998    1    *                                                                         *
              2999    1    ***************************************************************************/

       28     3003    1   DCL QQC$BLDMSG ENTRY(1);
       29     3004    1   DCL QQC$BLDMSG_ERRBLK ENTRY(1);
       30     3005    1   DCL QQC$PRINT_FMTMCT ENTRY(2) ALTRET;
       31     3006    1   DCL QQC$FINDSTA ENTRY(3);
       32     3007    1   DCL QQC$SCREECH ENTRY;
       33     3008    1   DCL X$FORMAT ENTRY(1);
       34     3009        %PAGE(ARG="Symrefs");

              3026    1   /***************************************************************************
              3027    1    *                                                                         *
              3028    1    *                                  Symrefs                                *
              3029    1    *                                                                         *
              3030    1    ***************************************************************************/

       35     3034    1   DCL B$TCB$ PTR SYMREF;
       36     3035        %PAGE(ARG="DCBs");

              3052    1   /***************************************************************************
              3053    1    *                                                                         *
              3054    1    *                                    DCBs                                 *
              3055    1    *                                                                         *
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:19   
              3056    1    ***************************************************************************/

       37     3060    1   DCL M$CG DCB;
       38     3061        %PAGE(ARG="Based");

              3078    1   /***************************************************************************
              3079    1    *                                                                         *
              3080    1    *                                   Based                                 *
              3081    1    *                                                                         *
              3082    1    ***************************************************************************/

       39     3086        %QT$FORM(STCLASS=BASED);
       40     3125    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
       41     3126
       42     3127        %SET LISTMAC = '1'B;
       43     3128        %Q_FPABT(FPTN=Q$FPABT,STCLASS="BASED(QQ_GLOBAL.CMDBUF$)");
              3129         %LSET LISTDIR='0'B;
              3143    1   DCL 1 Q$FPABT BASED(QQ_GLOBAL.CMDBUF$),
              3144    1         2 FPABTTXT# CHAR(6) /*('*FPABT')*/,
              3150    1         2 LANG# CHAR(1) CALIGNED /*(' ')*/,
              3153    1         2 MSGCNT# UBIN BYTE UNAL /*(3)*/,
              3157    1         2 MSGS(0:2) CALIGNED,
              3175    1   3 ERR CALIGNED,
              3189    1   4 FCG  BIT(12)/*('0'B)/**/ ,
              3202    1   4 MID  BIT(6)/*('0'B)/**/ ,4 MON  BIT(1)/*('0'B)/**/ ,
              3203    1   4 ERR#  UBIN(14)/*(0)/**/ UNAL,4 SEV  UBIN(3)/*(0)/**/
              3204    1   UNAL ,
              3206    1           3 U1 CALIGNED,
              3207    1             4 LEN# UBIN BYTE UNAL,
              3208    1             4 NAME# CHAR(31) CALIGNED,
              3209    1           3 U2 CALIGNED,
              3210    1             4 LEN# UBIN BYTE UNAL,
              3211    1             4 NAME# CHAR(31) CALIGNED,
              3212    1           3 U3 CALIGNED,
              3213    1             4 LEN# UBIN BYTE UNAL,
              3214    1             4 NAME# CHAR(31) CALIGNED;
       44     3216        %FP$ABT;
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:20   
              3217    1   DCL 1 FPTN STCLASS,
              3218    1         2 REASON,
              3219    1           3 FCG UBIN(18) UNAL,
              3220    1           3 ERR,
              3221    1             4 * BIT(1) UNAL,
              3222    1             4 BYTE0 UBIN(8) UNAL,
              3223    1             4 * BIT(1) UNAL,
              3224    1             4 BYTE1 UBIN(8) UNAL,
              3225    1         2 INSTR,
              3226    1           3 FCG UBIN(18) UNAL,
              3227    1           3 OPCODE,
              3228    1             4 * BIT(1) UNAL,
              3229    1             4 BYTE0 UBIN(8) UNAL,
              3230    1             4 * BIT(1) UNAL,
              3231    1             4 BYTE1 UBIN(8) UNAL,
              3232    1         2 PGM_IC CHAR(6),
              3233    1         2 INTERP_IC CHAR(6),
              3234    1         2 PGM,
              3235    1           3 NAME,
              3236    1             4 CNT,
              3237    1               5 * BIT(1) UNAL,
              3238    1               5 BYTE0 UBIN(8) UNAL,
              3239    1             4 TXT CHAR(31),
              3240    1           3 ACCT CHAR(8),
              3241    1           3 PSN CHAR(6),
              3242    1           3 MODTIME,
              3243    1             4 * BIT(1) UNAL,
              3244    1             4 BYTE0 UBIN(8) UNAL,
              3245    1             4 * BIT(1) UNAL,
              3246    1             4 BYTE1 UBIN(8) UNAL,
              3247    1             4 * BIT(1) UNAL,
              3248    1             4 BYTE2 UBIN(8) UNAL,
              3249    1             4 * BIT(1) UNAL,
              3250    1             4 BYTE3 UBIN(8) UNAL,
              3251    1             4 * BIT(1) UNAL,
              3252    1             4 BYTE4 UBIN(8) UNAL,
              3253    1         2 * CHAR(1),
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:21   
              3254    1         2 DATE,
              3255    1           3 YY CHAR(2),
              3256    1           3 MM CHAR(2),
              3257    1           3 DD CHAR(2),
              3258    1         2 TIME,
              3259    1           3 HH CHAR(2),
              3260    1           3 MM CHAR(2),
              3261    1         2 * CHAR(14);
       45     3263    1   DCL 1 VLP$FPRG BASED (P$),
       46     3264    1         2 * BIT(18),
       47     3265    1         2 PSN# CHAR(6) UNAL,
       48     3266    1         2 NAME,
       49     3267    1           3 L# UBIN BYTE UNAL,
       50     3268    1           3 C# CHAR(31),
       51     3269    1         2 ACCT# CHAR(8),
       52     3270    1         2 PASS# CHAR(8);
       53     3271        %SET LISTMAC = '0'B;
       54     3272        %TP$STATION;
       55     3345        %B$TCB;
       56     3348        %B$ALT;
       57     3356                %PAGE(ARG="Constants");

              3373    1   /***************************************************************************
              3374    1    *                                                                         *
              3375    1    *                                 Constants                               *
              3376    1    *                                                                         *
              3377    1    ***************************************************************************/

       58     3381    1   DCL 1 FORMAT1 CONSTANT,
       59     3382    1         2 * CHAR(0) INIT(
              3382                 'Time=%5..4U *Forms program abort*%/Station=%A Type=%A%/Forms program=%A')
              3382                  ,
       60     3383    1         2 * CHAR(0) INIT('%/Error:');
       61     3384
       62     3385        %PAGE(ARG="Static");

              3402    1   /***************************************************************************
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:22   
              3403    1    *                                                                         *
              3404    1    *                                   Static                                *
              3405    1    *                                                                         *
              3406    1    ***************************************************************************/

       63     3410    1   DCL STATION CHAR(8) STATIC;
       64     3411    1   DCL FID CHAR(80) STATIC;
       65     3412
       66     3413    1   DCL UNFID_SIZE UBIN WORD STATIC;
       67     3414
       68     3415        %F_FDS(OUTPUT=QQC$PRINT_FMTMCT, DVFC=' ');
       69     3528        %PAGE(ARG="Auto");

              3545    1   /***************************************************************************
              3546    1    *                                                                         *
              3547    1    *                                    Auto                                 *
              3548    1    *                                                                         *
              3549    1    ***************************************************************************/

       70     3553    1   DCL BUF CHAR(80);
       71     3554
       72     3555    1   DCL CHAR_STRING_SIZE UBIN WORD;
       73     3556    1   DCL ALIGNED_OPCODE UBIN WORD;
       74     3557    1   DCL ALIGNED_ERRCODE UBIN WORD;
       75     3558
       76     3559    1   DCL P$  PTR;
       77     3560
       78     3561    1   DCL FOUND_FLAG BIT(1) ALIGNED;
       79     3562    1   DCL DATA_VECTRS(0:19) BIT(72);
       80     3563
       81     3564
       82     3565        %VLP_NAME(FPTN=TEXTC_STATION, LEN=8, STCLASS=);
       83     3592        %MSGBLK;
       84     3682        %B$CGAURD;
       85     3701        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:23   
              3718    1   /***************************************************************************
              3719    1    *                                                                         *
              3720    1    *                                Error codes                              *
              3721    1    *                                                                         *
              3722    1    ***************************************************************************/

       86     3726        %ERRCODE(NAME=CODE_CFPABT, CODE#=%E$CFPABT, FCG#=%FCG_QQ, MID#=%MID_A);
       87     3733        %ERRCODE(NAME=CODE_IFP, CODE#=%E$IFP, FCG#=%FCG_QQ, MID#=%MID_B);
       88     3740        %ERRCODE(NAME=CODE_FPABT_NOSTA, CODE#=%E$FPABT_NOSTA, FCG#=%FCG_QQ, MID#=%MID_A);
       89     3747        /*E*       ERROR: QQA-E$CFPABT-C
       90     3748
       91     3749                 MESSAGE: The Command Forms Program has aborted for
       92     3750                          station %U1.
       93     3751             DESCRIPTION: See the FP abort message to find out why the
       94     3752                          Command forms program has aborted.  The station
       95     3753                          will be disconnected.
       96     3754        */
       97     3755        /*E*       ERROR: QQA-E$FPABT_NOSTA-C
       98     3756
       99     3757                 MESSAGE: No station context is available for station %U1
      100     3758                          which reported a forms program abort.
      101     3759             DESCRIPTION: See the FP abort message to find out why the
      102     3760                          forms program has aborted. The station will be
      103     3761                          disconnected.
      104     3762        */
      105     3763        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:24   
              3780    1   /***************************************************************************
              3781    1    *                                                                         *
              3782    1    *                                    FPTs                                 *
              3783    1    *                                                                         *
              3784    1    ***************************************************************************/

      106     3788        %FPT_OPEN(ASN=FILE);
      107     3897
      108     3898        %FPT_UNFID(TEXTFID=FID, NAME=VLP_NAME, ACCT=VLP_ACCT, PASS=VLP_PASS,
      109     3899        ASN="FPT_OPEN.V.ASN#", SN=VLP_SN, WSN=VLP_WSN,
      110     3900        RES="FPT_OPEN.V.RES#", LEN=UNFID_SIZE);
      111     3918
      112     3919        %FPT_ACTIVATE(FPTN=FPT_DEACTIVATE, DCB=M$CG, STATION=STATION, DISCONNECT=YES);
      113     3942        %PAGE(ARG="VLPs");

              3959    1   /***************************************************************************
              3960    1    *                                                                         *
              3961    1    *                                    VLPs                                 *
              3962    1    *                                                                         *
              3963    1    ***************************************************************************/

      114     3967        %VLP_NAME;
      115     3994        %VLP_ACCT;
      116     4007        %VLP_PASS;
      117     4020        %VLP_SN;
      118     4033        %VLP_WSN;
      119     4046        %PAGE(ARG="QQA$FPABT", PAGE=YES);

PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:25   
              4063    1   /***************************************************************************
              4064    1    *                                                                         *
              4065    1    *                                 QQA$FPABT                               *
              4066    1    *                                                                         *
              4067    1    ***************************************************************************/

      120     4071    1           F_FDS.BUF_ = VECTOR(BUF);

   4071  4 000002   000000 235000 5                  LDA     0
         4 000003   200136 452500                    STP2    MSGBLK+21,,AUTO
         4 000004   200136 236100                    LDQ     MSGBLK+21,,AUTO
         4 000005   000005 036003                    ADLQ    5,DU
         4 000006   000034 757000 3                  STAQ    F_FDS+5

      121     4072    1           F_FDS.VECTR$ = ADDR(DATA_VECTRS);

   4072  4 000007   200036 630500                    EPPR0   DATA_VECTRS,,AUTO
         4 000010   000041 450400 3                  STP0    F_FDS+10

      122     4073    1           F_FDS.NVECS# = 3  /*  Used ta be 13  */;

   4073  4 000011   000003 235007                    LDA     3,DL
         4 000012   000040 755000 3                  STA     F_FDS+9

      123     4074    1           F_FDS.FMT_ = VECTOR(FORMAT1);

   4074  4 000013   000002 237000 5                  LDAQ    2
         4 000014   000027 755000 3                  STA     F_FDS
         4 000015   000030 756000 3                  STQ     F_FDS+1

      124     4075
      125     4076    1           DATA_VECTRS(0) = VECTOR(P_TP$EVENT.VLP_STATION.STATION#);

   4076  4 000016   000001 235000 5                  LDA     1
         4 000017   200003 236100                    LDQ     @P_TP$EVENT,,AUTO
         4 000020   000011 036003                    ADLQ    9,DU
         4 000021   200036 757100                    STAQ    DATA_VECTRS,,AUTO
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:26   

      126     4077
      127     4078    1           CALL QQC$FINDSTA(P_TP$EVENT.VLP_STATION.STATION#,S$, FOUND_FLAG);

   4078  4 000022   200035 631500                    EPPR1   FOUND_FLAG,,AUTO
         4 000023   200140 451500                    STP1    MSGBLK+23,,AUTO
         4 000024   200004 633500                    EPPR3   S$,,AUTO
         4 000025   200137 453500                    STP3    MSGBLK+22,,AUTO
         4 000026   200003 236100                    LDQ     @P_TP$EVENT,,AUTO
         4 000027   000011 036003                    ADLQ    9,DU
         4 000030   200136 756100                    STQ     MSGBLK+21,,AUTO
         4 000031   200136 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000032   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000033   000000 701000 xent               TSX1    QQC$FINDSTA
         4 000034   000000 011000                    NOP     0

      128     4079    2           IF ~FOUND_FLAG THEN DO;

   4079  4 000035   200035 236100                    LDQ     FOUND_FLAG,,AUTO
         4 000036   400000 376003                    ANQ     -131072,DU
         4 000037   400000 676003                    ERQ     -131072,DU
         4 000040   000106 600000 4                  TZE     s:4090

      129     4080    2               CALL QQC$BLDMSG_ERRBLK(MSGBLK);

   4080  4 000041   200111 630500                    EPPR0   MSGBLK,,AUTO
         4 000042   200136 450500                    STP0    MSGBLK+21,,AUTO
         4 000043   200136 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000044   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000045   000000 701000 xent               TSX1    QQC$BLDMSG_ERRBLK
         4 000046   000000 011000                    NOP     0

      130     4081    2               MSGBLK.ERRINFO.ERR(0) = CODE_FPABT_NOSTA;

   4081  4 000047   000026 236000 2                  LDQ     CODE_FPABT_NOSTA
         4 000050   200117 756100                    STQ     MSGBLK+6,,AUTO

PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:27   
      131     4082    2               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_STATION);

   4082  4 000051   000004 235000 5                  LDA     4
         4 000052   200136 452500                    STP2    MSGBLK+21,,AUTO
         4 000053   200136 236100                    LDQ     MSGBLK+21,,AUTO
         4 000054   000106 036003                    ADLQ    70,DU
         4 000055   200140 757100                    STAQ    MSGBLK+23,,AUTO
         4 000056   000100 100500                    MLR     fill='000'O
         4 000057   200140 000010                    ADSC9   MSGBLK+23,,AUTO          cn=0,n=8
         4 000060   200120 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8

      132     4083    2               TEXTC_STATION.L# = 8;

   4083  4 000061   010000 236003                    LDQ     4096,DU
         4 000062   200106 552140                    STBQ    TEXTC_STATION,'40'O,AUTO

      133     4084    2               TEXTC_STATION.NAME# = P_TP$EVENT.VLP_STATION.STATION#;

   4084  4 000063   200003 470500                    LDP0    @P_TP$EVENT,,AUTO
         4 000064   040100 100500                    MLR     fill='040'O
         4 000065   000011 000010                    ADSC9   9,,PR0                   cn=0,n=8
         4 000066   200106 200010                    ADSC9   TEXTC_STATION,,AUTO      cn=1,n=8

      134     4085    2               CALL QQC$BLDMSG(MSGBLK);

   4085  4 000067   200111 631500                    EPPR1   MSGBLK,,AUTO
         4 000070   200136 451500                    STP1    MSGBLK+21,,AUTO
         4 000071   200136 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000072   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000073   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000074   000000 011000                    NOP     0

      135     4086    2               STATION = P_TP$EVENT.VLP_STATION.STATION#;

   4086  4 000075   200003 470500                    LDP0    @P_TP$EVENT,,AUTO
         4 000076   040000 100500                    MLR     fill='040'O
         4 000077   000011 000010                    ADSC9   9,,PR0                   cn=0,n=8
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:28   
         4 000100   000000 000010 3                  ADSC9   STATION                  cn=0,n=8

      136     4087    2               CALL M$DEACTIVATE(FPT_DEACTIVATE) ALTRET(DEACTIVATE_ERR);

   4087  4 000101   000206 630400 3                  EPPR0   FPT_DEACTIVATE
         4 000102   500001 713400                    CLIMB   alt,+32769
         4 000103   401400 401760                    pmme    nvectors=4
         4 000104   000574 702000 4                  TSX2    DEACTIVATE_ERR

      137     4088    2               RETURN;

   4088  4 000105   000000 702200 xent               TSX2  ! X66_ARET

      138     4089    2             END;
      139     4090    1           DATA_VECTRS(1) = VECTOR(TP$STATION.FP);

   4090  4 000106   000001 235000 5                  LDA     1
         4 000107   200004 236100                    LDQ     S$,,AUTO
         4 000110   000002 036003                    ADLQ    2,DU
         4 000111   200040 757100                    STAQ    DATA_VECTRS+2,,AUTO

      140     4091
      141     4092    1           IF TP$STATION.FPLDTRC$ ~= ADDR(NIL)

   4092  4 000112   200004 470500                    LDP0    S$,,AUTO
         4 000113   000017 236100                    LDQ     15,,PR0
         4 000114   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000115   000146 600000 4                  TZE     s:4105

      142     4093    1           THEN
      143     4094    2             DO;

      144     4095    2               P$ = TP$STATION.FPLDTRC$;   /* pointer to context read on LDTRC   */

   4095  4 000116   200034 756100                    STQ     P$,,AUTO

      145     4096    2               VLP_NAME.L# = VLP$FPRG.NAME.L#;
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:29   

   4096  4 000117   200034 471500                    LDP1    P$,,AUTO
         4 000120   000000 100500                    MLR     fill='000'O
         4 000121   100002 000001                    ADSC9   2,,PR1                   cn=0,n=1
         4 000122   000226 000001 3                  ADSC9   VLP_NAME                 cn=0,n=1

      146     4097    2               VLP_NAME.NAME# = VLP$FPRG.NAME.C#;

   4097  4 000123   040000 100500                    MLR     fill='040'O
         4 000124   100002 200037                    ADSC9   2,,PR1                   cn=1,n=31
         4 000125   000226 200037 3                  ADSC9   VLP_NAME                 cn=1,n=31

      147     4098    2               VLP_ACCT.ACCT# = VLP$FPRG.ACCT#;

   4098  4 000126   040000 100500                    MLR     fill='040'O
         4 000127   100012 000010                    ADSC9   10,,PR1                  cn=0,n=8
         4 000130   000236 000010 3                  ADSC9   VLP_ACCT                 cn=0,n=8

      148     4099    2               VLP_SN.SN#(0) = VLP$FPRG.PSN#;

   4099  4 000131   040000 100500                    MLR     fill='040'O
         4 000132   100000 400006                    ADSC9   0,,PR1                   cn=2,n=6
         4 000133   000243 000006 3                  ADSC9   VLP_SN+1                 cn=0,n=6

      149     4100    2               VLP_PASS.PASS# = ' ';

   4100  4 000134   000035 235000 xsym               LDA     B_VECTNIL+29
         4 000135   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000136   000240 757000 3                  STAQ    VLP_PASS

      150     4101    2               CALL M$UNFID(FPT_UNFID) ALTRET(UNFID_ERR);

   4101  4 000137   000160 630400 3                  EPPR0   FPT_UNFID
         4 000140   420021 713400                    CLIMB   alt,+8209
         4 000141   404400 401760                    pmme    nvectors=10
         4 000142   000171 702000 4                  TSX2    UNFID_ERR

PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:30   
      151     4102    2               CHAR_STRING_SIZE = UNFID_SIZE;

   4102  4 000143   000026 235000 3                  LDA     UNFID_SIZE
         4 000144   200031 755100                    STA     CHAR_STRING_SIZE,,AUTO

      152     4103    2             END;

   4103  4 000145   000174 710000 4                  TRA     s:4118

      153     4104
      154     4105    1           ELSE IF TP$STATION.QT$FORM$ ~= ADDR(NIL) THEN

   4105  4 000146   000015 236100                    LDQ     13,,PR0
         4 000147   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000150   000171 600000 4                  TZE     UNFID_ERR

      155     4106    2               DO;

      156     4107    2                 VLP_NAME.L# = TP$STATION.QT$FORM$->QT$FORM.FP.NAME.COUNT;

   4107  4 000151   000015 471500                    LDP1    13,,PR0
         4 000152   100002 236100                    LDQ     2,,PR1
         4 000153   000226 552040 3                  STBQ    VLP_NAME,'40'O

      157     4108    2                 VLP_NAME.NAME# = TP$STATION.QT$FORM$->QT$FORM.FP.NAME.TEXT;

   4108  4 000154   000015 471500                    LDP1    13,,PR0
         4 000155   040000 100500                    MLR     fill='040'O
         4 000156   100002 200037                    ADSC9   2,,PR1                   cn=1,n=31
         4 000157   000226 200037 3                  ADSC9   VLP_NAME                 cn=1,n=31

      158     4109    2                 VLP_ACCT.ACCT# = TP$STATION.QT$FORM$->QT$FORM.FP.ACCT;

   4109  4 000160   000015 471500                    LDP1    13,,PR0
         4 000161   040000 100500                    MLR     fill='040'O
         4 000162   100012 000010                    ADSC9   10,,PR1                  cn=0,n=8
         4 000163   000236 000010 3                  ADSC9   VLP_ACCT                 cn=0,n=8
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:31   

      159     4110    2                 VLP_SN.SN#(0) = TP$STATION.QT$FORM$->QT$FORM.FP.SN;

   4110  4 000164   000015 471500                    LDP1    13,,PR0
         4 000165   040000 100500                    MLR     fill='040'O
         4 000166   100016 000006                    ADSC9   14,,PR1                  cn=0,n=6
         4 000167   000243 000006 3                  ADSC9   VLP_SN+1                 cn=0,n=6

      160     4111    2               END;

   4111  4 000170   000174 710000 4                  TRA     s:4118

      161     4112
      162     4113    2             ELSE DO;

      163     4114    2   UNFID_ERR:
      164     4115    2                 DATA_VECTRS(2) = VECTOR(NIL);

   4115  4 000171   000006 237000 5     UNFID_ERR    LDAQ    6
         4 000172   200042 757100                    STAQ    DATA_VECTRS+4,,AUTO

      165     4116    2                 GOTO FRMT;

   4116  4 000173   000211 710000 4                  TRA     FRMT

      166     4117    2               END;
      167     4118    1           VLP_PASS.PASS# = ' ';

   4118  4 000174   000035 235000 xsym               LDA     B_VECTNIL+29
         4 000175   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000176   000240 757000 3                  STAQ    VLP_PASS

      168     4119    1           CALL M$UNFID(FPT_UNFID) ALTRET(UNFID_ERR);

   4119  4 000177   000160 630400 3                  EPPR0   FPT_UNFID
         4 000200   420021 713400                    CLIMB   alt,+8209
         4 000201   404400 401760                    pmme    nvectors=10
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:32   
         4 000202   000171 702000 4                  TSX2    UNFID_ERR

      169     4120    1           CHAR_STRING_SIZE = UNFID_SIZE;

   4120  4 000203   000026 235000 3                  LDA     UNFID_SIZE
         4 000204   200031 755100                    STA     CHAR_STRING_SIZE,,AUTO

      170     4121
      171     4122    1           DATA_VECTRS(2) = VECTOR(ADDR(FID) -> CHAR$STRING);

   4122  4 000205   000020 735000                    ALS     16
         4 000206   000140 135007                    SBLA    96,DL
         4 000207   000005 236000 5                  LDQ     5
         4 000210   200042 757100                    STAQ    DATA_VECTRS+4,,AUTO

      172     4123
      173     4124    1   FRMT:
      174     4125    1           CALL X$FORMAT(F_FDS);

   4125  4 000211   000010 630400 5     FRMT         EPPR0   8
         4 000212   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000213   000000 701000 xent               TSX1    X$FORMAT
         4 000214   000000 011000                    NOP     0

      175     4126
      176     4127    1           CALL QQC$BLDMSG_ERRBLK(MSGBLK);

   4127  4 000215   200111 630500                    EPPR0   MSGBLK,,AUTO
         4 000216   200136 450500                    STP0    MSGBLK+21,,AUTO
         4 000217   200136 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000220   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000221   000000 701000 xent               TSX1    QQC$BLDMSG_ERRBLK
         4 000222   000000 011000                    NOP     0

      177     4128    1           CALL XUG$ERRCNVRT(Q$FPABT.MSGS.ERR(0),MSGBLK.ERRINFO.ERR(0));

   4128  4 000223   200117 630500                    EPPR0   MSGBLK+6,,AUTO
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:33   
         4 000224   200137 450500                    STP0    MSGBLK+22,,AUTO
         4 000225   000052 236000 xsym               LDQ     QQ_GLOBAL+42
         4 000226   000002 036003                    ADLQ    2,DU
         4 000227   200136 756100                    STQ     MSGBLK+21,,AUTO
         4 000230   200136 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000231   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000232   000000 701000 xent               TSX1    XUG$ERRCNVRT
         4 000233   000000 011000                    NOP     0

      178     4129    1           IF Q$FPABT.MSGS.U1.LEN#(0) ~= 0

   4129  4 000234   000052 470400 xsym               LDP0    QQ_GLOBAL+42
         4 000235   000100 101500                    MRL     fill='000'O
         4 000236   000003 000001                    ADSC9   3,,PR0                   cn=0,n=1
         4 000237   200136 000004                    ADSC9   MSGBLK+21,,AUTO          cn=0,n=4
         4 000240   200136 236100                    LDQ     MSGBLK+21,,AUTO
         4 000241   000000 116003                    CMPQ    0,DU
         4 000242   000252 600000 4                  TZE     s:4134

      179     4130    1           THEN
      180     4131    2             DO;

      181     4132    2               MSGBLK.ERRINFO.FIELD1(0) = VECTOR( Q$FPABT.MSGS.U1(0));

   4132  4 000243   000011 235000 5                  LDA     9
         4 000244   000052 236000 xsym               LDQ     QQ_GLOBAL+42
         4 000245   000003 036003                    ADLQ    3,DU
         4 000246   200136 757100                    STAQ    MSGBLK+21,,AUTO
         4 000247   000100 100500                    MLR     fill='000'O
         4 000250   200136 000010                    ADSC9   MSGBLK+21,,AUTO          cn=0,n=8
         4 000251   200120 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8

      182     4133    2             END;

      183     4134    1           IF Q$FPABT.MSGS.U2.LEN#(0) ~= 0

   4134  4 000252   000100 101500                    MRL     fill='000'O
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:34   
         4 000253   000013 000001                    ADSC9   11,,PR0                  cn=0,n=1
         4 000254   200136 000004                    ADSC9   MSGBLK+21,,AUTO          cn=0,n=4
         4 000255   200136 236100                    LDQ     MSGBLK+21,,AUTO
         4 000256   000000 116003                    CMPQ    0,DU
         4 000257   000267 600000 4                  TZE     s:4139

      184     4135    1           THEN
      185     4136    2             DO;

      186     4137    2               MSGBLK.ERRINFO.FIELD2(0) = VECTOR(Q$FPABT.MSGS.U2(0));

   4137  4 000260   000011 235000 5                  LDA     9
         4 000261   000052 236000 xsym               LDQ     QQ_GLOBAL+42
         4 000262   000013 036003                    ADLQ    11,DU
         4 000263   200136 757100                    STAQ    MSGBLK+21,,AUTO
         4 000264   000100 100500                    MLR     fill='000'O
         4 000265   200136 000010                    ADSC9   MSGBLK+21,,AUTO          cn=0,n=8
         4 000266   200122 200010                    ADSC9   MSGBLK+9,,AUTO           cn=1,n=8

      187     4138    2             END;

      188     4139    1           IF Q$FPABT.MSGS.U3.LEN#(0) ~= 0

   4139  4 000267   000100 101500                    MRL     fill='000'O
         4 000270   000023 000001                    ADSC9   19,,PR0                  cn=0,n=1
         4 000271   200136 000004                    ADSC9   MSGBLK+21,,AUTO          cn=0,n=4
         4 000272   200136 236100                    LDQ     MSGBLK+21,,AUTO
         4 000273   000000 116003                    CMPQ    0,DU
         4 000274   000304 600000 4                  TZE     s:4144

      189     4140    1           THEN
      190     4141    2             DO;

      191     4142    2               MSGBLK.ERRINFO.FIELD3(0) = VECTOR(Q$FPABT.MSGS.U3(0));

   4142  4 000275   000011 235000 5                  LDA     9
         4 000276   000052 236000 xsym               LDQ     QQ_GLOBAL+42
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:35   
         4 000277   000023 036003                    ADLQ    19,DU
         4 000300   200136 757100                    STAQ    MSGBLK+21,,AUTO
         4 000301   000100 100500                    MLR     fill='000'O
         4 000302   200136 000010                    ADSC9   MSGBLK+21,,AUTO          cn=0,n=8
         4 000303   200124 200010                    ADSC9   MSGBLK+11,,AUTO          cn=1,n=8

      192     4143    2             END;

      193     4144    1           CALL QQC$BLDMSG(MSGBLK);

   4144  4 000304   200111 631500                    EPPR1   MSGBLK,,AUTO
         4 000305   200136 451500                    STP1    MSGBLK+21,,AUTO
         4 000306   200136 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000307   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000310   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000311   000000 011000                    NOP     0

      194     4145
      195     4146    1           CALL QQC$BLDMSG_ERRBLK(MSGBLK);

   4146  4 000312   200111 630500                    EPPR0   MSGBLK,,AUTO
         4 000313   200136 450500                    STP0    MSGBLK+21,,AUTO
         4 000314   200136 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000315   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000316   000000 701000 xent               TSX1    QQC$BLDMSG_ERRBLK
         4 000317   000000 011000                    NOP     0

      196     4147    1           CALL XUG$ERRCNVRT(Q$FPABT.MSGS.ERR(1),MSGBLK.ERRINFO.ERR(0));

   4147  4 000320   200117 630500                    EPPR0   MSGBLK+6,,AUTO
         4 000321   200137 450500                    STP0    MSGBLK+22,,AUTO
         4 000322   000052 236000 xsym               LDQ     QQ_GLOBAL+42
         4 000323   000033 036003                    ADLQ    27,DU
         4 000324   200136 756100                    STQ     MSGBLK+21,,AUTO
         4 000325   200136 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000326   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000327   000000 701000 xent               TSX1    XUG$ERRCNVRT
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:36   
         4 000330   000000 011000                    NOP     0

      197     4148    1           IF Q$FPABT.MSGS.U1.LEN#(1) ~= 0

   4148  4 000331   000052 470400 xsym               LDP0    QQ_GLOBAL+42
         4 000332   000100 101500                    MRL     fill='000'O
         4 000333   000034 000001                    ADSC9   28,,PR0                  cn=0,n=1
         4 000334   200136 000004                    ADSC9   MSGBLK+21,,AUTO          cn=0,n=4
         4 000335   200136 236100                    LDQ     MSGBLK+21,,AUTO
         4 000336   000000 116003                    CMPQ    0,DU
         4 000337   000347 600000 4                  TZE     s:4153

      198     4149    1           THEN
      199     4150    2             DO;

      200     4151    2               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(Q$FPABT.MSGS.U1(1));

   4151  4 000340   000011 235000 5                  LDA     9
         4 000341   000052 236000 xsym               LDQ     QQ_GLOBAL+42
         4 000342   000034 036003                    ADLQ    28,DU
         4 000343   200136 757100                    STAQ    MSGBLK+21,,AUTO
         4 000344   000100 100500                    MLR     fill='000'O
         4 000345   200136 000010                    ADSC9   MSGBLK+21,,AUTO          cn=0,n=8
         4 000346   200120 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8

      201     4152    2             END;

      202     4153    1           IF Q$FPABT.MSGS.U2.LEN#(1) ~= 0

   4153  4 000347   000100 101500                    MRL     fill='000'O
         4 000350   000044 000001                    ADSC9   36,,PR0                  cn=0,n=1
         4 000351   200136 000004                    ADSC9   MSGBLK+21,,AUTO          cn=0,n=4
         4 000352   200136 236100                    LDQ     MSGBLK+21,,AUTO
         4 000353   000000 116003                    CMPQ    0,DU
         4 000354   000364 600000 4                  TZE     s:4158

      203     4154    1           THEN
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:37   
      204     4155    2             DO;

      205     4156    2               MSGBLK.ERRINFO.FIELD2(0) = VECTOR(Q$FPABT.MSGS.U2(1));

   4156  4 000355   000011 235000 5                  LDA     9
         4 000356   000052 236000 xsym               LDQ     QQ_GLOBAL+42
         4 000357   000044 036003                    ADLQ    36,DU
         4 000360   200136 757100                    STAQ    MSGBLK+21,,AUTO
         4 000361   000100 100500                    MLR     fill='000'O
         4 000362   200136 000010                    ADSC9   MSGBLK+21,,AUTO          cn=0,n=8
         4 000363   200122 200010                    ADSC9   MSGBLK+9,,AUTO           cn=1,n=8

      206     4157    2             END;

      207     4158    1           IF Q$FPABT.MSGS.U3.LEN#(1) ~= 0

   4158  4 000364   000100 101500                    MRL     fill='000'O
         4 000365   000054 000001                    ADSC9   44,,PR0                  cn=0,n=1
         4 000366   200136 000004                    ADSC9   MSGBLK+21,,AUTO          cn=0,n=4
         4 000367   200136 236100                    LDQ     MSGBLK+21,,AUTO
         4 000370   000000 116003                    CMPQ    0,DU
         4 000371   000401 600000 4                  TZE     s:4163

      208     4159    1           THEN
      209     4160    2             DO;

      210     4161    2               MSGBLK.ERRINFO.FIELD3(0) = VECTOR(Q$FPABT.MSGS.U3(1));

   4161  4 000372   000011 235000 5                  LDA     9
         4 000373   000052 236000 xsym               LDQ     QQ_GLOBAL+42
         4 000374   000054 036003                    ADLQ    44,DU
         4 000375   200136 757100                    STAQ    MSGBLK+21,,AUTO
         4 000376   000100 100500                    MLR     fill='000'O
         4 000377   200136 000010                    ADSC9   MSGBLK+21,,AUTO          cn=0,n=8
         4 000400   200124 200010                    ADSC9   MSGBLK+11,,AUTO          cn=1,n=8

      211     4162    2             END;
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:38   

      212     4163    1           CALL QQC$BLDMSG(MSGBLK);

   4163  4 000401   200111 631500                    EPPR1   MSGBLK,,AUTO
         4 000402   200136 451500                    STP1    MSGBLK+21,,AUTO
         4 000403   200136 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000404   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000405   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000406   000000 011000                    NOP     0

      213     4164
      214     4165    1           IF Q$FPABT.MSGCNT# > 2

   4165  4 000407   000052 470400 xsym               LDP0    QQ_GLOBAL+42
         4 000410   000100 101500                    MRL     fill='000'O
         4 000411   000001 600001                    ADSC9   1,,PR0                   cn=3,n=1
         4 000412   200136 000004                    ADSC9   MSGBLK+21,,AUTO          cn=0,n=4
         4 000413   200136 236100                    LDQ     MSGBLK+21,,AUTO
         4 000414   000003 116007                    CMPQ    3,DL
         4 000415   000513 604000 4                  TMI     s:4188

      215     4166    1           THEN
      216     4167    2             DO;

      217     4168    2               CALL QQC$BLDMSG_ERRBLK(MSGBLK);

   4168  4 000416   200111 631500                    EPPR1   MSGBLK,,AUTO
         4 000417   200136 451500                    STP1    MSGBLK+21,,AUTO
         4 000420   200136 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000421   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000422   000000 701000 xent               TSX1    QQC$BLDMSG_ERRBLK
         4 000423   000000 011000                    NOP     0

      218     4169    2               CALL XUG$ERRCNVRT(Q$FPABT.MSGS.ERR(2),MSGBLK.ERRINFO.ERR(0));

   4169  4 000424   200117 630500                    EPPR0   MSGBLK+6,,AUTO
         4 000425   200137 450500                    STP0    MSGBLK+22,,AUTO
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:39   
         4 000426   000052 236000 xsym               LDQ     QQ_GLOBAL+42
         4 000427   000064 036003                    ADLQ    52,DU
         4 000430   200136 756100                    STQ     MSGBLK+21,,AUTO
         4 000431   200136 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000432   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000433   000000 701000 xent               TSX1    XUG$ERRCNVRT
         4 000434   000000 011000                    NOP     0

      219     4170    2               IF Q$FPABT.MSGS.U1.LEN#(2) ~= 0

   4170  4 000435   000052 470400 xsym               LDP0    QQ_GLOBAL+42
         4 000436   000100 101500                    MRL     fill='000'O
         4 000437   000065 000001                    ADSC9   53,,PR0                  cn=0,n=1
         4 000440   200136 000004                    ADSC9   MSGBLK+21,,AUTO          cn=0,n=4
         4 000441   200136 236100                    LDQ     MSGBLK+21,,AUTO
         4 000442   000000 116003                    CMPQ    0,DU
         4 000443   000453 600000 4                  TZE     s:4175

      220     4171    2               THEN
      221     4172    3                 DO;

      222     4173    3                   MSGBLK.ERRINFO.FIELD1(0) = VECTOR(Q$FPABT.MSGS.U1(2));

   4173  4 000444   000011 235000 5                  LDA     9
         4 000445   000052 236000 xsym               LDQ     QQ_GLOBAL+42
         4 000446   000065 036003                    ADLQ    53,DU
         4 000447   200136 757100                    STAQ    MSGBLK+21,,AUTO
         4 000450   000100 100500                    MLR     fill='000'O
         4 000451   200136 000010                    ADSC9   MSGBLK+21,,AUTO          cn=0,n=8
         4 000452   200120 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8

      223     4174    3                 END;

      224     4175    2               IF Q$FPABT.MSGS.U2.LEN#(2) ~= 0

   4175  4 000453   000100 101500                    MRL     fill='000'O
         4 000454   000075 000001                    ADSC9   61,,PR0                  cn=0,n=1
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:40   
         4 000455   200136 000004                    ADSC9   MSGBLK+21,,AUTO          cn=0,n=4
         4 000456   200136 236100                    LDQ     MSGBLK+21,,AUTO
         4 000457   000000 116003                    CMPQ    0,DU
         4 000460   000470 600000 4                  TZE     s:4180

      225     4176    2               THEN
      226     4177    3                 DO;

      227     4178    3                   MSGBLK.ERRINFO.FIELD2(0) = VECTOR(Q$FPABT.MSGS.U2(2));

   4178  4 000461   000011 235000 5                  LDA     9
         4 000462   000052 236000 xsym               LDQ     QQ_GLOBAL+42
         4 000463   000075 036003                    ADLQ    61,DU
         4 000464   200136 757100                    STAQ    MSGBLK+21,,AUTO
         4 000465   000100 100500                    MLR     fill='000'O
         4 000466   200136 000010                    ADSC9   MSGBLK+21,,AUTO          cn=0,n=8
         4 000467   200122 200010                    ADSC9   MSGBLK+9,,AUTO           cn=1,n=8

      228     4179    3                 END;

      229     4180    2               IF Q$FPABT.MSGS.U3.LEN#(2) ~= 0

   4180  4 000470   000100 101500                    MRL     fill='000'O
         4 000471   000105 000001                    ADSC9   69,,PR0                  cn=0,n=1
         4 000472   200136 000004                    ADSC9   MSGBLK+21,,AUTO          cn=0,n=4
         4 000473   200136 236100                    LDQ     MSGBLK+21,,AUTO
         4 000474   000000 116003                    CMPQ    0,DU
         4 000475   000505 600000 4                  TZE     s:4185

      230     4181    2               THEN
      231     4182    3                 DO;

      232     4183    3                   MSGBLK.ERRINFO.FIELD3(0) = VECTOR(Q$FPABT.MSGS.U3(2));

   4183  4 000476   000011 235000 5                  LDA     9
         4 000477   000052 236000 xsym               LDQ     QQ_GLOBAL+42
         4 000500   000105 036003                    ADLQ    69,DU
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:41   
         4 000501   200136 757100                    STAQ    MSGBLK+21,,AUTO
         4 000502   000100 100500                    MLR     fill='000'O
         4 000503   200136 000010                    ADSC9   MSGBLK+21,,AUTO          cn=0,n=8
         4 000504   200124 200010                    ADSC9   MSGBLK+11,,AUTO          cn=1,n=8

      233     4184    3                 END;

      234     4185    2               CALL QQC$BLDMSG(MSGBLK);

   4185  4 000505   200111 631500                    EPPR1   MSGBLK,,AUTO
         4 000506   200136 451500                    STP1    MSGBLK+21,,AUTO
         4 000507   200136 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000510   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000511   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000512   000000 011000                    NOP     0

      235     4186    2             END;

      236     4187
      237     4188    1           IF TP$STATION.FP ~= '*DFLT' THEN

   4188  4 000513   200004 470500                    LDP0    S$,,AUTO
         4 000514   040000 106500                    CMPC    fill='040'O
         4 000515   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
         4 000516   000027 000005 2                  ADSC9   CODE_FPABT_NOSTA+1       cn=0,n=5
         4 000517   000521 600000 4                  TZE     s:4193

      238     4189    2             DO;

      239     4190    2               GOTO RET;

   4190  4 000520   000603 710000 4                  TRA     RET

      240     4191    2             END;
      241     4192
      242     4193    1           IF TP$STATION.QT$FORM$ = ADDR(NIL) OR

PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:42   
   4193  4 000521   000015 236100                    LDQ     13,,PR0
         4 000522   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000523   000527 600000 4                  TZE     s:4197
         4 000524   000017 236100                    LDQ     15,,PR0
         4 000525   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000526   000573 601000 4                  TNZ     s:4209

      243     4194    1               TP$STATION.FPLDTRC$ = ADDR(NIL) THEN
      244     4195    2             DO;

      245     4196
      246     4197    2               CALL QQC$BLDMSG_ERRBLK(MSGBLK);

   4197  4 000527   200111 631500                    EPPR1   MSGBLK,,AUTO
         4 000530   200136 451500                    STP1    MSGBLK+21,,AUTO
         4 000531   200136 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000532   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000533   000000 701000 xent               TSX1    QQC$BLDMSG_ERRBLK
         4 000534   000000 011000                    NOP     0

      247     4198    2               MSGBLK.ERRINFO.ERR(0) = CODE_CFPABT;

   4198  4 000535   000024 236000 2                  LDQ     CODE_CFPABT
         4 000536   200117 756100                    STQ     MSGBLK+6,,AUTO

      248     4199    2               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_STATION);

   4199  4 000537   000004 235000 5                  LDA     4
         4 000540   200136 452500                    STP2    MSGBLK+21,,AUTO
         4 000541   200136 236100                    LDQ     MSGBLK+21,,AUTO
         4 000542   000106 036003                    ADLQ    70,DU
         4 000543   200140 757100                    STAQ    MSGBLK+23,,AUTO
         4 000544   000100 100500                    MLR     fill='000'O
         4 000545   200140 000010                    ADSC9   MSGBLK+23,,AUTO          cn=0,n=8
         4 000546   200120 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8

      249     4200    2               TEXTC_STATION.L# = 8;
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:43   

   4200  4 000547   010000 236003                    LDQ     4096,DU
         4 000550   200106 552140                    STBQ    TEXTC_STATION,'40'O,AUTO

      250     4201    2               TEXTC_STATION.NAME# = TP$STATION.ID;

   4201  4 000551   200004 470500                    LDP0    S$,,AUTO
         4 000552   040100 100500                    MLR     fill='040'O
         4 000553   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         4 000554   200106 200010                    ADSC9   TEXTC_STATION,,AUTO      cn=1,n=8

      251     4202    2               CALL QQC$BLDMSG(MSGBLK);

   4202  4 000555   200111 631500                    EPPR1   MSGBLK,,AUTO
         4 000556   200136 451500                    STP1    MSGBLK+21,,AUTO
         4 000557   200136 630500                    EPPR0   MSGBLK+21,,AUTO
         4 000560   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000561   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000562   000000 011000                    NOP     0

      252     4203
      253     4204    2               STATION = TP$STATION.ID;

   4204  4 000563   200004 470500                    LDP0    S$,,AUTO
         4 000564   040000 100500                    MLR     fill='040'O
         4 000565   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         4 000566   000000 000010 3                  ADSC9   STATION                  cn=0,n=8

      254     4205    2               CALL M$DEACTIVATE(FPT_DEACTIVATE) ALTRET(DEACTIVATE_ERR);

   4205  4 000567   000206 630400 3                  EPPR0   FPT_DEACTIVATE
         4 000570   500001 713400                    CLIMB   alt,+32769
         4 000571   401400 401760                    pmme    nvectors=4
         4 000572   000574 702000 4                  TSX2    DEACTIVATE_ERR

      255     4206
      256     4207    2             END;
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:44   

      257     4208
      258     4209    2           DO WHILE('0'B);

   4209  4 000573   000603 710000 4                  TRA     RET

      259     4210
      260     4211    2   DEACTIVATE_ERR:
      261     4212    2             IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 1154 /* E$CGAFNS */ THEN

   4212  4 000574   000000 470400 xsym  DEACTIVATE_* LDP0    B$TCB$
         4 000575   000000 471500                    LDP1    0,,PR0
         4 000576   100102 236100                    LDQ     66,,PR1
         4 000577   377770 376007                    ANQ     131064,DL
         4 000600   022020 116007                    CMPQ    9232,DL
         4 000601   000603 600000 4                  TZE     RET

      262     4213    3               DO;

      263     4214    3                 GOTO MON_ERR;

   4214  4 000602   000604 710000 4                  TRA     MON_ERR

      264     4215    3               END;
      265     4216    2           END /* NEVER */;

      266     4217
      267     4218    1   RET:
      268     4219    1           RETURN;

   4219  4 000603   000000 702200 xent  RET          TSX2  ! X66_ARET

      269     4220
      270     4221    1   MON_ERR:
      271     4222    1           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   4222  4 000604   100102 236100       MON_ERR      LDQ     66,,PR1
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:45   
         4 000605   000000 756000 xsym               STQ     QQ_GLOBAL

      272     4223    1           CALL QQC$SCREECH;

   4223  4 000606   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000607   000000 701000 xent               TSX1    QQC$SCREECH
         4 000610   000000 011000                    NOP     0

      273     4224
      274     4225    1   END QQA$FPABT;

   4225  4 000611   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:46   
--  Include file information  --

   QT_MACROS_C.:E05TOU  is referenced.
   XUG_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   Q_MACRO_C.:E05TOU  is referenced.
   QQ_FPABT_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQA$FPABT.
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:47   

 **** Variables and constants ****

  ****  Section 002 RoData QQA$FPABT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    24-0-0/b STRC        r     1 CODE_CFPABT               26-0-0/b STRC        r     1 CODE_FPABT_NOSTA
     0-0-0/c STRC(711)   r     1 FORMAT1

  ****  Section 003  Data  QQA$FPABT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/c CHAR(80)    r     1 FID                      206-0-0/d STRC(576)   r     1 FPT_DEACTIVATE
    66-0-0/d STRC(2088)  r     1 FPT_OPEN                 160-0-0/d STRC(792)   r     1 FPT_UNFID
    27-0-0/w STRC(1080)  r     1 F_FDS                      0-0-0/c CHAR(8)     r     1 STATION
    26-0-0/w UBIN        r     1 UNFID_SIZE               236-0-0/c STRC(72)    r     1 VLP_ACCT
   226-0-0/c STRC(288)   r     1 VLP_NAME                 240-0-0/c STRC(72)    r     1 VLP_PASS
   242-0-0/d STRC(90)    r     1 VLP_SN                   246-0-0/c STRC(72)    r     1 VLP_WSN

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @P_TP$EVENT                5-0-0/c CHAR(80)    r     1 BUF
    31-0-0/w UBIN        r     1 CHAR_STRING_SIZE
    36-0-0/b BIT (72)    r     1 DATA_VECTRS(0:19)
    35-0-0/w BIT         r     1 FOUND_FLAG               111-0-0/w STRC(738)   r     1 MSGBLK
    34-0-0/w PTR         r     1 P$                        *0-0-0/w STRC(612)   r     1 P_TP$EVENT
     4-0-0/w PTR         r     1 S$                       106-0-0/c STRC(81)    r     1 TEXTC_STATION

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:48   
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/d STRC(9090)  r     1 QQ_GLOBAL

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/c ACHR        r     1 CHAR$STRING                0-0-0N  NULL        r     1 M$CG
     0-0-0/c STRC(2772)  r     1 Q$FPABT                    0-0-0/w STRC(828)   r     1 QT$FORM
     0-0-0/w STRC(909)   r     1 TP$STATION                 0-0-0/c STRC(504)   r     1 VLP$FPRG


   Procedure QQA$FPABT requires 394 words for executable code.
   Procedure QQA$FPABT requires 98 words of local(AUTO) storage.

    No errors detected in file QQA$FPABT.:E05TSI    .
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:49   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:50   
          MINI XREF LISTING

B$ALT.CODE
      3350**DCL      3350--REDEF    3351--REDEF    3351--REDEF
B$ALT.ERR
      3351**DCL      4222>>ASSIGN
B$ALT.ERR.CODE
      3352**DCL      4212>>IF
B$ALT.ERR.ERR#
      3352**DCL      3352--REDEF
B$ALT.EVID
      3351**DCL      3351--REDEF    3351--REDEF
B$CGAURD.STATION
      3698**DCL      3698--REDEF
B$TCB.ALT$
      3346**DCL      4212>>IF       4222>>ASSIGN
B$TCB$
      3034**DCL      4212>>IF       4222>>ASSIGN
BUF
      3553**DCL      4071--ASSIGN
CHAR$STRING
      3125**DCL      4122--ASSIGN
CHAR_STRING_SIZE
      3555**DCL      3125--IMP-SIZ  4102<<ASSIGN   4120<<ASSIGN   4122>>ASSIGN
CODE_CFPABT
      3727**DCL      4198>>ASSIGN
CODE_FPABT_NOSTA
      3741**DCL      4081>>ASSIGN
DATA_VECTRS
      3562**DCL      4072--ASSIGN   4076<<ASSIGN   4090<<ASSIGN   4115<<ASSIGN   4122<<ASSIGN
DEACTIVATE_ERR
      4212**LABEL    4087--CALLALT  4205--CALLALT
FID
      3411**DCL      3911--DCLINIT  4122--ASSIGN
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:51   
FORMAT1
      3381**DCL      4074--ASSIGN
FOUND_FLAG
      3561**DCL      4078<>CALL     4079>>IF
FPT_DEACTIVATE
      3930**DCL      4087<>CALL     4205<>CALL
FPT_DEACTIVATE.V
      3931**DCL      3930--DCLINIT
FPT_DEACTIVATE.V.DVBYTE.REREAD#
      3933**DCL      3933--REDEF
FPT_OPEN.ACSVEH_
      3855**DCL      3856--REDEF
FPT_OPEN.ALTKEYS_
      3861**DCL      3862--REDEF    3862--REDEF
FPT_OPEN.HDR_
      3860**DCL      3861--REDEF
FPT_OPEN.TAB_
      3859**DCL      3860--REDEF
FPT_OPEN.UHL_
      3853**DCL      3854--REDEF    3854--REDEF
FPT_OPEN.V
      3862**DCL      3853--DCLINIT
FPT_OPEN.V.ASN#
      3872**DCL      3914--DCLINIT
FPT_OPEN.V.FSN#
      3893**DCL      3893--REDEF    3893--REDEF
FPT_OPEN.V.RES#
      3877**DCL      3914--DCLINIT
FPT_OPEN.WSN_
      3859**DCL      3859--REDEF
FPT_UNFID
      3911**DCL      4101<>CALL     4119<>CALL
FPT_UNFID.V
      3915**DCL      3911--DCLINIT
FRMT
      4125**LABEL    4116--GOTO
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:52   
F_FDS
      3429**DCL      4125<>CALL
F_FDS.BUF_
      3446**DCL      4071<<ASSIGN
F_FDS.FMT_
      3433**DCL      4074<<ASSIGN
F_FDS.NVECS#
      3457**DCL      4073<<ASSIGN
F_FDS.VECTR$
      3459**DCL      4072<<ASSIGN
M$DEACTIVATE
        98**DCL-ENT  4087--CALL     4205--CALL
M$UNFID
       141**DCL-ENT  4101--CALL     4119--CALL
MON_ERR
      4222**LABEL    4214--GOTO
MSGBLK
      3593**DCL      4080<>CALL     4085<>CALL     4127<>CALL     4144<>CALL     4146<>CALL     4163<>CALL
      4168<>CALL     4185<>CALL     4197<>CALL     4202<>CALL
MSGBLK.ERRINFO.ERR
      3671**DCL      4081<<ASSIGN   4128<>CALL     4147<>CALL     4169<>CALL     4198<<ASSIGN
MSGBLK.ERRINFO.FIELD1
      3675**DCL      4082<<ASSIGN   4132<<ASSIGN   4151<<ASSIGN   4173<<ASSIGN   4199<<ASSIGN
MSGBLK.ERRINFO.FIELD2
      3677**DCL      4137<<ASSIGN   4156<<ASSIGN   4178<<ASSIGN
MSGBLK.ERRINFO.FIELD3
      3679**DCL      4142<<ASSIGN   4161<<ASSIGN   4183<<ASSIGN
P$
      3559**DCL      3263--IMP-PTR  4095<<ASSIGN   4096>>ASSIGN   4097>>ASSIGN   4098>>ASSIGN   4099>>ASSIGN
P_TP$EVENT
      2910**DCL         8--PROC
P_TP$EVENT.VLP_STATION.MSGIDXT
      2971**DCL      2974--REDEF
P_TP$EVENT.VLP_STATION.STATION#
      2965**DCL      4076--ASSIGN   4078<>CALL     4084>>ASSIGN   4086>>ASSIGN
Q$FPABT.MSGCNT#
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:53   
      3153**DCL      4165>>IF
Q$FPABT.MSGS.ERR
      3175**DCL      4128<>CALL     4147<>CALL     4169<>CALL
Q$FPABT.MSGS.U1
      3206**DCL      4132--ASSIGN   4151--ASSIGN   4173--ASSIGN
Q$FPABT.MSGS.U1.LEN#
      3207**DCL      4129>>IF       4148>>IF       4170>>IF
Q$FPABT.MSGS.U2
      3209**DCL      4137--ASSIGN   4156--ASSIGN   4178--ASSIGN
Q$FPABT.MSGS.U2.LEN#
      3210**DCL      4134>>IF       4153>>IF       4175>>IF
Q$FPABT.MSGS.U3
      3212**DCL      4142--ASSIGN   4161--ASSIGN   4183--ASSIGN
Q$FPABT.MSGS.U3.LEN#
      3213**DCL      4139>>IF       4158>>IF       4180>>IF
QQC$BLDMSG
      3003**DCL-ENT  4085--CALL     4144--CALL     4163--CALL     4185--CALL     4202--CALL
QQC$BLDMSG_ERRBLK
      3004**DCL-ENT  4080--CALL     4127--CALL     4146--CALL     4168--CALL     4197--CALL
QQC$FINDSTA
      3006**DCL-ENT  4078--CALL
QQC$PRINT_FMTMCT
      3005**DCL-ENT  3483--DCLINIT
QQC$SCREECH
      3007**DCL-ENT  4223--CALL
QQ_GLOBAL.CMDBUF$
      1719**DCL      3143--IMP-PTR  4128>>CALL     4129>>IF       4132>>ASSIGN   4134>>IF       4137>>ASSIGN
      4139>>IF       4142>>ASSIGN   4147>>CALL     4148>>IF       4151>>ASSIGN   4153>>IF       4156>>ASSIGN
      4158>>IF       4161>>ASSIGN   4165>>IF       4169>>CALL     4170>>IF       4173>>ASSIGN   4175>>IF
      4178>>ASSIGN   4180>>IF       4183>>ASSIGN
QQ_GLOBAL.DS1$_BITS
      1722**DCL      1722--REDEF
QQ_GLOBAL.DS2$_BITS
      1722**DCL      1723--REDEF
QQ_GLOBAL.DS3$_BITS
      1723**DCL      1723--REDEF
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:54   
QQ_GLOBAL.DS4$_BITS
      1723**DCL      1724--REDEF
QQ_GLOBAL.ERR
      1712**DCL      4222<<ASSIGN
QT$FORM.FP.ACCT
      3114**DCL      4109>>ASSIGN
QT$FORM.FP.NAME.COUNT
      3112**DCL      4107>>ASSIGN
QT$FORM.FP.NAME.TEXT
      3113**DCL      4108>>ASSIGN
QT$FORM.FP.SN
      3118**DCL      4110>>ASSIGN
RET
      4219**LABEL    4190--GOTO
S$
      3284**DCL      3286--IMP-PTR  4078<>CALL     4090>>ASSIGN   4092>>IF       4095>>ASSIGN   4105>>IF
      4107>>ASSIGN   4108>>ASSIGN   4109>>ASSIGN   4110>>ASSIGN   4188>>IF       4193>>IF       4193>>IF
      4201>>ASSIGN   4204>>ASSIGN
STATION
      3410**DCL      3930--DCLINIT  4086<<ASSIGN   4204<<ASSIGN
TEXTC_STATION
      3590**DCL      4082--ASSIGN   4199--ASSIGN
TEXTC_STATION.L#
      3590**DCL      4083<<ASSIGN   4200<<ASSIGN
TEXTC_STATION.NAME#
      3590**DCL      4084<<ASSIGN   4201<<ASSIGN
TP$STATION.FP
      3289**DCL      4090--ASSIGN   4188>>IF
TP$STATION.FPLDTRC$
      3306**DCL      4092>>IF       4095>>ASSIGN   4193>>IF
TP$STATION.ID
      3287**DCL      4201>>ASSIGN   4204>>ASSIGN
TP$STATION.QT$FORM$
      3302**DCL      4105>>IF       4107>>ASSIGN   4108>>ASSIGN   4109>>ASSIGN   4110>>ASSIGN   4193>>IF
UNFID_ERR
      4115**LABEL    4101--CALLALT  4119--CALLALT
PL6.E3A0      #001=QQA$FPABT File=QQA$FPABT.:E05TSI                              WED 07/30/97 05:23 Page:55   
UNFID_SIZE
      3413**DCL      3915--DCLINIT  4102>>ASSIGN   4120>>ASSIGN
VLP$FPRG.ACCT#
      3269**DCL      4098>>ASSIGN
VLP$FPRG.NAME.C#
      3268**DCL      4097>>ASSIGN
VLP$FPRG.NAME.L#
      3267**DCL      4096>>ASSIGN
VLP$FPRG.PSN#
      3265**DCL      4099>>ASSIGN
VLP_ACCT
      4005**DCL      3912--DCLINIT
VLP_ACCT.ACCT#
      4005**DCL      4098<<ASSIGN   4109<<ASSIGN
VLP_NAME
      3992**DCL      3912--DCLINIT
VLP_NAME.L#
      3992**DCL      4096<<ASSIGN   4107<<ASSIGN
VLP_NAME.NAME#
      3992**DCL      4097<<ASSIGN   4108<<ASSIGN
VLP_PASS
      4018**DCL      3913--DCLINIT
VLP_PASS.PASS#
      4018**DCL      4100<<ASSIGN   4118<<ASSIGN
VLP_SN
      4031**DCL      3913--DCLINIT
VLP_SN.SN#
      4031**DCL      4099<<ASSIGN   4110<<ASSIGN
VLP_WSN
      4044**DCL      3913--DCLINIT
X$FORMAT
      3008**DCL-ENT  4125--CALL
XUG$ERRCNVRT
      2724**DCL-ENT  4128--CALL     4147--CALL     4169--CALL
