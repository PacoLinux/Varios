VERSION E05

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:1    
        1        1        /*M* ORR$REPLAY USER REPLAY TOOL MAIN PROCEDURE */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*     PLM=3,SQB=Y,AND=Y,ENI=0,SDI=3,MCL=10,CSI=0,ECI=0,IND=0,IAD=3,MOC=Y   */
        8        8        %SET LISTSUB = '1'B;
        9        9
       10       10        /*
       11       11          ###  ####  ####    #   ####  ##### ####  #      ###  #   #
       12       12         # # # #   # #   #  ###  #   # #     #   # #     #   # #   #
       13       13         # # # #   # #   # # #   #   # #     #   # #     #   #  # #
       14       14         #  ## ####  ####   ###  ####  ####  ####  #     #####   #
       15       15         #   # # #   # #     # # # #   #     #     #     #   #   #
       16       16         #   # #  #  #  #   ###  #  #  #     #     #     #   #   #
       17       17          ###  #   # #   #   #   #   # ##### #     ##### #   #   #
       18       18                                                                       */
       19       19
       20       20        ORR$REPLAY: PROC MAIN;
       21       21
       22       22        /*P*      NAME: REPLAY TOOL
       23       23                  PURPOSE: Replay entries from operators console
       24       24                  DESCRIPTION: Operator can keyin requests to the
       25       25                                 replay tool, which supplies the
       26       26                                 operator with previously logged
       27       27                                 operator entries.
       28       28        */
       29       29        /*D*      NAME: ORR$REPLAY
       30       30                  CALL: None - main procedure
       31       31                  INTERFACE: ORR$
       32       32                  DESCRIPTION: This is the main program for the user
       33       33                                 REPLAY TOOL.  It can supply the operator
       34       34                                 with previously logged entries to the
       35       35                                 :OCHIST file.
       36       36        */
       37       37        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:2    
       38       38        /*  CP-6 system include files                                                 */
       39       39
       40       40        %INCLUDE CP_6;
       41      121        %INCLUDE CP_6_SUBS;
       42      661
       43      662 S      %INCLUDE B$JIT_C;
       44      663        %INCLUDE B_ERRORS_C;
       45     1790        %INCLUDE B_SEGIDS_C;
       46     2329        %INCLUDE B_MICROPS_C;
       47     2501
       48     2502        /*  Include files belonging to Keyin and Replay... FCG="O?"                   */
       49     2503
       50     2504        %INCLUDE ORR_SUBS_C;
       51     2556        %INCLUDE OCI_SUBS_C;
       52     2654        %INCLUDE OUT_SUBS_C;
       53     2777        %INCLUDE OC_DAT_R;
       54     2938        %INCLUDE OC_SUBS_C;
       55     3669        %INCLUDE OCL_DATA_R;
       56     3694
       57     3695        %INCLUDE OCM_DATA_R;
       58     3708
       59     3709        %INCLUDE OCP_DATA_R;
       60     3726        %INCLUDE OR_PERR_C;
       61     3775        %INCLUDE OR_DAT_R;
       62     3785        %INCLUDE OC_MESSHD_C;
       63     3838
       64     3839        /* Library include files                                                      */
       65     3840
       66     3841        %INCLUDE XUR_ENTRY;
       67     3873        %INCLUDE XU_MACRO_C;
       68     6979        %INCLUDE XUH_MACRO_C;
       69     7063        %INCLUDE XUW_MACRO_C;
       70     7198        %INCLUDE XU_PERR_C;
       71     7389        %INCLUDE XUD_UTS_M;
       72     7471        %XUD$UTS_ENTRIES;
       73     7503        %XUD_UTS_EQU;
       74     7514
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:3    
       75     7515        %XUH_PARAM (STCLASS=STATIC,
       76     7516         PROCNAME=HELP_NAME,
       77     7517         PROCACCT=HELP_ACCT,
       78     7518         OUTDCB1=M$LO,
       79     7519         OUTDCB2=M$LO);
       80     7580
       81     7581        %B$JIT0;                                /* First section of JIT.              */
       82     7670        %U$JIT1;                                /* User area of JIT. Must
       83     7671                                                      be entered in ascending
       84     7672                                                      order until desired area
       85     7673                                                      of JIT is found. This
       86     7674                                                      area of JIT is where the
       87     7675                                                      default for language is
       88     7676                                                      placed.                         */
       89     7750        %A$JIT6X;                               /* Dummy accounting area
       90     7751                                                      (i.e. end of JIT).              */
       91     7754
       92     7755        %B$TCB;                                 /* Generates based structure
       93     7756                                                      for TCB.                        */
       94     7759        %B$ALT;                                 /* Generates based structure
       95     7760                                                      of the altret frame of
       96     7761                                                      the TCB.                        */
       97     7769
       98     7770        %F$DCB;
       99     7827
      100     7828
      101     7829        %XUR_INIT (PCB=P_PCB,
      102     7830         BRKMSG=ORR$BRKMSG,
      103     7831         ABORT=ORR$ABRKRTN);                    /* Macro invocation. Used to
      104     7832                                                initialize things (e.g.
      105     7833                                                an EPTR if XUR$BREAK is
      106     7834                                                going to handle breaks)
      107     7835                                                for the XUR$GETCMD rtns. It
      108     7836                                                is called by XUR$INIT.                */
      109     7935
      110     7936                                                /* If the PCB is to be assigned on
      111     7937                                                   the fly, assign it in the follow-
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:4    
      112     7938                                                   ing manner:
      113     7939                                                      XUR_INIT.PCB$ = ADDR (P_PCB)    */
      114     7940
      115     7941
      116     7942        %PARSE$OUT (NAME=OUT$BLK,STCLASS=BASED);
      117     7987        %PARSE$SYM (NAME=OUT$SYM,STCLASS=BASED);
      118     8025
      119     8026        %OC_MESSHD_W (NAME=OR_MESSBUF,
      120     8027         DELIM=";");
      121     8040
      122     8041        %XUW_WILDCARD (FPTN=XUW_WILDCARD,STCLASS=STATIC);
      123     8137        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:5    
      124     8138
      125     8139                                                /*
      126     8140                                                     %DCBS
      127     8141                                                                                        */
      128     8142    1   DCL M$IN DCB;
      129     8143    1   DCL M$CSCG DCB;
      130     8144    1   DCL M$LO DCB;
      131     8145    1   DCL M$SI DCB;
      132     8146    1   DCL F$HISTFILE DCB;                     /* DCB for :ochist.                   */
      133     8147    1   DCL F$TEMPLATE DCB;                     /* DCB for :ocmsg.                    */
      134     8148
      135     8149    1   DCL OCM$TPSET ENTRY(2) ALTRET;          /* Format routine.                    */
      136     8150    1   DCL ORR$BRKMSG ENTRY;                   /* Print "Break at... C to continue:" */
      137     8151    1   DCL ORR$BRKRTN ENTRY;                   /* Handle (possibly defered) break.   */
      138     8152    1   DCL ORR$XCONRTN ENTRY;                  /* Clean up on exit                   */
      139     8153    1   DCL ORR$ABRKRTN ENTRY ASYNC;            /* Async entry to break routine       */
      140     8154    1   DCL ORR$AXCONRTN ENTRY ASYNC;           /* Async entry to XCON routine        */
      141     8155
      142     8156    1   DCL X$HELP ENTRY(1) ALTRET;
      143     8157    1   DCL X$WILDCMP ENTRY(1) ALTRET;
      144     8158
      145     8159    1   DCL CMD_INSTR CHAR(0) STATIC INIT (':');
      146     8160
      147     8161    1   DCL OUT$ PTR STATIC;                    /* Entry of parse tree.               */
      148     8162        %VLP_ERRCODE (FPTN=OUT_ERROR,STCLASS="REDEF OUT$");
      149     8207    1   DCL PTR$ PTR STATIC;                    /* 2 levels below out$.               */
      150     8208    1   DCL LISTPTR$ PTR STATIC;                /* 1 level below out$                 */
      151     8209    1   DCL LSTACK_PTR$ PTR STATIC;
      152     8210    1   DCL ASTACK_PTR$ PTR STATIC;
      153     8211    1   DCL TPTR$ PTR STATIC;
      154     8212    1   DCL SR_PTR$ PTR STATIC;
      155     8213
      156     8214    1   DCL TEMP_UTS UBIN AUTO;
      157     8215        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:6    
      158     8216
      159     8217         /*
      160     8218                  A R G U M E N T S
      161     8219                                                */
      162     8220
      163     8221    1   DCL HOUR1 CHAR(2) STATIC INIT ('00');
      164     8222    1   DCL MIN1 CHAR(2) STATIC INIT ('00');
      165     8223    1   DCL SEC1 CHAR(2) STATIC INIT ('00');
      166     8224    1   DCL CENTISEC1 CHAR(2) STATIC INIT ('00');
      167     8225
      168     8226    1   DCL MONTH1 CHAR(2) STATIC INIT ('00');
      169     8227    1   DCL DAY1 CHAR(2) STATIC INIT ('00');
      170     8228    1   DCL YEAR1 CHAR(2) STATIC INIT ('78');
      171     8229
      172     8230    1   DCL HOUR2 CHAR(2) STATIC INIT ('00');
      173     8231    1   DCL MIN2 CHAR(2) STATIC INIT ('00');
      174     8232    1   DCL SEC2 CHAR(2) STATIC INIT ('00');
      175     8233    1   DCL CENTISEC2 CHAR(2) STATIC INIT ('00');
      176     8234
      177     8235    1   DCL MONTH2 CHAR(2) STATIC INIT ('00');
      178     8236    1   DCL DAY2 CHAR(2) STATIC INIT ('00');
      179     8237    1   DCL YEAR2 CHAR(2) STATIC INIT ('00');
      180     8238
      181     8239
      182     8240    1   DCL IND SBIN WORD STATIC;
      183     8241    1   DCL HERE SBIN WORD STATIC;
      184     8242
      185     8243    1   DCL THOLD UBIN WORD STATIC;
      186     8244    1   DCL VALID_CHECK (0:1) REDEF THOLD CHAR(2);
      187     8245
      188     8246    1   DCL DCB# UBIN WORD STATIC;
      189     8247    1   DCL I SBIN WORD STATIC;
      190     8248    1   DCL X SBIN WORD STATIC;
      191     8249
      192     8250    1   DCL SUBS2 SBIN WORD STATIC;
      193     8251    1   DCL SUBS1 SBIN WORD STATIC;
      194     8252
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:7    
      195     8253    1   DCL DESTINATION CHAR(31) STATIC INIT (' ');
      196     8254    1   DCL ASNFID CHAR (20) STATIC;
      197     8255    1   DCL TXTFD CHAR (100) STATIC;
      198     8256    1   DCL CONSOLE CHAR(4) STATIC INIT ('?   ');
      199     8257    1   DCL LOCATION CHAR(8) STATIC INIT ('?       ');
      200     8258    1   DCL LANGUAGE CHAR(1) STATIC INIT (' ');
      201     8259    1   DCL WSTATION CHAR(8) STATIC INIT ('?       ');
      202     8260    1   DCL LOGON CHAR(8) STATIC INIT ('?       ');
      203     8261    1   DCL BEGINNING_TIME UBIN WORD STATIC;
      204     8262    1   DCL ENDING_TIME UBIN WORD STATIC;
      205     8263    1   DCL ENDING_TIME_REDEF REDEF ENDING_TIME BIT(36);
      206     8264    1   DCL DATE_BUF (0:2) CHAR (2) STATIC;
      207     8265    1   DCL TIME_BUF (0:3) CHAR (2) STATIC;
      208     8266
      209     8267    1   DCL PRINT_FLAG BIT(1) STATIC;
      210     8268    1   DCL PRINTED_TIME UBIN WORD STATIC;
      211     8269
      212     8270    1   DCL UTSTAMP UBIN WORD STATIC;
      213     8271    1   DCL FPT_DATE CHAR(6) STATIC;
      214     8272    1   DCL FPT_TIME CHAR(8) STATIC INIT('00000000');
      215     8273    1   DCL INBUF CHAR(256) STATIC;
      216     8274
      217     8275    1   DCL SIM_DATE CHAR(8) STATIC;
      218     8276    1   DCL SIM_TIME CHAR(11) STATIC;
      219     8277
      220     8278    1   DCL TO_UTS_DATE CHAR(8) STATIC;
      221     8279    1   DCL TO_UTS_TIME CHAR(11) STATIC;
      222     8280
      223     8281    1   DCL MSG CHAR(256) STATIC;
      224     8282    1   DCL 1 B_VERSION CALIGNED SYMREF,
      225     8283    1          2 L UBIN BYTE UNAL,
      226     8284    1          2 C CHAR(6);
      227     8285    1   DCL 1 B_VERSION_ CALIGNED BASED,
      228     8286    1          2 L UBIN BYTE UNAL,
      229     8287    1          2 C CHAR(B_VERSION.L);
      230     8288
      231     8289    1   DCL 1 TEXTC BASED,
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:8    
      232     8290    1          2 C UBIN BYTE UNAL,
      233     8291    1          2 TEXT CHAR(TEXTC.C);
      234     8292
      235     8293    1   DCL OUT_BUFFER CHAR(256) STATIC;
      236     8294    1   DCL TIME_BUFFER CHAR(72) STATIC;
      237     8295
      238     8296    1   DCL OPERATOR_ENTERED_TIME1 BIT (1) STATIC INIT ('0'B);
      239     8297    1   DCL OPERATOR_ENTERED_DATE1 BIT (1) STATIC INIT ('0'B);
      240     8298    1   DCL OPERATOR_ENTERED_TIME2 BIT (1) STATIC INIT ('0'B);
      241     8299    1   DCL OPERATOR_ENTERED_DATE2 BIT (1) STATIC INIT ('0'B);
      242     8300
      243     8301    1   DCL YR UBIN WORD STATIC;
      244     8302    1   DCL MON UBIN WORD STATIC;
      245     8303    1   DCL DAY UBIN WORD STATIC;
      246     8304    1   DCL HR UBIN WORD STATIC;
      247     8305    1   DCL MIN UBIN WORD STATIC;
      248     8306
      249     8307    1   DCL STK_INDEX SBIN WORD STATIC INIT (0);
      250     8308    1   DCL KEEP_ON_LISTING BIT (1) STATIC;
      251     8309    1   DCL A_SPECIFIC_FILE BIT (1) STATIC;
      252     8310    1   DCL WAIT_TIMES# UBIN WORD STATIC INIT (0);
      253     8311    1   DCL ALL BIT(1) STATIC;
      254     8312    1   DCL LINDEX SBIN WORD STATIC INIT (0);
      255     8313    1   DCL L SBIN WORD STATIC ;
      256     8314    1   DCL USE_LINDEX BIT(1) STATIC;
      257     8315    1   DCL LRECS UBIN WORD UNAL STATIC;
      258     8316    1   DCL A_INDEX UBIN WORD STATIC;
      259     8317    1   DCL A UBIN WORD STATIC;
      260     8318    1   DCL SOME_ON_STACK UBIN WORD STATIC;
      261     8319    1   DCL DIRECT BIT(1) STATIC;
      262     8320    1   DCL PERFORM_CALL BIT(1) STATIC;
      263     8321    1   DCL TYPE CHAR (8) STATIC INIT('?');
      264     8322    1   DCL IP_LOC_TYPE CHAR(8) STATIC INIT ('?');
      265     8323    1   DCL IP_ATTR_TYPE BIT(18) STATIC;
      266     8324    1   DCL PREFIX BIT(1) STATIC INIT ('1'B);
      267     8325    1   DCL TEXT_INDEX UBIN WORD STATIC;
      268     8326    1   DCL FREE_SPACE SBIN WORD STATIC INIT(0);
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:9    
      269     8327    1   DCL PAGES UBIN WORD STATIC INIT(0);
      270     8328    1   DCL LOGON_REPORT BIT(1) STATIC INIT ('0'B);
      271     8329    1   DCL BROKEN_FILE BIT(1) STATIC INIT ('0'B);
      272     8330    1   DCL LOGON_TITLE CHAR(72) STATIC INIT (' ');
      273     8331    1   DCL FOUND_IT BIT(1) STATIC UNAL INIT ('0'B);
      274     8332    1   DCL FIRST_TIME BIT(1) STATIC UNAL INIT ('0'B);
      275     8333    1   DCL C_FREE_SPACE SBIN WORD STATIC ALIGNED INIT (0);
      276     8334    1   DCL C_PAGES UBIN WORD STATIC ALIGNED INIT (0);
      277     8335    1   DCL C UBIN WORD STATIC ALIGNED INIT (0);
      278     8336    1   DCL CINDEX UBIN WORD STATIC ALIGNED INIT (0);
      279     8337    1   DCL KEYIN_TOTAL SBIN WORD STATIC ALIGNED INIT (0);
      280     8338    1   DCL PCT SBIN WORD STATIC ALIGNED INIT (0);
      281     8339    1   DCL CONSOLE_REPORT BIT(1) STATIC UNAL INIT('0'B);
      282     8340    1   DCL WILDCARDING BIT(1) STATIC UNAL INIT ('0'B);
      283     8341    1   DCL TEXT_VAR CHAR(8) STATIC CALIGNED INIT (' ');
      284     8342
      285     8343    1   DCL W UBIN WORD STATIC;
      286     8344    1   DCL NO_FILE BIT(1) STATIC INIT('0'B);
      287     8345    1   DCL WI UBIN WORD STATIC INIT (0);
      288     8346    1   DCL TI UBIN WORD STATIC INIT (0);
      289     8347    1   DCL REM_START REMEMBER STATIC SYMDEF;
      290     8348
      291     8349    1   DCL PARSE_WK (0:100) UBIN WORD STATIC;
      292     8350
      293     8351    1   DCL B$JIT$ PTR SYMREF;
      294     8352    1   DCL B$TCB$ PTR SYMREF;
      295     8353
      296     8354    1   DCL REPLAY_NODES PTR SYMREF;
      297     8355
      298     8356
      299     8357
      300     8358                                                /* Special micro-op instruction used
      301     8359                                                   to suppress leading zeroes         */
      302     8360
      303     8361    1   DCL MOP_8_DIGITS (0:1) BIT(9) CONSTANT INIT(%MVZB7,%MVC1);
      304     8362    1   DCL MOP_8_DIGITS_3 (0:1) BIT(9) CONSTANT INIT (%MVZB5,%MVC3);
      305     8363
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:10   
      306     8364    1   DCL 1 ERROR ALIGNED STATIC,
      307     8365    1          2 FCG BIT (18),
      308     8366    1          2 MON BIT (1),
      309     8367    1          2 ERR# UBIN (14) UNAL,
      310     8368    1          2 SEV UBIN (3) UNAL;
      311     8369
      312     8370    1   DCL 1 SUB_U1 STATIC,
      313     8371    1          2 COUNT UBIN BYTE CALIGNED INIT (25),
      314     8372    1          2 TEXT CHAR (25) CALIGNED;
      315     8373
      316     8374    1   DCL 1 ERR_MSG_FID STATIC,
      317     8375    1          2 COUNT UBIN BYTE CALIGNED INIT (18),
      318     8376    1          2 TEXT CHAR (15) INIT ('OR_PERR_C') CALIGNED;
      319     8377
      320     8378    1   DCL 1 PREV STATIC,
      321     8379    1          2 COUNT UBIN BYTE CALIGNED,
      322     8380    1          2 TXT CHAR(31);
      323     8381
      324     8382    1   DCL 1 PREV_STACK (0:0) BASED,
      325     8383    1          2 COUNT UBIN BYTE CALIGNED,
      326     8384    1          2 TXT CHAR(31) CALIGNED;
      327     8385
      328     8386    1   DCL 1 LOGON_REC_ON STATIC,
      329     8387    1          2 TERM_NAME CHAR(8) CALIGNED,
      330     8388    1          2 WSN CHAR(8) CALIGNED,
      331     8389    1          2 ATTRO BIT(18) HALIGNED,
      332     8390    1          2 LOGON CHAR(8) CALIGNED,
      333     8391    1          2 STATION,
      334     8392    1             3 FIRST_HALF CHAR(4) CALIGNED,
      335     8393    1             3 SECND_HALF CHAR(4) CALIGNED,
      336     8394    1          2 UTS UBIN WORD UNAL,
      337     8395    1          2 STATUS UBIN WORD UNAL;
      338     8396
      339     8397    1   DCL 1 LOGON_REC_OFF STATIC,
      340     8398    1          2 TERM_NAME CHAR(8) CALIGNED,
      341     8399    1          2 WSN CHAR(8) CALIGNED,
      342     8400    1          2 ATTRO BIT(18) HALIGNED,
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:11   
      343     8401    1          2 LOGON CHAR(8) CALIGNED,
      344     8402    1          2 STATION,
      345     8403    1             3 FIRST_HALF CHAR(4) CALIGNED,
      346     8404    1             3 SECND_HALF CHAR(4) CALIGNED,
      347     8405    1          2 UTS UBIN WORD UNAL,
      348     8406    1          2 STATUS UBIN WORD UNAL;
      349     8407
      350     8408    1   DCL 1 ATTR_REC STATIC,
      351     8409    1          2 ATTRO BIT(18) HALIGNED,
      352     8410    1          2 WSN CHAR(8) CALIGNED,
      353     8411    1          2 TERMINAL CHAR(8) CALIGNED,
      354     8412    1          2 STATION,
      355     8413    1             3 FIRST_HALF CHAR(4) CALIGNED,
      356     8414    1             3 SECND_HALF CHAR(4) CALIGNED;
      357     8415
      358     8416    1   DCL 1 CONS_RECORD STATIC,
      359     8417    1          2 LOGON CHAR(8) CALIGNED,
      360     8418    1          2 DEVNM CHAR(4) CALIGNED,
      361     8419    1          2 TERMINAL CHAR(8) CALIGNED,
      362     8420    1          2 KEYINS UBIN BYTE CALIGNED;
      363     8421
      364     8422    1   DCL 1 LSTACK (0:0) BASED,
      365     8423    1          2 TERM_NAME CHAR(8) CALIGNED,
      366     8424    1          2 WSN CHAR(8) CALIGNED,
      367     8425    1          2 ATTRO BIT(18) HALIGNED,
      368     8426    1          2 LOGON CHAR(8) CALIGNED,
      369     8427    1          2 STATION,
      370     8428    1             3 FIRST_HALF CHAR(4) CALIGNED,
      371     8429    1             3 SECND_HALF CHAR(4) CALIGNED,
      372     8430    1          2 UTS UBIN WORD UNAL,
      373     8431    1          2 STATUS UBIN WORD UNAL;
      374     8432
      375     8433    1   DCL 1 ASTACK (0:0) BASED,
      376     8434    1          2 ATTRO BIT(18) HALIGNED,
      377     8435    1          2 WSN CHAR(8) CALIGNED,
      378     8436    1          2 TERMINAL CHAR(8) CALIGNED,
      379     8437    1          2 STATION,
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:12   
      380     8438    1             3 FIRST_HALF CHAR(4) CALIGNED,
      381     8439    1             3 SECND_HALF CHAR(4) CALIGNED;
      382     8440
      383     8441    1   DCL 1 CSTACK (0:0) BASED,
      384     8442    1          2 LOGON CHAR(8) CALIGNED,
      385     8443    1          2 DEVNM CHAR(4) CALIGNED,
      386     8444    1          2 TERMINAL CHAR(8) CALIGNED,
      387     8445    1          2 KEYINS UBIN BYTE CALIGNED;
      388     8446        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:13   
      389     8447        %EQU ORR_ATTR# =10;
      390     8448
      391     8449    1   DCL 1 ORR_UNMASK(0:%ORR_ATTR#) STATIC SYMDEF ALIGNED,
      392     8450    1          2 MASK BIT (18) UNAL INIT (
      393     8451    1    '100000'O /* M_DEVC  */,
      394     8452    1    '044000'O /* M_ADCOM */,
      395     8453    1    '004000'O /* M_COMM  */,
      396     8454    1    '040000'O /* M_ADMIN */,
      397     8455    1    '200000'O /* M_SYS   */,
      398     8456    1    '001000'O /* M_TP */,
      399     8457    1    '0'B*0),
      400     8458    1          2 TERM BIT(1) UNAL INIT (
      401     8459    1    %YES#,                                 /* DEVC                               */
      402     8460    1    %NO#,
      403     8461    1    %NO#,
      404     8462    1    %NO#,
      405     8463    1    %NO#,
      406     8464    1    %NO#,
      407     8465    1    %NO# *0),
      408     8466    1          2 WSN BIT(1) UNAL INIT (
      409     8467    1    %NO#,
      410     8468    1    %YES#,                                 /* ADCOM                              */
      411     8469    1    %NO#,
      412     8470    1    %YES#,                                 /* ADMIN                              */
      413     8471    1    %NO#,
      414     8472    1    %NO#,
      415     8473    1    %NO# *0),
      416     8474    1          2 NM_CT UBIN BYTE ALIGNED INIT (
      417     8475    1    4,                                     /* DEVC                               */
      418     8476    1    5,                                     /* ADCOM                              */
      419     8477    1    4,                                     /* COMM                               */
      420     8478    1    5,                                     /* ADMIN                              */
      421     8479    1    6,                                     /* SYSTEM                             */
      422     8480    1    2,                                     /* TP                                 */
      423     8481    1    0*0),
      424     8482    1          2 NM CHAR(8) UNAL INIT (
      425     8483    1    'DEVC    ',
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:14   
      426     8484    1    'ADCOM   ',
      427     8485    1    'COMM    ',
      428     8486    1    'ADMIN   ',
      429     8487    1    'SYSTEM  ',
      430     8488    1    'TP      ',
      431     8489    1    ' '*0);
      432     8490
      433     8491        %P_PCB (NAME=P_PCB, STCLASS=STATIC);
      434     8690
      435     8691                                                /* "T" parameter for input
      436     8692                                                     and "W" with its WSZ for
      437     8693                                                     work area both default to
      438     8694                                                     1 page each                      */
      439     8695
      440     8696        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:15   
      441     8697         /*
      442     8698                  F P T   D E C L A R A T I O N S
      443     8699                                                */
      444     8700
      445     8701
      446     8702        %FPT_OPEN (FPTN=OPEN_HISTORYE,
      447     8703         NAME=FID_NAME,
      448     8704         ASN=FILE,
      449     8705         ACS=DIRECT,
      450     8706         DCB=F$HISTFILE,
      451     8707         FUN=IN,
      452     8708         SHARE=ALL,
      453     8709         ACCT=SYS,
      454     8710         CTG=YES,
      455     8711         ORG=KEYED);
      456     8820
      457     8821        %VLP_NAME (FPTN=FID_NAME);
      458     8848
      459     8849        %VLP_ACCT (FPTN=SYS,
      460     8850         ACCT=':SYSTAC');
      461     8863
      462     8864        %FPT_CLOSE (FPTN=CLOSE_HISTORYE,
      463     8865         NAME=FID_NAME,
      464     8866         DCB=F$HISTFILE);
      465     8908
      466     8909        %FPT_OPEN (FPTN=OPEN_OCMSG,
      467     8910         NAME=OCMSG,
      468     8911         ASN=FILE,
      469     8912         ACS=SEQUEN,
      470     8913         DCB=F$TEMPLATE,
      471     8914         FUN=IN,
      472     8915         SHARE=ALL,
      473     8916         ACCT=MSGACCT,
      474     8917         ORG=KEYED);
      475     9026
      476     9027        %VLP_NAME (FPTN=OCMSG,
      477     9028         NAME=':OCMSG');
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:16   
      478     9055
      479     9056        %VLP_ACCT (FPTN=MSGACCT,
      480     9057         ACCT=':SYS');
      481     9070
      482     9071        %FPT_CLOSE (FPTN=CLOSE_OCMSG,
      483     9072         DCB=F$TEMPLATE);
      484     9114
      485     9115        %FPT_ERRMSG (FPTN=ERR_FIND_TEMP,
      486     9116         BUF=MSG,
      487     9117         CODE=ERROR,
      488     9118         OUTDCB1=M$LO);
      489     9145
      490     9146        %FPT_ERRMSG (FPTN=GEN_ERR,
      491     9147         INCLCODE=NO,
      492     9148         BUF=MSG,
      493     9149         CODE=MODULE_ERR,
      494     9150         OUTDCB1=M$LO);
      495     9177
      496     9178        %VLP_ERRCODE (FPTN=MODULE_ERR,
      497     9179         FCG="'1722'O",
      498     9180         MID="'22'O");
      499     9225
      500     9226        %FPT_ERR (FPTN=ERR_GETTING_CMD,
      501     9227         CODE=OUT_ERROR,
      502     9228         STEPCC=ERROR);
      503     9243
      504     9244        %FPT_WRITE (FPTN=OUT_MSG,
      505     9245         DCB=M$LO,
      506     9246         BUF=MSG,
      507     9247         WAIT=YES);
      508     9278
      509     9279        %FPT_PROMPT (FPTN=PROMPT_IN,
      510     9280         PROMPT=CMD_INSTR);
      511     9308
      512     9309        %FPT_CLOSE (FPTN=CLOSE_OUT,
      513     9310         DCB=M$LO);
      514     9352
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:17   
      515     9353        %FPT_READ (FPTN=READ_HISTORYE,
      516     9354         BUF=OCL_HIST_BUF,
      517     9355         DCB=F$HISTFILE,
      518     9356         KEY=OCL_NORM_KEY,
      519     9357         KEYR=YES,
      520     9358         WAIT=YES);
      521     9397
      522     9398        %FPT_READ (FPTN=READ_CONSOLE_REC,
      523     9399         BUF=OCL_CONSOLE_REC,
      524     9400         DCB=F$HISTFILE,
      525     9401         KEY=OCL_CONSOLE_KEY,
      526     9402         KEYR=YES,
      527     9403         WAIT=YES);
      528     9442
      529     9443
      530     9444        %FPT_READ (FPTN=READ_STATUS,
      531     9445         BUF=OCL_STATUS_REC,
      532     9446         DCB=F$HISTFILE,
      533     9447         KEY=OCL_STATUS_KEY,
      534     9448         KEYR=YES,
      535     9449         WAIT=YES);
      536     9488
      537     9489        %FPT_GDS (FPTN=STACK_SEG,
      538     9490         RESULTS=GDS_RESULTS_VEC,
      539     9491         SEGSIZE=8);
      540     9507
      541     9508        %VLP_VECTOR (FPTN=GDS_RESULTS_VEC,
      542     9509         SEGID='0000'O);
      543     9524
      544     9525        %FPT_FDS (FPTN=RELEASE_SEG,
      545     9526         RESULTS=FDS_RESULTS_VEC,
      546     9527         SEGSIZE=8);
      547     9542
      548     9543        %VLP_VECTOR (FPTN=FDS_RESULTS_VEC,
      549     9544         SEGID='0000'O);
      550     9559
      551     9560        %FPT_WRITE (FPTN=WRITE_HIST_BUF_MESS,
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:18   
      552     9561         BUF=OUT_BUFFER,
      553     9562         DCB=M$LO,
      554     9563         WAIT=YES);
      555     9594
      556     9595        %FPT_GDS (FPTN=GET_LSTACK_SEG,
      557     9596         RESULTS=LSTACK_RESULTS_VEC,
      558     9597         SEGSIZE=1024);
      559     9613
      560     9614        %VLP_VECTOR (FPTN=LSTACK_RESULTS_VEC,
      561     9615         SEGID='0000'O);
      562     9630
      563     9631        %FPT_FDS (FPTN=FREE_LSTACK_SEG,
      564     9632         RESULTS=LSTACK_RESULTS_VEC,
      565     9633         SEGSIZE=1024);
      566     9648
      567     9649        %FPT_GDS (FPTN=GET_ATTR_SEG,
      568     9650         RESULTS=ASTACK_RESULTS_VEC,
      569     9651         SEGSIZE=1024);
      570     9667
      571     9668        %VLP_VECTOR (FPTN=ASTACK_RESULTS_VEC,
      572     9669         SEGID='0000'O);
      573     9684
      574     9685        %FPT_FDS (FPTN=FREE_ASTACK_SEG,
      575     9686         RESULTS=ASTACK_RESULTS_VEC,
      576     9687         SEGSIZE=1024);
      577     9702
      578     9703        %FPT_GDS (FPTN=GET_C_PAGE,
      579     9704         RESULTS=CSTACK_RESULTS_VEC,
      580     9705         SEGSIZE=1024);
      581     9721
      582     9722        %VLP_VECTOR (FPTN=CSTACK_RESULTS_VEC,
      583     9723         SEGID='0000'O);
      584     9738
      585     9739        %FPT_FDS (FPTN=FREE_C_PAGE,
      586     9740         RESULTS=CSTACK_RESULTS_VEC,
      587     9741         SEGSIZE=1024);
      588     9756
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:19   
      589     9757        %FPT_PRECORD (FPTN=HIST_POSITION,
      590     9758         DCB=F$HISTFILE,
      591     9759         KEY=OCL_NORM_KEY,
      592     9760         KEYR=YES,
      593     9761         KEYS=YES);
      594     9782
      595     9783        %FPT_TIME (FPTN=TIME_CONV,
      596     9784         DATE=FPT_DATE,
      597     9785         TIME=FPT_TIME,
      598     9786         DEST=UTS,
      599     9787         SOURCE=ANS,
      600     9788         TSTAMP=UTSTAMP);
      601     9807
      602     9808        %FPT_TIME (FPTN=TIME_SET,
      603     9809         DATE=DATE_BUF,
      604     9810         TIME=TIME_BUF,
      605     9811         DEST=ANS,
      606     9812         SOURCE=UTS);
      607     9831
      608     9832        %FPT_TIME (FPTN=TIME_SIMULATION,
      609     9833         DATE=SIM_DATE,
      610     9834         TIME=SIM_TIME,
      611     9835         DEST=LOCAL,
      612     9836         SOURCE=UTS,
      613     9837         TSTAMP=OCL_NORM_KEY.UTS);
      614     9856
      615     9857        %FPT_WRITE (FPTN=WRITE_TIME,
      616     9858         BUF=TIME_BUFFER,
      617     9859         DCB=M$LO,
      618     9860         WAIT=YES);
      619     9891
      620     9892        %FPT_TIME (FPTN=TIME_TO_UTS,
      621     9893         DATE=TO_UTS_DATE,
      622     9894         TIME=TO_UTS_TIME,
      623     9895         DEST=UTS,
      624     9896         SOURCE=LOCAL,
      625     9897         TSTAMP=PRINTED_TIME);
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:20   
      626     9916
      627     9917        %FPT_INT (FPTN=BREAK_IN,
      628     9918         UENTRY=XUR$BREAK);
      629     9932        %FPT_OPEN (FPTN=CS_OPEN,
      630     9933         DCB=M$CSCG,
      631     9934         ASN=COMGROUP,
      632     9935         SETSTA=KSST,
      633     9936         FUN=UPDATE,
      634     9937         SHARE=ALL,
      635     9938         ACCT=CSACCT,
      636     9939         NAME=CSCGNM);
      637    10048
      638    10049        %VLP_NAME (FPTN=CSCGNM,
      639    10050         NAME='CSCG');
      640    10077
      641    10078        %VLP_SETSTA (FPTN=KSST,
      642    10079         STCLASS=STATIC,
      643    10080         MYSTATION='RE      ');
      644    10108
      645    10109        %VLP_ACCT (FPTN=CSACCT,
      646    10110         ACCT=':SYS');
      647    10123
      648    10124        %FPT_WRITE (FPTN=WRITE_CS,
      649    10125         DCB=M$CSCG,
      650    10126         STATION=STA,
      651    10127         BP=YES,
      652    10128         BUF=OR_MESSBUF);
      653    10159
      654    10160        %VLP_STATION (FPTN=STA,
      655    10161         STATION='KEYIN');
      656    10188
      657    10189        %FPT_PRECORD (FPTN=FIRST_HIST_REC,
      658    10190         DCB=F$HISTFILE,
      659    10191         KEYS=NO);
      660    10212
      661    10213        %FPT_CLOSE (FPTN=CS_CLOSE,
      662    10214         DCB=M$CSCG);
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:21   
      663    10256
      664    10257        %FPT_WAIT (FPTN=WAIT_HIST,
      665    10258         UNITS=1);
      666    10272
      667    10273        %FPT_PFIL (FPTN=POSITION_AT_END,
      668    10274         DCB=F$HISTFILE,
      669    10275         BOF=NO);
      670    10290
      671    10291        %FPT_UNFID (FPTN=GET_DCB_INFO,
      672    10292         DCB=M$SI,
      673    10293         ASN=ASNFID,
      674    10294         TEXTFID=TXTFD,
      675    10295         NAME=FID_NAME);
      676    10313
      677    10314        %FPT_XCON (FPTN=ABNORMAL_EXIT,
      678    10315         UENTRY=ORR$AXCONRTN);
      679    10329
      680    10330        %FPT_FID (FPTN=FID_DEST,
      681    10331         NAME=DEST_NAME,
      682    10332         RES=OPEN_DEST.V.RES#,
      683    10333         ACCT=DEST_ACCT,
      684    10334         PASS=DEST_PASS,
      685    10335         ASN=OPEN_DEST.V.ASN#,
      686    10336         WSN=DEST_WSN,
      687    10337         SNAME=YES,
      688    10338         SACCT=YES,
      689    10339         SPASS=YES,
      690    10340         SWSN=YES,
      691    10341         SRES=YES,
      692    10342         SSN=YES,
      693    10343         RESULTS=DEST_RESULTS);
      694    10366
      695    10367        %VLP_NAME (FPTN=DEST_NAME);
      696    10394
      697    10395        %VLP_WSN (FPTN=DEST_WSN);
      698    10408
      699    10409        %VLR_FID (FPTN=DEST_RESULTS);
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:22   
      700    10428
      701    10429        %VLP_ACCT (FPTN=DEST_ACCT);
      702    10442
      703    10443        %VLP_PASS (FPTN=DEST_PASS);
      704    10456
      705    10457        %FPT_OPEN (FPTN=OPEN_LO,
      706    10458         ORG=UR,
      707    10459         DCB=M$LO);
      708    10568
      709    10569        %FPT_OPEN (FPTN=OPEN_DEST,
      710    10570         DCB=M$LO,
      711    10571         SCRUB=YES,
      712    10572         NAME=DEST_NAME,
      713    10573         ACCT=DEST_ACCT,
      714    10574         PASS=DEST_PASS,
      715    10575         CTG=YES,
      716    10576         EXIST=NEWFILE,
      717    10577         WSN=DEST_WSN);
      718    10686
      719    10687        %FPT_CLOSE (FPTN=CLOSE_LO,
      720    10688         DCB=M$LO,
      721    10689         DISP=SAVE);
      722    10731
      723    10732        %FPT_TIME (FPTN=RANGE_CONV,
      724    10733         DATE=SIM_DATE,
      725    10734         TIME=SIM_TIME,
      726    10735         DEST=LOCAL,
      727    10736         SOURCE=UTS);
      728    10755
      729    10756        %FPT_XCON (FPTN=RESET_XCON);
      730    10770
      731    10771        %VLP_NAME (FPTN=HELP_NAME,
      732    10772         NAME='REPLAY');
      733    10799
      734    10800        %VLP_ACCT (FPTN=HELP_ACCT,
      735    10801         ACCT=':SYS');
      736    10814
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:23   
      737    10815        %FPT_PRIV (FPTN=FMPRIV,
      738    10816         PPRIV=YES,
      739    10817         PRIV=%PPR_REPLAY#);
      740    10832        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:24   
      741    10833         /*
      742    10834                  - O R R $ R E P L A Y -
      743    10835
      744    10836                  M A I N   P R O G R A M
      745    10837                                                */
      746    10838
      747    10839    1      CALL XUR$INIT (XUR_INIT);
      748    10840
      749    10841                                                /* XUR_INIT is in XU_MACRO_C.
      750    10842                                                   It is used to int aspects of
      751    10843                                                   XUR$GETCMD.  If XUR$BREAK is
      752    10844                                                   used, you must specify an
      753    10845                                                   EPTR of the abort rtn.
      754    10846                                                          */
      755    10847
      756    10848    2      CALL M$SPRIV (FMPRIV) WHENALTRETURN DO;
      757    10849
      758    10850        /*E* ERROR: ORR-E_PRIVERR#-7
      759    10851             MESSAGE: Sorry, you have insufficient privilege to run REPLAY.
      760    10852        */
      761    10853    2         MODULE_ERR.ERR# = 40 /* E_PRIVERR# */;
      762    10854    2         MODULE_ERR.SEV = 0;
      763    10855    2         CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
      764    10856    2         CALL M$XXX;
      765    10857    2      END;
      766    10858
      767    10859        /* Get language default, other stuff from the jit.                            */
      768    10860
      769    10861    1      LANGUAGE = B$JIT$ -> B$JIT.LANG;
      770    10862    1      CALL BINCHAR (TEXT_VAR, B$JIT$ -> B$JIT.SYSID);
      771    10863    1      CALL INSERT (KSST.MYSTATION#, 2, 6, SUBSTR (TEXT_VAR, 2, 6));
      772    10864
      773    10865    1      CALL M$PROMPT (PROMPT_IN);
      774    10866
      775    10867                                                /* Set terminal input
      776    10868                                                     prompt.                          */
      777    10869
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:25   
      778    10870
      779    10871    1      REMEMBER INITIALIZE IN REM_START;
      780    10872
      781    10873                                                /* XUR$BREAK calls ORR$BRKRTN
      782    10874                                                     if user chooses not to
      783    10875                                                     continue after being
      784    10876                                                     prompted.                        */
      785    10877
      786    10878    1      CALL M$INT (BREAK_IN) ALTRET (CANT_CALL_INT);
      787    10879
      788    10880                                                /* Assign XUR$BREAK to process
      789    10881                                                   breaks.                            */
      790    10882
      791    10883    1      CALL M$XCON (ABNORMAL_EXIT) ALTRET (CANT_CALL_XCON);
      792    10884
      793    10885                                                /* In case of abnormal ending
      794    10886                                                     go to ORR$XCONRTN                */
      795    10887
      796    10888    1      CALL XUR$SETDCBS (DCBNUM (M$IN), DCBNUM (M$LO));
      797    10889                                                /* Check if M$LO was opened via
      798    10890                                                     an entry on the line which
      799    10891                                                     invoked REPLAY. If not,
      800    10892                                                     open it.                         */
      801    10893
      802    10894                                                /* Set DCBs for XUR$GETCMD            */
      803    10895
      804    10896    1      CALL CONCAT(MSG,'REPLAY ',ADDR(B_VERSION)->B_VERSION_.C,' here');
      805    10897    1      OUT_MSG.BUF_.BOUND = 12 + B_VERSION.L;
      806    10898    2      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;
      807    10899
      808    10900                                                /* Label "INITIALIZE" represents the
      809    10901                                                   point of return following <BREAK>
      810    10902                                                   command processing.  All necessary
      811    10903                                                   clean-up should happen here.       */
      812    10904
      813    10905    2      DO WHILE (%NO#);
      814    10906    2   INITIALIZE:;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:26   
      815    10907
      816    10908                                                /* Release file-name stack, and
      817    10909                                                   (re) initialize ptr.               */
      818    10910
      819    10911    2         FDS_RESULTS_VEC.PTR$ = GDS_RESULTS_VEC.PTR$;
      820    10912    2         RELEASE_SEG.V.SEGSIZE# = (STK_INDEX * 8) + LENGTHW (PREV);
      821    10913    3         CALL M$FDS (RELEASE_SEG) WHENALTRETURN DO; END;
      822    10914
      823    10915    2         STK_INDEX = 0;
      824    10916    2         RELEASE_SEG.V.SEGSIZE# = LENGTHW(PREV);
      825    10917    2         GDS_RESULTS_VEC.PTR$ = ADDR (NIL);
      826    10918
      827    10919                                                /* Release attribute stack, and
      828    10920                                                   (re) initialize ptr.               */
      829    10921
      830    10922    3         CALL M$FDS (FREE_ASTACK_SEG) WHENALTRETURN DO; END;
      831    10923
      832    10924    2         ASTACK_RESULTS_VEC = VECTOR (NIL);
      833    10925
      834    10926                                                /* Release logon stack, and
      835    10927                                                   (re) initialize ptr.               */
      836    10928
      837    10929    2         FREE_LSTACK_SEG.V.SEGSIZE# = PAGES * 1024;
      838    10930    3         CALL M$FDS (FREE_LSTACK_SEG) WHENALTRETURN DO; END;
      839    10931
      840    10932    2         PAGES = 0;
      841    10933    2         LSTACK_RESULTS_VEC.PTR$ = ADDR(NIL);
      842    10934
      843    10935                                                /* Release console stack (used in
      844    10936                                                   keyin tabulating), and
      845    10937                                                   (re) initialize ptr.               */
      846    10938
      847    10939    2         FREE_C_PAGE.V.SEGSIZE# = C_PAGES * 1024;
      848    10940    3         CALL M$FDS (FREE_C_PAGE) WHENALTRETURN DO; END;
      849    10941
      850    10942    2         C_PAGES = 0;
      851    10943    2         FIRST_TIME = %YES#;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:27   
      852    10944    2         CSTACK_RESULTS_VEC = VECTOR (NIL);
      853    10945    2      END;
      854    10946
      855    10947    1      IF NOT DCBADDR(DCBNUM(M$LO))->F$DCB.FCD#
      856    10948    1      THEN CALL M$OPEN (OPEN_LO) ALTRET (CANT_OPEN_LO);
      857    10949    1      ERROR.ERR# = 0;
      858    10950    1      NO_FILE = %NO#;
      859    10951
      860    10952        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:28   
      861    10953        /*           M A I N   P R O C E S S I N G   L O O P                          */
      862    10954
      863    10955    1   SELECTIONS:;
      864    10956    2      CALL XUR$GETCMD( REPLAY_NODES, OUT$, VECTOR(CMD_INSTR)) WHENALTRETURN DO;
      865    10957
      866    10958    2         ERROR = OUT_ERROR;
      867    10959
      868    10960    3         IF OUT_ERROR.ERR# = %E$SYNERR THEN DO;
      869    10961    3            CALL XUR$ECHOIF (DCBNUM(M$LO));
      870    10962    3            CALL XUR$ERRPTR (,DCBNUM(M$LO));
      871    10963    3         END;
      872    10964
      873    10965    2         CALL XUR$ERRMSG (OUT_ERROR,,DCBNUM(M$LO)) ALTRET (CANT_CALL_XUR_ERRMSG);
      874    10966
      875    10967    2         IF OUT_ERROR.ERR# = %E$EOF
      876    10968    2           OR OUT_ERROR.MON
      877    10969    2         THEN CALL M$ERR(ERR_GETTING_CMD);
      878    10970
      879    10971    2         GOTO SELECTIONS;
      880    10972    2      END;
      881    10973        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:29   
      882    10974    2      DO CASE (OUT$ -> OUT$BLK.CODE);      /* DO COMMAND                         */
      883    10975
      884    10976    2      CASE (%CMD_SPAN#);
      885    10977    2         CALL DO_TIME;
      886    10978
      887    10979    2      CASE (%CMD_SELECT#);
      888    10980    2         CALL SELECTION_RETRIEVER;
      889    10981
      890    10982    2      CASE (%CMD_REPORT#);
      891    10983    2         ERROR.ERR# = 0;
      892    10984    2         CALL SET_DESTINATION;
      893    10985    2         CALL SET_DEFAULTS;
      894    10986    2         CALL CLOBBER_TIME_DEFAULTS;
      895    10987
      896    10988
      897    10989                                                /* Set pointer to first available
      898    10990                                                     free storage.                    */
      899    10991
      900    10992    2         STK_INDEX = 0;
      901    10993    2         CALL OPEN_TO_RANGE;
      902    10994
      903    10995    2         PAGES = 0;
      904    10996    2         FREE_SPACE = 0;
      905    10997    2         SOME_ON_STACK = 0;
      906    10998    2         LINDEX = 0;
      907    10999    2         CALL BUILD_CONSOLE_STACK;
      908    11000    2         OCL_NORM_KEY.UTS = BEGINNING_TIME;
      909    11001    2         OCL_NORM_KEY.COUNT = 4;
      910    11002    2         HIST_POSITION.V.N# = 0;
      911    11003    2         OC_MSG_GOOD = %YES#;
      912    11004    2         PRINT_FLAG = %NO#;
      913    11005
      914    11006                                                /* Set PRINT_FLAG indicator:
      915    11007                                                     0 means no records were
      916    11008                                                       found for current criteria
      917    11009                                                     1 means at least 1 record
      918    11010                                                       was found                      */
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:30   
      919    11011
      920    11012    2         PRINTED_TIME = 0;
      921    11013
      922    11014                                                /* Initialize hold area for the
      923    11015                                                     simulated print time.            */
      924    11016
      925    11017    2         CALL M$OPEN (OPEN_OCMSG) ALTRET (CANT_OPEN_OCMSG);
      926    11018
      927    11019                                                /* Open template file.                */
      928    11020
      929    11021    2         GOTO DO_LIST;
      930    11022
      931    11023    2      CASE (%CMD_NATLANG#);
      932    11024    2         LANGUAGE = OUT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXTC$->TEXTC.TEXT;
      933    11025
      934    11026    2      CASE (%CMD_END#);
      935    11027    2         GOTO CLOSE_OUT;
      936    11028
      937    11029    2      CASE (%CMD_HELP#);
      938    11030    2         XUH_PARAM.HELP$ = OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXTC$;
      939    11031    2         CALL XUR$HELP (XUH_PARAM);
      940    11032
      941    11033    2      CASE (%CMD_QUESTION1#);
      942    11034
      943    11035    2         CALL XUR$MOREMSG (XUH_PARAM) ALTRET (CANT_HELP);
      944    11036
      945    11037    2      CASE (%CMD_QUESTION2#);
      946    11038
      947    11039    2         CALL XUR$ALLMSG (XUH_PARAM) ALTRET (CANT_HELP);
      948    11040
      949    11041    2      CASE (%CMD_RESET#);
      950    11042    2         CALL DO_RESET;
      951    11043
      952    11044    2      CASE (%CMD_DISPLAY#);
      953    11045    2         CALL DO_DISPLAY;
      954    11046
      955    11047                                                /* Set flags, then let REPORT call
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:31   
      956    11048                                                     set defaults for you             */
      957    11049
      958    11050    2      CASE (%CMD_CREPORT#);
      959    11051
      960    11052    2         CONSOLE_REPORT = %YES#;
      961    11053    2         FIRST_TIME = %YES#;
      962    11054    2         LOGON_REPORT = %NO#;
      963    11055
      964    11056    2      CASE (%CMD_LREPORT#);
      965    11057    2         LOGON_REPORT = %YES#;
      966    11058    2         CONSOLE_REPORT = %NO#;
      967    11059
      968    11060    2      CASE (%CMD_NULL#);
      969    11061
      970    11062                                                /* DO NOTHING                         */
      971    11063
      972    11064
      973    11065    2      END;                                 /* End case (out$ -> out$blk.code);   */
      974    11066
      975    11067    2      DO WHILE ('0'B);
      976    11068    2   CANT_HELP:;
      977    11069        /*E* ERROR: ORR-E_HELPERR#-7
      978    11070             MESSAGE: No more information.
      979    11071             MESSAGE1: You asked for more messages, but we were unable locate any
      980    11072                       further information about your last help or error message.
      981    11073                       Refer to the CP-6 System Support Reference Manual for more
      982    11074                       information about REPLAY.                                      */
      983    11075    2         ERROR = XUH_PARAM.ERR;
      984    11076    2         MODULE_ERR.ERR# = 34 /* E_HELPERR# */;
      985    11077    2         MODULE_ERR.SEV = 0;
      986    11078    2         CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO)) ALTRET (CANT_CALL_XUR_ERRMSG);
      987    11079    2      END;
      988    11080    1      GOTO SELECTIONS;
      989    11081        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:32   
      990    11082    1   DO_LIST:;
      991    11083
      992    11084    1      IF LOGON_REPORT THEN GOTO REPORT_END_POINT;
      993    11085
      994    11086    2      CALL M$PRECORD (HIST_POSITION) WHENALTRETURN DO;
      995    11087    2         ERROR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      996    11088    2         IF ERROR.ERR# ~= %E$NOKEY THEN GOTO CHECK_END;
      997    11089    2      END;
      998    11090
      999    11091    1      IF HIST_POSITION.V.N# = 0
     1000    11092    1      THEN HIST_POSITION.V.N# = 1;
     1001    11093
     1002    11094    1      IF OCL_NORM_KEY.COUNT = 0 THEN GOTO REPORT_END_POINT;
     1003    11095
     1004    11096    1      CALL M$READ (READ_HISTORYE) ALTRET (CHECK_END);
     1005    11097
     1006    11098                                                /* Read the :ochist file.             */
     1007    11099
     1008    11100    1      IF OCL_NORM_KEY.UTS = 0 THEN GOTO DO_LIST;
     1009    11101
     1010    11102    1      THOLD = OCL_HIST_BUF.TSTAMP;
     1011    11103
     1012    11104    1      IF VALID_CHECK(0) = 'FR'
     1013    11105    1        OR VALID_CHECK(0) = 'TO' THEN GOTO DO_LIST;
     1014    11106
     1015    11107                                                /* Valid check redefines thold.       */
     1016    11108    2      IF TYPE ~= '?' THEN DO;
     1017    11109    2         IF OCL_HIST_BUF.TYPE ~= 0 THEN GOTO DO_LIST;
     1018    11110
     1019    11111    2         CALL INDEX (WI, '?', OCL_HIST_BUF.WSN);
     1020    11112    2         CALL INDEX (TI, '?', OCL_HIST_BUF.TERMINAL);
     1021    11113
     1022    11114    2         IF (IP_ATTR_TYPE & '200000'O /* M_SYS  */)
     1023    11115    2           AND (OCL_HIST_BUF.ATTR & ('200000'O /* M_SYS  */ | '004000'O /* M_COMM */ |
             11115                    '040000'O /* M_ADMIN */ | '001000'O /* M_TP */)
     1024    11116    2           OR (OCL_HIST_BUF.ATTR & '100000'O /* M_DEVC  */ AND (OCL_HIST_BUF.STATION.
             11116                    SECND_HALF = '0000')))
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:33   
     1025    11117    3         THEN DO;
     1026    11118    3            IF (OCL_HIST_BUF.ATTR & '000040'O /* M_NONSYS */)
     1027    11119    3            THEN GOTO DO_LIST;
     1028    11120    3            ELSE GOTO CHECK_TIME;
     1029    11121    3         END;
     1030    11122
     1031    11123    2         IF IP_ATTR_TYPE & '004000'O /* M_COMM */
     1032    11124    2           AND (OCL_HIST_BUF.ATTR & '004000'O /* M_COMM */) THEN GOTO CHECK_TIME;
     1033    11125
     1034    11126    2         IF (IP_ATTR_TYPE = '100000'O /* M_DEVC  */)
     1035    11127    3           AND (OCL_HIST_BUF.ATTR & '100000'O /* M_DEVC  */) THEN DO;
     1036    11128
     1037    11129    3            IF IP_LOC_TYPE = '?' THEN GOTO DO_LIST;
     1038    11130
     1039    11131    3            IF SUBSTR (IP_LOC_TYPE, 0, TI) ~= SUBSTR (OCL_HIST_BUF.TERMINAL, 0, TI)
     1040    11132    3            THEN GOTO DO_LIST;
     1041    11133    3            ELSE GOTO CHECK_TIME;
     1042    11134    3         END;
     1043    11135
     1044    11136    2         IF (IP_ATTR_TYPE & '040000'O /* M_ADMIN */)
     1045    11137    3           AND (OCL_HIST_BUF.ATTR & '040000'O /* M_ADMIN */) THEN DO;
     1046    11138
     1047    11139    3            IF IP_LOC_TYPE = '?' THEN GOTO DO_LIST;
     1048    11140
     1049    11141    3            IF SUBSTR (IP_LOC_TYPE, 0, WI) ~= SUBSTR (OCL_HIST_BUF.WSN, 0, WI)
     1050    11142    3            THEN GOTO DO_LIST;
     1051    11143    3            ELSE GOTO CHECK_TIME;
     1052    11144    3         END;
     1053    11145
     1054    11146    2         IF (IP_ATTR_TYPE & '001000'O /* M_TP */)
     1055    11147    2           AND (OCL_HIST_BUF.ATTR & '001000'O /* M_TP */) THEN GOTO CHECK_TIME;
     1056    11148
     1057    11149    2         GOTO DO_LIST;
     1058    11150    2      END;
     1059    11151
     1060    11152
     1061    11153    2      IF NOT ALL THEN DO;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:34   
     1062    11154    2         CALL M$GDS (GET_ATTR_SEG) ALTRET (NO_SEGS);
     1063    11155    2         CALL BUILD_ATTR_STACK;
     1064    11156
     1065    11157    2         IF A_INDEX = 0 THEN GOTO LOSE_IT;
     1066    11158    3         DO A = 1 TO (A_INDEX);
     1067    11159    3            ATTR_REC = ASTACK_RESULTS_VEC.PTR$ -> ASTACK(A);
     1068    11160    3            CALL INDEX (WI, '?', ATTR_REC.WSN);
     1069    11161    3            CALL INDEX (TI, '?', ATTR_REC.TERMINAL);
     1070    11162    4            DO CASE (OCL_HIST_BUF.TYPE);
     1071    11163    4            CASE (0);
     1072    11164    4               IF (ATTR_REC.ATTRO & OCL_HIST_BUF.ATTR & ('004000'O /* M_COMM */|
             11164                        '001000'O /* M_TP */)) THEN GOTO CHECK_TIME;
     1073    11165
     1074    11166    4               IF (ATTR_REC.ATTRO & OCL_HIST_BUF.ATTR & '100000'O /* M_DEVC  */)
     1075    11167    4                 AND (SUBSTR (OCL_HIST_BUF.TERMINAL, 0, TI) = SUBSTR (ATTR_REC.TERMINAL
             11167                          , 0, TI))
     1076    11168    4               THEN GOTO CHECK_TIME;
     1077    11169
     1078    11170    4               IF (ATTR_REC.ATTRO & OCL_HIST_BUF.ATTR & '040000'O /* M_ADMIN */)
     1079    11171    4                 AND (SUBSTR (OCL_HIST_BUF.WSN, 0, WI) = SUBSTR (ATTR_REC.WSN, 0, WI))
     1080    11172    4               THEN GOTO CHECK_TIME;
     1081    11173
     1082    11174    4               IF (ATTR_REC.ATTRO & '200000'O /* M_SYS  */)
     1083    11175    4                 AND NOT (OCL_HIST_BUF.ATTR & '000040'O /* M_NONSYS */)
     1084    11176    4                 AND ( (OCL_HIST_BUF.ATTR & ('200000'O /* M_SYS  */|'004000'O
             11176                          /* M_COMM */|'001000'O /* M_TP */))
     1085    11177    4                 OR ( (OCL_HIST_BUF.ATTR & '040000'O /* M_ADMIN */)
     1086    11178    4                 AND (SUBSTR (ATTR_REC.WSN, 0, WI) = SUBSTR (OCL_HIST_BUF.WSN, 0, WI)))
     1087    11179    4                 OR ( (OCL_HIST_BUF.ATTR & '100000'O /* M_DEVC  */)
     1088    11180    4                 AND (ATTR_REC.STATION.SECND_HALF = OCL_HIST_BUF.STATION.SECND_HALF)))
     1089    11181    4               THEN GOTO CHECK_TIME;
     1090    11182
     1091    11183    4            CASE (1,2,3);                  /* KEYIN AND OUTPUT_DIRECT            */
     1092    11184    5               IF DIRECT THEN DO;
     1093    11185    5                  IF ((OCL_HIST_BUF.DEVNM = ATTR_REC.STATION.FIRST_HALF)
     1094    11186    5                    AND (OCL_HIST_BUF.TERMINAL = ATTR_REC.TERMINAL)) THEN GOTO
             11186                             CHECK_TIME;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:35   
     1095    11187    5               END;
     1096    11188    5               ELSE DO;
     1097    11189    5                  IF (OCL_HIST_BUF.WSN = ATTR_REC.WSN) THEN GOTO CHECK_TIME;
     1098    11190    5               END;
     1099    11191    4            END;                           /* END OF CASE                        */
     1100    11192    3         END;
     1101    11193    2      END;
     1102    11194
     1103    11195    2      IF NOT ALL THEN DO;
     1104    11196    2   LOSE_IT:
     1105    11197    3         CALL M$FDS (FREE_ASTACK_SEG) WHENALTRETURN DO; END;
     1106    11198    2         GOTO DO_LIST;
     1107    11199    2      END;
     1108    11200    1   CHECK_TIME:;
     1109    11201
     1110    11202
     1111    11203    2      CALL M$FDS (FREE_ASTACK_SEG) WHENALTRETURN DO; END;
     1112    11204
     1113    11205    1      IF OCL_NORM_KEY.UTS < BEGINNING_TIME THEN GOTO DO_LIST;
     1114    11206
     1115    11207    1      IF OCL_NORM_KEY.UTS > ENDING_TIME
     1116    11208    1        AND (FID_NAME.NAME#~=':OCHIST'
     1117    11209    1        OR OPERATOR_ENTERED_TIME2
     1118    11210    1        OR OPERATOR_ENTERED_DATE2) THEN GOTO REPORT_END_POINT;
     1119    11211
     1120    11212    1      OCM_KEY_FLAG = %NO#;       /* Set OCM_KEY_FLAG to zero so the following data
     1121    11213                                         will be used in OCM_TEMPLATE (keyin)         */
     1122    11214    1      OCM_TSTAMP = OCL_HIST_BUF.TSTAMP;
     1123    11215    1      OCM_WSN = OCL_HIST_BUF.WSN;
     1124    11216    1      OCM_PROMPT.SIZE = OCL_HIST_BUF.PROMPT_LENGTH;
     1125    11217    1      OCM_PROMPT.TEXT = SUBSTR (OCL_HIST_BUF.MESS,0,OCL_HIST_BUF.PROMPT_LENGTH);
     1126    11218
     1127    11219    2      IF CONSOLE_REPORT THEN DO;
     1128    11220    2         CALL GATHER_C_STATS;
     1129    11221    2         GOTO DO_LIST;
     1130    11222    2      END;
     1131    11223        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:36   
     1132    11224
     1133    11225    2      DO CASE (OCL_HIST_BUF.TYPE);
     1134    11226
     1135    11227         /*************************************/
     1136    11228         /*                                   */
     1137    11229         /*       First type of message       */
     1138    11230         /*              -Output-              */
     1139    11231         /*                                   */
     1140    11232         /*************************************/
     1141    11233
     1142    11234    2      CASE (0);
     1143    11235
     1144    11236
     1145    11237                                                /* If record has no template then
     1146    11238                                                     skip call to tpset, and just use
     1147    11239                                                     text string                      */
     1148    11240
     1149    11241    3         IF OCL_HIST_BUF.TEMPLATE THEN DO;
     1150    11242    3            OCM_BUFFER = OCL_HIST_BUF.MESS;
     1151    11243    3            OCM_BPOSN = DCBADDR (DCBNUM (F$HISTFILE)) -> F$DCB.ARS# -
     1152    11244    3              (LENGTHC (OCL_NORM_KEY.UTS) +
     1153    11245    3              LENGTHC (OCL_HIST_BUF.WSN) +
     1154    11246    3              LENGTHC (OCL_HIST_BUF.LOGON) +
     1155    11247    3              LENGTHC (OCL_HIST_BUF.DEVNM) +
     1156    11248    3              LENGTHC (OCL_HIST_BUF.TERMINAL) +
     1157    11249    3              LENGTHC (OCL_HIST_BUF.ATTR) +
     1158    11250    3              LENGTHC (OCL_HIST_BUF.TEMPLATE) +
     1159    11251    3              LENGTHC (OCL_HIST_BUF.TYPE) +
     1160    11252    3              LENGTHC (OCL_HIST_BUF.PROMPT_LENGTH));
     1161    11253    3            GOTO SKIP_TPSET;
     1162    11254    3         END;
     1163    11255
     1164    11256    2         CALL OCM$TPSET (LANGUAGE,
     1165    11257    2           SUBSTR (OCL_HIST_BUF.MESS,OCL_HIST_BUF.PROMPT_LENGTH,LENGTHC(OCL_HIST_BUF.
             11257                    MESS)-OCL_HIST_BUF.PROMPT_LENGTH))
     1166    11258    2           ALTRET (BAD_LANG);
     1167    11259
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:37   
     1168    11260                                                /* This routine formats the
     1169    11261                                                     records from :ochist in
     1170    11262                                                     the specified language. It
     1171    11263                                                     places a formatted message
     1172    11264                                                     in OCM_BUFFER, and its length
     1173    11265                                                     in OCM_BPOSN.                    */
     1174    11266
     1175    11267    2   SKIP_TPSET:;
     1176    11268    2         OUT_BUFFER = ' ';
     1177    11269
     1178    11270    3         IF PREFIX THEN DO;
     1179    11271    3            OUT_BUFFER = 'TO   ';
     1180    11272    3            HERE = 5;
     1181    11273
     1182    11274                                                /* Initialize buffer and position
     1183    11275                                                     counter.                         */
     1184    11276
     1185    11277
     1186    11278    4            DO IND = 0 TO %ORR_ATTR#;
     1187    11279                                                /* Doing a logical "&" prior
     1188    11280                                                     to comparison allows extra
     1189    11281                                                     bits to be turned on
     1190    11282                                                     following the bit value
     1191    11283                                                     of interest. For example
     1192    11284                                                     a (340000 & 300000)
     1193    11285                                                     would = 300000, which is
     1194    11286                                                     is equal to 300000.
     1195    11287                                                     (340000 & 300000) = 300000
     1196    11288                                                     */
     1197    11289    4               IF (ORR_UNMASK.MASK(IND) & OCL_HIST_BUF.ATTR)
     1198    11290    5                 = ORR_UNMASK.MASK(IND) THEN DO;
     1199    11291
     1200    11292                                                /* Find the kind of console that
     1201    11293                                                     is responsible for message
     1202    11294                                                     in OCL_HIST_BUF.                 */
     1203    11295
     1204    11296    5                  CALL INSERT( OUT_BUFFER, HERE, ORR_UNMASK.NM_CT(IND),
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:38   
     1205    11297    5                    ORR_UNMASK.NM(IND));   /* Place kind of console
     1206    11298                                                into output buffer                    */
     1207    11299
     1208    11300
     1209    11301    5                  HERE = HERE + ORR_UNMASK.NM_CT(IND); /* Increment buffer
     1210    11302                                                position counter.                     */
     1211    11303
     1212    11304    6                  IF ORR_UNMASK.WSN(IND) THEN DO;
     1213    11305
     1214    11306                                                /* Look for WSN associated with
     1215    11307                                                     console.                         */
     1216    11308
     1217    11309    6                     CALL INSERT ( OUT_BUFFER, HERE, , '@', OCL_HIST_BUF.WSN);
     1218    11310    6                     HERE = HERE + LENGTHC (OCL_HIST_BUF.WSN) + 1;
     1219    11311                                                /* Add 1 for '@'                      */
     1220    11312    6                  END;
     1221    11313
     1222    11314    6                  IF ORR_UNMASK.TERM(IND) THEN DO;
     1223    11315
     1224    11316                                                /* Look for terminal associated
     1225    11317                                                     with console.                    */
     1226    11318
     1227    11319    6                     CALL INSERT ( OUT_BUFFER, HERE, , '@', OCL_HIST_BUF.TERMINAL);
     1228    11320    6                     HERE = HERE + LENGTHC (OCL_HIST_BUF.TERMINAL) + 1;
     1229    11321    6                  END;
     1230    11322
     1231    11323                                                /* Add 1 for '@'                      */
     1232    11324    5               END;
     1233    11325    4            END;
     1234    11326    3            HERE = 19;
     1235    11327    3         END;                              /* END Prefix do                      */
     1236    11328    2         ELSE
     1237    11329    3         DO;
     1238    11330    3            HERE = 0;
     1239    11331    3         END;
     1240    11332
     1241    11333    2         CALL INSERT ( OUT_BUFFER,
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:39   
     1242    11334    2           HERE,
     1243    11335    2           OCM_BPOSN,
     1244    11336    2           OCM_BUFFER);
     1245    11337
     1246    11338                                                /* Formatted & translated message
     1247    11339                                                     is returned in OCM_BUFFER,
     1248    11340                                                     its length is in OCM_BPOSN.      */
     1249    11341
     1250    11342    2         WRITE_HIST_BUF_MESS.BUF_.BOUND =
     1251    11343    2           OCM_BPOSN + HERE - 1;
     1252    11344
     1253    11345                                                /* subtract 1 because bound
     1254    11346                                                     is zero relative.                */
     1255    11347
     1256    11348        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:40   
     1257    11349
     1258    11350         /*************************************/
     1259    11351         /*                                   */
     1260    11352         /*       Second type of message      */
     1261    11353         /*          -Output Direct-          */
     1262    11354         /*                                   */
     1263    11355         /*************************************/
     1264    11356
     1265    11357    2      CASE (1);
     1266    11358    2         CALL OCM$TPSET (LANGUAGE,
     1267    11359    2           SUBSTR (OCL_HIST_BUF.MESS, OCL_HIST_BUF.PROMPT_LENGTH, LENGTHC(OCL_HIST_BUF.
             11359                    MESS)-OCL_HIST_BUF.PROMPT_LENGTH))
     1268    11360    2           ALTRET (BAD_LANG);
     1269    11361
     1270    11362                                                /* This routine formats the
     1271    11363                                                     the specified language. It
     1272    11364                                                     places formatted messages in
     1273    11365                                                     OCM_BUFFER & its length in
     1274    11366                                                     OCM_BPOSN.                       */
     1275    11367
     1276    11368
     1277    11369    3         IF PREFIX THEN DO;
     1278    11370    3            CALL CONCAT ( OUT_BUFFER,
     1279    11371    3              'TO   ',
     1280    11372    3              OCL_HIST_BUF.DEVNM,
     1281    11373    3              '@',
     1282    11374    3              OCL_HIST_BUF.TERMINAL,
     1283    11375    3              ' ',
     1284    11376    3              OCM_BUFFER);
     1285    11377
     1286    11378    3            WRITE_HIST_BUF_MESS.BUF_.BOUND =
     1287    11379    3              OCM_BPOSN +
     1288    11380    3              LENGTHC ('TO   ') +
     1289    11381    3              LENGTHC (OCL_HIST_BUF.DEVNM) +
     1290    11382    3              LENGTHC ('@') +
     1291    11383    3              LENGTHC (OCL_HIST_BUF.TERMINAL) +
     1292    11384    3              LENGTHC (' ') -
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:41   
     1293    11385    3              1;
     1294    11386    3         END;
     1295    11387    2         ELSE
     1296    11388    3         DO;
     1297    11389    3            WRITE_HIST_BUF_MESS.BUF_.BOUND = OCM_BPOSN;
     1298    11390    3            OUT_BUFFER = ' ';
     1299    11391    3            CALL INSERT (OUT_BUFFER,0,OCM_BPOSN,OCM_BUFFER);
     1300    11392    3            WRITE_HIST_BUF_MESS.BUF_.BOUND = OCM_BPOSN;
     1301    11393    3         END;
     1302    11394        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:42   
     1303    11395
     1304    11396         /*************************************/
     1305    11397         /*                                   */
     1306    11398         /*       Third type of message       */
     1307    11399         /*              -Keyin-              */
     1308    11400         /*                                   */
     1309    11401         /*************************************/
     1310    11402
     1311    11403    2      CASE (2,3);                          /* KEYIN                              */
     1312    11404    2         OCM_BPOSN = DCBADDR (DCBNUM (F$HISTFILE)) -> F$DCB.ARS# -
     1313    11405    2           (LENGTHC (OCL_NORM_KEY.UTS) +
     1314    11406    2           LENGTHC (OCL_HIST_BUF.WSN) +
     1315    11407    2           LENGTHC (OCL_HIST_BUF.LOGON) +
     1316    11408    2           LENGTHC (OCL_HIST_BUF.DEVNM) +
     1317    11409    2           LENGTHC (OCL_HIST_BUF.STAT) +
     1318    11410    2           LENGTHC (OCL_HIST_BUF.TERMINAL) +
     1319    11411    2           LENGTHC (OCL_HIST_BUF.ATTR) +
     1320    11412    2           LENGTHC (OCL_HIST_BUF.TYPE) +
     1321    11413    2           LENGTHC (OCL_HIST_BUF.TEMPLATE) +
     1322    11414    2           LENGTHC (OCL_HIST_BUF.PROMPT_LENGTH));
     1323    11415
     1324    11416    3         IF PREFIX THEN DO;
     1325    11417    3            CALL CONCAT ( OUT_BUFFER,
     1326    11418    3              'FROM ',
     1327    11419    3              OCL_HIST_BUF.DEVNM,
     1328    11420    3              '@',
     1329    11421    3              OCL_HIST_BUF.TERMINAL,
     1330    11422    3              ' !',
     1331    11423    3              OCL_HIST_BUF.MESS);
     1332    11424
     1333    11425    3            WRITE_HIST_BUF_MESS.BUF_.BOUND =
     1334    11426    3              OCM_BPOSN +
     1335    11427    3              LENGTHC ('FROM ') +
     1336    11428    3              LENGTHC (OCL_HIST_BUF.DEVNM) +
     1337    11429    3              LENGTHC ('@') +
     1338    11430    3              LENGTHC (OCL_HIST_BUF.TERMINAL) +
     1339    11431    3              LENGTHC (' !') -
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:43   
     1340    11432    3              1;
     1341    11433    3         END;
     1342    11434    2         ELSE
     1343    11435    3         DO;
     1344    11436    3            WRITE_HIST_BUF_MESS.BUF_.BOUND = OCM_BPOSN;
     1345    11437    3            OUT_BUFFER = ' ';
     1346    11438    3            CALL INSERT (OUT_BUFFER,0,OCM_BPOSN,OCL_HIST_BUF.MESS);
     1347    11439    3         END;
     1348    11440
     1349    11441    2      END;                                 /* End case (ocl_hist_buf.type)       */
     1350    11442
     1351    11443    2      IF WILDCARDING THEN DO;
     1352    11444    2         XUW_WILDCARD.INPUT_.BOUND = WRITE_HIST_BUF_MESS.BUF_.BOUND;
     1353    11445    2         CALL X$WILDCMP (XUW_WILDCARD) ALTRET (WILD_ERR);
     1354    11446    2   WILD_ERR: /*N* This looks like a bug!!! */
     1355    11447    2         IF XUW_WILDCARD.ERROR.ERR# = %E$XUW#NOMATCH THEN GOTO DO_LIST;
     1356    11448    2         ELSE IF XUW_WILDCARD.ERROR.ERR# ~= %E$XUW#WILD_OK THEN GOTO BAD_WILD;
     1357    11449    2      END;
     1358    11450                                      /* Passing the above check signifies a match    */
     1359    11451    2      DO WHILE ('0'B);                     /* DO NEVER                           */
     1360    11452
     1361    11453    2   BAD_LANG: ;
     1362    11454    2         CALL OCM$TPSET (' ',
     1363    11455    2           SUBSTR (OCL_HIST_BUF.MESS, OCL_HIST_BUF.PROMPT_LENGTH,
     1364    11456    2           LENGTHC(OCL_HIST_BUF.MESS)-OCL_HIST_BUF.PROMPT_LENGTH))
     1365    11457    2           ALTRET (CANT_CALL_TPSET);
     1366    11458
     1367    11459                                                /* This routine formats the
     1368    11460                                                     records from :ochist in
     1369    11461                                                     the specified language. It
     1370    11462                                                     places a formatted message in
     1371    11463                                                     OCM_BUFFER & a length in
     1372    11464                                                     OCM_BPOSN.                       */
     1373    11465
     1374    11466    2      END;
     1375    11467
     1376    11468    2      DO WHILE ('0'B);                     /* DO NEVER                           */
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:44   
     1377    11469    2   CANT_CALL_TPSET:;
     1378    11470    2         OUT_MSG.BUF_.BOUND = 40;
     1379    11471    2         MSG = '            Cant find template message';
     1380    11472    2         CALL M$WRITE (OUT_MSG);
     1381    11473    2         ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1382    11474    2         CALL M$ERRMSG (ERR_FIND_TEMP);
     1383    11475    2         GOTO DO_LIST;
     1384    11476    2      END;
     1385    11477
     1386    11478        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:45   
     1387    11479
     1388    11480    1      PRINT_FLAG = %YES#;
     1389    11481
     1390    11482                                                /* Logic fell through meaning
     1391    11483                                                     that output was found for
     1392    11484                                                     current selection criteria.      */
     1393    11485
     1394    11486
     1395    11487    1      CALL XUD$UTS_ADJUST (TEMP_UTS, PRINTED_TIME, %UTS_CSEC_MIN#);
     1396    11488    1      IF PRINTED_TIME = 0
     1397    11489    2        OR OCL_NORM_KEY.UTS > TEMP_UTS THEN DO;
     1398    11490
     1399    11491                                                /* Print time if it is before first
     1400    11492                                                     output line, or if a minute
     1401    11493                                                     has expired (using present
     1402    11494                                                     records UTS) since the last
     1403    11495                                                     simulated print time.            */
     1404    11496
     1405    11497    2         CALL M$TIME (TIME_SIMULATION) ALTRET (CANT_CALL_TIME_SIM);
     1406    11498
     1407    11499                                                /* Convert OCL_NORM_KEY.UTS
     1408    11500                                                     to "local" time format.          */
     1409    11501
     1410    11502    2         WRITE_TIME.BUF_.BOUND = 20 + LENGTHC(SIM_DATE) + LENGTHC (SIM_TIME) - 7;
     1411    11503
     1412    11504    2         TIME_BUFFER = ' ';
     1413    11505
     1414    11506    2         CALL INSERT (TIME_BUFFER, 19, 14, SUBSTR (SIM_TIME, 0, 5), ' ', SIM_DATE);
     1415    11507
     1416    11508                                                /* Place new simulated time in
     1417    11509                                                     buffer.                          */
     1418    11510
     1419    11511    2         CALL M$WRITE (WRITE_TIME) ALTRET (CANT_WRITE_TIME);
     1420    11512
     1421    11513                                                /* Write new simulated time.          */
     1422    11514
     1423    11515    2         TO_UTS_DATE = SIM_DATE;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:46   
     1424    11516    2         CALL CONCAT (TO_UTS_TIME, SUBSTR(SIM_TIME,0,5), ':00.00');
     1425    11517
     1426    11518                                                /* Printed times are on the
     1427    11519                                                     minute, so zero out
     1428    11520                                                     simulated time's seconds
     1429    11521                                                     and centiseconds.                */
     1430    11522
     1431    11523    2         CALL M$TIME (TIME_TO_UTS) ALTRET (CANT_CALL_TIME_UTS);
     1432    11524
     1433    11525                                                /* Place new simulated time in
     1434    11526                                                     hold area "PRINTED_TIME".        */
     1435    11527
     1436    11528    2      END;
     1437    11529
     1438    11530    1      CALL M$WRITE (WRITE_HIST_BUF_MESS) ALTRET (CANT_WRITE);
     1439    11531
     1440    11532                                                /* This statement writes the
     1441    11533                                                     actual formatted message
     1442    11534                                                     along with destination or
     1443    11535                                                     origin to console.               */
     1444    11536
     1445    11537    1      GOTO DO_LIST;
     1446    11538
     1447    11539                                                /* Return to Do_list loop for
     1448    11540                                                     next record.                     */
     1449    11541
     1450    11542
     1451    11543
     1452    11544        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:47   
     1453    11545    1   CHECK_END:;
     1454    11546    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1455    11547
     1456    11548    2      IF (ERROR.ERR# ~= %E$EOF) AND (ERROR.ERR# ~= %E$NOKEY) THEN DO;
     1457    11549         /*E* ERROR: ORR-E_READERR#-0
     1458    11550                       MESSAGE: Error reading :ochist file
     1459    11551                                      */
     1460    11552    2         MODULE_ERR.ERR# = 13 /* E_READERR# */;
     1461    11553    2         MODULE_ERR.SEV = 0;
     1462    11554    2         CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     1463    11555    2         ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1464    11556    2         CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));
     1465    11557    2         CALL ORR$BRKRTN;
     1466    11558    2      END;
     1467    11559    1      ELSE
     1468    11560    2   REPORT_END_POINT: DO;
     1469    11561    2         CALL CLOSE_UP;
     1470    11562    2         IF KEEP_ON_LISTING THEN GOTO DO_LIST;
     1471    11563    2      END;
     1472    11564
     1473    11565    1      IF CONSOLE_REPORT AND CINDEX > 0 THEN CALL DISPLAY_CONSOLES;
     1474    11566
     1475    11567    1      IF LOGON_REPORT THEN CALL DISPLAY_LOGONS;
     1476    11568
     1477    11569    2      IF NOT PRINT_FLAG THEN DO;
     1478    11570
     1479    11571                                                /* If no messages were found for
     1480    11572                                                     the current selection criteria
     1481    11573                                                     print a message.                 */
     1482    11574
     1483    11575         /*E* ERROR: ORR-E_NORECERR#-0
     1484    11576              MESSAGE: No records found using the current selection criteria.
     1485    11577                                           */
     1486    11578    2         MODULE_ERR.ERR# = 14 /* E_NORECERR# */;
     1487    11579    2         MODULE_ERR.SEV = 0;
     1488    11580    2         CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     1489    11581    2      END;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:48   
     1490    11582
     1491    11583
     1492    11584    1      CALL M$CLOSE (CLOSE_OCMSG) ALTRET (CANT_CLOSE_OCMSG);
     1493    11585
     1494    11586                                                /* Close template file.               */
     1495    11587
     1496    11588    1      CALL M$CLOSE (CLOSE_LO) ALTRET (CANT_CLOSE_LO);
     1497    11589
     1498    11590    1      GOTO INITIALIZE;
     1499    11591
     1500    11592        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:49   
     1501    11593    1   CANT_WRITE:;
     1502    11594        /*E* ERROR: ORR-E_WRTERR#-7
     1503    11595             MESSAGE: An error took place on a call to M$WRITE
     1504    11596                                 */
     1505    11597    1      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     1506    11598    1      MODULE_ERR.ERR# = 1 /* E_WRTERR# */;
     1507    11599    1      MODULE_ERR.SEV = 0;
     1508    11600    1      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
     1509    11601    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1510    11602    1      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
     1511    11603    1      CALL ORR$XCONRTN;
     1512    11604
     1513    11605    1   CANT_SET_ERRFID:;
     1514    11606        /*E* ERROR: ORR-E_SETFID#-7
     1515    11607             MESSAGE: An error was encountered on a call to
     1516    11608                      XUR$SETERRMSG with textc field "err_msg_fid".
     1517    11609                                 */
     1518    11610    1      MODULE_ERR.ERR# = 4 /* E_SETFID# */;
     1519    11611    1      MODULE_ERR.SEV = 0;
     1520    11612    1      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     1521    11613    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1522    11614    1      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));
     1523    11615    1      CALL ORR$XCONRTN;
     1524    11616
     1525    11617    1   CANT_CALL_INT:;
     1526    11618        /*E* ERROR: ORR-E_CALLINT#-7
     1527    11619             MESSAGE: Error on call to M$INT
     1528    11620                                 */
     1529    11621    1      MODULE_ERR.ERR# = 6 /* E_CALLINT# */;
     1530    11622    1      MODULE_ERR.SEV = 0;
     1531    11623    1      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     1532    11624    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1533    11625    1      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));
     1534    11626    1      CALL ORR$XCONRTN;
     1535    11627
     1536    11628    1   CANT_CALL_XUR_ERRMSG:;
     1537    11629        /*E* ERROR: ORR-E_CALLXUR_ERRMSG#-7
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:50   
     1538    11630             MESSAGE: Error at call to XUR$ERRMSG on syntax error cond.
     1539    11631                                 */
     1540    11632    1      MODULE_ERR.ERR# = 8 /* E_CALLXUR_ERRMSG# */;
     1541    11633    1      MODULE_ERR.SEV = 0;
     1542    11634    1      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     1543    11635    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1544    11636    1      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));
     1545    11637    1      CALL ORR$XCONRTN;
     1546    11638
     1547    11639    1   CANT_CALL_TIME_SIM:;
     1548    11640        /*E* ERROR: ORR-E_CALLTIMESIM#-7
     1549    11641             MESSAGE: Altret condition occurred on call to M$TIME
     1550    11642             The call was to convert UTS to LOCAL.
     1551    11643                                 */
     1552    11644    1      MODULE_ERR.ERR# = 10 /* E_CALLTIMESIM# */;
     1553    11645    1      MODULE_ERR.SEV = 0;
     1554    11646    1      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     1555    11647    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1556    11648    1      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));
     1557    11649    1      CALL ORR$XCONRTN;
     1558    11650
     1559    11651    1   CANT_CALL_TIME_UTS:;
     1560    11652        /*E* ERROR: ORR-E_CALLTIMEUTS#-7
     1561    11653             MESSAGE: Altret condition occurred on call to M$TIME
     1562    11654             The call was to convert LOCAL to UTS.
     1563    11655                                 */
     1564    11656    1      MODULE_ERR.ERR# = 11 /* E_CALLTIMEUTS# */;
     1565    11657    1      MODULE_ERR.SEV = 0;
     1566    11658    1      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     1567    11659    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1568    11660    1      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));
     1569    11661    1      CALL ORR$XCONRTN;
     1570    11662
     1571    11663    1   CANT_WRITE_TIME:;
     1572    11664        /*E* ERROR: ORR-E_WRTTIME#-7
     1573    11665             MESSAGE: Altret condition occurred on call to M$WRITE
     1574    11666             The call was to write an estimated console time.
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:51   
     1575    11667                                 */
     1576    11668    1      MODULE_ERR.ERR# = 12 /* E_WRTTIME# */;
     1577    11669    1      MODULE_ERR.SEV = 0;
     1578    11670    1      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     1579    11671    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1580    11672    1      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));
     1581    11673    1      CALL ORR$XCONRTN;
     1582    11674
     1583    11675    1   CANT_OPEN_OCMSG:;
     1584    11676        /*E* ERROR: ORR-E_OPENMSG#-7
     1585    11677             MESSAGE: Error at attempt to open :OCMSG file
     1586    11678                                 */
     1587    11679    1      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     1588    11680    1      MODULE_ERR.ERR# = 3 /* E_OPENMSG# */;
     1589    11681    1      MODULE_ERR.SEV = 0;
     1590    11682    1      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
     1591    11683    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1592    11684    1      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
     1593    11685    1      CALL ORR$XCONRTN;
     1594    11686
     1595    11687    1   CANT_CALL_XCON:;
     1596    11688        /*E* ERROR: ORR-E_XCONERR#-7
     1597    11689             MESSAGE: Error on attempt to call M$XCON
     1598    11690                                 */
     1599    11691    1      MODULE_ERR.ERR# = 23 /* E_XCONERR */;
     1600    11692    1      MODULE_ERR.SEV = 0;
     1601    11693    1      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     1602    11694    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1603    11695    1      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));
     1604    11696    1      CALL ORR$XCONRTN;
     1605    11697
     1606    11698
     1607    11699    1   CANT_OPEN_LO:;
     1608    11700        /*E* ERROR: ORR-E_OPENLO#-7
     1609    11701             MESSAGE: Error on attempt to open M$LO
     1610    11702                                 */
     1611    11703    1      MODULE_ERR.ERR# = 24 /* E_OPENLO# */;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:52   
     1612    11704    1      MODULE_ERR.SEV = 0;
     1613    11705    1      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     1614    11706    1      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
     1615    11707    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1616    11708    1      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
     1617    11709    1      CALL ORR$XCONRTN;
     1618    11710
     1619    11711    1   CANT_PRECORD:;
     1620    11712        /*E* ERROR: ORR-E_PRECERR#-7
     1621    11713             MESSAGE: Error on attempt to call M$PRECORD
     1622    11714                                 */
     1623    11715    1      MODULE_ERR.ERR# = 25 /* E_PRECERR# */;
     1624    11716    1      MODULE_ERR.SEV = 0;
     1625    11717    1      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     1626    11718    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1627    11719    1      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));
     1628    11720    1      CALL ORR$XCONRTN;
     1629    11721
     1630    11722    1   CANT_CLOSE_OCMSG:;
     1631    11723        /*E* ERROR: ORR-E_OCMSG#-7
     1632    11724             MESSAGE: Error on attempt to close :OCMSG
     1633    11725                                 */
     1634    11726    1      MODULE_ERR.ERR# = 26 /* E_OCMSG# */;
     1635    11727    1      MODULE_ERR.SEV = 0;
     1636    11728    1      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     1637    11729    1      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
     1638    11730    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1639    11731    1      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
     1640    11732    1      CALL ORR$XCONRTN;
     1641    11733
     1642    11734    1   CANT_CLOSE_LO:;
     1643    11735        /*E* ERROR: ORR-E_CLOSELO#-7
     1644    11736             MESSAGE: Error on attempt to close M$LO
     1645    11737                                 */
     1646    11738    1      MODULE_ERR.ERR# = 27 /* E_CLOSELO# */;
     1647    11739    1      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     1648    11740    1      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:53   
     1649    11741    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1650    11742    1      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
     1651    11743    1      CALL ORR$XCONRTN;
     1652    11744
     1653    11745    1   NO_SEGS: ;
     1654    11746        /*E* ERROR: ORR-E_NOSEGS#-7
     1655    11747             MESSAGE: Error on attempt to allocate segments
     1656    11748                                 */
     1657    11749    1      MODULE_ERR.ERR# = 36 /* E_NOSEGS# */;
     1658    11750    1      MODULE_ERR.SEV = 0;
     1659    11751    1      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     1660    11752    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1661    11753    1      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));
     1662    11754    1      CALL ORR$XCONRTN;
     1663    11755
     1664    11756    1   FILE_TROUBLE:;
     1665    11757        /*E* ERROR: ORR-E_NOFILE#-7
     1666    11758             MESSAGE: Unable to open necessary file
     1667    11759                                 */
     1668    11760    1      DCB# = B$TCB$->B$TCB.ALT$->B$ALT.DCB#;
     1669    11761    1      MODULE_ERR.ERR# = 37 /* E_NOFILE# */;
     1670    11762    1      MODULE_ERR.SEV = 0;
     1671    11763    1      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
     1672    11764    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1673    11765    1      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
     1674    11766    1      ERROR.ERR# = 0;
     1675    11767    1      CALL ORR$BRKRTN;
     1676    11768    1   BAD_WILD:;
     1677    11769        /*E* ERROR: ORR-E_BADWILD#-7
     1678    11770             MESSAGE: Unable to process this wildcard pattern
     1679    11771                                 */
     1680    11772    1      MODULE_ERR.ERR# = 42 /* E_BADWILD# */;
     1681    11773    1      MODULE_ERR.SEV = 0;
     1682    11774    1      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     1683    11775    1      GOTO INITIALIZE;
     1684    11776    1   CLOSE_OUT:;
     1685    11777    1      CALL M$XCON (RESET_XCON);
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:54   
     1686    11778    1      CALL M$EXIT;
     1687    11779        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:55   
     1688    11780         /*
     1689    11781                  S U B R O U T I N E   S E T _ D E F A U L T S
     1690    11782                                                */
     1691    11783
     1692    11784    1   SET_DEFAULTS: PROC;
     1693    11785    2      IF B$JIT$ -> B$JIT.PRFLAGS.SI
     1694    11786
     1695    11787                                                /* Do if a specific file was
     1696    11788                                                     entered in command line
     1697    11789                                                     in M$SI (default) DCB.           */
     1698    11790
     1699    11791    2      THEN A_SPECIFIC_FILE = %YES#;
     1700    11792    3      ELSE DO;
     1701    11793
     1702    11794                                                /* Else, the search for defaults
     1703    11795                                                     will begin in :OCHIST.           */
     1704    11796
     1705    11797    3   NO_INFO:
     1706    11798    3         FID_NAME.NAME# = ':OCHIST';
     1707    11799    3         FID_NAME.L# = SIZEC (':OCHIST');
     1708    11800    3         A_SPECIFIC_FILE = %NO#;
     1709    11801    3      END;
     1710    11802
     1711    11803    2      CALL OPEN_SPECIFIC_FILE;
     1712    11804    3      IF NO_FILE THEN DO;
     1713    11805    3         NO_FILE = %NO#;
     1714    11806    3         GOTO FILE_TROUBLE;
     1715    11807    3      END;
     1716    11808
     1717    11809    2      OCL_NORM_KEY.COUNT = 4;
     1718    11810    2      OCL_NORM_KEY.UTS = 15000;
     1719    11811    2      HIST_POSITION.V.N# = 0;
     1720    11812    3      CALL M$PRECORD (HIST_POSITION) WHENALTRETURN DO; END;
     1721    11813
     1722    11814    2      READ_HISTORYE.V.KEYS# = %YES#;
     1723    11815
     1724    11816    2      CALL M$READ (READ_HISTORYE) ALTRET (CANT_READ_HIST);
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:56   
     1725    11817    2      BEGINNING_TIME = OCL_NORM_KEY.UTS;
     1726    11818
     1727    11819                                                /* Set default beginning time
     1728    11820                                                     to UTS of first history
     1729    11821                                                     record in current history
     1730    11822                                                     file (usually :OCHIST).          */
     1731    11823
     1732    11824    2      CALL M$PFIL (POSITION_AT_END) ALTRET (BROKEN_FILE_PLACE);
     1733    11825    2      FIRST_HIST_REC.V.N# = -1;
     1734    11826    2      CALL M$PRECORD (FIRST_HIST_REC) ALTRET (CANT_PRECORD);
     1735    11827    2      READ_HISTORYE.V.KEYS# = %NO#;
     1736    11828    2      CALL M$READ (READ_HISTORYE) ALTRET (CANT_READ_HIST);
     1737    11829    2      ENDING_TIME = OCL_NORM_KEY.UTS;
     1738    11830    2      READ_HISTORYE.V.KEYS# = %YES#;
     1739    11831
     1740    11832                                                /* Set default ending time
     1741    11833                                                   to UTS of first history
     1742    11834                                                   record in current history
     1743    11835                                                   file (usually :OCHIST).            */
     1744    11836
     1745    11837    3      DO WHILE ('0'B);
     1746    11838    3   BROKEN_FILE_PLACE:
     1747    11839    3         BROKEN_FILE = %YES#;
     1748    11840    3         ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1749    11841    3         ENDING_TIME_REDEF = '777773220400'O; /* MIDNIGHT BEFORE ROLLOVER        */
     1750    11842    3      END;
     1751    11843
     1752    11844
     1753    11845    2      CALL CLOSE_SPECIFIC_FILE;
     1754    11846
     1755    11847
     1756    11848                                                /* Set other defaults.                */
     1757    11849
     1758    11850    2      TIME_SET.TSTAMP_ =VECTOR (BEGINNING_TIME);
     1759    11851    2      CALL M$TIME (TIME_SET) ALTRET (CANT_CALL_TIME);
     1760    11852
     1761    11853    3      IF NOT OPERATOR_ENTERED_TIME1 THEN DO;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:57   
     1762    11854    3         HOUR1 = TIME_BUF(0);
     1763    11855    3         MIN1 = TIME_BUF(1);
     1764    11856    3         SEC1 = TIME_BUF(2);
     1765    11857    3         CENTISEC1 = TIME_BUF(3);
     1766    11858    3      END;
     1767    11859
     1768    11860    3      IF NOT OPERATOR_ENTERED_DATE1 THEN DO;
     1769    11861    3         YEAR1 = DATE_BUF(0);
     1770    11862    3         MONTH1 = DATE_BUF(1);
     1771    11863    3         DAY1 = DATE_BUF(2);
     1772    11864    3      END;
     1773    11865
     1774    11866                                                /* Store beginning time in
     1775    11867                                                     character format, so
     1776    11868                                                     individual time parts can
     1777    11869                                                     be overridden with entries
     1778    11870                                                     from parse blocks.               */
     1779    11871
     1780    11872
     1781    11873    2      TIME_SET.TSTAMP_ = VECTOR (ENDING_TIME);
     1782    11874    2      CALL M$TIME (TIME_SET) ALTRET (CANT_CALL_TIME);
     1783    11875
     1784    11876    3      IF NOT OPERATOR_ENTERED_TIME2 THEN DO;
     1785    11877    3         HOUR2 = TIME_BUF(0);
     1786    11878    3         MIN2 = TIME_BUF(1);
     1787    11879    3         SEC2 = TIME_BUF(2);
     1788    11880    3         CENTISEC2 = TIME_BUF(3);
     1789    11881    3      END;
     1790    11882
     1791    11883    3      IF NOT OPERATOR_ENTERED_DATE2 THEN DO;
     1792    11884    3         YEAR2 = DATE_BUF(0);
     1793    11885    3         MONTH2 = DATE_BUF(1);
     1794    11886    3         DAY2 = DATE_BUF(2);
     1795    11887    3      END;
     1796    11888
     1797    11889
     1798    11890                                                /* Store ending time in
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:58   
     1799    11891                                                     character format, so
     1800    11892                                                     individual time parts can
     1801    11893                                                     be overridden with entries
     1802    11894                                                     from parse blocks.               */
     1803    11895
     1804    11896
     1805    11897    2      IF OPERATOR_ENTERED_TIME1
     1806    11898    3        AND NOT OPERATOR_ENTERED_DATE1 THEN DO;
     1807    11899
     1808    11900                                                /*   "SPAN 10:00-11:00"
     1809    11901                                                  or "SPAN 10:00-11:00,1/1/83"
     1810    11902                                        Force the same date as the end of the range,
     1811    11903                                        whatever that might have been.                */
     1812    11904
     1813    11905    3         YEAR1 = YEAR2;
     1814    11906    3         MONTH1 = MONTH2;
     1815    11907    3         DAY1 = DAY2;
     1816    11908    3      END;
     1817    11909
     1818    11910    3      IF BROKEN_FILE THEN DO;
     1819    11911    3         BROKEN_FILE = %NO#;
     1820    11912    3         GOTO CANT_POSITION_AT_END;
     1821    11913    3      END;
     1822    11914    2      RETURN;
     1823    11915
     1824    11916    2   CANT_READ_HIST:;
     1825    11917        /*E* ERROR: ORR-E_HSTREAD#-7
     1826    11918             MESSAGE: REPLAY cannot read the history file
     1827    11919                          -- :OCHIST may not exist --
     1828    11920                                 */
     1829    11921    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     1830    11922    2      MODULE_ERR.ERR# = 20 /* E_HSTREAD# */;
     1831    11923    2      MODULE_ERR.SEV = 0;
     1832    11924    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
     1833    11925    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1834    11926    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
     1835    11927    2      CALL ORR$XCONRTN;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:59   
     1836    11928
     1837    11929    2   CANT_POSITION_AT_END:;
     1838    11930        /*E* ERROR: ORR-E_POSERR#-7
     1839    11931             MESSAGE: WARNING: Default history file is broken
     1840    11932                                 */
     1841    11933    2      MODULE_ERR.ERR# = 21 /* E_POSERR# */;
     1842    11934    2      MODULE_ERR.SEV = 0;
     1843    11935    2      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     1844    11936    2      RETURN;
     1845    11937
     1846    11938    2   CANT_CALL_TIME:;
     1847    11939        /*E* ERROR: ORR-E_CALLTIME#-7
     1848    11940             MESSAGE: Altret on call to M$TIME in subroutine SET_DEFAULTS
     1849    11941                                 */
     1850    11942    2      MODULE_ERR.ERR# = 22 /* E_CALLTIME# */;
     1851    11943    2      MODULE_ERR.SEV = 0;
     1852    11944    2      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     1853    11945    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1854    11946    2      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));
     1855    11947    2      CALL ORR$XCONRTN;
     1856    11948
     1857    11949    2   CANT_READ_STATUS:;
     1858    11950        /*E* ERROR: ORR-E_READSTATERR#-7
     1859    11951             MESSAGE: Altret on attempt to read status record
     1860    11952                                 */
     1861    11953    2      MODULE_ERR.ERR# = 28 /* E_READSTATERR# */;
     1862    11954    2      MODULE_ERR.SEV = 0;
     1863    11955    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     1864    11956    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
     1865    11957    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1866    11958    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
     1867    11959    2      CALL ORR$XCONRTN;
     1868    11960
     1869    11961    2   CANT_PRECORD:;
     1870    11962    2      MODULE_ERR.ERR# = 25 /* E_PRECERR# */;
     1871    11963    2      MODULE_ERR.SEV = 0;
     1872    11964    2      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:60   
     1873    11965    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1874    11966    2      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));
     1875    11967    2      CALL ORR$XCONRTN;
     1876    11968
     1877    11969    2   FILE_TROUBLE:;
     1878    11970        /*E* ERROR: ORR-E_CANTOPEN#-7
     1879    11971             MESSAGE: Cannot open the right file in order
     1880    11972                            to set proper defaults
     1881    11973                                 */
     1882    11974    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     1883    11975    2      MODULE_ERR.ERR# = 38 /* E_CANTOPEN# */;
     1884    11976    2      MODULE_ERR.SEV = 0;
     1885    11977    2      CALL XUR$ERRMSG (MODULE_ERR, DCB#, DCBNUM(M$LO));
     1886    11978    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1887    11979    2      CALL XUR$ERRMSG (ERROR, DCB#, DCBNUM(M$LO));
     1888    11980    2      ERROR.ERR# = 0;
     1889    11981    2      CALL ORR$BRKRTN;
     1890    11982
     1891    11983    2   END SET_DEFAULTS;
     1892    11984        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:61   
     1893    11985         /*
     1894    11986                  S U B R O U T I N E   O P E N _ S P E C I F I C _ F I L E
     1895    11987                                                */
     1896    11988
     1897    11989    1   OPEN_SPECIFIC_FILE: PROC;
     1898    11990    3      IF A_SPECIFIC_FILE THEN DO;
     1899    11991    3         FID_NAME = DCBADDR (DCBNUM (M$SI)) -> F$DCB.NAME#;
     1900    11992
     1901    11993    3         IF DCBADDR (DCBNUM (M$SI)) -> F$DCB.ACCT# ~= ' '
     1902    11994    3         THEN SYS.ACCT# = DCBADDR (DCBNUM (M$SI)) -> F$DCB.ACCT#;
     1903    11995
     1904    11996    3         IF DCBADDR (DCBNUM (M$SI)) -> F$DCB.PASS# ~= ' '
     1905    11997    3         THEN OPEN_HISTORYE.PASS_ = VECTOR (DCBADDR (DCBNUM (M$SI)) -> F$DCB.PASS#);
     1906    11998
     1907    11999    3         IF DCBADDR (DCBNUM (M$SI)) -> F$DCB.PSN# ~= ' '
     1908    12000    3         THEN OPEN_HISTORYE.SN_ = VECTOR (DCBADDR (DCBNUM (M$SI)) -> F$DCB.PSN#);
     1909    12001
     1910    12002                                                /* Turn specific file flag off so
     1911    12003                                                   OPEN_TO_RANGE won't loop when
     1912    12004                                                   it follows the backward chain.     */
     1913    12005
     1914    12006    3         A_SPECIFIC_FILE = %NO#;
     1915    12007    3      END;
     1916    12008
     1917    12009                                                /* If a specific file was entered
     1918    12010                                                     on the command line, check if
     1919    12011                                                     information pertaining to the
     1920    12012                                                     file was also entered on the
     1921    12013                                                     command line.                    */
     1922    12014
     1923    12015    3      IF FID_NAME.NAME# = ':OCHIST' THEN DO;
     1924    12016    4         DO INHIBIT;
     1925    12017    4            CALL XUR$DISABLE;
     1926    12018    4            OR_OK_TO_BREAK = %NO#;
     1927    12019    4            CALL M$OPEN (CS_OPEN) ALTRET (CANT_OPEN_CS);
     1928    12020    4            OR_MESSBUF.FCN = 9 /* Open :OCHIST shared */;
     1929    12021    4            OCHIST_FLAG = %YES#;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:62   
     1930    12022    4            CALL M$WRITE (WRITE_CS) ALTRET (CANT_WRITE_CS);
     1931    12023    4            CALL M$CLOSE (CS_CLOSE) ALTRET (CANT_CLOSE_CS);
     1932    12024    4            OR_OK_TO_BREAK = %YES#;
     1933    12025    4            CALL XUR$ENABLE;
     1934    12026    4            IF OR_XCON_FLAG THEN CALL ORR$XCONRTN;
     1935    12027    4            IF OR_BRK_FLAG THEN CALL ORR$BRKRTN;
     1936    12028    4         END;
     1937    12029
     1938    12030                                                /* If the file to be opened is
     1939    12031                                                     :OCHIST, call keyin to open
     1940    12032                                                     the file SHARE=IN.               */
     1941    12033
     1942    12034    4         CALL M$OPEN (OPEN_HISTORYE) WHENALTRETURN DO;
     1943    12035    4   TRY2:
     1944    12036                                                /* In case event wasn't processed
     1945    12037                                                     by keyin yet.                    */
     1946    12038
     1947    12039    4            WAIT_TIMES# = WAIT_TIMES# + 1;
     1948    12040    4            IF WAIT_TIMES# > 25 THEN GOTO CANT_OPEN_HIST;
     1949    12041    5            ELSE DO;
     1950    12042    5               CALL M$WAIT (WAIT_HIST);
     1951    12043    5               CALL M$OPEN (OPEN_HISTORYE) ALTRET (TRY2);
     1952    12044    5               WAIT_TIMES# = 0;
     1953    12045    5            END;
     1954    12046    4         END;
     1955    12047    3      END;
     1956    12048    3      ELSE DO;
     1957    12049
     1958    12050                                                /* If FID_NAME.NAME# ~= :OCHIST
     1959    12051                                                     then check to see if we
     1960    12052                                                     have a valid file name.          */
     1961    12053
     1962    12054    3         IF FID_NAME.L# = 0
     1963    12055    3           OR
     1964    12056    3           FID_NAME.L# > 31
     1965    12057    3         THEN
     1966    12058    4         DO;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:63   
     1967    12059        /*E* ERROR: ORR-E_BRKCHN#-7
     1968    12060             MESSAGE: Warning: Replay cannot accomodate the entire time range
     1969    12061                          because the history file chain has been broken.
     1970    12062                                 */
     1971    12063    4            DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     1972    12064    4            MODULE_ERR.ERR# = 43 /* E_BRKCHN# */;
     1973    12065    4            MODULE_ERR.SEV = 0;
     1974    12066    4            CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
     1975    12067    4            NO_FILE = %YES#;
     1976    12068    4            RETURN;
     1977    12069    4         END;
     1978    12070    3         ELSE
     1979    12071    3         CALL M$OPEN (OPEN_HISTORYE) WHENALTRETURN
     1980    12072    4         DO;
     1981    12073        /*E* ERROR: ORR-E_NOPAST#-7
     1982    12074             MESSAGE: Warning: Replay cannot accomodate the entire time range
     1983    12075                          because some history file(s) cannot be opened
     1984    12076                                 */
     1985    12077    4            DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     1986    12078    4            MODULE_ERR.ERR# = 39 /* E_NOPAST# */;
     1987    12079    4            MODULE_ERR.SEV = 0;
     1988    12080    4            CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
     1989    12081    4            ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1990    12082    4            CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
     1991    12083    4            NO_FILE = %YES#;
     1992    12084    4            RETURN;
     1993    12085    4         END;
     1994    12086    3      END;
     1995    12087    2      RETURN;
     1996    12088
     1997    12089    2   CANT_OPEN_CS:;
     1998    12090        /*E* ERROR: ORR-E_OPENCS#-7
     1999    12091             MESSAGE: Altret taken when trying to open CSCG
     2000    12092                                 */
     2001    12093    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     2002    12094    2      MODULE_ERR.ERR# = 17 /* E_OPENCS# */;
     2003    12095    2      MODULE_ERR.SEV = 0;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:64   
     2004    12096    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
     2005    12097    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     2006    12098    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
     2007    12099    2      CALL ORR$XCONRTN;
     2008    12100
     2009    12101    2   CANT_WRITE_CS:;
     2010    12102        /*E* ERROR: ORR-E_WRTCS#-7
     2011    12103             MESSAGE: Altret occurred on write to CSCG
     2012    12104                                 */
     2013    12105    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     2014    12106    2      MODULE_ERR.ERR# = 18 /* E_WRTCS# */;
     2015    12107    2      MODULE_ERR.SEV = 0;
     2016    12108    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
     2017    12109    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     2018    12110    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
     2019    12111    2      CALL ORR$XCONRTN;
     2020    12112
     2021    12113    2   CANT_OPEN_HIST:;
     2022    12114        /*E* ERROR: ORR-E_OPENHIST#-7
     2023    12115             MESSAGE: Error at attempt to open current :OCHIST file
     2024    12116                                 */
     2025    12117    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     2026    12118    2      MODULE_ERR.ERR# = 2 /* E_OPENHIST# */;
     2027    12119    2      MODULE_ERR.SEV = 0;
     2028    12120    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
     2029    12121    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     2030    12122    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
     2031    12123    2      ERROR.ERR# = 0;
     2032    12124    2      CALL ORR$BRKRTN;
     2033    12125
     2034    12126    2   CANT_CLOSE_CS:;
     2035    12127        /*E* ERROR: ORR-E_CLOSECS#-7
     2036    12128             MESSAGE: Altret on attempt to close CSCG
     2037    12129                                 */
     2038    12130    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     2039    12131    2      MODULE_ERR.ERR# = 32 /* E_CLOSECS# */;
     2040    12132    2      MODULE_ERR.SEV = 0;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:65   
     2041    12133    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
     2042    12134    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     2043    12135    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
     2044    12136    2      CALL ORR$XCONRTN;
     2045    12137
     2046    12138
     2047    12139    2   END OPEN_SPECIFIC_FILE;
     2048    12140        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:66   
     2049    12141         /*
     2050    12142                  S U B R O U T I N E   C L O S E _ S P E C I F I C _ F I L E
     2051    12143                                                */
     2052    12144
     2053    12145    1   CLOSE_SPECIFIC_FILE: PROC;
     2054    12146    2      CALL M$CLOSE (CLOSE_HISTORYE) ALTRET (CANT_CLOSE_HISTORY);
     2055    12147
     2056    12148                                                /* Close history file.                */
     2057    12149
     2058    12150    3      IF FID_NAME.NAME# = ':OCHIST' THEN DO;
     2059    12151    4         DO INHIBIT;
     2060    12152    4            CALL XUR$DISABLE;
     2061    12153    4            OR_OK_TO_BREAK = %NO#;
     2062    12154    4            CALL M$OPEN (CS_OPEN) ALTRET (CANT_OPEN_CS);
     2063    12155    4            OR_MESSBUF.FCN = 10 /* Open :OCHIST exclusive */;
     2064    12156    4            CALL M$WRITE (WRITE_CS) ALTRET (CANT_WRITE_CS);
     2065    12157    4            OCHIST_FLAG = %NO#;
     2066    12158    4            CALL M$CLOSE (CS_CLOSE) ALTRET (CANT_CLOSE_CS);
     2067    12159    4            OR_OK_TO_BREAK = %YES#;
     2068    12160    4            CALL XUR$ENABLE;
     2069    12161    4            IF OR_XCON_FLAG THEN CALL ORR$BRKRTN;
     2070    12162    4            IF OR_BRK_FLAG THEN CALL ORR$XCONRTN;
     2071    12163    4         END;
     2072    12164    3      END;
     2073    12165
     2074    12166                                                /* If file was :OCHIST, then
     2075    12167                                                     call keyin to re-open
     2076    12168                                                     the file SHARE=NONE.             */
     2077    12169
     2078    12170    2      RETURN;
     2079    12171
     2080    12172
     2081    12173    2   CANT_OPEN_CS:;
     2082    12174    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     2083    12175    2      MODULE_ERR.ERR# = 17 /* E_OPENCS# */;
     2084    12176    2      MODULE_ERR.SEV = 0;
     2085    12177    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:67   
     2086    12178    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     2087    12179    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
     2088    12180    2      CALL ORR$XCONRTN;
     2089    12181
     2090    12182    2   CANT_WRITE_CS:;
     2091    12183    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     2092    12184    2      MODULE_ERR.ERR# = 18 /* E_WRTCS# */;
     2093    12185    2      MODULE_ERR.SEV = 0;
     2094    12186    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
     2095    12187    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     2096    12188    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
     2097    12189    2      CALL ORR$XCONRTN;
     2098    12190
     2099    12191    2   CANT_CLOSE_HISTORY:;
     2100    12192        /*E* ERROR: ORR-E_CLOSEHIST#-7
     2101    12193             MESSAGE: Altret on attempt to close history file
     2102    12194                                 */
     2103    12195    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     2104    12196    2      MODULE_ERR.ERR# = 29 /* E_CLOSEHIST# */;
     2105    12197    2      MODULE_ERR.SEV = 0;
     2106    12198    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
     2107    12199    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     2108    12200    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
     2109    12201    2      CALL ORR$XCONRTN;
     2110    12202
     2111    12203    2   CANT_CLOSE_CS:;
     2112    12204    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     2113    12205    2      MODULE_ERR.ERR# = 32 /* E_CLOSECS# */;
     2114    12206    2      MODULE_ERR.SEV = 0;
     2115    12207    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
     2116    12208    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     2117    12209    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
     2118    12210    2      CALL ORR$XCONRTN;
     2119    12211
     2120    12212
     2121    12213    2   END CLOSE_SPECIFIC_FILE;
     2122    12214        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:68   
     2123    12215         /*
     2124    12216                  S U B R O U T I N E   S E L E C T I O N _ R E T R I E V E R
     2125    12217                                                */
     2126    12218
     2127    12219    1   SELECTION_RETRIEVER: PROC;
     2128    12220
     2129    12221    2   DCL IOPT UBIN;
     2130    12222
     2131    12223    3      DO IOPT = 0 TO OUT$ -> OUT$BLK.NSUBLKS-1;
     2132    12224
     2133    12225    3         SR_PTR$ = OUT$ -> OUT$BLK.SUBLK$(IOPT);
     2134    12226    3         TPTR$ = SR_PTR$ -> OUT$BLK.SUBLK$(0);
     2135    12227    4         DO CASE (SR_PTR$ -> OUT$BLK.CODE);
     2136    12228    4         CASE (%CMD_WSN#);
     2137    12229    4            WSTATION = SR_PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;
     2138    12230
     2139    12231    4         CASE (%CMD_CONSOLE#);
     2140    12232    4            CONSOLE = SR_PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;
     2141    12233    4            LOCATION = SR_PTR$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT;
     2142    12234
     2143    12235    4         CASE (%CMD_LOGON#);
     2144    12236    4            LOGON = SR_PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;
     2145    12237
     2146    12238    4         CASE (%CMD_TYPE#);
     2147    12239    4            TYPE = ' ';
     2148    12240    4            IP_LOC_TYPE = '?';
     2149    12241    5            DO CASE (TPTR$ -> OUT$BLK.CODE);
     2150    12242    5            CASE (%CMD_SYST#);
     2151    12243    5               IP_ATTR_TYPE = '200000'O /* M_SYS  */;
     2152    12244
     2153    12245    5            CASE (%CMD_DEVC#);
     2154    12246    5               IP_ATTR_TYPE = '100000'O /* M_DEVC  */;
     2155    12247    5               IF TPTR$ -> OUT$BLK.NSUBLKS > 0
     2156    12248    5               THEN IP_LOC_TYPE = TPTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;
     2157    12249
     2158    12250    5            CASE (%CMD_ADMIN#);
     2159    12251    5               IP_ATTR_TYPE = '040000'O /* M_ADMIN */;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:69   
     2160    12252    5               IF TPTR$ -> OUT$BLK.NSUBLKS > 0
     2161    12253    5               THEN IP_LOC_TYPE = TPTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;
     2162    12254
     2163    12255    5            CASE (%CMD_COMM#);
     2164    12256    5               IP_ATTR_TYPE = '004000'O /* M_COMM */;
     2165    12257
     2166    12258    5            CASE (%CMD_TYPEQ#);
     2167    12259    5               TYPE = '?';
     2168    12260    5               IP_LOC_TYPE = '?';
     2169    12261
     2170    12262    5            CASE (%CMD_TP#);
     2171    12263    5               IP_ATTR_TYPE = '001000'O /* M_TP */;
     2172    12264
     2173    12265    5            END;
     2174    12266
     2175    12267    4         CASE (%CMD_PATTERN#);
     2176    12268    4            WILDCARDING = %YES#;
     2177    12269    4            XUW_WILDCARD.PATTERN_.PATTERN$ = ADDR (MSG);
     2178    12270    4            XUW_WILDCARD.INPUT_.INPUT$ = ADDR (OUT_BUFFER);
     2179    12271    4            MSG = SR_PTR$ -> OUT$BLK.SUBLK$ (0) -> OUT$SYM.TEXT;
     2180    12272    4            XUW_WILDCARD.PATTERN_.BOUND = SR_PTR$ -> OUT$BLK.SUBLK$ (0)
     2181    12273    4              -> OUT$SYM.COUNT - 1;
     2182    12274
     2183    12275    4         END;
     2184    12276    3      END;
     2185    12277    2   END SELECTION_RETRIEVER;
     2186    12278        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:70   
     2187    12279         /*
     2188    12280                  S U B R O U T I N E   D O _ R E S E T
     2189    12281                                                */
     2190    12282
     2191    12283    1   DO_RESET: PROC;
     2192    12284
     2193    12285    2      TPTR$ = OUT$ -> OUT$BLK.SUBLK$(0);
     2194    12286    2      SUBS1 = OUT$ -> OUT$BLK.NSUBLKS;
     2195    12287
     2196    12288    3      IF SUBS1 ~= 0 THEN DO;
     2197    12289    4         DO CASE (TPTR$ -> OUT$BLK.CODE);
     2198    12290
     2199    12291    4         CASE (%CMD_RSPAN#);
     2200    12292    4            OPERATOR_ENTERED_TIME1 = %NO#;
     2201    12293    4            OPERATOR_ENTERED_DATE1 = %NO#;
     2202    12294    4            OPERATOR_ENTERED_TIME2 = %NO#;
     2203    12295    4            OPERATOR_ENTERED_DATE2 = %NO#;
     2204    12296
     2205    12297    4         CASE (%CMD_RCONS#);
     2206    12298    4            CONSOLE = '?';
     2207    12299    4            LOCATION = '?';
     2208    12300
     2209    12301    4         CASE (%CMD_RLOG#);
     2210    12302    4            LOGON = '?';
     2211    12303
     2212    12304    4         CASE (%CMD_RWSN#);
     2213    12305    4            WSTATION = '?';
     2214    12306
     2215    12307    4         CASE (%CMD_RTYPE#);
     2216    12308    4            TYPE = '?';
     2217    12309    4            IP_LOC_TYPE = '?';
     2218    12310
     2219    12311    4         CASE (%CMD_R_LOGRPT#);
     2220    12312    4            LOGON_REPORT = %NO#;
     2221    12313
     2222    12314    4         CASE (%CMD_R_CONRPT#);
     2223    12315    4            CONSOLE_REPORT = %NO#;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:71   
     2224    12316
     2225    12317    4         CASE (%CMD_R_WILDCRD#);
     2226    12318    4            WILDCARDING = %NO#;
     2227    12319
     2228    12320    4         CASE (%CMD_NATLANG#);
     2229    12321    4            LANGUAGE = B$JIT$ -> B$JIT.LANG;
     2230    12322
     2231    12323    4         END;                              /* end case                           */
     2232    12324    3      END;                                 /* end IF                             */
     2233    12325    2      ELSE
     2234    12326    3      DO;
     2235    12327    3         OPERATOR_ENTERED_TIME1 = %NO#;
     2236    12328    3         OPERATOR_ENTERED_DATE1 = %NO#;
     2237    12329    3         OPERATOR_ENTERED_TIME2 = %NO#;
     2238    12330    3         OPERATOR_ENTERED_DATE2 = %NO#;
     2239    12331    3         LOGON_REPORT = %NO#;
     2240    12332    3         CONSOLE_REPORT = %NO#;
     2241    12333    3         CONSOLE = '?';
     2242    12334    3         LOCATION = '?';
     2243    12335    3         LOGON = '?';
     2244    12336    3         WSTATION = '?';
     2245    12337    3         TYPE = '?';
     2246    12338    3         IP_LOC_TYPE = '?';
     2247    12339    3         WILDCARDING = %NO#;
     2248    12340    3         LANGUAGE = B$JIT$ -> B$JIT.LANG;
     2249    12341    3      END;
     2250    12342    2   END DO_RESET;
     2251    12343        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:72   
     2252    12344
     2253    12345         /*
     2254    12346                  S U B R O U T I N E   D O _ D I S P L A Y
     2255    12347                                                */
     2256    12348
     2257    12349    1   DO_DISPLAY: PROC;
     2258    12350
     2259    12351         /* Save wildcard pattern              */
     2260    12352    2      OUT_BUFFER = MSG;
     2261    12353
     2262    12354    2      CALL INDEX (X, ' ', CONSOLE);
     2263    12355    2      CALL CONCAT (MSG, 'Console = ', SUBSTR (CONSOLE, 0, X), '@', LOCATION);
     2264    12356    2      OUT_MSG.BUF_.BOUND = 23;
     2265    12357    3      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;
     2266    12358
     2267    12359    2      CALL CONCAT (MSG, 'Logon = ', LOGON);
     2268    12360    2      OUT_MSG.BUF_.BOUND = 16;
     2269    12361    3      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;
     2270    12362
     2271    12363    2      CALL CONCAT (MSG, 'Workstation = ', WSTATION);
     2272    12364    2      OUT_MSG.BUF_.BOUND = 22;
     2273    12365    3      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;
     2274    12366
     2275    12367    2      MSG = 'Attribute type = ';
     2276    12368    2      OUT_MSG.BUF_.BOUND=38;
     2277    12369    2      IF TYPE = '?' THEN CALL INSERT (MSG, 17, 1, '?');
     2278    12370    2      ELSE IF IP_ATTR_TYPE = '100000'O /* M_DEVC  */ THEN CALL INSERT (MSG, 17, 15,
             12370               'DEVICE@', IP_LOC_TYPE);
     2279    12371    2      ELSE IF IP_ATTR_TYPE = '040000'O /* M_ADMIN */ THEN CALL INSERT (MSG, 17, 14,
             12371               'ADMIN@', IP_LOC_TYPE);
     2280    12372    2      ELSE IF IP_ATTR_TYPE = '200000'O /* M_SYS  */ THEN CALL INSERT (MSG, 17, 6,
             12372               'SYSTEM');
     2281    12373    2      ELSE IF IP_ATTR_TYPE = '004000'O /* M_COMM */ THEN CALL INSERT (MSG, 17, 4,
             12373               'COMM');
     2282    12374    2      ELSE IF IP_ATTR_TYPE = '001000'O /* M_TP */ THEN CALL INSERT (MSG, 17, 2, 'TP');
     2283    12375
     2284    12376    3      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:73   
     2285    12377
     2286    12378    2      IF LOGON_REPORT THEN MSG = 'Logon report = YES';
     2287    12379    2      ELSE MSG = 'Logon report = NO ';
     2288    12380    2      OUT_MSG.BUF_.BOUND = 18;
     2289    12381    3      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;
     2290    12382
     2291    12383    2      IF CONSOLE_REPORT THEN MSG = 'Console report = YES';
     2292    12384    2      ELSE MSG = 'Console report = NO ';
     2293    12385    2      OUT_MSG.BUF_.BOUND = 20;
     2294    12386    3      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;
     2295    12387
     2296    12388    2      IF WILDCARDING THEN MSG = 'Wildcarding = YES';
     2297    12389    2      ELSE MSG = 'Wildcarding = NO ';
     2298    12390    2      OUT_MSG.BUF_.BOUND = 17;
     2299    12391    3      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;
     2300    12392
     2301    12393        /* Restore wildcard pattern           */
     2302    12394    2      MSG = OUT_BUFFER;
     2303    12395
     2304    12396    2   END DO_DISPLAY;
     2305    12397        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:74   
     2306    12398        /*          S U B R O U T I N E   S E T _ D E S T I N A T I O N               */
     2307    12399
     2308    12400    1   SET_DESTINATION: PROC;
     2309    12401
     2310    12402
     2311    12403    3      IF OUT$ -> OUT$BLK.NSUBLKS > 0 THEN DO;
     2312    12404    3         DESTINATION = OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;
     2313    12405
     2314    12406    3         IF DCBADDR(DCBNUM(M$LO))->F$DCB.FCD#
     2315    12407    3         THEN CALL M$CLOSE(CLOSE_LO) ALTRET(CANT_CLOSE_LO);
     2316    12408
     2317    12409    3         FID_DEST.TEXTFID_ = VECTOR (DESTINATION);
     2318    12410
     2319    12411                                                /* Take data in textfid & convert
     2320    12412                                                     (via M$FID) to data which
     2321    12413                                                     override corresponding
     2322    12414                                                     defaults in M$LO.                */
     2323    12415
     2324    12416    3         CALL M$FID (FID_DEST) ALTRET (CANT_FID);
     2325    12417
     2326    12418    3         CALL M$OPEN (OPEN_DEST) ALTRET (CANT_OPEN_DEST);
     2327    12419
     2328    12420                                                /* Open M$LO with new values.         */
     2329    12421    3      END;
     2330    12422
     2331    12423    2      RETURN;
     2332    12424
     2333    12425
     2334    12426    2   CANT_CLOSE_LO:;
     2335    12427    2      MODULE_ERR.ERR# = 27 /* E_CLOSELO# */;
     2336    12428    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     2337    12429    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
     2338    12430    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     2339    12431    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
     2340    12432    2      CALL ORR$XCONRTN;
     2341    12433
     2342    12434    2   CANT_FID:;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:75   
     2343    12435        /*E* ERROR: ORR-E_FIDERR#-7
     2344    12436             MESSAGE: Altret occurred on attempt to change
     2345    12437                      the destination of DCB M$LO
     2346    12438                                 */
     2347    12439    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     2348    12440    2      MODULE_ERR.ERR# = 30 /* E_FIDERR# */;
     2349    12441    2      MODULE_ERR.SEV = 0;
     2350    12442    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
     2351    12443    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     2352    12444    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
     2353    12445    2      CALL ORR$XCONRTN;
     2354    12446
     2355    12447    2   CANT_OPEN_DEST:;
     2356    12448    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     2357    12449    2      MODULE_ERR.ERR# = 24 /* E_OPENLO# */;
     2358    12450    2      MODULE_ERR.SEV = 0;
     2359    12451    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
     2360    12452    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     2361    12453    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
     2362    12454    2      CALL ORR$XCONRTN;
     2363    12455    2   END SET_DESTINATION;
     2364    12456        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:76   
     2365    12457         /*
     2366    12458                  S U B R O U T I N E   D O _ T I M E
     2367    12459                                                */
     2368    12460    1   DO_TIME: PROC;
     2369    12461    2      SUBS1 = OUT$ -> OUT$BLK.NSUBLKS;
     2370    12462
     2371    12463    3      DO I = 0 TO (SUBS1 - 1) BY 1;
     2372    12464    3         LISTPTR$ = OUT$ -> OUT$BLK.SUBLK$(I);
     2373    12465    3         SUBS2 = LISTPTR$ -> OUT$BLK.NSUBLKS;
     2374    12466
     2375    12467    4         DO CASE (LISTPTR$ -> OUT$BLK.CODE);
     2376    12468    4         CASE (%CMD_TIME1#);
     2377    12469
     2378    12470    5            DO X = 0 TO (SUBS2 - 1) BY 1;
     2379    12471    5               PTR$ = LISTPTR$ -> OUT$BLK.SUBLK$(X);
     2380    12472
     2381    12473    6               DO CASE (PTR$ -> OUT$BLK.CODE);
     2382    12474    6               CASE (%CMD_HHMM#);
     2383    12475    6                  HOUR1 = '00';
     2384    12476    6                  CALL INSERT (HOUR1,
     2385    12477    6                    LENGTHC (HOUR1) -
     2386    12478    6                    (PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.COUNT),
     2387    12479    6                    ,
     2388    12480    6                    PTR$ -> OUT$BLK.SUBLK$(0) ->
     2389    12481    6                    OUT$SYM.TEXT);
     2390    12482
     2391    12483    6                  MIN1 = '00';
     2392    12484    6                  CALL INSERT (MIN1,
     2393    12485    6                    LENGTHC (MIN1) -
     2394    12486    6                    (PTR$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.COUNT),
     2395    12487    6                    ,
     2396    12488    6                    PTR$ -> OUT$BLK.SUBLK$(1) ->
     2397    12489    6                    OUT$SYM.TEXT);
     2398    12490    6                  OPERATOR_ENTERED_TIME1 = %YES#;
     2399    12491    6                  SEC1 = '00';
     2400    12492    6                  CENTISEC1 = '00';
     2401    12493
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:77   
     2402    12494    6               CASE (%CMD_DATE#);
     2403    12495    6                  MONTH1 = '00';
     2404    12496    6                  CALL INSERT (MONTH1,
     2405    12497    6                    LENGTHC (MONTH1) -
     2406    12498    6                    (PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.COUNT),
     2407    12499    6                    ,
     2408    12500    6                    PTR$ -> OUT$BLK.SUBLK$(0) ->
     2409    12501    6                    OUT$SYM.TEXT);
     2410    12502
     2411    12503    6                  DAY1 = '00';
     2412    12504    6                  CALL INSERT (DAY1,
     2413    12505    6                    LENGTHC (DAY1) -
     2414    12506    6                    (PTR$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.COUNT),
     2415    12507    6                    ,
     2416    12508    6                    PTR$ -> OUT$BLK.SUBLK$(1) ->
     2417    12509    6                    OUT$SYM.TEXT);
     2418    12510
     2419    12511    6                  YEAR1 = '00';
     2420    12512    6                  CALL INSERT (YEAR1,
     2421    12513    6                    LENGTHC (YEAR1) -
     2422    12514    6                    (PTR$ -> OUT$BLK.SUBLK$(2) -> OUT$SYM.COUNT),
     2423    12515    6                    ,
     2424    12516    6                    PTR$ -> OUT$BLK.SUBLK$(2) ->
     2425    12517    6                    OUT$SYM.TEXT);
     2426    12518    6                  OPERATOR_ENTERED_DATE1 = %YES#;
     2427    12519    7                  IF SUBS2 = 1 THEN DO;
     2428    12520    7                     HOUR1 = '00';
     2429    12521    7                     MIN1 = '00';
     2430    12522    7                     SEC1 = '00';
     2431    12523    7                     CENTISEC1 = '00';
     2432    12524    7                     OPERATOR_ENTERED_TIME1 = %YES#;
     2433    12525    7                  END;
     2434    12526
     2435    12527    6               END;                        /* End case (ptr$ -> out$blk.code)    */
     2436    12528
     2437    12529    5            END;                           /* End Do Loop (x=0 to (subs2-1))     */
     2438    12530    4            CALL CHARBIN (YR,YEAR1);
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:78   
     2439    12531    4            CALL CHARBIN (MON,MONTH1);
     2440    12532    4            CALL CHARBIN (DAY,DAY1);
     2441    12533    4            CALL CHARBIN (HR,HOUR1);
     2442    12534    4            CALL CHARBIN (MIN,MIN1);
     2443    12535    4            CALL TIME_VALIDATE;
     2444    12536        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:79   
     2445    12537
     2446    12538    4         CASE (%CMD_TIME2#);
     2447    12539
     2448    12540    5            DO X = 0 TO (SUBS2 - 1) BY 1;
     2449    12541    5               PTR$ = LISTPTR$ -> OUT$BLK.SUBLK$(X);
     2450    12542
     2451    12543    6               DO CASE (PTR$ -> OUT$BLK.CODE);
     2452    12544    6               CASE (%CMD_HHMM#);
     2453    12545    6                  HOUR2 = '00';
     2454    12546    6                  CALL INSERT (HOUR2,
     2455    12547    6                    LENGTHC (HOUR2) -
     2456    12548    6                    (PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.COUNT),
     2457    12549    6                    ,
     2458    12550    6                    PTR$ -> OUT$BLK.SUBLK$(0) ->
     2459    12551    6                    OUT$SYM.TEXT);
     2460    12552
     2461    12553    6                  MIN2 = '00';
     2462    12554    6                  CALL INSERT (MIN2,
     2463    12555    6                    LENGTHC (MIN2) -
     2464    12556    6                    (PTR$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.COUNT),
     2465    12557    6                    ,
     2466    12558    6                    PTR$ -> OUT$BLK.SUBLK$(1) ->
     2467    12559    6                    OUT$SYM.TEXT);
     2468    12560    6                  OPERATOR_ENTERED_TIME2 = %YES#;
     2469    12561    6                  SEC2 = '59';
     2470    12562    6                  CENTISEC2 = '99';
     2471    12563
     2472    12564    6               CASE (%CMD_DATE#);
     2473    12565    6                  MONTH2 = '00';
     2474    12566    6                  CALL INSERT (MONTH2,
     2475    12567    6                    LENGTHC (MONTH2) -
     2476    12568    6                    (PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.COUNT),
     2477    12569    6                    ,
     2478    12570    6                    PTR$ -> OUT$BLK.SUBLK$(0) ->
     2479    12571    6                    OUT$SYM.TEXT);
     2480    12572
     2481    12573
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:80   
     2482    12574    6                  DAY2 = '00';
     2483    12575    6                  CALL INSERT (DAY2,
     2484    12576    6                    LENGTHC (DAY2) -
     2485    12577    6                    (PTR$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.COUNT),
     2486    12578    6                    ,
     2487    12579    6                    PTR$ -> OUT$BLK.SUBLK$(1) ->
     2488    12580    6                    OUT$SYM.TEXT);
     2489    12581
     2490    12582    6                  YEAR2 = '00';
     2491    12583    6                  CALL INSERT (YEAR2,
     2492    12584    6                    LENGTHC (YEAR2) -
     2493    12585    6                    (PTR$ -> OUT$BLK.SUBLK$(2) -> OUT$SYM.COUNT),
     2494    12586    6                    ,
     2495    12587    6                    PTR$ -> OUT$BLK.SUBLK$(2) ->
     2496    12588    6                    OUT$SYM.TEXT);
     2497    12589    6                  OPERATOR_ENTERED_DATE2 = %YES#;
     2498    12590    7                  IF SUBS2 = 1 THEN DO;
     2499    12591    7                     HOUR2 = '23';
     2500    12592    7                     MIN2 = '59';
     2501    12593    7                     SEC2 = '59';
     2502    12594    7                     CENTISEC2 = '99';
     2503    12595    7                     OPERATOR_ENTERED_TIME2 = %YES#;
     2504    12596    7                  END;
     2505    12597    6               END;                        /* End case (ptr$ -> out$blk.code     */
     2506    12598
     2507    12599    5            END;                           /* End Do Loop (x=0 to (subs2-1))     */
     2508    12600
     2509    12601    4            CALL CHARBIN (YR,YEAR2);
     2510    12602    4            CALL CHARBIN (MON,MONTH2);
     2511    12603    4            CALL CHARBIN (DAY,DAY2);
     2512    12604    4            CALL CHARBIN (HR,HOUR2);
     2513    12605    4            CALL CHARBIN (MIN,MIN2);
     2514    12606    4            CALL TIME_VALIDATE;
     2515    12607
     2516    12608    4         END;                         /* End case (listptr$ -> out$blk.code)     */
     2517    12609
     2518    12610    3      END;                                 /* End Do Loop (I=0 to (subs1-1))     */
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:81   
     2519    12611    2   END DO_TIME;
     2520    12612        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:82   
     2521    12613         /*
     2522    12614                  S U B R O U T I N E   C L O B B E R _ T I M E _ D E F A U L T S
     2523    12615                                                */
     2524    12616
     2525    12617                                                /* This routine is called after
     2526    12618                                                     new time settings are entered
     2527    12619                                                     & placed in the time variables
     2528    12620                                                     by the "Do_time" routine. This
     2529    12621                                                     routine takes these new values
     2530    12622                                                     along with those unchanged,
     2531    12623                                                     (defaults), and recomputes
     2532    12624                                                     the beginning and ending time
     2533    12625                                                     UTS.                             */
     2534    12626
     2535    12627    1   CLOBBER_TIME_DEFAULTS: PROC;
     2536    12628    2      CALL CONCAT (FPT_DATE,
     2537    12629    2        YEAR1,
     2538    12630    2        MONTH1,
     2539    12631    2        DAY1);
     2540    12632
     2541    12633    2      CALL CONCAT (FPT_TIME,
     2542    12634    2        HOUR1,
     2543    12635    2        MIN1,
     2544    12636    2        SEC1,
     2545    12637    2        CENTISEC1);
     2546    12638
     2547    12639    2      CALL M$TIME (TIME_CONV) ALTRET (CANT_CALL_TIME_CONV);
     2548    12640
     2549    12641    2      BEGINNING_TIME = UTSTAMP;
     2550    12642
     2551    12643    2      RANGE_CONV.TSTAMP_ = VECTOR (BEGINNING_TIME);
     2552    12644    2      CALL M$TIME (RANGE_CONV) ALTRET (CANT_CALL_RANGE_CONV);
     2553    12645    2      TIME_BUFFER = ' ';
     2554    12646    2      CALL INSERT (TIME_BUFFER,
     2555    12647    2        0,
     2556    12648    2        42,
     2557    12649    2        'Current time range is ',
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:83   
     2558    12650    2        SIM_TIME,
     2559    12651    2        ' ',
     2560    12652    2        SIM_DATE);
     2561    12653
     2562    12654    2      CALL CONCAT (FPT_DATE,
     2563    12655    2        YEAR2,
     2564    12656    2        MONTH2,
     2565    12657    2        DAY2);
     2566    12658
     2567    12659    2      CALL CONCAT (FPT_TIME,
     2568    12660    2        HOUR2,
     2569    12661    2        MIN2,
     2570    12662    2        SEC2,
     2571    12663    2        CENTISEC2);
     2572    12664
     2573    12665    2      CALL M$TIME (TIME_CONV) ALTRET (CANT_CALL_TIME_CONV);
     2574    12666    2      ENDING_TIME = UTSTAMP;
     2575    12667
     2576    12668    2      RANGE_CONV.TSTAMP_ = VECTOR (ENDING_TIME);
     2577    12669    2      CALL M$TIME (RANGE_CONV) ALTRET (CANT_CALL_RANGE_CONV);
     2578    12670    2      CALL INSERT (TIME_BUFFER,
     2579    12671    2        43,
     2580    12672    2        25,
     2581    12673    2        ' to  ',
     2582    12674    2        SIM_TIME,
     2583    12675    2        ' ',
     2584    12676    2        SIM_DATE);
     2585    12677
     2586    12678    2      WRITE_TIME.BUF_.BOUND = 68;
     2587    12679    2      CALL M$WRITE (WRITE_TIME);
     2588    12680
     2589    12681
     2590    12682    3      DO WHILE ('0'B);
     2591    12683    3   CANT_CALL_TIME_CONV:;
     2592    12684        /*E* ERROR: ORR-E_CALLTIMECONV#-7
     2593    12685             MESSAGE: Altret condition occurred on call to M$TIME
     2594    12686             The call was to convert ANS to UTS.
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:84   
     2595    12687                                 */
     2596    12688    3         MODULE_ERR.ERR# = 9 /* E_CALLTIMECONV# */;
     2597    12689    3         MODULE_ERR.SEV = 0;
     2598    12690    3         CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     2599    12691    3         ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     2600    12692    3         CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));
     2601    12693    3         CALL ORR$XCONRTN;
     2602    12694
     2603    12695    3   CANT_CALL_RANGE_CONV:;
     2604    12696        /*E* ERROR: ORR-E_CALLTIMERANG#-7
     2605    12697             MESSAGE: Altret occurred on call to M$TIME
     2606    12698                      converting UTS to local
     2607    12699                                 */
     2608    12700    3         MODULE_ERR.ERR# = 33 /* E_CALLTIMERANG */;
     2609    12701    3         MODULE_ERR.SEV = 0;
     2610    12702    3         CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     2611    12703    3         ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     2612    12704    3         CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));
     2613    12705    3         CALL ORR$XCONRTN;
     2614    12706    3      END;
     2615    12707
     2616    12708    2   END CLOBBER_TIME_DEFAULTS;
     2617    12709
     2618    12710        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:85   
     2619    12711         /*
     2620    12712                  S U B R O U T I N E   T I M E _ V A L I D A T E
     2621    12713                                                */
     2622    12714
     2623    12715    1   TIME_VALIDATE: PROC;
     2624    12716
     2625    12717    2   DCL LEAP UBIN WORD STATIC;
     2626    12718    2   DCL LEAP_VAR UBIN WORD STATIC;
     2627    12719    2   DCL CUR_YR UBIN WORD STATIC;
     2628    12720    2   DCL TEMP_YR UBIN WORD STATIC;
     2629    12721    2   DCL DAY_LIST (0:11) UBIN WORD STATIC ALIGNED INIT
     2630    12722    2    (31, /* JAN                                */
     2631    12723    2    28, /* FEB                                */
     2632    12724    2    31, /* MAR                                */
     2633    12725    2    30, /* APR                                */
     2634    12726    2    31, /* MAY                                */
     2635    12727    2    30, /* JUN                                */
     2636    12728    2    31, /* JUL                                */
     2637    12729    2    31, /* AUG                                */
     2638    12730    2    30, /* SEP                                */
     2639    12731    2    31, /* OCT                                */
     2640    12732    2    30, /* NOV                                */
     2641    12733    2    31);                                   /* DEC                                */
     2642    12734        /* BEGIN SUB-PROGRAM */
     2643    12735
     2644    12736    2      IF MOD(YR,4) = 0
     2645    12737    2      THEN LEAP = 1;
     2646    12738    2      ELSE LEAP = 0;
     2647    12739
     2648    12740    2      IF (LEAP = 1 AND MON = 2)
     2649    12741    2      THEN LEAP_VAR = 1;
     2650    12742    2      ELSE LEAP_VAR = 0;
     2651    12743
     2652    12744    2      TIME_SET.V.SOURCE# = %CLOCK#;
     2653    12745    3      CALL M$TIME (TIME_SET) WHENALTRETURN DO; END;
     2654    12746
     2655    12747    2      TIME_SET.V.SOURCE# = %UTS#;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:86   
     2656    12748    2      CALL CHARBIN (CUR_YR,DATE_BUF(0));   /* DATE_BUF(0) IS THE
     2657    12749                                                CURRENT YEAR FROM THE CALL TO
     2658    12750                                                M$TIME IN THE ROUTINE
     2659    12751                                                "INITIALIZE.                          */
     2660    12752
     2661    12753    2      IF (CUR_YR <=20) THEN
     2662    12754    2      CUR_YR = CUR_YR + 2000;
     2663    12755    2      ELSE CUR_YR = CUR_YR + 1900;         /* THIS ISN'T REALLY NECESSARY, BUT   */
     2664    12756                                                /* IT MAKES IT CLEARER WHAT'S GOING   */
     2665    12757                                                /* ON.                                */
     2666    12758    3      IF MON > 0 THEN DO;
     2667    12759    3         IF (DAY > (DAY_LIST (MON - 1) + LEAP_VAR)) THEN GOTO BAD_DATE;
     2668    12760    3      END;
     2669    12761
     2670    12762    2      IF (YR <=20) THEN
     2671    12763    2      TEMP_YR = YR+2000;
     2672    12764    2      ELSE TEMP_YR = YR+1900;              /* ADJUST YEAR FOR THE Y2K BOUNDARY   */
     2673    12765    2      IF ((MON > 12)
     2674    12766    2        OR (HR > 23)
     2675    12767    2        OR (MIN > 59)
     2676    12768    2        OR (TEMP_YR > CUR_YR)) THEN
     2677    12769    3   BAD_DATE: DO;
     2678    12770         /*E* ERROR: ORR-E_BADTIME#-0
     2679    12771                  MESSAGE: You have entered an invalid time or date
     2680    12772                                                */
     2681    12773    3         MODULE_ERR.ERR# = 16 /* E_BADTIME# */;
     2682    12774    3         MODULE_ERR.SEV = 0;
     2683    12775    3         CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     2684    12776    3      END;
     2685    12777    2   END TIME_VALIDATE;
     2686    12778
     2687    12779
     2688    12780        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:87   
     2689    12781         /*
     2690    12782                  S U B R O U T I N E   O P E N _ T O _ R A N G E
     2691    12783                                                */
     2692    12784
     2693    12785    1   OPEN_TO_RANGE: PROC;
     2694    12786    2      CALL M$GDS (STACK_SEG) ALTRET (CANT_CALL_GDS);
     2695    12787
     2696    12788                                                /* Allocate segment for ":OCHIST"
     2697    12789                                                     on stack.                        */
     2698    12790
     2699    12791    2      GDS_RESULTS_VEC.PTR$ -> PREV_STACK (STK_INDEX) = FID_NAME;
     2700    12792    2      CALL OPEN_SPECIFIC_FILE;
     2701    12793
     2702    12794    2   FIND_RANGE:;
     2703    12795    2      CALL M$READ (READ_STATUS) ALTRET (CANT_READ_STATUS);
     2704    12796    2      CALL M$READ (READ_CONSOLE_REC) ALTRET (CANT_READ_HIST);
     2705    12797
     2706    12798    3      IF OCL_CONSOLE_REC.UTS > BEGINNING_TIME THEN DO;
     2707    12799
     2708    12800                                                /* If beginning time preceeds the
     2709    12801                                                     earliest time on this file
     2710    12802                                                     then do the following.           */
     2711    12803
     2712    12804    3         PREV.TXT = ' ';
     2713    12805    3         PREV = OCL_STATUS_REC.PREV_FILE;
     2714    12806
     2715    12807                                                /* Get previous filename from
     2716    12808                                                     status record.                   */
     2717    12809
     2718    12810
     2719    12811    3         CALL M$GDS (STACK_SEG) ALTRET (CANT_CALL_GDS);
     2720    12812    3         STK_INDEX = STK_INDEX+1;
     2721    12813    3         GDS_RESULTS_VEC.PTR$ -> PREV_STACK (STK_INDEX) = PREV;
     2722    12814
     2723    12815                                                /* Place previous filename on
     2724    12816                                                     top of stack.                    */
     2725    12817
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:88   
     2726    12818    3         FID_NAME = GDS_RESULTS_VEC.PTR$ -> PREV_STACK(STK_INDEX-1);
     2727    12819    3         CALL CLOSE_SPECIFIC_FILE;
     2728    12820
     2729    12821    3         IF GDS_RESULTS_VEC.PTR$ -> PREV_STACK.COUNT (STK_INDEX) = 0 THEN GOTO
             12821                  NO_MORE_HISTORY;
     2730    12822    4         ELSE DO;
     2731    12823    4            FID_NAME = GDS_RESULTS_VEC.PTR$ -> PREV_STACK (STK_INDEX);
     2732    12824    4            CALL OPEN_SPECIFIC_FILE;
     2733    12825    5            IF NO_FILE THEN DO;
     2734    12826    5   NO_FILE:
     2735    12827    5               STK_INDEX = STK_INDEX - 1;
     2736    12828    5               FID_NAME = GDS_RESULTS_VEC.PTR$->PREV_STACK (STK_INDEX);
     2737    12829    5               CALL OPEN_SPECIFIC_FILE;
     2738    12830    5               CALL M$READ (READ_STATUS) ALTRET (CANT_READ_STATUS);
     2739    12831    5               CALL M$READ (READ_CONSOLE_REC) ALTRET (CANT_READ_HIST);
     2740    12832    5               ERROR.ERR# = 0;
     2741    12833    5               NO_FILE = %NO#;
     2742    12834    5               GOTO PROCESS;
     2743    12835    5            END;
     2744    12836    4            GOTO FIND_RANGE;
     2745    12837    4         END;
     2746    12838
     2747    12839    3      END; /*  UTS > BEGINNING_TIME  */
     2748    12840
     2749    12841    2      ELSE
     2750    12842    2   PROCESS:
     2751    12843    3      DO;
     2752    12844    3         FIRST_HIST_REC.V.N# = -1;
     2753    12845    3         CALL M$PRECORD (FIRST_HIST_REC) ALTRET (CANT_PRECORD);
     2754    12846
     2755    12847                                                /* Reset file to first history
     2756    12848                                                     record because it was read
     2757    12849                                                                              above.  */
     2758    12850
     2759    12851    3         RETURN;
     2760    12852    3      END;
     2761    12853
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:89   
     2762    12854
     2763    12855
     2764    12856    2   NO_MORE_HISTORY:;
     2765    12857        /*E* ERROR: ORR-E_OUTOFHIST#-7
     2766    12858             MESSAGE: Range was entered that is beyond
     2767    12859                      beginning of history file.
     2768    12860                                 */
     2769    12861    2      MODULE_ERR.ERR# = 19 /* E_OUTOFHIST# */;
     2770    12862    2      MODULE_ERR.SEV = 0;
     2771    12863    2      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     2772    12864    2      GOTO NO_FILE;
     2773    12865
     2774    12866
     2775    12867    2   CANT_CALL_GDS:;
     2776    12868    2      MODULE_ERR.ERR# = 36 /* E_NOSEGS# */;
     2777    12869    2      MODULE_ERR.SEV = 0;
     2778    12870    2      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     2779    12871    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     2780    12872    2      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));
     2781    12873    2      CALL ORR$XCONRTN;
     2782    12874
     2783    12875    2   CANT_READ_STATUS:;
     2784    12876    2      MODULE_ERR.ERR# = 28 /* E_READSTATERR# */;
     2785    12877    2      MODULE_ERR.SEV = 0;
     2786    12878    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     2787    12879    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
     2788    12880    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     2789    12881    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
     2790    12882    2      CALL ORR$XCONRTN;
     2791    12883
     2792    12884    2   CANT_READ_HIST:;
     2793    12885    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
     2794    12886    2      MODULE_ERR.ERR# = 20 /* E_HSTREAD# */;
     2795    12887    2      MODULE_ERR.SEV = 0;
     2796    12888    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
     2797    12889    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     2798    12890    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:90   
     2799    12891    2      CALL ORR$XCONRTN;
     2800    12892
     2801    12893
     2802    12894    2   CANT_PRECORD:;
     2803    12895    2      MODULE_ERR.ERR# = 25 /* E_PRECERR# */;
     2804    12896    2      MODULE_ERR.SEV = 0;
     2805    12897    2      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     2806    12898    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     2807    12899    2      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));
     2808    12900    2      CALL ORR$XCONRTN;
     2809    12901
     2810    12902    2   END OPEN_TO_RANGE;
     2811    12903
     2812    12904        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:91   
     2813    12905         /*
     2814    12906                  S U B R O U T I N E   C L O S E _ U P
     2815    12907                                                */
     2816    12908
     2817    12909    1   CLOSE_UP: PROC;
     2818    12910    3      DO CASE (STK_INDEX);
     2819    12911    3      CASE (0);
     2820    12912    3         FID_NAME = GDS_RESULTS_VEC.PTR$ -> PREV_STACK (STK_INDEX);
     2821    12913    3         FDS_RESULTS_VEC.PTR$ = PINCRW (GDS_RESULTS_VEC.PTR$,(STK_INDEX * 8));
     2822    12914    3         CALL M$FDS (RELEASE_SEG);
     2823    12915    3         CALL CLOSE_SPECIFIC_FILE;
     2824    12916    3         KEEP_ON_LISTING = %NO#;
     2825    12917
     2826    12918                                                /* File to be closed is :OCHIST
     2827    12919                                                     (last on stack).                 */
     2828    12920
     2829    12921
     2830    12922    3      CASE (1);
     2831    12923    3         FID_NAME = GDS_RESULTS_VEC.PTR$->PREV_STACK (STK_INDEX);
     2832    12924    3         FDS_RESULTS_VEC.PTR$ = PINCRW (GDS_RESULTS_VEC.PTR$,(STK_INDEX * 8));
     2833    12925    3         CALL M$FDS (RELEASE_SEG);
     2834    12926    4         IF ENDING_TIME > OCL_NORM_KEY.UTS THEN DO;
     2835    12927    4            CALL CLOSE_SPECIFIC_FILE;
     2836    12928    4            STK_INDEX = STK_INDEX-1;
     2837    12929    4            FID_NAME = GDS_RESULTS_VEC.PTR$->PREV_STACK (STK_INDEX);
     2838    12930    4            CALL OPEN_SPECIFIC_FILE;
     2839    12931    4            FIRST_HIST_REC.V.N# = 1;
     2840    12932    4            CALL M$PRECORD (FIRST_HIST_REC) ALTRET (CANT_PRECORD);
     2841    12933    4            CALL BUILD_CONSOLE_STACK;
     2842    12934    4            OCL_NORM_KEY.COUNT = 4;
     2843    12935    4            OCL_NORM_KEY.UTS = 15000;
     2844    12936    4            HIST_POSITION.V.N# = 0;
     2845    12937    4            KEEP_ON_LISTING = %YES#;
     2846    12938    4         END;
     2847    12939    3         ELSE
     2848    12940    4         DO;
     2849    12941    4            CALL CLOSE_SPECIFIC_FILE;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:92   
     2850    12942    4            KEEP_ON_LISTING = %NO#;
     2851    12943    4         END;
     2852    12944
     2853    12945                                                /* Close history file, call keyin
     2854    12946                                                     if continued searching is
     2855    12947                                                     necessary, to insure that
     2856    12948                                                     :OCHIST is opened shared.        */
     2857    12949
     2858    12950
     2859    12951    3      CASE (ELSE);
     2860    12952    3         FID_NAME = GDS_RESULTS_VEC.PTR$ -> PREV_STACK (STK_INDEX);
     2861    12953    3         FDS_RESULTS_VEC.PTR$ = PINCRW (GDS_RESULTS_VEC.PTR$,(STK_INDEX * 8));
     2862    12954    3         CALL M$FDS (RELEASE_SEG);
     2863    12955    4         IF ENDING_TIME > OCL_NORM_KEY.UTS THEN DO;
     2864    12956    4            CALL CLOSE_SPECIFIC_FILE;
     2865    12957    4            STK_INDEX = STK_INDEX-1;
     2866    12958    4            FID_NAME = GDS_RESULTS_VEC.PTR$ -> PREV_STACK (STK_INDEX);
     2867    12959    4            CALL OPEN_SPECIFIC_FILE;
     2868    12960    4            FIRST_HIST_REC.V.N# = 1;
     2869    12961    4            CALL M$PRECORD (FIRST_HIST_REC) ALTRET (CANT_PRECORD);
     2870    12962    4            CALL BUILD_CONSOLE_STACK;
     2871    12963    4            OCL_NORM_KEY.COUNT = 4;
     2872    12964    4            OCL_NORM_KEY.UTS = 15000;
     2873    12965    4            HIST_POSITION.V.N# = 0;
     2874    12966    4            KEEP_ON_LISTING = %YES#;
     2875    12967    4         END;
     2876    12968    3         ELSE
     2877    12969    4         DO;
     2878    12970    4            CALL CLOSE_SPECIFIC_FILE;
     2879    12971    4            KEEP_ON_LISTING = %NO#;
     2880    12972    4         END;
     2881    12973
     2882    12974                                                /* If more that 2 entries are on
     2883    12975                                                     the stack you don't have to
     2884    12976                                                     worry about talking to
     2885    12977                                                     keyin, so close file at top
     2886    12978                                                     of stack, decrement stack,
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:93   
     2887    12979                                                     open file.                       */
     2888    12980
     2889    12981    3      END;
     2890    12982    2      RETURN;
     2891    12983
     2892    12984
     2893    12985    2   CANT_PRECORD:;
     2894    12986    2      MODULE_ERR.ERR# = 25 /* E_PRECERR# */;
     2895    12987    2      MODULE_ERR.SEV = 0;
     2896    12988    2      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     2897    12989    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     2898    12990    2      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));
     2899    12991    2      CALL ORR$XCONRTN;
     2900    12992
     2901    12993    2   END CLOSE_UP;
     2902    12994        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:94   
     2903    12995         /*
     2904    12996                  S U B R O U T I N E   B U I L D _ C O N S O L E _ S T A C K
     2905    12997                                                */
     2906    12998
     2907    12999    1   BUILD_CONSOLE_STACK: PROC;
     2908    13000    2      PREFIX = %YES#;
     2909    13001    2      IF WSTATION = '?'
     2910    13002    2        AND LOGON = '?'
     2911    13003    2        AND LOCATION = '?'
     2912    13004    2        AND CONSOLE = '?'
     2913    13005    3        AND TYPE = '?' THEN DO;
     2914    13006    3         ALL = %YES#;
     2915    13007    3         IF LOGON_REPORT THEN GOTO DO_ALL;
     2916    13008    3         ELSE RETURN;
     2917    13009    3      END;
     2918    13010
     2919    13011    2      ALL = %NO#;
     2920    13012    2   DO_ALL:;
     2921    13013    2      PREFIX = %NO#;
     2922    13014    2      PERFORM_CALL = %NO#;
     2923    13015    2      DIRECT = %NO#;
     2924    13016    2      IF TYPE ~= '?' THEN RETURN;
     2925    13017
     2926    13018    3      DO WHILE ('1'B);
     2927    13019    3         CALL M$READ (READ_CONSOLE_REC) ALTRET (NO_MORE_CRECS);
     2928    13020    4         IF (CONSOLE = '?' AND LOCATION ~= '?') THEN DO;
     2929    13021    5            IF LOCATION = OCL_CONSOLE_REC.TERM_NAME THEN DO;
     2930    13022    5               DIRECT = %YES#;
     2931    13023    5               PERFORM_CALL = %YES#;
     2932    13024    5            END;
     2933    13025    4         END;
     2934    13026
     2935    13027    4         IF (CONSOLE ~= '?' AND LOCATION = '?') THEN DO;
     2936    13028    5            IF CONSOLE = OCL_CONSOLE_REC.STATION.FIRST_HALF THEN DO;
     2937    13029    5               DIRECT = %NO#;
     2938    13030    5               PERFORM_CALL = %YES#;
     2939    13031    5            END;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:95   
     2940    13032    4         END;
     2941    13033
     2942    13034    4         IF (CONSOLE ~= '?' AND LOCATION ~= '?') THEN DO;
     2943    13035    5            IF CONSOLE = OCL_CONSOLE_REC.STATION.FIRST_HALF THEN DO;
     2944    13036    6               IF LOCATION = OCL_CONSOLE_REC.TERM_NAME THEN DO;
     2945    13037    6                  PERFORM_CALL = %YES#;
     2946    13038    6                  DIRECT = %YES#;
     2947    13039    6               END;
     2948    13040    5            END;
     2949    13041    4         END;
     2950    13042
     2951    13043    4         IF (LOGON ~= '?' AND LOGON = OCL_CONSOLE_REC.LOGON) THEN DO;
     2952    13044    4            PERFORM_CALL = %YES#;
     2953    13045    4            DIRECT = %YES#;
     2954    13046    4         END;
     2955    13047
     2956    13048    4         IF WSTATION ~= '?' THEN DO;
     2957    13049    5            IF SUBSTR (OCL_CONSOLE_REC.WSN, 0, 1) = '?' THEN DO;
     2958    13050    5               CALL INDEX (W, '?', WSTATION);
     2959    13051    6               IF SUBSTR (WSTATION, 0, W) = SUBSTR (OCL_CONSOLE_REC.TERM_NAME, 0, W)
             13051                        THEN DO;
     2960    13052    6                  PERFORM_CALL = %YES#;
     2961    13053    6                  DIRECT = %NO#;
     2962    13054    6               END;
     2963    13055    5            END;
     2964    13056    5            ELSE DO;
     2965    13057    5               CALL INDEX (W, '?', OCL_CONSOLE_REC.WSN);
     2966    13058    6               IF SUBSTR (OCL_CONSOLE_REC.WSN, 0, W) = SUBSTR (WSTATION, 0, W) THEN DO;
     2967    13059    6                  PERFORM_CALL = %YES#;
     2968    13060    6                  DIRECT = %NO#;
     2969    13061    6               END;
     2970    13062    5            END;
     2971    13063    4         END;
     2972    13064
     2973    13065    3         IF LOGON_REPORT AND ALL THEN PERFORM_CALL = %YES#;
     2974    13066
     2975    13067    4         IF PERFORM_CALL THEN DO;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:96   
     2976    13068    4            CALL ADD_TO_LOGON_STACK;
     2977    13069    4            PERFORM_CALL = %NO#;
     2978    13070    4         END;
     2979    13071    3      END;
     2980    13072
     2981    13073    2   NO_MORE_CRECS:;
     2982    13074    2      IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$LD THEN RETURN;
     2983    13075    3      ELSE DO;
     2984    13076         /*E* ERROR: ORR-E_CREC#-7
     2985    13077                  MESSAGE: Error at attempt to read console record
     2986    13078                                 */
     2987    13079    3         ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     2988    13080    3         CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));
     2989    13081    3         MODULE_ERR.ERR# = 35 /* E_CREC# */;
     2990    13082    3         MODULE_ERR.SEV = 0;
     2991    13083    3         CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     2992    13084    3         CALL ORR$XCONRTN;
     2993    13085    3      END;
     2994    13086
     2995    13087
     2996    13088    2   CANT_READ_STATUS:;
     2997    13089    2      MODULE_ERR.ERR# = 28 /* E_READSTATERR# */;
     2998    13090    2      MODULE_ERR.SEV = 0;
     2999    13091    2      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
     3000    13092    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     3001    13093    2      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));
     3002    13094    2      CALL ORR$XCONRTN;
     3003    13095    2   END BUILD_CONSOLE_STACK;
     3004    13096        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:97   
     3005    13097         /*
     3006    13098                  S U B R O U T I N E   A D D _ T O _ L O G O N _ S T A C K
     3007    13099                                                */
     3008    13100
     3009    13101    1   ADD_TO_LOGON_STACK: PROC;
     3010    13102
     3011    13103    3      IF SOME_ON_STACK <= 0 THEN DO;
     3012    13104    3         LRECS = 2;
     3013    13105    3         USE_LINDEX = %YES#;
     3014    13106    3         LINDEX = 0;
     3015    13107    3         CALL WRITE_LSTACK;
     3016    13108    3         SOME_ON_STACK = 1;
     3017    13109    3         RETURN;
     3018    13110    3      END;
     3019    13111
     3020    13112        /* else */
     3021    13113
     3022    13114    3      DO L = (LINDEX - 1) DOWNTO 0 BY -1;
     3023    13115    3         LOGON_REC_ON = LSTACK_RESULTS_VEC.PTR$ -> LSTACK(L);
     3024    13116
     3025    13117    3         IF OCL_CONSOLE_REC.STATION.FIRST_HALF=LOGON_REC_ON.STATION.FIRST_HALF
     3026    13118    3           AND OCL_CONSOLE_REC.STATION.SECND_HALF=LOGON_REC_ON.STATION.SECND_HALF
     3027    13119    4         THEN DO;
     3028    13120
     3029    13121    5            IF LOGON_REC_ON.UTS = 0 AND OCL_CONSOLE_REC.STATUS = 0 THEN DO;
     3030    13122    5               LRECS = 1;
     3031    13123    5               USE_LINDEX = %NO#;
     3032    13124    5               CALL WRITE_LSTACK;
     3033    13125    5               RETURN;
     3034    13126    5            END;
     3035    13127
     3036    13128    4            ELSE IF LOGON_REC_ON.UTS = 0 AND OCL_CONSOLE_REC.STATUS = 1
     3037    13129    4            THEN RETURN;    /* Record says "He's logged on, but I don't know when"
     3038    13130                                    and we already knew at least that much about him. */
     3039    13131    5            ELSE DO;
     3040    13132    5               LRECS = 2;
     3041    13133    5               USE_LINDEX = %YES#;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:98   
     3042    13134    5               CALL WRITE_LSTACK;
     3043    13135    5               RETURN;
     3044    13136    5            END;
     3045    13137    4         END /* if console_rec=logon_rec */;
     3046    13138    3      END /* loop */;
     3047    13139
     3048    13140    2      LRECS = 2;
     3049    13141    2      USE_LINDEX = %YES#;
     3050    13142    2      CALL WRITE_LSTACK;
     3051    13143    2      RETURN;
     3052    13144
     3053    13145    2   END ADD_TO_LOGON_STACK;
     3054    13146        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:99   
     3055    13147        /*           S U B R O U T I N E   W R I T E _ L S T A C K                    */
     3056    13148
     3057    13149    1   WRITE_LSTACK: PROC;
     3058    13150    2      LOGON_REC_ON.TERM_NAME = OCL_CONSOLE_REC.TERM_NAME;
     3059    13151    2      LOGON_REC_ON.WSN = OCL_CONSOLE_REC.WSN;
     3060    13152    2      LOGON_REC_ON.ATTRO = OCL_CONSOLE_REC.ATTRO;
     3061    13153    2      LOGON_REC_ON.LOGON = OCL_CONSOLE_REC.LOGON;
     3062    13154    2      LOGON_TITLE = ' ';
     3063    13155    2      LOGON_REC_ON.STATION.FIRST_HALF = OCL_CONSOLE_REC.STATION.FIRST_HALF;
     3064    13156    2      LOGON_REC_ON.STATION.SECND_HALF = OCL_CONSOLE_REC.STATION.SECND_HALF;
     3065    13157    2      LOGON_REC_ON.UTS = OCL_CONSOLE_REC.UTS;
     3066    13158    2      LOGON_REC_ON.STATUS = OCL_CONSOLE_REC.STATUS;
     3067    13159
     3068    13160
     3069    13161    3      IF FREE_SPACE < 30 THEN DO;
     3070    13162    4         CALL M$GDS (GET_LSTACK_SEG) WHENALTRETURN DO; END;
     3071    13163    3         FREE_SPACE = 1024;
     3072    13164    3         PAGES = PAGES + 1;
     3073    13165    3      END;
     3074    13166
     3075    13167    3      IF USE_LINDEX THEN DO;
     3076    13168    3         LSTACK_RESULTS_VEC.PTR$ -> LSTACK(LINDEX) = LOGON_REC_ON;
     3077    13169    3         LINDEX = LINDEX + 1;
     3078    13170    3         FREE_SPACE = FREE_SPACE - 11;
     3079    13171    3      END;
     3080    13172    2      ELSE
     3081    13173    2      LSTACK_RESULTS_VEC.PTR$ -> LSTACK(L) = LOGON_REC_ON;
     3082    13174
     3083    13175    3      IF LRECS = 2 THEN DO;
     3084    13176    3         LOGON_REC_ON.UTS = 0;
     3085    13177    3         LSTACK_RESULTS_VEC.PTR$ -> LSTACK(LINDEX) = LOGON_REC_ON;
     3086    13178    3         LINDEX = LINDEX + 1;
     3087    13179    3         FREE_SPACE = FREE_SPACE - 11;
     3088    13180    3      END;
     3089    13181    2      RETURN;
     3090    13182    2   END WRITE_LSTACK;
     3091    13183        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:100  
     3092    13184         /*
     3093    13185                  S U B R O U T I N E   B U I L D _ A T T R _ S T A C K
     3094    13186                                                */
     3095    13187
     3096    13188    1   BUILD_ATTR_STACK: PROC;
     3097    13189    2      L = 0;
     3098    13190    2      A_INDEX = 0;
     3099    13191    2      IF LINDEX = 0 THEN RETURN;
     3100    13192    2   BEGIN:;
     3101    13193    2      LOGON_REC_ON = LSTACK_RESULTS_VEC.PTR$ -> LSTACK(L);
     3102    13194    2      L = L + 1;
     3103    13195    2      LOGON_REC_OFF = LSTACK_RESULTS_VEC.PTR$ -> LSTACK(L);
     3104    13196    2      L = L + 1;
     3105    13197
     3106    13198    2      IF OCL_NORM_KEY.UTS >= LOGON_REC_ON.UTS
     3107    13199    2        AND ((OCL_NORM_KEY.UTS <= LOGON_REC_OFF.UTS)
     3108    13200    3        OR LOGON_REC_OFF.UTS = 0) THEN DO;
     3109    13201    3         A_INDEX = A_INDEX + 1;
     3110    13202    3         ATTR_REC.ATTRO = LOGON_REC_ON.ATTRO;
     3111    13203    3         ATTR_REC.WSN = LOGON_REC_ON.WSN;
     3112    13204    3         ATTR_REC.TERMINAL = LOGON_REC_ON.TERM_NAME;
     3113    13205    3         ATTR_REC.STATION.FIRST_HALF = LOGON_REC_ON.STATION.FIRST_HALF;
     3114    13206    3         ATTR_REC.STATION.SECND_HALF = LOGON_REC_ON.STATION.SECND_HALF;
     3115    13207    3         ASTACK_RESULTS_VEC.PTR$ -> ASTACK (A_INDEX) = ATTR_REC;
     3116    13208    3      END;
     3117    13209    2      IF L < (LINDEX - 1) THEN GOTO BEGIN;
     3118    13210    2   END BUILD_ATTR_STACK;
     3119    13211        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:101  
     3120    13212
     3121    13213         /*           SUBROUTINE   DISPLAY_LOGONS                                     */
     3122    13214
     3123    13215    1   DISPLAY_LOGONS: PROC;
     3124    13216    2      CALL INSERT (LOGON_TITLE, 2, 6, 'LOGON');
     3125    13217    2      CALL INSERT (LOGON_TITLE, 18, 7, 'CONSOLE');
     3126    13218    2      CALL INSERT (LOGON_TITLE, 41, 2, 'ON');
     3127    13219    2      CALL INSERT (LOGON_TITLE, 64, 3, 'OFF');
     3128    13220    2      MSG = LOGON_TITLE;
     3129    13221    2      OUT_MSG.BUF_.BOUND = 72;
     3130    13222    3      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;
     3131    13223
     3132    13224    3      DO L = 0 TO LINDEX - 1 BY 2;
     3133    13225    3         LOGON_REC_ON = LSTACK_RESULTS_VEC.PTR$ -> LSTACK(L);
     3134    13226    3         LOGON_REC_OFF = LSTACK_RESULTS_VEC.PTR$ -> LSTACK (L+1);
     3135    13227
     3136    13228    3         IF CONSOLE = '?' AND LOCATION ~= '?'
     3137    13229    3           AND LOCATION = LOGON_REC_ON.TERM_NAME THEN PERFORM_CALL = %YES#;
     3138    13230
     3139    13231    3         IF CONSOLE ~= '?' AND LOCATION = '?'
     3140    13232    3           AND CONSOLE = LOGON_REC_ON.STATION.FIRST_HALF THEN PERFORM_CALL = %YES#;
     3141    13233
     3142    13234    3         IF CONSOLE ~= '?' AND LOCATION ~= '?'
     3143    13235    3           AND CONSOLE = LOGON_REC_ON.STATION.FIRST_HALF
     3144    13236    3           AND LOCATION = LOGON_REC_ON.TERM_NAME THEN PERFORM_CALL = %YES#;
     3145    13237
     3146    13238    3         IF LOGON ~= '?' AND LOGON = LOGON_REC_ON.LOGON THEN PERFORM_CALL = %YES#;
     3147    13239
     3148    13240    4         IF WSTATION ~= '?' THEN DO;
     3149    13241    4            CALL INDEX (W, '?', LOGON_REC_ON.WSN);
     3150    13242    4            IF SUBSTR (LOGON_REC_ON.WSN, 0, W) = SUBSTR (WSTATION, 0, W) THEN
             13242                     PERFORM_CALL = %YES#;
     3151    13243    4         END;
     3152    13244
     3153    13245    3         IF LOGON_REPORT AND ALL THEN PERFORM_CALL = %YES#;
     3154    13246
     3155    13247    4         IF PERFORM_CALL THEN DO;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:102  
     3156    13248    4            PERFORM_CALL = %NO#;
     3157    13249    4            IF (LOGON_REC_ON.UTS < BEGINNING_TIME
     3158    13250    4              AND (LOGON_REC_OFF.UTS > ENDING_TIME
     3159    13251    4              OR LOGON_REC_OFF.UTS = 0))
     3160    13252    4              OR
     3161    13253    4              (LOGON_REC_ON.UTS < BEGINNING_TIME
     3162    13254    4              AND LOGON_REC_OFF.UTS < BEGINNING_TIME)
     3163    13255    4              OR
     3164    13256    4              (LOGON_REC_ON.UTS > ENDING_TIME
     3165    13257    4              AND LOGON_REC_OFF.UTS > ENDING_TIME) THEN GOTO NO_MATCH;
     3166    13258
     3167    13259    4            TIME_BUFFER = ' ';
     3168    13260
     3169    13261    4            IF LOGON_REC_ON.UTS >= BEGINNING_TIME
     3170    13262    5              AND LOGON_REC_ON.UTS <= ENDING_TIME THEN DO;
     3171    13263    5               RANGE_CONV.TSTAMP_ = VECTOR (LOGON_REC_ON.UTS);
     3172    13264    6               CALL M$TIME (RANGE_CONV) WHENALTRETURN DO; END;
     3173    13265    5               IF LOGON_REC_ON.STATUS = 1
     3174    13266    5               THEN CALL INSERT (TIME_BUFFER, 35, 8, 'PRERANGE');
     3175    13267    5               ELSE CALL INSERT (TIME_BUFFER, 35, 14,
     3176    13268    5                 SUBSTR (SIM_TIME, 0, 5), ' ', SIM_DATE);
     3177    13269    5            END;
     3178    13270
     3179    13271    4            IF LOGON_REC_ON.UTS < BEGINNING_TIME THEN
     3180    13272    4            CALL INSERT (TIME_BUFFER, 35, 8, 'PRERANGE');
     3181    13273
     3182    13274    4            IF LOGON_REC_ON.UTS > ENDING_TIME THEN
     3183    13275    4            CALL INSERT (TIME_BUFFER, 35, 9, 'POSTRANGE');
     3184    13276
     3185    13277    4            IF LOGON_REC_OFF.UTS >= BEGINNING_TIME
     3186    13278    5              AND LOGON_REC_OFF.UTS <= ENDING_TIME THEN DO;
     3187    13279    5               RANGE_CONV.TSTAMP_ = VECTOR (LOGON_REC_OFF.UTS);
     3188    13280    6               CALL M$TIME (RANGE_CONV) WHENALTRETURN DO; END;
     3189    13281    5               CALL INSERT (TIME_BUFFER, 57, 14, SUBSTR (SIM_TIME, 0, 5), ' ', SIM_DATE
             13281                        );
     3190    13282    5            END;
     3191    13283
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:103  
     3192    13284    4            IF LOGON_REC_OFF.UTS < BEGINNING_TIME
     3193    13285    4            THEN CALL INSERT (TIME_BUFFER, 57, 8, 'PRERANGE');
     3194    13286
     3195    13287    4            IF LOGON_REC_OFF.UTS > ENDING_TIME
     3196    13288    4              OR LOGON_REC_OFF.UTS = 0 THEN CALL INSERT (TIME_BUFFER, 57, 9,
             13288                       'POSTRANGE');
     3197    13289
     3198    13290    4            WRITE_TIME.BUF_.BOUND =
     3199    13291    4              LENGTHC (LOGON_REC_ON.STATION.FIRST_HALF)
     3200    13292    4              + LENGTHC ('@')
     3201    13293    4              + LENGTHC (LOGON_REC_ON.TERM_NAME)
     3202    13294    4              + LENGTHC (LOGON_REC_ON.LOGON)
     3203    13295    4              + LENGTHC ('  ')
     3204    13296    4              + LENGTHC (SUBSTR (SIM_TIME, 0, 5))
     3205    13297    4              + LENGTHC (SIM_DATE)
     3206    13298    4              + LENGTHC ('      ')
     3207    13299    4              + LENGTHC (SUBSTR (SIM_TIME, 0, 5))
     3208    13300    4              + LENGTHC (SIM_DATE);
     3209    13301
     3210    13302    4            PRINT_FLAG = %YES#;
     3211    13303
     3212    13304    4            CALL INSERT (TIME_BUFFER, 0, 8, LOGON_REC_ON.LOGON);
     3213    13305    4            CALL INSERT (TIME_BUFFER, 15, 13, LOGON_REC_ON.STATION.FIRST_HALF, '@',
             13305                     LOGON_REC_ON.TERM_NAME);
     3214    13306    4            WRITE_TIME.BUF_.BOUND = 70;
     3215    13307    5            CALL M$WRITE (WRITE_TIME) WHENALTRETURN DO; END;
     3216    13308    4         END;
     3217    13309    3   NO_MATCH: ;
     3218    13310    3      END;
     3219    13311    2   END DISPLAY_LOGONS;
     3220    13312        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:104  
     3221    13313
     3222    13314         /*           S U B R O U T I N E   G A T H E R _ C _ S T A T S
             13314                      */
     3223    13315
     3224    13316    1   GATHER_C_STATS: PROC;
     3225    13317    2      IF OCL_HIST_BUF.TYPE < 2 THEN RETURN;
     3226    13318
     3227    13319    3      IF FIRST_TIME THEN DO;
     3228    13320    3         KEYIN_TOTAL = 0;
     3229    13321    3         CINDEX = 0;
     3230    13322    3         GOTO SKIP_TEST;
     3231    13323    3      END;
     3232    13324
     3233    13325    2      FOUND_IT = %NO#;
     3234    13326    3      DO C = 0 TO CINDEX;
     3235    13327    3         CONS_RECORD = CSTACK_RESULTS_VEC.PTR$ -> CSTACK (C);
     3236    13328
     3237    13329    3         IF OCL_HIST_BUF.DEVNM = CONS_RECORD.DEVNM
     3238    13330    4           AND OCL_HIST_BUF.TERMINAL = CONS_RECORD.TERMINAL THEN DO;
     3239    13331    4            KEYIN_TOTAL = KEYIN_TOTAL + 1;
     3240    13332    4            CONS_RECORD.KEYINS = CONS_RECORD.KEYINS + 1;
     3241    13333    4            CSTACK_RESULTS_VEC.PTR$ -> CSTACK (C) = CONS_RECORD;
     3242    13334    4            FOUND_IT = %YES#;
     3243    13335    4         END;
     3244    13336    3      END;
     3245    13337
     3246    13338    2   SKIP_TEST:;
     3247    13339    3      IF C_FREE_SPACE < 20 THEN DO;
     3248    13340    3         C_PAGES = C_PAGES + 1;
     3249    13341    3         C_FREE_SPACE = 1024;
     3250    13342    4         CALL M$GDS (GET_C_PAGE) WHENALTRETURN DO; END;
     3251    13343    3      END;
     3252    13344
     3253    13345    2      IF FIRST_TIME THEN GOTO SKIP_TEST2;
     3254    13346
     3255    13347    3      IF NOT FOUND_IT THEN DO;
     3256    13348    3         CINDEX = CINDEX + 1;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:105  
     3257    13349    3   SKIP_TEST2:
     3258    13350    3         FIRST_TIME = %NO#;
     3259    13351    3         CONS_RECORD.LOGON = OCL_HIST_BUF.LOGON;
     3260    13352    3         CONS_RECORD.DEVNM = OCL_HIST_BUF.DEVNM;
     3261    13353    3         CONS_RECORD.TERMINAL = OCL_HIST_BUF.TERMINAL;
     3262    13354    3         CONS_RECORD.KEYINS = 1;
     3263    13355    3         KEYIN_TOTAL = KEYIN_TOTAL + 1;
     3264    13356    3         CSTACK_RESULTS_VEC.PTR$ -> CSTACK (CINDEX) = CONS_RECORD;
     3265    13357    3         C_FREE_SPACE = C_FREE_SPACE - 5;
     3266    13358    3      END;
     3267    13359    2   END GATHER_C_STATS;
     3268    13360        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:106  
     3269    13361
     3270    13362         /*
     3271    13363                   S U B R O U T I N E   D I S P L A Y _ C O N S O L E S
     3272    13364                                           */
     3273    13365    1   DISPLAY_CONSOLES: PROC;
     3274    13366    2      LOGON_TITLE = ' ';
     3275    13367    2      CALL INSERT (LOGON_TITLE, 2, 6, 'LOGON');
     3276    13368    2      CALL INSERT (LOGON_TITLE, 18, 7, 'CONSOLE');
     3277    13369    2      CALL INSERT (LOGON_TITLE, 34, 10, 'NUM KEYINS');
     3278    13370    2      CALL INSERT (LOGON_TITLE, 52, 3, 'PCT');
     3279    13371
     3280    13372    2      MSG = ' ';
     3281    13373
     3282    13374    2      MSG = LOGON_TITLE;
     3283    13375    2      OUT_MSG.BUF_.BOUND = 70;
     3284    13376    3      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;
     3285    13377
     3286    13378    3      DO C = 0 TO CINDEX;
     3287    13379    3         CONS_RECORD = CSTACK_RESULTS_VEC.PTR$ -> CSTACK(C);
     3288    13380    3         MSG = ' ';
     3289    13381    3         CALL CONCAT (MSG, CONS_RECORD.LOGON);
     3290    13382    3         CALL INSERT (MSG,15,13,CONS_RECORD.DEVNM,'@',CONS_RECORD.TERMINAL);
     3291    13383    3         CALL BINCHAR (TEXT_VAR, CONS_RECORD.KEYINS);
     3292    13384    3         CALL EDITCHAR (TEXT_VAR, 0, 8, MOP_8_DIGITS, TEXT_VAR);
     3293    13385    3         CALL INSERT (MSG, 35, 8, TEXT_VAR);
     3294    13386    3         IF (CONS_RECORD.KEYINS / KEYIN_TOTAL) = 1
     3295    13387    3         THEN CALL INSERT (MSG, 50, 8, '100.000%');
     3296    13388    4         ELSE DO;
     3297    13389    4            PCT = CONS_RECORD.KEYINS * 100;
     3298    13390    4            PCT = PCT / KEYIN_TOTAL;
     3299    13391    4            CALL BINCHAR (TEXT_VAR, PCT);
     3300    13392    4            CALL EDITCHAR (TEXT_VAR, 0, 8, MOP_8_DIGITS, TEXT_VAR);
     3301    13393    4            CALL INDEX1R (W, ' ', TEXT_VAR);
     3302    13394    4            IF LENGTHC (TEXT_VAR) - (W+1) = 1
     3303    13395    4            THEN CALL INSERT (MSG, 52, (LENGTHC (TEXT_VAR) - W), SUBSTR (TEXT_VAR, W+1,
             13395                     (LENGTHC (TEXT_VAR) - W)));
     3304    13396    4            ELSE CALL INSERT (MSG, 51, (LENGTHC (TEXT_VAR) - W), SUBSTR (TEXT_VAR, W+1,
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:107  
             13396                     (LENGTHC (TEXT_VAR) - W)));
     3305    13397
     3306    13398    4            PCT = ((CONS_RECORD.KEYINS * 100000) / KEYIN_TOTAL)
     3307    13399    4              - ((((CONS_RECORD.KEYINS * 100000) / KEYIN_TOTAL)
     3308    13400    4              / 1000) * 1000);
     3309    13401    4            CALL BINCHAR (TEXT_VAR, PCT);
     3310    13402    4            CALL EDITCHAR (TEXT_VAR, 0, 8, MOP_8_DIGITS_3, TEXT_VAR);
     3311    13403    4            CALL INDEX1R (W, ' ', TEXT_VAR);
     3312    13404    4            CALL INSERT (MSG, 53, 3 + LENGTHC ('.') + LENGTHC ('%'), '.', SUBSTR (
             13404                     TEXT_VAR, W+1, 3), '%');
     3313    13405    4         END;
     3314    13406
     3315    13407    3         PRINT_FLAG = %YES#;
     3316    13408    4         CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;
     3317    13409    3      END;
     3318    13410    2      CALL BINCHAR (TEXT_VAR, KEYIN_TOTAL);
     3319    13411    2      CALL EDITCHAR (TEXT_VAR, 0, 8, MOP_8_DIGITS, TEXT_VAR);
     3320    13412    2      MSG = ' ';
     3321    13413    2      CALL INSERT (MSG, 19, 24, '***TOTAL KEYINS ', TEXT_VAR);
     3322    13414    3      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;
     3323    13415    2   END DISPLAY_CONSOLES;
     3324    13416    1   END ORR$REPLAY;
     3325    13417        %EOD;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:108  
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XUW_MACRO_C.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XUR_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   OR_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OR_PERR_C.:E05TOU  is referenced.
   OCP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OCM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OCL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OUT_SUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   ORR_SUBS_C.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ORR$REPLAY.

   Procedure ORR$REPLAY requires 5092 words for executable code.
   Procedure ORR$REPLAY requires 18 words of local(AUTO) storage.

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:109  

 Object Unit name= ORR$REPLAY                                 File name= ORR$REPLAY.:E05TOU
 UTS= JUL 30 '97 04:14:33.76 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none  1606   3106  ORR$REPLAY
    2   DCB   even  none     0      0  M$IN
    3   DCB   even  none     0      0  M$CSCG
    4   DCB   even  none     0      0  M$LO
    5   DCB   even  none     0      0  M$SI
    6   DCB   even  none     0      0  F$HISTFILE
    7   DCB   even  none     0      0  F$TEMPLATE
    8  RoData even  UTS    113    161  ORR$REPLAY
    9   Proc  even  none  5092  11744  ORR$REPLAY
   10  RoData even  none    52     64  ORR$REPLAY

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     9      0   yes            yes      Main       0  ORR$REPLAY

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1    756  REM_START                          1   1214  ORR_UNMASK
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:110  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          Async      0 ORR$ABRKRTN
         yes          Async      0 XUR$BREAK
         yes          Async      0 ORR$AXCONRTN
 yes     yes           Std       6 XUR$GETCMD
         yes           Std       0 ORR$XCONRTN
 yes     yes           Std       1 XUR$MOREMSG
         yes           Std       0 ORR$BRKRTN
 yes     yes           Std       4 XUR$SETDCBS
 yes     yes           Std       1 XUR$HELP
 yes     yes           Std       1 X$WILDCMP
 yes     yes           Std       1 XUR$ECHOIF
 yes     yes           Std       1 XUR$ALLMSG
         yes           Std       0 ORR$BRKMSG
 yes     yes           Std       2 XTX$ADAPT
 yes     yes           Std       3 XUR$INIT
 yes     yes           Std       2 XUR$ERRPTR
 yes     yes           Std       2 OCM$TPSET
 yes     yes           Std       7 XUR$ERRMSG
 yes     yes           Std       3 XUD$UTS_ADJUST
         yes           Std       0 XUR$DISABLE
         yes           Std       0 XUR$ENABLE
                       nStd      0 X66_MAUTO
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_MARET
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:111  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OC_INTMSG                             OC_MESSBUF
     OC_MSGBUFFER                          OC_PARAM                              OC_CONSOLE$
     OC_DIR                                OC_INTBIT                             OC_MASK
     OC_MSG_GOOD                           OCL_STATUS_REC                        OCL_STATUS_KEY
     OCL_NORM_KEY                          OCL_HIST_BUF                          OCL_CONSOLE_KEY
     OCL_CONSOLE_REC                       OCM_BPOSN                             OCM_BUFFER
     OCM_PROMPT                            OCM_TSTAMP                            OCM_WSN
     OCM_KEY_FLAG                          OCP_FREE_HEAD                         OCP_USED_HEAD
     OCP_USED_TAIL                         OCHIST_FLAG                           OR_BRK_FLAG
     OR_XCON_FLAG                          OR_OK_TO_BREAK                        M$IN
     M$CSCG                                M$LO                                  M$SI
     F$HISTFILE                            F$TEMPLATE                            B_VERSION
     B$JIT$                                B$TCB$                                REPLAY_NODES
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:112  


        1        1        /*M* ORR$REPLAY USER REPLAY TOOL MAIN PROCEDURE */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*     PLM=3,SQB=Y,AND=Y,ENI=0,SDI=3,MCL=10,CSI=0,ECI=0,IND=0,IAD=3,MOC=Y   */
        8        8        %SET LISTSUB = '1'B;
        9        9
       10       10        /*
       11       11          ###  ####  ####    #   ####  ##### ####  #      ###  #   #
       12       12         # # # #   # #   #  ###  #   # #     #   # #     #   # #   #
       13       13         # # # #   # #   # # #   #   # #     #   # #     #   #  # #
       14       14         #  ## ####  ####   ###  ####  ####  ####  #     #####   #
       15       15         #   # # #   # #     # # # #   #     #     #     #   #   #
       16       16         #   # #  #  #  #   ###  #  #  #     #     #     #   #   #
       17       17          ###  #   # #   #   #   #   # ##### #     ##### #   #   #
       18       18                                                                       */
       19       19
       20       20        ORR$REPLAY: PROC MAIN;

     20  9 000000   000000 700200 xent  ORR$REPLAY   TSX0  ! X66_MAUTO
         9 000001   000022 000000                    ZERO    18,0

       21       21
       22       22        /*P*      NAME: REPLAY TOOL
       23       23                  PURPOSE: Replay entries from operators console
       24       24                  DESCRIPTION: Operator can keyin requests to the
       25       25                                 replay tool, which supplies the
       26       26                                 operator with previously logged
       27       27                                 operator entries.
       28       28        */
       29       29        /*D*      NAME: ORR$REPLAY
       30       30                  CALL: None - main procedure
       31       31                  INTERFACE: ORR$
       32       32                  DESCRIPTION: This is the main program for the user
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:113  
       33       33                                 REPLAY TOOL.  It can supply the operator
       34       34                                 with previously logged entries to the
       35       35                                 :OCHIST file.
       36       36        */
       37       37        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:114  
       38       38        /*  CP-6 system include files                                                 */
       39       39
       40       40        %INCLUDE CP_6;
       41      121        %INCLUDE CP_6_SUBS;
       42      661
       43      662 S      %INCLUDE B$JIT_C;
       44      663        %INCLUDE B_ERRORS_C;
       45     1790        %INCLUDE B_SEGIDS_C;
       46     2329        %INCLUDE B_MICROPS_C;
       47     2501
       48     2502        /*  Include files belonging to Keyin and Replay... FCG="O?"                   */
       49     2503
       50     2504        %INCLUDE ORR_SUBS_C;
       51     2556        %INCLUDE OCI_SUBS_C;
       52     2654        %INCLUDE OUT_SUBS_C;
       53     2777        %INCLUDE OC_DAT_R;
       54     2938        %INCLUDE OC_SUBS_C;
       55     3669        %INCLUDE OCL_DATA_R;
       56     3694
       57     3695        %INCLUDE OCM_DATA_R;
       58     3708
       59     3709        %INCLUDE OCP_DATA_R;
       60     3726        %INCLUDE OR_PERR_C;
       61     3775        %INCLUDE OR_DAT_R;
       62     3785        %INCLUDE OC_MESSHD_C;
       63     3838
       64     3839        /* Library include files                                                      */
       65     3840
       66     3841        %INCLUDE XUR_ENTRY;
       67     3873        %INCLUDE XU_MACRO_C;
       68     6979        %INCLUDE XUH_MACRO_C;
       69     7063        %INCLUDE XUW_MACRO_C;
       70     7198        %INCLUDE XU_PERR_C;
       71     7389        %INCLUDE XUD_UTS_M;
       72     7471        %XUD$UTS_ENTRIES;
       73     7503        %XUD_UTS_EQU;
       74     7514
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:115  
       75     7515        %XUH_PARAM (STCLASS=STATIC,
       76     7516         PROCNAME=HELP_NAME,
       77     7517         PROCACCT=HELP_ACCT,
       78     7518         OUTDCB1=M$LO,
       79     7519         OUTDCB2=M$LO);
       80     7580
       81     7581        %B$JIT0;                                /* First section of JIT.              */
       82     7670        %U$JIT1;                                /* User area of JIT. Must
       83     7671                                                      be entered in ascending
       84     7672                                                      order until desired area
       85     7673                                                      of JIT is found. This
       86     7674                                                      area of JIT is where the
       87     7675                                                      default for language is
       88     7676                                                      placed.                         */
       89     7750        %A$JIT6X;                               /* Dummy accounting area
       90     7751                                                      (i.e. end of JIT).              */
       91     7754
       92     7755        %B$TCB;                                 /* Generates based structure
       93     7756                                                      for TCB.                        */
       94     7759        %B$ALT;                                 /* Generates based structure
       95     7760                                                      of the altret frame of
       96     7761                                                      the TCB.                        */
       97     7769
       98     7770        %F$DCB;
       99     7827
      100     7828
      101     7829        %XUR_INIT (PCB=P_PCB,
      102     7830         BRKMSG=ORR$BRKMSG,
      103     7831         ABORT=ORR$ABRKRTN);                    /* Macro invocation. Used to
      104     7832                                                initialize things (e.g.
      105     7833                                                an EPTR if XUR$BREAK is
      106     7834                                                going to handle breaks)
      107     7835                                                for the XUR$GETCMD rtns. It
      108     7836                                                is called by XUR$INIT.                */
      109     7935
      110     7936                                                /* If the PCB is to be assigned on
      111     7937                                                   the fly, assign it in the follow-
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:116  
      112     7938                                                   ing manner:
      113     7939                                                      XUR_INIT.PCB$ = ADDR (P_PCB)    */
      114     7940
      115     7941
      116     7942        %PARSE$OUT (NAME=OUT$BLK,STCLASS=BASED);
      117     7987        %PARSE$SYM (NAME=OUT$SYM,STCLASS=BASED);
      118     8025
      119     8026        %OC_MESSHD_W (NAME=OR_MESSBUF,
      120     8027         DELIM=";");
      121     8040
      122     8041        %XUW_WILDCARD (FPTN=XUW_WILDCARD,STCLASS=STATIC);
      123     8137        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:117  
      124     8138
      125     8139                                                /*
      126     8140                                                     %DCBS
      127     8141                                                                                        */
      128     8142    1   DCL M$IN DCB;
      129     8143    1   DCL M$CSCG DCB;
      130     8144    1   DCL M$LO DCB;
      131     8145    1   DCL M$SI DCB;
      132     8146    1   DCL F$HISTFILE DCB;                     /* DCB for :ochist.                   */
      133     8147    1   DCL F$TEMPLATE DCB;                     /* DCB for :ocmsg.                    */
      134     8148
      135     8149    1   DCL OCM$TPSET ENTRY(2) ALTRET;          /* Format routine.                    */
      136     8150    1   DCL ORR$BRKMSG ENTRY;                   /* Print "Break at... C to continue:" */
      137     8151    1   DCL ORR$BRKRTN ENTRY;                   /* Handle (possibly defered) break.   */
      138     8152    1   DCL ORR$XCONRTN ENTRY;                  /* Clean up on exit                   */
      139     8153    1   DCL ORR$ABRKRTN ENTRY ASYNC;            /* Async entry to break routine       */
      140     8154    1   DCL ORR$AXCONRTN ENTRY ASYNC;           /* Async entry to XCON routine        */
      141     8155
      142     8156    1   DCL X$HELP ENTRY(1) ALTRET;
      143     8157    1   DCL X$WILDCMP ENTRY(1) ALTRET;
      144     8158
      145     8159    1   DCL CMD_INSTR CHAR(0) STATIC INIT (':');
      146     8160
      147     8161    1   DCL OUT$ PTR STATIC;                    /* Entry of parse tree.               */
      148     8162        %VLP_ERRCODE (FPTN=OUT_ERROR,STCLASS="REDEF OUT$");
      149     8207    1   DCL PTR$ PTR STATIC;                    /* 2 levels below out$.               */
      150     8208    1   DCL LISTPTR$ PTR STATIC;                /* 1 level below out$                 */
      151     8209    1   DCL LSTACK_PTR$ PTR STATIC;
      152     8210    1   DCL ASTACK_PTR$ PTR STATIC;
      153     8211    1   DCL TPTR$ PTR STATIC;
      154     8212    1   DCL SR_PTR$ PTR STATIC;
      155     8213
      156     8214    1   DCL TEMP_UTS UBIN AUTO;
      157     8215        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:118  
      158     8216
      159     8217         /*
      160     8218                  A R G U M E N T S
      161     8219                                                */
      162     8220
      163     8221    1   DCL HOUR1 CHAR(2) STATIC INIT ('00');
      164     8222    1   DCL MIN1 CHAR(2) STATIC INIT ('00');
      165     8223    1   DCL SEC1 CHAR(2) STATIC INIT ('00');
      166     8224    1   DCL CENTISEC1 CHAR(2) STATIC INIT ('00');
      167     8225
      168     8226    1   DCL MONTH1 CHAR(2) STATIC INIT ('00');
      169     8227    1   DCL DAY1 CHAR(2) STATIC INIT ('00');
      170     8228    1   DCL YEAR1 CHAR(2) STATIC INIT ('78');
      171     8229
      172     8230    1   DCL HOUR2 CHAR(2) STATIC INIT ('00');
      173     8231    1   DCL MIN2 CHAR(2) STATIC INIT ('00');
      174     8232    1   DCL SEC2 CHAR(2) STATIC INIT ('00');
      175     8233    1   DCL CENTISEC2 CHAR(2) STATIC INIT ('00');
      176     8234
      177     8235    1   DCL MONTH2 CHAR(2) STATIC INIT ('00');
      178     8236    1   DCL DAY2 CHAR(2) STATIC INIT ('00');
      179     8237    1   DCL YEAR2 CHAR(2) STATIC INIT ('00');
      180     8238
      181     8239
      182     8240    1   DCL IND SBIN WORD STATIC;
      183     8241    1   DCL HERE SBIN WORD STATIC;
      184     8242
      185     8243    1   DCL THOLD UBIN WORD STATIC;
      186     8244    1   DCL VALID_CHECK (0:1) REDEF THOLD CHAR(2);
      187     8245
      188     8246    1   DCL DCB# UBIN WORD STATIC;
      189     8247    1   DCL I SBIN WORD STATIC;
      190     8248    1   DCL X SBIN WORD STATIC;
      191     8249
      192     8250    1   DCL SUBS2 SBIN WORD STATIC;
      193     8251    1   DCL SUBS1 SBIN WORD STATIC;
      194     8252
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:119  
      195     8253    1   DCL DESTINATION CHAR(31) STATIC INIT (' ');
      196     8254    1   DCL ASNFID CHAR (20) STATIC;
      197     8255    1   DCL TXTFD CHAR (100) STATIC;
      198     8256    1   DCL CONSOLE CHAR(4) STATIC INIT ('?   ');
      199     8257    1   DCL LOCATION CHAR(8) STATIC INIT ('?       ');
      200     8258    1   DCL LANGUAGE CHAR(1) STATIC INIT (' ');
      201     8259    1   DCL WSTATION CHAR(8) STATIC INIT ('?       ');
      202     8260    1   DCL LOGON CHAR(8) STATIC INIT ('?       ');
      203     8261    1   DCL BEGINNING_TIME UBIN WORD STATIC;
      204     8262    1   DCL ENDING_TIME UBIN WORD STATIC;
      205     8263    1   DCL ENDING_TIME_REDEF REDEF ENDING_TIME BIT(36);
      206     8264    1   DCL DATE_BUF (0:2) CHAR (2) STATIC;
      207     8265    1   DCL TIME_BUF (0:3) CHAR (2) STATIC;
      208     8266
      209     8267    1   DCL PRINT_FLAG BIT(1) STATIC;
      210     8268    1   DCL PRINTED_TIME UBIN WORD STATIC;
      211     8269
      212     8270    1   DCL UTSTAMP UBIN WORD STATIC;
      213     8271    1   DCL FPT_DATE CHAR(6) STATIC;
      214     8272    1   DCL FPT_TIME CHAR(8) STATIC INIT('00000000');
      215     8273    1   DCL INBUF CHAR(256) STATIC;
      216     8274
      217     8275    1   DCL SIM_DATE CHAR(8) STATIC;
      218     8276    1   DCL SIM_TIME CHAR(11) STATIC;
      219     8277
      220     8278    1   DCL TO_UTS_DATE CHAR(8) STATIC;
      221     8279    1   DCL TO_UTS_TIME CHAR(11) STATIC;
      222     8280
      223     8281    1   DCL MSG CHAR(256) STATIC;
      224     8282    1   DCL 1 B_VERSION CALIGNED SYMREF,
      225     8283    1          2 L UBIN BYTE UNAL,
      226     8284    1          2 C CHAR(6);
      227     8285    1   DCL 1 B_VERSION_ CALIGNED BASED,
      228     8286    1          2 L UBIN BYTE UNAL,
      229     8287    1          2 C CHAR(B_VERSION.L);
      230     8288
      231     8289    1   DCL 1 TEXTC BASED,
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:120  
      232     8290    1          2 C UBIN BYTE UNAL,
      233     8291    1          2 TEXT CHAR(TEXTC.C);
      234     8292
      235     8293    1   DCL OUT_BUFFER CHAR(256) STATIC;
      236     8294    1   DCL TIME_BUFFER CHAR(72) STATIC;
      237     8295
      238     8296    1   DCL OPERATOR_ENTERED_TIME1 BIT (1) STATIC INIT ('0'B);
      239     8297    1   DCL OPERATOR_ENTERED_DATE1 BIT (1) STATIC INIT ('0'B);
      240     8298    1   DCL OPERATOR_ENTERED_TIME2 BIT (1) STATIC INIT ('0'B);
      241     8299    1   DCL OPERATOR_ENTERED_DATE2 BIT (1) STATIC INIT ('0'B);
      242     8300
      243     8301    1   DCL YR UBIN WORD STATIC;
      244     8302    1   DCL MON UBIN WORD STATIC;
      245     8303    1   DCL DAY UBIN WORD STATIC;
      246     8304    1   DCL HR UBIN WORD STATIC;
      247     8305    1   DCL MIN UBIN WORD STATIC;
      248     8306
      249     8307    1   DCL STK_INDEX SBIN WORD STATIC INIT (0);
      250     8308    1   DCL KEEP_ON_LISTING BIT (1) STATIC;
      251     8309    1   DCL A_SPECIFIC_FILE BIT (1) STATIC;
      252     8310    1   DCL WAIT_TIMES# UBIN WORD STATIC INIT (0);
      253     8311    1   DCL ALL BIT(1) STATIC;
      254     8312    1   DCL LINDEX SBIN WORD STATIC INIT (0);
      255     8313    1   DCL L SBIN WORD STATIC ;
      256     8314    1   DCL USE_LINDEX BIT(1) STATIC;
      257     8315    1   DCL LRECS UBIN WORD UNAL STATIC;
      258     8316    1   DCL A_INDEX UBIN WORD STATIC;
      259     8317    1   DCL A UBIN WORD STATIC;
      260     8318    1   DCL SOME_ON_STACK UBIN WORD STATIC;
      261     8319    1   DCL DIRECT BIT(1) STATIC;
      262     8320    1   DCL PERFORM_CALL BIT(1) STATIC;
      263     8321    1   DCL TYPE CHAR (8) STATIC INIT('?');
      264     8322    1   DCL IP_LOC_TYPE CHAR(8) STATIC INIT ('?');
      265     8323    1   DCL IP_ATTR_TYPE BIT(18) STATIC;
      266     8324    1   DCL PREFIX BIT(1) STATIC INIT ('1'B);
      267     8325    1   DCL TEXT_INDEX UBIN WORD STATIC;
      268     8326    1   DCL FREE_SPACE SBIN WORD STATIC INIT(0);
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:121  
      269     8327    1   DCL PAGES UBIN WORD STATIC INIT(0);
      270     8328    1   DCL LOGON_REPORT BIT(1) STATIC INIT ('0'B);
      271     8329    1   DCL BROKEN_FILE BIT(1) STATIC INIT ('0'B);
      272     8330    1   DCL LOGON_TITLE CHAR(72) STATIC INIT (' ');
      273     8331    1   DCL FOUND_IT BIT(1) STATIC UNAL INIT ('0'B);
      274     8332    1   DCL FIRST_TIME BIT(1) STATIC UNAL INIT ('0'B);
      275     8333    1   DCL C_FREE_SPACE SBIN WORD STATIC ALIGNED INIT (0);
      276     8334    1   DCL C_PAGES UBIN WORD STATIC ALIGNED INIT (0);
      277     8335    1   DCL C UBIN WORD STATIC ALIGNED INIT (0);
      278     8336    1   DCL CINDEX UBIN WORD STATIC ALIGNED INIT (0);
      279     8337    1   DCL KEYIN_TOTAL SBIN WORD STATIC ALIGNED INIT (0);
      280     8338    1   DCL PCT SBIN WORD STATIC ALIGNED INIT (0);
      281     8339    1   DCL CONSOLE_REPORT BIT(1) STATIC UNAL INIT('0'B);
      282     8340    1   DCL WILDCARDING BIT(1) STATIC UNAL INIT ('0'B);
      283     8341    1   DCL TEXT_VAR CHAR(8) STATIC CALIGNED INIT (' ');
      284     8342
      285     8343    1   DCL W UBIN WORD STATIC;
      286     8344    1   DCL NO_FILE BIT(1) STATIC INIT('0'B);
      287     8345    1   DCL WI UBIN WORD STATIC INIT (0);
      288     8346    1   DCL TI UBIN WORD STATIC INIT (0);
      289     8347    1   DCL REM_START REMEMBER STATIC SYMDEF;
      290     8348
      291     8349    1   DCL PARSE_WK (0:100) UBIN WORD STATIC;
      292     8350
      293     8351    1   DCL B$JIT$ PTR SYMREF;
      294     8352    1   DCL B$TCB$ PTR SYMREF;
      295     8353
      296     8354    1   DCL REPLAY_NODES PTR SYMREF;
      297     8355
      298     8356
      299     8357
      300     8358                                                /* Special micro-op instruction used
      301     8359                                                   to suppress leading zeroes         */
      302     8360
      303     8361    1   DCL MOP_8_DIGITS (0:1) BIT(9) CONSTANT INIT(%MVZB7,%MVC1);
      304     8362    1   DCL MOP_8_DIGITS_3 (0:1) BIT(9) CONSTANT INIT (%MVZB5,%MVC3);
      305     8363
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:122  
      306     8364    1   DCL 1 ERROR ALIGNED STATIC,
      307     8365    1          2 FCG BIT (18),
      308     8366    1          2 MON BIT (1),
      309     8367    1          2 ERR# UBIN (14) UNAL,
      310     8368    1          2 SEV UBIN (3) UNAL;
      311     8369
      312     8370    1   DCL 1 SUB_U1 STATIC,
      313     8371    1          2 COUNT UBIN BYTE CALIGNED INIT (25),
      314     8372    1          2 TEXT CHAR (25) CALIGNED;
      315     8373
      316     8374    1   DCL 1 ERR_MSG_FID STATIC,
      317     8375    1          2 COUNT UBIN BYTE CALIGNED INIT (18),
      318     8376    1          2 TEXT CHAR (15) INIT ('OR_PERR_C') CALIGNED;
      319     8377
      320     8378    1   DCL 1 PREV STATIC,
      321     8379    1          2 COUNT UBIN BYTE CALIGNED,
      322     8380    1          2 TXT CHAR(31);
      323     8381
      324     8382    1   DCL 1 PREV_STACK (0:0) BASED,
      325     8383    1          2 COUNT UBIN BYTE CALIGNED,
      326     8384    1          2 TXT CHAR(31) CALIGNED;
      327     8385
      328     8386    1   DCL 1 LOGON_REC_ON STATIC,
      329     8387    1          2 TERM_NAME CHAR(8) CALIGNED,
      330     8388    1          2 WSN CHAR(8) CALIGNED,
      331     8389    1          2 ATTRO BIT(18) HALIGNED,
      332     8390    1          2 LOGON CHAR(8) CALIGNED,
      333     8391    1          2 STATION,
      334     8392    1             3 FIRST_HALF CHAR(4) CALIGNED,
      335     8393    1             3 SECND_HALF CHAR(4) CALIGNED,
      336     8394    1          2 UTS UBIN WORD UNAL,
      337     8395    1          2 STATUS UBIN WORD UNAL;
      338     8396
      339     8397    1   DCL 1 LOGON_REC_OFF STATIC,
      340     8398    1          2 TERM_NAME CHAR(8) CALIGNED,
      341     8399    1          2 WSN CHAR(8) CALIGNED,
      342     8400    1          2 ATTRO BIT(18) HALIGNED,
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:123  
      343     8401    1          2 LOGON CHAR(8) CALIGNED,
      344     8402    1          2 STATION,
      345     8403    1             3 FIRST_HALF CHAR(4) CALIGNED,
      346     8404    1             3 SECND_HALF CHAR(4) CALIGNED,
      347     8405    1          2 UTS UBIN WORD UNAL,
      348     8406    1          2 STATUS UBIN WORD UNAL;
      349     8407
      350     8408    1   DCL 1 ATTR_REC STATIC,
      351     8409    1          2 ATTRO BIT(18) HALIGNED,
      352     8410    1          2 WSN CHAR(8) CALIGNED,
      353     8411    1          2 TERMINAL CHAR(8) CALIGNED,
      354     8412    1          2 STATION,
      355     8413    1             3 FIRST_HALF CHAR(4) CALIGNED,
      356     8414    1             3 SECND_HALF CHAR(4) CALIGNED;
      357     8415
      358     8416    1   DCL 1 CONS_RECORD STATIC,
      359     8417    1          2 LOGON CHAR(8) CALIGNED,
      360     8418    1          2 DEVNM CHAR(4) CALIGNED,
      361     8419    1          2 TERMINAL CHAR(8) CALIGNED,
      362     8420    1          2 KEYINS UBIN BYTE CALIGNED;
      363     8421
      364     8422    1   DCL 1 LSTACK (0:0) BASED,
      365     8423    1          2 TERM_NAME CHAR(8) CALIGNED,
      366     8424    1          2 WSN CHAR(8) CALIGNED,
      367     8425    1          2 ATTRO BIT(18) HALIGNED,
      368     8426    1          2 LOGON CHAR(8) CALIGNED,
      369     8427    1          2 STATION,
      370     8428    1             3 FIRST_HALF CHAR(4) CALIGNED,
      371     8429    1             3 SECND_HALF CHAR(4) CALIGNED,
      372     8430    1          2 UTS UBIN WORD UNAL,
      373     8431    1          2 STATUS UBIN WORD UNAL;
      374     8432
      375     8433    1   DCL 1 ASTACK (0:0) BASED,
      376     8434    1          2 ATTRO BIT(18) HALIGNED,
      377     8435    1          2 WSN CHAR(8) CALIGNED,
      378     8436    1          2 TERMINAL CHAR(8) CALIGNED,
      379     8437    1          2 STATION,
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:124  
      380     8438    1             3 FIRST_HALF CHAR(4) CALIGNED,
      381     8439    1             3 SECND_HALF CHAR(4) CALIGNED;
      382     8440
      383     8441    1   DCL 1 CSTACK (0:0) BASED,
      384     8442    1          2 LOGON CHAR(8) CALIGNED,
      385     8443    1          2 DEVNM CHAR(4) CALIGNED,
      386     8444    1          2 TERMINAL CHAR(8) CALIGNED,
      387     8445    1          2 KEYINS UBIN BYTE CALIGNED;
      388     8446        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:125  
      389     8447        %EQU ORR_ATTR# =10;
      390     8448
      391     8449    1   DCL 1 ORR_UNMASK(0:%ORR_ATTR#) STATIC SYMDEF ALIGNED,
      392     8450    1          2 MASK BIT (18) UNAL INIT (
      393     8451    1    '100000'O /* M_DEVC  */,
      394     8452    1    '044000'O /* M_ADCOM */,
      395     8453    1    '004000'O /* M_COMM  */,
      396     8454    1    '040000'O /* M_ADMIN */,
      397     8455    1    '200000'O /* M_SYS   */,
      398     8456    1    '001000'O /* M_TP */,
      399     8457    1    '0'B*0),
      400     8458    1          2 TERM BIT(1) UNAL INIT (
      401     8459    1    %YES#,                                 /* DEVC                               */
      402     8460    1    %NO#,
      403     8461    1    %NO#,
      404     8462    1    %NO#,
      405     8463    1    %NO#,
      406     8464    1    %NO#,
      407     8465    1    %NO# *0),
      408     8466    1          2 WSN BIT(1) UNAL INIT (
      409     8467    1    %NO#,
      410     8468    1    %YES#,                                 /* ADCOM                              */
      411     8469    1    %NO#,
      412     8470    1    %YES#,                                 /* ADMIN                              */
      413     8471    1    %NO#,
      414     8472    1    %NO#,
      415     8473    1    %NO# *0),
      416     8474    1          2 NM_CT UBIN BYTE ALIGNED INIT (
      417     8475    1    4,                                     /* DEVC                               */
      418     8476    1    5,                                     /* ADCOM                              */
      419     8477    1    4,                                     /* COMM                               */
      420     8478    1    5,                                     /* ADMIN                              */
      421     8479    1    6,                                     /* SYSTEM                             */
      422     8480    1    2,                                     /* TP                                 */
      423     8481    1    0*0),
      424     8482    1          2 NM CHAR(8) UNAL INIT (
      425     8483    1    'DEVC    ',
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:126  
      426     8484    1    'ADCOM   ',
      427     8485    1    'COMM    ',
      428     8486    1    'ADMIN   ',
      429     8487    1    'SYSTEM  ',
      430     8488    1    'TP      ',
      431     8489    1    ' '*0);
      432     8490
      433     8491        %P_PCB (NAME=P_PCB, STCLASS=STATIC);
      434     8690
      435     8691                                                /* "T" parameter for input
      436     8692                                                     and "W" with its WSZ for
      437     8693                                                     work area both default to
      438     8694                                                     1 page each                      */
      439     8695
      440     8696        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:127  
      441     8697         /*
      442     8698                  F P T   D E C L A R A T I O N S
      443     8699                                                */
      444     8700
      445     8701
      446     8702        %FPT_OPEN (FPTN=OPEN_HISTORYE,
      447     8703         NAME=FID_NAME,
      448     8704         ASN=FILE,
      449     8705         ACS=DIRECT,
      450     8706         DCB=F$HISTFILE,
      451     8707         FUN=IN,
      452     8708         SHARE=ALL,
      453     8709         ACCT=SYS,
      454     8710         CTG=YES,
      455     8711         ORG=KEYED);
      456     8820
      457     8821        %VLP_NAME (FPTN=FID_NAME);
      458     8848
      459     8849        %VLP_ACCT (FPTN=SYS,
      460     8850         ACCT=':SYSTAC');
      461     8863
      462     8864        %FPT_CLOSE (FPTN=CLOSE_HISTORYE,
      463     8865         NAME=FID_NAME,
      464     8866         DCB=F$HISTFILE);
      465     8908
      466     8909        %FPT_OPEN (FPTN=OPEN_OCMSG,
      467     8910         NAME=OCMSG,
      468     8911         ASN=FILE,
      469     8912         ACS=SEQUEN,
      470     8913         DCB=F$TEMPLATE,
      471     8914         FUN=IN,
      472     8915         SHARE=ALL,
      473     8916         ACCT=MSGACCT,
      474     8917         ORG=KEYED);
      475     9026
      476     9027        %VLP_NAME (FPTN=OCMSG,
      477     9028         NAME=':OCMSG');
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:128  
      478     9055
      479     9056        %VLP_ACCT (FPTN=MSGACCT,
      480     9057         ACCT=':SYS');
      481     9070
      482     9071        %FPT_CLOSE (FPTN=CLOSE_OCMSG,
      483     9072         DCB=F$TEMPLATE);
      484     9114
      485     9115        %FPT_ERRMSG (FPTN=ERR_FIND_TEMP,
      486     9116         BUF=MSG,
      487     9117         CODE=ERROR,
      488     9118         OUTDCB1=M$LO);
      489     9145
      490     9146        %FPT_ERRMSG (FPTN=GEN_ERR,
      491     9147         INCLCODE=NO,
      492     9148         BUF=MSG,
      493     9149         CODE=MODULE_ERR,
      494     9150         OUTDCB1=M$LO);
      495     9177
      496     9178        %VLP_ERRCODE (FPTN=MODULE_ERR,
      497     9179         FCG="'1722'O",
      498     9180         MID="'22'O");
      499     9225
      500     9226        %FPT_ERR (FPTN=ERR_GETTING_CMD,
      501     9227         CODE=OUT_ERROR,
      502     9228         STEPCC=ERROR);
      503     9243
      504     9244        %FPT_WRITE (FPTN=OUT_MSG,
      505     9245         DCB=M$LO,
      506     9246         BUF=MSG,
      507     9247         WAIT=YES);
      508     9278
      509     9279        %FPT_PROMPT (FPTN=PROMPT_IN,
      510     9280         PROMPT=CMD_INSTR);
      511     9308
      512     9309        %FPT_CLOSE (FPTN=CLOSE_OUT,
      513     9310         DCB=M$LO);
      514     9352
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:129  
      515     9353        %FPT_READ (FPTN=READ_HISTORYE,
      516     9354         BUF=OCL_HIST_BUF,
      517     9355         DCB=F$HISTFILE,
      518     9356         KEY=OCL_NORM_KEY,
      519     9357         KEYR=YES,
      520     9358         WAIT=YES);
      521     9397
      522     9398        %FPT_READ (FPTN=READ_CONSOLE_REC,
      523     9399         BUF=OCL_CONSOLE_REC,
      524     9400         DCB=F$HISTFILE,
      525     9401         KEY=OCL_CONSOLE_KEY,
      526     9402         KEYR=YES,
      527     9403         WAIT=YES);
      528     9442
      529     9443
      530     9444        %FPT_READ (FPTN=READ_STATUS,
      531     9445         BUF=OCL_STATUS_REC,
      532     9446         DCB=F$HISTFILE,
      533     9447         KEY=OCL_STATUS_KEY,
      534     9448         KEYR=YES,
      535     9449         WAIT=YES);
      536     9488
      537     9489        %FPT_GDS (FPTN=STACK_SEG,
      538     9490         RESULTS=GDS_RESULTS_VEC,
      539     9491         SEGSIZE=8);
      540     9507
      541     9508        %VLP_VECTOR (FPTN=GDS_RESULTS_VEC,
      542     9509         SEGID='0000'O);
      543     9524
      544     9525        %FPT_FDS (FPTN=RELEASE_SEG,
      545     9526         RESULTS=FDS_RESULTS_VEC,
      546     9527         SEGSIZE=8);
      547     9542
      548     9543        %VLP_VECTOR (FPTN=FDS_RESULTS_VEC,
      549     9544         SEGID='0000'O);
      550     9559
      551     9560        %FPT_WRITE (FPTN=WRITE_HIST_BUF_MESS,
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:130  
      552     9561         BUF=OUT_BUFFER,
      553     9562         DCB=M$LO,
      554     9563         WAIT=YES);
      555     9594
      556     9595        %FPT_GDS (FPTN=GET_LSTACK_SEG,
      557     9596         RESULTS=LSTACK_RESULTS_VEC,
      558     9597         SEGSIZE=1024);
      559     9613
      560     9614        %VLP_VECTOR (FPTN=LSTACK_RESULTS_VEC,
      561     9615         SEGID='0000'O);
      562     9630
      563     9631        %FPT_FDS (FPTN=FREE_LSTACK_SEG,
      564     9632         RESULTS=LSTACK_RESULTS_VEC,
      565     9633         SEGSIZE=1024);
      566     9648
      567     9649        %FPT_GDS (FPTN=GET_ATTR_SEG,
      568     9650         RESULTS=ASTACK_RESULTS_VEC,
      569     9651         SEGSIZE=1024);
      570     9667
      571     9668        %VLP_VECTOR (FPTN=ASTACK_RESULTS_VEC,
      572     9669         SEGID='0000'O);
      573     9684
      574     9685        %FPT_FDS (FPTN=FREE_ASTACK_SEG,
      575     9686         RESULTS=ASTACK_RESULTS_VEC,
      576     9687         SEGSIZE=1024);
      577     9702
      578     9703        %FPT_GDS (FPTN=GET_C_PAGE,
      579     9704         RESULTS=CSTACK_RESULTS_VEC,
      580     9705         SEGSIZE=1024);
      581     9721
      582     9722        %VLP_VECTOR (FPTN=CSTACK_RESULTS_VEC,
      583     9723         SEGID='0000'O);
      584     9738
      585     9739        %FPT_FDS (FPTN=FREE_C_PAGE,
      586     9740         RESULTS=CSTACK_RESULTS_VEC,
      587     9741         SEGSIZE=1024);
      588     9756
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:131  
      589     9757        %FPT_PRECORD (FPTN=HIST_POSITION,
      590     9758         DCB=F$HISTFILE,
      591     9759         KEY=OCL_NORM_KEY,
      592     9760         KEYR=YES,
      593     9761         KEYS=YES);
      594     9782
      595     9783        %FPT_TIME (FPTN=TIME_CONV,
      596     9784         DATE=FPT_DATE,
      597     9785         TIME=FPT_TIME,
      598     9786         DEST=UTS,
      599     9787         SOURCE=ANS,
      600     9788         TSTAMP=UTSTAMP);
      601     9807
      602     9808        %FPT_TIME (FPTN=TIME_SET,
      603     9809         DATE=DATE_BUF,
      604     9810         TIME=TIME_BUF,
      605     9811         DEST=ANS,
      606     9812         SOURCE=UTS);
      607     9831
      608     9832        %FPT_TIME (FPTN=TIME_SIMULATION,
      609     9833         DATE=SIM_DATE,
      610     9834         TIME=SIM_TIME,
      611     9835         DEST=LOCAL,
      612     9836         SOURCE=UTS,
      613     9837         TSTAMP=OCL_NORM_KEY.UTS);
      614     9856
      615     9857        %FPT_WRITE (FPTN=WRITE_TIME,
      616     9858         BUF=TIME_BUFFER,
      617     9859         DCB=M$LO,
      618     9860         WAIT=YES);
      619     9891
      620     9892        %FPT_TIME (FPTN=TIME_TO_UTS,
      621     9893         DATE=TO_UTS_DATE,
      622     9894         TIME=TO_UTS_TIME,
      623     9895         DEST=UTS,
      624     9896         SOURCE=LOCAL,
      625     9897         TSTAMP=PRINTED_TIME);
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:132  
      626     9916
      627     9917        %FPT_INT (FPTN=BREAK_IN,
      628     9918         UENTRY=XUR$BREAK);
      629     9932        %FPT_OPEN (FPTN=CS_OPEN,
      630     9933         DCB=M$CSCG,
      631     9934         ASN=COMGROUP,
      632     9935         SETSTA=KSST,
      633     9936         FUN=UPDATE,
      634     9937         SHARE=ALL,
      635     9938         ACCT=CSACCT,
      636     9939         NAME=CSCGNM);
      637    10048
      638    10049        %VLP_NAME (FPTN=CSCGNM,
      639    10050         NAME='CSCG');
      640    10077
      641    10078        %VLP_SETSTA (FPTN=KSST,
      642    10079         STCLASS=STATIC,
      643    10080         MYSTATION='RE      ');
      644    10108
      645    10109        %VLP_ACCT (FPTN=CSACCT,
      646    10110         ACCT=':SYS');
      647    10123
      648    10124        %FPT_WRITE (FPTN=WRITE_CS,
      649    10125         DCB=M$CSCG,
      650    10126         STATION=STA,
      651    10127         BP=YES,
      652    10128         BUF=OR_MESSBUF);
      653    10159
      654    10160        %VLP_STATION (FPTN=STA,
      655    10161         STATION='KEYIN');
      656    10188
      657    10189        %FPT_PRECORD (FPTN=FIRST_HIST_REC,
      658    10190         DCB=F$HISTFILE,
      659    10191         KEYS=NO);
      660    10212
      661    10213        %FPT_CLOSE (FPTN=CS_CLOSE,
      662    10214         DCB=M$CSCG);
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:133  
      663    10256
      664    10257        %FPT_WAIT (FPTN=WAIT_HIST,
      665    10258         UNITS=1);
      666    10272
      667    10273        %FPT_PFIL (FPTN=POSITION_AT_END,
      668    10274         DCB=F$HISTFILE,
      669    10275         BOF=NO);
      670    10290
      671    10291        %FPT_UNFID (FPTN=GET_DCB_INFO,
      672    10292         DCB=M$SI,
      673    10293         ASN=ASNFID,
      674    10294         TEXTFID=TXTFD,
      675    10295         NAME=FID_NAME);
      676    10313
      677    10314        %FPT_XCON (FPTN=ABNORMAL_EXIT,
      678    10315         UENTRY=ORR$AXCONRTN);
      679    10329
      680    10330        %FPT_FID (FPTN=FID_DEST,
      681    10331         NAME=DEST_NAME,
      682    10332         RES=OPEN_DEST.V.RES#,
      683    10333         ACCT=DEST_ACCT,
      684    10334         PASS=DEST_PASS,
      685    10335         ASN=OPEN_DEST.V.ASN#,
      686    10336         WSN=DEST_WSN,
      687    10337         SNAME=YES,
      688    10338         SACCT=YES,
      689    10339         SPASS=YES,
      690    10340         SWSN=YES,
      691    10341         SRES=YES,
      692    10342         SSN=YES,
      693    10343         RESULTS=DEST_RESULTS);
      694    10366
      695    10367        %VLP_NAME (FPTN=DEST_NAME);
      696    10394
      697    10395        %VLP_WSN (FPTN=DEST_WSN);
      698    10408
      699    10409        %VLR_FID (FPTN=DEST_RESULTS);
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:134  
      700    10428
      701    10429        %VLP_ACCT (FPTN=DEST_ACCT);
      702    10442
      703    10443        %VLP_PASS (FPTN=DEST_PASS);
      704    10456
      705    10457        %FPT_OPEN (FPTN=OPEN_LO,
      706    10458         ORG=UR,
      707    10459         DCB=M$LO);
      708    10568
      709    10569        %FPT_OPEN (FPTN=OPEN_DEST,
      710    10570         DCB=M$LO,
      711    10571         SCRUB=YES,
      712    10572         NAME=DEST_NAME,
      713    10573         ACCT=DEST_ACCT,
      714    10574         PASS=DEST_PASS,
      715    10575         CTG=YES,
      716    10576         EXIST=NEWFILE,
      717    10577         WSN=DEST_WSN);
      718    10686
      719    10687        %FPT_CLOSE (FPTN=CLOSE_LO,
      720    10688         DCB=M$LO,
      721    10689         DISP=SAVE);
      722    10731
      723    10732        %FPT_TIME (FPTN=RANGE_CONV,
      724    10733         DATE=SIM_DATE,
      725    10734         TIME=SIM_TIME,
      726    10735         DEST=LOCAL,
      727    10736         SOURCE=UTS);
      728    10755
      729    10756        %FPT_XCON (FPTN=RESET_XCON);
      730    10770
      731    10771        %VLP_NAME (FPTN=HELP_NAME,
      732    10772         NAME='REPLAY');
      733    10799
      734    10800        %VLP_ACCT (FPTN=HELP_ACCT,
      735    10801         ACCT=':SYS');
      736    10814
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:135  
      737    10815        %FPT_PRIV (FPTN=FMPRIV,
      738    10816         PPRIV=YES,
      739    10817         PRIV=%PPR_REPLAY#);
      740    10832        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:136  
      741    10833         /*
      742    10834                  - O R R $ R E P L A Y -
      743    10835
      744    10836                  M A I N   P R O G R A M
      745    10837                                                */
      746    10838
      747    10839    1      CALL XUR$INIT (XUR_INIT);

  10839  9 000002   000000 630400 10                 EPPR0   0
         9 000003   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000004   000000 701000 xent               TSX1    XUR$INIT
         9 000005   000000 011000                    NOP     0

      748    10840
      749    10841                                                /* XUR_INIT is in XU_MACRO_C.
      750    10842                                                   It is used to int aspects of
      751    10843                                                   XUR$GETCMD.  If XUR$BREAK is
      752    10844                                                   used, you must specify an
      753    10845                                                   EPTR of the abort rtn.
      754    10846                                                          */
      755    10847
      756    10848    2      CALL M$SPRIV (FMPRIV) WHENALTRETURN DO;

  10848  9 000006   003062 630400 1                  EPPR0   FMPRIV
         9 000007   420012 713400                    CLIMB   alt,+8202
         9 000010   400000 401760                    pmme    nvectors=1
         9 000011   000013 702000 9                  TSX2    s:10853
         9 000012   000037 710000 9                  TRA     s:10861

      757    10849
      758    10850        /*E* ERROR: ORR-E_PRIVERR#-7
      759    10851             MESSAGE: Sorry, you have insufficient privilege to run REPLAY.
      760    10852        */
      761    10853    2         MODULE_ERR.ERR# = 40 /* E_PRIVERR# */;

  10853  9 000013   001670 236000 1                  LDQ     MODULE_ERR
         9 000014   000001 376000 10                 ANQ     1
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:137  
         9 000015   000500 276007                    ORQ     320,DL
         9 000016   001670 756000 1                  STQ     MODULE_ERR

      762    10854    2         MODULE_ERR.SEV = 0;

  10854  9 000017   000002 236000 10                 LDQ     2
         9 000020   001670 356000 1                  ANSQ    MODULE_ERR

      763    10855    2         CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  10855  9 000021   000000 236007 xsym               LDQ     M$LO,DL
         9 000022   200014 756100                    STQ     IOPT+7,,AUTO
         9 000023   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 000024   200017 450500                    STP0    IOPT+10,,AUTO
         9 000025   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 000026   200016 756100                    STQ     IOPT+9,,AUTO
         9 000027   000003 236000 10                 LDQ     3
         9 000030   200015 756100                    STQ     IOPT+8,,AUTO
         9 000031   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 000032   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 000033   000000 701000 xent               TSX1    XUR$ERRMSG
         9 000034   000000 011000                    NOP     0

      764    10856    2         CALL M$XXX;

  10856  9 000035   000003 713400                    CLIMB   3
         9 000036   000000 401760                    pmme    nvectors=0

      765    10857    2      END;

      766    10858
      767    10859        /* Get language default, other stuff from the jit.                            */
      768    10860
      769    10861    1      LANGUAGE = B$JIT$ -> B$JIT.LANG;

  10861  9 000037   000000 470400 xsym               LDP0    B$JIT$
         9 000040   000145 236100                    LDQ     101,,PR0
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:138  
         9 000041   000033 736000                    QLS     27
         9 000042   000004 276000 10                 ORQ     4
         9 000043   000273 756000 1                  STQ     LANGUAGE

      770    10862    1      CALL BINCHAR (TEXT_VAR, B$JIT$ -> B$JIT.SYSID);

  10862  9 000044   000000 236100                    LDQ     0,,PR0
         9 000045   777777 376007                    ANQ     -1,DL
         9 000046   000000 235003                    LDA     0,DU
         9 000047   200014 757100                    STAQ    IOPT+7,,AUTO
         9 000050   000000 301500                    BTD
         9 000051   200014 000010                    NDSC9   IOPT+7,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         9 000052   000747 030010 1                  NDSC9   TEXT_VAR                 cn=0,s=nosgn,sf=0,n=8

      771    10863    1      CALL INSERT (KSST.MYSTATION#, 2, 6, SUBSTR (TEXT_VAR, 2, 6));

  10863  9 000053   040000 100400                    MLR     fill='040'O
         9 000054   000747 400006 1                  ADSC9   TEXT_VAR                 cn=2,n=6
         9 000055   002352 400006 1                  ADSC9   KSST                     cn=2,n=6

      772    10864
      773    10865    1      CALL M$PROMPT (PROMPT_IN);

  10865  9 000056   001714 630400 1                  EPPR0   PROMPT_IN
         9 000057   160002 713400                    CLIMB   57346
         9 000060   401000 401760                    pmme    nvectors=3

      774    10866
      775    10867                                                /* Set terminal input
      776    10868                                                     prompt.                          */
      777    10869
      778    10870
      779    10871    1      REMEMBER INITIALIZE IN REM_START;

  10871  9 000061   000145 635000 9                  EAA     INITIALIZE
         9 000062   000756 452400 1                  STP2    REM_START
         9 000063   000757 755000 1                  STA     REM_START+1
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:139  

      780    10872
      781    10873                                                /* XUR$BREAK calls ORR$BRKRTN
      782    10874                                                     if user chooses not to
      783    10875                                                     continue after being
      784    10876                                                     prompted.                        */
      785    10877
      786    10878    1      CALL M$INT (BREAK_IN) ALTRET (CANT_CALL_INT);

  10878  9 000064   002252 630400 1                  EPPR0   BREAK_IN
         9 000065   410002 713400                    CLIMB   alt,+4098
         9 000066   400000 401760                    pmme    nvectors=1
         9 000067   002127 702000 9                  TSX2    CANT_CALL_INT

      787    10879
      788    10880                                                /* Assign XUR$BREAK to process
      789    10881                                                   breaks.                            */
      790    10882
      791    10883    1      CALL M$XCON (ABNORMAL_EXIT) ALTRET (CANT_CALL_XCON);

  10883  9 000070   002524 630400 1                  EPPR0   ABNORMAL_EXIT
         9 000071   410003 713400                    CLIMB   alt,+4099
         9 000072   400400 401760                    pmme    nvectors=2
         9 000073   002471 702000 9                  TSX2    CANT_CALL_XCON

      792    10884
      793    10885                                                /* In case of abnormal ending
      794    10886                                                     go to ORR$XCONRTN                */
      795    10887
      796    10888    1      CALL XUR$SETDCBS (DCBNUM (M$IN), DCBNUM (M$LO));

  10888  9 000074   000000 236007 xsym               LDQ     M$IN,DL
         9 000075   200014 756100                    STQ     IOPT+7,,AUTO
         9 000076   000000 236007 xsym               LDQ     M$LO,DL
         9 000077   200014 235100                    LDA     IOPT+7,,AUTO
         9 000100   200015 755100                    STA     IOPT+8,,AUTO
         9 000101   200016 756100                    STQ     IOPT+9,,AUTO
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:140  
         9 000102   200016 630500                    EPPR0   IOPT+9,,AUTO
         9 000103   200021 450500                    STP0    IOPT+12,,AUTO
         9 000104   200015 631500                    EPPR1   IOPT+8,,AUTO
         9 000105   200020 451500                    STP1    IOPT+11,,AUTO
         9 000106   200020 630500                    EPPR0   IOPT+11,,AUTO
         9 000107   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 000110   000000 701000 xent               TSX1    XUR$SETDCBS
         9 000111   000000 011000                    NOP     0

      797    10889                                                /* Check if M$LO was opened via
      798    10890                                                     an entry on the line which
      799    10891                                                     invoked REPLAY. If not,
      800    10892                                                     open it.                         */
      801    10893
      802    10894                                                /* Set DCBs for XUR$GETCMD            */
      803    10895
      804    10896    1      CALL CONCAT(MSG,'REPLAY ',ADDR(B_VERSION)->B_VERSION_.C,' here');

  10896  9 000112   000000 236000 xsym               LDQ     B_VERSION
         9 000113   000033 772000                    QRL     27
         9 000114   040000 100400                    MLR     fill='040'O
         9 000115   000002 000007 8                  ADSC9   MOP_8_DIGITS_3+1         cn=0,n=7
         9 000116   000427 000007 1                  ADSC9   MSG                      cn=0,n=7
         9 000117   000000 620006                    EAX0    0,QL
         9 000120   040000 100440                    MLR     fill='040'O
         9 000121   000000 200010 xsym               ADSC9   B_VERSION                cn=1,n=*X0
         9 000122   000430 600371 1                  ADSC9   MSG+1                    cn=3,n=249
         9 000123   000371 116007                    CMPQ    249,DL
         9 000124   000132 603000 9                  TRC     s:10897
         9 000125   777406 621006                    EAX1    -250,QL
         9 000126   777777 661003                    ERX1    -1,DU
         9 000127   040046 100400                    MLR     fill='040'O
         9 000130   000004 000005 8                  ADSC9   MOP_8_DIGITS_3+3         cn=0,n=5
         9 000131   000430 600011 1                  ADSC9   MSG+1,Q                  cn=3,n=*X1

      805    10897    1      OUT_MSG.BUF_.BOUND = 12 + B_VERSION.L;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:141  
  10897  9 000132   000014 036007                    ADLQ    12,DL
         9 000133   000020 736000                    QLS     16
         9 000134   001704 676000 1                  ERQ     OUT_MSG+4
         9 000135   000034 376000 xsym               ANQ     B_VECTNIL+28
         9 000136   001704 656000 1                  ERSQ    OUT_MSG+4

      806    10898    2      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;

  10898  9 000137   001700 630400 1                  EPPR0   OUT_MSG
         9 000140   440001 713400                    CLIMB   alt,write
         9 000141   401400 401760                    pmme    nvectors=4
         9 000142   000144 702000 9                  TSX2    s:10905
         9 000143   000144 710000 9                  TRA     s:10905

      807    10899
      808    10900                                                /* Label "INITIALIZE" represents the
      809    10901                                                   point of return following <BREAK>
      810    10902                                                   command processing.  All necessary
      811    10903                                                   clean-up should happen here.       */
      812    10904
      813    10905    2      DO WHILE (%NO#);

  10905  9 000144   000226 710000 9                  TRA     s:10947

  10898  9 000145                       INITIALIZE   null
      814    10906    2   INITIALIZE:;
      815    10907
      816    10908                                                /* Release file-name stack, and
      817    10909                                                   (re) initialize ptr.               */
      818    10910
      819    10911    2         FDS_RESULTS_VEC.PTR$ = GDS_RESULTS_VEC.PTR$;

  10911  9 000145   002045 236000 1                  LDQ     GDS_RESULTS_VEC+1
         9 000146   002055 756000 1                  STQ     FDS_RESULTS_VEC+1

      820    10912    2         RELEASE_SEG.V.SEGSIZE# = (STK_INDEX * 8) + LENGTHW (PREV);

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:142  
  10912  9 000147   000662 235000 1                  LDA     STK_INDEX
         9 000150   000003 735000                    ALS     3
         9 000151   000010 620005                    EAX0    8,AL
         9 000152   002052 440000 1                  SXL0    RELEASE_SEG+4

      821    10913    3         CALL M$FDS (RELEASE_SEG) WHENALTRETURN DO; END;

  10913  9 000153   002046 630400 1                  EPPR0   RELEASE_SEG
         9 000154   430002 713400                    CLIMB   alt,fds
         9 000155   400400 401760                    pmme    nvectors=2
         9 000156   000160 702000 9                  TSX2    s:10915
         9 000157   000160 710000 9                  TRA     s:10915

      822    10914
      823    10915    2         STK_INDEX = 0;

  10915  9 000160   000662 450000 1                  STZ     STK_INDEX

      824    10916    2         RELEASE_SEG.V.SEGSIZE# = LENGTHW(PREV);

  10916  9 000161   000010 220003                    LDX0    8,DU
         9 000162   002052 440000 1                  SXL0    RELEASE_SEG+4

      825    10917    2         GDS_RESULTS_VEC.PTR$ = ADDR (NIL);

  10917  9 000163   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 000164   002045 756000 1                  STQ     GDS_RESULTS_VEC+1

      826    10918
      827    10919                                                /* Release attribute stack, and
      828    10920                                                   (re) initialize ptr.               */
      829    10921
      830    10922    3         CALL M$FDS (FREE_ASTACK_SEG) WHENALTRETURN DO; END;

  10922  9 000165   002120 630400 1                  EPPR0   FREE_ASTACK_SEG
         9 000166   430002 713400                    CLIMB   alt,fds
         9 000167   400400 401760                    pmme    nvectors=2
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:143  
         9 000170   000172 702000 9                  TSX2    s:10924
         9 000171   000172 710000 9                  TRA     s:10924

      831    10923
      832    10924    2         ASTACK_RESULTS_VEC = VECTOR (NIL);

  10924  9 000172   000006 237000 10                 LDAQ    6
         9 000173   002116 757000 1                  STAQ    ASTACK_RESULTS_VEC

      833    10925
      834    10926                                                /* Release logon stack, and
      835    10927                                                   (re) initialize ptr.               */
      836    10928
      837    10929    2         FREE_LSTACK_SEG.V.SEGSIZE# = PAGES * 1024;

  10929  9 000174   000710 235000 1                  LDA     PAGES
         9 000175   000012 735000                    ALS     10
         9 000176   000000 620005                    EAX0    0,AL
         9 000177   002106 440000 1                  SXL0    FREE_LSTACK_SEG+4

      838    10930    3         CALL M$FDS (FREE_LSTACK_SEG) WHENALTRETURN DO; END;

  10930  9 000200   002102 630400 1                  EPPR0   FREE_LSTACK_SEG
         9 000201   430002 713400                    CLIMB   alt,fds
         9 000202   400400 401760                    pmme    nvectors=2
         9 000203   000205 702000 9                  TSX2    s:10932
         9 000204   000205 710000 9                  TRA     s:10932

      839    10931
      840    10932    2         PAGES = 0;

  10932  9 000205   000710 450000 1                  STZ     PAGES

      841    10933    2         LSTACK_RESULTS_VEC.PTR$ = ADDR(NIL);

  10933  9 000206   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 000207   002101 756000 1                  STQ     LSTACK_RESULTS_VEC+1
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:144  

      842    10934
      843    10935                                                /* Release console stack (used in
      844    10936                                                   keyin tabulating), and
      845    10937                                                   (re) initialize ptr.               */
      846    10938
      847    10939    2         FREE_C_PAGE.V.SEGSIZE# = C_PAGES * 1024;

  10939  9 000210   000740 235000 1                  LDA     C_PAGES
         9 000211   000012 735000                    ALS     10
         9 000212   000000 620005                    EAX0    0,AL
         9 000213   002142 440000 1                  SXL0    FREE_C_PAGE+4

      848    10940    3         CALL M$FDS (FREE_C_PAGE) WHENALTRETURN DO; END;

  10940  9 000214   002136 630400 1                  EPPR0   FREE_C_PAGE
         9 000215   430002 713400                    CLIMB   alt,fds
         9 000216   400400 401760                    pmme    nvectors=2
         9 000217   000221 702000 9                  TSX2    s:10942
         9 000220   000221 710000 9                  TRA     s:10942

      849    10941
      850    10942    2         C_PAGES = 0;

  10942  9 000221   000740 450000 1                  STZ     C_PAGES

      851    10943    2         FIRST_TIME = %YES#;

  10943  9 000222   400000 236003                    LDQ     -131072,DU
         9 000223   000736 756000 1                  STQ     FIRST_TIME

      852    10944    2         CSTACK_RESULTS_VEC = VECTOR (NIL);

  10944  9 000224   000006 237000 10                 LDAQ    6
         9 000225   002134 757000 1                  STAQ    CSTACK_RESULTS_VEC

      853    10945    2      END;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:145  

      854    10946
      855    10947    1      IF NOT DCBADDR(DCBNUM(M$LO))->F$DCB.FCD#

  10947  9 000226   000000 236007 xsym               LDQ     M$LO,DL
         9 000227   000005 470400 10                 LDP0    5
         9 000230   000000 471500                    LDP1    0,,PR0
         9 000231   100000 473506                    LDP3    0,QL,PR1
         9 000232   300031 236100                    LDQ     25,,PR3
         9 000233   020000 316007                    CANQ    8192,DL
         9 000234   000241 601000 9                  TNZ     s:10949

      856    10948    1      THEN CALL M$OPEN (OPEN_LO) ALTRET (CANT_OPEN_LO);

  10948  9 000235   002612 630400 1                  EPPR0   OPEN_LO
         9 000236   450000 713400                    CLIMB   alt,open
         9 000237   410400 401760                    pmme    nvectors=18
         9 000240   002536 702000 9                  TSX2    CANT_OPEN_LO

      857    10949    1      ERROR.ERR# = 0;

  10949  9 000241   000001 236000 10                 LDQ     1
         9 000242   001125 356000 1                  ANSQ    ERROR

      858    10950    1      NO_FILE = %NO#;

  10950  9 000243   000752 450000 1                  STZ     NO_FILE

  10950  9 000244                       SELECTIONS   null
      859    10951
      860    10952        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:146  
      861    10953        /*           M A I N   P R O C E S S I N G   L O O P                          */
      862    10954
      863    10955    1   SELECTIONS:;
      864    10956    2      CALL XUR$GETCMD( REPLAY_NODES, OUT$, VECTOR(CMD_INSTR)) WHENALTRETURN DO;

  10956  9 000244   000012 630400 10                 EPPR0   10
         9 000245   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 000246   000000 701000 xent               TSX1    XUR$GETCMD
         9 000247   000251 702000 9                  TSX2    s:10958
         9 000250   000330 710000 9                  TRA     s:10974

      865    10957
      866    10958    2         ERROR = OUT_ERROR;

  10958  9 000251   000165 236000 1                  LDQ     OUT$
         9 000252   001125 756000 1                  STQ     ERROR

      867    10959
      868    10960    3         IF OUT_ERROR.ERR# = %E$SYNERR THEN DO;

  10960  9 000253   000165 236000 1                  LDQ     OUT$
         9 000254   377770 376007                    ANQ     131064,DL
         9 000255   000010 116007                    CMPQ    8,DL
         9 000256   000301 601000 9                  TNZ     s:10965

      869    10961    3            CALL XUR$ECHOIF (DCBNUM(M$LO));

  10961  9 000257   000000 236007 xsym               LDQ     M$LO,DL
         9 000260   200014 756100                    STQ     IOPT+7,,AUTO
         9 000261   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 000262   200015 450500                    STP0    IOPT+8,,AUTO
         9 000263   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 000264   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000265   000000 701000 xent               TSX1    XUR$ECHOIF
         9 000266   000000 011000                    NOP     0

      870    10962    3            CALL XUR$ERRPTR (,DCBNUM(M$LO));
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:147  

  10962  9 000267   000000 236007 xsym               LDQ     M$LO,DL
         9 000270   200014 756100                    STQ     IOPT+7,,AUTO
         9 000271   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 000272   200017 450500                    STP0    IOPT+10,,AUTO
         9 000273   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 000274   200016 756100                    STQ     IOPT+9,,AUTO
         9 000275   200016 630500                    EPPR0   IOPT+9,,AUTO
         9 000276   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 000277   000000 701000 xent               TSX1    XUR$ERRPTR
         9 000300   000000 011000                    NOP     0

      871    10963    3         END;

      872    10964
      873    10965    2         CALL XUR$ERRMSG (OUT_ERROR,,DCBNUM(M$LO)) ALTRET (CANT_CALL_XUR_ERRMSG);

  10965  9 000301   000000 236007 xsym               LDQ     M$LO,DL
         9 000302   200014 756100                    STQ     IOPT+7,,AUTO
         9 000303   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 000304   200017 450500                    STP0    IOPT+10,,AUTO
         9 000305   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 000306   200016 756100                    STQ     IOPT+9,,AUTO
         9 000307   000013 236000 10                 LDQ     11
         9 000310   200015 756100                    STQ     IOPT+8,,AUTO
         9 000311   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 000312   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 000313   000000 701000 xent               TSX1    XUR$ERRMSG
         9 000314   002174 702000 9                  TSX2    CANT_CALL_XUR_ERRMSG

      874    10966
      875    10967    2         IF OUT_ERROR.ERR# = %E$EOF

  10967  9 000315   000165 236000 1                  LDQ     OUT$
         9 000316   377770 376007                    ANQ     131064,DL
         9 000317   000060 116007                    CMPQ    48,DL
         9 000320   000324 600000 9                  TZE     s:10969
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:148  
         9 000321   000165 236000 1                  LDQ     OUT$
         9 000322   400000 316007                    CANQ    -131072,DL
         9 000323   000327 600000 9                  TZE     s:10971

      876    10968    2           OR OUT_ERROR.MON
      877    10969    2         THEN CALL M$ERR(ERR_GETTING_CMD);

  10969  9 000324   001672 630400 1                  EPPR0   ERR_GETTING_CMD
         9 000325   000002 713400                    CLIMB   err
         9 000326   400400 401760                    pmme    nvectors=2

      878    10970
      879    10971    2         GOTO SELECTIONS;

  10971  9 000327   000244 710000 9                  TRA     SELECTIONS

      880    10972    2      END;
      881    10973        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:149  
      882    10974    2      DO CASE (OUT$ -> OUT$BLK.CODE);      /* DO COMMAND                         */

  10974  9 000330   000165 470400 1                  LDP0    OUT$
         9 000331   000000 720100                    LXL0    0,,PR0
         9 000332   000021 100003                    CMPX0   17,DU
         9 000333   000335 602010 9                  TNC     s:10974+5,X0
         9 000334   000500 710000 9                  TRA     s:11067
         9 000335   000356 710000 9                  TRA     s:10977
         9 000336   000361 710000 9                  TRA     s:10980
         9 000337   000500 710000 9                  TRA     s:11067
         9 000340   000500 710000 9                  TRA     s:11067
         9 000341   000364 710000 9                  TRA     s:10983
         9 000342   000436 710000 9                  TRA     s:11027
         9 000343   000500 710000 9                  TRA     s:11067
         9 000344   000437 710000 9                  TRA     s:11030
         9 000345   000447 710000 9                  TRA     s:11035
         9 000346   000454 710000 9                  TRA     s:11039
         9 000347   000461 710000 9                  TRA     s:11042
         9 000350   000500 710000 9                  TRA     s:11067
         9 000351   000500 710000 9                  TRA     s:11067
         9 000352   000464 710000 9                  TRA     s:11045
         9 000353   000467 710000 9                  TRA     s:11052
         9 000354   000474 710000 9                  TRA     s:11057
         9 000355   000424 710000 9                  TRA     s:11024

      883    10975
      884    10976    2      CASE (%CMD_SPAN#);

      885    10977    2         CALL DO_TIME;

  10977  9 000356   006120 701000 9                  TSX1    DO_TIME
         9 000357   000000 011000                    NOP     0
         9 000360   000500 710000 9                  TRA     s:11067

      886    10978
      887    10979    2      CASE (%CMD_SELECT#);

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:150  
      888    10980    2         CALL SELECTION_RETRIEVER;

  10980  9 000361   004777 701000 9                  TSX1    SELECTION_RETRIEVER
         9 000362   000000 011000                    NOP     0
         9 000363   000500 710000 9                  TRA     s:11067

      889    10981
      890    10982    2      CASE (%CMD_REPORT#);

      891    10983    2         ERROR.ERR# = 0;

  10983  9 000364   000001 236000 10                 LDQ     1
         9 000365   001125 356000 1                  ANSQ    ERROR

      892    10984    2         CALL SET_DESTINATION;

  10984  9 000366   005663 701000 9                  TSX1    SET_DESTINATION
         9 000367   000000 011000                    NOP     0

      893    10985    2         CALL SET_DEFAULTS;

  10985  9 000370   003145 701000 9                  TSX1    SET_DEFAULTS
         9 000371   000000 011000                    NOP     0

      894    10986    2         CALL CLOBBER_TIME_DEFAULTS;

  10986  9 000372   006563 701000 9                  TSX1    CLOBBER_TIME_DEFAULTS
         9 000373   000000 011000                    NOP     0

      895    10987
      896    10988
      897    10989                                                /* Set pointer to first available
      898    10990                                                     free storage.                    */
      899    10991
      900    10992    2         STK_INDEX = 0;

  10992  9 000374   000662 450000 1                  STZ     STK_INDEX
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:151  

      901    10993    2         CALL OPEN_TO_RANGE;

  10993  9 000375   007152 701000 9                  TSX1    OPEN_TO_RANGE
         9 000376   000000 011000                    NOP     0

      902    10994
      903    10995    2         PAGES = 0;

  10995  9 000377   000710 450000 1                  STZ     PAGES

      904    10996    2         FREE_SPACE = 0;

  10996  9 000400   000707 450000 1                  STZ     FREE_SPACE

      905    10997    2         SOME_ON_STACK = 0;

  10997  9 000401   000675 450000 1                  STZ     SOME_ON_STACK

      906    10998    2         LINDEX = 0;

  10998  9 000402   000667 450000 1                  STZ     LINDEX

      907    10999    2         CALL BUILD_CONSOLE_STACK;

  10999  9 000403   010034 701000 9                  TSX1    BUILD_CONSOLE_STACK
         9 000404   000000 011000                    NOP     0

      908    11000    2         OCL_NORM_KEY.UTS = BEGINNING_TIME;

  11000  9 000405   000000 100400                    MLR     fill='000'O
         9 000406   000300 000004 1                  ADSC9   BEGINNING_TIME           cn=0,n=4
         9 000407   000000 200004 xsym               ADSC9   OCL_NORM_KEY             cn=1,n=4

      909    11001    2         OCL_NORM_KEY.COUNT = 4;

  11001  9 000410   004000 236003                    LDQ     2048,DU
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:152  
         9 000411   000000 552040 xsym               STBQ    OCL_NORM_KEY,'40'O

      910    11002    2         HIST_POSITION.V.N# = 0;

  11002  9 000412   002153 450000 1                  STZ     HIST_POSITION+7

      911    11003    2         OC_MSG_GOOD = %YES#;

  11003  9 000413   400000 236003                    LDQ     -131072,DU
         9 000414   000000 756000 xsym               STQ     OC_MSG_GOOD

      912    11004    2         PRINT_FLAG = %NO#;

  11004  9 000415   000306 450000 1                  STZ     PRINT_FLAG

      913    11005
      914    11006                                                /* Set PRINT_FLAG indicator:
      915    11007                                                     0 means no records were
      916    11008                                                       found for current criteria
      917    11009                                                     1 means at least 1 record
      918    11010                                                       was found                      */
      919    11011
      920    11012    2         PRINTED_TIME = 0;

  11012  9 000416   000307 450000 1                  STZ     PRINTED_TIME

      921    11013
      922    11014                                                /* Initialize hold area for the
      923    11015                                                     simulated print time.            */
      924    11016
      925    11017    2         CALL M$OPEN (OPEN_OCMSG) ALTRET (CANT_OPEN_OCMSG);

  11017  9 000417   001450 630400 1                  EPPR0   OPEN_OCMSG
         9 000420   450000 713400                    CLIMB   alt,open
         9 000421   410400 401760                    pmme    nvectors=18
         9 000422   002420 702000 9                  TSX2    CANT_OPEN_OCMSG

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:153  
      926    11018
      927    11019                                                /* Open template file.                */
      928    11020
      929    11021    2         GOTO DO_LIST;

  11021  9 000423   000526 710000 9                  TRA     DO_LIST

      930    11022
      931    11023    2      CASE (%CMD_NATLANG#);

      932    11024    2         LANGUAGE = OUT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXTC$->TEXTC.TEXT;

  11024  9 000424   000003 471500                    LDP1    3,,PR0
         9 000425   100003 473500                    LDP3    3,,PR1
         9 000426   000100 101500                    MRL     fill='000'O
         9 000427   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         9 000430   200014 000002                    ADSC9   IOPT+7,,AUTO             cn=0,n=2
         9 000431   200014 220100                    LDX0    IOPT+7,,AUTO
         9 000432   040000 100540                    MLR     fill='040'O
         9 000433   300000 200010                    ADSC9   0,,PR3                   cn=1,n=*X0
         9 000434   000273 000001 1                  ADSC9   LANGUAGE                 cn=0,n=1
         9 000435   000500 710000 9                  TRA     s:11067

      933    11025
      934    11026    2      CASE (%CMD_END#);

      935    11027    2         GOTO CLOSE_OUT;

  11027  9 000436   003137 710000 9                  TRA     CLOSE_OUT

      936    11028
      937    11029    2      CASE (%CMD_HELP#);

      938    11030    2         XUH_PARAM.HELP$ = OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXTC$;

  11030  9 000437   000003 471500                    LDP1    3,,PR0
         9 000440   100003 236100                    LDQ     3,,PR1
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:154  
         9 000441   000011 756000 1                  STQ     XUH_PARAM+9

      939    11031    2         CALL XUR$HELP (XUH_PARAM);

  11031  9 000442   000015 630400 10                 EPPR0   13
         9 000443   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000444   000000 701000 xent               TSX1    XUR$HELP
         9 000445   000000 011000                    NOP     0
         9 000446   000500 710000 9                  TRA     s:11067

      940    11032
      941    11033    2      CASE (%CMD_QUESTION1#);

      942    11034
      943    11035    2         CALL XUR$MOREMSG (XUH_PARAM) ALTRET (CANT_HELP);

  11035  9 000447   000015 630400 10                 EPPR0   13
         9 000450   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000451   000000 701000 xent               TSX1    XUR$MOREMSG
         9 000452   000501 702000 9                  TSX2    CANT_HELP
         9 000453   000500 710000 9                  TRA     s:11067

      944    11036
      945    11037    2      CASE (%CMD_QUESTION2#);

      946    11038
      947    11039    2         CALL XUR$ALLMSG (XUH_PARAM) ALTRET (CANT_HELP);

  11039  9 000454   000015 630400 10                 EPPR0   13
         9 000455   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000456   000000 701000 xent               TSX1    XUR$ALLMSG
         9 000457   000501 702000 9                  TSX2    CANT_HELP
         9 000460   000500 710000 9                  TRA     s:11067

      948    11040
      949    11041    2      CASE (%CMD_RESET#);

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:155  
      950    11042    2         CALL DO_RESET;

  11042  9 000461   005235 701000 9                  TSX1    DO_RESET
         9 000462   000000 011000                    NOP     0
         9 000463   000500 710000 9                  TRA     s:11067

      951    11043
      952    11044    2      CASE (%CMD_DISPLAY#);

      953    11045    2         CALL DO_DISPLAY;

  11045  9 000464   005375 701000 9                  TSX1    DO_DISPLAY
         9 000465   000000 011000                    NOP     0
         9 000466   000500 710000 9                  TRA     s:11067

      954    11046
      955    11047                                                /* Set flags, then let REPORT call
      956    11048                                                     set defaults for you             */
      957    11049
      958    11050    2      CASE (%CMD_CREPORT#);

      959    11051
      960    11052    2         CONSOLE_REPORT = %YES#;

  11052  9 000467   400000 236003                    LDQ     -131072,DU
         9 000470   000745 756000 1                  STQ     CONSOLE_REPORT

      961    11053    2         FIRST_TIME = %YES#;

  11053  9 000471   000736 756000 1                  STQ     FIRST_TIME

      962    11054    2         LOGON_REPORT = %NO#;

  11054  9 000472   000711 450000 1                  STZ     LOGON_REPORT
         9 000473   000500 710000 9                  TRA     s:11067

      963    11055
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:156  
      964    11056    2      CASE (%CMD_LREPORT#);

      965    11057    2         LOGON_REPORT = %YES#;

  11057  9 000474   400000 236003                    LDQ     -131072,DU
         9 000475   000711 756000 1                  STQ     LOGON_REPORT

      966    11058    2         CONSOLE_REPORT = %NO#;

  11058  9 000476   000745 450000 1                  STZ     CONSOLE_REPORT
         9 000477   000500 710000 9                  TRA     s:11067

      967    11059
      968    11060    2      CASE (%CMD_NULL#);

      969    11061
      970    11062                                                /* DO NOTHING                         */
      971    11063
      972    11064
      973    11065    2      END;                                 /* End case (out$ -> out$blk.code);   */

      974    11066
      975    11067    2      DO WHILE ('0'B);

  11067  9 000500   000525 710000 9                  TRA     s:11080

  11067  9 000501                       CANT_HELP    null
      976    11068    2   CANT_HELP:;
      977    11069        /*E* ERROR: ORR-E_HELPERR#-7
      978    11070             MESSAGE: No more information.
      979    11071             MESSAGE1: You asked for more messages, but we were unable locate any
      980    11072                       further information about your last help or error message.
      981    11073                       Refer to the CP-6 System Support Reference Manual for more
      982    11074                       information about REPLAY.                                      */
      983    11075    2         ERROR = XUH_PARAM.ERR;

  11075  9 000501   000013 236000 1                  LDQ     XUH_PARAM+11
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:157  
         9 000502   001125 756000 1                  STQ     ERROR

      984    11076    2         MODULE_ERR.ERR# = 34 /* E_HELPERR# */;

  11076  9 000503   001670 236000 1                  LDQ     MODULE_ERR
         9 000504   000001 376000 10                 ANQ     1
         9 000505   000420 276007                    ORQ     272,DL
         9 000506   001670 756000 1                  STQ     MODULE_ERR

      985    11077    2         MODULE_ERR.SEV = 0;

  11077  9 000507   000002 236000 10                 LDQ     2
         9 000510   001670 356000 1                  ANSQ    MODULE_ERR

      986    11078    2         CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO)) ALTRET (CANT_CALL_XUR_ERRMSG);

  11078  9 000511   000000 236007 xsym               LDQ     M$LO,DL
         9 000512   200014 756100                    STQ     IOPT+7,,AUTO
         9 000513   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 000514   200017 450500                    STP0    IOPT+10,,AUTO
         9 000515   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 000516   200016 756100                    STQ     IOPT+9,,AUTO
         9 000517   000003 236000 10                 LDQ     3
         9 000520   200015 756100                    STQ     IOPT+8,,AUTO
         9 000521   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 000522   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 000523   000000 701000 xent               TSX1    XUR$ERRMSG
         9 000524   002174 702000 9                  TSX2    CANT_CALL_XUR_ERRMSG

      987    11079    2      END;

      988    11080    1      GOTO SELECTIONS;

  11080  9 000525   000244 710000 9                  TRA     SELECTIONS

  11068  9 000526                       DO_LIST      null
      989    11081        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:158  
      990    11082    1   DO_LIST:;
      991    11083
      992    11084    1      IF LOGON_REPORT THEN GOTO REPORT_END_POINT;

  11084  9 000526   000711 234000 1                  SZN     LOGON_REPORT
         9 000527   001736 604000 9                  TMI     REPORT_END_POINT

      993    11085
      994    11086    2      CALL M$PRECORD (HIST_POSITION) WHENALTRETURN DO;

  11086  9 000530   002144 630400 1                  EPPR0   HIST_POSITION
         9 000531   440003 713400                    CLIMB   alt,+16387
         9 000532   401000 401760                    pmme    nvectors=3
         9 000533   000535 702000 9                  TSX2    s:11087
         9 000534   000545 710000 9                  TRA     s:11091

      995    11087    2         ERROR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

  11087  9 000535   000000 470400 xsym               LDP0    B$TCB$
         9 000536   000000 471500                    LDP1    0,,PR0
         9 000537   100102 236100                    LDQ     66,,PR1
         9 000540   001125 756000 1                  STQ     ERROR

      996    11088    2         IF ERROR.ERR# ~= %E$NOKEY THEN GOTO CHECK_END;

  11088  9 000541   001125 236000 1                  LDQ     ERROR
         9 000542   377770 376007                    ANQ     131064,DL
         9 000543   001020 116007                    CMPQ    528,DL
         9 000544   001656 601000 9                  TNZ     CHECK_END

      997    11089    2      END;

      998    11090
      999    11091    1      IF HIST_POSITION.V.N# = 0

  11091  9 000545   002153 235000 1                  LDA     HIST_POSITION+7
         9 000546   000551 601000 9                  TNZ     s:11094
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:159  

     1000    11092    1      THEN HIST_POSITION.V.N# = 1;

  11092  9 000547   000001 236007                    LDQ     1,DL
         9 000550   002153 756000 1                  STQ     HIST_POSITION+7

     1001    11093
     1002    11094    1      IF OCL_NORM_KEY.COUNT = 0 THEN GOTO REPORT_END_POINT;

  11094  9 000551   000000 236000 xsym               LDQ     OCL_NORM_KEY
         9 000552   777000 316003                    CANQ    -512,DU
         9 000553   001736 600000 9                  TZE     REPORT_END_POINT

     1003    11095
     1004    11096    1      CALL M$READ (READ_HISTORYE) ALTRET (CHECK_END);

  11096  9 000554   001764 630400 1                  EPPR0   READ_HISTORYE
         9 000555   440000 713400                    CLIMB   alt,read
         9 000556   401400 401760                    pmme    nvectors=4
         9 000557   001656 702000 9                  TSX2    CHECK_END

     1005    11097
     1006    11098                                                /* Read the :ochist file.             */
     1007    11099
     1008    11100    1      IF OCL_NORM_KEY.UTS = 0 THEN GOTO DO_LIST;

  11100  9 000560   000000 235000 xsym               LDA     OCL_NORM_KEY
         9 000561   000001 236000 xsym               LDQ     OCL_NORM_KEY+1
         9 000562   000033 773000                    LRL     27
         9 000563   000000 116003                    CMPQ    0,DU
         9 000564   000526 600000 9                  TZE     DO_LIST

     1009    11101
     1010    11102    1      THOLD = OCL_HIST_BUF.TSTAMP;

  11102  9 000565   000000 235000 xsym               LDA     OCL_HIST_BUF
         9 000566   000214 755000 1                  STA     THOLD
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:160  

     1011    11103
     1012    11104    1      IF VALID_CHECK(0) = 'FR'

  11104  9 000567   000214 220000 1                  LDX0    THOLD
         9 000570   000006 100000 8                  CMPX0   MOP_8_DIGITS_3+5
         9 000571   000526 600000 9                  TZE     DO_LIST
         9 000572   000007 100000 8                  CMPX0   MOP_8_DIGITS_3+6
         9 000573   000526 600000 9                  TZE     DO_LIST

     1013    11105    1        OR VALID_CHECK(0) = 'TO' THEN GOTO DO_LIST;
     1014    11106
     1015    11107                                                /* Valid check redefines thold.       */
     1016    11108    2      IF TYPE ~= '?' THEN DO;

  11108  9 000574   000700 237000 1                  LDAQ    TYPE
         9 000575   000016 117000 10                 CMPAQ   14
         9 000576   000704 600000 9                  TZE     s:11153

     1017    11109    2         IF OCL_HIST_BUF.TYPE ~= 0 THEN GOTO DO_LIST;

  11109  9 000577   000012 236000 xsym               LDQ     OCL_HIST_BUF+10
         9 000600   000777 316007                    CANQ    511,DL
         9 000601   000526 601000 9                  TNZ     DO_LIST

     1018    11110
     1019    11111    2         CALL INDEX (WI, '?', OCL_HIST_BUF.WSN);

  11111  9 000602   000000 124400                    SCM     mask='000'O
         9 000603   000001 000010 xsym               ADSC9   OCL_HIST_BUF+1           cn=0,n=8
         9 000604   000016 000001 10                 ADSC9   14                       cn=0,n=1
         9 000605   000753 000000 1                  ARG     WI

     1020    11112    2         CALL INDEX (TI, '?', OCL_HIST_BUF.TERMINAL);

  11112  9 000606   000000 124400                    SCM     mask='000'O
         9 000607   000010 000010 xsym               ADSC9   OCL_HIST_BUF+8           cn=0,n=8
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:161  
         9 000610   000016 000001 10                 ADSC9   14                       cn=0,n=1
         9 000611   000754 000000 1                  ARG     TI

     1021    11113
     1022    11114    2         IF (IP_ATTR_TYPE & '200000'O /* M_SYS  */)

  11114  9 000612   000704 221000 1                  LDX1    IP_ATTR_TYPE
         9 000613   200000 361003                    ANX1    65536,DU
         9 000614   000632 600000 9                  TZE     s:11123
         9 000615   000012 221000 xsym               LDX1    OCL_HIST_BUF+10
         9 000616   245000 361003                    ANX1    84480,DU
         9 000617   000626 601000 9                  TNZ     s:11118
         9 000620   000012 221000 xsym               LDX1    OCL_HIST_BUF+10
         9 000621   100000 361003                    ANX1    32768,DU
         9 000622   000632 600000 9                  TZE     s:11123
         9 000623   000007 236000 xsym               LDQ     OCL_HIST_BUF+7
         9 000624   000010 116000 8                  CMPQ    MOP_8_DIGITS_3+7
         9 000625   000632 601000 9                  TNZ     s:11123

     1023    11115    2           AND (OCL_HIST_BUF.ATTR & ('200000'O /* M_SYS  */ | '004000'O /* M_COMM */ |
             11115                    '040000'O /* M_ADMIN */ | '001000'O /* M_TP */)
     1024    11116    2           OR (OCL_HIST_BUF.ATTR & '100000'O /* M_DEVC  */ AND (OCL_HIST_BUF.STATION.
             11116                    SECND_HALF = '0000')))
     1025    11117    3         THEN DO;

     1026    11118    3            IF (OCL_HIST_BUF.ATTR & '000040'O /* M_NONSYS */)

  11118  9 000626   000012 221000 xsym               LDX1    OCL_HIST_BUF+10
         9 000627   000040 361003                    ANX1    32,DU
         9 000630   000526 601000 9                  TNZ     DO_LIST

     1027    11119    3            THEN GOTO DO_LIST;
     1028    11120    3            ELSE GOTO CHECK_TIME;

  11120  9 000631   001064 710000 9                  TRA     CHECK_TIME

     1029    11121    3         END;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:162  
     1030    11122
     1031    11123    2         IF IP_ATTR_TYPE & '004000'O /* M_COMM */

  11123  9 000632   000704 221000 1                  LDX1    IP_ATTR_TYPE
         9 000633   004000 361003                    ANX1    2048,DU
         9 000634   000640 600000 9                  TZE     s:11126
         9 000635   000012 221000 xsym               LDX1    OCL_HIST_BUF+10
         9 000636   004000 361003                    ANX1    2048,DU
         9 000637   001064 601000 9                  TNZ     CHECK_TIME

     1032    11124    2           AND (OCL_HIST_BUF.ATTR & '004000'O /* M_COMM */) THEN GOTO CHECK_TIME;
     1033    11125
     1034    11126    2         IF (IP_ATTR_TYPE = '100000'O /* M_DEVC  */)

  11126  9 000640   000704 221000 1                  LDX1    IP_ATTR_TYPE
         9 000641   100000 101003                    CMPX1   32768,DU
         9 000642   000657 601000 9                  TNZ     s:11136
         9 000643   000012 222000 xsym               LDX2    OCL_HIST_BUF+10
         9 000644   100000 362003                    ANX2    32768,DU
         9 000645   000657 600000 9                  TZE     s:11136

     1035    11127    3           AND (OCL_HIST_BUF.ATTR & '100000'O /* M_DEVC  */) THEN DO;

     1036    11128
     1037    11129    3            IF IP_LOC_TYPE = '?' THEN GOTO DO_LIST;

  11129  9 000646   000702 237000 1                  LDAQ    IP_LOC_TYPE
         9 000647   000016 117000 10                 CMPAQ   14
         9 000650   000526 600000 9                  TZE     DO_LIST

     1038    11130
     1039    11131    3            IF SUBSTR (IP_LOC_TYPE, 0, TI) ~= SUBSTR (OCL_HIST_BUF.TERMINAL, 0, TI)

  11131  9 000651   000754 722000 1                  LXL2    TI
         9 000652   040040 106440                    CMPC    fill='040'O
         9 000653   000702 000012 1                  ADSC9   IP_LOC_TYPE              cn=0,n=*X2
         9 000654   000010 000012 xsym               ADSC9   OCL_HIST_BUF+8           cn=0,n=*X2
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:163  
         9 000655   000526 601000 9                  TNZ     DO_LIST

     1040    11132    3            THEN GOTO DO_LIST;
     1041    11133    3            ELSE GOTO CHECK_TIME;

  11133  9 000656   001064 710000 9                  TRA     CHECK_TIME

     1042    11134    3         END;
     1043    11135
     1044    11136    2         IF (IP_ATTR_TYPE & '040000'O /* M_ADMIN */)

  11136  9 000657   040000 361003                    ANX1    16384,DU
         9 000660   000675 600000 9                  TZE     s:11146
         9 000661   000012 221000 xsym               LDX1    OCL_HIST_BUF+10
         9 000662   040000 361003                    ANX1    16384,DU
         9 000663   000675 600000 9                  TZE     s:11146

     1045    11137    3           AND (OCL_HIST_BUF.ATTR & '040000'O /* M_ADMIN */) THEN DO;

     1046    11138
     1047    11139    3            IF IP_LOC_TYPE = '?' THEN GOTO DO_LIST;

  11139  9 000664   000702 237000 1                  LDAQ    IP_LOC_TYPE
         9 000665   000016 117000 10                 CMPAQ   14
         9 000666   000526 600000 9                  TZE     DO_LIST

     1048    11140
     1049    11141    3            IF SUBSTR (IP_LOC_TYPE, 0, WI) ~= SUBSTR (OCL_HIST_BUF.WSN, 0, WI)

  11141  9 000667   000753 721000 1                  LXL1    WI
         9 000670   040040 106440                    CMPC    fill='040'O
         9 000671   000702 000011 1                  ADSC9   IP_LOC_TYPE              cn=0,n=*X1
         9 000672   000001 000011 xsym               ADSC9   OCL_HIST_BUF+1           cn=0,n=*X1
         9 000673   000526 601000 9                  TNZ     DO_LIST

     1050    11142    3            THEN GOTO DO_LIST;
     1051    11143    3            ELSE GOTO CHECK_TIME;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:164  

  11143  9 000674   001064 710000 9                  TRA     CHECK_TIME

     1052    11144    3         END;
     1053    11145
     1054    11146    2         IF (IP_ATTR_TYPE & '001000'O /* M_TP */)

  11146  9 000675   000704 221000 1                  LDX1    IP_ATTR_TYPE
         9 000676   001000 361003                    ANX1    512,DU
         9 000677   000703 600000 9                  TZE     s:11149
         9 000700   000012 221000 xsym               LDX1    OCL_HIST_BUF+10
         9 000701   001000 361003                    ANX1    512,DU
         9 000702   001064 601000 9                  TNZ     CHECK_TIME

     1055    11147    2           AND (OCL_HIST_BUF.ATTR & '001000'O /* M_TP */) THEN GOTO CHECK_TIME;
     1056    11148
     1057    11149    2         GOTO DO_LIST;

  11149  9 000703   000526 710000 9                  TRA     DO_LIST

     1058    11150    2      END;
     1059    11151
     1060    11152
     1061    11153    2      IF NOT ALL THEN DO;

  11153  9 000704   000666 234000 1                  SZN     ALL
         9 000705   001054 604000 9                  TMI     s:11195

     1062    11154    2         CALL M$GDS (GET_ATTR_SEG) ALTRET (NO_SEGS);

  11154  9 000706   002110 630400 1                  EPPR0   GET_ATTR_SEG
         9 000707   430001 713400                    CLIMB   alt,gds
         9 000710   400400 401760                    pmme    nvectors=2
         9 000711   002774 702000 9                  TSX2    NO_SEGS

     1063    11155    2         CALL BUILD_ATTR_STACK;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:165  
  11155  9 000712   010616 701000 9                  TSX1    BUILD_ATTR_STACK
         9 000713   000000 011000                    NOP     0

     1064    11156
     1065    11157    2         IF A_INDEX = 0 THEN GOTO LOSE_IT;

  11157  9 000714   000673 235000 1                  LDA     A_INDEX
         9 000715   001056 600000 9                  TZE     LOSE_IT

     1066    11158    3         DO A = 1 TO (A_INDEX);

  11158  9 000716   000001 236007                    LDQ     1,DL
         9 000717   000674 756000 1                  STQ     A
         9 000720   001051 710000 9                  TRA     s:11192+3

     1067    11159    3            ATTR_REC = ASTACK_RESULTS_VEC.PTR$ -> ASTACK(A);

  11159  9 000721   000674 236000 1                  LDQ     A
         9 000722   000032 402007                    MPY     26,DL
         9 000723   002117 470400 1                  LDP0    ASTACK_RESULTS_VEC+1
         9 000724   000000 100506                    MLR     fill='000'O
         9 000725   000000 000032                    ADSC9   0,Q,PR0                  cn=0,n=26
         9 000726   001177 000032 1                  ADSC9   ATTR_REC                 cn=0,n=26

     1068    11160    3            CALL INDEX (WI, '?', ATTR_REC.WSN);

  11160  9 000727   000000 124400                    SCM     mask='000'O
         9 000730   001177 400010 1                  ADSC9   ATTR_REC                 cn=2,n=8
         9 000731   000016 000001 10                 ADSC9   14                       cn=0,n=1
         9 000732   000753 000000 1                  ARG     WI

     1069    11161    3            CALL INDEX (TI, '?', ATTR_REC.TERMINAL);

  11161  9 000733   000000 124400                    SCM     mask='000'O
         9 000734   001201 400010 1                  ADSC9   ATTR_REC+2               cn=2,n=8
         9 000735   000016 000001 10                 ADSC9   14                       cn=0,n=1
         9 000736   000754 000000 1                  ARG     TI
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:166  

     1070    11162    4            DO CASE (OCL_HIST_BUF.TYPE);

  11162  9 000737   000012 720000 xsym               LXL0    OCL_HIST_BUF+10
         9 000740   000777 360003                    ANX0    511,DU
         9 000741   000004 100003                    CMPX0   4,DU
         9 000742   000744 602010 9                  TNC     s:11162+5,X0
         9 000743   001046 710000 9                  TRA     s:11192
         9 000744   000750 710000 9                  TRA     s:11164
         9 000745   001027 710000 9                  TRA     s:11184
         9 000746   001027 710000 9                  TRA     s:11184
         9 000747   001027 710000 9                  TRA     s:11184

     1071    11163    4            CASE (0);

     1072    11164    4               IF (ATTR_REC.ATTRO & OCL_HIST_BUF.ATTR & ('004000'O /* M_COMM */|
             11164                        '001000'O /* M_TP */)) THEN GOTO CHECK_TIME;

  11164  9 000750   001177 221000 1                  LDX1    ATTR_REC
         9 000751   000012 361000 xsym               ANX1    OCL_HIST_BUF+10
         9 000752   005000 361003                    ANX1    2560,DU
         9 000753   001064 601000 9                  TNZ     CHECK_TIME

     1073    11165
     1074    11166    4               IF (ATTR_REC.ATTRO & OCL_HIST_BUF.ATTR & '100000'O /* M_DEVC  */)

  11166  9 000754   001177 221000 1                  LDX1    ATTR_REC
         9 000755   000012 361000 xsym               ANX1    OCL_HIST_BUF+10
         9 000756   100000 361003                    ANX1    32768,DU
         9 000757   000765 600000 9                  TZE     s:11170
         9 000760   000754 721000 1                  LXL1    TI
         9 000761   040040 106440                    CMPC    fill='040'O
         9 000762   000010 000011 xsym               ADSC9   OCL_HIST_BUF+8           cn=0,n=*X1
         9 000763   001201 400011 1                  ADSC9   ATTR_REC+2               cn=2,n=*X1
         9 000764   001064 600000 9                  TZE     CHECK_TIME

     1075    11167    4                AND (SUBSTR (OCL_HIST_BUF.TERMINAL, 0, TI) = SUBSTR (ATTR_REC.TERMINAL
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:167  
             11167                          , 0, TI))
     1076    11168    4               THEN GOTO CHECK_TIME;
     1077    11169
     1078    11170    4               IF (ATTR_REC.ATTRO & OCL_HIST_BUF.ATTR & '040000'O /* M_ADMIN */)

  11170  9 000765   001177 221000 1                  LDX1    ATTR_REC
         9 000766   000012 361000 xsym               ANX1    OCL_HIST_BUF+10
         9 000767   040000 361003                    ANX1    16384,DU
         9 000770   000776 600000 9                  TZE     s:11174
         9 000771   000753 721000 1                  LXL1    WI
         9 000772   040040 106440                    CMPC    fill='040'O
         9 000773   000001 000011 xsym               ADSC9   OCL_HIST_BUF+1           cn=0,n=*X1
         9 000774   001177 400011 1                  ADSC9   ATTR_REC                 cn=2,n=*X1
         9 000775   001064 600000 9                  TZE     CHECK_TIME

     1079    11171    4                 AND (SUBSTR (OCL_HIST_BUF.WSN, 0, WI) = SUBSTR (ATTR_REC.WSN, 0, WI))
     1080    11172    4               THEN GOTO CHECK_TIME;
     1081    11173
     1082    11174    4               IF (ATTR_REC.ATTRO & '200000'O /* M_SYS  */)

  11174  9 000776   001177 221000 1                  LDX1    ATTR_REC
         9 000777   200000 361003                    ANX1    65536,DU
         9 001000   001026 600000 9                  TZE     s:11174+24
         9 001001   000012 221000 xsym               LDX1    OCL_HIST_BUF+10
         9 001002   000040 361003                    ANX1    32,DU
         9 001003   001026 601000 9                  TNZ     s:11174+24
         9 001004   000012 221000 xsym               LDX1    OCL_HIST_BUF+10
         9 001005   205000 361003                    ANX1    68096,DU
         9 001006   001064 601000 9                  TNZ     CHECK_TIME
         9 001007   000012 221000 xsym               LDX1    OCL_HIST_BUF+10
         9 001010   040000 361003                    ANX1    16384,DU
         9 001011   001017 600000 9                  TZE     s:11174+17
         9 001012   000753 721000 1                  LXL1    WI
         9 001013   040040 106440                    CMPC    fill='040'O
         9 001014   001177 400011 1                  ADSC9   ATTR_REC                 cn=2,n=*X1
         9 001015   000001 000011 xsym               ADSC9   OCL_HIST_BUF+1           cn=0,n=*X1
         9 001016   001064 600000 9                  TZE     CHECK_TIME
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:168  
         9 001017   000012 221000 xsym               LDX1    OCL_HIST_BUF+10
         9 001020   100000 361003                    ANX1    32768,DU
         9 001021   001026 600000 9                  TZE     s:11174+24
         9 001022   040000 106400                    CMPC    fill='040'O
         9 001023   001204 400004 1                  ADSC9   ATTR_REC+5               cn=2,n=4
         9 001024   000007 000004 xsym               ADSC9   OCL_HIST_BUF+7           cn=0,n=4
         9 001025   001064 600000 9                  TZE     CHECK_TIME
         9 001026   001046 710000 9                  TRA     s:11192

     1083    11175    4                 AND NOT (OCL_HIST_BUF.ATTR & '000040'O /* M_NONSYS */)
     1084    11176    4                 AND ( (OCL_HIST_BUF.ATTR & ('200000'O /* M_SYS  */|'004000'O
             11176                          /* M_COMM */|'001000'O /* M_TP */))
     1085    11177    4                 OR ( (OCL_HIST_BUF.ATTR & '040000'O /* M_ADMIN */)
     1086    11178    4                AND (SUBSTR (ATTR_REC.WSN, 0, WI) = SUBSTR (OCL_HIST_BUF.WSN, 0, WI)))
     1087    11179    4                 OR ( (OCL_HIST_BUF.ATTR & '100000'O /* M_DEVC  */)
     1088    11180    4                 AND (ATTR_REC.STATION.SECND_HALF = OCL_HIST_BUF.STATION.SECND_HALF)))
     1089    11181    4               THEN GOTO CHECK_TIME;
     1090    11182
     1091    11183    4            CASE (1,2,3);                  /* KEYIN AND OUTPUT_DIRECT            */

     1092    11184    5               IF DIRECT THEN DO;

  11184  9 001027   000676 234000 1                  SZN     DIRECT
         9 001030   001042 605000 9                  TPL     s:11189

     1093    11185    5                  IF ((OCL_HIST_BUF.DEVNM = ATTR_REC.STATION.FIRST_HALF)

  11185  9 001031   040000 106400                    CMPC    fill='040'O
         9 001032   000005 000004 xsym               ADSC9   OCL_HIST_BUF+5           cn=0,n=4
         9 001033   001203 400004 1                  ADSC9   ATTR_REC+4               cn=2,n=4
         9 001034   001041 601000 9                  TNZ     s:11187
         9 001035   040000 106400                    CMPC    fill='040'O
         9 001036   000010 000010 xsym               ADSC9   OCL_HIST_BUF+8           cn=0,n=8
         9 001037   001201 400010 1                  ADSC9   ATTR_REC+2               cn=2,n=8
         9 001040   001064 600000 9                  TZE     CHECK_TIME

     1094    11186    5                    AND (OCL_HIST_BUF.TERMINAL = ATTR_REC.TERMINAL)) THEN GOTO
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:169  
             11186                             CHECK_TIME;
     1095    11187    5               END;

  11187  9 001041   001046 710000 9                  TRA     s:11192

     1096    11188    5               ELSE DO;

     1097    11189    5                  IF (OCL_HIST_BUF.WSN = ATTR_REC.WSN) THEN GOTO CHECK_TIME;

  11189  9 001042   040000 106400                    CMPC    fill='040'O
         9 001043   000001 000010 xsym               ADSC9   OCL_HIST_BUF+1           cn=0,n=8
         9 001044   001177 400010 1                  ADSC9   ATTR_REC                 cn=2,n=8
         9 001045   001064 600000 9                  TZE     CHECK_TIME

     1098    11190    5               END;

     1099    11191    4            END;                           /* END OF CASE                        */

     1100    11192    3         END;

  11192  9 001046   000674 235000 1                  LDA     A
         9 001047   000001 035007                    ADLA    1,DL
         9 001050   000674 755000 1                  STA     A
         9 001051   000673 236000 1                  LDQ     A_INDEX
         9 001052   000674 116000 1                  CMPQ    A
         9 001053   000721 603000 9                  TRC     s:11159

     1101    11193    2      END;

     1102    11194
     1103    11195    2      IF NOT ALL THEN DO;

  11195  9 001054   000666 234000 1                  SZN     ALL
         9 001055   001064 604000 9                  TMI     CHECK_TIME

     1104    11196    2   LOSE_IT:
     1105    11197    3         CALL M$FDS (FREE_ASTACK_SEG) WHENALTRETURN DO; END;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:170  

  11197  9 001056   002120 630400 1     LOSE_IT      EPPR0   FREE_ASTACK_SEG
         9 001057   430002 713400                    CLIMB   alt,fds
         9 001060   400400 401760                    pmme    nvectors=2
         9 001061   001063 702000 9                  TSX2    s:11198
         9 001062   001063 710000 9                  TRA     s:11198

     1106    11198    2         GOTO DO_LIST;

  11198  9 001063   000526 710000 9                  TRA     DO_LIST

  11195  9 001064                       CHECK_TIME   null
     1107    11199    2      END;
     1108    11200    1   CHECK_TIME:;
     1109    11201
     1110    11202
     1111    11203    2      CALL M$FDS (FREE_ASTACK_SEG) WHENALTRETURN DO; END;

  11203  9 001064   002120 630400 1                  EPPR0   FREE_ASTACK_SEG
         9 001065   430002 713400                    CLIMB   alt,fds
         9 001066   400400 401760                    pmme    nvectors=2
         9 001067   001071 702000 9                  TSX2    s:11205
         9 001070   001071 710000 9                  TRA     s:11205

     1112    11204
     1113    11205    1      IF OCL_NORM_KEY.UTS < BEGINNING_TIME THEN GOTO DO_LIST;

  11205  9 001071   000000 235000 xsym               LDA     OCL_NORM_KEY
         9 001072   000001 236000 xsym               LDQ     OCL_NORM_KEY+1
         9 001073   000033 773000                    LRL     27
         9 001074   000300 116000 1                  CMPQ    BEGINNING_TIME
         9 001075   000526 602000 9                  TNC     DO_LIST

     1114    11206
     1115    11207    1      IF OCL_NORM_KEY.UTS > ENDING_TIME

  11207  9 001076   000301 116000 1                  CMPQ    ENDING_TIME
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:171  
         9 001077   001111 602000 9                  TNC     s:11212
         9 001100   001111 600000 9                  TZE     s:11212
         9 001101   040000 106400                    CMPC    fill='040'O
         9 001102   001400 200037 1                  ADSC9   FID_NAME                 cn=1,n=31
         9 001103   000011 000007 8                  ADSC9   MOP_8_DIGITS_3+8         cn=0,n=7
         9 001104   001736 601000 9                  TNZ     REPORT_END_POINT
         9 001105   000653 234000 1                  SZN     OPERATOR_ENTERED_TIME2
         9 001106   001736 604000 9                  TMI     REPORT_END_POINT
         9 001107   000654 234000 1                  SZN     OPERATOR_ENTERED_DATE2
         9 001110   001736 604000 9                  TMI     REPORT_END_POINT

     1116    11208    1        AND (FID_NAME.NAME#~=':OCHIST'
     1117    11209    1        OR OPERATOR_ENTERED_TIME2
     1118    11210    1        OR OPERATOR_ENTERED_DATE2) THEN GOTO REPORT_END_POINT;
     1119    11211
     1120    11212    1      OCM_KEY_FLAG = %NO#;       /* Set OCM_KEY_FLAG to zero so the following data

  11212  9 001111   000000 450000 xsym               STZ     OCM_KEY_FLAG

     1121    11213                                         will be used in OCM_TEMPLATE (keyin)         */
     1122    11214    1      OCM_TSTAMP = OCL_HIST_BUF.TSTAMP;

  11214  9 001112   000000 235000 xsym               LDA     OCL_HIST_BUF
         9 001113   000000 755000 xsym               STA     OCM_TSTAMP

     1123    11215    1      OCM_WSN = OCL_HIST_BUF.WSN;

  11215  9 001114   040000 100400                    MLR     fill='040'O
         9 001115   000001 000010 xsym               ADSC9   OCL_HIST_BUF+1           cn=0,n=8
         9 001116   000000 000010 xsym               ADSC9   OCM_WSN                  cn=0,n=8

     1124    11216    1      OCM_PROMPT.SIZE = OCL_HIST_BUF.PROMPT_LENGTH;

  11216  9 001117   000013 236000 xsym               LDQ     OCL_HIST_BUF+11
         9 001120   000000 552040 xsym               STBQ    OCM_PROMPT,'40'O

     1125    11217    1      OCM_PROMPT.TEXT = SUBSTR (OCL_HIST_BUF.MESS,0,OCL_HIST_BUF.PROMPT_LENGTH);
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:172  

  11217  9 001121   000013 236000 xsym               LDQ     OCL_HIST_BUF+11
         9 001122   000033 772000                    QRL     27
         9 001123   000000 620006                    EAX0    0,QL
         9 001124   040000 100440                    MLR     fill='040'O
         9 001125   000013 200010 xsym               ADSC9   OCL_HIST_BUF+11          cn=1,n=*X0
         9 001126   000000 200037 xsym               ADSC9   OCM_PROMPT               cn=1,n=31

     1126    11218
     1127    11219    2      IF CONSOLE_REPORT THEN DO;

  11219  9 001127   000745 234000 1                  SZN     CONSOLE_REPORT
         9 001130   001134 605000 9                  TPL     s:11225

     1128    11220    2         CALL GATHER_C_STATS;

  11220  9 001131   011331 701000 9                  TSX1    GATHER_C_STATS
         9 001132   000000 011000                    NOP     0

     1129    11221    2         GOTO DO_LIST;

  11221  9 001133   000526 710000 9                  TRA     DO_LIST

     1130    11222    2      END;
     1131    11223        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:173  
     1132    11224
     1133    11225    2      DO CASE (OCL_HIST_BUF.TYPE);

  11225  9 001134   000012 720000 xsym               LXL0    OCL_HIST_BUF+10
         9 001135   000777 360003                    ANX0    511,DU
         9 001136   000004 100003                    CMPX0   4,DU
         9 001137   001141 602010 9                  TNC     s:11225+5,X0
         9 001140   001501 710000 9                  TRA     s:11443
         9 001141   001145 710000 9                  TRA     s:11241
         9 001142   001336 710000 9                  TRA     s:11358
         9 001143   001425 710000 9                  TRA     s:11404
         9 001144   001425 710000 9                  TRA     s:11404

     1134    11226
     1135    11227         /*************************************/
     1136    11228         /*                                   */
     1137    11229         /*       First type of message       */
     1138    11230         /*              -Output-              */
     1139    11231         /*                                   */
     1140    11232         /*************************************/
     1141    11233
     1142    11234    2      CASE (0);

     1143    11235
     1144    11236
     1145    11237                                                /* If record has no template then
     1146    11238                                                     skip call to tpset, and just use
     1147    11239                                                     text string                      */
     1148    11240
     1149    11241    3         IF OCL_HIST_BUF.TEMPLATE THEN DO;

  11241  9 001145   000012 236000 xsym               LDQ     OCL_HIST_BUF+10
         9 001146   400000 316007                    CANQ    -131072,DL
         9 001147   001163 600000 9                  TZE     s:11256

     1150    11242    3            OCM_BUFFER = OCL_HIST_BUF.MESS;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:174  
  11242  9 001150   040000 100400                    MLR     fill='040'O
         9 001151   000013 200377 xsym               ADSC9   OCL_HIST_BUF+11          cn=1,n=255
         9 001152   000000 000400 xsym               ADSC9   OCM_BUFFER               cn=0,n=256

     1151    11243    3            OCM_BPOSN = DCBADDR (DCBNUM (F$HISTFILE)) -> F$DCB.ARS# -

  11243  9 001153   000000 236007 xsym               LDQ     F$HISTFILE,DL
         9 001154   000005 470400 10                 LDP0    5
         9 001155   000000 471500                    LDP1    0,,PR0
         9 001156   100000 473506                    LDP3    0,QL,PR1
         9 001157   300000 235100                    LDA     0,,PR3
         9 001160   000045 135007                    SBLA    37,DL
         9 001161   000000 755000 xsym               STA     OCM_BPOSN

     1152    11244    3              (LENGTHC (OCL_NORM_KEY.UTS) +
     1153    11245    3              LENGTHC (OCL_HIST_BUF.WSN) +
     1154    11246    3              LENGTHC (OCL_HIST_BUF.LOGON) +
     1155    11247    3              LENGTHC (OCL_HIST_BUF.DEVNM) +
     1156    11248    3              LENGTHC (OCL_HIST_BUF.TERMINAL) +
     1157    11249    3              LENGTHC (OCL_HIST_BUF.ATTR) +
     1158    11250    3              LENGTHC (OCL_HIST_BUF.TEMPLATE) +
     1159    11251    3              LENGTHC (OCL_HIST_BUF.TYPE) +
     1160    11252    3              LENGTHC (OCL_HIST_BUF.PROMPT_LENGTH));
     1161    11253    3            GOTO SKIP_TPSET;

  11253  9 001162   001177 710000 9                  TRA     SKIP_TPSET

     1162    11254    3         END;
     1163    11255
     1164    11256    2         CALL OCM$TPSET (LANGUAGE,

  11256  9 001163   000013 236000 xsym               LDQ     OCL_HIST_BUF+11
         9 001164   000033 772000                    QRL     27
         9 001165   777400 621006                    EAX1    -256,QL
         9 001166   777777 661003                    ERX1    -1,DU
         9 001167   000020 736000                    QLS     16
         9 001170   000020 036000 10                 ADLQ    16
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:175  
         9 001171   000021 235000 10                 LDA     17
         9 001172   200014 757100                    STAQ    IOPT+7,,AUTO
         9 001173   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 001174   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001175   000000 701000 xent               TSX1    OCM$TPSET
         9 001176   001522 702000 9                  TSX2    BAD_LANG

     1165    11257    2           SUBSTR (OCL_HIST_BUF.MESS,OCL_HIST_BUF.PROMPT_LENGTH,LENGTHC(OCL_HIST_BUF.
             11257                    MESS)-OCL_HIST_BUF.PROMPT_LENGTH))

  11257  9 001177                       SKIP_TPSET   null
     1166    11258    2           ALTRET (BAD_LANG);
     1167    11259
     1168    11260                                                /* This routine formats the
     1169    11261                                                     records from :ochist in
     1170    11262                                                     the specified language. It
     1171    11263                                                     places a formatted message
     1172    11264                                                     in OCM_BUFFER, and its length
     1173    11265                                                     in OCM_BPOSN.                    */
     1174    11266
     1175    11267    2   SKIP_TPSET:;
     1176    11268    2         OUT_BUFFER = ' ';

  11268  9 001177   040000 100400                    MLR     fill='040'O
         9 001200   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 001201   000527 000400 1                  ADSC9   OUT_BUFFER               cn=0,n=256

     1177    11269
     1178    11270    3         IF PREFIX THEN DO;

  11270  9 001202   000705 234000 1                  SZN     PREFIX
         9 001203   001320 605000 9                  TPL     s:11330

     1179    11271    3            OUT_BUFFER = 'TO   ';

  11271  9 001204   040000 100400                    MLR     fill='040'O
         9 001205   000013 000005 8                  ADSC9   MOP_8_DIGITS_3+10        cn=0,n=5
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:176  
         9 001206   000527 000400 1                  ADSC9   OUT_BUFFER               cn=0,n=256

     1180    11272    3            HERE = 5;

  11272  9 001207   000005 235007                    LDA     5,DL
         9 001210   000213 755000 1                  STA     HERE

     1181    11273
     1182    11274                                                /* Initialize buffer and position
     1183    11275                                                     counter.                         */
     1184    11276
     1185    11277
     1186    11278    4            DO IND = 0 TO %ORR_ATTR#;

  11278  9 001211   000212 450000 1                  STZ     IND

     1187    11279                                                /* Doing a logical "&" prior
     1188    11280                                                     to comparison allows extra
     1189    11281                                                     bits to be turned on
     1190    11282                                                     following the bit value
     1191    11283                                                     of interest. For example
     1192    11284                                                     a (340000 & 300000)
     1193    11285                                                     would = 300000, which is
     1194    11286                                                     is equal to 300000.
     1195    11287                                                     (340000 & 300000) = 300000
     1196    11288                                                     */
     1197    11289    4               IF (ORR_UNMASK.MASK(IND) & OCL_HIST_BUF.ATTR)

  11289  9 001212   000212 235000 1                  LDA     IND
         9 001213   000002 735000                    ALS     2
         9 001214   001214 220005 1                  LDX0    ORR_UNMASK,AL
         9 001215   000012 360000 xsym               ANX0    OCL_HIST_BUF+10
         9 001216   001214 100005 1                  CMPX0   ORR_UNMASK,AL
         9 001217   001311 601000 9                  TNZ     s:11325

     1198    11290    5                 = ORR_UNMASK.MASK(IND) THEN DO;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:177  
     1199    11291
     1200    11292                                                /* Find the kind of console that
     1201    11293                                                     is responsible for message
     1202    11294                                                     in OCL_HIST_BUF.                 */
     1203    11295
     1204    11296    5                  CALL INSERT( OUT_BUFFER, HERE, ORR_UNMASK.NM_CT(IND),

  11296  9 001220   001215 236005 1                  LDQ     ORR_UNMASK+1,AL
         9 001221   000033 772000                    QRL     27
         9 001222   000212 235000 1                  LDA     IND
         9 001223   000004 735000                    ALS     4
         9 001224   000000 620006                    EAX0    0,QL
         9 001225   000213 236000 1                  LDQ     HERE
         9 001226   040046 100405                    MLR     fill='040'O
         9 001227   001216 000010 1                  ADSC9   ORR_UNMASK+2,A           cn=0,n=8
         9 001230   000527 000010 1                  ADSC9   OUT_BUFFER,Q             cn=0,n=*X0

     1205    11297    5                    ORR_UNMASK.NM(IND));   /* Place kind of console
     1206    11298                                                into output buffer                    */
     1207    11299
     1208    11300
     1209    11301    5                  HERE = HERE + ORR_UNMASK.NM_CT(IND); /* Increment buffer

  11301  9 001231   000212 235000 1                  LDA     IND
         9 001232   000002 735000                    ALS     2
         9 001233   001215 236005 1                  LDQ     ORR_UNMASK+1,AL
         9 001234   000033 772000                    QRL     27
         9 001235   000213 036000 1                  ADLQ    HERE
         9 001236   000213 756000 1                  STQ     HERE

     1210    11302                                                position counter.                     */
     1211    11303
     1212    11304    6                  IF ORR_UNMASK.WSN(IND) THEN DO;

  11304  9 001237   001214 236005 1                  LDQ     ORR_UNMASK,AL
         9 001240   200000 316007                    CANQ    65536,DL
         9 001241   001263 600000 9                  TZE     s:11314
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:178  

     1213    11305
     1214    11306                                                /* Look for WSN associated with
     1215    11307                                                     console.                         */
     1216    11308
     1217    11309    6                     CALL INSERT ( OUT_BUFFER, HERE, , '@', OCL_HIST_BUF.WSN);

  11309  9 001242   000213 720000 1                  LXL0    HERE
         9 001243   777377 620010                    EAX0    -257,X0
         9 001244   777777 660003                    ERX0    -1,DU
         9 001245   000213 235000 1                  LDA     HERE
         9 001246   040045 100400                    MLR     fill='040'O
         9 001247   000022 000001 10                 ADSC9   18                       cn=0,n=1
         9 001250   000527 000010 1                  ADSC9   OUT_BUFFER,A             cn=0,n=*X0
         9 001251   000213 236000 1                  LDQ     HERE
         9 001252   000377 116007                    CMPQ    255,DL
         9 001253   001261 605000 9                  TPL     s:11310
         9 001254   777400 621006                    EAX1    -256,QL
         9 001255   777777 661003                    ERX1    -1,DU
         9 001256   040046 100400                    MLR     fill='040'O
         9 001257   000001 000010 xsym               ADSC9   OCL_HIST_BUF+1           cn=0,n=8
         9 001260   000527 200011 1                  ADSC9   OUT_BUFFER,Q             cn=1,n=*X1

     1218    11310    6                     HERE = HERE + LENGTHC (OCL_HIST_BUF.WSN) + 1;

  11310  9 001261   000011 236007                    LDQ     9,DL
         9 001262   000213 056000 1                  ASQ     HERE

     1219    11311                                                /* Add 1 for '@'                      */
     1220    11312    6                  END;

     1221    11313
     1222    11314    6                  IF ORR_UNMASK.TERM(IND) THEN DO;

  11314  9 001263   000212 235000 1                  LDA     IND
         9 001264   000002 735000                    ALS     2
         9 001265   001214 236005 1                  LDQ     ORR_UNMASK,AL
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:179  
         9 001266   400000 316007                    CANQ    -131072,DL
         9 001267   001311 600000 9                  TZE     s:11325

     1223    11315
     1224    11316                                                /* Look for terminal associated
     1225    11317                                                     with console.                    */
     1226    11318
     1227    11319    6                     CALL INSERT ( OUT_BUFFER, HERE, , '@', OCL_HIST_BUF.TERMINAL);

  11319  9 001270   000213 720000 1                  LXL0    HERE
         9 001271   777377 620010                    EAX0    -257,X0
         9 001272   777777 660003                    ERX0    -1,DU
         9 001273   000213 235000 1                  LDA     HERE
         9 001274   040045 100400                    MLR     fill='040'O
         9 001275   000022 000001 10                 ADSC9   18                       cn=0,n=1
         9 001276   000527 000010 1                  ADSC9   OUT_BUFFER,A             cn=0,n=*X0
         9 001277   000213 236000 1                  LDQ     HERE
         9 001300   000377 116007                    CMPQ    255,DL
         9 001301   001307 605000 9                  TPL     s:11320
         9 001302   777400 621006                    EAX1    -256,QL
         9 001303   777777 661003                    ERX1    -1,DU
         9 001304   040046 100400                    MLR     fill='040'O
         9 001305   000010 000010 xsym               ADSC9   OCL_HIST_BUF+8           cn=0,n=8
         9 001306   000527 200011 1                  ADSC9   OUT_BUFFER,Q             cn=1,n=*X1

     1228    11320    6                     HERE = HERE + LENGTHC (OCL_HIST_BUF.TERMINAL) + 1;

  11320  9 001307   000011 236007                    LDQ     9,DL
         9 001310   000213 056000 1                  ASQ     HERE

     1229    11321    6                  END;

     1230    11322
     1231    11323                                                /* Add 1 for '@'                      */
     1232    11324    5               END;

     1233    11325    4            END;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:180  

  11325  9 001311   000212 054000 1                  AOS     IND
         9 001312   000212 235000 1                  LDA     IND
         9 001313   000012 115007                    CMPA    10,DL
         9 001314   001212 604400 9                  TMOZ    s:11289

     1234    11326    3            HERE = 19;

  11326  9 001315   000023 236007                    LDQ     19,DL
         9 001316   000213 756000 1                  STQ     HERE

     1235    11327    3         END;                              /* END Prefix do                      */

  11327  9 001317   001321 710000 9                  TRA     s:11333

     1236    11328    2         ELSE
     1237    11329    3         DO;

     1238    11330    3            HERE = 0;

  11330  9 001320   000213 450000 1                  STZ     HERE

     1239    11331    3         END;

     1240    11332
     1241    11333    2         CALL INSERT ( OUT_BUFFER,

  11333  9 001321   000000 720000 xsym               LXL0    OCM_BPOSN
         9 001322   000213 235000 1                  LDA     HERE
         9 001323   040045 100400                    MLR     fill='040'O
         9 001324   000000 000400 xsym               ADSC9   OCM_BUFFER               cn=0,n=256
         9 001325   000527 000010 1                  ADSC9   OUT_BUFFER,A             cn=0,n=*X0

     1242    11334    2           HERE,
     1243    11335    2           OCM_BPOSN,
     1244    11336    2           OCM_BUFFER);
     1245    11337
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:181  
     1246    11338                                                /* Formatted & translated message
     1247    11339                                                     is returned in OCM_BUFFER,
     1248    11340                                                     its length is in OCM_BPOSN.      */
     1249    11341
     1250    11342    2         WRITE_HIST_BUF_MESS.BUF_.BOUND =

  11342  9 001326   000000 236000 xsym               LDQ     OCM_BPOSN
         9 001327   000213 036000 1                  ADLQ    HERE
         9 001330   000001 136007                    SBLQ    1,DL
         9 001331   000020 736000                    QLS     16
         9 001332   002062 676000 1                  ERQ     WRITE_HIST_BUF_MESS+4
         9 001333   000034 376000 xsym               ANQ     B_VECTNIL+28
         9 001334   002062 656000 1                  ERSQ    WRITE_HIST_BUF_MESS+4
         9 001335   001501 710000 9                  TRA     s:11443

     1251    11343    2           OCM_BPOSN + HERE - 1;
     1252    11344
     1253    11345                                                /* subtract 1 because bound
     1254    11346                                                     is zero relative.                */
     1255    11347
     1256    11348        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:182  
     1257    11349
     1258    11350         /*************************************/
     1259    11351         /*                                   */
     1260    11352         /*       Second type of message      */
     1261    11353         /*          -Output Direct-          */
     1262    11354         /*                                   */
     1263    11355         /*************************************/
     1264    11356
     1265    11357    2      CASE (1);

     1266    11358    2         CALL OCM$TPSET (LANGUAGE,

  11358  9 001336   000013 236000 xsym               LDQ     OCL_HIST_BUF+11
         9 001337   000033 772000                    QRL     27
         9 001340   777400 621006                    EAX1    -256,QL
         9 001341   777777 661003                    ERX1    -1,DU
         9 001342   000020 736000                    QLS     16
         9 001343   000020 036000 10                 ADLQ    16
         9 001344   000021 235000 10                 LDA     17
         9 001345   200014 757100                    STAQ    IOPT+7,,AUTO
         9 001346   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 001347   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001350   000000 701000 xent               TSX1    OCM$TPSET
         9 001351   001522 702000 9                  TSX2    BAD_LANG

     1267    11359    2          SUBSTR (OCL_HIST_BUF.MESS, OCL_HIST_BUF.PROMPT_LENGTH, LENGTHC(OCL_HIST_BUF.
             11359                    MESS)-OCL_HIST_BUF.PROMPT_LENGTH))
     1268    11360    2           ALTRET (BAD_LANG);
     1269    11361
     1270    11362                                                /* This routine formats the
     1271    11363                                                     the specified language. It
     1272    11364                                                     places formatted messages in
     1273    11365                                                     OCM_BUFFER & its length in
     1274    11366                                                     OCM_BPOSN.                       */
     1275    11367
     1276    11368
     1277    11369    3         IF PREFIX THEN DO;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:183  

  11369  9 001352   000705 234000 1                  SZN     PREFIX
         9 001353   001403 605000 9                  TPL     s:11389

     1278    11370    3            CALL CONCAT ( OUT_BUFFER,

  11370  9 001354   040000 100400                    MLR     fill='040'O
         9 001355   000013 000005 8                  ADSC9   MOP_8_DIGITS_3+10        cn=0,n=5
         9 001356   000527 000005 1                  ADSC9   OUT_BUFFER               cn=0,n=5
         9 001357   040000 100400                    MLR     fill='040'O
         9 001360   000005 000004 xsym               ADSC9   OCL_HIST_BUF+5           cn=0,n=4
         9 001361   000530 200004 1                  ADSC9   OUT_BUFFER+1             cn=1,n=4
         9 001362   000100 236003                    LDQ     64,DU
         9 001363   000531 552020 1                  STBQ    OUT_BUFFER+2,'20'O
         9 001364   040000 100400                    MLR     fill='040'O
         9 001365   000010 000010 xsym               ADSC9   OCL_HIST_BUF+8           cn=0,n=8
         9 001366   000531 400010 1                  ADSC9   OUT_BUFFER+2             cn=2,n=8
         9 001367   040000 236007                    LDQ     16384,DL
         9 001370   000533 552010 1                  STBQ    OUT_BUFFER+4,'10'O
         9 001371   040000 100400                    MLR     fill='040'O
         9 001372   000000 000355 xsym               ADSC9   OCM_BUFFER               cn=0,n=237
         9 001373   000533 600355 1                  ADSC9   OUT_BUFFER+4             cn=3,n=237

     1279    11371    3              'TO   ',
     1280    11372    3              OCL_HIST_BUF.DEVNM,
     1281    11373    3              '@',
     1282    11374    3              OCL_HIST_BUF.TERMINAL,
     1283    11375    3              ' ',
     1284    11376    3              OCM_BUFFER);
     1285    11377
     1286    11378    3            WRITE_HIST_BUF_MESS.BUF_.BOUND =

  11378  9 001374   000000 236000 xsym               LDQ     OCM_BPOSN
         9 001375   000022 036007                    ADLQ    18,DL
         9 001376   000020 736000                    QLS     16
         9 001377   002062 676000 1                  ERQ     WRITE_HIST_BUF_MESS+4
         9 001400   000034 376000 xsym               ANQ     B_VECTNIL+28
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:184  
         9 001401   002062 656000 1                  ERSQ    WRITE_HIST_BUF_MESS+4

     1287    11379    3              OCM_BPOSN +
     1288    11380    3              LENGTHC ('TO   ') +
     1289    11381    3              LENGTHC (OCL_HIST_BUF.DEVNM) +
     1290    11382    3              LENGTHC ('@') +
     1291    11383    3              LENGTHC (OCL_HIST_BUF.TERMINAL) +
     1292    11384    3              LENGTHC (' ') -
     1293    11385    3              1;
     1294    11386    3         END;

  11386  9 001402   001501 710000 9                  TRA     s:11443

     1295    11387    2         ELSE
     1296    11388    3         DO;

     1297    11389    3            WRITE_HIST_BUF_MESS.BUF_.BOUND = OCM_BPOSN;

  11389  9 001403   000000 236000 xsym               LDQ     OCM_BPOSN
         9 001404   000020 736000                    QLS     16
         9 001405   002062 676000 1                  ERQ     WRITE_HIST_BUF_MESS+4
         9 001406   000034 376000 xsym               ANQ     B_VECTNIL+28
         9 001407   002062 656000 1                  ERSQ    WRITE_HIST_BUF_MESS+4

     1298    11390    3            OUT_BUFFER = ' ';

  11390  9 001410   040000 100400                    MLR     fill='040'O
         9 001411   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 001412   000527 000400 1                  ADSC9   OUT_BUFFER               cn=0,n=256

     1299    11391    3            CALL INSERT (OUT_BUFFER,0,OCM_BPOSN,OCM_BUFFER);

  11391  9 001413   000000 720000 xsym               LXL0    OCM_BPOSN
         9 001414   040040 100400                    MLR     fill='040'O
         9 001415   000000 000400 xsym               ADSC9   OCM_BUFFER               cn=0,n=256
         9 001416   000527 000010 1                  ADSC9   OUT_BUFFER               cn=0,n=*X0

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:185  
     1300    11392    3            WRITE_HIST_BUF_MESS.BUF_.BOUND = OCM_BPOSN;

  11392  9 001417   000000 236000 xsym               LDQ     OCM_BPOSN
         9 001420   000020 736000                    QLS     16
         9 001421   002062 676000 1                  ERQ     WRITE_HIST_BUF_MESS+4
         9 001422   000034 376000 xsym               ANQ     B_VECTNIL+28
         9 001423   002062 656000 1                  ERSQ    WRITE_HIST_BUF_MESS+4

     1301    11393    3         END;

  11393  9 001424   001501 710000 9                  TRA     s:11443

     1302    11394        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:186  
     1303    11395
     1304    11396         /*************************************/
     1305    11397         /*                                   */
     1306    11398         /*       Third type of message       */
     1307    11399         /*              -Keyin-              */
     1308    11400         /*                                   */
     1309    11401         /*************************************/
     1310    11402
     1311    11403    2      CASE (2,3);                          /* KEYIN                              */

     1312    11404    2         OCM_BPOSN = DCBADDR (DCBNUM (F$HISTFILE)) -> F$DCB.ARS# -

  11404  9 001425   000000 236007 xsym               LDQ     F$HISTFILE,DL
         9 001426   000005 470400 10                 LDP0    5
         9 001427   000000 471500                    LDP1    0,,PR0
         9 001430   100000 473506                    LDP3    0,QL,PR1
         9 001431   300000 235100                    LDA     0,,PR3
         9 001432   000055 135007                    SBLA    45,DL
         9 001433   000000 755000 xsym               STA     OCM_BPOSN

     1313    11405    2           (LENGTHC (OCL_NORM_KEY.UTS) +
     1314    11406    2           LENGTHC (OCL_HIST_BUF.WSN) +
     1315    11407    2           LENGTHC (OCL_HIST_BUF.LOGON) +
     1316    11408    2           LENGTHC (OCL_HIST_BUF.DEVNM) +
     1317    11409    2           LENGTHC (OCL_HIST_BUF.STAT) +
     1318    11410    2           LENGTHC (OCL_HIST_BUF.TERMINAL) +
     1319    11411    2           LENGTHC (OCL_HIST_BUF.ATTR) +
     1320    11412    2           LENGTHC (OCL_HIST_BUF.TYPE) +
     1321    11413    2           LENGTHC (OCL_HIST_BUF.TEMPLATE) +
     1322    11414    2           LENGTHC (OCL_HIST_BUF.PROMPT_LENGTH));
     1323    11415
     1324    11416    3         IF PREFIX THEN DO;

  11416  9 001434   000705 234000 1                  SZN     PREFIX
         9 001435   001465 605000 9                  TPL     s:11436

     1325    11417    3            CALL CONCAT ( OUT_BUFFER,
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:187  

  11417  9 001436   040000 100400                    MLR     fill='040'O
         9 001437   000015 000005 8                  ADSC9   MOP_8_DIGITS_3+12        cn=0,n=5
         9 001440   000527 000005 1                  ADSC9   OUT_BUFFER               cn=0,n=5
         9 001441   040000 100400                    MLR     fill='040'O
         9 001442   000005 000004 xsym               ADSC9   OCL_HIST_BUF+5           cn=0,n=4
         9 001443   000530 200004 1                  ADSC9   OUT_BUFFER+1             cn=1,n=4
         9 001444   000100 236003                    LDQ     64,DU
         9 001445   000531 552020 1                  STBQ    OUT_BUFFER+2,'20'O
         9 001446   040000 100400                    MLR     fill='040'O
         9 001447   000010 000010 xsym               ADSC9   OCL_HIST_BUF+8           cn=0,n=8
         9 001450   000531 400010 1                  ADSC9   OUT_BUFFER+2             cn=2,n=8
         9 001451   000017 221000 8                  LDX1    MOP_8_DIGITS_3+14
         9 001452   000533 441000 1                  SXL1    OUT_BUFFER+4
         9 001453   040000 100400                    MLR     fill='040'O
         9 001454   000013 200354 xsym               ADSC9   OCL_HIST_BUF+11          cn=1,n=236
         9 001455   000534 000354 1                  ADSC9   OUT_BUFFER+5             cn=0,n=236

     1326    11418    3              'FROM ',
     1327    11419    3              OCL_HIST_BUF.DEVNM,
     1328    11420    3              '@',
     1329    11421    3              OCL_HIST_BUF.TERMINAL,
     1330    11422    3              ' !',
     1331    11423    3              OCL_HIST_BUF.MESS);
     1332    11424
     1333    11425    3            WRITE_HIST_BUF_MESS.BUF_.BOUND =

  11425  9 001456   000000 236000 xsym               LDQ     OCM_BPOSN
         9 001457   000023 036007                    ADLQ    19,DL
         9 001460   000020 736000                    QLS     16
         9 001461   002062 676000 1                  ERQ     WRITE_HIST_BUF_MESS+4
         9 001462   000034 376000 xsym               ANQ     B_VECTNIL+28
         9 001463   002062 656000 1                  ERSQ    WRITE_HIST_BUF_MESS+4

     1334    11426    3              OCM_BPOSN +
     1335    11427    3              LENGTHC ('FROM ') +
     1336    11428    3              LENGTHC (OCL_HIST_BUF.DEVNM) +
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:188  
     1337    11429    3              LENGTHC ('@') +
     1338    11430    3              LENGTHC (OCL_HIST_BUF.TERMINAL) +
     1339    11431    3              LENGTHC (' !') -
     1340    11432    3              1;
     1341    11433    3         END;

  11433  9 001464   001501 710000 9                  TRA     s:11443

     1342    11434    2         ELSE
     1343    11435    3         DO;

     1344    11436    3            WRITE_HIST_BUF_MESS.BUF_.BOUND = OCM_BPOSN;

  11436  9 001465   000000 236000 xsym               LDQ     OCM_BPOSN
         9 001466   000020 736000                    QLS     16
         9 001467   002062 676000 1                  ERQ     WRITE_HIST_BUF_MESS+4
         9 001470   000034 376000 xsym               ANQ     B_VECTNIL+28
         9 001471   002062 656000 1                  ERSQ    WRITE_HIST_BUF_MESS+4

     1345    11437    3            OUT_BUFFER = ' ';

  11437  9 001472   040000 100400                    MLR     fill='040'O
         9 001473   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 001474   000527 000400 1                  ADSC9   OUT_BUFFER               cn=0,n=256

     1346    11438    3            CALL INSERT (OUT_BUFFER,0,OCM_BPOSN,OCL_HIST_BUF.MESS);

  11438  9 001475   000000 621005                    EAX1    0,AL
         9 001476   040040 100400                    MLR     fill='040'O
         9 001477   000013 200377 xsym               ADSC9   OCL_HIST_BUF+11          cn=1,n=255
         9 001500   000527 000011 1                  ADSC9   OUT_BUFFER               cn=0,n=*X1

     1347    11439    3         END;

     1348    11440
     1349    11441    2      END;                                 /* End case (ocl_hist_buf.type)       */

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:189  
     1350    11442
     1351    11443    2      IF WILDCARDING THEN DO;

  11443  9 001501   000746 234000 1                  SZN     WILDCARDING
         9 001502   001521 605000 9                  TPL     s:11451

     1352    11444    2         XUW_WILDCARD.INPUT_.BOUND = WRITE_HIST_BUF_MESS.BUF_.BOUND;

  11444  9 001503   002062 236000 1                  LDQ     WRITE_HIST_BUF_MESS+4
         9 001504   000152 676000 1                  ERQ     XUW_WILDCARD+2
         9 001505   000034 376000 xsym               ANQ     B_VECTNIL+28
         9 001506   000152 656000 1                  ERSQ    XUW_WILDCARD+2

     1353    11445    2         CALL X$WILDCMP (XUW_WILDCARD) ALTRET (WILD_ERR);

  11445  9 001507   000023 630400 10                 EPPR0   19
         9 001510   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 001511   000000 701000 xent               TSX1    X$WILDCMP
         9 001512   001513 702000 9                  TSX2    WILD_ERR

     1354    11446    2   WILD_ERR: /*N* This looks like a bug!!! */
     1355    11447    2         IF XUW_WILDCARD.ERROR.ERR# = %E$XUW#NOMATCH THEN GOTO DO_LIST;

  11447  9 001513   000160 236000 1     WILD_ERR     LDQ     XUW_WILDCARD+8
         9 001514   377770 376007                    ANQ     131064,DL
         9 001515   004000 116007                    CMPQ    2048,DL
         9 001516   000526 600000 9                  TZE     DO_LIST

     1356    11448    2         ELSE IF XUW_WILDCARD.ERROR.ERR# ~= %E$XUW#WILD_OK THEN GOTO BAD_WILD;

  11448  9 001517   003720 116007                    CMPQ    2000,DL
         9 001520   003114 601000 9                  TNZ     BAD_WILD

     1357    11449    2      END;

     1358    11450                                      /* Passing the above check signifies a match    */
     1359    11451    2      DO WHILE ('0'B);                     /* DO NEVER                           */
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:190  

  11451  9 001521   001536 710000 9                  TRA     s:11468

  11449  9 001522                       BAD_LANG     null
     1360    11452
     1361    11453    2   BAD_LANG: ;
     1362    11454    2         CALL OCM$TPSET (' ',

  11454  9 001522   000013 236000 xsym               LDQ     OCL_HIST_BUF+11
         9 001523   000033 772000                    QRL     27
         9 001524   777400 620006                    EAX0    -256,QL
         9 001525   777777 660003                    ERX0    -1,DU
         9 001526   000020 736000                    QLS     16
         9 001527   000020 036000 10                 ADLQ    16
         9 001530   000024 235000 10                 LDA     20
         9 001531   200014 757100                    STAQ    IOPT+7,,AUTO
         9 001532   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 001533   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001534   000000 701000 xent               TSX1    OCM$TPSET
         9 001535   001537 702000 9                  TSX2    CANT_CALL_TPSET

     1363    11455    2           SUBSTR (OCL_HIST_BUF.MESS, OCL_HIST_BUF.PROMPT_LENGTH,
     1364    11456    2           LENGTHC(OCL_HIST_BUF.MESS)-OCL_HIST_BUF.PROMPT_LENGTH))
     1365    11457    2           ALTRET (CANT_CALL_TPSET);
     1366    11458
     1367    11459                                                /* This routine formats the
     1368    11460                                                     records from :ochist in
     1369    11461                                                     the specified language. It
     1370    11462                                                     places a formatted message in
     1371    11463                                                     OCM_BUFFER & a length in
     1372    11464                                                     OCM_BPOSN.                       */
     1373    11465
     1374    11466    2      END;

     1375    11467
     1376    11468    2      DO WHILE ('0'B);                     /* DO NEVER                           */

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:191  
  11468  9 001536   001561 710000 9                  TRA     s:11480

     1377    11469    2   CANT_CALL_TPSET:;

  11469  9 001537                       CANT_CALL_T* null
     1378    11470    2         OUT_MSG.BUF_.BOUND = 40;

  11470  9 001537   001704 236000 1                  LDQ     OUT_MSG+4
         9 001540   177777 376007                    ANQ     65535,DL
         9 001541   000012 276003                    ORQ     10,DU
         9 001542   001704 756000 1                  STQ     OUT_MSG+4

     1379    11471    2         MSG = '            Cant find template message';

  11471  9 001543   040000 100400                    MLR     fill='040'O
         9 001544   000020 000046 8                  ADSC9   MOP_8_DIGITS_3+15        cn=0,n=38
         9 001545   000427 000400 1                  ADSC9   MSG                      cn=0,n=256

     1380    11472    2         CALL M$WRITE (OUT_MSG);

  11472  9 001546   001700 630400 1                  EPPR0   OUT_MSG
         9 001547   040001 713400                    CLIMB   write
         9 001550   401400 401760                    pmme    nvectors=4

     1381    11473    2         ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11473  9 001551   000000 470400 xsym               LDP0    B$TCB$
         9 001552   000000 471500                    LDP1    0,,PR0
         9 001553   100102 236100                    LDQ     66,,PR1
         9 001554   001125 756000 1                  STQ     ERROR

     1382    11474    2         CALL M$ERRMSG (ERR_FIND_TEMP);

  11474  9 001555   001604 630400 1                  EPPR0   ERR_FIND_TEMP
         9 001556   020000 713400                    CLIMB   8192
         9 001557   405000 401760                    pmme    nvectors=11

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:192  
     1383    11475    2         GOTO DO_LIST;

  11475  9 001560   000526 710000 9                  TRA     DO_LIST

     1384    11476    2      END;

     1385    11477
     1386    11478        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:193  
     1387    11479
     1388    11480    1      PRINT_FLAG = %YES#;

  11480  9 001561   400000 236003                    LDQ     -131072,DU
         9 001562   000306 756000 1                  STQ     PRINT_FLAG

     1389    11481
     1390    11482                                                /* Logic fell through meaning
     1391    11483                                                     that output was found for
     1392    11484                                                     current selection criteria.      */
     1393    11485
     1394    11486
     1395    11487    1      CALL XUD$UTS_ADJUST (TEMP_UTS, PRINTED_TIME, %UTS_CSEC_MIN#);

  11487  9 001563   000026 236000 10                 LDQ     22
         9 001564   200016 756100                    STQ     IOPT+9,,AUTO
         9 001565   000027 236000 10                 LDQ     23
         9 001566   200015 756100                    STQ     IOPT+8,,AUTO
         9 001567   200003 630500                    EPPR0   TEMP_UTS,,AUTO
         9 001570   200014 450500                    STP0    IOPT+7,,AUTO
         9 001571   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 001572   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001573   000000 701000 xent               TSX1    XUD$UTS_ADJUST
         9 001574   000000 011000                    NOP     0

     1396    11488    1      IF PRINTED_TIME = 0

  11488  9 001575   000307 235000 1                  LDA     PRINTED_TIME
         9 001576   001605 600000 9                  TZE     s:11497
         9 001577   000000 235000 xsym               LDA     OCL_NORM_KEY
         9 001600   000001 236000 xsym               LDQ     OCL_NORM_KEY+1
         9 001601   000033 773000                    LRL     27
         9 001602   200003 116100                    CMPQ    TEMP_UTS,,AUTO
         9 001603   001651 602000 9                  TNC     s:11530
         9 001604   001651 600000 9                  TZE     s:11530

     1397    11489    2        OR OCL_NORM_KEY.UTS > TEMP_UTS THEN DO;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:194  

     1398    11490
     1399    11491                                                /* Print time if it is before first
     1400    11492                                                     output line, or if a minute
     1401    11493                                                     has expired (using present
     1402    11494                                                     records UTS) since the last
     1403    11495                                                     simulated print time.            */
     1404    11496
     1405    11497    2         CALL M$TIME (TIME_SIMULATION) ALTRET (CANT_CALL_TIME_SIM);

  11497  9 001605   002206 630400 1                  EPPR0   TIME_SIMULATION
         9 001606   420004 713400                    CLIMB   alt,+8196
         9 001607   402000 401760                    pmme    nvectors=5
         9 001610   002241 702000 9                  TSX2    CANT_CALL_TIME_SIM

     1406    11498
     1407    11499                                                /* Convert OCL_NORM_KEY.UTS
     1408    11500                                                     to "local" time format.          */
     1409    11501
     1410    11502    2         WRITE_TIME.BUF_.BOUND = 20 + LENGTHC(SIM_DATE) + LENGTHC (SIM_TIME) - 7;

  11502  9 001611   002226 236000 1                  LDQ     WRITE_TIME+4
         9 001612   177777 376007                    ANQ     65535,DL
         9 001613   000010 276003                    ORQ     8,DU
         9 001614   002226 756000 1                  STQ     WRITE_TIME+4

     1411    11503
     1412    11504    2         TIME_BUFFER = ' ';

  11504  9 001615   040000 100400                    MLR     fill='040'O
         9 001616   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 001617   000627 000110 1                  ADSC9   TIME_BUFFER              cn=0,n=72

     1413    11505
     1414    11506    2         CALL INSERT (TIME_BUFFER, 19, 14, SUBSTR (SIM_TIME, 0, 5), ' ', SIM_DATE);

  11506  9 001620   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:195  
         9 001621   000417 000005 1                  ADSC9   SIM_TIME                 cn=0,n=5
         9 001622   000633 600005 1                  ADSC9   TIME_BUFFER+4            cn=3,n=5
         9 001623   040000 236003                    LDQ     16384,DU
         9 001624   000635 552040 1                  STBQ    TIME_BUFFER+6,'40'O
         9 001625   040000 100400                    MLR     fill='040'O
         9 001626   000415 000010 1                  ADSC9   SIM_DATE                 cn=0,n=8
         9 001627   000635 200010 1                  ADSC9   TIME_BUFFER+6            cn=1,n=8

     1415    11507
     1416    11508                                                /* Place new simulated time in
     1417    11509                                                     buffer.                          */
     1418    11510
     1419    11511    2         CALL M$WRITE (WRITE_TIME) ALTRET (CANT_WRITE_TIME);

  11511  9 001630   002222 630400 1                  EPPR0   WRITE_TIME
         9 001631   440001 713400                    CLIMB   alt,write
         9 001632   401400 401760                    pmme    nvectors=4
         9 001633   002353 702000 9                  TSX2    CANT_WRITE_TIME

     1420    11512
     1421    11513                                                /* Write new simulated time.          */
     1422    11514
     1423    11515    2         TO_UTS_DATE = SIM_DATE;

  11515  9 001634   040000 100400                    MLR     fill='040'O
         9 001635   000415 000010 1                  ADSC9   SIM_DATE                 cn=0,n=8
         9 001636   000422 000010 1                  ADSC9   TO_UTS_DATE              cn=0,n=8

     1424    11516    2         CALL CONCAT (TO_UTS_TIME, SUBSTR(SIM_TIME,0,5), ':00.00');

  11516  9 001637   040000 100400                    MLR     fill='040'O
         9 001640   000417 000005 1                  ADSC9   SIM_TIME                 cn=0,n=5
         9 001641   000424 000005 1                  ADSC9   TO_UTS_TIME              cn=0,n=5
         9 001642   040000 100400                    MLR     fill='040'O
         9 001643   000032 000006 8                  ADSC9   MOP_8_DIGITS_3+25        cn=0,n=6
         9 001644   000425 200006 1                  ADSC9   TO_UTS_TIME+1            cn=1,n=6

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:196  
     1425    11517
     1426    11518                                                /* Printed times are on the
     1427    11519                                                     minute, so zero out
     1428    11520                                                     simulated time's seconds
     1429    11521                                                     and centiseconds.                */
     1430    11522
     1431    11523    2         CALL M$TIME (TIME_TO_UTS) ALTRET (CANT_CALL_TIME_UTS);

  11523  9 001645   002236 630400 1                  EPPR0   TIME_TO_UTS
         9 001646   420004 713400                    CLIMB   alt,+8196
         9 001647   402000 401760                    pmme    nvectors=5
         9 001650   002306 702000 9                  TSX2    CANT_CALL_TIME_UTS

     1432    11524
     1433    11525                                                /* Place new simulated time in
     1434    11526                                                     hold area "PRINTED_TIME".        */
     1435    11527
     1436    11528    2      END;

     1437    11529
     1438    11530    1      CALL M$WRITE (WRITE_HIST_BUF_MESS) ALTRET (CANT_WRITE);

  11530  9 001651   002056 630400 1                  EPPR0   WRITE_HIST_BUF_MESS
         9 001652   440001 713400                    CLIMB   alt,write
         9 001653   401400 401760                    pmme    nvectors=4
         9 001654   002011 702000 9                  TSX2    CANT_WRITE

     1439    11531
     1440    11532                                                /* This statement writes the
     1441    11533                                                     actual formatted message
     1442    11534                                                     along with destination or
     1443    11535                                                     origin to console.               */
     1444    11536
     1445    11537    1      GOTO DO_LIST;

  11537  9 001655   000526 710000 9                  TRA     DO_LIST

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:197  
  11523  9 001656                       CHECK_END    null
     1446    11538
     1447    11539                                                /* Return to Do_list loop for
     1448    11540                                                     next record.                     */
     1449    11541
     1450    11542
     1451    11543
     1452    11544        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:198  
     1453    11545    1   CHECK_END:;
     1454    11546    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11546  9 001656   000000 470400 xsym               LDP0    B$TCB$
         9 001657   000000 471500                    LDP1    0,,PR0
         9 001660   100102 236100                    LDQ     66,,PR1
         9 001661   001125 756000 1                  STQ     ERROR

     1455    11547
     1456    11548    2      IF (ERROR.ERR# ~= %E$EOF) AND (ERROR.ERR# ~= %E$NOKEY) THEN DO;

  11548  9 001662   001125 236000 1                  LDQ     ERROR
         9 001663   377770 376007                    ANQ     131064,DL
         9 001664   000060 116007                    CMPQ    48,DL
         9 001665   001736 600000 9                  TZE     REPORT_END_POINT
         9 001666   001020 116007                    CMPQ    528,DL
         9 001667   001736 600000 9                  TZE     REPORT_END_POINT

     1457    11549         /*E* ERROR: ORR-E_READERR#-0
     1458    11550                       MESSAGE: Error reading :ochist file
     1459    11551                                      */
     1460    11552    2         MODULE_ERR.ERR# = 13 /* E_READERR# */;

  11552  9 001670   001670 236000 1                  LDQ     MODULE_ERR
         9 001671   000001 376000 10                 ANQ     1
         9 001672   000150 276007                    ORQ     104,DL
         9 001673   001670 756000 1                  STQ     MODULE_ERR

     1461    11553    2         MODULE_ERR.SEV = 0;

  11553  9 001674   000002 236000 10                 LDQ     2
         9 001675   001670 356000 1                  ANSQ    MODULE_ERR

     1462    11554    2         CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  11554  9 001676   000000 236007 xsym               LDQ     M$LO,DL
         9 001677   200014 756100                    STQ     IOPT+7,,AUTO
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:199  
         9 001700   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 001701   200017 451500                    STP1    IOPT+10,,AUTO
         9 001702   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 001703   200016 756100                    STQ     IOPT+9,,AUTO
         9 001704   000003 236000 10                 LDQ     3
         9 001705   200015 756100                    STQ     IOPT+8,,AUTO
         9 001706   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 001707   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001710   000000 701000 xent               TSX1    XUR$ERRMSG
         9 001711   000000 011000                    NOP     0

     1463    11555    2         ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11555  9 001712   000000 470400 xsym               LDP0    B$TCB$
         9 001713   000000 471500                    LDP1    0,,PR0
         9 001714   100102 236100                    LDQ     66,,PR1
         9 001715   001125 756000 1                  STQ     ERROR

     1464    11556    2         CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));

  11556  9 001716   000000 236007 xsym               LDQ     M$LO,DL
         9 001717   200014 756100                    STQ     IOPT+7,,AUTO
         9 001720   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 001721   200017 451500                    STP1    IOPT+10,,AUTO
         9 001722   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 001723   200016 756100                    STQ     IOPT+9,,AUTO
         9 001724   000030 236000 10                 LDQ     24
         9 001725   200015 756100                    STQ     IOPT+8,,AUTO
         9 001726   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 001727   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001730   000000 701000 xent               TSX1    XUR$ERRMSG
         9 001731   000000 011000                    NOP     0

     1465    11557    2         CALL ORR$BRKRTN;

  11557  9 001732   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 001733   000000 701000 xent               TSX1    ORR$BRKRTN
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:200  
         9 001734   000000 011000                    NOP     0

     1466    11558    2      END;

  11558  9 001735   001742 710000 9                  TRA     s:11565

     1467    11559    1      ELSE
     1468    11560    2   REPORT_END_POINT: DO;

  11560  9 001736                       REPORT_END_* null
     1469    11561    2         CALL CLOSE_UP;

  11561  9 001736   007571 701000 9                  TSX1    CLOSE_UP
         9 001737   000000 011000                    NOP     0

     1470    11562    2         IF KEEP_ON_LISTING THEN GOTO DO_LIST;

  11562  9 001740   000663 234000 1                  SZN     KEEP_ON_LISTING
         9 001741   000526 604000 9                  TMI     DO_LIST

     1471    11563    2      END;

     1472    11564
     1473    11565    1      IF CONSOLE_REPORT AND CINDEX > 0 THEN CALL DISPLAY_CONSOLES;

  11565  9 001742   000745 234000 1                  SZN     CONSOLE_REPORT
         9 001743   001750 605000 9                  TPL     s:11567
         9 001744   000742 235000 1                  LDA     CINDEX
         9 001745   001750 600000 9                  TZE     s:11567

  11565  9 001746   011457 701000 9                  TSX1    DISPLAY_CONSOLES
         9 001747   000000 011000                    NOP     0

     1474    11566
     1475    11567    1      IF LOGON_REPORT THEN CALL DISPLAY_LOGONS;

  11567  9 001750   000711 234000 1                  SZN     LOGON_REPORT
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:201  
         9 001751   001754 605000 9                  TPL     s:11569

  11567  9 001752   010717 701000 9                  TSX1    DISPLAY_LOGONS
         9 001753   000000 011000                    NOP     0

     1476    11568
     1477    11569    2      IF NOT PRINT_FLAG THEN DO;

  11569  9 001754   000306 234000 1                  SZN     PRINT_FLAG
         9 001755   002000 604000 9                  TMI     s:11584

     1478    11570
     1479    11571                                                /* If no messages were found for
     1480    11572                                                     the current selection criteria
     1481    11573                                                     print a message.                 */
     1482    11574
     1483    11575         /*E* ERROR: ORR-E_NORECERR#-0
     1484    11576              MESSAGE: No records found using the current selection criteria.
     1485    11577                                           */
     1486    11578    2         MODULE_ERR.ERR# = 14 /* E_NORECERR# */;

  11578  9 001756   001670 236000 1                  LDQ     MODULE_ERR
         9 001757   000001 376000 10                 ANQ     1
         9 001760   000160 276007                    ORQ     112,DL
         9 001761   001670 756000 1                  STQ     MODULE_ERR

     1487    11579    2         MODULE_ERR.SEV = 0;

  11579  9 001762   000002 236000 10                 LDQ     2
         9 001763   001670 356000 1                  ANSQ    MODULE_ERR

     1488    11580    2         CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  11580  9 001764   000000 236007 xsym               LDQ     M$LO,DL
         9 001765   200014 756100                    STQ     IOPT+7,,AUTO
         9 001766   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 001767   200017 450500                    STP0    IOPT+10,,AUTO
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:202  
         9 001770   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 001771   200016 756100                    STQ     IOPT+9,,AUTO
         9 001772   000003 236000 10                 LDQ     3
         9 001773   200015 756100                    STQ     IOPT+8,,AUTO
         9 001774   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 001775   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001776   000000 701000 xent               TSX1    XUR$ERRMSG
         9 001777   000000 011000                    NOP     0

     1489    11581    2      END;

     1490    11582
     1491    11583
     1492    11584    1      CALL M$CLOSE (CLOSE_OCMSG) ALTRET (CANT_CLOSE_OCMSG);

  11584  9 002000   001546 630400 1                  EPPR0   CLOSE_OCMSG
         9 002001   450001 713400                    CLIMB   alt,close
         9 002002   406000 401760                    pmme    nvectors=13
         9 002003   002654 702000 9                  TSX2    CANT_CLOSE_OCMSG

     1493    11585
     1494    11586                                                /* Close template file.               */
     1495    11587
     1496    11588    1      CALL M$CLOSE (CLOSE_LO) ALTRET (CANT_CLOSE_LO);

  11588  9 002004   002776 630400 1                  EPPR0   CLOSE_LO
         9 002005   450001 713400                    CLIMB   alt,close
         9 002006   406000 401760                    pmme    nvectors=13
         9 002007   002725 702000 9                  TSX2    CANT_CLOSE_LO

     1497    11589
     1498    11590    1      GOTO INITIALIZE;

  11590  9 002010   000145 710000 9                  TRA     INITIALIZE

  11590  9 002011                       CANT_WRITE   null
     1499    11591
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:203  
     1500    11592        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:204  
     1501    11593    1   CANT_WRITE:;
     1502    11594        /*E* ERROR: ORR-E_WRTERR#-7
     1503    11595             MESSAGE: An error took place on a call to M$WRITE
     1504    11596                                 */
     1505    11597    1      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;

  11597  9 002011   000000 470400 xsym               LDP0    B$TCB$
         9 002012   000000 471500                    LDP1    0,,PR0
         9 002013   100101 235100                    LDA     65,,PR1
         9 002014   000215 755000 1                  STA     DCB#

     1506    11598    1      MODULE_ERR.ERR# = 1 /* E_WRTERR# */;

  11598  9 002015   001670 236000 1                  LDQ     MODULE_ERR
         9 002016   000001 376000 10                 ANQ     1
         9 002017   000010 276007                    ORQ     8,DL
         9 002020   001670 756000 1                  STQ     MODULE_ERR

     1507    11599    1      MODULE_ERR.SEV = 0;

  11599  9 002021   000002 236000 10                 LDQ     2
         9 002022   001670 356000 1                  ANSQ    MODULE_ERR

     1508    11600    1      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

  11600  9 002023   000000 236007 xsym               LDQ     M$LO,DL
         9 002024   200014 756100                    STQ     IOPT+7,,AUTO
         9 002025   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 002026   200017 451500                    STP1    IOPT+10,,AUTO
         9 002027   000031 236000 10                 LDQ     25
         9 002030   200016 756100                    STQ     IOPT+9,,AUTO
         9 002031   000003 236000 10                 LDQ     3
         9 002032   200015 756100                    STQ     IOPT+8,,AUTO
         9 002033   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002034   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002035   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002036   000000 011000                    NOP     0
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:205  

     1509    11601    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11601  9 002037   000000 470400 xsym               LDP0    B$TCB$
         9 002040   000000 471500                    LDP1    0,,PR0
         9 002041   100102 236100                    LDQ     66,,PR1
         9 002042   001125 756000 1                  STQ     ERROR

     1510    11602    1      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

  11602  9 002043   000000 236007 xsym               LDQ     M$LO,DL
         9 002044   200014 756100                    STQ     IOPT+7,,AUTO
         9 002045   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 002046   200017 451500                    STP1    IOPT+10,,AUTO
         9 002047   000031 236000 10                 LDQ     25
         9 002050   200016 756100                    STQ     IOPT+9,,AUTO
         9 002051   000030 236000 10                 LDQ     24
         9 002052   200015 756100                    STQ     IOPT+8,,AUTO
         9 002053   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002054   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002055   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002056   000000 011000                    NOP     0

     1511    11603    1      CALL ORR$XCONRTN;

  11603  9 002057   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 002060   000000 701000 xent               TSX1    ORR$XCONRTN
         9 002061   000000 011000                    NOP     0

  11601  9 002062                       CANT_SET_ER* null
     1512    11604
     1513    11605    1   CANT_SET_ERRFID:;
     1514    11606        /*E* ERROR: ORR-E_SETFID#-7
     1515    11607             MESSAGE: An error was encountered on a call to
     1516    11608                      XUR$SETERRMSG with textc field "err_msg_fid".
     1517    11609                                 */
     1518    11610    1      MODULE_ERR.ERR# = 4 /* E_SETFID# */;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:206  

  11610  9 002062   001670 236000 1                  LDQ     MODULE_ERR
         9 002063   000001 376000 10                 ANQ     1
         9 002064   000040 276007                    ORQ     32,DL
         9 002065   001670 756000 1                  STQ     MODULE_ERR

     1519    11611    1      MODULE_ERR.SEV = 0;

  11611  9 002066   000002 236000 10                 LDQ     2
         9 002067   001670 356000 1                  ANSQ    MODULE_ERR

     1520    11612    1      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  11612  9 002070   000000 236007 xsym               LDQ     M$LO,DL
         9 002071   200014 756100                    STQ     IOPT+7,,AUTO
         9 002072   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 002073   200017 450500                    STP0    IOPT+10,,AUTO
         9 002074   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 002075   200016 756100                    STQ     IOPT+9,,AUTO
         9 002076   000003 236000 10                 LDQ     3
         9 002077   200015 756100                    STQ     IOPT+8,,AUTO
         9 002100   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002101   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002102   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002103   000000 011000                    NOP     0

     1521    11613    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11613  9 002104   000000 470400 xsym               LDP0    B$TCB$
         9 002105   000000 471500                    LDP1    0,,PR0
         9 002106   100102 236100                    LDQ     66,,PR1
         9 002107   001125 756000 1                  STQ     ERROR

     1522    11614    1      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));

  11614  9 002110   000000 236007 xsym               LDQ     M$LO,DL
         9 002111   200014 756100                    STQ     IOPT+7,,AUTO
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:207  
         9 002112   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 002113   200017 451500                    STP1    IOPT+10,,AUTO
         9 002114   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 002115   200016 756100                    STQ     IOPT+9,,AUTO
         9 002116   000030 236000 10                 LDQ     24
         9 002117   200015 756100                    STQ     IOPT+8,,AUTO
         9 002120   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002121   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002122   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002123   000000 011000                    NOP     0

     1523    11615    1      CALL ORR$XCONRTN;

  11615  9 002124   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 002125   000000 701000 xent               TSX1    ORR$XCONRTN
         9 002126   000000 011000                    NOP     0

  11613  9 002127                       CANT_CALL_I* null
     1524    11616
     1525    11617    1   CANT_CALL_INT:;
     1526    11618        /*E* ERROR: ORR-E_CALLINT#-7
     1527    11619             MESSAGE: Error on call to M$INT
     1528    11620                                 */
     1529    11621    1      MODULE_ERR.ERR# = 6 /* E_CALLINT# */;

  11621  9 002127   001670 236000 1                  LDQ     MODULE_ERR
         9 002130   000001 376000 10                 ANQ     1
         9 002131   000060 276007                    ORQ     48,DL
         9 002132   001670 756000 1                  STQ     MODULE_ERR

     1530    11622    1      MODULE_ERR.SEV = 0;

  11622  9 002133   000002 236000 10                 LDQ     2
         9 002134   001670 356000 1                  ANSQ    MODULE_ERR

     1531    11623    1      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:208  
  11623  9 002135   000000 236007 xsym               LDQ     M$LO,DL
         9 002136   200014 756100                    STQ     IOPT+7,,AUTO
         9 002137   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 002140   200017 450500                    STP0    IOPT+10,,AUTO
         9 002141   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 002142   200016 756100                    STQ     IOPT+9,,AUTO
         9 002143   000003 236000 10                 LDQ     3
         9 002144   200015 756100                    STQ     IOPT+8,,AUTO
         9 002145   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002146   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002147   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002150   000000 011000                    NOP     0

     1532    11624    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11624  9 002151   000000 470400 xsym               LDP0    B$TCB$
         9 002152   000000 471500                    LDP1    0,,PR0
         9 002153   100102 236100                    LDQ     66,,PR1
         9 002154   001125 756000 1                  STQ     ERROR

     1533    11625    1      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));

  11625  9 002155   000000 236007 xsym               LDQ     M$LO,DL
         9 002156   200014 756100                    STQ     IOPT+7,,AUTO
         9 002157   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 002160   200017 451500                    STP1    IOPT+10,,AUTO
         9 002161   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 002162   200016 756100                    STQ     IOPT+9,,AUTO
         9 002163   000030 236000 10                 LDQ     24
         9 002164   200015 756100                    STQ     IOPT+8,,AUTO
         9 002165   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002166   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002167   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002170   000000 011000                    NOP     0

     1534    11626    1      CALL ORR$XCONRTN;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:209  
  11626  9 002171   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 002172   000000 701000 xent               TSX1    ORR$XCONRTN
         9 002173   000000 011000                    NOP     0

  11624  9 002174                       CANT_CALL_X* null
     1535    11627
     1536    11628    1   CANT_CALL_XUR_ERRMSG:;
     1537    11629        /*E* ERROR: ORR-E_CALLXUR_ERRMSG#-7
     1538    11630             MESSAGE: Error at call to XUR$ERRMSG on syntax error cond.
     1539    11631                                 */
     1540    11632    1      MODULE_ERR.ERR# = 8 /* E_CALLXUR_ERRMSG# */;

  11632  9 002174   001670 236000 1                  LDQ     MODULE_ERR
         9 002175   000001 376000 10                 ANQ     1
         9 002176   000100 276007                    ORQ     64,DL
         9 002177   001670 756000 1                  STQ     MODULE_ERR

     1541    11633    1      MODULE_ERR.SEV = 0;

  11633  9 002200   000002 236000 10                 LDQ     2
         9 002201   001670 356000 1                  ANSQ    MODULE_ERR

     1542    11634    1      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  11634  9 002202   000000 236007 xsym               LDQ     M$LO,DL
         9 002203   200014 756100                    STQ     IOPT+7,,AUTO
         9 002204   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 002205   200017 450500                    STP0    IOPT+10,,AUTO
         9 002206   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 002207   200016 756100                    STQ     IOPT+9,,AUTO
         9 002210   000003 236000 10                 LDQ     3
         9 002211   200015 756100                    STQ     IOPT+8,,AUTO
         9 002212   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002213   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002214   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002215   000000 011000                    NOP     0

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:210  
     1543    11635    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11635  9 002216   000000 470400 xsym               LDP0    B$TCB$
         9 002217   000000 471500                    LDP1    0,,PR0
         9 002220   100102 236100                    LDQ     66,,PR1
         9 002221   001125 756000 1                  STQ     ERROR

     1544    11636    1      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));

  11636  9 002222   000000 236007 xsym               LDQ     M$LO,DL
         9 002223   200014 756100                    STQ     IOPT+7,,AUTO
         9 002224   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 002225   200017 451500                    STP1    IOPT+10,,AUTO
         9 002226   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 002227   200016 756100                    STQ     IOPT+9,,AUTO
         9 002230   000030 236000 10                 LDQ     24
         9 002231   200015 756100                    STQ     IOPT+8,,AUTO
         9 002232   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002233   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002234   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002235   000000 011000                    NOP     0

     1545    11637    1      CALL ORR$XCONRTN;

  11637  9 002236   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 002237   000000 701000 xent               TSX1    ORR$XCONRTN
         9 002240   000000 011000                    NOP     0

  11635  9 002241                       CANT_CALL_T* null
     1546    11638
     1547    11639    1   CANT_CALL_TIME_SIM:;
     1548    11640        /*E* ERROR: ORR-E_CALLTIMESIM#-7
     1549    11641             MESSAGE: Altret condition occurred on call to M$TIME
     1550    11642             The call was to convert UTS to LOCAL.
     1551    11643                                 */
     1552    11644    1      MODULE_ERR.ERR# = 10 /* E_CALLTIMESIM# */;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:211  
  11644  9 002241   001670 236000 1                  LDQ     MODULE_ERR
         9 002242   000001 376000 10                 ANQ     1
         9 002243   000120 276007                    ORQ     80,DL
         9 002244   001670 756000 1                  STQ     MODULE_ERR

     1553    11645    1      MODULE_ERR.SEV = 0;

  11645  9 002245   000002 236000 10                 LDQ     2
         9 002246   001670 356000 1                  ANSQ    MODULE_ERR

     1554    11646    1      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  11646  9 002247   000000 236007 xsym               LDQ     M$LO,DL
         9 002250   200014 756100                    STQ     IOPT+7,,AUTO
         9 002251   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 002252   200017 450500                    STP0    IOPT+10,,AUTO
         9 002253   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 002254   200016 756100                    STQ     IOPT+9,,AUTO
         9 002255   000003 236000 10                 LDQ     3
         9 002256   200015 756100                    STQ     IOPT+8,,AUTO
         9 002257   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002260   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002261   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002262   000000 011000                    NOP     0

     1555    11647    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11647  9 002263   000000 470400 xsym               LDP0    B$TCB$
         9 002264   000000 471500                    LDP1    0,,PR0
         9 002265   100102 236100                    LDQ     66,,PR1
         9 002266   001125 756000 1                  STQ     ERROR

     1556    11648    1      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));

  11648  9 002267   000000 236007 xsym               LDQ     M$LO,DL
         9 002270   200014 756100                    STQ     IOPT+7,,AUTO
         9 002271   200014 631500                    EPPR1   IOPT+7,,AUTO
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:212  
         9 002272   200017 451500                    STP1    IOPT+10,,AUTO
         9 002273   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 002274   200016 756100                    STQ     IOPT+9,,AUTO
         9 002275   000030 236000 10                 LDQ     24
         9 002276   200015 756100                    STQ     IOPT+8,,AUTO
         9 002277   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002300   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002301   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002302   000000 011000                    NOP     0

     1557    11649    1      CALL ORR$XCONRTN;

  11649  9 002303   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 002304   000000 701000 xent               TSX1    ORR$XCONRTN
         9 002305   000000 011000                    NOP     0

  11647  9 002306                       CANT_CALL_T* null
     1558    11650
     1559    11651    1   CANT_CALL_TIME_UTS:;
     1560    11652        /*E* ERROR: ORR-E_CALLTIMEUTS#-7
     1561    11653             MESSAGE: Altret condition occurred on call to M$TIME
     1562    11654             The call was to convert LOCAL to UTS.
     1563    11655                                 */
     1564    11656    1      MODULE_ERR.ERR# = 11 /* E_CALLTIMEUTS# */;

  11656  9 002306   001670 236000 1                  LDQ     MODULE_ERR
         9 002307   000001 376000 10                 ANQ     1
         9 002310   000130 276007                    ORQ     88,DL
         9 002311   001670 756000 1                  STQ     MODULE_ERR

     1565    11657    1      MODULE_ERR.SEV = 0;

  11657  9 002312   000002 236000 10                 LDQ     2
         9 002313   001670 356000 1                  ANSQ    MODULE_ERR

     1566    11658    1      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:213  
  11658  9 002314   000000 236007 xsym               LDQ     M$LO,DL
         9 002315   200014 756100                    STQ     IOPT+7,,AUTO
         9 002316   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 002317   200017 450500                    STP0    IOPT+10,,AUTO
         9 002320   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 002321   200016 756100                    STQ     IOPT+9,,AUTO
         9 002322   000003 236000 10                 LDQ     3
         9 002323   200015 756100                    STQ     IOPT+8,,AUTO
         9 002324   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002325   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002326   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002327   000000 011000                    NOP     0

     1567    11659    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11659  9 002330   000000 470400 xsym               LDP0    B$TCB$
         9 002331   000000 471500                    LDP1    0,,PR0
         9 002332   100102 236100                    LDQ     66,,PR1
         9 002333   001125 756000 1                  STQ     ERROR

     1568    11660    1      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));

  11660  9 002334   000000 236007 xsym               LDQ     M$LO,DL
         9 002335   200014 756100                    STQ     IOPT+7,,AUTO
         9 002336   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 002337   200017 451500                    STP1    IOPT+10,,AUTO
         9 002340   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 002341   200016 756100                    STQ     IOPT+9,,AUTO
         9 002342   000030 236000 10                 LDQ     24
         9 002343   200015 756100                    STQ     IOPT+8,,AUTO
         9 002344   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002345   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002346   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002347   000000 011000                    NOP     0

     1569    11661    1      CALL ORR$XCONRTN;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:214  
  11661  9 002350   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 002351   000000 701000 xent               TSX1    ORR$XCONRTN
         9 002352   000000 011000                    NOP     0

  11659  9 002353                       CANT_WRITE_* null
     1570    11662
     1571    11663    1   CANT_WRITE_TIME:;
     1572    11664        /*E* ERROR: ORR-E_WRTTIME#-7
     1573    11665             MESSAGE: Altret condition occurred on call to M$WRITE
     1574    11666             The call was to write an estimated console time.
     1575    11667                                 */
     1576    11668    1      MODULE_ERR.ERR# = 12 /* E_WRTTIME# */;

  11668  9 002353   001670 236000 1                  LDQ     MODULE_ERR
         9 002354   000001 376000 10                 ANQ     1
         9 002355   000140 276007                    ORQ     96,DL
         9 002356   001670 756000 1                  STQ     MODULE_ERR

     1577    11669    1      MODULE_ERR.SEV = 0;

  11669  9 002357   000002 236000 10                 LDQ     2
         9 002360   001670 356000 1                  ANSQ    MODULE_ERR

     1578    11670    1      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  11670  9 002361   000000 236007 xsym               LDQ     M$LO,DL
         9 002362   200014 756100                    STQ     IOPT+7,,AUTO
         9 002363   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 002364   200017 450500                    STP0    IOPT+10,,AUTO
         9 002365   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 002366   200016 756100                    STQ     IOPT+9,,AUTO
         9 002367   000003 236000 10                 LDQ     3
         9 002370   200015 756100                    STQ     IOPT+8,,AUTO
         9 002371   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002372   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002373   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002374   000000 011000                    NOP     0
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:215  

     1579    11671    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11671  9 002375   000000 470400 xsym               LDP0    B$TCB$
         9 002376   000000 471500                    LDP1    0,,PR0
         9 002377   100102 236100                    LDQ     66,,PR1
         9 002400   001125 756000 1                  STQ     ERROR

     1580    11672    1      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));

  11672  9 002401   000000 236007 xsym               LDQ     M$LO,DL
         9 002402   200014 756100                    STQ     IOPT+7,,AUTO
         9 002403   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 002404   200017 451500                    STP1    IOPT+10,,AUTO
         9 002405   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 002406   200016 756100                    STQ     IOPT+9,,AUTO
         9 002407   000030 236000 10                 LDQ     24
         9 002410   200015 756100                    STQ     IOPT+8,,AUTO
         9 002411   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002412   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002413   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002414   000000 011000                    NOP     0

     1581    11673    1      CALL ORR$XCONRTN;

  11673  9 002415   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 002416   000000 701000 xent               TSX1    ORR$XCONRTN
         9 002417   000000 011000                    NOP     0

  11671  9 002420                       CANT_OPEN_O* null
     1582    11674
     1583    11675    1   CANT_OPEN_OCMSG:;
     1584    11676        /*E* ERROR: ORR-E_OPENMSG#-7
     1585    11677             MESSAGE: Error at attempt to open :OCMSG file
     1586    11678                                 */
     1587    11679    1      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:216  
  11679  9 002420   000000 470400 xsym               LDP0    B$TCB$
         9 002421   000000 471500                    LDP1    0,,PR0
         9 002422   100101 235100                    LDA     65,,PR1
         9 002423   000215 755000 1                  STA     DCB#

     1588    11680    1      MODULE_ERR.ERR# = 3 /* E_OPENMSG# */;

  11680  9 002424   001670 236000 1                  LDQ     MODULE_ERR
         9 002425   000001 376000 10                 ANQ     1
         9 002426   000030 276007                    ORQ     24,DL
         9 002427   001670 756000 1                  STQ     MODULE_ERR

     1589    11681    1      MODULE_ERR.SEV = 0;

  11681  9 002430   000002 236000 10                 LDQ     2
         9 002431   001670 356000 1                  ANSQ    MODULE_ERR

     1590    11682    1      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

  11682  9 002432   000000 236007 xsym               LDQ     M$LO,DL
         9 002433   200014 756100                    STQ     IOPT+7,,AUTO
         9 002434   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 002435   200017 451500                    STP1    IOPT+10,,AUTO
         9 002436   000031 236000 10                 LDQ     25
         9 002437   200016 756100                    STQ     IOPT+9,,AUTO
         9 002440   000003 236000 10                 LDQ     3
         9 002441   200015 756100                    STQ     IOPT+8,,AUTO
         9 002442   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002443   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002444   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002445   000000 011000                    NOP     0

     1591    11683    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11683  9 002446   000000 470400 xsym               LDP0    B$TCB$
         9 002447   000000 471500                    LDP1    0,,PR0
         9 002450   100102 236100                    LDQ     66,,PR1
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:217  
         9 002451   001125 756000 1                  STQ     ERROR

     1592    11684    1      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

  11684  9 002452   000000 236007 xsym               LDQ     M$LO,DL
         9 002453   200014 756100                    STQ     IOPT+7,,AUTO
         9 002454   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 002455   200017 451500                    STP1    IOPT+10,,AUTO
         9 002456   000031 236000 10                 LDQ     25
         9 002457   200016 756100                    STQ     IOPT+9,,AUTO
         9 002460   000030 236000 10                 LDQ     24
         9 002461   200015 756100                    STQ     IOPT+8,,AUTO
         9 002462   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002463   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002464   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002465   000000 011000                    NOP     0

     1593    11685    1      CALL ORR$XCONRTN;

  11685  9 002466   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 002467   000000 701000 xent               TSX1    ORR$XCONRTN
         9 002470   000000 011000                    NOP     0

  11683  9 002471                       CANT_CALL_X* null
     1594    11686
     1595    11687    1   CANT_CALL_XCON:;
     1596    11688        /*E* ERROR: ORR-E_XCONERR#-7
     1597    11689             MESSAGE: Error on attempt to call M$XCON
     1598    11690                                 */
     1599    11691    1      MODULE_ERR.ERR# = 23 /* E_XCONERR */;

  11691  9 002471   001670 236000 1                  LDQ     MODULE_ERR
         9 002472   000001 376000 10                 ANQ     1
         9 002473   000270 276007                    ORQ     184,DL
         9 002474   001670 756000 1                  STQ     MODULE_ERR

     1600    11692    1      MODULE_ERR.SEV = 0;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:218  

  11692  9 002475   000002 236000 10                 LDQ     2
         9 002476   001670 356000 1                  ANSQ    MODULE_ERR

     1601    11693    1      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  11693  9 002477   000000 236007 xsym               LDQ     M$LO,DL
         9 002500   200014 756100                    STQ     IOPT+7,,AUTO
         9 002501   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 002502   200017 450500                    STP0    IOPT+10,,AUTO
         9 002503   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 002504   200016 756100                    STQ     IOPT+9,,AUTO
         9 002505   000003 236000 10                 LDQ     3
         9 002506   200015 756100                    STQ     IOPT+8,,AUTO
         9 002507   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002510   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002511   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002512   000000 011000                    NOP     0

     1602    11694    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11694  9 002513   000000 470400 xsym               LDP0    B$TCB$
         9 002514   000000 471500                    LDP1    0,,PR0
         9 002515   100102 236100                    LDQ     66,,PR1
         9 002516   001125 756000 1                  STQ     ERROR

     1603    11695    1      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));

  11695  9 002517   000000 236007 xsym               LDQ     M$LO,DL
         9 002520   200014 756100                    STQ     IOPT+7,,AUTO
         9 002521   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 002522   200017 451500                    STP1    IOPT+10,,AUTO
         9 002523   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 002524   200016 756100                    STQ     IOPT+9,,AUTO
         9 002525   000030 236000 10                 LDQ     24
         9 002526   200015 756100                    STQ     IOPT+8,,AUTO
         9 002527   200015 630500                    EPPR0   IOPT+8,,AUTO
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:219  
         9 002530   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002531   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002532   000000 011000                    NOP     0

     1604    11696    1      CALL ORR$XCONRTN;

  11696  9 002533   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 002534   000000 701000 xent               TSX1    ORR$XCONRTN
         9 002535   000000 011000                    NOP     0

  11694  9 002536                       CANT_OPEN_LO null
     1605    11697
     1606    11698
     1607    11699    1   CANT_OPEN_LO:;
     1608    11700        /*E* ERROR: ORR-E_OPENLO#-7
     1609    11701             MESSAGE: Error on attempt to open M$LO
     1610    11702                                 */
     1611    11703    1      MODULE_ERR.ERR# = 24 /* E_OPENLO# */;

  11703  9 002536   001670 236000 1                  LDQ     MODULE_ERR
         9 002537   000001 376000 10                 ANQ     1
         9 002540   000300 276007                    ORQ     192,DL
         9 002541   001670 756000 1                  STQ     MODULE_ERR

     1612    11704    1      MODULE_ERR.SEV = 0;

  11704  9 002542   000002 236000 10                 LDQ     2
         9 002543   001670 356000 1                  ANSQ    MODULE_ERR

     1613    11705    1      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;

  11705  9 002544   000000 470400 xsym               LDP0    B$TCB$
         9 002545   000000 471500                    LDP1    0,,PR0
         9 002546   100101 235100                    LDA     65,,PR1
         9 002547   000215 755000 1                  STA     DCB#

     1614    11706    1      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:220  

  11706  9 002550   000000 236007 xsym               LDQ     M$LO,DL
         9 002551   200014 756100                    STQ     IOPT+7,,AUTO
         9 002552   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 002553   200017 451500                    STP1    IOPT+10,,AUTO
         9 002554   000031 236000 10                 LDQ     25
         9 002555   200016 756100                    STQ     IOPT+9,,AUTO
         9 002556   000003 236000 10                 LDQ     3
         9 002557   200015 756100                    STQ     IOPT+8,,AUTO
         9 002560   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002561   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002562   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002563   000000 011000                    NOP     0

     1615    11707    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11707  9 002564   000000 470400 xsym               LDP0    B$TCB$
         9 002565   000000 471500                    LDP1    0,,PR0
         9 002566   100102 236100                    LDQ     66,,PR1
         9 002567   001125 756000 1                  STQ     ERROR

     1616    11708    1      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

  11708  9 002570   000000 236007 xsym               LDQ     M$LO,DL
         9 002571   200014 756100                    STQ     IOPT+7,,AUTO
         9 002572   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 002573   200017 451500                    STP1    IOPT+10,,AUTO
         9 002574   000031 236000 10                 LDQ     25
         9 002575   200016 756100                    STQ     IOPT+9,,AUTO
         9 002576   000030 236000 10                 LDQ     24
         9 002577   200015 756100                    STQ     IOPT+8,,AUTO
         9 002600   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002601   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002602   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002603   000000 011000                    NOP     0

     1617    11709    1      CALL ORR$XCONRTN;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:221  

  11709  9 002604   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 002605   000000 701000 xent               TSX1    ORR$XCONRTN
         9 002606   000000 011000                    NOP     0

  11707  9 002607                       CANT_PRECORD null
     1618    11710
     1619    11711    1   CANT_PRECORD:;
     1620    11712        /*E* ERROR: ORR-E_PRECERR#-7
     1621    11713             MESSAGE: Error on attempt to call M$PRECORD
     1622    11714                                 */
     1623    11715    1      MODULE_ERR.ERR# = 25 /* E_PRECERR# */;

  11715  9 002607   001670 236000 1                  LDQ     MODULE_ERR
         9 002610   000001 376000 10                 ANQ     1
         9 002611   000310 276007                    ORQ     200,DL
         9 002612   001670 756000 1                  STQ     MODULE_ERR

     1624    11716    1      MODULE_ERR.SEV = 0;

  11716  9 002613   000002 236000 10                 LDQ     2
         9 002614   001670 356000 1                  ANSQ    MODULE_ERR

     1625    11717    1      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  11717  9 002615   000000 236007 xsym               LDQ     M$LO,DL
         9 002616   200014 756100                    STQ     IOPT+7,,AUTO
         9 002617   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 002620   200017 450500                    STP0    IOPT+10,,AUTO
         9 002621   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 002622   200016 756100                    STQ     IOPT+9,,AUTO
         9 002623   000003 236000 10                 LDQ     3
         9 002624   200015 756100                    STQ     IOPT+8,,AUTO
         9 002625   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002626   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002627   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002630   000000 011000                    NOP     0
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:222  

     1626    11718    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11718  9 002631   000000 470400 xsym               LDP0    B$TCB$
         9 002632   000000 471500                    LDP1    0,,PR0
         9 002633   100102 236100                    LDQ     66,,PR1
         9 002634   001125 756000 1                  STQ     ERROR

     1627    11719    1      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));

  11719  9 002635   000000 236007 xsym               LDQ     M$LO,DL
         9 002636   200014 756100                    STQ     IOPT+7,,AUTO
         9 002637   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 002640   200017 451500                    STP1    IOPT+10,,AUTO
         9 002641   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 002642   200016 756100                    STQ     IOPT+9,,AUTO
         9 002643   000030 236000 10                 LDQ     24
         9 002644   200015 756100                    STQ     IOPT+8,,AUTO
         9 002645   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002646   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002647   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002650   000000 011000                    NOP     0

     1628    11720    1      CALL ORR$XCONRTN;

  11720  9 002651   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 002652   000000 701000 xent               TSX1    ORR$XCONRTN
         9 002653   000000 011000                    NOP     0

  11718  9 002654                       CANT_CLOSE_* null
     1629    11721
     1630    11722    1   CANT_CLOSE_OCMSG:;
     1631    11723        /*E* ERROR: ORR-E_OCMSG#-7
     1632    11724             MESSAGE: Error on attempt to close :OCMSG
     1633    11725                                 */
     1634    11726    1      MODULE_ERR.ERR# = 26 /* E_OCMSG# */;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:223  
  11726  9 002654   001670 236000 1                  LDQ     MODULE_ERR
         9 002655   000001 376000 10                 ANQ     1
         9 002656   000320 276007                    ORQ     208,DL
         9 002657   001670 756000 1                  STQ     MODULE_ERR

     1635    11727    1      MODULE_ERR.SEV = 0;

  11727  9 002660   000002 236000 10                 LDQ     2
         9 002661   001670 356000 1                  ANSQ    MODULE_ERR

     1636    11728    1      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;

  11728  9 002662   000000 470400 xsym               LDP0    B$TCB$
         9 002663   000000 471500                    LDP1    0,,PR0
         9 002664   100101 235100                    LDA     65,,PR1
         9 002665   000215 755000 1                  STA     DCB#

     1637    11729    1      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

  11729  9 002666   000000 236007 xsym               LDQ     M$LO,DL
         9 002667   200014 756100                    STQ     IOPT+7,,AUTO
         9 002670   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 002671   200017 451500                    STP1    IOPT+10,,AUTO
         9 002672   000031 236000 10                 LDQ     25
         9 002673   200016 756100                    STQ     IOPT+9,,AUTO
         9 002674   000003 236000 10                 LDQ     3
         9 002675   200015 756100                    STQ     IOPT+8,,AUTO
         9 002676   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002677   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002700   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002701   000000 011000                    NOP     0

     1638    11730    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11730  9 002702   000000 470400 xsym               LDP0    B$TCB$
         9 002703   000000 471500                    LDP1    0,,PR0
         9 002704   100102 236100                    LDQ     66,,PR1
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:224  
         9 002705   001125 756000 1                  STQ     ERROR

     1639    11731    1      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

  11731  9 002706   000000 236007 xsym               LDQ     M$LO,DL
         9 002707   200014 756100                    STQ     IOPT+7,,AUTO
         9 002710   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 002711   200017 451500                    STP1    IOPT+10,,AUTO
         9 002712   000031 236000 10                 LDQ     25
         9 002713   200016 756100                    STQ     IOPT+9,,AUTO
         9 002714   000030 236000 10                 LDQ     24
         9 002715   200015 756100                    STQ     IOPT+8,,AUTO
         9 002716   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002717   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002720   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002721   000000 011000                    NOP     0

     1640    11732    1      CALL ORR$XCONRTN;

  11732  9 002722   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 002723   000000 701000 xent               TSX1    ORR$XCONRTN
         9 002724   000000 011000                    NOP     0

  11730  9 002725                       CANT_CLOSE_* null
     1641    11733
     1642    11734    1   CANT_CLOSE_LO:;
     1643    11735        /*E* ERROR: ORR-E_CLOSELO#-7
     1644    11736             MESSAGE: Error on attempt to close M$LO
     1645    11737                                 */
     1646    11738    1      MODULE_ERR.ERR# = 27 /* E_CLOSELO# */;

  11738  9 002725   001670 236000 1                  LDQ     MODULE_ERR
         9 002726   000001 376000 10                 ANQ     1
         9 002727   000330 276007                    ORQ     216,DL
         9 002730   001670 756000 1                  STQ     MODULE_ERR

     1647    11739    1      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:225  

  11739  9 002731   000000 470400 xsym               LDP0    B$TCB$
         9 002732   000000 471500                    LDP1    0,,PR0
         9 002733   100101 235100                    LDA     65,,PR1
         9 002734   000215 755000 1                  STA     DCB#

     1648    11740    1      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

  11740  9 002735   000000 236007 xsym               LDQ     M$LO,DL
         9 002736   200014 756100                    STQ     IOPT+7,,AUTO
         9 002737   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 002740   200017 451500                    STP1    IOPT+10,,AUTO
         9 002741   000031 236000 10                 LDQ     25
         9 002742   200016 756100                    STQ     IOPT+9,,AUTO
         9 002743   000003 236000 10                 LDQ     3
         9 002744   200015 756100                    STQ     IOPT+8,,AUTO
         9 002745   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002746   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002747   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002750   000000 011000                    NOP     0

     1649    11741    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11741  9 002751   000000 470400 xsym               LDP0    B$TCB$
         9 002752   000000 471500                    LDP1    0,,PR0
         9 002753   100102 236100                    LDQ     66,,PR1
         9 002754   001125 756000 1                  STQ     ERROR

     1650    11742    1      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

  11742  9 002755   000000 236007 xsym               LDQ     M$LO,DL
         9 002756   200014 756100                    STQ     IOPT+7,,AUTO
         9 002757   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 002760   200017 451500                    STP1    IOPT+10,,AUTO
         9 002761   000031 236000 10                 LDQ     25
         9 002762   200016 756100                    STQ     IOPT+9,,AUTO
         9 002763   000030 236000 10                 LDQ     24
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:226  
         9 002764   200015 756100                    STQ     IOPT+8,,AUTO
         9 002765   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 002766   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002767   000000 701000 xent               TSX1    XUR$ERRMSG
         9 002770   000000 011000                    NOP     0

     1651    11743    1      CALL ORR$XCONRTN;

  11743  9 002771   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 002772   000000 701000 xent               TSX1    ORR$XCONRTN
         9 002773   000000 011000                    NOP     0

  11741  9 002774                       NO_SEGS      null
     1652    11744
     1653    11745    1   NO_SEGS: ;
     1654    11746        /*E* ERROR: ORR-E_NOSEGS#-7
     1655    11747             MESSAGE: Error on attempt to allocate segments
     1656    11748                                 */
     1657    11749    1      MODULE_ERR.ERR# = 36 /* E_NOSEGS# */;

  11749  9 002774   001670 236000 1                  LDQ     MODULE_ERR
         9 002775   000001 376000 10                 ANQ     1
         9 002776   000440 276007                    ORQ     288,DL
         9 002777   001670 756000 1                  STQ     MODULE_ERR

     1658    11750    1      MODULE_ERR.SEV = 0;

  11750  9 003000   000002 236000 10                 LDQ     2
         9 003001   001670 356000 1                  ANSQ    MODULE_ERR

     1659    11751    1      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  11751  9 003002   000000 236007 xsym               LDQ     M$LO,DL
         9 003003   200014 756100                    STQ     IOPT+7,,AUTO
         9 003004   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 003005   200017 450500                    STP0    IOPT+10,,AUTO
         9 003006   000001 236000 xsym               LDQ     B_VECTNIL+1
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:227  
         9 003007   200016 756100                    STQ     IOPT+9,,AUTO
         9 003010   000003 236000 10                 LDQ     3
         9 003011   200015 756100                    STQ     IOPT+8,,AUTO
         9 003012   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 003013   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003014   000000 701000 xent               TSX1    XUR$ERRMSG
         9 003015   000000 011000                    NOP     0

     1660    11752    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11752  9 003016   000000 470400 xsym               LDP0    B$TCB$
         9 003017   000000 471500                    LDP1    0,,PR0
         9 003020   100102 236100                    LDQ     66,,PR1
         9 003021   001125 756000 1                  STQ     ERROR

     1661    11753    1      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));

  11753  9 003022   000000 236007 xsym               LDQ     M$LO,DL
         9 003023   200014 756100                    STQ     IOPT+7,,AUTO
         9 003024   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 003025   200017 451500                    STP1    IOPT+10,,AUTO
         9 003026   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 003027   200016 756100                    STQ     IOPT+9,,AUTO
         9 003030   000030 236000 10                 LDQ     24
         9 003031   200015 756100                    STQ     IOPT+8,,AUTO
         9 003032   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 003033   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003034   000000 701000 xent               TSX1    XUR$ERRMSG
         9 003035   000000 011000                    NOP     0

     1662    11754    1      CALL ORR$XCONRTN;

  11754  9 003036   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 003037   000000 701000 xent               TSX1    ORR$XCONRTN
         9 003040   000000 011000                    NOP     0

  11752  9 003041                       FILE_TROUBLE null
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:228  
     1663    11755
     1664    11756    1   FILE_TROUBLE:;
     1665    11757        /*E* ERROR: ORR-E_NOFILE#-7
     1666    11758             MESSAGE: Unable to open necessary file
     1667    11759                                 */
     1668    11760    1      DCB# = B$TCB$->B$TCB.ALT$->B$ALT.DCB#;

  11760  9 003041   000000 470400 xsym               LDP0    B$TCB$
         9 003042   000000 471500                    LDP1    0,,PR0
         9 003043   100101 235100                    LDA     65,,PR1
         9 003044   000215 755000 1                  STA     DCB#

     1669    11761    1      MODULE_ERR.ERR# = 37 /* E_NOFILE# */;

  11761  9 003045   001670 236000 1                  LDQ     MODULE_ERR
         9 003046   000001 376000 10                 ANQ     1
         9 003047   000450 276007                    ORQ     296,DL
         9 003050   001670 756000 1                  STQ     MODULE_ERR

     1670    11762    1      MODULE_ERR.SEV = 0;

  11762  9 003051   000002 236000 10                 LDQ     2
         9 003052   001670 356000 1                  ANSQ    MODULE_ERR

     1671    11763    1      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

  11763  9 003053   000000 236007 xsym               LDQ     M$LO,DL
         9 003054   200014 756100                    STQ     IOPT+7,,AUTO
         9 003055   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 003056   200017 451500                    STP1    IOPT+10,,AUTO
         9 003057   000031 236000 10                 LDQ     25
         9 003060   200016 756100                    STQ     IOPT+9,,AUTO
         9 003061   000003 236000 10                 LDQ     3
         9 003062   200015 756100                    STQ     IOPT+8,,AUTO
         9 003063   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 003064   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003065   000000 701000 xent               TSX1    XUR$ERRMSG
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:229  
         9 003066   000000 011000                    NOP     0

     1672    11764    1      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11764  9 003067   000000 470400 xsym               LDP0    B$TCB$
         9 003070   000000 471500                    LDP1    0,,PR0
         9 003071   100102 236100                    LDQ     66,,PR1
         9 003072   001125 756000 1                  STQ     ERROR

     1673    11765    1      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

  11765  9 003073   000000 236007 xsym               LDQ     M$LO,DL
         9 003074   200014 756100                    STQ     IOPT+7,,AUTO
         9 003075   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 003076   200017 451500                    STP1    IOPT+10,,AUTO
         9 003077   000031 236000 10                 LDQ     25
         9 003100   200016 756100                    STQ     IOPT+9,,AUTO
         9 003101   000030 236000 10                 LDQ     24
         9 003102   200015 756100                    STQ     IOPT+8,,AUTO
         9 003103   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 003104   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003105   000000 701000 xent               TSX1    XUR$ERRMSG
         9 003106   000000 011000                    NOP     0

     1674    11766    1      ERROR.ERR# = 0;

  11766  9 003107   000001 236000 10                 LDQ     1
         9 003110   001125 356000 1                  ANSQ    ERROR

     1675    11767    1      CALL ORR$BRKRTN;

  11767  9 003111   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 003112   000000 701000 xent               TSX1    ORR$BRKRTN
         9 003113   000000 011000                    NOP     0

  11766  9 003114                       BAD_WILD     null
     1676    11768    1   BAD_WILD:;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:230  
     1677    11769        /*E* ERROR: ORR-E_BADWILD#-7
     1678    11770             MESSAGE: Unable to process this wildcard pattern
     1679    11771                                 */
     1680    11772    1      MODULE_ERR.ERR# = 42 /* E_BADWILD# */;

  11772  9 003114   001670 236000 1                  LDQ     MODULE_ERR
         9 003115   000001 376000 10                 ANQ     1
         9 003116   000520 276007                    ORQ     336,DL
         9 003117   001670 756000 1                  STQ     MODULE_ERR

     1681    11773    1      MODULE_ERR.SEV = 0;

  11773  9 003120   000002 236000 10                 LDQ     2
         9 003121   001670 356000 1                  ANSQ    MODULE_ERR

     1682    11774    1      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  11774  9 003122   000000 236007 xsym               LDQ     M$LO,DL
         9 003123   200014 756100                    STQ     IOPT+7,,AUTO
         9 003124   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 003125   200017 450500                    STP0    IOPT+10,,AUTO
         9 003126   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 003127   200016 756100                    STQ     IOPT+9,,AUTO
         9 003130   000003 236000 10                 LDQ     3
         9 003131   200015 756100                    STQ     IOPT+8,,AUTO
         9 003132   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 003133   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003134   000000 701000 xent               TSX1    XUR$ERRMSG
         9 003135   000000 011000                    NOP     0

     1683    11775    1      GOTO INITIALIZE;

  11775  9 003136   000145 710000 9                  TRA     INITIALIZE

  11773  9 003137                       CLOSE_OUT    null
     1684    11776    1   CLOSE_OUT:;
     1685    11777    1      CALL M$XCON (RESET_XCON);
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:231  

  11777  9 003137   003050 630400 1                  EPPR0   RESET_XCON
         9 003140   010003 713400                    CLIMB   4099
         9 003141   400400 401760                    pmme    nvectors=2

     1686    11778    1      CALL M$EXIT;

  11778  9 003142   000001 713400                    CLIMB   exit
         9 003143   000000 401760                    pmme    nvectors=0
         9 003144   011743 710000 9                  TRA     s:13416

     1687    11779        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:232  
     1688    11780         /*
     1689    11781                  S U B R O U T I N E   S E T _ D E F A U L T S
     1690    11782                                                */
     1691    11783
     1692    11784    1   SET_DEFAULTS: PROC;

  11784  9 003145   200004 741300       SET_DEFAULTS STX1  ! TEMP_UTS+1,,AUTO

     1693    11785    2      IF B$JIT$ -> B$JIT.PRFLAGS.SI

  11785  9 003146   000000 470400 xsym               LDP0    B$JIT$
         9 003147   000030 234100                    SZN     24,,PR0
         9 003150   003154 605000 9                  TPL     NO_INFO

     1694    11786
     1695    11787                                                /* Do if a specific file was
     1696    11788                                                     entered in command line
     1697    11789                                                     in M$SI (default) DCB.           */
     1698    11790
     1699    11791    2      THEN A_SPECIFIC_FILE = %YES#;

  11791  9 003151   400000 236003                    LDQ     -131072,DU
         9 003152   000664 756000 1                  STQ     A_SPECIFIC_FILE
         9 003153   003162 710000 9                  TRA     s:11803

     1700    11792    3      ELSE DO;

     1701    11793
     1702    11794                                                /* Else, the search for defaults
     1703    11795                                                     will begin in :OCHIST.           */
     1704    11796
     1705    11797    3   NO_INFO:
     1706    11798    3         FID_NAME.NAME# = ':OCHIST';

  11798  9 003154   040000 100400       NO_INFO      MLR     fill='040'O
         9 003155   000011 000007 8                  ADSC9   MOP_8_DIGITS_3+8         cn=0,n=7
         9 003156   001400 200037 1                  ADSC9   FID_NAME                 cn=1,n=31
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:233  

     1707    11799    3         FID_NAME.L# = SIZEC (':OCHIST');

  11799  9 003157   007000 236003                    LDQ     3584,DU
         9 003160   001400 552040 1                  STBQ    FID_NAME,'40'O

     1708    11800    3         A_SPECIFIC_FILE = %NO#;

  11800  9 003161   000664 450000 1                  STZ     A_SPECIFIC_FILE

     1709    11801    3      END;

     1710    11802
     1711    11803    2      CALL OPEN_SPECIFIC_FILE;

  11803  9 003162   003713 701000 9                  TSX1    OPEN_SPECIFIC_FILE
         9 003163   000000 011000                    NOP     0

     1712    11804    3      IF NO_FILE THEN DO;

  11804  9 003164   000752 234000 1                  SZN     NO_FILE
         9 003165   003170 605000 9                  TPL     s:11809

     1713    11805    3         NO_FILE = %NO#;

  11805  9 003166   000752 450000 1                  STZ     NO_FILE

     1714    11806    3         GOTO FILE_TROUBLE;

  11806  9 003167   003636 710000 9                  TRA     FILE_TROUBLE

     1715    11807    3      END;
     1716    11808
     1717    11809    2      OCL_NORM_KEY.COUNT = 4;

  11809  9 003170   004000 236003                    LDQ     2048,DU
         9 003171   000000 552040 xsym               STBQ    OCL_NORM_KEY,'40'O
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:234  

     1718    11810    2      OCL_NORM_KEY.UTS = 15000;

  11810  9 003172   000000 100400                    MLR     fill='000'O
         9 003173   000032 000004 10                 ADSC9   26                       cn=0,n=4
         9 003174   000000 200004 xsym               ADSC9   OCL_NORM_KEY             cn=1,n=4

     1719    11811    2      HIST_POSITION.V.N# = 0;

  11811  9 003175   002153 450000 1                  STZ     HIST_POSITION+7

     1720    11812    3      CALL M$PRECORD (HIST_POSITION) WHENALTRETURN DO; END;

  11812  9 003176   002144 630400 1                  EPPR0   HIST_POSITION
         9 003177   440003 713400                    CLIMB   alt,+16387
         9 003200   401000 401760                    pmme    nvectors=3
         9 003201   003203 702000 9                  TSX2    s:11814
         9 003202   003203 710000 9                  TRA     s:11814

     1721    11813
     1722    11814    2      READ_HISTORYE.V.KEYS# = %YES#;

  11814  9 003203   200000 236007                    LDQ     65536,DL
         9 003204   001774 256000 1                  ORSQ    READ_HISTORYE+8

     1723    11815
     1724    11816    2      CALL M$READ (READ_HISTORYE) ALTRET (CANT_READ_HIST);

  11816  9 003205   001764 630400 1                  EPPR0   READ_HISTORYE
         9 003206   440000 713400                    CLIMB   alt,read
         9 003207   401400 401760                    pmme    nvectors=4
         9 003210   003356 702000 9                  TSX2    CANT_READ_HIST

     1725    11817    2      BEGINNING_TIME = OCL_NORM_KEY.UTS;

  11817  9 003211   000000 235000 xsym               LDA     OCL_NORM_KEY
         9 003212   000001 236000 xsym               LDQ     OCL_NORM_KEY+1
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:235  
         9 003213   000033 773000                    LRL     27
         9 003214   000300 756000 1                  STQ     BEGINNING_TIME

     1726    11818
     1727    11819                                                /* Set default beginning time
     1728    11820                                                     to UTS of first history
     1729    11821                                                     record in current history
     1730    11822                                                     file (usually :OCHIST).          */
     1731    11823
     1732    11824    2      CALL M$PFIL (POSITION_AT_END) ALTRET (BROKEN_FILE_PLACE);

  11824  9 003215   002472 630400 1                  EPPR0   POSITION_AT_END
         9 003216   440004 713400                    CLIMB   alt,+16388
         9 003217   400000 401760                    pmme    nvectors=1
         9 003220   003244 702000 9                  TSX2    BROKEN_FILE_PLACE

     1733    11825    2      FIRST_HIST_REC.V.N# = -1;

  11825  9 003221   000001 335007                    LCA     1,DL
         9 003222   002423 755000 1                  STA     FIRST_HIST_REC+7

     1734    11826    2      CALL M$PRECORD (FIRST_HIST_REC) ALTRET (CANT_PRECORD);

  11826  9 003223   002414 630400 1                  EPPR0   FIRST_HIST_REC
         9 003224   440003 713400                    CLIMB   alt,+16387
         9 003225   401000 401760                    pmme    nvectors=3
         9 003226   003571 702000 9                  TSX2    CANT_PRECORD

     1735    11827    2      READ_HISTORYE.V.KEYS# = %NO#;

  11827  9 003227   000033 236000 10                 LDQ     27
         9 003230   001774 356000 1                  ANSQ    READ_HISTORYE+8

     1736    11828    2      CALL M$READ (READ_HISTORYE) ALTRET (CANT_READ_HIST);

  11828  9 003231   001764 630400 1                  EPPR0   READ_HISTORYE
         9 003232   440000 713400                    CLIMB   alt,read
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:236  
         9 003233   401400 401760                    pmme    nvectors=4
         9 003234   003356 702000 9                  TSX2    CANT_READ_HIST

     1737    11829    2      ENDING_TIME = OCL_NORM_KEY.UTS;

  11829  9 003235   000000 235000 xsym               LDA     OCL_NORM_KEY
         9 003236   000001 236000 xsym               LDQ     OCL_NORM_KEY+1
         9 003237   000033 773000                    LRL     27
         9 003240   000301 756000 1                  STQ     ENDING_TIME

     1738    11830    2      READ_HISTORYE.V.KEYS# = %YES#;

  11830  9 003241   200000 236007                    LDQ     65536,DL
         9 003242   001774 256000 1                  ORSQ    READ_HISTORYE+8

     1739    11831
     1740    11832                                                /* Set default ending time
     1741    11833                                                   to UTS of first history
     1742    11834                                                   record in current history
     1743    11835                                                   file (usually :OCHIST).            */
     1744    11836
     1745    11837    3      DO WHILE ('0'B);

  11837  9 003243   003254 710000 9                  TRA     s:11845

     1746    11838    3   BROKEN_FILE_PLACE:
     1747    11839    3         BROKEN_FILE = %YES#;

  11839  9 003244   400000 236003       BROKEN_FILE* LDQ     -131072,DU
         9 003245   000712 756000 1                  STQ     BROKEN_FILE

     1748    11840    3         ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11840  9 003246   000000 470400 xsym               LDP0    B$TCB$
         9 003247   000000 471500                    LDP1    0,,PR0
         9 003250   100102 236100                    LDQ     66,,PR1
         9 003251   001125 756000 1                  STQ     ERROR
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:237  

     1749    11841    3         ENDING_TIME_REDEF = '777773220400'O; /* MIDNIGHT BEFORE ROLLOVER        */

  11841  9 003252   000034 236000 8                  LDQ     MOP_8_DIGITS_3+27
         9 003253   000301 756000 1                  STQ     ENDING_TIME

     1750    11842    3      END;

     1751    11843
     1752    11844
     1753    11845    2      CALL CLOSE_SPECIFIC_FILE;

  11845  9 003254   004454 701000 9                  TSX1    CLOSE_SPECIFIC_FILE
         9 003255   000000 011000                    NOP     0

     1754    11846
     1755    11847
     1756    11848                                                /* Set other defaults.                */
     1757    11849
     1758    11850    2      TIME_SET.TSTAMP_ =VECTOR (BEGINNING_TIME);

  11850  9 003256   000034 237000 10                 LDAQ    28
         9 003257   002202 757000 1                  STAQ    TIME_SET+8

     1759    11851    2      CALL M$TIME (TIME_SET) ALTRET (CANT_CALL_TIME);

  11851  9 003260   002172 630400 1                  EPPR0   TIME_SET
         9 003261   420004 713400                    CLIMB   alt,+8196
         9 003262   402000 401760                    pmme    nvectors=5
         9 003263   003453 702000 9                  TSX2    CANT_CALL_TIME

     1760    11852
     1761    11853    3      IF NOT OPERATOR_ENTERED_TIME1 THEN DO;

  11853  9 003264   000651 234000 1                  SZN     OPERATOR_ENTERED_TIME1
         9 003265   003276 604000 9                  TMI     s:11860

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:238  
     1762    11854    3         HOUR1 = TIME_BUF(0);

  11854  9 003266   000304 220000 1                  LDX0    TIME_BUF
         9 003267   000174 740000 1                  STX0    HOUR1

     1763    11855    3         MIN1 = TIME_BUF(1);

  11855  9 003270   000304 721000 1                  LXL1    TIME_BUF
         9 003271   000175 741000 1                  STX1    MIN1

     1764    11856    3         SEC1 = TIME_BUF(2);

  11856  9 003272   000305 222000 1                  LDX2    TIME_BUF+1
         9 003273   000176 742000 1                  STX2    SEC1

     1765    11857    3         CENTISEC1 = TIME_BUF(3);

  11857  9 003274   000305 723000 1                  LXL3    TIME_BUF+1
         9 003275   000177 743000 1                  STX3    CENTISEC1

     1766    11858    3      END;

     1767    11859
     1768    11860    3      IF NOT OPERATOR_ENTERED_DATE1 THEN DO;

  11860  9 003276   000652 234000 1                  SZN     OPERATOR_ENTERED_DATE1
         9 003277   003306 604000 9                  TMI     s:11873

     1769    11861    3         YEAR1 = DATE_BUF(0);

  11861  9 003300   000302 220000 1                  LDX0    DATE_BUF
         9 003301   000202 740000 1                  STX0    YEAR1

     1770    11862    3         MONTH1 = DATE_BUF(1);

  11862  9 003302   000302 721000 1                  LXL1    DATE_BUF
         9 003303   000200 741000 1                  STX1    MONTH1
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:239  

     1771    11863    3         DAY1 = DATE_BUF(2);

  11863  9 003304   000303 222000 1                  LDX2    DATE_BUF+1
         9 003305   000201 742000 1                  STX2    DAY1

     1772    11864    3      END;

     1773    11865
     1774    11866                                                /* Store beginning time in
     1775    11867                                                     character format, so
     1776    11868                                                     individual time parts can
     1777    11869                                                     be overridden with entries
     1778    11870                                                     from parse blocks.               */
     1779    11871
     1780    11872
     1781    11873    2      TIME_SET.TSTAMP_ = VECTOR (ENDING_TIME);

  11873  9 003306   000036 237000 10                 LDAQ    30
         9 003307   002202 757000 1                  STAQ    TIME_SET+8

     1782    11874    2      CALL M$TIME (TIME_SET) ALTRET (CANT_CALL_TIME);

  11874  9 003310   002172 630400 1                  EPPR0   TIME_SET
         9 003311   420004 713400                    CLIMB   alt,+8196
         9 003312   402000 401760                    pmme    nvectors=5
         9 003313   003453 702000 9                  TSX2    CANT_CALL_TIME

     1783    11875
     1784    11876    3      IF NOT OPERATOR_ENTERED_TIME2 THEN DO;

  11876  9 003314   000653 234000 1                  SZN     OPERATOR_ENTERED_TIME2
         9 003315   003326 604000 9                  TMI     s:11883

     1785    11877    3         HOUR2 = TIME_BUF(0);

  11877  9 003316   000304 220000 1                  LDX0    TIME_BUF
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:240  
         9 003317   000203 740000 1                  STX0    HOUR2

     1786    11878    3         MIN2 = TIME_BUF(1);

  11878  9 003320   000304 721000 1                  LXL1    TIME_BUF
         9 003321   000204 741000 1                  STX1    MIN2

     1787    11879    3         SEC2 = TIME_BUF(2);

  11879  9 003322   000305 222000 1                  LDX2    TIME_BUF+1
         9 003323   000205 742000 1                  STX2    SEC2

     1788    11880    3         CENTISEC2 = TIME_BUF(3);

  11880  9 003324   000305 723000 1                  LXL3    TIME_BUF+1
         9 003325   000206 743000 1                  STX3    CENTISEC2

     1789    11881    3      END;

     1790    11882
     1791    11883    3      IF NOT OPERATOR_ENTERED_DATE2 THEN DO;

  11883  9 003326   000654 234000 1                  SZN     OPERATOR_ENTERED_DATE2
         9 003327   003336 604000 9                  TMI     s:11897

     1792    11884    3         YEAR2 = DATE_BUF(0);

  11884  9 003330   000302 220000 1                  LDX0    DATE_BUF
         9 003331   000211 740000 1                  STX0    YEAR2

     1793    11885    3         MONTH2 = DATE_BUF(1);

  11885  9 003332   000302 721000 1                  LXL1    DATE_BUF
         9 003333   000207 741000 1                  STX1    MONTH2

     1794    11886    3         DAY2 = DATE_BUF(2);

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:241  
  11886  9 003334   000303 222000 1                  LDX2    DATE_BUF+1
         9 003335   000210 742000 1                  STX2    DAY2

     1795    11887    3      END;

     1796    11888
     1797    11889
     1798    11890                                                /* Store ending time in
     1799    11891                                                     character format, so
     1800    11892                                                     individual time parts can
     1801    11893                                                     be overridden with entries
     1802    11894                                                     from parse blocks.               */
     1803    11895
     1804    11896
     1805    11897    2      IF OPERATOR_ENTERED_TIME1

  11897  9 003336   000651 234000 1                  SZN     OPERATOR_ENTERED_TIME1
         9 003337   003350 605000 9                  TPL     s:11910
         9 003340   000652 234000 1                  SZN     OPERATOR_ENTERED_DATE1
         9 003341   003350 604000 9                  TMI     s:11910

     1806    11898    3        AND NOT OPERATOR_ENTERED_DATE1 THEN DO;

     1807    11899
     1808    11900                                                /*   "SPAN 10:00-11:00"
     1809    11901                                                  or "SPAN 10:00-11:00,1/1/83"
     1810    11902                                        Force the same date as the end of the range,
     1811    11903                                        whatever that might have been.                */
     1812    11904
     1813    11905    3         YEAR1 = YEAR2;

  11905  9 003342   000211 220000 1                  LDX0    YEAR2
         9 003343   000202 740000 1                  STX0    YEAR1

     1814    11906    3         MONTH1 = MONTH2;

  11906  9 003344   000207 221000 1                  LDX1    MONTH2
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:242  
         9 003345   000200 741000 1                  STX1    MONTH1

     1815    11907    3         DAY1 = DAY2;

  11907  9 003346   000210 222000 1                  LDX2    DAY2
         9 003347   000201 742000 1                  STX2    DAY1

     1816    11908    3      END;

     1817    11909
     1818    11910    3      IF BROKEN_FILE THEN DO;

  11910  9 003350   000712 234000 1                  SZN     BROKEN_FILE
         9 003351   003354 605000 9                  TPL     s:11914

     1819    11911    3         BROKEN_FILE = %NO#;

  11911  9 003352   000712 450000 1                  STZ     BROKEN_FILE

     1820    11912    3         GOTO CANT_POSITION_AT_END;

  11912  9 003353   003427 710000 9                  TRA     CANT_POSITION_AT_END

     1821    11913    3      END;
     1822    11914    2      RETURN;

  11914  9 003354   200004 221300                    LDX1  ! TEMP_UTS+1,,AUTO
         9 003355   000001 702211                    TSX2  ! 1,X1

  11910  9 003356                       CANT_READ_H* null
     1823    11915
     1824    11916    2   CANT_READ_HIST:;
     1825    11917        /*E* ERROR: ORR-E_HSTREAD#-7
     1826    11918             MESSAGE: REPLAY cannot read the history file
     1827    11919                          -- :OCHIST may not exist --
     1828    11920                                 */
     1829    11921    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:243  

  11921  9 003356   000000 470400 xsym               LDP0    B$TCB$
         9 003357   000000 471500                    LDP1    0,,PR0
         9 003360   100101 235100                    LDA     65,,PR1
         9 003361   000215 755000 1                  STA     DCB#

     1830    11922    2      MODULE_ERR.ERR# = 20 /* E_HSTREAD# */;

  11922  9 003362   001670 236000 1                  LDQ     MODULE_ERR
         9 003363   000001 376000 10                 ANQ     1
         9 003364   000240 276007                    ORQ     160,DL
         9 003365   001670 756000 1                  STQ     MODULE_ERR

     1831    11923    2      MODULE_ERR.SEV = 0;

  11923  9 003366   000002 236000 10                 LDQ     2
         9 003367   001670 356000 1                  ANSQ    MODULE_ERR

     1832    11924    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

  11924  9 003370   000000 236007 xsym               LDQ     M$LO,DL
         9 003371   200014 756100                    STQ     IOPT+7,,AUTO
         9 003372   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 003373   200017 451500                    STP1    IOPT+10,,AUTO
         9 003374   000031 236000 10                 LDQ     25
         9 003375   200016 756100                    STQ     IOPT+9,,AUTO
         9 003376   000003 236000 10                 LDQ     3
         9 003377   200015 756100                    STQ     IOPT+8,,AUTO
         9 003400   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 003401   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003402   000000 701000 xent               TSX1    XUR$ERRMSG
         9 003403   000000 011000                    NOP     0

     1833    11925    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11925  9 003404   000000 470400 xsym               LDP0    B$TCB$
         9 003405   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:244  
         9 003406   100102 236100                    LDQ     66,,PR1
         9 003407   001125 756000 1                  STQ     ERROR

     1834    11926    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

  11926  9 003410   000000 236007 xsym               LDQ     M$LO,DL
         9 003411   200014 756100                    STQ     IOPT+7,,AUTO
         9 003412   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 003413   200017 451500                    STP1    IOPT+10,,AUTO
         9 003414   000031 236000 10                 LDQ     25
         9 003415   200016 756100                    STQ     IOPT+9,,AUTO
         9 003416   000030 236000 10                 LDQ     24
         9 003417   200015 756100                    STQ     IOPT+8,,AUTO
         9 003420   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 003421   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003422   000000 701000 xent               TSX1    XUR$ERRMSG
         9 003423   000000 011000                    NOP     0

     1835    11927    2      CALL ORR$XCONRTN;

  11927  9 003424   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 003425   000000 701000 xent               TSX1    ORR$XCONRTN
         9 003426   000000 011000                    NOP     0

  11925  9 003427                       CANT_POSITI* null
     1836    11928
     1837    11929    2   CANT_POSITION_AT_END:;
     1838    11930        /*E* ERROR: ORR-E_POSERR#-7
     1839    11931             MESSAGE: WARNING: Default history file is broken
     1840    11932                                 */
     1841    11933    2      MODULE_ERR.ERR# = 21 /* E_POSERR# */;

  11933  9 003427   001670 236000 1                  LDQ     MODULE_ERR
         9 003430   000001 376000 10                 ANQ     1
         9 003431   000250 276007                    ORQ     168,DL
         9 003432   001670 756000 1                  STQ     MODULE_ERR

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:245  
     1842    11934    2      MODULE_ERR.SEV = 0;

  11934  9 003433   000002 236000 10                 LDQ     2
         9 003434   001670 356000 1                  ANSQ    MODULE_ERR

     1843    11935    2      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  11935  9 003435   000000 236007 xsym               LDQ     M$LO,DL
         9 003436   200014 756100                    STQ     IOPT+7,,AUTO
         9 003437   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 003440   200017 450500                    STP0    IOPT+10,,AUTO
         9 003441   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 003442   200016 756100                    STQ     IOPT+9,,AUTO
         9 003443   000003 236000 10                 LDQ     3
         9 003444   200015 756100                    STQ     IOPT+8,,AUTO
         9 003445   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 003446   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003447   000000 701000 xent               TSX1    XUR$ERRMSG
         9 003450   000000 011000                    NOP     0

     1844    11936    2      RETURN;

  11936  9 003451   200004 221300                    LDX1  ! TEMP_UTS+1,,AUTO
         9 003452   000001 702211                    TSX2  ! 1,X1

  11934  9 003453                       CANT_CALL_T* null
     1845    11937
     1846    11938    2   CANT_CALL_TIME:;
     1847    11939        /*E* ERROR: ORR-E_CALLTIME#-7
     1848    11940             MESSAGE: Altret on call to M$TIME in subroutine SET_DEFAULTS
     1849    11941                                 */
     1850    11942    2      MODULE_ERR.ERR# = 22 /* E_CALLTIME# */;

  11942  9 003453   001670 236000 1                  LDQ     MODULE_ERR
         9 003454   000001 376000 10                 ANQ     1
         9 003455   000260 276007                    ORQ     176,DL
         9 003456   001670 756000 1                  STQ     MODULE_ERR
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:246  

     1851    11943    2      MODULE_ERR.SEV = 0;

  11943  9 003457   000002 236000 10                 LDQ     2
         9 003460   001670 356000 1                  ANSQ    MODULE_ERR

     1852    11944    2      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  11944  9 003461   000000 236007 xsym               LDQ     M$LO,DL
         9 003462   200014 756100                    STQ     IOPT+7,,AUTO
         9 003463   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 003464   200017 450500                    STP0    IOPT+10,,AUTO
         9 003465   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 003466   200016 756100                    STQ     IOPT+9,,AUTO
         9 003467   000003 236000 10                 LDQ     3
         9 003470   200015 756100                    STQ     IOPT+8,,AUTO
         9 003471   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 003472   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003473   000000 701000 xent               TSX1    XUR$ERRMSG
         9 003474   000000 011000                    NOP     0

     1853    11945    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11945  9 003475   000000 470400 xsym               LDP0    B$TCB$
         9 003476   000000 471500                    LDP1    0,,PR0
         9 003477   100102 236100                    LDQ     66,,PR1
         9 003500   001125 756000 1                  STQ     ERROR

     1854    11946    2      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));

  11946  9 003501   000000 236007 xsym               LDQ     M$LO,DL
         9 003502   200014 756100                    STQ     IOPT+7,,AUTO
         9 003503   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 003504   200017 451500                    STP1    IOPT+10,,AUTO
         9 003505   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 003506   200016 756100                    STQ     IOPT+9,,AUTO
         9 003507   000030 236000 10                 LDQ     24
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:247  
         9 003510   200015 756100                    STQ     IOPT+8,,AUTO
         9 003511   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 003512   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003513   000000 701000 xent               TSX1    XUR$ERRMSG
         9 003514   000000 011000                    NOP     0

     1855    11947    2      CALL ORR$XCONRTN;

  11947  9 003515   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 003516   000000 701000 xent               TSX1    ORR$XCONRTN
         9 003517   000000 011000                    NOP     0

  11945  9 003520                       CANT_READ_S* null
     1856    11948
     1857    11949    2   CANT_READ_STATUS:;
     1858    11950        /*E* ERROR: ORR-E_READSTATERR#-7
     1859    11951             MESSAGE: Altret on attempt to read status record
     1860    11952                                 */
     1861    11953    2      MODULE_ERR.ERR# = 28 /* E_READSTATERR# */;

  11953  9 003520   001670 236000 1                  LDQ     MODULE_ERR
         9 003521   000001 376000 10                 ANQ     1
         9 003522   000340 276007                    ORQ     224,DL
         9 003523   001670 756000 1                  STQ     MODULE_ERR

     1862    11954    2      MODULE_ERR.SEV = 0;

  11954  9 003524   000002 236000 10                 LDQ     2
         9 003525   001670 356000 1                  ANSQ    MODULE_ERR

     1863    11955    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;

  11955  9 003526   000000 470400 xsym               LDP0    B$TCB$
         9 003527   000000 471500                    LDP1    0,,PR0
         9 003530   100101 235100                    LDA     65,,PR1
         9 003531   000215 755000 1                  STA     DCB#

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:248  
     1864    11956    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

  11956  9 003532   000000 236007 xsym               LDQ     M$LO,DL
         9 003533   200014 756100                    STQ     IOPT+7,,AUTO
         9 003534   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 003535   200017 451500                    STP1    IOPT+10,,AUTO
         9 003536   000031 236000 10                 LDQ     25
         9 003537   200016 756100                    STQ     IOPT+9,,AUTO
         9 003540   000003 236000 10                 LDQ     3
         9 003541   200015 756100                    STQ     IOPT+8,,AUTO
         9 003542   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 003543   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003544   000000 701000 xent               TSX1    XUR$ERRMSG
         9 003545   000000 011000                    NOP     0

     1865    11957    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11957  9 003546   000000 470400 xsym               LDP0    B$TCB$
         9 003547   000000 471500                    LDP1    0,,PR0
         9 003550   100102 236100                    LDQ     66,,PR1
         9 003551   001125 756000 1                  STQ     ERROR

     1866    11958    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

  11958  9 003552   000000 236007 xsym               LDQ     M$LO,DL
         9 003553   200014 756100                    STQ     IOPT+7,,AUTO
         9 003554   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 003555   200017 451500                    STP1    IOPT+10,,AUTO
         9 003556   000031 236000 10                 LDQ     25
         9 003557   200016 756100                    STQ     IOPT+9,,AUTO
         9 003560   000030 236000 10                 LDQ     24
         9 003561   200015 756100                    STQ     IOPT+8,,AUTO
         9 003562   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 003563   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003564   000000 701000 xent               TSX1    XUR$ERRMSG
         9 003565   000000 011000                    NOP     0

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:249  
     1867    11959    2      CALL ORR$XCONRTN;

  11959  9 003566   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 003567   000000 701000 xent               TSX1    ORR$XCONRTN
         9 003570   000000 011000                    NOP     0

  11957  9 003571                       CANT_PRECORD null
     1868    11960
     1869    11961    2   CANT_PRECORD:;
     1870    11962    2      MODULE_ERR.ERR# = 25 /* E_PRECERR# */;

  11962  9 003571   001670 236000 1                  LDQ     MODULE_ERR
         9 003572   000001 376000 10                 ANQ     1
         9 003573   000310 276007                    ORQ     200,DL
         9 003574   001670 756000 1                  STQ     MODULE_ERR

     1871    11963    2      MODULE_ERR.SEV = 0;

  11963  9 003575   000002 236000 10                 LDQ     2
         9 003576   001670 356000 1                  ANSQ    MODULE_ERR

     1872    11964    2      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  11964  9 003577   000000 236007 xsym               LDQ     M$LO,DL
         9 003600   200014 756100                    STQ     IOPT+7,,AUTO
         9 003601   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 003602   200017 450500                    STP0    IOPT+10,,AUTO
         9 003603   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 003604   200016 756100                    STQ     IOPT+9,,AUTO
         9 003605   000003 236000 10                 LDQ     3
         9 003606   200015 756100                    STQ     IOPT+8,,AUTO
         9 003607   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 003610   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003611   000000 701000 xent               TSX1    XUR$ERRMSG
         9 003612   000000 011000                    NOP     0

     1873    11965    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:250  

  11965  9 003613   000000 470400 xsym               LDP0    B$TCB$
         9 003614   000000 471500                    LDP1    0,,PR0
         9 003615   100102 236100                    LDQ     66,,PR1
         9 003616   001125 756000 1                  STQ     ERROR

     1874    11966    2      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));

  11966  9 003617   000000 236007 xsym               LDQ     M$LO,DL
         9 003620   200014 756100                    STQ     IOPT+7,,AUTO
         9 003621   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 003622   200017 451500                    STP1    IOPT+10,,AUTO
         9 003623   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 003624   200016 756100                    STQ     IOPT+9,,AUTO
         9 003625   000030 236000 10                 LDQ     24
         9 003626   200015 756100                    STQ     IOPT+8,,AUTO
         9 003627   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 003630   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003631   000000 701000 xent               TSX1    XUR$ERRMSG
         9 003632   000000 011000                    NOP     0

     1875    11967    2      CALL ORR$XCONRTN;

  11967  9 003633   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 003634   000000 701000 xent               TSX1    ORR$XCONRTN
         9 003635   000000 011000                    NOP     0

  11965  9 003636                       FILE_TROUBLE null
     1876    11968
     1877    11969    2   FILE_TROUBLE:;
     1878    11970        /*E* ERROR: ORR-E_CANTOPEN#-7
     1879    11971             MESSAGE: Cannot open the right file in order
     1880    11972                            to set proper defaults
     1881    11973                                 */
     1882    11974    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;

  11974  9 003636   000000 470400 xsym               LDP0    B$TCB$
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:251  
         9 003637   000000 471500                    LDP1    0,,PR0
         9 003640   100101 235100                    LDA     65,,PR1
         9 003641   000215 755000 1                  STA     DCB#

     1883    11975    2      MODULE_ERR.ERR# = 38 /* E_CANTOPEN# */;

  11975  9 003642   001670 236000 1                  LDQ     MODULE_ERR
         9 003643   000001 376000 10                 ANQ     1
         9 003644   000460 276007                    ORQ     304,DL
         9 003645   001670 756000 1                  STQ     MODULE_ERR

     1884    11976    2      MODULE_ERR.SEV = 0;

  11976  9 003646   000002 236000 10                 LDQ     2
         9 003647   001670 356000 1                  ANSQ    MODULE_ERR

     1885    11977    2      CALL XUR$ERRMSG (MODULE_ERR, DCB#, DCBNUM(M$LO));

  11977  9 003650   000000 236007 xsym               LDQ     M$LO,DL
         9 003651   200014 756100                    STQ     IOPT+7,,AUTO
         9 003652   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 003653   200017 451500                    STP1    IOPT+10,,AUTO
         9 003654   000031 236000 10                 LDQ     25
         9 003655   200016 756100                    STQ     IOPT+9,,AUTO
         9 003656   000003 236000 10                 LDQ     3
         9 003657   200015 756100                    STQ     IOPT+8,,AUTO
         9 003660   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 003661   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003662   000000 701000 xent               TSX1    XUR$ERRMSG
         9 003663   000000 011000                    NOP     0

     1886    11978    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  11978  9 003664   000000 470400 xsym               LDP0    B$TCB$
         9 003665   000000 471500                    LDP1    0,,PR0
         9 003666   100102 236100                    LDQ     66,,PR1
         9 003667   001125 756000 1                  STQ     ERROR
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:252  

     1887    11979    2      CALL XUR$ERRMSG (ERROR, DCB#, DCBNUM(M$LO));

  11979  9 003670   000000 236007 xsym               LDQ     M$LO,DL
         9 003671   200014 756100                    STQ     IOPT+7,,AUTO
         9 003672   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 003673   200017 451500                    STP1    IOPT+10,,AUTO
         9 003674   000031 236000 10                 LDQ     25
         9 003675   200016 756100                    STQ     IOPT+9,,AUTO
         9 003676   000030 236000 10                 LDQ     24
         9 003677   200015 756100                    STQ     IOPT+8,,AUTO
         9 003700   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 003701   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003702   000000 701000 xent               TSX1    XUR$ERRMSG
         9 003703   000000 011000                    NOP     0

     1888    11980    2      ERROR.ERR# = 0;

  11980  9 003704   000001 236000 10                 LDQ     1
         9 003705   001125 356000 1                  ANSQ    ERROR

     1889    11981    2      CALL ORR$BRKRTN;

  11981  9 003706   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 003707   000000 701000 xent               TSX1    ORR$BRKRTN
         9 003710   000000 011000                    NOP     0

     1890    11982
     1891    11983    2   END SET_DEFAULTS;

  11983  9 003711   200004 221300                    LDX1  ! TEMP_UTS+1,,AUTO
         9 003712   000001 702211                    TSX2  ! 1,X1

     1892    11984        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:253  
     1893    11985         /*
     1894    11986                  S U B R O U T I N E   O P E N _ S P E C I F I C _ F I L E
     1895    11987                                                */
     1896    11988
     1897    11989    1   OPEN_SPECIFIC_FILE: PROC;

  11989  9 003713   200006 741300       OPEN_SPECIF* STX1  ! IOPT+1,,AUTO

     1898    11990    3      IF A_SPECIFIC_FILE THEN DO;

  11990  9 003714   000664 234000 1                  SZN     A_SPECIFIC_FILE
         9 003715   003770 605000 9                  TPL     s:12015

     1899    11991    3         FID_NAME = DCBADDR (DCBNUM (M$SI)) -> F$DCB.NAME#;

  11991  9 003716   000000 236007 xsym               LDQ     M$SI,DL
         9 003717   000005 470400 10                 LDP0    5
         9 003720   000000 471500                    LDP1    0,,PR0
         9 003721   100000 473506                    LDP3    0,QL,PR1
         9 003722   000000 100500                    MLR     fill='000'O
         9 003723   300010 000040                    ADSC9   8,,PR3                   cn=0,n=32
         9 003724   001400 000040 1                  ADSC9   FID_NAME                 cn=0,n=32

     1900    11992
     1901    11993    3         IF DCBADDR (DCBNUM (M$SI)) -> F$DCB.ACCT# ~= ' '

  11993  9 003725   000000 236007 xsym               LDQ     M$SI,DL
         9 003726   100000 473506                    LDP3    0,QL,PR1
         9 003727   300020 237100                    LDAQ    16,,PR3
         9 003730   000040 117000 10                 CMPAQ   32
         9 003731   003736 600000 9                  TZE     s:11996

     1902    11994    3         THEN SYS.ACCT# = DCBADDR (DCBNUM (M$SI)) -> F$DCB.ACCT#;

  11994  9 003732   000000 236007 xsym               LDQ     M$SI,DL
         9 003733   100000 473506                    LDP3    0,QL,PR1
         9 003734   300020 237100                    LDAQ    16,,PR3
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:254  
         9 003735   001410 757000 1                  STAQ    SYS

     1903    11995
     1904    11996    3         IF DCBADDR (DCBNUM (M$SI)) -> F$DCB.PASS# ~= ' '

  11996  9 003736   000000 236007 xsym               LDQ     M$SI,DL
         9 003737   100000 473506                    LDP3    0,QL,PR1
         9 003740   300022 237100                    LDAQ    18,,PR3
         9 003741   000040 117000 10                 CMPAQ   32
         9 003742   003752 600000 9                  TZE     s:11999

     1905    11997    3         THEN OPEN_HISTORYE.PASS_ = VECTOR (DCBADDR (DCBNUM (M$SI)) -> F$DCB.PASS#);

  11997  9 003743   000000 236007 xsym               LDQ     M$SI,DL
         9 003744   100000 473506                    LDP3    0,QL,PR1
         9 003745   000042 235000 10                 LDA     34
         9 003746   200014 453500                    STP3    IOPT+7,,AUTO
         9 003747   200014 236100                    LDQ     IOPT+7,,AUTO
         9 003750   000022 036003                    ADLQ    18,DU
         9 003751   001316 757000 1                  STAQ    OPEN_HISTORYE+8

     1906    11998
     1907    11999    3         IF DCBADDR (DCBNUM (M$SI)) -> F$DCB.PSN# ~= ' '

  11999  9 003752   000000 236007 xsym               LDQ     M$SI,DL
         9 003753   100000 473506                    LDP3    0,QL,PR1
         9 003754   040000 106500                    CMPC    fill='040'O
         9 003755   300024 000006                    ADSC9   20,,PR3                  cn=0,n=6
         9 003756   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 003757   003767 600000 9                  TZE     s:12006

     1908    12000    3         THEN OPEN_HISTORYE.SN_ = VECTOR (DCBADDR (DCBNUM (M$SI)) -> F$DCB.PSN#);

  12000  9 003760   000000 236007 xsym               LDQ     M$SI,DL
         9 003761   100000 473506                    LDP3    0,QL,PR1
         9 003762   000043 235000 10                 LDA     35
         9 003763   200014 453500                    STP3    IOPT+7,,AUTO
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:255  
         9 003764   200014 236100                    LDQ     IOPT+7,,AUTO
         9 003765   000024 036003                    ADLQ    20,DU
         9 003766   001310 757000 1                  STAQ    OPEN_HISTORYE+2

     1909    12001
     1910    12002                                                /* Turn specific file flag off so
     1911    12003                                                   OPEN_TO_RANGE won't loop when
     1912    12004                                                   it follows the backward chain.     */
     1913    12005
     1914    12006    3         A_SPECIFIC_FILE = %NO#;

  12006  9 003767   000664 450000 1                  STZ     A_SPECIFIC_FILE

     1915    12007    3      END;

     1916    12008
     1917    12009                                                /* If a specific file was entered
     1918    12010                                                     on the command line, check if
     1919    12011                                                     information pertaining to the
     1920    12012                                                     file was also entered on the
     1921    12013                                                     command line.                    */
     1922    12014
     1923    12015    3      IF FID_NAME.NAME# = ':OCHIST' THEN DO;

  12015  9 003770   040000 106400                    CMPC    fill='040'O
         9 003771   001400 200037 1                  ADSC9   FID_NAME                 cn=1,n=31
         9 003772   000011 000007 8                  ADSC9   MOP_8_DIGITS_3+8         cn=0,n=7
         9 003773   004062 601000 9                  TNZ     s:12054

     1924    12016    4         DO INHIBIT;

     1925    12017    4            CALL XUR$DISABLE;

  12017  9 003774   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         9 003775   000000 701200 xent               TSX1  ! XUR$DISABLE
         9 003776   000000 011200                    NOP   ! 0

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:256  
     1926    12018    4            OR_OK_TO_BREAK = %NO#;

  12018  9 003777   000000 450200 xsym               STZ   ! OR_OK_TO_BREAK

     1927    12019    4            CALL M$OPEN (CS_OPEN) ALTRET (CANT_OPEN_CS);

  12019  9 004000   002256 630600 1                  EPPR0 ! CS_OPEN
         9 004001   450000 713600                    CLIMB ! alt,open
         9 004002   410400 401760                    pmme    nvectors=18
         9 004003   004204 702200 9                  TSX2  ! CANT_OPEN_CS

     1928    12020    4            OR_MESSBUF.FCN = 9 /* Open :OCHIST shared */;

  12020  9 004004   000011 236207                    LDQ   ! 9,DL
         9 004005   000143 552204 1                  STBQ  ! OR_MESSBUF+1,'04'O

     1929    12021    4            OCHIST_FLAG = %YES#;

  12021  9 004006   400000 236203                    LDQ   ! -131072,DU
         9 004007   000000 756200 xsym               STQ   ! OCHIST_FLAG

     1930    12022    4            CALL M$WRITE (WRITE_CS) ALTRET (CANT_WRITE_CS);

  12022  9 004010   002370 630600 1                  EPPR0 ! WRITE_CS
         9 004011   440001 713600                    CLIMB ! alt,write
         9 004012   401400 401760                    pmme    nvectors=4
         9 004013   004255 702200 9                  TSX2  ! CANT_WRITE_CS

     1931    12023    4            CALL M$CLOSE (CS_CLOSE) ALTRET (CANT_CLOSE_CS);

  12023  9 004014   002426 630600 1                  EPPR0 ! CS_CLOSE
         9 004015   450001 713600                    CLIMB ! alt,close
         9 004016   406000 401760                    pmme    nvectors=13
         9 004017   004401 702200 9                  TSX2  ! CANT_CLOSE_CS

     1932    12024    4            OR_OK_TO_BREAK = %YES#;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:257  
  12024  9 004020   400000 236203                    LDQ   ! -131072,DU
         9 004021   000000 756200 xsym               STQ   ! OR_OK_TO_BREAK

     1933    12025    4            CALL XUR$ENABLE;

  12025  9 004022   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         9 004023   000000 701200 xent               TSX1  ! XUR$ENABLE
         9 004024   000000 011200                    NOP   ! 0

     1934    12026    4            IF OR_XCON_FLAG THEN CALL ORR$XCONRTN;

  12026  9 004025   000000 234200 xsym               SZN   ! OR_XCON_FLAG
         9 004026   004032 605200 9                  TPL   ! s:12027

  12026  9 004027   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         9 004030   000000 701200 xent               TSX1  ! ORR$XCONRTN
         9 004031   000000 011200                    NOP   ! 0

     1935    12027    4            IF OR_BRK_FLAG THEN CALL ORR$BRKRTN;

  12027  9 004032   000000 234200 xsym               SZN   ! OR_BRK_FLAG
         9 004033   004037 605200 9                  TPL   ! s:12034

  12027  9 004034   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         9 004035   000000 701200 xent               TSX1  ! ORR$BRKRTN
         9 004036   000000 011200                    NOP   ! 0

     1936    12028    4         END;

     1937    12029
     1938    12030                                                /* If the file to be opened is
     1939    12031                                                     :OCHIST, call keyin to open
     1940    12032                                                     the file SHARE=IN.               */
     1941    12033
     1942    12034    4         CALL M$OPEN (OPEN_HISTORYE) WHENALTRETURN DO;

  12034  9 004037   001306 630400 1                  EPPR0   OPEN_HISTORYE
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:258  
         9 004040   450000 713400                    CLIMB   alt,open
         9 004041   410400 401760                    pmme    nvectors=18
         9 004042   004044 702000 9                  TSX2    TRY2
         9 004043   004061 710000 9                  TRA     s:12047

     1943    12035    4   TRY2:
     1944    12036                                                /* In case event wasn't processed
     1945    12037                                                     by keyin yet.                    */
     1946    12038
     1947    12039    4            WAIT_TIMES# = WAIT_TIMES# + 1;

  12039  9 004044   000665 235000 1     TRY2         LDA     WAIT_TIMES#
         9 004045   000001 035007                    ADLA    1,DL
         9 004046   000665 755000 1                  STA     WAIT_TIMES#

     1948    12040    4            IF WAIT_TIMES# > 25 THEN GOTO CANT_OPEN_HIST;

  12040  9 004047   000032 115007                    CMPA    26,DL
         9 004050   004326 603000 9                  TRC     CANT_OPEN_HIST

     1949    12041    5            ELSE DO;

     1950    12042    5               CALL M$WAIT (WAIT_HIST);

  12042  9 004051   002464 630400 1                  EPPR0   WAIT_HIST
         9 004052   020006 713400                    CLIMB   8198
         9 004053   400400 401760                    pmme    nvectors=2

     1951    12043    5               CALL M$OPEN (OPEN_HISTORYE) ALTRET (TRY2);

  12043  9 004054   001306 630400 1                  EPPR0   OPEN_HISTORYE
         9 004055   450000 713400                    CLIMB   alt,open
         9 004056   410400 401760                    pmme    nvectors=18
         9 004057   004044 702000 9                  TSX2    TRY2

     1952    12044    5               WAIT_TIMES# = 0;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:259  
  12044  9 004060   000665 450000 1                  STZ     WAIT_TIMES#

     1953    12045    5            END;

     1954    12046    4         END;

     1955    12047    3      END;

  12047  9 004061   004202 710000 9                  TRA     s:12087

     1956    12048    3      ELSE DO;

     1957    12049
     1958    12050                                                /* If FID_NAME.NAME# ~= :OCHIST
     1959    12051                                                     then check to see if we
     1960    12052                                                     have a valid file name.          */
     1961    12053
     1962    12054    3         IF FID_NAME.L# = 0

  12054  9 004062   001400 236000 1                  LDQ     FID_NAME
         9 004063   777000 316003                    CANQ    -512,DU
         9 004064   004071 600000 9                  TZE     s:12063
         9 004065   001400 236000 1                  LDQ     FID_NAME
         9 004066   777000 376003                    ANQ     -512,DU
         9 004067   040000 116003                    CMPQ    16384,DU
         9 004070   004123 602000 9                  TNC     s:12071

     1963    12055    3           OR
     1964    12056    3           FID_NAME.L# > 31
     1965    12057    3         THEN
     1966    12058    4         DO;

     1967    12059        /*E* ERROR: ORR-E_BRKCHN#-7
     1968    12060             MESSAGE: Warning: Replay cannot accomodate the entire time range
     1969    12061                          because the history file chain has been broken.
     1970    12062                                 */
     1971    12063    4            DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:260  

  12063  9 004071   000000 470400 xsym               LDP0    B$TCB$
         9 004072   000000 471500                    LDP1    0,,PR0
         9 004073   100101 235100                    LDA     65,,PR1
         9 004074   000215 755000 1                  STA     DCB#

     1972    12064    4            MODULE_ERR.ERR# = 43 /* E_BRKCHN# */;

  12064  9 004075   001670 236000 1                  LDQ     MODULE_ERR
         9 004076   000001 376000 10                 ANQ     1
         9 004077   000530 276007                    ORQ     344,DL
         9 004100   001670 756000 1                  STQ     MODULE_ERR

     1973    12065    4            MODULE_ERR.SEV = 0;

  12065  9 004101   000002 236000 10                 LDQ     2
         9 004102   001670 356000 1                  ANSQ    MODULE_ERR

     1974    12066    4            CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

  12066  9 004103   000000 236007 xsym               LDQ     M$LO,DL
         9 004104   200014 756100                    STQ     IOPT+7,,AUTO
         9 004105   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 004106   200017 451500                    STP1    IOPT+10,,AUTO
         9 004107   000031 236000 10                 LDQ     25
         9 004110   200016 756100                    STQ     IOPT+9,,AUTO
         9 004111   000003 236000 10                 LDQ     3
         9 004112   200015 756100                    STQ     IOPT+8,,AUTO
         9 004113   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 004114   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004115   000000 701000 xent               TSX1    XUR$ERRMSG
         9 004116   000000 011000                    NOP     0

     1975    12067    4            NO_FILE = %YES#;

  12067  9 004117   400000 236003                    LDQ     -131072,DU
         9 004120   000752 756000 1                  STQ     NO_FILE
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:261  

     1976    12068    4            RETURN;

  12068  9 004121   200006 221300                    LDX1  ! IOPT+1,,AUTO
         9 004122   000001 702211                    TSX2  ! 1,X1

     1977    12069    4         END;
     1978    12070    3         ELSE
     1979    12071    3         CALL M$OPEN (OPEN_HISTORYE) WHENALTRETURN

  12071  9 004123   001306 630400 1                  EPPR0   OPEN_HISTORYE
         9 004124   450000 713400                    CLIMB   alt,open
         9 004125   410400 401760                    pmme    nvectors=18
         9 004126   004130 702000 9                  TSX2    s:12077
         9 004127   004202 710000 9                  TRA     s:12087

     1980    12072    4         DO;

     1981    12073        /*E* ERROR: ORR-E_NOPAST#-7
     1982    12074             MESSAGE: Warning: Replay cannot accomodate the entire time range
     1983    12075                          because some history file(s) cannot be opened
     1984    12076                                 */
     1985    12077    4            DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;

  12077  9 004130   000000 470400 xsym               LDP0    B$TCB$
         9 004131   000000 471500                    LDP1    0,,PR0
         9 004132   100101 235100                    LDA     65,,PR1
         9 004133   000215 755000 1                  STA     DCB#

     1986    12078    4            MODULE_ERR.ERR# = 39 /* E_NOPAST# */;

  12078  9 004134   001670 236000 1                  LDQ     MODULE_ERR
         9 004135   000001 376000 10                 ANQ     1
         9 004136   000470 276007                    ORQ     312,DL
         9 004137   001670 756000 1                  STQ     MODULE_ERR

     1987    12079    4            MODULE_ERR.SEV = 0;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:262  

  12079  9 004140   000002 236000 10                 LDQ     2
         9 004141   001670 356000 1                  ANSQ    MODULE_ERR

     1988    12080    4            CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

  12080  9 004142   000000 236007 xsym               LDQ     M$LO,DL
         9 004143   200014 756100                    STQ     IOPT+7,,AUTO
         9 004144   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 004145   200017 451500                    STP1    IOPT+10,,AUTO
         9 004146   000031 236000 10                 LDQ     25
         9 004147   200016 756100                    STQ     IOPT+9,,AUTO
         9 004150   000003 236000 10                 LDQ     3
         9 004151   200015 756100                    STQ     IOPT+8,,AUTO
         9 004152   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 004153   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004154   000000 701000 xent               TSX1    XUR$ERRMSG
         9 004155   000000 011000                    NOP     0

     1989    12081    4            ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  12081  9 004156   000000 470400 xsym               LDP0    B$TCB$
         9 004157   000000 471500                    LDP1    0,,PR0
         9 004160   100102 236100                    LDQ     66,,PR1
         9 004161   001125 756000 1                  STQ     ERROR

     1990    12082    4            CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

  12082  9 004162   000000 236007 xsym               LDQ     M$LO,DL
         9 004163   200014 756100                    STQ     IOPT+7,,AUTO
         9 004164   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 004165   200017 451500                    STP1    IOPT+10,,AUTO
         9 004166   000031 236000 10                 LDQ     25
         9 004167   200016 756100                    STQ     IOPT+9,,AUTO
         9 004170   000030 236000 10                 LDQ     24
         9 004171   200015 756100                    STQ     IOPT+8,,AUTO
         9 004172   200015 630500                    EPPR0   IOPT+8,,AUTO
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:263  
         9 004173   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004174   000000 701000 xent               TSX1    XUR$ERRMSG
         9 004175   000000 011000                    NOP     0

     1991    12083    4            NO_FILE = %YES#;

  12083  9 004176   400000 236003                    LDQ     -131072,DU
         9 004177   000752 756000 1                  STQ     NO_FILE

     1992    12084    4            RETURN;

  12084  9 004200   200006 221300                    LDX1  ! IOPT+1,,AUTO
         9 004201   000001 702211                    TSX2  ! 1,X1

     1993    12085    4         END;
     1994    12086    3      END;

     1995    12087    2      RETURN;

  12087  9 004202   200006 221300                    LDX1  ! IOPT+1,,AUTO
         9 004203   000001 702211                    TSX2  ! 1,X1

  12082  9 004204                       CANT_OPEN_CS null
     1996    12088
     1997    12089    2   CANT_OPEN_CS:;
     1998    12090        /*E* ERROR: ORR-E_OPENCS#-7
     1999    12091             MESSAGE: Altret taken when trying to open CSCG
     2000    12092                                 */
     2001    12093    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;

  12093  9 004204   000000 470400 xsym               LDP0    B$TCB$
         9 004205   000000 471500                    LDP1    0,,PR0
         9 004206   100101 235100                    LDA     65,,PR1
         9 004207   000215 755000 1                  STA     DCB#

     2002    12094    2      MODULE_ERR.ERR# = 17 /* E_OPENCS# */;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:264  
  12094  9 004210   001670 236000 1                  LDQ     MODULE_ERR
         9 004211   000001 376000 10                 ANQ     1
         9 004212   000210 276007                    ORQ     136,DL
         9 004213   001670 756000 1                  STQ     MODULE_ERR

     2003    12095    2      MODULE_ERR.SEV = 0;

  12095  9 004214   000002 236000 10                 LDQ     2
         9 004215   001670 356000 1                  ANSQ    MODULE_ERR

     2004    12096    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

  12096  9 004216   000000 236007 xsym               LDQ     M$LO,DL
         9 004217   200014 756100                    STQ     IOPT+7,,AUTO
         9 004220   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 004221   200017 451500                    STP1    IOPT+10,,AUTO
         9 004222   000031 236000 10                 LDQ     25
         9 004223   200016 756100                    STQ     IOPT+9,,AUTO
         9 004224   000003 236000 10                 LDQ     3
         9 004225   200015 756100                    STQ     IOPT+8,,AUTO
         9 004226   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 004227   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004230   000000 701000 xent               TSX1    XUR$ERRMSG
         9 004231   000000 011000                    NOP     0

     2005    12097    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  12097  9 004232   000000 470400 xsym               LDP0    B$TCB$
         9 004233   000000 471500                    LDP1    0,,PR0
         9 004234   100102 236100                    LDQ     66,,PR1
         9 004235   001125 756000 1                  STQ     ERROR

     2006    12098    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

  12098  9 004236   000000 236007 xsym               LDQ     M$LO,DL
         9 004237   200014 756100                    STQ     IOPT+7,,AUTO
         9 004240   200014 631500                    EPPR1   IOPT+7,,AUTO
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:265  
         9 004241   200017 451500                    STP1    IOPT+10,,AUTO
         9 004242   000031 236000 10                 LDQ     25
         9 004243   200016 756100                    STQ     IOPT+9,,AUTO
         9 004244   000030 236000 10                 LDQ     24
         9 004245   200015 756100                    STQ     IOPT+8,,AUTO
         9 004246   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 004247   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004250   000000 701000 xent               TSX1    XUR$ERRMSG
         9 004251   000000 011000                    NOP     0

     2007    12099    2      CALL ORR$XCONRTN;

  12099  9 004252   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 004253   000000 701000 xent               TSX1    ORR$XCONRTN
         9 004254   000000 011000                    NOP     0

  12097  9 004255                       CANT_WRITE_* null
     2008    12100
     2009    12101    2   CANT_WRITE_CS:;
     2010    12102        /*E* ERROR: ORR-E_WRTCS#-7
     2011    12103             MESSAGE: Altret occurred on write to CSCG
     2012    12104                                 */
     2013    12105    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;

  12105  9 004255   000000 470400 xsym               LDP0    B$TCB$
         9 004256   000000 471500                    LDP1    0,,PR0
         9 004257   100101 235100                    LDA     65,,PR1
         9 004260   000215 755000 1                  STA     DCB#

     2014    12106    2      MODULE_ERR.ERR# = 18 /* E_WRTCS# */;

  12106  9 004261   001670 236000 1                  LDQ     MODULE_ERR
         9 004262   000001 376000 10                 ANQ     1
         9 004263   000220 276007                    ORQ     144,DL
         9 004264   001670 756000 1                  STQ     MODULE_ERR

     2015    12107    2      MODULE_ERR.SEV = 0;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:266  

  12107  9 004265   000002 236000 10                 LDQ     2
         9 004266   001670 356000 1                  ANSQ    MODULE_ERR

     2016    12108    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

  12108  9 004267   000000 236007 xsym               LDQ     M$LO,DL
         9 004270   200014 756100                    STQ     IOPT+7,,AUTO
         9 004271   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 004272   200017 451500                    STP1    IOPT+10,,AUTO
         9 004273   000031 236000 10                 LDQ     25
         9 004274   200016 756100                    STQ     IOPT+9,,AUTO
         9 004275   000003 236000 10                 LDQ     3
         9 004276   200015 756100                    STQ     IOPT+8,,AUTO
         9 004277   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 004300   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004301   000000 701000 xent               TSX1    XUR$ERRMSG
         9 004302   000000 011000                    NOP     0

     2017    12109    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  12109  9 004303   000000 470400 xsym               LDP0    B$TCB$
         9 004304   000000 471500                    LDP1    0,,PR0
         9 004305   100102 236100                    LDQ     66,,PR1
         9 004306   001125 756000 1                  STQ     ERROR

     2018    12110    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

  12110  9 004307   000000 236007 xsym               LDQ     M$LO,DL
         9 004310   200014 756100                    STQ     IOPT+7,,AUTO
         9 004311   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 004312   200017 451500                    STP1    IOPT+10,,AUTO
         9 004313   000031 236000 10                 LDQ     25
         9 004314   200016 756100                    STQ     IOPT+9,,AUTO
         9 004315   000030 236000 10                 LDQ     24
         9 004316   200015 756100                    STQ     IOPT+8,,AUTO
         9 004317   200015 630500                    EPPR0   IOPT+8,,AUTO
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:267  
         9 004320   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004321   000000 701000 xent               TSX1    XUR$ERRMSG
         9 004322   000000 011000                    NOP     0

     2019    12111    2      CALL ORR$XCONRTN;

  12111  9 004323   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 004324   000000 701000 xent               TSX1    ORR$XCONRTN
         9 004325   000000 011000                    NOP     0

  12109  9 004326                       CANT_OPEN_H* null
     2020    12112
     2021    12113    2   CANT_OPEN_HIST:;
     2022    12114        /*E* ERROR: ORR-E_OPENHIST#-7
     2023    12115             MESSAGE: Error at attempt to open current :OCHIST file
     2024    12116                                 */
     2025    12117    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;

  12117  9 004326   000000 470400 xsym               LDP0    B$TCB$
         9 004327   000000 471500                    LDP1    0,,PR0
         9 004330   100101 235100                    LDA     65,,PR1
         9 004331   000215 755000 1                  STA     DCB#

     2026    12118    2      MODULE_ERR.ERR# = 2 /* E_OPENHIST# */;

  12118  9 004332   001670 236000 1                  LDQ     MODULE_ERR
         9 004333   000001 376000 10                 ANQ     1
         9 004334   000020 276007                    ORQ     16,DL
         9 004335   001670 756000 1                  STQ     MODULE_ERR

     2027    12119    2      MODULE_ERR.SEV = 0;

  12119  9 004336   000002 236000 10                 LDQ     2
         9 004337   001670 356000 1                  ANSQ    MODULE_ERR

     2028    12120    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:268  
  12120  9 004340   000000 236007 xsym               LDQ     M$LO,DL
         9 004341   200014 756100                    STQ     IOPT+7,,AUTO
         9 004342   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 004343   200017 451500                    STP1    IOPT+10,,AUTO
         9 004344   000031 236000 10                 LDQ     25
         9 004345   200016 756100                    STQ     IOPT+9,,AUTO
         9 004346   000003 236000 10                 LDQ     3
         9 004347   200015 756100                    STQ     IOPT+8,,AUTO
         9 004350   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 004351   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004352   000000 701000 xent               TSX1    XUR$ERRMSG
         9 004353   000000 011000                    NOP     0

     2029    12121    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  12121  9 004354   000000 470400 xsym               LDP0    B$TCB$
         9 004355   000000 471500                    LDP1    0,,PR0
         9 004356   100102 236100                    LDQ     66,,PR1
         9 004357   001125 756000 1                  STQ     ERROR

     2030    12122    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

  12122  9 004360   000000 236007 xsym               LDQ     M$LO,DL
         9 004361   200014 756100                    STQ     IOPT+7,,AUTO
         9 004362   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 004363   200017 451500                    STP1    IOPT+10,,AUTO
         9 004364   000031 236000 10                 LDQ     25
         9 004365   200016 756100                    STQ     IOPT+9,,AUTO
         9 004366   000030 236000 10                 LDQ     24
         9 004367   200015 756100                    STQ     IOPT+8,,AUTO
         9 004370   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 004371   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004372   000000 701000 xent               TSX1    XUR$ERRMSG
         9 004373   000000 011000                    NOP     0

     2031    12123    2      ERROR.ERR# = 0;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:269  
  12123  9 004374   000001 236000 10                 LDQ     1
         9 004375   001125 356000 1                  ANSQ    ERROR

     2032    12124    2      CALL ORR$BRKRTN;

  12124  9 004376   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 004377   000000 701000 xent               TSX1    ORR$BRKRTN
         9 004400   000000 011000                    NOP     0

  12123  9 004401                       CANT_CLOSE_* null
     2033    12125
     2034    12126    2   CANT_CLOSE_CS:;
     2035    12127        /*E* ERROR: ORR-E_CLOSECS#-7
     2036    12128             MESSAGE: Altret on attempt to close CSCG
     2037    12129                                 */
     2038    12130    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;

  12130  9 004401   000000 470400 xsym               LDP0    B$TCB$
         9 004402   000000 471500                    LDP1    0,,PR0
         9 004403   100101 235100                    LDA     65,,PR1
         9 004404   000215 755000 1                  STA     DCB#

     2039    12131    2      MODULE_ERR.ERR# = 32 /* E_CLOSECS# */;

  12131  9 004405   001670 236000 1                  LDQ     MODULE_ERR
         9 004406   000001 376000 10                 ANQ     1
         9 004407   000400 276007                    ORQ     256,DL
         9 004410   001670 756000 1                  STQ     MODULE_ERR

     2040    12132    2      MODULE_ERR.SEV = 0;

  12132  9 004411   000002 236000 10                 LDQ     2
         9 004412   001670 356000 1                  ANSQ    MODULE_ERR

     2041    12133    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

  12133  9 004413   000000 236007 xsym               LDQ     M$LO,DL
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:270  
         9 004414   200014 756100                    STQ     IOPT+7,,AUTO
         9 004415   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 004416   200017 451500                    STP1    IOPT+10,,AUTO
         9 004417   000031 236000 10                 LDQ     25
         9 004420   200016 756100                    STQ     IOPT+9,,AUTO
         9 004421   000003 236000 10                 LDQ     3
         9 004422   200015 756100                    STQ     IOPT+8,,AUTO
         9 004423   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 004424   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004425   000000 701000 xent               TSX1    XUR$ERRMSG
         9 004426   000000 011000                    NOP     0

     2042    12134    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  12134  9 004427   000000 470400 xsym               LDP0    B$TCB$
         9 004430   000000 471500                    LDP1    0,,PR0
         9 004431   100102 236100                    LDQ     66,,PR1
         9 004432   001125 756000 1                  STQ     ERROR

     2043    12135    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

  12135  9 004433   000000 236007 xsym               LDQ     M$LO,DL
         9 004434   200014 756100                    STQ     IOPT+7,,AUTO
         9 004435   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 004436   200017 451500                    STP1    IOPT+10,,AUTO
         9 004437   000031 236000 10                 LDQ     25
         9 004440   200016 756100                    STQ     IOPT+9,,AUTO
         9 004441   000030 236000 10                 LDQ     24
         9 004442   200015 756100                    STQ     IOPT+8,,AUTO
         9 004443   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 004444   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004445   000000 701000 xent               TSX1    XUR$ERRMSG
         9 004446   000000 011000                    NOP     0

     2044    12136    2      CALL ORR$XCONRTN;

  12136  9 004447   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:271  
         9 004450   000000 701000 xent               TSX1    ORR$XCONRTN
         9 004451   000000 011000                    NOP     0

     2045    12137
     2046    12138
     2047    12139    2   END OPEN_SPECIFIC_FILE;

  12139  9 004452   200006 221300                    LDX1  ! IOPT+1,,AUTO
         9 004453   000001 702211                    TSX2  ! 1,X1

     2048    12140        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:272  
     2049    12141         /*
     2050    12142                  S U B R O U T I N E   C L O S E _ S P E C I F I C _ F I L E
     2051    12143                                                */
     2052    12144
     2053    12145    1   CLOSE_SPECIFIC_FILE: PROC;

  12145  9 004454   200006 741300       CLOSE_SPECI* STX1  ! IOPT+1,,AUTO

     2054    12146    2      CALL M$CLOSE (CLOSE_HISTORYE) ALTRET (CANT_CLOSE_HISTORY);

  12146  9 004455   001412 630400 1                  EPPR0   CLOSE_HISTORYE
         9 004456   450001 713400                    CLIMB   alt,close
         9 004457   406000 401760                    pmme    nvectors=13
         9 004460   004653 702000 9                  TSX2    CANT_CLOSE_HISTORY

     2055    12147
     2056    12148                                                /* Close history file.                */
     2057    12149
     2058    12150    3      IF FID_NAME.NAME# = ':OCHIST' THEN DO;

  12150  9 004461   040000 106400                    CMPC    fill='040'O
         9 004462   001400 200037 1                  ADSC9   FID_NAME                 cn=1,n=31
         9 004463   000011 000007 8                  ADSC9   MOP_8_DIGITS_3+8         cn=0,n=7
         9 004464   004527 601000 9                  TNZ     s:12170

     2059    12151    4         DO INHIBIT;

     2060    12152    4            CALL XUR$DISABLE;

  12152  9 004465   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         9 004466   000000 701200 xent               TSX1  ! XUR$DISABLE
         9 004467   000000 011200                    NOP   ! 0

     2061    12153    4            OR_OK_TO_BREAK = %NO#;

  12153  9 004470   000000 450200 xsym               STZ   ! OR_OK_TO_BREAK

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:273  
     2062    12154    4            CALL M$OPEN (CS_OPEN) ALTRET (CANT_OPEN_CS);

  12154  9 004471   002256 630600 1                  EPPR0 ! CS_OPEN
         9 004472   450000 713600                    CLIMB ! alt,open
         9 004473   410400 401760                    pmme    nvectors=18
         9 004474   004531 702200 9                  TSX2  ! CANT_OPEN_CS

     2063    12155    4            OR_MESSBUF.FCN = 10 /* Open :OCHIST exclusive */;

  12155  9 004475   000012 236207                    LDQ   ! 10,DL
         9 004476   000143 552204 1                  STBQ  ! OR_MESSBUF+1,'04'O

     2064    12156    4            CALL M$WRITE (WRITE_CS) ALTRET (CANT_WRITE_CS);

  12156  9 004477   002370 630600 1                  EPPR0 ! WRITE_CS
         9 004500   440001 713600                    CLIMB ! alt,write
         9 004501   401400 401760                    pmme    nvectors=4
         9 004502   004602 702200 9                  TSX2  ! CANT_WRITE_CS

     2065    12157    4            OCHIST_FLAG = %NO#;

  12157  9 004503   000000 450200 xsym               STZ   ! OCHIST_FLAG

     2066    12158    4            CALL M$CLOSE (CS_CLOSE) ALTRET (CANT_CLOSE_CS);

  12158  9 004504   002426 630600 1                  EPPR0 ! CS_CLOSE
         9 004505   450001 713600                    CLIMB ! alt,close
         9 004506   406000 401760                    pmme    nvectors=13
         9 004507   004724 702200 9                  TSX2  ! CANT_CLOSE_CS

     2067    12159    4            OR_OK_TO_BREAK = %YES#;

  12159  9 004510   400000 236203                    LDQ   ! -131072,DU
         9 004511   000000 756200 xsym               STQ   ! OR_OK_TO_BREAK

     2068    12160    4            CALL XUR$ENABLE;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:274  
  12160  9 004512   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         9 004513   000000 701200 xent               TSX1  ! XUR$ENABLE
         9 004514   000000 011200                    NOP   ! 0

     2069    12161    4            IF OR_XCON_FLAG THEN CALL ORR$BRKRTN;

  12161  9 004515   000000 234200 xsym               SZN   ! OR_XCON_FLAG
         9 004516   004522 605200 9                  TPL   ! s:12162

  12161  9 004517   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         9 004520   000000 701200 xent               TSX1  ! ORR$BRKRTN
         9 004521   000000 011200                    NOP   ! 0

     2070    12162    4            IF OR_BRK_FLAG THEN CALL ORR$XCONRTN;

  12162  9 004522   000000 234200 xsym               SZN   ! OR_BRK_FLAG
         9 004523   004527 605200 9                  TPL   ! s:12170

  12162  9 004524   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         9 004525   000000 701200 xent               TSX1  ! ORR$XCONRTN
         9 004526   000000 011200                    NOP   ! 0

     2071    12163    4         END;

     2072    12164    3      END;

     2073    12165
     2074    12166                                                /* If file was :OCHIST, then
     2075    12167                                                     call keyin to re-open
     2076    12168                                                     the file SHARE=NONE.             */
     2077    12169
     2078    12170    2      RETURN;

  12170  9 004527   200006 221300                    LDX1  ! IOPT+1,,AUTO
         9 004530   000001 702211                    TSX2  ! 1,X1

  12158  9 004531                       CANT_OPEN_CS null
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:275  
     2079    12171
     2080    12172
     2081    12173    2   CANT_OPEN_CS:;
     2082    12174    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;

  12174  9 004531   000000 470400 xsym               LDP0    B$TCB$
         9 004532   000000 471500                    LDP1    0,,PR0
         9 004533   100101 235100                    LDA     65,,PR1
         9 004534   000215 755000 1                  STA     DCB#

     2083    12175    2      MODULE_ERR.ERR# = 17 /* E_OPENCS# */;

  12175  9 004535   001670 236000 1                  LDQ     MODULE_ERR
         9 004536   000001 376000 10                 ANQ     1
         9 004537   000210 276007                    ORQ     136,DL
         9 004540   001670 756000 1                  STQ     MODULE_ERR

     2084    12176    2      MODULE_ERR.SEV = 0;

  12176  9 004541   000002 236000 10                 LDQ     2
         9 004542   001670 356000 1                  ANSQ    MODULE_ERR

     2085    12177    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

  12177  9 004543   000000 236007 xsym               LDQ     M$LO,DL
         9 004544   200014 756100                    STQ     IOPT+7,,AUTO
         9 004545   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 004546   200017 451500                    STP1    IOPT+10,,AUTO
         9 004547   000031 236000 10                 LDQ     25
         9 004550   200016 756100                    STQ     IOPT+9,,AUTO
         9 004551   000003 236000 10                 LDQ     3
         9 004552   200015 756100                    STQ     IOPT+8,,AUTO
         9 004553   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 004554   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004555   000000 701000 xent               TSX1    XUR$ERRMSG
         9 004556   000000 011000                    NOP     0

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:276  
     2086    12178    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  12178  9 004557   000000 470400 xsym               LDP0    B$TCB$
         9 004560   000000 471500                    LDP1    0,,PR0
         9 004561   100102 236100                    LDQ     66,,PR1
         9 004562   001125 756000 1                  STQ     ERROR

     2087    12179    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

  12179  9 004563   000000 236007 xsym               LDQ     M$LO,DL
         9 004564   200014 756100                    STQ     IOPT+7,,AUTO
         9 004565   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 004566   200017 451500                    STP1    IOPT+10,,AUTO
         9 004567   000031 236000 10                 LDQ     25
         9 004570   200016 756100                    STQ     IOPT+9,,AUTO
         9 004571   000030 236000 10                 LDQ     24
         9 004572   200015 756100                    STQ     IOPT+8,,AUTO
         9 004573   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 004574   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004575   000000 701000 xent               TSX1    XUR$ERRMSG
         9 004576   000000 011000                    NOP     0

     2088    12180    2      CALL ORR$XCONRTN;

  12180  9 004577   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 004600   000000 701000 xent               TSX1    ORR$XCONRTN
         9 004601   000000 011000                    NOP     0

  12178  9 004602                       CANT_WRITE_* null
     2089    12181
     2090    12182    2   CANT_WRITE_CS:;
     2091    12183    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;

  12183  9 004602   000000 470400 xsym               LDP0    B$TCB$
         9 004603   000000 471500                    LDP1    0,,PR0
         9 004604   100101 235100                    LDA     65,,PR1
         9 004605   000215 755000 1                  STA     DCB#
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:277  

     2092    12184    2      MODULE_ERR.ERR# = 18 /* E_WRTCS# */;

  12184  9 004606   001670 236000 1                  LDQ     MODULE_ERR
         9 004607   000001 376000 10                 ANQ     1
         9 004610   000220 276007                    ORQ     144,DL
         9 004611   001670 756000 1                  STQ     MODULE_ERR

     2093    12185    2      MODULE_ERR.SEV = 0;

  12185  9 004612   000002 236000 10                 LDQ     2
         9 004613   001670 356000 1                  ANSQ    MODULE_ERR

     2094    12186    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

  12186  9 004614   000000 236007 xsym               LDQ     M$LO,DL
         9 004615   200014 756100                    STQ     IOPT+7,,AUTO
         9 004616   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 004617   200017 451500                    STP1    IOPT+10,,AUTO
         9 004620   000031 236000 10                 LDQ     25
         9 004621   200016 756100                    STQ     IOPT+9,,AUTO
         9 004622   000003 236000 10                 LDQ     3
         9 004623   200015 756100                    STQ     IOPT+8,,AUTO
         9 004624   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 004625   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004626   000000 701000 xent               TSX1    XUR$ERRMSG
         9 004627   000000 011000                    NOP     0

     2095    12187    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  12187  9 004630   000000 470400 xsym               LDP0    B$TCB$
         9 004631   000000 471500                    LDP1    0,,PR0
         9 004632   100102 236100                    LDQ     66,,PR1
         9 004633   001125 756000 1                  STQ     ERROR

     2096    12188    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:278  
  12188  9 004634   000000 236007 xsym               LDQ     M$LO,DL
         9 004635   200014 756100                    STQ     IOPT+7,,AUTO
         9 004636   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 004637   200017 451500                    STP1    IOPT+10,,AUTO
         9 004640   000031 236000 10                 LDQ     25
         9 004641   200016 756100                    STQ     IOPT+9,,AUTO
         9 004642   000030 236000 10                 LDQ     24
         9 004643   200015 756100                    STQ     IOPT+8,,AUTO
         9 004644   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 004645   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004646   000000 701000 xent               TSX1    XUR$ERRMSG
         9 004647   000000 011000                    NOP     0

     2097    12189    2      CALL ORR$XCONRTN;

  12189  9 004650   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 004651   000000 701000 xent               TSX1    ORR$XCONRTN
         9 004652   000000 011000                    NOP     0

  12187  9 004653                       CANT_CLOSE_* null
     2098    12190
     2099    12191    2   CANT_CLOSE_HISTORY:;
     2100    12192        /*E* ERROR: ORR-E_CLOSEHIST#-7
     2101    12193             MESSAGE: Altret on attempt to close history file
     2102    12194                                 */
     2103    12195    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;

  12195  9 004653   000000 470400 xsym               LDP0    B$TCB$
         9 004654   000000 471500                    LDP1    0,,PR0
         9 004655   100101 235100                    LDA     65,,PR1
         9 004656   000215 755000 1                  STA     DCB#

     2104    12196    2      MODULE_ERR.ERR# = 29 /* E_CLOSEHIST# */;

  12196  9 004657   001670 236000 1                  LDQ     MODULE_ERR
         9 004660   000001 376000 10                 ANQ     1
         9 004661   000350 276007                    ORQ     232,DL
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:279  
         9 004662   001670 756000 1                  STQ     MODULE_ERR

     2105    12197    2      MODULE_ERR.SEV = 0;

  12197  9 004663   000002 236000 10                 LDQ     2
         9 004664   001670 356000 1                  ANSQ    MODULE_ERR

     2106    12198    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

  12198  9 004665   000000 236007 xsym               LDQ     M$LO,DL
         9 004666   200014 756100                    STQ     IOPT+7,,AUTO
         9 004667   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 004670   200017 451500                    STP1    IOPT+10,,AUTO
         9 004671   000031 236000 10                 LDQ     25
         9 004672   200016 756100                    STQ     IOPT+9,,AUTO
         9 004673   000003 236000 10                 LDQ     3
         9 004674   200015 756100                    STQ     IOPT+8,,AUTO
         9 004675   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 004676   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004677   000000 701000 xent               TSX1    XUR$ERRMSG
         9 004700   000000 011000                    NOP     0

     2107    12199    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  12199  9 004701   000000 470400 xsym               LDP0    B$TCB$
         9 004702   000000 471500                    LDP1    0,,PR0
         9 004703   100102 236100                    LDQ     66,,PR1
         9 004704   001125 756000 1                  STQ     ERROR

     2108    12200    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

  12200  9 004705   000000 236007 xsym               LDQ     M$LO,DL
         9 004706   200014 756100                    STQ     IOPT+7,,AUTO
         9 004707   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 004710   200017 451500                    STP1    IOPT+10,,AUTO
         9 004711   000031 236000 10                 LDQ     25
         9 004712   200016 756100                    STQ     IOPT+9,,AUTO
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:280  
         9 004713   000030 236000 10                 LDQ     24
         9 004714   200015 756100                    STQ     IOPT+8,,AUTO
         9 004715   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 004716   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004717   000000 701000 xent               TSX1    XUR$ERRMSG
         9 004720   000000 011000                    NOP     0

     2109    12201    2      CALL ORR$XCONRTN;

  12201  9 004721   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 004722   000000 701000 xent               TSX1    ORR$XCONRTN
         9 004723   000000 011000                    NOP     0

  12199  9 004724                       CANT_CLOSE_* null
     2110    12202
     2111    12203    2   CANT_CLOSE_CS:;
     2112    12204    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;

  12204  9 004724   000000 470400 xsym               LDP0    B$TCB$
         9 004725   000000 471500                    LDP1    0,,PR0
         9 004726   100101 235100                    LDA     65,,PR1
         9 004727   000215 755000 1                  STA     DCB#

     2113    12205    2      MODULE_ERR.ERR# = 32 /* E_CLOSECS# */;

  12205  9 004730   001670 236000 1                  LDQ     MODULE_ERR
         9 004731   000001 376000 10                 ANQ     1
         9 004732   000400 276007                    ORQ     256,DL
         9 004733   001670 756000 1                  STQ     MODULE_ERR

     2114    12206    2      MODULE_ERR.SEV = 0;

  12206  9 004734   000002 236000 10                 LDQ     2
         9 004735   001670 356000 1                  ANSQ    MODULE_ERR

     2115    12207    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:281  
  12207  9 004736   000000 236007 xsym               LDQ     M$LO,DL
         9 004737   200014 756100                    STQ     IOPT+7,,AUTO
         9 004740   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 004741   200017 451500                    STP1    IOPT+10,,AUTO
         9 004742   000031 236000 10                 LDQ     25
         9 004743   200016 756100                    STQ     IOPT+9,,AUTO
         9 004744   000003 236000 10                 LDQ     3
         9 004745   200015 756100                    STQ     IOPT+8,,AUTO
         9 004746   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 004747   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004750   000000 701000 xent               TSX1    XUR$ERRMSG
         9 004751   000000 011000                    NOP     0

     2116    12208    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  12208  9 004752   000000 470400 xsym               LDP0    B$TCB$
         9 004753   000000 471500                    LDP1    0,,PR0
         9 004754   100102 236100                    LDQ     66,,PR1
         9 004755   001125 756000 1                  STQ     ERROR

     2117    12209    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

  12209  9 004756   000000 236007 xsym               LDQ     M$LO,DL
         9 004757   200014 756100                    STQ     IOPT+7,,AUTO
         9 004760   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 004761   200017 451500                    STP1    IOPT+10,,AUTO
         9 004762   000031 236000 10                 LDQ     25
         9 004763   200016 756100                    STQ     IOPT+9,,AUTO
         9 004764   000030 236000 10                 LDQ     24
         9 004765   200015 756100                    STQ     IOPT+8,,AUTO
         9 004766   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 004767   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004770   000000 701000 xent               TSX1    XUR$ERRMSG
         9 004771   000000 011000                    NOP     0

     2118    12210    2      CALL ORR$XCONRTN;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:282  
  12210  9 004772   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 004773   000000 701000 xent               TSX1    ORR$XCONRTN
         9 004774   000000 011000                    NOP     0

     2119    12211
     2120    12212
     2121    12213    2   END CLOSE_SPECIFIC_FILE;

  12213  9 004775   200006 221300                    LDX1  ! IOPT+1,,AUTO
         9 004776   000001 702211                    TSX2  ! 1,X1

     2122    12214        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:283  
     2123    12215         /*
     2124    12216                  S U B R O U T I N E   S E L E C T I O N _ R E T R I E V E R
     2125    12217                                                */
     2126    12218
     2127    12219    1   SELECTION_RETRIEVER: PROC;

  12219  9 004777   200004 741300       SELECTION_R* STX1  ! TEMP_UTS+1,,AUTO

     2128    12220
     2129    12221    2   DCL IOPT UBIN;
     2130    12222
     2131    12223    3      DO IOPT = 0 TO OUT$ -> OUT$BLK.NSUBLKS-1;

  12223  9 005000   200005 450100                    STZ     IOPT,,AUTO
         9 005001   005225 710000 9                  TRA     s:12276+3

     2132    12224
     2133    12225    3         SR_PTR$ = OUT$ -> OUT$BLK.SUBLK$(IOPT);

  12225  9 005002   000165 470400 1                  LDP0    OUT$
         9 005003   200005 720100                    LXL0    IOPT,,AUTO
         9 005004   000003 236110                    LDQ     3,X0,PR0
         9 005005   000173 756000 1                  STQ     SR_PTR$

     2134    12226    3         TPTR$ = SR_PTR$ -> OUT$BLK.SUBLK$(0);

  12226  9 005006   000173 471400 1                  LDP1    SR_PTR$
         9 005007   100003 236100                    LDQ     3,,PR1
         9 005010   000172 756000 1                  STQ     TPTR$

     2135    12227    4         DO CASE (SR_PTR$ -> OUT$BLK.CODE);

  12227  9 005011   100000 721100                    LXL1    0,,PR1
         9 005012   000015 101003                    CMPX1   13,DU
         9 005013   005015 602011 9                  TNC     s:12227+4,X1
         9 005014   005222 710000 9                  TRA     s:12276
         9 005015   005222 710000 9                  TRA     s:12276
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:284  
         9 005016   005222 710000 9                  TRA     s:12276
         9 005017   005032 710000 9                  TRA     s:12229
         9 005020   005042 710000 9                  TRA     s:12232
         9 005021   005222 710000 9                  TRA     s:12276
         9 005022   005222 710000 9                  TRA     s:12276
         9 005023   005061 710000 9                  TRA     s:12236
         9 005024   005222 710000 9                  TRA     s:12276
         9 005025   005222 710000 9                  TRA     s:12276
         9 005026   005222 710000 9                  TRA     s:12276
         9 005027   005222 710000 9                  TRA     s:12276
         9 005030   005071 710000 9                  TRA     s:12239
         9 005031   005175 710000 9                  TRA     s:12268

     2136    12228    4         CASE (%CMD_WSN#);

     2137    12229    4            WSTATION = SR_PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;

  12229  9 005032   100003 473500                    LDP3    3,,PR1
         9 005033   300004 236100                    LDQ     4,,PR3
         9 005034   000033 772000                    QRL     27
         9 005035   000000 622006                    EAX2    0,QL
         9 005036   040000 100540                    MLR     fill='040'O
         9 005037   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         9 005040   000274 000010 1                  ADSC9   WSTATION                 cn=0,n=8
         9 005041   005222 710000 9                  TRA     s:12276

     2138    12230
     2139    12231    4         CASE (%CMD_CONSOLE#);

     2140    12232    4            CONSOLE = SR_PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;

  12232  9 005042   100003 473500                    LDP3    3,,PR1
         9 005043   300004 236100                    LDQ     4,,PR3
         9 005044   000033 772000                    QRL     27
         9 005045   000000 622006                    EAX2    0,QL
         9 005046   040000 100540                    MLR     fill='040'O
         9 005047   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:285  
         9 005050   000270 000004 1                  ADSC9   CONSOLE                  cn=0,n=4

     2141    12233    4            LOCATION = SR_PTR$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT;

  12233  9 005051   100004 474500                    LDP4    4,,PR1
         9 005052   400004 236100                    LDQ     4,,PR4
         9 005053   000033 772000                    QRL     27
         9 005054   000000 623006                    EAX3    0,QL
         9 005055   040000 100540                    MLR     fill='040'O
         9 005056   400004 200013                    ADSC9   4,,PR4                   cn=1,n=*X3
         9 005057   000271 000010 1                  ADSC9   LOCATION                 cn=0,n=8
         9 005060   005222 710000 9                  TRA     s:12276

     2142    12234
     2143    12235    4         CASE (%CMD_LOGON#);

     2144    12236    4            LOGON = SR_PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;

  12236  9 005061   100003 473500                    LDP3    3,,PR1
         9 005062   300004 236100                    LDQ     4,,PR3
         9 005063   000033 772000                    QRL     27
         9 005064   000000 622006                    EAX2    0,QL
         9 005065   040000 100540                    MLR     fill='040'O
         9 005066   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         9 005067   000276 000010 1                  ADSC9   LOGON                    cn=0,n=8
         9 005070   005222 710000 9                  TRA     s:12276

     2145    12237
     2146    12238    4         CASE (%CMD_TYPE#);

     2147    12239    4            TYPE = ' ';

  12239  9 005071   000035 235000 xsym               LDA     B_VECTNIL+29
         9 005072   000035 236000 xsym               LDQ     B_VECTNIL+29
         9 005073   000700 757000 1                  STAQ    TYPE

     2148    12240    4            IP_LOC_TYPE = '?';
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:286  

  12240  9 005074   000016 235000 10                 LDA     14
         9 005075   000035 236000 xsym               LDQ     B_VECTNIL+29
         9 005076   000702 757000 1                  STAQ    IP_LOC_TYPE

     2149    12241    5            DO CASE (TPTR$ -> OUT$BLK.CODE);

  12241  9 005077   000172 473400 1                  LDP3    TPTR$
         9 005100   300000 236100                    LDQ     0,,PR3
         9 005101   777777 376007                    ANQ     -1,DL
         9 005102   000011 136007                    SBLQ    9,DL
         9 005103   000017 116007                    CMPQ    15,DL
         9 005104   005106 602006 9                  TNC     s:12241+7,QL
         9 005105   005222 710000 9                  TRA     s:12276
         9 005106   005125 710000 9                  TRA     s:12243
         9 005107   005130 710000 9                  TRA     s:12246
         9 005110   005144 710000 9                  TRA     s:12251
         9 005111   005160 710000 9                  TRA     s:12256
         9 005112   005163 710000 9                  TRA     s:12259
         9 005113   005174 710000 9                  TRA     s:12265
         9 005114   005174 710000 9                  TRA     s:12265
         9 005115   005174 710000 9                  TRA     s:12265
         9 005116   005174 710000 9                  TRA     s:12265
         9 005117   005174 710000 9                  TRA     s:12265
         9 005120   005174 710000 9                  TRA     s:12265
         9 005121   005174 710000 9                  TRA     s:12265
         9 005122   005174 710000 9                  TRA     s:12265
         9 005123   005174 710000 9                  TRA     s:12265
         9 005124   005172 710000 9                  TRA     s:12263

     2150    12242    5            CASE (%CMD_SYST#);

     2151    12243    5               IP_ATTR_TYPE = '200000'O /* M_SYS  */;

  12243  9 005125   200000 222003                    LDX2    65536,DU
         9 005126   000704 742000 1                  STX2    IP_ATTR_TYPE
         9 005127   005222 710000 9                  TRA     s:12276
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:287  

     2152    12244
     2153    12245    5            CASE (%CMD_DEVC#);

     2154    12246    5               IP_ATTR_TYPE = '100000'O /* M_DEVC  */;

  12246  9 005130   100000 222003                    LDX2    32768,DU
         9 005131   000704 742000 1                  STX2    IP_ATTR_TYPE

     2155    12247    5               IF TPTR$ -> OUT$BLK.NSUBLKS > 0

  12247  9 005132   300001 223100                    LDX3    1,,PR3
         9 005133   005222 600000 9                  TZE     s:12276

     2156    12248    5               THEN IP_LOC_TYPE = TPTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;

  12248  9 005134   300003 474500                    LDP4    3,,PR3
         9 005135   400004 236100                    LDQ     4,,PR4
         9 005136   000033 772000                    QRL     27
         9 005137   000000 624006                    EAX4    0,QL
         9 005140   040000 100540                    MLR     fill='040'O
         9 005141   400004 200014                    ADSC9   4,,PR4                   cn=1,n=*X4
         9 005142   000702 000010 1                  ADSC9   IP_LOC_TYPE              cn=0,n=8
         9 005143   005222 710000 9                  TRA     s:12276

     2157    12249
     2158    12250    5            CASE (%CMD_ADMIN#);

     2159    12251    5               IP_ATTR_TYPE = '040000'O /* M_ADMIN */;

  12251  9 005144   040000 222003                    LDX2    16384,DU
         9 005145   000704 742000 1                  STX2    IP_ATTR_TYPE

     2160    12252    5               IF TPTR$ -> OUT$BLK.NSUBLKS > 0

  12252  9 005146   300001 223100                    LDX3    1,,PR3
         9 005147   005222 600000 9                  TZE     s:12276
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:288  

     2161    12253    5               THEN IP_LOC_TYPE = TPTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;

  12253  9 005150   300003 474500                    LDP4    3,,PR3
         9 005151   400004 236100                    LDQ     4,,PR4
         9 005152   000033 772000                    QRL     27
         9 005153   000000 624006                    EAX4    0,QL
         9 005154   040000 100540                    MLR     fill='040'O
         9 005155   400004 200014                    ADSC9   4,,PR4                   cn=1,n=*X4
         9 005156   000702 000010 1                  ADSC9   IP_LOC_TYPE              cn=0,n=8
         9 005157   005222 710000 9                  TRA     s:12276

     2162    12254
     2163    12255    5            CASE (%CMD_COMM#);

     2164    12256    5               IP_ATTR_TYPE = '004000'O /* M_COMM */;

  12256  9 005160   004000 222003                    LDX2    2048,DU
         9 005161   000704 742000 1                  STX2    IP_ATTR_TYPE
         9 005162   005222 710000 9                  TRA     s:12276

     2165    12257
     2166    12258    5            CASE (%CMD_TYPEQ#);

     2167    12259    5               TYPE = '?';

  12259  9 005163   000016 235000 10                 LDA     14
         9 005164   000035 236000 xsym               LDQ     B_VECTNIL+29
         9 005165   000700 757000 1                  STAQ    TYPE

     2168    12260    5               IP_LOC_TYPE = '?';

  12260  9 005166   000016 235000 10                 LDA     14
         9 005167   000035 236000 xsym               LDQ     B_VECTNIL+29
         9 005170   000702 757000 1                  STAQ    IP_LOC_TYPE
         9 005171   005222 710000 9                  TRA     s:12276

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:289  
     2169    12261
     2170    12262    5            CASE (%CMD_TP#);

     2171    12263    5               IP_ATTR_TYPE = '001000'O /* M_TP */;

  12263  9 005172   001000 222003                    LDX2    512,DU
         9 005173   000704 742000 1                  STX2    IP_ATTR_TYPE

     2172    12264
     2173    12265    5            END;

  12265  9 005174   005222 710000 9                  TRA     s:12276

     2174    12266
     2175    12267    4         CASE (%CMD_PATTERN#);

     2176    12268    4            WILDCARDING = %YES#;

  12268  9 005175   400000 236003                    LDQ     -131072,DU
         9 005176   000746 756000 1                  STQ     WILDCARDING

     2177    12269    4            XUW_WILDCARD.PATTERN_.PATTERN$ = ADDR (MSG);

  12269  9 005177   000044 236000 10                 LDQ     36
         9 005200   000151 756000 1                  STQ     XUW_WILDCARD+1

     2178    12270    4            XUW_WILDCARD.INPUT_.INPUT$ = ADDR (OUT_BUFFER);

  12270  9 005201   000045 236000 10                 LDQ     37
         9 005202   000153 756000 1                  STQ     XUW_WILDCARD+3

     2179    12271    4            MSG = SR_PTR$ -> OUT$BLK.SUBLK$ (0) -> OUT$SYM.TEXT;

  12271  9 005203   100003 473500                    LDP3    3,,PR1
         9 005204   300004 236100                    LDQ     4,,PR3
         9 005205   000033 772000                    QRL     27
         9 005206   000000 621006                    EAX1    0,QL
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:290  
         9 005207   040000 100540                    MLR     fill='040'O
         9 005210   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         9 005211   000427 000400 1                  ADSC9   MSG                      cn=0,n=256

     2180    12272    4            XUW_WILDCARD.PATTERN_.BOUND = SR_PTR$ -> OUT$BLK.SUBLK$ (0)

  12272  9 005212   100003 473500                    LDP3    3,,PR1
         9 005213   300004 236100                    LDQ     4,,PR3
         9 005214   000033 772000                    QRL     27
         9 005215   000001 136007                    SBLQ    1,DL
         9 005216   000020 736000                    QLS     16
         9 005217   000150 676000 1                  ERQ     XUW_WILDCARD
         9 005220   000034 376000 xsym               ANQ     B_VECTNIL+28
         9 005221   000150 656000 1                  ERSQ    XUW_WILDCARD

     2181    12273    4              -> OUT$SYM.COUNT - 1;
     2182    12274
     2183    12275    4         END;

     2184    12276    3      END;

  12276  9 005222   200005 235100                    LDA     IOPT,,AUTO
         9 005223   000001 035007                    ADLA    1,DL
         9 005224   200005 755100                    STA     IOPT,,AUTO
         9 005225   000165 470400 1                  LDP0    OUT$
         9 005226   000001 236100                    LDQ     1,,PR0
         9 005227   000022 772000                    QRL     18
         9 005230   200005 116100                    CMPQ    IOPT,,AUTO
         9 005231   005233 600000 9                  TZE     s:12277
         9 005232   005002 603000 9                  TRC     s:12225

     2185    12277    2   END SELECTION_RETRIEVER;

  12277  9 005233   200004 221300                    LDX1  ! TEMP_UTS+1,,AUTO
         9 005234   000001 702211                    TSX2  ! 1,X1

     2186    12278        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:291  
     2187    12279         /*
     2188    12280                  S U B R O U T I N E   D O _ R E S E T
     2189    12281                                                */
     2190    12282
     2191    12283    1   DO_RESET: PROC;

  12283  9 005235   200004 741300       DO_RESET     STX1  ! TEMP_UTS+1,,AUTO

     2192    12284
     2193    12285    2      TPTR$ = OUT$ -> OUT$BLK.SUBLK$(0);

  12285  9 005236   000165 470400 1                  LDP0    OUT$
         9 005237   000003 236100                    LDQ     3,,PR0
         9 005240   000172 756000 1                  STQ     TPTR$

     2194    12286    2      SUBS1 = OUT$ -> OUT$BLK.NSUBLKS;

  12286  9 005241   000001 236100                    LDQ     1,,PR0
         9 005242   000022 772000                    QRL     18
         9 005243   000221 756000 1                  STQ     SUBS1

     2195    12287
     2196    12288    3      IF SUBS1 ~= 0 THEN DO;

  12288  9 005244   005336 600000 9                  TZE     s:12327

     2197    12289    4         DO CASE (TPTR$ -> OUT$BLK.CODE);

  12289  9 005245   000172 471400 1                  LDP1    TPTR$
         9 005246   100000 236100                    LDQ     0,,PR1
         9 005247   777777 376007                    ANQ     -1,DL
         9 005250   000020 136007                    SBLQ    16,DL
         9 005251   000013 116007                    CMPQ    11,DL
         9 005252   005254 602006 9                  TNC     s:12289+7,QL
         9 005253   005374 710000 9                  TRA     s:12342
         9 005254   005330 710000 9                  TRA     s:12321
         9 005255   005335 710000 9                  TRA     s:12324
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:292  
         9 005256   005267 710000 9                  TRA     s:12292
         9 005257   005274 710000 9                  TRA     s:12298
         9 005260   005307 710000 9                  TRA     s:12305
         9 005261   005303 710000 9                  TRA     s:12302
         9 005262   005313 710000 9                  TRA     s:12308
         9 005263   005335 710000 9                  TRA     s:12324
         9 005264   005322 710000 9                  TRA     s:12312
         9 005265   005324 710000 9                  TRA     s:12315
         9 005266   005326 710000 9                  TRA     s:12318

     2198    12290
     2199    12291    4         CASE (%CMD_RSPAN#);

     2200    12292    4            OPERATOR_ENTERED_TIME1 = %NO#;

  12292  9 005267   000651 450000 1                  STZ     OPERATOR_ENTERED_TIME1

     2201    12293    4            OPERATOR_ENTERED_DATE1 = %NO#;

  12293  9 005270   000652 450000 1                  STZ     OPERATOR_ENTERED_DATE1

     2202    12294    4            OPERATOR_ENTERED_TIME2 = %NO#;

  12294  9 005271   000653 450000 1                  STZ     OPERATOR_ENTERED_TIME2

     2203    12295    4            OPERATOR_ENTERED_DATE2 = %NO#;

  12295  9 005272   000654 450000 1                  STZ     OPERATOR_ENTERED_DATE2
         9 005273   005374 710000 9                  TRA     s:12342

     2204    12296
     2205    12297    4         CASE (%CMD_RCONS#);

     2206    12298    4            CONSOLE = '?';

  12298  9 005274   000016 236000 10                 LDQ     14
         9 005275   000270 756000 1                  STQ     CONSOLE
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:293  

     2207    12299    4            LOCATION = '?';

  12299  9 005276   000016 235000 10                 LDA     14
         9 005277   000035 236000 xsym               LDQ     B_VECTNIL+29
         9 005300   000271 755000 1                  STA     LOCATION
         9 005301   000272 756000 1                  STQ     LOCATION+1
         9 005302   005374 710000 9                  TRA     s:12342

     2208    12300
     2209    12301    4         CASE (%CMD_RLOG#);

     2210    12302    4            LOGON = '?';

  12302  9 005303   000016 235000 10                 LDA     14
         9 005304   000035 236000 xsym               LDQ     B_VECTNIL+29
         9 005305   000276 757000 1                  STAQ    LOGON
         9 005306   005374 710000 9                  TRA     s:12342

     2211    12303
     2212    12304    4         CASE (%CMD_RWSN#);

     2213    12305    4            WSTATION = '?';

  12305  9 005307   000016 235000 10                 LDA     14
         9 005310   000035 236000 xsym               LDQ     B_VECTNIL+29
         9 005311   000274 757000 1                  STAQ    WSTATION
         9 005312   005374 710000 9                  TRA     s:12342

     2214    12306
     2215    12307    4         CASE (%CMD_RTYPE#);

     2216    12308    4            TYPE = '?';

  12308  9 005313   000016 235000 10                 LDA     14
         9 005314   000035 236000 xsym               LDQ     B_VECTNIL+29
         9 005315   000700 757000 1                  STAQ    TYPE
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:294  

     2217    12309    4            IP_LOC_TYPE = '?';

  12309  9 005316   000016 235000 10                 LDA     14
         9 005317   000035 236000 xsym               LDQ     B_VECTNIL+29
         9 005320   000702 757000 1                  STAQ    IP_LOC_TYPE
         9 005321   005374 710000 9                  TRA     s:12342

     2218    12310
     2219    12311    4         CASE (%CMD_R_LOGRPT#);

     2220    12312    4            LOGON_REPORT = %NO#;

  12312  9 005322   000711 450000 1                  STZ     LOGON_REPORT
         9 005323   005374 710000 9                  TRA     s:12342

     2221    12313
     2222    12314    4         CASE (%CMD_R_CONRPT#);

     2223    12315    4            CONSOLE_REPORT = %NO#;

  12315  9 005324   000745 450000 1                  STZ     CONSOLE_REPORT
         9 005325   005374 710000 9                  TRA     s:12342

     2224    12316
     2225    12317    4         CASE (%CMD_R_WILDCRD#);

     2226    12318    4            WILDCARDING = %NO#;

  12318  9 005326   000746 450000 1                  STZ     WILDCARDING
         9 005327   005374 710000 9                  TRA     s:12342

     2227    12319
     2228    12320    4         CASE (%CMD_NATLANG#);

     2229    12321    4            LANGUAGE = B$JIT$ -> B$JIT.LANG;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:295  
  12321  9 005330   000000 473400 xsym               LDP3    B$JIT$
         9 005331   300145 236100                    LDQ     101,,PR3
         9 005332   000033 736000                    QLS     27
         9 005333   000004 276000 10                 ORQ     4
         9 005334   000273 756000 1                  STQ     LANGUAGE

     2230    12322
     2231    12323    4         END;                              /* end case                           */

     2232    12324    3      END;                                 /* end IF                             */

  12324  9 005335   005374 710000 9                  TRA     s:12342

     2233    12325    2      ELSE
     2234    12326    3      DO;

     2235    12327    3         OPERATOR_ENTERED_TIME1 = %NO#;

  12327  9 005336   000651 450000 1                  STZ     OPERATOR_ENTERED_TIME1

     2236    12328    3         OPERATOR_ENTERED_DATE1 = %NO#;

  12328  9 005337   000652 450000 1                  STZ     OPERATOR_ENTERED_DATE1

     2237    12329    3         OPERATOR_ENTERED_TIME2 = %NO#;

  12329  9 005340   000653 450000 1                  STZ     OPERATOR_ENTERED_TIME2

     2238    12330    3         OPERATOR_ENTERED_DATE2 = %NO#;

  12330  9 005341   000654 450000 1                  STZ     OPERATOR_ENTERED_DATE2

     2239    12331    3         LOGON_REPORT = %NO#;

  12331  9 005342   000711 450000 1                  STZ     LOGON_REPORT

     2240    12332    3         CONSOLE_REPORT = %NO#;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:296  

  12332  9 005343   000745 450000 1                  STZ     CONSOLE_REPORT

     2241    12333    3         CONSOLE = '?';

  12333  9 005344   000016 236000 10                 LDQ     14
         9 005345   000270 756000 1                  STQ     CONSOLE

     2242    12334    3         LOCATION = '?';

  12334  9 005346   000016 235000 10                 LDA     14
         9 005347   000035 236000 xsym               LDQ     B_VECTNIL+29
         9 005350   000271 755000 1                  STA     LOCATION
         9 005351   000272 756000 1                  STQ     LOCATION+1

     2243    12335    3         LOGON = '?';

  12335  9 005352   000016 235000 10                 LDA     14
         9 005353   000035 236000 xsym               LDQ     B_VECTNIL+29
         9 005354   000276 757000 1                  STAQ    LOGON

     2244    12336    3         WSTATION = '?';

  12336  9 005355   000016 235000 10                 LDA     14
         9 005356   000035 236000 xsym               LDQ     B_VECTNIL+29
         9 005357   000274 757000 1                  STAQ    WSTATION

     2245    12337    3         TYPE = '?';

  12337  9 005360   000016 235000 10                 LDA     14
         9 005361   000035 236000 xsym               LDQ     B_VECTNIL+29
         9 005362   000700 757000 1                  STAQ    TYPE

     2246    12338    3         IP_LOC_TYPE = '?';

  12338  9 005363   000016 235000 10                 LDA     14
         9 005364   000035 236000 xsym               LDQ     B_VECTNIL+29
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:297  
         9 005365   000702 757000 1                  STAQ    IP_LOC_TYPE

     2247    12339    3         WILDCARDING = %NO#;

  12339  9 005366   000746 450000 1                  STZ     WILDCARDING

     2248    12340    3         LANGUAGE = B$JIT$ -> B$JIT.LANG;

  12340  9 005367   000000 471400 xsym               LDP1    B$JIT$
         9 005370   100145 236100                    LDQ     101,,PR1
         9 005371   000033 736000                    QLS     27
         9 005372   000004 276000 10                 ORQ     4
         9 005373   000273 756000 1                  STQ     LANGUAGE

     2249    12341    3      END;

     2250    12342    2   END DO_RESET;

  12342  9 005374   000001 702211                    TSX2  ! 1,X1

     2251    12343        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:298  
     2252    12344
     2253    12345         /*
     2254    12346                  S U B R O U T I N E   D O _ D I S P L A Y
     2255    12347                                                */
     2256    12348
     2257    12349    1   DO_DISPLAY: PROC;

  12349  9 005375   200004 741300       DO_DISPLAY   STX1  ! TEMP_UTS+1,,AUTO

     2258    12350
     2259    12351         /* Save wildcard pattern              */
     2260    12352    2      OUT_BUFFER = MSG;

  12352  9 005376   040000 100400                    MLR     fill='040'O
         9 005377   000427 000400 1                  ADSC9   MSG                      cn=0,n=256
         9 005400   000527 000400 1                  ADSC9   OUT_BUFFER               cn=0,n=256

     2261    12353
     2262    12354    2      CALL INDEX (X, ' ', CONSOLE);

  12354  9 005401   000000 124400                    SCM     mask='000'O
         9 005402   000270 000004 1                  ADSC9   CONSOLE                  cn=0,n=4
         9 005403   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 005404   000217 000000 1                  ARG     X

     2263    12355    2      CALL CONCAT (MSG, 'Console = ', SUBSTR (CONSOLE, 0, X), '@', LOCATION);

  12355  9 005405   040000 100400                    MLR     fill='040'O
         9 005406   000035 000012 8                  ADSC9   MOP_8_DIGITS_3+28        cn=0,n=10
         9 005407   000427 000012 1                  ADSC9   MSG                      cn=0,n=10
         9 005410   000217 720000 1                  LXL0    X
         9 005411   040000 100440                    MLR     fill='040'O
         9 005412   000270 000010 1                  ADSC9   CONSOLE                  cn=0,n=*X0
         9 005413   000431 400366 1                  ADSC9   MSG+2                    cn=2,n=246
         9 005414   000217 236000 1                  LDQ     X
         9 005415   000366 116007                    CMPQ    246,DL
         9 005416   005433 605000 9                  TPL     s:12356
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:299  
         9 005417   777411 622006                    EAX2    -247,QL
         9 005420   777777 662003                    ERX2    -1,DU
         9 005421   040046 100400                    MLR     fill='040'O
         9 005422   000022 000001 10                 ADSC9   18                       cn=0,n=1
         9 005423   000431 400012 1                  ADSC9   MSG+2,Q                  cn=2,n=*X2
         9 005424   000365 116007                    CMPQ    245,DL
         9 005425   005433 605000 9                  TPL     s:12356
         9 005426   777412 623006                    EAX3    -246,QL
         9 005427   777777 663003                    ERX3    -1,DU
         9 005430   040046 100400                    MLR     fill='040'O
         9 005431   000271 000010 1                  ADSC9   LOCATION                 cn=0,n=8
         9 005432   000431 600013 1                  ADSC9   MSG+2,Q                  cn=3,n=*X3

     2264    12356    2      OUT_MSG.BUF_.BOUND = 23;

  12356  9 005433   001704 236000 1                  LDQ     OUT_MSG+4
         9 005434   177777 376007                    ANQ     65535,DL
         9 005435   000046 276000 10                 ORQ     38
         9 005436   001704 756000 1                  STQ     OUT_MSG+4

     2265    12357    3      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;

  12357  9 005437   001700 630400 1                  EPPR0   OUT_MSG
         9 005440   440001 713400                    CLIMB   alt,write
         9 005441   401400 401760                    pmme    nvectors=4
         9 005442   005444 702000 9                  TSX2    s:12359
         9 005443   005444 710000 9                  TRA     s:12359

     2266    12358
     2267    12359    2      CALL CONCAT (MSG, 'Logon = ', LOGON);

  12359  9 005444   000040 237000 8                  LDAQ    MOP_8_DIGITS_3+31
         9 005445   000427 755000 1                  STA     MSG
         9 005446   000430 756000 1                  STQ     MSG+1
         9 005447   040000 100400                    MLR     fill='040'O
         9 005450   000276 000010 1                  ADSC9   LOGON                    cn=0,n=8
         9 005451   000431 000370 1                  ADSC9   MSG+2                    cn=0,n=248
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:300  

     2268    12360    2      OUT_MSG.BUF_.BOUND = 16;

  12360  9 005452   001704 236000 1                  LDQ     OUT_MSG+4
         9 005453   177777 376007                    ANQ     65535,DL
         9 005454   000004 276003                    ORQ     4,DU
         9 005455   001704 756000 1                  STQ     OUT_MSG+4

     2269    12361    3      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;

  12361  9 005456   001700 630400 1                  EPPR0   OUT_MSG
         9 005457   440001 713400                    CLIMB   alt,write
         9 005460   401400 401760                    pmme    nvectors=4
         9 005461   005463 702000 9                  TSX2    s:12363
         9 005462   005463 710000 9                  TRA     s:12363

     2270    12362
     2271    12363    2      CALL CONCAT (MSG, 'Workstation = ', WSTATION);

  12363  9 005463   040000 100400                    MLR     fill='040'O
         9 005464   000042 000016 8                  ADSC9   MOP_8_DIGITS_3+33        cn=0,n=14
         9 005465   000427 000016 1                  ADSC9   MSG                      cn=0,n=14
         9 005466   040000 100400                    MLR     fill='040'O
         9 005467   000274 000010 1                  ADSC9   WSTATION                 cn=0,n=8
         9 005470   000432 400362 1                  ADSC9   MSG+3                    cn=2,n=242

     2272    12364    2      OUT_MSG.BUF_.BOUND = 22;

  12364  9 005471   001704 236000 1                  LDQ     OUT_MSG+4
         9 005472   177777 376007                    ANQ     65535,DL
         9 005473   000047 276000 10                 ORQ     39
         9 005474   001704 756000 1                  STQ     OUT_MSG+4

     2273    12365    3      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;

  12365  9 005475   001700 630400 1                  EPPR0   OUT_MSG
         9 005476   440001 713400                    CLIMB   alt,write
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:301  
         9 005477   401400 401760                    pmme    nvectors=4
         9 005500   005502 702000 9                  TSX2    s:12367
         9 005501   005502 710000 9                  TRA     s:12367

     2274    12366
     2275    12367    2      MSG = 'Attribute type = ';

  12367  9 005502   040000 100400                    MLR     fill='040'O
         9 005503   000046 000021 8                  ADSC9   MOP_8_DIGITS_3+37        cn=0,n=17
         9 005504   000427 000400 1                  ADSC9   MSG                      cn=0,n=256

     2276    12368    2      OUT_MSG.BUF_.BOUND=38;

  12368  9 005505   001704 236000 1                  LDQ     OUT_MSG+4
         9 005506   177777 376007                    ANQ     65535,DL
         9 005507   000050 276000 10                 ORQ     40
         9 005510   001704 756000 1                  STQ     OUT_MSG+4

     2277    12369    2      IF TYPE = '?' THEN CALL INSERT (MSG, 17, 1, '?');

  12369  9 005511   000700 237000 1                  LDAQ    TYPE
         9 005512   000016 117000 10                 CMPAQ   14
         9 005513   005517 601000 9                  TNZ     s:12370

  12369  9 005514   000077 236003                    LDQ     63,DU
         9 005515   000433 552020 1                  STBQ    MSG+4,'20'O
         9 005516   005563 710000 9                  TRA     s:12376

     2278    12370    2      ELSE IF IP_ATTR_TYPE = '100000'O /* M_DEVC  */ THEN CALL INSERT (MSG, 17, 15,
             12370               'DEVICE@', IP_LOC_TYPE);

  12370  9 005517   000704 220000 1                  LDX0    IP_ATTR_TYPE
         9 005520   100000 100003                    CMPX0   32768,DU
         9 005521   005531 601000 9                  TNZ     s:12371

  12370  9 005522   040000 100400                    MLR     fill='040'O
         9 005523   000053 000007 8                  ADSC9   MOP_8_DIGITS_3+42        cn=0,n=7
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:302  
         9 005524   000433 200007 1                  ADSC9   MSG+4                    cn=1,n=7
         9 005525   000702 237000 1                  LDAQ    IP_LOC_TYPE
         9 005526   000435 755000 1                  STA     MSG+6
         9 005527   000436 756000 1                  STQ     MSG+7
         9 005530   005563 710000 9                  TRA     s:12376

     2279    12371    2      ELSE IF IP_ATTR_TYPE = '040000'O /* M_ADMIN */ THEN CALL INSERT (MSG, 17, 14,
             12371               'ADMIN@', IP_LOC_TYPE);

  12371  9 005531   040000 100003                    CMPX0   16384,DU
         9 005532   005542 601000 9                  TNZ     s:12372

  12371  9 005533   040000 100400                    MLR     fill='040'O
         9 005534   000055 000006 8                  ADSC9   MOP_8_DIGITS_3+44        cn=0,n=6
         9 005535   000433 200006 1                  ADSC9   MSG+4                    cn=1,n=6
         9 005536   040000 100400                    MLR     fill='040'O
         9 005537   000702 000010 1                  ADSC9   IP_LOC_TYPE              cn=0,n=8
         9 005540   000434 600010 1                  ADSC9   MSG+5                    cn=3,n=8
         9 005541   005563 710000 9                  TRA     s:12376

     2280    12372    2      ELSE IF IP_ATTR_TYPE = '200000'O /* M_SYS  */ THEN CALL INSERT (MSG, 17, 6,
             12372               'SYSTEM');

  12372  9 005542   200000 100003                    CMPX0   65536,DU
         9 005543   005550 601000 9                  TNZ     s:12373

  12372  9 005544   040000 100400                    MLR     fill='040'O
         9 005545   000057 000006 8                  ADSC9   MOP_8_DIGITS_3+46        cn=0,n=6
         9 005546   000433 200006 1                  ADSC9   MSG+4                    cn=1,n=6
         9 005547   005563 710000 9                  TRA     s:12376

     2281    12373    2      ELSE IF IP_ATTR_TYPE = '004000'O /* M_COMM */ THEN CALL INSERT (MSG, 17, 4,
             12373               'COMM');

  12373  9 005550   004000 100003                    CMPX0   2048,DU
         9 005551   005556 601000 9                  TNZ     s:12374

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:303  
  12373  9 005552   040000 100400                    MLR     fill='040'O
         9 005553   000061 000004 8                  ADSC9   MOP_8_DIGITS_3+48        cn=0,n=4
         9 005554   000433 200004 1                  ADSC9   MSG+4                    cn=1,n=4
         9 005555   005563 710000 9                  TRA     s:12376

     2282    12374    2      ELSE IF IP_ATTR_TYPE = '001000'O /* M_TP */ THEN CALL INSERT (MSG, 17, 2, 'TP');

  12374  9 005556   001000 100003                    CMPX0   512,DU
         9 005557   005563 601000 9                  TNZ     s:12376

  12374  9 005560   000062 236000 8                  LDQ     MOP_8_DIGITS_3+49
         9 005561   000011 772000                    QRL     9
         9 005562   000433 552030 1                  STBQ    MSG+4,'30'O

     2283    12375
     2284    12376    3      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;

  12376  9 005563   001700 630400 1                  EPPR0   OUT_MSG
         9 005564   440001 713400                    CLIMB   alt,write
         9 005565   401400 401760                    pmme    nvectors=4
         9 005566   005570 702000 9                  TSX2    s:12378
         9 005567   005570 710000 9                  TRA     s:12378

     2285    12377
     2286    12378    2      IF LOGON_REPORT THEN MSG = 'Logon report = YES';

  12378  9 005570   000711 234000 1                  SZN     LOGON_REPORT
         9 005571   005576 605000 9                  TPL     s:12379

  12378  9 005572   040000 100400                    MLR     fill='040'O
         9 005573   000063 000022 8                  ADSC9   MOP_8_DIGITS_3+50        cn=0,n=18
         9 005574   000427 000400 1                  ADSC9   MSG                      cn=0,n=256
         9 005575   005601 710000 9                  TRA     s:12380

     2287    12379    2      ELSE MSG = 'Logon report = NO ';

  12379  9 005576   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:304  
         9 005577   000070 000022 8                  ADSC9   MOP_8_DIGITS_3+55        cn=0,n=18
         9 005600   000427 000400 1                  ADSC9   MSG                      cn=0,n=256

     2288    12380    2      OUT_MSG.BUF_.BOUND = 18;

  12380  9 005601   001704 236000 1                  LDQ     OUT_MSG+4
         9 005602   177777 376007                    ANQ     65535,DL
         9 005603   000051 276000 10                 ORQ     41
         9 005604   001704 756000 1                  STQ     OUT_MSG+4

     2289    12381    3      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;

  12381  9 005605   001700 630400 1                  EPPR0   OUT_MSG
         9 005606   440001 713400                    CLIMB   alt,write
         9 005607   401400 401760                    pmme    nvectors=4
         9 005610   005612 702000 9                  TSX2    s:12383
         9 005611   005612 710000 9                  TRA     s:12383

     2290    12382
     2291    12383    2      IF CONSOLE_REPORT THEN MSG = 'Console report = YES';

  12383  9 005612   000745 234000 1                  SZN     CONSOLE_REPORT
         9 005613   005620 605000 9                  TPL     s:12384

  12383  9 005614   040000 100400                    MLR     fill='040'O
         9 005615   000075 000024 8                  ADSC9   MOP_8_DIGITS_3+60        cn=0,n=20
         9 005616   000427 000400 1                  ADSC9   MSG                      cn=0,n=256
         9 005617   005623 710000 9                  TRA     s:12385

     2292    12384    2      ELSE MSG = 'Console report = NO ';

  12384  9 005620   040000 100400                    MLR     fill='040'O
         9 005621   000102 000024 8                  ADSC9   MOP_8_DIGITS_3+65        cn=0,n=20
         9 005622   000427 000400 1                  ADSC9   MSG                      cn=0,n=256

     2293    12385    2      OUT_MSG.BUF_.BOUND = 20;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:305  
  12385  9 005623   001704 236000 1                  LDQ     OUT_MSG+4
         9 005624   177777 376007                    ANQ     65535,DL
         9 005625   000005 276003                    ORQ     5,DU
         9 005626   001704 756000 1                  STQ     OUT_MSG+4

     2294    12386    3      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;

  12386  9 005627   001700 630400 1                  EPPR0   OUT_MSG
         9 005630   440001 713400                    CLIMB   alt,write
         9 005631   401400 401760                    pmme    nvectors=4
         9 005632   005634 702000 9                  TSX2    s:12388
         9 005633   005634 710000 9                  TRA     s:12388

     2295    12387
     2296    12388    2      IF WILDCARDING THEN MSG = 'Wildcarding = YES';

  12388  9 005634   000746 234000 1                  SZN     WILDCARDING
         9 005635   005642 605000 9                  TPL     s:12389

  12388  9 005636   040000 100400                    MLR     fill='040'O
         9 005637   000107 000021 8                  ADSC9   MOP_8_DIGITS_3+70        cn=0,n=17
         9 005640   000427 000400 1                  ADSC9   MSG                      cn=0,n=256
         9 005641   005645 710000 9                  TRA     s:12390

     2297    12389    2      ELSE MSG = 'Wildcarding = NO ';

  12389  9 005642   040000 100400                    MLR     fill='040'O
         9 005643   000114 000021 8                  ADSC9   MOP_8_DIGITS_3+75        cn=0,n=17
         9 005644   000427 000400 1                  ADSC9   MSG                      cn=0,n=256

     2298    12390    2      OUT_MSG.BUF_.BOUND = 17;

  12390  9 005645   001704 236000 1                  LDQ     OUT_MSG+4
         9 005646   177777 376007                    ANQ     65535,DL
         9 005647   000052 276000 10                 ORQ     42
         9 005650   001704 756000 1                  STQ     OUT_MSG+4

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:306  
     2299    12391    3      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;

  12391  9 005651   001700 630400 1                  EPPR0   OUT_MSG
         9 005652   440001 713400                    CLIMB   alt,write
         9 005653   401400 401760                    pmme    nvectors=4
         9 005654   005656 702000 9                  TSX2    s:12394
         9 005655   005656 710000 9                  TRA     s:12394

     2300    12392
     2301    12393        /* Restore wildcard pattern           */
     2302    12394    2      MSG = OUT_BUFFER;

  12394  9 005656   040000 100400                    MLR     fill='040'O
         9 005657   000527 000400 1                  ADSC9   OUT_BUFFER               cn=0,n=256
         9 005660   000427 000400 1                  ADSC9   MSG                      cn=0,n=256

     2303    12395
     2304    12396    2   END DO_DISPLAY;

  12396  9 005661   200004 221300                    LDX1  ! TEMP_UTS+1,,AUTO
         9 005662   000001 702211                    TSX2  ! 1,X1

     2305    12397        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:307  
     2306    12398        /*          S U B R O U T I N E   S E T _ D E S T I N A T I O N               */
     2307    12399
     2308    12400    1   SET_DESTINATION: PROC;

  12400  9 005663   200004 741300       SET_DESTINA* STX1  ! TEMP_UTS+1,,AUTO

     2309    12401
     2310    12402
     2311    12403    3      IF OUT$ -> OUT$BLK.NSUBLKS > 0 THEN DO;

  12403  9 005664   000165 470400 1                  LDP0    OUT$
         9 005665   000001 220100                    LDX0    1,,PR0
         9 005666   005723 600000 9                  TZE     s:12423

     2312    12404    3         DESTINATION = OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;

  12404  9 005667   000003 471500                    LDP1    3,,PR0
         9 005670   100004 236100                    LDQ     4,,PR1
         9 005671   000033 772000                    QRL     27
         9 005672   000000 622006                    EAX2    0,QL
         9 005673   040000 100540                    MLR     fill='040'O
         9 005674   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         9 005675   000222 000037 1                  ADSC9   DESTINATION              cn=0,n=31

     2313    12405
     2314    12406    3         IF DCBADDR(DCBNUM(M$LO))->F$DCB.FCD#

  12406  9 005676   000000 236007 xsym               LDQ     M$LO,DL
         9 005677   000005 471400 10                 LDP1    5
         9 005700   100000 473500                    LDP3    0,,PR1
         9 005701   300000 474506                    LDP4    0,QL,PR3
         9 005702   400031 236100                    LDQ     25,,PR4
         9 005703   020000 316007                    CANQ    8192,DL
         9 005704   005711 600000 9                  TZE     s:12409

     2315    12407    3         THEN CALL M$CLOSE(CLOSE_LO) ALTRET(CANT_CLOSE_LO);

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:308  
  12407  9 005705   002776 630400 1                  EPPR0   CLOSE_LO
         9 005706   450001 713400                    CLIMB   alt,close
         9 005707   406000 401760                    pmme    nvectors=13
         9 005710   005725 702000 9                  TSX2    CANT_CLOSE_LO

     2316    12408
     2317    12409    3         FID_DEST.TEXTFID_ = VECTOR (DESTINATION);

  12409  9 005711   000054 237000 10                 LDAQ    44
         9 005712   002534 757000 1                  STAQ    FID_DEST+2

     2318    12410
     2319    12411                                                /* Take data in textfid & convert
     2320    12412                                                     (via M$FID) to data which
     2321    12413                                                     override corresponding
     2322    12414                                                     defaults in M$LO.                */
     2323    12415
     2324    12416    3         CALL M$FID (FID_DEST) ALTRET (CANT_FID);

  12416  9 005713   002532 630400 1                  EPPR0   FID_DEST
         9 005714   420001 713400                    CLIMB   alt,+8193
         9 005715   404400 401760                    pmme    nvectors=10
         9 005716   005774 702000 9                  TSX2    CANT_FID

     2325    12417
     2326    12418    3         CALL M$OPEN (OPEN_DEST) ALTRET (CANT_OPEN_DEST);

  12418  9 005717   002704 630400 1                  EPPR0   OPEN_DEST
         9 005720   450000 713400                    CLIMB   alt,open
         9 005721   410400 401760                    pmme    nvectors=18
         9 005722   006045 702000 9                  TSX2    CANT_OPEN_DEST

     2327    12419
     2328    12420                                                /* Open M$LO with new values.         */
     2329    12421    3      END;

     2330    12422
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:309  
     2331    12423    2      RETURN;

  12423  9 005723   200004 221300                    LDX1  ! TEMP_UTS+1,,AUTO
         9 005724   000001 702211                    TSX2  ! 1,X1

  12416  9 005725                       CANT_CLOSE_* null
     2332    12424
     2333    12425
     2334    12426    2   CANT_CLOSE_LO:;
     2335    12427    2      MODULE_ERR.ERR# = 27 /* E_CLOSELO# */;

  12427  9 005725   001670 236000 1                  LDQ     MODULE_ERR
         9 005726   000001 376000 10                 ANQ     1
         9 005727   000330 276007                    ORQ     216,DL
         9 005730   001670 756000 1                  STQ     MODULE_ERR

     2336    12428    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;

  12428  9 005731   000000 470400 xsym               LDP0    B$TCB$
         9 005732   000000 471500                    LDP1    0,,PR0
         9 005733   100101 235100                    LDA     65,,PR1
         9 005734   000215 755000 1                  STA     DCB#

     2337    12429    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

  12429  9 005735   000000 236007 xsym               LDQ     M$LO,DL
         9 005736   200014 756100                    STQ     IOPT+7,,AUTO
         9 005737   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 005740   200017 451500                    STP1    IOPT+10,,AUTO
         9 005741   000031 236000 10                 LDQ     25
         9 005742   200016 756100                    STQ     IOPT+9,,AUTO
         9 005743   000003 236000 10                 LDQ     3
         9 005744   200015 756100                    STQ     IOPT+8,,AUTO
         9 005745   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 005746   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 005747   000000 701000 xent               TSX1    XUR$ERRMSG
         9 005750   000000 011000                    NOP     0
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:310  

     2338    12430    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  12430  9 005751   000000 470400 xsym               LDP0    B$TCB$
         9 005752   000000 471500                    LDP1    0,,PR0
         9 005753   100102 236100                    LDQ     66,,PR1
         9 005754   001125 756000 1                  STQ     ERROR

     2339    12431    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

  12431  9 005755   000000 236007 xsym               LDQ     M$LO,DL
         9 005756   200014 756100                    STQ     IOPT+7,,AUTO
         9 005757   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 005760   200017 451500                    STP1    IOPT+10,,AUTO
         9 005761   000031 236000 10                 LDQ     25
         9 005762   200016 756100                    STQ     IOPT+9,,AUTO
         9 005763   000030 236000 10                 LDQ     24
         9 005764   200015 756100                    STQ     IOPT+8,,AUTO
         9 005765   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 005766   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 005767   000000 701000 xent               TSX1    XUR$ERRMSG
         9 005770   000000 011000                    NOP     0

     2340    12432    2      CALL ORR$XCONRTN;

  12432  9 005771   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 005772   000000 701000 xent               TSX1    ORR$XCONRTN
         9 005773   000000 011000                    NOP     0

  12430  9 005774                       CANT_FID     null
     2341    12433
     2342    12434    2   CANT_FID:;
     2343    12435        /*E* ERROR: ORR-E_FIDERR#-7
     2344    12436             MESSAGE: Altret occurred on attempt to change
     2345    12437                      the destination of DCB M$LO
     2346    12438                                 */
     2347    12439    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:311  

  12439  9 005774   000000 470400 xsym               LDP0    B$TCB$
         9 005775   000000 471500                    LDP1    0,,PR0
         9 005776   100101 235100                    LDA     65,,PR1
         9 005777   000215 755000 1                  STA     DCB#

     2348    12440    2      MODULE_ERR.ERR# = 30 /* E_FIDERR# */;

  12440  9 006000   001670 236000 1                  LDQ     MODULE_ERR
         9 006001   000001 376000 10                 ANQ     1
         9 006002   000360 276007                    ORQ     240,DL
         9 006003   001670 756000 1                  STQ     MODULE_ERR

     2349    12441    2      MODULE_ERR.SEV = 0;

  12441  9 006004   000002 236000 10                 LDQ     2
         9 006005   001670 356000 1                  ANSQ    MODULE_ERR

     2350    12442    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

  12442  9 006006   000000 236007 xsym               LDQ     M$LO,DL
         9 006007   200014 756100                    STQ     IOPT+7,,AUTO
         9 006010   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 006011   200017 451500                    STP1    IOPT+10,,AUTO
         9 006012   000031 236000 10                 LDQ     25
         9 006013   200016 756100                    STQ     IOPT+9,,AUTO
         9 006014   000003 236000 10                 LDQ     3
         9 006015   200015 756100                    STQ     IOPT+8,,AUTO
         9 006016   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 006017   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 006020   000000 701000 xent               TSX1    XUR$ERRMSG
         9 006021   000000 011000                    NOP     0

     2351    12443    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  12443  9 006022   000000 470400 xsym               LDP0    B$TCB$
         9 006023   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:312  
         9 006024   100102 236100                    LDQ     66,,PR1
         9 006025   001125 756000 1                  STQ     ERROR

     2352    12444    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

  12444  9 006026   000000 236007 xsym               LDQ     M$LO,DL
         9 006027   200014 756100                    STQ     IOPT+7,,AUTO
         9 006030   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 006031   200017 451500                    STP1    IOPT+10,,AUTO
         9 006032   000031 236000 10                 LDQ     25
         9 006033   200016 756100                    STQ     IOPT+9,,AUTO
         9 006034   000030 236000 10                 LDQ     24
         9 006035   200015 756100                    STQ     IOPT+8,,AUTO
         9 006036   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 006037   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 006040   000000 701000 xent               TSX1    XUR$ERRMSG
         9 006041   000000 011000                    NOP     0

     2353    12445    2      CALL ORR$XCONRTN;

  12445  9 006042   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 006043   000000 701000 xent               TSX1    ORR$XCONRTN
         9 006044   000000 011000                    NOP     0

  12443  9 006045                       CANT_OPEN_D* null
     2354    12446
     2355    12447    2   CANT_OPEN_DEST:;
     2356    12448    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;

  12448  9 006045   000000 470400 xsym               LDP0    B$TCB$
         9 006046   000000 471500                    LDP1    0,,PR0
         9 006047   100101 235100                    LDA     65,,PR1
         9 006050   000215 755000 1                  STA     DCB#

     2357    12449    2      MODULE_ERR.ERR# = 24 /* E_OPENLO# */;

  12449  9 006051   001670 236000 1                  LDQ     MODULE_ERR
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:313  
         9 006052   000001 376000 10                 ANQ     1
         9 006053   000300 276007                    ORQ     192,DL
         9 006054   001670 756000 1                  STQ     MODULE_ERR

     2358    12450    2      MODULE_ERR.SEV = 0;

  12450  9 006055   000002 236000 10                 LDQ     2
         9 006056   001670 356000 1                  ANSQ    MODULE_ERR

     2359    12451    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

  12451  9 006057   000000 236007 xsym               LDQ     M$LO,DL
         9 006060   200014 756100                    STQ     IOPT+7,,AUTO
         9 006061   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 006062   200017 451500                    STP1    IOPT+10,,AUTO
         9 006063   000031 236000 10                 LDQ     25
         9 006064   200016 756100                    STQ     IOPT+9,,AUTO
         9 006065   000003 236000 10                 LDQ     3
         9 006066   200015 756100                    STQ     IOPT+8,,AUTO
         9 006067   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 006070   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 006071   000000 701000 xent               TSX1    XUR$ERRMSG
         9 006072   000000 011000                    NOP     0

     2360    12452    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  12452  9 006073   000000 470400 xsym               LDP0    B$TCB$
         9 006074   000000 471500                    LDP1    0,,PR0
         9 006075   100102 236100                    LDQ     66,,PR1
         9 006076   001125 756000 1                  STQ     ERROR

     2361    12453    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

  12453  9 006077   000000 236007 xsym               LDQ     M$LO,DL
         9 006100   200014 756100                    STQ     IOPT+7,,AUTO
         9 006101   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 006102   200017 451500                    STP1    IOPT+10,,AUTO
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:314  
         9 006103   000031 236000 10                 LDQ     25
         9 006104   200016 756100                    STQ     IOPT+9,,AUTO
         9 006105   000030 236000 10                 LDQ     24
         9 006106   200015 756100                    STQ     IOPT+8,,AUTO
         9 006107   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 006110   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 006111   000000 701000 xent               TSX1    XUR$ERRMSG
         9 006112   000000 011000                    NOP     0

     2362    12454    2      CALL ORR$XCONRTN;

  12454  9 006113   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 006114   000000 701000 xent               TSX1    ORR$XCONRTN
         9 006115   000000 011000                    NOP     0

     2363    12455    2   END SET_DESTINATION;

  12455  9 006116   200004 221300                    LDX1  ! TEMP_UTS+1,,AUTO
         9 006117   000001 702211                    TSX2  ! 1,X1

     2364    12456        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:315  
     2365    12457         /*
     2366    12458                  S U B R O U T I N E   D O _ T I M E
     2367    12459                                                */
     2368    12460    1   DO_TIME: PROC;

  12460  9 006120   200004 741300       DO_TIME      STX1  ! TEMP_UTS+1,,AUTO

     2369    12461    2      SUBS1 = OUT$ -> OUT$BLK.NSUBLKS;

  12461  9 006121   000165 470400 1                  LDP0    OUT$
         9 006122   000001 236100                    LDQ     1,,PR0
         9 006123   000022 772000                    QRL     18
         9 006124   000221 756000 1                  STQ     SUBS1

     2370    12462
     2371    12463    3      DO I = 0 TO (SUBS1 - 1) BY 1;

  12463  9 006125   000216 450000 1                  STZ     I
         9 006126   006556 710000 9                  TRA     s:12610+1

     2372    12464    3         LISTPTR$ = OUT$ -> OUT$BLK.SUBLK$(I);

  12464  9 006127   000165 470400 1                  LDP0    OUT$
         9 006130   000216 720000 1                  LXL0    I
         9 006131   000003 236110                    LDQ     3,X0,PR0
         9 006132   000167 756000 1                  STQ     LISTPTR$

     2373    12465    3         SUBS2 = LISTPTR$ -> OUT$BLK.NSUBLKS;

  12465  9 006133   000167 471400 1                  LDP1    LISTPTR$
         9 006134   100001 236100                    LDQ     1,,PR1
         9 006135   000022 772000                    QRL     18
         9 006136   000220 756000 1                  STQ     SUBS2

     2374    12466
     2375    12467    4         DO CASE (LISTPTR$ -> OUT$BLK.CODE);

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:316  
  12467  9 006137   100000 236100                    LDQ     0,,PR1
         9 006140   777777 376007                    ANQ     -1,DL
         9 006141   000005 136007                    SBLQ    5,DL
         9 006142   000002 116007                    CMPQ    2,DL
         9 006143   006145 602006 9                  TNC     s:12467+6,QL
         9 006144   006555 710000 9                  TRA     s:12610
         9 006145   006147 710000 9                  TRA     s:12470
         9 006146   006350 710000 9                  TRA     s:12540

     2376    12468    4         CASE (%CMD_TIME1#);

     2377    12469
     2378    12470    5            DO X = 0 TO (SUBS2 - 1) BY 1;

  12470  9 006147   000217 450000 1                  STZ     X
         9 006150   006311 710000 9                  TRA     s:12529+1

     2379    12471    5               PTR$ = LISTPTR$ -> OUT$BLK.SUBLK$(X);

  12471  9 006151   000167 470400 1                  LDP0    LISTPTR$
         9 006152   000217 720000 1                  LXL0    X
         9 006153   000003 236110                    LDQ     3,X0,PR0
         9 006154   000166 756000 1                  STQ     PTR$

     2380    12472
     2381    12473    6               DO CASE (PTR$ -> OUT$BLK.CODE);

  12473  9 006155   000166 471400 1                  LDP1    PTR$
         9 006156   100000 236100                    LDQ     0,,PR1
         9 006157   777777 376007                    ANQ     -1,DL
         9 006160   000007 136007                    SBLQ    7,DL
         9 006161   000002 116007                    CMPQ    2,DL
         9 006162   006164 602006 9                  TNC     s:12473+7,QL
         9 006163   006310 710000 9                  TRA     s:12529
         9 006164   006166 710000 9                  TRA     s:12475
         9 006165   006226 710000 9                  TRA     s:12495

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:317  
     2382    12474    6               CASE (%CMD_HHMM#);

     2383    12475    6                  HOUR1 = '00';

  12475  9 006166   000010 221000 8                  LDX1    MOP_8_DIGITS_3+7
         9 006167   000174 741000 1                  STX1    HOUR1

     2384    12476    6                  CALL INSERT (HOUR1,

  12476  9 006170   100003 473500                    LDP3    3,,PR1
         9 006171   300004 236100                    LDQ     4,,PR3
         9 006172   000033 772000                    QRL     27
         9 006173   000000 622006                    EAX2    0,QL
         9 006174   000000 635012                    EAA     0,X2
         9 006175   000022 771000                    ARL     18
         9 006176   000027 675000 xsym               ERA     B_VECTNIL+23
         9 006177   000001 035007                    ADLA    1,DL
         9 006200   000000 623006                    EAX3    0,QL
         9 006201   040045 100540                    MLR     fill='040'O
         9 006202   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         9 006203   000174 400013 1                  ADSC9   HOUR1,A                  cn=2,n=*X3

     2385    12477    6                    LENGTHC (HOUR1) -
     2386    12478    6                    (PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.COUNT),
     2387    12479    6                    ,
     2388    12480    6                    PTR$ -> OUT$BLK.SUBLK$(0) ->
     2389    12481    6                    OUT$SYM.TEXT);
     2390    12482
     2391    12483    6                  MIN1 = '00';

  12483  9 006204   000175 741000 1                  STX1    MIN1

     2392    12484    6                  CALL INSERT (MIN1,

  12484  9 006205   100004 474500                    LDP4    4,,PR1
         9 006206   400004 236100                    LDQ     4,,PR4
         9 006207   000033 772000                    QRL     27
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:318  
         9 006210   000000 623006                    EAX3    0,QL
         9 006211   000000 635013                    EAA     0,X3
         9 006212   000022 771000                    ARL     18
         9 006213   000027 675000 xsym               ERA     B_VECTNIL+23
         9 006214   000001 035007                    ADLA    1,DL
         9 006215   000000 624006                    EAX4    0,QL
         9 006216   040045 100540                    MLR     fill='040'O
         9 006217   400004 200013                    ADSC9   4,,PR4                   cn=1,n=*X3
         9 006220   000175 400014 1                  ADSC9   MIN1,A                   cn=2,n=*X4

     2393    12485    6                    LENGTHC (MIN1) -
     2394    12486    6                    (PTR$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.COUNT),
     2395    12487    6                    ,
     2396    12488    6                    PTR$ -> OUT$BLK.SUBLK$(1) ->
     2397    12489    6                    OUT$SYM.TEXT);
     2398    12490    6                  OPERATOR_ENTERED_TIME1 = %YES#;

  12490  9 006221   400000 236003                    LDQ     -131072,DU
         9 006222   000651 756000 1                  STQ     OPERATOR_ENTERED_TIME1

     2399    12491    6                  SEC1 = '00';

  12491  9 006223   000176 741000 1                  STX1    SEC1

     2400    12492    6                  CENTISEC1 = '00';

  12492  9 006224   000177 741000 1                  STX1    CENTISEC1
         9 006225   006310 710000 9                  TRA     s:12529

     2401    12493
     2402    12494    6               CASE (%CMD_DATE#);

     2403    12495    6                  MONTH1 = '00';

  12495  9 006226   000010 221000 8                  LDX1    MOP_8_DIGITS_3+7
         9 006227   000200 741000 1                  STX1    MONTH1

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:319  
     2404    12496    6                  CALL INSERT (MONTH1,

  12496  9 006230   100003 473500                    LDP3    3,,PR1
         9 006231   300004 236100                    LDQ     4,,PR3
         9 006232   000033 772000                    QRL     27
         9 006233   000000 622006                    EAX2    0,QL
         9 006234   000000 635012                    EAA     0,X2
         9 006235   000022 771000                    ARL     18
         9 006236   000027 675000 xsym               ERA     B_VECTNIL+23
         9 006237   000001 035007                    ADLA    1,DL
         9 006240   000000 623006                    EAX3    0,QL
         9 006241   040045 100540                    MLR     fill='040'O
         9 006242   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         9 006243   000200 400013 1                  ADSC9   MONTH1,A                 cn=2,n=*X3

     2405    12497    6                    LENGTHC (MONTH1) -
     2406    12498    6                    (PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.COUNT),
     2407    12499    6                    ,
     2408    12500    6                    PTR$ -> OUT$BLK.SUBLK$(0) ->
     2409    12501    6                    OUT$SYM.TEXT);
     2410    12502
     2411    12503    6                  DAY1 = '00';

  12503  9 006244   000201 741000 1                  STX1    DAY1

     2412    12504    6                  CALL INSERT (DAY1,

  12504  9 006245   100004 474500                    LDP4    4,,PR1
         9 006246   400004 236100                    LDQ     4,,PR4
         9 006247   000033 772000                    QRL     27
         9 006250   000000 623006                    EAX3    0,QL
         9 006251   000000 635013                    EAA     0,X3
         9 006252   000022 771000                    ARL     18
         9 006253   000027 675000 xsym               ERA     B_VECTNIL+23
         9 006254   000001 035007                    ADLA    1,DL
         9 006255   000000 624006                    EAX4    0,QL
         9 006256   040045 100540                    MLR     fill='040'O
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:320  
         9 006257   400004 200013                    ADSC9   4,,PR4                   cn=1,n=*X3
         9 006260   000201 400014 1                  ADSC9   DAY1,A                   cn=2,n=*X4

     2413    12505    6                    LENGTHC (DAY1) -
     2414    12506    6                    (PTR$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.COUNT),
     2415    12507    6                    ,
     2416    12508    6                    PTR$ -> OUT$BLK.SUBLK$(1) ->
     2417    12509    6                    OUT$SYM.TEXT);
     2418    12510
     2419    12511    6                  YEAR1 = '00';

  12511  9 006261   000202 741000 1                  STX1    YEAR1

     2420    12512    6                  CALL INSERT (YEAR1,

  12512  9 006262   100005 475500                    LDP5    5,,PR1
         9 006263   500004 236100                    LDQ     4,,PR5
         9 006264   000033 772000                    QRL     27
         9 006265   000000 624006                    EAX4    0,QL
         9 006266   000000 635014                    EAA     0,X4
         9 006267   000022 771000                    ARL     18
         9 006270   000027 675000 xsym               ERA     B_VECTNIL+23
         9 006271   000001 035007                    ADLA    1,DL
         9 006272   000000 625006                    EAX5    0,QL
         9 006273   040045 100540                    MLR     fill='040'O
         9 006274   500004 200014                    ADSC9   4,,PR5                   cn=1,n=*X4
         9 006275   000202 400015 1                  ADSC9   YEAR1,A                  cn=2,n=*X5

     2421    12513    6                    LENGTHC (YEAR1) -
     2422    12514    6                    (PTR$ -> OUT$BLK.SUBLK$(2) -> OUT$SYM.COUNT),
     2423    12515    6                    ,
     2424    12516    6                    PTR$ -> OUT$BLK.SUBLK$(2) ->
     2425    12517    6                    OUT$SYM.TEXT);
     2426    12518    6                  OPERATOR_ENTERED_DATE1 = %YES#;

  12518  9 006276   400000 236003                    LDQ     -131072,DU
         9 006277   000652 756000 1                  STQ     OPERATOR_ENTERED_DATE1
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:321  

     2427    12519    7                  IF SUBS2 = 1 THEN DO;

  12519  9 006300   000220 235000 1                  LDA     SUBS2
         9 006301   000001 115007                    CMPA    1,DL
         9 006302   006310 601000 9                  TNZ     s:12529

     2428    12520    7                     HOUR1 = '00';

  12520  9 006303   000174 741000 1                  STX1    HOUR1

     2429    12521    7                     MIN1 = '00';

  12521  9 006304   000175 741000 1                  STX1    MIN1

     2430    12522    7                     SEC1 = '00';

  12522  9 006305   000176 741000 1                  STX1    SEC1

     2431    12523    7                     CENTISEC1 = '00';

  12523  9 006306   000177 741000 1                  STX1    CENTISEC1

     2432    12524    7                     OPERATOR_ENTERED_TIME1 = %YES#;

  12524  9 006307   000651 756000 1                  STQ     OPERATOR_ENTERED_TIME1

     2433    12525    7                  END;

     2434    12526
     2435    12527    6               END;                        /* End case (ptr$ -> out$blk.code)    */

     2436    12528
     2437    12529    5            END;                           /* End Do Loop (x=0 to (subs2-1))     */

  12529  9 006310   000217 054000 1                  AOS     X
         9 006311   000217 236000 1                  LDQ     X
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:322  
         9 006312   000220 116000 1                  CMPQ    SUBS2
         9 006313   006151 604000 9                  TMI     s:12471

     2438    12530    4            CALL CHARBIN (YR,YEAR1);

  12530  9 006314   000100 305400                    DTB
         9 006315   000202 030002 1                  NDSC9   YEAR1                    cn=0,s=nosgn,sf=0,n=2
         9 006316   200014 000010                    NDSC9   IOPT+7,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         9 006317   200015 235100                    LDA     IOPT+8,,AUTO
         9 006320   000655 755000 1                  STA     YR

     2439    12531    4            CALL CHARBIN (MON,MONTH1);

  12531  9 006321   000100 305400                    DTB
         9 006322   000200 030002 1                  NDSC9   MONTH1                   cn=0,s=nosgn,sf=0,n=2
         9 006323   200014 000010                    NDSC9   IOPT+7,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         9 006324   200015 235100                    LDA     IOPT+8,,AUTO
         9 006325   000656 755000 1                  STA     MON

     2440    12532    4            CALL CHARBIN (DAY,DAY1);

  12532  9 006326   000100 305400                    DTB
         9 006327   000201 030002 1                  NDSC9   DAY1                     cn=0,s=nosgn,sf=0,n=2
         9 006330   200014 000010                    NDSC9   IOPT+7,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         9 006331   200015 235100                    LDA     IOPT+8,,AUTO
         9 006332   000657 755000 1                  STA     DAY

     2441    12533    4            CALL CHARBIN (HR,HOUR1);

  12533  9 006333   000100 305400                    DTB
         9 006334   000174 030002 1                  NDSC9   HOUR1                    cn=0,s=nosgn,sf=0,n=2
         9 006335   200014 000010                    NDSC9   IOPT+7,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         9 006336   200015 235100                    LDA     IOPT+8,,AUTO
         9 006337   000660 755000 1                  STA     HR

     2442    12534    4            CALL CHARBIN (MIN,MIN1);

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:323  
  12534  9 006340   000100 305400                    DTB
         9 006341   000175 030002 1                  NDSC9   MIN1                     cn=0,s=nosgn,sf=0,n=2
         9 006342   200014 000010                    NDSC9   IOPT+7,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         9 006343   200015 235100                    LDA     IOPT+8,,AUTO
         9 006344   000661 755000 1                  STA     MIN

     2443    12535    4            CALL TIME_VALIDATE;

  12535  9 006345   007025 701000 9                  TSX1    TIME_VALIDATE
         9 006346   000000 011000                    NOP     0
         9 006347   006555 710000 9                  TRA     s:12610

     2444    12536        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:324  
     2445    12537
     2446    12538    4         CASE (%CMD_TIME2#);

     2447    12539
     2448    12540    5            DO X = 0 TO (SUBS2 - 1) BY 1;

  12540  9 006350   000217 450000 1                  STZ     X
         9 006351   006517 710000 9                  TRA     s:12599+1

     2449    12541    5               PTR$ = LISTPTR$ -> OUT$BLK.SUBLK$(X);

  12541  9 006352   000167 470400 1                  LDP0    LISTPTR$
         9 006353   000217 720000 1                  LXL0    X
         9 006354   000003 236110                    LDQ     3,X0,PR0
         9 006355   000166 756000 1                  STQ     PTR$

     2450    12542
     2451    12543    6               DO CASE (PTR$ -> OUT$BLK.CODE);

  12543  9 006356   000166 471400 1                  LDP1    PTR$
         9 006357   100000 236100                    LDQ     0,,PR1
         9 006360   777777 376007                    ANQ     -1,DL
         9 006361   000007 136007                    SBLQ    7,DL
         9 006362   000002 116007                    CMPQ    2,DL
         9 006363   006365 602006 9                  TNC     s:12543+7,QL
         9 006364   006516 710000 9                  TRA     s:12599
         9 006365   006367 710000 9                  TRA     s:12545
         9 006366   006431 710000 9                  TRA     s:12565

     2452    12544    6               CASE (%CMD_HHMM#);

     2453    12545    6                  HOUR2 = '00';

  12545  9 006367   000010 221000 8                  LDX1    MOP_8_DIGITS_3+7
         9 006370   000203 741000 1                  STX1    HOUR2

     2454    12546    6                  CALL INSERT (HOUR2,
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:325  

  12546  9 006371   100003 473500                    LDP3    3,,PR1
         9 006372   300004 236100                    LDQ     4,,PR3
         9 006373   000033 772000                    QRL     27
         9 006374   000000 622006                    EAX2    0,QL
         9 006375   000000 635012                    EAA     0,X2
         9 006376   000022 771000                    ARL     18
         9 006377   000027 675000 xsym               ERA     B_VECTNIL+23
         9 006400   000001 035007                    ADLA    1,DL
         9 006401   000000 623006                    EAX3    0,QL
         9 006402   040045 100540                    MLR     fill='040'O
         9 006403   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         9 006404   000203 400013 1                  ADSC9   HOUR2,A                  cn=2,n=*X3

     2455    12547    6                    LENGTHC (HOUR2) -
     2456    12548    6                    (PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.COUNT),
     2457    12549    6                    ,
     2458    12550    6                    PTR$ -> OUT$BLK.SUBLK$(0) ->
     2459    12551    6                    OUT$SYM.TEXT);
     2460    12552
     2461    12553    6                  MIN2 = '00';

  12553  9 006405   000204 741000 1                  STX1    MIN2

     2462    12554    6                  CALL INSERT (MIN2,

  12554  9 006406   100004 474500                    LDP4    4,,PR1
         9 006407   400004 236100                    LDQ     4,,PR4
         9 006410   000033 772000                    QRL     27
         9 006411   000000 623006                    EAX3    0,QL
         9 006412   000000 635013                    EAA     0,X3
         9 006413   000022 771000                    ARL     18
         9 006414   000027 675000 xsym               ERA     B_VECTNIL+23
         9 006415   000001 035007                    ADLA    1,DL
         9 006416   000000 624006                    EAX4    0,QL
         9 006417   040045 100540                    MLR     fill='040'O
         9 006420   400004 200013                    ADSC9   4,,PR4                   cn=1,n=*X3
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:326  
         9 006421   000204 400014 1                  ADSC9   MIN2,A                   cn=2,n=*X4

     2463    12555    6                    LENGTHC (MIN2) -
     2464    12556    6                    (PTR$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.COUNT),
     2465    12557    6                    ,
     2466    12558    6                    PTR$ -> OUT$BLK.SUBLK$(1) ->
     2467    12559    6                    OUT$SYM.TEXT);
     2468    12560    6                  OPERATOR_ENTERED_TIME2 = %YES#;

  12560  9 006422   400000 236003                    LDQ     -131072,DU
         9 006423   000653 756000 1                  STQ     OPERATOR_ENTERED_TIME2

     2469    12561    6                  SEC2 = '59';

  12561  9 006424   000121 224000 8                  LDX4    MOP_8_DIGITS_3+80
         9 006425   000205 744000 1                  STX4    SEC2

     2470    12562    6                  CENTISEC2 = '99';

  12562  9 006426   000122 225000 8                  LDX5    MOP_8_DIGITS_3+81
         9 006427   000206 745000 1                  STX5    CENTISEC2
         9 006430   006516 710000 9                  TRA     s:12599

     2471    12563
     2472    12564    6               CASE (%CMD_DATE#);

     2473    12565    6                  MONTH2 = '00';

  12565  9 006431   000010 221000 8                  LDX1    MOP_8_DIGITS_3+7
         9 006432   000207 741000 1                  STX1    MONTH2

     2474    12566    6                  CALL INSERT (MONTH2,

  12566  9 006433   100003 473500                    LDP3    3,,PR1
         9 006434   300004 236100                    LDQ     4,,PR3
         9 006435   000033 772000                    QRL     27
         9 006436   000000 622006                    EAX2    0,QL
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:327  
         9 006437   000000 635012                    EAA     0,X2
         9 006440   000022 771000                    ARL     18
         9 006441   000027 675000 xsym               ERA     B_VECTNIL+23
         9 006442   000001 035007                    ADLA    1,DL
         9 006443   000000 623006                    EAX3    0,QL
         9 006444   040045 100540                    MLR     fill='040'O
         9 006445   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         9 006446   000207 400013 1                  ADSC9   MONTH2,A                 cn=2,n=*X3

     2475    12567    6                    LENGTHC (MONTH2) -
     2476    12568    6                    (PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.COUNT),
     2477    12569    6                    ,
     2478    12570    6                    PTR$ -> OUT$BLK.SUBLK$(0) ->
     2479    12571    6                    OUT$SYM.TEXT);
     2480    12572
     2481    12573
     2482    12574    6                  DAY2 = '00';

  12574  9 006447   000210 741000 1                  STX1    DAY2

     2483    12575    6                  CALL INSERT (DAY2,

  12575  9 006450   100004 474500                    LDP4    4,,PR1
         9 006451   400004 236100                    LDQ     4,,PR4
         9 006452   000033 772000                    QRL     27
         9 006453   000000 623006                    EAX3    0,QL
         9 006454   000000 635013                    EAA     0,X3
         9 006455   000022 771000                    ARL     18
         9 006456   000027 675000 xsym               ERA     B_VECTNIL+23
         9 006457   000001 035007                    ADLA    1,DL
         9 006460   000000 624006                    EAX4    0,QL
         9 006461   040045 100540                    MLR     fill='040'O
         9 006462   400004 200013                    ADSC9   4,,PR4                   cn=1,n=*X3
         9 006463   000210 400014 1                  ADSC9   DAY2,A                   cn=2,n=*X4

     2484    12576    6                    LENGTHC (DAY2) -
     2485    12577    6                    (PTR$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.COUNT),
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:328  
     2486    12578    6                    ,
     2487    12579    6                    PTR$ -> OUT$BLK.SUBLK$(1) ->
     2488    12580    6                    OUT$SYM.TEXT);
     2489    12581
     2490    12582    6                  YEAR2 = '00';

  12582  9 006464   000211 741000 1                  STX1    YEAR2

     2491    12583    6                  CALL INSERT (YEAR2,

  12583  9 006465   100005 475500                    LDP5    5,,PR1
         9 006466   500004 236100                    LDQ     4,,PR5
         9 006467   000033 772000                    QRL     27
         9 006470   000000 624006                    EAX4    0,QL
         9 006471   000000 635014                    EAA     0,X4
         9 006472   000022 771000                    ARL     18
         9 006473   000027 675000 xsym               ERA     B_VECTNIL+23
         9 006474   000001 035007                    ADLA    1,DL
         9 006475   000000 625006                    EAX5    0,QL
         9 006476   040045 100540                    MLR     fill='040'O
         9 006477   500004 200014                    ADSC9   4,,PR5                   cn=1,n=*X4
         9 006500   000211 400015 1                  ADSC9   YEAR2,A                  cn=2,n=*X5

     2492    12584    6                    LENGTHC (YEAR2) -
     2493    12585    6                    (PTR$ -> OUT$BLK.SUBLK$(2) -> OUT$SYM.COUNT),
     2494    12586    6                    ,
     2495    12587    6                    PTR$ -> OUT$BLK.SUBLK$(2) ->
     2496    12588    6                    OUT$SYM.TEXT);
     2497    12589    6                  OPERATOR_ENTERED_DATE2 = %YES#;

  12589  9 006501   400000 236003                    LDQ     -131072,DU
         9 006502   000654 756000 1                  STQ     OPERATOR_ENTERED_DATE2

     2498    12590    7                  IF SUBS2 = 1 THEN DO;

  12590  9 006503   000220 235000 1                  LDA     SUBS2
         9 006504   000001 115007                    CMPA    1,DL
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:329  
         9 006505   006516 601000 9                  TNZ     s:12599

     2499    12591    7                     HOUR2 = '23';

  12591  9 006506   000123 225000 8                  LDX5    MOP_8_DIGITS_3+82
         9 006507   000203 745000 1                  STX5    HOUR2

     2500    12592    7                     MIN2 = '59';

  12592  9 006510   000121 226000 8                  LDX6    MOP_8_DIGITS_3+80
         9 006511   000204 746000 1                  STX6    MIN2

     2501    12593    7                     SEC2 = '59';

  12593  9 006512   000205 746000 1                  STX6    SEC2

     2502    12594    7                     CENTISEC2 = '99';

  12594  9 006513   000122 227000 8                  LDX7    MOP_8_DIGITS_3+81
         9 006514   000206 747000 1                  STX7    CENTISEC2

     2503    12595    7                     OPERATOR_ENTERED_TIME2 = %YES#;

  12595  9 006515   000653 756000 1                  STQ     OPERATOR_ENTERED_TIME2

     2504    12596    7                  END;

     2505    12597    6               END;                        /* End case (ptr$ -> out$blk.code     */

     2506    12598
     2507    12599    5            END;                           /* End Do Loop (x=0 to (subs2-1))     */

  12599  9 006516   000217 054000 1                  AOS     X
         9 006517   000217 236000 1                  LDQ     X
         9 006520   000220 116000 1                  CMPQ    SUBS2
         9 006521   006352 604000 9                  TMI     s:12541

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:330  
     2508    12600
     2509    12601    4            CALL CHARBIN (YR,YEAR2);

  12601  9 006522   000100 305400                    DTB
         9 006523   000211 030002 1                  NDSC9   YEAR2                    cn=0,s=nosgn,sf=0,n=2
         9 006524   200014 000010                    NDSC9   IOPT+7,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         9 006525   200015 235100                    LDA     IOPT+8,,AUTO
         9 006526   000655 755000 1                  STA     YR

     2510    12602    4            CALL CHARBIN (MON,MONTH2);

  12602  9 006527   000100 305400                    DTB
         9 006530   000207 030002 1                  NDSC9   MONTH2                   cn=0,s=nosgn,sf=0,n=2
         9 006531   200014 000010                    NDSC9   IOPT+7,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         9 006532   200015 235100                    LDA     IOPT+8,,AUTO
         9 006533   000656 755000 1                  STA     MON

     2511    12603    4            CALL CHARBIN (DAY,DAY2);

  12603  9 006534   000100 305400                    DTB
         9 006535   000210 030002 1                  NDSC9   DAY2                     cn=0,s=nosgn,sf=0,n=2
         9 006536   200014 000010                    NDSC9   IOPT+7,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         9 006537   200015 235100                    LDA     IOPT+8,,AUTO
         9 006540   000657 755000 1                  STA     DAY

     2512    12604    4            CALL CHARBIN (HR,HOUR2);

  12604  9 006541   000100 305400                    DTB
         9 006542   000203 030002 1                  NDSC9   HOUR2                    cn=0,s=nosgn,sf=0,n=2
         9 006543   200014 000010                    NDSC9   IOPT+7,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         9 006544   200015 235100                    LDA     IOPT+8,,AUTO
         9 006545   000660 755000 1                  STA     HR

     2513    12605    4            CALL CHARBIN (MIN,MIN2);

  12605  9 006546   000100 305400                    DTB
         9 006547   000204 030002 1                  NDSC9   MIN2                     cn=0,s=nosgn,sf=0,n=2
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:331  
         9 006550   200014 000010                    NDSC9   IOPT+7,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         9 006551   200015 235100                    LDA     IOPT+8,,AUTO
         9 006552   000661 755000 1                  STA     MIN

     2514    12606    4            CALL TIME_VALIDATE;

  12606  9 006553   007025 701000 9                  TSX1    TIME_VALIDATE
         9 006554   000000 011000                    NOP     0

     2515    12607
     2516    12608    4         END;                         /* End case (listptr$ -> out$blk.code)     */

     2517    12609
     2518    12610    3      END;                                 /* End Do Loop (I=0 to (subs1-1))     */

  12610  9 006555   000216 054000 1                  AOS     I
         9 006556   000216 236000 1                  LDQ     I
         9 006557   000221 116000 1                  CMPQ    SUBS1
         9 006560   006127 604000 9                  TMI     s:12464

     2519    12611    2   END DO_TIME;

  12611  9 006561   200004 221300                    LDX1  ! TEMP_UTS+1,,AUTO
         9 006562   000001 702211                    TSX2  ! 1,X1

     2520    12612        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:332  
     2521    12613         /*
     2522    12614                  S U B R O U T I N E   C L O B B E R _ T I M E _ D E F A U L T S
     2523    12615                                                */
     2524    12616
     2525    12617                                                /* This routine is called after
     2526    12618                                                     new time settings are entered
     2527    12619                                                     & placed in the time variables
     2528    12620                                                     by the "Do_time" routine. This
     2529    12621                                                     routine takes these new values
     2530    12622                                                     along with those unchanged,
     2531    12623                                                     (defaults), and recomputes
     2532    12624                                                     the beginning and ending time
     2533    12625                                                     UTS.                             */
     2534    12626
     2535    12627    1   CLOBBER_TIME_DEFAULTS: PROC;

  12627  9 006563   200004 741300       CLOBBER_TIM* STX1  ! TEMP_UTS+1,,AUTO

     2536    12628    2      CALL CONCAT (FPT_DATE,

  12628  9 006564   000202 220000 1                  LDX0    YEAR1
         9 006565   000311 740000 1                  STX0    FPT_DATE
         9 006566   000200 222000 1                  LDX2    MONTH1
         9 006567   000311 442000 1                  SXL2    FPT_DATE
         9 006570   000201 223000 1                  LDX3    DAY1
         9 006571   000312 743000 1                  STX3    FPT_DATE+1

     2537    12629    2        YEAR1,
     2538    12630    2        MONTH1,
     2539    12631    2        DAY1);
     2540    12632
     2541    12633    2      CALL CONCAT (FPT_TIME,

  12633  9 006572   000174 220000 1                  LDX0    HOUR1
         9 006573   000313 740000 1                  STX0    FPT_TIME
         9 006574   000175 221000 1                  LDX1    MIN1
         9 006575   000313 441000 1                  SXL1    FPT_TIME
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:333  
         9 006576   000176 222000 1                  LDX2    SEC1
         9 006577   000314 742000 1                  STX2    FPT_TIME+1
         9 006600   000177 223000 1                  LDX3    CENTISEC1
         9 006601   000314 443000 1                  SXL3    FPT_TIME+1

     2542    12634    2        HOUR1,
     2543    12635    2        MIN1,
     2544    12636    2        SEC1,
     2545    12637    2        CENTISEC1);
     2546    12638
     2547    12639    2      CALL M$TIME (TIME_CONV) ALTRET (CANT_CALL_TIME_CONV);

  12639  9 006602   002156 630400 1                  EPPR0   TIME_CONV
         9 006603   420004 713400                    CLIMB   alt,+8196
         9 006604   402000 401760                    pmme    nvectors=5
         9 006605   006711 702000 9                  TSX2    CANT_CALL_TIME_CONV

     2548    12640
     2549    12641    2      BEGINNING_TIME = UTSTAMP;

  12641  9 006606   000310 235000 1                  LDA     UTSTAMP
         9 006607   000300 755000 1                  STA     BEGINNING_TIME

     2550    12642
     2551    12643    2      RANGE_CONV.TSTAMP_ = VECTOR (BEGINNING_TIME);

  12643  9 006610   000034 237000 10                 LDAQ    28
         9 006611   003044 757000 1                  STAQ    RANGE_CONV+8

     2552    12644    2      CALL M$TIME (RANGE_CONV) ALTRET (CANT_CALL_RANGE_CONV);

  12644  9 006612   003034 630400 1                  EPPR0   RANGE_CONV
         9 006613   420004 713400                    CLIMB   alt,+8196
         9 006614   402000 401760                    pmme    nvectors=5
         9 006615   006756 702000 9                  TSX2    CANT_CALL_RANGE_CONV

     2553    12645    2      TIME_BUFFER = ' ';
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:334  

  12645  9 006616   040000 100400                    MLR     fill='040'O
         9 006617   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 006620   000627 000110 1                  ADSC9   TIME_BUFFER              cn=0,n=72

     2554    12646    2      CALL INSERT (TIME_BUFFER,

  12646  9 006621   040000 100400                    MLR     fill='040'O
         9 006622   000124 000026 8                  ADSC9   MOP_8_DIGITS_3+83        cn=0,n=22
         9 006623   000627 000026 1                  ADSC9   TIME_BUFFER              cn=0,n=22
         9 006624   040000 100400                    MLR     fill='040'O
         9 006625   000417 000013 1                  ADSC9   SIM_TIME                 cn=0,n=11
         9 006626   000634 400013 1                  ADSC9   TIME_BUFFER+5            cn=2,n=11
         9 006627   000040 236003                    LDQ     32,DU
         9 006630   000637 552020 1                  STBQ    TIME_BUFFER+8,'20'O
         9 006631   040000 100400                    MLR     fill='040'O
         9 006632   000415 000010 1                  ADSC9   SIM_DATE                 cn=0,n=8
         9 006633   000637 400010 1                  ADSC9   TIME_BUFFER+8            cn=2,n=8

     2555    12647    2        0,
     2556    12648    2        42,
     2557    12649    2        'Current time range is ',
     2558    12650    2        SIM_TIME,
     2559    12651    2        ' ',
     2560    12652    2        SIM_DATE);
     2561    12653
     2562    12654    2      CALL CONCAT (FPT_DATE,

  12654  9 006634   000211 220000 1                  LDX0    YEAR2
         9 006635   000311 740000 1                  STX0    FPT_DATE
         9 006636   000207 221000 1                  LDX1    MONTH2
         9 006637   000311 441000 1                  SXL1    FPT_DATE
         9 006640   000210 222000 1                  LDX2    DAY2
         9 006641   000312 742000 1                  STX2    FPT_DATE+1

     2563    12655    2        YEAR2,
     2564    12656    2        MONTH2,
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:335  
     2565    12657    2        DAY2);
     2566    12658
     2567    12659    2      CALL CONCAT (FPT_TIME,

  12659  9 006642   000203 220000 1                  LDX0    HOUR2
         9 006643   000313 740000 1                  STX0    FPT_TIME
         9 006644   000204 221000 1                  LDX1    MIN2
         9 006645   000313 441000 1                  SXL1    FPT_TIME
         9 006646   000205 222000 1                  LDX2    SEC2
         9 006647   000314 742000 1                  STX2    FPT_TIME+1
         9 006650   000206 223000 1                  LDX3    CENTISEC2
         9 006651   000314 443000 1                  SXL3    FPT_TIME+1

     2568    12660    2        HOUR2,
     2569    12661    2        MIN2,
     2570    12662    2        SEC2,
     2571    12663    2        CENTISEC2);
     2572    12664
     2573    12665    2      CALL M$TIME (TIME_CONV) ALTRET (CANT_CALL_TIME_CONV);

  12665  9 006652   002156 630400 1                  EPPR0   TIME_CONV
         9 006653   420004 713400                    CLIMB   alt,+8196
         9 006654   402000 401760                    pmme    nvectors=5
         9 006655   006711 702000 9                  TSX2    CANT_CALL_TIME_CONV

     2574    12666    2      ENDING_TIME = UTSTAMP;

  12666  9 006656   000310 235000 1                  LDA     UTSTAMP
         9 006657   000301 755000 1                  STA     ENDING_TIME

     2575    12667
     2576    12668    2      RANGE_CONV.TSTAMP_ = VECTOR (ENDING_TIME);

  12668  9 006660   000036 237000 10                 LDAQ    30
         9 006661   003044 757000 1                  STAQ    RANGE_CONV+8

     2577    12669    2      CALL M$TIME (RANGE_CONV) ALTRET (CANT_CALL_RANGE_CONV);
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:336  

  12669  9 006662   003034 630400 1                  EPPR0   RANGE_CONV
         9 006663   420004 713400                    CLIMB   alt,+8196
         9 006664   402000 401760                    pmme    nvectors=5
         9 006665   006756 702000 9                  TSX2    CANT_CALL_RANGE_CONV

     2578    12670    2      CALL INSERT (TIME_BUFFER,

  12670  9 006666   040000 100400                    MLR     fill='040'O
         9 006667   000132 000005 8                  ADSC9   MOP_8_DIGITS_3+89        cn=0,n=5
         9 006670   000641 600005 1                  ADSC9   TIME_BUFFER+10           cn=3,n=5
         9 006671   040000 100400                    MLR     fill='040'O
         9 006672   000417 000013 1                  ADSC9   SIM_TIME                 cn=0,n=11
         9 006673   000643 000013 1                  ADSC9   TIME_BUFFER+12           cn=0,n=11
         9 006674   000040 236007                    LDQ     32,DL
         9 006675   000645 552004 1                  STBQ    TIME_BUFFER+14,'04'O
         9 006676   040000 100400                    MLR     fill='040'O
         9 006677   000415 000010 1                  ADSC9   SIM_DATE                 cn=0,n=8
         9 006700   000646 000010 1                  ADSC9   TIME_BUFFER+15           cn=0,n=8

     2579    12671    2        43,
     2580    12672    2        25,
     2581    12673    2        ' to  ',
     2582    12674    2        SIM_TIME,
     2583    12675    2        ' ',
     2584    12676    2        SIM_DATE);
     2585    12677
     2586    12678    2      WRITE_TIME.BUF_.BOUND = 68;

  12678  9 006701   002226 236000 1                  LDQ     WRITE_TIME+4
         9 006702   177777 376007                    ANQ     65535,DL
         9 006703   000021 276003                    ORQ     17,DU
         9 006704   002226 756000 1                  STQ     WRITE_TIME+4

     2587    12679    2      CALL M$WRITE (WRITE_TIME);

  12679  9 006705   002222 630400 1                  EPPR0   WRITE_TIME
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:337  
         9 006706   040001 713400                    CLIMB   write
         9 006707   401400 401760                    pmme    nvectors=4

     2588    12680
     2589    12681
     2590    12682    3      DO WHILE ('0'B);

  12682  9 006710   007023 710000 9                  TRA     s:12708

  12679  9 006711                       CANT_CALL_T* null
     2591    12683    3   CANT_CALL_TIME_CONV:;
     2592    12684        /*E* ERROR: ORR-E_CALLTIMECONV#-7
     2593    12685             MESSAGE: Altret condition occurred on call to M$TIME
     2594    12686             The call was to convert ANS to UTS.
     2595    12687                                 */
     2596    12688    3         MODULE_ERR.ERR# = 9 /* E_CALLTIMECONV# */;

  12688  9 006711   001670 236000 1                  LDQ     MODULE_ERR
         9 006712   000001 376000 10                 ANQ     1
         9 006713   000110 276007                    ORQ     72,DL
         9 006714   001670 756000 1                  STQ     MODULE_ERR

     2597    12689    3         MODULE_ERR.SEV = 0;

  12689  9 006715   000002 236000 10                 LDQ     2
         9 006716   001670 356000 1                  ANSQ    MODULE_ERR

     2598    12690    3         CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  12690  9 006717   000000 236007 xsym               LDQ     M$LO,DL
         9 006720   200014 756100                    STQ     IOPT+7,,AUTO
         9 006721   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 006722   200017 450500                    STP0    IOPT+10,,AUTO
         9 006723   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 006724   200016 756100                    STQ     IOPT+9,,AUTO
         9 006725   000003 236000 10                 LDQ     3
         9 006726   200015 756100                    STQ     IOPT+8,,AUTO
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:338  
         9 006727   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 006730   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 006731   000000 701000 xent               TSX1    XUR$ERRMSG
         9 006732   000000 011000                    NOP     0

     2599    12691    3         ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  12691  9 006733   000000 470400 xsym               LDP0    B$TCB$
         9 006734   000000 471500                    LDP1    0,,PR0
         9 006735   100102 236100                    LDQ     66,,PR1
         9 006736   001125 756000 1                  STQ     ERROR

     2600    12692    3         CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));

  12692  9 006737   000000 236007 xsym               LDQ     M$LO,DL
         9 006740   200014 756100                    STQ     IOPT+7,,AUTO
         9 006741   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 006742   200017 451500                    STP1    IOPT+10,,AUTO
         9 006743   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 006744   200016 756100                    STQ     IOPT+9,,AUTO
         9 006745   000030 236000 10                 LDQ     24
         9 006746   200015 756100                    STQ     IOPT+8,,AUTO
         9 006747   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 006750   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 006751   000000 701000 xent               TSX1    XUR$ERRMSG
         9 006752   000000 011000                    NOP     0

     2601    12693    3         CALL ORR$XCONRTN;

  12693  9 006753   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 006754   000000 701000 xent               TSX1    ORR$XCONRTN
         9 006755   000000 011000                    NOP     0

  12691  9 006756                       CANT_CALL_R* null
     2602    12694
     2603    12695    3   CANT_CALL_RANGE_CONV:;
     2604    12696        /*E* ERROR: ORR-E_CALLTIMERANG#-7
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:339  
     2605    12697             MESSAGE: Altret occurred on call to M$TIME
     2606    12698                      converting UTS to local
     2607    12699                                 */
     2608    12700    3         MODULE_ERR.ERR# = 33 /* E_CALLTIMERANG */;

  12700  9 006756   001670 236000 1                  LDQ     MODULE_ERR
         9 006757   000001 376000 10                 ANQ     1
         9 006760   000410 276007                    ORQ     264,DL
         9 006761   001670 756000 1                  STQ     MODULE_ERR

     2609    12701    3         MODULE_ERR.SEV = 0;

  12701  9 006762   000002 236000 10                 LDQ     2
         9 006763   001670 356000 1                  ANSQ    MODULE_ERR

     2610    12702    3         CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  12702  9 006764   000000 236007 xsym               LDQ     M$LO,DL
         9 006765   200014 756100                    STQ     IOPT+7,,AUTO
         9 006766   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 006767   200017 450500                    STP0    IOPT+10,,AUTO
         9 006770   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 006771   200016 756100                    STQ     IOPT+9,,AUTO
         9 006772   000003 236000 10                 LDQ     3
         9 006773   200015 756100                    STQ     IOPT+8,,AUTO
         9 006774   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 006775   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 006776   000000 701000 xent               TSX1    XUR$ERRMSG
         9 006777   000000 011000                    NOP     0

     2611    12703    3         ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  12703  9 007000   000000 470400 xsym               LDP0    B$TCB$
         9 007001   000000 471500                    LDP1    0,,PR0
         9 007002   100102 236100                    LDQ     66,,PR1
         9 007003   001125 756000 1                  STQ     ERROR

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:340  
     2612    12704    3         CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));

  12704  9 007004   000000 236007 xsym               LDQ     M$LO,DL
         9 007005   200014 756100                    STQ     IOPT+7,,AUTO
         9 007006   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 007007   200017 451500                    STP1    IOPT+10,,AUTO
         9 007010   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 007011   200016 756100                    STQ     IOPT+9,,AUTO
         9 007012   000030 236000 10                 LDQ     24
         9 007013   200015 756100                    STQ     IOPT+8,,AUTO
         9 007014   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 007015   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 007016   000000 701000 xent               TSX1    XUR$ERRMSG
         9 007017   000000 011000                    NOP     0

     2613    12705    3         CALL ORR$XCONRTN;

  12705  9 007020   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 007021   000000 701000 xent               TSX1    ORR$XCONRTN
         9 007022   000000 011000                    NOP     0

     2614    12706    3      END;

     2615    12707
     2616    12708    2   END CLOBBER_TIME_DEFAULTS;

  12708  9 007023   200004 221300                    LDX1  ! TEMP_UTS+1,,AUTO
         9 007024   000001 702211                    TSX2  ! 1,X1

     2617    12709
     2618    12710        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:341  
     2619    12711         /*
     2620    12712                  S U B R O U T I N E   T I M E _ V A L I D A T E
     2621    12713                                                */
     2622    12714
     2623    12715    1   TIME_VALIDATE: PROC;

  12715  9 007025   200006 741300       TIME_VALIDA* STX1  ! IOPT+1,,AUTO

     2624    12716
     2625    12717    2   DCL LEAP UBIN WORD STATIC;
     2626    12718    2   DCL LEAP_VAR UBIN WORD STATIC;
     2627    12719    2   DCL CUR_YR UBIN WORD STATIC;
     2628    12720    2   DCL TEMP_YR UBIN WORD STATIC;
     2629    12721    2   DCL DAY_LIST (0:11) UBIN WORD STATIC ALIGNED INIT
     2630    12722    2    (31, /* JAN                                */
     2631    12723    2    28, /* FEB                                */
     2632    12724    2    31, /* MAR                                */
     2633    12725    2    30, /* APR                                */
     2634    12726    2    31, /* MAY                                */
     2635    12727    2    30, /* JUN                                */
     2636    12728    2    31, /* JUL                                */
     2637    12729    2    31, /* AUG                                */
     2638    12730    2    30, /* SEP                                */
     2639    12731    2    31, /* OCT                                */
     2640    12732    2    30, /* NOV                                */
     2641    12733    2    31);                                   /* DEC                                */
     2642    12734        /* BEGIN SUB-PROGRAM */
     2643    12735
     2644    12736    2      IF MOD(YR,4) = 0

  12736  9 007026   000655 236000 1                  LDQ     YR
         9 007027   000003 376007                    ANQ     3,DL
         9 007030   007034 601000 9                  TNZ     s:12738

     2645    12737    2      THEN LEAP = 1;

  12737  9 007031   000001 235007                    LDA     1,DL
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:342  
         9 007032   003066 755000 1                  STA     LEAP
         9 007033   007035 710000 9                  TRA     s:12740

     2646    12738    2      ELSE LEAP = 0;

  12738  9 007034   003066 450000 1                  STZ     LEAP

     2647    12739
     2648    12740    2      IF (LEAP = 1 AND MON = 2)

  12740  9 007035   003066 235000 1                  LDA     LEAP
         9 007036   000001 115007                    CMPA    1,DL
         9 007037   007046 601000 9                  TNZ     s:12742
         9 007040   000656 236000 1                  LDQ     MON
         9 007041   000002 116007                    CMPQ    2,DL
         9 007042   007046 601000 9                  TNZ     s:12742

     2649    12741    2      THEN LEAP_VAR = 1;

  12741  9 007043   000001 235007                    LDA     1,DL
         9 007044   003067 755000 1                  STA     LEAP_VAR
         9 007045   007047 710000 9                  TRA     s:12744

     2650    12742    2      ELSE LEAP_VAR = 0;

  12742  9 007046   003067 450000 1                  STZ     LEAP_VAR

     2651    12743
     2652    12744    2      TIME_SET.V.SOURCE# = %CLOCK#;

  12744  9 007047   000000 236003                    LDQ     0,DU
         9 007050   002204 552040 1                  STBQ    TIME_SET+10,'40'O

     2653    12745    3      CALL M$TIME (TIME_SET) WHENALTRETURN DO; END;

  12745  9 007051   002172 630400 1                  EPPR0   TIME_SET
         9 007052   420004 713400                    CLIMB   alt,+8196
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:343  
         9 007053   402000 401760                    pmme    nvectors=5
         9 007054   007056 702000 9                  TSX2    s:12747
         9 007055   007056 710000 9                  TRA     s:12747

     2654    12746
     2655    12747    2      TIME_SET.V.SOURCE# = %UTS#;

  12747  9 007056   004000 236003                    LDQ     2048,DU
         9 007057   002204 552040 1                  STBQ    TIME_SET+10,'40'O

     2656    12748    2      CALL CHARBIN (CUR_YR,DATE_BUF(0));   /* DATE_BUF(0) IS THE

  12748  9 007060   000100 305400                    DTB
         9 007061   000302 030002 1                  NDSC9   DATE_BUF                 cn=0,s=nosgn,sf=0,n=2
         9 007062   200014 000010                    NDSC9   IOPT+7,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         9 007063   200015 235100                    LDA     IOPT+8,,AUTO
         9 007064   003070 755000 1                  STA     CUR_YR

     2657    12749                                                CURRENT YEAR FROM THE CALL TO
     2658    12750                                                M$TIME IN THE ROUTINE
     2659    12751                                                "INITIALIZE.                          */
     2660    12752
     2661    12753    2      IF (CUR_YR <=20) THEN

  12753  9 007065   000025 115007                    CMPA    21,DL
         9 007066   007072 603000 9                  TRC     s:12755

     2662    12754    2      CUR_YR = CUR_YR + 2000;

  12754  9 007067   003720 035007                    ADLA    2000,DL
         9 007070   003070 755000 1                  STA     CUR_YR
         9 007071   007074 710000 9                  TRA     s:12758

     2663    12755    2      ELSE CUR_YR = CUR_YR + 1900;         /* THIS ISN'T REALLY NECESSARY, BUT   */

  12755  9 007072   003554 035007                    ADLA    1900,DL
         9 007073   003070 755000 1                  STA     CUR_YR
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:344  

     2664    12756                                                /* IT MAKES IT CLEARER WHAT'S GOING   */
     2665    12757                                                /* ON.                                */
     2666    12758    3      IF MON > 0 THEN DO;

  12758  9 007074   000656 235000 1                  LDA     MON
         9 007075   007102 600000 9                  TZE     s:12762

     2667    12759    3         IF (DAY > (DAY_LIST (MON - 1) + LEAP_VAR)) THEN GOTO BAD_DATE;

  12759  9 007076   003071 236005 1                  LDQ     TEMP_YR,AL
         9 007077   003067 036000 1                  ADLQ    LEAP_VAR
         9 007100   000657 116000 1                  CMPQ    DAY
         9 007101   007126 602000 9                  TNC     BAD_DATE

     2668    12760    3      END;

     2669    12761
     2670    12762    2      IF (YR <=20) THEN

  12762  9 007102   000655 235000 1                  LDA     YR
         9 007103   000025 115007                    CMPA    21,DL
         9 007104   007110 603000 9                  TRC     s:12764

     2671    12763    2      TEMP_YR = YR+2000;

  12763  9 007105   003720 035007                    ADLA    2000,DL
         9 007106   003071 755000 1                  STA     TEMP_YR
         9 007107   007112 710000 9                  TRA     s:12765

     2672    12764    2      ELSE TEMP_YR = YR+1900;              /* ADJUST YEAR FOR THE Y2K BOUNDARY   */

  12764  9 007110   003554 035007                    ADLA    1900,DL
         9 007111   003071 755000 1                  STA     TEMP_YR

     2673    12765    2      IF ((MON > 12)

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:345  
  12765  9 007112   000656 236000 1                  LDQ     MON
         9 007113   000015 116007                    CMPQ    13,DL
         9 007114   007126 603000 9                  TRC     BAD_DATE
         9 007115   000660 235000 1                  LDA     HR
         9 007116   000030 115007                    CMPA    24,DL
         9 007117   007126 603000 9                  TRC     BAD_DATE
         9 007120   000661 235000 1                  LDA     MIN
         9 007121   000074 115007                    CMPA    60,DL
         9 007122   007126 603000 9                  TRC     BAD_DATE
         9 007123   003070 236000 1                  LDQ     CUR_YR
         9 007124   003071 116000 1                  CMPQ    TEMP_YR
         9 007125   007150 603000 9                  TRC     s:12777

     2674    12766    2        OR (HR > 23)
     2675    12767    2        OR (MIN > 59)
     2676    12768    2        OR (TEMP_YR > CUR_YR)) THEN
     2677    12769    3   BAD_DATE: DO;

  12769  9 007126                       BAD_DATE     null
     2678    12770         /*E* ERROR: ORR-E_BADTIME#-0
     2679    12771                  MESSAGE: You have entered an invalid time or date
     2680    12772                                                */
     2681    12773    3         MODULE_ERR.ERR# = 16 /* E_BADTIME# */;

  12773  9 007126   001670 236000 1                  LDQ     MODULE_ERR
         9 007127   000001 376000 10                 ANQ     1
         9 007130   000200 276007                    ORQ     128,DL
         9 007131   001670 756000 1                  STQ     MODULE_ERR

     2682    12774    3         MODULE_ERR.SEV = 0;

  12774  9 007132   000002 236000 10                 LDQ     2
         9 007133   001670 356000 1                  ANSQ    MODULE_ERR

     2683    12775    3         CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  12775  9 007134   000000 236007 xsym               LDQ     M$LO,DL
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:346  
         9 007135   200014 756100                    STQ     IOPT+7,,AUTO
         9 007136   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 007137   200017 450500                    STP0    IOPT+10,,AUTO
         9 007140   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 007141   200016 756100                    STQ     IOPT+9,,AUTO
         9 007142   000003 236000 10                 LDQ     3
         9 007143   200015 756100                    STQ     IOPT+8,,AUTO
         9 007144   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 007145   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 007146   000000 701000 xent               TSX1    XUR$ERRMSG
         9 007147   000000 011000                    NOP     0

     2684    12776    3      END;

     2685    12777    2   END TIME_VALIDATE;

  12777  9 007150   200006 221300                    LDX1  ! IOPT+1,,AUTO
         9 007151   000001 702211                    TSX2  ! 1,X1

     2686    12778
     2687    12779
     2688    12780        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:347  
     2689    12781         /*
     2690    12782                  S U B R O U T I N E   O P E N _ T O _ R A N G E
     2691    12783                                                */
     2692    12784
     2693    12785    1   OPEN_TO_RANGE: PROC;

  12785  9 007152   200004 741300       OPEN_TO_RAN* STX1  ! TEMP_UTS+1,,AUTO

     2694    12786    2      CALL M$GDS (STACK_SEG) ALTRET (CANT_CALL_GDS);

  12786  9 007153   002036 630400 1                  EPPR0   STACK_SEG
         9 007154   430001 713400                    CLIMB   alt,gds
         9 007155   400400 401760                    pmme    nvectors=2
         9 007156   007333 702000 9                  TSX2    CANT_CALL_GDS

     2695    12787
     2696    12788                                                /* Allocate segment for ":OCHIST"
     2697    12789                                                     on stack.                        */
     2698    12790
     2699    12791    2      GDS_RESULTS_VEC.PTR$ -> PREV_STACK (STK_INDEX) = FID_NAME;

  12791  9 007157   000662 235000 1                  LDA     STK_INDEX
         9 007160   000005 735000                    ALS     5
         9 007161   002045 470400 1                  LDP0    GDS_RESULTS_VEC+1
         9 007162   000105 100400                    MLR     fill='000'O
         9 007163   001400 000040 1                  ADSC9   FID_NAME                 cn=0,n=32
         9 007164   000000 000040                    ADSC9   0,A,PR0                  cn=0,n=32

     2700    12792    2      CALL OPEN_SPECIFIC_FILE;

  12792  9 007165   003713 701000 9                  TSX1    OPEN_SPECIFIC_FILE
         9 007166   000000 011000                    NOP     0

  12791  9 007167                       FIND_RANGE   null
     2701    12793
     2702    12794    2   FIND_RANGE:;
     2703    12795    2      CALL M$READ (READ_STATUS) ALTRET (CANT_READ_STATUS);
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:348  

  12795  9 007167   002020 630400 1                  EPPR0   READ_STATUS
         9 007170   440000 713400                    CLIMB   alt,read
         9 007171   401400 401760                    pmme    nvectors=4
         9 007172   007400 702000 9                  TSX2    CANT_READ_STATUS

     2704    12796    2      CALL M$READ (READ_CONSOLE_REC) ALTRET (CANT_READ_HIST);

  12796  9 007173   002002 630400 1                  EPPR0   READ_CONSOLE_REC
         9 007174   440000 713400                    CLIMB   alt,read
         9 007175   401400 401760                    pmme    nvectors=4
         9 007176   007451 702000 9                  TSX2    CANT_READ_HIST

     2705    12797
     2706    12798    3      IF OCL_CONSOLE_REC.UTS > BEGINNING_TIME THEN DO;

  12798  9 007177   000300 236000 1                  LDQ     BEGINNING_TIME
         9 007200   000011 116000 xsym               CMPQ    OCL_CONSOLE_REC+9
         9 007201   007300 603000 9                  TRC     PROCESS

     2707    12799
     2708    12800                                                /* If beginning time preceeds the
     2709    12801                                                     earliest time on this file
     2710    12802                                                     then do the following.           */
     2711    12803
     2712    12804    3         PREV.TXT = ' ';

  12804  9 007202   040000 100400                    MLR     fill='040'O
         9 007203   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 007204   001141 200037 1                  ADSC9   PREV                     cn=1,n=31

     2713    12805    3         PREV = OCL_STATUS_REC.PREV_FILE;

  12805  9 007205   000000 100400                    MLR     fill='000'O
         9 007206   000003 000040 xsym               ADSC9   OCL_STATUS_REC+3         cn=0,n=32
         9 007207   001141 000040 1                  ADSC9   PREV                     cn=0,n=32

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:349  
     2714    12806
     2715    12807                                                /* Get previous filename from
     2716    12808                                                     status record.                   */
     2717    12809
     2718    12810
     2719    12811    3         CALL M$GDS (STACK_SEG) ALTRET (CANT_CALL_GDS);

  12811  9 007210   002036 630400 1                  EPPR0   STACK_SEG
         9 007211   430001 713400                    CLIMB   alt,gds
         9 007212   400400 401760                    pmme    nvectors=2
         9 007213   007333 702000 9                  TSX2    CANT_CALL_GDS

     2720    12812    3         STK_INDEX = STK_INDEX+1;

  12812  9 007214   000662 054000 1                  AOS     STK_INDEX

     2721    12813    3         GDS_RESULTS_VEC.PTR$ -> PREV_STACK (STK_INDEX) = PREV;

  12813  9 007215   000662 235000 1                  LDA     STK_INDEX
         9 007216   000005 735000                    ALS     5
         9 007217   002045 470400 1                  LDP0    GDS_RESULTS_VEC+1
         9 007220   000105 100400                    MLR     fill='000'O
         9 007221   001141 000040 1                  ADSC9   PREV                     cn=0,n=32
         9 007222   000000 000040                    ADSC9   0,A,PR0                  cn=0,n=32

     2722    12814
     2723    12815                                                /* Place previous filename on
     2724    12816                                                     top of stack.                    */
     2725    12817
     2726    12818    3         FID_NAME = GDS_RESULTS_VEC.PTR$ -> PREV_STACK(STK_INDEX-1);

  12818  9 007223   002045 470400 1                  LDP0    GDS_RESULTS_VEC+1
         9 007224   000000 100505                    MLR     fill='000'O
         9 007225   077770 000040                    ADSC9   -8,A,PR0                 cn=0,n=32
         9 007226   001400 000040 1                  ADSC9   FID_NAME                 cn=0,n=32

     2727    12819    3         CALL CLOSE_SPECIFIC_FILE;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:350  

  12819  9 007227   004454 701000 9                  TSX1    CLOSE_SPECIFIC_FILE
         9 007230   000000 011000                    NOP     0

     2728    12820
     2729    12821    3         IF GDS_RESULTS_VEC.PTR$ -> PREV_STACK.COUNT (STK_INDEX) = 0 THEN GOTO
             12821                  NO_MORE_HISTORY;

  12821  9 007231   000662 235000 1                  LDA     STK_INDEX
         9 007232   000005 735000                    ALS     5
         9 007233   002045 470400 1                  LDP0    GDS_RESULTS_VEC+1
         9 007234   000100 101505                    MRL     fill='000'O
         9 007235   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         9 007236   200014 000004                    ADSC9   IOPT+7,,AUTO             cn=0,n=4
         9 007237   200014 236100                    LDQ     IOPT+7,,AUTO
         9 007240   000000 116003                    CMPQ    0,DU
         9 007241   007310 600000 9                  TZE     NO_MORE_HISTORY

     2730    12822    4         ELSE DO;

     2731    12823    4            FID_NAME = GDS_RESULTS_VEC.PTR$ -> PREV_STACK (STK_INDEX);

  12823  9 007242   000000 100505                    MLR     fill='000'O
         9 007243   000000 000040                    ADSC9   0,A,PR0                  cn=0,n=32
         9 007244   001400 000040 1                  ADSC9   FID_NAME                 cn=0,n=32

     2732    12824    4            CALL OPEN_SPECIFIC_FILE;

  12824  9 007245   003713 701000 9                  TSX1    OPEN_SPECIFIC_FILE
         9 007246   000000 011000                    NOP     0

     2733    12825    5            IF NO_FILE THEN DO;

  12825  9 007247   000752 234000 1                  SZN     NO_FILE
         9 007250   007277 605000 9                  TPL     s:12836

     2734    12826    5   NO_FILE:
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:351  
     2735    12827    5               STK_INDEX = STK_INDEX - 1;

  12827  9 007251   000001 336007       NO_FILE      LCQ     1,DL
         9 007252   000662 056000 1                  ASQ     STK_INDEX

     2736    12828    5               FID_NAME = GDS_RESULTS_VEC.PTR$->PREV_STACK (STK_INDEX);

  12828  9 007253   000662 235000 1                  LDA     STK_INDEX
         9 007254   000005 735000                    ALS     5
         9 007255   002045 470400 1                  LDP0    GDS_RESULTS_VEC+1
         9 007256   000000 100505                    MLR     fill='000'O
         9 007257   000000 000040                    ADSC9   0,A,PR0                  cn=0,n=32
         9 007260   001400 000040 1                  ADSC9   FID_NAME                 cn=0,n=32

     2737    12829    5               CALL OPEN_SPECIFIC_FILE;

  12829  9 007261   003713 701000 9                  TSX1    OPEN_SPECIFIC_FILE
         9 007262   000000 011000                    NOP     0

     2738    12830    5               CALL M$READ (READ_STATUS) ALTRET (CANT_READ_STATUS);

  12830  9 007263   002020 630400 1                  EPPR0   READ_STATUS
         9 007264   440000 713400                    CLIMB   alt,read
         9 007265   401400 401760                    pmme    nvectors=4
         9 007266   007400 702000 9                  TSX2    CANT_READ_STATUS

     2739    12831    5               CALL M$READ (READ_CONSOLE_REC) ALTRET (CANT_READ_HIST);

  12831  9 007267   002002 630400 1                  EPPR0   READ_CONSOLE_REC
         9 007270   440000 713400                    CLIMB   alt,read
         9 007271   401400 401760                    pmme    nvectors=4
         9 007272   007451 702000 9                  TSX2    CANT_READ_HIST

     2740    12832    5               ERROR.ERR# = 0;

  12832  9 007273   000001 236000 10                 LDQ     1
         9 007274   001125 356000 1                  ANSQ    ERROR
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:352  

     2741    12833    5               NO_FILE = %NO#;

  12833  9 007275   000752 450000 1                  STZ     NO_FILE

     2742    12834    5               GOTO PROCESS;

  12834  9 007276   007300 710000 9                  TRA     PROCESS

     2743    12835    5            END;
     2744    12836    4            GOTO FIND_RANGE;

  12836  9 007277   007167 710000 9                  TRA     FIND_RANGE

     2745    12837    4         END;
     2746    12838
     2747    12839    3      END; /*  UTS > BEGINNING_TIME  */
     2748    12840
     2749    12841    2      ELSE
     2750    12842    2   PROCESS:
     2751    12843    3      DO;

  12843  9 007300                       PROCESS      null
     2752    12844    3         FIRST_HIST_REC.V.N# = -1;

  12844  9 007300   000001 335007                    LCA     1,DL
         9 007301   002423 755000 1                  STA     FIRST_HIST_REC+7

     2753    12845    3         CALL M$PRECORD (FIRST_HIST_REC) ALTRET (CANT_PRECORD);

  12845  9 007302   002414 630400 1                  EPPR0   FIRST_HIST_REC
         9 007303   440003 713400                    CLIMB   alt,+16387
         9 007304   401000 401760                    pmme    nvectors=3
         9 007305   007522 702000 9                  TSX2    CANT_PRECORD

     2754    12846
     2755    12847                                                /* Reset file to first history
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:353  
     2756    12848                                                     record because it was read
     2757    12849                                                                              above.  */
     2758    12850
     2759    12851    3         RETURN;

  12851  9 007306   200004 221300                    LDX1  ! TEMP_UTS+1,,AUTO
         9 007307   000001 702211                    TSX2  ! 1,X1

  12833  9 007310                       NO_MORE_HIS* null
     2760    12852    3      END;
     2761    12853
     2762    12854
     2763    12855
     2764    12856    2   NO_MORE_HISTORY:;
     2765    12857        /*E* ERROR: ORR-E_OUTOFHIST#-7
     2766    12858             MESSAGE: Range was entered that is beyond
     2767    12859                      beginning of history file.
     2768    12860                                 */
     2769    12861    2      MODULE_ERR.ERR# = 19 /* E_OUTOFHIST# */;

  12861  9 007310   001670 236000 1                  LDQ     MODULE_ERR
         9 007311   000001 376000 10                 ANQ     1
         9 007312   000230 276007                    ORQ     152,DL
         9 007313   001670 756000 1                  STQ     MODULE_ERR

     2770    12862    2      MODULE_ERR.SEV = 0;

  12862  9 007314   000002 236000 10                 LDQ     2
         9 007315   001670 356000 1                  ANSQ    MODULE_ERR

     2771    12863    2      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  12863  9 007316   000000 236007 xsym               LDQ     M$LO,DL
         9 007317   200014 756100                    STQ     IOPT+7,,AUTO
         9 007320   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 007321   200017 451500                    STP1    IOPT+10,,AUTO
         9 007322   000001 236000 xsym               LDQ     B_VECTNIL+1
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:354  
         9 007323   200016 756100                    STQ     IOPT+9,,AUTO
         9 007324   000003 236000 10                 LDQ     3
         9 007325   200015 756100                    STQ     IOPT+8,,AUTO
         9 007326   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 007327   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 007330   000000 701000 xent               TSX1    XUR$ERRMSG
         9 007331   000000 011000                    NOP     0

     2772    12864    2      GOTO NO_FILE;

  12864  9 007332   007251 710000 9                  TRA     NO_FILE

  12862  9 007333                       CANT_CALL_G* null
     2773    12865
     2774    12866
     2775    12867    2   CANT_CALL_GDS:;
     2776    12868    2      MODULE_ERR.ERR# = 36 /* E_NOSEGS# */;

  12868  9 007333   001670 236000 1                  LDQ     MODULE_ERR
         9 007334   000001 376000 10                 ANQ     1
         9 007335   000440 276007                    ORQ     288,DL
         9 007336   001670 756000 1                  STQ     MODULE_ERR

     2777    12869    2      MODULE_ERR.SEV = 0;

  12869  9 007337   000002 236000 10                 LDQ     2
         9 007340   001670 356000 1                  ANSQ    MODULE_ERR

     2778    12870    2      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  12870  9 007341   000000 236007 xsym               LDQ     M$LO,DL
         9 007342   200014 756100                    STQ     IOPT+7,,AUTO
         9 007343   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 007344   200017 450500                    STP0    IOPT+10,,AUTO
         9 007345   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 007346   200016 756100                    STQ     IOPT+9,,AUTO
         9 007347   000003 236000 10                 LDQ     3
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:355  
         9 007350   200015 756100                    STQ     IOPT+8,,AUTO
         9 007351   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 007352   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 007353   000000 701000 xent               TSX1    XUR$ERRMSG
         9 007354   000000 011000                    NOP     0

     2779    12871    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  12871  9 007355   000000 470400 xsym               LDP0    B$TCB$
         9 007356   000000 471500                    LDP1    0,,PR0
         9 007357   100102 236100                    LDQ     66,,PR1
         9 007360   001125 756000 1                  STQ     ERROR

     2780    12872    2      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));

  12872  9 007361   000000 236007 xsym               LDQ     M$LO,DL
         9 007362   200014 756100                    STQ     IOPT+7,,AUTO
         9 007363   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 007364   200017 451500                    STP1    IOPT+10,,AUTO
         9 007365   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 007366   200016 756100                    STQ     IOPT+9,,AUTO
         9 007367   000030 236000 10                 LDQ     24
         9 007370   200015 756100                    STQ     IOPT+8,,AUTO
         9 007371   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 007372   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 007373   000000 701000 xent               TSX1    XUR$ERRMSG
         9 007374   000000 011000                    NOP     0

     2781    12873    2      CALL ORR$XCONRTN;

  12873  9 007375   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 007376   000000 701000 xent               TSX1    ORR$XCONRTN
         9 007377   000000 011000                    NOP     0

  12871  9 007400                       CANT_READ_S* null
     2782    12874
     2783    12875    2   CANT_READ_STATUS:;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:356  
     2784    12876    2      MODULE_ERR.ERR# = 28 /* E_READSTATERR# */;

  12876  9 007400   001670 236000 1                  LDQ     MODULE_ERR
         9 007401   000001 376000 10                 ANQ     1
         9 007402   000340 276007                    ORQ     224,DL
         9 007403   001670 756000 1                  STQ     MODULE_ERR

     2785    12877    2      MODULE_ERR.SEV = 0;

  12877  9 007404   000002 236000 10                 LDQ     2
         9 007405   001670 356000 1                  ANSQ    MODULE_ERR

     2786    12878    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;

  12878  9 007406   000000 470400 xsym               LDP0    B$TCB$
         9 007407   000000 471500                    LDP1    0,,PR0
         9 007410   100101 235100                    LDA     65,,PR1
         9 007411   000215 755000 1                  STA     DCB#

     2787    12879    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

  12879  9 007412   000000 236007 xsym               LDQ     M$LO,DL
         9 007413   200014 756100                    STQ     IOPT+7,,AUTO
         9 007414   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 007415   200017 451500                    STP1    IOPT+10,,AUTO
         9 007416   000031 236000 10                 LDQ     25
         9 007417   200016 756100                    STQ     IOPT+9,,AUTO
         9 007420   000003 236000 10                 LDQ     3
         9 007421   200015 756100                    STQ     IOPT+8,,AUTO
         9 007422   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 007423   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 007424   000000 701000 xent               TSX1    XUR$ERRMSG
         9 007425   000000 011000                    NOP     0

     2788    12880    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  12880  9 007426   000000 470400 xsym               LDP0    B$TCB$
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:357  
         9 007427   000000 471500                    LDP1    0,,PR0
         9 007430   100102 236100                    LDQ     66,,PR1
         9 007431   001125 756000 1                  STQ     ERROR

     2789    12881    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

  12881  9 007432   000000 236007 xsym               LDQ     M$LO,DL
         9 007433   200014 756100                    STQ     IOPT+7,,AUTO
         9 007434   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 007435   200017 451500                    STP1    IOPT+10,,AUTO
         9 007436   000031 236000 10                 LDQ     25
         9 007437   200016 756100                    STQ     IOPT+9,,AUTO
         9 007440   000030 236000 10                 LDQ     24
         9 007441   200015 756100                    STQ     IOPT+8,,AUTO
         9 007442   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 007443   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 007444   000000 701000 xent               TSX1    XUR$ERRMSG
         9 007445   000000 011000                    NOP     0

     2790    12882    2      CALL ORR$XCONRTN;

  12882  9 007446   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 007447   000000 701000 xent               TSX1    ORR$XCONRTN
         9 007450   000000 011000                    NOP     0

  12880  9 007451                       CANT_READ_H* null
     2791    12883
     2792    12884    2   CANT_READ_HIST:;
     2793    12885    2      DCB# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;

  12885  9 007451   000000 470400 xsym               LDP0    B$TCB$
         9 007452   000000 471500                    LDP1    0,,PR0
         9 007453   100101 235100                    LDA     65,,PR1
         9 007454   000215 755000 1                  STA     DCB#

     2794    12886    2      MODULE_ERR.ERR# = 20 /* E_HSTREAD# */;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:358  
  12886  9 007455   001670 236000 1                  LDQ     MODULE_ERR
         9 007456   000001 376000 10                 ANQ     1
         9 007457   000240 276007                    ORQ     160,DL
         9 007460   001670 756000 1                  STQ     MODULE_ERR

     2795    12887    2      MODULE_ERR.SEV = 0;

  12887  9 007461   000002 236000 10                 LDQ     2
         9 007462   001670 356000 1                  ANSQ    MODULE_ERR

     2796    12888    2      CALL XUR$ERRMSG (MODULE_ERR,DCB#,DCBNUM(M$LO));

  12888  9 007463   000000 236007 xsym               LDQ     M$LO,DL
         9 007464   200014 756100                    STQ     IOPT+7,,AUTO
         9 007465   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 007466   200017 451500                    STP1    IOPT+10,,AUTO
         9 007467   000031 236000 10                 LDQ     25
         9 007470   200016 756100                    STQ     IOPT+9,,AUTO
         9 007471   000003 236000 10                 LDQ     3
         9 007472   200015 756100                    STQ     IOPT+8,,AUTO
         9 007473   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 007474   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 007475   000000 701000 xent               TSX1    XUR$ERRMSG
         9 007476   000000 011000                    NOP     0

     2797    12889    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  12889  9 007477   000000 470400 xsym               LDP0    B$TCB$
         9 007500   000000 471500                    LDP1    0,,PR0
         9 007501   100102 236100                    LDQ     66,,PR1
         9 007502   001125 756000 1                  STQ     ERROR

     2798    12890    2      CALL XUR$ERRMSG (ERROR,DCB#,DCBNUM(M$LO));

  12890  9 007503   000000 236007 xsym               LDQ     M$LO,DL
         9 007504   200014 756100                    STQ     IOPT+7,,AUTO
         9 007505   200014 631500                    EPPR1   IOPT+7,,AUTO
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:359  
         9 007506   200017 451500                    STP1    IOPT+10,,AUTO
         9 007507   000031 236000 10                 LDQ     25
         9 007510   200016 756100                    STQ     IOPT+9,,AUTO
         9 007511   000030 236000 10                 LDQ     24
         9 007512   200015 756100                    STQ     IOPT+8,,AUTO
         9 007513   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 007514   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 007515   000000 701000 xent               TSX1    XUR$ERRMSG
         9 007516   000000 011000                    NOP     0

     2799    12891    2      CALL ORR$XCONRTN;

  12891  9 007517   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 007520   000000 701000 xent               TSX1    ORR$XCONRTN
         9 007521   000000 011000                    NOP     0

  12889  9 007522                       CANT_PRECORD null
     2800    12892
     2801    12893
     2802    12894    2   CANT_PRECORD:;
     2803    12895    2      MODULE_ERR.ERR# = 25 /* E_PRECERR# */;

  12895  9 007522   001670 236000 1                  LDQ     MODULE_ERR
         9 007523   000001 376000 10                 ANQ     1
         9 007524   000310 276007                    ORQ     200,DL
         9 007525   001670 756000 1                  STQ     MODULE_ERR

     2804    12896    2      MODULE_ERR.SEV = 0;

  12896  9 007526   000002 236000 10                 LDQ     2
         9 007527   001670 356000 1                  ANSQ    MODULE_ERR

     2805    12897    2      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  12897  9 007530   000000 236007 xsym               LDQ     M$LO,DL
         9 007531   200014 756100                    STQ     IOPT+7,,AUTO
         9 007532   200014 630500                    EPPR0   IOPT+7,,AUTO
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:360  
         9 007533   200017 450500                    STP0    IOPT+10,,AUTO
         9 007534   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 007535   200016 756100                    STQ     IOPT+9,,AUTO
         9 007536   000003 236000 10                 LDQ     3
         9 007537   200015 756100                    STQ     IOPT+8,,AUTO
         9 007540   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 007541   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 007542   000000 701000 xent               TSX1    XUR$ERRMSG
         9 007543   000000 011000                    NOP     0

     2806    12898    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  12898  9 007544   000000 470400 xsym               LDP0    B$TCB$
         9 007545   000000 471500                    LDP1    0,,PR0
         9 007546   100102 236100                    LDQ     66,,PR1
         9 007547   001125 756000 1                  STQ     ERROR

     2807    12899    2      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));

  12899  9 007550   000000 236007 xsym               LDQ     M$LO,DL
         9 007551   200014 756100                    STQ     IOPT+7,,AUTO
         9 007552   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 007553   200017 451500                    STP1    IOPT+10,,AUTO
         9 007554   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 007555   200016 756100                    STQ     IOPT+9,,AUTO
         9 007556   000030 236000 10                 LDQ     24
         9 007557   200015 756100                    STQ     IOPT+8,,AUTO
         9 007560   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 007561   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 007562   000000 701000 xent               TSX1    XUR$ERRMSG
         9 007563   000000 011000                    NOP     0

     2808    12900    2      CALL ORR$XCONRTN;

  12900  9 007564   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 007565   000000 701000 xent               TSX1    ORR$XCONRTN
         9 007566   000000 011000                    NOP     0
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:361  

     2809    12901
     2810    12902    2   END OPEN_TO_RANGE;

  12902  9 007567   200004 221300                    LDX1  ! TEMP_UTS+1,,AUTO
         9 007570   000001 702211                    TSX2  ! 1,X1

     2811    12903
     2812    12904        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:362  
     2813    12905         /*
     2814    12906                  S U B R O U T I N E   C L O S E _ U P
     2815    12907                                                */
     2816    12908
     2817    12909    1   CLOSE_UP: PROC;

  12909  9 007571   200004 741300       CLOSE_UP     STX1  ! TEMP_UTS+1,,AUTO

     2818    12910    3      DO CASE (STK_INDEX);

  12910  9 007572   000662 235000 1                  LDA     STK_INDEX
         9 007573   000002 115007                    CMPA    2,DL
         9 007574   007576 602005 9                  TNC     s:12910+4,AL
         9 007575   007702 710000 9                  TRA     s:12952
         9 007576   007600 710000 9                  TRA     s:12912
         9 007577   007620 710000 9                  TRA     s:12923

     2819    12911    3      CASE (0);

     2820    12912    3         FID_NAME = GDS_RESULTS_VEC.PTR$ -> PREV_STACK (STK_INDEX);

  12912  9 007600   000005 735000                    ALS     5
         9 007601   002045 470400 1                  LDP0    GDS_RESULTS_VEC+1
         9 007602   000000 100505                    MLR     fill='000'O
         9 007603   000000 000040                    ADSC9   0,A,PR0                  cn=0,n=32
         9 007604   001400 000040 1                  ADSC9   FID_NAME                 cn=0,n=32

     2821    12913    3         FDS_RESULTS_VEC.PTR$ = PINCRW (GDS_RESULTS_VEC.PTR$,(STK_INDEX * 8));

  12913  9 007605   000662 236000 1                  LDQ     STK_INDEX
         9 007606   000025 736000                    QLS     21
         9 007607   002045 036000 1                  ADLQ    GDS_RESULTS_VEC+1
         9 007610   002055 756000 1                  STQ     FDS_RESULTS_VEC+1

     2822    12914    3         CALL M$FDS (RELEASE_SEG);

  12914  9 007611   002046 630400 1                  EPPR0   RELEASE_SEG
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:363  
         9 007612   030002 713400                    CLIMB   fds
         9 007613   400400 401760                    pmme    nvectors=2

     2823    12915    3         CALL CLOSE_SPECIFIC_FILE;

  12915  9 007614   004454 701000 9                  TSX1    CLOSE_SPECIFIC_FILE
         9 007615   000000 011000                    NOP     0

     2824    12916    3         KEEP_ON_LISTING = %NO#;

  12916  9 007616   000663 450000 1                  STZ     KEEP_ON_LISTING
         9 007617   007763 710000 9                  TRA     s:12982

     2825    12917
     2826    12918                                                /* File to be closed is :OCHIST
     2827    12919                                                     (last on stack).                 */
     2828    12920
     2829    12921
     2830    12922    3      CASE (1);

     2831    12923    3         FID_NAME = GDS_RESULTS_VEC.PTR$->PREV_STACK (STK_INDEX);

  12923  9 007620   000005 735000                    ALS     5
         9 007621   002045 470400 1                  LDP0    GDS_RESULTS_VEC+1
         9 007622   000000 100505                    MLR     fill='000'O
         9 007623   000000 000040                    ADSC9   0,A,PR0                  cn=0,n=32
         9 007624   001400 000040 1                  ADSC9   FID_NAME                 cn=0,n=32

     2832    12924    3         FDS_RESULTS_VEC.PTR$ = PINCRW (GDS_RESULTS_VEC.PTR$,(STK_INDEX * 8));

  12924  9 007625   000662 236000 1                  LDQ     STK_INDEX
         9 007626   000025 736000                    QLS     21
         9 007627   002045 036000 1                  ADLQ    GDS_RESULTS_VEC+1
         9 007630   002055 756000 1                  STQ     FDS_RESULTS_VEC+1

     2833    12925    3         CALL M$FDS (RELEASE_SEG);

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:364  
  12925  9 007631   002046 630400 1                  EPPR0   RELEASE_SEG
         9 007632   030002 713400                    CLIMB   fds
         9 007633   400400 401760                    pmme    nvectors=2

     2834    12926    4         IF ENDING_TIME > OCL_NORM_KEY.UTS THEN DO;

  12926  9 007634   000000 235000 xsym               LDA     OCL_NORM_KEY
         9 007635   000001 236000 xsym               LDQ     OCL_NORM_KEY+1
         9 007636   000033 773000                    LRL     27
         9 007637   000301 116000 1                  CMPQ    ENDING_TIME
         9 007640   007676 603000 9                  TRC     s:12941

     2835    12927    4            CALL CLOSE_SPECIFIC_FILE;

  12927  9 007641   004454 701000 9                  TSX1    CLOSE_SPECIFIC_FILE
         9 007642   000000 011000                    NOP     0

     2836    12928    4            STK_INDEX = STK_INDEX-1;

  12928  9 007643   000001 336007                    LCQ     1,DL
         9 007644   000662 056000 1                  ASQ     STK_INDEX

     2837    12929    4            FID_NAME = GDS_RESULTS_VEC.PTR$->PREV_STACK (STK_INDEX);

  12929  9 007645   000662 235000 1                  LDA     STK_INDEX
         9 007646   000005 735000                    ALS     5
         9 007647   002045 470400 1                  LDP0    GDS_RESULTS_VEC+1
         9 007650   000000 100505                    MLR     fill='000'O
         9 007651   000000 000040                    ADSC9   0,A,PR0                  cn=0,n=32
         9 007652   001400 000040 1                  ADSC9   FID_NAME                 cn=0,n=32

     2838    12930    4            CALL OPEN_SPECIFIC_FILE;

  12930  9 007653   003713 701000 9                  TSX1    OPEN_SPECIFIC_FILE
         9 007654   000000 011000                    NOP     0

     2839    12931    4            FIRST_HIST_REC.V.N# = 1;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:365  

  12931  9 007655   000001 235007                    LDA     1,DL
         9 007656   002423 755000 1                  STA     FIRST_HIST_REC+7

     2840    12932    4            CALL M$PRECORD (FIRST_HIST_REC) ALTRET (CANT_PRECORD);

  12932  9 007657   002414 630400 1                  EPPR0   FIRST_HIST_REC
         9 007660   440003 713400                    CLIMB   alt,+16387
         9 007661   401000 401760                    pmme    nvectors=3
         9 007662   007765 702000 9                  TSX2    CANT_PRECORD

     2841    12933    4            CALL BUILD_CONSOLE_STACK;

  12933  9 007663   010034 701000 9                  TSX1    BUILD_CONSOLE_STACK
         9 007664   000000 011000                    NOP     0

     2842    12934    4            OCL_NORM_KEY.COUNT = 4;

  12934  9 007665   004000 236003                    LDQ     2048,DU
         9 007666   000000 552040 xsym               STBQ    OCL_NORM_KEY,'40'O

     2843    12935    4            OCL_NORM_KEY.UTS = 15000;

  12935  9 007667   000000 100400                    MLR     fill='000'O
         9 007670   000032 000004 10                 ADSC9   26                       cn=0,n=4
         9 007671   000000 200004 xsym               ADSC9   OCL_NORM_KEY             cn=1,n=4

     2844    12936    4            HIST_POSITION.V.N# = 0;

  12936  9 007672   002153 450000 1                  STZ     HIST_POSITION+7

     2845    12937    4            KEEP_ON_LISTING = %YES#;

  12937  9 007673   400000 236003                    LDQ     -131072,DU
         9 007674   000663 756000 1                  STQ     KEEP_ON_LISTING

     2846    12938    4         END;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:366  

  12938  9 007675   007763 710000 9                  TRA     s:12982

     2847    12939    3         ELSE
     2848    12940    4         DO;

     2849    12941    4            CALL CLOSE_SPECIFIC_FILE;

  12941  9 007676   004454 701000 9                  TSX1    CLOSE_SPECIFIC_FILE
         9 007677   000000 011000                    NOP     0

     2850    12942    4            KEEP_ON_LISTING = %NO#;

  12942  9 007700   000663 450000 1                  STZ     KEEP_ON_LISTING

     2851    12943    4         END;

  12943  9 007701   007763 710000 9                  TRA     s:12982

     2852    12944
     2853    12945                                                /* Close history file, call keyin
     2854    12946                                                     if continued searching is
     2855    12947                                                     necessary, to insure that
     2856    12948                                                     :OCHIST is opened shared.        */
     2857    12949
     2858    12950
     2859    12951    3      CASE (ELSE);

     2860    12952    3         FID_NAME = GDS_RESULTS_VEC.PTR$ -> PREV_STACK (STK_INDEX);

  12952  9 007702   000005 735000                    ALS     5
         9 007703   002045 470400 1                  LDP0    GDS_RESULTS_VEC+1
         9 007704   000000 100505                    MLR     fill='000'O
         9 007705   000000 000040                    ADSC9   0,A,PR0                  cn=0,n=32
         9 007706   001400 000040 1                  ADSC9   FID_NAME                 cn=0,n=32

     2861    12953    3         FDS_RESULTS_VEC.PTR$ = PINCRW (GDS_RESULTS_VEC.PTR$,(STK_INDEX * 8));
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:367  

  12953  9 007707   000662 236000 1                  LDQ     STK_INDEX
         9 007710   000025 736000                    QLS     21
         9 007711   002045 036000 1                  ADLQ    GDS_RESULTS_VEC+1
         9 007712   002055 756000 1                  STQ     FDS_RESULTS_VEC+1

     2862    12954    3         CALL M$FDS (RELEASE_SEG);

  12954  9 007713   002046 630400 1                  EPPR0   RELEASE_SEG
         9 007714   030002 713400                    CLIMB   fds
         9 007715   400400 401760                    pmme    nvectors=2

     2863    12955    4         IF ENDING_TIME > OCL_NORM_KEY.UTS THEN DO;

  12955  9 007716   000000 235000 xsym               LDA     OCL_NORM_KEY
         9 007717   000001 236000 xsym               LDQ     OCL_NORM_KEY+1
         9 007720   000033 773000                    LRL     27
         9 007721   000301 116000 1                  CMPQ    ENDING_TIME
         9 007722   007760 603000 9                  TRC     s:12970

     2864    12956    4            CALL CLOSE_SPECIFIC_FILE;

  12956  9 007723   004454 701000 9                  TSX1    CLOSE_SPECIFIC_FILE
         9 007724   000000 011000                    NOP     0

     2865    12957    4            STK_INDEX = STK_INDEX-1;

  12957  9 007725   000001 336007                    LCQ     1,DL
         9 007726   000662 056000 1                  ASQ     STK_INDEX

     2866    12958    4            FID_NAME = GDS_RESULTS_VEC.PTR$ -> PREV_STACK (STK_INDEX);

  12958  9 007727   000662 235000 1                  LDA     STK_INDEX
         9 007730   000005 735000                    ALS     5
         9 007731   002045 470400 1                  LDP0    GDS_RESULTS_VEC+1
         9 007732   000000 100505                    MLR     fill='000'O
         9 007733   000000 000040                    ADSC9   0,A,PR0                  cn=0,n=32
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:368  
         9 007734   001400 000040 1                  ADSC9   FID_NAME                 cn=0,n=32

     2867    12959    4            CALL OPEN_SPECIFIC_FILE;

  12959  9 007735   003713 701000 9                  TSX1    OPEN_SPECIFIC_FILE
         9 007736   000000 011000                    NOP     0

     2868    12960    4            FIRST_HIST_REC.V.N# = 1;

  12960  9 007737   000001 235007                    LDA     1,DL
         9 007740   002423 755000 1                  STA     FIRST_HIST_REC+7

     2869    12961    4            CALL M$PRECORD (FIRST_HIST_REC) ALTRET (CANT_PRECORD);

  12961  9 007741   002414 630400 1                  EPPR0   FIRST_HIST_REC
         9 007742   440003 713400                    CLIMB   alt,+16387
         9 007743   401000 401760                    pmme    nvectors=3
         9 007744   007765 702000 9                  TSX2    CANT_PRECORD

     2870    12962    4            CALL BUILD_CONSOLE_STACK;

  12962  9 007745   010034 701000 9                  TSX1    BUILD_CONSOLE_STACK
         9 007746   000000 011000                    NOP     0

     2871    12963    4            OCL_NORM_KEY.COUNT = 4;

  12963  9 007747   004000 236003                    LDQ     2048,DU
         9 007750   000000 552040 xsym               STBQ    OCL_NORM_KEY,'40'O

     2872    12964    4            OCL_NORM_KEY.UTS = 15000;

  12964  9 007751   000000 100400                    MLR     fill='000'O
         9 007752   000032 000004 10                 ADSC9   26                       cn=0,n=4
         9 007753   000000 200004 xsym               ADSC9   OCL_NORM_KEY             cn=1,n=4

     2873    12965    4            HIST_POSITION.V.N# = 0;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:369  
  12965  9 007754   002153 450000 1                  STZ     HIST_POSITION+7

     2874    12966    4            KEEP_ON_LISTING = %YES#;

  12966  9 007755   400000 236003                    LDQ     -131072,DU
         9 007756   000663 756000 1                  STQ     KEEP_ON_LISTING

     2875    12967    4         END;

  12967  9 007757   007763 710000 9                  TRA     s:12982

     2876    12968    3         ELSE
     2877    12969    4         DO;

     2878    12970    4            CALL CLOSE_SPECIFIC_FILE;

  12970  9 007760   004454 701000 9                  TSX1    CLOSE_SPECIFIC_FILE
         9 007761   000000 011000                    NOP     0

     2879    12971    4            KEEP_ON_LISTING = %NO#;

  12971  9 007762   000663 450000 1                  STZ     KEEP_ON_LISTING

     2880    12972    4         END;

     2881    12973
     2882    12974                                                /* If more that 2 entries are on
     2883    12975                                                     the stack you don't have to
     2884    12976                                                     worry about talking to
     2885    12977                                                     keyin, so close file at top
     2886    12978                                                     of stack, decrement stack,
     2887    12979                                                     open file.                       */
     2888    12980
     2889    12981    3      END;

     2890    12982    2      RETURN;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:370  
  12982  9 007763   200004 221300                    LDX1  ! TEMP_UTS+1,,AUTO
         9 007764   000001 702211                    TSX2  ! 1,X1

  12971  9 007765                       CANT_PRECORD null
     2891    12983
     2892    12984
     2893    12985    2   CANT_PRECORD:;
     2894    12986    2      MODULE_ERR.ERR# = 25 /* E_PRECERR# */;

  12986  9 007765   001670 236000 1                  LDQ     MODULE_ERR
         9 007766   000001 376000 10                 ANQ     1
         9 007767   000310 276007                    ORQ     200,DL
         9 007770   001670 756000 1                  STQ     MODULE_ERR

     2895    12987    2      MODULE_ERR.SEV = 0;

  12987  9 007771   000002 236000 10                 LDQ     2
         9 007772   001670 356000 1                  ANSQ    MODULE_ERR

     2896    12988    2      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  12988  9 007773   000000 236007 xsym               LDQ     M$LO,DL
         9 007774   200014 756100                    STQ     IOPT+7,,AUTO
         9 007775   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 007776   200017 450500                    STP0    IOPT+10,,AUTO
         9 007777   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 010000   200016 756100                    STQ     IOPT+9,,AUTO
         9 010001   000003 236000 10                 LDQ     3
         9 010002   200015 756100                    STQ     IOPT+8,,AUTO
         9 010003   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 010004   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 010005   000000 701000 xent               TSX1    XUR$ERRMSG
         9 010006   000000 011000                    NOP     0

     2897    12989    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  12989  9 010007   000000 470400 xsym               LDP0    B$TCB$
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:371  
         9 010010   000000 471500                    LDP1    0,,PR0
         9 010011   100102 236100                    LDQ     66,,PR1
         9 010012   001125 756000 1                  STQ     ERROR

     2898    12990    2      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));

  12990  9 010013   000000 236007 xsym               LDQ     M$LO,DL
         9 010014   200014 756100                    STQ     IOPT+7,,AUTO
         9 010015   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 010016   200017 451500                    STP1    IOPT+10,,AUTO
         9 010017   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 010020   200016 756100                    STQ     IOPT+9,,AUTO
         9 010021   000030 236000 10                 LDQ     24
         9 010022   200015 756100                    STQ     IOPT+8,,AUTO
         9 010023   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 010024   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 010025   000000 701000 xent               TSX1    XUR$ERRMSG
         9 010026   000000 011000                    NOP     0

     2899    12991    2      CALL ORR$XCONRTN;

  12991  9 010027   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 010030   000000 701000 xent               TSX1    ORR$XCONRTN
         9 010031   000000 011000                    NOP     0

     2900    12992
     2901    12993    2   END CLOSE_UP;

  12993  9 010032   200004 221300                    LDX1  ! TEMP_UTS+1,,AUTO
         9 010033   000001 702211                    TSX2  ! 1,X1

     2902    12994        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:372  
     2903    12995         /*
     2904    12996                  S U B R O U T I N E   B U I L D _ C O N S O L E _ S T A C K
     2905    12997                                                */
     2906    12998
     2907    12999    1   BUILD_CONSOLE_STACK: PROC;

  12999  9 010034   200006 741300       BUILD_CONSO* STX1  ! IOPT+1,,AUTO

     2908    13000    2      PREFIX = %YES#;

  13000  9 010035   400000 236003                    LDQ     -131072,DU
         9 010036   000705 756000 1                  STQ     PREFIX

     2909    13001    2      IF WSTATION = '?'

  13001  9 010037   000274 237000 1                  LDAQ    WSTATION
         9 010040   000016 117000 10                 CMPAQ   14
         9 010041   010064 601000 9                  TNZ     s:13011
         9 010042   000276 237000 1                  LDAQ    LOGON
         9 010043   000016 117000 10                 CMPAQ   14
         9 010044   010064 601000 9                  TNZ     s:13011
         9 010045   040000 106400                    CMPC    fill='040'O
         9 010046   000271 000010 1                  ADSC9   LOCATION                 cn=0,n=8
         9 010047   000016 000001 10                 ADSC9   14                       cn=0,n=1
         9 010050   010064 601000 9                  TNZ     s:13011
         9 010051   000270 236000 1                  LDQ     CONSOLE
         9 010052   000016 116000 10                 CMPQ    14
         9 010053   010064 601000 9                  TNZ     s:13011
         9 010054   000700 237000 1                  LDAQ    TYPE
         9 010055   000016 117000 10                 CMPAQ   14
         9 010056   010064 601000 9                  TNZ     s:13011

     2910    13002    2        AND LOGON = '?'
     2911    13003    2        AND LOCATION = '?'
     2912    13004    2        AND CONSOLE = '?'
     2913    13005    3        AND TYPE = '?' THEN DO;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:373  
     2914    13006    3         ALL = %YES#;

  13006  9 010057   400000 236003                    LDQ     -131072,DU
         9 010060   000666 756000 1                  STQ     ALL

     2915    13007    3         IF LOGON_REPORT THEN GOTO DO_ALL;

  13007  9 010061   000711 234000 1                  SZN     LOGON_REPORT
         9 010062   010065 604000 9                  TMI     DO_ALL

     2916    13008    3         ELSE RETURN;

  13008  9 010063   000001 702211                    TSX2  ! 1,X1

     2917    13009    3      END;
     2918    13010
     2919    13011    2      ALL = %NO#;

  13011  9 010064   000666 450000 1                  STZ     ALL

  13011  9 010065                       DO_ALL       null
     2920    13012    2   DO_ALL:;
     2921    13013    2      PREFIX = %NO#;

  13013  9 010065   000705 450000 1                  STZ     PREFIX

     2922    13014    2      PERFORM_CALL = %NO#;

  13014  9 010066   000677 450000 1                  STZ     PERFORM_CALL

     2923    13015    2      DIRECT = %NO#;

  13015  9 010067   000676 450000 1                  STZ     DIRECT

     2924    13016    2      IF TYPE ~= '?' THEN RETURN;

  13016  9 010070   000700 237000 1                  LDAQ    TYPE
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:374  
         9 010071   000016 117000 10                 CMPAQ   14
         9 010072   010074 600000 9                  TZE     s:13019

  13016  9 010073   000001 702211                    TSX2  ! 1,X1

     2925    13017
     2926    13018    3      DO WHILE ('1'B);

     2927    13019    3         CALL M$READ (READ_CONSOLE_REC) ALTRET (NO_MORE_CRECS);

  13019  9 010074   002002 630400 1                  EPPR0   READ_CONSOLE_REC
         9 010075   440000 713400                    CLIMB   alt,read
         9 010076   401400 401760                    pmme    nvectors=4
         9 010077   010240 702000 9                  TSX2    NO_MORE_CRECS

     2928    13020    4         IF (CONSOLE = '?' AND LOCATION ~= '?') THEN DO;

  13020  9 010100   000270 236000 1                  LDQ     CONSOLE
         9 010101   000016 116000 10                 CMPQ    14
         9 010102   010116 601000 9                  TNZ     s:13027
         9 010103   040000 106400                    CMPC    fill='040'O
         9 010104   000271 000010 1                  ADSC9   LOCATION                 cn=0,n=8
         9 010105   000016 000001 10                 ADSC9   14                       cn=0,n=1
         9 010106   010116 600000 9                  TZE     s:13027

     2929    13021    5            IF LOCATION = OCL_CONSOLE_REC.TERM_NAME THEN DO;

  13021  9 010107   040000 106400                    CMPC    fill='040'O
         9 010110   000271 000010 1                  ADSC9   LOCATION                 cn=0,n=8
         9 010111   000000 000010 xsym               ADSC9   OCL_CONSOLE_REC          cn=0,n=8
         9 010112   010116 601000 9                  TNZ     s:13027

     2930    13022    5               DIRECT = %YES#;

  13022  9 010113   400000 236003                    LDQ     -131072,DU
         9 010114   000676 756000 1                  STQ     DIRECT

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:375  
     2931    13023    5               PERFORM_CALL = %YES#;

  13023  9 010115   000677 756000 1                  STQ     PERFORM_CALL

     2932    13024    5            END;

     2933    13025    4         END;

     2934    13026
     2935    13027    4         IF (CONSOLE ~= '?' AND LOCATION = '?') THEN DO;

  13027  9 010116   000270 236000 1                  LDQ     CONSOLE
         9 010117   000016 116000 10                 CMPQ    14
         9 010120   010132 600000 9                  TZE     s:13034
         9 010121   040000 106400                    CMPC    fill='040'O
         9 010122   000271 000010 1                  ADSC9   LOCATION                 cn=0,n=8
         9 010123   000016 000001 10                 ADSC9   14                       cn=0,n=1
         9 010124   010132 601000 9                  TNZ     s:13034

     2936    13028    5            IF CONSOLE = OCL_CONSOLE_REC.STATION.FIRST_HALF THEN DO;

  13028  9 010125   000007 116000 xsym               CMPQ    OCL_CONSOLE_REC+7
         9 010126   010132 601000 9                  TNZ     s:13034

     2937    13029    5               DIRECT = %NO#;

  13029  9 010127   000676 450000 1                  STZ     DIRECT

     2938    13030    5               PERFORM_CALL = %YES#;

  13030  9 010130   400000 236003                    LDQ     -131072,DU
         9 010131   000677 756000 1                  STQ     PERFORM_CALL

     2939    13031    5            END;

     2940    13032    4         END;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:376  
     2941    13033
     2942    13034    4         IF (CONSOLE ~= '?' AND LOCATION ~= '?') THEN DO;

  13034  9 010132   000270 236000 1                  LDQ     CONSOLE
         9 010133   000016 116000 10                 CMPQ    14
         9 010134   010152 600000 9                  TZE     s:13043
         9 010135   040000 106400                    CMPC    fill='040'O
         9 010136   000271 000010 1                  ADSC9   LOCATION                 cn=0,n=8
         9 010137   000016 000001 10                 ADSC9   14                       cn=0,n=1
         9 010140   010152 600000 9                  TZE     s:13043

     2943    13035    5            IF CONSOLE = OCL_CONSOLE_REC.STATION.FIRST_HALF THEN DO;

  13035  9 010141   000007 116000 xsym               CMPQ    OCL_CONSOLE_REC+7
         9 010142   010152 601000 9                  TNZ     s:13043

     2944    13036    6               IF LOCATION = OCL_CONSOLE_REC.TERM_NAME THEN DO;

  13036  9 010143   040000 106400                    CMPC    fill='040'O
         9 010144   000271 000010 1                  ADSC9   LOCATION                 cn=0,n=8
         9 010145   000000 000010 xsym               ADSC9   OCL_CONSOLE_REC          cn=0,n=8
         9 010146   010152 601000 9                  TNZ     s:13043

     2945    13037    6                  PERFORM_CALL = %YES#;

  13037  9 010147   400000 236003                    LDQ     -131072,DU
         9 010150   000677 756000 1                  STQ     PERFORM_CALL

     2946    13038    6                  DIRECT = %YES#;

  13038  9 010151   000676 756000 1                  STQ     DIRECT

     2947    13039    6               END;

     2948    13040    5            END;

     2949    13041    4         END;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:377  

     2950    13042
     2951    13043    4         IF (LOGON ~= '?' AND LOGON = OCL_CONSOLE_REC.LOGON) THEN DO;

  13043  9 010152   000276 237000 1                  LDAQ    LOGON
         9 010153   000016 117000 10                 CMPAQ   14
         9 010154   010164 600000 9                  TZE     s:13048
         9 010155   040000 106400                    CMPC    fill='040'O
         9 010156   000276 000010 1                  ADSC9   LOGON                    cn=0,n=8
         9 010157   000005 000010 xsym               ADSC9   OCL_CONSOLE_REC+5        cn=0,n=8
         9 010160   010164 601000 9                  TNZ     s:13048

     2952    13044    4            PERFORM_CALL = %YES#;

  13044  9 010161   400000 236003                    LDQ     -131072,DU
         9 010162   000677 756000 1                  STQ     PERFORM_CALL

     2953    13045    4            DIRECT = %YES#;

  13045  9 010163   000676 756000 1                  STQ     DIRECT

     2954    13046    4         END;

     2955    13047
     2956    13048    4         IF WSTATION ~= '?' THEN DO;

  13048  9 010164   000274 237000 1                  LDAQ    WSTATION
         9 010165   000016 117000 10                 CMPAQ   14
         9 010166   010224 600000 9                  TZE     s:13065

     2957    13049    5            IF SUBSTR (OCL_CONSOLE_REC.WSN, 0, 1) = '?' THEN DO;

  13049  9 010167   000002 236000 xsym               LDQ     OCL_CONSOLE_REC+2
         9 010170   777000 376003                    ANQ     -512,DU
         9 010171   077000 116003                    CMPQ    32256,DU
         9 010172   010210 601000 9                  TNZ     s:13057

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:378  
     2958    13050    5               CALL INDEX (W, '?', WSTATION);

  13050  9 010173   000000 124400                    SCM     mask='000'O
         9 010174   000274 000010 1                  ADSC9   WSTATION                 cn=0,n=8
         9 010175   000016 000001 10                 ADSC9   14                       cn=0,n=1
         9 010176   000751 000000 1                  ARG     W

     2959    13051    6               IF SUBSTR (WSTATION, 0, W) = SUBSTR (OCL_CONSOLE_REC.TERM_NAME, 0, W)
             13051                        THEN DO;

  13051  9 010177   000751 720000 1                  LXL0    W
         9 010200   040040 106440                    CMPC    fill='040'O
         9 010201   000274 000010 1                  ADSC9   WSTATION                 cn=0,n=*X0
         9 010202   000000 000010 xsym               ADSC9   OCL_CONSOLE_REC          cn=0,n=*X0
         9 010203   010224 601000 9                  TNZ     s:13065

     2960    13052    6                  PERFORM_CALL = %YES#;

  13052  9 010204   400000 236003                    LDQ     -131072,DU
         9 010205   000677 756000 1                  STQ     PERFORM_CALL

     2961    13053    6                  DIRECT = %NO#;

  13053  9 010206   000676 450000 1                  STZ     DIRECT

     2962    13054    6               END;

     2963    13055    5            END;

  13055  9 010207   010224 710000 9                  TRA     s:13065

     2964    13056    5            ELSE DO;

     2965    13057    5               CALL INDEX (W, '?', OCL_CONSOLE_REC.WSN);

  13057  9 010210   000000 124400                    SCM     mask='000'O
         9 010211   000002 000010 xsym               ADSC9   OCL_CONSOLE_REC+2        cn=0,n=8
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:379  
         9 010212   000016 000001 10                 ADSC9   14                       cn=0,n=1
         9 010213   000751 000000 1                  ARG     W

     2966    13058    6              IF SUBSTR (OCL_CONSOLE_REC.WSN, 0, W) = SUBSTR (WSTATION, 0, W) THEN DO;

  13058  9 010214   000751 720000 1                  LXL0    W
         9 010215   040040 106440                    CMPC    fill='040'O
         9 010216   000002 000010 xsym               ADSC9   OCL_CONSOLE_REC+2        cn=0,n=*X0
         9 010217   000274 000010 1                  ADSC9   WSTATION                 cn=0,n=*X0
         9 010220   010224 601000 9                  TNZ     s:13065

     2967    13059    6                  PERFORM_CALL = %YES#;

  13059  9 010221   400000 236003                    LDQ     -131072,DU
         9 010222   000677 756000 1                  STQ     PERFORM_CALL

     2968    13060    6                  DIRECT = %NO#;

  13060  9 010223   000676 450000 1                  STZ     DIRECT

     2969    13061    6               END;

     2970    13062    5            END;

     2971    13063    4         END;

     2972    13064
     2973    13065    3         IF LOGON_REPORT AND ALL THEN PERFORM_CALL = %YES#;

  13065  9 010224   000711 234000 1                  SZN     LOGON_REPORT
         9 010225   010232 605000 9                  TPL     s:13067
         9 010226   000666 234000 1                  SZN     ALL
         9 010227   010232 605000 9                  TPL     s:13067

  13065  9 010230   400000 236003                    LDQ     -131072,DU
         9 010231   000677 756000 1                  STQ     PERFORM_CALL

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:380  
     2974    13066
     2975    13067    4         IF PERFORM_CALL THEN DO;

  13067  9 010232   000677 234000 1                  SZN     PERFORM_CALL
         9 010233   010074 605000 9                  TPL     s:13019

     2976    13068    4            CALL ADD_TO_LOGON_STACK;

  13068  9 010234   010362 701000 9                  TSX1    ADD_TO_LOGON_STACK
         9 010235   000000 011000                    NOP     0

     2977    13069    4            PERFORM_CALL = %NO#;

  13069  9 010236   000677 450000 1                  STZ     PERFORM_CALL

     2978    13070    4         END;

     2979    13071    3      END;

  13071  9 010237   010074 710000 9                  TRA     s:13019

  13058  9 010240                       NO_MORE_CRE* null
     2980    13072
     2981    13073    2   NO_MORE_CRECS:;
     2982    13074    2      IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$LD THEN RETURN;

  13074  9 010240   000000 470400 xsym               LDP0    B$TCB$
         9 010241   000000 471500                    LDP1    0,,PR0
         9 010242   100102 236100                    LDQ     66,,PR1
         9 010243   377770 376007                    ANQ     131064,DL
         9 010244   000070 116007                    CMPQ    56,DL
         9 010245   010250 601000 9                  TNZ     s:13079

  13074  9 010246   200006 221300                    LDX1  ! IOPT+1,,AUTO
         9 010247   000001 702211                    TSX2  ! 1,X1

     2983    13075    3      ELSE DO;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:381  

     2984    13076         /*E* ERROR: ORR-E_CREC#-7
     2985    13077                  MESSAGE: Error at attempt to read console record
     2986    13078                                 */
     2987    13079    3         ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  13079  9 010250   100102 236100                    LDQ     66,,PR1
         9 010251   001125 756000 1                  STQ     ERROR

     2988    13080    3         CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));

  13080  9 010252   000000 236007 xsym               LDQ     M$LO,DL
         9 010253   200014 756100                    STQ     IOPT+7,,AUTO
         9 010254   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 010255   200017 451500                    STP1    IOPT+10,,AUTO
         9 010256   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 010257   200016 756100                    STQ     IOPT+9,,AUTO
         9 010260   000030 236000 10                 LDQ     24
         9 010261   200015 756100                    STQ     IOPT+8,,AUTO
         9 010262   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 010263   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 010264   000000 701000 xent               TSX1    XUR$ERRMSG
         9 010265   000000 011000                    NOP     0

     2989    13081    3         MODULE_ERR.ERR# = 35 /* E_CREC# */;

  13081  9 010266   001670 236000 1                  LDQ     MODULE_ERR
         9 010267   000001 376000 10                 ANQ     1
         9 010270   000430 276007                    ORQ     280,DL
         9 010271   001670 756000 1                  STQ     MODULE_ERR

     2990    13082    3         MODULE_ERR.SEV = 0;

  13082  9 010272   000002 236000 10                 LDQ     2
         9 010273   001670 356000 1                  ANSQ    MODULE_ERR

     2991    13083    3         CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:382  

  13083  9 010274   000000 236007 xsym               LDQ     M$LO,DL
         9 010275   200014 756100                    STQ     IOPT+7,,AUTO
         9 010276   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 010277   200017 450500                    STP0    IOPT+10,,AUTO
         9 010300   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 010301   200016 756100                    STQ     IOPT+9,,AUTO
         9 010302   000003 236000 10                 LDQ     3
         9 010303   200015 756100                    STQ     IOPT+8,,AUTO
         9 010304   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 010305   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 010306   000000 701000 xent               TSX1    XUR$ERRMSG
         9 010307   000000 011000                    NOP     0

     2992    13084    3         CALL ORR$XCONRTN;

  13084  9 010310   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 010311   000000 701000 xent               TSX1    ORR$XCONRTN
         9 010312   000000 011000                    NOP     0

     2993    13085    3      END;

  13082  9 010313                       CANT_READ_S* null
     2994    13086
     2995    13087
     2996    13088    2   CANT_READ_STATUS:;
     2997    13089    2      MODULE_ERR.ERR# = 28 /* E_READSTATERR# */;

  13089  9 010313   001670 236000 1                  LDQ     MODULE_ERR
         9 010314   000001 376000 10                 ANQ     1
         9 010315   000340 276007                    ORQ     224,DL
         9 010316   001670 756000 1                  STQ     MODULE_ERR

     2998    13090    2      MODULE_ERR.SEV = 0;

  13090  9 010317   000002 236000 10                 LDQ     2
         9 010320   001670 356000 1                  ANSQ    MODULE_ERR
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:383  

     2999    13091    2      CALL XUR$ERRMSG (MODULE_ERR,,DCBNUM(M$LO));

  13091  9 010321   000000 236007 xsym               LDQ     M$LO,DL
         9 010322   200014 756100                    STQ     IOPT+7,,AUTO
         9 010323   200014 630500                    EPPR0   IOPT+7,,AUTO
         9 010324   200017 450500                    STP0    IOPT+10,,AUTO
         9 010325   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 010326   200016 756100                    STQ     IOPT+9,,AUTO
         9 010327   000003 236000 10                 LDQ     3
         9 010330   200015 756100                    STQ     IOPT+8,,AUTO
         9 010331   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 010332   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 010333   000000 701000 xent               TSX1    XUR$ERRMSG
         9 010334   000000 011000                    NOP     0

     3000    13092    2      ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  13092  9 010335   000000 470400 xsym               LDP0    B$TCB$
         9 010336   000000 471500                    LDP1    0,,PR0
         9 010337   100102 236100                    LDQ     66,,PR1
         9 010340   001125 756000 1                  STQ     ERROR

     3001    13093    2      CALL XUR$ERRMSG (ERROR,,DCBNUM(M$LO));

  13093  9 010341   000000 236007 xsym               LDQ     M$LO,DL
         9 010342   200014 756100                    STQ     IOPT+7,,AUTO
         9 010343   200014 631500                    EPPR1   IOPT+7,,AUTO
         9 010344   200017 451500                    STP1    IOPT+10,,AUTO
         9 010345   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 010346   200016 756100                    STQ     IOPT+9,,AUTO
         9 010347   000030 236000 10                 LDQ     24
         9 010350   200015 756100                    STQ     IOPT+8,,AUTO
         9 010351   200015 630500                    EPPR0   IOPT+8,,AUTO
         9 010352   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 010353   000000 701000 xent               TSX1    XUR$ERRMSG
         9 010354   000000 011000                    NOP     0
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:384  

     3002    13094    2      CALL ORR$XCONRTN;

  13094  9 010355   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 010356   000000 701000 xent               TSX1    ORR$XCONRTN
         9 010357   000000 011000                    NOP     0

     3003    13095    2   END BUILD_CONSOLE_STACK;

  13095  9 010360   200006 221300                    LDX1  ! IOPT+1,,AUTO
         9 010361   000001 702211                    TSX2  ! 1,X1

     3004    13096        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:385  
     3005    13097         /*
     3006    13098                  S U B R O U T I N E   A D D _ T O _ L O G O N _ S T A C K
     3007    13099                                                */
     3008    13100
     3009    13101    1   ADD_TO_LOGON_STACK: PROC;

  13101  9 010362   200010 741300       ADD_TO_LOGO* STX1  ! IOPT+3,,AUTO

     3010    13102
     3011    13103    3      IF SOME_ON_STACK <= 0 THEN DO;

  13103  9 010363   000675 235000 1                  LDA     SOME_ON_STACK
         9 010364   010400 601000 9                  TNZ     s:13114

     3012    13104    3         LRECS = 2;

  13104  9 010365   000002 236007                    LDQ     2,DL
         9 010366   000672 756000 1                  STQ     LRECS

     3013    13105    3         USE_LINDEX = %YES#;

  13105  9 010367   400000 236003                    LDQ     -131072,DU
         9 010370   000671 756000 1                  STQ     USE_LINDEX

     3014    13106    3         LINDEX = 0;

  13106  9 010371   000667 450000 1                  STZ     LINDEX

     3015    13107    3         CALL WRITE_LSTACK;

  13107  9 010372   010503 701000 9                  TSX1    WRITE_LSTACK
         9 010373   000000 011000                    NOP     0

     3016    13108    3         SOME_ON_STACK = 1;

  13108  9 010374   000001 235007                    LDA     1,DL
         9 010375   000675 755000 1                  STA     SOME_ON_STACK
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:386  

     3017    13109    3         RETURN;

  13109  9 010376   200010 221300                    LDX1  ! IOPT+3,,AUTO
         9 010377   000001 702211                    TSX2  ! 1,X1

     3018    13110    3      END;
     3019    13111
     3020    13112        /* else */
     3021    13113
     3022    13114    3      DO L = (LINDEX - 1) DOWNTO 0 BY -1;

  13114  9 010400   000667 236000 1                  LDQ     LINDEX
         9 010401   000001 136007                    SBLQ    1,DL
         9 010402   000670 756000 1                  STQ     L
         9 010403   010471 710000 9                  TRA     s:13138+2

     3023    13115    3         LOGON_REC_ON = LSTACK_RESULTS_VEC.PTR$ -> LSTACK(L);

  13115  9 010404   000670 236000 1                  LDQ     L
         9 010405   000052 402007                    MPY     42,DL
         9 010406   002101 470400 1                  LDP0    LSTACK_RESULTS_VEC+1
         9 010407   000000 100506                    MLR     fill='000'O
         9 010410   000000 000052                    ADSC9   0,Q,PR0                  cn=0,n=42
         9 010411   001151 000052 1                  ADSC9   LOGON_REC_ON             cn=0,n=42

     3024    13116
     3025    13117    3         IF OCL_CONSOLE_REC.STATION.FIRST_HALF=LOGON_REC_ON.STATION.FIRST_HALF

  13117  9 010412   040000 106400                    CMPC    fill='040'O
         9 010413   000007 000004 xsym               ADSC9   OCL_CONSOLE_REC+7        cn=0,n=4
         9 010414   001157 400004 1                  ADSC9   LOGON_REC_ON+6           cn=2,n=4
         9 010415   010467 601000 9                  TNZ     s:13138
         9 010416   040000 106400                    CMPC    fill='040'O
         9 010417   000010 000004 xsym               ADSC9   OCL_CONSOLE_REC+8        cn=0,n=4
         9 010420   001160 400004 1                  ADSC9   LOGON_REC_ON+7           cn=2,n=4
         9 010421   010467 601000 9                  TNZ     s:13138
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:387  

     3026    13118    3           AND OCL_CONSOLE_REC.STATION.SECND_HALF=LOGON_REC_ON.STATION.SECND_HALF
     3027    13119    4         THEN DO;

     3028    13120
     3029    13121    5            IF LOGON_REC_ON.UTS = 0 AND OCL_CONSOLE_REC.STATUS = 0 THEN DO;

  13121  9 010422   001161 235000 1                  LDA     LOGON_REC_ON+8
         9 010423   001162 236000 1                  LDQ     LOGON_REC_ON+9
         9 010424   000022 773000                    LRL     18
         9 010425   000000 116003                    CMPQ    0,DU
         9 010426   010443 601000 9                  TNZ     s:13128
         9 010427   000012 235000 xsym               LDA     OCL_CONSOLE_REC+10
         9 010430   000013 236000 xsym               LDQ     OCL_CONSOLE_REC+11
         9 010431   000043 773000                    LRL     35
         9 010432   000000 116003                    CMPQ    0,DU
         9 010433   010443 601000 9                  TNZ     s:13128

     3030    13122    5               LRECS = 1;

  13122  9 010434   000001 235007                    LDA     1,DL
         9 010435   000672 755000 1                  STA     LRECS

     3031    13123    5               USE_LINDEX = %NO#;

  13123  9 010436   000671 450000 1                  STZ     USE_LINDEX

     3032    13124    5               CALL WRITE_LSTACK;

  13124  9 010437   010503 701000 9                  TSX1    WRITE_LSTACK
         9 010440   000000 011000                    NOP     0

     3033    13125    5               RETURN;

  13125  9 010441   200010 221300                    LDX1  ! IOPT+3,,AUTO
         9 010442   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:388  
     3034    13126    5            END;
     3035    13127
     3036    13128    4            ELSE IF LOGON_REC_ON.UTS = 0 AND OCL_CONSOLE_REC.STATUS = 1

  13128  9 010443   001161 235000 1                  LDA     LOGON_REC_ON+8
         9 010444   001162 236000 1                  LDQ     LOGON_REC_ON+9
         9 010445   000022 773000                    LRL     18
         9 010446   000000 116003                    CMPQ    0,DU
         9 010447   010457 601000 9                  TNZ     s:13132
         9 010450   000012 235000 xsym               LDA     OCL_CONSOLE_REC+10
         9 010451   000013 236000 xsym               LDQ     OCL_CONSOLE_REC+11
         9 010452   000043 773000                    LRL     35
         9 010453   000001 116007                    CMPQ    1,DL
         9 010454   010457 601000 9                  TNZ     s:13132

     3037    13129    4            THEN RETURN;    /* Record says "He's logged on, but I don't know when"

  13129  9 010455   200010 221300                    LDX1  ! IOPT+3,,AUTO
         9 010456   000001 702211                    TSX2  ! 1,X1

     3038    13130                                    and we already knew at least that much about him. */
     3039    13131    5            ELSE DO;

     3040    13132    5               LRECS = 2;

  13132  9 010457   000002 235007                    LDA     2,DL
         9 010460   000672 755000 1                  STA     LRECS

     3041    13133    5               USE_LINDEX = %YES#;

  13133  9 010461   400000 236003                    LDQ     -131072,DU
         9 010462   000671 756000 1                  STQ     USE_LINDEX

     3042    13134    5               CALL WRITE_LSTACK;

  13134  9 010463   010503 701000 9                  TSX1    WRITE_LSTACK
         9 010464   000000 011000                    NOP     0
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:389  

     3043    13135    5               RETURN;

  13135  9 010465   200010 221300                    LDX1  ! IOPT+3,,AUTO
         9 010466   000001 702211                    TSX2  ! 1,X1

     3044    13136    5            END;
     3045    13137    4         END /* if console_rec=logon_rec */;
     3046    13138    3      END /* loop */;

  13138  9 010467   000001 336007                    LCQ     1,DL
         9 010470   000670 056000 1                  ASQ     L
         9 010471   000670 235000 1                  LDA     L
         9 010472   010404 605000 9                  TPL     s:13115

     3047    13139
     3048    13140    2      LRECS = 2;

  13140  9 010473   000002 236007                    LDQ     2,DL
         9 010474   000672 756000 1                  STQ     LRECS

     3049    13141    2      USE_LINDEX = %YES#;

  13141  9 010475   400000 236003                    LDQ     -131072,DU
         9 010476   000671 756000 1                  STQ     USE_LINDEX

     3050    13142    2      CALL WRITE_LSTACK;

  13142  9 010477   010503 701000 9                  TSX1    WRITE_LSTACK
         9 010500   000000 011000                    NOP     0

     3051    13143    2      RETURN;

  13143  9 010501   200010 221300                    LDX1  ! IOPT+3,,AUTO
         9 010502   000001 702211                    TSX2  ! 1,X1

     3052    13144
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:390  
     3053    13145    2   END ADD_TO_LOGON_STACK;
     3054    13146        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:391  
     3055    13147        /*           S U B R O U T I N E   W R I T E _ L S T A C K                    */
     3056    13148
     3057    13149    1   WRITE_LSTACK: PROC;

  13149  9 010503   200012 741300       WRITE_LSTACK STX1  ! IOPT+5,,AUTO

     3058    13150    2      LOGON_REC_ON.TERM_NAME = OCL_CONSOLE_REC.TERM_NAME;

  13150  9 010504   040000 100400                    MLR     fill='040'O
         9 010505   000000 000010 xsym               ADSC9   OCL_CONSOLE_REC          cn=0,n=8
         9 010506   001151 000010 1                  ADSC9   LOGON_REC_ON             cn=0,n=8

     3059    13151    2      LOGON_REC_ON.WSN = OCL_CONSOLE_REC.WSN;

  13151  9 010507   040000 100400                    MLR     fill='040'O
         9 010510   000002 000010 xsym               ADSC9   OCL_CONSOLE_REC+2        cn=0,n=8
         9 010511   001153 000010 1                  ADSC9   LOGON_REC_ON+2           cn=0,n=8

     3060    13152    2      LOGON_REC_ON.ATTRO = OCL_CONSOLE_REC.ATTRO;

  13152  9 010512   000004 720000 xsym               LXL0    OCL_CONSOLE_REC+4
         9 010513   001155 740000 1                  STX0    LOGON_REC_ON+4

     3061    13153    2      LOGON_REC_ON.LOGON = OCL_CONSOLE_REC.LOGON;

  13153  9 010514   040000 100400                    MLR     fill='040'O
         9 010515   000005 000010 xsym               ADSC9   OCL_CONSOLE_REC+5        cn=0,n=8
         9 010516   001155 400010 1                  ADSC9   LOGON_REC_ON+4           cn=2,n=8

     3062    13154    2      LOGON_TITLE = ' ';

  13154  9 010517   040000 100400                    MLR     fill='040'O
         9 010520   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 010521   000713 000110 1                  ADSC9   LOGON_TITLE              cn=0,n=72

     3063    13155    2      LOGON_REC_ON.STATION.FIRST_HALF = OCL_CONSOLE_REC.STATION.FIRST_HALF;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:392  
  13155  9 010522   040000 100400                    MLR     fill='040'O
         9 010523   000007 000004 xsym               ADSC9   OCL_CONSOLE_REC+7        cn=0,n=4
         9 010524   001157 400004 1                  ADSC9   LOGON_REC_ON+6           cn=2,n=4

     3064    13156    2      LOGON_REC_ON.STATION.SECND_HALF = OCL_CONSOLE_REC.STATION.SECND_HALF;

  13156  9 010525   040000 100400                    MLR     fill='040'O
         9 010526   000010 000004 xsym               ADSC9   OCL_CONSOLE_REC+8        cn=0,n=4
         9 010527   001160 400004 1                  ADSC9   LOGON_REC_ON+7           cn=2,n=4

     3065    13157    2      LOGON_REC_ON.UTS = OCL_CONSOLE_REC.UTS;

  13157  9 010530   000000 100400                    MLR     fill='000'O
         9 010531   000011 000004 xsym               ADSC9   OCL_CONSOLE_REC+9        cn=0,n=4
         9 010532   001161 400004 1                  ADSC9   LOGON_REC_ON+8           cn=2,n=4

     3066    13158    2      LOGON_REC_ON.STATUS = OCL_CONSOLE_REC.STATUS;

  13158  9 010533   003000 060400                    CSL     bolr='003'O
         9 010534   000012 010044 xsym               BDSC    OCL_CONSOLE_REC+10       by=0,bit=1,n=36
         9 010535   001162 400044 1                  BDSC    LOGON_REC_ON+9           by=2,bit=0,n=36

     3067    13159
     3068    13160
     3069    13161    3      IF FREE_SPACE < 30 THEN DO;

  13161  9 010536   000707 235000 1                  LDA     FREE_SPACE
         9 010537   000036 115007                    CMPA    30,DL
         9 010540   010553 605000 9                  TPL     s:13167

     3070    13162    4         CALL M$GDS (GET_LSTACK_SEG) WHENALTRETURN DO; END;

  13162  9 010541   002072 630400 1                  EPPR0   GET_LSTACK_SEG
         9 010542   430001 713400                    CLIMB   alt,gds
         9 010543   400400 401760                    pmme    nvectors=2
         9 010544   010546 702000 9                  TSX2    s:13163
         9 010545   010546 710000 9                  TRA     s:13163
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:393  

     3071    13163    3         FREE_SPACE = 1024;

  13163  9 010546   002000 235007                    LDA     1024,DL
         9 010547   000707 755000 1                  STA     FREE_SPACE

     3072    13164    3         PAGES = PAGES + 1;

  13164  9 010550   000710 236000 1                  LDQ     PAGES
         9 010551   000001 036007                    ADLQ    1,DL
         9 010552   000710 756000 1                  STQ     PAGES

     3073    13165    3      END;

     3074    13166
     3075    13167    3      IF USE_LINDEX THEN DO;

  13167  9 010553   000671 234000 1                  SZN     USE_LINDEX
         9 010554   010567 605000 9                  TPL     s:13173

     3076    13168    3         LSTACK_RESULTS_VEC.PTR$ -> LSTACK(LINDEX) = LOGON_REC_ON;

  13168  9 010555   000667 236000 1                  LDQ     LINDEX
         9 010556   000052 402007                    MPY     42,DL
         9 010557   002101 470400 1                  LDP0    LSTACK_RESULTS_VEC+1
         9 010560   000106 100400                    MLR     fill='000'O
         9 010561   001151 000052 1                  ADSC9   LOGON_REC_ON             cn=0,n=42
         9 010562   000000 000052                    ADSC9   0,Q,PR0                  cn=0,n=42

     3077    13169    3         LINDEX = LINDEX + 1;

  13169  9 010563   000667 054000 1                  AOS     LINDEX

     3078    13170    3         FREE_SPACE = FREE_SPACE - 11;

  13170  9 010564   000013 336007                    LCQ     11,DL
         9 010565   000707 056000 1                  ASQ     FREE_SPACE
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:394  

     3079    13171    3      END;

  13171  9 010566   010575 710000 9                  TRA     s:13175

     3080    13172    2      ELSE
     3081    13173    2      LSTACK_RESULTS_VEC.PTR$ -> LSTACK(L) = LOGON_REC_ON;

  13173  9 010567   000670 236000 1                  LDQ     L
         9 010570   000052 402007                    MPY     42,DL
         9 010571   002101 470400 1                  LDP0    LSTACK_RESULTS_VEC+1
         9 010572   000106 100400                    MLR     fill='000'O
         9 010573   001151 000052 1                  ADSC9   LOGON_REC_ON             cn=0,n=42
         9 010574   000000 000052                    ADSC9   0,Q,PR0                  cn=0,n=42

     3082    13174
     3083    13175    3      IF LRECS = 2 THEN DO;

  13175  9 010575   000672 235000 1                  LDA     LRECS
         9 010576   000002 115007                    CMPA    2,DL
         9 010577   010614 601000 9                  TNZ     s:13181

     3084    13176    3         LOGON_REC_ON.UTS = 0;

  13176  9 010600   000000 100400                    MLR     fill='000'O
         9 010601   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         9 010602   001161 400004 1                  ADSC9   LOGON_REC_ON+8           cn=2,n=4

     3085    13177    3         LSTACK_RESULTS_VEC.PTR$ -> LSTACK(LINDEX) = LOGON_REC_ON;

  13177  9 010603   000667 236000 1                  LDQ     LINDEX
         9 010604   000052 402007                    MPY     42,DL
         9 010605   002101 470400 1                  LDP0    LSTACK_RESULTS_VEC+1
         9 010606   000106 100400                    MLR     fill='000'O
         9 010607   001151 000052 1                  ADSC9   LOGON_REC_ON             cn=0,n=42
         9 010610   000000 000052                    ADSC9   0,Q,PR0                  cn=0,n=42

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:395  
     3086    13178    3         LINDEX = LINDEX + 1;

  13178  9 010611   000667 054000 1                  AOS     LINDEX

     3087    13179    3         FREE_SPACE = FREE_SPACE - 11;

  13179  9 010612   000013 336007                    LCQ     11,DL
         9 010613   000707 056000 1                  ASQ     FREE_SPACE

     3088    13180    3      END;

     3089    13181    2      RETURN;

  13181  9 010614   200012 221300                    LDX1  ! IOPT+5,,AUTO
         9 010615   000001 702211                    TSX2  ! 1,X1

     3090    13182    2   END WRITE_LSTACK;
     3091    13183        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:396  
     3092    13184         /*
     3093    13185                  S U B R O U T I N E   B U I L D _ A T T R _ S T A C K
     3094    13186                                                */
     3095    13187
     3096    13188    1   BUILD_ATTR_STACK: PROC;

  13188  9 010616   200004 741300       BUILD_ATTR_* STX1  ! TEMP_UTS+1,,AUTO

     3097    13189    2      L = 0;

  13189  9 010617   000670 450000 1                  STZ     L

     3098    13190    2      A_INDEX = 0;

  13190  9 010620   000673 450000 1                  STZ     A_INDEX

     3099    13191    2      IF LINDEX = 0 THEN RETURN;

  13191  9 010621   000667 235000 1                  LDA     LINDEX
         9 010622   010624 601000 9                  TNZ     BEGIN

  13191  9 010623   000001 702211                    TSX2  ! 1,X1

  13191  9 010624                       BEGIN        null
     3100    13192    2   BEGIN:;
     3101    13193    2      LOGON_REC_ON = LSTACK_RESULTS_VEC.PTR$ -> LSTACK(L);

  13193  9 010624   000670 236000 1                  LDQ     L
         9 010625   000052 402007                    MPY     42,DL
         9 010626   002101 470400 1                  LDP0    LSTACK_RESULTS_VEC+1
         9 010627   000000 100506                    MLR     fill='000'O
         9 010630   000000 000052                    ADSC9   0,Q,PR0                  cn=0,n=42
         9 010631   001151 000052 1                  ADSC9   LOGON_REC_ON             cn=0,n=42

     3102    13194    2      L = L + 1;

  13194  9 010632   000670 054000 1                  AOS     L
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:397  

     3103    13195    2      LOGON_REC_OFF = LSTACK_RESULTS_VEC.PTR$ -> LSTACK(L);

  13195  9 010633   000670 236000 1                  LDQ     L
         9 010634   000052 402007                    MPY     42,DL
         9 010635   000000 100506                    MLR     fill='000'O
         9 010636   000000 000052                    ADSC9   0,Q,PR0                  cn=0,n=42
         9 010637   001164 000052 1                  ADSC9   LOGON_REC_OFF            cn=0,n=42

     3104    13196    2      L = L + 1;

  13196  9 010640   000670 054000 1                  AOS     L

     3105    13197
     3106    13198    2      IF OCL_NORM_KEY.UTS >= LOGON_REC_ON.UTS

  13198  9 010641   001161 235000 1                  LDA     LOGON_REC_ON+8
         9 010642   001162 236000 1                  LDQ     LOGON_REC_ON+9
         9 010643   000022 773000                    LRL     18
         9 010644   200014 756100                    STQ     IOPT+7,,AUTO
         9 010645   000000 235000 xsym               LDA     OCL_NORM_KEY
         9 010646   000001 236000 xsym               LDQ     OCL_NORM_KEY+1
         9 010647   000033 773000                    LRL     27
         9 010650   200014 116100                    CMPQ    IOPT+7,,AUTO
         9 010651   010711 602000 9                  TNC     s:13209
         9 010652   200015 756100                    STQ     IOPT+8,,AUTO
         9 010653   001174 235000 1                  LDA     LOGON_REC_OFF+8
         9 010654   001175 236000 1                  LDQ     LOGON_REC_OFF+9
         9 010655   000022 773000                    LRL     18
         9 010656   200015 116100                    CMPQ    IOPT+8,,AUTO
         9 010657   010662 603000 9                  TRC     s:13201
         9 010660   000000 116003                    CMPQ    0,DU
         9 010661   010711 601000 9                  TNZ     s:13209

     3107    13199    2        AND ((OCL_NORM_KEY.UTS <= LOGON_REC_OFF.UTS)
     3108    13200    3        OR LOGON_REC_OFF.UTS = 0) THEN DO;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:398  
     3109    13201    3         A_INDEX = A_INDEX + 1;

  13201  9 010662   000673 235000 1                  LDA     A_INDEX
         9 010663   000001 035007                    ADLA    1,DL
         9 010664   000673 755000 1                  STA     A_INDEX

     3110    13202    3         ATTR_REC.ATTRO = LOGON_REC_ON.ATTRO;

  13202  9 010665   001155 220000 1                  LDX0    LOGON_REC_ON+4
         9 010666   001177 740000 1                  STX0    ATTR_REC

     3111    13203    3         ATTR_REC.WSN = LOGON_REC_ON.WSN;

  13203  9 010667   040000 100400                    MLR     fill='040'O
         9 010670   001153 000010 1                  ADSC9   LOGON_REC_ON+2           cn=0,n=8
         9 010671   001177 400010 1                  ADSC9   ATTR_REC                 cn=2,n=8

     3112    13204    3         ATTR_REC.TERMINAL = LOGON_REC_ON.TERM_NAME;

  13204  9 010672   040000 100400                    MLR     fill='040'O
         9 010673   001151 000010 1                  ADSC9   LOGON_REC_ON             cn=0,n=8
         9 010674   001201 400010 1                  ADSC9   ATTR_REC+2               cn=2,n=8

     3113    13205    3         ATTR_REC.STATION.FIRST_HALF = LOGON_REC_ON.STATION.FIRST_HALF;

  13205  9 010675   040000 100400                    MLR     fill='040'O
         9 010676   001157 400004 1                  ADSC9   LOGON_REC_ON+6           cn=2,n=4
         9 010677   001203 400004 1                  ADSC9   ATTR_REC+4               cn=2,n=4

     3114    13206    3         ATTR_REC.STATION.SECND_HALF = LOGON_REC_ON.STATION.SECND_HALF;

  13206  9 010700   040000 100400                    MLR     fill='040'O
         9 010701   001160 400004 1                  ADSC9   LOGON_REC_ON+7           cn=2,n=4
         9 010702   001204 400004 1                  ADSC9   ATTR_REC+5               cn=2,n=4

     3115    13207    3         ASTACK_RESULTS_VEC.PTR$ -> ASTACK (A_INDEX) = ATTR_REC;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:399  
  13207  9 010703   000673 236000 1                  LDQ     A_INDEX
         9 010704   000032 402007                    MPY     26,DL
         9 010705   002117 471400 1                  LDP1    ASTACK_RESULTS_VEC+1
         9 010706   000106 100400                    MLR     fill='000'O
         9 010707   001177 000032 1                  ADSC9   ATTR_REC                 cn=0,n=26
         9 010710   100000 000032                    ADSC9   0,Q,PR1                  cn=0,n=26

     3116    13208    3      END;

     3117    13209    2      IF L < (LINDEX - 1) THEN GOTO BEGIN;

  13209  9 010711   000667 236000 1                  LDQ     LINDEX
         9 010712   000001 136007                    SBLQ    1,DL
         9 010713   000670 116000 1                  CMPQ    L
         9 010714   010624 605400 9                  TPNZ    BEGIN

     3118    13210    2   END BUILD_ATTR_STACK;

  13210  9 010715   200004 221300                    LDX1  ! TEMP_UTS+1,,AUTO
         9 010716   000001 702211                    TSX2  ! 1,X1

     3119    13211        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:400  
     3120    13212
     3121    13213         /*           SUBROUTINE   DISPLAY_LOGONS                                     */
     3122    13214
     3123    13215    1   DISPLAY_LOGONS: PROC;

  13215  9 010717   200004 741300       DISPLAY_LOG* STX1  ! TEMP_UTS+1,,AUTO

     3124    13216    2      CALL INSERT (LOGON_TITLE, 2, 6, 'LOGON');

  13216  9 010720   040000 100400                    MLR     fill='040'O
         9 010721   000134 000005 8                  ADSC9   MOP_8_DIGITS_3+91        cn=0,n=5
         9 010722   000713 400006 1                  ADSC9   LOGON_TITLE              cn=2,n=6

     3125    13217    2      CALL INSERT (LOGON_TITLE, 18, 7, 'CONSOLE');

  13217  9 010723   040000 100400                    MLR     fill='040'O
         9 010724   000136 000007 8                  ADSC9   MOP_8_DIGITS_3+93        cn=0,n=7
         9 010725   000717 400007 1                  ADSC9   LOGON_TITLE+4            cn=2,n=7

     3126    13218    2      CALL INSERT (LOGON_TITLE, 41, 2, 'ON');

  13218  9 010726   000140 236000 8                  LDQ     MOP_8_DIGITS_3+95
         9 010727   000011 772000                    QRL     9
         9 010730   000725 552030 1                  STBQ    LOGON_TITLE+10,'30'O

     3127    13219    2      CALL INSERT (LOGON_TITLE, 64, 3, 'OFF');

  13219  9 010731   000141 236000 8                  LDQ     MOP_8_DIGITS_3+96
         9 010732   000733 552070 1                  STBQ    LOGON_TITLE+16,'70'O

     3128    13220    2      MSG = LOGON_TITLE;

  13220  9 010733   040000 100400                    MLR     fill='040'O
         9 010734   000713 000110 1                  ADSC9   LOGON_TITLE              cn=0,n=72
         9 010735   000427 000400 1                  ADSC9   MSG                      cn=0,n=256

     3129    13221    2      OUT_MSG.BUF_.BOUND = 72;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:401  

  13221  9 010736   001704 236000 1                  LDQ     OUT_MSG+4
         9 010737   177777 376007                    ANQ     65535,DL
         9 010740   000022 276003                    ORQ     18,DU
         9 010741   001704 756000 1                  STQ     OUT_MSG+4

     3130    13222    3      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;

  13222  9 010742   001700 630400 1                  EPPR0   OUT_MSG
         9 010743   440001 713400                    CLIMB   alt,write
         9 010744   401400 401760                    pmme    nvectors=4
         9 010745   010747 702000 9                  TSX2    s:13224
         9 010746   010747 710000 9                  TRA     s:13224

     3131    13223
     3132    13224    3      DO L = 0 TO LINDEX - 1 BY 2;

  13224  9 010747   000670 450000 1                  STZ     L
         9 010750   011324 710000 9                  TRA     NO_MATCH+2

     3133    13225    3         LOGON_REC_ON = LSTACK_RESULTS_VEC.PTR$ -> LSTACK(L);

  13225  9 010751   000670 236000 1                  LDQ     L
         9 010752   000052 402007                    MPY     42,DL
         9 010753   002101 470400 1                  LDP0    LSTACK_RESULTS_VEC+1
         9 010754   000000 100506                    MLR     fill='000'O
         9 010755   000000 000052                    ADSC9   0,Q,PR0                  cn=0,n=42
         9 010756   001151 000052 1                  ADSC9   LOGON_REC_ON             cn=0,n=42

     3134    13226    3         LOGON_REC_OFF = LSTACK_RESULTS_VEC.PTR$ -> LSTACK (L+1);

  13226  9 010757   000000 100506                    MLR     fill='000'O
         9 010760   000012 400052                    ADSC9   10,Q,PR0                 cn=2,n=42
         9 010761   001164 000052 1                  ADSC9   LOGON_REC_OFF            cn=0,n=42

     3135    13227
     3136    13228    3         IF CONSOLE = '?' AND LOCATION ~= '?'
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:402  

  13228  9 010762   000270 236000 1                  LDQ     CONSOLE
         9 010763   000016 116000 10                 CMPQ    14
         9 010764   010777 601000 9                  TNZ     s:13231
         9 010765   040000 106400                    CMPC    fill='040'O
         9 010766   000271 000010 1                  ADSC9   LOCATION                 cn=0,n=8
         9 010767   000016 000001 10                 ADSC9   14                       cn=0,n=1
         9 010770   010777 600000 9                  TZE     s:13231
         9 010771   040000 106400                    CMPC    fill='040'O
         9 010772   000271 000010 1                  ADSC9   LOCATION                 cn=0,n=8
         9 010773   001151 000010 1                  ADSC9   LOGON_REC_ON             cn=0,n=8
         9 010774   010777 601000 9                  TNZ     s:13231

     3137    13229    3           AND LOCATION = LOGON_REC_ON.TERM_NAME THEN PERFORM_CALL = %YES#;

  13229  9 010775   400000 236003                    LDQ     -131072,DU
         9 010776   000677 756000 1                  STQ     PERFORM_CALL

     3138    13230
     3139    13231    3         IF CONSOLE ~= '?' AND LOCATION = '?'

  13231  9 010777   000270 236000 1                  LDQ     CONSOLE
         9 011000   000016 116000 10                 CMPQ    14
         9 011001   011014 600000 9                  TZE     s:13234
         9 011002   040000 106400                    CMPC    fill='040'O
         9 011003   000271 000010 1                  ADSC9   LOCATION                 cn=0,n=8
         9 011004   000016 000001 10                 ADSC9   14                       cn=0,n=1
         9 011005   011014 601000 9                  TNZ     s:13234
         9 011006   040000 106400                    CMPC    fill='040'O
         9 011007   000270 000004 1                  ADSC9   CONSOLE                  cn=0,n=4
         9 011010   001157 400004 1                  ADSC9   LOGON_REC_ON+6           cn=2,n=4
         9 011011   011014 601000 9                  TNZ     s:13234

     3140    13232    3           AND CONSOLE = LOGON_REC_ON.STATION.FIRST_HALF THEN PERFORM_CALL = %YES#;

  13232  9 011012   400000 236003                    LDQ     -131072,DU
         9 011013   000677 756000 1                  STQ     PERFORM_CALL
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:403  

     3141    13233
     3142    13234    3         IF CONSOLE ~= '?' AND LOCATION ~= '?'

  13234  9 011014   000270 236000 1                  LDQ     CONSOLE
         9 011015   000016 116000 10                 CMPQ    14
         9 011016   011035 600000 9                  TZE     s:13238
         9 011017   040000 106400                    CMPC    fill='040'O
         9 011020   000271 000010 1                  ADSC9   LOCATION                 cn=0,n=8
         9 011021   000016 000001 10                 ADSC9   14                       cn=0,n=1
         9 011022   011035 600000 9                  TZE     s:13238
         9 011023   040000 106400                    CMPC    fill='040'O
         9 011024   000270 000004 1                  ADSC9   CONSOLE                  cn=0,n=4
         9 011025   001157 400004 1                  ADSC9   LOGON_REC_ON+6           cn=2,n=4
         9 011026   011035 601000 9                  TNZ     s:13238
         9 011027   040000 106400                    CMPC    fill='040'O
         9 011030   000271 000010 1                  ADSC9   LOCATION                 cn=0,n=8
         9 011031   001151 000010 1                  ADSC9   LOGON_REC_ON             cn=0,n=8
         9 011032   011035 601000 9                  TNZ     s:13238

     3143    13235    3           AND CONSOLE = LOGON_REC_ON.STATION.FIRST_HALF
     3144    13236    3           AND LOCATION = LOGON_REC_ON.TERM_NAME THEN PERFORM_CALL = %YES#;

  13236  9 011033   400000 236003                    LDQ     -131072,DU
         9 011034   000677 756000 1                  STQ     PERFORM_CALL

     3145    13237
     3146    13238    3         IF LOGON ~= '?' AND LOGON = LOGON_REC_ON.LOGON THEN PERFORM_CALL = %YES#;

  13238  9 011035   000276 237000 1                  LDAQ    LOGON
         9 011036   000016 117000 10                 CMPAQ   14
         9 011037   011046 600000 9                  TZE     s:13240
         9 011040   040000 106400                    CMPC    fill='040'O
         9 011041   000276 000010 1                  ADSC9   LOGON                    cn=0,n=8
         9 011042   001155 400010 1                  ADSC9   LOGON_REC_ON+4           cn=2,n=8
         9 011043   011046 601000 9                  TNZ     s:13240

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:404  
  13238  9 011044   400000 236003                    LDQ     -131072,DU
         9 011045   000677 756000 1                  STQ     PERFORM_CALL

     3147    13239
     3148    13240    4         IF WSTATION ~= '?' THEN DO;

  13240  9 011046   000274 237000 1                  LDAQ    WSTATION
         9 011047   000016 117000 10                 CMPAQ   14
         9 011050   011064 600000 9                  TZE     s:13245

     3149    13241    4            CALL INDEX (W, '?', LOGON_REC_ON.WSN);

  13241  9 011051   000000 124400                    SCM     mask='000'O
         9 011052   001153 000010 1                  ADSC9   LOGON_REC_ON+2           cn=0,n=8
         9 011053   000016 000001 10                 ADSC9   14                       cn=0,n=1
         9 011054   000751 000000 1                  ARG     W

     3150    13242    4            IF SUBSTR (LOGON_REC_ON.WSN, 0, W) = SUBSTR (WSTATION, 0, W) THEN
             13242                     PERFORM_CALL = %YES#;

  13242  9 011055   000751 720000 1                  LXL0    W
         9 011056   040040 106440                    CMPC    fill='040'O
         9 011057   001153 000010 1                  ADSC9   LOGON_REC_ON+2           cn=0,n=*X0
         9 011060   000274 000010 1                  ADSC9   WSTATION                 cn=0,n=*X0
         9 011061   011064 601000 9                  TNZ     s:13245

  13242  9 011062   400000 236003                    LDQ     -131072,DU
         9 011063   000677 756000 1                  STQ     PERFORM_CALL

     3151    13243    4         END;

     3152    13244
     3153    13245    3         IF LOGON_REPORT AND ALL THEN PERFORM_CALL = %YES#;

  13245  9 011064   000711 234000 1                  SZN     LOGON_REPORT
         9 011065   011072 605000 9                  TPL     s:13247
         9 011066   000666 234000 1                  SZN     ALL
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:405  
         9 011067   011072 605000 9                  TPL     s:13247

  13245  9 011070   400000 236003                    LDQ     -131072,DU
         9 011071   000677 756000 1                  STQ     PERFORM_CALL

     3154    13246
     3155    13247    4         IF PERFORM_CALL THEN DO;

  13247  9 011072   000677 234000 1                  SZN     PERFORM_CALL
         9 011073   011322 605000 9                  TPL     NO_MATCH

     3156    13248    4            PERFORM_CALL = %NO#;

  13248  9 011074   000677 450000 1                  STZ     PERFORM_CALL

     3157    13249    4            IF (LOGON_REC_ON.UTS < BEGINNING_TIME

  13249  9 011075   001161 235000 1                  LDA     LOGON_REC_ON+8
         9 011076   001162 236000 1                  LDQ     LOGON_REC_ON+9
         9 011077   000022 773000                    LRL     18
         9 011100   000300 116000 1                  CMPQ    BEGINNING_TIME
         9 011101   011112 603000 9                  TRC     s:13249+13
         9 011102   001174 235000 1                  LDA     LOGON_REC_OFF+8
         9 011103   001175 236000 1                  LDQ     LOGON_REC_OFF+9
         9 011104   000022 773000                    LRL     18
         9 011105   000301 116000 1                  CMPQ    ENDING_TIME
         9 011106   011110 600000 9                  TZE     s:13249+11
         9 011107   011322 603000 9                  TRC     NO_MATCH
         9 011110   000000 116003                    CMPQ    0,DU
         9 011111   011322 600000 9                  TZE     NO_MATCH
         9 011112   001161 235000 1                  LDA     LOGON_REC_ON+8
         9 011113   001162 236000 1                  LDQ     LOGON_REC_ON+9
         9 011114   000022 773000                    LRL     18
         9 011115   000300 116000 1                  CMPQ    BEGINNING_TIME
         9 011116   011124 603000 9                  TRC     s:13249+23
         9 011117   001174 235000 1                  LDA     LOGON_REC_OFF+8
         9 011120   001175 236000 1                  LDQ     LOGON_REC_OFF+9
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:406  
         9 011121   000022 773000                    LRL     18
         9 011122   000300 116000 1                  CMPQ    BEGINNING_TIME
         9 011123   011322 602000 9                  TNC     NO_MATCH
         9 011124   001161 235000 1                  LDA     LOGON_REC_ON+8
         9 011125   001162 236000 1                  LDQ     LOGON_REC_ON+9
         9 011126   000022 773000                    LRL     18
         9 011127   000301 116000 1                  CMPQ    ENDING_TIME
         9 011130   011140 602000 9                  TNC     s:13259
         9 011131   011140 600000 9                  TZE     s:13259
         9 011132   001174 235000 1                  LDA     LOGON_REC_OFF+8
         9 011133   001175 236000 1                  LDQ     LOGON_REC_OFF+9
         9 011134   000022 773000                    LRL     18
         9 011135   000301 116000 1                  CMPQ    ENDING_TIME
         9 011136   011140 600000 9                  TZE     s:13259
         9 011137   011322 603000 9                  TRC     NO_MATCH

     3158    13250    4              AND (LOGON_REC_OFF.UTS > ENDING_TIME
     3159    13251    4              OR LOGON_REC_OFF.UTS = 0))
     3160    13252    4              OR
     3161    13253    4              (LOGON_REC_ON.UTS < BEGINNING_TIME
     3162    13254    4              AND LOGON_REC_OFF.UTS < BEGINNING_TIME)
     3163    13255    4              OR
     3164    13256    4              (LOGON_REC_ON.UTS > ENDING_TIME
     3165    13257    4              AND LOGON_REC_OFF.UTS > ENDING_TIME) THEN GOTO NO_MATCH;
     3166    13258
     3167    13259    4            TIME_BUFFER = ' ';

  13259  9 011140   040000 100400                    MLR     fill='040'O
         9 011141   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 011142   000627 000110 1                  ADSC9   TIME_BUFFER              cn=0,n=72

     3168    13260
     3169    13261    4            IF LOGON_REC_ON.UTS >= BEGINNING_TIME

  13261  9 011143   001161 235000 1                  LDA     LOGON_REC_ON+8
         9 011144   001162 236000 1                  LDQ     LOGON_REC_ON+9
         9 011145   000022 773000                    LRL     18
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:407  
         9 011146   000300 116000 1                  CMPQ    BEGINNING_TIME
         9 011147   011203 602000 9                  TNC     s:13271
         9 011150   000301 116000 1                  CMPQ    ENDING_TIME
         9 011151   011153 600000 9                  TZE     s:13263
         9 011152   011203 603000 9                  TRC     s:13271

     3170    13262    5              AND LOGON_REC_ON.UTS <= ENDING_TIME THEN DO;

     3171    13263    5               RANGE_CONV.TSTAMP_ = VECTOR (LOGON_REC_ON.UTS);

  13263  9 011153   000056 237000 10                 LDAQ    46
         9 011154   003044 757000 1                  STAQ    RANGE_CONV+8

     3172    13264    6               CALL M$TIME (RANGE_CONV) WHENALTRETURN DO; END;

  13264  9 011155   003034 630400 1                  EPPR0   RANGE_CONV
         9 011156   420004 713400                    CLIMB   alt,+8196
         9 011157   402000 401760                    pmme    nvectors=5
         9 011160   011162 702000 9                  TSX2    s:13265
         9 011161   011162 710000 9                  TRA     s:13265

     3173    13265    5               IF LOGON_REC_ON.STATUS = 1

  13265  9 011162   001162 235000 1                  LDA     LOGON_REC_ON+9
         9 011163   001163 236000 1                  LDQ     LOGON_REC_ON+10
         9 011164   000022 773000                    LRL     18
         9 011165   000001 116007                    CMPQ    1,DL
         9 011166   011173 601000 9                  TNZ     s:13267

     3174    13266    5               THEN CALL INSERT (TIME_BUFFER, 35, 8, 'PRERANGE');

  13266  9 011167   040000 100400                    MLR     fill='040'O
         9 011170   000142 000010 8                  ADSC9   MOP_8_DIGITS_3+97        cn=0,n=8
         9 011171   000637 600010 1                  ADSC9   TIME_BUFFER+8            cn=3,n=8
         9 011172   011203 710000 9                  TRA     s:13271

     3175    13267    5               ELSE CALL INSERT (TIME_BUFFER, 35, 14,
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:408  

  13267  9 011173   040000 100400                    MLR     fill='040'O
         9 011174   000417 000005 1                  ADSC9   SIM_TIME                 cn=0,n=5
         9 011175   000637 600005 1                  ADSC9   TIME_BUFFER+8            cn=3,n=5
         9 011176   040000 236003                    LDQ     16384,DU
         9 011177   000641 552040 1                  STBQ    TIME_BUFFER+10,'40'O
         9 011200   040000 100400                    MLR     fill='040'O
         9 011201   000415 000010 1                  ADSC9   SIM_DATE                 cn=0,n=8
         9 011202   000641 200010 1                  ADSC9   TIME_BUFFER+10           cn=1,n=8

     3176    13268    5                 SUBSTR (SIM_TIME, 0, 5), ' ', SIM_DATE);
     3177    13269    5            END;

     3178    13270
     3179    13271    4            IF LOGON_REC_ON.UTS < BEGINNING_TIME THEN

  13271  9 011203   001161 235000 1                  LDA     LOGON_REC_ON+8
         9 011204   001162 236000 1                  LDQ     LOGON_REC_ON+9
         9 011205   000022 773000                    LRL     18
         9 011206   000300 116000 1                  CMPQ    BEGINNING_TIME
         9 011207   011213 603000 9                  TRC     s:13274

     3180    13272    4            CALL INSERT (TIME_BUFFER, 35, 8, 'PRERANGE');

  13272  9 011210   040000 100400                    MLR     fill='040'O
         9 011211   000142 000010 8                  ADSC9   MOP_8_DIGITS_3+97        cn=0,n=8
         9 011212   000637 600010 1                  ADSC9   TIME_BUFFER+8            cn=3,n=8

     3181    13273
     3182    13274    4            IF LOGON_REC_ON.UTS > ENDING_TIME THEN

  13274  9 011213   000301 116000 1                  CMPQ    ENDING_TIME
         9 011214   011221 602000 9                  TNC     s:13277
         9 011215   011221 600000 9                  TZE     s:13277

     3183    13275    4            CALL INSERT (TIME_BUFFER, 35, 9, 'POSTRANGE');

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:409  
  13275  9 011216   040000 100400                    MLR     fill='040'O
         9 011217   000144 000011 8                  ADSC9   MOP_8_DIGITS_3+99        cn=0,n=9
         9 011220   000637 600011 1                  ADSC9   TIME_BUFFER+8            cn=3,n=9

     3184    13276
     3185    13277    4            IF LOGON_REC_OFF.UTS >= BEGINNING_TIME

  13277  9 011221   001174 235000 1                  LDA     LOGON_REC_OFF+8
         9 011222   001175 236000 1                  LDQ     LOGON_REC_OFF+9
         9 011223   000022 773000                    LRL     18
         9 011224   000300 116000 1                  CMPQ    BEGINNING_TIME
         9 011225   011250 602000 9                  TNC     s:13284
         9 011226   000301 116000 1                  CMPQ    ENDING_TIME
         9 011227   011231 600000 9                  TZE     s:13279
         9 011230   011250 603000 9                  TRC     s:13284

     3186    13278    5              AND LOGON_REC_OFF.UTS <= ENDING_TIME THEN DO;

     3187    13279    5               RANGE_CONV.TSTAMP_ = VECTOR (LOGON_REC_OFF.UTS);

  13279  9 011231   000060 237000 10                 LDAQ    48
         9 011232   003044 757000 1                  STAQ    RANGE_CONV+8

     3188    13280    6               CALL M$TIME (RANGE_CONV) WHENALTRETURN DO; END;

  13280  9 011233   003034 630400 1                  EPPR0   RANGE_CONV
         9 011234   420004 713400                    CLIMB   alt,+8196
         9 011235   402000 401760                    pmme    nvectors=5
         9 011236   011240 702000 9                  TSX2    s:13281
         9 011237   011240 710000 9                  TRA     s:13281

     3189    13281    5              CALL INSERT (TIME_BUFFER, 57, 14, SUBSTR (SIM_TIME, 0, 5), ' ', SIM_DATE
             13281                        );

  13281  9 011240   040000 100400                    MLR     fill='040'O
         9 011241   000417 000005 1                  ADSC9   SIM_TIME                 cn=0,n=5
         9 011242   000645 200005 1                  ADSC9   TIME_BUFFER+14           cn=1,n=5
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:410  
         9 011243   040000 236007                    LDQ     16384,DL
         9 011244   000646 552010 1                  STBQ    TIME_BUFFER+15,'10'O
         9 011245   040000 100400                    MLR     fill='040'O
         9 011246   000415 000010 1                  ADSC9   SIM_DATE                 cn=0,n=8
         9 011247   000646 600010 1                  ADSC9   TIME_BUFFER+15           cn=3,n=8

     3190    13282    5            END;

     3191    13283
     3192    13284    4            IF LOGON_REC_OFF.UTS < BEGINNING_TIME

  13284  9 011250   001174 235000 1                  LDA     LOGON_REC_OFF+8
         9 011251   001175 236000 1                  LDQ     LOGON_REC_OFF+9
         9 011252   000022 773000                    LRL     18
         9 011253   000300 116000 1                  CMPQ    BEGINNING_TIME
         9 011254   011260 603000 9                  TRC     s:13287

     3193    13285    4            THEN CALL INSERT (TIME_BUFFER, 57, 8, 'PRERANGE');

  13285  9 011255   040000 100400                    MLR     fill='040'O
         9 011256   000142 000010 8                  ADSC9   MOP_8_DIGITS_3+97        cn=0,n=8
         9 011257   000645 200010 1                  ADSC9   TIME_BUFFER+14           cn=1,n=8

     3194    13286
     3195    13287    4            IF LOGON_REC_OFF.UTS > ENDING_TIME

  13287  9 011260   000301 116000 1                  CMPQ    ENDING_TIME
         9 011261   011263 600000 9                  TZE     s:13287+3
         9 011262   011265 603000 9                  TRC     s:13288
         9 011263   000000 116003                    CMPQ    0,DU
         9 011264   011270 601000 9                  TNZ     s:13290

     3196    13288    4              OR LOGON_REC_OFF.UTS = 0 THEN CALL INSERT (TIME_BUFFER, 57, 9,
             13288                       'POSTRANGE');

  13288  9 011265   040000 100400                    MLR     fill='040'O
         9 011266   000144 000011 8                  ADSC9   MOP_8_DIGITS_3+99        cn=0,n=9
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:411  
         9 011267   000645 200011 1                  ADSC9   TIME_BUFFER+14           cn=1,n=9

     3197    13289
     3198    13290    4            WRITE_TIME.BUF_.BOUND =

  13290  9 011270   002226 236000 1                  LDQ     WRITE_TIME+4
         9 011271   177777 376007                    ANQ     65535,DL
         9 011272   000053 276000 10                 ORQ     43
         9 011273   002226 756000 1                  STQ     WRITE_TIME+4

     3199    13291    4              LENGTHC (LOGON_REC_ON.STATION.FIRST_HALF)
     3200    13292    4              + LENGTHC ('@')
     3201    13293    4              + LENGTHC (LOGON_REC_ON.TERM_NAME)
     3202    13294    4              + LENGTHC (LOGON_REC_ON.LOGON)
     3203    13295    4              + LENGTHC ('  ')
     3204    13296    4              + LENGTHC (SUBSTR (SIM_TIME, 0, 5))
     3205    13297    4              + LENGTHC (SIM_DATE)
     3206    13298    4              + LENGTHC ('      ')
     3207    13299    4              + LENGTHC (SUBSTR (SIM_TIME, 0, 5))
     3208    13300    4              + LENGTHC (SIM_DATE);
     3209    13301
     3210    13302    4            PRINT_FLAG = %YES#;

  13302  9 011274   400000 236003                    LDQ     -131072,DU
         9 011275   000306 756000 1                  STQ     PRINT_FLAG

     3211    13303
     3212    13304    4            CALL INSERT (TIME_BUFFER, 0, 8, LOGON_REC_ON.LOGON);

  13304  9 011276   040000 100400                    MLR     fill='040'O
         9 011277   001155 400010 1                  ADSC9   LOGON_REC_ON+4           cn=2,n=8
         9 011300   000627 000010 1                  ADSC9   TIME_BUFFER              cn=0,n=8

     3213    13305    4            CALL INSERT (TIME_BUFFER, 15, 13, LOGON_REC_ON.STATION.FIRST_HALF, '@',
             13305                     LOGON_REC_ON.TERM_NAME);

  13305  9 011301   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:412  
         9 011302   001157 400004 1                  ADSC9   LOGON_REC_ON+6           cn=2,n=4
         9 011303   000632 600004 1                  ADSC9   TIME_BUFFER+3            cn=3,n=4
         9 011304   000100 236007                    LDQ     64,DL
         9 011305   000633 552004 1                  STBQ    TIME_BUFFER+4,'04'O
         9 011306   040000 100400                    MLR     fill='040'O
         9 011307   001151 000010 1                  ADSC9   LOGON_REC_ON             cn=0,n=8
         9 011310   000634 000010 1                  ADSC9   TIME_BUFFER+5            cn=0,n=8

     3214    13306    4            WRITE_TIME.BUF_.BOUND = 70;

  13306  9 011311   002226 236000 1                  LDQ     WRITE_TIME+4
         9 011312   177777 376007                    ANQ     65535,DL
         9 011313   000062 276000 10                 ORQ     50
         9 011314   002226 756000 1                  STQ     WRITE_TIME+4

     3215    13307    5            CALL M$WRITE (WRITE_TIME) WHENALTRETURN DO; END;

  13307  9 011315   002222 630400 1                  EPPR0   WRITE_TIME
         9 011316   440001 713400                    CLIMB   alt,write
         9 011317   401400 401760                    pmme    nvectors=4
         9 011320   011322 702000 9                  TSX2    NO_MATCH
         9 011321   011322 710000 9                  TRA     NO_MATCH

     3216    13308    4         END;

  13306  9 011322                       NO_MATCH     null
     3217    13309    3   NO_MATCH: ;
     3218    13310    3      END;

  13310  9 011322   000002 236007                    LDQ     2,DL
         9 011323   000670 056000 1                  ASQ     L
         9 011324   000670 236000 1                  LDQ     L
         9 011325   000667 116000 1                  CMPQ    LINDEX
         9 011326   010751 604000 9                  TMI     s:13225

     3219    13311    2   END DISPLAY_LOGONS;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:413  
  13311  9 011327   200004 221300                    LDX1  ! TEMP_UTS+1,,AUTO
         9 011330   000001 702211                    TSX2  ! 1,X1

     3220    13312        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:414  
     3221    13313
     3222    13314         /*           S U B R O U T I N E   G A T H E R _ C _ S T A T S
             13314                      */
     3223    13315
     3224    13316    1   GATHER_C_STATS: PROC;

  13316  9 011331   200004 741300       GATHER_C_ST* STX1  ! TEMP_UTS+1,,AUTO

     3225    13317    2      IF OCL_HIST_BUF.TYPE < 2 THEN RETURN;

  13317  9 011332   000012 236000 xsym               LDQ     OCL_HIST_BUF+10
         9 011333   000777 376007                    ANQ     511,DL
         9 011334   000002 116007                    CMPQ    2,DL
         9 011335   011337 603000 9                  TRC     s:13319

  13317  9 011336   000001 702211                    TSX2  ! 1,X1

     3226    13318
     3227    13319    3      IF FIRST_TIME THEN DO;

  13319  9 011337   000736 234000 1                  SZN     FIRST_TIME
         9 011340   011344 605000 9                  TPL     s:13325

     3228    13320    3         KEYIN_TOTAL = 0;

  13320  9 011341   000743 450000 1                  STZ     KEYIN_TOTAL

     3229    13321    3         CINDEX = 0;

  13321  9 011342   000742 450000 1                  STZ     CINDEX

     3230    13322    3         GOTO SKIP_TEST;

  13322  9 011343   011405 710000 9                  TRA     SKIP_TEST

     3231    13323    3      END;
     3232    13324
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:415  
     3233    13325    2      FOUND_IT = %NO#;

  13325  9 011344   000735 450000 1                  STZ     FOUND_IT

     3234    13326    3      DO C = 0 TO CINDEX;

  13326  9 011345   000741 450000 1                  STZ     C
         9 011346   011402 710000 9                  TRA     s:13336+3

     3235    13327    3         CONS_RECORD = CSTACK_RESULTS_VEC.PTR$ -> CSTACK (C);

  13327  9 011347   000741 236000 1                  LDQ     C
         9 011350   000025 402007                    MPY     21,DL
         9 011351   002135 470400 1                  LDP0    CSTACK_RESULTS_VEC+1
         9 011352   000000 100506                    MLR     fill='000'O
         9 011353   000000 000025                    ADSC9   0,Q,PR0                  cn=0,n=21
         9 011354   001206 000025 1                  ADSC9   CONS_RECORD              cn=0,n=21

     3236    13328
     3237    13329    3         IF OCL_HIST_BUF.DEVNM = CONS_RECORD.DEVNM

  13329  9 011355   000005 236000 xsym               LDQ     OCL_HIST_BUF+5
         9 011356   001210 116000 1                  CMPQ    CONS_RECORD+2
         9 011357   011377 601000 9                  TNZ     s:13336
         9 011360   040000 106400                    CMPC    fill='040'O
         9 011361   000010 000010 xsym               ADSC9   OCL_HIST_BUF+8           cn=0,n=8
         9 011362   001211 000010 1                  ADSC9   CONS_RECORD+3            cn=0,n=8
         9 011363   011377 601000 9                  TNZ     s:13336

     3238    13330    4           AND OCL_HIST_BUF.TERMINAL = CONS_RECORD.TERMINAL THEN DO;

     3239    13331    4            KEYIN_TOTAL = KEYIN_TOTAL + 1;

  13331  9 011364   000743 054000 1                  AOS     KEYIN_TOTAL

     3240    13332    4            CONS_RECORD.KEYINS = CONS_RECORD.KEYINS + 1;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:416  
  13332  9 011365   001213 236000 1                  LDQ     CONS_RECORD+5
         9 011366   001000 036003                    ADLQ    512,DU
         9 011367   001213 552040 1                  STBQ    CONS_RECORD+5,'40'O

     3241    13333    4            CSTACK_RESULTS_VEC.PTR$ -> CSTACK (C) = CONS_RECORD;

  13333  9 011370   000741 236000 1                  LDQ     C
         9 011371   000025 402007                    MPY     21,DL
         9 011372   000106 100400                    MLR     fill='000'O
         9 011373   001206 000025 1                  ADSC9   CONS_RECORD              cn=0,n=21
         9 011374   000000 000025                    ADSC9   0,Q,PR0                  cn=0,n=21

     3242    13334    4            FOUND_IT = %YES#;

  13334  9 011375   400000 236003                    LDQ     -131072,DU
         9 011376   000735 756000 1                  STQ     FOUND_IT

     3243    13335    4         END;

     3244    13336    3      END;

  13336  9 011377   000741 235000 1                  LDA     C
         9 011400   000001 035007                    ADLA    1,DL
         9 011401   000741 755000 1                  STA     C
         9 011402   000742 236000 1                  LDQ     CINDEX
         9 011403   000741 116000 1                  CMPQ    C
         9 011404   011347 603000 9                  TRC     s:13327

  13333  9 011405                       SKIP_TEST    null
     3245    13337
     3246    13338    2   SKIP_TEST:;
     3247    13339    3      IF C_FREE_SPACE < 20 THEN DO;

  13339  9 011405   000737 235000 1                  LDA     C_FREE_SPACE
         9 011406   000024 115007                    CMPA    20,DL
         9 011407   011422 605000 9                  TPL     s:13345

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:417  
     3248    13340    3         C_PAGES = C_PAGES + 1;

  13340  9 011410   000740 236000 1                  LDQ     C_PAGES
         9 011411   000001 036007                    ADLQ    1,DL
         9 011412   000740 756000 1                  STQ     C_PAGES

     3249    13341    3         C_FREE_SPACE = 1024;

  13341  9 011413   002000 235007                    LDA     1024,DL
         9 011414   000737 755000 1                  STA     C_FREE_SPACE

     3250    13342    4         CALL M$GDS (GET_C_PAGE) WHENALTRETURN DO; END;

  13342  9 011415   002126 630400 1                  EPPR0   GET_C_PAGE
         9 011416   430001 713400                    CLIMB   alt,gds
         9 011417   400400 401760                    pmme    nvectors=2
         9 011420   011422 702000 9                  TSX2    s:13345
         9 011421   011422 710000 9                  TRA     s:13345

     3251    13343    3      END;

     3252    13344
     3253    13345    2      IF FIRST_TIME THEN GOTO SKIP_TEST2;

  13345  9 011422   000736 234000 1                  SZN     FIRST_TIME
         9 011423   011431 604000 9                  TMI     SKIP_TEST2

     3254    13346
     3255    13347    3      IF NOT FOUND_IT THEN DO;

  13347  9 011424   000735 234000 1                  SZN     FOUND_IT
         9 011425   011455 604000 9                  TMI     s:13359

     3256    13348    3         CINDEX = CINDEX + 1;

  13348  9 011426   000742 235000 1                  LDA     CINDEX
         9 011427   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:418  
         9 011430   000742 755000 1                  STA     CINDEX

     3257    13349    3   SKIP_TEST2:
     3258    13350    3         FIRST_TIME = %NO#;

  13350  9 011431   000736 450000 1     SKIP_TEST2   STZ     FIRST_TIME

     3259    13351    3         CONS_RECORD.LOGON = OCL_HIST_BUF.LOGON;

  13351  9 011432   040000 100400                    MLR     fill='040'O
         9 011433   000003 000010 xsym               ADSC9   OCL_HIST_BUF+3           cn=0,n=8
         9 011434   001206 000010 1                  ADSC9   CONS_RECORD              cn=0,n=8

     3260    13352    3         CONS_RECORD.DEVNM = OCL_HIST_BUF.DEVNM;

  13352  9 011435   000005 236000 xsym               LDQ     OCL_HIST_BUF+5
         9 011436   001210 756000 1                  STQ     CONS_RECORD+2

     3261    13353    3         CONS_RECORD.TERMINAL = OCL_HIST_BUF.TERMINAL;

  13353  9 011437   040000 100400                    MLR     fill='040'O
         9 011440   000010 000010 xsym               ADSC9   OCL_HIST_BUF+8           cn=0,n=8
         9 011441   001211 000010 1                  ADSC9   CONS_RECORD+3            cn=0,n=8

     3262    13354    3         CONS_RECORD.KEYINS = 1;

  13354  9 011442   001000 236003                    LDQ     512,DU
         9 011443   001213 552040 1                  STBQ    CONS_RECORD+5,'40'O

     3263    13355    3         KEYIN_TOTAL = KEYIN_TOTAL + 1;

  13355  9 011444   000743 054000 1                  AOS     KEYIN_TOTAL

     3264    13356    3         CSTACK_RESULTS_VEC.PTR$ -> CSTACK (CINDEX) = CONS_RECORD;

  13356  9 011445   000742 236000 1                  LDQ     CINDEX
         9 011446   000025 402007                    MPY     21,DL
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:419  
         9 011447   002135 470400 1                  LDP0    CSTACK_RESULTS_VEC+1
         9 011450   000106 100400                    MLR     fill='000'O
         9 011451   001206 000025 1                  ADSC9   CONS_RECORD              cn=0,n=21
         9 011452   000000 000025                    ADSC9   0,Q,PR0                  cn=0,n=21

     3265    13357    3         C_FREE_SPACE = C_FREE_SPACE - 5;

  13357  9 011453   000005 336007                    LCQ     5,DL
         9 011454   000737 056000 1                  ASQ     C_FREE_SPACE

     3266    13358    3      END;

     3267    13359    2   END GATHER_C_STATS;

  13359  9 011455   200004 221300                    LDX1  ! TEMP_UTS+1,,AUTO
         9 011456   000001 702211                    TSX2  ! 1,X1

     3268    13360        %EJECT;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:420  
     3269    13361
     3270    13362         /*
     3271    13363                   S U B R O U T I N E   D I S P L A Y _ C O N S O L E S
     3272    13364                                           */
     3273    13365    1   DISPLAY_CONSOLES: PROC;

  13365  9 011457   200004 741300       DISPLAY_CON* STX1  ! TEMP_UTS+1,,AUTO

     3274    13366    2      LOGON_TITLE = ' ';

  13366  9 011460   040000 100400                    MLR     fill='040'O
         9 011461   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 011462   000713 000110 1                  ADSC9   LOGON_TITLE              cn=0,n=72

     3275    13367    2      CALL INSERT (LOGON_TITLE, 2, 6, 'LOGON');

  13367  9 011463   040000 100400                    MLR     fill='040'O
         9 011464   000134 000005 8                  ADSC9   MOP_8_DIGITS_3+91        cn=0,n=5
         9 011465   000713 400006 1                  ADSC9   LOGON_TITLE              cn=2,n=6

     3276    13368    2      CALL INSERT (LOGON_TITLE, 18, 7, 'CONSOLE');

  13368  9 011466   040000 100400                    MLR     fill='040'O
         9 011467   000136 000007 8                  ADSC9   MOP_8_DIGITS_3+93        cn=0,n=7
         9 011470   000717 400007 1                  ADSC9   LOGON_TITLE+4            cn=2,n=7

     3277    13369    2      CALL INSERT (LOGON_TITLE, 34, 10, 'NUM KEYINS');

  13369  9 011471   040000 100400                    MLR     fill='040'O
         9 011472   000147 000012 8                  ADSC9   MOP_8_DIGITS_3+102       cn=0,n=10
         9 011473   000723 400012 1                  ADSC9   LOGON_TITLE+8            cn=2,n=10

     3278    13370    2      CALL INSERT (LOGON_TITLE, 52, 3, 'PCT');

  13370  9 011474   000152 236000 8                  LDQ     MOP_8_DIGITS_3+105
         9 011475   000730 552070 1                  STBQ    LOGON_TITLE+13,'70'O

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:421  
     3279    13371
     3280    13372    2      MSG = ' ';

  13372  9 011476   040000 100400                    MLR     fill='040'O
         9 011477   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 011500   000427 000400 1                  ADSC9   MSG                      cn=0,n=256

     3281    13373
     3282    13374    2      MSG = LOGON_TITLE;

  13374  9 011501   040000 100400                    MLR     fill='040'O
         9 011502   000713 000110 1                  ADSC9   LOGON_TITLE              cn=0,n=72
         9 011503   000427 000400 1                  ADSC9   MSG                      cn=0,n=256

     3283    13375    2      OUT_MSG.BUF_.BOUND = 70;

  13375  9 011504   001704 236000 1                  LDQ     OUT_MSG+4
         9 011505   177777 376007                    ANQ     65535,DL
         9 011506   000062 276000 10                 ORQ     50
         9 011507   001704 756000 1                  STQ     OUT_MSG+4

     3284    13376    3      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;

  13376  9 011510   001700 630400 1                  EPPR0   OUT_MSG
         9 011511   440001 713400                    CLIMB   alt,write
         9 011512   401400 401760                    pmme    nvectors=4
         9 011513   011515 702000 9                  TSX2    s:13378
         9 011514   011515 710000 9                  TRA     s:13378

     3285    13377
     3286    13378    3      DO C = 0 TO CINDEX;

  13378  9 011515   000741 450000 1                  STZ     C
         9 011516   011711 710000 9                  TRA     s:13409+3

     3287    13379    3         CONS_RECORD = CSTACK_RESULTS_VEC.PTR$ -> CSTACK(C);

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:422  
  13379  9 011517   000741 236000 1                  LDQ     C
         9 011520   000025 402007                    MPY     21,DL
         9 011521   002135 470400 1                  LDP0    CSTACK_RESULTS_VEC+1
         9 011522   000000 100506                    MLR     fill='000'O
         9 011523   000000 000025                    ADSC9   0,Q,PR0                  cn=0,n=21
         9 011524   001206 000025 1                  ADSC9   CONS_RECORD              cn=0,n=21

     3288    13380    3         MSG = ' ';

  13380  9 011525   040000 100400                    MLR     fill='040'O
         9 011526   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 011527   000427 000400 1                  ADSC9   MSG                      cn=0,n=256

     3289    13381    3         CALL CONCAT (MSG, CONS_RECORD.LOGON);

  13381  9 011530   040000 100400                    MLR     fill='040'O
         9 011531   001206 000010 1                  ADSC9   CONS_RECORD              cn=0,n=8
         9 011532   000427 000400 1                  ADSC9   MSG                      cn=0,n=256

     3290    13382    3         CALL INSERT (MSG,15,13,CONS_RECORD.DEVNM,'@',CONS_RECORD.TERMINAL);

  13382  9 011533   040000 100400                    MLR     fill='040'O
         9 011534   001210 000004 1                  ADSC9   CONS_RECORD+2            cn=0,n=4
         9 011535   000432 600004 1                  ADSC9   MSG+3                    cn=3,n=4
         9 011536   000100 236007                    LDQ     64,DL
         9 011537   000433 552004 1                  STBQ    MSG+4,'04'O
         9 011540   040000 100400                    MLR     fill='040'O
         9 011541   001211 000010 1                  ADSC9   CONS_RECORD+3            cn=0,n=8
         9 011542   000434 000010 1                  ADSC9   MSG+5                    cn=0,n=8

     3291    13383    3         CALL BINCHAR (TEXT_VAR, CONS_RECORD.KEYINS);

  13383  9 011543   001213 236000 1                  LDQ     CONS_RECORD+5
         9 011544   000033 772000                    QRL     27
         9 011545   000000 235003                    LDA     0,DU
         9 011546   200014 757100                    STAQ    IOPT+7,,AUTO
         9 011547   000000 301500                    BTD
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:423  
         9 011550   200014 000010                    NDSC9   IOPT+7,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         9 011551   000747 030010 1                  NDSC9   TEXT_VAR                 cn=0,s=nosgn,sf=0,n=8

     3292    13384    3         CALL EDITCHAR (TEXT_VAR, 0, 8, MOP_8_DIGITS, TEXT_VAR);

  13384  9 011552   000000 024400                    MVNE
         9 011553   000747 030010 1                  NDSC9   TEXT_VAR                 cn=0,s=nosgn,sf=0,n=8
         9 011554   000000 000002 8                  ADSC9   MOP_8_DIGITS             cn=0,n=2
         9 011555   000747 000010 1                  ADSC9   TEXT_VAR                 cn=0,n=8

     3293    13385    3         CALL INSERT (MSG, 35, 8, TEXT_VAR);

  13385  9 011556   040000 100400                    MLR     fill='040'O
         9 011557   000747 000010 1                  ADSC9   TEXT_VAR                 cn=0,n=8
         9 011560   000437 600010 1                  ADSC9   MSG+8                    cn=3,n=8

     3294    13386    3         IF (CONS_RECORD.KEYINS / KEYIN_TOTAL) = 1

  13386  9 011561   001213 236000 1                  LDQ     CONS_RECORD+5
         9 011562   000033 772000                    QRL     27
         9 011563   000743 506000 1                  DIV     KEYIN_TOTAL
         9 011564   000001 116007                    CMPQ    1,DL
         9 011565   011572 601000 9                  TNZ     s:13389

     3295    13387    3         THEN CALL INSERT (MSG, 50, 8, '100.000%');

  13387  9 011566   040000 100400                    MLR     fill='040'O
         9 011567   000153 000010 8                  ADSC9   MOP_8_DIGITS_3+106       cn=0,n=8
         9 011570   000443 400010 1                  ADSC9   MSG+12                   cn=2,n=8
         9 011571   011677 710000 9                  TRA     s:13407

     3296    13388    4         ELSE DO;

     3297    13389    4            PCT = CONS_RECORD.KEYINS * 100;

  13389  9 011572   001213 236000 1                  LDQ     CONS_RECORD+5
         9 011573   000033 772000                    QRL     27
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:424  
         9 011574   000144 402007                    MPY     100,DL
         9 011575   000744 756000 1                  STQ     PCT

     3298    13390    4            PCT = PCT / KEYIN_TOTAL;

  13390  9 011576   000743 506000 1                  DIV     KEYIN_TOTAL
         9 011577   000744 756000 1                  STQ     PCT

     3299    13391    4            CALL BINCHAR (TEXT_VAR, PCT);

  13391  9 011600   000000 301400                    BTD
         9 011601   000744 000004 1                  NDSC9   PCT                      cn=0,s=lsgnf,sf=0,n=4
         9 011602   000747 030010 1                  NDSC9   TEXT_VAR                 cn=0,s=nosgn,sf=0,n=8

     3300    13392    4            CALL EDITCHAR (TEXT_VAR, 0, 8, MOP_8_DIGITS, TEXT_VAR);

  13392  9 011603   000000 024400                    MVNE
         9 011604   000747 030010 1                  NDSC9   TEXT_VAR                 cn=0,s=nosgn,sf=0,n=8
         9 011605   000000 000002 8                  ADSC9   MOP_8_DIGITS             cn=0,n=2
         9 011606   000747 000010 1                  ADSC9   TEXT_VAR                 cn=0,n=8

     3301    13393    4            CALL INDEX1R (W, ' ', TEXT_VAR);

  13393  9 011607   000000 125400                    SCMR    mask='000'O
         9 011610   000747 000010 1                  ADSC9   TEXT_VAR                 cn=0,n=8
         9 011611   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 011612   000751 000000 1                  ARG     W
         9 011613   011616 606400 9                  TTN     s:13394
         9 011614   000007 236007                    LDQ     7,DL
         9 011615   000751 156000 1                  SSQ     W

     3302    13394    4            IF LENGTHC (TEXT_VAR) - (W+1) = 1

  13394  9 011616   000751 235000 1                  LDA     W
         9 011617   000006 115007                    CMPA    6,DL
         9 011620   011627 601000 9                  TNZ     s:13396

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:425  
     3303    13395    4           THEN CALL INSERT (MSG, 52, (LENGTHC (TEXT_VAR) - W), SUBSTR (TEXT_VAR, W+1,
             13395                     (LENGTHC (TEXT_VAR) - W)));

  13395  9 011621   777767 620005                    EAX0    -9,AL
         9 011622   777777 660003                    ERX0    -1,DU
         9 011623   040040 100445                    MLR     fill='040'O
         9 011624   000747 200010 1                  ADSC9   TEXT_VAR,A               cn=1,n=*X0
         9 011625   000444 000010 1                  ADSC9   MSG+13                   cn=0,n=*X0
         9 011626   011634 710000 9                  TRA     s:13398

     3304    13396    4           ELSE CALL INSERT (MSG, 51, (LENGTHC (TEXT_VAR) - W), SUBSTR (TEXT_VAR, W+1,
             13396                     (LENGTHC (TEXT_VAR) - W)));

  13396  9 011627   777767 620005                    EAX0    -9,AL
         9 011630   777777 660003                    ERX0    -1,DU
         9 011631   040040 100445                    MLR     fill='040'O
         9 011632   000747 200010 1                  ADSC9   TEXT_VAR,A               cn=1,n=*X0
         9 011633   000443 600010 1                  ADSC9   MSG+12                   cn=3,n=*X0

     3305    13397
     3306    13398    4            PCT = ((CONS_RECORD.KEYINS * 100000) / KEYIN_TOTAL)

  13398  9 011634   001213 236000 1                  LDQ     CONS_RECORD+5
         9 011635   000033 772000                    QRL     27
         9 011636   303240 402007                    MPY     100000,DL
         9 011637   000743 506000 1                  DIV     KEYIN_TOTAL
         9 011640   200014 756100                    STQ     IOPT+7,,AUTO
         9 011641   001213 236000 1                  LDQ     CONS_RECORD+5
         9 011642   000033 772000                    QRL     27
         9 011643   303240 402007                    MPY     100000,DL
         9 011644   000743 506000 1                  DIV     KEYIN_TOTAL
         9 011645   001750 506007                    DIV     1000,DL
         9 011646   000063 402000 10                 MPY     51
         9 011647   200014 036100                    ADLQ    IOPT+7,,AUTO
         9 011650   000744 756000 1                  STQ     PCT

     3307    13399    4              - ((((CONS_RECORD.KEYINS * 100000) / KEYIN_TOTAL)
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:426  
     3308    13400    4              / 1000) * 1000);
     3309    13401    4            CALL BINCHAR (TEXT_VAR, PCT);

  13401  9 011651   000000 301400                    BTD
         9 011652   000744 000004 1                  NDSC9   PCT                      cn=0,s=lsgnf,sf=0,n=4
         9 011653   000747 030010 1                  NDSC9   TEXT_VAR                 cn=0,s=nosgn,sf=0,n=8

     3310    13402    4            CALL EDITCHAR (TEXT_VAR, 0, 8, MOP_8_DIGITS_3, TEXT_VAR);

  13402  9 011654   000000 024400                    MVNE
         9 011655   000747 030010 1                  NDSC9   TEXT_VAR                 cn=0,s=nosgn,sf=0,n=8
         9 011656   000001 000002 8                  ADSC9   MOP_8_DIGITS_3           cn=0,n=2
         9 011657   000747 000010 1                  ADSC9   TEXT_VAR                 cn=0,n=8

     3311    13403    4            CALL INDEX1R (W, ' ', TEXT_VAR);

  13403  9 011660   000000 125400                    SCMR    mask='000'O
         9 011661   000747 000010 1                  ADSC9   TEXT_VAR                 cn=0,n=8
         9 011662   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 011663   000751 000000 1                  ARG     W
         9 011664   011667 606400 9                  TTN     s:13404
         9 011665   000007 236007                    LDQ     7,DL
         9 011666   000751 156000 1                  SSQ     W

     3312    13404    4            CALL INSERT (MSG, 53, 3 + LENGTHC ('.') + LENGTHC ('%'), '.', SUBSTR (
             13404                     TEXT_VAR, W+1, 3), '%');

  13404  9 011667   000056 236003                    LDQ     46,DU
         9 011670   000444 552020 1                  STBQ    MSG+13,'20'O
         9 011671   000751 235000 1                  LDA     W
         9 011672   040000 100405                    MLR     fill='040'O
         9 011673   000747 200003 1                  ADSC9   TEXT_VAR,A               cn=1,n=3
         9 011674   000444 400003 1                  ADSC9   MSG+13                   cn=2,n=3
         9 011675   000045 236003                    LDQ     37,DU
         9 011676   000445 552020 1                  STBQ    MSG+14,'20'O

     3313    13405    4         END;
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:427  

     3314    13406
     3315    13407    3         PRINT_FLAG = %YES#;

  13407  9 011677   400000 236003                    LDQ     -131072,DU
         9 011700   000306 756000 1                  STQ     PRINT_FLAG

     3316    13408    4         CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;

  13408  9 011701   001700 630400 1                  EPPR0   OUT_MSG
         9 011702   440001 713400                    CLIMB   alt,write
         9 011703   401400 401760                    pmme    nvectors=4
         9 011704   011706 702000 9                  TSX2    s:13409
         9 011705   011706 710000 9                  TRA     s:13409

     3317    13409    3      END;

  13409  9 011706   000741 235000 1                  LDA     C
         9 011707   000001 035007                    ADLA    1,DL
         9 011710   000741 755000 1                  STA     C
         9 011711   000742 236000 1                  LDQ     CINDEX
         9 011712   000741 116000 1                  CMPQ    C
         9 011713   011517 603000 9                  TRC     s:13379

     3318    13410    2      CALL BINCHAR (TEXT_VAR, KEYIN_TOTAL);

  13410  9 011714   000000 301400                    BTD
         9 011715   000743 000004 1                  NDSC9   KEYIN_TOTAL              cn=0,s=lsgnf,sf=0,n=4
         9 011716   000747 030010 1                  NDSC9   TEXT_VAR                 cn=0,s=nosgn,sf=0,n=8

     3319    13411    2      CALL EDITCHAR (TEXT_VAR, 0, 8, MOP_8_DIGITS, TEXT_VAR);

  13411  9 011717   000000 024400                    MVNE
         9 011720   000747 030010 1                  NDSC9   TEXT_VAR                 cn=0,s=nosgn,sf=0,n=8
         9 011721   000000 000002 8                  ADSC9   MOP_8_DIGITS             cn=0,n=2
         9 011722   000747 000010 1                  ADSC9   TEXT_VAR                 cn=0,n=8

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:428  
     3320    13412    2      MSG = ' ';

  13412  9 011723   040000 100400                    MLR     fill='040'O
         9 011724   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 011725   000427 000400 1                  ADSC9   MSG                      cn=0,n=256

     3321    13413    2      CALL INSERT (MSG, 19, 24, '***TOTAL KEYINS ', TEXT_VAR);

  13413  9 011726   040000 100400                    MLR     fill='040'O
         9 011727   000155 000020 8                  ADSC9   MOP_8_DIGITS_3+108       cn=0,n=16
         9 011730   000433 600020 1                  ADSC9   MSG+4                    cn=3,n=16
         9 011731   040000 100400                    MLR     fill='040'O
         9 011732   000747 000010 1                  ADSC9   TEXT_VAR                 cn=0,n=8
         9 011733   000437 600010 1                  ADSC9   MSG+8                    cn=3,n=8

     3322    13414    3      CALL M$WRITE (OUT_MSG) WHENALTRETURN DO; END;

  13414  9 011734   001700 630400 1                  EPPR0   OUT_MSG
         9 011735   440001 713400                    CLIMB   alt,write
         9 011736   401400 401760                    pmme    nvectors=4
         9 011737   011741 702000 9                  TSX2    s:13415
         9 011740   011741 710000 9                  TRA     s:13415

     3323    13415    2   END DISPLAY_CONSOLES;

  13415  9 011741   200004 221300                    LDX1  ! TEMP_UTS+1,,AUTO
         9 011742   000001 702211                    TSX2  ! 1,X1

     3324    13416    1   END ORR$REPLAY;

  13416  9 011743   000000 702200 xent               TSX2  ! X66_MARET
     3325    13417        %EOD;

PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:429  
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XUW_MACRO_C.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XUR_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   OR_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OR_PERR_C.:E05TOU  is referenced.
   OCP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OCM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OCL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OUT_SUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   ORR_SUBS_C.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ORR$REPLAY.
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:430  

 **** Variables and constants ****

  ****  Section 001  Data  ORR$REPLAY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   674-0-0/w UBIN        r     1 A                       2524-0-0/d STRC(216)   r     1 ABNORMAL_EXIT
   666-0-0/b BIT         r     1 ALL                      232-0-0/c CHAR(20)    r     1 ASNFID
  2116-0-0/d STRC(72)    r     1 ASTACK_RESULTS_VEC      1177-0-0/h STRC(234)   r     1 ATTR_REC
   673-0-0/w UBIN        r     1 A_INDEX                  664-0-0/b BIT         r     1 A_SPECIFIC_FILE
   300-0-0/w UBIN        r     1 BEGINNING_TIME          2252-0-0/d STRC(144)   r     1 BREAK_IN
   712-0-0/b BIT         r     1 BROKEN_FILE              741-0-0/w UBIN        r     1 C
   177-0-0/c CHAR(2)     r     1 CENTISEC1                206-0-0/c CHAR(2)     r     1 CENTISEC2
   742-0-0/w UBIN        r     1 CINDEX                  1412-0-0/d STRC(1080)  r     1 CLOSE_HISTORYE
  2776-0-0/d STRC(1080)  r     1 CLOSE_LO                1546-0-0/d STRC(1080)  r     1 CLOSE_OCMSG
  1726-0-0/d STRC(1080)  r     1 CLOSE_OUT                164-0-0/c CHAR        r     1 CMD_INSTR
   270-0-0/c CHAR(4)     r     1 CONSOLE                  745-0-0/b BIT         r     1 CONSOLE_REPORT
  1206-0-0/c STRC(189)   r     1 CONS_RECORD             2366-0-0/c STRC(72)    r     1 CSACCT
  2350-0-0/c STRC(45)    r     1 CSCGNM                  2134-0-0/d STRC(72)    r     1 CSTACK_RESULTS_VEC
  2426-0-0/d STRC(1080)  r     1 CS_CLOSE                2256-0-0/d STRC(2088)  r     1 CS_OPEN
  3070-0-0/w UBIN        r     1 CUR_YR                   737-0-0/w SBIN        r     1 C_FREE_SPACE
   740-0-0/w UBIN        r     1 C_PAGES
   302-0-0/c CHAR(2)     r     1 DATE_BUF(0:2)
   657-0-0/w UBIN        r     1 DAY                      201-0-0/c CHAR(2)     r     1 DAY1
   210-0-0/c CHAR(2)     r     1 DAY2
  3072-0-0/w UBIN        r     1 DAY_LIST(0:11)
   215-0-0/w UBIN        r     1 DCB#                     222-0-0/c CHAR(31)    r     1 DESTINATION
  2606-0-0/c STRC(72)    r     1 DEST_ACCT               2562-0-0/c STRC(288)   r     1 DEST_NAME
  2610-0-0/c STRC(72)    r     1 DEST_PASS               2574-0-0/d STRC(324)   r     1 DEST_RESULTS
  2572-0-0/c STRC(72)    r     1 DEST_WSN                 676-0-0/b BIT         r     1 DIRECT
   301-0-0/w UBIN        r     1 ENDING_TIME              301-0-0/w BIT         r     1 ENDING_TIME_REDEF
  1125-0-0/w STRC        r     1 ERROR                   1604-0-0/d STRC(936)   r     1 ERR_FIND_TEMP
  1672-0-0/d STRC(216)   r     1 ERR_GETTING_CMD         2054-0-0/d STRC(72)    r     1 FDS_RESULTS_VEC
  2532-0-0/d STRC(864)   r     1 FID_DEST                1400-0-0/c STRC(288)   r     1 FID_NAME
  2414-0-0/d STRC(360)   r     1 FIRST_HIST_REC           736-0-0/b BIT         r     1 FIRST_TIME
  3062-0-0/d STRC(144)   r     1 FMPRIV                   735-0-0/b BIT         r     1 FOUND_IT
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:431  
   311-0-0/c CHAR(6)     r     1 FPT_DATE                 313-0-0/c CHAR(8)     r     1 FPT_TIME
  2120-0-0/d STRC(216)   r     1 FREE_ASTACK_SEG         2136-0-0/d STRC(216)   r     1 FREE_C_PAGE
  2102-0-0/d STRC(216)   r     1 FREE_LSTACK_SEG          707-0-0/w SBIN        r     1 FREE_SPACE
  2044-0-0/d STRC(72)    r     1 GDS_RESULTS_VEC         1636-0-0/d STRC(936)   r     1 GEN_ERR
  2110-0-0/d STRC(216)   r     1 GET_ATTR_SEG            2126-0-0/d STRC(216)   r     1 GET_C_PAGE
  2476-0-0/d STRC(792)   r     1 GET_DCB_INFO            2072-0-0/d STRC(216)   r     1 GET_LSTACK_SEG
  3060-0-0/c STRC(72)    r     1 HELP_ACCT               3056-0-0/c STRC(63)    r     1 HELP_NAME
   213-0-0/w SBIN        r     1 HERE                    2144-0-0/d STRC(360)   r     1 HIST_POSITION
   174-0-0/c CHAR(2)     r     1 HOUR1                    203-0-0/c CHAR(2)     r     1 HOUR2
   660-0-0/w UBIN        r     1 HR                       216-0-0/w SBIN        r     1 I
   212-0-0/w SBIN        r     1 IND                      704-0-0/b BIT (18)    r     1 IP_ATTR_TYPE
   702-0-0/c CHAR(8)     r     1 IP_LOC_TYPE              663-0-0/b BIT         r     1 KEEP_ON_LISTING
   743-0-0/w SBIN        r     1 KEYIN_TOTAL             2352-0-0/w STRC(432)   r     1 KSST
   670-0-0/w SBIN        r     1 L                        273-0-0/c CHAR        r     1 LANGUAGE
  3066-0-0/w UBIN        r     1 LEAP                    3067-0-0/w UBIN        r     1 LEAP_VAR
   667-0-0/w SBIN        r     1 LINDEX                   167-0-0/w PTR         r     1 LISTPTR$
   271-0-0/c CHAR(8)     r     1 LOCATION                 276-0-0/c CHAR(8)     r     1 LOGON
  1164-0-0/h STRC(378)   r     1 LOGON_REC_OFF           1151-0-0/h STRC(378)   r     1 LOGON_REC_ON
   711-0-0/b BIT         r     1 LOGON_REPORT             713-0-0/c CHAR(72)    r     1 LOGON_TITLE
   672-0-0/b UBIN        r     1 LRECS                   2100-0-0/d STRC(72)    r     1 LSTACK_RESULTS_VEC
   661-0-0/w UBIN        r     1 MIN                      175-0-0/c CHAR(2)     r     1 MIN1
   204-0-0/c CHAR(2)     r     1 MIN2                    1670-0-0/w STRC        r     1 MODULE_ERR
   656-0-0/w UBIN        r     1 MON                      200-0-0/c CHAR(2)     r     1 MONTH1
   207-0-0/c CHAR(2)     r     1 MONTH2                   427-0-0/c CHAR(256)   r     1 MSG
  1544-0-0/c STRC(72)    r     1 MSGACCT                  752-0-0/b BIT         r     1 NO_FILE
  1542-0-0/c STRC(63)    r     1 OCMSG                   2704-0-0/d STRC(2088)  r     1 OPEN_DEST
  1306-0-0/d STRC(2088)  r     1 OPEN_HISTORYE           2612-0-0/d STRC(2088)  r     1 OPEN_LO
  1450-0-0/d STRC(2088)  r     1 OPEN_OCMSG
   652-0-0/b BIT         r     1 OPERATOR_ENTERED_DATE1
   654-0-0/b BIT         r     1 OPERATOR_ENTERED_DATE2
   651-0-0/b BIT         r     1 OPERATOR_ENTERED_TIME1
   653-0-0/b BIT         r     1 OPERATOR_ENTERED_TIME2
  1214-0-0/w STRC(144)   r     1 ORR_UNMASK(0:10)
   142-0-0/c STRC(180)   r     1 OR_MESSBUF               165-0-0/w PTR         r     1 OUT$
   527-0-0/c CHAR(256)   r     1 OUT_BUFFER               165-0-0/w STRC        r     1 OUT_ERROR
  1700-0-0/d STRC(432)   r     1 OUT_MSG                  710-0-0/w UBIN        r     1 PAGES
   744-0-0/w SBIN        r     1 PCT                      677-0-0/b BIT         r     1 PERFORM_CALL
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:432  
  2472-0-0/d STRC(144)   r     1 POSITION_AT_END          705-0-0/b BIT         r     1 PREFIX
  1141-0-0/c STRC(288)   r     1 PREV                     307-0-0/w UBIN        r     1 PRINTED_TIME
   306-0-0/b BIT         r     1 PRINT_FLAG              1714-0-0/d STRC(360)   r     1 PROMPT_IN
   166-0-0/w PTR         r     1 PTR$                    1270-0-0/w STRC(504)   r     1 P_PCB
  3034-0-0/d STRC(432)   r     1 RANGE_CONV              2002-0-0/d STRC(504)   r     1 READ_CONSOLE_REC
  1764-0-0/d STRC(504)   r     1 READ_HISTORYE           2020-0-0/d STRC(504)   r     1 READ_STATUS
  2046-0-0/d STRC(216)   r     1 RELEASE_SEG              756-0-0/d REMB        r     1 REM_START
  3050-0-0/d STRC(216)   r     1 RESET_XCON               176-0-0/c CHAR(2)     r     1 SEC1
   205-0-0/c CHAR(2)     r     1 SEC2                     415-0-0/c CHAR(8)     r     1 SIM_DATE
   417-0-0/c CHAR(11)    r     1 SIM_TIME                 675-0-0/w UBIN        r     1 SOME_ON_STACK
   173-0-0/w PTR         r     1 SR_PTR$                 2404-0-0/w STRC(288)   r     1 STA
  2036-0-0/d STRC(216)   r     1 STACK_SEG                662-0-0/w SBIN        r     1 STK_INDEX
   221-0-0/w SBIN        r     1 SUBS1                    220-0-0/w SBIN        r     1 SUBS2
  1410-0-0/c STRC(72)    r     1 SYS                     3071-0-0/w UBIN        r     1 TEMP_YR
   747-0-0/c CHAR(8)     r     1 TEXT_VAR                 214-0-0/w UBIN        r     1 THOLD
   754-0-0/w UBIN        r     1 TI
   304-0-0/c CHAR(2)     r     1 TIME_BUF(0:3)
   627-0-0/c CHAR(72)    r     1 TIME_BUFFER             2156-0-0/d STRC(432)   r     1 TIME_CONV
  2172-0-0/d STRC(432)   r     1 TIME_SET                2206-0-0/d STRC(432)   r     1 TIME_SIMULATION
  2236-0-0/d STRC(432)   r     1 TIME_TO_UTS              422-0-0/c CHAR(8)     r     1 TO_UTS_DATE
   424-0-0/c CHAR(11)    r     1 TO_UTS_TIME              172-0-0/w PTR         r     1 TPTR$
   237-0-0/c CHAR(100)   r     1 TXTFD                    700-0-0/c CHAR(8)     r     1 TYPE
   671-0-0/b BIT         r     1 USE_LINDEX               310-0-0/w UBIN        r     1 UTSTAMP
   214-0-0/w CHAR(2)     r     1 VALID_CHECK(0:1)
   751-0-0/w UBIN        r     1 W                       2464-0-0/d STRC(216)   r     1 WAIT_HIST
   665-0-0/w UBIN        r     1 WAIT_TIMES#              753-0-0/w UBIN        r     1 WI
   746-0-0/b BIT         r     1 WILDCARDING             2370-0-0/d STRC(432)   r     1 WRITE_CS
  2056-0-0/d STRC(432)   r     1 WRITE_HIST_BUF_MESS     2222-0-0/d STRC(432)   r     1 WRITE_TIME
   274-0-0/c CHAR(8)     r     1 WSTATION                 217-0-0/w SBIN        r     1 X
     0-0-0/d STRC(2052)  r     1 XUH_PARAM                 72-0-0/d STRC(1404)  r     1 XUR_INIT
   150-0-0/d STRC(432)   r     1 XUW_WILDCARD             202-0-0/c CHAR(2)     r     1 YEAR1
   211-0-0/c CHAR(2)     r     1 YEAR2                    655-0-0/w UBIN        r     1 YR

  ****  Section 008 RoData ORR$REPLAY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:433  

     0-0-0/b BIT (9)     r     1 MOP_8_DIGITS(0:1)
     1-0-0/b BIT (9)     r     1 MOP_8_DIGITS_3(0:1)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w UBIN        r     1 IOPT                       3-0-0/w UBIN        r     1 TEMP_UTS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/c STRC(63)    r     1 B_VERSION                  0-0-0/c BIT         r     1 OCHIST_FLAG
     0-0-0/b STRC(45)    r     1 OCL_CONSOLE_KEY            0-0-0/h STRC(397)   r     1 OCL_CONSOLE_REC
     0-0-0/w STRC(2700)  r     1 OCL_HIST_BUF               0-0-0/b STRC(45)    r     1 OCL_NORM_KEY
     0-0-0/b STRC(45)    r     1 OCL_STATUS_KEY             0-0-0/c STRC(432)   r     1 OCL_STATUS_REC
     0-0-0/w SBIN        r     1 OCM_BPOSN                  0-0-0/c CHAR(256)   r     1 OCM_BUFFER
     0-0-0/b BIT         r     1 OCM_KEY_FLAG               0-0-0/c STRC(288)   r     1 OCM_PROMPT
     0-0-0/w UBIN        r     1 OCM_TSTAMP                 0-0-0/c CHAR(8)     r     1 OCM_WSN
     0-0-0/w PTR         r     1 OC_CONSOLE$                0-0-0/w BIT         r     1 OC_MSG_GOOD
     0-0-0/c BIT         r     1 OR_BRK_FLAG                0-0-0/c BIT         r     1 OR_OK_TO_BREAK
     0-0-0/c BIT         r     1 OR_XCON_FLAG               0-0-0/w PTR         r     1 REPLAY_NODES

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/h STRC(234)   r     1 ASTACK(0:0)                0-0-0/w STRC(2448)  r     1 B$ALT
     0-0-0/d STRC(5760)  r     1 B$JIT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/c ASTR(9)     r     1 B_VERSION_                 0-0-0/c STRC(189)   r     1 CSTACK(0:0)
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 F$HISTFILE
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:434  
     0-0-0N  NULL        r     1 F$TEMPLATE                 0-0-0/h STRC(378)   r     1 LSTACK(0:0)
     0-0-0N  NULL        r     1 M$CSCG                     0-0-0N  NULL        r     1 M$IN
     0-0-0N  NULL        r     1 M$LO                       0-0-0N  NULL        r     1 M$SI
     0-0-0N  NULL        r     1 M$UC                       0-0-0/w STRC(144)   r     1 OUT$BLK
     0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/c STRC(288)   r     1 PREV_STACK(0:0)
     0-0-0/c ASTR(9)     r     1 TEXTC


   Procedure ORR$REPLAY requires 5092 words for executable code.
   Procedure ORR$REPLAY requires 18 words of local(AUTO) storage.
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:435  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:436  
          MINI XREF LISTING

A
      8317**DCL     11158<<DOINDEX 11159>>ASSIGN
ABNORMAL_EXIT
     10326**DCL     10883<>CALL
ABNORMAL_EXIT.V
     10327**DCL     10326--DCLINIT
ADD_TO_LOGON_STACK
     13101**PROC    13068--CALL
ALL
      8311**DCL     11153>>IF      11195>>IF      13006<<ASSIGN  13011<<ASSIGN  13065>>IF      13245>>IF
ASNFID
      8254**DCL     10309--DCLINIT
ASTACK
      8433**DCL     11159>>ASSIGN  13207<<ASSIGN
ASTACK_RESULTS_VEC
      9680**DCL      9662--DCLINIT  9698--DCLINIT 10924<<ASSIGN
ASTACK_RESULTS_VEC.PTR$
      9682**DCL     11159>>ASSIGN  13207>>ASSIGN
ASTACK_RESULTS_VEC.W2
      9681**DCL      9682--REDEF
ATTR_REC
      8408**DCL     11159<<ASSIGN  13207>>ASSIGN
ATTR_REC.ATTRO
      8409**DCL     11164>>IF      11166>>IF      11170>>IF      11174>>IF      13202<<ASSIGN
ATTR_REC.STATION.FIRST_HALF
      8413**DCL     11185>>IF      13205<<ASSIGN
ATTR_REC.STATION.SECND_HALF
      8414**DCL     11174>>IF      13206<<ASSIGN
ATTR_REC.TERMINAL
      8411**DCL     11161>>CALLBLT 11166>>IF      11185>>IF      13204<<ASSIGN
ATTR_REC.WSN
      8410**DCL     11160>>CALLBLT 11170>>IF      11174>>IF      11189>>IF      13203<<ASSIGN
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:437  
A_INDEX
      8316**DCL     11157>>IF      11158>>DOINDEX 13190<<ASSIGN  13201<<ASSIGN  13201>>ASSIGN  13207>>ASSIGN
A_SPECIFIC_FILE
      8309**DCL     11791<<ASSIGN  11800<<ASSIGN  11990>>IF      12006<<ASSIGN
B$ALT.CODE
      7763**DCL      7763--REDEF    7764--REDEF    7764--REDEF
B$ALT.DCB#
      7764**DCL     11597>>ASSIGN  11679>>ASSIGN  11705>>ASSIGN  11728>>ASSIGN  11739>>ASSIGN  11760>>ASSIGN
     11921>>ASSIGN  11955>>ASSIGN  11974>>ASSIGN  12063>>ASSIGN  12077>>ASSIGN  12093>>ASSIGN  12105>>ASSIGN
     12117>>ASSIGN  12130>>ASSIGN  12174>>ASSIGN  12183>>ASSIGN  12195>>ASSIGN  12204>>ASSIGN  12428>>ASSIGN
     12439>>ASSIGN  12448>>ASSIGN  12878>>ASSIGN  12885>>ASSIGN
B$ALT.ERR
      7764**DCL     11087>>ASSIGN  11473>>ASSIGN  11546>>ASSIGN  11555>>ASSIGN  11601>>ASSIGN  11613>>ASSIGN
     11624>>ASSIGN  11635>>ASSIGN  11647>>ASSIGN  11659>>ASSIGN  11671>>ASSIGN  11683>>ASSIGN  11694>>ASSIGN
     11707>>ASSIGN  11718>>ASSIGN  11730>>ASSIGN  11741>>ASSIGN  11752>>ASSIGN  11764>>ASSIGN  11840>>ASSIGN
     11925>>ASSIGN  11945>>ASSIGN  11957>>ASSIGN  11965>>ASSIGN  11978>>ASSIGN  12081>>ASSIGN  12097>>ASSIGN
     12109>>ASSIGN  12121>>ASSIGN  12134>>ASSIGN  12178>>ASSIGN  12187>>ASSIGN  12199>>ASSIGN  12208>>ASSIGN
     12430>>ASSIGN  12443>>ASSIGN  12452>>ASSIGN  12691>>ASSIGN  12703>>ASSIGN  12871>>ASSIGN  12880>>ASSIGN
     12889>>ASSIGN  12898>>ASSIGN  12989>>ASSIGN  13079>>ASSIGN  13092>>ASSIGN
B$ALT.ERR.CODE
      7765**DCL     13074>>IF
B$ALT.ERR.ERR#
      7765**DCL      7765--REDEF
B$ALT.EVID
      7764**DCL      7764--REDEF    7764--REDEF
B$JIT.CPFLAGS1.SLEAZE
      7687**DCL      7687--REDEF
B$JIT.ERR.MID
      7588**DCL      7588--REDEF
B$JIT.LANG
      7729**DCL     10861>>ASSIGN  12321>>ASSIGN  12340>>ASSIGN
B$JIT.PRFLAGS.SI
      7677**DCL     11785>>IF
B$JIT.SYSID
      7587**DCL     10862>>CALLBLT
B$JIT$
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:438  
      8351**DCL      7582--IMP-PTR 10861>>ASSIGN  10862>>CALLBLT 11785>>IF      12321>>ASSIGN  12340>>ASSIGN
B$TCB.ALT$
      7757**DCL     11087>>ASSIGN  11473>>ASSIGN  11546>>ASSIGN  11555>>ASSIGN  11597>>ASSIGN  11601>>ASSIGN
     11613>>ASSIGN  11624>>ASSIGN  11635>>ASSIGN  11647>>ASSIGN  11659>>ASSIGN  11671>>ASSIGN  11679>>ASSIGN
     11683>>ASSIGN  11694>>ASSIGN  11705>>ASSIGN  11707>>ASSIGN  11718>>ASSIGN  11728>>ASSIGN  11730>>ASSIGN
     11739>>ASSIGN  11741>>ASSIGN  11752>>ASSIGN  11760>>ASSIGN  11764>>ASSIGN  11840>>ASSIGN  11921>>ASSIGN
     11925>>ASSIGN  11945>>ASSIGN  11955>>ASSIGN  11957>>ASSIGN  11965>>ASSIGN  11974>>ASSIGN  11978>>ASSIGN
     12063>>ASSIGN  12077>>ASSIGN  12081>>ASSIGN  12093>>ASSIGN  12097>>ASSIGN  12105>>ASSIGN  12109>>ASSIGN
     12117>>ASSIGN  12121>>ASSIGN  12130>>ASSIGN  12134>>ASSIGN  12174>>ASSIGN  12178>>ASSIGN  12183>>ASSIGN
     12187>>ASSIGN  12195>>ASSIGN  12199>>ASSIGN  12204>>ASSIGN  12208>>ASSIGN  12428>>ASSIGN  12430>>ASSIGN
     12439>>ASSIGN  12443>>ASSIGN  12448>>ASSIGN  12452>>ASSIGN  12691>>ASSIGN  12703>>ASSIGN  12871>>ASSIGN
     12878>>ASSIGN  12880>>ASSIGN  12885>>ASSIGN  12889>>ASSIGN  12898>>ASSIGN  12989>>ASSIGN  13074>>IF
     13079>>ASSIGN  13092>>ASSIGN
B$TCB$
      8352**DCL     11087>>ASSIGN  11473>>ASSIGN  11546>>ASSIGN  11555>>ASSIGN  11597>>ASSIGN  11601>>ASSIGN
     11613>>ASSIGN  11624>>ASSIGN  11635>>ASSIGN  11647>>ASSIGN  11659>>ASSIGN  11671>>ASSIGN  11679>>ASSIGN
     11683>>ASSIGN  11694>>ASSIGN  11705>>ASSIGN  11707>>ASSIGN  11718>>ASSIGN  11728>>ASSIGN  11730>>ASSIGN
     11739>>ASSIGN  11741>>ASSIGN  11752>>ASSIGN  11760>>ASSIGN  11764>>ASSIGN  11840>>ASSIGN  11921>>ASSIGN
     11925>>ASSIGN  11945>>ASSIGN  11955>>ASSIGN  11957>>ASSIGN  11965>>ASSIGN  11974>>ASSIGN  11978>>ASSIGN
     12063>>ASSIGN  12077>>ASSIGN  12081>>ASSIGN  12093>>ASSIGN  12097>>ASSIGN  12105>>ASSIGN  12109>>ASSIGN
     12117>>ASSIGN  12121>>ASSIGN  12130>>ASSIGN  12134>>ASSIGN  12174>>ASSIGN  12178>>ASSIGN  12183>>ASSIGN
     12187>>ASSIGN  12195>>ASSIGN  12199>>ASSIGN  12204>>ASSIGN  12208>>ASSIGN  12428>>ASSIGN  12430>>ASSIGN
     12439>>ASSIGN  12443>>ASSIGN  12448>>ASSIGN  12452>>ASSIGN  12691>>ASSIGN  12703>>ASSIGN  12871>>ASSIGN
     12878>>ASSIGN  12880>>ASSIGN  12885>>ASSIGN  12889>>ASSIGN  12898>>ASSIGN  12989>>ASSIGN  13074>>IF
     13079>>ASSIGN  13092>>ASSIGN
BAD_DATE IN PROCEDURE TIME_VALIDATE
     12769**LABEL   12759--GOTO
BAD_LANG
     11449**LABEL   11256--CALLALT 11358--CALLALT
BAD_WILD
     11766**LABEL   11448--GOTO
BEGIN IN PROCEDURE BUILD_ATTR_STACK
     13191**LABEL   13209--GOTO
BEGINNING_TIME
      8261**DCL     11000>>ASSIGN  11205>>IF      11817<<ASSIGN  11850--ASSIGN  12641<<ASSIGN  12643--ASSIGN
     12798>>IF      13249>>IF      13249>>IF      13249>>IF      13261>>IF      13271>>IF      13277>>IF
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:439  
     13284>>IF
BREAK_IN
      9929**DCL     10878<>CALL
BREAK_IN.V
      9929**DCL      9929--DCLINIT
BROKEN_FILE
      8329**DCL     11839<<ASSIGN  11910>>IF      11911<<ASSIGN
BROKEN_FILE_PLACE IN PROCEDURE SET_DEFAULTS
     11839**LABEL   11824--CALLALT
BUILD_ATTR_STACK
     13188**PROC    11155--CALL
BUILD_CONSOLE_STACK
     12999**PROC    10999--CALL    12933--CALL    12962--CALL
B_VERSION
      8282**DCL     10896--CALLBLT
B_VERSION.L
      8283**DCL      8287--IMP-SIZ 10896>>CALLBLT 10897>>ASSIGN
B_VERSION_.C
      8287**DCL     10896>>CALLBLT
C
      8335**DCL     13326<<DOINDEX 13327>>ASSIGN  13333>>ASSIGN  13378<<DOINDEX 13379>>ASSIGN
CANT_CALL_GDS IN PROCEDURE OPEN_TO_RANGE
     12862**LABEL   12786--CALLALT 12811--CALLALT
CANT_CALL_INT
     11613**LABEL   10878--CALLALT
CANT_CALL_RANGE_CONV IN PROCEDURE CLOBBER_TIME_DEFAULTS
     12691**LABEL   12644--CALLALT 12669--CALLALT
CANT_CALL_TIME IN PROCEDURE SET_DEFAULTS
     11934**LABEL   11851--CALLALT 11874--CALLALT
CANT_CALL_TIME_CONV IN PROCEDURE CLOBBER_TIME_DEFAULTS
     12679**LABEL   12639--CALLALT 12665--CALLALT
CANT_CALL_TIME_SIM
     11635**LABEL   11497--CALLALT
CANT_CALL_TIME_UTS
     11647**LABEL   11523--CALLALT
CANT_CALL_TPSET
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:440  
     11469**LABEL   11454--CALLALT
CANT_CALL_XCON
     11683**LABEL   10883--CALLALT
CANT_CALL_XUR_ERRMSG
     11624**LABEL   10965--CALLALT 11078--CALLALT
CANT_CLOSE_CS IN PROCEDURE CLOSE_SPECIFIC_FILE
     12199**LABEL   12158--CALLALT
CANT_CLOSE_CS IN PROCEDURE OPEN_SPECIFIC_FILE
     12123**LABEL   12023--CALLALT
CANT_CLOSE_HISTORY IN PROCEDURE CLOSE_SPECIFIC_FILE
     12187**LABEL   12146--CALLALT
CANT_CLOSE_LO
     11730**LABEL   11588--CALLALT
CANT_CLOSE_LO IN PROCEDURE SET_DESTINATION
     12416**LABEL   12407--CALLALT
CANT_CLOSE_OCMSG
     11718**LABEL   11584--CALLALT
CANT_FID IN PROCEDURE SET_DESTINATION
     12430**LABEL   12416--CALLALT
CANT_HELP
     11067**LABEL   11035--CALLALT 11039--CALLALT
CANT_OPEN_CS IN PROCEDURE CLOSE_SPECIFIC_FILE
     12158**LABEL   12154--CALLALT
CANT_OPEN_CS IN PROCEDURE OPEN_SPECIFIC_FILE
     12082**LABEL   12019--CALLALT
CANT_OPEN_DEST IN PROCEDURE SET_DESTINATION
     12443**LABEL   12418--CALLALT
CANT_OPEN_HIST IN PROCEDURE OPEN_SPECIFIC_FILE
     12109**LABEL   12040--GOTO
CANT_OPEN_LO
     11694**LABEL   10948--CALLALT
CANT_OPEN_OCMSG
     11671**LABEL   11017--CALLALT
CANT_POSITION_AT_END IN PROCEDURE SET_DEFAULTS
     11925**LABEL   11912--GOTO
CANT_PRECORD IN PROCEDURE CLOSE_UP
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:441  
     12971**LABEL   12932--CALLALT 12961--CALLALT
CANT_PRECORD IN PROCEDURE OPEN_TO_RANGE
     12889**LABEL   12845--CALLALT
CANT_PRECORD IN PROCEDURE SET_DEFAULTS
     11957**LABEL   11826--CALLALT
CANT_READ_HIST IN PROCEDURE OPEN_TO_RANGE
     12880**LABEL   12796--CALLALT 12831--CALLALT
CANT_READ_HIST IN PROCEDURE SET_DEFAULTS
     11910**LABEL   11816--CALLALT 11828--CALLALT
CANT_READ_STATUS IN PROCEDURE OPEN_TO_RANGE
     12871**LABEL   12795--CALLALT 12830--CALLALT
CANT_WRITE
     11590**LABEL   11530--CALLALT
CANT_WRITE_CS IN PROCEDURE CLOSE_SPECIFIC_FILE
     12178**LABEL   12156--CALLALT
CANT_WRITE_CS IN PROCEDURE OPEN_SPECIFIC_FILE
     12097**LABEL   12022--CALLALT
CANT_WRITE_TIME
     11659**LABEL   11511--CALLALT
CENTISEC1
      8224**DCL     11857<<ASSIGN  12492<<ASSIGN  12523<<ASSIGN  12633>>CALLBLT
CENTISEC2
      8233**DCL     11880<<ASSIGN  12562<<ASSIGN  12594<<ASSIGN  12659>>CALLBLT
CHECK_END
     11523**LABEL   11088--GOTO    11096--CALLALT
CHECK_TIME
     11195**LABEL   11120--GOTO    11124--GOTO    11133--GOTO    11143--GOTO    11147--GOTO    11164--GOTO
     11168--GOTO    11172--GOTO    11181--GOTO    11186--GOTO    11189--GOTO
CINDEX
      8336**DCL     11565>>IF      13321<<ASSIGN  13326>>DOINDEX 13348<<ASSIGN  13348>>ASSIGN  13356>>ASSIGN
     13378>>DOINDEX
CLOBBER_TIME_DEFAULTS
     12627**PROC    10986--CALL
CLOSE_HISTORYE
      8889**DCL     12146<>CALL
CLOSE_HISTORYE.SN_
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:442  
      8889**DCL      8889--REDEF
CLOSE_HISTORYE.UTL_
      8890**DCL      8890--REDEF
CLOSE_HISTORYE.V
      8894**DCL      8889--DCLINIT
CLOSE_HISTORYE.V.EXPIRE#
      8904**DCL      8904--REDEF
CLOSE_HISTORYE.V.TYPE#
      8902**DCL      8902--REDEF
CLOSE_HISTORYE.V.XTNSIZE#
      8899**DCL      8899--REDEF    8901--REDEF
CLOSE_LO
     10712**DCL     11588<>CALL    12407<>CALL
CLOSE_LO.SN_
     10712**DCL     10712--REDEF
CLOSE_LO.UTL_
     10713**DCL     10713--REDEF
CLOSE_LO.V
     10717**DCL     10712--DCLINIT
CLOSE_LO.V.EXPIRE#
     10727**DCL     10727--REDEF
CLOSE_LO.V.TYPE#
     10725**DCL     10725--REDEF
CLOSE_LO.V.XTNSIZE#
     10722**DCL     10722--REDEF   10724--REDEF
CLOSE_OCMSG
      9095**DCL     11584<>CALL
CLOSE_OCMSG.SN_
      9095**DCL      9095--REDEF
CLOSE_OCMSG.UTL_
      9096**DCL      9096--REDEF
CLOSE_OCMSG.V
      9100**DCL      9095--DCLINIT
CLOSE_OCMSG.V.EXPIRE#
      9110**DCL      9110--REDEF
CLOSE_OCMSG.V.TYPE#
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:443  
      9108**DCL      9108--REDEF
CLOSE_OCMSG.V.XTNSIZE#
      9105**DCL      9105--REDEF    9107--REDEF
CLOSE_OUT
     11773**LABEL   11027--GOTO
CLOSE_OUT.SN_
      9333**DCL      9333--REDEF
CLOSE_OUT.UTL_
      9334**DCL      9334--REDEF
CLOSE_OUT.V
      9338**DCL      9333--DCLINIT
CLOSE_OUT.V.EXPIRE#
      9348**DCL      9348--REDEF
CLOSE_OUT.V.TYPE#
      9346**DCL      9346--REDEF
CLOSE_OUT.V.XTNSIZE#
      9343**DCL      9343--REDEF    9345--REDEF
CLOSE_SPECIFIC_FILE
     12145**PROC    11845--CALL    12819--CALL    12915--CALL    12927--CALL    12941--CALL    12956--CALL
     12970--CALL
CLOSE_UP
     12909**PROC    11561--CALL
CMD_INSTR
      8159**DCL      9302--DCLINIT 10956--CALL
CONSOLE
      8256**DCL     12232<<ASSIGN  12298<<ASSIGN  12333<<ASSIGN  12354>>CALLBLT 12355>>CALLBLT 13001>>IF
     13020>>IF      13027>>IF      13028>>IF      13034>>IF      13035>>IF      13228>>IF      13231>>IF
     13231>>IF      13234>>IF      13234>>IF
CONSOLE_REPORT
      8339**DCL     11052<<ASSIGN  11058<<ASSIGN  11219>>IF      11565>>IF      12315<<ASSIGN  12332<<ASSIGN
     12383>>IF
CONS_RECORD
      8416**DCL     13327<<ASSIGN  13333>>ASSIGN  13356>>ASSIGN  13379<<ASSIGN
CONS_RECORD.DEVNM
      8418**DCL     13329>>IF      13352<<ASSIGN  13382>>CALLBLT
CONS_RECORD.KEYINS
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:444  
      8420**DCL     13332<<ASSIGN  13332>>ASSIGN  13354<<ASSIGN  13383>>CALLBLT 13386>>IF      13389>>ASSIGN
     13398>>ASSIGN  13398>>ASSIGN
CONS_RECORD.LOGON
      8417**DCL     13351<<ASSIGN  13381>>CALLBLT
CONS_RECORD.TERMINAL
      8419**DCL     13329>>IF      13353<<ASSIGN  13382>>CALLBLT
CSACCT
     10121**DCL     10009--DCLINIT
CSCGNM
     10075**DCL     10005--DCLINIT
CSTACK
      8441**DCL     13327>>ASSIGN  13333<<ASSIGN  13356<<ASSIGN  13379>>ASSIGN
CSTACK_RESULTS_VEC
      9734**DCL      9716--DCLINIT  9752--DCLINIT 10944<<ASSIGN
CSTACK_RESULTS_VEC.PTR$
      9736**DCL     13327>>ASSIGN  13333>>ASSIGN  13356>>ASSIGN  13379>>ASSIGN
CSTACK_RESULTS_VEC.W2
      9735**DCL      9736--REDEF
CS_CLOSE
     10237**DCL     12023<>CALL    12158<>CALL
CS_CLOSE.SN_
     10237**DCL     10237--REDEF
CS_CLOSE.UTL_
     10238**DCL     10238--REDEF
CS_CLOSE.V
     10242**DCL     10237--DCLINIT
CS_CLOSE.V.EXPIRE#
     10252**DCL     10252--REDEF
CS_CLOSE.V.TYPE#
     10250**DCL     10250--REDEF
CS_CLOSE.V.XTNSIZE#
     10247**DCL     10247--REDEF   10249--REDEF
CS_OPEN
     10004**DCL     12019<>CALL    12154<>CALL
CS_OPEN.ACSVEH_
     10006**DCL     10007--REDEF
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:445  
CS_OPEN.ALTKEYS_
     10012**DCL     10013--REDEF   10013--REDEF
CS_OPEN.HDR_
     10011**DCL     10012--REDEF
CS_OPEN.TAB_
     10010**DCL     10011--REDEF
CS_OPEN.UHL_
     10004**DCL     10005--REDEF   10005--REDEF
CS_OPEN.V
     10013**DCL     10004--DCLINIT
CS_OPEN.V.FSN#
     10044**DCL     10044--REDEF   10044--REDEF
CS_OPEN.WSN_
     10010**DCL     10010--REDEF
CUR_YR IN PROCEDURE TIME_VALIDATE
     12719**DCL     12748<<CALLBLT 12753>>IF      12754<<ASSIGN  12754>>ASSIGN  12755<<ASSIGN  12755>>ASSIGN
     12765>>IF
C_FREE_SPACE
      8333**DCL     13339>>IF      13341<<ASSIGN  13357<<ASSIGN  13357>>ASSIGN
C_PAGES
      8334**DCL     10939>>ASSIGN  10942<<ASSIGN  13340<<ASSIGN  13340>>ASSIGN
DATE_BUF
      8264**DCL      9823--DCLINIT  9824--DCLINIT 11861>>ASSIGN  11862>>ASSIGN  11863>>ASSIGN  11884>>ASSIGN
     11885>>ASSIGN  11886>>ASSIGN  12748>>CALLBLT
DAY
      8303**DCL     12532<<CALLBLT 12603<<CALLBLT 12759>>IF
DAY1
      8227**DCL     11863<<ASSIGN  11907<<ASSIGN  12503<<ASSIGN  12504<<CALLBLT 12504--CALLBLT 12532>>CALLBLT
     12628>>CALLBLT
DAY2
      8236**DCL     11886<<ASSIGN  11907>>ASSIGN  12574<<ASSIGN  12575<<CALLBLT 12575--CALLBLT 12603>>CALLBLT
     12654>>CALLBLT
DAY_LIST IN PROCEDURE TIME_VALIDATE
     12721**DCL     12759>>IF
DCB#
      8246**DCL     11597<<ASSIGN  11600<>CALL    11602<>CALL    11679<<ASSIGN  11682<>CALL    11684<>CALL
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:446  
     11705<<ASSIGN  11706<>CALL    11708<>CALL    11728<<ASSIGN  11729<>CALL    11731<>CALL    11739<<ASSIGN
     11740<>CALL    11742<>CALL    11760<<ASSIGN  11763<>CALL    11765<>CALL    11921<<ASSIGN  11924<>CALL
     11926<>CALL    11955<<ASSIGN  11956<>CALL    11958<>CALL    11974<<ASSIGN  11977<>CALL    11979<>CALL
     12063<<ASSIGN  12066<>CALL    12077<<ASSIGN  12080<>CALL    12082<>CALL    12093<<ASSIGN  12096<>CALL
     12098<>CALL    12105<<ASSIGN  12108<>CALL    12110<>CALL    12117<<ASSIGN  12120<>CALL    12122<>CALL
     12130<<ASSIGN  12133<>CALL    12135<>CALL    12174<<ASSIGN  12177<>CALL    12179<>CALL    12183<<ASSIGN
     12186<>CALL    12188<>CALL    12195<<ASSIGN  12198<>CALL    12200<>CALL    12204<<ASSIGN  12207<>CALL
     12209<>CALL    12428<<ASSIGN  12429<>CALL    12431<>CALL    12439<<ASSIGN  12442<>CALL    12444<>CALL
     12448<<ASSIGN  12451<>CALL    12453<>CALL    12878<<ASSIGN  12879<>CALL    12881<>CALL    12885<<ASSIGN
     12888<>CALL    12890<>CALL
DESTINATION
      8253**DCL     12404<<ASSIGN  12409--ASSIGN
DEST_ACCT
     10440**DCL     10355--DCLINIT 10647--DCLINIT
DEST_NAME
     10392**DCL     10355--DCLINIT 10643--DCLINIT
DEST_PASS
     10454**DCL     10356--DCLINIT 10644--DCLINIT
DEST_RESULTS
     10420**DCL     10358--DCLINIT
DEST_WSN
     10406**DCL     10356--DCLINIT 10648--DCLINIT
DIRECT
      8319**DCL     11184>>IF      13015<<ASSIGN  13022<<ASSIGN  13029<<ASSIGN  13038<<ASSIGN  13045<<ASSIGN
     13053<<ASSIGN  13060<<ASSIGN
DISPLAY_CONSOLES
     13365**PROC    11565--CALL
DISPLAY_LOGONS
     13215**PROC    11567--CALL
DO_ALL IN PROCEDURE BUILD_CONSOLE_STACK
     13011**LABEL   13007--GOTO
DO_DISPLAY
     12349**PROC    11045--CALL
DO_LIST
     11068**LABEL   11021--GOTO    11100--GOTO    11105--GOTO    11109--GOTO    11119--GOTO    11129--GOTO
     11132--GOTO    11139--GOTO    11142--GOTO    11149--GOTO    11198--GOTO    11205--GOTO    11221--GOTO
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:447  
     11447--GOTO    11475--GOTO    11537--GOTO    11562--GOTO
DO_RESET
     12283**PROC    11042--CALL
DO_TIME
     12460**PROC    10977--CALL
ENDING_TIME
      8262**DCL      8263--REDEF   11207>>IF      11829<<ASSIGN  11873--ASSIGN  12666<<ASSIGN  12668--ASSIGN
     12926>>IF      12955>>IF      13249>>IF      13249>>IF      13249>>IF      13261>>IF      13274>>IF
     13277>>IF      13287>>IF
ENDING_TIME_REDEF
      8263**DCL     11841<<ASSIGN
ERROR
      8364**DCL      9129--DCLINIT 10958<<ASSIGN  11075<<ASSIGN  11087<<ASSIGN  11473<<ASSIGN  11546<<ASSIGN
     11555<<ASSIGN  11556<>CALL    11601<<ASSIGN  11602<>CALL    11613<<ASSIGN  11614<>CALL    11624<<ASSIGN
     11625<>CALL    11635<<ASSIGN  11636<>CALL    11647<<ASSIGN  11648<>CALL    11659<<ASSIGN  11660<>CALL
     11671<<ASSIGN  11672<>CALL    11683<<ASSIGN  11684<>CALL    11694<<ASSIGN  11695<>CALL    11707<<ASSIGN
     11708<>CALL    11718<<ASSIGN  11719<>CALL    11730<<ASSIGN  11731<>CALL    11741<<ASSIGN  11742<>CALL
     11752<<ASSIGN  11753<>CALL    11764<<ASSIGN  11765<>CALL    11840<<ASSIGN  11925<<ASSIGN  11926<>CALL
     11945<<ASSIGN  11946<>CALL    11957<<ASSIGN  11958<>CALL    11965<<ASSIGN  11966<>CALL    11978<<ASSIGN
     11979<>CALL    12081<<ASSIGN  12082<>CALL    12097<<ASSIGN  12098<>CALL    12109<<ASSIGN  12110<>CALL
     12121<<ASSIGN  12122<>CALL    12134<<ASSIGN  12135<>CALL    12178<<ASSIGN  12179<>CALL    12187<<ASSIGN
     12188<>CALL    12199<<ASSIGN  12200<>CALL    12208<<ASSIGN  12209<>CALL    12430<<ASSIGN  12431<>CALL
     12443<<ASSIGN  12444<>CALL    12452<<ASSIGN  12453<>CALL    12691<<ASSIGN  12692<>CALL    12703<<ASSIGN
     12704<>CALL    12871<<ASSIGN  12872<>CALL    12880<<ASSIGN  12881<>CALL    12889<<ASSIGN  12890<>CALL
     12898<<ASSIGN  12899<>CALL    12989<<ASSIGN  12990<>CALL    13079<<ASSIGN  13080<>CALL    13092<<ASSIGN
     13093<>CALL
ERROR.ERR#
      8367**DCL     10949<<ASSIGN  10983<<ASSIGN  11088>>IF      11548>>IF      11548>>IF      11766<<ASSIGN
     11980<<ASSIGN  12123<<ASSIGN  12832<<ASSIGN
ERR_FIND_TEMP
      9129**DCL     11474<>CALL
ERR_FIND_TEMP.V
      9133**DCL      9129--DCLINIT
ERR_GETTING_CMD
      9239**DCL     10969<>CALL
ERR_GETTING_CMD.V
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:448  
      9239**DCL      9239--DCLINIT
ERR_GETTING_CMD.V.STEPCC#
      9240**DCL      9240--REDEF
F$DCB.ACCT#
      7787**DCL     11993>>IF      11994>>ASSIGN
F$DCB.ACTPOS
      7803**DCL      7803--REDEF
F$DCB.ARS#
      7777**DCL      7777--REDEF   11243>>ASSIGN  11404>>ASSIGN
F$DCB.ATTR
      7796**DCL      7797--REDEF
F$DCB.BORROW
      7811**DCL      7811--REDEF    7811--REDEF    7811--REDEF
F$DCB.DCBNAME.L
      7825**DCL      7825--IMP-SIZ
F$DCB.EOMCHAR#
      7781**DCL      7781--REDEF
F$DCB.FCD#
      7790**DCL     10947>>IF      12406>>IF
F$DCB.FLDID
      7806**DCL      7806--REDEF
F$DCB.FORM$
      7800**DCL      7800--REDEF
F$DCB.FSECT
      7816**DCL      7816--REDEF
F$DCB.FSN#
      7793**DCL      7793--REDEF    7793--REDEF    7794--REDEF
F$DCB.HEADER$
      7799**DCL      7799--REDEF
F$DCB.IXTNSIZE#
      7797**DCL      7797--REDEF
F$DCB.LASTSTA$
      7786**DCL      7786--REDEF
F$DCB.LVL
      7812**DCL      7812--REDEF
F$DCB.NAME#
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:449  
      7787**DCL     11991>>ASSIGN
F$DCB.NAME#.C
      7787**DCL      7787--REDEF
F$DCB.NOEOF
      7809**DCL      7809--REDEF
F$DCB.NRECS#
      7798**DCL      7798--REDEF
F$DCB.NRECX
      7817**DCL      7817--REDEF
F$DCB.OHDR
      7809**DCL      7809--REDEF
F$DCB.ORG#
      7792**DCL      7792--REDEF
F$DCB.PASS#
      7787**DCL     11996>>IF      11997--ASSIGN
F$DCB.PRECNO
      7815**DCL      7815--REDEF
F$DCB.PSN#
      7787**DCL     11999>>IF      12000--ASSIGN
F$DCB.RCSZ
      7821**DCL      7821--REDEF
F$DCB.RES#
      7788**DCL      7788--REDEF
F$DCB.SETX
      7800**DCL      7800--REDEF
F$DCB.TAB$
      7800**DCL      7800--REDEF
F$DCB.TDA
      7814**DCL      7815--REDEF
F$DCB.WSN#
      7788**DCL      7788--REDEF
F$HISTFILE
      8146**DCL     11243--ASSIGN  11404--ASSIGN
FDS_RESULTS_VEC
      9555**DCL      9538--DCLINIT
FDS_RESULTS_VEC.PTR$
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:450  
      9557**DCL     10911<<ASSIGN  12913<<ASSIGN  12924<<ASSIGN  12953<<ASSIGN
FDS_RESULTS_VEC.W2
      9556**DCL      9557--REDEF
FID_DEST
     10354**DCL     12416<>CALL
FID_DEST.TEXTFID_
     10354**DCL     12409<<ASSIGN
FID_DEST.V
     10358**DCL     10354--DCLINIT
FID_NAME
      8846**DCL      8777--DCLINIT  8891--DCLINIT 10307--DCLINIT 11991<<ASSIGN  12791>>ASSIGN  12818<<ASSIGN
     12823<<ASSIGN  12828<<ASSIGN  12912<<ASSIGN  12923<<ASSIGN  12929<<ASSIGN  12952<<ASSIGN  12958<<ASSIGN
FID_NAME.L#
      8846**DCL     11799<<ASSIGN  12054>>IF      12054>>IF
FID_NAME.NAME#
      8846**DCL     11207>>IF      11798<<ASSIGN  12015>>IF      12150>>IF
FILE_TROUBLE IN PROCEDURE SET_DEFAULTS
     11965**LABEL   11806--GOTO
FIND_RANGE IN PROCEDURE OPEN_TO_RANGE
     12791**LABEL   12836--GOTO
FIRST_HIST_REC
     10202**DCL     11826<>CALL    12845<>CALL    12932<>CALL    12961<>CALL
FIRST_HIST_REC.V
     10204**DCL     10202--DCLINIT
FIRST_HIST_REC.V.N#
     10208**DCL     11825<<ASSIGN  12844<<ASSIGN  12931<<ASSIGN  12960<<ASSIGN
FIRST_TIME
      8332**DCL     10943<<ASSIGN  11053<<ASSIGN  13319>>IF      13345>>IF      13350<<ASSIGN
FMPRIV
     10828**DCL     10848<>CALL
FMPRIV.V
     10828**DCL     10828--DCLINIT
FOUND_IT
      8331**DCL     13325<<ASSIGN  13334<<ASSIGN  13347>>IF
FPT_DATE
      8271**DCL      9799--DCLINIT  9800--DCLINIT 12628<<CALLBLT 12654<<CALLBLT
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:451  
FPT_TIME
      8272**DCL      9801--DCLINIT  9802--DCLINIT 12633<<CALLBLT 12659<<CALLBLT
FREE_ASTACK_SEG
      9698**DCL     10922<>CALL    11197<>CALL    11203<>CALL
FREE_ASTACK_SEG.V
      9698**DCL      9698--DCLINIT
FREE_C_PAGE
      9752**DCL     10940<>CALL
FREE_C_PAGE.V
      9752**DCL      9752--DCLINIT
FREE_C_PAGE.V.SEGSIZE#
      9754**DCL     10939<<ASSIGN
FREE_LSTACK_SEG
      9644**DCL     10930<>CALL
FREE_LSTACK_SEG.V
      9644**DCL      9644--DCLINIT
FREE_LSTACK_SEG.V.SEGSIZE#
      9646**DCL     10929<<ASSIGN
FREE_SPACE
      8326**DCL     10996<<ASSIGN  13161>>IF      13163<<ASSIGN  13170<<ASSIGN  13170>>ASSIGN  13179<<ASSIGN
     13179>>ASSIGN
GATHER_C_STATS
     13316**PROC    11220--CALL
GDS_RESULTS_VEC
      9520**DCL      9502--DCLINIT
GDS_RESULTS_VEC.PTR$
      9522**DCL     10911>>ASSIGN  10917<<ASSIGN  12791>>ASSIGN  12813>>ASSIGN  12818>>ASSIGN  12821>>IF
     12823>>ASSIGN  12828>>ASSIGN  12912>>ASSIGN  12913>>ASSIGN  12923>>ASSIGN  12924>>ASSIGN  12929>>ASSIGN
     12952>>ASSIGN  12953>>ASSIGN  12958>>ASSIGN
GDS_RESULTS_VEC.W2
      9521**DCL      9522--REDEF
GEN_ERR.V
      9165**DCL      9161--DCLINIT
GET_ATTR_SEG
      9662**DCL     11154<>CALL
GET_ATTR_SEG.V
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:452  
      9662**DCL      9662--DCLINIT
GET_C_PAGE
      9716**DCL     13342<>CALL
GET_C_PAGE.V
      9716**DCL      9716--DCLINIT
GET_DCB_INFO.V
     10310**DCL     10306--DCLINIT
GET_LSTACK_SEG
      9608**DCL     13162<>CALL
GET_LSTACK_SEG.V
      9608**DCL      9608--DCLINIT
HELP_ACCT
     10812**DCL      7544--DCLINIT
HELP_NAME
     10797**DCL      7543--DCLINIT
HERE
      8241**DCL     11272<<ASSIGN  11296>>CALLBLT 11301<<ASSIGN  11301>>ASSIGN  11309>>CALLBLT 11310<<ASSIGN
     11310>>ASSIGN  11319>>CALLBLT 11320<<ASSIGN  11320>>ASSIGN  11326<<ASSIGN  11330<<ASSIGN  11333>>CALLBLT
     11342>>ASSIGN
HIST_POSITION
      9772**DCL     11086<>CALL    11812<>CALL
HIST_POSITION.V
      9774**DCL      9772--DCLINIT
HIST_POSITION.V.N#
      9778**DCL     11002<<ASSIGN  11091>>IF      11092<<ASSIGN  11811<<ASSIGN  12936<<ASSIGN  12965<<ASSIGN
HOUR1
      8221**DCL     11854<<ASSIGN  12475<<ASSIGN  12476<<CALLBLT 12476--CALLBLT 12520<<ASSIGN  12533>>CALLBLT
     12633>>CALLBLT
HOUR2
      8230**DCL     11877<<ASSIGN  12545<<ASSIGN  12546<<CALLBLT 12546--CALLBLT 12591<<ASSIGN  12604>>CALLBLT
     12659>>CALLBLT
HR
      8304**DCL     12533<<CALLBLT 12604<<CALLBLT 12765>>IF
I
      8247**DCL     12463<<DOINDEX 12464>>ASSIGN
IND
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:453  
      8240**DCL     11278<<DOINDEX 11289>>IF      11289>>IF      11296>>CALLBLT 11296>>CALLBLT 11301>>ASSIGN
     11304>>IF      11314>>IF
INITIALIZE
     10898**LABEL   10871--REMEMBR 11590--GOTO    11775--GOTO
IOPT IN PROCEDURE SELECTION_RETRIEVER
     12221**DCL     12223<<DOINDEX 12225>>ASSIGN
IP_ATTR_TYPE
      8323**DCL     11114>>IF      11123>>IF      11126>>IF      11136>>IF      11146>>IF      12243<<ASSIGN
     12246<<ASSIGN  12251<<ASSIGN  12256<<ASSIGN  12263<<ASSIGN  12370>>IF      12371>>IF      12372>>IF
     12373>>IF      12374>>IF
IP_LOC_TYPE
      8322**DCL     11129>>IF      11131>>IF      11139>>IF      11141>>IF      12240<<ASSIGN  12248<<ASSIGN
     12253<<ASSIGN  12260<<ASSIGN  12309<<ASSIGN  12338<<ASSIGN  12370>>CALLBLT 12371>>CALLBLT
KEEP_ON_LISTING
      8308**DCL     11562>>IF      12916<<ASSIGN  12937<<ASSIGN  12942<<ASSIGN  12966<<ASSIGN  12971<<ASSIGN
KEYIN_TOTAL
      8337**DCL     13320<<ASSIGN  13331<<ASSIGN  13331>>ASSIGN  13355<<ASSIGN  13355>>ASSIGN  13386>>IF
     13390>>ASSIGN  13398>>ASSIGN  13398>>ASSIGN  13410>>CALLBLT
KSST
     10092**DCL     10005--DCLINIT
KSST.MYSTATION#
     10096**DCL     10863<<CALLBLT
L
      8313**DCL     13114<<DOINDEX 13115>>ASSIGN  13173>>ASSIGN  13189<<ASSIGN  13193>>ASSIGN  13194<<ASSIGN
     13194>>ASSIGN  13195>>ASSIGN  13196<<ASSIGN  13196>>ASSIGN  13209>>IF      13224<<DOINDEX 13225>>ASSIGN
     13226>>ASSIGN
LANGUAGE
      8258**DCL     10861<<ASSIGN  11024<<ASSIGN  11256<>CALL    11358<>CALL    12321<<ASSIGN  12340<<ASSIGN
LEAP IN PROCEDURE TIME_VALIDATE
     12717**DCL     12737<<ASSIGN  12738<<ASSIGN  12740>>IF
LEAP_VAR IN PROCEDURE TIME_VALIDATE
     12718**DCL     12741<<ASSIGN  12742<<ASSIGN  12759>>IF
LINDEX
      8312**DCL     10998<<ASSIGN  13106<<ASSIGN  13114>>DOINDEX 13168>>ASSIGN  13169<<ASSIGN  13169>>ASSIGN
     13177>>ASSIGN  13178<<ASSIGN  13178>>ASSIGN  13191>>IF      13209>>IF      13224>>DOINDEX
LISTPTR$
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:454  
      8208**DCL     12464<<ASSIGN  12465>>ASSIGN  12467>>DOCASE  12471>>ASSIGN  12541>>ASSIGN
LOCATION
      8257**DCL     12233<<ASSIGN  12299<<ASSIGN  12334<<ASSIGN  12355>>CALLBLT 13001>>IF      13020>>IF
     13021>>IF      13027>>IF      13034>>IF      13036>>IF      13228>>IF      13228>>IF      13231>>IF
     13234>>IF      13234>>IF
LOGON
      8260**DCL     12236<<ASSIGN  12302<<ASSIGN  12335<<ASSIGN  12359>>CALLBLT 13001>>IF      13043>>IF
     13043>>IF      13238>>IF      13238>>IF
LOGON_REC_OFF
      8397**DCL     13195<<ASSIGN  13226<<ASSIGN
LOGON_REC_OFF.UTS
      8405**DCL     13198>>IF      13198>>IF      13249>>IF      13249>>IF      13249>>IF      13249>>IF
     13277>>IF      13277>>IF      13279--ASSIGN  13284>>IF      13287>>IF      13287>>IF
LOGON_REC_ON
      8386**DCL     13115<<ASSIGN  13168>>ASSIGN  13173>>ASSIGN  13177>>ASSIGN  13193<<ASSIGN  13225<<ASSIGN
LOGON_REC_ON.ATTRO
      8389**DCL     13152<<ASSIGN  13202>>ASSIGN
LOGON_REC_ON.LOGON
      8390**DCL     13153<<ASSIGN  13238>>IF      13290--ASSIGN  13304>>CALLBLT
LOGON_REC_ON.STATION.FIRST_HALF
      8392**DCL     13117>>IF      13155<<ASSIGN  13205>>ASSIGN  13231>>IF      13234>>IF      13290--ASSIGN
     13305>>CALLBLT
LOGON_REC_ON.STATION.SECND_HALF
      8393**DCL     13117>>IF      13156<<ASSIGN  13206>>ASSIGN
LOGON_REC_ON.STATUS
      8395**DCL     13158<<ASSIGN  13265>>IF
LOGON_REC_ON.TERM_NAME
      8387**DCL     13150<<ASSIGN  13204>>ASSIGN  13228>>IF      13234>>IF      13290--ASSIGN  13305>>CALLBLT
LOGON_REC_ON.UTS
      8394**DCL     13121>>IF      13128>>IF      13157<<ASSIGN  13176<<ASSIGN  13198>>IF      13249>>IF
     13249>>IF      13249>>IF      13261>>IF      13261>>IF      13263--ASSIGN  13271>>IF      13274>>IF
LOGON_REC_ON.WSN
      8388**DCL     13151<<ASSIGN  13203>>ASSIGN  13241>>CALLBLT 13242>>IF
LOGON_REPORT
      8328**DCL     11054<<ASSIGN  11057<<ASSIGN  11084>>IF      11567>>IF      12312<<ASSIGN  12331<<ASSIGN
     12378>>IF      13007>>IF      13065>>IF      13245>>IF
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:455  
LOGON_TITLE
      8330**DCL     13154<<ASSIGN  13216<<CALLBLT 13217<<CALLBLT 13218<<CALLBLT 13219<<CALLBLT 13220>>ASSIGN
     13366<<ASSIGN  13367<<CALLBLT 13368<<CALLBLT 13369<<CALLBLT 13370<<CALLBLT 13374>>ASSIGN
LOSE_IT
     11197**LABEL   11157--GOTO
LRECS
      8315**DCL     13104<<ASSIGN  13122<<ASSIGN  13132<<ASSIGN  13140<<ASSIGN  13175>>IF
LSTACK
      8422**DCL     13115>>ASSIGN  13168<<ASSIGN  13173<<ASSIGN  13177<<ASSIGN  13193>>ASSIGN  13195>>ASSIGN
     13225>>ASSIGN  13226>>ASSIGN
LSTACK_RESULTS_VEC
      9626**DCL      9608--DCLINIT  9644--DCLINIT
LSTACK_RESULTS_VEC.PTR$
      9628**DCL     10933<<ASSIGN  13115>>ASSIGN  13168>>ASSIGN  13173>>ASSIGN  13177>>ASSIGN  13193>>ASSIGN
     13195>>ASSIGN  13225>>ASSIGN  13226>>ASSIGN
LSTACK_RESULTS_VEC.W2
      9627**DCL      9628--REDEF
M$CLOSE
        49**DCL-ENT 11584--CALL    11588--CALL    12023--CALL    12146--CALL    12158--CALL    12407--CALL
M$ERR
        61**DCL-ENT 10969--CALL
M$ERRMSG
       112**DCL-ENT 11474--CALL
M$EXIT
        61**DCL-ENT 11778--CALL
M$FDS
        84**DCL-ENT 10913--CALL    10922--CALL    10930--CALL    10940--CALL    11197--CALL    11203--CALL
     12914--CALL    12925--CALL    12954--CALL
M$FID
       112**DCL-ENT 12416--CALL
M$GDS
        84**DCL-ENT 11154--CALL    12786--CALL    12811--CALL    13162--CALL    13342--CALL
M$IN
      8142**DCL     10888<>CALL
M$INT
       104**DCL-ENT 10878--CALL
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:456  
M$LO
      8144**DCL     10855<>CALL    10888<>CALL    10947--IF      10961<>CALL    10962<>CALL    10965<>CALL
     11078<>CALL    11554<>CALL    11556<>CALL    11580<>CALL    11600<>CALL    11602<>CALL    11612<>CALL
     11614<>CALL    11623<>CALL    11625<>CALL    11634<>CALL    11636<>CALL    11646<>CALL    11648<>CALL
     11658<>CALL    11660<>CALL    11670<>CALL    11672<>CALL    11682<>CALL    11684<>CALL    11693<>CALL
     11695<>CALL    11706<>CALL    11708<>CALL    11717<>CALL    11719<>CALL    11729<>CALL    11731<>CALL
     11740<>CALL    11742<>CALL    11751<>CALL    11753<>CALL    11763<>CALL    11765<>CALL    11774<>CALL
     11924<>CALL    11926<>CALL    11935<>CALL    11944<>CALL    11946<>CALL    11956<>CALL    11958<>CALL
     11964<>CALL    11966<>CALL    11977<>CALL    11979<>CALL    12066<>CALL    12080<>CALL    12082<>CALL
     12096<>CALL    12098<>CALL    12108<>CALL    12110<>CALL    12120<>CALL    12122<>CALL    12133<>CALL
     12135<>CALL    12177<>CALL    12179<>CALL    12186<>CALL    12188<>CALL    12198<>CALL    12200<>CALL
     12207<>CALL    12209<>CALL    12406--IF      12429<>CALL    12431<>CALL    12442<>CALL    12444<>CALL
     12451<>CALL    12453<>CALL    12690<>CALL    12692<>CALL    12702<>CALL    12704<>CALL    12775<>CALL
     12863<>CALL    12870<>CALL    12872<>CALL    12879<>CALL    12881<>CALL    12888<>CALL    12890<>CALL
     12897<>CALL    12899<>CALL    12988<>CALL    12990<>CALL    13080<>CALL    13083<>CALL    13091<>CALL
     13093<>CALL
M$OPEN
        49**DCL-ENT 10948--CALL    11017--CALL    12019--CALL    12034--CALL    12043--CALL    12071--CALL
     12154--CALL    12418--CALL
M$PFIL
        51**DCL-ENT 11824--CALL
M$PRECORD
        53**DCL-ENT 11086--CALL    11812--CALL    11826--CALL    12845--CALL    12932--CALL    12961--CALL
M$PROMPT
        73**DCL-ENT 10865--CALL
M$READ
        50**DCL-ENT 11096--CALL    11816--CALL    11828--CALL    12795--CALL    12796--CALL    12830--CALL
     12831--CALL    13019--CALL
M$SI
      8145**DCL     11991--ASSIGN  11993--IF      11994--ASSIGN  11996--IF      11997--ASSIGN  11999--IF
     12000--ASSIGN
M$SPRIV
       108**DCL-ENT 10848--CALL
M$TIME
       116**DCL-ENT 11497--CALL    11523--CALL    11851--CALL    11874--CALL    12639--CALL    12644--CALL
     12665--CALL    12669--CALL    12745--CALL    13264--CALL    13280--CALL
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:457  
M$WAIT
       107**DCL-ENT 12042--CALL
M$WRITE
        50**DCL-ENT 10898--CALL    11472--CALL    11511--CALL    11530--CALL    12022--CALL    12156--CALL
     12357--CALL    12361--CALL    12365--CALL    12376--CALL    12381--CALL    12386--CALL    12391--CALL
     12679--CALL    13222--CALL    13307--CALL    13376--CALL    13408--CALL    13414--CALL
M$XCON
       104**DCL-ENT 10883--CALL    11777--CALL
M$XXX
        61**DCL-ENT 10856--CALL
MIN
      8305**DCL     12534<<CALLBLT 12605<<CALLBLT 12765>>IF
MIN1
      8222**DCL     11855<<ASSIGN  12483<<ASSIGN  12484<<CALLBLT 12484--CALLBLT 12521<<ASSIGN  12534>>CALLBLT
     12633>>CALLBLT
MIN2
      8231**DCL     11878<<ASSIGN  12553<<ASSIGN  12554<<CALLBLT 12554--CALLBLT 12592<<ASSIGN  12605>>CALLBLT
     12659>>CALLBLT
MODULE_ERR
      9192**DCL      9161--DCLINIT 10855<>CALL    11078<>CALL    11554<>CALL    11580<>CALL    11600<>CALL
     11612<>CALL    11623<>CALL    11634<>CALL    11646<>CALL    11658<>CALL    11670<>CALL    11682<>CALL
     11693<>CALL    11706<>CALL    11717<>CALL    11729<>CALL    11740<>CALL    11751<>CALL    11763<>CALL
     11774<>CALL    11924<>CALL    11935<>CALL    11944<>CALL    11956<>CALL    11964<>CALL    11977<>CALL
     12066<>CALL    12080<>CALL    12096<>CALL    12108<>CALL    12120<>CALL    12133<>CALL    12177<>CALL
     12186<>CALL    12198<>CALL    12207<>CALL    12429<>CALL    12442<>CALL    12451<>CALL    12690<>CALL
     12702<>CALL    12775<>CALL    12863<>CALL    12870<>CALL    12879<>CALL    12888<>CALL    12897<>CALL
     12988<>CALL    13083<>CALL    13091<>CALL
MODULE_ERR.ERR#
      9222**DCL     10853<<ASSIGN  11076<<ASSIGN  11552<<ASSIGN  11578<<ASSIGN  11598<<ASSIGN  11610<<ASSIGN
     11621<<ASSIGN  11632<<ASSIGN  11644<<ASSIGN  11656<<ASSIGN  11668<<ASSIGN  11680<<ASSIGN  11691<<ASSIGN
     11703<<ASSIGN  11715<<ASSIGN  11726<<ASSIGN  11738<<ASSIGN  11749<<ASSIGN  11761<<ASSIGN  11772<<ASSIGN
     11922<<ASSIGN  11933<<ASSIGN  11942<<ASSIGN  11953<<ASSIGN  11962<<ASSIGN  11975<<ASSIGN  12064<<ASSIGN
     12078<<ASSIGN  12094<<ASSIGN  12106<<ASSIGN  12118<<ASSIGN  12131<<ASSIGN  12175<<ASSIGN  12184<<ASSIGN
     12196<<ASSIGN  12205<<ASSIGN  12427<<ASSIGN  12440<<ASSIGN  12449<<ASSIGN  12688<<ASSIGN  12700<<ASSIGN
     12773<<ASSIGN  12861<<ASSIGN  12868<<ASSIGN  12876<<ASSIGN  12886<<ASSIGN  12895<<ASSIGN  12986<<ASSIGN
     13081<<ASSIGN  13089<<ASSIGN
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:458  
MODULE_ERR.SEV
      9222**DCL     10854<<ASSIGN  11077<<ASSIGN  11553<<ASSIGN  11579<<ASSIGN  11599<<ASSIGN  11611<<ASSIGN
     11622<<ASSIGN  11633<<ASSIGN  11645<<ASSIGN  11657<<ASSIGN  11669<<ASSIGN  11681<<ASSIGN  11692<<ASSIGN
     11704<<ASSIGN  11716<<ASSIGN  11727<<ASSIGN  11750<<ASSIGN  11762<<ASSIGN  11773<<ASSIGN  11923<<ASSIGN
     11934<<ASSIGN  11943<<ASSIGN  11954<<ASSIGN  11963<<ASSIGN  11976<<ASSIGN  12065<<ASSIGN  12079<<ASSIGN
     12095<<ASSIGN  12107<<ASSIGN  12119<<ASSIGN  12132<<ASSIGN  12176<<ASSIGN  12185<<ASSIGN  12197<<ASSIGN
     12206<<ASSIGN  12441<<ASSIGN  12450<<ASSIGN  12689<<ASSIGN  12701<<ASSIGN  12774<<ASSIGN  12862<<ASSIGN
     12869<<ASSIGN  12877<<ASSIGN  12887<<ASSIGN  12896<<ASSIGN  12987<<ASSIGN  13082<<ASSIGN  13090<<ASSIGN
MON
      8302**DCL     12531<<CALLBLT 12602<<CALLBLT 12740>>IF      12758>>IF      12759>>IF      12765>>IF
MONTH1
      8226**DCL     11862<<ASSIGN  11906<<ASSIGN  12495<<ASSIGN  12496<<CALLBLT 12496--CALLBLT 12531>>CALLBLT
     12628>>CALLBLT
MONTH2
      8235**DCL     11885<<ASSIGN  11906>>ASSIGN  12565<<ASSIGN  12566<<CALLBLT 12566--CALLBLT 12602>>CALLBLT
     12654>>CALLBLT
MOP_8_DIGITS
      8361**DCL     13384>>CALLBLT 13392>>CALLBLT 13411>>CALLBLT
MOP_8_DIGITS_3
      8362**DCL     13402>>CALLBLT
MSG
      8281**DCL      9130--DCLINIT  9162--DCLINIT  9265--DCLINIT  9266--DCLINIT 10896<<CALLBLT 11471<<ASSIGN
     12269--ASSIGN  12271<<ASSIGN  12352>>ASSIGN  12355<<CALLBLT 12359<<CALLBLT 12363<<CALLBLT 12367<<ASSIGN
     12369<<CALLBLT 12370<<CALLBLT 12371<<CALLBLT 12372<<CALLBLT 12373<<CALLBLT 12374<<CALLBLT 12378<<ASSIGN
     12379<<ASSIGN  12383<<ASSIGN  12384<<ASSIGN  12388<<ASSIGN  12389<<ASSIGN  12394<<ASSIGN  13220<<ASSIGN
     13372<<ASSIGN  13374<<ASSIGN  13380<<ASSIGN  13381<<CALLBLT 13382<<CALLBLT 13385<<CALLBLT 13387<<CALLBLT
     13395<<CALLBLT 13396<<CALLBLT 13404<<CALLBLT 13412<<ASSIGN  13413<<CALLBLT
MSGACCT
      9068**DCL      8987--DCLINIT
NO_FILE
      8344**DCL     10950<<ASSIGN  11804>>IF      11805<<ASSIGN  12067<<ASSIGN  12083<<ASSIGN  12825>>IF
     12833<<ASSIGN
NO_FILE IN PROCEDURE OPEN_TO_RANGE
     12827**LABEL   12864--GOTO
NO_MATCH IN PROCEDURE DISPLAY_LOGONS
     13306**LABEL   13257--GOTO
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:459  
NO_MORE_CRECS IN PROCEDURE BUILD_CONSOLE_STACK
     13058**LABEL   13019--CALLALT
NO_MORE_HISTORY IN PROCEDURE OPEN_TO_RANGE
     12833**LABEL   12821--GOTO
NO_SEGS
     11741**LABEL   11154--CALLALT
OCHIST_FLAG
      3783**DCL     12021<<ASSIGN  12157<<ASSIGN
OCL_CONSOLE_KEY
      3689**DCL      9420--DCLINIT  9421--DCLINIT
OCL_CONSOLE_REC
      3690**DCL      9422--DCLINIT  9423--DCLINIT
OCL_CONSOLE_REC.ATTRO
      3691**DCL     13152>>ASSIGN
OCL_CONSOLE_REC.LOGON
      3691**DCL     13043>>IF      13153>>ASSIGN
OCL_CONSOLE_REC.STATION.FIRST_HALF
      3691**DCL     13028>>IF      13035>>IF      13117>>IF      13155>>ASSIGN
OCL_CONSOLE_REC.STATION.SECND_HALF
      3691**DCL     13117>>IF      13156>>ASSIGN
OCL_CONSOLE_REC.STATUS
      3692**DCL     13121>>IF      13128>>IF      13158>>ASSIGN
OCL_CONSOLE_REC.TERM_NAME
      3690**DCL     13021>>IF      13036>>IF      13051>>IF      13150>>ASSIGN
OCL_CONSOLE_REC.UTS
      3692**DCL     12798>>IF      13157>>ASSIGN
OCL_CONSOLE_REC.WSN
      3690**DCL     13049>>IF      13057>>CALLBLT 13058>>IF      13151>>ASSIGN
OCL_HIST_BUF
      3687**DCL      9377--DCLINIT  9378--DCLINIT
OCL_HIST_BUF.ATTR
      3688**DCL     11114>>IF      11114>>IF      11118>>IF      11123>>IF      11126>>IF      11136>>IF
     11146>>IF      11164>>IF      11166>>IF      11170>>IF      11174>>IF      11174>>IF      11174>>IF
     11174>>IF      11243--ASSIGN  11289>>IF      11404--ASSIGN
OCL_HIST_BUF.DEVNM
      3687**DCL     11185>>IF      11243--ASSIGN  11370>>CALLBLT 11378--ASSIGN  11404--ASSIGN  11417>>CALLBLT
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:460  
     11425--ASSIGN  13329>>IF      13352>>ASSIGN
OCL_HIST_BUF.LOGON
      3687**DCL     11243--ASSIGN  11404--ASSIGN  13351>>ASSIGN
OCL_HIST_BUF.MESS
      3689**DCL     11217>>ASSIGN  11242>>ASSIGN  11256<>CALL    11256--CALL    11358<>CALL    11358--CALL
     11417>>CALLBLT 11438>>CALLBLT 11454<>CALL    11454--CALL
OCL_HIST_BUF.PROMPT_LENGTH
      3689**DCL     11216>>ASSIGN  11217>>ASSIGN  11243--ASSIGN  11256>>CALL    11256>>CALL    11358>>CALL
     11358>>CALL    11404--ASSIGN  11454>>CALL    11454>>CALL
OCL_HIST_BUF.STAT
      3687**DCL      3688--REDEF   11404--ASSIGN
OCL_HIST_BUF.STATION.SECND_HALF
      3688**DCL     11114>>IF      11174>>IF
OCL_HIST_BUF.TEMPLATE
      3689**DCL     11241>>IF      11243--ASSIGN  11404--ASSIGN
OCL_HIST_BUF.TERMINAL
      3688**DCL     11112>>CALLBLT 11131>>IF      11166>>IF      11185>>IF      11243--ASSIGN  11319>>CALLBLT
     11320--ASSIGN  11370>>CALLBLT 11378--ASSIGN  11404--ASSIGN  11417>>CALLBLT 11425--ASSIGN  13329>>IF
     13353>>ASSIGN
OCL_HIST_BUF.TSTAMP
      3687**DCL     11102>>ASSIGN  11214>>ASSIGN
OCL_HIST_BUF.TYPE
      3689**DCL     11109>>IF      11162>>DOCASE  11225>>DOCASE  11243--ASSIGN  11404--ASSIGN  13317>>IF
OCL_HIST_BUF.WSN
      3687**DCL     11111>>CALLBLT 11141>>IF      11170>>IF      11174>>IF      11189>>IF      11215>>ASSIGN
     11243--ASSIGN  11309>>CALLBLT 11310--ASSIGN  11404--ASSIGN
OCL_MSGB.ERR
      3685**DCL      3686--REDEF
OCL_NORM_KEY
      3686**DCL      9375--DCLINIT  9376--DCLINIT  9772--DCLINIT  9773--DCLINIT
OCL_NORM_KEY.COUNT
      3686**DCL     11001<<ASSIGN  11094>>IF      11809<<ASSIGN  12934<<ASSIGN  12963<<ASSIGN
OCL_NORM_KEY.UTS
      3686**DCL      9852--DCLINIT 11000<<ASSIGN  11100>>IF      11205>>IF      11207>>IF      11243--ASSIGN
     11404--ASSIGN  11488>>IF      11810<<ASSIGN  11817>>ASSIGN  11829>>ASSIGN  12926>>IF      12935<<ASSIGN
     12955>>IF      12964<<ASSIGN  13198>>IF      13198>>IF
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:461  
OCL_STATUS_KEY
      3680**DCL      9466--DCLINIT  9467--DCLINIT
OCL_STATUS_REC
      3678**DCL      9468--DCLINIT  9469--DCLINIT
OCL_STATUS_REC.PREV_FILE
      3679**DCL     12805>>ASSIGN
OCM$TPSET
      8149**DCL-ENT 11256--CALL    11358--CALL    11454--CALL
OCMSG
      9053**DCL      8983--DCLINIT
OCM_BPOSN
      3704**DCL     11243<<ASSIGN  11333>>CALLBLT 11342>>ASSIGN  11378>>ASSIGN  11389>>ASSIGN  11391>>CALLBLT
     11392>>ASSIGN  11404<<ASSIGN  11425>>ASSIGN  11436>>ASSIGN  11438>>CALLBLT
OCM_BUFFER
      3705**DCL     11242<<ASSIGN  11333>>CALLBLT 11370>>CALLBLT 11391>>CALLBLT
OCM_KEY_FLAG
      3707**DCL     11212<<ASSIGN
OCM_PROMPT.SIZE
      3706**DCL     11216<<ASSIGN
OCM_PROMPT.TEXT
      3706**DCL     11217<<ASSIGN
OCM_TSTAMP
      3706**DCL     11214<<ASSIGN
OCM_WSN
      3706**DCL     11215<<ASSIGN
OCP_FREE_HEAD
      3718**DCL      3719--REDEF
OCP_MSGBUF_FREE.B
      3722**DCL      3722--REDEF
OCP_USED_HEAD
      3719**DCL      3720--REDEF
OCP_USED_TAIL
      3720**DCL      3720--REDEF
OC_CONSOLE.ATTR
      2891**DCL      2891--REDEF
OC_CONSOLE.ATTRO
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:462  
      2892**DCL      2892--REDEF
OC_CONSOLE.CID
      2890**DCL      2891--REDEF
OC_CONSOLE.STATION
      2889**DCL      2889--REDEF
OC_CONSOLE$
      2888**DCL      2889--IMP-PTR
OC_DIR
      2931**DCL      2931--REDEF
OC_INTBIT
      2931**DCL      2932--REDEF
OC_INTMSG
      2808**DCL      2821--REDEF
OC_INTMSG.FLAGS
      2815**DCL      2816--REDEF
OC_INTMSG.MESS
      2821**DCL      2821--REDEF
OC_INTMSG.MSGID
      2811**DCL      2812--REDEF
OC_INTMSG.WSN
      2818**DCL      2819--REDEF
OC_MASK
      2932**DCL      2932--REDEF
OC_MESSBUF
      2823**DCL      2838--REDEF    2852--REDEF
OC_MESSBUF.FLAGS
      2830**DCL      2831--REDEF
OC_MESSBUF.MESS
      2836**DCL      2836--REDEF
OC_MESSBUF.MSGID
      2826**DCL      2827--REDEF
OC_MESSBUF.WSN
      2833**DCL      2834--REDEF
OC_MESSBUF1.FLAGS
      2845**DCL      2846--REDEF
OC_MESSBUF1.LEN
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:463  
      2851**DCL      2851--REDEF
OC_MESSBUF1.MSGID
      2841**DCL      2842--REDEF
OC_MESSBUF1.WSN
      2848**DCL      2849--REDEF
OC_MSGBUFFER
      2854**DCL      2869--REDEF
OC_MSGBUFFER.FLAGS
      2861**DCL      2862--REDEF
OC_MSGBUFFER.MESS
      2867**DCL      2867--REDEF
OC_MSGBUFFER.MSGID
      2857**DCL      2858--REDEF
OC_MSGBUFFER.WSN
      2864**DCL      2865--REDEF
OC_MSGBUFFER2.FLAGS
      2876**DCL      2877--REDEF
OC_MSGBUFFER2.MSGID
      2872**DCL      2873--REDEF
OC_MSGBUFFER2.WSN
      2879**DCL      2880--REDEF
OC_MSG_GOOD
      2932**DCL     11003<<ASSIGN
OC_PARAM
      2887**DCL      2887--REDEF
OC_QUEUE.PARMC
      2886**DCL      2886--REDEF
OPEN_DEST
     10642**DCL     12418<>CALL
OPEN_DEST.ACSVEH_
     10644**DCL     10645--REDEF
OPEN_DEST.ALTKEYS_
     10650**DCL     10651--REDEF   10651--REDEF
OPEN_DEST.HDR_
     10649**DCL     10650--REDEF
OPEN_DEST.TAB_
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:464  
     10648**DCL     10649--REDEF
OPEN_DEST.UHL_
     10642**DCL     10643--REDEF   10643--REDEF
OPEN_DEST.V
     10651**DCL     10642--DCLINIT
OPEN_DEST.V.ASN#
     10661**DCL     10357--DCLINIT
OPEN_DEST.V.FSN#
     10682**DCL     10682--REDEF   10682--REDEF
OPEN_DEST.V.RES#
     10666**DCL     10357--DCLINIT
OPEN_DEST.WSN_
     10648**DCL     10648--REDEF
OPEN_HISTORYE
      8776**DCL     12034<>CALL    12043<>CALL    12071<>CALL
OPEN_HISTORYE.ACSVEH_
      8778**DCL      8779--REDEF
OPEN_HISTORYE.ALTKEYS_
      8784**DCL      8785--REDEF    8785--REDEF
OPEN_HISTORYE.HDR_
      8783**DCL      8784--REDEF
OPEN_HISTORYE.PASS_
      8778**DCL     11997<<ASSIGN
OPEN_HISTORYE.SN_
      8776**DCL     12000<<ASSIGN
OPEN_HISTORYE.TAB_
      8782**DCL      8783--REDEF
OPEN_HISTORYE.UHL_
      8776**DCL      8777--REDEF    8777--REDEF
OPEN_HISTORYE.V
      8785**DCL      8776--DCLINIT
OPEN_HISTORYE.V.FSN#
      8816**DCL      8816--REDEF    8816--REDEF
OPEN_HISTORYE.WSN_
      8782**DCL      8782--REDEF
OPEN_LO
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:465  
     10524**DCL     10948<>CALL
OPEN_LO.ACSVEH_
     10526**DCL     10527--REDEF
OPEN_LO.ALTKEYS_
     10532**DCL     10533--REDEF   10533--REDEF
OPEN_LO.HDR_
     10531**DCL     10532--REDEF
OPEN_LO.TAB_
     10530**DCL     10531--REDEF
OPEN_LO.UHL_
     10524**DCL     10525--REDEF   10525--REDEF
OPEN_LO.V
     10533**DCL     10524--DCLINIT
OPEN_LO.V.FSN#
     10564**DCL     10564--REDEF   10564--REDEF
OPEN_LO.WSN_
     10530**DCL     10530--REDEF
OPEN_OCMSG
      8982**DCL     11017<>CALL
OPEN_OCMSG.ACSVEH_
      8984**DCL      8985--REDEF
OPEN_OCMSG.ALTKEYS_
      8990**DCL      8991--REDEF    8991--REDEF
OPEN_OCMSG.HDR_
      8989**DCL      8990--REDEF
OPEN_OCMSG.TAB_
      8988**DCL      8989--REDEF
OPEN_OCMSG.UHL_
      8982**DCL      8983--REDEF    8983--REDEF
OPEN_OCMSG.V
      8991**DCL      8982--DCLINIT
OPEN_OCMSG.V.FSN#
      9022**DCL      9022--REDEF    9022--REDEF
OPEN_OCMSG.WSN_
      8988**DCL      8988--REDEF
OPEN_SPECIFIC_FILE
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:466  
     11989**PROC    11803--CALL    12792--CALL    12824--CALL    12829--CALL    12930--CALL    12959--CALL
OPEN_TO_RANGE
     12785**PROC    10993--CALL
OPERATOR_ENTERED_DATE1
      8297**DCL     11860>>IF      11897>>IF      12293<<ASSIGN  12328<<ASSIGN  12518<<ASSIGN
OPERATOR_ENTERED_DATE2
      8299**DCL     11207>>IF      11883>>IF      12295<<ASSIGN  12330<<ASSIGN  12589<<ASSIGN
OPERATOR_ENTERED_TIME1
      8296**DCL     11853>>IF      11897>>IF      12292<<ASSIGN  12327<<ASSIGN  12490<<ASSIGN  12524<<ASSIGN
OPERATOR_ENTERED_TIME2
      8298**DCL     11207>>IF      11876>>IF      12294<<ASSIGN  12329<<ASSIGN  12560<<ASSIGN  12595<<ASSIGN
ORR$ABRKRTN
      8153**DCL-ENT  7868--DCLINIT
ORR$AXCONRTN
      8154**DCL-ENT 10327--DCLINIT
ORR$BRKMSG
      8150**DCL-ENT  7870--DCLINIT
ORR$BRKRTN
      8151**DCL-ENT 11557--CALL    11767--CALL    11981--CALL    12027--CALL    12124--CALL    12161--CALL
ORR$XCONRTN
      8152**DCL-ENT 11603--CALL    11615--CALL    11626--CALL    11637--CALL    11649--CALL    11661--CALL
     11673--CALL    11685--CALL    11696--CALL    11709--CALL    11720--CALL    11732--CALL    11743--CALL
     11754--CALL    11927--CALL    11947--CALL    11959--CALL    11967--CALL    12026--CALL    12099--CALL
     12111--CALL    12136--CALL    12162--CALL    12180--CALL    12189--CALL    12201--CALL    12210--CALL
     12432--CALL    12445--CALL    12454--CALL    12693--CALL    12705--CALL    12873--CALL    12882--CALL
     12891--CALL    12900--CALL    12991--CALL    13084--CALL    13094--CALL
ORR_UNMASK.MASK
      8450**DCL     11289>>IF      11289>>IF
ORR_UNMASK.NM
      8482**DCL     11296>>CALLBLT
ORR_UNMASK.NM_CT
      8474**DCL     11296>>CALLBLT 11301>>ASSIGN
ORR_UNMASK.TERM
      8458**DCL     11314>>IF
ORR_UNMASK.WSN
      8466**DCL     11304>>IF
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:467  
OR_BRK_FLAG
      3783**DCL     12027>>IF      12162>>IF
OR_MESSBUF
      8028**DCL     10146--DCLINIT 10147--DCLINIT
OR_MESSBUF.FCN
      8034**DCL     12020<<ASSIGN  12155<<ASSIGN
OR_MESSBUF.FLAGS
      8035**DCL      8036--REDEF
OR_MESSBUF.MSGID
      8031**DCL      8032--REDEF
OR_OK_TO_BREAK
      3783**DCL     12018<<ASSIGN  12024<<ASSIGN  12153<<ASSIGN  12159<<ASSIGN
OR_XCON_FLAG
      3783**DCL     12026>>IF      12161>>IF
OUT$
      8161**DCL      8174--REDEF   10956<>CALL    10974>>DOCASE  11024>>ASSIGN  11024>>ASSIGN  11030>>ASSIGN
     12223>>DOINDEX 12225>>ASSIGN  12285>>ASSIGN  12286>>ASSIGN  12403>>IF      12404>>ASSIGN  12404>>ASSIGN
     12461>>ASSIGN  12464>>ASSIGN
OUT$BLK.CODE
      7956**DCL     10974>>DOCASE  12227>>DOCASE  12241>>DOCASE  12289>>DOCASE  12467>>DOCASE  12473>>DOCASE
     12543>>DOCASE
OUT$BLK.NSUBLKS
      7960**DCL     12223>>DOINDEX 12247>>IF      12252>>IF      12286>>ASSIGN  12403>>IF      12461>>ASSIGN
     12465>>ASSIGN
OUT$BLK.SUBLK$
      7981**DCL     11024>>ASSIGN  11024>>ASSIGN  11030>>ASSIGN  12225>>ASSIGN  12226>>ASSIGN  12229>>ASSIGN
     12229>>ASSIGN  12232>>ASSIGN  12232>>ASSIGN  12233>>ASSIGN  12233>>ASSIGN  12236>>ASSIGN  12236>>ASSIGN
     12248>>ASSIGN  12248>>ASSIGN  12253>>ASSIGN  12253>>ASSIGN  12271>>ASSIGN  12271>>ASSIGN  12272>>ASSIGN
     12285>>ASSIGN  12404>>ASSIGN  12404>>ASSIGN  12464>>ASSIGN  12471>>ASSIGN  12476>>CALLBLT 12476>>CALLBLT
     12476>>CALLBLT 12484>>CALLBLT 12484>>CALLBLT 12484>>CALLBLT 12496>>CALLBLT 12496>>CALLBLT 12496>>CALLBLT
     12504>>CALLBLT 12504>>CALLBLT 12504>>CALLBLT 12512>>CALLBLT 12512>>CALLBLT 12512>>CALLBLT 12541>>ASSIGN
     12546>>CALLBLT 12546>>CALLBLT 12546>>CALLBLT 12554>>CALLBLT 12554>>CALLBLT 12554>>CALLBLT 12566>>CALLBLT
     12566>>CALLBLT 12566>>CALLBLT 12575>>CALLBLT 12575>>CALLBLT 12575>>CALLBLT 12583>>CALLBLT 12583>>CALLBLT
     12583>>CALLBLT
OUT$SYM.COUNT
      8017**DCL      8020--IMP-SIZ 12229>>ASSIGN  12232>>ASSIGN  12233>>ASSIGN  12236>>ASSIGN  12248>>ASSIGN
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:468  
     12253>>ASSIGN  12271>>ASSIGN  12272>>ASSIGN  12404>>ASSIGN  12476>>CALLBLT 12476>>CALLBLT 12484>>CALLBLT
     12484>>CALLBLT 12496>>CALLBLT 12496>>CALLBLT 12504>>CALLBLT 12504>>CALLBLT 12512>>CALLBLT 12512>>CALLBLT
     12546>>CALLBLT 12546>>CALLBLT 12554>>CALLBLT 12554>>CALLBLT 12566>>CALLBLT 12566>>CALLBLT 12575>>CALLBLT
     12575>>CALLBLT 12583>>CALLBLT 12583>>CALLBLT
OUT$SYM.TEXT
      8020**DCL     12229>>ASSIGN  12232>>ASSIGN  12233>>ASSIGN  12236>>ASSIGN  12248>>ASSIGN  12253>>ASSIGN
     12271>>ASSIGN  12404>>ASSIGN  12476>>CALLBLT 12484>>CALLBLT 12496>>CALLBLT 12504>>CALLBLT 12512>>CALLBLT
     12546>>CALLBLT 12554>>CALLBLT 12566>>CALLBLT 12575>>CALLBLT 12583>>CALLBLT
OUT$SYM.TEXTC$
      8012**DCL     11024>>ASSIGN  11024>>ASSIGN  11030>>ASSIGN
OUT_BUFFER
      8293**DCL      9581--DCLINIT  9582--DCLINIT 11268<<ASSIGN  11271<<ASSIGN  11296<<CALLBLT 11309<<CALLBLT
     11319<<CALLBLT 11333<<CALLBLT 11370<<CALLBLT 11390<<ASSIGN  11391<<CALLBLT 11417<<CALLBLT 11437<<ASSIGN
     11438<<CALLBLT 12270--ASSIGN  12352<<ASSIGN  12394>>ASSIGN
OUT_ERROR
      8174**DCL      9239--DCLINIT 10958>>ASSIGN  10965<>CALL
OUT_ERROR.ERR#
      8204**DCL     10960>>IF      10967>>IF
OUT_ERROR.MON
      8203**DCL     10967>>IF
OUT_MSG
      9264**DCL     10898<>CALL    11472<>CALL    12357<>CALL    12361<>CALL    12365<>CALL    12376<>CALL
     12381<>CALL    12386<>CALL    12391<>CALL    13222<>CALL    13376<>CALL    13408<>CALL    13414<>CALL
OUT_MSG.BUF_.BOUND
      9264**DCL     10897<<ASSIGN  11470<<ASSIGN  12356<<ASSIGN  12360<<ASSIGN  12364<<ASSIGN  12368<<ASSIGN
     12380<<ASSIGN  12385<<ASSIGN  12390<<ASSIGN  13221<<ASSIGN  13375<<ASSIGN
OUT_MSG.STATION_
      9266**DCL      9266--REDEF
OUT_MSG.V
      9267**DCL      9264--DCLINIT
OUT_MSG.V.DVBYTE.VFC#
      9273**DCL      9273--REDEF
PAGES
      8327**DCL     10929>>ASSIGN  10932<<ASSIGN  10995<<ASSIGN  13164<<ASSIGN  13164>>ASSIGN
PCT
      8338**DCL     13389<<ASSIGN  13390<<ASSIGN  13390>>ASSIGN  13391>>CALLBLT 13398<<ASSIGN  13401>>CALLBLT
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:469  
PERFORM_CALL
      8320**DCL     13014<<ASSIGN  13023<<ASSIGN  13030<<ASSIGN  13037<<ASSIGN  13044<<ASSIGN  13052<<ASSIGN
     13059<<ASSIGN  13065<<ASSIGN  13067>>IF      13069<<ASSIGN  13229<<ASSIGN  13232<<ASSIGN  13236<<ASSIGN
     13238<<ASSIGN  13242<<ASSIGN  13245<<ASSIGN  13247>>IF      13248<<ASSIGN
POSITION_AT_END
     10286**DCL     11824<>CALL
POSITION_AT_END.V
     10286**DCL     10286--DCLINIT
PREFIX
      8324**DCL     11270>>IF      11369>>IF      11416>>IF      13000<<ASSIGN  13013<<ASSIGN
PREV
      8378**DCL     10912--ASSIGN  10916--ASSIGN  12805<<ASSIGN  12813>>ASSIGN
PREV.TXT
      8380**DCL     12804<<ASSIGN
PREV_STACK
      8382**DCL     12791<<ASSIGN  12813<<ASSIGN  12818>>ASSIGN  12823>>ASSIGN  12828>>ASSIGN  12912>>ASSIGN
     12923>>ASSIGN  12929>>ASSIGN  12952>>ASSIGN  12958>>ASSIGN
PREV_STACK.COUNT
      8383**DCL     12821>>IF
PRINTED_TIME
      8268**DCL      9912--DCLINIT 11012<<ASSIGN  11487<>CALL    11488>>IF
PRINT_FLAG
      8267**DCL     11004<<ASSIGN  11480<<ASSIGN  11569>>IF      13302<<ASSIGN  13407<<ASSIGN
PROCESS IN PROCEDURE OPEN_TO_RANGE
     12843**LABEL   12834--GOTO
PROMPT_IN
      9296**DCL     10865<>CALL
PROMPT_IN.V
      9304**DCL      9298--DCLINIT
PTR$
      8207**DCL     12471<<ASSIGN  12473>>DOCASE  12476>>CALLBLT 12476>>CALLBLT 12476>>CALLBLT 12484>>CALLBLT
     12484>>CALLBLT 12484>>CALLBLT 12496>>CALLBLT 12496>>CALLBLT 12496>>CALLBLT 12504>>CALLBLT 12504>>CALLBLT
     12504>>CALLBLT 12512>>CALLBLT 12512>>CALLBLT 12512>>CALLBLT 12541<<ASSIGN  12543>>DOCASE  12546>>CALLBLT
     12546>>CALLBLT 12546>>CALLBLT 12554>>CALLBLT 12554>>CALLBLT 12554>>CALLBLT 12566>>CALLBLT 12566>>CALLBLT
     12566>>CALLBLT 12575>>CALLBLT 12575>>CALLBLT 12575>>CALLBLT 12583>>CALLBLT 12583>>CALLBLT 12583>>CALLBLT
P_PCB
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:470  
      8509**DCL      7871--DCLINIT
RANGE_CONV
     10747**DCL     12644<>CALL    12669<>CALL    13264<>CALL    13280<>CALL
RANGE_CONV.TSTAMP_
     10750**DCL     12643<<ASSIGN  12668<<ASSIGN  13263<<ASSIGN  13279<<ASSIGN
RANGE_CONV.V
     10751**DCL     10747--DCLINIT
READ_CONSOLE_REC
      9420**DCL     12796<>CALL    12831<>CALL    13019<>CALL
READ_CONSOLE_REC.STATION_
      9423**DCL      9424--REDEF
READ_CONSOLE_REC.V
      9424**DCL      9420--DCLINIT
READ_CONSOLE_REC.V.DVBYTE.REREAD#
      9435**DCL      9435--REDEF
READ_CONSOLE_REC.V.INDX#
      9433**DCL      9433--REDEF
READ_HISTORYE
      9375**DCL     11096<>CALL    11816<>CALL    11828<>CALL
READ_HISTORYE.STATION_
      9378**DCL      9379--REDEF
READ_HISTORYE.V
      9379**DCL      9375--DCLINIT
READ_HISTORYE.V.DVBYTE.REREAD#
      9390**DCL      9390--REDEF
READ_HISTORYE.V.INDX#
      9388**DCL      9388--REDEF
READ_HISTORYE.V.KEYS#
      9380**DCL     11814<<ASSIGN  11827<<ASSIGN  11830<<ASSIGN
READ_STATUS
      9466**DCL     12795<>CALL    12830<>CALL
READ_STATUS.STATION_
      9469**DCL      9470--REDEF
READ_STATUS.V
      9470**DCL      9466--DCLINIT
READ_STATUS.V.DVBYTE.REREAD#
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:471  
      9481**DCL      9481--REDEF
READ_STATUS.V.INDX#
      9479**DCL      9479--REDEF
RELEASE_SEG
      9538**DCL     10913<>CALL    12914<>CALL    12925<>CALL    12954<>CALL
RELEASE_SEG.V
      9538**DCL      9538--DCLINIT
RELEASE_SEG.V.SEGSIZE#
      9540**DCL     10912<<ASSIGN  10916<<ASSIGN
REM_START
      8347**DCL     10871<<REMEMBR
REPLAY_NODES
      8354**DCL     10956<>CALL
REPORT_END_POINT
     11560**LABEL   11084--GOTO    11094--GOTO    11210--GOTO
RESET_XCON
     10767**DCL     11777<>CALL
RESET_XCON.V
     10768**DCL     10767--DCLINIT
SEC1
      8223**DCL     11856<<ASSIGN  12491<<ASSIGN  12522<<ASSIGN  12633>>CALLBLT
SEC2
      8232**DCL     11879<<ASSIGN  12561<<ASSIGN  12593<<ASSIGN  12659>>CALLBLT
SELECTIONS
     10950**LABEL   10971--GOTO    11080--GOTO
SELECTION_RETRIEVER
     12219**PROC    10980--CALL
SET_DEFAULTS
     11784**PROC    10985--CALL
SET_DESTINATION
     12400**PROC    10984--CALL
SIM_DATE
      8275**DCL      9848--DCLINIT  9849--DCLINIT 10747--DCLINIT 10748--DCLINIT 11502--ASSIGN  11506>>CALLBLT
     11515>>ASSIGN  12646>>CALLBLT 12670>>CALLBLT 13267>>CALLBLT 13281>>CALLBLT 13290--ASSIGN  13290--ASSIGN
SIM_TIME
      8276**DCL      9850--DCLINIT  9851--DCLINIT 10749--DCLINIT 10750--DCLINIT 11502--ASSIGN  11506>>CALLBLT
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:472  
     11516>>CALLBLT 12646>>CALLBLT 12670>>CALLBLT 13267>>CALLBLT 13281>>CALLBLT 13290--ASSIGN  13290--ASSIGN
SKIP_TEST IN PROCEDURE GATHER_C_STATS
     13333**LABEL   13322--GOTO
SKIP_TEST2 IN PROCEDURE GATHER_C_STATS
     13350**LABEL   13345--GOTO
SKIP_TPSET
     11257**LABEL   11253--GOTO
SOME_ON_STACK
      8318**DCL     10997<<ASSIGN  13103>>IF      13108<<ASSIGN
SR_PTR$
      8212**DCL     12225<<ASSIGN  12226>>ASSIGN  12227>>DOCASE  12229>>ASSIGN  12229>>ASSIGN  12232>>ASSIGN
     12232>>ASSIGN  12233>>ASSIGN  12233>>ASSIGN  12236>>ASSIGN  12236>>ASSIGN  12271>>ASSIGN  12271>>ASSIGN
     12272>>ASSIGN
STA
     10173**DCL     10147--DCLINIT
STA.MSGIDXT
     10183**DCL     10186--REDEF
STACK_SEG
      9502**DCL     12786<>CALL    12811<>CALL
STACK_SEG.V
      9502**DCL      9502--DCLINIT
STK_INDEX
      8307**DCL     10912>>ASSIGN  10915<<ASSIGN  10992<<ASSIGN  12791>>ASSIGN  12812<<ASSIGN  12812>>ASSIGN
     12813>>ASSIGN  12818>>ASSIGN  12821>>IF      12823>>ASSIGN  12827<<ASSIGN  12827>>ASSIGN  12828>>ASSIGN
     12910>>DOCASE  12912>>ASSIGN  12913>>ASSIGN  12923>>ASSIGN  12924>>ASSIGN  12928<<ASSIGN  12928>>ASSIGN
     12929>>ASSIGN  12952>>ASSIGN  12953>>ASSIGN  12957<<ASSIGN  12957>>ASSIGN  12958>>ASSIGN
SUBS1
      8251**DCL     12286<<ASSIGN  12288>>IF      12461<<ASSIGN  12463>>DOINDEX
SUBS2
      8250**DCL     12465<<ASSIGN  12470>>DOINDEX 12519>>IF      12540>>DOINDEX 12590>>IF
SYS
      8861**DCL      8781--DCLINIT
SYS.ACCT#
      8861**DCL     11994<<ASSIGN
TEMP_UTS
      8214**DCL     11487<>CALL    11488>>IF
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:473  
TEMP_YR IN PROCEDURE TIME_VALIDATE
     12720**DCL     12763<<ASSIGN  12764<<ASSIGN  12765>>IF
TEXTC.C
      8290**DCL      8291--IMP-SIZ 11024>>ASSIGN
TEXTC.TEXT
      8291**DCL     11024>>ASSIGN
TEXT_VAR
      8341**DCL     10862<<CALLBLT 10863>>CALLBLT 13383<<CALLBLT 13384<<CALLBLT 13384>>CALLBLT 13385>>CALLBLT
     13391<<CALLBLT 13392<<CALLBLT 13392>>CALLBLT 13393>>CALLBLT 13394--IF      13395--CALLBLT 13395>>CALLBLT
     13395--CALLBLT 13396--CALLBLT 13396>>CALLBLT 13396--CALLBLT 13401<<CALLBLT 13402<<CALLBLT 13402>>CALLBLT
     13403>>CALLBLT 13404>>CALLBLT 13410<<CALLBLT 13411<<CALLBLT 13411>>CALLBLT 13413>>CALLBLT
THOLD
      8243**DCL      8244--REDEF   11102<<ASSIGN
TI
      8346**DCL     11112<<CALLBLT 11131>>IF      11131>>IF      11161<<CALLBLT 11166>>IF      11166>>IF
TIME_BUF
      8265**DCL      9825--DCLINIT  9826--DCLINIT 11854>>ASSIGN  11855>>ASSIGN  11856>>ASSIGN  11857>>ASSIGN
     11877>>ASSIGN  11878>>ASSIGN  11879>>ASSIGN  11880>>ASSIGN
TIME_BUFFER
      8294**DCL      9878--DCLINIT  9879--DCLINIT 11504<<ASSIGN  11506<<CALLBLT 12645<<ASSIGN  12646<<CALLBLT
     12670<<CALLBLT 13259<<ASSIGN  13266<<CALLBLT 13267<<CALLBLT 13272<<CALLBLT 13275<<CALLBLT 13281<<CALLBLT
     13285<<CALLBLT 13288<<CALLBLT 13304<<CALLBLT 13305<<CALLBLT
TIME_CONV
      9799**DCL     12639<>CALL    12665<>CALL
TIME_CONV.V
      9803**DCL      9799--DCLINIT
TIME_SET
      9823**DCL     11851<>CALL    11874<>CALL    12745<>CALL
TIME_SET.TSTAMP_
      9826**DCL     11850<<ASSIGN  11873<<ASSIGN
TIME_SET.V
      9827**DCL      9823--DCLINIT
TIME_SET.V.SOURCE#
      9827**DCL     12744<<ASSIGN  12747<<ASSIGN
TIME_SIMULATION
      9848**DCL     11497<>CALL
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:474  
TIME_SIMULATION.V
      9852**DCL      9848--DCLINIT
TIME_TO_UTS
      9908**DCL     11523<>CALL
TIME_TO_UTS.V
      9912**DCL      9908--DCLINIT
TIME_VALIDATE
     12715**PROC    12535--CALL    12606--CALL
TO_UTS_DATE
      8278**DCL      9908--DCLINIT  9909--DCLINIT 11515<<ASSIGN
TO_UTS_TIME
      8279**DCL      9910--DCLINIT  9911--DCLINIT 11516<<CALLBLT
TPTR$
      8211**DCL     12226<<ASSIGN  12241>>DOCASE  12247>>IF      12248>>ASSIGN  12248>>ASSIGN  12252>>IF
     12253>>ASSIGN  12253>>ASSIGN  12285<<ASSIGN  12289>>DOCASE
TRY2 IN PROCEDURE OPEN_SPECIFIC_FILE
     12039**LABEL   12043--CALLALT
TXTFD
      8255**DCL     10306--DCLINIT
TYPE
      8321**DCL     11108>>IF      12239<<ASSIGN  12259<<ASSIGN  12308<<ASSIGN  12337<<ASSIGN  12369>>IF
     13001>>IF      13016>>IF
USE_LINDEX
      8314**DCL     13105<<ASSIGN  13123<<ASSIGN  13133<<ASSIGN  13141<<ASSIGN  13167>>IF
UTSTAMP
      8270**DCL      9803--DCLINIT 12641>>ASSIGN  12666>>ASSIGN
VALID_CHECK
      8244**DCL     11104>>IF      11104>>IF
W
      8343**DCL     13050<<CALLBLT 13051>>IF      13051>>IF      13057<<CALLBLT 13058>>IF      13058>>IF
     13241<<CALLBLT 13242>>IF      13242>>IF      13393<<CALLBLT 13394>>IF      13395>>CALLBLT 13395>>CALLBLT
     13395>>CALLBLT 13396>>CALLBLT 13396>>CALLBLT 13396>>CALLBLT 13403<<CALLBLT 13404>>CALLBLT
WAIT_HIST
     10269**DCL     12042<>CALL
WAIT_HIST.V
     10270**DCL     10269--DCLINIT
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:475  
WAIT_TIMES#
      8310**DCL     12039<<ASSIGN  12039>>ASSIGN  12040>>IF      12044<<ASSIGN
WI
      8345**DCL     11111<<CALLBLT 11141>>IF      11141>>IF      11160<<CALLBLT 11170>>IF      11170>>IF
     11174>>IF      11174>>IF
WILDCARDING
      8340**DCL     11443>>IF      12268<<ASSIGN  12318<<ASSIGN  12339<<ASSIGN  12388>>IF
WILD_ERR
     11447**LABEL   11445--CALLALT
WRITE_CS
     10145**DCL     12022<>CALL    12156<>CALL
WRITE_CS.STATION_
     10147**DCL     10147--REDEF
WRITE_CS.V
     10148**DCL     10145--DCLINIT
WRITE_CS.V.DVBYTE.VFC#
     10154**DCL     10154--REDEF
WRITE_HIST_BUF_MESS
      9580**DCL     11530<>CALL
WRITE_HIST_BUF_MESS.BUF_.BOUND
      9580**DCL     11342<<ASSIGN  11378<<ASSIGN  11389<<ASSIGN  11392<<ASSIGN  11425<<ASSIGN  11436<<ASSIGN
     11444>>ASSIGN
WRITE_HIST_BUF_MESS.STATION_
      9582**DCL      9582--REDEF
WRITE_HIST_BUF_MESS.V
      9583**DCL      9580--DCLINIT
WRITE_HIST_BUF_MESS.V.DVBYTE.VFC#
      9589**DCL      9589--REDEF
WRITE_LSTACK
     13149**PROC    13107--CALL    13124--CALL    13134--CALL    13142--CALL
WRITE_TIME
      9877**DCL     11511<>CALL    12679<>CALL    13307<>CALL
WRITE_TIME.BUF_.BOUND
      9877**DCL     11502<<ASSIGN  12678<<ASSIGN  13290<<ASSIGN  13306<<ASSIGN
WRITE_TIME.STATION_
      9879**DCL      9879--REDEF
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:476  
WRITE_TIME.V
      9880**DCL      9877--DCLINIT
WRITE_TIME.V.DVBYTE.VFC#
      9886**DCL      9886--REDEF
WSTATION
      8259**DCL     12229<<ASSIGN  12305<<ASSIGN  12336<<ASSIGN  12363>>CALLBLT 13001>>IF      13048>>IF
     13050>>CALLBLT 13051>>IF      13058>>IF      13240>>IF      13242>>IF
X
      8248**DCL     12354<<CALLBLT 12355>>CALLBLT 12470<<DOINDEX 12471>>ASSIGN  12540<<DOINDEX 12541>>ASSIGN
X$WILDCMP
      8157**DCL-ENT 11445--CALL
XTX$ADAPT
      7853**DCL-ENT  7932--DCLINIT
XUD$UTS_ADJUST
      7490**DCL-ENT 11487--CALL
XUH_PARAM
      7539**DCL     11031<>CALL    11035<>CALL    11039<>CALL
XUH_PARAM.ERR
      7556**DCL     11075>>ASSIGN
XUH_PARAM.HELP$
      7549**DCL     11030<<ASSIGN
XUR$ALLMSG
      3867**DCL-ENT 11039--CALL
XUR$BREAK
      3860**DCL-ENT  9929--DCLINIT
XUR$DISABLE
      3861**DCL-ENT 12017--CALL    12152--CALL
XUR$ECHOIF
      3850**DCL-ENT 10961--CALL
XUR$ENABLE
      3862**DCL-ENT 12025--CALL    12160--CALL
XUR$ERRMSG
      3856**DCL-ENT 10855--CALL    10965--CALL    11078--CALL    11554--CALL    11556--CALL    11580--CALL
     11600--CALL    11602--CALL    11612--CALL    11614--CALL    11623--CALL    11625--CALL    11634--CALL
     11636--CALL    11646--CALL    11648--CALL    11658--CALL    11660--CALL    11670--CALL    11672--CALL
     11682--CALL    11684--CALL    11693--CALL    11695--CALL    11706--CALL    11708--CALL    11717--CALL
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:477  
     11719--CALL    11729--CALL    11731--CALL    11740--CALL    11742--CALL    11751--CALL    11753--CALL
     11763--CALL    11765--CALL    11774--CALL    11924--CALL    11926--CALL    11935--CALL    11944--CALL
     11946--CALL    11956--CALL    11958--CALL    11964--CALL    11966--CALL    11977--CALL    11979--CALL
     12066--CALL    12080--CALL    12082--CALL    12096--CALL    12098--CALL    12108--CALL    12110--CALL
     12120--CALL    12122--CALL    12133--CALL    12135--CALL    12177--CALL    12179--CALL    12186--CALL
     12188--CALL    12198--CALL    12200--CALL    12207--CALL    12209--CALL    12429--CALL    12431--CALL
     12442--CALL    12444--CALL    12451--CALL    12453--CALL    12690--CALL    12692--CALL    12702--CALL
     12704--CALL    12775--CALL    12863--CALL    12870--CALL    12872--CALL    12879--CALL    12881--CALL
     12888--CALL    12890--CALL    12897--CALL    12899--CALL    12988--CALL    12990--CALL    13080--CALL
     13083--CALL    13091--CALL    13093--CALL
XUR$ERRPTR
      3849**DCL-ENT 10962--CALL
XUR$GETCMD
      3848**DCL-ENT 10956--CALL
XUR$HELP
      3865**DCL-ENT 11031--CALL
XUR$INIT
      3853**DCL-ENT 10839--CALL
XUR$MOREMSG
      3866**DCL-ENT 11035--CALL
XUR$SETDCBS
      3852**DCL-ENT 10888--CALL
XUR_INIT
      7858**DCL     10839<>CALL
XUR_INIT.WORKR_
      7872**DCL      7873--REDEF
XUW_WILDCARD
      8103**DCL     11445<>CALL
XUW_WILDCARD.ERROR.ERR#
      8128**DCL     11447>>IF      11448>>IF
XUW_WILDCARD.INPUT_.BOUND
      8110**DCL     11444<<ASSIGN
XUW_WILDCARD.INPUT_.INPUT$
      8113**DCL     12270<<ASSIGN
XUW_WILDCARD.PATTERN_.BOUND
      8105**DCL     12272<<ASSIGN
PL6.E3A0      #001=ORR$REPLAY File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:14 Page:478  
XUW_WILDCARD.PATTERN_.PATTERN$
      8108**DCL     12269<<ASSIGN
YEAR1
      8228**DCL     11861<<ASSIGN  11905<<ASSIGN  12511<<ASSIGN  12512<<CALLBLT 12512--CALLBLT 12530>>CALLBLT
     12628>>CALLBLT
YEAR2
      8237**DCL     11884<<ASSIGN  11905>>ASSIGN  12582<<ASSIGN  12583<<CALLBLT 12583--CALLBLT 12601>>CALLBLT
     12654>>CALLBLT
YR
      8301**DCL     12530<<CALLBLT 12601<<CALLBLT 12736>>IF      12762>>IF      12763>>ASSIGN  12764>>ASSIGN

PL6.E3A0      #002=ORR$BRKMSG File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:479  
     3326        1        /*T***********************************************************/
     3327        2        /*T*                                                         */
     3328        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3329        4        /*T*                                                         */
     3330        5        /*T***********************************************************/
     3331        6
     3332        7        ORR$BRKMSG: PROC;
     3333        8
     3334        9        %INCLUDE CP_6;
     3335       90        %INCLUDE CP_6_SUBS;
     3336      630        %INCLUDE OCL_DATA_R;
     3337      655
     3338      656    1   DCL 1 BRKMSG STATIC CALIGNED,
     3339      657    1          2 * CHAR(0) INIT('Break at '),
     3340      658    1          2 TIME CHAR(0) INIT('HH:MM:SS.SS'),
     3341      659    1          2 * CHAR(0) INIT(' '),
     3342      660    1          2 DATE CHAR(0) INIT('MON DD ''YY'),
     3343      661    1          2 * CHAR(0) INIT('!  C to continue.');
     3344      662
     3345      663        %FPT_TIME(FPTN=KEY_TO_MSG,
     3346      664         SOURCE=UTS,TSTAMP=OCL_NORM_KEY.UTS,
     3347      665         DEST=EXT,DATE=BRKMSG.DATE,TIME=BRKMSG.TIME);
     3348      684
     3349      685        %FPT_WRITE(FPTN=WRITE_BRKMSG,
     3350      686         DCB=M$UC,
     3351      687         BUF=BRKMSG);
     3352      718
     3353      719    2      CALL M$TIME(KEY_TO_MSG) WHENALTRETURN DO; END;
     3354      720    2      CALL M$WRITE(WRITE_BRKMSG) WHENALTRETURN DO; END;
     3355      721
     3356      722    1      RETURN;
     3357      723    1   END ORR$BRKMSG;
     3358      724        %EOD;

PL6.E3A0      #002=ORR$BRKMSG File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:480  
--  Include file information  --

   OCL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ORR$BRKMSG.

   Procedure ORR$BRKMSG requires 13 words for executable code.
   Procedure ORR$BRKMSG requires 4 words of local(AUTO) storage.

PL6.E3A0      #002=ORR$BRKMSG File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:481  

 Object Unit name= ORR$BRKMSG                                 File name= ORR$REPLAY.:E05TOU
 UTS= JUL 30 '97 04:19:23.40 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    36     44  ORR$BRKMSG
    2   Proc  even  none    13     15  ORR$BRKMSG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  ORR$BRKMSG

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OCL_NORM_KEY
PL6.E3A0      #002=ORR$BRKMSG File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:482  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=ORR$BRKMSG File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:483  


     3326        1        /*T***********************************************************/
     3327        2        /*T*                                                         */
     3328        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3329        4        /*T*                                                         */
     3330        5        /*T***********************************************************/
     3331        6
     3332        7        ORR$BRKMSG: PROC;

      7  2 000000   000000 700200 xent  ORR$BRKMSG   TSX0  ! X66_AUTO_0
         2 000001   000004 000000                    ZERO    4,0

     3333        8
     3334        9        %INCLUDE CP_6;
     3335       90        %INCLUDE CP_6_SUBS;
     3336      630        %INCLUDE OCL_DATA_R;
     3337      655
     3338      656    1   DCL 1 BRKMSG STATIC CALIGNED,
     3339      657    1          2 * CHAR(0) INIT('Break at '),
     3340      658    1          2 TIME CHAR(0) INIT('HH:MM:SS.SS'),
     3341      659    1          2 * CHAR(0) INIT(' '),
     3342      660    1          2 DATE CHAR(0) INIT('MON DD ''YY'),
     3343      661    1          2 * CHAR(0) INIT('!  C to continue.');
     3344      662
     3345      663        %FPT_TIME(FPTN=KEY_TO_MSG,
     3346      664         SOURCE=UTS,TSTAMP=OCL_NORM_KEY.UTS,
     3347      665         DEST=EXT,DATE=BRKMSG.DATE,TIME=BRKMSG.TIME);
     3348      684
     3349      685        %FPT_WRITE(FPTN=WRITE_BRKMSG,
     3350      686         DCB=M$UC,
     3351      687         BUF=BRKMSG);
     3352      718
     3353      719    2      CALL M$TIME(KEY_TO_MSG) WHENALTRETURN DO; END;

    719  2 000002   000014 630400 1                  EPPR0   KEY_TO_MSG
         2 000003   420004 713400                    CLIMB   alt,+8196
         2 000004   402000 401760                    pmme    nvectors=5
PL6.E3A0      #002=ORR$BRKMSG File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:484  
         2 000005   000007 702000 2                  TSX2    s:720
         2 000006   000007 710000 2                  TRA     s:720

     3354      720    2      CALL M$WRITE(WRITE_BRKMSG) WHENALTRETURN DO; END;

    720  2 000007   000030 630400 1                  EPPR0   WRITE_BRKMSG
         2 000010   440001 713400                    CLIMB   alt,write
         2 000011   401400 401760                    pmme    nvectors=4
         2 000012   000014 702000 2                  TSX2    s:722
         2 000013   000014 710000 2                  TRA     s:722

     3355      721
     3356      722    1      RETURN;

    722  2 000014   000000 702200 xent               TSX2  ! X66_ARET
     3357      723    1   END ORR$BRKMSG;
     3358      724        %EOD;

PL6.E3A0      #002=ORR$BRKMSG File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:485  
--  Include file information  --

   OCL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ORR$BRKMSG.
PL6.E3A0      #002=ORR$BRKMSG File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:486  

 **** Variables and constants ****

  ****  Section 001  Data  ORR$BRKMSG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(432)   r     1 BRKMSG                    14-0-0/d STRC(432)   r     1 KEY_TO_MSG
    30-0-0/d STRC(432)   r     1 WRITE_BRKMSG

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b STRC(45)    r     1 OCL_NORM_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$UC


   Procedure ORR$BRKMSG requires 13 words for executable code.
   Procedure ORR$BRKMSG requires 4 words of local(AUTO) storage.
PL6.E3A0      #002=ORR$BRKMSG File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:487  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ORR$BRKMSG File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:488  
          MINI XREF LISTING

BRKMSG
       656**DCL       705--DCLINIT   706--DCLINIT
BRKMSG.DATE
       660**DCL       676--DCLINIT   677--DCLINIT
BRKMSG.TIME
       658**DCL       678--DCLINIT   679--DCLINIT
KEY_TO_MSG
       676**DCL       719<>CALL
KEY_TO_MSG.V
       680**DCL       676--DCLINIT
M$TIME
        85**DCL-ENT   719--CALL
M$WRITE
        19**DCL-ENT   720--CALL
OCL_HIST_BUF.STAT
       648**DCL       649--REDEF
OCL_MSGB.ERR
       646**DCL       647--REDEF
OCL_NORM_KEY.UTS
       647**DCL       680--DCLINIT
WRITE_BRKMSG
       704**DCL       720<>CALL
WRITE_BRKMSG.STATION_
       706**DCL       706--REDEF
WRITE_BRKMSG.V
       707**DCL       704--DCLINIT
WRITE_BRKMSG.V.DVBYTE.VFC#
       713**DCL       713--REDEF

PL6.E3A0      #003=OCC$TWSN2WSN File=ORR$REPLAY.:E05TSI                          WED 07/30/97 04:19 Page:489  
     3359        1        /*T***********************************************************/
     3360        2        /*T*                                                         */
     3361        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3362        4        /*T*                                                         */
     3363        5        /*T***********************************************************/
     3364        6
     3365        7        OCC$TWSN2WSN: PROC(ONE,TWO) ALTRET;
     3366        8    1   DCL ONE CHAR(8) UNAL;
     3367        9    1   DCL TWO CHAR(8) UNAL;
     3368       10    1      RETURN;
     3369       11    1   END OCC$TWSN2WSN;
     3370       12        %EOD;

PL6.E3A0      #003=OCC$TWSN2WSN File=ORR$REPLAY.:E05TSI                          WED 07/30/97 04:19 Page:490  
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure OCC$TWSN2WSN.

   Procedure OCC$TWSN2WSN requires 3 words for executable code.
   Procedure OCC$TWSN2WSN requires 6 words of local(AUTO) storage.

PL6.E3A0      #003=OCC$TWSN2WSN File=ORR$REPLAY.:E05TSI                          WED 07/30/97 04:19 Page:491  

 Object Unit name= OCC$TWSN2WSN                               File name= ORR$REPLAY.:E05TOU
 UTS= JUL 30 '97 04:19:32.80 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none     3      3  OCC$TWSN2WSN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        2  OCC$TWSN2WSN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
PL6.E3A0      #003=OCC$TWSN2WSN File=ORR$REPLAY.:E05TSI                          WED 07/30/97 04:19 Page:492  


     3359        1        /*T***********************************************************/
     3360        2        /*T*                                                         */
     3361        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3362        4        /*T*                                                         */
     3363        5        /*T***********************************************************/
     3364        6
     3365        7        OCC$TWSN2WSN: PROC(ONE,TWO) ALTRET;

      7  0 000000   000000 700200 xent  OCC$TWSN2WSN TSX0  ! X66_AUTO_2
         0 000001   000006 000002                    ZERO    6,2

     3366        8    1   DCL ONE CHAR(8) UNAL;
     3367        9    1   DCL TWO CHAR(8) UNAL;
     3368       10    1      RETURN;

     10  0 000002   000000 702200 xent               TSX2  ! X66_ARET
     3369       11    1   END OCC$TWSN2WSN;
     3370       12        %EOD;

PL6.E3A0      #003=OCC$TWSN2WSN File=ORR$REPLAY.:E05TSI                          WED 07/30/97 04:19 Page:493  
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure OCC$TWSN2WSN.
PL6.E3A0      #003=OCC$TWSN2WSN File=ORR$REPLAY.:E05TSI                          WED 07/30/97 04:19 Page:494  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @ONE                       4-0-0/w PTR         r     1 @TWO
    *0-0-0/c CHAR(8)     r     1 ONE                       *0-0-0/c CHAR(8)     r     1 TWO


   Procedure OCC$TWSN2WSN requires 3 words for executable code.
   Procedure OCC$TWSN2WSN requires 6 words of local(AUTO) storage.
PL6.E3A0      #003=OCC$TWSN2WSN File=ORR$REPLAY.:E05TSI                          WED 07/30/97 04:19 Page:495  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=OCC$TWSN2WSN File=ORR$REPLAY.:E05TSI                          WED 07/30/97 04:19 Page:496  
          MINI XREF LISTING

ONE
         8**DCL         7--PROC
TWO
         9**DCL         7--PROC

PL6.E3A0      #004=ORR$ABRKRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:19 Page:497  
     3371        1        /*T***********************************************************/
     3372        2        /*T*                                                         */
     3373        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3374        4        /*T*                                                         */
     3375        5        /*T***********************************************************/
     3376        6
     3377        7        ORR$ABRKRTN: PROC ASYNC;
     3378        8
     3379        9        %INCLUDE CP_6;
     3380       90        %INCLUDE CP_6_SUBS;
     3381      630        %INCLUDE OR_DAT_R;
     3382      640        %F$DCB;
     3383      697    1   DCL ORR$BRKRTN ENTRY;
     3384      698
     3385      699        %FPT_TRMPRG (FPTN=RESET_BREAKS,
     3386      700         RSTBRK=YES);
     3387      729
     3388      730    2      DO INHIBIT;
     3389      731    2         IF OR_BREAKING OR OR_IN_XCON THEN
     3390      732    3         CALL M$TRMPRG (RESET_BREAKS) WHENALTRETURN DO; END;
     3391      733    2         ELSE IF OR_OK_TO_BREAK THEN CALL ORR$BRKRTN;
     3392      734    2         ELSE OR_BRK_FLAG = %YES#;
     3393      735    2         RETURN;
     3394      736    2      END /* INHIBIT */;
     3395      737    1   END ORR$ABRKRTN;
     3396      738        %EOD;

PL6.E3A0      #004=ORR$ABRKRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:19 Page:498  
--  Include file information  --

   OR_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ORR$ABRKRTN.

   Procedure ORR$ABRKRTN requires 22 words for executable code.
   Procedure ORR$ABRKRTN requires 4 words of local(AUTO) storage.

PL6.E3A0      #004=ORR$ABRKRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:19 Page:499  

 Object Unit name= ORR$ABRKRTN                                File name= ORR$REPLAY.:E05TOU
 UTS= JUL 30 '97 04:19:34.84 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none     8     10  ORR$ABRKRTN
    2   Proc  even  none    22     26  ORR$ABRKRTN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes     Async       0  ORR$ABRKRTN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 ORR$BRKRTN
                       nStd      0 X66_AAUTO
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OR_BRK_FLAG                           OR_OK_TO_BREAK
     OR_BREAKING                           OR_IN_XCON                            B_VECTNIL
PL6.E3A0      #004=ORR$ABRKRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:19 Page:500  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #004=ORR$ABRKRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:19 Page:501  


     3371        1        /*T***********************************************************/
     3372        2        /*T*                                                         */
     3373        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3374        4        /*T*                                                         */
     3375        5        /*T***********************************************************/
     3376        6
     3377        7        ORR$ABRKRTN: PROC ASYNC;

      7  2 000000   000000 700200 xent  ORR$ABRKRTN  TSX0  ! X66_AAUTO
         2 000001   000004 000000                    ZERO    4,0

     3378        8
     3379        9        %INCLUDE CP_6;
     3380       90        %INCLUDE CP_6_SUBS;
     3381      630        %INCLUDE OR_DAT_R;
     3382      640        %F$DCB;
     3383      697    1   DCL ORR$BRKRTN ENTRY;
     3384      698
     3385      699        %FPT_TRMPRG (FPTN=RESET_BREAKS,
     3386      700         RSTBRK=YES);
     3387      729
     3388      730    2      DO INHIBIT;

     3389      731    2         IF OR_BREAKING OR OR_IN_XCON THEN

    731  2 000002   000000 234200 xsym               SZN   ! OR_BREAKING
         2 000003   000006 604200 2                  TMI   ! s:732
         2 000004   000000 234200 xsym               SZN   ! OR_IN_XCON
         2 000005   000014 605200 2                  TPL   ! s:733

     3390      732    3         CALL M$TRMPRG (RESET_BREAKS) WHENALTRETURN DO; END;

    732  2 000006   000000 630600 1                  EPPR0 ! RESET_BREAKS
         2 000007   560004 713600                    CLIMB ! alt,+57348
         2 000010   400400 401760                    pmme    nvectors=2
         2 000011   000013 702200 2                  TSX2  ! s:732+5
PL6.E3A0      #004=ORR$ABRKRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:19 Page:502  
         2 000012   000013 710200 2                  TRA   ! s:732+5

    732  2 000013   000024 710200 2                  TRA   ! s:735

     3391      733    2         ELSE IF OR_OK_TO_BREAK THEN CALL ORR$BRKRTN;

    733  2 000014   000000 234200 xsym               SZN   ! OR_OK_TO_BREAK
         2 000015   000022 605200 2                  TPL   ! s:734

    733  2 000016   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         2 000017   000000 701200 xent               TSX1  ! ORR$BRKRTN
         2 000020   000000 011200                    NOP   ! 0
         2 000021   000024 710200 2                  TRA   ! s:735

     3392      734    2         ELSE OR_BRK_FLAG = %YES#;

    734  2 000022   400000 236203                    LDQ   ! -131072,DU
         2 000023   000000 756200 xsym               STQ   ! OR_BRK_FLAG

     3393      735    2         RETURN;

    735  2 000024   000000 702200 xent               TSX2  ! X66_AARET

     3394      736    2      END /* INHIBIT */;

     3395      737    1   END ORR$ABRKRTN;

    737  2 000025   000000 702200 xent               TSX2  ! X66_AARET
     3396      738        %EOD;

PL6.E3A0      #004=ORR$ABRKRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:19 Page:503  
--  Include file information  --

   OR_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ORR$ABRKRTN.
PL6.E3A0      #004=ORR$ABRKRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:19 Page:504  

 **** Variables and constants ****

  ****  Section 001  Data  ORR$ABRKRTN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(288)   r     1 RESET_BREAKS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c BIT         r     1 OR_BREAKING                0-0-0/c BIT         r     1 OR_BRK_FLAG
     0-0-0/c BIT         r     1 OR_IN_XCON                 0-0-0/c BIT         r     1 OR_OK_TO_BREAK

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$UC


   Procedure ORR$ABRKRTN requires 22 words for executable code.
   Procedure ORR$ABRKRTN requires 4 words of local(AUTO) storage.
PL6.E3A0      #004=ORR$ABRKRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:19 Page:505  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=ORR$ABRKRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:19 Page:506  
          MINI XREF LISTING

F$DCB.ACTPOS
       673**DCL       673--REDEF
F$DCB.ARS#
       647**DCL       647--REDEF
F$DCB.ATTR
       666**DCL       667--REDEF
F$DCB.BORROW
       681**DCL       681--REDEF     681--REDEF     681--REDEF
F$DCB.DCBNAME.L
       695**DCL       695--IMP-SIZ
F$DCB.EOMCHAR#
       651**DCL       651--REDEF
F$DCB.FLDID
       676**DCL       676--REDEF
F$DCB.FORM$
       670**DCL       670--REDEF
F$DCB.FSECT
       686**DCL       686--REDEF
F$DCB.FSN#
       663**DCL       663--REDEF     663--REDEF     664--REDEF
F$DCB.HEADER$
       669**DCL       669--REDEF
F$DCB.IXTNSIZE#
       667**DCL       667--REDEF
F$DCB.LASTSTA$
       656**DCL       656--REDEF
F$DCB.LVL
       682**DCL       682--REDEF
F$DCB.NAME#.C
       657**DCL       657--REDEF
F$DCB.NOEOF
       679**DCL       679--REDEF
PL6.E3A0      #004=ORR$ABRKRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:19 Page:507  
F$DCB.NRECS#
       668**DCL       668--REDEF
F$DCB.NRECX
       687**DCL       687--REDEF
F$DCB.OHDR
       679**DCL       679--REDEF
F$DCB.ORG#
       662**DCL       662--REDEF
F$DCB.PRECNO
       685**DCL       685--REDEF
F$DCB.RCSZ
       691**DCL       691--REDEF
F$DCB.RES#
       658**DCL       658--REDEF
F$DCB.SETX
       670**DCL       670--REDEF
F$DCB.TAB$
       670**DCL       670--REDEF
F$DCB.TDA
       684**DCL       685--REDEF
F$DCB.WSN#
       658**DCL       658--REDEF
M$TRMPRG
        43**DCL-ENT   732--CALL
ORR$BRKRTN
       697**DCL-ENT   733--CALL
OR_BREAKING
       639**DCL       731>>IF
OR_BRK_FLAG
       638**DCL       734<<ASSIGN
OR_IN_XCON
       639**DCL       731>>IF
OR_OK_TO_BREAK
       638**DCL       733>>IF
RESET_BREAKS
       716**DCL       732<>CALL
PL6.E3A0      #004=ORR$ABRKRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:19 Page:508  
RESET_BREAKS.V
       723**DCL       718--DCLINIT
RESET_BREAKS.V.CTLFLG.RSTBRK#
       724**DCL       725--REDEF

PL6.E3A0      #005=ORR$BRKRTN File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:509  
     3397        1        /*T***********************************************************/
     3398        2        /*T*                                                         */
     3399        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3400        4        /*T*                                                         */
     3401        5        /*T***********************************************************/
     3402        6
     3403        7        ORR$BRKRTN: PROC;
     3404        8
     3405        9        %INCLUDE CP_6;
     3406       90        %INCLUDE CP_6_SUBS;
     3407      630        %INCLUDE OC_SUBS_C;
     3408     1361        %INCLUDE OC_MESSHD_C;
     3409     1414        %INCLUDE OR_DAT_R;
     3410     1424        %F$DCB;
     3411     1481    1   DCL F$HISTFILE DCB;
     3412     1482    1   DCL F$TEMPLATE DCB;
     3413     1483    1   DCL M$CSCG DCB;
     3414     1484    1   DCL REM_START REMEMBER SYMREF;
     3415     1485        %OC_MESSHD_W (NAME=OR_MESSBUF,
     3416     1486         DELIM=";");
     3417     1499
     3418     1500        %FPT_OPEN (FPTN=CS_OPEN,
     3419     1501         DCB=M$CSCG,
     3420     1502         ASN=COMGROUP,
     3421     1503         SETSTA=KSST,
     3422     1504         FUN=UPDATE,
     3423     1505         SHARE=ALL,
     3424     1506         ACCT=CSACCT,
     3425     1507         NAME=CSCGNM);
     3426     1616
     3427     1617        %VLP_NAME (FPTN=CSCGNM,
     3428     1618         NAME='CSCG');
     3429     1645
     3430     1646        %VLP_SETSTA (FPTN=KSST,
     3431     1647         STCLASS=CONSTANT,
     3432     1648         MYSTATION='OREPLAY');
     3433     1676
PL6.E3A0      #005=ORR$BRKRTN File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:510  
     3434     1677        %VLP_ACCT (FPTN=CSACCT,
     3435     1678         ACCT=':SYS');
     3436     1691
     3437     1692        %FPT_WRITE (FPTN=WRITE_CS,
     3438     1693         DCB=M$CSCG,
     3439     1694         STATION=STA,
     3440     1695         BP=YES,
     3441     1696         BUF=OR_MESSBUF);
     3442     1727
     3443     1728        %VLP_STATION (FPTN=STA,
     3444     1729         STATION='KEYIN');
     3445     1756
     3446     1757        %FPT_CLOSE (FPTN=CS_CLOSE,
     3447     1758         DCB=M$CSCG);
     3448     1800
     3449     1801        %FPT_CLOSE (FPTN=CLOSE_HIST,
     3450     1802         DCB=F$HISTFILE);
     3451     1844
     3452     1845        %FPT_CLOSE (FPTN=CLOSE_OCMSG,
     3453     1846         DCB=F$TEMPLATE);
     3454     1888
     3455     1889        %FPT_CLOSE (FPTN=CLOSE_CSCG,
     3456     1890         DCB=M$CSCG);
     3457     1932
     3458     1933
     3459     1934    2      DO INHIBIT;
     3460     1935    2         OR_BRK_FLAG = %NO#;
     3461     1936    2         OR_BREAKING = %YES#;
     3462     1937    2         IF DCBADDR (DCBNUM (F$HISTFILE)) -> F$DCB.FCD#
     3463     1938    3         THEN CALL M$CLOSE (CLOSE_HIST) WHENALTRETURN DO; END;
     3464     1939
     3465     1940    2         IF DCBADDR (DCBNUM (M$CSCG)) -> F$DCB.FCD#
     3466     1941    2         THEN CALL M$CLOSE (CS_CLOSE);
     3467     1942
     3468     1943    2         IF OCHIST_FLAG
     3469     1944    2         THEN
     3470     1945    3         DO INHIBIT;
PL6.E3A0      #005=ORR$BRKRTN File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:511  
     3471     1946    3            CALL M$OPEN (CS_OPEN);
     3472     1947    3            OR_MESSBUF.FCN = OC_START_EXCLU;
     3473     1948    3            OCHIST_FLAG = %NO#;
     3474     1949    3            CALL M$WRITE (WRITE_CS);
     3475     1950    3            CALL M$CLOSE (CS_CLOSE);
     3476     1951    3         END;
     3477     1952
     3478     1953    2         IF DCBADDR (DCBNUM (F$TEMPLATE)) -> F$DCB.FCD#
     3479     1954    3         THEN CALL M$CLOSE (CLOSE_OCMSG) WHENALTRETURN DO; END;
     3480     1955
     3481     1956    2         IF DCBADDR (DCBNUM (M$CSCG)) -> F$DCB.FCD#
     3482     1957    3         THEN CALL M$CLOSE (CS_CLOSE) WHENALTRETURN DO; END;
     3483     1958
     3484     1959    3         DO INHIBIT;
     3485     1960    3            OR_BREAKING = %NO#;
     3486     1961    4            CALL M$CLRSTK WHENALTRETURN DO; END;
     3487     1962    3            UNWIND TO REM_START;
     3488     1963    3         END;
     3489     1964    2      END;
     3490     1965    1   END ORR$BRKRTN;
     3491     1966        %EOD;

PL6.E3A0      #005=ORR$BRKRTN File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:512  
--  Include file information  --

   OR_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ORR$BRKRTN.

   Procedure ORR$BRKRTN requires 74 words for executable code.
   Procedure ORR$BRKRTN requires 4 words of local(AUTO) storage.

PL6.E3A0      #005=ORR$BRKRTN File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:513  

 Object Unit name= ORR$BRKRTN                                 File name= ORR$REPLAY.:E05TOU
 UTS= JUL 30 '97 04:19:46.36 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  F$HISTFILE
    2   DCB   even  none     0      0  F$TEMPLATE
    3   DCB   even  none     0      0  M$CSCG
    4   Data  even  none   208    320  ORR$BRKRTN
    5  RoData even  UTS     12     14  ORR$BRKRTN
    6   Proc  even  none    74    112  ORR$BRKRTN
    7  RoData even  none     1      1  ORR$BRKRTN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes            yes      Std        0  ORR$BRKRTN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_AUNWIND
                       nStd      0 X66_ARET
PL6.E3A0      #005=ORR$BRKRTN File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:514  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OCHIST_FLAG                           OR_BRK_FLAG
     OR_BREAKING                           F$HISTFILE                            F$TEMPLATE
     M$CSCG                                REM_START

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #005=ORR$BRKRTN File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:515  


     3397        1        /*T***********************************************************/
     3398        2        /*T*                                                         */
     3399        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3400        4        /*T*                                                         */
     3401        5        /*T***********************************************************/
     3402        6
     3403        7        ORR$BRKRTN: PROC;

      7  6 000000   000000 700200 xent  ORR$BRKRTN   TSX0  ! X66_AUTO_0
         6 000001   000004 000000                    ZERO    4,0

     3404        8
     3405        9        %INCLUDE CP_6;
     3406       90        %INCLUDE CP_6_SUBS;
     3407      630        %INCLUDE OC_SUBS_C;
     3408     1361        %INCLUDE OC_MESSHD_C;
     3409     1414        %INCLUDE OR_DAT_R;
     3410     1424        %F$DCB;
     3411     1481    1   DCL F$HISTFILE DCB;
     3412     1482    1   DCL F$TEMPLATE DCB;
     3413     1483    1   DCL M$CSCG DCB;
     3414     1484    1   DCL REM_START REMEMBER SYMREF;
     3415     1485        %OC_MESSHD_W (NAME=OR_MESSBUF,
     3416     1486         DELIM=";");
     3417     1499
     3418     1500        %FPT_OPEN (FPTN=CS_OPEN,
     3419     1501         DCB=M$CSCG,
     3420     1502         ASN=COMGROUP,
     3421     1503         SETSTA=KSST,
     3422     1504         FUN=UPDATE,
     3423     1505         SHARE=ALL,
     3424     1506         ACCT=CSACCT,
     3425     1507         NAME=CSCGNM);
     3426     1616
     3427     1617        %VLP_NAME (FPTN=CSCGNM,
     3428     1618         NAME='CSCG');
PL6.E3A0      #005=ORR$BRKRTN File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:516  
     3429     1645
     3430     1646        %VLP_SETSTA (FPTN=KSST,
     3431     1647         STCLASS=CONSTANT,
     3432     1648         MYSTATION='OREPLAY');
     3433     1676
     3434     1677        %VLP_ACCT (FPTN=CSACCT,
     3435     1678         ACCT=':SYS');
     3436     1691
     3437     1692        %FPT_WRITE (FPTN=WRITE_CS,
     3438     1693         DCB=M$CSCG,
     3439     1694         STATION=STA,
     3440     1695         BP=YES,
     3441     1696         BUF=OR_MESSBUF);
     3442     1727
     3443     1728        %VLP_STATION (FPTN=STA,
     3444     1729         STATION='KEYIN');
     3445     1756
     3446     1757        %FPT_CLOSE (FPTN=CS_CLOSE,
     3447     1758         DCB=M$CSCG);
     3448     1800
     3449     1801        %FPT_CLOSE (FPTN=CLOSE_HIST,
     3450     1802         DCB=F$HISTFILE);
     3451     1844
     3452     1845        %FPT_CLOSE (FPTN=CLOSE_OCMSG,
     3453     1846         DCB=F$TEMPLATE);
     3454     1888
     3455     1889        %FPT_CLOSE (FPTN=CLOSE_CSCG,
     3456     1890         DCB=M$CSCG);
     3457     1932
     3458     1933
     3459     1934    2      DO INHIBIT;

     3460     1935    2         OR_BRK_FLAG = %NO#;

   1935  6 000002   000000 450200 xsym               STZ   ! OR_BRK_FLAG

     3461     1936    2         OR_BREAKING = %YES#;
PL6.E3A0      #005=ORR$BRKRTN File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:517  

   1936  6 000003   400000 236203                    LDQ   ! -131072,DU
         6 000004   000000 756200 xsym               STQ   ! OR_BREAKING

     3462     1937    2         IF DCBADDR (DCBNUM (F$HISTFILE)) -> F$DCB.FCD#

   1937  6 000005   000000 236207 xsym               LDQ   ! F$HISTFILE,DL
         6 000006   000000 470600 7                  LDP0  ! 0
         6 000007   000000 471700                    LDP1  ! 0,,PR0
         6 000010   100000 473706                    LDP3  ! 0,QL,PR1
         6 000011   300031 236300                    LDQ   ! 25,,PR3
         6 000012   020000 316207                    CANQ  ! 8192,DL
         6 000013   000021 600200 6                  TZE   ! s:1940

     3463     1938    3         THEN CALL M$CLOSE (CLOSE_HIST) WHENALTRETURN DO; END;

   1938  6 000014   000166 630600 4                  EPPR0 ! CLOSE_HIST
         6 000015   450001 713600                    CLIMB ! alt,close
         6 000016   406000 401760                    pmme    nvectors=13
         6 000017   000021 702200 6                  TSX2  ! s:1940
         6 000020   000021 710200 6                  TRA   ! s:1940

     3464     1939
     3465     1940    2         IF DCBADDR (DCBNUM (M$CSCG)) -> F$DCB.FCD#

   1940  6 000021   000000 236207 xsym               LDQ   ! M$CSCG,DL
         6 000022   000000 470600 7                  LDP0  ! 0
         6 000023   000000 471700                    LDP1  ! 0,,PR0
         6 000024   100000 473706                    LDP3  ! 0,QL,PR1
         6 000025   300031 236300                    LDQ   ! 25,,PR3
         6 000026   020000 316207                    CANQ  ! 8192,DL
         6 000027   000033 600200 6                  TZE   ! s:1943

     3466     1941    2         THEN CALL M$CLOSE (CS_CLOSE);

   1941  6 000030   000130 630600 4                  EPPR0 ! CS_CLOSE
         6 000031   050001 713600                    CLIMB ! close
PL6.E3A0      #005=ORR$BRKRTN File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:518  
         6 000032   406000 401760                    pmme    nvectors=13

     3467     1942
     3468     1943    2         IF OCHIST_FLAG

   1943  6 000033   000000 234200 xsym               SZN   ! OCHIST_FLAG
         6 000034   000051 605200 6                  TPL   ! s:1953

     3469     1944    2         THEN
     3470     1945    3         DO INHIBIT;

     3471     1946    3            CALL M$OPEN (CS_OPEN);

   1946  6 000035   000006 630600 4                  EPPR0 ! CS_OPEN
         6 000036   050000 713600                    CLIMB ! open
         6 000037   410400 401760                    pmme    nvectors=18

     3472     1947    3            OR_MESSBUF.FCN = OC_START_EXCLU;

   1947  6 000040   000012 236207                    LDQ   ! 10,DL
         6 000041   000001 552204 4                  STBQ  ! OR_MESSBUF+1,'04'O

     3473     1948    3            OCHIST_FLAG = %NO#;

   1948  6 000042   000000 450200 xsym               STZ   ! OCHIST_FLAG

     3474     1949    3            CALL M$WRITE (WRITE_CS);

   1949  6 000043   000104 630600 4                  EPPR0 ! WRITE_CS
         6 000044   040001 713600                    CLIMB ! write
         6 000045   401400 401760                    pmme    nvectors=4

     3475     1950    3            CALL M$CLOSE (CS_CLOSE);

   1950  6 000046   000130 630600 4                  EPPR0 ! CS_CLOSE
         6 000047   050001 713600                    CLIMB ! close
         6 000050   406000 401760                    pmme    nvectors=13
PL6.E3A0      #005=ORR$BRKRTN File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:519  

     3476     1951    3         END;

     3477     1952
     3478     1953    2         IF DCBADDR (DCBNUM (F$TEMPLATE)) -> F$DCB.FCD#

   1953  6 000051   000000 236207 xsym               LDQ   ! F$TEMPLATE,DL
         6 000052   000000 470600 7                  LDP0  ! 0
         6 000053   000000 471700                    LDP1  ! 0,,PR0
         6 000054   100000 473706                    LDP3  ! 0,QL,PR1
         6 000055   300031 236300                    LDQ   ! 25,,PR3
         6 000056   020000 316207                    CANQ  ! 8192,DL
         6 000057   000065 600200 6                  TZE   ! s:1956

     3479     1954    3         THEN CALL M$CLOSE (CLOSE_OCMSG) WHENALTRETURN DO; END;

   1954  6 000060   000224 630600 4                  EPPR0 ! CLOSE_OCMSG
         6 000061   450001 713600                    CLIMB ! alt,close
         6 000062   406000 401760                    pmme    nvectors=13
         6 000063   000065 702200 6                  TSX2  ! s:1956
         6 000064   000065 710200 6                  TRA   ! s:1956

     3480     1955
     3481     1956    2         IF DCBADDR (DCBNUM (M$CSCG)) -> F$DCB.FCD#

   1956  6 000065   000000 236207 xsym               LDQ   ! M$CSCG,DL
         6 000066   000000 470600 7                  LDP0  ! 0
         6 000067   000000 471700                    LDP1  ! 0,,PR0
         6 000070   100000 473706                    LDP3  ! 0,QL,PR1
         6 000071   300031 236300                    LDQ   ! 25,,PR3
         6 000072   020000 316207                    CANQ  ! 8192,DL
         6 000073   000101 600200 6                  TZE   ! s:1960

     3482     1957    3         THEN CALL M$CLOSE (CS_CLOSE) WHENALTRETURN DO; END;

   1957  6 000074   000130 630600 4                  EPPR0 ! CS_CLOSE
         6 000075   450001 713600                    CLIMB ! alt,close
PL6.E3A0      #005=ORR$BRKRTN File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:520  
         6 000076   406000 401760                    pmme    nvectors=13
         6 000077   000101 702200 6                  TSX2  ! s:1960
         6 000100   000101 710200 6                  TRA   ! s:1960

     3483     1958
     3484     1959    3         DO INHIBIT;

     3485     1960    3            OR_BREAKING = %NO#;

   1960  6 000101   000000 450200 xsym               STZ   ! OR_BREAKING

     3486     1961    4            CALL M$CLRSTK WHENALTRETURN DO; END;

   1961  6 000102   410013 713600                    CLIMB ! alt,+4107
         6 000103   000000 401760                    pmme    nvectors=0
         6 000104   000106 702200 6                  TSX2  ! s:1962
         6 000105   000106 710200 6                  TRA   ! s:1962

     3487     1962    3            UNWIND TO REM_START;

   1962  6 000106   000000 237200 xsym               LDAQ  ! REM_START
         6 000107   000000 700200 xent               TSX0  ! X66_AUNWIND
         6 000110   000000 000200                    ZERO    0,128

     3488     1963    3         END;

     3489     1964    2      END;

     3490     1965    1   END ORR$BRKRTN;

   1965  6 000111   000000 702200 xent               TSX2  ! X66_ARET
     3491     1966        %EOD;

PL6.E3A0      #005=ORR$BRKRTN File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:521  
--  Include file information  --

   OR_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ORR$BRKRTN.
PL6.E3A0      #005=ORR$BRKRTN File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:522  

 **** Variables and constants ****

  ****  Section 004  Data  ORR$BRKRTN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   262-0-0/d STRC(1080)  r     1 CLOSE_CSCG               166-0-0/d STRC(1080)  r     1 CLOSE_HIST
   224-0-0/d STRC(1080)  r     1 CLOSE_OCMSG              102-0-0/c STRC(72)    r     1 CSACCT
   100-0-0/c STRC(45)    r     1 CSCGNM                   130-0-0/d STRC(1080)  r     1 CS_CLOSE
     6-0-0/d STRC(2088)  r     1 CS_OPEN                    0-0-0/c STRC(180)   r     1 OR_MESSBUF
   120-0-0/w STRC(288)   r     1 STA                      104-0-0/d STRC(432)   r     1 WRITE_CS

  ****  Section 005 RoData ORR$BRKRTN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(432)   r     1 KSST

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c BIT         r     1 OCHIST_FLAG                0-0-0/c BIT         r     1 OR_BREAKING
     0-0-0/c BIT         r     1 OR_BRK_FLAG                0-0-0/d REMB        r     1 REM_START

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 F$HISTFILE
     0-0-0N  NULL        r     1 F$TEMPLATE                 0-0-0N  NULL        r     1 M$CSCG

PL6.E3A0      #005=ORR$BRKRTN File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:523  

   Procedure ORR$BRKRTN requires 74 words for executable code.
   Procedure ORR$BRKRTN requires 4 words of local(AUTO) storage.
PL6.E3A0      #005=ORR$BRKRTN File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:524  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=ORR$BRKRTN File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:525  
          MINI XREF LISTING

CLOSE_CSCG.SN_
      1913**DCL      1913--REDEF
CLOSE_CSCG.UTL_
      1914**DCL      1914--REDEF
CLOSE_CSCG.V
      1918**DCL      1913--DCLINIT
CLOSE_CSCG.V.EXPIRE#
      1928**DCL      1928--REDEF
CLOSE_CSCG.V.TYPE#
      1926**DCL      1926--REDEF
CLOSE_CSCG.V.XTNSIZE#
      1923**DCL      1923--REDEF    1925--REDEF
CLOSE_HIST
      1825**DCL      1938<>CALL
CLOSE_HIST.SN_
      1825**DCL      1825--REDEF
CLOSE_HIST.UTL_
      1826**DCL      1826--REDEF
CLOSE_HIST.V
      1830**DCL      1825--DCLINIT
CLOSE_HIST.V.EXPIRE#
      1840**DCL      1840--REDEF
CLOSE_HIST.V.TYPE#
      1838**DCL      1838--REDEF
CLOSE_HIST.V.XTNSIZE#
      1835**DCL      1835--REDEF    1837--REDEF
CLOSE_OCMSG
      1869**DCL      1954<>CALL
CLOSE_OCMSG.SN_
      1869**DCL      1869--REDEF
CLOSE_OCMSG.UTL_
      1870**DCL      1870--REDEF
PL6.E3A0      #005=ORR$BRKRTN File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:526  
CLOSE_OCMSG.V
      1874**DCL      1869--DCLINIT
CLOSE_OCMSG.V.EXPIRE#
      1884**DCL      1884--REDEF
CLOSE_OCMSG.V.TYPE#
      1882**DCL      1882--REDEF
CLOSE_OCMSG.V.XTNSIZE#
      1879**DCL      1879--REDEF    1881--REDEF
CSACCT
      1689**DCL      1577--DCLINIT
CSCGNM
      1643**DCL      1573--DCLINIT
CS_CLOSE
      1781**DCL      1941<>CALL     1950<>CALL     1957<>CALL
CS_CLOSE.SN_
      1781**DCL      1781--REDEF
CS_CLOSE.UTL_
      1782**DCL      1782--REDEF
CS_CLOSE.V
      1786**DCL      1781--DCLINIT
CS_CLOSE.V.EXPIRE#
      1796**DCL      1796--REDEF
CS_CLOSE.V.TYPE#
      1794**DCL      1794--REDEF
CS_CLOSE.V.XTNSIZE#
      1791**DCL      1791--REDEF    1793--REDEF
CS_OPEN
      1572**DCL      1946<>CALL
CS_OPEN.ACSVEH_
      1574**DCL      1575--REDEF
CS_OPEN.ALTKEYS_
      1580**DCL      1581--REDEF    1581--REDEF
CS_OPEN.HDR_
      1579**DCL      1580--REDEF
CS_OPEN.TAB_
      1578**DCL      1579--REDEF
PL6.E3A0      #005=ORR$BRKRTN File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:527  
CS_OPEN.UHL_
      1572**DCL      1573--REDEF    1573--REDEF
CS_OPEN.V
      1581**DCL      1572--DCLINIT
CS_OPEN.V.FSN#
      1612**DCL      1612--REDEF    1612--REDEF
CS_OPEN.WSN_
      1578**DCL      1578--REDEF
F$DCB.ACTPOS
      1457**DCL      1457--REDEF
F$DCB.ARS#
      1431**DCL      1431--REDEF
F$DCB.ATTR
      1450**DCL      1451--REDEF
F$DCB.BORROW
      1465**DCL      1465--REDEF    1465--REDEF    1465--REDEF
F$DCB.DCBNAME.L
      1479**DCL      1479--IMP-SIZ
F$DCB.EOMCHAR#
      1435**DCL      1435--REDEF
F$DCB.FCD#
      1444**DCL      1937>>IF       1940>>IF       1953>>IF       1956>>IF
F$DCB.FLDID
      1460**DCL      1460--REDEF
F$DCB.FORM$
      1454**DCL      1454--REDEF
F$DCB.FSECT
      1470**DCL      1470--REDEF
F$DCB.FSN#
      1447**DCL      1447--REDEF    1447--REDEF    1448--REDEF
F$DCB.HEADER$
      1453**DCL      1453--REDEF
F$DCB.IXTNSIZE#
      1451**DCL      1451--REDEF
F$DCB.LASTSTA$
      1440**DCL      1440--REDEF
PL6.E3A0      #005=ORR$BRKRTN File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:528  
F$DCB.LVL
      1466**DCL      1466--REDEF
F$DCB.NAME#.C
      1441**DCL      1441--REDEF
F$DCB.NOEOF
      1463**DCL      1463--REDEF
F$DCB.NRECS#
      1452**DCL      1452--REDEF
F$DCB.NRECX
      1471**DCL      1471--REDEF
F$DCB.OHDR
      1463**DCL      1463--REDEF
F$DCB.ORG#
      1446**DCL      1446--REDEF
F$DCB.PRECNO
      1469**DCL      1469--REDEF
F$DCB.RCSZ
      1475**DCL      1475--REDEF
F$DCB.RES#
      1442**DCL      1442--REDEF
F$DCB.SETX
      1454**DCL      1454--REDEF
F$DCB.TAB$
      1454**DCL      1454--REDEF
F$DCB.TDA
      1468**DCL      1469--REDEF
F$DCB.WSN#
      1442**DCL      1442--REDEF
F$HISTFILE
      1481**DCL      1937--IF
F$TEMPLATE
      1482**DCL      1953--IF
KSST
      1660**DCL      1573--DCLINIT
M$CLOSE
        18**DCL-ENT  1938--CALL     1941--CALL     1950--CALL     1954--CALL     1957--CALL
PL6.E3A0      #005=ORR$BRKRTN File=ORR$REPLAY.:E05TSI                            WED 07/30/97 04:19 Page:529  
M$CLRSTK
        76**DCL-ENT  1961--CALL
M$CSCG
      1483**DCL      1940--IF       1956--IF
M$OPEN
        18**DCL-ENT  1946--CALL
M$WRITE
        19**DCL-ENT  1949--CALL
OCHIST_FLAG
      1422**DCL      1943>>IF       1948<<ASSIGN
OR_BREAKING
      1423**DCL      1936<<ASSIGN   1960<<ASSIGN
OR_BRK_FLAG
      1422**DCL      1935<<ASSIGN
OR_MESSBUF
      1487**DCL      1714--DCLINIT  1715--DCLINIT
OR_MESSBUF.FCN
      1493**DCL      1947<<ASSIGN
OR_MESSBUF.FLAGS
      1494**DCL      1495--REDEF
OR_MESSBUF.MSGID
      1490**DCL      1491--REDEF
REM_START
      1484**DCL      1962>>UNWIND
STA
      1741**DCL      1715--DCLINIT
STA.MSGIDXT
      1751**DCL      1754--REDEF
WRITE_CS
      1713**DCL      1949<>CALL
WRITE_CS.STATION_
      1715**DCL      1715--REDEF
WRITE_CS.V
      1716**DCL      1713--DCLINIT
WRITE_CS.V.DVBYTE.VFC#
      1722**DCL      1722--REDEF

PL6.E3A0      #006=ORR$AXCONRTN File=ORR$REPLAY.:E05TSI                          WED 07/30/97 04:20 Page:530  
     3492        1        /*T***********************************************************/
     3493        2        /*T*                                                         */
     3494        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3495        4        /*T*                                                         */
     3496        5        /*T***********************************************************/
     3497        6        ORR$AXCONRTN: PROC ASYNC;
     3498        7
     3499        8        %INCLUDE CP_6;
     3500       89        %INCLUDE CP_6_SUBS;
     3501      629        %INCLUDE OR_DAT_R;
     3502      639        %F$DCB;
     3503      696
     3504      697    1   DCL ORR$XCONRTN ENTRY;
     3505      698
     3506      699        %FPT_TRMPRG (FPTN=RESET_BREAKS,
     3507      700         RSTBRK=YES);
     3508      729
     3509      730    2      DO INHIBIT;
     3510      731    2         IF OR_IN_XCON
     3511      732    3         THEN CALL M$TRMPRG (RESET_BREAKS) WHENALTRETURN DO; END;
     3512      733    2         ELSE IF OR_OK_TO_BREAK THEN CALL ORR$XCONRTN;
     3513      734    2         ELSE OR_XCON_FLAG = %YES#;
     3514      735    2         RETURN;
     3515      736    2      END; /*INHIBIT*/
     3516      737    1   END ORR$AXCONRTN;
     3517      738        %EOD;

PL6.E3A0      #006=ORR$AXCONRTN File=ORR$REPLAY.:E05TSI                          WED 07/30/97 04:20 Page:531  
--  Include file information  --

   OR_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ORR$AXCONRTN.

   Procedure ORR$AXCONRTN requires 20 words for executable code.
   Procedure ORR$AXCONRTN requires 4 words of local(AUTO) storage.

PL6.E3A0      #006=ORR$AXCONRTN File=ORR$REPLAY.:E05TSI                          WED 07/30/97 04:20 Page:532  

 Object Unit name= ORR$AXCONRTN                               File name= ORR$REPLAY.:E05TOU
 UTS= JUL 30 '97 04:20:14.48 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none     8     10  ORR$AXCONRTN
    2   Proc  even  none    20     24  ORR$AXCONRTN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes     Async       0  ORR$AXCONRTN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 ORR$XCONRTN
                       nStd      0 X66_AAUTO
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OR_XCON_FLAG                          OR_OK_TO_BREAK
     OR_IN_XCON                            B_VECTNIL
PL6.E3A0      #006=ORR$AXCONRTN File=ORR$REPLAY.:E05TSI                          WED 07/30/97 04:20 Page:533  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #006=ORR$AXCONRTN File=ORR$REPLAY.:E05TSI                          WED 07/30/97 04:20 Page:534  


     3492        1        /*T***********************************************************/
     3493        2        /*T*                                                         */
     3494        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3495        4        /*T*                                                         */
     3496        5        /*T***********************************************************/
     3497        6        ORR$AXCONRTN: PROC ASYNC;

      6  2 000000   000000 700200 xent  ORR$AXCONRTN TSX0  ! X66_AAUTO
         2 000001   000004 000000                    ZERO    4,0

     3498        7
     3499        8        %INCLUDE CP_6;
     3500       89        %INCLUDE CP_6_SUBS;
     3501      629        %INCLUDE OR_DAT_R;
     3502      639        %F$DCB;
     3503      696
     3504      697    1   DCL ORR$XCONRTN ENTRY;
     3505      698
     3506      699        %FPT_TRMPRG (FPTN=RESET_BREAKS,
     3507      700         RSTBRK=YES);
     3508      729
     3509      730    2      DO INHIBIT;

     3510      731    2         IF OR_IN_XCON

    731  2 000002   000000 234200 xsym               SZN   ! OR_IN_XCON
         2 000003   000012 605200 2                  TPL   ! s:733

     3511      732    3         THEN CALL M$TRMPRG (RESET_BREAKS) WHENALTRETURN DO; END;

    732  2 000004   000000 630600 1                  EPPR0 ! RESET_BREAKS
         2 000005   560004 713600                    CLIMB ! alt,+57348
         2 000006   400400 401760                    pmme    nvectors=2
         2 000007   000011 702200 2                  TSX2  ! s:732+5
         2 000010   000011 710200 2                  TRA   ! s:732+5

PL6.E3A0      #006=ORR$AXCONRTN File=ORR$REPLAY.:E05TSI                          WED 07/30/97 04:20 Page:535  
    732  2 000011   000022 710200 2                  TRA   ! s:735

     3512      733    2         ELSE IF OR_OK_TO_BREAK THEN CALL ORR$XCONRTN;

    733  2 000012   000000 234200 xsym               SZN   ! OR_OK_TO_BREAK
         2 000013   000020 605200 2                  TPL   ! s:734

    733  2 000014   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         2 000015   000000 701200 xent               TSX1  ! ORR$XCONRTN
         2 000016   000000 011200                    NOP   ! 0
         2 000017   000022 710200 2                  TRA   ! s:735

     3513      734    2         ELSE OR_XCON_FLAG = %YES#;

    734  2 000020   400000 236203                    LDQ   ! -131072,DU
         2 000021   000000 756200 xsym               STQ   ! OR_XCON_FLAG

     3514      735    2         RETURN;

    735  2 000022   000000 702200 xent               TSX2  ! X66_AARET

     3515      736    2      END; /*INHIBIT*/

     3516      737    1   END ORR$AXCONRTN;

    737  2 000023   000000 702200 xent               TSX2  ! X66_AARET
     3517      738        %EOD;

PL6.E3A0      #006=ORR$AXCONRTN File=ORR$REPLAY.:E05TSI                          WED 07/30/97 04:20 Page:536  
--  Include file information  --

   OR_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ORR$AXCONRTN.
PL6.E3A0      #006=ORR$AXCONRTN File=ORR$REPLAY.:E05TSI                          WED 07/30/97 04:20 Page:537  

 **** Variables and constants ****

  ****  Section 001  Data  ORR$AXCONRTN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(288)   r     1 RESET_BREAKS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c BIT         r     1 OR_IN_XCON                 0-0-0/c BIT         r     1 OR_OK_TO_BREAK
     0-0-0/c BIT         r     1 OR_XCON_FLAG

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$UC


   Procedure ORR$AXCONRTN requires 20 words for executable code.
   Procedure ORR$AXCONRTN requires 4 words of local(AUTO) storage.
PL6.E3A0      #006=ORR$AXCONRTN File=ORR$REPLAY.:E05TSI                          WED 07/30/97 04:20 Page:538  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=ORR$AXCONRTN File=ORR$REPLAY.:E05TSI                          WED 07/30/97 04:20 Page:539  
          MINI XREF LISTING

F$DCB.ACTPOS
       672**DCL       672--REDEF
F$DCB.ARS#
       646**DCL       646--REDEF
F$DCB.ATTR
       665**DCL       666--REDEF
F$DCB.BORROW
       680**DCL       680--REDEF     680--REDEF     680--REDEF
F$DCB.DCBNAME.L
       694**DCL       694--IMP-SIZ
F$DCB.EOMCHAR#
       650**DCL       650--REDEF
F$DCB.FLDID
       675**DCL       675--REDEF
F$DCB.FORM$
       669**DCL       669--REDEF
F$DCB.FSECT
       685**DCL       685--REDEF
F$DCB.FSN#
       662**DCL       662--REDEF     662--REDEF     663--REDEF
F$DCB.HEADER$
       668**DCL       668--REDEF
F$DCB.IXTNSIZE#
       666**DCL       666--REDEF
F$DCB.LASTSTA$
       655**DCL       655--REDEF
F$DCB.LVL
       681**DCL       681--REDEF
F$DCB.NAME#.C
       656**DCL       656--REDEF
F$DCB.NOEOF
       678**DCL       678--REDEF
PL6.E3A0      #006=ORR$AXCONRTN File=ORR$REPLAY.:E05TSI                          WED 07/30/97 04:20 Page:540  
F$DCB.NRECS#
       667**DCL       667--REDEF
F$DCB.NRECX
       686**DCL       686--REDEF
F$DCB.OHDR
       678**DCL       678--REDEF
F$DCB.ORG#
       661**DCL       661--REDEF
F$DCB.PRECNO
       684**DCL       684--REDEF
F$DCB.RCSZ
       690**DCL       690--REDEF
F$DCB.RES#
       657**DCL       657--REDEF
F$DCB.SETX
       669**DCL       669--REDEF
F$DCB.TAB$
       669**DCL       669--REDEF
F$DCB.TDA
       683**DCL       684--REDEF
F$DCB.WSN#
       657**DCL       657--REDEF
M$TRMPRG
        42**DCL-ENT   732--CALL
ORR$XCONRTN
       697**DCL-ENT   733--CALL
OR_IN_XCON
       638**DCL       731>>IF
OR_OK_TO_BREAK
       637**DCL       733>>IF
OR_XCON_FLAG
       637**DCL       734<<ASSIGN
RESET_BREAKS
       716**DCL       732<>CALL
RESET_BREAKS.V
       723**DCL       718--DCLINIT
PL6.E3A0      #006=ORR$AXCONRTN File=ORR$REPLAY.:E05TSI                          WED 07/30/97 04:20 Page:541  
RESET_BREAKS.V.CTLFLG.RSTBRK#
       724**DCL       725--REDEF

PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:542  
     3518        1        /*T***********************************************************/
     3519        2        /*T*                                                         */
     3520        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3521        4        /*T*                                                         */
     3522        5        /*T***********************************************************/
     3523        6        ORR$XCONRTN: PROC;
     3524        7
     3525        8        %INCLUDE CP_6;
     3526       89        %INCLUDE CP_6_SUBS;
     3527      629        %INCLUDE OC_SUBS_C;
     3528     1360        %INCLUDE OC_MESSHD_C;
     3529     1413        %INCLUDE OR_DAT_R;
     3530     1423        %F$DCB;
     3531     1480    1   DCL F$HISTFILE DCB;
     3532     1481    1   DCL F$TEMPLATE DCB;
     3533     1482    1   DCL M$CSCG DCB;
     3534     1483
     3535     1484        %OC_MESSHD_W (NAME=OR_MESSBUF,
     3536     1485         DELIM=";");
     3537     1498
     3538     1499        %FPT_OPEN (FPTN=CS_OPEN,
     3539     1500         DCB=M$CSCG,
     3540     1501         ASN=COMGROUP,
     3541     1502         SETSTA=KSST,
     3542     1503         FUN=UPDATE,
     3543     1504         SHARE=ALL,
     3544     1505         ACCT=CSACCT,
     3545     1506         NAME=CSCGNM);
     3546     1615
     3547     1616        %FPT_XCON (FPTN=SET_EXIT);
     3548     1630
     3549     1631
     3550     1632        %VLP_NAME (FPTN=CSCGNM,
     3551     1633         NAME='CSCG');
     3552     1660
     3553     1661        %VLP_SETSTA (FPTN=KSST,
     3554     1662         STCLASS=CONSTANT,
PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:543  
     3555     1663         MYSTATION='OREPLAY');
     3556     1691
     3557     1692        %VLP_ACCT (FPTN=CSACCT,
     3558     1693         ACCT=':SYS');
     3559     1706
     3560     1707        %FPT_WRITE (FPTN=WRITE_CS,
     3561     1708         DCB=M$CSCG,
     3562     1709         STATION=STA,
     3563     1710         BP=YES,
     3564     1711         BUF=OR_MESSBUF);
     3565     1742
     3566     1743        %VLP_STATION (FPTN=STA,
     3567     1744         STATION='KEYIN');
     3568     1771
     3569     1772        %FPT_CLOSE (FPTN=CS_CLOSE,
     3570     1773         DCB=M$CSCG);
     3571     1815
     3572     1816
     3573     1817        %FPT_CLOSE (FPTN=CLOSE_HIST,
     3574     1818         DCB=F$HISTFILE);
     3575     1860
     3576     1861        %FPT_CLOSE (FPTN=CLOSE_OCMSG,
     3577     1862         DCB=F$TEMPLATE);
     3578     1904
     3579     1905        %FPT_CLOSE (FPTN=CLOSE_CSCG,
     3580     1906         DCB=M$CSCG);
     3581     1948
     3582     1949    2      DO INHIBIT;
     3583     1950    2         OR_BREAKING = %NO#;
     3584     1951    2         OR_XCON_FLAG = %NO#;
     3585     1952    2         OR_IN_XCON = %YES#;
     3586     1953    2         OR_BRK_FLAG = %NO#;
     3587     1954
     3588     1955    2         IF DCBADDR (DCBNUM (F$HISTFILE)) -> F$DCB.FCD#
     3589     1956    3         THEN CALL M$CLOSE (CLOSE_HIST) WHENALTRETURN DO; END;
     3590     1957
     3591     1958    3         IF OCHIST_FLAG THEN DO;
PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:544  
     3592     1959    3            OCHIST_FLAG = %NO#;            /* No use trying this twice!          */
     3593     1960
     3594     1961    4            CALL M$OPEN (CS_OPEN) WHENALTRETURN DO; END;
     3595     1962
     3596     1963    3            OR_MESSBUF.FCN = OC_START_EXCLU; /* Give :OCHIST back to KEYIN       */
     3597     1964    4            CALL M$WRITE (WRITE_CS) WHENALTRETURN DO; END;
     3598     1965    3         END;
     3599     1966
     3600     1967    2         IF DCBADDR (DCBNUM (F$TEMPLATE)) -> F$DCB.FCD#
     3601     1968    3         THEN CALL M$CLOSE (CLOSE_OCMSG) WHENALTRETURN DO; END;
     3602     1969
     3603     1970    2         IF DCBADDR (DCBNUM (M$CSCG)) -> F$DCB.FCD#
     3604     1971    3         THEN CALL M$CLOSE (CS_CLOSE) WHENALTRETURN DO; END;
     3605     1972
     3606     1973    3         DO INHIBIT;
     3607     1974    3            OR_IN_XCON = %NO#;
     3608     1975    4            CALL M$XCON (SET_EXIT) WHENALTRETURN DO; END;
     3609     1976    3            CALL M$XXX;
     3610     1977    3         END;
     3611     1978    2      END;
     3612     1979    1   END ORR$XCONRTN;
     3613     1980        %EOD;

PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:545  
--  Include file information  --

   OR_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ORR$XCONRTN.

   Procedure ORR$XCONRTN requires 67 words for executable code.
   Procedure ORR$XCONRTN requires 4 words of local(AUTO) storage.

PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:546  

 Object Unit name= ORR$XCONRTN                                File name= ORR$REPLAY.:E05TOU
 UTS= JUL 30 '97 04:20:27.64 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  F$HISTFILE
    2   DCB   even  none     0      0  F$TEMPLATE
    3   DCB   even  none     0      0  M$CSCG
    4   Data  even  none   214    326  ORR$XCONRTN
    5  RoData even  UTS     12     14  ORR$XCONRTN
    6   Proc  even  none    67    103  ORR$XCONRTN
    7  RoData even  none     1      1  ORR$XCONRTN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes            yes      Std        0  ORR$XCONRTN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:547  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OCHIST_FLAG                           OR_BRK_FLAG
     OR_XCON_FLAG                          OR_BREAKING                           OR_IN_XCON
     F$HISTFILE                            F$TEMPLATE                            M$CSCG

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:548  


     3518        1        /*T***********************************************************/
     3519        2        /*T*                                                         */
     3520        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3521        4        /*T*                                                         */
     3522        5        /*T***********************************************************/
     3523        6        ORR$XCONRTN: PROC;

      6  6 000000   000000 700200 xent  ORR$XCONRTN  TSX0  ! X66_AUTO_0
         6 000001   000004 000000                    ZERO    4,0

     3524        7
     3525        8        %INCLUDE CP_6;
     3526       89        %INCLUDE CP_6_SUBS;
     3527      629        %INCLUDE OC_SUBS_C;
     3528     1360        %INCLUDE OC_MESSHD_C;
     3529     1413        %INCLUDE OR_DAT_R;
     3530     1423        %F$DCB;
     3531     1480    1   DCL F$HISTFILE DCB;
     3532     1481    1   DCL F$TEMPLATE DCB;
     3533     1482    1   DCL M$CSCG DCB;
     3534     1483
     3535     1484        %OC_MESSHD_W (NAME=OR_MESSBUF,
     3536     1485         DELIM=";");
     3537     1498
     3538     1499        %FPT_OPEN (FPTN=CS_OPEN,
     3539     1500         DCB=M$CSCG,
     3540     1501         ASN=COMGROUP,
     3541     1502         SETSTA=KSST,
     3542     1503         FUN=UPDATE,
     3543     1504         SHARE=ALL,
     3544     1505         ACCT=CSACCT,
     3545     1506         NAME=CSCGNM);
     3546     1615
     3547     1616        %FPT_XCON (FPTN=SET_EXIT);
     3548     1630
     3549     1631
PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:549  
     3550     1632        %VLP_NAME (FPTN=CSCGNM,
     3551     1633         NAME='CSCG');
     3552     1660
     3553     1661        %VLP_SETSTA (FPTN=KSST,
     3554     1662         STCLASS=CONSTANT,
     3555     1663         MYSTATION='OREPLAY');
     3556     1691
     3557     1692        %VLP_ACCT (FPTN=CSACCT,
     3558     1693         ACCT=':SYS');
     3559     1706
     3560     1707        %FPT_WRITE (FPTN=WRITE_CS,
     3561     1708         DCB=M$CSCG,
     3562     1709         STATION=STA,
     3563     1710         BP=YES,
     3564     1711         BUF=OR_MESSBUF);
     3565     1742
     3566     1743        %VLP_STATION (FPTN=STA,
     3567     1744         STATION='KEYIN');
     3568     1771
     3569     1772        %FPT_CLOSE (FPTN=CS_CLOSE,
     3570     1773         DCB=M$CSCG);
     3571     1815
     3572     1816
     3573     1817        %FPT_CLOSE (FPTN=CLOSE_HIST,
     3574     1818         DCB=F$HISTFILE);
     3575     1860
     3576     1861        %FPT_CLOSE (FPTN=CLOSE_OCMSG,
     3577     1862         DCB=F$TEMPLATE);
     3578     1904
     3579     1905        %FPT_CLOSE (FPTN=CLOSE_CSCG,
     3580     1906         DCB=M$CSCG);
     3581     1948
     3582     1949    2      DO INHIBIT;

     3583     1950    2         OR_BREAKING = %NO#;

   1950  6 000002   000000 450200 xsym               STZ   ! OR_BREAKING
PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:550  

     3584     1951    2         OR_XCON_FLAG = %NO#;

   1951  6 000003   000000 450200 xsym               STZ   ! OR_XCON_FLAG

     3585     1952    2         OR_IN_XCON = %YES#;

   1952  6 000004   400000 236203                    LDQ   ! -131072,DU
         6 000005   000000 756200 xsym               STQ   ! OR_IN_XCON

     3586     1953    2         OR_BRK_FLAG = %NO#;

   1953  6 000006   000000 450200 xsym               STZ   ! OR_BRK_FLAG

     3587     1954
     3588     1955    2         IF DCBADDR (DCBNUM (F$HISTFILE)) -> F$DCB.FCD#

   1955  6 000007   000000 236207 xsym               LDQ   ! F$HISTFILE,DL
         6 000010   000000 470600 7                  LDP0  ! 0
         6 000011   000000 471700                    LDP1  ! 0,,PR0
         6 000012   100000 473706                    LDP3  ! 0,QL,PR1
         6 000013   300031 236300                    LDQ   ! 25,,PR3
         6 000014   020000 316207                    CANQ  ! 8192,DL
         6 000015   000023 600200 6                  TZE   ! s:1958

     3589     1956    3         THEN CALL M$CLOSE (CLOSE_HIST) WHENALTRETURN DO; END;

   1956  6 000016   000174 630600 4                  EPPR0 ! CLOSE_HIST
         6 000017   450001 713600                    CLIMB ! alt,close
         6 000020   406000 401760                    pmme    nvectors=13
         6 000021   000023 702200 6                  TSX2  ! s:1958
         6 000022   000023 710200 6                  TRA   ! s:1958

     3590     1957
     3591     1958    3         IF OCHIST_FLAG THEN DO;

   1958  6 000023   000000 234200 xsym               SZN   ! OCHIST_FLAG
PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:551  
         6 000024   000042 605200 6                  TPL   ! s:1967

     3592     1959    3            OCHIST_FLAG = %NO#;            /* No use trying this twice!          */

   1959  6 000025   000000 450200 xsym               STZ   ! OCHIST_FLAG

     3593     1960
     3594     1961    4            CALL M$OPEN (CS_OPEN) WHENALTRETURN DO; END;

   1961  6 000026   000006 630600 4                  EPPR0 ! CS_OPEN
         6 000027   450000 713600                    CLIMB ! alt,open
         6 000030   410400 401760                    pmme    nvectors=18
         6 000031   000033 702200 6                  TSX2  ! s:1963
         6 000032   000033 710200 6                  TRA   ! s:1963

     3595     1962
     3596     1963    3            OR_MESSBUF.FCN = OC_START_EXCLU; /* Give :OCHIST back to KEYIN       */

   1963  6 000033   000012 236207                    LDQ   ! 10,DL
         6 000034   000001 552204 4                  STBQ  ! OR_MESSBUF+1,'04'O

     3597     1964    4            CALL M$WRITE (WRITE_CS) WHENALTRETURN DO; END;

   1964  6 000035   000112 630600 4                  EPPR0 ! WRITE_CS
         6 000036   440001 713600                    CLIMB ! alt,write
         6 000037   401400 401760                    pmme    nvectors=4
         6 000040   000042 702200 6                  TSX2  ! s:1967
         6 000041   000042 710200 6                  TRA   ! s:1967

     3598     1965    3         END;

     3599     1966
     3600     1967    2         IF DCBADDR (DCBNUM (F$TEMPLATE)) -> F$DCB.FCD#

   1967  6 000042   000000 236207 xsym               LDQ   ! F$TEMPLATE,DL
         6 000043   000000 470600 7                  LDP0  ! 0
         6 000044   000000 471700                    LDP1  ! 0,,PR0
PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:552  
         6 000045   100000 473706                    LDP3  ! 0,QL,PR1
         6 000046   300031 236300                    LDQ   ! 25,,PR3
         6 000047   020000 316207                    CANQ  ! 8192,DL
         6 000050   000056 600200 6                  TZE   ! s:1970

     3601     1968    3         THEN CALL M$CLOSE (CLOSE_OCMSG) WHENALTRETURN DO; END;

   1968  6 000051   000232 630600 4                  EPPR0 ! CLOSE_OCMSG
         6 000052   450001 713600                    CLIMB ! alt,close
         6 000053   406000 401760                    pmme    nvectors=13
         6 000054   000056 702200 6                  TSX2  ! s:1970
         6 000055   000056 710200 6                  TRA   ! s:1970

     3602     1969
     3603     1970    2         IF DCBADDR (DCBNUM (M$CSCG)) -> F$DCB.FCD#

   1970  6 000056   000000 236207 xsym               LDQ   ! M$CSCG,DL
         6 000057   000000 470600 7                  LDP0  ! 0
         6 000060   000000 471700                    LDP1  ! 0,,PR0
         6 000061   100000 473706                    LDP3  ! 0,QL,PR1
         6 000062   300031 236300                    LDQ   ! 25,,PR3
         6 000063   020000 316207                    CANQ  ! 8192,DL
         6 000064   000072 600200 6                  TZE   ! s:1974

     3604     1971    3         THEN CALL M$CLOSE (CS_CLOSE) WHENALTRETURN DO; END;

   1971  6 000065   000136 630600 4                  EPPR0 ! CS_CLOSE
         6 000066   450001 713600                    CLIMB ! alt,close
         6 000067   406000 401760                    pmme    nvectors=13
         6 000070   000072 702200 6                  TSX2  ! s:1974
         6 000071   000072 710200 6                  TRA   ! s:1974

     3605     1972
     3606     1973    3         DO INHIBIT;

     3607     1974    3            OR_IN_XCON = %NO#;

PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:553  
   1974  6 000072   000000 450200 xsym               STZ   ! OR_IN_XCON

     3608     1975    4            CALL M$XCON (SET_EXIT) WHENALTRETURN DO; END;

   1975  6 000073   000100 630600 4                  EPPR0 ! SET_EXIT
         6 000074   410003 713600                    CLIMB ! alt,+4099
         6 000075   400400 401760                    pmme    nvectors=2
         6 000076   000100 702200 6                  TSX2  ! s:1976
         6 000077   000100 710200 6                  TRA   ! s:1976

     3609     1976    3            CALL M$XXX;

   1976  6 000100   000003 713600                    CLIMB ! 3
         6 000101   000000 401760                    pmme    nvectors=0

     3610     1977    3         END;

     3611     1978    2      END;

     3612     1979    1   END ORR$XCONRTN;

   1979  6 000102   000000 702200 xent               TSX2  ! X66_ARET
     3613     1980        %EOD;

PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:554  
--  Include file information  --

   OR_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ORR$XCONRTN.
PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:555  

 **** Variables and constants ****

  ****  Section 004  Data  ORR$XCONRTN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   270-0-0/d STRC(1080)  r     1 CLOSE_CSCG               174-0-0/d STRC(1080)  r     1 CLOSE_HIST
   232-0-0/d STRC(1080)  r     1 CLOSE_OCMSG              110-0-0/c STRC(72)    r     1 CSACCT
   106-0-0/c STRC(45)    r     1 CSCGNM                   136-0-0/d STRC(1080)  r     1 CS_CLOSE
     6-0-0/d STRC(2088)  r     1 CS_OPEN                    0-0-0/c STRC(180)   r     1 OR_MESSBUF
   100-0-0/d STRC(216)   r     1 SET_EXIT                 126-0-0/w STRC(288)   r     1 STA
   112-0-0/d STRC(432)   r     1 WRITE_CS

  ****  Section 005 RoData ORR$XCONRTN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(432)   r     1 KSST

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c BIT         r     1 OCHIST_FLAG                0-0-0/c BIT         r     1 OR_BREAKING
     0-0-0/c BIT         r     1 OR_BRK_FLAG                0-0-0/c BIT         r     1 OR_IN_XCON
     0-0-0/c BIT         r     1 OR_XCON_FLAG

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 F$HISTFILE
     0-0-0N  NULL        r     1 F$TEMPLATE                 0-0-0N  NULL        r     1 M$CSCG
PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:556  


   Procedure ORR$XCONRTN requires 67 words for executable code.
   Procedure ORR$XCONRTN requires 4 words of local(AUTO) storage.
PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:557  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:558  
          MINI XREF LISTING

CLOSE_CSCG.SN_
      1929**DCL      1929--REDEF
CLOSE_CSCG.UTL_
      1930**DCL      1930--REDEF
CLOSE_CSCG.V
      1934**DCL      1929--DCLINIT
CLOSE_CSCG.V.EXPIRE#
      1944**DCL      1944--REDEF
CLOSE_CSCG.V.TYPE#
      1942**DCL      1942--REDEF
CLOSE_CSCG.V.XTNSIZE#
      1939**DCL      1939--REDEF    1941--REDEF
CLOSE_HIST
      1841**DCL      1956<>CALL
CLOSE_HIST.SN_
      1841**DCL      1841--REDEF
CLOSE_HIST.UTL_
      1842**DCL      1842--REDEF
CLOSE_HIST.V
      1846**DCL      1841--DCLINIT
CLOSE_HIST.V.EXPIRE#
      1856**DCL      1856--REDEF
CLOSE_HIST.V.TYPE#
      1854**DCL      1854--REDEF
CLOSE_HIST.V.XTNSIZE#
      1851**DCL      1851--REDEF    1853--REDEF
CLOSE_OCMSG
      1885**DCL      1968<>CALL
CLOSE_OCMSG.SN_
      1885**DCL      1885--REDEF
CLOSE_OCMSG.UTL_
      1886**DCL      1886--REDEF
PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:559  
CLOSE_OCMSG.V
      1890**DCL      1885--DCLINIT
CLOSE_OCMSG.V.EXPIRE#
      1900**DCL      1900--REDEF
CLOSE_OCMSG.V.TYPE#
      1898**DCL      1898--REDEF
CLOSE_OCMSG.V.XTNSIZE#
      1895**DCL      1895--REDEF    1897--REDEF
CSACCT
      1704**DCL      1576--DCLINIT
CSCGNM
      1658**DCL      1572--DCLINIT
CS_CLOSE
      1796**DCL      1971<>CALL
CS_CLOSE.SN_
      1796**DCL      1796--REDEF
CS_CLOSE.UTL_
      1797**DCL      1797--REDEF
CS_CLOSE.V
      1801**DCL      1796--DCLINIT
CS_CLOSE.V.EXPIRE#
      1811**DCL      1811--REDEF
CS_CLOSE.V.TYPE#
      1809**DCL      1809--REDEF
CS_CLOSE.V.XTNSIZE#
      1806**DCL      1806--REDEF    1808--REDEF
CS_OPEN
      1571**DCL      1961<>CALL
CS_OPEN.ACSVEH_
      1573**DCL      1574--REDEF
CS_OPEN.ALTKEYS_
      1579**DCL      1580--REDEF    1580--REDEF
CS_OPEN.HDR_
      1578**DCL      1579--REDEF
CS_OPEN.TAB_
      1577**DCL      1578--REDEF
PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:560  
CS_OPEN.UHL_
      1571**DCL      1572--REDEF    1572--REDEF
CS_OPEN.V
      1580**DCL      1571--DCLINIT
CS_OPEN.V.FSN#
      1611**DCL      1611--REDEF    1611--REDEF
CS_OPEN.WSN_
      1577**DCL      1577--REDEF
F$DCB.ACTPOS
      1456**DCL      1456--REDEF
F$DCB.ARS#
      1430**DCL      1430--REDEF
F$DCB.ATTR
      1449**DCL      1450--REDEF
F$DCB.BORROW
      1464**DCL      1464--REDEF    1464--REDEF    1464--REDEF
F$DCB.DCBNAME.L
      1478**DCL      1478--IMP-SIZ
F$DCB.EOMCHAR#
      1434**DCL      1434--REDEF
F$DCB.FCD#
      1443**DCL      1955>>IF       1967>>IF       1970>>IF
F$DCB.FLDID
      1459**DCL      1459--REDEF
F$DCB.FORM$
      1453**DCL      1453--REDEF
F$DCB.FSECT
      1469**DCL      1469--REDEF
F$DCB.FSN#
      1446**DCL      1446--REDEF    1446--REDEF    1447--REDEF
F$DCB.HEADER$
      1452**DCL      1452--REDEF
F$DCB.IXTNSIZE#
      1450**DCL      1450--REDEF
F$DCB.LASTSTA$
      1439**DCL      1439--REDEF
PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:561  
F$DCB.LVL
      1465**DCL      1465--REDEF
F$DCB.NAME#.C
      1440**DCL      1440--REDEF
F$DCB.NOEOF
      1462**DCL      1462--REDEF
F$DCB.NRECS#
      1451**DCL      1451--REDEF
F$DCB.NRECX
      1470**DCL      1470--REDEF
F$DCB.OHDR
      1462**DCL      1462--REDEF
F$DCB.ORG#
      1445**DCL      1445--REDEF
F$DCB.PRECNO
      1468**DCL      1468--REDEF
F$DCB.RCSZ
      1474**DCL      1474--REDEF
F$DCB.RES#
      1441**DCL      1441--REDEF
F$DCB.SETX
      1453**DCL      1453--REDEF
F$DCB.TAB$
      1453**DCL      1453--REDEF
F$DCB.TDA
      1467**DCL      1468--REDEF
F$DCB.WSN#
      1441**DCL      1441--REDEF
F$HISTFILE
      1480**DCL      1955--IF
F$TEMPLATE
      1481**DCL      1967--IF
KSST
      1675**DCL      1572--DCLINIT
M$CLOSE
        17**DCL-ENT  1956--CALL     1968--CALL     1971--CALL
PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:562  
M$CSCG
      1482**DCL      1970--IF
M$OPEN
        17**DCL-ENT  1961--CALL
M$WRITE
        18**DCL-ENT  1964--CALL
M$XCON
        72**DCL-ENT  1975--CALL
M$XXX
        29**DCL-ENT  1976--CALL
OCHIST_FLAG
      1421**DCL      1958>>IF       1959<<ASSIGN
OR_BREAKING
      1422**DCL      1950<<ASSIGN
OR_BRK_FLAG
      1421**DCL      1953<<ASSIGN
OR_IN_XCON
      1422**DCL      1952<<ASSIGN   1974<<ASSIGN
OR_MESSBUF
      1486**DCL      1729--DCLINIT  1730--DCLINIT
OR_MESSBUF.FCN
      1492**DCL      1963<<ASSIGN
OR_MESSBUF.FLAGS
      1493**DCL      1494--REDEF
OR_MESSBUF.MSGID
      1489**DCL      1490--REDEF
OR_XCON_FLAG
      1421**DCL      1951<<ASSIGN
SET_EXIT
      1627**DCL      1975<>CALL
SET_EXIT.V
      1628**DCL      1627--DCLINIT
STA
      1756**DCL      1730--DCLINIT
STA.MSGIDXT
      1766**DCL      1769--REDEF
PL6.E3A0      #007=ORR$XCONRTN File=ORR$REPLAY.:E05TSI                           WED 07/30/97 04:20 Page:563  
WRITE_CS
      1728**DCL      1964<>CALL
WRITE_CS.STATION_
      1730**DCL      1730--REDEF
WRITE_CS.V
      1731**DCL      1728--DCLINIT
WRITE_CS.V.DVBYTE.VFC#
      1737**DCL      1737--REDEF

PL6.E3A0      #008=OCW$WRITE File=ORR$REPLAY.:E05TSI                             WED 07/30/97 04:20 Page:564  
     3614        1        /*T***********************************************************/
     3615        2        /*T*                                                         */
     3616        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3617        4        /*T*                                                         */
     3618        5        /*T***********************************************************/
     3619        6
     3620        7        OCW$WRITE: PROC(ONE,TWO,THREE,FOUR,FIVE);
     3621        8    1   DCL TWO UBIN WORD CALIGNED;
     3622        9    1   DCL ONE CHAR(TWO) CALIGNED;
     3623       10    1   DCL THREE BIT(18) CALIGNED;
     3624       11    1   DCL FIVE UBIN HALF CALIGNED;
     3625       12    1   DCL 1 FOUR,
     3626       13    1          2 FIRST_HALF CHAR(4) UNAL,
     3627       14    1          2 SEC_HALF CHAR(4) UNAL;
     3628       15    1      RETURN;
     3629       16    1   END OCW$WRITE;

PL6.E3A0      #008=OCW$WRITE File=ORR$REPLAY.:E05TSI                             WED 07/30/97 04:20 Page:565  
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure OCW$WRITE.

   Procedure OCW$WRITE requires 3 words for executable code.
   Procedure OCW$WRITE requires 8 words of local(AUTO) storage.

    No errors detected in file ORR$REPLAY.:E05TSI    .

PL6.E3A0      #008=OCW$WRITE File=ORR$REPLAY.:E05TSI                             WED 07/30/97 04:20 Page:566  

 Object Unit name= OCW$WRITE                                  File name= ORR$REPLAY.:E05TOU
 UTS= JUL 30 '97 04:20:57.40 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none     3      3  OCW$WRITE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        5  OCW$WRITE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_5
                       nStd      0 X66_ARET
PL6.E3A0      #008=OCW$WRITE File=ORR$REPLAY.:E05TSI                             WED 07/30/97 04:20 Page:567  


     3614        1        /*T***********************************************************/
     3615        2        /*T*                                                         */
     3616        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3617        4        /*T*                                                         */
     3618        5        /*T***********************************************************/
     3619        6
     3620        7        OCW$WRITE: PROC(ONE,TWO,THREE,FOUR,FIVE);

      7  0 000000   000000 700200 xent  OCW$WRITE    TSX0  ! X66_AUTO_5
         0 000001   000010 000005                    ZERO    8,5

     3621        8    1   DCL TWO UBIN WORD CALIGNED;
     3622        9    1   DCL ONE CHAR(TWO) CALIGNED;
     3623       10    1   DCL THREE BIT(18) CALIGNED;
     3624       11    1   DCL FIVE UBIN HALF CALIGNED;
     3625       12    1   DCL 1 FOUR,
     3626       13    1          2 FIRST_HALF CHAR(4) UNAL,
     3627       14    1          2 SEC_HALF CHAR(4) UNAL;
     3628       15    1      RETURN;

     15  0 000002   000000 702200 xent               TSX2  ! X66_ARET
     3629       16    1   END OCW$WRITE;

PL6.E3A0      #008=OCW$WRITE File=ORR$REPLAY.:E05TSI                             WED 07/30/97 04:20 Page:568  
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure OCW$WRITE.
PL6.E3A0      #008=OCW$WRITE File=ORR$REPLAY.:E05TSI                             WED 07/30/97 04:20 Page:569  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     7-0-0/w PTR         r     1 @FIVE                      6-0-0/w PTR         r     1 @FOUR
     3-0-0/w PTR         r     1 @ONE                       5-0-0/w PTR         r     1 @THREE
     4-0-0/w PTR         r     1 @TWO                      *0-0-0/c UBIN(18)    r     1 FIVE
    *0-0-0/c STRC(72)    r     1 FOUR                      *0-0-0/c ACHR        r     1 ONE
    *0-0-0/c BIT (18)    r     1 THREE                     *0-0-0/c UBIN        r     1 TWO


   Procedure OCW$WRITE requires 3 words for executable code.
   Procedure OCW$WRITE requires 8 words of local(AUTO) storage.

    No errors detected in file ORR$REPLAY.:E05TSI    .
PL6.E3A0      #008=OCW$WRITE File=ORR$REPLAY.:E05TSI                             WED 07/30/97 04:20 Page:570  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #008=OCW$WRITE File=ORR$REPLAY.:E05TSI                             WED 07/30/97 04:20 Page:571  
          MINI XREF LISTING

FIVE
        11**DCL         7--PROC
FOUR
        12**DCL         7--PROC
ONE
         9**DCL         7--PROC
THREE
        10**DCL         7--PROC
TWO
         8**DCL         7--PROC        9--IMP-SIZ
