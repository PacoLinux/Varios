VERSION E05

PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:1    
        1        1        /*M*   IRD$DUMP    Recovery Dump Routines      */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0    */
        8        8        IRD$DUMP: PROC;
        9        9
       10       10                                                /*  AUTO                              */
       11       11    1   DCL I UBIN(36);
       12       12    1   DCL J UBIN(36);
       13       13    1   DCL K UBIN(36);
       14       14    1   DCL CINDEX UBIN(36);
       15       15
       16       16    1   DCL CWSQD$ PTR;
       17       17    1   DCL NO_PAGE UBIN(36);
       18       18    1   DCL PGTBL_BAD UBIN(36);
       19       19    1   DCL USER_DUMP UBIN(36);
       20       20    1   DCL BAD_GRAN REMEMBER DALIGNED;
       21       21    1   DCL NO_ROOM REMEMBER DALIGNED;
       22       22    1   DCL TEMP UBIN(18);
       23       23
       24       24        %INCLUDE JS_CP6;
       25      442        %INCLUDE IR_DATA_M;
       26      606        %INCLUDE NI$TABLES;
       27      822        %INCLUDE B_STRINGS_C;
       28      951        %INCLUDE M_INFO_C;
       29     1091        %INCLUDE B$USER;
       30     1307
       31     1308    1   DCL IRR$WDUMP  ENTRY ALTRET;
       32     1309    1   DCL IRR$WWSQD  ENTRY ALTRET;
       33     1310    1   DCL IRR$TYPE6M ENTRY(2);
       34     1311
       35     1312                                                /* CONSTANT DATA                      */
       36     1313    1   DCL RVM_MONJIT CHAR(24) CONSTANT INIT(
       37     1314    1        'RCVR-MON PAGE TABLE BAD');
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:2    
       38     1315    1   DCL RVM_USRJIT CHAR (24) CONSTANT INIT(
       39     1316    1        'RCVR-USER PAGE TABLE BAD');
       40     1317
       41     1318    1   DCL 1 RV_ENTRY SYMREF DALIGNED,
       42     1319    1         2 DA SBIN,
       43     1320    1         2 DTRAP BIT(1) UNAL,
       44     1321    1         2 CFTRAP BIT(1) UNAL,
       45     1322    1         2 BADPT BIT(1) UNAL,
       46     1323    1         2 * BIT(6) UNAL,
       47     1324    1         2 TYP UBIN(9) UNAL,
       48     1325    1         2 SZ UBIN(18) UNAL;
       49     1326
       50     1327    1   DCL R$CU$ PTR SYMREF;
       51     1328
       52     1329    1   DCL RV_BAPAGE SBIN SYMREF;
       53     1330    1   DCL RV_CPNO SBIN SYMREF;
       54     1331    1   DCL RV_CUN SBIN SYMREF;
       55     1332    1   DCL RV_NXTGRAN  SBIN SYMREF;
       56     1333    1   DCL RV_PDUMP  SBIN SYMREF;
       57     1334    1   DCL RV_SCODEA BIT(72) SYMREF DALIGNED;
       58     1335    1   DCL RV_SCPUJIT(0:7) SBIN SYMREF;
       59     1336    1   DCL RV_UNWIND1 REMEMBER SYMREF DALIGNED;
       60     1337    1   DCL RV_USRTYP UBIN(18) SYMREF;
       61     1338    1   DCL RV_WDGRAN SBIN SYMREF;
       62     1339                                                /*   AARDVARK REFS                    */
       63     1340    1   DCL MONPLL SBIN SYMREF;
       64     1341    1   DCL IS_PPUT_SIZE UBIN(36) SYMREF;       /*LAST PAGE ON THIS SYSTEM            */
       65     1342    1   DCL I$JITU$ PTR SYMREF;
       66     1343    1   DCL I$JIT$ PTR SYMREF;
       67     1344    1   DCL I$MEM$ PTR SYMREF;
       68     1345    1   DCL I$MPGTBL$ PTR SYMREF;
       69     1346    1   DCL I$UPGTBL$ PTR SYMREF;
       70     1347    1   DCL B$IPHYMAP$ PTR SYMREF;
       71     1348    1   DCL S1000_FLG BIT(36) ALIGNED SYMREF;
       72     1349    1   DCL RPM_FLG BIT(36) ALIGNED SYMREF;
       73     1350    1   DCL XA_MODE BIT(1) ALIGNED SYMREF;
       74     1351    1   DCL B$HALF(0:0) UBIN(18) HALIGNED BASED;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:3    
       75     1352    1   DCL DOIT BIT(1) ALIGNED;
       76     1353    1   DCL 1 POBUF SYMREF,
       77     1354    1         2 WSQD(0:1023) UBIN(36) UNAL;
       78     1355    1   DCL B$256(0:255) BIT(36) BASED ALIGNED;
       79     1356    1   DCL 1 MEMDESC SYMREF,
       80     1357    1         2 * BIT(36) UNAL,
       81     1358    1         2 BADDR UBIN(36);
       82     1359    1   DCL 1 FPMC SYMREF ALIGNED,
       83     1360    1         2 RPN UBIN(18) UNAL,
       84     1361    1         2 * UBIN(18) UNAL;
       85     1362
       86     1363
       87     1364        %VLP_SCODE (FPTN=SC,STCLASS=AUTO);
       88     1425
       89     1426        %RV_BUFF (STCLASS=SYMREF);
       90     1462        %RV_USRDIR (STCLASS=SYMREF);
       91     1466        %RV_WSQD (STCLASS=SYMREF);
       92     1470        %RV_WSQD (NAME=B$WSQD,STCLASS=BASED);
       93     1474
       94     1475                                                /* BASED STRUCTURES                   */
       95     1476    1   DCL 1 B$DPAGE BASED ALIGNED,
       96     1477    1         2 WSQD(0:1023) UBIN(36) UNAL;
       97     1478
       98     1479    1   DCL 1 B$CWSQD BASED ALIGNED,
       99     1480    1         2 *(0:255) UBIN(36) UNAL;
      100     1481
      101     1482
      102     1483        %EJECT;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:4    
      103     1484        /*********   ******/
      104     1485    1   IRD$DUMPMON: ENTRY;
      105     1486
      106     1487    1   DUMP_AGAIN: ;                           /*UNWIND TO HERE IF BAD GRANULE       */
      107     1488    1      USER_DUMP = 0;
      108     1489    1      REMEMBER DUMP_AGAIN IN BAD_GRAN;
      109     1490    1      REMEMBER MON_MAP_BAD IN NO_ROOM;
      110     1491    1      MEMDESC.BADDR=(RV_SCPUJIT(RV_CPNO)*4096);
      111     1492    1      RV_WSQD = I$MEM$->B$WSQD;
      112     1493    1      RV_ENTRY='0'B;
      113     1494    1      RV_ENTRY.DA = RV_NXTGRAN;
      114     1495    1      SC = RV_SCODEA;
      115     1496
      116     1497                                      /*DETERMINE IF THE MAP FOR THE MONITOR IS OK    */
      117     1498
      118     1499    1      I = %PGTBLLO;
      119     1500    1      CALL IRD$DODUMP    ALTRET(MON_MAP_BAD);
      120     1501    1      GOTO WRMJIT;
      121     1502
      122     1503    1   MON_MAP_BAD: ;                          /*ERROR ON MONITOR PAGE 0             */
      123     1504    1      IF (NO_PAGE ~=0) OR (PGTBL_BAD ~=0)
      124     1505    2      THEN DO;
      125     1506    2           CALL IRR$TYPE6M(RVM_MONJIT,SIZEW(RVM_MONJIT));
      126     1507        /*O*   MESSAGE:   RCVR-MON JIT PAGE BAD
      127     1508               MEANING:   The monitor's page table %PGINMEM bit
      128     1509                          is not set or the physical page does
      129     1510                          not exist for the JIT page.
      130     1511        */
      131     1512    2           RV_ENTRY.BADPT ='1'B;
      132     1513    2           GOTO WRMONENT;
      133     1514    2           END;
      134     1515    1      IF RV_PDUMP ~= 0 THEN RETURN;        /*DUMP AREA EXCEEDED                  */
      135     1516
      136     1517                                           /* Write out Monitor JIT and HJIT pages    */
      137     1518    1   WRMJIT: ;
      138     1519    1      IF RV_BUFF.S_PNO = RV_CPNO
      139     1520    2      THEN DO;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:5    
      140     1521    2           REMEMBER WRMONDIR IN NO_ROOM;
      141     1522    2           REMEMBER WRMONDIR IN RV_UNWIND1;
      142     1523    2           END;
      143     1524    2      ELSE DO;
      144     1525    2           REMEMBER WRMONENT IN NO_ROOM;
      145     1526    2           REMEMBER WRMONENT IN RV_UNWIND1;
      146     1527    2           END;
      147     1528                                 /*IF WE EXCEED DUMP AREA WRITE DIRECTORY AND RETURN  */
      148     1529    2      DO I=%JITPG TO %HJITPG+1;
      149     1530    2           CALL IRD$DODUMP    ALTRET(NXTJITPG);
      150     1531    2   NXTJITPG: ;                             /*SHOULD TYPE ERR MSGS HERE           */
      151     1532    2           END;
      152     1533
      153     1534
      154     1535                                 /*WRITE  WSQ PAGES REQUESTED VIA THE SCREECH CODE    */
      155     1536    1      IF RV_BUFF.S_PNO ~= RV_CPNO          /*IF NOT DUMPING SCREECHING CPU       */
      156     1537    2      THEN DO;
      157     1538    2           I=%ISEGLO;                      /*JUST DUMP DATA PAGE 0               */
      158     1539    2           CALL IRD$DODUMP;
      159     1540    2   WRMONENT: ;
      160     1541    2           RV_BUFF.MONJITS(RV_CPNO) = RV_ENTRY;
      161     1542    2           RV_BUFF.SIZE = RV_BUFF.SIZE + RV_ENTRY.SZ;
      162     1543    2           RETURN;
      163     1544    2           END;
      164     1545
      165     1546
      166     1547        /*  IF DUMPING THE SCREECHING CPU--DUMP THE REST OF THE MONITOR  */
      167     1548        /*  NOTE THAT THESE PAGES MUST BE WRITTEN OUT TO DISK IN THE ORDER THAT
      168     1549            THEY APPEAR IN THE MONITOR'S PAGE TABLE (SORTED BY VIRTUAL PAGE)    */
      169     1550
      170     1551
      171     1552    2      DO I = %ISEGLO-1 TO MONPLL-1;        /*Get SEGTBL too*/
      172     1553    2           CALL IRD$DODUMP;
      173     1554    2           END;
      174     1555
      175     1556    1      IF RPM_FLG
      176     1557    2      THEN DO;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:6    
      177     1558    3           DO I=%IMXLO TO %IMXHI;
      178     1559    3                CALL IRD$DODUMP;
      179     1560    3                END;
      180     1561    2           END;
      181     1562
      182     1563    1      IF SC.PMDATA# = '1'B
      183     1564    2      THEN DO;
      184     1565    3           DO I=%MOUSELO TO %MOUSEHI;
      185     1566    3                CALL IRD$DODUMP;
      186     1567    3                END;
      187     1568    2           END;
      188     1569
      189     1570    1      IF SC.CWSPT#='1'B
      190     1571    2      THEN DO;
      191     1572    3           DO I=%CWSQPTLO TO %CWSQPTHI;
      192     1573    3                CALL IRD$DODUMP;
      193     1574    3                END;
      194     1575    2           END;
      195     1576
      196     1577    2      DO I=%TIGRLO TO %TIGRHI;
      197     1578    2           CALL IRD$DODUMP;
      198     1579    2           END;
      199     1580
      200     1581    1      IF SC.CFUS#   = '1'B
      201     1582    2      THEN DO;
      202     1583    3           DO I=%CFULO TO %CFUHI;
      203     1584    3                CALL IRD$DODUMP;
      204     1585    3                END;
      205     1586    2           END;
      206     1587
      207     1588    1      IF SC.ASAVE#   = '1'B
      208     1589    2      THEN DO;
      209     1590    3           DO I=%DS2LO TO %DS2HI;
      210     1591    3                CALL IRD$DODUMP;
      211     1592    3                END;
      212     1593    2           END;
      213     1594
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:7    
      214     1595    1      IF SC.ENQ#    = '1'B
      215     1596    2      THEN DO;
      216     1597    3           DO I=%ENQLO TO %ENQHI;
      217     1598    3                CALL IRD$DODUMP;
      218     1599    3                END;
      219     1600    2           END;
      220     1601
      221     1602    1      IF SC.DS4#   = '1'B
      222     1603    2      THEN DO;
      223     1604    3           DO I=%DS4LO TO %DS4HI;
      224     1605    3                CALL IRD$DODUMP;
      225     1606    3                END;
      226     1607    2           END;
      227     1608
      228     1609    1      IF SC.DS5#   = '1'B
      229     1610    2      THEN DO;
      230     1611    3           DO I=%DS5LO TO %DS5HI;
      231     1612    3                CALL IRD$DODUMP;
      232     1613    3                END;
      233     1614    2           END;
      234     1615
      235     1616    1      IF SC.DS6#   = '1'B
      236     1617    2      THEN DO;
      237     1618    3           DO I=%DS6LO TO %DS6HI;
      238     1619    3                CALL IRD$DODUMP;
      239     1620    3                END;
      240     1621    2           END;
      241     1622
      242     1623    1      IF SC.DS7#   = '1'B
      243     1624    2      THEN DO;
      244     1625    3           DO I=%DS7LO TO %DS7HI;
      245     1626    3                CALL IRD$DODUMP;
      246     1627    3                END;
      247     1628    2           END;
      248     1629
      249     1630    1      IF SC.LDCTS# = '1'B
      250     1631    2      THEN DO;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:8    
      251     1632    3           DO I=%LDCTLO TO %LDCTHI;
      252     1633    3                CALL IRD$DODUMP;
      253     1634    3                END;
      254     1635    2           END;
      255     1636        %EJECT;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:9    
      256     1637
      257     1638    1   WRMONDIR: ;
      258     1639                                 /* REWRITE THE PG TABLE WITH THE %SCRCVR FLAGS SET   */
      259     1640    1      POBUF.WSQD = RV_WSQD;
      260     1641    1      RV_WDGRAN = RV_ENTRY.DA;
      261     1642    1      CALL IRR$WWSQD  ALTRET(ZAPMDIR);
      262     1643
      263     1644    1      RV_BUFF.MONWSQD = RV_ENTRY;
      264     1645    1      RV_BUFF.SIZE = RV_BUFF.SIZE + RV_ENTRY.SZ;
      265     1646    1   ZAPMDIR: ;
      266     1647
      267     1648        %EJECT;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:10   
      268     1649
      269     1650
      270     1651    1      IF SC.CWSPT#='1'B
      271     1652    2      THEN DO;
      272     1653    2           REMEMBER GIVEUP_CWSQ IN RV_UNWIND1;
      273     1654    2           REMEMBER GIVEUP_CWSQ IN NO_ROOM;
      274     1655    2           REMEMBER REDUMP_CWSQ IN BAD_GRAN;
      275     1656
      276     1657    2           CINDEX=0;
      277     1658    3           DO K=%CWSQPTLO TO %CWSQPTHI;
      278     1659    3                DOIT='0'B;
      279     1660    3                IF S1000_FLG THEN          /* HW_WSQ0PT                          */
      280     1661    3                     IF ( (I$MPGTBL$->B$WSQD.PG.RPN(K) ~=FPMC.RPN)
      281     1662    3                       AND (B$IPHYMAP$->B$HALF(I$MPGTBL$->B$WSQD.PG.RPN(K)) <
              1662                                IS_PPUT_SIZE)
      282     1663    3                       AND (B$IPHYMAP$->B$HALF(I$MPGTBL$->B$WSQD.PG.RPN(K)) >3) ) THEN
              1663                                DOIT='1'B;ELSE;
      283     1664    3                ELSE
      284     1665    3                     IF ( (I$MPGTBL$->B$WSQD.PG.RPN(K) ~=FPMC.RPN)
      285     1666    3                       AND (I$MPGTBL$->B$WSQD.PG.RPN(K) < IS_PPUT_SIZE)
      286     1667    3                       AND (I$MPGTBL$->B$WSQD.PG.RPN(K) >3) ) THEN DOIT='1'B;
      287     1668    3                IF (DOIT)
      288     1669    4                THEN DO;
      289     1670    4   REDUMP_CWSQ:      ;
      290     1671    4                     CWSQD$=I$MEM$;
      291     1672    5                     DO J=0 TO 3;
      292     1673
      293     1674    5                          RV_ENTRY='0'B;
      294     1675    5                          RV_ENTRY.DA = RV_NXTGRAN;
      295     1676    5                          RV_ENTRY.SZ=1;   /*RESERVE DIRECTORY GRAN              */
      296     1677    5                          RV_NXTGRAN=RV_NXTGRAN+1;
      297     1678    5                          IF S1000_FLG THEN /* HW_WSQ0PT                         */
      298     1679    5                               MEMDESC.BADDR = (B$IPHYMAP$->B$HALF(I$MPGTBL$->B$WSQD.PG
              1679                                        .RPN(K))*4096);
      299     1680    5                          ELSE
      300     1681    5                               MEMDESC.BADDR = (I$MPGTBL$->B$WSQD.PG.RPN(K)*4096);
      301     1682    5                          RV_WSQD='0'B;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:11   
      302     1683    5                          RV_WSQD = CWSQD$->B$CWSQD;
      303     1684    6                          DO I=0 TO 255;
      304     1685    6                               CALL IRD$DODUMP;
      305     1686    6                               END;
      306     1687    5   GIVEUP_CWSQ:           ;
      307     1688    5                          POBUF='0'B;
      308     1689    5                          ADDR(POBUF.WSQD(J*256))->B$256=RV_WSQD;
      309     1690    5                          RV_WDGRAN=RV_ENTRY.DA;
      310     1691    5                          CALL IRR$WWSQD ALTRET(ZAP_WSQD);
      311     1692    5                          RV_BUFF.CWSQ(CINDEX)=RV_ENTRY;
      312     1693    5                          RV_BUFF.SIZE = RV_BUFF.SIZE+RV_ENTRY.SZ;
      313     1694    5   ZAP_WSQD:              ;
      314     1695    5                          CINDEX=CINDEX+1;
      315     1696    5                          CWSQD$ = PINCRW(CWSQD$,256);
      316     1697    5                          END;             /*DO J=0 TO 3                         */
      317     1698    4                     END;                  /* DO IF THERE IS A PAGE*/
      318     1699    3                ELSE CINDEX=CINDEX+4;
      319     1700    3                END;                       /*DO K=CWSPTLO TO %CWSQPTHI           */
      320     1701
      321     1702
      322     1703    2           END;                            /*DO IF CWSPT#*/
      323     1704
      324     1705        %EJECT;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:12   
      325     1706
      326     1707
      327     1708    1      IF SC.CGDATA#='1'B
      328     1709    2      THEN DO;
      329     1710    2           REMEMBER GIVEUP_CGDATA IN RV_UNWIND1;
      330     1711    2           REMEMBER GIVEUP_CGDATA IN NO_ROOM;
      331     1712    2           REMEMBER REDUMP_CGDATA IN BAD_GRAN;
      332     1713
      333     1714    2           J=0;
      334     1715    3           DO K=%CGPGTBLLO TO %PGTBLHI;
      335     1716                                                /* DO K=1 TO 10                       */
      336     1717    3                DOIT='0'B;
      337     1718    3                IF S1000_FLG THEN          /* HW_WSQ0PT                          */
      338     1719    3                     IF ( (I$MPGTBL$->B$WSQD.PG.RPN(K) ~=FPMC.RPN)
      339     1720    3                       AND (B$IPHYMAP$->B$HALF(I$MPGTBL$->B$WSQD.PG.RPN(K)) <
              1720                                IS_PPUT_SIZE)
      340     1721    3                       AND (B$IPHYMAP$->B$HALF(I$MPGTBL$->B$WSQD.PG.RPN(K)) >3) ) THEN
              1721                                DOIT='1'B;ELSE;
      341     1722    3                ELSE
      342     1723    3                     IF ( (I$MPGTBL$->B$WSQD.PG.RPN(K) ~=FPMC.RPN)
      343     1724    3                       AND (I$MPGTBL$->B$WSQD.PG.RPN(K) < IS_PPUT_SIZE)
      344     1725    3                       AND (I$MPGTBL$->B$WSQD.PG.RPN(K) >3) ) THEN DOIT='1'B;
      345     1726    3                IF (DOIT)
      346     1727    4                THEN DO;
      347     1728    4   REDUMP_CGDATA:    ;
      348     1729
      349     1730    4                     RV_ENTRY='0'B;
      350     1731    4                     RV_ENTRY.DA = RV_NXTGRAN;
      351     1732    4                     RV_ENTRY.SZ=1;        /*RESERVE DIRECTORY GRAN              */
      352     1733    4                     RV_NXTGRAN=RV_NXTGRAN+1;
      353     1734
      354     1735    4                     IF S1000_FLG THEN     /* HW_WSQ0PT                          */
      355     1736    4                          MEMDESC.BADDR = (B$IPHYMAP$->B$HALF(I$MPGTBL$->B$WSQD.PG.RPN(
              1736                                   K))*4096);
      356     1737    4                     ELSE
      357     1738    4                          MEMDESC.BADDR = (I$MPGTBL$->B$WSQD.PG.RPN(K) * 4096);
      358     1739    4                     RV_WSQD = I$MEM$->B$WSQD;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:13   
      359     1740
      360     1741
      361     1742    5                     DO I=0 TO 1023;
      362     1743    5                          IF (J*1024)+I >= RV_BUFF.MM_CGQCXT_END
      363     1744    5                          THEN GOTO GIVEUP_CGDATA;
      364     1745
      365     1746    5                          IF K=%CGPGTBLLO AND I<2 THEN GOTO SKIP_1_2;
      366     1747    5                          CALL IRD$DODUMP;
      367     1748    5   SKIP_1_2:              ;
      368     1749    5                          END;
      369     1750    4   GIVEUP_CGDATA:    ;
      370     1751    4                     POBUF.WSQD=RV_WSQD;
      371     1752    4                     RV_WDGRAN=RV_ENTRY.DA;
      372     1753    4                     CALL IRR$WWSQD ALTRET(ZAP_CGDATA);
      373     1754    4                     RV_BUFF.CGRWSQ(J)=RV_ENTRY;
      374     1755    4                     RV_BUFF.SIZE = RV_BUFF.SIZE+RV_ENTRY.SZ;
      375     1756    4   ZAP_CGDATA:       ;
      376     1757    4                     END;                  /* DO IF THERE IS A PAGE*/
      377     1758    3                J=J+1;
      378     1759    3                END;                       /*DO K=CGPGPTLO TO %CGPGQPTHI         */
      379     1760
      380     1761
      381     1762    2           END;                            /*DO IF CGDATA#*/
      382     1763
      383     1764    1      RETURN;
      384     1765        %EJECT;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:14   
      385     1766
      386     1767
      387     1768
      388     1769
      389     1770    1   IRD$DUMPUSR: ENTRY;
      390     1771
      391     1772    1      IF RV_USRDIR.USER.SZ(RV_CUN) ~= 0 THEN RETURN;
      392     1773                                      /* THIS USER HAS BEEN DUMPED ON AN EARLIER PASS */
      393     1774
      394     1775    1   START_OVER: ;                           /*UNWIND TO HERE IF BAD GRANULE       */
      395     1776    1      USER_DUMP = 1;
      396     1777    1      REMEMBER START_OVER IN BAD_GRAN;
      397     1778    1      REMEMBER NOPAGES IN NO_ROOM;
      398     1779    1      RV_ENTRY='0'B;
      399     1780    1      RV_ENTRY.DA = RV_NXTGRAN;
      400     1781    1      SC = RV_SCODEA;
      401     1782    1      RV_WSQD = I$UPGTBL$->B$DPAGE.WSQD;
      402     1783
      403     1784                                           /*DETERMINE IF THE MAP FOR THIS USER IS OK */
      404     1785
      405     1786    1      I = %PGTBLLO;
      406     1787    1      CALL IRD$DODUMP    ALTRET(NOPAGES);
      407     1788    1      GOTO WRLVA;
      408     1789
      409     1790    1   NOPAGES: ;                              /*ERROR ON USER PAGE 0                */
      410     1791    1      IF RV_PDUMP ~= 0 THEN RETURN;        /*DUMP AREA EXCEEDED                  */
      411     1792    1      IF (NO_PAGE ~=0) OR (PGTBL_BAD ~=0)
      412     1793    2      THEN DO;
      413     1794    2           CALL IRR$TYPE6M(RVM_USRJIT,SIZEW(RVM_USRJIT));
      414     1795
      415     1796    2           RV_USRDIR.USER.PGTBL(RV_CUN) = '1'B;
      416     1797        /*O*   MESSAGE:   RCVR-USER PAGE TABLE BAD
      417     1798               MEANING:   The user's page table %PGINMEM bit
      418     1799                          is not set or the physical page does
      419     1800                          not exist for the JIT page.
      420     1801        */
      421     1802    2           IF XA_MODE THEN                 /* HW_WSQ0PT & (HW_PTB_UNITS=1000)    */
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:15   
      422     1803    2                RV_BAPAGE = (B$IPHYMAP$->B$HALF(R$CU$->B$U.PT)*256*64);
      423     1804    2           ELSE IF S1000_FLG THEN          /* HW_WSQ0PT                          */
      424     1805    2                     RV_BAPAGE = (B$IPHYMAP$->B$HALF(R$CU$->B$U.PT)*256);
      425     1806    2                ELSE
      426     1807    2                     RV_BAPAGE = (R$CU$->B$U.PT * 256);
      427     1808    2           CALL IRR$WDUMP ALTRET(ZAPDIR);
      428     1809    2           RV_ENTRY.SZ=1;
      429     1810    2           GOTO SET_USRDIR;
      430     1811    2           END;
      431     1812
      432     1813    1   WRLVA: ;
      433     1814    1      REMEMBER WRDIR IN NO_ROOM;
      434     1815    1      REMEMBER WRDIR IN RV_UNWIND1;
      435     1816                                 /*IF WE EXCEED DUMP AREA WRITE DIRECTORY AND RETURN  */
      436     1817    2      DO I=%PGTBLLO+1 TO %PGTBLHI;
      437     1818    2           CALL IRD$DODUMP ALTRET(NXTPGTBL);
      438     1819    2   NXTPGTBL: ;
      439     1820    2           END;
      440     1821
      441     1822    2      DO I=%JITPG TO %HJITPG;
      442     1823    2           CALL IRD$DODUMP    ALTRET(NEXTJIT);
      443     1824    2   NEXTJIT: ;                              /*SHOULD TYPE ERR MSGS HERE           */
      444     1825    2           END;
      445     1826
      446     1827
      447     1828
      448     1829                                      /*WRITE PAGES REQUESTED VIA THE SCREECH CODE    */
      449     1830
      450     1831    1      IF SC.FMBUF# = '1'B
      451     1832    2      THEN DO;
      452     1833    3           DO I=%FMSEGLO TO %FMSEGHI;
      453     1834    3                CALL IRD$DODUMP;
      454     1835    3                END;
      455     1836    2           END;
      456     1837
      457     1838    1      IF SC.ROSEG# = '1'B
      458     1839    2      THEN DO;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:16   
      459     1840    3           DO I=%ROSEGLO TO %ROSEGHI;
      460     1841    3                CALL IRD$DODUMP;
      461     1842    3                END;
      462     1843    2           END;
      463     1844
      464     1845    1      IF SC.ISEG# = '1'B
      465     1846    2      THEN DO;
      466     1847    3           DO I=%ISEGLO TO %ISEGHI;
      467     1848    3                CALL IRD$DODUMP;
      468     1849    3                END;
      469     1850    2           END;
      470     1851
      471     1852    1      IF SC.SPBUF# = '1'B
      472     1853    2      THEN DO;
      473     1854    3           DO I=%SBUF2PG TO %SBUF1PG;
      474     1855    3                CALL IRD$DODUMP;
      475     1856    3                END;
      476     1857    2           END;
      477     1858
      478     1859    1      IF SC.DBSEG# = '1'B
      479     1860    2      THEN DO;
      480     1861    3           DO I=%DBDSEGLO TO %DBDSEGHI;
      481     1862    3                CALL IRD$DODUMP;
      482     1863    3                END;
      483     1864    2           END;
      484     1865
      485     1866    1      IF SC.ASLSEG# = '1'B
      486     1867    2      THEN DO;
      487     1868    3           DO I=%ASLSEGLO TO %ASLSEGHI;
      488     1869    3                CALL IRD$DODUMP;
      489     1870    3                END;
      490     1871    2           END;
      491     1872
      492     1873    1      IF SC.CPSEG# = '1'B
      493     1874    2      THEN DO;
      494     1875    3           DO I=%CPDSEGLO TO %CPDSEGHI;
      495     1876    3                CALL IRD$DODUMP;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:17   
      496     1877    3                END;
      497     1878    2           END;
      498     1879
      499     1880    2      DO I=%VSPGTBLLO TO %VSPGTBLHI;
      500     1881    2           CALL IRD$DODUMP    ALTRET(NEXTVSPGTBL);
      501     1882    2   NEXTVSPGTBL:                       /*DOESN'T MATTER, SINCE MIGHT NOT BE ANY*/
      502     1883    2           END;
      503     1884    1      IF SC.DDSEG# = '1'B
      504     1885    2      THEN DO;
      505     1886    3           DO I=%UDSEGLO TO 1023;          /*%UDSEGHI needs more PT in buffer*/
      506     1887    3                CALL IRD$DODUMP;
      507     1888    3                END;
      508     1889    2           END;
      509     1890
      510     1891    1   WRDIR: ;
      511     1892                                 /* REWRITE THE PG TABLE WITH THE %SCRCVR FLAGS SET   */
      512     1893    1      POBUF.WSQD = RV_WSQD;
      513     1894    1      RV_WDGRAN = RV_ENTRY.DA;
      514     1895    1      CALL IRR$WWSQD  ALTRET(ZAPDIR);
      515     1896
      516     1897    1   SET_USRDIR: ;
      517     1898    1      RV_USRDIR.USER(RV_CUN) = RV_ENTRY;
      518     1899    1      RV_USRDIR.USER.TYP(RV_CUN) = RV_USRTYP;
      519     1900    1      RV_BUFF.SIZE = RV_BUFF.SIZE + RV_ENTRY.SZ;
      520     1901    1   ZAPDIR: ;
      521     1902    1      RETURN;
      522     1903
      523     1904
      524     1905
      525     1906        %EJECT;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:18   
      526     1907        /*F*   NAME:  IRD$DUMPMP
      527     1908               PURPOSE:  To dump the Monitor Procedure
      528     1909        */
      529     1910    1   IRD$DUMPMP: ENTRY;
      530     1911    1      SC=RV_SCODEA;
      531     1912    1      REMEMBER SO_WHAT IN RV_UNWIND1;
      532     1913
      533     1914    1   DUMP_MPROC: ;
      534     1915    1      REMEMBER DUMP_MPROC IN BAD_GRAN;
      535     1916    1      REMEMBER SO_WHAT IN NO_ROOM;
      536     1917    1      RV_WSQD = I$MPGTBL$->B$DPAGE.WSQD;
      537     1918    1      RV_ENTRY='0'B;
      538     1919    1      RV_ENTRY.DA = RV_NXTGRAN;
      539     1920    1      IF (SC.MPROC#)
      540     1921    2      THEN DO;
      541     1922    3           DO I=MONPLL TO %ISEGHI;
      542     1923    3                CALL IRD$DODUMP;
      543     1924    3                END;
      544     1925    2           END;
      545     1926    2      ELSE DO;
      546     1927    2           I=(RV_BUFF.SSFRAME.IC/1024)+%ISEGLO;
      547     1928    2           CALL IRD$DODUMP;
      548     1929    2           END;
      549     1930
      550     1931    1   SO_WHAT: ;
      551     1932    1      RV_BUFF.MONPROC = RV_ENTRY;
      552     1933    1      RV_BUFF.SIZE = RV_BUFF.SIZE + RV_ENTRY.SZ;
      553     1934    1      RETURN;
      554     1935
      555     1936
      556     1937        %EJECT;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:19   
      557     1938        /*I*   NAME:  IRD$DODUMP
      558     1939               PURPOSE:  To build the DCW and call IRR$WDUMP for
      559     1940                         each page that is to be written to any
      560     1941                         section of the dump area.
      561     1942        */
      562     1943
      563     1944    1   IRD$DODUMP: PROC ALTRET;
      564     1945
      565     1946    2      NO_PAGE = 0;
      566     1947    2      PGTBL_BAD = 0;
      567     1948
      568     1949    2      IF (RV_WSQD.PG.RPN(I)=FPMC.RPN)
      569     1950    3      THEN DO;
      570     1951    3           NO_PAGE = 1;
      571     1952    3           ALTRETURN;
      572     1953    3           END;
      573     1954    2      DOIT = '0'B;
      574     1955    2      IF S1000_FLG THEN                    /* HW_WSQ0PT                          */
      575     1956    2           IF ((B$IPHYMAP$->B$HALF(RV_WSQD.PG.RPN(I))<=3) OR (B$IPHYMAP$->B$HALF(
              1956                    RV_WSQD.PG.RPN(I))>IS_PPUT_SIZE) ) THEN DOIT = '1'B;ELSE;
      576     1957    2      ELSE
      577     1958    2           IF (RV_WSQD.PG.RPN(I)<=3 OR RV_WSQD.PG.RPN(I)>IS_PPUT_SIZE) THEN DOIT='1'B;
      578     1959    2      IF ( DOIT )
      579     1960    3      THEN DO;
      580     1961    3           PGTBL_BAD = 1;
      581     1962    3           ALTRETURN;
      582     1963    3           END;
      583     1964    2      IF (RV_WSQD.PG.SFLG(I) & %SCCVM)
      584     1965    2      THEN GOTO DUMP_CVM;
      585     1966    2      IF USER_DUMP ~= 0
      586     1967    2      THEN IF ( (RV_WSQD.PG.SFLG(I) & (%SCUSER | %SCFPOOL)) = '0'B)
      587     1968    2           THEN ALTRETURN;                 /*DONT DUMP SHARED PROC PAGES         */
      588     1969
      589     1970    2   DUMP_CVM: ;
      590     1971    2      IF S1000_FLG THEN                    /* HW_WSQ0PT                          */
      591     1972    2           RV_BAPAGE = (B$IPHYMAP$->B$HALF(RV_WSQD.PG.RPN(I)) * 4096);
      592     1973    2      ELSE
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:20   
      593     1974    2           RV_BAPAGE = (RV_WSQD.PG.RPN(I) * 4096);
      594     1975    2      CALL IRR$WDUMP  ALTRET(DODUMP_ALT);
      595     1976    2      RV_ENTRY.SZ = RV_ENTRY.SZ+1;
      596     1977    2      RV_WSQD.PG.SFLG(I) = (RV_WSQD.PG.SFLG(I) | %SCRCVR);
      597     1978    2      RETURN;
      598     1979    2   DODUMP_ALT: ;
      599     1980    2      IF RV_PDUMP ~= 0 THEN UNWIND TO NO_ROOM;
      600     1981                                                /* DUMP AREA EXCEEDED                 */
      601     1982    2      ELSE UNWIND TO BAD_GRAN;
      602     1983    2   END IRD$DODUMP;
      603     1984
      604     1985
      605     1986
      606     1987    1   END IRD$DUMP;
      607     1988        %EOD;

PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:21   
--  Include file information  --

   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   M_INFO_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   IR_DATA_M.:E05TOU  is referenced.
   JS_CP6.:E05TOU  is referenced.
      No diagnostics issued in procedure IRD$DUMP.

   Procedure IRD$DUMP requires 943 words for executable code.
   Procedure IRD$DUMP requires 24 words of local(AUTO) storage.

PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:22   

 Object Unit name= IRD$DUMP                                   File name= IRD$DUMP.:E05TOU
 UTS= JUL 29 '97 22:42:43.64 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     12     14  IRD$DUMP
    1   Proc  even  none   943   1657  IRD$DUMP
    2  RoData even  none     6      6  IRD$DUMP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        0  IRD$DUMP
     1      3                  yes      Std        0  IRD$DUMPMON
     1   1044                  yes      Std        0  IRD$DUMPUSR
     1   1423                  yes      Std        0  IRD$DUMPMP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 IRR$WDUMP
         yes           Std       2 IRR$TYPE6M
 yes     yes           Std       0 IRR$WWSQD
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AUNWIND
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:23   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     RV_ENTRY                              R$CU$                                 RV_BAPAGE
     RV_CPNO                               RV_CUN                                RV_NXTGRAN
     RV_PDUMP                              RV_SCODEA                             RV_SCPUJIT
     RV_UNWIND1                            RV_USRTYP                             RV_WDGRAN
     MONPLL                                IS_PPUT_SIZE                          I$MEM$
     I$MPGTBL$                             I$UPGTBL$                             B$IPHYMAP$
     S1000_FLG                             RPM_FLG                               XA_MODE
     POBUF                                 MEMDESC                               FPMC
     RV_BUFF                               RV_USRDIR                             RV_WSQD
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:24   


        1        1        /*M*   IRD$DUMP    Recovery Dump Routines      */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0    */
        8        8        IRD$DUMP: PROC;

      8  1 000000   000000 700200 xent  IRD$DUMP     TSX0  ! X66_AUTO_0
         1 000001   000030 000000                    ZERO    24,0
         1 000002   000005 710000 1                  TRA     DUMP_AGAIN

        9        9
       10       10                                                /*  AUTO                              */
       11       11    1   DCL I UBIN(36);
       12       12    1   DCL J UBIN(36);
       13       13    1   DCL K UBIN(36);
       14       14    1   DCL CINDEX UBIN(36);
       15       15
       16       16    1   DCL CWSQD$ PTR;
       17       17    1   DCL NO_PAGE UBIN(36);
       18       18    1   DCL PGTBL_BAD UBIN(36);
       19       19    1   DCL USER_DUMP UBIN(36);
       20       20    1   DCL BAD_GRAN REMEMBER DALIGNED;
       21       21    1   DCL NO_ROOM REMEMBER DALIGNED;
       22       22    1   DCL TEMP UBIN(18);
       23       23
       24       24        %INCLUDE JS_CP6;
       25      442        %INCLUDE IR_DATA_M;
       26      606        %INCLUDE NI$TABLES;
       27      822        %INCLUDE B_STRINGS_C;
       28      951        %INCLUDE M_INFO_C;
       29     1091        %INCLUDE B$USER;
       30     1307
       31     1308    1   DCL IRR$WDUMP  ENTRY ALTRET;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:25   
       32     1309    1   DCL IRR$WWSQD  ENTRY ALTRET;
       33     1310    1   DCL IRR$TYPE6M ENTRY(2);
       34     1311
       35     1312                                                /* CONSTANT DATA                      */
       36     1313    1   DCL RVM_MONJIT CHAR(24) CONSTANT INIT(
       37     1314    1        'RCVR-MON PAGE TABLE BAD');
       38     1315    1   DCL RVM_USRJIT CHAR (24) CONSTANT INIT(
       39     1316    1        'RCVR-USER PAGE TABLE BAD');
       40     1317
       41     1318    1   DCL 1 RV_ENTRY SYMREF DALIGNED,
       42     1319    1         2 DA SBIN,
       43     1320    1         2 DTRAP BIT(1) UNAL,
       44     1321    1         2 CFTRAP BIT(1) UNAL,
       45     1322    1         2 BADPT BIT(1) UNAL,
       46     1323    1         2 * BIT(6) UNAL,
       47     1324    1         2 TYP UBIN(9) UNAL,
       48     1325    1         2 SZ UBIN(18) UNAL;
       49     1326
       50     1327    1   DCL R$CU$ PTR SYMREF;
       51     1328
       52     1329    1   DCL RV_BAPAGE SBIN SYMREF;
       53     1330    1   DCL RV_CPNO SBIN SYMREF;
       54     1331    1   DCL RV_CUN SBIN SYMREF;
       55     1332    1   DCL RV_NXTGRAN  SBIN SYMREF;
       56     1333    1   DCL RV_PDUMP  SBIN SYMREF;
       57     1334    1   DCL RV_SCODEA BIT(72) SYMREF DALIGNED;
       58     1335    1   DCL RV_SCPUJIT(0:7) SBIN SYMREF;
       59     1336    1   DCL RV_UNWIND1 REMEMBER SYMREF DALIGNED;
       60     1337    1   DCL RV_USRTYP UBIN(18) SYMREF;
       61     1338    1   DCL RV_WDGRAN SBIN SYMREF;
       62     1339                                                /*   AARDVARK REFS                    */
       63     1340    1   DCL MONPLL SBIN SYMREF;
       64     1341    1   DCL IS_PPUT_SIZE UBIN(36) SYMREF;       /*LAST PAGE ON THIS SYSTEM            */
       65     1342    1   DCL I$JITU$ PTR SYMREF;
       66     1343    1   DCL I$JIT$ PTR SYMREF;
       67     1344    1   DCL I$MEM$ PTR SYMREF;
       68     1345    1   DCL I$MPGTBL$ PTR SYMREF;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:26   
       69     1346    1   DCL I$UPGTBL$ PTR SYMREF;
       70     1347    1   DCL B$IPHYMAP$ PTR SYMREF;
       71     1348    1   DCL S1000_FLG BIT(36) ALIGNED SYMREF;
       72     1349    1   DCL RPM_FLG BIT(36) ALIGNED SYMREF;
       73     1350    1   DCL XA_MODE BIT(1) ALIGNED SYMREF;
       74     1351    1   DCL B$HALF(0:0) UBIN(18) HALIGNED BASED;
       75     1352    1   DCL DOIT BIT(1) ALIGNED;
       76     1353    1   DCL 1 POBUF SYMREF,
       77     1354    1         2 WSQD(0:1023) UBIN(36) UNAL;
       78     1355    1   DCL B$256(0:255) BIT(36) BASED ALIGNED;
       79     1356    1   DCL 1 MEMDESC SYMREF,
       80     1357    1         2 * BIT(36) UNAL,
       81     1358    1         2 BADDR UBIN(36);
       82     1359    1   DCL 1 FPMC SYMREF ALIGNED,
       83     1360    1         2 RPN UBIN(18) UNAL,
       84     1361    1         2 * UBIN(18) UNAL;
       85     1362
       86     1363
       87     1364        %VLP_SCODE (FPTN=SC,STCLASS=AUTO);
       88     1425
       89     1426        %RV_BUFF (STCLASS=SYMREF);
       90     1462        %RV_USRDIR (STCLASS=SYMREF);
       91     1466        %RV_WSQD (STCLASS=SYMREF);
       92     1470        %RV_WSQD (NAME=B$WSQD,STCLASS=BASED);
       93     1474
       94     1475                                                /* BASED STRUCTURES                   */
       95     1476    1   DCL 1 B$DPAGE BASED ALIGNED,
       96     1477    1         2 WSQD(0:1023) UBIN(36) UNAL;
       97     1478
       98     1479    1   DCL 1 B$CWSQD BASED ALIGNED,
       99     1480    1         2 *(0:255) UBIN(36) UNAL;
      100     1481
      101     1482
      102     1483        %EJECT;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:27   
      103     1484        /*********   ******/
      104     1485    1   IRD$DUMPMON: ENTRY;

   1485  1 000003   000000 700200 xent  IRD$DUMPMON  TSX0  ! X66_AUTO_0
         1 000004   000030 000000                    ZERO    24,0

   1480  1 000005                       DUMP_AGAIN   null
      105     1486
      106     1487    1   DUMP_AGAIN: ;                           /*UNWIND TO HERE IF BAD GRANULE       */
      107     1488    1      USER_DUMP = 0;

   1488  1 000005   200012 450100                    STZ     USER_DUMP,,AUTO

      108     1489    1      REMEMBER DUMP_AGAIN IN BAD_GRAN;

   1489  1 000006   000005 635000 1                  EAA     DUMP_AGAIN
         1 000007   200014 452500                    STP2    BAD_GRAN,,AUTO
         1 000010   200015 755100                    STA     BAD_GRAN+1,,AUTO

      109     1490    1      REMEMBER MON_MAP_BAD IN NO_ROOM;

   1490  1 000011   000040 635000 1                  EAA     MON_MAP_BAD
         1 000012   200016 452500                    STP2    NO_ROOM,,AUTO
         1 000013   200017 755100                    STA     NO_ROOM+1,,AUTO

      110     1491    1      MEMDESC.BADDR=(RV_SCPUJIT(RV_CPNO)*4096);

   1491  1 000014   000000 720000 xsym               LXL0    RV_CPNO
         1 000015   000000 235010 xsym               LDA     RV_SCPUJIT,X0
         1 000016   000014 735000                    ALS     12
         1 000017   000001 755000 xsym               STA     MEMDESC+1

      111     1492    1      RV_WSQD = I$MEM$->B$WSQD;

   1492  1 000020   000000 470400 xsym               LDP0    I$MEM$
         1 000021   010000 221003                    LDX1    4096,DU
         1 000022   000040 100540                    MLR     fill='000'O
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:28   
         1 000023   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
         1 000024   000000 000011 xsym               ADSC9   RV_WSQD                  cn=0,n=*X1

      112     1493    1      RV_ENTRY='0'B;

   1493  1 000025   000000 235003                    LDA     0,DU
         1 000026   000000 236003                    LDQ     0,DU
         1 000027   000000 757000 xsym               STAQ    RV_ENTRY

      113     1494    1      RV_ENTRY.DA = RV_NXTGRAN;

   1494  1 000030   000000 235000 xsym               LDA     RV_NXTGRAN
         1 000031   000000 755000 xsym               STA     RV_ENTRY

      114     1495    1      SC = RV_SCODEA;

   1495  1 000032   000000 237000 xsym               LDAQ    RV_SCODEA
         1 000033   200022 757100                    STAQ    SC,,AUTO

      115     1496
      116     1497                                      /*DETERMINE IF THE MAP FOR THE MONITOR IS OK    */
      117     1498
      118     1499    1      I = %PGTBLLO;

   1499  1 000034   200003 450100                    STZ     I,,AUTO

      119     1500    1      CALL IRD$DODUMP    ALTRET(MON_MAP_BAD);

   1500  1 000035   001506 701000 1                  TSX1    IRD$DODUMP
         1 000036   000040 702000 1                  TSX2    MON_MAP_BAD

      120     1501    1      GOTO WRMJIT;

   1501  1 000037   000056 710000 1                  TRA     WRMJIT

   1499  1 000040                       MON_MAP_BAD  null
      121     1502
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:29   
      122     1503    1   MON_MAP_BAD: ;                          /*ERROR ON MONITOR PAGE 0             */
      123     1504    1      IF (NO_PAGE ~=0) OR (PGTBL_BAD ~=0)

   1504  1 000040   200010 235100                    LDA     NO_PAGE,,AUTO
         1 000041   000044 601000 1                  TNZ     s:1506
         1 000042   200011 236100                    LDQ     PGTBL_BAD,,AUTO
         1 000043   000053 600000 1                  TZE     s:1515

      124     1505    2      THEN DO;

      125     1506    2           CALL IRR$TYPE6M(RVM_MONJIT,SIZEW(RVM_MONJIT));

   1506  1 000044   000000 630400 2                  EPPR0   0
         1 000045   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000046   000000 701000 xent               TSX1    IRR$TYPE6M
         1 000047   000000 011000                    NOP     0

      126     1507        /*O*   MESSAGE:   RCVR-MON JIT PAGE BAD
      127     1508               MEANING:   The monitor's page table %PGINMEM bit
      128     1509                          is not set or the physical page does
      129     1510                          not exist for the JIT page.
      130     1511        */
      131     1512    2           RV_ENTRY.BADPT ='1'B;

   1512  1 000050   100000 236003                    LDQ     32768,DU
         1 000051   000001 256000 xsym               ORSQ    RV_ENTRY+1

      132     1513    2           GOTO WRMONENT;

   1513  1 000052   000121 710000 1                  TRA     WRMONENT

      133     1514    2           END;
      134     1515    1      IF RV_PDUMP ~= 0 THEN RETURN;        /*DUMP AREA EXCEEDED                  */

   1515  1 000053   000000 235000 xsym               LDA     RV_PDUMP
         1 000054   000056 600000 1                  TZE     WRMJIT

PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:30   
   1515  1 000055   000000 702200 xent               TSX2  ! X66_ARET

   1515  1 000056                       WRMJIT       null
      135     1516
      136     1517                                           /* Write out Monitor JIT and HJIT pages    */
      137     1518    1   WRMJIT: ;
      138     1519    1      IF RV_BUFF.S_PNO = RV_CPNO

   1519  1 000056   000142 236000 xsym               LDQ     RV_BUFF+98
         1 000057   000071 604000 1                  TMI     s:1525
         1 000060   000000 116000 xsym               CMPQ    RV_CPNO
         1 000061   000071 601000 1                  TNZ     s:1525

      139     1520    2      THEN DO;

      140     1521    2           REMEMBER WRMONDIR IN NO_ROOM;

   1521  1 000062   000362 635000 1                  EAA     WRMONDIR
         1 000063   200016 452500                    STP2    NO_ROOM,,AUTO
         1 000064   200017 755100                    STA     NO_ROOM+1,,AUTO

      141     1522    2           REMEMBER WRMONDIR IN RV_UNWIND1;

   1522  1 000065   000362 635000 1                  EAA     WRMONDIR
         1 000066   000000 452400 xsym               STP2    RV_UNWIND1
         1 000067   000001 755000 xsym               STA     RV_UNWIND1+1

      142     1523    2           END;

   1523  1 000070   000077 710000 1                  TRA     s:1529

      143     1524    2      ELSE DO;

      144     1525    2           REMEMBER WRMONENT IN NO_ROOM;

   1525  1 000071   000121 635000 1                  EAA     WRMONENT
         1 000072   200016 452500                    STP2    NO_ROOM,,AUTO
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:31   
         1 000073   200017 755100                    STA     NO_ROOM+1,,AUTO

      145     1526    2           REMEMBER WRMONENT IN RV_UNWIND1;

   1526  1 000074   000121 635000 1                  EAA     WRMONENT
         1 000075   000000 452400 xsym               STP2    RV_UNWIND1
         1 000076   000001 755000 xsym               STA     RV_UNWIND1+1

      146     1527    2           END;

      147     1528                                 /*IF WE EXCEED DUMP AREA WRITE DIRECTORY AND RETURN  */
      148     1529    2      DO I=%JITPG TO %HJITPG+1;

   1529  1 000077   000013 235007                    LDA     11,DL
         1 000100   200003 755100                    STA     I,,AUTO
         1 000101   000107 710000 1                  TRA     NXTJITPG+3

      149     1530    2           CALL IRD$DODUMP    ALTRET(NXTJITPG);

   1530  1 000102   001506 701000 1                  TSX1    IRD$DODUMP
         1 000103   000104 702000 1                  TSX2    NXTJITPG

   1530  1 000104                       NXTJITPG     null
      150     1531    2   NXTJITPG: ;                             /*SHOULD TYPE ERR MSGS HERE           */
      151     1532    2           END;

   1532  1 000104   200003 235100                    LDA     I,,AUTO
         1 000105   000001 035007                    ADLA    1,DL
         1 000106   200003 755100                    STA     I,,AUTO
         1 000107   000017 115007                    CMPA    15,DL
         1 000110   000102 602000 1                  TNC     s:1530

      152     1533
      153     1534
      154     1535                                 /*WRITE  WSQ PAGES REQUESTED VIA THE SCREECH CODE    */
      155     1536    1      IF RV_BUFF.S_PNO ~= RV_CPNO          /*IF NOT DUMPING SCREECHING CPU       */

PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:32   
   1536  1 000111   000142 236000 xsym               LDQ     RV_BUFF+98
         1 000112   000115 604000 1                  TMI     s:1538
         1 000113   000000 116000 xsym               CMPQ    RV_CPNO
         1 000114   000133 600000 1                  TZE     s:1552

      156     1537    2      THEN DO;

      157     1538    2           I=%ISEGLO;                      /*JUST DUMP DATA PAGE 0               */

   1538  1 000115   000100 235007                    LDA     64,DL
         1 000116   200003 755100                    STA     I,,AUTO

      158     1539    2           CALL IRD$DODUMP;

   1539  1 000117   001506 701000 1                  TSX1    IRD$DODUMP
         1 000120   000000 011000                    NOP     0

   1538  1 000121                       WRMONENT     null
      159     1540    2   WRMONENT: ;
      160     1541    2           RV_BUFF.MONJITS(RV_CPNO) = RV_ENTRY;

   1541  1 000121   000000 235000 xsym               LDA     RV_CPNO
         1 000122   000001 735000                    ALS     1
         1 000123   000000 620005                    EAX0    0,AL
         1 000124   000000 237000 xsym               LDAQ    RV_ENTRY
         1 000125   000322 757010 xsym               STAQ    RV_BUFF+210,X0

      161     1542    2           RV_BUFF.SIZE = RV_BUFF.SIZE + RV_ENTRY.SZ;

   1542  1 000126   000001 236000 xsym               LDQ     RV_ENTRY+1
         1 000127   777777 376007                    ANQ     -1,DL
         1 000130   000002 036000 xsym               ADLQ    RV_BUFF+2
         1 000131   000002 756000 xsym               STQ     RV_BUFF+2

      162     1543    2           RETURN;

   1543  1 000132   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:33   

      163     1544    2           END;
      164     1545
      165     1546
      166     1547        /*  IF DUMPING THE SCREECHING CPU--DUMP THE REST OF THE MONITOR  */
      167     1548        /*  NOTE THAT THESE PAGES MUST BE WRITTEN OUT TO DISK IN THE ORDER THAT
      168     1549            THEY APPEAR IN THE MONITOR'S PAGE TABLE (SORTED BY VIRTUAL PAGE)    */
      169     1550
      170     1551
      171     1552    2      DO I = %ISEGLO-1 TO MONPLL-1;        /*Get SEGTBL too*/

   1552  1 000133   000077 235007                    LDA     63,DL
         1 000134   200003 755100                    STA     I,,AUTO
         1 000135   000143 710000 1                  TRA     s:1554+3

      172     1553    2           CALL IRD$DODUMP;

   1553  1 000136   001506 701000 1                  TSX1    IRD$DODUMP
         1 000137   000000 011000                    NOP     0

      173     1554    2           END;

   1554  1 000140   200003 235100                    LDA     I,,AUTO
         1 000141   000001 035007                    ADLA    1,DL
         1 000142   200003 755100                    STA     I,,AUTO
         1 000143   200003 236100                    LDQ     I,,AUTO
         1 000144   000147 604000 1                  TMI     s:1556
         1 000145   000000 116000 xsym               CMPQ    MONPLL
         1 000146   000136 604000 1                  TMI     s:1553

      174     1555
      175     1556    1      IF RPM_FLG

   1556  1 000147   000000 235000 xsym               LDA     RPM_FLG
         1 000150   000162 600000 1                  TZE     s:1563

      176     1557    2      THEN DO;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:34   

      177     1558    3           DO I=%IMXLO TO %IMXHI;

   1558  1 000151   000510 235007                    LDA     328,DL
         1 000152   200003 755100                    STA     I,,AUTO

      178     1559    3                CALL IRD$DODUMP;

   1559  1 000153   001506 701000 1                  TSX1    IRD$DODUMP
         1 000154   000000 011000                    NOP     0

      179     1560    3                END;

   1560  1 000155   200003 235100                    LDA     I,,AUTO
         1 000156   000001 035007                    ADLA    1,DL
         1 000157   200003 755100                    STA     I,,AUTO
         1 000160   000530 115007                    CMPA    344,DL
         1 000161   000153 602000 1                  TNC     s:1559

      180     1561    2           END;

      181     1562
      182     1563    1      IF SC.PMDATA# = '1'B

   1563  1 000162   200023 236100                    LDQ     SC+1,,AUTO
         1 000163   000004 316003                    CANQ    4,DU
         1 000164   000176 600000 1                  TZE     s:1570

      183     1564    2      THEN DO;

      184     1565    3           DO I=%MOUSELO TO %MOUSEHI;

   1565  1 000165   000540 235007                    LDA     352,DL
         1 000166   200003 755100                    STA     I,,AUTO

      185     1566    3                CALL IRD$DODUMP;

PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:35   
   1566  1 000167   001506 701000 1                  TSX1    IRD$DODUMP
         1 000170   000000 011000                    NOP     0

      186     1567    3                END;

   1567  1 000171   200003 235100                    LDA     I,,AUTO
         1 000172   000001 035007                    ADLA    1,DL
         1 000173   200003 755100                    STA     I,,AUTO
         1 000174   000550 115007                    CMPA    360,DL
         1 000175   000167 602000 1                  TNC     s:1566

      187     1568    2           END;

      188     1569
      189     1570    1      IF SC.CWSPT#='1'B

   1570  1 000176   200023 236100                    LDQ     SC+1,,AUTO
         1 000177   000100 316003                    CANQ    64,DU
         1 000200   000212 600000 1                  TZE     s:1577

      190     1571    2      THEN DO;

      191     1572    3           DO I=%CWSQPTLO TO %CWSQPTHI;

   1572  1 000201   000570 235007                    LDA     376,DL
         1 000202   200003 755100                    STA     I,,AUTO

      192     1573    3                CALL IRD$DODUMP;

   1573  1 000203   001506 701000 1                  TSX1    IRD$DODUMP
         1 000204   000000 011000                    NOP     0

      193     1574    3                END;

   1574  1 000205   200003 235100                    LDA     I,,AUTO
         1 000206   000001 035007                    ADLA    1,DL
         1 000207   200003 755100                    STA     I,,AUTO
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:36   
         1 000210   000610 115007                    CMPA    392,DL
         1 000211   000203 602000 1                  TNC     s:1573

      194     1575    2           END;

      195     1576
      196     1577    2      DO I=%TIGRLO TO %TIGRHI;

   1577  1 000212   000610 235007                    LDA     392,DL
         1 000213   200003 755100                    STA     I,,AUTO

      197     1578    2           CALL IRD$DODUMP;

   1578  1 000214   001506 701000 1                  TSX1    IRD$DODUMP
         1 000215   000000 011000                    NOP     0

      198     1579    2           END;

   1579  1 000216   200003 235100                    LDA     I,,AUTO
         1 000217   000001 035007                    ADLA    1,DL
         1 000220   200003 755100                    STA     I,,AUTO
         1 000221   001010 115007                    CMPA    520,DL
         1 000222   000214 602000 1                  TNC     s:1578

      199     1580
      200     1581    1      IF SC.CFUS#   = '1'B

   1581  1 000223   200023 236100                    LDQ     SC+1,,AUTO
         1 000224   200000 316003                    CANQ    65536,DU
         1 000225   000237 600000 1                  TZE     s:1588

      201     1582    2      THEN DO;

      202     1583    3           DO I=%CFULO TO %CFUHI;

   1583  1 000226   001130 235007                    LDA     600,DL
         1 000227   200003 755100                    STA     I,,AUTO
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:37   

      203     1584    3                CALL IRD$DODUMP;

   1584  1 000230   001506 701000 1                  TSX1    IRD$DODUMP
         1 000231   000000 011000                    NOP     0

      204     1585    3                END;

   1585  1 000232   200003 235100                    LDA     I,,AUTO
         1 000233   000001 035007                    ADLA    1,DL
         1 000234   200003 755100                    STA     I,,AUTO
         1 000235   001212 115007                    CMPA    650,DL
         1 000236   000230 602000 1                  TNC     s:1584

      205     1586    2           END;

      206     1587
      207     1588    1      IF SC.ASAVE#   = '1'B

   1588  1 000237   200023 236100                    LDQ     SC+1,,AUTO
         1 000240   100000 316003                    CANQ    32768,DU
         1 000241   000253 600000 1                  TZE     s:1595

      208     1589    2      THEN DO;

      209     1590    3           DO I=%DS2LO TO %DS2HI;

   1590  1 000242   001212 235007                    LDA     650,DL
         1 000243   200003 755100                    STA     I,,AUTO

      210     1591    3                CALL IRD$DODUMP;

   1591  1 000244   001506 701000 1                  TSX1    IRD$DODUMP
         1 000245   000000 011000                    NOP     0

      211     1592    3                END;

PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:38   
   1592  1 000246   200003 235100                    LDA     I,,AUTO
         1 000247   000001 035007                    ADLA    1,DL
         1 000250   200003 755100                    STA     I,,AUTO
         1 000251   001236 115007                    CMPA    670,DL
         1 000252   000244 602000 1                  TNC     s:1591

      212     1593    2           END;

      213     1594
      214     1595    1      IF SC.ENQ#    = '1'B

   1595  1 000253   200023 236100                    LDQ     SC+1,,AUTO
         1 000254   040000 316003                    CANQ    16384,DU
         1 000255   000267 600000 1                  TZE     s:1602

      215     1596    2      THEN DO;

      216     1597    3           DO I=%ENQLO TO %ENQHI;

   1597  1 000256   001236 235007                    LDA     670,DL
         1 000257   200003 755100                    STA     I,,AUTO

      217     1598    3                CALL IRD$DODUMP;

   1598  1 000260   001506 701000 1                  TSX1    IRD$DODUMP
         1 000261   000000 011000                    NOP     0

      218     1599    3                END;

   1599  1 000262   200003 235100                    LDA     I,,AUTO
         1 000263   000001 035007                    ADLA    1,DL
         1 000264   200003 755100                    STA     I,,AUTO
         1 000265   001266 115007                    CMPA    694,DL
         1 000266   000260 602000 1                  TNC     s:1598

      219     1600    2           END;

PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:39   
      220     1601
      221     1602    1      IF SC.DS4#   = '1'B

   1602  1 000267   200023 236100                    LDQ     SC+1,,AUTO
         1 000270   020000 316003                    CANQ    8192,DU
         1 000271   000303 600000 1                  TZE     s:1609

      222     1603    2      THEN DO;

      223     1604    3           DO I=%DS4LO TO %DS4HI;

   1604  1 000272   001266 235007                    LDA     694,DL
         1 000273   200003 755100                    STA     I,,AUTO

      224     1605    3                CALL IRD$DODUMP;

   1605  1 000274   001506 701000 1                  TSX1    IRD$DODUMP
         1 000275   000000 011000                    NOP     0

      225     1606    3                END;

   1606  1 000276   200003 235100                    LDA     I,,AUTO
         1 000277   000001 035007                    ADLA    1,DL
         1 000300   200003 755100                    STA     I,,AUTO
         1 000301   001362 115007                    CMPA    754,DL
         1 000302   000274 602000 1                  TNC     s:1605

      226     1607    2           END;

      227     1608
      228     1609    1      IF SC.DS5#   = '1'B

   1609  1 000303   200023 236100                    LDQ     SC+1,,AUTO
         1 000304   010000 316003                    CANQ    4096,DU
         1 000305   000317 600000 1                  TZE     s:1616

      229     1610    2      THEN DO;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:40   

      230     1611    3           DO I=%DS5LO TO %DS5HI;

   1611  1 000306   001362 235007                    LDA     754,DL
         1 000307   200003 755100                    STA     I,,AUTO

      231     1612    3                CALL IRD$DODUMP;

   1612  1 000310   001506 701000 1                  TSX1    IRD$DODUMP
         1 000311   000000 011000                    NOP     0

      232     1613    3                END;

   1613  1 000312   200003 235100                    LDA     I,,AUTO
         1 000313   000001 035007                    ADLA    1,DL
         1 000314   200003 755100                    STA     I,,AUTO
         1 000315   001456 115007                    CMPA    814,DL
         1 000316   000310 602000 1                  TNC     s:1612

      233     1614    2           END;

      234     1615
      235     1616    1      IF SC.DS6#   = '1'B

   1616  1 000317   200023 236100                    LDQ     SC+1,,AUTO
         1 000320   004000 316003                    CANQ    2048,DU
         1 000321   000333 600000 1                  TZE     s:1623

      236     1617    2      THEN DO;

      237     1618    3           DO I=%DS6LO TO %DS6HI;

   1618  1 000322   001456 235007                    LDA     814,DL
         1 000323   200003 755100                    STA     I,,AUTO

      238     1619    3                CALL IRD$DODUMP;

PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:41   
   1619  1 000324   001506 701000 1                  TSX1    IRD$DODUMP
         1 000325   000000 011000                    NOP     0

      239     1620    3                END;

   1620  1 000326   200003 235100                    LDA     I,,AUTO
         1 000327   000001 035007                    ADLA    1,DL
         1 000330   200003 755100                    STA     I,,AUTO
         1 000331   001552 115007                    CMPA    874,DL
         1 000332   000324 602000 1                  TNC     s:1619

      240     1621    2           END;

      241     1622
      242     1623    1      IF SC.DS7#   = '1'B

   1623  1 000333   200023 236100                    LDQ     SC+1,,AUTO
         1 000334   002000 316003                    CANQ    1024,DU
         1 000335   000347 600000 1                  TZE     s:1630

      243     1624    2      THEN DO;

      244     1625    3           DO I=%DS7LO TO %DS7HI;

   1625  1 000336   001552 235007                    LDA     874,DL
         1 000337   200003 755100                    STA     I,,AUTO

      245     1626    3                CALL IRD$DODUMP;

   1626  1 000340   001506 701000 1                  TSX1    IRD$DODUMP
         1 000341   000000 011000                    NOP     0

      246     1627    3                END;

   1627  1 000342   200003 235100                    LDA     I,,AUTO
         1 000343   000001 035007                    ADLA    1,DL
         1 000344   200003 755100                    STA     I,,AUTO
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:42   
         1 000345   001650 115007                    CMPA    936,DL
         1 000346   000340 602000 1                  TNC     s:1626

      247     1628    2           END;

      248     1629
      249     1630    1      IF SC.LDCTS# = '1'B

   1630  1 000347   200023 430100                    FSZN    SC+1,,AUTO
         1 000350   000362 605000 1                  TPL     WRMONDIR

      250     1631    2      THEN DO;

      251     1632    3           DO I=%LDCTLO TO %LDCTHI;

   1632  1 000351   001650 236007                    LDQ     936,DL
         1 000352   200003 756100                    STQ     I,,AUTO

      252     1633    3                CALL IRD$DODUMP;

   1633  1 000353   001506 701000 1                  TSX1    IRD$DODUMP
         1 000354   000000 011000                    NOP     0

      253     1634    3                END;

   1634  1 000355   200003 235100                    LDA     I,,AUTO
         1 000356   000001 035007                    ADLA    1,DL
         1 000357   200003 755100                    STA     I,,AUTO
         1 000360   002000 115007                    CMPA    1024,DL
         1 000361   000353 602000 1                  TNC     s:1633

      254     1635    2           END;

   1630  1 000362                       WRMONDIR     null
      255     1636        %EJECT;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:43   
      256     1637
      257     1638    1   WRMONDIR: ;
      258     1639                                 /* REWRITE THE PG TABLE WITH THE %SCRCVR FLAGS SET   */
      259     1640    1      POBUF.WSQD = RV_WSQD;

   1640  1 000362   010000 220003                    LDX0    4096,DU
         1 000363   000040 100440                    MLR     fill='000'O
         1 000364   000000 000010 xsym               ADSC9   RV_WSQD                  cn=0,n=*X0
         1 000365   000000 000010 xsym               ADSC9   POBUF                    cn=0,n=*X0

      260     1641    1      RV_WDGRAN = RV_ENTRY.DA;

   1641  1 000366   000000 235000 xsym               LDA     RV_ENTRY
         1 000367   000000 755000 xsym               STA     RV_WDGRAN

      261     1642    1      CALL IRR$WWSQD  ALTRET(ZAPMDIR);

   1642  1 000370   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000371   000000 701000 xent               TSX1    IRR$WWSQD
         1 000372   000401 702000 1                  TSX2    ZAPMDIR

      262     1643
      263     1644    1      RV_BUFF.MONWSQD = RV_ENTRY;

   1644  1 000373   000000 237000 xsym               LDAQ    RV_ENTRY
         1 000374   000316 757000 xsym               STAQ    RV_BUFF+206

      264     1645    1      RV_BUFF.SIZE = RV_BUFF.SIZE + RV_ENTRY.SZ;

   1645  1 000375   000001 236000 xsym               LDQ     RV_ENTRY+1
         1 000376   777777 376007                    ANQ     -1,DL
         1 000377   000002 036000 xsym               ADLQ    RV_BUFF+2
         1 000400   000002 756000 xsym               STQ     RV_BUFF+2

   1645  1 000401                       ZAPMDIR      null
      265     1646    1   ZAPMDIR: ;
      266     1647
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:44   
      267     1648        %EJECT;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:45   
      268     1649
      269     1650
      270     1651    1      IF SC.CWSPT#='1'B

   1651  1 000401   200023 236100                    LDQ     SC+1,,AUTO
         1 000402   000100 316003                    CANQ    64,DU
         1 000403   000630 600000 1                  TZE     s:1708

      271     1652    2      THEN DO;

      272     1653    2           REMEMBER GIVEUP_CWSQ IN RV_UNWIND1;

   1653  1 000404   000555 635000 1                  EAA     GIVEUP_CWSQ
         1 000405   000000 452400 xsym               STP2    RV_UNWIND1
         1 000406   000001 755000 xsym               STA     RV_UNWIND1+1

      273     1654    2           REMEMBER GIVEUP_CWSQ IN NO_ROOM;

   1654  1 000407   000555 635000 1                  EAA     GIVEUP_CWSQ
         1 000410   200016 452500                    STP2    NO_ROOM,,AUTO
         1 000411   200017 755100                    STA     NO_ROOM+1,,AUTO

      274     1655    2           REMEMBER REDUMP_CWSQ IN BAD_GRAN;

   1655  1 000412   000475 635000 1                  EAA     REDUMP_CWSQ
         1 000413   200014 452500                    STP2    BAD_GRAN,,AUTO
         1 000414   200015 755100                    STA     BAD_GRAN+1,,AUTO

      275     1656
      276     1657    2           CINDEX=0;

   1657  1 000415   200006 450100                    STZ     CINDEX,,AUTO

      277     1658    3           DO K=%CWSQPTLO TO %CWSQPTHI;

   1658  1 000416   000570 235007                    LDA     376,DL
         1 000417   200005 755100                    STA     K,,AUTO
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:46   

      278     1659    3                DOIT='0'B;

   1659  1 000420   200021 450100                    STZ     DOIT,,AUTO

      279     1660    3                IF S1000_FLG THEN          /* HW_WSQ0PT                          */

   1660  1 000421   000000 235000 xsym               LDA     S1000_FLG
         1 000422   000456 600000 1                  TZE     s:1665

      280     1661    3                     IF ( (I$MPGTBL$->B$WSQD.PG.RPN(K) ~=FPMC.RPN)

   1661  1 000423   000000 470400 xsym               LDP0    I$MPGTBL$
         1 000424   200005 720100                    LXL0    K,,AUTO
         1 000425   000000 221110                    LDX1    0,X0,PR0
         1 000426   000000 101000 xsym               CMPX1   FPMC
         1 000427   000473 600000 1                  TZE     s:1668
         1 000430   000000 236110                    LDQ     0,X0,PR0
         1 000431   000022 772000                    QRL     18
         1 000432   000001 736000                    QLS     1
         1 000433   000000 471400 xsym               LDP1    B$IPHYMAP$
         1 000434   000100 101506                    MRL     fill='000'O
         1 000435   100000 000002                    ADSC9   0,Q,PR1                  cn=0,n=2
         1 000436   200026 000004                    ADSC9   SC+4,,AUTO               cn=0,n=4
         1 000437   200026 236100                    LDQ     SC+4,,AUTO
         1 000440   000000 116000 xsym               CMPQ    IS_PPUT_SIZE
         1 000441   000473 603000 1                  TRC     s:1668
         1 000442   000000 236110                    LDQ     0,X0,PR0
         1 000443   000022 772000                    QRL     18
         1 000444   000001 736000                    QLS     1
         1 000445   000100 101506                    MRL     fill='000'O
         1 000446   100000 000002                    ADSC9   0,Q,PR1                  cn=0,n=2
         1 000447   200027 000004                    ADSC9   SC+5,,AUTO               cn=0,n=4
         1 000450   200027 236100                    LDQ     SC+5,,AUTO
         1 000451   000004 116007                    CMPQ    4,DL
         1 000452   000473 604000 1                  TMI     s:1668

PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:47   
      281     1662    3                       AND (B$IPHYMAP$->B$HALF(I$MPGTBL$->B$WSQD.PG.RPN(K)) <
              1662                                IS_PPUT_SIZE)
      282     1663    3                       AND (B$IPHYMAP$->B$HALF(I$MPGTBL$->B$WSQD.PG.RPN(K)) >3) ) THEN
              1663                                DOIT='1'B;ELSE;

   1663  1 000453   400000 236003                    LDQ     -131072,DU
         1 000454   200021 756100                    STQ     DOIT,,AUTO
         1 000455   000473 710000 1                  TRA     s:1668

      283     1664    3                ELSE
      284     1665    3                     IF ( (I$MPGTBL$->B$WSQD.PG.RPN(K) ~=FPMC.RPN)

   1665  1 000456   000000 470400 xsym               LDP0    I$MPGTBL$
         1 000457   200005 720100                    LXL0    K,,AUTO
         1 000460   000000 221110                    LDX1    0,X0,PR0
         1 000461   000000 101000 xsym               CMPX1   FPMC
         1 000462   000473 600000 1                  TZE     s:1668
         1 000463   000000 236110                    LDQ     0,X0,PR0
         1 000464   000022 772000                    QRL     18
         1 000465   000000 116000 xsym               CMPQ    IS_PPUT_SIZE
         1 000466   000473 603000 1                  TRC     s:1668
         1 000467   000004 101003                    CMPX1   4,DU
         1 000470   000473 602000 1                  TNC     s:1668

      285     1666    3                       AND (I$MPGTBL$->B$WSQD.PG.RPN(K) < IS_PPUT_SIZE)
      286     1667    3                       AND (I$MPGTBL$->B$WSQD.PG.RPN(K) >3) ) THEN DOIT='1'B;

   1667  1 000471   400000 236003                    LDQ     -131072,DU
         1 000472   200021 756100                    STQ     DOIT,,AUTO

      287     1668    3                IF (DOIT)

   1668  1 000473   200021 234100                    SZN     DOIT,,AUTO
         1 000474   000620 605000 1                  TPL     s:1699

      288     1669    4                THEN DO;

PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:48   
   1667  1 000475                       REDUMP_CWSQ  null
      289     1670    4   REDUMP_CWSQ:      ;
      290     1671    4                     CWSQD$=I$MEM$;

   1671  1 000475   000000 236000 xsym               LDQ     I$MEM$
         1 000476   200007 756100                    STQ     CWSQD$,,AUTO

      291     1672    5                     DO J=0 TO 3;

   1672  1 000477   200004 450100                    STZ     J,,AUTO

      292     1673
      293     1674    5                          RV_ENTRY='0'B;

   1674  1 000500   000000 235003                    LDA     0,DU
         1 000501   000000 236003                    LDQ     0,DU
         1 000502   000000 757000 xsym               STAQ    RV_ENTRY

      294     1675    5                          RV_ENTRY.DA = RV_NXTGRAN;

   1675  1 000503   000000 235000 xsym               LDA     RV_NXTGRAN
         1 000504   000000 755000 xsym               STA     RV_ENTRY

      295     1676    5                          RV_ENTRY.SZ=1;   /*RESERVE DIRECTORY GRAN              */

   1676  1 000505   000001 220003                    LDX0    1,DU
         1 000506   000001 440000 xsym               SXL0    RV_ENTRY+1

      296     1677    5                          RV_NXTGRAN=RV_NXTGRAN+1;

   1677  1 000507   000000 054000 xsym               AOS     RV_NXTGRAN

      297     1678    5                          IF S1000_FLG THEN /* HW_WSQ0PT                         */

   1678  1 000510   000000 235000 xsym               LDA     S1000_FLG
         1 000511   000527 600000 1                  TZE     s:1681

PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:49   
      298     1679    5                              MEMDESC.BADDR = (B$IPHYMAP$->B$HALF(I$MPGTBL$->B$WSQD.PG
              1679                                        .RPN(K))*4096);

   1679  1 000512   000000 470400 xsym               LDP0    I$MPGTBL$
         1 000513   200005 721100                    LXL1    K,,AUTO
         1 000514   000000 236111                    LDQ     0,X1,PR0
         1 000515   000022 772000                    QRL     18
         1 000516   000001 736000                    QLS     1
         1 000517   000000 471400 xsym               LDP1    B$IPHYMAP$
         1 000520   000100 101506                    MRL     fill='000'O
         1 000521   100000 000002                    ADSC9   0,Q,PR1                  cn=0,n=2
         1 000522   200026 000004                    ADSC9   SC+4,,AUTO               cn=0,n=4
         1 000523   200026 236100                    LDQ     SC+4,,AUTO
         1 000524   000014 736000                    QLS     12
         1 000525   000001 756000 xsym               STQ     MEMDESC+1
         1 000526   000535 710000 1                  TRA     s:1682

      299     1680    5                          ELSE
      300     1681    5                               MEMDESC.BADDR = (I$MPGTBL$->B$WSQD.PG.RPN(K)*4096);

   1681  1 000527   000000 470400 xsym               LDP0    I$MPGTBL$
         1 000530   200005 721100                    LXL1    K,,AUTO
         1 000531   000000 236111                    LDQ     0,X1,PR0
         1 000532   000006 772000                    QRL     6
         1 000533   000002 376000 2                  ANQ     2
         1 000534   000001 756000 xsym               STQ     MEMDESC+1

      301     1682    5                          RV_WSQD='0'B;

   1682  1 000535   010000 222003                    LDX2    4096,DU
         1 000536   000040 100400                    MLR     fill='000'O
         1 000537   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000540   000000 000012 xsym               ADSC9   RV_WSQD                  cn=0,n=*X2

      302     1683    5                          RV_WSQD = CWSQD$->B$CWSQD;

   1683  1 000541   200007 471500                    LDP1    CWSQD$,,AUTO
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:50   
         1 000542   000040 100500                    MLR     fill='000'O
         1 000543   100000 002000                    ADSC9   0,,PR1                   cn=0,n=1024
         1 000544   000000 000012 xsym               ADSC9   RV_WSQD                  cn=0,n=*X2

      303     1684    6                          DO I=0 TO 255;

   1684  1 000545   200003 450100                    STZ     I,,AUTO

      304     1685    6                               CALL IRD$DODUMP;

   1685  1 000546   001506 701000 1                  TSX1    IRD$DODUMP
         1 000547   000000 011000                    NOP     0

      305     1686    6                               END;

   1686  1 000550   200003 235100                    LDA     I,,AUTO
         1 000551   000001 035007                    ADLA    1,DL
         1 000552   200003 755100                    STA     I,,AUTO
         1 000553   000400 115007                    CMPA    256,DL
         1 000554   000546 602000 1                  TNC     s:1685

   1685  1 000555                       GIVEUP_CWSQ  null
      306     1687    5   GIVEUP_CWSQ:           ;
      307     1688    5                          POBUF='0'B;

   1688  1 000555   010000 220003                    LDX0    4096,DU
         1 000556   000040 100400                    MLR     fill='000'O
         1 000557   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000560   000000 000010 xsym               ADSC9   POBUF                    cn=0,n=*X0

      308     1689    5                          ADDR(POBUF.WSQD(J*256))->B$256=RV_WSQD;

   1689  1 000561   200004 235100                    LDA     J,,AUTO
         1 000562   000012 735000                    ALS     10
         1 000563   000005 100400                    MLR     fill='000'O
         1 000564   000000 002000 xsym               ADSC9   RV_WSQD                  cn=0,n=1024
         1 000565   000000 002000 xsym               ADSC9   POBUF,A                  cn=0,n=1024
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:51   

      309     1690    5                          RV_WDGRAN=RV_ENTRY.DA;

   1690  1 000566   000000 236000 xsym               LDQ     RV_ENTRY
         1 000567   000000 756000 xsym               STQ     RV_WDGRAN

      310     1691    5                          CALL IRR$WWSQD ALTRET(ZAP_WSQD);

   1691  1 000570   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000571   000000 701000 xent               TSX1    IRR$WWSQD
         1 000572   000604 702000 1                  TSX2    ZAP_WSQD

      311     1692    5                          RV_BUFF.CWSQ(CINDEX)=RV_ENTRY;

   1692  1 000573   200006 235100                    LDA     CINDEX,,AUTO
         1 000574   000001 735000                    ALS     1
         1 000575   000000 620005                    EAX0    0,AL
         1 000576   000000 237000 xsym               LDAQ    RV_ENTRY
         1 000577   000344 757010 xsym               STAQ    RV_BUFF+228,X0

      312     1693    5                          RV_BUFF.SIZE = RV_BUFF.SIZE+RV_ENTRY.SZ;

   1693  1 000600   000001 236000 xsym               LDQ     RV_ENTRY+1
         1 000601   777777 376007                    ANQ     -1,DL
         1 000602   000002 036000 xsym               ADLQ    RV_BUFF+2
         1 000603   000002 756000 xsym               STQ     RV_BUFF+2

   1693  1 000604                       ZAP_WSQD     null
      313     1694    5   ZAP_WSQD:              ;
      314     1695    5                          CINDEX=CINDEX+1;

   1695  1 000604   200006 235100                    LDA     CINDEX,,AUTO
         1 000605   000001 035007                    ADLA    1,DL
         1 000606   200006 755100                    STA     CINDEX,,AUTO

      315     1696    5                          CWSQD$ = PINCRW(CWSQD$,256);

PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:52   
   1696  1 000607   200007 236100                    LDQ     CWSQD$,,AUTO
         1 000610   000400 036003                    ADLQ    256,DU
         1 000611   200007 756100                    STQ     CWSQD$,,AUTO

      316     1697    5                          END;             /*DO J=0 TO 3                         */

   1697  1 000612   200004 235100                    LDA     J,,AUTO
         1 000613   000001 035007                    ADLA    1,DL
         1 000614   200004 755100                    STA     J,,AUTO
         1 000615   000004 115007                    CMPA    4,DL
         1 000616   000500 602000 1                  TNC     s:1674

      317     1698    4                     END;                  /* DO IF THERE IS A PAGE*/

   1698  1 000617   000623 710000 1                  TRA     s:1700

      318     1699    3                ELSE CINDEX=CINDEX+4;

   1699  1 000620   200006 236100                    LDQ     CINDEX,,AUTO
         1 000621   000004 036007                    ADLQ    4,DL
         1 000622   200006 756100                    STQ     CINDEX,,AUTO

      319     1700    3                END;                       /*DO K=CWSPTLO TO %CWSQPTHI           */

   1700  1 000623   200005 235100                    LDA     K,,AUTO
         1 000624   000001 035007                    ADLA    1,DL
         1 000625   200005 755100                    STA     K,,AUTO
         1 000626   000610 115007                    CMPA    392,DL
         1 000627   000420 602000 1                  TNC     s:1659

      320     1701
      321     1702
      322     1703    2           END;                            /*DO IF CWSPT#*/

      323     1704
      324     1705        %EJECT;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:53   
      325     1706
      326     1707
      327     1708    1      IF SC.CGDATA#='1'B

   1708  1 000630   200023 236100                    LDQ     SC+1,,AUTO
         1 000631   000040 316003                    CANQ    32,DU
         1 000632   001043 600000 1                  TZE     s:1764

      328     1709    2      THEN DO;

      329     1710    2           REMEMBER GIVEUP_CGDATA IN RV_UNWIND1;

   1710  1 000633   001011 635000 1                  EAA     GIVEUP_CGDATA
         1 000634   000000 452400 xsym               STP2    RV_UNWIND1
         1 000635   000001 755000 xsym               STA     RV_UNWIND1+1

      330     1711    2           REMEMBER GIVEUP_CGDATA IN NO_ROOM;

   1711  1 000636   001011 635000 1                  EAA     GIVEUP_CGDATA
         1 000637   200016 452500                    STP2    NO_ROOM,,AUTO
         1 000640   200017 755100                    STA     NO_ROOM+1,,AUTO

      331     1712    2           REMEMBER REDUMP_CGDATA IN BAD_GRAN;

   1712  1 000641   000724 635000 1                  EAA     REDUMP_CGDATA
         1 000642   200014 452500                    STP2    BAD_GRAN,,AUTO
         1 000643   200015 755100                    STA     BAD_GRAN+1,,AUTO

      332     1713
      333     1714    2           J=0;

   1714  1 000644   200004 450100                    STZ     J,,AUTO

      334     1715    3           DO K=%CGPGTBLLO TO %PGTBLHI;

   1715  1 000645   000001 235007                    LDA     1,DL
         1 000646   200005 755100                    STA     K,,AUTO
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:54   

      335     1716                                                /* DO K=1 TO 10                       */
      336     1717    3                DOIT='0'B;

   1717  1 000647   200021 450100                    STZ     DOIT,,AUTO

      337     1718    3                IF S1000_FLG THEN          /* HW_WSQ0PT                          */

   1718  1 000650   000000 235000 xsym               LDA     S1000_FLG
         1 000651   000705 600000 1                  TZE     s:1723

      338     1719    3                     IF ( (I$MPGTBL$->B$WSQD.PG.RPN(K) ~=FPMC.RPN)

   1719  1 000652   000000 470400 xsym               LDP0    I$MPGTBL$
         1 000653   200005 720100                    LXL0    K,,AUTO
         1 000654   000000 221110                    LDX1    0,X0,PR0
         1 000655   000000 101000 xsym               CMPX1   FPMC
         1 000656   000722 600000 1                  TZE     s:1726
         1 000657   000000 236110                    LDQ     0,X0,PR0
         1 000660   000022 772000                    QRL     18
         1 000661   000001 736000                    QLS     1
         1 000662   000000 471400 xsym               LDP1    B$IPHYMAP$
         1 000663   000100 101506                    MRL     fill='000'O
         1 000664   100000 000002                    ADSC9   0,Q,PR1                  cn=0,n=2
         1 000665   200026 000004                    ADSC9   SC+4,,AUTO               cn=0,n=4
         1 000666   200026 236100                    LDQ     SC+4,,AUTO
         1 000667   000000 116000 xsym               CMPQ    IS_PPUT_SIZE
         1 000670   000722 603000 1                  TRC     s:1726
         1 000671   000000 236110                    LDQ     0,X0,PR0
         1 000672   000022 772000                    QRL     18
         1 000673   000001 736000                    QLS     1
         1 000674   000100 101506                    MRL     fill='000'O
         1 000675   100000 000002                    ADSC9   0,Q,PR1                  cn=0,n=2
         1 000676   200027 000004                    ADSC9   SC+5,,AUTO               cn=0,n=4
         1 000677   200027 236100                    LDQ     SC+5,,AUTO
         1 000700   000004 116007                    CMPQ    4,DL
         1 000701   000722 604000 1                  TMI     s:1726
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:55   

      339     1720    3                       AND (B$IPHYMAP$->B$HALF(I$MPGTBL$->B$WSQD.PG.RPN(K)) <
              1720                                IS_PPUT_SIZE)
      340     1721    3                       AND (B$IPHYMAP$->B$HALF(I$MPGTBL$->B$WSQD.PG.RPN(K)) >3) ) THEN
              1721                                DOIT='1'B;ELSE;

   1721  1 000702   400000 236003                    LDQ     -131072,DU
         1 000703   200021 756100                    STQ     DOIT,,AUTO
         1 000704   000722 710000 1                  TRA     s:1726

      341     1722    3                ELSE
      342     1723    3                     IF ( (I$MPGTBL$->B$WSQD.PG.RPN(K) ~=FPMC.RPN)

   1723  1 000705   000000 470400 xsym               LDP0    I$MPGTBL$
         1 000706   200005 720100                    LXL0    K,,AUTO
         1 000707   000000 221110                    LDX1    0,X0,PR0
         1 000710   000000 101000 xsym               CMPX1   FPMC
         1 000711   000722 600000 1                  TZE     s:1726
         1 000712   000000 236110                    LDQ     0,X0,PR0
         1 000713   000022 772000                    QRL     18
         1 000714   000000 116000 xsym               CMPQ    IS_PPUT_SIZE
         1 000715   000722 603000 1                  TRC     s:1726
         1 000716   000004 101003                    CMPX1   4,DU
         1 000717   000722 602000 1                  TNC     s:1726

      343     1724    3                       AND (I$MPGTBL$->B$WSQD.PG.RPN(K) < IS_PPUT_SIZE)
      344     1725    3                       AND (I$MPGTBL$->B$WSQD.PG.RPN(K) >3) ) THEN DOIT='1'B;

   1725  1 000720   400000 236003                    LDQ     -131072,DU
         1 000721   200021 756100                    STQ     DOIT,,AUTO

      345     1726    3                IF (DOIT)

   1726  1 000722   200021 234100                    SZN     DOIT,,AUTO
         1 000723   001033 605000 1                  TPL     ZAP_CGDATA

      346     1727    4                THEN DO;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:56   

   1725  1 000724                       REDUMP_CGDA* null
      347     1728    4   REDUMP_CGDATA:    ;
      348     1729
      349     1730    4                     RV_ENTRY='0'B;

   1730  1 000724   000000 235003                    LDA     0,DU
         1 000725   000000 236003                    LDQ     0,DU
         1 000726   000000 757000 xsym               STAQ    RV_ENTRY

      350     1731    4                     RV_ENTRY.DA = RV_NXTGRAN;

   1731  1 000727   000000 235000 xsym               LDA     RV_NXTGRAN
         1 000730   000000 755000 xsym               STA     RV_ENTRY

      351     1732    4                     RV_ENTRY.SZ=1;        /*RESERVE DIRECTORY GRAN              */

   1732  1 000731   000001 220003                    LDX0    1,DU
         1 000732   000001 440000 xsym               SXL0    RV_ENTRY+1

      352     1733    4                     RV_NXTGRAN=RV_NXTGRAN+1;

   1733  1 000733   000000 054000 xsym               AOS     RV_NXTGRAN

      353     1734
      354     1735    4                     IF S1000_FLG THEN     /* HW_WSQ0PT                          */

   1735  1 000734   000000 235000 xsym               LDA     S1000_FLG
         1 000735   000753 600000 1                  TZE     s:1738

      355     1736    4                         MEMDESC.BADDR = (B$IPHYMAP$->B$HALF(I$MPGTBL$->B$WSQD.PG.RPN(
              1736                                   K))*4096);

   1736  1 000736   000000 470400 xsym               LDP0    I$MPGTBL$
         1 000737   200005 721100                    LXL1    K,,AUTO
         1 000740   000000 236111                    LDQ     0,X1,PR0
         1 000741   000022 772000                    QRL     18
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:57   
         1 000742   000001 736000                    QLS     1
         1 000743   000000 471400 xsym               LDP1    B$IPHYMAP$
         1 000744   000100 101506                    MRL     fill='000'O
         1 000745   100000 000002                    ADSC9   0,Q,PR1                  cn=0,n=2
         1 000746   200026 000004                    ADSC9   SC+4,,AUTO               cn=0,n=4
         1 000747   200026 236100                    LDQ     SC+4,,AUTO
         1 000750   000014 736000                    QLS     12
         1 000751   000001 756000 xsym               STQ     MEMDESC+1
         1 000752   000761 710000 1                  TRA     s:1739

      356     1737    4                     ELSE
      357     1738    4                          MEMDESC.BADDR = (I$MPGTBL$->B$WSQD.PG.RPN(K) * 4096);

   1738  1 000753   000000 470400 xsym               LDP0    I$MPGTBL$
         1 000754   200005 721100                    LXL1    K,,AUTO
         1 000755   000000 236111                    LDQ     0,X1,PR0
         1 000756   000006 772000                    QRL     6
         1 000757   000002 376000 2                  ANQ     2
         1 000760   000001 756000 xsym               STQ     MEMDESC+1

      358     1739    4                     RV_WSQD = I$MEM$->B$WSQD;

   1739  1 000761   000000 471400 xsym               LDP1    I$MEM$
         1 000762   010000 222003                    LDX2    4096,DU
         1 000763   000040 100540                    MLR     fill='000'O
         1 000764   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
         1 000765   000000 000012 xsym               ADSC9   RV_WSQD                  cn=0,n=*X2

      359     1740
      360     1741
      361     1742    5                     DO I=0 TO 1023;

   1742  1 000766   200003 450100                    STZ     I,,AUTO

      362     1743    5                          IF (J*1024)+I >= RV_BUFF.MM_CGQCXT_END

   1743  1 000767   200004 236100                    LDQ     J,,AUTO
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:58   
         1 000770   000012 736000                    QLS     10
         1 000771   200003 036100                    ADLQ    I,,AUTO
         1 000772   000143 116000 xsym               CMPQ    RV_BUFF+99
         1 000773   001011 603000 1                  TRC     GIVEUP_CGDATA

      363     1744    5                          THEN GOTO GIVEUP_CGDATA;
      364     1745
      365     1746    5                          IF K=%CGPGTBLLO AND I<2 THEN GOTO SKIP_1_2;

   1746  1 000774   200005 235100                    LDA     K,,AUTO
         1 000775   000001 115007                    CMPA    1,DL
         1 000776   001002 601000 1                  TNZ     s:1747
         1 000777   200003 236100                    LDQ     I,,AUTO
         1 001000   000002 116007                    CMPQ    2,DL
         1 001001   001004 602000 1                  TNC     SKIP_1_2

      366     1747    5                          CALL IRD$DODUMP;

   1747  1 001002   001506 701000 1                  TSX1    IRD$DODUMP
         1 001003   000000 011000                    NOP     0

   1746  1 001004                       SKIP_1_2     null
      367     1748    5   SKIP_1_2:              ;
      368     1749    5                          END;

   1749  1 001004   200003 235100                    LDA     I,,AUTO
         1 001005   000001 035007                    ADLA    1,DL
         1 001006   200003 755100                    STA     I,,AUTO
         1 001007   002000 115007                    CMPA    1024,DL
         1 001010   000767 602000 1                  TNC     s:1743

   1742  1 001011                       GIVEUP_CGDA* null
      369     1750    4   GIVEUP_CGDATA:    ;
      370     1751    4                     POBUF.WSQD=RV_WSQD;

   1751  1 001011   010000 220003                    LDX0    4096,DU
         1 001012   000040 100440                    MLR     fill='000'O
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:59   
         1 001013   000000 000010 xsym               ADSC9   RV_WSQD                  cn=0,n=*X0
         1 001014   000000 000010 xsym               ADSC9   POBUF                    cn=0,n=*X0

      371     1752    4                     RV_WDGRAN=RV_ENTRY.DA;

   1752  1 001015   000000 235000 xsym               LDA     RV_ENTRY
         1 001016   000000 755000 xsym               STA     RV_WDGRAN

      372     1753    4                     CALL IRR$WWSQD ALTRET(ZAP_CGDATA);

   1753  1 001017   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001020   000000 701000 xent               TSX1    IRR$WWSQD
         1 001021   001033 702000 1                  TSX2    ZAP_CGDATA

      373     1754    4                     RV_BUFF.CGRWSQ(J)=RV_ENTRY;

   1754  1 001022   200004 235100                    LDA     J,,AUTO
         1 001023   000001 735000                    ALS     1
         1 001024   000000 620005                    EAX0    0,AL
         1 001025   000000 237000 xsym               LDAQ    RV_ENTRY
         1 001026   000444 757010 xsym               STAQ    RV_BUFF+292,X0

      374     1755    4                     RV_BUFF.SIZE = RV_BUFF.SIZE+RV_ENTRY.SZ;

   1755  1 001027   000001 236000 xsym               LDQ     RV_ENTRY+1
         1 001030   777777 376007                    ANQ     -1,DL
         1 001031   000002 036000 xsym               ADLQ    RV_BUFF+2
         1 001032   000002 756000 xsym               STQ     RV_BUFF+2

   1755  1 001033                       ZAP_CGDATA   null
      375     1756    4   ZAP_CGDATA:       ;
      376     1757    4                     END;                  /* DO IF THERE IS A PAGE*/

      377     1758    3                J=J+1;

   1758  1 001033   200004 235100                    LDA     J,,AUTO
         1 001034   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:60   
         1 001035   200004 755100                    STA     J,,AUTO

      378     1759    3                END;                       /*DO K=CGPGPTLO TO %CGPGQPTHI         */

   1759  1 001036   200005 236100                    LDQ     K,,AUTO
         1 001037   000001 036007                    ADLQ    1,DL
         1 001040   200005 756100                    STQ     K,,AUTO
         1 001041   000013 116007                    CMPQ    11,DL
         1 001042   000647 602000 1                  TNC     s:1717

      379     1760
      380     1761
      381     1762    2           END;                            /*DO IF CGDATA#*/

      382     1763
      383     1764    1      RETURN;

   1764  1 001043   000000 702200 xent               TSX2  ! X66_ARET

      384     1765        %EJECT;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:61   
      385     1766
      386     1767
      387     1768
      388     1769
      389     1770    1   IRD$DUMPUSR: ENTRY;

   1770  1 001044   000000 700200 xent  IRD$DUMPUSR  TSX0  ! X66_AUTO_0
         1 001045   000030 000000                    ZERO    24,0

      390     1771
      391     1772    1      IF RV_USRDIR.USER.SZ(RV_CUN) ~= 0 THEN RETURN;

   1772  1 001046   000000 235000 xsym               LDA     RV_CUN
         1 001047   000001 735000                    ALS     1
         1 001050   000001 720005 xsym               LXL0    RV_USRDIR+1,AL
         1 001051   001053 600000 1                  TZE     START_OVER

   1772  1 001052   000000 702200 xent               TSX2  ! X66_ARET

   1772  1 001053                       START_OVER   null
      392     1773                                      /* THIS USER HAS BEEN DUMPED ON AN EARLIER PASS */
      393     1774
      394     1775    1   START_OVER: ;                           /*UNWIND TO HERE IF BAD GRANULE       */
      395     1776    1      USER_DUMP = 1;

   1776  1 001053   000001 235007                    LDA     1,DL
         1 001054   200012 755100                    STA     USER_DUMP,,AUTO

      396     1777    1      REMEMBER START_OVER IN BAD_GRAN;

   1777  1 001055   001053 635000 1                  EAA     START_OVER
         1 001056   200014 452500                    STP2    BAD_GRAN,,AUTO
         1 001057   200015 755100                    STA     BAD_GRAN+1,,AUTO

      397     1778    1      REMEMBER NOPAGES IN NO_ROOM;

   1778  1 001060   001103 635000 1                  EAA     NOPAGES
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:62   
         1 001061   200016 452500                    STP2    NO_ROOM,,AUTO
         1 001062   200017 755100                    STA     NO_ROOM+1,,AUTO

      398     1779    1      RV_ENTRY='0'B;

   1779  1 001063   000000 235003                    LDA     0,DU
         1 001064   000000 236003                    LDQ     0,DU
         1 001065   000000 757000 xsym               STAQ    RV_ENTRY

      399     1780    1      RV_ENTRY.DA = RV_NXTGRAN;

   1780  1 001066   000000 235000 xsym               LDA     RV_NXTGRAN
         1 001067   000000 755000 xsym               STA     RV_ENTRY

      400     1781    1      SC = RV_SCODEA;

   1781  1 001070   000000 237000 xsym               LDAQ    RV_SCODEA
         1 001071   200022 757100                    STAQ    SC,,AUTO

      401     1782    1      RV_WSQD = I$UPGTBL$->B$DPAGE.WSQD;

   1782  1 001072   000000 470400 xsym               LDP0    I$UPGTBL$
         1 001073   010000 220003                    LDX0    4096,DU
         1 001074   000040 100540                    MLR     fill='000'O
         1 001075   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 001076   000000 000010 xsym               ADSC9   RV_WSQD                  cn=0,n=*X0

      402     1783
      403     1784                                           /*DETERMINE IF THE MAP FOR THIS USER IS OK */
      404     1785
      405     1786    1      I = %PGTBLLO;

   1786  1 001077   200003 450100                    STZ     I,,AUTO

      406     1787    1      CALL IRD$DODUMP    ALTRET(NOPAGES);

   1787  1 001100   001506 701000 1                  TSX1    IRD$DODUMP
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:63   
         1 001101   001103 702000 1                  TSX2    NOPAGES

      407     1788    1      GOTO WRLVA;

   1788  1 001102   001171 710000 1                  TRA     WRLVA

   1786  1 001103                       NOPAGES      null
      408     1789
      409     1790    1   NOPAGES: ;                              /*ERROR ON USER PAGE 0                */
      410     1791    1      IF RV_PDUMP ~= 0 THEN RETURN;        /*DUMP AREA EXCEEDED                  */

   1791  1 001103   000000 235000 xsym               LDA     RV_PDUMP
         1 001104   001106 600000 1                  TZE     s:1792

   1791  1 001105   000000 702200 xent               TSX2  ! X66_ARET

      411     1792    1      IF (NO_PAGE ~=0) OR (PGTBL_BAD ~=0)

   1792  1 001106   200010 236100                    LDQ     NO_PAGE,,AUTO
         1 001107   001112 601000 1                  TNZ     s:1794
         1 001110   200011 235100                    LDA     PGTBL_BAD,,AUTO
         1 001111   001171 600000 1                  TZE     WRLVA

      412     1793    2      THEN DO;

      413     1794    2           CALL IRR$TYPE6M(RVM_USRJIT,SIZEW(RVM_USRJIT));

   1794  1 001112   000003 630400 2                  EPPR0   3
         1 001113   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001114   000000 701000 xent               TSX1    IRR$TYPE6M
         1 001115   000000 011000                    NOP     0

      414     1795
      415     1796    2           RV_USRDIR.USER.PGTBL(RV_CUN) = '1'B;

   1796  1 001116   000000 235000 xsym               LDA     RV_CUN
         1 001117   000001 735000                    ALS     1
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:64   
         1 001120   001000 236003                    LDQ     512,DU
         1 001121   000001 256005 xsym               ORSQ    RV_USRDIR+1,AL

      416     1797        /*O*   MESSAGE:   RCVR-USER PAGE TABLE BAD
      417     1798               MEANING:   The user's page table %PGINMEM bit
      418     1799                          is not set or the physical page does
      419     1800                          not exist for the JIT page.
      420     1801        */
      421     1802    2           IF XA_MODE THEN                 /* HW_WSQ0PT & (HW_PTB_UNITS=1000)    */

   1802  1 001122   000000 234000 xsym               SZN     XA_MODE
         1 001123   001140 605000 1                  TPL     s:1804

      422     1803    2                RV_BAPAGE = (B$IPHYMAP$->B$HALF(R$CU$->B$U.PT)*256*64);

   1803  1 001124   000000 470400 xsym               LDP0    R$CU$
         1 001125   000014 236100                    LDQ     12,,PR0
         1 001126   000022 772000                    QRL     18
         1 001127   000001 736000                    QLS     1
         1 001130   000000 471400 xsym               LDP1    B$IPHYMAP$
         1 001131   000100 101506                    MRL     fill='000'O
         1 001132   100000 000002                    ADSC9   0,Q,PR1                  cn=0,n=2
         1 001133   200026 000004                    ADSC9   SC+4,,AUTO               cn=0,n=4
         1 001134   200026 236100                    LDQ     SC+4,,AUTO
         1 001135   000016 736000                    QLS     14
         1 001136   000000 756000 xsym               STQ     RV_BAPAGE
         1 001137   001163 710000 1                  TRA     s:1808

      423     1804    2           ELSE IF S1000_FLG THEN          /* HW_WSQ0PT                          */

   1804  1 001140   000000 235000 xsym               LDA     S1000_FLG
         1 001141   001156 600000 1                  TZE     s:1807

      424     1805    2                     RV_BAPAGE = (B$IPHYMAP$->B$HALF(R$CU$->B$U.PT)*256);

   1805  1 001142   000000 470400 xsym               LDP0    R$CU$
         1 001143   000014 236100                    LDQ     12,,PR0
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:65   
         1 001144   000022 772000                    QRL     18
         1 001145   000001 736000                    QLS     1
         1 001146   000000 471400 xsym               LDP1    B$IPHYMAP$
         1 001147   000100 101506                    MRL     fill='000'O
         1 001150   100000 000002                    ADSC9   0,Q,PR1                  cn=0,n=2
         1 001151   200026 000004                    ADSC9   SC+4,,AUTO               cn=0,n=4
         1 001152   200026 236100                    LDQ     SC+4,,AUTO
         1 001153   000010 736000                    QLS     8
         1 001154   000000 756000 xsym               STQ     RV_BAPAGE
         1 001155   001163 710000 1                  TRA     s:1808

      425     1806    2                ELSE
      426     1807    2                     RV_BAPAGE = (R$CU$->B$U.PT * 256);

   1807  1 001156   000000 470400 xsym               LDP0    R$CU$
         1 001157   000014 236100                    LDQ     12,,PR0
         1 001160   000012 772000                    QRL     10
         1 001161   000005 376000 2                  ANQ     5
         1 001162   000000 756000 xsym               STQ     RV_BAPAGE

      427     1808    2           CALL IRR$WDUMP ALTRET(ZAPDIR);

   1808  1 001163   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001164   000000 701000 xent               TSX1    IRR$WDUMP
         1 001165   001422 702000 1                  TSX2    ZAPDIR

      428     1809    2           RV_ENTRY.SZ=1;

   1809  1 001166   000001 220003                    LDX0    1,DU
         1 001167   000001 440000 xsym               SXL0    RV_ENTRY+1

      429     1810    2           GOTO SET_USRDIR;

   1810  1 001170   001405 710000 1                  TRA     SET_USRDIR

   1809  1 001171                       WRLVA        null
      430     1811    2           END;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:66   
      431     1812
      432     1813    1   WRLVA: ;
      433     1814    1      REMEMBER WRDIR IN NO_ROOM;

   1814  1 001171   001374 635000 1                  EAA     WRDIR
         1 001172   200016 452500                    STP2    NO_ROOM,,AUTO
         1 001173   200017 755100                    STA     NO_ROOM+1,,AUTO

      434     1815    1      REMEMBER WRDIR IN RV_UNWIND1;

   1815  1 001174   001374 635000 1                  EAA     WRDIR
         1 001175   000000 452400 xsym               STP2    RV_UNWIND1
         1 001176   000001 755000 xsym               STA     RV_UNWIND1+1

      435     1816                                 /*IF WE EXCEED DUMP AREA WRITE DIRECTORY AND RETURN  */
      436     1817    2      DO I=%PGTBLLO+1 TO %PGTBLHI;

   1817  1 001177   000001 236007                    LDQ     1,DL
         1 001200   200003 756100                    STQ     I,,AUTO
         1 001201   001207 710000 1                  TRA     NXTPGTBL+3

      437     1818    2           CALL IRD$DODUMP ALTRET(NXTPGTBL);

   1818  1 001202   001506 701000 1                  TSX1    IRD$DODUMP
         1 001203   001204 702000 1                  TSX2    NXTPGTBL

   1818  1 001204                       NXTPGTBL     null
      438     1819    2   NXTPGTBL: ;
      439     1820    2           END;

   1820  1 001204   200003 235100                    LDA     I,,AUTO
         1 001205   000001 035007                    ADLA    1,DL
         1 001206   200003 755100                    STA     I,,AUTO
         1 001207   200003 235100                    LDA     I,,AUTO
         1 001210   000013 115007                    CMPA    11,DL
         1 001211   001202 602000 1                  TNC     s:1818

PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:67   
      440     1821
      441     1822    2      DO I=%JITPG TO %HJITPG;

   1822  1 001212   000013 236007                    LDQ     11,DL
         1 001213   200003 756100                    STQ     I,,AUTO

      442     1823    2           CALL IRD$DODUMP    ALTRET(NEXTJIT);

   1823  1 001214   001506 701000 1                  TSX1    IRD$DODUMP
         1 001215   001216 702000 1                  TSX2    NEXTJIT

   1823  1 001216                       NEXTJIT      null
      443     1824    2   NEXTJIT: ;                              /*SHOULD TYPE ERR MSGS HERE           */
      444     1825    2           END;

   1825  1 001216   200003 235100                    LDA     I,,AUTO
         1 001217   000001 035007                    ADLA    1,DL
         1 001220   200003 755100                    STA     I,,AUTO
         1 001221   000016 115007                    CMPA    14,DL
         1 001222   001214 602000 1                  TNC     s:1823

      445     1826
      446     1827
      447     1828
      448     1829                                      /*WRITE PAGES REQUESTED VIA THE SCREECH CODE    */
      449     1830
      450     1831    1      IF SC.FMBUF# = '1'B

   1831  1 001223   200023 236100                    LDQ     SC+1,,AUTO
         1 001224   002000 316007                    CANQ    1024,DL
         1 001225   001237 600000 1                  TZE     s:1838

      451     1832    2      THEN DO;

      452     1833    3           DO I=%FMSEGLO TO %FMSEGHI;

   1833  1 001226   000020 235007                    LDA     16,DL
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:68   
         1 001227   200003 755100                    STA     I,,AUTO

      453     1834    3                CALL IRD$DODUMP;

   1834  1 001230   001506 701000 1                  TSX1    IRD$DODUMP
         1 001231   000000 011000                    NOP     0

      454     1835    3                END;

   1835  1 001232   200003 235100                    LDA     I,,AUTO
         1 001233   000001 035007                    ADLA    1,DL
         1 001234   200003 755100                    STA     I,,AUTO
         1 001235   000057 115007                    CMPA    47,DL
         1 001236   001230 602000 1                  TNC     s:1834

      455     1836    2           END;

      456     1837
      457     1838    1      IF SC.ROSEG# = '1'B

   1838  1 001237   200023 236100                    LDQ     SC+1,,AUTO
         1 001240   001000 316007                    CANQ    512,DL
         1 001241   001253 600000 1                  TZE     s:1845

      458     1839    2      THEN DO;

      459     1840    3           DO I=%ROSEGLO TO %ROSEGHI;

   1840  1 001242   000057 235007                    LDA     47,DL
         1 001243   200003 755100                    STA     I,,AUTO

      460     1841    3                CALL IRD$DODUMP;

   1841  1 001244   001506 701000 1                  TSX1    IRD$DODUMP
         1 001245   000000 011000                    NOP     0

      461     1842    3                END;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:69   

   1842  1 001246   200003 235100                    LDA     I,,AUTO
         1 001247   000001 035007                    ADLA    1,DL
         1 001250   200003 755100                    STA     I,,AUTO
         1 001251   000075 115007                    CMPA    61,DL
         1 001252   001244 602000 1                  TNC     s:1841

      462     1843    2           END;

      463     1844
      464     1845    1      IF SC.ISEG# = '1'B

   1845  1 001253   200023 236100                    LDQ     SC+1,,AUTO
         1 001254   000400 316007                    CANQ    256,DL
         1 001255   001267 600000 1                  TZE     s:1852

      465     1846    2      THEN DO;

      466     1847    3           DO I=%ISEGLO TO %ISEGHI;

   1847  1 001256   000100 235007                    LDA     64,DL
         1 001257   200003 755100                    STA     I,,AUTO

      467     1848    3                CALL IRD$DODUMP;

   1848  1 001260   001506 701000 1                  TSX1    IRD$DODUMP
         1 001261   000000 011000                    NOP     0

      468     1849    3                END;

   1849  1 001262   200003 235100                    LDA     I,,AUTO
         1 001263   000001 035007                    ADLA    1,DL
         1 001264   200003 755100                    STA     I,,AUTO
         1 001265   000500 115007                    CMPA    320,DL
         1 001266   001260 602000 1                  TNC     s:1848

      469     1850    2           END;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:70   

      470     1851
      471     1852    1      IF SC.SPBUF# = '1'B

   1852  1 001267   200023 236100                    LDQ     SC+1,,AUTO
         1 001270   004000 316007                    CANQ    2048,DL
         1 001271   001303 600000 1                  TZE     s:1859

      472     1853    2      THEN DO;

      473     1854    3           DO I=%SBUF2PG TO %SBUF1PG;

   1854  1 001272   000500 235007                    LDA     320,DL
         1 001273   200003 755100                    STA     I,,AUTO

      474     1855    3                CALL IRD$DODUMP;

   1855  1 001274   001506 701000 1                  TSX1    IRD$DODUMP
         1 001275   000000 011000                    NOP     0

      475     1856    3                END;

   1856  1 001276   200003 235100                    LDA     I,,AUTO
         1 001277   000001 035007                    ADLA    1,DL
         1 001300   200003 755100                    STA     I,,AUTO
         1 001301   000502 115007                    CMPA    322,DL
         1 001302   001274 602000 1                  TNC     s:1855

      476     1857    2           END;

      477     1858
      478     1859    1      IF SC.DBSEG# = '1'B

   1859  1 001303   200023 236100                    LDQ     SC+1,,AUTO
         1 001304   000100 316007                    CANQ    64,DL
         1 001305   001317 600000 1                  TZE     s:1866

PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:71   
      479     1860    2      THEN DO;

      480     1861    3           DO I=%DBDSEGLO TO %DBDSEGHI;

   1861  1 001306   000510 235007                    LDA     328,DL
         1 001307   200003 755100                    STA     I,,AUTO

      481     1862    3                CALL IRD$DODUMP;

   1862  1 001310   001506 701000 1                  TSX1    IRD$DODUMP
         1 001311   000000 011000                    NOP     0

      482     1863    3                END;

   1863  1 001312   200003 235100                    LDA     I,,AUTO
         1 001313   000001 035007                    ADLA    1,DL
         1 001314   200003 755100                    STA     I,,AUTO
         1 001315   000610 115007                    CMPA    392,DL
         1 001316   001310 602000 1                  TNC     s:1862

      483     1864    2           END;

      484     1865
      485     1866    1      IF SC.ASLSEG# = '1'B

   1866  1 001317   200023 236100                    LDQ     SC+1,,AUTO
         1 001320   000040 316007                    CANQ    32,DL
         1 001321   001333 600000 1                  TZE     s:1873

      486     1867    2      THEN DO;

      487     1868    3           DO I=%ASLSEGLO TO %ASLSEGHI;

   1868  1 001322   000610 235007                    LDA     392,DL
         1 001323   200003 755100                    STA     I,,AUTO

      488     1869    3                CALL IRD$DODUMP;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:72   

   1869  1 001324   001506 701000 1                  TSX1    IRD$DODUMP
         1 001325   000000 011000                    NOP     0

      489     1870    3                END;

   1870  1 001326   200003 235100                    LDA     I,,AUTO
         1 001327   000001 035007                    ADLA    1,DL
         1 001330   200003 755100                    STA     I,,AUTO
         1 001331   001010 115007                    CMPA    520,DL
         1 001332   001324 602000 1                  TNC     s:1869

      490     1871    2           END;

      491     1872
      492     1873    1      IF SC.CPSEG# = '1'B

   1873  1 001333   200023 236100                    LDQ     SC+1,,AUTO
         1 001334   000020 316007                    CANQ    16,DL
         1 001335   001347 600000 1                  TZE     s:1880

      493     1874    2      THEN DO;

      494     1875    3           DO I=%CPDSEGLO TO %CPDSEGHI;

   1875  1 001336   001010 235007                    LDA     520,DL
         1 001337   200003 755100                    STA     I,,AUTO

      495     1876    3                CALL IRD$DODUMP;

   1876  1 001340   001506 701000 1                  TSX1    IRD$DODUMP
         1 001341   000000 011000                    NOP     0

      496     1877    3                END;

   1877  1 001342   200003 235100                    LDA     I,,AUTO
         1 001343   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:73   
         1 001344   200003 755100                    STA     I,,AUTO
         1 001345   001050 115007                    CMPA    552,DL
         1 001346   001340 602000 1                  TNC     s:1876

      497     1878    2           END;

      498     1879
      499     1880    2      DO I=%VSPGTBLLO TO %VSPGTBLHI;

   1880  1 001347   001050 236007                    LDQ     552,DL
         1 001350   200003 756100                    STQ     I,,AUTO

      500     1881    2           CALL IRD$DODUMP    ALTRET(NEXTVSPGTBL);

   1881  1 001351   001506 701000 1                  TSX1    IRD$DODUMP
         1 001352   001353 702000 1                  TSX2    NEXTVSPGTBL

      501     1882    2   NEXTVSPGTBL:                       /*DOESN'T MATTER, SINCE MIGHT NOT BE ANY*/
      502     1883    2           END;

   1883  1 001353   200003 235100       NEXTVSPGTBL  LDA     I,,AUTO
         1 001354   000001 035007                    ADLA    1,DL
         1 001355   200003 755100                    STA     I,,AUTO
         1 001356   001130 115007                    CMPA    600,DL
         1 001357   001351 602000 1                  TNC     s:1881

      503     1884    1      IF SC.DDSEG# = '1'B

   1884  1 001360   200023 236100                    LDQ     SC+1,,AUTO
         1 001361   000200 316007                    CANQ    128,DL
         1 001362   001374 600000 1                  TZE     WRDIR

      504     1885    2      THEN DO;

      505     1886    3           DO I=%UDSEGLO TO 1023;          /*%UDSEGHI needs more PT in buffer*/

   1886  1 001363   001130 235007                    LDA     600,DL
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:74   
         1 001364   200003 755100                    STA     I,,AUTO

      506     1887    3                CALL IRD$DODUMP;

   1887  1 001365   001506 701000 1                  TSX1    IRD$DODUMP
         1 001366   000000 011000                    NOP     0

      507     1888    3                END;

   1888  1 001367   200003 235100                    LDA     I,,AUTO
         1 001370   000001 035007                    ADLA    1,DL
         1 001371   200003 755100                    STA     I,,AUTO
         1 001372   002000 115007                    CMPA    1024,DL
         1 001373   001365 602000 1                  TNC     s:1887

      508     1889    2           END;

   1884  1 001374                       WRDIR        null
      509     1890
      510     1891    1   WRDIR: ;
      511     1892                                 /* REWRITE THE PG TABLE WITH THE %SCRCVR FLAGS SET   */
      512     1893    1      POBUF.WSQD = RV_WSQD;

   1893  1 001374   010000 220003                    LDX0    4096,DU
         1 001375   000040 100440                    MLR     fill='000'O
         1 001376   000000 000010 xsym               ADSC9   RV_WSQD                  cn=0,n=*X0
         1 001377   000000 000010 xsym               ADSC9   POBUF                    cn=0,n=*X0

      513     1894    1      RV_WDGRAN = RV_ENTRY.DA;

   1894  1 001400   000000 235000 xsym               LDA     RV_ENTRY
         1 001401   000000 755000 xsym               STA     RV_WDGRAN

      514     1895    1      CALL IRR$WWSQD  ALTRET(ZAPDIR);

   1895  1 001402   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001403   000000 701000 xent               TSX1    IRR$WWSQD
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:75   
         1 001404   001422 702000 1                  TSX2    ZAPDIR

   1894  1 001405                       SET_USRDIR   null
      515     1896
      516     1897    1   SET_USRDIR: ;
      517     1898    1      RV_USRDIR.USER(RV_CUN) = RV_ENTRY;

   1898  1 001405   000000 235000 xsym               LDA     RV_CUN
         1 001406   000001 735000                    ALS     1
         1 001407   000000 620005                    EAX0    0,AL
         1 001410   000000 237000 xsym               LDAQ    RV_ENTRY
         1 001411   000000 757010 xsym               STAQ    RV_USRDIR,X0

      518     1899    1      RV_USRDIR.USER.TYP(RV_CUN) = RV_USRTYP;

   1899  1 001412   000000 236000 xsym               LDQ     RV_USRTYP
         1 001413   000001 676010 xsym               ERQ     RV_USRDIR+1,X0
         1 001414   000777 376003                    ANQ     511,DU
         1 001415   000001 656010 xsym               ERSQ    RV_USRDIR+1,X0

      519     1900    1      RV_BUFF.SIZE = RV_BUFF.SIZE + RV_ENTRY.SZ;

   1900  1 001416   000001 236000 xsym               LDQ     RV_ENTRY+1
         1 001417   777777 376007                    ANQ     -1,DL
         1 001420   000002 036000 xsym               ADLQ    RV_BUFF+2
         1 001421   000002 756000 xsym               STQ     RV_BUFF+2

   1900  1 001422                       ZAPDIR       null
      520     1901    1   ZAPDIR: ;
      521     1902    1      RETURN;

   1902  1 001422   000000 702200 xent               TSX2  ! X66_ARET

      522     1903
      523     1904
      524     1905
      525     1906        %EJECT;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:76   
      526     1907        /*F*   NAME:  IRD$DUMPMP
      527     1908               PURPOSE:  To dump the Monitor Procedure
      528     1909        */
      529     1910    1   IRD$DUMPMP: ENTRY;

   1910  1 001423   000000 700200 xent  IRD$DUMPMP   TSX0  ! X66_AUTO_0
         1 001424   000030 000000                    ZERO    24,0

      530     1911    1      SC=RV_SCODEA;

   1911  1 001425   000000 237000 xsym               LDAQ    RV_SCODEA
         1 001426   200022 757100                    STAQ    SC,,AUTO

      531     1912    1      REMEMBER SO_WHAT IN RV_UNWIND1;

   1912  1 001427   001477 635000 1                  EAA     SO_WHAT
         1 001430   000000 452400 xsym               STP2    RV_UNWIND1
         1 001431   000001 755000 xsym               STA     RV_UNWIND1+1

   1911  1 001432                       DUMP_MPROC   null
      532     1913
      533     1914    1   DUMP_MPROC: ;
      534     1915    1      REMEMBER DUMP_MPROC IN BAD_GRAN;

   1915  1 001432   001432 635000 1                  EAA     DUMP_MPROC
         1 001433   200014 452500                    STP2    BAD_GRAN,,AUTO
         1 001434   200015 755100                    STA     BAD_GRAN+1,,AUTO

      535     1916    1      REMEMBER SO_WHAT IN NO_ROOM;

   1916  1 001435   001477 635000 1                  EAA     SO_WHAT
         1 001436   200016 452500                    STP2    NO_ROOM,,AUTO
         1 001437   200017 755100                    STA     NO_ROOM+1,,AUTO

      536     1917    1      RV_WSQD = I$MPGTBL$->B$DPAGE.WSQD;

   1917  1 001440   000000 470400 xsym               LDP0    I$MPGTBL$
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:77   
         1 001441   010000 220003                    LDX0    4096,DU
         1 001442   000040 100540                    MLR     fill='000'O
         1 001443   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 001444   000000 000010 xsym               ADSC9   RV_WSQD                  cn=0,n=*X0

      537     1918    1      RV_ENTRY='0'B;

   1918  1 001445   000000 235003                    LDA     0,DU
         1 001446   000000 236003                    LDQ     0,DU
         1 001447   000000 757000 xsym               STAQ    RV_ENTRY

      538     1919    1      RV_ENTRY.DA = RV_NXTGRAN;

   1919  1 001450   000000 235000 xsym               LDA     RV_NXTGRAN
         1 001451   000000 755000 xsym               STA     RV_ENTRY

      539     1920    1      IF (SC.MPROC#)

   1920  1 001452   200023 236100                    LDQ     SC+1,,AUTO
         1 001453   000002 316003                    CANQ    2,DU
         1 001454   001470 600000 1                  TZE     s:1927

      540     1921    2      THEN DO;

      541     1922    3           DO I=MONPLL TO %ISEGHI;

   1922  1 001455   000000 235000 xsym               LDA     MONPLL
         1 001456   200003 755100                    STA     I,,AUTO
         1 001457   001465 710000 1                  TRA     s:1924+3

      542     1923    3                CALL IRD$DODUMP;

   1923  1 001460   001506 701000 1                  TSX1    IRD$DODUMP
         1 001461   000000 011000                    NOP     0

      543     1924    3                END;

PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:78   
   1924  1 001462   200003 235100                    LDA     I,,AUTO
         1 001463   000001 035007                    ADLA    1,DL
         1 001464   200003 755100                    STA     I,,AUTO
         1 001465   000500 115007                    CMPA    320,DL
         1 001466   001460 602000 1                  TNC     s:1923

      544     1925    2           END;

   1925  1 001467   001477 710000 1                  TRA     SO_WHAT

      545     1926    2      ELSE DO;

      546     1927    2           I=(RV_BUFF.SSFRAME.IC/1024)+%ISEGLO;

   1927  1 001470   000044 236000 xsym               LDQ     RV_BUFF+36
         1 001471   000022 772000                    QRL     18
         1 001472   000012 772000                    QRL     10
         1 001473   000100 036007                    ADLQ    64,DL
         1 001474   200003 756100                    STQ     I,,AUTO

      547     1928    2           CALL IRD$DODUMP;

   1928  1 001475   001506 701000 1                  TSX1    IRD$DODUMP
         1 001476   000000 011000                    NOP     0

      548     1929    2           END;

   1920  1 001477                       SO_WHAT      null
      549     1930
      550     1931    1   SO_WHAT: ;
      551     1932    1      RV_BUFF.MONPROC = RV_ENTRY;

   1932  1 001477   000000 237000 xsym               LDAQ    RV_ENTRY
         1 001500   000342 757000 xsym               STAQ    RV_BUFF+226

      552     1933    1      RV_BUFF.SIZE = RV_BUFF.SIZE + RV_ENTRY.SZ;

PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:79   
   1933  1 001501   000001 236000 xsym               LDQ     RV_ENTRY+1
         1 001502   777777 376007                    ANQ     -1,DL
         1 001503   000002 036000 xsym               ADLQ    RV_BUFF+2
         1 001504   000002 756000 xsym               STQ     RV_BUFF+2

      553     1934    1      RETURN;

   1934  1 001505   000000 702200 xent               TSX2  ! X66_ARET

      554     1935
      555     1936
      556     1937        %EJECT;
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:80   
      557     1938        /*I*   NAME:  IRD$DODUMP
      558     1939               PURPOSE:  To build the DCW and call IRR$WDUMP for
      559     1940                         each page that is to be written to any
      560     1941                         section of the dump area.
      561     1942        */
      562     1943
      563     1944    1   IRD$DODUMP: PROC ALTRET;

   1944  1 001506   200024 741300       IRD$DODUMP   STX1  ! SC+2,,AUTO

      564     1945
      565     1946    2      NO_PAGE = 0;

   1946  1 001507   200010 450100                    STZ     NO_PAGE,,AUTO

      566     1947    2      PGTBL_BAD = 0;

   1947  1 001510   200011 450100                    STZ     PGTBL_BAD,,AUTO

      567     1948
      568     1949    2      IF (RV_WSQD.PG.RPN(I)=FPMC.RPN)

   1949  1 001511   200003 720100                    LXL0    I,,AUTO
         1 001512   000000 222010 xsym               LDX2    RV_WSQD,X0
         1 001513   000000 102000 xsym               CMPX2   FPMC
         1 001514   001520 601000 1                  TNZ     s:1954

      569     1950    3      THEN DO;

      570     1951    3           NO_PAGE = 1;

   1951  1 001515   000001 235007                    LDA     1,DL
         1 001516   200010 755100                    STA     NO_PAGE,,AUTO

      571     1952    3           ALTRETURN;

   1952  1 001517   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:81   

      572     1953    3           END;
      573     1954    2      DOIT = '0'B;

   1954  1 001520   200021 450100                    STZ     DOIT,,AUTO

      574     1955    2      IF S1000_FLG THEN                    /* HW_WSQ0PT                          */

   1955  1 001521   000000 235000 xsym               LDA     S1000_FLG
         1 001522   001552 600000 1                  TZE     s:1958

      575     1956    2           IF ((B$IPHYMAP$->B$HALF(RV_WSQD.PG.RPN(I))<=3) OR (B$IPHYMAP$->B$HALF(
              1956                    RV_WSQD.PG.RPN(I))>IS_PPUT_SIZE) ) THEN DOIT = '1'B;ELSE;

   1956  1 001523   000000 236010 xsym               LDQ     RV_WSQD,X0
         1 001524   000022 772000                    QRL     18
         1 001525   000001 736000                    QLS     1
         1 001526   000000 470400 xsym               LDP0    B$IPHYMAP$
         1 001527   000100 101506                    MRL     fill='000'O
         1 001530   000000 000002                    ADSC9   0,Q,PR0                  cn=0,n=2
         1 001531   200026 000004                    ADSC9   SC+4,,AUTO               cn=0,n=4
         1 001532   200026 236100                    LDQ     SC+4,,AUTO
         1 001533   000004 116007                    CMPQ    4,DL
         1 001534   001547 604000 1                  TMI     s:1956+20
         1 001535   000000 236010 xsym               LDQ     RV_WSQD,X0
         1 001536   000022 772000                    QRL     18
         1 001537   000001 736000                    QLS     1
         1 001540   000100 101506                    MRL     fill='000'O
         1 001541   000000 000002                    ADSC9   0,Q,PR0                  cn=0,n=2
         1 001542   200027 000004                    ADSC9   SC+5,,AUTO               cn=0,n=4
         1 001543   200027 236100                    LDQ     SC+5,,AUTO
         1 001544   000000 116000 xsym               CMPQ    IS_PPUT_SIZE
         1 001545   001563 602000 1                  TNC     s:1959
         1 001546   001563 600000 1                  TZE     s:1959

   1956  1 001547   400000 236003                    LDQ     -131072,DU
         1 001550   200021 756100                    STQ     DOIT,,AUTO
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:82   
         1 001551   001563 710000 1                  TRA     s:1959

      576     1957    2      ELSE
      577     1958    2           IF (RV_WSQD.PG.RPN(I)<=3 OR RV_WSQD.PG.RPN(I)>IS_PPUT_SIZE) THEN DOIT='1'B;

   1958  1 001552   000004 102003                    CMPX2   4,DU
         1 001553   001561 602000 1                  TNC     s:1958+7
         1 001554   000000 236010 xsym               LDQ     RV_WSQD,X0
         1 001555   000022 772000                    QRL     18
         1 001556   000000 116000 xsym               CMPQ    IS_PPUT_SIZE
         1 001557   001563 602000 1                  TNC     s:1959
         1 001560   001563 600000 1                  TZE     s:1959

   1958  1 001561   400000 236003                    LDQ     -131072,DU
         1 001562   200021 756100                    STQ     DOIT,,AUTO

      578     1959    2      IF ( DOIT )

   1959  1 001563   200021 234100                    SZN     DOIT,,AUTO
         1 001564   001570 605000 1                  TPL     s:1964

      579     1960    3      THEN DO;

      580     1961    3           PGTBL_BAD = 1;

   1961  1 001565   000001 236007                    LDQ     1,DL
         1 001566   200011 756100                    STQ     PGTBL_BAD,,AUTO

      581     1962    3           ALTRETURN;

   1962  1 001567   000000 702211                    TSX2  ! 0,X1

      582     1963    3           END;
      583     1964    2      IF (RV_WSQD.PG.SFLG(I) & %SCCVM)

   1964  1 001570   000000 236010 xsym               LDQ     RV_WSQD,X0
         1 001571   000022 736000                    QLS     18
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:83   
         1 001572   777400 376003                    ANQ     -256,DU
         1 001573   001000 376003                    ANQ     512,DU
         1 001574   001605 601000 1                  TNZ     DUMP_CVM

      584     1965    2      THEN GOTO DUMP_CVM;
      585     1966    2      IF USER_DUMP ~= 0

   1966  1 001575   200012 236100                    LDQ     USER_DUMP,,AUTO
         1 001576   001605 600000 1                  TZE     DUMP_CVM

      586     1967    2      THEN IF ( (RV_WSQD.PG.SFLG(I) & (%SCUSER | %SCFPOOL)) = '0'B)

   1967  1 001577   000000 236010 xsym               LDQ     RV_WSQD,X0
         1 001600   000022 736000                    QLS     18
         1 001601   777400 376003                    ANQ     -256,DU
         1 001602   002400 376003                    ANQ     1280,DU
         1 001603   001605 601000 1                  TNZ     DUMP_CVM

      587     1968    2           THEN ALTRETURN;                 /*DONT DUMP SHARED PROC PAGES         */

   1968  1 001604   000000 702211                    TSX2  ! 0,X1

   1966  1 001605                       DUMP_CVM     null
      588     1969
      589     1970    2   DUMP_CVM: ;
      590     1971    2      IF S1000_FLG THEN                    /* HW_WSQ0PT                          */

   1971  1 001605   000000 115003                    CMPA    0,DU
         1 001606   001622 600000 1                  TZE     s:1974

      591     1972    2           RV_BAPAGE = (B$IPHYMAP$->B$HALF(RV_WSQD.PG.RPN(I)) * 4096);

   1972  1 001607   000000 236010 xsym               LDQ     RV_WSQD,X0
         1 001610   000022 772000                    QRL     18
         1 001611   000001 736000                    QLS     1
         1 001612   000000 470400 xsym               LDP0    B$IPHYMAP$
         1 001613   000100 101506                    MRL     fill='000'O
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:84   
         1 001614   000000 000002                    ADSC9   0,Q,PR0                  cn=0,n=2
         1 001615   200026 000004                    ADSC9   SC+4,,AUTO               cn=0,n=4
         1 001616   200026 236100                    LDQ     SC+4,,AUTO
         1 001617   000014 736000                    QLS     12
         1 001620   000000 756000 xsym               STQ     RV_BAPAGE
         1 001621   001626 710000 1                  TRA     s:1975

      592     1973    2      ELSE
      593     1974    2           RV_BAPAGE = (RV_WSQD.PG.RPN(I) * 4096);

   1974  1 001622   000000 236010 xsym               LDQ     RV_WSQD,X0
         1 001623   000006 772000                    QRL     6
         1 001624   000002 376000 2                  ANQ     2
         1 001625   000000 756000 xsym               STQ     RV_BAPAGE

      594     1975    2      CALL IRR$WDUMP  ALTRET(DODUMP_ALT);

   1975  1 001626   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001627   000000 701000 xent               TSX1    IRR$WDUMP
         1 001630   001647 702000 1                  TSX2    DODUMP_ALT

      595     1976    2      RV_ENTRY.SZ = RV_ENTRY.SZ+1;

   1976  1 001631   000001 720000 xsym               LXL0    RV_ENTRY+1
         1 001632   000001 621010                    EAX1    1,X0
         1 001633   000001 441000 xsym               SXL1    RV_ENTRY+1

      596     1977    2      RV_WSQD.PG.SFLG(I) = (RV_WSQD.PG.SFLG(I) | %SCRCVR);

   1977  1 001634   200003 720100                    LXL0    I,,AUTO
         1 001635   000000 236010 xsym               LDQ     RV_WSQD,X0
         1 001636   000022 736000                    QLS     18
         1 001637   777400 376003                    ANQ     -256,DU
         1 001640   200000 276003                    ORQ     65536,DU
         1 001641   000022 772000                    QRL     18
         1 001642   000000 676010 xsym               ERQ     RV_WSQD,X0
         1 001643   777400 376007                    ANQ     -256,DL
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:85   
         1 001644   000000 656010 xsym               ERSQ    RV_WSQD,X0

      597     1978    2      RETURN;

   1978  1 001645   200024 221300                    LDX1  ! SC+2,,AUTO
         1 001646   000001 702211                    TSX2  ! 1,X1

   1977  1 001647                       DODUMP_ALT   null
      598     1979    2   DODUMP_ALT: ;
      599     1980    2      IF RV_PDUMP ~= 0 THEN UNWIND TO NO_ROOM;

   1980  1 001647   000000 235000 xsym               LDA     RV_PDUMP
         1 001650   001654 600000 1                  TZE     s:1982

   1980  1 001651   200016 237300                    LDAQ  ! NO_ROOM,,AUTO
         1 001652   000000 700200 xent               TSX0  ! X66_AUNWIND
         1 001653   000000 000200                    ZERO    0,128

      600     1981                                                /* DUMP AREA EXCEEDED                 */
      601     1982    2      ELSE UNWIND TO BAD_GRAN;

   1982  1 001654   200014 237300                    LDAQ  ! BAD_GRAN,,AUTO
         1 001655   000000 700200 xent               TSX0  ! X66_AUNWIND
         1 001656   000000 000200                    ZERO    0,128
      602     1983    2   END IRD$DODUMP;
      603     1984
      604     1985
      605     1986
      606     1987    1   END IRD$DUMP;
      607     1988        %EOD;

PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:86   
--  Include file information  --

   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   M_INFO_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   IR_DATA_M.:E05TOU  is referenced.
   JS_CP6.:E05TOU  is referenced.
      No diagnostics issued in procedure IRD$DUMP.
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:87   

 **** Variables and constants ****

  ****  Section 000 RoData IRD$DUMP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(24)    r     1 RVM_MONJIT                 6-0-0/c CHAR(24)    r     1 RVM_USRJIT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    14-0-0/d REMB        r     1 BAD_GRAN                   6-0-0/w UBIN        r     1 CINDEX
     7-0-0/w PTR         r     1 CWSQD$                    21-0-0/w BIT         r     1 DOIT
     3-0-0/w UBIN        r     1 I                          4-0-0/w UBIN        r     1 J
     5-0-0/w UBIN        r     1 K                         10-0-0/w UBIN        r     1 NO_PAGE
    16-0-0/d REMB        r     1 NO_ROOM                   11-0-0/w UBIN        r     1 PGTBL_BAD
    22-0-0/d STRC(72)    r     1 SC                        12-0-0/w UBIN        r     1 USER_DUMP

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$IPHYMAP$                 0-0-0/w STRC        r     1 FPMC
     0-0-0/w PTR         r     1 I$MEM$                     0-0-0/w PTR         r     1 I$MPGTBL$
     0-0-0/w PTR         r     1 I$UPGTBL$                  0-0-0/w UBIN        r     1 IS_PPUT_SIZE
     0-0-0/w STRC(72)    r     1 MEMDESC                    0-0-0/w SBIN        r     1 MONPLL
     0-0-0/b STRC(36864) r     1 POBUF                      0-0-0/w PTR         r     1 R$CU$
     0-0-0/w BIT         r     1 RPM_FLG                    0-0-0/w SBIN        r     1 RV_BAPAGE
     0-0-0/d STRC(36864) r     1 RV_BUFF                    0-0-0/w SBIN        r     1 RV_CPNO
     0-0-0/w SBIN        r     1 RV_CUN                     0-0-0/d STRC(72)    r     1 RV_ENTRY
     0-0-0/w SBIN        r     1 RV_NXTGRAN                 0-0-0/w SBIN        r     1 RV_PDUMP
     0-0-0/d BIT (72)    r     1 RV_SCODEA
     0-0-0/w SBIN        r     1 RV_SCPUJIT(0:7)
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:88   
     0-0-0/d REMB        r     1 RV_UNWIND1                 0-0-0/d STRC(36864) r     1 RV_USRDIR
     0-0-0/w UBIN(18)    r     1 RV_USRTYP                  0-0-0/w SBIN        r     1 RV_WDGRAN
     0-0-0/d STRC(36864) r     1 RV_WSQD                    0-0-0/w BIT         r     1 S1000_FLG
     0-0-0/w BIT         r     1 XA_MODE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w BIT         r     1 B$256(0:255)               0-0-0/w STRC(9216)  r     1 B$CWSQD
     0-0-0/w STRC(36864) r     1 B$DPAGE                    0-0-0/h UBIN(18)    r     1 B$HALF(0:0)
     0-0-0/d STRC(576)   r     1 B$U                        0-0-0/d STRC(36864) r     1 B$WSQD


   Procedure IRD$DUMP requires 943 words for executable code.
   Procedure IRD$DUMP requires 24 words of local(AUTO) storage.
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:89   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:90   
          MINI XREF LISTING

B$256
      1355**DCL      1689<<ASSIGN
B$CWSQD
      1479**DCL      1683>>ASSIGN
B$DO.ECCINFO
      1242**DCL      1243--REDEF
B$DPAGE.WSQD
      1477**DCL      1782>>ASSIGN   1917>>ASSIGN
B$HALF
      1351**DCL      1661>>IF       1661>>IF       1679>>ASSIGN   1719>>IF       1719>>IF       1736>>ASSIGN
      1803>>ASSIGN   1805>>ASSIGN   1956>>IF       1956>>IF       1972>>ASSIGN
B$IPHYMAP$
      1347**DCL      1661>>IF       1661>>IF       1679>>ASSIGN   1719>>IF       1719>>IF       1736>>ASSIGN
      1803>>ASSIGN   1805>>ASSIGN   1956>>IF       1956>>IF       1972>>ASSIGN
B$U.MISC
      1221**DCL      1222--REDEF
B$U.PT
      1215**DCL      1803>>ASSIGN   1805>>ASSIGN   1807>>ASSIGN
B$USER.MISC
      1297**DCL      1298--REDEF
B$WSQD
      1471**DCL      1492>>ASSIGN   1739>>ASSIGN
B$WSQD.PG.RPN
      1471**DCL      1661>>IF       1661>>IF       1661>>IF       1665>>IF       1665>>IF       1665>>IF
      1679>>ASSIGN   1681>>ASSIGN   1719>>IF       1719>>IF       1719>>IF       1723>>IF       1723>>IF
      1723>>IF       1736>>ASSIGN   1738>>ASSIGN
B$WSQD.PG.SFLG
      1471**DCL      1471--REDEF
BAD_GRAN
        20**DCL      1489<<REMEMBR  1655<<REMEMBR  1712<<REMEMBR  1777<<REMEMBR  1915<<REMEMBR  1982>>UNWIND
CINDEX
        14**DCL      1657<<ASSIGN   1692>>ASSIGN   1695<<ASSIGN   1695>>ASSIGN   1699<<ASSIGN   1699>>ASSIGN
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:91   
CWSQD$
        16**DCL      1671<<ASSIGN   1683>>ASSIGN   1696<<ASSIGN   1696>>ASSIGN
DODUMP_ALT IN PROCEDURE IRD$DODUMP
      1977**LABEL    1975--CALLALT
DOIT
      1352**DCL      1659<<ASSIGN   1663<<ASSIGN   1667<<ASSIGN   1668>>IF       1717<<ASSIGN   1721<<ASSIGN
      1725<<ASSIGN   1726>>IF       1954<<ASSIGN   1956<<ASSIGN   1958<<ASSIGN   1959>>IF
DUMP_AGAIN
      1480**LABEL    1489--REMEMBR
DUMP_CVM IN PROCEDURE IRD$DODUMP
      1966**LABEL    1965--GOTO
DUMP_MPROC
      1911**LABEL    1915--REMEMBR
FPMC.RPN
      1360**DCL      1661>>IF       1665>>IF       1719>>IF       1723>>IF       1949>>IF
GIVEUP_CGDATA
      1742**LABEL    1710--REMEMBR  1711--REMEMBR  1744--GOTO
GIVEUP_CWSQ
      1685**LABEL    1653--REMEMBR  1654--REMEMBR
I
        11**DCL      1499<<ASSIGN   1529<<DOINDEX  1538<<ASSIGN   1552<<DOINDEX  1558<<DOINDEX  1565<<DOINDEX
      1572<<DOINDEX  1577<<DOINDEX  1583<<DOINDEX  1590<<DOINDEX  1597<<DOINDEX  1604<<DOINDEX  1611<<DOINDEX
      1618<<DOINDEX  1625<<DOINDEX  1632<<DOINDEX  1684<<DOINDEX  1742<<DOINDEX  1743>>IF       1746>>IF
      1786<<ASSIGN   1817<<DOINDEX  1822<<DOINDEX  1833<<DOINDEX  1840<<DOINDEX  1847<<DOINDEX  1854<<DOINDEX
      1861<<DOINDEX  1868<<DOINDEX  1875<<DOINDEX  1880<<DOINDEX  1886<<DOINDEX  1922<<DOINDEX  1927<<ASSIGN
      1949>>IF       1956>>IF       1956>>IF       1958>>IF       1958>>IF       1964>>IF       1967>>IF
      1972>>ASSIGN   1974>>ASSIGN   1977>>ASSIGN   1977>>ASSIGN
I$MEM$
      1344**DCL      1492>>ASSIGN   1671>>ASSIGN   1739>>ASSIGN
I$MPGTBL$
      1345**DCL      1661>>IF       1661>>IF       1661>>IF       1665>>IF       1665>>IF       1665>>IF
      1679>>ASSIGN   1681>>ASSIGN   1719>>IF       1719>>IF       1719>>IF       1723>>IF       1723>>IF
      1723>>IF       1736>>ASSIGN   1738>>ASSIGN   1917>>ASSIGN
I$UPGTBL$
      1346**DCL      1782>>ASSIGN
IRD$DODUMP
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:92   
      1944**PROC     1500--CALL     1530--CALL     1539--CALL     1553--CALL     1559--CALL     1566--CALL
      1573--CALL     1578--CALL     1584--CALL     1591--CALL     1598--CALL     1605--CALL     1612--CALL
      1619--CALL     1626--CALL     1633--CALL     1685--CALL     1747--CALL     1787--CALL     1818--CALL
      1823--CALL     1834--CALL     1841--CALL     1848--CALL     1855--CALL     1862--CALL     1869--CALL
      1876--CALL     1881--CALL     1887--CALL     1923--CALL     1928--CALL
IRR$TYPE6M
      1310**DCL-ENT  1506--CALL     1794--CALL
IRR$WDUMP
      1308**DCL-ENT  1808--CALL     1975--CALL
IRR$WWSQD
      1309**DCL-ENT  1642--CALL     1691--CALL     1753--CALL     1895--CALL
IS_PPUT_SIZE
      1341**DCL      1661>>IF       1665>>IF       1719>>IF       1723>>IF       1956>>IF       1958>>IF
J
        12**DCL      1672<<DOINDEX  1689>>ASSIGN   1714<<ASSIGN   1743>>IF       1754>>ASSIGN   1758<<ASSIGN
      1758>>ASSIGN
K
        13**DCL      1658<<DOINDEX  1661>>IF       1661>>IF       1661>>IF       1665>>IF       1665>>IF
      1665>>IF       1679>>ASSIGN   1681>>ASSIGN   1715<<DOINDEX  1719>>IF       1719>>IF       1719>>IF
      1723>>IF       1723>>IF       1723>>IF       1736>>ASSIGN   1738>>ASSIGN   1746>>IF
MEMDESC.BADDR
      1358**DCL      1491<<ASSIGN   1679<<ASSIGN   1681<<ASSIGN   1736<<ASSIGN   1738<<ASSIGN
MONPLL
      1340**DCL      1552>>DOINDEX  1922>>DOINDEX
MON_MAP_BAD
      1499**LABEL    1490--REMEMBR  1500--CALLALT
NEXTJIT
      1823**LABEL    1823--CALLALT
NEXTVSPGTBL
      1883**LABEL    1881--CALLALT
NOPAGES
      1786**LABEL    1778--REMEMBR  1787--CALLALT
NO_PAGE
        17**DCL      1504>>IF       1792>>IF       1946<<ASSIGN   1951<<ASSIGN
NO_ROOM
        21**DCL      1490<<REMEMBR  1521<<REMEMBR  1525<<REMEMBR  1654<<REMEMBR  1711<<REMEMBR  1778<<REMEMBR
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:93   
      1814<<REMEMBR  1916<<REMEMBR  1980>>UNWIND
NXTJITPG
      1530**LABEL    1530--CALLALT
NXTPGTBL
      1818**LABEL    1818--CALLALT
PGTBL_BAD
        18**DCL      1504>>IF       1792>>IF       1947<<ASSIGN   1961<<ASSIGN
POBUF
      1353**DCL      1688<<ASSIGN
POBUF.WSQD
      1354**DCL      1640<<ASSIGN   1689--ASSIGN   1751<<ASSIGN   1893<<ASSIGN
R$CU$
      1327**DCL      1803>>ASSIGN   1805>>ASSIGN   1807>>ASSIGN
REDUMP_CGDATA
      1725**LABEL    1712--REMEMBR
REDUMP_CWSQ
      1667**LABEL    1655--REMEMBR
RPM_FLG
      1349**DCL      1556>>IF
RVM_MONJIT
      1313**DCL      1506<>CALL     1506--CALL
RVM_USRJIT
      1315**DCL      1794<>CALL     1794--CALL
RV_BAPAGE
      1329**DCL      1803<<ASSIGN   1805<<ASSIGN   1807<<ASSIGN   1972<<ASSIGN   1974<<ASSIGN
RV_BUFF.CGRWSQ
      1449**DCL      1754<<ASSIGN
RV_BUFF.CWSQ
      1448**DCL      1692<<ASSIGN
RV_BUFF.MM_CGQCXT_END
      1438**DCL      1743>>IF
RV_BUFF.MONJITS
      1447**DCL      1541<<ASSIGN
RV_BUFF.MONPROC
      1448**DCL      1932<<ASSIGN
RV_BUFF.MONWSQD
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:94   
      1446**DCL      1644<<ASSIGN
RV_BUFF.SIZE
      1427**DCL      1542<<ASSIGN   1542>>ASSIGN   1645<<ASSIGN   1645>>ASSIGN   1693<<ASSIGN   1693>>ASSIGN
      1755<<ASSIGN   1755>>ASSIGN   1900<<ASSIGN   1900>>ASSIGN   1933<<ASSIGN   1933>>ASSIGN
RV_BUFF.SSFRAME.IC
      1437**DCL      1927>>ASSIGN
RV_BUFF.S_PNO
      1438**DCL      1519>>IF       1536>>IF
RV_CPNO
      1330**DCL      1491>>ASSIGN   1519>>IF       1536>>IF       1541>>ASSIGN
RV_CUN
      1331**DCL      1772>>IF       1796>>ASSIGN   1898>>ASSIGN   1899>>ASSIGN
RV_ENTRY
      1318**DCL      1493<<ASSIGN   1541>>ASSIGN   1644>>ASSIGN   1674<<ASSIGN   1692>>ASSIGN   1730<<ASSIGN
      1754>>ASSIGN   1779<<ASSIGN   1898>>ASSIGN   1918<<ASSIGN   1932>>ASSIGN
RV_ENTRY.BADPT
      1322**DCL      1512<<ASSIGN
RV_ENTRY.DA
      1319**DCL      1494<<ASSIGN   1641>>ASSIGN   1675<<ASSIGN   1690>>ASSIGN   1731<<ASSIGN   1752>>ASSIGN
      1780<<ASSIGN   1894>>ASSIGN   1919<<ASSIGN
RV_ENTRY.SZ
      1325**DCL      1542>>ASSIGN   1645>>ASSIGN   1676<<ASSIGN   1693>>ASSIGN   1732<<ASSIGN   1755>>ASSIGN
      1809<<ASSIGN   1900>>ASSIGN   1933>>ASSIGN   1976<<ASSIGN   1976>>ASSIGN
RV_NXTGRAN
      1332**DCL      1494>>ASSIGN   1675>>ASSIGN   1677<<ASSIGN   1677>>ASSIGN   1731>>ASSIGN   1733<<ASSIGN
      1733>>ASSIGN   1780>>ASSIGN   1919>>ASSIGN
RV_PDUMP
      1333**DCL      1515>>IF       1791>>IF       1980>>IF
RV_SCODEA
      1334**DCL      1495>>ASSIGN   1781>>ASSIGN   1911>>ASSIGN
RV_SCPUJIT
      1335**DCL      1491>>ASSIGN
RV_UNWIND1
      1336**DCL      1522<<REMEMBR  1526<<REMEMBR  1653<<REMEMBR  1710<<REMEMBR  1815<<REMEMBR  1912<<REMEMBR
RV_USRDIR.USER
      1463**DCL      1898<<ASSIGN
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:95   
RV_USRDIR.USER.PGTBL
      1464**DCL      1796<<ASSIGN
RV_USRDIR.USER.SZ
      1464**DCL      1772>>IF
RV_USRDIR.USER.TYP
      1464**DCL      1899<<ASSIGN
RV_USRTYP
      1337**DCL      1899>>ASSIGN
RV_WDGRAN
      1338**DCL      1641<<ASSIGN   1690<<ASSIGN   1752<<ASSIGN   1894<<ASSIGN
RV_WSQD
      1467**DCL      1492<<ASSIGN   1640>>ASSIGN   1682<<ASSIGN   1683<<ASSIGN   1689>>ASSIGN   1739<<ASSIGN
      1751>>ASSIGN   1782<<ASSIGN   1893>>ASSIGN   1917<<ASSIGN
RV_WSQD.PG.RPN
      1467**DCL      1949>>IF       1956>>IF       1956>>IF       1958>>IF       1958>>IF       1972>>ASSIGN
      1974>>ASSIGN
RV_WSQD.PG.SFLG
      1467**DCL      1467--REDEF    1964>>IF       1967>>IF       1977<<ASSIGN   1977>>ASSIGN
S1000_FLG
      1348**DCL      1660>>IF       1678>>IF       1718>>IF       1735>>IF       1804>>IF       1955>>IF
      1971>>IF
SC
      1379**DCL      1495<<ASSIGN   1781<<ASSIGN   1911<<ASSIGN
SC.ASAVE#
      1407**DCL      1588>>IF
SC.ASLSEG#
      1416**DCL      1866>>IF
SC.CFUS#
      1407**DCL      1581>>IF
SC.CGDATA#
      1410**DCL      1708>>IF
SC.CPSEG#
      1416**DCL      1873>>IF
SC.CWSPT#
      1410**DCL      1570>>IF       1651>>IF
SC.DBSEG#
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:96   
      1415**DCL      1859>>IF
SC.DDSEG#
      1415**DCL      1884>>IF
SC.DS4#
      1408**DCL      1602>>IF
SC.DS5#
      1408**DCL      1609>>IF
SC.DS6#
      1408**DCL      1616>>IF
SC.DS7#
      1409**DCL      1623>>IF
SC.ENQ#
      1407**DCL      1595>>IF
SC.FMBUF#
      1414**DCL      1831>>IF
SC.ISEG#
      1415**DCL      1845>>IF
SC.LDCTS#
      1409**DCL      1630>>IF
SC.MPROC#
      1412**DCL      1920>>IF
SC.PMDATA#
      1411**DCL      1563>>IF
SC.ROSEG#
      1414**DCL      1838>>IF
SC.SPBUF#
      1414**DCL      1852>>IF
SET_USRDIR
      1894**LABEL    1810--GOTO
SKIP_1_2
      1746**LABEL    1746--GOTO
SO_WHAT
      1920**LABEL    1912--REMEMBR  1916--REMEMBR
START_OVER
      1772**LABEL    1777--REMEMBR
USER_DUMP
PL6.E3A0      #001=IRD$DUMP File=IRD$DUMP.:E05TSI                                TUE 07/29/97 22:42 Page:97   
        19**DCL      1488<<ASSIGN   1776<<ASSIGN   1966>>IF
WRDIR
      1884**LABEL    1814--REMEMBR  1815--REMEMBR
WRLVA
      1809**LABEL    1788--GOTO
WRMJIT
      1515**LABEL    1501--GOTO
WRMONDIR
      1630**LABEL    1521--REMEMBR  1522--REMEMBR
WRMONENT
      1538**LABEL    1513--GOTO     1525--REMEMBR  1526--REMEMBR
XA_MODE
      1350**DCL      1802>>IF
ZAPDIR
      1900**LABEL    1808--CALLALT  1895--CALLALT
ZAPMDIR
      1645**LABEL    1642--CALLALT
ZAP_CGDATA
      1755**LABEL    1753--CALLALT
ZAP_WSQD
      1693**LABEL    1691--CALLALT

PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:98   
      608        1        /*M*   IRD$DUMP2   Recovery Dump Routines      */
      609        2        /*T***********************************************************/
      610        3        /*T*                                                         */
      611        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      612        5        /*T*                                                         */
      613        6        /*T***********************************************************/
      614        7        /*X*   PLM=3,IND=5     */
      615        8        IRD$DUMP2: PROC;
      616        9
      617       10                                                /* AUTO                               */
      618       11    1   DCL EL_NXT UBIN(36);
      619       12
      620       13    1   DCL BUFF$ PTR;
      621       14    1   DCL I UBIN(36);
      622       15    1   DCL BLKNO UBIN(18);
      623       16    1   DCL JITSZ SBIN;
      624       17    1   DCL JITSPG SBIN;
      625       18                                                /* CONSTANT DATA                      */
      626       19    1   DCL RVM_CFU CONSTANT CHAR(24) INIT(
      627       20    1        'RCVR-TRAP IN IRF$CFUS');
      628       21    1   DCL RVM_CLST CONSTANT CHAR(24) INIT(
      629       22    1        'RCVR-TRAP IN IRF$CLSF');
      630       23    1   DCL RVM_CGQ CONSTANT CHAR(24) INIT(
      631       24    1        'RCVR-TRAP IN IRF$DUMPCG');
      632       25
      633       26    1   DCL 1 RV_ENTRY SYMREF DALIGNED,
      634       27    1         2 DA SBIN,
      635       28    1         2 DTRAP BIT(1) UNAL,
      636       29    1         2 CFTRAP BIT(1) UNAL,
      637       30    1         2 BADPT BIT(1) UNAL,
      638       31    1         2 * BIT(6) UNAL,
      639       32    1         2 TYP UBIN(9) UNAL,
      640       33    1         2 SZ UBIN(18) UNAL;
      641       34
      642       35    1   DCL R$CGCTXT$ PTR SYMREF;
      643       36    1   DCL R$CGPT$ PTR SYMREF;
      644       37    1   DCL R$CU$ PTR SYMREF;
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:99   
      645       38    1   DCL R$USRT$ PTR SYMREF;
      646       39
      647       40    1   DCL RV_BAPAGE SBIN SYMREF;
      648       41    1   DCL RV_CGCTXT BIT(72) SYMREF DALIGNED;
      649       42    1   DCL RV_CGPT BIT(72) SYMREF DALIGNED;
      650       43    1   DCL RV_CPNO SBIN SYMREF;
      651       44    1   DCL RV_CUN SBIN SYMREF;
      652       45    1   DCL RV_MUAIS SBIN SYMREF;
      653       46    1   DCL RV_NSCPU SBIN SYMREF;
      654       47    1   DCL RV_NXTGRAN  SBIN SYMREF;
      655       48    1   DCL RV_PDUMP  SBIN SYMREF;
      656       49    1   DCL RV_SCODEA BIT(72) SYMREF DALIGNED;
      657       50    1   DCL RV_UNWIND1 REMEMBER SYMREF DALIGNED;
      658       51    1   DCL RV_USRTYP UBIN(18) SYMREF;
      659       52    1   DCL RV_USTATE SBIN SYMREF;
      660       53
      661       54                                                /* AARDVARK SYMREFS                   */
      662       55    1   DCL 1 MEMDESC SYMREF,
      663       56    1         2 * BIT(36) UNAL,
      664       57    1         2 BADDR UBIN(36);
      665       58
      666       59    1   DCL I$JITU$ PTR SYMREF;
      667       60    1   DCL I$MEM$ PTR SYMREF;
      668       61    1   DCL I$MONIS$ PTR SYMREF;
      669       62    1   DCL I$RV3$ PTR SYMREF;
      670       63    1   DCL I$RV4$ PTR SYMREF;
      671       64    1   DCL I$PPUT$ PTR SYMREF;
      672       65
      673       66    1   DCL X_DSCR DSCR;         /* 'cause PL6 will complain if I try to shortcut     */
      674       67    1   DCL PPUT_BASE SBIN;
      675       68    1   DCL PPUT_BOUND SBIN;
      676       69
      677       70    1   DCL DESCRV3 BIT(72) DALIGNED SYMREF;
      678       71    1   DCL DESCRV4 BIT(72) DALIGNED SYMREF;
      679       72
      680       73    1   DCL POBUF(0:1023) UBIN(36) SYMREF;
      681       74
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:100  
      682       75                                                /*  AARDVARK ENTRY REFS               */
      683       76    1   DCL IRR$MAP ENTRY;
      684       77    1   DCL IRR$TYPE6M ENTRY(2);
      685       78    1   DCL IRR$WDUMP  ENTRY ALTRET;
      686       79    1   DCL IRR$WUSRDR ENTRY ALTRET;
      687       80    1   DCL IRR$WPOBUFF ENTRY ALTRET;
      688       81    1   DCL IRD$DUMPMON ENTRY;
      689       82    1   DCL IRD$DUMPUSR ENTRY;
      690       83    1   DCL IRF$CLSF ENTRY ALTRET;
      691       84    1   DCL IRF$CFUS ENTRY ALTRET;
      692       85    1   DCL IRF$DUMPCG ENTRY ALTRET;
      693       86                                                /* MONITOR REFS                       */
      694       87        %INCLUDE U$JIT_C;
      695      586    1   DCL B$JIT$ PTR SYMREF;
      696      587        %INCLUDE SS_SCHED_C;
      697      820        %INCLUDE B$USER;
      698     1036
      699     1037    1   DCL 1 B$WSPTD(0:26) BASED ALIGNED,
      700     1038    1         2 BLKNO UBIN(18) UNAL,
      701     1039    1         2 * BIT(2) UNAL,
      702     1040    1         2 P BIT(1) UNAL,
      703     1041    1         2 T BIT(1) UNAL,
      704     1042    1         2 * BIT(6) UNAL,
      705     1043    1         2 NBLKS UBIN(8) UNAL;
      706     1044
      707     1045
      708     1046        %INCLUDE JS_CP6;
      709     1464        %INCLUDE CP_6_SUBS;
      710     2004        %INCLUDE HF_SCODE_C;
      711     2087
      712     2088        %VLP_SCREECH (FPTN=SC,STCLASS=AUTO);
      713     2158        %VLP_SUA (FPTN=SC_CLSTRAP,STCLASS=CONSTANT,CUSR=YES,FMBUF=YES,ROSEG=YES,CFUS=YES);
      714     2228        %VLP_SCODE (FPTN=RV_IOUSERS,STCLASS=CONSTANT,IOUSRS=YES,SPBUF=YES,FMBUF=YES,ROSEG=
              2228            YES);
      715     2289
      716     2290        %VLP_SCODE (FPTN=RV_ALLUSERS,STCLASS=CONSTANT);
      717     2351
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:101  
      718     2352                       /*Generate a Screech Code for ISI$BOOT here in a PL-6 module   */
      719     2353        %VLP_SCREECH (FPTN=RV_OPASCODE,STCLASS=CONSTANT SYMDEF,FCG=IS,MID=I,MON=NO,CODE=
              2353            %S$QAARDVRK);
      720     2423
      721     2424                  /*Generate Screech Code dump bits to use as masks in IRR$RECOVER    */
      722     2425        %VLP_SCODE (FPTN=RV_SLAVES,STCLASS=CONSTANT SYMDEF,SHJIT=YES,CUSRS=YES);
      723     2486        %VLP_SCREECH (FPTN=RV_MONDSEG,STCLASS=CONSTANT SYMDEF,DS4=NO,DS5=NO,DS6=NO,DS7=NO,
              2486            AUSER=YES);
      724     2556
      725     2557        %INCLUDE IR_DATA_M;
      726     2721        %INCLUDE NI$TABLES;
      727     2937        %RV_BUFF (STCLASS=SYMREF);
      728     2973        %RV_USRDIR (STCLASS=SYMREF);
      729     2977        %RV_WSQD (STCLASS=SYMREF);
      730     2981        %RV_DFSUBS;
      731     3008                                                /* BASED STRUCTURS                    */
      732     3009        %INCLUDE EL$TABLES;
      733     3332        %EL$BUF;
      734     3335        %INCLUDE B_STRINGS_C;
      735     3464
      736     3465        %EJECT;
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:102  
      737     3466
      738     3467    1   IRD$DJITS: ENTRY;
      739     3468    1      REMEMBER AJIT_TRAP IN RV_UNWIND1;
      740     3469    1      JITSZ=LENGTHW(B$JIT);
      741     3470    1      JITSPG=(1024/JITSZ);
      742     3471
      743     3472    1   BGRAN_JITS: ;
      744     3473    1      RV_ENTRY='0'B;
      745     3474    1      RV_ENTRY.DA=RV_NXTGRAN;
      746     3475    1      RV_CUN=0;
      747     3476    1   MORE_JITS: ;
      748     3477    1      BUFF$=ADDR(POBUF);
      749     3478    2      DO I=0 TO JITSPG-1;
      750     3479    2   AJIT_TRAP: ;
      751     3480    2           CALL RVC$CYCUSER  ALTRET(DONE);
      752     3481    2           BUFF$->B$JIT = I$JITU$->B$JIT;
      753     3482    2           BUFF$ = PINCRW(BUFF$,JITSZ);
      754     3483    2         END;
      755     3484    1   WRPAGE: ;
      756     3485    1      CALL IRR$WPOBUFF ALTRET(DERR_JITS);
      757     3486    1      RV_ENTRY.SZ = RV_ENTRY.SZ+1;
      758     3487    1      GOTO MORE_JITS;
      759     3488
      760     3489    1   DONE: ;
      761     3490    2      IF I ~= 0 THEN DO;
      762     3491    2           BUFF$->B$JIT.USER=0;
      763     3492    2           GOTO WRPAGE;
      764     3493    2         END;
      765     3494
      766     3495    1   DIR_JITS: ;
      767     3496    1      RV_BUFF.JITS = RV_ENTRY;
      768     3497    1      RV_BUFF.SIZE = RV_BUFF.SIZE + RV_ENTRY.SZ;
      769     3498    1      RETURN;
      770     3499
      771     3500    1   DERR_JITS: ;
      772     3501    1      IF RV_PDUMP ~= 0 THEN GOTO DIR_JITS; /*OUT OF DISC SPACE                   */
      773     3502    1      ELSE GOTO BGRAN_JITS;
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:103  
      774     3503
      775     3504        %EJECT;
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:104  
      776     3505    1   IRD$ERRLOG: ENTRY;
      777     3506    1      REMEMBER DIR_ERRL IN RV_UNWIND1;
      778     3507    1   BGRAN_EL: ;
      779     3508    1      RV_ENTRY='0'B;
      780     3509    1      RV_ENTRY.DA = RV_NXTGRAN;
      781     3510    1      EL_NXT = RV_BUFF.EL_FIRSTBUF;
      782     3511                                                /*                                    */
      783     3512    2      DO WHILE (EL_NXT ~=0);
      784     3513    2           MEMDESC.BADDR=(EL_NXT*4096);
      785     3514    2           RV_BAPAGE = (EL_NXT*4096);
      786     3515    2           EL_NXT = I$MEM$->EL$BUF.NXTBUF;
      787     3516    2           CALL IRR$WDUMP ALTRET(DERR_EL);
      788     3517    2           RV_ENTRY.SZ=RV_ENTRY.SZ+1;
      789     3518    2         END;                              /*DO WHILE NXT.PAGEN ~= 0             */
      790     3519
      791     3520                                                /*                                    */
      792     3521    1   DIR_ERRL: ;
      793     3522    1      RV_BUFF.ERRLOG=RV_ENTRY;
      794     3523    1      RETURN;
      795     3524
      796     3525    1   DERR_EL: ;
      797     3526    1      IF RV_PDUMP ~= 0 THEN GOTO DIR_ERRL; /*OUT OF DISK*/
      798     3527    1      GOTO BGRAN_EL;
      799     3528
      800     3529        %EJECT;
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:105  
      801     3530
      802     3531    1   IRD$DLRMEM: ENTRY;
      803     3532    1      SC=RV_SCODEA;
      804     3533    1      IF SC.LRM# = '0'B AND SC.PPUT# = '0'B THEN RETURN;
      805     3534    1      REMEMBER DIR_LRM IN RV_UNWIND1;
      806     3535
      807     3536    1   BGRAN_LRMEM: ;
      808     3537    1      RV_ENTRY='0'B;
      809     3538    1      RV_ENTRY.DA=RV_NXTGRAN;
      810     3539    1      X_DSCR=PTRDSCR(I$PPUT$);
      811     3540    1      RV_BUFF.PPUT.FP = DBASE(X_DSCR)/4096;
      812     3541    1      RV_BUFF.PPUT.LP = DBASE(X_DSCR)/4096 + DBOUND(X_DSCR)/4096;
      813     3542    2      DO I=0 TO RV_BUFF.PPUT.LP;
      814     3543    2           RV_BAPAGE = (I*4096);
      815     3544    2           CALL IRR$WDUMP  ALTRET(DERR_LRMEM);
      816     3545    2           RV_ENTRY.SZ = RV_ENTRY.SZ+1;
      817     3546    2         END;
      818     3547
      819     3548    1   DIR_LRM: ;
      820     3549    1      RV_BUFF.LRMEM = RV_ENTRY;
      821     3550    1      RV_BUFF.SIZE = RV_BUFF.SIZE + RV_ENTRY.SZ;
      822     3551    1      RETURN;
      823     3552
      824     3553    1   DERR_LRMEM: ;
      825     3554    1      IF RV_PDUMP ~= 0 THEN GOTO DIR_LRM;  /*OUT OF DISC SPACE                   */
      826     3555    1      ELSE GOTO BGRAN_LRMEM;
      827     3556        %EJECT;
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:106  
      828     3557
      829     3558    1   IRD$DUSERS: ENTRY;
      830     3559    1      SC=RV_SCODEA;
      831     3560    1      IF SC.AUSER#='1'B
      832     3561    2      THEN DO;
      833     3562    2           REMEMBER D_CUSR IN RV_UNWIND1;
      834     3563    2           RV_USRTYP=%R_SNAPU#;
      835     3564    2           RV_CUN = RV_BUFF.SNAPU#;
      836     3565    2           CALL MAP_USER ALTRET(D_CUSR);
      837     3566    2           CALL IRD$DUMPUSR;
      838     3567    2         END;
      839     3568    1   D_CUSR: ;
      840     3569    1      IF SC.CUSR# ='1'B OR SC.CUSRS#='1'B OR SC.SEV#=%SEV_SCREECH#
      841     3570    2      THEN DO;
      842     3571    2           REMEMBER DCUSRS IN RV_UNWIND1;
      843     3572    2           RV_USRTYP = %R_CU#;
      844     3573    2           RV_CUN = RV_BUFF.CUN;
      845     3574    2           CALL MAP_USER ALTRET(DCUSRS);
      846     3575    2           CALL IRD$DUMPUSR;
      847     3576    2         END;
      848     3577
      849     3578    1   DCUSRS: ;
      850     3579    1      RV_USRTYP = %R_SCU#;
      851     3580    1      REMEMBER NO_CPUSR IN RV_UNWIND1;
      852     3581    1      IF SC.CUSRS#='1'B OR SC.SEV#=%SEV_SCREECH#
      853     3582    2      THEN DO I=0 TO RV_NSCPU;
      854     3583    2           RV_CUN = RV_BUFF.S_CUN(I);
      855     3584    2           CALL MAP_USER ALTRET(NO_CPUSR);
      856     3585    2           CALL IRD$DUMPUSR;
      857     3586    2   NO_CPUSR: ;
      858     3587    2         END;                              /*DO TO RV_NSCPU                      */
      859     3588
      860     3589    1      RV_CUN=0;
      861     3590    1      RV_USRTYP = %R_IOUSR#;
      862     3591    1      RV_SCODEA=RV_IOUSERS;
      863     3592    1      REMEMBER NXT_IOUSR IN RV_UNWIND1;
      864     3593    1      IF SC.IOUSRS# ='1'B OR SC.ALLUSR#='1'B
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:107  
      865     3594    2      THEN DO WHILE ('1'B);
      866     3595    2   NXT_IOUSR: ;
      867     3596    2           CALL RVC$CYCUSER ALTRET(DONE2);
      868     3597    2           IF R$CU$->B$U.MF ~= 0 THEN CALL IRD$DUMPUSR;
      869     3598    2         END;
      870     3599    1   DONE2: ;
      871     3600    1      RV_CUN=0;
      872     3601    1      RV_USRTYP = %R_OUSR#;
      873     3602    1      RV_SCODEA=RV_ALLUSERS;
      874     3603    1      IF SC.ALLUSR#='1'B
      875     3604    2      THEN DO WHILE ('1'B);
      876     3605    2   NXT_ALLUSR: ;
      877     3606    2           REMEMBER NXT_ALLUSR IN RV_UNWIND1;
      878     3607    2           CALL RVC$CYCUSER ALTRET(DONE3);
      879     3608    2           CALL IRD$DUMPUSR;
      880     3609    2         END;
      881     3610    1   DONE3: ;
      882     3611    1      CALL IRR$WUSRDR ALTRET(DISASTER);
      883     3612    1   DISASTER: ;
      884     3613    1      RETURN;
      885     3614        %EJECT;
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:108  
      886     3615           /*
      887     3616            IRF$CLSF is entered with Recovery Descriptors set by IRR$RECOVER
      888     3617            as follows:
      889     3618               DESCRV1 - TIGR
      890     3619               DESCRV2 - CFU
      891     3620               DESCRV3 - ROSEG
      892     3621               DESCRV4 - BUFFERS
      893     3622           */
      894     3623    1   IRD$CLOSE: ENTRY;
      895     3624    1      SC=RV_SCODEA;
      896     3625
      897     3626    1      IF (SC.SEV# = %SEV_SCREECH#) OR (SC.SEV# = %SEV_ZAP#)
      898     3627    2      THEN DO;
      899     3628    2           RV_CUN=0;
      900     3629    2           RV_USRTYP=%R_TRAPU#;
      901     3630    2   CLS_NXT: ;
      902     3631    2           REMEMBER CLS_TRAP IN RV_UNWIND1;
      903     3632    3           DO WHILE ('1'B);
      904     3633    3                CALL RVC$CYCUSER ALTRET(DONE4);
      905     3634    3                CALL IRF$CLSF ALTRET(CLS_TRAP);
      906     3635    3              END;
      907     3636    2   DONE4:  ;
      908     3637    2           CALL IRR$WUSRDR ALTRET(DISASTER2);
      909     3638    2   DISASTER2: ;
      910     3639    2         END;
      911     3640           /*
      912     3641               Now set Recovery Descriptors 3 & 4 in AARDVARK's Linkage Segment
      913     3642               to contain the Comgroup Page Tables and Comgroup Context
      914     3643               Descriptors from the Monitors Linkage Segment.
      915     3644             */
      916     3645
      917     3646    1      DESCRV3 = RV_CGPT;
      918     3647    1      R$CGPT$ = I$RV3$;
      919     3648
      920     3649    1      DESCRV4 = RV_CGCTXT;
      921     3650    1      R$CGCTXT$ = I$RV4$;
      922     3651
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:109  
      923     3652    1      REMEMBER CFU_TRAP IN RV_UNWIND1;
      924     3653
      925     3654    1      IF (SC.SEV# = %SEV_SCREECH#) OR (SC.SEV# = %SEV_ZAP#)
      926     3655    1      THEN CALL IRF$CFUS;
      927     3656                  /* Update FITs for all files and file directories - dump comgroup   */
      928     3657    2      ELSE DO;
      929     3658                                                /* When SUA or SNAP                   */
      930     3659    2           REMEMBER DUMPCG_TRAP IN RV_UNWIND1;
      931     3660    2           CALL IRF$DUMPCG;
      932     3661                                                /* Dump the current comgroup, if any  */
      933     3662    2         END;
      934     3663
      935     3664    1   IRD$CLOSE$EXIT: ;
      936     3665    1      IF RV_BUFF.CLSFTRAP='1'B
      937     3666    1      THEN CALL IRR$TYPE6M(RVM_CLST,SIZEW(RVM_CLST));
      938     3667        /*O*   MESSAGE:   RCVR-TRAP IN IRF$CLSF
      939     3668               MEANING:   Trap in IRF$CLSF.  Typed if RV_DEBUGM set
      940     3669                          non-zero.  RV_BUFF.CLSFTRAP will be set.
      941     3670        */
      942     3671
      943     3672    1      IF RV_BUFF.CFUTRAP='1'B
      944     3673    1      THEN CALL IRR$TYPE6M(RVM_CFU,SIZEW(RVM_CFU));
      945     3674        /*O*   MESSAGE:   RCVR-TRAP IN IRF$CFUS
      946     3675               MEANING:   Trap in IRF$CFUS.  Typed if RV_DEBUGM set
      947     3676                          non-zero.  RV_BUFF.CFUTRAP will be set.
      948     3677        */
      949     3678
      950     3679    1      IF RV_BUFF.CGQTRAP='1'B
      951     3680    1      THEN CALL IRR$TYPE6M(RVM_CGQ,SIZEW(RVM_CGQ));
      952     3681        /*O*    MESSAGE:   RCVR-TRAP IN IRF$DUMPCG
      953     3682                MEANING:   Trap in IRF$DUMPCG.  Typed if RV_DEBUGM set
      954     3683                           non-zero.  RV_BUFF.CGQTRAP will be set.
      955     3684         */
      956     3685    1      RETURN;
      957     3686                                                /*                                    */
      958     3687    1   CLS_TRAP: ;
      959     3688    1      RV_BUFF.CLSFTRAP='1'B;
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:110  
      960     3689    1      IF RV_PDUMP ~= 0 THEN GOTO CLS_NXT;
      961     3690    1      RV_USRDIR.USER.SZ(RV_CUN) = 0;
      962     3691    1      REMEMBER DUMP_TRAP IN RV_UNWIND1;
      963     3692    1      RV_SCODEA=SC_CLSTRAP;
      964     3693    1      CALL IRD$DUMPUSR;
      965     3694    1      RV_SCODEA=SC;
      966     3695    1   DUMP_TRAP: ;
      967     3696    1      RV_USRDIR.USER.CFTRAP(RV_CUN) ='1'B;
      968     3697    1      RV_SCODEA=SC;
      969     3698    1      GOTO CLS_NXT;
      970     3699
      971     3700    1   CFU_TRAP: ;
      972     3701    1      RV_BUFF.CFUTRAP='1'B;
      973     3702    1      GOTO IRD$CLOSE$EXIT;
      974     3703
      975     3704    1   DUMPCG_TRAP: ;
      976     3705    1      RV_BUFF.CGQTRAP='1'B;
      977     3706    1      GOTO IRD$CLOSE$EXIT;
      978     3707        %EJECT;
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:111  
      979     3708
      980     3709    1   IRD$DHJITS: ENTRY;
      981     3710    1      IF SC.SHJIT#='0'B THEN RETURN;
      982     3711
      983     3712    1      REMEMBER NEXT_CPU IN RV_UNWIND1;
      984     3713    2      DO I=0 TO RV_NSCPU;
      985     3714    2   NEXT_CPU: ;
      986     3715    2           IF I ~= RV_BUFF.S_PNO
      987     3716    3           THEN DO;
      988     3717    3                RV_CPNO=I;
      989     3718    3                CALL IRD$DUMPMON;
      990     3719    3              END;                         /*DO IF NOT S_PNO                     */
      991     3720    2         END;                              /*DO 0 TO NSCPU                       */
      992     3721    1      RETURN;
      993     3722
      994     3723        %EJECT;
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:112  
      995     3724                                                /*****INTERNAL PROCEDURES  ****/
      996     3725    1   RVC$CYCUSER: PROC ALTRET;
      997     3726    2   NEXT_USER: ;
      998     3727    2      RV_CUN = RV_CUN+1;
      999     3728    2      IF RV_CUN > RV_MUAIS THEN ALTRETURN;
     1000     3729    2      CALL MAP_USER ALTRET(NEXT_USER);
     1001     3730    2   END RVC$CYCUSER;
     1002     3731                                                /*                                    */
     1003     3732                                                /*                                    */
     1004     3733                                                /*                                    */
     1005     3734    1   MAP_USER: PROC ALTRET;
     1006     3735    2      IF RV_CUN=0 THEN ALTRETURN;
     1007     3736    2      RV_USTATE = R$USRT$->B$USER.US(RV_CUN);
     1008     3737    2      IF RV_USTATE= %SS_SNULL THEN ALTRETURN;
     1009     3738    2      R$CU$ = ADDR(R$USRT$->B$USER(RV_CUN));
     1010     3739    2      I$MONIS$->B$WSPTD.BLKNO(%USERWSQ) = R$CU$->B$U.PT;
     1011     3740    2      CALL IRR$MAP;
     1012     3741    2      RETURN;
     1013     3742    2   END MAP_USER;
     1014     3743    1   END IRD$DUMP2;

PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:113  
--  Include file information  --

   B_STRINGS_C.:E05TOU  is referenced.
   EL$TABLES.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   IR_DATA_M.:E05TOU  is referenced.
   HF_SCODE_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   JS_CP6.:E05TOU  is referenced.
   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   U$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure IRD$DUMP2.

   Procedure IRD$DUMP2 requires 438 words for executable code.
   Procedure IRD$DUMP2 requires 22 words of local(AUTO) storage.

    No errors detected in file IRD$DUMP.:E05TSI    .

PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:114  

 Object Unit name= IRD$DUMP2                                  File name= IRD$DUMP.:E05TOU
 UTS= JUL 29 '97 22:43:01.80 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     32     40  IRD$DUMP2
    1   Proc  even  none   438    666  IRD$DUMP2
    2  RoData even  none     7      7  IRD$DUMP2

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        0  IRD$DUMP2
     1      3                  yes      Std        0  IRD$DJITS
     1    100                  yes      Std        0  IRD$ERRLOG
     1    142                  yes      Std        0  IRD$DLRMEM
     1    236                  yes      Std        0  IRD$DUSERS
     1    417                  yes      Std        0  IRD$CLOSE
     1    570                  yes      Std        0  IRD$DHJITS

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0     30  RV_OPASCODE                        0     32  RV_SLAVES
    0     34  RV_MONDSEG
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:115  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 IRR$WDUMP
 yes     yes           Std       0 IRR$WPOBUFF
 yes     yes           Std       0 IRR$WUSRDR
 yes     yes           Std       0 IRF$CLSF
 yes     yes           Std       0 IRF$CFUS
         yes           Std       2 IRR$TYPE6M
         yes           Std       0 IRD$DUMPMON
         yes           Std       0 IRD$DUMPUSR
 yes     yes           Std       0 IRF$DUMPCG
         yes           Std       0 IRR$MAP
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     RV_ENTRY                              R$CGCTXT$                             R$CGPT$
     R$CU$                                 R$USRT$                               RV_BAPAGE
     RV_CGCTXT                             RV_CGPT                               RV_CPNO
     RV_CUN                                RV_MUAIS                              RV_NSCPU
     RV_NXTGRAN                            RV_PDUMP                              RV_SCODEA
     RV_UNWIND1                            RV_USRTYP                             RV_USTATE
     MEMDESC                               I$JITU$                               I$MEM$
     I$MONIS$                              I$RV3$                                I$RV4$
     I$PPUT$                               DESCRV3                               DESCRV4
     POBUF                                 B$JIT$                                RV_BUFF
     RV_USRDIR                             B_VECTNIL
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:116  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:117  


      608        1        /*M*   IRD$DUMP2   Recovery Dump Routines      */
      609        2        /*T***********************************************************/
      610        3        /*T*                                                         */
      611        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      612        5        /*T*                                                         */
      613        6        /*T***********************************************************/
      614        7        /*X*   PLM=3,IND=5     */
      615        8        IRD$DUMP2: PROC;

      8  1 000000   000000 700200 xent  IRD$DUMP2    TSX0  ! X66_AUTO_0
         1 000001   000026 000000                    ZERO    22,0
         1 000002   000005 710000 1                  TRA     s:3468

      616        9
      617       10                                                /* AUTO                               */
      618       11    1   DCL EL_NXT UBIN(36);
      619       12
      620       13    1   DCL BUFF$ PTR;
      621       14    1   DCL I UBIN(36);
      622       15    1   DCL BLKNO UBIN(18);
      623       16    1   DCL JITSZ SBIN;
      624       17    1   DCL JITSPG SBIN;
      625       18                                                /* CONSTANT DATA                      */
      626       19    1   DCL RVM_CFU CONSTANT CHAR(24) INIT(
      627       20    1        'RCVR-TRAP IN IRF$CFUS');
      628       21    1   DCL RVM_CLST CONSTANT CHAR(24) INIT(
      629       22    1        'RCVR-TRAP IN IRF$CLSF');
      630       23    1   DCL RVM_CGQ CONSTANT CHAR(24) INIT(
      631       24    1        'RCVR-TRAP IN IRF$DUMPCG');
      632       25
      633       26    1   DCL 1 RV_ENTRY SYMREF DALIGNED,
      634       27    1         2 DA SBIN,
      635       28    1         2 DTRAP BIT(1) UNAL,
      636       29    1         2 CFTRAP BIT(1) UNAL,
      637       30    1         2 BADPT BIT(1) UNAL,
      638       31    1         2 * BIT(6) UNAL,
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:118  
      639       32    1         2 TYP UBIN(9) UNAL,
      640       33    1         2 SZ UBIN(18) UNAL;
      641       34
      642       35    1   DCL R$CGCTXT$ PTR SYMREF;
      643       36    1   DCL R$CGPT$ PTR SYMREF;
      644       37    1   DCL R$CU$ PTR SYMREF;
      645       38    1   DCL R$USRT$ PTR SYMREF;
      646       39
      647       40    1   DCL RV_BAPAGE SBIN SYMREF;
      648       41    1   DCL RV_CGCTXT BIT(72) SYMREF DALIGNED;
      649       42    1   DCL RV_CGPT BIT(72) SYMREF DALIGNED;
      650       43    1   DCL RV_CPNO SBIN SYMREF;
      651       44    1   DCL RV_CUN SBIN SYMREF;
      652       45    1   DCL RV_MUAIS SBIN SYMREF;
      653       46    1   DCL RV_NSCPU SBIN SYMREF;
      654       47    1   DCL RV_NXTGRAN  SBIN SYMREF;
      655       48    1   DCL RV_PDUMP  SBIN SYMREF;
      656       49    1   DCL RV_SCODEA BIT(72) SYMREF DALIGNED;
      657       50    1   DCL RV_UNWIND1 REMEMBER SYMREF DALIGNED;
      658       51    1   DCL RV_USRTYP UBIN(18) SYMREF;
      659       52    1   DCL RV_USTATE SBIN SYMREF;
      660       53
      661       54                                                /* AARDVARK SYMREFS                   */
      662       55    1   DCL 1 MEMDESC SYMREF,
      663       56    1         2 * BIT(36) UNAL,
      664       57    1         2 BADDR UBIN(36);
      665       58
      666       59    1   DCL I$JITU$ PTR SYMREF;
      667       60    1   DCL I$MEM$ PTR SYMREF;
      668       61    1   DCL I$MONIS$ PTR SYMREF;
      669       62    1   DCL I$RV3$ PTR SYMREF;
      670       63    1   DCL I$RV4$ PTR SYMREF;
      671       64    1   DCL I$PPUT$ PTR SYMREF;
      672       65
      673       66    1   DCL X_DSCR DSCR;         /* 'cause PL6 will complain if I try to shortcut     */
      674       67    1   DCL PPUT_BASE SBIN;
      675       68    1   DCL PPUT_BOUND SBIN;
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:119  
      676       69
      677       70    1   DCL DESCRV3 BIT(72) DALIGNED SYMREF;
      678       71    1   DCL DESCRV4 BIT(72) DALIGNED SYMREF;
      679       72
      680       73    1   DCL POBUF(0:1023) UBIN(36) SYMREF;
      681       74
      682       75                                                /*  AARDVARK ENTRY REFS               */
      683       76    1   DCL IRR$MAP ENTRY;
      684       77    1   DCL IRR$TYPE6M ENTRY(2);
      685       78    1   DCL IRR$WDUMP  ENTRY ALTRET;
      686       79    1   DCL IRR$WUSRDR ENTRY ALTRET;
      687       80    1   DCL IRR$WPOBUFF ENTRY ALTRET;
      688       81    1   DCL IRD$DUMPMON ENTRY;
      689       82    1   DCL IRD$DUMPUSR ENTRY;
      690       83    1   DCL IRF$CLSF ENTRY ALTRET;
      691       84    1   DCL IRF$CFUS ENTRY ALTRET;
      692       85    1   DCL IRF$DUMPCG ENTRY ALTRET;
      693       86                                                /* MONITOR REFS                       */
      694       87        %INCLUDE U$JIT_C;
      695      586    1   DCL B$JIT$ PTR SYMREF;
      696      587        %INCLUDE SS_SCHED_C;
      697      820        %INCLUDE B$USER;
      698     1036
      699     1037    1   DCL 1 B$WSPTD(0:26) BASED ALIGNED,
      700     1038    1         2 BLKNO UBIN(18) UNAL,
      701     1039    1         2 * BIT(2) UNAL,
      702     1040    1         2 P BIT(1) UNAL,
      703     1041    1         2 T BIT(1) UNAL,
      704     1042    1         2 * BIT(6) UNAL,
      705     1043    1         2 NBLKS UBIN(8) UNAL;
      706     1044
      707     1045
      708     1046        %INCLUDE JS_CP6;
      709     1464        %INCLUDE CP_6_SUBS;
      710     2004        %INCLUDE HF_SCODE_C;
      711     2087
      712     2088        %VLP_SCREECH (FPTN=SC,STCLASS=AUTO);
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:120  
      713     2158        %VLP_SUA (FPTN=SC_CLSTRAP,STCLASS=CONSTANT,CUSR=YES,FMBUF=YES,ROSEG=YES,CFUS=YES);
      714     2228        %VLP_SCODE (FPTN=RV_IOUSERS,STCLASS=CONSTANT,IOUSRS=YES,SPBUF=YES,FMBUF=YES,ROSEG=
              2228            YES);
      715     2289
      716     2290        %VLP_SCODE (FPTN=RV_ALLUSERS,STCLASS=CONSTANT);
      717     2351
      718     2352                       /*Generate a Screech Code for ISI$BOOT here in a PL-6 module   */
      719     2353        %VLP_SCREECH (FPTN=RV_OPASCODE,STCLASS=CONSTANT SYMDEF,FCG=IS,MID=I,MON=NO,CODE=
              2353            %S$QAARDVRK);
      720     2423
      721     2424                  /*Generate Screech Code dump bits to use as masks in IRR$RECOVER    */
      722     2425        %VLP_SCODE (FPTN=RV_SLAVES,STCLASS=CONSTANT SYMDEF,SHJIT=YES,CUSRS=YES);
      723     2486        %VLP_SCREECH (FPTN=RV_MONDSEG,STCLASS=CONSTANT SYMDEF,DS4=NO,DS5=NO,DS6=NO,DS7=NO,
              2486            AUSER=YES);
      724     2556
      725     2557        %INCLUDE IR_DATA_M;
      726     2721        %INCLUDE NI$TABLES;
      727     2937        %RV_BUFF (STCLASS=SYMREF);
      728     2973        %RV_USRDIR (STCLASS=SYMREF);
      729     2977        %RV_WSQD (STCLASS=SYMREF);
      730     2981        %RV_DFSUBS;
      731     3008                                                /* BASED STRUCTURS                    */
      732     3009        %INCLUDE EL$TABLES;
      733     3332        %EL$BUF;
      734     3335        %INCLUDE B_STRINGS_C;
      735     3464
      736     3465        %EJECT;
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:121  
      737     3466
      738     3467    1   IRD$DJITS: ENTRY;

   3467  1 000003   000000 700200 xent  IRD$DJITS    TSX0  ! X66_AUTO_0
         1 000004   000026 000000                    ZERO    22,0

      739     3468    1      REMEMBER AJIT_TRAP IN RV_UNWIND1;

   3468  1 000005   000027 635000 1                  EAA     AJIT_TRAP
         1 000006   000000 452400 xsym               STP2    RV_UNWIND1
         1 000007   000001 755000 xsym               STA     RV_UNWIND1+1

      740     3469    1      JITSZ=LENGTHW(B$JIT);

   3469  1 000010   000366 236007                    LDQ     246,DL
         1 000011   200007 756100                    STQ     JITSZ,,AUTO

      741     3470    1      JITSPG=(1024/JITSZ);

   3470  1 000012   002000 236007                    LDQ     1024,DL
         1 000013   200007 506100                    DIV     JITSZ,,AUTO
         1 000014   200010 756100                    STQ     JITSPG,,AUTO

   3470  1 000015                       BGRAN_JITS   null
      742     3471
      743     3472    1   BGRAN_JITS: ;
      744     3473    1      RV_ENTRY='0'B;

   3473  1 000015   000000 235003                    LDA     0,DU
         1 000016   000000 236003                    LDQ     0,DU
         1 000017   000000 757000 xsym               STAQ    RV_ENTRY

      745     3474    1      RV_ENTRY.DA=RV_NXTGRAN;

   3474  1 000020   000000 235000 xsym               LDA     RV_NXTGRAN
         1 000021   000000 755000 xsym               STA     RV_ENTRY

PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:122  
      746     3475    1      RV_CUN=0;

   3475  1 000022   000000 450000 xsym               STZ     RV_CUN

   3475  1 000023                       MORE_JITS    null
      747     3476    1   MORE_JITS: ;
      748     3477    1      BUFF$=ADDR(POBUF);

   3477  1 000023   000000 236000 2                  LDQ     0
         1 000024   200004 756100                    STQ     BUFF$,,AUTO

      749     3478    2      DO I=0 TO JITSPG-1;

   3478  1 000025   200005 450100                    STZ     I,,AUTO
         1 000026   000045 710000 1                  TRA     s:3483+3

   3478  1 000027                       AJIT_TRAP    null
      750     3479    2   AJIT_TRAP: ;
      751     3480    2           CALL RVC$CYCUSER  ALTRET(DONE);

   3480  1 000027   000622 701000 1                  TSX1    RVC$CYCUSER
         1 000030   000060 702000 1                  TSX2    DONE

      752     3481    2           BUFF$->B$JIT = I$JITU$->B$JIT;

   3481  1 000031   000000 470400 xsym               LDP0    I$JITU$
         1 000032   200004 471500                    LDP1    BUFF$,,AUTO
         1 000033   000100 100500                    MLR     fill='000'O
         1 000034   000000 001730                    ADSC9   0,,PR0                   cn=0,n=984
         1 000035   100000 001730                    ADSC9   0,,PR1                   cn=0,n=984

      753     3482    2           BUFF$ = PINCRW(BUFF$,JITSZ);

   3482  1 000036   200007 236100                    LDQ     JITSZ,,AUTO
         1 000037   000022 736000                    QLS     18
         1 000040   200004 036100                    ADLQ    BUFF$,,AUTO
         1 000041   200004 756100                    STQ     BUFF$,,AUTO
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:123  

      754     3483    2         END;

   3483  1 000042   200005 235100                    LDA     I,,AUTO
         1 000043   000001 035007                    ADLA    1,DL
         1 000044   200005 755100                    STA     I,,AUTO
         1 000045   200005 236100                    LDQ     I,,AUTO
         1 000046   000051 604000 1                  TMI     WRPAGE
         1 000047   200010 116100                    CMPQ    JITSPG,,AUTO
         1 000050   000027 604000 1                  TMI     AJIT_TRAP

   3479  1 000051                       WRPAGE       null
      755     3484    1   WRPAGE: ;
      756     3485    1      CALL IRR$WPOBUFF ALTRET(DERR_JITS);

   3485  1 000051   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000052   000000 701000 xent               TSX1    IRR$WPOBUFF
         1 000053   000075 702000 1                  TSX2    DERR_JITS

      757     3486    1      RV_ENTRY.SZ = RV_ENTRY.SZ+1;

   3486  1 000054   000001 720000 xsym               LXL0    RV_ENTRY+1
         1 000055   000001 621010                    EAX1    1,X0
         1 000056   000001 441000 xsym               SXL1    RV_ENTRY+1

      758     3487    1      GOTO MORE_JITS;

   3487  1 000057   000023 710000 1                  TRA     MORE_JITS

   3486  1 000060                       DONE         null
      759     3488
      760     3489    1   DONE: ;
      761     3490    2      IF I ~= 0 THEN DO;

   3490  1 000060   200005 235100                    LDA     I,,AUTO
         1 000061   000066 600000 1                  TZE     DIR_JITS

PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:124  
      762     3491    2           BUFF$->B$JIT.USER=0;

   3491  1 000062   200004 470500                    LDP0    BUFF$,,AUTO
         1 000063   000000 236003                    LDQ     0,DU
         1 000064   000000 552120                    STBQ    0,'20'O,PR0

      763     3492    2           GOTO WRPAGE;

   3492  1 000065   000051 710000 1                  TRA     WRPAGE

   3490  1 000066                       DIR_JITS     null
      764     3493    2         END;
      765     3494
      766     3495    1   DIR_JITS: ;
      767     3496    1      RV_BUFF.JITS = RV_ENTRY;

   3496  1 000066   000000 237000 xsym               LDAQ    RV_ENTRY
         1 000067   000312 757000 xsym               STAQ    RV_BUFF+202

      768     3497    1      RV_BUFF.SIZE = RV_BUFF.SIZE + RV_ENTRY.SZ;

   3497  1 000070   000001 236000 xsym               LDQ     RV_ENTRY+1
         1 000071   777777 376007                    ANQ     -1,DL
         1 000072   000002 036000 xsym               ADLQ    RV_BUFF+2
         1 000073   000002 756000 xsym               STQ     RV_BUFF+2

      769     3498    1      RETURN;

   3498  1 000074   000000 702200 xent               TSX2  ! X66_ARET

   3497  1 000075                       DERR_JITS    null
      770     3499
      771     3500    1   DERR_JITS: ;
      772     3501    1      IF RV_PDUMP ~= 0 THEN GOTO DIR_JITS; /*OUT OF DISC SPACE                   */

   3501  1 000075   000000 235000 xsym               LDA     RV_PDUMP
         1 000076   000066 601000 1                  TNZ     DIR_JITS
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:125  

      773     3502    1      ELSE GOTO BGRAN_JITS;

   3502  1 000077   000015 710000 1                  TRA     BGRAN_JITS

      774     3503
      775     3504        %EJECT;
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:126  
      776     3505    1   IRD$ERRLOG: ENTRY;

   3505  1 000100   000000 700200 xent  IRD$ERRLOG   TSX0  ! X66_AUTO_0
         1 000101   000026 000000                    ZERO    22,0

      777     3506    1      REMEMBER DIR_ERRL IN RV_UNWIND1;

   3506  1 000102   000134 635000 1                  EAA     DIR_ERRL
         1 000103   000000 452400 xsym               STP2    RV_UNWIND1
         1 000104   000001 755000 xsym               STA     RV_UNWIND1+1

   3501  1 000105                       BGRAN_EL     null
      778     3507    1   BGRAN_EL: ;
      779     3508    1      RV_ENTRY='0'B;

   3508  1 000105   000000 235003                    LDA     0,DU
         1 000106   000000 236003                    LDQ     0,DU
         1 000107   000000 757000 xsym               STAQ    RV_ENTRY

      780     3509    1      RV_ENTRY.DA = RV_NXTGRAN;

   3509  1 000110   000000 235000 xsym               LDA     RV_NXTGRAN
         1 000111   000000 755000 xsym               STA     RV_ENTRY

      781     3510    1      EL_NXT = RV_BUFF.EL_FIRSTBUF;

   3510  1 000112   000264 235000 xsym               LDA     RV_BUFF+180
         1 000113   200003 755100                    STA     EL_NXT,,AUTO

      782     3511                                                /*                                    */
      783     3512    2      DO WHILE (EL_NXT ~=0);

   3512  1 000114   000134 600000 1                  TZE     DIR_ERRL

      784     3513    2           MEMDESC.BADDR=(EL_NXT*4096);

   3513  1 000115   200003 235100                    LDA     EL_NXT,,AUTO
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:127  
         1 000116   000014 735000                    ALS     12
         1 000117   000001 755000 xsym               STA     MEMDESC+1

      785     3514    2           RV_BAPAGE = (EL_NXT*4096);

   3514  1 000120   000000 755000 xsym               STA     RV_BAPAGE

      786     3515    2           EL_NXT = I$MEM$->EL$BUF.NXTBUF;

   3515  1 000121   000000 470400 xsym               LDP0    I$MEM$
         1 000122   000000 235100                    LDA     0,,PR0
         1 000123   200003 755100                    STA     EL_NXT,,AUTO

      787     3516    2           CALL IRR$WDUMP ALTRET(DERR_EL);

   3516  1 000124   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000125   000000 701000 xent               TSX1    IRR$WDUMP
         1 000126   000137 702000 1                  TSX2    DERR_EL

      788     3517    2           RV_ENTRY.SZ=RV_ENTRY.SZ+1;

   3517  1 000127   000001 720000 xsym               LXL0    RV_ENTRY+1
         1 000130   000001 621010                    EAX1    1,X0
         1 000131   000001 441000 xsym               SXL1    RV_ENTRY+1

      789     3518    2         END;                              /*DO WHILE NXT.PAGEN ~= 0             */

   3518  1 000132   200003 235100                    LDA     EL_NXT,,AUTO
         1 000133   000115 601000 1                  TNZ     s:3513

   3513  1 000134                       DIR_ERRL     null
      790     3519
      791     3520                                                /*                                    */
      792     3521    1   DIR_ERRL: ;
      793     3522    1      RV_BUFF.ERRLOG=RV_ENTRY;

   3522  1 000134   000000 237000 xsym               LDAQ    RV_ENTRY
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:128  
         1 000135   000314 757000 xsym               STAQ    RV_BUFF+204

      794     3523    1      RETURN;

   3523  1 000136   000000 702200 xent               TSX2  ! X66_ARET

   3522  1 000137                       DERR_EL      null
      795     3524
      796     3525    1   DERR_EL: ;
      797     3526    1      IF RV_PDUMP ~= 0 THEN GOTO DIR_ERRL; /*OUT OF DISK*/

   3526  1 000137   000000 235000 xsym               LDA     RV_PDUMP
         1 000140   000134 601000 1                  TNZ     DIR_ERRL

      798     3527    1      GOTO BGRAN_EL;

   3527  1 000141   000105 710000 1                  TRA     BGRAN_EL

      799     3528
      800     3529        %EJECT;
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:129  
      801     3530
      802     3531    1   IRD$DLRMEM: ENTRY;

   3531  1 000142   000000 700200 xent  IRD$DLRMEM   TSX0  ! X66_AUTO_0
         1 000143   000026 000000                    ZERO    22,0

      803     3532    1      SC=RV_SCODEA;

   3532  1 000144   000000 237000 xsym               LDAQ    RV_SCODEA
         1 000145   200016 757100                    STAQ    SC,,AUTO

      804     3533    1      IF SC.LRM# = '0'B AND SC.PPUT# = '0'B THEN RETURN;

   3533  1 000146   200017 234100                    SZN     SC+1,,AUTO
         1 000147   000153 604000 1                  TMI     s:3534
         1 000150   000400 316003                    CANQ    256,DU
         1 000151   000153 601000 1                  TNZ     s:3534

   3533  1 000152   000000 702200 xent               TSX2  ! X66_ARET

      805     3534    1      REMEMBER DIR_LRM IN RV_UNWIND1;

   3534  1 000153   000224 635000 1                  EAA     DIR_LRM
         1 000154   000000 452400 xsym               STP2    RV_UNWIND1
         1 000155   000001 755000 xsym               STA     RV_UNWIND1+1

   3533  1 000156                       BGRAN_LRMEM  null
      806     3535
      807     3536    1   BGRAN_LRMEM: ;
      808     3537    1      RV_ENTRY='0'B;

   3537  1 000156   000000 235003                    LDA     0,DU
         1 000157   000000 236003                    LDQ     0,DU
         1 000160   000000 757000 xsym               STAQ    RV_ENTRY

      809     3538    1      RV_ENTRY.DA=RV_NXTGRAN;

PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:130  
   3538  1 000161   000000 235000 xsym               LDA     RV_NXTGRAN
         1 000162   000000 755000 xsym               STA     RV_ENTRY

      810     3539    1      X_DSCR=PTRDSCR(I$PPUT$);

   3539  1 000163   000000 470400 xsym               LDP0    I$PPUT$
         1 000164   200012 050500                    STD0    X_DSCR,,AUTO

      811     3540    1      RV_BUFF.PPUT.FP = DBASE(X_DSCR)/4096;

   3540  1 000165   200013 236100                    LDQ     X_DSCR+1,,AUTO
         1 000166   000014 772000                    QRL     12
         1 000167   000000 620006                    EAX0    0,QL
         1 000170   000307 740000 xsym               STX0    RV_BUFF+199

      812     3541    1      RV_BUFF.PPUT.LP = DBASE(X_DSCR)/4096 + DBOUND(X_DSCR)/4096;

   3541  1 000171   200013 236100                    LDQ     X_DSCR+1,,AUTO
         1 000172   000014 772000                    QRL     12
         1 000173   200024 756100                    STQ     SC+6,,AUTO
         1 000174   200012 236100                    LDQ     X_DSCR,,AUTO
         1 000175   000020 772000                    QRL     16
         1 000176   000014 772000                    QRL     12
         1 000177   200024 036100                    ADLQ    SC+6,,AUTO
         1 000200   000000 621006                    EAX1    0,QL
         1 000201   000307 441000 xsym               SXL1    RV_BUFF+199

      813     3542    2      DO I=0 TO RV_BUFF.PPUT.LP;

   3542  1 000202   200005 450100                    STZ     I,,AUTO
         1 000203   000220 710000 1                  TRA     s:3546+3

      814     3543    2           RV_BAPAGE = (I*4096);

   3543  1 000204   200005 235100                    LDA     I,,AUTO
         1 000205   000014 735000                    ALS     12
         1 000206   000000 755000 xsym               STA     RV_BAPAGE
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:131  

      815     3544    2           CALL IRR$WDUMP  ALTRET(DERR_LRMEM);

   3544  1 000207   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000210   000000 701000 xent               TSX1    IRR$WDUMP
         1 000211   000233 702000 1                  TSX2    DERR_LRMEM

      816     3545    2           RV_ENTRY.SZ = RV_ENTRY.SZ+1;

   3545  1 000212   000001 720000 xsym               LXL0    RV_ENTRY+1
         1 000213   000001 621010                    EAX1    1,X0
         1 000214   000001 441000 xsym               SXL1    RV_ENTRY+1

      817     3546    2         END;

   3546  1 000215   200005 235100                    LDA     I,,AUTO
         1 000216   000001 035007                    ADLA    1,DL
         1 000217   200005 755100                    STA     I,,AUTO
         1 000220   000307 236000 xsym               LDQ     RV_BUFF+199
         1 000221   777777 376007                    ANQ     -1,DL
         1 000222   200005 116100                    CMPQ    I,,AUTO
         1 000223   000204 603000 1                  TRC     s:3543

   3543  1 000224                       DIR_LRM      null
      818     3547
      819     3548    1   DIR_LRM: ;
      820     3549    1      RV_BUFF.LRMEM = RV_ENTRY;

   3549  1 000224   000000 237000 xsym               LDAQ    RV_ENTRY
         1 000225   000320 757000 xsym               STAQ    RV_BUFF+208

      821     3550    1      RV_BUFF.SIZE = RV_BUFF.SIZE + RV_ENTRY.SZ;

   3550  1 000226   000001 236000 xsym               LDQ     RV_ENTRY+1
         1 000227   777777 376007                    ANQ     -1,DL
         1 000230   000002 036000 xsym               ADLQ    RV_BUFF+2
         1 000231   000002 756000 xsym               STQ     RV_BUFF+2
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:132  

      822     3551    1      RETURN;

   3551  1 000232   000000 702200 xent               TSX2  ! X66_ARET

   3550  1 000233                       DERR_LRMEM   null
      823     3552
      824     3553    1   DERR_LRMEM: ;
      825     3554    1      IF RV_PDUMP ~= 0 THEN GOTO DIR_LRM;  /*OUT OF DISC SPACE                   */

   3554  1 000233   000000 235000 xsym               LDA     RV_PDUMP
         1 000234   000224 601000 1                  TNZ     DIR_LRM

      826     3555    1      ELSE GOTO BGRAN_LRMEM;

   3555  1 000235   000156 710000 1                  TRA     BGRAN_LRMEM

      827     3556        %EJECT;
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:133  
      828     3557
      829     3558    1   IRD$DUSERS: ENTRY;

   3558  1 000236   000000 700200 xent  IRD$DUSERS   TSX0  ! X66_AUTO_0
         1 000237   000026 000000                    ZERO    22,0

      830     3559    1      SC=RV_SCODEA;

   3559  1 000240   000000 237000 xsym               LDAQ    RV_SCODEA
         1 000241   200016 757100                    STAQ    SC,,AUTO

      831     3560    1      IF SC.AUSER#='1'B

   3560  1 000242   000001 316007                    CANQ    1,DL
         1 000243   000261 600000 1                  TZE     D_CUSR

      832     3561    2      THEN DO;

      833     3562    2           REMEMBER D_CUSR IN RV_UNWIND1;

   3562  1 000244   000261 635000 1                  EAA     D_CUSR
         1 000245   000000 452400 xsym               STP2    RV_UNWIND1
         1 000246   000001 755000 xsym               STA     RV_UNWIND1+1

      834     3563    2           RV_USRTYP=%R_SNAPU#;

   3563  1 000247   000004 220003                    LDX0    4,DU
         1 000250   000000 740000 xsym               STX0    RV_USRTYP

      835     3564    2           RV_CUN = RV_BUFF.SNAPU#;

   3564  1 000251   000012 236000 xsym               LDQ     RV_BUFF+10
         1 000252   000033 772000                    QRL     27
         1 000253   000000 756000 xsym               STQ     RV_CUN

      836     3565    2           CALL MAP_USER ALTRET(D_CUSR);

PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:134  
   3565  1 000254   000635 701000 1                  TSX1    MAP_USER
         1 000255   000261 702000 1                  TSX2    D_CUSR

      837     3566    2           CALL IRD$DUMPUSR;

   3566  1 000256   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000257   000000 701000 xent               TSX1    IRD$DUMPUSR
         1 000260   000000 011000                    NOP     0

      838     3567    2         END;

   3560  1 000261                       D_CUSR       null
      839     3568    1   D_CUSR: ;
      840     3569    1      IF SC.CUSR# ='1'B OR SC.CUSRS#='1'B OR SC.SEV#=%SEV_SCREECH#

   3569  1 000261   200017 236100                    LDQ     SC+1,,AUTO
         1 000262   100000 316007                    CANQ    32768,DL
         1 000263   000272 601000 1                  TNZ     s:3571
         1 000264   040000 316007                    CANQ    16384,DL
         1 000265   000272 601000 1                  TNZ     s:3571
         1 000266   200016 236100                    LDQ     SC,,AUTO
         1 000267   000007 376007                    ANQ     7,DL
         1 000270   000007 116007                    CMPQ    7,DL
         1 000271   000306 601000 1                  TNZ     DCUSRS

      841     3570    2      THEN DO;

      842     3571    2           REMEMBER DCUSRS IN RV_UNWIND1;

   3571  1 000272   000306 635000 1                  EAA     DCUSRS
         1 000273   000000 452400 xsym               STP2    RV_UNWIND1
         1 000274   000001 755000 xsym               STA     RV_UNWIND1+1

      843     3572    2           RV_USRTYP = %R_CU#;

   3572  1 000275   000000 220003                    LDX0    0,DU
         1 000276   000000 740000 xsym               STX0    RV_USRTYP
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:135  

      844     3573    2           RV_CUN = RV_BUFF.CUN;

   3573  1 000277   000140 236000 xsym               LDQ     RV_BUFF+96
         1 000300   000000 756000 xsym               STQ     RV_CUN

      845     3574    2           CALL MAP_USER ALTRET(DCUSRS);

   3574  1 000301   000635 701000 1                  TSX1    MAP_USER
         1 000302   000306 702000 1                  TSX2    DCUSRS

      846     3575    2           CALL IRD$DUMPUSR;

   3575  1 000303   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000304   000000 701000 xent               TSX1    IRD$DUMPUSR
         1 000305   000000 011000                    NOP     0

      847     3576    2         END;

   3569  1 000306                       DCUSRS       null
      848     3577
      849     3578    1   DCUSRS: ;
      850     3579    1      RV_USRTYP = %R_SCU#;

   3579  1 000306   000001 220003                    LDX0    1,DU
         1 000307   000000 740000 xsym               STX0    RV_USRTYP

      851     3580    1      REMEMBER NO_CPUSR IN RV_UNWIND1;

   3580  1 000310   000334 635000 1                  EAA     NO_CPUSR
         1 000311   000000 452400 xsym               STP2    RV_UNWIND1
         1 000312   000001 755000 xsym               STA     RV_UNWIND1+1

      852     3581    1      IF SC.CUSRS#='1'B OR SC.SEV#=%SEV_SCREECH#

   3581  1 000313   200017 236100                    LDQ     SC+1,,AUTO
         1 000314   040000 316007                    CANQ    16384,DL
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:136  
         1 000315   000322 601000 1                  TNZ     s:3582
         1 000316   200016 236100                    LDQ     SC,,AUTO
         1 000317   000007 376007                    ANQ     7,DL
         1 000320   000007 116007                    CMPQ    7,DL
         1 000321   000343 601000 1                  TNZ     s:3589

      853     3582    2      THEN DO I=0 TO RV_NSCPU;

   3582  1 000322   200005 450100                    STZ     I,,AUTO
         1 000323   000337 710000 1                  TRA     NO_CPUSR+3

      854     3583    2           RV_CUN = RV_BUFF.S_CUN(I);

   3583  1 000324   200005 720100                    LXL0    I,,AUTO
         1 000325   000144 235010 xsym               LDA     RV_BUFF+100,X0
         1 000326   000000 755000 xsym               STA     RV_CUN

      855     3584    2           CALL MAP_USER ALTRET(NO_CPUSR);

   3584  1 000327   000635 701000 1                  TSX1    MAP_USER
         1 000330   000334 702000 1                  TSX2    NO_CPUSR

      856     3585    2           CALL IRD$DUMPUSR;

   3585  1 000331   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000332   000000 701000 xent               TSX1    IRD$DUMPUSR
         1 000333   000000 011000                    NOP     0

   3583  1 000334                       NO_CPUSR     null
      857     3586    2   NO_CPUSR: ;
      858     3587    2         END;                              /*DO TO RV_NSCPU                      */

   3587  1 000334   200005 235100                    LDA     I,,AUTO
         1 000335   000001 035007                    ADLA    1,DL
         1 000336   200005 755100                    STA     I,,AUTO
         1 000337   200005 236100                    LDQ     I,,AUTO
         1 000340   000343 604000 1                  TMI     s:3589
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:137  
         1 000341   000000 116000 xsym               CMPQ    RV_NSCPU
         1 000342   000324 604400 1                  TMOZ    s:3583

      859     3588
      860     3589    1      RV_CUN=0;

   3589  1 000343   000000 450000 xsym               STZ     RV_CUN

      861     3590    1      RV_USRTYP = %R_IOUSR#;

   3590  1 000344   000002 220003                    LDX0    2,DU
         1 000345   000000 740000 xsym               STX0    RV_USRTYP

      862     3591    1      RV_SCODEA=RV_IOUSERS;

   3591  1 000346   000024 237000 0                  LDAQ    RV_IOUSERS
         1 000347   000000 757000 xsym               STAQ    RV_SCODEA

      863     3592    1      REMEMBER NXT_IOUSR IN RV_UNWIND1;

   3592  1 000350   000360 635000 1                  EAA     NXT_IOUSR
         1 000351   000000 452400 xsym               STP2    RV_UNWIND1
         1 000352   000001 755000 xsym               STA     RV_UNWIND1+1

      864     3593    1      IF SC.IOUSRS# ='1'B OR SC.ALLUSR#='1'B

   3593  1 000353   200017 236100                    LDQ     SC+1,,AUTO
         1 000354   020000 316007                    CANQ    8192,DL
         1 000355   000360 601000 1                  TNZ     NXT_IOUSR
         1 000356   010000 316007                    CANQ    4096,DL
         1 000357   000372 600000 1                  TZE     DONE2

      865     3594    2      THEN DO WHILE ('1'B);

   3586  1 000360                       NXT_IOUSR    null
      866     3595    2   NXT_IOUSR: ;
      867     3596    2           CALL RVC$CYCUSER ALTRET(DONE2);
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:138  

   3596  1 000360   000622 701000 1                  TSX1    RVC$CYCUSER
         1 000361   000372 702000 1                  TSX2    DONE2

      868     3597    2           IF R$CU$->B$U.MF ~= 0 THEN CALL IRD$DUMPUSR;

   3597  1 000362   000000 470400 xsym               LDP0    R$CU$
         1 000363   000006 236100                    LDQ     6,,PR0
         1 000364   777000 316003                    CANQ    -512,DU
         1 000365   000360 600000 1                  TZE     NXT_IOUSR

   3597  1 000366   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000367   000000 701000 xent               TSX1    IRD$DUMPUSR
         1 000370   000000 011000                    NOP     0

      869     3598    2         END;

   3598  1 000371   000360 710000 1                  TRA     NXT_IOUSR

   3593  1 000372                       DONE2        null
      870     3599    1   DONE2: ;
      871     3600    1      RV_CUN=0;

   3600  1 000372   000000 450000 xsym               STZ     RV_CUN

      872     3601    1      RV_USRTYP = %R_OUSR#;

   3601  1 000373   000003 220003                    LDX0    3,DU
         1 000374   000000 740000 xsym               STX0    RV_USRTYP

      873     3602    1      RV_SCODEA=RV_ALLUSERS;

   3602  1 000375   000026 237000 0                  LDAQ    RV_ALLUSERS
         1 000376   000000 757000 xsym               STAQ    RV_SCODEA

      874     3603    1      IF SC.ALLUSR#='1'B

PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:139  
   3603  1 000377   200017 236100                    LDQ     SC+1,,AUTO
         1 000400   010000 316007                    CANQ    4096,DL
         1 000401   000413 600000 1                  TZE     DONE3

      875     3604    2      THEN DO WHILE ('1'B);

   3597  1 000402                       NXT_ALLUSR   null
      876     3605    2   NXT_ALLUSR: ;
      877     3606    2           REMEMBER NXT_ALLUSR IN RV_UNWIND1;

   3606  1 000402   000402 635000 1                  EAA     NXT_ALLUSR
         1 000403   000000 452400 xsym               STP2    RV_UNWIND1
         1 000404   000001 755000 xsym               STA     RV_UNWIND1+1

      878     3607    2           CALL RVC$CYCUSER ALTRET(DONE3);

   3607  1 000405   000622 701000 1                  TSX1    RVC$CYCUSER
         1 000406   000413 702000 1                  TSX2    DONE3

      879     3608    2           CALL IRD$DUMPUSR;

   3608  1 000407   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000410   000000 701000 xent               TSX1    IRD$DUMPUSR
         1 000411   000000 011000                    NOP     0

      880     3609    2         END;

   3609  1 000412   000402 710000 1                  TRA     NXT_ALLUSR

   3603  1 000413                       DONE3        null
      881     3610    1   DONE3: ;
      882     3611    1      CALL IRR$WUSRDR ALTRET(DISASTER);

   3611  1 000413   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000414   000000 701000 xent               TSX1    IRR$WUSRDR
         1 000415   000416 702000 1                  TSX2    DISASTER

PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:140  
   3603  1 000416                       DISASTER     null
      883     3612    1   DISASTER: ;
      884     3613    1      RETURN;

   3613  1 000416   000000 702200 xent               TSX2  ! X66_ARET

      885     3614        %EJECT;
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:141  
      886     3615           /*
      887     3616            IRF$CLSF is entered with Recovery Descriptors set by IRR$RECOVER
      888     3617            as follows:
      889     3618               DESCRV1 - TIGR
      890     3619               DESCRV2 - CFU
      891     3620               DESCRV3 - ROSEG
      892     3621               DESCRV4 - BUFFERS
      893     3622           */
      894     3623    1   IRD$CLOSE: ENTRY;

   3623  1 000417   000000 700200 xent  IRD$CLOSE    TSX0  ! X66_AUTO_0
         1 000420   000026 000000                    ZERO    22,0

      895     3624    1      SC=RV_SCODEA;

   3624  1 000421   000000 237000 xsym               LDAQ    RV_SCODEA
         1 000422   200016 757100                    STAQ    SC,,AUTO

      896     3625
      897     3626    1      IF (SC.SEV# = %SEV_SCREECH#) OR (SC.SEV# = %SEV_ZAP#)

   3626  1 000423   200016 236100                    LDQ     SC,,AUTO
         1 000424   000007 376007                    ANQ     7,DL
         1 000425   000007 116007                    CMPQ    7,DL
         1 000426   000431 600000 1                  TZE     s:3628
         1 000427   000004 116007                    CMPQ    4,DL
         1 000430   000450 601000 1                  TNZ     DISASTER2

      898     3627    2      THEN DO;

      899     3628    2           RV_CUN=0;

   3628  1 000431   000000 450000 xsym               STZ     RV_CUN

      900     3629    2           RV_USRTYP=%R_TRAPU#;

   3629  1 000432   000005 220003                    LDX0    5,DU
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:142  
         1 000433   000000 740000 xsym               STX0    RV_USRTYP

   3629  1 000434                       CLS_NXT      null
      901     3630    2   CLS_NXT: ;
      902     3631    2           REMEMBER CLS_TRAP IN RV_UNWIND1;

   3631  1 000434   000531 635000 1                  EAA     CLS_TRAP
         1 000435   000000 452400 xsym               STP2    RV_UNWIND1
         1 000436   000001 755000 xsym               STA     RV_UNWIND1+1

      903     3632    3           DO WHILE ('1'B);

      904     3633    3                CALL RVC$CYCUSER ALTRET(DONE4);

   3633  1 000437   000622 701000 1                  TSX1    RVC$CYCUSER
         1 000440   000445 702000 1                  TSX2    DONE4

      905     3634    3                CALL IRF$CLSF ALTRET(CLS_TRAP);

   3634  1 000441   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000442   000000 701000 xent               TSX1    IRF$CLSF
         1 000443   000531 702000 1                  TSX2    CLS_TRAP

      906     3635    3              END;

   3635  1 000444   000437 710000 1                  TRA     s:3633

   3633  1 000445                       DONE4        null
      907     3636    2   DONE4:  ;
      908     3637    2           CALL IRR$WUSRDR ALTRET(DISASTER2);

   3637  1 000445   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000446   000000 701000 xent               TSX1    IRR$WUSRDR
         1 000447   000450 702000 1                  TSX2    DISASTER2

   3633  1 000450                       DISASTER2    null
      909     3638    2   DISASTER2: ;
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:143  
      910     3639    2         END;

      911     3640           /*
      912     3641               Now set Recovery Descriptors 3 & 4 in AARDVARK's Linkage Segment
      913     3642               to contain the Comgroup Page Tables and Comgroup Context
      914     3643               Descriptors from the Monitors Linkage Segment.
      915     3644             */
      916     3645
      917     3646    1      DESCRV3 = RV_CGPT;

   3646  1 000450   000000 237000 xsym               LDAQ    RV_CGPT
         1 000451   000000 757000 xsym               STAQ    DESCRV3

      918     3647    1      R$CGPT$ = I$RV3$;

   3647  1 000452   000000 236000 xsym               LDQ     I$RV3$
         1 000453   000000 756000 xsym               STQ     R$CGPT$

      919     3648
      920     3649    1      DESCRV4 = RV_CGCTXT;

   3649  1 000454   000000 237000 xsym               LDAQ    RV_CGCTXT
         1 000455   000000 757000 xsym               STAQ    DESCRV4

      921     3650    1      R$CGCTXT$ = I$RV4$;

   3650  1 000456   000000 236000 xsym               LDQ     I$RV4$
         1 000457   000000 756000 xsym               STQ     R$CGCTXT$

      922     3651
      923     3652    1      REMEMBER CFU_TRAP IN RV_UNWIND1;

   3652  1 000460   000562 635000 1                  EAA     CFU_TRAP
         1 000461   000000 452400 xsym               STP2    RV_UNWIND1
         1 000462   000001 755000 xsym               STA     RV_UNWIND1+1

      924     3653
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:144  
      925     3654    1      IF (SC.SEV# = %SEV_SCREECH#) OR (SC.SEV# = %SEV_ZAP#)

   3654  1 000463   200016 236100                    LDQ     SC,,AUTO
         1 000464   000007 376007                    ANQ     7,DL
         1 000465   000007 116007                    CMPQ    7,DL
         1 000466   000471 600000 1                  TZE     s:3655
         1 000467   000004 116007                    CMPQ    4,DL
         1 000470   000475 601000 1                  TNZ     s:3659

      926     3655    1      THEN CALL IRF$CFUS;

   3655  1 000471   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000472   000000 701000 xent               TSX1    IRF$CFUS
         1 000473   000000 011000                    NOP     0
         1 000474   000503 710000 1                  TRA     IRD$CLOSE$EXIT

      927     3656                  /* Update FITs for all files and file directories - dump comgroup   */
      928     3657    2      ELSE DO;

      929     3658                                                /* When SUA or SNAP                   */
      930     3659    2           REMEMBER DUMPCG_TRAP IN RV_UNWIND1;

   3659  1 000475   000565 635000 1                  EAA     DUMPCG_TRAP
         1 000476   000000 452400 xsym               STP2    RV_UNWIND1
         1 000477   000001 755000 xsym               STA     RV_UNWIND1+1

      931     3660    2           CALL IRF$DUMPCG;

   3660  1 000500   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000501   000000 701000 xent               TSX1    IRF$DUMPCG
         1 000502   000000 011000                    NOP     0

      932     3661                                                /* Dump the current comgroup, if any  */
      933     3662    2         END;

   3654  1 000503                       IRD$CLOSE$E* null
      934     3663
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:145  
      935     3664    1   IRD$CLOSE$EXIT: ;
      936     3665    1      IF RV_BUFF.CLSFTRAP='1'B

   3665  1 000503   000003 236000 xsym               LDQ     RV_BUFF+3
         1 000504   000200 316007                    CANQ    128,DL
         1 000505   000512 600000 1                  TZE     s:3672

      937     3666    1      THEN CALL IRR$TYPE6M(RVM_CLST,SIZEW(RVM_CLST));

   3666  1 000506   000001 630400 2                  EPPR0   1
         1 000507   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000510   000000 701000 xent               TSX1    IRR$TYPE6M
         1 000511   000000 011000                    NOP     0

      938     3667        /*O*   MESSAGE:   RCVR-TRAP IN IRF$CLSF
      939     3668               MEANING:   Trap in IRF$CLSF.  Typed if RV_DEBUGM set
      940     3669                          non-zero.  RV_BUFF.CLSFTRAP will be set.
      941     3670        */
      942     3671
      943     3672    1      IF RV_BUFF.CFUTRAP='1'B

   3672  1 000512   000003 236000 xsym               LDQ     RV_BUFF+3
         1 000513   000100 316007                    CANQ    64,DL
         1 000514   000521 600000 1                  TZE     s:3679

      944     3673    1      THEN CALL IRR$TYPE6M(RVM_CFU,SIZEW(RVM_CFU));

   3673  1 000515   000003 630400 2                  EPPR0   3
         1 000516   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000517   000000 701000 xent               TSX1    IRR$TYPE6M
         1 000520   000000 011000                    NOP     0

      945     3674        /*O*   MESSAGE:   RCVR-TRAP IN IRF$CFUS
      946     3675               MEANING:   Trap in IRF$CFUS.  Typed if RV_DEBUGM set
      947     3676                          non-zero.  RV_BUFF.CFUTRAP will be set.
      948     3677        */
      949     3678
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:146  
      950     3679    1      IF RV_BUFF.CGQTRAP='1'B

   3679  1 000521   000003 236000 xsym               LDQ     RV_BUFF+3
         1 000522   000400 316007                    CANQ    256,DL
         1 000523   000530 600000 1                  TZE     s:3685

      951     3680    1      THEN CALL IRR$TYPE6M(RVM_CGQ,SIZEW(RVM_CGQ));

   3680  1 000524   000005 630400 2                  EPPR0   5
         1 000525   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000526   000000 701000 xent               TSX1    IRR$TYPE6M
         1 000527   000000 011000                    NOP     0

      952     3681        /*O*    MESSAGE:   RCVR-TRAP IN IRF$DUMPCG
      953     3682                MEANING:   Trap in IRF$DUMPCG.  Typed if RV_DEBUGM set
      954     3683                           non-zero.  RV_BUFF.CGQTRAP will be set.
      955     3684         */
      956     3685    1      RETURN;

   3685  1 000530   000000 702200 xent               TSX2  ! X66_ARET

   3679  1 000531                       CLS_TRAP     null
      957     3686                                                /*                                    */
      958     3687    1   CLS_TRAP: ;
      959     3688    1      RV_BUFF.CLSFTRAP='1'B;

   3688  1 000531   000200 236007                    LDQ     128,DL
         1 000532   000003 256000 xsym               ORSQ    RV_BUFF+3

      960     3689    1      IF RV_PDUMP ~= 0 THEN GOTO CLS_NXT;

   3689  1 000533   000000 235000 xsym               LDA     RV_PDUMP
         1 000534   000434 601000 1                  TNZ     CLS_NXT

      961     3690    1      RV_USRDIR.USER.SZ(RV_CUN) = 0;

   3690  1 000535   000000 235000 xsym               LDA     RV_CUN
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:147  
         1 000536   000001 735000                    ALS     1
         1 000537   000000 220003                    LDX0    0,DU
         1 000540   000001 440005 xsym               SXL0    RV_USRDIR+1,AL

      962     3691    1      REMEMBER DUMP_TRAP IN RV_UNWIND1;

   3691  1 000541   000553 635000 1                  EAA     DUMP_TRAP
         1 000542   000000 452400 xsym               STP2    RV_UNWIND1
         1 000543   000001 755000 xsym               STA     RV_UNWIND1+1

      963     3692    1      RV_SCODEA=SC_CLSTRAP;

   3692  1 000544   000022 237000 0                  LDAQ    SC_CLSTRAP
         1 000545   000000 757000 xsym               STAQ    RV_SCODEA

      964     3693    1      CALL IRD$DUMPUSR;

   3693  1 000546   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000547   000000 701000 xent               TSX1    IRD$DUMPUSR
         1 000550   000000 011000                    NOP     0

      965     3694    1      RV_SCODEA=SC;

   3694  1 000551   200016 237100                    LDAQ    SC,,AUTO
         1 000552   000000 757000 xsym               STAQ    RV_SCODEA

   3694  1 000553                       DUMP_TRAP    null
      966     3695    1   DUMP_TRAP: ;
      967     3696    1      RV_USRDIR.USER.CFTRAP(RV_CUN) ='1'B;

   3696  1 000553   000000 235000 xsym               LDA     RV_CUN
         1 000554   000001 735000                    ALS     1
         1 000555   200000 236003                    LDQ     65536,DU
         1 000556   000001 256005 xsym               ORSQ    RV_USRDIR+1,AL

      968     3697    1      RV_SCODEA=SC;

PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:148  
   3697  1 000557   200016 237100                    LDAQ    SC,,AUTO
         1 000560   000000 757000 xsym               STAQ    RV_SCODEA

      969     3698    1      GOTO CLS_NXT;

   3698  1 000561   000434 710000 1                  TRA     CLS_NXT

   3697  1 000562                       CFU_TRAP     null
      970     3699
      971     3700    1   CFU_TRAP: ;
      972     3701    1      RV_BUFF.CFUTRAP='1'B;

   3701  1 000562   000100 236007                    LDQ     64,DL
         1 000563   000003 256000 xsym               ORSQ    RV_BUFF+3

      973     3702    1      GOTO IRD$CLOSE$EXIT;

   3702  1 000564   000503 710000 1                  TRA     IRD$CLOSE$EXIT

   3701  1 000565                       DUMPCG_TRAP  null
      974     3703
      975     3704    1   DUMPCG_TRAP: ;
      976     3705    1      RV_BUFF.CGQTRAP='1'B;

   3705  1 000565   000400 236007                    LDQ     256,DL
         1 000566   000003 256000 xsym               ORSQ    RV_BUFF+3

      977     3706    1      GOTO IRD$CLOSE$EXIT;

   3706  1 000567   000503 710000 1                  TRA     IRD$CLOSE$EXIT

      978     3707        %EJECT;
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:149  
      979     3708
      980     3709    1   IRD$DHJITS: ENTRY;

   3709  1 000570   000000 700200 xent  IRD$DHJITS   TSX0  ! X66_AUTO_0
         1 000571   000026 000000                    ZERO    22,0

      981     3710    1      IF SC.SHJIT#='0'B THEN RETURN;

   3710  1 000572   200017 236100                    LDQ     SC+1,,AUTO
         1 000573   000200 316003                    CANQ    128,DU
         1 000574   000576 601000 1                  TNZ     s:3712

   3710  1 000575   000000 702200 xent               TSX2  ! X66_ARET

      982     3711
      983     3712    1      REMEMBER NEXT_CPU IN RV_UNWIND1;

   3712  1 000576   000603 635000 1                  EAA     NEXT_CPU
         1 000577   000000 452400 xsym               STP2    RV_UNWIND1
         1 000600   000001 755000 xsym               STA     RV_UNWIND1+1

      984     3713    2      DO I=0 TO RV_NSCPU;

   3713  1 000601   200005 450100                    STZ     I,,AUTO
         1 000602   000615 710000 1                  TRA     s:3720+3

   3713  1 000603                       NEXT_CPU     null
      985     3714    2   NEXT_CPU: ;
      986     3715    2           IF I ~= RV_BUFF.S_PNO

   3715  1 000603   200005 236100                    LDQ     I,,AUTO
         1 000604   000142 116000 xsym               CMPQ    RV_BUFF+98
         1 000605   000612 600000 1                  TZE     s:3720

      987     3716    3           THEN DO;

      988     3717    3                RV_CPNO=I;
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:150  

   3717  1 000606   000000 756000 xsym               STQ     RV_CPNO

      989     3718    3                CALL IRD$DUMPMON;

   3718  1 000607   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000610   000000 701000 xent               TSX1    IRD$DUMPMON
         1 000611   000000 011000                    NOP     0

      990     3719    3              END;                         /*DO IF NOT S_PNO                     */

      991     3720    2         END;                              /*DO 0 TO NSCPU                       */

   3720  1 000612   200005 235100                    LDA     I,,AUTO
         1 000613   000001 035007                    ADLA    1,DL
         1 000614   200005 755100                    STA     I,,AUTO
         1 000615   200005 236100                    LDQ     I,,AUTO
         1 000616   000621 604000 1                  TMI     s:3721
         1 000617   000000 116000 xsym               CMPQ    RV_NSCPU
         1 000620   000603 604400 1                  TMOZ    NEXT_CPU

      992     3721    1      RETURN;

   3721  1 000621   000000 702200 xent               TSX2  ! X66_ARET

      993     3722
      994     3723        %EJECT;
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:151  
      995     3724                                                /*****INTERNAL PROCEDURES  ****/
      996     3725    1   RVC$CYCUSER: PROC ALTRET;

   3725  1 000622   200020 741300       RVC$CYCUSER  STX1  ! SC+2,,AUTO

   3725  1 000623                       NEXT_USER    null
      997     3726    2   NEXT_USER: ;
      998     3727    2      RV_CUN = RV_CUN+1;

   3727  1 000623   000000 054000 xsym               AOS     RV_CUN

      999     3728    2      IF RV_CUN > RV_MUAIS THEN ALTRETURN;

   3728  1 000624   000000 236000 xsym               LDQ     RV_CUN
         1 000625   000000 116000 xsym               CMPQ    RV_MUAIS
         1 000626   000631 604400 1                  TMOZ    s:3729

   3728  1 000627   200020 221300                    LDX1  ! SC+2,,AUTO
         1 000630   000000 702211                    TSX2  ! 0,X1

     1000     3729    2      CALL MAP_USER ALTRET(NEXT_USER);

   3729  1 000631   000635 701000 1                  TSX1    MAP_USER
         1 000632   000623 702000 1                  TSX2    NEXT_USER

     1001     3730    2   END RVC$CYCUSER;

   3730  1 000633   200020 221300                    LDX1  ! SC+2,,AUTO
         1 000634   000001 702211                    TSX2  ! 1,X1

     1002     3731                                                /*                                    */
     1003     3732                                                /*                                    */
     1004     3733                                                /*                                    */
     1005     3734    1   MAP_USER: PROC ALTRET;

   3734  1 000635   200022 741300       MAP_USER     STX1  ! SC+4,,AUTO

PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:152  
     1006     3735    2      IF RV_CUN=0 THEN ALTRETURN;

   3735  1 000636   000000 235000 xsym               LDA     RV_CUN
         1 000637   000641 601000 1                  TNZ     s:3736

   3735  1 000640   000000 702211                    TSX2  ! 0,X1

     1007     3736    2      RV_USTATE = R$USRT$->B$USER.US(RV_CUN);

   3736  1 000641   000004 735000                    ALS     4
         1 000642   000000 470400 xsym               LDP0    R$USRT$
         1 000643   000011 236105                    LDQ     9,AL,PR0
         1 000644   000036 772000                    QRL     30
         1 000645   000000 756000 xsym               STQ     RV_USTATE

     1008     3737    2      IF RV_USTATE= %SS_SNULL THEN ALTRETURN;

   3737  1 000646   000030 116007                    CMPQ    24,DL
         1 000647   000651 601000 1                  TNZ     s:3738

   3737  1 000650   000000 702211                    TSX2  ! 0,X1

     1009     3738    2      R$CU$ = ADDR(R$USRT$->B$USER(RV_CUN));

   3738  1 000651   000000 236000 xsym               LDQ     RV_CUN
         1 000652   000026 736000                    QLS     22
         1 000653   000000 036000 xsym               ADLQ    R$USRT$
         1 000654   000000 756000 xsym               STQ     R$CU$

     1010     3739    2      I$MONIS$->B$WSPTD.BLKNO(%USERWSQ) = R$CU$->B$U.PT;

   3739  1 000655   000000 471400 xsym               LDP1    R$CU$
         1 000656   100014 220100                    LDX0    12,,PR1
         1 000657   000000 473400 xsym               LDP3    I$MONIS$
         1 000660   300010 740100                    STX0    8,,PR3

     1011     3740    2      CALL IRR$MAP;
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:153  

   3740  1 000661   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000662   000000 701000 xent               TSX1    IRR$MAP
         1 000663   000000 011000                    NOP     0

     1012     3741    2      RETURN;

   3741  1 000664   200022 221300                    LDX1  ! SC+4,,AUTO
         1 000665   000001 702211                    TSX2  ! 1,X1
     1013     3742    2   END MAP_USER;
     1014     3743    1   END IRD$DUMP2;

PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:154  
--  Include file information  --

   B_STRINGS_C.:E05TOU  is referenced.
   EL$TABLES.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   IR_DATA_M.:E05TOU  is referenced.
   HF_SCODE_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   JS_CP6.:E05TOU  is referenced.
   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   U$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure IRD$DUMP2.
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:155  

 **** Variables and constants ****

  ****  Section 000 RoData IRD$DUMP2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(24)    r     1 RVM_CFU                   14-0-0/c CHAR(24)    r     1 RVM_CGQ
     6-0-0/c CHAR(24)    r     1 RVM_CLST                  26-0-0/d STRC(72)    r     1 RV_ALLUSERS
    24-0-0/d STRC(72)    r     1 RV_IOUSERS                22-0-0/d STRC(72)    r     1 SC_CLSTRAP

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 BUFF$                      3-0-0/w UBIN        r     1 EL_NXT
     5-0-0/w UBIN        r     1 I                         10-0-0/w SBIN        r     1 JITSPG
     7-0-0/w SBIN        r     1 JITSZ                     16-0-0/d STRC(72)    r     1 SC
    12-0-0/d DSCR        r     1 X_DSCR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/d BIT (72)    r     1 DESCRV3
     0-0-0/d BIT (72)    r     1 DESCRV4                    0-0-0/w PTR         r     1 I$JITU$
     0-0-0/w PTR         r     1 I$MEM$                     0-0-0/w PTR         r     1 I$MONIS$
     0-0-0/w PTR         r     1 I$PPUT$                    0-0-0/w PTR         r     1 I$RV3$
     0-0-0/w PTR         r     1 I$RV4$                     0-0-0/w STRC(72)    r     1 MEMDESC
     0-0-0/w UBIN        r     1 POBUF(0:1023)              0-0-0/w PTR         r     1 R$CGCTXT$
     0-0-0/w PTR         r     1 R$CGPT$                    0-0-0/w PTR         r     1 R$CU$
     0-0-0/w PTR         r     1 R$USRT$                    0-0-0/w SBIN        r     1 RV_BAPAGE
     0-0-0/d STRC(36864) r     1 RV_BUFF                    0-0-0/d BIT (72)    r     1 RV_CGCTXT
     0-0-0/d BIT (72)    r     1 RV_CGPT                    0-0-0/w SBIN        r     1 RV_CPNO
     0-0-0/w SBIN        r     1 RV_CUN                     0-0-0/d STRC(72)    r     1 RV_ENTRY
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:156  
     0-0-0/w SBIN        r     1 RV_MUAIS                   0-0-0/w SBIN        r     1 RV_NSCPU
     0-0-0/w SBIN        r     1 RV_NXTGRAN                 0-0-0/w SBIN        r     1 RV_PDUMP
     0-0-0/d BIT (72)    r     1 RV_SCODEA                  0-0-0/d REMB        r     1 RV_UNWIND1
     0-0-0/d STRC(36864) r     1 RV_USRDIR                  0-0-0/w UBIN(18)    r     1 RV_USRTYP
     0-0-0/w SBIN        r     1 RV_USTATE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d STRC(576)   r     1 B$U
     0-0-0/w STRC(576)   r     1 B$USER(0:0)                0-0-0/w STRC        r     1 B$WSPTD(0:26)
     0-0-0/w STRC(36864) r     1 EL$BUF


   Procedure IRD$DUMP2 requires 438 words for executable code.
   Procedure IRD$DUMP2 requires 22 words of local(AUTO) storage.

    No errors detected in file IRD$DUMP.:E05TSI    .
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:157  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:158  
          MINI XREF LISTING

AJIT_TRAP
      3478**LABEL    3468--REMEMBR
B$DO.ECCINFO
       971**DCL       972--REDEF
B$JIT
       409**DCL      3469--ASSIGN   3481<<ASSIGN   3481>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
       508**DCL       508--REDEF
B$JIT.ERR.MID
       415**DCL       415--REDEF
B$JIT.USER
       414**DCL      3491<<ASSIGN
B$JIT$
       586**DCL       409--IMP-PTR
B$U.MF
       926**DCL      3597>>IF
B$U.MISC
       950**DCL       951--REDEF
B$U.PT
       944**DCL      3739>>ASSIGN
B$USER
       995**DCL      3738--ASSIGN
B$USER.MISC
      1026**DCL      1027--REDEF
B$USER.US
      1013**DCL      3736>>ASSIGN
B$WSPTD.BLKNO
      1038**DCL      3739<<ASSIGN
BGRAN_EL
      3501**LABEL    3527--GOTO
BGRAN_JITS
      3470**LABEL    3502--GOTO
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:159  
BGRAN_LRMEM
      3533**LABEL    3555--GOTO
BUFF$
        13**DCL      3477<<ASSIGN   3481>>ASSIGN   3482<<ASSIGN   3482>>ASSIGN   3491>>ASSIGN
CFU_TRAP
      3697**LABEL    3652--REMEMBR
CLS_NXT
      3629**LABEL    3689--GOTO     3698--GOTO
CLS_TRAP
      3679**LABEL    3631--REMEMBR  3634--CALLALT
DCUSRS
      3569**LABEL    3571--REMEMBR  3574--CALLALT
DERR_EL
      3522**LABEL    3516--CALLALT
DERR_JITS
      3497**LABEL    3485--CALLALT
DERR_LRMEM
      3550**LABEL    3544--CALLALT
DESCRV3
        70**DCL      3646<<ASSIGN
DESCRV4
        71**DCL      3649<<ASSIGN
DIR_ERRL
      3513**LABEL    3506--REMEMBR  3526--GOTO
DIR_JITS
      3490**LABEL    3501--GOTO
DIR_LRM
      3543**LABEL    3534--REMEMBR  3554--GOTO
DISASTER
      3603**LABEL    3611--CALLALT
DISASTER2
      3633**LABEL    3637--CALLALT
DONE
      3486**LABEL    3480--CALLALT
DONE2
      3593**LABEL    3596--CALLALT
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:160  
DONE3
      3603**LABEL    3607--CALLALT
DONE4
      3633**LABEL    3633--CALLALT
DUMPCG_TRAP
      3701**LABEL    3659--REMEMBR
DUMP_TRAP
      3694**LABEL    3691--REMEMBR
D_CUSR
      3560**LABEL    3562--REMEMBR  3565--CALLALT
EL$BUF.NXTBUF
      3333**DCL      3515>>ASSIGN
EL_NXT
        11**DCL      3510<<ASSIGN   3512>>DOWHILE  3513>>ASSIGN   3514>>ASSIGN   3515<<ASSIGN
I
        14**DCL      3478<<DOINDEX  3490>>IF       3542<<DOINDEX  3543>>ASSIGN   3582<<DOINDEX  3583>>ASSIGN
      3713<<DOINDEX  3715>>IF       3717>>ASSIGN
I$JITU$
        59**DCL      3481>>ASSIGN
I$MEM$
        60**DCL      3515>>ASSIGN
I$MONIS$
        61**DCL      3739>>ASSIGN
I$PPUT$
        64**DCL      3539>>ASSIGN
I$RV3$
        62**DCL      3647>>ASSIGN
I$RV4$
        63**DCL      3650>>ASSIGN
IRD$CLOSE$EXIT
      3654**LABEL    3702--GOTO     3706--GOTO
IRD$DUMPMON
        81**DCL-ENT  3718--CALL
IRD$DUMPUSR
        82**DCL-ENT  3566--CALL     3575--CALL     3585--CALL     3597--CALL     3608--CALL     3693--CALL
IRF$CFUS
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:161  
        84**DCL-ENT  3655--CALL
IRF$CLSF
        83**DCL-ENT  3634--CALL
IRF$DUMPCG
        85**DCL-ENT  3660--CALL
IRR$MAP
        76**DCL-ENT  3740--CALL
IRR$TYPE6M
        77**DCL-ENT  3666--CALL     3673--CALL     3680--CALL
IRR$WDUMP
        78**DCL-ENT  3516--CALL     3544--CALL
IRR$WPOBUFF
        80**DCL-ENT  3485--CALL
IRR$WUSRDR
        79**DCL-ENT  3611--CALL     3637--CALL
JITSPG
        17**DCL      3470<<ASSIGN   3478>>DOINDEX
JITSZ
        16**DCL      3469<<ASSIGN   3470>>ASSIGN   3482>>ASSIGN
MAP_USER
      3734**PROC     3565--CALL     3574--CALL     3584--CALL     3729--CALL
MEMDESC.BADDR
        57**DCL      3513<<ASSIGN
MORE_JITS
      3475**LABEL    3487--GOTO
NEXT_CPU
      3713**LABEL    3712--REMEMBR
NEXT_USER IN PROCEDURE RVC$CYCUSER
      3725**LABEL    3729--CALLALT
NO_CPUSR
      3583**LABEL    3580--REMEMBR  3584--CALLALT
NXT_ALLUSR
      3597**LABEL    3606--REMEMBR
NXT_IOUSR
      3586**LABEL    3592--REMEMBR
POBUF
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:162  
        73**DCL      3477--ASSIGN
R$CGCTXT$
        35**DCL      3650<<ASSIGN
R$CGPT$
        36**DCL      3647<<ASSIGN
R$CU$
        37**DCL      3597>>IF       3738<<ASSIGN   3739>>ASSIGN
R$USRT$
        38**DCL      3736>>ASSIGN   3738>>ASSIGN
RVC$CYCUSER
      3725**PROC     3480--CALL     3596--CALL     3607--CALL     3633--CALL
RVM_CFU
        19**DCL      3673<>CALL     3673--CALL
RVM_CGQ
        23**DCL      3680<>CALL     3680--CALL
RVM_CLST
        21**DCL      3666<>CALL     3666--CALL
RV_ALLUSERS
      2305**DCL      3602>>ASSIGN
RV_BAPAGE
        40**DCL      3514<<ASSIGN   3543<<ASSIGN
RV_BUFF.CFUTRAP
      2939**DCL      3672>>IF       3701<<ASSIGN
RV_BUFF.CGQTRAP
      2939**DCL      3679>>IF       3705<<ASSIGN
RV_BUFF.CLSFTRAP
      2939**DCL      3665>>IF       3688<<ASSIGN
RV_BUFF.CUN
      2948**DCL      3573>>ASSIGN
RV_BUFF.EL_FIRSTBUF
      2953**DCL      3510>>ASSIGN
RV_BUFF.ERRLOG
      2956**DCL      3522<<ASSIGN
RV_BUFF.JITS
      2956**DCL      3496<<ASSIGN
RV_BUFF.LRMEM
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:163  
      2957**DCL      3549<<ASSIGN
RV_BUFF.PPUT.FP
      2955**DCL      3540<<ASSIGN
RV_BUFF.PPUT.LP
      2955**DCL      3541<<ASSIGN   3542>>DOINDEX
RV_BUFF.SIZE
      2938**DCL      3497<<ASSIGN   3497>>ASSIGN   3550<<ASSIGN   3550>>ASSIGN
RV_BUFF.SNAPU#
      2941**DCL      3564>>ASSIGN
RV_BUFF.S_CUN
      2949**DCL      3583>>ASSIGN
RV_BUFF.S_PNO
      2949**DCL      3715>>IF
RV_CGCTXT
        41**DCL      3649>>ASSIGN
RV_CGPT
        42**DCL      3646>>ASSIGN
RV_CPNO
        43**DCL      3717<<ASSIGN
RV_CUN
        44**DCL      3475<<ASSIGN   3564<<ASSIGN   3573<<ASSIGN   3583<<ASSIGN   3589<<ASSIGN   3600<<ASSIGN
      3628<<ASSIGN   3690>>ASSIGN   3696>>ASSIGN   3727<<ASSIGN   3727>>ASSIGN   3728>>IF       3735>>IF
      3736>>ASSIGN   3738>>ASSIGN
RV_ENTRY
        26**DCL      3473<<ASSIGN   3496>>ASSIGN   3508<<ASSIGN   3522>>ASSIGN   3537<<ASSIGN   3549>>ASSIGN
RV_ENTRY.DA
        27**DCL      3474<<ASSIGN   3509<<ASSIGN   3538<<ASSIGN
RV_ENTRY.SZ
        33**DCL      3486<<ASSIGN   3486>>ASSIGN   3497>>ASSIGN   3517<<ASSIGN   3517>>ASSIGN   3545<<ASSIGN
      3545>>ASSIGN   3550>>ASSIGN
RV_IOUSERS
      2243**DCL      3591>>ASSIGN
RV_MUAIS
        45**DCL      3728>>IF
RV_NSCPU
        46**DCL      3582>>DOINDEX  3713>>DOINDEX
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:164  
RV_NXTGRAN
        47**DCL      3474>>ASSIGN   3509>>ASSIGN   3538>>ASSIGN
RV_PDUMP
        48**DCL      3501>>IF       3526>>IF       3554>>IF       3689>>IF
RV_SCODEA
        49**DCL      3532>>ASSIGN   3559>>ASSIGN   3591<<ASSIGN   3602<<ASSIGN   3624>>ASSIGN   3692<<ASSIGN
      3694<<ASSIGN   3697<<ASSIGN
RV_UNWIND1
        50**DCL      3468<<REMEMBR  3506<<REMEMBR  3534<<REMEMBR  3562<<REMEMBR  3571<<REMEMBR  3580<<REMEMBR
      3592<<REMEMBR  3606<<REMEMBR  3631<<REMEMBR  3652<<REMEMBR  3659<<REMEMBR  3691<<REMEMBR  3712<<REMEMBR
RV_USRDIR.USER.CFTRAP
      2974**DCL      3696<<ASSIGN
RV_USRDIR.USER.SZ
      2975**DCL      3690<<ASSIGN
RV_USRTYP
        51**DCL      3563<<ASSIGN   3572<<ASSIGN   3579<<ASSIGN   3590<<ASSIGN   3601<<ASSIGN   3629<<ASSIGN
RV_USTATE
        52**DCL      3736<<ASSIGN   3737>>IF
RV_WSQD.PG.SFLG
      2978**DCL      2978--REDEF
SC
      2111**DCL      3532<<ASSIGN   3559<<ASSIGN   3624<<ASSIGN   3694>>ASSIGN   3697>>ASSIGN
SC.ALLUSR#
      2145**DCL      3593>>IF       3603>>IF
SC.AUSER#
      2151**DCL      3560>>IF
SC.CUSR#
      2144**DCL      3569>>IF
SC.CUSRS#
      2145**DCL      3569>>IF       3581>>IF
SC.IOUSRS#
      2145**DCL      3593>>IF
SC.LRM#
      2138**DCL      3533>>IF
SC.PPUT#
      2141**DCL      3533>>IF
PL6.E3A0      #002=IRD$DUMP2 File=IRD$DUMP.:E05TSI                               TUE 07/29/97 22:43 Page:165  
SC.SEV#
      2138**DCL      3569>>IF       3581>>IF       3626>>IF       3626>>IF       3654>>IF       3654>>IF
SC.SHJIT#
      2142**DCL      3710>>IF
SC_CLSTRAP
      2181**DCL      3692>>ASSIGN
WRPAGE
      3479**LABEL    3492--GOTO
X_DSCR
        66**DCL      3539<<ASSIGN   3540>>ASSIGN   3541>>ASSIGN   3541>>ASSIGN
