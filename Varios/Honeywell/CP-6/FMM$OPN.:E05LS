VERSION E05

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:1    
        1        1        /*M*  FMM$OPN - MERGE OPEN FPT INTO THE DCB.    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* NSO,MCL=0,MOC,MEC,CLM=12,EXM=12,CRT=6,DMR,PLM=3,IND=0,IAD=3,ENU=0,DCI=3,
        8        8        CSU=3,ECU=3,THI=0,DTI=0,CRM=86 */
        9        9                    /**/
       10       10                    /*P*  NAME:     FMM$OPN
       11       11                     PURPOSE:  MERGE OPEN FPT (OR ASSIGN MERGE RECORD) INTO THE
       12       12                     DESIGNATED DCB.
       13       13                     DESCRIPTION:  FMM$OPN IS CALLED BY THE PMME PROCESSOR TO
       14       14                     PROCESS AN M$OPEN PMME.  PARAMETERS ARE PASSED
       15       15                     IN THE PARAMETER STACK WITH THE EXCEPTION OF
       16       16                     THE DCB POINTER WHICH IS PLACED IN THE JIT
       17       17                     PRIOR TO THE CALL TO FMM$OPN.
       18       18                    */
       19       19                    /**/
       20       20                    /*D*  NAME:     FMM$OPN
       21       21                     CALL:     CALL FMM$OPN
       22       22                     INPUT:    PARAMETER STACK CONTAINS PTRS TO FPT AREAS.
       23       23                     B$JIT.DCB$ -> CURRENT DCB
       24       24                     OUTPUT:  OPEN DCB WITH INFORMATION MERGED.
       25       25                     DESCRIPTION:  OPEN PARAMETERS 'SCRUB','REASSIGN', AND 'SETDCB'
       26       26                     INDICATE THE TYPE OF MERGE TO BE DONE.
       27       27                     ALL PARAMETERS = NO, NORMAL OPEN.
       28       28                     SCRUB = YES, SCRUB DCB THEN REINITIALIZE
       29       29                     TO LOADER BUILT CONDITIONS.
       30       30                     REASSIGN = YES, REMERGE THE ASSIGN MERGE RECORD.
       31       31                     ALL CASES:
       32       32                     MERGE OPEN FPT.
       33       33                     SETDCB = YES, DO NOT OPEN DCB AFTER FPT MERGE.
       34       34                     FOR ALL CASES EXCEPT SETDCB, THE OPEN PROCESS
       35       35                     CONTINUES WITH A FAN OUT ON THE DCB ASSIGNMENT TYPE
       36       36                     (FILE, TAPE, OR DEVICE) TO COMPLETE THE SPECIFIC OPEN.
       37       37                     FMM$OPN BUILDS AN ARRAY OF POINTERS DESCRIBING THE
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:2    
       38       38                     ADDRESSES OF EACH OF THE OPENFPT PARAMETERS FOR THE
       39       39                     INTERNAL OPEN ROUTINES.  THEY ARE EITHER 'NULL' IF
       40       40                     NO DATA IS ASSOCIATED WITH THAT PARAMETER OR THE
       41       41                     POINTER TO THE DATA AREA IN THE ASSIGN MERGE BUFFER,
       42       42                     THE IFPARAM BUFFER, OR THE OPEN FPT.  THESE PTRS
       43       43                     ARE PASSED AS INPUT TO THE SPECIFIC OPEN ROUTINES.
       44       44                    */
       45       45                    /**/
       46       46        FMM$OPN: PROC;
       47       47                    /**/
       48       48        %MACRO F$DCB#(BASED=BASED);
       49       49        %INCLUDE F$DCB;
       50       98        %MEND;
       51       99        %INCLUDE F_CP6;
       52     1124        %INCLUDE F$CP6P_C;
       53     1135        %INCLUDE KC_CP6;
       54     1695        %INCLUDE KI_CP6;
       55     2791        %INCLUDE FM_FIELD_C;
       56     2832        %FPT$OPEN_P(FPTN=FPT,PFMT=PTR,STCLASS="BASED(FPT$)");
       57     2838        %VLP_ACCT(STCLASS="BASED(FPT$)",FPTN=VLP$ACCT);
       58     2851        %VLP_PASS(STCLASS="BASED(FPT$)",FPTN=VLP$PASS);
       59     2864        %VLP_SN(STCLASS="BASED(FPT$)",FPTN=VLP$SN);
       60     2877        %VLP_TAB(STCLASS="BASED(FPT$)",FPTN=VLP$TAB);
       61     2891        %VLP_WSN(STCLASS="BASED(FPT$)",FPTN=VLP$WSN);
       62     2904        %VLP_FORM(STCLASS="BASED(FPT$)",FPTN=VLP$FORM);
       63     2917        %VLP_HDR(LEN=1,STCLASS="BASED(FPT$)",FPTN=VLP$HDR);
       64     2933        %VLP_HDR (FPTN=VLP$HDRF, LEN=163, STCLASS=BASED);
       65     2949        %VLP_STATION(STCLASS=BASED,FPTN=VLP$STATION);
       66     2976        %VLP_SETSTA(STCLASS="BASED(FPT$)",FPTN=VLP$SETSTA);
       67     3004        %VLP_ALTKEYS (FPTN=VLP$ALTKEYS,STCLASS="BASED(FPT$)");
       68     3019        %VLP_FPRG (STCLASS="BASED(FPT$)", FPTN=VLP$FPRG);
       69     3040        %VLP_IRKEYS (STCLASS="BASED(FPT$)", FPTN=VLP$IRKEYS);
       70     3055        %VLP_RECFIELD (STCLASS="BASED(FIELD$)", FPTN=VLP$RECFIELD);
       71     3099        %VLP_IRREC (STCLASS="BASED(IRREC$)",FPTN=VLP$IRREC);
       72     3113        %INCLUDE FM$MACROS;
       73     3488        %CODE16(BASED="BASED(TEMP$)");
       74     3496        %FITALTKEYS (BASED="BASED(ALTKEY$)");
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:3    
       75     3502        %FM$GRAN;
       76     3506        %INCLUDE B$ROSEG;
       77     3569        %F$DCB#(BASED="BASED(JDCB$)");
       78     3619        %INCLUDE F$CP6V_C;
       79     3845        %FPT$GETDCB_V;
       80     3848        %FPT$RELDCB_V;
       81     3851        %FPT$OPEN_V(BASED="BASED(FPT$)");
       82     3866        %VLP$VIRTUAL_V;
       83     3871        %FMG$KFIELD (FPTN=KFIELD, STCLASS="BASED(KFIELD$)");
       84     3874        %FM$FIELD_START (FPTN=FM$FIELD_START,STCLASS="BASED(START$)");
       85     3896        %INCLUDE FM_OPLBL_R;
       86     3910        %INCLUDE B$TABLES_C;
       87     4018        %B$XL_UPPER_UR;
       88     4022        %INCLUDE B$JIT_C;
       89     4336        %B$JIT0;
       90     4425        %U$JIT1;
       91     4499        %M$JIT2X;
       92     4502        %F$JIT3;
       93     4507        %S$JIT4;
       94     4513        %J$JIT5X;
       95     4516        %A$JIT6X;
       96     4519        %INCLUDE CP_6_SUBS;
       97     5059        %INCLUDE F_ERRORS_C;
       98     5299        %INCLUDE UD_ERRORS_C;
       99     5341        %SUB FCG#='0615'O;
      100     5342        %SUB MID#='15'O;
      101     5343        %SUB SNX=1/*SNX*/;
      102     5344        %SUB ULBLX=2/*ULBLX*/;
      103     5345        %SUB NAMEX=3/*NAMEX*/;
      104     5346        %SUB PASSX=4/*PASSX*/;
      105     5347        %SUB ACCESSX=5/*ACCESSX*/;
      106     5348        %SUB ACSVEHX=6/*ACSVEHX*/;
      107     5349        %SUB UATTRX=7/*UATTRX*/;
      108     5350        %SUB INSTATTRX=8/*INSTATTRX*/;
      109     5351        %SUB PROCATTRX=9/*PROCATTRX*/;
      110     5352        %SUB ACCTX=10/*ACCTX*/;
      111     5353        %SUB IFPARAMX=11/*IFPARAMX*/;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:4    
      112     5354        %SUB FPARAMX=12/*FPARAMX*/;
      113     5355        %SUB WSNX=13/*WSNX*/;
      114     5356        %SUB TABX=14/*TABX*/;
      115     5357        %SUB HDRX=15/*HDRX*/;
      116     5358        %SUB FORMX=16/*FORMX*/;
      117     5359        %SUB ALTKX=17/*ALTKX*/;
      118     5360        %SUB TOPX=17/*TOPX*/;
      119     5361                    /**/
      120     5362                    /* SYMREF DATA */
      121     5363                    /**/
      122     5364    1   DCL B$PS$(0:19) PTR SYMREF; /* PARAMETER SEGMENT POINTERS */
      123     5365    1   DCL B$ROSEG$ PTR SYMREF; /* PTR TO READ ONLY SEGMENT */
      124     5366    1   DCL B$JIT$ PTR SYMREF; /* POINTER TO THE JIT */
      125     5367    1   DCL FMM$SDCB CHAR(100)SYMREF;
      126     5368                    /**/
      127     5369                    /* DEFINE EXTERNAL ROUTINES */
      128     5370                    /**/
      129     5371    1   DCL FMM$IFPARAM ENTRY(1) ALTRET;
      130     5372    1   DCL FMM$SCRUB ENTRY(1); /* SCRUB THE DCB */
      131     5373    1   DCL FMM$SCRUB1 ENTRY(1); /* SCRUB DCB AT STEP TIME */
      132     5374    1   DCL FMM$SCRAMBLE ENTRY(1); /* SCRAMBLE THE PASSWORD */
      133     5375    1   DCL FMM$GETAMR ENTRY(2) ALTRET; /* GET THE ASSIGN/MERGE RECORD */
      134     5376    1   DCL FMD$GETBUF ENTRY(3); /* GET FM BUFFER */
      135     5377    1   DCL FMD$RELBUF ENTRY(1); /* RELEASE FM BUFFER */
      136     5378    1   DCL FMF$REMOTE ENTRY(1);
      137     5379    1   DCL FMM$OPNAMR ENTRY ALTRET; /* OPEN *A THRU JIT.DCB$ */
      138     5380    1   DCL FMM$READAMR ENTRY(2) ALTRET; /* READ ASSIGN MERGE RECORD */
      139     5381    1   DCL FMO$GETDOMAIN ENTRY(1); /* GET CALLING USER DOMAIN */
      140     5382    1   DCL FMP$CLSTAR ENTRY; /* CLOSE ASSIGN MERGE FILE */
      141     5383    1   DCL HFF$DSIZ ENTRY(2);
      142     5384    1   DCL HFF$NIL ENTRY(1) ALTRET; /* CHECK PARAMETER FOR NIL */
      143     5385    1   DCL HFF$ERASE ENTRY(1) ALTRET; /* CHECK PARAMETER FOR ERASE */
      144     5386    1   DCL HFF$NILERASE ENTRY(1) ALTRET;
      145     5387    1   DCL HFF$TRAPALT ENTRY ALTRET;
      146     5388    1   DCL HFF$WRITE1 ENTRY(1)ALTRET;
      147     5389    1   DCL FMN$OPNF ENTRY(1); /* FILE OPEN ENTRY */
      148     5390    1   DCL FTO$OPNAT ENTRY(1); /* TAPE OPEN ENTRY */
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:5    
      149     5391    1   DCL FPO$OPNOD ENTRY(1) ALTRET; /* Optical Disk File Open Entry */
      150     5392    1   DCL FSA$GSP ENTRY(2) ALTRET; /* GET ROSEG SPACE */
      151     5393    1   DCL FSA$FSP ENTRY(2) ALTRET; /* FREE ROSEG SPACE */
      152     5394    1   DCL FSN$OPNDEV ENTRY(1); /* DEVICE OPEN ENTRY */
      153     5395    1   DCL KCO$OPCG ENTRY(1); /* COMGROUP OPEN ENTRY */
      154     5396    1   DCL FMG$IRSETUP ENTRY(1) ALTRET;
      155     5397    1   DCL NAO$OPN ENTRY;
      156     5398                    /**/
      157     5399                    /* CONSTANT DATA */
      158     5400                    /**/
      159     5401    1   DCL FM_DFLOPN_V(0:11) BIT(72) CONSTANT SYMDEF INIT('0'B*0);
      160     5402        %ERRCODE(NAME=FMM$E$DCBOPEN,COD#=%E$DCBOPEN,SEV#=0);
      161     5406        %ERRCODE(NAME=FMM$E$NOSLOTS,COD#=%E$NOSLOTS);
      162     5410        %ERRCODE(NAME=FMM$E$BADDCBNAME,COD#=%E$BADDCBNAME);
      163     5414        %ERRCODE(NAME=FMM$E$DCBHERE,COD#=%E$DCBHERE,SEV#=0);
      164     5418        %ERRCODE(NAME=FMM$E$INVASN,COD#=%E$INVASN);
      165     5422        %ERRCODE(NAME=FMM$E$NOCODE,COD#=0);
      166     5426        %ERRCODE (NAME=FMM$E$CODE, SEV#=0, MON#='1'B, COD#=16383, FCG#='0'O, MID#='0'O);
      167     5430        %ERRCODE (NAME=FMM$E$BADVECT2, COD#=%E$BADVECT2);
      168     5434        %ERRCODE (NAME=FMM$E$BADVECT14, COD#=%E$BADVECT14);
      169     5438        %ERRCODE(NAME=FMM$E$BADVECT15,COD#=%E$BADVECT15);
      170     5442        %ERRCODE (NAME=FMM$E$BADVECT16, COD#=%E$BADVECT16);
      171     5446        %ERRCODE (NAME=FMM$E$BADVECT17, COD#=%E$BADVECT17);
      172     5450        %ERRCODE(NAME=FMM$E$DOMAIN,COD#=%E$DOMAIN);
      173     5454        %ERRCODE(NAME=FMM$E$BADDCB#,COD#=%E$BADDCB#);
      174     5458    1   DCL FUN(0:4) UBIN CONSTANT INIT(%IN#, /* Default FUN */
      175     5459    1     %IN#,     /* FILE */
      176     5460    1     %IN#,     /* TAPE */
      177     5461    1     %UPDATE#, /* DEVICE */
      178     5462    1    %UPDATE#); /* COMGROUP */
      179     5463                    /* DEFAULT OPEN FPT OPTIONS */
      180     5464                    /**/
      181     5465                    /* AUTOMATIC DATA */
      182     5466                    /**/
      183     5467    1   DCL JDCB$ PTR; /* DCB POINTER */
      184     5468    1   DCL FPT$ PTR; /* PTR TO CURRENT FPT ENTRY */
      185     5469    1   DCL BUF$ PTR; /* AMR POINTER */
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:6    
      186     5470    1   DCL TEMP$ PTR;
      187     5471    1   DCL ALTKEY$ PTR;
      188     5472    1   DCL KFIELD$ PTR;
      189     5473    1   DCL N SBIN;
      190     5474    1   DCL NKEYS SBIN;
      191     5475    1   DCL FIELD$ PTR;
      192     5476    1   DCL START$ PTR;
      193     5477    1   DCL IRREC$ PTR;
      194     5478    1   DCL PN$(0:TOPX)PTR; /* DEFINE OPEN POINTER ARRAY */
      195     5479    1   DCL I UBIN; /* INDEX */
      196     5480    1   DCL J UBIN; /* INDEX */
      197     5481    1   DCL AMRF BIT(36) ALIGNED; /* SOURCE FLAG (AMR OR OPEN FPT) */
      198     5482                    /**/
      199     5483                    /* BASED DATA NOT IN INCLUDE FILES */
      200     5484                    /**/
      201     5485    1   DCL AMRX (0:15) UBIN HALF BASED(BUF$) ALIGNED; /* AMR PARAMETER INDEXES */
      202     5486    1   DCL DCBP (0:0) PTR BASED ALIGNED; /* USER DCB POINTERS */
      203     5487    1   DCL 1 NAME BASED (FPT$), /* DCBNAME MAP  FOR OPLBL CHECK */
      204     5488    1         2 S BIT(27),
      205     5489    1         2 OP CHAR(2) UNAL;
      206     5490    1   DCL K UBIN; /* INDEX */
      207     5491    1   DCL 1 FN REDEF K,
      208     5492    1         2 * BIT(27) UNAL,
      209     5493    1         2 L CHAR(1) UNAL;
      210     5494    1   DCL 1 FF BASED,
      211     5495    1         2 CHARX CHAR(1) UNAL,
      212     5496    1         2 RECX CHAR(K) UNAL;
      213     5497    1   DCL MOVEKC CHAR(K) BASED;
      214     5498    1   DCL 1 MOVEKB BASED,2 * CHAR(K);
      215     5499    1   DCL 1 MOVEJB BASED,2 * CHAR(J);
      216     5500    1   DCL WRD(0:1023) UBIN BASED ALIGNED;
      217     5501    1   DCL TDCB$ PTR; /* Copy of JDCB$ for use in calls */
      218     5502        %EJECT;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:7    
      219     5503                    /**/
      220     5504                    /*
      221     5505                    *  GET THE DCB ADDRESS
      222     5506                    */
      223     5507    1      JDCB$=B$JIT$->B$JIT.DCB$;
      224     5508    1      TDCB$=JDCB$;
      225     5509    1      CALL FMO$GETDOMAIN(I);
      226     5510    2      IF F$DCB.FCD THEN DO;
      227     5511    3         IF I=4 AND F$DCB.ASN=%COMGROUP# AND JDCB$=DCBADDR(%M$UC#) THEN DO;
      228     5512                    /* Allow CP to change SETSTA for TP users */
      229     5513    3            CALL HFF$NILERASE(ULBLX) ALTRET(ERR1);
      230     5514    3            FPT$=B$PS$(ULBLX);
      231     5515    3            F$DCB.SETSTA$->VLP$SETSTA.ISTA=VLP$SETSTA.ISTA;
      232     5516    3            F$DCB.SETSTA$->VLP$SETSTA.OSTA=VLP$SETSTA.OSTA;
      233     5517    3            RETURN;
      234     5518    3            END;
      235     5519    2         GOTO ERR1;
      236     5520    2         END;
      237     5521                    /*E*     ERROR: FMM-E$DCBOPEN-C
      238     5522                    *        MESSAGE:DCB% %DC% is still open.
      239     5523                    *     DESCRIPTION:  ATTEMPT TO OPEN A DCB THAT IS ALREADY OPEN.
      240     5524                    */
      241     5525    1      IF DCBADDR(1)=JDCB$ AND I~=0 THEN GOTO FMME$DOMAIN;
      242     5526                    /*E*     ERROR: FMM-E$DOMAIN-E
      243     5527                    *        MESSAGE: M$* must be opened by CP-6.
      244     5528                    */
      245     5529                    /*
      246     5530                    *  SCRUB V AREAS OF DCB IF REQUESTED
      247     5531                    *  GET ASSIGN MERGE RECORD IF WE NEED IT
      248     5532                    *  REMERGE ASSIGNS IF REQUESTED
      249     5533                    */
      250     5534    1      FPT$=B$PS$(0);
      251     5535    1      IF FPT$OPEN_V.INITZ.SCRUB THEN CALL FMM$SCRUB(TDCB$);
      252     5536    1      F$DCB.WSR=I;
      253     5537    1      F$DCB.DCB#=FPT$OPEN_V.DCB#;
      254     5538    1      CALL HFF$TRAPALT ALTRET(RETRET);
      255     5539    1      F$DCB.BFR(0)='0'B;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:8    
      256     5540    2      IF FPT$OPEN_V.INITZ.REASSIGN THEN DO;
      257     5541    2         CALL FMM$GETAMR(TDCB$,BUF$)ALTRET(NORMOPN);
      258     5542    2         CALL FMM$MERGE1 ALTRET(ERRORX);
      259     5543    2         END;
      260     5544                    /*
      261     5545                    *  BEGIN BY INITIALIZING ALL PTRS TO NIL
      262     5546                    */
      263     5547    2   NORMOPN: DO I=0 TO TOPX;
      264     5548    2         PN$(I)=ADDR(NIL);
      265     5549    2         END;
      266     5550    1      B$JIT.ERR='0'B;
      267     5551                    /*
      268     5552                    *  CHECK IF IFPARAM$ WAS SPECIFIED AND IF SO, FILL IN THE
      269     5553                    *  SPECIFIC POINTERS FROM THE FIT INFORMATION BUFFER.
      270     5554                    */
      271     5555    1      CALL HFF$NILERASE(IFPARAMX)ALTRET(NORMOPN1);
      272     5556    1      IF B$PS$(0)->FPT$OPEN_V.ASN=%DEVICE#
      273     5557    1        OR B$PS$(0)->FPT$OPEN_V.ASN=0 AND F$DCB.ASN=%DEVICE#
      274     5558    1      THEN GOTO NORMOPN1; /* IFPARAM is useless for devices */
      275     5559    1      PN$(IFPARAMX)=B$PS$(IFPARAMX);
      276     5560    1      IF B$PS$(0)->FPT$OPEN_V.ACS=%BLOCK#
      277     5561    1        AND B$JIT.PRIV.ACTIVE&%PR_FMBLK#
      278     5562    1      THEN PN$(IFPARAMX)=PINCRW(PN$(IFPARAMX),SIZEW(FM$GRAN));
      279     5563    1      CALL FMM$IFPARAM(PN$) ALTRET(ERRORX);
      280     5564                    /*
      281     5565                    *  THEN SET UP POINTERS BASED ON WHETHER THEY WERE
      282     5566                    *  SPECIFIED OR NOT IN THE FPT.
      283     5567                    */
      284     5568    1   NORMOPN1:
      285     5569    2      DO I=0 TO TOPX;
      286     5570    2         CALL HFF$NIL(I) ALTRET(CONTOPN);
      287     5571    2         CALL HFF$ERASE(I) ALTRET(ERASURES);
      288     5572    2         PN$(I)=B$PS$(I); /* NOT NIL OR ERASE, SET TO PARAM STACK */
      289     5573    2         GOTO CONTOPN;
      290     5574                    /*
      291     5575                    *  ERASE THE SPECIFIED AREAS OF THE DCB IF THE POINTER IS THE
      292     5576                    *  ADDR(ERASE).
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:9    
      293     5577                    */
      294     5578    2   ERASURES: PN$(I)=ADDR(NIL);
      295     5579    3         DO CASE(I);
      296     5580                    /**/
      297     5581    3         CASE(ULBLX);
      298     5582    3            IF F$DCB.LASTSTA$~=ADDR(NIL)
      299     5583    3            THEN CALL FSA$FSP(SIZEW(VLP$STATION)+SIZEW(VLP$SETSTA),F$DCB.LASTSTA$);
      300     5584    3            F$DCB.SETSTA$=ADDR(NIL);
      301     5585                    /**/
      302     5586    3         CASE(NAMEX);
      303     5587    3            F$DCB.NAME.L=0;
      304     5588    3            F$DCB.NAME.C=' ';
      305     5589    3            B$JIT$->B$JIT.FEXT(F$DCB.FEXTX)='0'B;
      306     5590                    /**/
      307     5591    3         CASE(ACCTX);
      308     5592    3            F$DCB.ACCT=' ';
      309     5593                    /**/
      310     5594    3         CASE(PASSX);
      311     5595    3            F$DCB.PASSF='0'B;
      312     5596    3            F$DCB.PASS=' ';
      313     5597                    /**/
      314     5598    3         CASE(ACCESSX);
      315     5599    3            F$DCB.AMFLG.ACCF='0'B;
      316     5600                    /**/
      317     5601    3         CASE(ACSVEHX);
      318     5602    3            F$DCB.AMFLG.ACSF='0'B;
      319     5603                    /**/
      320     5604    3         CASE(UATTRX);
      321     5605    3            F$DCB.AMFLG.USRF='0'B;
      322     5606                    /**/
      323     5607    3         CASE(INSTATTRX);
      324     5608    3            F$DCB.AMFLG.INSF='0'B;
      325     5609                    /**/
      326     5610    3         CASE(PROCATTRX);
      327     5611    3            F$DCB.AMFLG.PROF='0'B;
      328     5612                    /**/
      329     5613                    /**/
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:10   
      330     5614    3         CASE(SNX);
      331     5615    3            F$DCB.AMFLG.SNLF='0'B;
      332     5616    3            F$DCB.PSN=' ';
      333     5617                    /**/
      334     5618    3         CASE(WSNX);
      335     5619    3            F$DCB.WSN=' ';
      336     5620                    /**/
      337     5621    3         CASE(TABX);
      338     5622    3            IF F$DCB.TAB$~=ADDR(NIL)
      339     5623    3            THEN CALL FSA$FSP(SIZEW(VLP$TAB),F$DCB.TAB$);
      340     5624
      341     5625    4            IF F$DCB.FIELDX>0 THEN DO;
      342     5626    4               FIELD$=PINCRW(B$ROSEG$, F$DCB.FIELDX);
      343     5627    4               J=(VLP$RECFIELD.NFIELDS#+1)/2 +1;
      344     5628    4               CALL FSA$FSP(J, ALTKEY$);
      345     5629    4               F$DCB.FIELDX=0;
      346     5630    4               END;
      347     5631
      348     5632    4            IF F$DCB.STARTX > 0 THEN DO;
      349     5633    4               START$ = PINCRW(B$ROSEG$,F$DCB.STARTX);
      350     5634    4               J=FM$FIELD_START.NWORDS;
      351     5635    4               CALL FSA$FSP(J, START$);
      352     5636    4               F$DCB.STARTX=0;
      353     5637    4               END;
      354     5638                    /**/
      355     5639    3         CASE(HDRX);
      356     5640    3            IF F$DCB.HEADER$~=ADDR(NIL) THEN
      357     5641    3            CALL FSA$FSP(SIZEW(VLP$HDRF),F$DCB.HEADER$);
      358     5642
      359     5643    4            IF F$DCB.IRRECX > 0 THEN DO;
      360     5644    4               IRREC$ = PINCRW(B$ROSEG$,F$DCB.IRRECX);
      361     5645    4               J = (VLP$IRREC.NFIELDS# +3)/4 +1;
      362     5646    4               CALL FSA$FSP(J,IRREC$);
      363     5647    4               F$DCB.IRRECX = 0;
      364     5648    4               END;
      365     5649                    /**/
      366     5650    3         CASE(ALTKX);
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:11   
      367     5651    4            IF F$DCB.ALTKEYX~=0 THEN DO;
      368     5652    4               ALTKEY$=PINCRW(B$ROSEG$,F$DCB.ALTKEYX);
      369     5653    4               J=FITALTKEYS.NUMWRDS;
      370     5654    4               CALL FSA$FSP(J,ALTKEY$);
      371     5655    4               F$DCB.ALTKEYX=0;
      372     5656    4               END;
      373     5657    4            IF F$DCB.FPRGX~=0 THEN DO;
      374     5658    4               ALTKEY$=PINCRW(B$ROSEG$,F$DCB.FPRGX);
      375     5659    4               CALL FSA$FSP(SIZEW(VLP$FPRG),ALTKEY$);
      376     5660    4               F$DCB.FPRGX=0;
      377     5661    4               END;
      378     5662
      379     5663    4            IF F$DCB.KFIELDX>0 THEN DO;
      380     5664    4               KFIELD$=PINCRW(B$ROSEG$, F$DCB.KFIELDX);
      381     5665    4               K=KFIELD$->KFIELD.NWORDS;
      382     5666    4               CALL FSA$FSP(K, KFIELD$);
      383     5667    4               END;
      384     5668    3         CASE(ELSE); /*TREAT OTHERS AS NIL */
      385     5669    3         END;
      386     5670    2   CONTOPN:
      387     5671    2         END;
      388     5672
      389     5673
      390     5674                    /*
      391     5675                    *  NOW MERGE IN THE OPEN FPT INFORMATION
      392     5676                    */
      393     5677    1      AMRF='0'B;
      394     5678    1      CALL FMM$MERGE2 ALTRET(ERRORX);
      395     5679                    /*
      396     5680                    *  IF THIS IS A 'SETDCB' OPERATION, OPEN IS FINISHED
      397     5681                    */
      398     5682    1      IF NOT PN$(0)->FPT$OPEN_V.SETDCB THEN GOTO MAINSTREAM;
      399     5683    1   RETRET:;
      400     5684    2      IF JDCB$~=ADDR(NIL) THEN DO;
      401     5685    2         IF F$DCB.BFR.BUFX(0)~=0
      402     5686    2         THEN CALL FMD$RELBUF(0);
      403     5687    2         F$DCB.FCI=F$DCB.FCD;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:12   
      404     5688    2         END;
      405     5689    1      RETURN;
      406     5690        %EJECT;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:13   
      407     5691                    /*F*
      408     5692                    *     NAME:   FMM$DFLOPN
      409     5693                    *     PURPOSE:   PERFORM THE DEFAULT OPEN FOR A DCB.  NO FPT IS
      410     5694                    *                NEEDED, BUT ASSIGN/MERGE INFORMATION MAY BE
      411     5695                    *                OBTAINED IF INDICATED BY THE DCB.
      412     5696                    *
      413     5697                    *     DESCRIPTION:  FMM$DFLOPN IS THE SYSTEM ENTRY FOR OPEN AND
      414     5698                    *                   REQUIRES NO OPEN FPT.  ALL THE NECESSARY OPEN
      415     5699                    *                   PARAMETERS MUST BE PUT IN THE DCB PRIOR TO THE
      416     5700                    *                   CALL AND THE JIT MUST CONTAIN THE DCB POINTER.
      417     5701                    *                FMM$DFLOPNP SETS F$DCB.WSR=1 TO OVERRIDE FM SECURITY.
      418     5702                    *                FMM$DFLOPNSYS ALLOWS OPEN TO M$* WITH F$DCB.WSR>1.
      419     5703                    *
      420     5704                    */
      421     5705                    /*D*
      422     5706                    *     NAME:   FMM$DFLOPN
      423     5707                    *     CALL:   CALL FMM$DFLOPN;
      424     5708                    *         OR CALL FMM$DFLOPNP;
      425     5709                    *         OR CALL FMM$DFLOPNSYS;
      426     5710                    *     INPUT:  B$JIT.DCB$ -> CURRENT DCB
      427     5711                    *     OUTPUT: OPEN DCB WITH INFORMATION MERGED.
      428     5712                    *
      429     5713                    *     DESCRIPTION:  FMM$DFLOPN ENTERS AT THE VERY END OF THE OPEN
      430     5714                    *              MERGE PROCESS AND SETS THE OPEN POINTER ARRAY TO A
      431     5715                    *              SET OF 'NULL' POINTERS.  IF THE AMFLG IN THE CURRENT
      432     5716                    *              DCB INDICATES THAT THE ASSIGN MERGE RECORD MUST BE
      433     5717                    *              OBTAINED FOR THIS DCB, IT IS GOTTEN AND THE PTRS
      434     5718                    *              ARE ADJUSTED TO DESCRIBE THE PROPER AREAS.  FINALLY
      435     5719                    *              THE FUNCTION IS SET 'INPUT' IF DEFAULTED TO THIS POINT,
      436     5720                    *              AND THE SPECIFIC OPEN ROUTINE IS CALLED BASED ON THE
      437     5721                    *              ASSIGNMENT TYPE.
      438     5722                    *
      439     5723                    *                   ANY ERRORS ENCOUNTERED ARE DESCRIBED IN THE
      440     5724                    *              B$JIT.ERR.CODE LOCATION.  NOTE THAT NO ALTRET IS
      441     5725                    *              DEFINED ON THE OPEN PROCEDURE.  THE PMME_EXIT ROUTINE
      442     5726                    *              NORMALLY TAKES CARE OF THE ALTRET TO THE USER, SO
      443     5727                    *              MONITOR CALLS DIRECTLY TO FMM$DFLOPN SHOULD CHECK THE
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:14   
      444     5728                    *              ERR.CODE WORD UPON RETURN FROM THE OPEN ROUTINE.
      445     5729                    *
      446     5730                    */
      447     5731
      448     5732    1   FMM$DFLOPNP: ENTRY;
      449     5733    1      JDCB$=B$JIT.DCB$;
      450     5734    1      F$DCB.WSR=1;
      451     5735    1      GOTO DFLOPNC;
      452     5736    1   FMM$DFLOPNSYS: ENTRY;
      453     5737    1      JDCB$=B$JIT.DCB$;
      454     5738    1      GOTO DFLOPNC;
      455     5739                    /**/
      456     5740    1   FMM$DFLOPN: ENTRY;
      457     5741                    /**/
      458     5742
      459     5743    1      JDCB$=B$JIT.DCB$; /* CURRENT DCB POINTER */
      460     5744    1      IF JDCB$=DCBADDR(%M$STAR#) AND F$DCB.WSR>1 THEN GOTO FMME$DOMAIN;
      461     5745                    /*
      462     5746                    *  DEFAULT OPEN OPTIONS ARE 'NO', AND POINTERS ARE 'NULL'.
      463     5747                    */
      464     5748    1   DFLOPNC:;
      465     5749    1      TDCB$=JDCB$;
      466     5750    1      F$DCB.BFR(0)='0'B;
      467     5751    1      PN$(0)=ADDR(FM_DFLOPN_V);
      468     5752    2      DO I=1 TO TOPX;
      469     5753    2         PN$(I)=ADDR(NIL);
      470     5754    2         END;
      471     5755        %EJECT;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:15   
      472     5756
      473     5757                    /*
      474     5758                    *  EVERYTHING IS MERGED EXCEPT THE FIT INFO AND
      475     5759                    *  SERIAL NO LIST.  GET THE AMR AND MERGE IN THE INFORMATION
      476     5760                    *  WE NEED FROM THERE.
      477     5761                    */
      478     5762    1   MAINSTREAM:
      479     5763    2      IF F$DCB.AMFLG THEN DO;
      480     5764    2         IF F$DCB.BFR.BUFX(0)=0
      481     5765    2         THEN CALL FMM$GETAMR(TDCB$,BUF$)ALTRET(AMR_LOST);
      482     5766    2         IF F$DCB.AMFLG.ACCF
      483     5767    2         THEN PN$(ACCESSX)=PINCRW(BUF$,AMRX(ACCESSX));
      484     5768    2         IF F$DCB.AMFLG.ACSF
      485     5769    2         THEN PN$(ACSVEHX)=PINCRW(BUF$,AMRX(ACSVEHX));
      486     5770    2         IF F$DCB.AMFLG.USRF
      487     5771    2         THEN PN$(UATTRX)=PINCRW(BUF$,AMRX(UATTRX));
      488     5772    2         IF F$DCB.AMFLG.INSF
      489     5773    2         THEN PN$(INSTATTRX)=PINCRW(BUF$,AMRX(INSTATTRX));
      490     5774    2         IF F$DCB.AMFLG.PROF
      491     5775    2         THEN PN$(PROCATTRX)=PINCRW(BUF$,AMRX(PROCATTRX));
      492     5776    2         IF F$DCB.AMFLG.SNLF
      493     5777    2         THEN PN$(SNX)=PINCRW(BUF$,AMRX(SNX));
      494     5778    2         END;
      495     5779    1   AMR_LOST:;
      496     5780        %EJECT;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:16   
      497     5781                    /*
      498     5782                    *  SET GLOBAL DEFAULTS AND ZERO DCB FLAGS
      499     5783                    */
      500     5784    1      IF NOT PN$(0)->FPT$OPEN_V.OPER.NXTA
      501     5785    1        AND F$DCB.ACCT=' '
      502     5786    2      THEN DO;
      503     5787    2         F$DCB.ACCT=B$JIT.FACCN;
      504     5788    2         IF F$DCB.PSN=' ' THEN F$DCB.PSN=B$JIT.FPSN;
      505     5789    2         END;
      506     5790    1      IF F$DCB.FUN=0 OR F$DCB.FUN>3 THEN F$DCB.FUN=FUN(F$DCB.ASN);
      507     5791    1      IF F$DCB.ACS=%BLOCK# AND NOT B$JIT.PRIV.ACTIVE&%PR_FMBLK#
      508     5792    1        AND (F$DCB.FUN~=%IN# OR NOT B$JIT.PRIV.ACTIVE&%PR_FMSEC#)
      509     5793    1      THEN F$DCB.ACS=%SEQUEN#;
      510     5794    2      IF NOT F$DCB.PASSF AND F$DCB.PASS~=' ' THEN DO;
      511     5795    2         CALL FMM$SCRAMBLE(F$DCB.PASS);
      512     5796    2         F$DCB.PASSF='1'B;
      513     5797    2         END;
      514     5798    1      AMRF=F$DCB.AMFLG;
      515     5799    1      F$DCB.TYC(0)=F$DCB.BFR1(0); /* SAVE BUF0, MAYBE ASSMRG REC */
      516     5800    1      F$DCB.TYC(1)=F$DCB.BFR(0);/* SAVE BUF0, MEBBE ASSIGN MERGE REC*/
      517     5801    1      K=POFFC(ADDR(F$DCB.DCBNAME),ADDR(F$DCB.FEXT)); /* CLEAR WORK AREA */
      518     5802    1      ADDR(F$DCB.FEXT)->MOVEKB='0'B;
      519     5803    1      F$DCB.AGE=B$JIT.CALCNT;
      520     5804    1      F$DCB.AMFLG=AMRF;
      521     5805    1      F$DCB.BFR1(0)=F$DCB.TYC(0);
      522     5806    1      F$DCB.BFR(0)=F$DCB.TYC(1);
      523     5807    1      K=POFFC(ADDR(F$DCB.SETSTA$),ADDR(F$DCB));
      524     5808    1      JDCB$->MOVEKC=FMM$SDCB;
      525     5809    1      F$DCB.CFU$=ADDR(NIL);
      526     5810    1      F$DCB.IASN=F$DCB.ASN;
      527     5811    1      AMRF=PN$(0)->FPT$OPEN_V.XONLY; /* Save XONLY so openers can mash PN$(0) */
      528     5812                    /*
      529     5813                    *  CALL SPECIFIC OPEN ROUTINES BASED ON ASSIGNMENT TYPE
      530     5814                    */
      531     5815    1      IF F$DCB.ASN~=%DEVICE# AND F$DCB.WSN~=' '
      532     5816    1      THEN CALL FMF$REMOTE(PN$);
      533     5817    2      ELSE DO CASE(F$DCB.ASN);
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:17   
      534     5818                    /**/
      535     5819    2      CASE(%FILE#);
      536     5820    2         IF F$DCB.SHARE=0 THEN
      537     5821    2         F$DCB.SHARE=%NONE#;
      538     5822    2         IF F$DCB.RESNT.TYP='OD'
      539     5823                    /* Optical Disc files have DCB.ASN set to FILE and DCB.RES
      540     5824                       set to 'ODnn'.  Then OD open routines set IASN and IFMT
      541     5825                       to OD# and FMTOD#.         */
      542     5826    2         THEN CALL FPO$OPNOD (PN$);
      543     5827    2         ELSE CALL FMN$OPNF (PN$);
      544     5828    2         IF F$DCB.ASN=%TAPE# THEN CALL FTO$OPNAT(PN$);
      545     5829    2         IF F$DCB.SETSTA$~=ADDR(NIL) AND F$DCB.ORG=%KEYED#
      546     5830    2           AND PN$(ULBLX)~=ADDR(NIL)
      547     5831    3         THEN DO; /* RETURN POINTER TO USER FOR VA */
      548     5832    3            CALL HFF$WRITE1(ULBLX) ALTRET(NOVIRTPTR);
      549     5833    3            PN$(ULBLX)->VLP$VIRTUAL_V.PTR$=F$DCB.SETSTA$->VLP$VIRTUAL_V.PTR$;
      550     5834    3            PN$(ULBLX)->VLP$VIRTUAL_V.WSQ=F$DCB.SETSTA$->VLP$VIRTUAL_V.WSQ;
      551     5835    3   NOVIRTPTR: END;
      552     5836                    /**/
      553     5837    2      CASE(%TAPE#);
      554     5838    3         IF F$DCB.ACS=%JRNL# THEN DO;
      555     5839    3            F$DCB.IXTNSIZE=1;
      556     5840    3            F$DCB.BLKL=4096;
      557     5841    3            F$DCB.IASN=%FILE#;
      558     5842    3            CALL FMN$OPNF(PN$);
      559     5843    3            IF B$JIT.ERR OR F$DCB.ASN=%FILE# THEN GOTO RETRET;
      560     5844    3            F$DCB.IASN=%TAPE#;
      561     5845    3            END;
      562     5846    2         CALL FTO$OPNAT(PN$);
      563     5847                    /**/
      564     5848    2      CASE(%DEVICE#);
      565     5849    2         CALL FSN$OPNDEV(PN$);
      566     5850                    /**/
      567     5851    2      CASE(%COMGROUP#);
      568     5852    2         CALL KCO$OPCG(PN$);
      569     5853                    /**/
      570     5854    2      CASE(%FPAP#);
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:18   
      571     5855    2         CALL NAO$OPN;
      572     5856    2      CASE(ELSE); /* ERROR */
      573     5857    2         GOTO ERR3;
      574     5858    2      END;
      575     5859                    /*E*     ERROR: FMM-E$INVASN-E
      576     5860                    *        MESSAGE:ASN in DCB% %DC% is not FILE/TAPE/DEVICE/COMGROUP.
      577     5861                    *        DESCRIPTION: INVALID ASSIGNMENT TYPE.
      578     5862                    */
      579     5863    1      IF AMRF THEN F$DCB.FFLG.EXEC='1'B;
      580     5864    1      F$DCB.TYC='0'B;
      581     5865    1      GOTO RETRET;
      582     5866
      583     5867        %EJECT;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:19   
      584     5868                    /*F*
      585     5869                    *     NAME:    FMM$ASSMRG
      586     5870                    *     PURPOSE: PERFORM THE ASSIGN MERGE FUNCTION AT JOB STEP TIME
      587     5871                    *              FOR ALL THE DCBS DEFINED AT STEP TIME WHICH HAVE
      588     5872                    *              RECORDS IN THE ASSIGN MERGE FILE.
      589     5873                    *
      590     5874                    *     DESCRIPTION:  FMM$ASSMRG IS CALLED BY STEP TO MERGE THE
      591     5875                    *             ASSIGNS FOR ALL DEFINED DCBS.  FMM$ASSMRG ALSO
      592     5876                    *             SETS UP THE DCB.FEXT INDICATORS FOR THOSE DCBS
      593     5877                    *             WHICH HAVE AUTOMATIC FILE EXTENSION.
      594     5878                    *
      595     5879                    */
      596     5880                    /*D*
      597     5881                    *     NAME:    FMM$ASSMRG
      598     5882                    *     CALL:    CALL FMM$ASSMRG;
      599     5883                    *     INPUT:   NONE
      600     5884                    *     OUTPUT:  USER DCBS WITH ASSIGNMENTS MERGED.
      601     5885                    *
      602     5886                    *     DESCRIPTION:  FMM$ASSMRG GETS A FILE MANAGEMENT BUFFER AND
      603     5887                    *              OPENS THE ASSIGN MERGE FILE, THEN LOOPS THROUGH THE
      604     5888                    *              USER'S DCBS AND MERGES THE ASSIGNMENTS FOR EACH ONE
      605     5889                    *              WHICH HAS AN AM RECORD ASSOCIATED WITH IT.  THE
      606     5890                    *              SPECIAL DEFAULT 'SOURCE', 'OVER', AND 'ON' ASSIGNMENTS
      607     5891                    *              ARE CHECKED AND MERGED FROM THE KEYS '#1', '#2',
      608     5892                    *              AND '#3'.  IF THESE AMR ENTRIES ARE NOT FOUND, THE
      609     5893                    *              DCBS REVERT TO THEIR NORMAL RECORDS (KEYED BY DCBNAME)
      610     5894                    *              AND DEFAULT OPLABEL EXTENSION DEFINITIONS.
      611     5895                    *
      612     5896                    */
      613     5897    1   FMM$ASSMRG: ENTRY;
      614     5898                    /*
      615     5899                    *  GET A BUFFER FOR THE AMR (ASSOCIATE WITH M$DO DCB)
      616     5900                    */
      617     5901    1      TEMP$=B$JIT$->B$JIT.DCB$; /* SAVE CURRENT DCB */
      618     5902    1      B$JIT.DCB$=DCBADDR(4);
      619     5903    1      CALL FMD$GETBUF(0,1,BUF$);
      620     5904                    /*
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:20   
      621     5905                    *  GET M$STAR DCB PTR AND OPEN TO ASSIGN MERGE FILE
      622     5906                    */
      623     5907    1      B$JIT.DCB$=DCBADDR(1);
      624     5908    1      CALL FMM$OPNAMR ALTRET(AMRCONT);
      625     5909
      626     5910                    /*
      627     5911                    *  NOW LOOP THROUGH THE DCB POINTERS FOR EACH USER DCB
      628     5912                    *  STARTING AT M$DO AND READ THE ASSIGN MERGE RECORD
      629     5913                    *  FOR THAT DCB.  NOTE THAT FOR THE DEFAULT ASSIGNMENTS
      630     5914                    *  WE TRY THE SPECIAL AM RECORD AND IF IT IS NOT FOUND,
      631     5915                    *  THEN WE REVERT TO THE STANDARD AM RECORD FOR THIS DCB.
      632     5916                    *  WHENEVER AN AM RECORD IS FOUND IT IS MERGED INTO THE
      633     5917                    *  CORRESPONDING DCB.
      634     5918                    */
      635     5919    1   AMRCONT:;
      636     5920    1      I=%M$SYSDCBS#;
      637     5921    2      DO WHILE(I<B$ROSEG$->B$ROSEG.NUMDCBS);
      638     5922    2         JDCB$=DCBADDR(I);
      639     5923    2         IF JDCB$=ADDR(NIL) THEN GOTO NXTDCB;
      640     5924    2         TDCB$=JDCB$;
      641     5925    3         IF F$DCB.DCBNAME.S THEN DO;
      642     5926    3            CALL FMM$SCRUB1(TDCB$);
      643     5927    3            END;
      644     5928    3         ELSE DO; /* PREVENT SCREECH FROM UNINITED DCBS */
      645     5929    3            F$DCB.FCD='0'B;
      646     5930    3            F$DCB.AMFLG='0'B;
      647     5931    3            F$DCB.FORM$=ADDR(NIL);
      648     5932    3            F$DCB.TAB$=ADDR(NIL);
      649     5933    3            F$DCB.HEADER$=ADDR(NIL);
      650     5934    3            F$DCB.LASTSTA$=ADDR(NIL);
      651     5935    3            F$DCB.SETSTA$=ADDR(NIL);
      652     5936    3            F$DCB.ALTKEYX=0;
      653     5937    3            F$DCB.FPRGX=0;
      654     5938    3            F$DCB.FIELDX=0;
      655     5939    3            F$DCB.KFIELDX=0;
      656     5940    3            F$DCB.STARTX=0;
      657     5941    3            F$DCB.IRRECX=0;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:21   
      658     5942    3            F$DCB.CODE16$=ADDR(NIL);
      659     5943    3            END;
      660     5944                    /*
      661     5945                    *  GET FEXTX FOR THE #1, #2, AND #3 DEFAULT ASSIGNMENTS
      662     5946                    */
      663     5947    2         F$DCB.FEXTX=F$DCB.DCBNAME.X;
      664     5948    2         FPT$=ADDR(F$DCB.DCBNAME);
      665     5949    3         IF NAME.S='004115044'O THEN DO J=5 TO F_NUMOPS; /* M$XX */
      666     5950    3            IF F_OPLBL(J)=NAME.OP
      667     5951    3            THEN F$DCB.FEXTX=J;
      668     5952    3            END;
      669     5953    2         CALL FMM$READAMR(TDCB$,BUF$) ALTRET(NXTDCB);
      670     5954    2         CALL FMM$MERGE1;
      671     5955    2   NXTDCB:
      672     5956    2         IF I=%M$SYSDCBS# THEN I=%M$1STDCB#; /* ONLY M$DO <10 */
      673     5957    2         ELSE I=I+1;
      674     5958    2         END;
      675     5959                    /*
      676     5960                    *  CLEAN UP AND RETURN
      677     5961                    */
      678     5962
      679     5963    1      CALL FMP$CLSTAR;
      680     5964    1      B$JIT.DCB$=DCBADDR(4);
      681     5965    1      B$JIT.ERR='0'B;
      682     5966    1      CALL FMD$RELBUF(0);
      683     5967    1      B$JIT$->B$JIT.DCB$=TEMP$;
      684     5968
      685     5969    1      RETURN;
      686     5970
      687     5971
      688     5972        %EJECT;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:22   
      689     5973                    /*I*
      690     5974                    *     NAME:  FMM$MERGE1
      691     5975                    *     PURPOSE:  MERGE THE ASSIGN MERGE RECORD INFORMATION INTO
      692     5976                    *               THE DCB.
      693     5977                    *
      694     5978                    *     DESCRIPTION:  FMM$MERGE1 SETS UP THE OPEN POINTERS TO THE
      695     5979                    *             SPECIFIED AREAS WITHIN AN ASSIGN MERGE RECORD,
      696     5980                    *             SETS THE 'AMRF' FLAG AND THEN FALLS INTO FMM$MERGE2.
      697     5981                    *
      698     5982                    */
      699     5983    1   FMM$MERGE1: PROC ALTRET;
      700     5984    2   DCL I UBIN;
      701     5985
      702     5986                    /*
      703     5987                    *  GET THE POINTERS PN$(0 THRU 15) INITIALIZED TO THE
      704     5988                    *  SPECIFIED AREAS WITHIN THE ASSIGN MERGE RECORD.
      705     5989                    */
      706     5990    2      IF AMRX(0)=0 THEN RETURN;
      707     5991    3      DO J=0 TO TOPX;
      708     5992    3         IF AMRX(J)=0 THEN PN$(J)=ADDR(NIL);
      709     5993    3         ELSE PN$(J)=PINCRW(BUF$,AMRX(J));
      710     5994    3         END;
      711     5995    2      AMRF='1'B;
      712     5996    2      IF PN$(0)->FPT$OPEN_V.INITZ.SCRUB THEN CALL FMM$SCRUB(TDCB$);
      713     5997    2      F$DCB.AMR='1'B;
      714     5998    3      IF SUBSTR(F$DCB.DCBNAME.N,0,2)='F$' THEN DO;
      715     5999    3         F$DCB.FUN=0; /* GO BACK TO DEFAULT */
      716     6000    3         F$DCB.RES='ME';
      717     6001    3         END;
      718     6002                    /*I*
      719     6003                    *     NAME:  FMM$MERGE2
      720     6004                    *
      721     6005                    *     PURPOSE:  MERGE EITHER THE ASSIGN MERGE RECORD INFORMATION
      722     6006                    *               OR THE OPEN FPT INFORMATION DEPENDING ON
      723     6007                    *               PN$(0 THRU 15).
      724     6008                    *
      725     6009                    *     INPUT:    PN$ POINTER ARRAY DEFINES THE DCB PARAMETERS.
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:23   
      726     6010                    *               AMRF IS A FLAG THAT INDICATES WHETHER THIS IS
      727     6011                    *                    THE ASSIGN MERGE RECORD OR AN OPEN FPT.
      728     6012                    *               JDCB$ POINTS TO THE CURRENT DCB.
      729     6013                    *
      730     6014                    *     OUTPUT:   A DCB WITH INFORMATION MERGED AND THE AMFLG BITS
      731     6015                    *               SET OR RESET DEPENDING ON WHERE THE PARAMETER
      732     6016                    *               WAS DEFINED.
      733     6017                    *
      734     6018                    *     DESCRIPTION:  FMM$MERGE2 DOES THE ACTUAL MERGE INTO THE DCB
      735     6019                    *             BASED ON WHETHER OR NOT THE ITEM IS SPECIFIED IN
      736     6020                    *             THE OPEN FPT.
      737     6021                    *
      738     6022                    */
      739     6023    2   FMM$MERGE2: ENTRY ALTRET;
      740     6024                    /**/
      741     6025                    /**/
      742     6026    2      FPT$=PN$(0); /* SET THE IMPLICIT FPT POINTER */
      743     6027                    /*
      744     6028                    *  SET ASSIGNMENT TYPE AND FUNCTION
      745     6029                    */
      746     6030    2      IF FPT$OPEN_V.ASN~=0
      747     6031    3        AND FPT$OPEN_V.ASN~=F$DCB.ASN THEN DO;
      748     6032    3         F$DCB.ASN=FPT$OPEN_V.ASN;
      749     6033    3         F$DCB.RES=' ';
      750     6034    4         IF F$DCB.LASTSTA$~=ADDR(NIL) THEN DO;
      751     6035    4            CALL FSA$FSP(SIZEW(VLP$STATION)+SIZEW(VLP$SETSTA),F$DCB.LASTSTA$);
      752     6036    4            F$DCB.SETSTA$=ADDR(NIL);
      753     6037    4            END;
      754     6038    3         END;
      755     6039    2      IF FPT$OPEN_V.FUN~=0 THEN F$DCB.FUN=FPT$OPEN_V.FUN;
      756     6040                    /*
      757     6041                    *    MERGE THE VARIABLE AREA OF THE FPT
      758     6042                    */
      759     6043    2      IF FPT$OPEN_V.ORG~=0 THEN F$DCB.ORG=FPT$OPEN_V.ORG;
      760     6044    2      IF FPT$OPEN_V.ACS~=0 THEN F$DCB.ACS=FPT$OPEN_V.ACS;
      761     6045    2      IF FPT$OPEN_V.DISP~=0 THEN F$DCB.DISP=FPT$OPEN_V.DISP;
      762     6046    2      IF FPT$OPEN_V.RES~=BINASC(0) THEN
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:24   
      763     6047    2      CALL XLATE(F$DCB.RES,B$XL_UPPER_UR,FPT$OPEN_V.RES);
      764     6048    2      IF FPT$OPEN_V.TYPE~=BINASC(0) THEN F$DCB.TYPE=FPT$OPEN_V.TYPE;
      765     6049    2      IF FPT$OPEN_V.EXPIRE~=0 THEN F$DCB.EXPIRE=FPT$OPEN_V.EXPIRE;
      766     6050    2      IF FPT$OPEN_V.KEYTYPE~= 0 THEN F$DCB.KEYTYPE=FPT$OPEN_V.KEYTYPE;
      767     6051                    /*
      768     6052                    *    TAPE SPECIFIC OPTIONS
      769     6053                    */
      770     6054    2      IF NOT FPT$OPEN_V.BLOCKED&'01'B
      771     6055    2      THEN F$DCB.BLOCKED=FPT$OPEN_V.BLOCKED;
      772     6056    2      IF NOT FPT$OPEN_V.SPANNED&'01'B
      773     6057    2      THEN F$DCB.SPANNED=FPT$OPEN_V.SPANNED;
      774     6058    2      IF NOT FPT$OPEN_V.IOERROK&'01'B THEN
      775     6059    2      F$DCB.IOERROK=FPT$OPEN_V.IOERROK;
      776     6060    2      IF NOT FPT$OPEN_V.IGNOREFSN&'01'B THEN
      777     6061    2      F$DCB.IGNOREFSN=FPT$OPEN_V.IGNOREFSN;
      778     6062    2      IF FPT$OPEN_V.BLKL~=0 THEN F$DCB.BLKL=FPT$OPEN_V.BLKL;
      779     6063    2      IF FPT$OPEN_V.RECL~=262143 THEN F$DCB.RECL=FPT$OPEN_V.RECL;
      780     6064    2      IF FPT$OPEN_V.VOL~=0 THEN F$DCB.VOL=FPT$OPEN_V.VOL;
      781     6065    2      IF FPT$OPEN_V.MAXVOL~=0 THEN F$DCB.MAXVOL=FPT$OPEN_V.MAXVOL;
      782     6066    2      IF FPT$OPEN_V.CHAIN~=0 THEN F$DCB.CHAIN=FPT$OPEN_V.CHAIN;
      783     6067    2      IF FPT$OPEN_V.DENSITY~=0 THEN F$DCB.DENSITY=FPT$OPEN_V.DENSITY;
      784     6068    2      IF FPT$OPEN_V.FSN~=0 THEN F$DCB.FSN=FPT$OPEN_V.FSN;
      785     6069    2      IF FPT$OPEN_V.VOLACCESS~=0 THEN F$DCB.VOLACCESS=FPT$OPEN_V.VOLACCESS;
      786     6070    2      IF NOT FPT$OPEN_V.CNVRT&'01'B THEN F$DCB.CNVRT=FPT$OPEN_V.CNVRT;
      787     6071    2      IF NOT FPT$OPEN_V.XTEND&'01'B THEN F$DCB.XTEND=FPT$OPEN_V.XTEND;
      788     6072    2      IF NOT FPT$OPEN_V.EBCDIC&'01'B THEN F$DCB.EBCDIC=FPT$OPEN_V.EBCDIC;
      789     6073    2      IF NOT FPT$OPEN_V.CVOL&'01'B THEN F$DCB.CVOL=FPT$OPEN_V.CVOL;
      790     6074                    /*
      791     6075                    *    FILE SPECIFIC OPTIONS
      792     6076                    */
      793     6077    2      IF FPT$OPEN_V.IXTNSIZE~=0 THEN F$DCB.IXTNSIZE=FPT$OPEN_V.IXTNSIZE;
      794     6078    2      IF FPT$OPEN_V.NRECS~=0 THEN F$DCB.NRECS=FPT$OPEN_V.NRECS;
      795     6079    2      IF FPT$OPEN_V.XTNSIZE~=0 THEN F$DCB.XTNSIZE=FPT$OPEN_V.XTNSIZE;
      796     6080    2      IF FPT$OPEN_V.LSLIDE~=0 THEN F$DCB.LSLIDE=FPT$OPEN_V.LSLIDE;
      797     6081    2      IF FPT$OPEN_V.LRDL0~=0 THEN F$DCB.LRDL0=FPT$OPEN_V.LRDL0;
      798     6082    2      IF FPT$OPEN_V.SPARE~=0 THEN F$DCB.SPARE=FPT$OPEN_V.SPARE;
      799     6083    2      IF FPT$OPEN_V.GHSTACS~=0 THEN F$DCB.GHSTACS=FPT$OPEN_V.GHSTACS;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:25   
      800     6084    2      IF NOT FPT$OPEN_V.BUPM&'01'B THEN F$DCB.BUPM=FPT$OPEN_V.BUPM;
      801     6085    2      IF NOT FPT$OPEN_V.ANSISPANSEQ&'01'B THEN F$DCB.ANSISPANSEQ=FPT$OPEN_V.ANSISPANSEQ
              6085               ;
      802     6086    3      IF FPT$OPEN_V.KEYL~=0 THEN DO;
      803     6087    3         F$DCB.KEYL=FPT$OPEN_V.KEYL;
      804     6088    3         F$DCB.KEYX=FPT$OPEN_V.KEYX;
      805     6089    3         END;
      806     6090    2      IF FPT$OPEN_V.EXIST~=0 THEN F$DCB.EXIST=FPT$OPEN_V.EXIST;
      807     6091    2      IF FPT$OPEN_V.SHARE~=0 THEN F$DCB.SHARE=FPT$OPEN_V.SHARE;
      808     6092    2      IF NOT FPT$OPEN_V.CTG&'01'B THEN F$DCB.CTG=FPT$OPEN_V.CTG;
      809     6093    2      IF NOT FPT$OPEN_V.COMP&'01'B THEN F$DCB.COMP=FPT$OPEN_V.COMP;
      810     6094    2      IF NOT FPT$OPEN_V.LOAD&'01'B THEN F$DCB.LOAD=FPT$OPEN_V.LOAD;
      811     6095    2      IF FPT$OPEN_V.SEEDSPECIFIED THEN
      812     6096    2      F$DCB.SEED=FPT$OPEN_V.SEED;
      813     6097                    /*
      814     6098                    *    COMGROUP SPECIFIC OPTIONS
      815     6099                    */
      816     6100    2      IF NOT FPT$OPEN_V.AU&'01'B THEN F$DCB.AU=FPT$OPEN_V.AU;
      817     6101    2      IF NOT FPT$OPEN_V.QISS&'01'B THEN F$DCB.QISS=FPT$OPEN_V.QISS;
      818     6102    2      IF NOT FPT$OPEN_V.LSTAOR&'01'B THEN F$DCB.LSTAOR=FPT$OPEN_V.LSTAOR;
      819     6103    2      IF NOT FPT$OPEN_V.JRNLBYPASS&'01'B
      820     6104    2      THEN F$DCB.JRNLBYPASS=FPT$OPEN_V.JRNLBYPASS;
      821     6105                    /*
      822     6106                    *    DEVICE SPECIFIC OPTIONS
      823     6107                    */
      824     6108    2      IF FPT$OPEN_V.DVFC~=BINASC(0) THEN F$DCB.DVFC=FPT$OPEN_V.DVFC;
      825     6109    2      IF FPT$OPEN_V.LINES~=0 THEN F$DCB.LINES=FPT$OPEN_V.LINES;
      826     6110    2      IF FPT$OPEN_V.EVENT~=0 THEN F$DCB.EVENT=FPT$OPEN_V.EVENT;
      827     6111    3      IF NOT FPT$OPEN_V.SEQ&'01'B THEN DO;
      828     6112    3         F$DCB.SEQCOL=FPT$OPEN_V.SEQCOL;
      829     6113    3         F$DCB.SEQID=FPT$OPEN_V.SEQID;
      830     6114    3         F$DCB.SEQ=FPT$OPEN_V.SEQ;
      831     6115    3         END;
      832     6116    3      IF FPT$OPEN_V.COPIES~=0 THEN DO;
      833     6117    4         IF F$DCB.FORM$=ADDR(NIL) THEN DO;
      834     6118    4            CALL FSA$GSP(SIZEW(CODE16),F$DCB.FORM$) ALTRET(ERRORX);
      835     6119    4            F$DCB.FORM$->CODE16='0'B;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:26   
      836     6120    4            END;
      837     6121    3         F$DCB.FORM$->CODE16.COPIES=FPT$OPEN_V.COPIES;
      838     6122    3         END;
      839     6123    3      DO J=0 TO 8;
      840     6124    3         IF NOT FPT$OPEN_V.UOPT(J)&'01'B THEN F$DCB.UOPT(J)=FPT$OPEN_V.UOPT(J);
      841     6125    3         END;
      842     6126                    /*
      843     6127                    *  NOW MERGE THE PARAMETER AREAS
      844     6128                    *  AMRF = '0'B IF SOURCE IS OPEN FPT
      845     6129                    *       = '1'B IF SOURCE IS ASSIGN MERGE RECORD
      846     6130                    */
      847     6131    3      DO J=1 TO TOPX;
      848     6132    3         IF PN$(J)=ADDR(NIL) THEN GOTO NEXTPTR;
      849     6133    3         FPT$=PN$(J);
      850     6134    4         DO CASE(J);
      851     6135                    /**/
      852     6136    4         CASE(ULBLX);
      853     6137    4            IF F$DCB.ASN~=%TAPE#
      854     6138    5            THEN DO; /* Move SETSTA */
      855     6139    5               IF F$DCB.LASTSTA$=ADDR(NIL) THEN
      856     6140    5               CALL FSA$GSP(SIZEW(VLP$STATION)+SIZEW(VLP$SETSTA),
      857     6141    5                 F$DCB.LASTSTA$) ALTRET(ERRORX);
      858     6142    5               F$DCB.SETSTA$=PINCRW(F$DCB.LASTSTA$,SIZEW(VLP$STATION));
      859     6143    6               IF NOT AMRF THEN DO;
      860     6144    6                  CALL HFF$DSIZ(ULBLX,I);
      861     6145    7                  IF SIZEC(VLP$SETSTA)>I THEN DO;
      862     6146    7                     B$JIT.ERR=FMM$E$BADVECT2;
      863     6147                    /*E*     ERROR: FMM-E$BADVECT2-E
      864     6148                    *        MESSAGE:SETSTA VLP for M$OPEN %of %DC% is too small.
      865     6149                    */
      866     6150    7                     ALTRETURN;
      867     6151    7                     END;
      868     6152    6                  END;
      869     6153    5               F$DCB.SETSTA$->VLP$SETSTA=VLP$SETSTA;
      870     6154    5               F$DCB.AMRSETSTA=AMRF;
      871     6155    5               END;
      872     6156    4         CASE(NAMEX);
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:27   
      873     6157    4            K=0;
      874     6158    4            FN.L=FPT$->FF.CHARX;
      875     6159    4            F$DCB.NAME.L=K;
      876     6160    4            F$DCB.NAME.C=FPT$->FF.RECX;
      877     6161    4            IF NOT AMRF THEN B$JIT.FEXT(F$DCB.FEXTX)='0'B;
      878     6162                    /**/
      879     6163    4         CASE(ACCTX);
      880     6164    4            F$DCB.ACCT=VLP$ACCT.ACCT#;
      881     6165                    /**/
      882     6166    4         CASE(PASSX);
      883     6167    4            F$DCB.PASSF='0'B;
      884     6168    4            F$DCB.PASS=VLP$PASS.PASS#;
      885     6169                    /**/
      886     6170    4         CASE(ACCESSX);
      887     6171    4            F$DCB.AMFLG.ACCF=AMRF;
      888     6172                    /**/
      889     6173    4         CASE(ACSVEHX);
      890     6174    4            F$DCB.AMFLG.ACSF=AMRF;
      891     6175                    /**/
      892     6176    4         CASE(UATTRX);
      893     6177    4            F$DCB.AMFLG.USRF=AMRF;
      894     6178                    /**/
      895     6179    4         CASE(INSTATTRX);
      896     6180    4            F$DCB.AMFLG.INSF=AMRF;
      897     6181                    /**/
      898     6182    4         CASE(PROCATTRX);
      899     6183    4            F$DCB.AMFLG.PROF=AMRF;
      900     6184                    /**/
      901     6185    4         CASE(SNX);
      902     6186    4            IF VLP$SN.NUM#~=0 THEN F$DCB.PSN=VLP$SN.SN#(0);
      903     6187    4            IF VLP$SN.NUM#>1 THEN F$DCB.AMFLG.SNLF=AMRF;
      904     6188                    /**/
      905     6189    4         CASE(TABX);
      906     6190    5            IF F$DCB.FIELDX > 0 THEN DO;
      907     6191    5               FIELD$=PINCRW(B$ROSEG$, F$DCB.FIELDX);
      908     6192    5               K=(VLP$RECFIELD.NFIELDS#+1)/2 + 1;
      909     6193    5               CALL FSA$FSP(K, FIELD$);
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:28   
      910     6194    5               F$DCB.FIELDX=0;
      911     6195    5               END;
      912     6196
      913     6197    5            IF F$DCB.STARTX > 0 THEN DO;
      914     6198    5               START$=PINCRW(B$ROSEG$, F$DCB.STARTX);
      915     6199    5               K=FM$FIELD_START.NWORDS;
      916     6200    5               CALL FSA$FSP(K, START$);
      917     6201    5               F$DCB.STARTX=0;
      918     6202    5               END;
      919     6203
      920     6204    4            IF FPT$->VLP$RECFIELD.VLPID#=511
      921     6205    5            THEN DO; /* It's a RECFIELD */
      922     6206    5               IF F$DCB.TAB$~=ADDR(NIL) THEN
      923     6207    5               CALL FSA$FSP(SIZEW(VLP$TAB), F$DCB.TAB$);
      924     6208
      925     6209    5               IF (F$DCB.ASN~=%FILE# AND F$DCB.ASN~=%TAPE#) OR
      926     6210    5                 (F$DCB.ORG~=%KEYED# AND F$DCB.ORG~=%INDEXED# AND
      927     6211    5                 F$DCB.ORG~=%IREL#  AND F$DCB.ORG~=%CONSEC#  AND
      928     6212    5                 F$DCB.ORG~=%RELATIVE#)
      929     6213    5               THEN GOTO NEXTPTR;
      930     6214    5               IF AMRF THEN
      931     6215    5               I=(FPT$->VLP$RECFIELD.NFIELDS# * 2) + 4;
      932     6216    6               ELSE DO;
      933     6217    6                  CALL HFF$DSIZ(TABX, I);
      934     6218    7                  IF I/2-2 < FPT$->VLP$RECFIELD.NFIELDS# THEN DO;
      935     6219    7                     B$JIT.ERR=FMM$E$BADVECT14;
      936     6220                    /*E*  ERROR:  FMM-E$BADVECT14-E
      937     6221                          MESSAGE:  RECFIELD VLP for M$OPEN %of %DC% is too small.
      938     6222                          MESSAGE1:  In VLP_RECFIELD %for %DC%, the number of array elements
      939     6223                                     is greater than the framed area can contain.
      940     6224                    */
      941     6225    7                     ALTRETURN;
      942     6226    7                     END;
      943     6227    6                  END;
      944     6228
      945     6229    5               K=(I+3)/4;
      946     6230
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:29   
      947     6231    5               CALL FSA$GSP(K, FIELD$) ALTRET(ERRORX);
      948     6232    5               K=K*4;
      949     6233    5               FIELD$->MOVEKB='0'B;
      950     6234    5               FIELD$->MOVEKB=FPT$->MOVEKB;
      951     6235    5               F$DCB.FIELDX=POFFW(FIELD$, B$ROSEG$);
      952     6236                    /* Verify VLP$RECFIELD and fill in START$->FM$FIELD_START
      953     6237                       and F$DCB.STARTX later, so we can give better errors
      954     6238                       and don't have to do it several times.             */
      955     6239    5               END;
      956     6240    5            ELSE DO;
      957     6241    5               IF F$DCB.TAB$=ADDR(NIL)
      958     6242    5               THEN CALL FSA$GSP(SIZEW(VLP$TAB), F$DCB.TAB$) ALTRET(ERRORX);
      959     6243    5               K=SIZEC(VLP$TAB);
      960     6244    5               F$DCB.TAB$->MOVEKC=FPT$->MOVEKC;
      961     6245    5               END;
      962     6246                    /* */
      963     6247    4         CASE(HDRX);
      964     6248    5            IF F$DCB.IRRECX > 0 THEN DO;
      965     6249    5               IRREC$=PINCRW(B$ROSEG$, F$DCB.IRRECX);
      966     6250    5               K=(VLP$IRREC.NFIELDS#+3)/4 + 1;
      967     6251    5               CALL FSA$FSP(K, IRREC$);
      968     6252    5               F$DCB.IRRECX=0;
      969     6253    5               END;
      970     6254
      971     6255    4            IF FPT$->VLP$IRREC.VLPID#=511
      972     6256    5            THEN DO; /* It's an IRREC */
      973     6257    5               IF F$DCB.HEADER$ ~= ADDR(NIL) THEN
      974     6258    5               CALL FSA$FSP(SIZEW(VLP$HDRF),F$DCB.HEADER$);
      975     6259
      976     6260    5               IF (F$DCB.ASN~=%FILE# AND F$DCB.ASN~=%TAPE#) OR
      977     6261    5                 (F$DCB.ORG~=%KEYED# AND F$DCB.ORG~=%INDEXED# AND
      978     6262    5                 F$DCB.ORG~=%IREL#  AND F$DCB.ORG~=%CONSEC#  AND
      979     6263    5                 F$DCB.ORG~=%RELATIVE#)
      980     6264    5               THEN GOTO NEXTPTR;
      981     6265
      982     6266    5               IF AMRF THEN
      983     6267    5               I=FPT$->VLP$IRREC.NFIELDS# + 4;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:30   
      984     6268    6               ELSE DO;
      985     6269    6                  CALL HFF$DSIZ(HDRX,I);
      986     6270    7                  IF I-4 < FPT$->VLP$IRREC.NFIELDS# THEN DO;
      987     6271    7                     B$JIT.ERR=FMM$E$BADVECT15;
      988     6272    7                     ALTRETURN;
      989     6273    7                     END;
      990     6274    6                  END;
      991     6275
      992     6276    5               K=(I+3)/4;
      993     6277    5               CALL FSA$GSP(K,IRREC$) ALTRET(ERRORX);
      994     6278    5               K=K*4;
      995     6279    5               IRREC$->MOVEKB='0'B;
      996     6280    5               IRREC$->MOVEKB=FPT$->MOVEKB;
      997     6281    5               F$DCB.IRRECX=POFFW(IRREC$,B$ROSEG$);
      998     6282    5               END;
      999     6283    5            ELSE DO;
     1000     6284    5               IF F$DCB.HEADER$=ADDR(NIL) THEN
     1001     6285    5               CALL FSA$GSP(SIZEW(VLP$HDRF),F$DCB.HEADER$) ALTRET(ERRORX);
     1002     6286    5               K=1;
     1003     6287    5               FN.L=ADDR(VLP$HDR.TITL)->MOVEKC;
     1004     6288    5               K=K+SIZEC(VLP$HDR.CTL)+1;
     1005     6289    6               IF NOT AMRF THEN DO;
     1006     6290    6                  CALL HFF$DSIZ(HDRX,I);
     1007     6291    7                  IF K>I THEN DO;
     1008     6292    7                     B$JIT.ERR=FMM$E$BADVECT15;
     1009     6293                    /*E*     ERROR: FMM-E$BADVECT15-E
     1010     6294                    *        MESSAGE:HDR or IRREC VLP for M$OPEN %of %DC% is too small.
     1011     6295                             MESSAGE1: If IRREC VLP %for %DC%, the number of array elements
     1012     6296                                       specified is greater than the framed area
     1013     6297                                       can contain.
     1014     6298                    */
     1015     6299    7                     ALTRETURN;
     1016     6300    7                     END;
     1017     6301    6                  END;
     1018     6302    5               F$DCB.HEADER$->MOVEKC=FPT$->MOVEKC;
     1019     6303    5               END;
     1020     6304                    /**/
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:31   
     1021     6305    4         CASE(WSNX);
     1022     6306    4            F$DCB.WSN=VLP$WSN.WSN#;
     1023     6307    4         CASE(FORMX);
     1024     6308    5            IF F$DCB.FORM$=ADDR(NIL) THEN DO;
     1025     6309    5               CALL FSA$GSP(SIZEW(CODE16),F$DCB.FORM$)ALTRET(ERRORX);
     1026     6310    5               F$DCB.FORM$->CODE16='0'B;
     1027     6311    5               END;
     1028     6312    4            F$DCB.FORM$->CODE16.FORM=VLP$FORM.FORM#;
     1029     6313                    /**/
     1030     6314    4         CASE(ALTKX);
     1031     6315    4            IF (F$DCB.ASN=%FILE# OR F$DCB.ASN=%TAPE#) AND
     1032     6316    4              (F$DCB.ORG=%INDEXED# OR F$DCB.ORG=%IREL#)
     1033     6317    5            THEN DO;
     1034     6318    6               IF F$DCB.FPRGX~=0 THEN DO;
     1035     6319    6                  ALTKEY$=PINCRW(B$ROSEG$,F$DCB.FPRGX);
     1036     6320    6                  CALL FSA$FSP(SIZEW(VLP$FPRG),ALTKEY$);
     1037     6321    6                  F$DCB.FPRGX=0;
     1038     6322    6                  END;
     1039     6323
     1040     6324    6               IF F$DCB.ALTKEYX~=0 THEN DO;
     1041     6325    6                  ALTKEY$=PINCRW(B$ROSEG$, F$DCB.ALTKEYX);
     1042     6326    6                  K=FITALTKEYS.NUMWRDS; /* Works for IRKEYS too */
     1043     6327    6                  CALL FSA$FSP(K, ALTKEY$);
     1044     6328    6                  F$DCB.ALTKEYX=0;
     1045     6329    6                  END;
     1046     6330
     1047     6331    6               IF F$DCB.KFIELDX~=0 THEN DO;
     1048     6332    6                  KFIELD$=PINCRW(B$ROSEG$, F$DCB.KFIELDX);
     1049     6333    6                  K=KFIELD.NWORDS;
     1050     6334    6                  CALL FSA$FSP(K, KFIELD$);
     1051     6335    6                  F$DCB.KFIELDX=0;
     1052     6336    6                  END;
     1053     6337
     1054     6338    6               IF F$DCB.ORG=%INDEXED# THEN DO;
     1055     6339    6                  IF AMRF THEN I=VLP$ALTKEYS.SIZ#;
     1056     6340    7                  ELSE DO;
     1057     6341    7                     CALL HFF$DSIZ(ALTKX, I);
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:32   
     1058     6342    7                     I=(I-1)/4;
     1059     6343    7                     IF I>80 THEN I=80;
     1060     6344    7                     END;
     1061     6345
     1062     6346    7                  IF I>0 THEN DO;
     1063     6347    7                     K=((I+1)*SIZEW(FITALTKEYS.K(0)))+1;
     1064     6348    7                     CALL FSA$GSP(K, ALTKEY$) ALTRET(ERRORX);
     1065     6349    7                     K=K*4;
     1066     6350    7                     ALTKEY$->MOVEKB='0'B;
     1067     6351    7                     FITALTKEYS.NUMWRDS=K/4;
     1068     6352    7                     F$DCB.ALTKEYX=POFFW(ALTKEY$, B$ROSEG$);
     1069     6353    7                     IF I>=VLP$ALTKEYS.SIZ# THEN I=VLP$ALTKEYS.SIZ#;
     1070     6354    8                     ELSE IF F$DCB.FUN=%CREATE# THEN DO;
     1071     6355    8                        B$JIT.ERR=FMM$E$BADVECT17;
     1072     6356    8                        ALTRETURN;
     1073     6357    8                        END;
     1074     6358
     1075     6359    7                     FITALTKEYS.NUMENTS=I+1;
     1076     6360    8                     DO WHILE I>0;
     1077     6361    8                        FITALTKEYS.K.KEYL(I)=VLP$ALTKEYS.K.KEYL#(I-1);
     1078     6362    8                        FITALTKEYS.K.KEYX(I)=VLP$ALTKEYS.K.KEYX#(I-1);
     1079     6363    8                        FITALTKEYS.K.UNIQUE(I)=VLP$ALTKEYS.K.UNIQUE#(I-1);
     1080     6364    8                        I=I-1;
     1081     6365    8                        END;
     1082     6366    7                     END;
     1083     6367    6                  END;
     1084     6368    6               ELSE DO; /* INDEX RELATIONAL KEYS */
     1085     6369    7                  IF NOT AMRF THEN DO;
     1086     6370    7                     CALL HFF$DSIZ(ALTKX, N);
     1087     6371    7                     N=(N-4)/2-1;
     1088     6372    7                     NKEYS=0;
     1089     6373    8   COUNT:            DO I=0 TO N;
     1090     6374    8                        IF FPT$->VLP$IRKEYS.K.KEYEND#(I) THEN NKEYS=NKEYS+1;
     1091     6375    8                        IF NKEYS = VLP$IRKEYS.NKEYS# THEN EXIT;
     1092     6376    8                        END;
     1093     6377
     1094     6378    8                     IF NKEYS~=VLP$IRKEYS.NKEYS# THEN DO;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:33   
     1095     6379    8                        B$JIT.ERR=FMM$E$BADVECT17;
     1096     6380    8                        ALTRETURN;
     1097     6381    8                        END;
     1098     6382    7                     END;
     1099     6383
     1100     6384    6                  CALL FMG$IRSETUP(VLP$IRKEYS) ALTRET(ERRORX);
     1101     6385    6                  END;
     1102     6386    5               END;
     1103     6387    5            ELSE DO; /* Use it as FPRG_ */
     1104     6388    6               IF NOT AMRF THEN DO;
     1105     6389    6                  IF F$DCB.ASN=%DEVICE# AND F$DCB.RES='NO' THEN
     1106     6390    6                  GOTO NEXTPTR;
     1107     6391    6                  CALL HFF$DSIZ(ALTKX,I);
     1108     6392    7                  IF I<SIZEC(VLP$FPRG) THEN DO;
     1109     6393    7                     B$JIT.ERR=FMM$E$BADVECT17;
     1110     6394                    /*E*     ERROR: FMM-E$BADVECT17-E
     1111     6395              *        MESSAGE:ALTKEY, IRKEY, or FPRG VLP for M$OPEN %of %DC% is too small.
     1112     6396              MESSAGE1: If ALTKEY or IRKEY, the VLP frames an area too
     1113     6397              small to contain all the requested keys. Or,
     1114     6398              for IRKEYS only, NKEYS is not equal to the
     1115     6399              number of keys specified.
     1116     6400              */
     1117     6401    7                     ALTRETURN;
     1118     6402    7                     END;
     1119     6403    6                  END;
     1120     6404    6               IF F$DCB.FPRGX=0 THEN DO;
     1121     6405    6                  CALL FSA$GSP(SIZEW(VLP$FPRG),ALTKEY$) ALTRET(ERRORX);
     1122     6406    6                  F$DCB.FPRGX=POFFW(ALTKEY$,B$ROSEG$);
     1123     6407    6                  END;
     1124     6408    5               ELSE ALTKEY$=PINCRW(B$ROSEG$,F$DCB.FPRGX);
     1125     6409    5               ALTKEY$->VLP$FPRG=VLP$FPRG;
     1126     6410
     1127     6411    6               IF F$DCB.ALTKEYX~=0 THEN DO;
     1128     6412    6                  ALTKEY$=PINCRW(B$ROSEG$,F$DCB.ALTKEYX);
     1129     6413    6                  K=FITALTKEYS.NUMWRDS; /* Works for IRKEYS too */
     1130     6414    6                  CALL FSA$FSP(K, ALTKEY$);
     1131     6415    6                  F$DCB.ALTKEYX=0;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:34   
     1132     6416    6                  END;
     1133     6417
     1134     6418    6               IF F$DCB.KFIELDX~=0 THEN DO;
     1135     6419    6                  KFIELD$=PINCRW(B$ROSEG$,F$DCB.KFIELDX);
     1136     6420    6                  K=KFIELD.NWORDS;
     1137     6421    6                  CALL FSA$FSP(K, KFIELD$);
     1138     6422    6                  F$DCB.KFIELDX=0;
     1139     6423    6                  END;
     1140     6424
     1141     6425    5               END;
     1142     6426                    /**/
     1143     6427    4         CASE(ELSE); /* OTHER PARAMETERS */
     1144     6428    4         END;
     1145     6429    3   NEXTPTR:
     1146     6430    3         END;
     1147     6431
     1148     6432    2      RETURN;
     1149     6433    2   ERRORX: ALTRETURN;
     1150     6434    2   END FMM$MERGE1;
     1151     6435        %EJECT;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:35   
     1152     6436                    /*F*
     1153     6437                    *     NAME:   FMM$GETDCB
     1154     6438                    *
     1155     6439                    *     PURPOSE:  TO GET (I.E. BUILD) A DCB FOR THE USER IF A DCB OF THE
     1156     6440                    *               SPECIFIED NAME DOES NOT ALREADY EXIST.  IF THE DCB
     1157     6441                    *               CURRENTLY EXISTS, THEN RETURN ITS DCB NUMBER.
     1158     6442                    */
     1159     6443    1   FMM$GETDCB: ENTRY;
     1160     6444                    /**/
     1161     6445    1      JDCB$=ADDR(NIL);
     1162     6446    1      K=0;
     1163     6447    1      CALL HFF$NILERASE(1)ALTRET(NODCBNAME);
     1164     6448    1      FN.L=B$PS$(1)->FF.CHARX;
     1165     6449    1   NODCBNAME: IF K > 31
     1166     6450    1      THEN GOTO ERR6;
     1167     6451                    /*E*     ERROR: FMM-E$BADDCBNAME-E
     1168     6452                    *        MESSAGE: DCBNAME more than 31 characters for M$GETDCB
     1169     6453                    */
     1170     6454    1      CALL FMO$GETDOMAIN(I);
     1171     6455    2      IF I ~= 7 THEN DO;
     1172     6456    2         I=B$PS$(0)->FPT$GETDCB_V.DCB#;
     1173     6457    2         IF I < 5 OR I > 9 THEN GOTO USERSLOT;
     1174     6458    2         B$JIT.DCBNO=I;
     1175     6459    2         IF DCBADDR(I) ~= ADDR(NIL) THEN GOTO ERR5;
     1176     6460                    /*E*     ERROR: FMM-E$DCBHERE-C
     1177     6461                    *        MESSAGE:Special DCB% %DC% already exists.
     1178     6462                    */
     1179     6463    2         GOTO FOUNDSLOT;
     1180     6464    2         END;
     1181     6465    1   USERSLOT:;
     1182     6466    2      IF K>0 THEN DO I=2 TO B$ROSEG$->B$ROSEG.NUMDCBS;
     1183     6467    2         IF DCBADDR(I)~=ADDR(NIL)
     1184     6468    2         THEN IF DCBADDR(I)->F$DCB.DCBNAME.L=K
     1185     6469    2           AND DCBADDR(I)->F$DCB.DCBNAME.N=B$PS$(1)->FF.RECX
     1186     6470    2         THEN GOTO FOUNDDCB;
     1187     6471    2         END;
     1188     6472    2      IF B$PS$(0)->FPT$GETDCB_V.TEST THEN DO;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:36   
     1189     6473    2         I=0;
     1190     6474    2         GOTO FOUNDDCB;
     1191     6475    2         END;
     1192     6476    2      DO I=10 TO B$ROSEG$->B$ROSEG.NUMDCBS;
     1193     6477    2         IF DCBADDR(I)=ADDR(NIL) THEN GOTO FOUNDSLOT;
     1194     6478    2         END;
     1195     6479    1      GOTO NOSLOTS;
     1196     6480                    /*E*     ERROR: FMM-E$NOSLOTS-E
     1197     6481                    *        MESSAGE:No spare DCBSLOTS left for this M$GETDCB.
     1198     6482                    *        MESSAGE1:The run unit should be LINKed with more DCBSLOTS.
     1199     6483                    */
     1200     6484    1   FOUNDSLOT: J=POFFW(ADDR(F$DCB.DCBNAME),JDCB$)+(K+4)/4;
     1201     6485    1      CALL FSA$GSP(J,TDCB$) ALTRET(ERRORX);
     1202     6486    1      JDCB$=TDCB$;
     1203     6487    1      B$ROSEG$->B$ROSEG.DCBPTR$->DCBP(I)=JDCB$;
     1204     6488    1      J=J*4;
     1205     6489    1      JDCB$->MOVEJB='0'B;
     1206     6490    1      F$DCB.DCBNAME.L=K;
     1207     6491    1      IF K>0 THEN
     1208     6492    1      F$DCB.DCBNAME.N=B$PS$(1)->FF.RECX;
     1209     6493    1      B$JIT$->B$JIT.DCB$=JDCB$;
     1210     6494    1      CALL FMM$SCRUB1(TDCB$);
     1211     6495    1      F$DCB.DCB#=I;
     1212     6496    2      IF B$PS$(0)->FPT$GETDCB_V.MERGE THEN DO;
     1213     6497    2         CALL FMM$GETAMR(TDCB$,BUF$) ALTRET(NOSET);
     1214     6498    2         CALL FMM$MERGE1;
     1215     6499    2         END;
     1216     6500    1   NOSET: B$JIT$->B$JIT.ERR='0'B;
     1217     6501    1   FOUNDDCB:;
     1218     6502    1      CALL HFF$DSIZ(2,K);
     1219     6503    2      IF K~=0 THEN DO;
     1220     6504    2         IF K>2 THEN K=4;
     1221     6505    2         ELSE K=2;
     1222     6506    2         B$PS$(2)->MOVEKC=PINCRC(ADDR(I),4-K)->MOVEKC;
     1223     6507    2         END;
     1224     6508    1      CALL HFF$WRITE1(0)ALTRET(NOWRITE);
     1225     6509    1      B$PS$(0)->FPT$GETDCB_V.DCB#=I;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:37   
     1226     6510    1   NOWRITE:;
     1227     6511    1      GOTO RETRET;
     1228     6512                    /**/
     1229     6513        %EJECT;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:38   
     1230     6514                    /*F*   NAME:      FMM$MRGAMR
     1231     6515                    *
     1232     6516                    *      PURPOSE:   To merge assignments for a single DCB pointed to
     1233     6517                    *                 by B$JIT.DCB$.
     1234     6518                    *
     1235     6519                    */
     1236     6520    1   FMM$MRGAMR: ENTRY;
     1237     6521                    /**/
     1238     6522    1      JDCB$=B$JIT.DCB$;
     1239     6523    1      TDCB$=JDCB$;
     1240     6524    1      CALL FMM$SCRUB1(TDCB$);
     1241     6525    1      CALL FMM$GETAMR(TDCB$,BUF$)ALTRET(RETRET);
     1242     6526    1      CALL FMM$MERGE1;
     1243     6527    1      GOTO RETRET;
     1244     6528                    /**/
     1245     6529        %EJECT;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:39   
     1246     6530                    /*F*
     1247     6531                    *     NAME:   FMM$RELDCB
     1248     6532                    *
     1249     6533                    *     PURPOSE:   TO RELEASE A DCB AND RETURN ALL ITS ASSOCIATED DCB
     1250     6534                    *                SEGMENT SPACE.
     1251     6535                    */
     1252     6536    1   FMM$RELDCB: ENTRY;
     1253     6537                    /**/
     1254     6538    1      I=B$PS$(0)->FPT$RELDCB_V.DCB#;
     1255     6539    1      GOTO RELDCBI;
     1256     6540    1   FMM$RELDCBI: ENTRY;
     1257     6541                    /*F*  NAME:   FMM$RELDCBI
     1258     6542                    *     PURPOSE: To release a dcb by number without need for a CLIMB.
     1259     6543                    *        DESCRIPTION: The dcbnumber is in B$JIT.DCBNO
     1260     6544                    */
     1261     6545    1      I=B$JIT.DCBNO;
     1262     6546    1   RELDCBI:;
     1263     6547    1      IF I < 5
     1264     6548    1        OR I > B$ROSEG$->B$ROSEG.NUMDCBS
     1265     6549    1        OR B$ROSEG$->B$ROSEG.DCBPTR$->DCBP(I)=ADDR(NIL)
     1266     6550    1      THEN GOTO FMME$BADDCB#;
     1267     6551                    /*E*     ERROR: FMM-E$BADDCB#-E
     1268     6552                    *        MESSAGE: Nonexistent DCBs cannot be released.
     1269     6553                    */
     1270     6554    1      JDCB$=B$ROSEG$->B$ROSEG.DCBPTR$->DCBP(I);
     1271     6555    1      B$JIT$->B$JIT.DCB$=JDCB$;
     1272     6556    1      IF F$DCB.FCD
     1273     6557    1      THEN GOTO ERR1;
     1274     6558                    /*E*     ERROR: FMM-E$DCBOPEN-E
     1275     6559                    *        MESSAGE1:DCB% %DC% must be closed before open or release.
     1276     6560                    */
     1277     6561    1      TDCB$=JDCB$;
     1278     6562    1      CALL FMM$SCRUB(TDCB$); /* Release any TAB$, etc. */
     1279     6563    1      CALL FSA$FSP(SIZEW(JDCB$->F$DCB),TDCB$);
     1280     6564    1      B$ROSEG$->B$ROSEG.DCBPTR$->DCBP(I)=ADDR(NIL);
     1281     6565    1      B$JIT$->B$JIT.DCB$=ADDR(NIL);
     1282     6566    1      RETURN;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:40   
     1283     6567                    /**/
     1284     6568        %EJECT;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:41   
     1285     6569                    /*
     1286     6570                    *  ALL ERRORS FROM FMM$OPN ARE PROCESSED HERE.
     1287     6571                    */
     1288     6572    1   ERR1: B$JIT.ERR=FMM$E$DCBOPEN;
     1289     6573    1      RETURN;
     1290     6574    1   NOSLOTS: B$JIT.ERR=FMM$E$NOSLOTS;
     1291     6575    1      RETURN;
     1292     6576    1   ERR5: B$JIT.ERR=FMM$E$DCBHERE;
     1293     6577    1      RETURN;
     1294     6578    1   FMME$DOMAIN: B$JIT.ERR=FMM$E$DOMAIN;
     1295     6579    1      RETURN;
     1296     6580    1   FMME$BADDCB#: B$JIT.ERR=FMM$E$BADDCB#;
     1297     6581    1      RETURN;
     1298     6582    1   ERR6: B$JIT.ERR=FMM$E$BADDCBNAME;
     1299     6583    1      RETURN;
     1300     6584    1   ERR3: B$JIT.ERR=FMM$E$INVASN;
     1301     6585    1      GOTO RETRET;
     1302     6586    1   ERRORX: B$JIT.ERR=B$JIT.ERR&FMM$E$CODE|FMM$E$NOCODE;
     1303     6587    1      GOTO RETRET;
     1304     6588    1   END FMM$OPN;
     1305     6589        %EOD;

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:42   
--  Include file information  --

   UD_ERRORS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   FM_OPLBL_R.:E05TOU  cannot be made into a system file and is referenced.
   F$CP6V_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   FM$MACROS.:E05TOU  is referenced.
   FM_FIELD_C.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   KC_CP6.:E05TOU  is referenced.
   F$CP6P_C.:E05TOU  is referenced.
   F_CP6.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
      No diagnostics issued in procedure FMM$OPN.

   Procedure FMM$OPN requires 2673 words for executable code.
   Procedure FMM$OPN requires 44 words of local(AUTO) storage.

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:43   

 Object Unit name= FMM$OPN                                    File name= FMM$OPN.:E05TOU
 UTS= JUL 29 '97 16:51:29.76 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     50     62  FMM$OPN
    1   Proc  even  none  2673   5161  FMM$OPN
    2  RoData even  none    36     44  FMM$OPN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        0  FMM$OPN
     1    661                  yes      Std        0  FMM$DFLOPNP
     1    672                  yes      Std        0  FMM$DFLOPNSYS
     1    700                  yes      Std        0  FMM$DFLOPN
     1   1454                  yes      Std        0  FMM$ASSMRG
     1   4442                  yes      Std        0  FMM$GETDCB
     1   4765                  yes      Std        0  FMM$MRGAMR
     1   5014                  yes      Std        0  FMM$RELDCB
     1   5023                  yes      Std        0  FMM$RELDCBI

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  FM_DFLOPN_V
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:44   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
         yes           Std       1 FMO$GETDOMAIN
 yes     yes           Std       2 FMM$GETAMR
 yes     yes           Std       1 HFF$NIL
         yes           Std       1 FMD$RELBUF
 yes     yes           Std       1 HFF$WRITE1
 yes     yes           Std       1 HFF$NILERASE
         yes           Std       1 FMM$SCRUB
 yes     yes           Std       0 HFF$TRAPALT
 yes     yes           Std       1 FMM$IFPARAM
         yes           Std       3 FMD$GETBUF
 yes     yes           Std       2 FSA$GSP
         yes           Std       2 HFF$DSIZ
 yes     yes           Std       1 HFF$ERASE
 yes     yes           Std       2 FSA$FSP
 yes     yes           Std       0 FMM$OPNAMR
         yes           Std       1 FMF$REMOTE
         yes           Std       1 FTO$OPNAT
         yes           Std       1 FSN$OPNDEV
         yes           Std       1 KCO$OPCG
         yes           Std       1 FMN$OPNF
         yes           Std       1 FMM$SCRUB1
 yes     yes           Std       2 FMM$READAMR
         yes           Std       0 FMP$CLSTAR
         yes           Std       1 FMM$SCRAMBLE
         yes           Std       0 NAO$OPN
 yes     yes           Std       1 FPO$OPNOD
 yes     yes           Std       1 FMG$IRSETUP
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:45   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    F_OPLBL                          r    B$XL_UPPER_UR$                        B$PS$
     B$ROSEG$                              B$JIT$                                FMM$SDCB
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROSID                                 ISSID
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:46   


        1        1        /*M*  FMM$OPN - MERGE OPEN FPT INTO THE DCB.    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* NSO,MCL=0,MOC,MEC,CLM=12,EXM=12,CRT=6,DMR,PLM=3,IND=0,IAD=3,ENU=0,DCI=3,
        8        8        CSU=3,ECU=3,THI=0,DTI=0,CRM=86 */
        9        9                    /**/
       10       10                    /*P*  NAME:     FMM$OPN
       11       11                     PURPOSE:  MERGE OPEN FPT (OR ASSIGN MERGE RECORD) INTO THE
       12       12                     DESIGNATED DCB.
       13       13                     DESCRIPTION:  FMM$OPN IS CALLED BY THE PMME PROCESSOR TO
       14       14                     PROCESS AN M$OPEN PMME.  PARAMETERS ARE PASSED
       15       15                     IN THE PARAMETER STACK WITH THE EXCEPTION OF
       16       16                     THE DCB POINTER WHICH IS PLACED IN THE JIT
       17       17                     PRIOR TO THE CALL TO FMM$OPN.
       18       18                    */
       19       19                    /**/
       20       20                    /*D*  NAME:     FMM$OPN
       21       21                     CALL:     CALL FMM$OPN
       22       22                     INPUT:    PARAMETER STACK CONTAINS PTRS TO FPT AREAS.
       23       23                     B$JIT.DCB$ -> CURRENT DCB
       24       24                     OUTPUT:  OPEN DCB WITH INFORMATION MERGED.
       25       25                     DESCRIPTION:  OPEN PARAMETERS 'SCRUB','REASSIGN', AND 'SETDCB'
       26       26                     INDICATE THE TYPE OF MERGE TO BE DONE.
       27       27                     ALL PARAMETERS = NO, NORMAL OPEN.
       28       28                     SCRUB = YES, SCRUB DCB THEN REINITIALIZE
       29       29                     TO LOADER BUILT CONDITIONS.
       30       30                     REASSIGN = YES, REMERGE THE ASSIGN MERGE RECORD.
       31       31                     ALL CASES:
       32       32                     MERGE OPEN FPT.
       33       33                     SETDCB = YES, DO NOT OPEN DCB AFTER FPT MERGE.
       34       34                     FOR ALL CASES EXCEPT SETDCB, THE OPEN PROCESS
       35       35                     CONTINUES WITH A FAN OUT ON THE DCB ASSIGNMENT TYPE
       36       36                     (FILE, TAPE, OR DEVICE) TO COMPLETE THE SPECIFIC OPEN.
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:47   
       37       37                     FMM$OPN BUILDS AN ARRAY OF POINTERS DESCRIBING THE
       38       38                     ADDRESSES OF EACH OF THE OPENFPT PARAMETERS FOR THE
       39       39                     INTERNAL OPEN ROUTINES.  THEY ARE EITHER 'NULL' IF
       40       40                     NO DATA IS ASSOCIATED WITH THAT PARAMETER OR THE
       41       41                     POINTER TO THE DATA AREA IN THE ASSIGN MERGE BUFFER,
       42       42                     THE IFPARAM BUFFER, OR THE OPEN FPT.  THESE PTRS
       43       43                     ARE PASSED AS INPUT TO THE SPECIFIC OPEN ROUTINES.
       44       44                    */
       45       45                    /**/
       46       46        FMM$OPN: PROC;

     46  1 000000   000000 700200 xent  FMM$OPN      TSX0  ! X66_AUTO_0
         1 000001   000054 000000                    ZERO    44,0

       47       47                    /**/
       48       48        %MACRO F$DCB#(BASED=BASED);
       49       49        %INCLUDE F$DCB;
       50       98        %MEND;
       51       99        %INCLUDE F_CP6;
       52     1124        %INCLUDE F$CP6P_C;
       53     1135        %INCLUDE KC_CP6;
       54     1695        %INCLUDE KI_CP6;
       55     2791        %INCLUDE FM_FIELD_C;
       56     2832        %FPT$OPEN_P(FPTN=FPT,PFMT=PTR,STCLASS="BASED(FPT$)");
       57     2838        %VLP_ACCT(STCLASS="BASED(FPT$)",FPTN=VLP$ACCT);
       58     2851        %VLP_PASS(STCLASS="BASED(FPT$)",FPTN=VLP$PASS);
       59     2864        %VLP_SN(STCLASS="BASED(FPT$)",FPTN=VLP$SN);
       60     2877        %VLP_TAB(STCLASS="BASED(FPT$)",FPTN=VLP$TAB);
       61     2891        %VLP_WSN(STCLASS="BASED(FPT$)",FPTN=VLP$WSN);
       62     2904        %VLP_FORM(STCLASS="BASED(FPT$)",FPTN=VLP$FORM);
       63     2917        %VLP_HDR(LEN=1,STCLASS="BASED(FPT$)",FPTN=VLP$HDR);
       64     2933        %VLP_HDR (FPTN=VLP$HDRF, LEN=163, STCLASS=BASED);
       65     2949        %VLP_STATION(STCLASS=BASED,FPTN=VLP$STATION);
       66     2976        %VLP_SETSTA(STCLASS="BASED(FPT$)",FPTN=VLP$SETSTA);
       67     3004        %VLP_ALTKEYS (FPTN=VLP$ALTKEYS,STCLASS="BASED(FPT$)");
       68     3019        %VLP_FPRG (STCLASS="BASED(FPT$)", FPTN=VLP$FPRG);
       69     3040        %VLP_IRKEYS (STCLASS="BASED(FPT$)", FPTN=VLP$IRKEYS);
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:48   
       70     3055        %VLP_RECFIELD (STCLASS="BASED(FIELD$)", FPTN=VLP$RECFIELD);
       71     3099        %VLP_IRREC (STCLASS="BASED(IRREC$)",FPTN=VLP$IRREC);
       72     3113        %INCLUDE FM$MACROS;
       73     3488        %CODE16(BASED="BASED(TEMP$)");
       74     3496        %FITALTKEYS (BASED="BASED(ALTKEY$)");
       75     3502        %FM$GRAN;
       76     3506        %INCLUDE B$ROSEG;
       77     3569        %F$DCB#(BASED="BASED(JDCB$)");
       78     3619        %INCLUDE F$CP6V_C;
       79     3845        %FPT$GETDCB_V;
       80     3848        %FPT$RELDCB_V;
       81     3851        %FPT$OPEN_V(BASED="BASED(FPT$)");
       82     3866        %VLP$VIRTUAL_V;
       83     3871        %FMG$KFIELD (FPTN=KFIELD, STCLASS="BASED(KFIELD$)");
       84     3874        %FM$FIELD_START (FPTN=FM$FIELD_START,STCLASS="BASED(START$)");
       85     3896        %INCLUDE FM_OPLBL_R;
       86     3910        %INCLUDE B$TABLES_C;
       87     4018        %B$XL_UPPER_UR;
       88     4022        %INCLUDE B$JIT_C;
       89     4336        %B$JIT0;
       90     4425        %U$JIT1;
       91     4499        %M$JIT2X;
       92     4502        %F$JIT3;
       93     4507        %S$JIT4;
       94     4513        %J$JIT5X;
       95     4516        %A$JIT6X;
       96     4519        %INCLUDE CP_6_SUBS;
       97     5059        %INCLUDE F_ERRORS_C;
       98     5299        %INCLUDE UD_ERRORS_C;
       99     5341        %SUB FCG#='0615'O;
      100     5342        %SUB MID#='15'O;
      101     5343        %SUB SNX=1/*SNX*/;
      102     5344        %SUB ULBLX=2/*ULBLX*/;
      103     5345        %SUB NAMEX=3/*NAMEX*/;
      104     5346        %SUB PASSX=4/*PASSX*/;
      105     5347        %SUB ACCESSX=5/*ACCESSX*/;
      106     5348        %SUB ACSVEHX=6/*ACSVEHX*/;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:49   
      107     5349        %SUB UATTRX=7/*UATTRX*/;
      108     5350        %SUB INSTATTRX=8/*INSTATTRX*/;
      109     5351        %SUB PROCATTRX=9/*PROCATTRX*/;
      110     5352        %SUB ACCTX=10/*ACCTX*/;
      111     5353        %SUB IFPARAMX=11/*IFPARAMX*/;
      112     5354        %SUB FPARAMX=12/*FPARAMX*/;
      113     5355        %SUB WSNX=13/*WSNX*/;
      114     5356        %SUB TABX=14/*TABX*/;
      115     5357        %SUB HDRX=15/*HDRX*/;
      116     5358        %SUB FORMX=16/*FORMX*/;
      117     5359        %SUB ALTKX=17/*ALTKX*/;
      118     5360        %SUB TOPX=17/*TOPX*/;
      119     5361                    /**/
      120     5362                    /* SYMREF DATA */
      121     5363                    /**/
      122     5364    1   DCL B$PS$(0:19) PTR SYMREF; /* PARAMETER SEGMENT POINTERS */
      123     5365    1   DCL B$ROSEG$ PTR SYMREF; /* PTR TO READ ONLY SEGMENT */
      124     5366    1   DCL B$JIT$ PTR SYMREF; /* POINTER TO THE JIT */
      125     5367    1   DCL FMM$SDCB CHAR(100)SYMREF;
      126     5368                    /**/
      127     5369                    /* DEFINE EXTERNAL ROUTINES */
      128     5370                    /**/
      129     5371    1   DCL FMM$IFPARAM ENTRY(1) ALTRET;
      130     5372    1   DCL FMM$SCRUB ENTRY(1); /* SCRUB THE DCB */
      131     5373    1   DCL FMM$SCRUB1 ENTRY(1); /* SCRUB DCB AT STEP TIME */
      132     5374    1   DCL FMM$SCRAMBLE ENTRY(1); /* SCRAMBLE THE PASSWORD */
      133     5375    1   DCL FMM$GETAMR ENTRY(2) ALTRET; /* GET THE ASSIGN/MERGE RECORD */
      134     5376    1   DCL FMD$GETBUF ENTRY(3); /* GET FM BUFFER */
      135     5377    1   DCL FMD$RELBUF ENTRY(1); /* RELEASE FM BUFFER */
      136     5378    1   DCL FMF$REMOTE ENTRY(1);
      137     5379    1   DCL FMM$OPNAMR ENTRY ALTRET; /* OPEN *A THRU JIT.DCB$ */
      138     5380    1   DCL FMM$READAMR ENTRY(2) ALTRET; /* READ ASSIGN MERGE RECORD */
      139     5381    1   DCL FMO$GETDOMAIN ENTRY(1); /* GET CALLING USER DOMAIN */
      140     5382    1   DCL FMP$CLSTAR ENTRY; /* CLOSE ASSIGN MERGE FILE */
      141     5383    1   DCL HFF$DSIZ ENTRY(2);
      142     5384    1   DCL HFF$NIL ENTRY(1) ALTRET; /* CHECK PARAMETER FOR NIL */
      143     5385    1   DCL HFF$ERASE ENTRY(1) ALTRET; /* CHECK PARAMETER FOR ERASE */
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:50   
      144     5386    1   DCL HFF$NILERASE ENTRY(1) ALTRET;
      145     5387    1   DCL HFF$TRAPALT ENTRY ALTRET;
      146     5388    1   DCL HFF$WRITE1 ENTRY(1)ALTRET;
      147     5389    1   DCL FMN$OPNF ENTRY(1); /* FILE OPEN ENTRY */
      148     5390    1   DCL FTO$OPNAT ENTRY(1); /* TAPE OPEN ENTRY */
      149     5391    1   DCL FPO$OPNOD ENTRY(1) ALTRET; /* Optical Disk File Open Entry */
      150     5392    1   DCL FSA$GSP ENTRY(2) ALTRET; /* GET ROSEG SPACE */
      151     5393    1   DCL FSA$FSP ENTRY(2) ALTRET; /* FREE ROSEG SPACE */
      152     5394    1   DCL FSN$OPNDEV ENTRY(1); /* DEVICE OPEN ENTRY */
      153     5395    1   DCL KCO$OPCG ENTRY(1); /* COMGROUP OPEN ENTRY */
      154     5396    1   DCL FMG$IRSETUP ENTRY(1) ALTRET;
      155     5397    1   DCL NAO$OPN ENTRY;
      156     5398                    /**/
      157     5399                    /* CONSTANT DATA */
      158     5400                    /**/
      159     5401    1   DCL FM_DFLOPN_V(0:11) BIT(72) CONSTANT SYMDEF INIT('0'B*0);
      160     5402        %ERRCODE(NAME=FMM$E$DCBOPEN,COD#=%E$DCBOPEN,SEV#=0);
      161     5406        %ERRCODE(NAME=FMM$E$NOSLOTS,COD#=%E$NOSLOTS);
      162     5410        %ERRCODE(NAME=FMM$E$BADDCBNAME,COD#=%E$BADDCBNAME);
      163     5414        %ERRCODE(NAME=FMM$E$DCBHERE,COD#=%E$DCBHERE,SEV#=0);
      164     5418        %ERRCODE(NAME=FMM$E$INVASN,COD#=%E$INVASN);
      165     5422        %ERRCODE(NAME=FMM$E$NOCODE,COD#=0);
      166     5426        %ERRCODE (NAME=FMM$E$CODE, SEV#=0, MON#='1'B, COD#=16383, FCG#='0'O, MID#='0'O);
      167     5430        %ERRCODE (NAME=FMM$E$BADVECT2, COD#=%E$BADVECT2);
      168     5434        %ERRCODE (NAME=FMM$E$BADVECT14, COD#=%E$BADVECT14);
      169     5438        %ERRCODE(NAME=FMM$E$BADVECT15,COD#=%E$BADVECT15);
      170     5442        %ERRCODE (NAME=FMM$E$BADVECT16, COD#=%E$BADVECT16);
      171     5446        %ERRCODE (NAME=FMM$E$BADVECT17, COD#=%E$BADVECT17);
      172     5450        %ERRCODE(NAME=FMM$E$DOMAIN,COD#=%E$DOMAIN);
      173     5454        %ERRCODE(NAME=FMM$E$BADDCB#,COD#=%E$BADDCB#);
      174     5458    1   DCL FUN(0:4) UBIN CONSTANT INIT(%IN#, /* Default FUN */
      175     5459    1     %IN#,     /* FILE */
      176     5460    1     %IN#,     /* TAPE */
      177     5461    1     %UPDATE#, /* DEVICE */
      178     5462    1    %UPDATE#); /* COMGROUP */
      179     5463                    /* DEFAULT OPEN FPT OPTIONS */
      180     5464                    /**/
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:51   
      181     5465                    /* AUTOMATIC DATA */
      182     5466                    /**/
      183     5467    1   DCL JDCB$ PTR; /* DCB POINTER */
      184     5468    1   DCL FPT$ PTR; /* PTR TO CURRENT FPT ENTRY */
      185     5469    1   DCL BUF$ PTR; /* AMR POINTER */
      186     5470    1   DCL TEMP$ PTR;
      187     5471    1   DCL ALTKEY$ PTR;
      188     5472    1   DCL KFIELD$ PTR;
      189     5473    1   DCL N SBIN;
      190     5474    1   DCL NKEYS SBIN;
      191     5475    1   DCL FIELD$ PTR;
      192     5476    1   DCL START$ PTR;
      193     5477    1   DCL IRREC$ PTR;
      194     5478    1   DCL PN$(0:TOPX)PTR; /* DEFINE OPEN POINTER ARRAY */
      195     5479    1   DCL I UBIN; /* INDEX */
      196     5480    1   DCL J UBIN; /* INDEX */
      197     5481    1   DCL AMRF BIT(36) ALIGNED; /* SOURCE FLAG (AMR OR OPEN FPT) */
      198     5482                    /**/
      199     5483                    /* BASED DATA NOT IN INCLUDE FILES */
      200     5484                    /**/
      201     5485    1   DCL AMRX (0:15) UBIN HALF BASED(BUF$) ALIGNED; /* AMR PARAMETER INDEXES */
      202     5486    1   DCL DCBP (0:0) PTR BASED ALIGNED; /* USER DCB POINTERS */
      203     5487    1   DCL 1 NAME BASED (FPT$), /* DCBNAME MAP  FOR OPLBL CHECK */
      204     5488    1         2 S BIT(27),
      205     5489    1         2 OP CHAR(2) UNAL;
      206     5490    1   DCL K UBIN; /* INDEX */
      207     5491    1   DCL 1 FN REDEF K,
      208     5492    1         2 * BIT(27) UNAL,
      209     5493    1         2 L CHAR(1) UNAL;
      210     5494    1   DCL 1 FF BASED,
      211     5495    1         2 CHARX CHAR(1) UNAL,
      212     5496    1         2 RECX CHAR(K) UNAL;
      213     5497    1   DCL MOVEKC CHAR(K) BASED;
      214     5498    1   DCL 1 MOVEKB BASED,2 * CHAR(K);
      215     5499    1   DCL 1 MOVEJB BASED,2 * CHAR(J);
      216     5500    1   DCL WRD(0:1023) UBIN BASED ALIGNED;
      217     5501    1   DCL TDCB$ PTR; /* Copy of JDCB$ for use in calls */
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:52   
      218     5502        %EJECT;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:53   
      219     5503                    /**/
      220     5504                    /*
      221     5505                    *  GET THE DCB ADDRESS
      222     5506                    */
      223     5507    1      JDCB$=B$JIT$->B$JIT.DCB$;

   5507  1 000002   000000 470400 xsym               LDP0    B$JIT$
         1 000003   000232 236100                    LDQ     154,,PR0
         1 000004   200003 756100                    STQ     JDCB$,,AUTO

      224     5508    1      TDCB$=JDCB$;

   5508  1 000005   200044 756100                    STQ     TDCB$,,AUTO

      225     5509    1      CALL FMO$GETDOMAIN(I);

   5509  1 000006   200040 631500                    EPPR1   I,,AUTO
         1 000007   200050 451500                    STP1    I+1,,AUTO
         1 000010   200050 630500                    EPPR0   I+1,,AUTO
         1 000011   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000012   000000 701000 xent               TSX1    FMO$GETDOMAIN
         1 000013   000000 011000                    NOP     0

      226     5510    2      IF F$DCB.FCD THEN DO;

   5510  1 000014   200003 470500                    LDP0    JDCB$,,AUTO
         1 000015   000031 236100                    LDQ     25,,PR0
         1 000016   020000 316007                    CANQ    8192,DL
         1 000017   000056 600000 1                  TZE     s:5525

      227     5511    3         IF I=4 AND F$DCB.ASN=%COMGROUP# AND JDCB$=DCBADDR(%M$UC#) THEN DO;

   5511  1 000020   200040 235100                    LDA     I,,AUTO
         1 000021   000004 115007                    CMPA    4,DL
         1 000022   000055 601000 1                  TNZ     s:5519
         1 000023   000032 236100                    LDQ     26,,PR0
         1 000024   777000 376007                    ANQ     -512,DL
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:54   
         1 000025   004000 116007                    CMPQ    2048,DL
         1 000026   000055 601000 1                  TNZ     s:5519
         1 000027   000000 471400 2                  LDP1    0
         1 000030   100000 473500                    LDP3    0,,PR1
         1 000031   200003 236100                    LDQ     JDCB$,,AUTO
         1 000032   300003 116100                    CMPQ    3,,PR3
         1 000033   000055 601000 1                  TNZ     s:5519

      228     5512                    /* Allow CP to change SETSTA for TP users */
      229     5513    3            CALL HFF$NILERASE(ULBLX) ALTRET(ERR1);

   5513  1 000034   000001 630400 2                  EPPR0   1
         1 000035   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000036   000000 701000 xent               TSX1    HFF$NILERASE
         1 000037   005120 702000 1                  TSX2    ERR1

      230     5514    3            FPT$=B$PS$(ULBLX);

   5514  1 000040   000002 236000 xsym               LDQ     B$PS$+2
         1 000041   200004 756100                    STQ     FPT$,,AUTO

      231     5515    3            F$DCB.SETSTA$->VLP$SETSTA.ISTA=VLP$SETSTA.ISTA;

   5515  1 000042   200003 470500                    LDP0    JDCB$,,AUTO
         1 000043   000006 471500                    LDP1    6,,PR0
         1 000044   200004 473500                    LDP3    FPT$,,AUTO
         1 000045   000100 100500                    MLR     fill='000'O
         1 000046   300002 000024                    ADSC9   2,,PR3                   cn=0,n=20
         1 000047   100002 000024                    ADSC9   2,,PR1                   cn=0,n=20

      232     5516    3            F$DCB.SETSTA$->VLP$SETSTA.OSTA=VLP$SETSTA.OSTA;

   5516  1 000050   000006 471500                    LDP1    6,,PR0
         1 000051   000100 100500                    MLR     fill='000'O
         1 000052   300007 000024                    ADSC9   7,,PR3                   cn=0,n=20
         1 000053   100007 000024                    ADSC9   7,,PR1                   cn=0,n=20

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:55   
      233     5517    3            RETURN;

   5517  1 000054   000000 702200 xent               TSX2  ! X66_ARET

      234     5518    3            END;
      235     5519    2         GOTO ERR1;

   5519  1 000055   005120 710000 1                  TRA     ERR1

      236     5520    2         END;
      237     5521                    /*E*     ERROR: FMM-E$DCBOPEN-C
      238     5522                    *        MESSAGE:DCB% %DC% is still open.
      239     5523                    *     DESCRIPTION:  ATTEMPT TO OPEN A DCB THAT IS ALREADY OPEN.
      240     5524                    */
      241     5525    1      IF DCBADDR(1)=JDCB$ AND I~=0 THEN GOTO FMME$DOMAIN;

   5525  1 000056   000000 471400 2                  LDP1    0
         1 000057   100000 473500                    LDP3    0,,PR1
         1 000060   300001 236100                    LDQ     1,,PR3
         1 000061   200003 116100                    CMPQ    JDCB$,,AUTO
         1 000062   000065 601000 1                  TNZ     s:5534
         1 000063   200040 235100                    LDA     I,,AUTO
         1 000064   005133 601000 1                  TNZ     FMME$DOMAIN

      242     5526                    /*E*     ERROR: FMM-E$DOMAIN-E
      243     5527                    *        MESSAGE: M$* must be opened by CP-6.
      244     5528                    */
      245     5529                    /*
      246     5530                    *  SCRUB V AREAS OF DCB IF REQUESTED
      247     5531                    *  GET ASSIGN MERGE RECORD IF WE NEED IT
      248     5532                    *  REMERGE ASSIGNS IF REQUESTED
      249     5533                    */
      250     5534    1      FPT$=B$PS$(0);

   5534  1 000065   000000 236000 xsym               LDQ     B$PS$
         1 000066   200004 756100                    STQ     FPT$,,AUTO

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:56   
      251     5535    1      IF FPT$OPEN_V.INITZ.SCRUB THEN CALL FMM$SCRUB(TDCB$);

   5535  1 000067   200004 474500                    LDP4    FPT$,,AUTO
         1 000070   400000 236100                    LDQ     0,,PR4
         1 000071   400000 316007                    CANQ    -131072,DL
         1 000072   000101 600000 1                  TZE     s:5536

   5535  1 000073   200044 635500                    EPPR5   TDCB$,,AUTO
         1 000074   200050 455500                    STP5    I+1,,AUTO
         1 000075   200050 630500                    EPPR0   I+1,,AUTO
         1 000076   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000077   000000 701000 xent               TSX1    FMM$SCRUB
         1 000100   000000 011000                    NOP     0

      252     5536    1      F$DCB.WSR=I;

   5536  1 000101   200003 470500                    LDP0    JDCB$,,AUTO
         1 000102   200040 236100                    LDQ     I,,AUTO
         1 000103   000022 736000                    QLS     18
         1 000104   000040 552120                    STBQ    32,'20'O,PR0

      253     5537    1      F$DCB.DCB#=FPT$OPEN_V.DCB#;

   5537  1 000105   200004 471500                    LDP1    FPT$,,AUTO
         1 000106   100000 236100                    LDQ     0,,PR1
         1 000107   000011 736000                    QLS     9
         1 000110   000060 552140                    STBQ    48,'40'O,PR0

      254     5538    1      CALL HFF$TRAPALT ALTRET(RETRET);

   5538  1 000111   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000112   000000 701000 xent               TSX1    HFF$TRAPALT
         1 000113   000637 702000 1                  TSX2    RETRET

      255     5539    1      F$DCB.BFR(0)='0'B;

   5539  1 000114   200003 470500                    LDP0    JDCB$,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:57   
         1 000115   000115 450100                    STZ     77,,PR0

      256     5540    2      IF FPT$OPEN_V.INITZ.REASSIGN THEN DO;

   5540  1 000116   200004 471500                    LDP1    FPT$,,AUTO
         1 000117   100000 236100                    LDQ     0,,PR1
         1 000120   200000 316007                    CANQ    65536,DL
         1 000121   000134 600000 1                  TZE     NORMOPN

      257     5541    2         CALL FMM$GETAMR(TDCB$,BUF$)ALTRET(NORMOPN);

   5541  1 000122   200005 633500                    EPPR3   BUF$,,AUTO
         1 000123   200051 453500                    STP3    I+2,,AUTO
         1 000124   200044 634500                    EPPR4   TDCB$,,AUTO
         1 000125   200050 454500                    STP4    I+1,,AUTO
         1 000126   200050 630500                    EPPR0   I+1,,AUTO
         1 000127   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000130   000000 701000 xent               TSX1    FMM$GETAMR
         1 000131   000134 702000 1                  TSX2    NORMOPN

      258     5542    2         CALL FMM$MERGE1 ALTRET(ERRORX);

   5542  1 000132   001672 701000 1                  TSX1    FMM$MERGE1
         1 000133   005153 702000 1                  TSX2    ERRORX

      259     5543    2         END;

      260     5544                    /*
      261     5545                    *  BEGIN BY INITIALIZING ALL PTRS TO NIL
      262     5546                    */
      263     5547    2   NORMOPN: DO I=0 TO TOPX;

   5547  1 000134   200040 450100       NORMOPN      STZ     I,,AUTO

      264     5548    2         PN$(I)=ADDR(NIL);

   5548  1 000135   000001 236000 xsym               LDQ     B_VECTNIL+1
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:58   
         1 000136   200040 720100                    LXL0    I,,AUTO
         1 000137   200016 756110                    STQ     PN$,X0,AUTO

      265     5549    2         END;

   5549  1 000140   200040 235100                    LDA     I,,AUTO
         1 000141   000001 035007                    ADLA    1,DL
         1 000142   200040 755100                    STA     I,,AUTO
         1 000143   000022 115007                    CMPA    18,DL
         1 000144   000135 602000 1                  TNC     s:5548

      266     5550    1      B$JIT.ERR='0'B;

   5550  1 000145   000000 470400 xsym               LDP0    B$JIT$
         1 000146   000012 450100                    STZ     10,,PR0

      267     5551                    /*
      268     5552                    *  CHECK IF IFPARAM$ WAS SPECIFIED AND IF SO, FILL IN THE
      269     5553                    *  SPECIFIC POINTERS FROM THE FIT INFORMATION BUFFER.
      270     5554                    */
      271     5555    1      CALL HFF$NILERASE(IFPARAMX)ALTRET(NORMOPN1);

   5555  1 000147   000002 630400 2                  EPPR0   2
         1 000150   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000151   000000 701000 xent               TSX1    HFF$NILERASE
         1 000152   000213 702000 1                  TSX2    NORMOPN1

      272     5556    1      IF B$PS$(0)->FPT$OPEN_V.ASN=%DEVICE#

   5556  1 000153   000000 470400 xsym               LDP0    B$PS$
         1 000154   000001 236100                    LDQ     1,,PR0
         1 000155   000777 376007                    ANQ     511,DL
         1 000156   000003 116007                    CMPQ    3,DL
         1 000157   000213 600000 1                  TZE     NORMOPN1
         1 000160   000001 236100                    LDQ     1,,PR0
         1 000161   000777 316007                    CANQ    511,DL
         1 000162   000170 601000 1                  TNZ     s:5559
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:59   
         1 000163   200003 471500                    LDP1    JDCB$,,AUTO
         1 000164   100032 236100                    LDQ     26,,PR1
         1 000165   777000 376007                    ANQ     -512,DL
         1 000166   003000 116007                    CMPQ    1536,DL
         1 000167   000213 600000 1                  TZE     NORMOPN1

      273     5557    1        OR B$PS$(0)->FPT$OPEN_V.ASN=0 AND F$DCB.ASN=%DEVICE#
      274     5558    1      THEN GOTO NORMOPN1; /* IFPARAM is useless for devices */
      275     5559    1      PN$(IFPARAMX)=B$PS$(IFPARAMX);

   5559  1 000170   000013 236000 xsym               LDQ     B$PS$+11
         1 000171   200031 756100                    STQ     PN$+11,,AUTO

      276     5560    1      IF B$PS$(0)->FPT$OPEN_V.ACS=%BLOCK#

   5560  1 000172   000002 236100                    LDQ     2,,PR0
         1 000173   000777 376007                    ANQ     511,DL
         1 000174   000003 116007                    CMPQ    3,DL
         1 000175   000205 601000 1                  TNZ     s:5563
         1 000176   000000 471400 xsym               LDP1    B$JIT$
         1 000177   100013 236100                    LDQ     11,,PR1
         1 000200   000053 376000 0                  ANQ     FUN+5
         1 000201   000205 600000 1                  TZE     s:5563

      277     5561    1        AND B$JIT.PRIV.ACTIVE&%PR_FMBLK#
      278     5562    1      THEN PN$(IFPARAMX)=PINCRW(PN$(IFPARAMX),SIZEW(FM$GRAN));

   5562  1 000202   200031 236100                    LDQ     PN$+11,,AUTO
         1 000203   000005 036003                    ADLQ    5,DU
         1 000204   200031 756100                    STQ     PN$+11,,AUTO

      279     5563    1      CALL FMM$IFPARAM(PN$) ALTRET(ERRORX);

   5563  1 000205   200016 631500                    EPPR1   PN$,,AUTO
         1 000206   200050 451500                    STP1    I+1,,AUTO
         1 000207   200050 630500                    EPPR0   I+1,,AUTO
         1 000210   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:60   
         1 000211   000000 701000 xent               TSX1    FMM$IFPARAM
         1 000212   005153 702000 1                  TSX2    ERRORX

      280     5564                    /*
      281     5565                    *  THEN SET UP POINTERS BASED ON WHETHER THEY WERE
      282     5566                    *  SPECIFIED OR NOT IN THE FPT.
      283     5567                    */
      284     5568    1   NORMOPN1:
      285     5569    2      DO I=0 TO TOPX;

   5569  1 000213   200040 450100       NORMOPN1     STZ     I,,AUTO

      286     5570    2         CALL HFF$NIL(I) ALTRET(CONTOPN);

   5570  1 000214   200040 630500                    EPPR0   I,,AUTO
         1 000215   200050 450500                    STP0    I+1,,AUTO
         1 000216   200050 630500                    EPPR0   I+1,,AUTO
         1 000217   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000220   000000 701000 xent               TSX1    HFF$NIL
         1 000221   000623 702000 1                  TSX2    CONTOPN

      287     5571    2         CALL HFF$ERASE(I) ALTRET(ERASURES);

   5571  1 000222   200040 630500                    EPPR0   I,,AUTO
         1 000223   200050 450500                    STP0    I+1,,AUTO
         1 000224   200050 630500                    EPPR0   I+1,,AUTO
         1 000225   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000226   000000 701000 xent               TSX1    HFF$ERASE
         1 000227   000234 702000 1                  TSX2    ERASURES

      288     5572    2         PN$(I)=B$PS$(I); /* NOT NIL OR ERASE, SET TO PARAM STACK */

   5572  1 000230   200040 720100                    LXL0    I,,AUTO
         1 000231   000000 236010 xsym               LDQ     B$PS$,X0
         1 000232   200016 756110                    STQ     PN$,X0,AUTO

      289     5573    2         GOTO CONTOPN;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:61   

   5573  1 000233   000623 710000 1                  TRA     CONTOPN

      290     5574                    /*
      291     5575                    *  ERASE THE SPECIFIED AREAS OF THE DCB IF THE POINTER IS THE
      292     5576                    *  ADDR(ERASE).
      293     5577                    */
      294     5578    2   ERASURES: PN$(I)=ADDR(NIL);

   5578  1 000234   000001 236000 xsym  ERASURES     LDQ     B_VECTNIL+1
         1 000235   200040 720100                    LXL0    I,,AUTO
         1 000236   200016 756110                    STQ     PN$,X0,AUTO

      295     5579    3         DO CASE(I);

   5579  1 000237   200040 235100                    LDA     I,,AUTO
         1 000240   000022 115007                    CMPA    18,DL
         1 000241   000243 602005 1                  TNC     s:5579+4,AL
         1 000242   000623 710000 1                  TRA     CONTOPN
         1 000243   000623 710000 1                  TRA     CONTOPN
         1 000244   000363 710000 1                  TRA     s:5615
         1 000245   000265 710000 1                  TRA     s:5582
         1 000246   000305 710000 1                  TRA     s:5587
         1 000247   000330 710000 1                  TRA     s:5595
         1 000250   000337 710000 1                  TRA     s:5599
         1 000251   000343 710000 1                  TRA     s:5602
         1 000252   000347 710000 1                  TRA     s:5605
         1 000253   000353 710000 1                  TRA     s:5608
         1 000254   000357 710000 1                  TRA     s:5611
         1 000255   000323 710000 1                  TRA     s:5592
         1 000256   000623 710000 1                  TRA     CONTOPN
         1 000257   000623 710000 1                  TRA     CONTOPN
         1 000260   000372 710000 1                  TRA     s:5619
         1 000261   000400 710000 1                  TRA     s:5622
         1 000262   000470 710000 1                  TRA     s:5640
         1 000263   000623 710000 1                  TRA     CONTOPN
         1 000264   000535 710000 1                  TRA     s:5651
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:62   

      296     5580                    /**/
      297     5581    3         CASE(ULBLX);

      298     5582    3            IF F$DCB.LASTSTA$~=ADDR(NIL)

   5582  1 000265   200003 470500                    LDP0    JDCB$,,AUTO
         1 000266   000007 236100                    LDQ     7,,PR0
         1 000267   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000270   000301 600000 1                  TZE     s:5584

      299     5583    3            THEN CALL FSA$FSP(SIZEW(VLP$STATION)+SIZEW(VLP$SETSTA),F$DCB.LASTSTA$);

   5583  1 000271   200003 236100                    LDQ     JDCB$,,AUTO
         1 000272   000007 036003                    ADLQ    7,DU
         1 000273   000004 235000 2                  LDA     4
         1 000274   200050 757100                    STAQ    I+1,,AUTO
         1 000275   200050 630500                    EPPR0   I+1,,AUTO
         1 000276   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000277   000000 701000 xent               TSX1    FSA$FSP
         1 000300   000000 011000                    NOP     0

      300     5584    3            F$DCB.SETSTA$=ADDR(NIL);

   5584  1 000301   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000302   200003 470500                    LDP0    JDCB$,,AUTO
         1 000303   000006 756100                    STQ     6,,PR0
         1 000304   000623 710000 1                  TRA     CONTOPN

      301     5585                    /**/
      302     5586    3         CASE(NAMEX);

      303     5587    3            F$DCB.NAME.L=0;

   5587  1 000305   200003 470500                    LDP0    JDCB$,,AUTO
         1 000306   000000 236003                    LDQ     0,DU
         1 000307   000010 552140                    STBQ    8,'40'O,PR0
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:63   

      304     5588    3            F$DCB.NAME.C=' ';

   5588  1 000310   040100 100400                    MLR     fill='040'O
         1 000311   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000312   000010 200037                    ADSC9   8,,PR0                   cn=1,n=31

      305     5589    3            B$JIT$->B$JIT.FEXT(F$DCB.FEXTX)='0'B;

   5589  1 000313   000034 236100                    LDQ     28,,PR0
         1 000314   000011 772000                    QRL     9
         1 000315   000777 376007                    ANQ     511,DL
         1 000316   000000 471400 xsym               LDP1    B$JIT$
         1 000317   003106 060400                    CSL     bolr='003'O
         1 000320   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         1 000321   100220 000001                    BDSC    144,Q,PR1                by=0,bit=0,n=1
         1 000322   000623 710000 1                  TRA     CONTOPN

      306     5590                    /**/
      307     5591    3         CASE(ACCTX);

      308     5592    3            F$DCB.ACCT=' ';

   5592  1 000323   000035 235000 xsym               LDA     B_VECTNIL+29
         1 000324   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 000325   200003 470500                    LDP0    JDCB$,,AUTO
         1 000326   000020 757100                    STAQ    16,,PR0
         1 000327   000623 710000 1                  TRA     CONTOPN

      309     5593                    /**/
      310     5594    3         CASE(PASSX);

      311     5595    3            F$DCB.PASSF='0'B;

   5595  1 000330   200003 470500                    LDP0    JDCB$,,AUTO
         1 000331   000005 236000 2                  LDQ     5
         1 000332   000031 356100                    ANSQ    25,,PR0
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:64   

      312     5596    3            F$DCB.PASS=' ';

   5596  1 000333   000035 235000 xsym               LDA     B_VECTNIL+29
         1 000334   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 000335   000022 757100                    STAQ    18,,PR0
         1 000336   000623 710000 1                  TRA     CONTOPN

      313     5597                    /**/
      314     5598    3         CASE(ACCESSX);

      315     5599    3            F$DCB.AMFLG.ACCF='0'B;

   5599  1 000337   200003 470500                    LDP0    JDCB$,,AUTO
         1 000340   000006 236000 2                  LDQ     6
         1 000341   000064 356100                    ANSQ    52,,PR0
         1 000342   000623 710000 1                  TRA     CONTOPN

      316     5600                    /**/
      317     5601    3         CASE(ACSVEHX);

      318     5602    3            F$DCB.AMFLG.ACSF='0'B;

   5602  1 000343   200003 470500                    LDP0    JDCB$,,AUTO
         1 000344   000007 236000 2                  LDQ     7
         1 000345   000064 356100                    ANSQ    52,,PR0
         1 000346   000623 710000 1                  TRA     CONTOPN

      319     5603                    /**/
      320     5604    3         CASE(UATTRX);

      321     5605    3            F$DCB.AMFLG.USRF='0'B;

   5605  1 000347   200003 470500                    LDP0    JDCB$,,AUTO
         1 000350   000010 236000 2                  LDQ     8
         1 000351   000064 356100                    ANSQ    52,,PR0
         1 000352   000623 710000 1                  TRA     CONTOPN
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:65   

      322     5606                    /**/
      323     5607    3         CASE(INSTATTRX);

      324     5608    3            F$DCB.AMFLG.INSF='0'B;

   5608  1 000353   200003 470500                    LDP0    JDCB$,,AUTO
         1 000354   000011 236000 2                  LDQ     9
         1 000355   000064 356100                    ANSQ    52,,PR0
         1 000356   000623 710000 1                  TRA     CONTOPN

      325     5609                    /**/
      326     5610    3         CASE(PROCATTRX);

      327     5611    3            F$DCB.AMFLG.PROF='0'B;

   5611  1 000357   200003 470500                    LDP0    JDCB$,,AUTO
         1 000360   000012 236000 2                  LDQ     10
         1 000361   000064 356100                    ANSQ    52,,PR0
         1 000362   000623 710000 1                  TRA     CONTOPN

      328     5612                    /**/
      329     5613                    /**/
      330     5614    3         CASE(SNX);

      331     5615    3            F$DCB.AMFLG.SNLF='0'B;

   5615  1 000363   200003 470500                    LDP0    JDCB$,,AUTO
         1 000364   000013 236000 2                  LDQ     11
         1 000365   000064 356100                    ANSQ    52,,PR0

      332     5616    3            F$DCB.PSN=' ';

   5616  1 000366   040100 100400                    MLR     fill='040'O
         1 000367   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000370   000024 000006                    ADSC9   20,,PR0                  cn=0,n=6
         1 000371   000623 710000 1                  TRA     CONTOPN
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:66   

      333     5617                    /**/
      334     5618    3         CASE(WSNX);

      335     5619    3            F$DCB.WSN=' ';

   5619  1 000372   200003 470500                    LDP0    JDCB$,,AUTO
         1 000373   000035 235000 xsym               LDA     B_VECTNIL+29
         1 000374   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 000375   000027 755100                    STA     23,,PR0
         1 000376   000030 756100                    STQ     24,,PR0
         1 000377   000623 710000 1                  TRA     CONTOPN

      336     5620                    /**/
      337     5621    3         CASE(TABX);

      338     5622    3            IF F$DCB.TAB$~=ADDR(NIL)

   5622  1 000400   200003 470500                    LDP0    JDCB$,,AUTO
         1 000401   000047 236100                    LDQ     39,,PR0
         1 000402   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000403   000414 600000 1                  TZE     s:5625

      339     5623    3            THEN CALL FSA$FSP(SIZEW(VLP$TAB),F$DCB.TAB$);

   5623  1 000404   200003 236100                    LDQ     JDCB$,,AUTO
         1 000405   000047 036003                    ADLQ    39,DU
         1 000406   000014 235000 2                  LDA     12
         1 000407   200050 757100                    STAQ    I+1,,AUTO
         1 000410   200050 630500                    EPPR0   I+1,,AUTO
         1 000411   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000412   000000 701000 xent               TSX1    FSA$FSP
         1 000413   000000 011000                    NOP     0

      340     5624
      341     5625    4            IF F$DCB.FIELDX>0 THEN DO;

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:67   
   5625  1 000414   200003 470500                    LDP0    JDCB$,,AUTO
         1 000415   000054 720100                    LXL0    44,,PR0
         1 000416   000444 600000 1                  TZE     s:5632

      342     5626    4               FIELD$=PINCRW(B$ROSEG$, F$DCB.FIELDX);

   5626  1 000417   000000 636010                    EAQ     0,X0
         1 000420   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000421   200013 756100                    STQ     FIELD$,,AUTO

      343     5627    4               J=(VLP$RECFIELD.NFIELDS#+1)/2 +1;

   5627  1 000422   200013 471500                    LDP1    FIELD$,,AUTO
         1 000423   100000 236100                    LDQ     0,,PR1
         1 000424   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 000425   000001 036007                    ADLQ    1,DL
         1 000426   000001 772000                    QRL     1
         1 000427   000001 036007                    ADLQ    1,DL
         1 000430   200041 756100                    STQ     J,,AUTO

      344     5628    4               CALL FSA$FSP(J, ALTKEY$);

   5628  1 000431   200007 633500                    EPPR3   ALTKEY$,,AUTO
         1 000432   200051 453500                    STP3    I+2,,AUTO
         1 000433   200041 634500                    EPPR4   J,,AUTO
         1 000434   200050 454500                    STP4    I+1,,AUTO
         1 000435   200050 630500                    EPPR0   I+1,,AUTO
         1 000436   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000437   000000 701000 xent               TSX1    FSA$FSP
         1 000440   000000 011000                    NOP     0

      345     5629    4               F$DCB.FIELDX=0;

   5629  1 000441   000000 220003                    LDX0    0,DU
         1 000442   200003 470500                    LDP0    JDCB$,,AUTO
         1 000443   000054 440100                    SXL0    44,,PR0

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:68   
      346     5630    4               END;

      347     5631
      348     5632    4            IF F$DCB.STARTX > 0 THEN DO;

   5632  1 000444   000057 221100                    LDX1    47,,PR0
         1 000445   000623 600000 1                  TZE     CONTOPN

      349     5633    4               START$ = PINCRW(B$ROSEG$,F$DCB.STARTX);

   5633  1 000446   000000 636011                    EAQ     0,X1
         1 000447   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000450   200014 756100                    STQ     START$,,AUTO

      350     5634    4               J=FM$FIELD_START.NWORDS;

   5634  1 000451   200014 471500                    LDP1    START$,,AUTO
         1 000452   100000 235100                    LDA     0,,PR1
         1 000453   200041 755100                    STA     J,,AUTO

      351     5635    4               CALL FSA$FSP(J, START$);

   5635  1 000454   200014 633500                    EPPR3   START$,,AUTO
         1 000455   200051 453500                    STP3    I+2,,AUTO
         1 000456   200041 634500                    EPPR4   J,,AUTO
         1 000457   200050 454500                    STP4    I+1,,AUTO
         1 000460   200050 630500                    EPPR0   I+1,,AUTO
         1 000461   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000462   000000 701000 xent               TSX1    FSA$FSP
         1 000463   000000 011000                    NOP     0

      352     5636    4               F$DCB.STARTX=0;

   5636  1 000464   000000 220003                    LDX0    0,DU
         1 000465   200003 470500                    LDP0    JDCB$,,AUTO
         1 000466   000057 740100                    STX0    47,,PR0

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:69   
      353     5637    4               END;

   5637  1 000467   000623 710000 1                  TRA     CONTOPN

      354     5638                    /**/
      355     5639    3         CASE(HDRX);

      356     5640    3            IF F$DCB.HEADER$~=ADDR(NIL) THEN

   5640  1 000470   200003 470500                    LDP0    JDCB$,,AUTO
         1 000471   000046 236100                    LDQ     38,,PR0
         1 000472   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000473   000504 600000 1                  TZE     s:5643

      357     5641    3            CALL FSA$FSP(SIZEW(VLP$HDRF),F$DCB.HEADER$);

   5641  1 000474   200003 236100                    LDQ     JDCB$,,AUTO
         1 000475   000046 036003                    ADLQ    38,DU
         1 000476   000016 235000 2                  LDA     14
         1 000477   200050 757100                    STAQ    I+1,,AUTO
         1 000500   200050 630500                    EPPR0   I+1,,AUTO
         1 000501   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000502   000000 701000 xent               TSX1    FSA$FSP
         1 000503   000000 011000                    NOP     0

      358     5642
      359     5643    4            IF F$DCB.IRRECX > 0 THEN DO;

   5643  1 000504   200003 470500                    LDP0    JDCB$,,AUTO
         1 000505   000061 220100                    LDX0    49,,PR0
         1 000506   000623 600000 1                  TZE     CONTOPN

      360     5644    4               IRREC$ = PINCRW(B$ROSEG$,F$DCB.IRRECX);

   5644  1 000507   000000 636010                    EAQ     0,X0
         1 000510   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000511   200015 756100                    STQ     IRREC$,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:70   

      361     5645    4               J = (VLP$IRREC.NFIELDS# +3)/4 +1;

   5645  1 000512   200015 471500                    LDP1    IRREC$,,AUTO
         1 000513   100000 236100                    LDQ     0,,PR1
         1 000514   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 000515   000003 036007                    ADLQ    3,DL
         1 000516   000002 772000                    QRL     2
         1 000517   000001 036007                    ADLQ    1,DL
         1 000520   200041 756100                    STQ     J,,AUTO

      362     5646    4               CALL FSA$FSP(J,IRREC$);

   5646  1 000521   200015 633500                    EPPR3   IRREC$,,AUTO
         1 000522   200051 453500                    STP3    I+2,,AUTO
         1 000523   200041 634500                    EPPR4   J,,AUTO
         1 000524   200050 454500                    STP4    I+1,,AUTO
         1 000525   200050 630500                    EPPR0   I+1,,AUTO
         1 000526   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000527   000000 701000 xent               TSX1    FSA$FSP
         1 000530   000000 011000                    NOP     0

      363     5647    4               F$DCB.IRRECX = 0;

   5647  1 000531   000000 220003                    LDX0    0,DU
         1 000532   200003 470500                    LDP0    JDCB$,,AUTO
         1 000533   000061 740100                    STX0    49,,PR0

      364     5648    4               END;

   5648  1 000534   000623 710000 1                  TRA     CONTOPN

      365     5649                    /**/
      366     5650    3         CASE(ALTKX);

      367     5651    4            IF F$DCB.ALTKEYX~=0 THEN DO;

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:71   
   5651  1 000535   200003 470500                    LDP0    JDCB$,,AUTO
         1 000536   000052 720100                    LXL0    42,,PR0
         1 000537   000562 600000 1                  TZE     s:5657

      368     5652    4               ALTKEY$=PINCRW(B$ROSEG$,F$DCB.ALTKEYX);

   5652  1 000540   000000 636010                    EAQ     0,X0
         1 000541   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000542   200007 756100                    STQ     ALTKEY$,,AUTO

      369     5653    4               J=FITALTKEYS.NUMWRDS;

   5653  1 000543   200007 471500                    LDP1    ALTKEY$,,AUTO
         1 000544   100000 236100                    LDQ     0,,PR1
         1 000545   000033 772000                    QRL     27
         1 000546   200041 756100                    STQ     J,,AUTO

      370     5654    4               CALL FSA$FSP(J,ALTKEY$);

   5654  1 000547   200007 633500                    EPPR3   ALTKEY$,,AUTO
         1 000550   200051 453500                    STP3    I+2,,AUTO
         1 000551   200041 634500                    EPPR4   J,,AUTO
         1 000552   200050 454500                    STP4    I+1,,AUTO
         1 000553   200050 630500                    EPPR0   I+1,,AUTO
         1 000554   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000555   000000 701000 xent               TSX1    FSA$FSP
         1 000556   000000 011000                    NOP     0

      371     5655    4               F$DCB.ALTKEYX=0;

   5655  1 000557   000000 220003                    LDX0    0,DU
         1 000560   200003 470500                    LDP0    JDCB$,,AUTO
         1 000561   000052 440100                    SXL0    42,,PR0

      372     5656    4               END;

      373     5657    4            IF F$DCB.FPRGX~=0 THEN DO;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:72   

   5657  1 000562   000054 221100                    LDX1    44,,PR0
         1 000563   000602 600000 1                  TZE     s:5663

      374     5658    4               ALTKEY$=PINCRW(B$ROSEG$,F$DCB.FPRGX);

   5658  1 000564   000000 636011                    EAQ     0,X1
         1 000565   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000566   200007 756100                    STQ     ALTKEY$,,AUTO

      375     5659    4               CALL FSA$FSP(SIZEW(VLP$FPRG),ALTKEY$);

   5659  1 000567   200007 631500                    EPPR1   ALTKEY$,,AUTO
         1 000570   200051 451500                    STP1    I+2,,AUTO
         1 000571   000020 236000 2                  LDQ     16
         1 000572   200050 756100                    STQ     I+1,,AUTO
         1 000573   200050 630500                    EPPR0   I+1,,AUTO
         1 000574   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000575   000000 701000 xent               TSX1    FSA$FSP
         1 000576   000000 011000                    NOP     0

      376     5660    4               F$DCB.FPRGX=0;

   5660  1 000577   000000 220003                    LDX0    0,DU
         1 000600   200003 470500                    LDP0    JDCB$,,AUTO
         1 000601   000054 740100                    STX0    44,,PR0

      377     5661    4               END;

      378     5662
      379     5663    4            IF F$DCB.KFIELDX>0 THEN DO;

   5663  1 000602   000056 720100                    LXL0    46,,PR0
         1 000603   000623 600000 1                  TZE     CONTOPN

      380     5664    4               KFIELD$=PINCRW(B$ROSEG$, F$DCB.KFIELDX);

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:73   
   5664  1 000604   000000 636010                    EAQ     0,X0
         1 000605   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000606   200010 756100                    STQ     KFIELD$,,AUTO

      381     5665    4               K=KFIELD$->KFIELD.NWORDS;

   5665  1 000607   200010 471500                    LDP1    KFIELD$,,AUTO
         1 000610   100000 235100                    LDA     0,,PR1
         1 000611   200043 755100                    STA     K,,AUTO

      382     5666    4               CALL FSA$FSP(K, KFIELD$);

   5666  1 000612   200010 633500                    EPPR3   KFIELD$,,AUTO
         1 000613   200051 453500                    STP3    I+2,,AUTO
         1 000614   200043 634500                    EPPR4   K,,AUTO
         1 000615   200050 454500                    STP4    I+1,,AUTO
         1 000616   200050 630500                    EPPR0   I+1,,AUTO
         1 000617   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000620   000000 701000 xent               TSX1    FSA$FSP
         1 000621   000000 011000                    NOP     0

      383     5667    4               END;

   5667  1 000622   000623 710000 1                  TRA     CONTOPN

      384     5668    3         CASE(ELSE); /*TREAT OTHERS AS NIL */

      385     5669    3         END;

      386     5670    2   CONTOPN:
      387     5671    2         END;

   5671  1 000623   200040 235100       CONTOPN      LDA     I,,AUTO
         1 000624   000001 035007                    ADLA    1,DL
         1 000625   200040 755100                    STA     I,,AUTO
         1 000626   000022 115007                    CMPA    18,DL
         1 000627   000214 602000 1                  TNC     s:5570
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:74   

      388     5672
      389     5673
      390     5674                    /*
      391     5675                    *  NOW MERGE IN THE OPEN FPT INFORMATION
      392     5676                    */
      393     5677    1      AMRF='0'B;

   5677  1 000630   200042 450100                    STZ     AMRF,,AUTO

      394     5678    1      CALL FMM$MERGE2 ALTRET(ERRORX);

   5678  1 000631   001754 701000 1                  TSX1    FMM$MERGE2
         1 000632   005153 702000 1                  TSX2    ERRORX

      395     5679                    /*
      396     5680                    *  IF THIS IS A 'SETDCB' OPERATION, OPEN IS FINISHED
      397     5681                    */
      398     5682    1      IF NOT PN$(0)->FPT$OPEN_V.SETDCB THEN GOTO MAINSTREAM;

   5682  1 000633   200016 470500                    LDP0    PN$,,AUTO
         1 000634   000000 236100                    LDQ     0,,PR0
         1 000635   100000 316007                    CANQ    32768,DL
         1 000636   000736 600000 1                  TZE     MAINSTREAM

   5682  1 000637                       RETRET       null
      399     5683    1   RETRET:;
      400     5684    2      IF JDCB$~=ADDR(NIL) THEN DO;

   5684  1 000637   200003 236100                    LDQ     JDCB$,,AUTO
         1 000640   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000641   000660 600000 1                  TZE     s:5689

      401     5685    2         IF F$DCB.BFR.BUFX(0)~=0

   5685  1 000642   200003 470500                    LDP0    JDCB$,,AUTO
         1 000643   000115 236100                    LDQ     77,,PR0
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:75   
         1 000644   037000 316003                    CANQ    15872,DU
         1 000645   000652 600000 1                  TZE     s:5687

      402     5686    2         THEN CALL FMD$RELBUF(0);

   5686  1 000646   000021 630400 2                  EPPR0   17
         1 000647   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000650   000000 701000 xent               TSX1    FMD$RELBUF
         1 000651   000000 011000                    NOP     0

      403     5687    2         F$DCB.FCI=F$DCB.FCD;

   5687  1 000652   200003 470500                    LDP0    JDCB$,,AUTO
         1 000653   000031 236100                    LDQ     25,,PR0
         1 000654   000001 736000                    QLS     1
         1 000655   000031 676100                    ERQ     25,,PR0
         1 000656   040000 376007                    ANQ     16384,DL
         1 000657   000031 656100                    ERSQ    25,,PR0

      404     5688    2         END;

      405     5689    1      RETURN;

   5689  1 000660   000000 702200 xent               TSX2  ! X66_ARET

      406     5690        %EJECT;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:76   
      407     5691                    /*F*
      408     5692                    *     NAME:   FMM$DFLOPN
      409     5693                    *     PURPOSE:   PERFORM THE DEFAULT OPEN FOR A DCB.  NO FPT IS
      410     5694                    *                NEEDED, BUT ASSIGN/MERGE INFORMATION MAY BE
      411     5695                    *                OBTAINED IF INDICATED BY THE DCB.
      412     5696                    *
      413     5697                    *     DESCRIPTION:  FMM$DFLOPN IS THE SYSTEM ENTRY FOR OPEN AND
      414     5698                    *                   REQUIRES NO OPEN FPT.  ALL THE NECESSARY OPEN
      415     5699                    *                   PARAMETERS MUST BE PUT IN THE DCB PRIOR TO THE
      416     5700                    *                   CALL AND THE JIT MUST CONTAIN THE DCB POINTER.
      417     5701                    *                FMM$DFLOPNP SETS F$DCB.WSR=1 TO OVERRIDE FM SECURITY.
      418     5702                    *                FMM$DFLOPNSYS ALLOWS OPEN TO M$* WITH F$DCB.WSR>1.
      419     5703                    *
      420     5704                    */
      421     5705                    /*D*
      422     5706                    *     NAME:   FMM$DFLOPN
      423     5707                    *     CALL:   CALL FMM$DFLOPN;
      424     5708                    *         OR CALL FMM$DFLOPNP;
      425     5709                    *         OR CALL FMM$DFLOPNSYS;
      426     5710                    *     INPUT:  B$JIT.DCB$ -> CURRENT DCB
      427     5711                    *     OUTPUT: OPEN DCB WITH INFORMATION MERGED.
      428     5712                    *
      429     5713                    *     DESCRIPTION:  FMM$DFLOPN ENTERS AT THE VERY END OF THE OPEN
      430     5714                    *              MERGE PROCESS AND SETS THE OPEN POINTER ARRAY TO A
      431     5715                    *              SET OF 'NULL' POINTERS.  IF THE AMFLG IN THE CURRENT
      432     5716                    *              DCB INDICATES THAT THE ASSIGN MERGE RECORD MUST BE
      433     5717                    *              OBTAINED FOR THIS DCB, IT IS GOTTEN AND THE PTRS
      434     5718                    *              ARE ADJUSTED TO DESCRIBE THE PROPER AREAS.  FINALLY
      435     5719                    *              THE FUNCTION IS SET 'INPUT' IF DEFAULTED TO THIS POINT,
      436     5720                    *              AND THE SPECIFIC OPEN ROUTINE IS CALLED BASED ON THE
      437     5721                    *              ASSIGNMENT TYPE.
      438     5722                    *
      439     5723                    *                   ANY ERRORS ENCOUNTERED ARE DESCRIBED IN THE
      440     5724                    *              B$JIT.ERR.CODE LOCATION.  NOTE THAT NO ALTRET IS
      441     5725                    *              DEFINED ON THE OPEN PROCEDURE.  THE PMME_EXIT ROUTINE
      442     5726                    *              NORMALLY TAKES CARE OF THE ALTRET TO THE USER, SO
      443     5727                    *              MONITOR CALLS DIRECTLY TO FMM$DFLOPN SHOULD CHECK THE
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:77   
      444     5728                    *              ERR.CODE WORD UPON RETURN FROM THE OPEN ROUTINE.
      445     5729                    *
      446     5730                    */
      447     5731
      448     5732    1   FMM$DFLOPNP: ENTRY;

   5732  1 000661   000000 700200 xent  FMM$DFLOPNP  TSX0  ! X66_AUTO_0
         1 000662   000054 000000                    ZERO    44,0

      449     5733    1      JDCB$=B$JIT.DCB$;

   5733  1 000663   000000 470400 xsym               LDP0    B$JIT$
         1 000664   000232 236100                    LDQ     154,,PR0
         1 000665   200003 756100                    STQ     JDCB$,,AUTO

      450     5734    1      F$DCB.WSR=1;

   5734  1 000666   200003 471500                    LDP1    JDCB$,,AUTO
         1 000667   000001 236003                    LDQ     1,DU
         1 000670   100040 552120                    STBQ    32,'20'O,PR1

      451     5735    1      GOTO DFLOPNC;

   5735  1 000671   000716 710000 1                  TRA     DFLOPNC

      452     5736    1   FMM$DFLOPNSYS: ENTRY;

   5736  1 000672   000000 700200 xent  FMM$DFLOPNS* TSX0  ! X66_AUTO_0
         1 000673   000054 000000                    ZERO    44,0

      453     5737    1      JDCB$=B$JIT.DCB$;

   5737  1 000674   000000 470400 xsym               LDP0    B$JIT$
         1 000675   000232 236100                    LDQ     154,,PR0
         1 000676   200003 756100                    STQ     JDCB$,,AUTO

      454     5738    1      GOTO DFLOPNC;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:78   

   5738  1 000677   000716 710000 1                  TRA     DFLOPNC

      455     5739                    /**/
      456     5740    1   FMM$DFLOPN: ENTRY;

   5740  1 000700   000000 700200 xent  FMM$DFLOPN   TSX0  ! X66_AUTO_0
         1 000701   000054 000000                    ZERO    44,0

      457     5741                    /**/
      458     5742
      459     5743    1      JDCB$=B$JIT.DCB$; /* CURRENT DCB POINTER */

   5743  1 000702   000000 470400 xsym               LDP0    B$JIT$
         1 000703   000232 236100                    LDQ     154,,PR0
         1 000704   200003 756100                    STQ     JDCB$,,AUTO

      460     5744    1      IF JDCB$=DCBADDR(%M$STAR#) AND F$DCB.WSR>1 THEN GOTO FMME$DOMAIN;

   5744  1 000705   000000 471400 2                  LDP1    0
         1 000706   100000 473500                    LDP3    0,,PR1
         1 000707   300001 116100                    CMPQ    1,,PR3
         1 000710   000716 601000 1                  TNZ     DFLOPNC
         1 000711   200003 474500                    LDP4    JDCB$,,AUTO
         1 000712   400040 236100                    LDQ     32,,PR4
         1 000713   000777 376003                    ANQ     511,DU
         1 000714   000002 116003                    CMPQ    2,DU
         1 000715   005133 603000 1                  TRC     FMME$DOMAIN

   5744  1 000716                       DFLOPNC      null
      461     5745                    /*
      462     5746                    *  DEFAULT OPEN OPTIONS ARE 'NO', AND POINTERS ARE 'NULL'.
      463     5747                    */
      464     5748    1   DFLOPNC:;
      465     5749    1      TDCB$=JDCB$;

   5749  1 000716   200003 236100                    LDQ     JDCB$,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:79   
         1 000717   200044 756100                    STQ     TDCB$,,AUTO

      466     5750    1      F$DCB.BFR(0)='0'B;

   5750  1 000720   200003 471500                    LDP1    JDCB$,,AUTO
         1 000721   100115 450100                    STZ     77,,PR1

      467     5751    1      PN$(0)=ADDR(FM_DFLOPN_V);

   5751  1 000722   000022 236000 2                  LDQ     18
         1 000723   200016 756100                    STQ     PN$,,AUTO

      468     5752    2      DO I=1 TO TOPX;

   5752  1 000724   000001 235007                    LDA     1,DL
         1 000725   200040 755100                    STA     I,,AUTO

      469     5753    2         PN$(I)=ADDR(NIL);

   5753  1 000726   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000727   200040 720100                    LXL0    I,,AUTO
         1 000730   200016 756110                    STQ     PN$,X0,AUTO

      470     5754    2         END;

   5754  1 000731   200040 235100                    LDA     I,,AUTO
         1 000732   000001 035007                    ADLA    1,DL
         1 000733   200040 755100                    STA     I,,AUTO
         1 000734   000022 115007                    CMPA    18,DL
         1 000735   000726 602000 1                  TNC     s:5753

      471     5755        %EJECT;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:80   
      472     5756
      473     5757                    /*
      474     5758                    *  EVERYTHING IS MERGED EXCEPT THE FIT INFO AND
      475     5759                    *  SERIAL NO LIST.  GET THE AMR AND MERGE IN THE INFORMATION
      476     5760                    *  WE NEED FROM THERE.
      477     5761                    */
      478     5762    1   MAINSTREAM:
      479     5763    2      IF F$DCB.AMFLG THEN DO;

   5763  1 000736   200003 470500       MAINSTREAM   LDP0    JDCB$,,AUTO
         1 000737   000064 236100                    LDQ     52,,PR0
         1 000740   000770 316003                    CANQ    504,DU
         1 000741   001036 600000 1                  TZE     AMR_LOST

      480     5764    2         IF F$DCB.BFR.BUFX(0)=0

   5764  1 000742   000115 236100                    LDQ     77,,PR0
         1 000743   037000 316003                    CANQ    15872,DU
         1 000744   000755 601000 1                  TNZ     s:5766

      481     5765    2         THEN CALL FMM$GETAMR(TDCB$,BUF$)ALTRET(AMR_LOST);

   5765  1 000745   200005 631500                    EPPR1   BUF$,,AUTO
         1 000746   200051 451500                    STP1    I+2,,AUTO
         1 000747   200044 633500                    EPPR3   TDCB$,,AUTO
         1 000750   200050 453500                    STP3    I+1,,AUTO
         1 000751   200050 630500                    EPPR0   I+1,,AUTO
         1 000752   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000753   000000 701000 xent               TSX1    FMM$GETAMR
         1 000754   001036 702000 1                  TSX2    AMR_LOST

      482     5766    2         IF F$DCB.AMFLG.ACCF

   5766  1 000755   200003 470500                    LDP0    JDCB$,,AUTO
         1 000756   000064 236100                    LDQ     52,,PR0
         1 000757   000400 316003                    CANQ    256,DU
         1 000760   000766 600000 1                  TZE     s:5768
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:81   

      483     5767    2         THEN PN$(ACCESSX)=PINCRW(BUF$,AMRX(ACCESSX));

   5767  1 000761   200005 471500                    LDP1    BUF$,,AUTO
         1 000762   100005 220100                    LDX0    5,,PR1
         1 000763   000000 636010                    EAQ     0,X0
         1 000764   200005 036100                    ADLQ    BUF$,,AUTO
         1 000765   200023 756100                    STQ     PN$+5,,AUTO

      484     5768    2         IF F$DCB.AMFLG.ACSF

   5768  1 000766   000064 236100                    LDQ     52,,PR0
         1 000767   000200 316003                    CANQ    128,DU
         1 000770   000776 600000 1                  TZE     s:5770

      485     5769    2         THEN PN$(ACSVEHX)=PINCRW(BUF$,AMRX(ACSVEHX));

   5769  1 000771   200005 471500                    LDP1    BUF$,,AUTO
         1 000772   100006 220100                    LDX0    6,,PR1
         1 000773   000000 636010                    EAQ     0,X0
         1 000774   200005 036100                    ADLQ    BUF$,,AUTO
         1 000775   200024 756100                    STQ     PN$+6,,AUTO

      486     5770    2         IF F$DCB.AMFLG.USRF

   5770  1 000776   000064 236100                    LDQ     52,,PR0
         1 000777   000040 316003                    CANQ    32,DU
         1 001000   001006 600000 1                  TZE     s:5772

      487     5771    2         THEN PN$(UATTRX)=PINCRW(BUF$,AMRX(UATTRX));

   5771  1 001001   200005 471500                    LDP1    BUF$,,AUTO
         1 001002   100007 220100                    LDX0    7,,PR1
         1 001003   000000 636010                    EAQ     0,X0
         1 001004   200005 036100                    ADLQ    BUF$,,AUTO
         1 001005   200025 756100                    STQ     PN$+7,,AUTO

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:82   
      488     5772    2         IF F$DCB.AMFLG.INSF

   5772  1 001006   000064 236100                    LDQ     52,,PR0
         1 001007   000100 316003                    CANQ    64,DU
         1 001010   001016 600000 1                  TZE     s:5774

      489     5773    2         THEN PN$(INSTATTRX)=PINCRW(BUF$,AMRX(INSTATTRX));

   5773  1 001011   200005 471500                    LDP1    BUF$,,AUTO
         1 001012   100010 220100                    LDX0    8,,PR1
         1 001013   000000 636010                    EAQ     0,X0
         1 001014   200005 036100                    ADLQ    BUF$,,AUTO
         1 001015   200026 756100                    STQ     PN$+8,,AUTO

      490     5774    2         IF F$DCB.AMFLG.PROF

   5774  1 001016   000064 236100                    LDQ     52,,PR0
         1 001017   000010 316003                    CANQ    8,DU
         1 001020   001026 600000 1                  TZE     s:5776

      491     5775    2         THEN PN$(PROCATTRX)=PINCRW(BUF$,AMRX(PROCATTRX));

   5775  1 001021   200005 471500                    LDP1    BUF$,,AUTO
         1 001022   100011 220100                    LDX0    9,,PR1
         1 001023   000000 636010                    EAQ     0,X0
         1 001024   200005 036100                    ADLQ    BUF$,,AUTO
         1 001025   200027 756100                    STQ     PN$+9,,AUTO

      492     5776    2         IF F$DCB.AMFLG.SNLF

   5776  1 001026   000064 236100                    LDQ     52,,PR0
         1 001027   000020 316003                    CANQ    16,DU
         1 001030   001036 600000 1                  TZE     AMR_LOST

      493     5777    2         THEN PN$(SNX)=PINCRW(BUF$,AMRX(SNX));

   5777  1 001031   200005 471500                    LDP1    BUF$,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:83   
         1 001032   100001 220100                    LDX0    1,,PR1
         1 001033   000000 636010                    EAQ     0,X0
         1 001034   200005 036100                    ADLQ    BUF$,,AUTO
         1 001035   200017 756100                    STQ     PN$+1,,AUTO

      494     5778    2         END;

   5777  1 001036                       AMR_LOST     null
      495     5779    1   AMR_LOST:;
      496     5780        %EJECT;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:84   
      497     5781                    /*
      498     5782                    *  SET GLOBAL DEFAULTS AND ZERO DCB FLAGS
      499     5783                    */
      500     5784    1      IF NOT PN$(0)->FPT$OPEN_V.OPER.NXTA

   5784  1 001036   200016 470500                    LDP0    PN$,,AUTO
         1 001037   000000 236100                    LDQ     0,,PR0
         1 001040   010000 316007                    CANQ    4096,DL
         1 001041   001060 601000 1                  TNZ     s:5790
         1 001042   200003 471500                    LDP1    JDCB$,,AUTO
         1 001043   100020 237100                    LDAQ    16,,PR1
         1 001044   000024 117000 2                  CMPAQ   20
         1 001045   001060 601000 1                  TNZ     s:5790

      501     5785    1        AND F$DCB.ACCT=' '
      502     5786    2      THEN DO;

      503     5787    2         F$DCB.ACCT=B$JIT.FACCN;

   5787  1 001046   000000 473400 xsym               LDP3    B$JIT$
         1 001047   300006 237100                    LDAQ    6,,PR3
         1 001050   100020 757100                    STAQ    16,,PR1

      504     5788    2         IF F$DCB.PSN=' ' THEN F$DCB.PSN=B$JIT.FPSN;

   5788  1 001051   040000 106500                    CMPC    fill='040'O
         1 001052   100024 000006                    ADSC9   20,,PR1                  cn=0,n=6
         1 001053   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 001054   001060 601000 1                  TNZ     s:5790

   5788  1 001055   040100 100500                    MLR     fill='040'O
         1 001056   300021 000006                    ADSC9   17,,PR3                  cn=0,n=6
         1 001057   100024 000006                    ADSC9   20,,PR1                  cn=0,n=6

      505     5789    2         END;

      506     5790    1      IF F$DCB.FUN=0 OR F$DCB.FUN>3 THEN F$DCB.FUN=FUN(F$DCB.ASN);
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:85   

   5790  1 001060   200003 471500                    LDP1    JDCB$,,AUTO
         1 001061   100032 236100                    LDQ     26,,PR1
         1 001062   000777 316003                    CANQ    511,DU
         1 001063   001070 600000 1                  TZE     s:5790+8
         1 001064   100032 236100                    LDQ     26,,PR1
         1 001065   000777 376003                    ANQ     511,DU
         1 001066   000004 116003                    CMPQ    4,DU
         1 001067   001076 602000 1                  TNC     s:5791

   5790  1 001070   100032 236100                    LDQ     26,,PR1
         1 001071   000011 772000                    QRL     9
         1 001072   000777 376007                    ANQ     511,DL
         1 001073   000046 236006 0                  LDQ     FUN,QL
         1 001074   000022 736000                    QLS     18
         1 001075   100032 552120                    STBQ    26,'20'O,PR1

      507     5791    1      IF F$DCB.ACS=%BLOCK# AND NOT B$JIT.PRIV.ACTIVE&%PR_FMBLK#

   5791  1 001076   100036 236100                    LDQ     30,,PR1
         1 001077   000777 376007                    ANQ     511,DL
         1 001100   000003 116007                    CMPQ    3,DL
         1 001101   001117 601000 1                  TNZ     s:5794
         1 001102   000000 473400 xsym               LDP3    B$JIT$
         1 001103   300013 236100                    LDQ     11,,PR3
         1 001104   000053 376000 0                  ANQ     FUN+5
         1 001105   001117 601000 1                  TNZ     s:5794
         1 001106   100032 236100                    LDQ     26,,PR1
         1 001107   000777 376003                    ANQ     511,DU
         1 001110   000002 116003                    CMPQ    2,DU
         1 001111   001115 601000 1                  TNZ     s:5793
         1 001112   300013 236100                    LDQ     11,,PR3
         1 001113   000054 376000 0                  ANQ     FUN+6
         1 001114   001117 601000 1                  TNZ     s:5794

      508     5792    1        AND (F$DCB.FUN~=%IN# OR NOT B$JIT.PRIV.ACTIVE&%PR_FMSEC#)
      509     5793    1      THEN F$DCB.ACS=%SEQUEN#;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:86   

   5793  1 001115   000001 236007                    LDQ     1,DL
         1 001116   100036 552104                    STBQ    30,'04'O,PR1

      510     5794    2      IF NOT F$DCB.PASSF AND F$DCB.PASS~=' ' THEN DO;

   5794  1 001117   100031 236100                    LDQ     25,,PR1
         1 001120   400000 316007                    CANQ    -131072,DL
         1 001121   001137 601000 1                  TNZ     s:5798
         1 001122   100022 237100                    LDAQ    18,,PR1
         1 001123   000024 117000 2                  CMPAQ   20
         1 001124   001137 600000 1                  TZE     s:5798

      511     5795    2         CALL FMM$SCRAMBLE(F$DCB.PASS);

   5795  1 001125   200003 236100                    LDQ     JDCB$,,AUTO
         1 001126   000022 036003                    ADLQ    18,DU
         1 001127   200050 756100                    STQ     I+1,,AUTO
         1 001130   200050 630500                    EPPR0   I+1,,AUTO
         1 001131   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001132   000000 701000 xent               TSX1    FMM$SCRAMBLE
         1 001133   000000 011000                    NOP     0

      512     5796    2         F$DCB.PASSF='1'B;

   5796  1 001134   200003 470500                    LDP0    JDCB$,,AUTO
         1 001135   400000 236007                    LDQ     -131072,DL
         1 001136   000031 256100                    ORSQ    25,,PR0

      513     5797    2         END;

      514     5798    1      AMRF=F$DCB.AMFLG;

   5798  1 001137   200003 470500                    LDP0    JDCB$,,AUTO
         1 001140   000064 236100                    LDQ     52,,PR0
         1 001141   000011 736000                    QLS     9
         1 001142   770000 376003                    ANQ     -4096,DU
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:87   
         1 001143   200042 756100                    STQ     AMRF,,AUTO

      515     5799    1      F$DCB.TYC(0)=F$DCB.BFR1(0); /* SAVE BUF0, MAYBE ASSMRG REC */

   5799  1 001144   000122 236100                    LDQ     82,,PR0
         1 001145   000001 756100                    STQ     1,,PR0

      516     5800    1      F$DCB.TYC(1)=F$DCB.BFR(0);/* SAVE BUF0, MEBBE ASSIGN MERGE REC*/

   5800  1 001146   000115 236100                    LDQ     77,,PR0
         1 001147   000002 756100                    STQ     2,,PR0

      517     5801    1      K=POFFC(ADDR(F$DCB.DCBNAME),ADDR(F$DCB.FEXT)); /* CLEAR WORK AREA */

   5801  1 001150   200003 236100                    LDQ     JDCB$,,AUTO
         1 001151   000064 036003                    ADLQ    52,DU
         1 001152   000020 772000                    QRL     16
         1 001153   200050 756100                    STQ     I+1,,AUTO
         1 001154   200003 236100                    LDQ     JDCB$,,AUTO
         1 001155   000140 036003                    ADLQ    96,DU
         1 001156   000020 772000                    QRL     16
         1 001157   200050 136100                    SBLQ    I+1,,AUTO
         1 001160   200043 756100                    STQ     K,,AUTO

      518     5802    1      ADDR(F$DCB.FEXT)->MOVEKB='0'B;

   5802  1 001161   000000 620006                    EAX0    0,QL
         1 001162   000140 100400                    MLR     fill='000'O
         1 001163   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 001164   000064 000010                    ADSC9   52,,PR0                  cn=0,n=*X0

      519     5803    1      F$DCB.AGE=B$JIT.CALCNT;

   5803  1 001165   000000 471400 xsym               LDP1    B$JIT$
         1 001166   100267 235100                    LDA     183,,PR1
         1 001167   000114 755100                    STA     76,,PR0

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:88   
      520     5804    1      F$DCB.AMFLG=AMRF;

   5804  1 001170   200042 236100                    LDQ     AMRF,,AUTO
         1 001171   000011 772000                    QRL     9
         1 001172   000064 676100                    ERQ     52,,PR0
         1 001173   000770 376003                    ANQ     504,DU
         1 001174   000064 656100                    ERSQ    52,,PR0

      521     5805    1      F$DCB.BFR1(0)=F$DCB.TYC(0);

   5805  1 001175   000001 236100                    LDQ     1,,PR0
         1 001176   000122 756100                    STQ     82,,PR0

      522     5806    1      F$DCB.BFR(0)=F$DCB.TYC(1);

   5806  1 001177   000002 236100                    LDQ     2,,PR0
         1 001200   000115 756100                    STQ     77,,PR0

      523     5807    1      K=POFFC(ADDR(F$DCB.SETSTA$),ADDR(F$DCB));

   5807  1 001201   200003 236100                    LDQ     JDCB$,,AUTO
         1 001202   000020 772000                    QRL     16
         1 001203   200050 756100                    STQ     I+1,,AUTO
         1 001204   200003 236100                    LDQ     JDCB$,,AUTO
         1 001205   000006 036003                    ADLQ    6,DU
         1 001206   000020 772000                    QRL     16
         1 001207   200050 136100                    SBLQ    I+1,,AUTO
         1 001210   200043 756100                    STQ     K,,AUTO

      524     5808    1      JDCB$->MOVEKC=FMM$SDCB;

   5808  1 001211   000000 620006                    EAX0    0,QL
         1 001212   040140 100400                    MLR     fill='040'O
         1 001213   000000 000144 xsym               ADSC9   FMM$SDCB                 cn=0,n=100
         1 001214   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      525     5809    1      F$DCB.CFU$=ADDR(NIL);
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:89   

   5809  1 001215   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001216   000066 756100                    STQ     54,,PR0

      526     5810    1      F$DCB.IASN=F$DCB.ASN;

   5810  1 001217   000032 236100                    LDQ     26,,PR0
         1 001220   000011 772000                    QRL     9
         1 001221   000103 552104                    STBQ    67,'04'O,PR0

      527     5811    1      AMRF=PN$(0)->FPT$OPEN_V.XONLY; /* Save XONLY so openers can mash PN$(0) */

   5811  1 001222   200016 471500                    LDP1    PN$,,AUTO
         1 001223   100014 236100                    LDQ     12,,PR1
         1 001224   000006 736000                    QLS     6
         1 001225   400000 376003                    ANQ     -131072,DU
         1 001226   200042 756100                    STQ     AMRF,,AUTO

      528     5812                    /*
      529     5813                    *  CALL SPECIFIC OPEN ROUTINES BASED ON ASSIGNMENT TYPE
      530     5814                    */
      531     5815    1      IF F$DCB.ASN~=%DEVICE# AND F$DCB.WSN~=' '

   5815  1 001227   000032 236100                    LDQ     26,,PR0
         1 001230   777000 376007                    ANQ     -512,DL
         1 001231   003000 116007                    CMPQ    1536,DL
         1 001232   001246 600000 1                  TZE     s:5817
         1 001233   040000 106500                    CMPC    fill='040'O
         1 001234   000027 000010                    ADSC9   23,,PR0                  cn=0,n=8
         1 001235   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 001236   001246 600000 1                  TZE     s:5817

      532     5816    1      THEN CALL FMF$REMOTE(PN$);

   5816  1 001237   200016 633500                    EPPR3   PN$,,AUTO
         1 001240   200050 453500                    STP3    I+1,,AUTO
         1 001241   200050 630500                    EPPR0   I+1,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:90   
         1 001242   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001243   000000 701000 xent               TSX1    FMF$REMOTE
         1 001244   000000 011000                    NOP     0
         1 001245   001443 710000 1                  TRA     s:5863

      533     5817    2      ELSE DO CASE(F$DCB.ASN);

   5817  1 001246   000032 236100                    LDQ     26,,PR0
         1 001247   000011 772000                    QRL     9
         1 001250   000777 376007                    ANQ     511,DL
         1 001251   000012 116007                    CMPQ    10,DL
         1 001252   001254 602006 1                  TNC     s:5817+6,QL
         1 001253   001442 710000 1                  TRA     s:5857
         1 001254   001442 710000 1                  TRA     s:5857
         1 001255   001266 710000 1                  TRA     s:5820
         1 001256   001357 710000 1                  TRA     s:5838
         1 001257   001420 710000 1                  TRA     s:5849
         1 001260   001427 710000 1                  TRA     s:5852
         1 001261   001442 710000 1                  TRA     s:5857
         1 001262   001442 710000 1                  TRA     s:5857
         1 001263   001442 710000 1                  TRA     s:5857
         1 001264   001442 710000 1                  TRA     s:5857
         1 001265   001436 710000 1                  TRA     s:5855

      534     5818                    /**/
      535     5819    2      CASE(%FILE#);

      536     5820    2         IF F$DCB.SHARE=0 THEN

   5820  1 001266   000031 236100                    LDQ     25,,PR0
         1 001267   000600 316007                    CANQ    384,DL
         1 001270   001273 601000 1                  TNZ     s:5822

      537     5821    2         F$DCB.SHARE=%NONE#;

   5821  1 001271   000600 236007                    LDQ     384,DL
         1 001272   000031 256100                    ORSQ    25,,PR0
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:91   

      538     5822    2         IF F$DCB.RESNT.TYP='OD'

   5822  1 001273   000026 220100                    LDX0    22,,PR0
         1 001274   000055 100000 0                  CMPX0   FUN+7
         1 001275   001305 601000 1                  TNZ     s:5827

      539     5823                    /* Optical Disc files have DCB.ASN set to FILE and DCB.RES
      540     5824                       set to 'ODnn'.  Then OD open routines set IASN and IFMT
      541     5825                       to OD# and FMTOD#.         */
      542     5826    2         THEN CALL FPO$OPNOD (PN$);

   5826  1 001276   200016 633500                    EPPR3   PN$,,AUTO
         1 001277   200050 453500                    STP3    I+1,,AUTO
         1 001300   200050 630500                    EPPR0   I+1,,AUTO
         1 001301   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001302   000000 701000 xent               TSX1    FPO$OPNOD
         1 001303   000000 011000                    NOP     0
         1 001304   001313 710000 1                  TRA     s:5828

      543     5827    2         ELSE CALL FMN$OPNF (PN$);

   5827  1 001305   200016 633500                    EPPR3   PN$,,AUTO
         1 001306   200050 453500                    STP3    I+1,,AUTO
         1 001307   200050 630500                    EPPR0   I+1,,AUTO
         1 001310   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001311   000000 701000 xent               TSX1    FMN$OPNF
         1 001312   000000 011000                    NOP     0

      544     5828    2         IF F$DCB.ASN=%TAPE# THEN CALL FTO$OPNAT(PN$);

   5828  1 001313   200003 470500                    LDP0    JDCB$,,AUTO
         1 001314   000032 236100                    LDQ     26,,PR0
         1 001315   777000 376007                    ANQ     -512,DL
         1 001316   002000 116007                    CMPQ    1024,DL
         1 001317   001326 601000 1                  TNZ     s:5829

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:92   
   5828  1 001320   200016 631500                    EPPR1   PN$,,AUTO
         1 001321   200050 451500                    STP1    I+1,,AUTO
         1 001322   200050 630500                    EPPR0   I+1,,AUTO
         1 001323   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001324   000000 701000 xent               TSX1    FTO$OPNAT
         1 001325   000000 011000                    NOP     0

      545     5829    2         IF F$DCB.SETSTA$~=ADDR(NIL) AND F$DCB.ORG=%KEYED#

   5829  1 001326   200003 470500                    LDP0    JDCB$,,AUTO
         1 001327   000006 236100                    LDQ     6,,PR0
         1 001330   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001331   001443 600000 1                  TZE     s:5863
         1 001332   000032 236100                    LDQ     26,,PR0
         1 001333   777000 376003                    ANQ     -512,DU
         1 001334   002000 116003                    CMPQ    1024,DU
         1 001335   001443 601000 1                  TNZ     s:5863
         1 001336   200020 236100                    LDQ     PN$+2,,AUTO
         1 001337   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001340   001443 600000 1                  TZE     s:5863

      546     5830    2           AND PN$(ULBLX)~=ADDR(NIL)
      547     5831    3         THEN DO; /* RETURN POINTER TO USER FOR VA */

      548     5832    3            CALL HFF$WRITE1(ULBLX) ALTRET(NOVIRTPTR);

   5832  1 001341   000001 630400 2                  EPPR0   1
         1 001342   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001343   000000 701000 xent               TSX1    HFF$WRITE1
         1 001344   001356 702000 1                  TSX2    NOVIRTPTR

      549     5833    3            PN$(ULBLX)->VLP$VIRTUAL_V.PTR$=F$DCB.SETSTA$->VLP$VIRTUAL_V.PTR$;

   5833  1 001345   200003 470500                    LDP0    JDCB$,,AUTO
         1 001346   000006 471500                    LDP1    6,,PR0
         1 001347   100004 236100                    LDQ     4,,PR1
         1 001350   200020 473500                    LDP3    PN$+2,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:93   
         1 001351   300004 756100                    STQ     4,,PR3

      550     5834    3            PN$(ULBLX)->VLP$VIRTUAL_V.WSQ=F$DCB.SETSTA$->VLP$VIRTUAL_V.WSQ;

   5834  1 001352   000006 471500                    LDP1    6,,PR0
         1 001353   200020 473500                    LDP3    PN$+2,,AUTO
         1 001354   100000 236100                    LDQ     0,,PR1
         1 001355   300000 552120                    STBQ    0,'20'O,PR3

      551     5835    3   NOVIRTPTR: END;

   5835  1 001356   001443 710000 1     NOVIRTPTR    TRA     s:5863

      552     5836                    /**/
      553     5837    2      CASE(%TAPE#);

      554     5838    3         IF F$DCB.ACS=%JRNL# THEN DO;

   5838  1 001357   000036 236100                    LDQ     30,,PR0
         1 001360   000777 376007                    ANQ     511,DL
         1 001361   000004 116007                    CMPQ    4,DL
         1 001362   001411 601000 1                  TNZ     s:5846

      555     5839    3            F$DCB.IXTNSIZE=1;

   5839  1 001363   000001 235007                    LDA     1,DL
         1 001364   000041 755100                    STA     33,,PR0

      556     5840    3            F$DCB.BLKL=4096;

   5840  1 001365   010000 220003                    LDX0    4096,DU
         1 001366   000033 740100                    STX0    27,,PR0

      557     5841    3            F$DCB.IASN=%FILE#;

   5841  1 001367   000001 236007                    LDQ     1,DL
         1 001370   000103 552104                    STBQ    67,'04'O,PR0
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:94   

      558     5842    3            CALL FMN$OPNF(PN$);

   5842  1 001371   200016 633500                    EPPR3   PN$,,AUTO
         1 001372   200050 453500                    STP3    I+1,,AUTO
         1 001373   200050 630500                    EPPR0   I+1,,AUTO
         1 001374   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001375   000000 701000 xent               TSX1    FMN$OPNF
         1 001376   000000 011000                    NOP     0

      559     5843    3            IF B$JIT.ERR OR F$DCB.ASN=%FILE# THEN GOTO RETRET;

   5843  1 001377   000000 470400 xsym               LDP0    B$JIT$
         1 001400   000012 235100                    LDA     10,,PR0
         1 001401   000637 601000 1                  TNZ     RETRET
         1 001402   200003 471500                    LDP1    JDCB$,,AUTO
         1 001403   100032 236100                    LDQ     26,,PR1
         1 001404   777000 376007                    ANQ     -512,DL
         1 001405   001000 116007                    CMPQ    512,DL
         1 001406   000637 600000 1                  TZE     RETRET

      560     5844    3            F$DCB.IASN=%TAPE#;

   5844  1 001407   000002 236007                    LDQ     2,DL
         1 001410   100103 552104                    STBQ    67,'04'O,PR1

      561     5845    3            END;

      562     5846    2         CALL FTO$OPNAT(PN$);

   5846  1 001411   200016 630500                    EPPR0   PN$,,AUTO
         1 001412   200050 450500                    STP0    I+1,,AUTO
         1 001413   200050 630500                    EPPR0   I+1,,AUTO
         1 001414   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001415   000000 701000 xent               TSX1    FTO$OPNAT
         1 001416   000000 011000                    NOP     0
         1 001417   001443 710000 1                  TRA     s:5863
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:95   

      563     5847                    /**/
      564     5848    2      CASE(%DEVICE#);

      565     5849    2         CALL FSN$OPNDEV(PN$);

   5849  1 001420   200016 633500                    EPPR3   PN$,,AUTO
         1 001421   200050 453500                    STP3    I+1,,AUTO
         1 001422   200050 630500                    EPPR0   I+1,,AUTO
         1 001423   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001424   000000 701000 xent               TSX1    FSN$OPNDEV
         1 001425   000000 011000                    NOP     0
         1 001426   001443 710000 1                  TRA     s:5863

      566     5850                    /**/
      567     5851    2      CASE(%COMGROUP#);

      568     5852    2         CALL KCO$OPCG(PN$);

   5852  1 001427   200016 633500                    EPPR3   PN$,,AUTO
         1 001430   200050 453500                    STP3    I+1,,AUTO
         1 001431   200050 630500                    EPPR0   I+1,,AUTO
         1 001432   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001433   000000 701000 xent               TSX1    KCO$OPCG
         1 001434   000000 011000                    NOP     0
         1 001435   001443 710000 1                  TRA     s:5863

      569     5853                    /**/
      570     5854    2      CASE(%FPAP#);

      571     5855    2         CALL NAO$OPN;

   5855  1 001436   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001437   000000 701000 xent               TSX1    NAO$OPN
         1 001440   000000 011000                    NOP     0
         1 001441   001443 710000 1                  TRA     s:5863

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:96   
      572     5856    2      CASE(ELSE); /* ERROR */

      573     5857    2         GOTO ERR3;

   5857  1 001442   005147 710000 1                  TRA     ERR3

      574     5858    2      END;

      575     5859                    /*E*     ERROR: FMM-E$INVASN-E
      576     5860                    *        MESSAGE:ASN in DCB% %DC% is not FILE/TAPE/DEVICE/COMGROUP.
      577     5861                    *        DESCRIPTION: INVALID ASSIGNMENT TYPE.
      578     5862                    */
      579     5863    1      IF AMRF THEN F$DCB.FFLG.EXEC='1'B;

   5863  1 001443   200042 235100                    LDA     AMRF,,AUTO
         1 001444   001450 600000 1                  TZE     s:5864

   5863  1 001445   200003 470500                    LDP0    JDCB$,,AUTO
         1 001446   002000 236003                    LDQ     1024,DU
         1 001447   000004 256100                    ORSQ    4,,PR0

      580     5864    1      F$DCB.TYC='0'B;

   5864  1 001450   200003 470500                    LDP0    JDCB$,,AUTO
         1 001451   000001 450100                    STZ     1,,PR0
         1 001452   000002 450100                    STZ     2,,PR0

      581     5865    1      GOTO RETRET;

   5865  1 001453   000637 710000 1                  TRA     RETRET

      582     5866
      583     5867        %EJECT;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:97   
      584     5868                    /*F*
      585     5869                    *     NAME:    FMM$ASSMRG
      586     5870                    *     PURPOSE: PERFORM THE ASSIGN MERGE FUNCTION AT JOB STEP TIME
      587     5871                    *              FOR ALL THE DCBS DEFINED AT STEP TIME WHICH HAVE
      588     5872                    *              RECORDS IN THE ASSIGN MERGE FILE.
      589     5873                    *
      590     5874                    *     DESCRIPTION:  FMM$ASSMRG IS CALLED BY STEP TO MERGE THE
      591     5875                    *             ASSIGNS FOR ALL DEFINED DCBS.  FMM$ASSMRG ALSO
      592     5876                    *             SETS UP THE DCB.FEXT INDICATORS FOR THOSE DCBS
      593     5877                    *             WHICH HAVE AUTOMATIC FILE EXTENSION.
      594     5878                    *
      595     5879                    */
      596     5880                    /*D*
      597     5881                    *     NAME:    FMM$ASSMRG
      598     5882                    *     CALL:    CALL FMM$ASSMRG;
      599     5883                    *     INPUT:   NONE
      600     5884                    *     OUTPUT:  USER DCBS WITH ASSIGNMENTS MERGED.
      601     5885                    *
      602     5886                    *     DESCRIPTION:  FMM$ASSMRG GETS A FILE MANAGEMENT BUFFER AND
      603     5887                    *              OPENS THE ASSIGN MERGE FILE, THEN LOOPS THROUGH THE
      604     5888                    *              USER'S DCBS AND MERGES THE ASSIGNMENTS FOR EACH ONE
      605     5889                    *              WHICH HAS AN AM RECORD ASSOCIATED WITH IT.  THE
      606     5890                    *              SPECIAL DEFAULT 'SOURCE', 'OVER', AND 'ON' ASSIGNMENTS
      607     5891                    *              ARE CHECKED AND MERGED FROM THE KEYS '#1', '#2',
      608     5892                    *              AND '#3'.  IF THESE AMR ENTRIES ARE NOT FOUND, THE
      609     5893                    *              DCBS REVERT TO THEIR NORMAL RECORDS (KEYED BY DCBNAME)
      610     5894                    *              AND DEFAULT OPLABEL EXTENSION DEFINITIONS.
      611     5895                    *
      612     5896                    */
      613     5897    1   FMM$ASSMRG: ENTRY;

   5897  1 001454   000000 700200 xent  FMM$ASSMRG   TSX0  ! X66_AUTO_0
         1 001455   000054 000000                    ZERO    44,0

      614     5898                    /*
      615     5899                    *  GET A BUFFER FOR THE AMR (ASSOCIATE WITH M$DO DCB)
      616     5900                    */
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:98   
      617     5901    1      TEMP$=B$JIT$->B$JIT.DCB$; /* SAVE CURRENT DCB */

   5901  1 001456   000000 470400 xsym               LDP0    B$JIT$
         1 001457   000232 236100                    LDQ     154,,PR0
         1 001460   200006 756100                    STQ     TEMP$,,AUTO

      618     5902    1      B$JIT.DCB$=DCBADDR(4);

   5902  1 001461   000000 471400 2                  LDP1    0
         1 001462   100000 473500                    LDP3    0,,PR1
         1 001463   300004 236100                    LDQ     4,,PR3
         1 001464   000232 756100                    STQ     154,,PR0

      619     5903    1      CALL FMD$GETBUF(0,1,BUF$);

   5903  1 001465   200005 634500                    EPPR4   BUF$,,AUTO
         1 001466   200052 454500                    STP4    I+3,,AUTO
         1 001467   000026 237000 2                  LDAQ    22
         1 001470   200050 757100                    STAQ    I+1,,AUTO
         1 001471   200050 630500                    EPPR0   I+1,,AUTO
         1 001472   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 001473   000000 701000 xent               TSX1    FMD$GETBUF
         1 001474   000000 011000                    NOP     0

      620     5904                    /*
      621     5905                    *  GET M$STAR DCB PTR AND OPEN TO ASSIGN MERGE FILE
      622     5906                    */
      623     5907    1      B$JIT.DCB$=DCBADDR(1);

   5907  1 001475   000000 470400 2                  LDP0    0
         1 001476   000000 471500                    LDP1    0,,PR0
         1 001477   100001 236100                    LDQ     1,,PR1
         1 001500   000000 473400 xsym               LDP3    B$JIT$
         1 001501   300232 756100                    STQ     154,,PR3

      624     5908    1      CALL FMM$OPNAMR ALTRET(AMRCONT);

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:99   
   5908  1 001502   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001503   000000 701000 xent               TSX1    FMM$OPNAMR
         1 001504   001505 702000 1                  TSX2    AMRCONT

   5907  1 001505                       AMRCONT      null
      625     5909
      626     5910                    /*
      627     5911                    *  NOW LOOP THROUGH THE DCB POINTERS FOR EACH USER DCB
      628     5912                    *  STARTING AT M$DO AND READ THE ASSIGN MERGE RECORD
      629     5913                    *  FOR THAT DCB.  NOTE THAT FOR THE DEFAULT ASSIGNMENTS
      630     5914                    *  WE TRY THE SPECIAL AM RECORD AND IF IT IS NOT FOUND,
      631     5915                    *  THEN WE REVERT TO THE STANDARD AM RECORD FOR THIS DCB.
      632     5916                    *  WHENEVER AN AM RECORD IS FOUND IT IS MERGED INTO THE
      633     5917                    *  CORRESPONDING DCB.
      634     5918                    */
      635     5919    1   AMRCONT:;
      636     5920    1      I=%M$SYSDCBS#;

   5920  1 001505   000004 235007                    LDA     4,DL
         1 001506   200040 755100                    STA     I,,AUTO

      637     5921    2      DO WHILE(I<B$ROSEG$->B$ROSEG.NUMDCBS);

   5921  1 001507   000000 470400 xsym               LDP0    B$ROSEG$
         1 001510   000002 236100                    LDQ     2,,PR0
         1 001511   000022 772000                    QRL     18
         1 001512   200040 116100                    CMPQ    I,,AUTO
         1 001513   001651 602000 1                  TNC     s:5963
         1 001514   001651 600000 1                  TZE     s:5963

      638     5922    2         JDCB$=DCBADDR(I);

   5922  1 001515   000000 470400 2                  LDP0    0
         1 001516   000000 471500                    LDP1    0,,PR0
         1 001517   200040 720100                    LXL0    I,,AUTO
         1 001520   100000 236110                    LDQ     0,X0,PR1
         1 001521   200003 756100                    STQ     JDCB$,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:100  

      639     5923    2         IF JDCB$=ADDR(NIL) THEN GOTO NXTDCB;

   5923  1 001522   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001523   001633 600000 1                  TZE     NXTDCB

      640     5924    2         TDCB$=JDCB$;

   5924  1 001524   200044 756100                    STQ     TDCB$,,AUTO

      641     5925    3         IF F$DCB.DCBNAME.S THEN DO;

   5925  1 001525   200003 473500                    LDP3    JDCB$,,AUTO
         1 001526   300140 236100                    LDQ     96,,PR3
         1 001527   040000 316003                    CANQ    16384,DU
         1 001530   001540 600000 1                  TZE     s:5929

      642     5926    3            CALL FMM$SCRUB1(TDCB$);

   5926  1 001531   200044 634500                    EPPR4   TDCB$,,AUTO
         1 001532   200050 454500                    STP4    I+1,,AUTO
         1 001533   200050 630500                    EPPR0   I+1,,AUTO
         1 001534   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001535   000000 701000 xent               TSX1    FMM$SCRUB1
         1 001536   000000 011000                    NOP     0

      643     5927    3            END;

   5927  1 001537   001562 710000 1                  TRA     s:5947

      644     5928    3         ELSE DO; /* PREVENT SCREECH FROM UNINITED DCBS */

      645     5929    3            F$DCB.FCD='0'B;

   5929  1 001540   000030 236000 2                  LDQ     24
         1 001541   300031 356100                    ANSQ    25,,PR3

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:101  
      646     5930    3            F$DCB.AMFLG='0'B;

   5930  1 001542   000031 236000 2                  LDQ     25
         1 001543   300064 356100                    ANSQ    52,,PR3

      647     5931    3            F$DCB.FORM$=ADDR(NIL);

   5931  1 001544   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001545   300050 756100                    STQ     40,,PR3

      648     5932    3            F$DCB.TAB$=ADDR(NIL);

   5932  1 001546   300047 756100                    STQ     39,,PR3

      649     5933    3            F$DCB.HEADER$=ADDR(NIL);

   5933  1 001547   300046 756100                    STQ     38,,PR3

      650     5934    3            F$DCB.LASTSTA$=ADDR(NIL);

   5934  1 001550   300007 756100                    STQ     7,,PR3

      651     5935    3            F$DCB.SETSTA$=ADDR(NIL);

   5935  1 001551   300006 756100                    STQ     6,,PR3

      652     5936    3            F$DCB.ALTKEYX=0;

   5936  1 001552   000000 220003                    LDX0    0,DU
         1 001553   300052 440100                    SXL0    42,,PR3

      653     5937    3            F$DCB.FPRGX=0;

   5937  1 001554   300054 740100                    STX0    44,,PR3

      654     5938    3            F$DCB.FIELDX=0;

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:102  
   5938  1 001555   300054 440100                    SXL0    44,,PR3

      655     5939    3            F$DCB.KFIELDX=0;

   5939  1 001556   300056 440100                    SXL0    46,,PR3

      656     5940    3            F$DCB.STARTX=0;

   5940  1 001557   300057 740100                    STX0    47,,PR3

      657     5941    3            F$DCB.IRRECX=0;

   5941  1 001560   300061 740100                    STX0    49,,PR3

      658     5942    3            F$DCB.CODE16$=ADDR(NIL);

   5942  1 001561   300053 756100                    STQ     43,,PR3

      659     5943    3            END;

      660     5944                    /*
      661     5945                    *  GET FEXTX FOR THE #1, #2, AND #3 DEFAULT ASSIGNMENTS
      662     5946                    */
      663     5947    2         F$DCB.FEXTX=F$DCB.DCBNAME.X;

   5947  1 001562   200003 470500                    LDP0    JDCB$,,AUTO
         1 001563   000140 236100                    LDQ     96,,PR0
         1 001564   700000 376003                    ANQ     -32768,DU
         1 001565   000030 772000                    QRL     24
         1 001566   000034 552110                    STBQ    28,'10'O,PR0

      664     5948    2         FPT$=ADDR(F$DCB.DCBNAME);

   5948  1 001567   200003 236100                    LDQ     JDCB$,,AUTO
         1 001570   000140 036003                    ADLQ    96,DU
         1 001571   200004 756100                    STQ     FPT$,,AUTO

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:103  
      665     5949    3         IF NAME.S='004115044'O THEN DO J=5 TO F_NUMOPS; /* M$XX */

   5949  1 001572   200004 471500                    LDP1    FPT$,,AUTO
         1 001573   000000 106500                    CMPC    fill='000'O
         1 001574   100000 000003                    ADSC9   0,,PR1                   cn=0,n=3
         1 001575   000056 000003 0                  ADSC9   FUN+8                    cn=0,n=3
         1 001576   001621 601000 1                  TNZ     s:5953

   5949  1 001577   000005 235007                    LDA     5,DL
         1 001600   200041 755100                    STA     J,,AUTO

      666     5950    3            IF F_OPLBL(J)=NAME.OP

   5950  1 001601   200041 235100                    LDA     J,,AUTO
         1 001602   000001 735000                    ALS     1
         1 001603   200004 470500                    LDP0    FPT$,,AUTO
         1 001604   040100 106405                    CMPC    fill='040'O
         1 001605   000000 000002 xsym               ADSC9   F_OPLBL,A                cn=0,n=2
         1 001606   000000 600002                    ADSC9   0,,PR0                   cn=3,n=2
         1 001607   001614 601000 1                  TNZ     s:5952

      667     5951    3            THEN F$DCB.FEXTX=J;

   5951  1 001610   200003 471500                    LDP1    JDCB$,,AUTO
         1 001611   200041 236100                    LDQ     J,,AUTO
         1 001612   000011 736000                    QLS     9
         1 001613   100034 552110                    STBQ    28,'10'O,PR1

      668     5952    3            END;

   5952  1 001614   200041 235100                    LDA     J,,AUTO
         1 001615   000001 035007                    ADLA    1,DL
         1 001616   200041 755100                    STA     J,,AUTO
         1 001617   000021 115007                    CMPA    17,DL
         1 001620   001601 602000 1                  TNC     s:5950

      669     5953    2         CALL FMM$READAMR(TDCB$,BUF$) ALTRET(NXTDCB);
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:104  

   5953  1 001621   200005 630500                    EPPR0   BUF$,,AUTO
         1 001622   200051 450500                    STP0    I+2,,AUTO
         1 001623   200044 631500                    EPPR1   TDCB$,,AUTO
         1 001624   200050 451500                    STP1    I+1,,AUTO
         1 001625   200050 630500                    EPPR0   I+1,,AUTO
         1 001626   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001627   000000 701000 xent               TSX1    FMM$READAMR
         1 001630   001633 702000 1                  TSX2    NXTDCB

      670     5954    2         CALL FMM$MERGE1;

   5954  1 001631   001672 701000 1                  TSX1    FMM$MERGE1
         1 001632   000000 011000                    NOP     0

      671     5955    2   NXTDCB:
      672     5956    2         IF I=%M$SYSDCBS# THEN I=%M$1STDCB#; /* ONLY M$DO <10 */

   5956  1 001633   200040 235100       NXTDCB       LDA     I,,AUTO
         1 001634   000004 115007                    CMPA    4,DL
         1 001635   001641 601000 1                  TNZ     s:5957

   5956  1 001636   000012 236007                    LDQ     10,DL
         1 001637   200040 756100                    STQ     I,,AUTO
         1 001640   001643 710000 1                  TRA     s:5958

      673     5957    2         ELSE I=I+1;

   5957  1 001641   000001 035007                    ADLA    1,DL
         1 001642   200040 755100                    STA     I,,AUTO

      674     5958    2         END;

   5958  1 001643   000000 470400 xsym               LDP0    B$ROSEG$
         1 001644   000002 236100                    LDQ     2,,PR0
         1 001645   000022 772000                    QRL     18
         1 001646   200040 116100                    CMPQ    I,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:105  
         1 001647   001651 600000 1                  TZE     s:5963
         1 001650   001515 603000 1                  TRC     s:5922

      675     5959                    /*
      676     5960                    *  CLEAN UP AND RETURN
      677     5961                    */
      678     5962
      679     5963    1      CALL FMP$CLSTAR;

   5963  1 001651   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001652   000000 701000 xent               TSX1    FMP$CLSTAR
         1 001653   000000 011000                    NOP     0

      680     5964    1      B$JIT.DCB$=DCBADDR(4);

   5964  1 001654   000000 470400 2                  LDP0    0
         1 001655   000000 471500                    LDP1    0,,PR0
         1 001656   100004 236100                    LDQ     4,,PR1
         1 001657   000000 473400 xsym               LDP3    B$JIT$
         1 001660   300232 756100                    STQ     154,,PR3

      681     5965    1      B$JIT.ERR='0'B;

   5965  1 001661   300012 450100                    STZ     10,,PR3

      682     5966    1      CALL FMD$RELBUF(0);

   5966  1 001662   000021 630400 2                  EPPR0   17
         1 001663   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001664   000000 701000 xent               TSX1    FMD$RELBUF
         1 001665   000000 011000                    NOP     0

      683     5967    1      B$JIT$->B$JIT.DCB$=TEMP$;

   5967  1 001666   200006 236100                    LDQ     TEMP$,,AUTO
         1 001667   000000 470400 xsym               LDP0    B$JIT$
         1 001670   000232 756100                    STQ     154,,PR0
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:106  

      684     5968
      685     5969    1      RETURN;

   5969  1 001671   000000 702200 xent               TSX2  ! X66_ARET

      686     5970
      687     5971
      688     5972        %EJECT;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:107  
      689     5973                    /*I*
      690     5974                    *     NAME:  FMM$MERGE1
      691     5975                    *     PURPOSE:  MERGE THE ASSIGN MERGE RECORD INFORMATION INTO
      692     5976                    *               THE DCB.
      693     5977                    *
      694     5978                    *     DESCRIPTION:  FMM$MERGE1 SETS UP THE OPEN POINTERS TO THE
      695     5979                    *             SPECIFIED AREAS WITHIN AN ASSIGN MERGE RECORD,
      696     5980                    *             SETS THE 'AMRF' FLAG AND THEN FALLS INTO FMM$MERGE2.
      697     5981                    *
      698     5982                    */
      699     5983    1   FMM$MERGE1: PROC ALTRET;

   5983  1 001672   200046 741300       FMM$MERGE1   STX1  ! TDCB$+2,,AUTO

      700     5984    2   DCL I UBIN;
      701     5985
      702     5986                    /*
      703     5987                    *  GET THE POINTERS PN$(0 THRU 15) INITIALIZED TO THE
      704     5988                    *  SPECIFIED AREAS WITHIN THE ASSIGN MERGE RECORD.
      705     5989                    */
      706     5990    2      IF AMRX(0)=0 THEN RETURN;

   5990  1 001673   200005 470500                    LDP0    BUF$,,AUTO
         1 001674   000000 220100                    LDX0    0,,PR0
         1 001675   001677 601000 1                  TNZ     s:5991

   5990  1 001676   000001 702211                    TSX2  ! 1,X1

      707     5991    3      DO J=0 TO TOPX;

   5991  1 001677   200041 450100                    STZ     J,,AUTO

      708     5992    3         IF AMRX(J)=0 THEN PN$(J)=ADDR(NIL);

   5992  1 001700   200005 470500                    LDP0    BUF$,,AUTO
         1 001701   200041 720100                    LXL0    J,,AUTO
         1 001702   000000 221110                    LDX1    0,X0,PR0
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:108  
         1 001703   001707 601000 1                  TNZ     s:5993

   5992  1 001704   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001705   200016 756110                    STQ     PN$,X0,AUTO
         1 001706   001712 710000 1                  TRA     s:5994

      709     5993    3         ELSE PN$(J)=PINCRW(BUF$,AMRX(J));

   5993  1 001707   000000 636011                    EAQ     0,X1
         1 001710   200005 036100                    ADLQ    BUF$,,AUTO
         1 001711   200016 756110                    STQ     PN$,X0,AUTO

      710     5994    3         END;

   5994  1 001712   200041 235100                    LDA     J,,AUTO
         1 001713   000001 035007                    ADLA    1,DL
         1 001714   200041 755100                    STA     J,,AUTO
         1 001715   000022 115007                    CMPA    18,DL
         1 001716   001700 602000 1                  TNC     s:5992

      711     5995    2      AMRF='1'B;

   5995  1 001717   400000 236003                    LDQ     -131072,DU
         1 001720   200042 756100                    STQ     AMRF,,AUTO

      712     5996    2      IF PN$(0)->FPT$OPEN_V.INITZ.SCRUB THEN CALL FMM$SCRUB(TDCB$);

   5996  1 001721   200016 470500                    LDP0    PN$,,AUTO
         1 001722   000000 236100                    LDQ     0,,PR0
         1 001723   400000 316007                    CANQ    -131072,DL
         1 001724   001733 600000 1                  TZE     s:5997

   5996  1 001725   200044 631500                    EPPR1   TDCB$,,AUTO
         1 001726   200050 451500                    STP1    I+1,,AUTO
         1 001727   200050 630500                    EPPR0   I+1,,AUTO
         1 001730   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001731   000000 701000 xent               TSX1    FMM$SCRUB
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:109  
         1 001732   000000 011000                    NOP     0

      713     5997    2      F$DCB.AMR='1'B;

   5997  1 001733   200003 470500                    LDP0    JDCB$,,AUTO
         1 001734   010000 236007                    LDQ     4096,DL
         1 001735   000031 256100                    ORSQ    25,,PR0

      714     5998    3      IF SUBSTR(F$DCB.DCBNAME.N,0,2)='F$' THEN DO;

   5998  1 001736   000140 236100                    LDQ     96,,PR0
         1 001737   000033 772000                    QRL     27
         1 001740   000037 376007                    ANQ     31,DL
         1 001741   040000 106500                    CMPC    fill='040'O
         1 001742   000140 200002                    ADSC9   96,,PR0                  cn=1,n=2
         1 001743   000057 000002 0                  ADSC9   FUN+9                    cn=0,n=2
         1 001744   001753 601000 1                  TNZ     s:6001

      715     5999    3         F$DCB.FUN=0; /* GO BACK TO DEFAULT */

   5999  1 001745   000000 236003                    LDQ     0,DU
         1 001746   000032 552120                    STBQ    26,'20'O,PR0

      716     6000    3         F$DCB.RES='ME';

   6000  1 001747   000060 236000 0                  LDQ     FUN+10
         1 001750   777777 376003                    ANQ     -1,DU
         1 001751   040040 276007                    ORQ     16416,DL
         1 001752   000026 756100                    STQ     22,,PR0

      717     6001    3         END;

   6001  1 001753   001755 710000 1                  TRA     s:6026

      718     6002                    /*I*
      719     6003                    *     NAME:  FMM$MERGE2
      720     6004                    *
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:110  
      721     6005                    *     PURPOSE:  MERGE EITHER THE ASSIGN MERGE RECORD INFORMATION
      722     6006                    *               OR THE OPEN FPT INFORMATION DEPENDING ON
      723     6007                    *               PN$(0 THRU 15).
      724     6008                    *
      725     6009                    *     INPUT:    PN$ POINTER ARRAY DEFINES THE DCB PARAMETERS.
      726     6010                    *               AMRF IS A FLAG THAT INDICATES WHETHER THIS IS
      727     6011                    *                    THE ASSIGN MERGE RECORD OR AN OPEN FPT.
      728     6012                    *               JDCB$ POINTS TO THE CURRENT DCB.
      729     6013                    *
      730     6014                    *     OUTPUT:   A DCB WITH INFORMATION MERGED AND THE AMFLG BITS
      731     6015                    *               SET OR RESET DEPENDING ON WHERE THE PARAMETER
      732     6016                    *               WAS DEFINED.
      733     6017                    *
      734     6018                    *     DESCRIPTION:  FMM$MERGE2 DOES THE ACTUAL MERGE INTO THE DCB
      735     6019                    *             BASED ON WHETHER OR NOT THE ITEM IS SPECIFIED IN
      736     6020                    *             THE OPEN FPT.
      737     6021                    *
      738     6022                    */
      739     6023    2   FMM$MERGE2: ENTRY ALTRET;

   6023  1 001754   200046 741300       FMM$MERGE2   STX1  ! TDCB$+2,,AUTO

      740     6024                    /**/
      741     6025                    /**/
      742     6026    2      FPT$=PN$(0); /* SET THE IMPLICIT FPT POINTER */

   6026  1 001755   200016 236100                    LDQ     PN$,,AUTO
         1 001756   200004 756100                    STQ     FPT$,,AUTO

      743     6027                    /*
      744     6028                    *  SET ASSIGNMENT TYPE AND FUNCTION
      745     6029                    */
      746     6030    2      IF FPT$OPEN_V.ASN~=0

   6030  1 001757   200004 470500                    LDP0    FPT$,,AUTO
         1 001760   000001 236100                    LDQ     1,,PR0
         1 001761   000777 316007                    CANQ    511,DL
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:111  
         1 001762   002017 600000 1                  TZE     s:6039
         1 001763   200003 471500                    LDP1    JDCB$,,AUTO
         1 001764   100032 236100                    LDQ     26,,PR1
         1 001765   000011 772000                    QRL     9
         1 001766   000777 376007                    ANQ     511,DL
         1 001767   200050 756100                    STQ     I+1,,AUTO
         1 001770   000001 236100                    LDQ     1,,PR0
         1 001771   000777 376007                    ANQ     511,DL
         1 001772   200050 116100                    CMPQ    I+1,,AUTO
         1 001773   002017 600000 1                  TZE     s:6039

      747     6031    3        AND FPT$OPEN_V.ASN~=F$DCB.ASN THEN DO;

      748     6032    3         F$DCB.ASN=FPT$OPEN_V.ASN;

   6032  1 001774   000001 236100                    LDQ     1,,PR0
         1 001775   000011 736000                    QLS     9
         1 001776   100032 552110                    STBQ    26,'10'O,PR1

      749     6033    3         F$DCB.RES=' ';

   6033  1 001777   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 002000   100026 756100                    STQ     22,,PR1

      750     6034    4         IF F$DCB.LASTSTA$~=ADDR(NIL) THEN DO;

   6034  1 002001   100007 236100                    LDQ     7,,PR1
         1 002002   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002003   002017 600000 1                  TZE     s:6039

      751     6035    4            CALL FSA$FSP(SIZEW(VLP$STATION)+SIZEW(VLP$SETSTA),F$DCB.LASTSTA$);

   6035  1 002004   200003 236100                    LDQ     JDCB$,,AUTO
         1 002005   000007 036003                    ADLQ    7,DU
         1 002006   000004 235000 2                  LDA     4
         1 002007   200050 757100                    STAQ    I+1,,AUTO
         1 002010   200050 630500                    EPPR0   I+1,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:112  
         1 002011   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002012   000000 701000 xent               TSX1    FSA$FSP
         1 002013   000000 011000                    NOP     0

      752     6036    4            F$DCB.SETSTA$=ADDR(NIL);

   6036  1 002014   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 002015   200003 470500                    LDP0    JDCB$,,AUTO
         1 002016   000006 756100                    STQ     6,,PR0

      753     6037    4            END;

      754     6038    3         END;

      755     6039    2      IF FPT$OPEN_V.FUN~=0 THEN F$DCB.FUN=FPT$OPEN_V.FUN;

   6039  1 002017   200004 470500                    LDP0    FPT$,,AUTO
         1 002020   000001 236100                    LDQ     1,,PR0
         1 002021   777000 316007                    CANQ    -512,DL
         1 002022   002026 600000 1                  TZE     s:6043

   6039  1 002023   200003 471500                    LDP1    JDCB$,,AUTO
         1 002024   000011 736000                    QLS     9
         1 002025   100032 552120                    STBQ    26,'20'O,PR1

      756     6040                    /*
      757     6041                    *    MERGE THE VARIABLE AREA OF THE FPT
      758     6042                    */
      759     6043    2      IF FPT$OPEN_V.ORG~=0 THEN F$DCB.ORG=FPT$OPEN_V.ORG;

   6043  1 002026   000002 236100                    LDQ     2,,PR0
         1 002027   777000 316007                    CANQ    -512,DL
         1 002030   002034 600000 1                  TZE     s:6044

   6043  1 002031   200003 471500                    LDP1    JDCB$,,AUTO
         1 002032   000022 736000                    QLS     18
         1 002033   100032 552140                    STBQ    26,'40'O,PR1
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:113  

      760     6044    2      IF FPT$OPEN_V.ACS~=0 THEN F$DCB.ACS=FPT$OPEN_V.ACS;

   6044  1 002034   000002 236100                    LDQ     2,,PR0
         1 002035   000777 316007                    CANQ    511,DL
         1 002036   002041 600000 1                  TZE     s:6045

   6044  1 002037   200003 471500                    LDP1    JDCB$,,AUTO
         1 002040   100036 552104                    STBQ    30,'04'O,PR1

      761     6045    2      IF FPT$OPEN_V.DISP~=0 THEN F$DCB.DISP=FPT$OPEN_V.DISP;

   6045  1 002041   000005 236100                    LDQ     5,,PR0
         1 002042   000777 316007                    CANQ    511,DL
         1 002043   002046 600000 1                  TZE     s:6046

   6045  1 002044   200003 471500                    LDP1    JDCB$,,AUTO
         1 002045   100032 552104                    STBQ    26,'04'O,PR1

      762     6046    2      IF FPT$OPEN_V.RES~=BINASC(0) THEN

   6046  1 002046   000004 236100                    LDQ     4,,PR0
         1 002047   000032 116000 2                  CMPQ    26
         1 002050   002057 600000 1                  TZE     s:6048

      763     6047    2      CALL XLATE(F$DCB.RES,B$XL_UPPER_UR,FPT$OPEN_V.RES);

   6047  1 002051   000000 471400 xsym               LDP1    B$XL_UPPER_UR$
         1 002052   200003 473500                    LDP3    JDCB$,,AUTO
         1 002053   040100 160500                    MVT     fill='040'O
         1 002054   000004 000004                    ADSC9   4,,PR0                   cn=0,n=4
         1 002055   300026 000004                    ADSC9   22,,PR3                  cn=0,n=4
         1 002056   100000 000100                    ARG     0,,PR1

      764     6048    2      IF FPT$OPEN_V.TYPE~=BINASC(0) THEN F$DCB.TYPE=FPT$OPEN_V.TYPE;

   6048  1 002057   000003 220100                    LDX0    3,,PR0
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:114  
         1 002060   000040 100003                    CMPX0   32,DU
         1 002061   002064 600000 1                  TZE     s:6049

   6048  1 002062   200003 471500                    LDP1    JDCB$,,AUTO
         1 002063   100025 440100                    SXL0    21,,PR1

      765     6049    2      IF FPT$OPEN_V.EXPIRE~=0 THEN F$DCB.EXPIRE=FPT$OPEN_V.EXPIRE;

   6049  1 002064   000013 235100                    LDA     11,,PR0
         1 002065   002070 600000 1                  TZE     s:6050

   6049  1 002066   200003 471500                    LDP1    JDCB$,,AUTO
         1 002067   100035 755100                    STA     29,,PR1

      766     6050    2      IF FPT$OPEN_V.KEYTYPE~= 0 THEN F$DCB.KEYTYPE=FPT$OPEN_V.KEYTYPE;

   6050  1 002070   000015 236100                    LDQ     13,,PR0
         1 002071   000777 316007                    CANQ    511,DL
         1 002072   002076 600000 1                  TZE     s:6054

   6050  1 002073   200003 471500                    LDP1    JDCB$,,AUTO
         1 002074   000022 736000                    QLS     18
         1 002075   100056 552120                    STBQ    46,'20'O,PR1

      767     6051                    /*
      768     6052                    *    TAPE SPECIFIC OPTIONS
      769     6053                    */
      770     6054    2      IF NOT FPT$OPEN_V.BLOCKED&'01'B

   6054  1 002076   000003 236100                    LDQ     3,,PR0
         1 002077   000024 736000                    QLS     20
         1 002100   600000 376003                    ANQ     -65536,DU
         1 002101   200000 376003                    ANQ     65536,DU
         1 002102   002111 601000 1                  TNZ     s:6056

      771     6055    2      THEN F$DCB.BLOCKED=FPT$OPEN_V.BLOCKED;

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:115  
   6055  1 002103   200003 471500                    LDP1    JDCB$,,AUTO
         1 002104   000003 236100                    LDQ     3,,PR0
         1 002105   000014 772000                    QRL     12
         1 002106   100031 676100                    ERQ     25,,PR1
         1 002107   000010 376007                    ANQ     8,DL
         1 002110   100031 656100                    ERSQ    25,,PR1

      772     6056    2      IF NOT FPT$OPEN_V.SPANNED&'01'B

   6056  1 002111   000003 236100                    LDQ     3,,PR0
         1 002112   000026 736000                    QLS     22
         1 002113   600000 376003                    ANQ     -65536,DU
         1 002114   200000 376003                    ANQ     65536,DU
         1 002115   002124 601000 1                  TNZ     s:6058

      773     6057    2      THEN F$DCB.SPANNED=FPT$OPEN_V.SPANNED;

   6057  1 002116   200003 471500                    LDP1    JDCB$,,AUTO
         1 002117   000003 236100                    LDQ     3,,PR0
         1 002120   000013 772000                    QRL     11
         1 002121   100031 676100                    ERQ     25,,PR1
         1 002122   000004 376007                    ANQ     4,DL
         1 002123   100031 656100                    ERSQ    25,,PR1

      774     6058    2      IF NOT FPT$OPEN_V.IOERROK&'01'B THEN

   6058  1 002124   000014 236100                    LDQ     12,,PR0
         1 002125   000007 736000                    QLS     7
         1 002126   600000 376003                    ANQ     -65536,DU
         1 002127   200000 376003                    ANQ     65536,DU
         1 002130   002137 601000 1                  TNZ     s:6060

      775     6059    2      F$DCB.IOERROK=FPT$OPEN_V.IOERROK;

   6059  1 002131   200003 471500                    LDP1    JDCB$,,AUTO
         1 002132   000014 236100                    LDQ     12,,PR0
         1 002133   000003 736000                    QLS     3
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:116  
         1 002134   100031 676100                    ERQ     25,,PR1
         1 002135   020000 376003                    ANQ     8192,DU
         1 002136   100031 656100                    ERSQ    25,,PR1

      776     6060    2      IF NOT FPT$OPEN_V.IGNOREFSN&'01'B THEN

   6060  1 002137   000014 236100                    LDQ     12,,PR0
         1 002140   000025 736000                    QLS     21
         1 002141   600000 376003                    ANQ     -65536,DU
         1 002142   200000 376003                    ANQ     65536,DU
         1 002143   002152 601000 1                  TNZ     s:6062

      777     6061    2      F$DCB.IGNOREFSN=FPT$OPEN_V.IGNOREFSN;

   6061  1 002144   200003 471500                    LDP1    JDCB$,,AUTO
         1 002145   000014 236100                    LDQ     12,,PR0
         1 002146   000025 736000                    QLS     21
         1 002147   100031 676100                    ERQ     25,,PR1
         1 002150   400000 376003                    ANQ     -131072,DU
         1 002151   100031 656100                    ERSQ    25,,PR1

      778     6062    2      IF FPT$OPEN_V.BLKL~=0 THEN F$DCB.BLKL=FPT$OPEN_V.BLKL;

   6062  1 002152   000006 220100                    LDX0    6,,PR0
         1 002153   002156 600000 1                  TZE     s:6063

   6062  1 002154   200003 471500                    LDP1    JDCB$,,AUTO
         1 002155   100033 740100                    STX0    27,,PR1

      779     6063    2      IF FPT$OPEN_V.RECL~=262143 THEN F$DCB.RECL=FPT$OPEN_V.RECL;

   6063  1 002156   000006 720100                    LXL0    6,,PR0
         1 002157   777777 100003                    CMPX0   -1,DU
         1 002160   002163 600000 1                  TZE     s:6064

   6063  1 002161   200003 471500                    LDP1    JDCB$,,AUTO
         1 002162   100033 440100                    SXL0    27,,PR1
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:117  

      780     6064    2      IF FPT$OPEN_V.VOL~=0 THEN F$DCB.VOL=FPT$OPEN_V.VOL;

   6064  1 002163   000015 236100                    LDQ     13,,PR0
         1 002164   777000 316003                    CANQ    -512,DU
         1 002165   002170 600000 1                  TZE     s:6065

   6064  1 002166   200003 471500                    LDP1    JDCB$,,AUTO
         1 002167   100043 552140                    STBQ    35,'40'O,PR1

      781     6065    2      IF FPT$OPEN_V.MAXVOL~=0 THEN F$DCB.MAXVOL=FPT$OPEN_V.MAXVOL;

   6065  1 002170   000015 236100                    LDQ     13,,PR0
         1 002171   000777 316003                    CANQ    511,DU
         1 002172   002175 600000 1                  TZE     s:6066

   6065  1 002173   200003 471500                    LDP1    JDCB$,,AUTO
         1 002174   100043 552120                    STBQ    35,'20'O,PR1

      782     6066    2      IF FPT$OPEN_V.CHAIN~=0 THEN F$DCB.CHAIN=FPT$OPEN_V.CHAIN;

   6066  1 002175   000015 236100                    LDQ     13,,PR0
         1 002176   777000 316007                    CANQ    -512,DL
         1 002177   002202 600000 1                  TZE     s:6067

   6066  1 002200   200003 471500                    LDP1    JDCB$,,AUTO
         1 002201   100043 552110                    STBQ    35,'10'O,PR1

      783     6067    2      IF FPT$OPEN_V.DENSITY~=0 THEN F$DCB.DENSITY=FPT$OPEN_V.DENSITY;

   6067  1 002202   000022 236100                    LDQ     18,,PR0
         1 002203   000777 316007                    CANQ    511,DL
         1 002204   002207 600000 1                  TZE     s:6068

   6067  1 002205   200003 471500                    LDP1    JDCB$,,AUTO
         1 002206   100043 552104                    STBQ    35,'04'O,PR1

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:118  
      784     6068    2      IF FPT$OPEN_V.FSN~=0 THEN F$DCB.FSN=FPT$OPEN_V.FSN;

   6068  1 002207   000022 220100                    LDX0    18,,PR0
         1 002210   002213 600000 1                  TZE     s:6069

   6068  1 002211   200003 471500                    LDP1    JDCB$,,AUTO
         1 002212   100034 740100                    STX0    28,,PR1

      785     6069    2      IF FPT$OPEN_V.VOLACCESS~=0 THEN F$DCB.VOLACCESS=FPT$OPEN_V.VOLACCESS;

   6069  1 002213   000017 236100                    LDQ     15,,PR0
         1 002214   000007 316003                    CANQ    7,DU
         1 002215   002223 600000 1                  TZE     s:6070

   6069  1 002216   200003 471500                    LDP1    JDCB$,,AUTO
         1 002217   000011 736000                    QLS     9
         1 002220   100031 676100                    ERQ     25,,PR1
         1 002221   003000 376003                    ANQ     1536,DU
         1 002222   100031 656100                    ERSQ    25,,PR1

      786     6070    2      IF NOT FPT$OPEN_V.CNVRT&'01'B THEN F$DCB.CNVRT=FPT$OPEN_V.CNVRT;

   6070  1 002223   000014 236100                    LDQ     12,,PR0
         1 002224   000002 736000                    QLS     2
         1 002225   600000 376003                    ANQ     -65536,DU
         1 002226   200000 376003                    ANQ     65536,DU
         1 002227   002236 601000 1                  TNZ     s:6071

   6070  1 002230   200003 471500                    LDP1    JDCB$,,AUTO
         1 002231   000014 236100                    LDQ     12,,PR0
         1 002232   000021 772000                    QRL     17
         1 002233   100031 676100                    ERQ     25,,PR1
         1 002234   200000 376007                    ANQ     65536,DL
         1 002235   100031 656100                    ERSQ    25,,PR1

      787     6071    2      IF NOT FPT$OPEN_V.XTEND&'01'B THEN F$DCB.XTEND=FPT$OPEN_V.XTEND;

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:119  
   6071  1 002236   000014 236100                    LDQ     12,,PR0
         1 002237   000004 736000                    QLS     4
         1 002240   600000 376003                    ANQ     -65536,DU
         1 002241   200000 376003                    ANQ     65536,DU
         1 002242   002251 601000 1                  TNZ     s:6072

   6071  1 002243   200003 471500                    LDP1    JDCB$,,AUTO
         1 002244   000014 236100                    LDQ     12,,PR0
         1 002245   000032 772000                    QRL     26
         1 002246   100031 676100                    ERQ     25,,PR1
         1 002247   000040 376007                    ANQ     32,DL
         1 002250   100031 656100                    ERSQ    25,,PR1

      788     6072    2      IF NOT FPT$OPEN_V.EBCDIC&'01'B THEN F$DCB.EBCDIC=FPT$OPEN_V.EBCDIC;

   6072  1 002251   000014 236100                    LDQ     12,,PR0
         1 002252   600000 376003                    ANQ     -65536,DU
         1 002253   200000 376003                    ANQ     65536,DU
         1 002254   002263 601000 1                  TNZ     s:6073

   6072  1 002255   200003 471500                    LDP1    JDCB$,,AUTO
         1 002256   000014 236100                    LDQ     12,,PR0
         1 002257   000024 772000                    QRL     20
         1 002260   100031 676100                    ERQ     25,,PR1
         1 002261   100000 376007                    ANQ     32768,DL
         1 002262   100031 656100                    ERSQ    25,,PR1

      789     6073    2      IF NOT FPT$OPEN_V.CVOL&'01'B THEN F$DCB.CVOL=FPT$OPEN_V.CVOL;

   6073  1 002263   000000 236100                    LDQ     0,,PR0
         1 002264   000041 736000                    QLS     33
         1 002265   600000 376003                    ANQ     -65536,DU
         1 002266   200000 376003                    ANQ     65536,DU
         1 002267   002276 601000 1                  TNZ     s:6077

   6073  1 002270   200003 471500                    LDP1    JDCB$,,AUTO
         1 002271   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:120  
         1 002272   000002 736000                    QLS     2
         1 002273   100031 676100                    ERQ     25,,PR1
         1 002274   000020 376007                    ANQ     16,DL
         1 002275   100031 656100                    ERSQ    25,,PR1

      790     6074                    /*
      791     6075                    *    FILE SPECIFIC OPTIONS
      792     6076                    */
      793     6077    2      IF FPT$OPEN_V.IXTNSIZE~=0 THEN F$DCB.IXTNSIZE=FPT$OPEN_V.IXTNSIZE;

   6077  1 002276   000011 235100                    LDA     9,,PR0
         1 002277   002302 600000 1                  TZE     s:6078

   6077  1 002300   200003 471500                    LDP1    JDCB$,,AUTO
         1 002301   100041 755100                    STA     33,,PR1

      794     6078    2      IF FPT$OPEN_V.NRECS~=0 THEN F$DCB.NRECS=FPT$OPEN_V.NRECS;

   6078  1 002302   000012 235100                    LDA     10,,PR0
         1 002303   002306 600000 1                  TZE     s:6079

   6078  1 002304   200003 471500                    LDP1    JDCB$,,AUTO
         1 002305   100042 755100                    STA     34,,PR1

      795     6079    2      IF FPT$OPEN_V.XTNSIZE~=0 THEN F$DCB.XTNSIZE=FPT$OPEN_V.XTNSIZE;

   6079  1 002306   000010 720100                    LXL0    8,,PR0
         1 002307   002312 600000 1                  TZE     s:6080

   6079  1 002310   200003 471500                    LDP1    JDCB$,,AUTO
         1 002311   100037 740100                    STX0    31,,PR1

      796     6080    2      IF FPT$OPEN_V.LSLIDE~=0 THEN F$DCB.LSLIDE=FPT$OPEN_V.LSLIDE;

   6080  1 002312   000007 220100                    LDX0    7,,PR0
         1 002313   002320 600000 1                  TZE     s:6081

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:121  
   6080  1 002314   200003 471500                    LDP1    JDCB$,,AUTO
         1 002315   000007 236100                    LDQ     7,,PR0
         1 002316   000011 772000                    QRL     9
         1 002317   100037 552110                    STBQ    31,'10'O,PR1

      797     6081    2      IF FPT$OPEN_V.LRDL0~=0 THEN F$DCB.LRDL0=FPT$OPEN_V.LRDL0;

   6081  1 002320   000007 720100                    LXL0    7,,PR0
         1 002321   002325 600000 1                  TZE     s:6082

   6081  1 002322   200003 471500                    LDP1    JDCB$,,AUTO
         1 002323   000007 236100                    LDQ     7,,PR0
         1 002324   100037 552104                    STBQ    31,'04'O,PR1

      798     6082    2      IF FPT$OPEN_V.SPARE~=0 THEN F$DCB.SPARE=FPT$OPEN_V.SPARE;

   6082  1 002325   000010 220100                    LDX0    8,,PR0
         1 002326   002333 600000 1                  TZE     s:6083

   6082  1 002327   200003 471500                    LDP1    JDCB$,,AUTO
         1 002330   000010 236100                    LDQ     8,,PR0
         1 002331   000011 736000                    QLS     9
         1 002332   100040 552140                    STBQ    32,'40'O,PR1

      799     6083    2      IF FPT$OPEN_V.GHSTACS~=0 THEN F$DCB.GHSTACS=FPT$OPEN_V.GHSTACS;

   6083  1 002333   000003 236100                    LDQ     3,,PR0
         1 002334   000017 316007                    CANQ    15,DL
         1 002335   002343 600000 1                  TZE     s:6084

   6083  1 002336   200003 471500                    LDP1    JDCB$,,AUTO
         1 002337   000022 736000                    QLS     18
         1 002340   100052 676100                    ERQ     42,,PR1
         1 002341   000017 376003                    ANQ     15,DU
         1 002342   100052 656100                    ERSQ    42,,PR1

      800     6084    2      IF NOT FPT$OPEN_V.BUPM&'01'B THEN F$DCB.BUPM=FPT$OPEN_V.BUPM;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:122  

   6084  1 002343   000003 236100                    LDQ     3,,PR0
         1 002344   000030 736000                    QLS     24
         1 002345   600000 376003                    ANQ     -65536,DU
         1 002346   200000 376003                    ANQ     65536,DU
         1 002347   002356 601000 1                  TNZ     s:6085

   6084  1 002350   200003 471500                    LDP1    JDCB$,,AUTO
         1 002351   000003 236100                    LDQ     3,,PR0
         1 002352   000012 772000                    QRL     10
         1 002353   100031 676100                    ERQ     25,,PR1
         1 002354   000003 376007                    ANQ     3,DL
         1 002355   100031 656100                    ERSQ    25,,PR1

      801     6085    2     IF NOT FPT$OPEN_V.ANSISPANSEQ&'01'B THEN F$DCB.ANSISPANSEQ=FPT$OPEN_V.ANSISPANSEQ
              6085               ;

   6085  1 002356   000014 236100                    LDQ     12,,PR0
         1 002357   000030 736000                    QLS     24
         1 002360   600000 376003                    ANQ     -65536,DU
         1 002361   200000 376003                    ANQ     65536,DU
         1 002362   002371 601000 1                  TNZ     s:6086

   6085  1 002363   200003 471500                    LDP1    JDCB$,,AUTO
         1 002364   000014 236100                    LDQ     12,,PR0
         1 002365   000001 736000                    QLS     1
         1 002366   100060 676100                    ERQ     48,,PR1
         1 002367   010000 376007                    ANQ     4096,DL
         1 002370   100060 656100                    ERSQ    48,,PR1

      802     6086    3      IF FPT$OPEN_V.KEYL~=0 THEN DO;

   6086  1 002371   000005 236100                    LDQ     5,,PR0
         1 002372   777000 316007                    CANQ    -512,DL
         1 002373   002400 600000 1                  TZE     s:6090

      803     6087    3         F$DCB.KEYL=FPT$OPEN_V.KEYL;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:123  

   6087  1 002374   200003 471500                    LDP1    JDCB$,,AUTO
         1 002375   100036 552110                    STBQ    30,'10'O,PR1

      804     6088    3         F$DCB.KEYX=FPT$OPEN_V.KEYX;

   6088  1 002376   000005 220100                    LDX0    5,,PR0
         1 002377   100036 740100                    STX0    30,,PR1

      805     6089    3         END;

      806     6090    2      IF FPT$OPEN_V.EXIST~=0 THEN F$DCB.EXIST=FPT$OPEN_V.EXIST;

   6090  1 002400   000000 236100                    LDQ     0,,PR0
         1 002401   000600 316007                    CANQ    384,DL
         1 002402   002410 600000 1                  TZE     s:6091

   6090  1 002403   200003 471500                    LDP1    JDCB$,,AUTO
         1 002404   000002 736000                    QLS     2
         1 002405   100031 676100                    ERQ     25,,PR1
         1 002406   003000 376007                    ANQ     1536,DL
         1 002407   100031 656100                    ERSQ    25,,PR1

      807     6091    2      IF FPT$OPEN_V.SHARE~=0 THEN F$DCB.SHARE=FPT$OPEN_V.SHARE;

   6091  1 002410   000000 236100                    LDQ     0,,PR0
         1 002411   000030 316007                    CANQ    24,DL
         1 002412   002420 600000 1                  TZE     s:6092

   6091  1 002413   200003 471500                    LDP1    JDCB$,,AUTO
         1 002414   000004 736000                    QLS     4
         1 002415   100031 676100                    ERQ     25,,PR1
         1 002416   000600 376007                    ANQ     384,DL
         1 002417   100031 656100                    ERSQ    25,,PR1

      808     6092    2      IF NOT FPT$OPEN_V.CTG&'01'B THEN F$DCB.CTG=FPT$OPEN_V.CTG;

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:124  
   6092  1 002420   000000 236100                    LDQ     0,,PR0
         1 002421   000035 736000                    QLS     29
         1 002422   600000 376003                    ANQ     -65536,DU
         1 002423   200000 376003                    ANQ     65536,DU
         1 002424   002433 601000 1                  TNZ     s:6093

   6092  1 002425   200003 471500                    LDP1    JDCB$,,AUTO
         1 002426   000000 236100                    LDQ     0,,PR0
         1 002427   000005 736000                    QLS     5
         1 002430   100031 676100                    ERQ     25,,PR1
         1 002431   004000 376007                    ANQ     2048,DL
         1 002432   100031 656100                    ERSQ    25,,PR1

      809     6093    2      IF NOT FPT$OPEN_V.COMP&'01'B THEN F$DCB.COMP=FPT$OPEN_V.COMP;

   6093  1 002433   000003 236100                    LDQ     3,,PR0
         1 002434   000022 736000                    QLS     18
         1 002435   600000 376003                    ANQ     -65536,DU
         1 002436   200000 376003                    ANQ     65536,DU
         1 002437   002446 601000 1                  TNZ     s:6094

   6093  1 002440   200003 471500                    LDP1    JDCB$,,AUTO
         1 002441   000003 236100                    LDQ     3,,PR0
         1 002442   000013 772000                    QRL     11
         1 002443   100031 676100                    ERQ     25,,PR1
         1 002444   000100 376007                    ANQ     64,DL
         1 002445   100031 656100                    ERSQ    25,,PR1

      810     6094    2      IF NOT FPT$OPEN_V.LOAD&'01'B THEN F$DCB.LOAD=FPT$OPEN_V.LOAD;

   6094  1 002446   000003 236100                    LDQ     3,,PR0
         1 002447   000032 736000                    QLS     26
         1 002450   600000 376003                    ANQ     -65536,DU
         1 002451   200000 376003                    ANQ     65536,DU
         1 002452   002461 601000 1                  TNZ     s:6095

   6094  1 002453   200003 471500                    LDP1    JDCB$,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:125  
         1 002454   000003 236100                    LDQ     3,,PR0
         1 002455   000027 736000                    QLS     23
         1 002456   100031 676100                    ERQ     25,,PR1
         1 002457   040000 376003                    ANQ     16384,DU
         1 002460   100031 656100                    ERSQ    25,,PR1

      811     6095    2      IF FPT$OPEN_V.SEEDSPECIFIED THEN

   6095  1 002461   000014 236100                    LDQ     12,,PR0
         1 002462   010000 316007                    CANQ    4096,DL
         1 002463   002467 600000 1                  TZE     s:6100

      812     6096    2      F$DCB.SEED=FPT$OPEN_V.SEED;

   6096  1 002464   000023 236100                    LDQ     19,,PR0
         1 002465   200003 471500                    LDP1    JDCB$,,AUTO
         1 002466   100062 756100                    STQ     50,,PR1

      813     6097                    /*
      814     6098                    *    COMGROUP SPECIFIC OPTIONS
      815     6099                    */
      816     6100    2      IF NOT FPT$OPEN_V.AU&'01'B THEN F$DCB.AU=FPT$OPEN_V.AU;

   6100  1 002467   000017 236100                    LDQ     15,,PR0
         1 002470   000013 736000                    QLS     11
         1 002471   600000 376003                    ANQ     -65536,DU
         1 002472   200000 376003                    ANQ     65536,DU
         1 002473   002502 601000 1                  TNZ     s:6101

   6100  1 002474   200003 471500                    LDP1    JDCB$,,AUTO
         1 002475   000017 236100                    LDQ     15,,PR0
         1 002476   000012 736000                    QLS     10
         1 002477   100031 676100                    ERQ     25,,PR1
         1 002500   200000 376003                    ANQ     65536,DU
         1 002501   100031 656100                    ERSQ    25,,PR1

      817     6101    2      IF NOT FPT$OPEN_V.QISS&'01'B THEN F$DCB.QISS=FPT$OPEN_V.QISS;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:126  

   6101  1 002502   000017 236100                    LDQ     15,,PR0
         1 002503   000015 736000                    QLS     13
         1 002504   600000 376003                    ANQ     -65536,DU
         1 002505   200000 376003                    ANQ     65536,DU
         1 002506   002515 601000 1                  TNZ     s:6102

   6101  1 002507   200003 471500                    LDP1    JDCB$,,AUTO
         1 002510   000017 236100                    LDQ     15,,PR0
         1 002511   000013 736000                    QLS     11
         1 002512   100031 676100                    ERQ     25,,PR1
         1 002513   100000 376003                    ANQ     32768,DU
         1 002514   100031 656100                    ERSQ    25,,PR1

      818     6102    2      IF NOT FPT$OPEN_V.LSTAOR&'01'B THEN F$DCB.LSTAOR=FPT$OPEN_V.LSTAOR;

   6102  1 002515   000003 236100                    LDQ     3,,PR0
         1 002516   000034 736000                    QLS     28
         1 002517   600000 376003                    ANQ     -65536,DU
         1 002520   200000 376003                    ANQ     65536,DU
         1 002521   002530 601000 1                  TNZ     s:6103

   6102  1 002522   200003 471500                    LDP1    JDCB$,,AUTO
         1 002523   000003 236100                    LDQ     3,,PR0
         1 002524   000026 736000                    QLS     22
         1 002525   100031 676100                    ERQ     25,,PR1
         1 002526   004000 376003                    ANQ     2048,DU
         1 002527   100031 656100                    ERSQ    25,,PR1

      819     6103    2      IF NOT FPT$OPEN_V.JRNLBYPASS&'01'B

   6103  1 002530   000003 236100                    LDQ     3,,PR0
         1 002531   000036 736000                    QLS     30
         1 002532   600000 376003                    ANQ     -65536,DU
         1 002533   200000 376003                    ANQ     65536,DU
         1 002534   002543 601000 1                  TNZ     s:6108

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:127  
      820     6104    2      THEN F$DCB.JRNLBYPASS=FPT$OPEN_V.JRNLBYPASS;

   6104  1 002535   200003 471500                    LDP1    JDCB$,,AUTO
         1 002536   000003 236100                    LDQ     3,,PR0
         1 002537   000025 736000                    QLS     21
         1 002540   100052 676100                    ERQ     42,,PR1
         1 002541   000400 376003                    ANQ     256,DU
         1 002542   100052 656100                    ERSQ    42,,PR1

      821     6105                    /*
      822     6106                    *    DEVICE SPECIFIC OPTIONS
      823     6107                    */
      824     6108    2      IF FPT$OPEN_V.DVFC~=BINASC(0) THEN F$DCB.DVFC=FPT$OPEN_V.DVFC;

   6108  1 002543   000016 236100                    LDQ     14,,PR0
         1 002544   777000 376007                    ANQ     -512,DL
         1 002545   000000 116003                    CMPQ    0,DU
         1 002546   002552 600000 1                  TZE     s:6109

   6108  1 002547   200003 471500                    LDP1    JDCB$,,AUTO
         1 002550   000016 236100                    LDQ     14,,PR0
         1 002551   100044 552110                    STBQ    36,'10'O,PR1

      825     6109    2      IF FPT$OPEN_V.LINES~=0 THEN F$DCB.LINES=FPT$OPEN_V.LINES;

   6109  1 002552   000017 720100                    LXL0    15,,PR0
         1 002553   002556 600000 1                  TZE     s:6110

   6109  1 002554   200003 471500                    LDP1    JDCB$,,AUTO
         1 002555   100044 740100                    STX0    36,,PR1

      826     6110    2      IF FPT$OPEN_V.EVENT~=0 THEN F$DCB.EVENT=FPT$OPEN_V.EVENT;

   6110  1 002556   000021 235100                    LDA     17,,PR0
         1 002557   002562 600000 1                  TZE     s:6111

   6110  1 002560   200003 471500                    LDP1    JDCB$,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:128  
         1 002561   100055 755100                    STA     45,,PR1

      827     6111    3      IF NOT FPT$OPEN_V.SEQ&'01'B THEN DO;

   6111  1 002562   000017 236100                    LDQ     15,,PR0
         1 002563   000011 736000                    QLS     9
         1 002564   600000 376003                    ANQ     -65536,DU
         1 002565   200000 376003                    ANQ     65536,DU
         1 002566   002604 601000 1                  TNZ     s:6116

      828     6112    3         F$DCB.SEQCOL=FPT$OPEN_V.SEQCOL;

   6112  1 002567   200003 471500                    LDP1    JDCB$,,AUTO
         1 002570   000017 236100                    LDQ     15,,PR0
         1 002571   000033 772000                    QRL     27
         1 002572   100044 676100                    ERQ     36,,PR1
         1 002573   000377 376007                    ANQ     255,DL
         1 002574   100044 656100                    ERSQ    36,,PR1

      829     6113    3         F$DCB.SEQID=FPT$OPEN_V.SEQID;

   6113  1 002575   000020 236100                    LDQ     16,,PR0
         1 002576   100045 756100                    STQ     37,,PR1

      830     6114    3         F$DCB.SEQ=FPT$OPEN_V.SEQ;

   6114  1 002577   000017 236100                    LDQ     15,,PR0
         1 002600   000022 772000                    QRL     18
         1 002601   100044 676100                    ERQ     36,,PR1
         1 002602   000400 376007                    ANQ     256,DL
         1 002603   100044 656100                    ERSQ    36,,PR1

      831     6115    3         END;

      832     6116    3      IF FPT$OPEN_V.COPIES~=0 THEN DO;

   6116  1 002604   000022 236100                    LDQ     18,,PR0
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:129  
         1 002605   777000 316007                    CANQ    -512,DL
         1 002606   002636 600000 1                  TZE     s:6123

      833     6117    4         IF F$DCB.FORM$=ADDR(NIL) THEN DO;

   6117  1 002607   200003 471500                    LDP1    JDCB$,,AUTO
         1 002610   100050 236100                    LDQ     40,,PR1
         1 002611   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002612   002630 601000 1                  TNZ     s:6121

      834     6118    4            CALL FSA$GSP(SIZEW(CODE16),F$DCB.FORM$) ALTRET(ERRORX);

   6118  1 002613   200003 236100                    LDQ     JDCB$,,AUTO
         1 002614   000050 036003                    ADLQ    40,DU
         1 002615   000034 235000 2                  LDA     28
         1 002616   200050 757100                    STAQ    I+1,,AUTO
         1 002617   200050 630500                    EPPR0   I+1,,AUTO
         1 002620   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002621   000000 701000 xent               TSX1    FSA$GSP
         1 002622   004440 702000 1                  TSX2    ERRORX

      835     6119    4            F$DCB.FORM$->CODE16='0'B;

   6119  1 002623   200003 470500                    LDP0    JDCB$,,AUTO
         1 002624   000050 471500                    LDP1    40,,PR0
         1 002625   000100 100400                    MLR     fill='000'O
         1 002626   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 002627   100000 000234                    ADSC9   0,,PR1                   cn=0,n=156

      836     6120    4            END;

      837     6121    3         F$DCB.FORM$->CODE16.COPIES=FPT$OPEN_V.COPIES;

   6121  1 002630   200003 470500                    LDP0    JDCB$,,AUTO
         1 002631   000050 471500                    LDP1    40,,PR0
         1 002632   200004 473500                    LDP3    FPT$,,AUTO
         1 002633   300022 236100                    LDQ     18,,PR3
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:130  
         1 002634   000011 736000                    QLS     9
         1 002635   100007 552120                    STBQ    7,'20'O,PR1

      838     6122    3         END;

      839     6123    3      DO J=0 TO 8;

   6123  1 002636   200041 450100                    STZ     J,,AUTO

      840     6124    3         IF NOT FPT$OPEN_V.UOPT(J)&'01'B THEN F$DCB.UOPT(J)=FPT$OPEN_V.UOPT(J);

   6124  1 002637   200041 235100                    LDA     J,,AUTO
         1 002640   000001 735000                    ALS     1
         1 002641   200004 470500                    LDP0    FPT$,,AUTO
         1 002642   003100 060505                    CSL     bolr='003'O
         1 002643   000002 000002                    BDSC    2,A,PR0                  by=0,bit=0,n=2
         1 002644   200050 000044                    BDSC    I+1,,AUTO                by=0,bit=0,n=36
         1 002645   200050 236100                    LDQ     I+1,,AUTO
         1 002646   200000 376003                    ANQ     65536,DU
         1 002647   002655 601000 1                  TNZ     s:6125

   6124  1 002650   200003 471500                    LDP1    JDCB$,,AUTO
         1 002651   200041 236100                    LDQ     J,,AUTO
         1 002652   003106 060505                    CSL     bolr='003'O
         1 002653   000002 000001                    BDSC    2,A,PR0                  by=0,bit=0,n=1
         1 002654   100031 200001                    BDSC    25,Q,PR1                 by=1,bit=0,n=1

      841     6125    3         END;

   6125  1 002655   200041 235100                    LDA     J,,AUTO
         1 002656   000001 035007                    ADLA    1,DL
         1 002657   200041 755100                    STA     J,,AUTO
         1 002660   000011 115007                    CMPA    9,DL
         1 002661   002637 602000 1                  TNC     s:6124

      842     6126                    /*
      843     6127                    *  NOW MERGE THE PARAMETER AREAS
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:131  
      844     6128                    *  AMRF = '0'B IF SOURCE IS OPEN FPT
      845     6129                    *       = '1'B IF SOURCE IS ASSIGN MERGE RECORD
      846     6130                    */
      847     6131    3      DO J=1 TO TOPX;

   6131  1 002662   000001 236007                    LDQ     1,DL
         1 002663   200041 756100                    STQ     J,,AUTO

      848     6132    3         IF PN$(J)=ADDR(NIL) THEN GOTO NEXTPTR;

   6132  1 002664   200041 720100                    LXL0    J,,AUTO
         1 002665   200016 236110                    LDQ     PN$,X0,AUTO
         1 002666   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002667   004431 600000 1                  TZE     NEXTPTR

      849     6133    3         FPT$=PN$(J);

   6133  1 002670   200004 756100                    STQ     FPT$,,AUTO

      850     6134    4         DO CASE(J);

   6134  1 002671   200041 235100                    LDA     J,,AUTO
         1 002672   000022 115007                    CMPA    18,DL
         1 002673   002675 602005 1                  TNC     s:6134+4,AL
         1 002674   004431 710000 1                  TRA     NEXTPTR
         1 002675   004431 710000 1                  TRA     NEXTPTR
         1 002676   003111 710000 1                  TRA     s:6186
         1 002677   002717 710000 1                  TRA     s:6137
         1 002700   003001 710000 1                  TRA     s:6157
         1 002701   003036 710000 1                  TRA     s:6167
         1 002702   003046 710000 1                  TRA     s:6171
         1 002703   003055 710000 1                  TRA     s:6174
         1 002704   003064 710000 1                  TRA     s:6177
         1 002705   003073 710000 1                  TRA     s:6180
         1 002706   003102 710000 1                  TRA     s:6183
         1 002707   003030 710000 1                  TRA     s:6164
         1 002710   004431 710000 1                  TRA     NEXTPTR
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:132  
         1 002711   004431 710000 1                  TRA     NEXTPTR
         1 002712   003656 710000 1                  TRA     s:6306
         1 002713   003132 710000 1                  TRA     s:6190
         1 002714   003403 710000 1                  TRA     s:6248
         1 002715   003664 710000 1                  TRA     s:6308
         1 002716   003713 710000 1                  TRA     s:6315

      851     6135                    /**/
      852     6136    4         CASE(ULBLX);

      853     6137    4            IF F$DCB.ASN~=%TAPE#

   6137  1 002717   200003 470500                    LDP0    JDCB$,,AUTO
         1 002720   000032 236100                    LDQ     26,,PR0
         1 002721   777000 376007                    ANQ     -512,DL
         1 002722   002000 116007                    CMPQ    1024,DL
         1 002723   004431 600000 1                  TZE     NEXTPTR

      854     6138    5            THEN DO; /* Move SETSTA */

      855     6139    5               IF F$DCB.LASTSTA$=ADDR(NIL) THEN

   6139  1 002724   000007 236100                    LDQ     7,,PR0
         1 002725   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002726   002737 601000 1                  TNZ     s:6142

      856     6140    5               CALL FSA$GSP(SIZEW(VLP$STATION)+SIZEW(VLP$SETSTA),

   6140  1 002727   200003 236100                    LDQ     JDCB$,,AUTO
         1 002730   000007 036003                    ADLQ    7,DU
         1 002731   000004 235000 2                  LDA     4
         1 002732   200050 757100                    STAQ    I+1,,AUTO
         1 002733   200050 630500                    EPPR0   I+1,,AUTO
         1 002734   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002735   000000 701000 xent               TSX1    FSA$GSP
         1 002736   004440 702000 1                  TSX2    ERRORX

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:133  
      857     6141    5                 F$DCB.LASTSTA$) ALTRET(ERRORX);
      858     6142    5               F$DCB.SETSTA$=PINCRW(F$DCB.LASTSTA$,SIZEW(VLP$STATION));

   6142  1 002737   200003 470500                    LDP0    JDCB$,,AUTO
         1 002740   000007 236100                    LDQ     7,,PR0
         1 002741   000010 036003                    ADLQ    8,DU
         1 002742   000006 756100                    STQ     6,,PR0

      859     6143    6               IF NOT AMRF THEN DO;

   6143  1 002743   200042 235100                    LDA     AMRF,,AUTO
         1 002744   002765 601000 1                  TNZ     s:6153

      860     6144    6                  CALL HFF$DSIZ(ULBLX,I);

   6144  1 002745   200047 631500                    EPPR1   I,,AUTO
         1 002746   200051 451500                    STP1    I+2,,AUTO
         1 002747   000001 236000 2                  LDQ     1
         1 002750   200050 756100                    STQ     I+1,,AUTO
         1 002751   200050 630500                    EPPR0   I+1,,AUTO
         1 002752   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002753   000000 701000 xent               TSX1    HFF$DSIZ
         1 002754   000000 011000                    NOP     0

      861     6145    7                  IF SIZEC(VLP$SETSTA)>I THEN DO;

   6145  1 002755   200047 235100                    LDA     I,,AUTO
         1 002756   000060 115007                    CMPA    48,DL
         1 002757   002765 603000 1                  TRC     s:6153

      862     6146    7                     B$JIT.ERR=FMM$E$BADVECT2;

   6146  1 002760   000037 236000 0                  LDQ     FMM$E$BADVECT2
         1 002761   000000 470400 xsym               LDP0    B$JIT$
         1 002762   000012 756100                    STQ     10,,PR0

      863     6147                    /*E*     ERROR: FMM-E$BADVECT2-E
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:134  
      864     6148                    *        MESSAGE:SETSTA VLP for M$OPEN %of %DC% is too small.
      865     6149                    */
      866     6150    7                     ALTRETURN;

   6150  1 002763   200046 221300                    LDX1  ! TDCB$+2,,AUTO
         1 002764   000000 702211                    TSX2  ! 0,X1

      867     6151    7                     END;
      868     6152    6                  END;
      869     6153    5               F$DCB.SETSTA$->VLP$SETSTA=VLP$SETSTA;

   6153  1 002765   200003 470500                    LDP0    JDCB$,,AUTO
         1 002766   000006 471500                    LDP1    6,,PR0
         1 002767   200004 473500                    LDP3    FPT$,,AUTO
         1 002770   000100 100500                    MLR     fill='000'O
         1 002771   300000 000060                    ADSC9   0,,PR3                   cn=0,n=48
         1 002772   100000 000060                    ADSC9   0,,PR1                   cn=0,n=48

      870     6154    5               F$DCB.AMRSETSTA=AMRF;

   6154  1 002773   200042 236100                    LDQ     AMRF,,AUTO
         1 002774   000005 772000                    QRL     5
         1 002775   000031 676100                    ERQ     25,,PR0
         1 002776   010000 376003                    ANQ     4096,DU
         1 002777   000031 656100                    ERSQ    25,,PR0

      871     6155    5               END;

   6155  1 003000   004431 710000 1                  TRA     NEXTPTR

      872     6156    4         CASE(NAMEX);

      873     6157    4            K=0;

   6157  1 003001   200043 450100                    STZ     K,,AUTO

      874     6158    4            FN.L=FPT$->FF.CHARX;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:135  

   6158  1 003002   200004 470500                    LDP0    FPT$,,AUTO
         1 003003   040100 100500                    MLR     fill='040'O
         1 003004   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 003005   200043 600001                    ADSC9   K,,AUTO                  cn=3,n=1

      875     6159    4            F$DCB.NAME.L=K;

   6159  1 003006   200003 471500                    LDP1    JDCB$,,AUTO
         1 003007   200043 236100                    LDQ     K,,AUTO
         1 003010   000033 736000                    QLS     27
         1 003011   100010 552140                    STBQ    8,'40'O,PR1

      876     6160    4            F$DCB.NAME.C=FPT$->FF.RECX;

   6160  1 003012   200043 720100                    LXL0    K,,AUTO
         1 003013   040100 100540                    MLR     fill='040'O
         1 003014   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         1 003015   100010 200037                    ADSC9   8,,PR1                   cn=1,n=31

      877     6161    4            IF NOT AMRF THEN B$JIT.FEXT(F$DCB.FEXTX)='0'B;

   6161  1 003016   200042 235100                    LDA     AMRF,,AUTO
         1 003017   004431 601000 1                  TNZ     NEXTPTR

   6161  1 003020   100034 236100                    LDQ     28,,PR1
         1 003021   000011 772000                    QRL     9
         1 003022   000777 376007                    ANQ     511,DL
         1 003023   000000 473400 xsym               LDP3    B$JIT$
         1 003024   003106 060400                    CSL     bolr='003'O
         1 003025   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         1 003026   300220 000001                    BDSC    144,Q,PR3                by=0,bit=0,n=1
         1 003027   004431 710000 1                  TRA     NEXTPTR

      878     6162                    /**/
      879     6163    4         CASE(ACCTX);

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:136  
      880     6164    4            F$DCB.ACCT=VLP$ACCT.ACCT#;

   6164  1 003030   200004 470500                    LDP0    FPT$,,AUTO
         1 003031   200003 471500                    LDP1    JDCB$,,AUTO
         1 003032   040100 100500                    MLR     fill='040'O
         1 003033   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         1 003034   100020 000010                    ADSC9   16,,PR1                  cn=0,n=8
         1 003035   004431 710000 1                  TRA     NEXTPTR

      881     6165                    /**/
      882     6166    4         CASE(PASSX);

      883     6167    4            F$DCB.PASSF='0'B;

   6167  1 003036   200003 470500                    LDP0    JDCB$,,AUTO
         1 003037   000005 236000 2                  LDQ     5
         1 003040   000031 356100                    ANSQ    25,,PR0

      884     6168    4            F$DCB.PASS=VLP$PASS.PASS#;

   6168  1 003041   200004 471500                    LDP1    FPT$,,AUTO
         1 003042   040100 100500                    MLR     fill='040'O
         1 003043   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         1 003044   000022 000010                    ADSC9   18,,PR0                  cn=0,n=8
         1 003045   004431 710000 1                  TRA     NEXTPTR

      885     6169                    /**/
      886     6170    4         CASE(ACCESSX);

      887     6171    4            F$DCB.AMFLG.ACCF=AMRF;

   6171  1 003046   200003 470500                    LDP0    JDCB$,,AUTO
         1 003047   200042 236100                    LDQ     AMRF,,AUTO
         1 003050   000011 772000                    QRL     9
         1 003051   000064 676100                    ERQ     52,,PR0
         1 003052   000400 376003                    ANQ     256,DU
         1 003053   000064 656100                    ERSQ    52,,PR0
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:137  
         1 003054   004431 710000 1                  TRA     NEXTPTR

      888     6172                    /**/
      889     6173    4         CASE(ACSVEHX);

      890     6174    4            F$DCB.AMFLG.ACSF=AMRF;

   6174  1 003055   200003 470500                    LDP0    JDCB$,,AUTO
         1 003056   200042 236100                    LDQ     AMRF,,AUTO
         1 003057   000012 772000                    QRL     10
         1 003060   000064 676100                    ERQ     52,,PR0
         1 003061   000200 376003                    ANQ     128,DU
         1 003062   000064 656100                    ERSQ    52,,PR0
         1 003063   004431 710000 1                  TRA     NEXTPTR

      891     6175                    /**/
      892     6176    4         CASE(UATTRX);

      893     6177    4            F$DCB.AMFLG.USRF=AMRF;

   6177  1 003064   200003 470500                    LDP0    JDCB$,,AUTO
         1 003065   200042 236100                    LDQ     AMRF,,AUTO
         1 003066   000014 772000                    QRL     12
         1 003067   000064 676100                    ERQ     52,,PR0
         1 003070   000040 376003                    ANQ     32,DU
         1 003071   000064 656100                    ERSQ    52,,PR0
         1 003072   004431 710000 1                  TRA     NEXTPTR

      894     6178                    /**/
      895     6179    4         CASE(INSTATTRX);

      896     6180    4            F$DCB.AMFLG.INSF=AMRF;

   6180  1 003073   200003 470500                    LDP0    JDCB$,,AUTO
         1 003074   200042 236100                    LDQ     AMRF,,AUTO
         1 003075   000013 772000                    QRL     11
         1 003076   000064 676100                    ERQ     52,,PR0
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:138  
         1 003077   000100 376003                    ANQ     64,DU
         1 003100   000064 656100                    ERSQ    52,,PR0
         1 003101   004431 710000 1                  TRA     NEXTPTR

      897     6181                    /**/
      898     6182    4         CASE(PROCATTRX);

      899     6183    4            F$DCB.AMFLG.PROF=AMRF;

   6183  1 003102   200003 470500                    LDP0    JDCB$,,AUTO
         1 003103   200042 236100                    LDQ     AMRF,,AUTO
         1 003104   000016 772000                    QRL     14
         1 003105   000064 676100                    ERQ     52,,PR0
         1 003106   000010 376003                    ANQ     8,DU
         1 003107   000064 656100                    ERSQ    52,,PR0
         1 003110   004431 710000 1                  TRA     NEXTPTR

      900     6184                    /**/
      901     6185    4         CASE(SNX);

      902     6186    4            IF VLP$SN.NUM#~=0 THEN F$DCB.PSN=VLP$SN.SN#(0);

   6186  1 003111   200004 470500                    LDP0    FPT$,,AUTO
         1 003112   000000 235100                    LDA     0,,PR0
         1 003113   003120 600000 1                  TZE     s:6187

   6186  1 003114   200003 471500                    LDP1    JDCB$,,AUTO
         1 003115   040100 100500                    MLR     fill='040'O
         1 003116   000001 000006                    ADSC9   1,,PR0                   cn=0,n=6
         1 003117   100024 000006                    ADSC9   20,,PR1                  cn=0,n=6

      903     6187    4            IF VLP$SN.NUM#>1 THEN F$DCB.AMFLG.SNLF=AMRF;

   6187  1 003120   000000 235100                    LDA     0,,PR0
         1 003121   000001 115007                    CMPA    1,DL
         1 003122   004431 604400 1                  TMOZ    NEXTPTR

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:139  
   6187  1 003123   200003 471500                    LDP1    JDCB$,,AUTO
         1 003124   200042 236100                    LDQ     AMRF,,AUTO
         1 003125   000015 772000                    QRL     13
         1 003126   100064 676100                    ERQ     52,,PR1
         1 003127   000020 376003                    ANQ     16,DU
         1 003130   100064 656100                    ERSQ    52,,PR1
         1 003131   004431 710000 1                  TRA     NEXTPTR

      904     6188                    /**/
      905     6189    4         CASE(TABX);

      906     6190    5            IF F$DCB.FIELDX > 0 THEN DO;

   6190  1 003132   200003 470500                    LDP0    JDCB$,,AUTO
         1 003133   000054 721100                    LXL1    44,,PR0
         1 003134   003162 600000 1                  TZE     s:6197

      907     6191    5               FIELD$=PINCRW(B$ROSEG$, F$DCB.FIELDX);

   6191  1 003135   000000 636011                    EAQ     0,X1
         1 003136   000000 036000 xsym               ADLQ    B$ROSEG$
         1 003137   200013 756100                    STQ     FIELD$,,AUTO

      908     6192    5               K=(VLP$RECFIELD.NFIELDS#+1)/2 + 1;

   6192  1 003140   200013 471500                    LDP1    FIELD$,,AUTO
         1 003141   100000 236100                    LDQ     0,,PR1
         1 003142   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 003143   000001 036007                    ADLQ    1,DL
         1 003144   000001 772000                    QRL     1
         1 003145   000001 036007                    ADLQ    1,DL
         1 003146   200043 756100                    STQ     K,,AUTO

      909     6193    5               CALL FSA$FSP(K, FIELD$);

   6193  1 003147   200013 633500                    EPPR3   FIELD$,,AUTO
         1 003150   200051 453500                    STP3    I+2,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:140  
         1 003151   200043 634500                    EPPR4   K,,AUTO
         1 003152   200050 454500                    STP4    I+1,,AUTO
         1 003153   200050 630500                    EPPR0   I+1,,AUTO
         1 003154   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003155   000000 701000 xent               TSX1    FSA$FSP
         1 003156   000000 011000                    NOP     0

      910     6194    5               F$DCB.FIELDX=0;

   6194  1 003157   000000 220003                    LDX0    0,DU
         1 003160   200003 470500                    LDP0    JDCB$,,AUTO
         1 003161   000054 440100                    SXL0    44,,PR0

      911     6195    5               END;

      912     6196
      913     6197    5            IF F$DCB.STARTX > 0 THEN DO;

   6197  1 003162   000057 220100                    LDX0    47,,PR0
         1 003163   003205 600000 1                  TZE     s:6204

      914     6198    5               START$=PINCRW(B$ROSEG$, F$DCB.STARTX);

   6198  1 003164   000000 636010                    EAQ     0,X0
         1 003165   000000 036000 xsym               ADLQ    B$ROSEG$
         1 003166   200014 756100                    STQ     START$,,AUTO

      915     6199    5               K=FM$FIELD_START.NWORDS;

   6199  1 003167   200014 471500                    LDP1    START$,,AUTO
         1 003170   100000 235100                    LDA     0,,PR1
         1 003171   200043 755100                    STA     K,,AUTO

      916     6200    5               CALL FSA$FSP(K, START$);

   6200  1 003172   200014 633500                    EPPR3   START$,,AUTO
         1 003173   200051 453500                    STP3    I+2,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:141  
         1 003174   200043 634500                    EPPR4   K,,AUTO
         1 003175   200050 454500                    STP4    I+1,,AUTO
         1 003176   200050 630500                    EPPR0   I+1,,AUTO
         1 003177   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003200   000000 701000 xent               TSX1    FSA$FSP
         1 003201   000000 011000                    NOP     0

      917     6201    5               F$DCB.STARTX=0;

   6201  1 003202   000000 220003                    LDX0    0,DU
         1 003203   200003 470500                    LDP0    JDCB$,,AUTO
         1 003204   000057 740100                    STX0    47,,PR0

      918     6202    5               END;

      919     6203
      920     6204    4            IF FPT$->VLP$RECFIELD.VLPID#=511

   6204  1 003205   200004 471500                    LDP1    FPT$,,AUTO
         1 003206   100000 236100                    LDQ     0,,PR1
         1 003207   777000 376003                    ANQ     -512,DU
         1 003210   777000 116003                    CMPQ    -512,DU
         1 003211   003355 601000 1                  TNZ     s:6241

      921     6205    5            THEN DO; /* It's a RECFIELD */

      922     6206    5               IF F$DCB.TAB$~=ADDR(NIL) THEN

   6206  1 003212   000047 236100                    LDQ     39,,PR0
         1 003213   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 003214   003225 600000 1                  TZE     s:6209

      923     6207    5               CALL FSA$FSP(SIZEW(VLP$TAB), F$DCB.TAB$);

   6207  1 003215   200003 236100                    LDQ     JDCB$,,AUTO
         1 003216   000047 036003                    ADLQ    39,DU
         1 003217   000014 235000 2                  LDA     12
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:142  
         1 003220   200050 757100                    STAQ    I+1,,AUTO
         1 003221   200050 630500                    EPPR0   I+1,,AUTO
         1 003222   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003223   000000 701000 xent               TSX1    FSA$FSP
         1 003224   000000 011000                    NOP     0

      924     6208
      925     6209    5               IF (F$DCB.ASN~=%FILE# AND F$DCB.ASN~=%TAPE#) OR

   6209  1 003225   200003 470500                    LDP0    JDCB$,,AUTO
         1 003226   000032 236100                    LDQ     26,,PR0
         1 003227   777000 376007                    ANQ     -512,DL
         1 003230   001000 116007                    CMPQ    512,DL
         1 003231   003234 600000 1                  TZE     s:6209+7
         1 003232   002000 116007                    CMPQ    1024,DL
         1 003233   004431 601000 1                  TNZ     NEXTPTR
         1 003234   000032 236100                    LDQ     26,,PR0
         1 003235   777000 376003                    ANQ     -512,DU
         1 003236   002000 116003                    CMPQ    1024,DU
         1 003237   003250 600000 1                  TZE     s:6214
         1 003240   006000 116003                    CMPQ    3072,DU
         1 003241   003250 600000 1                  TZE     s:6214
         1 003242   015000 116003                    CMPQ    6656,DU
         1 003243   003250 600000 1                  TZE     s:6214
         1 003244   001000 116003                    CMPQ    512,DU
         1 003245   003250 600000 1                  TZE     s:6214
         1 003246   005000 116003                    CMPQ    2560,DU
         1 003247   004431 601000 1                  TNZ     NEXTPTR

      926     6210    5                 (F$DCB.ORG~=%KEYED# AND F$DCB.ORG~=%INDEXED# AND
      927     6211    5                 F$DCB.ORG~=%IREL#  AND F$DCB.ORG~=%CONSEC#  AND
      928     6212    5                 F$DCB.ORG~=%RELATIVE#)
      929     6213    5               THEN GOTO NEXTPTR;
      930     6214    5               IF AMRF THEN

   6214  1 003250   200042 235100                    LDA     AMRF,,AUTO
         1 003251   003261 600000 1                  TZE     s:6217
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:143  

      931     6215    5               I=(FPT$->VLP$RECFIELD.NFIELDS# * 2) + 4;

   6215  1 003252   200004 471500                    LDP1    FPT$,,AUTO
         1 003253   100000 236100                    LDQ     0,,PR1
         1 003254   000001 736000                    QLS     1
         1 003255   000035 376000 2                  ANQ     29
         1 003256   000004 036007                    ADLQ    4,DL
         1 003257   200047 756100                    STQ     I,,AUTO
         1 003260   003311 710000 1                  TRA     s:6229

      932     6216    6               ELSE DO;

      933     6217    6                  CALL HFF$DSIZ(TABX, I);

   6217  1 003261   200047 631500                    EPPR1   I,,AUTO
         1 003262   200051 451500                    STP1    I+2,,AUTO
         1 003263   000037 236000 2                  LDQ     31
         1 003264   200050 756100                    STQ     I+1,,AUTO
         1 003265   200050 630500                    EPPR0   I+1,,AUTO
         1 003266   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003267   000000 701000 xent               TSX1    HFF$DSIZ
         1 003270   000000 011000                    NOP     0

      934     6218    7                  IF I/2-2 < FPT$->VLP$RECFIELD.NFIELDS# THEN DO;

   6218  1 003271   200047 236100                    LDQ     I,,AUTO
         1 003272   000001 772000                    QRL     1
         1 003273   200004 470500                    LDP0    FPT$,,AUTO
         1 003274   200050 756100                    STQ     I+1,,AUTO
         1 003275   000000 236100                    LDQ     0,,PR0
         1 003276   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 003277   200051 756100                    STQ     I+2,,AUTO
         1 003300   200050 236100                    LDQ     I+1,,AUTO
         1 003301   000002 136007                    SBLQ    2,DL
         1 003302   200051 116100                    CMPQ    I+2,,AUTO
         1 003303   003311 605000 1                  TPL     s:6229
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:144  

      935     6219    7                     B$JIT.ERR=FMM$E$BADVECT14;

   6219  1 003304   000040 236000 0                  LDQ     FMM$E$BADVECT14
         1 003305   000000 471400 xsym               LDP1    B$JIT$
         1 003306   100012 756100                    STQ     10,,PR1

      936     6220                    /*E*  ERROR:  FMM-E$BADVECT14-E
      937     6221                          MESSAGE:  RECFIELD VLP for M$OPEN %of %DC% is too small.
      938     6222                          MESSAGE1: In VLP_RECFIELD %for %DC%, the number of array elements
      939     6223                                     is greater than the framed area can contain.
      940     6224                    */
      941     6225    7                     ALTRETURN;

   6225  1 003307   200046 221300                    LDX1  ! TDCB$+2,,AUTO
         1 003310   000000 702211                    TSX2  ! 0,X1

      942     6226    7                     END;
      943     6227    6                  END;
      944     6228
      945     6229    5               K=(I+3)/4;

   6229  1 003311   200047 236100                    LDQ     I,,AUTO
         1 003312   000003 036007                    ADLQ    3,DL
         1 003313   000002 772000                    QRL     2
         1 003314   200043 756100                    STQ     K,,AUTO

      946     6230
      947     6231    5               CALL FSA$GSP(K, FIELD$) ALTRET(ERRORX);

   6231  1 003315   200013 630500                    EPPR0   FIELD$,,AUTO
         1 003316   200051 450500                    STP0    I+2,,AUTO
         1 003317   200043 631500                    EPPR1   K,,AUTO
         1 003320   200050 451500                    STP1    I+1,,AUTO
         1 003321   200050 630500                    EPPR0   I+1,,AUTO
         1 003322   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003323   000000 701000 xent               TSX1    FSA$GSP
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:145  
         1 003324   004440 702000 1                  TSX2    ERRORX

      948     6232    5               K=K*4;

   6232  1 003325   200043 235100                    LDA     K,,AUTO
         1 003326   000002 735000                    ALS     2
         1 003327   200043 755100                    STA     K,,AUTO

      949     6233    5               FIELD$->MOVEKB='0'B;

   6233  1 003330   200013 470500                    LDP0    FIELD$,,AUTO
         1 003331   000000 620005                    EAX0    0,AL
         1 003332   000140 100400                    MLR     fill='000'O
         1 003333   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 003334   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      950     6234    5               FIELD$->MOVEKB=FPT$->MOVEKB;

   6234  1 003335   200004 470500                    LDP0    FPT$,,AUTO
         1 003336   200043 720100                    LXL0    K,,AUTO
         1 003337   200013 471500                    LDP1    FIELD$,,AUTO
         1 003340   000140 100540                    MLR     fill='000'O
         1 003341   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 003342   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

      951     6235    5               F$DCB.FIELDX=POFFW(FIELD$, B$ROSEG$);

   6235  1 003343   000000 235000 xsym               LDA     B$ROSEG$
         1 003344   000022 771000                    ARL     18
         1 003345   200050 755100                    STA     I+1,,AUTO
         1 003346   200013 236100                    LDQ     FIELD$,,AUTO
         1 003347   000022 772000                    QRL     18
         1 003350   200050 136100                    SBLQ    I+1,,AUTO
         1 003351   000000 620006                    EAX0    0,QL
         1 003352   200003 471500                    LDP1    JDCB$,,AUTO
         1 003353   100054 440100                    SXL0    44,,PR1

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:146  
      952     6236                    /* Verify VLP$RECFIELD and fill in START$->FM$FIELD_START
      953     6237                       and F$DCB.STARTX later, so we can give better errors
      954     6238                       and don't have to do it several times.             */
      955     6239    5               END;

   6239  1 003354   004431 710000 1                  TRA     NEXTPTR

      956     6240    5            ELSE DO;

      957     6241    5               IF F$DCB.TAB$=ADDR(NIL)

   6241  1 003355   000047 236100                    LDQ     39,,PR0
         1 003356   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 003357   003370 601000 1                  TNZ     s:6243

      958     6242    5               THEN CALL FSA$GSP(SIZEW(VLP$TAB), F$DCB.TAB$) ALTRET(ERRORX);

   6242  1 003360   200003 236100                    LDQ     JDCB$,,AUTO
         1 003361   000047 036003                    ADLQ    39,DU
         1 003362   000014 235000 2                  LDA     12
         1 003363   200050 757100                    STAQ    I+1,,AUTO
         1 003364   200050 630500                    EPPR0   I+1,,AUTO
         1 003365   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003366   000000 701000 xent               TSX1    FSA$GSP
         1 003367   004440 702000 1                  TSX2    ERRORX

      959     6243    5               K=SIZEC(VLP$TAB);

   6243  1 003370   000040 235007                    LDA     32,DL
         1 003371   200043 755100                    STA     K,,AUTO

      960     6244    5               F$DCB.TAB$->MOVEKC=FPT$->MOVEKC;

   6244  1 003372   200003 470500                    LDP0    JDCB$,,AUTO
         1 003373   000047 471500                    LDP1    39,,PR0
         1 003374   200004 473500                    LDP3    FPT$,,AUTO
         1 003375   000000 620005                    EAX0    0,AL
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:147  
         1 003376   200043 721100                    LXL1    K,,AUTO
         1 003377   040140 100540                    MLR     fill='040'O
         1 003400   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         1 003401   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

      961     6245    5               END;

   6245  1 003402   004431 710000 1                  TRA     NEXTPTR

      962     6246                    /* */
      963     6247    4         CASE(HDRX);

      964     6248    5            IF F$DCB.IRRECX > 0 THEN DO;

   6248  1 003403   200003 470500                    LDP0    JDCB$,,AUTO
         1 003404   000061 221100                    LDX1    49,,PR0
         1 003405   003433 600000 1                  TZE     s:6255

      965     6249    5               IRREC$=PINCRW(B$ROSEG$, F$DCB.IRRECX);

   6249  1 003406   000000 636011                    EAQ     0,X1
         1 003407   000000 036000 xsym               ADLQ    B$ROSEG$
         1 003410   200015 756100                    STQ     IRREC$,,AUTO

      966     6250    5               K=(VLP$IRREC.NFIELDS#+3)/4 + 1;

   6250  1 003411   200015 471500                    LDP1    IRREC$,,AUTO
         1 003412   100000 236100                    LDQ     0,,PR1
         1 003413   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 003414   000003 036007                    ADLQ    3,DL
         1 003415   000002 772000                    QRL     2
         1 003416   000001 036007                    ADLQ    1,DL
         1 003417   200043 756100                    STQ     K,,AUTO

      967     6251    5               CALL FSA$FSP(K, IRREC$);

   6251  1 003420   200015 633500                    EPPR3   IRREC$,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:148  
         1 003421   200051 453500                    STP3    I+2,,AUTO
         1 003422   200043 634500                    EPPR4   K,,AUTO
         1 003423   200050 454500                    STP4    I+1,,AUTO
         1 003424   200050 630500                    EPPR0   I+1,,AUTO
         1 003425   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003426   000000 701000 xent               TSX1    FSA$FSP
         1 003427   000000 011000                    NOP     0

      968     6252    5               F$DCB.IRRECX=0;

   6252  1 003430   000000 220003                    LDX0    0,DU
         1 003431   200003 470500                    LDP0    JDCB$,,AUTO
         1 003432   000061 740100                    STX0    49,,PR0

      969     6253    5               END;

      970     6254
      971     6255    4            IF FPT$->VLP$IRREC.VLPID#=511

   6255  1 003433   200004 471500                    LDP1    FPT$,,AUTO
         1 003434   100000 236100                    LDQ     0,,PR1
         1 003435   777000 376003                    ANQ     -512,DU
         1 003436   777000 116003                    CMPQ    -512,DU
         1 003437   003577 601000 1                  TNZ     s:6284

      972     6256    5            THEN DO; /* It's an IRREC */

      973     6257    5               IF F$DCB.HEADER$ ~= ADDR(NIL) THEN

   6257  1 003440   000046 236100                    LDQ     38,,PR0
         1 003441   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 003442   003453 600000 1                  TZE     s:6260

      974     6258    5               CALL FSA$FSP(SIZEW(VLP$HDRF),F$DCB.HEADER$);

   6258  1 003443   200003 236100                    LDQ     JDCB$,,AUTO
         1 003444   000046 036003                    ADLQ    38,DU
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:149  
         1 003445   000016 235000 2                  LDA     14
         1 003446   200050 757100                    STAQ    I+1,,AUTO
         1 003447   200050 630500                    EPPR0   I+1,,AUTO
         1 003450   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003451   000000 701000 xent               TSX1    FSA$FSP
         1 003452   000000 011000                    NOP     0

      975     6259
      976     6260    5               IF (F$DCB.ASN~=%FILE# AND F$DCB.ASN~=%TAPE#) OR

   6260  1 003453   200003 470500                    LDP0    JDCB$,,AUTO
         1 003454   000032 236100                    LDQ     26,,PR0
         1 003455   777000 376007                    ANQ     -512,DL
         1 003456   001000 116007                    CMPQ    512,DL
         1 003457   003462 600000 1                  TZE     s:6260+7
         1 003460   002000 116007                    CMPQ    1024,DL
         1 003461   004431 601000 1                  TNZ     NEXTPTR
         1 003462   000032 236100                    LDQ     26,,PR0
         1 003463   777000 376003                    ANQ     -512,DU
         1 003464   002000 116003                    CMPQ    1024,DU
         1 003465   003476 600000 1                  TZE     s:6266
         1 003466   006000 116003                    CMPQ    3072,DU
         1 003467   003476 600000 1                  TZE     s:6266
         1 003470   015000 116003                    CMPQ    6656,DU
         1 003471   003476 600000 1                  TZE     s:6266
         1 003472   001000 116003                    CMPQ    512,DU
         1 003473   003476 600000 1                  TZE     s:6266
         1 003474   005000 116003                    CMPQ    2560,DU
         1 003475   004431 601000 1                  TNZ     NEXTPTR

      977     6261    5                 (F$DCB.ORG~=%KEYED# AND F$DCB.ORG~=%INDEXED# AND
      978     6262    5                 F$DCB.ORG~=%IREL#  AND F$DCB.ORG~=%CONSEC#  AND
      979     6263    5                 F$DCB.ORG~=%RELATIVE#)
      980     6264    5               THEN GOTO NEXTPTR;
      981     6265
      982     6266    5               IF AMRF THEN

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:150  
   6266  1 003476   200042 235100                    LDA     AMRF,,AUTO
         1 003477   003506 600000 1                  TZE     s:6269

      983     6267    5               I=FPT$->VLP$IRREC.NFIELDS# + 4;

   6267  1 003500   200004 471500                    LDP1    FPT$,,AUTO
         1 003501   100000 236100                    LDQ     0,,PR1
         1 003502   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 003503   000004 036007                    ADLQ    4,DL
         1 003504   200047 756100                    STQ     I,,AUTO
         1 003505   003533 710000 1                  TRA     s:6276

      984     6268    6               ELSE DO;

      985     6269    6                  CALL HFF$DSIZ(HDRX,I);

   6269  1 003506   200047 631500                    EPPR1   I,,AUTO
         1 003507   200051 451500                    STP1    I+2,,AUTO
         1 003510   000041 236000 2                  LDQ     33
         1 003511   200050 756100                    STQ     I+1,,AUTO
         1 003512   200050 630500                    EPPR0   I+1,,AUTO
         1 003513   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003514   000000 701000 xent               TSX1    HFF$DSIZ
         1 003515   000000 011000                    NOP     0

      986     6270    7                  IF I-4 < FPT$->VLP$IRREC.NFIELDS# THEN DO;

   6270  1 003516   200004 470500                    LDP0    FPT$,,AUTO
         1 003517   000000 236100                    LDQ     0,,PR0
         1 003520   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 003521   200050 756100                    STQ     I+1,,AUTO
         1 003522   200047 236100                    LDQ     I,,AUTO
         1 003523   000004 136007                    SBLQ    4,DL
         1 003524   200050 116100                    CMPQ    I+1,,AUTO
         1 003525   003533 605000 1                  TPL     s:6276

      987     6271    7                     B$JIT.ERR=FMM$E$BADVECT15;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:151  

   6271  1 003526   000041 236000 0                  LDQ     FMM$E$BADVECT15
         1 003527   000000 471400 xsym               LDP1    B$JIT$
         1 003530   100012 756100                    STQ     10,,PR1

      988     6272    7                     ALTRETURN;

   6272  1 003531   200046 221300                    LDX1  ! TDCB$+2,,AUTO
         1 003532   000000 702211                    TSX2  ! 0,X1

      989     6273    7                     END;
      990     6274    6                  END;
      991     6275
      992     6276    5               K=(I+3)/4;

   6276  1 003533   200047 236100                    LDQ     I,,AUTO
         1 003534   000003 036007                    ADLQ    3,DL
         1 003535   000002 772000                    QRL     2
         1 003536   200043 756100                    STQ     K,,AUTO

      993     6277    5               CALL FSA$GSP(K,IRREC$) ALTRET(ERRORX);

   6277  1 003537   200015 630500                    EPPR0   IRREC$,,AUTO
         1 003540   200051 450500                    STP0    I+2,,AUTO
         1 003541   200043 631500                    EPPR1   K,,AUTO
         1 003542   200050 451500                    STP1    I+1,,AUTO
         1 003543   200050 630500                    EPPR0   I+1,,AUTO
         1 003544   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003545   000000 701000 xent               TSX1    FSA$GSP
         1 003546   004440 702000 1                  TSX2    ERRORX

      994     6278    5               K=K*4;

   6278  1 003547   200043 235100                    LDA     K,,AUTO
         1 003550   000002 735000                    ALS     2
         1 003551   200043 755100                    STA     K,,AUTO

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:152  
      995     6279    5               IRREC$->MOVEKB='0'B;

   6279  1 003552   200015 470500                    LDP0    IRREC$,,AUTO
         1 003553   000000 620005                    EAX0    0,AL
         1 003554   000140 100400                    MLR     fill='000'O
         1 003555   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 003556   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      996     6280    5               IRREC$->MOVEKB=FPT$->MOVEKB;

   6280  1 003557   200004 470500                    LDP0    FPT$,,AUTO
         1 003560   200043 720100                    LXL0    K,,AUTO
         1 003561   200015 471500                    LDP1    IRREC$,,AUTO
         1 003562   000140 100540                    MLR     fill='000'O
         1 003563   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 003564   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

      997     6281    5               F$DCB.IRRECX=POFFW(IRREC$,B$ROSEG$);

   6281  1 003565   000000 235000 xsym               LDA     B$ROSEG$
         1 003566   000022 771000                    ARL     18
         1 003567   200050 755100                    STA     I+1,,AUTO
         1 003570   200015 236100                    LDQ     IRREC$,,AUTO
         1 003571   000022 772000                    QRL     18
         1 003572   200050 136100                    SBLQ    I+1,,AUTO
         1 003573   000000 620006                    EAX0    0,QL
         1 003574   200003 471500                    LDP1    JDCB$,,AUTO
         1 003575   100061 740100                    STX0    49,,PR1

      998     6282    5               END;

   6282  1 003576   004431 710000 1                  TRA     NEXTPTR

      999     6283    5            ELSE DO;

     1000     6284    5               IF F$DCB.HEADER$=ADDR(NIL) THEN

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:153  
   6284  1 003577   000046 236100                    LDQ     38,,PR0
         1 003600   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 003601   003612 601000 1                  TNZ     s:6286

     1001     6285    5               CALL FSA$GSP(SIZEW(VLP$HDRF),F$DCB.HEADER$) ALTRET(ERRORX);

   6285  1 003602   200003 236100                    LDQ     JDCB$,,AUTO
         1 003603   000046 036003                    ADLQ    38,DU
         1 003604   000016 235000 2                  LDA     14
         1 003605   200050 757100                    STAQ    I+1,,AUTO
         1 003606   200050 630500                    EPPR0   I+1,,AUTO
         1 003607   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003610   000000 701000 xent               TSX1    FSA$GSP
         1 003611   004440 702000 1                  TSX2    ERRORX

     1002     6286    5               K=1;

   6286  1 003612   000001 235007                    LDA     1,DL
         1 003613   200043 755100                    STA     K,,AUTO

     1003     6287    5               FN.L=ADDR(VLP$HDR.TITL)->MOVEKC;

   6287  1 003614   200004 470500                    LDP0    FPT$,,AUTO
         1 003615   000000 620005                    EAX0    0,AL
         1 003616   040100 100540                    MLR     fill='040'O
         1 003617   000001 000010                    ADSC9   1,,PR0                   cn=0,n=*X0
         1 003620   200043 600001                    ADSC9   K,,AUTO                  cn=3,n=1

     1004     6288    5               K=K+SIZEC(VLP$HDR.CTL)+1;

   6288  1 003621   200043 235100                    LDA     K,,AUTO
         1 003622   000005 035007                    ADLA    5,DL
         1 003623   200043 755100                    STA     K,,AUTO

     1005     6289    6               IF NOT AMRF THEN DO;

   6289  1 003624   200042 236100                    LDQ     AMRF,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:154  
         1 003625   003646 601000 1                  TNZ     s:6302

     1006     6290    6                  CALL HFF$DSIZ(HDRX,I);

   6290  1 003626   200047 631500                    EPPR1   I,,AUTO
         1 003627   200051 451500                    STP1    I+2,,AUTO
         1 003630   000041 236000 2                  LDQ     33
         1 003631   200050 756100                    STQ     I+1,,AUTO
         1 003632   200050 630500                    EPPR0   I+1,,AUTO
         1 003633   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003634   000000 701000 xent               TSX1    HFF$DSIZ
         1 003635   000000 011000                    NOP     0

     1007     6291    7                  IF K>I THEN DO;

   6291  1 003636   200047 236100                    LDQ     I,,AUTO
         1 003637   200043 116100                    CMPQ    K,,AUTO
         1 003640   003646 603000 1                  TRC     s:6302

     1008     6292    7                     B$JIT.ERR=FMM$E$BADVECT15;

   6292  1 003641   000041 236000 0                  LDQ     FMM$E$BADVECT15
         1 003642   000000 470400 xsym               LDP0    B$JIT$
         1 003643   000012 756100                    STQ     10,,PR0

     1009     6293                    /*E*     ERROR: FMM-E$BADVECT15-E
     1010     6294                    *        MESSAGE:HDR or IRREC VLP for M$OPEN %of %DC% is too small.
     1011     6295                             MESSAGE1: If IRREC VLP %for %DC%, the number of array elements
     1012     6296                                       specified is greater than the framed area
     1013     6297                                       can contain.
     1014     6298                    */
     1015     6299    7                     ALTRETURN;

   6299  1 003644   200046 221300                    LDX1  ! TDCB$+2,,AUTO
         1 003645   000000 702211                    TSX2  ! 0,X1

     1016     6300    7                     END;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:155  
     1017     6301    6                  END;
     1018     6302    5               F$DCB.HEADER$->MOVEKC=FPT$->MOVEKC;

   6302  1 003646   200003 470500                    LDP0    JDCB$,,AUTO
         1 003647   000046 471500                    LDP1    38,,PR0
         1 003650   200004 473500                    LDP3    FPT$,,AUTO
         1 003651   200043 720100                    LXL0    K,,AUTO
         1 003652   040140 100540                    MLR     fill='040'O
         1 003653   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         1 003654   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

     1019     6303    5               END;

   6303  1 003655   004431 710000 1                  TRA     NEXTPTR

     1020     6304                    /**/
     1021     6305    4         CASE(WSNX);

     1022     6306    4            F$DCB.WSN=VLP$WSN.WSN#;

   6306  1 003656   200004 470500                    LDP0    FPT$,,AUTO
         1 003657   200003 471500                    LDP1    JDCB$,,AUTO
         1 003660   040100 100500                    MLR     fill='040'O
         1 003661   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         1 003662   100027 000010                    ADSC9   23,,PR1                  cn=0,n=8
         1 003663   004431 710000 1                  TRA     NEXTPTR

     1023     6307    4         CASE(FORMX);

     1024     6308    5            IF F$DCB.FORM$=ADDR(NIL) THEN DO;

   6308  1 003664   200003 470500                    LDP0    JDCB$,,AUTO
         1 003665   000050 236100                    LDQ     40,,PR0
         1 003666   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 003667   003705 601000 1                  TNZ     s:6312

     1025     6309    5               CALL FSA$GSP(SIZEW(CODE16),F$DCB.FORM$)ALTRET(ERRORX);
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:156  

   6309  1 003670   200003 236100                    LDQ     JDCB$,,AUTO
         1 003671   000050 036003                    ADLQ    40,DU
         1 003672   000034 235000 2                  LDA     28
         1 003673   200050 757100                    STAQ    I+1,,AUTO
         1 003674   200050 630500                    EPPR0   I+1,,AUTO
         1 003675   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003676   000000 701000 xent               TSX1    FSA$GSP
         1 003677   004440 702000 1                  TSX2    ERRORX

     1026     6310    5               F$DCB.FORM$->CODE16='0'B;

   6310  1 003700   200003 470500                    LDP0    JDCB$,,AUTO
         1 003701   000050 471500                    LDP1    40,,PR0
         1 003702   000100 100400                    MLR     fill='000'O
         1 003703   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 003704   100000 000234                    ADSC9   0,,PR1                   cn=0,n=156

     1027     6311    5               END;

     1028     6312    4            F$DCB.FORM$->CODE16.FORM=VLP$FORM.FORM#;

   6312  1 003705   000050 471500                    LDP1    40,,PR0
         1 003706   200004 473500                    LDP3    FPT$,,AUTO
         1 003707   040100 100500                    MLR     fill='040'O
         1 003710   300000 000006                    ADSC9   0,,PR3                   cn=0,n=6
         1 003711   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6
         1 003712   004431 710000 1                  TRA     NEXTPTR

     1029     6313                    /**/
     1030     6314    4         CASE(ALTKX);

     1031     6315    4            IF (F$DCB.ASN=%FILE# OR F$DCB.ASN=%TAPE#) AND

   6315  1 003713   200003 470500                    LDP0    JDCB$,,AUTO
         1 003714   000032 236100                    LDQ     26,,PR0
         1 003715   777000 376007                    ANQ     -512,DL
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:157  
         1 003716   001000 116007                    CMPQ    512,DL
         1 003717   003722 600000 1                  TZE     s:6315+7
         1 003720   002000 116007                    CMPQ    1024,DL
         1 003721   004272 601000 1                  TNZ     s:6388
         1 003722   000032 236100                    LDQ     26,,PR0
         1 003723   777000 376003                    ANQ     -512,DU
         1 003724   006000 116003                    CMPQ    3072,DU
         1 003725   003730 600000 1                  TZE     s:6318
         1 003726   015000 116003                    CMPQ    6656,DU
         1 003727   004272 601000 1                  TNZ     s:6388

     1032     6316    4              (F$DCB.ORG=%INDEXED# OR F$DCB.ORG=%IREL#)
     1033     6317    5            THEN DO;

     1034     6318    6               IF F$DCB.FPRGX~=0 THEN DO;

   6318  1 003730   000054 221100                    LDX1    44,,PR0
         1 003731   003750 600000 1                  TZE     s:6324

     1035     6319    6                  ALTKEY$=PINCRW(B$ROSEG$,F$DCB.FPRGX);

   6319  1 003732   000000 636011                    EAQ     0,X1
         1 003733   000000 036000 xsym               ADLQ    B$ROSEG$
         1 003734   200007 756100                    STQ     ALTKEY$,,AUTO

     1036     6320    6                  CALL FSA$FSP(SIZEW(VLP$FPRG),ALTKEY$);

   6320  1 003735   200007 631500                    EPPR1   ALTKEY$,,AUTO
         1 003736   200051 451500                    STP1    I+2,,AUTO
         1 003737   000020 236000 2                  LDQ     16
         1 003740   200050 756100                    STQ     I+1,,AUTO
         1 003741   200050 630500                    EPPR0   I+1,,AUTO
         1 003742   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003743   000000 701000 xent               TSX1    FSA$FSP
         1 003744   000000 011000                    NOP     0

     1037     6321    6                  F$DCB.FPRGX=0;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:158  

   6321  1 003745   000000 220003                    LDX0    0,DU
         1 003746   200003 470500                    LDP0    JDCB$,,AUTO
         1 003747   000054 740100                    STX0    44,,PR0

     1038     6322    6                  END;

     1039     6323
     1040     6324    6               IF F$DCB.ALTKEYX~=0 THEN DO;

   6324  1 003750   000052 720100                    LXL0    42,,PR0
         1 003751   003774 600000 1                  TZE     s:6331

     1041     6325    6                  ALTKEY$=PINCRW(B$ROSEG$, F$DCB.ALTKEYX);

   6325  1 003752   000000 636010                    EAQ     0,X0
         1 003753   000000 036000 xsym               ADLQ    B$ROSEG$
         1 003754   200007 756100                    STQ     ALTKEY$,,AUTO

     1042     6326    6                  K=FITALTKEYS.NUMWRDS; /* Works for IRKEYS too */

   6326  1 003755   200007 471500                    LDP1    ALTKEY$,,AUTO
         1 003756   100000 236100                    LDQ     0,,PR1
         1 003757   000033 772000                    QRL     27
         1 003760   200043 756100                    STQ     K,,AUTO

     1043     6327    6                  CALL FSA$FSP(K, ALTKEY$);

   6327  1 003761   200007 633500                    EPPR3   ALTKEY$,,AUTO
         1 003762   200051 453500                    STP3    I+2,,AUTO
         1 003763   200043 634500                    EPPR4   K,,AUTO
         1 003764   200050 454500                    STP4    I+1,,AUTO
         1 003765   200050 630500                    EPPR0   I+1,,AUTO
         1 003766   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003767   000000 701000 xent               TSX1    FSA$FSP
         1 003770   000000 011000                    NOP     0

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:159  
     1044     6328    6                  F$DCB.ALTKEYX=0;

   6328  1 003771   000000 220003                    LDX0    0,DU
         1 003772   200003 470500                    LDP0    JDCB$,,AUTO
         1 003773   000052 440100                    SXL0    42,,PR0

     1045     6329    6                  END;

     1046     6330
     1047     6331    6               IF F$DCB.KFIELDX~=0 THEN DO;

   6331  1 003774   000056 721100                    LXL1    46,,PR0
         1 003775   004017 600000 1                  TZE     s:6338

     1048     6332    6                  KFIELD$=PINCRW(B$ROSEG$, F$DCB.KFIELDX);

   6332  1 003776   000000 636011                    EAQ     0,X1
         1 003777   000000 036000 xsym               ADLQ    B$ROSEG$
         1 004000   200010 756100                    STQ     KFIELD$,,AUTO

     1049     6333    6                  K=KFIELD.NWORDS;

   6333  1 004001   200010 471500                    LDP1    KFIELD$,,AUTO
         1 004002   100000 235100                    LDA     0,,PR1
         1 004003   200043 755100                    STA     K,,AUTO

     1050     6334    6                  CALL FSA$FSP(K, KFIELD$);

   6334  1 004004   200010 633500                    EPPR3   KFIELD$,,AUTO
         1 004005   200051 453500                    STP3    I+2,,AUTO
         1 004006   200043 634500                    EPPR4   K,,AUTO
         1 004007   200050 454500                    STP4    I+1,,AUTO
         1 004010   200050 630500                    EPPR0   I+1,,AUTO
         1 004011   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 004012   000000 701000 xent               TSX1    FSA$FSP
         1 004013   000000 011000                    NOP     0

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:160  
     1051     6335    6                  F$DCB.KFIELDX=0;

   6335  1 004014   000000 220003                    LDX0    0,DU
         1 004015   200003 470500                    LDP0    JDCB$,,AUTO
         1 004016   000056 440100                    SXL0    46,,PR0

     1052     6336    6                  END;

     1053     6337
     1054     6338    6               IF F$DCB.ORG=%INDEXED# THEN DO;

   6338  1 004017   000032 236100                    LDQ     26,,PR0
         1 004020   777000 376003                    ANQ     -512,DU
         1 004021   006000 116003                    CMPQ    3072,DU
         1 004022   004206 601000 1                  TNZ     s:6369

     1055     6339    6                  IF AMRF THEN I=VLP$ALTKEYS.SIZ#;

   6339  1 004023   200042 235100                    LDA     AMRF,,AUTO
         1 004024   004031 600000 1                  TZE     s:6341

   6339  1 004025   200004 471500                    LDP1    FPT$,,AUTO
         1 004026   100000 235100                    LDA     0,,PR1
         1 004027   200047 755100                    STA     I,,AUTO
         1 004030   004051 710000 1                  TRA     s:6346

     1056     6340    7                  ELSE DO;

     1057     6341    7                     CALL HFF$DSIZ(ALTKX, I);

   6341  1 004031   200047 631500                    EPPR1   I,,AUTO
         1 004032   200051 451500                    STP1    I+2,,AUTO
         1 004033   000043 236000 2                  LDQ     35
         1 004034   200050 756100                    STQ     I+1,,AUTO
         1 004035   200050 630500                    EPPR0   I+1,,AUTO
         1 004036   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 004037   000000 701000 xent               TSX1    HFF$DSIZ
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:161  
         1 004040   000000 011000                    NOP     0

     1058     6342    7                     I=(I-1)/4;

   6342  1 004041   200047 236100                    LDQ     I,,AUTO
         1 004042   000001 136007                    SBLQ    1,DL
         1 004043   000004 506007                    DIV     4,DL
         1 004044   200047 756100                    STQ     I,,AUTO

     1059     6343    7                     IF I>80 THEN I=80;

   6343  1 004045   000121 116007                    CMPQ    81,DL
         1 004046   004051 602000 1                  TNC     s:6346

   6343  1 004047   000120 235007                    LDA     80,DL
         1 004050   200047 755100                    STA     I,,AUTO

     1060     6344    7                     END;

     1061     6345
     1062     6346    7                  IF I>0 THEN DO;

   6346  1 004051   200047 235100                    LDA     I,,AUTO
         1 004052   004431 600000 1                  TZE     NEXTPTR

     1063     6347    7                     K=((I+1)*SIZEW(FITALTKEYS.K(0)))+1;

   6347  1 004053   200047 236100                    LDQ     I,,AUTO
         1 004054   000006 402007                    MPY     6,DL
         1 004055   000007 036007                    ADLQ    7,DL
         1 004056   200043 756100                    STQ     K,,AUTO

     1064     6348    7                     CALL FSA$GSP(K, ALTKEY$) ALTRET(ERRORX);

   6348  1 004057   200007 630500                    EPPR0   ALTKEY$,,AUTO
         1 004060   200051 450500                    STP0    I+2,,AUTO
         1 004061   200043 631500                    EPPR1   K,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:162  
         1 004062   200050 451500                    STP1    I+1,,AUTO
         1 004063   200050 630500                    EPPR0   I+1,,AUTO
         1 004064   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 004065   000000 701000 xent               TSX1    FSA$GSP
         1 004066   004440 702000 1                  TSX2    ERRORX

     1065     6349    7                     K=K*4;

   6349  1 004067   200043 235100                    LDA     K,,AUTO
         1 004070   000002 735000                    ALS     2
         1 004071   200043 755100                    STA     K,,AUTO

     1066     6350    7                     ALTKEY$->MOVEKB='0'B;

   6350  1 004072   200007 470500                    LDP0    ALTKEY$,,AUTO
         1 004073   000000 620005                    EAX0    0,AL
         1 004074   000140 100400                    MLR     fill='000'O
         1 004075   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 004076   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1067     6351    7                     FITALTKEYS.NUMWRDS=K/4;

   6351  1 004077   200043 236100                    LDQ     K,,AUTO
         1 004100   000002 772000                    QRL     2
         1 004101   200007 470500                    LDP0    ALTKEY$,,AUTO
         1 004102   000033 736000                    QLS     27
         1 004103   000000 552140                    STBQ    0,'40'O,PR0

     1068     6352    7                     F$DCB.ALTKEYX=POFFW(ALTKEY$, B$ROSEG$);

   6352  1 004104   000000 235000 xsym               LDA     B$ROSEG$
         1 004105   000022 771000                    ARL     18
         1 004106   200050 755100                    STA     I+1,,AUTO
         1 004107   200007 236100                    LDQ     ALTKEY$,,AUTO
         1 004110   000022 772000                    QRL     18
         1 004111   200050 136100                    SBLQ    I+1,,AUTO
         1 004112   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:163  
         1 004113   200003 470500                    LDP0    JDCB$,,AUTO
         1 004114   000052 440100                    SXL0    42,,PR0

     1069     6353    7                     IF I>=VLP$ALTKEYS.SIZ# THEN I=VLP$ALTKEYS.SIZ#;

   6353  1 004115   200004 471500                    LDP1    FPT$,,AUTO
         1 004116   200047 236100                    LDQ     I,,AUTO
         1 004117   100000 116100                    CMPQ    0,,PR1
         1 004120   004124 602000 1                  TNC     s:6354

   6353  1 004121   100000 235100                    LDA     0,,PR1
         1 004122   200047 755100                    STA     I,,AUTO
         1 004123   004135 710000 1                  TRA     s:6359

     1070     6354    8                     ELSE IF F$DCB.FUN=%CREATE# THEN DO;

   6354  1 004124   000032 236100                    LDQ     26,,PR0
         1 004125   000777 376003                    ANQ     511,DU
         1 004126   000003 116003                    CMPQ    3,DU
         1 004127   004135 601000 1                  TNZ     s:6359

     1071     6355    8                        B$JIT.ERR=FMM$E$BADVECT17;

   6355  1 004130   000043 236000 0                  LDQ     FMM$E$BADVECT17
         1 004131   000000 473400 xsym               LDP3    B$JIT$
         1 004132   300012 756100                    STQ     10,,PR3

     1072     6356    8                        ALTRETURN;

   6356  1 004133   200046 221300                    LDX1  ! TDCB$+2,,AUTO
         1 004134   000000 702211                    TSX2  ! 0,X1

     1073     6357    8                        END;
     1074     6358
     1075     6359    7                     FITALTKEYS.NUMENTS=I+1;

   6359  1 004135   200007 473500                    LDP3    ALTKEY$,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:164  
         1 004136   200047 236100                    LDQ     I,,AUTO
         1 004137   000001 036007                    ADLQ    1,DL
         1 004140   000022 736000                    QLS     18
         1 004141   300000 676100                    ERQ     0,,PR3
         1 004142   000377 376003                    ANQ     255,DU
         1 004143   300000 656100                    ERSQ    0,,PR3

     1076     6360    8                     DO WHILE I>0;

   6360  1 004144   200047 235100                    LDA     I,,AUTO
         1 004145   004431 600000 1                  TZE     NEXTPTR

     1077     6361    8                        FITALTKEYS.K.KEYL(I)=VLP$ALTKEYS.K.KEYL#(I-1);

   6361  1 004146   200047 236100                    LDQ     I,,AUTO
         1 004147   000006 402007                    MPY     6,DL
         1 004150   200004 470500                    LDP0    FPT$,,AUTO
         1 004151   200047 720100                    LXL0    I,,AUTO
         1 004152   200007 471500                    LDP1    ALTKEY$,,AUTO
         1 004153   000000 621006                    EAX1    0,QL
         1 004154   000000 236110                    LDQ     0,X0,PR0
         1 004155   000011 736000                    QLS     9
         1 004156   100001 676111                    ERQ     1,X1,PR1
         1 004157   777000 376003                    ANQ     -512,DU
         1 004160   100001 656111                    ERSQ    1,X1,PR1

     1078     6362    8                        FITALTKEYS.K.KEYX(I)=VLP$ALTKEYS.K.KEYX#(I-1);

   6362  1 004161   200047 236100                    LDQ     I,,AUTO
         1 004162   000006 402007                    MPY     6,DL
         1 004163   200047 720100                    LXL0    I,,AUTO
         1 004164   000000 721110                    LXL1    0,X0,PR0
         1 004165   200007 471500                    LDP1    ALTKEY$,,AUTO
         1 004166   100003 441106                    SXL1    3,QL,PR1

     1079     6363    8                        FITALTKEYS.K.UNIQUE(I)=VLP$ALTKEYS.K.UNIQUE#(I-1);

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:165  
   6363  1 004167   200047 236100                    LDQ     I,,AUTO
         1 004170   000006 402007                    MPY     6,DL
         1 004171   200007 471500                    LDP1    ALTKEY$,,AUTO
         1 004172   200047 720100                    LXL0    I,,AUTO
         1 004173   000000 621006                    EAX1    0,QL
         1 004174   000000 236110                    LDQ     0,X0,PR0
         1 004175   000011 772000                    QRL     9
         1 004176   100004 676111                    ERQ     4,X1,PR1
         1 004177   000400 376003                    ANQ     256,DU
         1 004200   100004 656111                    ERSQ    4,X1,PR1

     1080     6364    8                        I=I-1;

   6364  1 004201   200047 235100                    LDA     I,,AUTO
         1 004202   000001 135007                    SBLA    1,DL
         1 004203   200047 755100                    STA     I,,AUTO

     1081     6365    8                        END;

   6365  1 004204   004146 601000 1                  TNZ     s:6361

     1082     6366    7                     END;

     1083     6367    6                  END;

   6367  1 004205   004431 710000 1                  TRA     NEXTPTR

     1084     6368    6               ELSE DO; /* INDEX RELATIONAL KEYS */

     1085     6369    7                  IF NOT AMRF THEN DO;

   6369  1 004206   200042 235100                    LDA     AMRF,,AUTO
         1 004207   004265 601000 1                  TNZ     s:6384

     1086     6370    7                     CALL HFF$DSIZ(ALTKX, N);

   6370  1 004210   200011 631500                    EPPR1   N,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:166  
         1 004211   200051 451500                    STP1    I+2,,AUTO
         1 004212   000043 236000 2                  LDQ     35
         1 004213   200050 756100                    STQ     I+1,,AUTO
         1 004214   200050 630500                    EPPR0   I+1,,AUTO
         1 004215   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 004216   000000 701000 xent               TSX1    HFF$DSIZ
         1 004217   000000 011000                    NOP     0

     1087     6371    7                     N=(N-4)/2-1;

   6371  1 004220   200011 236100                    LDQ     N,,AUTO
         1 004221   000004 136007                    SBLQ    4,DL
         1 004222   000002 506007                    DIV     2,DL
         1 004223   000001 136007                    SBLQ    1,DL
         1 004224   200011 756100                    STQ     N,,AUTO

     1088     6372    7                     NKEYS=0;

   6372  1 004225   200012 450100                    STZ     NKEYS,,AUTO

     1089     6373    8   COUNT:            DO I=0 TO N;

   6373  1 004226   200047 450100       COUNT        STZ     I,,AUTO
         1 004227   004247 710000 1                  TRA     s:6376+3

     1090     6374    8                        IF FPT$->VLP$IRKEYS.K.KEYEND#(I) THEN NKEYS=NKEYS+1;

   6374  1 004230   200047 236100                    LDQ     I,,AUTO
         1 004231   000022 402007                    MPY     18,DL
         1 004232   200004 470500                    LDP0    FPT$,,AUTO
         1 004233   000000 066506                    CMPB    filb='0'B
         1 004234   000001 000001                    BDSC    1,Q,PR0                  by=0,bit=0,n=1
         1 004235   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 004236   004240 600000 1                  TZE     s:6375

   6374  1 004237   200012 054100                    AOS     NKEYS,,AUTO

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:167  
     1091     6375    8                        IF NKEYS = VLP$IRKEYS.NKEYS# THEN EXIT;

   6375  1 004240   200012 236100                    LDQ     NKEYS,,AUTO
         1 004241   004244 604000 1                  TMI     s:6376
         1 004242   000000 116100                    CMPQ    0,,PR0
         1 004243   004253 600000 1                  TZE     s:6378

     1092     6376    8                        END;

   6376  1 004244   200047 235100                    LDA     I,,AUTO
         1 004245   000001 035007                    ADLA    1,DL
         1 004246   200047 755100                    STA     I,,AUTO
         1 004247   200047 236100                    LDQ     I,,AUTO
         1 004250   004253 604000 1                  TMI     s:6378
         1 004251   200011 116100                    CMPQ    N,,AUTO
         1 004252   004230 604400 1                  TMOZ    s:6374

     1093     6377
     1094     6378    8                     IF NKEYS~=VLP$IRKEYS.NKEYS# THEN DO;

   6378  1 004253   200004 470500                    LDP0    FPT$,,AUTO
         1 004254   200012 236100                    LDQ     NKEYS,,AUTO
         1 004255   004260 604000 1                  TMI     s:6379
         1 004256   000000 116100                    CMPQ    0,,PR0
         1 004257   004265 600000 1                  TZE     s:6384

     1095     6379    8                        B$JIT.ERR=FMM$E$BADVECT17;

   6379  1 004260   000043 236000 0                  LDQ     FMM$E$BADVECT17
         1 004261   000000 471400 xsym               LDP1    B$JIT$
         1 004262   100012 756100                    STQ     10,,PR1

     1096     6380    8                        ALTRETURN;

   6380  1 004263   200046 221300                    LDX1  ! TDCB$+2,,AUTO
         1 004264   000000 702211                    TSX2  ! 0,X1

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:168  
     1097     6381    8                        END;
     1098     6382    7                     END;
     1099     6383
     1100     6384    6                  CALL FMG$IRSETUP(VLP$IRKEYS) ALTRET(ERRORX);

   6384  1 004265   200004 630500                    EPPR0   FPT$,,AUTO
         1 004266   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 004267   000000 701000 xent               TSX1    FMG$IRSETUP
         1 004270   004440 702000 1                  TSX2    ERRORX

     1101     6385    6                  END;

     1102     6386    5               END;

   6386  1 004271   004431 710000 1                  TRA     NEXTPTR

     1103     6387    5            ELSE DO; /* Use it as FPRG_ */

     1104     6388    6               IF NOT AMRF THEN DO;

   6388  1 004272   200042 236100                    LDQ     AMRF,,AUTO
         1 004273   004324 601000 1                  TNZ     s:6404

     1105     6389    6                  IF F$DCB.ASN=%DEVICE# AND F$DCB.RES='NO' THEN

   6389  1 004274   000032 236100                    LDQ     26,,PR0
         1 004275   777000 376007                    ANQ     -512,DL
         1 004276   003000 116007                    CMPQ    1536,DL
         1 004277   004304 601000 1                  TNZ     s:6391
         1 004300   040000 106500                    CMPC    fill='040'O
         1 004301   000026 000004                    ADSC9   22,,PR0                  cn=0,n=4
         1 004302   000061 000002 0                  ADSC9   FUN+11                   cn=0,n=2
         1 004303   004431 600000 1                  TZE     NEXTPTR

     1106     6390    6                  GOTO NEXTPTR;
     1107     6391    6                  CALL HFF$DSIZ(ALTKX,I);

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:169  
   6391  1 004304   200047 631500                    EPPR1   I,,AUTO
         1 004305   200051 451500                    STP1    I+2,,AUTO
         1 004306   000043 236000 2                  LDQ     35
         1 004307   200050 756100                    STQ     I+1,,AUTO
         1 004310   200050 630500                    EPPR0   I+1,,AUTO
         1 004311   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 004312   000000 701000 xent               TSX1    HFF$DSIZ
         1 004313   000000 011000                    NOP     0

     1108     6392    7                  IF I<SIZEC(VLP$FPRG) THEN DO;

   6392  1 004314   200047 235100                    LDA     I,,AUTO
         1 004315   000110 115007                    CMPA    72,DL
         1 004316   004324 603000 1                  TRC     s:6404

     1109     6393    7                     B$JIT.ERR=FMM$E$BADVECT17;

   6393  1 004317   000043 236000 0                  LDQ     FMM$E$BADVECT17
         1 004320   000000 470400 xsym               LDP0    B$JIT$
         1 004321   000012 756100                    STQ     10,,PR0

     1110     6394                    /*E*     ERROR: FMM-E$BADVECT17-E
     1111     6395              *        MESSAGE:ALTKEY, IRKEY, or FPRG VLP for M$OPEN %of %DC% is too small.
     1112     6396              MESSAGE1: If ALTKEY or IRKEY, the VLP frames an area too
     1113     6397              small to contain all the requested keys. Or,
     1114     6398              for IRKEYS only, NKEYS is not equal to the
     1115     6399              number of keys specified.
     1116     6400              */
     1117     6401    7                     ALTRETURN;

   6401  1 004322   200046 221300                    LDX1  ! TDCB$+2,,AUTO
         1 004323   000000 702211                    TSX2  ! 0,X1

     1118     6402    7                     END;
     1119     6403    6                  END;
     1120     6404    6               IF F$DCB.FPRGX=0 THEN DO;

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:170  
   6404  1 004324   200003 470500                    LDP0    JDCB$,,AUTO
         1 004325   000054 220100                    LDX0    44,,PR0
         1 004326   004351 601000 1                  TNZ     s:6408

     1121     6405    6                  CALL FSA$GSP(SIZEW(VLP$FPRG),ALTKEY$) ALTRET(ERRORX);

   6405  1 004327   200007 631500                    EPPR1   ALTKEY$,,AUTO
         1 004330   200051 451500                    STP1    I+2,,AUTO
         1 004331   000020 236000 2                  LDQ     16
         1 004332   200050 756100                    STQ     I+1,,AUTO
         1 004333   200050 630500                    EPPR0   I+1,,AUTO
         1 004334   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 004335   000000 701000 xent               TSX1    FSA$GSP
         1 004336   004440 702000 1                  TSX2    ERRORX

     1122     6406    6                  F$DCB.FPRGX=POFFW(ALTKEY$,B$ROSEG$);

   6406  1 004337   000000 235000 xsym               LDA     B$ROSEG$
         1 004340   000022 771000                    ARL     18
         1 004341   200050 755100                    STA     I+1,,AUTO
         1 004342   200007 236100                    LDQ     ALTKEY$,,AUTO
         1 004343   000022 772000                    QRL     18
         1 004344   200050 136100                    SBLQ    I+1,,AUTO
         1 004345   000000 620006                    EAX0    0,QL
         1 004346   200003 470500                    LDP0    JDCB$,,AUTO
         1 004347   000054 740100                    STX0    44,,PR0

     1123     6407    6                  END;

   6407  1 004350   004354 710000 1                  TRA     s:6409

     1124     6408    5               ELSE ALTKEY$=PINCRW(B$ROSEG$,F$DCB.FPRGX);

   6408  1 004351   000000 636010                    EAQ     0,X0
         1 004352   000000 036000 xsym               ADLQ    B$ROSEG$
         1 004353   200007 756100                    STQ     ALTKEY$,,AUTO

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:171  
     1125     6409    5               ALTKEY$->VLP$FPRG=VLP$FPRG;

   6409  1 004354   200004 471500                    LDP1    FPT$,,AUTO
         1 004355   200007 473500                    LDP3    ALTKEY$,,AUTO
         1 004356   000100 100500                    MLR     fill='000'O
         1 004357   100000 000104                    ADSC9   0,,PR1                   cn=0,n=68
         1 004360   300000 000104                    ADSC9   0,,PR3                   cn=0,n=68

     1126     6410
     1127     6411    6               IF F$DCB.ALTKEYX~=0 THEN DO;

   6411  1 004361   000052 720100                    LXL0    42,,PR0
         1 004362   004405 600000 1                  TZE     s:6418

     1128     6412    6                  ALTKEY$=PINCRW(B$ROSEG$,F$DCB.ALTKEYX);

   6412  1 004363   000000 636010                    EAQ     0,X0
         1 004364   000000 036000 xsym               ADLQ    B$ROSEG$
         1 004365   200007 756100                    STQ     ALTKEY$,,AUTO

     1129     6413    6                  K=FITALTKEYS.NUMWRDS; /* Works for IRKEYS too */

   6413  1 004366   200007 473500                    LDP3    ALTKEY$,,AUTO
         1 004367   300000 236100                    LDQ     0,,PR3
         1 004370   000033 772000                    QRL     27
         1 004371   200043 756100                    STQ     K,,AUTO

     1130     6414    6                  CALL FSA$FSP(K, ALTKEY$);

   6414  1 004372   200007 634500                    EPPR4   ALTKEY$,,AUTO
         1 004373   200051 454500                    STP4    I+2,,AUTO
         1 004374   200043 635500                    EPPR5   K,,AUTO
         1 004375   200050 455500                    STP5    I+1,,AUTO
         1 004376   200050 630500                    EPPR0   I+1,,AUTO
         1 004377   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 004400   000000 701000 xent               TSX1    FSA$FSP
         1 004401   000000 011000                    NOP     0
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:172  

     1131     6415    6                  F$DCB.ALTKEYX=0;

   6415  1 004402   000000 220003                    LDX0    0,DU
         1 004403   200003 470500                    LDP0    JDCB$,,AUTO
         1 004404   000052 440100                    SXL0    42,,PR0

     1132     6416    6                  END;

     1133     6417
     1134     6418    6               IF F$DCB.KFIELDX~=0 THEN DO;

   6418  1 004405   000056 721100                    LXL1    46,,PR0
         1 004406   004431 600000 1                  TZE     NEXTPTR

     1135     6419    6                  KFIELD$=PINCRW(B$ROSEG$,F$DCB.KFIELDX);

   6419  1 004407   000000 636011                    EAQ     0,X1
         1 004410   000000 036000 xsym               ADLQ    B$ROSEG$
         1 004411   200010 756100                    STQ     KFIELD$,,AUTO

     1136     6420    6                  K=KFIELD.NWORDS;

   6420  1 004412   200010 471500                    LDP1    KFIELD$,,AUTO
         1 004413   100000 235100                    LDA     0,,PR1
         1 004414   200043 755100                    STA     K,,AUTO

     1137     6421    6                  CALL FSA$FSP(K, KFIELD$);

   6421  1 004415   200010 633500                    EPPR3   KFIELD$,,AUTO
         1 004416   200051 453500                    STP3    I+2,,AUTO
         1 004417   200043 634500                    EPPR4   K,,AUTO
         1 004420   200050 454500                    STP4    I+1,,AUTO
         1 004421   200050 630500                    EPPR0   I+1,,AUTO
         1 004422   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 004423   000000 701000 xent               TSX1    FSA$FSP
         1 004424   000000 011000                    NOP     0
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:173  

     1138     6422    6                  F$DCB.KFIELDX=0;

   6422  1 004425   000000 220003                    LDX0    0,DU
         1 004426   200003 470500                    LDP0    JDCB$,,AUTO
         1 004427   000056 440100                    SXL0    46,,PR0

     1139     6423    6                  END;

     1140     6424
     1141     6425    5               END;

   6425  1 004430   004431 710000 1                  TRA     NEXTPTR

     1142     6426                    /**/
     1143     6427    4         CASE(ELSE); /* OTHER PARAMETERS */

     1144     6428    4         END;

     1145     6429    3   NEXTPTR:
     1146     6430    3         END;

   6430  1 004431   200041 235100       NEXTPTR      LDA     J,,AUTO
         1 004432   000001 035007                    ADLA    1,DL
         1 004433   200041 755100                    STA     J,,AUTO
         1 004434   000022 115007                    CMPA    18,DL
         1 004435   002664 602000 1                  TNC     s:6132

     1147     6431
     1148     6432    2      RETURN;

   6432  1 004436   200046 221300                    LDX1  ! TDCB$+2,,AUTO
         1 004437   000001 702211                    TSX2  ! 1,X1

     1149     6433    2   ERRORX: ALTRETURN;

   6433  1 004440   200046 221300       ERRORX       LDX1  ! TDCB$+2,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:174  
         1 004441   000000 702211                    TSX2  ! 0,X1

     1150     6434    2   END FMM$MERGE1;
     1151     6435        %EJECT;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:175  
     1152     6436                    /*F*
     1153     6437                    *     NAME:   FMM$GETDCB
     1154     6438                    *
     1155     6439                    *     PURPOSE:  TO GET (I.E. BUILD) A DCB FOR THE USER IF A DCB OF THE
     1156     6440                    *               SPECIFIED NAME DOES NOT ALREADY EXIST.  IF THE DCB
     1157     6441                    *               CURRENTLY EXISTS, THEN RETURN ITS DCB NUMBER.
     1158     6442                    */
     1159     6443    1   FMM$GETDCB: ENTRY;

   6443  1 004442   000000 700200 xent  FMM$GETDCB   TSX0  ! X66_AUTO_0
         1 004443   000054 000000                    ZERO    44,0

     1160     6444                    /**/
     1161     6445    1      JDCB$=ADDR(NIL);

   6445  1 004444   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 004445   200003 756100                    STQ     JDCB$,,AUTO

     1162     6446    1      K=0;

   6446  1 004446   200043 450100                    STZ     K,,AUTO

     1163     6447    1      CALL HFF$NILERASE(1)ALTRET(NODCBNAME);

   6447  1 004447   000027 630400 2                  EPPR0   23
         1 004450   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 004451   000000 701000 xent               TSX1    HFF$NILERASE
         1 004452   004457 702000 1                  TSX2    NODCBNAME

     1164     6448    1      FN.L=B$PS$(1)->FF.CHARX;

   6448  1 004453   000001 470400 xsym               LDP0    B$PS$+1
         1 004454   040100 100500                    MLR     fill='040'O
         1 004455   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 004456   200043 600001                    ADSC9   K,,AUTO                  cn=3,n=1

     1165     6449    1   NODCBNAME: IF K > 31
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:176  

   6449  1 004457   200043 235100       NODCBNAME    LDA     K,,AUTO
         1 004460   000040 115007                    CMPA    32,DL
         1 004461   005143 603000 1                  TRC     ERR6

     1166     6450    1      THEN GOTO ERR6;
     1167     6451                    /*E*     ERROR: FMM-E$BADDCBNAME-E
     1168     6452                    *        MESSAGE: DCBNAME more than 31 characters for M$GETDCB
     1169     6453                    */
     1170     6454    1      CALL FMO$GETDOMAIN(I);

   6454  1 004462   200040 630500                    EPPR0   I,,AUTO
         1 004463   200050 450500                    STP0    I+1,,AUTO
         1 004464   200050 630500                    EPPR0   I+1,,AUTO
         1 004465   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 004466   000000 701000 xent               TSX1    FMO$GETDOMAIN
         1 004467   000000 011000                    NOP     0

     1171     6455    2      IF I ~= 7 THEN DO;

   6455  1 004470   200040 235100                    LDA     I,,AUTO
         1 004471   000007 115007                    CMPA    7,DL
         1 004472   004514 600000 1                  TZE     USERSLOT

     1172     6456    2         I=B$PS$(0)->FPT$GETDCB_V.DCB#;

   6456  1 004473   000000 470400 xsym               LDP0    B$PS$
         1 004474   000000 236100                    LDQ     0,,PR0
         1 004475   000022 772000                    QRL     18
         1 004476   200040 756100                    STQ     I,,AUTO

     1173     6457    2         IF I < 5 OR I > 9 THEN GOTO USERSLOT;

   6457  1 004477   000005 116007                    CMPQ    5,DL
         1 004500   004514 602000 1                  TNC     USERSLOT
         1 004501   000012 116007                    CMPQ    10,DL
         1 004502   004514 603000 1                  TRC     USERSLOT
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:177  

     1174     6458    2         B$JIT.DCBNO=I;

   6458  1 004503   000000 471400 xsym               LDP1    B$JIT$
         1 004504   100022 552104                    STBQ    18,'04'O,PR1

     1175     6459    2         IF DCBADDR(I) ~= ADDR(NIL) THEN GOTO ERR5;

   6459  1 004505   000000 473400 2                  LDP3    0
         1 004506   300000 474500                    LDP4    0,,PR3
         1 004507   200040 720100                    LXL0    I,,AUTO
         1 004510   400000 236110                    LDQ     0,X0,PR4
         1 004511   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 004512   005130 601000 1                  TNZ     ERR5

     1176     6460                    /*E*     ERROR: FMM-E$DCBHERE-C
     1177     6461                    *        MESSAGE:Special DCB% %DC% already exists.
     1178     6462                    */
     1179     6463    2         GOTO FOUNDSLOT;

   6463  1 004513   004604 710000 1                  TRA     FOUNDSLOT

   6463  1 004514                       USERSLOT     null
     1180     6464    2         END;
     1181     6465    1   USERSLOT:;
     1182     6466    2      IF K>0 THEN DO I=2 TO B$ROSEG$->B$ROSEG.NUMDCBS;

   6466  1 004514   200043 235100                    LDA     K,,AUTO
         1 004515   004554 600000 1                  TZE     s:6472

   6466  1 004516   000002 236007                    LDQ     2,DL
         1 004517   200040 756100                    STQ     I,,AUTO
         1 004520   004547 710000 1                  TRA     s:6471+3

     1183     6467    2         IF DCBADDR(I)~=ADDR(NIL)

   6467  1 004521   000000 470400 2                  LDP0    0
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:178  
         1 004522   000000 471500                    LDP1    0,,PR0
         1 004523   200040 720100                    LXL0    I,,AUTO
         1 004524   100000 236110                    LDQ     0,X0,PR1
         1 004525   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 004526   004544 600000 1                  TZE     s:6471

     1184     6468    2         THEN IF DCBADDR(I)->F$DCB.DCBNAME.L=K

   6468  1 004527   100000 473510                    LDP3    0,X0,PR1
         1 004530   300140 236100                    LDQ     96,,PR3
         1 004531   000033 772000                    QRL     27
         1 004532   000037 376007                    ANQ     31,DL
         1 004533   200043 116100                    CMPQ    K,,AUTO
         1 004534   004544 601000 1                  TNZ     s:6471
         1 004535   000000 621006                    EAX1    0,QL
         1 004536   000001 474400 xsym               LDP4    B$PS$+1
         1 004537   200043 722100                    LXL2    K,,AUTO
         1 004540   040140 106540                    CMPC    fill='040'O
         1 004541   300140 200011                    ADSC9   96,,PR3                  cn=1,n=*X1
         1 004542   400000 200012                    ADSC9   0,,PR4                   cn=1,n=*X2
         1 004543   004724 600000 1                  TZE     FOUNDDCB

     1185     6469    2           AND DCBADDR(I)->F$DCB.DCBNAME.N=B$PS$(1)->FF.RECX
     1186     6470    2         THEN GOTO FOUNDDCB;
     1187     6471    2         END;

   6471  1 004544   200040 235100                    LDA     I,,AUTO
         1 004545   000001 035007                    ADLA    1,DL
         1 004546   200040 755100                    STA     I,,AUTO
         1 004547   000000 470400 xsym               LDP0    B$ROSEG$
         1 004550   000002 236100                    LDQ     2,,PR0
         1 004551   000022 772000                    QRL     18
         1 004552   200040 116100                    CMPQ    I,,AUTO
         1 004553   004521 603000 1                  TRC     s:6467

     1188     6472    2      IF B$PS$(0)->FPT$GETDCB_V.TEST THEN DO;

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:179  
   6472  1 004554   000000 470400 xsym               LDP0    B$PS$
         1 004555   000000 236100                    LDQ     0,,PR0
         1 004556   200000 316007                    CANQ    65536,DL
         1 004557   004562 600000 1                  TZE     s:6476

     1189     6473    2         I=0;

   6473  1 004560   200040 450100                    STZ     I,,AUTO

     1190     6474    2         GOTO FOUNDDCB;

   6474  1 004561   004724 710000 1                  TRA     FOUNDDCB

     1191     6475    2         END;
     1192     6476    2      DO I=10 TO B$ROSEG$->B$ROSEG.NUMDCBS;

   6476  1 004562   000012 235007                    LDA     10,DL
         1 004563   200040 755100                    STA     I,,AUTO
         1 004564   004576 710000 1                  TRA     s:6478+3

     1193     6477    2         IF DCBADDR(I)=ADDR(NIL) THEN GOTO FOUNDSLOT;

   6477  1 004565   000000 470400 2                  LDP0    0
         1 004566   000000 471500                    LDP1    0,,PR0
         1 004567   200040 720100                    LXL0    I,,AUTO
         1 004570   100000 236110                    LDQ     0,X0,PR1
         1 004571   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 004572   004604 600000 1                  TZE     FOUNDSLOT

     1194     6478    2         END;

   6478  1 004573   200040 235100                    LDA     I,,AUTO
         1 004574   000001 035007                    ADLA    1,DL
         1 004575   200040 755100                    STA     I,,AUTO
         1 004576   000000 470400 xsym               LDP0    B$ROSEG$
         1 004577   000002 236100                    LDQ     2,,PR0
         1 004600   000022 772000                    QRL     18
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:180  
         1 004601   200040 116100                    CMPQ    I,,AUTO
         1 004602   004565 603000 1                  TRC     s:6477

     1195     6479    1      GOTO NOSLOTS;

   6479  1 004603   005124 710000 1                  TRA     NOSLOTS

     1196     6480                    /*E*     ERROR: FMM-E$NOSLOTS-E
     1197     6481                    *        MESSAGE:No spare DCBSLOTS left for this M$GETDCB.
     1198     6482                    *        MESSAGE1:The run unit should be LINKed with more DCBSLOTS.
     1199     6483                    */
     1200     6484    1   FOUNDSLOT: J=POFFW(ADDR(F$DCB.DCBNAME),JDCB$)+(K+4)/4;

   6484  1 004604   200003 236100       FOUNDSLOT    LDQ     JDCB$,,AUTO
         1 004605   000140 036003                    ADLQ    96,DU
         1 004606   000022 772000                    QRL     18
         1 004607   200003 235100                    LDA     JDCB$,,AUTO
         1 004610   000022 771000                    ARL     18
         1 004611   200050 755100                    STA     I+1,,AUTO
         1 004612   200050 136100                    SBLQ    I+1,,AUTO
         1 004613   200051 756100                    STQ     I+2,,AUTO
         1 004614   200043 236100                    LDQ     K,,AUTO
         1 004615   000004 036007                    ADLQ    4,DL
         1 004616   000002 772000                    QRL     2
         1 004617   200051 036100                    ADLQ    I+2,,AUTO
         1 004620   200041 756100                    STQ     J,,AUTO

     1201     6485    1      CALL FSA$GSP(J,TDCB$) ALTRET(ERRORX);

   6485  1 004621   200044 630500                    EPPR0   TDCB$,,AUTO
         1 004622   200051 450500                    STP0    I+2,,AUTO
         1 004623   200041 631500                    EPPR1   J,,AUTO
         1 004624   200050 451500                    STP1    I+1,,AUTO
         1 004625   200050 630500                    EPPR0   I+1,,AUTO
         1 004626   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 004627   000000 701000 xent               TSX1    FSA$GSP
         1 004630   005153 702000 1                  TSX2    ERRORX
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:181  

     1202     6486    1      JDCB$=TDCB$;

   6486  1 004631   200044 236100                    LDQ     TDCB$,,AUTO
         1 004632   200003 756100                    STQ     JDCB$,,AUTO

     1203     6487    1      B$ROSEG$->B$ROSEG.DCBPTR$->DCBP(I)=JDCB$;

   6487  1 004633   000000 470400 xsym               LDP0    B$ROSEG$
         1 004634   000000 471500                    LDP1    0,,PR0
         1 004635   200040 720100                    LXL0    I,,AUTO
         1 004636   100000 756110                    STQ     0,X0,PR1

     1204     6488    1      J=J*4;

   6488  1 004637   200041 235100                    LDA     J,,AUTO
         1 004640   000002 735000                    ALS     2
         1 004641   200041 755100                    STA     J,,AUTO

     1205     6489    1      JDCB$->MOVEJB='0'B;

   6489  1 004642   200003 470500                    LDP0    JDCB$,,AUTO
         1 004643   000000 620005                    EAX0    0,AL
         1 004644   000140 100400                    MLR     fill='000'O
         1 004645   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 004646   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1206     6490    1      F$DCB.DCBNAME.L=K;

   6490  1 004647   200043 236100                    LDQ     K,,AUTO
         1 004650   000033 736000                    QLS     27
         1 004651   000140 676100                    ERQ     96,,PR0
         1 004652   037000 376003                    ANQ     15872,DU
         1 004653   000140 656100                    ERSQ    96,,PR0

     1207     6491    1      IF K>0 THEN

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:182  
   6491  1 004654   200043 235100                    LDA     K,,AUTO
         1 004655   004667 600000 1                  TZE     s:6493

     1208     6492    1      F$DCB.DCBNAME.N=B$PS$(1)->FF.RECX;

   6492  1 004656   000140 236100                    LDQ     96,,PR0
         1 004657   000033 772000                    QRL     27
         1 004660   000037 376007                    ANQ     31,DL
         1 004661   000001 471400 xsym               LDP1    B$PS$+1
         1 004662   000000 620005                    EAX0    0,AL
         1 004663   000000 621006                    EAX1    0,QL
         1 004664   040140 100540                    MLR     fill='040'O
         1 004665   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
         1 004666   000140 200011                    ADSC9   96,,PR0                  cn=1,n=*X1

     1209     6493    1      B$JIT$->B$JIT.DCB$=JDCB$;

   6493  1 004667   200003 236100                    LDQ     JDCB$,,AUTO
         1 004670   000000 471400 xsym               LDP1    B$JIT$
         1 004671   100232 756100                    STQ     154,,PR1

     1210     6494    1      CALL FMM$SCRUB1(TDCB$);

   6494  1 004672   200044 633500                    EPPR3   TDCB$,,AUTO
         1 004673   200050 453500                    STP3    I+1,,AUTO
         1 004674   200050 630500                    EPPR0   I+1,,AUTO
         1 004675   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 004676   000000 701000 xent               TSX1    FMM$SCRUB1
         1 004677   000000 011000                    NOP     0

     1211     6495    1      F$DCB.DCB#=I;

   6495  1 004700   200003 470500                    LDP0    JDCB$,,AUTO
         1 004701   200040 236100                    LDQ     I,,AUTO
         1 004702   000033 736000                    QLS     27
         1 004703   000060 552140                    STBQ    48,'40'O,PR0

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:183  
     1212     6496    2      IF B$PS$(0)->FPT$GETDCB_V.MERGE THEN DO;

   6496  1 004704   000000 471400 xsym               LDP1    B$PS$
         1 004705   100000 236100                    LDQ     0,,PR1
         1 004706   400000 316007                    CANQ    -131072,DL
         1 004707   004722 600000 1                  TZE     NOSET

     1213     6497    2         CALL FMM$GETAMR(TDCB$,BUF$) ALTRET(NOSET);

   6497  1 004710   200005 633500                    EPPR3   BUF$,,AUTO
         1 004711   200051 453500                    STP3    I+2,,AUTO
         1 004712   200044 634500                    EPPR4   TDCB$,,AUTO
         1 004713   200050 454500                    STP4    I+1,,AUTO
         1 004714   200050 630500                    EPPR0   I+1,,AUTO
         1 004715   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 004716   000000 701000 xent               TSX1    FMM$GETAMR
         1 004717   004722 702000 1                  TSX2    NOSET

     1214     6498    2         CALL FMM$MERGE1;

   6498  1 004720   001672 701000 1                  TSX1    FMM$MERGE1
         1 004721   000000 011000                    NOP     0

     1215     6499    2         END;

     1216     6500    1   NOSET: B$JIT$->B$JIT.ERR='0'B;

   6500  1 004722   000000 470400 xsym  NOSET        LDP0    B$JIT$
         1 004723   000012 450100                    STZ     10,,PR0

   6496  1 004724                       FOUNDDCB     null
     1217     6501    1   FOUNDDCB:;
     1218     6502    1      CALL HFF$DSIZ(2,K);

   6502  1 004724   200043 630500                    EPPR0   K,,AUTO
         1 004725   200051 450500                    STP0    I+2,,AUTO
         1 004726   000001 236000 2                  LDQ     1
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:184  
         1 004727   200050 756100                    STQ     I+1,,AUTO
         1 004730   200050 630500                    EPPR0   I+1,,AUTO
         1 004731   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 004732   000000 701000 xent               TSX1    HFF$DSIZ
         1 004733   000000 011000                    NOP     0

     1219     6503    2      IF K~=0 THEN DO;

   6503  1 004734   200043 235100                    LDA     K,,AUTO
         1 004735   004755 600000 1                  TZE     s:6508

     1220     6504    2         IF K>2 THEN K=4;

   6504  1 004736   000003 115007                    CMPA    3,DL
         1 004737   004743 602000 1                  TNC     s:6505

   6504  1 004740   000004 236007                    LDQ     4,DL
         1 004741   200043 756100                    STQ     K,,AUTO
         1 004742   004745 710000 1                  TRA     s:6506

     1221     6505    2         ELSE K=2;

   6505  1 004743   000002 236007                    LDQ     2,DL
         1 004744   200043 756100                    STQ     K,,AUTO

     1222     6506    2         B$PS$(2)->MOVEKC=PINCRC(ADDR(I),4-K)->MOVEKC;

   6506  1 004745   000000 235003                    LDA     0,DU
         1 004746   200043 135100                    SBLA    K,,AUTO
         1 004747   000000 620006                    EAX0    0,QL
         1 004750   000002 470400 xsym               LDP0    B$PS$+2
         1 004751   200043 721100                    LXL1    K,,AUTO
         1 004752   040140 100545                    MLR     fill='040'O
         1 004753   200041 000010                    ADSC9   J,A,AUTO                 cn=0,n=*X0
         1 004754   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

     1223     6507    2         END;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:185  

     1224     6508    1      CALL HFF$WRITE1(0)ALTRET(NOWRITE);

   6508  1 004755   000021 630400 2                  EPPR0   17
         1 004756   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 004757   000000 701000 xent               TSX1    HFF$WRITE1
         1 004760   004764 702000 1                  TSX2    NOWRITE

     1225     6509    1      B$PS$(0)->FPT$GETDCB_V.DCB#=I;

   6509  1 004761   200040 720100                    LXL0    I,,AUTO
         1 004762   000000 470400 xsym               LDP0    B$PS$
         1 004763   000000 740100                    STX0    0,,PR0

   6509  1 004764                       NOWRITE      null
     1226     6510    1   NOWRITE:;
     1227     6511    1      GOTO RETRET;

   6511  1 004764   000637 710000 1                  TRA     RETRET

     1228     6512                    /**/
     1229     6513        %EJECT;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:186  
     1230     6514                    /*F*   NAME:      FMM$MRGAMR
     1231     6515                    *
     1232     6516                    *      PURPOSE:   To merge assignments for a single DCB pointed to
     1233     6517                    *                 by B$JIT.DCB$.
     1234     6518                    *
     1235     6519                    */
     1236     6520    1   FMM$MRGAMR: ENTRY;

   6520  1 004765   000000 700200 xent  FMM$MRGAMR   TSX0  ! X66_AUTO_0
         1 004766   000054 000000                    ZERO    44,0

     1237     6521                    /**/
     1238     6522    1      JDCB$=B$JIT.DCB$;

   6522  1 004767   000000 470400 xsym               LDP0    B$JIT$
         1 004770   000232 236100                    LDQ     154,,PR0
         1 004771   200003 756100                    STQ     JDCB$,,AUTO

     1239     6523    1      TDCB$=JDCB$;

   6523  1 004772   200044 756100                    STQ     TDCB$,,AUTO

     1240     6524    1      CALL FMM$SCRUB1(TDCB$);

   6524  1 004773   200044 631500                    EPPR1   TDCB$,,AUTO
         1 004774   200050 451500                    STP1    I+1,,AUTO
         1 004775   200050 630500                    EPPR0   I+1,,AUTO
         1 004776   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 004777   000000 701000 xent               TSX1    FMM$SCRUB1
         1 005000   000000 011000                    NOP     0

     1241     6525    1      CALL FMM$GETAMR(TDCB$,BUF$)ALTRET(RETRET);

   6525  1 005001   200005 630500                    EPPR0   BUF$,,AUTO
         1 005002   200051 450500                    STP0    I+2,,AUTO
         1 005003   200044 631500                    EPPR1   TDCB$,,AUTO
         1 005004   200050 451500                    STP1    I+1,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:187  
         1 005005   200050 630500                    EPPR0   I+1,,AUTO
         1 005006   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 005007   000000 701000 xent               TSX1    FMM$GETAMR
         1 005010   000637 702000 1                  TSX2    RETRET

     1242     6526    1      CALL FMM$MERGE1;

   6526  1 005011   001672 701000 1                  TSX1    FMM$MERGE1
         1 005012   000000 011000                    NOP     0

     1243     6527    1      GOTO RETRET;

   6527  1 005013   000637 710000 1                  TRA     RETRET

     1244     6528                    /**/
     1245     6529        %EJECT;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:188  
     1246     6530                    /*F*
     1247     6531                    *     NAME:   FMM$RELDCB
     1248     6532                    *
     1249     6533                    *     PURPOSE:   TO RELEASE A DCB AND RETURN ALL ITS ASSOCIATED DCB
     1250     6534                    *                SEGMENT SPACE.
     1251     6535                    */
     1252     6536    1   FMM$RELDCB: ENTRY;

   6536  1 005014   000000 700200 xent  FMM$RELDCB   TSX0  ! X66_AUTO_0
         1 005015   000054 000000                    ZERO    44,0

     1253     6537                    /**/
     1254     6538    1      I=B$PS$(0)->FPT$RELDCB_V.DCB#;

   6538  1 005016   000000 470400 xsym               LDP0    B$PS$
         1 005017   000000 236100                    LDQ     0,,PR0
         1 005020   000022 772000                    QRL     18
         1 005021   200040 756100                    STQ     I,,AUTO

     1255     6539    1      GOTO RELDCBI;

   6539  1 005022   005031 710000 1                  TRA     RELDCBI

     1256     6540    1   FMM$RELDCBI: ENTRY;

   6540  1 005023   000000 700200 xent  FMM$RELDCBI  TSX0  ! X66_AUTO_0
         1 005024   000054 000000                    ZERO    44,0

     1257     6541                    /*F*  NAME:   FMM$RELDCBI
     1258     6542                    *     PURPOSE: To release a dcb by number without need for a CLIMB.
     1259     6543                    *        DESCRIPTION: The dcbnumber is in B$JIT.DCBNO
     1260     6544                    */
     1261     6545    1      I=B$JIT.DCBNO;

   6545  1 005025   000000 470400 xsym               LDP0    B$JIT$
         1 005026   000022 236100                    LDQ     18,,PR0
         1 005027   000777 376007                    ANQ     511,DL
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:189  
         1 005030   200040 756100                    STQ     I,,AUTO

   6545  1 005031                       RELDCBI      null
     1262     6546    1   RELDCBI:;
     1263     6547    1      IF I < 5

   6547  1 005031   000005 116007                    CMPQ    5,DL
         1 005032   005137 602000 1                  TNC     FMME$BADDCB#
         1 005033   000000 470400 xsym               LDP0    B$ROSEG$
         1 005034   000002 236100                    LDQ     2,,PR0
         1 005035   000022 772000                    QRL     18
         1 005036   200040 116100                    CMPQ    I,,AUTO
         1 005037   005137 602000 1                  TNC     FMME$BADDCB#
         1 005040   000000 471500                    LDP1    0,,PR0
         1 005041   200040 720100                    LXL0    I,,AUTO
         1 005042   100000 236110                    LDQ     0,X0,PR1
         1 005043   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 005044   005137 600000 1                  TZE     FMME$BADDCB#

     1264     6548    1        OR I > B$ROSEG$->B$ROSEG.NUMDCBS
     1265     6549    1        OR B$ROSEG$->B$ROSEG.DCBPTR$->DCBP(I)=ADDR(NIL)
     1266     6550    1      THEN GOTO FMME$BADDCB#;
     1267     6551                    /*E*     ERROR: FMM-E$BADDCB#-E
     1268     6552                    *        MESSAGE: Nonexistent DCBs cannot be released.
     1269     6553                    */
     1270     6554    1      JDCB$=B$ROSEG$->B$ROSEG.DCBPTR$->DCBP(I);

   6554  1 005045   200003 756100                    STQ     JDCB$,,AUTO

     1271     6555    1      B$JIT$->B$JIT.DCB$=JDCB$;

   6555  1 005046   000000 473400 xsym               LDP3    B$JIT$
         1 005047   300232 756100                    STQ     154,,PR3

     1272     6556    1      IF F$DCB.FCD

   6556  1 005050   200003 471500                    LDP1    JDCB$,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:190  
         1 005051   100031 236100                    LDQ     25,,PR1
         1 005052   020000 316007                    CANQ    8192,DL
         1 005053   005120 601000 1                  TNZ     ERR1

     1273     6557    1      THEN GOTO ERR1;
     1274     6558                    /*E*     ERROR: FMM-E$DCBOPEN-E
     1275     6559                    *        MESSAGE1:DCB% %DC% must be closed before open or release.
     1276     6560                    */
     1277     6561    1      TDCB$=JDCB$;

   6561  1 005054   200003 236100                    LDQ     JDCB$,,AUTO
         1 005055   200044 756100                    STQ     TDCB$,,AUTO

     1278     6562    1      CALL FMM$SCRUB(TDCB$); /* Release any TAB$, etc. */

   6562  1 005056   200044 634500                    EPPR4   TDCB$,,AUTO
         1 005057   200050 454500                    STP4    I+1,,AUTO
         1 005060   200050 630500                    EPPR0   I+1,,AUTO
         1 005061   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 005062   000000 701000 xent               TSX1    FMM$SCRUB
         1 005063   000000 011000                    NOP     0

     1279     6563    1      CALL FSA$FSP(SIZEW(JDCB$->F$DCB),TDCB$);

   6563  1 005064   200003 470500                    LDP0    JDCB$,,AUTO
         1 005065   000140 236100                    LDQ     96,,PR0
         1 005066   000033 772000                    QRL     27
         1 005067   000037 376007                    ANQ     31,DL
         1 005070   000601 620006                    EAX0    385,QL
         1 005071   000000 636010                    EAQ     0,X0
         1 005072   000022 772000                    QRL     18
         1 005073   000011 402007                    MPY     9,DL
         1 005074   000043 036007                    ADLQ    35,DL
         1 005075   000044 506007                    DIV     36,DL
         1 005076   200050 756100                    STQ     I+1,,AUTO
         1 005077   200044 631500                    EPPR1   TDCB$,,AUTO
         1 005100   200053 451500                    STP1    I+4,,AUTO
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:191  
         1 005101   200050 633500                    EPPR3   I+1,,AUTO
         1 005102   200052 453500                    STP3    I+3,,AUTO
         1 005103   200052 630500                    EPPR0   I+3,,AUTO
         1 005104   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 005105   000000 701000 xent               TSX1    FSA$FSP
         1 005106   000000 011000                    NOP     0

     1280     6564    1      B$ROSEG$->B$ROSEG.DCBPTR$->DCBP(I)=ADDR(NIL);

   6564  1 005107   000000 470400 xsym               LDP0    B$ROSEG$
         1 005110   000000 471500                    LDP1    0,,PR0
         1 005111   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 005112   200040 720100                    LXL0    I,,AUTO
         1 005113   100000 756110                    STQ     0,X0,PR1

     1281     6565    1      B$JIT$->B$JIT.DCB$=ADDR(NIL);

   6565  1 005114   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 005115   000000 470400 xsym               LDP0    B$JIT$
         1 005116   000232 756100                    STQ     154,,PR0

     1282     6566    1      RETURN;

   6566  1 005117   000000 702200 xent               TSX2  ! X66_ARET

     1283     6567                    /**/
     1284     6568        %EJECT;
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:192  
     1285     6569                    /*
     1286     6570                    *  ALL ERRORS FROM FMM$OPN ARE PROCESSED HERE.
     1287     6571                    */
     1288     6572    1   ERR1: B$JIT.ERR=FMM$E$DCBOPEN;

   6572  1 005120   000030 236000 0     ERR1         LDQ     FMM$E$DCBOPEN
         1 005121   000000 470400 xsym               LDP0    B$JIT$
         1 005122   000012 756100                    STQ     10,,PR0

     1289     6573    1      RETURN;

   6573  1 005123   000000 702200 xent               TSX2  ! X66_ARET

     1290     6574    1   NOSLOTS: B$JIT.ERR=FMM$E$NOSLOTS;

   6574  1 005124   000031 236000 0     NOSLOTS      LDQ     FMM$E$NOSLOTS
         1 005125   000000 471400 xsym               LDP1    B$JIT$
         1 005126   100012 756100                    STQ     10,,PR1

     1291     6575    1      RETURN;

   6575  1 005127   000000 702200 xent               TSX2  ! X66_ARET

     1292     6576    1   ERR5: B$JIT.ERR=FMM$E$DCBHERE;

   6576  1 005130   000033 236000 0     ERR5         LDQ     FMM$E$DCBHERE
         1 005131   100012 756100                    STQ     10,,PR1

     1293     6577    1      RETURN;

   6577  1 005132   000000 702200 xent               TSX2  ! X66_ARET

     1294     6578    1   FMME$DOMAIN: B$JIT.ERR=FMM$E$DOMAIN;

   6578  1 005133   000044 236000 0     FMME$DOMAIN  LDQ     FMM$E$DOMAIN
         1 005134   000000 470400 xsym               LDP0    B$JIT$
         1 005135   000012 756100                    STQ     10,,PR0
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:193  

     1295     6579    1      RETURN;

   6579  1 005136   000000 702200 xent               TSX2  ! X66_ARET

     1296     6580    1   FMME$BADDCB#: B$JIT.ERR=FMM$E$BADDCB#;

   6580  1 005137   000045 236000 0     FMME$BADDCB# LDQ     FMM$E$BADDCB#
         1 005140   000000 470400 xsym               LDP0    B$JIT$
         1 005141   000012 756100                    STQ     10,,PR0

     1297     6581    1      RETURN;

   6581  1 005142   000000 702200 xent               TSX2  ! X66_ARET

     1298     6582    1   ERR6: B$JIT.ERR=FMM$E$BADDCBNAME;

   6582  1 005143   000032 236000 0     ERR6         LDQ     FMM$E$BADDCBNAME
         1 005144   000000 470400 xsym               LDP0    B$JIT$
         1 005145   000012 756100                    STQ     10,,PR0

     1299     6583    1      RETURN;

   6583  1 005146   000000 702200 xent               TSX2  ! X66_ARET

     1300     6584    1   ERR3: B$JIT.ERR=FMM$E$INVASN;

   6584  1 005147   000034 236000 0     ERR3         LDQ     FMM$E$INVASN
         1 005150   000000 473400 xsym               LDP3    B$JIT$
         1 005151   300012 756100                    STQ     10,,PR3

     1301     6585    1      GOTO RETRET;

   6585  1 005152   000637 710000 1                  TRA     RETRET

     1302     6586    1   ERRORX: B$JIT.ERR=B$JIT.ERR&FMM$E$CODE|FMM$E$NOCODE;

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:194  
   6586  1 005153   000000 470400 xsym  ERRORX       LDP0    B$JIT$
         1 005154   000012 236100                    LDQ     10,,PR0
         1 005155   000036 376000 0                  ANQ     FMM$E$CODE
         1 005156   000035 276000 0                  ORQ     FMM$E$NOCODE
         1 005157   000012 756100                    STQ     10,,PR0

     1303     6587    1      GOTO RETRET;

   6587  1 005160   000637 710000 1                  TRA     RETRET

FM_DFLOPN_V
 Sect OctLoc
   0     000   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     024*  000000 000000   000000 000000   000000 000000   000000 000000    ................

FMM$E$DCBOPEN
 Sect OctLoc
   0     030   061515 001440                                                    1...

FMM$E$NOSLOTS
 Sect OctLoc
   0     031   061515 001502                                                    1...

FMM$E$BADDCBNAME
 Sect OctLoc
   0     032   061515 001512                                                    1...

FMM$E$DCBHERE
 Sect OctLoc
   0     033   061515 001470                                                    1...

FMM$E$INVASN
 Sect OctLoc
   0     034   061515 001452                                                    1...

FMM$E$NOCODE
 Sect OctLoc
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:195  
   0     035   061515 000002                                                    1...

FMM$E$CODE
 Sect OctLoc
   0     036   000000 777770                                                    ....

FMM$E$BADVECT2
 Sect OctLoc
   0     037   061515 006462                                                    1...

FMM$E$BADVECT14
 Sect OctLoc
   0     040   061515 006622                                                    1...

FMM$E$BADVECT15
 Sect OctLoc
   0     041   061515 006632                                                    1...

(unnamed)
 Sect OctLoc
   0     042   061515 006642                                                    1...

FMM$E$BADVECT17
 Sect OctLoc
   0     043   061515 006652                                                    1...

FMM$E$DOMAIN
 Sect OctLoc
   0     044   061515 006262                                                    1...

FMM$E$BADDCB#
 Sect OctLoc
   0     045   061515 006242                                                    1...

FUN
 Sect OctLoc
   0     046   000000 000002   000000 000002   000000 000002   000000 000001    ................
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:196  
   0     052   000000 000001                                                    ....

(unnamed)
 Sect OctLoc
   0     053   200000 000000   100000 000000   117104 040040   004115 044000    ....@...OD  .M$.
   0     057   106044 040040   115105 040040   116117 040040                    F$  ME  NO

(unnamed)
 Sect OctLoc
   2     000   000000 006003   000004 006000   000015 006000   000000 000024    ................
   2     004   000003 006000   777777 377777   777377 777777   777577 777777    ................
   2     010   777737 777777   777677 777777   777767 777777   777757 777777    ................
   2     014   000012 006000   000000 000052   000015 006000   000000 000022    .......*........
   2     020   000017 006000   000002 006000   000000 006000   000000 000000    ................
   2     024   040040 040040   040040 040040   000002 006000   000003 006000            ........
   2     030   777777 757777   777007 777777   000040 040040   000000 000047    .........   ...'
   2     034   000033 006000   001777 777776   000000 000016   000036 006000    ................
   2     040   000000 000017   000040 006000   000000 000021   000042 006000    ..... ......."..
     1304     6588    1   END FMM$OPN;
     1305     6589        %EOD;

PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:197  
--  Include file information  --

   UD_ERRORS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   FM_OPLBL_R.:E05TOU  cannot be made into a system file and is referenced.
   F$CP6V_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   FM$MACROS.:E05TOU  is referenced.
   FM_FIELD_C.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   KC_CP6.:E05TOU  is referenced.
   F$CP6P_C.:E05TOU  is referenced.
   F_CP6.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
      No diagnostics issued in procedure FMM$OPN.
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:198  

 **** Variables and constants ****

  ****  Section 000 RoData FMM$OPN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    45-0-0/b STRC        r     1 FMM$E$BADDCB#             32-0-0/b STRC        r     1 FMM$E$BADDCBNAME
    40-0-0/b STRC        r     1 FMM$E$BADVECT14           41-0-0/b STRC        r     1 FMM$E$BADVECT15
    43-0-0/b STRC        r     1 FMM$E$BADVECT17           37-0-0/b STRC        r     1 FMM$E$BADVECT2
    36-0-0/b STRC        r     1 FMM$E$CODE                33-0-0/b STRC        r     1 FMM$E$DCBHERE
    30-0-0/b STRC        r     1 FMM$E$DCBOPEN             44-0-0/b STRC        r     1 FMM$E$DOMAIN
    34-0-0/b STRC        r     1 FMM$E$INVASN              35-0-0/b STRC        r     1 FMM$E$NOCODE
    31-0-0/b STRC        r     1 FMM$E$NOSLOTS
     0-0-0/b BIT (72)    r     1 FM_DFLOPN_V(0:11)
    46-0-0/w UBIN        r     1 FUN(0:4)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     7-0-0/w PTR         r     1 ALTKEY$                   42-0-0/w BIT         r     1 AMRF
     5-0-0/w PTR         r     1 BUF$                      13-0-0/w PTR         r     1 FIELD$
    43-0-0/w STRC        r     1 FN                         4-0-0/w PTR         r     1 FPT$
    40-0-0/w UBIN        r     1 I                         47-0-0/w UBIN        r     1 I
    15-0-0/w PTR         r     1 IRREC$                    41-0-0/w UBIN        r     1 J
     3-0-0/w PTR         r     1 JDCB$                     43-0-0/w UBIN        r     1 K
    10-0-0/w PTR         r     1 KFIELD$                   11-0-0/w SBIN        r     1 N
    12-0-0/w SBIN        r     1 NKEYS                     16-0-0/w PTR         r     1 PN$(0:17)
    14-0-0/w PTR         r     1 START$                    44-0-0/w PTR         r     1 TDCB$
     6-0-0/w PTR         r     1 TEMP$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:199  

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$PS$(0:19)
     0-0-0/w PTR         r     1 B$ROSEG$                   0-0-0/w PTR         r     1 B$XL_UPPER_UR$
     0-0-0/c CHAR(100)   r     1 FMM$SDCB                   0-0-0/c CHAR(2)     r     1 F_OPLBL(0:8191)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN(18)    r     1 AMRX(0:15)                 0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/d STRC(3024)  r     1 B$ROSEG                    0-0-0/d STRC(4608)  r     1 B$XL_UPPER_UR
     0-0-0/w STRC(1404)  r     1 CODE16                     0-0-0/w PTR         r     1 DCBP(0:0)
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/c ASTR(9)     r     1 FF
     0-0-0/w STRC(4572)  r     1 FITALTKEYS                 0-0-0/w STRC(72)    r     1 FM$FIELD_START
     0-0-0/w STRC(180)   r     1 FM$GRAN                    0-0-0/d STRC(72)    r     1 FPT$GETDCB_V
     0-0-0/d STRC(756)   r     1 FPT$OPEN_V                 0-0-0/d STRC(72)    r     1 FPT$RELDCB_V
     0-0-0/w STRC(81)    r     1 KFIELD                     0-0-0/c ASTR(0)     r     1 MOVEJB
     0-0-0/c ASTR(0)     r     1 MOVEKB                     0-0-0/c ACHR        r     1 MOVEKC
     0-0-0/c STRC(45)    r     1 NAME                       0-0-0/c STRC(72)    r     1 VLP$ACCT
     0-0-0/d STRC(72)    r     1 VLP$ALTKEYS                0-0-0/c STRC(54)    r     1 VLP$FORM
     0-0-0/d STRC(612)   r     1 VLP$FPRG                   0-0-0/w STRC(54)    r     1 VLP$HDR
     0-0-0/w STRC(1512)  r     1 VLP$HDRF                   0-0-0/d STRC(54)    r     1 VLP$IRKEYS
     0-0-0/d STRC(45)    r     1 VLP$IRREC                  0-0-0/c STRC(72)    r     1 VLP$PASS
     0-0-0/d STRC(54)    r     1 VLP$RECFIELD               0-0-0/w STRC(432)   r     1 VLP$SETSTA
     0-0-0/d STRC(90)    r     1 VLP$SN                     0-0-0/w STRC(288)   r     1 VLP$STATION
     0-0-0/w STRC(288)   r     1 VLP$TAB                    0-0-0/w STRC(432)   r     1 VLP$VIRTUAL_V
     0-0-0/c STRC(72)    r     1 VLP$WSN


   Procedure FMM$OPN requires 2673 words for executable code.
   Procedure FMM$OPN requires 44 words of local(AUTO) storage.
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:200  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:201  
          MINI XREF LISTING

ALTKEY$
      5471**DCL      3497--IMP-PTR  5628<>CALL     5652<<ASSIGN   5653>>ASSIGN   5654<>CALL     5658<<ASSIGN
      5659<>CALL     6319<<ASSIGN   6320<>CALL     6325<<ASSIGN   6326>>ASSIGN   6327<>CALL     6348<>CALL
      6350>>ASSIGN   6351>>ASSIGN   6352>>ASSIGN   6359>>ASSIGN   6361>>ASSIGN   6362>>ASSIGN   6363>>ASSIGN
      6405<>CALL     6406>>ASSIGN   6408<<ASSIGN   6409>>ASSIGN   6412<<ASSIGN   6413>>ASSIGN   6414<>CALL
AMRCONT
      5907**LABEL    5908--CALLALT
AMRF
      5481**DCL      5677<<ASSIGN   5798<<ASSIGN   5804>>ASSIGN   5811<<ASSIGN   5863>>IF       5995<<ASSIGN
      6143>>IF       6154>>ASSIGN   6161>>IF       6171>>ASSIGN   6174>>ASSIGN   6177>>ASSIGN   6180>>ASSIGN
      6183>>ASSIGN   6187>>ASSIGN   6214>>IF       6266>>IF       6289>>IF       6339>>IF       6369>>IF
      6388>>IF
AMRX
      5485**DCL      5767>>ASSIGN   5769>>ASSIGN   5771>>ASSIGN   5773>>ASSIGN   5775>>ASSIGN   5777>>ASSIGN
      5990>>IF       5992>>IF       5993>>ASSIGN
AMR_LOST
      5777**LABEL    5765--CALLALT
B$JIT.CALCNT
      4509**DCL      5803>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
      4436**DCL      4436--REDEF
B$JIT.DCB$
      4503**DCL      5507>>ASSIGN   5733>>ASSIGN   5737>>ASSIGN   5743>>ASSIGN   5901>>ASSIGN   5902<<ASSIGN
      5907<<ASSIGN   5964<<ASSIGN   5967<<ASSIGN   6493<<ASSIGN   6522>>ASSIGN   6555<<ASSIGN   6565<<ASSIGN
B$JIT.DCBNO
      4423**DCL      6458<<ASSIGN   6545>>ASSIGN
B$JIT.ERR
      4342**DCL      5550<<ASSIGN   5843>>IF       5965<<ASSIGN   6146<<ASSIGN   6219<<ASSIGN   6271<<ASSIGN
      6292<<ASSIGN   6355<<ASSIGN   6379<<ASSIGN   6393<<ASSIGN   6500<<ASSIGN   6572<<ASSIGN   6574<<ASSIGN
      6576<<ASSIGN   6578<<ASSIGN   6580<<ASSIGN   6582<<ASSIGN   6584<<ASSIGN   6586<<ASSIGN   6586>>ASSIGN
B$JIT.ERR.MID
      4343**DCL      4343--REDEF
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:202  
B$JIT.FACCN
      4342**DCL      5787>>ASSIGN
B$JIT.FEXT
      4503**DCL      5589<<ASSIGN   6161<<ASSIGN
B$JIT.FPSN
      4423**DCL      5788>>ASSIGN
B$JIT.PNR
      4510**DCL      4510--REDEF
B$JIT.PRIV.ACTIVE
      4343**DCL      5560>>IF       5791>>IF       5791>>IF
B$JIT$
      5366**DCL      4337--IMP-PTR  5507>>ASSIGN   5550>>ASSIGN   5560>>IF       5589>>ASSIGN   5733>>ASSIGN
      5737>>ASSIGN   5743>>ASSIGN   5787>>ASSIGN   5788>>ASSIGN   5791>>IF       5791>>IF       5803>>ASSIGN
      5843>>IF       5901>>ASSIGN   5902>>ASSIGN   5907>>ASSIGN   5964>>ASSIGN   5965>>ASSIGN   5967>>ASSIGN
      6146>>ASSIGN   6161>>ASSIGN   6219>>ASSIGN   6271>>ASSIGN   6292>>ASSIGN   6355>>ASSIGN   6379>>ASSIGN
      6393>>ASSIGN   6458>>ASSIGN   6493>>ASSIGN   6500>>ASSIGN   6522>>ASSIGN   6545>>ASSIGN   6555>>ASSIGN
      6565>>ASSIGN   6572>>ASSIGN   6574>>ASSIGN   6576>>ASSIGN   6578>>ASSIGN   6580>>ASSIGN   6582>>ASSIGN
      6584>>ASSIGN   6586>>ASSIGN   6586>>ASSIGN
B$PS$
      5364**DCL      5514>>ASSIGN   5534>>ASSIGN   5556>>IF       5556>>IF       5559>>ASSIGN   5560>>IF
      5572>>ASSIGN   6448>>ASSIGN   6456>>ASSIGN   6468>>IF       6472>>IF       6492>>ASSIGN   6496>>IF
      6506>>ASSIGN   6509>>ASSIGN   6538>>ASSIGN
B$ROSEG.DCBPTR$
      3517**DCL      6487>>ASSIGN   6547>>IF       6554>>ASSIGN   6564>>ASSIGN
B$ROSEG.NUMDCBS
      3519**DCL      5921>>DOWHILE  6466>>DOINDEX  6476>>DOINDEX  6547>>IF
B$ROSEG$
      5365**DCL      5626>>ASSIGN   5633>>ASSIGN   5644>>ASSIGN   5652>>ASSIGN   5658>>ASSIGN   5664>>ASSIGN
      5921>>DOWHILE  6191>>ASSIGN   6198>>ASSIGN   6235>>ASSIGN   6249>>ASSIGN   6281>>ASSIGN   6319>>ASSIGN
      6325>>ASSIGN   6332>>ASSIGN   6352>>ASSIGN   6406>>ASSIGN   6408>>ASSIGN   6412>>ASSIGN   6419>>ASSIGN
      6466>>DOINDEX  6476>>DOINDEX  6487>>ASSIGN   6547>>IF       6547>>IF       6554>>ASSIGN   6564>>ASSIGN
B$XL_UPPER_UR
      4020**DCL      6047>>CALLBLT
B$XL_UPPER_UR$
      4019**DCL      4020--IMP-PTR  6047>>CALLBLT
BUF$
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:203  
      5469**DCL      5485--IMP-PTR  5541<>CALL     5765<>CALL     5767>>ASSIGN   5767>>ASSIGN   5769>>ASSIGN
      5769>>ASSIGN   5771>>ASSIGN   5771>>ASSIGN   5773>>ASSIGN   5773>>ASSIGN   5775>>ASSIGN   5775>>ASSIGN
      5777>>ASSIGN   5777>>ASSIGN   5903<>CALL     5953<>CALL     5990>>IF       5992>>IF       5993>>ASSIGN
      5993>>ASSIGN   6497<>CALL     6525<>CALL
CODE16
      3489**DCL      6118--CALL     6119<<ASSIGN   6309--CALL     6310<<ASSIGN
CODE16.COPIES
      3491**DCL      6121<<ASSIGN
CODE16.FORM
      3489**DCL      6312<<ASSIGN
CONTOPN
      5671**LABEL    5570--CALLALT  5573--GOTO
DCBP
      5486**DCL      6487<<ASSIGN   6547>>IF       6554>>ASSIGN   6564<<ASSIGN
DFLOPNC
      5744**LABEL    5735--GOTO     5738--GOTO
ERASURES
      5578**LABEL    5571--CALLALT
ERR1
      6572**LABEL    5513--CALLALT  5519--GOTO     6557--GOTO
ERR3
      6584**LABEL    5857--GOTO
ERR5
      6576**LABEL    6459--GOTO
ERR6
      6582**LABEL    6450--GOTO
ERRORX
      6586**LABEL    5542--CALLALT  5563--CALLALT  5678--CALLALT  6485--CALLALT
ERRORX IN PROCEDURE FMM$MERGE1
      6433**LABEL    6118--CALLALT  6140--CALLALT  6231--CALLALT  6242--CALLALT  6277--CALLALT  6285--CALLALT
      6309--CALLALT  6348--CALLALT  6384--CALLALT  6405--CALLALT
F$DCB
      3570**DCL      5807--ASSIGN   6563--CALL
F$DCB.ACCT
      3580**DCL      5592<<ASSIGN   5784>>IF       5787<<ASSIGN   6164<<ASSIGN
F$DCB.ACS
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:204  
      3587**DCL      5791>>IF       5793<<ASSIGN   5838>>IF       6044<<ASSIGN
F$DCB.ACTPOS
      3595**DCL      3595--REDEF
F$DCB.AGE
      3614**DCL      5803<<ASSIGN
F$DCB.ALTKEYX
      3593**DCL      5651>>IF       5652>>ASSIGN   5655<<ASSIGN   5936<<ASSIGN   6324>>IF       6325>>ASSIGN
      6328<<ASSIGN   6352<<ASSIGN   6411>>IF       6412>>ASSIGN   6415<<ASSIGN
F$DCB.AMFLG
      3599**DCL      5763>>IF       5798>>ASSIGN   5804<<ASSIGN   5930<<ASSIGN
F$DCB.AMFLG.ACCF
      3599**DCL      5599<<ASSIGN   5766>>IF       6171<<ASSIGN
F$DCB.AMFLG.ACSF
      3599**DCL      5602<<ASSIGN   5768>>IF       6174<<ASSIGN
F$DCB.AMFLG.INSF
      3599**DCL      5608<<ASSIGN   5772>>IF       6180<<ASSIGN
F$DCB.AMFLG.PROF
      3600**DCL      5611<<ASSIGN   5774>>IF       6183<<ASSIGN
F$DCB.AMFLG.SNLF
      3600**DCL      5615<<ASSIGN   5776>>IF       6187<<ASSIGN
F$DCB.AMFLG.USRF
      3600**DCL      5605<<ASSIGN   5770>>IF       6177<<ASSIGN
F$DCB.AMR
      3583**DCL      5997<<ASSIGN
F$DCB.AMRSETSTA
      3582**DCL      6154<<ASSIGN
F$DCB.ANSISPANSEQ
      3597**DCL      6085<<ASSIGN
F$DCB.ARS
      3570**DCL      3570--REDEF
F$DCB.ASN
      3585**DCL      5511>>IF       5556>>IF       5790>>ASSIGN   5810>>ASSIGN   5815>>IF       5817>>DOCASE
      5828>>IF       5843>>IF       6030>>IF       6032<<ASSIGN   6137>>IF       6209>>IF       6209>>IF
      6260>>IF       6260>>IF       6315>>IF       6315>>IF       6389>>IF
F$DCB.ATTR
      3588**DCL      3589--REDEF
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:205  
F$DCB.AU
      3581**DCL      6100<<ASSIGN
F$DCB.BFR
      3614**DCL      5539<<ASSIGN   5750<<ASSIGN   5800>>ASSIGN   5806<<ASSIGN
F$DCB.BFR.BUFX
      3615**DCL      5685>>IF       5764>>IF
F$DCB.BFR1
      3615**DCL      5799>>ASSIGN   5805<<ASSIGN
F$DCB.BLKL
      3585**DCL      5840<<ASSIGN   6062<<ASSIGN
F$DCB.BLOCKED
      3584**DCL      6055<<ASSIGN
F$DCB.BORROW
      3603**DCL      3603--REDEF    3603--REDEF    3603--REDEF
F$DCB.BUPM
      3584**DCL      6084<<ASSIGN
F$DCB.CFU$
      3604**DCL      5809<<ASSIGN
F$DCB.CHAIN
      3590**DCL      6066<<ASSIGN
F$DCB.CNVRT
      3582**DCL      6070<<ASSIGN
F$DCB.CODE16$
      3594**DCL      5942<<ASSIGN
F$DCB.COMP
      3583**DCL      6093<<ASSIGN
F$DCB.CTG
      3583**DCL      6092<<ASSIGN
F$DCB.CVOL
      3584**DCL      6073<<ASSIGN
F$DCB.DCB#
      3597**DCL      5537<<ASSIGN   6495<<ASSIGN
F$DCB.DCBNAME
      3616**DCL      5801--ASSIGN   5948--ASSIGN   6484--ASSIGN
F$DCB.DCBNAME.L
      3617**DCL      3617--IMP-SIZ  5998>>IF       6468>>IF       6468>>IF       6490<<ASSIGN   6492>>ASSIGN
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:206  
      6563>>CALL
F$DCB.DCBNAME.N
      3617**DCL      5998>>IF       6468>>IF       6492<<ASSIGN
F$DCB.DCBNAME.S
      3616**DCL      5925>>IF
F$DCB.DCBNAME.X
      3616**DCL      5947>>ASSIGN
F$DCB.DENSITY
      3590**DCL      6067<<ASSIGN
F$DCB.DISP
      3585**DCL      6045<<ASSIGN
F$DCB.DVFC
      3591**DCL      6108<<ASSIGN
F$DCB.EBCDIC
      3582**DCL      6072<<ASSIGN
F$DCB.EOMCHAR
      3574**DCL      3574--REDEF
F$DCB.EVENT
      3594**DCL      6110<<ASSIGN
F$DCB.EXIST
      3583**DCL      6090<<ASSIGN
F$DCB.EXPIRE
      3586**DCL      6049<<ASSIGN
F$DCB.FCD
      3583**DCL      5510>>IF       5687>>ASSIGN   5929<<ASSIGN   6556>>IF
F$DCB.FCI
      3583**DCL      5687<<ASSIGN
F$DCB.FEXT
      3598**DCL      5801--ASSIGN   5802--ASSIGN
F$DCB.FEXTX
      3586**DCL      5589>>ASSIGN   5947<<ASSIGN   5951<<ASSIGN   6161>>ASSIGN
F$DCB.FFLG.EXEC
      3575**DCL      5863<<ASSIGN
F$DCB.FIELDX
      3594**DCL      5625>>IF       5626>>ASSIGN   5629<<ASSIGN   5938<<ASSIGN   6190>>IF       6191>>ASSIGN
      6194<<ASSIGN   6235<<ASSIGN
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:207  
F$DCB.FLDID
      3598**DCL      3598--REDEF
F$DCB.FORM$
      3592**DCL      3592--REDEF    5931<<ASSIGN   6117>>IF       6118<>CALL     6119>>ASSIGN   6121>>ASSIGN
      6308>>IF       6309<>CALL     6310>>ASSIGN   6312>>ASSIGN
F$DCB.FPRGX
      3594**DCL      5657>>IF       5658>>ASSIGN   5660<<ASSIGN   5937<<ASSIGN   6318>>IF       6319>>ASSIGN
      6321<<ASSIGN   6404>>IF       6406<<ASSIGN   6408>>ASSIGN
F$DCB.FSECT
      3608**DCL      3608--REDEF
F$DCB.FSN
      3585**DCL      3585--REDEF    3585--REDEF    3586--REDEF    6068<<ASSIGN
F$DCB.FUN
      3584**DCL      5790>>IF       5790>>IF       5790<<ASSIGN   5791>>IF       5999<<ASSIGN   6039<<ASSIGN
      6354>>IF
F$DCB.GHSTACS
      3593**DCL      6083<<ASSIGN
F$DCB.HEADER$
      3591**DCL      3591--REDEF    5640>>IF       5641<>CALL     5933<<ASSIGN   6257>>IF       6258<>CALL
      6284>>IF       6285<>CALL     6302>>ASSIGN
F$DCB.IASN
      3611**DCL      5810<<ASSIGN   5841<<ASSIGN   5844<<ASSIGN
F$DCB.IGNOREFSN
      3581**DCL      6061<<ASSIGN
F$DCB.IOERROK
      3582**DCL      6059<<ASSIGN
F$DCB.IRRECX
      3598**DCL      5643>>IF       5644>>ASSIGN   5647<<ASSIGN   5941<<ASSIGN   6248>>IF       6249>>ASSIGN
      6252<<ASSIGN   6281<<ASSIGN
F$DCB.IXTNSIZE
      3589**DCL      3589--REDEF    5839<<ASSIGN   6077<<ASSIGN
F$DCB.JRNLBYPASS
      3593**DCL      6104<<ASSIGN
F$DCB.KEYL
      3587**DCL      6087<<ASSIGN
F$DCB.KEYTYPE
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:208  
      3594**DCL      6050<<ASSIGN
F$DCB.KEYX
      3586**DCL      6088<<ASSIGN
F$DCB.KFIELDX
      3595**DCL      5663>>IF       5664>>ASSIGN   5939<<ASSIGN   6331>>IF       6332>>ASSIGN   6335<<ASSIGN
      6418>>IF       6419>>ASSIGN   6422<<ASSIGN
F$DCB.LASTSTA$
      3579**DCL      3579--REDEF    5582>>IF       5583<>CALL     5934<<ASSIGN   6034>>IF       6035<>CALL
      6139>>IF       6140<>CALL     6142>>ASSIGN
F$DCB.LINES
      3591**DCL      6109<<ASSIGN
F$DCB.LOAD
      3581**DCL      6094<<ASSIGN
F$DCB.LRDL0
      3587**DCL      6081<<ASSIGN
F$DCB.LSLIDE
      3587**DCL      6080<<ASSIGN
F$DCB.LSTAOR
      3582**DCL      6102<<ASSIGN
F$DCB.LVL
      3604**DCL      3604--REDEF
F$DCB.MAXVOL
      3590**DCL      6065<<ASSIGN
F$DCB.NAME.C
      3579**DCL      3579--REDEF    5588<<ASSIGN   6160<<ASSIGN
F$DCB.NAME.L
      3579**DCL      5587<<ASSIGN   6159<<ASSIGN
F$DCB.NOEOF
      3600**DCL      3600--REDEF
F$DCB.NRECS
      3590**DCL      3590--REDEF    6078<<ASSIGN
F$DCB.NRECX
      3609**DCL      3609--REDEF
F$DCB.OHDR
      3601**DCL      3601--REDEF
F$DCB.ORG
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:209  
      3584**DCL      3584--REDEF    5829>>IF       6043<<ASSIGN   6209>>IF       6209>>IF       6209>>IF
      6209>>IF       6209>>IF       6260>>IF       6260>>IF       6260>>IF       6260>>IF       6260>>IF
      6315>>IF       6315>>IF       6338>>IF
F$DCB.PASS
      3580**DCL      5596<<ASSIGN   5794>>IF       5795<>CALL     6168<<ASSIGN
F$DCB.PASSF
      3582**DCL      5595<<ASSIGN   5794>>IF       5796<<ASSIGN   6167<<ASSIGN
F$DCB.PRECNO
      3607**DCL      3607--REDEF
F$DCB.PSN
      3580**DCL      5616<<ASSIGN   5788>>IF       5788<<ASSIGN   6186<<ASSIGN
F$DCB.QISS
      3581**DCL      6101<<ASSIGN
F$DCB.RCSZ
      3612**DCL      3612--REDEF
F$DCB.RECL
      3585**DCL      6063<<ASSIGN
F$DCB.RES
      3580**DCL      3580--REDEF    6000<<ASSIGN   6033<<ASSIGN   6047<<CALLBLT  6389>>IF
F$DCB.RESNT.TYP
      3580**DCL      5822>>IF
F$DCB.SEED
      3598**DCL      6096<<ASSIGN
F$DCB.SEQ
      3591**DCL      6114<<ASSIGN
F$DCB.SEQCOL
      3591**DCL      6112<<ASSIGN
F$DCB.SEQID
      3591**DCL      6113<<ASSIGN
F$DCB.SETSTA$
      3579**DCL      5515>>ASSIGN   5516>>ASSIGN   5584<<ASSIGN   5807--ASSIGN   5829>>IF       5833>>ASSIGN
      5834>>ASSIGN   5935<<ASSIGN   6036<<ASSIGN   6142<<ASSIGN   6153>>ASSIGN
F$DCB.SETX
      3592**DCL      3592--REDEF
F$DCB.SHARE
      3583**DCL      5820>>IF       5821<<ASSIGN   6091<<ASSIGN
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:210  
F$DCB.SPANNED
      3584**DCL      6057<<ASSIGN
F$DCB.SPARE
      3587**DCL      6082<<ASSIGN
F$DCB.STARTX
      3595**DCL      5632>>IF       5633>>ASSIGN   5636<<ASSIGN   5940<<ASSIGN   6197>>IF       6198>>ASSIGN
      6201<<ASSIGN
F$DCB.TAB$
      3591**DCL      3592--REDEF    5622>>IF       5623<>CALL     5932<<ASSIGN   6206>>IF       6207<>CALL
      6241>>IF       6242<>CALL     6244>>ASSIGN
F$DCB.TDA
      3606**DCL      3606--REDEF
F$DCB.TYC
      3570**DCL      5799<<ASSIGN   5800<<ASSIGN   5805>>ASSIGN   5806>>ASSIGN   5864<<ASSIGN
F$DCB.TYPE
      3580**DCL      6048<<ASSIGN
F$DCB.UOPT
      3582**DCL      6124<<ASSIGN
F$DCB.VOL
      3590**DCL      6064<<ASSIGN
F$DCB.VOLACCESS
      3582**DCL      6069<<ASSIGN
F$DCB.WSN
      3581**DCL      3581--REDEF    5619<<ASSIGN   5815>>IF       6306<<ASSIGN
F$DCB.WSR
      3587**DCL      5536<<ASSIGN   5734<<ASSIGN   5744>>IF
F$DCB.XTEND
      3583**DCL      6071<<ASSIGN
F$DCB.XTNSIZE
      3587**DCL      6079<<ASSIGN
FF.CHARX
      5495**DCL      6158>>ASSIGN   6448>>ASSIGN
FF.RECX
      5496**DCL      6160>>ASSIGN   6468>>IF       6492>>ASSIGN
FIELD$
      5475**DCL      3067--IMP-PTR  5626<<ASSIGN   5627>>ASSIGN   6191<<ASSIGN   6192>>ASSIGN   6193<>CALL
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:211  
      6231<>CALL     6233>>ASSIGN   6234>>ASSIGN   6235>>ASSIGN
FITALTKEYS.K
      3498**DCL      6347--ASSIGN
FITALTKEYS.K.KEYL
      3498**DCL      6361<<ASSIGN
FITALTKEYS.K.KEYX
      3498**DCL      6362<<ASSIGN
FITALTKEYS.K.UNIQUE
      3499**DCL      6363<<ASSIGN
FITALTKEYS.NUMENTS
      3497**DCL      6359<<ASSIGN
FITALTKEYS.NUMWRDS
      3497**DCL      5653>>ASSIGN   6326>>ASSIGN   6351<<ASSIGN   6413>>ASSIGN
FM$FIELD_START.NWORDS
      3888**DCL      5634>>ASSIGN   6199>>ASSIGN
FM$GRAN
      3503**DCL      5562--ASSIGN
FMD$GETBUF
      5376**DCL-ENT  5903--CALL
FMD$RELBUF
      5377**DCL-ENT  5686--CALL     5966--CALL
FMF$REMOTE
      5378**DCL-ENT  5816--CALL
FMG$IRSETUP
      5396**DCL-ENT  6384--CALL
FMM$E$BADDCB#
      5455**DCL      6580>>ASSIGN
FMM$E$BADDCBNAME
      5411**DCL      6582>>ASSIGN
FMM$E$BADVECT14
      5435**DCL      6219>>ASSIGN
FMM$E$BADVECT15
      5439**DCL      6271>>ASSIGN   6292>>ASSIGN
FMM$E$BADVECT17
      5447**DCL      6355>>ASSIGN   6379>>ASSIGN   6393>>ASSIGN
FMM$E$BADVECT2
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:212  
      5431**DCL      6146>>ASSIGN
FMM$E$CODE
      5427**DCL      6586>>ASSIGN
FMM$E$DCBHERE
      5415**DCL      6576>>ASSIGN
FMM$E$DCBOPEN
      5403**DCL      6572>>ASSIGN
FMM$E$DOMAIN
      5451**DCL      6578>>ASSIGN
FMM$E$INVASN
      5419**DCL      6584>>ASSIGN
FMM$E$NOCODE
      5423**DCL      6586>>ASSIGN
FMM$E$NOSLOTS
      5407**DCL      6574>>ASSIGN
FMM$GETAMR
      5375**DCL-ENT  5541--CALL     5765--CALL     6497--CALL     6525--CALL
FMM$IFPARAM
      5371**DCL-ENT  5563--CALL
FMM$MERGE1
      5983**PROC     5542--CALL     5954--CALL     6498--CALL     6526--CALL
FMM$MERGE2 IN PROCEDURE FMM$MERGE1
      6023**ENTRY    5678--CALL
FMM$OPNAMR
      5379**DCL-ENT  5908--CALL
FMM$READAMR
      5380**DCL-ENT  5953--CALL
FMM$SCRAMBLE
      5374**DCL-ENT  5795--CALL
FMM$SCRUB
      5372**DCL-ENT  5535--CALL     5996--CALL     6562--CALL
FMM$SCRUB1
      5373**DCL-ENT  5926--CALL     6494--CALL     6524--CALL
FMM$SDCB
      5367**DCL      5808>>ASSIGN
FMME$BADDCB#
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:213  
      6580**LABEL    6550--GOTO
FMME$DOMAIN
      6578**LABEL    5525--GOTO     5744--GOTO
FMN$OPNF
      5389**DCL-ENT  5827--CALL     5842--CALL
FMO$GETDOMAIN
      5381**DCL-ENT  5509--CALL     6454--CALL
FMP$CLSTAR
      5382**DCL-ENT  5963--CALL
FM_DFLOPN_V
      5401**DCL      5751--ASSIGN
FN.L
      5493**DCL      6158<<ASSIGN   6287<<ASSIGN   6448<<ASSIGN
FOUNDDCB
      6496**LABEL    6470--GOTO     6474--GOTO
FOUNDSLOT
      6484**LABEL    6463--GOTO     6477--GOTO
FPO$OPNOD
      5391**DCL-ENT  5826--CALL
FPT.ACSVEH_
      2834**DCL      2834--REDEF
FPT.ALTKEYS_
      2836**DCL      2836--REDEF    2836--REDEF
FPT.HDR_
      2835**DCL      2835--REDEF
FPT.TAB_
      2835**DCL      2835--REDEF
FPT.UHL_
      2833**DCL      2833--REDEF    2833--REDEF
FPT.WSN_
      2835**DCL      2835--REDEF
FPT$
      5468**DCL      2833--IMP-PTR  2849--IMP-PTR  2862--IMP-PTR  2875--IMP-PTR  2888--IMP-PTR  2902--IMP-PTR
      2915--IMP-PTR  2928--IMP-PTR  2988--IMP-PTR  3015--IMP-PTR  3030--IMP-PTR  3051--IMP-PTR  3852--IMP-PTR
      5487--IMP-PTR  5514<<ASSIGN   5515>>ASSIGN   5516>>ASSIGN   5534<<ASSIGN   5535>>IF       5537>>ASSIGN
      5540>>IF       5948<<ASSIGN   5949>>IF       5950>>IF       6026<<ASSIGN   6030>>IF       6030>>IF
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:214  
      6032>>ASSIGN   6039>>IF       6039>>ASSIGN   6043>>IF       6043>>ASSIGN   6044>>IF       6044>>ASSIGN
      6045>>IF       6045>>ASSIGN   6046>>IF       6047>>CALLBLT  6048>>IF       6048>>ASSIGN   6049>>IF
      6049>>ASSIGN   6050>>IF       6050>>ASSIGN   6054>>IF       6055>>ASSIGN   6056>>IF       6057>>ASSIGN
      6058>>IF       6059>>ASSIGN   6060>>IF       6061>>ASSIGN   6062>>IF       6062>>ASSIGN   6063>>IF
      6063>>ASSIGN   6064>>IF       6064>>ASSIGN   6065>>IF       6065>>ASSIGN   6066>>IF       6066>>ASSIGN
      6067>>IF       6067>>ASSIGN   6068>>IF       6068>>ASSIGN   6069>>IF       6069>>ASSIGN   6070>>IF
      6070>>ASSIGN   6071>>IF       6071>>ASSIGN   6072>>IF       6072>>ASSIGN   6073>>IF       6073>>ASSIGN
      6077>>IF       6077>>ASSIGN   6078>>IF       6078>>ASSIGN   6079>>IF       6079>>ASSIGN   6080>>IF
      6080>>ASSIGN   6081>>IF       6081>>ASSIGN   6082>>IF       6082>>ASSIGN   6083>>IF       6083>>ASSIGN
      6084>>IF       6084>>ASSIGN   6085>>IF       6085>>ASSIGN   6086>>IF       6087>>ASSIGN   6088>>ASSIGN
      6090>>IF       6090>>ASSIGN   6091>>IF       6091>>ASSIGN   6092>>IF       6092>>ASSIGN   6093>>IF
      6093>>ASSIGN   6094>>IF       6094>>ASSIGN   6095>>IF       6096>>ASSIGN   6100>>IF       6100>>ASSIGN
      6101>>IF       6101>>ASSIGN   6102>>IF       6102>>ASSIGN   6103>>IF       6104>>ASSIGN   6108>>IF
      6108>>ASSIGN   6109>>IF       6109>>ASSIGN   6110>>IF       6110>>ASSIGN   6111>>IF       6112>>ASSIGN
      6113>>ASSIGN   6114>>ASSIGN   6116>>IF       6121>>ASSIGN   6124>>IF       6124>>ASSIGN   6133<<ASSIGN
      6153>>ASSIGN   6158>>ASSIGN   6160>>ASSIGN   6164>>ASSIGN   6168>>ASSIGN   6186>>IF       6186>>ASSIGN
      6187>>IF       6204>>IF       6215>>ASSIGN   6218>>IF       6234>>ASSIGN   6244>>ASSIGN   6255>>IF
      6267>>ASSIGN   6270>>IF       6280>>ASSIGN   6287>>ASSIGN   6302>>ASSIGN   6306>>ASSIGN   6312>>ASSIGN
      6339>>ASSIGN   6353>>IF       6353>>ASSIGN   6361>>ASSIGN   6362>>ASSIGN   6363>>ASSIGN   6374>>IF
      6375>>IF       6378>>IF       6384>>CALL     6409>>ASSIGN
FPT$GETDCB_V.DCB#
      3846**DCL      6456>>ASSIGN   6509<<ASSIGN
FPT$GETDCB_V.MERGE
      3846**DCL      6496>>IF
FPT$GETDCB_V.TEST
      3846**DCL      6472>>IF
FPT$OPEN_V.ACS
      3855**DCL      5560>>IF       6044>>IF       6044>>ASSIGN
FPT$OPEN_V.ANSISPANSEQ
      3860**DCL      6085>>IF       6085>>ASSIGN
FPT$OPEN_V.ASN
      3855**DCL      5556>>IF       5556>>IF       6030>>IF       6030>>IF       6032>>ASSIGN
FPT$OPEN_V.AU
      3862**DCL      6100>>IF       6100>>ASSIGN
FPT$OPEN_V.BLKL
      3857**DCL      6062>>IF       6062>>ASSIGN
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:215  
FPT$OPEN_V.BLOCKED
      3856**DCL      6054>>IF       6055>>ASSIGN
FPT$OPEN_V.BUPM
      3856**DCL      6084>>IF       6084>>ASSIGN
FPT$OPEN_V.CHAIN
      3861**DCL      6066>>IF       6066>>ASSIGN
FPT$OPEN_V.CNVRT
      3859**DCL      6070>>IF       6070>>ASSIGN
FPT$OPEN_V.COMP
      3856**DCL      6093>>IF       6093>>ASSIGN
FPT$OPEN_V.COPIES
      3863**DCL      6116>>IF       6121>>ASSIGN
FPT$OPEN_V.CTG
      3853**DCL      6092>>IF       6092>>ASSIGN
FPT$OPEN_V.CVOL
      3853**DCL      6073>>IF       6073>>ASSIGN
FPT$OPEN_V.DCB#
      3852**DCL      5537>>ASSIGN
FPT$OPEN_V.DENSITY
      3863**DCL      6067>>IF       6067>>ASSIGN
FPT$OPEN_V.DISP
      3857**DCL      6045>>IF       6045>>ASSIGN
FPT$OPEN_V.DVFC
      3861**DCL      6108>>IF       6108>>ASSIGN
FPT$OPEN_V.EBCDIC
      3859**DCL      6072>>IF       6072>>ASSIGN
FPT$OPEN_V.EVENT
      3862**DCL      6110>>IF       6110>>ASSIGN
FPT$OPEN_V.EXIST
      3853**DCL      6090>>IF       6090>>ASSIGN
FPT$OPEN_V.EXPIRE
      3858**DCL      6049>>IF       6049>>ASSIGN
FPT$OPEN_V.FSN
      3862**DCL      3862--REDEF    3863--REDEF    6068>>IF       6068>>ASSIGN
FPT$OPEN_V.FUN
      3855**DCL      6039>>IF       6039>>ASSIGN
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:216  
FPT$OPEN_V.GHSTACS
      3857**DCL      6083>>IF       6083>>ASSIGN
FPT$OPEN_V.IGNOREFSN
      3860**DCL      6060>>IF       6061>>ASSIGN
FPT$OPEN_V.INITZ.REASSIGN
      3852**DCL      5540>>IF
FPT$OPEN_V.INITZ.SCRUB
      3852**DCL      5535>>IF       5996>>IF
FPT$OPEN_V.IOERROK
      3859**DCL      6058>>IF       6059>>ASSIGN
FPT$OPEN_V.IXTNSIZE
      3858**DCL      6077>>IF       6077>>ASSIGN
FPT$OPEN_V.JRNLBYPASS
      3856**DCL      6103>>IF       6104>>ASSIGN
FPT$OPEN_V.KEYL
      3857**DCL      6086>>IF       6087>>ASSIGN
FPT$OPEN_V.KEYTYPE
      3861**DCL      6050>>IF       6050>>ASSIGN
FPT$OPEN_V.KEYX
      3857**DCL      6088>>ASSIGN
FPT$OPEN_V.LINES
      3862**DCL      6109>>IF       6109>>ASSIGN
FPT$OPEN_V.LOAD
      3856**DCL      6094>>IF       6094>>ASSIGN
FPT$OPEN_V.LRDL0
      3858**DCL      6081>>IF       6081>>ASSIGN
FPT$OPEN_V.LSLIDE
      3858**DCL      6080>>IF       6080>>ASSIGN
FPT$OPEN_V.LSTAOR
      3856**DCL      6102>>IF       6102>>ASSIGN
FPT$OPEN_V.MAXVOL
      3860**DCL      6065>>IF       6065>>ASSIGN
FPT$OPEN_V.NRECS
      3858**DCL      6078>>IF       6078>>ASSIGN
FPT$OPEN_V.OPER.NXTA
      3853**DCL      5784>>IF
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:217  
FPT$OPEN_V.ORG
      3855**DCL      6043>>IF       6043>>ASSIGN
FPT$OPEN_V.QISS
      3862**DCL      6101>>IF       6101>>ASSIGN
FPT$OPEN_V.RECL
      3857**DCL      6063>>IF       6063>>ASSIGN
FPT$OPEN_V.RES
      3857**DCL      6046>>IF       6047>>CALLBLT
FPT$OPEN_V.SEED
      3863**DCL      6096>>ASSIGN
FPT$OPEN_V.SEEDSPECIFIED
      3860**DCL      6095>>IF
FPT$OPEN_V.SEQ
      3861**DCL      6111>>IF       6114>>ASSIGN
FPT$OPEN_V.SEQCOL
      3861**DCL      6112>>ASSIGN
FPT$OPEN_V.SEQID
      3862**DCL      6113>>ASSIGN
FPT$OPEN_V.SETDCB
      3852**DCL      5682>>IF
FPT$OPEN_V.SHARE
      3853**DCL      6091>>IF       6091>>ASSIGN
FPT$OPEN_V.SPANNED
      3856**DCL      6056>>IF       6057>>ASSIGN
FPT$OPEN_V.SPARE
      3858**DCL      6082>>IF       6082>>ASSIGN
FPT$OPEN_V.TYPE
      3856**DCL      6048>>IF       6048>>ASSIGN
FPT$OPEN_V.UOPT
      3855**DCL      6124>>IF       6124>>ASSIGN
FPT$OPEN_V.VOL
      3860**DCL      6064>>IF       6064>>ASSIGN
FPT$OPEN_V.VOLACCESS
      3862**DCL      6069>>IF       6069>>ASSIGN
FPT$OPEN_V.XONLY
      3859**DCL      5811>>ASSIGN
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:218  
FPT$OPEN_V.XTEND
      3859**DCL      6071>>IF       6071>>ASSIGN
FPT$OPEN_V.XTNSIZE
      3858**DCL      6079>>IF       6079>>ASSIGN
FPT$RELDCB_V.DCB#
      3849**DCL      6538>>ASSIGN
FSA$FSP
      5393**DCL-ENT  5583--CALL     5623--CALL     5628--CALL     5635--CALL     5641--CALL     5646--CALL
      5654--CALL     5659--CALL     5666--CALL     6035--CALL     6193--CALL     6200--CALL     6207--CALL
      6251--CALL     6258--CALL     6320--CALL     6327--CALL     6334--CALL     6414--CALL     6421--CALL
      6563--CALL
FSA$GSP
      5392**DCL-ENT  6118--CALL     6140--CALL     6231--CALL     6242--CALL     6277--CALL     6285--CALL
      6309--CALL     6348--CALL     6405--CALL     6485--CALL
FSN$OPNDEV
      5394**DCL-ENT  5849--CALL
FTO$OPNAT
      5390**DCL-ENT  5828--CALL     5846--CALL
FUN
      5458**DCL      5790>>ASSIGN
F_OPLBL
      3905**DCL      5950>>IF
HFF$DSIZ
      5383**DCL-ENT  6144--CALL     6217--CALL     6269--CALL     6290--CALL     6341--CALL     6370--CALL
      6391--CALL     6502--CALL
HFF$ERASE
      5385**DCL-ENT  5571--CALL
HFF$NIL
      5384**DCL-ENT  5570--CALL
HFF$NILERASE
      5386**DCL-ENT  5513--CALL     5555--CALL     6447--CALL
HFF$TRAPALT
      5387**DCL-ENT  5538--CALL
HFF$WRITE1
      5388**DCL-ENT  5832--CALL     6508--CALL
I
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:219  
      5479**DCL      5509<>CALL     5511>>IF       5525>>IF       5536>>ASSIGN   5547<<DOINDEX  5548>>ASSIGN
      5569<<DOINDEX  5570<>CALL     5571<>CALL     5572>>ASSIGN   5572>>ASSIGN   5578>>ASSIGN   5579>>DOCASE
      5752<<DOINDEX  5753>>ASSIGN   5920<<ASSIGN   5921>>DOWHILE  5922--ASSIGN   5956>>IF       5956<<ASSIGN
      5957<<ASSIGN   5957>>ASSIGN   6454<>CALL     6455>>IF       6456<<ASSIGN   6457>>IF       6457>>IF
      6458>>ASSIGN   6459--IF       6466<<DOINDEX  6467--IF       6468--IF       6468--IF       6468--IF
      6473<<ASSIGN   6476<<DOINDEX  6477--IF       6487>>ASSIGN   6495>>ASSIGN   6506--ASSIGN   6509>>ASSIGN
      6538<<ASSIGN   6545<<ASSIGN   6547>>IF       6547>>IF       6547>>IF       6554>>ASSIGN   6564>>ASSIGN
I IN PROCEDURE FMM$MERGE1
      5984**DCL      6144<>CALL     6145>>IF       6215<<ASSIGN   6217<>CALL     6218>>IF       6229>>ASSIGN
      6267<<ASSIGN   6269<>CALL     6270>>IF       6276>>ASSIGN   6290<>CALL     6291>>IF       6339<<ASSIGN
      6341<>CALL     6342<<ASSIGN   6342>>ASSIGN   6343>>IF       6343<<ASSIGN   6346>>IF       6347>>ASSIGN
      6353>>IF       6353<<ASSIGN   6359>>ASSIGN   6360>>DOWHILE  6361>>ASSIGN   6361>>ASSIGN   6362>>ASSIGN
      6362>>ASSIGN   6363>>ASSIGN   6363>>ASSIGN   6364<<ASSIGN   6364>>ASSIGN   6373<<DOINDEX  6374>>IF
      6391<>CALL     6392>>IF
IRREC$
      5477**DCL      3110--IMP-PTR  5644<<ASSIGN   5645>>ASSIGN   5646<>CALL     6249<<ASSIGN   6250>>ASSIGN
      6251<>CALL     6277<>CALL     6279>>ASSIGN   6280>>ASSIGN   6281>>ASSIGN
J
      5480**DCL      5499--IMP-SIZ  5627<<ASSIGN   5628<>CALL     5634<<ASSIGN   5635<>CALL     5645<<ASSIGN
      5646<>CALL     5653<<ASSIGN   5654<>CALL     5949<<DOINDEX  5950>>IF       5951>>ASSIGN   5991<<DOINDEX
      5992>>IF       5992>>ASSIGN   5993>>ASSIGN   5993>>ASSIGN   6123<<DOINDEX  6124>>IF       6124>>ASSIGN
      6124>>ASSIGN   6131<<DOINDEX  6132>>IF       6133>>ASSIGN   6134>>DOCASE   6484<<ASSIGN   6485<>CALL
      6488<<ASSIGN   6488>>ASSIGN   6489>>ASSIGN
JDCB$
      5467**DCL      3570--IMP-PTR  5507<<ASSIGN   5508>>ASSIGN   5510>>IF       5511>>IF       5511>>IF
      5515>>ASSIGN   5516>>ASSIGN   5525>>IF       5536>>ASSIGN   5537>>ASSIGN   5539>>ASSIGN   5556>>IF
      5582>>IF       5583>>CALL     5584>>ASSIGN   5587>>ASSIGN   5588>>ASSIGN   5589>>ASSIGN   5592>>ASSIGN
      5595>>ASSIGN   5596>>ASSIGN   5599>>ASSIGN   5602>>ASSIGN   5605>>ASSIGN   5608>>ASSIGN   5611>>ASSIGN
      5615>>ASSIGN   5616>>ASSIGN   5619>>ASSIGN   5622>>IF       5623>>CALL     5625>>IF       5626>>ASSIGN
      5629>>ASSIGN   5632>>IF       5633>>ASSIGN   5636>>ASSIGN   5640>>IF       5641>>CALL     5643>>IF
      5644>>ASSIGN   5647>>ASSIGN   5651>>IF       5652>>ASSIGN   5655>>ASSIGN   5657>>IF       5658>>ASSIGN
      5660>>ASSIGN   5663>>IF       5664>>ASSIGN   5684>>IF       5685>>IF       5687>>ASSIGN   5687>>ASSIGN
      5733<<ASSIGN   5734>>ASSIGN   5737<<ASSIGN   5743<<ASSIGN   5744>>IF       5744>>IF       5749>>ASSIGN
      5750>>ASSIGN   5763>>IF       5764>>IF       5766>>IF       5768>>IF       5770>>IF       5772>>IF
      5774>>IF       5776>>IF       5784>>IF       5787>>ASSIGN   5788>>IF       5788>>ASSIGN   5790>>IF
      5790>>IF       5790>>ASSIGN   5790>>ASSIGN   5791>>IF       5791>>IF       5793>>ASSIGN   5794>>IF
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:220  
      5794>>IF       5795>>CALL     5796>>ASSIGN   5798>>ASSIGN   5799>>ASSIGN   5799>>ASSIGN   5800>>ASSIGN
      5800>>ASSIGN   5801>>ASSIGN   5801>>ASSIGN   5802>>ASSIGN   5803>>ASSIGN   5804>>ASSIGN   5805>>ASSIGN
      5805>>ASSIGN   5806>>ASSIGN   5806>>ASSIGN   5807>>ASSIGN   5807>>ASSIGN   5808>>ASSIGN   5809>>ASSIGN
      5810>>ASSIGN   5810>>ASSIGN   5815>>IF       5815>>IF       5817>>DOCASE   5820>>IF       5821>>ASSIGN
      5822>>IF       5828>>IF       5829>>IF       5829>>IF       5833>>ASSIGN   5834>>ASSIGN   5838>>IF
      5839>>ASSIGN   5840>>ASSIGN   5841>>ASSIGN   5843>>IF       5844>>ASSIGN   5863>>ASSIGN   5864>>ASSIGN
      5922<<ASSIGN   5923>>IF       5924>>ASSIGN   5925>>IF       5929>>ASSIGN   5930>>ASSIGN   5931>>ASSIGN
      5932>>ASSIGN   5933>>ASSIGN   5934>>ASSIGN   5935>>ASSIGN   5936>>ASSIGN   5937>>ASSIGN   5938>>ASSIGN
      5939>>ASSIGN   5940>>ASSIGN   5941>>ASSIGN   5942>>ASSIGN   5947>>ASSIGN   5947>>ASSIGN   5948>>ASSIGN
      5951>>ASSIGN   5997>>ASSIGN   5998>>IF       5998>>IF       5999>>ASSIGN   6000>>ASSIGN   6030>>IF
      6032>>ASSIGN   6033>>ASSIGN   6034>>IF       6035>>CALL     6036>>ASSIGN   6039>>ASSIGN   6043>>ASSIGN
      6044>>ASSIGN   6045>>ASSIGN   6047>>CALLBLT  6048>>ASSIGN   6049>>ASSIGN   6050>>ASSIGN   6055>>ASSIGN
      6057>>ASSIGN   6059>>ASSIGN   6061>>ASSIGN   6062>>ASSIGN   6063>>ASSIGN   6064>>ASSIGN   6065>>ASSIGN
      6066>>ASSIGN   6067>>ASSIGN   6068>>ASSIGN   6069>>ASSIGN   6070>>ASSIGN   6071>>ASSIGN   6072>>ASSIGN
      6073>>ASSIGN   6077>>ASSIGN   6078>>ASSIGN   6079>>ASSIGN   6080>>ASSIGN   6081>>ASSIGN   6082>>ASSIGN
      6083>>ASSIGN   6084>>ASSIGN   6085>>ASSIGN   6087>>ASSIGN   6088>>ASSIGN   6090>>ASSIGN   6091>>ASSIGN
      6092>>ASSIGN   6093>>ASSIGN   6094>>ASSIGN   6096>>ASSIGN   6100>>ASSIGN   6101>>ASSIGN   6102>>ASSIGN
      6104>>ASSIGN   6108>>ASSIGN   6109>>ASSIGN   6110>>ASSIGN   6112>>ASSIGN   6113>>ASSIGN   6114>>ASSIGN
      6117>>IF       6118>>CALL     6119>>ASSIGN   6121>>ASSIGN   6124>>ASSIGN   6137>>IF       6139>>IF
      6140>>CALL     6142>>ASSIGN   6142>>ASSIGN   6153>>ASSIGN   6154>>ASSIGN   6159>>ASSIGN   6160>>ASSIGN
      6161>>ASSIGN   6164>>ASSIGN   6167>>ASSIGN   6168>>ASSIGN   6171>>ASSIGN   6174>>ASSIGN   6177>>ASSIGN
      6180>>ASSIGN   6183>>ASSIGN   6186>>ASSIGN   6187>>ASSIGN   6190>>IF       6191>>ASSIGN   6194>>ASSIGN
      6197>>IF       6198>>ASSIGN   6201>>ASSIGN   6206>>IF       6207>>CALL     6209>>IF       6209>>IF
      6209>>IF       6209>>IF       6209>>IF       6209>>IF       6209>>IF       6235>>ASSIGN   6241>>IF
      6242>>CALL     6244>>ASSIGN   6248>>IF       6249>>ASSIGN   6252>>ASSIGN   6257>>IF       6258>>CALL
      6260>>IF       6260>>IF       6260>>IF       6260>>IF       6260>>IF       6260>>IF       6260>>IF
      6281>>ASSIGN   6284>>IF       6285>>CALL     6302>>ASSIGN   6306>>ASSIGN   6308>>IF       6309>>CALL
      6310>>ASSIGN   6312>>ASSIGN   6315>>IF       6315>>IF       6315>>IF       6315>>IF       6318>>IF
      6319>>ASSIGN   6321>>ASSIGN   6324>>IF       6325>>ASSIGN   6328>>ASSIGN   6331>>IF       6332>>ASSIGN
      6335>>ASSIGN   6338>>IF       6352>>ASSIGN   6354>>IF       6389>>IF       6389>>IF       6404>>IF
      6406>>ASSIGN   6408>>ASSIGN   6411>>IF       6412>>ASSIGN   6415>>ASSIGN   6418>>IF       6419>>ASSIGN
      6422>>ASSIGN   6445<<ASSIGN   6484>>ASSIGN   6484>>ASSIGN   6486<<ASSIGN   6487>>ASSIGN   6489>>ASSIGN
      6490>>ASSIGN   6492>>ASSIGN   6492>>ASSIGN   6493>>ASSIGN   6495>>ASSIGN   6522<<ASSIGN   6523>>ASSIGN
      6554<<ASSIGN   6555>>ASSIGN   6556>>IF       6561>>ASSIGN   6563>>CALL     6563>>CALL
K
      5490**DCL      5491--REDEF    5496--IMP-SIZ  5497--IMP-SIZ  5498--IMP-SIZ  5665<<ASSIGN   5666<>CALL
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:221  
      5801<<ASSIGN   5802>>ASSIGN   5807<<ASSIGN   5808>>ASSIGN   6157<<ASSIGN   6159>>ASSIGN   6160>>ASSIGN
      6192<<ASSIGN   6193<>CALL     6199<<ASSIGN   6200<>CALL     6229<<ASSIGN   6231<>CALL     6232<<ASSIGN
      6232>>ASSIGN   6233>>ASSIGN   6234>>ASSIGN   6234>>ASSIGN   6243<<ASSIGN   6244>>ASSIGN   6244>>ASSIGN
      6250<<ASSIGN   6251<>CALL     6276<<ASSIGN   6277<>CALL     6278<<ASSIGN   6278>>ASSIGN   6279>>ASSIGN
      6280>>ASSIGN   6280>>ASSIGN   6286<<ASSIGN   6287>>ASSIGN   6288<<ASSIGN   6288>>ASSIGN   6291>>IF
      6302>>ASSIGN   6302>>ASSIGN   6326<<ASSIGN   6327<>CALL     6333<<ASSIGN   6334<>CALL     6347<<ASSIGN
      6348<>CALL     6349<<ASSIGN   6349>>ASSIGN   6350>>ASSIGN   6351>>ASSIGN   6413<<ASSIGN   6414<>CALL
      6420<<ASSIGN   6421<>CALL     6446<<ASSIGN   6449>>IF       6466>>IF       6468>>IF       6468>>IF
      6484>>ASSIGN   6490>>ASSIGN   6491>>IF       6492>>ASSIGN   6502<>CALL     6503>>IF       6504>>IF
      6504<<ASSIGN   6505<<ASSIGN   6506>>ASSIGN   6506>>ASSIGN   6506>>ASSIGN
KCO$OPCG
      5395**DCL-ENT  5852--CALL
KFIELD.NWORDS
      3872**DCL      5665>>ASSIGN   6333>>ASSIGN   6420>>ASSIGN
KFIELD$
      5472**DCL      3872--IMP-PTR  5664<<ASSIGN   5665>>ASSIGN   5666<>CALL     6332<<ASSIGN   6333>>ASSIGN
      6334<>CALL     6419<<ASSIGN   6420>>ASSIGN   6421<>CALL
MAINSTREAM
      5763**LABEL    5682--GOTO
MOVEJB
      5499**DCL      6489<<ASSIGN
MOVEKB
      5498**DCL      5802<<ASSIGN   6233<<ASSIGN   6234<<ASSIGN   6234>>ASSIGN   6279<<ASSIGN   6280<<ASSIGN
      6280>>ASSIGN   6350<<ASSIGN
MOVEKC
      5497**DCL      5808<<ASSIGN   6244<<ASSIGN   6244>>ASSIGN   6287>>ASSIGN   6302<<ASSIGN   6302>>ASSIGN
      6506<<ASSIGN   6506>>ASSIGN
N
      5473**DCL      6370<>CALL     6371<<ASSIGN   6371>>ASSIGN   6373>>DOINDEX
NAME.OP
      5489**DCL      5950>>IF
NAME.S
      5488**DCL      5949>>IF
NAO$OPN
      5397**DCL-ENT  5855--CALL
NEXTPTR IN PROCEDURE FMM$MERGE1
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:222  
      6430**LABEL    6132--GOTO     6213--GOTO     6264--GOTO     6390--GOTO
NKEYS
      5474**DCL      6372<<ASSIGN   6374<<ASSIGN   6374>>ASSIGN   6375>>IF       6378>>IF
NODCBNAME
      6449**LABEL    6447--CALLALT
NORMOPN
      5547**LABEL    5541--CALLALT
NORMOPN1
      5569**LABEL    5555--CALLALT  5558--GOTO
NOSET
      6500**LABEL    6497--CALLALT
NOSLOTS
      6574**LABEL    6479--GOTO
NOVIRTPTR
      5835**LABEL    5832--CALLALT
NOWRITE
      6509**LABEL    6508--CALLALT
NXTDCB
      5956**LABEL    5923--GOTO     5953--CALLALT
PN$
      5478**DCL      5548<<ASSIGN   5559<<ASSIGN   5562<<ASSIGN   5562>>ASSIGN   5563<>CALL     5572<<ASSIGN
      5578<<ASSIGN   5682>>IF       5751<<ASSIGN   5753<<ASSIGN   5767<<ASSIGN   5769<<ASSIGN   5771<<ASSIGN
      5773<<ASSIGN   5775<<ASSIGN   5777<<ASSIGN   5784>>IF       5811>>ASSIGN   5816<>CALL     5826<>CALL
      5827<>CALL     5828<>CALL     5829>>IF       5833>>ASSIGN   5834>>ASSIGN   5842<>CALL     5846<>CALL
      5849<>CALL     5852<>CALL     5992<<ASSIGN   5993<<ASSIGN   5996>>IF       6026>>ASSIGN   6132>>IF
      6133>>ASSIGN
RELDCBI
      6545**LABEL    6539--GOTO
RETRET
      5682**LABEL    5538--CALLALT  5843--GOTO     5865--GOTO     6511--GOTO     6525--CALLALT  6527--GOTO
      6585--GOTO     6587--GOTO
START$
      5476**DCL      3887--IMP-PTR  5633<<ASSIGN   5634>>ASSIGN   5635<>CALL     6198<<ASSIGN   6199>>ASSIGN
      6200<>CALL
TDCB$
      5501**DCL      5508<<ASSIGN   5535<>CALL     5541<>CALL     5749<<ASSIGN   5765<>CALL     5924<<ASSIGN
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:223  
      5926<>CALL     5953<>CALL     5996<>CALL     6485<>CALL     6486>>ASSIGN   6494<>CALL     6497<>CALL
      6523<<ASSIGN   6524<>CALL     6525<>CALL     6561<<ASSIGN   6562<>CALL     6563<>CALL
TEMP$
      5470**DCL      3489--IMP-PTR  5901<<ASSIGN   5967>>ASSIGN
USERSLOT
      6463**LABEL    6457--GOTO
VLP$ACCT.ACCT#
      2849**DCL      6164>>ASSIGN
VLP$ALTKEYS.K.KEYL#
      3016**DCL      6361>>ASSIGN
VLP$ALTKEYS.K.KEYX#
      3016**DCL      6362>>ASSIGN
VLP$ALTKEYS.K.UNIQUE#
      3015**DCL      6363>>ASSIGN
VLP$ALTKEYS.SIZ#
      3015**DCL      6339>>ASSIGN   6353>>IF       6353>>ASSIGN
VLP$FORM.FORM#
      2915**DCL      6312>>ASSIGN
VLP$FPRG
      3030**DCL      5659--CALL     6320--CALL     6392--IF       6405--CALL     6409<<ASSIGN   6409>>ASSIGN
VLP$HDR.CTL
      2928**DCL      6288--ASSIGN
VLP$HDR.TITL
      2930**DCL      6287--ASSIGN
VLP$HDRF
      2944**DCL      5641--CALL     6258--CALL     6285--CALL
VLP$IRKEYS
      3051**DCL      6384<>CALL
VLP$IRKEYS.K.KEYEND#
      3051**DCL      6374>>IF
VLP$IRKEYS.NKEYS#
      3051**DCL      6375>>IF       6378>>IF
VLP$IRREC.NFIELDS#
      3110**DCL      5645>>ASSIGN   6250>>ASSIGN   6267>>ASSIGN   6270>>IF
VLP$IRREC.VLPID#
      3110**DCL      6255>>IF
PL6.E3A0      #001=FMM$OPN File=FMM$OPN.:E05TSI                                  TUE 07/29/97 16:51 Page:224  
VLP$PASS.PASS#
      2862**DCL      6168>>ASSIGN
VLP$RECFIELD.FIELD
      3075**DCL      3075--REDEF
VLP$RECFIELD.NFIELDS#
      3067**DCL      5627>>ASSIGN   6192>>ASSIGN   6215>>ASSIGN   6218>>IF
VLP$RECFIELD.VLPID#
      3067**DCL      6204>>IF
VLP$SETSTA
      2988**DCL      5583--CALL     6035--CALL     6140--CALL     6145--IF       6153<<ASSIGN   6153>>ASSIGN
VLP$SETSTA.ISTA
      2992**DCL      5515<<ASSIGN   5515>>ASSIGN
VLP$SETSTA.OSTA
      2997**DCL      5516<<ASSIGN   5516>>ASSIGN
VLP$SN.NUM#
      2875**DCL      6186>>IF       6187>>IF
VLP$SN.SN#
      2875**DCL      6186>>ASSIGN
VLP$STATION
      2961**DCL      5583--CALL     6035--CALL     6140--CALL     6142--ASSIGN
VLP$STATION.MSGIDXT
      2971**DCL      2974--REDEF
VLP$TAB
      2888**DCL      5623--CALL     6207--CALL     6242--CALL     6243--ASSIGN
VLP$VIRTUAL_V.PTR$
      3868**DCL      5833<<ASSIGN   5833>>ASSIGN
VLP$VIRTUAL_V.WSQ
      3867**DCL      5834<<ASSIGN   5834>>ASSIGN
VLP$WSN.WSN#
      2902**DCL      6306>>ASSIGN

PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:225  
     1306        1        /*T***********************************************************/
     1307        2        /*T*                                                         */
     1308        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1309        4        /*T*                                                         */
     1310        5        /*T***********************************************************/
     1311        6                    /*F*
     1312        7                    *     NAME:   FMM$IFPARAM
     1313        8                    *     PURPOSE:  MERGE THE NECESSARY ITEMS FROM THE IFPARAM
     1314        9                    *               RECORD INTO THE DCB AND SET THE CORRESPONDING
     1315       10                    *               POINTERS INTO THE VALID IFPARAM AREAS.
     1316       11                    *
     1317       12                    *     CALL:   CALL FMM$IFPARAM(PN$);
     1318       13                    *
     1319       14                    *     DESCRIPTION:  FMM$IFPARAM TAKES APART THE PARAMETERS IN
     1320       15                    *             THE INPUT FIT RECORD AND MERGES THEM INTO THE DCB
     1321       16                    *             OR SETS THE OPEN POINTER TO THE IFPARAM AREA
     1322       17                    *             DESCRIBING THE FILE ATTRIBUTES.  NOTE THAT THE
     1323       18                    *             IFPARAM ITEMS ARE MERGED PRIOR TO THE OPEN FPT,
     1324       19                    *             AND THUS MAY BE INDIVIDUALLY OVERRIDDEN BY ITEMS
     1325       20                    *             IN THE OPEN FPT ITSELF (E.G. AN ERASE FPT VECTOR
     1326       21                    *             WILL OVERRIDE A SPECIFIC IFPARAM ITEM SUCH AS AN
     1327       22                    *             ACCOUNT ACCESS LIST).
     1328       23                    *
     1329       24                    */
     1330       25        FMM$IFPARAM:PROC(FPT) ALTRET;
     1331       26                    /**/
     1332       27        %INCLUDE F$JIT_C;
     1333      457        %INCLUDE F$CP6P_C;
     1334      468        %INCLUDE KI_CP6;
     1335     1564        %INCLUDE FM_FIELD_C;
     1336     1605        %MACRO F$DCB(BASED=BASED);
     1337     1606        %INCLUDE F$DCB;
     1338     1655        %MEND;
     1339     1656        %INCLUDE FM$MACROS;
     1340     2031        %F$DCB(BASED="BASED(JDCB$)");
     1341     2081        %FPT$OPEN_P(FPTN=FPT,PFMT=PTR,STCLASS=);
     1342     2087        %FM$FIT(BASED="BASED(FPT.IFPARAM_)");
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:226  
     1343     2090        %CODE02(BASED="BASED(TEMP$)");
     1344     2094        %CODE03(BASED="BASED(TEMP$)");
     1345     2101        %CODE04(BASED="BASED(TEMP$)");
     1346     2109        %CODE05(BASED="BASED(TEMP$)");
     1347     2112        %CODE06(BASED="BASED(TEMP$)");
     1348     2116        %CODE07(BASED="BASED(TEMP$)");
     1349     2119        %FITALTKEYS(BASED="BASED(TEMP$)");
     1350     2125        %CODE14(BASED="BASED(TEMP$)");
     1351     2135        %CODE16(BASED="BASED(TEMP$)");
     1352     2143        %VLP_FPRG (FPTN=VLP$FPRG, STCLASS="BASED(TEMP$)");
     1353     2164        %CODE18 (BASED="BASED(TEMP$)");
     1354     2168        %CODE19 (BASED="BASED(TEMP$)");
     1355     2171        %CODE21 (BASED="BASED(TEMP$)");
     1356     2174        %FMG$KFIELD (FPTN=KFIELD,STCLASS=BASED);
     1357     2177        %FM$FIELD_START (FPTN=FM$FIELD_START,STCLASS=BASED);
     1358     2199        %INCLUDE CP_6_SUBS;
     1359     2739        %INCLUDE UD_ERRORS_C;
     1360     2781        %SUB FCG#='0615'O;
     1361     2782        %SUB MID#='15'O;
     1362     2783        %ERRCODE(NAME=FMM$E$BADVECT11,COD#=%E$BADVECT11);
     1363     2787    1   DCL IFPARMSZ(0:21)UBIN CONSTANT INIT(0,0,
     1364     2788    1   SIZEW(CODE02),
     1365     2789    1   SIZEW(CODE03),
     1366     2790    1   SIZEW(CODE04),
     1367     2791    1   SIZEW(CODE05),
     1368     2792    1   SIZEW(CODE06),
     1369     2793    1   SIZEW(CODE07),
     1370     2794    1   7,          /* For alternate keys - use min word size */
     1371     2795    1   0,0,0,0,0,
     1372     2796    1   SIZEW(CODE14),0,
     1373     2797    1   SIZEW(CODE16),
     1374     2798    1   SIZEW(VLP$FPRG),
     1375     2799    1   2,          /* For physical field description - use min word size */
     1376     2800    1   2,          /* For IRKEYS - use min word size */
     1377     2801    1   5,          /* For 2nd IRKEYS - use min word size */
     1378     2802    1   2);         /* For logical field description - use min word size */
     1379     2803    1   DCL 1 MOVEL BASED,
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:227  
     1380     2804    1         2 * CHAR(L);
     1381     2805                    /* AUTO FRAME */
     1382     2806    1   DCL T$ PTR;
     1383     2807    1   DCL L UBIN;
     1384     2808    1   DCL K UBIN;
     1385     2809    1   DCL J UBIN;
     1386     2810    1   DCL I UBIN;
     1387     2811    1   DCL JDCB$ PTR;
     1388     2812    1   DCL TEMP$ PTR;
     1389     2813    1   DCL FIELD$ PTR;
     1390     2814    1   DCL START$ PTR;
     1391     2815        %SUB IFPARAMX="POFFW(ADDR(FPT.IFPARAM_),ADDR(FPT.V_))";
     1392     2816                    /* SYMREFS */
     1393     2817    1   DCL B$JIT$ PTR SYMREF READONLY;
     1394     2818    1   DCL B$ROSEG$ PTR SYMREF READONLY;
     1395     2819    1   DCL B$PS$(0:0) PTR SYMREF READONLY;
     1396     2820                    /**/
     1397     2821    1   DCL FSA$FSP ENTRY(2) ALTRET;
     1398     2822    1   DCL FMG$IRSETUP ENTRY(1) ALTRET;
     1399     2823    1   DCL FSA$GSP ENTRY(2) ALTRET;
     1400     2824    1   DCL HFF$DSIZ ENTRY(2);
     1401     2825        %EJECT;
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:228  
     1402     2826    1      JDCB$=B$JIT.DCB$;
     1403     2827    1      J=FM$FIT.CODES.CODE(0); /* NO. OF CONTROL WORDS */
     1404     2828    1      CALL HFF$DSIZ(IFPARAMX,K);
     1405     2829    1      K=K/4;
     1406     2830    1      IF K<J THEN GOTO FMME$BADVECT11;
     1407     2831                    /**/
     1408     2832    2      DO I=1 TO J;
     1409     2833    2         TEMP$=PINCRW(FPT.IFPARAM_,FM$FIT.CODES.ITEMX(I));
     1410     2834    2         IF FM$FIT.CODES.ITEMX(I)+FM$FIT.CODES.NDW(I)>K
     1411     2835    2           OR FM$FIT.CODES.ITEMX(I)+IFPARMSZ(FM$FIT.CODES.CODE(I))>K
     1412     2836    2         THEN GOTO FMME$BADVECT11;
     1413     2837    3         DO CASE(FM$FIT.CODES.CODE(I));
     1414     2838                    /**/
     1415     2839    3         CASE(2); /* FPARAM DATA FOR KEYED FILES */
     1416     2840    3            IF CODE02.LSLIDE~=0 THEN F$DCB.LSLIDE=CODE02.LSLIDE;
     1417     2841    3            IF CODE02.LRDL0~=0 THEN F$DCB.LRDL0=CODE02.LRDL0;
     1418     2842    3            IF CODE02.SPARE~=0 THEN F$DCB.SPARE=CODE02.SPARE;
     1419     2843    4            IF CODE02.KEYL~=0 AND NOT F$DCB.FCD THEN DO;
     1420     2844    4               F$DCB.KEYL=CODE02.KEYL;
     1421     2845    4               F$DCB.KEYX=CODE02.KEYX;
     1422     2846    4               END;
     1423     2847                    /**/
     1424     2848    3         CASE(3); /* FPARAM DATA FOR ALL FILES */
     1425     2849    4            IF NOT F$DCB.FCD THEN DO;
     1426     2850    4               IF CODE03.ORG~=0 THEN F$DCB.ORG=CODE03.ORG;
     1427     2851    4               IF CODE03.UGRANS~=0 THEN F$DCB.IXTNSIZE=CODE03.UGRANS;
     1428     2852    4               IF CODE03.RECL~=0 THEN F$DCB.RECL=CODE03.RECL;
     1429     2853    4               IF F$DCB.ORG=%RELATIVE#
     1430     2854    4                 AND CODE03.NRECS~=0 THEN F$DCB.NRECS=CODE03.NRECS;
     1431     2855    4               IF CODE03.COMP THEN F$DCB.COMP='1'B;
     1432     2856    4               END;
     1433     2857    3            IF CODE03.TYPE~=BINASC(0) THEN F$DCB.TYPE=CODE03.TYPE;
     1434     2858    3            IF CODE03.DESC THEN F$DCB.BUPM=CODE03.DESC.BUPM;
     1435     2859    3            IF CODE03.XTNSIZE~=0 THEN F$DCB.XTNSIZE=CODE03.XTNSIZE;
     1436     2860    3            IF CODE03.EXPIRE~=0 THEN F$DCB.EXPIRE=CODE03.EXPIRE;
     1437     2861    3            IF CODE03.GHSTACS~=0 THEN F$DCB.GHSTACS=CODE03.GHSTACS;
     1438     2862    3         CASE(7); /* PASSWORD */
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:229  
     1439     2863    4            IF NOT F$DCB.FCD THEN DO;
     1440     2864    4               F$DCB.PASSF='1'B;
     1441     2865    4               F$DCB.PASS=CODE07.PASS;
     1442     2866    4               END;
     1443     2867                    /**/
     1444     2868    3         CASE(8); /* ALTERNATE KEYS (INDEXED FILES) */
     1445     2869    3            IF NOT F$DCB.FCD AND FM$FIT.CODES.NDW(I)>=7 AND
     1446     2870    3              F$DCB.ORG = %INDEXED#
     1447     2871    4            THEN DO;
     1448     2872    5               IF F$DCB.ALTKEYX~=0 THEN DO;
     1449     2873    5                  T$=PINCRW(B$ROSEG$,F$DCB.ALTKEYX);
     1450     2874    5                  L=T$->FITALTKEYS.NUMWRDS;
     1451     2875    5                  CALL FSA$FSP(L,T$);
     1452     2876    5                  F$DCB.ALTKEYX=0;
     1453     2877    5                  END;
     1454     2878    5               IF F$DCB.KFIELDX~=0 THEN DO;
     1455     2879    5                  T$=PINCRW(B$ROSEG$,F$DCB.KFIELDX);
     1456     2880    5                  L=T$->KFIELD.NWORDS;
     1457     2881    5                  CALL FSA$FSP(L,T$);
     1458     2882    5                  F$DCB.KFIELDX=0;
     1459     2883    5                  END;
     1460     2884    4               L=FM$FIT.CODES.NDW(I);
     1461     2885    4               CALL FSA$GSP(L,T$) ALTRET(IFPARERR);
     1462     2886    4               L=L*4;
     1463     2887    4               T$->MOVEL='0'B;
     1464     2888    4               L=L/4;
     1465     2889    4               T$->FITALTKEYS.NUMWRDS=L;
     1466     2890    4               F$DCB.ALTKEYX=POFFW(T$,B$ROSEG$);
     1467     2891    4               T$->FITALTKEYS.NUMENTS=MINIMUM((L-1)/SIZEW(FITALTKEYS.K(0)),
     1468     2892    4                 FITALTKEYS.NUMENTS);
     1469     2893    5               DO L=0 TO T$->FITALTKEYS.NUMENTS-1;
     1470     2894    5                  T$->FITALTKEYS.K.KEYX(L)=FITALTKEYS.K.KEYX(L);
     1471     2895    5                  T$->FITALTKEYS.K.KEYL(L)=FITALTKEYS.K.KEYL(L);
     1472     2896    5                  T$->FITALTKEYS.K.UNIQUE(L)=FITALTKEYS.K.UNIQUE(L);
     1473     2897    5                  END;
     1474     2898    4               END;
     1475     2899                    /**/
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:230  
     1476     2900    3         CASE(16); /* FORM NAME */
     1477     2901    4            IF NOT F$DCB.FCD THEN DO;
     1478     2902    4               IF F$DCB.FORM$=ADDR(NIL)
     1479     2903    4               THEN CALL FSA$GSP(SIZEW(CODE16),F$DCB.FORM$)ALTRET(IFPARERR);
     1480     2904    4               F$DCB.FORM$->CODE16=CODE16;
     1481     2905    4               END;
     1482     2906                    /**/
     1483     2907    3         CASE(9); /* ACCOUNT LIST */
     1484     2908    3            F$DCB.AMFLG.ACCF='0'B;
     1485     2909    3            IF FPT.ACCESS_=ADDR(NIL) THEN FPT.ACCESS_=B$PS$(IFPARAMX);
     1486     2910                    /**/
     1487     2911    3         CASE(10); /* ACCESS VEHICLES */
     1488     2912    3            F$DCB.AMFLG.ACSF='0'B;
     1489     2913    3            IF FPT.ACSVEH_=ADDR(NIL) THEN FPT.ACSVEH_=B$PS$(IFPARAMX);
     1490     2914                    /**/
     1491     2915    3         CASE(11); /* USER ATTRIBUTES */
     1492     2916    3            F$DCB.AMFLG.USRF='0'B;
     1493     2917    3            IF FPT.UATTR_=ADDR(NIL) THEN FPT.UATTR_=B$PS$(IFPARAMX);
     1494     2918                    /**/
     1495     2919    3         CASE(12); /* INSTALLATION ATTRIBUTES */
     1496     2920    3            F$DCB.AMFLG.INSF='0'B;
     1497     2921    3            IF FPT.INSTATTR_=ADDR(NIL) THEN FPT.INSTATTR_=B$PS$(IFPARAMX);
     1498     2922                    /**/
     1499     2923    3         CASE(13); /* PROCESSOR ATTRIBUTES */
     1500     2924    3            F$DCB.AMFLG.PROF='0'B;
     1501     2925    3            IF FPT.PROCATTR_=ADDR(NIL) THEN FPT.PROCATTR_=B$PS$(IFPARAMX);
     1502     2926                    /**/
     1503     2927                    /**/
     1504     2928    3         CASE(17); /* FPRG */
     1505     2929    4            IF NOT F$DCB.FCD THEN DO;
     1506     2930    5               IF F$DCB.FPRGX=0 THEN DO;
     1507     2931    5                  CALL FSA$GSP(SIZEW(VLP$FPRG),T$) ALTRET(IFPARERR);
     1508     2932    5                  F$DCB.FPRGX=POFFW(T$,B$ROSEG$);
     1509     2933    5                  END;
     1510     2934    4               ELSE T$=PINCRW(B$ROSEG$,F$DCB.FPRGX);
     1511     2935    4               T$->VLP$FPRG=VLP$FPRG;
     1512     2936    4               END;
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:231  
     1513     2937                    /* */
     1514     2938    3         CASE(18); /* Physical field data */
     1515     2939    4            IF NOT F$DCB.FCD THEN DO;
     1516     2940    5               IF F$DCB.FIELDX~=0 THEN DO;
     1517     2941    5                  FIELD$=PINCRW(B$ROSEG$, F$DCB.FIELDX);
     1518     2942    5                  L=(FIELD$->CODE18.NFIELDS+1)/2 + 1;
     1519     2943    5                  CALL FSA$FSP(L, FIELD$);
     1520     2944    5                  F$DCB.FIELDX=0;
     1521     2945    5                  END;
     1522     2946
     1523     2947    5               IF F$DCB.STARTX~=0 THEN DO;
     1524     2948    5                  T$=PINCRW(B$ROSEG$,F$DCB.STARTX);
     1525     2949    5                  L=T$->FM$FIELD_START.NWORDS;
     1526     2950    5                  CALL FSA$FSP(L,T$);
     1527     2951    5                  F$DCB.STARTX=0;
     1528     2952    5                  END;
     1529     2953
     1530     2954    4               L=FM$FIT.CODES.NDW(I);
     1531     2955    4               CALL FSA$GSP(L, FIELD$) ALTRET(IFPARERR);
     1532     2956    4               L=L*4;
     1533     2957    4               FIELD$->MOVEL='0'B;
     1534     2958    4               F$DCB.FIELDX=POFFW(FIELD$, B$ROSEG$);
     1535     2959
     1536     2960    4               FIELD$->MOVEL=TEMP$->MOVEL;
     1537     2961    4               IF FIELD$->CODE18.NFIELDS > (L-4)/2 THEN
     1538     2962    4               FIELD$->CODE18.NFIELDS=(L-4)/2;
     1539     2963                    /* Set F$DCB.STARTX and FM$FIELD_START later, so we can
     1540     2964                       give better errors and not do it several times.    */
     1541     2965    4               END;
     1542     2966                    /**/
     1543     2967    3         CASE(19); /* IREL key data */
     1544     2968    4            IF NOT F$DCB.FCD THEN DO;
     1545     2969    5               IF F$DCB.ALTKEYX~=0 THEN DO;
     1546     2970    5                  T$=PINCRW(B$ROSEG$,F$DCB.ALTKEYX);
     1547     2971    5                  L=T$->FITALTKEYS.NUMWRDS;
     1548     2972    5                  CALL FSA$FSP(L,T$);
     1549     2973    5                  F$DCB.ALTKEYX=0;
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:232  
     1550     2974    5                  END;
     1551     2975    5               IF F$DCB.KFIELDX~=0 THEN DO;
     1552     2976    5                  T$=PINCRW(B$ROSEG$,F$DCB.KFIELDX);
     1553     2977    5                  L=T$->KFIELD.NWORDS;
     1554     2978    5                  CALL FSA$FSP(L,T$);
     1555     2979    5                  F$DCB.KFIELDX=0;
     1556     2980    5                  END;
     1557     2981    4               CALL FMG$IRSETUP(CODE19) ALTRET(IFPARERR);
     1558     2982    4               END;
     1559     2983                    /**/
     1560     2984    3         CASE(21); /* Logical field data */
     1561     2985    4            IF NOT F$DCB.FCD THEN DO;
     1562     2986    5               IF F$DCB.IRRECX ~= 0 THEN DO;
     1563     2987    5                  T$=PINCRW(B$ROSEG$,F$DCB.IRRECX);
     1564     2988    5                  L=(T$->CODE21.NFIELDS+3)/4 + 1;
     1565     2989    5                  CALL FSA$FSP(L,T$);
     1566     2990    5                  F$DCB.IRRECX=0;
     1567     2991    5                  END;
     1568     2992    4               L=FM$FIT.CODES.NDW(I);
     1569     2993    4               CALL FSA$GSP(L,T$) ALTRET(IFPARERR);
     1570     2994    4               L=L*4;
     1571     2995    4               T$->MOVEL='0'B;
     1572     2996    4               F$DCB.IRRECX=POFFW(T$,B$ROSEG$);
     1573     2997    4               T$->MOVEL=TEMP$->MOVEL;
     1574     2998    4               IF T$->CODE21.NFIELDS > L-4 THEN
     1575     2999    4               T$->CODE21.NFIELDS=L-4;
     1576     3000    4               END;
     1577     3001                    /**/
     1578     3002    3         CASE(ELSE);
     1579     3003    3         END;  /* DO CASE(FM$FIT.CODES.CODE(I)) */
     1580     3004    2         END;  /* DO I=1 TO J */
     1581     3005    1      RETURN;
     1582     3006    1   FMME$BADVECT11:;
     1583     3007    1      B$JIT.ERR=FMM$E$BADVECT11;
     1584     3008    1   IFPARERR: ALTRETURN;
     1585     3009    1   END FMM$IFPARAM;
     1586     3010        %EOD;
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:233  

PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:234  
--  Include file information  --

   UD_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
   FM_FIELD_C.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   F$CP6P_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FMM$IFPARAM.

   Procedure FMM$IFPARAM requires 697 words for executable code.
   Procedure FMM$IFPARAM requires 18 words of local(AUTO) storage.

PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:235  

 Object Unit name= FMM$IFPARAM                                File name= FMM$OPN.:E05TOU
 UTS= JUL 29 '97 16:52:54.68 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     23     27  FMM$IFPARAM
    1   Proc  even  none   697   1271  FMM$IFPARAM
    2  RoData even  none    10     12  FMM$IFPARAM

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        1  FMM$IFPARAM

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 HFF$DSIZ
 yes     yes           Std       2 FSA$FSP
 yes     yes           Std       2 FSA$GSP
 yes     yes           Std       1 FMG$IRSETUP
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:236  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    B$JIT$                           r    B$ROSEG$                         r    B$PS$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:237  


     1306        1        /*T***********************************************************/
     1307        2        /*T*                                                         */
     1308        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1309        4        /*T*                                                         */
     1310        5        /*T***********************************************************/
     1311        6                    /*F*
     1312        7                    *     NAME:   FMM$IFPARAM
     1313        8                    *     PURPOSE:  MERGE THE NECESSARY ITEMS FROM THE IFPARAM
     1314        9                    *               RECORD INTO THE DCB AND SET THE CORRESPONDING
     1315       10                    *               POINTERS INTO THE VALID IFPARAM AREAS.
     1316       11                    *
     1317       12                    *     CALL:   CALL FMM$IFPARAM(PN$);
     1318       13                    *
     1319       14                    *     DESCRIPTION:  FMM$IFPARAM TAKES APART THE PARAMETERS IN
     1320       15                    *             THE INPUT FIT RECORD AND MERGES THEM INTO THE DCB
     1321       16                    *             OR SETS THE OPEN POINTER TO THE IFPARAM AREA
     1322       17                    *             DESCRIBING THE FILE ATTRIBUTES.  NOTE THAT THE
     1323       18                    *             IFPARAM ITEMS ARE MERGED PRIOR TO THE OPEN FPT,
     1324       19                    *             AND THUS MAY BE INDIVIDUALLY OVERRIDDEN BY ITEMS
     1325       20                    *             IN THE OPEN FPT ITSELF (E.G. AN ERASE FPT VECTOR
     1326       21                    *             WILL OVERRIDE A SPECIFIC IFPARAM ITEM SUCH AS AN
     1327       22                    *             ACCOUNT ACCESS LIST).
     1328       23                    *
     1329       24                    */
     1330       25        FMM$IFPARAM:PROC(FPT) ALTRET;

     25  1 000000   000000 700200 xent  FMM$IFPARAM  TSX0  ! X66_AUTO_1
         1 000001   000022 000001                    ZERO    18,1

     1331       26                    /**/
     1332       27        %INCLUDE F$JIT_C;
     1333      457        %INCLUDE F$CP6P_C;
     1334      468        %INCLUDE KI_CP6;
     1335     1564        %INCLUDE FM_FIELD_C;
     1336     1605        %MACRO F$DCB(BASED=BASED);
     1337     1606        %INCLUDE F$DCB;
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:238  
     1338     1655        %MEND;
     1339     1656        %INCLUDE FM$MACROS;
     1340     2031        %F$DCB(BASED="BASED(JDCB$)");
     1341     2081        %FPT$OPEN_P(FPTN=FPT,PFMT=PTR,STCLASS=);
     1342     2087        %FM$FIT(BASED="BASED(FPT.IFPARAM_)");
     1343     2090        %CODE02(BASED="BASED(TEMP$)");
     1344     2094        %CODE03(BASED="BASED(TEMP$)");
     1345     2101        %CODE04(BASED="BASED(TEMP$)");
     1346     2109        %CODE05(BASED="BASED(TEMP$)");
     1347     2112        %CODE06(BASED="BASED(TEMP$)");
     1348     2116        %CODE07(BASED="BASED(TEMP$)");
     1349     2119        %FITALTKEYS(BASED="BASED(TEMP$)");
     1350     2125        %CODE14(BASED="BASED(TEMP$)");
     1351     2135        %CODE16(BASED="BASED(TEMP$)");
     1352     2143        %VLP_FPRG (FPTN=VLP$FPRG, STCLASS="BASED(TEMP$)");
     1353     2164        %CODE18 (BASED="BASED(TEMP$)");
     1354     2168        %CODE19 (BASED="BASED(TEMP$)");
     1355     2171        %CODE21 (BASED="BASED(TEMP$)");
     1356     2174        %FMG$KFIELD (FPTN=KFIELD,STCLASS=BASED);
     1357     2177        %FM$FIELD_START (FPTN=FM$FIELD_START,STCLASS=BASED);
     1358     2199        %INCLUDE CP_6_SUBS;
     1359     2739        %INCLUDE UD_ERRORS_C;
     1360     2781        %SUB FCG#='0615'O;
     1361     2782        %SUB MID#='15'O;
     1362     2783        %ERRCODE(NAME=FMM$E$BADVECT11,COD#=%E$BADVECT11);
     1363     2787    1   DCL IFPARMSZ(0:21)UBIN CONSTANT INIT(0,0,
     1364     2788    1   SIZEW(CODE02),
     1365     2789    1   SIZEW(CODE03),
     1366     2790    1   SIZEW(CODE04),
     1367     2791    1   SIZEW(CODE05),
     1368     2792    1   SIZEW(CODE06),
     1369     2793    1   SIZEW(CODE07),
     1370     2794    1   7,          /* For alternate keys - use min word size */
     1371     2795    1   0,0,0,0,0,
     1372     2796    1   SIZEW(CODE14),0,
     1373     2797    1   SIZEW(CODE16),
     1374     2798    1   SIZEW(VLP$FPRG),
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:239  
     1375     2799    1   2,          /* For physical field description - use min word size */
     1376     2800    1   2,          /* For IRKEYS - use min word size */
     1377     2801    1   5,          /* For 2nd IRKEYS - use min word size */
     1378     2802    1   2);         /* For logical field description - use min word size */
     1379     2803    1   DCL 1 MOVEL BASED,
     1380     2804    1         2 * CHAR(L);
     1381     2805                    /* AUTO FRAME */
     1382     2806    1   DCL T$ PTR;
     1383     2807    1   DCL L UBIN;
     1384     2808    1   DCL K UBIN;
     1385     2809    1   DCL J UBIN;
     1386     2810    1   DCL I UBIN;
     1387     2811    1   DCL JDCB$ PTR;
     1388     2812    1   DCL TEMP$ PTR;
     1389     2813    1   DCL FIELD$ PTR;
     1390     2814    1   DCL START$ PTR;
     1391     2815        %SUB IFPARAMX="POFFW(ADDR(FPT.IFPARAM_),ADDR(FPT.V_))";
     1392     2816                    /* SYMREFS */
     1393     2817    1   DCL B$JIT$ PTR SYMREF READONLY;
     1394     2818    1   DCL B$ROSEG$ PTR SYMREF READONLY;
     1395     2819    1   DCL B$PS$(0:0) PTR SYMREF READONLY;
     1396     2820                    /**/
     1397     2821    1   DCL FSA$FSP ENTRY(2) ALTRET;
     1398     2822    1   DCL FMG$IRSETUP ENTRY(1) ALTRET;
     1399     2823    1   DCL FSA$GSP ENTRY(2) ALTRET;
     1400     2824    1   DCL HFF$DSIZ ENTRY(2);
     1401     2825        %EJECT;
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:240  
     1402     2826    1      JDCB$=B$JIT.DCB$;

   2826  1 000002   000000 470400 xsym               LDP0    B$JIT$
         1 000003   000232 236100                    LDQ     154,,PR0
         1 000004   200011 756100                    STQ     JDCB$,,AUTO

     1403     2827    1      J=FM$FIT.CODES.CODE(0); /* NO. OF CONTROL WORDS */

   2827  1 000005   200003 471500                    LDP1    @FPT,,AUTO
         1 000006   100013 473500                    LDP3    11,,PR1
         1 000007   300000 236100                    LDQ     0,,PR3
         1 000010   000037 772000                    QRL     31
         1 000011   200007 756100                    STQ     J,,AUTO

     1404     2828    1      CALL HFF$DSIZ(IFPARAMX,K);

   2828  1 000012   200003 236100                    LDQ     @FPT,,AUTO
         1 000013   000022 772000                    QRL     18
         1 000014   200016 756100                    STQ     FIELD$+3,,AUTO
         1 000015   200003 236100                    LDQ     @FPT,,AUTO
         1 000016   000013 036003                    ADLQ    11,DU
         1 000017   000022 772000                    QRL     18
         1 000020   200016 136100                    SBLQ    FIELD$+3,,AUTO
         1 000021   200017 756100                    STQ     FIELD$+4,,AUTO
         1 000022   200006 633500                    EPPR3   K,,AUTO
         1 000023   200021 453500                    STP3    FIELD$+6,,AUTO
         1 000024   200017 634500                    EPPR4   FIELD$+4,,AUTO
         1 000025   200020 454500                    STP4    FIELD$+5,,AUTO
         1 000026   200020 630500                    EPPR0   FIELD$+5,,AUTO
         1 000027   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000030   000000 701000 xent               TSX1    HFF$DSIZ
         1 000031   000000 011000                    NOP     0

     1405     2829    1      K=K/4;

   2829  1 000032   200006 236100                    LDQ     K,,AUTO
         1 000033   000002 772000                    QRL     2
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:241  
         1 000034   200006 756100                    STQ     K,,AUTO

     1406     2830    1      IF K<J THEN GOTO FMME$BADVECT11;

   2830  1 000035   200007 116100                    CMPQ    J,,AUTO
         1 000036   001265 602000 1                  TNC     FMME$BADVECT11

     1407     2831                    /**/
     1408     2832    2      DO I=1 TO J;

   2832  1 000037   000001 235007                    LDA     1,DL
         1 000040   200010 755100                    STA     I,,AUTO
         1 000041   001261 710000 1                  TRA     s:3004+3

     1409     2833    2         TEMP$=PINCRW(FPT.IFPARAM_,FM$FIT.CODES.ITEMX(I));

   2833  1 000042   200003 470500                    LDP0    @FPT,,AUTO
         1 000043   000013 471500                    LDP1    11,,PR0
         1 000044   200010 720100                    LXL0    I,,AUTO
         1 000045   100000 721110                    LXL1    0,X0,PR1
         1 000046   001777 361003                    ANX1    1023,DU
         1 000047   100000 633511                    EPPR3   0,X1,PR1
         1 000050   200012 453500                    STP3    TEMP$,,AUTO

     1410     2834    2         IF FM$FIT.CODES.ITEMX(I)+FM$FIT.CODES.NDW(I)>K

   2834  1 000051   100000 236110                    LDQ     0,X0,PR1
         1 000052   000012 772000                    QRL     10
         1 000053   001777 376007                    ANQ     1023,DL
         1 000054   200016 756100                    STQ     FIELD$+3,,AUTO
         1 000055   100000 236110                    LDQ     0,X0,PR1
         1 000056   001777 376007                    ANQ     1023,DL
         1 000057   200016 036100                    ADLQ    FIELD$+3,,AUTO
         1 000060   200006 116100                    CMPQ    K,,AUTO
         1 000061   000063 600000 1                  TZE     s:2834+10
         1 000062   001265 603000 1                  TRC     FMME$BADVECT11
         1 000063   000013 471500                    LDP1    11,,PR0
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:242  
         1 000064   100000 236110                    LDQ     0,X0,PR1
         1 000065   000037 772000                    QRL     31
         1 000066   000000 621006                    EAX1    0,QL
         1 000067   100000 236110                    LDQ     0,X0,PR1
         1 000070   001777 376007                    ANQ     1023,DL
         1 000071   000001 036011 0                  ADLQ    IFPARMSZ,X1
         1 000072   200006 116100                    CMPQ    K,,AUTO
         1 000073   000075 600000 1                  TZE     s:2837
         1 000074   001265 603000 1                  TRC     FMME$BADVECT11

     1411     2835    2           OR FM$FIT.CODES.ITEMX(I)+IFPARMSZ(FM$FIT.CODES.CODE(I))>K
     1412     2836    2         THEN GOTO FMME$BADVECT11;
     1413     2837    3         DO CASE(FM$FIT.CODES.CODE(I));

   2837  1 000075   000026 101003                    CMPX1   22,DU
         1 000076   000100 602011 1                  TNC     s:2837+3,X1
         1 000077   001256 710000 1                  TRA     s:3004
         1 000100   001256 710000 1                  TRA     s:3004
         1 000101   001256 710000 1                  TRA     s:3004
         1 000102   000126 710000 1                  TRA     s:2840
         1 000103   000164 710000 1                  TRA     s:2849
         1 000104   001256 710000 1                  TRA     s:3004
         1 000105   001256 710000 1                  TRA     s:3004
         1 000106   001256 710000 1                  TRA     s:3004
         1 000107   000254 710000 1                  TRA     s:2863
         1 000110   000266 710000 1                  TRA     s:2869
         1 000111   000534 710000 1                  TRA     s:2908
         1 000112   000554 710000 1                  TRA     s:2912
         1 000113   000574 710000 1                  TRA     s:2916
         1 000114   000614 710000 1                  TRA     s:2920
         1 000115   000634 710000 1                  TRA     s:2924
         1 000116   001256 710000 1                  TRA     s:3004
         1 000117   001256 710000 1                  TRA     s:3004
         1 000120   000506 710000 1                  TRA     s:2901
         1 000121   000654 710000 1                  TRA     s:2929
         1 000122   000715 710000 1                  TRA     s:2939
         1 000123   001062 710000 1                  TRA     s:2968
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:243  
         1 000124   001256 710000 1                  TRA     s:3004
         1 000125   001143 710000 1                  TRA     s:2985

     1414     2838                    /**/
     1415     2839    3         CASE(2); /* FPARAM DATA FOR KEYED FILES */

     1416     2840    3            IF CODE02.LSLIDE~=0 THEN F$DCB.LSLIDE=CODE02.LSLIDE;

   2840  1 000126   300000 236100                    LDQ     0,,PR3
         1 000127   777000 316003                    CANQ    -512,DU
         1 000130   000134 600000 1                  TZE     s:2841

   2840  1 000131   200011 474500                    LDP4    JDCB$,,AUTO
         1 000132   000022 772000                    QRL     18
         1 000133   400037 552110                    STBQ    31,'10'O,PR4

     1417     2841    3            IF CODE02.LRDL0~=0 THEN F$DCB.LRDL0=CODE02.LRDL0;

   2841  1 000134   300000 236100                    LDQ     0,,PR3
         1 000135   000777 316003                    CANQ    511,DU
         1 000136   000142 600000 1                  TZE     s:2842

   2841  1 000137   200011 471500                    LDP1    JDCB$,,AUTO
         1 000140   000022 772000                    QRL     18
         1 000141   100037 552104                    STBQ    31,'04'O,PR1

     1418     2842    3            IF CODE02.SPARE~=0 THEN F$DCB.SPARE=CODE02.SPARE;

   2842  1 000142   300000 236100                    LDQ     0,,PR3
         1 000143   777000 316007                    CANQ    -512,DL
         1 000144   000150 600000 1                  TZE     s:2843

   2842  1 000145   200011 471500                    LDP1    JDCB$,,AUTO
         1 000146   000022 736000                    QLS     18
         1 000147   100040 552140                    STBQ    32,'40'O,PR1

     1419     2843    4            IF CODE02.KEYL~=0 AND NOT F$DCB.FCD THEN DO;
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:244  

   2843  1 000150   300003 236100                    LDQ     3,,PR3
         1 000151   777000 316007                    CANQ    -512,DL
         1 000152   001256 600000 1                  TZE     s:3004
         1 000153   200011 471500                    LDP1    JDCB$,,AUTO
         1 000154   100031 236100                    LDQ     25,,PR1
         1 000155   020000 316007                    CANQ    8192,DL
         1 000156   001256 601000 1                  TNZ     s:3004

     1420     2844    4               F$DCB.KEYL=CODE02.KEYL;

   2844  1 000157   300003 236100                    LDQ     3,,PR3
         1 000160   100036 552110                    STBQ    30,'10'O,PR1

     1421     2845    4               F$DCB.KEYX=CODE02.KEYX;

   2845  1 000161   300003 221100                    LDX1    3,,PR3
         1 000162   100036 741100                    STX1    30,,PR1

     1422     2846    4               END;

   2846  1 000163   001256 710000 1                  TRA     s:3004

     1423     2847                    /**/
     1424     2848    3         CASE(3); /* FPARAM DATA FOR ALL FILES */

     1425     2849    4            IF NOT F$DCB.FCD THEN DO;

   2849  1 000164   200011 474500                    LDP4    JDCB$,,AUTO
         1 000165   400031 236100                    LDQ     25,,PR4
         1 000166   020000 316007                    CANQ    8192,DL
         1 000167   000220 601000 1                  TNZ     s:2857

     1426     2850    4               IF CODE03.ORG~=0 THEN F$DCB.ORG=CODE03.ORG;

   2850  1 000170   300000 236100                    LDQ     0,,PR3
         1 000171   777000 316003                    CANQ    -512,DU
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:245  
         1 000172   000174 600000 1                  TZE     s:2851

   2850  1 000173   400032 552140                    STBQ    26,'40'O,PR4

     1427     2851    4               IF CODE03.UGRANS~=0 THEN F$DCB.IXTNSIZE=CODE03.UGRANS;

   2851  1 000174   300000 236100                    LDQ     0,,PR3
         1 000175   000032 316000 xsym               CANQ    B_VECTNIL+26
         1 000176   000202 600000 1                  TZE     s:2852

   2851  1 000177   300000 236100                    LDQ     0,,PR3
         1 000200   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 000201   400041 756100                    STQ     33,,PR4

     1428     2852    4               IF CODE03.RECL~=0 THEN F$DCB.RECL=CODE03.RECL;

   2852  1 000202   300005 721100                    LXL1    5,,PR3
         1 000203   000205 600000 1                  TZE     s:2853

   2852  1 000204   400033 441100                    SXL1    27,,PR4

     1429     2853    4               IF F$DCB.ORG=%RELATIVE#

   2853  1 000205   400032 236100                    LDQ     26,,PR4
         1 000206   777000 376003                    ANQ     -512,DU
         1 000207   005000 116003                    CMPQ    2560,DU
         1 000210   000214 601000 1                  TNZ     s:2855
         1 000211   300002 235100                    LDA     2,,PR3
         1 000212   000214 600000 1                  TZE     s:2855

     1430     2854    4                 AND CODE03.NRECS~=0 THEN F$DCB.NRECS=CODE03.NRECS;

   2854  1 000213   400042 755100                    STA     34,,PR4

     1431     2855    4               IF CODE03.COMP THEN F$DCB.COMP='1'B;

   2855  1 000214   300004 234100                    SZN     4,,PR3
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:246  
         1 000215   000220 605000 1                  TPL     s:2857

   2855  1 000216   000100 236007                    LDQ     64,DL
         1 000217   400031 256100                    ORSQ    25,,PR4

     1432     2856    4               END;

     1433     2857    3            IF CODE03.TYPE~=BINASC(0) THEN F$DCB.TYPE=CODE03.TYPE;

   2857  1 000220   300001 721100                    LXL1    1,,PR3
         1 000221   000040 101003                    CMPX1   32,DU
         1 000222   000224 600000 1                  TZE     s:2858

   2857  1 000223   400025 441100                    SXL1    21,,PR4

     1434     2858    3            IF CODE03.DESC THEN F$DCB.BUPM=CODE03.DESC.BUPM;

   2858  1 000224   300001 221100                    LDX1    1,,PR3
         1 000225   000234 600000 1                  TZE     s:2859

   2858  1 000226   300001 236100                    LDQ     1,,PR3
         1 000227   000400 376003                    ANQ     256,DU
         1 000230   000031 772000                    QRL     25
         1 000231   400031 676100                    ERQ     25,,PR4
         1 000232   000003 376007                    ANQ     3,DL
         1 000233   400031 656100                    ERSQ    25,,PR4

     1435     2859    3            IF CODE03.XTNSIZE~=0 THEN F$DCB.XTNSIZE=CODE03.XTNSIZE;

   2859  1 000234   300005 221100                    LDX1    5,,PR3
         1 000235   000237 600000 1                  TZE     s:2860

   2859  1 000236   400037 741100                    STX1    31,,PR4

     1436     2860    3            IF CODE03.EXPIRE~=0 THEN F$DCB.EXPIRE=CODE03.EXPIRE;

   2860  1 000237   300007 221100                    LDX1    7,,PR3
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:247  
         1 000240   000244 600000 1                  TZE     s:2861

   2860  1 000241   300007 236100                    LDQ     7,,PR3
         1 000242   000022 732000                    QRS     18
         1 000243   400035 756100                    STQ     29,,PR4

     1437     2861    3            IF CODE03.GHSTACS~=0 THEN F$DCB.GHSTACS=CODE03.GHSTACS;

   2861  1 000244   300004 236100                    LDQ     4,,PR3
         1 000245   017000 316003                    CANQ    7680,DU
         1 000246   001256 600000 1                  TZE     s:3004

   2861  1 000247   000011 772000                    QRL     9
         1 000250   400052 676100                    ERQ     42,,PR4
         1 000251   000017 376003                    ANQ     15,DU
         1 000252   400052 656100                    ERSQ    42,,PR4
         1 000253   001256 710000 1                  TRA     s:3004

     1438     2862    3         CASE(7); /* PASSWORD */

     1439     2863    4            IF NOT F$DCB.FCD THEN DO;

   2863  1 000254   200011 474500                    LDP4    JDCB$,,AUTO
         1 000255   400031 236100                    LDQ     25,,PR4
         1 000256   020000 316007                    CANQ    8192,DL
         1 000257   001256 601000 1                  TNZ     s:3004

     1440     2864    4               F$DCB.PASSF='1'B;

   2864  1 000260   400000 236007                    LDQ     -131072,DL
         1 000261   400031 256100                    ORSQ    25,,PR4

     1441     2865    4               F$DCB.PASS=CODE07.PASS;

   2865  1 000262   040100 100500                    MLR     fill='040'O
         1 000263   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
         1 000264   400022 000010                    ADSC9   18,,PR4                  cn=0,n=8
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:248  

     1442     2866    4               END;

   2866  1 000265   001256 710000 1                  TRA     s:3004

     1443     2867                    /**/
     1444     2868    3         CASE(8); /* ALTERNATE KEYS (INDEXED FILES) */

     1445     2869    3            IF NOT F$DCB.FCD AND FM$FIT.CODES.NDW(I)>=7 AND

   2869  1 000266   200011 474500                    LDP4    JDCB$,,AUTO
         1 000267   400031 236100                    LDQ     25,,PR4
         1 000270   020000 316007                    CANQ    8192,DL
         1 000271   001256 601000 1                  TNZ     s:3004
         1 000272   100000 236110                    LDQ     0,X0,PR1
         1 000273   000000 376000 2                  ANQ     0
         1 000274   016000 116007                    CMPQ    7168,DL
         1 000275   001256 602000 1                  TNC     s:3004
         1 000276   400032 236100                    LDQ     26,,PR4
         1 000277   777000 376003                    ANQ     -512,DU
         1 000300   006000 116003                    CMPQ    3072,DU
         1 000301   001256 601000 1                  TNZ     s:3004

     1446     2870    3              F$DCB.ORG = %INDEXED#
     1447     2871    4            THEN DO;

     1448     2872    5               IF F$DCB.ALTKEYX~=0 THEN DO;

   2872  1 000302   400052 722100                    LXL2    42,,PR4
         1 000303   000326 600000 1                  TZE     s:2878

     1449     2873    5                  T$=PINCRW(B$ROSEG$,F$DCB.ALTKEYX);

   2873  1 000304   000000 636012                    EAQ     0,X2
         1 000305   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000306   200004 756100                    STQ     T$,,AUTO

PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:249  
     1450     2874    5                  L=T$->FITALTKEYS.NUMWRDS;

   2874  1 000307   200004 475500                    LDP5    T$,,AUTO
         1 000310   500000 236100                    LDQ     0,,PR5
         1 000311   000033 772000                    QRL     27
         1 000312   200005 756100                    STQ     L,,AUTO

     1451     2875    5                  CALL FSA$FSP(L,T$);

   2875  1 000313   200004 636500                    EPPR6   T$,,AUTO
         1 000314   200017 456500                    STP6    FIELD$+4,,AUTO
         1 000315   200005 631500                    EPPR1   L,,AUTO
         1 000316   200016 451500                    STP1    FIELD$+3,,AUTO
         1 000317   200016 630500                    EPPR0   FIELD$+3,,AUTO
         1 000320   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000321   000000 701000 xent               TSX1    FSA$FSP
         1 000322   000000 011000                    NOP     0

     1452     2876    5                  F$DCB.ALTKEYX=0;

   2876  1 000323   000000 220003                    LDX0    0,DU
         1 000324   200011 470500                    LDP0    JDCB$,,AUTO
         1 000325   000052 440100                    SXL0    42,,PR0

     1453     2877    5                  END;

     1454     2878    5               IF F$DCB.KFIELDX~=0 THEN DO;

   2878  1 000326   200011 470500                    LDP0    JDCB$,,AUTO
         1 000327   000056 720100                    LXL0    46,,PR0
         1 000330   000352 600000 1                  TZE     s:2884

     1455     2879    5                  T$=PINCRW(B$ROSEG$,F$DCB.KFIELDX);

   2879  1 000331   000000 636010                    EAQ     0,X0
         1 000332   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000333   200004 756100                    STQ     T$,,AUTO
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:250  

     1456     2880    5                  L=T$->KFIELD.NWORDS;

   2880  1 000334   200004 471500                    LDP1    T$,,AUTO
         1 000335   100000 235100                    LDA     0,,PR1
         1 000336   200005 755100                    STA     L,,AUTO

     1457     2881    5                  CALL FSA$FSP(L,T$);

   2881  1 000337   200004 633500                    EPPR3   T$,,AUTO
         1 000340   200017 453500                    STP3    FIELD$+4,,AUTO
         1 000341   200005 634500                    EPPR4   L,,AUTO
         1 000342   200016 454500                    STP4    FIELD$+3,,AUTO
         1 000343   200016 630500                    EPPR0   FIELD$+3,,AUTO
         1 000344   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000345   000000 701000 xent               TSX1    FSA$FSP
         1 000346   000000 011000                    NOP     0

     1458     2882    5                  F$DCB.KFIELDX=0;

   2882  1 000347   000000 220003                    LDX0    0,DU
         1 000350   200011 470500                    LDP0    JDCB$,,AUTO
         1 000351   000056 440100                    SXL0    46,,PR0

     1459     2883    5                  END;

     1460     2884    4               L=FM$FIT.CODES.NDW(I);

   2884  1 000352   200003 471500                    LDP1    @FPT,,AUTO
         1 000353   100013 473500                    LDP3    11,,PR1
         1 000354   200010 721100                    LXL1    I,,AUTO
         1 000355   300000 236111                    LDQ     0,X1,PR3
         1 000356   000012 772000                    QRL     10
         1 000357   001777 376007                    ANQ     1023,DL
         1 000360   200005 756100                    STQ     L,,AUTO

     1461     2885    4               CALL FSA$GSP(L,T$) ALTRET(IFPARERR);
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:251  

   2885  1 000361   200004 634500                    EPPR4   T$,,AUTO
         1 000362   200017 454500                    STP4    FIELD$+4,,AUTO
         1 000363   200005 633500                    EPPR3   L,,AUTO
         1 000364   200016 453500                    STP3    FIELD$+3,,AUTO
         1 000365   200016 630500                    EPPR0   FIELD$+3,,AUTO
         1 000366   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000367   000000 701000 xent               TSX1    FSA$GSP
         1 000370   001270 702000 1                  TSX2    IFPARERR

     1462     2886    4               L=L*4;

   2886  1 000371   200005 235100                    LDA     L,,AUTO
         1 000372   000002 735000                    ALS     2
         1 000373   200005 755100                    STA     L,,AUTO

     1463     2887    4               T$->MOVEL='0'B;

   2887  1 000374   200004 470500                    LDP0    T$,,AUTO
         1 000375   000000 620005                    EAX0    0,AL
         1 000376   000140 100400                    MLR     fill='000'O
         1 000377   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000400   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1464     2888    4               L=L/4;

   2888  1 000401   200005 236100                    LDQ     L,,AUTO
         1 000402   000002 772000                    QRL     2
         1 000403   200005 756100                    STQ     L,,AUTO

     1465     2889    4               T$->FITALTKEYS.NUMWRDS=L;

   2889  1 000404   200004 470500                    LDP0    T$,,AUTO
         1 000405   000033 736000                    QLS     27
         1 000406   000000 552140                    STBQ    0,'40'O,PR0

     1466     2890    4               F$DCB.ALTKEYX=POFFW(T$,B$ROSEG$);
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:252  

   2890  1 000407   000000 235000 xsym               LDA     B$ROSEG$
         1 000410   000022 771000                    ARL     18
         1 000411   200016 755100                    STA     FIELD$+3,,AUTO
         1 000412   200004 236100                    LDQ     T$,,AUTO
         1 000413   000022 772000                    QRL     18
         1 000414   200016 136100                    SBLQ    FIELD$+3,,AUTO
         1 000415   000000 620006                    EAX0    0,QL
         1 000416   200011 470500                    LDP0    JDCB$,,AUTO
         1 000417   000052 440100                    SXL0    42,,PR0

     1467     2891    4               T$->FITALTKEYS.NUMENTS=MINIMUM((L-1)/SIZEW(FITALTKEYS.K(0)),

   2891  1 000420   200005 236100                    LDQ     L,,AUTO
         1 000421   000001 136007                    SBLQ    1,DL
         1 000422   000006 506007                    DIV     6,DL
         1 000423   200012 471500                    LDP1    TEMP$,,AUTO
         1 000424   200016 756100                    STQ     FIELD$+3,,AUTO
         1 000425   100000 236100                    LDQ     0,,PR1
         1 000426   000022 772000                    QRL     18
         1 000427   000377 376007                    ANQ     255,DL
         1 000430   200017 756100                    STQ     FIELD$+4,,AUTO
         1 000431   200016 236100                    LDQ     FIELD$+3,,AUTO
         1 000432   200017 116100                    CMPQ    FIELD$+4,,AUTO
         1 000433   000436 602000 1                  TNC     s:2891+14
         1 000434   000436 600000 1                  TZE     s:2891+14
         1 000435   200017 236100                    LDQ     FIELD$+4,,AUTO
         1 000436   200004 473500                    LDP3    T$,,AUTO
         1 000437   000022 736000                    QLS     18
         1 000440   300000 676100                    ERQ     0,,PR3
         1 000441   000377 376003                    ANQ     255,DU
         1 000442   300000 656100                    ERSQ    0,,PR3

     1468     2892    4                 FITALTKEYS.NUMENTS);
     1469     2893    5               DO L=0 TO T$->FITALTKEYS.NUMENTS-1;

   2893  1 000443   200005 450100                    STZ     L,,AUTO
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:253  
         1 000444   000476 710000 1                  TRA     s:2897+3

     1470     2894    5                  T$->FITALTKEYS.K.KEYX(L)=FITALTKEYS.K.KEYX(L);

   2894  1 000445   200005 236100                    LDQ     L,,AUTO
         1 000446   000006 402007                    MPY     6,DL
         1 000447   200012 470500                    LDP0    TEMP$,,AUTO
         1 000450   000003 720106                    LXL0    3,QL,PR0
         1 000451   200004 471500                    LDP1    T$,,AUTO
         1 000452   100003 440106                    SXL0    3,QL,PR1

     1471     2895    5                  T$->FITALTKEYS.K.KEYL(L)=FITALTKEYS.K.KEYL(L);

   2895  1 000453   200005 236100                    LDQ     L,,AUTO
         1 000454   000006 402007                    MPY     6,DL
         1 000455   200004 471500                    LDP1    T$,,AUTO
         1 000456   000000 620006                    EAX0    0,QL
         1 000457   000001 236106                    LDQ     1,QL,PR0
         1 000460   100001 676110                    ERQ     1,X0,PR1
         1 000461   777000 376003                    ANQ     -512,DU
         1 000462   100001 656110                    ERSQ    1,X0,PR1

     1472     2896    5                  T$->FITALTKEYS.K.UNIQUE(L)=FITALTKEYS.K.UNIQUE(L);

   2896  1 000463   200005 236100                    LDQ     L,,AUTO
         1 000464   000006 402007                    MPY     6,DL
         1 000465   200004 471500                    LDP1    T$,,AUTO
         1 000466   000000 620006                    EAX0    0,QL
         1 000467   000004 236106                    LDQ     4,QL,PR0
         1 000470   100004 676110                    ERQ     4,X0,PR1
         1 000471   000400 376003                    ANQ     256,DU
         1 000472   100004 656110                    ERSQ    4,X0,PR1

     1473     2897    5                  END;

   2897  1 000473   200005 235100                    LDA     L,,AUTO
         1 000474   000001 035007                    ADLA    1,DL
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:254  
         1 000475   200005 755100                    STA     L,,AUTO
         1 000476   200004 470500                    LDP0    T$,,AUTO
         1 000477   000000 236100                    LDQ     0,,PR0
         1 000500   000022 772000                    QRL     18
         1 000501   000377 376007                    ANQ     255,DL
         1 000502   200005 116100                    CMPQ    L,,AUTO
         1 000503   000505 600000 1                  TZE     s:2898
         1 000504   000445 603000 1                  TRC     s:2894

     1474     2898    4               END;

   2898  1 000505   001256 710000 1                  TRA     s:3004

     1475     2899                    /**/
     1476     2900    3         CASE(16); /* FORM NAME */

     1477     2901    4            IF NOT F$DCB.FCD THEN DO;

   2901  1 000506   200011 474500                    LDP4    JDCB$,,AUTO
         1 000507   400031 236100                    LDQ     25,,PR4
         1 000510   020000 316007                    CANQ    8192,DL
         1 000511   001256 601000 1                  TNZ     s:3004

     1478     2902    4               IF F$DCB.FORM$=ADDR(NIL)

   2902  1 000512   400050 236100                    LDQ     40,,PR4
         1 000513   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000514   000525 601000 1                  TNZ     s:2904

     1479     2903    4               THEN CALL FSA$GSP(SIZEW(CODE16),F$DCB.FORM$)ALTRET(IFPARERR);

   2903  1 000515   200011 236100                    LDQ     JDCB$,,AUTO
         1 000516   000050 036003                    ADLQ    40,DU
         1 000517   000002 235000 2                  LDA     2
         1 000520   200016 757100                    STAQ    FIELD$+3,,AUTO
         1 000521   200016 630500                    EPPR0   FIELD$+3,,AUTO
         1 000522   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:255  
         1 000523   000000 701000 xent               TSX1    FSA$GSP
         1 000524   001270 702000 1                  TSX2    IFPARERR

     1480     2904    4               F$DCB.FORM$->CODE16=CODE16;

   2904  1 000525   200011 470500                    LDP0    JDCB$,,AUTO
         1 000526   000050 471500                    LDP1    40,,PR0
         1 000527   200012 473500                    LDP3    TEMP$,,AUTO
         1 000530   000100 100500                    MLR     fill='000'O
         1 000531   300000 000234                    ADSC9   0,,PR3                   cn=0,n=156
         1 000532   100000 000234                    ADSC9   0,,PR1                   cn=0,n=156

     1481     2905    4               END;

   2905  1 000533   001256 710000 1                  TRA     s:3004

     1482     2906                    /**/
     1483     2907    3         CASE(9); /* ACCOUNT LIST */

     1484     2908    3            F$DCB.AMFLG.ACCF='0'B;

   2908  1 000534   200011 474500                    LDP4    JDCB$,,AUTO
         1 000535   000003 236000 2                  LDQ     3
         1 000536   400064 356100                    ANSQ    52,,PR4

     1485     2909    3            IF FPT.ACCESS_=ADDR(NIL) THEN FPT.ACCESS_=B$PS$(IFPARAMX);

   2909  1 000537   000005 236100                    LDQ     5,,PR0
         1 000540   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000541   001256 601000 1                  TNZ     s:3004

   2909  1 000542   200003 236100                    LDQ     @FPT,,AUTO
         1 000543   000022 772000                    QRL     18
         1 000544   200016 756100                    STQ     FIELD$+3,,AUTO
         1 000545   200003 236100                    LDQ     @FPT,,AUTO
         1 000546   000013 036003                    ADLQ    11,DU
         1 000547   000022 772000                    QRL     18
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:256  
         1 000550   200016 136100                    SBLQ    FIELD$+3,,AUTO
         1 000551   000000 236006 xsym               LDQ     B$PS$,QL
         1 000552   000005 756100                    STQ     5,,PR0
         1 000553   001256 710000 1                  TRA     s:3004

     1486     2910                    /**/
     1487     2911    3         CASE(10); /* ACCESS VEHICLES */

     1488     2912    3            F$DCB.AMFLG.ACSF='0'B;

   2912  1 000554   200011 474500                    LDP4    JDCB$,,AUTO
         1 000555   000004 236000 2                  LDQ     4
         1 000556   400064 356100                    ANSQ    52,,PR4

     1489     2913    3            IF FPT.ACSVEH_=ADDR(NIL) THEN FPT.ACSVEH_=B$PS$(IFPARAMX);

   2913  1 000557   000006 236100                    LDQ     6,,PR0
         1 000560   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000561   001256 601000 1                  TNZ     s:3004

   2913  1 000562   200003 236100                    LDQ     @FPT,,AUTO
         1 000563   000022 772000                    QRL     18
         1 000564   200016 756100                    STQ     FIELD$+3,,AUTO
         1 000565   200003 236100                    LDQ     @FPT,,AUTO
         1 000566   000013 036003                    ADLQ    11,DU
         1 000567   000022 772000                    QRL     18
         1 000570   200016 136100                    SBLQ    FIELD$+3,,AUTO
         1 000571   000000 236006 xsym               LDQ     B$PS$,QL
         1 000572   000006 756100                    STQ     6,,PR0
         1 000573   001256 710000 1                  TRA     s:3004

     1490     2914                    /**/
     1491     2915    3         CASE(11); /* USER ATTRIBUTES */

     1492     2916    3            F$DCB.AMFLG.USRF='0'B;

   2916  1 000574   200011 474500                    LDP4    JDCB$,,AUTO
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:257  
         1 000575   000005 236000 2                  LDQ     5
         1 000576   400064 356100                    ANSQ    52,,PR4

     1493     2917    3            IF FPT.UATTR_=ADDR(NIL) THEN FPT.UATTR_=B$PS$(IFPARAMX);

   2917  1 000577   000007 236100                    LDQ     7,,PR0
         1 000600   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000601   001256 601000 1                  TNZ     s:3004

   2917  1 000602   200003 236100                    LDQ     @FPT,,AUTO
         1 000603   000022 772000                    QRL     18
         1 000604   200016 756100                    STQ     FIELD$+3,,AUTO
         1 000605   200003 236100                    LDQ     @FPT,,AUTO
         1 000606   000013 036003                    ADLQ    11,DU
         1 000607   000022 772000                    QRL     18
         1 000610   200016 136100                    SBLQ    FIELD$+3,,AUTO
         1 000611   000000 236006 xsym               LDQ     B$PS$,QL
         1 000612   000007 756100                    STQ     7,,PR0
         1 000613   001256 710000 1                  TRA     s:3004

     1494     2918                    /**/
     1495     2919    3         CASE(12); /* INSTALLATION ATTRIBUTES */

     1496     2920    3            F$DCB.AMFLG.INSF='0'B;

   2920  1 000614   200011 474500                    LDP4    JDCB$,,AUTO
         1 000615   000006 236000 2                  LDQ     6
         1 000616   400064 356100                    ANSQ    52,,PR4

     1497     2921    3            IF FPT.INSTATTR_=ADDR(NIL) THEN FPT.INSTATTR_=B$PS$(IFPARAMX);

   2921  1 000617   000010 236100                    LDQ     8,,PR0
         1 000620   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000621   001256 601000 1                  TNZ     s:3004

   2921  1 000622   200003 236100                    LDQ     @FPT,,AUTO
         1 000623   000022 772000                    QRL     18
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:258  
         1 000624   200016 756100                    STQ     FIELD$+3,,AUTO
         1 000625   200003 236100                    LDQ     @FPT,,AUTO
         1 000626   000013 036003                    ADLQ    11,DU
         1 000627   000022 772000                    QRL     18
         1 000630   200016 136100                    SBLQ    FIELD$+3,,AUTO
         1 000631   000000 236006 xsym               LDQ     B$PS$,QL
         1 000632   000010 756100                    STQ     8,,PR0
         1 000633   001256 710000 1                  TRA     s:3004

     1498     2922                    /**/
     1499     2923    3         CASE(13); /* PROCESSOR ATTRIBUTES */

     1500     2924    3            F$DCB.AMFLG.PROF='0'B;

   2924  1 000634   200011 474500                    LDP4    JDCB$,,AUTO
         1 000635   000007 236000 2                  LDQ     7
         1 000636   400064 356100                    ANSQ    52,,PR4

     1501     2925    3            IF FPT.PROCATTR_=ADDR(NIL) THEN FPT.PROCATTR_=B$PS$(IFPARAMX);

   2925  1 000637   000011 236100                    LDQ     9,,PR0
         1 000640   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000641   001256 601000 1                  TNZ     s:3004

   2925  1 000642   200003 236100                    LDQ     @FPT,,AUTO
         1 000643   000022 772000                    QRL     18
         1 000644   200016 756100                    STQ     FIELD$+3,,AUTO
         1 000645   200003 236100                    LDQ     @FPT,,AUTO
         1 000646   000013 036003                    ADLQ    11,DU
         1 000647   000022 772000                    QRL     18
         1 000650   200016 136100                    SBLQ    FIELD$+3,,AUTO
         1 000651   000000 236006 xsym               LDQ     B$PS$,QL
         1 000652   000011 756100                    STQ     9,,PR0
         1 000653   001256 710000 1                  TRA     s:3004

     1502     2926                    /**/
     1503     2927                    /**/
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:259  
     1504     2928    3         CASE(17); /* FPRG */

     1505     2929    4            IF NOT F$DCB.FCD THEN DO;

   2929  1 000654   200011 474500                    LDP4    JDCB$,,AUTO
         1 000655   400031 236100                    LDQ     25,,PR4
         1 000656   020000 316007                    CANQ    8192,DL
         1 000657   001256 601000 1                  TNZ     s:3004

     1506     2930    5               IF F$DCB.FPRGX=0 THEN DO;

   2930  1 000660   400054 222100                    LDX2    44,,PR4
         1 000661   000704 601000 1                  TNZ     s:2934

     1507     2931    5                  CALL FSA$GSP(SIZEW(VLP$FPRG),T$) ALTRET(IFPARERR);

   2931  1 000662   200004 635500                    EPPR5   T$,,AUTO
         1 000663   200017 455500                    STP5    FIELD$+4,,AUTO
         1 000664   000011 236000 2                  LDQ     9
         1 000665   200016 756100                    STQ     FIELD$+3,,AUTO
         1 000666   200016 630500                    EPPR0   FIELD$+3,,AUTO
         1 000667   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000670   000000 701000 xent               TSX1    FSA$GSP
         1 000671   001270 702000 1                  TSX2    IFPARERR

     1508     2932    5                  F$DCB.FPRGX=POFFW(T$,B$ROSEG$);

   2932  1 000672   000000 235000 xsym               LDA     B$ROSEG$
         1 000673   000022 771000                    ARL     18
         1 000674   200016 755100                    STA     FIELD$+3,,AUTO
         1 000675   200004 236100                    LDQ     T$,,AUTO
         1 000676   000022 772000                    QRL     18
         1 000677   200016 136100                    SBLQ    FIELD$+3,,AUTO
         1 000700   000000 620006                    EAX0    0,QL
         1 000701   200011 470500                    LDP0    JDCB$,,AUTO
         1 000702   000054 740100                    STX0    44,,PR0

PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:260  
     1509     2933    5                  END;

   2933  1 000703   000707 710000 1                  TRA     s:2935

     1510     2934    4               ELSE T$=PINCRW(B$ROSEG$,F$DCB.FPRGX);

   2934  1 000704   000000 636012                    EAQ     0,X2
         1 000705   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000706   200004 756100                    STQ     T$,,AUTO

     1511     2935    4               T$->VLP$FPRG=VLP$FPRG;

   2935  1 000707   200012 470500                    LDP0    TEMP$,,AUTO
         1 000710   200004 471500                    LDP1    T$,,AUTO
         1 000711   000100 100500                    MLR     fill='000'O
         1 000712   000000 000104                    ADSC9   0,,PR0                   cn=0,n=68
         1 000713   100000 000104                    ADSC9   0,,PR1                   cn=0,n=68

     1512     2936    4               END;

   2936  1 000714   001256 710000 1                  TRA     s:3004

     1513     2937                    /* */
     1514     2938    3         CASE(18); /* Physical field data */

     1515     2939    4            IF NOT F$DCB.FCD THEN DO;

   2939  1 000715   200011 474500                    LDP4    JDCB$,,AUTO
         1 000716   400031 236100                    LDQ     25,,PR4
         1 000717   020000 316007                    CANQ    8192,DL
         1 000720   001256 601000 1                  TNZ     s:3004

     1516     2940    5               IF F$DCB.FIELDX~=0 THEN DO;

   2940  1 000721   400054 722100                    LXL2    44,,PR4
         1 000722   000750 600000 1                  TZE     s:2947

PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:261  
     1517     2941    5                  FIELD$=PINCRW(B$ROSEG$, F$DCB.FIELDX);

   2941  1 000723   000000 636012                    EAQ     0,X2
         1 000724   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000725   200013 756100                    STQ     FIELD$,,AUTO

     1518     2942    5                  L=(FIELD$->CODE18.NFIELDS+1)/2 + 1;

   2942  1 000726   200013 471500                    LDP1    FIELD$,,AUTO
         1 000727   100000 236100                    LDQ     0,,PR1
         1 000730   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 000731   000001 036007                    ADLQ    1,DL
         1 000732   000001 772000                    QRL     1
         1 000733   000001 036007                    ADLQ    1,DL
         1 000734   200005 756100                    STQ     L,,AUTO

     1519     2943    5                  CALL FSA$FSP(L, FIELD$);

   2943  1 000735   200013 635500                    EPPR5   FIELD$,,AUTO
         1 000736   200017 455500                    STP5    FIELD$+4,,AUTO
         1 000737   200005 636500                    EPPR6   L,,AUTO
         1 000740   200016 456500                    STP6    FIELD$+3,,AUTO
         1 000741   200016 630500                    EPPR0   FIELD$+3,,AUTO
         1 000742   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000743   000000 701000 xent               TSX1    FSA$FSP
         1 000744   000000 011000                    NOP     0

     1520     2944    5                  F$DCB.FIELDX=0;

   2944  1 000745   000000 220003                    LDX0    0,DU
         1 000746   200011 470500                    LDP0    JDCB$,,AUTO
         1 000747   000054 440100                    SXL0    44,,PR0

     1521     2945    5                  END;

     1522     2946
     1523     2947    5               IF F$DCB.STARTX~=0 THEN DO;
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:262  

   2947  1 000750   200011 470500                    LDP0    JDCB$,,AUTO
         1 000751   000057 220100                    LDX0    47,,PR0
         1 000752   000774 600000 1                  TZE     s:2954

     1524     2948    5                  T$=PINCRW(B$ROSEG$,F$DCB.STARTX);

   2948  1 000753   000000 636010                    EAQ     0,X0
         1 000754   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000755   200004 756100                    STQ     T$,,AUTO

     1525     2949    5                  L=T$->FM$FIELD_START.NWORDS;

   2949  1 000756   200004 471500                    LDP1    T$,,AUTO
         1 000757   100000 235100                    LDA     0,,PR1
         1 000760   200005 755100                    STA     L,,AUTO

     1526     2950    5                  CALL FSA$FSP(L,T$);

   2950  1 000761   200004 633500                    EPPR3   T$,,AUTO
         1 000762   200017 453500                    STP3    FIELD$+4,,AUTO
         1 000763   200005 634500                    EPPR4   L,,AUTO
         1 000764   200016 454500                    STP4    FIELD$+3,,AUTO
         1 000765   200016 630500                    EPPR0   FIELD$+3,,AUTO
         1 000766   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000767   000000 701000 xent               TSX1    FSA$FSP
         1 000770   000000 011000                    NOP     0

     1527     2951    5                  F$DCB.STARTX=0;

   2951  1 000771   000000 220003                    LDX0    0,DU
         1 000772   200011 470500                    LDP0    JDCB$,,AUTO
         1 000773   000057 740100                    STX0    47,,PR0

     1528     2952    5                  END;

     1529     2953
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:263  
     1530     2954    4               L=FM$FIT.CODES.NDW(I);

   2954  1 000774   200003 471500                    LDP1    @FPT,,AUTO
         1 000775   100013 473500                    LDP3    11,,PR1
         1 000776   200010 721100                    LXL1    I,,AUTO
         1 000777   300000 236111                    LDQ     0,X1,PR3
         1 001000   000012 772000                    QRL     10
         1 001001   001777 376007                    ANQ     1023,DL
         1 001002   200005 756100                    STQ     L,,AUTO

     1531     2955    4               CALL FSA$GSP(L, FIELD$) ALTRET(IFPARERR);

   2955  1 001003   200013 634500                    EPPR4   FIELD$,,AUTO
         1 001004   200017 454500                    STP4    FIELD$+4,,AUTO
         1 001005   200005 633500                    EPPR3   L,,AUTO
         1 001006   200016 453500                    STP3    FIELD$+3,,AUTO
         1 001007   200016 630500                    EPPR0   FIELD$+3,,AUTO
         1 001010   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001011   000000 701000 xent               TSX1    FSA$GSP
         1 001012   001270 702000 1                  TSX2    IFPARERR

     1532     2956    4               L=L*4;

   2956  1 001013   200005 235100                    LDA     L,,AUTO
         1 001014   000002 735000                    ALS     2
         1 001015   200005 755100                    STA     L,,AUTO

     1533     2957    4               FIELD$->MOVEL='0'B;

   2957  1 001016   200013 470500                    LDP0    FIELD$,,AUTO
         1 001017   000000 620005                    EAX0    0,AL
         1 001020   000140 100400                    MLR     fill='000'O
         1 001021   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 001022   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1534     2958    4               F$DCB.FIELDX=POFFW(FIELD$, B$ROSEG$);

PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:264  
   2958  1 001023   000000 235000 xsym               LDA     B$ROSEG$
         1 001024   000022 771000                    ARL     18
         1 001025   200016 755100                    STA     FIELD$+3,,AUTO
         1 001026   200013 236100                    LDQ     FIELD$,,AUTO
         1 001027   000022 772000                    QRL     18
         1 001030   200016 136100                    SBLQ    FIELD$+3,,AUTO
         1 001031   000000 620006                    EAX0    0,QL
         1 001032   200011 470500                    LDP0    JDCB$,,AUTO
         1 001033   000054 440100                    SXL0    44,,PR0

     1535     2959
     1536     2960    4               FIELD$->MOVEL=TEMP$->MOVEL;

   2960  1 001034   200012 471500                    LDP1    TEMP$,,AUTO
         1 001035   200005 721100                    LXL1    L,,AUTO
         1 001036   200013 473500                    LDP3    FIELD$,,AUTO
         1 001037   000140 100540                    MLR     fill='000'O
         1 001040   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         1 001041   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1

     1537     2961    4               IF FIELD$->CODE18.NFIELDS > (L-4)/2 THEN

   2961  1 001042   200005 236100                    LDQ     L,,AUTO
         1 001043   000004 136007                    SBLQ    4,DL
         1 001044   000002 506007                    DIV     2,DL
         1 001045   200013 473500                    LDP3    FIELD$,,AUTO
         1 001046   200016 756100                    STQ     FIELD$+3,,AUTO
         1 001047   300000 236100                    LDQ     0,,PR3
         1 001050   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 001051   200017 756100                    STQ     FIELD$+4,,AUTO
         1 001052   200016 236100                    LDQ     FIELD$+3,,AUTO
         1 001053   200017 116100                    CMPQ    FIELD$+4,,AUTO
         1 001054   001256 603000 1                  TRC     s:3004

     1538     2962    4               FIELD$->CODE18.NFIELDS=(L-4)/2;

   2962  1 001055   200005 236100                    LDQ     L,,AUTO
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:265  
         1 001056   000004 136007                    SBLQ    4,DL
         1 001057   000002 506007                    DIV     2,DL
         1 001060   300000 552134                    STBQ    0,'34'O,PR3

     1539     2963                    /* Set F$DCB.STARTX and FM$FIELD_START later, so we can
     1540     2964                       give better errors and not do it several times.    */
     1541     2965    4               END;

   2965  1 001061   001256 710000 1                  TRA     s:3004

     1542     2966                    /**/
     1543     2967    3         CASE(19); /* IREL key data */

     1544     2968    4            IF NOT F$DCB.FCD THEN DO;

   2968  1 001062   200011 474500                    LDP4    JDCB$,,AUTO
         1 001063   400031 236100                    LDQ     25,,PR4
         1 001064   020000 316007                    CANQ    8192,DL
         1 001065   001256 601000 1                  TNZ     s:3004

     1545     2969    5               IF F$DCB.ALTKEYX~=0 THEN DO;

   2969  1 001066   400052 722100                    LXL2    42,,PR4
         1 001067   001112 600000 1                  TZE     s:2975

     1546     2970    5                  T$=PINCRW(B$ROSEG$,F$DCB.ALTKEYX);

   2970  1 001070   000000 636012                    EAQ     0,X2
         1 001071   000000 036000 xsym               ADLQ    B$ROSEG$
         1 001072   200004 756100                    STQ     T$,,AUTO

     1547     2971    5                  L=T$->FITALTKEYS.NUMWRDS;

   2971  1 001073   200004 475500                    LDP5    T$,,AUTO
         1 001074   500000 236100                    LDQ     0,,PR5
         1 001075   000033 772000                    QRL     27
         1 001076   200005 756100                    STQ     L,,AUTO
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:266  

     1548     2972    5                  CALL FSA$FSP(L,T$);

   2972  1 001077   200004 636500                    EPPR6   T$,,AUTO
         1 001100   200017 456500                    STP6    FIELD$+4,,AUTO
         1 001101   200005 631500                    EPPR1   L,,AUTO
         1 001102   200016 451500                    STP1    FIELD$+3,,AUTO
         1 001103   200016 630500                    EPPR0   FIELD$+3,,AUTO
         1 001104   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001105   000000 701000 xent               TSX1    FSA$FSP
         1 001106   000000 011000                    NOP     0

     1549     2973    5                  F$DCB.ALTKEYX=0;

   2973  1 001107   000000 220003                    LDX0    0,DU
         1 001110   200011 470500                    LDP0    JDCB$,,AUTO
         1 001111   000052 440100                    SXL0    42,,PR0

     1550     2974    5                  END;

     1551     2975    5               IF F$DCB.KFIELDX~=0 THEN DO;

   2975  1 001112   200011 470500                    LDP0    JDCB$,,AUTO
         1 001113   000056 720100                    LXL0    46,,PR0
         1 001114   001136 600000 1                  TZE     s:2981

     1552     2976    5                  T$=PINCRW(B$ROSEG$,F$DCB.KFIELDX);

   2976  1 001115   000000 636010                    EAQ     0,X0
         1 001116   000000 036000 xsym               ADLQ    B$ROSEG$
         1 001117   200004 756100                    STQ     T$,,AUTO

     1553     2977    5                  L=T$->KFIELD.NWORDS;

   2977  1 001120   200004 471500                    LDP1    T$,,AUTO
         1 001121   100000 235100                    LDA     0,,PR1
         1 001122   200005 755100                    STA     L,,AUTO
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:267  

     1554     2978    5                  CALL FSA$FSP(L,T$);

   2978  1 001123   200004 633500                    EPPR3   T$,,AUTO
         1 001124   200017 453500                    STP3    FIELD$+4,,AUTO
         1 001125   200005 634500                    EPPR4   L,,AUTO
         1 001126   200016 454500                    STP4    FIELD$+3,,AUTO
         1 001127   200016 630500                    EPPR0   FIELD$+3,,AUTO
         1 001130   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001131   000000 701000 xent               TSX1    FSA$FSP
         1 001132   000000 011000                    NOP     0

     1555     2979    5                  F$DCB.KFIELDX=0;

   2979  1 001133   000000 220003                    LDX0    0,DU
         1 001134   200011 470500                    LDP0    JDCB$,,AUTO
         1 001135   000056 440100                    SXL0    46,,PR0

     1556     2980    5                  END;

     1557     2981    4               CALL FMG$IRSETUP(CODE19) ALTRET(IFPARERR);

   2981  1 001136   200012 630500                    EPPR0   TEMP$,,AUTO
         1 001137   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001140   000000 701000 xent               TSX1    FMG$IRSETUP
         1 001141   001270 702000 1                  TSX2    IFPARERR

     1558     2982    4               END;

   2982  1 001142   001256 710000 1                  TRA     s:3004

     1559     2983                    /**/
     1560     2984    3         CASE(21); /* Logical field data */

     1561     2985    4            IF NOT F$DCB.FCD THEN DO;

   2985  1 001143   200011 474500                    LDP4    JDCB$,,AUTO
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:268  
         1 001144   400031 236100                    LDQ     25,,PR4
         1 001145   020000 316007                    CANQ    8192,DL
         1 001146   001256 601000 1                  TNZ     s:3004

     1562     2986    5               IF F$DCB.IRRECX ~= 0 THEN DO;

   2986  1 001147   400061 222100                    LDX2    49,,PR4
         1 001150   001176 600000 1                  TZE     s:2992

     1563     2987    5                  T$=PINCRW(B$ROSEG$,F$DCB.IRRECX);

   2987  1 001151   000000 636012                    EAQ     0,X2
         1 001152   000000 036000 xsym               ADLQ    B$ROSEG$
         1 001153   200004 756100                    STQ     T$,,AUTO

     1564     2988    5                  L=(T$->CODE21.NFIELDS+3)/4 + 1;

   2988  1 001154   200004 475500                    LDP5    T$,,AUTO
         1 001155   500000 236100                    LDQ     0,,PR5
         1 001156   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 001157   000003 036007                    ADLQ    3,DL
         1 001160   000002 772000                    QRL     2
         1 001161   000001 036007                    ADLQ    1,DL
         1 001162   200005 756100                    STQ     L,,AUTO

     1565     2989    5                  CALL FSA$FSP(L,T$);

   2989  1 001163   200004 636500                    EPPR6   T$,,AUTO
         1 001164   200017 456500                    STP6    FIELD$+4,,AUTO
         1 001165   200005 631500                    EPPR1   L,,AUTO
         1 001166   200016 451500                    STP1    FIELD$+3,,AUTO
         1 001167   200016 630500                    EPPR0   FIELD$+3,,AUTO
         1 001170   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001171   000000 701000 xent               TSX1    FSA$FSP
         1 001172   000000 011000                    NOP     0

     1566     2990    5                  F$DCB.IRRECX=0;
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:269  

   2990  1 001173   000000 220003                    LDX0    0,DU
         1 001174   200011 470500                    LDP0    JDCB$,,AUTO
         1 001175   000061 740100                    STX0    49,,PR0

     1567     2991    5                  END;

     1568     2992    4               L=FM$FIT.CODES.NDW(I);

   2992  1 001176   200003 470500                    LDP0    @FPT,,AUTO
         1 001177   000013 471500                    LDP1    11,,PR0
         1 001200   200010 720100                    LXL0    I,,AUTO
         1 001201   100000 236110                    LDQ     0,X0,PR1
         1 001202   000012 772000                    QRL     10
         1 001203   001777 376007                    ANQ     1023,DL
         1 001204   200005 756100                    STQ     L,,AUTO

     1569     2993    4               CALL FSA$GSP(L,T$) ALTRET(IFPARERR);

   2993  1 001205   200004 633500                    EPPR3   T$,,AUTO
         1 001206   200017 453500                    STP3    FIELD$+4,,AUTO
         1 001207   200005 631500                    EPPR1   L,,AUTO
         1 001210   200016 451500                    STP1    FIELD$+3,,AUTO
         1 001211   200016 630500                    EPPR0   FIELD$+3,,AUTO
         1 001212   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001213   000000 701000 xent               TSX1    FSA$GSP
         1 001214   001270 702000 1                  TSX2    IFPARERR

     1570     2994    4               L=L*4;

   2994  1 001215   200005 235100                    LDA     L,,AUTO
         1 001216   000002 735000                    ALS     2
         1 001217   200005 755100                    STA     L,,AUTO

     1571     2995    4               T$->MOVEL='0'B;

   2995  1 001220   200004 470500                    LDP0    T$,,AUTO
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:270  
         1 001221   000000 620005                    EAX0    0,AL
         1 001222   000140 100400                    MLR     fill='000'O
         1 001223   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 001224   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1572     2996    4               F$DCB.IRRECX=POFFW(T$,B$ROSEG$);

   2996  1 001225   000000 235000 xsym               LDA     B$ROSEG$
         1 001226   000022 771000                    ARL     18
         1 001227   200016 755100                    STA     FIELD$+3,,AUTO
         1 001230   200004 236100                    LDQ     T$,,AUTO
         1 001231   000022 772000                    QRL     18
         1 001232   200016 136100                    SBLQ    FIELD$+3,,AUTO
         1 001233   000000 620006                    EAX0    0,QL
         1 001234   200011 470500                    LDP0    JDCB$,,AUTO
         1 001235   000061 740100                    STX0    49,,PR0

     1573     2997    4               T$->MOVEL=TEMP$->MOVEL;

   2997  1 001236   200012 471500                    LDP1    TEMP$,,AUTO
         1 001237   200005 721100                    LXL1    L,,AUTO
         1 001240   200004 473500                    LDP3    T$,,AUTO
         1 001241   000140 100540                    MLR     fill='000'O
         1 001242   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         1 001243   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1

     1574     2998    4               IF T$->CODE21.NFIELDS > L-4 THEN

   2998  1 001244   200004 473500                    LDP3    T$,,AUTO
         1 001245   300000 236100                    LDQ     0,,PR3
         1 001246   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 001247   200016 756100                    STQ     FIELD$+3,,AUTO
         1 001250   200005 236100                    LDQ     L,,AUTO
         1 001251   000004 136007                    SBLQ    4,DL
         1 001252   200016 116100                    CMPQ    FIELD$+3,,AUTO
         1 001253   001256 605000 1                  TPL     s:3004

PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:271  
     1575     2999    4               T$->CODE21.NFIELDS=L-4;

   2999  1 001254   300000 552134                    STBQ    0,'34'O,PR3

     1576     3000    4               END;

   3000  1 001255   001256 710000 1                  TRA     s:3004

     1577     3001                    /**/
     1578     3002    3         CASE(ELSE);

     1579     3003    3         END;  /* DO CASE(FM$FIT.CODES.CODE(I)) */

     1580     3004    2         END;  /* DO I=1 TO J */

   3004  1 001256   200010 235100                    LDA     I,,AUTO
         1 001257   000001 035007                    ADLA    1,DL
         1 001260   200010 755100                    STA     I,,AUTO
         1 001261   200007 236100                    LDQ     J,,AUTO
         1 001262   200010 116100                    CMPQ    I,,AUTO
         1 001263   000042 603000 1                  TRC     s:2833

     1581     3005    1      RETURN;

   3005  1 001264   000000 702200 xent               TSX2  ! X66_ARET

   2998  1 001265                       FMME$BADVEC* null
     1582     3006    1   FMME$BADVECT11:;
     1583     3007    1      B$JIT.ERR=FMM$E$BADVECT11;

   3007  1 001265   000000 236000 0                  LDQ     FMM$E$BADVECT11
         1 001266   000000 470400 xsym               LDP0    B$JIT$
         1 001267   000012 756100                    STQ     10,,PR0

     1584     3008    1   IFPARERR: ALTRETURN;

   3008  1 001270   000000 702200 xent  IFPARERR     TSX2  ! X66_AALT
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:272  

FMM$E$BADVECT11
 Sect OctLoc
   0     000   061515 006572                                                    1...

IFPARMSZ
 Sect OctLoc
   0     001   000000 000000   000000 000000   000000 000004   000000 000011    ................
   0     005   000000 000013   000000 000003   000000 000003   000000 000002    ................
   0     011   000000 000007   000000 000000   000000 000000   000000 000000    ................
   0     015   000000 000000   000000 000000   000000 000010   000000 000000    ................
   0     021   000000 000047   000000 000022   000000 000002   000000 000002    ...'............
   0     025   000000 000005   000000 000002                                    ........

(unnamed)
 Sect OctLoc
   2     000   000003 776000   000000 000047   000001 006000   777377 777777    .......'........
   2     004   777577 777777   777737 777777   777677 777777   777767 777777    ................
   2     010   000000 000022   000010 006000                                    ........
     1585     3009    1   END FMM$IFPARAM;
     1586     3010        %EOD;

PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:273  
--  Include file information  --

   UD_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
   FM_FIELD_C.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   F$CP6P_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FMM$IFPARAM.
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:274  

 **** Variables and constants ****

  ****  Section 000 RoData FMM$IFPARAM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b STRC        r     1 FMM$E$BADVECT11
     1-0-0/w UBIN        r     1 IFPARMSZ(0:21)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FPT                      13-0-0/w PTR         r     1 FIELD$
    *0-0-0/w STRC(684)   r     1 FPT                       10-0-0/w UBIN        r     1 I
     7-0-0/w UBIN        r     1 J                         11-0-0/w PTR         r     1 JDCB$
     6-0-0/w UBIN        r     1 K                          5-0-0/w UBIN        r     1 L
     4-0-0/w PTR         r     1 T$                        12-0-0/w PTR         r     1 TEMP$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$PS$(0:0)
     0-0-0/w PTR         r     1 B$ROSEG$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/w STRC(135)   r     1 CODE02
     0-0-0/w STRC(324)   r     1 CODE03                     0-0-0/w STRC(396)   r     1 CODE04
     0-0-0/w STRC(108)   r     1 CODE05                     0-0-0/w STRC(108)   r     1 CODE06
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:275  
     0-0-0/w STRC(72)    r     1 CODE07                     0-0-0/w STRC(288)   r     1 CODE14
     0-0-0/w STRC(1404)  r     1 CODE16                     0-0-0/w STRC(54)    r     1 CODE18
     0-0-0/w STRC(54)    r     1 CODE19                     0-0-0/w STRC(45)    r     1 CODE21
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(4572)  r     1 FITALTKEYS
     0-0-0/w STRC(72)    r     1 FM$FIELD_START             0-0-0/w STRC(1116)  r     1 FM$FIT
     0-0-0/w STRC(81)    r     1 KFIELD                     0-0-0/c ASTR(0)     r     1 MOVEL
     0-0-0/d STRC(612)   r     1 VLP$FPRG


   Procedure FMM$IFPARAM requires 697 words for executable code.
   Procedure FMM$IFPARAM requires 18 words of local(AUTO) storage.
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:276  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:277  
          MINI XREF LISTING

B$JIT.DCB$
       444**DCL      2826>>ASSIGN
B$JIT.ERR
       354**DCL      3007<<ASSIGN
B$JIT.ERR.MID
       355**DCL       355--REDEF
B$JIT$
      2817**DCL       349--IMP-PTR  2826>>ASSIGN   3007>>ASSIGN
B$PS$
      2819**DCL      2909>>ASSIGN   2913>>ASSIGN   2917>>ASSIGN   2921>>ASSIGN   2925>>ASSIGN
B$ROSEG$
      2818**DCL      2873>>ASSIGN   2879>>ASSIGN   2890>>ASSIGN   2932>>ASSIGN   2934>>ASSIGN   2941>>ASSIGN
      2948>>ASSIGN   2958>>ASSIGN   2970>>ASSIGN   2976>>ASSIGN   2987>>ASSIGN   2996>>ASSIGN
CODE02
      2091**DCL      2788--DCLINIT
CODE02.KEYL
      2092**DCL      2843>>IF       2844>>ASSIGN
CODE02.KEYX
      2092**DCL      2845>>ASSIGN
CODE02.LRDL0
      2091**DCL      2841>>IF       2841>>ASSIGN
CODE02.LSLIDE
      2091**DCL      2840>>IF       2840>>ASSIGN
CODE02.SPARE
      2091**DCL      2842>>IF       2842>>ASSIGN
CODE03
      2095**DCL      2789--DCLINIT
CODE03.COMP
      2097**DCL      2855>>IF
CODE03.DESC
      2095**DCL      2858>>IF
CODE03.DESC.BUPM
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:278  
      2096**DCL      2858>>ASSIGN
CODE03.EXPIRE
      2098**DCL      2860>>IF       2860>>ASSIGN
CODE03.GHSTACS
      2097**DCL      2861>>IF       2861>>ASSIGN
CODE03.NRECS
      2097**DCL      2853>>IF       2854>>ASSIGN
CODE03.ORG
      2095**DCL      2850>>IF       2850>>ASSIGN
CODE03.RECL
      2098**DCL      2852>>IF       2852>>ASSIGN
CODE03.TYPE
      2097**DCL      2857>>IF       2857>>ASSIGN
CODE03.UGRANS
      2095**DCL      2851>>IF       2851>>ASSIGN
CODE03.XTNSIZE
      2098**DCL      2859>>IF       2859>>ASSIGN
CODE04
      2104**DCL      2790--DCLINIT
CODE05
      2110**DCL      2791--DCLINIT
CODE06
      2113**DCL      2792--DCLINIT
CODE06.STOW.EFT
      2113**DCL      2114--REDEF
CODE07
      2117**DCL      2793--DCLINIT
CODE07.PASS
      2117**DCL      2865>>ASSIGN
CODE14
      2128**DCL      2796--DCLINIT
CODE16
      2136**DCL      2797--DCLINIT  2903--CALL     2904<<ASSIGN   2904>>ASSIGN
CODE18.DECFIELD
      2165**DCL      2166--REDEF
CODE18.NFIELDS
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:279  
      2165**DCL      2942>>ASSIGN   2961>>IF       2962<<ASSIGN
CODE19
      2169**DCL      2981<>CALL
CODE21.NFIELDS
      2172**DCL      2988>>ASSIGN   2998>>IF       2999<<ASSIGN
F$DCB.ACTPOS
      2057**DCL      2057--REDEF
F$DCB.ALTKEYX
      2055**DCL      2872>>IF       2873>>ASSIGN   2876<<ASSIGN   2890<<ASSIGN   2969>>IF       2970>>ASSIGN
      2973<<ASSIGN
F$DCB.AMFLG.ACCF
      2061**DCL      2908<<ASSIGN
F$DCB.AMFLG.ACSF
      2061**DCL      2912<<ASSIGN
F$DCB.AMFLG.INSF
      2061**DCL      2920<<ASSIGN
F$DCB.AMFLG.PROF
      2062**DCL      2924<<ASSIGN
F$DCB.AMFLG.USRF
      2062**DCL      2916<<ASSIGN
F$DCB.ARS
      2032**DCL      2032--REDEF
F$DCB.ATTR
      2050**DCL      2051--REDEF
F$DCB.BORROW
      2065**DCL      2065--REDEF    2065--REDEF    2065--REDEF
F$DCB.BUPM
      2046**DCL      2858<<ASSIGN
F$DCB.COMP
      2045**DCL      2855<<ASSIGN
F$DCB.DCBNAME.L
      2079**DCL      2079--IMP-SIZ
F$DCB.EOMCHAR
      2036**DCL      2036--REDEF
F$DCB.EXPIRE
      2048**DCL      2860<<ASSIGN
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:280  
F$DCB.FCD
      2045**DCL      2843>>IF       2849>>IF       2863>>IF       2869>>IF       2901>>IF       2929>>IF
      2939>>IF       2968>>IF       2985>>IF
F$DCB.FIELDX
      2056**DCL      2940>>IF       2941>>ASSIGN   2944<<ASSIGN   2958<<ASSIGN
F$DCB.FLDID
      2060**DCL      2060--REDEF
F$DCB.FORM$
      2054**DCL      2054--REDEF    2902>>IF       2903<>CALL     2904>>ASSIGN
F$DCB.FPRGX
      2056**DCL      2930>>IF       2932<<ASSIGN   2934>>ASSIGN
F$DCB.FSECT
      2070**DCL      2070--REDEF
F$DCB.FSN
      2047**DCL      2047--REDEF    2047--REDEF    2048--REDEF
F$DCB.GHSTACS
      2055**DCL      2861<<ASSIGN
F$DCB.HEADER$
      2053**DCL      2053--REDEF
F$DCB.IRRECX
      2060**DCL      2986>>IF       2987>>ASSIGN   2990<<ASSIGN   2996<<ASSIGN
F$DCB.IXTNSIZE
      2051**DCL      2051--REDEF    2851<<ASSIGN
F$DCB.KEYL
      2049**DCL      2844<<ASSIGN
F$DCB.KEYX
      2048**DCL      2845<<ASSIGN
F$DCB.KFIELDX
      2057**DCL      2878>>IF       2879>>ASSIGN   2882<<ASSIGN   2975>>IF       2976>>ASSIGN   2979<<ASSIGN
F$DCB.LASTSTA$
      2041**DCL      2041--REDEF
F$DCB.LRDL0
      2049**DCL      2841<<ASSIGN
F$DCB.LSLIDE
      2049**DCL      2840<<ASSIGN
F$DCB.LVL
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:281  
      2066**DCL      2066--REDEF
F$DCB.NAME.C
      2041**DCL      2041--REDEF
F$DCB.NOEOF
      2062**DCL      2062--REDEF
F$DCB.NRECS
      2052**DCL      2052--REDEF    2854<<ASSIGN
F$DCB.NRECX
      2071**DCL      2071--REDEF
F$DCB.OHDR
      2063**DCL      2063--REDEF
F$DCB.ORG
      2046**DCL      2046--REDEF    2850<<ASSIGN   2853>>IF       2869>>IF
F$DCB.PASS
      2042**DCL      2865<<ASSIGN
F$DCB.PASSF
      2044**DCL      2864<<ASSIGN
F$DCB.PRECNO
      2069**DCL      2069--REDEF
F$DCB.RCSZ
      2074**DCL      2074--REDEF
F$DCB.RECL
      2047**DCL      2852<<ASSIGN
F$DCB.RES
      2042**DCL      2042--REDEF
F$DCB.SETX
      2054**DCL      2054--REDEF
F$DCB.SPARE
      2049**DCL      2842<<ASSIGN
F$DCB.STARTX
      2057**DCL      2947>>IF       2948>>ASSIGN   2951<<ASSIGN
F$DCB.TAB$
      2053**DCL      2054--REDEF
F$DCB.TDA
      2068**DCL      2068--REDEF
F$DCB.TYPE
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:282  
      2042**DCL      2857<<ASSIGN
F$DCB.WSN
      2043**DCL      2043--REDEF
F$DCB.XTNSIZE
      2049**DCL      2859<<ASSIGN
FIELD$
      2813**DCL      2941<<ASSIGN   2942>>ASSIGN   2943<>CALL     2955<>CALL     2957>>ASSIGN   2958>>ASSIGN
      2960>>ASSIGN   2961>>IF       2962>>ASSIGN
FITALTKEYS.K
      2121**DCL      2891--ASSIGN
FITALTKEYS.K.KEYL
      2121**DCL      2895<<ASSIGN   2895>>ASSIGN
FITALTKEYS.K.KEYX
      2121**DCL      2894<<ASSIGN   2894>>ASSIGN
FITALTKEYS.K.UNIQUE
      2122**DCL      2896<<ASSIGN   2896>>ASSIGN
FITALTKEYS.NUMENTS
      2120**DCL      2891<<ASSIGN   2891>>ASSIGN   2893>>DOINDEX
FITALTKEYS.NUMWRDS
      2120**DCL      2874>>ASSIGN   2889<<ASSIGN   2971>>ASSIGN
FM$FIELD_START.NWORDS
      2191**DCL      2949>>ASSIGN
FM$FIT.CODES.CODE
      2088**DCL      2827>>ASSIGN   2834>>IF       2837>>DOCASE
FM$FIT.CODES.ITEMX
      2088**DCL      2833>>ASSIGN   2834>>IF       2834>>IF
FM$FIT.CODES.NDW
      2088**DCL      2834>>IF       2869>>IF       2884>>ASSIGN   2954>>ASSIGN   2992>>ASSIGN
FMG$IRSETUP
      2822**DCL-ENT  2981--CALL
FMM$E$BADVECT11
      2784**DCL      3007>>ASSIGN
FMME$BADVECT11
      2998**LABEL    2830--GOTO     2836--GOTO
FPT
      2082**DCL        25--PROC
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:283  
FPT.ACCESS_
      2082**DCL      2909>>IF       2909<<ASSIGN
FPT.ACSVEH_
      2083**DCL      2083--REDEF    2913>>IF       2913<<ASSIGN
FPT.ALTKEYS_
      2085**DCL      2085--REDEF    2085--REDEF
FPT.HDR_
      2084**DCL      2084--REDEF
FPT.IFPARAM_
      2083**DCL      2088--IMP-PTR  2827>>ASSIGN   2828--CALL     2833>>ASSIGN   2833>>ASSIGN   2834>>IF
      2834>>IF       2834>>IF       2834>>IF       2837>>DOCASE   2869>>IF       2884>>ASSIGN   2909--ASSIGN
      2913--ASSIGN   2917--ASSIGN   2921--ASSIGN   2925--ASSIGN   2954>>ASSIGN   2992>>ASSIGN
FPT.INSTATTR_
      2083**DCL      2921>>IF       2921<<ASSIGN
FPT.PROCATTR_
      2083**DCL      2925>>IF       2925<<ASSIGN
FPT.TAB_
      2084**DCL      2084--REDEF
FPT.UATTR_
      2083**DCL      2917>>IF       2917<<ASSIGN
FPT.UHL_
      2082**DCL      2082--REDEF    2082--REDEF
FPT.V_
      2082**DCL      2828--CALL     2909--ASSIGN   2913--ASSIGN   2917--ASSIGN   2921--ASSIGN   2925--ASSIGN
FPT.WSN_
      2084**DCL      2084--REDEF
FSA$FSP
      2821**DCL-ENT  2875--CALL     2881--CALL     2943--CALL     2950--CALL     2972--CALL     2978--CALL
      2989--CALL
FSA$GSP
      2823**DCL-ENT  2885--CALL     2903--CALL     2931--CALL     2955--CALL     2993--CALL
HFF$DSIZ
      2824**DCL-ENT  2828--CALL
I
      2810**DCL      2832<<DOINDEX  2833>>ASSIGN   2834>>IF       2834>>IF       2834>>IF       2834>>IF
      2837>>DOCASE   2869>>IF       2884>>ASSIGN   2954>>ASSIGN   2992>>ASSIGN
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:284  
IFPARERR
      3008**LABEL    2885--CALLALT  2903--CALLALT  2931--CALLALT  2955--CALLALT  2981--CALLALT  2993--CALLALT
IFPARMSZ
      2787**DCL      2834>>IF
J
      2809**DCL      2827<<ASSIGN   2830>>IF       2832>>DOINDEX
JDCB$
      2811**DCL      2032--IMP-PTR  2826<<ASSIGN   2840>>ASSIGN   2841>>ASSIGN   2842>>ASSIGN   2843>>IF
      2844>>ASSIGN   2845>>ASSIGN   2849>>IF       2850>>ASSIGN   2851>>ASSIGN   2852>>ASSIGN   2853>>IF
      2854>>ASSIGN   2855>>ASSIGN   2857>>ASSIGN   2858>>ASSIGN   2859>>ASSIGN   2860>>ASSIGN   2861>>ASSIGN
      2863>>IF       2864>>ASSIGN   2865>>ASSIGN   2869>>IF       2869>>IF       2872>>IF       2873>>ASSIGN
      2876>>ASSIGN   2878>>IF       2879>>ASSIGN   2882>>ASSIGN   2890>>ASSIGN   2901>>IF       2902>>IF
      2903>>CALL     2904>>ASSIGN   2908>>ASSIGN   2912>>ASSIGN   2916>>ASSIGN   2920>>ASSIGN   2924>>ASSIGN
      2929>>IF       2930>>IF       2932>>ASSIGN   2934>>ASSIGN   2939>>IF       2940>>IF       2941>>ASSIGN
      2944>>ASSIGN   2947>>IF       2948>>ASSIGN   2951>>ASSIGN   2958>>ASSIGN   2968>>IF       2969>>IF
      2970>>ASSIGN   2973>>ASSIGN   2975>>IF       2976>>ASSIGN   2979>>ASSIGN   2985>>IF       2986>>IF
      2987>>ASSIGN   2990>>ASSIGN   2996>>ASSIGN
K
      2808**DCL      2828<>CALL     2829<<ASSIGN   2829>>ASSIGN   2830>>IF       2834>>IF       2834>>IF
KFIELD.NWORDS
      2175**DCL      2880>>ASSIGN   2977>>ASSIGN
L
      2807**DCL      2804--IMP-SIZ  2874<<ASSIGN   2875<>CALL     2880<<ASSIGN   2881<>CALL     2884<<ASSIGN
      2885<>CALL     2886<<ASSIGN   2886>>ASSIGN   2887>>ASSIGN   2888<<ASSIGN   2888>>ASSIGN   2889>>ASSIGN
      2891>>ASSIGN   2893<<DOINDEX  2894>>ASSIGN   2894>>ASSIGN   2895>>ASSIGN   2895>>ASSIGN   2896>>ASSIGN
      2896>>ASSIGN   2942<<ASSIGN   2943<>CALL     2949<<ASSIGN   2950<>CALL     2954<<ASSIGN   2955<>CALL
      2956<<ASSIGN   2956>>ASSIGN   2957>>ASSIGN   2960>>ASSIGN   2960>>ASSIGN   2961>>IF       2962>>ASSIGN
      2971<<ASSIGN   2972<>CALL     2977<<ASSIGN   2978<>CALL     2988<<ASSIGN   2989<>CALL     2992<<ASSIGN
      2993<>CALL     2994<<ASSIGN   2994>>ASSIGN   2995>>ASSIGN   2997>>ASSIGN   2997>>ASSIGN   2998>>IF
      2999>>ASSIGN
MOVEL
      2803**DCL      2887<<ASSIGN   2957<<ASSIGN   2960<<ASSIGN   2960>>ASSIGN   2995<<ASSIGN   2997<<ASSIGN
      2997>>ASSIGN
T$
      2806**DCL      2873<<ASSIGN   2874>>ASSIGN   2875<>CALL     2879<<ASSIGN   2880>>ASSIGN   2881<>CALL
      2885<>CALL     2887>>ASSIGN   2889>>ASSIGN   2890>>ASSIGN   2891>>ASSIGN   2893>>DOINDEX  2894>>ASSIGN
PL6.E3A0      #002=FMM$IFPARAM File=FMM$OPN.:E05TSI                              TUE 07/29/97 16:52 Page:285  
      2895>>ASSIGN   2896>>ASSIGN   2931<>CALL     2932>>ASSIGN   2934<<ASSIGN   2935>>ASSIGN   2948<<ASSIGN
      2949>>ASSIGN   2950<>CALL     2970<<ASSIGN   2971>>ASSIGN   2972<>CALL     2976<<ASSIGN   2977>>ASSIGN
      2978<>CALL     2987<<ASSIGN   2988>>ASSIGN   2989<>CALL     2993<>CALL     2995>>ASSIGN   2996>>ASSIGN
      2997>>ASSIGN   2998>>IF       2999>>ASSIGN
TEMP$
      2812**DCL      2091--IMP-PTR  2095--IMP-PTR  2104--IMP-PTR  2110--IMP-PTR  2113--IMP-PTR  2117--IMP-PTR
      2120--IMP-PTR  2128--IMP-PTR  2136--IMP-PTR  2154--IMP-PTR  2165--IMP-PTR  2169--IMP-PTR  2172--IMP-PTR
      2833<<ASSIGN   2840>>IF       2840>>ASSIGN   2841>>IF       2841>>ASSIGN   2842>>IF       2842>>ASSIGN
      2843>>IF       2844>>ASSIGN   2845>>ASSIGN   2850>>IF       2850>>ASSIGN   2851>>IF       2851>>ASSIGN
      2852>>IF       2852>>ASSIGN   2853>>IF       2854>>ASSIGN   2855>>IF       2857>>IF       2857>>ASSIGN
      2858>>IF       2858>>ASSIGN   2859>>IF       2859>>ASSIGN   2860>>IF       2860>>ASSIGN   2861>>IF
      2861>>ASSIGN   2865>>ASSIGN   2891>>ASSIGN   2894>>ASSIGN   2895>>ASSIGN   2896>>ASSIGN   2904>>ASSIGN
      2935>>ASSIGN   2960>>ASSIGN   2981>>CALL     2997>>ASSIGN
VLP$FPRG
      2154**DCL      2798--DCLINIT  2931--CALL     2935<<ASSIGN   2935>>ASSIGN

PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:286  
     1587        1        /*T***********************************************************/
     1588        2        /*T*                                                         */
     1589        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1590        4        /*T*                                                         */
     1591        5        /*T***********************************************************/
     1592        6                    /*F*  NAME:     FMM$GETAMR
     1593        7                    *     PURPOSE:  GET THE ASSIGN MERGE RECORD FOR THIS DCB.
     1594        8                    */
     1595        9                    /*D*
     1596       10                     NAME:     FMM$GETAMR
     1597       11                     CALL:     CALL FMM$GETAMR(DCB$,BUF$) ALTRET(RTN)
     1598       12
     1599       13                     WHERE DCB$ POINTS TO THE CURRENT DCB
     1600       14                     BUF$ IS RETURNED POINTING TO THE RECORD.
     1601       15                     ALTRET SPECIFIES EITHER AN ERROR CONDITION
     1602       16                     SPECIFIED IN B$JIT.ERR.CODE OR (IF CODE
     1603       17                     INDICATES 'KEY NOT FOUND') THAT NO AMR
     1604       18                     EXISTS FOR THIS DCB.
     1605       19
     1606       20                     OUTPUT:   THE AMR IF FOUND IS CONTAINED IN F$DCB.BUFR1.BUFX(0).
     1607       21
     1608       22                     DESCRIPTION:  FMM$GETAMR GETS A FILE MANAGEMENT BUFFER, THEN
     1609       23                     USES THE M$STAR DCB TO READ THE AMR FOR THE SPECIFIED
     1610       24                     DCB (KEY IS THE DCB NAME) INTO THE BUFFER.  IF M$STAR
     1611       25                     IS ALREADY OPEN OR CANNOT BE OPENED, THE ALTRET IS
     1612       26                     TAKEN. IF THERE IS NO AMR FOR THIS DCB, THE ALTRET IS
     1613       27                     ALSO TAKEN.  IF M$STAR WAS OPENED SUCCESSFULLY, IT IS
     1614       28                     CLOSED BEFORE THE RETURN.  ON THE ALTRETURN THE FILE
     1615       29                     MANAGEMENT BUFFER WILL HAVE BEEN RETURNED.
     1616       30
     1617       31                    */
     1618       32        FMM$GETAMR: PROC(JDCB$,BUF$) ALTRET;
     1619       33                    /*F*  NAME:     FMM$READAMR
     1620       34                    *     PURPOSE:  READ THE ASSIGN MERGE RECORD FOR THIS DCB.
     1621       35                    */
     1622       36                    /*D*
     1623       37                    *     NAME:     FMM$READAMR
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:287  
     1624       38                    *     CALL:     CALL FMM$READAMR(DCB$,BUF$) ALTRET(RTN)
     1625       39                    *
     1626       40                    *     INPUT:          DCB$ POINTS TO THE CURRENT DCB.
     1627       41                    *                     BUF$ POINTS TO AN FM BUFFER.
     1628       42                    *
     1629       43                    *                     ALTRET SPECIFIES EITHER AN ERROR CONDITION
     1630       44                    *                     SPECIFIED IN B$JIT.ERR.CODE OR (IF CODE
     1631       45                    *                     INDICATES 'KEY NOT FOUND') THAT NO AMR
     1632       46                    *                     EXISTS FOR THIS DCB.
     1633       47                    *
     1634       48                    *     OUTPUT:   THE AMR IF FOUND IS READ INTO THE BUF$ AREA.
     1635       49                    *
     1636       50                    *     DESCRIPTION:  FMM$READAMR USES THE M$STAR DCB TO READ THE AMR FOR
     1637       51                    *               THE SPECIFIED DCB (KEY IS THE DCB NAME).  IF THIS DCB
     1638       52                    *               IS DEFINED AS #1, #2, OR #3 THAT AMR IS OBTAINED
     1639       53                    *               INSTEAD OF THE AMR KEYED BY THE DCB NAME.
     1640       54                    *               IF THERE IS NO AMR FOR THIS DCB, THE ALTRET IS TAKEN.
     1641       55                    *               IF THE M$* DCB HAS NOT BEEN OPENED, THE ALTRET
     1642       56                    *               IS ALSO TAKEN.
     1643       57                    *
     1644       58                    */
     1645       59        %INCLUDE CP_6_SUBS;
     1646      599                    /**/
     1647      600                    /* ENTRYIS */
     1648      601                    /**/
     1649      602    1   DCL FMD$GETBUF ENTRY(3);
     1650      603    1   DCL FMD$RELBUF ENTRY(1);
     1651      604    1   DCL FMM$DFLOPNP ENTRY;
     1652      605    1   DCL FMP$CLSTAR ENTRY;
     1653      606        %MACRO F$DCB#(BASED=BASED);
     1654      607        %INCLUDE F$DCB;
     1655      656        %MEND;
     1656      657        %F$DCB#(BASED="BASED(JDCB$)");
     1657      707        %INCLUDE F_CP6;
     1658     1732        %INCLUDE F$JIT_C;
     1659     2162        %INCLUDE FM_OPLBL_R;
     1660     2176    1   DCL M$MREAD ENTRY(1)ALTRET; /* INTRA MONITOR M$READ */
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:288  
     1661     2177                    /**/
     1662     2178                    /* PARAMETER DATA */
     1663     2179                    /**/
     1664     2180    1   DCL JDCB$ PTR; /* INPUT DCB--GET IT'S AMR */
     1665     2181    1   DCL BUF$ PTR; /* PTR TO FM BUFFER */
     1666     2182                    /**/
     1667     2183                    /* AUTOMATIC DATA */
     1668     2184                    /**/
     1669     2185    1   DCL I UBIN;
     1670     2186    1   DCL ENT# SBIN; /* -1=GET,0=READ,1=OPN */
     1671     2187        %FPT_READ (FPTN=RSTARA,STCLASS=AUTO);
     1672     2226                    /**/
     1673     2227                    /* SYMREF DATA */
     1674     2228                    /**/
     1675     2229    1   DCL B$JIT$ PTR SYMREF; /* POINTER TO THE JIT */
     1676     2230    1   DCL 1 AMRKEY BASED(BUF$) ALIGNED,
     1677     2231    1         2 L UBIN BYTE UNAL,
     1678     2232    1         2 N CHAR(31);
     1679     2233    1   DCL 1 DCBNAME ALIGNED BASED,
     1680     2234    1         2 * BIT(3),
     1681     2235    1         2 M$ BIT(24);
     1682     2236                    /**/
     1683     2237                    /* CONSTANT DATA */
     1684     2238                    /**/
     1685     2239        %FPT_READ(FPTN=RSTARC,STCLASS=CONSTANT,KEYS=YES);
     1686     2278        %VLP_NAME(FPTN=STARA,NAME='*A',STCLASS=CONSTANT);
     1687     2305                    /**/
     1688     2306                    /* PROCEDURE */
     1689     2307                    /**/
     1690     2308    1      ENT#=-1;
     1691     2309    1      CALL FMD$GETBUF(0,1,BUF$);
     1692     2310    1      B$JIT.DCB$=DCBADDR(1);
     1693     2311    1      GOTO OPNAMR;
     1694     2312    1   FMM$OPNAMR: ENTRY ALTRET;
     1695     2313    1      ENT#=1;
     1696     2314    1   OPNAMR:;
     1697     2315    1      IF B$JIT.DCB$->F$DCB.FCD THEN CALL FMP$CLSTAR;
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:289  
     1698     2316    1      B$JIT.ERR='0'B;
     1699     2317    1      B$JIT.DCB$->F$DCB.NAME=STARA;
     1700     2318    1      B$JIT.DCB$->F$DCB.ASN=%FILE#;
     1701     2319    1      B$JIT.DCB$->F$DCB.FUN=%IN#;
     1702     2320    1      B$JIT.DCB$->F$DCB.SHARE=%NONE#;
     1703     2321    1      B$JIT.DCB$->F$DCB.AMFLG='0'B;
     1704     2322    1      CALL FMM$DFLOPNP;
     1705     2323    1      IF B$JIT.ERR.CODE~=0 THEN GOTO RETALT;
     1706     2324    1      IF ENT#>0 THEN RETURN; /* OPNAMR CALL */
     1707     2325    1      GOTO READAMR;
     1708     2326    1   FMM$READAMR: ENTRY(JDCB$,BUF$) ALTRET;
     1709     2327    1      ENT#=0;
     1710     2328    1      IF NOT B$JIT.DCB$->F$DCB.FCD THEN ALTRETURN;
     1711     2329                    /* DON'T READ IF M$* ISN'T OPEN */
     1712     2330                    /*
     1713     2331                    *  SET UP THE READ FPT
     1714     2332                    */
     1715     2333    1   READAMR:;
     1716     2334    1      RSTARA=RSTARC;
     1717     2335    1      RSTARA.V_=VECTOR(RSTARA.V);
     1718     2336    1      RSTARA.BUF_.BOUND=4095;
     1719     2337                    /*
     1720     2338                    *  TRY FOR A PROCESSOR CALL LINE RECORD IF DCBNAME.X ISNT 0
     1721     2339                    */
     1722     2340    1      I=F$DCB.DCBNAME.X;
     1723     2341    1      RSTARA.KEY_=VECTOR(AMRKEY);
     1724     2342    1   RETRY:;
     1725     2343    1      AMRKEY.L=F$DCB.DCBNAME.L;
     1726     2344    1      AMRKEY.N=F$DCB.DCBNAME.N;
     1727     2345    1      IF I~=0 THEN AMRKEY='002043060'O|BINBIT(I,27);
     1728     2346    1      RSTARA.BUF_.BUF$=BUF$;
     1729     2347    1      RSTARA.V.DCB#=1; /* DCBNUM IS ONE FOR M$STAR */
     1730     2348
     1731     2349    1      CALL M$MREAD(RSTARA)ALTRET(NOTREAD);
     1732     2350    1      IF I~=0 THEN F$DCB.FEXTX=I;
     1733     2351    2      IF ENT#<0 THEN DO;
     1734     2352    2         CALL FMP$CLSTAR;
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:290  
     1735     2353    2         B$JIT.DCB$=JDCB$;
     1736     2354    2         END;
     1737     2355    1      RETURN;
     1738     2356
     1739     2357                    /*
     1740     2358                    *  IF ANY ERROR OCCURRED ON THE READ, THEN THE ERROR CODE IS
     1741     2359                    *  IN JIT.ERR.CODE.  THE CALLER MUST CHECK THIS AT THE
     1742     2360                    *  ALTRET ENTRY.
     1743     2361                    */
     1744     2362    1   NOTREAD:
     1745     2363    2      IF I=0 THEN DO;
     1746     2364    2         IF F$DCB.DCBNAME.X=3 THEN F$DCB.FEXTX=3;
     1747     2365    2         GOTO RETALT;
     1748     2366    2         END;
     1749     2367    1      IF ADDR(F$DCB.DCBNAME)->DCBNAME.M$='04115044'O /* M$.. */
     1750     2368    2      THEN DO I=4 TO F_NUMOPS;
     1751     2369    2         IF F_OPLBL(I)=SUBSTR(F$DCB.DCBNAME.N,2,2) THEN F$DCB.FEXTX=I;
     1752     2370    2         END;
     1753     2371    1      I=0;
     1754     2372    1      GOTO RETRY;
     1755     2373    1   RETALT:;
     1756     2374    2      IF ENT#<0 THEN DO;
     1757     2375    2         CALL FMP$CLSTAR;
     1758     2376    2         B$JIT.DCB$=JDCB$;
     1759     2377    2         CALL FMD$RELBUF(0);
     1760     2378    2         END;
     1761     2379    1      ALTRETURN;
     1762     2380    1   END FMM$GETAMR;
     1763     2381        %EOD;

PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:291  
--  Include file information  --

   FM_OPLBL_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   F_CP6.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure FMM$GETAMR.

   Procedure FMM$GETAMR requires 198 words for executable code.
   Procedure FMM$GETAMR requires 26 words of local(AUTO) storage.

PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:292  

 Object Unit name= FMM$GETAMR                                 File name= FMM$OPN.:E05TOU
 UTS= JUL 29 '97 16:53:24.76 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     17     21  FMM$GETAMR
    1   Proc  even  none   198    306  FMM$GETAMR
    2  RoData even  none     7      7  FMM$GETAMR

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  FMM$GETAMR
     1     22          yes     yes      Std        0  FMM$OPNAMR
     1     73          yes     yes      Std        2  FMM$READAMR

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 FMD$GETBUF
         yes           Std       0 FMM$DFLOPNP
         yes           Std       1 FMD$RELBUF
         yes           Std       0 FMP$CLSTAR
 yes     yes           Std       1 M$MREAD
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:293  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    F_OPLBL                               B$JIT$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:294  


     1587        1        /*T***********************************************************/
     1588        2        /*T*                                                         */
     1589        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1590        4        /*T*                                                         */
     1591        5        /*T***********************************************************/
     1592        6                    /*F*  NAME:     FMM$GETAMR
     1593        7                    *     PURPOSE:  GET THE ASSIGN MERGE RECORD FOR THIS DCB.
     1594        8                    */
     1595        9                    /*D*
     1596       10                     NAME:     FMM$GETAMR
     1597       11                     CALL:     CALL FMM$GETAMR(DCB$,BUF$) ALTRET(RTN)
     1598       12
     1599       13                     WHERE DCB$ POINTS TO THE CURRENT DCB
     1600       14                     BUF$ IS RETURNED POINTING TO THE RECORD.
     1601       15                     ALTRET SPECIFIES EITHER AN ERROR CONDITION
     1602       16                     SPECIFIED IN B$JIT.ERR.CODE OR (IF CODE
     1603       17                     INDICATES 'KEY NOT FOUND') THAT NO AMR
     1604       18                     EXISTS FOR THIS DCB.
     1605       19
     1606       20                     OUTPUT:   THE AMR IF FOUND IS CONTAINED IN F$DCB.BUFR1.BUFX(0).
     1607       21
     1608       22                     DESCRIPTION:  FMM$GETAMR GETS A FILE MANAGEMENT BUFFER, THEN
     1609       23                     USES THE M$STAR DCB TO READ THE AMR FOR THE SPECIFIED
     1610       24                     DCB (KEY IS THE DCB NAME) INTO THE BUFFER.  IF M$STAR
     1611       25                     IS ALREADY OPEN OR CANNOT BE OPENED, THE ALTRET IS
     1612       26                     TAKEN. IF THERE IS NO AMR FOR THIS DCB, THE ALTRET IS
     1613       27                     ALSO TAKEN.  IF M$STAR WAS OPENED SUCCESSFULLY, IT IS
     1614       28                     CLOSED BEFORE THE RETURN.  ON THE ALTRETURN THE FILE
     1615       29                     MANAGEMENT BUFFER WILL HAVE BEEN RETURNED.
     1616       30
     1617       31                    */
     1618       32        FMM$GETAMR: PROC(JDCB$,BUF$) ALTRET;

     32  1 000000   000000 700200 xent  FMM$GETAMR   TSX0  ! X66_AUTO_2
         1 000001   000032 000002                    ZERO    26,2

PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:295  
     1619       33                    /*F*  NAME:     FMM$READAMR
     1620       34                    *     PURPOSE:  READ THE ASSIGN MERGE RECORD FOR THIS DCB.
     1621       35                    */
     1622       36                    /*D*
     1623       37                    *     NAME:     FMM$READAMR
     1624       38                    *     CALL:     CALL FMM$READAMR(DCB$,BUF$) ALTRET(RTN)
     1625       39                    *
     1626       40                    *     INPUT:          DCB$ POINTS TO THE CURRENT DCB.
     1627       41                    *                     BUF$ POINTS TO AN FM BUFFER.
     1628       42                    *
     1629       43                    *                     ALTRET SPECIFIES EITHER AN ERROR CONDITION
     1630       44                    *                     SPECIFIED IN B$JIT.ERR.CODE OR (IF CODE
     1631       45                    *                     INDICATES 'KEY NOT FOUND') THAT NO AMR
     1632       46                    *                     EXISTS FOR THIS DCB.
     1633       47                    *
     1634       48                    *     OUTPUT:   THE AMR IF FOUND IS READ INTO THE BUF$ AREA.
     1635       49                    *
     1636       50                    *     DESCRIPTION:  FMM$READAMR USES THE M$STAR DCB TO READ THE AMR FOR
     1637       51                    *               THE SPECIFIED DCB (KEY IS THE DCB NAME).  IF THIS DCB
     1638       52                    *               IS DEFINED AS #1, #2, OR #3 THAT AMR IS OBTAINED
     1639       53                    *               INSTEAD OF THE AMR KEYED BY THE DCB NAME.
     1640       54                    *               IF THERE IS NO AMR FOR THIS DCB, THE ALTRET IS TAKEN.
     1641       55                    *               IF THE M$* DCB HAS NOT BEEN OPENED, THE ALTRET
     1642       56                    *               IS ALSO TAKEN.
     1643       57                    *
     1644       58                    */
     1645       59        %INCLUDE CP_6_SUBS;
     1646      599                    /**/
     1647      600                    /* ENTRYIS */
     1648      601                    /**/
     1649      602    1   DCL FMD$GETBUF ENTRY(3);
     1650      603    1   DCL FMD$RELBUF ENTRY(1);
     1651      604    1   DCL FMM$DFLOPNP ENTRY;
     1652      605    1   DCL FMP$CLSTAR ENTRY;
     1653      606        %MACRO F$DCB#(BASED=BASED);
     1654      607        %INCLUDE F$DCB;
     1655      656        %MEND;
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:296  
     1656      657        %F$DCB#(BASED="BASED(JDCB$)");
     1657      707        %INCLUDE F_CP6;
     1658     1732        %INCLUDE F$JIT_C;
     1659     2162        %INCLUDE FM_OPLBL_R;
     1660     2176    1   DCL M$MREAD ENTRY(1)ALTRET; /* INTRA MONITOR M$READ */
     1661     2177                    /**/
     1662     2178                    /* PARAMETER DATA */
     1663     2179                    /**/
     1664     2180    1   DCL JDCB$ PTR; /* INPUT DCB--GET IT'S AMR */
     1665     2181    1   DCL BUF$ PTR; /* PTR TO FM BUFFER */
     1666     2182                    /**/
     1667     2183                    /* AUTOMATIC DATA */
     1668     2184                    /**/
     1669     2185    1   DCL I UBIN;
     1670     2186    1   DCL ENT# SBIN; /* -1=GET,0=READ,1=OPN */
     1671     2187        %FPT_READ (FPTN=RSTARA,STCLASS=AUTO);
     1672     2226                    /**/
     1673     2227                    /* SYMREF DATA */
     1674     2228                    /**/
     1675     2229    1   DCL B$JIT$ PTR SYMREF; /* POINTER TO THE JIT */
     1676     2230    1   DCL 1 AMRKEY BASED(BUF$) ALIGNED,
     1677     2231    1         2 L UBIN BYTE UNAL,
     1678     2232    1         2 N CHAR(31);
     1679     2233    1   DCL 1 DCBNAME ALIGNED BASED,
     1680     2234    1         2 * BIT(3),
     1681     2235    1         2 M$ BIT(24);
     1682     2236                    /**/
     1683     2237                    /* CONSTANT DATA */
     1684     2238                    /**/
     1685     2239        %FPT_READ(FPTN=RSTARC,STCLASS=CONSTANT,KEYS=YES);
     1686     2278        %VLP_NAME(FPTN=STARA,NAME='*A',STCLASS=CONSTANT);
     1687     2305                    /**/
     1688     2306                    /* PROCEDURE */
     1689     2307                    /**/
     1690     2308    1      ENT#=-1;

   2308  1 000002   000001 335007                    LCA     1,DL
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:297  
         1 000003   200006 755100                    STA     ENT#,,AUTO

     1691     2309    1      CALL FMD$GETBUF(0,1,BUF$);

   2309  1 000004   200004 236100                    LDQ     @BUF$,,AUTO
         1 000005   200030 756100                    STQ     RSTARA+16,,AUTO
         1 000006   000000 237000 2                  LDAQ    0
         1 000007   200026 757100                    STAQ    RSTARA+14,,AUTO
         1 000010   200026 630500                    EPPR0   RSTARA+14,,AUTO
         1 000011   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000012   000000 701000 xent               TSX1    FMD$GETBUF
         1 000013   000000 011000                    NOP     0

     1692     2310    1      B$JIT.DCB$=DCBADDR(1);

   2310  1 000014   000002 470400 2                  LDP0    2
         1 000015   000000 471500                    LDP1    0,,PR0
         1 000016   100001 236100                    LDQ     1,,PR1
         1 000017   000000 473400 xsym               LDP3    B$JIT$
         1 000020   300232 756100                    STQ     154,,PR3

     1693     2311    1      GOTO OPNAMR;

   2311  1 000021   000026 710000 1                  TRA     OPNAMR

     1694     2312    1   FMM$OPNAMR: ENTRY ALTRET;

   2312  1 000022   000000 700200 xent  FMM$OPNAMR   TSX0  ! X66_AUTO_2
         1 000023   000032 000002                    ZERO    26,2

     1695     2313    1      ENT#=1;

   2313  1 000024   000001 235007                    LDA     1,DL
         1 000025   200006 755100                    STA     ENT#,,AUTO

   2313  1 000026                       OPNAMR       null
     1696     2314    1   OPNAMR:;
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:298  
     1697     2315    1      IF B$JIT.DCB$->F$DCB.FCD THEN CALL FMP$CLSTAR;

   2315  1 000026   000000 470400 xsym               LDP0    B$JIT$
         1 000027   000232 471500                    LDP1    154,,PR0
         1 000030   100031 236100                    LDQ     25,,PR1
         1 000031   020000 316007                    CANQ    8192,DL
         1 000032   000036 600000 1                  TZE     s:2316

   2315  1 000033   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000034   000000 701000 xent               TSX1    FMP$CLSTAR
         1 000035   000000 011000                    NOP     0

     1698     2316    1      B$JIT.ERR='0'B;

   2316  1 000036   000000 470400 xsym               LDP0    B$JIT$
         1 000037   000012 450100                    STZ     10,,PR0

     1699     2317    1      B$JIT.DCB$->F$DCB.NAME=STARA;

   2317  1 000040   000232 471500                    LDP1    154,,PR0
         1 000041   000100 100400                    MLR     fill='000'O
         1 000042   000016 000003 0                  ADSC9   STARA                    cn=0,n=3
         1 000043   100010 000040                    ADSC9   8,,PR1                   cn=0,n=32

     1700     2318    1      B$JIT.DCB$->F$DCB.ASN=%FILE#;

   2318  1 000044   000232 471500                    LDP1    154,,PR0
         1 000045   001000 236007                    LDQ     512,DL
         1 000046   100032 552110                    STBQ    26,'10'O,PR1

     1701     2319    1      B$JIT.DCB$->F$DCB.FUN=%IN#;

   2319  1 000047   000232 471500                    LDP1    154,,PR0
         1 000050   000002 236003                    LDQ     2,DU
         1 000051   100032 552120                    STBQ    26,'20'O,PR1

     1702     2320    1      B$JIT.DCB$->F$DCB.SHARE=%NONE#;
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:299  

   2320  1 000052   000232 471500                    LDP1    154,,PR0
         1 000053   000600 236007                    LDQ     384,DL
         1 000054   100031 256100                    ORSQ    25,,PR1

     1703     2321    1      B$JIT.DCB$->F$DCB.AMFLG='0'B;

   2321  1 000055   000232 471500                    LDP1    154,,PR0
         1 000056   000003 236000 2                  LDQ     3
         1 000057   100064 356100                    ANSQ    52,,PR1

     1704     2322    1      CALL FMM$DFLOPNP;

   2322  1 000060   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000061   000000 701000 xent               TSX1    FMM$DFLOPNP
         1 000062   000000 011000                    NOP     0

     1705     2323    1      IF B$JIT.ERR.CODE~=0 THEN GOTO RETALT;

   2323  1 000063   000000 470400 xsym               LDP0    B$JIT$
         1 000064   000012 236100                    LDQ     10,,PR0
         1 000065   377770 316007                    CANQ    131064,DL
         1 000066   000270 601000 1                  TNZ     RETALT

     1706     2324    1      IF ENT#>0 THEN RETURN; /* OPNAMR CALL */

   2324  1 000067   200006 235100                    LDA     ENT#,,AUTO
         1 000070   000072 604400 1                  TMOZ    s:2325

   2324  1 000071   000000 702200 xent               TSX2  ! X66_ARET

     1707     2325    1      GOTO READAMR;

   2325  1 000072   000104 710000 1                  TRA     READAMR

     1708     2326    1   FMM$READAMR: ENTRY(JDCB$,BUF$) ALTRET;

PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:300  
   2326  1 000073   000000 700200 xent  FMM$READAMR  TSX0  ! X66_AUTO_2
         1 000074   000032 000002                    ZERO    26,2

     1709     2327    1      ENT#=0;

   2327  1 000075   200006 450100                    STZ     ENT#,,AUTO

     1710     2328    1      IF NOT B$JIT.DCB$->F$DCB.FCD THEN ALTRETURN;

   2328  1 000076   000000 470400 xsym               LDP0    B$JIT$
         1 000077   000232 471500                    LDP1    154,,PR0
         1 000100   100031 236100                    LDQ     25,,PR1
         1 000101   020000 316007                    CANQ    8192,DL
         1 000102   000104 601000 1                  TNZ     READAMR

   2328  1 000103   000000 702200 xent               TSX2  ! X66_AALT

   2328  1 000104                       READAMR      null
     1711     2329                    /* DON'T READ IF M$* ISN'T OPEN */
     1712     2330                    /*
     1713     2331                    *  SET UP THE READ FPT
     1714     2332                    */
     1715     2333    1   READAMR:;
     1716     2334    1      RSTARA=RSTARC;

   2334  1 000104   000100 100400                    MLR     fill='000'O
         1 000105   000000 000070 0                  ADSC9   RSTARC                   cn=0,n=56
         1 000106   200010 000070                    ADSC9   RSTARA,,AUTO             cn=0,n=56

     1717     2335    1      RSTARA.V_=VECTOR(RSTARA.V);

   2335  1 000107   000004 235000 2                  LDA     4
         1 000110   200026 452500                    STP2    RSTARA+14,,AUTO
         1 000111   200026 236100                    LDQ     RSTARA+14,,AUTO
         1 000112   000020 036003                    ADLQ    16,DU
         1 000113   200010 757100                    STAQ    RSTARA,,AUTO

PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:301  
     1718     2336    1      RSTARA.BUF_.BOUND=4095;

   2336  1 000114   200014 236100                    LDQ     RSTARA+4,,AUTO
         1 000115   177777 376007                    ANQ     65535,DL
         1 000116   000005 276000 2                  ORQ     5
         1 000117   200014 756100                    STQ     RSTARA+4,,AUTO

     1719     2337                    /*
     1720     2338                    *  TRY FOR A PROCESSOR CALL LINE RECORD IF DCBNAME.X ISNT 0
     1721     2339                    */
     1722     2340    1      I=F$DCB.DCBNAME.X;

   2340  1 000120   200003 471500                    LDP1    @JDCB$,,AUTO
         1 000121   100000 473500                    LDP3    0,,PR1
         1 000122   300140 236100                    LDQ     96,,PR3
         1 000123   000041 772000                    QRL     33
         1 000124   200005 756100                    STQ     I,,AUTO

     1723     2341    1      RSTARA.KEY_=VECTOR(AMRKEY);

   2341  1 000125   200004 474500                    LDP4    @BUF$,,AUTO
         1 000126   400000 475500                    LDP5    0,,PR4
         1 000127   000006 235000 2                  LDA     6
         1 000130   200026 455500                    STP5    RSTARA+14,,AUTO
         1 000131   200026 236100                    LDQ     RSTARA+14,,AUTO
         1 000132   200012 757100                    STAQ    RSTARA+2,,AUTO

   2341  1 000133                       RETRY        null
     1724     2342    1   RETRY:;
     1725     2343    1      AMRKEY.L=F$DCB.DCBNAME.L;

   2343  1 000133   200004 470500                    LDP0    @BUF$,,AUTO
         1 000134   000000 471500                    LDP1    0,,PR0
         1 000135   200003 473500                    LDP3    @JDCB$,,AUTO
         1 000136   300000 474500                    LDP4    0,,PR3
         1 000137   400140 236100                    LDQ     96,,PR4
         1 000140   037000 376003                    ANQ     15872,DU
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:302  
         1 000141   100000 552140                    STBQ    0,'40'O,PR1

     1726     2344    1      AMRKEY.N=F$DCB.DCBNAME.N;

   2344  1 000142   000000 471500                    LDP1    0,,PR0
         1 000143   300000 474500                    LDP4    0,,PR3
         1 000144   400140 236100                    LDQ     96,,PR4
         1 000145   000033 772000                    QRL     27
         1 000146   000037 376007                    ANQ     31,DL
         1 000147   000000 620006                    EAX0    0,QL
         1 000150   040100 100540                    MLR     fill='040'O
         1 000151   400140 200010                    ADSC9   96,,PR4                  cn=1,n=*X0
         1 000152   100000 200037                    ADSC9   0,,PR1                   cn=1,n=31

     1727     2345    1      IF I~=0 THEN AMRKEY='002043060'O|BINBIT(I,27);

   2345  1 000153   200005 235100                    LDA     I,,AUTO
         1 000154   000165 600000 1                  TZE     s:2346

   2345  1 000155   000000 471500                    LDP1    0,,PR0
         1 000156   200005 236100                    LDQ     I,,AUTO
         1 000157   000011 736000                    QLS     9
         1 000160   000017 276000 0                  ORQ     STARA+1
         1 000161   200026 756100                    STQ     RSTARA+14,,AUTO
         1 000162   000100 100500                    MLR     fill='000'O
         1 000163   200026 000004                    ADSC9   RSTARA+14,,AUTO          cn=0,n=4
         1 000164   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32

     1728     2346    1      RSTARA.BUF_.BUF$=BUF$;

   2346  1 000165   000000 236100                    LDQ     0,,PR0
         1 000166   200015 756100                    STQ     RSTARA+5,,AUTO

     1729     2347    1      RSTARA.V.DCB#=1; /* DCBNUM IS ONE FOR M$STAR */

   2347  1 000167   000001 220003                    LDX0    1,DU
         1 000170   200020 740100                    STX0    RSTARA+8,,AUTO
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:303  

     1730     2348
     1731     2349    1      CALL M$MREAD(RSTARA)ALTRET(NOTREAD);

   2349  1 000171   200010 631500                    EPPR1   RSTARA,,AUTO
         1 000172   200026 451500                    STP1    RSTARA+14,,AUTO
         1 000173   200026 630500                    EPPR0   RSTARA+14,,AUTO
         1 000174   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000175   000000 701000 xent               TSX1    M$MREAD
         1 000176   000220 702000 1                  TSX2    NOTREAD

     1732     2350    1      IF I~=0 THEN F$DCB.FEXTX=I;

   2350  1 000177   200005 235100                    LDA     I,,AUTO
         1 000200   000206 600000 1                  TZE     s:2351

   2350  1 000201   200003 470500                    LDP0    @JDCB$,,AUTO
         1 000202   000000 471500                    LDP1    0,,PR0
         1 000203   200005 236100                    LDQ     I,,AUTO
         1 000204   000011 736000                    QLS     9
         1 000205   100034 552110                    STBQ    28,'10'O,PR1

     1733     2351    2      IF ENT#<0 THEN DO;

   2351  1 000206   200006 236100                    LDQ     ENT#,,AUTO
         1 000207   000217 605000 1                  TPL     s:2355

     1734     2352    2         CALL FMP$CLSTAR;

   2352  1 000210   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000211   000000 701000 xent               TSX1    FMP$CLSTAR
         1 000212   000000 011000                    NOP     0

     1735     2353    2         B$JIT.DCB$=JDCB$;

   2353  1 000213   200003 470500                    LDP0    @JDCB$,,AUTO
         1 000214   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:304  
         1 000215   000000 471400 xsym               LDP1    B$JIT$
         1 000216   100232 756100                    STQ     154,,PR1

     1736     2354    2         END;

     1737     2355    1      RETURN;

   2355  1 000217   000000 702200 xent               TSX2  ! X66_ARET

     1738     2356
     1739     2357                    /*
     1740     2358                    *  IF ANY ERROR OCCURRED ON THE READ, THEN THE ERROR CODE IS
     1741     2359                    *  IN JIT.ERR.CODE.  THE CALLER MUST CHECK THIS AT THE
     1742     2360                    *  ALTRET ENTRY.
     1743     2361                    */
     1744     2362    1   NOTREAD:
     1745     2363    2      IF I=0 THEN DO;

   2363  1 000220   200005 235100       NOTREAD      LDA     I,,AUTO
         1 000221   000233 601000 1                  TNZ     s:2367

     1746     2364    2         IF F$DCB.DCBNAME.X=3 THEN F$DCB.FEXTX=3;

   2364  1 000222   200003 470500                    LDP0    @JDCB$,,AUTO
         1 000223   000000 471500                    LDP1    0,,PR0
         1 000224   100140 236100                    LDQ     96,,PR1
         1 000225   700000 376003                    ANQ     -32768,DU
         1 000226   300000 116003                    CMPQ    98304,DU
         1 000227   000232 601000 1                  TNZ     s:2365

   2364  1 000230   003000 236007                    LDQ     1536,DL
         1 000231   100034 552110                    STBQ    28,'10'O,PR1

     1747     2365    2         GOTO RETALT;

   2365  1 000232   000270 710000 1                  TRA     RETALT

PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:305  
     1748     2366    2         END;
     1749     2367    1      IF ADDR(F$DCB.DCBNAME)->DCBNAME.M$='04115044'O /* M$.. */

   2367  1 000233   200003 470500                    LDP0    @JDCB$,,AUTO
         1 000234   000000 471500                    LDP1    0,,PR0
         1 000235   000000 066500                    CMPB    filb='0'B
         1 000236   100140 030030                    BDSC    96,,PR1                  by=0,bit=3,n=24
         1 000237   000020 000030 0                  BDSC    STARA+2                  by=0,bit=0,n=24
         1 000240   000266 601000 1                  TNZ     s:2371

     1750     2368    2      THEN DO I=4 TO F_NUMOPS;

   2368  1 000241   000004 236007                    LDQ     4,DL
         1 000242   200005 756100                    STQ     I,,AUTO

     1751     2369    2         IF F_OPLBL(I)=SUBSTR(F$DCB.DCBNAME.N,2,2) THEN F$DCB.FEXTX=I;

   2369  1 000243   200003 470500                    LDP0    @JDCB$,,AUTO
         1 000244   000000 471500                    LDP1    0,,PR0
         1 000245   100140 236100                    LDQ     96,,PR1
         1 000246   000033 772000                    QRL     27
         1 000247   000037 376007                    ANQ     31,DL
         1 000250   200005 235100                    LDA     I,,AUTO
         1 000251   000001 735000                    ALS     1
         1 000252   040100 106405                    CMPC    fill='040'O
         1 000253   000000 000002 xsym               ADSC9   F_OPLBL,A                cn=0,n=2
         1 000254   100140 600002                    ADSC9   96,,PR1                  cn=3,n=2
         1 000255   000261 601000 1                  TNZ     s:2370

   2369  1 000256   200005 236100                    LDQ     I,,AUTO
         1 000257   000011 736000                    QLS     9
         1 000260   100034 552110                    STBQ    28,'10'O,PR1

     1752     2370    2         END;

   2370  1 000261   200005 236100                    LDQ     I,,AUTO
         1 000262   000001 036007                    ADLQ    1,DL
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:306  
         1 000263   200005 756100                    STQ     I,,AUTO
         1 000264   000021 116007                    CMPQ    17,DL
         1 000265   000243 602000 1                  TNC     s:2369

     1753     2371    1      I=0;

   2371  1 000266   200005 450100                    STZ     I,,AUTO

     1754     2372    1      GOTO RETRY;

   2372  1 000267   000133 710000 1                  TRA     RETRY

   2371  1 000270                       RETALT       null
     1755     2373    1   RETALT:;
     1756     2374    2      IF ENT#<0 THEN DO;

   2374  1 000270   200006 235100                    LDA     ENT#,,AUTO
         1 000271   000305 605000 1                  TPL     s:2379

     1757     2375    2         CALL FMP$CLSTAR;

   2375  1 000272   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000273   000000 701000 xent               TSX1    FMP$CLSTAR
         1 000274   000000 011000                    NOP     0

     1758     2376    2         B$JIT.DCB$=JDCB$;

   2376  1 000275   200003 470500                    LDP0    @JDCB$,,AUTO
         1 000276   000000 236100                    LDQ     0,,PR0
         1 000277   000000 471400 xsym               LDP1    B$JIT$
         1 000300   100232 756100                    STQ     154,,PR1

     1759     2377    2         CALL FMD$RELBUF(0);

   2377  1 000301   000000 630400 2                  EPPR0   0
         1 000302   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000303   000000 701000 xent               TSX1    FMD$RELBUF
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:307  
         1 000304   000000 011000                    NOP     0

     1760     2378    2         END;

     1761     2379    1      ALTRETURN;

   2379  1 000305   000000 702200 xent               TSX2  ! X66_AALT

RSTARC
 Sect OctLoc
   0     000   000005 777640   000010 006000   000000 177640   000000 006014    ................
   0     004   000000 177640   000000 006014   000000 177640   000000 006014    ................
   0     010   000000 600000   000000 000000   000000 000000   000000 000000    ................
   0     014   000000 000000   000000 000000                                    ........

STARA
 Sect OctLoc
   0     016   002052 101***                                                    .*A.

(unnamed)
 Sect OctLoc
   0     017   002043 060000   041150 440000                                    .#0.!h..

(unnamed)
 Sect OctLoc
   2     000   000002 006000   000003 006000   000000 006003   777007 777777    ................
   2     004   000005 777640   001777 600000   000007 777640                    ............
     1762     2380    1   END FMM$GETAMR;
     1763     2381        %EOD;

PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:308  
--  Include file information  --

   FM_OPLBL_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   F_CP6.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure FMM$GETAMR.
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:309  

 **** Variables and constants ****

  ****  Section 000 RoData FMM$GETAMR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(504)   r     1 RSTARC                    16-0-0/c STRC(27)    r     1 STARA

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @BUF$                      3-0-0/w PTR         r     1 @JDCB$
    *0-0-0/w PTR         r     1 BUF$                       6-0-0/w SBIN        r     1 ENT#
     5-0-0/w UBIN        r     1 I                         *0-0-0/w PTR         r     1 JDCB$
    10-0-0/d STRC(504)   r     1 RSTARA

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/c CHAR(2)     r     1 F_OPLBL(0:8191)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)   r     1 AMRKEY                     0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(27)    r     1 DCBNAME                    0-0-0/d ASTR(3528)  r     1 F$DCB


   Procedure FMM$GETAMR requires 198 words for executable code.
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:310  
   Procedure FMM$GETAMR requires 26 words of local(AUTO) storage.
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:311  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:312  
          MINI XREF LISTING

AMRKEY
      2230**DCL      2341--ASSIGN   2345<<ASSIGN
AMRKEY.L
      2231**DCL      2343<<ASSIGN
AMRKEY.N
      2232**DCL      2344<<ASSIGN
B$JIT.DCB$
      2149**DCL      2310<<ASSIGN   2315>>IF       2317>>ASSIGN   2318>>ASSIGN   2319>>ASSIGN   2320>>ASSIGN
      2321>>ASSIGN   2328>>IF       2353<<ASSIGN   2376<<ASSIGN
B$JIT.ERR
      2059**DCL      2316<<ASSIGN
B$JIT.ERR.CODE
      2060**DCL      2323>>IF
B$JIT.ERR.MID
      2060**DCL      2060--REDEF
B$JIT$
      2229**DCL      2054--IMP-PTR  2310>>ASSIGN   2315>>IF       2316>>ASSIGN   2317>>ASSIGN   2318>>ASSIGN
      2319>>ASSIGN   2320>>ASSIGN   2321>>ASSIGN   2323>>IF       2328>>IF       2353>>ASSIGN   2376>>ASSIGN
BUF$
      2181**DCL        32--PROC     2230--IMP-PTR  2309<>CALL     2326--ENTRY    2341>>ASSIGN   2343>>ASSIGN
      2344>>ASSIGN   2345>>ASSIGN   2346>>ASSIGN
DCBNAME.M$
      2235**DCL      2367>>IF
ENT#
      2186**DCL      2308<<ASSIGN   2313<<ASSIGN   2324>>IF       2327<<ASSIGN   2351>>IF       2374>>IF
F$DCB.ACTPOS
       683**DCL       683--REDEF
F$DCB.AMFLG
       687**DCL      2321<<ASSIGN
F$DCB.ARS
       658**DCL       658--REDEF
F$DCB.ASN
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:313  
       673**DCL      2318<<ASSIGN
F$DCB.ATTR
       676**DCL       677--REDEF
F$DCB.BORROW
       691**DCL       691--REDEF     691--REDEF     691--REDEF
F$DCB.DCBNAME
       704**DCL      2367--IF
F$DCB.DCBNAME.L
       705**DCL       705--IMP-SIZ  2343>>ASSIGN   2344>>ASSIGN   2369>>IF
F$DCB.DCBNAME.N
       705**DCL      2344>>ASSIGN   2369>>IF
F$DCB.DCBNAME.X
       704**DCL      2340>>ASSIGN   2364>>IF
F$DCB.EOMCHAR
       662**DCL       662--REDEF
F$DCB.FCD
       671**DCL      2315>>IF       2328>>IF
F$DCB.FEXTX
       674**DCL      2350<<ASSIGN   2364<<ASSIGN   2369<<ASSIGN
F$DCB.FLDID
       686**DCL       686--REDEF
F$DCB.FORM$
       680**DCL       680--REDEF
F$DCB.FSECT
       696**DCL       696--REDEF
F$DCB.FSN
       673**DCL       673--REDEF     673--REDEF     674--REDEF
F$DCB.FUN
       672**DCL      2319<<ASSIGN
F$DCB.HEADER$
       679**DCL       679--REDEF
F$DCB.IXTNSIZE
       677**DCL       677--REDEF
F$DCB.LASTSTA$
       667**DCL       667--REDEF
F$DCB.LVL
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:314  
       692**DCL       692--REDEF
F$DCB.NAME
       667**DCL      2317<<ASSIGN
F$DCB.NAME.C
       667**DCL       667--REDEF
F$DCB.NOEOF
       688**DCL       688--REDEF
F$DCB.NRECS
       678**DCL       678--REDEF
F$DCB.NRECX
       697**DCL       697--REDEF
F$DCB.OHDR
       689**DCL       689--REDEF
F$DCB.ORG
       672**DCL       672--REDEF
F$DCB.PRECNO
       695**DCL       695--REDEF
F$DCB.RCSZ
       700**DCL       700--REDEF
F$DCB.RES
       668**DCL       668--REDEF
F$DCB.SETX
       680**DCL       680--REDEF
F$DCB.SHARE
       671**DCL      2320<<ASSIGN
F$DCB.TAB$
       679**DCL       680--REDEF
F$DCB.TDA
       694**DCL       694--REDEF
F$DCB.WSN
       669**DCL       669--REDEF
FMD$GETBUF
       602**DCL-ENT  2309--CALL
FMD$RELBUF
       603**DCL-ENT  2377--CALL
FMM$DFLOPNP
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:315  
       604**DCL-ENT  2322--CALL
FMP$CLSTAR
       605**DCL-ENT  2315--CALL     2352--CALL     2375--CALL
F_OPLBL
      2171**DCL      2369>>IF
I
      2185**DCL      2340<<ASSIGN   2345>>IF       2345>>ASSIGN   2350>>IF       2350>>ASSIGN   2363>>IF
      2368<<DOINDEX  2369>>IF       2369>>ASSIGN   2371<<ASSIGN
JDCB$
      2180**DCL        32--PROC      658--IMP-PTR  2326--ENTRY    2340>>ASSIGN   2343>>ASSIGN   2344>>ASSIGN
      2344>>ASSIGN   2350>>ASSIGN   2353>>ASSIGN   2364>>IF       2364>>ASSIGN   2367>>IF       2369>>IF
      2369>>IF       2369>>ASSIGN   2376>>ASSIGN
M$MREAD
      2176**DCL-ENT  2349--CALL
NOTREAD
      2363**LABEL    2349--CALLALT
OPNAMR
      2313**LABEL    2311--GOTO
READAMR
      2328**LABEL    2325--GOTO
RETALT
      2371**LABEL    2323--GOTO     2365--GOTO
RETRY
      2341**LABEL    2372--GOTO
RSTARA
      2204**DCL      2334<<ASSIGN   2349<>CALL
RSTARA.BUF_.BOUND
      2206**DCL      2336<<ASSIGN
RSTARA.BUF_.BUF$
      2207**DCL      2346<<ASSIGN
RSTARA.KEY_
      2204**DCL      2341<<ASSIGN
RSTARA.STATION_
      2207**DCL      2208--REDEF
RSTARA.V
      2208**DCL      2335--ASSIGN
PL6.E3A0      #003=FMM$GETAMR File=FMM$OPN.:E05TSI                               TUE 07/29/97 16:53 Page:316  
RSTARA.V.DCB#
      2208**DCL      2347<<ASSIGN
RSTARA.V.DVBYTE.REREAD#
      2219**DCL      2219--REDEF
RSTARA.V.INDX#
      2217**DCL      2217--REDEF
RSTARA.V_
      2204**DCL      2335<<ASSIGN
RSTARC
      2256**DCL      2334>>ASSIGN
RSTARC.STATION_
      2259**DCL      2260--REDEF
RSTARC.V
      2260**DCL      2256--DCLINIT
RSTARC.V.DVBYTE.REREAD#
      2271**DCL      2271--REDEF
RSTARC.V.INDX#
      2269**DCL      2269--REDEF
STARA
      2303**DCL      2317>>ASSIGN

PL6.E3A0      #004=FMM$SCRAMBLE File=FMM$OPN.:E05TSI                             TUE 07/29/97 16:53 Page:317  
     1764        1        /*T***********************************************************/
     1765        2        /*T*                                                         */
     1766        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1767        4        /*T*                                                         */
     1768        5        /*T***********************************************************/
     1769        6                    /*F*  NAME:   FMM$SCRAMBLE
     1770        7                    *     PURPOSE:  SCRAMBLE THE PASSWORD INTO A NON REVERSABLE
     1771        8                    *               BIT PATTERN.
     1772        9                    */
     1773       10        FMM$SCRAMBLE: PROC(PASS);
     1774       11                    /**/
     1775       12                    /* PARAMETER DATA */
     1776       13                    /**/
     1777       14    1   DCL 1 PASS ALIGNED,
     1778       15    1         2 WD(0:5),
     1779       16    1           3 A UBIN(6)UNAL,
     1780       17    1           3 B UBIN(6)UNAL;
     1781       18    1   DCL 1 RSLT REDEF PASS ALIGNED,
     1782       19    1         2 AB BIT(36),
     1783       20    1         2 BB BIT(36);
     1784       21                    /**/
     1785       22                    /* EXT DATA */
     1786       23                    /**/
     1787       24        %INCLUDE F$DCB;
     1788       73        %INCLUDE F$JIT_C;
     1789      503    1   DCL B$JIT$ PTR SYMREF;
     1790      504    1   DCL 1 P2,
     1791      505    1         2 X,
     1792      506    1           3 A SBIN,
     1793      507    1           3 AB REDEF A BIT(36),
     1794      508    1           3 B SBIN,
     1795      509    1           3 BB REDEF B BIT(36),
     1796      510    1         2 B(0:71) REDEF X BIT(1),
     1797      511    1         2 Y,
     1798      512    1           3 A SBIN,
     1799      513    1           3 B SBIN,
     1800      514    1         2 Z,
PL6.E3A0      #004=FMM$SCRAMBLE File=FMM$OPN.:E05TSI                             TUE 07/29/97 16:53 Page:318  
     1801      515    1           3 A UBIN,
     1802      516    1           3 B UBIN,
     1803      517    1         2 I SBIN,
     1804      518    1         2 IB REDEF I BIT(36),
     1805      519    1         2 J SBIN,
     1806      520    1         2 JB REDEF J BIT(36);
     1807      521    1   DCL CNAME REDEF P2 CHAR(32);
     1808      522    1   DCL PBASED BASED BIT(72);
     1809      523    1   DCL PNAME BASED CHAR(P2.I);
     1810      524        %EJECT;
PL6.E3A0      #004=FMM$SCRAMBLE File=FMM$OPN.:E05TSI                             TUE 07/29/97 16:53 Page:319  
     1811      525    1      P2.X.A=7777;
     1812      526    1      P2.X.B=3333;
     1813      527    2      DO P2.I=0 TO 5;
     1814      528    2         P2.B(35)='1'B;
     1815      529    2         P2.B(71)='1'B;
     1816      530    2         P2.Y=P2.X;
     1817      531    2         P2.J=-3;
     1818      532    3         DO WHILE(P2.J<PASS.WD.A(P2.I));
     1819      533    3            P2.X.A=P2.X.A*P2.Y.B;
     1820      534    3            P2.X.B=P2.X.B*P2.Y.A;
     1821      535    3            P2.J=P2.J+1;
     1822      536    3            END;
     1823      537    2         P2.Y=P2.X;
     1824      538    2         P2.X=ADDR(P2.B(PASS.WD.B(P2.I)+4))->PBASED;
     1825      539    2         P2.X.BB=P2.X.BB\P2.X.AB;
     1826      540    2         END;
     1827      541    1      PASS=P2.X;
     1828      542    1      RETURN;
     1829      543    1   FMM$NSTAMP: ENTRY(PASS);
     1830      544    1      P2.I=B$JIT.DCB$->F$DCB.NAME.L+1;
     1831      545    1      CNAME=ADDR(B$JIT.DCB$->F$DCB.NAME)->PNAME;
     1832      546    1      P2.J=P2.J+P2.I*3+P2.Z.B*5+P2.Z.A*7+P2.Y.B*11+P2.Y.A*13+P2.X.B*17;
     1833      547    1      RSLT.AB=P2.X.AB\P2.JB;
     1834      548    1      RETURN;
     1835      549    1   END FMM$SCRAMBLE;
     1836      550        %EOD;

PL6.E3A0      #004=FMM$SCRAMBLE File=FMM$OPN.:E05TSI                             TUE 07/29/97 16:53 Page:320  
--  Include file information  --

   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FMM$SCRAMBLE.

   Procedure FMM$SCRAMBLE requires 108 words for executable code.
   Procedure FMM$SCRAMBLE requires 18 words of local(AUTO) storage.

PL6.E3A0      #004=FMM$SCRAMBLE File=FMM$OPN.:E05TSI                             TUE 07/29/97 16:53 Page:321  

 Object Unit name= FMM$SCRAMBLE                               File name= FMM$OPN.:E05TOU
 UTS= JUL 29 '97 16:53:44.40 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   108    154  FMM$SCRAMBLE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        1  FMM$SCRAMBLE
     0    103                  yes      Std        1  FMM$NSTAMP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$JIT$
PL6.E3A0      #004=FMM$SCRAMBLE File=FMM$OPN.:E05TSI                             TUE 07/29/97 16:53 Page:322  


     1764        1        /*T***********************************************************/
     1765        2        /*T*                                                         */
     1766        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1767        4        /*T*                                                         */
     1768        5        /*T***********************************************************/
     1769        6                    /*F*  NAME:   FMM$SCRAMBLE
     1770        7                    *     PURPOSE:  SCRAMBLE THE PASSWORD INTO A NON REVERSABLE
     1771        8                    *               BIT PATTERN.
     1772        9                    */
     1773       10        FMM$SCRAMBLE: PROC(PASS);

     10  0 000000   000000 700200 xent  FMM$SCRAMBLE TSX0  ! X66_AUTO_1
         0 000001   000022 000001                    ZERO    18,1

     1774       11                    /**/
     1775       12                    /* PARAMETER DATA */
     1776       13                    /**/
     1777       14    1   DCL 1 PASS ALIGNED,
     1778       15    1         2 WD(0:5),
     1779       16    1           3 A UBIN(6)UNAL,
     1780       17    1           3 B UBIN(6)UNAL;
     1781       18    1   DCL 1 RSLT REDEF PASS ALIGNED,
     1782       19    1         2 AB BIT(36),
     1783       20    1         2 BB BIT(36);
     1784       21                    /**/
     1785       22                    /* EXT DATA */
     1786       23                    /**/
     1787       24        %INCLUDE F$DCB;
     1788       73        %INCLUDE F$JIT_C;
     1789      503    1   DCL B$JIT$ PTR SYMREF;
     1790      504    1   DCL 1 P2,
     1791      505    1         2 X,
     1792      506    1           3 A SBIN,
     1793      507    1           3 AB REDEF A BIT(36),
     1794      508    1           3 B SBIN,
     1795      509    1           3 BB REDEF B BIT(36),
PL6.E3A0      #004=FMM$SCRAMBLE File=FMM$OPN.:E05TSI                             TUE 07/29/97 16:53 Page:323  
     1796      510    1         2 B(0:71) REDEF X BIT(1),
     1797      511    1         2 Y,
     1798      512    1           3 A SBIN,
     1799      513    1           3 B SBIN,
     1800      514    1         2 Z,
     1801      515    1           3 A UBIN,
     1802      516    1           3 B UBIN,
     1803      517    1         2 I SBIN,
     1804      518    1         2 IB REDEF I BIT(36),
     1805      519    1         2 J SBIN,
     1806      520    1         2 JB REDEF J BIT(36);
     1807      521    1   DCL CNAME REDEF P2 CHAR(32);
     1808      522    1   DCL PBASED BASED BIT(72);
     1809      523    1   DCL PNAME BASED CHAR(P2.I);
     1810      524        %EJECT;
PL6.E3A0      #004=FMM$SCRAMBLE File=FMM$OPN.:E05TSI                             TUE 07/29/97 16:53 Page:324  
     1811      525    1      P2.X.A=7777;

    525  0 000002   017141 235007                    LDA     7777,DL
         0 000003   200004 755100                    STA     P2,,AUTO

     1812      526    1      P2.X.B=3333;

    526  0 000004   006405 236007                    LDQ     3333,DL
         0 000005   200005 756100                    STQ     P2+1,,AUTO

     1813      527    2      DO P2.I=0 TO 5;

    527  0 000006   200012 450100                    STZ     P2+6,,AUTO

     1814      528    2         P2.B(35)='1'B;

    528  0 000007   000001 236007                    LDQ     1,DL
         0 000010   200004 256100                    ORSQ    P2,,AUTO

     1815      529    2         P2.B(71)='1'B;

    529  0 000011   200005 256100                    ORSQ    P2+1,,AUTO

     1816      530    2         P2.Y=P2.X;

    530  0 000012   200004 237100                    LDAQ    P2,,AUTO
         0 000013   200006 757100                    STAQ    P2+2,,AUTO

     1817      531    2         P2.J=-3;

    531  0 000014   000003 335007                    LCA     3,DL
         0 000015   200013 755100                    STA     P2+7,,AUTO

     1818      532    3         DO WHILE(P2.J<PASS.WD.A(P2.I));

    532  0 000016   200012 235100                    LDA     P2+6,,AUTO
         0 000017   000001 735000                    ALS     1
PL6.E3A0      #004=FMM$SCRAMBLE File=FMM$OPN.:E05TSI                             TUE 07/29/97 16:53 Page:325  
         0 000020   000022 605000 0                  TPL     s:532+4
         0 000021   000006 035003                    ADLA    6,DU
         0 000022   200003 470500                    LDP0    @PASS,,AUTO
         0 000023   000100 101505                    MRL     fill='000'O
         0 000024   000000 020001                    ADSC6   0,A,PR0                  cn=0,n=1
         0 000025   200014 020006                    ADSC6   P2+8,,AUTO               cn=0,n=6
         0 000026   200014 236100                    LDQ     P2+8,,AUTO
         0 000027   200013 116100                    CMPQ    P2+7,,AUTO
         0 000030   000053 604400 0                  TMOZ    s:537

     1819      533    3            P2.X.A=P2.X.A*P2.Y.B;

    533  0 000031   200004 236100                    LDQ     P2,,AUTO
         0 000032   200007 402100                    MPY     P2+3,,AUTO
         0 000033   200004 756100                    STQ     P2,,AUTO

     1820      534    3            P2.X.B=P2.X.B*P2.Y.A;

    534  0 000034   200005 236100                    LDQ     P2+1,,AUTO
         0 000035   200006 402100                    MPY     P2+2,,AUTO
         0 000036   200005 756100                    STQ     P2+1,,AUTO

     1821      535    3            P2.J=P2.J+1;

    535  0 000037   200013 054100                    AOS     P2+7,,AUTO

     1822      536    3            END;

    536  0 000040   200012 235100                    LDA     P2+6,,AUTO
         0 000041   000001 735000                    ALS     1
         0 000042   000044 605000 0                  TPL     s:536+4
         0 000043   000006 035003                    ADLA    6,DU
         0 000044   200003 470500                    LDP0    @PASS,,AUTO
         0 000045   000100 101505                    MRL     fill='000'O
         0 000046   000000 020001                    ADSC6   0,A,PR0                  cn=0,n=1
         0 000047   200014 020006                    ADSC6   P2+8,,AUTO               cn=0,n=6
         0 000050   200014 236100                    LDQ     P2+8,,AUTO
PL6.E3A0      #004=FMM$SCRAMBLE File=FMM$OPN.:E05TSI                             TUE 07/29/97 16:53 Page:326  
         0 000051   200013 116100                    CMPQ    P2+7,,AUTO
         0 000052   000031 605400 0                  TPNZ    s:533

     1823      537    2         P2.Y=P2.X;

    537  0 000053   200004 237100                    LDAQ    P2,,AUTO
         0 000054   200006 757100                    STAQ    P2+2,,AUTO

     1824      538    2         P2.X=ADDR(P2.B(PASS.WD.B(P2.I)+4))->PBASED;

    538  0 000055   200012 235100                    LDA     P2+6,,AUTO
         0 000056   000001 735000                    ALS     1
         0 000057   000061 605000 0                  TPL     s:538+4
         0 000060   000006 035003                    ADLA    6,DU
         0 000061   000100 101505                    MRL     fill='000'O
         0 000062   000000 120001                    ADSC6   0,A,PR0                  cn=1,n=1
         0 000063   200014 020006                    ADSC6   P2+8,,AUTO               cn=0,n=6
         0 000064   200014 236100                    LDQ     P2+8,,AUTO
         0 000065   003100 060506                    CSL     bolr='003'O
         0 000066   200004 040110                    BDSC    P2,Q,AUTO                by=0,bit=4,n=72
         0 000067   200004 000110                    BDSC    P2,,AUTO                 by=0,bit=0,n=72

     1825      539    2         P2.X.BB=P2.X.BB\P2.X.AB;

    539  0 000070   200005 236100                    LDQ     P2+1,,AUTO
         0 000071   200004 676100                    ERQ     P2,,AUTO
         0 000072   200005 756100                    STQ     P2+1,,AUTO

     1826      540    2         END;

    540  0 000073   200012 054100                    AOS     P2+6,,AUTO
         0 000074   200012 235100                    LDA     P2+6,,AUTO
         0 000075   000005 115007                    CMPA    5,DL
         0 000076   000007 604400 0                  TMOZ    s:528

     1827      541    1      PASS=P2.X;

PL6.E3A0      #004=FMM$SCRAMBLE File=FMM$OPN.:E05TSI                             TUE 07/29/97 16:53 Page:327  
    541  0 000077   200004 237100                    LDAQ    P2,,AUTO
         0 000100   000000 755100                    STA     0,,PR0
         0 000101   000001 756100                    STQ     1,,PR0

     1828      542    1      RETURN;

    542  0 000102   000000 702200 xent               TSX2  ! X66_ARET

     1829      543    1   FMM$NSTAMP: ENTRY(PASS);

    543  0 000103   000000 700200 xent  FMM$NSTAMP   TSX0  ! X66_AUTO_1
         0 000104   000022 000001                    ZERO    18,1

     1830      544    1      P2.I=B$JIT.DCB$->F$DCB.NAME.L+1;

    544  0 000105   000000 470400 xsym               LDP0    B$JIT$
         0 000106   000232 471500                    LDP1    154,,PR0
         0 000107   100010 236100                    LDQ     8,,PR1
         0 000110   000033 772000                    QRL     27
         0 000111   000001 036007                    ADLQ    1,DL
         0 000112   200012 756100                    STQ     P2+6,,AUTO

     1831      545    1      CNAME=ADDR(B$JIT.DCB$->F$DCB.NAME)->PNAME;

    545  0 000113   000000 620006                    EAX0    0,QL
         0 000114   040100 100540                    MLR     fill='040'O
         0 000115   100010 000010                    ADSC9   8,,PR1                   cn=0,n=*X0
         0 000116   200004 000040                    ADSC9   P2,,AUTO                 cn=0,n=32

     1832      546    1      P2.J=P2.J+P2.I*3+P2.Z.B*5+P2.Z.A*7+P2.Y.B*11+P2.Y.A*13+P2.X.B*17;

    546  0 000117   200012 236100                    LDQ     P2+6,,AUTO
         0 000120   000003 402007                    MPY     3,DL
         0 000121   200013 036100                    ADLQ    P2+7,,AUTO
         0 000122   200014 756100                    STQ     P2+8,,AUTO
         0 000123   200011 236100                    LDQ     P2+5,,AUTO
         0 000124   000005 402007                    MPY     5,DL
PL6.E3A0      #004=FMM$SCRAMBLE File=FMM$OPN.:E05TSI                             TUE 07/29/97 16:53 Page:328  
         0 000125   200014 036100                    ADLQ    P2+8,,AUTO
         0 000126   200015 756100                    STQ     P2+9,,AUTO
         0 000127   200010 236100                    LDQ     P2+4,,AUTO
         0 000130   000007 402007                    MPY     7,DL
         0 000131   200015 036100                    ADLQ    P2+9,,AUTO
         0 000132   200016 756100                    STQ     P2+10,,AUTO
         0 000133   200007 236100                    LDQ     P2+3,,AUTO
         0 000134   000013 402007                    MPY     11,DL
         0 000135   200016 036100                    ADLQ    P2+10,,AUTO
         0 000136   200017 756100                    STQ     P2+11,,AUTO
         0 000137   200006 236100                    LDQ     P2+2,,AUTO
         0 000140   000015 402007                    MPY     13,DL
         0 000141   200017 036100                    ADLQ    P2+11,,AUTO
         0 000142   200020 756100                    STQ     P2+12,,AUTO
         0 000143   200005 236100                    LDQ     P2+1,,AUTO
         0 000144   000021 402007                    MPY     17,DL
         0 000145   200020 036100                    ADLQ    P2+12,,AUTO
         0 000146   200013 756100                    STQ     P2+7,,AUTO

     1833      547    1      RSLT.AB=P2.X.AB\P2.JB;

    547  0 000147   200004 236100                    LDQ     P2,,AUTO
         0 000150   200013 676100                    ERQ     P2+7,,AUTO
         0 000151   200003 473500                    LDP3    @PASS,,AUTO
         0 000152   300000 756100                    STQ     0,,PR3

     1834      548    1      RETURN;

    548  0 000153   000000 702200 xent               TSX2  ! X66_ARET
     1835      549    1   END FMM$SCRAMBLE;
     1836      550        %EOD;

PL6.E3A0      #004=FMM$SCRAMBLE File=FMM$OPN.:E05TSI                             TUE 07/29/97 16:53 Page:329  
--  Include file information  --

   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FMM$SCRAMBLE.
PL6.E3A0      #004=FMM$SCRAMBLE File=FMM$OPN.:E05TSI                             TUE 07/29/97 16:53 Page:330  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @PASS                      4-0-0/w CHAR(32)    r     1 CNAME
     4-0-0/w STRC(288)   r     1 P2                        *0-0-0/w STRC(72)    r     1 PASS
    *0-0-0/w STRC(72)    r     1 RSLT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/b BIT (72)    r     1 PBASED                     0-0-0/c ACHR        r     1 PNAME


   Procedure FMM$SCRAMBLE requires 108 words for executable code.
   Procedure FMM$SCRAMBLE requires 18 words of local(AUTO) storage.
PL6.E3A0      #004=FMM$SCRAMBLE File=FMM$OPN.:E05TSI                             TUE 07/29/97 16:53 Page:331  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=FMM$SCRAMBLE File=FMM$OPN.:E05TSI                             TUE 07/29/97 16:53 Page:332  
          MINI XREF LISTING

B$JIT.DCB$
       490**DCL       544>>ASSIGN    545>>ASSIGN
B$JIT.ERR.MID
       401**DCL       401--REDEF
B$JIT$
       503**DCL       395--IMP-PTR   544>>ASSIGN    545>>ASSIGN
CNAME
       521**DCL       545<<ASSIGN
F$DCB.ACTPOS
        50**DCL        50--REDEF
F$DCB.ARS
        25**DCL        25--REDEF
F$DCB.ATTR
        43**DCL        44--REDEF
F$DCB.BORROW
        58**DCL        58--REDEF      58--REDEF      58--REDEF
F$DCB.DCBNAME.L
        72**DCL        72--IMP-SIZ
F$DCB.EOMCHAR
        29**DCL        29--REDEF
F$DCB.FLDID
        53**DCL        53--REDEF
F$DCB.FORM$
        47**DCL        47--REDEF
F$DCB.FSECT
        63**DCL        63--REDEF
F$DCB.FSN
        40**DCL        40--REDEF      40--REDEF      41--REDEF
F$DCB.HEADER$
        46**DCL        46--REDEF
F$DCB.IXTNSIZE
        44**DCL        44--REDEF
PL6.E3A0      #004=FMM$SCRAMBLE File=FMM$OPN.:E05TSI                             TUE 07/29/97 16:53 Page:333  
F$DCB.LASTSTA$
        34**DCL        34--REDEF
F$DCB.LVL
        59**DCL        59--REDEF
F$DCB.NAME
        34**DCL       545--ASSIGN
F$DCB.NAME.C
        34**DCL        34--REDEF
F$DCB.NAME.L
        34**DCL       544>>ASSIGN
F$DCB.NOEOF
        55**DCL        55--REDEF
F$DCB.NRECS
        45**DCL        45--REDEF
F$DCB.NRECX
        64**DCL        64--REDEF
F$DCB.OHDR
        56**DCL        56--REDEF
F$DCB.ORG
        39**DCL        39--REDEF
F$DCB.PRECNO
        62**DCL        62--REDEF
F$DCB.RCSZ
        67**DCL        67--REDEF
F$DCB.RES
        35**DCL        35--REDEF
F$DCB.SETX
        47**DCL        47--REDEF
F$DCB.TAB$
        46**DCL        47--REDEF
F$DCB.TDA
        61**DCL        61--REDEF
F$DCB.WSN
        36**DCL        36--REDEF
P2
       504**DCL       521--REDEF
PL6.E3A0      #004=FMM$SCRAMBLE File=FMM$OPN.:E05TSI                             TUE 07/29/97 16:53 Page:334  
P2.B
       510**DCL       528<<ASSIGN    529<<ASSIGN    538--ASSIGN
P2.I
       517**DCL       518--REDEF     523--IMP-SIZ   527<<DOINDEX   532>>DOWHILE   538>>ASSIGN    544<<ASSIGN
       545>>ASSIGN    546>>ASSIGN
P2.J
       519**DCL       520--REDEF     531<<ASSIGN    532>>DOWHILE   535<<ASSIGN    535>>ASSIGN    546<<ASSIGN
       546>>ASSIGN
P2.JB
       520**DCL       547>>ASSIGN
P2.X
       505**DCL       510--REDEF     530>>ASSIGN    537>>ASSIGN    538<<ASSIGN    541>>ASSIGN
P2.X.A
       506**DCL       507--REDEF     525<<ASSIGN    533<<ASSIGN    533>>ASSIGN
P2.X.AB
       507**DCL       539>>ASSIGN    547>>ASSIGN
P2.X.B
       508**DCL       509--REDEF     526<<ASSIGN    534<<ASSIGN    534>>ASSIGN    546>>ASSIGN
P2.X.BB
       509**DCL       539<<ASSIGN    539>>ASSIGN
P2.Y
       511**DCL       530<<ASSIGN    537<<ASSIGN
P2.Y.A
       512**DCL       534>>ASSIGN    546>>ASSIGN
P2.Y.B
       513**DCL       533>>ASSIGN    546>>ASSIGN
P2.Z.A
       515**DCL       546>>ASSIGN
P2.Z.B
       516**DCL       546>>ASSIGN
PASS
        14**DCL        10--PROC       18--REDEF     541<<ASSIGN    543--ENTRY
PASS.WD.A
        16**DCL       532>>DOWHILE
PASS.WD.B
        17**DCL       538>>ASSIGN
PL6.E3A0      #004=FMM$SCRAMBLE File=FMM$OPN.:E05TSI                             TUE 07/29/97 16:53 Page:335  
PBASED
       522**DCL       538>>ASSIGN
PNAME
       523**DCL       545>>ASSIGN
RSLT.AB
        19**DCL       547<<ASSIGN

PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:336  
     1837        1        /*T***********************************************************/
     1838        2        /*T*                                                         */
     1839        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1840        4        /*T*                                                         */
     1841        5        /*T***********************************************************/
     1842        6                    /*F*
     1843        7                    *     NAME:    FMM$SCRUB
     1844        8                    *
     1845        9                    *     PURPOSE:  TO CLEAN THE DCB BACK TO LOADER BUILT CONDITIONS.
     1846       10                    */
     1847       11        FMM$SCRUB: PROC(JDCB$);
     1848       12                    /**/
     1849       13                    /* PARAMETER DATA */
     1850       14                    /**/
     1851       15    1   DCL JDCB$ PTR; /* POINTER TO THE DCB */
     1852       16                    /**/
     1853       17                    /* AUTOMATIC DATA */
     1854       18                    /**/
     1855       19    1   DCL FPT$ PTR; /* TEMPORARY POINTER */
     1856       20    1   DCL J UBIN;
     1857       21    1   DCL FEXTX REDEF J UBIN;
     1858       22    1   DCL N SBIN;
     1859       23                    /**/
     1860       24                    /* SPECIAL BASED DATA */
     1861       25                    /**/
     1862       26    1   DCL MOVEJC BASED CHAR(J);
     1863       27    1   DCL 1 MOVEJB BASED,2 * CHAR(J);
     1864       28    1   DCL 1 SNAME BASED (FPT$),
     1865       29    1         2 S CHAR(2) UNAL,
     1866       30    1         2 OP CHAR(N) UNAL;
     1867       31                    /**/
     1868       32                    /* CONSTANT DATA */
     1869       33                    /**/
     1870       34    1   DCL 1 STARG CONSTANT,
     1871       35    1         2 L UBIN(9) UNAL INIT(2),
     1872       36    1         2 C CHAR(2) UNAL INIT('*G');
     1873       37    1   DCL STARGC REDEF STARG CHAR(3);
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:337  
     1874       38    1   DCL CHAR32 BASED CHAR(32);
     1875       39                    /**/
     1876       40                    /* DEFINE EXTERNAL ROUTINES */
     1877       41                    /**/
     1878       42    1   DCL FSA$FSP ENTRY(2) ALTRET; /* FREE ROSEG SPACE */
     1879       43                    /**/
     1880       44                    /* DEFINE EXTERNAL DATA */
     1881       45                    /**/
     1882       46    1   DCL B$ROSEG$ PTR SYMREF READONLY;
     1883       47                    /**/
     1884       48        %MACRO F$DCB#(BASED=BASED);
     1885       49        %INCLUDE F$DCB;
     1886       98        %MEND;
     1887       99        %F$DCB#(BASED="BASED(JDCB$)");
     1888      149        %INCLUDE CP_6;
     1889     5708        %INCLUDE FM_OPLBL_R;
     1890     5722        %INCLUDE FM$MACROS;
     1891     6097        %INCLUDE FM_FIELD_C;
     1892     6138        %CODE16;
     1893     6146        %VLP_TAB(STCLASS=BASED,FPTN=VLP$TAB);
     1894     6160        %VLP_HDR (LEN=163, FPTN=VLP$HDRF, STCLASS=BASED);
     1895     6176        %VLP_STATION (STCLASS=BASED,FPTN=VLP$STATION);
     1896     6203        %VLP_SETSTA  (STCLASS=BASED,FPTN=VLP$SETSTA);
     1897     6231        %VLP_FPRG (STCLASS=BASED, FPTN=VLP$FPRG);
     1898     6252        %VLP_RECFIELD (FPTN=RECFIELD, STCLASS=BASED);
     1899     6296        %VLP_IRREC (FPTN=IRREC, STCLASS=BASED);
     1900     6310        %FMG$KFIELD (FPTN=KFIELD);
     1901     6313        %FM$FIELD_START(FPTN=FM$FIELD_START, STCLASS=BASED);
     1902     6335        %FITALTKEYS (BASED="BASED(FPT$)");
     1903     6341        %INCLUDE CP_6_SUBS;
     1904     6881        %INCLUDE F_DCB_D;
     1905     6969        %M$MDCB(DCBN=FMM$SDCB,STCLASS="CONSTANT SYMDEF");
     1906     7043                    /**/
     1907     7044                    /*
     1908     7045                    *  FIRST ERASE THE ENTIRE DCB, THEN REINITIALIZE IT.
     1909     7046                    */
     1910     7047    1      IF F$DCB.TAB$~=ADDR(NIL)
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:338  
     1911     7048    1      THEN CALL FSA$FSP(SIZEW(VLP$TAB),F$DCB.TAB$);
     1912     7049    1      IF F$DCB.HEADER$~=ADDR(NIL)
     1913     7050    1      THEN CALL FSA$FSP(SIZEW(VLP$HDRF),F$DCB.HEADER$);
     1914     7051    1      IF F$DCB.FORM$~=ADDR(NIL)
     1915     7052    1      THEN CALL FSA$FSP(SIZEW(CODE16),F$DCB.FORM$);
     1916     7053    1      IF F$DCB.LASTSTA$~=ADDR(NIL)
     1917     7054    1      THEN CALL FSA$FSP(SIZEW(VLP$STATION)+SIZEW(VLP$SETSTA),F$DCB.LASTSTA$);
     1918     7055    2      IF F$DCB.ALTKEYX~=0 THEN DO;
     1919     7056    2         FPT$=PINCRW(B$ROSEG$,F$DCB.ALTKEYX);
     1920     7057    2         J=FITALTKEYS.NUMWRDS; /* Happens to work for IRKEYS too */
     1921     7058    2         CALL FSA$FSP(J,FPT$);
     1922     7059    2         F$DCB.ALTKEYX=0;
     1923     7060    2         END;
     1924     7061    2      IF F$DCB.FPRGX~=0 THEN DO;
     1925     7062    2         FPT$=PINCRW(B$ROSEG$,F$DCB.FPRGX);
     1926     7063    2         CALL FSA$FSP(SIZEW(VLP$FPRG),FPT$);
     1927     7064    2         F$DCB.FPRGX=0;
     1928     7065    2         END;
     1929     7066    2      IF F$DCB.KFIELDX~=0 THEN DO;
     1930     7067    2         FPT$=PINCRW(B$ROSEG$, F$DCB.KFIELDX);
     1931     7068    2         J=FPT$->KFIELD.NWORDS;
     1932     7069    2         CALL FSA$FSP(J, FPT$);
     1933     7070    2         F$DCB.KFIELDX=0;
     1934     7071    2         END;
     1935     7072    2      IF F$DCB.FIELDX~=0 THEN DO;
     1936     7073    2         FPT$=PINCRW(B$ROSEG$, F$DCB.FIELDX);
     1937     7074    2         J=(FPT$->RECFIELD.NFIELDS#+1)/2 +1;
     1938     7075    2         CALL FSA$FSP(J, FPT$);
     1939     7076    2         F$DCB.FIELDX=0;
     1940     7077    2         END;
     1941     7078    2      IF F$DCB.STARTX~=0 THEN DO;
     1942     7079    2         FPT$=PINCRW(B$ROSEG$,F$DCB.STARTX);
     1943     7080    2         J=FPT$->FM$FIELD_START.NWORDS;
     1944     7081    2         CALL FSA$FSP(J,FPT$);
     1945     7082    2         F$DCB.STARTX=0;
     1946     7083    2         END;
     1947     7084    2      IF F$DCB.IRRECX~=0 THEN DO;
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:339  
     1948     7085    2         FPT$=PINCRW(B$ROSEG$, F$DCB.IRRECX);
     1949     7086    2         J=(FPT$->IRREC.NFIELDS#+3)/4 + 1;
     1950     7087    2         CALL FSA$FSP(J, FPT$);
     1951     7088    2         F$DCB.IRRECX=0;
     1952     7089    2         END;
     1953     7090                    /**/
     1954     7091    1   FMM$SCRUB1: ENTRY(JDCB$);
     1955     7092                    /**/
     1956     7093    1      J=POFFC(ADDR(FMM$SDCB.BFR),ADDR(FMM$SDCB));
     1957     7094    1      JDCB$->MOVEJB=FMM$SDCB;
     1958     7095    1      F$DCB.DCBNAME.S='0'B;
     1959     7096    1      F$DCB.NAME.L=0;
     1960     7097                    /*
     1961     7098                    *  IF FEXTX NOT ALREADY FOUND, THEN LOOK UP THE DCB IN THE
     1962     7099                    *  OP LABEL TABLES TO DETERMINE THE FUN AND RES FOR THE DCB.
     1963     7100                    *  SPECIAL DCBS ARE NAMED 'M$xx', 'F$nnn', AND 'F$n'.
     1964     7101                    *  FIRST SEARCH FOR A SYSTEM OP LABEL (AS IN CP-V)
     1965     7102                    */
     1966     7103    1      N=F$DCB.DCBNAME.L-2;
     1967     7104    1      J=F$DCB.DCBNAME.X;
     1968     7105    1      IF J~=0 OR N<=0 THEN GOTO FILLOPL;
     1969     7106    1      FPT$=ADDR(F$DCB.DCBNAME.N);
     1970     7107    2      IF SNAME.S='M$' THEN DO J=4 TO F_NUMOPS;
     1971     7108    2         IF SNAME.OP=F_OPLBL(J) THEN GOTO FILLOPL;
     1972     7109    2         END;
     1973     7110                    /*
     1974     7111                    *  NEXT SEARCH FOR FORTRAN DCBS (101 THRU 108)
     1975     7112                    */
     1976     7113    2      IF SNAME.S='F$' THEN DO;
     1977     7114    3         DO J=0 TO F_NUMSPS;
     1978     7115    4            IF SNAME.OP=F_OPSPS(J) OR J=0 THEN DO;
     1979     7116    4               F$DCB.FUN=F_OPSPFUN(FEXTX);
     1980     7117    4               F$DCB.RES=F_OPLRES(F_OPSPRX(FEXTX));
     1981     7118    4               END;
     1982     7119    3            END;
     1983     7120    2         GOTO FILLSPS;
     1984     7121    2         END;
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:340  
     1985     7122    1      J=0;
     1986     7123                    /*
     1987     7124                    *  SPECIAL OP LABEL DCB ('M$C' THRU 'M$GO')
     1988     7125                    */
     1989     7126    1   FILLOPL:
     1990     7127    1      F$DCB.FUN=F_OPLFUN(FEXTX);
     1991     7128    1      F$DCB.RES=F_OPLRES(F_OPLRX(FEXTX));
     1992     7129    1      F$DCB.FEXTX=J;
     1993     7130                    /*
     1994     7131                    *  NOW SPECIAL CASE M$GO OP LABEL
     1995     7132                    */
     1996     7133    1   FILLSPS:;
     1997     7134    2      IF FEXTX=3 THEN DO; /* GO IS THIRD ON COMMAND LINE */
     1998     7135    2         F$DCB.ASN=%FILE#;
     1999     7136    2         ADDR(F$DCB.NAME)->CHAR32=STARGC;
     2000     7137    2         END;
     2001     7138    1      RETURN;
     2002     7139    1   END FMM$SCRUB;

PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:341  
--  Include file information  --

   F_DCB_D.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   FM_FIELD_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   FM_OPLBL_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  is referenced.
      No diagnostics issued in procedure FMM$SCRUB.

   Procedure FMM$SCRUB requires 309 words for executable code.
   Procedure FMM$SCRUB requires 10 words of local(AUTO) storage.

    No errors detected in file FMM$OPN.:E05TSI    .

PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:342  

 Object Unit name= FMM$SCRUB                                  File name= FMM$OPN.:E05TOU
 UTS= JUL 29 '97 16:53:54.48 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     99    143  FMM$SCRUB
    1   DCB   even  none     0      0  M$UC
    2   Proc  even  none   309    465  FMM$SCRUB
    3  RoData even  none    13     15  FMM$SCRUB

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        1  FMM$SCRUB
     2    274                  yes      Std        1  FMM$SCRUB1

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      1  FMM$SDCB

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 FSA$FSP
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:343  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    B$ROSEG$                              M$UC                             r    F_OPLBL
r    F_OPLFUN                         r    F_OPLRX                          r    F_OPLRES
r    F_OPSPS                          r    F_OPSPFUN                        r    F_OPSPRX
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:344  


     1837        1        /*T***********************************************************/
     1838        2        /*T*                                                         */
     1839        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1840        4        /*T*                                                         */
     1841        5        /*T***********************************************************/
     1842        6                    /*F*
     1843        7                    *     NAME:    FMM$SCRUB
     1844        8                    *
     1845        9                    *     PURPOSE:  TO CLEAN THE DCB BACK TO LOADER BUILT CONDITIONS.
     1846       10                    */
     1847       11        FMM$SCRUB: PROC(JDCB$);

     11  2 000000   000000 700200 xent  FMM$SCRUB    TSX0  ! X66_AUTO_1
         2 000001   000012 000001                    ZERO    10,1

     1848       12                    /**/
     1849       13                    /* PARAMETER DATA */
     1850       14                    /**/
     1851       15    1   DCL JDCB$ PTR; /* POINTER TO THE DCB */
     1852       16                    /**/
     1853       17                    /* AUTOMATIC DATA */
     1854       18                    /**/
     1855       19    1   DCL FPT$ PTR; /* TEMPORARY POINTER */
     1856       20    1   DCL J UBIN;
     1857       21    1   DCL FEXTX REDEF J UBIN;
     1858       22    1   DCL N SBIN;
     1859       23                    /**/
     1860       24                    /* SPECIAL BASED DATA */
     1861       25                    /**/
     1862       26    1   DCL MOVEJC BASED CHAR(J);
     1863       27    1   DCL 1 MOVEJB BASED,2 * CHAR(J);
     1864       28    1   DCL 1 SNAME BASED (FPT$),
     1865       29    1         2 S CHAR(2) UNAL,
     1866       30    1         2 OP CHAR(N) UNAL;
     1867       31                    /**/
     1868       32                    /* CONSTANT DATA */
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:345  
     1869       33                    /**/
     1870       34    1   DCL 1 STARG CONSTANT,
     1871       35    1         2 L UBIN(9) UNAL INIT(2),
     1872       36    1         2 C CHAR(2) UNAL INIT('*G');
     1873       37    1   DCL STARGC REDEF STARG CHAR(3);
     1874       38    1   DCL CHAR32 BASED CHAR(32);
     1875       39                    /**/
     1876       40                    /* DEFINE EXTERNAL ROUTINES */
     1877       41                    /**/
     1878       42    1   DCL FSA$FSP ENTRY(2) ALTRET; /* FREE ROSEG SPACE */
     1879       43                    /**/
     1880       44                    /* DEFINE EXTERNAL DATA */
     1881       45                    /**/
     1882       46    1   DCL B$ROSEG$ PTR SYMREF READONLY;
     1883       47                    /**/
     1884       48        %MACRO F$DCB#(BASED=BASED);
     1885       49        %INCLUDE F$DCB;
     1886       98        %MEND;
     1887       99        %F$DCB#(BASED="BASED(JDCB$)");
     1888      149        %INCLUDE CP_6;
     1889     5708        %INCLUDE FM_OPLBL_R;
     1890     5722        %INCLUDE FM$MACROS;
     1891     6097        %INCLUDE FM_FIELD_C;
     1892     6138        %CODE16;
     1893     6146        %VLP_TAB(STCLASS=BASED,FPTN=VLP$TAB);
     1894     6160        %VLP_HDR (LEN=163, FPTN=VLP$HDRF, STCLASS=BASED);
     1895     6176        %VLP_STATION (STCLASS=BASED,FPTN=VLP$STATION);
     1896     6203        %VLP_SETSTA  (STCLASS=BASED,FPTN=VLP$SETSTA);
     1897     6231        %VLP_FPRG (STCLASS=BASED, FPTN=VLP$FPRG);
     1898     6252        %VLP_RECFIELD (FPTN=RECFIELD, STCLASS=BASED);
     1899     6296        %VLP_IRREC (FPTN=IRREC, STCLASS=BASED);
     1900     6310        %FMG$KFIELD (FPTN=KFIELD);
     1901     6313        %FM$FIELD_START(FPTN=FM$FIELD_START, STCLASS=BASED);
     1902     6335        %FITALTKEYS (BASED="BASED(FPT$)");
     1903     6341        %INCLUDE CP_6_SUBS;
     1904     6881        %INCLUDE F_DCB_D;
     1905     6969        %M$MDCB(DCBN=FMM$SDCB,STCLASS="CONSTANT SYMDEF");
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:346  
     1906     7043                    /**/
     1907     7044                    /*
     1908     7045                    *  FIRST ERASE THE ENTIRE DCB, THEN REINITIALIZE IT.
     1909     7046                    */
     1910     7047    1      IF F$DCB.TAB$~=ADDR(NIL)

   7047  2 000002   200003 470500                    LDP0    @JDCB$,,AUTO
         2 000003   000000 471500                    LDP1    0,,PR0
         2 000004   100047 236100                    LDQ     39,,PR1
         2 000005   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000006   000017 600000 2                  TZE     s:7049

     1911     7048    1      THEN CALL FSA$FSP(SIZEW(VLP$TAB),F$DCB.TAB$);

   7048  2 000007   100047 633500                    EPPR3   39,,PR1
         2 000010   200011 453500                    STP3    N+3,,AUTO
         2 000011   000000 236000 3                  LDQ     0
         2 000012   200010 756100                    STQ     N+2,,AUTO
         2 000013   200010 630500                    EPPR0   N+2,,AUTO
         2 000014   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000015   000000 701000 xent               TSX1    FSA$FSP
         2 000016   000000 011000                    NOP     0

     1912     7049    1      IF F$DCB.HEADER$~=ADDR(NIL)

   7049  2 000017   200003 470500                    LDP0    @JDCB$,,AUTO
         2 000020   000000 471500                    LDP1    0,,PR0
         2 000021   100046 236100                    LDQ     38,,PR1
         2 000022   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000023   000034 600000 2                  TZE     s:7051

     1913     7050    1      THEN CALL FSA$FSP(SIZEW(VLP$HDRF),F$DCB.HEADER$);

   7050  2 000024   100046 633500                    EPPR3   38,,PR1
         2 000025   200011 453500                    STP3    N+3,,AUTO
         2 000026   000002 236000 3                  LDQ     2
         2 000027   200010 756100                    STQ     N+2,,AUTO
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:347  
         2 000030   200010 630500                    EPPR0   N+2,,AUTO
         2 000031   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000032   000000 701000 xent               TSX1    FSA$FSP
         2 000033   000000 011000                    NOP     0

     1914     7051    1      IF F$DCB.FORM$~=ADDR(NIL)

   7051  2 000034   200003 470500                    LDP0    @JDCB$,,AUTO
         2 000035   000000 471500                    LDP1    0,,PR0
         2 000036   100050 236100                    LDQ     40,,PR1
         2 000037   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000040   000051 600000 2                  TZE     s:7053

     1915     7052    1      THEN CALL FSA$FSP(SIZEW(CODE16),F$DCB.FORM$);

   7052  2 000041   100050 633500                    EPPR3   40,,PR1
         2 000042   200011 453500                    STP3    N+3,,AUTO
         2 000043   000004 236000 3                  LDQ     4
         2 000044   200010 756100                    STQ     N+2,,AUTO
         2 000045   200010 630500                    EPPR0   N+2,,AUTO
         2 000046   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000047   000000 701000 xent               TSX1    FSA$FSP
         2 000050   000000 011000                    NOP     0

     1916     7053    1      IF F$DCB.LASTSTA$~=ADDR(NIL)

   7053  2 000051   200003 470500                    LDP0    @JDCB$,,AUTO
         2 000052   000000 471500                    LDP1    0,,PR0
         2 000053   100007 236100                    LDQ     7,,PR1
         2 000054   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000055   000066 600000 2                  TZE     s:7055

     1917     7054    1      THEN CALL FSA$FSP(SIZEW(VLP$STATION)+SIZEW(VLP$SETSTA),F$DCB.LASTSTA$);

   7054  2 000056   100007 633500                    EPPR3   7,,PR1
         2 000057   200011 453500                    STP3    N+3,,AUTO
         2 000060   000006 236000 3                  LDQ     6
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:348  
         2 000061   200010 756100                    STQ     N+2,,AUTO
         2 000062   200010 630500                    EPPR0   N+2,,AUTO
         2 000063   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000064   000000 701000 xent               TSX1    FSA$FSP
         2 000065   000000 011000                    NOP     0

     1918     7055    2      IF F$DCB.ALTKEYX~=0 THEN DO;

   7055  2 000066   200003 470500                    LDP0    @JDCB$,,AUTO
         2 000067   000000 471500                    LDP1    0,,PR0
         2 000070   100052 720100                    LXL0    42,,PR1
         2 000071   000115 600000 2                  TZE     s:7061

     1919     7056    2         FPT$=PINCRW(B$ROSEG$,F$DCB.ALTKEYX);

   7056  2 000072   000000 636010                    EAQ     0,X0
         2 000073   000000 036000 xsym               ADLQ    B$ROSEG$
         2 000074   200004 756100                    STQ     FPT$,,AUTO

     1920     7057    2         J=FITALTKEYS.NUMWRDS; /* Happens to work for IRKEYS too */

   7057  2 000075   200004 471500                    LDP1    FPT$,,AUTO
         2 000076   100000 236100                    LDQ     0,,PR1
         2 000077   000033 772000                    QRL     27
         2 000100   200005 756100                    STQ     J,,AUTO

     1921     7058    2         CALL FSA$FSP(J,FPT$);

   7058  2 000101   200004 633500                    EPPR3   FPT$,,AUTO
         2 000102   200011 453500                    STP3    N+3,,AUTO
         2 000103   200005 634500                    EPPR4   J,,AUTO
         2 000104   200010 454500                    STP4    N+2,,AUTO
         2 000105   200010 630500                    EPPR0   N+2,,AUTO
         2 000106   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000107   000000 701000 xent               TSX1    FSA$FSP
         2 000110   000000 011000                    NOP     0

PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:349  
     1922     7059    2         F$DCB.ALTKEYX=0;

   7059  2 000111   200003 470500                    LDP0    @JDCB$,,AUTO
         2 000112   000000 471500                    LDP1    0,,PR0
         2 000113   000000 220003                    LDX0    0,DU
         2 000114   100052 440100                    SXL0    42,,PR1

     1923     7060    2         END;

     1924     7061    2      IF F$DCB.FPRGX~=0 THEN DO;

   7061  2 000115   000000 471500                    LDP1    0,,PR0
         2 000116   100054 220100                    LDX0    44,,PR1
         2 000117   000137 600000 2                  TZE     s:7066

     1925     7062    2         FPT$=PINCRW(B$ROSEG$,F$DCB.FPRGX);

   7062  2 000120   000000 636010                    EAQ     0,X0
         2 000121   000000 036000 xsym               ADLQ    B$ROSEG$
         2 000122   200004 756100                    STQ     FPT$,,AUTO

     1926     7063    2         CALL FSA$FSP(SIZEW(VLP$FPRG),FPT$);

   7063  2 000123   200004 631500                    EPPR1   FPT$,,AUTO
         2 000124   200011 451500                    STP1    N+3,,AUTO
         2 000125   000010 236000 3                  LDQ     8
         2 000126   200010 756100                    STQ     N+2,,AUTO
         2 000127   200010 630500                    EPPR0   N+2,,AUTO
         2 000130   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000131   000000 701000 xent               TSX1    FSA$FSP
         2 000132   000000 011000                    NOP     0

     1927     7064    2         F$DCB.FPRGX=0;

   7064  2 000133   200003 470500                    LDP0    @JDCB$,,AUTO
         2 000134   000000 471500                    LDP1    0,,PR0
         2 000135   000000 220003                    LDX0    0,DU
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:350  
         2 000136   100054 740100                    STX0    44,,PR1

     1928     7065    2         END;

     1929     7066    2      IF F$DCB.KFIELDX~=0 THEN DO;

   7066  2 000137   000000 471500                    LDP1    0,,PR0
         2 000140   100056 720100                    LXL0    46,,PR1
         2 000141   000164 600000 2                  TZE     s:7072

     1930     7067    2         FPT$=PINCRW(B$ROSEG$, F$DCB.KFIELDX);

   7067  2 000142   000000 636010                    EAQ     0,X0
         2 000143   000000 036000 xsym               ADLQ    B$ROSEG$
         2 000144   200004 756100                    STQ     FPT$,,AUTO

     1931     7068    2         J=FPT$->KFIELD.NWORDS;

   7068  2 000145   200004 471500                    LDP1    FPT$,,AUTO
         2 000146   100000 235100                    LDA     0,,PR1
         2 000147   200005 755100                    STA     J,,AUTO

     1932     7069    2         CALL FSA$FSP(J, FPT$);

   7069  2 000150   200004 633500                    EPPR3   FPT$,,AUTO
         2 000151   200011 453500                    STP3    N+3,,AUTO
         2 000152   200005 634500                    EPPR4   J,,AUTO
         2 000153   200010 454500                    STP4    N+2,,AUTO
         2 000154   200010 630500                    EPPR0   N+2,,AUTO
         2 000155   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000156   000000 701000 xent               TSX1    FSA$FSP
         2 000157   000000 011000                    NOP     0

     1933     7070    2         F$DCB.KFIELDX=0;

   7070  2 000160   200003 470500                    LDP0    @JDCB$,,AUTO
         2 000161   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:351  
         2 000162   000000 220003                    LDX0    0,DU
         2 000163   100056 440100                    SXL0    46,,PR1

     1934     7071    2         END;

     1935     7072    2      IF F$DCB.FIELDX~=0 THEN DO;

   7072  2 000164   000000 471500                    LDP1    0,,PR0
         2 000165   100054 720100                    LXL0    44,,PR1
         2 000166   000215 600000 2                  TZE     s:7078

     1936     7073    2         FPT$=PINCRW(B$ROSEG$, F$DCB.FIELDX);

   7073  2 000167   000000 636010                    EAQ     0,X0
         2 000170   000000 036000 xsym               ADLQ    B$ROSEG$
         2 000171   200004 756100                    STQ     FPT$,,AUTO

     1937     7074    2         J=(FPT$->RECFIELD.NFIELDS#+1)/2 +1;

   7074  2 000172   200004 471500                    LDP1    FPT$,,AUTO
         2 000173   100000 236100                    LDQ     0,,PR1
         2 000174   000032 376000 xsym               ANQ     B_VECTNIL+26
         2 000175   000001 036007                    ADLQ    1,DL
         2 000176   000001 772000                    QRL     1
         2 000177   000001 036007                    ADLQ    1,DL
         2 000200   200005 756100                    STQ     J,,AUTO

     1938     7075    2         CALL FSA$FSP(J, FPT$);

   7075  2 000201   200004 633500                    EPPR3   FPT$,,AUTO
         2 000202   200011 453500                    STP3    N+3,,AUTO
         2 000203   200005 634500                    EPPR4   J,,AUTO
         2 000204   200010 454500                    STP4    N+2,,AUTO
         2 000205   200010 630500                    EPPR0   N+2,,AUTO
         2 000206   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000207   000000 701000 xent               TSX1    FSA$FSP
         2 000210   000000 011000                    NOP     0
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:352  

     1939     7076    2         F$DCB.FIELDX=0;

   7076  2 000211   200003 470500                    LDP0    @JDCB$,,AUTO
         2 000212   000000 471500                    LDP1    0,,PR0
         2 000213   000000 220003                    LDX0    0,DU
         2 000214   100054 440100                    SXL0    44,,PR1

     1940     7077    2         END;

     1941     7078    2      IF F$DCB.STARTX~=0 THEN DO;

   7078  2 000215   000000 471500                    LDP1    0,,PR0
         2 000216   100057 220100                    LDX0    47,,PR1
         2 000217   000242 600000 2                  TZE     s:7084

     1942     7079    2         FPT$=PINCRW(B$ROSEG$,F$DCB.STARTX);

   7079  2 000220   000000 636010                    EAQ     0,X0
         2 000221   000000 036000 xsym               ADLQ    B$ROSEG$
         2 000222   200004 756100                    STQ     FPT$,,AUTO

     1943     7080    2         J=FPT$->FM$FIELD_START.NWORDS;

   7080  2 000223   200004 471500                    LDP1    FPT$,,AUTO
         2 000224   100000 235100                    LDA     0,,PR1
         2 000225   200005 755100                    STA     J,,AUTO

     1944     7081    2         CALL FSA$FSP(J,FPT$);

   7081  2 000226   200004 633500                    EPPR3   FPT$,,AUTO
         2 000227   200011 453500                    STP3    N+3,,AUTO
         2 000230   200005 634500                    EPPR4   J,,AUTO
         2 000231   200010 454500                    STP4    N+2,,AUTO
         2 000232   200010 630500                    EPPR0   N+2,,AUTO
         2 000233   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000234   000000 701000 xent               TSX1    FSA$FSP
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:353  
         2 000235   000000 011000                    NOP     0

     1945     7082    2         F$DCB.STARTX=0;

   7082  2 000236   200003 470500                    LDP0    @JDCB$,,AUTO
         2 000237   000000 471500                    LDP1    0,,PR0
         2 000240   000000 220003                    LDX0    0,DU
         2 000241   100057 740100                    STX0    47,,PR1

     1946     7083    2         END;

     1947     7084    2      IF F$DCB.IRRECX~=0 THEN DO;

   7084  2 000242   000000 471500                    LDP1    0,,PR0
         2 000243   100061 220100                    LDX0    49,,PR1
         2 000244   000273 600000 2                  TZE     s:7089

     1948     7085    2         FPT$=PINCRW(B$ROSEG$, F$DCB.IRRECX);

   7085  2 000245   000000 636010                    EAQ     0,X0
         2 000246   000000 036000 xsym               ADLQ    B$ROSEG$
         2 000247   200004 756100                    STQ     FPT$,,AUTO

     1949     7086    2         J=(FPT$->IRREC.NFIELDS#+3)/4 + 1;

   7086  2 000250   200004 471500                    LDP1    FPT$,,AUTO
         2 000251   100000 236100                    LDQ     0,,PR1
         2 000252   000032 376000 xsym               ANQ     B_VECTNIL+26
         2 000253   000003 036007                    ADLQ    3,DL
         2 000254   000002 772000                    QRL     2
         2 000255   000001 036007                    ADLQ    1,DL
         2 000256   200005 756100                    STQ     J,,AUTO

     1950     7087    2         CALL FSA$FSP(J, FPT$);

   7087  2 000257   200004 633500                    EPPR3   FPT$,,AUTO
         2 000260   200011 453500                    STP3    N+3,,AUTO
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:354  
         2 000261   200005 634500                    EPPR4   J,,AUTO
         2 000262   200010 454500                    STP4    N+2,,AUTO
         2 000263   200010 630500                    EPPR0   N+2,,AUTO
         2 000264   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000265   000000 701000 xent               TSX1    FSA$FSP
         2 000266   000000 011000                    NOP     0

     1951     7088    2         F$DCB.IRRECX=0;

   7088  2 000267   200003 470500                    LDP0    @JDCB$,,AUTO
         2 000270   000000 471500                    LDP1    0,,PR0
         2 000271   000000 220003                    LDX0    0,DU
         2 000272   100061 740100                    STX0    49,,PR1

     1952     7089    2         END;

   7089  2 000273   000276 710000 2                  TRA     s:7093

     1953     7090                    /**/
     1954     7091    1   FMM$SCRUB1: ENTRY(JDCB$);

   7091  2 000274   000000 700200 xent  FMM$SCRUB1   TSX0  ! X66_AUTO_1
         2 000275   000012 000001                    ZERO    10,1

     1955     7092                    /**/
     1956     7093    1      J=POFFC(ADDR(FMM$SDCB.BFR),ADDR(FMM$SDCB));

   7093  2 000276   000011 236000 3                  LDQ     9
         2 000277   000020 772000                    QRL     16
         2 000300   200010 756100                    STQ     N+2,,AUTO
         2 000301   000012 236000 3                  LDQ     10
         2 000302   000020 772000                    QRL     16
         2 000303   200010 136100                    SBLQ    N+2,,AUTO
         2 000304   200005 756100                    STQ     J,,AUTO

     1957     7094    1      JDCB$->MOVEJB=FMM$SDCB;

PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:355  
   7094  2 000305   200003 470500                    LDP0    @JDCB$,,AUTO
         2 000306   000000 471500                    LDP1    0,,PR0
         2 000307   000000 620006                    EAX0    0,QL
         2 000310   000140 100400                    MLR     fill='000'O
         2 000311   000001 000600 0                  ADSC9   FMM$SDCB                 cn=0,n=384
         2 000312   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

     1958     7095    1      F$DCB.DCBNAME.S='0'B;

   7095  2 000313   000000 471500                    LDP1    0,,PR0
         2 000314   000013 236000 3                  LDQ     11
         2 000315   100140 356100                    ANSQ    96,,PR1

     1959     7096    1      F$DCB.NAME.L=0;

   7096  2 000316   000000 471500                    LDP1    0,,PR0
         2 000317   000000 236003                    LDQ     0,DU
         2 000320   100010 552140                    STBQ    8,'40'O,PR1

     1960     7097                    /*
     1961     7098                    *  IF FEXTX NOT ALREADY FOUND, THEN LOOK UP THE DCB IN THE
     1962     7099                    *  OP LABEL TABLES TO DETERMINE THE FUN AND RES FOR THE DCB.
     1963     7100                    *  SPECIAL DCBS ARE NAMED 'M$xx', 'F$nnn', AND 'F$n'.
     1964     7101                    *  FIRST SEARCH FOR A SYSTEM OP LABEL (AS IN CP-V)
     1965     7102                    */
     1966     7103    1      N=F$DCB.DCBNAME.L-2;

   7103  2 000321   000000 471500                    LDP1    0,,PR0
         2 000322   100140 236100                    LDQ     96,,PR1
         2 000323   000033 772000                    QRL     27
         2 000324   000037 376007                    ANQ     31,DL
         2 000325   000002 136007                    SBLQ    2,DL
         2 000326   200006 756100                    STQ     N,,AUTO

     1967     7104    1      J=F$DCB.DCBNAME.X;

   7104  2 000327   100140 236100                    LDQ     96,,PR1
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:356  
         2 000330   000041 772000                    QRL     33
         2 000331   200005 756100                    STQ     J,,AUTO

     1968     7105    1      IF J~=0 OR N<=0 THEN GOTO FILLOPL;

   7105  2 000332   000431 601000 2                  TNZ     FILLOPL
         2 000333   200006 235100                    LDA     N,,AUTO
         2 000334   000431 604400 2                  TMOZ    FILLOPL

     1969     7106    1      FPT$=ADDR(F$DCB.DCBNAME.N);

   7106  2 000335   000000 471500                    LDP1    0,,PR0
         2 000336   200010 451500                    STP1    N+2,,AUTO
         2 000337   200010 236100                    LDQ     N+2,,AUTO
         2 000340   000014 036000 3                  ADLQ    12
         2 000341   200004 756100                    STQ     FPT$,,AUTO

     1970     7107    2      IF SNAME.S='M$' THEN DO J=4 TO F_NUMOPS;

   7107  2 000342   200004 471500                    LDP1    FPT$,,AUTO
         2 000343   040000 106500                    CMPC    fill='040'O
         2 000344   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2
         2 000345   000141 000002 0                  ADSC9   FMM$SDCB+96              cn=0,n=2
         2 000346   000366 601000 2                  TNZ     s:7113

   7107  2 000347   000004 235007                    LDA     4,DL
         2 000350   200005 755100                    STA     J,,AUTO

     1971     7108    2         IF SNAME.OP=F_OPLBL(J) THEN GOTO FILLOPL;

   7108  2 000351   200005 235100                    LDA     J,,AUTO
         2 000352   000001 735000                    ALS     1
         2 000353   200004 470500                    LDP0    FPT$,,AUTO
         2 000354   200006 720100                    LXL0    N,,AUTO
         2 000355   040005 106540                    CMPC    fill='040'O
         2 000356   000000 400010                    ADSC9   0,,PR0                   cn=2,n=*X0
         2 000357   000000 000002 xsym               ADSC9   F_OPLBL,A                cn=0,n=2
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:357  
         2 000360   000431 600000 2                  TZE     FILLOPL

     1972     7109    2         END;

   7109  2 000361   200005 236100                    LDQ     J,,AUTO
         2 000362   000001 036007                    ADLQ    1,DL
         2 000363   200005 756100                    STQ     J,,AUTO
         2 000364   000021 116007                    CMPQ    17,DL
         2 000365   000351 602000 2                  TNC     s:7108

     1973     7110                    /*
     1974     7111                    *  NEXT SEARCH FOR FORTRAN DCBS (101 THRU 108)
     1975     7112                    */
     1976     7113    2      IF SNAME.S='F$' THEN DO;

   7113  2 000366   200004 470500                    LDP0    FPT$,,AUTO
         2 000367   040000 106500                    CMPC    fill='040'O
         2 000370   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         2 000371   000142 000002 0                  ADSC9   FMM$SDCB+97              cn=0,n=2
         2 000372   000430 601000 2                  TNZ     s:7122

     1977     7114    3         DO J=0 TO F_NUMSPS;

   7114  2 000373   200005 450100                    STZ     J,,AUTO

     1978     7115    4            IF SNAME.OP=F_OPSPS(J) OR J=0 THEN DO;

   7115  2 000374   200005 236100                    LDQ     J,,AUTO
         2 000375   000003 402007                    MPY     3,DL
         2 000376   200004 470500                    LDP0    FPT$,,AUTO
         2 000377   200006 720100                    LXL0    N,,AUTO
         2 000400   040006 106540                    CMPC    fill='040'O
         2 000401   000000 400010                    ADSC9   0,,PR0                   cn=2,n=*X0
         2 000402   000000 000003 xsym               ADSC9   F_OPSPS,Q                cn=0,n=3
         2 000403   000406 600000 2                  TZE     s:7116
         2 000404   200005 235100                    LDA     J,,AUTO
         2 000405   000422 601000 2                  TNZ     s:7119
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:358  

     1979     7116    4               F$DCB.FUN=F_OPSPFUN(FEXTX);

   7116  2 000406   200003 471500                    LDP1    @JDCB$,,AUTO
         2 000407   100000 473500                    LDP3    0,,PR1
         2 000410   200005 235100                    LDA     J,,AUTO
         2 000411   000100 100405                    MLR     fill='000'O
         2 000412   000000 000001 xsym               ADSC9   F_OPSPFUN,A              cn=0,n=1
         2 000413   300032 200001                    ADSC9   26,,PR3                  cn=1,n=1

     1980     7117    4               F$DCB.RES=F_OPLRES(F_OPSPRX(FEXTX));

   7117  2 000414   100000 473500                    LDP3    0,,PR1
         2 000415   000000 235005 xsym               LDA     F_OPSPRX,AL
         2 000416   000001 735000                    ALS     1
         2 000417   040100 100405                    MLR     fill='040'O
         2 000420   000000 000002 xsym               ADSC9   F_OPLRES,A               cn=0,n=2
         2 000421   300026 000004                    ADSC9   22,,PR3                  cn=0,n=4

     1981     7118    4               END;

     1982     7119    3            END;

   7119  2 000422   200005 235100                    LDA     J,,AUTO
         2 000423   000001 035007                    ADLA    1,DL
         2 000424   200005 755100                    STA     J,,AUTO
         2 000425   000014 115007                    CMPA    12,DL
         2 000426   000374 602000 2                  TNC     s:7115

     1983     7120    2         GOTO FILLSPS;

   7120  2 000427   000451 710000 2                  TRA     FILLSPS

     1984     7121    2         END;
     1985     7122    1      J=0;

   7122  2 000430   200005 450100                    STZ     J,,AUTO
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:359  

     1986     7123                    /*
     1987     7124                    *  SPECIAL OP LABEL DCB ('M$C' THRU 'M$GO')
     1988     7125                    */
     1989     7126    1   FILLOPL:
     1990     7127    1      F$DCB.FUN=F_OPLFUN(FEXTX);

   7127  2 000431   200003 470500       FILLOPL      LDP0    @JDCB$,,AUTO
         2 000432   000000 471500                    LDP1    0,,PR0
         2 000433   200005 235100                    LDA     J,,AUTO
         2 000434   000100 100405                    MLR     fill='000'O
         2 000435   000000 000001 xsym               ADSC9   F_OPLFUN,A               cn=0,n=1
         2 000436   100032 200001                    ADSC9   26,,PR1                  cn=1,n=1

     1991     7128    1      F$DCB.RES=F_OPLRES(F_OPLRX(FEXTX));

   7128  2 000437   000000 471500                    LDP1    0,,PR0
         2 000440   000000 235005 xsym               LDA     F_OPLRX,AL
         2 000441   000001 735000                    ALS     1
         2 000442   040100 100405                    MLR     fill='040'O
         2 000443   000000 000002 xsym               ADSC9   F_OPLRES,A               cn=0,n=2
         2 000444   100026 000004                    ADSC9   22,,PR1                  cn=0,n=4

     1992     7129    1      F$DCB.FEXTX=J;

   7129  2 000445   000000 471500                    LDP1    0,,PR0
         2 000446   200005 236100                    LDQ     J,,AUTO
         2 000447   000011 736000                    QLS     9
         2 000450   100034 552110                    STBQ    28,'10'O,PR1

   7129  2 000451                       FILLSPS      null
     1993     7130                    /*
     1994     7131                    *  NOW SPECIAL CASE M$GO OP LABEL
     1995     7132                    */
     1996     7133    1   FILLSPS:;
     1997     7134    2      IF FEXTX=3 THEN DO; /* GO IS THIRD ON COMMAND LINE */

PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:360  
   7134  2 000451   200005 235100                    LDA     J,,AUTO
         2 000452   000003 115007                    CMPA    3,DL
         2 000453   000464 601000 2                  TNZ     s:7138

     1998     7135    2         F$DCB.ASN=%FILE#;

   7135  2 000454   200003 470500                    LDP0    @JDCB$,,AUTO
         2 000455   000000 471500                    LDP1    0,,PR0
         2 000456   001000 236007                    LDQ     512,DL
         2 000457   100032 552110                    STBQ    26,'10'O,PR1

     1999     7136    2         ADDR(F$DCB.NAME)->CHAR32=STARGC;

   7136  2 000460   000000 471500                    LDP1    0,,PR0
         2 000461   040100 100400                    MLR     fill='040'O
         2 000462   000000 000003 0                  ADSC9   STARG                    cn=0,n=3
         2 000463   100010 000040                    ADSC9   8,,PR1                   cn=0,n=32

     2000     7137    2         END;

     2001     7138    1      RETURN;

   7138  2 000464   000000 702200 xent               TSX2  ! X66_ARET

STARG
 Sect OctLoc
   0     000   002052 107***                                                    .*G.

FMM$SDCB
 Sect OctLoc
   0     001   000000 000000   000000 000000   000000 000000   000000 000501    ................
   0     005   000000 000000   000000 000000   000000 006014   000000 006014    ................
   0     011   001040 040040   040040 040040   040040 040040   040040 040040    .
   0     015   040040 040040   040040 040040   040040 040040   040040 040040
   0     025*  040040 040040   040040 040040   115105 040040   040040 040040            ME
   0     031   040040 040040   000000 203015   000000 003000   000000 000000        ............
   0     035   000000 000000   000000 000000   000000 000000   000002 776003    ................
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:361  
   0     041   001000 000000   000000 000002   000000 000000   000000 000000    ................
   0     045   000000 000111   040040 040040   000000 006014   000000 006014    ...I    ........
   0     051   000000 006014   000000 000000   000000 000000   000000 006014    ................
   0     055   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     061   000000 010000   000000 000000   000000 000000   000000 000000    ................
   0     065   000000 000020   000000 000000   000000 006014   000000 000000    ................
   0     071   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     075   000000 000000   000000 006014   000000 000000   000000 000000    ................
   0     101   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     105   ****** ******   ****** ******   000000 000000   ****** ******    ................
   0     111   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     125*  000000 000000   000000 000000   000000 000000   ****** ******    ................
   0     135*  ****** ******   ****** ******   ****** ******   000000 070707    ..............8.

(unnamed)
 Sect OctLoc
   0     141   115044 040040   106044 040040                                    M$  F$

(unnamed)
 Sect OctLoc
   3     000   000012 006000   000000 000052   000001 006000   000000 000047    .......*.......'
   3     004   000003 006000   000000 000024   000005 006000   000000 000022    ................
   3     010   000007 006000   000001 006000   000116 006000   737777 777777    .........N......
   3     014   000140 200000                                                    .`..
     2002     7139    1   END FMM$SCRUB;

PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:362  
--  Include file information  --

   F_DCB_D.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   FM_FIELD_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   FM_OPLBL_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  is referenced.
      No diagnostics issued in procedure FMM$SCRUB.
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:363  

 **** Variables and constants ****

  ****  Section 000 RoData FMM$SCRUB

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/w STRC(3456)  r     1 FMM$SDCB                   0-0-0/c STRC(27)    r     1 STARG
     0-0-0/c CHAR(3)     r     1 STARGC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @JDCB$                     5-0-0/w UBIN        r     1 FEXTX
     4-0-0/w PTR         r     1 FPT$                       5-0-0/w UBIN        r     1 J
    *0-0-0/w PTR         r     1 JDCB$                      6-0-0/w SBIN        r     1 N

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$ROSEG$                   0-0-0/c CHAR(2)     r     1 F_OPLBL(0:8191)
     0-0-0/b UBIN(9)     r     1 F_OPLFUN(0:8191)
     0-0-0/c CHAR(2)     r     1 F_OPLRES(0:6)
     0-0-0/w UBIN        r     1 F_OPLRX(0:8191)            0-0-0/b UBIN(9)     r     1 F_OPSPFUN(0:8191)
     0-0-0/w UBIN        r     1 F_OPSPRX(0:8191)           0-0-0/c CHAR(3)     r     1 F_OPSPS(0:8191)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(32)    r     1 CHAR32                     0-0-0/w STRC(1404)  r     1 CODE16
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(4572)  r     1 FITALTKEYS
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:364  
     0-0-0/w STRC(72)    r     1 FM$FIELD_START             0-0-0/d STRC(45)    r     1 IRREC
     0-0-0/w STRC(81)    r     1 KFIELD                     0-0-0/c ASTR(0)     r     1 MOVEJB
     0-0-0/d STRC(54)    r     1 RECFIELD                   0-0-0/c ASTR(18)    r     1 SNAME
     0-0-0/d STRC(612)   r     1 VLP$FPRG                   0-0-0/w STRC(1512)  r     1 VLP$HDRF
     0-0-0/w STRC(432)   r     1 VLP$SETSTA                 0-0-0/w STRC(288)   r     1 VLP$STATION
     0-0-0/w STRC(288)   r     1 VLP$TAB


   Procedure FMM$SCRUB requires 309 words for executable code.
   Procedure FMM$SCRUB requires 10 words of local(AUTO) storage.

    No errors detected in file FMM$OPN.:E05TSI    .
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:365  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:366  
          MINI XREF LISTING

B$ROSEG$
        46**DCL      7056>>ASSIGN   7062>>ASSIGN   7067>>ASSIGN   7073>>ASSIGN   7079>>ASSIGN   7085>>ASSIGN
CHAR32
        38**DCL      7136<<ASSIGN
CODE16
      6139**DCL      7052--CALL
F$DCB.ACTPOS
       125**DCL       125--REDEF
F$DCB.ALTKEYX
       123**DCL      7055>>IF       7056>>ASSIGN   7059<<ASSIGN
F$DCB.ARS
       100**DCL       100--REDEF
F$DCB.ASN
       115**DCL      7135<<ASSIGN
F$DCB.ATTR
       118**DCL       119--REDEF
F$DCB.BORROW
       133**DCL       133--REDEF     133--REDEF     133--REDEF
F$DCB.DCBNAME.L
       147**DCL       147--IMP-SIZ  7103>>ASSIGN
F$DCB.DCBNAME.N
       147**DCL      7106--ASSIGN
F$DCB.DCBNAME.S
       146**DCL      7095<<ASSIGN
F$DCB.DCBNAME.X
       146**DCL      7104>>ASSIGN
F$DCB.EOMCHAR
       104**DCL       104--REDEF
F$DCB.FEXTX
       116**DCL      7129<<ASSIGN
F$DCB.FIELDX
       124**DCL      7072>>IF       7073>>ASSIGN   7076<<ASSIGN
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:367  
F$DCB.FLDID
       128**DCL       128--REDEF
F$DCB.FORM$
       122**DCL       122--REDEF    7051>>IF       7052<>CALL
F$DCB.FPRGX
       124**DCL      7061>>IF       7062>>ASSIGN   7064<<ASSIGN
F$DCB.FSECT
       138**DCL       138--REDEF
F$DCB.FSN
       115**DCL       115--REDEF     115--REDEF     116--REDEF
F$DCB.FUN
       114**DCL      7116<<ASSIGN   7127<<ASSIGN
F$DCB.HEADER$
       121**DCL       121--REDEF    7049>>IF       7050<>CALL
F$DCB.IRRECX
       128**DCL      7084>>IF       7085>>ASSIGN   7088<<ASSIGN
F$DCB.IXTNSIZE
       119**DCL       119--REDEF
F$DCB.KFIELDX
       125**DCL      7066>>IF       7067>>ASSIGN   7070<<ASSIGN
F$DCB.LASTSTA$
       109**DCL       109--REDEF    7053>>IF       7054<>CALL
F$DCB.LVL
       134**DCL       134--REDEF
F$DCB.NAME
       109**DCL      7136--ASSIGN
F$DCB.NAME.C
       109**DCL       109--REDEF
F$DCB.NAME.L
       109**DCL      7096<<ASSIGN
F$DCB.NOEOF
       130**DCL       130--REDEF
F$DCB.NRECS
       120**DCL       120--REDEF
F$DCB.NRECX
       139**DCL       139--REDEF
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:368  
F$DCB.OHDR
       131**DCL       131--REDEF
F$DCB.ORG
       114**DCL       114--REDEF
F$DCB.PRECNO
       137**DCL       137--REDEF
F$DCB.RCSZ
       142**DCL       142--REDEF
F$DCB.RES
       110**DCL       110--REDEF    7117<<ASSIGN   7128<<ASSIGN
F$DCB.SETX
       122**DCL       122--REDEF
F$DCB.STARTX
       125**DCL      7078>>IF       7079>>ASSIGN   7082<<ASSIGN
F$DCB.TAB$
       121**DCL       122--REDEF    7047>>IF       7048<>CALL
F$DCB.TDA
       136**DCL       136--REDEF
F$DCB.WSN
       111**DCL       111--REDEF
FEXTX
        21**DCL      7116>>ASSIGN   7117>>ASSIGN   7127>>ASSIGN   7128>>ASSIGN   7134>>IF
FILLOPL
      7127**LABEL    7105--GOTO     7108--GOTO
FILLSPS
      7129**LABEL    7120--GOTO
FITALTKEYS.NUMWRDS
      6336**DCL      7057>>ASSIGN
FM$FIELD_START.NWORDS
      6327**DCL      7080>>ASSIGN
FMM$SDCB
      6970**DCL      7093--ASSIGN   7094>>ASSIGN
FMM$SDCB.ACTPOS
      7011**DCL      7011--REDEF
FMM$SDCB.ARS#
      6970**DCL      6970--REDEF
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:369  
FMM$SDCB.ATTR#
      7000**DCL      7000--REDEF    7002--REDEF
FMM$SDCB.BFR
      7038**DCL      7093--ASSIGN
FMM$SDCB.BORROW
      7022**DCL      7022--REDEF    7022--REDEF    7022--REDEF
FMM$SDCB.EOMCHAR#
      6977**DCL      6978--REDEF
FMM$SDCB.FLDID
      7014**DCL      7015--REDEF
FMM$SDCB.FORM$
      7006**DCL      7006--REDEF
FMM$SDCB.FSECT
      7029**DCL      7029--REDEF
FMM$SDCB.FSN#
      6996**DCL      6996--REDEF    6996--REDEF    6997--REDEF
FMM$SDCB.HEADER$
      7005**DCL      7006--REDEF
FMM$SDCB.IXTNSIZE#
      7002**DCL      7003--REDEF
FMM$SDCB.LASTSTA$
      6986**DCL      6986--REDEF
FMM$SDCB.LVL
      7023**DCL      7023--REDEF
FMM$SDCB.NAME#.C
      6986**DCL      6987--REDEF
FMM$SDCB.NOEOF
      7018**DCL      7018--REDEF
FMM$SDCB.NRECS#
      7003**DCL      7003--REDEF
FMM$SDCB.NRECX
      7030**DCL      7030--REDEF
FMM$SDCB.OHDR
      7019**DCL      7019--REDEF
FMM$SDCB.ORG#
      6994**DCL      6995--REDEF
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:370  
FMM$SDCB.PRECNO
      7027**DCL      7027--REDEF
FMM$SDCB.RCSZ
      7035**DCL      7035--REDEF
FMM$SDCB.RES#
      6988**DCL      6988--REDEF
FMM$SDCB.SETX
      7007**DCL      7007--REDEF
FMM$SDCB.TAB$
      7006**DCL      7006--REDEF
FMM$SDCB.TDA
      7026**DCL      7027--REDEF
FMM$SDCB.WSN#
      6988**DCL      6989--REDEF
FPT$
        19**DCL        28--IMP-PTR  6336--IMP-PTR  7056<<ASSIGN   7057>>ASSIGN   7058<>CALL     7062<<ASSIGN
      7063<>CALL     7067<<ASSIGN   7068>>ASSIGN   7069<>CALL     7073<<ASSIGN   7074>>ASSIGN   7075<>CALL
      7079<<ASSIGN   7080>>ASSIGN   7081<>CALL     7085<<ASSIGN   7086>>ASSIGN   7087<>CALL     7106<<ASSIGN
      7107>>IF       7108>>IF       7113>>IF       7115>>IF
FSA$FSP
        42**DCL-ENT  7048--CALL     7050--CALL     7052--CALL     7054--CALL     7058--CALL     7063--CALL
      7069--CALL     7075--CALL     7081--CALL     7087--CALL
F_OPLBL
      5717**DCL      7108>>IF
F_OPLFUN
      5717**DCL      7127>>ASSIGN
F_OPLRES
      5718**DCL      7117>>ASSIGN   7128>>ASSIGN
F_OPLRX
      5717**DCL      7128>>ASSIGN
F_OPSPFUN
      5720**DCL      7116>>ASSIGN
F_OPSPRX
      5720**DCL      7117>>ASSIGN
F_OPSPS
      5720**DCL      7115>>IF
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:371  
IRREC.NFIELDS#
      6307**DCL      7086>>ASSIGN
J
        20**DCL        21--REDEF      26--IMP-SIZ    27--IMP-SIZ  7057<<ASSIGN   7058<>CALL     7068<<ASSIGN
      7069<>CALL     7074<<ASSIGN   7075<>CALL     7080<<ASSIGN   7081<>CALL     7086<<ASSIGN   7087<>CALL
      7093<<ASSIGN   7094>>ASSIGN   7104<<ASSIGN   7105>>IF       7107<<DOINDEX  7108>>IF       7114<<DOINDEX
      7115>>IF       7115>>IF       7122<<ASSIGN   7129>>ASSIGN
JDCB$
        15**DCL        11--PROC      100--IMP-PTR  7047>>IF       7048>>CALL     7049>>IF       7050>>CALL
      7051>>IF       7052>>CALL     7053>>IF       7054>>CALL     7055>>IF       7056>>ASSIGN   7059>>ASSIGN
      7061>>IF       7062>>ASSIGN   7064>>ASSIGN   7066>>IF       7067>>ASSIGN   7070>>ASSIGN   7072>>IF
      7073>>ASSIGN   7076>>ASSIGN   7078>>IF       7079>>ASSIGN   7082>>ASSIGN   7084>>IF       7085>>ASSIGN
      7088>>ASSIGN   7091--ENTRY    7094>>ASSIGN   7095>>ASSIGN   7096>>ASSIGN   7103>>ASSIGN   7104>>ASSIGN
      7106>>ASSIGN   7116>>ASSIGN   7117>>ASSIGN   7127>>ASSIGN   7128>>ASSIGN   7129>>ASSIGN   7135>>ASSIGN
      7136>>ASSIGN
KFIELD.NWORDS
      6311**DCL      7068>>ASSIGN
MOVEJB
        27**DCL      7094<<ASSIGN
N
        22**DCL        30--IMP-SIZ  7103<<ASSIGN   7105>>IF       7108>>IF       7115>>IF
RECFIELD.FIELD
      6272**DCL      6272--REDEF
RECFIELD.NFIELDS#
      6264**DCL      7074>>ASSIGN
SNAME.OP
        30**DCL      7108>>IF       7115>>IF
SNAME.S
        29**DCL      7107>>IF       7113>>IF
STARG
        34**DCL        37--REDEF
STARGC
        37**DCL      7136>>ASSIGN
VLP$FPRG
      6242**DCL      7063--CALL
VLP$HDRF
PL6.E3A0      #005=FMM$SCRUB File=FMM$OPN.:E05TSI                                TUE 07/29/97 16:53 Page:372  
      6171**DCL      7050--CALL
VLP$SETSTA
      6215**DCL      7054--CALL
VLP$STATION
      6188**DCL      7054--CALL
VLP$STATION.MSGIDXT
      6198**DCL      6201--REDEF
VLP$TAB
      6157**DCL      7048--CALL
