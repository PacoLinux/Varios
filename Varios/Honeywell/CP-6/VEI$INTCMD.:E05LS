VERSION E05

PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:1    
        1        1        /*M*    VEI$INTCMD - EDIT EXECUTION ROUTINES FOR INTRA-RECORD COMMANDS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=3,CTI=3,SDI=3,MCL=10,CSI=0,ECI=0 */
        8        8        /**/
        9        9        VEI$INTCMD: PROC ALTRET;
       10       10        /**/
       11       11        /*********************************************************************/
       12       12        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
       13       13        /*********************************************************************/
       14       14        /**/
       15       15        %INCLUDE VE_SUBS_C;
       16      209        %INCLUDE VE_PERR_C;
       17      426        %INCLUDE CP_6_SUBS;
       18      966        %INCLUDE F$DCB;
       19     1015        %INCLUDE CP_6;
       20     1096        %INCLUDE B_ERRORS_C;
       21     2223        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:2    
       22     2224        /********************************************************************/
       23     2225        /*   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   */
       24     2226        /********************************************************************/
       25     2227        %FPT_PRECORD  (FPTN = CP_PREC_FPT, STCLASS = CONSTANT,
       26     2228                       DCB = M$FILE,
       27     2229                       KEY = LAST_KEY,
       28     2230                       N=0,
       29     2231                       BRK = YES,
       30     2232                       KEYS = YES,
       31     2233                       KEYR = NO);
       32     2254        %FPT_PRECORD  (FPTN = PREC_FWD_FPT, STCLASS = CONSTANT,
       33     2255                       DCB = M$FILE,
       34     2256                       KEYS = NO,
       35     2257                       BRK = YES,
       36     2258                       N = 1);
       37     2279        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:3    
       38     2280        /**********************************************************************/
       39     2281        /*   BASED DATA   BASED DATA   BASED DATA   BASED DATA   BASED DATA   */
       40     2282        /**********************************************************************/
       41     2283    1   DCL 1 CMD_CNTRLWD BASED ALIGNED,        /* CONTROL WORD FOR CMD_TBL ENTRIES   */
       42     2284    1          2 FLAGS,
       43     2285    1             3 ENDCT BIT(1) UNAL,          /* LAST ENTRY                         */
       44     2286    1             3 * BIT(17) UNAL,
       45     2287    1          2 OFFSET UBIN(9) UNAL,           /* NUM. OF WORDS TO NEXT ENTRY        */
       46     2288    1          2 CMD_CODE UBIN(9) UNAL;         /* CODE FOR THIS COMMAND              */
       47     2289    1   DCL 1 SSE$PARAM BASED ALIGNED,          /*SSE TABLE ENTRY                     */
       48     2290    1          2 FLAGS,
       49     2291    1             3 CLMNFLAG BIT(1) UNAL,                    /* IF TRUE NEXT WORD IS CLMN#
       50     2292                                                                   ELSE PTR$ */
       51     2293    1             3 NOTFLAG BIT(1) UNAL,        /* LOG. OP. IS NOT                    */
       52     2294    1             3 ANDFLAG BIT(1) UNAL,        /* LOG. OP. IS AND                    */
       53     2295    1             3 ORFLAG BIT(1) UNAL,         /* LOG. OP. IS OR                     */
       54     2296    1             3 EORFLAG BIT(1) UNAL,        /* LOG. OP. IS EOR*/
       55     2297    1             3 * BIT(13) UNAL,
       56     2298    1          2 J SBIN HALF UNAL,              /* OCCURANCE NUMBER                   */
       57     2299    1          2 PTR$ PTR UNAL;                 /* POINTER TO STRING                  */
       58     2300    1   DCL 1 STR$BUF BASED ALIGNED,
       59     2301    1          2 COUNT UBIN(9) UNAL,
       60     2302    1          2 TEXT CHAR(255) UNAL;
       61     2303    1   DCL 1 STR$PARAM BASED ALIGNED,
       62     2304    1          2 COUNT UBIN WORD UNAL,
       63     2305    1          2 STR(0:0),
       64     2306    1             3 QM BIT(1) UNAL,
       65     2307    1             3 * BIT(17) UNAL,
       66     2308    1             3 QMCOUNT UBIN HALF UNAL,
       67     2309    1             3 PTR$ PTR UNAL;
       68     2310        /**/
       69     2311    1   DCL 1 STR_CMD_TBL BASED ALIGNED,        /* AEOFPS COMMANDS                    */
       70     2312    1          2 * BIT(36) UNAL,
       71     2313    1          2 SSE_PARAM,
       72     2314    1             3 FLAGS,
       73     2315    1                4 CLMNFLAG BIT(1) UNAL,
       74     2316    1                4 NOTFLAG BIT(1) UNAL,
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:4    
       75     2317    1                4 ANDFLAG BIT(1) UNAL,
       76     2318    1                4 ORFLAG BIT(1) UNAL,
       77     2319    1                4 EORFLAG BIT(1) UNAL,
       78     2320    1                4 * BIT(13) UNAL,
       79     2321    1             3 J SBIN HALF UNAL,
       80     2322    1             3 PTR$ PTR UNAL,
       81     2323    1          2 SSE_PARAM2,
       82     2324    1             3 FLAGS,
       83     2325    1                4 CLMNFLAG BIT(1) UNAL,
       84     2326    1                4 NOTFLAG BIT(1) UNAL,
       85     2327    1                4 ANDFLAG BIT(1) UNAL,
       86     2328    1                4 ORFLAG BIT(1) UNAL,
       87     2329    1                4 EORFLAG BIT(1) UNAL,
       88     2330    1                4 * BIT(13) UNAL,
       89     2331    1             3 J SBIN HALF UNAL,
       90     2332    1             3 PTR$ PTR UNAL;
       91     2333    1   DCL 1 D_CMD_TBL BASED ALIGNED,          /* D COMMAND                          */
       92     2334    1          2 * BIT(36) UNAL,
       93     2335    1          2 SSE_PARAM,
       94     2336    1             3 FLAGS,
       95     2337    1                4 CLMNFLAG BIT(1) UNAL,
       96     2338    1                4 NOTFLAG BIT(1) UNAL,
       97     2339    1                4 ANDFLAG BIT(1) UNAL,
       98     2340    1                4 ORFLAG BIT(1) UNAL,
       99     2341    1                4 EORFLAG BIT(1) UNAL,
      100     2342    1                4 * BIT(13) UNAL,
      101     2343    1             3 J SBIN HALF UNAL,
      102     2344    1             3 PTR$ PTR UNAL;
      103     2345    1   DCL 1 RL_CMD_TBL BASED ALIGNED,         /* R,L COMMANDS                       */
      104     2346    1          2 * BIT(36) UNAL,
      105     2347    1          2 SSE_PARAM,
      106     2348    1             3 FLAGS,
      107     2349    1                4 CLMNFLAG BIT(1) UNAL,
      108     2350    1                4 NOTFLAG BIT(1) UNAL,
      109     2351    1                4 ANDFLAG BIT(1) UNAL,
      110     2352    1                4 ORFLAG BIT(1) UNAL,
      111     2353    1                4 EORFLAG BIT(1) UNAL,
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:5    
      112     2354    1                4 * BIT(13) UNAL,
      113     2355    1             3 J SBIN HALF UNAL,
      114     2356    1             3 PTR$ PTR UNAL,
      115     2357    1          2 SHIFT# UBIN(36) UNAL;
      116     2358    1   DCL 1 JU_CMD_TBL BASED ALIGNED,         /* JU COMMAND                         */
      117     2359    1          2 * BIT(36) UNAL,
      118     2360    1          2 HELPKEY CHAR(64) UNAL ,
      119     2361    1          2 EDITKEY REDEF HELPKEY ,
      120     2362    1             3 SEQNUM UBIN WORD UNAL ,
      121     2363    1             3 * CHAR(60) UNAL ;
      122     2364    1   DCL 1 IF_CMD_TBL BASED ALIGNED,
      123     2365    1          2 * BIT(36) UNAL,
      124     2366    1          2 LO_CLMN UBIN WORD UNAL,
      125     2367    1          2 HI_CLMN UBIN WORD UNAL,
      126     2368    1          2 SSE(0:0),
      127     2369    1             3 FLAGS,
      128     2370    1                4 CLMNFLAG BIT(1) UNAL,
      129     2371    1                4 NOTFLAG BIT(1) UNAL,
      130     2372    1                4 ANDFLAG BIT(1) UNAL,
      131     2373    1                4 ORFLAG BIT(1) UNAL,
      132     2374    1                4 EORFLAG BIT(1) UNAL,
      133     2375    1                4 * BIT(13) UNAL,
      134     2376    1             3 J SBIN HALF UNAL,
      135     2377    1             3 PTR$ PTR UNAL;
      136     2378    1   DCL 1 CP_CMD_TBL BASED ALIGNED,         /* CP and CI commands.                */
      137     2379    1          2 * BIT(36) UNAL,
      138     2380    1          2 SEQNUM UBIN WORD UNAL ,
      139     2381    1          2 LIMIT_SEQNUM UBIN WORD UNAL ,
      140     2382    1          2 INCR UBIN WORD UNAL ;
      141     2383        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:6    
      142     2384        /***********************************************************************/
      143     2385        /*    ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   */
      144     2386        /**********************************************************************/
      145     2387    1   DCL VEX$READ_SEQUEN ENTRY ALTRET;       /* GET NEXT RECORD                    */
      146     2388    1   DCL VEX$READ_RANDOM ENTRY(1) ALTRET;
      147     2389    1   DCL VEX$FIND_MATCH ENTRY(4) ALTRET;
      148     2390    1   DCL VEX$WRITE_REC ENTRY(2) ALTRET;
      149     2391    1   DCL VEX$DELREC ENTRY(3) ALTRET;
      150     2392    1   DCL VEX$ERROR ENTRY(2) ALTRET;
      151     2393    1   DCL VEX$ERRNEXT ENTRY ALTRET;
      152     2394    1   DCL VEX$ERRMAX ENTRY ALTRET;
      153     2395    1   DCL VEX$TYPE_REC ENTRY(1);
      154     2396    1   DCL VEX$FIELD_LEFT ENTRY(3);
      155     2397    1   DCL VEX$MOVE_LEFT ENTRY(2);
      156     2398    1   DCL VEX$COMP_RIGHT ENTRY(2);
      157     2399    1   DCL VEX$MOVE_RIGHT ENTRY(2);
      158     2400    1   DCL VEX$FIND_CLMN ENTRY(2) ALTRET;
      159     2401    1   DCL VEX$SEQNUM_TEXT ENTRY(2);
      160     2402    1   DCL VEX$SET_SUB_BUF ENTRY(2);
      161     2403    1   DCL VEX$SET_PROMPT ENTRY(1);
      162     2404    1   DCL VEX$BREAK ENTRY ASYNC;
      163     2405    1   DCL VEX$BREAKMK ENTRY ASYNC;
      164     2406    1   DCL VEX$MAKE_STRING ENTRY(3);
      165     2407        /********************************************************************/
      166     2408        /*   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   */
      167     2409        /********************************************************************/
      168     2410        /**/
      169     2411    1   DCL M$FILE DCB;                         /* READ EDIT FILE                     */
      170     2412        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:7    
      171     2413        /*****************************************************************/
      172     2414        /*   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   */
      173     2415        /*****************************************************************/
      174     2416        /**/
      175     2417        %INCLUDE VE_FLAGS_R;
      176     2468        /**/
      177     2469    1   DCL REC_BUF CHAR(PC_RECSIZE#) SYMREF;
      178     2470    1   DCL CMD_BUF CHAR(256) SYMREF;
      179     2471    1   DCL 1 TYPE_BUF SYMREF,
      180     2472    1          2 VFC CHAR(1) CALIGNED,
      181     2473    1          2 TEXT CHAR(PC_DISPRECSIZE#) CALIGNED;
      182     2474    1   DCL 1 SUB_BUF_1 SYMREF,
      183     2475    1          2 COUNT UBIN(9) CALIGNED,
      184     2476    1          2 TEXT CHAR(31) CALIGNED;
      185     2477    1   DCL 1 SUB_BUF_2 SYMREF,
      186     2478    1          2 COUNT UBIN(9) CALIGNED,
      187     2479    1          2 TEXT CHAR(31) CALIGNED;
      188     2480    1   DCL 1 STR_BUF SYMREF,
      189     2481    1          2 COUNT UBIN HALF HALIGNED,
      190     2482    1          2 TEXT CHAR(PC_RECSIZE#) CALIGNED;
      191     2483    1   DCL SEQ_TEXT_BUF CHAR(9)  SYMREF;
      192     2484    1   DCL REC_SIZE UBIN(36) SYMREF;           /* CHARACTER COUNT OF REC_BUF         */
      193     2485    1   DCL LO_SRCH_CLMN UBIN(36) SYMREF;       /* LOW LIMIT OF SEARCH RANGE          */
      194     2486    1   DCL HI_SRCH_CLMN UBIN(36) SYMREF;       /* HIGH LIMIT OF SEARCH RANGE         */
      195     2487    1   DCL LO_EXEC_CLMN UBIN(36) SYMREF;       /* LOW LIMIT OF CHANGEABLE RANGE      */
      196     2488    1   DCL HI_EXEC_CLMN UBIN(36) SYMREF;       /* HIGH LIMIT OF CHANGEABLE RANGE     */
      197     2489    1   DCL LO_SEQNUM UBIN(36) SYMREF ;         /* LOW LIMIT OF RECORD RANGE          */
      198     2490    1   DCL HI_SEQNUM UBIN(36) SYMREF ;         /* HIGH LIMIT OF RECORD RANGE         */
      199     2491    1   DCL EXEC_SEQNUM UBIN(36) SYMREF;        /* CURRENT RECORD BEING USED          */
      200     2492    1   DCL LIMIT_SEQNUM UBIN(36) SYMREF;       /* TEMP FOR SEARCHING RANGES          */
      201     2493    1   DCL CP_SEQNUM UBIN WORD SYMREF;         /* CP,CI BASE                         */
      202     2494    1   DCL CP_LIMIT_SEQNUM UBIN WORD SYMREF;   /* CP LIMIT                           */
      203     2495    1   DCL CP_DFLT_INCR UBIN WORD SYMREF;      /* CP,CI INCR                         */
      204     2496    1   DCL CP_RECSMVED UBIN WORD SYMREF;       /* RECORDS MOVED BY CI,CP             */
      205     2497    1   DCL INCR UBIN(36) SYMREF;               /* INCREMENT                          */
      206     2498    1   DCL DFLT_INCR UBIN(36) SYMREF ;
      207     2499    1   DCL LAST_KEY UBIN(36) SYMREF;           /* KEY OF LAST RECORD READ            */
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:8    
      208     2500    1   DCL READ_KEY UBIN(36) SYMREF;           /* KEY TO BE USED TO READ RECORD      */
      209     2501    1   DCL SAVE_KEY UBIN(36) SYMREF;           /* SAVE KEY IN MD                     */
      210     2502    1   DCL MATCH_CLMN UBIN(36) SYMREF;         /* COLUMN OF START OF STRING          */
      211     2503    1   DCL TEMP_CLMN UBIN(36) SYMREF;          /* TEMP CELL FOR COLUMN NUM.          */
      212     2504    1   DCL TEMP_COUNT UBIN(36) SYMREF;
      213     2505    1   DCL TEMP_STRCHG_COUNT UBIN(36) SYMREF ;
      214     2506    1   DCL STR1_CLMN UBIN(36) SYMREF;          /* START OF FIRST INTRA STRING        */
      215     2507    1   DCL STR2_CLMN UBIN(36) SYMREF;          /* START OF SECOND INTRA STRING       */
      216     2508    1   DCL CMD_CODE UBIN(36) SYMREF;           /* CODE FOR CURRENT COMMAND           */
      217     2509    1   DCL LAST_CMD UBIN(36) SYMREF;           /* SAVED CMD FOR ?? COMMAND           */
      218     2510    1   DCL LAST_TYPE_CMD UBIN(36) SYMREF;      /* FORMAT FOR LF - UPARROW            */
      219     2511    1   DCL REC_COUNT UBIN(36) SYMREF;          /* COUNT OF RECORDS OPERATED ON       */
      220     2512    1   DCL STRCHG_COUNT UBIN(36) SYMREF;       /* COUNT OF STRINGS CHANGED           */
      221     2513    1   DCL DELREC_COUNT UBIN(36) SYMREF;       /* INTRARECORD RECORDS DELETED        */
      222     2514    1   DCL IF_LEVEL UBIN WORD SYMREF;          /* IF PROCESSING                      */
      223     2515    1   DCL TEMP_IF_LEVEL UBIN WORD SYMREF;     /* TEMP IF PROCESSING                 */
      224     2516    1   DCL I UBIN(36) SYMREF;                  /* INDEX                              */
      225     2517    1   DCL M$FILE_NUM UBIN(36) SYMREF ;
      226     2518    1   DCL M$FILE2_NUM UBIN(36) SYMREF ;
      227     2519        /**/
      228     2520    1   DCL P$ PTR SYMREF;                      /* TEMP PTR                           */
      229     2521    1   DCL CMD$ PTR SYMREF;
      230     2522    1   DCL CMD_BASE$ PTR SYMREF;
      231     2523    1   DCL STR_TEXT$ PTR SYMREF;               /* POINTS TO NEXT TEXT STRING AREA    */
      232     2524    1   DCL STR_TEXT_HEAD$ PTR SYMREF;          /* START OF TEXT SEGMENT              */
      233     2525    1   DCL STR_TEXT_SE$ PTR SYMREF;            /* END OF 'SE' STRINGS IN SEGMENT     */
      234     2526    1   DCL 1 SSE_PARAM SYMREF,                 /* STRING SELECTION PARAM             */
      235     2527    1          2 FLAGS,
      236     2528    1             3 CLMNFLAG BIT(1) UNAL,
      237     2529    1             3 NOTFLAG BIT(1) UNAL,
      238     2530    1             3 ANDFLAG BIT(1) UNAL,
      239     2531    1             3 ORFLAG BIT(1) UNAL,
      240     2532    1             3 EORFLAG BIT(1) UNAL,
      241     2533    1             3 * BIT(13) UNAL,
      242     2534    1          2 J SBIN HALF UNAL,
      243     2535    1          2 PTR$ PTR UNAL;
      244     2536    1   DCL MAX_SEQNUM UBIN(36) SYMREF ;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:9    
      245     2537    1   DCL MAX_CLMN UBIN(36) SYMREF ;
      246     2538    1   DCL FILE_TYP UBIN WORD SYMREF ;
      247     2539        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:10   
      248     2540        /*****************************************************************/
      249     2541        /*   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO       */
      250     2542        /*****************************************************************/
      251     2543        /**/
      252     2544    1   DCL BLANK_REC BIT(1) ;
      253     2545        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:11   
      254     2546        /*****************************************************************************/
      255     2547        /*   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   */
      256     2548        /*****************************************************************************/
      257     2549        /**/
      258     2550    1   VEI$EXEC_A: ENTRY ALTRET;
      259     2551        /**/
      260     2552    1        P$ = PINCRW(CMD$,1);
      261     2553    1        CALL VEX$FIND_CLMN(P$,STR1_CLMN) ALTRET(EXEC_A_RET);
      262     2554    1        TEMP_CLMN = 0;
      263     2555    2        IF NOT(P$ -> SSE$PARAM.FLAGS.CLMNFLAG) THEN DO;
      264     2556    3           DO I = 0 TO P$ -> SSE$PARAM.PTR$ -> STR$PARAM.COUNT - 1;
      265     2557    3              TEMP_CLMN = TEMP_CLMN + P$ -> SSE$PARAM.PTR$ ->
      266     2558    3                 STR$PARAM.STR.PTR$(I) -> STR$BUF.COUNT;
      267     2559    3              END;
      268     2560    2           END;
      269     2561    1        P$ = PINCRW(P$,2);
      270     2562    1        CALL VEX$FIND_CLMN(P$,STR2_CLMN) ALTRET(EXEC_A_RET);
      271     2563        /**/
      272     2564    2        IF (STR1_CLMN > STR2_CLMN) THEN DO; /* MOVE LEFT                      */
      273     2565    2           TEMP_COUNT = STR1_CLMN - STR2_CLMN; /* AMOUNT TO SHIFT             */
      274     2566    2           IF (FLAGS.BPFLAG) THEN CALL VEX$MOVE_LEFT(STR1_CLMN,TEMP_COUNT);
      275     2567    2           ELSE CALL VEX$FIELD_LEFT(STR1_CLMN,TEMP_COUNT,TEMP_CLMN);
      276     2568    2           END;
      277     2569    2        ELSE IF (STR1_CLMN < STR2_CLMN) THEN DO; /* MOVE TO RIGHT             */
      278     2570    2              TEMP_COUNT = STR2_CLMN - STR1_CLMN;
      279     2571    2              IF (FLAGS.BPFLAG) THEN CALL VEX$MOVE_RIGHT(STR1_CLMN,TEMP_COUNT);
      280     2572    2              ELSE CALL VEX$COMP_RIGHT(STR1_CLMN,TEMP_COUNT);
      281     2573    2              END;
      282     2574    1        FLAGS.TXFLAG = TRUE;               /* RECORD CHANGED                     */
      283     2575    1        STRCHG_COUNT = STRCHG_COUNT + 1;
      284     2576    1   EXEC_A_RET:
      285     2577    1        RETURN;
      286     2578        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:12   
      287     2579        /**/
      288     2580    1   VEI$EXEC_CP: ENTRY ALTRET;
      289     2581        /**/
      290     2582    1        CP_DFLT_INCR = CMD$ -> CP_CMD_TBL.INCR ;
      291     2583    1        IF (CMD$ -> CP_CMD_TBL.SEQNUM = 0)
      292     2584    1        THEN CP_SEQNUM = CP_SEQNUM + CP_DFLT_INCR ;
      293     2585    1        ELSE CP_SEQNUM = CMD$ -> CP_CMD_TBL.SEQNUM + CP_DFLT_INCR ;
      294     2586    1        CP_LIMIT_SEQNUM = CMD$ -> CP_CMD_TBL.LIMIT_SEQNUM ;
      295     2587        /**/
      296     2588    2        IF (CP_SEQNUM > MAX_SEQNUM) THEN DO;
      297     2589    2           CALL VEX$ERROR(E$E_MAXSEQ,1);
      298     2590    2           CP_LIMIT_SEQNUM = 0;
      299     2591    2           ALTRETURN;
      300     2592    2           END;
      301     2593        /**/
      302     2594        /*E*    ERROR: VEE-E$E_MAXSEQ-0
      303     2595                DESCRIPTION: MAXIMUM SEQUENCE NUMBER EXCEEDED BY CP OR CI */
      304     2596        /**/
      305     2597    2        IF (CP_SEQNUM >= CP_LIMIT_SEQNUM) THEN DO;
      306     2598    2           CALL VEX$SEQNUM_TEXT(CP_LIMIT_SEQNUM,SUB_BUF_1);
      307     2599    2           CALL VEX$SEQNUM_TEXT(LAST_KEY,SUB_BUF_2);
      308     2600    2           CALL VEX$ERROR(E$E_CPLIMIT,3);
      309     2601    2           CP_LIMIT_SEQNUM = 0;
      310     2602    2           ALTRETURN;
      311     2603    2           END;
      312     2604        /**/
      313     2605        /*E*    ERROR: VEE-E$E_CPLIMIT-0
      314     2606                MESSAGE: Record exists in copy destination at %U1; source seq# is %U2.
      315     2607                DESCRIPTION: CP LIMIT HIT       */
      316     2608        /**/
      317     2609    1        CALL VEX$WRITE_REC(M$FILE_NUM,CP_SEQNUM) ALTRET (EXEC_CP_ERR);
      318     2610    1        CALL M$PRECORD(CP_PREC_FPT) ALTRET(EXEC_CP_ERR);
      319     2611    1        CALL M$PRECORD(PREC_FWD_FPT) ALTRET(EXEC_CP_ERR);
      320     2612    1        CP_RECSMVED = CP_RECSMVED + 1;
      321     2613    1        CMD$ -> CP_CMD_TBL.SEQNUM = CP_SEQNUM ;
      322     2614    1        CMD$ -> CP_CMD_TBL.INCR = CP_DFLT_INCR ;
      323     2615    1        RETURN;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:13   
      324     2616        /**/
      325     2617    1   EXEC_CP_ERR:
      326     2618    1        CP_LIMIT_SEQNUM = 0;
      327     2619    1        ALTRETURN;
      328     2620        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:14   
      329     2621        /**/
      330     2622    1   VEI$EXEC_D: ENTRY ALTRET;
      331     2623        /**/
      332     2624    1        IF REC_SIZE = 1 AND REC_BUF = ' '
      333     2625    1        THEN
      334     2626    1           BLANK_REC = TRUE ;
      335     2627    1        ELSE
      336     2628    1           BLANK_REC = FALSE ;
      337     2629    1        P$ = PINCRW(CMD$,1);
      338     2630    1        TEMP_STRCHG_COUNT = 0 ;
      339     2631    1        CALL VEX$FIND_CLMN(P$,STR1_CLMN) ALTRET(EXEC_D_RET);
      340     2632    1        SSE_PARAM = CMD$ -> STR_CMD_TBL.SSE_PARAM;
      341     2633    1   EXEC_D_QM:
      342     2634    1        TEMP_COUNT = 0;
      343     2635    2        DO I = 0 TO SSE_PARAM.PTR$ -> STR$PARAM.COUNT - 1;
      344     2636    2           TEMP_COUNT = TEMP_COUNT + SSE_PARAM.PTR$ ->
      345     2637    2              STR$PARAM.STR.PTR$(I) -> STR$BUF.COUNT;
      346     2638    2           END;
      347     2639        /**/
      348     2640    1   EXEC_D_1:
      349     2641    1        IF (FLAGS.BPFLAG) THEN CALL VEX$MOVE_LEFT(STR1_CLMN+TEMP_COUNT,TEMP_COUNT);
      350     2642    1        ELSE CALL VEX$FIELD_LEFT(STR1_CLMN + TEMP_COUNT,TEMP_COUNT,0);
      351     2643    1        IF (SUBSTR(SSE_PARAM.PTR$->STR$PARAM.STR.PTR$(0)->STR$BUF.TEXT,
      352     2644    1           0,SSE_PARAM.PTR$ -> STR$PARAM.STR.PTR$(0) -> STR$BUF.COUNT)
      353     2645    1           = ' ' ) AND BLANK_REC
      354     2646    1        THEN
      355     2647    1           FLAGS.TXFLAG = FALSE ;          /* Record not necessarily changed. */
      356     2648    1        ELSE
      357     2649    2        DO ;
      358     2650                                                    /*
      359     2651                                                      Record Changed.
      360     2652                                                    */
      361     2653    2           FLAGS.TXFLAG = TRUE ;
      362     2654    2           STRCHG_COUNT = STRCHG_COUNT + 1 ;
      363     2655    2           TEMP_STRCHG_COUNT = TEMP_STRCHG_COUNT + 1 ;
      364     2656    2           END ;                           /* Else Do */
      365     2657        /**/
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:15   
      366     2658    2        IF ((~SSE_PARAM.FLAGS.CLMNFLAG)AND(SSE_PARAM.J = 0)) THEN DO;
      367     2659        /**/
      368     2660    2           IF (SSE_PARAM.PTR$ -> STR$PARAM.COUNT = 1) THEN /* CHECK FOR '0/ /D' */
      369     2661    2              IF (SUBSTR(SSE_PARAM.PTR$ -> STR$PARAM.STR.PTR$(0) -> STR$BUF.TEXT,0,
      370     2662    3                 SSE_PARAM.PTR$ -> STR$PARAM.STR.PTR$(0) -> STR$BUF.COUNT) = ' ') THEN
              2662                          DO;
      371     2663    3                 IF NOT(FLAGS.BPFLAG) THEN RETURN; /* GET OUT IF BP OFF       */
      372     2664    3                 IF (SUBSTR(REC_BUF,STR1_CLMN,(SIZEC(REC_BUF)-STR1_CLMN)) = ' ')
      373     2665    3                 THEN RETURN;              /* MAKE SURE DONE                     */
      374     2666    3                 END;
      375     2667        /**/
      376     2668    2           CALL VEX$FIND_MATCH(P$,STR1_CLMN,HI_EXEC_CLMN,STR1_CLMN)
      377     2669    2              ALTRET (EXEC_D_RET);
      378     2670    2           IF STR1_CLMN + TEMP_STRCHG_COUNT > HI_EXEC_CLMN
      379     2671    2           THEN RETURN ;
      380     2672    3           DO I = 0 TO SSE_PARAM.PTR$ -> STR$PARAM.COUNT - 1 ;
      381     2673    3              IF (SSE_PARAM.PTR$ -> STR$PARAM.STR.QM(I) = '1'B)
      382     2674    3              THEN GOTO EXEC_D_QM ;
      383     2675    3              END ;                        /* DO I */
      384     2676    2           GOTO EXEC_D_1 ;
      385     2677    2           END;
      386     2678        /**/
      387     2679    1   EXEC_D_RET:
      388     2680    1        RETURN;
      389     2681        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:16   
      390     2682        /**/
      391     2683    1   VEI$EXEC_E: ENTRY ALTRET;
      392     2684        /**/
      393     2685    1        P$ = PINCRW(CMD$,1);
      394     2686    1        SSE_PARAM = CMD$ -> STR_CMD_TBL.SSE_PARAM;
      395     2687    1        CALL VEX$FIND_CLMN(P$,STR1_CLMN) ALTRET(EXEC_E_RET);
      396     2688        /**/
      397     2689    1   EXEC_E_1:
      398     2690    1        CALL VEX$MAKE_STRING(STR_BUF,CMD$ -> STR_CMD_TBL.SSE_PARAM2.PTR$ -> STR$PARAM,
      399     2691    1           CMD$ -> STR_CMD_TBL.SSE_PARAM);
      400     2692    2        IF (STR_BUF.COUNT + STR1_CLMN > MAX_CLMN) THEN DO;
      401     2693    2           CALL VEX$ERROR(E$E_OVERFLOW,2); /* OVERFLOW                        */
      402     2694    2           STR_BUF.COUNT = MAX_CLMN - STR1_CLMN;
      403     2695    2           END;
      404     2696        /**/
      405     2697        /*E*     ERROR:    VEE-E$E_OVERFLOW-0
      406     2698                 DESCRIPTION: Characters lost durring E/O operation.
      407     2699        */
      408     2700    1        CALL INSERT(REC_BUF,STR1_CLMN,STR_BUF.COUNT,STR_BUF.TEXT);
      409     2701        /**/
      410     2702    1        IF (REC_SIZE < STR1_CLMN + STR_BUF.COUNT) THEN
      411     2703    1           REC_SIZE = STR1_CLMN + STR_BUF.COUNT;
      412     2704        /**/
      413     2705    1        FLAGS.TXFLAG = TRUE;               /* RECORD CHANGED                     */
      414     2706    1        STRCHG_COUNT = STRCHG_COUNT + 1;
      415     2707    1        STR1_CLMN = STR1_CLMN + STR_BUF.COUNT; /* SKIP TO END OF TEXT         */
      416     2708    2        IF (CMD_CODE = ECMD) THEN DO;      /* E COMMAND                          */
      417     2709    2           IF (STR1_CLMN <= HI_EXEC_CLMN) THEN
      418     2710    2              CALL INSERT(REC_BUF,STR1_CLMN,HI_EXEC_CLMN-STR1_CLMN+1,' ');
      419     2711    2           RETURN;
      420     2712    2           END;
      421     2713        /**/
      422     2714    2        IF ((~SSE_PARAM.FLAGS.CLMNFLAG) AND (SSE_PARAM.J = 0)) THEN DO;
      423     2715    2           CALL VEX$FIND_MATCH(P$,STR1_CLMN,HI_EXEC_CLMN,STR1_CLMN)
      424     2716    2              ALTRET (EXEC_E_RET);
      425     2717    2           GOTO EXEC_E_1;
      426     2718    2           END;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:17   
      427     2719        /**/
      428     2720    1   EXEC_E_RET:
      429     2721    1        RETURN;
      430     2722        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:18   
      431     2723        /**/
      432     2724    1   VEI$EXEC_EI: ENTRY ALTRET;
      433     2725        /**/
      434     2726    1        RETURN;
      435     2727        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:19   
      436     2728        /**/
      437     2729    1   VEI$EXEC_EL: ENTRY ALTRET;
      438     2730        /**/
      439     2731    1        TEMP_IF_LEVEL = IF_LEVEL ;
      440     2732        /**/
      441     2733    2        DO WHILE ((TEMP_IF_LEVEL ~= IF_LEVEL) OR
      442     2734    2           (CMD$ -> CMD_CNTRLWD.CMD_CODE ~= EICMD)) ;
      443     2735    2           IF (PINCRW(CMD$,CMD$ -> CMD_CNTRLWD.OFFSET) ->
      444     2736    2              CMD_CNTRLWD.FLAGS.ENDCT = TRUE) THEN RETURN;
      445     2737    2           IF (CMD$ -> CMD_CNTRLWD.CMD_CODE = IFCMD)
      446     2738    2           THEN TEMP_IF_LEVEL = TEMP_IF_LEVEL + 1 ;
      447     2739    2           IF (CMD$ -> CMD_CNTRLWD.CMD_CODE = EICMD)
      448     2740    2           THEN TEMP_IF_LEVEL = TEMP_IF_LEVEL - 1 ;
      449     2741    2           CMD$ = PINCRW(CMD$,CMD$ -> CMD_CNTRLWD.OFFSET);
      450     2742    2           END;
      451     2743    1        RETURN;
      452     2744        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:20   
      453     2745        /**/
      454     2746    1   VEI$EXEC_F: ENTRY ALTRET;
      455     2747        /**/
      456     2748    1        P$ = PINCRW(CMD$,1);
      457     2749    1        SSE_PARAM = CMD$ -> STR_CMD_TBL.SSE_PARAM;
      458     2750    1        CALL VEX$FIND_CLMN(P$,STR1_CLMN) ALTRET(EXEC_F_RET);
      459     2751        /**/
      460     2752    1   EXEC_F_1:
      461     2753    1        CALL VEX$MAKE_STRING(STR_BUF,CMD$ -> STR_CMD_TBL.SSE_PARAM2.PTR$ -> STR$PARAM,
      462     2754    1           CMD$ -> STR_CMD_TBL.SSE_PARAM);
      463     2755    1        IF (SSE_PARAM.FLAGS.CLMNFLAG) THEN STR1_CLMN = STR1_CLMN+1;
      464     2756    2        ELSE DO I = 0 TO SSE_PARAM.PTR$ -> STR$PARAM.COUNT - 1;
      465     2757    2           STR1_CLMN = STR1_CLMN + SSE_PARAM.PTR$ ->
      466     2758    2              STR$PARAM.STR.PTR$(I) -> STR$BUF.COUNT;
      467     2759    2           END;
      468     2760    2        IF (STR1_CLMN + STR_BUF.COUNT > MAX_CLMN) THEN DO;
      469     2761    2           CALL VEX$ERROR(E$E_OVERFLOW,2); /* OVERFLOW                        */
      470     2762    2           STR_BUF.COUNT = MAX_CLMN - STR1_CLMN;
      471     2763    2           END;
      472     2764        /**/
      473     2765        /*E*     ERROR:    VEE-E$E_OVERFLOW-0
      474     2766                 DESCRIPTION: Characters lost durring F operation.
      475     2767        */
      476     2768    1        TEMP_COUNT = STR_BUF.COUNT;
      477     2769    1        IF TEMP_COUNT = 0 AND SSE_PARAM.J = 0
      478     2770    1        THEN                               /* Moving Null string many times. */
      479     2771    1           GOTO EXEC_F_RET ;
      480     2772    1        IF (FLAGS.BPFLAG) THEN CALL VEX$MOVE_RIGHT(STR1_CLMN,TEMP_COUNT);
      481     2773    1        ELSE CALL VEX$COMP_RIGHT(STR1_CLMN,TEMP_COUNT);
      482     2774    1        CALL INSERT(REC_BUF,STR1_CLMN,STR_BUF.COUNT,STR_BUF.TEXT);
      483     2775    1        FLAGS.TXFLAG = TRUE;
      484     2776    1        STRCHG_COUNT = STRCHG_COUNT + 1;
      485     2777    2        IF ((~SSE_PARAM.FLAGS.CLMNFLAG) AND (SSE_PARAM.J = 0)) THEN DO;
      486     2778    2           STR1_CLMN = STR1_CLMN + STR_BUF.COUNT;
      487     2779    2           CALL VEX$FIND_MATCH(P$,STR1_CLMN,HI_EXEC_CLMN,STR1_CLMN)
      488     2780    2              ALTRET (EXEC_F_RET);
      489     2781    2           GOTO EXEC_F_1;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:21   
      490     2782    2           END;
      491     2783        /**/
      492     2784    1   EXEC_F_RET:
      493     2785    1        RETURN;
      494     2786        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:22   
      495     2787        /**/
      496     2788    1   VEI$EXEC_JU: ENTRY ALTRET;
      497     2789        /**/
      498     2790    2        IF (FLAGS.TXFLAG) THEN DO;         /* WRITE TO FILE                      */
      499     2791    2           FLAGS.TXFLAG = FALSE;
      500     2792    2           CALL VEX$WRITE_REC(M$FILE_NUM,LAST_KEY);
      501     2793    2           END;
      502     2794        /**/
      503     2795    1        EXEC_SEQNUM = CMD$ -> JU_CMD_TBL.EDITKEY.SEQNUM -1;
      504     2796                                                /* Set so next read gets right record */
      505     2797    1        CALL VEX$READ_RANDOM(EXEC_SEQNUM) ALTRET(EXEC_JU_ERR);
      506     2798    1        RETURN;
      507     2799        /**/
      508     2800    1   EXEC_JU_ERR:
      509     2801    1        RETURN;
      510     2802        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:23   
      511     2803        /**/
      512     2804    1   VEI$EXEC_L: ENTRY ALTRET;
      513     2805        /**/
      514     2806    1        IF REC_SIZE = 1 AND REC_BUF = ' '
      515     2807    1        THEN GOTO EXEC_L_RET ;             /* NO MORE TO SHIFT LEFT              */
      516     2808    1        P$ = PINCRW(CMD$,1);
      517     2809    1        TEMP_COUNT = CMD$ -> RL_CMD_TBL.SHIFT#;
      518     2810    1        CALL VEX$FIND_CLMN(P$,STR1_CLMN) ALTRET(EXEC_L_RET);
      519     2811    1        TEMP_CLMN = 0;
      520     2812    2        IF NOT(P$ -> SSE$PARAM.FLAGS.CLMNFLAG) THEN DO;
      521     2813    3           DO I = 0 TO P$ -> SSE$PARAM.PTR$ -> STR$PARAM.COUNT - 1;
      522     2814    3              TEMP_CLMN = TEMP_CLMN + P$ -> SSE$PARAM.PTR$ ->
      523     2815    3                 STR$PARAM.STR.PTR$(I) -> STR$BUF.COUNT;
      524     2816    3              END;
      525     2817    2           END;
      526     2818        /**/
      527     2819    1        IF (FLAGS.BPFLAG) THEN CALL VEX$MOVE_LEFT(STR1_CLMN,TEMP_COUNT);
      528     2820    1        ELSE CALL VEX$FIELD_LEFT(STR1_CLMN,TEMP_COUNT,TEMP_CLMN);
      529     2821    1        FLAGS.TXFLAG = TRUE;               /* RECORD CHANGED                     */
      530     2822    1        STRCHG_COUNT = STRCHG_COUNT + 1;
      531     2823        /**/
      532     2824    1   EXEC_L_RET:
      533     2825    1        RETURN;
      534     2826        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:24   
      535     2827        /**/
      536     2828    1   VEI$EXEC_NO: ENTRY ALTRET;
      537     2829        /**/
      538     2830    1        FLAGS.NOFLAG = TRUE;
      539     2831    1        RETURN;
      540     2832        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:25   
      541     2833        /**/
      542     2834    1   VEI$EXEC_P: ENTRY ALTRET;
      543     2835        /**/
      544     2836    1        P$ = PINCRW(CMD$,1);
      545     2837    1        SSE_PARAM = CMD$ -> STR_CMD_TBL.SSE_PARAM;
      546     2838    1        CALL VEX$FIND_CLMN(P$,STR1_CLMN) ALTRET(EXEC_P_RET);
      547     2839        /**/
      548     2840    1   EXEC_P_1:
      549     2841    1        CALL VEX$MAKE_STRING(STR_BUF,CMD$ -> STR_CMD_TBL.SSE_PARAM2.PTR$ -> STR$PARAM,
      550     2842    1           CMD$ -> STR_CMD_TBL.SSE_PARAM);
      551     2843    1        TEMP_COUNT = STR_BUF.COUNT;
      552     2844    1        IF (FLAGS.BPFLAG) THEN CALL VEX$MOVE_RIGHT(STR1_CLMN,TEMP_COUNT);
      553     2845    1        ELSE CALL VEX$COMP_RIGHT(STR1_CLMN,TEMP_COUNT);
      554     2846        /**/
      555     2847    2        IF (STR1_CLMN + STR_BUF.COUNT > MAX_CLMN) THEN DO;
      556     2848    2           CALL VEX$ERROR(E$E_OVERFLOW,2); /* OVERFLOW                        */
      557     2849    2           STR_BUF.COUNT = MAX_CLMN - STR1_CLMN;
      558     2850    2           END;
      559     2851        /**/
      560     2852        /*E*     ERROR:    VEE-E$E_OVERFLOW-0
      561     2853                 DESCRIPTION: Characters lost durring P operation.
      562     2854        */
      563     2855        /**/
      564     2856    1        CALL INSERT(REC_BUF,STR1_CLMN,STR_BUF.COUNT,STR_BUF.TEXT);
      565     2857    1        FLAGS.TXFLAG = TRUE;               /* RECORD CHANGED                     */
      566     2858    1        STRCHG_COUNT = STRCHG_COUNT + 1;
      567     2859        /**/
      568     2860    2        IF ((~SSE_PARAM.FLAGS.CLMNFLAG) AND (SSE_PARAM.J = 0)) THEN DO;
      569     2861    2           STR1_CLMN = STR1_CLMN + STR_BUF.COUNT;
      570     2862    3           DO I = 0 TO SSE_PARAM.PTR$ -> STR$PARAM.COUNT - 1;
      571     2863    3              STR1_CLMN = STR1_CLMN + SSE_PARAM.PTR$ ->
      572     2864    3                 STR$PARAM.STR.PTR$(I) -> STR$BUF.COUNT;
      573     2865    3              END;
      574     2866    2           CALL VEX$FIND_MATCH(P$,STR1_CLMN,HI_EXEC_CLMN,STR1_CLMN)
      575     2867    2              ALTRET (EXEC_P_RET);
      576     2868    2           GOTO EXEC_P_1;
      577     2869    2           END;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:26   
      578     2870        /**/
      579     2871    1   EXEC_P_RET:
      580     2872    1        RETURN;
      581     2873        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:27   
      582     2874        /**/
      583     2875    1   VEI$EXEC_QR: ENTRY ALTRET;
      584     2876        /**/
      585     2877    1        P$ = PINCRW(CMD$,CMD$ -> CMD_CNTRLWD.OFFSET);
      586     2878    2        DO WHILE (P$ -> CMD_CNTRLWD.FLAGS.ENDCT = FALSE);
      587     2879    2           CMD$ = P$;
      588     2880    2           P$ = PINCRW(CMD$,CMD$ -> CMD_CNTRLWD.OFFSET);
      589     2881    2           END;
      590     2882    1        RETURN;
      591     2883        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:28   
      592     2884        /**/
      593     2885    1   VEI$EXEC_R: ENTRY ALTRET;
      594     2886        /**/
      595     2887    1        P$ = PINCRW(CMD$,1);
      596     2888    1        TEMP_COUNT = CMD$ -> RL_CMD_TBL.SHIFT#;
      597     2889    1        CALL VEX$FIND_CLMN(P$,STR1_CLMN) ALTRET(EXEC_R_RET);
      598     2890        /**/
      599     2891    1        IF (FLAGS.BPFLAG) THEN CALL VEX$MOVE_RIGHT(STR1_CLMN,TEMP_COUNT);
      600     2892    1        ELSE CALL VEX$COMP_RIGHT(STR1_CLMN,TEMP_COUNT);
      601     2893    1        FLAGS.TXFLAG = TRUE;               /* RECORD CHANGED                     */
      602     2894    1        STRCHG_COUNT = STRCHG_COUNT + 1;
      603     2895        /**/
      604     2896    1   EXEC_R_RET:
      605     2897    1        RETURN;
      606     2898        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:29   
      607     2899        /**/
      608     2900    1   VEI$EXEC_RF: ENTRY ALTRET;
      609     2901        /**/
      610     2902    1        IF (~FLAGS.RFFLAG) THEN            /* Only save BP on the first RFCMD */
      611     2903    1           FLAGS.BPFLAG_SAV = FLAGS.BPFLAG ;
      612     2904    1        FLAGS.RFFLAG = TRUE;
      613     2905    1        IF (FLAGS.BPFLAG) THEN FLAGS.BPFLAG = FALSE;
      614     2906    1        ELSE FLAGS.BPFLAG = TRUE;
      615     2907    1        RETURN;
      616     2908        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:30   
      617     2909        /**/
      618     2910    1   VEI$EXEC_RL: ENTRY ALTRET;
      619     2911        /**/
      620     2912    2        IF (FLAGS.TXFLAG) THEN DO;
      621     2913    2           FLAGS.TXFLAG = FALSE;
      622     2914    2           FLAGS.RLFLAG = TRUE;
      623     2915    2           CMD$ = CMD_BASE$;
      624     2916    2           CMD_CODE = CMD$ -> CMD_CNTRLWD.CMD_CODE;
      625     2917    2           ALTRETURN;
      626     2918    2           END;
      627     2919    1        RETURN;
      628     2920        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:31   
      629     2921        /**/
      630     2922    1   VEI$EXEC_S: ENTRY ALTRET;
      631     2923        /**/
      632     2924    1        P$ = PINCRW(CMD$,1);
      633     2925    1        CALL VEX$FIND_CLMN(P$,STR1_CLMN) ALTRET(EXEC_S_RET);
      634     2926    1        SSE_PARAM = CMD$ -> STR_CMD_TBL.SSE_PARAM;
      635     2927        /**/
      636     2928    1   EXEC_S_1:
      637     2929    1        CALL VEX$MAKE_STRING(STR_BUF,CMD$ -> STR_CMD_TBL.SSE_PARAM2.PTR$ -> STR$PARAM,
      638     2930    1           CMD$ -> STR_CMD_TBL.SSE_PARAM);
      639     2931    1        TEMP_COUNT = 0;
      640     2932    2        DO I = 0 TO SSE_PARAM.PTR$ -> STR$PARAM.COUNT - 1;
      641     2933    2           TEMP_COUNT = TEMP_COUNT + SSE_PARAM.PTR$ ->
      642     2934    2              STR$PARAM.STR.PTR$(I) -> STR$BUF.COUNT;
      643     2935    2           END;
      644     2936    2        IF (TEMP_COUNT >= STR_BUF.COUNT) THEN DO; /* NEW STRING SMALLER       */
      645     2937    2           CALL INSERT(REC_BUF,STR1_CLMN,STR_BUF.COUNT,STR_BUF.TEXT);
      646     2938    2           IF (FLAGS.BPFLAG) THEN CALL VEX$MOVE_LEFT(STR1_CLMN + TEMP_COUNT,
      647     2939    2                 TEMP_COUNT - STR_BUF.COUNT);
      648     2940    2           ELSE CALL VEX$FIELD_LEFT(STR1_CLMN + TEMP_COUNT,
      649     2941    2                 TEMP_COUNT - STR_BUF.COUNT,0);
      650     2942        /**/
      651     2943    2           STR1_CLMN = STR1_CLMN + STR_BUF.COUNT;
      652     2944    2           END;
      653     2945    2        ELSE DO;                           /* NEW STRING LARGER                  */
      654     2946    2           IF (FLAGS.BPFLAG) THEN CALL VEX$MOVE_RIGHT(STR1_CLMN+TEMP_COUNT,
      655     2947    2                 STR_BUF.COUNT - TEMP_COUNT );
      656     2948    2           ELSE CALL VEX$COMP_RIGHT(STR1_CLMN+TEMP_COUNT,STR_BUF.COUNT - TEMP_COUNT);
      657     2949        /**/
      658     2950    2           IF (STR1_CLMN + STR_BUF.COUNT > MAX_CLMN) THEN
      659     2951    2              STR_BUF.COUNT = MAX_CLMN - STR1_CLMN;
      660     2952    2           CALL INSERT(REC_BUF,STR1_CLMN,STR_BUF.COUNT,STR_BUF.TEXT);
      661     2953    2           STR1_CLMN = STR1_CLMN + STR_BUF.COUNT;
      662     2954    2           END;
      663     2955    1        FLAGS.TXFLAG = TRUE;               /* RECORD CHANGED                     */
      664     2956    1        STRCHG_COUNT = STRCHG_COUNT + 1;
      665     2957        /**/
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:32   
      666     2958    2        IF ((~SSE_PARAM.FLAGS.CLMNFLAG)AND(SSE_PARAM.J = 0)) THEN DO;
      667     2959        /**/
      668     2960    2           IF (SSE_PARAM.PTR$ -> STR$PARAM.COUNT = 1) THEN /* CHECK FOR '0/ /S//' */
      669     2961    2              IF (SUBSTR(SSE_PARAM.PTR$ -> STR$PARAM.STR.PTR$(0) -> STR$BUF.TEXT,0,
      670     2962    2                 SSE_PARAM.PTR$ -> STR$PARAM.STR.PTR$(0) -> STR$BUF.COUNT) = ' ')AND
      671     2963    3                 (STR_BUF.COUNT = 0) THEN DO;
      672     2964    3                 IF NOT(FLAGS.BPFLAG) THEN RETURN; /* GET OUT IF BP OFF       */
      673     2965    3                 IF (SUBSTR(REC_BUF,STR1_CLMN,(SIZEC(REC_BUF)-STR1_CLMN)) = ' ')
      674     2966    3                 THEN RETURN;              /* MAKE SURE DONE                     */
      675     2967    3                 END;
      676     2968        /**/
      677     2969    2           CALL VEX$FIND_MATCH(P$,STR1_CLMN,HI_EXEC_CLMN,STR1_CLMN)
      678     2970    2              ALTRET(EXEC_S_RET);
      679     2971    2           GOTO EXEC_S_1;
      680     2972    2           END;
      681     2973        /**/
      682     2974    1   EXEC_S_RET:
      683     2975    1        RETURN;
      684     2976        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:33   
      685     2977        /**/
      686     2978    1   VEI$EXEC_TX: ENTRY ALTRET;
      687     2979        /**/
      688     2980    1        IF (~FLAGS.TXFLAG) THEN RETURN;    /* NOTHING CHANGED                    */
      689     2981    1        CALL VEX$SEQNUM_TEXT(LAST_KEY);
      690     2982    1        CALL CONCAT(TYPE_BUF.TEXT,SEQ_TEXT_BUF,' ',SUBSTR(REC_BUF,0,REC_SIZE));
      691     2983    1        CALL VEX$TYPE_REC(TYPECR);
      692     2984    1        RETURN;
      693     2985    1   END;                                    /* END VEI$INTCMD                     */

PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:34   
--  Include file information  --

   VE_FLAGS_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   VE_PERR_C.:E05TOU  is referenced.
   VE_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VEI$INTCMD.

   Procedure VEI$INTCMD requires 1025 words for executable code.
   Procedure VEI$INTCMD requires 12 words of local(AUTO) storage.

    No errors detected in file VEI$INTCMD.:E05TSI    .

PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:35   

 Object Unit name= VEI$INTCMD                                 File name= VEI$INTCMD.:E05TOU
 UTS= JUL 30 '97 07:08:50.04 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     20     24  VEI$INTCMD
    2   DCB   even  none     0      0  M$FILE
    3   Proc  even  none  1025   2001  VEI$INTCMD
    4  RoData even  none    37     45  VEI$INTCMD

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        0  VEI$INTCMD
     3      3          yes     yes      Std        0  VEI$EXEC_A
     3    120          yes     yes      Std        0  VEI$EXEC_CP
     3    220          yes     yes      Std        0  VEI$EXEC_D
     3    440          yes     yes      Std        0  VEI$EXEC_E
     3    571          yes     yes      Std        0  VEI$EXEC_EI
     3    574          yes     yes      Std        0  VEI$EXEC_EL
     3    645          yes     yes      Std        0  VEI$EXEC_F
     3   1016          yes     yes      Std        0  VEI$EXEC_JU
     3   1043          yes     yes      Std        0  VEI$EXEC_L
     3   1135          yes     yes      Std        0  VEI$EXEC_NO
     3   1142          yes     yes      Std        0  VEI$EXEC_P
     3   1302          yes     yes      Std        0  VEI$EXEC_QR
     3   1333          yes     yes      Std        0  VEI$EXEC_R
     3   1370          yes     yes      Std        0  VEI$EXEC_RF
     3   1416          yes     yes      Std        0  VEI$EXEC_RL
     3   1437          yes     yes      Std        0  VEI$EXEC_S
     3   1747          yes     yes      Std        0  VEI$EXEC_TX
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:36   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 VEX$FIND_CLMN
         yes           Std       2 VEX$MOVE_LEFT
         yes           Std       3 VEX$FIELD_LEFT
         yes           Std       2 VEX$COMP_RIGHT
 yes     yes           Std       2 VEX$ERROR
         yes           Std       2 VEX$SEQNUM_TEXT
 yes     yes           Std       4 VEX$FIND_MATCH
 yes     yes           Std       1 VEX$READ_RANDOM
 yes     yes           Std       2 VEX$WRITE_REC
         yes           Std       3 VEX$MAKE_STRING
         yes           Std       1 VEX$TYPE_REC
         yes           Std       2 VEX$MOVE_RIGHT
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:37   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$FILE                                FLAGS
     REC_BUF                               TYPE_BUF                              SUB_BUF_1
     SUB_BUF_2                             STR_BUF                               SEQ_TEXT_BUF
     REC_SIZE                              HI_EXEC_CLMN                          EXEC_SEQNUM
     CP_SEQNUM                             CP_LIMIT_SEQNUM                       CP_DFLT_INCR
     CP_RECSMVED                           LAST_KEY                              TEMP_CLMN
     TEMP_COUNT                            TEMP_STRCHG_COUNT                     STR1_CLMN
     STR2_CLMN                             CMD_CODE                              STRCHG_COUNT
     IF_LEVEL                              TEMP_IF_LEVEL                         I
     M$FILE_NUM                            P$                                    CMD$
     CMD_BASE$                             SSE_PARAM                             MAX_SEQNUM
     MAX_CLMN                              B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:38   


        1        1        /*M*    VEI$INTCMD - EDIT EXECUTION ROUTINES FOR INTRA-RECORD COMMANDS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=3,CTI=3,SDI=3,MCL=10,CSI=0,ECI=0 */
        8        8        /**/
        9        9        VEI$INTCMD: PROC ALTRET;

      9  3 000000   000000 700200 xent  VEI$INTCMD   TSX0  ! X66_AUTO_0
         3 000001   000014 000000                    ZERO    12,0
         3 000002   000005 710000 3                  TRA     s:2552

       10       10        /**/
       11       11        /*********************************************************************/
       12       12        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
       13       13        /*********************************************************************/
       14       14        /**/
       15       15        %INCLUDE VE_SUBS_C;
       16      209        %INCLUDE VE_PERR_C;
       17      426        %INCLUDE CP_6_SUBS;
       18      966        %INCLUDE F$DCB;
       19     1015        %INCLUDE CP_6;
       20     1096        %INCLUDE B_ERRORS_C;
       21     2223        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:39   
       22     2224        /********************************************************************/
       23     2225        /*   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   */
       24     2226        /********************************************************************/
       25     2227        %FPT_PRECORD  (FPTN = CP_PREC_FPT, STCLASS = CONSTANT,
       26     2228                       DCB = M$FILE,
       27     2229                       KEY = LAST_KEY,
       28     2230                       N=0,
       29     2231                       BRK = YES,
       30     2232                       KEYS = YES,
       31     2233                       KEYR = NO);
       32     2254        %FPT_PRECORD  (FPTN = PREC_FWD_FPT, STCLASS = CONSTANT,
       33     2255                       DCB = M$FILE,
       34     2256                       KEYS = NO,
       35     2257                       BRK = YES,
       36     2258                       N = 1);
       37     2279        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:40   
       38     2280        /**********************************************************************/
       39     2281        /*   BASED DATA   BASED DATA   BASED DATA   BASED DATA   BASED DATA   */
       40     2282        /**********************************************************************/
       41     2283    1   DCL 1 CMD_CNTRLWD BASED ALIGNED,        /* CONTROL WORD FOR CMD_TBL ENTRIES   */
       42     2284    1          2 FLAGS,
       43     2285    1             3 ENDCT BIT(1) UNAL,          /* LAST ENTRY                         */
       44     2286    1             3 * BIT(17) UNAL,
       45     2287    1          2 OFFSET UBIN(9) UNAL,           /* NUM. OF WORDS TO NEXT ENTRY        */
       46     2288    1          2 CMD_CODE UBIN(9) UNAL;         /* CODE FOR THIS COMMAND              */
       47     2289    1   DCL 1 SSE$PARAM BASED ALIGNED,          /*SSE TABLE ENTRY                     */
       48     2290    1          2 FLAGS,
       49     2291    1             3 CLMNFLAG BIT(1) UNAL,                    /* IF TRUE NEXT WORD IS CLMN#
       50     2292                                                                   ELSE PTR$ */
       51     2293    1             3 NOTFLAG BIT(1) UNAL,        /* LOG. OP. IS NOT                    */
       52     2294    1             3 ANDFLAG BIT(1) UNAL,        /* LOG. OP. IS AND                    */
       53     2295    1             3 ORFLAG BIT(1) UNAL,         /* LOG. OP. IS OR                     */
       54     2296    1             3 EORFLAG BIT(1) UNAL,        /* LOG. OP. IS EOR*/
       55     2297    1             3 * BIT(13) UNAL,
       56     2298    1          2 J SBIN HALF UNAL,              /* OCCURANCE NUMBER                   */
       57     2299    1          2 PTR$ PTR UNAL;                 /* POINTER TO STRING                  */
       58     2300    1   DCL 1 STR$BUF BASED ALIGNED,
       59     2301    1          2 COUNT UBIN(9) UNAL,
       60     2302    1          2 TEXT CHAR(255) UNAL;
       61     2303    1   DCL 1 STR$PARAM BASED ALIGNED,
       62     2304    1          2 COUNT UBIN WORD UNAL,
       63     2305    1          2 STR(0:0),
       64     2306    1             3 QM BIT(1) UNAL,
       65     2307    1             3 * BIT(17) UNAL,
       66     2308    1             3 QMCOUNT UBIN HALF UNAL,
       67     2309    1             3 PTR$ PTR UNAL;
       68     2310        /**/
       69     2311    1   DCL 1 STR_CMD_TBL BASED ALIGNED,        /* AEOFPS COMMANDS                    */
       70     2312    1          2 * BIT(36) UNAL,
       71     2313    1          2 SSE_PARAM,
       72     2314    1             3 FLAGS,
       73     2315    1                4 CLMNFLAG BIT(1) UNAL,
       74     2316    1                4 NOTFLAG BIT(1) UNAL,
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:41   
       75     2317    1                4 ANDFLAG BIT(1) UNAL,
       76     2318    1                4 ORFLAG BIT(1) UNAL,
       77     2319    1                4 EORFLAG BIT(1) UNAL,
       78     2320    1                4 * BIT(13) UNAL,
       79     2321    1             3 J SBIN HALF UNAL,
       80     2322    1             3 PTR$ PTR UNAL,
       81     2323    1          2 SSE_PARAM2,
       82     2324    1             3 FLAGS,
       83     2325    1                4 CLMNFLAG BIT(1) UNAL,
       84     2326    1                4 NOTFLAG BIT(1) UNAL,
       85     2327    1                4 ANDFLAG BIT(1) UNAL,
       86     2328    1                4 ORFLAG BIT(1) UNAL,
       87     2329    1                4 EORFLAG BIT(1) UNAL,
       88     2330    1                4 * BIT(13) UNAL,
       89     2331    1             3 J SBIN HALF UNAL,
       90     2332    1             3 PTR$ PTR UNAL;
       91     2333    1   DCL 1 D_CMD_TBL BASED ALIGNED,          /* D COMMAND                          */
       92     2334    1          2 * BIT(36) UNAL,
       93     2335    1          2 SSE_PARAM,
       94     2336    1             3 FLAGS,
       95     2337    1                4 CLMNFLAG BIT(1) UNAL,
       96     2338    1                4 NOTFLAG BIT(1) UNAL,
       97     2339    1                4 ANDFLAG BIT(1) UNAL,
       98     2340    1                4 ORFLAG BIT(1) UNAL,
       99     2341    1                4 EORFLAG BIT(1) UNAL,
      100     2342    1                4 * BIT(13) UNAL,
      101     2343    1             3 J SBIN HALF UNAL,
      102     2344    1             3 PTR$ PTR UNAL;
      103     2345    1   DCL 1 RL_CMD_TBL BASED ALIGNED,         /* R,L COMMANDS                       */
      104     2346    1          2 * BIT(36) UNAL,
      105     2347    1          2 SSE_PARAM,
      106     2348    1             3 FLAGS,
      107     2349    1                4 CLMNFLAG BIT(1) UNAL,
      108     2350    1                4 NOTFLAG BIT(1) UNAL,
      109     2351    1                4 ANDFLAG BIT(1) UNAL,
      110     2352    1                4 ORFLAG BIT(1) UNAL,
      111     2353    1                4 EORFLAG BIT(1) UNAL,
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:42   
      112     2354    1                4 * BIT(13) UNAL,
      113     2355    1             3 J SBIN HALF UNAL,
      114     2356    1             3 PTR$ PTR UNAL,
      115     2357    1          2 SHIFT# UBIN(36) UNAL;
      116     2358    1   DCL 1 JU_CMD_TBL BASED ALIGNED,         /* JU COMMAND                         */
      117     2359    1          2 * BIT(36) UNAL,
      118     2360    1          2 HELPKEY CHAR(64) UNAL ,
      119     2361    1          2 EDITKEY REDEF HELPKEY ,
      120     2362    1             3 SEQNUM UBIN WORD UNAL ,
      121     2363    1             3 * CHAR(60) UNAL ;
      122     2364    1   DCL 1 IF_CMD_TBL BASED ALIGNED,
      123     2365    1          2 * BIT(36) UNAL,
      124     2366    1          2 LO_CLMN UBIN WORD UNAL,
      125     2367    1          2 HI_CLMN UBIN WORD UNAL,
      126     2368    1          2 SSE(0:0),
      127     2369    1             3 FLAGS,
      128     2370    1                4 CLMNFLAG BIT(1) UNAL,
      129     2371    1                4 NOTFLAG BIT(1) UNAL,
      130     2372    1                4 ANDFLAG BIT(1) UNAL,
      131     2373    1                4 ORFLAG BIT(1) UNAL,
      132     2374    1                4 EORFLAG BIT(1) UNAL,
      133     2375    1                4 * BIT(13) UNAL,
      134     2376    1             3 J SBIN HALF UNAL,
      135     2377    1             3 PTR$ PTR UNAL;
      136     2378    1   DCL 1 CP_CMD_TBL BASED ALIGNED,         /* CP and CI commands.                */
      137     2379    1          2 * BIT(36) UNAL,
      138     2380    1          2 SEQNUM UBIN WORD UNAL ,
      139     2381    1          2 LIMIT_SEQNUM UBIN WORD UNAL ,
      140     2382    1          2 INCR UBIN WORD UNAL ;
      141     2383        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:43   
      142     2384        /***********************************************************************/
      143     2385        /*    ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   */
      144     2386        /**********************************************************************/
      145     2387    1   DCL VEX$READ_SEQUEN ENTRY ALTRET;       /* GET NEXT RECORD                    */
      146     2388    1   DCL VEX$READ_RANDOM ENTRY(1) ALTRET;
      147     2389    1   DCL VEX$FIND_MATCH ENTRY(4) ALTRET;
      148     2390    1   DCL VEX$WRITE_REC ENTRY(2) ALTRET;
      149     2391    1   DCL VEX$DELREC ENTRY(3) ALTRET;
      150     2392    1   DCL VEX$ERROR ENTRY(2) ALTRET;
      151     2393    1   DCL VEX$ERRNEXT ENTRY ALTRET;
      152     2394    1   DCL VEX$ERRMAX ENTRY ALTRET;
      153     2395    1   DCL VEX$TYPE_REC ENTRY(1);
      154     2396    1   DCL VEX$FIELD_LEFT ENTRY(3);
      155     2397    1   DCL VEX$MOVE_LEFT ENTRY(2);
      156     2398    1   DCL VEX$COMP_RIGHT ENTRY(2);
      157     2399    1   DCL VEX$MOVE_RIGHT ENTRY(2);
      158     2400    1   DCL VEX$FIND_CLMN ENTRY(2) ALTRET;
      159     2401    1   DCL VEX$SEQNUM_TEXT ENTRY(2);
      160     2402    1   DCL VEX$SET_SUB_BUF ENTRY(2);
      161     2403    1   DCL VEX$SET_PROMPT ENTRY(1);
      162     2404    1   DCL VEX$BREAK ENTRY ASYNC;
      163     2405    1   DCL VEX$BREAKMK ENTRY ASYNC;
      164     2406    1   DCL VEX$MAKE_STRING ENTRY(3);
      165     2407        /********************************************************************/
      166     2408        /*   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   */
      167     2409        /********************************************************************/
      168     2410        /**/
      169     2411    1   DCL M$FILE DCB;                         /* READ EDIT FILE                     */
      170     2412        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:44   
      171     2413        /*****************************************************************/
      172     2414        /*   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   */
      173     2415        /*****************************************************************/
      174     2416        /**/
      175     2417        %INCLUDE VE_FLAGS_R;
      176     2468        /**/
      177     2469    1   DCL REC_BUF CHAR(PC_RECSIZE#) SYMREF;
      178     2470    1   DCL CMD_BUF CHAR(256) SYMREF;
      179     2471    1   DCL 1 TYPE_BUF SYMREF,
      180     2472    1          2 VFC CHAR(1) CALIGNED,
      181     2473    1          2 TEXT CHAR(PC_DISPRECSIZE#) CALIGNED;
      182     2474    1   DCL 1 SUB_BUF_1 SYMREF,
      183     2475    1          2 COUNT UBIN(9) CALIGNED,
      184     2476    1          2 TEXT CHAR(31) CALIGNED;
      185     2477    1   DCL 1 SUB_BUF_2 SYMREF,
      186     2478    1          2 COUNT UBIN(9) CALIGNED,
      187     2479    1          2 TEXT CHAR(31) CALIGNED;
      188     2480    1   DCL 1 STR_BUF SYMREF,
      189     2481    1          2 COUNT UBIN HALF HALIGNED,
      190     2482    1          2 TEXT CHAR(PC_RECSIZE#) CALIGNED;
      191     2483    1   DCL SEQ_TEXT_BUF CHAR(9)  SYMREF;
      192     2484    1   DCL REC_SIZE UBIN(36) SYMREF;           /* CHARACTER COUNT OF REC_BUF         */
      193     2485    1   DCL LO_SRCH_CLMN UBIN(36) SYMREF;       /* LOW LIMIT OF SEARCH RANGE          */
      194     2486    1   DCL HI_SRCH_CLMN UBIN(36) SYMREF;       /* HIGH LIMIT OF SEARCH RANGE         */
      195     2487    1   DCL LO_EXEC_CLMN UBIN(36) SYMREF;       /* LOW LIMIT OF CHANGEABLE RANGE      */
      196     2488    1   DCL HI_EXEC_CLMN UBIN(36) SYMREF;       /* HIGH LIMIT OF CHANGEABLE RANGE     */
      197     2489    1   DCL LO_SEQNUM UBIN(36) SYMREF ;         /* LOW LIMIT OF RECORD RANGE          */
      198     2490    1   DCL HI_SEQNUM UBIN(36) SYMREF ;         /* HIGH LIMIT OF RECORD RANGE         */
      199     2491    1   DCL EXEC_SEQNUM UBIN(36) SYMREF;        /* CURRENT RECORD BEING USED          */
      200     2492    1   DCL LIMIT_SEQNUM UBIN(36) SYMREF;       /* TEMP FOR SEARCHING RANGES          */
      201     2493    1   DCL CP_SEQNUM UBIN WORD SYMREF;         /* CP,CI BASE                         */
      202     2494    1   DCL CP_LIMIT_SEQNUM UBIN WORD SYMREF;   /* CP LIMIT                           */
      203     2495    1   DCL CP_DFLT_INCR UBIN WORD SYMREF;      /* CP,CI INCR                         */
      204     2496    1   DCL CP_RECSMVED UBIN WORD SYMREF;       /* RECORDS MOVED BY CI,CP             */
      205     2497    1   DCL INCR UBIN(36) SYMREF;               /* INCREMENT                          */
      206     2498    1   DCL DFLT_INCR UBIN(36) SYMREF ;
      207     2499    1   DCL LAST_KEY UBIN(36) SYMREF;           /* KEY OF LAST RECORD READ            */
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:45   
      208     2500    1   DCL READ_KEY UBIN(36) SYMREF;           /* KEY TO BE USED TO READ RECORD      */
      209     2501    1   DCL SAVE_KEY UBIN(36) SYMREF;           /* SAVE KEY IN MD                     */
      210     2502    1   DCL MATCH_CLMN UBIN(36) SYMREF;         /* COLUMN OF START OF STRING          */
      211     2503    1   DCL TEMP_CLMN UBIN(36) SYMREF;          /* TEMP CELL FOR COLUMN NUM.          */
      212     2504    1   DCL TEMP_COUNT UBIN(36) SYMREF;
      213     2505    1   DCL TEMP_STRCHG_COUNT UBIN(36) SYMREF ;
      214     2506    1   DCL STR1_CLMN UBIN(36) SYMREF;          /* START OF FIRST INTRA STRING        */
      215     2507    1   DCL STR2_CLMN UBIN(36) SYMREF;          /* START OF SECOND INTRA STRING       */
      216     2508    1   DCL CMD_CODE UBIN(36) SYMREF;           /* CODE FOR CURRENT COMMAND           */
      217     2509    1   DCL LAST_CMD UBIN(36) SYMREF;           /* SAVED CMD FOR ?? COMMAND           */
      218     2510    1   DCL LAST_TYPE_CMD UBIN(36) SYMREF;      /* FORMAT FOR LF - UPARROW            */
      219     2511    1   DCL REC_COUNT UBIN(36) SYMREF;          /* COUNT OF RECORDS OPERATED ON       */
      220     2512    1   DCL STRCHG_COUNT UBIN(36) SYMREF;       /* COUNT OF STRINGS CHANGED           */
      221     2513    1   DCL DELREC_COUNT UBIN(36) SYMREF;       /* INTRARECORD RECORDS DELETED        */
      222     2514    1   DCL IF_LEVEL UBIN WORD SYMREF;          /* IF PROCESSING                      */
      223     2515    1   DCL TEMP_IF_LEVEL UBIN WORD SYMREF;     /* TEMP IF PROCESSING                 */
      224     2516    1   DCL I UBIN(36) SYMREF;                  /* INDEX                              */
      225     2517    1   DCL M$FILE_NUM UBIN(36) SYMREF ;
      226     2518    1   DCL M$FILE2_NUM UBIN(36) SYMREF ;
      227     2519        /**/
      228     2520    1   DCL P$ PTR SYMREF;                      /* TEMP PTR                           */
      229     2521    1   DCL CMD$ PTR SYMREF;
      230     2522    1   DCL CMD_BASE$ PTR SYMREF;
      231     2523    1   DCL STR_TEXT$ PTR SYMREF;               /* POINTS TO NEXT TEXT STRING AREA    */
      232     2524    1   DCL STR_TEXT_HEAD$ PTR SYMREF;          /* START OF TEXT SEGMENT              */
      233     2525    1   DCL STR_TEXT_SE$ PTR SYMREF;            /* END OF 'SE' STRINGS IN SEGMENT     */
      234     2526    1   DCL 1 SSE_PARAM SYMREF,                 /* STRING SELECTION PARAM             */
      235     2527    1          2 FLAGS,
      236     2528    1             3 CLMNFLAG BIT(1) UNAL,
      237     2529    1             3 NOTFLAG BIT(1) UNAL,
      238     2530    1             3 ANDFLAG BIT(1) UNAL,
      239     2531    1             3 ORFLAG BIT(1) UNAL,
      240     2532    1             3 EORFLAG BIT(1) UNAL,
      241     2533    1             3 * BIT(13) UNAL,
      242     2534    1          2 J SBIN HALF UNAL,
      243     2535    1          2 PTR$ PTR UNAL;
      244     2536    1   DCL MAX_SEQNUM UBIN(36) SYMREF ;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:46   
      245     2537    1   DCL MAX_CLMN UBIN(36) SYMREF ;
      246     2538    1   DCL FILE_TYP UBIN WORD SYMREF ;
      247     2539        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:47   
      248     2540        /*****************************************************************/
      249     2541        /*   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO       */
      250     2542        /*****************************************************************/
      251     2543        /**/
      252     2544    1   DCL BLANK_REC BIT(1) ;
      253     2545        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:48   
      254     2546        /*****************************************************************************/
      255     2547        /*   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   */
      256     2548        /*****************************************************************************/
      257     2549        /**/
      258     2550    1   VEI$EXEC_A: ENTRY ALTRET;

   2550  3 000003   000000 700200 xent  VEI$EXEC_A   TSX0  ! X66_AUTO_0
         3 000004   000014 000000                    ZERO    12,0

      259     2551        /**/
      260     2552    1        P$ = PINCRW(CMD$,1);

   2552  3 000005   000000 236000 xsym               LDQ     CMD$
         3 000006   000001 036003                    ADLQ    1,DU
         3 000007   000000 756000 xsym               STQ     P$

      261     2553    1        CALL VEX$FIND_CLMN(P$,STR1_CLMN) ALTRET(EXEC_A_RET);

   2553  3 000010   000000 630400 4                  EPPR0   0
         3 000011   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000012   000000 701000 xent               TSX1    VEX$FIND_CLMN
         3 000013   000117 702000 3                  TSX2    EXEC_A_RET

      262     2554    1        TEMP_CLMN = 0;

   2554  3 000014   000000 450000 xsym               STZ     TEMP_CLMN

      263     2555    2        IF NOT(P$ -> SSE$PARAM.FLAGS.CLMNFLAG) THEN DO;

   2555  3 000015   000000 470400 xsym               LDP0    P$
         3 000016   000000 234100                    SZN     0,,PR0
         3 000017   000042 604000 3                  TMI     s:2561

      264     2556    3           DO I = 0 TO P$ -> SSE$PARAM.PTR$ -> STR$PARAM.COUNT - 1;

   2556  3 000020   000000 450000 xsym               STZ     I
         3 000021   000036 710000 3                  TRA     s:2559+3
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:49   

      265     2557    3              TEMP_CLMN = TEMP_CLMN + P$ -> SSE$PARAM.PTR$ ->

   2557  3 000022   000000 470400 xsym               LDP0    P$
         3 000023   000001 471500                    LDP1    1,,PR0
         3 000024   000000 235000 xsym               LDA     I
         3 000025   000001 735000                    ALS     1
         3 000026   100002 473505                    LDP3    2,AL,PR1
         3 000027   300000 236100                    LDQ     0,,PR3
         3 000030   000033 772000                    QRL     27
         3 000031   000000 036000 xsym               ADLQ    TEMP_CLMN
         3 000032   000000 756000 xsym               STQ     TEMP_CLMN

      266     2558    3                 STR$PARAM.STR.PTR$(I) -> STR$BUF.COUNT;
      267     2559    3              END;

   2559  3 000033   000000 235000 xsym               LDA     I
         3 000034   000001 035007                    ADLA    1,DL
         3 000035   000000 755000 xsym               STA     I
         3 000036   000001 471500                    LDP1    1,,PR0
         3 000037   000000 236000 xsym               LDQ     I
         3 000040   100000 116100                    CMPQ    0,,PR1
         3 000041   000022 602000 3                  TNC     s:2557

      268     2560    2           END;

      269     2561    1        P$ = PINCRW(P$,2);

   2561  3 000042   000000 236000 xsym               LDQ     P$
         3 000043   000002 036003                    ADLQ    2,DU
         3 000044   000000 756000 xsym               STQ     P$

      270     2562    1        CALL VEX$FIND_CLMN(P$,STR2_CLMN) ALTRET(EXEC_A_RET);

   2562  3 000045   000002 630400 4                  EPPR0   2
         3 000046   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000047   000000 701000 xent               TSX1    VEX$FIND_CLMN
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:50   
         3 000050   000117 702000 3                  TSX2    EXEC_A_RET

      271     2563        /**/
      272     2564    2        IF (STR1_CLMN > STR2_CLMN) THEN DO; /* MOVE LEFT                      */

   2564  3 000051   000000 236000 xsym               LDQ     STR2_CLMN
         3 000052   000000 116000 xsym               CMPQ    STR1_CLMN
         3 000053   000073 603000 3                  TRC     s:2569

      273     2565    2           TEMP_COUNT = STR1_CLMN - STR2_CLMN; /* AMOUNT TO SHIFT             */

   2565  3 000054   000000 236000 xsym               LDQ     STR1_CLMN
         3 000055   000000 136000 xsym               SBLQ    STR2_CLMN
         3 000056   000000 756000 xsym               STQ     TEMP_COUNT

      274     2566    2           IF (FLAGS.BPFLAG) THEN CALL VEX$MOVE_LEFT(STR1_CLMN,TEMP_COUNT);

   2566  3 000057   000000 430000 xsym               FSZN    FLAGS
         3 000060   000066 605000 3                  TPL     s:2567

   2566  3 000061   000004 630400 4                  EPPR0   4
         3 000062   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000063   000000 701000 xent               TSX1    VEX$MOVE_LEFT
         3 000064   000000 011000                    NOP     0
         3 000065   000112 710000 3                  TRA     s:2574

      275     2567    2           ELSE CALL VEX$FIELD_LEFT(STR1_CLMN,TEMP_COUNT,TEMP_CLMN);

   2567  3 000066   000006 630400 4                  EPPR0   6
         3 000067   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000070   000000 701000 xent               TSX1    VEX$FIELD_LEFT
         3 000071   000000 011000                    NOP     0

      276     2568    2           END;

   2568  3 000072   000112 710000 3                  TRA     s:2574

PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:51   
      277     2569    2        ELSE IF (STR1_CLMN < STR2_CLMN) THEN DO; /* MOVE TO RIGHT             */

   2569  3 000073   000112 602000 3                  TNC     s:2574
         3 000074   000112 600000 3                  TZE     s:2574

      278     2570    2              TEMP_COUNT = STR2_CLMN - STR1_CLMN;

   2570  3 000075   000000 136000 xsym               SBLQ    STR1_CLMN
         3 000076   000000 756000 xsym               STQ     TEMP_COUNT

      279     2571    2              IF (FLAGS.BPFLAG) THEN CALL VEX$MOVE_RIGHT(STR1_CLMN,TEMP_COUNT);

   2571  3 000077   000000 430000 xsym               FSZN    FLAGS
         3 000100   000106 605000 3                  TPL     s:2572

   2571  3 000101   000004 630400 4                  EPPR0   4
         3 000102   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000103   000000 701000 xent               TSX1    VEX$MOVE_RIGHT
         3 000104   000000 011000                    NOP     0
         3 000105   000112 710000 3                  TRA     s:2574

      280     2572    2              ELSE CALL VEX$COMP_RIGHT(STR1_CLMN,TEMP_COUNT);

   2572  3 000106   000004 630400 4                  EPPR0   4
         3 000107   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000110   000000 701000 xent               TSX1    VEX$COMP_RIGHT
         3 000111   000000 011000                    NOP     0

      281     2573    2              END;

      282     2574    1        FLAGS.TXFLAG = TRUE;               /* RECORD CHANGED                     */

   2574  3 000112   000040 236003                    LDQ     32,DU
         3 000113   000000 256000 xsym               ORSQ    FLAGS

      283     2575    1        STRCHG_COUNT = STRCHG_COUNT + 1;

PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:52   
   2575  3 000114   000000 235000 xsym               LDA     STRCHG_COUNT
         3 000115   000001 035007                    ADLA    1,DL
         3 000116   000000 755000 xsym               STA     STRCHG_COUNT

      284     2576    1   EXEC_A_RET:
      285     2577    1        RETURN;

   2577  3 000117   000000 702200 xent  EXEC_A_RET   TSX2  ! X66_ARET

      286     2578        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:53   
      287     2579        /**/
      288     2580    1   VEI$EXEC_CP: ENTRY ALTRET;

   2580  3 000120   000000 700200 xent  VEI$EXEC_CP  TSX0  ! X66_AUTO_0
         3 000121   000014 000000                    ZERO    12,0

      289     2581        /**/
      290     2582    1        CP_DFLT_INCR = CMD$ -> CP_CMD_TBL.INCR ;

   2582  3 000122   000000 470400 xsym               LDP0    CMD$
         3 000123   000003 235100                    LDA     3,,PR0
         3 000124   000000 755000 xsym               STA     CP_DFLT_INCR

      291     2583    1        IF (CMD$ -> CP_CMD_TBL.SEQNUM = 0)

   2583  3 000125   000001 235100                    LDA     1,,PR0
         3 000126   000133 601000 3                  TNZ     s:2585

      292     2584    1        THEN CP_SEQNUM = CP_SEQNUM + CP_DFLT_INCR ;

   2584  3 000127   000000 236000 xsym               LDQ     CP_SEQNUM
         3 000130   000000 036000 xsym               ADLQ    CP_DFLT_INCR
         3 000131   000000 756000 xsym               STQ     CP_SEQNUM
         3 000132   000136 710000 3                  TRA     s:2586

      293     2585    1        ELSE CP_SEQNUM = CMD$ -> CP_CMD_TBL.SEQNUM + CP_DFLT_INCR ;

   2585  3 000133   000001 236100                    LDQ     1,,PR0
         3 000134   000000 036000 xsym               ADLQ    CP_DFLT_INCR
         3 000135   000000 756000 xsym               STQ     CP_SEQNUM

      294     2586    1        CP_LIMIT_SEQNUM = CMD$ -> CP_CMD_TBL.LIMIT_SEQNUM ;

   2586  3 000136   000002 235100                    LDA     2,,PR0
         3 000137   000000 755000 xsym               STA     CP_LIMIT_SEQNUM

      295     2587        /**/
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:54   
      296     2588    2        IF (CP_SEQNUM > MAX_SEQNUM) THEN DO;

   2588  3 000140   000000 116000 xsym               CMPQ    MAX_SEQNUM
         3 000141   000151 602000 3                  TNC     s:2597
         3 000142   000151 600000 3                  TZE     s:2597

      297     2589    2           CALL VEX$ERROR(E$E_MAXSEQ,1);

   2589  3 000143   000012 630400 4                  EPPR0   10
         3 000144   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000145   000000 701000 xent               TSX1    VEX$ERROR
         3 000146   000000 011000                    NOP     0

      298     2590    2           CP_LIMIT_SEQNUM = 0;

   2590  3 000147   000000 450000 xsym               STZ     CP_LIMIT_SEQNUM

      299     2591    2           ALTRETURN;

   2591  3 000150   000000 702200 xent               TSX2  ! X66_AALT

      300     2592    2           END;
      301     2593        /**/
      302     2594        /*E*    ERROR: VEE-E$E_MAXSEQ-0
      303     2595                DESCRIPTION: MAXIMUM SEQUENCE NUMBER EXCEEDED BY CP OR CI */
      304     2596        /**/
      305     2597    2        IF (CP_SEQNUM >= CP_LIMIT_SEQNUM) THEN DO;

   2597  3 000151   000000 116000 xsym               CMPQ    CP_LIMIT_SEQNUM
         3 000152   000171 602000 3                  TNC     s:2609

      306     2598    2           CALL VEX$SEQNUM_TEXT(CP_LIMIT_SEQNUM,SUB_BUF_1);

   2598  3 000153   000014 630400 4                  EPPR0   12
         3 000154   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000155   000000 701000 xent               TSX1    VEX$SEQNUM_TEXT
         3 000156   000000 011000                    NOP     0
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:55   

      307     2599    2           CALL VEX$SEQNUM_TEXT(LAST_KEY,SUB_BUF_2);

   2599  3 000157   000016 630400 4                  EPPR0   14
         3 000160   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000161   000000 701000 xent               TSX1    VEX$SEQNUM_TEXT
         3 000162   000000 011000                    NOP     0

      308     2600    2           CALL VEX$ERROR(E$E_CPLIMIT,3);

   2600  3 000163   000021 630400 4                  EPPR0   17
         3 000164   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000165   000000 701000 xent               TSX1    VEX$ERROR
         3 000166   000000 011000                    NOP     0

      309     2601    2           CP_LIMIT_SEQNUM = 0;

   2601  3 000167   000000 450000 xsym               STZ     CP_LIMIT_SEQNUM

      310     2602    2           ALTRETURN;

   2602  3 000170   000000 702200 xent               TSX2  ! X66_AALT

      311     2603    2           END;
      312     2604        /**/
      313     2605        /*E*    ERROR: VEE-E$E_CPLIMIT-0
      314     2606                MESSAGE: Record exists in copy destination at %U1; source seq# is %U2.
      315     2607                DESCRIPTION: CP LIMIT HIT       */
      316     2608        /**/
      317     2609    1        CALL VEX$WRITE_REC(M$FILE_NUM,CP_SEQNUM) ALTRET (EXEC_CP_ERR);

   2609  3 000171   000023 630400 4                  EPPR0   19
         3 000172   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000173   000000 701000 xent               TSX1    VEX$WRITE_REC
         3 000174   000216 702000 3                  TSX2    EXEC_CP_ERR

      318     2610    1        CALL M$PRECORD(CP_PREC_FPT) ALTRET(EXEC_CP_ERR);
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:56   

   2610  3 000175   000000 630400 1                  EPPR0   CP_PREC_FPT
         3 000176   440003 713400                    CLIMB   alt,+16387
         3 000177   401000 401760                    pmme    nvectors=3
         3 000200   000216 702000 3                  TSX2    EXEC_CP_ERR

      319     2611    1        CALL M$PRECORD(PREC_FWD_FPT) ALTRET(EXEC_CP_ERR);

   2611  3 000201   000012 630400 1                  EPPR0   PREC_FWD_FPT
         3 000202   440003 713400                    CLIMB   alt,+16387
         3 000203   401000 401760                    pmme    nvectors=3
         3 000204   000216 702000 3                  TSX2    EXEC_CP_ERR

      320     2612    1        CP_RECSMVED = CP_RECSMVED + 1;

   2612  3 000205   000000 235000 xsym               LDA     CP_RECSMVED
         3 000206   000001 035007                    ADLA    1,DL
         3 000207   000000 755000 xsym               STA     CP_RECSMVED

      321     2613    1        CMD$ -> CP_CMD_TBL.SEQNUM = CP_SEQNUM ;

   2613  3 000210   000000 470400 xsym               LDP0    CMD$
         3 000211   000000 236000 xsym               LDQ     CP_SEQNUM
         3 000212   000001 756100                    STQ     1,,PR0

      322     2614    1        CMD$ -> CP_CMD_TBL.INCR = CP_DFLT_INCR ;

   2614  3 000213   000000 235000 xsym               LDA     CP_DFLT_INCR
         3 000214   000003 755100                    STA     3,,PR0

      323     2615    1        RETURN;

   2615  3 000215   000000 702200 xent               TSX2  ! X66_ARET

      324     2616        /**/
      325     2617    1   EXEC_CP_ERR:
      326     2618    1        CP_LIMIT_SEQNUM = 0;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:57   

   2618  3 000216   000000 450000 xsym  EXEC_CP_ERR  STZ     CP_LIMIT_SEQNUM

      327     2619    1        ALTRETURN;

   2619  3 000217   000000 702200 xent               TSX2  ! X66_AALT

      328     2620        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:58   
      329     2621        /**/
      330     2622    1   VEI$EXEC_D: ENTRY ALTRET;

   2622  3 000220   000000 700200 xent  VEI$EXEC_D   TSX0  ! X66_AUTO_0
         3 000221   000014 000000                    ZERO    12,0

      331     2623        /**/
      332     2624    1        IF REC_SIZE = 1 AND REC_BUF = ' '

   2624  3 000222   000000 235000 xsym               LDA     REC_SIZE
         3 000223   000001 115007                    CMPA    1,DL
         3 000224   000234 601000 3                  TNZ     s:2628
         3 000225   040000 106400                    CMPC    fill='040'O
         3 000226   000000 002000 xsym               ADSC9   REC_BUF                  cn=0,n=1024
         3 000227   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000230   000234 601000 3                  TNZ     s:2628

      333     2625    1        THEN
      334     2626    1           BLANK_REC = TRUE ;

   2626  3 000231   400000 236003                    LDQ     -131072,DU
         3 000232   200003 756100                    STQ     BLANK_REC,,AUTO
         3 000233   000235 710000 3                  TRA     s:2629

      335     2627    1        ELSE
      336     2628    1           BLANK_REC = FALSE ;

   2628  3 000234   200003 450100                    STZ     BLANK_REC,,AUTO

      337     2629    1        P$ = PINCRW(CMD$,1);

   2629  3 000235   000000 236000 xsym               LDQ     CMD$
         3 000236   000001 036003                    ADLQ    1,DU
         3 000237   000000 756000 xsym               STQ     P$

      338     2630    1        TEMP_STRCHG_COUNT = 0 ;

PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:59   
   2630  3 000240   000000 450000 xsym               STZ     TEMP_STRCHG_COUNT

      339     2631    1        CALL VEX$FIND_CLMN(P$,STR1_CLMN) ALTRET(EXEC_D_RET);

   2631  3 000241   000000 630400 4                  EPPR0   0
         3 000242   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000243   000000 701000 xent               TSX1    VEX$FIND_CLMN
         3 000244   000437 702000 3                  TSX2    EXEC_D_RET

      340     2632    1        SSE_PARAM = CMD$ -> STR_CMD_TBL.SSE_PARAM;

   2632  3 000245   000000 470400 xsym               LDP0    CMD$
         3 000246   000000 100500                    MLR     fill='000'O
         3 000247   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         3 000250   000000 000010 xsym               ADSC9   SSE_PARAM                cn=0,n=8

      341     2633    1   EXEC_D_QM:
      342     2634    1        TEMP_COUNT = 0;

   2634  3 000251   000000 450000 xsym  EXEC_D_QM    STZ     TEMP_COUNT

      343     2635    2        DO I = 0 TO SSE_PARAM.PTR$ -> STR$PARAM.COUNT - 1;

   2635  3 000252   000000 450000 xsym               STZ     I
         3 000253   000267 710000 3                  TRA     s:2638+3

      344     2636    2           TEMP_COUNT = TEMP_COUNT + SSE_PARAM.PTR$ ->

   2636  3 000254   000000 235000 xsym               LDA     I
         3 000255   000001 735000                    ALS     1
         3 000256   000001 470400 xsym               LDP0    SSE_PARAM+1
         3 000257   000002 471505                    LDP1    2,AL,PR0
         3 000260   100000 236100                    LDQ     0,,PR1
         3 000261   000033 772000                    QRL     27
         3 000262   000000 036000 xsym               ADLQ    TEMP_COUNT
         3 000263   000000 756000 xsym               STQ     TEMP_COUNT

PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:60   
      345     2637    2              STR$PARAM.STR.PTR$(I) -> STR$BUF.COUNT;
      346     2638    2           END;

   2638  3 000264   000000 235000 xsym               LDA     I
         3 000265   000001 035007                    ADLA    1,DL
         3 000266   000000 755000 xsym               STA     I
         3 000267   000001 470400 xsym               LDP0    SSE_PARAM+1
         3 000270   000000 236000 xsym               LDQ     I
         3 000271   000000 116100                    CMPQ    0,,PR0
         3 000272   000254 602000 3                  TNC     s:2636

      347     2639        /**/
      348     2640    1   EXEC_D_1:
      349     2641    1        IF (FLAGS.BPFLAG) THEN CALL VEX$MOVE_LEFT(STR1_CLMN+TEMP_COUNT,TEMP_COUNT);

   2641  3 000273   000000 430000 xsym  EXEC_D_1     FSZN    FLAGS
         3 000274   000311 605000 3                  TPL     s:2642

   2641  3 000275   000000 236000 xsym               LDQ     STR1_CLMN
         3 000276   000000 036000 xsym               ADLQ    TEMP_COUNT
         3 000277   200004 756100                    STQ     BLANK_REC+1,,AUTO
         3 000300   000005 236000 4                  LDQ     5
         3 000301   200007 756100                    STQ     BLANK_REC+4,,AUTO
         3 000302   200004 630500                    EPPR0   BLANK_REC+1,,AUTO
         3 000303   200006 450500                    STP0    BLANK_REC+3,,AUTO
         3 000304   200006 630500                    EPPR0   BLANK_REC+3,,AUTO
         3 000305   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000306   000000 701000 xent               TSX1    VEX$MOVE_LEFT
         3 000307   000000 011000                    NOP     0
         3 000310   000324 710000 3                  TRA     s:2643

      350     2642    1        ELSE CALL VEX$FIELD_LEFT(STR1_CLMN + TEMP_COUNT,TEMP_COUNT,0);

   2642  3 000311   000000 236000 xsym               LDQ     STR1_CLMN
         3 000312   000000 036000 xsym               ADLQ    TEMP_COUNT
         3 000313   200004 756100                    STQ     BLANK_REC+1,,AUTO
         3 000314   000026 237000 4                  LDAQ    22
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:61   
         3 000315   200006 757100                    STAQ    BLANK_REC+3,,AUTO
         3 000316   200004 630500                    EPPR0   BLANK_REC+1,,AUTO
         3 000317   200005 450500                    STP0    BLANK_REC+2,,AUTO
         3 000320   200005 630500                    EPPR0   BLANK_REC+2,,AUTO
         3 000321   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000322   000000 701000 xent               TSX1    VEX$FIELD_LEFT
         3 000323   000000 011000                    NOP     0

      351     2643    1        IF (SUBSTR(SSE_PARAM.PTR$->STR$PARAM.STR.PTR$(0)->STR$BUF.TEXT,

   2643  3 000324   000001 470400 xsym               LDP0    SSE_PARAM+1
         3 000325   000002 471500                    LDP1    2,,PR0
         3 000326   100000 236100                    LDQ     0,,PR1
         3 000327   000033 772000                    QRL     27
         3 000330   000000 620006                    EAX0    0,QL
         3 000331   040000 106540                    CMPC    fill='040'O
         3 000332   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
         3 000333   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000334   000342 601000 3                  TNZ     s:2653
         3 000335   200003 234100                    SZN     BLANK_REC,,AUTO
         3 000336   000342 605000 3                  TPL     s:2653

      352     2644    1           0,SSE_PARAM.PTR$ -> STR$PARAM.STR.PTR$(0) -> STR$BUF.COUNT)
      353     2645    1           = ' ' ) AND BLANK_REC
      354     2646    1        THEN
      355     2647    1           FLAGS.TXFLAG = FALSE ;          /* Record not necessarily changed. */

   2647  3 000337   000030 236000 4                  LDQ     24
         3 000340   000000 356000 xsym               ANSQ    FLAGS
         3 000341   000352 710000 3                  TRA     s:2658

      356     2648    1        ELSE
      357     2649    2        DO ;

      358     2650                                                    /*
      359     2651                                                      Record Changed.
      360     2652                                                    */
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:62   
      361     2653    2           FLAGS.TXFLAG = TRUE ;

   2653  3 000342   000040 236003                    LDQ     32,DU
         3 000343   000000 256000 xsym               ORSQ    FLAGS

      362     2654    2           STRCHG_COUNT = STRCHG_COUNT + 1 ;

   2654  3 000344   000000 235000 xsym               LDA     STRCHG_COUNT
         3 000345   000001 035007                    ADLA    1,DL
         3 000346   000000 755000 xsym               STA     STRCHG_COUNT

      363     2655    2           TEMP_STRCHG_COUNT = TEMP_STRCHG_COUNT + 1 ;

   2655  3 000347   000000 235000 xsym               LDA     TEMP_STRCHG_COUNT
         3 000350   000001 035007                    ADLA    1,DL
         3 000351   000000 755000 xsym               STA     TEMP_STRCHG_COUNT

      364     2656    2           END ;                           /* Else Do */

      365     2657        /**/
      366     2658    2        IF ((~SSE_PARAM.FLAGS.CLMNFLAG)AND(SSE_PARAM.J = 0)) THEN DO;

   2658  3 000352   000000 236000 xsym               LDQ     SSE_PARAM
         3 000353   400000 376003                    ANQ     -131072,DU
         3 000354   400000 676003                    ERQ     -131072,DU
         3 000355   000437 600000 3                  TZE     EXEC_D_RET
         3 000356   000000 720000 xsym               LXL0    SSE_PARAM
         3 000357   000437 601000 3                  TNZ     EXEC_D_RET

      367     2659        /**/
      368     2660    2           IF (SSE_PARAM.PTR$ -> STR$PARAM.COUNT = 1) THEN /* CHECK FOR '0/ /D' */

   2660  3 000360   000000 235100                    LDA     0,,PR0
         3 000361   000001 115007                    CMPA    1,DL
         3 000362   000406 601000 3                  TNZ     s:2668

      369     2661    2              IF (SUBSTR(SSE_PARAM.PTR$ -> STR$PARAM.STR.PTR$(0) -> STR$BUF.TEXT,0,
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:63   

   2661  3 000363   100000 236100                    LDQ     0,,PR1
         3 000364   000033 772000                    QRL     27
         3 000365   000000 621006                    EAX1    0,QL
         3 000366   040000 106540                    CMPC    fill='040'O
         3 000367   100000 200011                    ADSC9   0,,PR1                   cn=1,n=*X1
         3 000370   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000371   000406 601000 3                  TNZ     s:2668

      370     2662    3                 SSE_PARAM.PTR$ -> STR$PARAM.STR.PTR$(0) -> STR$BUF.COUNT) = ' ') THEN
              2662                          DO;

      371     2663    3                 IF NOT(FLAGS.BPFLAG) THEN RETURN; /* GET OUT IF BP OFF       */

   2663  3 000372   000000 430000 xsym               FSZN    FLAGS
         3 000373   000375 604000 3                  TMI     s:2664

   2663  3 000374   000000 702200 xent               TSX2  ! X66_ARET

      372     2664    3                 IF (SUBSTR(REC_BUF,STR1_CLMN,(SIZEC(REC_BUF)-STR1_CLMN)) = ' ')

   2664  3 000375   000000 721000 xsym               LXL1    STR1_CLMN
         3 000376   775777 621011                    EAX1    -1025,X1
         3 000377   777777 661003                    ERX1    -1,DU
         3 000400   000000 236000 xsym               LDQ     STR1_CLMN
         3 000401   040000 106446                    CMPC    fill='040'O
         3 000402   000000 000011 xsym               ADSC9   REC_BUF,Q                cn=0,n=*X1
         3 000403   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000404   000406 601000 3                  TNZ     s:2668

      373     2665    3                 THEN RETURN;              /* MAKE SURE DONE                     */

   2665  3 000405   000000 702200 xent               TSX2  ! X66_ARET

      374     2666    3                 END;
      375     2667        /**/
      376     2668    2           CALL VEX$FIND_MATCH(P$,STR1_CLMN,HI_EXEC_CLMN,STR1_CLMN)
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:64   

   2668  3 000406   000031 630400 4                  EPPR0   25
         3 000407   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000410   000000 701000 xent               TSX1    VEX$FIND_MATCH
         3 000411   000437 702000 3                  TSX2    EXEC_D_RET

      377     2669    2              ALTRET (EXEC_D_RET);
      378     2670    2           IF STR1_CLMN + TEMP_STRCHG_COUNT > HI_EXEC_CLMN

   2670  3 000412   000000 236000 xsym               LDQ     STR1_CLMN
         3 000413   000000 036000 xsym               ADLQ    TEMP_STRCHG_COUNT
         3 000414   000000 116000 xsym               CMPQ    HI_EXEC_CLMN
         3 000415   000420 602000 3                  TNC     s:2672
         3 000416   000420 600000 3                  TZE     s:2672

      379     2671    2           THEN RETURN ;

   2671  3 000417   000000 702200 xent               TSX2  ! X66_ARET

      380     2672    3           DO I = 0 TO SSE_PARAM.PTR$ -> STR$PARAM.COUNT - 1 ;

   2672  3 000420   000000 450000 xsym               STZ     I
         3 000421   000432 710000 3                  TRA     s:2675+3

      381     2673    3              IF (SSE_PARAM.PTR$ -> STR$PARAM.STR.QM(I) = '1'B)

   2673  3 000422   000000 235000 xsym               LDA     I
         3 000423   000001 735000                    ALS     1
         3 000424   000001 470400 xsym               LDP0    SSE_PARAM+1
         3 000425   000001 234105                    SZN     1,AL,PR0
         3 000426   000251 604000 3                  TMI     EXEC_D_QM

      382     2674    3              THEN GOTO EXEC_D_QM ;
      383     2675    3              END ;                        /* DO I */

   2675  3 000427   000000 236000 xsym               LDQ     I
         3 000430   000001 036007                    ADLQ    1,DL
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:65   
         3 000431   000000 756000 xsym               STQ     I
         3 000432   000001 470400 xsym               LDP0    SSE_PARAM+1
         3 000433   000000 236000 xsym               LDQ     I
         3 000434   000000 116100                    CMPQ    0,,PR0
         3 000435   000422 602000 3                  TNC     s:2673

      384     2676    2           GOTO EXEC_D_1 ;

   2676  3 000436   000273 710000 3                  TRA     EXEC_D_1

      385     2677    2           END;
      386     2678        /**/
      387     2679    1   EXEC_D_RET:
      388     2680    1        RETURN;

   2680  3 000437   000000 702200 xent  EXEC_D_RET   TSX2  ! X66_ARET

      389     2681        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:66   
      390     2682        /**/
      391     2683    1   VEI$EXEC_E: ENTRY ALTRET;

   2683  3 000440   000000 700200 xent  VEI$EXEC_E   TSX0  ! X66_AUTO_0
         3 000441   000014 000000                    ZERO    12,0

      392     2684        /**/
      393     2685    1        P$ = PINCRW(CMD$,1);

   2685  3 000442   000000 236000 xsym               LDQ     CMD$
         3 000443   000001 036003                    ADLQ    1,DU
         3 000444   000000 756000 xsym               STQ     P$

      394     2686    1        SSE_PARAM = CMD$ -> STR_CMD_TBL.SSE_PARAM;

   2686  3 000445   000000 470400 xsym               LDP0    CMD$
         3 000446   000000 100500                    MLR     fill='000'O
         3 000447   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         3 000450   000000 000010 xsym               ADSC9   SSE_PARAM                cn=0,n=8

      395     2687    1        CALL VEX$FIND_CLMN(P$,STR1_CLMN) ALTRET(EXEC_E_RET);

   2687  3 000451   000000 630400 4                  EPPR0   0
         3 000452   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000453   000000 701000 xent               TSX1    VEX$FIND_CLMN
         3 000454   000570 702000 3                  TSX2    EXEC_E_RET

      396     2688        /**/
      397     2689    1   EXEC_E_1:
      398     2690    1        CALL VEX$MAKE_STRING(STR_BUF,CMD$ -> STR_CMD_TBL.SSE_PARAM2.PTR$ -> STR$PARAM,

   2690  3 000455   000000 470400 xsym  EXEC_E_1     LDP0    CMD$
         3 000456   000004 471500                    LDP1    4,,PR0
         3 000457   000000 236000 xsym               LDQ     CMD$
         3 000460   000001 036003                    ADLQ    1,DU
         3 000461   200006 756100                    STQ     BLANK_REC+3,,AUTO
         3 000462   200005 451500                    STP1    BLANK_REC+2,,AUTO
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:67   
         3 000463   000035 236000 4                  LDQ     29
         3 000464   200004 756100                    STQ     BLANK_REC+1,,AUTO
         3 000465   200004 630500                    EPPR0   BLANK_REC+1,,AUTO
         3 000466   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000467   000000 701000 xent               TSX1    VEX$MAKE_STRING
         3 000470   000000 011000                    NOP     0

      399     2691    1           CMD$ -> STR_CMD_TBL.SSE_PARAM);
      400     2692    2        IF (STR_BUF.COUNT + STR1_CLMN > MAX_CLMN) THEN DO;

   2692  3 000471   000000 236000 xsym               LDQ     STR_BUF
         3 000472   000022 772000                    QRL     18
         3 000473   000000 036000 xsym               ADLQ    STR1_CLMN
         3 000474   000000 116000 xsym               CMPQ    MAX_CLMN
         3 000475   000507 602000 3                  TNC     s:2700
         3 000476   000507 600000 3                  TZE     s:2700

      401     2693    2           CALL VEX$ERROR(E$E_OVERFLOW,2); /* OVERFLOW                        */

   2693  3 000477   000037 630400 4                  EPPR0   31
         3 000500   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000501   000000 701000 xent               TSX1    VEX$ERROR
         3 000502   000000 011000                    NOP     0

      402     2694    2           STR_BUF.COUNT = MAX_CLMN - STR1_CLMN;

   2694  3 000503   000000 236000 xsym               LDQ     MAX_CLMN
         3 000504   000000 136000 xsym               SBLQ    STR1_CLMN
         3 000505   000000 620006                    EAX0    0,QL
         3 000506   000000 740000 xsym               STX0    STR_BUF

      403     2695    2           END;

      404     2696        /**/
      405     2697        /*E*     ERROR:    VEE-E$E_OVERFLOW-0
      406     2698                 DESCRIPTION: Characters lost durring E/O operation.
      407     2699        */
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:68   
      408     2700    1        CALL INSERT(REC_BUF,STR1_CLMN,STR_BUF.COUNT,STR_BUF.TEXT);

   2700  3 000507   000000 220000 xsym               LDX0    STR_BUF
         3 000510   000000 235000 xsym               LDA     STR1_CLMN
         3 000511   040045 100400                    MLR     fill='040'O
         3 000512   000000 402000 xsym               ADSC9   STR_BUF                  cn=2,n=1024
         3 000513   000000 000010 xsym               ADSC9   REC_BUF,A                cn=0,n=*X0

      409     2701        /**/
      410     2702    1        IF (REC_SIZE < STR1_CLMN + STR_BUF.COUNT) THEN

   2702  3 000514   000000 236000 xsym               LDQ     STR_BUF
         3 000515   000022 772000                    QRL     18
         3 000516   000000 036000 xsym               ADLQ    STR1_CLMN
         3 000517   000000 116000 xsym               CMPQ    REC_SIZE
         3 000520   000526 602000 3                  TNC     s:2705
         3 000521   000526 600000 3                  TZE     s:2705

      411     2703    1           REC_SIZE = STR1_CLMN + STR_BUF.COUNT;

   2703  3 000522   000000 236000 xsym               LDQ     STR_BUF
         3 000523   000022 772000                    QRL     18
         3 000524   000000 036000 xsym               ADLQ    STR1_CLMN
         3 000525   000000 756000 xsym               STQ     REC_SIZE

      412     2704        /**/
      413     2705    1        FLAGS.TXFLAG = TRUE;               /* RECORD CHANGED                     */

   2705  3 000526   000040 236003                    LDQ     32,DU
         3 000527   000000 256000 xsym               ORSQ    FLAGS

      414     2706    1        STRCHG_COUNT = STRCHG_COUNT + 1;

   2706  3 000530   000000 235000 xsym               LDA     STRCHG_COUNT
         3 000531   000001 035007                    ADLA    1,DL
         3 000532   000000 755000 xsym               STA     STRCHG_COUNT

PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:69   
      415     2707    1        STR1_CLMN = STR1_CLMN + STR_BUF.COUNT; /* SKIP TO END OF TEXT         */

   2707  3 000533   000000 236000 xsym               LDQ     STR_BUF
         3 000534   000022 772000                    QRL     18
         3 000535   000000 036000 xsym               ADLQ    STR1_CLMN
         3 000536   000000 756000 xsym               STQ     STR1_CLMN

      416     2708    2        IF (CMD_CODE = ECMD) THEN DO;      /* E COMMAND                          */

   2708  3 000537   000000 235000 xsym               LDA     CMD_CODE
         3 000540   000075 115007                    CMPA    61,DL
         3 000541   000555 601000 3                  TNZ     s:2714

      417     2709    2           IF (STR1_CLMN <= HI_EXEC_CLMN) THEN

   2709  3 000542   000000 116000 xsym               CMPQ    HI_EXEC_CLMN
         3 000543   000545 600000 3                  TZE     s:2710
         3 000544   000554 603000 3                  TRC     s:2711

      418     2710    2              CALL INSERT(REC_BUF,STR1_CLMN,HI_EXEC_CLMN-STR1_CLMN+1,' ');

   2710  3 000545   000000 236000 xsym               LDQ     HI_EXEC_CLMN
         3 000546   000000 136000 xsym               SBLQ    STR1_CLMN
         3 000547   000001 621006                    EAX1    1,QL
         3 000550   000000 236000 xsym               LDQ     STR1_CLMN
         3 000551   040046 100400                    MLR     fill='040'O
         3 000552   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000553   000000 000011 xsym               ADSC9   REC_BUF,Q                cn=0,n=*X1

      419     2711    2           RETURN;

   2711  3 000554   000000 702200 xent               TSX2  ! X66_ARET

      420     2712    2           END;
      421     2713        /**/
      422     2714    2        IF ((~SSE_PARAM.FLAGS.CLMNFLAG) AND (SSE_PARAM.J = 0)) THEN DO;

PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:70   
   2714  3 000555   000000 236000 xsym               LDQ     SSE_PARAM
         3 000556   400000 376003                    ANQ     -131072,DU
         3 000557   400000 676003                    ERQ     -131072,DU
         3 000560   000570 600000 3                  TZE     EXEC_E_RET
         3 000561   000000 721000 xsym               LXL1    SSE_PARAM
         3 000562   000570 601000 3                  TNZ     EXEC_E_RET

      423     2715    2           CALL VEX$FIND_MATCH(P$,STR1_CLMN,HI_EXEC_CLMN,STR1_CLMN)

   2715  3 000563   000031 630400 4                  EPPR0   25
         3 000564   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000565   000000 701000 xent               TSX1    VEX$FIND_MATCH
         3 000566   000570 702000 3                  TSX2    EXEC_E_RET

      424     2716    2              ALTRET (EXEC_E_RET);
      425     2717    2           GOTO EXEC_E_1;

   2717  3 000567   000455 710000 3                  TRA     EXEC_E_1

      426     2718    2           END;
      427     2719        /**/
      428     2720    1   EXEC_E_RET:
      429     2721    1        RETURN;

   2721  3 000570   000000 702200 xent  EXEC_E_RET   TSX2  ! X66_ARET

      430     2722        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:71   
      431     2723        /**/
      432     2724    1   VEI$EXEC_EI: ENTRY ALTRET;

   2724  3 000571   000000 700200 xent  VEI$EXEC_EI  TSX0  ! X66_AUTO_0
         3 000572   000014 000000                    ZERO    12,0

      433     2725        /**/
      434     2726    1        RETURN;

   2726  3 000573   000000 702200 xent               TSX2  ! X66_ARET

      435     2727        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:72   
      436     2728        /**/
      437     2729    1   VEI$EXEC_EL: ENTRY ALTRET;

   2729  3 000574   000000 700200 xent  VEI$EXEC_EL  TSX0  ! X66_AUTO_0
         3 000575   000014 000000                    ZERO    12,0

      438     2730        /**/
      439     2731    1        TEMP_IF_LEVEL = IF_LEVEL ;

   2731  3 000576   000000 235000 xsym               LDA     IF_LEVEL
         3 000577   000000 755000 xsym               STA     TEMP_IF_LEVEL

      440     2732        /**/
      441     2733    2        DO WHILE ((TEMP_IF_LEVEL ~= IF_LEVEL) OR

   2733  3 000600   000634 710000 3                  TRA     s:2742

      442     2734    2           (CMD$ -> CMD_CNTRLWD.CMD_CODE ~= EICMD)) ;
      443     2735    2           IF (PINCRW(CMD$,CMD$ -> CMD_CNTRLWD.OFFSET) ->

   2735  3 000601   000000 470400 xsym               LDP0    CMD$
         3 000602   000000 236100                    LDQ     0,,PR0
         3 000603   000011 772000                    QRL     9
         3 000604   000777 376007                    ANQ     511,DL
         3 000605   000000 234106                    SZN     0,QL,PR0
         3 000606   000610 605000 3                  TPL     s:2737

      444     2736    2              CMD_CNTRLWD.FLAGS.ENDCT = TRUE) THEN RETURN;

   2736  3 000607   000000 702200 xent               TSX2  ! X66_ARET

      445     2737    2           IF (CMD$ -> CMD_CNTRLWD.CMD_CODE = IFCMD)

   2737  3 000610   000000 236100                    LDQ     0,,PR0
         3 000611   000777 376007                    ANQ     511,DL
         3 000612   000107 116007                    CMPQ    71,DL
         3 000613   000617 601000 3                  TNZ     s:2739
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:73   

      446     2738    2           THEN TEMP_IF_LEVEL = TEMP_IF_LEVEL + 1 ;

   2738  3 000614   000000 235000 xsym               LDA     TEMP_IF_LEVEL
         3 000615   000001 035007                    ADLA    1,DL
         3 000616   000000 755000 xsym               STA     TEMP_IF_LEVEL

      447     2739    2           IF (CMD$ -> CMD_CNTRLWD.CMD_CODE = EICMD)

   2739  3 000617   000000 236100                    LDQ     0,,PR0
         3 000620   000777 376007                    ANQ     511,DL
         3 000621   000110 116007                    CMPQ    72,DL
         3 000622   000626 601000 3                  TNZ     s:2741

      448     2740    2           THEN TEMP_IF_LEVEL = TEMP_IF_LEVEL - 1 ;

   2740  3 000623   000000 235000 xsym               LDA     TEMP_IF_LEVEL
         3 000624   000001 135007                    SBLA    1,DL
         3 000625   000000 755000 xsym               STA     TEMP_IF_LEVEL

      449     2741    2           CMD$ = PINCRW(CMD$,CMD$ -> CMD_CNTRLWD.OFFSET);

   2741  3 000626   000000 236100                    LDQ     0,,PR0
         3 000627   000011 772000                    QRL     9
         3 000630   000777 376007                    ANQ     511,DL
         3 000631   000022 736000                    QLS     18
         3 000632   000000 036000 xsym               ADLQ    CMD$
         3 000633   000000 756000 xsym               STQ     CMD$

      450     2742    2           END;

   2742  3 000634   000000 236000 xsym               LDQ     TEMP_IF_LEVEL
         3 000635   000000 116000 xsym               CMPQ    IF_LEVEL
         3 000636   000601 601000 3                  TNZ     s:2735
         3 000637   000000 470400 xsym               LDP0    CMD$
         3 000640   000000 236100                    LDQ     0,,PR0
         3 000641   000777 376007                    ANQ     511,DL
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:74   
         3 000642   000110 116007                    CMPQ    72,DL
         3 000643   000601 601000 3                  TNZ     s:2735

      451     2743    1        RETURN;

   2743  3 000644   000000 702200 xent               TSX2  ! X66_ARET

      452     2744        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:75   
      453     2745        /**/
      454     2746    1   VEI$EXEC_F: ENTRY ALTRET;

   2746  3 000645   000000 700200 xent  VEI$EXEC_F   TSX0  ! X66_AUTO_0
         3 000646   000014 000000                    ZERO    12,0

      455     2747        /**/
      456     2748    1        P$ = PINCRW(CMD$,1);

   2748  3 000647   000000 236000 xsym               LDQ     CMD$
         3 000650   000001 036003                    ADLQ    1,DU
         3 000651   000000 756000 xsym               STQ     P$

      457     2749    1        SSE_PARAM = CMD$ -> STR_CMD_TBL.SSE_PARAM;

   2749  3 000652   000000 470400 xsym               LDP0    CMD$
         3 000653   000000 100500                    MLR     fill='000'O
         3 000654   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         3 000655   000000 000010 xsym               ADSC9   SSE_PARAM                cn=0,n=8

      458     2750    1        CALL VEX$FIND_CLMN(P$,STR1_CLMN) ALTRET(EXEC_F_RET);

   2750  3 000656   000000 630400 4                  EPPR0   0
         3 000657   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000660   000000 701000 xent               TSX1    VEX$FIND_CLMN
         3 000661   001015 702000 3                  TSX2    EXEC_F_RET

      459     2751        /**/
      460     2752    1   EXEC_F_1:
      461     2753    1        CALL VEX$MAKE_STRING(STR_BUF,CMD$ -> STR_CMD_TBL.SSE_PARAM2.PTR$ -> STR$PARAM,

   2753  3 000662   000000 470400 xsym  EXEC_F_1     LDP0    CMD$
         3 000663   000004 471500                    LDP1    4,,PR0
         3 000664   000000 236000 xsym               LDQ     CMD$
         3 000665   000001 036003                    ADLQ    1,DU
         3 000666   200006 756100                    STQ     BLANK_REC+3,,AUTO
         3 000667   200005 451500                    STP1    BLANK_REC+2,,AUTO
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:76   
         3 000670   000035 236000 4                  LDQ     29
         3 000671   200004 756100                    STQ     BLANK_REC+1,,AUTO
         3 000672   200004 630500                    EPPR0   BLANK_REC+1,,AUTO
         3 000673   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000674   000000 701000 xent               TSX1    VEX$MAKE_STRING
         3 000675   000000 011000                    NOP     0

      462     2754    1           CMD$ -> STR_CMD_TBL.SSE_PARAM);
      463     2755    1        IF (SSE_PARAM.FLAGS.CLMNFLAG) THEN STR1_CLMN = STR1_CLMN+1;

   2755  3 000676   000000 234000 xsym               SZN     SSE_PARAM
         3 000677   000704 605000 3                  TPL     s:2756

   2755  3 000700   000000 235000 xsym               LDA     STR1_CLMN
         3 000701   000001 035007                    ADLA    1,DL
         3 000702   000000 755000 xsym               STA     STR1_CLMN
         3 000703   000725 710000 3                  TRA     s:2760

      464     2756    2        ELSE DO I = 0 TO SSE_PARAM.PTR$ -> STR$PARAM.COUNT - 1;

   2756  3 000704   000000 450000 xsym               STZ     I
         3 000705   000721 710000 3                  TRA     s:2759+3

      465     2757    2           STR1_CLMN = STR1_CLMN + SSE_PARAM.PTR$ ->

   2757  3 000706   000000 235000 xsym               LDA     I
         3 000707   000001 735000                    ALS     1
         3 000710   000001 470400 xsym               LDP0    SSE_PARAM+1
         3 000711   000002 471505                    LDP1    2,AL,PR0
         3 000712   100000 236100                    LDQ     0,,PR1
         3 000713   000033 772000                    QRL     27
         3 000714   000000 036000 xsym               ADLQ    STR1_CLMN
         3 000715   000000 756000 xsym               STQ     STR1_CLMN

      466     2758    2              STR$PARAM.STR.PTR$(I) -> STR$BUF.COUNT;
      467     2759    2           END;

PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:77   
   2759  3 000716   000000 235000 xsym               LDA     I
         3 000717   000001 035007                    ADLA    1,DL
         3 000720   000000 755000 xsym               STA     I
         3 000721   000001 470400 xsym               LDP0    SSE_PARAM+1
         3 000722   000000 236000 xsym               LDQ     I
         3 000723   000000 116100                    CMPQ    0,,PR0
         3 000724   000706 602000 3                  TNC     s:2757

      468     2760    2        IF (STR1_CLMN + STR_BUF.COUNT > MAX_CLMN) THEN DO;

   2760  3 000725   000000 236000 xsym               LDQ     STR_BUF
         3 000726   000022 772000                    QRL     18
         3 000727   000000 036000 xsym               ADLQ    STR1_CLMN
         3 000730   000000 116000 xsym               CMPQ    MAX_CLMN
         3 000731   000743 602000 3                  TNC     s:2768
         3 000732   000743 600000 3                  TZE     s:2768

      469     2761    2           CALL VEX$ERROR(E$E_OVERFLOW,2); /* OVERFLOW                        */

   2761  3 000733   000037 630400 4                  EPPR0   31
         3 000734   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000735   000000 701000 xent               TSX1    VEX$ERROR
         3 000736   000000 011000                    NOP     0

      470     2762    2           STR_BUF.COUNT = MAX_CLMN - STR1_CLMN;

   2762  3 000737   000000 236000 xsym               LDQ     MAX_CLMN
         3 000740   000000 136000 xsym               SBLQ    STR1_CLMN
         3 000741   000000 620006                    EAX0    0,QL
         3 000742   000000 740000 xsym               STX0    STR_BUF

      471     2763    2           END;

      472     2764        /**/
      473     2765        /*E*     ERROR:    VEE-E$E_OVERFLOW-0
      474     2766                 DESCRIPTION: Characters lost durring F operation.
      475     2767        */
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:78   
      476     2768    1        TEMP_COUNT = STR_BUF.COUNT;

   2768  3 000743   000000 235000 xsym               LDA     STR_BUF
         3 000744   000022 771000                    ARL     18
         3 000745   000000 755000 xsym               STA     TEMP_COUNT

      477     2769    1        IF TEMP_COUNT = 0 AND SSE_PARAM.J = 0

   2769  3 000746   000751 601000 3                  TNZ     s:2772
         3 000747   000000 720000 xsym               LXL0    SSE_PARAM
         3 000750   001015 600000 3                  TZE     EXEC_F_RET

      478     2770    1        THEN                               /* Moving Null string many times. */
      479     2771    1           GOTO EXEC_F_RET ;
      480     2772    1        IF (FLAGS.BPFLAG) THEN CALL VEX$MOVE_RIGHT(STR1_CLMN,TEMP_COUNT);

   2772  3 000751   000000 430000 xsym               FSZN    FLAGS
         3 000752   000760 605000 3                  TPL     s:2773

   2772  3 000753   000004 630400 4                  EPPR0   4
         3 000754   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000755   000000 701000 xent               TSX1    VEX$MOVE_RIGHT
         3 000756   000000 011000                    NOP     0
         3 000757   000764 710000 3                  TRA     s:2774

      481     2773    1        ELSE CALL VEX$COMP_RIGHT(STR1_CLMN,TEMP_COUNT);

   2773  3 000760   000004 630400 4                  EPPR0   4
         3 000761   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000762   000000 701000 xent               TSX1    VEX$COMP_RIGHT
         3 000763   000000 011000                    NOP     0

      482     2774    1        CALL INSERT(REC_BUF,STR1_CLMN,STR_BUF.COUNT,STR_BUF.TEXT);

   2774  3 000764   000000 220000 xsym               LDX0    STR_BUF
         3 000765   000000 235000 xsym               LDA     STR1_CLMN
         3 000766   040045 100400                    MLR     fill='040'O
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:79   
         3 000767   000000 402000 xsym               ADSC9   STR_BUF                  cn=2,n=1024
         3 000770   000000 000010 xsym               ADSC9   REC_BUF,A                cn=0,n=*X0

      483     2775    1        FLAGS.TXFLAG = TRUE;

   2775  3 000771   000040 236003                    LDQ     32,DU
         3 000772   000000 256000 xsym               ORSQ    FLAGS

      484     2776    1        STRCHG_COUNT = STRCHG_COUNT + 1;

   2776  3 000773   000000 235000 xsym               LDA     STRCHG_COUNT
         3 000774   000001 035007                    ADLA    1,DL
         3 000775   000000 755000 xsym               STA     STRCHG_COUNT

      485     2777    2        IF ((~SSE_PARAM.FLAGS.CLMNFLAG) AND (SSE_PARAM.J = 0)) THEN DO;

   2777  3 000776   000000 236000 xsym               LDQ     SSE_PARAM
         3 000777   400000 376003                    ANQ     -131072,DU
         3 001000   400000 676003                    ERQ     -131072,DU
         3 001001   001015 600000 3                  TZE     EXEC_F_RET
         3 001002   000000 721000 xsym               LXL1    SSE_PARAM
         3 001003   001015 601000 3                  TNZ     EXEC_F_RET

      486     2778    2           STR1_CLMN = STR1_CLMN + STR_BUF.COUNT;

   2778  3 001004   000000 236000 xsym               LDQ     STR_BUF
         3 001005   000022 772000                    QRL     18
         3 001006   000000 036000 xsym               ADLQ    STR1_CLMN
         3 001007   000000 756000 xsym               STQ     STR1_CLMN

      487     2779    2           CALL VEX$FIND_MATCH(P$,STR1_CLMN,HI_EXEC_CLMN,STR1_CLMN)

   2779  3 001010   000031 630400 4                  EPPR0   25
         3 001011   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 001012   000000 701000 xent               TSX1    VEX$FIND_MATCH
         3 001013   001015 702000 3                  TSX2    EXEC_F_RET

PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:80   
      488     2780    2              ALTRET (EXEC_F_RET);
      489     2781    2           GOTO EXEC_F_1;

   2781  3 001014   000662 710000 3                  TRA     EXEC_F_1

      490     2782    2           END;
      491     2783        /**/
      492     2784    1   EXEC_F_RET:
      493     2785    1        RETURN;

   2785  3 001015   000000 702200 xent  EXEC_F_RET   TSX2  ! X66_ARET

      494     2786        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:81   
      495     2787        /**/
      496     2788    1   VEI$EXEC_JU: ENTRY ALTRET;

   2788  3 001016   000000 700200 xent  VEI$EXEC_JU  TSX0  ! X66_AUTO_0
         3 001017   000014 000000                    ZERO    12,0

      497     2789        /**/
      498     2790    2        IF (FLAGS.TXFLAG) THEN DO;         /* WRITE TO FILE                      */

   2790  3 001020   000000 236000 xsym               LDQ     FLAGS
         3 001021   000040 316003                    CANQ    32,DU
         3 001022   001031 600000 3                  TZE     s:2795

      499     2791    2           FLAGS.TXFLAG = FALSE;

   2791  3 001023   000030 236000 4                  LDQ     24
         3 001024   000000 356000 xsym               ANSQ    FLAGS

      500     2792    2           CALL VEX$WRITE_REC(M$FILE_NUM,LAST_KEY);

   2792  3 001025   000041 630400 4                  EPPR0   33
         3 001026   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001027   000000 701000 xent               TSX1    VEX$WRITE_REC
         3 001030   000000 011000                    NOP     0

      501     2793    2           END;

      502     2794        /**/
      503     2795    1        EXEC_SEQNUM = CMD$ -> JU_CMD_TBL.EDITKEY.SEQNUM -1;

   2795  3 001031   000000 470400 xsym               LDP0    CMD$
         3 001032   000001 235100                    LDA     1,,PR0
         3 001033   000001 135007                    SBLA    1,DL
         3 001034   000000 755000 xsym               STA     EXEC_SEQNUM

      504     2796                                                /* Set so next read gets right record */
      505     2797    1        CALL VEX$READ_RANDOM(EXEC_SEQNUM) ALTRET(EXEC_JU_ERR);
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:82   

   2797  3 001035   000043 630400 4                  EPPR0   35
         3 001036   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001037   000000 701000 xent               TSX1    VEX$READ_RANDOM
         3 001040   001042 702000 3                  TSX2    EXEC_JU_ERR

      506     2798    1        RETURN;

   2798  3 001041   000000 702200 xent               TSX2  ! X66_ARET

      507     2799        /**/
      508     2800    1   EXEC_JU_ERR:
      509     2801    1        RETURN;

   2801  3 001042   000000 702200 xent  EXEC_JU_ERR  TSX2  ! X66_ARET

      510     2802        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:83   
      511     2803        /**/
      512     2804    1   VEI$EXEC_L: ENTRY ALTRET;

   2804  3 001043   000000 700200 xent  VEI$EXEC_L   TSX0  ! X66_AUTO_0
         3 001044   000014 000000                    ZERO    12,0

      513     2805        /**/
      514     2806    1        IF REC_SIZE = 1 AND REC_BUF = ' '

   2806  3 001045   000000 235000 xsym               LDA     REC_SIZE
         3 001046   000001 115007                    CMPA    1,DL
         3 001047   001054 601000 3                  TNZ     s:2808
         3 001050   040000 106400                    CMPC    fill='040'O
         3 001051   000000 002000 xsym               ADSC9   REC_BUF                  cn=0,n=1024
         3 001052   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001053   001134 600000 3                  TZE     EXEC_L_RET

      515     2807    1        THEN GOTO EXEC_L_RET ;             /* NO MORE TO SHIFT LEFT              */
      516     2808    1        P$ = PINCRW(CMD$,1);

   2808  3 001054   000000 236000 xsym               LDQ     CMD$
         3 001055   000001 036003                    ADLQ    1,DU
         3 001056   000000 756000 xsym               STQ     P$

      517     2809    1        TEMP_COUNT = CMD$ -> RL_CMD_TBL.SHIFT#;

   2809  3 001057   000000 470400 xsym               LDP0    CMD$
         3 001060   000003 235100                    LDA     3,,PR0
         3 001061   000000 755000 xsym               STA     TEMP_COUNT

      518     2810    1        CALL VEX$FIND_CLMN(P$,STR1_CLMN) ALTRET(EXEC_L_RET);

   2810  3 001062   000000 630400 4                  EPPR0   0
         3 001063   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001064   000000 701000 xent               TSX1    VEX$FIND_CLMN
         3 001065   001134 702000 3                  TSX2    EXEC_L_RET

PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:84   
      519     2811    1        TEMP_CLMN = 0;

   2811  3 001066   000000 450000 xsym               STZ     TEMP_CLMN

      520     2812    2        IF NOT(P$ -> SSE$PARAM.FLAGS.CLMNFLAG) THEN DO;

   2812  3 001067   000000 470400 xsym               LDP0    P$
         3 001070   000000 234100                    SZN     0,,PR0
         3 001071   001114 604000 3                  TMI     s:2819

      521     2813    3           DO I = 0 TO P$ -> SSE$PARAM.PTR$ -> STR$PARAM.COUNT - 1;

   2813  3 001072   000000 450000 xsym               STZ     I
         3 001073   001110 710000 3                  TRA     s:2816+3

      522     2814    3              TEMP_CLMN = TEMP_CLMN + P$ -> SSE$PARAM.PTR$ ->

   2814  3 001074   000000 470400 xsym               LDP0    P$
         3 001075   000001 471500                    LDP1    1,,PR0
         3 001076   000000 235000 xsym               LDA     I
         3 001077   000001 735000                    ALS     1
         3 001100   100002 473505                    LDP3    2,AL,PR1
         3 001101   300000 236100                    LDQ     0,,PR3
         3 001102   000033 772000                    QRL     27
         3 001103   000000 036000 xsym               ADLQ    TEMP_CLMN
         3 001104   000000 756000 xsym               STQ     TEMP_CLMN

      523     2815    3                 STR$PARAM.STR.PTR$(I) -> STR$BUF.COUNT;
      524     2816    3              END;

   2816  3 001105   000000 235000 xsym               LDA     I
         3 001106   000001 035007                    ADLA    1,DL
         3 001107   000000 755000 xsym               STA     I
         3 001110   000001 471500                    LDP1    1,,PR0
         3 001111   000000 236000 xsym               LDQ     I
         3 001112   100000 116100                    CMPQ    0,,PR1
         3 001113   001074 602000 3                  TNC     s:2814
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:85   

      525     2817    2           END;

      526     2818        /**/
      527     2819    1        IF (FLAGS.BPFLAG) THEN CALL VEX$MOVE_LEFT(STR1_CLMN,TEMP_COUNT);

   2819  3 001114   000000 430000 xsym               FSZN    FLAGS
         3 001115   001123 605000 3                  TPL     s:2820

   2819  3 001116   000004 630400 4                  EPPR0   4
         3 001117   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001120   000000 701000 xent               TSX1    VEX$MOVE_LEFT
         3 001121   000000 011000                    NOP     0
         3 001122   001127 710000 3                  TRA     s:2821

      528     2820    1        ELSE CALL VEX$FIELD_LEFT(STR1_CLMN,TEMP_COUNT,TEMP_CLMN);

   2820  3 001123   000006 630400 4                  EPPR0   6
         3 001124   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 001125   000000 701000 xent               TSX1    VEX$FIELD_LEFT
         3 001126   000000 011000                    NOP     0

      529     2821    1        FLAGS.TXFLAG = TRUE;               /* RECORD CHANGED                     */

   2821  3 001127   000040 236003                    LDQ     32,DU
         3 001130   000000 256000 xsym               ORSQ    FLAGS

      530     2822    1        STRCHG_COUNT = STRCHG_COUNT + 1;

   2822  3 001131   000000 235000 xsym               LDA     STRCHG_COUNT
         3 001132   000001 035007                    ADLA    1,DL
         3 001133   000000 755000 xsym               STA     STRCHG_COUNT

      531     2823        /**/
      532     2824    1   EXEC_L_RET:
      533     2825    1        RETURN;

PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:86   
   2825  3 001134   000000 702200 xent  EXEC_L_RET   TSX2  ! X66_ARET

      534     2826        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:87   
      535     2827        /**/
      536     2828    1   VEI$EXEC_NO: ENTRY ALTRET;

   2828  3 001135   000000 700200 xent  VEI$EXEC_NO  TSX0  ! X66_AUTO_0
         3 001136   000014 000000                    ZERO    12,0

      537     2829        /**/
      538     2830    1        FLAGS.NOFLAG = TRUE;

   2830  3 001137   002000 236007                    LDQ     1024,DL
         3 001140   000000 256000 xsym               ORSQ    FLAGS

      539     2831    1        RETURN;

   2831  3 001141   000000 702200 xent               TSX2  ! X66_ARET

      540     2832        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:88   
      541     2833        /**/
      542     2834    1   VEI$EXEC_P: ENTRY ALTRET;

   2834  3 001142   000000 700200 xent  VEI$EXEC_P   TSX0  ! X66_AUTO_0
         3 001143   000014 000000                    ZERO    12,0

      543     2835        /**/
      544     2836    1        P$ = PINCRW(CMD$,1);

   2836  3 001144   000000 236000 xsym               LDQ     CMD$
         3 001145   000001 036003                    ADLQ    1,DU
         3 001146   000000 756000 xsym               STQ     P$

      545     2837    1        SSE_PARAM = CMD$ -> STR_CMD_TBL.SSE_PARAM;

   2837  3 001147   000000 470400 xsym               LDP0    CMD$
         3 001150   000000 100500                    MLR     fill='000'O
         3 001151   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         3 001152   000000 000010 xsym               ADSC9   SSE_PARAM                cn=0,n=8

      546     2838    1        CALL VEX$FIND_CLMN(P$,STR1_CLMN) ALTRET(EXEC_P_RET);

   2838  3 001153   000000 630400 4                  EPPR0   0
         3 001154   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001155   000000 701000 xent               TSX1    VEX$FIND_CLMN
         3 001156   001301 702000 3                  TSX2    EXEC_P_RET

      547     2839        /**/
      548     2840    1   EXEC_P_1:
      549     2841    1        CALL VEX$MAKE_STRING(STR_BUF,CMD$ -> STR_CMD_TBL.SSE_PARAM2.PTR$ -> STR$PARAM,

   2841  3 001157   000000 470400 xsym  EXEC_P_1     LDP0    CMD$
         3 001160   000004 471500                    LDP1    4,,PR0
         3 001161   000000 236000 xsym               LDQ     CMD$
         3 001162   000001 036003                    ADLQ    1,DU
         3 001163   200006 756100                    STQ     BLANK_REC+3,,AUTO
         3 001164   200005 451500                    STP1    BLANK_REC+2,,AUTO
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:89   
         3 001165   000035 236000 4                  LDQ     29
         3 001166   200004 756100                    STQ     BLANK_REC+1,,AUTO
         3 001167   200004 630500                    EPPR0   BLANK_REC+1,,AUTO
         3 001170   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 001171   000000 701000 xent               TSX1    VEX$MAKE_STRING
         3 001172   000000 011000                    NOP     0

      550     2842    1           CMD$ -> STR_CMD_TBL.SSE_PARAM);
      551     2843    1        TEMP_COUNT = STR_BUF.COUNT;

   2843  3 001173   000000 235000 xsym               LDA     STR_BUF
         3 001174   000022 771000                    ARL     18
         3 001175   000000 755000 xsym               STA     TEMP_COUNT

      552     2844    1        IF (FLAGS.BPFLAG) THEN CALL VEX$MOVE_RIGHT(STR1_CLMN,TEMP_COUNT);

   2844  3 001176   000000 430000 xsym               FSZN    FLAGS
         3 001177   001205 605000 3                  TPL     s:2845

   2844  3 001200   000004 630400 4                  EPPR0   4
         3 001201   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001202   000000 701000 xent               TSX1    VEX$MOVE_RIGHT
         3 001203   000000 011000                    NOP     0
         3 001204   001211 710000 3                  TRA     s:2847

      553     2845    1        ELSE CALL VEX$COMP_RIGHT(STR1_CLMN,TEMP_COUNT);

   2845  3 001205   000004 630400 4                  EPPR0   4
         3 001206   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001207   000000 701000 xent               TSX1    VEX$COMP_RIGHT
         3 001210   000000 011000                    NOP     0

      554     2846        /**/
      555     2847    2        IF (STR1_CLMN + STR_BUF.COUNT > MAX_CLMN) THEN DO;

   2847  3 001211   000000 236000 xsym               LDQ     STR_BUF
         3 001212   000022 772000                    QRL     18
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:90   
         3 001213   000000 036000 xsym               ADLQ    STR1_CLMN
         3 001214   000000 116000 xsym               CMPQ    MAX_CLMN
         3 001215   001227 602000 3                  TNC     s:2856
         3 001216   001227 600000 3                  TZE     s:2856

      556     2848    2           CALL VEX$ERROR(E$E_OVERFLOW,2); /* OVERFLOW                        */

   2848  3 001217   000037 630400 4                  EPPR0   31
         3 001220   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001221   000000 701000 xent               TSX1    VEX$ERROR
         3 001222   000000 011000                    NOP     0

      557     2849    2           STR_BUF.COUNT = MAX_CLMN - STR1_CLMN;

   2849  3 001223   000000 236000 xsym               LDQ     MAX_CLMN
         3 001224   000000 136000 xsym               SBLQ    STR1_CLMN
         3 001225   000000 620006                    EAX0    0,QL
         3 001226   000000 740000 xsym               STX0    STR_BUF

      558     2850    2           END;

      559     2851        /**/
      560     2852        /*E*     ERROR:    VEE-E$E_OVERFLOW-0
      561     2853                 DESCRIPTION: Characters lost durring P operation.
      562     2854        */
      563     2855        /**/
      564     2856    1        CALL INSERT(REC_BUF,STR1_CLMN,STR_BUF.COUNT,STR_BUF.TEXT);

   2856  3 001227   000000 220000 xsym               LDX0    STR_BUF
         3 001230   000000 235000 xsym               LDA     STR1_CLMN
         3 001231   040045 100400                    MLR     fill='040'O
         3 001232   000000 402000 xsym               ADSC9   STR_BUF                  cn=2,n=1024
         3 001233   000000 000010 xsym               ADSC9   REC_BUF,A                cn=0,n=*X0

      565     2857    1        FLAGS.TXFLAG = TRUE;               /* RECORD CHANGED                     */

   2857  3 001234   000040 236003                    LDQ     32,DU
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:91   
         3 001235   000000 256000 xsym               ORSQ    FLAGS

      566     2858    1        STRCHG_COUNT = STRCHG_COUNT + 1;

   2858  3 001236   000000 235000 xsym               LDA     STRCHG_COUNT
         3 001237   000001 035007                    ADLA    1,DL
         3 001240   000000 755000 xsym               STA     STRCHG_COUNT

      567     2859        /**/
      568     2860    2        IF ((~SSE_PARAM.FLAGS.CLMNFLAG) AND (SSE_PARAM.J = 0)) THEN DO;

   2860  3 001241   000000 236000 xsym               LDQ     SSE_PARAM
         3 001242   400000 376003                    ANQ     -131072,DU
         3 001243   400000 676003                    ERQ     -131072,DU
         3 001244   001301 600000 3                  TZE     EXEC_P_RET
         3 001245   000000 721000 xsym               LXL1    SSE_PARAM
         3 001246   001301 601000 3                  TNZ     EXEC_P_RET

      569     2861    2           STR1_CLMN = STR1_CLMN + STR_BUF.COUNT;

   2861  3 001247   000000 236000 xsym               LDQ     STR_BUF
         3 001250   000022 772000                    QRL     18
         3 001251   000000 036000 xsym               ADLQ    STR1_CLMN
         3 001252   000000 756000 xsym               STQ     STR1_CLMN

      570     2862    3           DO I = 0 TO SSE_PARAM.PTR$ -> STR$PARAM.COUNT - 1;

   2862  3 001253   000000 450000 xsym               STZ     I
         3 001254   001270 710000 3                  TRA     s:2865+3

      571     2863    3              STR1_CLMN = STR1_CLMN + SSE_PARAM.PTR$ ->

   2863  3 001255   000000 235000 xsym               LDA     I
         3 001256   000001 735000                    ALS     1
         3 001257   000001 470400 xsym               LDP0    SSE_PARAM+1
         3 001260   000002 471505                    LDP1    2,AL,PR0
         3 001261   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:92   
         3 001262   000033 772000                    QRL     27
         3 001263   000000 036000 xsym               ADLQ    STR1_CLMN
         3 001264   000000 756000 xsym               STQ     STR1_CLMN

      572     2864    3                 STR$PARAM.STR.PTR$(I) -> STR$BUF.COUNT;
      573     2865    3              END;

   2865  3 001265   000000 235000 xsym               LDA     I
         3 001266   000001 035007                    ADLA    1,DL
         3 001267   000000 755000 xsym               STA     I
         3 001270   000001 470400 xsym               LDP0    SSE_PARAM+1
         3 001271   000000 236000 xsym               LDQ     I
         3 001272   000000 116100                    CMPQ    0,,PR0
         3 001273   001255 602000 3                  TNC     s:2863

      574     2866    2           CALL VEX$FIND_MATCH(P$,STR1_CLMN,HI_EXEC_CLMN,STR1_CLMN)

   2866  3 001274   000031 630400 4                  EPPR0   25
         3 001275   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 001276   000000 701000 xent               TSX1    VEX$FIND_MATCH
         3 001277   001301 702000 3                  TSX2    EXEC_P_RET

      575     2867    2              ALTRET (EXEC_P_RET);
      576     2868    2           GOTO EXEC_P_1;

   2868  3 001300   001157 710000 3                  TRA     EXEC_P_1

      577     2869    2           END;
      578     2870        /**/
      579     2871    1   EXEC_P_RET:
      580     2872    1        RETURN;

   2872  3 001301   000000 702200 xent  EXEC_P_RET   TSX2  ! X66_ARET

      581     2873        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:93   
      582     2874        /**/
      583     2875    1   VEI$EXEC_QR: ENTRY ALTRET;

   2875  3 001302   000000 700200 xent  VEI$EXEC_QR  TSX0  ! X66_AUTO_0
         3 001303   000014 000000                    ZERO    12,0

      584     2876        /**/
      585     2877    1        P$ = PINCRW(CMD$,CMD$ -> CMD_CNTRLWD.OFFSET);

   2877  3 001304   000000 470400 xsym               LDP0    CMD$
         3 001305   000000 236100                    LDQ     0,,PR0
         3 001306   000011 772000                    QRL     9
         3 001307   000777 376007                    ANQ     511,DL
         3 001310   000022 736000                    QLS     18
         3 001311   000000 036000 xsym               ADLQ    CMD$
         3 001312   000000 756000 xsym               STQ     P$

      586     2878    2        DO WHILE (P$ -> CMD_CNTRLWD.FLAGS.ENDCT = FALSE);

   2878  3 001313   000000 471400 xsym               LDP1    P$
         3 001314   100000 234100                    SZN     0,,PR1
         3 001315   001332 604000 3                  TMI     s:2882

      587     2879    2           CMD$ = P$;

   2879  3 001316   000000 236000 xsym               LDQ     P$
         3 001317   000000 756000 xsym               STQ     CMD$

      588     2880    2           P$ = PINCRW(CMD$,CMD$ -> CMD_CNTRLWD.OFFSET);

   2880  3 001320   000000 470400 xsym               LDP0    CMD$
         3 001321   000000 236100                    LDQ     0,,PR0
         3 001322   000011 772000                    QRL     9
         3 001323   000777 376007                    ANQ     511,DL
         3 001324   000022 736000                    QLS     18
         3 001325   000000 036000 xsym               ADLQ    CMD$
         3 001326   000000 756000 xsym               STQ     P$
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:94   

      589     2881    2           END;

   2881  3 001327   000000 471400 xsym               LDP1    P$
         3 001330   100000 234100                    SZN     0,,PR1
         3 001331   001316 605000 3                  TPL     s:2879

      590     2882    1        RETURN;

   2882  3 001332   000000 702200 xent               TSX2  ! X66_ARET

      591     2883        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:95   
      592     2884        /**/
      593     2885    1   VEI$EXEC_R: ENTRY ALTRET;

   2885  3 001333   000000 700200 xent  VEI$EXEC_R   TSX0  ! X66_AUTO_0
         3 001334   000014 000000                    ZERO    12,0

      594     2886        /**/
      595     2887    1        P$ = PINCRW(CMD$,1);

   2887  3 001335   000000 236000 xsym               LDQ     CMD$
         3 001336   000001 036003                    ADLQ    1,DU
         3 001337   000000 756000 xsym               STQ     P$

      596     2888    1        TEMP_COUNT = CMD$ -> RL_CMD_TBL.SHIFT#;

   2888  3 001340   000000 470400 xsym               LDP0    CMD$
         3 001341   000003 235100                    LDA     3,,PR0
         3 001342   000000 755000 xsym               STA     TEMP_COUNT

      597     2889    1        CALL VEX$FIND_CLMN(P$,STR1_CLMN) ALTRET(EXEC_R_RET);

   2889  3 001343   000000 630400 4                  EPPR0   0
         3 001344   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001345   000000 701000 xent               TSX1    VEX$FIND_CLMN
         3 001346   001367 702000 3                  TSX2    EXEC_R_RET

      598     2890        /**/
      599     2891    1        IF (FLAGS.BPFLAG) THEN CALL VEX$MOVE_RIGHT(STR1_CLMN,TEMP_COUNT);

   2891  3 001347   000000 430000 xsym               FSZN    FLAGS
         3 001350   001356 605000 3                  TPL     s:2892

   2891  3 001351   000004 630400 4                  EPPR0   4
         3 001352   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001353   000000 701000 xent               TSX1    VEX$MOVE_RIGHT
         3 001354   000000 011000                    NOP     0
         3 001355   001362 710000 3                  TRA     s:2893
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:96   

      600     2892    1        ELSE CALL VEX$COMP_RIGHT(STR1_CLMN,TEMP_COUNT);

   2892  3 001356   000004 630400 4                  EPPR0   4
         3 001357   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001360   000000 701000 xent               TSX1    VEX$COMP_RIGHT
         3 001361   000000 011000                    NOP     0

      601     2893    1        FLAGS.TXFLAG = TRUE;               /* RECORD CHANGED                     */

   2893  3 001362   000040 236003                    LDQ     32,DU
         3 001363   000000 256000 xsym               ORSQ    FLAGS

      602     2894    1        STRCHG_COUNT = STRCHG_COUNT + 1;

   2894  3 001364   000000 235000 xsym               LDA     STRCHG_COUNT
         3 001365   000001 035007                    ADLA    1,DL
         3 001366   000000 755000 xsym               STA     STRCHG_COUNT

      603     2895        /**/
      604     2896    1   EXEC_R_RET:
      605     2897    1        RETURN;

   2897  3 001367   000000 702200 xent  EXEC_R_RET   TSX2  ! X66_ARET

      606     2898        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:97   
      607     2899        /**/
      608     2900    1   VEI$EXEC_RF: ENTRY ALTRET;

   2900  3 001370   000000 700200 xent  VEI$EXEC_RF  TSX0  ! X66_AUTO_0
         3 001371   000014 000000                    ZERO    12,0

      609     2901        /**/
      610     2902    1        IF (~FLAGS.RFFLAG) THEN            /* Only save BP on the first RFCMD */

   2902  3 001372   000000 236000 xsym               LDQ     FLAGS
         3 001373   000015 736000                    QLS     13
         3 001374   400000 376003                    ANQ     -131072,DU
         3 001375   400000 676003                    ERQ     -131072,DU
         3 001376   001404 600000 3                  TZE     s:2904

      611     2903    1           FLAGS.BPFLAG_SAV = FLAGS.BPFLAG ;

   2903  3 001377   000000 236000 xsym               LDQ     FLAGS
         3 001400   000005 736000                    QLS     5
         3 001401   000001 676000 xsym               ERQ     FLAGS+1
         3 001402   040000 376003                    ANQ     16384,DU
         3 001403   000001 656000 xsym               ERSQ    FLAGS+1

      612     2904    1        FLAGS.RFFLAG = TRUE;

   2904  3 001404   000020 236003                    LDQ     16,DU
         3 001405   000000 256000 xsym               ORSQ    FLAGS

      613     2905    1        IF (FLAGS.BPFLAG) THEN FLAGS.BPFLAG = FALSE;

   2905  3 001406   000000 430000 xsym               FSZN    FLAGS
         3 001407   001413 605000 3                  TPL     s:2906

   2905  3 001410   000044 236000 4                  LDQ     36
         3 001411   000000 356000 xsym               ANSQ    FLAGS
         3 001412   001415 710000 3                  TRA     s:2907

PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:98   
      614     2906    1        ELSE FLAGS.BPFLAG = TRUE;

   2906  3 001413   001000 236003                    LDQ     512,DU
         3 001414   000000 256000 xsym               ORSQ    FLAGS

      615     2907    1        RETURN;

   2907  3 001415   000000 702200 xent               TSX2  ! X66_ARET

      616     2908        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:99   
      617     2909        /**/
      618     2910    1   VEI$EXEC_RL: ENTRY ALTRET;

   2910  3 001416   000000 700200 xent  VEI$EXEC_RL  TSX0  ! X66_AUTO_0
         3 001417   000014 000000                    ZERO    12,0

      619     2911        /**/
      620     2912    2        IF (FLAGS.TXFLAG) THEN DO;

   2912  3 001420   000000 236000 xsym               LDQ     FLAGS
         3 001421   000040 316003                    CANQ    32,DU
         3 001422   001436 600000 3                  TZE     s:2919

      621     2913    2           FLAGS.TXFLAG = FALSE;

   2913  3 001423   000030 236000 4                  LDQ     24
         3 001424   000000 356000 xsym               ANSQ    FLAGS

      622     2914    2           FLAGS.RLFLAG = TRUE;

   2914  3 001425   004000 236007                    LDQ     2048,DL
         3 001426   000000 256000 xsym               ORSQ    FLAGS

      623     2915    2           CMD$ = CMD_BASE$;

   2915  3 001427   000000 236000 xsym               LDQ     CMD_BASE$
         3 001430   000000 756000 xsym               STQ     CMD$

      624     2916    2           CMD_CODE = CMD$ -> CMD_CNTRLWD.CMD_CODE;

   2916  3 001431   000000 470400 xsym               LDP0    CMD$
         3 001432   000000 236100                    LDQ     0,,PR0
         3 001433   000777 376007                    ANQ     511,DL
         3 001434   000000 756000 xsym               STQ     CMD_CODE

      625     2917    2           ALTRETURN;

PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:100  
   2917  3 001435   000000 702200 xent               TSX2  ! X66_AALT

      626     2918    2           END;
      627     2919    1        RETURN;

   2919  3 001436   000000 702200 xent               TSX2  ! X66_ARET

      628     2920        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:101  
      629     2921        /**/
      630     2922    1   VEI$EXEC_S: ENTRY ALTRET;

   2922  3 001437   000000 700200 xent  VEI$EXEC_S   TSX0  ! X66_AUTO_0
         3 001440   000014 000000                    ZERO    12,0

      631     2923        /**/
      632     2924    1        P$ = PINCRW(CMD$,1);

   2924  3 001441   000000 236000 xsym               LDQ     CMD$
         3 001442   000001 036003                    ADLQ    1,DU
         3 001443   000000 756000 xsym               STQ     P$

      633     2925    1        CALL VEX$FIND_CLMN(P$,STR1_CLMN) ALTRET(EXEC_S_RET);

   2925  3 001444   000000 630400 4                  EPPR0   0
         3 001445   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001446   000000 701000 xent               TSX1    VEX$FIND_CLMN
         3 001447   001746 702000 3                  TSX2    EXEC_S_RET

      634     2926    1        SSE_PARAM = CMD$ -> STR_CMD_TBL.SSE_PARAM;

   2926  3 001450   000000 470400 xsym               LDP0    CMD$
         3 001451   000000 100500                    MLR     fill='000'O
         3 001452   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         3 001453   000000 000010 xsym               ADSC9   SSE_PARAM                cn=0,n=8

      635     2927        /**/
      636     2928    1   EXEC_S_1:
      637     2929    1        CALL VEX$MAKE_STRING(STR_BUF,CMD$ -> STR_CMD_TBL.SSE_PARAM2.PTR$ -> STR$PARAM,

   2929  3 001454   000000 470400 xsym  EXEC_S_1     LDP0    CMD$
         3 001455   000004 471500                    LDP1    4,,PR0
         3 001456   000000 236000 xsym               LDQ     CMD$
         3 001457   000001 036003                    ADLQ    1,DU
         3 001460   200006 756100                    STQ     BLANK_REC+3,,AUTO
         3 001461   200005 451500                    STP1    BLANK_REC+2,,AUTO
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:102  
         3 001462   000035 236000 4                  LDQ     29
         3 001463   200004 756100                    STQ     BLANK_REC+1,,AUTO
         3 001464   200004 630500                    EPPR0   BLANK_REC+1,,AUTO
         3 001465   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 001466   000000 701000 xent               TSX1    VEX$MAKE_STRING
         3 001467   000000 011000                    NOP     0

      638     2930    1           CMD$ -> STR_CMD_TBL.SSE_PARAM);
      639     2931    1        TEMP_COUNT = 0;

   2931  3 001470   000000 450000 xsym               STZ     TEMP_COUNT

      640     2932    2        DO I = 0 TO SSE_PARAM.PTR$ -> STR$PARAM.COUNT - 1;

   2932  3 001471   000000 450000 xsym               STZ     I
         3 001472   001506 710000 3                  TRA     s:2935+3

      641     2933    2           TEMP_COUNT = TEMP_COUNT + SSE_PARAM.PTR$ ->

   2933  3 001473   000000 235000 xsym               LDA     I
         3 001474   000001 735000                    ALS     1
         3 001475   000001 470400 xsym               LDP0    SSE_PARAM+1
         3 001476   000002 471505                    LDP1    2,AL,PR0
         3 001477   100000 236100                    LDQ     0,,PR1
         3 001500   000033 772000                    QRL     27
         3 001501   000000 036000 xsym               ADLQ    TEMP_COUNT
         3 001502   000000 756000 xsym               STQ     TEMP_COUNT

      642     2934    2              STR$PARAM.STR.PTR$(I) -> STR$BUF.COUNT;
      643     2935    2           END;

   2935  3 001503   000000 235000 xsym               LDA     I
         3 001504   000001 035007                    ADLA    1,DL
         3 001505   000000 755000 xsym               STA     I
         3 001506   000001 470400 xsym               LDP0    SSE_PARAM+1
         3 001507   000000 236000 xsym               LDQ     I
         3 001510   000000 116100                    CMPQ    0,,PR0
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:103  
         3 001511   001473 602000 3                  TNC     s:2933

      644     2936    2        IF (TEMP_COUNT >= STR_BUF.COUNT) THEN DO; /* NEW STRING SMALLER       */

   2936  3 001512   000000 236000 xsym               LDQ     STR_BUF
         3 001513   000022 772000                    QRL     18
         3 001514   000000 116000 xsym               CMPQ    TEMP_COUNT
         3 001515   001517 600000 3                  TZE     s:2937
         3 001516   001604 603000 3                  TRC     s:2946

      645     2937    2           CALL INSERT(REC_BUF,STR1_CLMN,STR_BUF.COUNT,STR_BUF.TEXT);

   2937  3 001517   000000 620006                    EAX0    0,QL
         3 001520   000000 235000 xsym               LDA     STR1_CLMN
         3 001521   040045 100400                    MLR     fill='040'O
         3 001522   000000 402000 xsym               ADSC9   STR_BUF                  cn=2,n=1024
         3 001523   000000 000010 xsym               ADSC9   REC_BUF,A                cn=0,n=*X0

      646     2938    2           IF (FLAGS.BPFLAG) THEN CALL VEX$MOVE_LEFT(STR1_CLMN + TEMP_COUNT,

   2938  3 001524   000000 430000 xsym               FSZN    FLAGS
         3 001525   001552 605000 3                  TPL     s:2940

   2938  3 001526   000000 236000 xsym               LDQ     STR1_CLMN
         3 001527   000000 036000 xsym               ADLQ    TEMP_COUNT
         3 001530   000000 235000 xsym               LDA     STR_BUF
         3 001531   000022 771000                    ARL     18
         3 001532   200004 755100                    STA     BLANK_REC+1,,AUTO
         3 001533   200005 756100                    STQ     BLANK_REC+2,,AUTO
         3 001534   000000 236000 xsym               LDQ     TEMP_COUNT
         3 001535   200004 136100                    SBLQ    BLANK_REC+1,,AUTO
         3 001536   200005 235100                    LDA     BLANK_REC+2,,AUTO
         3 001537   200006 755100                    STA     BLANK_REC+3,,AUTO
         3 001540   200007 756100                    STQ     BLANK_REC+4,,AUTO
         3 001541   200007 631500                    EPPR1   BLANK_REC+4,,AUTO
         3 001542   200011 451500                    STP1    BLANK_REC+6,,AUTO
         3 001543   200006 633500                    EPPR3   BLANK_REC+3,,AUTO
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:104  
         3 001544   200010 453500                    STP3    BLANK_REC+5,,AUTO
         3 001545   200010 630500                    EPPR0   BLANK_REC+5,,AUTO
         3 001546   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001547   000000 701000 xent               TSX1    VEX$MOVE_LEFT
         3 001550   000000 011000                    NOP     0
         3 001551   001577 710000 3                  TRA     s:2943

      647     2939    2                 TEMP_COUNT - STR_BUF.COUNT);
      648     2940    2           ELSE CALL VEX$FIELD_LEFT(STR1_CLMN + TEMP_COUNT,

   2940  3 001552   000000 236000 xsym               LDQ     STR1_CLMN
         3 001553   000000 036000 xsym               ADLQ    TEMP_COUNT
         3 001554   000000 235000 xsym               LDA     STR_BUF
         3 001555   000022 771000                    ARL     18
         3 001556   200004 755100                    STA     BLANK_REC+1,,AUTO
         3 001557   200005 756100                    STQ     BLANK_REC+2,,AUTO
         3 001560   000000 236000 xsym               LDQ     TEMP_COUNT
         3 001561   200004 136100                    SBLQ    BLANK_REC+1,,AUTO
         3 001562   200005 235100                    LDA     BLANK_REC+2,,AUTO
         3 001563   200006 755100                    STA     BLANK_REC+3,,AUTO
         3 001564   200007 756100                    STQ     BLANK_REC+4,,AUTO
         3 001565   000027 236000 4                  LDQ     23
         3 001566   200012 756100                    STQ     BLANK_REC+7,,AUTO
         3 001567   200007 631500                    EPPR1   BLANK_REC+4,,AUTO
         3 001570   200011 451500                    STP1    BLANK_REC+6,,AUTO
         3 001571   200006 633500                    EPPR3   BLANK_REC+3,,AUTO
         3 001572   200010 453500                    STP3    BLANK_REC+5,,AUTO
         3 001573   200010 630500                    EPPR0   BLANK_REC+5,,AUTO
         3 001574   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 001575   000000 701000 xent               TSX1    VEX$FIELD_LEFT
         3 001576   000000 011000                    NOP     0

      649     2941    2                 TEMP_COUNT - STR_BUF.COUNT,0);
      650     2942        /**/
      651     2943    2           STR1_CLMN = STR1_CLMN + STR_BUF.COUNT;

   2943  3 001577   000000 236000 xsym               LDQ     STR_BUF
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:105  
         3 001600   000022 772000                    QRL     18
         3 001601   000000 036000 xsym               ADLQ    STR1_CLMN
         3 001602   000000 756000 xsym               STQ     STR1_CLMN

      652     2944    2           END;

   2944  3 001603   001674 710000 3                  TRA     s:2955

      653     2945    2        ELSE DO;                           /* NEW STRING LARGER                  */

      654     2946    2           IF (FLAGS.BPFLAG) THEN CALL VEX$MOVE_RIGHT(STR1_CLMN+TEMP_COUNT,

   2946  3 001604   000000 430000 xsym               FSZN    FLAGS
         3 001605   001630 605000 3                  TPL     s:2948

   2946  3 001606   000000 236000 xsym               LDQ     STR1_CLMN
         3 001607   000000 036000 xsym               ADLQ    TEMP_COUNT
         3 001610   200004 756100                    STQ     BLANK_REC+1,,AUTO
         3 001611   000000 236000 xsym               LDQ     STR_BUF
         3 001612   000022 772000                    QRL     18
         3 001613   000000 136000 xsym               SBLQ    TEMP_COUNT
         3 001614   200004 235100                    LDA     BLANK_REC+1,,AUTO
         3 001615   200005 755100                    STA     BLANK_REC+2,,AUTO
         3 001616   200006 756100                    STQ     BLANK_REC+3,,AUTO
         3 001617   200006 631500                    EPPR1   BLANK_REC+3,,AUTO
         3 001620   200011 451500                    STP1    BLANK_REC+6,,AUTO
         3 001621   200005 633500                    EPPR3   BLANK_REC+2,,AUTO
         3 001622   200010 453500                    STP3    BLANK_REC+5,,AUTO
         3 001623   200010 630500                    EPPR0   BLANK_REC+5,,AUTO
         3 001624   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001625   000000 701000 xent               TSX1    VEX$MOVE_RIGHT
         3 001626   000000 011000                    NOP     0
         3 001627   001651 710000 3                  TRA     s:2950

      655     2947    2                 STR_BUF.COUNT - TEMP_COUNT );
      656     2948    2           ELSE CALL VEX$COMP_RIGHT(STR1_CLMN+TEMP_COUNT,STR_BUF.COUNT - TEMP_COUNT);

PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:106  
   2948  3 001630   000000 236000 xsym               LDQ     STR1_CLMN
         3 001631   000000 036000 xsym               ADLQ    TEMP_COUNT
         3 001632   200004 756100                    STQ     BLANK_REC+1,,AUTO
         3 001633   000000 236000 xsym               LDQ     STR_BUF
         3 001634   000022 772000                    QRL     18
         3 001635   000000 136000 xsym               SBLQ    TEMP_COUNT
         3 001636   200004 235100                    LDA     BLANK_REC+1,,AUTO
         3 001637   200005 755100                    STA     BLANK_REC+2,,AUTO
         3 001640   200006 756100                    STQ     BLANK_REC+3,,AUTO
         3 001641   200006 631500                    EPPR1   BLANK_REC+3,,AUTO
         3 001642   200011 451500                    STP1    BLANK_REC+6,,AUTO
         3 001643   200005 633500                    EPPR3   BLANK_REC+2,,AUTO
         3 001644   200010 453500                    STP3    BLANK_REC+5,,AUTO
         3 001645   200010 630500                    EPPR0   BLANK_REC+5,,AUTO
         3 001646   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001647   000000 701000 xent               TSX1    VEX$COMP_RIGHT
         3 001650   000000 011000                    NOP     0

      657     2949        /**/
      658     2950    2           IF (STR1_CLMN + STR_BUF.COUNT > MAX_CLMN) THEN

   2950  3 001651   000000 236000 xsym               LDQ     STR_BUF
         3 001652   000022 772000                    QRL     18
         3 001653   000000 036000 xsym               ADLQ    STR1_CLMN
         3 001654   000000 116000 xsym               CMPQ    MAX_CLMN
         3 001655   001663 602000 3                  TNC     s:2952
         3 001656   001663 600000 3                  TZE     s:2952

      659     2951    2              STR_BUF.COUNT = MAX_CLMN - STR1_CLMN;

   2951  3 001657   000000 236000 xsym               LDQ     MAX_CLMN
         3 001660   000000 136000 xsym               SBLQ    STR1_CLMN
         3 001661   000000 620006                    EAX0    0,QL
         3 001662   000000 740000 xsym               STX0    STR_BUF

      660     2952    2           CALL INSERT(REC_BUF,STR1_CLMN,STR_BUF.COUNT,STR_BUF.TEXT);

PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:107  
   2952  3 001663   000000 220000 xsym               LDX0    STR_BUF
         3 001664   000000 235000 xsym               LDA     STR1_CLMN
         3 001665   040045 100400                    MLR     fill='040'O
         3 001666   000000 402000 xsym               ADSC9   STR_BUF                  cn=2,n=1024
         3 001667   000000 000010 xsym               ADSC9   REC_BUF,A                cn=0,n=*X0

      661     2953    2           STR1_CLMN = STR1_CLMN + STR_BUF.COUNT;

   2953  3 001670   000000 236000 xsym               LDQ     STR_BUF
         3 001671   000022 772000                    QRL     18
         3 001672   000000 036000 xsym               ADLQ    STR1_CLMN
         3 001673   000000 756000 xsym               STQ     STR1_CLMN

      662     2954    2           END;

      663     2955    1        FLAGS.TXFLAG = TRUE;               /* RECORD CHANGED                     */

   2955  3 001674   000040 236003                    LDQ     32,DU
         3 001675   000000 256000 xsym               ORSQ    FLAGS

      664     2956    1        STRCHG_COUNT = STRCHG_COUNT + 1;

   2956  3 001676   000000 235000 xsym               LDA     STRCHG_COUNT
         3 001677   000001 035007                    ADLA    1,DL
         3 001700   000000 755000 xsym               STA     STRCHG_COUNT

      665     2957        /**/
      666     2958    2        IF ((~SSE_PARAM.FLAGS.CLMNFLAG)AND(SSE_PARAM.J = 0)) THEN DO;

   2958  3 001701   000000 236000 xsym               LDQ     SSE_PARAM
         3 001702   400000 376003                    ANQ     -131072,DU
         3 001703   400000 676003                    ERQ     -131072,DU
         3 001704   001746 600000 3                  TZE     EXEC_S_RET
         3 001705   000000 720000 xsym               LXL0    SSE_PARAM
         3 001706   001746 601000 3                  TNZ     EXEC_S_RET

      667     2959        /**/
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:108  
      668     2960    2           IF (SSE_PARAM.PTR$ -> STR$PARAM.COUNT = 1) THEN /* CHECK FOR '0/ /S//' */

   2960  3 001707   000001 470400 xsym               LDP0    SSE_PARAM+1
         3 001710   000000 235100                    LDA     0,,PR0
         3 001711   000001 115007                    CMPA    1,DL
         3 001712   001741 601000 3                  TNZ     s:2969

      669     2961    2              IF (SUBSTR(SSE_PARAM.PTR$ -> STR$PARAM.STR.PTR$(0) -> STR$BUF.TEXT,0,

   2961  3 001713   000002 471500                    LDP1    2,,PR0
         3 001714   100000 236100                    LDQ     0,,PR1
         3 001715   000033 772000                    QRL     27
         3 001716   000000 621006                    EAX1    0,QL
         3 001717   040000 106540                    CMPC    fill='040'O
         3 001720   100000 200011                    ADSC9   0,,PR1                   cn=1,n=*X1
         3 001721   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001722   001741 601000 3                  TNZ     s:2969
         3 001723   000000 221000 xsym               LDX1    STR_BUF
         3 001724   001741 601000 3                  TNZ     s:2969

      670     2962    2                 SSE_PARAM.PTR$ -> STR$PARAM.STR.PTR$(0) -> STR$BUF.COUNT) = ' ')AND
      671     2963    3                 (STR_BUF.COUNT = 0) THEN DO;

      672     2964    3                 IF NOT(FLAGS.BPFLAG) THEN RETURN; /* GET OUT IF BP OFF       */

   2964  3 001725   000000 430000 xsym               FSZN    FLAGS
         3 001726   001730 604000 3                  TMI     s:2965

   2964  3 001727   000000 702200 xent               TSX2  ! X66_ARET

      673     2965    3                 IF (SUBSTR(REC_BUF,STR1_CLMN,(SIZEC(REC_BUF)-STR1_CLMN)) = ' ')

   2965  3 001730   000000 722000 xsym               LXL2    STR1_CLMN
         3 001731   775777 622012                    EAX2    -1025,X2
         3 001732   777777 662003                    ERX2    -1,DU
         3 001733   000000 236000 xsym               LDQ     STR1_CLMN
         3 001734   040000 106446                    CMPC    fill='040'O
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:109  
         3 001735   000000 000012 xsym               ADSC9   REC_BUF,Q                cn=0,n=*X2
         3 001736   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001737   001741 601000 3                  TNZ     s:2969

      674     2966    3                 THEN RETURN;              /* MAKE SURE DONE                     */

   2966  3 001740   000000 702200 xent               TSX2  ! X66_ARET

      675     2967    3                 END;
      676     2968        /**/
      677     2969    2           CALL VEX$FIND_MATCH(P$,STR1_CLMN,HI_EXEC_CLMN,STR1_CLMN)

   2969  3 001741   000031 630400 4                  EPPR0   25
         3 001742   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 001743   000000 701000 xent               TSX1    VEX$FIND_MATCH
         3 001744   001746 702000 3                  TSX2    EXEC_S_RET

      678     2970    2              ALTRET(EXEC_S_RET);
      679     2971    2           GOTO EXEC_S_1;

   2971  3 001745   001454 710000 3                  TRA     EXEC_S_1

      680     2972    2           END;
      681     2973        /**/
      682     2974    1   EXEC_S_RET:
      683     2975    1        RETURN;

   2975  3 001746   000000 702200 xent  EXEC_S_RET   TSX2  ! X66_ARET

      684     2976        %EJECT;
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:110  
      685     2977        /**/
      686     2978    1   VEI$EXEC_TX: ENTRY ALTRET;

   2978  3 001747   000000 700200 xent  VEI$EXEC_TX  TSX0  ! X66_AUTO_0
         3 001750   000014 000000                    ZERO    12,0

      687     2979        /**/
      688     2980    1        IF (~FLAGS.TXFLAG) THEN RETURN;    /* NOTHING CHANGED                    */

   2980  3 001751   000000 236000 xsym               LDQ     FLAGS
         3 001752   000014 736000                    QLS     12
         3 001753   400000 376003                    ANQ     -131072,DU
         3 001754   400000 676003                    ERQ     -131072,DU
         3 001755   001757 600000 3                  TZE     s:2981

   2980  3 001756   000000 702200 xent               TSX2  ! X66_ARET

      689     2981    1        CALL VEX$SEQNUM_TEXT(LAST_KEY);

   2981  3 001757   000016 630400 4                  EPPR0   14
         3 001760   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001761   000000 701000 xent               TSX1    VEX$SEQNUM_TEXT
         3 001762   000000 011000                    NOP     0

      690     2982    1        CALL CONCAT(TYPE_BUF.TEXT,SEQ_TEXT_BUF,' ',SUBSTR(REC_BUF,0,REC_SIZE));

   2982  3 001763   040000 100400                    MLR     fill='040'O
         3 001764   000000 000011 xsym               ADSC9   SEQ_TEXT_BUF             cn=0,n=9
         3 001765   000000 200011 xsym               ADSC9   TYPE_BUF                 cn=1,n=9
         3 001766   040000 236007                    LDQ     16384,DL
         3 001767   000002 552010 xsym               STBQ    TYPE_BUF+2,'10'O
         3 001770   000000 720000 xsym               LXL0    REC_SIZE
         3 001771   040000 100440                    MLR     fill='040'O
         3 001772   000000 000010 xsym               ADSC9   REC_BUF                  cn=0,n=*X0
         3 001773   000002 602072 xsym               ADSC9   TYPE_BUF+2               cn=3,n=1082

      691     2983    1        CALL VEX$TYPE_REC(TYPECR);
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:111  

   2983  3 001774   000013 630400 4                  EPPR0   11
         3 001775   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001776   000000 701000 xent               TSX1    VEX$TYPE_REC
         3 001777   000000 011000                    NOP     0

      692     2984    1        RETURN;

   2984  3 002000   000000 702200 xent               TSX2  ! X66_ARET
      693     2985    1   END;                                    /* END VEI$INTCMD                     */

PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:112  
--  Include file information  --

   VE_FLAGS_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   VE_PERR_C.:E05TOU  is referenced.
   VE_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VEI$INTCMD.
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:113  

 **** Variables and constants ****

  ****  Section 001 RoData VEI$INTCMD

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(360)   r     1 CP_PREC_FPT               12-0-0/d STRC(360)   r     1 PREC_FWD_FPT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/b BIT         r     1 BLANK_REC

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CMD$                       0-0-0/w PTR         r     1 CMD_BASE$
     0-0-0/w UBIN        r     1 CMD_CODE                   0-0-0/w UBIN        r     1 CP_DFLT_INCR
     0-0-0/w UBIN        r     1 CP_LIMIT_SEQNUM            0-0-0/w UBIN        r     1 CP_RECSMVED
     0-0-0/w UBIN        r     1 CP_SEQNUM                  0-0-0/w UBIN        r     1 EXEC_SEQNUM
     0-0-0/b STRC(72)    r     1 FLAGS                      0-0-0/w UBIN        r     1 HI_EXEC_CLMN
     0-0-0/w UBIN        r     1 I                          0-0-0/w UBIN        r     1 IF_LEVEL
     0-0-0/w UBIN        r     1 LAST_KEY                   0-0-0/w UBIN        r     1 M$FILE_NUM
     0-0-0/w UBIN        r     1 MAX_CLMN                   0-0-0/w UBIN        r     1 MAX_SEQNUM
     0-0-0/w PTR         r     1 P$                         0-0-0/c CHAR(1024)  r     1 REC_BUF
     0-0-0/w UBIN        r     1 REC_SIZE                   0-0-0/c CHAR(9)     r     1 SEQ_TEXT_BUF
     0-0-0/b STRC(72)    r     1 SSE_PARAM                  0-0-0/w UBIN        r     1 STR1_CLMN
     0-0-0/w UBIN        r     1 STR2_CLMN                  0-0-0/w UBIN        r     1 STRCHG_COUNT
     0-0-0/h STRC(9234)  r     1 STR_BUF                    0-0-0/c STRC(288)   r     1 SUB_BUF_1
     0-0-0/c STRC(288)   r     1 SUB_BUF_2                  0-0-0/w UBIN        r     1 TEMP_CLMN
     0-0-0/w UBIN        r     1 TEMP_COUNT                 0-0-0/w UBIN        r     1 TEMP_IF_LEVEL
     0-0-0/w UBIN        r     1 TEMP_STRCHG_COUNT          0-0-0/c STRC(9837)  r     1 TYPE_BUF
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:114  

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 CMD_CNTRLWD                0-0-0/w STRC(144)   r     1 CP_CMD_TBL
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(612)   r     1 JU_CMD_TBL
     0-0-0N  NULL        r     1 M$FILE                     0-0-0/w STRC(144)   r     1 RL_CMD_TBL
     0-0-0/w STRC(72)    r     1 SSE$PARAM                  0-0-0/w STRC(2304)  r     1 STR$BUF
     0-0-0/w STRC(108)   r     1 STR$PARAM                  0-0-0/w STRC(180)   r     1 STR_CMD_TBL


   Procedure VEI$INTCMD requires 1025 words for executable code.
   Procedure VEI$INTCMD requires 12 words of local(AUTO) storage.

    No errors detected in file VEI$INTCMD.:E05TSI    .
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:115  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:116  
          MINI XREF LISTING

BLANK_REC
      2544**DCL      2626<<ASSIGN   2628<<ASSIGN   2643>>IF
CMD$
      2521**DCL      2552>>ASSIGN   2582>>ASSIGN   2583>>IF       2585>>ASSIGN   2586>>ASSIGN   2613>>ASSIGN
      2614>>ASSIGN   2629>>ASSIGN   2632>>ASSIGN   2685>>ASSIGN   2686>>ASSIGN   2690>>CALL     2690>>CALL
      2733>>DOWHILE  2735>>IF       2735>>IF       2737>>IF       2739>>IF       2741<<ASSIGN   2741>>ASSIGN
      2741>>ASSIGN   2748>>ASSIGN   2749>>ASSIGN   2753>>CALL     2753>>CALL     2795>>ASSIGN   2808>>ASSIGN
      2809>>ASSIGN   2836>>ASSIGN   2837>>ASSIGN   2841>>CALL     2841>>CALL     2877>>ASSIGN   2877>>ASSIGN
      2879<<ASSIGN   2880>>ASSIGN   2880>>ASSIGN   2887>>ASSIGN   2888>>ASSIGN   2915<<ASSIGN   2916>>ASSIGN
      2924>>ASSIGN   2926>>ASSIGN   2929>>CALL     2929>>CALL
CMD_BASE$
      2522**DCL      2915>>ASSIGN
CMD_CNTRLWD.CMD_CODE
      2288**DCL      2733>>DOWHILE  2737>>IF       2739>>IF       2916>>ASSIGN
CMD_CNTRLWD.FLAGS.ENDCT
      2285**DCL      2735>>IF       2878>>DOWHILE
CMD_CNTRLWD.OFFSET
      2287**DCL      2735>>IF       2741>>ASSIGN   2877>>ASSIGN   2880>>ASSIGN
CMD_CODE
      2508**DCL      2708>>IF       2916<<ASSIGN
CP_CMD_TBL.INCR
      2382**DCL      2582>>ASSIGN   2614<<ASSIGN
CP_CMD_TBL.LIMIT_SEQNUM
      2381**DCL      2586>>ASSIGN
CP_CMD_TBL.SEQNUM
      2380**DCL      2583>>IF       2585>>ASSIGN   2613<<ASSIGN
CP_DFLT_INCR
      2495**DCL      2582<<ASSIGN   2584>>ASSIGN   2585>>ASSIGN   2614>>ASSIGN
CP_LIMIT_SEQNUM
      2494**DCL      2586<<ASSIGN   2590<<ASSIGN   2597>>IF       2598<>CALL     2601<<ASSIGN   2618<<ASSIGN
CP_PREC_FPT
      2244**DCL      2610<>CALL
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:117  
CP_PREC_FPT.V
      2246**DCL      2244--DCLINIT
CP_RECSMVED
      2496**DCL      2612<<ASSIGN   2612>>ASSIGN
CP_SEQNUM
      2493**DCL      2584<<ASSIGN   2584>>ASSIGN   2585<<ASSIGN   2588>>IF       2597>>IF       2609<>CALL
      2613>>ASSIGN
EXEC_A_RET
      2577**LABEL    2553--CALLALT  2562--CALLALT
EXEC_CP_ERR
      2618**LABEL    2609--CALLALT  2610--CALLALT  2611--CALLALT
EXEC_D_1
      2641**LABEL    2676--GOTO
EXEC_D_QM
      2634**LABEL    2674--GOTO
EXEC_D_RET
      2680**LABEL    2631--CALLALT  2668--CALLALT
EXEC_E_1
      2690**LABEL    2717--GOTO
EXEC_E_RET
      2721**LABEL    2687--CALLALT  2715--CALLALT
EXEC_F_1
      2753**LABEL    2781--GOTO
EXEC_F_RET
      2785**LABEL    2750--CALLALT  2771--GOTO     2779--CALLALT
EXEC_JU_ERR
      2801**LABEL    2797--CALLALT
EXEC_L_RET
      2825**LABEL    2807--GOTO     2810--CALLALT
EXEC_P_1
      2841**LABEL    2868--GOTO
EXEC_P_RET
      2872**LABEL    2838--CALLALT  2866--CALLALT
EXEC_R_RET
      2897**LABEL    2889--CALLALT
EXEC_SEQNUM
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:118  
      2491**DCL      2795<<ASSIGN   2797<>CALL
EXEC_S_1
      2929**LABEL    2971--GOTO
EXEC_S_RET
      2975**LABEL    2925--CALLALT  2969--CALLALT
F$DCB.ACTPOS
       992**DCL       992--REDEF
F$DCB.ARS
       967**DCL       967--REDEF
F$DCB.ATTR
       985**DCL       986--REDEF
F$DCB.BORROW
      1000**DCL      1000--REDEF    1000--REDEF    1000--REDEF
F$DCB.DCBNAME.L
      1014**DCL      1014--IMP-SIZ
F$DCB.EOMCHAR
       971**DCL       971--REDEF
F$DCB.FLDID
       995**DCL       995--REDEF
F$DCB.FORM$
       989**DCL       989--REDEF
F$DCB.FSECT
      1005**DCL      1005--REDEF
F$DCB.FSN
       982**DCL       982--REDEF     982--REDEF     983--REDEF
F$DCB.HEADER$
       988**DCL       988--REDEF
F$DCB.IXTNSIZE
       986**DCL       986--REDEF
F$DCB.LASTSTA$
       976**DCL       976--REDEF
F$DCB.LVL
      1001**DCL      1001--REDEF
F$DCB.NAME.C
       976**DCL       976--REDEF
F$DCB.NOEOF
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:119  
       997**DCL       997--REDEF
F$DCB.NRECS
       987**DCL       987--REDEF
F$DCB.NRECX
      1006**DCL      1006--REDEF
F$DCB.OHDR
       998**DCL       998--REDEF
F$DCB.ORG
       981**DCL       981--REDEF
F$DCB.PRECNO
      1004**DCL      1004--REDEF
F$DCB.RCSZ
      1009**DCL      1009--REDEF
F$DCB.RES
       977**DCL       977--REDEF
F$DCB.SETX
       989**DCL       989--REDEF
F$DCB.TAB$
       988**DCL       989--REDEF
F$DCB.TDA
      1003**DCL      1003--REDEF
F$DCB.WSN
       978**DCL       978--REDEF
FLAGS.BPFLAG
      2434**DCL      2566>>IF       2571>>IF       2641>>IF       2663>>IF       2772>>IF       2819>>IF
      2844>>IF       2891>>IF       2903>>ASSIGN   2905>>IF       2905<<ASSIGN   2906<<ASSIGN   2938>>IF
      2946>>IF       2964>>IF
FLAGS.BPFLAG_SAV
      2465**DCL      2903<<ASSIGN
FLAGS.NOFLAG
      2451**DCL      2830<<ASSIGN
FLAGS.RFFLAG
      2439**DCL      2902>>IF       2904<<ASSIGN
FLAGS.RLFLAG
      2450**DCL      2914<<ASSIGN
FLAGS.TXFLAG
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:120  
      2438**DCL      2574<<ASSIGN   2647<<ASSIGN   2653<<ASSIGN   2705<<ASSIGN   2775<<ASSIGN   2790>>IF
      2791<<ASSIGN   2821<<ASSIGN   2857<<ASSIGN   2893<<ASSIGN   2912>>IF       2913<<ASSIGN   2955<<ASSIGN
      2980>>IF
HI_EXEC_CLMN
      2488**DCL      2668<>CALL     2670>>IF       2709>>IF       2710>>CALLBLT  2715<>CALL     2779<>CALL
      2866<>CALL     2969<>CALL
I
      2516**DCL      2556<<DOINDEX  2557>>ASSIGN   2635<<DOINDEX  2636>>ASSIGN   2672<<DOINDEX  2673>>IF
      2756<<DOINDEX  2757>>ASSIGN   2813<<DOINDEX  2814>>ASSIGN   2862<<DOINDEX  2863>>ASSIGN   2932<<DOINDEX
      2933>>ASSIGN
IF_LEVEL
      2514**DCL      2731>>ASSIGN   2733>>DOWHILE
JU_CMD_TBL.EDITKEY.SEQNUM
      2362**DCL      2795>>ASSIGN
JU_CMD_TBL.HELPKEY
      2360**DCL      2361--REDEF
LAST_KEY
      2499**DCL      2244--DCLINIT  2245--DCLINIT  2599<>CALL     2792<>CALL     2981<>CALL
M$FILE_NUM
      2517**DCL      2609<>CALL     2792<>CALL
M$PRECORD
      1028**DCL-ENT  2610--CALL     2611--CALL
MAX_CLMN
      2537**DCL      2692>>IF       2694>>ASSIGN   2760>>IF       2762>>ASSIGN   2847>>IF       2849>>ASSIGN
      2950>>IF       2951>>ASSIGN
MAX_SEQNUM
      2536**DCL      2588>>IF
P$
      2520**DCL      2552<<ASSIGN   2553<>CALL     2555>>IF       2556>>DOINDEX  2557>>ASSIGN   2561<<ASSIGN
      2561>>ASSIGN   2562<>CALL     2629<<ASSIGN   2631<>CALL     2668<>CALL     2685<<ASSIGN   2687<>CALL
      2715<>CALL     2748<<ASSIGN   2750<>CALL     2779<>CALL     2808<<ASSIGN   2810<>CALL     2812>>IF
      2813>>DOINDEX  2814>>ASSIGN   2836<<ASSIGN   2838<>CALL     2866<>CALL     2877<<ASSIGN   2878>>DOWHILE
      2879>>ASSIGN   2880<<ASSIGN   2887<<ASSIGN   2889<>CALL     2924<<ASSIGN   2925<>CALL     2969<>CALL
PREC_FWD_FPT
      2269**DCL      2611<>CALL
PREC_FWD_FPT.V
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:121  
      2271**DCL      2269--DCLINIT
REC_BUF
      2469**DCL      2624>>IF       2664>>IF       2664--IF       2700<<CALLBLT  2710<<CALLBLT  2774<<CALLBLT
      2806>>IF       2856<<CALLBLT  2937<<CALLBLT  2952<<CALLBLT  2965>>IF       2965--IF       2982>>CALLBLT
REC_SIZE
      2484**DCL      2624>>IF       2702>>IF       2703<<ASSIGN   2806>>IF       2982>>CALLBLT
RL_CMD_TBL.SHIFT#
      2357**DCL      2809>>ASSIGN   2888>>ASSIGN
SEQ_TEXT_BUF
      2483**DCL      2982>>CALLBLT
SSE$PARAM.FLAGS.CLMNFLAG
      2291**DCL      2555>>IF       2812>>IF
SSE$PARAM.PTR$
      2299**DCL      2556>>DOINDEX  2557>>ASSIGN   2813>>DOINDEX  2814>>ASSIGN
SSE_PARAM
      2526**DCL      2632<<ASSIGN   2686<<ASSIGN   2749<<ASSIGN   2837<<ASSIGN   2926<<ASSIGN
SSE_PARAM.FLAGS.CLMNFLAG
      2528**DCL      2658>>IF       2714>>IF       2755>>IF       2777>>IF       2860>>IF       2958>>IF
SSE_PARAM.J
      2534**DCL      2658>>IF       2714>>IF       2769>>IF       2777>>IF       2860>>IF       2958>>IF
SSE_PARAM.PTR$
      2535**DCL      2635>>DOINDEX  2636>>ASSIGN   2643>>IF       2643>>IF       2660>>IF       2661>>IF
      2661>>IF       2672>>DOINDEX  2673>>IF       2756>>DOINDEX  2757>>ASSIGN   2862>>DOINDEX  2863>>ASSIGN
      2932>>DOINDEX  2933>>ASSIGN   2960>>IF       2961>>IF       2961>>IF
STR$BUF.COUNT
      2301**DCL      2557>>ASSIGN   2636>>ASSIGN   2643>>IF       2661>>IF       2757>>ASSIGN   2814>>ASSIGN
      2863>>ASSIGN   2933>>ASSIGN   2961>>IF
STR$BUF.TEXT
      2302**DCL      2643>>IF       2661>>IF       2961>>IF
STR$PARAM
      2303**DCL      2690<>CALL     2753<>CALL     2841<>CALL     2929<>CALL
STR$PARAM.COUNT
      2304**DCL      2556>>DOINDEX  2635>>DOINDEX  2660>>IF       2672>>DOINDEX  2756>>DOINDEX  2813>>DOINDEX
      2862>>DOINDEX  2932>>DOINDEX  2960>>IF
STR$PARAM.STR.PTR$
      2309**DCL      2557>>ASSIGN   2636>>ASSIGN   2643>>IF       2643>>IF       2661>>IF       2661>>IF
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:122  
      2757>>ASSIGN   2814>>ASSIGN   2863>>ASSIGN   2933>>ASSIGN   2961>>IF       2961>>IF
STR$PARAM.STR.QM
      2306**DCL      2673>>IF
STR1_CLMN
      2506**DCL      2553<>CALL     2564>>IF       2565>>ASSIGN   2566<>CALL     2567<>CALL     2569>>IF
      2570>>ASSIGN   2571<>CALL     2572<>CALL     2631<>CALL     2641>>CALL     2642>>CALL     2664>>IF
      2664>>IF       2668<>CALL     2668<>CALL     2670>>IF       2687<>CALL     2692>>IF       2694>>ASSIGN
      2700>>CALLBLT  2702>>IF       2703>>ASSIGN   2707<<ASSIGN   2707>>ASSIGN   2709>>IF       2710>>CALLBLT
      2710>>CALLBLT  2715<>CALL     2715<>CALL     2750<>CALL     2755<<ASSIGN   2755>>ASSIGN   2757<<ASSIGN
      2757>>ASSIGN   2760>>IF       2762>>ASSIGN   2772<>CALL     2773<>CALL     2774>>CALLBLT  2778<<ASSIGN
      2778>>ASSIGN   2779<>CALL     2779<>CALL     2810<>CALL     2819<>CALL     2820<>CALL     2838<>CALL
      2844<>CALL     2845<>CALL     2847>>IF       2849>>ASSIGN   2856>>CALLBLT  2861<<ASSIGN   2861>>ASSIGN
      2863<<ASSIGN   2863>>ASSIGN   2866<>CALL     2866<>CALL     2889<>CALL     2891<>CALL     2892<>CALL
      2925<>CALL     2937>>CALLBLT  2938>>CALL     2940>>CALL     2943<<ASSIGN   2943>>ASSIGN   2946>>CALL
      2948>>CALL     2950>>IF       2951>>ASSIGN   2952>>CALLBLT  2953<<ASSIGN   2953>>ASSIGN   2965>>IF
      2965>>IF       2969<>CALL     2969<>CALL
STR2_CLMN
      2507**DCL      2562<>CALL     2564>>IF       2565>>ASSIGN   2569>>IF       2570>>ASSIGN
STRCHG_COUNT
      2512**DCL      2575<<ASSIGN   2575>>ASSIGN   2654<<ASSIGN   2654>>ASSIGN   2706<<ASSIGN   2706>>ASSIGN
      2776<<ASSIGN   2776>>ASSIGN   2822<<ASSIGN   2822>>ASSIGN   2858<<ASSIGN   2858>>ASSIGN   2894<<ASSIGN
      2894>>ASSIGN   2956<<ASSIGN   2956>>ASSIGN
STR_BUF
      2480**DCL      2690<>CALL     2753<>CALL     2841<>CALL     2929<>CALL
STR_BUF.COUNT
      2481**DCL      2692>>IF       2694<<ASSIGN   2700>>CALLBLT  2702>>IF       2703>>ASSIGN   2707>>ASSIGN
      2760>>IF       2762<<ASSIGN   2768>>ASSIGN   2774>>CALLBLT  2778>>ASSIGN   2843>>ASSIGN   2847>>IF
      2849<<ASSIGN   2856>>CALLBLT  2861>>ASSIGN   2936>>IF       2937>>CALLBLT  2938>>CALL     2940>>CALL
      2943>>ASSIGN   2946>>CALL     2948>>CALL     2950>>IF       2951<<ASSIGN   2952>>CALLBLT  2953>>ASSIGN
      2961>>IF
STR_BUF.TEXT
      2482**DCL      2700>>CALLBLT  2774>>CALLBLT  2856>>CALLBLT  2937>>CALLBLT  2952>>CALLBLT
STR_CMD_TBL.SSE_PARAM
      2313**DCL      2632>>ASSIGN   2686>>ASSIGN   2690<>CALL     2749>>ASSIGN   2753<>CALL     2837>>ASSIGN
      2841<>CALL     2926>>ASSIGN   2929<>CALL
STR_CMD_TBL.SSE_PARAM2.PTR$
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:123  
      2332**DCL      2690>>CALL     2753>>CALL     2841>>CALL     2929>>CALL
SUB_BUF_1
      2474**DCL      2598<>CALL
SUB_BUF_2
      2477**DCL      2599<>CALL
TEMP_CLMN
      2503**DCL      2554<<ASSIGN   2557<<ASSIGN   2557>>ASSIGN   2567<>CALL     2811<<ASSIGN   2814<<ASSIGN
      2814>>ASSIGN   2820<>CALL
TEMP_COUNT
      2504**DCL      2565<<ASSIGN   2566<>CALL     2567<>CALL     2570<<ASSIGN   2571<>CALL     2572<>CALL
      2634<<ASSIGN   2636<<ASSIGN   2636>>ASSIGN   2641>>CALL     2641<>CALL     2642>>CALL     2642<>CALL
      2768<<ASSIGN   2769>>IF       2772<>CALL     2773<>CALL     2809<<ASSIGN   2819<>CALL     2820<>CALL
      2843<<ASSIGN   2844<>CALL     2845<>CALL     2888<<ASSIGN   2891<>CALL     2892<>CALL     2931<<ASSIGN
      2933<<ASSIGN   2933>>ASSIGN   2936>>IF       2938>>CALL     2938>>CALL     2940>>CALL     2940>>CALL
      2946>>CALL     2946>>CALL     2948>>CALL     2948>>CALL
TEMP_IF_LEVEL
      2515**DCL      2731<<ASSIGN   2733>>DOWHILE  2738<<ASSIGN   2738>>ASSIGN   2740<<ASSIGN   2740>>ASSIGN
TEMP_STRCHG_COUNT
      2505**DCL      2630<<ASSIGN   2655<<ASSIGN   2655>>ASSIGN   2670>>IF
TYPE_BUF.TEXT
      2473**DCL      2982<<CALLBLT
VEX$COMP_RIGHT
      2398**DCL-ENT  2572--CALL     2773--CALL     2845--CALL     2892--CALL     2948--CALL
VEX$ERROR
      2392**DCL-ENT  2589--CALL     2600--CALL     2693--CALL     2761--CALL     2848--CALL
VEX$FIELD_LEFT
      2396**DCL-ENT  2567--CALL     2642--CALL     2820--CALL     2940--CALL
VEX$FIND_CLMN
      2400**DCL-ENT  2553--CALL     2562--CALL     2631--CALL     2687--CALL     2750--CALL     2810--CALL
      2838--CALL     2889--CALL     2925--CALL
VEX$FIND_MATCH
      2389**DCL-ENT  2668--CALL     2715--CALL     2779--CALL     2866--CALL     2969--CALL
VEX$MAKE_STRING
      2406**DCL-ENT  2690--CALL     2753--CALL     2841--CALL     2929--CALL
VEX$MOVE_LEFT
      2397**DCL-ENT  2566--CALL     2641--CALL     2819--CALL     2938--CALL
PL6.E3A0      #001=VEI$INTCMD File=VEI$INTCMD.:E05TSI                            WED 07/30/97 07:08 Page:124  
VEX$MOVE_RIGHT
      2399**DCL-ENT  2571--CALL     2772--CALL     2844--CALL     2891--CALL     2946--CALL
VEX$READ_RANDOM
      2388**DCL-ENT  2797--CALL
VEX$SEQNUM_TEXT
      2401**DCL-ENT  2598--CALL     2599--CALL     2981--CALL
VEX$TYPE_REC
      2395**DCL-ENT  2983--CALL
VEX$WRITE_REC
      2390**DCL-ENT  2609--CALL     2792--CALL
