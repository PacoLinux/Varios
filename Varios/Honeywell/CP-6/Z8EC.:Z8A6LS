VERSION A06

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        Z8EC$NEW_CONST_WITH_TYPE_DESC: PROC (TYPE_DESC, CONST$, RTN$) ALTRET;
        7        7
        8        8        %SET PHASE = 1;
        9        9
       10       10        %INCLUDE Z8A_DEFC;
       11       78        %INCLUDE Z8A_SUPP_MAC;
       12     2478        %INCLUDE Z9A_SUPP_MAC;
       13     2767        %INCLUDE Z8A_COMCOM;
       14     3417        %INCLUDE Z8A_LTS;
       15     5494        %INCLUDE Z8A_ST;
       16     9153        %INCLUDE Z8A_TYPES;
       17     9327        %INCLUDE Z8A_ETT;
       18     9628        %INCLUDE Z8A_DNT;
       19     9849        %INCLUDE Z8A_ERR_NUMS;
       20    10613        %INCLUDE Z8E_HEAP;
       21    10669        %INCLUDE Z8E_STACKS;
       22    12935        %INCLUDE Z8E_O1COM;
       23    13696        %INCLUDE Z8E_TRANSLAT;
       24    14114        %INCLUDE Z8E_WINDOW;
       25    16184        %INCLUDE Z8E_MACROS;
       26    16859        %INCLUDE Z8D_PIC_PARM;
       27    16965
       28    16966        %PIC_OUT (STCLASS = EXT);
       29    17039        %EQU CONTINUE_SCANNING = 1;
       30    17040        %EQU WORDLEN              = 4;
       31    17041        %EQU BLANK             = ' ';
       32    17042        %EQU PLUS_SIGN_        = '+';
       33    17043        %EQU MINUS_SIGN_       = '-';
       34    17044        %EQU ONE_WORD_OF_ZEROS = '0000';
       35    17045        %EQU TWO_WORDS_OF_ZEROS = '00000000';
       36    17046        %EQU FLOATING_POINT_ZERO = '400000000000000000000000'O;
       37    17047        %EQU CHAR_ZEROS_FOR_TYD =
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:2    
       38    17048             '000000000000000000000000000000000000000000000000000000000000000';
       39    17049        %EQU HIGH_VALUE         = '001111111'B;
       40    17050        %EQU LOW_VALUE          = '000000000'B;
       41    17051        %EQU TYI_CHAR_MAX_VALUE = '34359738367'; /* Max TYI value in char */
       42    17052        %EQU TYI_CHAR_MIN_VALUE = '34359738368'; /* Min TYI value in char */
       43    17053
       44    17054    1   DCL Z8AE$ERROR                ENTRY(12);
       45    17055    1   DCL Z8AH$NEW_DNT              ENTRY(3);
       46    17056    1   DCL Z9AU$MOVE_NUMERIC         ENTRY(4);
       47    17057    1   DCL Z9AU$MOVE_C3_NUMERIC      ENTRY(4);
       48    17058    1   DCL Z8AF$FORME                ENTRY(4);
       49    17059    1   DCL Z8AU$CREATE_NUM_DESC      ENTRY(3);
       50    17060    1   DCL Z9EC$ALIGN                ENTRY(2);
       51    17061    1   DCL Z8EC$INTERNAL_STRING_REP  ENTRY(2);
       52    17062    1   DCL Z8EC$FLOAT                ENTRY(4);
       53    17063    1   DCL Z8EC$DOUBLE_FLOAT         ENTRY(4);
       54    17064
       55    17065
       56    17066    1   DCL 1 TYPE_DESC               ALIGNED,
       57    17067             %TYPE_DESC;
       58    17101    1   DCL 1 CONST_                  REDEF TYPE_DESC ALIGNED,
       59    17102    1        2 TYPE                   SBIN WORD,
       60    17103    1        2 *                      (0:2) PTR;
       61    17104    1   DCL CONST$                    PTR;
       62    17105    1   DCL PIC_DNT$                  REDEF CONST$ PTR;
       63    17106    1   DCL RTN$                      PTR;
       64    17107    1   DCL TO_TYPE                   SBIN WORD;
       65    17108
       66    17109        /* Constant storage */
       67    17110
       68    17111    1   DCL DIGIT_TABLE (0:511) UBIN (9) UNAL CONSTANT INIT(
       69    17112    1       %CONTINUE_SCANNING * 48,
       70    17113    1       0                  * 10,
       71    17114    1       %CONTINUE_SCANNING * 454);
       72    17115
       73    17116    1   DCL POSITIVE_OVERPUNCH_VECTOR (0:9) CHAR(1) CONSTANT INIT(
       74    17117    1                '{','A','B','C','D','E','F','G','H','I' );
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:3    
       75    17118
       76    17119    1   DCL NEGATIVE_OVERPUNCH_VECTOR (0:9) CHAR(1) CONSTANT INIT(
       77    17120    1                '}','J','K','L','M','N','O','P','Q','R' );
       78    17121    1   DCL CONSTANT_ONE CHAR(1) CONSTANT INIT('1');
       79    17122    1   DCL CONSTANT_ZERO CHAR(1) CONSTANT INIT('0');
       80    17123
       81    17124        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:4    
       82    17125
       83    17126        /*
       84    17127                               External storage
       85    17128        */
       86    17129
       87    17130    1   DCL HIGH_VALUE_ST$     PTR EXT INIT(ADDR(NIL));
       88    17131    1   DCL LOW_VALUE_ST$      PTR EXT INIT(ADDR(NIL));
       89    17132    1   DCL QUOTE_ST$          PTR EXT INIT(ADDR(NIL));
       90    17133    1   DCL SPACE_ST$          PTR EXT INIT(ADDR(NIL));
       91    17134    1   DCL KANJI_SPACE_ST$    PTR EXT INIT(ADDR(NIL));
       92    17135    1   DCL ZERO_ST$           PTR EXT INIT(ADDR(NIL));
       93    17136
       94    17137        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:5    
       95    17138        /*
       96    17139                               Automatic storage
       97    17140        */
       98    17141    1   DCL CONSTANT_LENGTH           SBIN WORD;
       99    17142    1   DCL CONSTANT_SF               SBIN WORD;
      100    17143    1   DCL CONSTANT_SIGNED           BIT(1);
      101    17144    1   DCL SYM$                      PTR;
      102    17145    1   DCL NEL$                      PTR;
      103    17146    1   DCL CONSTANT_SYM$             PTR;
      104    17147    1   DCL CONST_SYMBOL              CHAR(CONSTANT_LENGTH) CALIGNED BASED(CONSTANT_SYM$);
      105    17148    1   DCL LTSS$                     PTR;
      106    17149    1   DCL DNT$$                     PTR;
      107    17150    1   DCL LITERAL_SYMBOL            CHAR(63);
      108    17151    1   DCL 1 REAL_SYMBOL REDEF LITERAL_SYMBOL,
      109    17152    1        2 VALUE                  BIT(72) UNAL,
      110    17153    1        2 *                      CHAR(55) UNAL;
      111    17154    1   DCL CONST_VALUE               SBIN WORD;
      112    17155    1   DCL NEW_ST                    BIT(1);                  /*#28636*/
      113    17156    1   DCL VALUE_OVERFLOW            BIT(1) ALIGNED;
      114    17157    1   DCL TBL_VALUE                 SBIN WORD;
      115    17158    1   DCL REC_LENGTH                SBIN WORD;
      116    17159    1   DCL CHAR_POS                  SBIN WORD;
      117    17160    1   DCL I                         SBIN WORD;
      118    17161    1   DCL INDX                      SBIN WORD;
      119    17162    1   DCL TOTAL_ZEROS               SBIN WORD;
      120    17163    1   DCL LEFT_STARTS               SBIN WORD;
      121    17164    1   DCL LEFT_LENGTH               SBIN WORD;
      122    17165    1   DCL RIGHT_LENGTH              SBIN WORD;
      123    17166    1   DCL RIGHT_STARTS              SBIN WORD;
      124    17167    1   DCL SCRATCH_LENGTH            SBIN WORD;
      125    17168    1   DCL COMP_2_WORD               SBIN WORD;
      126    17169    1   DCL COMP_1_WORD               REDEF COMP_2_WORD SBIN WORD;
      127    17170    1   DCL 1 COMP_1                  REDEF COMP_2_WORD,
      128    17171    1        2 *                      SBIN HALF UNAL,
      129    17172    1        2 LOWER_HALF             SBIN HALF UNAL;
      130    17173    1   DCL CONST_DESC_WORD    SBIN WORD;
      131    17174    1   DCL 1 CONST_DESC       REDEF CONST_DESC_WORD,
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:6    
      132    17175            %DESCRIPTOR (LVL = 2, ENDING = YES);
      133    17203    1   DCL TEMP_DESC_WORD     SBIN WORD;
      134    17204    1   DCL 1 TEMP_DESC        REDEF TEMP_DESC_WORD ALIGNED,
      135    17205            %DESCRIPTOR (LVL = 2, ENDING = YES);
      136    17233    1   DCL CONST_TEMP         CHAR(63);
      137    17234
      138    17235        %DCL_NUM_DESC (@STRN = NUM_DESC);
      139    17244
      140    17245        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:7    
      141    17246        /*
      142    17247                               Macros
      143    17248        */
      144    17249        %MACRO GET_REAL_CONSTANT( @TYPE = ,
      145    17250                                  @STK$ = );
      146    17251            DO SELECT(  @STK$ -> LX_ITEM.SYMBOL );
      147    17252
      148    17253                SELECT( %NUMBER, %NUMERIC_LITERAL, %NUMBER_OR_PARAGRAPH );
      149    17254
      150    17255                    %IF @TYPE = %TYR;
      151    17256                       CALL Z8EC$FLOAT( DNT$$ -> DNT.TEXT.NAME,
      152    17257                                        BINBIT( DNT$$ -> DNT.TEXT.LENGTH,36),
      153    17258                                        LITERAL_SYMBOL,
      154    17259                                        VALUE_OVERFLOW );
      155    17260                    %ELSE;
      156    17261                       CALL Z8EC$DOUBLE_FLOAT( DNT$$ -> DNT.TEXT.NAME,
      157    17262                                        BINBIT( DNT$$ -> DNT.TEXT.LENGTH,36),
      158    17263                                        LITERAL_SYMBOL,
      159    17264                                        VALUE_OVERFLOW );
      160    17265                    %ENDIF;
      161    17266
      162    17267                SELECT( ELSE );
      163    17268
      164    17269                    CALL CREATE_ALPHA_OR_FIG_CONST
      165    17270                      WHENRETURN
      166    17271                      DO;
      167    17272                        %IF @TYPE = %TYR;
      168    17273                           CALL Z8EC$FLOAT( LITERAL_SYMBOL,
      169    17274                                            CONSTANT_LENGTH,
      170    17275                                            LITERAL_SYMBOL,
      171    17276                                            VALUE_OVERFLOW );
      172    17277                        %ELSE;
      173    17278                           CALL Z8EC$DOUBLE_FLOAT( LITERAL_SYMBOL,
      174    17279                                                   CONSTANT_LENGTH,
      175    17280                                                   LITERAL_SYMBOL,
      176    17281                                                   VALUE_OVERFLOW );
      177    17282                        %ENDIF;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:8    
      178    17283                      END;
      179    17284            END;  /*  SELECT  */
      180    17285        %MEND;
      181    17286        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:9    
      182    17287        %MACRO SRCH_FOR_IDENTICAL_CONSTANTS (@TYPE = %TYI);
      183    17288
      184    17289         DO;
      185    17290           %ASSIGN_SYM$_THE_DNT_ST$;
      186    17291
      187    17292           DO WHILE (SYM$ ~= ADDR(NIL));
      188    17293             IF
      189    17294                 %IF @TYPE = TYI;
      190    17295                 SYM$ -> CONST.ID = %CONST AND
      191    17296                 /* It is probably a genuine CONST, but make sure.
      192    17297                    TYPE can be TYI for paragraph and section labels, too. */
      193    17298                 %ENDIF;
      194    17299                 SYM$ -> CONST.TYPE = @TYPE THEN
      195    17300               %IF_SEGMENT_COUNT_VALID_THEN;
      196    17301               EXIT;
      197    17302             SYM$ = SYM$ -> CONST.NEXT;
      198    17303           END; /* While */
      199    17304         END;
      200    17305
      201    17306        %MEND;
      202    17307        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:10   
      203    17308        %MACRO TYA_SRCH (@ST$ = SYM$);
      204    17309
      205    17310                  DO WHILE (@ST$ ~= ADDR(NIL));
      206    17311                    IF @ST$ -> CONST.TYPE = %TYA THEN
      207    17312                      IF @ST$ -> CONST.B.ALL = CONST$ -> LX_ITEM.B.ALL THEN
      208    17313                        IF @ST$ -> CONST.ADSC.CN = CHAR_POS THEN
      209    17314                          %IF_SEGMENT_COUNT_VALID_THEN;
      210    17315                          EXIT;
      211    17316                    @ST$ = @ST$ -> CONST.NEXT;
      212    17317                  END; /* Until @st$ = addr(nil) */
      213    17318
      214    17319        %MEND;
      215    17320
      216    17321        %MACRO TYE_SRCH (@ST$ = SYM$);
      217    17322
      218    17323                  DO WHILE (@ST$ ~= ADDR(NIL));
      219    17324                    IF @ST$ -> CONST.TYPE = %TYE THEN
      220    17325                      IF @ST$ -> CONST.B.ALL = CONST$ -> LX_ITEM.B.ALL THEN
      221    17326                        IF @ST$ -> CONST.ADSC.CN = CHAR_POS THEN
      222    17327                          %IF_SEGMENT_COUNT_VALID_THEN;
      223    17328                          EXIT;
      224    17329                    @ST$ = @ST$ -> CONST.NEXT;
      225    17330                  END; /* Until @st$ = addr(nil) */
      226    17331
      227    17332        %MEND;
      228    17333
      229    17334        %MACRO TYB_SRCH (@ST$ = SYM$);
      230    17335
      231    17336                  DO WHILE (@ST$ ~= ADDR(NIL));
      232    17337                    IF @ST$ -> CONST.TYPE = %TYB THEN
      233    17338                      IF @ST$ -> CONST.B.ALL = CONST$ -> LX_ITEM.B.ALL THEN
      234    17339                        IF @ST$ -> CONST.ADSC.CN = CHAR_POS THEN
      235    17340                          %IF_SEGMENT_COUNT_VALID_THEN;
      236    17341                          EXIT;
      237    17342                    @ST$ = @ST$ -> CONST.NEXT;
      238    17343                  END; /* Until @st$ = addr(nil) */
      239    17344
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:11   
      240    17345        %MEND;
      241    17346        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:12   
      242    17347        %MACRO ONE_WORD_ALPHA_ITEM;
      243    17348
      244    17349           IF (REC_LENGTH + TYPE_DESC.DESC.ADSC.CN) <= %WORDLEN THEN
      245    17350             DO;
      246    17351               SYM$ -> CONST.CONSTA = %BLANK;
      247    17352               IF SYM$ -> CONST.B.ALL THEN
      248    17353                 SUBSTR (SYM$ -> CONST.CONSTA,
      249    17354                         TYPE_DESC.DESC.ADSC.CN,
      250    17355                         CONSTANT_LENGTH)             = CONST_SYMBOL;
      251    17356               ELSE
      252    17357                 DO;
      253    17358                   SUBSTR (SYM$ -> CONST.CONSTA,
      254    17359                           TYPE_DESC.DESC.ADSC.CN,
      255    17360                           REC_LENGTH)                  = CONST_SYMBOL;
      256    17361                   SYM$ -> CONST.ADSC.CN = TYPE_DESC.DESC.ADSC.CN;
      257    17362                 END;
      258    17363             END;
      259    17364               %SET_ONE_WORD_SYMBOL;
      260    17365
      261    17366        %MEND;
      262    17367        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:13   
      263    17368        %MACRO GTR_1_BUT_LEQ_2_WORD_REC_ITEM;
      264    17369
      265    17370           IF CONSTANT_LENGTH <= %WORDLEN
      266    17371           AND REC_LENGTH ~= %(WORDLEN * 2) THEN
      267    17372             %SET_ONE_WORD_SYMBOL;
      268    17373           ELSE
      269    17374             %SET_TWO_WORD_SYMBOL;
      270    17375
      271    17376        %MEND;
      272    17377        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:14   
      273    17378        %MACRO MULTI_WORD_REC_ITEM;
      274    17379
      275    17380         DO CASE (CONSTANT_LENGTH);
      276    17381
      277    17382           CASE(0,1,2,3,4);
      278    17383             %SET_ONE_WORD_SYMBOL;
      279    17384
      280    17385           CASE(5,6,7,8);
      281    17386             %SET_TWO_WORD_SYMBOL;
      282    17387
      283    17388           CASE(ELSE);
      284    17389             %ENTER_9BIT_CONSTANT_GTR_8_DIGITS;
      285    17390
      286    17391         END; /* Case -- constant_length */
      287    17392
      288    17393        %MEND;
      289    17394        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:15   
      290    17395        %MACRO ASSIGN_VALUE_OR_ST$ (@ST$     = ZERO_ST$,
      291    17396                                    @CONST   = '0');
      292    17397
      293    17398             IF @ST$ = ADDR(NIL) THEN
      294    17399               SUBSTR(LITERAL_SYMBOL,0,1) = @CONST;
      295    17400             ELSE
      296    17401               SYM$ = @ST$;
      297    17402
      298    17403        %MEND;
      299    17404        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:16   
      300    17405        %MACRO GET_CHAR_EQUAL_OF_FIG_CONST (@SYMBOL = %RSV_WRD_SPACES);
      301    17406
      302    17407           CONSTANT_LENGTH = 1;
      303    17408
      304    17409           DO SELECT (@SYMBOL);
      305    17410
      306    17411             SELECT (%RSV_WRD_HIGH_VALUES);
      307    17412               %ASSIGN_VALUE_OR_ST$(
      308    17413                 @CONST = O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.HIGH_VALUE,
      309    17414                                    @ST$   = HIGH_VALUE_ST$);
      310    17415
      311    17416             SELECT (%RSV_WRD_LOW_VALUES);
      312    17417               %ASSIGN_VALUE_OR_ST$(
      313    17418                 @CONST = O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.LOW_VALUE,
      314    17419                                    @ST$   = LOW_VALUE_ST$);
      315    17420
      316    17421             SELECT (%RSV_WRD_QUOTES);
      317    17422               %ASSIGN_VALUE_OR_ST$(@CONST = '"',
      318    17423                                    @ST$   = QUOTE_ST$);
      319    17424
      320    17425             SELECT (%RSV_WRD_SPACES);
      321    17426               IF TO_TYPE = %TYN THEN DO ;
      322    17427                 %ASSIGN_VALUE_OR_ST$(@CONST = %KANJI_SPACE,
      323    17428                                      @ST$   = KANJI_SPACE_ST$);
      324    17429               END ;
      325    17430               ELSE DO ; /* Context not Kanji */
      326    17431                 %ASSIGN_VALUE_OR_ST$(@CONST = ' ',
      327    17432                                      @ST$   = SPACE_ST$);
      328    17433               END ;
      329    17434
      330    17435             SELECT (%RSV_WRD_ZEROES);
      331    17436               %ASSIGN_VALUE_OR_ST$(@CONST = '0',
      332    17437                                    @ST$   = ZERO_ST$);
      333    17438
      334    17439         END; /* Do -- for macro */
      335    17440
      336    17441        %MEND;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:17   
      337    17442        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:18   
      338    17443        %MACRO ASSIGN_NUMERIC_FIG_CONST_ZERO (@TYPE = %TYI);
      339    17444
      340    17445         DO CASE (@TYPE);
      341    17446
      342    17447           CASE(%TYD, %TYO, %TYF);
      343    17448             CONSTANT_LENGTH = 1;
      344    17449             LITERAL_SYMBOL = %CHAR_ZEROS_FOR_TYD;
      345    17450
      346    17451           CASE(%TYI, %TYK);
      347    17452             CONSTANT_LENGTH = 4;
      348    17453             LITERAL_SYMBOL = %ONE_WORD_OF_ZEROS;
      349    17454
      350    17455           CASE(%TYH, %TYJ);
      351    17456             CONSTANT_LENGTH = 2;
      352    17457             LITERAL_SYMBOL = %ONE_WORD_OF_ZEROS;
      353    17458
      354    17459           CASE(%TYQ);
      355    17460             CONSTANT_LENGTH = %TYQ_LENGTH;
      356    17461             REAL_SYMBOL.VALUE = %FLOATING_POINT_ZERO;
      357    17462
      358    17463           CASE(%TYR);
      359    17464             CONSTANT_LENGTH = %TYR_LENGTH;
      360    17465             REAL_SYMBOL.VALUE = %FLOATING_POINT_ZERO;
      361    17466
      362    17467         END; /* Case -- @type */
      363    17468
      364    17469        %MEND;
      365    17470        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:19   
      366    17471        %MACRO ENTER_9BIT_NUMERIC_CONSTANT;
      367    17472
      368    17473           IF CONSTANT_LENGTH > 8 THEN
      369    17474             %ENTER_9BIT_CONSTANT_GTR_8_DIGITS;
      370    17475           ELSE
      371    17476             DO;
      372    17477               SUBSTR(SYM$ -> CONST.CONSTA, 0, CONSTANT_LENGTH) = CONST_SYMBOL;
      373    17478               IF CONSTANT_LENGTH > 4 THEN
      374    17479                 SYM$ -> CONST.B.TWO_WORD = TRUE;
      375    17480             END;
      376    17481
      377    17482        %MEND;
      378    17483        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:20   
      379    17484        %MACRO ENTER_4BIT_NUMERIC_CONSTANT;
      380    17485
      381    17486           IF CONSTANT_LENGTH > 16 THEN
      382    17487             %ENTER_4BIT_CONSTANT_GTR_16_DIGITS;
      383    17488           ELSE
      384    17489             DO;
      385    17490               SUBSTR (SYM$ -> CONST.CONSTA, 0, (CONSTANT_LENGTH + 1) / 2)
      386    17491                 = CONST_SYMBOL ;
      387    17492               IF CONSTANT_LENGTH > 8 THEN
      388    17493                 SYM$ -> CONST.B.TWO_WORD = TRUE;
      389    17494             END;
      390    17495
      391    17496        %MEND;
      392    17497        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:21   
      393    17498        %MACRO SET_ONE_WORD_SYMBOL;
      394    17499
      395    17500         DO;
      396    17501           SYM$ -> CONST.CONSTA = CONST_SYMBOL;
      397    17502           SYM$ -> CONST.ADSC.CN = 0;
      398    17503           SYM$ -> CONST.ADSC.N  = CONSTANT_LENGTH;
      399    17504         END;
      400    17505
      401    17506        %MEND;
      402    17507        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:22   
      403    17508        %MACRO SET_TWO_WORD_SYMBOL;
      404    17509
      405    17510         DO;
      406    17511           IF SYM$ -> CONST.B.ALL THEN
      407    17512             SUBSTR(SYM$ -> CONST.CONSTA,
      408    17513                     0,
      409    17514                     CONSTANT_LENGTH)     = CONST_SYMBOL;
      410    17515           ELSE
      411    17516             SUBSTR (SYM$ -> CONST.CONSTA,
      412    17517                     0,
      413    17518                     %(WORDLEN * 2))         = CONST_SYMBOL;
      414    17519
      415    17520           /* Use Kanji Space (241) Filler if Kanji */
      416    17521
      417    17522           IF  SYM$ -> ST.TYPE = %TYN  /* Kanji */
      418    17523           AND CONSTANT_LENGTH < %(WORDLEN * 2) THEN DO ;
      419    17524             DO I = CONSTANT_LENGTH TO %(WORDLEN * 2 - 1) ;
      420    17525               SUBSTR (SYM$ -> CONST.CONSTA, I, 1) = %KANJI_SPACE ;
      421    17526             END ; /* DO I */
      422    17527           END ; /* Kanji & N < 8 */
      423    17528
      424    17529           SYM$ -> CONST.ADSC.CN = 0;
      425    17530        /*#26737*/   /*Six lines deleted here*/
      426    17531             SYM$ -> CONST.ADSC.N = MINIMUM (CONSTANT_LENGTH, %(WORDLEN * 2));
      427    17532
      428    17533           SYM$ -> CONST.B.TWO_WORD = TRUE;
      429    17534           SYM$ -> CONST.B.MOD_2    = TRUE;
      430    17535
      431    17536         END;
      432    17537
      433    17538        %MEND;
      434    17539        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:23   
      435    17540        %MACRO ENTER_9BIT_CONSTANT_GTR_8_DIGITS (@CONSTANT = CONST_SYMBOL,
      436    17541                                                 @LENGTH   = CONSTANT_LENGTH);
      437    17542
      438    17543         DO;
      439    17544           ITERATION = ((@LENGTH + 3) / 4) + 1;
      440    17545           %RESERVE_LTS (ITEM = %LCNST, POINTER = LTSS$);
      441    17546           SUBSTR(LTSS$ -> LCNST.CONST, 0, @LENGTH) = @CONSTANT;
      442    17547           SYM$ -> CONST.CONST$.PTR$ = LTSS$;
      443    17548           SYM$ -> CONST.B.LONG_CONSTANT = TRUE;
      444    17549         END;
      445    17550
      446    17551        %MEND;
      447    17552        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:24   
      448    17553        %MACRO ENTER_4BIT_CONSTANT_GTR_16_DIGITS (@CONSTANT = CONST_SYMBOL,
      449    17554                                                  @LENGTH   = CONSTANT_LENGTH);
      450    17555
      451    17556         DO;
      452    17557           ITERATION = ((@LENGTH + 7) / 8) + 1;
      453    17558           %RESERVE_LTS (ITEM = %LCNST, POINTER = LTSS$);
      454    17559           SUBSTR (LTSS$ -> LCNST.CONST, 0, (@LENGTH + 1) / 2) = @CONSTANT ;
      455    17560           SYM$ -> CONST.CONST$.PTR$ = LTSS$;
      456    17561           SYM$ -> CONST.B.LONG_CONSTANT = TRUE;
      457    17562         END;
      458    17563
      459    17564        %MEND;
      460    17565        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:25   
      461    17566        %MACRO SKIM_LEADING_ZEROS;
      462    17567
      463    17568         DO;
      464    17569           IF LEFT_LENGTH > 0 THEN
      465    17570             DO;
      466    17571               TOTAL_ZEROS = 0;
      467    17572               DO I = 0 TO LEFT_LENGTH - 1;
      468    17573                 IF SUBSTR(LITERAL_SYMBOL,I,1) = '0' THEN
      469    17574                   TOTAL_ZEROS = TOTAL_ZEROS + 1;
      470    17575                 ELSE
      471    17576                   EXIT;
      472    17577               END;
      473    17578
      474    17579               IF TOTAL_ZEROS > 0 THEN
      475    17580                 DO;
      476    17581                   LEFT_LENGTH = LEFT_LENGTH - TOTAL_ZEROS;
      477    17582                   LITERAL_SYMBOL = SUBSTR(LITERAL_SYMBOL,
      478    17583                                    TOTAL_ZEROS, LEFT_LENGTH + RIGHT_LENGTH);
      479    17584                 END;
      480    17585             END;
      481    17586         END;
      482    17587
      483    17588        %MEND;
      484    17589        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:26   
      485    17590        %MACRO SKIM_TRAILING_ZEROS;
      486    17591
      487    17592         DO;
      488    17593           IF RIGHT_LENGTH > 0 THEN
      489    17594             DO;
      490    17595               SCRATCH_LENGTH = RIGHT_LENGTH;
      491    17596               DO I = SCRATCH_LENGTH DOWNTO 1;
      492    17597                 IF SUBSTR(LITERAL_SYMBOL,LEFT_LENGTH + I - 1, 1) = '0' THEN
      493    17598                   RIGHT_LENGTH = RIGHT_LENGTH - 1;
      494    17599                 ELSE
      495    17600                   EXIT;
      496    17601               END;
      497    17602             END;
      498    17603
      499    17604           IF RIGHT_LENGTH + LEFT_LENGTH = 0 THEN
      500    17605             DO;
      501    17606               LITERAL_SYMBOL = CONSTANT_ZERO;
      502    17607               RIGHT_LENGTH = 0;
      503    17608               LEFT_LENGTH  = 1;
      504    17609             END;
      505    17610         END;
      506    17611
      507    17612        %MEND;
      508    17613        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:27   
      509    17614        %MACRO ASSIGN_SYM$_THE_DNT_ST$;
      510    17615
      511    17616         DO;
      512    17617           IF DNT$$ = ADDR(NIL) THEN
      513    17618             SYM$ = ADDR(NIL);
      514    17619           ELSE
      515    17620             SYM$ = DNT$$ -> DNT.ST$;
      516    17621         END;
      517    17622
      518    17623        %MEND;
      519    17624        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:28   
      520    17625        %MACRO CHECK_FOR_SYMBOLIC_CHARACTER;
      521    17626           DO;
      522    17627             IF CONST$ -> LX_TERMINAL.SYMBOL = %ALPHA_LITERAL
      523    17628             AND DNT$$ -> DNT.ST$ ~= ADDR(NIL) THEN
      524    17629               IF DNT$$ -> DNT.ST$ -> ST.ID = %SYM_CHAR THEN
      525    17630                 DO;
      526    17631                   SYM$ = DNT$$ -> DNT.ST$ -> SYMBOLIC_CHAR.CONST$;
      527    17632                   CONSTANT_LENGTH = 1;
      528    17633                   CONSTANT_SYM$ = ADDR (SYM$ -> CONST.CONSTA);
      529    17634                   RETURN;
      530    17635                 END;
      531    17636           END;
      532    17637        %MEND;
      533    17638        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:29   
      534    17639        %MACRO BUILD_OVERPUNCH_CHARACTER (@SIGN           = %PLUS_SIGN_,
      535    17640                                          @RETURN_CHAR    = '0',
      536    17641                                          @IN_CHAR        = '0');
      537    17642
      538    17643         DO;
      539    17644           IF @SIGN = %PLUS_SIGN_ THEN
      540    17645             @RETURN_CHAR = POSITIVE_OVERPUNCH_VECTOR(ASCBIN(@IN_CHAR)-48);
      541    17646           ELSE
      542    17647             @RETURN_CHAR = NEGATIVE_OVERPUNCH_VECTOR(ASCBIN(@IN_CHAR)-48);
      543    17648         END;
      544    17649
      545    17650        %MEND;
      546    17651        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:30   
      547    17652        /*
      548    17653                               Internal Procedures
      549    17654        */
      550    17655    1   GET_NUMERIC_CONSTANT : PROC;
      551    17656
      552    17657    3    DO SELECT (CONST$ -> LX_ITEM.SYMBOL);
      553    17658    3      SELECT (%NUMERIC_LITERAL, %NUMBER_OR_PARAGRAPH);
      554    17659    3        CALL CREATE_ASCII_NUMBER;
      555    17660
      556    17661    3      SELECT (%NUMBER);
      557    17662    3        CONSTANT_SF = 0;
      558    17663    3        CONSTANT_LENGTH = DNT$$ -> DNT.TEXT.LENGTH;
      559    17664    3        LITERAL_SYMBOL  = SUBSTR(DNT$$ -> DNT.TEXT.NAME,
      560    17665    3                                 0, CONSTANT_LENGTH);
      561    17666    3        CONSTANT_SIGNED = FALSE;
      562    17667    3        RIGHT_LENGTH = 0;
      563    17668    3        LEFT_LENGTH  = CONSTANT_LENGTH;
      564    17669             %SKIM_LEADING_ZEROS;
      565    17689    3        IF LEFT_LENGTH = 0 THEN
      566    17690    4          DO;
      567    17691    4            LITERAL_SYMBOL = '0';
      568    17692    4            CONSTANT_LENGTH = 1;
      569    17693    4          END;
      570    17694    3        ELSE
      571    17695    3          CONSTANT_LENGTH = LEFT_LENGTH;
      572    17696    3        CONSTANT_SYM$   = ADDR(LITERAL_SYMBOL);
      573    17697
      574    17698    3      SELECT (ELSE);
      575    17699    3        CALL CREATE_ALPHA_OR_FIG_CONST;
      576    17700
      577    17701    3    END;/* Case -- const$ -> literal.symbol */
      578    17702
      579    17703    2   END GET_NUMERIC_CONSTANT;
      580    17704        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:31   
      581    17705    1   CREATE_ALPHA_OR_FIG_CONST: PROC ALTRET;
      582    17706
      583    17707    2    SYM$ = ADDR(NIL);
      584    17708
      585    17709    3    DO CASE (TO_TYPE);
      586    17710
      587    17711    3      CASE (%TYA, %TYN, %TYB, %TYE);
      588    17712
      589    17713    4        DO SELECT (CONST$ -> LX_ITEM.SYMBOL);
      590    17714
      591    17715    4          SELECT(%RSV_WRD_QUOTES,         %RSV_WRD_LOW_VALUES,
      592    17716    4               %RSV_WRD_SPACES,         %RSV_WRD_HIGH_VALUES,
      593    17717    4               %RSV_WRD_ZEROES);
      594    17718                 %GET_CHAR_EQUAL_OF_FIG_CONST (@SYMBOL = CONST$ -> LX_ITEM.SYMBOL);
      595    17776    4            CONSTANT_SYM$ = ADDR(LITERAL_SYMBOL);
      596    17777
      597    17778                 %SEGMENT_COUNT_CHECK;
      598    17783
      599    17784    4          SELECT(%ALPHA_LITERAL,  %SINGLE_QUOTE);
      600    17785    4            IF TO_TYPE = %TYN THEN
      601    17786    4              CONST$ -> LX_TERMINAL.TYPE = %TYN ;
      602    17787
      603    17788    4            CALL Z8EC$INTERNAL_STRING_REP (CONST$, DNT$$);
      604    17789
      605    17790    4            IF  TO_TYPE = %TYN
      606    17791    4            AND DNT$$ -> DNT.TEXT.LENGTH > 4
      607    17792    5            AND SUBSTR(DNT$$ -> DNT.TEXT.NAME, 1, 1) = %KANJI_START THEN DO ;
      608    17793    5              CONSTANT_LENGTH = DNT$$ -> DNT.TEXT.LENGTH - 4 ;
      609    17794    5              CONSTANT_SYM$ = ADDR (SUBSTR (DNT$$ -> DNT.TEXT.NAME, 2)) ;
      610    17795    5            END ;
      611    17796    5            ELSE DO ; /* Not a Kanji (Graphic) literal */
      612    17797    5              CONSTANT_LENGTH = DNT$$ -> DNT.TEXT.LENGTH - 2;
      613    17798    5              CONSTANT_SYM$ = ADDR(SUBSTR(DNT$$ ->
      614    17799    5                                          DNT.TEXT.NAME,1));
      615    17800    5            END ;
      616    17801
      617    17802    4          SELECT(%PICTURE_STRING);
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:32   
      618    17803    4            CONSTANT_LENGTH = DNT$$ -> DNT.TEXT.LENGTH;
      619    17804    4            CONSTANT_SYM$   = ADDR(DNT$$ -> DNT.TEXT.NAME);
      620    17805
      621    17806    4          SELECT(%NUMBER, %NUMERIC_LITERAL, %NUMBER_OR_PARAGRAPH);
      622    17807    4            CALL Z8AU$CREATE_NUM_DESC (DNT$$ -> DNT.TEXT.NAME,
      623    17808    4                                       BINBIT (DNT$$ ->
      624    17809    4                                               DNT.TEXT.LENGTH, 36),
      625    17810    4                                       NUM_DESC);
      626    17811
      627    17812    5            DO CASE (NUM_DESC.MANTISSA_SIGN_VALUE);
      628    17813    5              CASE (%NO_SIGN_VALUE);
      629    17814    5                CONSTANT_LENGTH = DNT$$ -> DNT.TEXT.LENGTH;
      630    17815    5                CONSTANT_SYM$ = ADDR(SUBSTR(DNT$$ ->
      631    17816    5                                     DNT.TEXT.NAME,0));
      632    17817
      633    17818    5              CASE (%MINUS_SIGN_VALUE, %PLUS_SIGN_VALUE);
      634    17819    5                CONSTANT_LENGTH = DNT$$ ->
      635    17820    5                                  DNT.TEXT.LENGTH - 1;
      636    17821    5                CONSTANT_SYM$   = ADDR(SUBSTR(DNT$$ ->
      637    17822    5                                       DNT.TEXT.NAME,1));
      638    17823
      639    17824    5              CASE (ELSE);
      640    17825    5                CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);
      641    17826    5            END; /* Case */
      642    17827
      643    17828    4          SELECT(ELSE);
      644    17829                 /* Shouldn't reach here, if it does it is a compiler error*/
      645    17830
      646    17831    4        END; /* Case -- const$ -> ident_literal.symbol */
      647    17832
      648    17833        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:33   
      649    17834    3      CASE(%TYD, %TYH, %TYI, %TYJ, %TYK, %TYO, %TYQ, %TYR, %TYF);
      650    17835    4        DO SELECT (CONST$ -> LX_ITEM.SYMBOL);
      651    17836
      652    17837
      653    17838    4          SELECT(%ALPHA_LITERAL,  %SINGLE_QUOTE);
      654    17839    4            CALL Z8EC$INTERNAL_STRING_REP (CONST$, DNT$$);
      655    17840    4            IF (DNT$$ -> DNT.TEXT.LENGTH - 2) > 63 THEN
      656    17841    4              CONSTANT_LENGTH = 63;
      657    17842    4            ELSE
      658    17843    4              CONSTANT_LENGTH = DNT$$ -> DNT.TEXT.LENGTH - 2;
      659    17844
      660    17845    4            CALL SEARCH (INDX, TBL_VALUE, DIGIT_TABLE,
      661    17846    4                         SUBSTR(DNT$$ -> DNT.TEXT.NAME,
      662    17847    4                                1,CONSTANT_LENGTH));
      663    17848
      664    17849    4            IF INDX ~= CONSTANT_LENGTH THEN
      665    17850    5              DO;
      666    17851    5                IF NOT CONST$ -> LX_ITEM.B.ERROR THEN
      667    17852    5                  CALL Z8AE$ERROR (%E$ONLY_UNSIGNED_TYA_TO_NUM,
      668    17853    5                       CONST$ -> LX_ITEM.LINE, CONST$ -> LX_ITEM.COLUMN);
      669    17854    5                CONSTANT_SIGNED = FALSE;
      670    17855    5                CONSTANT_LENGTH = 1;
      671    17856    5                CONSTANT_SF     = 0;
      672    17857    5                CONSTANT_SYM$ = ADDR(CONSTANT_ONE);
      673    17858    5                LITERAL_SYMBOL = CONSTANT_ONE;
      674    17859    5                CALL Z8AH$NEW_DNT ('1', 1, CONST$ -> LX_TERMINAL.DNT$);
      675    17860    5                RETURN;
      676    17861    5              END;
      677    17862
      678    17863    4            LITERAL_SYMBOL = SUBSTR(DNT$$ ->
      679    17864    4                                    DNT.TEXT.NAME,1);
      680    17865
      681    17866    4            CONSTANT_SYM$ = ADDR(LITERAL_SYMBOL);
      682    17867
      683    17868    4          SELECT(%RSV_WRD_ZEROES, ELSE);
      684    17869                 %ASSIGN_NUMERIC_FIG_CONST_ZERO (@TYPE = TO_TYPE);
      685    17888    4            CONSTANT_SYM$ = ADDR(LITERAL_SYMBOL);
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:34   
      686    17889    4            CONSTANT_SF = 0;
      687    17890    4            CONSTANT_SIGNED = FALSE;
      688    17891    4            ALTRETURN;
      689    17892
      690    17893    4        END; /* Case -- const.symbol */
      691    17894
      692    17895    3      CASE (ELSE);
      693    17896    3            ;
      694    17897
      695    17898    3    END; /* Case -- const_type */
      696    17899
      697    17900    2    CONSTANT_SF = 0;
      698    17901    2    CONSTANT_SIGNED = FALSE;
      699    17902
      700    17903    2   END; /* Proc */
      701    17904        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:35   
      702    17905    1   OVERFLOW: PROC (LT_DIGITS, RT_DIGITS) ALTRET;
      703    17906
      704    17907    2        DCL LT_DIGITS     SBIN;
      705    17908    2        DCL RT_DIGITS     SBIN;
      706    17909
      707    17910
      708    17911
      709    17912    2        IF LT_DIGITS < CONSTANT_LENGTH + CONSTANT_SF THEN
      710    17913    3          DO;
      711    17914    3            VALUE_OVERFLOW = TRUE;
      712    17915    3            RETURN;
      713    17916    3          END;
      714    17917
      715    17918    2        IF RT_DIGITS < - CONSTANT_SF THEN
      716    17919    3          DO;
      717    17920    3            VALUE_OVERFLOW = TRUE;
      718    17921    3            RETURN;
      719    17922    3          END;
      720    17923
      721    17924    2        IF  RT_DIGITS = CONSTANT_SF
      722    17925    2        AND LT_DIGITS = CONSTANT_LENGTH THEN
      723    17926    2          ALTRETURN;
      724    17927
      725    17928    2        RETURN;
      726    17929
      727    17930    2   END OVERFLOW;
      728    17931        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:36   
      729    17932    1   VALUE_CHECK: PROC (VALUE);
      730    17933
      731    17934    2        DCL VALUE         SBIN;
      732    17935
      733    17936
      734    17937
      735    17938    2        IF NOT CONSTANT_SIGNED THEN
      736    17939    3          DO;
      737    17940    3            IF CONST_VALUE > VALUE THEN
      738    17941    3              VALUE_OVERFLOW = TRUE;
      739    17942    3          END;
      740    17943    2        ELSE
      741    17944    2          IF - CONST_VALUE > VALUE + 1 THEN
      742    17945    2            VALUE_OVERFLOW = TRUE;
      743    17946
      744    17947
      745    17948    2   END VALUE_CHECK;
      746    17949        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:37   
      747    17950    1   NDSC9_OVERFLOW: PROC (TYPE_DESC);
      748    17951
      749    17952    2        DCL 1 TYPE_DESC   ALIGNED,
      750    17953                  %TYPE_DESC;
      751    17987
      752    17988    2        DCL LENGTH        UBIN;
      753    17989    2        DCL SCALE         SBIN;
      754    17990    2        DCL I             SBIN;
      755    17991
      756    17992
      757    17993    2        IF CONST$ -> LX_TERMINAL.SYMBOL = %RSV_WRD_ZEROES
      758    17994    2        OR (CONSTANT_LENGTH = 1 AND CONST_SYMBOL = CONSTANT_ZERO) THEN
      759    17995    2          RETURN;
      760    17996
      761    17997             %UNPACK_NDSC (@DESC    = TYPE_DESC.DESC,
      762    17998                           @LENGTH  = LENGTH,
      763    17999                           @SCALE   = SCALE,
      764    18000                           @TYPE    = TYPE_DESC.TYPE);
      765    18055
      766    18056    2        IF SCALE > 0 THEN
      767    18057    3          DO;
      768    18058                 /* Trailing P's -  PIC 99PP */
      769    18059    3            IF CONSTANT_SF > 0 THEN
      770    18060    4              DO;
      771    18061    4                VALUE_OVERFLOW = TRUE;
      772    18062    4                RETURN;
      773    18063    4              END;
      774    18064
      775    18065    4            DO I = CONSTANT_LENGTH - 1 DOWNTO LENGTH;
      776    18066    4              IF SUBSTR (CONST_SYMBOL, I, 1) ~= '0' THEN
      777    18067    5                DO;
      778    18068    5                  VALUE_OVERFLOW = TRUE;
      779    18069    5                  RETURN;
      780    18070    5                END;
      781    18071    4            END; /* Iterated do */
      782    18072    3          END;
      783    18073    2        ELSE
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:38   
      784    18074    2          IF - SCALE > LENGTH THEN
      785    18075    3            DO;
      786    18076                   /* Leading P's - PIC PP99 */
      787    18077    3              IF CONSTANT_LENGTH + CONSTANT_SF > 0 THEN
      788    18078    4                DO;
      789    18079    4                  VALUE_OVERFLOW = TRUE;
      790    18080    4                  RETURN;
      791    18081    4                END;
      792    18082
      793    18083    4              DO I = 0 TO - (SCALE + LENGTH) - 1;
      794    18084    4                IF SUBSTR (CONST_SYMBOL, I, 1) ~= '0' THEN
      795    18085    5                  DO;
      796    18086    5                    VALUE_OVERFLOW = TRUE;
      797    18087    5                    RETURN;
      798    18088    5                  END;
      799    18089    4              END; /* Iterated do */
      800    18090    3            END; /* If */
      801    18091    2          ELSE
      802    18092    2            CALL OVERFLOW (LENGTH + SCALE, - SCALE);
      803    18093
      804    18094    2   END NDSC9_OVERFLOW;
      805    18095        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:39   
      806    18096    1   CREATE_INTEGER_CONSTANT: PROC;
      807    18097
      808    18098    2    IF CONSTANT_SF > 0 THEN
      809    18099    3      DO;
      810    18100    3        CALL CHARBIN (CONST_VALUE, CONST_SYMBOL);
      811    18101    4        DO I = 1 TO CONSTANT_SF;
      812    18102    4          CONST_VALUE = CONST_VALUE * 10;
      813    18103    4        END;
      814    18104    3      END;
      815    18105    2    ELSE
      816    18106    3      DO;
      817    18107    3        CONSTANT_LENGTH = CONSTANT_LENGTH + CONSTANT_SF;
      818    18108    3        IF CONSTANT_LENGTH > 0 THEN
      819    18109    3          CALL CHARBIN (CONST_VALUE, CONST_SYMBOL);
      820    18110    3        ELSE
      821    18111    3          CONST_VALUE = 0;
      822    18112    3      END;
      823    18113
      824    18114    3    IF CONSTANT_SIGNED THEN DO;
      825    18115    3      IF CONST_SYMBOL = %TYI_CHAR_MIN_VALUE
      826    18116    3        THEN CONST_VALUE = - 34359738367 - 1;
      827    18117    3        ELSE CONST_VALUE = - CONST_VALUE;
      828    18118    3    END;
      829    18119
      830    18120    2   END; /* Proc -- create_integer_constant */
      831    18121        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:40   
      832    18122    1   RESERVE_CONST_ITEM: PROC (TYPE, DNT$);
      833    18123
      834    18124    2   DCL TYPE               SBIN WORD;
      835    18125    2   DCL DNT$               PTR;
      836    18126
      837    18127           %NEW_CONST (@ST$ = SYM$,
      838    18128                       @DNT$ = DNT$,
      839    18129                       @TYPE = TYPE);
      840    18170    2      SYM$ -> CONST.TYPE  = TYPE;
      841    18171    2      SYM$ -> CONST.DNT$  = DNT$;
      842    18172
      843    18173    2      IF DNT$ = ADDR(NIL) THEN
      844    18174    2        SYM$ -> CONST.NEXT = ADDR(NIL);
      845    18175    2      ELSE
      846    18176    2        SYM$ -> CONST.NEXT = DNT$ -> DNT.ST$;
      847    18177
      848    18178    2      NEW_ST = TRUE;
      849    18179
      850    18180    2   END; /* Proc -- Reserve_const_item */
      851    18181        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:41   
      852    18182    1   BUILD_TYO: PROC;
      853    18183
      854    18184    2   DCL OVERPUNCH_SIGN     CHAR(1);
      855    18185    2   DCL OVERPUNCH_CHAR     CHAR(1);
      856    18186
      857    18187    2            IF NUM_DESC.MANTISSA_SIGN_VALUE = %NO_SIGN_VALUE THEN
      858    18188    2              OVERPUNCH_SIGN = %PLUS_SIGN_;
      859    18189    2            ELSE
      860    18190    2              IF NUM_DESC.MANTISSA_SIGN_VALUE = %PLUS_SIGN_VALUE THEN
      861    18191    2                OVERPUNCH_SIGN = %PLUS_SIGN_;
      862    18192    2              ELSE
      863    18193    2                OVERPUNCH_SIGN = %MINUS_SIGN_;
      864    18194    2        OVERPUNCH_CHAR = SUBSTR(LITERAL_SYMBOL, 0, 1);
      865    18195
      866    18196             %BUILD_OVERPUNCH_CHARACTER (@SIGN           = OVERPUNCH_SIGN,
      867    18197                                         @RETURN_CHAR    = OVERPUNCH_CHAR,
      868    18198                                         @IN_CHAR        = OVERPUNCH_CHAR);
      869    18206
      870    18207    2        SUBSTR(LITERAL_SYMBOL, 0, 1) = OVERPUNCH_CHAR;
      871    18208    2   END BUILD_TYO;
      872    18209        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:42   
      873    18210    1   BUILD_TYO_WITH_TYPE_DESC: PROC (TYPE_DESC);
      874    18211
      875    18212    2   DCL 1 TYPE_DESC        ALIGNED,
      876    18213             %TYPE_DESC;
      877    18247    2   DCL OVERPUNCH_CHAR     CHAR(1);
      878    18248    2   DCL OFFSET             SBIN WORD;
      879    18249    2   DCL OVERPUNCH_SIGN     CHAR(1);
      880    18250
      881    18251
      882    18252    2        IF CONST$ -> LX_TERMINAL.SYMBOL = %NUMERIC_LITERAL
      883    18253    2        OR CONST$ -> LX_TERMINAL.SYMBOL = %NUMBER_OR_PARAGRAPH THEN
      884    18254    3          DO;
      885    18255    3            IF NUM_DESC.MANTISSA_SIGN_VALUE = %NO_SIGN_VALUE THEN
      886    18256    3              OVERPUNCH_SIGN = %PLUS_SIGN_;
      887    18257    3            ELSE
      888    18258    3              IF NUM_DESC.MANTISSA_SIGN_VALUE = %PLUS_SIGN_VALUE THEN
      889    18259    3                OVERPUNCH_SIGN = %PLUS_SIGN_;
      890    18260    3              ELSE
      891    18261    3                OVERPUNCH_SIGN = %MINUS_SIGN_;
      892    18262    3          END;
      893    18263    2        ELSE
      894    18264    2          OVERPUNCH_SIGN = %PLUS_SIGN_;
      895    18265
      896    18266
      897    18267             %PACK_NDSC (@DESC   = CONST_DESC,
      898    18268                         @LENGTH = CONSTANT_LENGTH,
      899    18269                         @SIGN   = %NO_SIGN,
      900    18270                         @TN     = %NDSC9,
      901    18271                         @SCALE  = CONSTANT_SF);
      902    18320
      903    18321    2        CONST_TEMP      = SUBSTR (LITERAL_SYMBOL, 0, CONSTANT_LENGTH);
      904    18322    2        TEMP_DESC_WORD  = TYPE_DESC.DESC.DESCL;
      905    18323    2        TEMP_DESC.NDSC.S= %NO_SIGN;
      906    18324    2        TEMP_DESC.NDSC.CN = 0;
      907    18325
      908    18326    2        CALL Z9AU$MOVE_NUMERIC (CONST_DESC.DESCL,
      909    18327    2                                TEMP_DESC.DESCL,
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:43   
      910    18328    2                                ADDR(CONST_TEMP),
      911    18329    2                                ADDR(LITERAL_SYMBOL));
      912    18330
      913    18331    2        CONSTANT_LENGTH = TYPE_DESC.DESC.NDSC.N;
      914    18332    2        CONSTANT_SF = TYPE_DESC.DESC.NDSC.SF;
      915    18333
      916    18334    2        IF TYPE_DESC.DESC.NDSC.S = %TRAILING_SIGN THEN
      917    18335    2         OFFSET = CONSTANT_LENGTH -1;
      918    18336    2        ELSE
      919    18337    2         OFFSET = 0;
      920    18338
      921    18339    2        OVERPUNCH_CHAR = SUBSTR(LITERAL_SYMBOL, OFFSET, 1);
      922    18340
      923    18341             %BUILD_OVERPUNCH_CHARACTER (@SIGN           = OVERPUNCH_SIGN,
      924    18342                                         @RETURN_CHAR    = OVERPUNCH_CHAR,
      925    18343                                         @IN_CHAR        = OVERPUNCH_CHAR);
      926    18351
      927    18352    2        SUBSTR(LITERAL_SYMBOL, OFFSET, 1) = OVERPUNCH_CHAR;
      928    18353
      929    18354    2   END BUILD_TYO_WITH_TYPE_DESC;
      930    18355        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:44   
      931    18356    1   BUILD_TYF_WITH_TYPE_DESC: PROC (TYPE_DESC);
      932    18357        /*I*  NAME: BUILD_TYF_WITH_TYPE_DESC
      933    18358           PURPOSE: Build an EBCDIC numeric constant. It will be built as
      934    18359                    ASCII or packed decimal and translated later.
      935    18360        */
      936    18361
      937    18362    2   DCL 1 TYPE_DESC        ALIGNED,
      938    18363             %TYPE_DESC;
      939    18397    2   DCL OVERPUNCH_CHAR     CHAR(1);
      940    18398    2   DCL OFFSET             SBIN WORD;
      941    18399    2   DCL OVERPUNCH_SIGN     CHAR(1);
      942    18400    2   DCL S                  BIT(2);
      943    18401
      944    18402
      945    18403    2        IF TYPE_DESC.DESC.NDSC.TN = %NDSC4 /* Overpunched */ THEN
      946    18404    3          DO;
      947    18405    3            IF CONST$ -> LX_TERMINAL.SYMBOL = %NUMERIC_LITERAL
      948    18406    3            OR CONST$ -> LX_TERMINAL.SYMBOL = %NUMBER_OR_PARAGRAPH THEN
      949    18407    4              DO;
      950    18408    4                IF NUM_DESC.MANTISSA_SIGN_VALUE = %NO_SIGN_VALUE OR
      951    18409    4                      NUM_DESC.MANTISSA_SIGN_VALUE = %PLUS_SIGN_VALUE THEN
      952    18410    4                  OVERPUNCH_SIGN = %PLUS_SIGN_;
      953    18411    4                ELSE
      954    18412    4                  OVERPUNCH_SIGN = %MINUS_SIGN_;
      955    18413    4              END;
      956    18414    3            ELSE
      957    18415    3              OVERPUNCH_SIGN = %PLUS_SIGN_;
      958    18416    3            S = %NO_SIGN;
      959    18417    3          END;
      960    18418    2        ELSE /* Not overpunched */
      961    18419    2          S = TYPE_DESC.DESC.NDSC.S;
      962    18420
      963    18421             %PACK_NDSC (@DESC   = CONST_DESC,
      964    18422                         @LENGTH = CONSTANT_LENGTH,
      965    18423                         @SIGN   = S,
      966    18424                         @TN     = %NDSC9,
      967    18425                         @SCALE  = CONSTANT_SF);
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:45   
      968    18474
      969    18475    2        CONST_TEMP      = SUBSTR (LITERAL_SYMBOL, 0, CONSTANT_LENGTH);
      970    18476    2        TEMP_DESC_WORD  = TYPE_DESC.DESC.DESCL;
      971    18477    2        TEMP_DESC.NDSC.S= S;
      972    18478    2        TEMP_DESC.NDSC.CN = 0;
      973    18479
      974    18480    2        CALL Z9AU$MOVE_NUMERIC (CONST_DESC.DESCL,
      975    18481    2                                TEMP_DESC.DESCL,
      976    18482    2                                ADDR(CONST_TEMP),
      977    18483    2                                ADDR(LITERAL_SYMBOL));
      978    18484
      979    18485    2        CONSTANT_LENGTH = TYPE_DESC.DESC.NDSC.N;
      980    18486
      981    18487    2        IF TYPE_DESC.DESC.NDSC.TN = %NDSC4 /* Overpunched */ THEN
      982    18488    3          DO;
      983    18489    3            IF TYPE_DESC.DESC.NDSC.S = %TRAILING_SIGN THEN
      984    18490    3             OFFSET = CONSTANT_LENGTH -1;
      985    18491    3            ELSE
      986    18492    3             OFFSET = 0;
      987    18493
      988    18494    3            OVERPUNCH_CHAR = SUBSTR(LITERAL_SYMBOL, OFFSET, 1);
      989    18495
      990    18496                 %BUILD_OVERPUNCH_CHARACTER (@SIGN           = OVERPUNCH_SIGN,
      991    18497                                             @RETURN_CHAR    = OVERPUNCH_CHAR,
      992    18498                                             @IN_CHAR        = OVERPUNCH_CHAR);
      993    18506
      994    18507    3            SUBSTR(LITERAL_SYMBOL, OFFSET, 1) = OVERPUNCH_CHAR;
      995    18508                 /* String will later be transliterated to EBCDIC. */
      996    18509    3          END;
      997    18510
      998    18511    2   END BUILD_TYF_WITH_TYPE_DESC;
      999    18512        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:46   
     1000    18513    1   FLOAT_TO_FIXED: PROC (LEFT_LENGTH, RIGHT_LENGTH, NUM_DESC, DNT$$);
     1001    18514
     1002    18515    2        DCL LEFT_LENGTH   SBIN;
     1003    18516    2        DCL RIGHT_LENGTH  SBIN;
     1004    18517    2        DCL DNT$$         PTR;
     1005    18518             %DCL_NUM_DESC     (@STRN = NUM_DESC);
     1006    18527
     1007    18528    2        DCL STARTING_POS  SBIN;
     1008    18529    2        DCL ENDING_POS    SBIN;
     1009    18530    2        DCL EXP_VALUE     SBIN;
     1010    18531    2        DCL NEW_SCALE     SBIN;
     1011    18532    2        DCL TEMP_SYMBOL   CHAR (63);
     1012    18533    2        DCL I             SBIN;
     1013    18534
     1014    18535
     1015    18536    2        IF NUM_DESC.DIGITS_EXPONENT = 0 THEN
     1016    18537    2          RETURN;
     1017    18538
     1018    18539             /* Real number -- normalize exponent, ie. rid of exponent */
     1019    18540    2        CALL XCHARBIN (EXP_VALUE,
     1020    18541    2                       SUBSTR (DNT$$ -> DNT.TEXT.NAME,
     1021    18542    2                               DNT$$ -> DNT.TEXT.LENGTH -
     1022    18543    2                               NUM_DESC.DIGITS_EXPONENT - 1,
     1023    18544    2                               NUM_DESC.DIGITS_EXPONENT + 1));
     1024    18545                                    /* +1 For the sign */
     1025    18546
     1026    18547    2        NEW_SCALE = RIGHT_LENGTH - EXP_VALUE;
     1027    18548
     1028    18549    2        IF NEW_SCALE < 0 THEN
     1029    18550    3          DO;
     1030    18551                 /* We need to add trailing zeros, and adjust the right
     1031    18552                     length accordingly
     1032    18553                 */
     1033    18554    3            STARTING_POS = RIGHT_LENGTH + LEFT_LENGTH;
     1034    18555    3            ENDING_POS   = STARTING_POS - NEW_SCALE - 1;
     1035    18556
     1036    18557    4            DO I = STARTING_POS TO ENDING_POS;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:47   
     1037    18558    4              SUBSTR (LITERAL_SYMBOL, I, 1) = '0';
     1038    18559    4            END; /* Do I = */
     1039    18560
     1040    18561    3            LEFT_LENGTH  = LEFT_LENGTH + RIGHT_LENGTH - NEW_SCALE;
     1041    18562    3            RIGHT_LENGTH = 0;
     1042    18563    3          END; /* NEW_SCALE < 0 */
     1043    18564    2        ELSE
     1044    18565    2          IF - EXP_VALUE > LEFT_LENGTH THEN
     1045    18566    3            DO;
     1046    18567    3              TEMP_SYMBOL = LITERAL_SYMBOL;
     1047    18568
     1048    18569    3              STARTING_POS = 0;
     1049    18570    3              ENDING_POS   = - (LEFT_LENGTH + EXP_VALUE) - 1;
     1050    18571
     1051    18572    4              DO I = STARTING_POS TO ENDING_POS;
     1052    18573    4                SUBSTR (LITERAL_SYMBOL, I, 1) = '0';
     1053    18574    4              END; /* Iterated do */
     1054    18575
     1055    18576    3              SUBSTR (LITERAL_SYMBOL,
     1056    18577    3                      ENDING_POS + 1,
     1057    18578    3                      RIGHT_LENGTH + LEFT_LENGTH) = SUBSTR (TEMP_SYMBOL,
     1058    18579    3                                                            0,
     1059    18580    3                                                            RIGHT_LENGTH +
     1060    18581    3                                                            LEFT_LENGTH);
     1061    18582
     1062    18583    3              LEFT_LENGTH = 0;
     1063    18584    3              RIGHT_LENGTH = RIGHT_LENGTH - EXP_VALUE;
     1064    18585    3            END; /* If - EXP_VALUE > LEFT_LENGTH */
     1065    18586    2          ELSE
     1066    18587    3            DO;
     1067    18588    3              RIGHT_LENGTH = RIGHT_LENGTH - EXP_VALUE;
     1068    18589    3              LEFT_LENGTH  = LEFT_LENGTH + EXP_VALUE;
     1069    18590    3            END;
     1070    18591
     1071    18592
     1072    18593    2   END FLOAT_TO_FIXED;
     1073    18594        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:48   
     1074    18595    1   CREATE_ASCII_NUMBER: PROC;
     1075    18596
     1076    18597    2    SYM$ = ADDR(NIL);
     1077    18598
     1078    18599    2    CALL Z8AU$CREATE_NUM_DESC (DNT$$ -> DNT.TEXT.NAME,
     1079    18600    2                               BINBIT(DNT$$ -> DNT.TEXT.LENGTH,36),
     1080    18601    2                               NUM_DESC);
     1081    18602
     1082    18603    2    RIGHT_STARTS = 0;
     1083    18604    2    RIGHT_LENGTH = NUM_DESC.DIGITS_RIGHT;
     1084    18605    2    LEFT_LENGTH = NUM_DESC.DIGITS_LEFT;
     1085    18606
     1086    18607    2    IF NUM_DESC.MANTISSA_SIGN_VALUE = %NO_SIGN_VALUE THEN
     1087    18608    2      LEFT_STARTS = 0;
     1088    18609    2    ELSE
     1089    18610    2      LEFT_STARTS = 1;
     1090    18611
     1091    18612    2    IF RIGHT_LENGTH > 0 THEN
     1092    18613    2      RIGHT_STARTS = LEFT_STARTS + LEFT_LENGTH + 1;
     1093    18614
     1094    18615    2    CALL CONCAT (LITERAL_SYMBOL,
     1095    18616    2         SUBSTR(DNT$$ -> DNT.TEXT.NAME,
     1096    18617    2                LEFT_STARTS, LEFT_LENGTH),
     1097    18618    2         SUBSTR(DNT$$ -> DNT.TEXT.NAME,
     1098    18619    2                RIGHT_STARTS, RIGHT_LENGTH));
     1099    18620
     1100    18621    2    CALL FLOAT_TO_FIXED (LEFT_LENGTH, RIGHT_LENGTH, NUM_DESC, DNT$$);
     1101    18622
     1102    18623         %SKIM_LEADING_ZEROS;
     1103    18643         %SKIM_TRAILING_ZEROS;
     1104    18663
     1105    18664    2    CONSTANT_LENGTH = LEFT_LENGTH + RIGHT_LENGTH;
     1106    18665
     1107    18666    2    IF RIGHT_LENGTH > 0 THEN
     1108    18667    2      CONSTANT_SF = - RIGHT_LENGTH;
     1109    18668    2    ELSE
     1110    18669    2      CONSTANT_SF = 0;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:49   
     1111    18670
     1112    18671    2    IF NUM_DESC.MANTISSA_SIGN_VALUE = %MINUS_SIGN_VALUE THEN
     1113    18672    2      CONSTANT_SIGNED = TRUE;
     1114    18673    2    ELSE
     1115    18674    2      CONSTANT_SIGNED = FALSE;
     1116    18675
     1117    18676
     1118    18677    2    CONSTANT_SYM$ = ADDR(LITERAL_SYMBOL);
     1119    18678
     1120    18679    2   END; /* Proc -- create_ascii_number */
     1121    18680        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:50   
     1122    18681    1   WRAP_UP: PROC;
     1123    18682
     1124    18683
     1125    18684        /*
     1126    18685                               Wrap up
     1127    18686        */
     1128    18687
     1129    18688    3    DO SELECT (CONST$ -> LX_ITEM.SYMBOL) ;
     1130    18689
     1131    18690    3      SELECT (%ALPHA_LITERAL, %SINGLE_QUOTE,  %NUMERIC_LITERAL,
     1132    18691    3              %NUMBER,          %NUMBER_OR_PARAGRAPH, %PICTURE_STRING);
     1133    18692
     1134    18693    3        IF DNT$$ ~= ADDR(NIL)
     1135    18694    3        AND NEW_ST                               THEN
     1136    18695    4          DO;
     1137    18696    4            DNT$$ -> DNT.ST$ = SYM$;
     1138    18697    4            NEW_ST = FALSE;
     1139    18698    4          END;
     1140    18699
     1141    18700    3      SELECT (%RSV_WRD_HIGH_VALUES);
     1142    18701    3        IF TO_TYPE = %TYA THEN
     1143    18702    3          IF HIGH_VALUE_ST$ = ADDR(NIL) THEN
     1144    18703    3            HIGH_VALUE_ST$ = SYM$;
     1145    18704
     1146    18705    3      SELECT (%RSV_WRD_LOW_VALUES);
     1147    18706    3        IF TO_TYPE = %TYA THEN
     1148    18707    3          IF LOW_VALUE_ST$ = ADDR(NIL) THEN
     1149    18708    3            LOW_VALUE_ST$  = SYM$;
     1150    18709
     1151    18710    3      SELECT (%RSV_WRD_QUOTES);
     1152    18711    3        IF TO_TYPE = %TYA THEN
     1153    18712    3          IF QUOTE_ST$ = ADDR(NIL) THEN
     1154    18713    3            QUOTE_ST$ = SYM$;
     1155    18714
     1156    18715    3      SELECT (%RSV_WRD_SPACES);
     1157    18716    4        IF TO_TYPE = %TYA THEN DO ;
     1158    18717    4          IF SPACE_ST$ = ADDR(NIL) THEN
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:51   
     1159    18718    4            SPACE_ST$ = SYM$;
     1160    18719    4        END ;
     1161    18720    3        ELSE
     1162    18721    4        IF TO_TYPE = %TYN THEN DO ;
     1163    18722    4          IF KANJI_SPACE_ST$ = ADDR(NIL) THEN
     1164    18723    4            KANJI_SPACE_ST$ = SYM$ ;
     1165    18724    4        END ;
     1166    18725
     1167    18726    3      SELECT (%RSV_WRD_ZEROES);
     1168    18727    3        IF TO_TYPE = %TYA THEN
     1169    18728    3          IF ZERO_ST$ = ADDR(NIL) THEN
     1170    18729    3            ZERO_ST$ = SYM$;
     1171    18730
     1172    18731    3      SELECT (ELSE);
     1173    18732
     1174    18733    3    END; /* Select -- const$-> literal.symbol */
     1175    18734
     1176    18735    2    CALL Z8AF$FORME (%TRIAD, SYM$, ADDR(NIL), SYM$);
     1177    18736
     1178    18737
     1179    18738    2    RTN$ = SYM$;
     1180    18739
     1181    18740    2   END WRAP_UP;
     1182    18741        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:52   
     1183    18742    1   CREATE_TYD_CONSTANT: PROC ;
     1184    18743
     1185    18744    2   DCL  CONSTANT_S  BIT (2) ALIGNED ;
     1186    18745
     1187    18746    2      CALL GET_NUMERIC_CONSTANT;
     1188    18747
     1189    18748    2      IF CONSTANT_SIGNED
     1190    18749    2      THEN CONSTANT_S = %LEADING_SIGN ;
     1191    18750    2      ELSE CONSTANT_S = %NO_SIGN ;
     1192    18751
     1193    18752    2      CALL CREATE_4BIT_DECIMAL (CONSTANT_LENGTH, %NDSC4, CONSTANT_SF, CONSTANT_S) ;
     1194    18753
     1195    18754    2   END CREATE_TYD_CONSTANT;
     1196    18755        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:53   
     1197    18756    1   CREATE_4BIT_DECIMAL: PROC (N, TN, SF, S) ;
     1198    18757
     1199    18758    2   DCL N                  SBIN WORD ; /* Result Length            */
     1200    18759    2   DCL TN                 BIT (1) ALIGNED ; /* Result character type */
     1201    18760    2   DCL SF                 SBIN WORD ; /* Result Scale Factor      */
     1202    18761    2   DCL S                  BIT (2) ALIGNED ; /* Result Sign Type   */
     1203    18762    2   DCL LENGTH             SBIN WORD;
     1204    18763
     1205    18764
     1206    18765         %ASSIGN_SYM$_THE_DNT_ST$;
     1207    18773
     1208    18774    3    DO WHILE (SYM$ ~= ADDR(NIL));
     1209    18775    3      IF SYM$ -> CONST.TYPE = %TYD THEN
     1210    18776    3        IF SYM$ -> CONST.NDSC.N = N
     1211    18777    3        AND SYM$ -> CONST.NDSC.TN = TN
     1212    18778    3        AND SYM$ -> CONST.NDSC.SF = SF
     1213    18779    3        AND SYM$ -> CONST.NDSC.S  = S
     1214    18780    3        AND SYM$ -> CONST.B.P = TYPE_DESC.DESC.P THEN
     1215    18781               %IF_SEGMENT_COUNT_VALID_THEN;
     1216    18784    3          EXIT;
     1217    18785
     1218    18786    3      SYM$ = SYM$ -> CONST.NEXT;
     1219    18787    3    END; /* While sym$ ~= addr(nil) */
     1220    18788
     1221    18789    2    IF SYM$ = ADDR(NIL) THEN
     1222    18790    3      DO;
     1223    18791             /* No other items exactly the same already exist */
     1224    18792    3        CALL RESERVE_CONST_ITEM (%TYD, CONST$ -> LX_TERMINAL.DNT$);
     1225    18793
     1226    18794    3        SYM$ -> CONST.B.P = TYPE_DESC.DESC.P;
     1227    18795    3        LENGTH = CONSTANT_LENGTH;
     1228    18796
     1229    18797    3        IF CONSTANT_SIGNED THEN
     1230    18798    4          DO;
     1231    18799    4            CONSTANT_LENGTH = CONSTANT_LENGTH + 1;
     1232    18800    4            CONST_TEMP = CONST_SYMBOL;
     1233    18801    4            SUBSTR (CONST_SYMBOL, 1, CONSTANT_LENGTH - 1) =
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:54   
     1234    18802    4            SUBSTR (CONST_TEMP,   0, CONSTANT_LENGTH - 1);
     1235    18803    4            SUBSTR(CONST_SYMBOL,0,1) = %MINUS_SIGN_;
     1236    18804    4            SYM$ -> CONST.NDSC.S = %LEADING_SIGN;
     1237    18805    4          END;
     1238    18806    3        ELSE
     1239    18807    3            SYM$ -> CONST.NDSC.S = %NO_SIGN;
     1240    18808
     1241    18809             %PACK_NDSC (@DESC   = CONST_DESC,
     1242    18810                         @LENGTH = LENGTH,
     1243    18811                         @SIGN   = SYM$ -> CONST.NDSC.S,
     1244    18812                         @TN     = %NDSC9,
     1245    18813                         @SCALE  = CONSTANT_SF);
     1246    18862
     1247    18863    3        CONST_TEMP        = SUBSTR (LITERAL_SYMBOL, 0, CONSTANT_LENGTH);
     1248    18864    3        TEMP_DESC_WORD    = 0 ;
     1249    18865    3        TEMP_DESC.NDSC.N  = N ;
     1250    18866    3        TEMP_DESC.NDSC.SF = SF ;
     1251    18867    3        TEMP_DESC.NDSC.S  = S;
     1252    18868    3        TEMP_DESC.NDSC.CN = 0;
     1253    18869    3        TEMP_DESC.NDSC.TN = TN ;
     1254    18870    3        REAL_SYMBOL = '0'B ; /* To safeguard against a garbage 4-bit character
     1255    18871                                     after the significant part of the literal */
     1256    18872
     1257    18873    3        IF TYPE_DESC.DESC.P THEN /* COMP-4, COMP-5, COMP-8 */
     1258    18874    3          CALL Z9AU$MOVE_C3_NUMERIC (CONST_DESC.DESCL,
     1259    18875    3                                     TEMP_DESC.DESCL,
     1260    18876    3                                     ADDR(CONST_TEMP),
     1261    18877    3                                     ADDR(LITERAL_SYMBOL));
     1262    18878    3        ELSE /* COMP-3 */
     1263    18879    3          CALL Z9AU$MOVE_NUMERIC (CONST_DESC.DESCL,
     1264    18880    3                                  TEMP_DESC.DESCL,
     1265    18881    3                                  ADDR(CONST_TEMP),
     1266    18882    3                                  ADDR(LITERAL_SYMBOL));
     1267    18883
     1268    18884    3        CONSTANT_LENGTH = TEMP_DESC.NDSC.N;
     1269    18885    3        SYM$ -> CONST.NDSC = TEMP_DESC.NDSC;
     1270    18886
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:55   
     1271    18887    3        IF TN = %NDSC4 THEN
     1272    18888               %ENTER_4BIT_NUMERIC_CONSTANT;
     1273    18992    3        ELSE
     1274    18993               %ENTER_9BIT_NUMERIC_CONSTANT;
     1275    19096    3      END; /* If -- sym$ ~= addr(nil) */
     1276    19097
     1277    19098    2   END CREATE_4BIT_DECIMAL;
     1278    19099
     1279    19100        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:56   
     1280    19101    1   CREATE_TYD_WITH_TYPE_DESC: PROC (TYPE_DESC) ;
     1281    19102
     1282    19103    2   DCL 1 TYPE_DESC        ALIGNED,
     1283    19104             %TYPE_DESC;
     1284    19138    2   DCL   N                SBIN WORD ; /* Result Length            */
     1285    19139    2   DCL   S                BIT (2) ALIGNED ; /* Result Sign Type   */
     1286    19140    2   DCL   SF               SBIN WORD ; /* Result Scale Factor      */
     1287    19141    2   DCL   TN               BIT (1) ALIGNED ; /* Result Character Type */
     1288    19142
     1289    19143
     1290    19144    2      CALL GET_NUMERIC_CONSTANT;
     1291    19145    2      CALL NDSC9_OVERFLOW (TYPE_DESC);
     1292    19146
     1293    19147    2      N  = TYPE_DESC.DESC.NDSC.N ;
     1294    19148    2      TN = TYPE_DESC.DESC.NDSC.TN ;
     1295    19149    2      SF = TYPE_DESC.DESC.NDSC.SF ;
     1296    19150    2      S  = TYPE_DESC.DESC.NDSC.S ;
     1297    19151    2      CALL CREATE_4BIT_DECIMAL (N, TN, SF, S) ;
     1298    19152
     1299    19153
     1300    19154    2   END CREATE_TYD_WITH_TYPE_DESC;
     1301    19155
     1302    19156        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:57   
     1303    19157    1   CREATE_TYI_CONSTANT: PROC;
     1304    19158
     1305    19159    2    CALL GET_NUMERIC_CONSTANT;
     1306    19160
     1307    19161    2    CALL OVERFLOW (%TYI_SIGNIFICANCE, 0)
     1308    19162    2      WHENALTRETURN
     1309    19163    3        DO;
     1310    19164    3          IF NOT CONSTANT_SIGNED THEN
     1311    19165    4            DO;
     1312    19166    4              IF CONST_SYMBOL > %TYI_CHAR_MAX_VALUE THEN
     1313    19167    4                VALUE_OVERFLOW = TRUE;
     1314    19168    4            END;
     1315    19169    3          ELSE
     1316    19170    3            IF CONST_SYMBOL > %TYI_CHAR_MIN_VALUE THEN
     1317    19171    3              VALUE_OVERFLOW = TRUE;
     1318    19172    3        END;
     1319    19173
     1320    19174    2    CALL CREATE_INTEGER_CONSTANT;
     1321    19175
     1322    19176         %SRCH_FOR_IDENTICAL_CONSTANTS (@TYPE = %TYI);
     1323    19202    2    IF SYM$ = ADDR(NIL) THEN
     1324    19203    3      DO;
     1325    19204             /* Identical constant was not found */
     1326    19205    3        CALL RESERVE_CONST_ITEM (%TYI, CONST$ -> LX_TERMINAL.DNT$);
     1327    19206    3        SYM$ -> CONST.CONSTI.WORD1 = CONST_VALUE;
     1328    19207    3        SYM$ -> CONST.NDSC.N = 4;
     1329    19208    3      END;
     1330    19209
     1331    19210    2   END; /* Proc -- create_tyi_constant */
     1332    19211        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:58   
     1333    19212    1   CREATE_TYH_CONSTANT: PROC;
     1334    19213
     1335    19214    2    CALL GET_NUMERIC_CONSTANT;
     1336    19215    2    CALL OVERFLOW (%TYH_SIGNIFICANCE, 0);
     1337    19216
     1338    19217    2    CALL CREATE_INTEGER_CONSTANT;
     1339    19218
     1340    19219    2    CALL VALUE_CHECK (%TYH_MAX_VALUE);
     1341    19220
     1342    19221         %SRCH_FOR_IDENTICAL_CONSTANTS (@TYPE = %TYH);
     1343    19247    2    IF SYM$ = ADDR(NIL) THEN
     1344    19248    3      DO;
     1345    19249             /* Identical constant was not found */
     1346    19250    3        CALL RESERVE_CONST_ITEM (%TYH, CONST$ -> LX_TERMINAL.DNT$);
     1347    19251    3        SYM$ -> CONST.CONSTU.UPPER = CONST_VALUE;
     1348    19252    3        SYM$ -> CONST.ADSC.N = 2;
     1349    19253    3      END;
     1350    19254
     1351    19255    2   END; /* Proc -- Create_tyh_constant */
     1352    19256        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:59   
     1353    19257    1   CREATE_TYJ_CONSTANT: PROC;
     1354    19258
     1355    19259    2    CALL GET_NUMERIC_CONSTANT;
     1356    19260    2    CALL OVERFLOW (%TYJ_SIGNIFICANCE, 0);
     1357    19261
     1358    19262    2    CALL CREATE_INTEGER_CONSTANT;
     1359    19263
     1360    19264    2    CALL VALUE_CHECK (%TYJ_MAX_VALUE);
     1361    19265
     1362    19266         %SRCH_FOR_IDENTICAL_CONSTANTS (@TYPE = %TYJ);
     1363    19292    2    IF SYM$ = ADDR(NIL) THEN
     1364    19293    3      DO;
     1365    19294             /* Identical constant was not found */
     1366    19295    3        CALL RESERVE_CONST_ITEM (%TYJ, CONST$ -> LX_TERMINAL.DNT$);
     1367    19296    3        SYM$ -> CONST.ADSC.N = 2;
     1368    19297    3        CALL Z9EC$ALIGN (CONST_VALUE, COMP_1_WORD);
     1369    19298    3        SYM$ -> CONST.CONSTS.UPPER = COMP_1.LOWER_HALF;
     1370    19299    3      END;
     1371    19300
     1372    19301    2   END; /* Proc -- create_tyj_constant */
     1373    19302        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:60   
     1374    19303    1   CREATE_TYK_CONSTANT: PROC;
     1375    19304
     1376    19305    2    CALL GET_NUMERIC_CONSTANT;
     1377    19306
     1378    19307    2    CALL OVERFLOW (%TYK_SIGNIFICANCE, 0);
     1379    19308
     1380    19309    2    CALL CREATE_INTEGER_CONSTANT;
     1381    19310
     1382    19311    2    CALL VALUE_CHECK (%TYK_MAX_VALUE);
     1383    19312
     1384    19313         %SRCH_FOR_IDENTICAL_CONSTANTS (@TYPE = %TYK);
     1385    19339    2    IF SYM$ = ADDR(NIL) THEN
     1386    19340    3      DO;
     1387    19341             /* Identical constant was not found */
     1388    19342    3        CALL RESERVE_CONST_ITEM (%TYK, CONST$ -> LX_TERMINAL.DNT$);
     1389    19343    3        SYM$ -> CONST.ADSC.N = 4;
     1390    19344    3        CALL Z9EC$ALIGN (CONST_VALUE, COMP_2_WORD);
     1391    19345    3        SYM$ -> CONST.CONSTI.WORD1 = COMP_2_WORD;
     1392    19346    3      END;
     1393    19347
     1394    19348    2   END; /* Proc -- create_tyk_constant */
     1395    19349        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:61   
     1396    19350    1   CREATE_TYQ_CONSTANT: PROC;
     1397    19351
     1398    19352         %GET_REAL_CONSTANT( @TYPE = %TYQ,
     1399    19353                             @STK$ = CONST$ );
     1400    19385         %SRCH_FOR_IDENTICAL_CONSTANTS (@TYPE = %TYQ);
     1401    19411    2    IF SYM$ = ADDR(NIL) THEN
     1402    19412    3      DO;
     1403    19413             /* Identical item not found */
     1404    19414    3        CALL RESERVE_CONST_ITEM (%TYQ, CONST$ -> LX_TERMINAL.DNT$);
     1405    19415    3        SYM$ -> CONST.NDSC.SF = 0;
     1406    19416    3        SYM$ -> CONST.NDSC.N  = %TYQ_LENGTH;
     1407    19417    3        SYM$ -> CONST.NDSC.TN = %NDSC9;
     1408    19418    3        SYM$ -> CONST.NDSC.S  = %FLOATING_POINT_LEADING_SIGN;
     1409    19419    3        SYM$ -> CONST.B.MOD_2 = TRUE;
     1410    19420    3        SYM$ -> CONST.B.TWO_WORD = TRUE;
     1411    19421    3        SYM$ -> CONST.CONSTA  = SUBSTR(LITERAL_SYMBOL,0,8);
     1412    19422    3      END;
     1413    19423
     1414    19424    2   END; /* Proc -- Create_tyq_constant */
     1415    19425        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:62   
     1416    19426    1   CREATE_TYR_CONSTANT: PROC;
     1417    19427
     1418    19428         %GET_REAL_CONSTANT( @TYPE = %TYR,
     1419    19429                             @STK$ = CONST$ );
     1420    19461         %SRCH_FOR_IDENTICAL_CONSTANTS (@TYPE = %TYR);
     1421    19487    2    IF SYM$ = ADDR(NIL) THEN
     1422    19488    3      DO;
     1423    19489             /* Identical item not found */
     1424    19490    3        CALL RESERVE_CONST_ITEM (%TYR, CONST$ -> LX_TERMINAL.DNT$);
     1425    19491    3        SYM$ -> CONST.NDSC.SF = 0;
     1426    19492    3        SYM$ -> CONST.NDSC.N  = %TYR_LENGTH;
     1427    19493    3        SYM$ -> CONST.NDSC.TN = %NDSC9;
     1428    19494    3        SYM$ -> CONST.NDSC.S  = %FLOATING_POINT_LEADING_SIGN;
     1429    19495    3        SYM$ -> CONST.CONSTA  = SUBSTR(LITERAL_SYMBOL,0,8);
     1430    19496    3      END;
     1431    19497
     1432    19498    2   END; /* Proc -- Create_tyq_constant */
     1433    19499        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:63   
     1434    19500    1   CREATE_TYO_CONSTANT: PROC ;
     1435    19501
     1436    19502    2      CALL GET_NUMERIC_CONSTANT;
     1437    19503
     1438    19504    2      CALL BUILD_TYO;
     1439    19505
     1440    19506           %ASSIGN_SYM$_THE_DNT_ST$;
     1441    19514
     1442    19515           %SRCH_FOR_IDENTICAL_CONSTANTS (@TYPE = %TYO);
     1443    19541
     1444    19542    2      IF SYM$ = ADDR(NIL) THEN
     1445    19543    3        DO;
     1446    19544    3          CALL RESERVE_CONST_ITEM (%TYO, CONST$ -> LX_TERMINAL.DNT$);
     1447    19545
     1448    19546    3          SYM$ -> CONST.NDSC.SF   = CONSTANT_SF;
     1449    19547    3          SYM$ -> CONST.NDSC.TN   = %NDSC9;
     1450    19548    3          SYM$ -> CONST.NDSC.S    = %LEADING_SIGN;
     1451    19549    3          SYM$ -> CONST.NDSC.N    = CONSTANT_LENGTH;
     1452    19550
     1453    19551               %ENTER_9BIT_NUMERIC_CONSTANT;
     1454    19654    3        END;
     1455    19655
     1456    19656    2   END CREATE_TYO_CONSTANT;
     1457    19657        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:64   
     1458    19658    1   CREATE_TYO_WITH_TYPE_DESC: PROC (TYPE_DESC) ;
     1459    19659
     1460    19660    2   DCL 1 TYPE_DESC        ALIGNED,
     1461    19661             %TYPE_DESC;
     1462    19695
     1463    19696    2    CALL GET_NUMERIC_CONSTANT;
     1464    19697
     1465    19698    2    CALL NDSC9_OVERFLOW (TYPE_DESC);
     1466    19699
     1467    19700    2    CALL BUILD_TYO_WITH_TYPE_DESC (TYPE_DESC);
     1468    19701         %ASSIGN_SYM$_THE_DNT_ST$;
     1469    19709
     1470    19710    3    DO WHILE (SYM$ ~= ADDR(NIL));
     1471    19711    3      IF SYM$ -> CONST.TYPE = %TYO THEN
     1472    19712    3        IF TYPE_DESC.DESC.NDSC.N = SYM$ -> CONST.NDSC.N
     1473    19713    3        AND TYPE_DESC.DESC.NDSC.S = SYM$ -> CONST.NDSC.S THEN
     1474    19714               %IF_SEGMENT_COUNT_VALID_THEN;
     1475    19717    3            EXIT; /* Identical constant found */
     1476    19718
     1477    19719    3      SYM$ = SYM$ -> CONST.NEXT;
     1478    19720    3    END;
     1479    19721
     1480    19722    2    IF SYM$ = ADDR(NIL) THEN
     1481    19723    3      DO;
     1482    19724             /* Identical constant not found */
     1483    19725    3        CALL RESERVE_CONST_ITEM (%TYO, CONST$ -> LX_TERMINAL.DNT$);
     1484    19726    3        SYM$ -> CONST.NDSC.SF = CONSTANT_SF;
     1485    19727    3        SYM$ -> CONST.NDSC.TN = %NDSC9;
     1486    19728
     1487    19729    3        SYM$ -> CONST.NDSC.S = TYPE_DESC.DESC.NDSC.S;
     1488    19730
     1489    19731    3        SYM$ -> CONST.NDSC.N  = CONSTANT_LENGTH;
     1490    19732
     1491    19733             %ENTER_9BIT_NUMERIC_CONSTANT;
     1492    19836    3      END;
     1493    19837
     1494    19838    2   END CREATE_TYO_WITH_TYPE_DESC;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:65   
     1495    19839        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:66   
     1496    19840    1   CREATE_TYF_CONSTANT: PROC ;
     1497    19841        /*I*  NAME: CREATE_TYF_CONSTANT
     1498    19842           PURPOSE: Make an EBCDIC numeric constant.
     1499    19843        */
     1500    19844
     1501    19845    2      CALL GET_NUMERIC_CONSTANT;
     1502    19846
     1503    19847           %ASSIGN_SYM$_THE_DNT_ST$;
     1504    19855
     1505    19856           %SRCH_FOR_IDENTICAL_CONSTANTS (@TYPE = %TYF);
     1506    19882
     1507    19883    2      IF SYM$ = ADDR(NIL) THEN
     1508    19884    3        DO;
     1509    19885    3          CALL RESERVE_CONST_ITEM (%TYF, CONST$ -> LX_TERMINAL.DNT$);
     1510    19886
     1511    19887    3          SYM$ -> CONST.NDSC.SF   = CONSTANT_SF;
     1512    19888    3          SYM$ -> CONST.NDSC.TN   = %NDSC9;
     1513    19889    3          IF CONSTANT_SIGNED THEN
     1514    19890    4            DO;
     1515    19891    4              CONSTANT_LENGTH = CONSTANT_LENGTH + 1;
     1516    19892    4              CONST_TEMP = CONST_SYMBOL;
     1517    19893    4              SUBSTR (CONST_SYMBOL, 1, CONSTANT_LENGTH - 1) =
     1518    19894    4              SUBSTR (CONST_TEMP,   0, CONSTANT_LENGTH - 1);
     1519    19895    4              SUBSTR(CONST_SYMBOL,0,1) = %MINUS_SIGN_;
     1520    19896    4              SYM$ -> CONST.NDSC.S    = %LEADING_SIGN;
     1521    19897    4            END;
     1522    19898    3          ELSE
     1523    19899    3            SYM$ -> CONST.NDSC.S    = %NO_SIGN;
     1524    19900    3          SYM$ -> CONST.NDSC.N    = CONSTANT_LENGTH;
     1525    19901
     1526    19902    3          IF CONSTANT_LENGTH > 8 THEN
     1527    19903    4            DO;
     1528    19904    4              ITERATION = (CONSTANT_LENGTH + 7) / 4;
     1529    19905                   %RESERVE_LTS (ITEM = %LCNST, POINTER = LTSS$);
     1530    19991    4              CALL XLATE (SUBSTR(LTSS$ -> LCNST.CONST, 0, CONSTANT_LENGTH), EBCDIC,
             19991                       CONST_SYMBOL);
     1531    19992    4              SYM$ -> CONST.CONST$.PTR$ = LTSS$;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:67   
     1532    19993    4              SYM$ -> CONST.B.LONG_CONSTANT = TRUE;
     1533    19994    4            END;
     1534    19995    3          ELSE
     1535    19996    4            DO;
     1536    19997    4              CALL XLATE (SUBSTR(SYM$ -> CONST.CONSTA, 0, CONSTANT_LENGTH), EBCDIC,
             19997                       CONST_SYMBOL);
     1537    19998    4              IF CONSTANT_LENGTH > 4 THEN
     1538    19999    4                SYM$ -> CONST.B.TWO_WORD = TRUE;
     1539    20000    4            END;
     1540    20001    3        END;
     1541    20002
     1542    20003    2   END CREATE_TYF_CONSTANT;
     1543    20004        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:68   
     1544    20005    1   CREATE_TYF_WITH_TYPE_DESC: PROC (TYPE_DESC) ;
     1545    20006         /*I*  NAME: CREATE_TYF_WITH_TYPE_DESC
     1546    20007            PURPOSE: Make an EBCDIC numeric constant.
     1547    20008        */
     1548    20009
     1549    20010    2   DCL 1 TYPE_DESC        ALIGNED,
     1550    20011             %TYPE_DESC;
     1551    20045
     1552    20046    2    CALL GET_NUMERIC_CONSTANT;
     1553    20047
     1554    20048    2    CALL NDSC9_OVERFLOW (TYPE_DESC);
     1555    20049
     1556    20050    2    CALL BUILD_TYF_WITH_TYPE_DESC (TYPE_DESC);
     1557    20051         %ASSIGN_SYM$_THE_DNT_ST$;
     1558    20059
     1559    20060    3    DO WHILE (SYM$ ~= ADDR(NIL));
     1560    20061    3      IF SYM$ -> CONST.TYPE = %TYF THEN
     1561    20062    3        IF TYPE_DESC.DESC.NDSC.N = SYM$ -> CONST.NDSC.N
     1562    20063    3        AND TYPE_DESC.DESC.NDSC.TN = SYM$ -> CONST.NDSC.TN
     1563    20064    3        AND TYPE_DESC.DESC.NDSC.S = SYM$ -> CONST.NDSC.S THEN
     1564    20065               %IF_SEGMENT_COUNT_VALID_THEN;
     1565    20068    3            EXIT; /* Identical constant found */
     1566    20069
     1567    20070    3      SYM$ = SYM$ -> CONST.NEXT;
     1568    20071    3    END;
     1569    20072
     1570    20073    2    IF SYM$ = ADDR(NIL) THEN
     1571    20074    3      DO;
     1572    20075             /* Identical constant not found */
     1573    20076    3        CALL RESERVE_CONST_ITEM (%TYF, CONST$ -> LX_TERMINAL.DNT$);
     1574    20077    3        SYM$ -> CONST.NDSC.SF = CONSTANT_SF;
     1575    20078    3        SYM$ -> CONST.NDSC.TN = TYPE_DESC.DESC.NDSC.TN;
     1576    20079
     1577    20080    3        SYM$ -> CONST.NDSC.S = TYPE_DESC.DESC.NDSC.S;
     1578    20081
     1579    20082    3        SYM$ -> CONST.NDSC.N  = CONSTANT_LENGTH;
     1580    20083
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:69   
     1581    20084    3          IF CONSTANT_LENGTH > 8 THEN
     1582    20085    4            DO;
     1583    20086    4              ITERATION = (CONSTANT_LENGTH + 7) / 4;
     1584    20087                   %RESERVE_LTS (ITEM = %LCNST, POINTER = LTSS$);
     1585    20173    4              CALL XLATE (SUBSTR(LTSS$ -> LCNST.CONST, 0, CONSTANT_LENGTH), EBCDIC,
             20173                       CONST_SYMBOL);
     1586    20174    4              SYM$ -> CONST.CONST$.PTR$ = LTSS$;
     1587    20175    4              SYM$ -> CONST.B.LONG_CONSTANT = TRUE;
     1588    20176    4            END;
     1589    20177    3          ELSE
     1590    20178    4            DO;
     1591    20179    4              CALL XLATE (SUBSTR(SYM$ -> CONST.CONSTA, 0, CONSTANT_LENGTH), EBCDIC,
             20179                       CONST_SYMBOL);
     1592    20180    4              IF CONSTANT_LENGTH > 4 THEN
     1593    20181    4                SYM$ -> CONST.B.TWO_WORD = TRUE;
     1594    20182    4            END;
     1595    20183    3      END;
     1596    20184
     1597    20185    2   END CREATE_TYF_WITH_TYPE_DESC;
     1598    20186        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:70   
     1599    20187    1   CREATE_TYA_CONSTANT: PROC ;
     1600    20188
     1601    20189    2      DCL  CONSTANT_TYPE  UBIN WORD ;
     1602    20190
     1603    20191           %CHECK_FOR_SYMBOLIC_CHARACTER;
     1604    20204
     1605    20205    2      CALL CREATE_ALPHA_OR_FIG_CONST;
     1606    20206
     1607    20207    2      IF SYM$ ~= ADDR(NIL) THEN
     1608    20208    2        RETURN;
     1609    20209
     1610    20210    2      SYM$ = DNT$$ -> DNT.ST$;
     1611    20211
     1612    20212    3      DO WHILE (SYM$ ~= ADDR(NIL));
     1613    20213    3        IF SYM$ -> CONST.TYPE = %TYA
     1614    20214    3        OR SYM$ -> CONST.TYPE = %TYN THEN
     1615    20215    3          IF SYM$ -> CONST.B.ALL = CONST$ -> LX_TERMINAL.B.ALL THEN
     1616    20216                 %IF_SEGMENT_COUNT_VALID_THEN;
     1617    20219    3            EXIT;
     1618    20220
     1619    20221    3        SYM$ = SYM$ -> CONST.NEXT;
     1620    20222    3      END;
     1621    20223
     1622    20224    2      IF SYM$ = ADDR(NIL) THEN
     1623    20225    3        DO;
     1624    20226    3          IF CONST$ -> LX_TERMINAL.TYPE = %TYN THEN
     1625    20227    3            CONSTANT_TYPE = %TYN ;
     1626    20228    3          ELSE
     1627    20229    3            CONSTANT_TYPE = %TYA ;
     1628    20230
     1629    20231               %NEW_CONST (@ST$     = SYM$,
     1630    20232                           @TYPE    = CONSTANT_TYPE,
     1631    20233                           @DNT$    = CONST$ -> LX_ITEM.DNT$,
     1632    20234                           @NEXT    = CONST$ -> LX_TERMINAL.DNT$ -> DNT.ST$);
     1633    20275
     1634    20276    3        IF CONST$ -> LX_ITEM.B.ALL THEN
     1635    20277    3          SYM$ -> CONST.B.ALL = TRUE;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:71   
     1636    20278    3        ELSE
     1637    20279    4          DO SELECT(CONST$ -> LX_TERMINAL.SYMBOL);
     1638    20280    4            SELECT(%RSV_WRD_HIGH_VALUES, %RSV_WRD_LOW_VALUES,
     1639    20281    4                 %RSV_WRD_QUOTES,      %RSV_WRD_SPACES,
     1640    20282    4                 %RSV_WRD_ZEROES);
     1641    20283    4              SYM$ -> CONST.B.ALL = TRUE;
     1642    20284
     1643    20285    4            SELECT(ELSE);
     1644    20286    4              SYM$ -> CONST.B.ALL = FALSE;
     1645    20287    4          END;
     1646    20288
     1647    20289    3          SYM$ -> CONST.ADSC.N = CONSTANT_LENGTH;
     1648    20290    3          NEW_ST = TRUE;
     1649    20291
     1650    20292    3          IF CONSTANT_LENGTH > 8 THEN
     1651    20293                 %ENTER_9BIT_CONSTANT_GTR_8_DIGITS;
     1652    20387    3          ELSE
     1653    20388    4            DO;
     1654    20389    4              SUBSTR (SYM$ -> CONST.CONSTA, 0, CONSTANT_LENGTH) = CONST_SYMBOL;
     1655    20390
     1656    20391    4              IF CONSTANT_LENGTH > 4 THEN
     1657    20392    5                DO;
     1658    20393    5                  SYM$ -> CONST.B.TWO_WORD = TRUE;
     1659    20394    5                  SYM$ -> CONST.B.MOD_2    = TRUE;
     1660    20395    5                END;
     1661    20396    4            END;
     1662    20397
     1663    20398    3        END;
     1664    20399    2   END CREATE_TYA_CONSTANT;
     1665    20400        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:72   
     1666    20401    1   CREATE_TYE_CONSTANT: PROC ;
     1667    20402        /*I*  NAME: CREATE_TYE_CONSTANT
     1668    20403           PURPOSE: Make an EBCDIC alphanumeric constant.
     1669    20404        */
     1670    20405
     1671    20406    2      DCL  TYE_SYM$ PTR;
     1672    20407    2      DCL  TYA_CONST$ PTR;
     1673    20408
     1674    20409    2      SYM$ = DNT$$ -> DNT.ST$;
     1675    20410    2      CHAR_POS = 0;
     1676    20411           %TYE_SRCH;
     1677    20423    2      IF SYM$ = ADDR(NIL) THEN
     1678    20424    3        DO;
     1679    20425    3          CALL CREATE_TYA_CONSTANT;
     1680    20426               %NEW_CONST (@ST$     = TYE_SYM$,
     1681    20427                           @TYPE    = %TYE,
     1682    20428                           @ALL     = SYM$ -> CONST.B.ALL,
     1683    20429                           @DNT$    = CONST$ -> LX_ITEM.DNT$,
     1684    20430                           @NEXT    = CONST$ -> LX_TERMINAL.DNT$ -> DNT.ST$);
     1685    20471    3          TYE_SYM$ -> CONST.ADSC.N = CONSTANT_LENGTH;
     1686    20472    3          NEW_ST = TRUE;
     1687    20473               %GET_CONSTANT_ADDRESS (@CONSTANT = SYM$,
     1688    20474                                      @STRING   = TYA_CONST$);
     1689    20482    3          IF CONSTANT_LENGTH <= 8 THEN
     1690    20483    4            DO;
     1691    20484    4              CALL XLATE (TYE_SYM$ -> CONST.CONSTA, EBCDIC, TYA_CONST$ -> CONST_SYMBOL)
             20484                       ;
     1692    20485    4              IF CONSTANT_LENGTH > 4 THEN
     1693    20486    5                DO;
     1694    20487    5                  TYE_SYM$ -> CONST.B.TWO_WORD = TRUE;
     1695    20488    5                  TYE_SYM$ -> CONST.B.MOD_2 = TRUE;
     1696    20489    5                END;
     1697    20490    4            END;
     1698    20491    3          ELSE
     1699    20492    4            DO;
     1700    20493    4              ITERATION = (CONSTANT_LENGTH + 7) / 4;
     1701    20494                   %RESERVE_LTS (ITEM=%LCNST, POINTER=LTSS$);
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:73   
     1702    20580    4              CALL XLATE (SUBSTR (LTSS$ -> LCNST.CONST, 0, CONSTANT_LENGTH),
     1703    20581    4                          EBCDIC, TYA_CONST$ -> CONST_SYMBOL);
     1704    20582    4              TYE_SYM$ -> CONST.CONST$.PTR$ = LTSS$;
     1705    20583    4              TYE_SYM$ -> CONST.B.LONG_CONSTANT = TRUE;
     1706    20584    4            END;
     1707    20585    3          SYM$ = TYE_SYM$;
     1708    20586    3        END;
     1709    20587    2   END CREATE_TYE_CONSTANT;
     1710    20588        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:74   
     1711    20589    1   CREATE_TYB_CONSTANT: PROC ;
     1712    20590        /*I*  NAME: CREATE_TYB_CONSTANT
     1713    20591           PURPOSE: Make a GBCD constant.
     1714    20592        */
     1715    20593
     1716    20594    2      DCL  TYB_SYM$ PTR;
     1717    20595    2      DCL 1 BCD_LCNST ALIGNED BASED (LTSS$),
     1718    20596    2            2 * BIT (36),
     1719    20597    2            2 BCD_CONST BIT (CONST_BITS);
     1720    20598    2      DCL  CONST_BITS UBIN;
     1721    20599    2      DCL  TYA_CONST$ PTR;
     1722    20600
     1723    20601    2      SYM$ = DNT$$ -> DNT.ST$;
     1724    20602    2      CHAR_POS = 0;
     1725    20603           %TYB_SRCH;
     1726    20615    2      IF SYM$ = ADDR (NIL) THEN
     1727    20616    3        DO;
     1728    20617    3          CALL CREATE_TYA_CONSTANT;
     1729    20618               %NEW_CONST (@ST$     = TYB_SYM$,
     1730    20619                           @TYPE    = %TYB,
     1731    20620                           @ALL     = SYM$ -> CONST.B.ALL,
     1732    20621                           @DNT$    = CONST$ -> LX_ITEM.DNT$,
     1733    20622                           @NEXT    = CONST$ -> LX_TERMINAL.DNT$ -> DNT.ST$);
     1734    20663    3          TYB_SYM$ ->CONST.ADSC.TA = %ADSC6;
     1735    20664    3          TYB_SYM$ ->CONST.ADSC.N = CONSTANT_LENGTH;
     1736    20665               %GET_CONSTANT_ADDRESS (@CONSTANT = SYM$,
     1737    20666                                      @STRING   = TYA_CONST$);
     1738    20674    3          IF CONSTANT_LENGTH <= 12 THEN
     1739    20675    4            DO;
     1740    20676    4              CALL XLATE_9_TO_6 (TYB_SYM$ -> CONST.CONSTI, GBCD, TYA_CONST$ ->
             20676                       CONST_SYMBOL);
     1741    20677    4              IF CONSTANT_LENGTH > 6 THEN
     1742    20678    5                DO;
     1743    20679    5                  TYB_SYM$ -> CONST.B.MOD_2 = TRUE;
     1744    20680    5                  TYB_SYM$ -> CONST.B.TWO_WORD = TRUE;
     1745    20681    5                END;
     1746    20682    4            END;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:75   
     1747    20683    3          ELSE
     1748    20684    4            DO;
     1749    20685    4              CONST_BITS = CONSTANT_LENGTH * 6;
     1750    20686    4              ITERATION = (CONSTANT_LENGTH + 11) / 6;
     1751    20687                   %RESERVE_LTS (ITEM=%LCNST, POINTER=LTSS$);
     1752    20773    4              CALL XLATE_9_TO_6 (LTSS$ -> BCD_LCNST.BCD_CONST, GBCD, TYA_CONST$ ->
             20773                       CONST_SYMBOL);
     1753    20774    4              TYB_SYM$ -> CONST.CONST$.PTR$ = LTSS$;
     1754    20775    4              TYB_SYM$ -> CONST.B.LONG_CONSTANT = TRUE;
     1755    20776    4            END;
     1756    20777    3          SYM$ = TYB_SYM$;
     1757    20778    3        END;
     1758    20779    2   END CREATE_TYB_CONSTANT;
     1759    20780        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:76   
     1760    20781    1   CREATE_TYA_WITH_TYPE_DESC: PROC (TYPE_DESC) ;
     1761    20782
     1762    20783    2   DCL   CONSTANT_TYPE    UBIN WORD ;
     1763    20784
     1764    20785    2   DCL 1 TYPE_DESC        ALIGNED,
     1765    20786             %TYPE_DESC;
     1766    20820
     1767    20821         %CHECK_FOR_SYMBOLIC_CHARACTER;
     1768    20834
     1769    20835    2    CALL CREATE_ALPHA_OR_FIG_CONST;
     1770    20836
     1771    20837    2    IF SYM$ ~= ADDR(NIL) THEN
     1772    20838           /* A reserved word that previously has been created
     1773    20839              was found so no need to create a constant        */
     1774    20840    2      RETURN;
     1775    20841
     1776    20842    2    SYM$ = DNT$$ -> DNT.ST$;
     1777    20843    2    IF TYPE_DESC.SIZ$ ~= ADDR(NIL) THEN
     1778    20844    2      REC_LENGTH = TYPE_DESC.SIZ$ -> ETT.LOP -> CONST.CONSTI.WORD1;
     1779    20845    2    ELSE
     1780    20846    2      REC_LENGTH = TYPE_DESC.DESC.ADSC.N;
     1781    20847
     1782    20848    2    IF CONSTANT_LENGTH > REC_LENGTH THEN
     1783    20849    2      VALUE_OVERFLOW = TRUE;
     1784    20850
     1785    20851    2    IF TYPE_DESC.DESC.ADSC.CN + REC_LENGTH > %WORDLEN THEN
     1786    20852    2      CHAR_POS = 0;
     1787    20853    2    ELSE
     1788    20854    2      CHAR_POS = TYPE_DESC.DESC.ADSC.CN;
     1789    20855
     1790    20856         %TYA_SRCH (@ST$ = SYM$);
     1791    20868    2    IF SYM$ = ADDR(NIL) THEN
     1792    20869    3      DO;
     1793    20870    3        IF CONST$ -> LX_TERMINAL.TYPE = %TYN THEN
     1794    20871    3          CONSTANT_TYPE = %TYN ;
     1795    20872    3        ELSE
     1796    20873    3          CONSTANT_TYPE = %TYA ;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:77   
     1797    20874
     1798    20875             %NEW_CONST (@ST$    = SYM$,
     1799    20876                         @TYPE   = CONSTANT_TYPE,
     1800    20877                         @DNT$   = CONST$ -> LX_ITEM.DNT$,
     1801    20878                         @NEXT   = CONST$ -> LX_TERMINAL.DNT$ -> DNT.ST$);
     1802    20919
     1803    20920    3        IF CONST$ -> LX_ITEM.B.ALL THEN
     1804    20921    3          SYM$ -> CONST.B.ALL = TRUE;
     1805    20922    3        ELSE
     1806    20923    4          DO SELECT(CONST$ -> LX_TERMINAL.SYMBOL);
     1807    20924    4            SELECT(%RSV_WRD_HIGH_VALUES, %RSV_WRD_LOW_VALUES,
     1808    20925    4                 %RSV_WRD_QUOTES,      %RSV_WRD_SPACES,
     1809    20926    4                 %RSV_WRD_ZEROES);
     1810    20927    4              SYM$ -> CONST.B.ALL = TRUE;
     1811    20928
     1812    20929    4            SELECT(ELSE);
     1813    20930    4              SYM$ -> CONST.B.ALL = FALSE;
     1814    20931    4          END;
     1815    20932
     1816    20933    3        SYM$ -> CONST.ADSC.N = CONSTANT_LENGTH;
     1817    20934    3        NEW_ST = TRUE;
     1818    20935
     1819    20936    4        DO CASE (REC_LENGTH);
     1820    20937
     1821    20938    4          CASE(0,1,2,3,4);
     1822    20939                 %ONE_WORD_ALPHA_ITEM;
     1823    20963
     1824    20964    4          CASE (5,6,7,8);
     1825    20965                 %GTR_1_BUT_LEQ_2_WORD_REC_ITEM;
     1826    21001
     1827    21002    4          CASE (ELSE);
     1828    21003                 %MULTI_WORD_REC_ITEM;
     1829    21135    4        END; /* Case */
     1830    21136    3       END; /* If sym$ = addr(nil) */
     1831    21137
     1832    21138    2   END CREATE_TYA_WITH_TYPE_DESC;
     1833    21139        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:78   
     1834    21140    1   CREATE_TYE_WITH_TYPE_DESC: PROC (TYPE_DESC);
     1835    21141        /*I*  NAME: CREATE_TYE_CONSTANT
     1836    21142           PURPOSE: Make an EBCDIC alphanumeric constant.
     1837    21143        */
     1838    21144
     1839    21145    2   DCL   TYE_SYM$ PTR;
     1840    21146    2   DCL 1 TYPE_DESC ALIGNED,
     1841    21147             %TYPE_DESC;
     1842    21181    2   DCL   TYA_CONST$ PTR;
     1843    21182
     1844    21183    2    SYM$ = DNT$$ -> DNT.ST$;
     1845    21184    2    IF TYPE_DESC.SIZ$ ~= ADDR (NIL) THEN
     1846    21185    2      REC_LENGTH = TYPE_DESC.SIZ$ -> ETT.LOP -> CONST.CONSTI.WORD1;
     1847    21186    2    ELSE
     1848    21187    2      REC_LENGTH = TYPE_DESC.DESC.ADSC.N;
     1849    21188    2    IF TYPE_DESC.DESC.ADSC.CN + REC_LENGTH > %WORDLEN THEN
     1850    21189    2      CHAR_POS = 0;
     1851    21190    2    ELSE
     1852    21191    2      CHAR_POS = TYPE_DESC.DESC.ADSC.CN;
     1853    21192
     1854    21193         %TYE_SRCH;
     1855    21205
     1856    21206    2    IF SYM$ = ADDR (NIL) THEN
     1857    21207    3      DO;
     1858    21208    3        CALL CREATE_TYA_WITH_TYPE_DESC (TYPE_DESC);
     1859    21209             %NEW_CONST (@ST$     = TYE_SYM$,
     1860    21210                         @TYPE    = %TYE,
     1861    21211                         @ALL     = SYM$ -> CONST.B.ALL,
     1862    21212                         @MOD_2   = SYM$ -> CONST.B.MOD_2,
     1863    21213                         @TWO_WORD = SYM$ -> CONST.B.TWO_WORD,
     1864    21214                         @DNT$    = CONST$ -> LX_ITEM.DNT$,
     1865    21215                         @NEXT    = CONST$ -> LX_TERMINAL.DNT$ -> DNT.ST$);
     1866    21256    3        TYE_SYM$ -> CONST.ADSC.N = CONSTANT_LENGTH;
     1867    21257    3        NEW_ST = TRUE;
     1868    21258             %GET_CONSTANT_ADDRESS (@CONSTANT = SYM$,
     1869    21259                                    @STRING   = TYA_CONST$);
     1870    21267    3        IF REC_LENGTH <= 8 THEN
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:79   
     1871    21268    3          CALL XLATE (TYE_SYM$ -> CONST.CONSTA, EBCDIC, TYA_CONST$ -> CONST_SYMBOL);
     1872    21269    3        ELSE
     1873    21270    4          DO;
     1874    21271    4            ITERATION = (CONSTANT_LENGTH + 7) / 4;
     1875    21272                 %RESERVE_LTS (ITEM=%LCNST, POINTER=LTSS$);
     1876    21358    4            CALL XLATE (SUBSTR (LTSS$ -> LCNST.CONST, 0, CONSTANT_LENGTH),
     1877    21359    4                EBCDIC, TYA_CONST$ -> CONST_SYMBOL);
     1878    21360    4            TYE_SYM$ -> CONST.CONST$.PTR$ = LTSS$;
     1879    21361    4            TYE_SYM$ -> CONST.B.LONG_CONSTANT = TRUE;
     1880    21362    4          END;
     1881    21363    3        SYM$ = TYE_SYM$;
     1882    21364    3      END;
     1883    21365    2   END CREATE_TYE_WITH_TYPE_DESC;
     1884    21366        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:80   
     1885    21367    1   CREATE_TYB_WITH_TYPE_DESC: PROC (TYPE_DESC);
     1886    21368        /*I*  NAME: CREATE_TYB_CONSTANT
     1887    21369           PURPOSE: Make a GBCD constant.
     1888    21370        */
     1889    21371
     1890    21372    2   DCL 1 TYPE_DESC ALIGNED,
     1891    21373             %TYPE_DESC;
     1892    21407    2   DCL   TYB_SYM$ PTR;
     1893    21408    2   DCL 1 BCD_LCNST ALIGNED BASED (LTSS$),
     1894    21409    2         2 * BIT (36),
     1895    21410    2         2 BCD_CONST BIT (CONST_BITS);
     1896    21411    2   DCL   CONST_BITS UBIN;
     1897    21412    2   DCL   TYA_CONST$ PTR;
     1898    21413
     1899    21414    2    SYM$ = DNT$$ -> DNT.ST$;
     1900    21415    2    IF TYPE_DESC.SIZ$ ~= ADDR (NIL) THEN
     1901    21416    2      REC_LENGTH = TYPE_DESC.SIZ$ -> ETT.LOP -> CONST.CONSTI.WORD1;
     1902    21417    2    ELSE
     1903    21418    2      REC_LENGTH = TYPE_DESC.DESC.ADSC.N;
     1904    21419    2    IF TYPE_DESC.DESC.NDSC.CN + REC_LENGTH > 6 THEN
     1905    21420    2      CHAR_POS = 0;
     1906    21421    2    ELSE
     1907    21422    2      CHAR_POS = TYPE_DESC.DESC.NDSC.CN;
     1908    21423
     1909    21424         %TYB_SRCH;
     1910    21436    2    IF SYM$ = ADDR (NIL) THEN
     1911    21437    3      DO;
     1912    21438    3        CALL CREATE_TYA_WITH_TYPE_DESC (TYPE_DESC);
     1913    21439             %NEW_CONST (@ST$     = TYB_SYM$,
     1914    21440                         @TYPE    = %TYB,
     1915    21441                         @ALL     = SYM$ -> CONST.B.ALL,
     1916    21442                         @DNT$    = CONST$ -> LX_ITEM.DNT$,
     1917    21443                         @NEXT    = CONST$ -> LX_TERMINAL.DNT$ -> DNT.ST$);
     1918    21484    3        TYB_SYM$ ->CONST.ADSC.TA = %ADSC6;
     1919    21485    3        TYB_SYM$ -> CONST.ADSC.N = CONSTANT_LENGTH;
     1920    21486             %GET_CONSTANT_ADDRESS (@CONSTANT = SYM$,
     1921    21487                                    @STRING   = TYA_CONST$);
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:81   
     1922    21495    3        IF REC_LENGTH <= 12 THEN
     1923    21496    4          DO;
     1924    21497    4            CALL XLATE_9_TO_6 (TYB_SYM$ -> CONST.CONSTB, GBCD, TYA_CONST$ ->
             21497                     CONST_SYMBOL);
     1925    21498    4            IF REC_LENGTH > 6 THEN
     1926    21499    5              DO;
     1927    21500    5                TYB_SYM$ -> CONST.B.MOD_2 = TRUE;
     1928    21501    5                TYB_SYM$ -> CONST.B.TWO_WORD = TRUE;
     1929    21502    5              END;
     1930    21503    4          END;
     1931    21504    3        ELSE
     1932    21505    4          DO;
     1933    21506    4            CONST_BITS = CONSTANT_LENGTH * 6;
     1934    21507    4            ITERATION = (CONSTANT_LENGTH + 11) / 6;
     1935    21508                 %RESERVE_LTS (ITEM=%LCNST, POINTER=LTSS$);
     1936    21594    4            CALL XLATE_9_TO_6 (LTSS$ -> BCD_LCNST.BCD_CONST, GBCD, TYA_CONST$ ->
             21594                     CONST_SYMBOL);
     1937    21595    4            TYB_SYM$ -> CONST.CONST$.PTR$ = LTSS$;
     1938    21596    4            TYB_SYM$ -> CONST.B.LONG_CONSTANT = TRUE;
     1939    21597    4          END;
     1940    21598    3        SYM$ = TYB_SYM$;
     1941    21599    3      END;
     1942    21600    2   END CREATE_TYB_WITH_TYPE_DESC;
     1943    21601        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:82   
     1944    21602    1   CREATE_TYM_CONSTANT: PROC;
     1945    21603
     1946    21604             %NEW_CONST (@ST$    = SYM$,
     1947    21605                         @TYPE   = %TYM);
     1948    21646    2        SYM$ -> CONST.ADSC.N = PIC_OUT.MOP_L;
     1949    21647    2        SYM$ -> CONST.NEXT  = PIC_DNT$ -> DNT.ST$;
     1950    21648    2        SYM$ -> CONST.DNT$  = PIC_DNT$;
     1951    21649    2        PIC_DNT$ -> DNT.ST$ = SYM$;
     1952    21650
     1953    21651    2        IF PIC_OUT.MOP_L > 8 THEN
     1954    21652               %ENTER_9BIT_CONSTANT_GTR_8_DIGITS
     1955    21653                      (@CONSTANT = "SUBSTR(PIC_OUT.MOPSTR, 0, PIC_OUT.MOP_L)",
     1956    21654                       @LENGTH   = PIC_OUT.MOP_L);
     1957    21748    2        ELSE
     1958    21749    3          DO;
     1959    21750    3            SUBSTR (SYM$ -> CONST.CONSTA,
     1960    21751    3                    0,
     1961    21752    3                    PIC_OUT.MOP_L)       = SUBSTR (PIC_OUT.MOPSTR,
     1962    21753    3                                                   0,
     1963    21754    3                                                   PIC_OUT.MOP_L);
     1964    21755    3            IF PIC_OUT.MOP_L > 4 THEN
     1965    21756    4              DO;
     1966    21757    4                SYM$ -> CONST.B.TWO_WORD = TRUE;
     1967    21758    4                SYM$ -> CONST.B.MOD_2    = TRUE;
     1968    21759    4              END;
     1969    21760    3          END;
     1970    21761
     1971    21762    2   END CREATE_TYM_CONSTANT; /* Proc */
     1972    21763        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:83   
     1973    21764    1   CREATE_WITHOUT_TYPE_DESC: PROC (TO_TYPE) ;
     1974    21765
     1975    21766    2   DCL TO_TYPE            SBIN WORD;
     1976    21767
     1977    21768    3      DO CASE (TO_TYPE);
     1978    21769    3        CASE (%TYA, %TYN);
     1979    21770    3          CALL CREATE_TYA_CONSTANT;
     1980    21771
     1981    21772    3        CASE (%TYE);
     1982    21773    3          CALL CREATE_TYE_CONSTANT;
     1983    21774
     1984    21775    3        CASE (%TYF);
     1985    21776    3          CALL CREATE_TYF_CONSTANT;
     1986    21777
     1987    21778    3        CASE (%TYB);
     1988    21779    3          CALL CREATE_TYB_CONSTANT;
     1989    21780
     1990    21781    3        CASE (%TYD);
     1991    21782    3          CALL CREATE_TYD_CONSTANT;
     1992    21783
     1993    21784    3        CASE (%TYH);
     1994    21785    3          CALL CREATE_TYH_CONSTANT;
     1995    21786
     1996    21787    3        CASE (%TYI);
     1997    21788    3          CALL CREATE_TYI_CONSTANT;
     1998    21789
     1999    21790    3        CASE (%TYJ);
     2000    21791    3          CALL CREATE_TYJ_CONSTANT;
     2001    21792
     2002    21793    3        CASE (%TYK);
     2003    21794    3          CALL CREATE_TYK_CONSTANT;
     2004    21795
     2005    21796    3        CASE (%TYO);
     2006    21797    3          CALL CREATE_TYO_CONSTANT;
     2007    21798
     2008    21799    3        CASE (%TYQ);
     2009    21800    3          CALL CREATE_TYQ_CONSTANT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:84   
     2010    21801
     2011    21802    3        CASE (%TYR);
     2012    21803    3          CALL CREATE_TYR_CONSTANT;
     2013    21804
     2014    21805    3        CASE(%TYM);
     2015    21806    3          CALL CREATE_TYM_CONSTANT;
     2016    21807
     2017    21808    3        CASE (ELSE);
     2018    21809    3          CALL Z8AE$ERROR (%E$UNEXPECTED_CASE,
     2019    21810    3                           CONST$ -> LX_TERMINAL.LINE,
     2020    21811    3                           CONST$ -> LX_TERMINAL.COLUMN);
     2021    21812
     2022    21813    3      END; /* Case -- const_type */
     2023    21814
     2024    21815    2   END CREATE_WITHOUT_TYPE_DESC;
     2025    21816        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:85   
     2026    21817        /*
     2027    21818               Main Body
     2028    21819        */
     2029    21820
     2030    21821    1      NEW_ST = FALSE;                                     /*#28636*/
     2031    21822    1      TO_TYPE = TYPE_DESC.TYPE;
     2032    21823    1      VALUE_OVERFLOW = FALSE;
     2033    21824    1      DNT$$ = CONST$ -> LX_ITEM.DNT$;
     2034    21825
     2035    21826    2      DO CASE (TYPE_DESC.TYPE);
     2036    21827
     2037    21828    2        CASE (%TYH, %TYI, %TYJ, %TYK, %TYR, %TYQ, %TYM);
     2038    21829    2          CALL CREATE_WITHOUT_TYPE_DESC (TO_TYPE) ;
     2039    21830
     2040    21831    2        CASE (%TYA, %TYN); /* Alphanumeric or Kanji */
     2041    21832    2          CALL CREATE_TYA_WITH_TYPE_DESC (TYPE_DESC) ;
     2042    21833
     2043    21834    2        CASE (%TYE);
     2044    21835    2          CALL CREATE_TYE_WITH_TYPE_DESC (TYPE_DESC) ;
     2045    21836
     2046    21837    2        CASE (%TYF);
     2047    21838    2          CALL CREATE_TYF_WITH_TYPE_DESC (TYPE_DESC) ;
     2048    21839
     2049    21840    2        CASE (%TYB);
     2050    21841    2          CALL CREATE_TYB_WITH_TYPE_DESC (TYPE_DESC) ;
     2051    21842
     2052    21843    2        CASE (%TYD);
     2053    21844    2          CALL CREATE_TYD_WITH_TYPE_DESC (TYPE_DESC) ;
     2054    21845
     2055    21846    2        CASE (%TYO);
     2056    21847    2          CALL CREATE_TYO_WITH_TYPE_DESC (TYPE_DESC) ;
     2057    21848
     2058    21849    2        CASE (ELSE);
     2059    21850    2          CALL Z8AE$ERROR (%E$UNEXPECTED_CASE,
     2060    21851    2                           CONST$ -> LX_TERMINAL.LINE,
     2061    21852    2                           CONST$ -> LX_TERMINAL.COLUMN);
     2062    21853
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:86   
     2063    21854    2      END; /* Case */
     2064    21855
     2065    21856    1      CALL WRAP_UP;
     2066    21857
     2067    21858    1      IF VALUE_OVERFLOW THEN
     2068    21859    1        ALTRETURN;
     2069    21860
     2070    21861    1      RETURN;
     2071    21862
     2072    21863        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:87   
     2073    21864    1   Z8EC$CREATE_CONST: ENTRY (TYPE_DESC, CONST$, RTN$) ALTRET;
     2074    21865
     2075    21866        /*
     2076    21867             The parameter TYPE_DESC is misleading.  It is done
     2077    21868             that way because PL/6 requires the same names on all
     2078    21869             entry points.  It really refers to only a type passed
     2079    21870             in, see the declaration.
     2080    21871        */
     2081    21872
     2082    21873    1    TO_TYPE = CONST_.TYPE;
     2083    21874    1    NEW_ST = FALSE;                                       /*#28636*/
     2084    21875
     2085    21876    1    VALUE_OVERFLOW = FALSE;
     2086    21877
     2087    21878    1    DNT$$ = CONST$ -> LX_ITEM.DNT$;
     2088    21879
     2089    21880    1    CALL CREATE_WITHOUT_TYPE_DESC (TO_TYPE) ;
     2090    21881
     2091    21882    1    CALL WRAP_UP;
     2092    21883
     2093    21884    1    IF VALUE_OVERFLOW THEN
     2094    21885    1      ALTRETURN;
     2095    21886
     2096    21887    1   END Z8EC$NEW_CONST_WITH_TYPE_DESC ; /* Proc */
     2097    21888        %EOD;

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:88   
--  Include file information  --

   Z8D_PIC_PARM.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8E_TRANSLAT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9A_SUPP_MAC.:Z8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EC$NEW_CONST_WITH_TYPE_DESC.

   Procedure Z8EC$NEW_CONST_WITH_TYPE_DESC requires 4295 words for executable code.
   Procedure Z8EC$NEW_CONST_WITH_TYPE_DESC requires 116 words of local(AUTO) storage.

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:89   

 Object Unit name= Z8EC$NEW_CONST_WITH_TYPE_DESC              File name= Z8EC.:Z8A6TOU
 UTS= AUG 09 '97 11:45:36.00 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  LTS$
    2  LblCom even  none     5      5  LTS_
    3  LblCom even  none     1      1  ST$
    4  LblCom even  none     5      5  ST_
    5  LblCom even  none     1      1  ETT$
    6  LblCom even  none     1      1  HEAD_ETT$
    7  LblCom even  none   512   1000  ETT_BUCKETS
    8  LblCom even  none     5      5  ETT_
    9  LblCom even  none     1      1  DNT$
   10  LblCom even  none     5      5  DNT_
   11  LblCom even  none     1      1  DNT_BUCKET_NUMBER
   12  LblCom even  none     1      1  DNT_OF_1$
   13  LblCom even  none     1      1  HEAP$
   14  LblCom even  none    90    132  LEX_SYMBOL
   15  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
   16  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   17  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   18  LblCom even  none    22     26  PIC_OUT
   19  RoData even  UTS    160    240  Z8EC$NEW_CONST_WITH_TYPE_DESC
   20  LblCom even  none     1      1  HIGH_VALUE_ST$
   21  LblCom even  none     1      1  LOW_VALUE_ST$
   22  LblCom even  none     1      1  QUOTE_ST$
   23  LblCom even  none     1      1  SPACE_ST$
   24  LblCom even  none     1      1  KANJI_SPACE_ST$
   25  LblCom even  none     1      1  ZERO_ST$
   26   Proc  even  none  4295  10307  Z8EC$NEW_CONST_WITH_TYPE_DESC
   27  RoData even  none    63     77  Z8EC$NEW_CONST_WITH_TYPE_DESC
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:90   

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    26      0   yes    yes     yes      Std        3  Z8EC$NEW_CONST_WITH_TYPE_DESC
    26  10262          yes     yes      Std        3  Z8EC$CREATE_CONST

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std      12 Z8AE$ERROR
         yes           Std       2 Z8EC$INTERNAL_STRING_REP
         yes           Std       3 Z8AU$CREATE_NUM_DESC
         yes           Std       3 Z8AH$NEW_DNT
         yes           Std       1 Z8AR$RESERVER
         yes           Std       4 Z9AU$MOVE_NUMERIC
         yes           Std       4 Z8AF$FORME
         yes           Std       4 Z9AU$MOVE_C3_NUMERIC
         yes           Std       2 Z9EC$ALIGN
         yes           Std       4 Z8EC$DOUBLE_FLOAT
         yes           Std       4 Z8EC$FLOAT
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                           r    LTS_STEP                              O1COM
     HIER_STK_PTR                          HIER_STK                              PAGE_FORMAT
     REP_STK_PTR                           REP_STK                          r    HBCD
r    GBCD                             r    EBCDIC
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:91   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:92   


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        Z8EC$NEW_CONST_WITH_TYPE_DESC: PROC (TYPE_DESC, CONST$, RTN$) ALTRET;

      6 26 000000   000000 700200 xent  Z8EC$NEW_CO* TSX0  ! X66_AUTO_3
        26 000001   000164 000003                    ZERO    116,3
        26 000002   010137 710000 26                 TRA     s:21821

        7        7
        8        8        %SET PHASE = 1;
        9        9
       10       10        %INCLUDE Z8A_DEFC;
       11       78        %INCLUDE Z8A_SUPP_MAC;
       12     2478        %INCLUDE Z9A_SUPP_MAC;
       13     2767        %INCLUDE Z8A_COMCOM;
       14     3417        %INCLUDE Z8A_LTS;
       15     5494        %INCLUDE Z8A_ST;
       16     9153        %INCLUDE Z8A_TYPES;
       17     9327        %INCLUDE Z8A_ETT;
       18     9628        %INCLUDE Z8A_DNT;
       19     9849        %INCLUDE Z8A_ERR_NUMS;
       20    10613        %INCLUDE Z8E_HEAP;
       21    10669        %INCLUDE Z8E_STACKS;
       22    12935        %INCLUDE Z8E_O1COM;
       23    13696        %INCLUDE Z8E_TRANSLAT;
       24    14114        %INCLUDE Z8E_WINDOW;
       25    16184        %INCLUDE Z8E_MACROS;
       26    16859        %INCLUDE Z8D_PIC_PARM;
       27    16965
       28    16966        %PIC_OUT (STCLASS = EXT);
       29    17039        %EQU CONTINUE_SCANNING = 1;
       30    17040        %EQU WORDLEN              = 4;
       31    17041        %EQU BLANK             = ' ';
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:93   
       32    17042        %EQU PLUS_SIGN_        = '+';
       33    17043        %EQU MINUS_SIGN_       = '-';
       34    17044        %EQU ONE_WORD_OF_ZEROS = '0000';
       35    17045        %EQU TWO_WORDS_OF_ZEROS = '00000000';
       36    17046        %EQU FLOATING_POINT_ZERO = '400000000000000000000000'O;
       37    17047        %EQU CHAR_ZEROS_FOR_TYD =
       38    17048             '000000000000000000000000000000000000000000000000000000000000000';
       39    17049        %EQU HIGH_VALUE         = '001111111'B;
       40    17050        %EQU LOW_VALUE          = '000000000'B;
       41    17051        %EQU TYI_CHAR_MAX_VALUE = '34359738367'; /* Max TYI value in char */
       42    17052        %EQU TYI_CHAR_MIN_VALUE = '34359738368'; /* Min TYI value in char */
       43    17053
       44    17054    1   DCL Z8AE$ERROR                ENTRY(12);
       45    17055    1   DCL Z8AH$NEW_DNT              ENTRY(3);
       46    17056    1   DCL Z9AU$MOVE_NUMERIC         ENTRY(4);
       47    17057    1   DCL Z9AU$MOVE_C3_NUMERIC      ENTRY(4);
       48    17058    1   DCL Z8AF$FORME                ENTRY(4);
       49    17059    1   DCL Z8AU$CREATE_NUM_DESC      ENTRY(3);
       50    17060    1   DCL Z9EC$ALIGN                ENTRY(2);
       51    17061    1   DCL Z8EC$INTERNAL_STRING_REP  ENTRY(2);
       52    17062    1   DCL Z8EC$FLOAT                ENTRY(4);
       53    17063    1   DCL Z8EC$DOUBLE_FLOAT         ENTRY(4);
       54    17064
       55    17065
       56    17066    1   DCL 1 TYPE_DESC               ALIGNED,
       57    17067             %TYPE_DESC;
       58    17101    1   DCL 1 CONST_                  REDEF TYPE_DESC ALIGNED,
       59    17102    1        2 TYPE                   SBIN WORD,
       60    17103    1        2 *                      (0:2) PTR;
       61    17104    1   DCL CONST$                    PTR;
       62    17105    1   DCL PIC_DNT$                  REDEF CONST$ PTR;
       63    17106    1   DCL RTN$                      PTR;
       64    17107    1   DCL TO_TYPE                   SBIN WORD;
       65    17108
       66    17109        /* Constant storage */
       67    17110
       68    17111    1   DCL DIGIT_TABLE (0:511) UBIN (9) UNAL CONSTANT INIT(
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:94   
       69    17112    1       %CONTINUE_SCANNING * 48,
       70    17113    1       0                  * 10,
       71    17114    1       %CONTINUE_SCANNING * 454);
       72    17115
       73    17116    1   DCL POSITIVE_OVERPUNCH_VECTOR (0:9) CHAR(1) CONSTANT INIT(
       74    17117    1                '{','A','B','C','D','E','F','G','H','I' );
       75    17118
       76    17119    1   DCL NEGATIVE_OVERPUNCH_VECTOR (0:9) CHAR(1) CONSTANT INIT(
       77    17120    1                '}','J','K','L','M','N','O','P','Q','R' );
       78    17121    1   DCL CONSTANT_ONE CHAR(1) CONSTANT INIT('1');
       79    17122    1   DCL CONSTANT_ZERO CHAR(1) CONSTANT INIT('0');
       80    17123
       81    17124        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:95   
       82    17125
       83    17126        /*
       84    17127                               External storage
       85    17128        */
       86    17129
       87    17130    1   DCL HIGH_VALUE_ST$     PTR EXT INIT(ADDR(NIL));
       88    17131    1   DCL LOW_VALUE_ST$      PTR EXT INIT(ADDR(NIL));
       89    17132    1   DCL QUOTE_ST$          PTR EXT INIT(ADDR(NIL));
       90    17133    1   DCL SPACE_ST$          PTR EXT INIT(ADDR(NIL));
       91    17134    1   DCL KANJI_SPACE_ST$    PTR EXT INIT(ADDR(NIL));
       92    17135    1   DCL ZERO_ST$           PTR EXT INIT(ADDR(NIL));
       93    17136
       94    17137        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:96   
       95    17138        /*
       96    17139                               Automatic storage
       97    17140        */
       98    17141    1   DCL CONSTANT_LENGTH           SBIN WORD;
       99    17142    1   DCL CONSTANT_SF               SBIN WORD;
      100    17143    1   DCL CONSTANT_SIGNED           BIT(1);
      101    17144    1   DCL SYM$                      PTR;
      102    17145    1   DCL NEL$                      PTR;
      103    17146    1   DCL CONSTANT_SYM$             PTR;
      104    17147    1   DCL CONST_SYMBOL              CHAR(CONSTANT_LENGTH) CALIGNED BASED(CONSTANT_SYM$);
      105    17148    1   DCL LTSS$                     PTR;
      106    17149    1   DCL DNT$$                     PTR;
      107    17150    1   DCL LITERAL_SYMBOL            CHAR(63);
      108    17151    1   DCL 1 REAL_SYMBOL REDEF LITERAL_SYMBOL,
      109    17152    1        2 VALUE                  BIT(72) UNAL,
      110    17153    1        2 *                      CHAR(55) UNAL;
      111    17154    1   DCL CONST_VALUE               SBIN WORD;
      112    17155    1   DCL NEW_ST                    BIT(1);                  /*#28636*/
      113    17156    1   DCL VALUE_OVERFLOW            BIT(1) ALIGNED;
      114    17157    1   DCL TBL_VALUE                 SBIN WORD;
      115    17158    1   DCL REC_LENGTH                SBIN WORD;
      116    17159    1   DCL CHAR_POS                  SBIN WORD;
      117    17160    1   DCL I                         SBIN WORD;
      118    17161    1   DCL INDX                      SBIN WORD;
      119    17162    1   DCL TOTAL_ZEROS               SBIN WORD;
      120    17163    1   DCL LEFT_STARTS               SBIN WORD;
      121    17164    1   DCL LEFT_LENGTH               SBIN WORD;
      122    17165    1   DCL RIGHT_LENGTH              SBIN WORD;
      123    17166    1   DCL RIGHT_STARTS              SBIN WORD;
      124    17167    1   DCL SCRATCH_LENGTH            SBIN WORD;
      125    17168    1   DCL COMP_2_WORD               SBIN WORD;
      126    17169    1   DCL COMP_1_WORD               REDEF COMP_2_WORD SBIN WORD;
      127    17170    1   DCL 1 COMP_1                  REDEF COMP_2_WORD,
      128    17171    1        2 *                      SBIN HALF UNAL,
      129    17172    1        2 LOWER_HALF             SBIN HALF UNAL;
      130    17173    1   DCL CONST_DESC_WORD    SBIN WORD;
      131    17174    1   DCL 1 CONST_DESC       REDEF CONST_DESC_WORD,
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:97   
      132    17175            %DESCRIPTOR (LVL = 2, ENDING = YES);
      133    17203    1   DCL TEMP_DESC_WORD     SBIN WORD;
      134    17204    1   DCL 1 TEMP_DESC        REDEF TEMP_DESC_WORD ALIGNED,
      135    17205            %DESCRIPTOR (LVL = 2, ENDING = YES);
      136    17233    1   DCL CONST_TEMP         CHAR(63);
      137    17234
      138    17235        %DCL_NUM_DESC (@STRN = NUM_DESC);
      139    17244
      140    17245        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:98   
      141    17246        /*
      142    17247                               Macros
      143    17248        */
      144    17249        %MACRO GET_REAL_CONSTANT( @TYPE = ,
      145    17250                                  @STK$ = );
      146    17251            DO SELECT(  @STK$ -> LX_ITEM.SYMBOL );
      147    17252
      148    17253                SELECT( %NUMBER, %NUMERIC_LITERAL, %NUMBER_OR_PARAGRAPH );
      149    17254
      150    17255                    %IF @TYPE = %TYR;
      151    17256                       CALL Z8EC$FLOAT( DNT$$ -> DNT.TEXT.NAME,
      152    17257                                        BINBIT( DNT$$ -> DNT.TEXT.LENGTH,36),
      153    17258                                        LITERAL_SYMBOL,
      154    17259                                        VALUE_OVERFLOW );
      155    17260                    %ELSE;
      156    17261                       CALL Z8EC$DOUBLE_FLOAT( DNT$$ -> DNT.TEXT.NAME,
      157    17262                                        BINBIT( DNT$$ -> DNT.TEXT.LENGTH,36),
      158    17263                                        LITERAL_SYMBOL,
      159    17264                                        VALUE_OVERFLOW );
      160    17265                    %ENDIF;
      161    17266
      162    17267                SELECT( ELSE );
      163    17268
      164    17269                    CALL CREATE_ALPHA_OR_FIG_CONST
      165    17270                      WHENRETURN
      166    17271                      DO;
      167    17272                        %IF @TYPE = %TYR;
      168    17273                           CALL Z8EC$FLOAT( LITERAL_SYMBOL,
      169    17274                                            CONSTANT_LENGTH,
      170    17275                                            LITERAL_SYMBOL,
      171    17276                                            VALUE_OVERFLOW );
      172    17277                        %ELSE;
      173    17278                           CALL Z8EC$DOUBLE_FLOAT( LITERAL_SYMBOL,
      174    17279                                                   CONSTANT_LENGTH,
      175    17280                                                   LITERAL_SYMBOL,
      176    17281                                                   VALUE_OVERFLOW );
      177    17282                        %ENDIF;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:99   
      178    17283                      END;
      179    17284            END;  /*  SELECT  */
      180    17285        %MEND;
      181    17286        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:100  
      182    17287        %MACRO SRCH_FOR_IDENTICAL_CONSTANTS (@TYPE = %TYI);
      183    17288
      184    17289         DO;
      185    17290           %ASSIGN_SYM$_THE_DNT_ST$;
      186    17291
      187    17292           DO WHILE (SYM$ ~= ADDR(NIL));
      188    17293             IF
      189    17294                 %IF @TYPE = TYI;
      190    17295                 SYM$ -> CONST.ID = %CONST AND
      191    17296                 /* It is probably a genuine CONST, but make sure.
      192    17297                    TYPE can be TYI for paragraph and section labels, too. */
      193    17298                 %ENDIF;
      194    17299                 SYM$ -> CONST.TYPE = @TYPE THEN
      195    17300               %IF_SEGMENT_COUNT_VALID_THEN;
      196    17301               EXIT;
      197    17302             SYM$ = SYM$ -> CONST.NEXT;
      198    17303           END; /* While */
      199    17304         END;
      200    17305
      201    17306        %MEND;
      202    17307        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:101  
      203    17308        %MACRO TYA_SRCH (@ST$ = SYM$);
      204    17309
      205    17310                  DO WHILE (@ST$ ~= ADDR(NIL));
      206    17311                    IF @ST$ -> CONST.TYPE = %TYA THEN
      207    17312                      IF @ST$ -> CONST.B.ALL = CONST$ -> LX_ITEM.B.ALL THEN
      208    17313                        IF @ST$ -> CONST.ADSC.CN = CHAR_POS THEN
      209    17314                          %IF_SEGMENT_COUNT_VALID_THEN;
      210    17315                          EXIT;
      211    17316                    @ST$ = @ST$ -> CONST.NEXT;
      212    17317                  END; /* Until @st$ = addr(nil) */
      213    17318
      214    17319        %MEND;
      215    17320
      216    17321        %MACRO TYE_SRCH (@ST$ = SYM$);
      217    17322
      218    17323                  DO WHILE (@ST$ ~= ADDR(NIL));
      219    17324                    IF @ST$ -> CONST.TYPE = %TYE THEN
      220    17325                      IF @ST$ -> CONST.B.ALL = CONST$ -> LX_ITEM.B.ALL THEN
      221    17326                        IF @ST$ -> CONST.ADSC.CN = CHAR_POS THEN
      222    17327                          %IF_SEGMENT_COUNT_VALID_THEN;
      223    17328                          EXIT;
      224    17329                    @ST$ = @ST$ -> CONST.NEXT;
      225    17330                  END; /* Until @st$ = addr(nil) */
      226    17331
      227    17332        %MEND;
      228    17333
      229    17334        %MACRO TYB_SRCH (@ST$ = SYM$);
      230    17335
      231    17336                  DO WHILE (@ST$ ~= ADDR(NIL));
      232    17337                    IF @ST$ -> CONST.TYPE = %TYB THEN
      233    17338                      IF @ST$ -> CONST.B.ALL = CONST$ -> LX_ITEM.B.ALL THEN
      234    17339                        IF @ST$ -> CONST.ADSC.CN = CHAR_POS THEN
      235    17340                          %IF_SEGMENT_COUNT_VALID_THEN;
      236    17341                          EXIT;
      237    17342                    @ST$ = @ST$ -> CONST.NEXT;
      238    17343                  END; /* Until @st$ = addr(nil) */
      239    17344
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:102  
      240    17345        %MEND;
      241    17346        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:103  
      242    17347        %MACRO ONE_WORD_ALPHA_ITEM;
      243    17348
      244    17349           IF (REC_LENGTH + TYPE_DESC.DESC.ADSC.CN) <= %WORDLEN THEN
      245    17350             DO;
      246    17351               SYM$ -> CONST.CONSTA = %BLANK;
      247    17352               IF SYM$ -> CONST.B.ALL THEN
      248    17353                 SUBSTR (SYM$ -> CONST.CONSTA,
      249    17354                         TYPE_DESC.DESC.ADSC.CN,
      250    17355                         CONSTANT_LENGTH)             = CONST_SYMBOL;
      251    17356               ELSE
      252    17357                 DO;
      253    17358                   SUBSTR (SYM$ -> CONST.CONSTA,
      254    17359                           TYPE_DESC.DESC.ADSC.CN,
      255    17360                           REC_LENGTH)                  = CONST_SYMBOL;
      256    17361                   SYM$ -> CONST.ADSC.CN = TYPE_DESC.DESC.ADSC.CN;
      257    17362                 END;
      258    17363             END;
      259    17364               %SET_ONE_WORD_SYMBOL;
      260    17365
      261    17366        %MEND;
      262    17367        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:104  
      263    17368        %MACRO GTR_1_BUT_LEQ_2_WORD_REC_ITEM;
      264    17369
      265    17370           IF CONSTANT_LENGTH <= %WORDLEN
      266    17371           AND REC_LENGTH ~= %(WORDLEN * 2) THEN
      267    17372             %SET_ONE_WORD_SYMBOL;
      268    17373           ELSE
      269    17374             %SET_TWO_WORD_SYMBOL;
      270    17375
      271    17376        %MEND;
      272    17377        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:105  
      273    17378        %MACRO MULTI_WORD_REC_ITEM;
      274    17379
      275    17380         DO CASE (CONSTANT_LENGTH);
      276    17381
      277    17382           CASE(0,1,2,3,4);
      278    17383             %SET_ONE_WORD_SYMBOL;
      279    17384
      280    17385           CASE(5,6,7,8);
      281    17386             %SET_TWO_WORD_SYMBOL;
      282    17387
      283    17388           CASE(ELSE);
      284    17389             %ENTER_9BIT_CONSTANT_GTR_8_DIGITS;
      285    17390
      286    17391         END; /* Case -- constant_length */
      287    17392
      288    17393        %MEND;
      289    17394        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:106  
      290    17395        %MACRO ASSIGN_VALUE_OR_ST$ (@ST$     = ZERO_ST$,
      291    17396                                    @CONST   = '0');
      292    17397
      293    17398             IF @ST$ = ADDR(NIL) THEN
      294    17399               SUBSTR(LITERAL_SYMBOL,0,1) = @CONST;
      295    17400             ELSE
      296    17401               SYM$ = @ST$;
      297    17402
      298    17403        %MEND;
      299    17404        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:107  
      300    17405        %MACRO GET_CHAR_EQUAL_OF_FIG_CONST (@SYMBOL = %RSV_WRD_SPACES);
      301    17406
      302    17407           CONSTANT_LENGTH = 1;
      303    17408
      304    17409           DO SELECT (@SYMBOL);
      305    17410
      306    17411             SELECT (%RSV_WRD_HIGH_VALUES);
      307    17412               %ASSIGN_VALUE_OR_ST$(
      308    17413                 @CONST = O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.HIGH_VALUE,
      309    17414                                    @ST$   = HIGH_VALUE_ST$);
      310    17415
      311    17416             SELECT (%RSV_WRD_LOW_VALUES);
      312    17417               %ASSIGN_VALUE_OR_ST$(
      313    17418                 @CONST = O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.LOW_VALUE,
      314    17419                                    @ST$   = LOW_VALUE_ST$);
      315    17420
      316    17421             SELECT (%RSV_WRD_QUOTES);
      317    17422               %ASSIGN_VALUE_OR_ST$(@CONST = '"',
      318    17423                                    @ST$   = QUOTE_ST$);
      319    17424
      320    17425             SELECT (%RSV_WRD_SPACES);
      321    17426               IF TO_TYPE = %TYN THEN DO ;
      322    17427                 %ASSIGN_VALUE_OR_ST$(@CONST = %KANJI_SPACE,
      323    17428                                      @ST$   = KANJI_SPACE_ST$);
      324    17429               END ;
      325    17430               ELSE DO ; /* Context not Kanji */
      326    17431                 %ASSIGN_VALUE_OR_ST$(@CONST = ' ',
      327    17432                                      @ST$   = SPACE_ST$);
      328    17433               END ;
      329    17434
      330    17435             SELECT (%RSV_WRD_ZEROES);
      331    17436               %ASSIGN_VALUE_OR_ST$(@CONST = '0',
      332    17437                                    @ST$   = ZERO_ST$);
      333    17438
      334    17439         END; /* Do -- for macro */
      335    17440
      336    17441        %MEND;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:108  
      337    17442        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:109  
      338    17443        %MACRO ASSIGN_NUMERIC_FIG_CONST_ZERO (@TYPE = %TYI);
      339    17444
      340    17445         DO CASE (@TYPE);
      341    17446
      342    17447           CASE(%TYD, %TYO, %TYF);
      343    17448             CONSTANT_LENGTH = 1;
      344    17449             LITERAL_SYMBOL = %CHAR_ZEROS_FOR_TYD;
      345    17450
      346    17451           CASE(%TYI, %TYK);
      347    17452             CONSTANT_LENGTH = 4;
      348    17453             LITERAL_SYMBOL = %ONE_WORD_OF_ZEROS;
      349    17454
      350    17455           CASE(%TYH, %TYJ);
      351    17456             CONSTANT_LENGTH = 2;
      352    17457             LITERAL_SYMBOL = %ONE_WORD_OF_ZEROS;
      353    17458
      354    17459           CASE(%TYQ);
      355    17460             CONSTANT_LENGTH = %TYQ_LENGTH;
      356    17461             REAL_SYMBOL.VALUE = %FLOATING_POINT_ZERO;
      357    17462
      358    17463           CASE(%TYR);
      359    17464             CONSTANT_LENGTH = %TYR_LENGTH;
      360    17465             REAL_SYMBOL.VALUE = %FLOATING_POINT_ZERO;
      361    17466
      362    17467         END; /* Case -- @type */
      363    17468
      364    17469        %MEND;
      365    17470        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:110  
      366    17471        %MACRO ENTER_9BIT_NUMERIC_CONSTANT;
      367    17472
      368    17473           IF CONSTANT_LENGTH > 8 THEN
      369    17474             %ENTER_9BIT_CONSTANT_GTR_8_DIGITS;
      370    17475           ELSE
      371    17476             DO;
      372    17477               SUBSTR(SYM$ -> CONST.CONSTA, 0, CONSTANT_LENGTH) = CONST_SYMBOL;
      373    17478               IF CONSTANT_LENGTH > 4 THEN
      374    17479                 SYM$ -> CONST.B.TWO_WORD = TRUE;
      375    17480             END;
      376    17481
      377    17482        %MEND;
      378    17483        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:111  
      379    17484        %MACRO ENTER_4BIT_NUMERIC_CONSTANT;
      380    17485
      381    17486           IF CONSTANT_LENGTH > 16 THEN
      382    17487             %ENTER_4BIT_CONSTANT_GTR_16_DIGITS;
      383    17488           ELSE
      384    17489             DO;
      385    17490               SUBSTR (SYM$ -> CONST.CONSTA, 0, (CONSTANT_LENGTH + 1) / 2)
      386    17491                 = CONST_SYMBOL ;
      387    17492               IF CONSTANT_LENGTH > 8 THEN
      388    17493                 SYM$ -> CONST.B.TWO_WORD = TRUE;
      389    17494             END;
      390    17495
      391    17496        %MEND;
      392    17497        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:112  
      393    17498        %MACRO SET_ONE_WORD_SYMBOL;
      394    17499
      395    17500         DO;
      396    17501           SYM$ -> CONST.CONSTA = CONST_SYMBOL;
      397    17502           SYM$ -> CONST.ADSC.CN = 0;
      398    17503           SYM$ -> CONST.ADSC.N  = CONSTANT_LENGTH;
      399    17504         END;
      400    17505
      401    17506        %MEND;
      402    17507        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:113  
      403    17508        %MACRO SET_TWO_WORD_SYMBOL;
      404    17509
      405    17510         DO;
      406    17511           IF SYM$ -> CONST.B.ALL THEN
      407    17512             SUBSTR(SYM$ -> CONST.CONSTA,
      408    17513                     0,
      409    17514                     CONSTANT_LENGTH)     = CONST_SYMBOL;
      410    17515           ELSE
      411    17516             SUBSTR (SYM$ -> CONST.CONSTA,
      412    17517                     0,
      413    17518                     %(WORDLEN * 2))         = CONST_SYMBOL;
      414    17519
      415    17520           /* Use Kanji Space (241) Filler if Kanji */
      416    17521
      417    17522           IF  SYM$ -> ST.TYPE = %TYN  /* Kanji */
      418    17523           AND CONSTANT_LENGTH < %(WORDLEN * 2) THEN DO ;
      419    17524             DO I = CONSTANT_LENGTH TO %(WORDLEN * 2 - 1) ;
      420    17525               SUBSTR (SYM$ -> CONST.CONSTA, I, 1) = %KANJI_SPACE ;
      421    17526             END ; /* DO I */
      422    17527           END ; /* Kanji & N < 8 */
      423    17528
      424    17529           SYM$ -> CONST.ADSC.CN = 0;
      425    17530        /*#26737*/   /*Six lines deleted here*/
      426    17531             SYM$ -> CONST.ADSC.N = MINIMUM (CONSTANT_LENGTH, %(WORDLEN * 2));
      427    17532
      428    17533           SYM$ -> CONST.B.TWO_WORD = TRUE;
      429    17534           SYM$ -> CONST.B.MOD_2    = TRUE;
      430    17535
      431    17536         END;
      432    17537
      433    17538        %MEND;
      434    17539        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:114  
      435    17540        %MACRO ENTER_9BIT_CONSTANT_GTR_8_DIGITS (@CONSTANT = CONST_SYMBOL,
      436    17541                                                 @LENGTH   = CONSTANT_LENGTH);
      437    17542
      438    17543         DO;
      439    17544           ITERATION = ((@LENGTH + 3) / 4) + 1;
      440    17545           %RESERVE_LTS (ITEM = %LCNST, POINTER = LTSS$);
      441    17546           SUBSTR(LTSS$ -> LCNST.CONST, 0, @LENGTH) = @CONSTANT;
      442    17547           SYM$ -> CONST.CONST$.PTR$ = LTSS$;
      443    17548           SYM$ -> CONST.B.LONG_CONSTANT = TRUE;
      444    17549         END;
      445    17550
      446    17551        %MEND;
      447    17552        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:115  
      448    17553        %MACRO ENTER_4BIT_CONSTANT_GTR_16_DIGITS (@CONSTANT = CONST_SYMBOL,
      449    17554                                                  @LENGTH   = CONSTANT_LENGTH);
      450    17555
      451    17556         DO;
      452    17557           ITERATION = ((@LENGTH + 7) / 8) + 1;
      453    17558           %RESERVE_LTS (ITEM = %LCNST, POINTER = LTSS$);
      454    17559           SUBSTR (LTSS$ -> LCNST.CONST, 0, (@LENGTH + 1) / 2) = @CONSTANT ;
      455    17560           SYM$ -> CONST.CONST$.PTR$ = LTSS$;
      456    17561           SYM$ -> CONST.B.LONG_CONSTANT = TRUE;
      457    17562         END;
      458    17563
      459    17564        %MEND;
      460    17565        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:116  
      461    17566        %MACRO SKIM_LEADING_ZEROS;
      462    17567
      463    17568         DO;
      464    17569           IF LEFT_LENGTH > 0 THEN
      465    17570             DO;
      466    17571               TOTAL_ZEROS = 0;
      467    17572               DO I = 0 TO LEFT_LENGTH - 1;
      468    17573                 IF SUBSTR(LITERAL_SYMBOL,I,1) = '0' THEN
      469    17574                   TOTAL_ZEROS = TOTAL_ZEROS + 1;
      470    17575                 ELSE
      471    17576                   EXIT;
      472    17577               END;
      473    17578
      474    17579               IF TOTAL_ZEROS > 0 THEN
      475    17580                 DO;
      476    17581                   LEFT_LENGTH = LEFT_LENGTH - TOTAL_ZEROS;
      477    17582                   LITERAL_SYMBOL = SUBSTR(LITERAL_SYMBOL,
      478    17583                                    TOTAL_ZEROS, LEFT_LENGTH + RIGHT_LENGTH);
      479    17584                 END;
      480    17585             END;
      481    17586         END;
      482    17587
      483    17588        %MEND;
      484    17589        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:117  
      485    17590        %MACRO SKIM_TRAILING_ZEROS;
      486    17591
      487    17592         DO;
      488    17593           IF RIGHT_LENGTH > 0 THEN
      489    17594             DO;
      490    17595               SCRATCH_LENGTH = RIGHT_LENGTH;
      491    17596               DO I = SCRATCH_LENGTH DOWNTO 1;
      492    17597                 IF SUBSTR(LITERAL_SYMBOL,LEFT_LENGTH + I - 1, 1) = '0' THEN
      493    17598                   RIGHT_LENGTH = RIGHT_LENGTH - 1;
      494    17599                 ELSE
      495    17600                   EXIT;
      496    17601               END;
      497    17602             END;
      498    17603
      499    17604           IF RIGHT_LENGTH + LEFT_LENGTH = 0 THEN
      500    17605             DO;
      501    17606               LITERAL_SYMBOL = CONSTANT_ZERO;
      502    17607               RIGHT_LENGTH = 0;
      503    17608               LEFT_LENGTH  = 1;
      504    17609             END;
      505    17610         END;
      506    17611
      507    17612        %MEND;
      508    17613        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:118  
      509    17614        %MACRO ASSIGN_SYM$_THE_DNT_ST$;
      510    17615
      511    17616         DO;
      512    17617           IF DNT$$ = ADDR(NIL) THEN
      513    17618             SYM$ = ADDR(NIL);
      514    17619           ELSE
      515    17620             SYM$ = DNT$$ -> DNT.ST$;
      516    17621         END;
      517    17622
      518    17623        %MEND;
      519    17624        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:119  
      520    17625        %MACRO CHECK_FOR_SYMBOLIC_CHARACTER;
      521    17626           DO;
      522    17627             IF CONST$ -> LX_TERMINAL.SYMBOL = %ALPHA_LITERAL
      523    17628             AND DNT$$ -> DNT.ST$ ~= ADDR(NIL) THEN
      524    17629               IF DNT$$ -> DNT.ST$ -> ST.ID = %SYM_CHAR THEN
      525    17630                 DO;
      526    17631                   SYM$ = DNT$$ -> DNT.ST$ -> SYMBOLIC_CHAR.CONST$;
      527    17632                   CONSTANT_LENGTH = 1;
      528    17633                   CONSTANT_SYM$ = ADDR (SYM$ -> CONST.CONSTA);
      529    17634                   RETURN;
      530    17635                 END;
      531    17636           END;
      532    17637        %MEND;
      533    17638        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:120  
      534    17639        %MACRO BUILD_OVERPUNCH_CHARACTER (@SIGN           = %PLUS_SIGN_,
      535    17640                                          @RETURN_CHAR    = '0',
      536    17641                                          @IN_CHAR        = '0');
      537    17642
      538    17643         DO;
      539    17644           IF @SIGN = %PLUS_SIGN_ THEN
      540    17645             @RETURN_CHAR = POSITIVE_OVERPUNCH_VECTOR(ASCBIN(@IN_CHAR)-48);
      541    17646           ELSE
      542    17647             @RETURN_CHAR = NEGATIVE_OVERPUNCH_VECTOR(ASCBIN(@IN_CHAR)-48);
      543    17648         END;
      544    17649
      545    17650        %MEND;
      546    17651        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:121  
      547    17652        /*
      548    17653                               Internal Procedures
      549    17654        */
      550    17655    1   GET_NUMERIC_CONSTANT : PROC;

  17655 26 000003   200114 741300       GET_NUMERIC* STX1  ! TYA_CONST$+1,,AUTO

      551    17656
      552    17657    3    DO SELECT (CONST$ -> LX_ITEM.SYMBOL);

  17657 26 000004   200004 470500                    LDP0    @CONST$,,AUTO
        26 000005   000000 471500                    LDP1    0,,PR0
        26 000006   100003 236100                    LDQ     3,,PR1
        26 000007   000025 116007                    CMPQ    21,DL
        26 000010   000015 604000 26                 TMI     s:17657+9
        26 000011   000023 600000 26                 TZE     s:17662
        26 000012   000026 116007                    CMPQ    22,DL
        26 000013   000106 601000 26                 TNZ     s:17699
        26 000014   000020 710000 26                 TRA     s:17659
        26 000015   000002 116007                    CMPQ    2,DL
        26 000016   000106 601000 26                 TNZ     s:17699
        26 000017   000020 710000 26                 TRA     s:17659

      553    17658    3      SELECT (%NUMERIC_LITERAL, %NUMBER_OR_PARAGRAPH);

      554    17659    3        CALL CREATE_ASCII_NUMBER;

  17659 26 000020   002167 701000 26                 TSX1    CREATE_ASCII_NUMBER
        26 000021   000000 011000                    NOP     0
        26 000022   000110 710000 26                 TRA     s:17703

      555    17660
      556    17661    3      SELECT (%NUMBER);

      557    17662    3        CONSTANT_SF = 0;

  17662 26 000023   200010 450100                    STZ     CONSTANT_SF,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:122  

      558    17663    3        CONSTANT_LENGTH = DNT$$ -> DNT.TEXT.LENGTH;

  17663 26 000024   200016 471500                    LDP1    DNT$$,,AUTO
        26 000025   100004 236100                    LDQ     4,,PR1
        26 000026   000022 772000                    QRL     18
        26 000027   200007 756100                    STQ     CONSTANT_LENGTH,,AUTO

      559    17664    3        LITERAL_SYMBOL  = SUBSTR(DNT$$ -> DNT.TEXT.NAME,

  17664 26 000030   100004 220100                    LDX0    4,,PR1
        26 000031   000000 622006                    EAX2    0,QL
        26 000032   040100 100540                    MLR     fill='040'O
        26 000033   100004 400012                    ADSC9   4,,PR1                   cn=2,n=*X2
        26 000034   200017 000077                    ADSC9   LITERAL_SYMBOL,,AUTO     cn=0,n=63

      560    17665    3                                 0, CONSTANT_LENGTH);
      561    17666    3        CONSTANT_SIGNED = FALSE;

  17666 26 000035   200011 450100                    STZ     CONSTANT_SIGNED,,AUTO

      562    17667    3        RIGHT_LENGTH = 0;

  17667 26 000036   200052 450100                    STZ     RIGHT_LENGTH,,AUTO

      563    17668    3        LEFT_LENGTH  = CONSTANT_LENGTH;

  17668 26 000037   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 000040   200051 755100                    STA     LEFT_LENGTH,,AUTO

      564    17669             %SKIM_LEADING_ZEROS;

  17671 26 000041   000072 604400 26                 TMOZ    s:17689

  17673 26 000042   200047 450100                    STZ     TOTAL_ZEROS,,AUTO

  17674 26 000043   200045 450100                    STZ     I,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:123  
        26 000044   000055 710000 26                 TRA     s:17679+1

  17675 26 000045   200045 235100                    LDA     I,,AUTO
        26 000046   040000 106505                    CMPC    fill='040'O
        26 000047   200017 000001                    ADSC9   LITERAL_SYMBOL,A,AUTO    cn=0,n=1
        26 000050   000000 000001 27                 ADSC9   0                        cn=0,n=1
        26 000051   000060 601000 26                 TNZ     s:17680

  17676 26 000052   200047 054100                    AOS     TOTAL_ZEROS,,AUTO
        26 000053   000054 710000 26                 TRA     s:17679

  17679 26 000054   200045 054100                    AOS     I,,AUTO
        26 000055   200045 236100                    LDQ     I,,AUTO
        26 000056   200051 116100                    CMPQ    LEFT_LENGTH,,AUTO
        26 000057   000045 604000 26                 TMI     s:17675

  17680 26 000060   200047 235100                    LDA     TOTAL_ZEROS,,AUTO
        26 000061   000072 604400 26                 TMOZ    s:17689

  17682 26 000062   200051 236100                    LDQ     LEFT_LENGTH,,AUTO
        26 000063   200047 136100                    SBLQ    TOTAL_ZEROS,,AUTO
        26 000064   200051 756100                    STQ     LEFT_LENGTH,,AUTO

  17683 26 000065   200052 036100                    ADLQ    RIGHT_LENGTH,,AUTO
        26 000066   000000 620006                    EAX0    0,QL
        26 000067   040100 100545                    MLR     fill='040'O
        26 000070   200017 000010                    ADSC9   LITERAL_SYMBOL,A,AUTO    cn=0,n=*X0
        26 000071   200017 000077                    ADSC9   LITERAL_SYMBOL,,AUTO     cn=0,n=63

      565    17689    3        IF LEFT_LENGTH = 0 THEN

  17689 26 000072   200051 235100                    LDA     LEFT_LENGTH,,AUTO
        26 000073   000102 601000 26                 TNZ     s:17695

      566    17690    4          DO;

      567    17691    4            LITERAL_SYMBOL = '0';
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:124  

  17691 26 000074   040100 100400                    MLR     fill='040'O
        26 000075   000000 000001 27                 ADSC9   0                        cn=0,n=1
        26 000076   200017 000077                    ADSC9   LITERAL_SYMBOL,,AUTO     cn=0,n=63

      568    17692    4            CONSTANT_LENGTH = 1;

  17692 26 000077   000001 236007                    LDQ     1,DL
        26 000100   200007 756100                    STQ     CONSTANT_LENGTH,,AUTO

      569    17693    4          END;

  17693 26 000101   000103 710000 26                 TRA     s:17696

      570    17694    3        ELSE
      571    17695    3          CONSTANT_LENGTH = LEFT_LENGTH;

  17695 26 000102   200007 755100                    STA     CONSTANT_LENGTH,,AUTO

      572    17696    3        CONSTANT_SYM$   = ADDR(LITERAL_SYMBOL);

  17696 26 000103   200017 630500                    EPPR0   LITERAL_SYMBOL,,AUTO
        26 000104   200014 450500                    STP0    CONSTANT_SYM$,,AUTO
        26 000105   000110 710000 26                 TRA     s:17703

      573    17697
      574    17698    3      SELECT (ELSE);

      575    17699    3        CALL CREATE_ALPHA_OR_FIG_CONST;

  17699 26 000106   000112 701000 26                 TSX1    CREATE_ALPHA_OR_FIG_CONST
        26 000107   000000 011000                    NOP     0

      576    17700
      577    17701    3    END;/* Case -- const$ -> literal.symbol */

      578    17702
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:125  
      579    17703    2   END GET_NUMERIC_CONSTANT;

  17703 26 000110   200114 221300                    LDX1  ! TYA_CONST$+1,,AUTO
        26 000111   000001 702211                    TSX2  ! 1,X1

      580    17704        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:126  
      581    17705    1   CREATE_ALPHA_OR_FIG_CONST: PROC ALTRET;

  17705 26 000112   200120 741300       CREATE_ALPH* STX1  ! @SF+1,,AUTO

      582    17706
      583    17707    2    SYM$ = ADDR(NIL);

  17707 26 000113   000001 236000 27                 LDQ     1
        26 000114   200012 756100                    STQ     SYM$,,AUTO

      584    17708
      585    17709    3    DO CASE (TO_TYPE);

  17709 26 000115   200006 235100                    LDA     TO_TYPE,,AUTO
        26 000116   000020 115007                    CMPA    16,DL
        26 000117   000121 602005 26                 TNC     s:17709+4,AL
        26 000120   000677 710000 26                 TRA     s:17900
        26 000121   000465 710000 26                 TRA     s:17835
        26 000122   000465 710000 26                 TRA     s:17835
        26 000123   000465 710000 26                 TRA     s:17835
        26 000124   000465 710000 26                 TRA     s:17835
        26 000125   000465 710000 26                 TRA     s:17835
        26 000126   000465 710000 26                 TRA     s:17835
        26 000127   000141 710000 26                 TRA     s:17713
        26 000130   000465 710000 26                 TRA     s:17835
        26 000131   000141 710000 26                 TRA     s:17713
        26 000132   000677 710000 26                 TRA     s:17900
        26 000133   000677 710000 26                 TRA     s:17900
        26 000134   000465 710000 26                 TRA     s:17835
        26 000135   000141 710000 26                 TRA     s:17713
        26 000136   000677 710000 26                 TRA     s:17900
        26 000137   000141 710000 26                 TRA     s:17713
        26 000140   000465 710000 26                 TRA     s:17835

      586    17710
      587    17711    3      CASE (%TYA, %TYN, %TYB, %TYE);

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:127  
      588    17712
      589    17713    4        DO SELECT (CONST$ -> LX_ITEM.SYMBOL);

  17713 26 000141   200004 470500                    LDP0    @CONST$,,AUTO
        26 000142   000000 471500                    LDP1    0,,PR0
        26 000143   100003 236100                    LDQ     3,,PR1
        26 000144   000032 116007                    CMPQ    26,DL
        26 000145   000166 604000 26                 TMI     s:17713+21
        26 000146   000376 600000 26                 TZE     s:17803
        26 000147   000543 116007                    CMPQ    355,DL
        26 000150   000160 604000 26                 TMI     s:17713+15
        26 000151   000206 600000 26                 TZE     s:17719
        26 000152   000650 116007                    CMPQ    424,DL
        26 000153   000464 604000 26                 TMI     s:17831
        26 000154   000206 600000 26                 TZE     s:17719
        26 000155   000761 116007                    CMPQ    497,DL
        26 000156   000464 601000 26                 TNZ     s:17831
        26 000157   000206 710000 26                 TRA     s:17719
        26 000160   000351 116007                    CMPQ    233,DL
        26 000161   000464 604000 26                 TMI     s:17831
        26 000162   000206 600000 26                 TZE     s:17719
        26 000163   000433 116007                    CMPQ    283,DL
        26 000164   000464 601000 26                 TNZ     s:17831
        26 000165   000206 710000 26                 TRA     s:17719
        26 000166   000004 116007                    CMPQ    4,DL
        26 000167   000177 604000 26                 TMI     s:17713+30
        26 000170   000324 600000 26                 TZE     s:17785
        26 000171   000025 116007                    CMPQ    21,DL
        26 000172   000464 604000 26                 TMI     s:17831
        26 000173   000406 600000 26                 TZE     s:17807
        26 000174   000026 116007                    CMPQ    22,DL
        26 000175   000464 601000 26                 TNZ     s:17831
        26 000176   000406 710000 26                 TRA     s:17807
        26 000177   000003 116007                    CMPQ    3,DL
        26 000200   000203 604000 26                 TMI     s:17713+34
        26 000201   000324 600000 26                 TZE     s:17785
        26 000202   000464 710000 26                 TRA     s:17831
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:128  
        26 000203   000002 116007                    CMPQ    2,DL
        26 000204   000464 601000 26                 TNZ     s:17831
        26 000205   000406 710000 26                 TRA     s:17807

      590    17714
      591    17715    4          SELECT(%RSV_WRD_QUOTES,         %RSV_WRD_LOW_VALUES,

      592    17716    4               %RSV_WRD_SPACES,         %RSV_WRD_HIGH_VALUES,
      593    17717    4               %RSV_WRD_ZEROES);
      594    17718                 %GET_CHAR_EQUAL_OF_FIG_CONST (@SYMBOL = CONST$ -> LX_ITEM.SYMBOL);

  17719 26 000206   000001 235007                    LDA     1,DL
        26 000207   200007 755100                    STA     CONSTANT_LENGTH,,AUTO

  17720 26 000210   000000 471500                    LDP1    0,,PR0
        26 000211   100003 236100                    LDQ     3,,PR1
        26 000212   000433 116007                    CMPQ    283,DL
        26 000213   000226 604000 26                 TMI     s:17720+14
        26 000214   000244 600000 26                 TZE     s:17734
        26 000215   000650 116007                    CMPQ    424,DL
        26 000216   000223 604000 26                 TMI     s:17720+11
        26 000217   000267 600000 26                 TZE     s:17748
        26 000220   000761 116007                    CMPQ    497,DL
        26 000221   000321 601000 26                 TNZ     s:17776
        26 000222   000312 710000 26                 TRA     s:17769
        26 000223   000543 116007                    CMPQ    355,DL
        26 000224   000321 601000 26                 TNZ     s:17776
        26 000225   000257 710000 26                 TRA     s:17742
        26 000226   000351 116007                    CMPQ    233,DL
        26 000227   000321 601000 26                 TNZ     s:17776
        26 000230   000231 710000 26                 TRA     s:17725

  17725 26 000231   000000 236000 20                 LDQ     HIGH_VALUE_ST$
        26 000232   000001 116000 27                 CMPQ    1
        26 000233   000242 601000 26                 TNZ     s:17728

  17726 26 000234   000057 473400 xsym               LDP3    O1COM+47
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:129  
        26 000235   300001 474500                    LDP4    1,,PR3
        26 000236   400001 236100                    LDQ     1,,PR4
        26 000237   000022 736000                    QLS     18
        26 000240   200017 552140                    STBQ    LITERAL_SYMBOL,'40'O,AUTO
        26 000241   000321 710000 26                 TRA     s:17776

  17728 26 000242   200012 756100                    STQ     SYM$,,AUTO
        26 000243   000321 710000 26                 TRA     s:17776

  17734 26 000244   000000 236000 21                 LDQ     LOW_VALUE_ST$
        26 000245   000001 116000 27                 CMPQ    1
        26 000246   000255 601000 26                 TNZ     s:17737

  17735 26 000247   000057 473400 xsym               LDP3    O1COM+47
        26 000250   300001 474500                    LDP4    1,,PR3
        26 000251   400001 236100                    LDQ     1,,PR4
        26 000252   000011 736000                    QLS     9
        26 000253   200017 552140                    STBQ    LITERAL_SYMBOL,'40'O,AUTO
        26 000254   000321 710000 26                 TRA     s:17776

  17737 26 000255   200012 756100                    STQ     SYM$,,AUTO
        26 000256   000321 710000 26                 TRA     s:17776

  17742 26 000257   000000 236000 22                 LDQ     QUOTE_ST$
        26 000260   000001 116000 27                 CMPQ    1
        26 000261   000265 601000 26                 TNZ     s:17745

  17743 26 000262   042000 236003                    LDQ     17408,DU
        26 000263   200017 552140                    STBQ    LITERAL_SYMBOL,'40'O,AUTO
        26 000264   000321 710000 26                 TRA     s:17776

  17745 26 000265   200012 756100                    STQ     SYM$,,AUTO
        26 000266   000321 710000 26                 TRA     s:17776

  17748 26 000267   200006 235100                    LDA     TO_TYPE,,AUTO
        26 000270   000016 115007                    CMPA    14,DL
        26 000271   000302 601000 26                 TNZ     s:17760
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:130  

  17751 26 000272   000000 236000 24                 LDQ     KANJI_SPACE_ST$
        26 000273   000001 116000 27                 CMPQ    1
        26 000274   000300 601000 26                 TNZ     s:17754

  17752 26 000275   241000 236003                    LDQ     82432,DU
        26 000276   200017 552140                    STBQ    LITERAL_SYMBOL,'40'O,AUTO
        26 000277   000321 710000 26                 TRA     s:17776

  17754 26 000300   200012 756100                    STQ     SYM$,,AUTO

  17756 26 000301   000321 710000 26                 TRA     s:17776

  17760 26 000302   000000 236000 23                 LDQ     SPACE_ST$
        26 000303   000001 116000 27                 CMPQ    1
        26 000304   000310 601000 26                 TNZ     s:17763

  17761 26 000305   040000 236003                    LDQ     16384,DU
        26 000306   200017 552140                    STBQ    LITERAL_SYMBOL,'40'O,AUTO
        26 000307   000321 710000 26                 TRA     s:17776

  17763 26 000310   200012 756100                    STQ     SYM$,,AUTO

  17765 26 000311   000321 710000 26                 TRA     s:17776

  17769 26 000312   000000 236000 25                 LDQ     ZERO_ST$
        26 000313   000001 116000 27                 CMPQ    1
        26 000314   000320 601000 26                 TNZ     s:17772

  17770 26 000315   060000 236003                    LDQ     24576,DU
        26 000316   200017 552140                    STBQ    LITERAL_SYMBOL,'40'O,AUTO
        26 000317   000321 710000 26                 TRA     s:17776

  17772 26 000320   200012 756100                    STQ     SYM$,,AUTO

      595    17776    4            CONSTANT_SYM$ = ADDR(LITERAL_SYMBOL);

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:131  
  17776 26 000321   200017 631500                    EPPR1   LITERAL_SYMBOL,,AUTO
        26 000322   200014 451500                    STP1    CONSTANT_SYM$,,AUTO

      596    17777
      597    17778                 %SEGMENT_COUNT_CHECK;

  17781 26 000323   000677 710000 26                 TRA     s:17900

      598    17783
      599    17784    4          SELECT(%ALPHA_LITERAL,  %SINGLE_QUOTE);

      600    17785    4            IF TO_TYPE = %TYN THEN

  17785 26 000324   000016 115007                    CMPA    14,DL
        26 000325   000330 601000 26                 TNZ     s:17788

      601    17786    4              CONST$ -> LX_TERMINAL.TYPE = %TYN ;

  17786 26 000326   000016 235007                    LDA     14,DL
        26 000327   100004 755100                    STA     4,,PR1

      602    17787
      603    17788    4            CALL Z8EC$INTERNAL_STRING_REP (CONST$, DNT$$);

  17788 26 000330   200016 631500                    EPPR1   DNT$$,,AUTO
        26 000331   200153 451500                    STP1    I+2,,AUTO
        26 000332   200004 236100                    LDQ     @CONST$,,AUTO
        26 000333   200152 756100                    STQ     I+1,,AUTO
        26 000334   200152 630500                    EPPR0   I+1,,AUTO
        26 000335   000002 631400 27                 EPPR1   2
        26 000336   000000 701000 xent               TSX1    Z8EC$INTERNAL_STRING_REP
        26 000337   000000 011000                    NOP     0

      604    17789
      605    17790    4            IF  TO_TYPE = %TYN

  17790 26 000340   200006 235100                    LDA     TO_TYPE,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:132  
        26 000341   000016 115007                    CMPA    14,DL
        26 000342   000364 601000 26                 TNZ     s:17797
        26 000343   200016 470500                    LDP0    DNT$$,,AUTO
        26 000344   000004 220100                    LDX0    4,,PR0
        26 000345   000005 100003                    CMPX0   5,DU
        26 000346   000364 602000 26                 TNC     s:17797
        26 000347   000004 236100                    LDQ     4,,PR0
        26 000350   000777 376007                    ANQ     511,DL
        26 000351   000216 116007                    CMPQ    142,DL
        26 000352   000364 601000 26                 TNZ     s:17797

      606    17791    4            AND DNT$$ -> DNT.TEXT.LENGTH > 4
      607    17792    5            AND SUBSTR(DNT$$ -> DNT.TEXT.NAME, 1, 1) = %KANJI_START THEN DO ;

      608    17793    5              CONSTANT_LENGTH = DNT$$ -> DNT.TEXT.LENGTH - 4 ;

  17793 26 000353   000004 236100                    LDQ     4,,PR0
        26 000354   000022 772000                    QRL     18
        26 000355   000004 136007                    SBLQ    4,DL
        26 000356   200007 756100                    STQ     CONSTANT_LENGTH,,AUTO

      609    17794    5              CONSTANT_SYM$ = ADDR (SUBSTR (DNT$$ -> DNT.TEXT.NAME, 2)) ;

  17794 26 000357   000004 220100                    LDX0    4,,PR0
        26 000360   200016 236100                    LDQ     DNT$$,,AUTO
        26 000361   000005 036003                    ADLQ    5,DU
        26 000362   200014 756100                    STQ     CONSTANT_SYM$,,AUTO

      610    17795    5            END ;

  17795 26 000363   000677 710000 26                 TRA     s:17900

      611    17796    5            ELSE DO ; /* Not a Kanji (Graphic) literal */

      612    17797    5              CONSTANT_LENGTH = DNT$$ -> DNT.TEXT.LENGTH - 2;

  17797 26 000364   200016 470500                    LDP0    DNT$$,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:133  
        26 000365   000004 236100                    LDQ     4,,PR0
        26 000366   000022 772000                    QRL     18
        26 000367   000002 136007                    SBLQ    2,DL
        26 000370   200007 756100                    STQ     CONSTANT_LENGTH,,AUTO

      613    17798    5              CONSTANT_SYM$ = ADDR(SUBSTR(DNT$$ ->

  17798 26 000371   000004 220100                    LDX0    4,,PR0
        26 000372   200016 236100                    LDQ     DNT$$,,AUTO
        26 000373   000003 036000 27                 ADLQ    3
        26 000374   200014 756100                    STQ     CONSTANT_SYM$,,AUTO

      614    17799    5                                          DNT.TEXT.NAME,1));
      615    17800    5            END ;

  17800 26 000375   000677 710000 26                 TRA     s:17900

      616    17801
      617    17802    4          SELECT(%PICTURE_STRING);

      618    17803    4            CONSTANT_LENGTH = DNT$$ -> DNT.TEXT.LENGTH;

  17803 26 000376   200016 473500                    LDP3    DNT$$,,AUTO
        26 000377   300004 236100                    LDQ     4,,PR3
        26 000400   000022 772000                    QRL     18
        26 000401   200007 756100                    STQ     CONSTANT_LENGTH,,AUTO

      619    17804    4            CONSTANT_SYM$   = ADDR(DNT$$ -> DNT.TEXT.NAME);

  17804 26 000402   200016 236100                    LDQ     DNT$$,,AUTO
        26 000403   000004 036000 27                 ADLQ    4
        26 000404   200014 756100                    STQ     CONSTANT_SYM$,,AUTO
        26 000405   000677 710000 26                 TRA     s:17900

      620    17805
      621    17806    4          SELECT(%NUMBER, %NUMERIC_LITERAL, %NUMBER_OR_PARAGRAPH);

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:134  
      622    17807    4            CALL Z8AU$CREATE_NUM_DESC (DNT$$ -> DNT.TEXT.NAME,

  17807 26 000406   200016 473500                    LDP3    DNT$$,,AUTO
        26 000407   300004 236100                    LDQ     4,,PR3
        26 000410   000022 772000                    QRL     18
        26 000411   200152 756100                    STQ     I+1,,AUTO
        26 000412   200100 631500                    EPPR1   NUM_DESC,,AUTO
        26 000413   200156 451500                    STP1    I+5,,AUTO
        26 000414   200152 634500                    EPPR4   I+1,,AUTO
        26 000415   200155 454500                    STP4    I+4,,AUTO
        26 000416   200016 236100                    LDQ     DNT$$,,AUTO
        26 000417   000004 036000 27                 ADLQ    4
        26 000420   200154 756100                    STQ     I+3,,AUTO
        26 000421   200154 630500                    EPPR0   I+3,,AUTO
        26 000422   000005 631400 27                 EPPR1   5
        26 000423   000000 701000 xent               TSX1    Z8AU$CREATE_NUM_DESC
        26 000424   000000 011000                    NOP     0

      623    17808    4                                       BINBIT (DNT$$ ->
      624    17809    4                                               DNT.TEXT.LENGTH, 36),
      625    17810    4                                       NUM_DESC);
      626    17811
      627    17812    5            DO CASE (NUM_DESC.MANTISSA_SIGN_VALUE);

  17812 26 000425   200103 235100                    LDA     NUM_DESC+3,,AUTO
        26 000426   000003 115007                    CMPA    3,DL
        26 000427   000431 602005 26                 TNC     s:17812+4,AL
        26 000430   000457 710000 26                 TRA     s:17825
        26 000431   000434 710000 26                 TRA     s:17814
        26 000432   000445 710000 26                 TRA     s:17819
        26 000433   000445 710000 26                 TRA     s:17819

      628    17813    5              CASE (%NO_SIGN_VALUE);

      629    17814    5                CONSTANT_LENGTH = DNT$$ -> DNT.TEXT.LENGTH;

  17814 26 000434   200016 470500                    LDP0    DNT$$,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:135  
        26 000435   000004 236100                    LDQ     4,,PR0
        26 000436   000022 772000                    QRL     18
        26 000437   200007 756100                    STQ     CONSTANT_LENGTH,,AUTO

      630    17815    5                CONSTANT_SYM$ = ADDR(SUBSTR(DNT$$ ->

  17815 26 000440   000004 220100                    LDX0    4,,PR0
        26 000441   200016 236100                    LDQ     DNT$$,,AUTO
        26 000442   000004 036000 27                 ADLQ    4
        26 000443   200014 756100                    STQ     CONSTANT_SYM$,,AUTO
        26 000444   000677 710000 26                 TRA     s:17900

      631    17816    5                                     DNT.TEXT.NAME,0));
      632    17817
      633    17818    5              CASE (%MINUS_SIGN_VALUE, %PLUS_SIGN_VALUE);

      634    17819    5                CONSTANT_LENGTH = DNT$$ ->

  17819 26 000445   200016 470500                    LDP0    DNT$$,,AUTO
        26 000446   000004 236100                    LDQ     4,,PR0
        26 000447   000022 772000                    QRL     18
        26 000450   000001 136007                    SBLQ    1,DL
        26 000451   200007 756100                    STQ     CONSTANT_LENGTH,,AUTO

      635    17820    5                                  DNT.TEXT.LENGTH - 1;
      636    17821    5                CONSTANT_SYM$   = ADDR(SUBSTR(DNT$$ ->

  17821 26 000452   000004 220100                    LDX0    4,,PR0
        26 000453   200016 236100                    LDQ     DNT$$,,AUTO
        26 000454   000003 036000 27                 ADLQ    3
        26 000455   200014 756100                    STQ     CONSTANT_SYM$,,AUTO
        26 000456   000677 710000 26                 TRA     s:17900

      637    17822    5                                       DNT.TEXT.NAME,1));
      638    17823
      639    17824    5              CASE (ELSE);

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:136  
      640    17825    5                CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);

  17825 26 000457   000010 630400 27                 EPPR0   8
        26 000460   000006 631400 27                 EPPR1   6
        26 000461   000000 701000 xent               TSX1    Z8AE$ERROR
        26 000462   000000 011000                    NOP     0

      641    17826    5            END; /* Case */

  17826 26 000463   000677 710000 26                 TRA     s:17900

      642    17827
      643    17828    4          SELECT(ELSE);

      644    17829                 /* Shouldn't reach here, if it does it is a compiler error*/
      645    17830
      646    17831    4        END; /* Case -- const$ -> ident_literal.symbol */

  17831 26 000464   000677 710000 26                 TRA     s:17900

      647    17832
      648    17833        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:137  
      649    17834    3      CASE(%TYD, %TYH, %TYI, %TYJ, %TYK, %TYO, %TYQ, %TYR, %TYF);

      650    17835    4        DO SELECT (CONST$ -> LX_ITEM.SYMBOL);

  17835 26 000465   200004 470500                    LDP0    @CONST$,,AUTO
        26 000466   000000 471500                    LDP1    0,,PR0
        26 000467   100003 236100                    LDQ     3,,PR1
        26 000470   000004 116007                    CMPQ    4,DL
        26 000471   000474 604000 26                 TMI     s:17835+7
        26 000472   000477 600000 26                 TZE     s:17839
        26 000473   000612 710000 26                 TRA     s:17870
        26 000474   000003 116007                    CMPQ    3,DL
        26 000475   000612 601000 26                 TNZ     s:17870
        26 000476   000477 710000 26                 TRA     s:17839

      651    17836
      652    17837
      653    17838    4          SELECT(%ALPHA_LITERAL,  %SINGLE_QUOTE);

      654    17839    4            CALL Z8EC$INTERNAL_STRING_REP (CONST$, DNT$$);

  17839 26 000477   200016 633500                    EPPR3   DNT$$,,AUTO
        26 000500   200153 453500                    STP3    I+2,,AUTO
        26 000501   200004 236100                    LDQ     @CONST$,,AUTO
        26 000502   200152 756100                    STQ     I+1,,AUTO
        26 000503   200152 630500                    EPPR0   I+1,,AUTO
        26 000504   000002 631400 27                 EPPR1   2
        26 000505   000000 701000 xent               TSX1    Z8EC$INTERNAL_STRING_REP
        26 000506   000000 011000                    NOP     0

      655    17840    4            IF (DNT$$ -> DNT.TEXT.LENGTH - 2) > 63 THEN

  17840 26 000507   200016 470500                    LDP0    DNT$$,,AUTO
        26 000510   000004 220100                    LDX0    4,,PR0
        26 000511   000102 100003                    CMPX0   66,DU
        26 000512   000516 602000 26                 TNC     s:17843

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:138  
      656    17841    4              CONSTANT_LENGTH = 63;

  17841 26 000513   000077 235007                    LDA     63,DL
        26 000514   200007 755100                    STA     CONSTANT_LENGTH,,AUTO
        26 000515   000522 710000 26                 TRA     s:17845

      657    17842    4            ELSE
      658    17843    4              CONSTANT_LENGTH = DNT$$ -> DNT.TEXT.LENGTH - 2;

  17843 26 000516   000004 236100                    LDQ     4,,PR0
        26 000517   000022 772000                    QRL     18
        26 000520   000002 136007                    SBLQ    2,DL
        26 000521   200007 756100                    STQ     CONSTANT_LENGTH,,AUTO

      659    17844
      660    17845    4            CALL SEARCH (INDX, TBL_VALUE, DIGIT_TABLE,

  17845 26 000522   000004 220100                    LDX0    4,,PR0
        26 000523   200007 721100                    LXL1    CONSTANT_LENGTH,,AUTO
        26 000524   000000 164540                    TCT
        26 000525   000004 600011                    ADSC9   4,,PR0                   cn=3,n=*X1
        26 000526   000000 000000 19                 ARG     DIGIT_TABLE
        26 000527   200046 000100                    ARG     INDX,,AUTO
        26 000530   200046 235100                    LDA     INDX,,AUTO
        26 000531   000033 771000                    ARL     27
        26 000532   200042 755100                    STA     TBL_VALUE,,AUTO
        26 000533   200046 551140                    STBA    INDX,'40'O,AUTO

      661    17846    4                         SUBSTR(DNT$$ -> DNT.TEXT.NAME,
      662    17847    4                                1,CONSTANT_LENGTH));
      663    17848
      664    17849    4            IF INDX ~= CONSTANT_LENGTH THEN

  17849 26 000534   200046 236100                    LDQ     INDX,,AUTO
        26 000535   200007 116100                    CMPQ    CONSTANT_LENGTH,,AUTO
        26 000536   000603 600000 26                 TZE     s:17863

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:139  
      665    17850    5              DO;

      666    17851    5                IF NOT CONST$ -> LX_ITEM.B.ERROR THEN

  17851 26 000537   200004 471500                    LDP1    @CONST$,,AUTO
        26 000540   100000 473500                    LDP3    0,,PR1
        26 000541   300000 236100                    LDQ     0,,PR3
        26 000542   400000 316007                    CANQ    -131072,DL
        26 000543   000556 601000 26                 TNZ     s:17854

      667    17852    5                  CALL Z8AE$ERROR (%E$ONLY_UNSIGNED_TYA_TO_NUM,

  17852 26 000544   300006 634500                    EPPR4   6,,PR3
        26 000545   200154 454500                    STP4    I+3,,AUTO
        26 000546   300005 635500                    EPPR5   5,,PR3
        26 000547   200153 455500                    STP5    I+2,,AUTO
        26 000550   000012 236000 27                 LDQ     10
        26 000551   200152 756100                    STQ     I+1,,AUTO
        26 000552   200152 630500                    EPPR0   I+1,,AUTO
        26 000553   000005 631400 27                 EPPR1   5
        26 000554   000000 701000 xent               TSX1    Z8AE$ERROR
        26 000555   000000 011000                    NOP     0

      668    17853    5                       CONST$ -> LX_ITEM.LINE, CONST$ -> LX_ITEM.COLUMN);
      669    17854    5                CONSTANT_SIGNED = FALSE;

  17854 26 000556   200011 450100                    STZ     CONSTANT_SIGNED,,AUTO

      670    17855    5                CONSTANT_LENGTH = 1;

  17855 26 000557   000001 235007                    LDA     1,DL
        26 000560   200007 755100                    STA     CONSTANT_LENGTH,,AUTO

      671    17856    5                CONSTANT_SF     = 0;

  17856 26 000561   200010 450100                    STZ     CONSTANT_SF,,AUTO

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:140  
      672    17857    5                CONSTANT_SYM$ = ADDR(CONSTANT_ONE);

  17857 26 000562   000013 236000 27                 LDQ     11
        26 000563   200014 756100                    STQ     CONSTANT_SYM$,,AUTO

      673    17858    5                LITERAL_SYMBOL = CONSTANT_ONE;

  17858 26 000564   040100 100400                    MLR     fill='040'O
        26 000565   000206 000001 19                 ADSC9   CONSTANT_ONE             cn=0,n=1
        26 000566   200017 000077                    ADSC9   LITERAL_SYMBOL,,AUTO     cn=0,n=63

      674    17859    5                CALL Z8AH$NEW_DNT ('1', 1, CONST$ -> LX_TERMINAL.DNT$);

  17859 26 000567   200004 470500                    LDP0    @CONST$,,AUTO
        26 000570   000000 471500                    LDP1    0,,PR0
        26 000571   100002 633500                    EPPR3   2,,PR1
        26 000572   200154 453500                    STP3    I+3,,AUTO
        26 000573   000016 237000 27                 LDAQ    14
        26 000574   200152 757100                    STAQ    I+1,,AUTO
        26 000575   200152 630500                    EPPR0   I+1,,AUTO
        26 000576   000005 631400 27                 EPPR1   5
        26 000577   000000 701000 xent               TSX1    Z8AH$NEW_DNT
        26 000600   000000 011000                    NOP     0

      675    17860    5                RETURN;

  17860 26 000601   200120 221300                    LDX1  ! @SF+1,,AUTO
        26 000602   000001 702211                    TSX2  ! 1,X1

      676    17861    5              END;
      677    17862
      678    17863    4            LITERAL_SYMBOL = SUBSTR(DNT$$ ->

  17863 26 000603   777777 622010                    EAX2    -1,X0
        26 000604   040100 100540                    MLR     fill='040'O
        26 000605   000004 600012                    ADSC9   4,,PR0                   cn=3,n=*X2
        26 000606   200017 000077                    ADSC9   LITERAL_SYMBOL,,AUTO     cn=0,n=63
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:141  

      679    17864    4                                    DNT.TEXT.NAME,1);
      680    17865
      681    17866    4            CONSTANT_SYM$ = ADDR(LITERAL_SYMBOL);

  17866 26 000607   200017 631500                    EPPR1   LITERAL_SYMBOL,,AUTO
        26 000610   200014 451500                    STP1    CONSTANT_SYM$,,AUTO
        26 000611   000677 710000 26                 TRA     s:17900

      682    17867
      683    17868    4          SELECT(%RSV_WRD_ZEROES, ELSE);

      684    17869                 %ASSIGN_NUMERIC_FIG_CONST_ZERO (@TYPE = TO_TYPE);

  17870 26 000612   000020 115007                    CMPA    16,DL
        26 000613   000615 602005 26                 TNC     s:17870+3,AL
        26 000614   000672 710000 26                 TRA     s:17888
        26 000615   000635 710000 26                 TRA     s:17872
        26 000616   000643 710000 26                 TRA     s:17875
        26 000617   000651 710000 26                 TRA     s:17878
        26 000620   000635 710000 26                 TRA     s:17872
        26 000621   000665 710000 26                 TRA     s:17884
        26 000622   000657 710000 26                 TRA     s:17881
        26 000623   000672 710000 26                 TRA     s:17888
        26 000624   000651 710000 26                 TRA     s:17878
        26 000625   000672 710000 26                 TRA     s:17888
        26 000626   000672 710000 26                 TRA     s:17888
        26 000627   000672 710000 26                 TRA     s:17888
        26 000630   000635 710000 26                 TRA     s:17872
        26 000631   000672 710000 26                 TRA     s:17888
        26 000632   000672 710000 26                 TRA     s:17888
        26 000633   000672 710000 26                 TRA     s:17888
        26 000634   000643 710000 26                 TRA     s:17875

  17872 26 000635   000001 235007                    LDA     1,DL
        26 000636   200007 755100                    STA     CONSTANT_LENGTH,,AUTO

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:142  
  17873 26 000637   040100 100400                    MLR     fill='040'O
        26 000640   000210 000077 19                 ADSC9   CONSTANT_ZERO+1          cn=0,n=63
        26 000641   200017 000077                    ADSC9   LITERAL_SYMBOL,,AUTO     cn=0,n=63
        26 000642   000672 710000 26                 TRA     s:17888

  17875 26 000643   000004 235007                    LDA     4,DL
        26 000644   200007 755100                    STA     CONSTANT_LENGTH,,AUTO

  17876 26 000645   040100 100400                    MLR     fill='040'O
        26 000646   000210 000004 19                 ADSC9   CONSTANT_ZERO+1          cn=0,n=4
        26 000647   200017 000077                    ADSC9   LITERAL_SYMBOL,,AUTO     cn=0,n=63
        26 000650   000672 710000 26                 TRA     s:17888

  17878 26 000651   000002 235007                    LDA     2,DL
        26 000652   200007 755100                    STA     CONSTANT_LENGTH,,AUTO

  17879 26 000653   040100 100400                    MLR     fill='040'O
        26 000654   000210 000004 19                 ADSC9   CONSTANT_ZERO+1          cn=0,n=4
        26 000655   200017 000077                    ADSC9   LITERAL_SYMBOL,,AUTO     cn=0,n=63
        26 000656   000672 710000 26                 TRA     s:17888

  17881 26 000657   000010 235007                    LDA     8,DL
        26 000660   200007 755100                    STA     CONSTANT_LENGTH,,AUTO

  17882 26 000661   000230 237000 19                 LDAQ    CONSTANT_ZERO+17
        26 000662   200017 755100                    STA     LITERAL_SYMBOL,,AUTO
        26 000663   200020 756100                    STQ     LITERAL_SYMBOL+1,,AUTO
        26 000664   000672 710000 26                 TRA     s:17888

  17884 26 000665   000004 235007                    LDA     4,DL
        26 000666   200007 755100                    STA     CONSTANT_LENGTH,,AUTO

  17885 26 000667   000230 237000 19                 LDAQ    CONSTANT_ZERO+17
        26 000670   200017 755100                    STA     LITERAL_SYMBOL,,AUTO
        26 000671   200020 756100                    STQ     LITERAL_SYMBOL+1,,AUTO

      685    17888    4            CONSTANT_SYM$ = ADDR(LITERAL_SYMBOL);
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:143  

  17888 26 000672   200017 631500                    EPPR1   LITERAL_SYMBOL,,AUTO
        26 000673   200014 451500                    STP1    CONSTANT_SYM$,,AUTO

      686    17889    4            CONSTANT_SF = 0;

  17889 26 000674   200010 450100                    STZ     CONSTANT_SF,,AUTO

      687    17890    4            CONSTANT_SIGNED = FALSE;

  17890 26 000675   200011 450100                    STZ     CONSTANT_SIGNED,,AUTO

      688    17891    4            ALTRETURN;

  17891 26 000676   000000 702211                    TSX2  ! 0,X1

      689    17892
      690    17893    4        END; /* Case -- const.symbol */

      691    17894
      692    17895    3      CASE (ELSE);

      693    17896    3            ;
      694    17897
      695    17898    3    END; /* Case -- const_type */

      696    17899
      697    17900    2    CONSTANT_SF = 0;

  17900 26 000677   200010 450100                    STZ     CONSTANT_SF,,AUTO

      698    17901    2    CONSTANT_SIGNED = FALSE;

  17901 26 000700   200011 450100                    STZ     CONSTANT_SIGNED,,AUTO

      699    17902
      700    17903    2   END; /* Proc */
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:144  

  17903 26 000701   200120 221300                    LDX1  ! @SF+1,,AUTO
        26 000702   000001 702211                    TSX2  ! 1,X1

      701    17904        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:145  
      702    17905    1   OVERFLOW: PROC (LT_DIGITS, RT_DIGITS) ALTRET;

  17905 26 000703   200122 741300       OVERFLOW     STX1  ! LENGTH+1,,AUTO

      703    17906
      704    17907    2        DCL LT_DIGITS     SBIN;
      705    17908    2        DCL RT_DIGITS     SBIN;
      706    17909
      707    17910
      708    17911
      709    17912    2        IF LT_DIGITS < CONSTANT_LENGTH + CONSTANT_SF THEN

  17912 26 000704   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 000705   200010 036100                    ADLQ    CONSTANT_SF,,AUTO
        26 000706   200123 470500                    LDP0    @LT_DIGITS,,AUTO
        26 000707   000000 116100                    CMPQ    0,,PR0
        26 000710   000714 604400 26                 TMOZ    s:17918

      710    17913    3          DO;

      711    17914    3            VALUE_OVERFLOW = TRUE;

  17914 26 000711   400000 236003                    LDQ     -131072,DU
        26 000712   200041 756100                    STQ     VALUE_OVERFLOW,,AUTO

      712    17915    3            RETURN;

  17915 26 000713   000001 702211                    TSX2  ! 1,X1

      713    17916    3          END;
      714    17917
      715    17918    2        IF RT_DIGITS < - CONSTANT_SF THEN

  17918 26 000714   200124 471500                    LDP1    @RT_DIGITS,,AUTO
        26 000715   200010 336100                    LCQ     CONSTANT_SF,,AUTO
        26 000716   100000 116100                    CMPQ    0,,PR1
        26 000717   000723 604400 26                 TMOZ    s:17924
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:146  

      716    17919    3          DO;

      717    17920    3            VALUE_OVERFLOW = TRUE;

  17920 26 000720   400000 236003                    LDQ     -131072,DU
        26 000721   200041 756100                    STQ     VALUE_OVERFLOW,,AUTO

      718    17921    3            RETURN;

  17921 26 000722   000001 702211                    TSX2  ! 1,X1

      719    17922    3          END;
      720    17923
      721    17924    2        IF  RT_DIGITS = CONSTANT_SF

  17924 26 000723   100000 236100                    LDQ     0,,PR1
        26 000724   200010 116100                    CMPQ    CONSTANT_SF,,AUTO
        26 000725   000732 601000 26                 TNZ     s:17928
        26 000726   000000 236100                    LDQ     0,,PR0
        26 000727   200007 116100                    CMPQ    CONSTANT_LENGTH,,AUTO
        26 000730   000732 601000 26                 TNZ     s:17928

      722    17925    2        AND LT_DIGITS = CONSTANT_LENGTH THEN
      723    17926    2          ALTRETURN;

  17926 26 000731   000000 702211                    TSX2  ! 0,X1

      724    17927
      725    17928    2        RETURN;

  17928 26 000732   000001 702211                    TSX2  ! 1,X1

      726    17929
      727    17930    2   END OVERFLOW;
      728    17931        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:147  
      729    17932    1   VALUE_CHECK: PROC (VALUE);

  17932 26 000733   200112 741300       VALUE_CHECK  STX1  ! CONST_BITS+1,,AUTO

      730    17933
      731    17934    2        DCL VALUE         SBIN;
      732    17935
      733    17936
      734    17937
      735    17938    2        IF NOT CONSTANT_SIGNED THEN

  17938 26 000734   200011 234100                    SZN     CONSTANT_SIGNED,,AUTO
        26 000735   000745 604000 26                 TMI     s:17944

      736    17939    3          DO;

      737    17940    3            IF CONST_VALUE > VALUE THEN

  17940 26 000736   200113 470500                    LDP0    @VALUE,,AUTO
        26 000737   200037 236100                    LDQ     CONST_VALUE,,AUTO
        26 000740   000000 116100                    CMPQ    0,,PR0
        26 000741   000756 604400 26                 TMOZ    s:17948

      738    17941    3              VALUE_OVERFLOW = TRUE;

  17941 26 000742   400000 236003                    LDQ     -131072,DU
        26 000743   200041 756100                    STQ     VALUE_OVERFLOW,,AUTO

      739    17942    3          END;

  17942 26 000744   000756 710000 26                 TRA     s:17948

      740    17943    2        ELSE
      741    17944    2          IF - CONST_VALUE > VALUE + 1 THEN

  17944 26 000745   200113 470500                    LDP0    @VALUE,,AUTO
        26 000746   000000 235100                    LDA     0,,PR0
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:148  
        26 000747   000001 035007                    ADLA    1,DL
        26 000750   200152 755100                    STA     I+1,,AUTO
        26 000751   200037 336100                    LCQ     CONST_VALUE,,AUTO
        26 000752   200152 116100                    CMPQ    I+1,,AUTO
        26 000753   000756 604400 26                 TMOZ    s:17948

      742    17945    2            VALUE_OVERFLOW = TRUE;

  17945 26 000754   400000 236003                    LDQ     -131072,DU
        26 000755   200041 756100                    STQ     VALUE_OVERFLOW,,AUTO

      743    17946
      744    17947
      745    17948    2   END VALUE_CHECK;

  17948 26 000756   000001 702211                    TSX2  ! 1,X1

      746    17949        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:149  
      747    17950    1   NDSC9_OVERFLOW: PROC (TYPE_DESC);

  17950 26 000757   200114 741300       NDSC9_OVERF* STX1  ! TYA_CONST$+1,,AUTO

      748    17951
      749    17952    2        DCL 1 TYPE_DESC   ALIGNED,
      750    17953                  %TYPE_DESC;
      751    17987
      752    17988    2        DCL LENGTH        UBIN;
      753    17989    2        DCL SCALE         SBIN;
      754    17990    2        DCL I             SBIN;
      755    17991
      756    17992
      757    17993    2        IF CONST$ -> LX_TERMINAL.SYMBOL = %RSV_WRD_ZEROES

  17993 26 000760   200004 470500                    LDP0    @CONST$,,AUTO
        26 000761   000000 471500                    LDP1    0,,PR0
        26 000762   100003 235100                    LDA     3,,PR1
        26 000763   000761 115007                    CMPA    497,DL
        26 000764   000776 600000 26                 TZE     s:17995
        26 000765   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 000766   000001 116007                    CMPQ    1,DL
        26 000767   000777 601000 26                 TNZ     s:18007
        26 000770   200014 473500                    LDP3    CONSTANT_SYM$,,AUTO
        26 000771   000000 620006                    EAX0    0,QL
        26 000772   040000 106540                    CMPC    fill='040'O
        26 000773   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
        26 000774   000207 000001 19                 ADSC9   CONSTANT_ZERO            cn=0,n=1
        26 000775   000777 601000 26                 TNZ     s:18007

      758    17994    2        OR (CONSTANT_LENGTH = 1 AND CONST_SYMBOL = CONSTANT_ZERO) THEN
      759    17995    2          RETURN;

  17995 26 000776   000001 702211                    TSX2  ! 1,X1

      760    17996
      761    17997             %UNPACK_NDSC (@DESC    = TYPE_DESC.DESC,
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:150  
      762    17998                           @LENGTH  = LENGTH,
      763    17999                           @SCALE   = SCALE,
      764    18000                           @TYPE    = TYPE_DESC.TYPE);

  18007 26 000777   200115 473500                    LDP3    @TYPE_DESC,,AUTO
        26 001000   300001 236100                    LDQ     1,,PR3
        26 001001   000014 772000                    QRL     12
        26 001002   000003 376007                    ANQ     3,DL
        26 001003   000004 116007                    CMPQ    4,DL
        26 001004   001006 602006 26                 TNC     s:18007+7,QL
        26 001005   001064 710000 26                 TRA     s:18047
        26 001006   001050 710000 26                 TRA     s:18031
        26 001007   001016 710000 26                 TRA     s:18021
        26 001010   001016 710000 26                 TRA     s:18021
        26 001011   001012 710000 26                 TRA     s:18009

  18009 26 001012   300001 236100                    LDQ     1,,PR3
        26 001013   000077 376007                    ANQ     63,DL
        26 001014   200116 756100                    STQ     LENGTH,,AUTO
        26 001015   001064 710000 26                 TRA     s:18047

  18021 26 001016   300000 235100                    LDA     0,,PR3
        26 001017   000003 115007                    CMPA    3,DL
        26 001020   001025 601000 26                 TNZ     s:18023

  18022 26 001021   300001 236100                    LDQ     1,,PR3
        26 001022   000077 376007                    ANQ     63,DL
        26 001023   200116 756100                    STQ     LENGTH,,AUTO
        26 001024   001064 710000 26                 TRA     s:18047

  18023 26 001025   000000 115003                    CMPA    0,DU
        26 001026   001034 601000 26                 TNZ     s:18025

  18024 26 001027   300001 236100                    LDQ     1,,PR3
        26 001030   000077 376007                    ANQ     63,DL
        26 001031   000001 136007                    SBLQ    1,DL
        26 001032   200116 756100                    STQ     LENGTH,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:151  
        26 001033   001064 710000 26                 TRA     s:18047

  18025 26 001034   300001 236100                    LDQ     1,,PR3
        26 001035   040000 316007                    CANQ    16384,DL
        26 001036   001043 600000 26                 TZE     s:18028

  18026 26 001037   300001 236100                    LDQ     1,,PR3
        26 001040   000077 376007                    ANQ     63,DL
        26 001041   200116 756100                    STQ     LENGTH,,AUTO
        26 001042   001064 710000 26                 TRA     s:18047

  18028 26 001043   300001 236100                    LDQ     1,,PR3
        26 001044   000077 376007                    ANQ     63,DL
        26 001045   000001 136007                    SBLQ    1,DL
        26 001046   200116 756100                    STQ     LENGTH,,AUTO
        26 001047   001064 710000 26                 TRA     s:18047

  18031 26 001050   300001 236100                    LDQ     1,,PR3
        26 001051   040000 316007                    CANQ    16384,DL
        26 001052   001060 600000 26                 TZE     s:18034

  18032 26 001053   300001 236100                    LDQ     1,,PR3
        26 001054   000077 376007                    ANQ     63,DL
        26 001055   000003 136007                    SBLQ    3,DL
        26 001056   200116 756100                    STQ     LENGTH,,AUTO
        26 001057   001064 710000 26                 TRA     s:18047

  18034 26 001060   300001 236100                    LDQ     1,,PR3
        26 001061   000077 376007                    ANQ     63,DL
        26 001062   000002 136007                    SBLQ    2,DL
        26 001063   200116 756100                    STQ     LENGTH,,AUTO

  18047 26 001064   300001 236100                    LDQ     1,,PR3
        26 001065   000030 736000                    QLS     24
        26 001066   000036 732000                    QRS     30
        26 001067   200117 756100                    STQ     SCALE,,AUTO

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:152  
      765    18055
      766    18056    2        IF SCALE > 0 THEN

  18056 26 001070   001123 604400 26                 TMOZ    s:18074

      767    18057    3          DO;

      768    18058                 /* Trailing P's -  PIC 99PP */
      769    18059    3            IF CONSTANT_SF > 0 THEN

  18059 26 001071   200010 235100                    LDA     CONSTANT_SF,,AUTO
        26 001072   001076 604400 26                 TMOZ    s:18065

      770    18060    4              DO;

      771    18061    4                VALUE_OVERFLOW = TRUE;

  18061 26 001073   400000 236003                    LDQ     -131072,DU
        26 001074   200041 756100                    STQ     VALUE_OVERFLOW,,AUTO

      772    18062    4                RETURN;

  18062 26 001075   000001 702211                    TSX2  ! 1,X1

      773    18063    4              END;
      774    18064
      775    18065    4            DO I = CONSTANT_LENGTH - 1 DOWNTO LENGTH;

  18065 26 001076   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 001077   000001 135007                    SBLA    1,DL
        26 001100   200120 755100                    STA     I,,AUTO
        26 001101   001116 710000 26                 TRA     s:18071+2

      776    18066    4              IF SUBSTR (CONST_SYMBOL, I, 1) ~= '0' THEN

  18066 26 001102   200014 470500                    LDP0    CONSTANT_SYM$,,AUTO
        26 001103   200120 235100                    LDA     I,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:153  
        26 001104   040000 106505                    CMPC    fill='040'O
        26 001105   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
        26 001106   000000 000001 27                 ADSC9   0                        cn=0,n=1
        26 001107   001114 600000 26                 TZE     s:18071

      777    18067    5                DO;

      778    18068    5                  VALUE_OVERFLOW = TRUE;

  18068 26 001110   400000 236003                    LDQ     -131072,DU
        26 001111   200041 756100                    STQ     VALUE_OVERFLOW,,AUTO

      779    18069    5                  RETURN;

  18069 26 001112   200114 221300                    LDX1  ! TYA_CONST$+1,,AUTO
        26 001113   000001 702211                    TSX2  ! 1,X1

      780    18070    5                END;
      781    18071    4            END; /* Iterated do */

  18071 26 001114   000001 336007                    LCQ     1,DL
        26 001115   200120 056100                    ASQ     I,,AUTO
        26 001116   200120 236100                    LDQ     I,,AUTO
        26 001117   001122 604000 26                 TMI     s:18072
        26 001120   200116 116100                    CMPQ    LENGTH,,AUTO
        26 001121   001102 603000 26                 TRC     s:18066

      782    18072    3          END;

  18072 26 001122   001176 710000 26                 TRA     s:18094

      783    18073    2        ELSE
      784    18074    2          IF - SCALE > LENGTH THEN

  18074 26 001123   000020 676000 27                 ERQ     16
        26 001124   000001 036007                    ADLQ    1,DL
        26 001125   001163 604000 26                 TMI     s:18092
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:154  
        26 001126   200116 116100                    CMPQ    LENGTH,,AUTO
        26 001127   001163 602000 26                 TNC     s:18092
        26 001130   001163 600000 26                 TZE     s:18092

      785    18075    3            DO;

      786    18076                   /* Leading P's - PIC PP99 */
      787    18077    3              IF CONSTANT_LENGTH + CONSTANT_SF > 0 THEN

  18077 26 001131   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 001132   200010 036100                    ADLQ    CONSTANT_SF,,AUTO
        26 001133   001137 604400 26                 TMOZ    s:18083

      788    18078    4                DO;

      789    18079    4                  VALUE_OVERFLOW = TRUE;

  18079 26 001134   400000 236003                    LDQ     -131072,DU
        26 001135   200041 756100                    STQ     VALUE_OVERFLOW,,AUTO

      790    18080    4                  RETURN;

  18080 26 001136   000001 702211                    TSX2  ! 1,X1

      791    18081    4                END;
      792    18082
      793    18083    4              DO I = 0 TO - (SCALE + LENGTH) - 1;

  18083 26 001137   200120 450100                    STZ     I,,AUTO
        26 001140   001154 710000 26                 TRA     s:18089+1

      794    18084    4                IF SUBSTR (CONST_SYMBOL, I, 1) ~= '0' THEN

  18084 26 001141   200014 470500                    LDP0    CONSTANT_SYM$,,AUTO
        26 001142   200120 235100                    LDA     I,,AUTO
        26 001143   040000 106505                    CMPC    fill='040'O
        26 001144   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:155  
        26 001145   000000 000001 27                 ADSC9   0                        cn=0,n=1
        26 001146   001153 600000 26                 TZE     s:18089

      795    18085    5                  DO;

      796    18086    5                    VALUE_OVERFLOW = TRUE;

  18086 26 001147   400000 236003                    LDQ     -131072,DU
        26 001150   200041 756100                    STQ     VALUE_OVERFLOW,,AUTO

      797    18087    5                    RETURN;

  18087 26 001151   200114 221300                    LDX1  ! TYA_CONST$+1,,AUTO
        26 001152   000001 702211                    TSX2  ! 1,X1

      798    18088    5                  END;
      799    18089    4              END; /* Iterated do */

  18089 26 001153   200120 054100                    AOS     I,,AUTO
        26 001154   200117 236100                    LDQ     SCALE,,AUTO
        26 001155   200116 036100                    ADLQ    LENGTH,,AUTO
        26 001156   000020 676000 27                 ERQ     16
        26 001157   000001 036007                    ADLQ    1,DL
        26 001160   200120 116100                    CMPQ    I,,AUTO
        26 001161   001141 605400 26                 TPNZ    s:18084

      800    18090    3            END; /* If */

  18090 26 001162   001176 710000 26                 TRA     s:18094

      801    18091    2          ELSE
      802    18092    2            CALL OVERFLOW (LENGTH + SCALE, - SCALE);

  18092 26 001163   200116 236100                    LDQ     LENGTH,,AUTO
        26 001164   200117 036100                    ADLQ    SCALE,,AUTO
        26 001165   200162 756100                    STQ     I+9,,AUTO
        26 001166   200117 335100                    LCA     SCALE,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:156  
        26 001167   200163 755100                    STA     I+10,,AUTO
        26 001170   200163 631500                    EPPR1   I+10,,AUTO
        26 001171   200124 451500                    STP1    @RT_DIGITS,,AUTO
        26 001172   200162 634500                    EPPR4   I+9,,AUTO
        26 001173   200123 454500                    STP4    @LT_DIGITS,,AUTO
        26 001174   000703 701000 26                 TSX1    OVERFLOW
        26 001175   000000 011000                    NOP     0

      803    18093
      804    18094    2   END NDSC9_OVERFLOW;

  18094 26 001176   200114 221300                    LDX1  ! TYA_CONST$+1,,AUTO
        26 001177   000001 702211                    TSX2  ! 1,X1

      805    18095        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:157  
      806    18096    1   CREATE_INTEGER_CONSTANT: PROC;

  18096 26 001200   200112 741300       CREATE_INTE* STX1  ! CONST_BITS+1,,AUTO

      807    18097
      808    18098    2    IF CONSTANT_SF > 0 THEN

  18098 26 001201   200010 235100                    LDA     CONSTANT_SF,,AUTO
        26 001202   001223 604400 26                 TMOZ    s:18107

      809    18099    3      DO;

      810    18100    3        CALL CHARBIN (CONST_VALUE, CONST_SYMBOL);

  18100 26 001203   200014 470500                    LDP0    CONSTANT_SYM$,,AUTO
        26 001204   200007 720100                    LXL0    CONSTANT_LENGTH,,AUTO
        26 001205   000100 305540                    DTB
        26 001206   000000 030010                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=*X0
        26 001207   200037 000004                    NDSC9   CONST_VALUE,,AUTO        cn=0,s=lsgnf,sf=0,n=4

      811    18101    4        DO I = 1 TO CONSTANT_SF;

  18101 26 001210   000001 236007                    LDQ     1,DL
        26 001211   200045 756100                    STQ     I,,AUTO
        26 001212   001217 710000 26                 TRA     s:18103+1

      812    18102    4          CONST_VALUE = CONST_VALUE * 10;

  18102 26 001213   200037 236100                    LDQ     CONST_VALUE,,AUTO
        26 001214   000012 402007                    MPY     10,DL
        26 001215   200037 756100                    STQ     CONST_VALUE,,AUTO

      813    18103    4        END;

  18103 26 001216   200045 054100                    AOS     I,,AUTO
        26 001217   200045 236100                    LDQ     I,,AUTO
        26 001220   200010 116100                    CMPQ    CONSTANT_SF,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:158  
        26 001221   001213 604400 26                 TMOZ    s:18102

      814    18104    3      END;

  18104 26 001222   001236 710000 26                 TRA     s:18114

      815    18105    2    ELSE
      816    18106    3      DO;

      817    18107    3        CONSTANT_LENGTH = CONSTANT_LENGTH + CONSTANT_SF;

  18107 26 001223   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 001224   200010 036100                    ADLQ    CONSTANT_SF,,AUTO
        26 001225   200007 756100                    STQ     CONSTANT_LENGTH,,AUTO

      818    18108    3        IF CONSTANT_LENGTH > 0 THEN

  18108 26 001226   001235 604400 26                 TMOZ    s:18111

      819    18109    3          CALL CHARBIN (CONST_VALUE, CONST_SYMBOL);

  18109 26 001227   200014 470500                    LDP0    CONSTANT_SYM$,,AUTO
        26 001230   000000 620006                    EAX0    0,QL
        26 001231   000100 305540                    DTB
        26 001232   000000 030010                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=*X0
        26 001233   200037 000004                    NDSC9   CONST_VALUE,,AUTO        cn=0,s=lsgnf,sf=0,n=4
        26 001234   001236 710000 26                 TRA     s:18114

      820    18110    3        ELSE
      821    18111    3          CONST_VALUE = 0;

  18111 26 001235   200037 450100                    STZ     CONST_VALUE,,AUTO

      822    18112    3      END;

      823    18113
      824    18114    3    IF CONSTANT_SIGNED THEN DO;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:159  

  18114 26 001236   200011 234100                    SZN     CONSTANT_SIGNED,,AUTO
        26 001237   001254 605000 26                 TPL     s:18120

      825    18115    3      IF CONST_SYMBOL = %TYI_CHAR_MIN_VALUE

  18115 26 001240   200014 470500                    LDP0    CONSTANT_SYM$,,AUTO
        26 001241   200007 720100                    LXL0    CONSTANT_LENGTH,,AUTO
        26 001242   040000 106540                    CMPC    fill='040'O
        26 001243   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
        26 001244   000232 000013 19                 ADSC9   CONSTANT_ZERO+19         cn=0,n=11
        26 001245   001252 601000 26                 TNZ     s:18117

      826    18116    3        THEN CONST_VALUE = - 34359738367 - 1;

  18116 26 001246   000021 236000 27                 LDQ     17
        26 001247   000020 036000 27                 ADLQ    16
        26 001250   200037 756100                    STQ     CONST_VALUE,,AUTO
        26 001251   001254 710000 26                 TRA     s:18120

      827    18117    3        ELSE CONST_VALUE = - CONST_VALUE;

  18117 26 001252   200037 335100                    LCA     CONST_VALUE,,AUTO
        26 001253   200037 755100                    STA     CONST_VALUE,,AUTO

      828    18118    3    END;

      829    18119
      830    18120    2   END; /* Proc -- create_integer_constant */

  18120 26 001254   200112 221300                    LDX1  ! CONST_BITS+1,,AUTO
        26 001255   000001 702211                    TSX2  ! 1,X1

      831    18121        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:160  
      832    18122    1   RESERVE_CONST_ITEM: PROC (TYPE, DNT$);

  18122 26 001256   200122 741300       RESERVE_CON* STX1  ! LENGTH+1,,AUTO

      833    18123
      834    18124    2   DCL TYPE               SBIN WORD;
      835    18125    2   DCL DNT$               PTR;
      836    18126
      837    18127           %NEW_CONST (@ST$ = SYM$,
      838    18128                       @DNT$ = DNT$,
      839    18129                       @TYPE = TYPE);

  18133 26 001257   000002 236000 4                  LDQ     ST_+2
        26 001260   000013 036007                    ADLQ    11,DL
        26 001261   000003 116000 4                  CMPQ    ST_+3
        26 001262   001273 604000 26                 TMI     s:18135

  18134 26 001263   000022 236000 27                 LDQ     18
        26 001264   200152 756100                    STQ     I+1,,AUTO
        26 001265   200152 630500                    EPPR0   I+1,,AUTO
        26 001266   200153 450500                    STP0    I+2,,AUTO
        26 001267   200153 630500                    EPPR0   I+2,,AUTO
        26 001270   000006 631400 27                 EPPR1   6
        26 001271   000000 701000 xent               TSX1    Z8AR$RESERVER
        26 001272   000000 011000                    NOP     0

  18135 26 001273   000002 236000 4                  LDQ     ST_+2
        26 001274   000022 736000                    QLS     18
        26 001275   000001 036000 4                  ADLQ    ST_+1
        26 001276   200012 756100                    STQ     SYM$,,AUTO

  18136 26 001277   000013 236007                    LDQ     11,DL
        26 001300   000002 056000 4                  ASQ     ST_+2

  18139 26 001301   000767 220003                    LDX0    503,DU
        26 001302   200012 470500                    LDP0    SYM$,,AUTO
        26 001303   000000 740100                    STX0    0,,PR0
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:161  

  18140 26 001304   200012 470500                    LDP0    SYM$,,AUTO
        26 001305   001000 236007                    LDQ     512,DL
        26 001306   000000 552110                    STBQ    0,'10'O,PR0

  18141 26 001307   200012 470500                    LDP0    SYM$,,AUTO
        26 001310   000126 236000 xsym               LDQ     O1COM+86
        26 001311   000000 552104                    STBQ    0,'04'O,PR0

  18142 26 001312   200123 470500                    LDP0    @TYPE,,AUTO
        26 001313   000000 721100                    LXL1    0,,PR0
        26 001314   200012 471500                    LDP1    SYM$,,AUTO
        26 001315   100002 741100                    STX1    2,,PR1

  18143 26 001316   200012 471500                    LDP1    SYM$,,AUTO
        26 001317   100003 450100                    STZ     3,,PR1

  18144 26 001320   000001 236000 27                 LDQ     1
        26 001321   200012 471500                    LDP1    SYM$,,AUTO
        26 001322   100004 756100                    STQ     4,,PR1

  18145 26 001323   200012 471500                    LDP1    SYM$,,AUTO
        26 001324   100005 756100                    STQ     5,,PR1

  18146 26 001325   200124 471500                    LDP1    @DNT$,,AUTO
        26 001326   100000 236100                    LDQ     0,,PR1
        26 001327   200012 473500                    LDP3    SYM$,,AUTO
        26 001330   300006 756100                    STQ     6,,PR3

      840    18170    2      SYM$ -> CONST.TYPE  = TYPE;

  18170 26 001331   000000 721100                    LXL1    0,,PR0
        26 001332   200012 473500                    LDP3    SYM$,,AUTO
        26 001333   300002 741100                    STX1    2,,PR3

      841    18171    2      SYM$ -> CONST.DNT$  = DNT$;

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:162  
  18171 26 001334   100000 236100                    LDQ     0,,PR1
        26 001335   200012 473500                    LDP3    SYM$,,AUTO
        26 001336   300006 756100                    STQ     6,,PR3

      842    18172
      843    18173    2      IF DNT$ = ADDR(NIL) THEN

  18173 26 001337   100000 236100                    LDQ     0,,PR1
        26 001340   000001 116000 27                 CMPQ    1
        26 001341   001346 601000 26                 TNZ     s:18176

      844    18174    2        SYM$ -> CONST.NEXT = ADDR(NIL);

  18174 26 001342   000001 236000 27                 LDQ     1
        26 001343   200012 473500                    LDP3    SYM$,,AUTO
        26 001344   300004 756100                    STQ     4,,PR3
        26 001345   001352 710000 26                 TRA     s:18178

      845    18175    2      ELSE
      846    18176    2        SYM$ -> CONST.NEXT = DNT$ -> DNT.ST$;

  18176 26 001346   100000 473500                    LDP3    0,,PR1
        26 001347   300001 236100                    LDQ     1,,PR3
        26 001350   200012 474500                    LDP4    SYM$,,AUTO
        26 001351   400004 756100                    STQ     4,,PR4

      847    18177
      848    18178    2      NEW_ST = TRUE;

  18178 26 001352   400000 236003                    LDQ     -131072,DU
        26 001353   200040 756100                    STQ     NEW_ST,,AUTO

      849    18179
      850    18180    2   END; /* Proc -- Reserve_const_item */

  18180 26 001354   200122 221300                    LDX1  ! LENGTH+1,,AUTO
        26 001355   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:163  

      851    18181        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:164  
      852    18182    1   BUILD_TYO: PROC;

  18182 26 001356   200112 741300       BUILD_TYO    STX1  ! CONST_BITS+1,,AUTO

      853    18183
      854    18184    2   DCL OVERPUNCH_SIGN     CHAR(1);
      855    18185    2   DCL OVERPUNCH_CHAR     CHAR(1);
      856    18186
      857    18187    2            IF NUM_DESC.MANTISSA_SIGN_VALUE = %NO_SIGN_VALUE THEN

  18187 26 001357   200103 235100                    LDA     NUM_DESC+3,,AUTO
        26 001360   001364 601000 26                 TNZ     s:18190

      858    18188    2              OVERPUNCH_SIGN = %PLUS_SIGN_;

  18188 26 001361   053000 236003                    LDQ     22016,DU
        26 001362   200113 756100                    STQ     OVERPUNCH_SIGN,,AUTO
        26 001363   001373 710000 26                 TRA     s:18194

      859    18189    2            ELSE
      860    18190    2              IF NUM_DESC.MANTISSA_SIGN_VALUE = %PLUS_SIGN_VALUE THEN

  18190 26 001364   000001 115007                    CMPA    1,DL
        26 001365   001371 601000 26                 TNZ     s:18193

      861    18191    2                OVERPUNCH_SIGN = %PLUS_SIGN_;

  18191 26 001366   053000 236003                    LDQ     22016,DU
        26 001367   200113 756100                    STQ     OVERPUNCH_SIGN,,AUTO
        26 001370   001373 710000 26                 TRA     s:18194

      862    18192    2              ELSE
      863    18193    2                OVERPUNCH_SIGN = %MINUS_SIGN_;

  18193 26 001371   055000 236003                    LDQ     23040,DU
        26 001372   200113 756100                    STQ     OVERPUNCH_SIGN,,AUTO

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:165  
      864    18194    2        OVERPUNCH_CHAR = SUBSTR(LITERAL_SYMBOL, 0, 1);

  18194 26 001373   200017 236100                    LDQ     LITERAL_SYMBOL,,AUTO
        26 001374   777000 376003                    ANQ     -512,DU
        26 001375   000023 276000 27                 ORQ     19
        26 001376   200114 756100                    STQ     OVERPUNCH_CHAR,,AUTO

      865    18195
      866    18196             %BUILD_OVERPUNCH_CHARACTER (@SIGN           = OVERPUNCH_SIGN,
      867    18197                                         @RETURN_CHAR    = OVERPUNCH_CHAR,
      868    18198                                         @IN_CHAR        = OVERPUNCH_CHAR);

  18200 26 001377   200113 236100                    LDQ     OVERPUNCH_SIGN,,AUTO
        26 001400   777000 376003                    ANQ     -512,DU
        26 001401   053000 116003                    CMPQ    22016,DU
        26 001402   001411 601000 26                 TNZ     s:18203

  18201 26 001403   200114 236100                    LDQ     OVERPUNCH_CHAR,,AUTO
        26 001404   000033 772000                    QRL     27
        26 001405   040100 100406                    MLR     fill='040'O
        26 001406   000164 000001 19                 ADSC9   DIGIT_TABLE+116,Q        cn=0,n=1
        26 001407   200114 000001                    ADSC9   OVERPUNCH_CHAR,,AUTO     cn=0,n=1
        26 001410   001416 710000 26                 TRA     s:18207

  18203 26 001411   200114 236100                    LDQ     OVERPUNCH_CHAR,,AUTO
        26 001412   000033 772000                    QRL     27
        26 001413   040100 100406                    MLR     fill='040'O
        26 001414   000167 000001 19                 ADSC9   DIGIT_TABLE+119,Q        cn=0,n=1
        26 001415   200114 000001                    ADSC9   OVERPUNCH_CHAR,,AUTO     cn=0,n=1

      869    18206
      870    18207    2        SUBSTR(LITERAL_SYMBOL, 0, 1) = OVERPUNCH_CHAR;

  18207 26 001416   200114 236100                    LDQ     OVERPUNCH_CHAR,,AUTO
        26 001417   200017 552140                    STBQ    LITERAL_SYMBOL,'40'O,AUTO

      871    18208    2   END BUILD_TYO;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:166  

  18208 26 001420   000001 702211                    TSX2  ! 1,X1

      872    18209        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:167  
      873    18210    1   BUILD_TYO_WITH_TYPE_DESC: PROC (TYPE_DESC);

  18210 26 001421   200110 741300       BUILD_TYO_W* STX1  ! @TO_TYPE+1,,AUTO

      874    18211
      875    18212    2   DCL 1 TYPE_DESC        ALIGNED,
      876    18213             %TYPE_DESC;
      877    18247    2   DCL OVERPUNCH_CHAR     CHAR(1);
      878    18248    2   DCL OFFSET             SBIN WORD;
      879    18249    2   DCL OVERPUNCH_SIGN     CHAR(1);
      880    18250
      881    18251
      882    18252    2        IF CONST$ -> LX_TERMINAL.SYMBOL = %NUMERIC_LITERAL

  18252 26 001422   200004 470500                    LDP0    @CONST$,,AUTO
        26 001423   000000 471500                    LDP1    0,,PR0
        26 001424   100003 235100                    LDA     3,,PR1
        26 001425   000026 115007                    CMPA    22,DL
        26 001426   001431 600000 26                 TZE     s:18255
        26 001427   000002 115007                    CMPA    2,DL
        26 001430   001446 601000 26                 TNZ     s:18264

      883    18253    2        OR CONST$ -> LX_TERMINAL.SYMBOL = %NUMBER_OR_PARAGRAPH THEN
      884    18254    3          DO;

      885    18255    3            IF NUM_DESC.MANTISSA_SIGN_VALUE = %NO_SIGN_VALUE THEN

  18255 26 001431   200103 236100                    LDQ     NUM_DESC+3,,AUTO
        26 001432   001436 601000 26                 TNZ     s:18258

      886    18256    3              OVERPUNCH_SIGN = %PLUS_SIGN_;

  18256 26 001433   053000 236003                    LDQ     22016,DU
        26 001434   200114 756100                    STQ     OVERPUNCH_SIGN,,AUTO
        26 001435   001450 710000 26                 TRA     s:18276

      887    18257    3            ELSE
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:168  
      888    18258    3              IF NUM_DESC.MANTISSA_SIGN_VALUE = %PLUS_SIGN_VALUE THEN

  18258 26 001436   000001 116007                    CMPQ    1,DL
        26 001437   001443 601000 26                 TNZ     s:18261

      889    18259    3                OVERPUNCH_SIGN = %PLUS_SIGN_;

  18259 26 001440   053000 236003                    LDQ     22016,DU
        26 001441   200114 756100                    STQ     OVERPUNCH_SIGN,,AUTO
        26 001442   001450 710000 26                 TRA     s:18276

      890    18260    3              ELSE
      891    18261    3                OVERPUNCH_SIGN = %MINUS_SIGN_;

  18261 26 001443   055000 236003                    LDQ     23040,DU
        26 001444   200114 756100                    STQ     OVERPUNCH_SIGN,,AUTO

      892    18262    3          END;

  18262 26 001445   001450 710000 26                 TRA     s:18276

      893    18263    2        ELSE
      894    18264    2          OVERPUNCH_SIGN = %PLUS_SIGN_;

  18264 26 001446   053000 236003                    LDQ     22016,DU
        26 001447   200114 756100                    STQ     OVERPUNCH_SIGN,,AUTO

      895    18265
      896    18266
      897    18267             %PACK_NDSC (@DESC   = CONST_DESC,
      898    18268                         @LENGTH = CONSTANT_LENGTH,
      899    18269                         @SIGN   = %NO_SIGN,
      900    18270                         @TN     = %NDSC9,
      901    18271                         @SCALE  = CONSTANT_SF);

  18276 26 001450   000000 220003                    LDX0    0,DU
        26 001451   200056 740100                    STX0    CONST_DESC_WORD,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:169  

  18277 26 001452   000024 236000 27                 LDQ     20
        26 001453   200056 356100                    ANSQ    CONST_DESC_WORD,,AUTO

  18278 26 001454   000025 236000 27                 LDQ     21
        26 001455   200056 356100                    ANSQ    CONST_DESC_WORD,,AUTO

  18279 26 001456   030000 236007                    LDQ     12288,DL
        26 001457   200056 256100                    ORSQ    CONST_DESC_WORD,,AUTO

  18280 26 001460   200010 236100                    LDQ     CONSTANT_SF,,AUTO
        26 001461   000006 736000                    QLS     6
        26 001462   200056 752102                    STCQ    CONST_DESC_WORD,'02'O,AUTO

  18281 26 001463   000003 235007                    LDA     3,DL
        26 001464   000004 115007                    CMPA    4,DL
        26 001465   001467 602005 26                 TNC     s:18281+4,AL
        26 001466   001505 710000 26                 TRA     s:18321
        26 001467   001502 710000 26                 TRA     s:18312
        26 001470   001476 710000 26                 TRA     s:18288
        26 001471   001476 710000 26                 TRA     s:18288
        26 001472   001473 710000 26                 TRA     s:18283

  18283 26 001473   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 001474   200056 752101                    STCQ    CONST_DESC_WORD,'01'O,AUTO
        26 001475   001505 710000 26                 TRA     s:18321

  18288 26 001476   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 001477   000001 036007                    ADLQ    1,DL
        26 001500   200056 752101                    STCQ    CONST_DESC_WORD,'01'O,AUTO
        26 001501   001505 710000 26                 TRA     s:18321

  18312 26 001502   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 001503   000002 036007                    ADLQ    2,DL
        26 001504   200056 752101                    STCQ    CONST_DESC_WORD,'01'O,AUTO

      902    18320
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:170  
      903    18321    2        CONST_TEMP      = SUBSTR (LITERAL_SYMBOL, 0, CONSTANT_LENGTH);

  18321 26 001505   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 001506   040100 100540                    MLR     fill='040'O
        26 001507   200017 000012                    ADSC9   LITERAL_SYMBOL,,AUTO     cn=0,n=*X2
        26 001510   200060 000077                    ADSC9   CONST_TEMP,,AUTO         cn=0,n=63

      904    18322    2        TEMP_DESC_WORD  = TYPE_DESC.DESC.DESCL;

  18322 26 001511   200111 471500                    LDP1    @TYPE_DESC,,AUTO
        26 001512   100001 236100                    LDQ     1,,PR1
        26 001513   777777 376007                    ANQ     -1,DL
        26 001514   200057 756100                    STQ     TEMP_DESC_WORD,,AUTO

      905    18323    2        TEMP_DESC.NDSC.S= %NO_SIGN;

  18323 26 001515   030000 236007                    LDQ     12288,DL
        26 001516   200057 256100                    ORSQ    TEMP_DESC_WORD,,AUTO

      906    18324    2        TEMP_DESC.NDSC.CN = 0;

  18324 26 001517   000024 236000 27                 LDQ     20
        26 001520   200057 356100                    ANSQ    TEMP_DESC_WORD,,AUTO

      907    18325
      908    18326    2        CALL Z9AU$MOVE_NUMERIC (CONST_DESC.DESCL,

  18326 26 001521   200060 633500                    EPPR3   CONST_TEMP,,AUTO
        26 001522   200152 453500                    STP3    I+1,,AUTO
        26 001523   200017 634500                    EPPR4   LITERAL_SYMBOL,,AUTO
        26 001524   200153 454500                    STP4    I+2,,AUTO
        26 001525   200153 635500                    EPPR5   I+2,,AUTO
        26 001526   200157 455500                    STP5    I+6,,AUTO
        26 001527   200152 636500                    EPPR6   I+1,,AUTO
        26 001530   200156 456500                    STP6    I+5,,AUTO
        26 001531   200160 452500                    STP2    I+7,,AUTO
        26 001532   200160 236100                    LDQ     I+7,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:171  
        26 001533   000027 036000 27                 ADLQ    23
        26 001534   200155 756100                    STQ     I+4,,AUTO
        26 001535   200161 452500                    STP2    I+8,,AUTO
        26 001536   200161 236100                    LDQ     I+8,,AUTO
        26 001537   000030 036000 27                 ADLQ    24
        26 001540   200154 756100                    STQ     I+3,,AUTO
        26 001541   200154 630500                    EPPR0   I+3,,AUTO
        26 001542   000026 631400 27                 EPPR1   22
        26 001543   000000 701000 xent               TSX1    Z9AU$MOVE_NUMERIC
        26 001544   000000 011000                    NOP     0

      909    18327    2                                TEMP_DESC.DESCL,
      910    18328    2                                ADDR(CONST_TEMP),
      911    18329    2                                ADDR(LITERAL_SYMBOL));
      912    18330
      913    18331    2        CONSTANT_LENGTH = TYPE_DESC.DESC.NDSC.N;

  18331 26 001545   200111 470500                    LDP0    @TYPE_DESC,,AUTO
        26 001546   000001 236100                    LDQ     1,,PR0
        26 001547   000077 376007                    ANQ     63,DL
        26 001550   200007 756100                    STQ     CONSTANT_LENGTH,,AUTO

      914    18332    2        CONSTANT_SF = TYPE_DESC.DESC.NDSC.SF;

  18332 26 001551   000001 236100                    LDQ     1,,PR0
        26 001552   000030 736000                    QLS     24
        26 001553   000036 732000                    QRS     30
        26 001554   200010 756100                    STQ     CONSTANT_SF,,AUTO

      915    18333
      916    18334    2        IF TYPE_DESC.DESC.NDSC.S = %TRAILING_SIGN THEN

  18334 26 001555   000001 236100                    LDQ     1,,PR0
        26 001556   030000 376007                    ANQ     12288,DL
        26 001557   020000 116007                    CMPQ    8192,DL
        26 001560   001565 601000 26                 TNZ     s:18337

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:172  
      917    18335    2         OFFSET = CONSTANT_LENGTH -1;

  18335 26 001561   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 001562   000001 135007                    SBLA    1,DL
        26 001563   200113 755100                    STA     OFFSET,,AUTO
        26 001564   001566 710000 26                 TRA     s:18339

      918    18336    2        ELSE
      919    18337    2         OFFSET = 0;

  18337 26 001565   200113 450100                    STZ     OFFSET,,AUTO

      920    18338
      921    18339    2        OVERPUNCH_CHAR = SUBSTR(LITERAL_SYMBOL, OFFSET, 1);

  18339 26 001566   200113 235100                    LDA     OFFSET,,AUTO
        26 001567   040100 100505                    MLR     fill='040'O
        26 001570   200017 000001                    ADSC9   LITERAL_SYMBOL,A,AUTO    cn=0,n=1
        26 001571   200112 000001                    ADSC9   OVERPUNCH_CHAR,,AUTO     cn=0,n=1

      922    18340
      923    18341             %BUILD_OVERPUNCH_CHARACTER (@SIGN           = OVERPUNCH_SIGN,
      924    18342                                         @RETURN_CHAR    = OVERPUNCH_CHAR,
      925    18343                                         @IN_CHAR        = OVERPUNCH_CHAR);

  18345 26 001572   200114 236100                    LDQ     OVERPUNCH_SIGN,,AUTO
        26 001573   777000 376003                    ANQ     -512,DU
        26 001574   053000 116003                    CMPQ    22016,DU
        26 001575   001604 601000 26                 TNZ     s:18348

  18346 26 001576   200112 236100                    LDQ     OVERPUNCH_CHAR,,AUTO
        26 001577   000033 772000                    QRL     27
        26 001600   040100 100406                    MLR     fill='040'O
        26 001601   000164 000001 19                 ADSC9   DIGIT_TABLE+116,Q        cn=0,n=1
        26 001602   200112 000001                    ADSC9   OVERPUNCH_CHAR,,AUTO     cn=0,n=1
        26 001603   001611 710000 26                 TRA     s:18352

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:173  
  18348 26 001604   200112 236100                    LDQ     OVERPUNCH_CHAR,,AUTO
        26 001605   000033 772000                    QRL     27
        26 001606   040100 100406                    MLR     fill='040'O
        26 001607   000167 000001 19                 ADSC9   DIGIT_TABLE+119,Q        cn=0,n=1
        26 001610   200112 000001                    ADSC9   OVERPUNCH_CHAR,,AUTO     cn=0,n=1

      926    18351
      927    18352    2        SUBSTR(LITERAL_SYMBOL, OFFSET, 1) = OVERPUNCH_CHAR;

  18352 26 001611   040105 100500                    MLR     fill='040'O
        26 001612   200112 000001                    ADSC9   OVERPUNCH_CHAR,,AUTO     cn=0,n=1
        26 001613   200017 000001                    ADSC9   LITERAL_SYMBOL,A,AUTO    cn=0,n=1

      928    18353
      929    18354    2   END BUILD_TYO_WITH_TYPE_DESC;

  18354 26 001614   200110 221300                    LDX1  ! @TO_TYPE+1,,AUTO
        26 001615   000001 702211                    TSX2  ! 1,X1

      930    18355        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:174  
      931    18356    1   BUILD_TYF_WITH_TYPE_DESC: PROC (TYPE_DESC);

  18356 26 001616   200110 741300       BUILD_TYF_W* STX1  ! @TO_TYPE+1,,AUTO

      932    18357        /*I*  NAME: BUILD_TYF_WITH_TYPE_DESC
      933    18358           PURPOSE: Build an EBCDIC numeric constant. It will be built as
      934    18359                    ASCII or packed decimal and translated later.
      935    18360        */
      936    18361
      937    18362    2   DCL 1 TYPE_DESC        ALIGNED,
      938    18363             %TYPE_DESC;
      939    18397    2   DCL OVERPUNCH_CHAR     CHAR(1);
      940    18398    2   DCL OFFSET             SBIN WORD;
      941    18399    2   DCL OVERPUNCH_SIGN     CHAR(1);
      942    18400    2   DCL S                  BIT(2);
      943    18401
      944    18402
      945    18403    2        IF TYPE_DESC.DESC.NDSC.TN = %NDSC4 /* Overpunched */ THEN

  18403 26 001617   200111 470500                    LDP0    @TYPE_DESC,,AUTO
        26 001620   000001 236100                    LDQ     1,,PR0
        26 001621   040000 316007                    CANQ    16384,DL
        26 001622   001651 600000 26                 TZE     s:18419

      946    18404    3          DO;

      947    18405    3            IF CONST$ -> LX_TERMINAL.SYMBOL = %NUMERIC_LITERAL

  18405 26 001623   200004 471500                    LDP1    @CONST$,,AUTO
        26 001624   100000 473500                    LDP3    0,,PR1
        26 001625   300003 235100                    LDA     3,,PR3
        26 001626   000026 115007                    CMPA    22,DL
        26 001627   001632 600000 26                 TZE     s:18408
        26 001630   000002 115007                    CMPA    2,DL
        26 001631   001644 601000 26                 TNZ     s:18415

      948    18406    3            OR CONST$ -> LX_TERMINAL.SYMBOL = %NUMBER_OR_PARAGRAPH THEN
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:175  
      949    18407    4              DO;

      950    18408    4                IF NUM_DESC.MANTISSA_SIGN_VALUE = %NO_SIGN_VALUE OR

  18408 26 001632   200103 235100                    LDA     NUM_DESC+3,,AUTO
        26 001633   001636 600000 26                 TZE     s:18410
        26 001634   000001 115007                    CMPA    1,DL
        26 001635   001641 601000 26                 TNZ     s:18412

      951    18409    4                      NUM_DESC.MANTISSA_SIGN_VALUE = %PLUS_SIGN_VALUE THEN
      952    18410    4                  OVERPUNCH_SIGN = %PLUS_SIGN_;

  18410 26 001636   053000 236003                    LDQ     22016,DU
        26 001637   200114 756100                    STQ     OVERPUNCH_SIGN,,AUTO
        26 001640   001646 710000 26                 TRA     s:18416

      953    18411    4                ELSE
      954    18412    4                  OVERPUNCH_SIGN = %MINUS_SIGN_;

  18412 26 001641   055000 236003                    LDQ     23040,DU
        26 001642   200114 756100                    STQ     OVERPUNCH_SIGN,,AUTO

      955    18413    4              END;

  18413 26 001643   001646 710000 26                 TRA     s:18416

      956    18414    3            ELSE
      957    18415    3              OVERPUNCH_SIGN = %PLUS_SIGN_;

  18415 26 001644   053000 236003                    LDQ     22016,DU
        26 001645   200114 756100                    STQ     OVERPUNCH_SIGN,,AUTO

      958    18416    3            S = %NO_SIGN;

  18416 26 001646   600000 236003                    LDQ     -65536,DU
        26 001647   200115 756100                    STQ     S,,AUTO

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:176  
      959    18417    3          END;

  18417 26 001650   001655 710000 26                 TRA     s:18430

      960    18418    2        ELSE /* Not overpunched */
      961    18419    2          S = TYPE_DESC.DESC.NDSC.S;

  18419 26 001651   000001 236100                    LDQ     1,,PR0
        26 001652   000026 736000                    QLS     22
        26 001653   600000 376003                    ANQ     -65536,DU
        26 001654   200115 756100                    STQ     S,,AUTO

      962    18420
      963    18421             %PACK_NDSC (@DESC   = CONST_DESC,
      964    18422                         @LENGTH = CONSTANT_LENGTH,
      965    18423                         @SIGN   = S,
      966    18424                         @TN     = %NDSC9,
      967    18425                         @SCALE  = CONSTANT_SF);

  18430 26 001655   000000 220003                    LDX0    0,DU
        26 001656   200056 740100                    STX0    CONST_DESC_WORD,,AUTO

  18431 26 001657   000024 236000 27                 LDQ     20
        26 001660   200056 356100                    ANSQ    CONST_DESC_WORD,,AUTO

  18432 26 001661   000025 236000 27                 LDQ     21
        26 001662   200056 356100                    ANSQ    CONST_DESC_WORD,,AUTO

  18433 26 001663   200115 236100                    LDQ     S,,AUTO
        26 001664   000026 772000                    QRL     22
        26 001665   200056 676100                    ERQ     CONST_DESC_WORD,,AUTO
        26 001666   030000 376007                    ANQ     12288,DL
        26 001667   200056 656100                    ERSQ    CONST_DESC_WORD,,AUTO

  18434 26 001670   200010 236100                    LDQ     CONSTANT_SF,,AUTO
        26 001671   000006 736000                    QLS     6
        26 001672   200056 752102                    STCQ    CONST_DESC_WORD,'02'O,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:177  

  18435 26 001673   200115 236100                    LDQ     S,,AUTO
        26 001674   000042 772000                    QRL     34
        26 001675   000004 116007                    CMPQ    4,DL
        26 001676   001700 602006 26                 TNC     s:18435+5,QL
        26 001677   001716 710000 26                 TRA     s:18475
        26 001700   001713 710000 26                 TRA     s:18466
        26 001701   001707 710000 26                 TRA     s:18442
        26 001702   001707 710000 26                 TRA     s:18442
        26 001703   001704 710000 26                 TRA     s:18437

  18437 26 001704   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 001705   200056 752101                    STCQ    CONST_DESC_WORD,'01'O,AUTO
        26 001706   001716 710000 26                 TRA     s:18475

  18442 26 001707   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 001710   000001 036007                    ADLQ    1,DL
        26 001711   200056 752101                    STCQ    CONST_DESC_WORD,'01'O,AUTO
        26 001712   001716 710000 26                 TRA     s:18475

  18466 26 001713   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 001714   000002 036007                    ADLQ    2,DL
        26 001715   200056 752101                    STCQ    CONST_DESC_WORD,'01'O,AUTO

      968    18474
      969    18475    2        CONST_TEMP      = SUBSTR (LITERAL_SYMBOL, 0, CONSTANT_LENGTH);

  18475 26 001716   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 001717   040100 100540                    MLR     fill='040'O
        26 001720   200017 000012                    ADSC9   LITERAL_SYMBOL,,AUTO     cn=0,n=*X2
        26 001721   200060 000077                    ADSC9   CONST_TEMP,,AUTO         cn=0,n=63

      970    18476    2        TEMP_DESC_WORD  = TYPE_DESC.DESC.DESCL;

  18476 26 001722   000001 236100                    LDQ     1,,PR0
        26 001723   777777 376007                    ANQ     -1,DL
        26 001724   200057 756100                    STQ     TEMP_DESC_WORD,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:178  

      971    18477    2        TEMP_DESC.NDSC.S= S;

  18477 26 001725   200115 236100                    LDQ     S,,AUTO
        26 001726   000026 772000                    QRL     22
        26 001727   200057 676100                    ERQ     TEMP_DESC_WORD,,AUTO
        26 001730   030000 376007                    ANQ     12288,DL
        26 001731   200057 656100                    ERSQ    TEMP_DESC_WORD,,AUTO

      972    18478    2        TEMP_DESC.NDSC.CN = 0;

  18478 26 001732   000024 236000 27                 LDQ     20
        26 001733   200057 356100                    ANSQ    TEMP_DESC_WORD,,AUTO

      973    18479
      974    18480    2        CALL Z9AU$MOVE_NUMERIC (CONST_DESC.DESCL,

  18480 26 001734   200060 631500                    EPPR1   CONST_TEMP,,AUTO
        26 001735   200152 451500                    STP1    I+1,,AUTO
        26 001736   200017 633500                    EPPR3   LITERAL_SYMBOL,,AUTO
        26 001737   200153 453500                    STP3    I+2,,AUTO
        26 001740   200153 634500                    EPPR4   I+2,,AUTO
        26 001741   200157 454500                    STP4    I+6,,AUTO
        26 001742   200152 635500                    EPPR5   I+1,,AUTO
        26 001743   200156 455500                    STP5    I+5,,AUTO
        26 001744   200160 452500                    STP2    I+7,,AUTO
        26 001745   200160 236100                    LDQ     I+7,,AUTO
        26 001746   000027 036000 27                 ADLQ    23
        26 001747   200155 756100                    STQ     I+4,,AUTO
        26 001750   200161 452500                    STP2    I+8,,AUTO
        26 001751   200161 236100                    LDQ     I+8,,AUTO
        26 001752   000030 036000 27                 ADLQ    24
        26 001753   200154 756100                    STQ     I+3,,AUTO
        26 001754   200154 630500                    EPPR0   I+3,,AUTO
        26 001755   000026 631400 27                 EPPR1   22
        26 001756   000000 701000 xent               TSX1    Z9AU$MOVE_NUMERIC
        26 001757   000000 011000                    NOP     0
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:179  

      975    18481    2                                TEMP_DESC.DESCL,
      976    18482    2                                ADDR(CONST_TEMP),
      977    18483    2                                ADDR(LITERAL_SYMBOL));
      978    18484
      979    18485    2        CONSTANT_LENGTH = TYPE_DESC.DESC.NDSC.N;

  18485 26 001760   200111 470500                    LDP0    @TYPE_DESC,,AUTO
        26 001761   000001 236100                    LDQ     1,,PR0
        26 001762   000077 376007                    ANQ     63,DL
        26 001763   200007 756100                    STQ     CONSTANT_LENGTH,,AUTO

      980    18486
      981    18487    2        IF TYPE_DESC.DESC.NDSC.TN = %NDSC4 /* Overpunched */ THEN

  18487 26 001764   000001 236100                    LDQ     1,,PR0
        26 001765   040000 316007                    CANQ    16384,DL
        26 001766   002025 600000 26                 TZE     s:18511

      982    18488    3          DO;

      983    18489    3            IF TYPE_DESC.DESC.NDSC.S = %TRAILING_SIGN THEN

  18489 26 001767   030000 376007                    ANQ     12288,DL
        26 001770   020000 116007                    CMPQ    8192,DL
        26 001771   001776 601000 26                 TNZ     s:18492

      984    18490    3             OFFSET = CONSTANT_LENGTH -1;

  18490 26 001772   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 001773   000001 135007                    SBLA    1,DL
        26 001774   200113 755100                    STA     OFFSET,,AUTO
        26 001775   001777 710000 26                 TRA     s:18494

      985    18491    3            ELSE
      986    18492    3             OFFSET = 0;

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:180  
  18492 26 001776   200113 450100                    STZ     OFFSET,,AUTO

      987    18493
      988    18494    3            OVERPUNCH_CHAR = SUBSTR(LITERAL_SYMBOL, OFFSET, 1);

  18494 26 001777   200113 235100                    LDA     OFFSET,,AUTO
        26 002000   040100 100505                    MLR     fill='040'O
        26 002001   200017 000001                    ADSC9   LITERAL_SYMBOL,A,AUTO    cn=0,n=1
        26 002002   200112 000001                    ADSC9   OVERPUNCH_CHAR,,AUTO     cn=0,n=1

      989    18495
      990    18496                 %BUILD_OVERPUNCH_CHARACTER (@SIGN           = OVERPUNCH_SIGN,
      991    18497                                             @RETURN_CHAR    = OVERPUNCH_CHAR,
      992    18498                                             @IN_CHAR        = OVERPUNCH_CHAR);

  18500 26 002003   200114 236100                    LDQ     OVERPUNCH_SIGN,,AUTO
        26 002004   777000 376003                    ANQ     -512,DU
        26 002005   053000 116003                    CMPQ    22016,DU
        26 002006   002015 601000 26                 TNZ     s:18503

  18501 26 002007   200112 236100                    LDQ     OVERPUNCH_CHAR,,AUTO
        26 002010   000033 772000                    QRL     27
        26 002011   040100 100406                    MLR     fill='040'O
        26 002012   000164 000001 19                 ADSC9   DIGIT_TABLE+116,Q        cn=0,n=1
        26 002013   200112 000001                    ADSC9   OVERPUNCH_CHAR,,AUTO     cn=0,n=1
        26 002014   002022 710000 26                 TRA     s:18507

  18503 26 002015   200112 236100                    LDQ     OVERPUNCH_CHAR,,AUTO
        26 002016   000033 772000                    QRL     27
        26 002017   040100 100406                    MLR     fill='040'O
        26 002020   000167 000001 19                 ADSC9   DIGIT_TABLE+119,Q        cn=0,n=1
        26 002021   200112 000001                    ADSC9   OVERPUNCH_CHAR,,AUTO     cn=0,n=1

      993    18506
      994    18507    3            SUBSTR(LITERAL_SYMBOL, OFFSET, 1) = OVERPUNCH_CHAR;

  18507 26 002022   040105 100500                    MLR     fill='040'O
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:181  
        26 002023   200112 000001                    ADSC9   OVERPUNCH_CHAR,,AUTO     cn=0,n=1
        26 002024   200017 000001                    ADSC9   LITERAL_SYMBOL,A,AUTO    cn=0,n=1

      995    18508                 /* String will later be transliterated to EBCDIC. */
      996    18509    3          END;

      997    18510
      998    18511    2   END BUILD_TYF_WITH_TYPE_DESC;

  18511 26 002025   200110 221300                    LDX1  ! @TO_TYPE+1,,AUTO
        26 002026   000001 702211                    TSX2  ! 1,X1

      999    18512        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:182  
     1000    18513    1   FLOAT_TO_FIXED: PROC (LEFT_LENGTH, RIGHT_LENGTH, NUM_DESC, DNT$$);

  18513 26 002027   200120 741300       FLOAT_TO_FI* STX1  ! I,,AUTO

     1001    18514
     1002    18515    2        DCL LEFT_LENGTH   SBIN;
     1003    18516    2        DCL RIGHT_LENGTH  SBIN;
     1004    18517    2        DCL DNT$$         PTR;
     1005    18518             %DCL_NUM_DESC     (@STRN = NUM_DESC);
     1006    18527
     1007    18528    2        DCL STARTING_POS  SBIN;
     1008    18529    2        DCL ENDING_POS    SBIN;
     1009    18530    2        DCL EXP_VALUE     SBIN;
     1010    18531    2        DCL NEW_SCALE     SBIN;
     1011    18532    2        DCL TEMP_SYMBOL   CHAR (63);
     1012    18533    2        DCL I             SBIN;
     1013    18534
     1014    18535
     1015    18536    2        IF NUM_DESC.DIGITS_EXPONENT = 0 THEN

  18536 26 002030   200123 470500                    LDP0    @NUM_DESC,,AUTO
        26 002031   000002 235100                    LDA     2,,PR0
        26 002032   002034 601000 26                 TNZ     s:18540

     1016    18537    2          RETURN;

  18537 26 002033   000001 702211                    TSX2  ! 1,X1

     1017    18538
     1018    18539             /* Real number -- normalize exponent, ie. rid of exponent */
     1019    18540    2        CALL XCHARBIN (EXP_VALUE,

  18540 26 002034   200124 471500                    LDP1    @DNT$$,,AUTO
        26 002035   100000 473500                    LDP3    0,,PR1
        26 002036   300004 220100                    LDX0    4,,PR3
        26 002037   300004 236100                    LDQ     4,,PR3
        26 002040   000022 772000                    QRL     18
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:183  
        26 002041   000002 136100                    SBLQ    2,,PR0
        26 002042   000002 722100                    LXL2    2,,PR0
        26 002043   000001 623012                    EAX3    1,X2
        26 002044   000100 305546                    DTB
        26 002045   300004 210013                    NDSC9   4,Q,PR3                  cn=1,s=lsgns,sf=0,n=*X3
        26 002046   200127 000004                    NDSC9   EXP_VALUE,,AUTO          cn=0,s=lsgnf,sf=0,n=4

     1020    18541    2                       SUBSTR (DNT$$ -> DNT.TEXT.NAME,
     1021    18542    2                               DNT$$ -> DNT.TEXT.LENGTH -
     1022    18543    2                               NUM_DESC.DIGITS_EXPONENT - 1,
     1023    18544    2                               NUM_DESC.DIGITS_EXPONENT + 1));
     1024    18545                                    /* +1 For the sign */
     1025    18546
     1026    18547    2        NEW_SCALE = RIGHT_LENGTH - EXP_VALUE;

  18547 26 002047   200122 474500                    LDP4    @RIGHT_LENGTH,,AUTO
        26 002050   400000 236100                    LDQ     0,,PR4
        26 002051   200127 136100                    SBLQ    EXP_VALUE,,AUTO
        26 002052   200130 756100                    STQ     NEW_SCALE,,AUTO

     1027    18548
     1028    18549    2        IF NEW_SCALE < 0 THEN

  18549 26 002053   002106 605000 26                 TPL     s:18565

     1029    18550    3          DO;

     1030    18551                 /* We need to add trailing zeros, and adjust the right
     1031    18552                     length accordingly
     1032    18553                 */
     1033    18554    3            STARTING_POS = RIGHT_LENGTH + LEFT_LENGTH;

  18554 26 002054   200121 475500                    LDP5    @LEFT_LENGTH,,AUTO
        26 002055   400000 236100                    LDQ     0,,PR4
        26 002056   500000 036100                    ADLQ    0,,PR5
        26 002057   200125 756100                    STQ     STARTING_POS,,AUTO

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:184  
     1034    18555    3            ENDING_POS   = STARTING_POS - NEW_SCALE - 1;

  18555 26 002060   200130 136100                    SBLQ    NEW_SCALE,,AUTO
        26 002061   000001 136007                    SBLQ    1,DL
        26 002062   200126 756100                    STQ     ENDING_POS,,AUTO

     1035    18556
     1036    18557    4            DO I = STARTING_POS TO ENDING_POS;

  18557 26 002063   200125 235100                    LDA     STARTING_POS,,AUTO
        26 002064   200151 755100                    STA     I,,AUTO
        26 002065   002073 710000 26                 TRA     s:18559+1

     1037    18558    4              SUBSTR (LITERAL_SYMBOL, I, 1) = '0';

  18558 26 002066   200151 235100                    LDA     I,,AUTO
        26 002067   040105 100400                    MLR     fill='040'O
        26 002070   000000 000001 27                 ADSC9   0                        cn=0,n=1
        26 002071   200017 000001                    ADSC9   LITERAL_SYMBOL,A,AUTO    cn=0,n=1

     1038    18559    4            END; /* Do I = */

  18559 26 002072   200151 054100                    AOS     I,,AUTO
        26 002073   200151 236100                    LDQ     I,,AUTO
        26 002074   200126 116100                    CMPQ    ENDING_POS,,AUTO
        26 002075   002066 604400 26                 TMOZ    s:18558

     1039    18560
     1040    18561    3            LEFT_LENGTH  = LEFT_LENGTH + RIGHT_LENGTH - NEW_SCALE;

  18561 26 002076   200121 470500                    LDP0    @LEFT_LENGTH,,AUTO
        26 002077   200122 471500                    LDP1    @RIGHT_LENGTH,,AUTO
        26 002100   000000 236100                    LDQ     0,,PR0
        26 002101   100000 036100                    ADLQ    0,,PR1
        26 002102   200130 136100                    SBLQ    NEW_SCALE,,AUTO
        26 002103   000000 756100                    STQ     0,,PR0

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:185  
     1041    18562    3            RIGHT_LENGTH = 0;

  18562 26 002104   100000 450100                    STZ     0,,PR1

     1042    18563    3          END; /* NEW_SCALE < 0 */

  18563 26 002105   002165 710000 26                 TRA     s:18593

     1043    18564    2        ELSE
     1044    18565    2          IF - EXP_VALUE > LEFT_LENGTH THEN

  18565 26 002106   200121 475500                    LDP5    @LEFT_LENGTH,,AUTO
        26 002107   200127 336100                    LCQ     EXP_VALUE,,AUTO
        26 002110   500000 116100                    CMPQ    0,,PR5
        26 002111   002157 604400 26                 TMOZ    s:18588

     1045    18566    3            DO;

     1046    18567    3              TEMP_SYMBOL = LITERAL_SYMBOL;

  18567 26 002112   040100 100500                    MLR     fill='040'O
        26 002113   200017 000077                    ADSC9   LITERAL_SYMBOL,,AUTO     cn=0,n=63
        26 002114   200131 000077                    ADSC9   TEMP_SYMBOL,,AUTO        cn=0,n=63

     1047    18568
     1048    18569    3              STARTING_POS = 0;

  18569 26 002115   200125 450100                    STZ     STARTING_POS,,AUTO

     1049    18570    3              ENDING_POS   = - (LEFT_LENGTH + EXP_VALUE) - 1;

  18570 26 002116   500000 236100                    LDQ     0,,PR5
        26 002117   200127 036100                    ADLQ    EXP_VALUE,,AUTO
        26 002120   000020 676000 27                 ERQ     16
        26 002121   200126 756100                    STQ     ENDING_POS,,AUTO

     1050    18571
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:186  
     1051    18572    4              DO I = STARTING_POS TO ENDING_POS;

  18572 26 002122   200125 235100                    LDA     STARTING_POS,,AUTO
        26 002123   200151 755100                    STA     I,,AUTO
        26 002124   002132 710000 26                 TRA     s:18574+1

     1052    18573    4                SUBSTR (LITERAL_SYMBOL, I, 1) = '0';

  18573 26 002125   200151 235100                    LDA     I,,AUTO
        26 002126   040105 100400                    MLR     fill='040'O
        26 002127   000000 000001 27                 ADSC9   0                        cn=0,n=1
        26 002130   200017 000001                    ADSC9   LITERAL_SYMBOL,A,AUTO    cn=0,n=1

     1053    18574    4              END; /* Iterated do */

  18574 26 002131   200151 054100                    AOS     I,,AUTO
        26 002132   200151 236100                    LDQ     I,,AUTO
        26 002133   200126 116100                    CMPQ    ENDING_POS,,AUTO
        26 002134   002125 604400 26                 TMOZ    s:18573

     1054    18575
     1055    18576    3              SUBSTR (LITERAL_SYMBOL,

  18576 26 002135   200122 470500                    LDP0    @RIGHT_LENGTH,,AUTO
        26 002136   200121 471500                    LDP1    @LEFT_LENGTH,,AUTO
        26 002137   000000 236100                    LDQ     0,,PR0
        26 002140   100000 036100                    ADLQ    0,,PR1
        26 002141   200152 756100                    STQ     I+1,,AUTO
        26 002142   000000 236100                    LDQ     0,,PR0
        26 002143   100000 036100                    ADLQ    0,,PR1
        26 002144   000000 620006                    EAX0    0,QL
        26 002145   200152 721100                    LXL1    I+1,,AUTO
        26 002146   200126 235100                    LDA     ENDING_POS,,AUTO
        26 002147   040145 100540                    MLR     fill='040'O
        26 002150   200131 000010                    ADSC9   TEMP_SYMBOL,,AUTO        cn=0,n=*X0
        26 002151   200017 200011                    ADSC9   LITERAL_SYMBOL,A,AUTO    cn=1,n=*X1

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:187  
     1056    18577    3                      ENDING_POS + 1,
     1057    18578    3                      RIGHT_LENGTH + LEFT_LENGTH) = SUBSTR (TEMP_SYMBOL,
     1058    18579    3                                                            0,
     1059    18580    3                                                            RIGHT_LENGTH +
     1060    18581    3                                                            LEFT_LENGTH);
     1061    18582
     1062    18583    3              LEFT_LENGTH = 0;

  18583 26 002152   100000 450100                    STZ     0,,PR1

     1063    18584    3              RIGHT_LENGTH = RIGHT_LENGTH - EXP_VALUE;

  18584 26 002153   000000 236100                    LDQ     0,,PR0
        26 002154   200127 136100                    SBLQ    EXP_VALUE,,AUTO
        26 002155   000000 756100                    STQ     0,,PR0

     1064    18585    3            END; /* If - EXP_VALUE > LEFT_LENGTH */

  18585 26 002156   002165 710000 26                 TRA     s:18593

     1065    18586    2          ELSE
     1066    18587    3            DO;

     1067    18588    3              RIGHT_LENGTH = RIGHT_LENGTH - EXP_VALUE;

  18588 26 002157   400000 236100                    LDQ     0,,PR4
        26 002160   200127 136100                    SBLQ    EXP_VALUE,,AUTO
        26 002161   400000 756100                    STQ     0,,PR4

     1068    18589    3              LEFT_LENGTH  = LEFT_LENGTH + EXP_VALUE;

  18589 26 002162   500000 236100                    LDQ     0,,PR5
        26 002163   200127 036100                    ADLQ    EXP_VALUE,,AUTO
        26 002164   500000 756100                    STQ     0,,PR5

     1069    18590    3            END;

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:188  
     1070    18591
     1071    18592
     1072    18593    2   END FLOAT_TO_FIXED;

  18593 26 002165   200120 221300                    LDX1  ! I,,AUTO
        26 002166   000001 702211                    TSX2  ! 1,X1

     1073    18594        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:189  
     1074    18595    1   CREATE_ASCII_NUMBER: PROC;

  18595 26 002167   200116 741300       CREATE_ASCI* STX1  ! LENGTH,,AUTO

     1075    18596
     1076    18597    2    SYM$ = ADDR(NIL);

  18597 26 002170   000001 236000 27                 LDQ     1
        26 002171   200012 756100                    STQ     SYM$,,AUTO

     1077    18598
     1078    18599    2    CALL Z8AU$CREATE_NUM_DESC (DNT$$ -> DNT.TEXT.NAME,

  18599 26 002172   200016 470500                    LDP0    DNT$$,,AUTO
        26 002173   000004 236100                    LDQ     4,,PR0
        26 002174   000022 772000                    QRL     18
        26 002175   200152 756100                    STQ     I+1,,AUTO
        26 002176   200100 631500                    EPPR1   NUM_DESC,,AUTO
        26 002177   200156 451500                    STP1    I+5,,AUTO
        26 002200   200152 633500                    EPPR3   I+1,,AUTO
        26 002201   200155 453500                    STP3    I+4,,AUTO
        26 002202   200016 236100                    LDQ     DNT$$,,AUTO
        26 002203   000004 036000 27                 ADLQ    4
        26 002204   200154 756100                    STQ     I+3,,AUTO
        26 002205   200154 630500                    EPPR0   I+3,,AUTO
        26 002206   000005 631400 27                 EPPR1   5
        26 002207   000000 701000 xent               TSX1    Z8AU$CREATE_NUM_DESC
        26 002210   000000 011000                    NOP     0

     1079    18600    2                               BINBIT(DNT$$ -> DNT.TEXT.LENGTH,36),
     1080    18601    2                               NUM_DESC);
     1081    18602
     1082    18603    2    RIGHT_STARTS = 0;

  18603 26 002211   200053 450100                    STZ     RIGHT_STARTS,,AUTO

     1083    18604    2    RIGHT_LENGTH = NUM_DESC.DIGITS_RIGHT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:190  

  18604 26 002212   200101 235100                    LDA     NUM_DESC+1,,AUTO
        26 002213   200052 755100                    STA     RIGHT_LENGTH,,AUTO

     1084    18605    2    LEFT_LENGTH = NUM_DESC.DIGITS_LEFT;

  18605 26 002214   200100 236100                    LDQ     NUM_DESC,,AUTO
        26 002215   200051 756100                    STQ     LEFT_LENGTH,,AUTO

     1085    18606
     1086    18607    2    IF NUM_DESC.MANTISSA_SIGN_VALUE = %NO_SIGN_VALUE THEN

  18607 26 002216   200103 235100                    LDA     NUM_DESC+3,,AUTO
        26 002217   002222 601000 26                 TNZ     s:18610

     1087    18608    2      LEFT_STARTS = 0;

  18608 26 002220   200050 450100                    STZ     LEFT_STARTS,,AUTO
        26 002221   002224 710000 26                 TRA     s:18612

     1088    18609    2    ELSE
     1089    18610    2      LEFT_STARTS = 1;

  18610 26 002222   000001 235007                    LDA     1,DL
        26 002223   200050 755100                    STA     LEFT_STARTS,,AUTO

     1090    18611
     1091    18612    2    IF RIGHT_LENGTH > 0 THEN

  18612 26 002224   200052 235100                    LDA     RIGHT_LENGTH,,AUTO
        26 002225   002231 604400 26                 TMOZ    s:18615

     1092    18613    2      RIGHT_STARTS = LEFT_STARTS + LEFT_LENGTH + 1;

  18613 26 002226   200050 036100                    ADLQ    LEFT_STARTS,,AUTO
        26 002227   000001 036007                    ADLQ    1,DL
        26 002230   200053 756100                    STQ     RIGHT_STARTS,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:191  

     1093    18614
     1094    18615    2    CALL CONCAT (LITERAL_SYMBOL,

  18615 26 002231   200016 470500                    LDP0    DNT$$,,AUTO
        26 002232   000004 220100                    LDX0    4,,PR0
        26 002233   200051 721100                    LXL1    LEFT_LENGTH,,AUTO
        26 002234   200050 236100                    LDQ     LEFT_STARTS,,AUTO
        26 002235   040100 100546                    MLR     fill='040'O
        26 002236   000004 400011                    ADSC9   4,Q,PR0                  cn=2,n=*X1
        26 002237   200017 000077                    ADSC9   LITERAL_SYMBOL,,AUTO     cn=0,n=63
        26 002240   200051 236100                    LDQ     LEFT_LENGTH,,AUTO
        26 002241   000077 116007                    CMPQ    63,DL
        26 002242   002252 605000 26                 TPL     s:18621
        26 002243   777700 620006                    EAX0    -64,QL
        26 002244   777777 660003                    ERX0    -1,DU
        26 002245   000000 622005                    EAX2    0,AL
        26 002246   200053 235100                    LDA     RIGHT_STARTS,,AUTO
        26 002247   040146 100545                    MLR     fill='040'O
        26 002250   000004 400012                    ADSC9   4,A,PR0                  cn=2,n=*X2
        26 002251   200017 000010                    ADSC9   LITERAL_SYMBOL,Q,AUTO    cn=0,n=*X0

     1095    18616    2         SUBSTR(DNT$$ -> DNT.TEXT.NAME,
     1096    18617    2                LEFT_STARTS, LEFT_LENGTH),
     1097    18618    2         SUBSTR(DNT$$ -> DNT.TEXT.NAME,
     1098    18619    2                RIGHT_STARTS, RIGHT_LENGTH));
     1099    18620
     1100    18621    2    CALL FLOAT_TO_FIXED (LEFT_LENGTH, RIGHT_LENGTH, NUM_DESC, DNT$$);

  18621 26 002252   200016 630500                    EPPR0   DNT$$,,AUTO
        26 002253   200124 450500                    STP0    @DNT$$,,AUTO
        26 002254   200100 631500                    EPPR1   NUM_DESC,,AUTO
        26 002255   200123 451500                    STP1    @NUM_DESC,,AUTO
        26 002256   200052 633500                    EPPR3   RIGHT_LENGTH,,AUTO
        26 002257   200122 453500                    STP3    @RIGHT_LENGTH,,AUTO
        26 002260   200051 634500                    EPPR4   LEFT_LENGTH,,AUTO
        26 002261   200121 454500                    STP4    @LEFT_LENGTH,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:192  
        26 002262   002027 701000 26                 TSX1    FLOAT_TO_FIXED
        26 002263   000000 011000                    NOP     0

     1101    18622
     1102    18623         %SKIM_LEADING_ZEROS;

  18625 26 002264   200051 235100                    LDA     LEFT_LENGTH,,AUTO
        26 002265   002316 604400 26                 TMOZ    s:18645

  18627 26 002266   200047 450100                    STZ     TOTAL_ZEROS,,AUTO

  18628 26 002267   200045 450100                    STZ     I,,AUTO
        26 002270   002301 710000 26                 TRA     s:18633+1

  18629 26 002271   200045 235100                    LDA     I,,AUTO
        26 002272   040000 106505                    CMPC    fill='040'O
        26 002273   200017 000001                    ADSC9   LITERAL_SYMBOL,A,AUTO    cn=0,n=1
        26 002274   000000 000001 27                 ADSC9   0                        cn=0,n=1
        26 002275   002304 601000 26                 TNZ     s:18634

  18630 26 002276   200047 054100                    AOS     TOTAL_ZEROS,,AUTO
        26 002277   002300 710000 26                 TRA     s:18633

  18633 26 002300   200045 054100                    AOS     I,,AUTO
        26 002301   200045 236100                    LDQ     I,,AUTO
        26 002302   200051 116100                    CMPQ    LEFT_LENGTH,,AUTO
        26 002303   002271 604000 26                 TMI     s:18629

  18634 26 002304   200047 235100                    LDA     TOTAL_ZEROS,,AUTO
        26 002305   002316 604400 26                 TMOZ    s:18645

  18636 26 002306   200051 236100                    LDQ     LEFT_LENGTH,,AUTO
        26 002307   200047 136100                    SBLQ    TOTAL_ZEROS,,AUTO
        26 002310   200051 756100                    STQ     LEFT_LENGTH,,AUTO

  18637 26 002311   200052 036100                    ADLQ    RIGHT_LENGTH,,AUTO
        26 002312   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:193  
        26 002313   040100 100545                    MLR     fill='040'O
        26 002314   200017 000010                    ADSC9   LITERAL_SYMBOL,A,AUTO    cn=0,n=*X0
        26 002315   200017 000077                    ADSC9   LITERAL_SYMBOL,,AUTO     cn=0,n=63

     1103    18643         %SKIM_TRAILING_ZEROS;

  18645 26 002316   200052 235100                    LDA     RIGHT_LENGTH,,AUTO
        26 002317   002337 604400 26                 TMOZ    s:18655

  18647 26 002320   200054 755100                    STA     SCRATCH_LENGTH,,AUTO

  18648 26 002321   200045 755100                    STA     I,,AUTO
        26 002322   002335 710000 26                 TRA     s:18653+1

  18649 26 002323   200051 236100                    LDQ     LEFT_LENGTH,,AUTO
        26 002324   200045 036100                    ADLQ    I,,AUTO
        26 002325   040000 106506                    CMPC    fill='040'O
        26 002326   200016 600001                    ADSC9   DNT$$,Q,AUTO             cn=3,n=1
        26 002327   000000 000001 27                 ADSC9   0                        cn=0,n=1
        26 002330   002337 601000 26                 TNZ     s:18655

  18650 26 002331   000001 336007                    LCQ     1,DL
        26 002332   200052 056100                    ASQ     RIGHT_LENGTH,,AUTO
        26 002333   002334 710000 26                 TRA     s:18653

  18653 26 002334   200045 056100                    ASQ     I,,AUTO
        26 002335   200045 235100                    LDA     I,,AUTO
        26 002336   002323 605400 26                 TPNZ    s:18649

  18655 26 002337   200052 236100                    LDQ     RIGHT_LENGTH,,AUTO
        26 002340   200051 036100                    ADLQ    LEFT_LENGTH,,AUTO
        26 002341   002350 601000 26                 TNZ     s:18664

  18657 26 002342   040100 100400                    MLR     fill='040'O
        26 002343   000207 000001 19                 ADSC9   CONSTANT_ZERO            cn=0,n=1
        26 002344   200017 000077                    ADSC9   LITERAL_SYMBOL,,AUTO     cn=0,n=63

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:194  
  18658 26 002345   200052 450100                    STZ     RIGHT_LENGTH,,AUTO

  18659 26 002346   000001 235007                    LDA     1,DL
        26 002347   200051 755100                    STA     LEFT_LENGTH,,AUTO

     1104    18663
     1105    18664    2    CONSTANT_LENGTH = LEFT_LENGTH + RIGHT_LENGTH;

  18664 26 002350   200051 236100                    LDQ     LEFT_LENGTH,,AUTO
        26 002351   200052 036100                    ADLQ    RIGHT_LENGTH,,AUTO
        26 002352   200007 756100                    STQ     CONSTANT_LENGTH,,AUTO

     1106    18665
     1107    18666    2    IF RIGHT_LENGTH > 0 THEN

  18666 26 002353   200052 235100                    LDA     RIGHT_LENGTH,,AUTO
        26 002354   002360 604400 26                 TMOZ    s:18669

     1108    18667    2      CONSTANT_SF = - RIGHT_LENGTH;

  18667 26 002355   000000 531000                    NEG     0
        26 002356   200010 755100                    STA     CONSTANT_SF,,AUTO
        26 002357   002361 710000 26                 TRA     s:18671

     1109    18668    2    ELSE
     1110    18669    2      CONSTANT_SF = 0;

  18669 26 002360   200010 450100                    STZ     CONSTANT_SF,,AUTO

     1111    18670
     1112    18671    2    IF NUM_DESC.MANTISSA_SIGN_VALUE = %MINUS_SIGN_VALUE THEN

  18671 26 002361   200103 235100                    LDA     NUM_DESC+3,,AUTO
        26 002362   000002 115007                    CMPA    2,DL
        26 002363   002367 601000 26                 TNZ     s:18674

     1113    18672    2      CONSTANT_SIGNED = TRUE;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:195  

  18672 26 002364   400000 236003                    LDQ     -131072,DU
        26 002365   200011 756100                    STQ     CONSTANT_SIGNED,,AUTO
        26 002366   002370 710000 26                 TRA     s:18677

     1114    18673    2    ELSE
     1115    18674    2      CONSTANT_SIGNED = FALSE;

  18674 26 002367   200011 450100                    STZ     CONSTANT_SIGNED,,AUTO

     1116    18675
     1117    18676
     1118    18677    2    CONSTANT_SYM$ = ADDR(LITERAL_SYMBOL);

  18677 26 002370   200017 630500                    EPPR0   LITERAL_SYMBOL,,AUTO
        26 002371   200014 450500                    STP0    CONSTANT_SYM$,,AUTO

     1119    18678
     1120    18679    2   END; /* Proc -- create_ascii_number */

  18679 26 002372   200116 221300                    LDX1  ! LENGTH,,AUTO
        26 002373   000001 702211                    TSX2  ! 1,X1

     1121    18680        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:196  
     1122    18681    1   WRAP_UP: PROC;

  18681 26 002374   200106 741300       WRAP_UP      STX1  ! NUM_DESC+6,,AUTO

     1123    18682
     1124    18683
     1125    18684        /*
     1126    18685                               Wrap up
     1127    18686        */
     1128    18687
     1129    18688    3    DO SELECT (CONST$ -> LX_ITEM.SYMBOL) ;

  18688 26 002375   200004 470500                    LDP0    @CONST$,,AUTO
        26 002376   000000 471500                    LDP1    0,,PR0
        26 002377   100003 236100                    LDQ     3,,PR1
        26 002400   000351 116007                    CMPQ    233,DL
        26 002401   002417 604000 26                 TMI     s:18688+18
        26 002402   002454 600000 26                 TZE     s:18701
        26 002403   000543 116007                    CMPQ    355,DL
        26 002404   002414 604000 26                 TMI     s:18688+15
        26 002405   002476 600000 26                 TZE     s:18711
        26 002406   000650 116007                    CMPQ    424,DL
        26 002407   002541 604000 26                 TMI     s:18735
        26 002410   002507 600000 26                 TZE     s:18716
        26 002411   000761 116007                    CMPQ    497,DL
        26 002412   002541 601000 26                 TNZ     s:18735
        26 002413   002530 710000 26                 TRA     s:18727
        26 002414   000433 116007                    CMPQ    283,DL
        26 002415   002541 601000 26                 TNZ     s:18735
        26 002416   002465 710000 26                 TRA     s:18706
        26 002417   000004 116007                    CMPQ    4,DL
        26 002420   002433 604000 26                 TMI     s:18688+30
        26 002421   002442 600000 26                 TZE     s:18693
        26 002422   000026 116007                    CMPQ    22,DL
        26 002423   002430 604000 26                 TMI     s:18688+27
        26 002424   002442 600000 26                 TZE     s:18693
        26 002425   000032 116007                    CMPQ    26,DL
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:197  
        26 002426   002541 601000 26                 TNZ     s:18735
        26 002427   002442 710000 26                 TRA     s:18693
        26 002430   000025 116007                    CMPQ    21,DL
        26 002431   002541 601000 26                 TNZ     s:18735
        26 002432   002442 710000 26                 TRA     s:18693
        26 002433   000003 116007                    CMPQ    3,DL
        26 002434   002437 604000 26                 TMI     s:18688+34
        26 002435   002442 600000 26                 TZE     s:18693
        26 002436   002541 710000 26                 TRA     s:18735
        26 002437   000002 116007                    CMPQ    2,DL
        26 002440   002541 601000 26                 TNZ     s:18735
        26 002441   002442 710000 26                 TRA     s:18693

     1130    18689
     1131    18690    3      SELECT (%ALPHA_LITERAL, %SINGLE_QUOTE,  %NUMERIC_LITERAL,

     1132    18691    3              %NUMBER,          %NUMBER_OR_PARAGRAPH, %PICTURE_STRING);
     1133    18692
     1134    18693    3        IF DNT$$ ~= ADDR(NIL)

  18693 26 002442   200016 236100                    LDQ     DNT$$,,AUTO
        26 002443   000001 116000 27                 CMPQ    1
        26 002444   002541 600000 26                 TZE     s:18735
        26 002445   200040 234100                    SZN     NEW_ST,,AUTO
        26 002446   002541 605000 26                 TPL     s:18735

     1135    18694    3        AND NEW_ST                               THEN
     1136    18695    4          DO;

     1137    18696    4            DNT$$ -> DNT.ST$ = SYM$;

  18696 26 002447   200012 236100                    LDQ     SYM$,,AUTO
        26 002450   200016 473500                    LDP3    DNT$$,,AUTO
        26 002451   300001 756100                    STQ     1,,PR3

     1138    18697    4            NEW_ST = FALSE;

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:198  
  18697 26 002452   200040 450100                    STZ     NEW_ST,,AUTO

     1139    18698    4          END;

  18698 26 002453   002541 710000 26                 TRA     s:18735

     1140    18699
     1141    18700    3      SELECT (%RSV_WRD_HIGH_VALUES);

     1142    18701    3        IF TO_TYPE = %TYA THEN

  18701 26 002454   200006 235100                    LDA     TO_TYPE,,AUTO
        26 002455   000010 115007                    CMPA    8,DL
        26 002456   002541 601000 26                 TNZ     s:18735

     1143    18702    3          IF HIGH_VALUE_ST$ = ADDR(NIL) THEN

  18702 26 002457   000000 236000 20                 LDQ     HIGH_VALUE_ST$
        26 002460   000001 116000 27                 CMPQ    1
        26 002461   002541 601000 26                 TNZ     s:18735

     1144    18703    3            HIGH_VALUE_ST$ = SYM$;

  18703 26 002462   200012 236100                    LDQ     SYM$,,AUTO
        26 002463   000000 756000 20                 STQ     HIGH_VALUE_ST$
        26 002464   002541 710000 26                 TRA     s:18735

     1145    18704
     1146    18705    3      SELECT (%RSV_WRD_LOW_VALUES);

     1147    18706    3        IF TO_TYPE = %TYA THEN

  18706 26 002465   200006 235100                    LDA     TO_TYPE,,AUTO
        26 002466   000010 115007                    CMPA    8,DL
        26 002467   002541 601000 26                 TNZ     s:18735

     1148    18707    3          IF LOW_VALUE_ST$ = ADDR(NIL) THEN
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:199  

  18707 26 002470   000000 236000 21                 LDQ     LOW_VALUE_ST$
        26 002471   000001 116000 27                 CMPQ    1
        26 002472   002541 601000 26                 TNZ     s:18735

     1149    18708    3            LOW_VALUE_ST$  = SYM$;

  18708 26 002473   200012 236100                    LDQ     SYM$,,AUTO
        26 002474   000000 756000 21                 STQ     LOW_VALUE_ST$
        26 002475   002541 710000 26                 TRA     s:18735

     1150    18709
     1151    18710    3      SELECT (%RSV_WRD_QUOTES);

     1152    18711    3        IF TO_TYPE = %TYA THEN

  18711 26 002476   200006 235100                    LDA     TO_TYPE,,AUTO
        26 002477   000010 115007                    CMPA    8,DL
        26 002500   002541 601000 26                 TNZ     s:18735

     1153    18712    3          IF QUOTE_ST$ = ADDR(NIL) THEN

  18712 26 002501   000000 236000 22                 LDQ     QUOTE_ST$
        26 002502   000001 116000 27                 CMPQ    1
        26 002503   002541 601000 26                 TNZ     s:18735

     1154    18713    3            QUOTE_ST$ = SYM$;

  18713 26 002504   200012 236100                    LDQ     SYM$,,AUTO
        26 002505   000000 756000 22                 STQ     QUOTE_ST$
        26 002506   002541 710000 26                 TRA     s:18735

     1155    18714
     1156    18715    3      SELECT (%RSV_WRD_SPACES);

     1157    18716    4        IF TO_TYPE = %TYA THEN DO ;

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:200  
  18716 26 002507   200006 235100                    LDA     TO_TYPE,,AUTO
        26 002510   000010 115007                    CMPA    8,DL
        26 002511   002520 601000 26                 TNZ     s:18721

     1158    18717    4          IF SPACE_ST$ = ADDR(NIL) THEN

  18717 26 002512   000000 236000 23                 LDQ     SPACE_ST$
        26 002513   000001 116000 27                 CMPQ    1
        26 002514   002541 601000 26                 TNZ     s:18735

     1159    18718    4            SPACE_ST$ = SYM$;

  18718 26 002515   200012 236100                    LDQ     SYM$,,AUTO
        26 002516   000000 756000 23                 STQ     SPACE_ST$

     1160    18719    4        END ;

  18719 26 002517   002541 710000 26                 TRA     s:18735

     1161    18720    3        ELSE
     1162    18721    4        IF TO_TYPE = %TYN THEN DO ;

  18721 26 002520   000016 115007                    CMPA    14,DL
        26 002521   002541 601000 26                 TNZ     s:18735

     1163    18722    4          IF KANJI_SPACE_ST$ = ADDR(NIL) THEN

  18722 26 002522   000000 236000 24                 LDQ     KANJI_SPACE_ST$
        26 002523   000001 116000 27                 CMPQ    1
        26 002524   002541 601000 26                 TNZ     s:18735

     1164    18723    4            KANJI_SPACE_ST$ = SYM$ ;

  18723 26 002525   200012 236100                    LDQ     SYM$,,AUTO
        26 002526   000000 756000 24                 STQ     KANJI_SPACE_ST$

     1165    18724    4        END ;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:201  

  18724 26 002527   002541 710000 26                 TRA     s:18735

     1166    18725
     1167    18726    3      SELECT (%RSV_WRD_ZEROES);

     1168    18727    3        IF TO_TYPE = %TYA THEN

  18727 26 002530   200006 235100                    LDA     TO_TYPE,,AUTO
        26 002531   000010 115007                    CMPA    8,DL
        26 002532   002541 601000 26                 TNZ     s:18735

     1169    18728    3          IF ZERO_ST$ = ADDR(NIL) THEN

  18728 26 002533   000000 236000 25                 LDQ     ZERO_ST$
        26 002534   000001 116000 27                 CMPQ    1
        26 002535   002541 601000 26                 TNZ     s:18735

     1170    18729    3            ZERO_ST$ = SYM$;

  18729 26 002536   200012 236100                    LDQ     SYM$,,AUTO
        26 002537   000000 756000 25                 STQ     ZERO_ST$
        26 002540   002541 710000 26                 TRA     s:18735

     1171    18730
     1172    18731    3      SELECT (ELSE);

     1173    18732
     1174    18733    3    END; /* Select -- const$-> literal.symbol */

     1175    18734
     1176    18735    2    CALL Z8AF$FORME (%TRIAD, SYM$, ADDR(NIL), SYM$);

  18735 26 002541   000001 236000 27                 LDQ     1
        26 002542   200152 756100                    STQ     I+1,,AUTO
        26 002543   200012 631500                    EPPR1   SYM$,,AUTO
        26 002544   200157 451500                    STP1    I+6,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:202  
        26 002545   200152 633500                    EPPR3   I+1,,AUTO
        26 002546   200156 453500                    STP3    I+5,,AUTO
        26 002547   200012 634500                    EPPR4   SYM$,,AUTO
        26 002550   200155 454500                    STP4    I+4,,AUTO
        26 002551   000032 236000 27                 LDQ     26
        26 002552   200154 756100                    STQ     I+3,,AUTO
        26 002553   200154 630500                    EPPR0   I+3,,AUTO
        26 002554   000026 631400 27                 EPPR1   22
        26 002555   000000 701000 xent               TSX1    Z8AF$FORME
        26 002556   000000 011000                    NOP     0

     1177    18736
     1178    18737
     1179    18738    2    RTN$ = SYM$;

  18738 26 002557   200012 236100                    LDQ     SYM$,,AUTO
        26 002560   200005 470500                    LDP0    @RTN$,,AUTO
        26 002561   000000 756100                    STQ     0,,PR0

     1180    18739
     1181    18740    2   END WRAP_UP;

  18740 26 002562   200106 221300                    LDX1  ! NUM_DESC+6,,AUTO
        26 002563   000001 702211                    TSX2  ! 1,X1

     1182    18741        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:203  
     1183    18742    1   CREATE_TYD_CONSTANT: PROC ;

  18742 26 002564   200110 741300       CREATE_TYD_* STX1  ! @TO_TYPE+1,,AUTO

     1184    18743
     1185    18744    2   DCL  CONSTANT_S  BIT (2) ALIGNED ;
     1186    18745
     1187    18746    2      CALL GET_NUMERIC_CONSTANT;

  18746 26 002565   000003 701000 26                 TSX1    GET_NUMERIC_CONSTANT
        26 002566   000000 011000                    NOP     0

     1188    18747
     1189    18748    2      IF CONSTANT_SIGNED

  18748 26 002567   200011 234100                    SZN     CONSTANT_SIGNED,,AUTO
        26 002570   002574 605000 26                 TPL     s:18750

     1190    18749    2      THEN CONSTANT_S = %LEADING_SIGN ;

  18749 26 002571   200000 236003                    LDQ     65536,DU
        26 002572   200111 756100                    STQ     CONSTANT_S,,AUTO
        26 002573   002576 710000 26                 TRA     s:18752

     1191    18750    2      ELSE CONSTANT_S = %NO_SIGN ;

  18750 26 002574   600000 236003                    LDQ     -65536,DU
        26 002575   200111 756100                    STQ     CONSTANT_S,,AUTO

     1192    18751
     1193    18752    2      CALL CREATE_4BIT_DECIMAL (CONSTANT_LENGTH, %NDSC4, CONSTANT_SF, CONSTANT_S) ;

  18752 26 002576   200111 630500                    EPPR0   CONSTANT_S,,AUTO
        26 002577   200120 450500                    STP0    I,,AUTO
        26 002600   200010 631500                    EPPR1   CONSTANT_SF,,AUTO
        26 002601   200117 451500                    STP1    SCALE,,AUTO
        26 002602   000034 236000 27                 LDQ     28
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:204  
        26 002603   200116 756100                    STQ     LENGTH,,AUTO
        26 002604   200007 633500                    EPPR3   CONSTANT_LENGTH,,AUTO
        26 002605   200115 453500                    STP3    S,,AUTO
        26 002606   002612 701000 26                 TSX1    CREATE_4BIT_DECIMAL
        26 002607   000000 011000                    NOP     0

     1194    18753
     1195    18754    2   END CREATE_TYD_CONSTANT;

  18754 26 002610   200110 221300                    LDX1  ! @TO_TYPE+1,,AUTO
        26 002611   000001 702211                    TSX2  ! 1,X1

     1196    18755        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:205  
     1197    18756    1   CREATE_4BIT_DECIMAL: PROC (N, TN, SF, S) ;

  18756 26 002612   200114 741300       CREATE_4BIT* STX1  ! OVERPUNCH_SIGN,,AUTO

     1198    18757
     1199    18758    2   DCL N                  SBIN WORD ; /* Result Length            */
     1200    18759    2   DCL TN                 BIT (1) ALIGNED ; /* Result character type */
     1201    18760    2   DCL SF                 SBIN WORD ; /* Result Scale Factor      */
     1202    18761    2   DCL S                  BIT (2) ALIGNED ; /* Result Sign Type   */
     1203    18762    2   DCL LENGTH             SBIN WORD;
     1204    18763
     1205    18764
     1206    18765         %ASSIGN_SYM$_THE_DNT_ST$;

  18767 26 002613   200016 236100                    LDQ     DNT$$,,AUTO
        26 002614   000001 116000 27                 CMPQ    1
        26 002615   002621 601000 26                 TNZ     s:18770

  18768 26 002616   000001 236000 27                 LDQ     1
        26 002617   200012 756100                    STQ     SYM$,,AUTO
        26 002620   002624 710000 26                 TRA     s:18774

  18770 26 002621   200016 470500                    LDP0    DNT$$,,AUTO
        26 002622   000001 236100                    LDQ     1,,PR0
        26 002623   200012 756100                    STQ     SYM$,,AUTO

     1207    18773
     1208    18774    3    DO WHILE (SYM$ ~= ADDR(NIL));

  18774 26 002624   002664 710000 26                 TRA     s:18787

     1209    18775    3      IF SYM$ -> CONST.TYPE = %TYD THEN

  18775 26 002625   200012 470500                    LDP0    SYM$,,AUTO
        26 002626   000002 220100                    LDX0    2,,PR0
        26 002627   002662 601000 26                 TNZ     s:18786

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:206  
     1210    18776    3        IF SYM$ -> CONST.NDSC.N = N

  18776 26 002630   200115 471500                    LDP1    @N,,AUTO
        26 002631   000001 236100                    LDQ     1,,PR0
        26 002632   000077 376007                    ANQ     63,DL
        26 002633   100000 116100                    CMPQ    0,,PR1
        26 002634   002662 601000 26                 TNZ     s:18786
        26 002635   200116 473500                    LDP3    @TN,,AUTO
        26 002636   000100 066500                    CMPB    filb='0'B
        26 002637   000001 430001                    BDSC    1,,PR0                   by=2,bit=3,n=1
        26 002640   300000 000001                    BDSC    0,,PR3                   by=0,bit=0,n=1
        26 002641   002662 601000 26                 TNZ     s:18786
        26 002642   200117 474500                    LDP4    @SF,,AUTO
        26 002643   000001 236100                    LDQ     1,,PR0
        26 002644   000030 736000                    QLS     24
        26 002645   000036 732000                    QRS     30
        26 002646   400000 116100                    CMPQ    0,,PR4
        26 002647   002662 601000 26                 TNZ     s:18786
        26 002650   200120 475500                    LDP5    @S,,AUTO
        26 002651   000100 066500                    CMPB    filb='0'B
        26 002652   000001 440002                    BDSC    1,,PR0                   by=2,bit=4,n=2
        26 002653   500000 000002                    BDSC    0,,PR5                   by=0,bit=0,n=2
        26 002654   002662 601000 26                 TNZ     s:18786
        26 002655   200003 476500                    LDP6    @TYPE_DESC,,AUTO
        26 002656   000100 066500                    CMPB    filb='0'B
        26 002657   000003 240001                    BDSC    3,,PR0                   by=1,bit=4,n=1
        26 002660   600001 000001                    BDSC    1,,PR6                   by=0,bit=0,n=1
        26 002661   002666 600000 26                 TZE     s:18789

     1211    18777    3        AND SYM$ -> CONST.NDSC.TN = TN
     1212    18778    3        AND SYM$ -> CONST.NDSC.SF = SF
     1213    18779    3        AND SYM$ -> CONST.NDSC.S  = S
     1214    18780    3        AND SYM$ -> CONST.B.P = TYPE_DESC.DESC.P THEN
     1215    18781               %IF_SEGMENT_COUNT_VALID_THEN;
     1216    18784    3          EXIT;
     1217    18785
     1218    18786    3      SYM$ = SYM$ -> CONST.NEXT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:207  

  18786 26 002662   000004 236100                    LDQ     4,,PR0
        26 002663   200012 756100                    STQ     SYM$,,AUTO

     1219    18787    3    END; /* While sym$ ~= addr(nil) */

  18787 26 002664   000001 116000 27                 CMPQ    1
        26 002665   002625 601000 26                 TNZ     s:18775

     1220    18788
     1221    18789    2    IF SYM$ = ADDR(NIL) THEN

  18789 26 002666   200012 236100                    LDQ     SYM$,,AUTO
        26 002667   000001 116000 27                 CMPQ    1
        26 002670   003315 601000 26                 TNZ     s:19098

     1222    18790    3      DO;

     1223    18791             /* No other items exactly the same already exist */
     1224    18792    3        CALL RESERVE_CONST_ITEM (%TYD, CONST$ -> LX_TERMINAL.DNT$);

  18792 26 002671   200004 470500                    LDP0    @CONST$,,AUTO
        26 002672   000000 471500                    LDP1    0,,PR0
        26 002673   100002 633500                    EPPR3   2,,PR1
        26 002674   200124 453500                    STP3    @DNT$$,,AUTO
        26 002675   000036 236000 27                 LDQ     30
        26 002676   200123 756100                    STQ     @NUM_DESC,,AUTO
        26 002677   001256 701000 26                 TSX1    RESERVE_CONST_ITEM
        26 002700   000000 011000                    NOP     0

     1225    18793
     1226    18794    3        SYM$ -> CONST.B.P = TYPE_DESC.DESC.P;

  18794 26 002701   200012 470500                    LDP0    SYM$,,AUTO
        26 002702   200003 471500                    LDP1    @TYPE_DESC,,AUTO
        26 002703   100001 236100                    LDQ     1,,PR1
        26 002704   000015 772000                    QRL     13
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:208  
        26 002705   000003 676100                    ERQ     3,,PR0
        26 002706   000020 376003                    ANQ     16,DU
        26 002707   000003 656100                    ERSQ    3,,PR0

     1227    18795    3        LENGTH = CONSTANT_LENGTH;

  18795 26 002710   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 002711   200121 755100                    STA     LENGTH,,AUTO

     1228    18796
     1229    18797    3        IF CONSTANT_SIGNED THEN

  18797 26 002712   200011 234100                    SZN     CONSTANT_SIGNED,,AUTO
        26 002713   002737 605000 26                 TPL     s:18807

     1230    18798    4          DO;

     1231    18799    4            CONSTANT_LENGTH = CONSTANT_LENGTH + 1;

  18799 26 002714   200007 054100                    AOS     CONSTANT_LENGTH,,AUTO

     1232    18800    4            CONST_TEMP = CONST_SYMBOL;

  18800 26 002715   200014 470500                    LDP0    CONSTANT_SYM$,,AUTO
        26 002716   200007 720100                    LXL0    CONSTANT_LENGTH,,AUTO
        26 002717   040100 100540                    MLR     fill='040'O
        26 002720   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
        26 002721   200060 000077                    ADSC9   CONST_TEMP,,AUTO         cn=0,n=63

     1233    18801    4            SUBSTR (CONST_SYMBOL, 1, CONSTANT_LENGTH - 1) =

  18801 26 002722   777777 621010                    EAX1    -1,X0
        26 002723   040140 100540                    MLR     fill='040'O
        26 002724   200060 000011                    ADSC9   CONST_TEMP,,AUTO         cn=0,n=*X1
        26 002725   000000 200011                    ADSC9   0,,PR0                   cn=1,n=*X1

     1234    18802    4            SUBSTR (CONST_TEMP,   0, CONSTANT_LENGTH - 1);
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:209  
     1235    18803    4            SUBSTR(CONST_SYMBOL,0,1) = %MINUS_SIGN_;

  18803 26 002726   040100 100400                    MLR     fill='040'O
        26 002727   000037 000001 27                 ADSC9   31                       cn=0,n=1
        26 002730   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1236    18804    4            SYM$ -> CONST.NDSC.S = %LEADING_SIGN;

  18804 26 002731   200012 473500                    LDP3    SYM$,,AUTO
        26 002732   300001 236100                    LDQ     1,,PR3
        26 002733   000040 376000 27                 ANQ     32
        26 002734   010000 276007                    ORQ     4096,DL
        26 002735   300001 756100                    STQ     1,,PR3

     1237    18805    4          END;

  18805 26 002736   002742 710000 26                 TRA     s:18818

     1238    18806    3        ELSE
     1239    18807    3            SYM$ -> CONST.NDSC.S = %NO_SIGN;

  18807 26 002737   200012 470500                    LDP0    SYM$,,AUTO
        26 002740   030000 236007                    LDQ     12288,DL
        26 002741   000001 256100                    ORSQ    1,,PR0

     1240    18808
     1241    18809             %PACK_NDSC (@DESC   = CONST_DESC,
     1242    18810                         @LENGTH = LENGTH,
     1243    18811                         @SIGN   = SYM$ -> CONST.NDSC.S,
     1244    18812                         @TN     = %NDSC9,
     1245    18813                         @SCALE  = CONSTANT_SF);

  18818 26 002742   000000 220003                    LDX0    0,DU
        26 002743   200056 740100                    STX0    CONST_DESC_WORD,,AUTO

  18819 26 002744   000024 236000 27                 LDQ     20
        26 002745   200056 356100                    ANSQ    CONST_DESC_WORD,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:210  

  18820 26 002746   000025 236000 27                 LDQ     21
        26 002747   200056 356100                    ANSQ    CONST_DESC_WORD,,AUTO

  18821 26 002750   200012 470500                    LDP0    SYM$,,AUTO
        26 002751   000001 236100                    LDQ     1,,PR0
        26 002752   200056 676100                    ERQ     CONST_DESC_WORD,,AUTO
        26 002753   030000 376007                    ANQ     12288,DL
        26 002754   200056 656100                    ERSQ    CONST_DESC_WORD,,AUTO

  18822 26 002755   200010 236100                    LDQ     CONSTANT_SF,,AUTO
        26 002756   000006 736000                    QLS     6
        26 002757   200056 752102                    STCQ    CONST_DESC_WORD,'02'O,AUTO

  18823 26 002760   000001 236100                    LDQ     1,,PR0
        26 002761   000014 772000                    QRL     12
        26 002762   000003 376007                    ANQ     3,DL
        26 002763   000004 116007                    CMPQ    4,DL
        26 002764   002766 602006 26                 TNC     s:18823+6,QL
        26 002765   003004 710000 26                 TRA     s:18863
        26 002766   003001 710000 26                 TRA     s:18854
        26 002767   002775 710000 26                 TRA     s:18830
        26 002770   002775 710000 26                 TRA     s:18830
        26 002771   002772 710000 26                 TRA     s:18825

  18825 26 002772   200121 236100                    LDQ     LENGTH,,AUTO
        26 002773   200056 752101                    STCQ    CONST_DESC_WORD,'01'O,AUTO
        26 002774   003004 710000 26                 TRA     s:18863

  18830 26 002775   200121 236100                    LDQ     LENGTH,,AUTO
        26 002776   000001 036007                    ADLQ    1,DL
        26 002777   200056 752101                    STCQ    CONST_DESC_WORD,'01'O,AUTO
        26 003000   003004 710000 26                 TRA     s:18863

  18854 26 003001   200121 236100                    LDQ     LENGTH,,AUTO
        26 003002   000002 036007                    ADLQ    2,DL
        26 003003   200056 752101                    STCQ    CONST_DESC_WORD,'01'O,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:211  

     1246    18862
     1247    18863    3        CONST_TEMP        = SUBSTR (LITERAL_SYMBOL, 0, CONSTANT_LENGTH);

  18863 26 003004   200007 721100                    LXL1    CONSTANT_LENGTH,,AUTO
        26 003005   040100 100540                    MLR     fill='040'O
        26 003006   200017 000011                    ADSC9   LITERAL_SYMBOL,,AUTO     cn=0,n=*X1
        26 003007   200060 000077                    ADSC9   CONST_TEMP,,AUTO         cn=0,n=63

     1248    18864    3        TEMP_DESC_WORD    = 0 ;

  18864 26 003010   200057 450100                    STZ     TEMP_DESC_WORD,,AUTO

     1249    18865    3        TEMP_DESC.NDSC.N  = N ;

  18865 26 003011   200115 473500                    LDP3    @N,,AUTO
        26 003012   300000 236100                    LDQ     0,,PR3
        26 003013   200057 752101                    STCQ    TEMP_DESC_WORD,'01'O,AUTO

     1250    18866    3        TEMP_DESC.NDSC.SF = SF ;

  18866 26 003014   200117 474500                    LDP4    @SF,,AUTO
        26 003015   400000 236100                    LDQ     0,,PR4
        26 003016   000006 736000                    QLS     6
        26 003017   200057 752102                    STCQ    TEMP_DESC_WORD,'02'O,AUTO

     1251    18867    3        TEMP_DESC.NDSC.S  = S;

  18867 26 003020   200120 475500                    LDP5    @S,,AUTO
        26 003021   500000 236100                    LDQ     0,,PR5
        26 003022   000026 772000                    QRL     22
        26 003023   200057 676100                    ERQ     TEMP_DESC_WORD,,AUTO
        26 003024   030000 376007                    ANQ     12288,DL
        26 003025   200057 656100                    ERSQ    TEMP_DESC_WORD,,AUTO

     1252    18868    3        TEMP_DESC.NDSC.CN = 0;

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:212  
  18868 26 003026   000024 236000 27                 LDQ     20
        26 003027   200057 356100                    ANSQ    TEMP_DESC_WORD,,AUTO

     1253    18869    3        TEMP_DESC.NDSC.TN = TN ;

  18869 26 003030   200116 476500                    LDP6    @TN,,AUTO
        26 003031   600000 236100                    LDQ     0,,PR6
        26 003032   000025 772000                    QRL     21
        26 003033   200057 676100                    ERQ     TEMP_DESC_WORD,,AUTO
        26 003034   040000 376007                    ANQ     16384,DL
        26 003035   200057 656100                    ERSQ    TEMP_DESC_WORD,,AUTO

     1254    18870    3        REAL_SYMBOL = '0'B ; /* To safeguard against a garbage 4-bit character

  18870 26 003036   000100 100400                    MLR     fill='000'O
        26 003037   000035 000001 27                 ADSC9   29                       cn=0,n=1
        26 003040   200017 000077                    ADSC9   LITERAL_SYMBOL,,AUTO     cn=0,n=63

     1255    18871                                     after the significant part of the literal */
     1256    18872
     1257    18873    3        IF TYPE_DESC.DESC.P THEN /* COMP-4, COMP-5, COMP-8 */

  18873 26 003041   100001 234100                    SZN     1,,PR1
        26 003042   003070 605000 26                 TPL     s:18879

     1258    18874    3          CALL Z9AU$MOVE_C3_NUMERIC (CONST_DESC.DESCL,

  18874 26 003043   200060 637500                    EPPR7   CONST_TEMP,,AUTO
        26 003044   200152 457500                    STP7    I+1,,AUTO
        26 003045   200017 630500                    EPPR0   LITERAL_SYMBOL,,AUTO
        26 003046   200153 450500                    STP0    I+2,,AUTO
        26 003047   200153 630500                    EPPR0   I+2,,AUTO
        26 003050   200157 450500                    STP0    I+6,,AUTO
        26 003051   200152 630500                    EPPR0   I+1,,AUTO
        26 003052   200156 450500                    STP0    I+5,,AUTO
        26 003053   200160 452500                    STP2    I+7,,AUTO
        26 003054   200160 236100                    LDQ     I+7,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:213  
        26 003055   000027 036000 27                 ADLQ    23
        26 003056   200155 756100                    STQ     I+4,,AUTO
        26 003057   200161 452500                    STP2    I+8,,AUTO
        26 003060   200161 236100                    LDQ     I+8,,AUTO
        26 003061   000030 036000 27                 ADLQ    24
        26 003062   200154 756100                    STQ     I+3,,AUTO
        26 003063   200154 630500                    EPPR0   I+3,,AUTO
        26 003064   000026 631400 27                 EPPR1   22
        26 003065   000000 701000 xent               TSX1    Z9AU$MOVE_C3_NUMERIC
        26 003066   000000 011000                    NOP     0
        26 003067   003114 710000 26                 TRA     s:18884

     1259    18875    3                                     TEMP_DESC.DESCL,
     1260    18876    3                                     ADDR(CONST_TEMP),
     1261    18877    3                                     ADDR(LITERAL_SYMBOL));
     1262    18878    3        ELSE /* COMP-3 */
     1263    18879    3          CALL Z9AU$MOVE_NUMERIC (CONST_DESC.DESCL,

  18879 26 003070   200060 637500                    EPPR7   CONST_TEMP,,AUTO
        26 003071   200152 457500                    STP7    I+1,,AUTO
        26 003072   200017 630500                    EPPR0   LITERAL_SYMBOL,,AUTO
        26 003073   200153 450500                    STP0    I+2,,AUTO
        26 003074   200153 630500                    EPPR0   I+2,,AUTO
        26 003075   200157 450500                    STP0    I+6,,AUTO
        26 003076   200152 630500                    EPPR0   I+1,,AUTO
        26 003077   200156 450500                    STP0    I+5,,AUTO
        26 003100   200160 452500                    STP2    I+7,,AUTO
        26 003101   200160 236100                    LDQ     I+7,,AUTO
        26 003102   000027 036000 27                 ADLQ    23
        26 003103   200155 756100                    STQ     I+4,,AUTO
        26 003104   200161 452500                    STP2    I+8,,AUTO
        26 003105   200161 236100                    LDQ     I+8,,AUTO
        26 003106   000030 036000 27                 ADLQ    24
        26 003107   200154 756100                    STQ     I+3,,AUTO
        26 003110   200154 630500                    EPPR0   I+3,,AUTO
        26 003111   000026 631400 27                 EPPR1   22
        26 003112   000000 701000 xent               TSX1    Z9AU$MOVE_NUMERIC
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:214  
        26 003113   000000 011000                    NOP     0

     1264    18880    3                                  TEMP_DESC.DESCL,
     1265    18881    3                                  ADDR(CONST_TEMP),
     1266    18882    3                                  ADDR(LITERAL_SYMBOL));
     1267    18883
     1268    18884    3        CONSTANT_LENGTH = TEMP_DESC.NDSC.N;

  18884 26 003114   200057 236100                    LDQ     TEMP_DESC_WORD,,AUTO
        26 003115   000077 376007                    ANQ     63,DL
        26 003116   200007 756100                    STQ     CONSTANT_LENGTH,,AUTO

     1269    18885    3        SYM$ -> CONST.NDSC = TEMP_DESC.NDSC;

  18885 26 003117   200057 720100                    LXL0    TEMP_DESC_WORD,,AUTO
        26 003120   200012 470500                    LDP0    SYM$,,AUTO
        26 003121   000001 440100                    SXL0    1,,PR0

     1270    18886
     1271    18887    3        IF TN = %NDSC4 THEN

  18887 26 003122   200116 470500                    LDP0    @TN,,AUTO
        26 003123   000000 234100                    SZN     0,,PR0
        26 003124   003225 605000 26                 TPL     s:18994

     1272    18888               %ENTER_4BIT_NUMERIC_CONSTANT;

  18889 26 003125   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 003126   000020 115007                    CMPA    16,DL
        26 003127   003204 604400 26                 TMOZ    s:18986

  18892 26 003130   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 003131   000007 036007                    ADLQ    7,DL
        26 003132   000010 506007                    DIV     8,DL
        26 003133   000001 036007                    ADLQ    1,DL
        26 003134   000000 756000 0                  STQ     ITERATION

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:215  
  18969 26 003135   000002 036000 2                  ADLQ    LTS_+2
        26 003136   000003 116000 2                  CMPQ    LTS_+3
        26 003137   003150 604000 26                 TMI     s:18971

  18970 26 003140   000041 236000 27                 LDQ     33
        26 003141   200152 756100                    STQ     I+1,,AUTO
        26 003142   200152 631500                    EPPR1   I+1,,AUTO
        26 003143   200153 451500                    STP1    I+2,,AUTO
        26 003144   200153 630500                    EPPR0   I+2,,AUTO
        26 003145   000006 631400 27                 EPPR1   6
        26 003146   000000 701000 xent               TSX1    Z8AR$RESERVER
        26 003147   000000 011000                    NOP     0

  18971 26 003150   000002 236000 2                  LDQ     LTS_+2
        26 003151   000022 736000                    QLS     18
        26 003152   000001 036000 2                  ADLQ    LTS_+1
        26 003153   200015 756100                    STQ     LTSS$,,AUTO

  18972 26 003154   000002 236000 2                  LDQ     LTS_+2
        26 003155   000000 036000 0                  ADLQ    ITERATION
        26 003156   000002 756000 2                  STQ     LTS_+2

  18973 26 003157   001106 220003                    LDX0    582,DU
        26 003160   200015 470500                    LDP0    LTSS$,,AUTO
        26 003161   000000 740100                    STX0    0,,PR0

  18975 26 003162   000000 721000 0                  LXL1    ITERATION
        26 003163   000000 441100                    SXL1    0,,PR0

  18979 26 003164   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 003165   000001 036007                    ADLQ    1,DL
        26 003166   000002 506007                    DIV     2,DL
        26 003167   200014 471500                    LDP1    CONSTANT_SYM$,,AUTO
        26 003170   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 003171   000000 623006                    EAX3    0,QL
        26 003172   040140 100540                    MLR     fill='040'O
        26 003173   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:216  
        26 003174   000001 000013                    ADSC9   1,,PR0                   cn=0,n=*X3

  18980 26 003175   200015 236100                    LDQ     LTSS$,,AUTO
        26 003176   200012 473500                    LDP3    SYM$,,AUTO
        26 003177   300010 756100                    STQ     8,,PR3

  18981 26 003200   200012 473500                    LDP3    SYM$,,AUTO
        26 003201   400000 236003                    LDQ     -131072,DU
        26 003202   300003 256100                    ORSQ    3,,PR3

  18982 26 003203   003315 710000 26                 TRA     s:19098

  18986 26 003204   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 003205   000001 036007                    ADLQ    1,DL
        26 003206   000002 506007                    DIV     2,DL
        26 003207   200014 471500                    LDP1    CONSTANT_SYM$,,AUTO
        26 003210   200007 720100                    LXL0    CONSTANT_LENGTH,,AUTO
        26 003211   200012 473500                    LDP3    SYM$,,AUTO
        26 003212   000000 621006                    EAX1    0,QL
        26 003213   040140 100540                    MLR     fill='040'O
        26 003214   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
        26 003215   300010 000011                    ADSC9   8,,PR3                   cn=0,n=*X1

  18988 26 003216   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 003217   000010 115007                    CMPA    8,DL
        26 003220   003315 604400 26                 TMOZ    s:19098

  18989 26 003221   200012 473500                    LDP3    SYM$,,AUTO
        26 003222   200000 236003                    LDQ     65536,DU
        26 003223   300003 256100                    ORSQ    3,,PR3

  18990 26 003224   003315 710000 26                 TRA     s:19098

     1273    18992    3        ELSE
     1274    18993               %ENTER_9BIT_NUMERIC_CONSTANT;

  18994 26 003225   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:217  
        26 003226   000010 115007                    CMPA    8,DL
        26 003227   003300 604400 26                 TMOZ    s:19091

  18997 26 003230   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 003231   000003 036007                    ADLQ    3,DL
        26 003232   000004 506007                    DIV     4,DL
        26 003233   000001 036007                    ADLQ    1,DL
        26 003234   000000 756000 0                  STQ     ITERATION

  19074 26 003235   000002 036000 2                  ADLQ    LTS_+2
        26 003236   000003 116000 2                  CMPQ    LTS_+3
        26 003237   003250 604000 26                 TMI     s:19076

  19075 26 003240   000041 236000 27                 LDQ     33
        26 003241   200152 756100                    STQ     I+1,,AUTO
        26 003242   200152 631500                    EPPR1   I+1,,AUTO
        26 003243   200153 451500                    STP1    I+2,,AUTO
        26 003244   200153 630500                    EPPR0   I+2,,AUTO
        26 003245   000006 631400 27                 EPPR1   6
        26 003246   000000 701000 xent               TSX1    Z8AR$RESERVER
        26 003247   000000 011000                    NOP     0

  19076 26 003250   000002 236000 2                  LDQ     LTS_+2
        26 003251   000022 736000                    QLS     18
        26 003252   000001 036000 2                  ADLQ    LTS_+1
        26 003253   200015 756100                    STQ     LTSS$,,AUTO

  19077 26 003254   000002 236000 2                  LDQ     LTS_+2
        26 003255   000000 036000 0                  ADLQ    ITERATION
        26 003256   000002 756000 2                  STQ     LTS_+2

  19078 26 003257   001106 220003                    LDX0    582,DU
        26 003260   200015 470500                    LDP0    LTSS$,,AUTO
        26 003261   000000 740100                    STX0    0,,PR0

  19080 26 003262   000000 721000 0                  LXL1    ITERATION
        26 003263   000000 441100                    SXL1    0,,PR0
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:218  

  19084 26 003264   200014 471500                    LDP1    CONSTANT_SYM$,,AUTO
        26 003265   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 003266   040140 100540                    MLR     fill='040'O
        26 003267   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
        26 003270   000001 000012                    ADSC9   1,,PR0                   cn=0,n=*X2

  19085 26 003271   200015 236100                    LDQ     LTSS$,,AUTO
        26 003272   200012 473500                    LDP3    SYM$,,AUTO
        26 003273   300010 756100                    STQ     8,,PR3

  19086 26 003274   200012 473500                    LDP3    SYM$,,AUTO
        26 003275   400000 236003                    LDQ     -131072,DU
        26 003276   300003 256100                    ORSQ    3,,PR3

  19087 26 003277   003315 710000 26                 TRA     s:19098

  19091 26 003300   200014 471500                    LDP1    CONSTANT_SYM$,,AUTO
        26 003301   000000 620005                    EAX0    0,AL
        26 003302   200012 473500                    LDP3    SYM$,,AUTO
        26 003303   200007 721100                    LXL1    CONSTANT_LENGTH,,AUTO
        26 003304   040140 100540                    MLR     fill='040'O
        26 003305   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
        26 003306   300010 000011                    ADSC9   8,,PR3                   cn=0,n=*X1

  19092 26 003307   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 003310   000004 115007                    CMPA    4,DL
        26 003311   003315 604400 26                 TMOZ    s:19098

  19093 26 003312   200012 473500                    LDP3    SYM$,,AUTO
        26 003313   200000 236003                    LDQ     65536,DU
        26 003314   300003 256100                    ORSQ    3,,PR3

     1275    19096    3      END; /* If -- sym$ ~= addr(nil) */

     1276    19097
     1277    19098    2   END CREATE_4BIT_DECIMAL;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:219  

  19098 26 003315   200114 221300                    LDX1  ! OVERPUNCH_SIGN,,AUTO
        26 003316   000001 702211                    TSX2  ! 1,X1

     1278    19099
     1279    19100        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:220  
     1280    19101    1   CREATE_TYD_WITH_TYPE_DESC: PROC (TYPE_DESC) ;

  19101 26 003317   200106 741300       CREATE_TYD_* STX1  ! NUM_DESC+6,,AUTO

     1281    19102
     1282    19103    2   DCL 1 TYPE_DESC        ALIGNED,
     1283    19104             %TYPE_DESC;
     1284    19138    2   DCL   N                SBIN WORD ; /* Result Length            */
     1285    19139    2   DCL   S                BIT (2) ALIGNED ; /* Result Sign Type   */
     1286    19140    2   DCL   SF               SBIN WORD ; /* Result Scale Factor      */
     1287    19141    2   DCL   TN               BIT (1) ALIGNED ; /* Result Character Type */
     1288    19142
     1289    19143
     1290    19144    2      CALL GET_NUMERIC_CONSTANT;

  19144 26 003320   000003 701000 26                 TSX1    GET_NUMERIC_CONSTANT
        26 003321   000000 011000                    NOP     0

     1291    19145    2      CALL NDSC9_OVERFLOW (TYPE_DESC);

  19145 26 003322   200107 236100                    LDQ     @TYPE_DESC,,AUTO
        26 003323   200115 756100                    STQ     @N,,AUTO
        26 003324   000757 701000 26                 TSX1    NDSC9_OVERFLOW
        26 003325   000000 011000                    NOP     0

     1292    19146
     1293    19147    2      N  = TYPE_DESC.DESC.NDSC.N ;

  19147 26 003326   200107 470500                    LDP0    @TYPE_DESC,,AUTO
        26 003327   000001 236100                    LDQ     1,,PR0
        26 003330   000077 376007                    ANQ     63,DL
        26 003331   200110 756100                    STQ     N,,AUTO

     1294    19148    2      TN = TYPE_DESC.DESC.NDSC.TN ;

  19148 26 003332   000001 236100                    LDQ     1,,PR0
        26 003333   000025 736000                    QLS     21
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:221  
        26 003334   400000 376003                    ANQ     -131072,DU
        26 003335   200113 756100                    STQ     TN,,AUTO

     1295    19149    2      SF = TYPE_DESC.DESC.NDSC.SF ;

  19149 26 003336   000001 236100                    LDQ     1,,PR0
        26 003337   000030 736000                    QLS     24
        26 003340   000036 732000                    QRS     30
        26 003341   200112 756100                    STQ     SF,,AUTO

     1296    19150    2      S  = TYPE_DESC.DESC.NDSC.S ;

  19150 26 003342   000001 236100                    LDQ     1,,PR0
        26 003343   000026 736000                    QLS     22
        26 003344   600000 376003                    ANQ     -65536,DU
        26 003345   200111 756100                    STQ     S,,AUTO

     1297    19151    2      CALL CREATE_4BIT_DECIMAL (N, TN, SF, S) ;

  19151 26 003346   200111 631500                    EPPR1   S,,AUTO
        26 003347   200120 451500                    STP1    @S,,AUTO
        26 003350   200112 633500                    EPPR3   SF,,AUTO
        26 003351   200117 453500                    STP3    @SF,,AUTO
        26 003352   200113 634500                    EPPR4   TN,,AUTO
        26 003353   200116 454500                    STP4    @TN,,AUTO
        26 003354   200110 635500                    EPPR5   N,,AUTO
        26 003355   200115 455500                    STP5    @N,,AUTO
        26 003356   002612 701000 26                 TSX1    CREATE_4BIT_DECIMAL
        26 003357   000000 011000                    NOP     0

     1298    19152
     1299    19153
     1300    19154    2   END CREATE_TYD_WITH_TYPE_DESC;

  19154 26 003360   200106 221300                    LDX1  ! NUM_DESC+6,,AUTO
        26 003361   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:222  
     1301    19155
     1302    19156        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:223  
     1303    19157    1   CREATE_TYI_CONSTANT: PROC;

  19157 26 003362   200110 741300       CREATE_TYI_* STX1  ! N,,AUTO

     1304    19158
     1305    19159    2    CALL GET_NUMERIC_CONSTANT;

  19159 26 003363   000003 701000 26                 TSX1    GET_NUMERIC_CONSTANT
        26 003364   000000 011000                    NOP     0

     1306    19160
     1307    19161    2    CALL OVERFLOW (%TYI_SIGNIFICANCE, 0)

  19161 26 003365   000036 236000 27                 LDQ     30
        26 003366   200124 756100                    STQ     @DNT$$,,AUTO
        26 003367   000043 236000 27                 LDQ     35
        26 003370   200123 756100                    STQ     @NUM_DESC,,AUTO
        26 003371   000703 701000 26                 TSX1    OVERFLOW
        26 003372   003374 702000 26                 TSX2    s:19164
        26 003373   003417 710000 26                 TRA     s:19174

     1308    19162    2      WHENALTRETURN
     1309    19163    3        DO;

     1310    19164    3          IF NOT CONSTANT_SIGNED THEN

  19164 26 003374   200011 234100                    SZN     CONSTANT_SIGNED,,AUTO
        26 003375   003407 604000 26                 TMI     s:19170

     1311    19165    4            DO;

     1312    19166    4              IF CONST_SYMBOL > %TYI_CHAR_MAX_VALUE THEN

  19166 26 003376   200014 470500                    LDP0    CONSTANT_SYM$,,AUTO
        26 003377   200007 720100                    LXL0    CONSTANT_LENGTH,,AUTO
        26 003400   040140 106400                    CMPC    fill='040'O
        26 003401   000235 000013 19                 ADSC9   CONSTANT_ZERO+22         cn=0,n=11
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:224  
        26 003402   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
        26 003403   003417 603000 26                 TRC     s:19174

     1313    19167    4                VALUE_OVERFLOW = TRUE;

  19167 26 003404   400000 236003                    LDQ     -131072,DU
        26 003405   200041 756100                    STQ     VALUE_OVERFLOW,,AUTO

     1314    19168    4            END;

  19168 26 003406   003417 710000 26                 TRA     s:19174

     1315    19169    3          ELSE
     1316    19170    3            IF CONST_SYMBOL > %TYI_CHAR_MIN_VALUE THEN

  19170 26 003407   200014 470500                    LDP0    CONSTANT_SYM$,,AUTO
        26 003410   200007 720100                    LXL0    CONSTANT_LENGTH,,AUTO
        26 003411   040140 106400                    CMPC    fill='040'O
        26 003412   000232 000013 19                 ADSC9   CONSTANT_ZERO+19         cn=0,n=11
        26 003413   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
        26 003414   003417 603000 26                 TRC     s:19174

     1317    19171    3              VALUE_OVERFLOW = TRUE;

  19171 26 003415   400000 236003                    LDQ     -131072,DU
        26 003416   200041 756100                    STQ     VALUE_OVERFLOW,,AUTO

     1318    19172    3        END;

     1319    19173
     1320    19174    2    CALL CREATE_INTEGER_CONSTANT;

  19174 26 003417   001200 701000 26                 TSX1    CREATE_INTEGER_CONSTANT
        26 003420   000000 011000                    NOP     0

     1321    19175
     1322    19176         %SRCH_FOR_IDENTICAL_CONSTANTS (@TYPE = %TYI);
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:225  

  19180 26 003421   200016 236100                    LDQ     DNT$$,,AUTO
        26 003422   000001 116000 27                 CMPQ    1
        26 003423   003427 601000 26                 TNZ     s:19183

  19181 26 003424   000001 236000 27                 LDQ     1
        26 003425   200012 756100                    STQ     SYM$,,AUTO
        26 003426   003432 710000 26                 TRA     s:19186

  19183 26 003427   200016 470500                    LDP0    DNT$$,,AUTO
        26 003430   000001 236100                    LDQ     1,,PR0
        26 003431   200012 756100                    STQ     SYM$,,AUTO

  19186 26 003432   003444 710000 26                 TRA     s:19199

  19187 26 003433   200012 470500                    LDP0    SYM$,,AUTO
        26 003434   000000 220100                    LDX0    0,,PR0
        26 003435   000767 100003                    CMPX0   503,DU
        26 003436   003442 601000 26                 TNZ     s:19198
        26 003437   000002 221100                    LDX1    2,,PR0
        26 003440   000001 101003                    CMPX1   1,DU
        26 003441   003446 600000 26                 TZE     s:19202

  19198 26 003442   000004 236100                    LDQ     4,,PR0
        26 003443   200012 756100                    STQ     SYM$,,AUTO

  19199 26 003444   000001 116000 27                 CMPQ    1
        26 003445   003433 601000 26                 TNZ     s:19187

     1323    19202    2    IF SYM$ = ADDR(NIL) THEN

  19202 26 003446   200012 236100                    LDQ     SYM$,,AUTO
        26 003447   000001 116000 27                 CMPQ    1
        26 003450   003467 601000 26                 TNZ     s:19210

     1324    19203    3      DO;

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:226  
     1325    19204             /* Identical constant was not found */
     1326    19205    3        CALL RESERVE_CONST_ITEM (%TYI, CONST$ -> LX_TERMINAL.DNT$);

  19205 26 003451   200004 470500                    LDP0    @CONST$,,AUTO
        26 003452   000000 471500                    LDP1    0,,PR0
        26 003453   100002 633500                    EPPR3   2,,PR1
        26 003454   200124 453500                    STP3    @DNT$$,,AUTO
        26 003455   000017 236000 27                 LDQ     15
        26 003456   200123 756100                    STQ     @NUM_DESC,,AUTO
        26 003457   001256 701000 26                 TSX1    RESERVE_CONST_ITEM
        26 003460   000000 011000                    NOP     0

     1327    19206    3        SYM$ -> CONST.CONSTI.WORD1 = CONST_VALUE;

  19206 26 003461   200012 470500                    LDP0    SYM$,,AUTO
        26 003462   200037 235100                    LDA     CONST_VALUE,,AUTO
        26 003463   000010 755100                    STA     8,,PR0

     1328    19207    3        SYM$ -> CONST.NDSC.N = 4;

  19207 26 003464   200012 470500                    LDP0    SYM$,,AUTO
        26 003465   000004 236007                    LDQ     4,DL
        26 003466   000001 752101                    STCQ    1,'01'O,PR0

     1329    19208    3      END;

     1330    19209
     1331    19210    2   END; /* Proc -- create_tyi_constant */

  19210 26 003467   200110 221300                    LDX1  ! N,,AUTO
        26 003470   000001 702211                    TSX2  ! 1,X1

     1332    19211        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:227  
     1333    19212    1   CREATE_TYH_CONSTANT: PROC;

  19212 26 003471   200110 741300       CREATE_TYH_* STX1  ! N,,AUTO

     1334    19213
     1335    19214    2    CALL GET_NUMERIC_CONSTANT;

  19214 26 003472   000003 701000 26                 TSX1    GET_NUMERIC_CONSTANT
        26 003473   000000 011000                    NOP     0

     1336    19215    2    CALL OVERFLOW (%TYH_SIGNIFICANCE, 0);

  19215 26 003474   000036 236000 27                 LDQ     30
        26 003475   200124 756100                    STQ     @DNT$$,,AUTO
        26 003476   000045 236000 27                 LDQ     37
        26 003477   200123 756100                    STQ     @NUM_DESC,,AUTO
        26 003500   000703 701000 26                 TSX1    OVERFLOW
        26 003501   000000 011000                    NOP     0

     1337    19216
     1338    19217    2    CALL CREATE_INTEGER_CONSTANT;

  19217 26 003502   001200 701000 26                 TSX1    CREATE_INTEGER_CONSTANT
        26 003503   000000 011000                    NOP     0

     1339    19218
     1340    19219    2    CALL VALUE_CHECK (%TYH_MAX_VALUE);

  19219 26 003504   000047 236000 27                 LDQ     39
        26 003505   200113 756100                    STQ     TN,,AUTO
        26 003506   000733 701000 26                 TSX1    VALUE_CHECK
        26 003507   000000 011000                    NOP     0

     1341    19220
     1342    19221         %SRCH_FOR_IDENTICAL_CONSTANTS (@TYPE = %TYH);

  19225 26 003510   200016 236100                    LDQ     DNT$$,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:228  
        26 003511   000001 116000 27                 CMPQ    1
        26 003512   003516 601000 26                 TNZ     s:19228

  19226 26 003513   000001 236000 27                 LDQ     1
        26 003514   200012 756100                    STQ     SYM$,,AUTO
        26 003515   003521 710000 26                 TRA     s:19231

  19228 26 003516   200016 470500                    LDP0    DNT$$,,AUTO
        26 003517   000001 236100                    LDQ     1,,PR0
        26 003520   200012 756100                    STQ     SYM$,,AUTO

  19231 26 003521   003530 710000 26                 TRA     s:19244

  19232 26 003522   200012 470500                    LDP0    SYM$,,AUTO
        26 003523   000002 220100                    LDX0    2,,PR0
        26 003524   000007 100003                    CMPX0   7,DU
        26 003525   003532 600000 26                 TZE     s:19247

  19243 26 003526   000004 236100                    LDQ     4,,PR0
        26 003527   200012 756100                    STQ     SYM$,,AUTO

  19244 26 003530   000001 116000 27                 CMPQ    1
        26 003531   003522 601000 26                 TNZ     s:19232

     1343    19247    2    IF SYM$ = ADDR(NIL) THEN

  19247 26 003532   200012 236100                    LDQ     SYM$,,AUTO
        26 003533   000001 116000 27                 CMPQ    1
        26 003534   003553 601000 26                 TNZ     s:19255

     1344    19248    3      DO;

     1345    19249             /* Identical constant was not found */
     1346    19250    3        CALL RESERVE_CONST_ITEM (%TYH, CONST$ -> LX_TERMINAL.DNT$);

  19250 26 003535   200004 470500                    LDP0    @CONST$,,AUTO
        26 003536   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:229  
        26 003537   100002 633500                    EPPR3   2,,PR1
        26 003540   200124 453500                    STP3    @DNT$$,,AUTO
        26 003541   000051 236000 27                 LDQ     41
        26 003542   200123 756100                    STQ     @NUM_DESC,,AUTO
        26 003543   001256 701000 26                 TSX1    RESERVE_CONST_ITEM
        26 003544   000000 011000                    NOP     0

     1347    19251    3        SYM$ -> CONST.CONSTU.UPPER = CONST_VALUE;

  19251 26 003545   200037 720100                    LXL0    CONST_VALUE,,AUTO
        26 003546   200012 470500                    LDP0    SYM$,,AUTO
        26 003547   000010 740100                    STX0    8,,PR0

     1348    19252    3        SYM$ -> CONST.ADSC.N = 2;

  19252 26 003550   200012 470500                    LDP0    SYM$,,AUTO
        26 003551   000002 236007                    LDQ     2,DL
        26 003552   000001 752103                    STCQ    1,'03'O,PR0

     1349    19253    3      END;

     1350    19254
     1351    19255    2   END; /* Proc -- Create_tyh_constant */

  19255 26 003553   200110 221300                    LDX1  ! N,,AUTO
        26 003554   000001 702211                    TSX2  ! 1,X1

     1352    19256        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:230  
     1353    19257    1   CREATE_TYJ_CONSTANT: PROC;

  19257 26 003555   200110 741300       CREATE_TYJ_* STX1  ! N,,AUTO

     1354    19258
     1355    19259    2    CALL GET_NUMERIC_CONSTANT;

  19259 26 003556   000003 701000 26                 TSX1    GET_NUMERIC_CONSTANT
        26 003557   000000 011000                    NOP     0

     1356    19260    2    CALL OVERFLOW (%TYJ_SIGNIFICANCE, 0);

  19260 26 003560   000036 236000 27                 LDQ     30
        26 003561   200124 756100                    STQ     @DNT$$,,AUTO
        26 003562   000053 236000 27                 LDQ     43
        26 003563   200123 756100                    STQ     @NUM_DESC,,AUTO
        26 003564   000703 701000 26                 TSX1    OVERFLOW
        26 003565   000000 011000                    NOP     0

     1357    19261
     1358    19262    2    CALL CREATE_INTEGER_CONSTANT;

  19262 26 003566   001200 701000 26                 TSX1    CREATE_INTEGER_CONSTANT
        26 003567   000000 011000                    NOP     0

     1359    19263
     1360    19264    2    CALL VALUE_CHECK (%TYJ_MAX_VALUE);

  19264 26 003570   000055 236000 27                 LDQ     45
        26 003571   200113 756100                    STQ     TN,,AUTO
        26 003572   000733 701000 26                 TSX1    VALUE_CHECK
        26 003573   000000 011000                    NOP     0

     1361    19265
     1362    19266         %SRCH_FOR_IDENTICAL_CONSTANTS (@TYPE = %TYJ);

  19270 26 003574   200016 236100                    LDQ     DNT$$,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:231  
        26 003575   000001 116000 27                 CMPQ    1
        26 003576   003602 601000 26                 TNZ     s:19273

  19271 26 003577   000001 236000 27                 LDQ     1
        26 003600   200012 756100                    STQ     SYM$,,AUTO
        26 003601   003605 710000 26                 TRA     s:19276

  19273 26 003602   200016 470500                    LDP0    DNT$$,,AUTO
        26 003603   000001 236100                    LDQ     1,,PR0
        26 003604   200012 756100                    STQ     SYM$,,AUTO

  19276 26 003605   003614 710000 26                 TRA     s:19289

  19277 26 003606   200012 470500                    LDP0    SYM$,,AUTO
        26 003607   000002 220100                    LDX0    2,,PR0
        26 003610   000002 100003                    CMPX0   2,DU
        26 003611   003616 600000 26                 TZE     s:19292

  19288 26 003612   000004 236100                    LDQ     4,,PR0
        26 003613   200012 756100                    STQ     SYM$,,AUTO

  19289 26 003614   000001 116000 27                 CMPQ    1
        26 003615   003606 601000 26                 TNZ     s:19277

     1363    19292    2    IF SYM$ = ADDR(NIL) THEN

  19292 26 003616   200012 236100                    LDQ     SYM$,,AUTO
        26 003617   000001 116000 27                 CMPQ    1
        26 003620   003647 601000 26                 TNZ     s:19301

     1364    19293    3      DO;

     1365    19294             /* Identical constant was not found */
     1366    19295    3        CALL RESERVE_CONST_ITEM (%TYJ, CONST$ -> LX_TERMINAL.DNT$);

  19295 26 003621   200004 470500                    LDP0    @CONST$,,AUTO
        26 003622   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:232  
        26 003623   100002 633500                    EPPR3   2,,PR1
        26 003624   200124 453500                    STP3    @DNT$$,,AUTO
        26 003625   000057 236000 27                 LDQ     47
        26 003626   200123 756100                    STQ     @NUM_DESC,,AUTO
        26 003627   001256 701000 26                 TSX1    RESERVE_CONST_ITEM
        26 003630   000000 011000                    NOP     0

     1367    19296    3        SYM$ -> CONST.ADSC.N = 2;

  19296 26 003631   200012 470500                    LDP0    SYM$,,AUTO
        26 003632   000002 236007                    LDQ     2,DL
        26 003633   000001 752103                    STCQ    1,'03'O,PR0

     1368    19297    3        CALL Z9EC$ALIGN (CONST_VALUE, COMP_1_WORD);

  19297 26 003634   200055 630500                    EPPR0   COMP_2_WORD,,AUTO
        26 003635   200153 450500                    STP0    I+2,,AUTO
        26 003636   200037 631500                    EPPR1   CONST_VALUE,,AUTO
        26 003637   200152 451500                    STP1    I+1,,AUTO
        26 003640   200152 630500                    EPPR0   I+1,,AUTO
        26 003641   000002 631400 27                 EPPR1   2
        26 003642   000000 701000 xent               TSX1    Z9EC$ALIGN
        26 003643   000000 011000                    NOP     0

     1369    19298    3        SYM$ -> CONST.CONSTS.UPPER = COMP_1.LOWER_HALF;

  19298 26 003644   200055 720100                    LXL0    COMP_2_WORD,,AUTO
        26 003645   200012 470500                    LDP0    SYM$,,AUTO
        26 003646   000010 740100                    STX0    8,,PR0

     1370    19299    3      END;

     1371    19300
     1372    19301    2   END; /* Proc -- create_tyj_constant */

  19301 26 003647   200110 221300                    LDX1  ! N,,AUTO
        26 003650   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:233  

     1373    19302        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:234  
     1374    19303    1   CREATE_TYK_CONSTANT: PROC;

  19303 26 003651   200110 741300       CREATE_TYK_* STX1  ! N,,AUTO

     1375    19304
     1376    19305    2    CALL GET_NUMERIC_CONSTANT;

  19305 26 003652   000003 701000 26                 TSX1    GET_NUMERIC_CONSTANT
        26 003653   000000 011000                    NOP     0

     1377    19306
     1378    19307    2    CALL OVERFLOW (%TYK_SIGNIFICANCE, 0);

  19307 26 003654   000036 236000 27                 LDQ     30
        26 003655   200124 756100                    STQ     @DNT$$,,AUTO
        26 003656   000061 236000 27                 LDQ     49
        26 003657   200123 756100                    STQ     @NUM_DESC,,AUTO
        26 003660   000703 701000 26                 TSX1    OVERFLOW
        26 003661   000000 011000                    NOP     0

     1379    19308
     1380    19309    2    CALL CREATE_INTEGER_CONSTANT;

  19309 26 003662   001200 701000 26                 TSX1    CREATE_INTEGER_CONSTANT
        26 003663   000000 011000                    NOP     0

     1381    19310
     1382    19311    2    CALL VALUE_CHECK (%TYK_MAX_VALUE);

  19311 26 003664   000063 236000 27                 LDQ     51
        26 003665   200113 756100                    STQ     TN,,AUTO
        26 003666   000733 701000 26                 TSX1    VALUE_CHECK
        26 003667   000000 011000                    NOP     0

     1383    19312
     1384    19313         %SRCH_FOR_IDENTICAL_CONSTANTS (@TYPE = %TYK);

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:235  
  19317 26 003670   200016 236100                    LDQ     DNT$$,,AUTO
        26 003671   000001 116000 27                 CMPQ    1
        26 003672   003676 601000 26                 TNZ     s:19320

  19318 26 003673   000001 236000 27                 LDQ     1
        26 003674   200012 756100                    STQ     SYM$,,AUTO
        26 003675   003701 710000 26                 TRA     s:19323

  19320 26 003676   200016 470500                    LDP0    DNT$$,,AUTO
        26 003677   000001 236100                    LDQ     1,,PR0
        26 003700   200012 756100                    STQ     SYM$,,AUTO

  19323 26 003701   003710 710000 26                 TRA     s:19336

  19324 26 003702   200012 470500                    LDP0    SYM$,,AUTO
        26 003703   000002 220100                    LDX0    2,,PR0
        26 003704   000017 100003                    CMPX0   15,DU
        26 003705   003712 600000 26                 TZE     s:19339

  19335 26 003706   000004 236100                    LDQ     4,,PR0
        26 003707   200012 756100                    STQ     SYM$,,AUTO

  19336 26 003710   000001 116000 27                 CMPQ    1
        26 003711   003702 601000 26                 TNZ     s:19324

     1385    19339    2    IF SYM$ = ADDR(NIL) THEN

  19339 26 003712   200012 236100                    LDQ     SYM$,,AUTO
        26 003713   000001 116000 27                 CMPQ    1
        26 003714   003743 601000 26                 TNZ     s:19348

     1386    19340    3      DO;

     1387    19341             /* Identical constant was not found */
     1388    19342    3        CALL RESERVE_CONST_ITEM (%TYK, CONST$ -> LX_TERMINAL.DNT$);

  19342 26 003715   200004 470500                    LDP0    @CONST$,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:236  
        26 003716   000000 471500                    LDP1    0,,PR0
        26 003717   100002 633500                    EPPR3   2,,PR1
        26 003720   200124 453500                    STP3    @DNT$$,,AUTO
        26 003721   000065 236000 27                 LDQ     53
        26 003722   200123 756100                    STQ     @NUM_DESC,,AUTO
        26 003723   001256 701000 26                 TSX1    RESERVE_CONST_ITEM
        26 003724   000000 011000                    NOP     0

     1389    19343    3        SYM$ -> CONST.ADSC.N = 4;

  19343 26 003725   200012 470500                    LDP0    SYM$,,AUTO
        26 003726   000004 236007                    LDQ     4,DL
        26 003727   000001 752103                    STCQ    1,'03'O,PR0

     1390    19344    3        CALL Z9EC$ALIGN (CONST_VALUE, COMP_2_WORD);

  19344 26 003730   200055 630500                    EPPR0   COMP_2_WORD,,AUTO
        26 003731   200153 450500                    STP0    I+2,,AUTO
        26 003732   200037 631500                    EPPR1   CONST_VALUE,,AUTO
        26 003733   200152 451500                    STP1    I+1,,AUTO
        26 003734   200152 630500                    EPPR0   I+1,,AUTO
        26 003735   000002 631400 27                 EPPR1   2
        26 003736   000000 701000 xent               TSX1    Z9EC$ALIGN
        26 003737   000000 011000                    NOP     0

     1391    19345    3        SYM$ -> CONST.CONSTI.WORD1 = COMP_2_WORD;

  19345 26 003740   200012 470500                    LDP0    SYM$,,AUTO
        26 003741   200055 235100                    LDA     COMP_2_WORD,,AUTO
        26 003742   000010 755100                    STA     8,,PR0

     1392    19346    3      END;

     1393    19347
     1394    19348    2   END; /* Proc -- create_tyk_constant */

  19348 26 003743   200110 221300                    LDX1  ! N,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:237  
        26 003744   000001 702211                    TSX2  ! 1,X1

     1395    19349        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:238  
     1396    19350    1   CREATE_TYQ_CONSTANT: PROC;

  19350 26 003745   200110 741300       CREATE_TYQ_* STX1  ! N,,AUTO

     1397    19351
     1398    19352         %GET_REAL_CONSTANT( @TYPE = %TYQ,
     1399    19353                             @STK$ = CONST$ );

  19354 26 003746   200004 470500                    LDP0    @CONST$,,AUTO
        26 003747   000000 471500                    LDP1    0,,PR0
        26 003750   100003 236100                    LDQ     3,,PR1
        26 003751   000025 116007                    CMPQ    21,DL
        26 003752   003757 604000 26                 TMI     s:19354+9
        26 003753   003762 600000 26                 TZE     s:19362
        26 003754   000026 116007                    CMPQ    22,DL
        26 003755   004004 601000 26                 TNZ     s:19368
        26 003756   003762 710000 26                 TRA     s:19362
        26 003757   000002 116007                    CMPQ    2,DL
        26 003760   004004 601000 26                 TNZ     s:19368
        26 003761   003762 710000 26                 TRA     s:19362

  19362 26 003762   200016 473500                    LDP3    DNT$$,,AUTO
        26 003763   300004 236100                    LDQ     4,,PR3
        26 003764   000022 772000                    QRL     18
        26 003765   200152 756100                    STQ     I+1,,AUTO
        26 003766   200041 631500                    EPPR1   VALUE_OVERFLOW,,AUTO
        26 003767   200157 451500                    STP1    I+6,,AUTO
        26 003770   200017 634500                    EPPR4   LITERAL_SYMBOL,,AUTO
        26 003771   200156 454500                    STP4    I+5,,AUTO
        26 003772   200152 635500                    EPPR5   I+1,,AUTO
        26 003773   200155 455500                    STP5    I+4,,AUTO
        26 003774   200016 236100                    LDQ     DNT$$,,AUTO
        26 003775   000004 036000 27                 ADLQ    4
        26 003776   200154 756100                    STQ     I+3,,AUTO
        26 003777   200154 630500                    EPPR0   I+3,,AUTO
        26 004000   000026 631400 27                 EPPR1   22
        26 004001   000000 701000 xent               TSX1    Z8EC$DOUBLE_FLOAT
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:239  
        26 004002   000000 011000                    NOP     0
        26 004003   004022 710000 26                 TRA     s:19389

  19368 26 004004   000112 701000 26                 TSX1    CREATE_ALPHA_OR_FIG_CONST
        26 004005   004022 702000 26                 TSX2    s:19389

  19377 26 004006   200041 630500                    EPPR0   VALUE_OVERFLOW,,AUTO
        26 004007   200155 450500                    STP0    I+4,,AUTO
        26 004010   200017 631500                    EPPR1   LITERAL_SYMBOL,,AUTO
        26 004011   200154 451500                    STP1    I+3,,AUTO
        26 004012   200007 633500                    EPPR3   CONSTANT_LENGTH,,AUTO
        26 004013   200153 453500                    STP3    I+2,,AUTO
        26 004014   200017 634500                    EPPR4   LITERAL_SYMBOL,,AUTO
        26 004015   200152 454500                    STP4    I+1,,AUTO
        26 004016   200152 630500                    EPPR0   I+1,,AUTO
        26 004017   000026 631400 27                 EPPR1   22
        26 004020   000000 701000 xent               TSX1    Z8EC$DOUBLE_FLOAT
        26 004021   000000 011000                    NOP     0

     1400    19385         %SRCH_FOR_IDENTICAL_CONSTANTS (@TYPE = %TYQ);

  19389 26 004022   200016 236100                    LDQ     DNT$$,,AUTO
        26 004023   000001 116000 27                 CMPQ    1
        26 004024   004030 601000 26                 TNZ     s:19392

  19390 26 004025   000001 236000 27                 LDQ     1
        26 004026   200012 756100                    STQ     SYM$,,AUTO
        26 004027   004033 710000 26                 TRA     s:19395

  19392 26 004030   200016 470500                    LDP0    DNT$$,,AUTO
        26 004031   000001 236100                    LDQ     1,,PR0
        26 004032   200012 756100                    STQ     SYM$,,AUTO

  19395 26 004033   004042 710000 26                 TRA     s:19408

  19396 26 004034   200012 470500                    LDP0    SYM$,,AUTO
        26 004035   000002 220100                    LDX0    2,,PR0
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:240  
        26 004036   000005 100003                    CMPX0   5,DU
        26 004037   004044 600000 26                 TZE     s:19411

  19407 26 004040   000004 236100                    LDQ     4,,PR0
        26 004041   200012 756100                    STQ     SYM$,,AUTO

  19408 26 004042   000001 116000 27                 CMPQ    1
        26 004043   004034 601000 26                 TNZ     s:19396

     1401    19411    2    IF SYM$ = ADDR(NIL) THEN

  19411 26 004044   200012 236100                    LDQ     SYM$,,AUTO
        26 004045   000001 116000 27                 CMPQ    1
        26 004046   004105 601000 26                 TNZ     s:19424

     1402    19412    3      DO;

     1403    19413             /* Identical item not found */
     1404    19414    3        CALL RESERVE_CONST_ITEM (%TYQ, CONST$ -> LX_TERMINAL.DNT$);

  19414 26 004047   200004 470500                    LDP0    @CONST$,,AUTO
        26 004050   000000 471500                    LDP1    0,,PR0
        26 004051   100002 633500                    EPPR3   2,,PR1
        26 004052   200124 453500                    STP3    @DNT$$,,AUTO
        26 004053   000053 236000 27                 LDQ     43
        26 004054   200123 756100                    STQ     @NUM_DESC,,AUTO
        26 004055   001256 701000 26                 TSX1    RESERVE_CONST_ITEM
        26 004056   000000 011000                    NOP     0

     1405    19415    3        SYM$ -> CONST.NDSC.SF = 0;

  19415 26 004057   200012 470500                    LDP0    SYM$,,AUTO
        26 004060   000000 236003                    LDQ     0,DU
        26 004061   000001 752102                    STCQ    1,'02'O,PR0

     1406    19416    3        SYM$ -> CONST.NDSC.N  = %TYQ_LENGTH;

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:241  
  19416 26 004062   200012 470500                    LDP0    SYM$,,AUTO
        26 004063   000010 236007                    LDQ     8,DL
        26 004064   000001 752101                    STCQ    1,'01'O,PR0

     1407    19417    3        SYM$ -> CONST.NDSC.TN = %NDSC9;

  19417 26 004065   200012 470500                    LDP0    SYM$,,AUTO
        26 004066   000025 236000 27                 LDQ     21
        26 004067   000001 356100                    ANSQ    1,,PR0

     1408    19418    3        SYM$ -> CONST.NDSC.S  = %FLOATING_POINT_LEADING_SIGN;

  19418 26 004070   200012 470500                    LDP0    SYM$,,AUTO
        26 004071   000040 236000 27                 LDQ     32
        26 004072   000001 356100                    ANSQ    1,,PR0

     1409    19419    3        SYM$ -> CONST.B.MOD_2 = TRUE;

  19419 26 004073   200012 470500                    LDP0    SYM$,,AUTO
        26 004074   100000 236003                    LDQ     32768,DU
        26 004075   000003 256100                    ORSQ    3,,PR0

     1410    19420    3        SYM$ -> CONST.B.TWO_WORD = TRUE;

  19420 26 004076   200012 470500                    LDP0    SYM$,,AUTO
        26 004077   200000 236003                    LDQ     65536,DU
        26 004100   000003 256100                    ORSQ    3,,PR0

     1411    19421    3        SYM$ -> CONST.CONSTA  = SUBSTR(LITERAL_SYMBOL,0,8);

  19421 26 004101   200012 470500                    LDP0    SYM$,,AUTO
        26 004102   040100 100500                    MLR     fill='040'O
        26 004103   200017 000010                    ADSC9   LITERAL_SYMBOL,,AUTO     cn=0,n=8
        26 004104   000010 000010                    ADSC9   8,,PR0                   cn=0,n=8

     1412    19422    3      END;

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:242  
     1413    19423
     1414    19424    2   END; /* Proc -- Create_tyq_constant */

  19424 26 004105   200110 221300                    LDX1  ! N,,AUTO
        26 004106   000001 702211                    TSX2  ! 1,X1

     1415    19425        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:243  
     1416    19426    1   CREATE_TYR_CONSTANT: PROC;

  19426 26 004107   200110 741300       CREATE_TYR_* STX1  ! N,,AUTO

     1417    19427
     1418    19428         %GET_REAL_CONSTANT( @TYPE = %TYR,
     1419    19429                             @STK$ = CONST$ );

  19430 26 004110   200004 470500                    LDP0    @CONST$,,AUTO
        26 004111   000000 471500                    LDP1    0,,PR0
        26 004112   100003 236100                    LDQ     3,,PR1
        26 004113   000025 116007                    CMPQ    21,DL
        26 004114   004121 604000 26                 TMI     s:19430+9
        26 004115   004124 600000 26                 TZE     s:19433
        26 004116   000026 116007                    CMPQ    22,DL
        26 004117   004146 601000 26                 TNZ     s:19444
        26 004120   004124 710000 26                 TRA     s:19433
        26 004121   000002 116007                    CMPQ    2,DL
        26 004122   004146 601000 26                 TNZ     s:19444
        26 004123   004124 710000 26                 TRA     s:19433

  19433 26 004124   200016 473500                    LDP3    DNT$$,,AUTO
        26 004125   300004 236100                    LDQ     4,,PR3
        26 004126   000022 772000                    QRL     18
        26 004127   200152 756100                    STQ     I+1,,AUTO
        26 004130   200041 631500                    EPPR1   VALUE_OVERFLOW,,AUTO
        26 004131   200157 451500                    STP1    I+6,,AUTO
        26 004132   200017 634500                    EPPR4   LITERAL_SYMBOL,,AUTO
        26 004133   200156 454500                    STP4    I+5,,AUTO
        26 004134   200152 635500                    EPPR5   I+1,,AUTO
        26 004135   200155 455500                    STP5    I+4,,AUTO
        26 004136   200016 236100                    LDQ     DNT$$,,AUTO
        26 004137   000004 036000 27                 ADLQ    4
        26 004140   200154 756100                    STQ     I+3,,AUTO
        26 004141   200154 630500                    EPPR0   I+3,,AUTO
        26 004142   000026 631400 27                 EPPR1   22
        26 004143   000000 701000 xent               TSX1    Z8EC$FLOAT
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:244  
        26 004144   000000 011000                    NOP     0
        26 004145   004164 710000 26                 TRA     s:19465

  19444 26 004146   000112 701000 26                 TSX1    CREATE_ALPHA_OR_FIG_CONST
        26 004147   004164 702000 26                 TSX2    s:19465

  19448 26 004150   200041 630500                    EPPR0   VALUE_OVERFLOW,,AUTO
        26 004151   200155 450500                    STP0    I+4,,AUTO
        26 004152   200017 631500                    EPPR1   LITERAL_SYMBOL,,AUTO
        26 004153   200154 451500                    STP1    I+3,,AUTO
        26 004154   200007 633500                    EPPR3   CONSTANT_LENGTH,,AUTO
        26 004155   200153 453500                    STP3    I+2,,AUTO
        26 004156   200017 634500                    EPPR4   LITERAL_SYMBOL,,AUTO
        26 004157   200152 454500                    STP4    I+1,,AUTO
        26 004160   200152 630500                    EPPR0   I+1,,AUTO
        26 004161   000026 631400 27                 EPPR1   22
        26 004162   000000 701000 xent               TSX1    Z8EC$FLOAT
        26 004163   000000 011000                    NOP     0

     1420    19461         %SRCH_FOR_IDENTICAL_CONSTANTS (@TYPE = %TYR);

  19465 26 004164   200016 236100                    LDQ     DNT$$,,AUTO
        26 004165   000001 116000 27                 CMPQ    1
        26 004166   004172 601000 26                 TNZ     s:19468

  19466 26 004167   000001 236000 27                 LDQ     1
        26 004170   200012 756100                    STQ     SYM$,,AUTO
        26 004171   004175 710000 26                 TRA     s:19471

  19468 26 004172   200016 470500                    LDP0    DNT$$,,AUTO
        26 004173   000001 236100                    LDQ     1,,PR0
        26 004174   200012 756100                    STQ     SYM$,,AUTO

  19471 26 004175   004204 710000 26                 TRA     s:19484

  19472 26 004176   200012 470500                    LDP0    SYM$,,AUTO
        26 004177   000002 220100                    LDX0    2,,PR0
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:245  
        26 004200   000004 100003                    CMPX0   4,DU
        26 004201   004206 600000 26                 TZE     s:19487

  19483 26 004202   000004 236100                    LDQ     4,,PR0
        26 004203   200012 756100                    STQ     SYM$,,AUTO

  19484 26 004204   000001 116000 27                 CMPQ    1
        26 004205   004176 601000 26                 TNZ     s:19472

     1421    19487    2    IF SYM$ = ADDR(NIL) THEN

  19487 26 004206   200012 236100                    LDQ     SYM$,,AUTO
        26 004207   000001 116000 27                 CMPQ    1
        26 004210   004241 601000 26                 TNZ     s:19498

     1422    19488    3      DO;

     1423    19489             /* Identical item not found */
     1424    19490    3        CALL RESERVE_CONST_ITEM (%TYR, CONST$ -> LX_TERMINAL.DNT$);

  19490 26 004211   200004 470500                    LDP0    @CONST$,,AUTO
        26 004212   000000 471500                    LDP1    0,,PR0
        26 004213   100002 633500                    EPPR3   2,,PR1
        26 004214   200124 453500                    STP3    @DNT$$,,AUTO
        26 004215   000067 236000 27                 LDQ     55
        26 004216   200123 756100                    STQ     @NUM_DESC,,AUTO
        26 004217   001256 701000 26                 TSX1    RESERVE_CONST_ITEM
        26 004220   000000 011000                    NOP     0

     1425    19491    3        SYM$ -> CONST.NDSC.SF = 0;

  19491 26 004221   200012 470500                    LDP0    SYM$,,AUTO
        26 004222   000000 236003                    LDQ     0,DU
        26 004223   000001 752102                    STCQ    1,'02'O,PR0

     1426    19492    3        SYM$ -> CONST.NDSC.N  = %TYR_LENGTH;

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:246  
  19492 26 004224   200012 470500                    LDP0    SYM$,,AUTO
        26 004225   000004 236007                    LDQ     4,DL
        26 004226   000001 752101                    STCQ    1,'01'O,PR0

     1427    19493    3        SYM$ -> CONST.NDSC.TN = %NDSC9;

  19493 26 004227   200012 470500                    LDP0    SYM$,,AUTO
        26 004230   000025 236000 27                 LDQ     21
        26 004231   000001 356100                    ANSQ    1,,PR0

     1428    19494    3        SYM$ -> CONST.NDSC.S  = %FLOATING_POINT_LEADING_SIGN;

  19494 26 004232   200012 470500                    LDP0    SYM$,,AUTO
        26 004233   000040 236000 27                 LDQ     32
        26 004234   000001 356100                    ANSQ    1,,PR0

     1429    19495    3        SYM$ -> CONST.CONSTA  = SUBSTR(LITERAL_SYMBOL,0,8);

  19495 26 004235   200012 470500                    LDP0    SYM$,,AUTO
        26 004236   040100 100500                    MLR     fill='040'O
        26 004237   200017 000010                    ADSC9   LITERAL_SYMBOL,,AUTO     cn=0,n=8
        26 004240   000010 000010                    ADSC9   8,,PR0                   cn=0,n=8

     1430    19496    3      END;

     1431    19497
     1432    19498    2   END; /* Proc -- Create_tyq_constant */

  19498 26 004241   200110 221300                    LDX1  ! N,,AUTO
        26 004242   000001 702211                    TSX2  ! 1,X1

     1433    19499        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:247  
     1434    19500    1   CREATE_TYO_CONSTANT: PROC ;

  19500 26 004243   200110 741300       CREATE_TYO_* STX1  ! N,,AUTO

     1435    19501
     1436    19502    2      CALL GET_NUMERIC_CONSTANT;

  19502 26 004244   000003 701000 26                 TSX1    GET_NUMERIC_CONSTANT
        26 004245   000000 011000                    NOP     0

     1437    19503
     1438    19504    2      CALL BUILD_TYO;

  19504 26 004246   001356 701000 26                 TSX1    BUILD_TYO
        26 004247   000000 011000                    NOP     0

     1439    19505
     1440    19506           %ASSIGN_SYM$_THE_DNT_ST$;

  19508 26 004250   200016 236100                    LDQ     DNT$$,,AUTO
        26 004251   000001 116000 27                 CMPQ    1
        26 004252   004256 601000 26                 TNZ     s:19511

  19509 26 004253   000001 236000 27                 LDQ     1
        26 004254   200012 756100                    STQ     SYM$,,AUTO
        26 004255   004261 710000 26                 TRA     s:19519

  19511 26 004256   200016 470500                    LDP0    DNT$$,,AUTO
        26 004257   000001 236100                    LDQ     1,,PR0
        26 004260   200012 756100                    STQ     SYM$,,AUTO

     1441    19514
     1442    19515           %SRCH_FOR_IDENTICAL_CONSTANTS (@TYPE = %TYO);

  19519 26 004261   200016 236100                    LDQ     DNT$$,,AUTO
        26 004262   000001 116000 27                 CMPQ    1
        26 004263   004267 601000 26                 TNZ     s:19522
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:248  

  19520 26 004264   000001 236000 27                 LDQ     1
        26 004265   200012 756100                    STQ     SYM$,,AUTO
        26 004266   004272 710000 26                 TRA     s:19525

  19522 26 004267   200016 470500                    LDP0    DNT$$,,AUTO
        26 004270   000001 236100                    LDQ     1,,PR0
        26 004271   200012 756100                    STQ     SYM$,,AUTO

  19525 26 004272   004301 710000 26                 TRA     s:19538

  19526 26 004273   200012 470500                    LDP0    SYM$,,AUTO
        26 004274   000002 220100                    LDX0    2,,PR0
        26 004275   000003 100003                    CMPX0   3,DU
        26 004276   004303 600000 26                 TZE     s:19542

  19537 26 004277   000004 236100                    LDQ     4,,PR0
        26 004300   200012 756100                    STQ     SYM$,,AUTO

  19538 26 004301   000001 116000 27                 CMPQ    1
        26 004302   004273 601000 26                 TNZ     s:19526

     1443    19541
     1444    19542    2      IF SYM$ = ADDR(NIL) THEN

  19542 26 004303   200012 236100                    LDQ     SYM$,,AUTO
        26 004304   000001 116000 27                 CMPQ    1
        26 004305   004425 601000 26                 TNZ     s:19656

     1445    19543    3        DO;

     1446    19544    3          CALL RESERVE_CONST_ITEM (%TYO, CONST$ -> LX_TERMINAL.DNT$);

  19544 26 004306   200004 470500                    LDP0    @CONST$,,AUTO
        26 004307   000000 471500                    LDP1    0,,PR0
        26 004310   100002 633500                    EPPR3   2,,PR1
        26 004311   200124 453500                    STP3    @DNT$$,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:249  
        26 004312   000071 236000 27                 LDQ     57
        26 004313   200123 756100                    STQ     @NUM_DESC,,AUTO
        26 004314   001256 701000 26                 TSX1    RESERVE_CONST_ITEM
        26 004315   000000 011000                    NOP     0

     1447    19545
     1448    19546    3          SYM$ -> CONST.NDSC.SF   = CONSTANT_SF;

  19546 26 004316   200012 470500                    LDP0    SYM$,,AUTO
        26 004317   200010 236100                    LDQ     CONSTANT_SF,,AUTO
        26 004320   000006 736000                    QLS     6
        26 004321   000001 752102                    STCQ    1,'02'O,PR0

     1449    19547    3          SYM$ -> CONST.NDSC.TN   = %NDSC9;

  19547 26 004322   200012 470500                    LDP0    SYM$,,AUTO
        26 004323   000025 236000 27                 LDQ     21
        26 004324   000001 356100                    ANSQ    1,,PR0

     1450    19548    3          SYM$ -> CONST.NDSC.S    = %LEADING_SIGN;

  19548 26 004325   200012 470500                    LDP0    SYM$,,AUTO
        26 004326   000001 236100                    LDQ     1,,PR0
        26 004327   000040 376000 27                 ANQ     32
        26 004330   010000 276007                    ORQ     4096,DL
        26 004331   000001 756100                    STQ     1,,PR0

     1451    19549    3          SYM$ -> CONST.NDSC.N    = CONSTANT_LENGTH;

  19549 26 004332   200012 470500                    LDP0    SYM$,,AUTO
        26 004333   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 004334   000001 752101                    STCQ    1,'01'O,PR0

     1452    19550
     1453    19551               %ENTER_9BIT_NUMERIC_CONSTANT;

  19552 26 004335   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:250  
        26 004336   000010 115007                    CMPA    8,DL
        26 004337   004410 604400 26                 TMOZ    s:19649

  19555 26 004340   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 004341   000003 036007                    ADLQ    3,DL
        26 004342   000004 506007                    DIV     4,DL
        26 004343   000001 036007                    ADLQ    1,DL
        26 004344   000000 756000 0                  STQ     ITERATION

  19632 26 004345   000002 036000 2                  ADLQ    LTS_+2
        26 004346   000003 116000 2                  CMPQ    LTS_+3
        26 004347   004360 604000 26                 TMI     s:19634

  19633 26 004350   000041 236000 27                 LDQ     33
        26 004351   200152 756100                    STQ     I+1,,AUTO
        26 004352   200152 630500                    EPPR0   I+1,,AUTO
        26 004353   200153 450500                    STP0    I+2,,AUTO
        26 004354   200153 630500                    EPPR0   I+2,,AUTO
        26 004355   000006 631400 27                 EPPR1   6
        26 004356   000000 701000 xent               TSX1    Z8AR$RESERVER
        26 004357   000000 011000                    NOP     0

  19634 26 004360   000002 236000 2                  LDQ     LTS_+2
        26 004361   000022 736000                    QLS     18
        26 004362   000001 036000 2                  ADLQ    LTS_+1
        26 004363   200015 756100                    STQ     LTSS$,,AUTO

  19635 26 004364   000002 236000 2                  LDQ     LTS_+2
        26 004365   000000 036000 0                  ADLQ    ITERATION
        26 004366   000002 756000 2                  STQ     LTS_+2

  19636 26 004367   001106 220003                    LDX0    582,DU
        26 004370   200015 470500                    LDP0    LTSS$,,AUTO
        26 004371   000000 740100                    STX0    0,,PR0

  19638 26 004372   000000 721000 0                  LXL1    ITERATION
        26 004373   000000 441100                    SXL1    0,,PR0
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:251  

  19642 26 004374   200014 471500                    LDP1    CONSTANT_SYM$,,AUTO
        26 004375   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 004376   040140 100540                    MLR     fill='040'O
        26 004377   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
        26 004400   000001 000012                    ADSC9   1,,PR0                   cn=0,n=*X2

  19643 26 004401   200015 236100                    LDQ     LTSS$,,AUTO
        26 004402   200012 473500                    LDP3    SYM$,,AUTO
        26 004403   300010 756100                    STQ     8,,PR3

  19644 26 004404   200012 473500                    LDP3    SYM$,,AUTO
        26 004405   400000 236003                    LDQ     -131072,DU
        26 004406   300003 256100                    ORSQ    3,,PR3

  19645 26 004407   004425 710000 26                 TRA     s:19656

  19649 26 004410   200014 470500                    LDP0    CONSTANT_SYM$,,AUTO
        26 004411   000000 620005                    EAX0    0,AL
        26 004412   200012 471500                    LDP1    SYM$,,AUTO
        26 004413   200007 721100                    LXL1    CONSTANT_LENGTH,,AUTO
        26 004414   040140 100540                    MLR     fill='040'O
        26 004415   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
        26 004416   100010 000011                    ADSC9   8,,PR1                   cn=0,n=*X1

  19650 26 004417   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 004420   000004 115007                    CMPA    4,DL
        26 004421   004425 604400 26                 TMOZ    s:19656

  19651 26 004422   200012 471500                    LDP1    SYM$,,AUTO
        26 004423   200000 236003                    LDQ     65536,DU
        26 004424   100003 256100                    ORSQ    3,,PR1

     1454    19654    3        END;

     1455    19655
     1456    19656    2   END CREATE_TYO_CONSTANT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:252  

  19656 26 004425   200110 221300                    LDX1  ! N,,AUTO
        26 004426   000001 702211                    TSX2  ! 1,X1

     1457    19657        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:253  
     1458    19658    1   CREATE_TYO_WITH_TYPE_DESC: PROC (TYPE_DESC) ;

  19658 26 004427   200106 741300       CREATE_TYO_* STX1  ! NUM_DESC+6,,AUTO

     1459    19659
     1460    19660    2   DCL 1 TYPE_DESC        ALIGNED,
     1461    19661             %TYPE_DESC;
     1462    19695
     1463    19696    2    CALL GET_NUMERIC_CONSTANT;

  19696 26 004430   000003 701000 26                 TSX1    GET_NUMERIC_CONSTANT
        26 004431   000000 011000                    NOP     0

     1464    19697
     1465    19698    2    CALL NDSC9_OVERFLOW (TYPE_DESC);

  19698 26 004432   200107 236100                    LDQ     @TYPE_DESC,,AUTO
        26 004433   200115 756100                    STQ     @N,,AUTO
        26 004434   000757 701000 26                 TSX1    NDSC9_OVERFLOW
        26 004435   000000 011000                    NOP     0

     1466    19699
     1467    19700    2    CALL BUILD_TYO_WITH_TYPE_DESC (TYPE_DESC);

  19700 26 004436   200107 236100                    LDQ     @TYPE_DESC,,AUTO
        26 004437   200111 756100                    STQ     S,,AUTO
        26 004440   001421 701000 26                 TSX1    BUILD_TYO_WITH_TYPE_DESC
        26 004441   000000 011000                    NOP     0

     1468    19701         %ASSIGN_SYM$_THE_DNT_ST$;

  19703 26 004442   200016 236100                    LDQ     DNT$$,,AUTO
        26 004443   000001 116000 27                 CMPQ    1
        26 004444   004450 601000 26                 TNZ     s:19706

  19704 26 004445   000001 236000 27                 LDQ     1
        26 004446   200012 756100                    STQ     SYM$,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:254  
        26 004447   004453 710000 26                 TRA     s:19710

  19706 26 004450   200016 470500                    LDP0    DNT$$,,AUTO
        26 004451   000001 236100                    LDQ     1,,PR0
        26 004452   200012 756100                    STQ     SYM$,,AUTO

     1469    19709
     1470    19710    3    DO WHILE (SYM$ ~= ADDR(NIL));

  19710 26 004453   004473 710000 26                 TRA     s:19720

     1471    19711    3      IF SYM$ -> CONST.TYPE = %TYO THEN

  19711 26 004454   200012 470500                    LDP0    SYM$,,AUTO
        26 004455   000002 220100                    LDX0    2,,PR0
        26 004456   000003 100003                    CMPX0   3,DU
        26 004457   004471 601000 26                 TNZ     s:19719

     1472    19712    3        IF TYPE_DESC.DESC.NDSC.N = SYM$ -> CONST.NDSC.N

  19712 26 004460   200107 471500                    LDP1    @TYPE_DESC,,AUTO
        26 004461   100001 236100                    LDQ     1,,PR1
        26 004462   000001 676100                    ERQ     1,,PR0
        26 004463   000077 376007                    ANQ     63,DL
        26 004464   004471 601000 26                 TNZ     s:19719
        26 004465   100001 236100                    LDQ     1,,PR1
        26 004466   000001 676100                    ERQ     1,,PR0
        26 004467   030000 376007                    ANQ     12288,DL
        26 004470   004475 600000 26                 TZE     s:19722

     1473    19713    3        AND TYPE_DESC.DESC.NDSC.S = SYM$ -> CONST.NDSC.S THEN
     1474    19714               %IF_SEGMENT_COUNT_VALID_THEN;
     1475    19717    3            EXIT; /* Identical constant found */
     1476    19718
     1477    19719    3      SYM$ = SYM$ -> CONST.NEXT;

  19719 26 004471   000004 236100                    LDQ     4,,PR0
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:255  
        26 004472   200012 756100                    STQ     SYM$,,AUTO

     1478    19720    3    END;

  19720 26 004473   000001 116000 27                 CMPQ    1
        26 004474   004454 601000 26                 TNZ     s:19711

     1479    19721
     1480    19722    2    IF SYM$ = ADDR(NIL) THEN

  19722 26 004475   200012 236100                    LDQ     SYM$,,AUTO
        26 004476   000001 116000 27                 CMPQ    1
        26 004477   004620 601000 26                 TNZ     s:19838

     1481    19723    3      DO;

     1482    19724             /* Identical constant not found */
     1483    19725    3        CALL RESERVE_CONST_ITEM (%TYO, CONST$ -> LX_TERMINAL.DNT$);

  19725 26 004500   200004 470500                    LDP0    @CONST$,,AUTO
        26 004501   000000 471500                    LDP1    0,,PR0
        26 004502   100002 633500                    EPPR3   2,,PR1
        26 004503   200124 453500                    STP3    @DNT$$,,AUTO
        26 004504   000071 236000 27                 LDQ     57
        26 004505   200123 756100                    STQ     @NUM_DESC,,AUTO
        26 004506   001256 701000 26                 TSX1    RESERVE_CONST_ITEM
        26 004507   000000 011000                    NOP     0

     1484    19726    3        SYM$ -> CONST.NDSC.SF = CONSTANT_SF;

  19726 26 004510   200012 470500                    LDP0    SYM$,,AUTO
        26 004511   200010 236100                    LDQ     CONSTANT_SF,,AUTO
        26 004512   000006 736000                    QLS     6
        26 004513   000001 752102                    STCQ    1,'02'O,PR0

     1485    19727    3        SYM$ -> CONST.NDSC.TN = %NDSC9;

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:256  
  19727 26 004514   200012 470500                    LDP0    SYM$,,AUTO
        26 004515   000025 236000 27                 LDQ     21
        26 004516   000001 356100                    ANSQ    1,,PR0

     1486    19728
     1487    19729    3        SYM$ -> CONST.NDSC.S = TYPE_DESC.DESC.NDSC.S;

  19729 26 004517   200012 470500                    LDP0    SYM$,,AUTO
        26 004520   200107 471500                    LDP1    @TYPE_DESC,,AUTO
        26 004521   100001 236100                    LDQ     1,,PR1
        26 004522   000001 676100                    ERQ     1,,PR0
        26 004523   030000 376007                    ANQ     12288,DL
        26 004524   000001 656100                    ERSQ    1,,PR0

     1488    19730
     1489    19731    3        SYM$ -> CONST.NDSC.N  = CONSTANT_LENGTH;

  19731 26 004525   200012 470500                    LDP0    SYM$,,AUTO
        26 004526   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 004527   000001 752101                    STCQ    1,'01'O,PR0

     1490    19732
     1491    19733             %ENTER_9BIT_NUMERIC_CONSTANT;

  19734 26 004530   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 004531   000010 115007                    CMPA    8,DL
        26 004532   004603 604400 26                 TMOZ    s:19831

  19737 26 004533   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 004534   000003 036007                    ADLQ    3,DL
        26 004535   000004 506007                    DIV     4,DL
        26 004536   000001 036007                    ADLQ    1,DL
        26 004537   000000 756000 0                  STQ     ITERATION

  19814 26 004540   000002 036000 2                  ADLQ    LTS_+2
        26 004541   000003 116000 2                  CMPQ    LTS_+3
        26 004542   004553 604000 26                 TMI     s:19816
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:257  

  19815 26 004543   000041 236000 27                 LDQ     33
        26 004544   200152 756100                    STQ     I+1,,AUTO
        26 004545   200152 630500                    EPPR0   I+1,,AUTO
        26 004546   200153 450500                    STP0    I+2,,AUTO
        26 004547   200153 630500                    EPPR0   I+2,,AUTO
        26 004550   000006 631400 27                 EPPR1   6
        26 004551   000000 701000 xent               TSX1    Z8AR$RESERVER
        26 004552   000000 011000                    NOP     0

  19816 26 004553   000002 236000 2                  LDQ     LTS_+2
        26 004554   000022 736000                    QLS     18
        26 004555   000001 036000 2                  ADLQ    LTS_+1
        26 004556   200015 756100                    STQ     LTSS$,,AUTO

  19817 26 004557   000002 236000 2                  LDQ     LTS_+2
        26 004560   000000 036000 0                  ADLQ    ITERATION
        26 004561   000002 756000 2                  STQ     LTS_+2

  19818 26 004562   001106 220003                    LDX0    582,DU
        26 004563   200015 470500                    LDP0    LTSS$,,AUTO
        26 004564   000000 740100                    STX0    0,,PR0

  19820 26 004565   000000 721000 0                  LXL1    ITERATION
        26 004566   000000 441100                    SXL1    0,,PR0

  19824 26 004567   200014 471500                    LDP1    CONSTANT_SYM$,,AUTO
        26 004570   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 004571   040140 100540                    MLR     fill='040'O
        26 004572   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
        26 004573   000001 000012                    ADSC9   1,,PR0                   cn=0,n=*X2

  19825 26 004574   200015 236100                    LDQ     LTSS$,,AUTO
        26 004575   200012 473500                    LDP3    SYM$,,AUTO
        26 004576   300010 756100                    STQ     8,,PR3

  19826 26 004577   200012 473500                    LDP3    SYM$,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:258  
        26 004600   400000 236003                    LDQ     -131072,DU
        26 004601   300003 256100                    ORSQ    3,,PR3

  19827 26 004602   004620 710000 26                 TRA     s:19838

  19831 26 004603   200014 470500                    LDP0    CONSTANT_SYM$,,AUTO
        26 004604   000000 620005                    EAX0    0,AL
        26 004605   200012 473500                    LDP3    SYM$,,AUTO
        26 004606   200007 721100                    LXL1    CONSTANT_LENGTH,,AUTO
        26 004607   040140 100540                    MLR     fill='040'O
        26 004610   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
        26 004611   300010 000011                    ADSC9   8,,PR3                   cn=0,n=*X1

  19832 26 004612   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 004613   000004 115007                    CMPA    4,DL
        26 004614   004620 604400 26                 TMOZ    s:19838

  19833 26 004615   200012 473500                    LDP3    SYM$,,AUTO
        26 004616   200000 236003                    LDQ     65536,DU
        26 004617   300003 256100                    ORSQ    3,,PR3

     1492    19836    3      END;

     1493    19837
     1494    19838    2   END CREATE_TYO_WITH_TYPE_DESC;

  19838 26 004620   200106 221300                    LDX1  ! NUM_DESC+6,,AUTO
        26 004621   000001 702211                    TSX2  ! 1,X1

     1495    19839        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:259  
     1496    19840    1   CREATE_TYF_CONSTANT: PROC ;

  19840 26 004622   200110 741300       CREATE_TYF_* STX1  ! N,,AUTO

     1497    19841        /*I*  NAME: CREATE_TYF_CONSTANT
     1498    19842           PURPOSE: Make an EBCDIC numeric constant.
     1499    19843        */
     1500    19844
     1501    19845    2      CALL GET_NUMERIC_CONSTANT;

  19845 26 004623   000003 701000 26                 TSX1    GET_NUMERIC_CONSTANT
        26 004624   000000 011000                    NOP     0

     1502    19846
     1503    19847           %ASSIGN_SYM$_THE_DNT_ST$;

  19849 26 004625   200016 236100                    LDQ     DNT$$,,AUTO
        26 004626   000001 116000 27                 CMPQ    1
        26 004627   004633 601000 26                 TNZ     s:19852

  19850 26 004630   000001 236000 27                 LDQ     1
        26 004631   200012 756100                    STQ     SYM$,,AUTO
        26 004632   004636 710000 26                 TRA     s:19860

  19852 26 004633   200016 470500                    LDP0    DNT$$,,AUTO
        26 004634   000001 236100                    LDQ     1,,PR0
        26 004635   200012 756100                    STQ     SYM$,,AUTO

     1504    19855
     1505    19856           %SRCH_FOR_IDENTICAL_CONSTANTS (@TYPE = %TYF);

  19860 26 004636   200016 236100                    LDQ     DNT$$,,AUTO
        26 004637   000001 116000 27                 CMPQ    1
        26 004640   004644 601000 26                 TNZ     s:19863

  19861 26 004641   000001 236000 27                 LDQ     1
        26 004642   200012 756100                    STQ     SYM$,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:260  
        26 004643   004647 710000 26                 TRA     s:19866

  19863 26 004644   200016 470500                    LDP0    DNT$$,,AUTO
        26 004645   000001 236100                    LDQ     1,,PR0
        26 004646   200012 756100                    STQ     SYM$,,AUTO

  19866 26 004647   004656 710000 26                 TRA     s:19879

  19867 26 004650   200012 470500                    LDP0    SYM$,,AUTO
        26 004651   000002 220100                    LDX0    2,,PR0
        26 004652   000013 100003                    CMPX0   11,DU
        26 004653   004660 600000 26                 TZE     s:19883

  19878 26 004654   000004 236100                    LDQ     4,,PR0
        26 004655   200012 756100                    STQ     SYM$,,AUTO

  19879 26 004656   000001 116000 27                 CMPQ    1
        26 004657   004650 601000 26                 TNZ     s:19867

     1506    19882
     1507    19883    2      IF SYM$ = ADDR(NIL) THEN

  19883 26 004660   200012 236100                    LDQ     SYM$,,AUTO
        26 004661   000001 116000 27                 CMPQ    1
        26 004662   005026 601000 26                 TNZ     s:20003

     1508    19884    3        DO;

     1509    19885    3          CALL RESERVE_CONST_ITEM (%TYF, CONST$ -> LX_TERMINAL.DNT$);

  19885 26 004663   200004 470500                    LDP0    @CONST$,,AUTO
        26 004664   000000 471500                    LDP1    0,,PR0
        26 004665   100002 633500                    EPPR3   2,,PR1
        26 004666   200124 453500                    STP3    @DNT$$,,AUTO
        26 004667   000043 236000 27                 LDQ     35
        26 004670   200123 756100                    STQ     @NUM_DESC,,AUTO
        26 004671   001256 701000 26                 TSX1    RESERVE_CONST_ITEM
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:261  
        26 004672   000000 011000                    NOP     0

     1510    19886
     1511    19887    3          SYM$ -> CONST.NDSC.SF   = CONSTANT_SF;

  19887 26 004673   200012 470500                    LDP0    SYM$,,AUTO
        26 004674   200010 236100                    LDQ     CONSTANT_SF,,AUTO
        26 004675   000006 736000                    QLS     6
        26 004676   000001 752102                    STCQ    1,'02'O,PR0

     1512    19888    3          SYM$ -> CONST.NDSC.TN   = %NDSC9;

  19888 26 004677   200012 470500                    LDP0    SYM$,,AUTO
        26 004700   000025 236000 27                 LDQ     21
        26 004701   000001 356100                    ANSQ    1,,PR0

     1513    19889    3          IF CONSTANT_SIGNED THEN

  19889 26 004702   200011 234100                    SZN     CONSTANT_SIGNED,,AUTO
        26 004703   004727 605000 26                 TPL     s:19899

     1514    19890    4            DO;

     1515    19891    4              CONSTANT_LENGTH = CONSTANT_LENGTH + 1;

  19891 26 004704   200007 054100                    AOS     CONSTANT_LENGTH,,AUTO

     1516    19892    4              CONST_TEMP = CONST_SYMBOL;

  19892 26 004705   200014 470500                    LDP0    CONSTANT_SYM$,,AUTO
        26 004706   200007 720100                    LXL0    CONSTANT_LENGTH,,AUTO
        26 004707   040100 100540                    MLR     fill='040'O
        26 004710   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
        26 004711   200060 000077                    ADSC9   CONST_TEMP,,AUTO         cn=0,n=63

     1517    19893    4              SUBSTR (CONST_SYMBOL, 1, CONSTANT_LENGTH - 1) =

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:262  
  19893 26 004712   777777 621010                    EAX1    -1,X0
        26 004713   040140 100540                    MLR     fill='040'O
        26 004714   200060 000011                    ADSC9   CONST_TEMP,,AUTO         cn=0,n=*X1
        26 004715   000000 200011                    ADSC9   0,,PR0                   cn=1,n=*X1

     1518    19894    4              SUBSTR (CONST_TEMP,   0, CONSTANT_LENGTH - 1);
     1519    19895    4              SUBSTR(CONST_SYMBOL,0,1) = %MINUS_SIGN_;

  19895 26 004716   040100 100400                    MLR     fill='040'O
        26 004717   000037 000001 27                 ADSC9   31                       cn=0,n=1
        26 004720   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1520    19896    4              SYM$ -> CONST.NDSC.S    = %LEADING_SIGN;

  19896 26 004721   200012 471500                    LDP1    SYM$,,AUTO
        26 004722   100001 236100                    LDQ     1,,PR1
        26 004723   000040 376000 27                 ANQ     32
        26 004724   010000 276007                    ORQ     4096,DL
        26 004725   100001 756100                    STQ     1,,PR1

     1521    19897    4            END;

  19897 26 004726   004732 710000 26                 TRA     s:19900

     1522    19898    3          ELSE
     1523    19899    3            SYM$ -> CONST.NDSC.S    = %NO_SIGN;

  19899 26 004727   200012 470500                    LDP0    SYM$,,AUTO
        26 004730   030000 236007                    LDQ     12288,DL
        26 004731   000001 256100                    ORSQ    1,,PR0

     1524    19900    3          SYM$ -> CONST.NDSC.N    = CONSTANT_LENGTH;

  19900 26 004732   200012 470500                    LDP0    SYM$,,AUTO
        26 004733   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 004734   000001 752101                    STCQ    1,'01'O,PR0

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:263  
     1525    19901
     1526    19902    3          IF CONSTANT_LENGTH > 8 THEN

  19902 26 004735   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 004736   000010 115007                    CMPA    8,DL
        26 004737   005010 604400 26                 TMOZ    s:19997

     1527    19903    4            DO;

     1528    19904    4              ITERATION = (CONSTANT_LENGTH + 7) / 4;

  19904 26 004740   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 004741   000007 036007                    ADLQ    7,DL
        26 004742   000004 506007                    DIV     4,DL
        26 004743   000000 756000 0                  STQ     ITERATION

     1529    19905                   %RESERVE_LTS (ITEM = %LCNST, POINTER = LTSS$);

  19981 26 004744   000002 036000 2                  ADLQ    LTS_+2
        26 004745   000003 116000 2                  CMPQ    LTS_+3
        26 004746   004757 604000 26                 TMI     s:19983

  19982 26 004747   000041 236000 27                 LDQ     33
        26 004750   200152 756100                    STQ     I+1,,AUTO
        26 004751   200152 630500                    EPPR0   I+1,,AUTO
        26 004752   200153 450500                    STP0    I+2,,AUTO
        26 004753   200153 630500                    EPPR0   I+2,,AUTO
        26 004754   000006 631400 27                 EPPR1   6
        26 004755   000000 701000 xent               TSX1    Z8AR$RESERVER
        26 004756   000000 011000                    NOP     0

  19983 26 004757   000002 236000 2                  LDQ     LTS_+2
        26 004760   000022 736000                    QLS     18
        26 004761   000001 036000 2                  ADLQ    LTS_+1
        26 004762   200015 756100                    STQ     LTSS$,,AUTO

  19984 26 004763   000002 236000 2                  LDQ     LTS_+2
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:264  
        26 004764   000000 036000 0                  ADLQ    ITERATION
        26 004765   000002 756000 2                  STQ     LTS_+2

  19985 26 004766   001106 220003                    LDX0    582,DU
        26 004767   200015 470500                    LDP0    LTSS$,,AUTO
        26 004770   000000 740100                    STX0    0,,PR0

  19987 26 004771   000000 721000 0                  LXL1    ITERATION
        26 004772   000000 441100                    SXL1    0,,PR0

     1530    19991    4              CALL XLATE (SUBSTR(LTSS$ -> LCNST.CONST, 0, CONSTANT_LENGTH), EBCDIC,
             19991                       CONST_SYMBOL);

  19991 26 004773   200014 471500                    LDP1    CONSTANT_SYM$,,AUTO
        26 004774   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 004775   040140 160540                    MVT     fill='040'O
        26 004776   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
        26 004777   000001 000012                    ADSC9   1,,PR0                   cn=0,n=*X2
        26 005000   000000 000000 xsym               ARG     EBCDIC

     1531    19992    4              SYM$ -> CONST.CONST$.PTR$ = LTSS$;

  19992 26 005001   200015 236100                    LDQ     LTSS$,,AUTO
        26 005002   200012 473500                    LDP3    SYM$,,AUTO
        26 005003   300010 756100                    STQ     8,,PR3

     1532    19993    4              SYM$ -> CONST.B.LONG_CONSTANT = TRUE;

  19993 26 005004   200012 473500                    LDP3    SYM$,,AUTO
        26 005005   400000 236003                    LDQ     -131072,DU
        26 005006   300003 256100                    ORSQ    3,,PR3

     1533    19994    4            END;

  19994 26 005007   005026 710000 26                 TRA     s:20003

     1534    19995    3          ELSE
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:265  
     1535    19996    4            DO;

     1536    19997    4              CALL XLATE (SUBSTR(SYM$ -> CONST.CONSTA, 0, CONSTANT_LENGTH), EBCDIC,
             19997                       CONST_SYMBOL);

  19997 26 005010   200014 470500                    LDP0    CONSTANT_SYM$,,AUTO
        26 005011   000000 620005                    EAX0    0,AL
        26 005012   200012 471500                    LDP1    SYM$,,AUTO
        26 005013   200007 721100                    LXL1    CONSTANT_LENGTH,,AUTO
        26 005014   040140 160540                    MVT     fill='040'O
        26 005015   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
        26 005016   100010 000011                    ADSC9   8,,PR1                   cn=0,n=*X1
        26 005017   000000 000000 xsym               ARG     EBCDIC

     1537    19998    4              IF CONSTANT_LENGTH > 4 THEN

  19998 26 005020   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 005021   000004 115007                    CMPA    4,DL
        26 005022   005026 604400 26                 TMOZ    s:20003

     1538    19999    4                SYM$ -> CONST.B.TWO_WORD = TRUE;

  19999 26 005023   200012 471500                    LDP1    SYM$,,AUTO
        26 005024   200000 236003                    LDQ     65536,DU
        26 005025   100003 256100                    ORSQ    3,,PR1

     1539    20000    4            END;

     1540    20001    3        END;

     1541    20002
     1542    20003    2   END CREATE_TYF_CONSTANT;

  20003 26 005026   200110 221300                    LDX1  ! N,,AUTO
        26 005027   000001 702211                    TSX2  ! 1,X1

     1543    20004        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:266  
     1544    20005    1   CREATE_TYF_WITH_TYPE_DESC: PROC (TYPE_DESC) ;

  20005 26 005030   200106 741300       CREATE_TYF_* STX1  ! NUM_DESC+6,,AUTO

     1545    20006         /*I*  NAME: CREATE_TYF_WITH_TYPE_DESC
     1546    20007            PURPOSE: Make an EBCDIC numeric constant.
     1547    20008        */
     1548    20009
     1549    20010    2   DCL 1 TYPE_DESC        ALIGNED,
     1550    20011             %TYPE_DESC;
     1551    20045
     1552    20046    2    CALL GET_NUMERIC_CONSTANT;

  20046 26 005031   000003 701000 26                 TSX1    GET_NUMERIC_CONSTANT
        26 005032   000000 011000                    NOP     0

     1553    20047
     1554    20048    2    CALL NDSC9_OVERFLOW (TYPE_DESC);

  20048 26 005033   200107 236100                    LDQ     @TYPE_DESC,,AUTO
        26 005034   200115 756100                    STQ     @N,,AUTO
        26 005035   000757 701000 26                 TSX1    NDSC9_OVERFLOW
        26 005036   000000 011000                    NOP     0

     1555    20049
     1556    20050    2    CALL BUILD_TYF_WITH_TYPE_DESC (TYPE_DESC);

  20050 26 005037   200107 236100                    LDQ     @TYPE_DESC,,AUTO
        26 005040   200111 756100                    STQ     S,,AUTO
        26 005041   001616 701000 26                 TSX1    BUILD_TYF_WITH_TYPE_DESC
        26 005042   000000 011000                    NOP     0

     1557    20051         %ASSIGN_SYM$_THE_DNT_ST$;

  20053 26 005043   200016 236100                    LDQ     DNT$$,,AUTO
        26 005044   000001 116000 27                 CMPQ    1
        26 005045   005051 601000 26                 TNZ     s:20056
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:267  

  20054 26 005046   000001 236000 27                 LDQ     1
        26 005047   200012 756100                    STQ     SYM$,,AUTO
        26 005050   005054 710000 26                 TRA     s:20060

  20056 26 005051   200016 470500                    LDP0    DNT$$,,AUTO
        26 005052   000001 236100                    LDQ     1,,PR0
        26 005053   200012 756100                    STQ     SYM$,,AUTO

     1558    20059
     1559    20060    3    DO WHILE (SYM$ ~= ADDR(NIL));

  20060 26 005054   005100 710000 26                 TRA     s:20071

     1560    20061    3      IF SYM$ -> CONST.TYPE = %TYF THEN

  20061 26 005055   200012 470500                    LDP0    SYM$,,AUTO
        26 005056   000002 220100                    LDX0    2,,PR0
        26 005057   000013 100003                    CMPX0   11,DU
        26 005060   005076 601000 26                 TNZ     s:20070

     1561    20062    3        IF TYPE_DESC.DESC.NDSC.N = SYM$ -> CONST.NDSC.N

  20062 26 005061   200107 471500                    LDP1    @TYPE_DESC,,AUTO
        26 005062   100001 236100                    LDQ     1,,PR1
        26 005063   000001 676100                    ERQ     1,,PR0
        26 005064   000077 376007                    ANQ     63,DL
        26 005065   005076 601000 26                 TNZ     s:20070
        26 005066   100001 236100                    LDQ     1,,PR1
        26 005067   000001 676100                    ERQ     1,,PR0
        26 005070   040000 376007                    ANQ     16384,DL
        26 005071   005076 601000 26                 TNZ     s:20070
        26 005072   100001 236100                    LDQ     1,,PR1
        26 005073   000001 676100                    ERQ     1,,PR0
        26 005074   030000 376007                    ANQ     12288,DL
        26 005075   005102 600000 26                 TZE     s:20073

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:268  
     1562    20063    3        AND TYPE_DESC.DESC.NDSC.TN = SYM$ -> CONST.NDSC.TN
     1563    20064    3        AND TYPE_DESC.DESC.NDSC.S = SYM$ -> CONST.NDSC.S THEN
     1564    20065               %IF_SEGMENT_COUNT_VALID_THEN;
     1565    20068    3            EXIT; /* Identical constant found */
     1566    20069
     1567    20070    3      SYM$ = SYM$ -> CONST.NEXT;

  20070 26 005076   000004 236100                    LDQ     4,,PR0
        26 005077   200012 756100                    STQ     SYM$,,AUTO

     1568    20071    3    END;

  20071 26 005100   000001 116000 27                 CMPQ    1
        26 005101   005055 601000 26                 TNZ     s:20061

     1569    20072
     1570    20073    2    IF SYM$ = ADDR(NIL) THEN

  20073 26 005102   200012 236100                    LDQ     SYM$,,AUTO
        26 005103   000001 116000 27                 CMPQ    1
        26 005104   005230 601000 26                 TNZ     s:20185

     1571    20074    3      DO;

     1572    20075             /* Identical constant not found */
     1573    20076    3        CALL RESERVE_CONST_ITEM (%TYF, CONST$ -> LX_TERMINAL.DNT$);

  20076 26 005105   200004 470500                    LDP0    @CONST$,,AUTO
        26 005106   000000 471500                    LDP1    0,,PR0
        26 005107   100002 633500                    EPPR3   2,,PR1
        26 005110   200124 453500                    STP3    @DNT$$,,AUTO
        26 005111   000043 236000 27                 LDQ     35
        26 005112   200123 756100                    STQ     @NUM_DESC,,AUTO
        26 005113   001256 701000 26                 TSX1    RESERVE_CONST_ITEM
        26 005114   000000 011000                    NOP     0

     1574    20077    3        SYM$ -> CONST.NDSC.SF = CONSTANT_SF;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:269  

  20077 26 005115   200012 470500                    LDP0    SYM$,,AUTO
        26 005116   200010 236100                    LDQ     CONSTANT_SF,,AUTO
        26 005117   000006 736000                    QLS     6
        26 005120   000001 752102                    STCQ    1,'02'O,PR0

     1575    20078    3        SYM$ -> CONST.NDSC.TN = TYPE_DESC.DESC.NDSC.TN;

  20078 26 005121   200012 470500                    LDP0    SYM$,,AUTO
        26 005122   200107 471500                    LDP1    @TYPE_DESC,,AUTO
        26 005123   100001 236100                    LDQ     1,,PR1
        26 005124   000001 676100                    ERQ     1,,PR0
        26 005125   040000 376007                    ANQ     16384,DL
        26 005126   000001 656100                    ERSQ    1,,PR0

     1576    20079
     1577    20080    3        SYM$ -> CONST.NDSC.S = TYPE_DESC.DESC.NDSC.S;

  20080 26 005127   200012 470500                    LDP0    SYM$,,AUTO
        26 005130   100001 236100                    LDQ     1,,PR1
        26 005131   000001 676100                    ERQ     1,,PR0
        26 005132   030000 376007                    ANQ     12288,DL
        26 005133   000001 656100                    ERSQ    1,,PR0

     1578    20081
     1579    20082    3        SYM$ -> CONST.NDSC.N  = CONSTANT_LENGTH;

  20082 26 005134   200012 470500                    LDP0    SYM$,,AUTO
        26 005135   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 005136   000001 752101                    STCQ    1,'01'O,PR0

     1580    20083
     1581    20084    3          IF CONSTANT_LENGTH > 8 THEN

  20084 26 005137   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 005140   000010 115007                    CMPA    8,DL
        26 005141   005212 604400 26                 TMOZ    s:20179
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:270  

     1582    20085    4            DO;

     1583    20086    4              ITERATION = (CONSTANT_LENGTH + 7) / 4;

  20086 26 005142   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 005143   000007 036007                    ADLQ    7,DL
        26 005144   000004 506007                    DIV     4,DL
        26 005145   000000 756000 0                  STQ     ITERATION

     1584    20087                   %RESERVE_LTS (ITEM = %LCNST, POINTER = LTSS$);

  20163 26 005146   000002 036000 2                  ADLQ    LTS_+2
        26 005147   000003 116000 2                  CMPQ    LTS_+3
        26 005150   005161 604000 26                 TMI     s:20165

  20164 26 005151   000041 236000 27                 LDQ     33
        26 005152   200152 756100                    STQ     I+1,,AUTO
        26 005153   200152 630500                    EPPR0   I+1,,AUTO
        26 005154   200153 450500                    STP0    I+2,,AUTO
        26 005155   200153 630500                    EPPR0   I+2,,AUTO
        26 005156   000006 631400 27                 EPPR1   6
        26 005157   000000 701000 xent               TSX1    Z8AR$RESERVER
        26 005160   000000 011000                    NOP     0

  20165 26 005161   000002 236000 2                  LDQ     LTS_+2
        26 005162   000022 736000                    QLS     18
        26 005163   000001 036000 2                  ADLQ    LTS_+1
        26 005164   200015 756100                    STQ     LTSS$,,AUTO

  20166 26 005165   000002 236000 2                  LDQ     LTS_+2
        26 005166   000000 036000 0                  ADLQ    ITERATION
        26 005167   000002 756000 2                  STQ     LTS_+2

  20167 26 005170   001106 220003                    LDX0    582,DU
        26 005171   200015 470500                    LDP0    LTSS$,,AUTO
        26 005172   000000 740100                    STX0    0,,PR0
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:271  

  20169 26 005173   000000 721000 0                  LXL1    ITERATION
        26 005174   000000 441100                    SXL1    0,,PR0

     1585    20173    4              CALL XLATE (SUBSTR(LTSS$ -> LCNST.CONST, 0, CONSTANT_LENGTH), EBCDIC,
             20173                       CONST_SYMBOL);

  20173 26 005175   200014 471500                    LDP1    CONSTANT_SYM$,,AUTO
        26 005176   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 005177   040140 160540                    MVT     fill='040'O
        26 005200   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
        26 005201   000001 000012                    ADSC9   1,,PR0                   cn=0,n=*X2
        26 005202   000000 000000 xsym               ARG     EBCDIC

     1586    20174    4              SYM$ -> CONST.CONST$.PTR$ = LTSS$;

  20174 26 005203   200015 236100                    LDQ     LTSS$,,AUTO
        26 005204   200012 473500                    LDP3    SYM$,,AUTO
        26 005205   300010 756100                    STQ     8,,PR3

     1587    20175    4              SYM$ -> CONST.B.LONG_CONSTANT = TRUE;

  20175 26 005206   200012 473500                    LDP3    SYM$,,AUTO
        26 005207   400000 236003                    LDQ     -131072,DU
        26 005210   300003 256100                    ORSQ    3,,PR3

     1588    20176    4            END;

  20176 26 005211   005230 710000 26                 TRA     s:20185

     1589    20177    3          ELSE
     1590    20178    4            DO;

     1591    20179    4              CALL XLATE (SUBSTR(SYM$ -> CONST.CONSTA, 0, CONSTANT_LENGTH), EBCDIC,
             20179                       CONST_SYMBOL);

  20179 26 005212   200014 470500                    LDP0    CONSTANT_SYM$,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:272  
        26 005213   000000 620005                    EAX0    0,AL
        26 005214   200012 473500                    LDP3    SYM$,,AUTO
        26 005215   200007 721100                    LXL1    CONSTANT_LENGTH,,AUTO
        26 005216   040140 160540                    MVT     fill='040'O
        26 005217   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
        26 005220   300010 000011                    ADSC9   8,,PR3                   cn=0,n=*X1
        26 005221   000000 000000 xsym               ARG     EBCDIC

     1592    20180    4              IF CONSTANT_LENGTH > 4 THEN

  20180 26 005222   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 005223   000004 115007                    CMPA    4,DL
        26 005224   005230 604400 26                 TMOZ    s:20185

     1593    20181    4                SYM$ -> CONST.B.TWO_WORD = TRUE;

  20181 26 005225   200012 473500                    LDP3    SYM$,,AUTO
        26 005226   200000 236003                    LDQ     65536,DU
        26 005227   300003 256100                    ORSQ    3,,PR3

     1594    20182    4            END;

     1595    20183    3      END;

     1596    20184
     1597    20185    2   END CREATE_TYF_WITH_TYPE_DESC;

  20185 26 005230   200106 221300                    LDX1  ! NUM_DESC+6,,AUTO
        26 005231   000001 702211                    TSX2  ! 1,X1

     1598    20186        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:273  
     1599    20187    1   CREATE_TYA_CONSTANT: PROC ;

  20187 26 005232   200114 741300       CREATE_TYA_* STX1  ! OVERPUNCH_SIGN,,AUTO

     1600    20188
     1601    20189    2      DCL  CONSTANT_TYPE  UBIN WORD ;
     1602    20190
     1603    20191           %CHECK_FOR_SYMBOLIC_CHARACTER;

  20193 26 005233   200004 470500                    LDP0    @CONST$,,AUTO
        26 005234   000000 471500                    LDP1    0,,PR0
        26 005235   100003 235100                    LDA     3,,PR1
        26 005236   000003 115007                    CMPA    3,DL
        26 005237   005257 601000 26                 TNZ     s:20205
        26 005240   200016 473500                    LDP3    DNT$$,,AUTO
        26 005241   300001 236100                    LDQ     1,,PR3
        26 005242   000001 116000 27                 CMPQ    1
        26 005243   005257 600000 26                 TZE     s:20205

  20195 26 005244   300001 474500                    LDP4    1,,PR3
        26 005245   400000 220100                    LDX0    0,,PR4
        26 005246   001001 100003                    CMPX0   513,DU
        26 005247   005257 601000 26                 TNZ     s:20205

  20197 26 005250   400005 236100                    LDQ     5,,PR4
        26 005251   200012 756100                    STQ     SYM$,,AUTO

  20198 26 005252   000001 235007                    LDA     1,DL
        26 005253   200007 755100                    STA     CONSTANT_LENGTH,,AUTO

  20199 26 005254   000010 036003                    ADLQ    8,DU
        26 005255   200014 756100                    STQ     CONSTANT_SYM$,,AUTO

  20200 26 005256   000001 702211                    TSX2  ! 1,X1

     1604    20204
     1605    20205    2      CALL CREATE_ALPHA_OR_FIG_CONST;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:274  

  20205 26 005257   000112 701000 26                 TSX1    CREATE_ALPHA_OR_FIG_CONST
        26 005260   000000 011000                    NOP     0

     1606    20206
     1607    20207    2      IF SYM$ ~= ADDR(NIL) THEN

  20207 26 005261   200012 236100                    LDQ     SYM$,,AUTO
        26 005262   000001 116000 27                 CMPQ    1
        26 005263   005266 600000 26                 TZE     s:20210

     1608    20208    2        RETURN;

  20208 26 005264   200114 221300                    LDX1  ! OVERPUNCH_SIGN,,AUTO
        26 005265   000001 702211                    TSX2  ! 1,X1

     1609    20209
     1610    20210    2      SYM$ = DNT$$ -> DNT.ST$;

  20210 26 005266   200016 470500                    LDP0    DNT$$,,AUTO
        26 005267   000001 236100                    LDQ     1,,PR0
        26 005270   200012 756100                    STQ     SYM$,,AUTO

     1611    20211
     1612    20212    3      DO WHILE (SYM$ ~= ADDR(NIL));

  20212 26 005271   005310 710000 26                 TRA     s:20222

     1613    20213    3        IF SYM$ -> CONST.TYPE = %TYA

  20213 26 005272   200012 470500                    LDP0    SYM$,,AUTO
        26 005273   000002 220100                    LDX0    2,,PR0
        26 005274   000010 100003                    CMPX0   8,DU
        26 005275   005300 600000 26                 TZE     s:20215
        26 005276   000016 100003                    CMPX0   14,DU
        26 005277   005306 601000 26                 TNZ     s:20221

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:275  
     1614    20214    3        OR SYM$ -> CONST.TYPE = %TYN THEN
     1615    20215    3          IF SYM$ -> CONST.B.ALL = CONST$ -> LX_TERMINAL.B.ALL THEN

  20215 26 005300   200004 471500                    LDP1    @CONST$,,AUTO
        26 005301   100000 473500                    LDP3    0,,PR1
        26 005302   000100 066500                    CMPB    filb='0'B
        26 005303   000003 030001                    BDSC    3,,PR0                   by=0,bit=3,n=1
        26 005304   300000 430001                    BDSC    0,,PR3                   by=2,bit=3,n=1
        26 005305   005312 600000 26                 TZE     s:20224

     1616    20216                 %IF_SEGMENT_COUNT_VALID_THEN;
     1617    20219    3            EXIT;
     1618    20220
     1619    20221    3        SYM$ = SYM$ -> CONST.NEXT;

  20221 26 005306   000004 236100                    LDQ     4,,PR0
        26 005307   200012 756100                    STQ     SYM$,,AUTO

     1620    20222    3      END;

  20222 26 005310   000001 116000 27                 CMPQ    1
        26 005311   005272 601000 26                 TNZ     s:20213

     1621    20223
     1622    20224    2      IF SYM$ = ADDR(NIL) THEN

  20224 26 005312   200012 236100                    LDQ     SYM$,,AUTO
        26 005313   000001 116000 27                 CMPQ    1
        26 005314   005543 601000 26                 TNZ     s:20399

     1623    20225    3        DO;

     1624    20226    3          IF CONST$ -> LX_TERMINAL.TYPE = %TYN THEN

  20226 26 005315   200004 470500                    LDP0    @CONST$,,AUTO
        26 005316   000000 471500                    LDP1    0,,PR0
        26 005317   100004 235100                    LDA     4,,PR1
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:276  
        26 005320   000016 115007                    CMPA    14,DL
        26 005321   005325 601000 26                 TNZ     s:20229

     1625    20227    3            CONSTANT_TYPE = %TYN ;

  20227 26 005322   000016 235007                    LDA     14,DL
        26 005323   200115 755100                    STA     CONSTANT_TYPE,,AUTO
        26 005324   005327 710000 26                 TRA     s:20238

     1626    20228    3          ELSE
     1627    20229    3            CONSTANT_TYPE = %TYA ;

  20229 26 005325   000010 235007                    LDA     8,DL
        26 005326   200115 755100                    STA     CONSTANT_TYPE,,AUTO

     1628    20230
     1629    20231               %NEW_CONST (@ST$     = SYM$,
     1630    20232                           @TYPE    = CONSTANT_TYPE,
     1631    20233                           @DNT$    = CONST$ -> LX_ITEM.DNT$,
     1632    20234                           @NEXT    = CONST$ -> LX_TERMINAL.DNT$ -> DNT.ST$);

  20238 26 005327   000002 236000 4                  LDQ     ST_+2
        26 005330   000013 036007                    ADLQ    11,DL
        26 005331   000003 116000 4                  CMPQ    ST_+3
        26 005332   005343 604000 26                 TMI     s:20240

  20239 26 005333   000022 236000 27                 LDQ     18
        26 005334   200152 756100                    STQ     I+1,,AUTO
        26 005335   200152 631500                    EPPR1   I+1,,AUTO
        26 005336   200153 451500                    STP1    I+2,,AUTO
        26 005337   200153 630500                    EPPR0   I+2,,AUTO
        26 005340   000006 631400 27                 EPPR1   6
        26 005341   000000 701000 xent               TSX1    Z8AR$RESERVER
        26 005342   000000 011000                    NOP     0

  20240 26 005343   000002 236000 4                  LDQ     ST_+2
        26 005344   000022 736000                    QLS     18
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:277  
        26 005345   000001 036000 4                  ADLQ    ST_+1
        26 005346   200012 756100                    STQ     SYM$,,AUTO

  20241 26 005347   000013 236007                    LDQ     11,DL
        26 005350   000002 056000 4                  ASQ     ST_+2

  20244 26 005351   000767 220003                    LDX0    503,DU
        26 005352   200012 470500                    LDP0    SYM$,,AUTO
        26 005353   000000 740100                    STX0    0,,PR0

  20245 26 005354   200012 470500                    LDP0    SYM$,,AUTO
        26 005355   001000 236007                    LDQ     512,DL
        26 005356   000000 552110                    STBQ    0,'10'O,PR0

  20246 26 005357   200012 470500                    LDP0    SYM$,,AUTO
        26 005360   000126 236000 xsym               LDQ     O1COM+86
        26 005361   000000 552104                    STBQ    0,'04'O,PR0

  20247 26 005362   200115 721100                    LXL1    CONSTANT_TYPE,,AUTO
        26 005363   200012 470500                    LDP0    SYM$,,AUTO
        26 005364   000002 741100                    STX1    2,,PR0

  20248 26 005365   200012 470500                    LDP0    SYM$,,AUTO
        26 005366   000003 450100                    STZ     3,,PR0

  20249 26 005367   200004 470500                    LDP0    @CONST$,,AUTO
        26 005370   000000 471500                    LDP1    0,,PR0
        26 005371   100002 473500                    LDP3    2,,PR1
        26 005372   300001 236100                    LDQ     1,,PR3
        26 005373   200012 474500                    LDP4    SYM$,,AUTO
        26 005374   400004 756100                    STQ     4,,PR4

  20250 26 005375   000001 236000 27                 LDQ     1
        26 005376   200012 471500                    LDP1    SYM$,,AUTO
        26 005377   100005 756100                    STQ     5,,PR1

  20251 26 005400   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:278  
        26 005401   100002 236100                    LDQ     2,,PR1
        26 005402   200012 473500                    LDP3    SYM$,,AUTO
        26 005403   300006 756100                    STQ     6,,PR3

     1633    20275
     1634    20276    3        IF CONST$ -> LX_ITEM.B.ALL THEN

  20276 26 005404   000000 471500                    LDP1    0,,PR0
        26 005405   100000 236100                    LDQ     0,,PR1
        26 005406   040000 316007                    CANQ    16384,DL
        26 005407   005414 600000 26                 TZE     s:20279

     1635    20277    3          SYM$ -> CONST.B.ALL = TRUE;

  20277 26 005410   200012 473500                    LDP3    SYM$,,AUTO
        26 005411   040000 236003                    LDQ     16384,DU
        26 005412   300003 256100                    ORSQ    3,,PR3
        26 005413   005443 710000 26                 TRA     s:20289

     1636    20278    3        ELSE
     1637    20279    4          DO SELECT(CONST$ -> LX_TERMINAL.SYMBOL);

  20279 26 005414   100003 236100                    LDQ     3,,PR1
        26 005415   000433 116007                    CMPQ    283,DL
        26 005416   005431 604000 26                 TMI     s:20279+13
        26 005417   005434 600000 26                 TZE     s:20283
        26 005420   000650 116007                    CMPQ    424,DL
        26 005421   005426 604000 26                 TMI     s:20279+10
        26 005422   005434 600000 26                 TZE     s:20283
        26 005423   000761 116007                    CMPQ    497,DL
        26 005424   005440 601000 26                 TNZ     s:20286
        26 005425   005434 710000 26                 TRA     s:20283
        26 005426   000543 116007                    CMPQ    355,DL
        26 005427   005440 601000 26                 TNZ     s:20286
        26 005430   005434 710000 26                 TRA     s:20283
        26 005431   000351 116007                    CMPQ    233,DL
        26 005432   005440 601000 26                 TNZ     s:20286
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:279  
        26 005433   005434 710000 26                 TRA     s:20283

     1638    20280    4            SELECT(%RSV_WRD_HIGH_VALUES, %RSV_WRD_LOW_VALUES,

     1639    20281    4                 %RSV_WRD_QUOTES,      %RSV_WRD_SPACES,
     1640    20282    4                 %RSV_WRD_ZEROES);
     1641    20283    4              SYM$ -> CONST.B.ALL = TRUE;

  20283 26 005434   200012 473500                    LDP3    SYM$,,AUTO
        26 005435   040000 236003                    LDQ     16384,DU
        26 005436   300003 256100                    ORSQ    3,,PR3
        26 005437   005443 710000 26                 TRA     s:20289

     1642    20284
     1643    20285    4            SELECT(ELSE);

     1644    20286    4              SYM$ -> CONST.B.ALL = FALSE;

  20286 26 005440   200012 473500                    LDP3    SYM$,,AUTO
        26 005441   000072 236000 27                 LDQ     58
        26 005442   300003 356100                    ANSQ    3,,PR3

     1645    20287    4          END;

     1646    20288
     1647    20289    3          SYM$ -> CONST.ADSC.N = CONSTANT_LENGTH;

  20289 26 005443   200012 471500                    LDP1    SYM$,,AUTO
        26 005444   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 005445   100001 752103                    STCQ    1,'03'O,PR1

     1648    20290    3          NEW_ST = TRUE;

  20290 26 005446   400000 236003                    LDQ     -131072,DU
        26 005447   200040 756100                    STQ     NEW_ST,,AUTO

     1649    20291
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:280  
     1650    20292    3          IF CONSTANT_LENGTH > 8 THEN

  20292 26 005450   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 005451   000010 115007                    CMPA    8,DL
        26 005452   005523 604400 26                 TMOZ    s:20389

     1651    20293                 %ENTER_9BIT_CONSTANT_GTR_8_DIGITS;

  20295 26 005453   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 005454   000003 036007                    ADLQ    3,DL
        26 005455   000004 506007                    DIV     4,DL
        26 005456   000001 036007                    ADLQ    1,DL
        26 005457   000000 756000 0                  STQ     ITERATION

  20372 26 005460   000002 036000 2                  ADLQ    LTS_+2
        26 005461   000003 116000 2                  CMPQ    LTS_+3
        26 005462   005473 604000 26                 TMI     s:20374

  20373 26 005463   000041 236000 27                 LDQ     33
        26 005464   200152 756100                    STQ     I+1,,AUTO
        26 005465   200152 631500                    EPPR1   I+1,,AUTO
        26 005466   200153 451500                    STP1    I+2,,AUTO
        26 005467   200153 630500                    EPPR0   I+2,,AUTO
        26 005470   000006 631400 27                 EPPR1   6
        26 005471   000000 701000 xent               TSX1    Z8AR$RESERVER
        26 005472   000000 011000                    NOP     0

  20374 26 005473   000002 236000 2                  LDQ     LTS_+2
        26 005474   000022 736000                    QLS     18
        26 005475   000001 036000 2                  ADLQ    LTS_+1
        26 005476   200015 756100                    STQ     LTSS$,,AUTO

  20375 26 005477   000002 236000 2                  LDQ     LTS_+2
        26 005500   000000 036000 0                  ADLQ    ITERATION
        26 005501   000002 756000 2                  STQ     LTS_+2

  20376 26 005502   001106 220003                    LDX0    582,DU
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:281  
        26 005503   200015 470500                    LDP0    LTSS$,,AUTO
        26 005504   000000 740100                    STX0    0,,PR0

  20378 26 005505   000000 721000 0                  LXL1    ITERATION
        26 005506   000000 441100                    SXL1    0,,PR0

  20382 26 005507   200014 471500                    LDP1    CONSTANT_SYM$,,AUTO
        26 005510   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 005511   040140 100540                    MLR     fill='040'O
        26 005512   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
        26 005513   000001 000012                    ADSC9   1,,PR0                   cn=0,n=*X2

  20383 26 005514   200015 236100                    LDQ     LTSS$,,AUTO
        26 005515   200012 473500                    LDP3    SYM$,,AUTO
        26 005516   300010 756100                    STQ     8,,PR3

  20384 26 005517   200012 473500                    LDP3    SYM$,,AUTO
        26 005520   400000 236003                    LDQ     -131072,DU
        26 005521   300003 256100                    ORSQ    3,,PR3

  20385 26 005522   005543 710000 26                 TRA     s:20399

     1652    20387    3          ELSE
     1653    20388    4            DO;

     1654    20389    4              SUBSTR (SYM$ -> CONST.CONSTA, 0, CONSTANT_LENGTH) = CONST_SYMBOL;

  20389 26 005523   200014 471500                    LDP1    CONSTANT_SYM$,,AUTO
        26 005524   000000 622005                    EAX2    0,AL
        26 005525   200012 473500                    LDP3    SYM$,,AUTO
        26 005526   200007 723100                    LXL3    CONSTANT_LENGTH,,AUTO
        26 005527   040140 100540                    MLR     fill='040'O
        26 005530   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
        26 005531   300010 000013                    ADSC9   8,,PR3                   cn=0,n=*X3

     1655    20390
     1656    20391    4              IF CONSTANT_LENGTH > 4 THEN
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:282  

  20391 26 005532   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 005533   000004 115007                    CMPA    4,DL
        26 005534   005543 604400 26                 TMOZ    s:20399

     1657    20392    5                DO;

     1658    20393    5                  SYM$ -> CONST.B.TWO_WORD = TRUE;

  20393 26 005535   200012 473500                    LDP3    SYM$,,AUTO
        26 005536   200000 236003                    LDQ     65536,DU
        26 005537   300003 256100                    ORSQ    3,,PR3

     1659    20394    5                  SYM$ -> CONST.B.MOD_2    = TRUE;

  20394 26 005540   200012 473500                    LDP3    SYM$,,AUTO
        26 005541   100000 236003                    LDQ     32768,DU
        26 005542   300003 256100                    ORSQ    3,,PR3

     1660    20395    5                END;

     1661    20396    4            END;

     1662    20397
     1663    20398    3        END;

     1664    20399    2   END CREATE_TYA_CONSTANT;

  20399 26 005543   200114 221300                    LDX1  ! OVERPUNCH_SIGN,,AUTO
        26 005544   000001 702211                    TSX2  ! 1,X1

     1665    20400        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:283  
     1666    20401    1   CREATE_TYE_CONSTANT: PROC ;

  20401 26 005545   200110 741300       CREATE_TYE_* STX1  ! N,,AUTO

     1667    20402        /*I*  NAME: CREATE_TYE_CONSTANT
     1668    20403           PURPOSE: Make an EBCDIC alphanumeric constant.
     1669    20404        */
     1670    20405
     1671    20406    2      DCL  TYE_SYM$ PTR;
     1672    20407    2      DCL  TYA_CONST$ PTR;
     1673    20408
     1674    20409    2      SYM$ = DNT$$ -> DNT.ST$;

  20409 26 005546   200016 470500                    LDP0    DNT$$,,AUTO
        26 005547   000001 236100                    LDQ     1,,PR0
        26 005550   200012 756100                    STQ     SYM$,,AUTO

     1675    20410    2      CHAR_POS = 0;

  20410 26 005551   200044 450100                    STZ     CHAR_POS,,AUTO

     1676    20411           %TYE_SRCH;

  20412 26 005552   005574 710000 26                 TRA     s:20421

  20413 26 005553   200012 470500                    LDP0    SYM$,,AUTO
        26 005554   000002 220100                    LDX0    2,,PR0
        26 005555   000006 100003                    CMPX0   6,DU
        26 005556   005572 601000 26                 TNZ     s:20420

  20414 26 005557   200004 471500                    LDP1    @CONST$,,AUTO
        26 005560   100000 473500                    LDP3    0,,PR1
        26 005561   000100 066500                    CMPB    filb='0'B
        26 005562   000003 030001                    BDSC    3,,PR0                   by=0,bit=3,n=1
        26 005563   300000 430001                    BDSC    0,,PR3                   by=2,bit=3,n=1
        26 005564   005572 601000 26                 TNZ     s:20420

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:284  
  20415 26 005565   000001 236100                    LDQ     1,,PR0
        26 005566   000020 772000                    QRL     16
        26 005567   000003 376007                    ANQ     3,DL
        26 005570   200044 116100                    CMPQ    CHAR_POS,,AUTO
        26 005571   005576 600000 26                 TZE     s:20423

  20420 26 005572   000004 236100                    LDQ     4,,PR0
        26 005573   200012 756100                    STQ     SYM$,,AUTO

  20421 26 005574   000001 116000 27                 CMPQ    1
        26 005575   005553 601000 26                 TNZ     s:20413

     1677    20423    2      IF SYM$ = ADDR(NIL) THEN

  20423 26 005576   200012 236100                    LDQ     SYM$,,AUTO
        26 005577   000001 116000 27                 CMPQ    1
        26 005600   005765 601000 26                 TNZ     s:20587

     1678    20424    3        DO;

     1679    20425    3          CALL CREATE_TYA_CONSTANT;

  20425 26 005601   005232 701000 26                 TSX1    CREATE_TYA_CONSTANT
        26 005602   000000 011000                    NOP     0

     1680    20426               %NEW_CONST (@ST$     = TYE_SYM$,
     1681    20427                           @TYPE    = %TYE,
     1682    20428                           @ALL     = SYM$ -> CONST.B.ALL,
     1683    20429                           @DNT$    = CONST$ -> LX_ITEM.DNT$,
     1684    20430                           @NEXT    = CONST$ -> LX_TERMINAL.DNT$ -> DNT.ST$);

  20434 26 005603   000002 236000 4                  LDQ     ST_+2
        26 005604   000013 036007                    ADLQ    11,DL
        26 005605   000003 116000 4                  CMPQ    ST_+3
        26 005606   005617 604000 26                 TMI     s:20436

  20435 26 005607   000022 236000 27                 LDQ     18
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:285  
        26 005610   200152 756100                    STQ     I+1,,AUTO
        26 005611   200152 630500                    EPPR0   I+1,,AUTO
        26 005612   200153 450500                    STP0    I+2,,AUTO
        26 005613   200153 630500                    EPPR0   I+2,,AUTO
        26 005614   000006 631400 27                 EPPR1   6
        26 005615   000000 701000 xent               TSX1    Z8AR$RESERVER
        26 005616   000000 011000                    NOP     0

  20436 26 005617   000002 236000 4                  LDQ     ST_+2
        26 005620   000022 736000                    QLS     18
        26 005621   000001 036000 4                  ADLQ    ST_+1
        26 005622   200111 756100                    STQ     TYE_SYM$,,AUTO

  20437 26 005623   000013 236007                    LDQ     11,DL
        26 005624   000002 056000 4                  ASQ     ST_+2

  20440 26 005625   000767 220003                    LDX0    503,DU
        26 005626   200111 470500                    LDP0    TYE_SYM$,,AUTO
        26 005627   000000 740100                    STX0    0,,PR0

  20441 26 005630   001000 236007                    LDQ     512,DL
        26 005631   000000 552110                    STBQ    0,'10'O,PR0

  20442 26 005632   000126 236000 xsym               LDQ     O1COM+86
        26 005633   000000 552104                    STBQ    0,'04'O,PR0

  20443 26 005634   000006 221003                    LDX1    6,DU
        26 005635   000002 741100                    STX1    2,,PR0

  20444 26 005636   000003 450100                    STZ     3,,PR0

  20445 26 005637   200004 471500                    LDP1    @CONST$,,AUTO
        26 005640   100000 473500                    LDP3    0,,PR1
        26 005641   300002 474500                    LDP4    2,,PR3
        26 005642   400001 236100                    LDQ     1,,PR4
        26 005643   000004 756100                    STQ     4,,PR0

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:286  
  20446 26 005644   000001 236000 27                 LDQ     1
        26 005645   000005 756100                    STQ     5,,PR0

  20447 26 005646   100000 473500                    LDP3    0,,PR1
        26 005647   300002 236100                    LDQ     2,,PR3
        26 005650   000006 756100                    STQ     6,,PR0

  20458 26 005651   200012 473500                    LDP3    SYM$,,AUTO
        26 005652   300003 236100                    LDQ     3,,PR3
        26 005653   000003 676100                    ERQ     3,,PR0
        26 005654   040000 376003                    ANQ     16384,DU
        26 005655   000003 656100                    ERSQ    3,,PR0

     1685    20471    3          TYE_SYM$ -> CONST.ADSC.N = CONSTANT_LENGTH;

  20471 26 005656   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 005657   000001 752103                    STCQ    1,'03'O,PR0

     1686    20472    3          NEW_ST = TRUE;

  20472 26 005660   400000 236003                    LDQ     -131072,DU
        26 005661   200040 756100                    STQ     NEW_ST,,AUTO

     1687    20473               %GET_CONSTANT_ADDRESS (@CONSTANT = SYM$,
     1688    20474                                      @STRING   = TYA_CONST$);

  20476 26 005662   200012 473500                    LDP3    SYM$,,AUTO
        26 005663   300003 234100                    SZN     3,,PR3
        26 005664   005671 605000 26                 TPL     s:20479

  20477 26 005665   300010 474500                    LDP4    8,,PR3
        26 005666   400001 635500                    EPPR5   1,,PR4
        26 005667   200112 455500                    STP5    TYA_CONST$,,AUTO
        26 005670   005674 710000 26                 TRA     s:20482

  20479 26 005671   200012 236100                    LDQ     SYM$,,AUTO
        26 005672   000010 036003                    ADLQ    8,DU
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:287  
        26 005673   200112 756100                    STQ     TYA_CONST$,,AUTO

     1689    20482    3          IF CONSTANT_LENGTH <= 8 THEN

  20482 26 005674   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 005675   000010 115007                    CMPA    8,DL
        26 005676   005715 605400 26                 TPNZ    s:20493

     1690    20483    4            DO;

     1691    20484    4             CALL XLATE (TYE_SYM$ -> CONST.CONSTA, EBCDIC, TYA_CONST$ -> CONST_SYMBOL)
             20484                       ;

  20484 26 005677   200112 474500                    LDP4    TYA_CONST$,,AUTO
        26 005700   000000 622005                    EAX2    0,AL
        26 005701   040100 160540                    MVT     fill='040'O
        26 005702   400000 000012                    ADSC9   0,,PR4                   cn=0,n=*X2
        26 005703   000010 000010                    ADSC9   8,,PR0                   cn=0,n=8
        26 005704   000000 000000 xsym               ARG     EBCDIC

     1692    20485    4              IF CONSTANT_LENGTH > 4 THEN

  20485 26 005705   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 005706   000004 115007                    CMPA    4,DL
        26 005707   005763 604400 26                 TMOZ    s:20585

     1693    20486    5                DO;

     1694    20487    5                  TYE_SYM$ -> CONST.B.TWO_WORD = TRUE;

  20487 26 005710   200000 236003                    LDQ     65536,DU
        26 005711   000003 256100                    ORSQ    3,,PR0

     1695    20488    5                  TYE_SYM$ -> CONST.B.MOD_2 = TRUE;

  20488 26 005712   100000 236003                    LDQ     32768,DU
        26 005713   000003 256100                    ORSQ    3,,PR0
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:288  

     1696    20489    5                END;

     1697    20490    4            END;

  20490 26 005714   005763 710000 26                 TRA     s:20585

     1698    20491    3          ELSE
     1699    20492    4            DO;

     1700    20493    4              ITERATION = (CONSTANT_LENGTH + 7) / 4;

  20493 26 005715   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 005716   000007 036007                    ADLQ    7,DL
        26 005717   000004 506007                    DIV     4,DL
        26 005720   000000 756000 0                  STQ     ITERATION

     1701    20494                   %RESERVE_LTS (ITEM=%LCNST, POINTER=LTSS$);

  20570 26 005721   000002 036000 2                  ADLQ    LTS_+2
        26 005722   000003 116000 2                  CMPQ    LTS_+3
        26 005723   005734 604000 26                 TMI     s:20572

  20571 26 005724   000041 236000 27                 LDQ     33
        26 005725   200152 756100                    STQ     I+1,,AUTO
        26 005726   200152 634500                    EPPR4   I+1,,AUTO
        26 005727   200153 454500                    STP4    I+2,,AUTO
        26 005730   200153 630500                    EPPR0   I+2,,AUTO
        26 005731   000006 631400 27                 EPPR1   6
        26 005732   000000 701000 xent               TSX1    Z8AR$RESERVER
        26 005733   000000 011000                    NOP     0

  20572 26 005734   000002 236000 2                  LDQ     LTS_+2
        26 005735   000022 736000                    QLS     18
        26 005736   000001 036000 2                  ADLQ    LTS_+1
        26 005737   200015 756100                    STQ     LTSS$,,AUTO

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:289  
  20573 26 005740   000002 236000 2                  LDQ     LTS_+2
        26 005741   000000 036000 0                  ADLQ    ITERATION
        26 005742   000002 756000 2                  STQ     LTS_+2

  20574 26 005743   001106 220003                    LDX0    582,DU
        26 005744   200015 470500                    LDP0    LTSS$,,AUTO
        26 005745   000000 740100                    STX0    0,,PR0

  20576 26 005746   000000 721000 0                  LXL1    ITERATION
        26 005747   000000 441100                    SXL1    0,,PR0

     1702    20580    4              CALL XLATE (SUBSTR (LTSS$ -> LCNST.CONST, 0, CONSTANT_LENGTH),

  20580 26 005750   200112 471500                    LDP1    TYA_CONST$,,AUTO
        26 005751   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 005752   040140 160540                    MVT     fill='040'O
        26 005753   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
        26 005754   000001 000012                    ADSC9   1,,PR0                   cn=0,n=*X2
        26 005755   000000 000000 xsym               ARG     EBCDIC

     1703    20581    4                          EBCDIC, TYA_CONST$ -> CONST_SYMBOL);
     1704    20582    4              TYE_SYM$ -> CONST.CONST$.PTR$ = LTSS$;

  20582 26 005756   200015 236100                    LDQ     LTSS$,,AUTO
        26 005757   200111 473500                    LDP3    TYE_SYM$,,AUTO
        26 005760   300010 756100                    STQ     8,,PR3

     1705    20583    4              TYE_SYM$ -> CONST.B.LONG_CONSTANT = TRUE;

  20583 26 005761   400000 236003                    LDQ     -131072,DU
        26 005762   300003 256100                    ORSQ    3,,PR3

     1706    20584    4            END;

     1707    20585    3          SYM$ = TYE_SYM$;

  20585 26 005763   200111 236100                    LDQ     TYE_SYM$,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:290  
        26 005764   200012 756100                    STQ     SYM$,,AUTO

     1708    20586    3        END;

     1709    20587    2   END CREATE_TYE_CONSTANT;

  20587 26 005765   200110 221300                    LDX1  ! N,,AUTO
        26 005766   000001 702211                    TSX2  ! 1,X1

     1710    20588        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:291  
     1711    20589    1   CREATE_TYB_CONSTANT: PROC ;

  20589 26 005767   200110 741300       CREATE_TYB_* STX1  ! N,,AUTO

     1712    20590        /*I*  NAME: CREATE_TYB_CONSTANT
     1713    20591           PURPOSE: Make a GBCD constant.
     1714    20592        */
     1715    20593
     1716    20594    2      DCL  TYB_SYM$ PTR;
     1717    20595    2      DCL 1 BCD_LCNST ALIGNED BASED (LTSS$),
     1718    20596    2            2 * BIT (36),
     1719    20597    2            2 BCD_CONST BIT (CONST_BITS);
     1720    20598    2      DCL  CONST_BITS UBIN;
     1721    20599    2      DCL  TYA_CONST$ PTR;
     1722    20600
     1723    20601    2      SYM$ = DNT$$ -> DNT.ST$;

  20601 26 005770   200016 470500                    LDP0    DNT$$,,AUTO
        26 005771   000001 236100                    LDQ     1,,PR0
        26 005772   200012 756100                    STQ     SYM$,,AUTO

     1724    20602    2      CHAR_POS = 0;

  20602 26 005773   200044 450100                    STZ     CHAR_POS,,AUTO

     1725    20603           %TYB_SRCH;

  20604 26 005774   006016 710000 26                 TRA     s:20613

  20605 26 005775   200012 470500                    LDP0    SYM$,,AUTO
        26 005776   000002 220100                    LDX0    2,,PR0
        26 005777   000014 100003                    CMPX0   12,DU
        26 006000   006014 601000 26                 TNZ     s:20612

  20606 26 006001   200004 471500                    LDP1    @CONST$,,AUTO
        26 006002   100000 473500                    LDP3    0,,PR1
        26 006003   000100 066500                    CMPB    filb='0'B
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:292  
        26 006004   000003 030001                    BDSC    3,,PR0                   by=0,bit=3,n=1
        26 006005   300000 430001                    BDSC    0,,PR3                   by=2,bit=3,n=1
        26 006006   006014 601000 26                 TNZ     s:20612

  20607 26 006007   000001 236100                    LDQ     1,,PR0
        26 006010   000020 772000                    QRL     16
        26 006011   000003 376007                    ANQ     3,DL
        26 006012   200044 116100                    CMPQ    CHAR_POS,,AUTO
        26 006013   006020 600000 26                 TZE     s:20615

  20612 26 006014   000004 236100                    LDQ     4,,PR0
        26 006015   200012 756100                    STQ     SYM$,,AUTO

  20613 26 006016   000001 116000 27                 CMPQ    1
        26 006017   005775 601000 26                 TNZ     s:20605

     1726    20615    2      IF SYM$ = ADDR (NIL) THEN

  20615 26 006020   200012 236100                    LDQ     SYM$,,AUTO
        26 006021   000001 116000 27                 CMPQ    1
        26 006022   006220 601000 26                 TNZ     s:20779

     1727    20616    3        DO;

     1728    20617    3          CALL CREATE_TYA_CONSTANT;

  20617 26 006023   005232 701000 26                 TSX1    CREATE_TYA_CONSTANT
        26 006024   000000 011000                    NOP     0

     1729    20618               %NEW_CONST (@ST$     = TYB_SYM$,
     1730    20619                           @TYPE    = %TYB,
     1731    20620                           @ALL     = SYM$ -> CONST.B.ALL,
     1732    20621                           @DNT$    = CONST$ -> LX_ITEM.DNT$,
     1733    20622                           @NEXT    = CONST$ -> LX_TERMINAL.DNT$ -> DNT.ST$);

  20626 26 006025   000002 236000 4                  LDQ     ST_+2
        26 006026   000013 036007                    ADLQ    11,DL
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:293  
        26 006027   000003 116000 4                  CMPQ    ST_+3
        26 006030   006041 604000 26                 TMI     s:20628

  20627 26 006031   000022 236000 27                 LDQ     18
        26 006032   200152 756100                    STQ     I+1,,AUTO
        26 006033   200152 630500                    EPPR0   I+1,,AUTO
        26 006034   200153 450500                    STP0    I+2,,AUTO
        26 006035   200153 630500                    EPPR0   I+2,,AUTO
        26 006036   000006 631400 27                 EPPR1   6
        26 006037   000000 701000 xent               TSX1    Z8AR$RESERVER
        26 006040   000000 011000                    NOP     0

  20628 26 006041   000002 236000 4                  LDQ     ST_+2
        26 006042   000022 736000                    QLS     18
        26 006043   000001 036000 4                  ADLQ    ST_+1
        26 006044   200111 756100                    STQ     TYB_SYM$,,AUTO

  20629 26 006045   000013 236007                    LDQ     11,DL
        26 006046   000002 056000 4                  ASQ     ST_+2

  20632 26 006047   000767 220003                    LDX0    503,DU
        26 006050   200111 470500                    LDP0    TYB_SYM$,,AUTO
        26 006051   000000 740100                    STX0    0,,PR0

  20633 26 006052   001000 236007                    LDQ     512,DL
        26 006053   000000 552110                    STBQ    0,'10'O,PR0

  20634 26 006054   000126 236000 xsym               LDQ     O1COM+86
        26 006055   000000 552104                    STBQ    0,'04'O,PR0

  20635 26 006056   000014 221003                    LDX1    12,DU
        26 006057   000002 741100                    STX1    2,,PR0

  20636 26 006060   000003 450100                    STZ     3,,PR0

  20637 26 006061   200004 471500                    LDP1    @CONST$,,AUTO
        26 006062   100000 473500                    LDP3    0,,PR1
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:294  
        26 006063   300002 474500                    LDP4    2,,PR3
        26 006064   400001 236100                    LDQ     1,,PR4
        26 006065   000004 756100                    STQ     4,,PR0

  20638 26 006066   000001 236000 27                 LDQ     1
        26 006067   000005 756100                    STQ     5,,PR0

  20639 26 006070   100000 473500                    LDP3    0,,PR1
        26 006071   300002 236100                    LDQ     2,,PR3
        26 006072   000006 756100                    STQ     6,,PR0

  20650 26 006073   200012 473500                    LDP3    SYM$,,AUTO
        26 006074   300003 236100                    LDQ     3,,PR3
        26 006075   000003 676100                    ERQ     3,,PR0
        26 006076   040000 376003                    ANQ     16384,DU
        26 006077   000003 656100                    ERSQ    3,,PR0

     1734    20663    3          TYB_SYM$ ->CONST.ADSC.TA = %ADSC6;

  20663 26 006100   000001 236100                    LDQ     1,,PR0
        26 006101   000073 376000 27                 ANQ     59
        26 006102   020000 276007                    ORQ     8192,DL
        26 006103   000001 756100                    STQ     1,,PR0

     1735    20664    3          TYB_SYM$ ->CONST.ADSC.N = CONSTANT_LENGTH;

  20664 26 006104   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 006105   000001 752103                    STCQ    1,'03'O,PR0

     1736    20665               %GET_CONSTANT_ADDRESS (@CONSTANT = SYM$,
     1737    20666                                      @STRING   = TYA_CONST$);

  20668 26 006106   200012 473500                    LDP3    SYM$,,AUTO
        26 006107   300003 234100                    SZN     3,,PR3
        26 006110   006115 605000 26                 TPL     s:20671

  20669 26 006111   300010 474500                    LDP4    8,,PR3
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:295  
        26 006112   400001 635500                    EPPR5   1,,PR4
        26 006113   200113 455500                    STP5    TYA_CONST$,,AUTO
        26 006114   006120 710000 26                 TRA     s:20674

  20671 26 006115   200012 236100                    LDQ     SYM$,,AUTO
        26 006116   000010 036003                    ADLQ    8,DU
        26 006117   200113 756100                    STQ     TYA_CONST$,,AUTO

     1738    20674    3          IF CONSTANT_LENGTH <= 12 THEN

  20674 26 006120   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 006121   000014 115007                    CMPA    12,DL
        26 006122   006141 605400 26                 TPNZ    s:20685

     1739    20675    4            DO;

     1740    20676    4              CALL XLATE_9_TO_6 (TYB_SYM$ -> CONST.CONSTI, GBCD, TYA_CONST$ ->
             20676                       CONST_SYMBOL);

  20676 26 006123   200113 474500                    LDP4    TYA_CONST$,,AUTO
        26 006124   000000 622005                    EAX2    0,AL
        26 006125   040100 160540                    MVT     fill='040'O
        26 006126   400000 000012                    ADSC9   0,,PR4                   cn=0,n=*X2
        26 006127   000010 020014                    ADSC6   8,,PR0                   cn=0,n=12
        26 006130   000000 000000 xsym               ARG     GBCD

     1741    20677    4              IF CONSTANT_LENGTH > 6 THEN

  20677 26 006131   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 006132   000006 115007                    CMPA    6,DL
        26 006133   006216 604400 26                 TMOZ    s:20777

     1742    20678    5                DO;

     1743    20679    5                  TYB_SYM$ -> CONST.B.MOD_2 = TRUE;

  20679 26 006134   100000 236003                    LDQ     32768,DU
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:296  
        26 006135   000003 256100                    ORSQ    3,,PR0

     1744    20680    5                  TYB_SYM$ -> CONST.B.TWO_WORD = TRUE;

  20680 26 006136   200000 236003                    LDQ     65536,DU
        26 006137   000003 256100                    ORSQ    3,,PR0

     1745    20681    5                END;

     1746    20682    4            END;

  20682 26 006140   006216 710000 26                 TRA     s:20777

     1747    20683    3          ELSE
     1748    20684    4            DO;

     1749    20685    4              CONST_BITS = CONSTANT_LENGTH * 6;

  20685 26 006141   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 006142   000006 402007                    MPY     6,DL
        26 006143   200112 756100                    STQ     CONST_BITS,,AUTO

     1750    20686    4              ITERATION = (CONSTANT_LENGTH + 11) / 6;

  20686 26 006144   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 006145   000013 036007                    ADLQ    11,DL
        26 006146   000006 506007                    DIV     6,DL
        26 006147   000000 756000 0                  STQ     ITERATION

     1751    20687                   %RESERVE_LTS (ITEM=%LCNST, POINTER=LTSS$);

  20763 26 006150   000002 036000 2                  ADLQ    LTS_+2
        26 006151   000003 116000 2                  CMPQ    LTS_+3
        26 006152   006163 604000 26                 TMI     s:20765

  20764 26 006153   000041 236000 27                 LDQ     33
        26 006154   200152 756100                    STQ     I+1,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:297  
        26 006155   200152 634500                    EPPR4   I+1,,AUTO
        26 006156   200153 454500                    STP4    I+2,,AUTO
        26 006157   200153 630500                    EPPR0   I+2,,AUTO
        26 006160   000006 631400 27                 EPPR1   6
        26 006161   000000 701000 xent               TSX1    Z8AR$RESERVER
        26 006162   000000 011000                    NOP     0

  20765 26 006163   000002 236000 2                  LDQ     LTS_+2
        26 006164   000022 736000                    QLS     18
        26 006165   000001 036000 2                  ADLQ    LTS_+1
        26 006166   200015 756100                    STQ     LTSS$,,AUTO

  20766 26 006167   000002 236000 2                  LDQ     LTS_+2
        26 006170   000000 036000 0                  ADLQ    ITERATION
        26 006171   000002 756000 2                  STQ     LTS_+2

  20767 26 006172   001106 220003                    LDX0    582,DU
        26 006173   200015 470500                    LDP0    LTSS$,,AUTO
        26 006174   000000 740100                    STX0    0,,PR0

  20769 26 006175   000000 721000 0                  LXL1    ITERATION
        26 006176   000000 441100                    SXL1    0,,PR0

     1752    20773    4              CALL XLATE_9_TO_6 (LTSS$ -> BCD_LCNST.BCD_CONST, GBCD, TYA_CONST$ ->
             20773                       CONST_SYMBOL);

  20773 26 006177   200112 236100                    LDQ     CONST_BITS,,AUTO
        26 006200   000001 772000                    QRL     1
        26 006201   000003 506007                    DIV     3,DL
        26 006202   200113 471500                    LDP1    TYA_CONST$,,AUTO
        26 006203   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 006204   000000 623006                    EAX3    0,QL
        26 006205   040140 160540                    MVT     fill='040'O
        26 006206   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
        26 006207   000001 020013                    ADSC6   1,,PR0                   cn=0,n=*X3
        26 006210   000000 000000 xsym               ARG     GBCD

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:298  
     1753    20774    4              TYB_SYM$ -> CONST.CONST$.PTR$ = LTSS$;

  20774 26 006211   200015 236100                    LDQ     LTSS$,,AUTO
        26 006212   200111 473500                    LDP3    TYB_SYM$,,AUTO
        26 006213   300010 756100                    STQ     8,,PR3

     1754    20775    4              TYB_SYM$ -> CONST.B.LONG_CONSTANT = TRUE;

  20775 26 006214   400000 236003                    LDQ     -131072,DU
        26 006215   300003 256100                    ORSQ    3,,PR3

     1755    20776    4            END;

     1756    20777    3          SYM$ = TYB_SYM$;

  20777 26 006216   200111 236100                    LDQ     TYB_SYM$,,AUTO
        26 006217   200012 756100                    STQ     SYM$,,AUTO

     1757    20778    3        END;

     1758    20779    2   END CREATE_TYB_CONSTANT;

  20779 26 006220   200110 221300                    LDX1  ! N,,AUTO
        26 006221   000001 702211                    TSX2  ! 1,X1

     1759    20780        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:299  
     1760    20781    1   CREATE_TYA_WITH_TYPE_DESC: PROC (TYPE_DESC) ;

  20781 26 006222   200114 741300       CREATE_TYA_* STX1  ! OVERPUNCH_SIGN,,AUTO

     1761    20782
     1762    20783    2   DCL   CONSTANT_TYPE    UBIN WORD ;
     1763    20784
     1764    20785    2   DCL 1 TYPE_DESC        ALIGNED,
     1765    20786             %TYPE_DESC;
     1766    20820
     1767    20821         %CHECK_FOR_SYMBOLIC_CHARACTER;

  20823 26 006223   200004 470500                    LDP0    @CONST$,,AUTO
        26 006224   000000 471500                    LDP1    0,,PR0
        26 006225   100003 235100                    LDA     3,,PR1
        26 006226   000003 115007                    CMPA    3,DL
        26 006227   006247 601000 26                 TNZ     s:20835
        26 006230   200016 473500                    LDP3    DNT$$,,AUTO
        26 006231   300001 236100                    LDQ     1,,PR3
        26 006232   000001 116000 27                 CMPQ    1
        26 006233   006247 600000 26                 TZE     s:20835

  20825 26 006234   300001 474500                    LDP4    1,,PR3
        26 006235   400000 220100                    LDX0    0,,PR4
        26 006236   001001 100003                    CMPX0   513,DU
        26 006237   006247 601000 26                 TNZ     s:20835

  20827 26 006240   400005 236100                    LDQ     5,,PR4
        26 006241   200012 756100                    STQ     SYM$,,AUTO

  20828 26 006242   000001 235007                    LDA     1,DL
        26 006243   200007 755100                    STA     CONSTANT_LENGTH,,AUTO

  20829 26 006244   000010 036003                    ADLQ    8,DU
        26 006245   200014 756100                    STQ     CONSTANT_SYM$,,AUTO

  20830 26 006246   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:300  

     1768    20834
     1769    20835    2    CALL CREATE_ALPHA_OR_FIG_CONST;

  20835 26 006247   000112 701000 26                 TSX1    CREATE_ALPHA_OR_FIG_CONST
        26 006250   000000 011000                    NOP     0

     1770    20836
     1771    20837    2    IF SYM$ ~= ADDR(NIL) THEN

  20837 26 006251   200012 236100                    LDQ     SYM$,,AUTO
        26 006252   000001 116000 27                 CMPQ    1
        26 006253   006256 600000 26                 TZE     s:20842

     1772    20838           /* A reserved word that previously has been created
     1773    20839              was found so no need to create a constant        */
     1774    20840    2      RETURN;

  20840 26 006254   200114 221300                    LDX1  ! OVERPUNCH_SIGN,,AUTO
        26 006255   000001 702211                    TSX2  ! 1,X1

     1775    20841
     1776    20842    2    SYM$ = DNT$$ -> DNT.ST$;

  20842 26 006256   200016 470500                    LDP0    DNT$$,,AUTO
        26 006257   000001 236100                    LDQ     1,,PR0
        26 006260   200012 756100                    STQ     SYM$,,AUTO

     1777    20843    2    IF TYPE_DESC.SIZ$ ~= ADDR(NIL) THEN

  20843 26 006261   200115 471500                    LDP1    @TYPE_DESC,,AUTO
        26 006262   100002 236100                    LDQ     2,,PR1
        26 006263   000001 116000 27                 CMPQ    1
        26 006264   006272 600000 26                 TZE     s:20846

     1778    20844    2      REC_LENGTH = TYPE_DESC.SIZ$ -> ETT.LOP -> CONST.CONSTI.WORD1;

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:301  
  20844 26 006265   100002 473500                    LDP3    2,,PR1
        26 006266   300001 474500                    LDP4    1,,PR3
        26 006267   400010 235100                    LDA     8,,PR4
        26 006270   200043 755100                    STA     REC_LENGTH,,AUTO
        26 006271   006275 710000 26                 TRA     s:20848

     1779    20845    2    ELSE
     1780    20846    2      REC_LENGTH = TYPE_DESC.DESC.ADSC.N;

  20846 26 006272   100001 236100                    LDQ     1,,PR1
        26 006273   007777 376007                    ANQ     4095,DL
        26 006274   200043 756100                    STQ     REC_LENGTH,,AUTO

     1781    20847
     1782    20848    2    IF CONSTANT_LENGTH > REC_LENGTH THEN

  20848 26 006275   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 006276   200043 116100                    CMPQ    REC_LENGTH,,AUTO
        26 006277   006302 604400 26                 TMOZ    s:20851

     1783    20849    2      VALUE_OVERFLOW = TRUE;

  20849 26 006300   400000 236003                    LDQ     -131072,DU
        26 006301   200041 756100                    STQ     VALUE_OVERFLOW,,AUTO

     1784    20850
     1785    20851    2    IF TYPE_DESC.DESC.ADSC.CN + REC_LENGTH > %WORDLEN THEN

  20851 26 006302   100001 236100                    LDQ     1,,PR1
        26 006303   000020 772000                    QRL     16
        26 006304   000003 376007                    ANQ     3,DL
        26 006305   200043 036100                    ADLQ    REC_LENGTH,,AUTO
        26 006306   000004 116007                    CMPQ    4,DL
        26 006307   006312 604400 26                 TMOZ    s:20854

     1786    20852    2      CHAR_POS = 0;

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:302  
  20852 26 006310   200044 450100                    STZ     CHAR_POS,,AUTO
        26 006311   006316 710000 26                 TRA     s:20857

     1787    20853    2    ELSE
     1788    20854    2      CHAR_POS = TYPE_DESC.DESC.ADSC.CN;

  20854 26 006312   100001 236100                    LDQ     1,,PR1
        26 006313   000020 772000                    QRL     16
        26 006314   000003 376007                    ANQ     3,DL
        26 006315   200044 756100                    STQ     CHAR_POS,,AUTO

     1789    20855
     1790    20856         %TYA_SRCH (@ST$ = SYM$);

  20857 26 006316   006340 710000 26                 TRA     s:20866

  20858 26 006317   200012 470500                    LDP0    SYM$,,AUTO
        26 006320   000002 220100                    LDX0    2,,PR0
        26 006321   000010 100003                    CMPX0   8,DU
        26 006322   006336 601000 26                 TNZ     s:20865

  20859 26 006323   200004 471500                    LDP1    @CONST$,,AUTO
        26 006324   100000 473500                    LDP3    0,,PR1
        26 006325   000100 066500                    CMPB    filb='0'B
        26 006326   000003 030001                    BDSC    3,,PR0                   by=0,bit=3,n=1
        26 006327   300000 430001                    BDSC    0,,PR3                   by=2,bit=3,n=1
        26 006330   006336 601000 26                 TNZ     s:20865

  20860 26 006331   000001 236100                    LDQ     1,,PR0
        26 006332   000020 772000                    QRL     16
        26 006333   000003 376007                    ANQ     3,DL
        26 006334   200044 116100                    CMPQ    CHAR_POS,,AUTO
        26 006335   006343 600000 26                 TZE     s:20868

  20865 26 006336   000004 236100                    LDQ     4,,PR0
        26 006337   200012 756100                    STQ     SYM$,,AUTO

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:303  
  20866 26 006340   200012 236100                    LDQ     SYM$,,AUTO
        26 006341   000001 116000 27                 CMPQ    1
        26 006342   006317 601000 26                 TNZ     s:20858

     1791    20868    2    IF SYM$ = ADDR(NIL) THEN

  20868 26 006343   200012 236100                    LDQ     SYM$,,AUTO
        26 006344   000001 116000 27                 CMPQ    1
        26 006345   007073 601000 26                 TNZ     s:21138

     1792    20869    3      DO;

     1793    20870    3        IF CONST$ -> LX_TERMINAL.TYPE = %TYN THEN

  20870 26 006346   200004 470500                    LDP0    @CONST$,,AUTO
        26 006347   000000 471500                    LDP1    0,,PR0
        26 006350   100004 235100                    LDA     4,,PR1
        26 006351   000016 115007                    CMPA    14,DL
        26 006352   006356 601000 26                 TNZ     s:20873

     1794    20871    3          CONSTANT_TYPE = %TYN ;

  20871 26 006353   000016 235007                    LDA     14,DL
        26 006354   200116 755100                    STA     CONSTANT_TYPE,,AUTO
        26 006355   006360 710000 26                 TRA     s:20882

     1795    20872    3        ELSE
     1796    20873    3          CONSTANT_TYPE = %TYA ;

  20873 26 006356   000010 235007                    LDA     8,DL
        26 006357   200116 755100                    STA     CONSTANT_TYPE,,AUTO

     1797    20874
     1798    20875             %NEW_CONST (@ST$    = SYM$,
     1799    20876                         @TYPE   = CONSTANT_TYPE,
     1800    20877                         @DNT$   = CONST$ -> LX_ITEM.DNT$,
     1801    20878                         @NEXT   = CONST$ -> LX_TERMINAL.DNT$ -> DNT.ST$);
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:304  

  20882 26 006360   000002 236000 4                  LDQ     ST_+2
        26 006361   000013 036007                    ADLQ    11,DL
        26 006362   000003 116000 4                  CMPQ    ST_+3
        26 006363   006374 604000 26                 TMI     s:20884

  20883 26 006364   000022 236000 27                 LDQ     18
        26 006365   200152 756100                    STQ     I+1,,AUTO
        26 006366   200152 631500                    EPPR1   I+1,,AUTO
        26 006367   200153 451500                    STP1    I+2,,AUTO
        26 006370   200153 630500                    EPPR0   I+2,,AUTO
        26 006371   000006 631400 27                 EPPR1   6
        26 006372   000000 701000 xent               TSX1    Z8AR$RESERVER
        26 006373   000000 011000                    NOP     0

  20884 26 006374   000002 236000 4                  LDQ     ST_+2
        26 006375   000022 736000                    QLS     18
        26 006376   000001 036000 4                  ADLQ    ST_+1
        26 006377   200012 756100                    STQ     SYM$,,AUTO

  20885 26 006400   000013 236007                    LDQ     11,DL
        26 006401   000002 056000 4                  ASQ     ST_+2

  20888 26 006402   000767 220003                    LDX0    503,DU
        26 006403   200012 470500                    LDP0    SYM$,,AUTO
        26 006404   000000 740100                    STX0    0,,PR0

  20889 26 006405   200012 470500                    LDP0    SYM$,,AUTO
        26 006406   001000 236007                    LDQ     512,DL
        26 006407   000000 552110                    STBQ    0,'10'O,PR0

  20890 26 006410   200012 470500                    LDP0    SYM$,,AUTO
        26 006411   000126 236000 xsym               LDQ     O1COM+86
        26 006412   000000 552104                    STBQ    0,'04'O,PR0

  20891 26 006413   200116 721100                    LXL1    CONSTANT_TYPE,,AUTO
        26 006414   200012 470500                    LDP0    SYM$,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:305  
        26 006415   000002 741100                    STX1    2,,PR0

  20892 26 006416   200012 470500                    LDP0    SYM$,,AUTO
        26 006417   000003 450100                    STZ     3,,PR0

  20893 26 006420   200004 470500                    LDP0    @CONST$,,AUTO
        26 006421   000000 471500                    LDP1    0,,PR0
        26 006422   100002 473500                    LDP3    2,,PR1
        26 006423   300001 236100                    LDQ     1,,PR3
        26 006424   200012 474500                    LDP4    SYM$,,AUTO
        26 006425   400004 756100                    STQ     4,,PR4

  20894 26 006426   000001 236000 27                 LDQ     1
        26 006427   200012 471500                    LDP1    SYM$,,AUTO
        26 006430   100005 756100                    STQ     5,,PR1

  20895 26 006431   000000 471500                    LDP1    0,,PR0
        26 006432   100002 236100                    LDQ     2,,PR1
        26 006433   200012 473500                    LDP3    SYM$,,AUTO
        26 006434   300006 756100                    STQ     6,,PR3

     1802    20919
     1803    20920    3        IF CONST$ -> LX_ITEM.B.ALL THEN

  20920 26 006435   000000 471500                    LDP1    0,,PR0
        26 006436   100000 236100                    LDQ     0,,PR1
        26 006437   040000 316007                    CANQ    16384,DL
        26 006440   006445 600000 26                 TZE     s:20923

     1804    20921    3          SYM$ -> CONST.B.ALL = TRUE;

  20921 26 006441   200012 473500                    LDP3    SYM$,,AUTO
        26 006442   040000 236003                    LDQ     16384,DU
        26 006443   300003 256100                    ORSQ    3,,PR3
        26 006444   006474 710000 26                 TRA     s:20933

     1805    20922    3        ELSE
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:306  
     1806    20923    4          DO SELECT(CONST$ -> LX_TERMINAL.SYMBOL);

  20923 26 006445   100003 236100                    LDQ     3,,PR1
        26 006446   000433 116007                    CMPQ    283,DL
        26 006447   006462 604000 26                 TMI     s:20923+13
        26 006450   006465 600000 26                 TZE     s:20927
        26 006451   000650 116007                    CMPQ    424,DL
        26 006452   006457 604000 26                 TMI     s:20923+10
        26 006453   006465 600000 26                 TZE     s:20927
        26 006454   000761 116007                    CMPQ    497,DL
        26 006455   006471 601000 26                 TNZ     s:20930
        26 006456   006465 710000 26                 TRA     s:20927
        26 006457   000543 116007                    CMPQ    355,DL
        26 006460   006471 601000 26                 TNZ     s:20930
        26 006461   006465 710000 26                 TRA     s:20927
        26 006462   000351 116007                    CMPQ    233,DL
        26 006463   006471 601000 26                 TNZ     s:20930
        26 006464   006465 710000 26                 TRA     s:20927

     1807    20924    4            SELECT(%RSV_WRD_HIGH_VALUES, %RSV_WRD_LOW_VALUES,

     1808    20925    4                 %RSV_WRD_QUOTES,      %RSV_WRD_SPACES,
     1809    20926    4                 %RSV_WRD_ZEROES);
     1810    20927    4              SYM$ -> CONST.B.ALL = TRUE;

  20927 26 006465   200012 473500                    LDP3    SYM$,,AUTO
        26 006466   040000 236003                    LDQ     16384,DU
        26 006467   300003 256100                    ORSQ    3,,PR3
        26 006470   006474 710000 26                 TRA     s:20933

     1811    20928
     1812    20929    4            SELECT(ELSE);

     1813    20930    4              SYM$ -> CONST.B.ALL = FALSE;

  20930 26 006471   200012 473500                    LDP3    SYM$,,AUTO
        26 006472   000072 236000 27                 LDQ     58
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:307  
        26 006473   300003 356100                    ANSQ    3,,PR3

     1814    20931    4          END;

     1815    20932
     1816    20933    3        SYM$ -> CONST.ADSC.N = CONSTANT_LENGTH;

  20933 26 006474   200012 471500                    LDP1    SYM$,,AUTO
        26 006475   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 006476   100001 752103                    STCQ    1,'03'O,PR1

     1817    20934    3        NEW_ST = TRUE;

  20934 26 006477   400000 236003                    LDQ     -131072,DU
        26 006500   200040 756100                    STQ     NEW_ST,,AUTO

     1818    20935
     1819    20936    4        DO CASE (REC_LENGTH);

  20936 26 006501   200043 235100                    LDA     REC_LENGTH,,AUTO
        26 006502   000011 115007                    CMPA    9,DL
        26 006503   006505 602005 26                 TNC     s:20936+4,AL
        26 006504   006707 710000 26                 TRA     s:21004
        26 006505   006516 710000 26                 TRA     s:20940
        26 006506   006516 710000 26                 TRA     s:20940
        26 006507   006516 710000 26                 TRA     s:20940
        26 006510   006516 710000 26                 TRA     s:20940
        26 006511   006516 710000 26                 TRA     s:20940
        26 006512   006602 710000 26                 TRA     s:20966
        26 006513   006602 710000 26                 TRA     s:20966
        26 006514   006602 710000 26                 TRA     s:20966
        26 006515   006602 710000 26                 TRA     s:20966

     1820    20937
     1821    20938    4          CASE(0,1,2,3,4);

     1822    20939                 %ONE_WORD_ALPHA_ITEM;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:308  

  20940 26 006516   200115 471500                    LDP1    @TYPE_DESC,,AUTO
        26 006517   100001 236100                    LDQ     1,,PR1
        26 006520   000020 772000                    QRL     16
        26 006521   000003 376007                    ANQ     3,DL
        26 006522   200043 036100                    ADLQ    REC_LENGTH,,AUTO
        26 006523   000004 116007                    CMPQ    4,DL
        26 006524   006565 605400 26                 TPNZ    s:20957

  20942 26 006525   200012 473500                    LDP3    SYM$,,AUTO
        26 006526   000074 235000 27                 LDA     60
        26 006527   000074 236000 27                 LDQ     60
        26 006530   300010 755100                    STA     8,,PR3
        26 006531   300011 756100                    STQ     9,,PR3

  20943 26 006532   200012 473500                    LDP3    SYM$,,AUTO
        26 006533   300003 236100                    LDQ     3,,PR3
        26 006534   040000 316003                    CANQ    16384,DU
        26 006535   006547 600000 26                 TZE     s:20949

  20944 26 006536   100001 236100                    LDQ     1,,PR1
        26 006537   000020 772000                    QRL     16
        26 006540   000003 376007                    ANQ     3,DL
        26 006541   200014 474500                    LDP4    CONSTANT_SYM$,,AUTO
        26 006542   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 006543   040146 100540                    MLR     fill='040'O
        26 006544   400000 000012                    ADSC9   0,,PR4                   cn=0,n=*X2
        26 006545   300010 000012                    ADSC9   8,Q,PR3                  cn=0,n=*X2
        26 006546   006565 710000 26                 TRA     s:20957

  20949 26 006547   100001 236100                    LDQ     1,,PR1
        26 006550   000020 772000                    QRL     16
        26 006551   000003 376007                    ANQ     3,DL
        26 006552   200014 474500                    LDP4    CONSTANT_SYM$,,AUTO
        26 006553   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 006554   200043 723100                    LXL3    REC_LENGTH,,AUTO
        26 006555   040146 100540                    MLR     fill='040'O
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:309  
        26 006556   400000 000012                    ADSC9   0,,PR4                   cn=0,n=*X2
        26 006557   300010 000013                    ADSC9   8,Q,PR3                  cn=0,n=*X3

  20952 26 006560   200012 473500                    LDP3    SYM$,,AUTO
        26 006561   100001 236100                    LDQ     1,,PR1
        26 006562   300001 676100                    ERQ     1,,PR3
        26 006563   600000 376007                    ANQ     -65536,DL
        26 006564   300001 656100                    ERSQ    1,,PR3

  20957 26 006565   200014 473500                    LDP3    CONSTANT_SYM$,,AUTO
        26 006566   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 006567   200012 474500                    LDP4    SYM$,,AUTO
        26 006570   040100 100540                    MLR     fill='040'O
        26 006571   300000 000012                    ADSC9   0,,PR3                   cn=0,n=*X2
        26 006572   400010 000010                    ADSC9   8,,PR4                   cn=0,n=8

  20958 26 006573   200012 474500                    LDP4    SYM$,,AUTO
        26 006574   000075 236000 27                 LDQ     61
        26 006575   400001 356100                    ANSQ    1,,PR4

  20959 26 006576   200012 474500                    LDP4    SYM$,,AUTO
        26 006577   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 006600   400001 752103                    STCQ    1,'03'O,PR4

  20960 26 006601   007073 710000 26                 TRA     s:21138

     1823    20963
     1824    20964    4          CASE (5,6,7,8);

     1825    20965                 %GTR_1_BUT_LEQ_2_WORD_REC_ITEM;

  20966 26 006602   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 006603   000004 115007                    CMPA    4,DL
        26 006604   006625 605400 26                 TPNZ    s:20978
        26 006605   200043 235100                    LDA     REC_LENGTH,,AUTO
        26 006606   000010 115007                    CMPA    8,DL
        26 006607   006625 600000 26                 TZE     s:20978
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:310  

  20970 26 006610   200014 471500                    LDP1    CONSTANT_SYM$,,AUTO
        26 006611   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 006612   200012 473500                    LDP3    SYM$,,AUTO
        26 006613   040100 100540                    MLR     fill='040'O
        26 006614   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
        26 006615   300010 000010                    ADSC9   8,,PR3                   cn=0,n=8

  20971 26 006616   200012 473500                    LDP3    SYM$,,AUTO
        26 006617   000075 236000 27                 LDQ     61
        26 006620   300001 356100                    ANSQ    1,,PR3

  20972 26 006621   200012 473500                    LDP3    SYM$,,AUTO
        26 006622   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 006623   300001 752103                    STCQ    1,'03'O,PR3

  20973 26 006624   007073 710000 26                 TRA     s:21138

  20978 26 006625   200012 471500                    LDP1    SYM$,,AUTO
        26 006626   100003 236100                    LDQ     3,,PR1
        26 006627   040000 316003                    CANQ    16384,DU
        26 006630   006637 600000 26                 TZE     s:20983

  20979 26 006631   200014 473500                    LDP3    CONSTANT_SYM$,,AUTO
        26 006632   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 006633   040140 100540                    MLR     fill='040'O
        26 006634   300000 000012                    ADSC9   0,,PR3                   cn=0,n=*X2
        26 006635   100010 000012                    ADSC9   8,,PR1                   cn=0,n=*X2
        26 006636   006644 710000 26                 TRA     s:20987

  20983 26 006637   200014 473500                    LDP3    CONSTANT_SYM$,,AUTO
        26 006640   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 006641   040100 100540                    MLR     fill='040'O
        26 006642   300000 000012                    ADSC9   0,,PR3                   cn=0,n=*X2
        26 006643   100010 000010                    ADSC9   8,,PR1                   cn=0,n=8

  20987 26 006644   200012 471500                    LDP1    SYM$,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:311  
        26 006645   100002 223100                    LDX3    2,,PR1
        26 006646   000016 103003                    CMPX3   14,DU
        26 006647   006666 601000 26                 TNZ     s:20993
        26 006650   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 006651   000010 115007                    CMPA    8,DL
        26 006652   006666 605000 26                 TPL     s:20993

  20989 26 006653   200045 755100                    STA     I,,AUTO
        26 006654   006663 710000 26                 TRA     s:20991+1

  20990 26 006655   200012 470500                    LDP0    SYM$,,AUTO
        26 006656   200045 235100                    LDA     I,,AUTO
        26 006657   040105 100400                    MLR     fill='040'O
        26 006660   000076 000001 27                 ADSC9   62                       cn=0,n=1
        26 006661   000010 000001                    ADSC9   8,A,PR0                  cn=0,n=1

  20991 26 006662   200045 054100                    AOS     I,,AUTO
        26 006663   200045 235100                    LDA     I,,AUTO
        26 006664   000007 115007                    CMPA    7,DL
        26 006665   006655 604400 26                 TMOZ    s:20990

  20993 26 006666   200012 470500                    LDP0    SYM$,,AUTO
        26 006667   000075 236000 27                 LDQ     61
        26 006670   000001 356100                    ANSQ    1,,PR0

  20995 26 006671   000010 236007                    LDQ     8,DL
        26 006672   006675 604000 26                 TMI     s:20995+4
        26 006673   200007 116100                    CMPQ    CONSTANT_LENGTH,,AUTO
        26 006674   006676 604400 26                 TMOZ    s:20995+5
        26 006675   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 006676   200012 470500                    LDP0    SYM$,,AUTO
        26 006677   000001 752103                    STCQ    1,'03'O,PR0

  20996 26 006700   200012 470500                    LDP0    SYM$,,AUTO
        26 006701   200000 236003                    LDQ     65536,DU
        26 006702   000003 256100                    ORSQ    3,,PR0

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:312  
  20997 26 006703   200012 470500                    LDP0    SYM$,,AUTO
        26 006704   100000 236003                    LDQ     32768,DU
        26 006705   000003 256100                    ORSQ    3,,PR0

  20998 26 006706   007073 710000 26                 TRA     s:21138

     1826    21001
     1827    21002    4          CASE (ELSE);

     1828    21003                 %MULTI_WORD_REC_ITEM;

  21004 26 006707   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 006710   000011 115007                    CMPA    9,DL
        26 006711   006713 602005 26                 TNC     s:21004+4,AL
        26 006712   007024 710000 26                 TRA     s:21041
        26 006713   006724 710000 26                 TRA     s:21008
        26 006714   006724 710000 26                 TRA     s:21008
        26 006715   006724 710000 26                 TRA     s:21008
        26 006716   006724 710000 26                 TRA     s:21008
        26 006717   006724 710000 26                 TRA     s:21008
        26 006720   006741 710000 26                 TRA     s:21016
        26 006721   006741 710000 26                 TRA     s:21016
        26 006722   006741 710000 26                 TRA     s:21016
        26 006723   006741 710000 26                 TRA     s:21016

  21008 26 006724   200014 471500                    LDP1    CONSTANT_SYM$,,AUTO
        26 006725   000000 622005                    EAX2    0,AL
        26 006726   200012 473500                    LDP3    SYM$,,AUTO
        26 006727   040100 100540                    MLR     fill='040'O
        26 006730   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
        26 006731   300010 000010                    ADSC9   8,,PR3                   cn=0,n=8

  21009 26 006732   200012 473500                    LDP3    SYM$,,AUTO
        26 006733   000075 236000 27                 LDQ     61
        26 006734   300001 356100                    ANSQ    1,,PR3

  21010 26 006735   200012 473500                    LDP3    SYM$,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:313  
        26 006736   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 006737   300001 752103                    STCQ    1,'03'O,PR3

  21011 26 006740   007073 710000 26                 TRA     s:21138

  21016 26 006741   200012 471500                    LDP1    SYM$,,AUTO
        26 006742   100003 236100                    LDQ     3,,PR1
        26 006743   040000 316003                    CANQ    16384,DU
        26 006744   006754 600000 26                 TZE     s:21021

  21017 26 006745   200014 473500                    LDP3    CONSTANT_SYM$,,AUTO
        26 006746   000000 622005                    EAX2    0,AL
        26 006747   200007 723100                    LXL3    CONSTANT_LENGTH,,AUTO
        26 006750   040140 100540                    MLR     fill='040'O
        26 006751   300000 000012                    ADSC9   0,,PR3                   cn=0,n=*X2
        26 006752   100010 000013                    ADSC9   8,,PR1                   cn=0,n=*X3
        26 006753   006761 710000 26                 TRA     s:21025

  21021 26 006754   200014 473500                    LDP3    CONSTANT_SYM$,,AUTO
        26 006755   000000 622005                    EAX2    0,AL
        26 006756   040100 100540                    MLR     fill='040'O
        26 006757   300000 000012                    ADSC9   0,,PR3                   cn=0,n=*X2
        26 006760   100010 000010                    ADSC9   8,,PR1                   cn=0,n=8

  21025 26 006761   200012 471500                    LDP1    SYM$,,AUTO
        26 006762   100002 222100                    LDX2    2,,PR1
        26 006763   000016 102003                    CMPX2   14,DU
        26 006764   007003 601000 26                 TNZ     s:21031
        26 006765   200007 235100                    LDA     CONSTANT_LENGTH,,AUTO
        26 006766   000010 115007                    CMPA    8,DL
        26 006767   007003 605000 26                 TPL     s:21031

  21027 26 006770   200045 755100                    STA     I,,AUTO
        26 006771   007000 710000 26                 TRA     s:21029+1

  21028 26 006772   200012 470500                    LDP0    SYM$,,AUTO
        26 006773   200045 235100                    LDA     I,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:314  
        26 006774   040105 100400                    MLR     fill='040'O
        26 006775   000076 000001 27                 ADSC9   62                       cn=0,n=1
        26 006776   000010 000001                    ADSC9   8,A,PR0                  cn=0,n=1

  21029 26 006777   200045 054100                    AOS     I,,AUTO
        26 007000   200045 235100                    LDA     I,,AUTO
        26 007001   000007 115007                    CMPA    7,DL
        26 007002   006772 604400 26                 TMOZ    s:21028

  21031 26 007003   200012 470500                    LDP0    SYM$,,AUTO
        26 007004   000075 236000 27                 LDQ     61
        26 007005   000001 356100                    ANSQ    1,,PR0

  21033 26 007006   000010 236007                    LDQ     8,DL
        26 007007   007012 604000 26                 TMI     s:21033+4
        26 007010   200007 116100                    CMPQ    CONSTANT_LENGTH,,AUTO
        26 007011   007013 604400 26                 TMOZ    s:21033+5
        26 007012   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 007013   200012 470500                    LDP0    SYM$,,AUTO
        26 007014   000001 752103                    STCQ    1,'03'O,PR0

  21034 26 007015   200012 470500                    LDP0    SYM$,,AUTO
        26 007016   200000 236003                    LDQ     65536,DU
        26 007017   000003 256100                    ORSQ    3,,PR0

  21035 26 007020   200012 470500                    LDP0    SYM$,,AUTO
        26 007021   100000 236003                    LDQ     32768,DU
        26 007022   000003 256100                    ORSQ    3,,PR0

  21036 26 007023   007073 710000 26                 TRA     s:21138

  21041 26 007024   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 007025   000003 036007                    ADLQ    3,DL
        26 007026   000004 506007                    DIV     4,DL
        26 007027   000001 036007                    ADLQ    1,DL
        26 007030   000000 756000 0                  STQ     ITERATION

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:315  
  21118 26 007031   000002 036000 2                  ADLQ    LTS_+2
        26 007032   000003 116000 2                  CMPQ    LTS_+3
        26 007033   007044 604000 26                 TMI     s:21120

  21119 26 007034   000041 236000 27                 LDQ     33
        26 007035   200152 756100                    STQ     I+1,,AUTO
        26 007036   200152 631500                    EPPR1   I+1,,AUTO
        26 007037   200153 451500                    STP1    I+2,,AUTO
        26 007040   200153 630500                    EPPR0   I+2,,AUTO
        26 007041   000006 631400 27                 EPPR1   6
        26 007042   000000 701000 xent               TSX1    Z8AR$RESERVER
        26 007043   000000 011000                    NOP     0

  21120 26 007044   000002 236000 2                  LDQ     LTS_+2
        26 007045   000022 736000                    QLS     18
        26 007046   000001 036000 2                  ADLQ    LTS_+1
        26 007047   200015 756100                    STQ     LTSS$,,AUTO

  21121 26 007050   000002 236000 2                  LDQ     LTS_+2
        26 007051   000000 036000 0                  ADLQ    ITERATION
        26 007052   000002 756000 2                  STQ     LTS_+2

  21122 26 007053   001106 220003                    LDX0    582,DU
        26 007054   200015 470500                    LDP0    LTSS$,,AUTO
        26 007055   000000 740100                    STX0    0,,PR0

  21124 26 007056   000000 721000 0                  LXL1    ITERATION
        26 007057   000000 441100                    SXL1    0,,PR0

  21128 26 007060   200014 471500                    LDP1    CONSTANT_SYM$,,AUTO
        26 007061   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 007062   040140 100540                    MLR     fill='040'O
        26 007063   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
        26 007064   000001 000012                    ADSC9   1,,PR0                   cn=0,n=*X2

  21129 26 007065   200015 236100                    LDQ     LTSS$,,AUTO
        26 007066   200012 473500                    LDP3    SYM$,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:316  
        26 007067   300010 756100                    STQ     8,,PR3

  21130 26 007070   200012 473500                    LDP3    SYM$,,AUTO
        26 007071   400000 236003                    LDQ     -131072,DU
        26 007072   300003 256100                    ORSQ    3,,PR3

     1829    21135    4        END; /* Case */

     1830    21136    3       END; /* If sym$ = addr(nil) */

     1831    21137
     1832    21138    2   END CREATE_TYA_WITH_TYPE_DESC;

  21138 26 007073   200114 221300                    LDX1  ! OVERPUNCH_SIGN,,AUTO
        26 007074   000001 702211                    TSX2  ! 1,X1

     1833    21139        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:317  
     1834    21140    1   CREATE_TYE_WITH_TYPE_DESC: PROC (TYPE_DESC);

  21140 26 007075   200106 741300       CREATE_TYE_* STX1  ! NUM_DESC+6,,AUTO

     1835    21141        /*I*  NAME: CREATE_TYE_CONSTANT
     1836    21142           PURPOSE: Make an EBCDIC alphanumeric constant.
     1837    21143        */
     1838    21144
     1839    21145    2   DCL   TYE_SYM$ PTR;
     1840    21146    2   DCL 1 TYPE_DESC ALIGNED,
     1841    21147             %TYPE_DESC;
     1842    21181    2   DCL   TYA_CONST$ PTR;
     1843    21182
     1844    21183    2    SYM$ = DNT$$ -> DNT.ST$;

  21183 26 007076   200016 470500                    LDP0    DNT$$,,AUTO
        26 007077   000001 236100                    LDQ     1,,PR0
        26 007100   200012 756100                    STQ     SYM$,,AUTO

     1845    21184    2    IF TYPE_DESC.SIZ$ ~= ADDR (NIL) THEN

  21184 26 007101   200107 471500                    LDP1    @TYPE_DESC,,AUTO
        26 007102   100002 236100                    LDQ     2,,PR1
        26 007103   000001 116000 27                 CMPQ    1
        26 007104   007112 600000 26                 TZE     s:21187

     1846    21185    2      REC_LENGTH = TYPE_DESC.SIZ$ -> ETT.LOP -> CONST.CONSTI.WORD1;

  21185 26 007105   100002 473500                    LDP3    2,,PR1
        26 007106   300001 474500                    LDP4    1,,PR3
        26 007107   400010 235100                    LDA     8,,PR4
        26 007110   200043 755100                    STA     REC_LENGTH,,AUTO
        26 007111   007115 710000 26                 TRA     s:21188

     1847    21186    2    ELSE
     1848    21187    2      REC_LENGTH = TYPE_DESC.DESC.ADSC.N;

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:318  
  21187 26 007112   100001 236100                    LDQ     1,,PR1
        26 007113   007777 376007                    ANQ     4095,DL
        26 007114   200043 756100                    STQ     REC_LENGTH,,AUTO

     1849    21188    2    IF TYPE_DESC.DESC.ADSC.CN + REC_LENGTH > %WORDLEN THEN

  21188 26 007115   100001 236100                    LDQ     1,,PR1
        26 007116   000020 772000                    QRL     16
        26 007117   000003 376007                    ANQ     3,DL
        26 007120   200043 036100                    ADLQ    REC_LENGTH,,AUTO
        26 007121   000004 116007                    CMPQ    4,DL
        26 007122   007125 604400 26                 TMOZ    s:21191

     1850    21189    2      CHAR_POS = 0;

  21189 26 007123   200044 450100                    STZ     CHAR_POS,,AUTO
        26 007124   007131 710000 26                 TRA     s:21194

     1851    21190    2    ELSE
     1852    21191    2      CHAR_POS = TYPE_DESC.DESC.ADSC.CN;

  21191 26 007125   100001 236100                    LDQ     1,,PR1
        26 007126   000020 772000                    QRL     16
        26 007127   000003 376007                    ANQ     3,DL
        26 007130   200044 756100                    STQ     CHAR_POS,,AUTO

     1853    21192
     1854    21193         %TYE_SRCH;

  21194 26 007131   007153 710000 26                 TRA     s:21203

  21195 26 007132   200012 470500                    LDP0    SYM$,,AUTO
        26 007133   000002 220100                    LDX0    2,,PR0
        26 007134   000006 100003                    CMPX0   6,DU
        26 007135   007151 601000 26                 TNZ     s:21202

  21196 26 007136   200004 471500                    LDP1    @CONST$,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:319  
        26 007137   100000 473500                    LDP3    0,,PR1
        26 007140   000100 066500                    CMPB    filb='0'B
        26 007141   000003 030001                    BDSC    3,,PR0                   by=0,bit=3,n=1
        26 007142   300000 430001                    BDSC    0,,PR3                   by=2,bit=3,n=1
        26 007143   007151 601000 26                 TNZ     s:21202

  21197 26 007144   000001 236100                    LDQ     1,,PR0
        26 007145   000020 772000                    QRL     16
        26 007146   000003 376007                    ANQ     3,DL
        26 007147   200044 116100                    CMPQ    CHAR_POS,,AUTO
        26 007150   007156 600000 26                 TZE     s:21206

  21202 26 007151   000004 236100                    LDQ     4,,PR0
        26 007152   200012 756100                    STQ     SYM$,,AUTO

  21203 26 007153   200012 236100                    LDQ     SYM$,,AUTO
        26 007154   000001 116000 27                 CMPQ    1
        26 007155   007132 601000 26                 TNZ     s:21195

     1855    21205
     1856    21206    2    IF SYM$ = ADDR (NIL) THEN

  21206 26 007156   200012 236100                    LDQ     SYM$,,AUTO
        26 007157   000001 116000 27                 CMPQ    1
        26 007160   007352 601000 26                 TNZ     s:21365

     1857    21207    3      DO;

     1858    21208    3        CALL CREATE_TYA_WITH_TYPE_DESC (TYPE_DESC);

  21208 26 007161   200107 236100                    LDQ     @TYPE_DESC,,AUTO
        26 007162   200115 756100                    STQ     @TYPE_DESC,,AUTO
        26 007163   006222 701000 26                 TSX1    CREATE_TYA_WITH_TYPE_DESC
        26 007164   000000 011000                    NOP     0

     1859    21209             %NEW_CONST (@ST$     = TYE_SYM$,
     1860    21210                         @TYPE    = %TYE,
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:320  
     1861    21211                         @ALL     = SYM$ -> CONST.B.ALL,
     1862    21212                         @MOD_2   = SYM$ -> CONST.B.MOD_2,
     1863    21213                         @TWO_WORD = SYM$ -> CONST.B.TWO_WORD,
     1864    21214                         @DNT$    = CONST$ -> LX_ITEM.DNT$,
     1865    21215                         @NEXT    = CONST$ -> LX_TERMINAL.DNT$ -> DNT.ST$);

  21219 26 007165   000002 236000 4                  LDQ     ST_+2
        26 007166   000013 036007                    ADLQ    11,DL
        26 007167   000003 116000 4                  CMPQ    ST_+3
        26 007170   007201 604000 26                 TMI     s:21221

  21220 26 007171   000022 236000 27                 LDQ     18
        26 007172   200152 756100                    STQ     I+1,,AUTO
        26 007173   200152 630500                    EPPR0   I+1,,AUTO
        26 007174   200153 450500                    STP0    I+2,,AUTO
        26 007175   200153 630500                    EPPR0   I+2,,AUTO
        26 007176   000006 631400 27                 EPPR1   6
        26 007177   000000 701000 xent               TSX1    Z8AR$RESERVER
        26 007200   000000 011000                    NOP     0

  21221 26 007201   000002 236000 4                  LDQ     ST_+2
        26 007202   000022 736000                    QLS     18
        26 007203   000001 036000 4                  ADLQ    ST_+1
        26 007204   200110 756100                    STQ     TYE_SYM$,,AUTO

  21222 26 007205   000013 236007                    LDQ     11,DL
        26 007206   000002 056000 4                  ASQ     ST_+2

  21225 26 007207   000767 220003                    LDX0    503,DU
        26 007210   200110 470500                    LDP0    TYE_SYM$,,AUTO
        26 007211   000000 740100                    STX0    0,,PR0

  21226 26 007212   001000 236007                    LDQ     512,DL
        26 007213   000000 552110                    STBQ    0,'10'O,PR0

  21227 26 007214   000126 236000 xsym               LDQ     O1COM+86
        26 007215   000000 552104                    STBQ    0,'04'O,PR0
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:321  

  21228 26 007216   000006 221003                    LDX1    6,DU
        26 007217   000002 741100                    STX1    2,,PR0

  21229 26 007220   000003 450100                    STZ     3,,PR0

  21230 26 007221   200004 471500                    LDP1    @CONST$,,AUTO
        26 007222   100000 473500                    LDP3    0,,PR1
        26 007223   300002 474500                    LDP4    2,,PR3
        26 007224   400001 236100                    LDQ     1,,PR4
        26 007225   000004 756100                    STQ     4,,PR0

  21231 26 007226   000001 236000 27                 LDQ     1
        26 007227   000005 756100                    STQ     5,,PR0

  21232 26 007230   100000 473500                    LDP3    0,,PR1
        26 007231   300002 236100                    LDQ     2,,PR3
        26 007232   000006 756100                    STQ     6,,PR0

  21237 26 007233   200012 473500                    LDP3    SYM$,,AUTO
        26 007234   300003 236100                    LDQ     3,,PR3
        26 007235   000003 676100                    ERQ     3,,PR0
        26 007236   200000 376003                    ANQ     65536,DU
        26 007237   000003 656100                    ERSQ    3,,PR0

  21240 26 007240   200012 473500                    LDP3    SYM$,,AUTO
        26 007241   300003 236100                    LDQ     3,,PR3
        26 007242   000003 676100                    ERQ     3,,PR0
        26 007243   100000 376003                    ANQ     32768,DU
        26 007244   000003 656100                    ERSQ    3,,PR0

  21243 26 007245   200012 473500                    LDP3    SYM$,,AUTO
        26 007246   300003 236100                    LDQ     3,,PR3
        26 007247   000003 676100                    ERQ     3,,PR0
        26 007250   040000 376003                    ANQ     16384,DU
        26 007251   000003 656100                    ERSQ    3,,PR0

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:322  
     1866    21256    3        TYE_SYM$ -> CONST.ADSC.N = CONSTANT_LENGTH;

  21256 26 007252   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 007253   000001 752103                    STCQ    1,'03'O,PR0

     1867    21257    3        NEW_ST = TRUE;

  21257 26 007254   400000 236003                    LDQ     -131072,DU
        26 007255   200040 756100                    STQ     NEW_ST,,AUTO

     1868    21258             %GET_CONSTANT_ADDRESS (@CONSTANT = SYM$,
     1869    21259                                    @STRING   = TYA_CONST$);

  21261 26 007256   200012 473500                    LDP3    SYM$,,AUTO
        26 007257   300003 234100                    SZN     3,,PR3
        26 007260   007265 605000 26                 TPL     s:21264

  21262 26 007261   300010 474500                    LDP4    8,,PR3
        26 007262   400001 635500                    EPPR5   1,,PR4
        26 007263   200111 455500                    STP5    TYA_CONST$,,AUTO
        26 007264   007270 710000 26                 TRA     s:21267

  21264 26 007265   200012 236100                    LDQ     SYM$,,AUTO
        26 007266   000010 036003                    ADLQ    8,DU
        26 007267   200111 756100                    STQ     TYA_CONST$,,AUTO

     1870    21267    3        IF REC_LENGTH <= 8 THEN

  21267 26 007270   200043 235100                    LDA     REC_LENGTH,,AUTO
        26 007271   000010 115007                    CMPA    8,DL
        26 007272   007302 605400 26                 TPNZ    s:21271

     1871    21268    3          CALL XLATE (TYE_SYM$ -> CONST.CONSTA, EBCDIC, TYA_CONST$ -> CONST_SYMBOL);

  21268 26 007273   200111 474500                    LDP4    TYA_CONST$,,AUTO
        26 007274   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 007275   040100 160540                    MVT     fill='040'O
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:323  
        26 007276   400000 000012                    ADSC9   0,,PR4                   cn=0,n=*X2
        26 007277   000010 000010                    ADSC9   8,,PR0                   cn=0,n=8
        26 007300   000000 000000 xsym               ARG     EBCDIC
        26 007301   007350 710000 26                 TRA     s:21363

     1872    21269    3        ELSE
     1873    21270    4          DO;

     1874    21271    4            ITERATION = (CONSTANT_LENGTH + 7) / 4;

  21271 26 007302   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 007303   000007 036007                    ADLQ    7,DL
        26 007304   000004 506007                    DIV     4,DL
        26 007305   000000 756000 0                  STQ     ITERATION

     1875    21272                 %RESERVE_LTS (ITEM=%LCNST, POINTER=LTSS$);

  21348 26 007306   000002 036000 2                  ADLQ    LTS_+2
        26 007307   000003 116000 2                  CMPQ    LTS_+3
        26 007310   007321 604000 26                 TMI     s:21350

  21349 26 007311   000041 236000 27                 LDQ     33
        26 007312   200152 756100                    STQ     I+1,,AUTO
        26 007313   200152 634500                    EPPR4   I+1,,AUTO
        26 007314   200153 454500                    STP4    I+2,,AUTO
        26 007315   200153 630500                    EPPR0   I+2,,AUTO
        26 007316   000006 631400 27                 EPPR1   6
        26 007317   000000 701000 xent               TSX1    Z8AR$RESERVER
        26 007320   000000 011000                    NOP     0

  21350 26 007321   000002 236000 2                  LDQ     LTS_+2
        26 007322   000022 736000                    QLS     18
        26 007323   000001 036000 2                  ADLQ    LTS_+1
        26 007324   200015 756100                    STQ     LTSS$,,AUTO

  21351 26 007325   000002 236000 2                  LDQ     LTS_+2
        26 007326   000000 036000 0                  ADLQ    ITERATION
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:324  
        26 007327   000002 756000 2                  STQ     LTS_+2

  21352 26 007330   001106 220003                    LDX0    582,DU
        26 007331   200015 470500                    LDP0    LTSS$,,AUTO
        26 007332   000000 740100                    STX0    0,,PR0

  21354 26 007333   000000 721000 0                  LXL1    ITERATION
        26 007334   000000 441100                    SXL1    0,,PR0

     1876    21358    4            CALL XLATE (SUBSTR (LTSS$ -> LCNST.CONST, 0, CONSTANT_LENGTH),

  21358 26 007335   200111 471500                    LDP1    TYA_CONST$,,AUTO
        26 007336   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 007337   040140 160540                    MVT     fill='040'O
        26 007340   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
        26 007341   000001 000012                    ADSC9   1,,PR0                   cn=0,n=*X2
        26 007342   000000 000000 xsym               ARG     EBCDIC

     1877    21359    4                EBCDIC, TYA_CONST$ -> CONST_SYMBOL);
     1878    21360    4            TYE_SYM$ -> CONST.CONST$.PTR$ = LTSS$;

  21360 26 007343   200015 236100                    LDQ     LTSS$,,AUTO
        26 007344   200110 473500                    LDP3    TYE_SYM$,,AUTO
        26 007345   300010 756100                    STQ     8,,PR3

     1879    21361    4            TYE_SYM$ -> CONST.B.LONG_CONSTANT = TRUE;

  21361 26 007346   400000 236003                    LDQ     -131072,DU
        26 007347   300003 256100                    ORSQ    3,,PR3

     1880    21362    4          END;

     1881    21363    3        SYM$ = TYE_SYM$;

  21363 26 007350   200110 236100                    LDQ     TYE_SYM$,,AUTO
        26 007351   200012 756100                    STQ     SYM$,,AUTO

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:325  
     1882    21364    3      END;

     1883    21365    2   END CREATE_TYE_WITH_TYPE_DESC;

  21365 26 007352   200106 221300                    LDX1  ! NUM_DESC+6,,AUTO
        26 007353   000001 702211                    TSX2  ! 1,X1

     1884    21366        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:326  
     1885    21367    1   CREATE_TYB_WITH_TYPE_DESC: PROC (TYPE_DESC);

  21367 26 007354   200106 741300       CREATE_TYB_* STX1  ! NUM_DESC+6,,AUTO

     1886    21368        /*I*  NAME: CREATE_TYB_CONSTANT
     1887    21369           PURPOSE: Make a GBCD constant.
     1888    21370        */
     1889    21371
     1890    21372    2   DCL 1 TYPE_DESC ALIGNED,
     1891    21373             %TYPE_DESC;
     1892    21407    2   DCL   TYB_SYM$ PTR;
     1893    21408    2   DCL 1 BCD_LCNST ALIGNED BASED (LTSS$),
     1894    21409    2         2 * BIT (36),
     1895    21410    2         2 BCD_CONST BIT (CONST_BITS);
     1896    21411    2   DCL   CONST_BITS UBIN;
     1897    21412    2   DCL   TYA_CONST$ PTR;
     1898    21413
     1899    21414    2    SYM$ = DNT$$ -> DNT.ST$;

  21414 26 007355   200016 470500                    LDP0    DNT$$,,AUTO
        26 007356   000001 236100                    LDQ     1,,PR0
        26 007357   200012 756100                    STQ     SYM$,,AUTO

     1900    21415    2    IF TYPE_DESC.SIZ$ ~= ADDR (NIL) THEN

  21415 26 007360   200107 471500                    LDP1    @TYPE_DESC,,AUTO
        26 007361   100002 236100                    LDQ     2,,PR1
        26 007362   000001 116000 27                 CMPQ    1
        26 007363   007371 600000 26                 TZE     s:21418

     1901    21416    2      REC_LENGTH = TYPE_DESC.SIZ$ -> ETT.LOP -> CONST.CONSTI.WORD1;

  21416 26 007364   100002 473500                    LDP3    2,,PR1
        26 007365   300001 474500                    LDP4    1,,PR3
        26 007366   400010 235100                    LDA     8,,PR4
        26 007367   200043 755100                    STA     REC_LENGTH,,AUTO
        26 007370   007374 710000 26                 TRA     s:21419
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:327  

     1902    21417    2    ELSE
     1903    21418    2      REC_LENGTH = TYPE_DESC.DESC.ADSC.N;

  21418 26 007371   100001 236100                    LDQ     1,,PR1
        26 007372   007777 376007                    ANQ     4095,DL
        26 007373   200043 756100                    STQ     REC_LENGTH,,AUTO

     1904    21419    2    IF TYPE_DESC.DESC.NDSC.CN + REC_LENGTH > 6 THEN

  21419 26 007374   100001 236100                    LDQ     1,,PR1
        26 007375   000017 772000                    QRL     15
        26 007376   000007 376007                    ANQ     7,DL
        26 007377   200043 036100                    ADLQ    REC_LENGTH,,AUTO
        26 007400   000006 116007                    CMPQ    6,DL
        26 007401   007404 604400 26                 TMOZ    s:21422

     1905    21420    2      CHAR_POS = 0;

  21420 26 007402   200044 450100                    STZ     CHAR_POS,,AUTO
        26 007403   007410 710000 26                 TRA     s:21425

     1906    21421    2    ELSE
     1907    21422    2      CHAR_POS = TYPE_DESC.DESC.NDSC.CN;

  21422 26 007404   100001 236100                    LDQ     1,,PR1
        26 007405   000017 772000                    QRL     15
        26 007406   000007 376007                    ANQ     7,DL
        26 007407   200044 756100                    STQ     CHAR_POS,,AUTO

     1908    21423
     1909    21424         %TYB_SRCH;

  21425 26 007410   007432 710000 26                 TRA     s:21434

  21426 26 007411   200012 470500                    LDP0    SYM$,,AUTO
        26 007412   000002 220100                    LDX0    2,,PR0
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:328  
        26 007413   000014 100003                    CMPX0   12,DU
        26 007414   007430 601000 26                 TNZ     s:21433

  21427 26 007415   200004 471500                    LDP1    @CONST$,,AUTO
        26 007416   100000 473500                    LDP3    0,,PR1
        26 007417   000100 066500                    CMPB    filb='0'B
        26 007420   000003 030001                    BDSC    3,,PR0                   by=0,bit=3,n=1
        26 007421   300000 430001                    BDSC    0,,PR3                   by=2,bit=3,n=1
        26 007422   007430 601000 26                 TNZ     s:21433

  21428 26 007423   000001 236100                    LDQ     1,,PR0
        26 007424   000020 772000                    QRL     16
        26 007425   000003 376007                    ANQ     3,DL
        26 007426   200044 116100                    CMPQ    CHAR_POS,,AUTO
        26 007427   007435 600000 26                 TZE     s:21436

  21433 26 007430   000004 236100                    LDQ     4,,PR0
        26 007431   200012 756100                    STQ     SYM$,,AUTO

  21434 26 007432   200012 236100                    LDQ     SYM$,,AUTO
        26 007433   000001 116000 27                 CMPQ    1
        26 007434   007411 601000 26                 TNZ     s:21426

     1910    21436    2    IF SYM$ = ADDR (NIL) THEN

  21436 26 007435   200012 236100                    LDQ     SYM$,,AUTO
        26 007436   000001 116000 27                 CMPQ    1
        26 007437   007636 601000 26                 TNZ     s:21600

     1911    21437    3      DO;

     1912    21438    3        CALL CREATE_TYA_WITH_TYPE_DESC (TYPE_DESC);

  21438 26 007440   200107 236100                    LDQ     @TYPE_DESC,,AUTO
        26 007441   200115 756100                    STQ     @TYPE_DESC,,AUTO
        26 007442   006222 701000 26                 TSX1    CREATE_TYA_WITH_TYPE_DESC
        26 007443   000000 011000                    NOP     0
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:329  

     1913    21439             %NEW_CONST (@ST$     = TYB_SYM$,
     1914    21440                         @TYPE    = %TYB,
     1915    21441                         @ALL     = SYM$ -> CONST.B.ALL,
     1916    21442                         @DNT$    = CONST$ -> LX_ITEM.DNT$,
     1917    21443                         @NEXT    = CONST$ -> LX_TERMINAL.DNT$ -> DNT.ST$);

  21447 26 007444   000002 236000 4                  LDQ     ST_+2
        26 007445   000013 036007                    ADLQ    11,DL
        26 007446   000003 116000 4                  CMPQ    ST_+3
        26 007447   007460 604000 26                 TMI     s:21449

  21448 26 007450   000022 236000 27                 LDQ     18
        26 007451   200152 756100                    STQ     I+1,,AUTO
        26 007452   200152 630500                    EPPR0   I+1,,AUTO
        26 007453   200153 450500                    STP0    I+2,,AUTO
        26 007454   200153 630500                    EPPR0   I+2,,AUTO
        26 007455   000006 631400 27                 EPPR1   6
        26 007456   000000 701000 xent               TSX1    Z8AR$RESERVER
        26 007457   000000 011000                    NOP     0

  21449 26 007460   000002 236000 4                  LDQ     ST_+2
        26 007461   000022 736000                    QLS     18
        26 007462   000001 036000 4                  ADLQ    ST_+1
        26 007463   200110 756100                    STQ     TYB_SYM$,,AUTO

  21450 26 007464   000013 236007                    LDQ     11,DL
        26 007465   000002 056000 4                  ASQ     ST_+2

  21453 26 007466   000767 220003                    LDX0    503,DU
        26 007467   200110 470500                    LDP0    TYB_SYM$,,AUTO
        26 007470   000000 740100                    STX0    0,,PR0

  21454 26 007471   001000 236007                    LDQ     512,DL
        26 007472   000000 552110                    STBQ    0,'10'O,PR0

  21455 26 007473   000126 236000 xsym               LDQ     O1COM+86
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:330  
        26 007474   000000 552104                    STBQ    0,'04'O,PR0

  21456 26 007475   000014 221003                    LDX1    12,DU
        26 007476   000002 741100                    STX1    2,,PR0

  21457 26 007477   000003 450100                    STZ     3,,PR0

  21458 26 007500   200004 471500                    LDP1    @CONST$,,AUTO
        26 007501   100000 473500                    LDP3    0,,PR1
        26 007502   300002 474500                    LDP4    2,,PR3
        26 007503   400001 236100                    LDQ     1,,PR4
        26 007504   000004 756100                    STQ     4,,PR0

  21459 26 007505   000001 236000 27                 LDQ     1
        26 007506   000005 756100                    STQ     5,,PR0

  21460 26 007507   100000 473500                    LDP3    0,,PR1
        26 007510   300002 236100                    LDQ     2,,PR3
        26 007511   000006 756100                    STQ     6,,PR0

  21471 26 007512   200012 473500                    LDP3    SYM$,,AUTO
        26 007513   300003 236100                    LDQ     3,,PR3
        26 007514   000003 676100                    ERQ     3,,PR0
        26 007515   040000 376003                    ANQ     16384,DU
        26 007516   000003 656100                    ERSQ    3,,PR0

     1918    21484    3        TYB_SYM$ ->CONST.ADSC.TA = %ADSC6;

  21484 26 007517   000001 236100                    LDQ     1,,PR0
        26 007520   000073 376000 27                 ANQ     59
        26 007521   020000 276007                    ORQ     8192,DL
        26 007522   000001 756100                    STQ     1,,PR0

     1919    21485    3        TYB_SYM$ -> CONST.ADSC.N = CONSTANT_LENGTH;

  21485 26 007523   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 007524   000001 752103                    STCQ    1,'03'O,PR0
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:331  

     1920    21486             %GET_CONSTANT_ADDRESS (@CONSTANT = SYM$,
     1921    21487                                    @STRING   = TYA_CONST$);

  21489 26 007525   200012 473500                    LDP3    SYM$,,AUTO
        26 007526   300003 234100                    SZN     3,,PR3
        26 007527   007534 605000 26                 TPL     s:21492

  21490 26 007530   300010 474500                    LDP4    8,,PR3
        26 007531   400001 635500                    EPPR5   1,,PR4
        26 007532   200112 455500                    STP5    TYA_CONST$,,AUTO
        26 007533   007537 710000 26                 TRA     s:21495

  21492 26 007534   200012 236100                    LDQ     SYM$,,AUTO
        26 007535   000010 036003                    ADLQ    8,DU
        26 007536   200112 756100                    STQ     TYA_CONST$,,AUTO

     1922    21495    3        IF REC_LENGTH <= 12 THEN

  21495 26 007537   200043 235100                    LDA     REC_LENGTH,,AUTO
        26 007540   000014 115007                    CMPA    12,DL
        26 007541   007557 605400 26                 TPNZ    s:21506

     1923    21496    4          DO;

     1924    21497    4            CALL XLATE_9_TO_6 (TYB_SYM$ -> CONST.CONSTB, GBCD, TYA_CONST$ ->
             21497                     CONST_SYMBOL);

  21497 26 007542   200112 474500                    LDP4    TYA_CONST$,,AUTO
        26 007543   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 007544   040100 160540                    MVT     fill='040'O
        26 007545   400000 000012                    ADSC9   0,,PR4                   cn=0,n=*X2
        26 007546   000010 020014                    ADSC6   8,,PR0                   cn=0,n=12
        26 007547   000000 000000 xsym               ARG     GBCD

     1925    21498    4            IF REC_LENGTH > 6 THEN

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:332  
  21498 26 007550   000006 115007                    CMPA    6,DL
        26 007551   007634 604400 26                 TMOZ    s:21598

     1926    21499    5              DO;

     1927    21500    5                TYB_SYM$ -> CONST.B.MOD_2 = TRUE;

  21500 26 007552   100000 236003                    LDQ     32768,DU
        26 007553   000003 256100                    ORSQ    3,,PR0

     1928    21501    5                TYB_SYM$ -> CONST.B.TWO_WORD = TRUE;

  21501 26 007554   200000 236003                    LDQ     65536,DU
        26 007555   000003 256100                    ORSQ    3,,PR0

     1929    21502    5              END;

     1930    21503    4          END;

  21503 26 007556   007634 710000 26                 TRA     s:21598

     1931    21504    3        ELSE
     1932    21505    4          DO;

     1933    21506    4            CONST_BITS = CONSTANT_LENGTH * 6;

  21506 26 007557   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 007560   000006 402007                    MPY     6,DL
        26 007561   200111 756100                    STQ     CONST_BITS,,AUTO

     1934    21507    4            ITERATION = (CONSTANT_LENGTH + 11) / 6;

  21507 26 007562   200007 236100                    LDQ     CONSTANT_LENGTH,,AUTO
        26 007563   000013 036007                    ADLQ    11,DL
        26 007564   000006 506007                    DIV     6,DL
        26 007565   000000 756000 0                  STQ     ITERATION

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:333  
     1935    21508                 %RESERVE_LTS (ITEM=%LCNST, POINTER=LTSS$);

  21584 26 007566   000002 036000 2                  ADLQ    LTS_+2
        26 007567   000003 116000 2                  CMPQ    LTS_+3
        26 007570   007601 604000 26                 TMI     s:21586

  21585 26 007571   000041 236000 27                 LDQ     33
        26 007572   200152 756100                    STQ     I+1,,AUTO
        26 007573   200152 634500                    EPPR4   I+1,,AUTO
        26 007574   200153 454500                    STP4    I+2,,AUTO
        26 007575   200153 630500                    EPPR0   I+2,,AUTO
        26 007576   000006 631400 27                 EPPR1   6
        26 007577   000000 701000 xent               TSX1    Z8AR$RESERVER
        26 007600   000000 011000                    NOP     0

  21586 26 007601   000002 236000 2                  LDQ     LTS_+2
        26 007602   000022 736000                    QLS     18
        26 007603   000001 036000 2                  ADLQ    LTS_+1
        26 007604   200015 756100                    STQ     LTSS$,,AUTO

  21587 26 007605   000002 236000 2                  LDQ     LTS_+2
        26 007606   000000 036000 0                  ADLQ    ITERATION
        26 007607   000002 756000 2                  STQ     LTS_+2

  21588 26 007610   001106 220003                    LDX0    582,DU
        26 007611   200015 470500                    LDP0    LTSS$,,AUTO
        26 007612   000000 740100                    STX0    0,,PR0

  21590 26 007613   000000 721000 0                  LXL1    ITERATION
        26 007614   000000 441100                    SXL1    0,,PR0

     1936    21594    4            CALL XLATE_9_TO_6 (LTSS$ -> BCD_LCNST.BCD_CONST, GBCD, TYA_CONST$ ->
             21594                     CONST_SYMBOL);

  21594 26 007615   200111 236100                    LDQ     CONST_BITS,,AUTO
        26 007616   000001 772000                    QRL     1
        26 007617   000003 506007                    DIV     3,DL
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:334  
        26 007620   200112 471500                    LDP1    TYA_CONST$,,AUTO
        26 007621   200007 722100                    LXL2    CONSTANT_LENGTH,,AUTO
        26 007622   000000 623006                    EAX3    0,QL
        26 007623   040140 160540                    MVT     fill='040'O
        26 007624   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
        26 007625   000001 020013                    ADSC6   1,,PR0                   cn=0,n=*X3
        26 007626   000000 000000 xsym               ARG     GBCD

     1937    21595    4            TYB_SYM$ -> CONST.CONST$.PTR$ = LTSS$;

  21595 26 007627   200015 236100                    LDQ     LTSS$,,AUTO
        26 007630   200110 473500                    LDP3    TYB_SYM$,,AUTO
        26 007631   300010 756100                    STQ     8,,PR3

     1938    21596    4            TYB_SYM$ -> CONST.B.LONG_CONSTANT = TRUE;

  21596 26 007632   400000 236003                    LDQ     -131072,DU
        26 007633   300003 256100                    ORSQ    3,,PR3

     1939    21597    4          END;

     1940    21598    3        SYM$ = TYB_SYM$;

  21598 26 007634   200110 236100                    LDQ     TYB_SYM$,,AUTO
        26 007635   200012 756100                    STQ     SYM$,,AUTO

     1941    21599    3      END;

     1942    21600    2   END CREATE_TYB_WITH_TYPE_DESC;

  21600 26 007636   200106 221300                    LDX1  ! NUM_DESC+6,,AUTO
        26 007637   000001 702211                    TSX2  ! 1,X1

     1943    21601        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:335  
     1944    21602    1   CREATE_TYM_CONSTANT: PROC;

  21602 26 007640   200110 741300       CREATE_TYM_* STX1  ! TYB_SYM$,,AUTO

     1945    21603
     1946    21604             %NEW_CONST (@ST$    = SYM$,
     1947    21605                         @TYPE   = %TYM);

  21609 26 007641   000002 236000 4                  LDQ     ST_+2
        26 007642   000013 036007                    ADLQ    11,DL
        26 007643   000003 116000 4                  CMPQ    ST_+3
        26 007644   007655 604000 26                 TMI     s:21611

  21610 26 007645   000022 236000 27                 LDQ     18
        26 007646   200152 756100                    STQ     I+1,,AUTO
        26 007647   200152 630500                    EPPR0   I+1,,AUTO
        26 007650   200153 450500                    STP0    I+2,,AUTO
        26 007651   200153 630500                    EPPR0   I+2,,AUTO
        26 007652   000006 631400 27                 EPPR1   6
        26 007653   000000 701000 xent               TSX1    Z8AR$RESERVER
        26 007654   000000 011000                    NOP     0

  21611 26 007655   000002 236000 4                  LDQ     ST_+2
        26 007656   000022 736000                    QLS     18
        26 007657   000001 036000 4                  ADLQ    ST_+1
        26 007660   200012 756100                    STQ     SYM$,,AUTO

  21612 26 007661   000013 236007                    LDQ     11,DL
        26 007662   000002 056000 4                  ASQ     ST_+2

  21615 26 007663   000767 220003                    LDX0    503,DU
        26 007664   200012 470500                    LDP0    SYM$,,AUTO
        26 007665   000000 740100                    STX0    0,,PR0

  21616 26 007666   200012 470500                    LDP0    SYM$,,AUTO
        26 007667   001000 236007                    LDQ     512,DL
        26 007670   000000 552110                    STBQ    0,'10'O,PR0
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:336  

  21617 26 007671   200012 470500                    LDP0    SYM$,,AUTO
        26 007672   000126 236000 xsym               LDQ     O1COM+86
        26 007673   000000 552104                    STBQ    0,'04'O,PR0

  21618 26 007674   000021 221003                    LDX1    17,DU
        26 007675   200012 470500                    LDP0    SYM$,,AUTO
        26 007676   000002 741100                    STX1    2,,PR0

  21619 26 007677   200012 470500                    LDP0    SYM$,,AUTO
        26 007700   000003 450100                    STZ     3,,PR0

  21620 26 007701   000001 236000 27                 LDQ     1
        26 007702   200012 470500                    LDP0    SYM$,,AUTO
        26 007703   000004 756100                    STQ     4,,PR0

  21621 26 007704   200012 470500                    LDP0    SYM$,,AUTO
        26 007705   000005 756100                    STQ     5,,PR0

  21622 26 007706   200012 470500                    LDP0    SYM$,,AUTO
        26 007707   000006 756100                    STQ     6,,PR0

     1948    21646    2        SYM$ -> CONST.ADSC.N = PIC_OUT.MOP_L;

  21646 26 007710   200012 470500                    LDP0    SYM$,,AUTO
        26 007711   000005 236000 18                 LDQ     PIC_OUT+5
        26 007712   000001 752103                    STCQ    1,'03'O,PR0

     1949    21647    2        SYM$ -> CONST.NEXT  = PIC_DNT$ -> DNT.ST$;

  21647 26 007713   200004 470500                    LDP0    @CONST$,,AUTO
        26 007714   000000 471500                    LDP1    0,,PR0
        26 007715   100001 236100                    LDQ     1,,PR1
        26 007716   200012 473500                    LDP3    SYM$,,AUTO
        26 007717   300004 756100                    STQ     4,,PR3

     1950    21648    2        SYM$ -> CONST.DNT$  = PIC_DNT$;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:337  

  21648 26 007720   000000 236100                    LDQ     0,,PR0
        26 007721   200012 471500                    LDP1    SYM$,,AUTO
        26 007722   100006 756100                    STQ     6,,PR1

     1951    21649    2        PIC_DNT$ -> DNT.ST$ = SYM$;

  21649 26 007723   000000 471500                    LDP1    0,,PR0
        26 007724   200012 236100                    LDQ     SYM$,,AUTO
        26 007725   100001 756100                    STQ     1,,PR1

     1952    21650
     1953    21651    2        IF PIC_OUT.MOP_L > 8 THEN

  21651 26 007726   000005 722000 18                 LXL2    PIC_OUT+5
        26 007727   000011 102003                    CMPX2   9,DU
        26 007730   010002 602000 26                 TNC     s:21750

     1954    21652               %ENTER_9BIT_CONSTANT_GTR_8_DIGITS
     1955    21653                      (@CONSTANT = "SUBSTR(PIC_OUT.MOPSTR, 0, PIC_OUT.MOP_L)",
     1956    21654                       @LENGTH   = PIC_OUT.MOP_L);

  21656 26 007731   000005 236000 18                 LDQ     PIC_OUT+5
        26 007732   777777 376007                    ANQ     -1,DL
        26 007733   000003 036007                    ADLQ    3,DL
        26 007734   000002 772000                    QRL     2
        26 007735   000001 036007                    ADLQ    1,DL
        26 007736   000000 756000 0                  STQ     ITERATION

  21733 26 007737   000002 036000 2                  ADLQ    LTS_+2
        26 007740   000003 116000 2                  CMPQ    LTS_+3
        26 007741   007752 604000 26                 TMI     s:21735

  21734 26 007742   000041 236000 27                 LDQ     33
        26 007743   200152 756100                    STQ     I+1,,AUTO
        26 007744   200152 631500                    EPPR1   I+1,,AUTO
        26 007745   200153 451500                    STP1    I+2,,AUTO
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:338  
        26 007746   200153 630500                    EPPR0   I+2,,AUTO
        26 007747   000006 631400 27                 EPPR1   6
        26 007750   000000 701000 xent               TSX1    Z8AR$RESERVER
        26 007751   000000 011000                    NOP     0

  21735 26 007752   000002 236000 2                  LDQ     LTS_+2
        26 007753   000022 736000                    QLS     18
        26 007754   000001 036000 2                  ADLQ    LTS_+1
        26 007755   200015 756100                    STQ     LTSS$,,AUTO

  21736 26 007756   000002 236000 2                  LDQ     LTS_+2
        26 007757   000000 036000 0                  ADLQ    ITERATION
        26 007760   000002 756000 2                  STQ     LTS_+2

  21737 26 007761   001106 220003                    LDX0    582,DU
        26 007762   200015 470500                    LDP0    LTSS$,,AUTO
        26 007763   000000 740100                    STX0    0,,PR0

  21739 26 007764   000000 721000 0                  LXL1    ITERATION
        26 007765   000000 441100                    SXL1    0,,PR0

  21743 26 007766   000005 722000 18                 LXL2    PIC_OUT+5
        26 007767   000005 723000 18                 LXL3    PIC_OUT+5
        26 007770   040140 100440                    MLR     fill='040'O
        26 007771   000006 000013 18                 ADSC9   PIC_OUT+6                cn=0,n=*X3
        26 007772   000001 000012                    ADSC9   1,,PR0                   cn=0,n=*X2

  21744 26 007773   200015 236100                    LDQ     LTSS$,,AUTO
        26 007774   200012 471500                    LDP1    SYM$,,AUTO
        26 007775   100010 756100                    STQ     8,,PR1

  21745 26 007776   200012 471500                    LDP1    SYM$,,AUTO
        26 007777   400000 236003                    LDQ     -131072,DU
        26 010000   100003 256100                    ORSQ    3,,PR1

  21746 26 010001   010020 710000 26                 TRA     s:21762

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:339  
     1957    21748    2        ELSE
     1958    21749    3          DO;

     1959    21750    3            SUBSTR (SYM$ -> CONST.CONSTA,

  21750 26 010002   000005 723000 18                 LXL3    PIC_OUT+5
        26 010003   200012 471500                    LDP1    SYM$,,AUTO
        26 010004   040140 100440                    MLR     fill='040'O
        26 010005   000006 000013 18                 ADSC9   PIC_OUT+6                cn=0,n=*X3
        26 010006   100010 000012                    ADSC9   8,,PR1                   cn=0,n=*X2

     1960    21751    3                    0,
     1961    21752    3                    PIC_OUT.MOP_L)       = SUBSTR (PIC_OUT.MOPSTR,
     1962    21753    3                                                   0,
     1963    21754    3                                                   PIC_OUT.MOP_L);
     1964    21755    3            IF PIC_OUT.MOP_L > 4 THEN

  21755 26 010007   000005 722000 18                 LXL2    PIC_OUT+5
        26 010010   000005 102003                    CMPX2   5,DU
        26 010011   010020 602000 26                 TNC     s:21762

     1965    21756    4              DO;

     1966    21757    4                SYM$ -> CONST.B.TWO_WORD = TRUE;

  21757 26 010012   200012 471500                    LDP1    SYM$,,AUTO
        26 010013   200000 236003                    LDQ     65536,DU
        26 010014   100003 256100                    ORSQ    3,,PR1

     1967    21758    4                SYM$ -> CONST.B.MOD_2    = TRUE;

  21758 26 010015   200012 471500                    LDP1    SYM$,,AUTO
        26 010016   100000 236003                    LDQ     32768,DU
        26 010017   100003 256100                    ORSQ    3,,PR1

     1968    21759    4              END;

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:340  
     1969    21760    3          END;

     1970    21761
     1971    21762    2   END CREATE_TYM_CONSTANT; /* Proc */

  21762 26 010020   200110 221300                    LDX1  ! TYB_SYM$,,AUTO
        26 010021   000001 702211                    TSX2  ! 1,X1

     1972    21763        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:341  
     1973    21764    1   CREATE_WITHOUT_TYPE_DESC: PROC (TO_TYPE) ;

  21764 26 010022   200106 741300       CREATE_WITH* STX1  ! NUM_DESC+6,,AUTO

     1974    21765
     1975    21766    2   DCL TO_TYPE            SBIN WORD;
     1976    21767
     1977    21768    3      DO CASE (TO_TYPE);

  21768 26 010023   200107 470500                    LDP0    @TO_TYPE,,AUTO
        26 010024   000000 235100                    LDA     0,,PR0
        26 010025   000022 115007                    CMPA    18,DL
        26 010026   010030 602005 26                 TNC     s:21768+5,AL
        26 010027   010121 710000 26                 TRA     s:21809
        26 010030   010066 710000 26                 TRA     s:21782
        26 010031   010074 710000 26                 TRA     s:21788
        26 010032   010077 710000 26                 TRA     s:21791
        26 010033   010105 710000 26                 TRA     s:21797
        26 010034   010113 710000 26                 TRA     s:21803
        26 010035   010110 710000 26                 TRA     s:21800
        26 010036   010055 710000 26                 TRA     s:21773
        26 010037   010071 710000 26                 TRA     s:21785
        26 010040   010052 710000 26                 TRA     s:21770
        26 010041   010121 710000 26                 TRA     s:21809
        26 010042   010121 710000 26                 TRA     s:21809
        26 010043   010060 710000 26                 TRA     s:21776
        26 010044   010063 710000 26                 TRA     s:21779
        26 010045   010121 710000 26                 TRA     s:21809
        26 010046   010052 710000 26                 TRA     s:21770
        26 010047   010102 710000 26                 TRA     s:21794
        26 010050   010121 710000 26                 TRA     s:21809
        26 010051   010116 710000 26                 TRA     s:21806

     1978    21769    3        CASE (%TYA, %TYN);

     1979    21770    3          CALL CREATE_TYA_CONSTANT;

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:342  
  21770 26 010052   005232 701000 26                 TSX1    CREATE_TYA_CONSTANT
        26 010053   000000 011000                    NOP     0
        26 010054   010135 710000 26                 TRA     s:21815

     1980    21771
     1981    21772    3        CASE (%TYE);

     1982    21773    3          CALL CREATE_TYE_CONSTANT;

  21773 26 010055   005545 701000 26                 TSX1    CREATE_TYE_CONSTANT
        26 010056   000000 011000                    NOP     0
        26 010057   010135 710000 26                 TRA     s:21815

     1983    21774
     1984    21775    3        CASE (%TYF);

     1985    21776    3          CALL CREATE_TYF_CONSTANT;

  21776 26 010060   004622 701000 26                 TSX1    CREATE_TYF_CONSTANT
        26 010061   000000 011000                    NOP     0
        26 010062   010135 710000 26                 TRA     s:21815

     1986    21777
     1987    21778    3        CASE (%TYB);

     1988    21779    3          CALL CREATE_TYB_CONSTANT;

  21779 26 010063   005767 701000 26                 TSX1    CREATE_TYB_CONSTANT
        26 010064   000000 011000                    NOP     0
        26 010065   010135 710000 26                 TRA     s:21815

     1989    21780
     1990    21781    3        CASE (%TYD);

     1991    21782    3          CALL CREATE_TYD_CONSTANT;

  21782 26 010066   002564 701000 26                 TSX1    CREATE_TYD_CONSTANT
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:343  
        26 010067   000000 011000                    NOP     0
        26 010070   010135 710000 26                 TRA     s:21815

     1992    21783
     1993    21784    3        CASE (%TYH);

     1994    21785    3          CALL CREATE_TYH_CONSTANT;

  21785 26 010071   003471 701000 26                 TSX1    CREATE_TYH_CONSTANT
        26 010072   000000 011000                    NOP     0
        26 010073   010135 710000 26                 TRA     s:21815

     1995    21786
     1996    21787    3        CASE (%TYI);

     1997    21788    3          CALL CREATE_TYI_CONSTANT;

  21788 26 010074   003362 701000 26                 TSX1    CREATE_TYI_CONSTANT
        26 010075   000000 011000                    NOP     0
        26 010076   010135 710000 26                 TRA     s:21815

     1998    21789
     1999    21790    3        CASE (%TYJ);

     2000    21791    3          CALL CREATE_TYJ_CONSTANT;

  21791 26 010077   003555 701000 26                 TSX1    CREATE_TYJ_CONSTANT
        26 010100   000000 011000                    NOP     0
        26 010101   010135 710000 26                 TRA     s:21815

     2001    21792
     2002    21793    3        CASE (%TYK);

     2003    21794    3          CALL CREATE_TYK_CONSTANT;

  21794 26 010102   003651 701000 26                 TSX1    CREATE_TYK_CONSTANT
        26 010103   000000 011000                    NOP     0
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:344  
        26 010104   010135 710000 26                 TRA     s:21815

     2004    21795
     2005    21796    3        CASE (%TYO);

     2006    21797    3          CALL CREATE_TYO_CONSTANT;

  21797 26 010105   004243 701000 26                 TSX1    CREATE_TYO_CONSTANT
        26 010106   000000 011000                    NOP     0
        26 010107   010135 710000 26                 TRA     s:21815

     2007    21798
     2008    21799    3        CASE (%TYQ);

     2009    21800    3          CALL CREATE_TYQ_CONSTANT;

  21800 26 010110   003745 701000 26                 TSX1    CREATE_TYQ_CONSTANT
        26 010111   000000 011000                    NOP     0
        26 010112   010135 710000 26                 TRA     s:21815

     2010    21801
     2011    21802    3        CASE (%TYR);

     2012    21803    3          CALL CREATE_TYR_CONSTANT;

  21803 26 010113   004107 701000 26                 TSX1    CREATE_TYR_CONSTANT
        26 010114   000000 011000                    NOP     0
        26 010115   010135 710000 26                 TRA     s:21815

     2013    21804
     2014    21805    3        CASE(%TYM);

     2015    21806    3          CALL CREATE_TYM_CONSTANT;

  21806 26 010116   007640 701000 26                 TSX1    CREATE_TYM_CONSTANT
        26 010117   000000 011000                    NOP     0
        26 010120   010135 710000 26                 TRA     s:21815
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:345  

     2016    21807
     2017    21808    3        CASE (ELSE);

     2018    21809    3          CALL Z8AE$ERROR (%E$UNEXPECTED_CASE,

  21809 26 010121   200004 471500                    LDP1    @CONST$,,AUTO
        26 010122   100000 473500                    LDP3    0,,PR1
        26 010123   300006 634500                    EPPR4   6,,PR3
        26 010124   200154 454500                    STP4    I+3,,AUTO
        26 010125   300005 635500                    EPPR5   5,,PR3
        26 010126   200153 455500                    STP5    I+2,,AUTO
        26 010127   000010 236000 27                 LDQ     8
        26 010130   200152 756100                    STQ     I+1,,AUTO
        26 010131   200152 630500                    EPPR0   I+1,,AUTO
        26 010132   000005 631400 27                 EPPR1   5
        26 010133   000000 701000 xent               TSX1    Z8AE$ERROR
        26 010134   000000 011000                    NOP     0

     2019    21810    3                           CONST$ -> LX_TERMINAL.LINE,
     2020    21811    3                           CONST$ -> LX_TERMINAL.COLUMN);
     2021    21812
     2022    21813    3      END; /* Case -- const_type */

     2023    21814
     2024    21815    2   END CREATE_WITHOUT_TYPE_DESC;

  21815 26 010135   200106 221300                    LDX1  ! NUM_DESC+6,,AUTO
        26 010136   000001 702211                    TSX2  ! 1,X1

     2025    21816        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:346  
     2026    21817        /*
     2027    21818               Main Body
     2028    21819        */
     2029    21820
     2030    21821    1      NEW_ST = FALSE;                                     /*#28636*/

  21821 26 010137   200040 450100                    STZ     NEW_ST,,AUTO

     2031    21822    1      TO_TYPE = TYPE_DESC.TYPE;

  21822 26 010140   200003 470500                    LDP0    @TYPE_DESC,,AUTO
        26 010141   000000 235100                    LDA     0,,PR0
        26 010142   200006 755100                    STA     TO_TYPE,,AUTO

     2032    21823    1      VALUE_OVERFLOW = FALSE;

  21823 26 010143   200041 450100                    STZ     VALUE_OVERFLOW,,AUTO

     2033    21824    1      DNT$$ = CONST$ -> LX_ITEM.DNT$;

  21824 26 010144   200004 471500                    LDP1    @CONST$,,AUTO
        26 010145   100000 473500                    LDP3    0,,PR1
        26 010146   300002 236100                    LDQ     2,,PR3
        26 010147   200016 756100                    STQ     DNT$$,,AUTO

     2034    21825
     2035    21826    2      DO CASE (TYPE_DESC.TYPE);

  21826 26 010150   000000 235100                    LDA     0,,PR0
        26 010151   000022 115007                    CMPA    18,DL
        26 010152   010154 602005 26                 TNC     s:21826+4,AL
        26 010153   010241 710000 26                 TRA     s:21850
        26 010154   010227 710000 26                 TRA     s:21844
        26 010155   010176 710000 26                 TRA     s:21829
        26 010156   010176 710000 26                 TRA     s:21829
        26 010157   010234 710000 26                 TRA     s:21847
        26 010160   010176 710000 26                 TRA     s:21829
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:347  
        26 010161   010176 710000 26                 TRA     s:21829
        26 010162   010210 710000 26                 TRA     s:21835
        26 010163   010176 710000 26                 TRA     s:21829
        26 010164   010203 710000 26                 TRA     s:21832
        26 010165   010241 710000 26                 TRA     s:21850
        26 010166   010241 710000 26                 TRA     s:21850
        26 010167   010215 710000 26                 TRA     s:21838
        26 010170   010222 710000 26                 TRA     s:21841
        26 010171   010241 710000 26                 TRA     s:21850
        26 010172   010203 710000 26                 TRA     s:21832
        26 010173   010176 710000 26                 TRA     s:21829
        26 010174   010241 710000 26                 TRA     s:21850
        26 010175   010176 710000 26                 TRA     s:21829

     2036    21827
     2037    21828    2        CASE (%TYH, %TYI, %TYJ, %TYK, %TYR, %TYQ, %TYM);

     2038    21829    2          CALL CREATE_WITHOUT_TYPE_DESC (TO_TYPE) ;

  21829 26 010176   200006 633500                    EPPR3   TO_TYPE,,AUTO
        26 010177   200107 453500                    STP3    NUM_DESC+7,,AUTO
        26 010200   010022 701000 26                 TSX1    CREATE_WITHOUT_TYPE_DESC
        26 010201   000000 011000                    NOP     0
        26 010202   010254 710000 26                 TRA     s:21856

     2039    21830
     2040    21831    2        CASE (%TYA, %TYN); /* Alphanumeric or Kanji */

     2041    21832    2          CALL CREATE_TYA_WITH_TYPE_DESC (TYPE_DESC) ;

  21832 26 010203   200003 236100                    LDQ     @TYPE_DESC,,AUTO
        26 010204   200115 756100                    STQ     OVERPUNCH_SIGN+1,,AUTO
        26 010205   006222 701000 26                 TSX1    CREATE_TYA_WITH_TYPE_DESC
        26 010206   000000 011000                    NOP     0
        26 010207   010254 710000 26                 TRA     s:21856

     2042    21833
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:348  
     2043    21834    2        CASE (%TYE);

     2044    21835    2          CALL CREATE_TYE_WITH_TYPE_DESC (TYPE_DESC) ;

  21835 26 010210   200003 236100                    LDQ     @TYPE_DESC,,AUTO
        26 010211   200107 756100                    STQ     NUM_DESC+7,,AUTO
        26 010212   007075 701000 26                 TSX1    CREATE_TYE_WITH_TYPE_DESC
        26 010213   000000 011000                    NOP     0
        26 010214   010254 710000 26                 TRA     s:21856

     2045    21836
     2046    21837    2        CASE (%TYF);

     2047    21838    2          CALL CREATE_TYF_WITH_TYPE_DESC (TYPE_DESC) ;

  21838 26 010215   200003 236100                    LDQ     @TYPE_DESC,,AUTO
        26 010216   200107 756100                    STQ     NUM_DESC+7,,AUTO
        26 010217   005030 701000 26                 TSX1    CREATE_TYF_WITH_TYPE_DESC
        26 010220   000000 011000                    NOP     0
        26 010221   010254 710000 26                 TRA     s:21856

     2048    21839
     2049    21840    2        CASE (%TYB);

     2050    21841    2          CALL CREATE_TYB_WITH_TYPE_DESC (TYPE_DESC) ;

  21841 26 010222   200003 236100                    LDQ     @TYPE_DESC,,AUTO
        26 010223   200107 756100                    STQ     NUM_DESC+7,,AUTO
        26 010224   007354 701000 26                 TSX1    CREATE_TYB_WITH_TYPE_DESC
        26 010225   000000 011000                    NOP     0
        26 010226   010254 710000 26                 TRA     s:21856

     2051    21842
     2052    21843    2        CASE (%TYD);

     2053    21844    2          CALL CREATE_TYD_WITH_TYPE_DESC (TYPE_DESC) ;

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:349  
  21844 26 010227   200003 236100                    LDQ     @TYPE_DESC,,AUTO
        26 010230   200107 756100                    STQ     NUM_DESC+7,,AUTO
        26 010231   003317 701000 26                 TSX1    CREATE_TYD_WITH_TYPE_DESC
        26 010232   000000 011000                    NOP     0
        26 010233   010254 710000 26                 TRA     s:21856

     2054    21845
     2055    21846    2        CASE (%TYO);

     2056    21847    2          CALL CREATE_TYO_WITH_TYPE_DESC (TYPE_DESC) ;

  21847 26 010234   200003 236100                    LDQ     @TYPE_DESC,,AUTO
        26 010235   200107 756100                    STQ     NUM_DESC+7,,AUTO
        26 010236   004427 701000 26                 TSX1    CREATE_TYO_WITH_TYPE_DESC
        26 010237   000000 011000                    NOP     0
        26 010240   010254 710000 26                 TRA     s:21856

     2057    21848
     2058    21849    2        CASE (ELSE);

     2059    21850    2          CALL Z8AE$ERROR (%E$UNEXPECTED_CASE,

  21850 26 010241   100000 473500                    LDP3    0,,PR1
        26 010242   300006 634500                    EPPR4   6,,PR3
        26 010243   200154 454500                    STP4    I+3,,AUTO
        26 010244   300005 635500                    EPPR5   5,,PR3
        26 010245   200153 455500                    STP5    I+2,,AUTO
        26 010246   000010 236000 27                 LDQ     8
        26 010247   200152 756100                    STQ     I+1,,AUTO
        26 010250   200152 630500                    EPPR0   I+1,,AUTO
        26 010251   000005 631400 27                 EPPR1   5
        26 010252   000000 701000 xent               TSX1    Z8AE$ERROR
        26 010253   000000 011000                    NOP     0

     2060    21851    2                           CONST$ -> LX_TERMINAL.LINE,
     2061    21852    2                           CONST$ -> LX_TERMINAL.COLUMN);
     2062    21853
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:350  
     2063    21854    2      END; /* Case */

     2064    21855
     2065    21856    1      CALL WRAP_UP;

  21856 26 010254   002374 701000 26                 TSX1    WRAP_UP
        26 010255   000000 011000                    NOP     0

     2066    21857
     2067    21858    1      IF VALUE_OVERFLOW THEN

  21858 26 010256   200041 234100                    SZN     VALUE_OVERFLOW,,AUTO
        26 010257   010261 605000 26                 TPL     s:21861

     2068    21859    1        ALTRETURN;

  21859 26 010260   000000 702200 xent               TSX2  ! X66_AALT

     2069    21860
     2070    21861    1      RETURN;

  21861 26 010261   000000 702200 xent               TSX2  ! X66_ARET

     2071    21862
     2072    21863        %EJECT;
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:351  
     2073    21864    1   Z8EC$CREATE_CONST: ENTRY (TYPE_DESC, CONST$, RTN$) ALTRET;

  21864 26 010262   000000 700200 xent  Z8EC$CREATE* TSX0  ! X66_AUTO_3
        26 010263   000164 000003                    ZERO    116,3

     2074    21865
     2075    21866        /*
     2076    21867             The parameter TYPE_DESC is misleading.  It is done
     2077    21868             that way because PL/6 requires the same names on all
     2078    21869             entry points.  It really refers to only a type passed
     2079    21870             in, see the declaration.
     2080    21871        */
     2081    21872
     2082    21873    1    TO_TYPE = CONST_.TYPE;

  21873 26 010264   200003 470500                    LDP0    @TYPE_DESC,,AUTO
        26 010265   000000 235100                    LDA     0,,PR0
        26 010266   200006 755100                    STA     TO_TYPE,,AUTO

     2083    21874    1    NEW_ST = FALSE;                                       /*#28636*/

  21874 26 010267   200040 450100                    STZ     NEW_ST,,AUTO

     2084    21875
     2085    21876    1    VALUE_OVERFLOW = FALSE;

  21876 26 010270   200041 450100                    STZ     VALUE_OVERFLOW,,AUTO

     2086    21877
     2087    21878    1    DNT$$ = CONST$ -> LX_ITEM.DNT$;

  21878 26 010271   200004 471500                    LDP1    @CONST$,,AUTO
        26 010272   100000 473500                    LDP3    0,,PR1
        26 010273   300002 236100                    LDQ     2,,PR3
        26 010274   200016 756100                    STQ     DNT$$,,AUTO

     2088    21879
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:352  
     2089    21880    1    CALL CREATE_WITHOUT_TYPE_DESC (TO_TYPE) ;

  21880 26 010275   200006 633500                    EPPR3   TO_TYPE,,AUTO
        26 010276   200107 453500                    STP3    NUM_DESC+7,,AUTO
        26 010277   010022 701000 26                 TSX1    CREATE_WITHOUT_TYPE_DESC
        26 010300   000000 011000                    NOP     0

     2090    21881
     2091    21882    1    CALL WRAP_UP;

  21882 26 010301   002374 701000 26                 TSX1    WRAP_UP
        26 010302   000000 011000                    NOP     0

     2092    21883
     2093    21884    1    IF VALUE_OVERFLOW THEN

  21884 26 010303   200041 234100                    SZN     VALUE_OVERFLOW,,AUTO
        26 010304   010306 605000 26                 TPL     s:21887

     2094    21885    1      ALTRETURN;

  21885 26 010305   000000 702200 xent               TSX2  ! X66_AALT

     2095    21886
     2096    21887    1   END Z8EC$NEW_CONST_WITH_TYPE_DESC ; /* Proc */

  21887 26 010306   000000 702200 xent               TSX2  ! X66_ARET
     2097    21888        %EOD;

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:353  
--  Include file information  --

   Z8D_PIC_PARM.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8E_TRANSLAT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9A_SUPP_MAC.:Z8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EC$NEW_CONST_WITH_TYPE_DESC.
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:354  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 ITERATION

  ****  Section 001 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 002 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 LTS_

  ****  Section 003 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 004 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ST_

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:355  
  ****  Section 005 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 006 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 007 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 008 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ETT_

  ****  Section 009 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 010 LblCom DNT_

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:356  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 DNT_

  ****  Section 011 LblCom DNT_BUCKET_NUMBER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 DNT_BUCKET_NUMBER

  ****  Section 012 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 DNT_OF_1$

  ****  Section 013 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAP$

  ****  Section 014 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 015 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:357  

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 016 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 017 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Section 018 LblCom PIC_OUT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(792)   r     1 PIC_OUT

  ****  Section 019 RoData Z8EC$NEW_CONST_WITH_TYPE_DESC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   206-0-0/c CHAR        r     1 CONSTANT_ONE             207-0-0/c CHAR        r     1 CONSTANT_ZERO
     0-0-0/b UBIN(9)     r     1 DIGIT_TABLE(0:511)
   203-0-0/c CHAR        r     1 NEGATIVE_OVERPUNCH_VECTOR(0:9)
   200-0-0/c CHAR        r     1 POSITIVE_OVERPUNCH_VECTOR(0:9)

  ****  Section 020 LblCom HIGH_VALUE_ST$

  ****  Scalars and arrays  ****
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:358  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 HIGH_VALUE_ST$

  ****  Section 021 LblCom LOW_VALUE_ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LOW_VALUE_ST$

  ****  Section 022 LblCom QUOTE_ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 QUOTE_ST$

  ****  Section 023 LblCom SPACE_ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 SPACE_ST$

  ****  Section 024 LblCom KANJI_SPACE_ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KANJI_SPACE_ST$

  ****  Section 025 LblCom ZERO_ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:359  
     0-0-0/w PTR         r     1 ZERO_ST$

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @CONST$                  124-0-0/w PTR         r     1 @DNT$
   124-0-0/w PTR         r     1 @DNT$$                   121-0-0/w PTR         r     1 @LEFT_LENGTH
   123-0-0/w PTR         r     1 @LT_DIGITS               115-0-0/w PTR         r     1 @N
   123-0-0/w PTR         r     1 @NUM_DESC                122-0-0/w PTR         r     1 @RIGHT_LENGTH
     5-0-0/w PTR         r     1 @RTN$                    124-0-0/w PTR         r     1 @RT_DIGITS
   120-0-0/w PTR         r     1 @S                       117-0-0/w PTR         r     1 @SF
   116-0-0/w PTR         r     1 @TN                      107-0-0/w PTR         r     1 @TO_TYPE
   123-0-0/w PTR         r     1 @TYPE                      3-0-0/w PTR         r     1 @TYPE_DESC
   115-0-0/w PTR         r     1 @TYPE_DESC               111-0-0/w PTR         r     1 @TYPE_DESC
   111-0-0/w PTR         r     1 @TYPE_DESC               107-0-0/w PTR         r     1 @TYPE_DESC
   107-0-0/w PTR         r     1 @TYPE_DESC               107-0-0/w PTR         r     1 @TYPE_DESC
   115-0-0/w PTR         r     1 @TYPE_DESC               107-0-0/w PTR         r     1 @TYPE_DESC
   107-0-0/w PTR         r     1 @TYPE_DESC               113-0-0/w PTR         r     1 @VALUE
    44-0-0/w SBIN        r     1 CHAR_POS                  55-0-0/w STRC        r     1 COMP_1
    55-0-0/w SBIN        r     1 COMP_1_WORD               55-0-0/w SBIN        r     1 COMP_2_WORD
    *0-0-0/w PTR         r     1 CONST$                     7-0-0/w SBIN        r     1 CONSTANT_LENGTH
   111-0-0/w BIT (2)     r     1 CONSTANT_S                10-0-0/w SBIN        r     1 CONSTANT_SF
    11-0-0/b BIT         r     1 CONSTANT_SIGNED           14-0-0/w PTR         r     1 CONSTANT_SYM$
   115-0-0/w UBIN        r     1 CONSTANT_TYPE            116-0-0/w UBIN        r     1 CONSTANT_TYPE
    *0-0-0/w STRC(144)   r     1 CONST_                   112-0-0/w UBIN        r     1 CONST_BITS
   111-0-0/w UBIN        r     1 CONST_BITS                56-0-0/w STRC        r     1 CONST_DESC
    56-0-0/w SBIN        r     1 CONST_DESC_WORD           60-0-0/c CHAR(63)    r     1 CONST_TEMP
    37-0-0/w SBIN        r     1 CONST_VALUE               *0-0-0/w PTR         r     1 DNT$
    16-0-0/w PTR         r     1 DNT$$                     *0-0-0/w PTR         r     1 DNT$$
   126-0-0/w SBIN        r     1 ENDING_POS               127-0-0/w SBIN        r     1 EXP_VALUE
    45-0-0/w SBIN        r     1 I                        120-0-0/w SBIN        r     1 I
   151-0-0/w SBIN        r     1 I                         46-0-0/w SBIN        r     1 INDX
    51-0-0/w SBIN        r     1 LEFT_LENGTH               *0-0-0/w SBIN        r     1 LEFT_LENGTH
    50-0-0/w SBIN        r     1 LEFT_STARTS              116-0-0/w UBIN        r     1 LENGTH
   121-0-0/w SBIN        r     1 LENGTH                    17-0-0/c CHAR(63)    r     1 LITERAL_SYMBOL
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:360  
    15-0-0/w PTR         r     1 LTSS$                     *0-0-0/w SBIN        r     1 LT_DIGITS
    *0-0-0/w SBIN        r     1 N                        110-0-0/w SBIN        r     1 N
    13-0-0/w PTR               1 NEL$                     130-0-0/w SBIN        r     1 NEW_SCALE
    40-0-0/b BIT         r     1 NEW_ST                   100-0-0/w STRC(216)   r     1 NUM_DESC
    *0-0-0/w STRC(216)   r     1 NUM_DESC                 113-0-0/w SBIN        r     1 OFFSET
   113-0-0/w SBIN        r     1 OFFSET                   114-0-0/c CHAR        r     1 OVERPUNCH_CHAR
   112-0-0/c CHAR        r     1 OVERPUNCH_CHAR           112-0-0/c CHAR        r     1 OVERPUNCH_CHAR
   113-0-0/c CHAR        r     1 OVERPUNCH_SIGN           114-0-0/c CHAR        r     1 OVERPUNCH_SIGN
   114-0-0/c CHAR        r     1 OVERPUNCH_SIGN            *0-0-0/w PTR         r     1 PIC_DNT$
    17-0-0/c STRC(567)   r     1 REAL_SYMBOL               43-0-0/w SBIN        r     1 REC_LENGTH
    52-0-0/w SBIN        r     1 RIGHT_LENGTH              *0-0-0/w SBIN        r     1 RIGHT_LENGTH
    53-0-0/w SBIN        r     1 RIGHT_STARTS              *0-0-0/w PTR         r     1 RTN$
    *0-0-0/w SBIN        r     1 RT_DIGITS                115-0-0/b BIT (2)     r     1 S
    *0-0-0/w BIT (2)     r     1 S                        111-0-0/w BIT (2)     r     1 S
   117-0-0/w SBIN        r     1 SCALE                     54-0-0/w SBIN        r     1 SCRATCH_LENGTH
    *0-0-0/w SBIN        r     1 SF                       112-0-0/w SBIN        r     1 SF
   125-0-0/w SBIN        r     1 STARTING_POS              12-0-0/w PTR         r     1 SYM$
    42-0-0/w SBIN        r     1 TBL_VALUE                 57-0-0/w STRC        r     1 TEMP_DESC
    57-0-0/w SBIN        r     1 TEMP_DESC_WORD           131-0-0/c CHAR(63)    r     1 TEMP_SYMBOL
    *0-0-0/w BIT         r     1 TN                       113-0-0/w BIT         r     1 TN
    47-0-0/w SBIN        r     1 TOTAL_ZEROS                6-0-0/w SBIN        r     1 TO_TYPE
    *0-0-0/w SBIN        r     1 TO_TYPE                  112-0-0/w PTR         r     1 TYA_CONST$
   113-0-0/w PTR         r     1 TYA_CONST$               111-0-0/w PTR         r     1 TYA_CONST$
   112-0-0/w PTR         r     1 TYA_CONST$               111-0-0/w PTR         r     1 TYB_SYM$
   110-0-0/w PTR         r     1 TYB_SYM$                 111-0-0/w PTR         r     1 TYE_SYM$
   110-0-0/w PTR         r     1 TYE_SYM$                  *0-0-0/w SBIN        r     1 TYPE
    *0-0-0/w STRC(144)   r     1 TYPE_DESC                 *0-0-0/w STRC(144)   r     1 TYPE_DESC
    *0-0-0/w STRC(144)   r     1 TYPE_DESC                 *0-0-0/w STRC(144)   r     1 TYPE_DESC
    *0-0-0/w STRC(144)   r     1 TYPE_DESC                 *0-0-0/w STRC(144)   r     1 TYPE_DESC
    *0-0-0/w STRC(144)   r     1 TYPE_DESC                 *0-0-0/w STRC(144)   r     1 TYPE_DESC
    *0-0-0/w STRC(144)   r     1 TYPE_DESC                 *0-0-0/w STRC(144)   r     1 TYPE_DESC
    *0-0-0/w SBIN        r     1 VALUE                     41-0-0/w BIT         r     1 VALUE_OVERFLOW

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:361  

     0-0-0/d STRC(13248)       1 COMCOM                     0-0-0/c STRC(9)     r     1 EBCDIC(0:511)
     0-0-0/c STRC(9)     r     1 GBCD(0:511)                0-0-0/c STRC(9)           1 HBCD(0:511)
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR
     0-0-0/w UBIN              1 LTS_STEP(0:37)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w STRC(396)         1 ALPHABET
     0-0-0/w STRC(144)         1 ALTER_LTS                  0-0-0/w STRC(3672)        1 ALT_KEY
     0-0-0/w STRC(36864)       1 ARGLIST                    0-0-0/w STRC(396)         1 ARRAY
     0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS           0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w ASTR        r     1 BCD_LCNST
     0-0-0/w ASTR        r     1 BCD_LCNST                  0-0-0/w STRC(288)         1 BINARY_OP
     0-0-0/w STRC(396)         1 BLOCK                      0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(396)         1 CD
     0-0-0/w STRC(288)         1 CD_LTS                     0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(396)         1 CLASS                      0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)   r     1 CONST
     0-0-0/c ACHR        r     1 CONST_SYMBOL               0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(540)         1 CONTROL_NAME_LTS           0-0-0/w STRC(1872)        1 COPY_FILE
     0-0-0/w STRC(396)         1 DB                         0-0-0/w STRC(396)         1 DCB_
     0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER         0-0-0/w STRC(252)         1 DEFERED_ID_TREE
     0-0-0/w STRC(288)         1 DEFERED_QUAL_ID            0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(108)         1 DEPENDING_SIZE
     0-0-0/w STRC(5472)        1 DIMS                       0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w STRC(396)         1 DML_ITEM                   0-0-0/w STRC(216)         1 DML_REC
     0-0-0/w ASTR(180)   r     1 DNT                        0-0-0/w STRC(180)   r     1 ETT
     0-0-0/w STRC(73836)       1 EVALUATE                   0-0-0/w STRC(396)         1 FD
PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:362  
     0-0-0/w STRC(1692)        1 FILE_LTS                   0-0-0/w STRC(288)         1 ILS_LIST
     0-0-0/w STRC(108)         1 INDEXES                    0-0-0/w STRC(360)         1 INIT_LTS
     0-0-0/w STRC(288)         1 INSPECT_1_STMT             0-0-0/w STRC(288)         1 INSPECT_2_STMT
     0-0-0/w STRC(288)         1 INSPECT_4_STMT             0-0-0/w STRC(396)         1 INTDEF
     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN           0-0-0/w STRC(144)         1 KEY
     0-0-0/w STRC(396)         1 LABEL                      0-0-0/w STRC(288)         1 LA_ITEM
     0-0-0/w STRC(36864) r     1 LCNST                      0-0-0/w STRC(72)          1 LONG
     0-0-0/w STRC        r     1 LTS                        0-0-0/w STRC(360)         1 LTSS
     0-0-0/w STRC(36936)       1 LTS_PTR_ARRAY              0-0-0/w STRC(504)         1 LX_CD_INPUT
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)         1 LX_ETT_ITEM                0-0-0/w STRC(288)   r     1 LX_ITEM
     0-0-0/w STRC(288)         1 LX_LARGE                   0-0-0/w STRC(288)         1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
     0-0-0/w STRC(288)   r     1 LX_TERMINAL                0-0-0/w STRC(396)         1 MNEMONIC
     0-0-0/w STRC(288)         1 MULTIPLY_STMT              0-0-0/w STRC(144)         1 NEL
     0-0-0/w STRC(216)         1 OPEN_LTS                   0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(396)         1 PARA                       0-0-0/w STRC(144)         1 PRIME
     0-0-0/w STRC(396)   r     1 PROC_                      0-0-0/w STRC(396)         1 PROC_DEF
     0-0-0/w STRC(900)   r     1 PROC_SUPP                  0-0-0/w STRC(396)         1 RD
     0-0-0/w STRC(288)         1 READ_STMT                  0-0-0/w STRC(216)         1 REF
     0-0-0/w STRC(108)         1 RENAMES                    0-0-0/w STRC(720)         1 REPORT_01_LTS
     0-0-0/w STRC(432)         1 REPORT_ELEM_LTS            0-0-0/w STRC(252)         1 REPORT_GRP_LTS
     0-0-0/w STRC(1332)        1 REPORT_LTS                 0-0-0/w STRC(288)         1 REWRITE_STMT
     0-0-0/w STRC(144)         1 RVA_LTS                    0-0-0/w STRC(396)         1 SCALAR
     0-0-0/w STRC(396)         1 SD                         0-0-0/w STRC(396)         1 SECTION
     0-0-0/w STRC(396)         1 SEGMENT                    0-0-0/w STRC(360)         1 SEGMENT_LTS
     0-0-0/w STRC(396)   r     1 ST                         0-0-0/w STRC(288)         1 START_STMT
     0-0-0/w STRC(252)         1 STRING_STMT                0-0-0/w STRC(288)         1 SUBTRACT_STMT
     0-0-0/w STRC(252)         1 SUM_LTS                    0-0-0/w STRC(396)         1 SWITCH
     0-0-0/w STRC(396)   r     1 SYMBOLIC_CHAR              0-0-0/w STRC(396)         1 SYMDEF_
     0-0-0/w STRC(396)         1 SYMREF_                    0-0-0/w STRC(396)         1 TEMP
     0-0-0/w STRC(4608)        1 TRANS                      0-0-0/w STRC(288)         1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/d STRC(612)         1 USE
     0-0-0/w STRC(252)         1 USE_SUPP                   0-0-0/w STRC(396)         1 VARIABLE
     0-0-0/w STRC(288)         1 WRITE_STMT

PL6.E3A0      #001=Z8EC$NEW_CONST_WITH_TYPE_DESC File=Z8EC.:Z8A6TSI              SAT 08/09/97 11:45 Page:363  

   Procedure Z8EC$NEW_CONST_WITH_TYPE_DESC requires 4295 words for executable code.
   Procedure Z8EC$NEW_CONST_WITH_TYPE_DESC requires 116 words of local(AUTO) storage.

PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:364  
     2098        1        /*T***********************************************************/
     2099        2        /*T*                                                         */
     2100        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2101        4        /*T*                                                         */
     2102        5        /*T***********************************************************/
     2103        6        Z8EC$FLOAT: PROC (TEXT, LENGTH, TEMP_RESULT, VALUE_OVERFLOW );
     2104        7        /*D*
     2105        8                   NAME      : Z8EC$FLOAT &
     2106        9                               Z8EC$DOUBLE_FLOAT
     2107       10                   CALL      : CALL Z8EC$FLOAT (TEXT,LENGTH,TEMP_RESULT,VALUE_OVERFLOW);
     2108       11                                      -or-
     2109       12                            CALL Z8EC$DOUBLE_FLOAT (TEXT,LENGTH,TEMP_RESULT,VALUE_OVERFLOW);
     2110       13                   INTERFACE : X9DR$CVDR - conversion from decimal to single word real.
     2111       14                               X9DR$CVDQ - conversion from decimal to double word real.
     2112       15                               X9DR$CVDR_SMALL - conversion from decimal to single word
     2113       16                                                 with exponent < -128.
     2114       17                               X9DR$CVDQ_SMALL - conversion from decimal to double word
     2115       18                                                 with exponent < -128.
     2116       19                   INPUT     : REAL_DNT$ - pointer to the data name table entry
     2117       20                                           allowing access to the attributes and
     2118       21                                           the data name itself.
     2119       22                   OUTPUT    : TEMP_RESULT - the result variable defined in bits
     2120       23                                             so a real number can be placed in
     2121       24                                             the location.
     2122       25                   SCRATCH   : O1COM.NDSC - this location is destroyed when
     2123       26                                            creating a descriptor for the decimal
     2124       27                                            number.
     2125       28                   REFERENCE : None
     2126       29
     2127       30                   DESCRIPTION : This module extracts the number from the literal
     2128       31                                 and places it in a decimal floating point temp-
     2129       32                                 late.  An EIS descriptor is created to represent
     2130       33                                 that number, and then from those the decimal
     2131       34                                 number is converted to real using X9DR$CVDR or X9DR$CVDQ
     2132       35                                 (%TYR or %TYQ). If the exponent is < 128, a special
     2133       36                                 entry, X9DR$CVDR_SMALL or X9DR$CVDQ_SMALL, is called
     2134       37                                 to do the conversion and adjust for the underflow
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:365  
     2135       38                                 that occurred in moving TEMP_EXPONENT.EXPONENT to
     2136       39                                 FLOAT.EXPONENT.
     2137       40        */
     2138       41
     2139       42        %SET PHASE = 1;
     2140       43        %INCLUDE Z8A_DEFC;
     2141      111        %INCLUDE Z8A_SUPP_MAC;
     2142     2511        %INCLUDE Z8A_COMCOM;
     2143     3161        %INCLUDE Z8E_MACROS;
     2144     3836        %INCLUDE Z8A_ST;
     2145     7495
     2146     7496    1   DCL Z8AU$CREATE_NUM_DESC      ENTRY(3);
     2147     7497
     2148     7498        %EQU E_IN_EXPONENT = 'E' ;
     2149     7499        %EQU FLOAT_DECIMAL_LENGTH = 60;
     2150     7500        %EQU MANTISSA_ZEROS =
     2151     7501            '000000000000000000000000000000000000000000000000000000000000';
     2152     7502
     2153     7503    1   DCL X9DR$CVDQ               ENTRY(3) ;
     2154     7504    1   DCL X9DR$CVDR               ENTRY(3) ;
     2155     7505    1   DCL X9DR$CVDQ_SMALL         ENTRY(3) ;
     2156     7506    1   DCL X9DR$CVDR_SMALL         ENTRY(3) ;
     2157     7507
     2158     7508    1   DCL LENGTH             SBIN;
     2159     7509    1   DCL TEXT               CHAR (LENGTH);
     2160     7510
     2161     7511    1   DCL TEMP_RESULT        BIT (72) ALIGNED;
     2162     7512
     2163     7513    1   DCL 1 REAL_RESULT DALIGNED,
     2164     7514    1        2 DOUBLE_REAL     BIT (72) UNAL,
     2165     7515    1        2 SINGLE_REAL REDEF DOUBLE_REAL,
     2166     7516    1         3 ONE_WORD       BIT (36) UNAL,
     2167     7517    1         3 *              BIT (36) UNAL;
     2168     7518
     2169     7519    1   DCL VALUE_OVERFLOW     BIT (1) ALIGNED;
     2170     7520    1   DCL COLUMN             UBIN WORD ;
     2171     7521    1   DCL OFFSET             SBIN WORD ;
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:366  
     2172     7522    1   DCL DESCRIPTOR         UBIN WORD ;
     2173     7523    1   DCL 1 DESC             REDEF DESCRIPTOR,
     2174     7524            %DESCRIPTOR (LVL = 2, ENDING = YES);
     2175     7552        %DCL_NUM_DESC ( @STRN = NUM_DESC );
     2176     7561    1   DCL TOTAL_DIGITS       UBIN WORD ;
     2177     7562    1   DCL LEFT_LENGTH        UBIN WORD;
     2178     7563    1   DCL RIGHT_LENGTH       UBIN WORD;
     2179     7564        %EQU PLUS_SIGN_ = '+';
     2180     7565    1   DCL TOTAL_ZEROS        UBIN WORD;
     2181     7566    1   DCL TOTAL_SIZE         SBIN WORD;
     2182     7567    1   DCL DOUBLE_FLOAT       BIT(1);
     2183     7568    1   DCL I                  SBIN WORD;
     2184     7569
     2185     7570    1   DCL 1 WORD_EXPONENT    SBIN WORD ;
     2186     7571    1   DCL 1 TEMP_EXPONENT REDEF WORD_EXPONENT ,
     2187     7572    1        2 *               UBIN(28) UNAL,
     2188     7573    1        2 EXPONENT        SBIN(8) UNAL ;
     2189     7574
     2190     7575    1   DCL 1 FLOAT            STATIC ALIGNED,
     2191     7576    1        2 SIGN            CHAR(1) UNAL,
     2192     7577    1        2 MANTISSA        CHAR(60) UNAL,
     2193     7578    1        2 MBZ             BIT(1) INIT ('0'B),
     2194     7579    1        2 EXPONENT        SBIN(8) UNAL ;
     2195     7580
     2196     7581        /*V*
     2197     7582                   TWO_ENTRIES -- The reasoning for two entries is to accom-
     2198     7583                                  odate single and double word real variables.
     2199     7584                                  The variable DOUBLE_FLOAT is set if the double
     2200     7585                                  word entry is entered, reset if single.  The
     2201     7586                                  only other difference in code is which conv-
     2202     7587                                  sion routine to call, single (X9DR$CVDR) or double
     2203     7588                                  (X9DR$CVDQ).
     2204     7589
     2205     7590        */
     2206     7591
     2207     7592    1      DOUBLE_FLOAT = FALSE ;
     2208     7593    1      GOTO CONVERT;
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:367  
     2209     7594
     2210     7595    1   Z8EC$DOUBLE_FLOAT:     ENTRY (TEXT, LENGTH, TEMP_RESULT, VALUE_OVERFLOW );
     2211     7596
     2212     7597    1      DOUBLE_FLOAT = TRUE ;
     2213     7598
     2214     7599        %EJECT;
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:368  
     2215     7600    1   CONVERT:
     2216     7601        /*V*
     2217     7602                            -- To determine if there is an exponent, and where
     2218     7603                               it is located in relation to the start of the
     2219     7604                               literal, the index function is called looking
     2220     7605                               for an "E".  If no "E" is found then the exponent
     2221     7606                               is set to zero, else it is taken as is and put
     2222     7607                               in the exponent of the decimal float variable
     2223     7608                               ( FLOAT.EXPONENT ).
     2224     7609
     2225     7610        */
     2226     7611    1      FLOAT.MANTISSA = %MANTISSA_ZEROS ;
     2227     7612    1      FLOAT.SIGN = ' ' ;
     2228     7613    1      FLOAT.EXPONENT = 0 ;
     2229     7614
     2230     7615    1      CALL Z8AU$CREATE_NUM_DESC (TEXT,
     2231     7616    1                                 LENGTH,
     2232     7617    1                                 NUM_DESC);
     2233     7618
     2234     7619    1      LEFT_LENGTH = NUM_DESC.DIGITS_LEFT ;
     2235     7620    1      RIGHT_LENGTH = NUM_DESC.DIGITS_RIGHT ;
     2236     7621    1      TOTAL_DIGITS = LEFT_LENGTH + RIGHT_LENGTH ;
     2237     7622    1      CALL INDEX(COLUMN,%E_IN_EXPONENT,TEXT) ;
     2238     7623
     2239     7624    1      IF COLUMN = LENGTH THEN
     2240     7625    1        WORD_EXPONENT = 0 ;
     2241     7626    1      ELSE
     2242     7627    1        IF NUM_DESC.EXPONENT_SIGN_VALUE = %NO_SIGN_VALUE THEN
     2243     7628    1          CALL CHARBIN(WORD_EXPONENT,SUBSTR(TEXT,COLUMN+1)) ;
     2244     7629    1        ELSE
     2245     7630    1          CALL XCHARBIN(WORD_EXPONENT,SUBSTR(TEXT,COLUMN+1)) ;
     2246     7631
     2247     7632    1      WORD_EXPONENT = WORD_EXPONENT - RIGHT_LENGTH;
     2248     7633        %EJECT;
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:369  
     2249     7634        /*     We now have a normalized number.  If the exponent is
     2250     7635               greater then 127, we will try to unnormalize it with
     2251     7636               an exponent of 127.
     2252     7637                                                                       */
     2253     7638
     2254     7639    1   IF WORD_EXPONENT > 127  THEN
     2255     7640    2     DO;
     2256     7641
     2257     7642    2       TOTAL_DIGITS = TOTAL_DIGITS + WORD_EXPONENT - 127;
     2258     7643    2       WORD_EXPONENT = 127;
     2259     7644
     2260     7645    2     END;
     2261     7646
     2262     7647    1   FLOAT.EXPONENT = TEMP_EXPONENT.EXPONENT;
     2263     7648    1   OFFSET = LENGTHC( FLOAT.MANTISSA ) - TOTAL_DIGITS;
     2264     7649        %EJECT;
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:370  
     2265     7650        /*V*
     2266     7651                   FILL_MANTISSA -- The mantissa and sign portion of FLOAT are
     2267     7652                                    filled here, taken from the DNT text, ex-
     2268     7653                                    cluding the decimal point.
     2269     7654
     2270     7655        */
     2271     7656
     2272     7657    1      IF NUM_DESC.MANTISSA_SIGN_VALUE = %NO_SIGN_VALUE THEN
     2273     7658    2        DO ;
     2274     7659    2          FLOAT.SIGN = %PLUS_SIGN_ ;
     2275     7660    2          CALL INSERT(FLOAT.MANTISSA,OFFSET,LEFT_LENGTH+RIGHT_LENGTH,
     2276     7661    2              SUBSTR(TEXT,0,LEFT_LENGTH),
     2277     7662    2              SUBSTR(TEXT,LEFT_LENGTH+1,RIGHT_LENGTH)) ;
     2278     7663    2        END ;
     2279     7664    1      ELSE
     2280     7665    2        DO ;
     2281     7666    2          FLOAT.SIGN = SUBSTR(TEXT,0,1) ;
     2282     7667    2          CALL INSERT(FLOAT.MANTISSA,OFFSET,LEFT_LENGTH+RIGHT_LENGTH,
     2283     7668    2              SUBSTR(TEXT,1,LEFT_LENGTH),
     2284     7669    2              SUBSTR(TEXT,LEFT_LENGTH+2,RIGHT_LENGTH)) ;
     2285     7670    2        END ;
     2286     7671        %EJECT;
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:371  
     2287     7672    1   TOTAL_ZEROS = 0;
     2288     7673
     2289     7674    2   DO I = 0 TO (LEFT_LENGTH - 1);
     2290     7675    2     IF SUBSTR(FLOAT.MANTISSA, OFFSET + I, 1) = '0' THEN
     2291     7676    2       TOTAL_ZEROS = TOTAL_ZEROS + 1;
     2292     7677    2     ELSE
     2293     7678    2       EXIT;
     2294     7679    2   END;
     2295     7680
     2296     7681    1   IF TOTAL_ZEROS = LEFT_LENGTH      THEN
     2297     7682
     2298     7683    2     DO I = 0 TO (RIGHT_LENGTH - 1);
     2299     7684    2       IF SUBSTR( FLOAT.MANTISSA, LEFT_LENGTH + OFFSET + I, 1 ) = '0'  THEN
     2300     7685    2         TOTAL_ZEROS = TOTAL_ZEROS + 1;
     2301     7686    2       ELSE
     2302     7687    2         EXIT;
     2303     7688    2     END;
     2304     7689
     2305     7690
     2306     7691    1   TOTAL_DIGITS = TOTAL_DIGITS - TOTAL_ZEROS;
     2307     7692         %EJECT;
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:372  
     2308     7693        /*   Check for values too large or small.  In hex mode the
     2309     7694             largest exponent is 152 and the smallest is -155.  In
     2310     7695             binary mode it is + or - 38.
     2311     7696                                                                     */
     2312     7697    1   TOTAL_SIZE = WORD_EXPONENT + TOTAL_DIGITS;
     2313     7698
     2314     7699    2    IF COMCOM.OB.HEX THEN DO;
     2315     7700    2      IF TOTAL_SIZE < -155   OR   TOTAL_SIZE > 153   OR
     2316     7701    2         (TOTAL_SIZE = 153 AND SUBSTR (FLOAT.MANTISSA, OFFSET, 6)
     2317     7702    2         >= '837988')   THEN
     2318     7703    2       VALUE_OVERFLOW = TRUE;
     2319     7704    2    END;
     2320     7705
     2321     7706    1   ELSE
     2322     7707
     2323     7708    1      IF  TOTAL_SIZE > 38  OR  TOTAL_SIZE < -38   THEN
     2324     7709    1        VALUE_OVERFLOW = TRUE;
     2325     7710
     2326     7711
     2327     7712    1   IF VALUE_OVERFLOW      THEN
     2328     7713    2     DO;
     2329     7714    2       FLOAT.MANTISSA = %MANTISSA_ZEROS;
     2330     7715    2       FLOAT.EXPONENT = 0;
     2331     7716    2     END;
     2332     7717        %EJECT;
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:373  
     2333     7718
     2334     7719           %PACK_NDSC (@DESC   = DESC,
     2335     7720                       @LENGTH = %FLOAT_DECIMAL_LENGTH,
     2336     7721                       @SIGN   = %FLOATING_POINT_LEADING_SIGN,
     2337     7722                       @TN     = %NDSC9,
     2338     7723                       @SCALE  = 0 );
     2339     7772
     2340     7773        /*V*
     2341     7774                           -- The decimal number is converted to real, single
     2342     7775                              or double.  REAL_RESULT must be double word aligned
     2343     7776                              for the double word cases.  The parameter passed
     2344     7777                              in cannot be guaranteed of that.  This is why the
     2345     7778                              answer is put in a temp then moved into the actual
     2346     7779                              result location.
     2347     7780
     2348     7781        */
     2349     7782
     2350     7783    2     IF WORD_EXPONENT < -128 THEN DO ;
     2351     7784    2      IF DOUBLE_FLOAT THEN
     2352     7785    2        CALL X9DR$CVDQ_SMALL(FLOAT, REAL_RESULT.DOUBLE_REAL, DESCRIPTOR) ;
     2353     7786    2      ELSE
     2354     7787    2        CALL X9DR$CVDR_SMALL(FLOAT, REAL_RESULT.SINGLE_REAL, DESCRIPTOR) ;
     2355     7788    2     END ;
     2356     7789    1     ELSE
     2357     7790    1      IF DOUBLE_FLOAT THEN
     2358     7791    1        CALL X9DR$CVDQ(FLOAT, REAL_RESULT.DOUBLE_REAL, DESCRIPTOR) ;
     2359     7792    1      ELSE
     2360     7793    1        CALL X9DR$CVDR(FLOAT, REAL_RESULT.SINGLE_REAL, DESCRIPTOR) ;
     2361     7794
     2362     7795    1      TEMP_RESULT = REAL_RESULT ;
     2363     7796
     2364     7797    1      RETURN;
     2365     7798    1   END Z8EC$FLOAT;
     2366     7799        %EOD;

PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:374  
--  Include file information  --

   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EC$FLOAT.

   Procedure Z8EC$FLOAT requires 283 words for executable code.
   Procedure Z8EC$FLOAT requires 32 words of local(AUTO) storage.

PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:375  

 Object Unit name= Z8EC$FLOAT                                 File name= Z8EC.:Z8A6TOU
 UTS= AUG 09 '97 11:51:16.40 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  ST$
    2  LblCom even  none     5      5  ST_
    3   Data  even  none    16     20  Z8EC$FLOAT
    4  RoData even  UTS     17     21  Z8EC$FLOAT
    5   Proc  even  none   283    433  Z8EC$FLOAT
    6  RoData even  none    11     13  Z8EC$FLOAT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes            yes      Std        4  Z8EC$FLOAT
     5      4                  yes      Std        4  Z8EC$DOUBLE_FLOAT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 Z8AU$CREATE_NUM_DESC
         yes           Std       3 X9DR$CVDQ_SMALL
         yes           Std       3 X9DR$CVDR_SMALL
         yes           Std       3 X9DR$CVDQ
         yes           Std       3 X9DR$CVDR
                       nStd      0 X66_AUTO_4
                       nStd      0 X66_ARET
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:376  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:377  


     2098        1        /*T***********************************************************/
     2099        2        /*T*                                                         */
     2100        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2101        4        /*T*                                                         */
     2102        5        /*T***********************************************************/
     2103        6        Z8EC$FLOAT: PROC (TEXT, LENGTH, TEMP_RESULT, VALUE_OVERFLOW );

      6  5 000000   000000 700200 xent  Z8EC$FLOAT   TSX0  ! X66_AUTO_4
         5 000001   000040 000004                    ZERO    32,4

     2104        7        /*D*
     2105        8                   NAME      : Z8EC$FLOAT &
     2106        9                               Z8EC$DOUBLE_FLOAT
     2107       10                   CALL      : CALL Z8EC$FLOAT (TEXT,LENGTH,TEMP_RESULT,VALUE_OVERFLOW);
     2108       11                                      -or-
     2109       12                           CALL Z8EC$DOUBLE_FLOAT (TEXT,LENGTH,TEMP_RESULT,VALUE_OVERFLOW);
     2110       13                   INTERFACE : X9DR$CVDR - conversion from decimal to single word real.
     2111       14                               X9DR$CVDQ - conversion from decimal to double word real.
     2112       15                               X9DR$CVDR_SMALL - conversion from decimal to single word
     2113       16                                                 with exponent < -128.
     2114       17                               X9DR$CVDQ_SMALL - conversion from decimal to double word
     2115       18                                                 with exponent < -128.
     2116       19                   INPUT     : REAL_DNT$ - pointer to the data name table entry
     2117       20                                           allowing access to the attributes and
     2118       21                                           the data name itself.
     2119       22                   OUTPUT    : TEMP_RESULT - the result variable defined in bits
     2120       23                                             so a real number can be placed in
     2121       24                                             the location.
     2122       25                   SCRATCH   : O1COM.NDSC - this location is destroyed when
     2123       26                                            creating a descriptor for the decimal
     2124       27                                            number.
     2125       28                   REFERENCE : None
     2126       29
     2127       30                   DESCRIPTION : This module extracts the number from the literal
     2128       31                                 and places it in a decimal floating point temp-
     2129       32                                 late.  An EIS descriptor is created to represent
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:378  
     2130       33                                 that number, and then from those the decimal
     2131       34                                 number is converted to real using X9DR$CVDR or X9DR$CVDQ
     2132       35                                 (%TYR or %TYQ). If the exponent is < 128, a special
     2133       36                                 entry, X9DR$CVDR_SMALL or X9DR$CVDQ_SMALL, is called
     2134       37                                 to do the conversion and adjust for the underflow
     2135       38                                 that occurred in moving TEMP_EXPONENT.EXPONENT to
     2136       39                                 FLOAT.EXPONENT.
     2137       40        */
     2138       41
     2139       42        %SET PHASE = 1;
     2140       43        %INCLUDE Z8A_DEFC;
     2141      111        %INCLUDE Z8A_SUPP_MAC;
     2142     2511        %INCLUDE Z8A_COMCOM;
     2143     3161        %INCLUDE Z8E_MACROS;
     2144     3836        %INCLUDE Z8A_ST;
     2145     7495
     2146     7496    1   DCL Z8AU$CREATE_NUM_DESC      ENTRY(3);
     2147     7497
     2148     7498        %EQU E_IN_EXPONENT = 'E' ;
     2149     7499        %EQU FLOAT_DECIMAL_LENGTH = 60;
     2150     7500        %EQU MANTISSA_ZEROS =
     2151     7501            '000000000000000000000000000000000000000000000000000000000000';
     2152     7502
     2153     7503    1   DCL X9DR$CVDQ               ENTRY(3) ;
     2154     7504    1   DCL X9DR$CVDR               ENTRY(3) ;
     2155     7505    1   DCL X9DR$CVDQ_SMALL         ENTRY(3) ;
     2156     7506    1   DCL X9DR$CVDR_SMALL         ENTRY(3) ;
     2157     7507
     2158     7508    1   DCL LENGTH             SBIN;
     2159     7509    1   DCL TEXT               CHAR (LENGTH);
     2160     7510
     2161     7511    1   DCL TEMP_RESULT        BIT (72) ALIGNED;
     2162     7512
     2163     7513    1   DCL 1 REAL_RESULT DALIGNED,
     2164     7514    1        2 DOUBLE_REAL     BIT (72) UNAL,
     2165     7515    1        2 SINGLE_REAL REDEF DOUBLE_REAL,
     2166     7516    1         3 ONE_WORD       BIT (36) UNAL,
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:379  
     2167     7517    1         3 *              BIT (36) UNAL;
     2168     7518
     2169     7519    1   DCL VALUE_OVERFLOW     BIT (1) ALIGNED;
     2170     7520    1   DCL COLUMN             UBIN WORD ;
     2171     7521    1   DCL OFFSET             SBIN WORD ;
     2172     7522    1   DCL DESCRIPTOR         UBIN WORD ;
     2173     7523    1   DCL 1 DESC             REDEF DESCRIPTOR,
     2174     7524            %DESCRIPTOR (LVL = 2, ENDING = YES);
     2175     7552        %DCL_NUM_DESC ( @STRN = NUM_DESC );
     2176     7561    1   DCL TOTAL_DIGITS       UBIN WORD ;
     2177     7562    1   DCL LEFT_LENGTH        UBIN WORD;
     2178     7563    1   DCL RIGHT_LENGTH       UBIN WORD;
     2179     7564        %EQU PLUS_SIGN_ = '+';
     2180     7565    1   DCL TOTAL_ZEROS        UBIN WORD;
     2181     7566    1   DCL TOTAL_SIZE         SBIN WORD;
     2182     7567    1   DCL DOUBLE_FLOAT       BIT(1);
     2183     7568    1   DCL I                  SBIN WORD;
     2184     7569
     2185     7570    1   DCL 1 WORD_EXPONENT    SBIN WORD ;
     2186     7571    1   DCL 1 TEMP_EXPONENT REDEF WORD_EXPONENT ,
     2187     7572    1        2 *               UBIN(28) UNAL,
     2188     7573    1        2 EXPONENT        SBIN(8) UNAL ;
     2189     7574
     2190     7575    1   DCL 1 FLOAT            STATIC ALIGNED,
     2191     7576    1        2 SIGN            CHAR(1) UNAL,
     2192     7577    1        2 MANTISSA        CHAR(60) UNAL,
     2193     7578    1        2 MBZ             BIT(1) INIT ('0'B),
     2194     7579    1        2 EXPONENT        SBIN(8) UNAL ;
     2195     7580
     2196     7581        /*V*
     2197     7582                   TWO_ENTRIES -- The reasoning for two entries is to accom-
     2198     7583                                  odate single and double word real variables.
     2199     7584                                  The variable DOUBLE_FLOAT is set if the double
     2200     7585                                  word entry is entered, reset if single.  The
     2201     7586                                  only other difference in code is which conv-
     2202     7587                                  sion routine to call, single (X9DR$CVDR) or double
     2203     7588                                  (X9DR$CVDQ).
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:380  
     2204     7589
     2205     7590        */
     2206     7591
     2207     7592    1      DOUBLE_FLOAT = FALSE ;

   7592  5 000002   200030 450100                    STZ     DOUBLE_FLOAT,,AUTO

     2208     7593    1      GOTO CONVERT;

   7593  5 000003   000010 710000 5                  TRA     CONVERT

     2209     7594
     2210     7595    1   Z8EC$DOUBLE_FLOAT:     ENTRY (TEXT, LENGTH, TEMP_RESULT, VALUE_OVERFLOW );

   7595  5 000004   000000 700200 xent  Z8EC$DOUBLE* TSX0  ! X66_AUTO_4
         5 000005   000040 000004                    ZERO    32,4

     2211     7596
     2212     7597    1      DOUBLE_FLOAT = TRUE ;

   7597  5 000006   400000 236003                    LDQ     -131072,DU
         5 000007   200030 756100                    STQ     DOUBLE_FLOAT,,AUTO

     2213     7598
     2214     7599        %EJECT;
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:381  
     2215     7600    1   CONVERT:
     2216     7601        /*V*
     2217     7602                            -- To determine if there is an exponent, and where
     2218     7603                               it is located in relation to the start of the
     2219     7604                               literal, the index function is called looking
     2220     7605                               for an "E".  If no "E" is found then the exponent
     2221     7606                               is set to zero, else it is taken as is and put
     2222     7607                               in the exponent of the decimal float variable
     2223     7608                               ( FLOAT.EXPONENT ).
     2224     7609
     2225     7610        */
     2226     7611    1      FLOAT.MANTISSA = %MANTISSA_ZEROS ;

   7611  5 000010   040000 100400       CONVERT      MLR     fill='040'O
         5 000011   000000 000074 4                  ADSC9   0                        cn=0,n=60
         5 000012   000000 200074 3                  ADSC9   FLOAT                    cn=1,n=60

     2227     7612    1      FLOAT.SIGN = ' ' ;

   7612  5 000013   040000 236003                    LDQ     16384,DU
         5 000014   000000 552040 3                  STBQ    FLOAT,'40'O

     2228     7613    1      FLOAT.EXPONENT = 0 ;

   7613  5 000015   000000 236000 6                  LDQ     0
         5 000016   000017 356000 3                  ANSQ    FLOAT+15

     2229     7614
     2230     7615    1      CALL Z8AU$CREATE_NUM_DESC (TEXT,

   7615  5 000017   200015 630500                    EPPR0   NUM_DESC,,AUTO
         5 000020   200036 450500                    STP0    WORD_EXPONENT+4,,AUTO
         5 000021   200004 236100                    LDQ     @LENGTH,,AUTO
         5 000022   200003 235100                    LDA     @TEXT,,AUTO
         5 000023   200034 757100                    STAQ    WORD_EXPONENT+2,,AUTO
         5 000024   200034 630500                    EPPR0   WORD_EXPONENT+2,,AUTO
         5 000025   000001 631400 6                  EPPR1   1
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:382  
         5 000026   000000 701000 xent               TSX1    Z8AU$CREATE_NUM_DESC
         5 000027   000000 011000                    NOP     0

     2231     7616    1                                 LENGTH,
     2232     7617    1                                 NUM_DESC);
     2233     7618
     2234     7619    1      LEFT_LENGTH = NUM_DESC.DIGITS_LEFT ;

   7619  5 000030   200015 235100                    LDA     NUM_DESC,,AUTO
         5 000031   200024 755100                    STA     LEFT_LENGTH,,AUTO

     2235     7620    1      RIGHT_LENGTH = NUM_DESC.DIGITS_RIGHT ;

   7620  5 000032   200016 236100                    LDQ     NUM_DESC+1,,AUTO
         5 000033   200025 756100                    STQ     RIGHT_LENGTH,,AUTO

     2236     7621    1      TOTAL_DIGITS = LEFT_LENGTH + RIGHT_LENGTH ;

   7621  5 000034   200024 036100                    ADLQ    LEFT_LENGTH,,AUTO
         5 000035   200023 756100                    STQ     TOTAL_DIGITS,,AUTO

     2237     7622    1      CALL INDEX(COLUMN,%E_IN_EXPONENT,TEXT) ;

   7622  5 000036   200004 470500                    LDP0    @LENGTH,,AUTO
         5 000037   000000 720100                    LXL0    0,,PR0
         5 000040   200003 471500                    LDP1    @TEXT,,AUTO
         5 000041   000000 124540                    SCM     mask='000'O
         5 000042   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         5 000043   000002 000001 6                  ADSC9   2                        cn=0,n=1
         5 000044   200012 000100                    ARG     COLUMN,,AUTO

     2238     7623
     2239     7624    1      IF COLUMN = LENGTH THEN

   7624  5 000045   200012 236100                    LDQ     COLUMN,,AUTO
         5 000046   000053 604000 5                  TMI     s:7627
         5 000047   000000 116100                    CMPQ    0,,PR0
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:383  
         5 000050   000053 601000 5                  TNZ     s:7627

     2240     7625    1        WORD_EXPONENT = 0 ;

   7625  5 000051   200032 450100                    STZ     WORD_EXPONENT,,AUTO
         5 000052   000076 710000 5                  TRA     s:7632

     2241     7626    1      ELSE
     2242     7627    1        IF NUM_DESC.EXPONENT_SIGN_VALUE = %NO_SIGN_VALUE THEN

   7627  5 000053   200021 235100                    LDA     NUM_DESC+4,,AUTO
         5 000054   000066 601000 5                  TNZ     s:7630

     2243     7628    1          CALL CHARBIN(WORD_EXPONENT,SUBSTR(TEXT,COLUMN+1)) ;

   7628  5 000055   000000 636010                    EAQ     0,X0
         5 000056   000022 732000                    QRS     18
         5 000057   200012 136100                    SBLQ    COLUMN,,AUTO
         5 000060   777777 621006                    EAX1    -1,QL
         5 000061   200012 236100                    LDQ     COLUMN,,AUTO
         5 000062   000100 305546                    DTB
         5 000063   100000 230011                    NDSC9   0,Q,PR1                  cn=1,s=nosgn,sf=0,n=*X1
         5 000064   200032 000004                    NDSC9   WORD_EXPONENT,,AUTO      cn=0,s=lsgnf,sf=0,n=4
         5 000065   000076 710000 5                  TRA     s:7632

     2244     7629    1        ELSE
     2245     7630    1          CALL XCHARBIN(WORD_EXPONENT,SUBSTR(TEXT,COLUMN+1)) ;

   7630  5 000066   000000 636010                    EAQ     0,X0
         5 000067   000022 732000                    QRS     18
         5 000070   200012 136100                    SBLQ    COLUMN,,AUTO
         5 000071   777777 621006                    EAX1    -1,QL
         5 000072   200012 236100                    LDQ     COLUMN,,AUTO
         5 000073   000100 305546                    DTB
         5 000074   100000 210011                    NDSC9   0,Q,PR1                  cn=1,s=lsgns,sf=0,n=*X1
         5 000075   200032 000004                    NDSC9   WORD_EXPONENT,,AUTO      cn=0,s=lsgnf,sf=0,n=4

PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:384  
     2246     7631
     2247     7632    1      WORD_EXPONENT = WORD_EXPONENT - RIGHT_LENGTH;

   7632  5 000076   200032 236100                    LDQ     WORD_EXPONENT,,AUTO
         5 000077   200025 136100                    SBLQ    RIGHT_LENGTH,,AUTO
         5 000100   200032 756100                    STQ     WORD_EXPONENT,,AUTO

     2248     7633        %EJECT;
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:385  
     2249     7634        /*     We now have a normalized number.  If the exponent is
     2250     7635               greater then 127, we will try to unnormalize it with
     2251     7636               an exponent of 127.
     2252     7637                                                                       */
     2253     7638
     2254     7639    1   IF WORD_EXPONENT > 127  THEN

   7639  5 000101   000177 116007                    CMPQ    127,DL
         5 000102   000110 604400 5                  TMOZ    s:7647

     2255     7640    2     DO;

     2256     7641
     2257     7642    2       TOTAL_DIGITS = TOTAL_DIGITS + WORD_EXPONENT - 127;

   7642  5 000103   200023 036100                    ADLQ    TOTAL_DIGITS,,AUTO
         5 000104   000177 136007                    SBLQ    127,DL
         5 000105   200023 756100                    STQ     TOTAL_DIGITS,,AUTO

     2258     7643    2       WORD_EXPONENT = 127;

   7643  5 000106   000177 235007                    LDA     127,DL
         5 000107   200032 755100                    STA     WORD_EXPONENT,,AUTO

     2259     7644
     2260     7645    2     END;

     2261     7646
     2262     7647    1   FLOAT.EXPONENT = TEMP_EXPONENT.EXPONENT;

   7647  5 000110   200032 236100                    LDQ     WORD_EXPONENT,,AUTO
         5 000111   000022 736000                    QLS     18
         5 000112   000017 676000 3                  ERQ     FLOAT+15
         5 000113   000377 376003                    ANQ     255,DU
         5 000114   000017 656000 3                  ERSQ    FLOAT+15

     2263     7648    1   OFFSET = LENGTHC( FLOAT.MANTISSA ) - TOTAL_DIGITS;
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:386  

   7648  5 000115   000074 235007                    LDA     60,DL
         5 000116   200023 135100                    SBLA    TOTAL_DIGITS,,AUTO
         5 000117   200013 755100                    STA     OFFSET,,AUTO

     2264     7649        %EJECT;
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:387  
     2265     7650        /*V*
     2266     7651                   FILL_MANTISSA -- The mantissa and sign portion of FLOAT are
     2267     7652                                    filled here, taken from the DNT text, ex-
     2268     7653                                    cluding the decimal point.
     2269     7654
     2270     7655        */
     2271     7656
     2272     7657    1      IF NUM_DESC.MANTISSA_SIGN_VALUE = %NO_SIGN_VALUE THEN

   7657  5 000120   200020 236100                    LDQ     NUM_DESC+3,,AUTO
         5 000121   000150 601000 5                  TNZ     s:7666

     2273     7658    2        DO ;

     2274     7659    2          FLOAT.SIGN = %PLUS_SIGN_ ;

   7659  5 000122   053000 236003                    LDQ     22016,DU
         5 000123   000000 552040 3                  STBQ    FLOAT,'40'O

     2275     7660    2          CALL INSERT(FLOAT.MANTISSA,OFFSET,LEFT_LENGTH+RIGHT_LENGTH,

   7660  5 000124   200024 236100                    LDQ     LEFT_LENGTH,,AUTO
         5 000125   200025 036100                    ADLQ    RIGHT_LENGTH,,AUTO
         5 000126   000000 720100                    LXL0    0,,PR0
         5 000127   200024 721100                    LXL1    LEFT_LENGTH,,AUTO
         5 000130   000000 622006                    EAX2    0,QL
         5 000131   040045 100540                    MLR     fill='040'O
         5 000132   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         5 000133   000000 200012 3                  ADSC9   FLOAT,A                  cn=1,n=*X2
         5 000134   200024 136100                    SBLQ    LEFT_LENGTH,,AUTO
         5 000135   000147 604400 5                  TMOZ    s:7663
         5 000136   200034 756100                    STQ     WORD_EXPONENT+2,,AUTO
         5 000137   200013 236100                    LDQ     OFFSET,,AUTO
         5 000140   200024 036100                    ADLQ    LEFT_LENGTH,,AUTO
         5 000141   200025 720100                    LXL0    RIGHT_LENGTH,,AUTO
         5 000142   200024 235100                    LDA     LEFT_LENGTH,,AUTO
         5 000143   200034 722100                    LXL2    WORD_EXPONENT+2,,AUTO
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:388  
         5 000144   040046 100545                    MLR     fill='040'O
         5 000145   100000 200010                    ADSC9   0,A,PR1                  cn=1,n=*X0
         5 000146   000000 200012 3                  ADSC9   FLOAT,Q                  cn=1,n=*X2

     2276     7661    2              SUBSTR(TEXT,0,LEFT_LENGTH),
     2277     7662    2              SUBSTR(TEXT,LEFT_LENGTH+1,RIGHT_LENGTH)) ;
     2278     7663    2        END ;

   7663  5 000147   000177 710000 5                  TRA     s:7672

     2279     7664    1      ELSE
     2280     7665    2        DO ;

     2281     7666    2          FLOAT.SIGN = SUBSTR(TEXT,0,1) ;

   7666  5 000150   000000 720100                    LXL0    0,,PR0
         5 000151   040000 100500                    MLR     fill='040'O
         5 000152   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         5 000153   000000 000001 3                  ADSC9   FLOAT                    cn=0,n=1

     2282     7667    2          CALL INSERT(FLOAT.MANTISSA,OFFSET,LEFT_LENGTH+RIGHT_LENGTH,

   7667  5 000154   200024 236100                    LDQ     LEFT_LENGTH,,AUTO
         5 000155   200025 036100                    ADLQ    RIGHT_LENGTH,,AUTO
         5 000156   000000 721100                    LXL1    0,,PR0
         5 000157   200024 722100                    LXL2    LEFT_LENGTH,,AUTO
         5 000160   000000 623006                    EAX3    0,QL
         5 000161   040045 100540                    MLR     fill='040'O
         5 000162   100000 200012                    ADSC9   0,,PR1                   cn=1,n=*X2
         5 000163   000000 200013 3                  ADSC9   FLOAT,A                  cn=1,n=*X3
         5 000164   200024 136100                    SBLQ    LEFT_LENGTH,,AUTO
         5 000165   000177 604400 5                  TMOZ    s:7672
         5 000166   200034 756100                    STQ     WORD_EXPONENT+2,,AUTO
         5 000167   200013 236100                    LDQ     OFFSET,,AUTO
         5 000170   200024 036100                    ADLQ    LEFT_LENGTH,,AUTO
         5 000171   200025 720100                    LXL0    RIGHT_LENGTH,,AUTO
         5 000172   200024 235100                    LDA     LEFT_LENGTH,,AUTO
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:389  
         5 000173   200034 721100                    LXL1    WORD_EXPONENT+2,,AUTO
         5 000174   040046 100545                    MLR     fill='040'O
         5 000175   100000 400010                    ADSC9   0,A,PR1                  cn=2,n=*X0
         5 000176   000000 200011 3                  ADSC9   FLOAT,Q                  cn=1,n=*X1

     2283     7668    2              SUBSTR(TEXT,1,LEFT_LENGTH),
     2284     7669    2              SUBSTR(TEXT,LEFT_LENGTH+2,RIGHT_LENGTH)) ;
     2285     7670    2        END ;

     2286     7671        %EJECT;
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:390  
     2287     7672    1   TOTAL_ZEROS = 0;

   7672  5 000177   200026 450100                    STZ     TOTAL_ZEROS,,AUTO

     2288     7673
     2289     7674    2   DO I = 0 TO (LEFT_LENGTH - 1);

   7674  5 000200   200031 450100                    STZ     I,,AUTO
         5 000201   000215 710000 5                  TRA     s:7679+1

     2290     7675    2     IF SUBSTR(FLOAT.MANTISSA, OFFSET + I, 1) = '0' THEN

   7675  5 000202   200013 236100                    LDQ     OFFSET,,AUTO
         5 000203   200031 036100                    ADLQ    I,,AUTO
         5 000204   040000 106406                    CMPC    fill='040'O
         5 000205   000000 200001 3                  ADSC9   FLOAT,Q                  cn=1,n=1
         5 000206   000003 000001 6                  ADSC9   3                        cn=0,n=1
         5 000207   000221 601000 5                  TNZ     s:7681

     2291     7676    2       TOTAL_ZEROS = TOTAL_ZEROS + 1;

   7676  5 000210   200026 235100                    LDA     TOTAL_ZEROS,,AUTO
         5 000211   000001 035007                    ADLA    1,DL
         5 000212   200026 755100                    STA     TOTAL_ZEROS,,AUTO
         5 000213   000214 710000 5                  TRA     s:7679

     2292     7677    2     ELSE
     2293     7678    2       EXIT;
     2294     7679    2   END;

   7679  5 000214   200031 054100                    AOS     I,,AUTO
         5 000215   200031 236100                    LDQ     I,,AUTO
         5 000216   000202 604000 5                  TMI     s:7675
         5 000217   200024 116100                    CMPQ    LEFT_LENGTH,,AUTO
         5 000220   000202 602000 5                  TNC     s:7675

     2295     7680
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:391  
     2296     7681    1   IF TOTAL_ZEROS = LEFT_LENGTH      THEN

   7681  5 000221   200026 236100                    LDQ     TOTAL_ZEROS,,AUTO
         5 000222   200024 116100                    CMPQ    LEFT_LENGTH,,AUTO
         5 000223   000246 601000 5                  TNZ     s:7691

     2297     7682
     2298     7683    2     DO I = 0 TO (RIGHT_LENGTH - 1);

   7683  5 000224   200031 450100                    STZ     I,,AUTO
         5 000225   000242 710000 5                  TRA     s:7688+1

     2299     7684    2       IF SUBSTR( FLOAT.MANTISSA, LEFT_LENGTH + OFFSET + I, 1 ) = '0'  THEN

   7684  5 000226   200024 236100                    LDQ     LEFT_LENGTH,,AUTO
         5 000227   200013 036100                    ADLQ    OFFSET,,AUTO
         5 000230   200031 036100                    ADLQ    I,,AUTO
         5 000231   040000 106406                    CMPC    fill='040'O
         5 000232   000000 200001 3                  ADSC9   FLOAT,Q                  cn=1,n=1
         5 000233   000003 000001 6                  ADSC9   3                        cn=0,n=1
         5 000234   000246 601000 5                  TNZ     s:7691

     2300     7685    2         TOTAL_ZEROS = TOTAL_ZEROS + 1;

   7685  5 000235   200026 235100                    LDA     TOTAL_ZEROS,,AUTO
         5 000236   000001 035007                    ADLA    1,DL
         5 000237   200026 755100                    STA     TOTAL_ZEROS,,AUTO
         5 000240   000241 710000 5                  TRA     s:7688

     2301     7686    2       ELSE
     2302     7687    2         EXIT;
     2303     7688    2     END;

   7688  5 000241   200031 054100                    AOS     I,,AUTO
         5 000242   200031 236100                    LDQ     I,,AUTO
         5 000243   000226 604000 5                  TMI     s:7684
         5 000244   200025 116100                    CMPQ    RIGHT_LENGTH,,AUTO
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:392  
         5 000245   000226 602000 5                  TNC     s:7684

     2304     7689
     2305     7690
     2306     7691    1   TOTAL_DIGITS = TOTAL_DIGITS - TOTAL_ZEROS;

   7691  5 000246   200023 236100                    LDQ     TOTAL_DIGITS,,AUTO
         5 000247   200026 136100                    SBLQ    TOTAL_ZEROS,,AUTO
         5 000250   200023 756100                    STQ     TOTAL_DIGITS,,AUTO

     2307     7692         %EJECT;
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:393  
     2308     7693        /*   Check for values too large or small.  In hex mode the
     2309     7694             largest exponent is 152 and the smallest is -155.  In
     2310     7695             binary mode it is + or - 38.
     2311     7696                                                                     */
     2312     7697    1   TOTAL_SIZE = WORD_EXPONENT + TOTAL_DIGITS;

   7697  5 000251   200032 036100                    ADLQ    WORD_EXPONENT,,AUTO
         5 000252   200027 756100                    STQ     TOTAL_SIZE,,AUTO

     2313     7698
     2314     7699    2    IF COMCOM.OB.HEX THEN DO;

   7699  5 000253   000027 234000 xsym               SZN     COMCOM+23
         5 000254   000273 605000 5                  TPL     s:7708

     2315     7700    2      IF TOTAL_SIZE < -155   OR   TOTAL_SIZE > 153   OR

   7700  5 000255   000004 116000 6                  CMPQ    4
         5 000256   000267 604000 5                  TMI     s:7703
         5 000257   000231 116007                    CMPQ    153,DL
         5 000260   000267 605400 5                  TPNZ    s:7703
         5 000261   000302 601000 5                  TNZ     s:7712
         5 000262   200013 235100                    LDA     OFFSET,,AUTO
         5 000263   040000 106405                    CMPC    fill='040'O
         5 000264   000000 200006 3                  ADSC9   FLOAT,A                  cn=1,n=6
         5 000265   000017 000006 4                  ADSC9   15                       cn=0,n=6
         5 000266   000302 602000 5                  TNC     s:7712

     2316     7701    2         (TOTAL_SIZE = 153 AND SUBSTR (FLOAT.MANTISSA, OFFSET, 6)
     2317     7702    2         >= '837988')   THEN
     2318     7703    2       VALUE_OVERFLOW = TRUE;

   7703  5 000267   400000 236003                    LDQ     -131072,DU
         5 000270   200006 470500                    LDP0    @VALUE_OVERFLOW,,AUTO
         5 000271   000000 756100                    STQ     0,,PR0

     2319     7704    2    END;
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:394  

   7704  5 000272   000302 710000 5                  TRA     s:7712

     2320     7705
     2321     7706    1   ELSE
     2322     7707
     2323     7708    1      IF  TOTAL_SIZE > 38  OR  TOTAL_SIZE < -38   THEN

   7708  5 000273   000046 116007                    CMPQ    38,DL
         5 000274   000277 605400 5                  TPNZ    s:7709
         5 000275   000005 116000 6                  CMPQ    5
         5 000276   000302 605000 5                  TPL     s:7712

     2324     7709    1        VALUE_OVERFLOW = TRUE;

   7709  5 000277   400000 236003                    LDQ     -131072,DU
         5 000300   200006 470500                    LDP0    @VALUE_OVERFLOW,,AUTO
         5 000301   000000 756100                    STQ     0,,PR0

     2325     7710
     2326     7711
     2327     7712    1   IF VALUE_OVERFLOW      THEN

   7712  5 000302   200006 470500                    LDP0    @VALUE_OVERFLOW,,AUTO
         5 000303   000000 234100                    SZN     0,,PR0
         5 000304   000312 605000 5                  TPL     s:7728

     2328     7713    2     DO;

     2329     7714    2       FLOAT.MANTISSA = %MANTISSA_ZEROS;

   7714  5 000305   040000 100400                    MLR     fill='040'O
         5 000306   000000 000074 4                  ADSC9   0                        cn=0,n=60
         5 000307   000000 200074 3                  ADSC9   FLOAT                    cn=1,n=60

     2330     7715    2       FLOAT.EXPONENT = 0;

PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:395  
   7715  5 000310   000000 236000 6                  LDQ     0
         5 000311   000017 356000 3                  ANSQ    FLOAT+15

     2331     7716    2     END;

     2332     7717        %EJECT;
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:396  
     2333     7718
     2334     7719           %PACK_NDSC (@DESC   = DESC,
     2335     7720                       @LENGTH = %FLOAT_DECIMAL_LENGTH,
     2336     7721                       @SIGN   = %FLOATING_POINT_LEADING_SIGN,
     2337     7722                       @TN     = %NDSC9,
     2338     7723                       @SCALE  = 0 );

   7728  5 000312   000000 220003                    LDX0    0,DU
         5 000313   200014 740100                    STX0    DESCRIPTOR,,AUTO

   7729  5 000314   000006 236000 6                  LDQ     6
         5 000315   200014 356100                    ANSQ    DESCRIPTOR,,AUTO

   7730  5 000316   000007 236000 6                  LDQ     7
         5 000317   200014 356100                    ANSQ    DESCRIPTOR,,AUTO

   7731  5 000320   000010 236000 6                  LDQ     8
         5 000321   200014 356100                    ANSQ    DESCRIPTOR,,AUTO

   7732  5 000322   000000 236003                    LDQ     0,DU
         5 000323   200014 752102                    STCQ    DESCRIPTOR,'02'O,AUTO

   7733  5 000324   000000 235003                    LDA     0,DU
         5 000325   000004 115007                    CMPA    4,DL
         5 000326   000330 602005 5                  TNC     s:7733+4,AL
         5 000327   000344 710000 5                  TRA     s:7783
         5 000330   000342 710000 5                  TRA     s:7764
         5 000331   000337 710000 5                  TRA     s:7740
         5 000332   000337 710000 5                  TRA     s:7740
         5 000333   000334 710000 5                  TRA     s:7735

   7735  5 000334   000074 236007                    LDQ     60,DL
         5 000335   200014 752101                    STCQ    DESCRIPTOR,'01'O,AUTO
         5 000336   000344 710000 5                  TRA     s:7783

   7740  5 000337   000075 236007                    LDQ     61,DL
         5 000340   200014 752101                    STCQ    DESCRIPTOR,'01'O,AUTO
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:397  
         5 000341   000344 710000 5                  TRA     s:7783

   7764  5 000342   000076 236007                    LDQ     62,DL
         5 000343   200014 752101                    STCQ    DESCRIPTOR,'01'O,AUTO

     2339     7772
     2340     7773        /*V*
     2341     7774                           -- The decimal number is converted to real, single
     2342     7775                              or double.  REAL_RESULT must be double word aligned
     2343     7776                              for the double word cases.  The parameter passed
     2344     7777                              in cannot be guaranteed of that.  This is why the
     2345     7778                              answer is put in a temp then moved into the actual
     2346     7779                              result location.
     2347     7780
     2348     7781        */
     2349     7782
     2350     7783    2     IF WORD_EXPONENT < -128 THEN DO ;

   7783  5 000344   200032 236100                    LDQ     WORD_EXPONENT,,AUTO
         5 000345   000011 116000 6                  CMPQ    9
         5 000346   000377 605000 5                  TPL     s:7790

     2351     7784    2      IF DOUBLE_FLOAT THEN

   7784  5 000347   200030 234100                    SZN     DOUBLE_FLOAT,,AUTO
         5 000350   000364 605000 5                  TPL     s:7787

     2352     7785    2        CALL X9DR$CVDQ_SMALL(FLOAT, REAL_RESULT.DOUBLE_REAL, DESCRIPTOR) ;

   7785  5 000351   200014 631500                    EPPR1   DESCRIPTOR,,AUTO
         5 000352   200036 451500                    STP1    WORD_EXPONENT+4,,AUTO
         5 000353   200010 633500                    EPPR3   REAL_RESULT,,AUTO
         5 000354   200035 453500                    STP3    WORD_EXPONENT+3,,AUTO
         5 000355   000012 236000 6                  LDQ     10
         5 000356   200034 756100                    STQ     WORD_EXPONENT+2,,AUTO
         5 000357   200034 630500                    EPPR0   WORD_EXPONENT+2,,AUTO
         5 000360   000001 631400 6                  EPPR1   1
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:398  
         5 000361   000000 701000 xent               TSX1    X9DR$CVDQ_SMALL
         5 000362   000000 011000                    NOP     0
         5 000363   000426 710000 5                  TRA     s:7795

     2353     7786    2      ELSE
     2354     7787    2        CALL X9DR$CVDR_SMALL(FLOAT, REAL_RESULT.SINGLE_REAL, DESCRIPTOR) ;

   7787  5 000364   200014 631500                    EPPR1   DESCRIPTOR,,AUTO
         5 000365   200036 451500                    STP1    WORD_EXPONENT+4,,AUTO
         5 000366   200010 633500                    EPPR3   REAL_RESULT,,AUTO
         5 000367   200035 453500                    STP3    WORD_EXPONENT+3,,AUTO
         5 000370   000012 236000 6                  LDQ     10
         5 000371   200034 756100                    STQ     WORD_EXPONENT+2,,AUTO
         5 000372   200034 630500                    EPPR0   WORD_EXPONENT+2,,AUTO
         5 000373   000001 631400 6                  EPPR1   1
         5 000374   000000 701000 xent               TSX1    X9DR$CVDR_SMALL
         5 000375   000000 011000                    NOP     0

     2355     7788    2     END ;

   7788  5 000376   000426 710000 5                  TRA     s:7795

     2356     7789    1     ELSE
     2357     7790    1      IF DOUBLE_FLOAT THEN

   7790  5 000377   200030 234100                    SZN     DOUBLE_FLOAT,,AUTO
         5 000400   000414 605000 5                  TPL     s:7793

     2358     7791    1        CALL X9DR$CVDQ(FLOAT, REAL_RESULT.DOUBLE_REAL, DESCRIPTOR) ;

   7791  5 000401   200014 631500                    EPPR1   DESCRIPTOR,,AUTO
         5 000402   200036 451500                    STP1    WORD_EXPONENT+4,,AUTO
         5 000403   200010 633500                    EPPR3   REAL_RESULT,,AUTO
         5 000404   200035 453500                    STP3    WORD_EXPONENT+3,,AUTO
         5 000405   000012 236000 6                  LDQ     10
         5 000406   200034 756100                    STQ     WORD_EXPONENT+2,,AUTO
         5 000407   200034 630500                    EPPR0   WORD_EXPONENT+2,,AUTO
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:399  
         5 000410   000001 631400 6                  EPPR1   1
         5 000411   000000 701000 xent               TSX1    X9DR$CVDQ
         5 000412   000000 011000                    NOP     0
         5 000413   000426 710000 5                  TRA     s:7795

     2359     7792    1      ELSE
     2360     7793    1        CALL X9DR$CVDR(FLOAT, REAL_RESULT.SINGLE_REAL, DESCRIPTOR) ;

   7793  5 000414   200014 631500                    EPPR1   DESCRIPTOR,,AUTO
         5 000415   200036 451500                    STP1    WORD_EXPONENT+4,,AUTO
         5 000416   200010 633500                    EPPR3   REAL_RESULT,,AUTO
         5 000417   200035 453500                    STP3    WORD_EXPONENT+3,,AUTO
         5 000420   000012 236000 6                  LDQ     10
         5 000421   200034 756100                    STQ     WORD_EXPONENT+2,,AUTO
         5 000422   200034 630500                    EPPR0   WORD_EXPONENT+2,,AUTO
         5 000423   000001 631400 6                  EPPR1   1
         5 000424   000000 701000 xent               TSX1    X9DR$CVDR
         5 000425   000000 011000                    NOP     0

     2361     7794
     2362     7795    1      TEMP_RESULT = REAL_RESULT ;

   7795  5 000426   200005 470500                    LDP0    @TEMP_RESULT,,AUTO
         5 000427   200010 237100                    LDAQ    REAL_RESULT,,AUTO
         5 000430   000000 755100                    STA     0,,PR0
         5 000431   000001 756100                    STQ     1,,PR0

     2363     7796
     2364     7797    1      RETURN;

   7797  5 000432   000000 702200 xent               TSX2  ! X66_ARET
     2365     7798    1   END Z8EC$FLOAT;
     2366     7799        %EOD;

PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:400  
--  Include file information  --

   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EC$FLOAT.
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:401  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 002 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 003  Data  Z8EC$FLOAT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(558)   r     1 FLOAT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @LENGTH                    5-0-0/w PTR         r     1 @TEMP_RESULT
     3-0-0/w PTR         r     1 @TEXT                      6-0-0/w PTR         r     1 @VALUE_OVERFLOW
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:402  
    12-0-0/w UBIN        r     1 COLUMN                    14-0-0/w STRC        r     1 DESC
    14-0-0/w UBIN        r     1 DESCRIPTOR                30-0-0/b BIT         r     1 DOUBLE_FLOAT
    31-0-0/w SBIN        r     1 I                         24-0-0/w UBIN        r     1 LEFT_LENGTH
    *0-0-0/w SBIN        r     1 LENGTH                    15-0-0/w STRC(216)   r     1 NUM_DESC
    13-0-0/w SBIN        r     1 OFFSET                    10-0-0/d STRC(72)    r     1 REAL_RESULT
    25-0-0/w UBIN        r     1 RIGHT_LENGTH              32-0-0/w STRC        r     1 TEMP_EXPONENT
    *0-0-0/w BIT (72)    r     1 TEMP_RESULT               *0-0-0/c ACHR        r     1 TEXT
    23-0-0/w UBIN        r     1 TOTAL_DIGITS              27-0-0/w SBIN        r     1 TOTAL_SIZE
    26-0-0/w UBIN        r     1 TOTAL_ZEROS               *0-0-0/w BIT         r     1 VALUE_OVERFLOW
    32-0-0/w SBIN        r     1 WORD_EXPONENT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(396)         1 ARRAY
     0-0-0/w STRC(396)         1 BLOCK                      0-0-0/w STRC(396)         1 CD
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(396)         1 CLASS
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)         1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(396)         1 DML_ITEM
     0-0-0/w STRC(396)         1 FD                         0-0-0/w STRC(396)         1 INTDEF
     0-0-0/w STRC(396)         1 LABEL                      0-0-0/w STRC(396)         1 MNEMONIC
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(396)         1 PARA
     0-0-0/w STRC(396)         1 PROC_                      0-0-0/w STRC(396)         1 PROC_DEF
     0-0-0/w STRC(396)         1 RD                         0-0-0/w STRC(396)         1 SCALAR
     0-0-0/w STRC(396)         1 SD                         0-0-0/w STRC(396)         1 SECTION
     0-0-0/w STRC(396)         1 SEGMENT                    0-0-0/w STRC(396)         1 ST
     0-0-0/w STRC(396)         1 SWITCH                     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR
PL6.E3A0      #002=Z8EC$FLOAT File=Z8EC.:Z8A6TSI                                 SAT 08/09/97 11:51 Page:403  
     0-0-0/w STRC(396)         1 SYMDEF_                    0-0-0/w STRC(396)         1 SYMREF_
     0-0-0/w STRC(396)         1 TEMP                       0-0-0/w STRC(396)         1 VARIABLE


   Procedure Z8EC$FLOAT requires 283 words for executable code.
   Procedure Z8EC$FLOAT requires 32 words of local(AUTO) storage.

PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:404  
     2367        1        /*T***********************************************************/
     2368        2        /*T*                                                         */
     2369        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2370        4        /*T*                                                         */
     2371        5        /*T***********************************************************/
     2372        6        Z8EC$INTERNAL_STRING_REP : PROC ( STRING$,
     2373        7                                          NEW_DNT$);
     2374        8
     2375        9    1   DCL STRING$ PTR;  /* TO LX_TERMINAL */
     2376       10    1   DCL NEW_DNT$ PTR;
     2377       11
     2378       12        %SET PHASE = 1;
     2379       13
     2380       14        %INCLUDE Z8A_DEFC;
     2381       82        %INCLUDE Z8A_SUPP_MAC;
     2382     2482        %INCLUDE Z8A_COMCOM;
     2383     3132        %INCLUDE Z8A_DNT;
     2384     3353        %INCLUDE Z8A_ST;
     2385     7012        %INCLUDE Z8A_TYPES;
     2386     7186        %INCLUDE Z8A_LTS;
     2387     9263        %INCLUDE Z8A_ERR_NUMS;
     2388    10027        %INCLUDE Z8E_WINDOW;
     2389    12097        %INCLUDE Z8E_TABLES;
     2390    12650        %INCLUDE Z8E_STACKS;
     2391    14916        %INCLUDE Z8E_MACROS;
     2392    15591        %INCLUDE Z8E_O1COM;
     2393    16352
     2394    16353    1   DCL Z8AH$SEARCH_ ENTRY;
     2395    16354    1   DCL Z8AE$ERROR ENTRY(12);
     2396    16355
     2397    16356    1   DCL LOC SBIN WORD;
     2398    16357    1   DCL LAST_LOC SBIN WORD;
     2399    16358    1   DCL DELIM CHAR(1);
     2400    16359    1   DCL ORDVAL SBIN WORD;
     2401    16360    1   DCL ITEM_CLASS SBIN WORD;
     2402    16361    1   DCL ORIG_DNT$ PTR;
     2403    16362
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:405  
     2404    16363
     2405    16364
     2406    16365    1     ADD_CHAR : PROC (CH);
     2407    16366
     2408    16367    2       DCL CH CHAR(1) CALIGNED;
     2409    16368
     2410    16369    2       LEX_SYMBOL.SIZE = MINIMUM (LEX_SYMBOL.SIZE + 1,
     2411    16370    2                                  %MAX_SYMBOL_SIZE_PLUS_1);
     2412    16371
     2413    16372    2       SUBSTR(LEX_SYMBOL.SYMBOL,
     2414    16373    2              LEX_SYMBOL.SIZE - 1,
     2415    16374    2              1) = CH;
     2416    16375
     2417    16376    2     END ADD_CHAR;
     2418    16377
     2419    16378
     2420    16379    1     ADD_STR : PROC (STR, LEN);
     2421    16380
     2422    16381    2       DCL LEN SBIN WORD;
     2423    16382    2       DCL STR CHAR(LEN) CALIGNED;
     2424    16383
     2425    16384    2       SUBSTR(LEX_SYMBOL.SYMBOL,
     2426    16385    2              LEX_SYMBOL.SIZE,
     2427    16386    2              MINIMUM (LEN,
     2428    16387    2                       %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE)) = STR;
     2429    16388
     2430    16389    2       LEX_SYMBOL.SIZE = MINIMUM (LEX_SYMBOL.SIZE + LEN,
     2431    16390    2                                  %MAX_SYMBOL_SIZE_PLUS_1);
     2432    16391
     2433    16392    2     END ADD_STR;
     2434    16393
     2435    16394        %EJECT;
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:406  
     2436    16395    1       KANJI_CHECK: PROC ALTRET ;
     2437    16396
     2438    16397    2         NEW_DNT$ = ORIG_DNT$ ;
     2439    16398
     2440    16399              /* Check that length of Kanji literal is even */
     2441    16400
     2442    16401    3         IF MOD (ORIG_DNT$ -> DNT.TEXT.LENGTH, 2) = 1 THEN DO ;
     2443    16402
     2444    16403                %CONDITIONAL_ERROR (@LX_ITEM$ = STRING$,
     2445    16404                                    @ERROR#   = %E$GRAPHIC_LITERAL_ODD,
     2446    16405                                    @LINE     = STRING$ -> LX_TERMINAL.LINE,
     2447    16406                                    @COLUMN   = STRING$ -> LX_TERMINAL.COLUMN) ;
     2448    16436    3           ALTRETURN ;
     2449    16437
     2450    16438    3         END ; /* Length is not even number of 9-bit bytes */
     2451    16439
     2452    16440    2         IF SUBSTR (ORIG_DNT$ -> DNT.TEXT.NAME,
     2453    16441    3              ORIG_DNT$ -> DNT.TEXT.LENGTH - 2, 1) ~= %KANJI_END THEN DO ;
     2454    16442
     2455    16443                %CONDITIONAL_ERROR (@LX_ITEM$ = STRING$,
     2456    16444                                    @ERROR#   = %E$ILLEGAL_GRAPHIC_LITERAL,
     2457    16445                                    @LINE     = STRING$ -> LX_TERMINAL.LINE,
     2458    16446                                    @COLUMN   = STRING$ -> LX_TERMINAL.COLUMN) ;
     2459    16476    3           ALTRETURN ;
     2460    16477
     2461    16478    3         END ; /* Last character is not Kanji_End (KE) */
     2462    16479
     2463    16480              /* Quickly check for embedded Kanji_End characters */
     2464    16481
     2465    16482    2         CALL INDEX (LOC,
     2466    16483    2                     %KANJI_END,
     2467    16484    2                     ORIG_DNT$ -> DNT.TEXT.NAME,
     2468    16485    2                     1) ;
     2469    16486
     2470    16487    3         IF LOC < ORIG_DNT$ -> DNT.TEXT.LENGTH - 2 THEN DO ;
     2471    16488
     2472    16489                /* There are embedded KE-KS pairs, so a new DNT must be created */
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:407  
     2473    16490
     2474    16491    3           LAST_LOC = 0 ;
     2475    16492
     2476    16493    4           DO WHILE LOC + 2 < ORIG_DNT$ -> DNT.TEXT.LENGTH ;
     2477    16494
     2478    16495    4             CALL ADD_STR (SUBSTR (ORIG_DNT$ -> DNT.TEXT.NAME,
     2479    16496    4                                   LAST_LOC,
     2480    16497    4                                   LOC - LAST_LOC),
     2481    16498    4                           LOC - LAST_LOC) ;
     2482    16499
     2483    16500    4             LAST_LOC = LOC ;
     2484    16501
     2485    16502                  /* LOC contains KE; see if LOC+1 contains KS */
     2486    16503
     2487    16504    4             IF SUBSTR (ORIG_DNT$ -> DNT.TEXT.NAME, LOC + 1, 1) ~=
     2488    16505    5                %KANJI_START THEN DO ;
     2489    16506
     2490    16507                    %CONDITIONAL_ERROR (@LX_ITEM$ = STRING$,
     2491    16508                                        @ERROR#   = %E$GRAPHIC_LITERAL_KE_KS_ERROR,
     2492    16509                                        @LINE     = STRING$ -> LX_TERMINAL.LINE,
     2493    16510                                        @COLUMN   = STRING$ -> LX_TERMINAL.COLUMN) ;
     2494    16540    5               ALTRETURN ;
     2495    16541
     2496    16542    5             END ; /* KS is missing after KE */
     2497    16543
     2498    16544    4             LAST_LOC = LOC + 2 ; /* Remove KE and KS */
     2499    16545    4             LOC      = LOC + 2 ;
     2500    16546
     2501    16547    4             CALL INDEX (LOC,
     2502    16548    4                         %KANJI_END,
     2503    16549    4                         ORIG_DNT$ -> DNT.TEXT.NAME,
     2504    16550    4                         LAST_LOC) ;
     2505    16551
     2506    16552    4           END ; /* Do While LOC+2 < original length */
     2507    16553
     2508    16554    3           CALL ADD_STR (SUBSTR (ORIG_DNT$ -> DNT.TEXT.NAME,
     2509    16555    3                                 LAST_LOC,
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:408  
     2510    16556    3                                 ORIG_DNT$ -> DNT.TEXT.LENGTH - LAST_LOC),
     2511    16557    3                         ORIG_DNT$ -> DNT.TEXT.LENGTH - LAST_LOC) ;
     2512    16558
     2513    16559    3           CALL Z8AH$SEARCH_ ;
     2514    16560    3           NEW_DNT$ = DNT$ ;
     2515    16561
     2516    16562    3         END ; /* There is an embedded KE-KS pair */
     2517    16563
     2518    16564    2       END KANJI_CHECK ;
     2519    16565
     2520    16566        %EJECT;
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:409  
     2521    16567    1       CHECK_KANJI_BYTES: PROC (DNT$$) ;
     2522    16568
     2523    16569    2         DCL  DNT$$      PTR ;
     2524    16570    2         DCL  CHARACTER  CHAR (1) ;
     2525    16571    2         DCL  CHAR_UBIN  REDEF CHARACTER UBIN BYTE UNAL ;
     2526    16572
     2527    16573              /* Check 2nd thru (n-1)th characters (exclude quotes). */
     2528    16574
     2529    16575    3         DO LOC = 1 TO DNT$$ -> DNT.TEXT.LENGTH - 2 ;
     2530    16576
     2531    16577    3           CHARACTER = SUBSTR (DNT$$ -> DNT.TEXT.NAME, LOC, 1) ;
     2532    16578
     2533    16579    4           IF CHAR_UBIN < 128 THEN DO ; /* (200)octal */
     2534    16580
     2535    16581                  %CONDITIONAL_ERROR (@LX_ITEM$ = STRING$,
     2536    16582                                      @ERROR#   = %E$ILLEGAL_GRAPHIC_CHARACTER,
     2537    16583                                      @LINE     = STRING$ -> LX_TERMINAL.LINE,
     2538    16584                                      @COLUMN   = STRING$ -> LX_TERMINAL.COLUMN) ;
     2539    16614    4             RETURN ;
     2540    16615
     2541    16616    4           END ; /* Found an illegel kanji character */
     2542    16617
     2543    16618    3         END ; /* Do While */
     2544    16619
     2545    16620    2       END CHECK_KANJI_BYTES ;
     2546    16621
     2547    16622        %EJECT;
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:410  
     2548    16623        /* Start of Z8EC$INTERNAL_STRING_REP */
     2549    16624
     2550    16625    1   LEX_SYMBOL.SIZE = 0;
     2551    16626
     2552    16627    2   DO CASE(STRING$ -> LX_TERMINAL.SYMBOL);
     2553    16628
     2554    16629    2     CASE(%SINGLE_QUOTE, %DOUBLE_QUOTE);
     2555    16630
     2556    16631    2       ORIG_DNT$ = STRING$ -> LX_TERMINAL.DNT$;
     2557    16632
     2558    16633        %EJECT;
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:411  
     2559    16634            /* Check Kanji literal for legality */
     2560    16635
     2561    16636    2       IF  STRING$ -> LX_TERMINAL.TYPE = %TYN
     2562    16637    3       AND SUBSTR (ORIG_DNT$ -> DNT.TEXT.NAME, 1, 1) = %KANJI_START THEN DO ;
     2563    16638
     2564    16639    3         CALL KANJI_CHECK ALTRET (ERROR_EXIT) ;
     2565    16640    3         CALL CHECK_KANJI_BYTES (NEW_DNT$) ;
     2566    16641    3         GOTO REGULAR_EXIT ;
     2567    16642
     2568    16643    3       END ; /* Kanji context */
     2569    16644
     2570    16645        %EJECT;
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:412  
     2571    16646            /* Quickly check the string for embedded quotes */
     2572    16647
     2573    16648    2       CALL INDEX (LOC,
     2574    16649    2                   SUBSTR(ORIG_DNT$ -> DNT.TEXT.NAME, 0, 1),
     2575    16650    2                   ORIG_DNT$ -> DNT.TEXT.NAME,
     2576    16651    2                   1);
     2577    16652
     2578    16653    2       IF LOC >= ORIG_DNT$ -> DNT.TEXT.LENGTH - 1 THEN
     2579    16654    2         NEW_DNT$ = ORIG_DNT$;
     2580    16655    2       ELSE
     2581    16656    3         DO;
     2582    16657                /* There are embedded quotes, so a new DNT must be created */
     2583    16658
     2584    16659
     2585    16660    3           DELIM = SUBSTR (ORIG_DNT$ -> DNT.TEXT.NAME,
     2586    16661    3                           0,
     2587    16662    3                           1);
     2588    16663
     2589    16664    3           IF SUBSTR(ORIG_DNT$ -> DNT.TEXT.NAME,
     2590    16665    3                     ORIG_DNT$ -> DNT.TEXT.LENGTH - 1,
     2591    16666    3                     1) ~= DELIM THEN
     2592    16667    3             GOTO STR_ERROR;
     2593    16668
     2594    16669    3           LAST_LOC = 0;
     2595    16670
     2596    16671    4           DO WHILE LOC + 2 < ORIG_DNT$ -> DNT.TEXT.LENGTH;
     2597    16672
     2598    16673    4             CALL ADD_STR (SUBSTR(ORIG_DNT$ -> DNT.TEXT.NAME,
     2599    16674    4                                  LAST_LOC,
     2600    16675    4                                  LOC - LAST_LOC),
     2601    16676    4                           LOC - LAST_LOC);
     2602    16677
     2603    16678    4             LAST_LOC = LOC;
     2604    16679
     2605    16680    4             IF SUBSTR(ORIG_DNT$ -> DNT.TEXT.NAME,
     2606    16681    4                       LOC + 1,
     2607    16682    4                      1) = DELIM THEN
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:413  
     2608    16683    5               DO;
     2609    16684    5                 CALL ADD_CHAR(DELIM);
     2610    16685    5                 LAST_LOC = LOC + 2;
     2611    16686    5                 LOC      = LOC + 2;
     2612    16687    5               END;
     2613    16688    4             ELSE
     2614    16689    5               DO;
     2615    16690                      /* Determine character type */
     2616    16691
     2617    16692    5                 LAST_LOC = LOC + 1;
     2618    16693    5                 CALL SEARCH (LOC,
     2619    16694    5                              ITEM_CLASS,
     2620    16695    5                              ASCII_SEARCH_TABLE,
     2621    16696    5                              ORIG_DNT$ -> DNT.TEXT.NAME,
     2622    16697    5                              LAST_LOC);
     2623    16698
     2624    16699    5                 IF ITEM_CLASS = %DIGIT THEN
     2625    16700    6                   DO;
     2626    16701    7                     DO WHILE ITEM_CLASS = %DIGIT;
     2627    16702
     2628    16703    7                       CALL SEARCH (LOC,
     2629    16704    7                                    ITEM_CLASS,
     2630    16705    7                                    DIGIT_SCAN_TABLE,
     2631    16706    7                                    ORIG_DNT$ -> DNT.TEXT.NAME,
     2632    16707    7                                    LAST_LOC);
     2633    16708
     2634    16709    7                       IF LOC - LAST_LOC > 10 THEN
     2635    16710    7                         GOTO STR_ERROR;
     2636    16711    7                       CALL CHARBIN (ORDVAL,
     2637    16712    7                                     SUBSTR(ORIG_DNT$ -> DNT.TEXT.NAME,
     2638    16713    7                                            LAST_LOC,
     2639    16714    7                                            LOC - LAST_LOC));
     2640    16715
     2641    16716    7                       IF ORDVAL > 512
     2642    16717    7                       OR ORDVAL = 0 THEN
     2643    16718    7                          GOTO BAD_ORDINAL;
     2644    16719
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:414  
     2645    16720    7                       IF COMCOM.OB.FIPS.LEVEL >= %HIGH_LEV AND
     2646    16721    7                           ORDVAL > 256 THEN
     2647    16722    7                         CALL Z8AE$ERROR (%E$NON_ANSI_ORDINAL,
     2648    16723    7                                          STRING$ -> LX_TERMINAL.LINE,
     2649    16724    7                                          STRING$ -> LX_TERMINAL.COLUMN);
     2650    16725
     2651    16726    7                       CALL ADD_CHAR (BINASC(ORDVAL - 1));
     2652    16727
     2653    16728                            /* Skip blanks & commas */
     2654    16729    8                       DO WHILE ITEM_CLASS = %SPACE OR ITEM_CLASS = %COMMA;
     2655    16730
     2656    16731    8                         CALL SEARCH (LOC,
     2657    16732    8                                      ITEM_CLASS,
     2658    16733    8                                      ASCII_SEARCH_TABLE,
     2659    16734    8                                      ORIG_DNT$ -> DNT.TEXT.NAME,
     2660    16735    8                                      LOC + 1);
     2661    16736
     2662    16737    8                       END;
     2663    16738
     2664    16739    7                       LAST_LOC = LOC;
     2665    16740    7                     END;  /* do while class */
     2666    16741
     2667    16742    6                     IF SUBSTR (ORIG_DNT$ -> DNT.TEXT.NAME,
     2668    16743    6                                LOC,
     2669    16744    6                               1) ~= DELIM THEN
     2670    16745    6                       GOTO STR_ERROR;
     2671    16746
     2672    16747    6                     LAST_LOC = LOC + 1;
     2673    16748    6                     LOC      = LOC + 1;
     2674    16749    6                   END;
     2675    16750    5                 ELSE
     2676    16751    5                   GOTO STR_ERROR;
     2677    16752    5               END;
     2678    16753
     2679    16754    4             CALL INDEX (LOC,
     2680    16755    4                         DELIM,
     2681    16756    4                         ORIG_DNT$ -> DNT.TEXT.NAME,
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:415  
     2682    16757    4                         LAST_LOC);
     2683    16758    4           END;  /* do while */
     2684    16759    3           IF LOC ~= ORIG_DNT$ -> DNT.TEXT.LENGTH - 1 THEN
     2685    16760    3             GOTO STR_ERROR;
     2686    16761
     2687    16762    3           CALL ADD_STR(SUBSTR(ORIG_DNT$ -> DNT.TEXT.NAME,
     2688    16763    3                               LAST_LOC,
     2689    16764    3                               ORIG_DNT$ -> DNT.TEXT.LENGTH - LAST_LOC),
     2690    16765    3                        ORIG_DNT$ -> DNT.TEXT.LENGTH - LAST_LOC);
     2691    16766
     2692    16767    3           CALL Z8AH$SEARCH_;
     2693    16768    3           NEW_DNT$ = DNT$;
     2694    16769
     2695    16770    3         END;
     2696    16771
     2697    16772              /* Check that length of Kanji literal is even */
     2698    16773
     2699    16774    3         IF STRING$ -> LX_TERMINAL.TYPE = %TYN THEN DO ;
     2700    16775
     2701    16776    4           IF MOD (NEW_DNT$ -> DNT.TEXT.LENGTH, 2) = 1 THEN DO ;
     2702    16777
     2703    16778                  %CONDITIONAL_ERROR (@LX_ITEM$ = STRING$,
     2704    16779                                      @ERROR#   = %E$GRAPHIC_LITERAL_ODD,
     2705    16780                                      @LINE     = STRING$ -> LX_TERMINAL.LINE,
     2706    16781                                      @COLUMN   = STRING$ -> LX_TERMINAL.COLUMN) ;
     2707    16811
     2708    16812    4           END ; /* Length is not even number of 9-bit bytes */
     2709    16813
     2710    16814    3           CALL CHECK_KANJI_BYTES (NEW_DNT$) ;
     2711    16815
     2712    16816    3         END ; /* String is type kanji */
     2713    16817
     2714    16818    2     CASE(ELSE);
     2715    16819
     2716    16820    3       DO SELECT (STRING$ -> LX_TERMINAL.SYMBOL);
     2717    16821
     2718    16822    3         SELECT(%RSV_WRD_ZEROES);
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:416  
     2719    16823
     2720    16824    3           CALL ADD_STR('"0"',3);
     2721    16825
     2722    16826    3         SELECT(%RSV_WRD_SPACES);
     2723    16827
     2724    16828    3           CALL ADD_STR('" "',3);
     2725    16829
     2726    16830    3         SELECT(%RSV_WRD_QUOTES);
     2727    16831
     2728    16832    3           CALL ADD_STR('"""', 3);
     2729    16833
     2730    16834    3         SELECT(%RSV_WRD_HIGH_VALUES);
     2731    16835
     2732    16836    3           CALL ADD_CHAR('"');
     2733    16837    3           CALL ADD_STR (O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ ->
     2734    16838    3                         PROC_SUPP.HIGH_VALUE, 1);
     2735    16839    3           CALL ADD_CHAR('"');
     2736    16840
     2737    16841    3         SELECT(%RSV_WRD_LOW_VALUES);
     2738    16842
     2739    16843    3           CALL ADD_CHAR('"');
     2740    16844    3           CALL ADD_STR (O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ ->
     2741    16845    3                         PROC_SUPP.LOW_VALUE, 1);
     2742    16846    3           CALL ADD_CHAR('"');
     2743    16847    3         SELECT(ELSE);
     2744    16848
     2745    16849    3           CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);
     2746    16850    3           CALL ADD_STR('" "', 3);
     2747    16851    3       END;
     2748    16852
     2749    16853    2       CALL Z8AH$SEARCH_;
     2750    16854    2       NEW_DNT$ = DNT$;
     2751    16855    2   END;  /* do case on LX_TERMINAL.SYMBOL */
     2752    16856
     2753    16857    1   REGULAR_EXIT:
     2754    16858
     2755    16859    1     RETURN;
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:417  
     2756    16860
     2757    16861    1   BAD_ORDINAL:
     2758    16862
     2759    16863          %CONDITIONAL_ERROR (@LX_ITEM$ = STRING$,
     2760    16864                              @ERROR# = %E$BAD_ORDINAL_CHARACTER,
     2761    16865                              @LINE = STRING$ -> LX_TERMINAL.LINE,
     2762    16866                              @COLUMN = STRING$ -> LX_TERMINAL.COLUMN);
     2763    16896
     2764    16897    1     GOTO ERROR_EXIT;
     2765    16898
     2766    16899    1   STR_ERROR:
     2767    16900
     2768    16901          %CONDITIONAL_ERROR (@LX_ITEM$ = STRING$,
     2769    16902                              @ERROR# = %E$EMBEDDED_QUOTES,
     2770    16903                              @LINE = STRING$ -> LX_TERMINAL.LINE,
     2771    16904                              @COLUMN = STRING$ -> LX_TERMINAL.COLUMN);
     2772    16934
     2773    16935    1   ERROR_EXIT:
     2774    16936
     2775    16937    1     NEW_DNT$ = ORIG_DNT$;
     2776    16938
     2777    16939    1     RETURN;
     2778    16940
     2779    16941    1   END Z8EC$INTERNAL_STRING_REP;

PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:418  
--  Include file information  --

   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_TABLES.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EC$INTERNAL_STRING_REP.

   Procedure Z8EC$INTERNAL_STRING_REP requires 680 words for executable code.
   Procedure Z8EC$INTERNAL_STRING_REP requires 30 words of local(AUTO) storage.

    No errors detected in file Z8EC.:Z8A6TSI    .

PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:419  

 Object Unit name= Z8EC$INTERNAL_STRING_REP                   File name= Z8EC.:Z8A6TOU
 UTS= AUG 09 '97 11:52:25.64 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  DNT$
    2  LblCom even  none     5      5  DNT_
    3  LblCom even  none     1      1  DNT_BUCKET_NUMBER
    4  LblCom even  none     1      1  DNT_OF_1$
    5  LblCom even  none     1      1  ST$
    6  LblCom even  none     5      5  ST_
    7  LblCom even  none     1      1  LTS$
    8  LblCom even  none     5      5  LTS_
    9  LblCom even  none    90    132  LEX_SYMBOL
   10  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
   11  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   12  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   13  RoData even  UTS      3      3  Z8EC$INTERNAL_STRING_REP
   14   Proc  even  none   680   1250  Z8EC$INTERNAL_STRING_REP
   15  RoData even  none    34     42  Z8EC$INTERNAL_STRING_REP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    14      0   yes            yes      Std        2  Z8EC$INTERNAL_STRING_REP
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:420  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 Z8AH$SEARCH_
         yes           Std      12 Z8AE$ERROR
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                           r    LTS_STEP                         r    USERWORD_SCAN_TABLE
r    ANSI_USERWORD_SCAN_TABLE         r    ASCII_SEARCH_TABLE               r    BLANK_SCAN_TABLE
r    DIGIT_SCAN_TABLE                 r    LETTER_SEARCH_TABLE              r    DOUBLE_QUOTE_SEARCH_TABLE
r    SINGLE_QUOTE_SEARCH_TABLE        r    DBL_QUOTE_PSEUDO_SEARCH_TABLE    r  SNGL_QUOTE_PSEUDO_SEARCH_TABLE
r    SEPARATORS_TABLE                 r    LOWER_TO_UPPER_CASE              r    CURRENCY_SIGN_CHARS
     O1COM                                 HIER_STK_PTR                          HIER_STK
     PAGE_FORMAT                           REP_STK_PTR                           REP_STK

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:421  


     2367        1        /*T***********************************************************/
     2368        2        /*T*                                                         */
     2369        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2370        4        /*T*                                                         */
     2371        5        /*T***********************************************************/
     2372        6        Z8EC$INTERNAL_STRING_REP : PROC ( STRING$,

      6 14 000000   000000 700200 xent  Z8EC$INTERN* TSX0  ! X66_AUTO_2
        14 000001   000036 000002                    ZERO    30,2
        14 000002   000367 710000 14                 TRA     s:16625

     2373        7                                          NEW_DNT$);
     2374        8
     2375        9    1   DCL STRING$ PTR;  /* TO LX_TERMINAL */
     2376       10    1   DCL NEW_DNT$ PTR;
     2377       11
     2378       12        %SET PHASE = 1;
     2379       13
     2380       14        %INCLUDE Z8A_DEFC;
     2381       82        %INCLUDE Z8A_SUPP_MAC;
     2382     2482        %INCLUDE Z8A_COMCOM;
     2383     3132        %INCLUDE Z8A_DNT;
     2384     3353        %INCLUDE Z8A_ST;
     2385     7012        %INCLUDE Z8A_TYPES;
     2386     7186        %INCLUDE Z8A_LTS;
     2387     9263        %INCLUDE Z8A_ERR_NUMS;
     2388    10027        %INCLUDE Z8E_WINDOW;
     2389    12097        %INCLUDE Z8E_TABLES;
     2390    12650        %INCLUDE Z8E_STACKS;
     2391    14916        %INCLUDE Z8E_MACROS;
     2392    15591        %INCLUDE Z8E_O1COM;
     2393    16352
     2394    16353    1   DCL Z8AH$SEARCH_ ENTRY;
     2395    16354    1   DCL Z8AE$ERROR ENTRY(12);
     2396    16355
     2397    16356    1   DCL LOC SBIN WORD;
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:422  
     2398    16357    1   DCL LAST_LOC SBIN WORD;
     2399    16358    1   DCL DELIM CHAR(1);
     2400    16359    1   DCL ORDVAL SBIN WORD;
     2401    16360    1   DCL ITEM_CLASS SBIN WORD;
     2402    16361    1   DCL ORIG_DNT$ PTR;
     2403    16362
     2404    16363
     2405    16364
     2406    16365    1     ADD_CHAR : PROC (CH);

  16365 14 000003   200014 741300       ADD_CHAR     STX1  ! ORIG_DNT$+2,,AUTO

     2407    16366
     2408    16367    2       DCL CH CHAR(1) CALIGNED;
     2409    16368
     2410    16369    2       LEX_SYMBOL.SIZE = MINIMUM (LEX_SYMBOL.SIZE + 1,

  16369 14 000004   000010 236000 9                  LDQ     LEX_SYMBOL+8
        14 000005   000001 036007                    ADLQ    1,DL
        14 000006   000504 116007                    CMPQ    324,DL
        14 000007   000011 604400 14                 TMOZ    s:16369+5
        14 000010   000504 236007                    LDQ     324,DL
        14 000011   000010 756000 9                  STQ     LEX_SYMBOL+8

     2411    16370    2                                  %MAX_SYMBOL_SIZE_PLUS_1);
     2412    16371
     2413    16372    2       SUBSTR(LEX_SYMBOL.SYMBOL,

  16372 14 000012   200015 470500                    LDP0    @CH,,AUTO
        14 000013   040006 100500                    MLR     fill='040'O
        14 000014   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        14 000015   000010 600001 9                  ADSC9   LEX_SYMBOL+8,Q           cn=3,n=1

     2414    16373    2              LEX_SYMBOL.SIZE - 1,
     2415    16374    2              1) = CH;
     2416    16375
     2417    16376    2     END ADD_CHAR;
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:423  

  16376 14 000016   000001 702211                    TSX2  ! 1,X1

     2418    16377
     2419    16378
     2420    16379    1     ADD_STR : PROC (STR, LEN);

  16379 14 000017   200016 741300       ADD_STR      STX1  ! @DNT$$+1,,AUTO

     2421    16380
     2422    16381    2       DCL LEN SBIN WORD;
     2423    16382    2       DCL STR CHAR(LEN) CALIGNED;
     2424    16383
     2425    16384    2       SUBSTR(LEX_SYMBOL.SYMBOL,

  16384 14 000020   000504 236007                    LDQ     324,DL
        14 000021   000010 136000 9                  SBLQ    LEX_SYMBOL+8
        14 000022   200020 470500                    LDP0    @LEN,,AUTO
        14 000023   000000 116100                    CMPQ    0,,PR0
        14 000024   000026 604400 14                 TMOZ    s:16384+6
        14 000025   000000 236100                    LDQ     0,,PR0
        14 000026   000000 720100                    LXL0    0,,PR0
        14 000027   200017 471500                    LDP1    @STR,,AUTO
        14 000030   000000 622006                    EAX2    0,QL
        14 000031   000010 235000 9                  LDA     LEX_SYMBOL+8
        14 000032   040045 100540                    MLR     fill='040'O
        14 000033   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
        14 000034   000011 000012 9                  ADSC9   LEX_SYMBOL+9,A           cn=0,n=*X2

     2426    16385    2              LEX_SYMBOL.SIZE,
     2427    16386    2              MINIMUM (LEN,
     2428    16387    2                       %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE)) = STR;
     2429    16388
     2430    16389    2       LEX_SYMBOL.SIZE = MINIMUM (LEX_SYMBOL.SIZE + LEN,

  16389 14 000035   000010 236000 9                  LDQ     LEX_SYMBOL+8
        14 000036   000000 036100                    ADLQ    0,,PR0
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:424  
        14 000037   000504 116007                    CMPQ    324,DL
        14 000040   000042 604400 14                 TMOZ    s:16389+5
        14 000041   000504 236007                    LDQ     324,DL
        14 000042   000010 756000 9                  STQ     LEX_SYMBOL+8

     2431    16390    2                                  %MAX_SYMBOL_SIZE_PLUS_1);
     2432    16391
     2433    16392    2     END ADD_STR;

  16392 14 000043   000001 702211                    TSX2  ! 1,X1

     2434    16393
     2435    16394        %EJECT;
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:425  
     2436    16395    1       KANJI_CHECK: PROC ALTRET ;

  16395 14 000044   200014 741300       KANJI_CHECK  STX1  ! ORIG_DNT$+2,,AUTO

     2437    16396
     2438    16397    2         NEW_DNT$ = ORIG_DNT$ ;

  16397 14 000045   200012 236100                    LDQ     ORIG_DNT$,,AUTO
        14 000046   200004 470500                    LDP0    @NEW_DNT$,,AUTO
        14 000047   000000 756100                    STQ     0,,PR0

     2439    16398
     2440    16399              /* Check that length of Kanji literal is even */
     2441    16400
     2442    16401    3         IF MOD (ORIG_DNT$ -> DNT.TEXT.LENGTH, 2) = 1 THEN DO ;

  16401 14 000050   200012 471500                    LDP1    ORIG_DNT$,,AUTO
        14 000051   100004 236100                    LDQ     4,,PR1
        14 000052   000022 772000                    QRL     18
        14 000053   000001 376007                    ANQ     1,DL
        14 000054   000001 116007                    CMPQ    1,DL
        14 000055   000103 601000 14                 TNZ     s:16440

     2443    16402
     2444    16403                %CONDITIONAL_ERROR (@LX_ITEM$ = STRING$,
     2445    16404                                    @ERROR#   = %E$GRAPHIC_LITERAL_ODD,
     2446    16405                                    @LINE     = STRING$ -> LX_TERMINAL.LINE,
     2447    16406                                    @COLUMN   = STRING$ -> LX_TERMINAL.COLUMN) ;

  16416 14 000056   200003 473500                    LDP3    @STRING$,,AUTO
        14 000057   300000 474500                    LDP4    0,,PR3
        14 000060   400000 236100                    LDQ     0,,PR4
        14 000061   400000 316007                    CANQ    -131072,DL
        14 000062   000101 601000 14                 TNZ     s:16436

  16418 14 000063   400006 635500                    EPPR5   6,,PR4
        14 000064   200024 455500                    STP5    @LEN+4,,AUTO
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:426  
        14 000065   400005 636500                    EPPR6   5,,PR4
        14 000066   200023 456500                    STP6    @LEN+3,,AUTO
        14 000067   000002 236000 15                 LDQ     2
        14 000070   200022 756100                    STQ     @LEN+2,,AUTO
        14 000071   200022 630500                    EPPR0   @LEN+2,,AUTO
        14 000072   000000 631400 15                 EPPR1   0
        14 000073   000000 701000 xent               TSX1    Z8AE$ERROR
        14 000074   000000 011000                    NOP     0

  16427 14 000075   200003 470500                    LDP0    @STRING$,,AUTO
        14 000076   000000 471500                    LDP1    0,,PR0
        14 000077   400000 236007                    LDQ     -131072,DL
        14 000100   100000 256100                    ORSQ    0,,PR1

     2448    16436    3           ALTRETURN ;

  16436 14 000101   200014 221300                    LDX1  ! ORIG_DNT$+2,,AUTO
        14 000102   000000 702211                    TSX2  ! 0,X1

     2449    16437
     2450    16438    3         END ; /* Length is not even number of 9-bit bytes */
     2451    16439
     2452    16440    2         IF SUBSTR (ORIG_DNT$ -> DNT.TEXT.NAME,

  16440 14 000103   100004 220100                    LDX0    4,,PR1
        14 000104   100004 236100                    LDQ     4,,PR1
        14 000105   000022 772000                    QRL     18
        14 000106   040000 106506                    CMPC    fill='040'O
        14 000107   100004 000001                    ADSC9   4,Q,PR1                  cn=0,n=1
        14 000110   000003 000001 15                 ADSC9   3                        cn=0,n=1
        14 000111   000137 600000 14                 TZE     s:16482

     2453    16441    3              ORIG_DNT$ -> DNT.TEXT.LENGTH - 2, 1) ~= %KANJI_END THEN DO ;

     2454    16442
     2455    16443                %CONDITIONAL_ERROR (@LX_ITEM$ = STRING$,
     2456    16444                                    @ERROR#   = %E$ILLEGAL_GRAPHIC_LITERAL,
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:427  
     2457    16445                                    @LINE     = STRING$ -> LX_TERMINAL.LINE,
     2458    16446                                    @COLUMN   = STRING$ -> LX_TERMINAL.COLUMN) ;

  16456 14 000112   200003 473500                    LDP3    @STRING$,,AUTO
        14 000113   300000 474500                    LDP4    0,,PR3
        14 000114   400000 236100                    LDQ     0,,PR4
        14 000115   400000 316007                    CANQ    -131072,DL
        14 000116   000135 601000 14                 TNZ     s:16476

  16458 14 000117   400006 635500                    EPPR5   6,,PR4
        14 000120   200024 455500                    STP5    @LEN+4,,AUTO
        14 000121   400005 636500                    EPPR6   5,,PR4
        14 000122   200023 456500                    STP6    @LEN+3,,AUTO
        14 000123   000005 236000 15                 LDQ     5
        14 000124   200022 756100                    STQ     @LEN+2,,AUTO
        14 000125   200022 630500                    EPPR0   @LEN+2,,AUTO
        14 000126   000000 631400 15                 EPPR1   0
        14 000127   000000 701000 xent               TSX1    Z8AE$ERROR
        14 000130   000000 011000                    NOP     0

  16467 14 000131   200003 470500                    LDP0    @STRING$,,AUTO
        14 000132   000000 471500                    LDP1    0,,PR0
        14 000133   400000 236007                    LDQ     -131072,DL
        14 000134   100000 256100                    ORSQ    0,,PR1

     2459    16476    3           ALTRETURN ;

  16476 14 000135   200014 221300                    LDX1  ! ORIG_DNT$+2,,AUTO
        14 000136   000000 702211                    TSX2  ! 0,X1

     2460    16477
     2461    16478    3         END ; /* Last character is not Kanji_End (KE) */
     2462    16479
     2463    16480              /* Quickly check for embedded Kanji_End characters */
     2464    16481
     2465    16482    2         CALL INDEX (LOC,

PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:428  
  16482 14 000137   777777 621010                    EAX1    -1,X0
        14 000140   000000 124540                    SCM     mask='000'O
        14 000141   100004 600011                    ADSC9   4,,PR1                   cn=3,n=*X1
        14 000142   000003 000001 15                 ADSC9   3                        cn=0,n=1
        14 000143   200005 000100                    ARG     LOC,,AUTO
        14 000144   200005 054100                    AOS     LOC,,AUTO

     2466    16483    2                     %KANJI_END,
     2467    16484    2                     ORIG_DNT$ -> DNT.TEXT.NAME,
     2468    16485    2                     1) ;
     2469    16486
     2470    16487    3         IF LOC < ORIG_DNT$ -> DNT.TEXT.LENGTH - 2 THEN DO ;

  16487 14 000145   000002 136007                    SBLQ    2,DL
        14 000146   200005 116100                    CMPQ    LOC,,AUTO
        14 000147   000307 604400 14                 TMOZ    s:16564

     2471    16488
     2472    16489                /* There are embedded KE-KS pairs, so a new DNT must be created */
     2473    16490
     2474    16491    3           LAST_LOC = 0 ;

  16491 14 000150   200006 450100                    STZ     LAST_LOC,,AUTO

     2475    16492
     2476    16493    4           DO WHILE LOC + 2 < ORIG_DNT$ -> DNT.TEXT.LENGTH ;

  16493 14 000151   000247 710000 14                 TRA     s:16552

     2477    16494
     2478    16495    4             CALL ADD_STR (SUBSTR (ORIG_DNT$ -> DNT.TEXT.NAME,

  16495 14 000152   200012 470500                    LDP0    ORIG_DNT$,,AUTO
        14 000153   000004 220100                    LDX0    4,,PR0
        14 000154   200005 236100                    LDQ     LOC,,AUTO
        14 000155   200006 136100                    SBLQ    LAST_LOC,,AUTO
        14 000156   200022 756100                    STQ     @LEN+2,,AUTO
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:429  
        14 000157   200005 236100                    LDQ     LOC,,AUTO
        14 000160   200006 136100                    SBLQ    LAST_LOC,,AUTO
        14 000161   200026 756100                    STQ     @LEN+6,,AUTO
        14 000162   200026 631500                    EPPR1   @LEN+6,,AUTO
        14 000163   200020 451500                    STP1    @LEN,,AUTO
        14 000164   200006 236100                    LDQ     LAST_LOC,,AUTO
        14 000165   000020 736000                    QLS     16
        14 000166   000006 036000 15                 ADLQ    6
        14 000167   200012 036100                    ADLQ    ORIG_DNT$,,AUTO
        14 000170   200017 756100                    STQ     @STR,,AUTO
        14 000171   000017 701000 14                 TSX1    ADD_STR
        14 000172   000000 011000                    NOP     0

     2479    16496    4                                   LAST_LOC,
     2480    16497    4                                   LOC - LAST_LOC),
     2481    16498    4                           LOC - LAST_LOC) ;
     2482    16499
     2483    16500    4             LAST_LOC = LOC ;

  16500 14 000173   200005 235100                    LDA     LOC,,AUTO
        14 000174   200006 755100                    STA     LAST_LOC,,AUTO

     2484    16501
     2485    16502                  /* LOC contains KE; see if LOC+1 contains KS */
     2486    16503
     2487    16504    4             IF SUBSTR (ORIG_DNT$ -> DNT.TEXT.NAME, LOC + 1, 1) ~=

  16504 14 000175   200012 470500                    LDP0    ORIG_DNT$,,AUTO
        14 000176   000004 220100                    LDX0    4,,PR0
        14 000177   040000 106505                    CMPC    fill='040'O
        14 000200   000004 600001                    ADSC9   4,A,PR0                  cn=3,n=1
        14 000201   000007 000001 15                 ADSC9   7                        cn=0,n=1
        14 000202   000230 600000 14                 TZE     s:16544

     2488    16505    5                %KANJI_START THEN DO ;

     2489    16506
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:430  
     2490    16507                    %CONDITIONAL_ERROR (@LX_ITEM$ = STRING$,
     2491    16508                                        @ERROR#   = %E$GRAPHIC_LITERAL_KE_KS_ERROR,
     2492    16509                                        @LINE     = STRING$ -> LX_TERMINAL.LINE,
     2493    16510                                        @COLUMN   = STRING$ -> LX_TERMINAL.COLUMN) ;

  16520 14 000203   200003 471500                    LDP1    @STRING$,,AUTO
        14 000204   100000 473500                    LDP3    0,,PR1
        14 000205   300000 236100                    LDQ     0,,PR3
        14 000206   400000 316007                    CANQ    -131072,DL
        14 000207   000226 601000 14                 TNZ     s:16540

  16522 14 000210   300006 634500                    EPPR4   6,,PR3
        14 000211   200024 454500                    STP4    @LEN+4,,AUTO
        14 000212   300005 635500                    EPPR5   5,,PR3
        14 000213   200023 455500                    STP5    @LEN+3,,AUTO
        14 000214   000011 236000 15                 LDQ     9
        14 000215   200022 756100                    STQ     @LEN+2,,AUTO
        14 000216   200022 630500                    EPPR0   @LEN+2,,AUTO
        14 000217   000000 631400 15                 EPPR1   0
        14 000220   000000 701000 xent               TSX1    Z8AE$ERROR
        14 000221   000000 011000                    NOP     0

  16531 14 000222   200003 470500                    LDP0    @STRING$,,AUTO
        14 000223   000000 471500                    LDP1    0,,PR0
        14 000224   400000 236007                    LDQ     -131072,DL
        14 000225   100000 256100                    ORSQ    0,,PR1

     2494    16540    5               ALTRETURN ;

  16540 14 000226   200014 221300                    LDX1  ! ORIG_DNT$+2,,AUTO
        14 000227   000000 702211                    TSX2  ! 0,X1

     2495    16541
     2496    16542    5             END ; /* KS is missing after KE */
     2497    16543
     2498    16544    4             LAST_LOC = LOC + 2 ; /* Remove KE and KS */

PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:431  
  16544 14 000230   000002 035007                    ADLA    2,DL
        14 000231   200006 755100                    STA     LAST_LOC,,AUTO

     2499    16545    4             LOC      = LOC + 2 ;

  16545 14 000232   000002 236007                    LDQ     2,DL
        14 000233   200005 056100                    ASQ     LOC,,AUTO

     2500    16546
     2501    16547    4             CALL INDEX (LOC,

  16547 14 000234   000000 636010                    EAQ     0,X0
        14 000235   000022 772000                    QRL     18
        14 000236   200006 136100                    SBLQ    LAST_LOC,,AUTO
        14 000237   200022 756100                    STQ     @LEN+2,,AUTO
        14 000240   200006 236100                    LDQ     LAST_LOC,,AUTO
        14 000241   200022 720100                    LXL0    @LEN+2,,AUTO
        14 000242   000000 124545                    SCM     mask='000'O
        14 000243   000004 400010                    ADSC9   4,A,PR0                  cn=2,n=*X0
        14 000244   000003 000001 15                 ADSC9   3                        cn=0,n=1
        14 000245   200005 000100                    ARG     LOC,,AUTO
        14 000246   200005 056100                    ASQ     LOC,,AUTO

     2502    16548    4                         %KANJI_END,
     2503    16549    4                         ORIG_DNT$ -> DNT.TEXT.NAME,
     2504    16550    4                         LAST_LOC) ;
     2505    16551
     2506    16552    4           END ; /* Do While LOC+2 < original length */

  16552 14 000247   200012 470500                    LDP0    ORIG_DNT$,,AUTO
        14 000250   000004 236100                    LDQ     4,,PR0
        14 000251   000022 772000                    QRL     18
        14 000252   200022 756100                    STQ     @LEN+2,,AUTO
        14 000253   200005 236100                    LDQ     LOC,,AUTO
        14 000254   000002 036007                    ADLQ    2,DL
        14 000255   200022 116100                    CMPQ    @LEN+2,,AUTO
        14 000256   000152 604000 14                 TMI     s:16495
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:432  

     2507    16553
     2508    16554    3           CALL ADD_STR (SUBSTR (ORIG_DNT$ -> DNT.TEXT.NAME,

  16554 14 000257   000004 220100                    LDX0    4,,PR0
        14 000260   000004 236100                    LDQ     4,,PR0
        14 000261   000022 772000                    QRL     18
        14 000262   200006 136100                    SBLQ    LAST_LOC,,AUTO
        14 000263   200022 756100                    STQ     @LEN+2,,AUTO
        14 000264   000004 236100                    LDQ     4,,PR0
        14 000265   000022 772000                    QRL     18
        14 000266   200006 136100                    SBLQ    LAST_LOC,,AUTO
        14 000267   200027 756100                    STQ     @LEN+7,,AUTO
        14 000270   200027 631500                    EPPR1   @LEN+7,,AUTO
        14 000271   200020 451500                    STP1    @LEN,,AUTO
        14 000272   200006 236100                    LDQ     LAST_LOC,,AUTO
        14 000273   000020 736000                    QLS     16
        14 000274   000006 036000 15                 ADLQ    6
        14 000275   200012 036100                    ADLQ    ORIG_DNT$,,AUTO
        14 000276   200017 756100                    STQ     @STR,,AUTO
        14 000277   000017 701000 14                 TSX1    ADD_STR
        14 000300   000000 011000                    NOP     0

     2509    16555    3                                 LAST_LOC,
     2510    16556    3                                 ORIG_DNT$ -> DNT.TEXT.LENGTH - LAST_LOC),
     2511    16557    3                         ORIG_DNT$ -> DNT.TEXT.LENGTH - LAST_LOC) ;
     2512    16558
     2513    16559    3           CALL Z8AH$SEARCH_ ;

  16559 14 000301   000012 631400 15                 EPPR1   10
        14 000302   000000 701000 xent               TSX1    Z8AH$SEARCH_
        14 000303   000000 011000                    NOP     0

     2514    16560    3           NEW_DNT$ = DNT$ ;

  16560 14 000304   000000 236000 1                  LDQ     DNT$
        14 000305   200004 470500                    LDP0    @NEW_DNT$,,AUTO
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:433  
        14 000306   000000 756100                    STQ     0,,PR0

     2515    16561
     2516    16562    3         END ; /* There is an embedded KE-KS pair */

     2517    16563
     2518    16564    2       END KANJI_CHECK ;

  16564 14 000307   200014 221300                    LDX1  ! ORIG_DNT$+2,,AUTO
        14 000310   000001 702211                    TSX2  ! 1,X1

     2519    16565
     2520    16566        %EJECT;
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:434  
     2521    16567    1       CHECK_KANJI_BYTES: PROC (DNT$$) ;

  16567 14 000311   200014 741300       CHECK_KANJI* STX1  ! ORIG_DNT$+2,,AUTO

     2522    16568
     2523    16569    2         DCL  DNT$$      PTR ;
     2524    16570    2         DCL  CHARACTER  CHAR (1) ;
     2525    16571    2         DCL  CHAR_UBIN  REDEF CHARACTER UBIN BYTE UNAL ;
     2526    16572
     2527    16573              /* Check 2nd thru (n-1)th characters (exclude quotes). */
     2528    16574
     2529    16575    3         DO LOC = 1 TO DNT$$ -> DNT.TEXT.LENGTH - 2 ;

  16575 14 000312   000001 235007                    LDA     1,DL
        14 000313   200005 755100                    STA     LOC,,AUTO
        14 000314   000356 710000 14                 TRA     s:16618+1

     2530    16576
     2531    16577    3           CHARACTER = SUBSTR (DNT$$ -> DNT.TEXT.NAME, LOC, 1) ;

  16577 14 000315   200015 470500                    LDP0    @DNT$$,,AUTO
        14 000316   000000 471500                    LDP1    0,,PR0
        14 000317   100004 220100                    LDX0    4,,PR1
        14 000320   200005 235100                    LDA     LOC,,AUTO
        14 000321   040100 100505                    MLR     fill='040'O
        14 000322   100004 400001                    ADSC9   4,A,PR1                  cn=2,n=1
        14 000323   200016 000001                    ADSC9   CHARACTER,,AUTO          cn=0,n=1

     2532    16578
     2533    16579    4           IF CHAR_UBIN < 128 THEN DO ; /* (200)octal */

  16579 14 000324   200016 236100                    LDQ     CHARACTER,,AUTO
        14 000325   777000 376003                    ANQ     -512,DU
        14 000326   200000 116003                    CMPQ    65536,DU
        14 000327   000355 603000 14                 TRC     s:16618

     2534    16580
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:435  
     2535    16581                  %CONDITIONAL_ERROR (@LX_ITEM$ = STRING$,
     2536    16582                                      @ERROR#   = %E$ILLEGAL_GRAPHIC_CHARACTER,
     2537    16583                                      @LINE     = STRING$ -> LX_TERMINAL.LINE,
     2538    16584                                      @COLUMN   = STRING$ -> LX_TERMINAL.COLUMN) ;

  16594 14 000330   200003 473500                    LDP3    @STRING$,,AUTO
        14 000331   300000 474500                    LDP4    0,,PR3
        14 000332   400000 236100                    LDQ     0,,PR4
        14 000333   400000 316007                    CANQ    -131072,DL
        14 000334   000353 601000 14                 TNZ     s:16614

  16596 14 000335   400006 635500                    EPPR5   6,,PR4
        14 000336   200024 455500                    STP5    @LEN+4,,AUTO
        14 000337   400005 631500                    EPPR1   5,,PR4
        14 000340   200023 451500                    STP1    @LEN+3,,AUTO
        14 000341   000014 236000 15                 LDQ     12
        14 000342   200022 756100                    STQ     @LEN+2,,AUTO
        14 000343   200022 630500                    EPPR0   @LEN+2,,AUTO
        14 000344   000000 631400 15                 EPPR1   0
        14 000345   000000 701000 xent               TSX1    Z8AE$ERROR
        14 000346   000000 011000                    NOP     0

  16605 14 000347   200003 470500                    LDP0    @STRING$,,AUTO
        14 000350   000000 471500                    LDP1    0,,PR0
        14 000351   400000 236007                    LDQ     -131072,DL
        14 000352   100000 256100                    ORSQ    0,,PR1

     2539    16614    4             RETURN ;

  16614 14 000353   200014 221300                    LDX1  ! ORIG_DNT$+2,,AUTO
        14 000354   000001 702211                    TSX2  ! 1,X1

     2540    16615
     2541    16616    4           END ; /* Found an illegel kanji character */
     2542    16617
     2543    16618    3         END ; /* Do While */

PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:436  
  16618 14 000355   200005 054100                    AOS     LOC,,AUTO
        14 000356   200015 470500                    LDP0    @DNT$$,,AUTO
        14 000357   000000 471500                    LDP1    0,,PR0
        14 000360   100004 236100                    LDQ     4,,PR1
        14 000361   000022 772000                    QRL     18
        14 000362   000002 136007                    SBLQ    2,DL
        14 000363   200005 116100                    CMPQ    LOC,,AUTO
        14 000364   000315 605000 14                 TPL     s:16577

     2544    16619
     2545    16620    2       END CHECK_KANJI_BYTES ;

  16620 14 000365   200014 221300                    LDX1  ! ORIG_DNT$+2,,AUTO
        14 000366   000001 702211                    TSX2  ! 1,X1

     2546    16621
     2547    16622        %EJECT;
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:437  
     2548    16623        /* Start of Z8EC$INTERNAL_STRING_REP */
     2549    16624
     2550    16625    1   LEX_SYMBOL.SIZE = 0;

  16625 14 000367   000010 450000 9                  STZ     LEX_SYMBOL+8

     2551    16626
     2552    16627    2   DO CASE(STRING$ -> LX_TERMINAL.SYMBOL);

  16627 14 000370   200003 470500                    LDP0    @STRING$,,AUTO
        14 000371   000000 471500                    LDP1    0,,PR0
        14 000372   100003 235100                    LDA     3,,PR1
        14 000373   000005 115007                    CMPA    5,DL
        14 000374   000376 602005 14                 TNC     s:16627+6,AL
        14 000375   001041 710000 14                 TRA     s:16820
        14 000376   001041 710000 14                 TRA     s:16820
        14 000377   001041 710000 14                 TRA     s:16820
        14 000400   001041 710000 14                 TRA     s:16820
        14 000401   000403 710000 14                 TRA     s:16631
        14 000402   000403 710000 14                 TRA     s:16631

     2553    16628
     2554    16629    2     CASE(%SINGLE_QUOTE, %DOUBLE_QUOTE);

     2555    16630
     2556    16631    2       ORIG_DNT$ = STRING$ -> LX_TERMINAL.DNT$;

  16631 14 000403   100002 236100                    LDQ     2,,PR1
        14 000404   200012 756100                    STQ     ORIG_DNT$,,AUTO

     2557    16632
     2558    16633        %EJECT;
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:438  
     2559    16634            /* Check Kanji literal for legality */
     2560    16635
     2561    16636    2       IF  STRING$ -> LX_TERMINAL.TYPE = %TYN

  16636 14 000405   100004 235100                    LDA     4,,PR1
        14 000406   000016 115007                    CMPA    14,DL
        14 000407   000425 601000 14                 TNZ     s:16648
        14 000410   200012 473500                    LDP3    ORIG_DNT$,,AUTO
        14 000411   300004 220100                    LDX0    4,,PR3
        14 000412   300004 236100                    LDQ     4,,PR3
        14 000413   000777 376007                    ANQ     511,DL
        14 000414   000216 116007                    CMPQ    142,DL
        14 000415   000425 601000 14                 TNZ     s:16648

     2562    16637    3       AND SUBSTR (ORIG_DNT$ -> DNT.TEXT.NAME, 1, 1) = %KANJI_START THEN DO ;

     2563    16638
     2564    16639    3         CALL KANJI_CHECK ALTRET (ERROR_EXIT) ;

  16639 14 000416   000044 701000 14                 TSX1    KANJI_CHECK
        14 000417   001244 702000 14                 TSX2    ERROR_EXIT

     2565    16640    3         CALL CHECK_KANJI_BYTES (NEW_DNT$) ;

  16640 14 000420   200004 236100                    LDQ     @NEW_DNT$,,AUTO
        14 000421   200015 756100                    STQ     ORIG_DNT$+3,,AUTO
        14 000422   000311 701000 14                 TSX1    CHECK_KANJI_BYTES
        14 000423   000000 011000                    NOP     0

     2566    16641    3         GOTO REGULAR_EXIT ;

  16641 14 000424   001174 710000 14                 TRA     REGULAR_EXIT

     2567    16642
     2568    16643    3       END ; /* Kanji context */
     2569    16644
     2570    16645        %EJECT;
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:439  
     2571    16646            /* Quickly check the string for embedded quotes */
     2572    16647
     2573    16648    2       CALL INDEX (LOC,

  16648 14 000425   200012 473500                    LDP3    ORIG_DNT$,,AUTO
        14 000426   300004 220100                    LDX0    4,,PR3
        14 000427   777777 621010                    EAX1    -1,X0
        14 000430   000100 124540                    SCM     mask='000'O
        14 000431   300004 600011                    ADSC9   4,,PR3                   cn=3,n=*X1
        14 000432   300004 400001                    ADSC9   4,,PR3                   cn=2,n=1
        14 000433   200005 000100                    ARG     LOC,,AUTO
        14 000434   200005 054100                    AOS     LOC,,AUTO

     2574    16649    2                   SUBSTR(ORIG_DNT$ -> DNT.TEXT.NAME, 0, 1),
     2575    16650    2                   ORIG_DNT$ -> DNT.TEXT.NAME,
     2576    16651    2                   1);
     2577    16652
     2578    16653    2       IF LOC >= ORIG_DNT$ -> DNT.TEXT.LENGTH - 1 THEN

  16653 14 000435   300004 236100                    LDQ     4,,PR3
        14 000436   000022 772000                    QRL     18
        14 000437   000001 136007                    SBLQ    1,DL
        14 000440   200005 116100                    CMPQ    LOC,,AUTO
        14 000441   000446 605400 14                 TPNZ    s:16660

     2579    16654    2         NEW_DNT$ = ORIG_DNT$;

  16654 14 000442   200012 236100                    LDQ     ORIG_DNT$,,AUTO
        14 000443   200004 474500                    LDP4    @NEW_DNT$,,AUTO
        14 000444   400000 756100                    STQ     0,,PR4
        14 000445   000777 710000 14                 TRA     s:16774

     2580    16655    2       ELSE
     2581    16656    3         DO;

     2582    16657                /* There are embedded quotes, so a new DNT must be created */
     2583    16658
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:440  
     2584    16659
     2585    16660    3           DELIM = SUBSTR (ORIG_DNT$ -> DNT.TEXT.NAME,

  16660 14 000446   300004 236100                    LDQ     4,,PR3
        14 000447   000022 736000                    QLS     18
        14 000450   777000 376003                    ANQ     -512,DU
        14 000451   000015 276000 15                 ORQ     13
        14 000452   200007 756100                    STQ     DELIM,,AUTO

     2586    16661    3                           0,
     2587    16662    3                           1);
     2588    16663
     2589    16664    3           IF SUBSTR(ORIG_DNT$ -> DNT.TEXT.NAME,

  16664 14 000453   300004 220100                    LDX0    4,,PR3
        14 000454   300004 236100                    LDQ     4,,PR3
        14 000455   000022 772000                    QRL     18
        14 000456   040100 106506                    CMPC    fill='040'O
        14 000457   300004 200001                    ADSC9   4,Q,PR3                  cn=1,n=1
        14 000460   200007 000001                    ADSC9   DELIM,,AUTO              cn=0,n=1
        14 000461   001221 601000 14                 TNZ     STR_ERROR

     2590    16665    3                     ORIG_DNT$ -> DNT.TEXT.LENGTH - 1,
     2591    16666    3                     1) ~= DELIM THEN
     2592    16667    3             GOTO STR_ERROR;
     2593    16668
     2594    16669    3           LAST_LOC = 0;

  16669 14 000462   200006 450100                    STZ     LAST_LOC,,AUTO

     2595    16670
     2596    16671    4           DO WHILE LOC + 2 < ORIG_DNT$ -> DNT.TEXT.LENGTH;

  16671 14 000463   000732 710000 14                 TRA     s:16758

     2597    16672
     2598    16673    4             CALL ADD_STR (SUBSTR(ORIG_DNT$ -> DNT.TEXT.NAME,
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:441  

  16673 14 000464   200012 470500                    LDP0    ORIG_DNT$,,AUTO
        14 000465   000004 220100                    LDX0    4,,PR0
        14 000466   200005 236100                    LDQ     LOC,,AUTO
        14 000467   200006 136100                    SBLQ    LAST_LOC,,AUTO
        14 000470   200022 756100                    STQ     @LEN+2,,AUTO
        14 000471   200005 236100                    LDQ     LOC,,AUTO
        14 000472   200006 136100                    SBLQ    LAST_LOC,,AUTO
        14 000473   200030 756100                    STQ     @LEN+8,,AUTO
        14 000474   200030 631500                    EPPR1   @LEN+8,,AUTO
        14 000475   200020 451500                    STP1    @STR+1,,AUTO
        14 000476   200006 236100                    LDQ     LAST_LOC,,AUTO
        14 000477   000020 736000                    QLS     16
        14 000500   000006 036000 15                 ADLQ    6
        14 000501   200012 036100                    ADLQ    ORIG_DNT$,,AUTO
        14 000502   200017 756100                    STQ     CHARACTER+1,,AUTO
        14 000503   000017 701000 14                 TSX1    ADD_STR
        14 000504   000000 011000                    NOP     0

     2599    16674    4                                  LAST_LOC,
     2600    16675    4                                  LOC - LAST_LOC),
     2601    16676    4                           LOC - LAST_LOC);
     2602    16677
     2603    16678    4             LAST_LOC = LOC;

  16678 14 000505   200005 235100                    LDA     LOC,,AUTO
        14 000506   200006 755100                    STA     LAST_LOC,,AUTO

     2604    16679
     2605    16680    4             IF SUBSTR(ORIG_DNT$ -> DNT.TEXT.NAME,

  16680 14 000507   200012 470500                    LDP0    ORIG_DNT$,,AUTO
        14 000510   000004 220100                    LDX0    4,,PR0
        14 000511   040100 106505                    CMPC    fill='040'O
        14 000512   000004 600001                    ADSC9   4,A,PR0                  cn=3,n=1
        14 000513   200007 000001                    ADSC9   DELIM,,AUTO              cn=0,n=1
        14 000514   000527 601000 14                 TNZ     s:16692
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:442  

     2606    16681    4                       LOC + 1,
     2607    16682    4                      1) = DELIM THEN
     2608    16683    5               DO;

     2609    16684    5                 CALL ADD_CHAR(DELIM);

  16684 14 000515   200007 631500                    EPPR1   DELIM,,AUTO
        14 000516   200015 451500                    STP1    ORIG_DNT$+3,,AUTO
        14 000517   000003 701000 14                 TSX1    ADD_CHAR
        14 000520   000000 011000                    NOP     0

     2610    16685    5                 LAST_LOC = LOC + 2;

  16685 14 000521   200005 235100                    LDA     LOC,,AUTO
        14 000522   000002 035007                    ADLA    2,DL
        14 000523   200006 755100                    STA     LAST_LOC,,AUTO

     2611    16686    5                 LOC      = LOC + 2;

  16686 14 000524   000002 236007                    LDQ     2,DL
        14 000525   200005 056100                    ASQ     LOC,,AUTO

     2612    16687    5               END;

  16687 14 000526   000715 710000 14                 TRA     s:16754

     2613    16688    4             ELSE
     2614    16689    5               DO;

     2615    16690                      /* Determine character type */
     2616    16691
     2617    16692    5                 LAST_LOC = LOC + 1;

  16692 14 000527   000001 035007                    ADLA    1,DL
        14 000530   200006 755100                    STA     LAST_LOC,,AUTO

PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:443  
     2618    16693    5                 CALL SEARCH (LOC,

  16693 14 000531   000000 636010                    EAQ     0,X0
        14 000532   000022 772000                    QRL     18
        14 000533   200006 136100                    SBLQ    LAST_LOC,,AUTO
        14 000534   200022 756100                    STQ     @LEN+2,,AUTO
        14 000535   200006 236100                    LDQ     LAST_LOC,,AUTO
        14 000536   200022 720100                    LXL0    @LEN+2,,AUTO
        14 000537   000000 164546                    TCT
        14 000540   000004 400010                    ADSC9   4,Q,PR0                  cn=2,n=*X0
        14 000541   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        14 000542   200005 000100                    ARG     LOC,,AUTO
        14 000543   200005 235100                    LDA     LOC,,AUTO
        14 000544   000033 771000                    ARL     27
        14 000545   200011 755100                    STA     ITEM_CLASS,,AUTO
        14 000546   200005 551140                    STBA    LOC,'40'O,AUTO
        14 000547   200005 056100                    ASQ     LOC,,AUTO

     2619    16694    5                              ITEM_CLASS,
     2620    16695    5                              ASCII_SEARCH_TABLE,
     2621    16696    5                              ORIG_DNT$ -> DNT.TEXT.NAME,
     2622    16697    5                              LAST_LOC);
     2623    16698
     2624    16699    5                 IF ITEM_CLASS = %DIGIT THEN

  16699 14 000550   000002 115007                    CMPA    2,DL
        14 000551   001221 601000 14                 TNZ     STR_ERROR

     2625    16700    6                   DO;

     2626    16701    7                     DO WHILE ITEM_CLASS = %DIGIT;

  16701 14 000552   000702 601000 14                 TNZ     s:16742

     2627    16702
     2628    16703    7                       CALL SEARCH (LOC,

PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:444  
  16703 14 000553   200012 470500                    LDP0    ORIG_DNT$,,AUTO
        14 000554   000004 220100                    LDX0    4,,PR0
        14 000555   000000 636010                    EAQ     0,X0
        14 000556   000022 772000                    QRL     18
        14 000557   200006 136100                    SBLQ    LAST_LOC,,AUTO
        14 000560   200022 756100                    STQ     @LEN+2,,AUTO
        14 000561   200006 236100                    LDQ     LAST_LOC,,AUTO
        14 000562   200022 720100                    LXL0    @LEN+2,,AUTO
        14 000563   000000 164546                    TCT
        14 000564   000004 400010                    ADSC9   4,Q,PR0                  cn=2,n=*X0
        14 000565   000000 000000 xsym               ARG     DIGIT_SCAN_TABLE
        14 000566   200005 000100                    ARG     LOC,,AUTO
        14 000567   200005 235100                    LDA     LOC,,AUTO
        14 000570   000033 771000                    ARL     27
        14 000571   200011 755100                    STA     ITEM_CLASS,,AUTO
        14 000572   200005 551140                    STBA    LOC,'40'O,AUTO
        14 000573   200005 056100                    ASQ     LOC,,AUTO

     2629    16704    7                                    ITEM_CLASS,
     2630    16705    7                                    DIGIT_SCAN_TABLE,
     2631    16706    7                                    ORIG_DNT$ -> DNT.TEXT.NAME,
     2632    16707    7                                    LAST_LOC);
     2633    16708
     2634    16709    7                       IF LOC - LAST_LOC > 10 THEN

  16709 14 000574   200005 236100                    LDQ     LOC,,AUTO
        14 000575   200006 136100                    SBLQ    LAST_LOC,,AUTO
        14 000576   000012 116007                    CMPQ    10,DL
        14 000577   001221 605400 14                 TPNZ    STR_ERROR

     2635    16710    7                         GOTO STR_ERROR;
     2636    16711    7                       CALL CHARBIN (ORDVAL,

  16711 14 000600   000004 220100                    LDX0    4,,PR0
        14 000601   200005 236100                    LDQ     LOC,,AUTO
        14 000602   200006 136100                    SBLQ    LAST_LOC,,AUTO
        14 000603   000000 621006                    EAX1    0,QL
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:445  
        14 000604   200006 236100                    LDQ     LAST_LOC,,AUTO
        14 000605   000100 305546                    DTB
        14 000606   000004 430011                    NDSC9   4,Q,PR0                  cn=2,s=nosgn,sf=0,n=*X1
        14 000607   200010 000004                    NDSC9   ORDVAL,,AUTO             cn=0,s=lsgnf,sf=0,n=4

     2637    16712    7                                     SUBSTR(ORIG_DNT$ -> DNT.TEXT.NAME,
     2638    16713    7                                            LAST_LOC,
     2639    16714    7                                            LOC - LAST_LOC));
     2640    16715
     2641    16716    7                       IF ORDVAL > 512

  16716 14 000610   200010 235100                    LDA     ORDVAL,,AUTO
        14 000611   001000 115007                    CMPA    512,DL
        14 000612   001175 605400 14                 TPNZ    BAD_ORDINAL
        14 000613   000000 115003                    CMPA    0,DU
        14 000614   001175 600000 14                 TZE     BAD_ORDINAL

     2642    16717    7                       OR ORDVAL = 0 THEN
     2643    16718    7                          GOTO BAD_ORDINAL;
     2644    16719
     2645    16720    7                       IF COMCOM.OB.FIPS.LEVEL >= %HIGH_LEV AND

  16720 14 000615   000036 721000 xsym               LXL1    COMCOM+30
        14 000616   000635 604400 14                 TMOZ    s:16726
        14 000617   000400 115007                    CMPA    256,DL
        14 000620   000635 604400 14                 TMOZ    s:16726

     2646    16721    7                           ORDVAL > 256 THEN
     2647    16722    7                         CALL Z8AE$ERROR (%E$NON_ANSI_ORDINAL,

  16722 14 000621   200003 471500                    LDP1    @STRING$,,AUTO
        14 000622   100000 473500                    LDP3    0,,PR1
        14 000623   300006 634500                    EPPR4   6,,PR3
        14 000624   200024 454500                    STP4    @LEN+4,,AUTO
        14 000625   300005 635500                    EPPR5   5,,PR3
        14 000626   200023 455500                    STP5    @LEN+3,,AUTO
        14 000627   000017 236000 15                 LDQ     15
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:446  
        14 000630   200022 756100                    STQ     @LEN+2,,AUTO
        14 000631   200022 630500                    EPPR0   @LEN+2,,AUTO
        14 000632   000000 631400 15                 EPPR1   0
        14 000633   000000 701000 xent               TSX1    Z8AE$ERROR
        14 000634   000000 011000                    NOP     0

     2648    16723    7                                          STRING$ -> LX_TERMINAL.LINE,
     2649    16724    7                                          STRING$ -> LX_TERMINAL.COLUMN);
     2650    16725
     2651    16726    7                       CALL ADD_CHAR (BINASC(ORDVAL - 1));

  16726 14 000635   200010 236100                    LDQ     ORDVAL,,AUTO
        14 000636   000001 136007                    SBLQ    1,DL
        14 000637   000033 736000                    QLS     27
        14 000640   000015 276000 15                 ORQ     13
        14 000641   200032 552140                    STBQ    @LEN+10,'40'O,AUTO
        14 000642   200032 630500                    EPPR0   @LEN+10,,AUTO
        14 000643   200015 450500                    STP0    ORIG_DNT$+3,,AUTO
        14 000644   000003 701000 14                 TSX1    ADD_CHAR
        14 000645   000000 011000                    NOP     0

     2652    16727
     2653    16728                            /* Skip blanks & commas */
     2654    16729    8                       DO WHILE ITEM_CLASS = %SPACE OR ITEM_CLASS = %COMMA;

  16729 14 000646   000671 710000 14                 TRA     s:16737

     2655    16730
     2656    16731    8                         CALL SEARCH (LOC,

  16731 14 000647   200012 470500                    LDP0    ORIG_DNT$,,AUTO
        14 000650   000004 220100                    LDX0    4,,PR0
        14 000651   000000 636010                    EAQ     0,X0
        14 000652   000022 772000                    QRL     18
        14 000653   200005 136100                    SBLQ    LOC,,AUTO
        14 000654   777777 621006                    EAX1    -1,QL
        14 000655   200005 236100                    LDQ     LOC,,AUTO
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:447  
        14 000656   000001 036007                    ADLQ    1,DL
        14 000657   200005 235100                    LDA     LOC,,AUTO
        14 000660   000000 164545                    TCT
        14 000661   000004 600011                    ADSC9   4,A,PR0                  cn=3,n=*X1
        14 000662   000000 000000 xsym               ARG     ASCII_SEARCH_TABLE
        14 000663   200005 000100                    ARG     LOC,,AUTO
        14 000664   200005 235100                    LDA     LOC,,AUTO
        14 000665   000033 771000                    ARL     27
        14 000666   200011 755100                    STA     ITEM_CLASS,,AUTO
        14 000667   200005 551140                    STBA    LOC,'40'O,AUTO
        14 000670   200005 056100                    ASQ     LOC,,AUTO

     2657    16732    8                                      ITEM_CLASS,
     2658    16733    8                                      ASCII_SEARCH_TABLE,
     2659    16734    8                                      ORIG_DNT$ -> DNT.TEXT.NAME,
     2660    16735    8                                      LOC + 1);
     2661    16736
     2662    16737    8                       END;

  16737 14 000671   200011 235100                    LDA     ITEM_CLASS,,AUTO
        14 000672   000042 115007                    CMPA    34,DL
        14 000673   000647 600000 14                 TZE     s:16731
        14 000674   000035 115007                    CMPA    29,DL
        14 000675   000647 600000 14                 TZE     s:16731

     2663    16738
     2664    16739    7                       LAST_LOC = LOC;

  16739 14 000676   200005 236100                    LDQ     LOC,,AUTO
        14 000677   200006 756100                    STQ     LAST_LOC,,AUTO

     2665    16740    7                     END;  /* do while class */

  16740 14 000700   000002 115007                    CMPA    2,DL
        14 000701   000553 600000 14                 TZE     s:16703

     2666    16741
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:448  
     2667    16742    6                     IF SUBSTR (ORIG_DNT$ -> DNT.TEXT.NAME,

  16742 14 000702   200012 470500                    LDP0    ORIG_DNT$,,AUTO
        14 000703   000004 220100                    LDX0    4,,PR0
        14 000704   200005 235100                    LDA     LOC,,AUTO
        14 000705   040100 106505                    CMPC    fill='040'O
        14 000706   000004 400001                    ADSC9   4,A,PR0                  cn=2,n=1
        14 000707   200007 000001                    ADSC9   DELIM,,AUTO              cn=0,n=1
        14 000710   001221 601000 14                 TNZ     STR_ERROR

     2668    16743    6                                LOC,
     2669    16744    6                               1) ~= DELIM THEN
     2670    16745    6                       GOTO STR_ERROR;
     2671    16746
     2672    16747    6                     LAST_LOC = LOC + 1;

  16747 14 000711   000001 035007                    ADLA    1,DL
        14 000712   200006 755100                    STA     LAST_LOC,,AUTO

     2673    16748    6                     LOC      = LOC + 1;

  16748 14 000713   200005 054100                    AOS     LOC,,AUTO

     2674    16749    6                   END;

  16749 14 000714   000715 710000 14                 TRA     s:16754

     2675    16750    5                 ELSE
     2676    16751    5                   GOTO STR_ERROR;
     2677    16752    5               END;
     2678    16753
     2679    16754    4             CALL INDEX (LOC,

  16754 14 000715   200012 470500                    LDP0    ORIG_DNT$,,AUTO
        14 000716   000004 220100                    LDX0    4,,PR0
        14 000717   000000 636010                    EAQ     0,X0
        14 000720   000022 772000                    QRL     18
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:449  
        14 000721   200006 136100                    SBLQ    LAST_LOC,,AUTO
        14 000722   200022 756100                    STQ     @LEN+2,,AUTO
        14 000723   200006 236100                    LDQ     LAST_LOC,,AUTO
        14 000724   200022 720100                    LXL0    @LEN+2,,AUTO
        14 000725   000100 124545                    SCM     mask='000'O
        14 000726   000004 400010                    ADSC9   4,A,PR0                  cn=2,n=*X0
        14 000727   200007 000001                    ADSC9   DELIM,,AUTO              cn=0,n=1
        14 000730   200005 000100                    ARG     LOC,,AUTO
        14 000731   200005 056100                    ASQ     LOC,,AUTO

     2680    16755    4                         DELIM,
     2681    16756    4                         ORIG_DNT$ -> DNT.TEXT.NAME,
     2682    16757    4                         LAST_LOC);
     2683    16758    4           END;  /* do while */

  16758 14 000732   200012 470500                    LDP0    ORIG_DNT$,,AUTO
        14 000733   000004 236100                    LDQ     4,,PR0
        14 000734   000022 772000                    QRL     18
        14 000735   200022 756100                    STQ     @LEN+2,,AUTO
        14 000736   200005 236100                    LDQ     LOC,,AUTO
        14 000737   000002 036007                    ADLQ    2,DL
        14 000740   200022 116100                    CMPQ    @LEN+2,,AUTO
        14 000741   000464 604000 14                 TMI     s:16673

     2684    16759    3           IF LOC ~= ORIG_DNT$ -> DNT.TEXT.LENGTH - 1 THEN

  16759 14 000742   000004 236100                    LDQ     4,,PR0
        14 000743   000022 772000                    QRL     18
        14 000744   000001 136007                    SBLQ    1,DL
        14 000745   200005 116100                    CMPQ    LOC,,AUTO
        14 000746   001221 601000 14                 TNZ     STR_ERROR

     2685    16760    3             GOTO STR_ERROR;
     2686    16761
     2687    16762    3           CALL ADD_STR(SUBSTR(ORIG_DNT$ -> DNT.TEXT.NAME,

  16762 14 000747   000004 220100                    LDX0    4,,PR0
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:450  
        14 000750   000004 236100                    LDQ     4,,PR0
        14 000751   000022 772000                    QRL     18
        14 000752   200006 136100                    SBLQ    LAST_LOC,,AUTO
        14 000753   200022 756100                    STQ     @LEN+2,,AUTO
        14 000754   000004 236100                    LDQ     4,,PR0
        14 000755   000022 772000                    QRL     18
        14 000756   200006 136100                    SBLQ    LAST_LOC,,AUTO
        14 000757   200034 756100                    STQ     @LEN+12,,AUTO
        14 000760   200034 631500                    EPPR1   @LEN+12,,AUTO
        14 000761   200020 451500                    STP1    @STR+1,,AUTO
        14 000762   200006 236100                    LDQ     LAST_LOC,,AUTO
        14 000763   000020 736000                    QLS     16
        14 000764   000006 036000 15                 ADLQ    6
        14 000765   200012 036100                    ADLQ    ORIG_DNT$,,AUTO
        14 000766   200017 756100                    STQ     CHARACTER+1,,AUTO
        14 000767   000017 701000 14                 TSX1    ADD_STR
        14 000770   000000 011000                    NOP     0

     2688    16763    3                               LAST_LOC,
     2689    16764    3                               ORIG_DNT$ -> DNT.TEXT.LENGTH - LAST_LOC),
     2690    16765    3                        ORIG_DNT$ -> DNT.TEXT.LENGTH - LAST_LOC);
     2691    16766
     2692    16767    3           CALL Z8AH$SEARCH_;

  16767 14 000771   000012 631400 15                 EPPR1   10
        14 000772   000000 701000 xent               TSX1    Z8AH$SEARCH_
        14 000773   000000 011000                    NOP     0

     2693    16768    3           NEW_DNT$ = DNT$;

  16768 14 000774   000000 236000 1                  LDQ     DNT$
        14 000775   200004 470500                    LDP0    @NEW_DNT$,,AUTO
        14 000776   000000 756100                    STQ     0,,PR0

     2694    16769
     2695    16770    3         END;

PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:451  
     2696    16771
     2697    16772              /* Check that length of Kanji literal is even */
     2698    16773
     2699    16774    3         IF STRING$ -> LX_TERMINAL.TYPE = %TYN THEN DO ;

  16774 14 000777   200003 470500                    LDP0    @STRING$,,AUTO
        14 001000   000000 471500                    LDP1    0,,PR0
        14 001001   100004 235100                    LDA     4,,PR1
        14 001002   000016 115007                    CMPA    14,DL
        14 001003   001174 601000 14                 TNZ     REGULAR_EXIT

     2700    16775
     2701    16776    4           IF MOD (NEW_DNT$ -> DNT.TEXT.LENGTH, 2) = 1 THEN DO ;

  16776 14 001004   200004 473500                    LDP3    @NEW_DNT$,,AUTO
        14 001005   300000 474500                    LDP4    0,,PR3
        14 001006   400004 236100                    LDQ     4,,PR4
        14 001007   000022 772000                    QRL     18
        14 001010   000001 376007                    ANQ     1,DL
        14 001011   000001 116007                    CMPQ    1,DL
        14 001012   001034 601000 14                 TNZ     s:16814

     2702    16777
     2703    16778                  %CONDITIONAL_ERROR (@LX_ITEM$ = STRING$,
     2704    16779                                      @ERROR#   = %E$GRAPHIC_LITERAL_ODD,
     2705    16780                                      @LINE     = STRING$ -> LX_TERMINAL.LINE,
     2706    16781                                      @COLUMN   = STRING$ -> LX_TERMINAL.COLUMN) ;

  16791 14 001013   100000 236100                    LDQ     0,,PR1
        14 001014   400000 316007                    CANQ    -131072,DL
        14 001015   001034 601000 14                 TNZ     s:16814

  16793 14 001016   100006 635500                    EPPR5   6,,PR1
        14 001017   200024 455500                    STP5    @LEN+4,,AUTO
        14 001020   100005 634500                    EPPR4   5,,PR1
        14 001021   200023 454500                    STP4    @LEN+3,,AUTO
        14 001022   000002 236000 15                 LDQ     2
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:452  
        14 001023   200022 756100                    STQ     @LEN+2,,AUTO
        14 001024   200022 630500                    EPPR0   @LEN+2,,AUTO
        14 001025   000000 631400 15                 EPPR1   0
        14 001026   000000 701000 xent               TSX1    Z8AE$ERROR
        14 001027   000000 011000                    NOP     0

  16802 14 001030   200003 470500                    LDP0    @STRING$,,AUTO
        14 001031   000000 471500                    LDP1    0,,PR0
        14 001032   400000 236007                    LDQ     -131072,DL
        14 001033   100000 256100                    ORSQ    0,,PR1

     2707    16811
     2708    16812    4           END ; /* Length is not even number of 9-bit bytes */

     2709    16813
     2710    16814    3           CALL CHECK_KANJI_BYTES (NEW_DNT$) ;

  16814 14 001034   200004 236100                    LDQ     @NEW_DNT$,,AUTO
        14 001035   200015 756100                    STQ     ORIG_DNT$+3,,AUTO
        14 001036   000311 701000 14                 TSX1    CHECK_KANJI_BYTES
        14 001037   000000 011000                    NOP     0

     2711    16815
     2712    16816    3         END ; /* String is type kanji */

  16816 14 001040   001174 710000 14                 TRA     REGULAR_EXIT

     2713    16817
     2714    16818    2     CASE(ELSE);

     2715    16819
     2716    16820    3       DO SELECT (STRING$ -> LX_TERMINAL.SYMBOL);

  16820 14 001041   100003 236100                    LDQ     3,,PR1
        14 001042   000650 116007                    CMPQ    424,DL
        14 001043   001050 604000 14                 TMI     s:16820+7
        14 001044   001070 600000 14                 TZE     s:16828
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:453  
        14 001045   000761 116007                    CMPQ    497,DL
        14 001046   001154 601000 14                 TNZ     s:16849
        14 001047   001061 710000 14                 TRA     s:16824
        14 001050   000433 116007                    CMPQ    283,DL
        14 001051   001056 604000 14                 TMI     s:16820+13
        14 001052   001131 600000 14                 TZE     s:16843
        14 001053   000543 116007                    CMPQ    355,DL
        14 001054   001154 601000 14                 TNZ     s:16849
        14 001055   001077 710000 14                 TRA     s:16832
        14 001056   000351 116007                    CMPQ    233,DL
        14 001057   001154 601000 14                 TNZ     s:16849
        14 001060   001106 710000 14                 TRA     s:16836

     2717    16821
     2718    16822    3         SELECT(%RSV_WRD_ZEROES);

     2719    16823
     2720    16824    3           CALL ADD_STR('"0"',3);

  16824 14 001061   000021 236000 15                 LDQ     17
        14 001062   200020 756100                    STQ     @STR+1,,AUTO
        14 001063   000022 236000 15                 LDQ     18
        14 001064   200017 756100                    STQ     CHARACTER+1,,AUTO
        14 001065   000017 701000 14                 TSX1    ADD_STR
        14 001066   000000 011000                    NOP     0
        14 001067   001166 710000 14                 TRA     s:16853

     2721    16825
     2722    16826    3         SELECT(%RSV_WRD_SPACES);

     2723    16827
     2724    16828    3           CALL ADD_STR('" "',3);

  16828 14 001070   000021 236000 15                 LDQ     17
        14 001071   200020 756100                    STQ     @STR+1,,AUTO
        14 001072   000023 236000 15                 LDQ     19
        14 001073   200017 756100                    STQ     CHARACTER+1,,AUTO
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:454  
        14 001074   000017 701000 14                 TSX1    ADD_STR
        14 001075   000000 011000                    NOP     0
        14 001076   001166 710000 14                 TRA     s:16853

     2725    16829
     2726    16830    3         SELECT(%RSV_WRD_QUOTES);

     2727    16831
     2728    16832    3           CALL ADD_STR('"""', 3);

  16832 14 001077   000021 236000 15                 LDQ     17
        14 001100   200020 756100                    STQ     @STR+1,,AUTO
        14 001101   000024 236000 15                 LDQ     20
        14 001102   200017 756100                    STQ     CHARACTER+1,,AUTO
        14 001103   000017 701000 14                 TSX1    ADD_STR
        14 001104   000000 011000                    NOP     0
        14 001105   001166 710000 14                 TRA     s:16853

     2729    16833
     2730    16834    3         SELECT(%RSV_WRD_HIGH_VALUES);

     2731    16835
     2732    16836    3           CALL ADD_CHAR('"');

  16836 14 001106   000026 236000 15                 LDQ     22
        14 001107   200015 756100                    STQ     ORIG_DNT$+3,,AUTO
        14 001110   000003 701000 14                 TSX1    ADD_CHAR
        14 001111   000000 011000                    NOP     0

     2733    16837    3           CALL ADD_STR (O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ ->

  16837 14 001112   000057 470400 xsym               LDP0    O1COM+47
        14 001113   000001 471500                    LDP1    1,,PR0
        14 001114   000030 236000 15                 LDQ     24
        14 001115   200020 756100                    STQ     @STR+1,,AUTO
        14 001116   200022 451500                    STP1    @LEN+2,,AUTO
        14 001117   200022 236100                    LDQ     @LEN+2,,AUTO
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:455  
        14 001120   000031 036000 15                 ADLQ    25
        14 001121   200017 756100                    STQ     CHARACTER+1,,AUTO
        14 001122   000017 701000 14                 TSX1    ADD_STR
        14 001123   000000 011000                    NOP     0

     2734    16838    3                         PROC_SUPP.HIGH_VALUE, 1);
     2735    16839    3           CALL ADD_CHAR('"');

  16839 14 001124   000026 236000 15                 LDQ     22
        14 001125   200015 756100                    STQ     ORIG_DNT$+3,,AUTO
        14 001126   000003 701000 14                 TSX1    ADD_CHAR
        14 001127   000000 011000                    NOP     0
        14 001130   001166 710000 14                 TRA     s:16853

     2736    16840
     2737    16841    3         SELECT(%RSV_WRD_LOW_VALUES);

     2738    16842
     2739    16843    3           CALL ADD_CHAR('"');

  16843 14 001131   000026 236000 15                 LDQ     22
        14 001132   200015 756100                    STQ     ORIG_DNT$+3,,AUTO
        14 001133   000003 701000 14                 TSX1    ADD_CHAR
        14 001134   000000 011000                    NOP     0

     2740    16844    3           CALL ADD_STR (O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ ->

  16844 14 001135   000057 470400 xsym               LDP0    O1COM+47
        14 001136   000001 471500                    LDP1    1,,PR0
        14 001137   000030 236000 15                 LDQ     24
        14 001140   200020 756100                    STQ     @STR+1,,AUTO
        14 001141   200022 451500                    STP1    @LEN+2,,AUTO
        14 001142   200022 236100                    LDQ     @LEN+2,,AUTO
        14 001143   000032 036000 15                 ADLQ    26
        14 001144   200017 756100                    STQ     CHARACTER+1,,AUTO
        14 001145   000017 701000 14                 TSX1    ADD_STR
        14 001146   000000 011000                    NOP     0
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:456  

     2741    16845    3                         PROC_SUPP.LOW_VALUE, 1);
     2742    16846    3           CALL ADD_CHAR('"');

  16846 14 001147   000026 236000 15                 LDQ     22
        14 001150   200015 756100                    STQ     ORIG_DNT$+3,,AUTO
        14 001151   000003 701000 14                 TSX1    ADD_CHAR
        14 001152   000000 011000                    NOP     0
        14 001153   001166 710000 14                 TRA     s:16853

     2743    16847    3         SELECT(ELSE);

     2744    16848
     2745    16849    3           CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);

  16849 14 001154   000035 630400 15                 EPPR0   29
        14 001155   000033 631400 15                 EPPR1   27
        14 001156   000000 701000 xent               TSX1    Z8AE$ERROR
        14 001157   000000 011000                    NOP     0

     2746    16850    3           CALL ADD_STR('" "', 3);

  16850 14 001160   000021 236000 15                 LDQ     17
        14 001161   200020 756100                    STQ     @STR+1,,AUTO
        14 001162   000023 236000 15                 LDQ     19
        14 001163   200017 756100                    STQ     CHARACTER+1,,AUTO
        14 001164   000017 701000 14                 TSX1    ADD_STR
        14 001165   000000 011000                    NOP     0

     2747    16851    3       END;

     2748    16852
     2749    16853    2       CALL Z8AH$SEARCH_;

  16853 14 001166   000012 631400 15                 EPPR1   10
        14 001167   000000 701000 xent               TSX1    Z8AH$SEARCH_
        14 001170   000000 011000                    NOP     0
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:457  

     2750    16854    2       NEW_DNT$ = DNT$;

  16854 14 001171   000000 236000 1                  LDQ     DNT$
        14 001172   200004 470500                    LDP0    @NEW_DNT$,,AUTO
        14 001173   000000 756100                    STQ     0,,PR0

     2751    16855    2   END;  /* do case on LX_TERMINAL.SYMBOL */

     2752    16856
     2753    16857    1   REGULAR_EXIT:
     2754    16858
     2755    16859    1     RETURN;

  16859 14 001174   000000 702200 xent  REGULAR_EXIT TSX2  ! X66_ARET

     2756    16860
     2757    16861    1   BAD_ORDINAL:
     2758    16862
     2759    16863          %CONDITIONAL_ERROR (@LX_ITEM$ = STRING$,
     2760    16864                              @ERROR# = %E$BAD_ORDINAL_CHARACTER,
     2761    16865                              @LINE = STRING$ -> LX_TERMINAL.LINE,
     2762    16866                              @COLUMN = STRING$ -> LX_TERMINAL.COLUMN);

  16867 14 001175                       BAD_ORDINAL  null
  16876 14 001175   200003 471500                    LDP1    @STRING$,,AUTO
        14 001176   100000 473500                    LDP3    0,,PR1
        14 001177   300000 236100                    LDQ     0,,PR3
        14 001200   400000 316007                    CANQ    -131072,DL
        14 001201   001220 601000 14                 TNZ     s:16897

  16878 14 001202   300006 634500                    EPPR4   6,,PR3
        14 001203   200024 454500                    STP4    @LEN+4,,AUTO
        14 001204   300005 635500                    EPPR5   5,,PR3
        14 001205   200023 455500                    STP5    @LEN+3,,AUTO
        14 001206   000037 236000 15                 LDQ     31
        14 001207   200022 756100                    STQ     @LEN+2,,AUTO
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:458  
        14 001210   200022 630500                    EPPR0   @LEN+2,,AUTO
        14 001211   000000 631400 15                 EPPR1   0
        14 001212   000000 701000 xent               TSX1    Z8AE$ERROR
        14 001213   000000 011000                    NOP     0

  16887 14 001214   200003 470500                    LDP0    @STRING$,,AUTO
        14 001215   000000 471500                    LDP1    0,,PR0
        14 001216   400000 236007                    LDQ     -131072,DL
        14 001217   100000 256100                    ORSQ    0,,PR1

     2763    16896
     2764    16897    1     GOTO ERROR_EXIT;

  16897 14 001220   001244 710000 14                 TRA     ERROR_EXIT

     2765    16898
     2766    16899    1   STR_ERROR:
     2767    16900
     2768    16901          %CONDITIONAL_ERROR (@LX_ITEM$ = STRING$,
     2769    16902                              @ERROR# = %E$EMBEDDED_QUOTES,
     2770    16903                              @LINE = STRING$ -> LX_TERMINAL.LINE,
     2771    16904                              @COLUMN = STRING$ -> LX_TERMINAL.COLUMN);

  16905 14 001221                       STR_ERROR    null
  16914 14 001221   200003 470500                    LDP0    @STRING$,,AUTO
        14 001222   000000 471500                    LDP1    0,,PR0
        14 001223   100000 236100                    LDQ     0,,PR1
        14 001224   400000 316007                    CANQ    -131072,DL
        14 001225   001244 601000 14                 TNZ     ERROR_EXIT

  16916 14 001226   100006 633500                    EPPR3   6,,PR1
        14 001227   200024 453500                    STP3    @LEN+4,,AUTO
        14 001230   100005 634500                    EPPR4   5,,PR1
        14 001231   200023 454500                    STP4    @LEN+3,,AUTO
        14 001232   000041 236000 15                 LDQ     33
        14 001233   200022 756100                    STQ     @LEN+2,,AUTO
        14 001234   200022 630500                    EPPR0   @LEN+2,,AUTO
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:459  
        14 001235   000000 631400 15                 EPPR1   0
        14 001236   000000 701000 xent               TSX1    Z8AE$ERROR
        14 001237   000000 011000                    NOP     0

  16925 14 001240   200003 470500                    LDP0    @STRING$,,AUTO
        14 001241   000000 471500                    LDP1    0,,PR0
        14 001242   400000 236007                    LDQ     -131072,DL
        14 001243   100000 256100                    ORSQ    0,,PR1

     2772    16934
     2773    16935    1   ERROR_EXIT:
     2774    16936
     2775    16937    1     NEW_DNT$ = ORIG_DNT$;

  16937 14 001244   200012 236100       ERROR_EXIT   LDQ     ORIG_DNT$,,AUTO
        14 001245   200004 470500                    LDP0    @NEW_DNT$,,AUTO
        14 001246   000000 756100                    STQ     0,,PR0

     2776    16938
     2777    16939    1     RETURN;

  16939 14 001247   000000 702200 xent               TSX2  ! X66_ARET
     2778    16940
     2779    16941    1   END Z8EC$INTERNAL_STRING_REP;

PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:460  
--  Include file information  --

   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_TABLES.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EC$INTERNAL_STRING_REP.
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:461  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 002 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 DNT_

  ****  Section 003 LblCom DNT_BUCKET_NUMBER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 DNT_BUCKET_NUMBER

  ****  Section 004 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 DNT_OF_1$

PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:462  
  ****  Section 005 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 006 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 007 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 008 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 LTS_

  ****  Section 009 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 010 LblCom CURRENT_LEX_SYMBOL$

PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:463  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 011 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 012 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    15-0-0/w PTR         r     1 @CH                       15-0-0/w PTR         r     1 @DNT$$
    20-0-0/w PTR         r     1 @LEN                       4-0-0/w PTR         r     1 @NEW_DNT$
    17-0-0/w PTR         r     1 @STR                       3-0-0/w PTR         r     1 @STRING$
    *0-0-0/c CHAR        r     1 CH                        16-0-0/c CHAR        r     1 CHARACTER
    16-0-0/c UBIN(9)     r     1 CHAR_UBIN                  7-0-0/c CHAR        r     1 DELIM
    *0-0-0/w PTR         r     1 DNT$$                     11-0-0/w SBIN        r     1 ITEM_CLASS
     6-0-0/w SBIN        r     1 LAST_LOC                  *0-0-0/w SBIN        r     1 LEN
     5-0-0/w SBIN        r     1 LOC                       *0-0-0/w PTR         r     1 NEW_DNT$
    10-0-0/w SBIN        r     1 ORDVAL                    12-0-0/w PTR         r     1 ORIG_DNT$
    *0-0-0/c ACHR        r     1 STR                       *0-0-0/w PTR         r     1 STRING$

  ****  SYMREF variables  ****

PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:464  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(4608)        1 ANSI_USERWORD_SCAN_TABLE
     0-0-0/w STRC(4608)  r     1 ASCII_SEARCH_TABLE         0-0-0/w STRC(4608)        1 BLANK_SCAN_TABLE
     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/c CHAR              1 CURRENCY_SIGN_CHARS(0:511)
     0-0-0/w STRC(4608)        1 DBL_QUOTE_PSEUDO_SEARCH_TABLE
     0-0-0/w STRC(4608)  r     1 DIGIT_SCAN_TABLE
     0-0-0/w STRC(4608)        1 DOUBLE_QUOTE_SEARCH_TABLE
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w STRC(4608)        1 LETTER_SEARCH_TABLE
     0-0-0/c CHAR              1 LOWER_TO_UPPER_CASE(0:511)
     0-0-0/w UBIN              1 LTS_STEP(0:37)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR
     0-0-0/w STRC(4608)        1 SEPARATORS_TABLE
     0-0-0/w STRC(4608)        1 SINGLE_QUOTE_SEARCH_TABLE
     0-0-0/w STRC(4608)        1 SNGL_QUOTE_PSEUDO_SEARCH_TABLE
     0-0-0/w STRC(4608)        1 USERWORD_SCAN_TABLE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w STRC(396)         1 ALPHABET
     0-0-0/w STRC(144)         1 ALTER_LTS                  0-0-0/w STRC(3672)        1 ALT_KEY
     0-0-0/w STRC(36864)       1 ARGLIST                    0-0-0/w STRC(396)         1 ARRAY
     0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS           0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(288)         1 BINARY_OP
     0-0-0/w STRC(396)         1 BLOCK                      0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(396)         1 CD
     0-0-0/w STRC(288)         1 CD_LTS                     0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(396)         1 CLASS                      0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)         1 CONST
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:465  
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)         1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(108)         1 DEPENDING_SIZE
     0-0-0/w STRC(5472)        1 DIMS                       0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w STRC(396)         1 DML_ITEM                   0-0-0/w STRC(216)         1 DML_REC
     0-0-0/w ASTR(180)   r     1 DNT                        0-0-0/w STRC(73836)       1 EVALUATE
     0-0-0/w STRC(396)         1 FD                         0-0-0/w STRC(1692)        1 FILE_LTS
     0-0-0/w STRC(288)         1 ILS_LIST                   0-0-0/w STRC(108)         1 INDEXES
     0-0-0/w STRC(360)         1 INIT_LTS                   0-0-0/w STRC(288)         1 INSPECT_1_STMT
     0-0-0/w STRC(288)         1 INSPECT_2_STMT             0-0-0/w STRC(288)         1 INSPECT_4_STMT
     0-0-0/w STRC(396)         1 INTDEF                     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN
     0-0-0/w STRC(144)         1 KEY                        0-0-0/w STRC(396)         1 LABEL
     0-0-0/w STRC(288)         1 LA_ITEM                    0-0-0/w STRC(36864)       1 LCNST
     0-0-0/w STRC(72)          1 LONG                       0-0-0/w STRC              1 LTS
     0-0-0/w STRC(360)         1 LTSS                       0-0-0/w STRC(36936)       1 LTS_PTR_ARRAY
     0-0-0/w STRC(504)         1 LX_CD_INPUT                0-0-0/w STRC(324)         1 LX_CD_I_O
     0-0-0/w STRC(396)         1 LX_CD_OUTPUT               0-0-0/w STRC(288)         1 LX_ETT_ITEM
     0-0-0/w STRC(288)   r     1 LX_ITEM                    0-0-0/w STRC(288)         1 LX_LARGE
     0-0-0/w STRC(288)         1 LX_LIST                    0-0-0/w STRC(1224)        1 LX_REC_DECL
     0-0-0/w STRC(864)         1 LX_REPORT_REC              0-0-0/w STRC(288)   r     1 LX_TERMINAL
     0-0-0/w STRC(396)         1 MNEMONIC                   0-0-0/w STRC(288)         1 MULTIPLY_STMT
     0-0-0/w STRC(144)         1 NEL                        0-0-0/w STRC(216)         1 OPEN_LTS
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(396)         1 PARA
     0-0-0/w STRC(144)         1 PRIME                      0-0-0/w STRC(396)   r     1 PROC_
     0-0-0/w STRC(396)         1 PROC_DEF                   0-0-0/w STRC(900)   r     1 PROC_SUPP
     0-0-0/w STRC(396)         1 RD                         0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(216)         1 REF                        0-0-0/w STRC(108)         1 RENAMES
     0-0-0/w STRC(720)         1 REPORT_01_LTS              0-0-0/w STRC(432)         1 REPORT_ELEM_LTS
     0-0-0/w STRC(252)         1 REPORT_GRP_LTS             0-0-0/w STRC(1332)        1 REPORT_LTS
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(144)         1 RVA_LTS
     0-0-0/w STRC(396)         1 SCALAR                     0-0-0/w STRC(396)         1 SD
     0-0-0/w STRC(396)         1 SECTION                    0-0-0/w STRC(396)         1 SEGMENT
     0-0-0/w STRC(360)         1 SEGMENT_LTS                0-0-0/w STRC(396)         1 ST
PL6.E3A0      #003=Z8EC$INTERNAL_STRING_REP File=Z8EC.:Z8A6TSI                   SAT 08/09/97 11:52 Page:466  
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(252)         1 SUM_LTS
     0-0-0/w STRC(396)         1 SWITCH                     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR
     0-0-0/w STRC(396)         1 SYMDEF_                    0-0-0/w STRC(396)         1 SYMREF_
     0-0-0/w STRC(396)         1 TEMP                       0-0-0/w STRC(288)         1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/d STRC(612)         1 USE
     0-0-0/w STRC(252)         1 USE_SUPP                   0-0-0/w STRC(396)         1 VARIABLE
     0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EC$INTERNAL_STRING_REP requires 680 words for executable code.
   Procedure Z8EC$INTERNAL_STRING_REP requires 30 words of local(AUTO) storage.

    No errors detected in file Z8EC.:Z8A6TSI    .
