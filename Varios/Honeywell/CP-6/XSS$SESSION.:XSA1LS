VERSION A01

PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:1    
        1        1        /*M*    XSS$SESSION     Entry to ISO Session layer from higher layer(s) */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DDA */
        8        8        /*F*    NAME:   XSS$SESSION
        9        9                PURPOSE:
       10       10                    This routine is the entry into the Session layer from any higher
       11       11                    layer, such as Presentation or CASE.
       12       12                DESCRIPTION:
       13       13                    This is the sole entry point to the Session layer from any higher
       14       14                    layer.  A single parameter is passed, which is the Session FPT.
       15       15                    This FPT is examined to determine the Session function code that
       16       16                    is being requested, as well as the Session connection number to
       17       17                    apply the request to.  Various things may possibly be updated and
       18       18                    then the Session state machine is invoked.  The state machine
       19       19                    may cause other Session actions to occur and may further update
       20       20                    the state of the connection.
       21       21        */
       22       22        XSS$SESSION: PROC( SFPT) ALTRET;
       23       23        %INCLUDE B_SEGIDS_C;
       24      562        %INCLUDE B$JIT_C;
       25      876            %B$JIT0;
       26      965            %U$JIT1X;
       27      968            %M$JIT2;
       28      978            %F$JIT3X;
       29      981            %S$JIT4X;
       30      984            %J$JIT5X;
       31      987            %A$JIT6X;
       32      990        %INCLUDE UM_CP6;
       33     1842        %INCLUDE K_ADDRESS_M;
       34     2345            %K$ADDRESS;
       35     2498            %K$SSAP;
       36     2539        %INCLUDE XSS_SESSION_E;
       37     3104        %INCLUDE XSS_SESSION_M;
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:2    
       38     5747            %XSS$PRIMITIVES( STCLASS="BASED( SFPT$)");
       39     9126            %XSS$GENERIC( FPTN=SFPT, STCLASS="");
       40     9272            %XSS$DATA( FPTN=SDATREQ, STCLASS=AUTO);
       41     9416        %INCLUDE XSS_INTERNAL_E;
       42     9714        %INCLUDE XSS_INTERNAL_M;
       43    10303            %XSS$VBLK( NAME=XSS_VBLK, STCLASS="CONSTANT SYMDEF");
       44    10408            %XSS$VBLK( NAME=VBLK, STCLASS=AUTO);
       45    10513            %XSS$SCTX( NAME=SCTX, STCLASS="BASED( CTX$)");
       46    10947        %INCLUDE XSC_COMMON_M;
       47    11600            %XSC$ADDRESS;
       48    11883            %XSC$CCB;
       49    12180        %MACRO ERRORDEF( NAME=XSS_ERROR, STCLASS="CONSTANT SYMDEF", LVL=1, LAST=";",
       50    12181                         ERR#=0, SEV=0);
       51    12182            %VLP_ERRCODE( FPTN=NAME, STCLASS=STCLASS, FCG='XS', MID='S',
       52    12183                          MON='0'B, ERR#=ERR#, SEV=SEV);
       53    12184        %MEND;
       54    12185        %INCLUDE XSC_PERR_C;
       55    12262            %ERRORDEF( NAME=XSS_E$NODYNMEM, STCLASS=SYMREF);
       56    12310            %ERRORDEF( NAME=XSS_E$RDONLYFPT, ERR#=%E$RDONLYFPT);
       57    12358            /*E*  ERROR:  XSS-E$RDONLYFPT-0
       58    12359                MESSAGE:  FPT is read-only; must be writeable.
       59    12360            */
       60    12361            %ERRORDEF( NAME=XSS_E$BADCID, ERR#=%E$BADCID);
       61    12409            /*E*  ERROR:  XSS-E$BADCID-0
       62    12410                MESSAGE:  Illegal connection identifier.
       63    12411            */
       64    12412            %ERRORDEF( NAME=XSS_E$BADFNC, ERR#=%E$BADFNC);
       65    12460            /*E*  ERROR:  XSS-E$BADFNC-0
       66    12461                MESSAGE:  Illegal function code.
       67    12462            */
       68    12463            %ERRORDEF( NAME=XSS_E$STATE, ERR#=%E$STATE);
       69    12511            /*E*  ERROR:  XSS-E$STATE-0
       70    12512                MESSAGE:  Connection state prevents this action.
       71    12513            */
       72    12514            %ERRORDEF( NAME=XSS_E$ACTID, ERR#=%E$ACTID);
       73    12562            /*E*  ERROR:  XSS-E$ACTID-0
       74    12563                MESSAGE:  ACTID contains an illegal value.
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:3    
       75    12564            */
       76    12565            %ERRORDEF( NAME=XSS_E$ARI, ERR#=%E$ARI);
       77    12613            /*E*  ERROR:  XSS-E$ARI-0
       78    12614                MESSAGE:  ARI contains an illegal value.
       79    12615            */
       80    12616            %ERRORDEF( NAME=XSS_E$CALLED, ERR#=%E$CALLED);
       81    12664            /*E*  ERROR:  XSS-E$CALLED-0
       82    12665                MESSAGE:  CALLED contains an illegal value.
       83    12666            */
       84    12667            %ERRORDEF( NAME=XSS_E$CALLING, ERR#=%E$CALLING);
       85    12715            /*E*  ERROR:  XSS-E$CALLING-0
       86    12716                MESSAGE:  CALLING contains an illegal value.
       87    12717            */
       88    12718            %ERRORDEF( NAME=XSS_E$COMMON, ERR#=%E$COMMON);
       89    12766            /*E*  ERROR:  XSS-E$COMMON-0
       90    12767                MESSAGE:  COMMON contains an illegal value.
       91    12768            */
       92    12769            %ERRORDEF( NAME=XSS_E$DATA, ERR#=%E$DATA);
       93    12817            /*E*  ERROR:  XSS-E$DATA-0
       94    12818                MESSAGE:  DATA contains an illegal value.
       95    12819            */
       96    12820            %ERRORDEF( NAME=XSS_E$FLOW, ERR#=%E$FLOW);
       97    12868            /*E*  ERROR:  XSS-E$FLOW-0
       98    12869                MESSAGE:  Connection flow control prevents this action.
       99    12870            */
      100    12871            %ERRORDEF( NAME=XSS_E$ITOKENS, ERR#=%E$ITOKENS);
      101    12919            /*E*  ERROR:  XSS-E$ITOKENS-0
      102    12920                MESSAGE:  ITOKENS contains an illegal value.
      103    12921            */
      104    12922            %ERRORDEF( NAME=XSS_E$OACTID, ERR#=%E$OACTID);
      105    12970            /*E*  ERROR:  XSS-E$OACTID-0
      106    12971                MESSAGE:  OACTID contains an illegal value.
      107    12972            */
      108    12973            %ERRORDEF( NAME=XSS_E$OSCID, ERR#=%E$OSCID);
      109    13021            /*E*  ERROR:  XSS-E$OSCID-0
      110    13022                MESSAGE:  OSCID contains an illegal value.
      111    13023            */
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:4    
      112    13024            %ERRORDEF( NAME=XSS_E$QOS, ERR#=%E$QOS);
      113    13072            /*E*  ERROR:  XSS-E$QOS-0
      114    13073                MESSAGE:  QOS contains an illegal value.
      115    13074            */
      116    13075            %ERRORDEF( NAME=XSS_E$REASON, ERR#=%E$REASON);
      117    13123            /*E*  ERROR:  XSS-E$REASON-0
      118    13124                MESSAGE:  REASON contains an illegal value.
      119    13125            */
      120    13126            %ERRORDEF( NAME=XSS_E$RESPONDING, ERR#=%E$RESPONDING);
      121    13174            /*E*  ERROR:  XSS-E$RESPONDING-0
      122    13175                MESSAGE:  RESPONDING contains an illegal value.
      123    13176            */
      124    13177            %ERRORDEF( NAME=XSS_E$RESULT, ERR#=%E$RESULT);
      125    13225            /*E*  ERROR:  XSS-E$RESULT-0
      126    13226                MESSAGE:  RESULT contains an illegal value.
      127    13227            */
      128    13228            %ERRORDEF( NAME=XSS_E$SERNUM, ERR#=%E$SERNUM);
      129    13276            /*E*  ERROR:  XSS-E$SERNUM-0
      130    13277                MESSAGE:  SERNUM contains an illegal value.
      131    13278            */
      132    13279            %ERRORDEF( NAME=XSS_E$SFU, ERR#=%E$SFU);
      133    13327            /*E*  ERROR:  XSS-E$SFU-0
      134    13328                MESSAGE:  SFU contains an illegal value.
      135    13329            */
      136    13330            %ERRORDEF( NAME=XSS_E$TOKENS, ERR#=%E$TOKENS);
      137    13378            /*E*  ERROR:  XSS-E$TOKENS-0
      138    13379                MESSAGE:  TOKENS contains an illegal value.
      139    13380            */
      140    13381            %ERRORDEF( NAME=XSS_E$TYPE, ERR#=%E$TYPE);
      141    13429            /*E*  ERROR:  XSS-E$TYPE-0
      142    13430                MESSAGE:  TYPE contains an illegal value.
      143    13431            */
      144    13432
      145    13433    1       DCL XSS$BUFPTR ENTRY(2) ALTRET;
      146    13434    1       DCL XSS$COMMPEND ENTRY(1) ALTRET;
      147    13435    1       DCL XSS$COMMWAIT ENTRY(1) ALTRET;
      148    13436    1       DCL XSS$CTXPTR ENTRY(2) ALTRET;
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:5    
      149    13437    1       DCL XSS$DUMPFPT ENTRY(1) OPTIONAL;
      150    13438    1       DCL XSS$GETMEM ENTRY(3) ALTRET;
      151    13439    1       DCL XSS$MACHINE ENTRY(1) ALTRET;
      152    13440    1       DCL XSS$SCREECH ENTRY(1);
      153    13441    1       DCL XSS$EVLOG ENTRY(2);
      154    13442
      155    13443    1       DCL B$JIT$ PTR SYMREF;
      156    13444    1       DCL XSS_CCB$$ PTR SYMREF;
      157    13445    1       DCL XSS_TRACE SBIN SYMREF;
      158    13446
      159    13447    1       DCL BLKX UBIN HALF HALIGNED;
      160    13448    1       DCL BYTES CHAR( LEN) BASED UNAL;
      161    13449    1       DCL CCB$(0:0) PTR BASED( XSS_CCB$$) ALIGNED;
      162    13450    1       DCL CTX$ PTR;
      163    13451    1       DCL LEN SBIN;
      164    13452    1       DCL LENBYTES CHAR( LEN) BASED CALIGNED;
      165    13453    1       DCL 1 NO_COMMON CONSTANT,  /* null TEXTC item */
      166    13454    1            2 * UBIN BYTE INIT( 0) CALIGNED,
      167    13455    1            2 *(0:2) UBIN BYTE INIT( 0*3) CALIGNED;
      168    13456    1       DCL PTR$ PTR;
      169    13457    1       DCL SCID SBIN;
      170    13458    1       DCL TEMP REDEF SCID SBIN;
      171    13459    1       DCL SFPT$ PTR;
      172    13460    1       DCL 1 PX REDEF SFPT$,
      173    13461    1            2 OFFSET UBIN(18) UNAL,
      174    13462    1            2 * BIT(6) UNAL,
      175    13463    1            2 SEGID BIT(12) UNAL;
      176    13464    1       DCL MAXSZ SBIN;
      177    13465
      178    13466    1       SFPT$ = ADDR( SFPT);
      179    13467    2       IF PX.SEGID = %ISSID THEN DO;
      180    13468    2           TEMP = 64 + PX.OFFSET / 1024;  /* page number of FPT's page */
      181    13469    3           IF TEMP >= B$JIT.PLL AND TEMP <= B$JIT.PUL THEN DO;
      182    13470                    /* the user's FPT was allocated in CONSTANT storage */
      183    13471    3               IF XSS$GENERIC.ERROR = XSS_E$RDONLYFPT THEN
      184    13472    3                   ALTRETURN;
      185    13473    3               CALL XSS$SCREECH( XSS_E$RDONLYFPT);
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:6    
      186    13474    3               END;
      187    13475    2           END;
      188    13476            /* Initialize returned error code */
      189    13477    1       XSS$GENERIC.ERROR = '0'B;
      190    13478            /* Initialize AUTO copy of VBLK structure */
      191    13479    1       VBLK = XSS_VBLK;
      192    13480    1       VBLK.FPT$ = SFPT$;
      193    13481            /* Determine which connection is being referred to */
      194    13482    1       SCID = XSS$GENERIC.SCID;
      195    13483    1       CALL XSS$EVLOG( 'KS', XSS$GENERIC.FNC*512 + SCID);
      196    13484    1   LOOP:
      197    13485    1       CALL XSS$CTXPTR( SCID, CTX$)
      198    13486    2       WHENRETURN DO;
      199    13487    2           IF SCTX.LATCH.PRESENT THEN
      200    13488    2               CALL XSS$COMMPEND( SCID) ALTRET( LOOP);
      201    13489    2           END;
      202    13490    2       WHENALTRETURN DO;
      203    13491    2           XSS$GENERIC.ERROR = XSS_E$BADCID;
      204    13492    2           ALTRETURN;
      205    13493    2           END;
      206    13494    2       IF SCTX.FLOWSTOPPED THEN DO;
      207    13495    3           IF SCTX.BLOCKING THEN DO;
      208    13496    3   BLOCKLOOP:
      209    13497    3               CALL XSS$COMMWAIT( 10) ALTRET( LOOP);
      210    13498    3               GOTO BLOCKLOOP;
      211    13499    3               END;
      212    13500    3           ELSE DO;
      213    13501    3               XSS$GENERIC.ERROR = XSS_E$FLOW;
      214    13502    3               ALTRETURN;
      215    13503    3               END;
      216    13504    2           END;
      217    13505            /* Update AUTO VBLK context ptr */
      218    13506    1       VBLK.CTX$ = CTX$;
      219    13507            /* Split depending on the Session function code requested */
      220    13508    2       DO CASE( XSS$GENERIC.FNC);
      221    13509    2           CASE( %XSS_FNC_SACDREQ#);
      222    13510    2               CALL CKRC( XSS$ACTIVITY_DISCARD.REASON) ALTRET( BAD_RC);
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:7    
      223    13511    2               VBLK.EVENT = %XSS_SEV_SACDREQ;
      224    13512    2           CASE( %XSS_FNC_SACDRSP#);
      225    13513    2               VBLK.EVENT = %XSS_SEV_SACDRSP;
      226    13514    2           CASE( %XSS_FNC_SACEREQ#);
      227    13515    2               CALL CKSN( XSS$ACTIVITY_END.SERNUM) ALTRET( BAD_SN);
      228    13516    2               CALL CKDATA( XSS$ACTIVITY_END.DATA, 512) ALTRET( BAD_DATA);
      229    13517    2               VBLK.EVENT = %XSS_SEV_SACEREQ;
      230    13518    2           CASE( %XSS_FNC_SACERSP#);
      231    13519    2               CALL CKDATA( XSS$ACTIVITY_END.DATA, 512) ALTRET( BAD_DATA);
      232    13520    2               VBLK.EVENT = %XSS_SEV_SACERSP;
      233    13521    2           CASE( %XSS_FNC_SACIREQ#);
      234    13522    2               CALL CKRC( XSS$ACTIVITY_INTERRUPT.REASON) ALTRET( BAD_RC);
      235    13523    2               VBLK.EVENT = %XSS_SEV_SACIREQ;
      236    13524    2           CASE( %XSS_FNC_SACIRSP#);
      237    13525    2               VBLK.EVENT = %XSS_SEV_SACIRSP;
      238    13526    2           CASE( %XSS_FNC_SACRREQ#);
      239    13527    2               CALL CKAI( XSS$ACTIVITY_RESUME.ACTID) ALTRET( BAD_AI);
      240    13528    2               CALL CKAI( XSS$ACTIVITY_RESUME.OACTID) ALTRET( BAD_OAI);
      241    13529    2               CALL CKSN( XSS$ACTIVITY_RESUME.SERNUM) ALTRET( BAD_SN);
      242    13530                    /* XSS$ACTIVITY_RESUME.OSCID need not be validated */
      243    13531    2               CALL CKCOMMON( XSS$ACTIVITY_RESUME.COMMON$) ALTRET( BAD_COMMON);
      244    13532    2               CALL CKADDR( XSS$ACTIVITY_RESUME.CALLING$, XSS_E$CALLING)
      245    13533    2                       ALTRET( BAD_ADDR);
      246    13534    2               IF XSS$ACTIVITY_RESUME.CALLING$ = ADDR( NIL) THEN
      247    13535    2                   CALL XSS$BUFPTR( SCTX.SRCX, XSS$ACTIVITY_RESUME.CALLING$);
      248    13536    3               ELSE DO;
      249    13537    3                   CALL XSS$BUFPTR( SCTX.SRCX, PTR$);
      250    13538    3                   PTR$->XSC$ADDRESS = XSS$ACTIVITY_RESUME.CALLING$->XSC$ADDRESS;
      251    13539    3                   END;
      252    13540    2               CALL CKADDR( XSS$ACTIVITY_RESUME.CALLED$, XSS_E$CALLED)
      253    13541    2                       ALTRET( BAD_ADDR);
      254    13542    2               IF XSS$ACTIVITY_RESUME.CALLED$ = ADDR( NIL) THEN
      255    13543    2                   CALL XSS$BUFPTR( SCTX.DSTX, XSS$ACTIVITY_RESUME.CALLED$);
      256    13544    3               ELSE DO;
      257    13545    3                   CALL XSS$BUFPTR( SCTX.DSTX, PTR$);
      258    13546    3                   PTR$->XSC$ADDRESS = XSS$ACTIVITY_RESUME.CALLED$->XSC$ADDRESS;
      259    13547    3                   END;
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:8    
      260    13548    2               CALL CKDATA( XSS$ACTIVITY_RESUME.DATA, 512) ALTRET( BAD_DATA);
      261    13549    2               VBLK.EVENT = %XSS_SEV_SACRREQ;
      262    13550    2           CASE( %XSS_FNC_SACSREQ#);
      263    13551    2               CALL CKAI( XSS$ACTIVITY_START.ACTID) ALTRET( BAD_AI);
      264    13552    2               CALL CKDATA( XSS$ACTIVITY_START.DATA, 512) ALTRET( BAD_DATA);
      265    13553    2               VBLK.EVENT = %XSS_SEV_SACSREQ;
      266    13554    2           CASE( %XSS_FNC_SCADREQ#);
      267    13555    2               CALL CKDATA( XSS$CAPABILITY_DATA.DATA, 512) ALTRET( BAD_DATA);
      268    13556    2               VBLK.EVENT = %XSS_SEV_SACDREQ;
      269    13557    2           CASE( %XSS_FNC_SCADRSP#);
      270    13558    2               CALL CKDATA( XSS$CAPABILITY_DATA.DATA, 512) ALTRET( BAD_DATA);
      271    13559    2               VBLK.EVENT = %XSS_SEV_SACDRSP;
      272    13560    2           CASE( %XSS_FNC_SCONREQ#);
      273    13561                    /* XSS$CONNECT.SCID need not be validated */
      274    13562    2               CALL CKCOMMON( XSS$CONNECT.COMMON$) ALTRET( BAD_COMMON);
      275    13563    2               CALL CKADDR( XSS$CONNECT.CALLING$, XSS_E$CALLING) ALTRET( BAD_ADDR);
      276    13564    2               IF XSS$CONNECT.CALLING$ = ADDR( NIL) THEN
      277    13565    2                   CALL XSS$BUFPTR( SCTX.SRCX, XSS$CONNECT.CALLING$);
      278    13566    3               ELSE DO;
      279    13567    3                   CALL XSS$BUFPTR( SCTX.SRCX, PTR$);
      280    13568    3                   PTR$->XSC$ADDRESS = XSS$CONNECT.CALLING$->XSC$ADDRESS;
      281    13569    3                   END;
      282    13570    2               CALL CKADDR( XSS$CONNECT.CALLED$, XSS_E$CALLED) ALTRET( BAD_ADDR);
      283    13571    2               IF XSS$CONNECT.CALLED$ = ADDR( NIL) THEN
      284    13572    2                   CALL XSS$BUFPTR( SCTX.DSTX, XSS$CONNECT.CALLED$);
      285    13573    3               ELSE DO;
      286    13574    3                   CALL XSS$BUFPTR( SCTX.DSTX, PTR$);
      287    13575    3                   PTR$->XSC$ADDRESS = XSS$CONNECT.CALLED$->XSC$ADDRESS;
      288    13576    3                   END;
      289    13577    2               XSS$CONNECT.RESULT = %XSS_RSLT_SUCCESS#;
      290    13578                    /* XSS$CONNECT.RESULT need not be validated */
      291    13579                    /* XSS$CONNECT.QOS need not be validated */
      292    13580    2               CALL CKSFU ALTRET( BAD_VIBES);
      293    13581    2               IF XSS$CONNECT.SERNUM ~= 0 THEN
      294    13582    2                   CALL CKSN( XSS$CONNECT.SERNUM) ALTRET( BAD_SN);
      295    13583    2               CALL CKITOKENS ALTRET( BAD_ITOKENS);
      296    13584    2               CALL CKDATA( XSS$CONNECT.DATA, 512) ALTRET( BAD_DATA);
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:9    
      297    13585    3               IF XSS$CONNECT.DATA.SIZE > 0 THEN DO;
      298    13586    3                   LEN = XSS$CONNECT.DATA.SIZE;
      299    13587    3                   CALL XSS$GETMEM( BLKX, PTR$, LEN)
      300    13588    4                   WHENALTRETURN DO;
      301    13589    4                       XSS$GENERIC.ERROR = XSS_E$NODYNMEM;
      302    13590    4                       GOTO BAD_VIBES;
      303    13591    4                       END;
      304    13592    3                   PTR$->LENBYTES = XSS$CONNECT.DATA.PTR$->LENBYTES;
      305    13593    3                   SCTX.HEADX = BLKX;
      306    13594    3                   END;
      307    13595    2               VBLK.EVENT = %XSS_SEV_SCONREQ;
      308    13596    2           CASE( %XSS_FNC_SCONRSP#);
      309    13597                    /* XSS$CONNECT.SCID need not be validated */
      310    13598    2               CALL CKCOMMON( XSS$CONNECT.COMMON$) ALTRET( BAD_COMMON);
      311    13599    2               CALL CKADDR( XSS$CONNECT.CALLING$, XSS_E$CALLING)
      312    13600    2                       ALTRET( BAD_ADDR);
      313    13601    2               IF XSS$CONNECT.CALLING$ = ADDR( NIL) THEN
      314    13602    2                   CALL XSS$BUFPTR( SCTX.SRCX, XSS$CONNECT.CALLING$);
      315    13603    3               ELSE DO;
      316    13604    3                   CALL XSS$BUFPTR( SCTX.SRCX, PTR$);
      317    13605    3                   PTR$->XSC$ADDRESS = XSS$CONNECT.CALLING$->XSC$ADDRESS;
      318    13606    3                   END;
      319    13607    2               CALL CKADDR( XSS$CONNECT.RESPONDING$, XSS_E$RESPONDING)
      320    13608    2                       ALTRET( BAD_ADDR);
      321    13609    2               IF XSS$CONNECT.RESPONDING$ = ADDR( NIL) THEN
      322    13610    2                   CALL XSS$BUFPTR( SCTX.DSTX, XSS$CONNECT.RESPONDING$);
      323    13611    3               ELSE DO;
      324    13612    3                   CALL XSS$BUFPTR( SCTX.DSTX, PTR$);
      325    13613    3                   PTR$->XSC$ADDRESS = XSS$CONNECT.RESPONDING$->XSC$ADDRESS;
      326    13614    3                   END;
      327    13615    3               IF XSS$CONNECT.RESULT ~= %XSS_RSLT_SUCCESS# THEN DO;
      328    13616    3                   CALL CKRC( XSS$CONNECT.REASON) ALTRET( BAD_RC);
      329    13617    3                   VBLK.RF_RSN = XSS$CONNECT.REASON;
      330    13618                        /* Event is connect response (negative) */
      331    13619    3                   CALL CKDATA( XSS$CONNECT.DATA, 512) ALTRET( BAD_DATA);
      332    13620    3                   VBLK.EVENT = %XSS_SEV_SCONRSN;
      333    13621    3                   END;
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:10   
      334    13622    3               ELSE DO;
      335    13623                        /* Event is connect response (positive) */
      336    13624    3                   CALL CKDATA( XSS$CONNECT.DATA, 512) ALTRET( BAD_DATA);
      337    13625    3                   VBLK.EVENT = %XSS_SEV_SCONRSP;
      338    13626    3                   END;
      339    13627                    /* XSS$CONNECT.QOS need not be validated */
      340    13628    2               CALL CKSFU ALTRET( BAD_VIBES);
      341    13629    2               IF XSS$CONNECT.SERNUM ~= 0 THEN
      342    13630    2                   CALL CKSN( XSS$CONNECT.SERNUM) ALTRET( BAD_SN);
      343    13631    2               CALL CKITOKENS ALTRET( BAD_ITOKENS);
      344    13632    2           CASE( %XSS_FNC_SCTGREQ#);
      345    13633    2               XSS$CONTROL_GIVE.TOKENS.TR = %TRUE;
      346    13634    2               XSS$CONTROL_GIVE.TOKENS.MA = %TRUE;
      347    13635    2               XSS$CONTROL_GIVE.TOKENS.MI = %TRUE;
      348    13636    2               XSS$CONTROL_GIVE.TOKENS.DK = %TRUE;
      349    13637    2               VBLK.EVENT = %XSS_SEV_SCTGREQ;
      350    13638    2           CASE( %XSS_FNC_SDATREQ#);
      351    13639    2               VBLK.EI.BOSSDU = %TRUE;
      352    13640    2               CALL CKDATA( XSS$DATA.DATA, 65533, 1) ALTRET( BAD_DATA);
      353    13641    2               IF XSS_TRACE > 0 THEN
      354    13642    2                   CALL XSS$DUMPFPT( XSS$GENERIC);
      355    13643    2               LEN = XSS$DATA.DATA.SIZE;
      356    13644    2               IF SCTX.FLAGS.VTCA THEN
      357    13645    2                   MAXSZ = SCTX.TSDUMS.RSP;
      358    13646    2               ELSE
      359    13647    2                   MAXSZ = SCTX.TSDUMS.INI;
      360    13648    3               IF MAXSZ > 0 AND LEN > MAXSZ THEN DO;
      361    13649    3                   PTR$ = XSS$DATA.DATA.PTR$;
      362    13650    3                   SDATREQ = XSS$DATA;  /* init private copy of user FPT */
      363    13651    3                   VBLK.FPT$ = ADDR( SDATREQ);
      364    13652    4                   DO WHILE( LEN > MAXSZ);
      365    13653                            /* the data has to be sent in chunks */
      366    13654    4                       SDATREQ.DATA.SIZE = MINIMUM( MAXSZ, LEN);
      367    13655    4                       SDATREQ.DATA.PTR$ = PTR$;
      368    13656    4                       LEN = LEN - MAXSZ;
      369    13657    4                       IF LEN <= 0 THEN
      370    13658    4                           VBLK.EI.EOSSDU = %TRUE;  /* last chunk of msg */
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:11   
      371    13659    4                       VBLK.EVENT = %XSS_SEV_SDATREQ;
      372    13660    4                       CALL XSS$MACHINE( VBLK) ALTRET( ABORT);
      373    13661    4                       VBLK.EI.BOSSDU = %FALSE;    /* no longer first chunk */
      374    13662    4                       PTR$ = PINCRC( PTR$, MAXSZ);
      375    13663    4                       IF VBLK.EI.EOSSDU THEN
      376    13664    4                           GOTO DONE;
      377    13665    4                       END;
      378    13666    3                   SDATREQ.DATA.SIZE = LEN;
      379    13667    3                   SDATREQ.DATA.PTR$ = PTR$;
      380    13668    3                   END;
      381    13669    2               VBLK.EVENT = %XSS_SEV_SDATREQ;
      382    13670    2               VBLK.EI.EOSSDU = %TRUE;  /* last chunk of msg */
      383    13671    2           CASE( %XSS_FNC_SEXPREQ#);
      384    13672    2               CALL CKDATA( XSS$EXPEDITED_DATA.DATA, 14, 1) ALTRET( BAD_DATA);
      385    13673    2               VBLK.EVENT = %XSS_SEV_SEXPREQ;
      386    13674    2           CASE( %XSS_FNC_SRELREQ#);
      387    13675    2               CALL CKDATA( XSS$RELEASE.DATA, 512) ALTRET( BAD_DATA);
      388    13676    2               VBLK.EVENT = %XSS_SEV_SRELREQ;
      389    13677    2           CASE( %XSS_FNC_SRELRSP#);
      390    13678                    /*N* validate XSS$RELEASE.RESULT */
      391    13679    2               CALL CKDATA( XSS$RELEASE.DATA, 512) ALTRET( BAD_DATA);
      392    13680    2               VBLK.EVENT = %XSS_SEV_SRELRSP;
      393    13681    2           CASE( %XSS_FNC_SRSXREQ#);
      394    13682    3               DO CASE( XSS$RESYNCHRONIZE.TYPE);
      395    13683    3                   CASE( %XSS_RT_ABANDON#);
      396    13684    3                       VBLK.EVENT = %XSS_SEV_SRSAREQ;
      397    13685    3                   CASE( %XSS_RT_RESTART#);
      398    13686    3                       VBLK.EVENT = %XSS_SEV_SRSRREQ;
      399    13687    3                   CASE( %XSS_RT_SET#);
      400    13688    3                       VBLK.EVENT = %XSS_SEV_SRSSREQ;
      401    13689    3                   CASE( ELSE);
      402    13690    3                       GOTO BAD_RT;
      403    13691    3                   END;
      404    13692    2               CALL CKSN( XSS$RESYNCHRONIZE.SERNUM) ALTRET( BAD_SN);
      405    13693                    /*N* validate XSS$RESYNCHRONIZE.TOKENS */
      406    13694    2               CALL CKDATA( XSS$RESYNCHRONIZE.DATA, 512) ALTRET( BAD_DATA);
      407    13695    2           CASE( %XSS_FNC_SRSXRSP#);
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:12   
      408    13696    2               CALL CKSN( XSS$RESYNCHRONIZE.SERNUM) ALTRET( BAD_SN);
      409    13697                    /*N* validate XSS$RESYNCHRONIZE.TOKENS */
      410    13698    2               CALL CKDATA( XSS$RESYNCHRONIZE.DATA, 512) ALTRET( BAD_DATA);
      411    13699    2               VBLK.EVENT = %XSS_SEV_SRSXRSP;
      412    13700    2           CASE( %XSS_FNC_SSMAREQ#);
      413    13701    2               CALL CKSN( XSS$SYNC_MAJOR.SERNUM) ALTRET( BAD_SN);
      414    13702    2               CALL CKDATA( XSS$SYNC_MAJOR.DATA, 512) ALTRET( BAD_DATA);
      415    13703    2               VBLK.EVENT = %XSS_SEV_SSMAREQ;
      416    13704    2           CASE( %XSS_FNC_SSMARSP#);
      417    13705    2               CALL CKDATA( XSS$SYNC_MAJOR.DATA, 512) ALTRET( BAD_DATA);
      418    13706    2               VBLK.EVENT = %XSS_SEV_SSMARSP;
      419    13707    2           CASE( %XSS_FNC_SSMIREQ#);
      420    13708                    /*N* validate XSS$SYNC_MINOR.TYPE */
      421    13709    2               CALL CKSN( XSS$SYNC_MINOR.SERNUM) ALTRET( BAD_SN);
      422    13710    2               CALL CKDATA( XSS$SYNC_MINOR.DATA, 512) ALTRET( BAD_DATA);
      423    13711    2               VBLK.EVENT = %XSS_SEV_SSMIREQ;
      424    13712    2           CASE( %XSS_FNC_SSMIRSP#);
      425    13713    2               CALL CKSN( XSS$SYNC_MINOR.SERNUM) ALTRET( BAD_SN);
      426    13714    2               CALL CKDATA( XSS$SYNC_MINOR.DATA, 512) ALTRET( BAD_DATA);
      427    13715    2               VBLK.EVENT = %XSS_SEV_SSMIRSP;
      428    13716    2           CASE( %XSS_FNC_STKGREQ#);
      429    13717                    /*N* validate XSS$TOKEN_GIVE.TOKENS */
      430    13718    2               VBLK.EVENT = %XSS_SEV_STKGREQ;
      431    13719    2           CASE( %XSS_FNC_STKPREQ#);
      432    13720                    /*N* validate XSS$TOKEN_PLEASE.TOKENS */
      433    13721    2               CALL CKDATA( XSS$TOKEN_PLEASE.DATA, 512) ALTRET( BAD_DATA);
      434    13722    2               VBLK.EVENT = %XSS_SEV_STKPREQ;
      435    13723    2           CASE( %XSS_FNC_STYDREQ#);
      436    13724    2               IF SCTX.FLAGS.VTCA THEN
      437    13725    2                   MAXSZ = SCTX.TSDUMS.RSP;
      438    13726    2               ELSE
      439    13727    2                   MAXSZ = SCTX.TSDUMS.INI;
      440    13728    2               IF MAXSZ ~= 0 THEN
      441    13729    2                   CALL CKDATA( XSS$TYPED_DATA.DATA, MAXSZ, 1) ALTRET( BAD_DATA);
      442    13730                    /*N* should support longer data items.. like SDATREQ */
      443    13731    2               VBLK.EVENT = %XSS_SEV_STYDREQ;
      444    13732    2           CASE( %XSS_FNC_SUABREQ#);
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:13   
      445    13733    2               CALL CKDATA( XSS$U_ABORT.DATA, 9) ALTRET( BAD_DATA);
      446    13734    2               VBLK.EVENT = %XSS_SEV_SUABREQ;
      447    13735    2               SCTX.TD.USRAB = %TRUE;
      448    13736    2           CASE( %XSS_FNC_SUERREQ#);
      449    13737    2               CALL CKRC( XSS$U_EXCEPTION_REPORT.REASON) ALTRET( BAD_RC);
      450    13738    2               IF SCTX.FLAGS.VTCA THEN
      451    13739    2                   MAXSZ = SCTX.TSDUMS.RSP;
      452    13740    2               ELSE
      453    13741    2                   MAXSZ = SCTX.TSDUMS.INI;
      454    13742    2               IF MAXSZ ~= 0 THEN
      455    13743    2                   CALL CKDATA( XSS$U_EXCEPTION_REPORT.DATA, MAXSZ) ALTRET( BAD_DATA);
      456    13744                    /*N* should support longer data items.. like SDATREQ */
      457    13745    2               VBLK.EVENT = %XSS_SEV_SUERREQ;
      458    13746    2           CASE( ELSE);
      459    13747    2               XSS$GENERIC.ERROR = XSS_E$BADFNC;
      460    13748    2               ALTRETURN;
      461    13749    2           END;
      462    13750    1       IF XSS_TRACE > 0 THEN
      463    13751    1           IF XSS$GENERIC.FNC ~= %XSS_FNC_SDATREQ# THEN
      464    13752    1               CALL XSS$DUMPFPT( XSS$GENERIC);
      465    13753    1       CALL XSS$MACHINE( VBLK)
      466    13754    2       WHENALTRETURN DO;
      467    13755    2   ABORT:
      468    13756    2           IF XSS$GENERIC.ERROR = '0'O THEN
      469    13757    2               XSS$GENERIC.ERROR = XSS_E$STATE;
      470    13758    2           ALTRETURN;
      471    13759    2           END;
      472    13760    1   DONE:
      473    13761    1       CALL XSS$BUFPTR( CCB$( SFPT.SCID)->XSC$CCB.SFPTX, SFPT$);
      474    13762    1       IF SFPT$ ~= ADDR( SFPT) THEN
      475    13763    1           XSS$GENERIC = SFPT;
      476    13764    1       RETURN;
      477    13765        %EJECT;
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:14   
      478    13766    1   BAD_COMMON:
      479    13767    1       XSS$GENERIC.ERROR = XSS_E$COMMON;
      480    13768    1       GOTO BAD_VIBES;
      481    13769    1   BAD_DATA:
      482    13770    1       XSS$GENERIC.ERROR = XSS_E$DATA;
      483    13771    1       GOTO BAD_VIBES;
      484    13772    1   BAD_ITOKENS:
      485    13773    1       XSS$GENERIC.ERROR = XSS_E$ITOKENS;
      486    13774    1       GOTO BAD_VIBES;
      487    13775    1   BAD_RC:
      488    13776    1       XSS$GENERIC.ERROR = XSS_E$REASON;
      489    13777    1       GOTO BAD_VIBES;
      490    13778    1   BAD_RT:
      491    13779    1       XSS$GENERIC.ERROR = XSS_E$TYPE;
      492    13780    1       GOTO BAD_VIBES;
      493    13781    1   BAD_SN:
      494    13782    1       XSS$GENERIC.ERROR = XSS_E$SERNUM;
      495    13783    1       GOTO BAD_VIBES;
      496    13784    1   BAD_AI:
      497    13785    1       XSS$GENERIC.ERROR = XSS_E$ACTID;
      498    13786    1       GOTO BAD_VIBES;
      499    13787    1   BAD_OAI:
      500    13788    1       XSS$GENERIC.ERROR = XSS_E$OACTID;
      501    13789    1       GOTO BAD_VIBES;
      502    13790    1   BAD_ADDR:
      503    13791    1       ;
      504    13792    1   BAD_VIBES:
      505    13793            /* altreturn with error code set */
      506    13794    1       ALTRETURN;
      507    13795        %EJECT;
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:15   
      508    13796    1   CKADDR: PROC( APTR$, ERR) ALTRET;
      509    13797
      510    13798            %XSC$ADDRESS( STCLASS="BASED( APTR$)");
      511    14081    2       DCL APTR$ PTR;
      512    14082    2       DCL ERR BIT(36);
      513    14083
      514    14084    3       IF APTR$ ~= ADDR( NIL) THEN DO;
      515    14085    3           IF XSC$ADDRESS.PSAP.LEN > 224 THEN
      516    14086    3               GOTO BAD_ADDR;
      517    14087    3           IF XSC$ADDRESS.SSAP.LEN > 16 THEN
      518    14088    3               GOTO BAD_ADDR;
      519    14089    3           IF XSC$ADDRESS.TSAP.LEN = 0 OR XSC$ADDRESS.TSAP.LEN > 32 THEN
      520    14090    3               GOTO BAD_ADDR;
      521    14091    3           IF XSC$ADDRESS.NSAP.LEN = 0 OR XSC$ADDRESS.NSAP.LEN > 21 THEN
      522    14092    3               GOTO BAD_ADDR;
      523    14093    3           END;
      524    14094    2       RETURN;
      525    14095    2   BAD_ADDR:
      526    14096    2       XSS$GENERIC.ERROR = ERR;
      527    14097    2       ALTRETURN;
      528    14098
      529    14099    2       END CKADDR;
      530    14100
      531    14101    1   CKDATA: PROC( QVEC, UB, LB) ALTRET;
      532    14102
      533    14103            %XSS$QVEC( NAME=QVEC, STCLASS="");
      534    14136
      535    14137    2       DCL UB SBIN;  /* upper bound on size of framed data */
      536    14138    2       DCL UPPER REDEF UB SBIN;
      537    14139    2       DCL LB SBIN;  /* optional lower bound on size of framed data */
      538    14140    2       DCL LEN SBIN;
      539    14141    2       DCL LOWER SBIN;
      540    14142
      541    14143    2       IF QVEC.PTR$ = ADDR( NIL) THEN
      542    14144    2           LEN = 0;
      543    14145    2       ELSE
      544    14146    2           LEN = QVEC.SIZE;
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:16   
      545    14147    2       IF ADDR( LB) = ADDR( NIL) THEN
      546    14148    2           LOWER = 0;
      547    14149    2       ELSE
      548    14150    2           LOWER = LB;
      549    14151    2       IF LEN < LOWER OR LEN > UPPER THEN
      550    14152    2           ALTRETURN;
      551    14153    2       RETURN;
      552    14154
      553    14155    2       END CKDATA;
      554    14156        %EJECT;
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:17   
      555    14157    1   CKSN: PROC( VAL) ALTRET;
      556    14158
      557    14159    2       DCL VAL UBIN WORD;
      558    14160
      559    14161    2       IF VAL = 0 OR VAL > 999999 THEN
      560    14162    2           ALTRETURN;
      561    14163    2       RETURN;
      562    14164
      563    14165    2       END CKSN;
      564    14166
      565    14167    1   CKAI: PROC( TXTC) ALTRET;
      566    14168
      567    14169    2       DCL 1 TXTC,
      568    14170    2            2 LEN UBIN BYTE UNAL,
      569    14171    2            2 TXT(0:5) CHAR(1) UNAL;
      570    14172    2       DCL I SBIN;
      571    14173
      572    14174    2       IF TXTC.LEN > 6 THEN
      573    14175    2           ALTRETURN;
      574    14176    2       IF TXTC.LEN > 0 THEN
      575    14177    3           DO I = 0 TO 5;
      576    14178    3               IF ASCBIN( TXTC.TXT( I)) > 255 THEN
      577    14179    3                   ALTRETURN;
      578    14180    3               END;
      579    14181    2       RETURN;
      580    14182
      581    14183    2       END CKAI;
      582    14184
      583    14185    1   CKRC: PROC( RC) ALTRET;
      584    14186
      585    14187    2       DCL RC UBIN BYTE CALIGNED;
      586    14188
      587    14189    3       DO SELECT( RC);
      588    14190    3           SELECT( %XSS_RC_ABILITY#,
      589    14191    3                   %XSS_RC_REJECTED#);
      590    14192    3               RETURN;
      591    14193    3           END;
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:18   
      592    14194    2       ALTRETURN;
      593    14195
      594    14196    2       END CKRC;
      595    14197        %EJECT;
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:19   
      596    14198    1   CKCOMMON: PROC( TXTC$) ALTRET;
      597    14199
      598    14200    2       DCL TXTC$ PTR;
      599    14201    2       DCL 1 TXTC BASED( TXTC$),
      600    14202    2            2 LEN UBIN(9) CALIGNED,
      601    14203    2            2 TXT CHAR( TXTC.LEN) CALIGNED;
      602    14204
      603    14205    2       IF TXTC$ = ADDR( NIL) THEN
      604    14206    2           TXTC$ = ADDR( NO_COMMON);
      605    14207    3       ELSE DO;
      606    14208    3           LEN = 1 + TXTC.LEN;
      607    14209    3           IF LEN > 65 THEN
      608    14210    3               ALTRETURN;
      609    14211    3           CALL XSS$BUFPTR( SCTX.COMX, PTR$);
      610    14212    3           PTR$->LENBYTES = TXTC$->LENBYTES;
      611    14213    3           END;
      612    14214    2       RETURN;
      613    14215
      614    14216    2       END CKCOMMON;
      615    14217        %EJECT;
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:20   
      616    14218    1   CKSFU: PROC ALTRET;
      617    14219
      618    14220            %XSS$$TOKENS( NAME=TOKENS, STCLASS=AUTO);
      619    14257
      620    14258    2       IF XSS$CONNECT.SFU = '000000'O THEN
      621    14259    2           GOTO BAD_SFU;
      622    14260    2       TOKENS = '0'O;
      623    14261    2       IF NOT XSS$CONNECT.SFU.FD AND NOT XSS$CONNECT.SFU.HD THEN
      624    14262    2           GOTO BAD_SFU;
      625    14263    2       IF XSS$GENERIC.FNC ~= %XSS_FNC_SCONREQ# AND
      626    14264    2               XSS$CONNECT.SFU.HD AND XSS$CONNECT.SFU.FD THEN
      627    14265    2           GOTO BAD_SFU;
      628    14266    2       IF XSS$CONNECT.SFU.EXCEP AND NOT XSS$CONNECT.SFU.HD THEN
      629    14267    2           GOTO BAD_SFU;
      630    14268    2       IF XSS$CONNECT.SFU.NR THEN
      631    14269    2           TOKENS.TR = %TRUE;
      632    14270    2       IF XSS$CONNECT.SFU.HD THEN
      633    14271    2           TOKENS.DK = %TRUE;
      634    14272    2       IF XSS$CONNECT.SFU.SY THEN
      635    14273    2           TOKENS.MI = %TRUE;
      636    14274    2       IF XSS$CONNECT.SFU.MA OR XSS$CONNECT.SFU.ACT THEN
      637    14275    2           TOKENS.MA = %TRUE;
      638    14276    2       IF XSS$CONNECT.TOKENS ~= '0'O THEN
      639    14277    2           IF XSS$CONNECT.TOKENS ~= TOKENS THEN
      640    14278    2               GOTO BAD_TOKENS;
      641    14279    2       XSS$CONNECT.TOKENS = TOKENS;
      642    14280    2       RETURN;
      643    14281    2   BAD_SFU:
      644    14282    2       XSS$GENERIC.ERROR = XSS_E$SFU;
      645    14283    2       ALTRETURN;
      646    14284    2   BAD_TOKENS:
      647    14285    2       XSS$GENERIC.ERROR = XSS_E$TOKENS;
      648    14286    2       ALTRETURN;
      649    14287
      650    14288    2       END CKSFU;
      651    14289        %EJECT;
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:21   
      652    14290    1   CKITOKENS: PROC ALTRET;
      653    14291
      654    14292    2       IF XSS$GENERIC.FNC ~= %XSS_FNC_SCONRSP# THEN
      655    14293    2           RETURN;
      656    14294    2       IF XSS$CONNECT.ITOKENS.TR = %XSS_TSI_ACHOICE# THEN
      657    14295    2           ALTRETURN;
      658    14296    2       IF XSS$CONNECT.ITOKENS.MA = %XSS_TSI_ACHOICE# THEN
      659    14297    2           ALTRETURN;
      660    14298    2       IF XSS$CONNECT.ITOKENS.MI = %XSS_TSI_ACHOICE# THEN
      661    14299    2           ALTRETURN;
      662    14300    2       IF XSS$CONNECT.ITOKENS.DK = %XSS_TSI_ACHOICE# THEN
      663    14301    2           ALTRETURN;
      664    14302    2       RETURN;
      665    14303
      666    14304    2       END CKITOKENS;
      667    14305
      668    14306    1       END XSS$SESSION;

PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:22   
--  Include file information  --

   XSC_PERR_C.:XSA1TOU  is referenced.
   XSC_COMMON_M.:XSA1TOU  is referenced.
   XSS_INTERNAL_M.:XSA1TOU  is referenced.
   XSS_INTERNAL_E.:XSA1TOU  is referenced.
   XSS_SESSION_M.:XSA1TOU  is referenced.
   XSS_SESSION_E.:XSA1TOU  is referenced.
   K_ADDRESS_M.:LIB_E05  is referenced.
   UM_CP6.:E05OU  is referenced.
   B$JIT_C.:LIB_E05  is referenced.
   B_SEGIDS_C.:LIB_E05  is referenced.
      No diagnostics issued in procedure XSS$SESSION.

   Procedure XSS$SESSION requires 1254 words for executable code.
   Procedure XSS$SESSION requires 34 words of local(AUTO) storage.

    No errors detected in file XSS$SESSION.:XSA1TSI    .

PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:23   

 Object Unit name= XSS$SESSION                                File name= XSS$SESSION.:XSA1TOU
 UTS= OCT 01 '97 12:21:29.36 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     32     40  XSS$SESSION
    1   Proc  even  none  1254   2346  XSS$SESSION
    2  RoData even  none    27     33  XSS$SESSION

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        1  XSS$SESSION
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:24   

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  XSS_VBLK                           0     10  XSS_E$RDONLYFPT
    0     11  XSS_E$BADCID                       0     12  XSS_E$BADFNC
    0     13  XSS_E$STATE                        0     14  XSS_E$ACTID
    0     15  XSS_E$ARI                          0     16  XSS_E$CALLED
    0     17  XSS_E$CALLING                      0     20  XSS_E$COMMON
    0     21  XSS_E$DATA                         0     22  XSS_E$FLOW
    0     23  XSS_E$ITOKENS                      0     24  XSS_E$OACTID
    0     25  XSS_E$OSCID                        0     26  XSS_E$QOS
    0     27  XSS_E$REASON                       0     30  XSS_E$RESPONDING
    0     31  XSS_E$RESULT                       0     32  XSS_E$SERNUM
    0     33  XSS_E$SFU                          0     34  XSS_E$TOKENS
    0     35  XSS_E$TYPE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 XSS$SCREECH
 yes     yes           Std       1 XSS$MACHINE
         yes           Std       2 XSS$EVLOG
 yes     yes           Std       3 XSS$GETMEM
 yes     yes           Std       2 XSS$CTXPTR
 yes     yes           Std       1 XSS$COMMPEND
 yes     yes           Std       1 XSS$COMMWAIT
 yes     yes           Std       2 XSS$BUFPTR
         yes    yes    Std       1 XSS$DUMPFPT
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:25   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     XSS_E$NODYNMEM                        B$JIT$                                XSS_CCB$$
     XSS_TRACE

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:26   


        1        1        /*M*    XSS$SESSION     Entry to ISO Session layer from higher layer(s) */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DDA */
        8        8        /*F*    NAME:   XSS$SESSION
        9        9                PURPOSE:
       10       10                    This routine is the entry into the Session layer from any higher
       11       11                    layer, such as Presentation or CASE.
       12       12                DESCRIPTION:
       13       13                    This is the sole entry point to the Session layer from any higher
       14       14                    layer.  A single parameter is passed, which is the Session FPT.
       15       15                    This FPT is examined to determine the Session function code that
       16       16                    is being requested, as well as the Session connection number to
       17       17                    apply the request to.  Various things may possibly be updated and
       18       18                    then the Session state machine is invoked.  The state machine
       19       19                    may cause other Session actions to occur and may further update
       20       20                    the state of the connection.
       21       21        */
       22       22        XSS$SESSION: PROC( SFPT) ALTRET;

     22  1 000000   000000 700200 xent  XSS$SESSION  TSX0  ! X66_AUTO_1
         1 000001   000042 000001                    ZERO    34,1

       23       23        %INCLUDE B_SEGIDS_C;
       24      562        %INCLUDE B$JIT_C;
       25      876            %B$JIT0;
       26      965            %U$JIT1X;
       27      968            %M$JIT2;
       28      978            %F$JIT3X;
       29      981            %S$JIT4X;
       30      984            %J$JIT5X;
       31      987            %A$JIT6X;
       32      990        %INCLUDE UM_CP6;
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:27   
       33     1842        %INCLUDE K_ADDRESS_M;
       34     2345            %K$ADDRESS;
       35     2498            %K$SSAP;
       36     2539        %INCLUDE XSS_SESSION_E;
       37     3104        %INCLUDE XSS_SESSION_M;
       38     5747            %XSS$PRIMITIVES( STCLASS="BASED( SFPT$)");
       39     9126            %XSS$GENERIC( FPTN=SFPT, STCLASS="");
       40     9272            %XSS$DATA( FPTN=SDATREQ, STCLASS=AUTO);
       41     9416        %INCLUDE XSS_INTERNAL_E;
       42     9714        %INCLUDE XSS_INTERNAL_M;
       43    10303            %XSS$VBLK( NAME=XSS_VBLK, STCLASS="CONSTANT SYMDEF");
       44    10408            %XSS$VBLK( NAME=VBLK, STCLASS=AUTO);
       45    10513            %XSS$SCTX( NAME=SCTX, STCLASS="BASED( CTX$)");
       46    10947        %INCLUDE XSC_COMMON_M;
       47    11600            %XSC$ADDRESS;
       48    11883            %XSC$CCB;
       49    12180        %MACRO ERRORDEF( NAME=XSS_ERROR, STCLASS="CONSTANT SYMDEF", LVL=1, LAST=";",
       50    12181                         ERR#=0, SEV=0);
       51    12182            %VLP_ERRCODE( FPTN=NAME, STCLASS=STCLASS, FCG='XS', MID='S',
       52    12183                          MON='0'B, ERR#=ERR#, SEV=SEV);
       53    12184        %MEND;
       54    12185        %INCLUDE XSC_PERR_C;
       55    12262            %ERRORDEF( NAME=XSS_E$NODYNMEM, STCLASS=SYMREF);
       56    12310            %ERRORDEF( NAME=XSS_E$RDONLYFPT, ERR#=%E$RDONLYFPT);
       57    12358            /*E*  ERROR:  XSS-E$RDONLYFPT-0
       58    12359                MESSAGE:  FPT is read-only; must be writeable.
       59    12360            */
       60    12361            %ERRORDEF( NAME=XSS_E$BADCID, ERR#=%E$BADCID);
       61    12409            /*E*  ERROR:  XSS-E$BADCID-0
       62    12410                MESSAGE:  Illegal connection identifier.
       63    12411            */
       64    12412            %ERRORDEF( NAME=XSS_E$BADFNC, ERR#=%E$BADFNC);
       65    12460            /*E*  ERROR:  XSS-E$BADFNC-0
       66    12461                MESSAGE:  Illegal function code.
       67    12462            */
       68    12463            %ERRORDEF( NAME=XSS_E$STATE, ERR#=%E$STATE);
       69    12511            /*E*  ERROR:  XSS-E$STATE-0
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:28   
       70    12512                MESSAGE:  Connection state prevents this action.
       71    12513            */
       72    12514            %ERRORDEF( NAME=XSS_E$ACTID, ERR#=%E$ACTID);
       73    12562            /*E*  ERROR:  XSS-E$ACTID-0
       74    12563                MESSAGE:  ACTID contains an illegal value.
       75    12564            */
       76    12565            %ERRORDEF( NAME=XSS_E$ARI, ERR#=%E$ARI);
       77    12613            /*E*  ERROR:  XSS-E$ARI-0
       78    12614                MESSAGE:  ARI contains an illegal value.
       79    12615            */
       80    12616            %ERRORDEF( NAME=XSS_E$CALLED, ERR#=%E$CALLED);
       81    12664            /*E*  ERROR:  XSS-E$CALLED-0
       82    12665                MESSAGE:  CALLED contains an illegal value.
       83    12666            */
       84    12667            %ERRORDEF( NAME=XSS_E$CALLING, ERR#=%E$CALLING);
       85    12715            /*E*  ERROR:  XSS-E$CALLING-0
       86    12716                MESSAGE:  CALLING contains an illegal value.
       87    12717            */
       88    12718            %ERRORDEF( NAME=XSS_E$COMMON, ERR#=%E$COMMON);
       89    12766            /*E*  ERROR:  XSS-E$COMMON-0
       90    12767                MESSAGE:  COMMON contains an illegal value.
       91    12768            */
       92    12769            %ERRORDEF( NAME=XSS_E$DATA, ERR#=%E$DATA);
       93    12817            /*E*  ERROR:  XSS-E$DATA-0
       94    12818                MESSAGE:  DATA contains an illegal value.
       95    12819            */
       96    12820            %ERRORDEF( NAME=XSS_E$FLOW, ERR#=%E$FLOW);
       97    12868            /*E*  ERROR:  XSS-E$FLOW-0
       98    12869                MESSAGE:  Connection flow control prevents this action.
       99    12870            */
      100    12871            %ERRORDEF( NAME=XSS_E$ITOKENS, ERR#=%E$ITOKENS);
      101    12919            /*E*  ERROR:  XSS-E$ITOKENS-0
      102    12920                MESSAGE:  ITOKENS contains an illegal value.
      103    12921            */
      104    12922            %ERRORDEF( NAME=XSS_E$OACTID, ERR#=%E$OACTID);
      105    12970            /*E*  ERROR:  XSS-E$OACTID-0
      106    12971                MESSAGE:  OACTID contains an illegal value.
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:29   
      107    12972            */
      108    12973            %ERRORDEF( NAME=XSS_E$OSCID, ERR#=%E$OSCID);
      109    13021            /*E*  ERROR:  XSS-E$OSCID-0
      110    13022                MESSAGE:  OSCID contains an illegal value.
      111    13023            */
      112    13024            %ERRORDEF( NAME=XSS_E$QOS, ERR#=%E$QOS);
      113    13072            /*E*  ERROR:  XSS-E$QOS-0
      114    13073                MESSAGE:  QOS contains an illegal value.
      115    13074            */
      116    13075            %ERRORDEF( NAME=XSS_E$REASON, ERR#=%E$REASON);
      117    13123            /*E*  ERROR:  XSS-E$REASON-0
      118    13124                MESSAGE:  REASON contains an illegal value.
      119    13125            */
      120    13126            %ERRORDEF( NAME=XSS_E$RESPONDING, ERR#=%E$RESPONDING);
      121    13174            /*E*  ERROR:  XSS-E$RESPONDING-0
      122    13175                MESSAGE:  RESPONDING contains an illegal value.
      123    13176            */
      124    13177            %ERRORDEF( NAME=XSS_E$RESULT, ERR#=%E$RESULT);
      125    13225            /*E*  ERROR:  XSS-E$RESULT-0
      126    13226                MESSAGE:  RESULT contains an illegal value.
      127    13227            */
      128    13228            %ERRORDEF( NAME=XSS_E$SERNUM, ERR#=%E$SERNUM);
      129    13276            /*E*  ERROR:  XSS-E$SERNUM-0
      130    13277                MESSAGE:  SERNUM contains an illegal value.
      131    13278            */
      132    13279            %ERRORDEF( NAME=XSS_E$SFU, ERR#=%E$SFU);
      133    13327            /*E*  ERROR:  XSS-E$SFU-0
      134    13328                MESSAGE:  SFU contains an illegal value.
      135    13329            */
      136    13330            %ERRORDEF( NAME=XSS_E$TOKENS, ERR#=%E$TOKENS);
      137    13378            /*E*  ERROR:  XSS-E$TOKENS-0
      138    13379                MESSAGE:  TOKENS contains an illegal value.
      139    13380            */
      140    13381            %ERRORDEF( NAME=XSS_E$TYPE, ERR#=%E$TYPE);
      141    13429            /*E*  ERROR:  XSS-E$TYPE-0
      142    13430                MESSAGE:  TYPE contains an illegal value.
      143    13431            */
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:30   
      144    13432
      145    13433    1       DCL XSS$BUFPTR ENTRY(2) ALTRET;
      146    13434    1       DCL XSS$COMMPEND ENTRY(1) ALTRET;
      147    13435    1       DCL XSS$COMMWAIT ENTRY(1) ALTRET;
      148    13436    1       DCL XSS$CTXPTR ENTRY(2) ALTRET;
      149    13437    1       DCL XSS$DUMPFPT ENTRY(1) OPTIONAL;
      150    13438    1       DCL XSS$GETMEM ENTRY(3) ALTRET;
      151    13439    1       DCL XSS$MACHINE ENTRY(1) ALTRET;
      152    13440    1       DCL XSS$SCREECH ENTRY(1);
      153    13441    1       DCL XSS$EVLOG ENTRY(2);
      154    13442
      155    13443    1       DCL B$JIT$ PTR SYMREF;
      156    13444    1       DCL XSS_CCB$$ PTR SYMREF;
      157    13445    1       DCL XSS_TRACE SBIN SYMREF;
      158    13446
      159    13447    1       DCL BLKX UBIN HALF HALIGNED;
      160    13448    1       DCL BYTES CHAR( LEN) BASED UNAL;
      161    13449    1       DCL CCB$(0:0) PTR BASED( XSS_CCB$$) ALIGNED;
      162    13450    1       DCL CTX$ PTR;
      163    13451    1       DCL LEN SBIN;
      164    13452    1       DCL LENBYTES CHAR( LEN) BASED CALIGNED;
      165    13453    1       DCL 1 NO_COMMON CONSTANT,  /* null TEXTC item */
      166    13454    1            2 * UBIN BYTE INIT( 0) CALIGNED,
      167    13455    1            2 *(0:2) UBIN BYTE INIT( 0*3) CALIGNED;
      168    13456    1       DCL PTR$ PTR;
      169    13457    1       DCL SCID SBIN;
      170    13458    1       DCL TEMP REDEF SCID SBIN;
      171    13459    1       DCL SFPT$ PTR;
      172    13460    1       DCL 1 PX REDEF SFPT$,
      173    13461    1            2 OFFSET UBIN(18) UNAL,
      174    13462    1            2 * BIT(6) UNAL,
      175    13463    1            2 SEGID BIT(12) UNAL;
      176    13464    1       DCL MAXSZ SBIN;
      177    13465
      178    13466    1       SFPT$ = ADDR( SFPT);

  13466  1 000002   200003 236100                    LDQ     @SFPT,,AUTO
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:31   
         1 000003   200025 756100                    STQ     SFPT$,,AUTO

      179    13467    2       IF PX.SEGID = %ISSID THEN DO;

  13467  1 000004   200025 236100                    LDQ     SFPT$,,AUTO
         1 000005   007777 376007                    ANQ     4095,DL
         1 000006   006000 116007                    CMPQ    3072,DL
         1 000007   000037 601000 1                  TNZ     s:13477

      180    13468    2           TEMP = 64 + PX.OFFSET / 1024;  /* page number of FPT's page */

  13468  1 000010   200025 236100                    LDQ     SFPT$,,AUTO
         1 000011   000022 772000                    QRL     18
         1 000012   000012 772000                    QRL     10
         1 000013   000100 036007                    ADLQ    64,DL
         1 000014   200024 756100                    STQ     SCID,,AUTO

      181    13469    3           IF TEMP >= B$JIT.PLL AND TEMP <= B$JIT.PUL THEN DO;

  13469  1 000015   000000 470400 xsym               LDP0    B$JIT$
         1 000016   000176 236100                    LDQ     126,,PR0
         1 000017   000022 772000                    QRL     18
         1 000020   200024 116100                    CMPQ    SCID,,AUTO
         1 000021   000037 605400 1                  TPNZ    s:13477
         1 000022   000176 236100                    LDQ     126,,PR0
         1 000023   777777 376007                    ANQ     -1,DL
         1 000024   200024 116100                    CMPQ    SCID,,AUTO
         1 000025   000037 604000 1                  TMI     s:13477

      182    13470                    /* the user's FPT was allocated in CONSTANT storage */
      183    13471    3               IF XSS$GENERIC.ERROR = XSS_E$RDONLYFPT THEN

  13471  1 000026   200025 471500                    LDP1    SFPT$,,AUTO
         1 000027   100001 236100                    LDQ     1,,PR1
         1 000030   000010 116000 0                  CMPQ    XSS_E$RDONLYFPT
         1 000031   000033 601000 1                  TNZ     s:13473

PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:32   
      184    13472    3                   ALTRETURN;

  13472  1 000032   000000 702200 xent               TSX2  ! X66_AALT

      185    13473    3               CALL XSS$SCREECH( XSS_E$RDONLYFPT);

  13473  1 000033   000001 630400 2                  EPPR0   1
         1 000034   000000 631400 2                  EPPR1   0
         1 000035   000000 701000 xent               TSX1    XSS$SCREECH
         1 000036   000000 011000                    NOP     0

      186    13474    3               END;

      187    13475    2           END;

      188    13476            /* Initialize returned error code */
      189    13477    1       XSS$GENERIC.ERROR = '0'B;

  13477  1 000037   200025 470500                    LDP0    SFPT$,,AUTO
         1 000040   000001 450100                    STZ     1,,PR0

      190    13478            /* Initialize AUTO copy of VBLK structure */
      191    13479    1       VBLK = XSS_VBLK;

  13479  1 000041   000100 100400                    MLR     fill='000'O
         1 000042   000000 000040 0                  ADSC9   XSS_VBLK                 cn=0,n=32
         1 000043   200010 000040                    ADSC9   VBLK,,AUTO               cn=0,n=32

      192    13480    1       VBLK.FPT$ = SFPT$;

  13480  1 000044   200025 236100                    LDQ     SFPT$,,AUTO
         1 000045   200012 756100                    STQ     VBLK+2,,AUTO

      193    13481            /* Determine which connection is being referred to */
      194    13482    1       SCID = XSS$GENERIC.SCID;

  13482  1 000046   200025 470500                    LDP0    SFPT$,,AUTO
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:33   
         1 000047   000000 236100                    LDQ     0,,PR0
         1 000050   000022 772000                    QRL     18
         1 000051   000777 376007                    ANQ     511,DL
         1 000052   200024 756100                    STQ     SCID,,AUTO

      195    13483    1       CALL XSS$EVLOG( 'KS', XSS$GENERIC.FNC*512 + SCID);

  13483  1 000053   000000 236100                    LDQ     0,,PR0
         1 000054   000022 772000                    QRL     18
         1 000055   777000 376007                    ANQ     -512,DL
         1 000056   200024 036100                    ADLQ    SCID,,AUTO
         1 000057   200036 756100                    STQ     LOWER+1,,AUTO
         1 000060   200036 631500                    EPPR1   LOWER+1,,AUTO
         1 000061   200041 451500                    STP1    LOWER+4,,AUTO
         1 000062   000003 236000 2                  LDQ     3
         1 000063   200040 756100                    STQ     LOWER+3,,AUTO
         1 000064   200040 630500                    EPPR0   LOWER+3,,AUTO
         1 000065   000002 631400 2                  EPPR1   2
         1 000066   000000 701000 xent               TSX1    XSS$EVLOG
         1 000067   000000 011000                    NOP     0

      196    13484    1   LOOP:
      197    13485    1       CALL XSS$CTXPTR( SCID, CTX$)

  13485  1 000070   200021 630500       LOOP         EPPR0   CTX$,,AUTO
         1 000071   200037 450500                    STP0    LOWER+2,,AUTO
         1 000072   200024 631500                    EPPR1   SCID,,AUTO
         1 000073   200036 451500                    STP1    LOWER+1,,AUTO
         1 000074   200036 630500                    EPPR0   LOWER+1,,AUTO
         1 000075   000002 631400 2                  EPPR1   2
         1 000076   000000 701000 xent               TSX1    XSS$CTXPTR
         1 000077   000112 702000 1                  TSX2    s:13491

      198    13486    2       WHENRETURN DO;

      199    13487    2           IF SCTX.LATCH.PRESENT THEN

PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:34   
  13487  1 000100   200021 470500                    LDP0    CTX$,,AUTO
         1 000101   000035 234100                    SZN     29,,PR0
         1 000102   000111 605000 1                  TPL     s:13489

      200    13488    2               CALL XSS$COMMPEND( SCID) ALTRET( LOOP);

  13488  1 000103   200024 631500                    EPPR1   SCID,,AUTO
         1 000104   200036 451500                    STP1    LOWER+1,,AUTO
         1 000105   200036 630500                    EPPR0   LOWER+1,,AUTO
         1 000106   000000 631400 2                  EPPR1   0
         1 000107   000000 701000 xent               TSX1    XSS$COMMPEND
         1 000110   000070 702000 1                  TSX2    LOOP

      201    13489    2           END;

  13489  1 000111   000116 710000 1                  TRA     s:13494

      202    13490    2       WHENALTRETURN DO;

      203    13491    2           XSS$GENERIC.ERROR = XSS_E$BADCID;

  13491  1 000112   000011 236000 0                  LDQ     XSS_E$BADCID
         1 000113   200025 470500                    LDP0    SFPT$,,AUTO
         1 000114   000001 756100                    STQ     1,,PR0

      204    13492    2           ALTRETURN;

  13492  1 000115   000000 702200 xent               TSX2  ! X66_AALT

      205    13493    2           END;
      206    13494    2       IF SCTX.FLOWSTOPPED THEN DO;

  13494  1 000116   200021 470500                    LDP0    CTX$,,AUTO
         1 000117   000013 236100                    LDQ     11,,PR0
         1 000120   040000 316007                    CANQ    16384,DL
         1 000121   000135 600000 1                  TZE     s:13506

PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:35   
      207    13495    3           IF SCTX.BLOCKING THEN DO;

  13495  1 000122   020000 316007                    CANQ    8192,DL
         1 000123   000131 600000 1                  TZE     s:13501

      208    13496    3   BLOCKLOOP:
      209    13497    3               CALL XSS$COMMWAIT( 10) ALTRET( LOOP);

  13497  1 000124   000005 630400 2     BLOCKLOOP    EPPR0   5
         1 000125   000000 631400 2                  EPPR1   0
         1 000126   000000 701000 xent               TSX1    XSS$COMMWAIT
         1 000127   000070 702000 1                  TSX2    LOOP

      210    13498    3               GOTO BLOCKLOOP;

  13498  1 000130   000124 710000 1                  TRA     BLOCKLOOP

      211    13499    3               END;
      212    13500    3           ELSE DO;

      213    13501    3               XSS$GENERIC.ERROR = XSS_E$FLOW;

  13501  1 000131   000022 236000 0                  LDQ     XSS_E$FLOW
         1 000132   200025 471500                    LDP1    SFPT$,,AUTO
         1 000133   100001 756100                    STQ     1,,PR1

      214    13502    3               ALTRETURN;

  13502  1 000134   000000 702200 xent               TSX2  ! X66_AALT

      215    13503    3               END;
      216    13504    2           END;
      217    13505            /* Update AUTO VBLK context ptr */
      218    13506    1       VBLK.CTX$ = CTX$;

  13506  1 000135   200021 236100                    LDQ     CTX$,,AUTO
         1 000136   200010 756100                    STQ     VBLK,,AUTO
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:36   

      219    13507            /* Split depending on the Session function code requested */
      220    13508    2       DO CASE( XSS$GENERIC.FNC);

  13508  1 000137   200025 471500                    LDP1    SFPT$,,AUTO
         1 000140   100000 236100                    LDQ     0,,PR1
         1 000141   000033 772000                    QRL     27
         1 000142   000070 116007                    CMPQ    56,DL
         1 000143   000145 602006 1                  TNC     s:13508+6,QL
         1 000144   001636 710000 1                  TRA     s:13747
         1 000145   001636 710000 1                  TRA     s:13747
         1 000146   000235 710000 1                  TRA     s:13510
         1 000147   001636 710000 1                  TRA     s:13747
         1 000150   000245 710000 1                  TRA     s:13513
         1 000151   001636 710000 1                  TRA     s:13747
         1 000152   000250 710000 1                  TRA     s:13515
         1 000153   001636 710000 1                  TRA     s:13747
         1 000154   000270 710000 1                  TRA     s:13519
         1 000155   001636 710000 1                  TRA     s:13747
         1 000156   000303 710000 1                  TRA     s:13522
         1 000157   001636 710000 1                  TRA     s:13747
         1 000160   000313 710000 1                  TRA     s:13525
         1 000161   001636 710000 1                  TRA     s:13747
         1 000162   000316 710000 1                  TRA     s:13527
         1 000163   001636 710000 1                  TRA     s:13747
         1 000164   000467 710000 1                  TRA     s:13551
         1 000165   001636 710000 1                  TRA     s:13747
         1 000166   000507 710000 1                  TRA     s:13555
         1 000167   001636 710000 1                  TRA     s:13747
         1 000170   000522 710000 1                  TRA     s:13558
         1 000171   001636 710000 1                  TRA     s:13747
         1 000172   000535 710000 1                  TRA     s:13562
         1 000173   001636 710000 1                  TRA     s:13747
         1 000174   000743 710000 1                  TRA     s:13598
         1 000175   001636 710000 1                  TRA     s:13747
         1 000176   001141 710000 1                  TRA     s:13633
         1 000177   001636 710000 1                  TRA     s:13747
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:37   
         1 000200   001157 710000 1                  TRA     s:13639
         1 000201   001636 710000 1                  TRA     s:13747
         1 000202   001302 710000 1                  TRA     s:13672
         1 000203   001636 710000 1                  TRA     s:13747
         1 000204   001314 710000 1                  TRA     s:13675
         1 000205   001636 710000 1                  TRA     s:13747
         1 000206   001327 710000 1                  TRA     s:13679
         1 000207   001636 710000 1                  TRA     s:13747
         1 000210   001342 710000 1                  TRA     s:13682
         1 000211   001636 710000 1                  TRA     s:13747
         1 000212   001403 710000 1                  TRA     s:13696
         1 000213   001636 710000 1                  TRA     s:13747
         1 000214   001423 710000 1                  TRA     s:13701
         1 000215   001636 710000 1                  TRA     s:13747
         1 000216   001443 710000 1                  TRA     s:13705
         1 000217   001636 710000 1                  TRA     s:13747
         1 000220   001456 710000 1                  TRA     s:13709
         1 000221   001636 710000 1                  TRA     s:13747
         1 000222   001476 710000 1                  TRA     s:13713
         1 000223   001636 710000 1                  TRA     s:13747
         1 000224   001516 710000 1                  TRA     s:13718
         1 000225   001636 710000 1                  TRA     s:13747
         1 000226   001521 710000 1                  TRA     s:13721
         1 000227   001636 710000 1                  TRA     s:13747
         1 000230   001534 710000 1                  TRA     s:13724
         1 000231   001636 710000 1                  TRA     s:13747
         1 000232   001563 710000 1                  TRA     s:13733
         1 000233   001636 710000 1                  TRA     s:13747
         1 000234   001601 710000 1                  TRA     s:13737

      221    13509    2           CASE( %XSS_FNC_SACDREQ#);

      222    13510    2               CALL CKRC( XSS$ACTIVITY_DISCARD.REASON) ALTRET( BAD_RC);

  13510  1 000235   200025 236100                    LDQ     SFPT$,,AUTO
         1 000236   400000 036007                    ADLQ    -131072,DL
         1 000237   200031 756100                    STQ     MAXSZ+3,,AUTO
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:38   
         1 000240   002123 701000 1                  TSX1    CKRC
         1 000241   001735 702000 1                  TSX2    BAD_RC

      223    13511    2               VBLK.EVENT = %XSS_SEV_SACDREQ;

  13511  1 000242   000100 236007                    LDQ     64,DL
         1 000243   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 000244   001641 710000 1                  TRA     s:13750

      224    13512    2           CASE( %XSS_FNC_SACDRSP#);

      225    13513    2               VBLK.EVENT = %XSS_SEV_SACDRSP;

  13513  1 000245   000102 236007                    LDQ     66,DL
         1 000246   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 000247   001641 710000 1                  TRA     s:13750

      226    13514    2           CASE( %XSS_FNC_SACEREQ#);

      227    13515    2               CALL CKSN( XSS$ACTIVITY_END.SERNUM) ALTRET( BAD_SN);

  13515  1 000250   200025 236100                    LDQ     SFPT$,,AUTO
         1 000251   000004 036003                    ADLQ    4,DU
         1 000252   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 000253   002053 701000 1                  TSX1    CKSN
         1 000254   001744 702000 1                  TSX2    BAD_SN

      228    13516    2               CALL CKDATA( XSS$ACTIVITY_END.DATA, 512) ALTRET( BAD_DATA);

  13516  1 000255   000007 236000 2                  LDQ     7
         1 000256   000010 235000 2                  LDA     8
         1 000257   200032 757100                    STAQ    TOKENS+1,,AUTO
         1 000260   200025 236100                    LDQ     SFPT$,,AUTO
         1 000261   000002 036003                    ADLQ    2,DU
         1 000262   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 000263   002022 701000 1                  TSX1    CKDATA
         1 000264   001725 702000 1                  TSX2    BAD_DATA
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:39   

      229    13517    2               VBLK.EVENT = %XSS_SEV_SACEREQ;

  13517  1 000265   000104 236007                    LDQ     68,DL
         1 000266   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 000267   001641 710000 1                  TRA     s:13750

      230    13518    2           CASE( %XSS_FNC_SACERSP#);

      231    13519    2               CALL CKDATA( XSS$ACTIVITY_END.DATA, 512) ALTRET( BAD_DATA);

  13519  1 000270   000007 236000 2                  LDQ     7
         1 000271   000010 235000 2                  LDA     8
         1 000272   200032 757100                    STAQ    TOKENS+1,,AUTO
         1 000273   200025 236100                    LDQ     SFPT$,,AUTO
         1 000274   000002 036003                    ADLQ    2,DU
         1 000275   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 000276   002022 701000 1                  TSX1    CKDATA
         1 000277   001725 702000 1                  TSX2    BAD_DATA

      232    13520    2               VBLK.EVENT = %XSS_SEV_SACERSP;

  13520  1 000300   000106 236007                    LDQ     70,DL
         1 000301   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 000302   001641 710000 1                  TRA     s:13750

      233    13521    2           CASE( %XSS_FNC_SACIREQ#);

      234    13522    2               CALL CKRC( XSS$ACTIVITY_INTERRUPT.REASON) ALTRET( BAD_RC);

  13522  1 000303   200025 236100                    LDQ     SFPT$,,AUTO
         1 000304   400000 036007                    ADLQ    -131072,DL
         1 000305   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 000306   002123 701000 1                  TSX1    CKRC
         1 000307   001735 702000 1                  TSX2    BAD_RC

      235    13523    2               VBLK.EVENT = %XSS_SEV_SACIREQ;
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:40   

  13523  1 000310   000110 236007                    LDQ     72,DL
         1 000311   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 000312   001641 710000 1                  TRA     s:13750

      236    13524    2           CASE( %XSS_FNC_SACIRSP#);

      237    13525    2               VBLK.EVENT = %XSS_SEV_SACIRSP;

  13525  1 000313   000112 236007                    LDQ     74,DL
         1 000314   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 000315   001641 710000 1                  TRA     s:13750

      238    13526    2           CASE( %XSS_FNC_SACRREQ#);

      239    13527    2               CALL CKAI( XSS$ACTIVITY_RESUME.ACTID) ALTRET( BAD_AI);

  13527  1 000316   200025 236100                    LDQ     SFPT$,,AUTO
         1 000317   000010 036003                    ADLQ    8,DU
         1 000320   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 000321   002063 701000 1                  TSX1    CKAI
         1 000322   001750 702000 1                  TSX2    BAD_AI

      240    13528    2               CALL CKAI( XSS$ACTIVITY_RESUME.OACTID) ALTRET( BAD_OAI);

  13528  1 000323   200025 236100                    LDQ     SFPT$,,AUTO
         1 000324   000012 036003                    ADLQ    10,DU
         1 000325   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 000326   002063 701000 1                  TSX1    CKAI
         1 000327   001754 702000 1                  TSX2    BAD_OAI

      241    13529    2               CALL CKSN( XSS$ACTIVITY_RESUME.SERNUM) ALTRET( BAD_SN);

  13529  1 000330   200025 236100                    LDQ     SFPT$,,AUTO
         1 000331   000004 036003                    ADLQ    4,DU
         1 000332   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 000333   002053 701000 1                  TSX1    CKSN
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:41   
         1 000334   001744 702000 1                  TSX2    BAD_SN

      242    13530                    /* XSS$ACTIVITY_RESUME.OSCID need not be validated */
      243    13531    2               CALL CKCOMMON( XSS$ACTIVITY_RESUME.COMMON$) ALTRET( BAD_COMMON);

  13531  1 000335   200025 236100                    LDQ     SFPT$,,AUTO
         1 000336   000005 036003                    ADLQ    5,DU
         1 000337   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 000340   002145 701000 1                  TSX1    CKCOMMON
         1 000341   001721 702000 1                  TSX2    BAD_COMMON

      244    13532    2               CALL CKADDR( XSS$ACTIVITY_RESUME.CALLING$, XSS_E$CALLING)

  13532  1 000342   000011 236000 2                  LDQ     9
         1 000343   200032 756100                    STQ     TOKENS+1,,AUTO
         1 000344   200025 236100                    LDQ     SFPT$,,AUTO
         1 000345   000006 036003                    ADLQ    6,DU
         1 000346   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 000347   001761 701000 1                  TSX1    CKADDR
         1 000350   001760 702000 1                  TSX2    BAD_ADDR

      245    13533    2                       ALTRET( BAD_ADDR);
      246    13534    2               IF XSS$ACTIVITY_RESUME.CALLING$ = ADDR( NIL) THEN

  13534  1 000351   200025 470500                    LDP0    SFPT$,,AUTO
         1 000352   000006 236100                    LDQ     6,,PR0
         1 000353   000007 116000 2                  CMPQ    7
         1 000354   000370 601000 1                  TNZ     s:13537

      247    13535    2                   CALL XSS$BUFPTR( SCTX.SRCX, XSS$ACTIVITY_RESUME.CALLING$);

  13535  1 000355   200025 236100                    LDQ     SFPT$,,AUTO
         1 000356   000006 036003                    ADLQ    6,DU
         1 000357   200037 756100                    STQ     LOWER+2,,AUTO
         1 000360   200021 236100                    LDQ     CTX$,,AUTO
         1 000361   000003 036003                    ADLQ    3,DU
         1 000362   200036 756100                    STQ     LOWER+1,,AUTO
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:42   
         1 000363   200036 630500                    EPPR0   LOWER+1,,AUTO
         1 000364   000002 631400 2                  EPPR1   2
         1 000365   000000 701000 xent               TSX1    XSS$BUFPTR
         1 000366   000000 011000                    NOP     0
         1 000367   000407 710000 1                  TRA     s:13540

      248    13536    3               ELSE DO;

      249    13537    3                   CALL XSS$BUFPTR( SCTX.SRCX, PTR$);

  13537  1 000370   200023 631500                    EPPR1   PTR$,,AUTO
         1 000371   200037 451500                    STP1    LOWER+2,,AUTO
         1 000372   200021 236100                    LDQ     CTX$,,AUTO
         1 000373   000003 036003                    ADLQ    3,DU
         1 000374   200036 756100                    STQ     LOWER+1,,AUTO
         1 000375   200036 630500                    EPPR0   LOWER+1,,AUTO
         1 000376   000002 631400 2                  EPPR1   2
         1 000377   000000 701000 xent               TSX1    XSS$BUFPTR
         1 000400   000000 011000                    NOP     0

      250    13538    3                   PTR$->XSC$ADDRESS = XSS$ACTIVITY_RESUME.CALLING$->XSC$ADDRESS;

  13538  1 000401   200025 470500                    LDP0    SFPT$,,AUTO
         1 000402   000006 471500                    LDP1    6,,PR0
         1 000403   200023 473500                    LDP3    PTR$,,AUTO
         1 000404   000100 100500                    MLR     fill='000'O
         1 000405   100000 000456                    ADSC9   0,,PR1                   cn=0,n=302
         1 000406   300000 000456                    ADSC9   0,,PR3                   cn=0,n=302

      251    13539    3                   END;

      252    13540    2               CALL CKADDR( XSS$ACTIVITY_RESUME.CALLED$, XSS_E$CALLED)

  13540  1 000407   000012 236000 2                  LDQ     10
         1 000410   200032 756100                    STQ     TOKENS+1,,AUTO
         1 000411   200025 236100                    LDQ     SFPT$,,AUTO
         1 000412   000007 036003                    ADLQ    7,DU
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:43   
         1 000413   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 000414   001761 701000 1                  TSX1    CKADDR
         1 000415   001760 702000 1                  TSX2    BAD_ADDR

      253    13541    2                       ALTRET( BAD_ADDR);
      254    13542    2               IF XSS$ACTIVITY_RESUME.CALLED$ = ADDR( NIL) THEN

  13542  1 000416   200025 470500                    LDP0    SFPT$,,AUTO
         1 000417   000007 236100                    LDQ     7,,PR0
         1 000420   000007 116000 2                  CMPQ    7
         1 000421   000435 601000 1                  TNZ     s:13545

      255    13543    2                   CALL XSS$BUFPTR( SCTX.DSTX, XSS$ACTIVITY_RESUME.CALLED$);

  13543  1 000422   200025 236100                    LDQ     SFPT$,,AUTO
         1 000423   000007 036003                    ADLQ    7,DU
         1 000424   200037 756100                    STQ     LOWER+2,,AUTO
         1 000425   200021 236100                    LDQ     CTX$,,AUTO
         1 000426   000013 036000 2                  ADLQ    11
         1 000427   200036 756100                    STQ     LOWER+1,,AUTO
         1 000430   200036 630500                    EPPR0   LOWER+1,,AUTO
         1 000431   000002 631400 2                  EPPR1   2
         1 000432   000000 701000 xent               TSX1    XSS$BUFPTR
         1 000433   000000 011000                    NOP     0
         1 000434   000454 710000 1                  TRA     s:13548

      256    13544    3               ELSE DO;

      257    13545    3                   CALL XSS$BUFPTR( SCTX.DSTX, PTR$);

  13545  1 000435   200023 631500                    EPPR1   PTR$,,AUTO
         1 000436   200037 451500                    STP1    LOWER+2,,AUTO
         1 000437   200021 236100                    LDQ     CTX$,,AUTO
         1 000440   000013 036000 2                  ADLQ    11
         1 000441   200036 756100                    STQ     LOWER+1,,AUTO
         1 000442   200036 630500                    EPPR0   LOWER+1,,AUTO
         1 000443   000002 631400 2                  EPPR1   2
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:44   
         1 000444   000000 701000 xent               TSX1    XSS$BUFPTR
         1 000445   000000 011000                    NOP     0

      258    13546    3                   PTR$->XSC$ADDRESS = XSS$ACTIVITY_RESUME.CALLED$->XSC$ADDRESS;

  13546  1 000446   200025 470500                    LDP0    SFPT$,,AUTO
         1 000447   000007 471500                    LDP1    7,,PR0
         1 000450   200023 473500                    LDP3    PTR$,,AUTO
         1 000451   000100 100500                    MLR     fill='000'O
         1 000452   100000 000456                    ADSC9   0,,PR1                   cn=0,n=302
         1 000453   300000 000456                    ADSC9   0,,PR3                   cn=0,n=302

      259    13547    3                   END;

      260    13548    2               CALL CKDATA( XSS$ACTIVITY_RESUME.DATA, 512) ALTRET( BAD_DATA);

  13548  1 000454   000007 236000 2                  LDQ     7
         1 000455   000010 235000 2                  LDA     8
         1 000456   200032 757100                    STAQ    TOKENS+1,,AUTO
         1 000457   200025 236100                    LDQ     SFPT$,,AUTO
         1 000460   000002 036003                    ADLQ    2,DU
         1 000461   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 000462   002022 701000 1                  TSX1    CKDATA
         1 000463   001725 702000 1                  TSX2    BAD_DATA

      261    13549    2               VBLK.EVENT = %XSS_SEV_SACRREQ;

  13549  1 000464   000114 236007                    LDQ     76,DL
         1 000465   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 000466   001641 710000 1                  TRA     s:13750

      262    13550    2           CASE( %XSS_FNC_SACSREQ#);

      263    13551    2               CALL CKAI( XSS$ACTIVITY_START.ACTID) ALTRET( BAD_AI);

  13551  1 000467   200025 236100                    LDQ     SFPT$,,AUTO
         1 000470   000004 036003                    ADLQ    4,DU
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:45   
         1 000471   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 000472   002063 701000 1                  TSX1    CKAI
         1 000473   001750 702000 1                  TSX2    BAD_AI

      264    13552    2               CALL CKDATA( XSS$ACTIVITY_START.DATA, 512) ALTRET( BAD_DATA);

  13552  1 000474   000007 236000 2                  LDQ     7
         1 000475   000010 235000 2                  LDA     8
         1 000476   200032 757100                    STAQ    TOKENS+1,,AUTO
         1 000477   200025 236100                    LDQ     SFPT$,,AUTO
         1 000500   000002 036003                    ADLQ    2,DU
         1 000501   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 000502   002022 701000 1                  TSX1    CKDATA
         1 000503   001725 702000 1                  TSX2    BAD_DATA

      265    13553    2               VBLK.EVENT = %XSS_SEV_SACSREQ;

  13553  1 000504   000116 236007                    LDQ     78,DL
         1 000505   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 000506   001641 710000 1                  TRA     s:13750

      266    13554    2           CASE( %XSS_FNC_SCADREQ#);

      267    13555    2               CALL CKDATA( XSS$CAPABILITY_DATA.DATA, 512) ALTRET( BAD_DATA);

  13555  1 000507   000007 236000 2                  LDQ     7
         1 000510   000010 235000 2                  LDA     8
         1 000511   200032 757100                    STAQ    TOKENS+1,,AUTO
         1 000512   200025 236100                    LDQ     SFPT$,,AUTO
         1 000513   000002 036003                    ADLQ    2,DU
         1 000514   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 000515   002022 701000 1                  TSX1    CKDATA
         1 000516   001725 702000 1                  TSX2    BAD_DATA

      268    13556    2               VBLK.EVENT = %XSS_SEV_SACDREQ;

  13556  1 000517   000100 236007                    LDQ     64,DL
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:46   
         1 000520   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 000521   001641 710000 1                  TRA     s:13750

      269    13557    2           CASE( %XSS_FNC_SCADRSP#);

      270    13558    2               CALL CKDATA( XSS$CAPABILITY_DATA.DATA, 512) ALTRET( BAD_DATA);

  13558  1 000522   000007 236000 2                  LDQ     7
         1 000523   000010 235000 2                  LDA     8
         1 000524   200032 757100                    STAQ    TOKENS+1,,AUTO
         1 000525   200025 236100                    LDQ     SFPT$,,AUTO
         1 000526   000002 036003                    ADLQ    2,DU
         1 000527   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 000530   002022 701000 1                  TSX1    CKDATA
         1 000531   001725 702000 1                  TSX2    BAD_DATA

      271    13559    2               VBLK.EVENT = %XSS_SEV_SACDRSP;

  13559  1 000532   000102 236007                    LDQ     66,DL
         1 000533   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 000534   001641 710000 1                  TRA     s:13750

      272    13560    2           CASE( %XSS_FNC_SCONREQ#);

      273    13561                    /* XSS$CONNECT.SCID need not be validated */
      274    13562    2               CALL CKCOMMON( XSS$CONNECT.COMMON$) ALTRET( BAD_COMMON);

  13562  1 000535   200025 236100                    LDQ     SFPT$,,AUTO
         1 000536   000005 036003                    ADLQ    5,DU
         1 000537   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 000540   002145 701000 1                  TSX1    CKCOMMON
         1 000541   001721 702000 1                  TSX2    BAD_COMMON

      275    13563    2               CALL CKADDR( XSS$CONNECT.CALLING$, XSS_E$CALLING) ALTRET( BAD_ADDR);

  13563  1 000542   000011 236000 2                  LDQ     9
         1 000543   200032 756100                    STQ     TOKENS+1,,AUTO
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:47   
         1 000544   200025 236100                    LDQ     SFPT$,,AUTO
         1 000545   000006 036003                    ADLQ    6,DU
         1 000546   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 000547   001761 701000 1                  TSX1    CKADDR
         1 000550   001760 702000 1                  TSX2    BAD_ADDR

      276    13564    2               IF XSS$CONNECT.CALLING$ = ADDR( NIL) THEN

  13564  1 000551   200025 470500                    LDP0    SFPT$,,AUTO
         1 000552   000006 236100                    LDQ     6,,PR0
         1 000553   000007 116000 2                  CMPQ    7
         1 000554   000570 601000 1                  TNZ     s:13567

      277    13565    2                   CALL XSS$BUFPTR( SCTX.SRCX, XSS$CONNECT.CALLING$);

  13565  1 000555   200025 236100                    LDQ     SFPT$,,AUTO
         1 000556   000006 036003                    ADLQ    6,DU
         1 000557   200037 756100                    STQ     LOWER+2,,AUTO
         1 000560   200021 236100                    LDQ     CTX$,,AUTO
         1 000561   000003 036003                    ADLQ    3,DU
         1 000562   200036 756100                    STQ     LOWER+1,,AUTO
         1 000563   200036 630500                    EPPR0   LOWER+1,,AUTO
         1 000564   000002 631400 2                  EPPR1   2
         1 000565   000000 701000 xent               TSX1    XSS$BUFPTR
         1 000566   000000 011000                    NOP     0
         1 000567   000607 710000 1                  TRA     s:13570

      278    13566    3               ELSE DO;

      279    13567    3                   CALL XSS$BUFPTR( SCTX.SRCX, PTR$);

  13567  1 000570   200023 631500                    EPPR1   PTR$,,AUTO
         1 000571   200037 451500                    STP1    LOWER+2,,AUTO
         1 000572   200021 236100                    LDQ     CTX$,,AUTO
         1 000573   000003 036003                    ADLQ    3,DU
         1 000574   200036 756100                    STQ     LOWER+1,,AUTO
         1 000575   200036 630500                    EPPR0   LOWER+1,,AUTO
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:48   
         1 000576   000002 631400 2                  EPPR1   2
         1 000577   000000 701000 xent               TSX1    XSS$BUFPTR
         1 000600   000000 011000                    NOP     0

      280    13568    3                   PTR$->XSC$ADDRESS = XSS$CONNECT.CALLING$->XSC$ADDRESS;

  13568  1 000601   200025 470500                    LDP0    SFPT$,,AUTO
         1 000602   000006 471500                    LDP1    6,,PR0
         1 000603   200023 473500                    LDP3    PTR$,,AUTO
         1 000604   000100 100500                    MLR     fill='000'O
         1 000605   100000 000456                    ADSC9   0,,PR1                   cn=0,n=302
         1 000606   300000 000456                    ADSC9   0,,PR3                   cn=0,n=302

      281    13569    3                   END;

      282    13570    2               CALL CKADDR( XSS$CONNECT.CALLED$, XSS_E$CALLED) ALTRET( BAD_ADDR);

  13570  1 000607   000012 236000 2                  LDQ     10
         1 000610   200032 756100                    STQ     TOKENS+1,,AUTO
         1 000611   200025 236100                    LDQ     SFPT$,,AUTO
         1 000612   000007 036003                    ADLQ    7,DU
         1 000613   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 000614   001761 701000 1                  TSX1    CKADDR
         1 000615   001760 702000 1                  TSX2    BAD_ADDR

      283    13571    2               IF XSS$CONNECT.CALLED$ = ADDR( NIL) THEN

  13571  1 000616   200025 470500                    LDP0    SFPT$,,AUTO
         1 000617   000007 236100                    LDQ     7,,PR0
         1 000620   000007 116000 2                  CMPQ    7
         1 000621   000635 601000 1                  TNZ     s:13574

      284    13572    2                   CALL XSS$BUFPTR( SCTX.DSTX, XSS$CONNECT.CALLED$);

  13572  1 000622   200025 236100                    LDQ     SFPT$,,AUTO
         1 000623   000007 036003                    ADLQ    7,DU
         1 000624   200037 756100                    STQ     LOWER+2,,AUTO
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:49   
         1 000625   200021 236100                    LDQ     CTX$,,AUTO
         1 000626   000013 036000 2                  ADLQ    11
         1 000627   200036 756100                    STQ     LOWER+1,,AUTO
         1 000630   200036 630500                    EPPR0   LOWER+1,,AUTO
         1 000631   000002 631400 2                  EPPR1   2
         1 000632   000000 701000 xent               TSX1    XSS$BUFPTR
         1 000633   000000 011000                    NOP     0
         1 000634   000654 710000 1                  TRA     s:13577

      285    13573    3               ELSE DO;

      286    13574    3                   CALL XSS$BUFPTR( SCTX.DSTX, PTR$);

  13574  1 000635   200023 631500                    EPPR1   PTR$,,AUTO
         1 000636   200037 451500                    STP1    LOWER+2,,AUTO
         1 000637   200021 236100                    LDQ     CTX$,,AUTO
         1 000640   000013 036000 2                  ADLQ    11
         1 000641   200036 756100                    STQ     LOWER+1,,AUTO
         1 000642   200036 630500                    EPPR0   LOWER+1,,AUTO
         1 000643   000002 631400 2                  EPPR1   2
         1 000644   000000 701000 xent               TSX1    XSS$BUFPTR
         1 000645   000000 011000                    NOP     0

      287    13575    3                   PTR$->XSC$ADDRESS = XSS$CONNECT.CALLED$->XSC$ADDRESS;

  13575  1 000646   200025 470500                    LDP0    SFPT$,,AUTO
         1 000647   000007 471500                    LDP1    7,,PR0
         1 000650   200023 473500                    LDP3    PTR$,,AUTO
         1 000651   000100 100500                    MLR     fill='000'O
         1 000652   100000 000456                    ADSC9   0,,PR1                   cn=0,n=302
         1 000653   300000 000456                    ADSC9   0,,PR3                   cn=0,n=302

      288    13576    3                   END;

      289    13577    2               XSS$CONNECT.RESULT = %XSS_RSLT_SUCCESS#;

  13577  1 000654   200025 470500                    LDP0    SFPT$,,AUTO
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:50   
         1 000655   000000 236003                    LDQ     0,DU
         1 000656   000010 552120                    STBQ    8,'20'O,PR0

      290    13578                    /* XSS$CONNECT.RESULT need not be validated */
      291    13579                    /* XSS$CONNECT.QOS need not be validated */
      292    13580    2               CALL CKSFU ALTRET( BAD_VIBES);

  13580  1 000657   002211 701000 1                  TSX1    CKSFU
         1 000660   001760 702000 1                  TSX2    BAD_ADDR

      293    13581    2               IF XSS$CONNECT.SERNUM ~= 0 THEN

  13581  1 000661   200025 470500                    LDP0    SFPT$,,AUTO
         1 000662   000004 235100                    LDA     4,,PR0
         1 000663   000671 600000 1                  TZE     s:13583

      294    13582    2                   CALL CKSN( XSS$CONNECT.SERNUM) ALTRET( BAD_SN);

  13582  1 000664   200025 236100                    LDQ     SFPT$,,AUTO
         1 000665   000004 036003                    ADLQ    4,DU
         1 000666   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 000667   002053 701000 1                  TSX1    CKSN
         1 000670   001744 702000 1                  TSX2    BAD_SN

      295    13583    2               CALL CKITOKENS ALTRET( BAD_ITOKENS);

  13583  1 000671   002312 701000 1                  TSX1    CKITOKENS
         1 000672   001731 702000 1                  TSX2    BAD_ITOKENS

      296    13584    2               CALL CKDATA( XSS$CONNECT.DATA, 512) ALTRET( BAD_DATA);

  13584  1 000673   000007 236000 2                  LDQ     7
         1 000674   000010 235000 2                  LDA     8
         1 000675   200032 757100                    STAQ    TOKENS+1,,AUTO
         1 000676   200025 236100                    LDQ     SFPT$,,AUTO
         1 000677   000002 036003                    ADLQ    2,DU
         1 000700   200031 756100                    STQ     MAXSZ+3,,AUTO
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:51   
         1 000701   002022 701000 1                  TSX1    CKDATA
         1 000702   001725 702000 1                  TSX2    BAD_DATA

      297    13585    3               IF XSS$CONNECT.DATA.SIZE > 0 THEN DO;

  13585  1 000703   200025 470500                    LDP0    SFPT$,,AUTO
         1 000704   000003 235100                    LDA     3,,PR0
         1 000705   000740 604400 1                  TMOZ    s:13595

      298    13586    3                   LEN = XSS$CONNECT.DATA.SIZE;

  13586  1 000706   200022 755100                    STA     LEN,,AUTO

      299    13587    3                   CALL XSS$GETMEM( BLKX, PTR$, LEN)

  13587  1 000707   200022 631500                    EPPR1   LEN,,AUTO
         1 000710   200040 451500                    STP1    LOWER+3,,AUTO
         1 000711   200023 633500                    EPPR3   PTR$,,AUTO
         1 000712   200037 453500                    STP3    LOWER+2,,AUTO
         1 000713   200020 634500                    EPPR4   BLKX,,AUTO
         1 000714   200036 454500                    STP4    LOWER+1,,AUTO
         1 000715   200036 630500                    EPPR0   LOWER+1,,AUTO
         1 000716   000014 631400 2                  EPPR1   12
         1 000717   000000 701000 xent               TSX1    XSS$GETMEM
         1 000720   000722 702000 1                  TSX2    s:13589
         1 000721   000726 710000 1                  TRA     s:13592

      300    13588    4                   WHENALTRETURN DO;

      301    13589    4                       XSS$GENERIC.ERROR = XSS_E$NODYNMEM;

  13589  1 000722   000000 236000 xsym               LDQ     XSS_E$NODYNMEM
         1 000723   200025 470500                    LDP0    SFPT$,,AUTO
         1 000724   000001 756100                    STQ     1,,PR0

      302    13590    4                       GOTO BAD_VIBES;

PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:52   
  13590  1 000725   001760 710000 1                  TRA     BAD_ADDR

      303    13591    4                       END;
      304    13592    3                   PTR$->LENBYTES = XSS$CONNECT.DATA.PTR$->LENBYTES;

  13592  1 000726   200025 470500                    LDP0    SFPT$,,AUTO
         1 000727   000002 471500                    LDP1    2,,PR0
         1 000730   200022 720100                    LXL0    LEN,,AUTO
         1 000731   200023 473500                    LDP3    PTR$,,AUTO
         1 000732   040140 100540                    MLR     fill='040'O
         1 000733   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         1 000734   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0

      305    13593    3                   SCTX.HEADX = BLKX;

  13593  1 000735   200020 220100                    LDX0    BLKX,,AUTO
         1 000736   200021 470500                    LDP0    CTX$,,AUTO
         1 000737   000031 740100                    STX0    25,,PR0

      306    13594    3                   END;

      307    13595    2               VBLK.EVENT = %XSS_SEV_SCONREQ;

  13595  1 000740   000126 236007                    LDQ     86,DL
         1 000741   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 000742   001641 710000 1                  TRA     s:13750

      308    13596    2           CASE( %XSS_FNC_SCONRSP#);

      309    13597                    /* XSS$CONNECT.SCID need not be validated */
      310    13598    2               CALL CKCOMMON( XSS$CONNECT.COMMON$) ALTRET( BAD_COMMON);

  13598  1 000743   200025 236100                    LDQ     SFPT$,,AUTO
         1 000744   000005 036003                    ADLQ    5,DU
         1 000745   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 000746   002145 701000 1                  TSX1    CKCOMMON
         1 000747   001721 702000 1                  TSX2    BAD_COMMON
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:53   

      311    13599    2               CALL CKADDR( XSS$CONNECT.CALLING$, XSS_E$CALLING)

  13599  1 000750   000011 236000 2                  LDQ     9
         1 000751   200032 756100                    STQ     TOKENS+1,,AUTO
         1 000752   200025 236100                    LDQ     SFPT$,,AUTO
         1 000753   000006 036003                    ADLQ    6,DU
         1 000754   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 000755   001761 701000 1                  TSX1    CKADDR
         1 000756   001760 702000 1                  TSX2    BAD_ADDR

      312    13600    2                       ALTRET( BAD_ADDR);
      313    13601    2               IF XSS$CONNECT.CALLING$ = ADDR( NIL) THEN

  13601  1 000757   200025 470500                    LDP0    SFPT$,,AUTO
         1 000760   000006 236100                    LDQ     6,,PR0
         1 000761   000007 116000 2                  CMPQ    7
         1 000762   000776 601000 1                  TNZ     s:13604

      314    13602    2                   CALL XSS$BUFPTR( SCTX.SRCX, XSS$CONNECT.CALLING$);

  13602  1 000763   200025 236100                    LDQ     SFPT$,,AUTO
         1 000764   000006 036003                    ADLQ    6,DU
         1 000765   200037 756100                    STQ     LOWER+2,,AUTO
         1 000766   200021 236100                    LDQ     CTX$,,AUTO
         1 000767   000003 036003                    ADLQ    3,DU
         1 000770   200036 756100                    STQ     LOWER+1,,AUTO
         1 000771   200036 630500                    EPPR0   LOWER+1,,AUTO
         1 000772   000002 631400 2                  EPPR1   2
         1 000773   000000 701000 xent               TSX1    XSS$BUFPTR
         1 000774   000000 011000                    NOP     0
         1 000775   001015 710000 1                  TRA     s:13607

      315    13603    3               ELSE DO;

      316    13604    3                   CALL XSS$BUFPTR( SCTX.SRCX, PTR$);

PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:54   
  13604  1 000776   200023 631500                    EPPR1   PTR$,,AUTO
         1 000777   200037 451500                    STP1    LOWER+2,,AUTO
         1 001000   200021 236100                    LDQ     CTX$,,AUTO
         1 001001   000003 036003                    ADLQ    3,DU
         1 001002   200036 756100                    STQ     LOWER+1,,AUTO
         1 001003   200036 630500                    EPPR0   LOWER+1,,AUTO
         1 001004   000002 631400 2                  EPPR1   2
         1 001005   000000 701000 xent               TSX1    XSS$BUFPTR
         1 001006   000000 011000                    NOP     0

      317    13605    3                   PTR$->XSC$ADDRESS = XSS$CONNECT.CALLING$->XSC$ADDRESS;

  13605  1 001007   200025 470500                    LDP0    SFPT$,,AUTO
         1 001010   000006 471500                    LDP1    6,,PR0
         1 001011   200023 473500                    LDP3    PTR$,,AUTO
         1 001012   000100 100500                    MLR     fill='000'O
         1 001013   100000 000456                    ADSC9   0,,PR1                   cn=0,n=302
         1 001014   300000 000456                    ADSC9   0,,PR3                   cn=0,n=302

      318    13606    3                   END;

      319    13607    2               CALL CKADDR( XSS$CONNECT.RESPONDING$, XSS_E$RESPONDING)

  13607  1 001015   000015 236000 2                  LDQ     13
         1 001016   200032 756100                    STQ     TOKENS+1,,AUTO
         1 001017   200025 236100                    LDQ     SFPT$,,AUTO
         1 001020   000007 036003                    ADLQ    7,DU
         1 001021   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001022   001761 701000 1                  TSX1    CKADDR
         1 001023   001760 702000 1                  TSX2    BAD_ADDR

      320    13608    2                       ALTRET( BAD_ADDR);
      321    13609    2               IF XSS$CONNECT.RESPONDING$ = ADDR( NIL) THEN

  13609  1 001024   200025 470500                    LDP0    SFPT$,,AUTO
         1 001025   000007 236100                    LDQ     7,,PR0
         1 001026   000007 116000 2                  CMPQ    7
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:55   
         1 001027   001043 601000 1                  TNZ     s:13612

      322    13610    2                   CALL XSS$BUFPTR( SCTX.DSTX, XSS$CONNECT.RESPONDING$);

  13610  1 001030   200025 236100                    LDQ     SFPT$,,AUTO
         1 001031   000007 036003                    ADLQ    7,DU
         1 001032   200037 756100                    STQ     LOWER+2,,AUTO
         1 001033   200021 236100                    LDQ     CTX$,,AUTO
         1 001034   000013 036000 2                  ADLQ    11
         1 001035   200036 756100                    STQ     LOWER+1,,AUTO
         1 001036   200036 630500                    EPPR0   LOWER+1,,AUTO
         1 001037   000002 631400 2                  EPPR1   2
         1 001040   000000 701000 xent               TSX1    XSS$BUFPTR
         1 001041   000000 011000                    NOP     0
         1 001042   001062 710000 1                  TRA     s:13615

      323    13611    3               ELSE DO;

      324    13612    3                   CALL XSS$BUFPTR( SCTX.DSTX, PTR$);

  13612  1 001043   200023 631500                    EPPR1   PTR$,,AUTO
         1 001044   200037 451500                    STP1    LOWER+2,,AUTO
         1 001045   200021 236100                    LDQ     CTX$,,AUTO
         1 001046   000013 036000 2                  ADLQ    11
         1 001047   200036 756100                    STQ     LOWER+1,,AUTO
         1 001050   200036 630500                    EPPR0   LOWER+1,,AUTO
         1 001051   000002 631400 2                  EPPR1   2
         1 001052   000000 701000 xent               TSX1    XSS$BUFPTR
         1 001053   000000 011000                    NOP     0

      325    13613    3                   PTR$->XSC$ADDRESS = XSS$CONNECT.RESPONDING$->XSC$ADDRESS;

  13613  1 001054   200025 470500                    LDP0    SFPT$,,AUTO
         1 001055   000007 471500                    LDP1    7,,PR0
         1 001056   200023 473500                    LDP3    PTR$,,AUTO
         1 001057   000100 100500                    MLR     fill='000'O
         1 001060   100000 000456                    ADSC9   0,,PR1                   cn=0,n=302
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:56   
         1 001061   300000 000456                    ADSC9   0,,PR3                   cn=0,n=302

      326    13614    3                   END;

      327    13615    3               IF XSS$CONNECT.RESULT ~= %XSS_RSLT_SUCCESS# THEN DO;

  13615  1 001062   200025 470500                    LDP0    SFPT$,,AUTO
         1 001063   000010 236100                    LDQ     8,,PR0
         1 001064   000777 316003                    CANQ    511,DU
         1 001065   001112 600000 1                  TZE     s:13624

      328    13616    3                   CALL CKRC( XSS$CONNECT.REASON) ALTRET( BAD_RC);

  13616  1 001066   200025 236100                    LDQ     SFPT$,,AUTO
         1 001067   400000 036007                    ADLQ    -131072,DL
         1 001070   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001071   002123 701000 1                  TSX1    CKRC
         1 001072   001735 702000 1                  TSX2    BAD_RC

      329    13617    3                   VBLK.RF_RSN = XSS$CONNECT.REASON;

  13617  1 001073   200025 470500                    LDP0    SFPT$,,AUTO
         1 001074   000000 236100                    LDQ     0,,PR0
         1 001075   000022 736000                    QLS     18
         1 001076   200011 552140                    STBQ    VBLK+1,'40'O,AUTO

      330    13618                        /* Event is connect response (negative) */
      331    13619    3                   CALL CKDATA( XSS$CONNECT.DATA, 512) ALTRET( BAD_DATA);

  13619  1 001077   000007 236000 2                  LDQ     7
         1 001100   000010 235000 2                  LDA     8
         1 001101   200032 757100                    STAQ    TOKENS+1,,AUTO
         1 001102   200025 236100                    LDQ     SFPT$,,AUTO
         1 001103   000002 036003                    ADLQ    2,DU
         1 001104   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001105   002022 701000 1                  TSX1    CKDATA
         1 001106   001725 702000 1                  TSX2    BAD_DATA
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:57   

      332    13620    3                   VBLK.EVENT = %XSS_SEV_SCONRSN;

  13620  1 001107   000132 236007                    LDQ     90,DL
         1 001110   200011 552104                    STBQ    VBLK+1,'04'O,AUTO

      333    13621    3                   END;

  13621  1 001111   001124 710000 1                  TRA     s:13628

      334    13622    3               ELSE DO;

      335    13623                        /* Event is connect response (positive) */
      336    13624    3                   CALL CKDATA( XSS$CONNECT.DATA, 512) ALTRET( BAD_DATA);

  13624  1 001112   000007 236000 2                  LDQ     7
         1 001113   000010 235000 2                  LDA     8
         1 001114   200032 757100                    STAQ    TOKENS+1,,AUTO
         1 001115   200025 236100                    LDQ     SFPT$,,AUTO
         1 001116   000002 036003                    ADLQ    2,DU
         1 001117   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001120   002022 701000 1                  TSX1    CKDATA
         1 001121   001725 702000 1                  TSX2    BAD_DATA

      337    13625    3                   VBLK.EVENT = %XSS_SEV_SCONRSP;

  13625  1 001122   000130 236007                    LDQ     88,DL
         1 001123   200011 552104                    STBQ    VBLK+1,'04'O,AUTO

      338    13626    3                   END;

      339    13627                    /* XSS$CONNECT.QOS need not be validated */
      340    13628    2               CALL CKSFU ALTRET( BAD_VIBES);

  13628  1 001124   002211 701000 1                  TSX1    CKSFU
         1 001125   001760 702000 1                  TSX2    BAD_ADDR

PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:58   
      341    13629    2               IF XSS$CONNECT.SERNUM ~= 0 THEN

  13629  1 001126   200025 470500                    LDP0    SFPT$,,AUTO
         1 001127   000004 235100                    LDA     4,,PR0
         1 001130   001136 600000 1                  TZE     s:13631

      342    13630    2                   CALL CKSN( XSS$CONNECT.SERNUM) ALTRET( BAD_SN);

  13630  1 001131   200025 236100                    LDQ     SFPT$,,AUTO
         1 001132   000004 036003                    ADLQ    4,DU
         1 001133   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001134   002053 701000 1                  TSX1    CKSN
         1 001135   001744 702000 1                  TSX2    BAD_SN

      343    13631    2               CALL CKITOKENS ALTRET( BAD_ITOKENS);

  13631  1 001136   002312 701000 1                  TSX1    CKITOKENS
         1 001137   001731 702000 1                  TSX2    BAD_ITOKENS
         1 001140   001641 710000 1                  TRA     s:13750

      344    13632    2           CASE( %XSS_FNC_SCTGREQ#);

      345    13633    2               XSS$CONTROL_GIVE.TOKENS.TR = %TRUE;

  13633  1 001141   000200 236007                    LDQ     128,DL
         1 001142   100000 256100                    ORSQ    0,,PR1

      346    13634    2               XSS$CONTROL_GIVE.TOKENS.MA = %TRUE;

  13634  1 001143   200025 470500                    LDP0    SFPT$,,AUTO
         1 001144   000040 236007                    LDQ     32,DL
         1 001145   000000 256100                    ORSQ    0,,PR0

      347    13635    2               XSS$CONTROL_GIVE.TOKENS.MI = %TRUE;

  13635  1 001146   200025 470500                    LDP0    SFPT$,,AUTO
         1 001147   000010 236007                    LDQ     8,DL
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:59   
         1 001150   000000 256100                    ORSQ    0,,PR0

      348    13636    2               XSS$CONTROL_GIVE.TOKENS.DK = %TRUE;

  13636  1 001151   200025 470500                    LDP0    SFPT$,,AUTO
         1 001152   000002 236007                    LDQ     2,DL
         1 001153   000000 256100                    ORSQ    0,,PR0

      349    13637    2               VBLK.EVENT = %XSS_SEV_SCTGREQ;

  13637  1 001154   000124 236007                    LDQ     84,DL
         1 001155   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 001156   001641 710000 1                  TRA     s:13750

      350    13638    2           CASE( %XSS_FNC_SDATREQ#);

      351    13639    2               VBLK.EI.BOSSDU = %TRUE;

  13639  1 001157   004000 236007                    LDQ     2048,DL
         1 001160   200011 256100                    ORSQ    VBLK+1,,AUTO

      352    13640    2               CALL CKDATA( XSS$DATA.DATA, 65533, 1) ALTRET( BAD_DATA);

  13640  1 001161   000020 237000 2                  LDAQ    16
         1 001162   200032 757100                    STAQ    TOKENS+1,,AUTO
         1 001163   200025 236100                    LDQ     SFPT$,,AUTO
         1 001164   000002 036003                    ADLQ    2,DU
         1 001165   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001166   002022 701000 1                  TSX1    CKDATA
         1 001167   001725 702000 1                  TSX2    BAD_DATA

      353    13641    2               IF XSS_TRACE > 0 THEN

  13641  1 001170   000000 235000 xsym               LDA     XSS_TRACE
         1 001171   001176 604400 1                  TMOZ    s:13643

      354    13642    2                   CALL XSS$DUMPFPT( XSS$GENERIC);
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:60   

  13642  1 001172   200025 630500                    EPPR0   SFPT$,,AUTO
         1 001173   000000 631400 2                  EPPR1   0
         1 001174   000000 701000 xent               TSX1    XSS$DUMPFPT
         1 001175   000000 011000                    NOP     0

      355    13643    2               LEN = XSS$DATA.DATA.SIZE;

  13643  1 001176   200025 470500                    LDP0    SFPT$,,AUTO
         1 001177   000003 235100                    LDA     3,,PR0
         1 001200   200022 755100                    STA     LEN,,AUTO

      356    13644    2               IF SCTX.FLAGS.VTCA THEN

  13644  1 001201   200021 471500                    LDP1    CTX$,,AUTO
         1 001202   100006 236100                    LDQ     6,,PR1
         1 001203   002000 316007                    CANQ    1024,DL
         1 001204   001211 600000 1                  TZE     s:13647

      357    13645    2                   MAXSZ = SCTX.TSDUMS.RSP;

  13645  1 001205   100014 236100                    LDQ     12,,PR1
         1 001206   777777 376007                    ANQ     -1,DL
         1 001207   200026 756100                    STQ     MAXSZ,,AUTO
         1 001210   001214 710000 1                  TRA     s:13648

      358    13646    2               ELSE
      359    13647    2                   MAXSZ = SCTX.TSDUMS.INI;

  13647  1 001211   100014 236100                    LDQ     12,,PR1
         1 001212   000022 772000                    QRL     18
         1 001213   200026 756100                    STQ     MAXSZ,,AUTO

      360    13648    3               IF MAXSZ > 0 AND LEN > MAXSZ THEN DO;

  13648  1 001214   001275 604400 1                  TMOZ    s:13669
         1 001215   200022 116100                    CMPQ    LEN,,AUTO
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:61   
         1 001216   001275 605000 1                  TPL     s:13669

      361    13649    3                   PTR$ = XSS$DATA.DATA.PTR$;

  13649  1 001217   000002 236100                    LDQ     2,,PR0
         1 001220   200023 756100                    STQ     PTR$,,AUTO

      362    13650    3                   SDATREQ = XSS$DATA;  /* init private copy of user FPT */

  13650  1 001221   000100 100500                    MLR     fill='000'O
         1 001222   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16
         1 001223   200004 000020                    ADSC9   SDATREQ,,AUTO            cn=0,n=16

      363    13651    3                   VBLK.FPT$ = ADDR( SDATREQ);

  13651  1 001224   200004 633500                    EPPR3   SDATREQ,,AUTO
         1 001225   200012 453500                    STP3    VBLK+2,,AUTO

      364    13652    4                   DO WHILE( LEN > MAXSZ);

  13652  1 001226   200022 236100                    LDQ     LEN,,AUTO
         1 001227   200026 116100                    CMPQ    MAXSZ,,AUTO
         1 001230   001272 604400 1                  TMOZ    s:13666

      365    13653                            /* the data has to be sent in chunks */
      366    13654    4                       SDATREQ.DATA.SIZE = MINIMUM( MAXSZ, LEN);

  13654  1 001231   200022 236100                    LDQ     LEN,,AUTO
         1 001232   200026 116100                    CMPQ    MAXSZ,,AUTO
         1 001233   001235 604400 1                  TMOZ    s:13654+4
         1 001234   200026 236100                    LDQ     MAXSZ,,AUTO
         1 001235   200007 756100                    STQ     SDATREQ+3,,AUTO

      367    13655    4                       SDATREQ.DATA.PTR$ = PTR$;

  13655  1 001236   200023 236100                    LDQ     PTR$,,AUTO
         1 001237   200006 756100                    STQ     SDATREQ+2,,AUTO
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:62   

      368    13656    4                       LEN = LEN - MAXSZ;

  13656  1 001240   200022 236100                    LDQ     LEN,,AUTO
         1 001241   200026 136100                    SBLQ    MAXSZ,,AUTO
         1 001242   200022 756100                    STQ     LEN,,AUTO

      369    13657    4                       IF LEN <= 0 THEN

  13657  1 001243   001246 605400 1                  TPNZ    s:13659

      370    13658    4                           VBLK.EI.EOSSDU = %TRUE;  /* last chunk of msg */

  13658  1 001244   002000 236007                    LDQ     1024,DL
         1 001245   200011 256100                    ORSQ    VBLK+1,,AUTO

      371    13659    4                       VBLK.EVENT = %XSS_SEV_SDATREQ;

  13659  1 001246   000134 236007                    LDQ     92,DL
         1 001247   200011 552104                    STBQ    VBLK+1,'04'O,AUTO

      372    13660    4                       CALL XSS$MACHINE( VBLK) ALTRET( ABORT);

  13660  1 001250   200010 630500                    EPPR0   VBLK,,AUTO
         1 001251   200036 450500                    STP0    LOWER+1,,AUTO
         1 001252   200036 630500                    EPPR0   LOWER+1,,AUTO
         1 001253   000000 631400 2                  EPPR1   0
         1 001254   000000 701000 xent               TSX1    XSS$MACHINE
         1 001255   001663 702000 1                  TSX2    ABORT

      373    13661    4                       VBLK.EI.BOSSDU = %FALSE;    /* no longer first chunk */

  13661  1 001256   000022 236000 2                  LDQ     18
         1 001257   200011 356100                    ANSQ    VBLK+1,,AUTO

      374    13662    4                       PTR$ = PINCRC( PTR$, MAXSZ);

PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:63   
  13662  1 001260   200026 236100                    LDQ     MAXSZ,,AUTO
         1 001261   000020 736000                    QLS     16
         1 001262   200023 036100                    ADLQ    PTR$,,AUTO
         1 001263   200023 756100                    STQ     PTR$,,AUTO

      375    13663    4                       IF VBLK.EI.EOSSDU THEN

  13663  1 001264   200011 236100                    LDQ     VBLK+1,,AUTO
         1 001265   002000 316007                    CANQ    1024,DL
         1 001266   001671 601000 1                  TNZ     DONE

      376    13664    4                           GOTO DONE;
      377    13665    4                       END;

  13665  1 001267   200022 236100                    LDQ     LEN,,AUTO
         1 001270   200026 116100                    CMPQ    MAXSZ,,AUTO
         1 001271   001231 605400 1                  TPNZ    s:13654

      378    13666    3                   SDATREQ.DATA.SIZE = LEN;

  13666  1 001272   200007 756100                    STQ     SDATREQ+3,,AUTO

      379    13667    3                   SDATREQ.DATA.PTR$ = PTR$;

  13667  1 001273   200023 236100                    LDQ     PTR$,,AUTO
         1 001274   200006 756100                    STQ     SDATREQ+2,,AUTO

      380    13668    3                   END;

      381    13669    2               VBLK.EVENT = %XSS_SEV_SDATREQ;

  13669  1 001275   000134 236007                    LDQ     92,DL
         1 001276   200011 552104                    STBQ    VBLK+1,'04'O,AUTO

      382    13670    2               VBLK.EI.EOSSDU = %TRUE;  /* last chunk of msg */

  13670  1 001277   002000 236007                    LDQ     1024,DL
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:64   
         1 001300   200011 256100                    ORSQ    VBLK+1,,AUTO
         1 001301   001641 710000 1                  TRA     s:13750

      383    13671    2           CASE( %XSS_FNC_SEXPREQ#);

      384    13672    2               CALL CKDATA( XSS$EXPEDITED_DATA.DATA, 14, 1) ALTRET( BAD_DATA);

  13672  1 001302   000024 237000 2                  LDAQ    20
         1 001303   200032 757100                    STAQ    TOKENS+1,,AUTO
         1 001304   200025 236100                    LDQ     SFPT$,,AUTO
         1 001305   000002 036003                    ADLQ    2,DU
         1 001306   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001307   002022 701000 1                  TSX1    CKDATA
         1 001310   001725 702000 1                  TSX2    BAD_DATA

      385    13673    2               VBLK.EVENT = %XSS_SEV_SEXPREQ;

  13673  1 001311   000136 236007                    LDQ     94,DL
         1 001312   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 001313   001641 710000 1                  TRA     s:13750

      386    13674    2           CASE( %XSS_FNC_SRELREQ#);

      387    13675    2               CALL CKDATA( XSS$RELEASE.DATA, 512) ALTRET( BAD_DATA);

  13675  1 001314   000007 236000 2                  LDQ     7
         1 001315   000010 235000 2                  LDA     8
         1 001316   200032 757100                    STAQ    TOKENS+1,,AUTO
         1 001317   200025 236100                    LDQ     SFPT$,,AUTO
         1 001320   000002 036003                    ADLQ    2,DU
         1 001321   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001322   002022 701000 1                  TSX1    CKDATA
         1 001323   001725 702000 1                  TSX2    BAD_DATA

      388    13676    2               VBLK.EVENT = %XSS_SEV_SRELREQ;

  13676  1 001324   000144 236007                    LDQ     100,DL
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:65   
         1 001325   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 001326   001641 710000 1                  TRA     s:13750

      389    13677    2           CASE( %XSS_FNC_SRELRSP#);

      390    13678                    /*N* validate XSS$RELEASE.RESULT */
      391    13679    2               CALL CKDATA( XSS$RELEASE.DATA, 512) ALTRET( BAD_DATA);

  13679  1 001327   000007 236000 2                  LDQ     7
         1 001330   000010 235000 2                  LDA     8
         1 001331   200032 757100                    STAQ    TOKENS+1,,AUTO
         1 001332   200025 236100                    LDQ     SFPT$,,AUTO
         1 001333   000002 036003                    ADLQ    2,DU
         1 001334   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001335   002022 701000 1                  TSX1    CKDATA
         1 001336   001725 702000 1                  TSX2    BAD_DATA

      392    13680    2               VBLK.EVENT = %XSS_SEV_SRELRSP;

  13680  1 001337   000146 236007                    LDQ     102,DL
         1 001340   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 001341   001641 710000 1                  TRA     s:13750

      393    13681    2           CASE( %XSS_FNC_SRSXREQ#);

      394    13682    3               DO CASE( XSS$RESYNCHRONIZE.TYPE);

  13682  1 001342   100000 236100                    LDQ     0,,PR1
         1 001343   000011 772000                    QRL     9
         1 001344   000777 376007                    ANQ     511,DL
         1 001345   000003 116007                    CMPQ    3,DL
         1 001346   001350 602006 1                  TNC     s:13682+6,QL
         1 001347   001364 710000 1                  TRA     s:13690
         1 001350   001356 710000 1                  TRA     s:13686
         1 001351   001353 710000 1                  TRA     s:13684
         1 001352   001361 710000 1                  TRA     s:13688

PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:66   
      395    13683    3                   CASE( %XSS_RT_ABANDON#);

      396    13684    3                       VBLK.EVENT = %XSS_SEV_SRSAREQ;

  13684  1 001353   000152 236007                    LDQ     106,DL
         1 001354   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 001355   001365 710000 1                  TRA     s:13692

      397    13685    3                   CASE( %XSS_RT_RESTART#);

      398    13686    3                       VBLK.EVENT = %XSS_SEV_SRSRREQ;

  13686  1 001356   000154 236007                    LDQ     108,DL
         1 001357   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 001360   001365 710000 1                  TRA     s:13692

      399    13687    3                   CASE( %XSS_RT_SET#);

      400    13688    3                       VBLK.EVENT = %XSS_SEV_SRSSREQ;

  13688  1 001361   000156 236007                    LDQ     110,DL
         1 001362   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 001363   001365 710000 1                  TRA     s:13692

      401    13689    3                   CASE( ELSE);

      402    13690    3                       GOTO BAD_RT;

  13690  1 001364   001741 710000 1                  TRA     BAD_RT

      403    13691    3                   END;

      404    13692    2               CALL CKSN( XSS$RESYNCHRONIZE.SERNUM) ALTRET( BAD_SN);

  13692  1 001365   200025 236100                    LDQ     SFPT$,,AUTO
         1 001366   000004 036003                    ADLQ    4,DU
         1 001367   200031 756100                    STQ     MAXSZ+3,,AUTO
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:67   
         1 001370   002053 701000 1                  TSX1    CKSN
         1 001371   001744 702000 1                  TSX2    BAD_SN

      405    13693                    /*N* validate XSS$RESYNCHRONIZE.TOKENS */
      406    13694    2               CALL CKDATA( XSS$RESYNCHRONIZE.DATA, 512) ALTRET( BAD_DATA);

  13694  1 001372   000007 236000 2                  LDQ     7
         1 001373   000010 235000 2                  LDA     8
         1 001374   200032 757100                    STAQ    TOKENS+1,,AUTO
         1 001375   200025 236100                    LDQ     SFPT$,,AUTO
         1 001376   000002 036003                    ADLQ    2,DU
         1 001377   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001400   002022 701000 1                  TSX1    CKDATA
         1 001401   001725 702000 1                  TSX2    BAD_DATA
         1 001402   001641 710000 1                  TRA     s:13750

      407    13695    2           CASE( %XSS_FNC_SRSXRSP#);

      408    13696    2               CALL CKSN( XSS$RESYNCHRONIZE.SERNUM) ALTRET( BAD_SN);

  13696  1 001403   200025 236100                    LDQ     SFPT$,,AUTO
         1 001404   000004 036003                    ADLQ    4,DU
         1 001405   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001406   002053 701000 1                  TSX1    CKSN
         1 001407   001744 702000 1                  TSX2    BAD_SN

      409    13697                    /*N* validate XSS$RESYNCHRONIZE.TOKENS */
      410    13698    2               CALL CKDATA( XSS$RESYNCHRONIZE.DATA, 512) ALTRET( BAD_DATA);

  13698  1 001410   000007 236000 2                  LDQ     7
         1 001411   000010 235000 2                  LDA     8
         1 001412   200032 757100                    STAQ    TOKENS+1,,AUTO
         1 001413   200025 236100                    LDQ     SFPT$,,AUTO
         1 001414   000002 036003                    ADLQ    2,DU
         1 001415   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001416   002022 701000 1                  TSX1    CKDATA
         1 001417   001725 702000 1                  TSX2    BAD_DATA
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:68   

      411    13699    2               VBLK.EVENT = %XSS_SEV_SRSXRSP;

  13699  1 001420   000160 236007                    LDQ     112,DL
         1 001421   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 001422   001641 710000 1                  TRA     s:13750

      412    13700    2           CASE( %XSS_FNC_SSMAREQ#);

      413    13701    2               CALL CKSN( XSS$SYNC_MAJOR.SERNUM) ALTRET( BAD_SN);

  13701  1 001423   200025 236100                    LDQ     SFPT$,,AUTO
         1 001424   000004 036003                    ADLQ    4,DU
         1 001425   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001426   002053 701000 1                  TSX1    CKSN
         1 001427   001744 702000 1                  TSX2    BAD_SN

      414    13702    2               CALL CKDATA( XSS$SYNC_MAJOR.DATA, 512) ALTRET( BAD_DATA);

  13702  1 001430   000007 236000 2                  LDQ     7
         1 001431   000010 235000 2                  LDA     8
         1 001432   200032 757100                    STAQ    TOKENS+1,,AUTO
         1 001433   200025 236100                    LDQ     SFPT$,,AUTO
         1 001434   000002 036003                    ADLQ    2,DU
         1 001435   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001436   002022 701000 1                  TSX1    CKDATA
         1 001437   001725 702000 1                  TSX2    BAD_DATA

      415    13703    2               VBLK.EVENT = %XSS_SEV_SSMAREQ;

  13703  1 001440   000162 236007                    LDQ     114,DL
         1 001441   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 001442   001641 710000 1                  TRA     s:13750

      416    13704    2           CASE( %XSS_FNC_SSMARSP#);

      417    13705    2               CALL CKDATA( XSS$SYNC_MAJOR.DATA, 512) ALTRET( BAD_DATA);
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:69   

  13705  1 001443   000007 236000 2                  LDQ     7
         1 001444   000010 235000 2                  LDA     8
         1 001445   200032 757100                    STAQ    TOKENS+1,,AUTO
         1 001446   200025 236100                    LDQ     SFPT$,,AUTO
         1 001447   000002 036003                    ADLQ    2,DU
         1 001450   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001451   002022 701000 1                  TSX1    CKDATA
         1 001452   001725 702000 1                  TSX2    BAD_DATA

      418    13706    2               VBLK.EVENT = %XSS_SEV_SSMARSP;

  13706  1 001453   000164 236007                    LDQ     116,DL
         1 001454   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 001455   001641 710000 1                  TRA     s:13750

      419    13707    2           CASE( %XSS_FNC_SSMIREQ#);

      420    13708                    /*N* validate XSS$SYNC_MINOR.TYPE */
      421    13709    2               CALL CKSN( XSS$SYNC_MINOR.SERNUM) ALTRET( BAD_SN);

  13709  1 001456   200025 236100                    LDQ     SFPT$,,AUTO
         1 001457   000004 036003                    ADLQ    4,DU
         1 001460   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001461   002053 701000 1                  TSX1    CKSN
         1 001462   001744 702000 1                  TSX2    BAD_SN

      422    13710    2               CALL CKDATA( XSS$SYNC_MINOR.DATA, 512) ALTRET( BAD_DATA);

  13710  1 001463   000007 236000 2                  LDQ     7
         1 001464   000010 235000 2                  LDA     8
         1 001465   200032 757100                    STAQ    TOKENS+1,,AUTO
         1 001466   200025 236100                    LDQ     SFPT$,,AUTO
         1 001467   000002 036003                    ADLQ    2,DU
         1 001470   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001471   002022 701000 1                  TSX1    CKDATA
         1 001472   001725 702000 1                  TSX2    BAD_DATA
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:70   

      423    13711    2               VBLK.EVENT = %XSS_SEV_SSMIREQ;

  13711  1 001473   000166 236007                    LDQ     118,DL
         1 001474   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 001475   001641 710000 1                  TRA     s:13750

      424    13712    2           CASE( %XSS_FNC_SSMIRSP#);

      425    13713    2               CALL CKSN( XSS$SYNC_MINOR.SERNUM) ALTRET( BAD_SN);

  13713  1 001476   200025 236100                    LDQ     SFPT$,,AUTO
         1 001477   000004 036003                    ADLQ    4,DU
         1 001500   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001501   002053 701000 1                  TSX1    CKSN
         1 001502   001744 702000 1                  TSX2    BAD_SN

      426    13714    2               CALL CKDATA( XSS$SYNC_MINOR.DATA, 512) ALTRET( BAD_DATA);

  13714  1 001503   000007 236000 2                  LDQ     7
         1 001504   000010 235000 2                  LDA     8
         1 001505   200032 757100                    STAQ    TOKENS+1,,AUTO
         1 001506   200025 236100                    LDQ     SFPT$,,AUTO
         1 001507   000002 036003                    ADLQ    2,DU
         1 001510   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001511   002022 701000 1                  TSX1    CKDATA
         1 001512   001725 702000 1                  TSX2    BAD_DATA

      427    13715    2               VBLK.EVENT = %XSS_SEV_SSMIRSP;

  13715  1 001513   000170 236007                    LDQ     120,DL
         1 001514   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 001515   001641 710000 1                  TRA     s:13750

      428    13716    2           CASE( %XSS_FNC_STKGREQ#);

      429    13717                    /*N* validate XSS$TOKEN_GIVE.TOKENS */
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:71   
      430    13718    2               VBLK.EVENT = %XSS_SEV_STKGREQ;

  13718  1 001516   000140 236007                    LDQ     96,DL
         1 001517   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 001520   001641 710000 1                  TRA     s:13750

      431    13719    2           CASE( %XSS_FNC_STKPREQ#);

      432    13720                    /*N* validate XSS$TOKEN_PLEASE.TOKENS */
      433    13721    2               CALL CKDATA( XSS$TOKEN_PLEASE.DATA, 512) ALTRET( BAD_DATA);

  13721  1 001521   000007 236000 2                  LDQ     7
         1 001522   000010 235000 2                  LDA     8
         1 001523   200032 757100                    STAQ    TOKENS+1,,AUTO
         1 001524   200025 236100                    LDQ     SFPT$,,AUTO
         1 001525   000002 036003                    ADLQ    2,DU
         1 001526   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001527   002022 701000 1                  TSX1    CKDATA
         1 001530   001725 702000 1                  TSX2    BAD_DATA

      434    13722    2               VBLK.EVENT = %XSS_SEV_STKPREQ;

  13722  1 001531   000142 236007                    LDQ     98,DL
         1 001532   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 001533   001641 710000 1                  TRA     s:13750

      435    13723    2           CASE( %XSS_FNC_STYDREQ#);

      436    13724    2               IF SCTX.FLAGS.VTCA THEN

  13724  1 001534   000006 236100                    LDQ     6,,PR0
         1 001535   002000 316007                    CANQ    1024,DL
         1 001536   001543 600000 1                  TZE     s:13727

      437    13725    2                   MAXSZ = SCTX.TSDUMS.RSP;

  13725  1 001537   000014 236100                    LDQ     12,,PR0
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:72   
         1 001540   777777 376007                    ANQ     -1,DL
         1 001541   200026 756100                    STQ     MAXSZ,,AUTO
         1 001542   001546 710000 1                  TRA     s:13728

      438    13726    2               ELSE
      439    13727    2                   MAXSZ = SCTX.TSDUMS.INI;

  13727  1 001543   000014 236100                    LDQ     12,,PR0
         1 001544   000022 772000                    QRL     18
         1 001545   200026 756100                    STQ     MAXSZ,,AUTO

      440    13728    2               IF MAXSZ ~= 0 THEN

  13728  1 001546   001560 600000 1                  TZE     s:13731

      441    13729    2                   CALL CKDATA( XSS$TYPED_DATA.DATA, MAXSZ, 1) ALTRET( BAD_DATA);

  13729  1 001547   000021 236000 2                  LDQ     17
         1 001550   200033 756100                    STQ     I+1,,AUTO
         1 001551   200026 633500                    EPPR3   MAXSZ,,AUTO
         1 001552   200032 453500                    STP3    TOKENS+1,,AUTO
         1 001553   200025 236100                    LDQ     SFPT$,,AUTO
         1 001554   000002 036003                    ADLQ    2,DU
         1 001555   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001556   002022 701000 1                  TSX1    CKDATA
         1 001557   001725 702000 1                  TSX2    BAD_DATA

      442    13730                    /*N* should support longer data items.. like SDATREQ */
      443    13731    2               VBLK.EVENT = %XSS_SEV_STYDREQ;

  13731  1 001560   000172 236007                    LDQ     122,DL
         1 001561   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
         1 001562   001641 710000 1                  TRA     s:13750

      444    13732    2           CASE( %XSS_FNC_SUABREQ#);

      445    13733    2               CALL CKDATA( XSS$U_ABORT.DATA, 9) ALTRET( BAD_DATA);
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:73   

  13733  1 001563   000007 236000 2                  LDQ     7
         1 001564   000027 235000 2                  LDA     23
         1 001565   200032 757100                    STAQ    TOKENS+1,,AUTO
         1 001566   200025 236100                    LDQ     SFPT$,,AUTO
         1 001567   000002 036003                    ADLQ    2,DU
         1 001570   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001571   002022 701000 1                  TSX1    CKDATA
         1 001572   001725 702000 1                  TSX2    BAD_DATA

      446    13734    2               VBLK.EVENT = %XSS_SEV_SUABREQ;

  13734  1 001573   000174 236007                    LDQ     124,DL
         1 001574   200011 552104                    STBQ    VBLK+1,'04'O,AUTO

      447    13735    2               SCTX.TD.USRAB = %TRUE;

  13735  1 001575   200021 470500                    LDP0    CTX$,,AUTO
         1 001576   004000 236007                    LDQ     2048,DL
         1 001577   000015 256100                    ORSQ    13,,PR0
         1 001600   001641 710000 1                  TRA     s:13750

      448    13736    2           CASE( %XSS_FNC_SUERREQ#);

      449    13737    2               CALL CKRC( XSS$U_EXCEPTION_REPORT.REASON) ALTRET( BAD_RC);

  13737  1 001601   200025 236100                    LDQ     SFPT$,,AUTO
         1 001602   400000 036007                    ADLQ    -131072,DL
         1 001603   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001604   002123 701000 1                  TSX1    CKRC
         1 001605   001735 702000 1                  TSX2    BAD_RC

      450    13738    2               IF SCTX.FLAGS.VTCA THEN

  13738  1 001606   200021 470500                    LDP0    CTX$,,AUTO
         1 001607   000006 236100                    LDQ     6,,PR0
         1 001610   002000 316007                    CANQ    1024,DL
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:74   
         1 001611   001616 600000 1                  TZE     s:13741

      451    13739    2                   MAXSZ = SCTX.TSDUMS.RSP;

  13739  1 001612   000014 236100                    LDQ     12,,PR0
         1 001613   777777 376007                    ANQ     -1,DL
         1 001614   200026 756100                    STQ     MAXSZ,,AUTO
         1 001615   001621 710000 1                  TRA     s:13742

      452    13740    2               ELSE
      453    13741    2                   MAXSZ = SCTX.TSDUMS.INI;

  13741  1 001616   000014 236100                    LDQ     12,,PR0
         1 001617   000022 772000                    QRL     18
         1 001620   200026 756100                    STQ     MAXSZ,,AUTO

      454    13742    2               IF MAXSZ ~= 0 THEN

  13742  1 001621   001633 600000 1                  TZE     s:13745

      455    13743    2                   CALL CKDATA( XSS$U_EXCEPTION_REPORT.DATA, MAXSZ) ALTRET( BAD_DATA);

  13743  1 001622   000007 236000 2                  LDQ     7
         1 001623   200033 756100                    STQ     I+1,,AUTO
         1 001624   200026 631500                    EPPR1   MAXSZ,,AUTO
         1 001625   200032 451500                    STP1    TOKENS+1,,AUTO
         1 001626   200025 236100                    LDQ     SFPT$,,AUTO
         1 001627   000002 036003                    ADLQ    2,DU
         1 001630   200031 756100                    STQ     MAXSZ+3,,AUTO
         1 001631   002022 701000 1                  TSX1    CKDATA
         1 001632   001725 702000 1                  TSX2    BAD_DATA

      456    13744                    /*N* should support longer data items.. like SDATREQ */
      457    13745    2               VBLK.EVENT = %XSS_SEV_SUERREQ;

  13745  1 001633   000176 236007                    LDQ     126,DL
         1 001634   200011 552104                    STBQ    VBLK+1,'04'O,AUTO
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:75   
         1 001635   001641 710000 1                  TRA     s:13750

      458    13746    2           CASE( ELSE);

      459    13747    2               XSS$GENERIC.ERROR = XSS_E$BADFNC;

  13747  1 001636   000012 236000 0                  LDQ     XSS_E$BADFNC
         1 001637   100001 756100                    STQ     1,,PR1

      460    13748    2               ALTRETURN;

  13748  1 001640   000000 702200 xent               TSX2  ! X66_AALT

      461    13749    2           END;

      462    13750    1       IF XSS_TRACE > 0 THEN

  13750  1 001641   000000 235000 xsym               LDA     XSS_TRACE
         1 001642   001654 604400 1                  TMOZ    s:13753

      463    13751    1           IF XSS$GENERIC.FNC ~= %XSS_FNC_SDATREQ# THEN

  13751  1 001643   200025 470500                    LDP0    SFPT$,,AUTO
         1 001644   000000 236100                    LDQ     0,,PR0
         1 001645   777000 376003                    ANQ     -512,DU
         1 001646   033000 116003                    CMPQ    13824,DU
         1 001647   001654 600000 1                  TZE     s:13753

      464    13752    1               CALL XSS$DUMPFPT( XSS$GENERIC);

  13752  1 001650   200025 630500                    EPPR0   SFPT$,,AUTO
         1 001651   000000 631400 2                  EPPR1   0
         1 001652   000000 701000 xent               TSX1    XSS$DUMPFPT
         1 001653   000000 011000                    NOP     0

      465    13753    1       CALL XSS$MACHINE( VBLK)

PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:76   
  13753  1 001654   200010 630500                    EPPR0   VBLK,,AUTO
         1 001655   200036 450500                    STP0    LOWER+1,,AUTO
         1 001656   200036 630500                    EPPR0   LOWER+1,,AUTO
         1 001657   000000 631400 2                  EPPR1   0
         1 001660   000000 701000 xent               TSX1    XSS$MACHINE
         1 001661   001663 702000 1                  TSX2    ABORT
         1 001662   001671 710000 1                  TRA     DONE

      466    13754    2       WHENALTRETURN DO;

      467    13755    2   ABORT:
      468    13756    2           IF XSS$GENERIC.ERROR = '0'O THEN

  13756  1 001663   200025 470500       ABORT        LDP0    SFPT$,,AUTO
         1 001664   000001 235100                    LDA     1,,PR0
         1 001665   001670 601000 1                  TNZ     s:13758

      469    13757    2               XSS$GENERIC.ERROR = XSS_E$STATE;

  13757  1 001666   000013 236000 0                  LDQ     XSS_E$STATE
         1 001667   000001 756100                    STQ     1,,PR0

      470    13758    2           ALTRETURN;

  13758  1 001670   000000 702200 xent               TSX2  ! X66_AALT

      471    13759    2           END;
      472    13760    1   DONE:
      473    13761    1       CALL XSS$BUFPTR( CCB$( SFPT.SCID)->XSC$CCB.SFPTX, SFPT$);

  13761  1 001671   200003 470500       DONE         LDP0    @SFPT,,AUTO
         1 001672   000000 220100                    LDX0    0,,PR0
         1 001673   000777 360003                    ANX0    511,DU
         1 001674   000000 471400 xsym               LDP1    XSS_CCB$$
         1 001675   100000 473510                    LDP3    0,X0,PR1
         1 001676   200025 634500                    EPPR4   SFPT$,,AUTO
         1 001677   200037 454500                    STP4    LOWER+2,,AUTO
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:77   
         1 001700   200040 453500                    STP3    LOWER+3,,AUTO
         1 001701   200040 236100                    LDQ     LOWER+3,,AUTO
         1 001702   000030 036000 2                  ADLQ    24
         1 001703   200036 756100                    STQ     LOWER+1,,AUTO
         1 001704   200036 630500                    EPPR0   LOWER+1,,AUTO
         1 001705   000002 631400 2                  EPPR1   2
         1 001706   000000 701000 xent               TSX1    XSS$BUFPTR
         1 001707   000000 011000                    NOP     0

      474    13762    1       IF SFPT$ ~= ADDR( SFPT) THEN

  13762  1 001710   200025 236100                    LDQ     SFPT$,,AUTO
         1 001711   200003 116100                    CMPQ    @SFPT,,AUTO
         1 001712   001720 600000 1                  TZE     s:13764

      475    13763    1           XSS$GENERIC = SFPT;

  13763  1 001713   200003 470500                    LDP0    @SFPT,,AUTO
         1 001714   200025 471500                    LDP1    SFPT$,,AUTO
         1 001715   000100 100500                    MLR     fill='000'O
         1 001716   000000 000070                    ADSC9   0,,PR0                   cn=0,n=56
         1 001717   100000 000070                    ADSC9   0,,PR1                   cn=0,n=56

      476    13764    1       RETURN;

  13764  1 001720   000000 702200 xent               TSX2  ! X66_ARET

      477    13765        %EJECT;
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:78   
      478    13766    1   BAD_COMMON:
      479    13767    1       XSS$GENERIC.ERROR = XSS_E$COMMON;

  13767  1 001721   000020 236000 0     BAD_COMMON   LDQ     XSS_E$COMMON
         1 001722   200025 470500                    LDP0    SFPT$,,AUTO
         1 001723   000001 756100                    STQ     1,,PR0

      480    13768    1       GOTO BAD_VIBES;

  13768  1 001724   001760 710000 1                  TRA     BAD_ADDR

      481    13769    1   BAD_DATA:
      482    13770    1       XSS$GENERIC.ERROR = XSS_E$DATA;

  13770  1 001725   000021 236000 0     BAD_DATA     LDQ     XSS_E$DATA
         1 001726   200025 470500                    LDP0    SFPT$,,AUTO
         1 001727   000001 756100                    STQ     1,,PR0

      483    13771    1       GOTO BAD_VIBES;

  13771  1 001730   001760 710000 1                  TRA     BAD_ADDR

      484    13772    1   BAD_ITOKENS:
      485    13773    1       XSS$GENERIC.ERROR = XSS_E$ITOKENS;

  13773  1 001731   000023 236000 0     BAD_ITOKENS  LDQ     XSS_E$ITOKENS
         1 001732   200025 470500                    LDP0    SFPT$,,AUTO
         1 001733   000001 756100                    STQ     1,,PR0

      486    13774    1       GOTO BAD_VIBES;

  13774  1 001734   001760 710000 1                  TRA     BAD_ADDR

      487    13775    1   BAD_RC:
      488    13776    1       XSS$GENERIC.ERROR = XSS_E$REASON;

  13776  1 001735   000027 236000 0     BAD_RC       LDQ     XSS_E$REASON
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:79   
         1 001736   200025 470500                    LDP0    SFPT$,,AUTO
         1 001737   000001 756100                    STQ     1,,PR0

      489    13777    1       GOTO BAD_VIBES;

  13777  1 001740   001760 710000 1                  TRA     BAD_ADDR

      490    13778    1   BAD_RT:
      491    13779    1       XSS$GENERIC.ERROR = XSS_E$TYPE;

  13779  1 001741   000035 236000 0     BAD_RT       LDQ     XSS_E$TYPE
         1 001742   100001 756100                    STQ     1,,PR1

      492    13780    1       GOTO BAD_VIBES;

  13780  1 001743   001760 710000 1                  TRA     BAD_ADDR

      493    13781    1   BAD_SN:
      494    13782    1       XSS$GENERIC.ERROR = XSS_E$SERNUM;

  13782  1 001744   000032 236000 0     BAD_SN       LDQ     XSS_E$SERNUM
         1 001745   200025 470500                    LDP0    SFPT$,,AUTO
         1 001746   000001 756100                    STQ     1,,PR0

      495    13783    1       GOTO BAD_VIBES;

  13783  1 001747   001760 710000 1                  TRA     BAD_ADDR

      496    13784    1   BAD_AI:
      497    13785    1       XSS$GENERIC.ERROR = XSS_E$ACTID;

  13785  1 001750   000014 236000 0     BAD_AI       LDQ     XSS_E$ACTID
         1 001751   200025 470500                    LDP0    SFPT$,,AUTO
         1 001752   000001 756100                    STQ     1,,PR0

      498    13786    1       GOTO BAD_VIBES;

PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:80   
  13786  1 001753   001760 710000 1                  TRA     BAD_ADDR

      499    13787    1   BAD_OAI:
      500    13788    1       XSS$GENERIC.ERROR = XSS_E$OACTID;

  13788  1 001754   000024 236000 0     BAD_OAI      LDQ     XSS_E$OACTID
         1 001755   200025 470500                    LDP0    SFPT$,,AUTO
         1 001756   000001 756100                    STQ     1,,PR0

      501    13789    1       GOTO BAD_VIBES;

  13789  1 001757   001760 710000 1                  TRA     BAD_ADDR

      502    13790    1   BAD_ADDR:

  13790  1 001760                       BAD_ADDR     null
      503    13791    1       ;
      504    13792    1   BAD_VIBES:
      505    13793            /* altreturn with error code set */
      506    13794    1       ALTRETURN;

  13794  1 001760   000000 702200 xent  BAD_VIBES    TSX2  ! X66_AALT

      507    13795        %EJECT;
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:81   
      508    13796    1   CKADDR: PROC( APTR$, ERR) ALTRET;

  13796  1 001761   200030 741300       CKADDR       STX1  ! MAXSZ+2,,AUTO

      509    13797
      510    13798            %XSC$ADDRESS( STCLASS="BASED( APTR$)");
      511    14081    2       DCL APTR$ PTR;
      512    14082    2       DCL ERR BIT(36);
      513    14083
      514    14084    3       IF APTR$ ~= ADDR( NIL) THEN DO;

  14084  1 001762   200031 470500                    LDP0    @APTR$,,AUTO
         1 001763   000000 236100                    LDQ     0,,PR0
         1 001764   000007 116000 2                  CMPQ    7
         1 001765   002012 600000 1                  TZE     s:14094

      515    14085    3           IF XSC$ADDRESS.PSAP.LEN > 224 THEN

  14085  1 001766   000000 471500                    LDP1    0,,PR0
         1 001767   100000 236100                    LDQ     0,,PR1
         1 001770   777000 376003                    ANQ     -512,DU
         1 001771   341000 116003                    CMPQ    115200,DU
         1 001772   002013 603000 1                  TRC     BAD_ADDR

      516    14086    3               GOTO BAD_ADDR;
      517    14087    3           IF XSC$ADDRESS.SSAP.LEN > 16 THEN

  14087  1 001773   100070 236100                    LDQ     56,,PR1
         1 001774   000777 376003                    ANQ     511,DU
         1 001775   000021 116003                    CMPQ    17,DU
         1 001776   002013 603000 1                  TRC     BAD_ADDR

      518    14088    3               GOTO BAD_ADDR;
      519    14089    3           IF XSC$ADDRESS.TSAP.LEN = 0 OR XSC$ADDRESS.TSAP.LEN > 32 THEN

  14089  1 001777   100075 220100                    LDX0    61,,PR1
         1 002000   002013 600000 1                  TZE     BAD_ADDR
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:82   
         1 002001   000041 100003                    CMPX0   33,DU
         1 002002   002013 603000 1                  TRC     BAD_ADDR

      520    14090    3               GOTO BAD_ADDR;
      521    14091    3           IF XSC$ADDRESS.NSAP.LEN = 0 OR XSC$ADDRESS.NSAP.LEN > 21 THEN

  14091  1 002003   100106 236100                    LDQ     70,,PR1
         1 002004   777000 316003                    CANQ    -512,DU
         1 002005   002013 600000 1                  TZE     BAD_ADDR
         1 002006   100106 236100                    LDQ     70,,PR1
         1 002007   777000 376003                    ANQ     -512,DU
         1 002010   026000 116003                    CMPQ    11264,DU
         1 002011   002013 603000 1                  TRC     BAD_ADDR

      522    14092    3               GOTO BAD_ADDR;
      523    14093    3           END;

      524    14094    2       RETURN;

  14094  1 002012   000001 702211                    TSX2  ! 1,X1

      525    14095    2   BAD_ADDR:
      526    14096    2       XSS$GENERIC.ERROR = ERR;

  14096  1 002013   200032 473500       BAD_ADDR     LDP3    @ERR,,AUTO
         1 002014   200025 474500                    LDP4    SFPT$,,AUTO
         1 002015   003100 060500                    CSL     bolr='003'O
         1 002016   300000 000044                    BDSC    0,,PR3                   by=0,bit=0,n=36
         1 002017   400001 000044                    BDSC    1,,PR4                   by=0,bit=0,n=36

      527    14097    2       ALTRETURN;

  14097  1 002020   200030 221300                    LDX1  ! MAXSZ+2,,AUTO
         1 002021   000000 702211                    TSX2  ! 0,X1

      528    14098
      529    14099    2       END CKADDR;
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:83   
      530    14100
      531    14101    1   CKDATA: PROC( QVEC, UB, LB) ALTRET;

  14101  1 002022   200030 741300       CKDATA       STX1  ! MAXSZ+2,,AUTO

      532    14102
      533    14103            %XSS$QVEC( NAME=QVEC, STCLASS="");
      534    14136
      535    14137    2       DCL UB SBIN;  /* upper bound on size of framed data */
      536    14138    2       DCL UPPER REDEF UB SBIN;
      537    14139    2       DCL LB SBIN;  /* optional lower bound on size of framed data */
      538    14140    2       DCL LEN SBIN;
      539    14141    2       DCL LOWER SBIN;
      540    14142
      541    14143    2       IF QVEC.PTR$ = ADDR( NIL) THEN

  14143  1 002023   200031 470500                    LDP0    @QVEC,,AUTO
         1 002024   000000 236100                    LDQ     0,,PR0
         1 002025   000007 116000 2                  CMPQ    7
         1 002026   002031 601000 1                  TNZ     s:14146

      542    14144    2           LEN = 0;

  14144  1 002027   200034 450100                    STZ     LEN,,AUTO
         1 002030   002033 710000 1                  TRA     s:14147

      543    14145    2       ELSE
      544    14146    2           LEN = QVEC.SIZE;

  14146  1 002031   000001 235100                    LDA     1,,PR0
         1 002032   200034 755100                    STA     LEN,,AUTO

      545    14147    2       IF ADDR( LB) = ADDR( NIL) THEN

  14147  1 002033   200033 236100                    LDQ     @LB,,AUTO
         1 002034   000007 116000 2                  CMPQ    7
         1 002035   002040 601000 1                  TNZ     s:14150
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:84   

      546    14148    2           LOWER = 0;

  14148  1 002036   200035 450100                    STZ     LOWER,,AUTO
         1 002037   002043 710000 1                  TRA     s:14151

      547    14149    2       ELSE
      548    14150    2           LOWER = LB;

  14150  1 002040   200033 471500                    LDP1    @LB,,AUTO
         1 002041   100000 235100                    LDA     0,,PR1
         1 002042   200035 755100                    STA     LOWER,,AUTO

      549    14151    2       IF LEN < LOWER OR LEN > UPPER THEN

  14151  1 002043   200034 236100                    LDQ     LEN,,AUTO
         1 002044   200035 116100                    CMPQ    LOWER,,AUTO
         1 002045   002051 604000 1                  TMI     s:14152
         1 002046   200032 471500                    LDP1    @UB,,AUTO
         1 002047   100000 116100                    CMPQ    0,,PR1
         1 002050   002052 604400 1                  TMOZ    s:14153

      550    14152    2           ALTRETURN;

  14152  1 002051   000000 702211                    TSX2  ! 0,X1

      551    14153    2       RETURN;

  14153  1 002052   000001 702211                    TSX2  ! 1,X1

      552    14154
      553    14155    2       END CKDATA;
      554    14156        %EJECT;
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:85   
      555    14157    1   CKSN: PROC( VAL) ALTRET;

  14157  1 002053   200030 741300       CKSN         STX1  ! MAXSZ+2,,AUTO

      556    14158
      557    14159    2       DCL VAL UBIN WORD;
      558    14160
      559    14161    2       IF VAL = 0 OR VAL > 999999 THEN

  14161  1 002054   200031 470500                    LDP0    @VAL,,AUTO
         1 002055   000000 235100                    LDA     0,,PR0
         1 002056   002061 600000 1                  TZE     s:14162
         1 002057   000031 115000 2                  CMPA    25
         1 002060   002062 602000 1                  TNC     s:14163

      560    14162    2           ALTRETURN;

  14162  1 002061   000000 702211                    TSX2  ! 0,X1

      561    14163    2       RETURN;

  14163  1 002062   000001 702211                    TSX2  ! 1,X1

      562    14164
      563    14165    2       END CKSN;
      564    14166
      565    14167    1   CKAI: PROC( TXTC) ALTRET;

  14167  1 002063   200030 741300       CKAI         STX1  ! MAXSZ+2,,AUTO

      566    14168
      567    14169    2       DCL 1 TXTC,
      568    14170    2            2 LEN UBIN BYTE UNAL,
      569    14171    2            2 TXT(0:5) CHAR(1) UNAL;
      570    14172    2       DCL I SBIN;
      571    14173
      572    14174    2       IF TXTC.LEN > 6 THEN
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:86   

  14174  1 002064   200031 470500                    LDP0    @TXTC,,AUTO
         1 002065   000100 101500                    MRL     fill='000'O
         1 002066   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 002067   200036 000004                    ADSC9   LOWER+1,,AUTO            cn=0,n=4
         1 002070   200036 236100                    LDQ     LOWER+1,,AUTO
         1 002071   000007 116007                    CMPQ    7,DL
         1 002072   002074 604000 1                  TMI     s:14176

      573    14175    2           ALTRETURN;

  14175  1 002073   000000 702211                    TSX2  ! 0,X1

      574    14176    2       IF TXTC.LEN > 0 THEN

  14176  1 002074   000100 101500                    MRL     fill='000'O
         1 002075   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 002076   200036 000004                    ADSC9   LOWER+1,,AUTO            cn=0,n=4
         1 002077   200036 236100                    LDQ     LOWER+1,,AUTO
         1 002100   000000 116003                    CMPQ    0,DU
         1 002101   002121 600000 1                  TZE     s:14181

      575    14177    3           DO I = 0 TO 5;

  14177  1 002102   200032 450100                    STZ     I,,AUTO

      576    14178    3               IF ASCBIN( TXTC.TXT( I)) > 255 THEN

  14178  1 002103   200031 470500                    LDP0    @TXTC,,AUTO
         1 002104   200032 235100                    LDA     I,,AUTO
         1 002105   000100 101505                    MRL     fill='000'O
         1 002106   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1
         1 002107   200036 000004                    ADSC9   LOWER+1,,AUTO            cn=0,n=4
         1 002110   200036 236100                    LDQ     LOWER+1,,AUTO
         1 002111   000400 116007                    CMPQ    256,DL
         1 002112   002115 602000 1                  TNC     s:14180

PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:87   
      577    14179    3                   ALTRETURN;

  14179  1 002113   200030 221300                    LDX1  ! MAXSZ+2,,AUTO
         1 002114   000000 702211                    TSX2  ! 0,X1

      578    14180    3               END;

  14180  1 002115   200032 054100                    AOS     I,,AUTO
         1 002116   200032 235100                    LDA     I,,AUTO
         1 002117   000005 115007                    CMPA    5,DL
         1 002120   002103 604400 1                  TMOZ    s:14178

      579    14181    2       RETURN;

  14181  1 002121   200030 221300                    LDX1  ! MAXSZ+2,,AUTO
         1 002122   000001 702211                    TSX2  ! 1,X1

      580    14182
      581    14183    2       END CKAI;
      582    14184
      583    14185    1   CKRC: PROC( RC) ALTRET;

  14185  1 002123   200030 741300       CKRC         STX1  ! MAXSZ+2,,AUTO

      584    14186
      585    14187    2       DCL RC UBIN BYTE CALIGNED;
      586    14188
      587    14189    3       DO SELECT( RC);

  14189  1 002124   200031 470500                    LDP0    @RC,,AUTO
         1 002125   000100 101500                    MRL     fill='000'O
         1 002126   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 002127   200036 000004                    ADSC9   LOWER+1,,AUTO            cn=0,n=4
         1 002130   200036 236100                    LDQ     LOWER+1,,AUTO
         1 002131   000001 116007                    CMPQ    1,DL
         1 002132   002144 602000 1                  TNC     s:14194
         1 002133   002143 600000 1                  TZE     s:14192
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:88   
         1 002134   000100 101500                    MRL     fill='000'O
         1 002135   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 002136   200037 000004                    ADSC9   LOWER+2,,AUTO            cn=0,n=4
         1 002137   200037 236100                    LDQ     LOWER+2,,AUTO
         1 002140   000002 116007                    CMPQ    2,DL
         1 002141   002144 601000 1                  TNZ     s:14194
         1 002142   002143 710000 1                  TRA     s:14192

      588    14190    3           SELECT( %XSS_RC_ABILITY#,

      589    14191    3                   %XSS_RC_REJECTED#);
      590    14192    3               RETURN;

  14192  1 002143   000001 702211                    TSX2  ! 1,X1

      591    14193    3           END;

      592    14194    2       ALTRETURN;

  14194  1 002144   000000 702211                    TSX2  ! 0,X1

      593    14195
      594    14196    2       END CKRC;
      595    14197        %EJECT;
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:89   
      596    14198    1   CKCOMMON: PROC( TXTC$) ALTRET;

  14198  1 002145   200030 741300       CKCOMMON     STX1  ! MAXSZ+2,,AUTO

      597    14199
      598    14200    2       DCL TXTC$ PTR;
      599    14201    2       DCL 1 TXTC BASED( TXTC$),
      600    14202    2            2 LEN UBIN(9) CALIGNED,
      601    14203    2            2 TXT CHAR( TXTC.LEN) CALIGNED;
      602    14204
      603    14205    2       IF TXTC$ = ADDR( NIL) THEN

  14205  1 002146   200031 470500                    LDP0    @TXTC$,,AUTO
         1 002147   000000 236100                    LDQ     0,,PR0
         1 002150   000007 116000 2                  CMPQ    7
         1 002151   002155 601000 1                  TNZ     s:14208

      604    14206    2           TXTC$ = ADDR( NO_COMMON);

  14206  1 002152   000032 236000 2                  LDQ     26
         1 002153   000000 756100                    STQ     0,,PR0
         1 002154   002207 710000 1                  TRA     s:14214

      605    14207    3       ELSE DO;

      606    14208    3           LEN = 1 + TXTC.LEN;

  14208  1 002155   000000 471500                    LDP1    0,,PR0
         1 002156   000100 101500                    MRL     fill='000'O
         1 002157   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         1 002160   200036 000004                    ADSC9   LOWER+1,,AUTO            cn=0,n=4
         1 002161   200036 236100                    LDQ     LOWER+1,,AUTO
         1 002162   000001 036007                    ADLQ    1,DL
         1 002163   200022 756100                    STQ     LEN,,AUTO

      607    14209    3           IF LEN > 65 THEN

PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:90   
  14209  1 002164   000101 116007                    CMPQ    65,DL
         1 002165   002167 604400 1                  TMOZ    s:14211

      608    14210    3               ALTRETURN;

  14210  1 002166   000000 702211                    TSX2  ! 0,X1

      609    14211    3           CALL XSS$BUFPTR( SCTX.COMX, PTR$);

  14211  1 002167   200023 631500                    EPPR1   PTR$,,AUTO
         1 002170   200037 451500                    STP1    LOWER+2,,AUTO
         1 002171   200021 236100                    LDQ     CTX$,,AUTO
         1 002172   000004 036003                    ADLQ    4,DU
         1 002173   200036 756100                    STQ     LOWER+1,,AUTO
         1 002174   200036 630500                    EPPR0   LOWER+1,,AUTO
         1 002175   000002 631400 2                  EPPR1   2
         1 002176   000000 701000 xent               TSX1    XSS$BUFPTR
         1 002177   000000 011000                    NOP     0

      610    14212    3           PTR$->LENBYTES = TXTC$->LENBYTES;

  14212  1 002200   200031 470500                    LDP0    @TXTC$,,AUTO
         1 002201   000000 471500                    LDP1    0,,PR0
         1 002202   200022 720100                    LXL0    LEN,,AUTO
         1 002203   200023 473500                    LDP3    PTR$,,AUTO
         1 002204   040140 100540                    MLR     fill='040'O
         1 002205   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         1 002206   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0

      611    14213    3           END;

      612    14214    2       RETURN;

  14214  1 002207   200030 221300                    LDX1  ! MAXSZ+2,,AUTO
         1 002210   000001 702211                    TSX2  ! 1,X1

      613    14215
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:91   
      614    14216    2       END CKCOMMON;
      615    14217        %EJECT;
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:92   
      616    14218    1   CKSFU: PROC ALTRET;

  14218  1 002211   200030 741300       CKSFU        STX1  ! MAXSZ+2,,AUTO

      617    14219
      618    14220            %XSS$$TOKENS( NAME=TOKENS, STCLASS=AUTO);
      619    14257
      620    14258    2       IF XSS$CONNECT.SFU = '000000'O THEN

  14258  1 002212   200025 470500                    LDP0    SFPT$,,AUTO
         1 002213   000010 720100                    LXL0    8,,PR0
         1 002214   002302 600000 1                  TZE     BAD_SFU

      621    14259    2           GOTO BAD_SFU;
      622    14260    2       TOKENS = '0'O;

  14260  1 002215   200031 450100                    STZ     TOKENS,,AUTO

      623    14261    2       IF NOT XSS$CONNECT.SFU.FD AND NOT XSS$CONNECT.SFU.HD THEN

  14261  1 002216   000010 236100                    LDQ     8,,PR0
         1 002217   000010 316007                    CANQ    8,DL
         1 002220   002223 601000 1                  TNZ     s:14263
         1 002221   000004 316007                    CANQ    4,DL
         1 002222   002302 600000 1                  TZE     BAD_SFU

      624    14262    2           GOTO BAD_SFU;
      625    14263    2       IF XSS$GENERIC.FNC ~= %XSS_FNC_SCONREQ# AND

  14263  1 002223   000000 236100                    LDQ     0,,PR0
         1 002224   777000 376003                    ANQ     -512,DU
         1 002225   025000 116003                    CMPQ    10752,DU
         1 002226   002234 600000 1                  TZE     s:14266
         1 002227   000010 236100                    LDQ     8,,PR0
         1 002230   000004 316007                    CANQ    4,DL
         1 002231   002234 600000 1                  TZE     s:14266
         1 002232   000010 316007                    CANQ    8,DL
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:93   
         1 002233   002302 601000 1                  TNZ     BAD_SFU

      626    14264    2               XSS$CONNECT.SFU.HD AND XSS$CONNECT.SFU.FD THEN
      627    14265    2           GOTO BAD_SFU;
      628    14266    2       IF XSS$CONNECT.SFU.EXCEP AND NOT XSS$CONNECT.SFU.HD THEN

  14266  1 002234   000010 236100                    LDQ     8,,PR0
         1 002235   004000 316007                    CANQ    2048,DL
         1 002236   002241 600000 1                  TZE     s:14268
         1 002237   000004 316007                    CANQ    4,DL
         1 002240   002302 600000 1                  TZE     BAD_SFU

      629    14267    2           GOTO BAD_SFU;
      630    14268    2       IF XSS$CONNECT.SFU.NR THEN

  14268  1 002241   001000 316007                    CANQ    512,DL
         1 002242   002245 600000 1                  TZE     s:14270

      631    14269    2           TOKENS.TR = %TRUE;

  14269  1 002243   200000 236003                    LDQ     65536,DU
         1 002244   200031 256100                    ORSQ    TOKENS,,AUTO

      632    14270    2       IF XSS$CONNECT.SFU.HD THEN

  14270  1 002245   000010 236100                    LDQ     8,,PR0
         1 002246   000004 316007                    CANQ    4,DL
         1 002247   002252 600000 1                  TZE     s:14272

      633    14271    2           TOKENS.DK = %TRUE;

  14271  1 002250   002000 236003                    LDQ     1024,DU
         1 002251   200031 256100                    ORSQ    TOKENS,,AUTO

      634    14272    2       IF XSS$CONNECT.SFU.SY THEN

  14272  1 002252   000010 236100                    LDQ     8,,PR0
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:94   
         1 002253   000040 316007                    CANQ    32,DL
         1 002254   002257 600000 1                  TZE     s:14274

      635    14273    2           TOKENS.MI = %TRUE;

  14273  1 002255   010000 236003                    LDQ     4096,DU
         1 002256   200031 256100                    ORSQ    TOKENS,,AUTO

      636    14274    2       IF XSS$CONNECT.SFU.MA OR XSS$CONNECT.SFU.ACT THEN

  14274  1 002257   000010 236100                    LDQ     8,,PR0
         1 002260   000100 316007                    CANQ    64,DL
         1 002261   002264 601000 1                  TNZ     s:14275
         1 002262   000400 316007                    CANQ    256,DL
         1 002263   002266 600000 1                  TZE     s:14276

      637    14275    2           TOKENS.MA = %TRUE;

  14275  1 002264   040000 236003                    LDQ     16384,DU
         1 002265   200031 256100                    ORSQ    TOKENS,,AUTO

      638    14276    2       IF XSS$CONNECT.TOKENS ~= '0'O THEN

  14276  1 002266   000000 236100                    LDQ     0,,PR0
         1 002267   000777 316007                    CANQ    511,DL
         1 002270   002275 600000 1                  TZE     s:14279

      639    14277    2           IF XSS$CONNECT.TOKENS ~= TOKENS THEN

  14277  1 002271   000100 106500                    CMPC    fill='000'O
         1 002272   000000 600001                    ADSC9   0,,PR0                   cn=3,n=1
         1 002273   200031 000001                    ADSC9   TOKENS,,AUTO             cn=0,n=1
         1 002274   002306 601000 1                  TNZ     BAD_TOKENS

      640    14278    2               GOTO BAD_TOKENS;
      641    14279    2       XSS$CONNECT.TOKENS = TOKENS;

PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:95   
  14279  1 002275   200031 236100                    LDQ     TOKENS,,AUTO
         1 002276   000033 772000                    QRL     27
         1 002277   000000 552104                    STBQ    0,'04'O,PR0

      642    14280    2       RETURN;

  14280  1 002300   200030 221300                    LDX1  ! MAXSZ+2,,AUTO
         1 002301   000001 702211                    TSX2  ! 1,X1

      643    14281    2   BAD_SFU:
      644    14282    2       XSS$GENERIC.ERROR = XSS_E$SFU;

  14282  1 002302   000033 236000 0     BAD_SFU      LDQ     XSS_E$SFU
         1 002303   000001 756100                    STQ     1,,PR0

      645    14283    2       ALTRETURN;

  14283  1 002304   200030 221300                    LDX1  ! MAXSZ+2,,AUTO
         1 002305   000000 702211                    TSX2  ! 0,X1

      646    14284    2   BAD_TOKENS:
      647    14285    2       XSS$GENERIC.ERROR = XSS_E$TOKENS;

  14285  1 002306   000034 236000 0     BAD_TOKENS   LDQ     XSS_E$TOKENS
         1 002307   000001 756100                    STQ     1,,PR0

      648    14286    2       ALTRETURN;

  14286  1 002310   200030 221300                    LDX1  ! MAXSZ+2,,AUTO
         1 002311   000000 702211                    TSX2  ! 0,X1

      649    14287
      650    14288    2       END CKSFU;
      651    14289        %EJECT;
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:96   
      652    14290    1   CKITOKENS: PROC ALTRET;

  14290  1 002312   200030 741300       CKITOKENS    STX1  ! MAXSZ+2,,AUTO

      653    14291
      654    14292    2       IF XSS$GENERIC.FNC ~= %XSS_FNC_SCONRSP# THEN

  14292  1 002313   200025 470500                    LDP0    SFPT$,,AUTO
         1 002314   000000 236100                    LDQ     0,,PR0
         1 002315   777000 376003                    ANQ     -512,DU
         1 002316   027000 116003                    CMPQ    11776,DU
         1 002317   002321 600000 1                  TZE     s:14294

      655    14293    2           RETURN;

  14293  1 002320   000001 702211                    TSX2  ! 1,X1

      656    14294    2       IF XSS$CONNECT.ITOKENS.TR = %XSS_TSI_ACHOICE# THEN

  14294  1 002321   000010 236100                    LDQ     8,,PR0
         1 002322   600000 376003                    ANQ     -65536,DU
         1 002323   400000 116003                    CMPQ    -131072,DU
         1 002324   002326 601000 1                  TNZ     s:14296

      657    14295    2           ALTRETURN;

  14295  1 002325   000000 702211                    TSX2  ! 0,X1

      658    14296    2       IF XSS$CONNECT.ITOKENS.MA = %XSS_TSI_ACHOICE# THEN

  14296  1 002326   000010 236100                    LDQ     8,,PR0
         1 002327   140000 376003                    ANQ     49152,DU
         1 002330   100000 116003                    CMPQ    32768,DU
         1 002331   002333 601000 1                  TNZ     s:14298

      659    14297    2           ALTRETURN;

PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:97   
  14297  1 002332   000000 702211                    TSX2  ! 0,X1

      660    14298    2       IF XSS$CONNECT.ITOKENS.MI = %XSS_TSI_ACHOICE# THEN

  14298  1 002333   000010 236100                    LDQ     8,,PR0
         1 002334   030000 376003                    ANQ     12288,DU
         1 002335   020000 116003                    CMPQ    8192,DU
         1 002336   002340 601000 1                  TNZ     s:14300

      661    14299    2           ALTRETURN;

  14299  1 002337   000000 702211                    TSX2  ! 0,X1

      662    14300    2       IF XSS$CONNECT.ITOKENS.DK = %XSS_TSI_ACHOICE# THEN

  14300  1 002340   000010 236100                    LDQ     8,,PR0
         1 002341   006000 376003                    ANQ     3072,DU
         1 002342   004000 116003                    CMPQ    2048,DU
         1 002343   002345 601000 1                  TNZ     s:14302

      663    14301    2           ALTRETURN;

  14301  1 002344   000000 702211                    TSX2  ! 0,X1

      664    14302    2       RETURN;

  14302  1 002345   000001 702211                    TSX2  ! 1,X1

XSS_VBLK
 Sect OctLoc
   0     000   000000 006014   000000 000000   000000 006014   000000 000000    ................
   0     004   000000 006014   000000 000000   000000 006014   000000 000000    ................

XSS_E$RDONLYFPT
 Sect OctLoc
   0     010   302323 000200                                                    ....

PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:98   
XSS_E$BADCID
 Sect OctLoc
   0     011   302323 000010                                                    ....

XSS_E$BADFNC
 Sect OctLoc
   0     012   302323 000020                                                    ....

XSS_E$STATE
 Sect OctLoc
   0     013   302323 000030                                                    ....

XSS_E$ACTID
 Sect OctLoc
   0     014   302323 000240                                                    ....

(unnamed)
 Sect OctLoc
   0     015   302323 000250                                                    ....

XSS_E$CALLED
 Sect OctLoc
   0     016   302323 000260                                                    ....

XSS_E$CALLING
 Sect OctLoc
   0     017   302323 000270                                                    ....

XSS_E$COMMON
 Sect OctLoc
   0     020   302323 000300                                                    ....

XSS_E$DATA
 Sect OctLoc
   0     021   302323 000310                                                    ....

XSS_E$FLOW
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:99   
 Sect OctLoc
   0     022   302323 000130                                                    ...X

XSS_E$ITOKENS
 Sect OctLoc
   0     023   302323 000320                                                    ....

XSS_E$OACTID
 Sect OctLoc
   0     024   302323 000330                                                    ....

(unnamed)
 Sect OctLoc
   0     025   302323 000340   302323 000350                                    ........

XSS_E$REASON
 Sect OctLoc
   0     027   302323 000360                                                    ....

XSS_E$RESPONDING
 Sect OctLoc
   0     030   302323 000370                                                    ....

(unnamed)
 Sect OctLoc
   0     031   302323 000400                                                    ....

XSS_E$SERNUM
 Sect OctLoc
   0     032   302323 000410                                                    ....

XSS_E$SFU
 Sect OctLoc
   0     033   302323 000420                                                    ....

XSS_E$TOKENS
 Sect OctLoc
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:100  
   0     034   302323 000430                                                    ....

XSS_E$TYPE
 Sect OctLoc
   0     035   302323 000440                                                    ....

NO_COMMON
 Sect OctLoc
   0     036   000000 000000                                                    ....

(unnamed)
 Sect OctLoc
   0     037   113123 040040                                                    KS

(unnamed)
 Sect OctLoc
   2     000   000001 000000   000010 006000   000002 000000   000037 006000    ................
   2     004   000000 000012   000004 006000   000000 001000   000000 006014    ................
   2     010   000006 006000   000017 006000   000016 006000   000003 400000    ................
   2     014   000003 000000   000030 006000   000000 177775   000000 000001    ................
   2     020   000016 006000   000017 006000   777777 773777   000000 000016    ................
   2     024   000023 006000   000017 006000   000000 000011   000026 006000    ................
   2     030   000005 400000   000003 641100   000036 006000                    .......@....
      665    14303
      666    14304    2       END CKITOKENS;
      667    14305
      668    14306    1       END XSS$SESSION;

PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:101  
--  Include file information  --

   XSC_PERR_C.:XSA1TOU  is referenced.
   XSC_COMMON_M.:XSA1TOU  is referenced.
   XSS_INTERNAL_M.:XSA1TOU  is referenced.
   XSS_INTERNAL_E.:XSA1TOU  is referenced.
   XSS_SESSION_M.:XSA1TOU  is referenced.
   XSS_SESSION_E.:XSA1TOU  is referenced.
   K_ADDRESS_M.:LIB_E05  is referenced.
   UM_CP6.:E05OU  is referenced.
   B$JIT_C.:LIB_E05  is referenced.
   B_SEGIDS_C.:LIB_E05  is referenced.
      No diagnostics issued in procedure XSS$SESSION.
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:102  

 **** Variables and constants ****

  ****  Section 000 RoData XSS$SESSION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    36-0-0/c STRC        r     1 NO_COMMON                 14-0-0/w STRC        r     1 XSS_E$ACTID
    11-0-0/w STRC        r     1 XSS_E$BADCID              12-0-0/w STRC        r     1 XSS_E$BADFNC
    16-0-0/w STRC        r     1 XSS_E$CALLED              17-0-0/w STRC        r     1 XSS_E$CALLING
    20-0-0/w STRC        r     1 XSS_E$COMMON              21-0-0/w STRC        r     1 XSS_E$DATA
    22-0-0/w STRC        r     1 XSS_E$FLOW                23-0-0/w STRC        r     1 XSS_E$ITOKENS
    24-0-0/w STRC        r     1 XSS_E$OACTID              10-0-0/w STRC        r     1 XSS_E$RDONLYFPT
    27-0-0/w STRC        r     1 XSS_E$REASON              30-0-0/w STRC        r     1 XSS_E$RESPONDING
    32-0-0/w STRC        r     1 XSS_E$SERNUM              33-0-0/w STRC        r     1 XSS_E$SFU
    13-0-0/w STRC        r     1 XSS_E$STATE               34-0-0/w STRC        r     1 XSS_E$TOKENS
    35-0-0/w STRC        r     1 XSS_E$TYPE                 0-0-0/d STRC(288)   r     1 XSS_VBLK

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    31-0-0/w PTR         r     1 @APTR$                    32-0-0/w PTR         r     1 @ERR
    33-0-0/w PTR         r     1 @LB                       31-0-0/w PTR         r     1 @QVEC
    31-0-0/w PTR         r     1 @RC                        3-0-0/w PTR         r     1 @SFPT
    31-0-0/w PTR         r     1 @TXTC                     31-0-0/w PTR         r     1 @TXTC$
    32-0-0/w PTR         r     1 @UB                       31-0-0/w PTR         r     1 @VAL
    *0-0-0/w PTR         r     1 APTR$                     20-0-0/h UBIN(18)    r     1 BLKX
    21-0-0/w PTR         r     1 CTX$                      *0-0-0/b BIT         r     1 ERR
    32-0-0/w SBIN        r     1 I                         *0-0-0/w SBIN        r     1 LB
    22-0-0/w SBIN        r     1 LEN                       34-0-0/w SBIN        r     1 LEN
    35-0-0/w SBIN        r     1 LOWER                     26-0-0/w SBIN        r     1 MAXSZ
    23-0-0/w PTR         r     1 PTR$                      25-0-0/w STRC        r     1 PX
    *0-0-0/d STRC(72)    r     1 QVEC                      *0-0-0/c UBIN(9)     r     1 RC
    24-0-0/w SBIN        r     1 SCID                       4-0-0/d STRC(144)   r     1 SDATREQ
    *0-0-0/d STRC(504)   r     1 SFPT                      25-0-0/w PTR         r     1 SFPT$
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:103  
    24-0-0/w SBIN        r     1 TEMP                      31-0-0/c STRC(9)     r     1 TOKENS
    *0-0-0/c STRC(63)    r     1 TXTC                      *0-0-0/w PTR         r     1 TXTC$
    *0-0-0/w SBIN        r     1 UB                        *0-0-0/w SBIN        r     1 UPPER
    *0-0-0/w UBIN        r     1 VAL                       10-0-0/d STRC(288)   r     1 VBLK

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 XSS_CCB$$
     0-0-0/w STRC        r     1 XSS_E$NODYNMEM             0-0-0/w SBIN        r     1 XSS_TRACE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/w PTR         r     1 CCB$(0:0)
     0-0-0/c ACHR        r     1 LENBYTES                   0-0-0/w STRC(1260)  r     1 SCTX
     0-0-0/c ASTR(9)     r     1 TXTC                       0-0-0/w STRC(2718)  r     1 XSC$ADDRESS
     0-0-0/w STRC(2718)  r     1 XSC$ADDRESS                0-0-0/w STRC(504)   r     1 XSC$CCB
     0-0-0/w STRC(72)    r     1 XSS$ACTIVITY_DISCARD       0-0-0/d STRC(180)   r     1 XSS$ACTIVITY_END
     0-0-0/w STRC(72)    r     1 XSS$ACTIVITY_INTERRUPT
     0-0-0/d STRC(468)   r     1 XSS$ACTIVITY_RESUME        0-0-0/d STRC(216)   r     1 XSS$ACTIVITY_START
     0-0-0/d STRC(144)   r     1 XSS$CAPABILITY_DATA        0-0-0/d STRC(396)   r     1 XSS$CONNECT
     0-0-0/w STRC(72)    r     1 XSS$CONTROL_GIVE           0-0-0/d STRC(144)   r     1 XSS$DATA
     0-0-0/d STRC(144)   r     1 XSS$EXPEDITED_DATA         0-0-0/d STRC(504)   r     1 XSS$GENERIC
     0-0-0/d STRC(144)   r     1 XSS$RELEASE                0-0-0/d STRC(180)   r     1 XSS$RESYNCHRONIZE
     0-0-0/d STRC(180)   r     1 XSS$SYNC_MAJOR             0-0-0/d STRC(180)   r     1 XSS$SYNC_MINOR
     0-0-0/d STRC(144)   r     1 XSS$TOKEN_PLEASE           0-0-0/d STRC(144)   r     1 XSS$TYPED_DATA
     0-0-0/d STRC(144)   r     1 XSS$U_ABORT
     0-0-0/d STRC(144)   r     1 XSS$U_EXCEPTION_REPORT


   Procedure XSS$SESSION requires 1254 words for executable code.
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:104  
   Procedure XSS$SESSION requires 34 words of local(AUTO) storage.

    No errors detected in file XSS$SESSION.:XSA1TSI    .
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:105  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:106  
          MINI XREF LISTING

ABORT
     13756**LABEL   13660--CALLALT
APTR$ IN PROCEDURE CKADDR
     14081**DCL     13796--PROC    13815--IMP-PTR 14084>>IF      14085>>IF      14087>>IF      14089>>IF
     14089>>IF      14091>>IF      14091>>IF
B$JIT.ERR.MID
       883**DCL       883--REDEF
B$JIT.JRESPEAK
       973**DCL       974--REDEF
B$JIT.PLL
       969**DCL     13469>>IF
B$JIT.PUL
       969**DCL     13469>>IF
B$JIT$
     13443**DCL       877--IMP-PTR 13469>>IF      13469>>IF
BAD_ADDR
     13790**LABEL   13532--CALLALT 13540--CALLALT 13563--CALLALT 13570--CALLALT 13599--CALLALT 13607--CALLALT
BAD_ADDR IN PROCEDURE CKADDR
     14096**LABEL   14086--GOTO    14088--GOTO    14090--GOTO    14092--GOTO
BAD_AI
     13785**LABEL   13527--CALLALT 13551--CALLALT
BAD_COMMON
     13767**LABEL   13531--CALLALT 13562--CALLALT 13598--CALLALT
BAD_DATA
     13770**LABEL   13516--CALLALT 13519--CALLALT 13548--CALLALT 13552--CALLALT 13555--CALLALT 13558--CALLALT
     13584--CALLALT 13619--CALLALT 13624--CALLALT 13640--CALLALT 13672--CALLALT 13675--CALLALT 13679--CALLALT
     13694--CALLALT 13698--CALLALT 13702--CALLALT 13705--CALLALT 13710--CALLALT 13714--CALLALT 13721--CALLALT
     13729--CALLALT 13733--CALLALT 13743--CALLALT
BAD_ITOKENS
     13773**LABEL   13583--CALLALT 13631--CALLALT
BAD_OAI
     13788**LABEL   13528--CALLALT
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:107  
BAD_RC
     13776**LABEL   13510--CALLALT 13522--CALLALT 13616--CALLALT 13737--CALLALT
BAD_RT
     13779**LABEL   13690--GOTO
BAD_SFU IN PROCEDURE CKSFU
     14282**LABEL   14259--GOTO    14262--GOTO    14265--GOTO    14267--GOTO
BAD_SN
     13782**LABEL   13515--CALLALT 13529--CALLALT 13582--CALLALT 13630--CALLALT 13692--CALLALT 13696--CALLALT
     13701--CALLALT 13709--CALLALT 13713--CALLALT
BAD_TOKENS IN PROCEDURE CKSFU
     14285**LABEL   14278--GOTO
BAD_VIBES
     13794**LABEL   13580--CALLALT 13590--GOTO    13628--CALLALT 13768--GOTO    13771--GOTO    13774--GOTO
     13777--GOTO    13780--GOTO    13783--GOTO    13786--GOTO    13789--GOTO
BLKX
     13447**DCL     13587<>CALL    13593>>ASSIGN
BLOCKLOOP
     13497**LABEL   13498--GOTO
CCB$
     13449**DCL     13761>>CALL
CKADDR
     13796**PROC    13532--CALL    13540--CALL    13563--CALL    13570--CALL    13599--CALL    13607--CALL
CKAI
     14167**PROC    13527--CALL    13528--CALL    13551--CALL
CKCOMMON
     14198**PROC    13531--CALL    13562--CALL    13598--CALL
CKDATA
     14101**PROC    13516--CALL    13519--CALL    13548--CALL    13552--CALL    13555--CALL    13558--CALL
     13584--CALL    13619--CALL    13624--CALL    13640--CALL    13672--CALL    13675--CALL    13679--CALL
     13694--CALL    13698--CALL    13702--CALL    13705--CALL    13710--CALL    13714--CALL    13721--CALL
     13729--CALL    13733--CALL    13743--CALL
CKITOKENS
     14290**PROC    13583--CALL    13631--CALL
CKRC
     14185**PROC    13510--CALL    13522--CALL    13616--CALL    13737--CALL
CKSFU
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:108  
     14218**PROC    13580--CALL    13628--CALL
CKSN
     14157**PROC    13515--CALL    13529--CALL    13582--CALL    13630--CALL    13692--CALL    13696--CALL
     13701--CALL    13709--CALL    13713--CALL
CTX$
     13450**DCL     10531--IMP-PTR 13485<>CALL    13487>>IF      13494>>IF      13495>>IF      13506>>ASSIGN
     13535>>CALL    13537>>CALL    13543>>CALL    13545>>CALL    13565>>CALL    13567>>CALL    13572>>CALL
     13574>>CALL    13593>>ASSIGN  13602>>CALL    13604>>CALL    13610>>CALL    13612>>CALL    13644>>IF
     13645>>ASSIGN  13647>>ASSIGN  13724>>IF      13725>>ASSIGN  13727>>ASSIGN  13735>>ASSIGN  13738>>IF
     13739>>ASSIGN  13741>>ASSIGN  14211>>CALL
DONE
     13761**LABEL   13664--GOTO
ERR IN PROCEDURE CKADDR
     14082**DCL     13796--PROC    14096>>ASSIGN
I IN PROCEDURE CKAI
     14172**DCL     14177<<DOINDEX 14178>>IF
K$ADDRESS.NSAP.ADDRESS_N
      2493**DCL      2494--REDEF
LB IN PROCEDURE CKDATA
     14139**DCL     14101--PROC    14147--IF      14150>>ASSIGN
LEN
     13451**DCL     13448--IMP-SIZ 13452--IMP-SIZ 13586<<ASSIGN  13587<>CALL    13592>>ASSIGN  13592>>ASSIGN
     13643<<ASSIGN  13648>>IF      13652>>DOWHILE 13654>>ASSIGN  13656<<ASSIGN  13656>>ASSIGN  13657>>IF
     13666>>ASSIGN  14208<<ASSIGN  14209>>IF      14212>>ASSIGN  14212>>ASSIGN
LEN IN PROCEDURE CKDATA
     14140**DCL     14144<<ASSIGN  14146<<ASSIGN  14151>>IF      14151>>IF
LENBYTES
     13452**DCL     13592<<ASSIGN  13592>>ASSIGN  14212<<ASSIGN  14212>>ASSIGN
LOOP
     13485**LABEL   13488--CALLALT 13497--CALLALT
LOWER IN PROCEDURE CKDATA
     14141**DCL     14148<<ASSIGN  14150<<ASSIGN  14151>>IF
MAXSZ
     13464**DCL     13645<<ASSIGN  13647<<ASSIGN  13648>>IF      13648>>IF      13652>>DOWHILE 13654>>ASSIGN
     13656>>ASSIGN  13662>>ASSIGN  13725<<ASSIGN  13727<<ASSIGN  13728>>IF      13729<>CALL    13739<<ASSIGN
     13741<<ASSIGN  13742>>IF      13743<>CALL
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:109  
NO_COMMON
     13453**DCL     14206--ASSIGN
PTR$
     13456**DCL     13537<>CALL    13538>>ASSIGN  13545<>CALL    13546>>ASSIGN  13567<>CALL    13568>>ASSIGN
     13574<>CALL    13575>>ASSIGN  13587<>CALL    13592>>ASSIGN  13604<>CALL    13605>>ASSIGN  13612<>CALL
     13613>>ASSIGN  13649<<ASSIGN  13655>>ASSIGN  13662<<ASSIGN  13662>>ASSIGN  13667>>ASSIGN  14211<>CALL
     14212>>ASSIGN
PX.OFFSET
     13461**DCL     13468>>ASSIGN
PX.SEGID
     13463**DCL     13467>>IF
QVEC IN PROCEDURE CKDATA
     14120**DCL     14101--PROC
QVEC.PTR$ IN PROCEDURE CKDATA
     14133**DCL     14143>>IF
QVEC.SIZE IN PROCEDURE CKDATA
     14134**DCL     14146>>ASSIGN
RC IN PROCEDURE CKRC
     14187**DCL     14185--PROC    14189>>DOSELCT
SCID
     13457**DCL     13458--REDEF   13482<<ASSIGN  13483>>CALL    13485<>CALL    13488<>CALL
SCTX.BLOCKING
     10822**DCL     13495>>IF
SCTX.COMX
     10552**DCL     14211<>CALL
SCTX.DSTX
     10551**DCL     13543<>CALL    13545<>CALL    13572<>CALL    13574<>CALL    13610<>CALL    13612<>CALL
SCTX.FLAGS.VTCA
     10802**DCL     13644>>IF      13724>>IF      13738>>IF
SCTX.FLOWSTOPPED
     10821**DCL     13494>>IF
SCTX.HEADX
     10856**DCL     13593<<ASSIGN
SCTX.HISTZ
     10845**DCL     10846--REDEF
SCTX.LATCH.PRESENT
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:110  
     10893**DCL     13487>>IF
SCTX.SRCX
     10550**DCL     13535<>CALL    13537<>CALL    13565<>CALL    13567<>CALL    13602<>CALL    13604<>CALL
SCTX.TD.USRAB
     10837**DCL     13735<<ASSIGN
SCTX.TSDUMS.INI
     10829**DCL     13647>>ASSIGN  13727>>ASSIGN  13741>>ASSIGN
SCTX.TSDUMS.RSP
     10830**DCL     13645>>ASSIGN  13725>>ASSIGN  13739>>ASSIGN
SDATREQ
      9289**DCL     13650<<ASSIGN  13651--ASSIGN
SDATREQ.DATA.PTR$
      9401**DCL     13655<<ASSIGN  13667<<ASSIGN
SDATREQ.DATA.SIZE
      9407**DCL     13654<<ASSIGN  13666<<ASSIGN
SDATREQ.ERRDEF
      9323**DCL      9343--REDEF
SFPT
      9143**DCL        22--PROC    13466--ASSIGN  13762--IF      13763>>ASSIGN
SFPT.ERRDEF
      9197**DCL      9217--REDEF
SFPT.SCID
      9158**DCL     13761>>CALL
SFPT$
     13459**DCL      5765--IMP-PTR  5911--IMP-PTR  6009--IMP-PTR  6160--IMP-PTR  6258--IMP-PTR  6484--IMP-PTR
      6647--IMP-PTR  6793--IMP-PTR  7116--IMP-PTR  7240--IMP-PTR  7384--IMP-PTR  7528--IMP-PTR  7614--IMP-PTR
      7700--IMP-PTR  7852--IMP-PTR  8065--IMP-PTR  8224--IMP-PTR  8383--IMP-PTR  8513--IMP-PTR  8705--IMP-PTR
      8849--IMP-PTR  8993--IMP-PTR 13460--REDEF   13466<<ASSIGN  13471>>IF      13477>>ASSIGN  13480>>ASSIGN
     13482>>ASSIGN  13483>>CALL    13491>>ASSIGN  13501>>ASSIGN  13508>>DOCASE  13510>>CALL    13515>>CALL
     13516>>CALL    13519>>CALL    13522>>CALL    13527>>CALL    13528>>CALL    13529>>CALL    13531>>CALL
     13532>>CALL    13534>>IF      13535>>CALL    13538>>ASSIGN  13540>>CALL    13542>>IF      13543>>CALL
     13546>>ASSIGN  13548>>CALL    13551>>CALL    13552>>CALL    13555>>CALL    13558>>CALL    13562>>CALL
     13563>>CALL    13564>>IF      13565>>CALL    13568>>ASSIGN  13570>>CALL    13571>>IF      13572>>CALL
     13575>>ASSIGN  13577>>ASSIGN  13581>>IF      13582>>CALL    13584>>CALL    13585>>IF      13586>>ASSIGN
     13589>>ASSIGN  13592>>ASSIGN  13598>>CALL    13599>>CALL    13601>>IF      13602>>CALL    13605>>ASSIGN
     13607>>CALL    13609>>IF      13610>>CALL    13613>>ASSIGN  13615>>IF      13616>>CALL    13617>>ASSIGN
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:111  
     13619>>CALL    13624>>CALL    13629>>IF      13630>>CALL    13633>>ASSIGN  13634>>ASSIGN  13635>>ASSIGN
     13636>>ASSIGN  13640>>CALL    13642>>CALL    13643>>ASSIGN  13649>>ASSIGN  13650>>ASSIGN  13672>>CALL
     13675>>CALL    13679>>CALL    13682>>DOCASE  13692>>CALL    13694>>CALL    13696>>CALL    13698>>CALL
     13701>>CALL    13702>>CALL    13705>>CALL    13709>>CALL    13710>>CALL    13713>>CALL    13714>>CALL
     13721>>CALL    13729>>CALL    13733>>CALL    13737>>CALL    13743>>CALL    13747>>ASSIGN  13751>>IF
     13752>>CALL    13756>>IF      13757>>ASSIGN  13761<>CALL    13762>>IF      13763>>ASSIGN  13767>>ASSIGN
     13770>>ASSIGN  13773>>ASSIGN  13776>>ASSIGN  13779>>ASSIGN  13782>>ASSIGN  13785>>ASSIGN  13788>>ASSIGN
     14096>>ASSIGN  14258>>IF      14261>>IF      14261>>IF      14263>>IF      14263>>IF      14263>>IF
     14266>>IF      14266>>IF      14268>>IF      14270>>IF      14272>>IF      14274>>IF      14274>>IF
     14276>>IF      14277>>IF      14279>>ASSIGN  14282>>ASSIGN  14285>>ASSIGN  14292>>IF      14294>>IF
     14296>>IF      14298>>IF      14300>>IF
TEMP
     13458**DCL     13468<<ASSIGN  13469>>IF      13469>>IF
TOKENS IN PROCEDURE CKSFU
     14237**DCL     14260<<ASSIGN  14277>>IF      14279>>ASSIGN
TOKENS.DK IN PROCEDURE CKSFU
     14251**DCL     14271<<ASSIGN
TOKENS.MA IN PROCEDURE CKSFU
     14247**DCL     14275<<ASSIGN
TOKENS.MI IN PROCEDURE CKSFU
     14249**DCL     14273<<ASSIGN
TOKENS.TR IN PROCEDURE CKSFU
     14245**DCL     14269<<ASSIGN
TXTC IN PROCEDURE CKAI
     14169**DCL     14167--PROC
TXTC.LEN IN PROCEDURE CKAI
     14170**DCL     14174>>IF      14176>>IF
TXTC.TXT IN PROCEDURE CKAI
     14171**DCL     14178>>IF
TXTC.LEN IN PROCEDURE CKCOMMON
     14202**DCL     14203--IMP-SIZ 14208>>ASSIGN
TXTC$ IN PROCEDURE CKCOMMON
     14200**DCL     14198--PROC    14201--IMP-PTR 14205>>IF      14206<<ASSIGN  14208>>ASSIGN  14212>>ASSIGN
UB IN PROCEDURE CKDATA
     14137**DCL     14101--PROC    14138--REDEF
UPPER IN PROCEDURE CKDATA
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:112  
     14138**DCL     14151>>IF
VAL IN PROCEDURE CKSN
     14159**DCL     14157--PROC    14161>>IF      14161>>IF
VBLK
     10425**DCL     13479<<ASSIGN  13660<>CALL    13753<>CALL
VBLK.CTX$
     10433**DCL     13506<<ASSIGN
VBLK.EI.BOSSDU
     10438**DCL     13639<<ASSIGN  13661<<ASSIGN
VBLK.EI.EOSSDU
     10439**DCL     13658<<ASSIGN  13663>>IF      13670<<ASSIGN
VBLK.EVENT
     10443**DCL     13511<<ASSIGN  13513<<ASSIGN  13517<<ASSIGN  13520<<ASSIGN  13523<<ASSIGN  13525<<ASSIGN
     13549<<ASSIGN  13553<<ASSIGN  13556<<ASSIGN  13559<<ASSIGN  13595<<ASSIGN  13620<<ASSIGN  13625<<ASSIGN
     13637<<ASSIGN  13659<<ASSIGN  13669<<ASSIGN  13673<<ASSIGN  13676<<ASSIGN  13680<<ASSIGN  13684<<ASSIGN
     13686<<ASSIGN  13688<<ASSIGN  13699<<ASSIGN  13703<<ASSIGN  13706<<ASSIGN  13711<<ASSIGN  13715<<ASSIGN
     13718<<ASSIGN  13722<<ASSIGN  13731<<ASSIGN  13734<<ASSIGN  13745<<ASSIGN
VBLK.FPT$
     10444**DCL     13480<<ASSIGN  13651<<ASSIGN
VBLK.RF_RSN
     10434**DCL     13617<<ASSIGN
XSC$ADDRESS
     11617**DCL     13538<<ASSIGN  13538>>ASSIGN  13546<<ASSIGN  13546>>ASSIGN  13568<<ASSIGN  13568>>ASSIGN
     13575<<ASSIGN  13575>>ASSIGN  13605<<ASSIGN  13605>>ASSIGN  13613<<ASSIGN  13613>>ASSIGN
XSC$ADDRESS.NSAP.ADDRESS_N
     11878**DCL     11879--REDEF
XSC$ADDRESS.NSAP.ADDRESS_N IN PROCEDURE CKADDR
     14076**DCL     14077--REDEF
XSC$ADDRESS.NSAP.LEN IN PROCEDURE CKADDR
     14048**DCL     14091>>IF      14091>>IF
XSC$ADDRESS.PSAP.LEN IN PROCEDURE CKADDR
     13883**DCL     14085>>IF
XSC$ADDRESS.SSAP.LEN IN PROCEDURE CKADDR
     13933**DCL     14087>>IF
XSC$ADDRESS.TSAP.LEN IN PROCEDURE CKADDR
     13974**DCL     14089>>IF      14089>>IF
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:113  
XSC$CCB.ERRDEF
     12007**DCL     12027--REDEF
XSC$CCB.SFPTX
     12097**DCL     13761<>CALL
XSS$ACTIVITY_DISCARD.ERRDEF
      5955**DCL      5981--REDEF
XSS$ACTIVITY_DISCARD.REASON
      5953**DCL     13510<>CALL
XSS$ACTIVITY_END.DATA
      6108**DCL     13516<>CALL    13519<>CALL
XSS$ACTIVITY_END.ERRDEF
      6045**DCL      6065--REDEF
XSS$ACTIVITY_END.SERNUM
      6141**DCL     13515<>CALL
XSS$ACTIVITY_INTERRUPT.ERRDEF
      6210**DCL      6230--REDEF
XSS$ACTIVITY_INTERRUPT.REASON
      6202**DCL     13522<>CALL
XSS$ACTIVITY_RESUME.ACTID
      6447**DCL     13527<>CALL
XSS$ACTIVITY_RESUME.CALLED$
      6421**DCL     13540<>CALL    13542>>IF      13543<>CALL    13546>>ASSIGN
XSS$ACTIVITY_RESUME.CALLING$
      6412**DCL     13532<>CALL    13534>>IF      13535<>CALL    13538>>ASSIGN
XSS$ACTIVITY_RESUME.COMMON$
      6403**DCL     13531<>CALL
XSS$ACTIVITY_RESUME.DATA
      6360**DCL     13548<>CALL
XSS$ACTIVITY_RESUME.ERRDEF
      6297**DCL      6317--REDEF
XSS$ACTIVITY_RESUME.OACTID
      6457**DCL     13528<>CALL
XSS$ACTIVITY_RESUME.SERNUM
      6393**DCL     13529<>CALL
XSS$ACTIVITY_START.ACTID
      6626**DCL     13551<>CALL
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:114  
XSS$ACTIVITY_START.DATA
      6581**DCL     13552<>CALL
XSS$ACTIVITY_START.ERRDEF
      6518**DCL      6538--REDEF
XSS$BUFPTR
     13433**DCL-ENT 13535--CALL    13537--CALL    13543--CALL    13545--CALL    13565--CALL    13567--CALL
     13572--CALL    13574--CALL    13602--CALL    13604--CALL    13610--CALL    13612--CALL    13761--CALL
     14211--CALL
XSS$CAPABILITY_DATA.DATA
      6746**DCL     13555<>CALL    13558<>CALL
XSS$CAPABILITY_DATA.ERRDEF
      6683**DCL      6703--REDEF
XSS$COMMPEND
     13434**DCL-ENT 13488--CALL
XSS$COMMWAIT
     13435**DCL-ENT 13497--CALL
XSS$CONNECT.CALLED$
      7019**DCL      7020--REDEF   13570<>CALL    13571>>IF      13572<>CALL    13575>>ASSIGN
XSS$CONNECT.CALLING$
      7002**DCL     13563<>CALL    13564>>IF      13565<>CALL    13568>>ASSIGN  13599<>CALL    13601>>IF
     13602<>CALL    13605>>ASSIGN
XSS$CONNECT.COMMON$
      6993**DCL     13562<>CALL    13598<>CALL
XSS$CONNECT.DATA
      6950**DCL     13584<>CALL    13619<>CALL    13624<>CALL
XSS$CONNECT.DATA.PTR$
      6965**DCL     13592>>ASSIGN
XSS$CONNECT.DATA.SIZE
      6971**DCL     13585>>IF      13586>>ASSIGN
XSS$CONNECT.ERRDEF
      6887**DCL      6907--REDEF
XSS$CONNECT.ITOKENS.DK
      7040**DCL     14300>>IF
XSS$CONNECT.ITOKENS.MA
      7038**DCL     14296>>IF
XSS$CONNECT.ITOKENS.MI
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:115  
      7039**DCL     14298>>IF
XSS$CONNECT.ITOKENS.TR
      7037**DCL     14294>>IF
XSS$CONNECT.REASON
      6835**DCL     13616<>CALL    13617>>ASSIGN
XSS$CONNECT.RESPONDING$
      7020**DCL     13607<>CALL    13609>>IF      13610<>CALL    13613>>ASSIGN
XSS$CONNECT.RESULT
      7049**DCL     13577<<ASSIGN  13615>>IF
XSS$CONNECT.SERNUM
      6983**DCL     13581>>IF      13582<>CALL    13629>>IF      13630<>CALL
XSS$CONNECT.SFU
      7072**DCL     14258>>IF
XSS$CONNECT.SFU.ACT
      7078**DCL     14274>>IF
XSS$CONNECT.SFU.EXCEP
      7075**DCL     14266>>IF
XSS$CONNECT.SFU.FD
      7083**DCL     14261>>IF      14263>>IF
XSS$CONNECT.SFU.HD
      7084**DCL     14261>>IF      14263>>IF      14266>>IF      14270>>IF
XSS$CONNECT.SFU.MA
      7080**DCL     14274>>IF
XSS$CONNECT.SFU.NR
      7077**DCL     14268>>IF
XSS$CONNECT.SFU.SY
      7081**DCL     14272>>IF
XSS$CONNECT.TOKENS
      6863**DCL     14276>>IF      14277>>IF      14279<<ASSIGN
XSS$CONTROL_GIVE.ERRDEF
      7192**DCL      7212--REDEF
XSS$CONTROL_GIVE.TOKENS.DK
      7180**DCL     13636<<ASSIGN
XSS$CONTROL_GIVE.TOKENS.MA
      7176**DCL     13634<<ASSIGN
XSS$CONTROL_GIVE.TOKENS.MI
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:116  
      7178**DCL     13635<<ASSIGN
XSS$CONTROL_GIVE.TOKENS.TR
      7174**DCL     13633<<ASSIGN
XSS$CTXPTR
     13436**DCL-ENT 13485--CALL
XSS$DATA
      7240**DCL     13650>>ASSIGN
XSS$DATA.DATA
      7337**DCL     13640<>CALL
XSS$DATA.DATA.PTR$
      7352**DCL     13649>>ASSIGN
XSS$DATA.DATA.SIZE
      7358**DCL     13643>>ASSIGN
XSS$DATA.ERRDEF
      7274**DCL      7294--REDEF
XSS$DUMPFPT
     13437**DCL-ENT 13642--CALL    13752--CALL
XSS$EVLOG
     13441**DCL-ENT 13483--CALL
XSS$EXPEDITED_DATA.DATA
      7481**DCL     13672<>CALL
XSS$EXPEDITED_DATA.ERRDEF
      7418**DCL      7438--REDEF
XSS$GENERIC
      5765**DCL     13642<>CALL    13752<>CALL    13763<<ASSIGN
XSS$GENERIC.ERRDEF
      5819**DCL      5839--REDEF
XSS$GENERIC.ERROR
      5839**DCL     13471>>IF      13477<<ASSIGN  13491<<ASSIGN  13501<<ASSIGN  13589<<ASSIGN  13747<<ASSIGN
     13756>>IF      13757<<ASSIGN  13767<<ASSIGN  13770<<ASSIGN  13773<<ASSIGN  13776<<ASSIGN  13779<<ASSIGN
     13782<<ASSIGN  13785<<ASSIGN  13788<<ASSIGN  14096<<ASSIGN  14282<<ASSIGN  14285<<ASSIGN
XSS$GENERIC.FNC
      5779**DCL     13483>>CALL    13508>>DOCASE  13751>>IF      14263>>IF      14292>>IF
XSS$GENERIC.SCID
      5780**DCL     13482>>ASSIGN
XSS$GETMEM
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:117  
     13438**DCL-ENT 13587--CALL
XSS$MACHINE
     13439**DCL-ENT 13660--CALL    13753--CALL
XSS$P_ABORT.ERRDEF
      7566**DCL      7586--REDEF
XSS$P_EXCEPTION_REPORT.ERRDEF
      7652**DCL      7672--REDEF
XSS$RELEASE.DATA
      7805**DCL     13675<>CALL    13679<>CALL
XSS$RELEASE.ERRDEF
      7742**DCL      7762--REDEF
XSS$RESYNCHRONIZE.DATA
      8013**DCL     13694<>CALL    13698<>CALL
XSS$RESYNCHRONIZE.ERRDEF
      7950**DCL      7970--REDEF
XSS$RESYNCHRONIZE.SERNUM
      8046**DCL     13692<>CALL    13696<>CALL
XSS$RESYNCHRONIZE.TYPE
      7890**DCL     13682>>DOCASE
XSS$SCREECH
     13440**DCL-ENT 13473--CALL
XSS$SYNC_MAJOR.DATA
      8172**DCL     13702<>CALL    13705<>CALL
XSS$SYNC_MAJOR.ERRDEF
      8109**DCL      8129--REDEF
XSS$SYNC_MAJOR.SERNUM
      8205**DCL     13701<>CALL
XSS$SYNC_MINOR.DATA
      8331**DCL     13710<>CALL    13714<>CALL
XSS$SYNC_MINOR.ERRDEF
      8268**DCL      8288--REDEF
XSS$SYNC_MINOR.SERNUM
      8364**DCL     13709<>CALL    13713<>CALL
XSS$TOKEN_GIVE.ERRDEF
      8465**DCL      8485--REDEF
XSS$TOKEN_PLEASE.DATA
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:118  
      8658**DCL     13721<>CALL
XSS$TOKEN_PLEASE.ERRDEF
      8595**DCL      8615--REDEF
XSS$TYPED_DATA.DATA
      8802**DCL     13729<>CALL
XSS$TYPED_DATA.ERRDEF
      8739**DCL      8759--REDEF
XSS$U_ABORT.DATA
      8946**DCL     13733<>CALL
XSS$U_ABORT.ERRDEF
      8883**DCL      8903--REDEF
XSS$U_EXCEPTION_REPORT.DATA
      9095**DCL     13743<>CALL
XSS$U_EXCEPTION_REPORT.ERRDEF
      9032**DCL      9052--REDEF
XSS$U_EXCEPTION_REPORT.REASON
      9024**DCL     13737<>CALL
XSS_CCB$$
     13444**DCL     13449--IMP-PTR 13761>>CALL
XSS_E$ACTID
     12528**DCL     13785>>ASSIGN
XSS_E$BADCID
     12375**DCL     13491>>ASSIGN
XSS_E$BADFNC
     12426**DCL     13747>>ASSIGN
XSS_E$CALLED
     12630**DCL     13540<>CALL    13570<>CALL
XSS_E$CALLING
     12681**DCL     13532<>CALL    13563<>CALL    13599<>CALL
XSS_E$COMMON
     12732**DCL     13767>>ASSIGN
XSS_E$DATA
     12783**DCL     13770>>ASSIGN
XSS_E$FLOW
     12834**DCL     13501>>ASSIGN
XSS_E$ITOKENS
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:119  
     12885**DCL     13773>>ASSIGN
XSS_E$NODYNMEM
     12276**DCL     13589>>ASSIGN
XSS_E$OACTID
     12936**DCL     13788>>ASSIGN
XSS_E$RDONLYFPT
     12324**DCL     13471>>IF      13473<>CALL
XSS_E$REASON
     13089**DCL     13776>>ASSIGN
XSS_E$RESPONDING
     13140**DCL     13607<>CALL
XSS_E$SERNUM
     13242**DCL     13782>>ASSIGN
XSS_E$SFU
     13293**DCL     14282>>ASSIGN
XSS_E$STATE
     12477**DCL     13757>>ASSIGN
XSS_E$TOKENS
     13344**DCL     14285>>ASSIGN
XSS_E$TYPE
     13395**DCL     13779>>ASSIGN
XSS_TRACE
     13445**DCL     13641>>IF      13750>>IF
XSS_VBLK
     10320**DCL     13479>>ASSIGN
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:120  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=XSS$SESSION File=XSS$SESSION.:XSA1TSI                         WED 10/01/97 12:21 Page:121  
              MINI UREF LISTING

BYTES   13448**DCL
K$SSAP    2516**DCL
XSS$SESSION      22**PROC
XSS_E$ARI   12579**DCL
XSS_E$OSCID   12987**DCL
XSS_E$QOS   13038**DCL
XSS_E$RESULT   13191**DCL
