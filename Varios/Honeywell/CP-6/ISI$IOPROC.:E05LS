VERSION E05

PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        /*X* PLM=8,IND=2,THI=2,ENU=2,CSU=2,DTI=4,DCI=4,ECU=4,AND */
        7        7        DOIOX:  PROC(INDX,COMMAND$,TIME_OUT,L);
        8        8        /* This procedure issues the I/O operation */
        9        9        /* Calling sequence :CALL DOIOX  If PSI interface
       10       10                             CALL DOIO   If standard intreface */
       11       11        /* INDX Index in DEVINFO,
       12       12           COMMAND$ Pointer to the command area,
       13       13           TIME_OUT Eventually time_out value */
       14       14        /* The command area has the following structure:
       15       15                   Address of IDCW or PCW
       16       16                   DCW                                  */
       17       17        /**/
       18       18        %INCLUDE IS$MACROS;
       19     1293    1   DCL INDX UBIN WORD;
       20     1294    1   DCL COMMAND$ PTR;
       21     1295    1   DCL TIME_OUT UBIN WORD;
       22     1296    1   DCL L UBIN WORD;
       23     1297        /**/
       24     1298    1   DCL START_IO ENTRY(1);
       25     1299    1   DCL CLEAR_CACHE ENTRY;
       26     1300    1   DCL WT_TIME ENTRY(1);
       27     1301        /**/
       28     1302        %DEVINFO(STCLASS="SYMREF");
       29     1371        %IOM_TAB(NAME=IOMTAB,STCLASS="SYMREF");
       30     1388        %DCW_STRUCT(NAME=DCW,STCLASS="BASED(DCW$)");
       31     1406        %CHANMBOX(NAME=CMBOX);
       32     1431        /**/
       33     1432        %PTR_STRUCT(NAME=CON_PTR);              /* Pointer to connect chann mailbox   */
       34     1450    1   DCL CON$ REDEF CON_PTR PTR;
       35     1451        %PTR_STRUCT(NAME=PAYLD_PTR);            /*Pointer to payload chann mailbox    */
       36     1469    1   DCL PAYLD$ REDEF PAYLD_PTR PTR;
       37     1470        %PTR_STRUCT(NAME=DCW_PTR);
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:2    
       38     1488    1   DCL DCW$ REDEF DCW_PTR PTR;
       39     1489        %PTR_STRUCT(NAME=IMW_PTR);
       40     1507    1   DCL IMW$ REDEF IMW_PTR PTR;
       41     1508        /**/
       42     1509    1   DCL CHAN$ PTR;
       43     1510    1   DCL PCW$ PTR;
       44     1511    1   DCL INT_IDCW$ PTR;
       45     1512        /**/
       46     1513    1   DCL INT_TIME UBIN WORD;                 /* Time_out value                     */
       47     1514    1   DCL 1 COMZONE BASED(COMMAND$),
       48     1515    1         2 IDCW$ PTR,
       49     1516    1         2 DCW BIT(36);                    /* DOIO Command area                  */
       50     1517    1   DCL 1 IDCW BASED(INT_IDCW$) ALIGNED,
       51     1518    1         2 CHINFO1 BIT(6),
       52     1519    1         2 DEV# UBIN(6) UNAL,
       53     1520    1         2 ADEXT BIT(6),
       54     1521    1         2 TYPE BIT(3),
       55     1522    1         2 EC BIT(1),
       56     1523    1         2 CHINFO2 BIT(14);
       57     1524    1   DCL 1 SAVE_CONMBOX DALIGNED,
       58     1525    1         2 W1 BIT(36),
       59     1526    1         2 W2 BIT(36);                     /* Connect mailbox save area          */
       60     1527    1   DCL SAVE_PMBOX(0:3) BIT(36) ALIGNED;    /*Payld chan mailbox save area*/
       61     1528    1   DCL IMWCEL(0:31) BIT(1) BASED(IMW$) UNAL;
       62     1529        /**/
       63     1530        /* Effective DCW's area */
       64     1531    1   DCL SIDCW BIT(36) STATIC ALIGNED;
       65     1532    1   DCL SIDCW1 BIT(36) STATIC ALIGNED;
       66     1533    1   DCL SIDCW2 BIT(36) STATIC ALIGNED;
       67     1534    1   DCL SIDCW3 BIT(36) STATIC ALIGNED;
       68     1535        /**/
       69     1536    1   DCL ADDREXT BIT(1) SYMREF;
       70     1537    1   DCL ADDREXT1 BIT(1) SYMREF;
       71     1538    1   DCL RD_FW_FLG BIT(1) SYMREF;
       72     1539    1   DCL DISK_FLG BIT(1) SYMREF;
       73     1540    1   DCL SKIDCW BIT(36) SYMREF;
       74     1541    1   DCL SKDCW BIT(36) SYMREF;
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:3    
       75     1542    1   DCL IMWBASE UBIN WORD SYMREF;
       76     1543    1   DCL I$CHAIN$ PTR SYMREF;
       77     1544    1   DCL POBUF CHAR(1024) SYMREF;
       78     1545    1   DCL USBUF CHAR(1024) BASED;
       79     1546        /**/
       80     1547    1   DCL PSI_FLG BIT(1) STATIC SYMDEF INIT('0'B);
       81     1548    1   DCL PORT# UBIN WORD;
       82     1549    1   DCL I UBIN WORD;
       83     1550        /**/
       84     1551        /**/
       85     1552        /* Declarations specific to RPM DOIO */
       86     1553        /**/
       87     1554    1   DCL START_IO_RPM ENTRY(2);
       88     1555        /**/
       89     1556        %IMX_MBX(NAME=MBX,STCLASS="BASED(MAILBOX$)");
       90     1613    1   DCL MAILBOX$ PTR;
       91     1614    1   DCL EF_DCWS$ PTR;
       92     1615        /**/
       93     1616    1   DCL LOGIC_CHAN UBIN WORD;               /*For START_IO                        */
       94     1617        /**/
       95     1618    1   DCL 1 EF_DCWS BASED(EF_DCWS$) ALIGNED,
       96     1619    1         2 DCW0,
       97     1620    1           3 OPCODE BIT(6),
       98     1621    1           3 DEV# UBIN(6) UNAL,
       99     1622    1           3 ADEXT BIT(6),
      100     1623    1           3 TYPE BIT(3),
      101     1624    1           3 EC BIT(1),
      102     1625    1           3 CONT BIT(1),
      103     1626    1           3 MARK BIT(1),
      104     1627    1           3 * BIT(12),
      105     1628    1         2 DCW1 BIT(36),
      106     1629    1         2 DCW2 BIT(36),
      107     1630    1         2 DCW3 BIT(36);
      108     1631    1   DCL RPM_FLG BIT(1) SYMREF;
      109     1632        /**/
      110     1633        /** Code **/
      111     1634    1           PSI_FLG='1'B;
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:4    
      112     1635    1   DOIO:   ENTRY(INDX,COMMAND$,TIME_OUT,L);
      113     1636    1           IF RPM_FLG THEN GOTO DOIO_RPM;
      114     1637    1           INT_IDCW$=COMZONE.IDCW$;
      115     1638        /* Find Payload channel mailbox */
      116     1639    1           PAYLD_PTR.WOFFS=IOMTAB.MAILBAD(DEVINFO.IOM#(INDX))+4*(DEVINFO.CHN#(INDX));
      117     1640        /* Find Connect channel mailbox */
      118     1641    1           CON_PTR.WOFFS=IOMTAB.MAILBAD(DEVINFO.IOM#(INDX))+2*4;
      119     1642        /* Wait a while for the connect channel to go non_busy */
      120     1643    1           CHAN$=CON$;
      121     1644    1           IF CMBOX.W4='0'B THEN;          /* Not the first MINI IO              */
      122     1645    2             ELSE DO ;
      123     1646    2                 CMBOX.W4='0'B;
      124     1647    2                 CALL WT_TIME(1000000);    /* Wait a sec                         */
      125     1648    2               END;                        /* ELSE                               */
      126     1649    1           IF CMBOX.W1.H2.TALLY=0 THEN;    /* Tally=0,chann free                 */
      127     1650    2             ELSE DO I=0 TO 4000;
      128     1651    2               END;                        /* ELSE                               */
      129     1652        /* Build PCW */
      130     1653    1           DEVINFO.PCWS.PCW1.CHINFO1(INDX)=IDCW.CHINFO1;
      131     1654    1           DEVINFO.PCWS.PCW1.CHINFO2(INDX)=IDCW.CHINFO2;
      132     1655    1           DEVINFO.PCWS.PCW1.M(INDX)='0'B;
      133     1656    1           IF ADDREXT='0'B THEN;           /* No address extention               */
      134     1657    2             ELSE DO;
      135     1658    2                 ADDREXT='0'B;
      136     1659    2                 DEVINFO.PCWS.PCW1.ADEXT(INDX)='1'B;
      137     1660    2               END;                        /* ELSE                               */
      138     1661    1           DEVINFO.PCWS.PCW1.DEV#(INDX)=DEVINFO.DEV#(INDX);
      139     1662    1           DEVINFO.PCWS.PCW2.CHN#(INDX)=DEVINFO.CHN#(INDX);
      140     1663        /**/
      141     1664        /* Save connect mailbox 1,2 */
      142     1665    1           SAVE_CONMBOX.W1=CMBOX.W1;
      143     1666    1           SAVE_CONMBOX.W2=CMBOX.W2;
      144     1667        /* Build LPW,LPWX words for connect channel */
      145     1668    1           CMBOX.LPW$=ADDR(DEVINFO.PCWS.PCW1(INDX));
      146     1669    1           CMBOX.W1.H2.TAL='1'B;
      147     1670    1           CMBOX.W1.H2.TALLY=1;
      148     1671    1           CMBOX.W2.H2='777777'O;          /* LPWX                               */
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:5    
      149     1672        /* Set up payload channel mailbox */
      150     1673    1           CHAN$=PAYLD$;
      151     1674    1           SAVE_PMBOX=CMBOX;
      152     1675    1           CMBOX.SCW$=ADDR(DEVINFO.STATUS(INDX)); /* SCW                         */
      153     1676    1           CMBOX.W3.H2='0'B;
      154     1677    1           CMBOX.W2.H1='0'B;               /* LPWX                               */
      155     1678    1           CMBOX.W2.H2='777777'O;
      156     1679    1           CMBOX.W4='0'B;                  /* DCW                                */
      157     1680    1           DCW$=ADDR(COMZONE.DCW);
      158     1681    1   FIND_DCW:;
      159     1682    2           IF DCW.TYPE='10'B THEN DO;      /* TDCW,look for DCW                  */
      160     1683    2                 DCW_PTR.WOFFS=DCW.AD;
      161     1684    2                 GOTO FIND_DCW;
      162     1685    2               END;                        /* THEN                               */
      163     1686    1             ELSE;
      164     1687    2           IF PSI_FLG='1'B THEN DO;        /* PSI, set IDCW                      */
      165     1688    2                 PSI_FLG='0'B;
      166     1689    2                 SIDCW=DEVINFO.PCWS.PCW1(INDX);
      167     1690    2                 IF DEVINFO.PCWS.PCW1.ADEXT(INDX)='0'B THEN; /* No address extention */
      168     1691    2                   ELSE SIDCW=SIDCW|'040000'O; /*Set EC bit in IDCW              */
      169     1692    2                 DEVINFO.PCWS.PCW1(INDX)='0'B;
      170     1693    2                 DEVINFO.PCWS.PCW1.PCWID(INDX)='7'O;
      171     1694    3                 IF RD_FW_FLG='1'B THEN DO; /* Read FW                           */
      172     1695    3                       SIDCW1=DCW;
      173     1696    3                       GOTO DODCWAD;
      174     1697    3                     END;                  /* THEN                               */
      175     1698    2                   ELSE;
      176     1699        /* In SIDCW1,build a TDCW */
      177     1700    2                 SIDCW1=DCW_PTR;           /* Pointer to the DCW                 */
      178     1701    2                 DCW$=ADDR(SIDCW1);
      179     1702    2                 DCW.TALLY=0;
      180     1703    2                 DCW.TYPE='10'B;           /* Make it a TDCW                     */
      181     1704    3                 IF DISK_FLG='1'B THEN DO; /* DISK I/O                           */
      182     1705        /* Make room for SEEK */
      183     1706    3                       SIDCW2=SIDCW;
      184     1707    3                       SIDCW3=SIDCW1;
      185     1708    3                       SIDCW=SIDCW&'007777737777'O|SKIDCW;
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:6    
              1708                                /*Mask out READ or WRITE and bit 21,
      186     1709                                           and make it a SEEK with continue */
      187     1710    3                       SIDCW1=SKDCW;
      188     1711    3                     END;                  /* THEN                               */
      189     1712    2                   ELSE;
      190     1713    2   DODCWAD:      ;
      191     1714    2                 DCW$=ADDR(SIDCW);
      192     1715    2               END;                        /* THEN                               */
      193     1716    1             ELSE;
      194     1717    1           CMBOX.LPW$=DCW$;
      195     1718    1           CMBOX.W1.H2.TALLY=4095;
      196     1719    1           DEVINFO.STATUS(INDX)='0'B;      /* Clear Status words                 */
      197     1720    1           I=DEVINFO.CHN#(INDX);           /* See if channel 0-31 or 32-63       */
      198     1721    1           IF I<32 THEN
      199     1722    1             IMW_PTR.WOFFS=IMWBASE+DEVINFO.IOM#(INDX)+12;/*For channels 0-31*/
      200     1723    2             ELSE DO;
      201     1724    2                 I=I-32;
      202     1725    2                 IMW_PTR.WOFFS=IMWBASE+DEVINFO.IOM#(INDX)+8;/*For channels 32-63 */
      203     1726    2               END;                        /* ELSE                               */
      204     1727    1           IMWCEL(I)='0'B;                 /*Turn INT bit off                    */
      205     1728    1           PORT#=IOMTAB.PORT#(DEVINFO.IOM#(INDX));
      206     1729    1           CALL START_IO(PORT#);
      207     1730    1           CHAN$=CON$;
      208     1731        /* Wait until connect channel non_busy */
      209     1732    2           DO UNTIL CMBOX.W1.H2.TALLY=0;
      210     1733    2           END;                            /* DO                                 */
      211     1734    2           IF ADDR(TIME_OUT)~=ADDR(NIL) THEN DO; /* Time_out required            */
      212     1735    2                 INT_TIME=TIME_OUT;
      213     1736    3                 DO UNTIL INT_TIME=0;
      214     1737    3                   INT_TIME=INT_TIME-1;
      215     1738    3                   IF DEVINFO.STATUS.TBIT(INDX)='1'B THEN GOTO IOTERM;
              1738                            /* IO finished */
      216     1739    3                     ELSE;
      217     1740    3                 END;                      /* DO UNTIL                           */
      218     1741    2                 GOTO IODONE;
      219     1742    2               END;                        /* THEN                               */
      220     1743    2             ELSE DO UNTIL DEVINFO.STATUS.TBIT(INDX)='1'B;
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:7    
      221     1744    2               END;                        /* ELSE                               */
      222     1745        /* Wait for INT bit,then turn it off */
      223     1746    1   IOTERM: ;
      224     1747    2           DO UNTIL IMWCEL(I)='1'B;
      225     1748    2           END;                            /* DO                                 */
      226     1749    1           IMWCEL(I)='0'B;
      227     1750    1   IODONE: ;
      228     1751    1           CALL CLEAR_CACHE;
      229     1752    2           IF ADDREXT1='1'B THEN DO;       /*Buffer cross 256 K                  */
      230     1753    2                 ADDREXT1='0'B;
      231     1754        /* Move POBUF into buffer */
      232     1755    2                 SUBSTR(I$CHAIN$->USBUF,0,L)=SUBSTR(POBUF,0,L);
      233     1756    2               END;                        /*THEN                                */
      234     1757    1             ELSE;
      235     1758        /* Restore mailboxes */
      236     1759    1           CHAN$=CON$;
      237     1760    1           CMBOX.W1=SAVE_CONMBOX.W1;
      238     1761    1           CMBOX.W2=SAVE_CONMBOX.W2;
      239     1762    1           CHAN$=PAYLD$;
      240     1763    1           CMBOX=SAVE_PMBOX;
      241     1764    1           PSI_FLG='0'B;                   /* Restore flag                       */
      242     1765    1           RETURN;
      243     1766    1   DOIO_RPM: ;
      244     1767        /* This program issues the I/O operation  on an IMX */
      245     1768        /* INDX Index in DEVINFO,
      246     1769           COMMAND$ Pointer to the command area,
      247     1770           TIME_OUT Eventually time_out value */
      248     1771        /**/
      249     1772        /**/
      250     1773        /** Code **/
      251     1774    1           MAILBOX$=DEVINFO.RPM_PTRS.MBX$(INDX);
      252     1775        /* Init Mailbox */
      253     1776    1           MBX.LPW.DCW_ADDR=DEVINFO.RPM_PTRS.EF_DCWS_PTR.WOFFS(INDX);
              1776                    /* Set LPW to point to respective DCWs */
      254     1777    1           EF_DCWS$=DEVINFO.RPM_PTRS.EF_DCWS$(INDX);
      255     1778    1           DCW$=ADDR(COMZONE.DCW);
      256     1779    2           DO WHILE DCW.TYPE='10'B ;       /* TDCW,look for DCW                  */
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:8    
      257     1780    2             DCW_PTR.WOFFS=DCW.AD;
      258     1781    2           END;
      259     1782    1           EF_DCWS.DCW0=COMZONE.IDCW$->DCW;
      260     1783    1           EF_DCWS.DCW0.DEV#=DEVINFO.DEV#(INDX);
      261     1784    1           EF_DCWS.DCW0.TYPE='7'O;
      262     1785    2           IF RD_FW_FLG='1'B THEN DO;      /* Read FW                            */
      263     1786    2                 EF_DCWS.DCW1=DCW;
      264     1787    2                 GOTO R_DODCWAD;
      265     1788    2               END;                        /* THEN                               */
      266     1789    1             ELSE;
      267     1790        /* In DCW1,build a TDCW */
      268     1791    1           EF_DCWS.DCW1=DCW_PTR;           /* Pointer to the DCW                 */
      269     1792    1           DCW$=ADDR(EF_DCWS.DCW1);
      270     1793    1           DCW.TALLY=0;
      271     1794    1           DCW.TYPE='10'B;                 /* Make it a TDCW                     */
      272     1795    2           IF DISK_FLG='1'B THEN DO;       /* DISK I/O                           */
      273     1796        /* Make room for SEEK */
      274     1797    2                 EF_DCWS.DCW2=EF_DCWS.DCW0;
      275     1798    2                 EF_DCWS.DCW3=EF_DCWS.DCW1;
      276     1799    2                 EF_DCWS.DCW0.OPCODE='34'O; /*Make it a SEEK                     */
      277     1800    2                 EF_DCWS.DCW0.CONT='1'B;   /*with continue                       */
      278     1801    2                 EF_DCWS.DCW1=SKDCW;
      279     1802    2               END;                        /* THEN                               */
      280     1803    1             ELSE;
      281     1804    1   R_DODCWAD: ;
      282     1805        /*  Clear STATUS WORDS */
      283     1806    1           MBX.STATUS='0'B;
      284     1807    1           MBX.CHN_LINK.SYNC='0'B;         /* Reset SYNC                         */
      285     1808    1           LOGIC_CHAN=128*DEVINFO.IOM#(INDX)+DEVINFO.CHN#(INDX)+8;
      286     1809    1           CALL START_IO_RPM(LOGIC_CHAN,MAILBOX$);
      287     1810    2           IF ADDR(TIME_OUT)~=ADDR(NIL) THEN DO; /* TIMEOUT required             */
      288     1811    2                 INT_TIME=TIME_OUT;
      289     1812    3                 DO UNTIL INT_TIME=0;
      290     1813    3                   INT_TIME=INT_TIME-1;
      291     1814    3                   IF MBX.STATUS.W8.TBIT THEN GOTO R_IOTERM;
      292     1815    3                 END;
      293     1816    2                 GOTO R_IODONE;
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:9    
      294     1817    2               END;
      295     1818    1             ELSE
      296     1819    2             IF INDX = 0 THEN DO;
      297     1820    2                   INT_TIME = 36000000;
      298     1821    3                   DO UNTIL INT_TIME = 0;
      299     1822    3                     INT_TIME = INT_TIME-1;
      300     1823    3                     IF MBX.STATUS.W8.TBIT THEN GOTO R_IOTERM;
      301     1824    3                   END;
      302     1825    2                   GOTO R_DODCWAD;
      303     1826    2                 END;
      304     1827    2               ELSE DO UNTIL MBX.STATUS.W8.TBIT='1'B;
      305     1828    2                 END;
      306     1829    1   R_IOTERM:;
      307     1830    2           DO UNTIL MBX.CHN_LINK.SYNC='1'B;
      308     1831    2           END;
      309     1832    1   R_IODONE:;
      310     1833    1           MBX.CHN_LINK.SYNC='0'B;
      311     1834    1           CALL CLEAR_CACHE;
      312     1835        /*  Move STATUS in DEVINFO */
      313     1836    1           DEVINFO.BSTAT.W1(INDX)=MBX.STATUS.W8;
      314     1837    1           DEVINFO.BSTAT.W2(INDX)=MBX.STATUS.W11;
      315     1838    1           RETURN;
      316     1839    1   END DOIOX;
      317     1840        /**/
      318     1841        %EJECT;
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:10   
      319     1842        %EOD;

PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:11   
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure DOIOX.

   Procedure DOIOX requires 520 words for executable code.
   Procedure DOIOX requires 26 words of local(AUTO) storage.

PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:12   

 Object Unit name= DOIOX                                      File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:51:57.08 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     9     11  DOIOX
    1  RoData even  UTS      1      1  DOIOX
    2   Proc  even  none   520   1010  DOIOX
    3  RoData even  none    11     13  DOIOX

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        4  DOIOX
     2      5                  yes      Std        4  DOIO

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  CON_PTR                            0      1  PAYLD_PTR
    0      2  DCW_PTR                            0      3  IMW_PTR
    0     10  PSI_FLG
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:13   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 WT_TIME
         yes           Std       0 CLEAR_CACHE
         yes           Std       2 START_IO_RPM
         yes           Std       1 START_IO
                       nStd      0 X66_AUTO_4
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DEVINFO                               IOMTAB                                ADDREXT
     ADDREXT1                              RD_FW_FLG                             DISK_FLG
     SKIDCW                                SKDCW                                 IMWBASE
     I$CHAIN$                              POBUF                                 RPM_FLG
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:14   


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        /*X* PLM=8,IND=2,THI=2,ENU=2,CSU=2,DTI=4,DCI=4,ECU=4,AND */
        7        7        DOIOX:  PROC(INDX,COMMAND$,TIME_OUT,L);

      7  2 000000   000000 700200 xent  DOIOX        TSX0  ! X66_AUTO_4
         2 000001   000032 000004                    ZERO    26,4

        8        8        /* This procedure issues the I/O operation */
        9        9        /* Calling sequence :CALL DOIOX  If PSI interface
       10       10                             CALL DOIO   If standard intreface */
       11       11        /* INDX Index in DEVINFO,
       12       12           COMMAND$ Pointer to the command area,
       13       13           TIME_OUT Eventually time_out value */
       14       14        /* The command area has the following structure:
       15       15                   Address of IDCW or PCW
       16       16                   DCW                                  */
       17       17        /**/
       18       18        %INCLUDE IS$MACROS;
       19     1293    1   DCL INDX UBIN WORD;
       20     1294    1   DCL COMMAND$ PTR;
       21     1295    1   DCL TIME_OUT UBIN WORD;
       22     1296    1   DCL L UBIN WORD;
       23     1297        /**/
       24     1298    1   DCL START_IO ENTRY(1);
       25     1299    1   DCL CLEAR_CACHE ENTRY;
       26     1300    1   DCL WT_TIME ENTRY(1);
       27     1301        /**/
       28     1302        %DEVINFO(STCLASS="SYMREF");
       29     1371        %IOM_TAB(NAME=IOMTAB,STCLASS="SYMREF");
       30     1388        %DCW_STRUCT(NAME=DCW,STCLASS="BASED(DCW$)");
       31     1406        %CHANMBOX(NAME=CMBOX);
       32     1431        /**/
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:15   
       33     1432        %PTR_STRUCT(NAME=CON_PTR);              /* Pointer to connect chann mailbox   */
       34     1450    1   DCL CON$ REDEF CON_PTR PTR;
       35     1451        %PTR_STRUCT(NAME=PAYLD_PTR);            /*Pointer to payload chann mailbox    */
       36     1469    1   DCL PAYLD$ REDEF PAYLD_PTR PTR;
       37     1470        %PTR_STRUCT(NAME=DCW_PTR);
       38     1488    1   DCL DCW$ REDEF DCW_PTR PTR;
       39     1489        %PTR_STRUCT(NAME=IMW_PTR);
       40     1507    1   DCL IMW$ REDEF IMW_PTR PTR;
       41     1508        /**/
       42     1509    1   DCL CHAN$ PTR;
       43     1510    1   DCL PCW$ PTR;
       44     1511    1   DCL INT_IDCW$ PTR;
       45     1512        /**/
       46     1513    1   DCL INT_TIME UBIN WORD;                 /* Time_out value                     */
       47     1514    1   DCL 1 COMZONE BASED(COMMAND$),
       48     1515    1         2 IDCW$ PTR,
       49     1516    1         2 DCW BIT(36);                    /* DOIO Command area                  */
       50     1517    1   DCL 1 IDCW BASED(INT_IDCW$) ALIGNED,
       51     1518    1         2 CHINFO1 BIT(6),
       52     1519    1         2 DEV# UBIN(6) UNAL,
       53     1520    1         2 ADEXT BIT(6),
       54     1521    1         2 TYPE BIT(3),
       55     1522    1         2 EC BIT(1),
       56     1523    1         2 CHINFO2 BIT(14);
       57     1524    1   DCL 1 SAVE_CONMBOX DALIGNED,
       58     1525    1         2 W1 BIT(36),
       59     1526    1         2 W2 BIT(36);                     /* Connect mailbox save area          */
       60     1527    1   DCL SAVE_PMBOX(0:3) BIT(36) ALIGNED;    /*Payld chan mailbox save area*/
       61     1528    1   DCL IMWCEL(0:31) BIT(1) BASED(IMW$) UNAL;
       62     1529        /**/
       63     1530        /* Effective DCW's area */
       64     1531    1   DCL SIDCW BIT(36) STATIC ALIGNED;
       65     1532    1   DCL SIDCW1 BIT(36) STATIC ALIGNED;
       66     1533    1   DCL SIDCW2 BIT(36) STATIC ALIGNED;
       67     1534    1   DCL SIDCW3 BIT(36) STATIC ALIGNED;
       68     1535        /**/
       69     1536    1   DCL ADDREXT BIT(1) SYMREF;
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:16   
       70     1537    1   DCL ADDREXT1 BIT(1) SYMREF;
       71     1538    1   DCL RD_FW_FLG BIT(1) SYMREF;
       72     1539    1   DCL DISK_FLG BIT(1) SYMREF;
       73     1540    1   DCL SKIDCW BIT(36) SYMREF;
       74     1541    1   DCL SKDCW BIT(36) SYMREF;
       75     1542    1   DCL IMWBASE UBIN WORD SYMREF;
       76     1543    1   DCL I$CHAIN$ PTR SYMREF;
       77     1544    1   DCL POBUF CHAR(1024) SYMREF;
       78     1545    1   DCL USBUF CHAR(1024) BASED;
       79     1546        /**/
       80     1547    1   DCL PSI_FLG BIT(1) STATIC SYMDEF INIT('0'B);
       81     1548    1   DCL PORT# UBIN WORD;
       82     1549    1   DCL I UBIN WORD;
       83     1550        /**/
       84     1551        /**/
       85     1552        /* Declarations specific to RPM DOIO */
       86     1553        /**/
       87     1554    1   DCL START_IO_RPM ENTRY(2);
       88     1555        /**/
       89     1556        %IMX_MBX(NAME=MBX,STCLASS="BASED(MAILBOX$)");
       90     1613    1   DCL MAILBOX$ PTR;
       91     1614    1   DCL EF_DCWS$ PTR;
       92     1615        /**/
       93     1616    1   DCL LOGIC_CHAN UBIN WORD;               /*For START_IO                        */
       94     1617        /**/
       95     1618    1   DCL 1 EF_DCWS BASED(EF_DCWS$) ALIGNED,
       96     1619    1         2 DCW0,
       97     1620    1           3 OPCODE BIT(6),
       98     1621    1           3 DEV# UBIN(6) UNAL,
       99     1622    1           3 ADEXT BIT(6),
      100     1623    1           3 TYPE BIT(3),
      101     1624    1           3 EC BIT(1),
      102     1625    1           3 CONT BIT(1),
      103     1626    1           3 MARK BIT(1),
      104     1627    1           3 * BIT(12),
      105     1628    1         2 DCW1 BIT(36),
      106     1629    1         2 DCW2 BIT(36),
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:17   
      107     1630    1         2 DCW3 BIT(36);
      108     1631    1   DCL RPM_FLG BIT(1) SYMREF;
      109     1632        /**/
      110     1633        /** Code **/
      111     1634    1           PSI_FLG='1'B;

   1634  2 000002   400000 236003                    LDQ     -131072,DU
         2 000003   000010 756000 0                  STQ     PSI_FLG
         2 000004   000007 710000 2                  TRA     s:1636

      112     1635    1   DOIO:   ENTRY(INDX,COMMAND$,TIME_OUT,L);

   1635  2 000005   000000 700200 xent  DOIO         TSX0  ! X66_AUTO_4
         2 000006   000032 000004                    ZERO    26,4

      113     1636    1           IF RPM_FLG THEN GOTO DOIO_RPM;

   1636  2 000007   000000 234000 xsym               SZN     RPM_FLG
         2 000010   000542 604000 2                  TMI     DOIO_RPM

      114     1637    1           INT_IDCW$=COMZONE.IDCW$;

   1637  2 000011   200004 470500                    LDP0    @COMMAND$,,AUTO
         2 000012   000000 471500                    LDP1    0,,PR0
         2 000013   100000 236100                    LDQ     0,,PR1
         2 000014   200011 756100                    STQ     INT_IDCW$,,AUTO

      115     1638        /* Find Payload channel mailbox */
      116     1639    1           PAYLD_PTR.WOFFS=IOMTAB.MAILBAD(DEVINFO.IOM#(INDX))+4*(DEVINFO.CHN#(INDX));

   1639  2 000015   200003 473500                    LDP3    @INDX,,AUTO
         2 000016   300000 236100                    LDQ     0,,PR3
         2 000017   000006 402007                    MPY     6,DL
         2 000020   000001 736000                    QLS     1
         2 000021   000000 236006 xsym               LDQ     DEVINFO,QL
         2 000022   000023 772000                    QRL     19
         2 000023   000003 376007                    ANQ     3,DL
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:18   
         2 000024   000000 620006                    EAX0    0,QL
         2 000025   300000 236100                    LDQ     0,,PR3
         2 000026   000006 402007                    MPY     6,DL
         2 000027   000000 621006                    EAX1    0,QL
         2 000030   000000 236010 xsym               LDQ     IOMTAB,X0
         2 000031   000022 772000                    QRL     18
         2 000032   200030 756100                    STQ     LOGIC_CHAN+2,,AUTO
         2 000033   000000 635011                    EAA     0,X1
         2 000034   000021 771000                    ARL     17
         2 000035   000000 236005 xsym               LDQ     DEVINFO,AL
         2 000036   000031 772000                    QRL     25
         2 000037   003774 376007                    ANQ     2044,DL
         2 000040   200030 036100                    ADLQ    LOGIC_CHAN+2,,AUTO
         2 000041   000000 620006                    EAX0    0,QL
         2 000042   000001 740000 0                  STX0    PAYLD_PTR

      117     1640        /* Find Connect channel mailbox */
      118     1641    1           CON_PTR.WOFFS=IOMTAB.MAILBAD(DEVINFO.IOM#(INDX))+2*4;

   1641  2 000043   300000 236100                    LDQ     0,,PR3
         2 000044   000006 402007                    MPY     6,DL
         2 000045   000001 736000                    QLS     1
         2 000046   000000 236006 xsym               LDQ     DEVINFO,QL
         2 000047   000023 772000                    QRL     19
         2 000050   000003 376007                    ANQ     3,DL
         2 000051   000000 221006 xsym               LDX1    IOMTAB,QL
         2 000052   000010 622011                    EAX2    8,X1
         2 000053   000000 742000 0                  STX2    CON_PTR

      119     1642        /* Wait a while for the connect channel to go non_busy */
      120     1643    1           CHAN$=CON$;

   1643  2 000054   000000 236000 0                  LDQ     CON_PTR
         2 000055   200007 756100                    STQ     CHAN$,,AUTO

      121     1644    1           IF CMBOX.W4='0'B THEN;          /* Not the first MINI IO              */

PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:19   
   1644  2 000056   200007 471500                    LDP1    CHAN$,,AUTO
         2 000057   100003 235100                    LDA     3,,PR1
         2 000060   000066 600000 2                  TZE     s:1649

      122     1645    2             ELSE DO ;

      123     1646    2                 CMBOX.W4='0'B;

   1646  2 000061   100003 450100                    STZ     3,,PR1

      124     1647    2                 CALL WT_TIME(1000000);    /* Wait a sec                         */

   1647  2 000062   000001 630400 3                  EPPR0   1
         2 000063   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000064   000000 701000 xent               TSX1    WT_TIME
         2 000065   000000 011000                    NOP     0

      125     1648    2               END;                        /* ELSE                               */

      126     1649    1           IF CMBOX.W1.H2.TALLY=0 THEN;    /* Tally=0,chann free                 */

   1649  2 000066   200007 470500                    LDP0    CHAN$,,AUTO
         2 000067   000000 236100                    LDQ     0,,PR0
         2 000070   007777 316007                    CANQ    4095,DL
         2 000071   000100 600000 2                  TZE     s:1653

      127     1650    2             ELSE DO I=0 TO 4000;

   1650  2 000072   200023 450100                    STZ     I,,AUTO

      128     1651    2               END;                        /* ELSE                               */

   1651  2 000073   200023 235100                    LDA     I,,AUTO
         2 000074   000001 035007                    ADLA    1,DL
         2 000075   200023 755100                    STA     I,,AUTO
         2 000076   007641 115007                    CMPA    4001,DL
         2 000077   000073 602000 2                  TNC     s:1651
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:20   

      129     1652        /* Build PCW */
      130     1653    1           DEVINFO.PCWS.PCW1.CHINFO1(INDX)=IDCW.CHINFO1;

   1653  2 000100   200003 470500                    LDP0    @INDX,,AUTO
         2 000101   000000 236100                    LDQ     0,,PR0
         2 000102   000006 402007                    MPY     6,DL
         2 000103   000001 736000                    QLS     1
         2 000104   200011 471500                    LDP1    INT_IDCW$,,AUTO
         2 000105   000000 620006                    EAX0    0,QL
         2 000106   100000 236100                    LDQ     0,,PR1
         2 000107   000002 676010 xsym               ERQ     DEVINFO+2,X0
         2 000110   770000 376003                    ANQ     -4096,DU
         2 000111   000002 656010 xsym               ERSQ    DEVINFO+2,X0

      131     1654    1           DEVINFO.PCWS.PCW1.CHINFO2(INDX)=IDCW.CHINFO2;

   1654  2 000112   000000 236100                    LDQ     0,,PR0
         2 000113   000006 402007                    MPY     6,DL
         2 000114   000001 736000                    QLS     1
         2 000115   000000 620006                    EAX0    0,QL
         2 000116   100000 236100                    LDQ     0,,PR1
         2 000117   000002 676010 xsym               ERQ     DEVINFO+2,X0
         2 000120   037777 376007                    ANQ     16383,DL
         2 000121   000002 656010 xsym               ERSQ    DEVINFO+2,X0

      132     1655    1           DEVINFO.PCWS.PCW1.M(INDX)='0'B;

   1655  2 000122   000000 236100                    LDQ     0,,PR0
         2 000123   000006 402007                    MPY     6,DL
         2 000124   000001 736000                    QLS     1
         2 000125   000000 620006                    EAX0    0,QL
         2 000126   000002 236000 3                  LDQ     2
         2 000127   000002 356010 xsym               ANSQ    DEVINFO+2,X0

      133     1656    1           IF ADDREXT='0'B THEN;           /* No address extention               */

PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:21   
   1656  2 000130   000000 234000 xsym               SZN     ADDREXT
         2 000131   000143 605000 2                  TPL     s:1661

      134     1657    2             ELSE DO;

      135     1658    2                 ADDREXT='0'B;

   1658  2 000132   000000 450000 xsym               STZ     ADDREXT

      136     1659    2                 DEVINFO.PCWS.PCW1.ADEXT(INDX)='1'B;

   1659  2 000133   000000 236100                    LDQ     0,,PR0
         2 000134   000006 402007                    MPY     6,DL
         2 000135   000001 736000                    QLS     1
         2 000136   000000 620006                    EAX0    0,QL
         2 000137   000002 236006 xsym               LDQ     DEVINFO+2,QL
         2 000140   000003 376000 3                  ANQ     3
         2 000141   000040 276003                    ORQ     32,DU
         2 000142   000002 756010 xsym               STQ     DEVINFO+2,X0

      137     1660    2               END;                        /* ELSE                               */

      138     1661    1           DEVINFO.PCWS.PCW1.DEV#(INDX)=DEVINFO.DEV#(INDX);

   1661  2 000143   000000 236100                    LDQ     0,,PR0
         2 000144   000006 402007                    MPY     6,DL
         2 000145   000001 736000                    QLS     1
         2 000146   000000 620006                    EAX0    0,QL
         2 000147   000000 236100                    LDQ     0,,PR0
         2 000150   000006 402007                    MPY     6,DL
         2 000151   000001 736000                    QLS     1
         2 000152   000000 236006 xsym               LDQ     DEVINFO,QL
         2 000153   000003 736000                    QLS     3
         2 000154   000002 676010 xsym               ERQ     DEVINFO+2,X0
         2 000155   007700 376003                    ANQ     4032,DU
         2 000156   000002 656010 xsym               ERSQ    DEVINFO+2,X0

PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:22   
      139     1662    1           DEVINFO.PCWS.PCW2.CHN#(INDX)=DEVINFO.CHN#(INDX);

   1662  2 000157   000000 236100                    LDQ     0,,PR0
         2 000160   000006 402007                    MPY     6,DL
         2 000161   000001 736000                    QLS     1
         2 000162   000000 620006                    EAX0    0,QL
         2 000163   000000 236100                    LDQ     0,,PR0
         2 000164   000006 402007                    MPY     6,DL
         2 000165   000001 736000                    QLS     1
         2 000166   000000 236006 xsym               LDQ     DEVINFO,QL
         2 000167   000003 676010 xsym               ERQ     DEVINFO+3,X0
         2 000170   777000 376003                    ANQ     -512,DU
         2 000171   000003 656010 xsym               ERSQ    DEVINFO+3,X0

      140     1663        /**/
      141     1664        /* Save connect mailbox 1,2 */
      142     1665    1           SAVE_CONMBOX.W1=CMBOX.W1;

   1665  2 000172   200007 473500                    LDP3    CHAN$,,AUTO
         2 000173   300000 236100                    LDQ     0,,PR3
         2 000174   200014 756100                    STQ     SAVE_CONMBOX,,AUTO

      143     1666    1           SAVE_CONMBOX.W2=CMBOX.W2;

   1666  2 000175   300001 236100                    LDQ     1,,PR3
         2 000176   200015 756100                    STQ     SAVE_CONMBOX+1,,AUTO

      144     1667        /* Build LPW,LPWX words for connect channel */
      145     1668    1           CMBOX.LPW$=ADDR(DEVINFO.PCWS.PCW1(INDX));

   1668  2 000177   000000 236100                    LDQ     0,,PR0
         2 000200   000006 402007                    MPY     6,DL
         2 000201   000023 736000                    QLS     19
         2 000202   000004 036000 3                  ADLQ    4
         2 000203   300000 756100                    STQ     0,,PR3

      146     1669    1           CMBOX.W1.H2.TAL='1'B;
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:23   

   1669  2 000204   020000 236007                    LDQ     8192,DL
         2 000205   300000 256100                    ORSQ    0,,PR3

      147     1670    1           CMBOX.W1.H2.TALLY=1;

   1670  2 000206   000001 236007                    LDQ     1,DL
         2 000207   300000 752103                    STCQ    0,'03'O,PR3

      148     1671    1           CMBOX.W2.H2='777777'O;          /* LPWX                               */

   1671  2 000210   777777 220003                    LDX0    -1,DU
         2 000211   300001 440100                    SXL0    1,,PR3

      149     1672        /* Set up payload channel mailbox */
      150     1673    1           CHAN$=PAYLD$;

   1673  2 000212   000001 236000 0                  LDQ     PAYLD_PTR
         2 000213   200007 756100                    STQ     CHAN$,,AUTO

      151     1674    1           SAVE_PMBOX=CMBOX;

   1674  2 000214   200007 473500                    LDP3    CHAN$,,AUTO
         2 000215   000100 100500                    MLR     fill='000'O
         2 000216   300000 000020                    ADSC9   0,,PR3                   cn=0,n=16
         2 000217   200016 000020                    ADSC9   SAVE_PMBOX,,AUTO         cn=0,n=16

      152     1675    1           CMBOX.SCW$=ADDR(DEVINFO.STATUS(INDX)); /* SCW                         */

   1675  2 000220   000000 236100                    LDQ     0,,PR0
         2 000221   000006 402007                    MPY     6,DL
         2 000222   000023 736000                    QLS     19
         2 000223   000005 036000 3                  ADLQ    5
         2 000224   300002 756100                    STQ     2,,PR3

      153     1676    1           CMBOX.W3.H2='0'B;

PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:24   
   1676  2 000225   000000 221003                    LDX1    0,DU
         2 000226   300002 441100                    SXL1    2,,PR3

      154     1677    1           CMBOX.W2.H1='0'B;               /* LPWX                               */

   1677  2 000227   300001 741100                    STX1    1,,PR3

      155     1678    1           CMBOX.W2.H2='777777'O;

   1678  2 000230   300001 440100                    SXL0    1,,PR3

      156     1679    1           CMBOX.W4='0'B;                  /* DCW                                */

   1679  2 000231   300003 450100                    STZ     3,,PR3

      157     1680    1           DCW$=ADDR(COMZONE.DCW);

   1680  2 000232   200004 474500                    LDP4    @COMMAND$,,AUTO
         2 000233   400000 475500                    LDP5    0,,PR4
         2 000234   500001 636500                    EPPR6   1,,PR5
         2 000235   000002 456400 0                  STP6    DCW_PTR

   1680  2 000236                       FIND_DCW     null
      158     1681    1   FIND_DCW:;
      159     1682    2           IF DCW.TYPE='10'B THEN DO;      /* TDCW,look for DCW                  */

   1682  2 000236   000002 470400 0                  LDP0    DCW_PTR
         2 000237   000000 236100                    LDQ     0,,PR0
         2 000240   030000 376007                    ANQ     12288,DL
         2 000241   020000 116007                    CMPQ    8192,DL
         2 000242   000246 601000 2                  TNZ     s:1687

      160     1683    2                 DCW_PTR.WOFFS=DCW.AD;

   1683  2 000243   000000 220100                    LDX0    0,,PR0
         2 000244   000002 740000 0                  STX0    DCW_PTR

PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:25   
      161     1684    2                 GOTO FIND_DCW;

   1684  2 000245   000236 710000 2                  TRA     FIND_DCW

      162     1685    2               END;                        /* THEN                               */
      163     1686    1             ELSE;
      164     1687    2           IF PSI_FLG='1'B THEN DO;        /* PSI, set IDCW                      */

   1687  2 000246   000010 234000 0                  SZN     PSI_FLG
         2 000247   000341 605000 2                  TPL     s:1717

      165     1688    2                 PSI_FLG='0'B;

   1688  2 000250   000010 450000 0                  STZ     PSI_FLG

      166     1689    2                 SIDCW=DEVINFO.PCWS.PCW1(INDX);

   1689  2 000251   200003 471500                    LDP1    @INDX,,AUTO
         2 000252   100000 236100                    LDQ     0,,PR1
         2 000253   000006 402007                    MPY     6,DL
         2 000254   000001 736000                    QLS     1
         2 000255   000002 236006 xsym               LDQ     DEVINFO+2,QL
         2 000256   000004 756000 0                  STQ     SIDCW

      167     1690    2                IF DEVINFO.PCWS.PCW1.ADEXT(INDX)='0'B THEN; /* No address extention */

   1690  2 000257   100000 236100                    LDQ     0,,PR1
         2 000260   000006 402007                    MPY     6,DL
         2 000261   000001 736000                    QLS     1
         2 000262   000002 236006 xsym               LDQ     DEVINFO+2,QL
         2 000263   000077 316003                    CANQ    63,DU
         2 000264   000270 600000 2                  TZE     s:1692

      168     1691    2                   ELSE SIDCW=SIDCW|'040000'O; /*Set EC bit in IDCW              */

   1691  2 000265   000004 236000 0                  LDQ     SIDCW
         2 000266   040000 276003                    ORQ     16384,DU
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:26   
         2 000267   000004 756000 0                  STQ     SIDCW

      169     1692    2                 DEVINFO.PCWS.PCW1(INDX)='0'B;

   1692  2 000270   100000 236100                    LDQ     0,,PR1
         2 000271   000006 402007                    MPY     6,DL
         2 000272   000001 736000                    QLS     1
         2 000273   000002 450006 xsym               STZ     DEVINFO+2,QL

      170     1693    2                 DEVINFO.PCWS.PCW1.PCWID(INDX)='7'O;

   1693  2 000274   100000 236100                    LDQ     0,,PR1
         2 000275   000006 402007                    MPY     6,DL
         2 000276   000001 736000                    QLS     1
         2 000277   000000 620006                    EAX0    0,QL
         2 000300   700000 236007                    LDQ     -32768,DL
         2 000301   000002 256010 xsym               ORSQ    DEVINFO+2,X0

      171     1694    3                 IF RD_FW_FLG='1'B THEN DO; /* Read FW                           */

   1694  2 000302   000000 234000 xsym               SZN     RD_FW_FLG
         2 000303   000307 605000 2                  TPL     s:1700

      172     1695    3                       SIDCW1=DCW;

   1695  2 000304   000000 236100                    LDQ     0,,PR0
         2 000305   000005 756000 0                  STQ     SIDCW1

      173     1696    3                       GOTO DODCWAD;

   1696  2 000306   000337 710000 2                  TRA     DODCWAD

      174     1697    3                     END;                  /* THEN                               */
      175     1698    2                   ELSE;
      176     1699        /* In SIDCW1,build a TDCW */
      177     1700    2                 SIDCW1=DCW_PTR;           /* Pointer to the DCW                 */

PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:27   
   1700  2 000307   000002 236000 0                  LDQ     DCW_PTR
         2 000310   000005 756000 0                  STQ     SIDCW1

      178     1701    2                 DCW$=ADDR(SIDCW1);

   1701  2 000311   000006 236000 3                  LDQ     6
         2 000312   000002 756000 0                  STQ     DCW_PTR

      179     1702    2                 DCW.TALLY=0;

   1702  2 000313   000002 470400 0                  LDP0    DCW_PTR
         2 000314   000000 236003                    LDQ     0,DU
         2 000315   000000 752103                    STCQ    0,'03'O,PR0

      180     1703    2                 DCW.TYPE='10'B;           /* Make it a TDCW                     */

   1703  2 000316   000002 470400 0                  LDP0    DCW_PTR
         2 000317   000000 236100                    LDQ     0,,PR0
         2 000320   000007 376000 3                  ANQ     7
         2 000321   020000 276007                    ORQ     8192,DL
         2 000322   000000 756100                    STQ     0,,PR0

      181     1704    3                 IF DISK_FLG='1'B THEN DO; /* DISK I/O                           */

   1704  2 000323   000000 234000 xsym               SZN     DISK_FLG
         2 000324   000337 605000 2                  TPL     DODCWAD

      182     1705        /* Make room for SEEK */
      183     1706    3                       SIDCW2=SIDCW;

   1706  2 000325   000004 236000 0                  LDQ     SIDCW
         2 000326   000006 756000 0                  STQ     SIDCW2

      184     1707    3                       SIDCW3=SIDCW1;

   1707  2 000327   000005 236000 0                  LDQ     SIDCW1
         2 000330   000007 756000 0                  STQ     SIDCW3
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:28   

      185     1708    3                       SIDCW=SIDCW&'007777737777'O|SKIDCW;
              1708                                /*Mask out READ or WRITE and bit 21,

   1708  2 000331   000004 236000 0                  LDQ     SIDCW
         2 000332   000000 376000 1                  ANQ     0
         2 000333   000000 276000 xsym               ORQ     SKIDCW
         2 000334   000004 756000 0                  STQ     SIDCW

      186     1709                                           and make it a SEEK with continue */
      187     1710    3                       SIDCW1=SKDCW;

   1710  2 000335   000000 236000 xsym               LDQ     SKDCW
         2 000336   000005 756000 0                  STQ     SIDCW1

      188     1711    3                     END;                  /* THEN                               */

   1704  2 000337                       DODCWAD      null
      189     1712    2                   ELSE;
      190     1713    2   DODCWAD:      ;
      191     1714    2                 DCW$=ADDR(SIDCW);

   1714  2 000337   000010 236000 3                  LDQ     8
         2 000340   000002 756000 0                  STQ     DCW_PTR

      192     1715    2               END;                        /* THEN                               */

      193     1716    1             ELSE;
      194     1717    1           CMBOX.LPW$=DCW$;

   1717  2 000341   000002 236000 0                  LDQ     DCW_PTR
         2 000342   200007 470500                    LDP0    CHAN$,,AUTO
         2 000343   000000 756100                    STQ     0,,PR0

      195     1718    1           CMBOX.W1.H2.TALLY=4095;

   1718  2 000344   007777 236007                    LDQ     4095,DL
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:29   
         2 000345   000000 752103                    STCQ    0,'03'O,PR0

      196     1719    1           DEVINFO.STATUS(INDX)='0'B;      /* Clear Status words                 */

   1719  2 000346   200003 471500                    LDP1    @INDX,,AUTO
         2 000347   100000 236100                    LDQ     0,,PR1
         2 000350   000006 402007                    MPY     6,DL
         2 000351   000001 736000                    QLS     1
         2 000352   000000 235003                    LDA     0,DU
         2 000353   000000 620006                    EAX0    0,QL
         2 000354   000000 236003                    LDQ     0,DU
         2 000355   000004 757010 xsym               STAQ    DEVINFO+4,X0

      197     1720    1           I=DEVINFO.CHN#(INDX);           /* See if channel 0-31 or 32-63       */

   1720  2 000356   100000 236100                    LDQ     0,,PR1
         2 000357   000006 402007                    MPY     6,DL
         2 000360   000001 736000                    QLS     1
         2 000361   000000 236006 xsym               LDQ     DEVINFO,QL
         2 000362   000033 772000                    QRL     27
         2 000363   200023 756100                    STQ     I,,AUTO

      198     1721    1           IF I<32 THEN

   1721  2 000364   000040 116007                    CMPQ    32,DL
         2 000365   000400 603000 2                  TRC     s:1724

      199     1722    1             IMW_PTR.WOFFS=IMWBASE+DEVINFO.IOM#(INDX)+12;/*For channels 0-31*/

   1722  2 000366   100000 236100                    LDQ     0,,PR1
         2 000367   000006 402007                    MPY     6,DL
         2 000370   000001 736000                    QLS     1
         2 000371   000000 236006 xsym               LDQ     DEVINFO,QL
         2 000372   000023 772000                    QRL     19
         2 000373   000003 376007                    ANQ     3,DL
         2 000374   000000 036000 xsym               ADLQ    IMWBASE
         2 000375   000014 620006                    EAX0    12,QL
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:30   
         2 000376   000003 740000 0                  STX0    IMW_PTR
         2 000377   000413 710000 2                  TRA     s:1727

      200     1723    2             ELSE DO;

      201     1724    2                 I=I-32;

   1724  2 000400   000040 136007                    SBLQ    32,DL
         2 000401   200023 756100                    STQ     I,,AUTO

      202     1725    2                 IMW_PTR.WOFFS=IMWBASE+DEVINFO.IOM#(INDX)+8;/*For channels 32-63 */

   1725  2 000402   100000 236100                    LDQ     0,,PR1
         2 000403   000006 402007                    MPY     6,DL
         2 000404   000001 736000                    QLS     1
         2 000405   000000 236006 xsym               LDQ     DEVINFO,QL
         2 000406   000023 772000                    QRL     19
         2 000407   000003 376007                    ANQ     3,DL
         2 000410   000000 036000 xsym               ADLQ    IMWBASE
         2 000411   000010 620006                    EAX0    8,QL
         2 000412   000003 740000 0                  STX0    IMW_PTR

      203     1726    2               END;                        /* ELSE                               */

      204     1727    1           IMWCEL(I)='0'B;                 /*Turn INT bit off                    */

   1727  2 000413   000003 473400 0                  LDP3    IMW_PTR
         2 000414   200023 235100                    LDA     I,,AUTO
         2 000415   003105 060400                    CSL     bolr='003'O
         2 000416   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 000417   300000 000001                    BDSC    0,A,PR3                  by=0,bit=0,n=1

      205     1728    1           PORT#=IOMTAB.PORT#(DEVINFO.IOM#(INDX));

   1728  2 000420   100000 236100                    LDQ     0,,PR1
         2 000421   000006 402007                    MPY     6,DL
         2 000422   000001 736000                    QLS     1
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:31   
         2 000423   000000 236006 xsym               LDQ     DEVINFO,QL
         2 000424   000023 772000                    QRL     19
         2 000425   000003 376007                    ANQ     3,DL
         2 000426   000000 236006 xsym               LDQ     IOMTAB,QL
         2 000427   000007 376007                    ANQ     7,DL
         2 000430   200022 756100                    STQ     PORT#,,AUTO

      206     1729    1           CALL START_IO(PORT#);

   1729  2 000431   200022 633500                    EPPR3   PORT#,,AUTO
         2 000432   200030 453500                    STP3    LOGIC_CHAN+2,,AUTO
         2 000433   200030 630500                    EPPR0   LOGIC_CHAN+2,,AUTO
         2 000434   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000435   000000 701000 xent               TSX1    START_IO
         2 000436   000000 011000                    NOP     0

      207     1730    1           CHAN$=CON$;

   1730  2 000437   000000 236000 0                  LDQ     CON_PTR
         2 000440   200007 756100                    STQ     CHAN$,,AUTO

      208     1731        /* Wait until connect channel non_busy */
      209     1732    2           DO UNTIL CMBOX.W1.H2.TALLY=0;

      210     1733    2           END;                            /* DO                                 */

   1733  2 000441   200007 470500                    LDP0    CHAN$,,AUTO
         2 000442   000000 236100                    LDQ     0,,PR0
         2 000443   007777 316007                    CANQ    4095,DL
         2 000444   000441 601000 2                  TNZ     s:1733

      211     1734    2           IF ADDR(TIME_OUT)~=ADDR(NIL) THEN DO; /* Time_out required            */

   1734  2 000445   200005 236100                    LDQ     @TIME_OUT,,AUTO
         2 000446   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000447   000467 600000 2                  TZE     s:1744

PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:32   
      212     1735    2                 INT_TIME=TIME_OUT;

   1735  2 000450   200005 471500                    LDP1    @TIME_OUT,,AUTO
         2 000451   100000 235100                    LDA     0,,PR1
         2 000452   200012 755100                    STA     INT_TIME,,AUTO

      213     1736    3                 DO UNTIL INT_TIME=0;

      214     1737    3                   INT_TIME=INT_TIME-1;

   1737  2 000453   200012 235100                    LDA     INT_TIME,,AUTO
         2 000454   000001 135007                    SBLA    1,DL
         2 000455   200012 755100                    STA     INT_TIME,,AUTO

      215     1738    3                   IF DEVINFO.STATUS.TBIT(INDX)='1'B THEN GOTO IOTERM;
              1738                            /* IO finished */

   1738  2 000456   200003 470500                    LDP0    @INDX,,AUTO
         2 000457   000000 236100                    LDQ     0,,PR0
         2 000460   000006 402007                    MPY     6,DL
         2 000461   000001 736000                    QLS     1
         2 000462   000004 234006 xsym               SZN     DEVINFO+4,QL
         2 000463   000475 604000 2                  TMI     IOTERM

      216     1739    3                     ELSE;
      217     1740    3                 END;                      /* DO UNTIL                           */

   1740  2 000464   200012 235100                    LDA     INT_TIME,,AUTO
         2 000465   000453 601000 2                  TNZ     s:1737

      218     1741    2                 GOTO IODONE;

   1741  2 000466   000506 710000 2                  TRA     IODONE

      219     1742    2               END;                        /* THEN                               */
      220     1743    2             ELSE DO UNTIL DEVINFO.STATUS.TBIT(INDX)='1'B;

PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:33   
      221     1744    2               END;                        /* ELSE                               */

   1744  2 000467   200003 470500                    LDP0    @INDX,,AUTO
         2 000470   000000 236100                    LDQ     0,,PR0
         2 000471   000006 402007                    MPY     6,DL
         2 000472   000001 736000                    QLS     1
         2 000473   000004 234006 xsym               SZN     DEVINFO+4,QL
         2 000474   000467 605000 2                  TPL     s:1744

   1742  2 000475                       IOTERM       null
      222     1745        /* Wait for INT bit,then turn it off */
      223     1746    1   IOTERM: ;
      224     1747    2           DO UNTIL IMWCEL(I)='1'B;

      225     1748    2           END;                            /* DO                                 */

   1748  2 000475   000003 470400 0                  LDP0    IMW_PTR
         2 000476   200023 235100                    LDA     I,,AUTO
         2 000477   000000 066505                    CMPB    filb='0'B
         2 000500   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         2 000501   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 000502   000475 600000 2                  TZE     IOTERM

      226     1749    1           IMWCEL(I)='0'B;

   1749  2 000503   003105 060400                    CSL     bolr='003'O
         2 000504   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 000505   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1

   1749  2 000506                       IODONE       null
      227     1750    1   IODONE: ;
      228     1751    1           CALL CLEAR_CACHE;

   1751  2 000506   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000507   000000 701000 xent               TSX1    CLEAR_CACHE
         2 000510   000000 011000                    NOP     0

PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:34   
      229     1752    2           IF ADDREXT1='1'B THEN DO;       /*Buffer cross 256 K                  */

   1752  2 000511   000000 234000 xsym               SZN     ADDREXT1
         2 000512   000523 605000 2                  TPL     s:1759

      230     1753    2                 ADDREXT1='0'B;

   1753  2 000513   000000 450000 xsym               STZ     ADDREXT1

      231     1754        /* Move POBUF into buffer */
      232     1755    2                 SUBSTR(I$CHAIN$->USBUF,0,L)=SUBSTR(POBUF,0,L);

   1755  2 000514   200006 470500                    LDP0    @L,,AUTO
         2 000515   000000 720100                    LXL0    0,,PR0
         2 000516   000000 721100                    LXL1    0,,PR0
         2 000517   000000 471400 xsym               LDP1    I$CHAIN$
         2 000520   040140 100440                    MLR     fill='040'O
         2 000521   000000 000011 xsym               ADSC9   POBUF                    cn=0,n=*X1
         2 000522   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

      233     1756    2               END;                        /*THEN                                */

      234     1757    1             ELSE;
      235     1758        /* Restore mailboxes */
      236     1759    1           CHAN$=CON$;

   1759  2 000523   000000 236000 0                  LDQ     CON_PTR
         2 000524   200007 756100                    STQ     CHAN$,,AUTO

      237     1760    1           CMBOX.W1=SAVE_CONMBOX.W1;

   1760  2 000525   200014 236100                    LDQ     SAVE_CONMBOX,,AUTO
         2 000526   200007 470500                    LDP0    CHAN$,,AUTO
         2 000527   000000 756100                    STQ     0,,PR0

      238     1761    1           CMBOX.W2=SAVE_CONMBOX.W2;

PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:35   
   1761  2 000530   200015 236100                    LDQ     SAVE_CONMBOX+1,,AUTO
         2 000531   000001 756100                    STQ     1,,PR0

      239     1762    1           CHAN$=PAYLD$;

   1762  2 000532   000001 236000 0                  LDQ     PAYLD_PTR
         2 000533   200007 756100                    STQ     CHAN$,,AUTO

      240     1763    1           CMBOX=SAVE_PMBOX;

   1763  2 000534   200007 470500                    LDP0    CHAN$,,AUTO
         2 000535   000100 100500                    MLR     fill='000'O
         2 000536   200016 000020                    ADSC9   SAVE_PMBOX,,AUTO         cn=0,n=16
         2 000537   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16

      241     1764    1           PSI_FLG='0'B;                   /* Restore flag                       */

   1764  2 000540   000010 450000 0                  STZ     PSI_FLG

      242     1765    1           RETURN;

   1765  2 000541   000000 702200 xent               TSX2  ! X66_ARET

   1764  2 000542                       DOIO_RPM     null
      243     1766    1   DOIO_RPM: ;
      244     1767        /* This program issues the I/O operation  on an IMX */
      245     1768        /* INDX Index in DEVINFO,
      246     1769           COMMAND$ Pointer to the command area,
      247     1770           TIME_OUT Eventually time_out value */
      248     1771        /**/
      249     1772        /**/
      250     1773        /** Code **/
      251     1774    1           MAILBOX$=DEVINFO.RPM_PTRS.MBX$(INDX);

   1774  2 000542   200003 470500                    LDP0    @INDX,,AUTO
         2 000543   000000 236100                    LDQ     0,,PR0
         2 000544   000006 402007                    MPY     6,DL
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:36   
         2 000545   000001 736000                    QLS     1
         2 000546   000002 236006 xsym               LDQ     DEVINFO+2,QL
         2 000547   200024 756100                    STQ     MAILBOX$,,AUTO

      252     1775        /* Init Mailbox */
      253     1776    1           MBX.LPW.DCW_ADDR=DEVINFO.RPM_PTRS.EF_DCWS_PTR.WOFFS(INDX);
              1776                    /* Set LPW to point to respective DCWs */

   1776  2 000550   000000 236100                    LDQ     0,,PR0
         2 000551   000006 402007                    MPY     6,DL
         2 000552   000001 736000                    QLS     1
         2 000553   000003 220006 xsym               LDX0    DEVINFO+3,QL
         2 000554   200024 471500                    LDP1    MAILBOX$,,AUTO
         2 000555   100007 740100                    STX0    7,,PR1

      254     1777    1           EF_DCWS$=DEVINFO.RPM_PTRS.EF_DCWS$(INDX);

   1777  2 000556   000000 236100                    LDQ     0,,PR0
         2 000557   000006 402007                    MPY     6,DL
         2 000560   000001 736000                    QLS     1
         2 000561   000003 236006 xsym               LDQ     DEVINFO+3,QL
         2 000562   200025 756100                    STQ     EF_DCWS$,,AUTO

      255     1778    1           DCW$=ADDR(COMZONE.DCW);

   1778  2 000563   200004 471500                    LDP1    @COMMAND$,,AUTO
         2 000564   100000 473500                    LDP3    0,,PR1
         2 000565   300001 634500                    EPPR4   1,,PR3
         2 000566   000002 454400 0                  STP4    DCW_PTR

      256     1779    2           DO WHILE DCW.TYPE='10'B ;       /* TDCW,look for DCW                  */

   1779  2 000567   400000 236100                    LDQ     0,,PR4
         2 000570   030000 376007                    ANQ     12288,DL
         2 000571   020000 116007                    CMPQ    8192,DL
         2 000572   000603 601000 2                  TNZ     s:1782

PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:37   
      257     1780    2             DCW_PTR.WOFFS=DCW.AD;

   1780  2 000573   000002 470400 0                  LDP0    DCW_PTR
         2 000574   000000 220100                    LDX0    0,,PR0
         2 000575   000002 740000 0                  STX0    DCW_PTR

      258     1781    2           END;

   1781  2 000576   000002 470400 0                  LDP0    DCW_PTR
         2 000577   000000 236100                    LDQ     0,,PR0
         2 000600   030000 376007                    ANQ     12288,DL
         2 000601   020000 116007                    CMPQ    8192,DL
         2 000602   000573 600000 2                  TZE     s:1780

      259     1782    1           EF_DCWS.DCW0=COMZONE.IDCW$->DCW;

   1782  2 000603   200004 470500                    LDP0    @COMMAND$,,AUTO
         2 000604   000000 471500                    LDP1    0,,PR0
         2 000605   100000 473500                    LDP3    0,,PR1
         2 000606   300000 236100                    LDQ     0,,PR3
         2 000607   200025 474500                    LDP4    EF_DCWS$,,AUTO
         2 000610   400000 756100                    STQ     0,,PR4

      260     1783    1           EF_DCWS.DCW0.DEV#=DEVINFO.DEV#(INDX);

   1783  2 000611   200003 471500                    LDP1    @INDX,,AUTO
         2 000612   100000 236100                    LDQ     0,,PR1
         2 000613   000006 402007                    MPY     6,DL
         2 000614   000001 736000                    QLS     1
         2 000615   000000 236006 xsym               LDQ     DEVINFO,QL
         2 000616   000003 736000                    QLS     3
         2 000617   400000 752120                    STCQ    0,'20'O,PR4

      261     1784    1           EF_DCWS.DCW0.TYPE='7'O;

   1784  2 000620   700000 236007                    LDQ     -32768,DL
         2 000621   400000 256100                    ORSQ    0,,PR4
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:38   

      262     1785    2           IF RD_FW_FLG='1'B THEN DO;      /* Read FW                            */

   1785  2 000622   000000 234000 xsym               SZN     RD_FW_FLG
         2 000623   000630 605000 2                  TPL     s:1791

      263     1786    2                 EF_DCWS.DCW1=DCW;

   1786  2 000624   000002 473400 0                  LDP3    DCW_PTR
         2 000625   300000 236100                    LDQ     0,,PR3
         2 000626   400001 756100                    STQ     1,,PR4

      264     1787    2                 GOTO R_DODCWAD;

   1787  2 000627   000661 710000 2                  TRA     R_DODCWAD

      265     1788    2               END;                        /* THEN                               */
      266     1789    1             ELSE;
      267     1790        /* In DCW1,build a TDCW */
      268     1791    1           EF_DCWS.DCW1=DCW_PTR;           /* Pointer to the DCW                 */

   1791  2 000630   000002 236000 0                  LDQ     DCW_PTR
         2 000631   400001 756100                    STQ     1,,PR4

      269     1792    1           DCW$=ADDR(EF_DCWS.DCW1);

   1792  2 000632   200025 236100                    LDQ     EF_DCWS$,,AUTO
         2 000633   000001 036003                    ADLQ    1,DU
         2 000634   000002 756000 0                  STQ     DCW_PTR

      270     1793    1           DCW.TALLY=0;

   1793  2 000635   000002 473400 0                  LDP3    DCW_PTR
         2 000636   000000 236003                    LDQ     0,DU
         2 000637   300000 752103                    STCQ    0,'03'O,PR3

      271     1794    1           DCW.TYPE='10'B;                 /* Make it a TDCW                     */
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:39   

   1794  2 000640   000002 473400 0                  LDP3    DCW_PTR
         2 000641   300000 236100                    LDQ     0,,PR3
         2 000642   000007 376000 3                  ANQ     7
         2 000643   020000 276007                    ORQ     8192,DL
         2 000644   300000 756100                    STQ     0,,PR3

      272     1795    2           IF DISK_FLG='1'B THEN DO;       /* DISK I/O                           */

   1795  2 000645   000000 234000 xsym               SZN     DISK_FLG
         2 000646   000661 605000 2                  TPL     R_DODCWAD

      273     1796        /* Make room for SEEK */
      274     1797    2                 EF_DCWS.DCW2=EF_DCWS.DCW0;

   1797  2 000647   400000 236100                    LDQ     0,,PR4
         2 000650   400002 756100                    STQ     2,,PR4

      275     1798    2                 EF_DCWS.DCW3=EF_DCWS.DCW1;

   1798  2 000651   400001 236100                    LDQ     1,,PR4
         2 000652   400003 756100                    STQ     3,,PR4

      276     1799    2                 EF_DCWS.DCW0.OPCODE='34'O; /*Make it a SEEK                     */

   1799  2 000653   340000 236003                    LDQ     114688,DU
         2 000654   400000 752140                    STCQ    0,'40'O,PR4

      277     1800    2                 EF_DCWS.DCW0.CONT='1'B;   /*with continue                       */

   1800  2 000655   020000 236007                    LDQ     8192,DL
         2 000656   400000 256100                    ORSQ    0,,PR4

      278     1801    2                 EF_DCWS.DCW1=SKDCW;

   1801  2 000657   000000 236000 xsym               LDQ     SKDCW
         2 000660   400001 756100                    STQ     1,,PR4
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:40   

      279     1802    2               END;                        /* THEN                               */

   1795  2 000661                       R_DODCWAD    null
      280     1803    1             ELSE;
      281     1804    1   R_DODCWAD: ;
      282     1805        /*  Clear STATUS WORDS */
      283     1806    1           MBX.STATUS='0'B;

   1806  2 000661   200024 470500                    LDP0    MAILBOX$,,AUTO
         2 000662   000100 100400                    MLR     fill='000'O
         2 000663   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000664   000010 000040                    ADSC9   8,,PR0                   cn=0,n=32

      284     1807    1           MBX.CHN_LINK.SYNC='0'B;         /* Reset SYNC                         */

   1807  2 000665   200024 470500                    LDP0    MAILBOX$,,AUTO
         2 000666   000011 236000 3                  LDQ     9
         2 000667   000006 356100                    ANSQ    6,,PR0

      285     1808    1           LOGIC_CHAN=128*DEVINFO.IOM#(INDX)+DEVINFO.CHN#(INDX)+8;

   1808  2 000670   200003 470500                    LDP0    @INDX,,AUTO
         2 000671   000000 236100                    LDQ     0,,PR0
         2 000672   000006 402007                    MPY     6,DL
         2 000673   000000 620006                    EAX0    0,QL
         2 000674   000001 736000                    QLS     1
         2 000675   000000 236006 xsym               LDQ     DEVINFO,QL
         2 000676   000033 772000                    QRL     27
         2 000677   200030 756100                    STQ     LOGIC_CHAN+2,,AUTO
         2 000700   000000 635010                    EAA     0,X0
         2 000701   000021 771000                    ARL     17
         2 000702   000000 236005 xsym               LDQ     DEVINFO,AL
         2 000703   000014 772000                    QRL     12
         2 000704   000600 376007                    ANQ     384,DL
         2 000705   200030 036100                    ADLQ    LOGIC_CHAN+2,,AUTO
         2 000706   000010 036007                    ADLQ    8,DL
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:41   
         2 000707   200026 756100                    STQ     LOGIC_CHAN,,AUTO

      286     1809    1           CALL START_IO_RPM(LOGIC_CHAN,MAILBOX$);

   1809  2 000710   200024 631500                    EPPR1   MAILBOX$,,AUTO
         2 000711   200031 451500                    STP1    LOGIC_CHAN+3,,AUTO
         2 000712   200026 633500                    EPPR3   LOGIC_CHAN,,AUTO
         2 000713   200030 453500                    STP3    LOGIC_CHAN+2,,AUTO
         2 000714   200030 630500                    EPPR0   LOGIC_CHAN+2,,AUTO
         2 000715   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000716   000000 701000 xent               TSX1    START_IO_RPM
         2 000717   000000 011000                    NOP     0

      287     1810    2           IF ADDR(TIME_OUT)~=ADDR(NIL) THEN DO; /* TIMEOUT required             */

   1810  2 000720   200005 236100                    LDQ     @TIME_OUT,,AUTO
         2 000721   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000722   000737 600000 2                  TZE     s:1819

      288     1811    2                 INT_TIME=TIME_OUT;

   1811  2 000723   200005 470500                    LDP0    @TIME_OUT,,AUTO
         2 000724   000000 235100                    LDA     0,,PR0
         2 000725   200012 755100                    STA     INT_TIME,,AUTO

      289     1812    3                 DO UNTIL INT_TIME=0;

      290     1813    3                   INT_TIME=INT_TIME-1;

   1813  2 000726   200012 235100                    LDA     INT_TIME,,AUTO
         2 000727   000001 135007                    SBLA    1,DL
         2 000730   200012 755100                    STA     INT_TIME,,AUTO

      291     1814    3                   IF MBX.STATUS.W8.TBIT THEN GOTO R_IOTERM;

   1814  2 000731   200024 470500                    LDP0    MAILBOX$,,AUTO
         2 000732   000010 234100                    SZN     8,,PR0
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:42   
         2 000733   000760 604000 2                  TMI     R_IOTERM

      292     1815    3                 END;

   1815  2 000734   000000 115003                    CMPA    0,DU
         2 000735   000726 601000 2                  TNZ     s:1813

      293     1816    2                 GOTO R_IODONE;

   1816  2 000736   000764 710000 2                  TRA     R_IODONE

      294     1817    2               END;
      295     1818    1             ELSE
      296     1819    2             IF INDX = 0 THEN DO;

   1819  2 000737   200003 470500                    LDP0    @INDX,,AUTO
         2 000740   000000 235100                    LDA     0,,PR0
         2 000741   000755 601000 2                  TNZ     s:1828

      297     1820    2                   INT_TIME = 36000000;

   1820  2 000742   000012 235000 3                  LDA     10
         2 000743   200012 755100                    STA     INT_TIME,,AUTO

      298     1821    3                   DO UNTIL INT_TIME = 0;

      299     1822    3                     INT_TIME = INT_TIME-1;

   1822  2 000744   200012 235100                    LDA     INT_TIME,,AUTO
         2 000745   000001 135007                    SBLA    1,DL
         2 000746   200012 755100                    STA     INT_TIME,,AUTO

      300     1823    3                     IF MBX.STATUS.W8.TBIT THEN GOTO R_IOTERM;

   1823  2 000747   200024 470500                    LDP0    MAILBOX$,,AUTO
         2 000750   000010 234100                    SZN     8,,PR0
         2 000751   000760 604000 2                  TMI     R_IOTERM
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:43   

      301     1824    3                   END;

   1824  2 000752   000000 115003                    CMPA    0,DU
         2 000753   000744 601000 2                  TNZ     s:1822

      302     1825    2                   GOTO R_DODCWAD;

   1825  2 000754   000661 710000 2                  TRA     R_DODCWAD

      303     1826    2                 END;
      304     1827    2               ELSE DO UNTIL MBX.STATUS.W8.TBIT='1'B;

      305     1828    2                 END;

   1828  2 000755   200024 470500                    LDP0    MAILBOX$,,AUTO
         2 000756   000010 234100                    SZN     8,,PR0
         2 000757   000755 605000 2                  TPL     s:1828

   1827  2 000760                       R_IOTERM     null
      306     1829    1   R_IOTERM:;
      307     1830    2           DO UNTIL MBX.CHN_LINK.SYNC='1'B;

      308     1831    2           END;

   1831  2 000760   200024 470500                    LDP0    MAILBOX$,,AUTO
         2 000761   000006 236100                    LDQ     6,,PR0
         2 000762   000400 316007                    CANQ    256,DL
         2 000763   000760 600000 2                  TZE     R_IOTERM

   1830  2 000764                       R_IODONE     null
      309     1832    1   R_IODONE:;
      310     1833    1           MBX.CHN_LINK.SYNC='0'B;

   1833  2 000764   000011 236000 3                  LDQ     9
         2 000765   000006 356100                    ANSQ    6,,PR0

PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:44   
      311     1834    1           CALL CLEAR_CACHE;

   1834  2 000766   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000767   000000 701000 xent               TSX1    CLEAR_CACHE
         2 000770   000000 011000                    NOP     0

      312     1835        /*  Move STATUS in DEVINFO */
      313     1836    1           DEVINFO.BSTAT.W1(INDX)=MBX.STATUS.W8;

   1836  2 000771   200003 470500                    LDP0    @INDX,,AUTO
         2 000772   000000 236100                    LDQ     0,,PR0
         2 000773   000006 402007                    MPY     6,DL
         2 000774   000001 736000                    QLS     1
         2 000775   200024 471500                    LDP1    MAILBOX$,,AUTO
         2 000776   000000 620006                    EAX0    0,QL
         2 000777   100010 236100                    LDQ     8,,PR1
         2 001000   000004 756010 xsym               STQ     DEVINFO+4,X0

      314     1837    1           DEVINFO.BSTAT.W2(INDX)=MBX.STATUS.W11;

   1837  2 001001   000000 236100                    LDQ     0,,PR0
         2 001002   000006 402007                    MPY     6,DL
         2 001003   000001 736000                    QLS     1
         2 001004   000000 620006                    EAX0    0,QL
         2 001005   100013 236100                    LDQ     11,,PR1
         2 001006   000005 756010 xsym               STQ     DEVINFO+5,X0

      315     1838    1           RETURN;

   1838  2 001007   000000 702200 xent               TSX2  ! X66_ARET
      316     1839    1   END DOIOX;
      317     1840        /**/
      318     1841        %EJECT;
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:45   
      319     1842        %EOD;

PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:46   
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure DOIOX.
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:47   

 **** Variables and constants ****

  ****  Section 000  Data  DOIOX

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CON$                       0-0-0/w STRC        r     1 CON_PTR
     2-0-0/w PTR         r     1 DCW$                       2-0-0/w STRC        r     1 DCW_PTR
     3-0-0/w PTR         r     1 IMW$                       3-0-0/w STRC        r     1 IMW_PTR
     1-0-0/w PTR         r     1 PAYLD$                     1-0-0/w STRC        r     1 PAYLD_PTR
    10-0-0/b BIT         r     1 PSI_FLG                    4-0-0/w BIT         r     1 SIDCW
     5-0-0/w BIT         r     1 SIDCW1                     6-0-0/w BIT         r     1 SIDCW2
     7-0-0/w BIT         r     1 SIDCW3

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @COMMAND$                  3-0-0/w PTR         r     1 @INDX
     6-0-0/w PTR         r     1 @L                         5-0-0/w PTR         r     1 @TIME_OUT
     7-0-0/w PTR         r     1 CHAN$                     *0-0-0/w PTR         r     1 COMMAND$
    25-0-0/w PTR         r     1 EF_DCWS$                  23-0-0/w UBIN        r     1 I
    *0-0-0/w UBIN        r     1 INDX                      11-0-0/w PTR         r     1 INT_IDCW$
    12-0-0/w UBIN        r     1 INT_TIME                  *0-0-0/w UBIN        r     1 L
    26-0-0/w UBIN        r     1 LOGIC_CHAN                24-0-0/w PTR         r     1 MAILBOX$
    22-0-0/w UBIN        r     1 PORT#                     14-0-0/d STRC(72)    r     1 SAVE_CONMBOX
    16-0-0/w BIT         r     1 SAVE_PMBOX(0:3)
    *0-0-0/w UBIN        r     1 TIME_OUT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 ADDREXT                    0-0-0/b BIT         r     1 ADDREXT1
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:48   
     0-0-0/d STRC(396)   r     1 DEVINFO(0:21)              0-0-0/b BIT         r     1 DISK_FLG
     0-0-0/w PTR         r     1 I$CHAIN$                   0-0-0/w UBIN        r     1 IMWBASE
     0-0-0/w STRC        r     1 IOMTAB(0:3)                0-0-0/c CHAR(1024)  r     1 POBUF
     0-0-0/b BIT         r     1 RD_FW_FLG                  0-0-0/b BIT         r     1 RPM_FLG
     0-0-0/b BIT         r     1 SKDCW                      0-0-0/b BIT         r     1 SKIDCW

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 CMBOX                      0-0-0/w STRC(72)    r     1 COMZONE
     0-0-0/w STRC        r     1 DCW                        0-0-0/w STRC(144)   r     1 EF_DCWS
     0-0-0/w STRC        r     1 IDCW                       0-0-0/b BIT         r     1 IMWCEL(0:31)
     0-0-0/w STRC(864)   r     1 MBX                        0-0-0/c CHAR(1024)  r     1 USBUF


   Procedure DOIOX requires 520 words for executable code.
   Procedure DOIOX requires 26 words of local(AUTO) storage.
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:49   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:50   
          MINI XREF LISTING

ADDREXT
      1536**DCL      1656>>IF       1658<<ASSIGN
ADDREXT1
      1537**DCL      1752>>IF       1753<<ASSIGN
CHAN$
      1509**DCL      1407--IMP-PTR  1643<<ASSIGN   1644>>IF       1646>>ASSIGN   1649>>IF       1665>>ASSIGN
      1666>>ASSIGN   1668>>ASSIGN   1669>>ASSIGN   1670>>ASSIGN   1671>>ASSIGN   1673<<ASSIGN   1674>>ASSIGN
      1675>>ASSIGN   1676>>ASSIGN   1677>>ASSIGN   1678>>ASSIGN   1679>>ASSIGN   1717>>ASSIGN   1718>>ASSIGN
      1730<<ASSIGN   1732>>DOUNTIL  1759<<ASSIGN   1760>>ASSIGN   1761>>ASSIGN   1762<<ASSIGN   1763>>ASSIGN
CLEAR_CACHE
      1299**DCL-ENT  1751--CALL     1834--CALL
CMBOX
      1407**DCL      1674>>ASSIGN   1763<<ASSIGN
CMBOX.LPW$
      1418**DCL      1668<<ASSIGN   1717<<ASSIGN
CMBOX.SCW$
      1425**DCL      1675<<ASSIGN
CMBOX.W1
      1408**DCL      1418--REDEF    1665>>ASSIGN   1760<<ASSIGN
CMBOX.W1.H2.TAL
      1415**DCL      1669<<ASSIGN
CMBOX.W1.H2.TALLY
      1417**DCL      1649>>IF       1670<<ASSIGN   1718<<ASSIGN   1732>>DOUNTIL
CMBOX.W2
      1419**DCL      1666>>ASSIGN   1761<<ASSIGN
CMBOX.W2.H1
      1420**DCL      1677<<ASSIGN
CMBOX.W2.H2
      1421**DCL      1671<<ASSIGN   1678<<ASSIGN
CMBOX.W3
      1422**DCL      1425--REDEF
CMBOX.W3.H2
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:51   
      1424**DCL      1676<<ASSIGN
CMBOX.W4
      1426**DCL      1429--REDEF    1644>>IF       1646<<ASSIGN   1679<<ASSIGN
COMMAND$
      1294**DCL         7--PROC     1514--IMP-PTR  1635--ENTRY    1637>>ASSIGN   1680>>ASSIGN   1778>>ASSIGN
      1782>>ASSIGN
COMZONE.DCW
      1516**DCL      1680--ASSIGN   1778--ASSIGN
COMZONE.IDCW$
      1515**DCL      1637>>ASSIGN   1782>>ASSIGN
CON$
      1450**DCL      1643>>ASSIGN   1730>>ASSIGN   1759>>ASSIGN
CON_PTR
      1443**DCL      1450--REDEF
CON_PTR.WOFFS
      1444**DCL      1641<<ASSIGN
DCW
      1398**DCL      1695>>ASSIGN   1782>>ASSIGN   1786>>ASSIGN
DCW.AD
      1399**DCL      1683>>ASSIGN   1780>>ASSIGN
DCW.TALLY
      1403**DCL      1702<<ASSIGN   1793<<ASSIGN
DCW.TYPE
      1402**DCL      1682>>IF       1703<<ASSIGN   1779>>DOWHILE  1794<<ASSIGN
DCW$
      1488**DCL      1398--IMP-PTR  1680<<ASSIGN   1682>>IF       1683>>ASSIGN   1695>>ASSIGN   1701<<ASSIGN
      1702>>ASSIGN   1703>>ASSIGN   1714<<ASSIGN   1717>>ASSIGN   1778<<ASSIGN   1779>>DOWHILE  1780>>ASSIGN
      1786>>ASSIGN   1792<<ASSIGN   1793>>ASSIGN   1794>>ASSIGN
DCW_PTR
      1481**DCL      1488--REDEF    1700>>ASSIGN   1791>>ASSIGN
DCW_PTR.WOFFS
      1482**DCL      1683<<ASSIGN   1780<<ASSIGN
DEVINFO.BSTAT.W1
      1355**DCL      1836<<ASSIGN
DEVINFO.BSTAT.W2
      1358**DCL      1837<<ASSIGN
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:52   
DEVINFO.CHN#
      1314**DCL      1639>>ASSIGN   1662>>ASSIGN   1720>>ASSIGN   1808>>ASSIGN
DEVINFO.DEV#
      1315**DCL      1661>>ASSIGN   1783>>ASSIGN
DEVINFO.IOM#
      1316**DCL      1639>>ASSIGN   1641>>ASSIGN   1722>>ASSIGN   1725>>ASSIGN   1728>>ASSIGN   1808>>ASSIGN
DEVINFO.PCWS
      1318**DCL      1329--REDEF
DEVINFO.PCWS.PCW1
      1319**DCL      1668--ASSIGN   1689>>ASSIGN   1692<<ASSIGN
DEVINFO.PCWS.PCW1.ADEXT
      1322**DCL      1659<<ASSIGN   1690>>IF
DEVINFO.PCWS.PCW1.CHINFO1
      1320**DCL      1653<<ASSIGN
DEVINFO.PCWS.PCW1.CHINFO2
      1325**DCL      1654<<ASSIGN
DEVINFO.PCWS.PCW1.DEV#
      1321**DCL      1661<<ASSIGN
DEVINFO.PCWS.PCW1.M
      1324**DCL      1655<<ASSIGN
DEVINFO.PCWS.PCW1.PCWID
      1323**DCL      1693<<ASSIGN
DEVINFO.PCWS.PCW2.CHN#
      1327**DCL      1662<<ASSIGN
DEVINFO.RPM_PTRS.EF_DCWS$
      1331**DCL      1332--REDEF    1777>>ASSIGN
DEVINFO.RPM_PTRS.EF_DCWS_PTR.WOFFS
      1333**DCL      1776>>ASSIGN
DEVINFO.RPM_PTRS.MBX$
      1330**DCL      1774>>ASSIGN
DEVINFO.STATUS
      1335**DCL      1354--REDEF    1675--ASSIGN   1719<<ASSIGN
DEVINFO.STATUS.TBIT
      1336**DCL      1738>>IF       1743>>DOUNTIL
DISK_FLG
      1539**DCL      1704>>IF       1795>>IF
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:53   
DODCWAD
      1704**LABEL    1696--GOTO
DOIO_RPM
      1764**LABEL    1636--GOTO
EF_DCWS.DCW0
      1619**DCL      1782<<ASSIGN   1797>>ASSIGN
EF_DCWS.DCW0.CONT
      1625**DCL      1800<<ASSIGN
EF_DCWS.DCW0.DEV#
      1621**DCL      1783<<ASSIGN
EF_DCWS.DCW0.OPCODE
      1620**DCL      1799<<ASSIGN
EF_DCWS.DCW0.TYPE
      1623**DCL      1784<<ASSIGN
EF_DCWS.DCW1
      1628**DCL      1786<<ASSIGN   1791<<ASSIGN   1792--ASSIGN   1798>>ASSIGN   1801<<ASSIGN
EF_DCWS.DCW2
      1629**DCL      1797<<ASSIGN
EF_DCWS.DCW3
      1630**DCL      1798<<ASSIGN
EF_DCWS$
      1614**DCL      1618--IMP-PTR  1777<<ASSIGN   1782>>ASSIGN   1783>>ASSIGN   1784>>ASSIGN   1786>>ASSIGN
      1791>>ASSIGN   1792>>ASSIGN   1797>>ASSIGN   1797>>ASSIGN   1798>>ASSIGN   1798>>ASSIGN   1799>>ASSIGN
      1800>>ASSIGN   1801>>ASSIGN
FIND_DCW
      1680**LABEL    1684--GOTO
I
      1549**DCL      1650<<DOINDEX  1720<<ASSIGN   1721>>IF       1724<<ASSIGN   1724>>ASSIGN   1727>>ASSIGN
      1747>>DOUNTIL  1749>>ASSIGN
I$CHAIN$
      1543**DCL      1755>>ASSIGN
IDCW.CHINFO1
      1518**DCL      1653>>ASSIGN
IDCW.CHINFO2
      1523**DCL      1654>>ASSIGN
IMW$
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:54   
      1507**DCL      1528--IMP-PTR  1727>>ASSIGN   1747>>DOUNTIL  1749>>ASSIGN
IMWBASE
      1542**DCL      1722>>ASSIGN   1725>>ASSIGN
IMWCEL
      1528**DCL      1727<<ASSIGN   1747>>DOUNTIL  1749<<ASSIGN
IMW_PTR
      1500**DCL      1507--REDEF
IMW_PTR.WOFFS
      1501**DCL      1722<<ASSIGN   1725<<ASSIGN
INDX
      1293**DCL         7--PROC     1635--ENTRY    1639>>ASSIGN   1639>>ASSIGN   1641>>ASSIGN   1653>>ASSIGN
      1654>>ASSIGN   1655>>ASSIGN   1659>>ASSIGN   1661>>ASSIGN   1661>>ASSIGN   1662>>ASSIGN   1662>>ASSIGN
      1668>>ASSIGN   1675>>ASSIGN   1689>>ASSIGN   1690>>IF       1692>>ASSIGN   1693>>ASSIGN   1719>>ASSIGN
      1720>>ASSIGN   1722>>ASSIGN   1725>>ASSIGN   1728>>ASSIGN   1738>>IF       1743>>DOUNTIL  1774>>ASSIGN
      1776>>ASSIGN   1777>>ASSIGN   1783>>ASSIGN   1808>>ASSIGN   1808>>ASSIGN   1819>>IF       1836>>ASSIGN
      1837>>ASSIGN
INT_IDCW$
      1511**DCL      1517--IMP-PTR  1637<<ASSIGN   1653>>ASSIGN   1654>>ASSIGN
INT_TIME
      1513**DCL      1735<<ASSIGN   1736>>DOUNTIL  1737<<ASSIGN   1737>>ASSIGN   1811<<ASSIGN   1812>>DOUNTIL
      1813<<ASSIGN   1813>>ASSIGN   1820<<ASSIGN   1821>>DOUNTIL  1822<<ASSIGN   1822>>ASSIGN
IODONE
      1749**LABEL    1741--GOTO
IOMTAB.MAILBAD
      1383**DCL      1639>>ASSIGN   1641>>ASSIGN
IOMTAB.PORT#
      1385**DCL      1728>>ASSIGN
IOTERM
      1742**LABEL    1738--GOTO
L
      1296**DCL         7--PROC     1635--ENTRY    1755>>ASSIGN   1755>>ASSIGN
LOGIC_CHAN
      1616**DCL      1808<<ASSIGN   1809<>CALL
MAILBOX$
      1613**DCL      1567--IMP-PTR  1774<<ASSIGN   1776>>ASSIGN   1806>>ASSIGN   1807>>ASSIGN   1809<>CALL
      1814>>IF       1823>>IF       1827>>DOUNTIL  1830>>DOUNTIL  1833>>ASSIGN   1836>>ASSIGN   1837>>ASSIGN
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:55   
MBX.CHN_LINK.SYNC
      1580**DCL      1807<<ASSIGN   1830>>DOUNTIL  1833<<ASSIGN
MBX.LPW.DCW_ADDR
      1587**DCL      1776<<ASSIGN
MBX.STATUS
      1596**DCL      1806<<ASSIGN
MBX.STATUS.W11
      1605**DCL      1837>>ASSIGN
MBX.STATUS.W8
      1597**DCL      1600--REDEF    1836>>ASSIGN
MBX.STATUS.W8.TBIT
      1598**DCL      1814>>IF       1823>>IF       1827>>DOUNTIL
PAYLD$
      1469**DCL      1673>>ASSIGN   1762>>ASSIGN
PAYLD_PTR
      1462**DCL      1469--REDEF
PAYLD_PTR.WOFFS
      1463**DCL      1639<<ASSIGN
POBUF
      1544**DCL      1755>>ASSIGN
PORT#
      1548**DCL      1728<<ASSIGN   1729<>CALL
PSI_FLG
      1547**DCL      1634<<ASSIGN   1687>>IF       1688<<ASSIGN   1764<<ASSIGN
RD_FW_FLG
      1538**DCL      1694>>IF       1785>>IF
RPM_FLG
      1631**DCL      1636>>IF
R_DODCWAD
      1795**LABEL    1787--GOTO     1825--GOTO
R_IODONE
      1830**LABEL    1816--GOTO
R_IOTERM
      1827**LABEL    1814--GOTO     1823--GOTO
SAVE_CONMBOX.W1
      1525**DCL      1665<<ASSIGN   1760>>ASSIGN
PL6.E3A0      #001=DOIOX File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:51 Page:56   
SAVE_CONMBOX.W2
      1526**DCL      1666<<ASSIGN   1761>>ASSIGN
SAVE_PMBOX
      1527**DCL      1674<<ASSIGN   1763>>ASSIGN
SIDCW
      1531**DCL      1689<<ASSIGN   1691<<ASSIGN   1691>>ASSIGN   1706>>ASSIGN   1708<<ASSIGN   1708>>ASSIGN
      1714--ASSIGN
SIDCW1
      1532**DCL      1695<<ASSIGN   1700<<ASSIGN   1701--ASSIGN   1707>>ASSIGN   1710<<ASSIGN
SIDCW2
      1533**DCL      1706<<ASSIGN
SIDCW3
      1534**DCL      1707<<ASSIGN
SKDCW
      1541**DCL      1710>>ASSIGN   1801>>ASSIGN
SKIDCW
      1540**DCL      1708>>ASSIGN
START_IO
      1298**DCL-ENT  1729--CALL
START_IO_RPM
      1554**DCL-ENT  1809--CALL
TIME_OUT
      1295**DCL         7--PROC     1635--ENTRY    1734--IF       1735>>ASSIGN   1810--IF       1811>>ASSIGN
USBUF
      1545**DCL      1755<<ASSIGN
WT_TIME
      1300**DCL-ENT  1647--CALL

PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:57   
      320        1        /*T***********************************************************/
      321        2        /*T*                                                         */
      322        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      323        4        /*T*                                                         */
      324        5        /*T***********************************************************/
      325        6        /**/
      326        7        PUSSYCAT_PL6:PROC ALTRET;
      327        8        /* This procedure gets AARDVARK configuration */
      328        9        %INCLUDE IS$MACROS;
      329     1284        %DEVINFO(STCLASS="SYMREF");
      330     1353        %IOM_TAB(NAME=IOMTAB,STCLASS="SYMREF");
      331     1370        %CONNECT_TAB(NAME=CONNECT_TABLE,STCLASS="SYMREF");
      332     1390        %DOIO_COMZONE(NAME=OCZONE);
      333     1423        /**/
      334     1424    1   DCL IMWBASE STATIC SYMDEF UBIN WORD INIT(0);
      335     1425    1   DCL TYPEBI BIT(36) STATIC SYMDEF INIT('510000000001'O); /* Write alert        */
      336     1426    1   DCL URCHN STATIC SYMDEF UBIN WORD INIT(24); /* UR base chann                  */
      337     1427    1   DCL FEPIOM STATIC SYMDEF UBIN WORD INIT(0); /* FEP IOM                        */
      338     1428    1   DCL FEPCHAN STATIC SYMDEF UBIN WORD INIT(33); /* FEP Chann                    */
      339     1429    1   DCL MDELTAFLG STATIC SYMDEF UBIN WORD INIT(0); /* Flag for MDELTA call        */
      340     1430    1   DCL 1 BOOTINFO STATIC SYMDEF ALIGNED,
      341     1431    1         2 BCHN UBIN(9) UNAL INIT(0),
      342     1432    1         2 * BIT(24),
      343     1433    1         2 BPORT# UBIN(3) UNAL INIT(0),
      344     1434    1         2 BIOMAD UBIN(18) UNAL INIT(0),
      345     1435    1         2 BIMWAD UBIN(13) UNAL INIT(0),
      346     1436    1         2 * BIT(3),
      347     1437    1         2 BIOM# UBIN(2) UNAL INIT(0);
      348     1438    1   DCL 1 RPM_BOOTIN SYMREF,
      349     1439    1         2 * BIT(9),
      350     1440    1         2 CHN# UBIN(9) UNAL,
      351     1441    1         2 * BIT (7),
      352     1442    1         2 IMX# UBIN(2) UNAL,
      353     1443    1         2 * BIT (9);
      354     1444    1   DCL 1 RPM_BOOT_IDCW SYMREF,
      355     1445    1         2 * BIT(6),
      356     1446    1         2 DEV# UBIN(6) UNAL,
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:58   
      357     1447    1         2 * BIT(24) UNAL;
      358     1448    1   DCL 1 ORDBFLG SYMREF,
      359     1449    1         2 ORF BIT(1),
      360     1450    1         2 DBF BIT(1);
      361     1451    1   DCL 1 RCV_FLG SYMREF,
      362     1452    1         2 RC BIT(1),
      363     1453    1         2 DB BIT(1),
      364     1454    1         2 RBD BIT(1),
      365     1455    1         2 RBO BIT(1);
      366     1456    1   DCL VOFLG BIT(1) SYMREF;
      367     1457    1   DCL 1 ADPXF SYMREF,
      368     1458    1         2 A BIT(1),
      369     1459    1         2 D BIT(1),
      370     1460    1         2 P BIT(1),
      371     1461    1         2 X BIT(1),
      372     1462    1         2 F BIT(1);
      373     1463        /**/
      374     1464    1   DCL BOOTTAPE UBIN WORD SYMREF;
      375     1465    1   DCL FW_LOAD(0:511) BIT(1) UNAL SYMREF;
      376     1466    1   DCL TIGRPA BIT(1) SYMREF;
      377     1467    1   DCL MONPA BIT(1) SYMREF;
      378     1468    1   DCL RUMPA BIT(1) SYMREF;
      379     1469    1   DCL PLVPA BIT(1) SYMREF;
      380     1470    1   DCL SILENT BIT(1) STATIC SYMDEF INIT('0'B); /* Write FW names                 */
      381     1471    1   DCL MESSAGE CHAR(80) SYMREF;
      382     1472    1   DCL MESSAGE_CNT UBIN SYMREF;
      383     1473    1   DCL CONS_DCWS BIT(1) SYMREF;            /* Console DCWs on RPM                */
      384     1474        %IMX_MBX(NAME=CONS_MBX,STCLASS="SYMREF"); /* Cons MAILBOX on an RPM           */
      385     1531        %IMX_MBX(NAME=SH_MBX,STCLASS="SYMREF"); /* Shared MAILBOX on an RPM           */
      386     1588        %IMX_MBX(NAME=PATT_MBX,STCLASS="SYMREF"); /* Mailbox Pattern                  */
      387     1645        %MCA_CFG(STCLASS="SYMREF");
      388     1755    1   DCL   RPM_CONSOLE SBIN WORD SYMREF;
      389     1756    1   DCL RPM_FLG BIT(1) SYMREF;
      390     1757    1   DCL S1000_FLG BIT(1) SYMREF;
      391     1758    1   DCL SH_DCWS BIT(1) SYMREF;              /* Shared DCWs on RPM                 */
      392     1759    1   DCL   HIGHEST_CHAN UBIN WORD;
      393     1760    1   DCL 1 B_VERSION CALIGNED SYMREF,
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:59   
      394     1761    1         2 L UBIN BYTE UNAL,
      395     1762    1         2 C CHAR(B_VERSION.L);
      396     1763    1   DCL 1 CONS_INFO SYMREF,
      397     1764    1         2 * BIT(6),
      398     1765    1         2 PORT# UBIN(3) UNAL,
      399     1766    1         2 IOM# UBIN(3) UNAL,
      400     1767    1         2 CHN# UBIN(6) UNAL;
      401     1768    1   DCL 1 ANSBUF SYMREF,
      402     1769    1         2 CNT UBIN WORD,
      403     1770    1         2 TXT CHAR(16);
      404     1771    1   DCL 1 TEXTM BASED(MESSAGE$),
      405     1772    1         2 CNT UBIN WORD,
      406     1773    1         2 TXT CHAR(TEXTM.CNT);
      407     1774    1   DCL MESSAGE$ PTR;
      408     1775    1   DCL FIELD$ PTR SYMREF;                  /* Result from GETFD                  */
      409     1776    1   DCL FIELD_LEN UBIN WORD SYMREF;         /* Result from GETFD                  */
      410     1777    1   DCL DECIM_FLG BIT(1) SYMREF;            /* Result from GETFD                  */
      411     1778    1   DCL ALPHA_FLG BIT(1) SYMREF;            /* Result from GETFD                  */
      412     1779    1   DCL HIPAGE UBIN WORD SYMREF;
      413     1780    1   DCL GAP_SZ UBIN WORD SYMREF;
      414     1781    1   DCL 1 LOWER_SCU SYMREF,
      415     1782    1         2 LOW_BND UBIN WORD,
      416     1783    1         2 UPP_BND UBIN WORD;
      417     1784    1   DCL 1 UPPER_SCU SYMREF,
      418     1785    1         2 LOW_BND UBIN WORD,
      419     1786    1         2 UPP_BND UBIN WORD;
      420     1787    1   DCL IS_CFG_TYPE UBIN SYMREF;
      421     1788    1   DCL IS_PPUT_SIZE UBIN WORD SYMREF;
      422     1789    1   DCL IS_MEM_SIDE1 BIT(1) SYMREF;
      423     1790    1   DCL CHN_CFG(0:511) BIT(1) UNAL SYMREF;
      424     1791        /* Messages */
      425     1792        %TEXTC(N#=TBDBORQ,M#="'TB/DB/OR/VO?'");
      426     1797        %TEXTC(N#=HUHHH,M#="'Consult your System Services Manual for help in booting CP-6'")
              1797            ;
      427     1802        %TEXTC(N#=Q1Q,M#="'Change boot options (Y/N)/(ADPXF)/(? for help)?'");
      428     1807        %TEXTC(N#=Q2Q,M#="'Change boot options (Y/N)/(D)/(? for help)?'");
      429     1812        %TEXTC(N#=CATQU,M#="' URC assignments OK (Y/N)?'");
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:60   
      430     1817        %TEXTC(N#=CATQCH,M#="'  URC base channel# = '");
      431     1822        %TEXTC(N#=CATQFEP,M#="' FEP 0-033=FEP'");
      432     1827        %TEXTC(N#=HELPY,M#="'Y-All of the above options.'");
      433     1832        %TEXTC(N#=HELPN,M#="'N-None of the above options.'");
      434     1837        %TEXTC(N#=HELPA,M#="'A-Read AARDVARK patches before continuing.'");
      435     1842        %TEXTC(N#=HELPD,M#="'D-Change default device assignments.'");
      436     1847        %TEXTC(N#=HELPP,M#="'P-Change default patching directions.'");
      437     1852        %TEXTC(N#=HELPX,M#="'X-Retain XDELTA in memory.'");
      438     1857        %TEXTC(N#=HELPF,M#="'F-Read firmware from IFAD tape.'");
      439     1862        %TEXTC(N#=AM2MS,M#="'The memory available to CP-6 is xxxxxx pages.'");
      440     1867        %TEXTC(N#=AM2MS_FIXED,M#="'The memory available to CP-6 is xxxxxx pages.'");
      441     1872        %TEXTC(N#=RCVRM,M#="' Recovery says-HANG LOOSE... '");
      442     1877    1   DCL AARDVARK_NAME CHAR(0) CONSTANT INIT('AARDVARK ');
      443     1878    1   DCL AARDVARK_SERVICE CHAR(0) CONSTANT INIT(' at your service');
      444     1879        /**/
      445     1880    1   DCL TIME_OUT UBIN WORD;
      446     1881    1   DCL   CHG_IOM UBIN WORD;
      447     1882    1   DCL   CHG_CHN UBIN WORD;
      448     1883    1   DCL I UBIN WORD;
      449     1884    1   DCL COMMAND$ PTR;
      450     1885    1   DCL ANS CHAR(16) BASED(FIELD$);
      451     1886    1   DCL 1 BUILT_MES,
      452     1887    1         2 CNT UBIN WORD,
      453     1888    1         2 TXT CHAR(40);
      454     1889        /**/
      455     1890    1   DCL DOIO ENTRY(4);
      456     1891    1   DCL   DO_RPM_CFG ENTRY(1) ALTRET;
      457     1892    1   DCL   DO_SCU_STATE ENTRY(1) ALTRET;
      458     1893    1   DCL  DO_RPM_TIME ENTRY(1) ALTRET;
      459     1894    1   DCL KEYIN ENTRY(2) ALTRET;
      460     1895    1   DCL TYPEC ENTRY(1);
      461     1896    1   DCL UPPER_CASE ENTRY(2);
      462     1897    1   DCL GETFD ENTRY(2) ALTRET;
      463     1898    1   DCL   READ_CONNECT_TABLE ENTRY;
      464     1899        /**/
      465     1900        /** Code **/
      466     1901    1           HIGHEST_CHAN = %HIGH_CHAN;
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:61   
      467     1902    2           IF RPM_FLG THEN DO;   /* Fake BOOTINFO and change DEVINFO defaults    */
      468     1903    2                 HIGHEST_CHAN = %HIGH_RPM_CHAN;
      469     1904    2                 BOOTINFO.BCHN=RPM_BOOTIN.CHN#;
      470     1905    2                 BOOTINFO.BIOM#=RPM_BOOTIN.IMX#;
      471     1906    2                 URCHN = 40;
      472     1907    2                 FEPCHAN = 46;
      473     1908    2                 MESSAGE$ = ADDR(CATQFEP);
      474     1909    2                 SUBSTR(TEXTM.TXT,8,2) = '46';
      475     1910    2                 CALL BINCHAR(SUBSTR(TEXTM.TXT,5,1),BOOTINFO.BIOM#);
      476     1911    3                 DO I = %FRSTLP TO %FRSTLP + %LP# -1;
      477     1912    3                   DEVINFO.CHN#(I) = 40;
      478     1913    3                   SUBSTR(DEVINFO.DEVNAME(I),6,2) = '40';
      479     1914    3                 END;
      480     1915    3                 DO I = %FRSTCR TO %FRSTCR + %CR# -1;
      481     1916    3                   DEVINFO.CHN#(I) = 38;
      482     1917    3                   SUBSTR(DEVINFO.DEVNAME(I),6,2) = '38';
      483     1918    3                 END;
      484     1919    3                 DO I = %FRSTDP TO %FRSTDP + %DP# -1;
      485     1920    3                   DEVINFO.CHN#(I) = 64;
      486     1921    3                   SUBSTR(DEVINFO.DEVNAME(I),3,2) = '64';
      487     1922    3                 END;
      488     1923    2               END;
      489     1924        /* Fill device tables with IOM number */
      490     1925    2           DO I=0 TO %DIM-1;
      491     1926    2             DEVINFO.IOM#(I)=BOOTINFO.BIOM#;
      492     1927    2           END;                            /* DO                                 */
      493     1928        /* Fill device table for tapes with channel and
      494     1929                                            device number */
      495     1930    2           DO I=%FRSTMT TO %FRSTDP-1;
      496     1931    2             DEVINFO.CHN#(I)=BOOTINFO.BCHN;
      497     1932    2             DEVINFO.DEV#(I)=I-%FRSTMT;
      498     1933    2           END;                            /* DO                                 */
      499     1934    2           DO I=0 TO %FRSTMT-1;
      500     1935    2             CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(I),3,1),BOOTINFO.BIOM#);
      501     1936    2           END;                            /* DO                                 */
      502     1937    2           DO I=%FRSTMT TO %DIM-1;
      503     1938    2             CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(I),0,1),BOOTINFO.BIOM#);
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:62   
      504     1939    2           END;                            /* DO                                 */
      505     1940    2           DO I=%FRSTMT TO %FRSTDP-1;
      506     1941    2             CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(I),2,3),BOOTINFO.BCHN);
      507     1942    2             CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(I),6,2),(I-%FRSTMT));
      508     1943    2           END;                            /* DO                                 */
      509     1944        /* Fill in MAILBOX and DCWs addr. on an RPM */
      510     1945    2           IF RPM_FLG THEN DO;
      511     1946    2                 CONS_MBX = PATT_MBX;
      512     1947    2                 SH_MBX = PATT_MBX;
      513     1948    2                 DEVINFO.RPM_PTRS.MBX$(0)=ADDR(CONS_MBX);
      514     1949    2                 DEVINFO.RPM_PTRS.EF_DCWS$(0)=ADDR(CONS_DCWS);
      515     1950    3                 DO I=%FRSTLP TO %DIM-1;
      516     1951    3                   DEVINFO.RPM_PTRS.MBX$(I)=ADDR(SH_MBX);
      517     1952    3                   DEVINFO.RPM_PTRS.EF_DCWS$(I)=ADDR(SH_DCWS);
      518     1953    3                 END;                      /* DO I=                              */
      519     1954    2                 I = RPM_BOOTIN.IMX#;
      520     1955    2                 CALL DO_RPM_CFG(I);
      521     1956    2                 IF NOT FW_LOAD(DEVINFO.IOM#(%FRSTMT+BOOTTAPE)*128 + DEVINFO.CHN#(%
              1956                          FRSTMT+BOOTTAPE)) THEN
      522     1957    2                   BOOTTAPE = %FRSTMT + RPM_BOOT_IDCW.DEV#;
      523     1958    2                 IF NOT (CHN_CFG(I *128 +64)) THEN
      524     1959    3                     DO I = %FRSTDP TO %FRSTDP + %DP# -1;
      525     1960    3                       DEVINFO.CHN#(I) = 120;
      526     1961    3                       DEVINFO.DEV#(I) = 0;
      527     1962    3                       SUBSTR(DEVINFO.DEVNAME(I),2,3) = '120';
      528     1963    3                       SUBSTR(DEVINFO.DEVNAME(I),7,1) = '0';
      529     1964    3                     END;
      530     1965    2                 CALL READ_CONNECT_TABLE;
      531     1966    3                 DO I=0 TO 3;
      532     1967    3                   IOMTAB.PORT#(I)=CONNECT_TABLE.ENTRI.SCU_PORT(I);
      533     1968    3                 END;                      /* DO                                 */
      534     1969    2               END;                        /* THEN                               */
      535     1970    2             ELSE DO;
      536     1971        /* Fill in IOMTAB for all IOM's */
      537     1972    3                 DO I=0 TO 3;
      538     1973    3                   IOMTAB.MAILBAD(I)=BOOTINFO.BIOMAD-((BOOTINFO.BIOM#-I)*%MBOXSIZ);
      539     1974    3                   IOMTAB.PORT#(I)=BOOTINFO.BPORT#-(BOOTINFO.BIOM#-I);
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:63   
      540     1975    3                 END;                      /* DO                                 */
      541     1976    2                 IMWBASE=BOOTINFO.BIMWAD*32; /* Append 5 bits of 0               */
      542     1977    2               END;                        /* ELSE                               */
      543     1978        /* Find lowest OC channel on OCIOM */
      544     1979    2           IF S1000_FLG='1'B THEN DO; /* On S1000 the console is already known   */
      545     1980    2                 DEVINFO.CHN#(0)=CONS_INFO.CHN#;
      546     1981    2                 DEVINFO.IOM#(0)=CONS_INFO.IOM#;
      547     1982    2               END;                        /* THEN                               */
      548     1983    2             ELSE DO;
      549     1984    3                 IF RPM_FLG AND RPM_CONSOLE ~=-1 THEN DO;
      550     1985    3                       DEVINFO.CHN#(0) = RPM_CONSOLE;
      551     1986    3                     END;
      552     1987    3                   ELSE DO;
      553     1988    4                       DO I=0 TO 300000;   /* Wait a second                      */
      554     1989    4                       END;                /* DO                                 */
      555     1990    3                       TIME_OUT=6*512;
      556     1991    3                       OCZONE.IDCW$=ADDR(TYPEBI);
      557     1992    3                       OCZONE.DCW='0'B;
      558     1993    3                       COMMAND$=ADDR(OCZONE);
      559     1994    3   FINDOC:             ;
      560     1995    4                       DO I=8 TO HIGHEST_CHAN;
      561     1996    4                         DEVINFO.CHN#(0)=I;
      562     1997    4                         CALL DOIO(0,COMMAND$,TIME_OUT);
      563     1998    4                         IF (DEVINFO.BSTAT.W1.H1(0)&'777705'O)='400000'O&
      564     1999    4                           DEVINFO.STATUS.IOM_CHAN_STAT(0)='0'B&DEVINFO.STATUS.
              1999                                    IOM_CENT_STAT(0)='0'B THEN GOTO OCFOUND;
      565     2000    4                           ELSE;
      566     2001    4                       END;                /* DO                                 */
      567     2002        /* OC not found , try again */
      568     2003    3                       GOTO FINDOC;
      569     2004    3                     END;                  /* ELSE                               */
      570     2005    2               END;
      571     2006    1   OCFOUND:;
      572     2007    1           CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(0),5,3),I);
      573     2008    1           BUILT_MES.TXT = AARDVARK_NAME;
      574     2009    1           SUBSTR(BUILT_MES.TXT,LENGTHC(AARDVARK_NAME),B_VERSION.L) = B_VERSION.C;
      575     2010    1           SUBSTR(BUILT_MES.TXT,B_VERSION.L+LENGTHC(AARDVARK_NAME),LENGTHC(
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:64   
              2010                    AARDVARK_SERVICE)) =AARDVARK_SERVICE;
      576     2011    1           BUILT_MES.CNT = LENGTHC(AARDVARK_NAME) + LENGTHC(AARDVARK_SERVICE) +
              2011                    B_VERSION.L ;
      577     2012    1           CALL TYPEC(BUILT_MES);
      578     2013        /* Find out what kind of boot this is to be */
      579     2014    1   TBDBOR:
      580     2015    1           RCV_FLG='0'B;
      581     2016    1           CALL KEYIN(TBDBORQ,ANSBUF);
      582     2017    1           IF SUBSTR(ANSBUF.TXT,0,1)='?'THEN GOTO ITSHELP;
      583     2018    1             ELSE;
      584     2019    1           CALL UPPER_CASE(ANSBUF.TXT,2);
      585     2020    2           DO SELECT(SUBSTR(ANSBUF.TXT,0,2));
      586     2021    2             SELECT('TB');
      587     2022    2             GOTO ITSTB;
      588     2023    2             SELECT('DB');
      589     2024    2             ORDBFLG.DBF='1'B;
      590     2025    2             GOTO Q2;
      591     2026    2             SELECT('OR');
      592     2027    2             ORDBFLG.ORF='1'B;
      593     2028    3             IF RPM_FLG THEN DO;
      594     2029    3                   I = RPM_BOOTIN.IMX#;
      595     2030    3                   CALL DO_RPM_TIME(I);
      596     2031    3                 END;
      597     2032    2             GOTO Q2;
      598     2033    2             SELECT('VO');
      599     2034    2             VOFLG='1'B;
      600     2035    2             GOTO ITSTB;
      601     2036    2             SELECT(ELSE);
      602     2037    2           GOTO TBDBOR;
      603     2038    2           END;                            /* DO SELECT                          */
      604     2039    1   ITSTB:
      605     2040    1           TIGRPA='0'B; /* Make sure !TIGR,!MON,!RUM,!PLOVER get written later   */
      606     2041    1           MONPA='0'B;
      607     2042    1           RUMPA='0'B;
      608     2043    1           PLVPA='0'B;
      609     2044    1           GOTO Q1;
      610     2045    1   ITSHELP:
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:65   
      611     2046    1           CALL TYPEC(HUHHH);
      612     2047    1           GOTO TBDBOR;
      613     2048    1   Q2:
      614     2049    1           CALL KEYIN(Q2Q,ANSBUF);
      615     2050    1           GOTO Q01;
      616     2051    1   Q1:
      617     2052    1           CALL KEYIN(Q1Q,ANSBUF);
      618     2053    1   Q01:
      619     2054    1           ADPXF='0'B;
      620     2055    1           CALL GETFD(ANSBUF.TXT,16) ALTRET(CAT9E);/* Default=NO */;
      621     2056    2           DO SELECT(SUBSTR(ANSBUF.TXT,0,1));
      622     2057    2             SELECT('?');
      623     2058    2             IF ORDBFLG='0'B THEN GOTO HELPTB;
      624     2059    2               ELSE GOTO HELPDBOR;
      625     2060    2             SELECT('N','n');
      626     2061    2             GOTO CAT9E;                   /* Establish return procedure         */
      627     2062    2             SELECT('Y','y');
      628     2063    2             IF ORDBFLG='0'B THEN ADPXF='11111'B;
      629     2064    2               ELSE ADPXF.D='1'B;
      630     2065    2             SELECT(ELSE);
      631     2066    3           DO I=0 TO 15;
      632     2067    4             DO SELECT(SUBSTR(ANSBUF.TXT,I,1));
      633     2068    4               SELECT(' ');
      634     2069    4               SELECT('*');
      635     2070    4               MDELTAFLG=1;
      636     2071    4               SELECT(ELSE);
      637     2072    4             CALL UPPER_CASE(SUBSTR(ANSBUF.TXT,I),1);
      638     2073    5             DO SELECT(SUBSTR(ANSBUF.TXT,I,1));
      639     2074    5               SELECT('A');
      640     2075    5               IF ORDBFLG~='0'B THEN GOTO Q2;
      641     2076    5                 ELSE ADPXF.A='1'B;
      642     2077    5               SELECT('D');
      643     2078    5               ADPXF.D='1'B;
      644     2079    5               SELECT('P');
      645     2080    5               IF ORDBFLG~='0'B THEN GOTO Q2;
      646     2081    5                 ELSE ADPXF.P='1'B;
      647     2082    5               SELECT('X');
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:66   
      648     2083    5               IF ORDBFLG~='0'B THEN GOTO Q2;
      649     2084    5                 ELSE ADPXF.X='1'B;
      650     2085    5               SELECT('F');
      651     2086    5               IF ORDBFLG~='0'B THEN GOTO Q2;
      652     2087    5                 ELSE ADPXF.F='1'B;
      653     2088    5               SELECT('S');
      654     2089    5               SILENT='1'B;                /* Don't write FW names               */
      655     2090    5               SELECT(ELSE);
      656     2091    5             IF ORDBFLG='0'B THEN GOTO Q1;
      657     2092    5               ELSE GOTO Q2;
      658     2093    5             END;                          /* DO SELECT                          */
      659     2094    4             END;                          /* DO SELECT                          */
      660     2095    3           END;                            /* DO I=                              */
      661     2096    2           END;                            /* DO SELECT                          */
      662     2097    1           IF ADPXF.D='0'B THEN GOTO CAT9E; /* Establish return                  */
      663     2098    1             ELSE;
      664     2099    1   CAT5:
      665     2100    1           CALL KEYIN(CATQU,ANSBUF);       /* Ask about URC devices              */
      666     2101    1           CALL GETFD(ANSBUF.TXT,16) ALTRET(CAT9); /* Default=YES                */
      667     2102    1           CALL UPPER_CASE(ANSBUF.TXT,1);
      668     2103    2           DO SELECT(SUBSTR(ANSBUF.TXT,0,1));
      669     2104    2             SELECT('Y');
      670     2105    2             GOTO CAT9;
      671     2106    2             SELECT('N');
      672     2107    2             SELECT(ELSE);
      673     2108    2           GOTO CAT5;
      674     2109    2           END;                            /* DO SELECT                          */
      675     2110    1   CAT6:   ;                               /* Ask about base chann               */
      676     2111    1           CALL KEYIN(CATQCH,ANSBUF);
      677     2112    1           CALL GETFD(ANSBUF.TXT,16) ALTRET(CAT6E); /* Default OK                */
      678     2113    1           IF ALPHA_FLG='1'B THEN GOTO CAT6; /* It has to be decimal             */
      679     2114    1             ELSE;
      680     2115    1           CALL CHARBIN(URCHN,SUBSTR(ANS,0,FIELD_LEN));
      681     2116    1           IF URCHN>HIGHEST_CHAN THEN GOTO CAT6;
      682     2117    1             ELSE;
      683     2118    1   CAT6E:
      684     2119    2           DO I=%OC# TO %(OC#+LP#-1);      /* Ask about LPs                      */
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:67   
      685     2120    2   CAT7:
      686     2121    2             BUILT_MES.TXT = ' ';
      687     2122    2             SUBSTR(BUILT_MES.TXT,2)=DEVINFO.DEVNAME(I);
      688     2123    2             SUBSTR(BUILT_MES.TXT,10)='=LP ';
      689     2124    2             BUILT_MES.CNT=10+4;
      690     2125    2   CAT7A:
      691     2126    2             CALL KEYIN(BUILT_MES,ANSBUF);
      692     2127    2             CALL GETFD(ANSBUF.TXT,16) ALTRET(CAT7E); /* Default OK              */
      693     2128    2             IF ALPHA_FLG='1'B THEN GOTO CAT7A; /* It has to be decimal          */
      694     2129    2             CALL CHARBIN(CHG_IOM,SUBSTR(ANS,0,FIELD_LEN));
      695     2130    2             IF CHG_IOM>%HIGHEST_IOM THEN GOTO CAT7A;
      696     2131    2             IF RPM_FLG THEN
      697     2132    2               IF CHG_IOM ~= RPM_BOOTIN.IMX# THEN
      698     2133    2                 CALL DO_RPM_CFG(CHG_IOM);
      699     2134    2             CALL GETFD(SUBSTR(ANSBUF.TXT,FIELD_LEN+1),16-FIELD_LEN-1) ALTRET(CAT7A);
      700     2135    2             IF ALPHA_FLG='1'B THEN GOTO CAT7A;
      701     2136    2               ELSE;
      702     2137    2             CALL CHARBIN(CHG_CHN,SUBSTR(ANS,0,FIELD_LEN));
      703     2138    2             IF CHG_CHN>HIGHEST_CHAN THEN GOTO CAT7A;
      704     2139    2             DEVINFO.IOM#(I) = CHG_IOM;
      705     2140    2             DEVINFO.CHN#(I)=CHG_CHN;
      706     2141    2             CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(I),3,1),DEVINFO.IOM#(I));
      707     2142    2             CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(I),5,3),DEVINFO.CHN#(I));
      708     2143    2   CAT7E:
      709     2144    2           END;                            /* DO I=                              */
      710     2145    2           DO I=%(OC#+LP#) TO %(OC#+LP#+CR#-1); /* Ask about CRs                 */
      711     2146    2   CAT8:
      712     2147    2             BUILT_MES.TXT = ' ';
      713     2148    2             SUBSTR(BUILT_MES.TXT,2)=DEVINFO.DEVNAME(I);
      714     2149    2             SUBSTR(BUILT_MES.TXT,10)='=CR ';
      715     2150    2             BUILT_MES.CNT=10+4;
      716     2151    2   CAT8A:
      717     2152    2             CALL KEYIN(BUILT_MES,ANSBUF);
      718     2153    2             CALL GETFD(ANSBUF.TXT,16) ALTRET(CAT8E); /* Default OK              */
      719     2154    2             IF ALPHA_FLG='1'B THEN GOTO CAT8A; /* It has to be decimal          */
      720     2155    2             CALL CHARBIN(CHG_IOM,SUBSTR(ANS,0,FIELD_LEN));
      721     2156    2             IF CHG_IOM>%HIGHEST_IOM THEN GOTO CAT8A;
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:68   
      722     2157    2             IF RPM_FLG THEN
      723     2158    2               IF CHG_IOM ~= RPM_BOOTIN.IMX# THEN
      724     2159    2                 CALL DO_RPM_CFG(CHG_IOM);
      725     2160    2             CALL GETFD(SUBSTR(ANSBUF.TXT,FIELD_LEN+1),16-FIELD_LEN-1) ALTRET(CAT8A);
      726     2161    2             IF ALPHA_FLG='1'B THEN GOTO CAT8A;
      727     2162    2               ELSE;
      728     2163    2             CALL CHARBIN(CHG_CHN,SUBSTR(ANS,0,FIELD_LEN));
      729     2164    2             IF CHG_CHN>HIGHEST_CHAN THEN GOTO CAT8A;
      730     2165    2             DEVINFO.CHN#(I)=CHG_CHN;
      731     2166    2             DEVINFO.IOM#(I)=CHG_IOM;
      732     2167    2             CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(I),3,1),DEVINFO.IOM#(I));
      733     2168    2             CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(I),5,3),DEVINFO.CHN#(I));
      734     2169    2   CAT8E:
      735     2170    2           END;                            /* DO I=                              */
      736     2171    1   CAT9:
      737     2172    1           CALL KEYIN(CATQFEP,ANSBUF);     /* Ask about FEP                      */
      738     2173    1           CALL GETFD(ANSBUF.TXT,16) ALTRET(CAT9E); /* Default OK                */
      739     2174    1           IF ALPHA_FLG='1'B THEN GOTO CAT9; /* It has to be decimal             */
      740     2175    1           CALL CHARBIN(FEPIOM,SUBSTR(ANS,0,FIELD_LEN));
      741     2176    1           IF FEPIOM>%HIGHEST_IOM THEN GOTO CAT9;
      742     2177    1           CALL GETFD(SUBSTR(ANSBUF.TXT,FIELD_LEN+1),16-FIELD_LEN-1) ALTRET(CAT9);
      743     2178    1           IF ALPHA_FLG='1'B THEN GOTO CAT9;
      744     2179    1             ELSE;
      745     2180    1           CALL CHARBIN(FEPCHAN,SUBSTR(ANS,0,FIELD_LEN));
      746     2181    1           IF FEPCHAN>HIGHEST_CHAN THEN GOTO CAT9;
      747     2182    1   CAT9E:  ;
      748     2183    1   TYPE_SIZE: ENTRY ALTRET;
      749     2184    1           IF RCV_FLG.RBO='1'B THEN CALL TYPEC(RCVRM);
      750     2185    1           IS_PPUT_SIZE = HIPAGE;
      751     2186    2           IF RPM_FLG THEN DO;
      752     2187    2                 I = RPM_BOOTIN.IMX#;
      753     2188    3                 CALL DO_SCU_STATE(I) WHENRETURN DO;
      754     2189    4                       IF IS_CFG_TYPE = %IS_CFG_MULT_CAB_REL# THEN DO;
      755     2190    4                             UPPER_SCU.UPP_BND = MCA_CFG.PORT_INFO.START_ADDR(1) * 1024
              2190                                      +
      756     2191    4                               MCA_CFG.PORT_INFO.SIZE(1) * 256 -1;
      757     2192    4                             UPPER_SCU.LOW_BND = MCA_CFG.PORT_INFO.START_ADDR(1) * 1024
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:69   
              2192                                      ;
      758     2193    4                             IS_PPUT_SIZE = UPPER_SCU.UPP_BND;
      759     2194    4                             GAP_SZ = UPPER_SCU.LOW_BND - LOWER_SCU.UPP_BND-1;
      760     2195    4                           END;
      761     2196    3                     END;
      762     2197    2               END;
      763     2198    2           IF ORDBFLG='0'B THEN DO;
      764     2199    2                 AM2MS = AM2MS_FIXED;
      765     2200                                                /* Type mem size                      */
      766     2201    2                 MESSAGE$=ADDR(AM2MS);
      767     2202    2                 IF IS_CFG_TYPE = %IS_CFG_MULT_CAB_REL# THEN
      768     2203    2                   CALL BINCHAR(SUBSTR(TEXTM.TXT,32,6),HIPAGE+1);
      769     2204    2                   ELSE
      770     2205    2                   CALL BINCHAR(SUBSTR(TEXTM.TXT,32,6),HIPAGE+1-GAP_SZ);
      771     2206    3                 DO WHILE (SUBSTR(TEXTM.TXT,32,1)='0');
      772     2207    3                   SUBSTR(TEXTM.TXT,32)=SUBSTR(TEXTM.TXT,33);
      773     2208    3                   TEXTM.CNT = TEXTM.CNT - 1;
      774     2209    3                 END;
      775     2210    2                 CALL TYPEC(AM2MS);
      776     2211    2                 RETURN;
      777     2212    2               END;                        /* THEN                               */
      778     2213    2             ELSE DO;
      779     2214    2                 ALTRETURN;
      780     2215    2               END;                        /*ELSE                                */
      781     2216    1   HELPTB:
      782     2217    1           CALL TYPEC(HELPA);
      783     2218    1   HELPDBOR:
      784     2219    1           CALL TYPEC(HELPD);
      785     2220    1           IF ORDBFLG~='0'B THEN GOTO HELPALL;
      786     2221    1             ELSE;
      787     2222    1           CALL TYPEC(HELPP);
      788     2223    1           CALL TYPEC(HELPX);
      789     2224    1           CALL TYPEC(HELPF);
      790     2225    1   HELPALL:
      791     2226    1           CALL TYPEC(HELPY);
      792     2227    1           CALL TYPEC(HELPN);
      793     2228    1           IF ORDBFLG='0'B THEN GOTO Q1;
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:70   
      794     2229    1             ELSE GOTO Q2;
      795     2230    1   END PUSSYCAT_PL6;
      796     2231        %EOD;

PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:71   
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure PUSSYCAT_PL6.

   Procedure PUSSYCAT_PL6 requires 1121 words for executable code.
   Procedure PUSSYCAT_PL6 requires 26 words of local(AUTO) storage.

PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:72   

 Object Unit name= PUSSYCAT_PL6                               File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:52:11.20 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none   177    261  PUSSYCAT_PL6
    1  RoData even  UTS     18     22  PUSSYCAT_PL6
    2   Proc  even  none  1121   2141  PUSSYCAT_PL6
    3  RoData even  none    51     63  PUSSYCAT_PL6

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        0  PUSSYCAT_PL6
     2   1734          yes     yes      Std        0  TYPE_SIZE
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:73   

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  OCZONE                             0      2  IMWBASE
    0      3  TYPEBI                             0      4  URCHN
    0      5  FEPIOM                             0      6  FEPCHAN
    0      7  MDELTAFLG                          0     10  BOOTINFO
    0     12  SILENT                             0     13  TBDBORQ
    0     17  HUHHH                              0     37  Q1Q
    0     54  Q2Q                                0     70  CATQU
    0    100  CATQCH                             0    107  CATQFEP
    0    114  HELPY                              0    124  HELPN
    0    134  HELPA                              0    150  HELPD
    0    162  HELPP                              0    175  HELPX
    0    205  HELPF                              0    216  AM2MS
    0    233  AM2MS_FIXED                        0    250  RCVRM

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 DO_RPM_CFG
         yes           Std       0 READ_CONNECT_TABLE
         yes           Std       4 DOIO
         yes           Std       1 TYPEC
 yes     yes           Std       2 KEYIN
 yes     yes           Std       2 GETFD
 yes     yes           Std       1 DO_SCU_STATE
         yes           Std       2 UPPER_CASE
 yes     yes           Std       1 DO_RPM_TIME
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:74   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DEVINFO                               IOMTAB                                CONNECT_TABLE
     RPM_BOOTIN                            RPM_BOOT_IDCW                         ORDBFLG
     RCV_FLG                               VOFLG                                 ADPXF
     BOOTTAPE                              FW_LOAD                               TIGRPA
     MONPA                                 RUMPA                                 PLVPA
     CONS_DCWS                             CONS_MBX                              SH_MBX
     PATT_MBX                              MCA_CFG                               RPM_CONSOLE
     RPM_FLG                               S1000_FLG                             SH_DCWS
     B_VERSION                             CONS_INFO                             ANSBUF
     FIELD$                                FIELD_LEN                             ALPHA_FLG
     HIPAGE                                GAP_SZ                                LOWER_SCU
     UPPER_SCU                             IS_CFG_TYPE                           IS_PPUT_SIZE
     CHN_CFG                               B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:75   


      320        1        /*T***********************************************************/
      321        2        /*T*                                                         */
      322        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      323        4        /*T*                                                         */
      324        5        /*T***********************************************************/
      325        6        /**/
      326        7        PUSSYCAT_PL6:PROC ALTRET;

      7  2 000000   000000 700200 xent  PUSSYCAT_PL6 TSX0  ! X66_AUTO_0
         2 000001   000032 000000                    ZERO    26,0

      327        8        /* This procedure gets AARDVARK configuration */
      328        9        %INCLUDE IS$MACROS;
      329     1284        %DEVINFO(STCLASS="SYMREF");
      330     1353        %IOM_TAB(NAME=IOMTAB,STCLASS="SYMREF");
      331     1370        %CONNECT_TAB(NAME=CONNECT_TABLE,STCLASS="SYMREF");
      332     1390        %DOIO_COMZONE(NAME=OCZONE);
      333     1423        /**/
      334     1424    1   DCL IMWBASE STATIC SYMDEF UBIN WORD INIT(0);
      335     1425    1   DCL TYPEBI BIT(36) STATIC SYMDEF INIT('510000000001'O); /* Write alert        */
      336     1426    1   DCL URCHN STATIC SYMDEF UBIN WORD INIT(24); /* UR base chann                  */
      337     1427    1   DCL FEPIOM STATIC SYMDEF UBIN WORD INIT(0); /* FEP IOM                        */
      338     1428    1   DCL FEPCHAN STATIC SYMDEF UBIN WORD INIT(33); /* FEP Chann                    */
      339     1429    1   DCL MDELTAFLG STATIC SYMDEF UBIN WORD INIT(0); /* Flag for MDELTA call        */
      340     1430    1   DCL 1 BOOTINFO STATIC SYMDEF ALIGNED,
      341     1431    1         2 BCHN UBIN(9) UNAL INIT(0),
      342     1432    1         2 * BIT(24),
      343     1433    1         2 BPORT# UBIN(3) UNAL INIT(0),
      344     1434    1         2 BIOMAD UBIN(18) UNAL INIT(0),
      345     1435    1         2 BIMWAD UBIN(13) UNAL INIT(0),
      346     1436    1         2 * BIT(3),
      347     1437    1         2 BIOM# UBIN(2) UNAL INIT(0);
      348     1438    1   DCL 1 RPM_BOOTIN SYMREF,
      349     1439    1         2 * BIT(9),
      350     1440    1         2 CHN# UBIN(9) UNAL,
      351     1441    1         2 * BIT (7),
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:76   
      352     1442    1         2 IMX# UBIN(2) UNAL,
      353     1443    1         2 * BIT (9);
      354     1444    1   DCL 1 RPM_BOOT_IDCW SYMREF,
      355     1445    1         2 * BIT(6),
      356     1446    1         2 DEV# UBIN(6) UNAL,
      357     1447    1         2 * BIT(24) UNAL;
      358     1448    1   DCL 1 ORDBFLG SYMREF,
      359     1449    1         2 ORF BIT(1),
      360     1450    1         2 DBF BIT(1);
      361     1451    1   DCL 1 RCV_FLG SYMREF,
      362     1452    1         2 RC BIT(1),
      363     1453    1         2 DB BIT(1),
      364     1454    1         2 RBD BIT(1),
      365     1455    1         2 RBO BIT(1);
      366     1456    1   DCL VOFLG BIT(1) SYMREF;
      367     1457    1   DCL 1 ADPXF SYMREF,
      368     1458    1         2 A BIT(1),
      369     1459    1         2 D BIT(1),
      370     1460    1         2 P BIT(1),
      371     1461    1         2 X BIT(1),
      372     1462    1         2 F BIT(1);
      373     1463        /**/
      374     1464    1   DCL BOOTTAPE UBIN WORD SYMREF;
      375     1465    1   DCL FW_LOAD(0:511) BIT(1) UNAL SYMREF;
      376     1466    1   DCL TIGRPA BIT(1) SYMREF;
      377     1467    1   DCL MONPA BIT(1) SYMREF;
      378     1468    1   DCL RUMPA BIT(1) SYMREF;
      379     1469    1   DCL PLVPA BIT(1) SYMREF;
      380     1470    1   DCL SILENT BIT(1) STATIC SYMDEF INIT('0'B); /* Write FW names                 */
      381     1471    1   DCL MESSAGE CHAR(80) SYMREF;
      382     1472    1   DCL MESSAGE_CNT UBIN SYMREF;
      383     1473    1   DCL CONS_DCWS BIT(1) SYMREF;            /* Console DCWs on RPM                */
      384     1474        %IMX_MBX(NAME=CONS_MBX,STCLASS="SYMREF"); /* Cons MAILBOX on an RPM           */
      385     1531        %IMX_MBX(NAME=SH_MBX,STCLASS="SYMREF"); /* Shared MAILBOX on an RPM           */
      386     1588        %IMX_MBX(NAME=PATT_MBX,STCLASS="SYMREF"); /* Mailbox Pattern                  */
      387     1645        %MCA_CFG(STCLASS="SYMREF");
      388     1755    1   DCL   RPM_CONSOLE SBIN WORD SYMREF;
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:77   
      389     1756    1   DCL RPM_FLG BIT(1) SYMREF;
      390     1757    1   DCL S1000_FLG BIT(1) SYMREF;
      391     1758    1   DCL SH_DCWS BIT(1) SYMREF;              /* Shared DCWs on RPM                 */
      392     1759    1   DCL   HIGHEST_CHAN UBIN WORD;
      393     1760    1   DCL 1 B_VERSION CALIGNED SYMREF,
      394     1761    1         2 L UBIN BYTE UNAL,
      395     1762    1         2 C CHAR(B_VERSION.L);
      396     1763    1   DCL 1 CONS_INFO SYMREF,
      397     1764    1         2 * BIT(6),
      398     1765    1         2 PORT# UBIN(3) UNAL,
      399     1766    1         2 IOM# UBIN(3) UNAL,
      400     1767    1         2 CHN# UBIN(6) UNAL;
      401     1768    1   DCL 1 ANSBUF SYMREF,
      402     1769    1         2 CNT UBIN WORD,
      403     1770    1         2 TXT CHAR(16);
      404     1771    1   DCL 1 TEXTM BASED(MESSAGE$),
      405     1772    1         2 CNT UBIN WORD,
      406     1773    1         2 TXT CHAR(TEXTM.CNT);
      407     1774    1   DCL MESSAGE$ PTR;
      408     1775    1   DCL FIELD$ PTR SYMREF;                  /* Result from GETFD                  */
      409     1776    1   DCL FIELD_LEN UBIN WORD SYMREF;         /* Result from GETFD                  */
      410     1777    1   DCL DECIM_FLG BIT(1) SYMREF;            /* Result from GETFD                  */
      411     1778    1   DCL ALPHA_FLG BIT(1) SYMREF;            /* Result from GETFD                  */
      412     1779    1   DCL HIPAGE UBIN WORD SYMREF;
      413     1780    1   DCL GAP_SZ UBIN WORD SYMREF;
      414     1781    1   DCL 1 LOWER_SCU SYMREF,
      415     1782    1         2 LOW_BND UBIN WORD,
      416     1783    1         2 UPP_BND UBIN WORD;
      417     1784    1   DCL 1 UPPER_SCU SYMREF,
      418     1785    1         2 LOW_BND UBIN WORD,
      419     1786    1         2 UPP_BND UBIN WORD;
      420     1787    1   DCL IS_CFG_TYPE UBIN SYMREF;
      421     1788    1   DCL IS_PPUT_SIZE UBIN WORD SYMREF;
      422     1789    1   DCL IS_MEM_SIDE1 BIT(1) SYMREF;
      423     1790    1   DCL CHN_CFG(0:511) BIT(1) UNAL SYMREF;
      424     1791        /* Messages */
      425     1792        %TEXTC(N#=TBDBORQ,M#="'TB/DB/OR/VO?'");
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:78   
      426     1797       %TEXTC(N#=HUHHH,M#="'Consult your System Services Manual for help in booting CP-6'")
              1797            ;
      427     1802        %TEXTC(N#=Q1Q,M#="'Change boot options (Y/N)/(ADPXF)/(? for help)?'");
      428     1807        %TEXTC(N#=Q2Q,M#="'Change boot options (Y/N)/(D)/(? for help)?'");
      429     1812        %TEXTC(N#=CATQU,M#="' URC assignments OK (Y/N)?'");
      430     1817        %TEXTC(N#=CATQCH,M#="'  URC base channel# = '");
      431     1822        %TEXTC(N#=CATQFEP,M#="' FEP 0-033=FEP'");
      432     1827        %TEXTC(N#=HELPY,M#="'Y-All of the above options.'");
      433     1832        %TEXTC(N#=HELPN,M#="'N-None of the above options.'");
      434     1837        %TEXTC(N#=HELPA,M#="'A-Read AARDVARK patches before continuing.'");
      435     1842        %TEXTC(N#=HELPD,M#="'D-Change default device assignments.'");
      436     1847        %TEXTC(N#=HELPP,M#="'P-Change default patching directions.'");
      437     1852        %TEXTC(N#=HELPX,M#="'X-Retain XDELTA in memory.'");
      438     1857        %TEXTC(N#=HELPF,M#="'F-Read firmware from IFAD tape.'");
      439     1862        %TEXTC(N#=AM2MS,M#="'The memory available to CP-6 is xxxxxx pages.'");
      440     1867        %TEXTC(N#=AM2MS_FIXED,M#="'The memory available to CP-6 is xxxxxx pages.'");
      441     1872        %TEXTC(N#=RCVRM,M#="' Recovery says-HANG LOOSE... '");
      442     1877    1   DCL AARDVARK_NAME CHAR(0) CONSTANT INIT('AARDVARK ');
      443     1878    1   DCL AARDVARK_SERVICE CHAR(0) CONSTANT INIT(' at your service');
      444     1879        /**/
      445     1880    1   DCL TIME_OUT UBIN WORD;
      446     1881    1   DCL   CHG_IOM UBIN WORD;
      447     1882    1   DCL   CHG_CHN UBIN WORD;
      448     1883    1   DCL I UBIN WORD;
      449     1884    1   DCL COMMAND$ PTR;
      450     1885    1   DCL ANS CHAR(16) BASED(FIELD$);
      451     1886    1   DCL 1 BUILT_MES,
      452     1887    1         2 CNT UBIN WORD,
      453     1888    1         2 TXT CHAR(40);
      454     1889        /**/
      455     1890    1   DCL DOIO ENTRY(4);
      456     1891    1   DCL   DO_RPM_CFG ENTRY(1) ALTRET;
      457     1892    1   DCL   DO_SCU_STATE ENTRY(1) ALTRET;
      458     1893    1   DCL  DO_RPM_TIME ENTRY(1) ALTRET;
      459     1894    1   DCL KEYIN ENTRY(2) ALTRET;
      460     1895    1   DCL TYPEC ENTRY(1);
      461     1896    1   DCL UPPER_CASE ENTRY(2);
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:79   
      462     1897    1   DCL GETFD ENTRY(2) ALTRET;
      463     1898    1   DCL   READ_CONNECT_TABLE ENTRY;
      464     1899        /**/
      465     1900        /** Code **/
      466     1901    1           HIGHEST_CHAN = %HIGH_CHAN;

   1901  2 000002   000077 235007                    LDA     63,DL
         2 000003   200003 755100                    STA     HIGHEST_CHAN,,AUTO

      467     1902    2           IF RPM_FLG THEN DO;   /* Fake BOOTINFO and change DEVINFO defaults    */

   1902  2 000004   000000 234000 xsym               SZN     RPM_FLG
         2 000005   000132 605000 2                  TPL     s:1925

      468     1903    2                 HIGHEST_CHAN = %HIGH_RPM_CHAN;

   1903  2 000006   000177 236007                    LDQ     127,DL
         2 000007   200003 756100                    STQ     HIGHEST_CHAN,,AUTO

      469     1904    2                 BOOTINFO.BCHN=RPM_BOOTIN.CHN#;

   1904  2 000010   000000 236000 xsym               LDQ     RPM_BOOTIN
         2 000011   000011 736000                    QLS     9
         2 000012   000010 552040 0                  STBQ    BOOTINFO,'40'O

      470     1905    2                 BOOTINFO.BIOM#=RPM_BOOTIN.IMX#;

   1905  2 000013   000000 236000 xsym               LDQ     RPM_BOOTIN
         2 000014   000011 772000                    QRL     9
         2 000015   000011 676000 0                  ERQ     BOOTINFO+1
         2 000016   000003 376007                    ANQ     3,DL
         2 000017   000011 656000 0                  ERSQ    BOOTINFO+1

      471     1906    2                 URCHN = 40;

   1906  2 000020   000050 236007                    LDQ     40,DL
         2 000021   000004 756000 0                  STQ     URCHN
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:80   

      472     1907    2                 FEPCHAN = 46;

   1907  2 000022   000056 235007                    LDA     46,DL
         2 000023   000006 755000 0                  STA     FEPCHAN

      473     1908    2                 MESSAGE$ = ADDR(CATQFEP);

   1908  2 000024   000000 236000 3                  LDQ     0
         2 000025   200004 756100                    STQ     MESSAGE$,,AUTO

      474     1909    2                 SUBSTR(TEXTM.TXT,8,2) = '46';

   1909  2 000026   200004 470500                    LDP0    MESSAGE$,,AUTO
         2 000027   000000 720100                    LXL0    0,,PR0
         2 000030   000007 221000 1                  LDX1    AARDVARK_SERVICE+4
         2 000031   000003 741100                    STX1    3,,PR0

      475     1910    2                 CALL BINCHAR(SUBSTR(TEXTM.TXT,5,1),BOOTINFO.BIOM#);

   1910  2 000032   000011 236000 0                  LDQ     BOOTINFO+1
         2 000033   000003 376007                    ANQ     3,DL
         2 000034   000000 235003                    LDA     0,DU
         2 000035   200026 757100                    STAQ    BUILT_MES+12,,AUTO
         2 000036   000100 301500                    BTD
         2 000037   200026 000010                    NDSC9   BUILT_MES+12,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         2 000040   000002 230001                    NDSC9   2,,PR0                   cn=1,s=nosgn,sf=0,n=1

      476     1911    3                 DO I = %FRSTLP TO %FRSTLP + %LP# -1;

   1911  2 000041   000001 236007                    LDQ     1,DL
         2 000042   200010 756100                    STQ     I,,AUTO
         2 000043   000060 710000 2                  TRA     s:1914+3

      477     1912    3                   DEVINFO.CHN#(I) = 40;

   1912  2 000044   200010 236100                    LDQ     I,,AUTO
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:81   
         2 000045   000014 402007                    MPY     12,DL
         2 000046   000000 620006                    EAX0    0,QL
         2 000047   000000 236006 xsym               LDQ     DEVINFO,QL
         2 000050   000032 376000 xsym               ANQ     B_VECTNIL+26
         2 000051   050000 276003                    ORQ     20480,DU
         2 000052   000000 756010 xsym               STQ     DEVINFO,X0

      478     1913    3                   SUBSTR(DEVINFO.DEVNAME(I),6,2) = '40';

   1913  2 000053   000010 221000 1                  LDX1    AARDVARK_SERVICE+5
         2 000054   000007 441010 xsym               SXL1    DEVINFO+7,X0

      479     1914    3                 END;

   1914  2 000055   200010 235100                    LDA     I,,AUTO
         2 000056   000001 035007                    ADLA    1,DL
         2 000057   200010 755100                    STA     I,,AUTO
         2 000060   200010 235100                    LDA     I,,AUTO
         2 000061   000002 115007                    CMPA    2,DL
         2 000062   000044 602000 2                  TNC     s:1912

      480     1915    3                 DO I = %FRSTCR TO %FRSTCR + %CR# -1;

   1915  2 000063   000002 236007                    LDQ     2,DL
         2 000064   200010 756100                    STQ     I,,AUTO
         2 000065   000102 710000 2                  TRA     s:1918+3

      481     1916    3                   DEVINFO.CHN#(I) = 38;

   1916  2 000066   200010 236100                    LDQ     I,,AUTO
         2 000067   000014 402007                    MPY     12,DL
         2 000070   000000 620006                    EAX0    0,QL
         2 000071   000000 236006 xsym               LDQ     DEVINFO,QL
         2 000072   000032 376000 xsym               ANQ     B_VECTNIL+26
         2 000073   046000 276003                    ORQ     19456,DU
         2 000074   000000 756010 xsym               STQ     DEVINFO,X0

PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:82   
      482     1917    3                   SUBSTR(DEVINFO.DEVNAME(I),6,2) = '38';

   1917  2 000075   000011 221000 1                  LDX1    AARDVARK_SERVICE+6
         2 000076   000007 441010 xsym               SXL1    DEVINFO+7,X0

      483     1918    3                 END;

   1918  2 000077   200010 235100                    LDA     I,,AUTO
         2 000100   000001 035007                    ADLA    1,DL
         2 000101   200010 755100                    STA     I,,AUTO
         2 000102   200010 235100                    LDA     I,,AUTO
         2 000103   000003 115007                    CMPA    3,DL
         2 000104   000066 602000 2                  TNC     s:1916

      484     1919    3                 DO I = %FRSTDP TO %FRSTDP + %DP# -1;

   1919  2 000105   000024 236007                    LDQ     20,DL
         2 000106   200010 756100                    STQ     I,,AUTO
         2 000107   000127 710000 2                  TRA     s:1922+3

      485     1920    3                   DEVINFO.CHN#(I) = 64;

   1920  2 000110   200010 236100                    LDQ     I,,AUTO
         2 000111   000014 402007                    MPY     12,DL
         2 000112   000000 620006                    EAX0    0,QL
         2 000113   000000 236006 xsym               LDQ     DEVINFO,QL
         2 000114   000032 376000 xsym               ANQ     B_VECTNIL+26
         2 000115   100000 276003                    ORQ     32768,DU
         2 000116   000000 756010 xsym               STQ     DEVINFO,X0

      486     1921    3                   SUBSTR(DEVINFO.DEVNAME(I),3,2) = '64';

   1921  2 000117   200010 236100                    LDQ     I,,AUTO
         2 000120   000060 402007                    MPY     48,DL
         2 000121   040006 100400                    MLR     fill='040'O
         2 000122   000012 000002 1                  ADSC9   AARDVARK_SERVICE+7       cn=0,n=2
         2 000123   000006 600002 xsym               ADSC9   DEVINFO+6,Q              cn=3,n=2
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:83   

      487     1922    3                 END;

   1922  2 000124   200010 235100                    LDA     I,,AUTO
         2 000125   000001 035007                    ADLA    1,DL
         2 000126   200010 755100                    STA     I,,AUTO
         2 000127   200010 235100                    LDA     I,,AUTO
         2 000130   000026 115007                    CMPA    22,DL
         2 000131   000110 602000 2                  TNC     s:1920

      488     1923    2               END;

      489     1924        /* Fill device tables with IOM number */
      490     1925    2           DO I=0 TO %DIM-1;

   1925  2 000132   200010 450100                    STZ     I,,AUTO
         2 000133   000147 710000 2                  TRA     s:1927+3

      491     1926    2             DEVINFO.IOM#(I)=BOOTINFO.BIOM#;

   1926  2 000134   200010 236100                    LDQ     I,,AUTO
         2 000135   000014 402007                    MPY     12,DL
         2 000136   000000 620006                    EAX0    0,QL
         2 000137   000011 236000 0                  LDQ     BOOTINFO+1
         2 000140   000023 736000                    QLS     19
         2 000141   000000 676010 xsym               ERQ     DEVINFO,X0
         2 000142   000006 376003                    ANQ     6,DU
         2 000143   000000 656010 xsym               ERSQ    DEVINFO,X0

      492     1927    2           END;                            /* DO                                 */

   1927  2 000144   200010 235100                    LDA     I,,AUTO
         2 000145   000001 035007                    ADLA    1,DL
         2 000146   200010 755100                    STA     I,,AUTO
         2 000147   200010 235100                    LDA     I,,AUTO
         2 000150   000026 115007                    CMPA    22,DL
         2 000151   000134 602000 2                  TNC     s:1926
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:84   

      493     1928        /* Fill device table for tapes with channel and
      494     1929                                            device number */
      495     1930    2           DO I=%FRSTMT TO %FRSTDP-1;

   1930  2 000152   000003 236007                    LDQ     3,DL
         2 000153   200010 756100                    STQ     I,,AUTO
         2 000154   000175 710000 2                  TRA     s:1933+3

      496     1931    2             DEVINFO.CHN#(I)=BOOTINFO.BCHN;

   1931  2 000155   200010 236100                    LDQ     I,,AUTO
         2 000156   000014 402007                    MPY     12,DL
         2 000157   000000 620006                    EAX0    0,QL
         2 000160   000010 236000 0                  LDQ     BOOTINFO
         2 000161   000000 676010 xsym               ERQ     DEVINFO,X0
         2 000162   777000 376003                    ANQ     -512,DU
         2 000163   000000 656010 xsym               ERSQ    DEVINFO,X0

      497     1932    2             DEVINFO.DEV#(I)=I-%FRSTMT;

   1932  2 000164   200010 236100                    LDQ     I,,AUTO
         2 000165   000003 136007                    SBLQ    3,DL
         2 000166   000025 736000                    QLS     21
         2 000167   000000 676010 xsym               ERQ     DEVINFO,X0
         2 000170   000770 376003                    ANQ     504,DU
         2 000171   000000 656010 xsym               ERSQ    DEVINFO,X0

      498     1933    2           END;                            /* DO                                 */

   1933  2 000172   200010 235100                    LDA     I,,AUTO
         2 000173   000001 035007                    ADLA    1,DL
         2 000174   200010 755100                    STA     I,,AUTO
         2 000175   200010 235100                    LDA     I,,AUTO
         2 000176   000024 115007                    CMPA    20,DL
         2 000177   000155 602000 2                  TNC     s:1931

PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:85   
      499     1934    2           DO I=0 TO %FRSTMT-1;

   1934  2 000200   200010 450100                    STZ     I,,AUTO
         2 000201   000220 710000 2                  TRA     s:1936+3

      500     1935    2             CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(I),3,1),BOOTINFO.BIOM#);

   1935  2 000202   200010 236100                    LDQ     I,,AUTO
         2 000203   000060 402007                    MPY     48,DL
         2 000204   200026 756100                    STQ     BUILT_MES+12,,AUTO
         2 000205   000011 236000 0                  LDQ     BOOTINFO+1
         2 000206   000003 376007                    ANQ     3,DL
         2 000207   000000 235003                    LDA     0,DU
         2 000210   200030 757100                    STAQ    BUILT_MES+14,,AUTO
         2 000211   200026 235100                    LDA     BUILT_MES+12,,AUTO
         2 000212   000005 301500                    BTD
         2 000213   200030 000010                    NDSC9   BUILT_MES+14,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         2 000214   000006 630001 xsym               NDSC9   DEVINFO+6,A              cn=3,s=nosgn,sf=0,n=1

      501     1936    2           END;                            /* DO                                 */

   1936  2 000215   200010 235100                    LDA     I,,AUTO
         2 000216   000001 035007                    ADLA    1,DL
         2 000217   200010 755100                    STA     I,,AUTO
         2 000220   200010 235100                    LDA     I,,AUTO
         2 000221   000003 115007                    CMPA    3,DL
         2 000222   000202 602000 2                  TNC     s:1935

      502     1937    2           DO I=%FRSTMT TO %DIM-1;

   1937  2 000223   000003 236007                    LDQ     3,DL
         2 000224   200010 756100                    STQ     I,,AUTO
         2 000225   000244 710000 2                  TRA     s:1939+3

      503     1938    2             CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(I),0,1),BOOTINFO.BIOM#);

   1938  2 000226   200010 236100                    LDQ     I,,AUTO
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:86   
         2 000227   000060 402007                    MPY     48,DL
         2 000230   200026 756100                    STQ     BUILT_MES+12,,AUTO
         2 000231   000011 236000 0                  LDQ     BOOTINFO+1
         2 000232   000003 376007                    ANQ     3,DL
         2 000233   000000 235003                    LDA     0,DU
         2 000234   200030 757100                    STAQ    BUILT_MES+14,,AUTO
         2 000235   200026 235100                    LDA     BUILT_MES+12,,AUTO
         2 000236   000005 301500                    BTD
         2 000237   200030 000010                    NDSC9   BUILT_MES+14,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         2 000240   000006 030001 xsym               NDSC9   DEVINFO+6,A              cn=0,s=nosgn,sf=0,n=1

      504     1939    2           END;                            /* DO                                 */

   1939  2 000241   200010 235100                    LDA     I,,AUTO
         2 000242   000001 035007                    ADLA    1,DL
         2 000243   200010 755100                    STA     I,,AUTO
         2 000244   200010 235100                    LDA     I,,AUTO
         2 000245   000026 115007                    CMPA    22,DL
         2 000246   000226 602000 2                  TNC     s:1938

      505     1940    2           DO I=%FRSTMT TO %FRSTDP-1;

   1940  2 000247   000003 236007                    LDQ     3,DL
         2 000250   200010 756100                    STQ     I,,AUTO
         2 000251   000300 710000 2                  TRA     s:1943+3

      506     1941    2             CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(I),2,3),BOOTINFO.BCHN);

   1941  2 000252   200010 236100                    LDQ     I,,AUTO
         2 000253   000060 402007                    MPY     48,DL
         2 000254   200026 756100                    STQ     BUILT_MES+12,,AUTO
         2 000255   000010 236000 0                  LDQ     BOOTINFO
         2 000256   000033 772000                    QRL     27
         2 000257   000000 235003                    LDA     0,DU
         2 000260   200030 757100                    STAQ    BUILT_MES+14,,AUTO
         2 000261   200026 235100                    LDA     BUILT_MES+12,,AUTO
         2 000262   000005 301500                    BTD
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:87   
         2 000263   200030 000010                    NDSC9   BUILT_MES+14,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         2 000264   000006 430003 xsym               NDSC9   DEVINFO+6,A              cn=2,s=nosgn,sf=0,n=3

      507     1942    2             CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(I),6,2),(I-%FRSTMT));

   1942  2 000265   200010 236100                    LDQ     I,,AUTO
         2 000266   000060 402007                    MPY     48,DL
         2 000267   200010 235100                    LDA     I,,AUTO
         2 000270   000003 135007                    SBLA    3,DL
         2 000271   200026 755100                    STA     BUILT_MES+12,,AUTO
         2 000272   000006 301500                    BTD
         2 000273   200026 000004                    NDSC9   BUILT_MES+12,,AUTO       cn=0,s=lsgnf,sf=0,n=4
         2 000274   000007 430002 xsym               NDSC9   DEVINFO+7,Q              cn=2,s=nosgn,sf=0,n=2

      508     1943    2           END;                            /* DO                                 */

   1943  2 000275   200010 235100                    LDA     I,,AUTO
         2 000276   000001 035007                    ADLA    1,DL
         2 000277   200010 755100                    STA     I,,AUTO
         2 000300   200010 235100                    LDA     I,,AUTO
         2 000301   000024 115007                    CMPA    20,DL
         2 000302   000252 602000 2                  TNC     s:1941

      509     1944        /* Fill in MAILBOX and DCWs addr. on an RPM */
      510     1945    2           IF RPM_FLG THEN DO;

   1945  2 000303   000000 234000 xsym               SZN     RPM_FLG
         2 000304   000460 605000 2                  TPL     s:1972

      511     1946    2                 CONS_MBX = PATT_MBX;

   1946  2 000305   000000 100400                    MLR     fill='000'O
         2 000306   000000 000140 xsym               ADSC9   PATT_MBX                 cn=0,n=96
         2 000307   000000 000140 xsym               ADSC9   CONS_MBX                 cn=0,n=96

      512     1947    2                 SH_MBX = PATT_MBX;

PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:88   
   1947  2 000310   000000 100400                    MLR     fill='000'O
         2 000311   000000 000140 xsym               ADSC9   PATT_MBX                 cn=0,n=96
         2 000312   000000 000140 xsym               ADSC9   SH_MBX                   cn=0,n=96

      513     1948    2                 DEVINFO.RPM_PTRS.MBX$(0)=ADDR(CONS_MBX);

   1948  2 000313   000001 236000 3                  LDQ     1
         2 000314   000002 756000 xsym               STQ     DEVINFO+2

      514     1949    2                 DEVINFO.RPM_PTRS.EF_DCWS$(0)=ADDR(CONS_DCWS);

   1949  2 000315   000002 236000 3                  LDQ     2
         2 000316   000003 756000 xsym               STQ     DEVINFO+3

      515     1950    3                 DO I=%FRSTLP TO %DIM-1;

   1950  2 000317   000001 235007                    LDA     1,DL
         2 000320   200010 755100                    STA     I,,AUTO
         2 000321   000334 710000 2                  TRA     s:1953+3

      516     1951    3                   DEVINFO.RPM_PTRS.MBX$(I)=ADDR(SH_MBX);

   1951  2 000322   200010 236100                    LDQ     I,,AUTO
         2 000323   000014 402007                    MPY     12,DL
         2 000324   000000 620006                    EAX0    0,QL
         2 000325   000003 236000 3                  LDQ     3
         2 000326   000002 756010 xsym               STQ     DEVINFO+2,X0

      517     1952    3                   DEVINFO.RPM_PTRS.EF_DCWS$(I)=ADDR(SH_DCWS);

   1952  2 000327   000004 236000 3                  LDQ     4
         2 000330   000003 756010 xsym               STQ     DEVINFO+3,X0

      518     1953    3                 END;                      /* DO I=                              */

   1953  2 000331   200010 235100                    LDA     I,,AUTO
         2 000332   000001 035007                    ADLA    1,DL
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:89   
         2 000333   200010 755100                    STA     I,,AUTO
         2 000334   000026 115007                    CMPA    22,DL
         2 000335   000322 602000 2                  TNC     s:1951

      519     1954    2                 I = RPM_BOOTIN.IMX#;

   1954  2 000336   000000 236000 xsym               LDQ     RPM_BOOTIN
         2 000337   000011 772000                    QRL     9
         2 000340   000003 376007                    ANQ     3,DL
         2 000341   200010 756100                    STQ     I,,AUTO

      520     1955    2                 CALL DO_RPM_CFG(I);

   1955  2 000342   200010 630500                    EPPR0   I,,AUTO
         2 000343   200026 450500                    STP0    BUILT_MES+12,,AUTO
         2 000344   200026 630500                    EPPR0   BUILT_MES+12,,AUTO
         2 000345   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000346   000000 701000 xent               TSX1    DO_RPM_CFG
         2 000347   000000 011000                    NOP     0

      521     1956    2                 IF NOT FW_LOAD(DEVINFO.IOM#(%FRSTMT+BOOTTAPE)*128 + DEVINFO.CHN#(%
              1956                          FRSTMT+BOOTTAPE)) THEN

   1956  2 000350   000000 236000 xsym               LDQ     BOOTTAPE
         2 000351   000014 402007                    MPY     12,DL
         2 000352   000044 236006 xsym               LDQ     DEVINFO+36,QL
         2 000353   000033 772000                    QRL     27
         2 000354   200026 756100                    STQ     BUILT_MES+12,,AUTO
         2 000355   000000 236000 xsym               LDQ     BOOTTAPE
         2 000356   000014 402007                    MPY     12,DL
         2 000357   000044 236006 xsym               LDQ     DEVINFO+36,QL
         2 000360   000014 772000                    QRL     12
         2 000361   000600 376007                    ANQ     384,DL
         2 000362   200026 036100                    ADLQ    BUILT_MES+12,,AUTO
         2 000363   000000 066406                    CMPB    filb='0'B
         2 000364   000000 000001 xsym               BDSC    FW_LOAD,Q                by=0,bit=0,n=1
         2 000365   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:90   
         2 000366   000374 601000 2                  TNZ     s:1958

      522     1957    2                   BOOTTAPE = %FRSTMT + RPM_BOOT_IDCW.DEV#;

   1957  2 000367   000000 236000 xsym               LDQ     RPM_BOOT_IDCW
         2 000370   000030 772000                    QRL     24
         2 000371   000077 376007                    ANQ     63,DL
         2 000372   000003 036007                    ADLQ    3,DL
         2 000373   000000 756000 xsym               STQ     BOOTTAPE

      523     1958    2                 IF NOT (CHN_CFG(I *128 +64)) THEN

   1958  2 000374   200010 235100                    LDA     I,,AUTO
         2 000375   000007 735000                    ALS     7
         2 000376   000000 066405                    CMPB    filb='0'B
         2 000377   000001 610001 xsym               BDSC    CHN_CFG+1,A              by=3,bit=1,n=1
         2 000400   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 000401   000435 601000 2                  TNZ     s:1965

      524     1959    3                     DO I = %FRSTDP TO %FRSTDP + %DP# -1;

   1959  2 000402   000024 236007                    LDQ     20,DL
         2 000403   200010 756100                    STQ     I,,AUTO
         2 000404   000432 710000 2                  TRA     s:1964+3

      525     1960    3                       DEVINFO.CHN#(I) = 120;

   1960  2 000405   200010 236100                    LDQ     I,,AUTO
         2 000406   000014 402007                    MPY     12,DL
         2 000407   000000 620006                    EAX0    0,QL
         2 000410   000000 236006 xsym               LDQ     DEVINFO,QL
         2 000411   000032 376000 xsym               ANQ     B_VECTNIL+26
         2 000412   170000 276003                    ORQ     61440,DU
         2 000413   000000 756010 xsym               STQ     DEVINFO,X0

      526     1961    3                       DEVINFO.DEV#(I) = 0;

PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:91   
   1961  2 000414   000005 236000 3                  LDQ     5
         2 000415   000000 356010 xsym               ANSQ    DEVINFO,X0

      527     1962    3                       SUBSTR(DEVINFO.DEVNAME(I),2,3) = '120';

   1962  2 000416   200010 236100                    LDQ     I,,AUTO
         2 000417   000060 402007                    MPY     48,DL
         2 000420   040006 100400                    MLR     fill='040'O
         2 000421   000013 000003 1                  ADSC9   AARDVARK_SERVICE+8       cn=0,n=3
         2 000422   000006 400003 xsym               ADSC9   DEVINFO+6,Q              cn=2,n=3

      528     1963    3                       SUBSTR(DEVINFO.DEVNAME(I),7,1) = '0';

   1963  2 000423   000007 236010 xsym               LDQ     DEVINFO+7,X0
         2 000424   000006 376000 3                  ANQ     6
         2 000425   000060 276007                    ORQ     48,DL
         2 000426   000007 756010 xsym               STQ     DEVINFO+7,X0

      529     1964    3                     END;

   1964  2 000427   200010 235100                    LDA     I,,AUTO
         2 000430   000001 035007                    ADLA    1,DL
         2 000431   200010 755100                    STA     I,,AUTO
         2 000432   200010 235100                    LDA     I,,AUTO
         2 000433   000026 115007                    CMPA    22,DL
         2 000434   000405 602000 2                  TNC     s:1960

      530     1965    2                 CALL READ_CONNECT_TABLE;

   1965  2 000435   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000436   000000 701000 xent               TSX1    READ_CONNECT_TABLE
         2 000437   000000 011000                    NOP     0

      531     1966    3                 DO I=0 TO 3;

   1966  2 000440   200010 450100                    STZ     I,,AUTO

PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:92   
      532     1967    3                   IOMTAB.PORT#(I)=CONNECT_TABLE.ENTRI.SCU_PORT(I);

   1967  2 000441   200010 236100                    LDQ     I,,AUTO
         2 000442   000014 402007                    MPY     12,DL
         2 000443   200026 756100                    STQ     BUILT_MES+12,,AUTO
         2 000444   200010 236100                    LDQ     I,,AUTO
         2 000445   000044 402007                    MPY     36,DL
         2 000446   200026 235100                    LDA     BUILT_MES+12,,AUTO
         2 000447   003006 060405                    CSL     bolr='003'O
         2 000450   000000 000003 xsym               BDSC    CONNECT_TABLE,A          by=0,bit=0,n=3
         2 000451   000000 660003 xsym               BDSC    IOMTAB,Q                 by=3,bit=6,n=3

      533     1968    3                 END;                      /* DO                                 */

   1968  2 000452   200010 235100                    LDA     I,,AUTO
         2 000453   000001 035007                    ADLA    1,DL
         2 000454   200010 755100                    STA     I,,AUTO
         2 000455   000004 115007                    CMPA    4,DL
         2 000456   000441 602000 2                  TNC     s:1967

      534     1969    2               END;                        /* THEN                               */

   1969  2 000457   000516 710000 2                  TRA     s:1979

      535     1970    2             ELSE DO;

      536     1971        /* Fill in IOMTAB for all IOM's */
      537     1972    3                 DO I=0 TO 3;

   1972  2 000460   200010 450100                    STZ     I,,AUTO

      538     1973    3                   IOMTAB.MAILBAD(I)=BOOTINFO.BIOMAD-((BOOTINFO.BIOM#-I)*%MBOXSIZ);

   1973  2 000461   000011 236000 0                  LDQ     BOOTINFO+1
         2 000462   000003 376007                    ANQ     3,DL
         2 000463   200010 136100                    SBLQ    I,,AUTO
         2 000464   000011 235000 0                  LDA     BOOTINFO+1
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:93   
         2 000465   000022 771000                    ARL     18
         2 000466   200026 755100                    STA     BUILT_MES+12,,AUTO
         2 000467   000007 402000 3                  MPY     7
         2 000470   200026 036100                    ADLQ    BUILT_MES+12,,AUTO
         2 000471   000000 620006                    EAX0    0,QL
         2 000472   200010 721100                    LXL1    I,,AUTO
         2 000473   000000 740011 xsym               STX0    IOMTAB,X1

      539     1974    3                   IOMTAB.PORT#(I)=BOOTINFO.BPORT#-(BOOTINFO.BIOM#-I);

   1974  2 000474   000011 236000 0                  LDQ     BOOTINFO+1
         2 000475   000003 376007                    ANQ     3,DL
         2 000476   200010 136100                    SBLQ    I,,AUTO
         2 000477   200026 756100                    STQ     BUILT_MES+12,,AUTO
         2 000500   000010 236000 0                  LDQ     BOOTINFO
         2 000501   000007 376007                    ANQ     7,DL
         2 000502   200026 136100                    SBLQ    BUILT_MES+12,,AUTO
         2 000503   000000 676011 xsym               ERQ     IOMTAB,X1
         2 000504   000007 376007                    ANQ     7,DL
         2 000505   000000 656011 xsym               ERSQ    IOMTAB,X1

      540     1975    3                 END;                      /* DO                                 */

   1975  2 000506   200010 235100                    LDA     I,,AUTO
         2 000507   000001 035007                    ADLA    1,DL
         2 000510   200010 755100                    STA     I,,AUTO
         2 000511   000004 115007                    CMPA    4,DL
         2 000512   000461 602000 2                  TNC     s:1973

      541     1976    2                 IMWBASE=BOOTINFO.BIMWAD*32; /* Append 5 bits of 0               */

   1976  2 000513   000011 236000 0                  LDQ     BOOTINFO+1
         2 000514   777740 376007                    ANQ     -32,DL
         2 000515   000002 756000 0                  STQ     IMWBASE

      542     1977    2               END;                        /* ELSE                               */

PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:94   
      543     1978        /* Find lowest OC channel on OCIOM */
      544     1979    2           IF S1000_FLG='1'B THEN DO; /* On S1000 the console is already known   */

   1979  2 000516   000000 234000 xsym               SZN     S1000_FLG
         2 000517   000532 605000 2                  TPL     s:1984

      545     1980    2                 DEVINFO.CHN#(0)=CONS_INFO.CHN#;

   1980  2 000520   000000 236000 xsym               LDQ     CONS_INFO
         2 000521   000077 376003                    ANQ     63,DU
         2 000522   000011 736000                    QLS     9
         2 000523   000000 552040 xsym               STBQ    DEVINFO,'40'O

      546     1981    2                 DEVINFO.IOM#(0)=CONS_INFO.IOM#;

   1981  2 000524   000000 236000 xsym               LDQ     CONS_INFO
         2 000525   000005 772000                    QRL     5
         2 000526   000000 676000 xsym               ERQ     DEVINFO
         2 000527   000006 376003                    ANQ     6,DU
         2 000530   000000 656000 xsym               ERSQ    DEVINFO

      547     1982    2               END;                        /* THEN                               */

   1982  2 000531   000636 710000 2                  TRA     OCFOUND

      548     1983    2             ELSE DO;

      549     1984    3                 IF RPM_FLG AND RPM_CONSOLE ~=-1 THEN DO;

   1984  2 000532   000000 234000 xsym               SZN     RPM_FLG
         2 000533   000542 605000 2                  TPL     s:1988
         2 000534   000000 236000 xsym               LDQ     RPM_CONSOLE
         2 000535   000027 116000 xsym               CMPQ    B_VECTNIL+23
         2 000536   000542 600000 2                  TZE     s:1988

      550     1985    3                       DEVINFO.CHN#(0) = RPM_CONSOLE;

PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:95   
   1985  2 000537   000033 736000                    QLS     27
         2 000540   000000 552040 xsym               STBQ    DEVINFO,'40'O

      551     1986    3                     END;

   1986  2 000541   000636 710000 2                  TRA     OCFOUND

      552     1987    3                   ELSE DO;

      553     1988    4                       DO I=0 TO 300000;   /* Wait a second                      */

   1988  2 000542   200010 450100                    STZ     I,,AUTO

      554     1989    4                       END;                /* DO                                 */

   1989  2 000543   200010 235100                    LDA     I,,AUTO
         2 000544   000001 035007                    ADLA    1,DL
         2 000545   200010 755100                    STA     I,,AUTO
         2 000546   000010 115000 3                  CMPA    8
         2 000547   000543 602000 2                  TNC     s:1989

      555     1990    3                       TIME_OUT=6*512;

   1990  2 000550   006000 236007                    LDQ     3072,DL
         2 000551   200005 756100                    STQ     TIME_OUT,,AUTO

      556     1991    3                       OCZONE.IDCW$=ADDR(TYPEBI);

   1991  2 000552   000011 236000 3                  LDQ     9
         2 000553   000000 756000 0                  STQ     OCZONE

      557     1992    3                       OCZONE.DCW='0'B;

   1992  2 000554   000001 450000 0                  STZ     OCZONE+1

      558     1993    3                       COMMAND$=ADDR(OCZONE);

PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:96   
   1993  2 000555   000012 236000 3                  LDQ     10
         2 000556   200011 756100                    STQ     COMMAND$,,AUTO

   1993  2 000557                       FINDOC       null
      559     1994    3   FINDOC:             ;
      560     1995    4                       DO I=8 TO HIGHEST_CHAN;

   1995  2 000557   000010 235007                    LDA     8,DL
         2 000560   200010 755100                    STA     I,,AUTO
         2 000561   000632 710000 2                  TRA     s:2001+3

      561     1996    4                         DEVINFO.CHN#(0)=I;

   1996  2 000562   200010 236100                    LDQ     I,,AUTO
         2 000563   000033 736000                    QLS     27
         2 000564   000000 552040 xsym               STBQ    DEVINFO,'40'O

      562     1997    4                         CALL DOIO(0,COMMAND$,TIME_OUT);

   1997  2 000565   200005 630500                    EPPR0   TIME_OUT,,AUTO
         2 000566   200030 450500                    STP0    BUILT_MES+14,,AUTO
         2 000567   200011 631500                    EPPR1   COMMAND$,,AUTO
         2 000570   200027 451500                    STP1    BUILT_MES+13,,AUTO
         2 000571   000013 236000 3                  LDQ     11
         2 000572   200026 756100                    STQ     BUILT_MES+12,,AUTO
         2 000573   200026 630500                    EPPR0   BUILT_MES+12,,AUTO
         2 000574   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000575   000000 701000 xent               TSX1    DOIO
         2 000576   000000 011000                    NOP     0

      563     1998    4                         IF (DEVINFO.BSTAT.W1.H1(0)&'777705'O)='400000'O&

   1998  2 000577   000004 220000 xsym               LDX0    DEVINFO+4
         2 000600   777705 360003                    ANX0    -59,DU
         2 000601   400000 221003                    LDX1    -131072,DU
         2 000602   400000 100003                    CMPX0   -131072,DU
         2 000603   000605 600000 2                  TZE     s:1998+6
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:97   
         2 000604   000000 221003                    LDX1    0,DU
         2 000605   400000 220003                    LDX0    -131072,DU
         2 000606   000004 236000 xsym               LDQ     DEVINFO+4
         2 000607   700000 316007                    CANQ    -32768,DL
         2 000610   000612 600000 2                  TZE     s:1998+11
         2 000611   000000 220003                    LDX0    0,DU
         2 000612   000000 636010                    EAQ     0,X0
         2 000613   200026 756100                    STQ     BUILT_MES+12,,AUTO
         2 000614   000000 636011                    EAQ     0,X1
         2 000615   200026 376100                    ANQ     BUILT_MES+12,,AUTO
         2 000616   400000 220003                    LDX0    -131072,DU
         2 000617   200027 756100                    STQ     BUILT_MES+13,,AUTO
         2 000620   000004 236000 xsym               LDQ     DEVINFO+4
         2 000621   070000 316007                    CANQ    28672,DL
         2 000622   000624 600000 2                  TZE     s:1998+21
         2 000623   000000 220003                    LDX0    0,DU
         2 000624   000000 636010                    EAQ     0,X0
         2 000625   200027 376100                    ANQ     BUILT_MES+13,,AUTO
         2 000626   000636 601000 2                  TNZ     OCFOUND

      564     1999    4                           DEVINFO.STATUS.IOM_CHAN_STAT(0)='0'B&DEVINFO.STATUS.
              1999                                    IOM_CENT_STAT(0)='0'B THEN GOTO OCFOUND;
      565     2000    4                           ELSE;
      566     2001    4                       END;                /* DO                                 */

   2001  2 000627   200010 235100                    LDA     I,,AUTO
         2 000630   000001 035007                    ADLA    1,DL
         2 000631   200010 755100                    STA     I,,AUTO
         2 000632   200003 236100                    LDQ     HIGHEST_CHAN,,AUTO
         2 000633   200010 116100                    CMPQ    I,,AUTO
         2 000634   000562 603000 2                  TRC     s:1996

      567     2002        /* OC not found , try again */
      568     2003    3                       GOTO FINDOC;

   2003  2 000635   000557 710000 2                  TRA     FINDOC

PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:98   
   1999  2 000636                       OCFOUND      null
      569     2004    3                     END;                  /* ELSE                               */
      570     2005    2               END;
      571     2006    1   OCFOUND:;
      572     2007    1           CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(0),5,3),I);

   2007  2 000636   200010 235100                    LDA     I,,AUTO
         2 000637   000044 773000                    LRL     36
         2 000640   200026 757100                    STAQ    BUILT_MES+12,,AUTO
         2 000641   000000 301500                    BTD
         2 000642   200026 000010                    NDSC9   BUILT_MES+12,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         2 000643   000007 230003 xsym               NDSC9   DEVINFO+7                cn=1,s=nosgn,sf=0,n=3

      573     2008    1           BUILT_MES.TXT = AARDVARK_NAME;

   2008  2 000644   040100 100400                    MLR     fill='040'O
         2 000645   000000 000011 1                  ADSC9   AARDVARK_NAME            cn=0,n=9
         2 000646   200013 000050                    ADSC9   BUILT_MES+1,,AUTO        cn=0,n=40

      574     2009    1           SUBSTR(BUILT_MES.TXT,LENGTHC(AARDVARK_NAME),B_VERSION.L) = B_VERSION.C;

   2009  2 000647   000000 236000 xsym               LDQ     B_VERSION
         2 000650   000033 772000                    QRL     27
         2 000651   000000 620006                    EAX0    0,QL
         2 000652   000000 236000 xsym               LDQ     B_VERSION
         2 000653   000033 772000                    QRL     27
         2 000654   000000 621006                    EAX1    0,QL
         2 000655   040140 100440                    MLR     fill='040'O
         2 000656   000000 200011 xsym               ADSC9   B_VERSION                cn=1,n=*X1
         2 000657   200015 200010                    ADSC9   BUILT_MES+3,,AUTO        cn=1,n=*X0

      575     2010    1           SUBSTR(BUILT_MES.TXT,B_VERSION.L+LENGTHC(AARDVARK_NAME),LENGTHC(
              2010                    AARDVARK_SERVICE)) =AARDVARK_SERVICE;

   2010  2 000660   040106 100400                    MLR     fill='040'O
         2 000661   000003 000020 1                  ADSC9   AARDVARK_SERVICE         cn=0,n=16
         2 000662   200015 200020                    ADSC9   BUILT_MES+3,Q,AUTO       cn=1,n=16
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:99   

      576     2011    1           BUILT_MES.CNT = LENGTHC(AARDVARK_NAME) + LENGTHC(AARDVARK_SERVICE) +
              2011                    B_VERSION.L ;

   2011  2 000663   000031 036007                    ADLQ    25,DL
         2 000664   200012 756100                    STQ     BUILT_MES,,AUTO

      577     2012    1           CALL TYPEC(BUILT_MES);

   2012  2 000665   200012 630500                    EPPR0   BUILT_MES,,AUTO
         2 000666   200026 450500                    STP0    BUILT_MES+12,,AUTO
         2 000667   200026 630500                    EPPR0   BUILT_MES+12,,AUTO
         2 000670   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000671   000000 701000 xent               TSX1    TYPEC
         2 000672   000000 011000                    NOP     0

      578     2013        /* Find out what kind of boot this is to be */
      579     2014    1   TBDBOR:
      580     2015    1           RCV_FLG='0'B;

   2015  2 000673   000000 450000 xsym  TBDBOR       STZ     RCV_FLG

      581     2016    1           CALL KEYIN(TBDBORQ,ANSBUF);

   2016  2 000674   000014 630400 3                  EPPR0   12
         2 000675   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000676   000000 701000 xent               TSX1    KEYIN
         2 000677   000000 011000                    NOP     0

      582     2017    1           IF SUBSTR(ANSBUF.TXT,0,1)='?'THEN GOTO ITSHELP;

   2017  2 000700   000001 236000 xsym               LDQ     ANSBUF+1
         2 000701   777000 376003                    ANQ     -512,DU
         2 000702   077000 116003                    CMPQ    32256,DU
         2 000703   000761 600000 2                  TZE     ITSHELP

      583     2018    1             ELSE;
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:100  
      584     2019    1           CALL UPPER_CASE(ANSBUF.TXT,2);

   2019  2 000704   000016 630400 3                  EPPR0   14
         2 000705   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000706   000000 701000 xent               TSX1    UPPER_CASE
         2 000707   000000 011000                    NOP     0

      585     2020    2           DO SELECT(SUBSTR(ANSBUF.TXT,0,2));

   2020  2 000710   000001 220000 xsym               LDX0    ANSBUF+1
         2 000711   000014 100000 1                  CMPX0   AARDVARK_SERVICE+9
         2 000712   000722 602000 2                  TNC     s:2020+10
         2 000713   000731 600000 2                  TZE     s:2027
         2 000714   000015 100000 1                  CMPX0   AARDVARK_SERVICE+10
         2 000715   000753 602000 2                  TNC     s:2037
         2 000716   000725 600000 2                  TZE     s:2022
         2 000717   000016 100000 1                  CMPX0   AARDVARK_SERVICE+11
         2 000720   000753 601000 2                  TNZ     s:2037
         2 000721   000750 710000 2                  TRA     s:2034
         2 000722   000017 100000 1                  CMPX0   AARDVARK_SERVICE+12
         2 000723   000753 601000 2                  TNZ     s:2037
         2 000724   000726 710000 2                  TRA     s:2024

      586     2021    2             SELECT('TB');

      587     2022    2             GOTO ITSTB;

   2022  2 000725   000754 710000 2                  TRA     ITSTB

      588     2023    2             SELECT('DB');

      589     2024    2             ORDBFLG.DBF='1'B;

   2024  2 000726   200000 236003                    LDQ     65536,DU
         2 000727   000000 256000 xsym               ORSQ    ORDBFLG

      590     2025    2             GOTO Q2;
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:101  

   2025  2 000730   000766 710000 2                  TRA     Q2

      591     2026    2             SELECT('OR');

      592     2027    2             ORDBFLG.ORF='1'B;

   2027  2 000731   400000 236003                    LDQ     -131072,DU
         2 000732   000000 256000 xsym               ORSQ    ORDBFLG

      593     2028    3             IF RPM_FLG THEN DO;

   2028  2 000733   000000 234000 xsym               SZN     RPM_FLG
         2 000734   000747 605000 2                  TPL     s:2032

      594     2029    3                   I = RPM_BOOTIN.IMX#;

   2029  2 000735   000000 236000 xsym               LDQ     RPM_BOOTIN
         2 000736   000011 772000                    QRL     9
         2 000737   000003 376007                    ANQ     3,DL
         2 000740   200010 756100                    STQ     I,,AUTO

      595     2030    3                   CALL DO_RPM_TIME(I);

   2030  2 000741   200010 630500                    EPPR0   I,,AUTO
         2 000742   200026 450500                    STP0    BUILT_MES+12,,AUTO
         2 000743   200026 630500                    EPPR0   BUILT_MES+12,,AUTO
         2 000744   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000745   000000 701000 xent               TSX1    DO_RPM_TIME
         2 000746   000000 011000                    NOP     0

      596     2031    3                 END;

      597     2032    2             GOTO Q2;

   2032  2 000747   000766 710000 2                  TRA     Q2

PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:102  
      598     2033    2             SELECT('VO');

      599     2034    2             VOFLG='1'B;

   2034  2 000750   400000 236003                    LDQ     -131072,DU
         2 000751   000000 756000 xsym               STQ     VOFLG

      600     2035    2             GOTO ITSTB;

   2035  2 000752   000754 710000 2                  TRA     ITSTB

      601     2036    2             SELECT(ELSE);

      602     2037    2           GOTO TBDBOR;

   2037  2 000753   000673 710000 2                  TRA     TBDBOR

      603     2038    2           END;                            /* DO SELECT                          */

      604     2039    1   ITSTB:
      605     2040    1           TIGRPA='0'B; /* Make sure !TIGR,!MON,!RUM,!PLOVER get written later   */

   2040  2 000754   000000 450000 xsym  ITSTB        STZ     TIGRPA

      606     2041    1           MONPA='0'B;

   2041  2 000755   000000 450000 xsym               STZ     MONPA

      607     2042    1           RUMPA='0'B;

   2042  2 000756   000000 450000 xsym               STZ     RUMPA

      608     2043    1           PLVPA='0'B;

   2043  2 000757   000000 450000 xsym               STZ     PLVPA

      609     2044    1           GOTO Q1;
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:103  

   2044  2 000760   000773 710000 2                  TRA     Q1

      610     2045    1   ITSHELP:
      611     2046    1           CALL TYPEC(HUHHH);

   2046  2 000761   000020 630400 3     ITSHELP      EPPR0   16
         2 000762   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000763   000000 701000 xent               TSX1    TYPEC
         2 000764   000000 011000                    NOP     0

      612     2047    1           GOTO TBDBOR;

   2047  2 000765   000673 710000 2                  TRA     TBDBOR

      613     2048    1   Q2:
      614     2049    1           CALL KEYIN(Q2Q,ANSBUF);

   2049  2 000766   000021 630400 3     Q2           EPPR0   17
         2 000767   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000770   000000 701000 xent               TSX1    KEYIN
         2 000771   000000 011000                    NOP     0

      615     2050    1           GOTO Q01;

   2050  2 000772   000777 710000 2                  TRA     Q01

      616     2051    1   Q1:
      617     2052    1           CALL KEYIN(Q1Q,ANSBUF);

   2052  2 000773   000023 630400 3     Q1           EPPR0   19
         2 000774   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000775   000000 701000 xent               TSX1    KEYIN
         2 000776   000000 011000                    NOP     0

      618     2053    1   Q01:
      619     2054    1           ADPXF='0'B;
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:104  

   2054  2 000777   000000 450000 xsym  Q01          STZ     ADPXF

      620     2055    1           CALL GETFD(ANSBUF.TXT,16) ALTRET(CAT9E);/* Default=NO */;

   2055  2 001000   000026 630400 3                  EPPR0   22
         2 001001   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001002   000000 701000 xent               TSX1    GETFD
         2 001003   001733 702000 2                  TSX2    CAT9E

      621     2056    2           DO SELECT(SUBSTR(ANSBUF.TXT,0,1));

   2056  2 001004   000001 236000 xsym               LDQ     ANSBUF+1
         2 001005   777000 376003                    ANQ     -512,DU
         2 001006   116000 116003                    CMPQ    39936,DU
         2 001007   001036 602000 2                  TNC     s:2056+26
         2 001010   000001 236000 xsym               LDQ     ANSBUF+1
         2 001011   777000 376003                    ANQ     -512,DU
         2 001012   116000 116003                    CMPQ    39936,DU
         2 001013   001047 600000 2                  TZE     s:2061
         2 001014   000001 236000 xsym               LDQ     ANSBUF+1
         2 001015   777000 376003                    ANQ     -512,DU
         2 001016   156000 116003                    CMPQ    56320,DU
         2 001017   001031 602000 2                  TNC     s:2056+21
         2 001020   000001 236000 xsym               LDQ     ANSBUF+1
         2 001021   777000 376003                    ANQ     -512,DU
         2 001022   156000 116003                    CMPQ    56320,DU
         2 001023   001047 600000 2                  TZE     s:2061
         2 001024   000001 236000 xsym               LDQ     ANSBUF+1
         2 001025   777000 376003                    ANQ     -512,DU
         2 001026   171000 116003                    CMPQ    61952,DU
         2 001027   001061 601000 2                  TNZ     s:2066
         2 001030   001050 710000 2                  TRA     s:2063
         2 001031   000001 236000 xsym               LDQ     ANSBUF+1
         2 001032   777000 376003                    ANQ     -512,DU
         2 001033   131000 116003                    CMPQ    45568,DU
         2 001034   001061 601000 2                  TNZ     s:2066
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:105  
         2 001035   001050 710000 2                  TRA     s:2063
         2 001036   000001 236000 xsym               LDQ     ANSBUF+1
         2 001037   777000 376003                    ANQ     -512,DU
         2 001040   077000 116003                    CMPQ    32256,DU
         2 001041   001061 601000 2                  TNZ     s:2066
         2 001042   001043 710000 2                  TRA     s:2058

      622     2057    2             SELECT('?');

      623     2058    2             IF ORDBFLG='0'B THEN GOTO HELPTB;

   2058  2 001043   000000 236000 xsym               LDQ     ORDBFLG
         2 001044   600000 316003                    CANQ    -65536,DU
         2 001045   002076 600000 2                  TZE     HELPTB

      624     2059    2               ELSE GOTO HELPDBOR;

   2059  2 001046   002102 710000 2                  TRA     HELPDBOR

      625     2060    2             SELECT('N','n');

      626     2061    2             GOTO CAT9E;                   /* Establish return procedure         */

   2061  2 001047   001733 710000 2                  TRA     CAT9E

      627     2062    2             SELECT('Y','y');

      628     2063    2             IF ORDBFLG='0'B THEN ADPXF='11111'B;

   2063  2 001050   000000 236000 xsym               LDQ     ORDBFLG
         2 001051   600000 316003                    CANQ    -65536,DU
         2 001052   001056 601000 2                  TNZ     s:2064

   2063  2 001053   760000 236003                    LDQ     -8192,DU
         2 001054   000000 756000 xsym               STQ     ADPXF
         2 001055   001221 710000 2                  TRA     s:2097

PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:106  
      629     2064    2               ELSE ADPXF.D='1'B;

   2064  2 001056   200000 236003                    LDQ     65536,DU
         2 001057   000000 256000 xsym               ORSQ    ADPXF
         2 001060   001221 710000 2                  TRA     s:2097

      630     2065    2             SELECT(ELSE);

      631     2066    3           DO I=0 TO 15;

   2066  2 001061   200010 450100                    STZ     I,,AUTO

      632     2067    4             DO SELECT(SUBSTR(ANSBUF.TXT,I,1));

   2067  2 001062   200010 235100                    LDA     I,,AUTO
         2 001063   040000 106405                    CMPC    fill='040'O
         2 001064   000001 000001 xsym               ADSC9   ANSBUF+1,A               cn=0,n=1
         2 001065   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 001066   001101 602000 2                  TNC     s:2072
         2 001067   001075 600000 2                  TZE     s:2068
         2 001070   040000 106405                    CMPC    fill='040'O
         2 001071   000001 000001 xsym               ADSC9   ANSBUF+1,A               cn=0,n=1
         2 001072   000030 000001 3                  ADSC9   24                       cn=0,n=1
         2 001073   001101 601000 2                  TNZ     s:2072
         2 001074   001076 710000 2                  TRA     s:2070

      633     2068    4               SELECT(' ');

   2068  2 001075   001215 710000 2                  TRA     s:2095

      634     2069    4               SELECT('*');

      635     2070    4               MDELTAFLG=1;

   2070  2 001076   000001 236007                    LDQ     1,DL
         2 001077   000007 756000 0                  STQ     MDELTAFLG
         2 001100   001215 710000 2                  TRA     s:2095
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:107  

      636     2071    4               SELECT(ELSE);

      637     2072    4             CALL UPPER_CASE(SUBSTR(ANSBUF.TXT,I),1);

   2072  2 001101   000031 236000 3                  LDQ     25
         2 001102   200027 756100                    STQ     BUILT_MES+13,,AUTO
         2 001103   200010 236100                    LDQ     I,,AUTO
         2 001104   000020 736000                    QLS     16
         2 001105   000016 036000 3                  ADLQ    14
         2 001106   200026 756100                    STQ     BUILT_MES+12,,AUTO
         2 001107   200026 630500                    EPPR0   BUILT_MES+12,,AUTO
         2 001110   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001111   000000 701000 xent               TSX1    UPPER_CASE
         2 001112   000000 011000                    NOP     0

      638     2073    5             DO SELECT(SUBSTR(ANSBUF.TXT,I,1));

   2073  2 001113   200010 235100                    LDA     I,,AUTO
         2 001114   040000 106405                    CMPC    fill='040'O
         2 001115   000001 000001 xsym               ADSC9   ANSBUF+1,A               cn=0,n=1
         2 001116   000032 000001 3                  ADSC9   26                       cn=0,n=1
         2 001117   001134 602000 2                  TNC     s:2073+17
         2 001120   001164 600000 2                  TZE     s:2080
         2 001121   040000 106405                    CMPC    fill='040'O
         2 001122   000001 000001 xsym               ADSC9   ANSBUF+1,A               cn=0,n=1
         2 001123   000033 000001 3                  ADSC9   27                       cn=0,n=1
         2 001124   001127 602000 2                  TNC     s:2073+12
         2 001125   001172 600000 2                  TZE     s:2083
         2 001126   001211 710000 2                  TRA     s:2091
         2 001127   040000 106405                    CMPC    fill='040'O
         2 001130   000001 000001 xsym               ADSC9   ANSBUF+1,A               cn=0,n=1
         2 001131   000034 000001 3                  ADSC9   28                       cn=0,n=1
         2 001132   001211 601000 2                  TNZ     s:2091
         2 001133   001206 710000 2                  TRA     s:2089
         2 001134   040000 106405                    CMPC    fill='040'O
         2 001135   000001 000001 xsym               ADSC9   ANSBUF+1,A               cn=0,n=1
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:108  
         2 001136   000035 000001 3                  ADSC9   29                       cn=0,n=1
         2 001137   001146 602000 2                  TNC     s:2073+27
         2 001140   001161 600000 2                  TZE     s:2078
         2 001141   040000 106405                    CMPC    fill='040'O
         2 001142   000001 000001 xsym               ADSC9   ANSBUF+1,A               cn=0,n=1
         2 001143   000036 000001 3                  ADSC9   30                       cn=0,n=1
         2 001144   001211 601000 2                  TNZ     s:2091
         2 001145   001200 710000 2                  TRA     s:2086
         2 001146   040000 106405                    CMPC    fill='040'O
         2 001147   000001 000001 xsym               ADSC9   ANSBUF+1,A               cn=0,n=1
         2 001150   000037 000001 3                  ADSC9   31                       cn=0,n=1
         2 001151   001211 601000 2                  TNZ     s:2091
         2 001152   001153 710000 2                  TRA     s:2075

      639     2074    5               SELECT('A');

      640     2075    5               IF ORDBFLG~='0'B THEN GOTO Q2;

   2075  2 001153   000000 236000 xsym               LDQ     ORDBFLG
         2 001154   600000 316003                    CANQ    -65536,DU
         2 001155   000766 601000 2                  TNZ     Q2

      641     2076    5                 ELSE ADPXF.A='1'B;

   2076  2 001156   400000 236003                    LDQ     -131072,DU
         2 001157   000000 256000 xsym               ORSQ    ADPXF
         2 001160   001215 710000 2                  TRA     s:2095

      642     2077    5               SELECT('D');

      643     2078    5               ADPXF.D='1'B;

   2078  2 001161   200000 236003                    LDQ     65536,DU
         2 001162   000000 256000 xsym               ORSQ    ADPXF
         2 001163   001215 710000 2                  TRA     s:2095

      644     2079    5               SELECT('P');
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:109  

      645     2080    5               IF ORDBFLG~='0'B THEN GOTO Q2;

   2080  2 001164   000000 236000 xsym               LDQ     ORDBFLG
         2 001165   600000 316003                    CANQ    -65536,DU
         2 001166   000766 601000 2                  TNZ     Q2

      646     2081    5                 ELSE ADPXF.P='1'B;

   2081  2 001167   100000 236003                    LDQ     32768,DU
         2 001170   000000 256000 xsym               ORSQ    ADPXF
         2 001171   001215 710000 2                  TRA     s:2095

      647     2082    5               SELECT('X');

      648     2083    5               IF ORDBFLG~='0'B THEN GOTO Q2;

   2083  2 001172   000000 236000 xsym               LDQ     ORDBFLG
         2 001173   600000 316003                    CANQ    -65536,DU
         2 001174   000766 601000 2                  TNZ     Q2

      649     2084    5                 ELSE ADPXF.X='1'B;

   2084  2 001175   040000 236003                    LDQ     16384,DU
         2 001176   000000 256000 xsym               ORSQ    ADPXF
         2 001177   001215 710000 2                  TRA     s:2095

      650     2085    5               SELECT('F');

      651     2086    5               IF ORDBFLG~='0'B THEN GOTO Q2;

   2086  2 001200   000000 236000 xsym               LDQ     ORDBFLG
         2 001201   600000 316003                    CANQ    -65536,DU
         2 001202   000766 601000 2                  TNZ     Q2

      652     2087    5                 ELSE ADPXF.F='1'B;

PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:110  
   2087  2 001203   020000 236003                    LDQ     8192,DU
         2 001204   000000 256000 xsym               ORSQ    ADPXF
         2 001205   001215 710000 2                  TRA     s:2095

      653     2088    5               SELECT('S');

      654     2089    5               SILENT='1'B;                /* Don't write FW names               */

   2089  2 001206   400000 236003                    LDQ     -131072,DU
         2 001207   000012 756000 0                  STQ     SILENT
         2 001210   001215 710000 2                  TRA     s:2095

      655     2090    5               SELECT(ELSE);

      656     2091    5             IF ORDBFLG='0'B THEN GOTO Q1;

   2091  2 001211   000000 236000 xsym               LDQ     ORDBFLG
         2 001212   600000 316003                    CANQ    -65536,DU
         2 001213   000773 600000 2                  TZE     Q1

      657     2092    5               ELSE GOTO Q2;

   2092  2 001214   000766 710000 2                  TRA     Q2

      658     2093    5             END;                          /* DO SELECT                          */

      659     2094    4             END;                          /* DO SELECT                          */

      660     2095    3           END;                            /* DO I=                              */

   2095  2 001215   000001 035007                    ADLA    1,DL
         2 001216   200010 755100                    STA     I,,AUTO
         2 001217   000020 115007                    CMPA    16,DL
         2 001220   001062 602000 2                  TNC     s:2067

      661     2096    2           END;                            /* DO SELECT                          */

PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:111  
      662     2097    1           IF ADPXF.D='0'B THEN GOTO CAT9E; /* Establish return                  */

   2097  2 001221   000000 236000 xsym               LDQ     ADPXF
         2 001222   200000 316003                    CANQ    65536,DU
         2 001223   001733 600000 2                  TZE     CAT9E

      663     2098    1             ELSE;
      664     2099    1   CAT5:
      665     2100    1           CALL KEYIN(CATQU,ANSBUF);       /* Ask about URC devices              */

   2100  2 001224   000040 630400 3     CAT5         EPPR0   32
         2 001225   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001226   000000 701000 xent               TSX1    KEYIN
         2 001227   000000 011000                    NOP     0

      666     2101    1           CALL GETFD(ANSBUF.TXT,16) ALTRET(CAT9); /* Default=YES                */

   2101  2 001230   000026 630400 3                  EPPR0   22
         2 001231   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001232   000000 701000 xent               TSX1    GETFD
         2 001233   001657 702000 2                  TSX2    CAT9

      667     2102    1           CALL UPPER_CASE(ANSBUF.TXT,1);

   2102  2 001234   000042 630400 3                  EPPR0   34
         2 001235   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001236   000000 701000 xent               TSX1    UPPER_CASE
         2 001237   000000 011000                    NOP     0

      668     2103    2           DO SELECT(SUBSTR(ANSBUF.TXT,0,1));

   2103  2 001240   000001 236000 xsym               LDQ     ANSBUF+1
         2 001241   777000 376003                    ANQ     -512,DU
         2 001242   131000 116003                    CMPQ    45568,DU
         2 001243   001251 602000 2                  TNC     s:2103+9
         2 001244   000001 236000 xsym               LDQ     ANSBUF+1
         2 001245   777000 376003                    ANQ     -512,DU
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:112  
         2 001246   131000 116003                    CMPQ    45568,DU
         2 001247   001256 600000 2                  TZE     s:2105
         2 001250   001260 710000 2                  TRA     s:2108
         2 001251   000001 236000 xsym               LDQ     ANSBUF+1
         2 001252   777000 376003                    ANQ     -512,DU
         2 001253   116000 116003                    CMPQ    39936,DU
         2 001254   001260 601000 2                  TNZ     s:2108
         2 001255   001257 710000 2                  TRA     s:2106

      669     2104    2             SELECT('Y');

      670     2105    2             GOTO CAT9;

   2105  2 001256   001657 710000 2                  TRA     CAT9

      671     2106    2             SELECT('N');

   2106  2 001257   001261 710000 2                  TRA     CAT6

      672     2107    2             SELECT(ELSE);

      673     2108    2           GOTO CAT5;

   2108  2 001260   001224 710000 2                  TRA     CAT5

      674     2109    2           END;                            /* DO SELECT                          */

   2103  2 001261                       CAT6         null
      675     2110    1   CAT6:   ;                               /* Ask about base chann               */
      676     2111    1           CALL KEYIN(CATQCH,ANSBUF);

   2111  2 001261   000044 630400 3                  EPPR0   36
         2 001262   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001263   000000 701000 xent               TSX1    KEYIN
         2 001264   000000 011000                    NOP     0

      677     2112    1           CALL GETFD(ANSBUF.TXT,16) ALTRET(CAT6E); /* Default OK                */
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:113  

   2112  2 001265   000026 630400 3                  EPPR0   22
         2 001266   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001267   000000 701000 xent               TSX1    GETFD
         2 001270   001305 702000 2                  TSX2    CAT6E

      678     2113    1           IF ALPHA_FLG='1'B THEN GOTO CAT6; /* It has to be decimal             */

   2113  2 001271   000000 234000 xsym               SZN     ALPHA_FLG
         2 001272   001261 604000 2                  TMI     CAT6

      679     2114    1             ELSE;
      680     2115    1           CALL CHARBIN(URCHN,SUBSTR(ANS,0,FIELD_LEN));

   2115  2 001273   000000 470400 xsym               LDP0    FIELD$
         2 001274   000000 720000 xsym               LXL0    FIELD_LEN
         2 001275   000100 305540                    DTB
         2 001276   000000 030010                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=*X0
         2 001277   200026 000010                    NDSC9   BUILT_MES+12,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         2 001300   200027 235100                    LDA     BUILT_MES+13,,AUTO
         2 001301   000004 755000 0                  STA     URCHN

      681     2116    1           IF URCHN>HIGHEST_CHAN THEN GOTO CAT6;

   2116  2 001302   200003 236100                    LDQ     HIGHEST_CHAN,,AUTO
         2 001303   000004 116000 0                  CMPQ    URCHN
         2 001304   001261 602000 2                  TNC     CAT6

      682     2117    1             ELSE;
      683     2118    1   CAT6E:
      684     2119    2           DO I=%OC# TO %(OC#+LP#-1);      /* Ask about LPs                      */

   2119  2 001305   000001 235007       CAT6E        LDA     1,DL
         2 001306   200010 755100                    STA     I,,AUTO

      685     2120    2   CAT7:
      686     2121    2             BUILT_MES.TXT = ' ';
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:114  

   2121  2 001307   040100 100400       CAT7         MLR     fill='040'O
         2 001310   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 001311   200013 000050                    ADSC9   BUILT_MES+1,,AUTO        cn=0,n=40

      687     2122    2             SUBSTR(BUILT_MES.TXT,2)=DEVINFO.DEVNAME(I);

   2122  2 001312   200010 236100                    LDQ     I,,AUTO
         2 001313   000060 402007                    MPY     48,DL
         2 001314   040100 100406                    MLR     fill='040'O
         2 001315   000006 000010 xsym               ADSC9   DEVINFO+6,Q              cn=0,n=8
         2 001316   200013 400046                    ADSC9   BUILT_MES+1,,AUTO        cn=2,n=38

      688     2123    2             SUBSTR(BUILT_MES.TXT,10)='=LP ';

   2123  2 001317   040100 100400                    MLR     fill='040'O
         2 001320   000020 000004 1                  ADSC9   AARDVARK_SERVICE+13      cn=0,n=4
         2 001321   200015 400036                    ADSC9   BUILT_MES+3,,AUTO        cn=2,n=30

      689     2124    2             BUILT_MES.CNT=10+4;

   2124  2 001322   000016 235007                    LDA     14,DL
         2 001323   200012 755100                    STA     BUILT_MES,,AUTO

      690     2125    2   CAT7A:
      691     2126    2             CALL KEYIN(BUILT_MES,ANSBUF);

   2126  2 001324   000015 236000 3     CAT7A        LDQ     13
         2 001325   200027 756100                    STQ     BUILT_MES+13,,AUTO
         2 001326   200012 630500                    EPPR0   BUILT_MES,,AUTO
         2 001327   200026 450500                    STP0    BUILT_MES+12,,AUTO
         2 001330   200026 630500                    EPPR0   BUILT_MES+12,,AUTO
         2 001331   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001332   000000 701000 xent               TSX1    KEYIN
         2 001333   000000 011000                    NOP     0

      692     2127    2             CALL GETFD(ANSBUF.TXT,16) ALTRET(CAT7E); /* Default OK              */
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:115  

   2127  2 001334   000026 630400 3                  EPPR0   22
         2 001335   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001336   000000 701000 xent               TSX1    GETFD
         2 001337   001465 702000 2                  TSX2    CAT7E

      693     2128    2             IF ALPHA_FLG='1'B THEN GOTO CAT7A; /* It has to be decimal          */

   2128  2 001340   000000 234000 xsym               SZN     ALPHA_FLG
         2 001341   001324 604000 2                  TMI     CAT7A

      694     2129    2             CALL CHARBIN(CHG_IOM,SUBSTR(ANS,0,FIELD_LEN));

   2129  2 001342   000000 470400 xsym               LDP0    FIELD$
         2 001343   000000 720000 xsym               LXL0    FIELD_LEN
         2 001344   000100 305540                    DTB
         2 001345   000000 030010                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=*X0
         2 001346   200026 000010                    NDSC9   BUILT_MES+12,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         2 001347   200027 235100                    LDA     BUILT_MES+13,,AUTO
         2 001350   200006 755100                    STA     CHG_IOM,,AUTO

      695     2130    2             IF CHG_IOM>%HIGHEST_IOM THEN GOTO CAT7A;

   2130  2 001351   000004 115007                    CMPA    4,DL
         2 001352   001324 603000 2                  TRC     CAT7A

      696     2131    2             IF RPM_FLG THEN

   2131  2 001353   000000 234000 xsym               SZN     RPM_FLG
         2 001354   001370 605000 2                  TPL     s:2134

      697     2132    2               IF CHG_IOM ~= RPM_BOOTIN.IMX# THEN

   2132  2 001355   000000 236000 xsym               LDQ     RPM_BOOTIN
         2 001356   000011 772000                    QRL     9
         2 001357   000003 376007                    ANQ     3,DL
         2 001360   200006 116100                    CMPQ    CHG_IOM,,AUTO
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:116  
         2 001361   001370 600000 2                  TZE     s:2134

      698     2133    2                 CALL DO_RPM_CFG(CHG_IOM);

   2133  2 001362   200006 631500                    EPPR1   CHG_IOM,,AUTO
         2 001363   200026 451500                    STP1    BUILT_MES+12,,AUTO
         2 001364   200026 630500                    EPPR0   BUILT_MES+12,,AUTO
         2 001365   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001366   000000 701000 xent               TSX1    DO_RPM_CFG
         2 001367   000000 011000                    NOP     0

      699     2134    2             CALL GETFD(SUBSTR(ANSBUF.TXT,FIELD_LEN+1),16-FIELD_LEN-1) ALTRET(CAT7A);

   2134  2 001370   000017 235007                    LDA     15,DL
         2 001371   000000 135000 xsym               SBLA    FIELD_LEN
         2 001372   200026 755100                    STA     BUILT_MES+12,,AUTO
         2 001373   200026 630500                    EPPR0   BUILT_MES+12,,AUTO
         2 001374   200031 450500                    STP0    BUILT_MES+15,,AUTO
         2 001375   000000 236000 xsym               LDQ     FIELD_LEN
         2 001376   000020 736000                    QLS     16
         2 001377   000046 036000 3                  ADLQ    38
         2 001400   200030 756100                    STQ     BUILT_MES+14,,AUTO
         2 001401   200030 630500                    EPPR0   BUILT_MES+14,,AUTO
         2 001402   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001403   000000 701000 xent               TSX1    GETFD
         2 001404   001324 702000 2                  TSX2    CAT7A

      700     2135    2             IF ALPHA_FLG='1'B THEN GOTO CAT7A;

   2135  2 001405   000000 234000 xsym               SZN     ALPHA_FLG
         2 001406   001324 604000 2                  TMI     CAT7A

      701     2136    2               ELSE;
      702     2137    2             CALL CHARBIN(CHG_CHN,SUBSTR(ANS,0,FIELD_LEN));

   2137  2 001407   000000 470400 xsym               LDP0    FIELD$
         2 001410   000000 720000 xsym               LXL0    FIELD_LEN
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:117  
         2 001411   000100 305540                    DTB
         2 001412   000000 030010                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=*X0
         2 001413   200026 000010                    NDSC9   BUILT_MES+12,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         2 001414   200027 235100                    LDA     BUILT_MES+13,,AUTO
         2 001415   200007 755100                    STA     CHG_CHN,,AUTO

      703     2138    2             IF CHG_CHN>HIGHEST_CHAN THEN GOTO CAT7A;

   2138  2 001416   200003 236100                    LDQ     HIGHEST_CHAN,,AUTO
         2 001417   200007 116100                    CMPQ    CHG_CHN,,AUTO
         2 001420   001324 602000 2                  TNC     CAT7A

      704     2139    2             DEVINFO.IOM#(I) = CHG_IOM;

   2139  2 001421   200010 236100                    LDQ     I,,AUTO
         2 001422   000014 402007                    MPY     12,DL
         2 001423   000000 621006                    EAX1    0,QL
         2 001424   200006 236100                    LDQ     CHG_IOM,,AUTO
         2 001425   000023 736000                    QLS     19
         2 001426   000000 676011 xsym               ERQ     DEVINFO,X1
         2 001427   000006 376003                    ANQ     6,DU
         2 001430   000000 656011 xsym               ERSQ    DEVINFO,X1

      705     2140    2             DEVINFO.CHN#(I)=CHG_CHN;

   2140  2 001431   200007 236100                    LDQ     CHG_CHN,,AUTO
         2 001432   000033 736000                    QLS     27
         2 001433   000000 676011 xsym               ERQ     DEVINFO,X1
         2 001434   777000 376003                    ANQ     -512,DU
         2 001435   000000 656011 xsym               ERSQ    DEVINFO,X1

      706     2141    2             CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(I),3,1),DEVINFO.IOM#(I));

   2141  2 001436   200010 236100                    LDQ     I,,AUTO
         2 001437   000060 402007                    MPY     48,DL
         2 001440   200026 756100                    STQ     BUILT_MES+12,,AUTO
         2 001441   000000 236011 xsym               LDQ     DEVINFO,X1
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:118  
         2 001442   000023 772000                    QRL     19
         2 001443   000003 376007                    ANQ     3,DL
         2 001444   000000 235003                    LDA     0,DU
         2 001445   200030 757100                    STAQ    BUILT_MES+14,,AUTO
         2 001446   200026 235100                    LDA     BUILT_MES+12,,AUTO
         2 001447   000005 301500                    BTD
         2 001450   200030 000010                    NDSC9   BUILT_MES+14,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         2 001451   000006 630001 xsym               NDSC9   DEVINFO+6,A              cn=3,s=nosgn,sf=0,n=1

      707     2142    2             CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(I),5,3),DEVINFO.CHN#(I));

   2142  2 001452   200010 236100                    LDQ     I,,AUTO
         2 001453   000060 402007                    MPY     48,DL
         2 001454   200026 756100                    STQ     BUILT_MES+12,,AUTO
         2 001455   000000 236011 xsym               LDQ     DEVINFO,X1
         2 001456   000033 772000                    QRL     27
         2 001457   000000 235003                    LDA     0,DU
         2 001460   200030 757100                    STAQ    BUILT_MES+14,,AUTO
         2 001461   200026 235100                    LDA     BUILT_MES+12,,AUTO
         2 001462   000005 301500                    BTD
         2 001463   200030 000010                    NDSC9   BUILT_MES+14,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         2 001464   000007 230003 xsym               NDSC9   DEVINFO+7,A              cn=1,s=nosgn,sf=0,n=3

      708     2143    2   CAT7E:
      709     2144    2           END;                            /* DO I=                              */

   2144  2 001465   200010 235100       CAT7E        LDA     I,,AUTO
         2 001466   000001 035007                    ADLA    1,DL
         2 001467   200010 755100                    STA     I,,AUTO
         2 001470   000002 115007                    CMPA    2,DL
         2 001471   001307 602000 2                  TNC     CAT7

      710     2145    2           DO I=%(OC#+LP#) TO %(OC#+LP#+CR#-1); /* Ask about CRs                 */

   2145  2 001472   000002 236007                    LDQ     2,DL
         2 001473   200010 756100                    STQ     I,,AUTO

PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:119  
      711     2146    2   CAT8:
      712     2147    2             BUILT_MES.TXT = ' ';

   2147  2 001474   040100 100400       CAT8         MLR     fill='040'O
         2 001475   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 001476   200013 000050                    ADSC9   BUILT_MES+1,,AUTO        cn=0,n=40

      713     2148    2             SUBSTR(BUILT_MES.TXT,2)=DEVINFO.DEVNAME(I);

   2148  2 001477   200010 236100                    LDQ     I,,AUTO
         2 001500   000060 402007                    MPY     48,DL
         2 001501   040100 100406                    MLR     fill='040'O
         2 001502   000006 000010 xsym               ADSC9   DEVINFO+6,Q              cn=0,n=8
         2 001503   200013 400046                    ADSC9   BUILT_MES+1,,AUTO        cn=2,n=38

      714     2149    2             SUBSTR(BUILT_MES.TXT,10)='=CR ';

   2149  2 001504   040100 100400                    MLR     fill='040'O
         2 001505   000021 000004 1                  ADSC9   AARDVARK_SERVICE+14      cn=0,n=4
         2 001506   200015 400036                    ADSC9   BUILT_MES+3,,AUTO        cn=2,n=30

      715     2150    2             BUILT_MES.CNT=10+4;

   2150  2 001507   000016 235007                    LDA     14,DL
         2 001510   200012 755100                    STA     BUILT_MES,,AUTO

      716     2151    2   CAT8A:
      717     2152    2             CALL KEYIN(BUILT_MES,ANSBUF);

   2152  2 001511   000015 236000 3     CAT8A        LDQ     13
         2 001512   200027 756100                    STQ     BUILT_MES+13,,AUTO
         2 001513   200012 630500                    EPPR0   BUILT_MES,,AUTO
         2 001514   200026 450500                    STP0    BUILT_MES+12,,AUTO
         2 001515   200026 630500                    EPPR0   BUILT_MES+12,,AUTO
         2 001516   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001517   000000 701000 xent               TSX1    KEYIN
         2 001520   000000 011000                    NOP     0
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:120  

      718     2153    2             CALL GETFD(ANSBUF.TXT,16) ALTRET(CAT8E); /* Default OK              */

   2153  2 001521   000026 630400 3                  EPPR0   22
         2 001522   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001523   000000 701000 xent               TSX1    GETFD
         2 001524   001652 702000 2                  TSX2    CAT8E

      719     2154    2             IF ALPHA_FLG='1'B THEN GOTO CAT8A; /* It has to be decimal          */

   2154  2 001525   000000 234000 xsym               SZN     ALPHA_FLG
         2 001526   001511 604000 2                  TMI     CAT8A

      720     2155    2             CALL CHARBIN(CHG_IOM,SUBSTR(ANS,0,FIELD_LEN));

   2155  2 001527   000000 470400 xsym               LDP0    FIELD$
         2 001530   000000 720000 xsym               LXL0    FIELD_LEN
         2 001531   000100 305540                    DTB
         2 001532   000000 030010                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=*X0
         2 001533   200026 000010                    NDSC9   BUILT_MES+12,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         2 001534   200027 235100                    LDA     BUILT_MES+13,,AUTO
         2 001535   200006 755100                    STA     CHG_IOM,,AUTO

      721     2156    2             IF CHG_IOM>%HIGHEST_IOM THEN GOTO CAT8A;

   2156  2 001536   000004 115007                    CMPA    4,DL
         2 001537   001511 603000 2                  TRC     CAT8A

      722     2157    2             IF RPM_FLG THEN

   2157  2 001540   000000 234000 xsym               SZN     RPM_FLG
         2 001541   001555 605000 2                  TPL     s:2160

      723     2158    2               IF CHG_IOM ~= RPM_BOOTIN.IMX# THEN

   2158  2 001542   000000 236000 xsym               LDQ     RPM_BOOTIN
         2 001543   000011 772000                    QRL     9
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:121  
         2 001544   000003 376007                    ANQ     3,DL
         2 001545   200006 116100                    CMPQ    CHG_IOM,,AUTO
         2 001546   001555 600000 2                  TZE     s:2160

      724     2159    2                 CALL DO_RPM_CFG(CHG_IOM);

   2159  2 001547   200006 631500                    EPPR1   CHG_IOM,,AUTO
         2 001550   200026 451500                    STP1    BUILT_MES+12,,AUTO
         2 001551   200026 630500                    EPPR0   BUILT_MES+12,,AUTO
         2 001552   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001553   000000 701000 xent               TSX1    DO_RPM_CFG
         2 001554   000000 011000                    NOP     0

      725     2160    2             CALL GETFD(SUBSTR(ANSBUF.TXT,FIELD_LEN+1),16-FIELD_LEN-1) ALTRET(CAT8A);

   2160  2 001555   000017 235007                    LDA     15,DL
         2 001556   000000 135000 xsym               SBLA    FIELD_LEN
         2 001557   200026 755100                    STA     BUILT_MES+12,,AUTO
         2 001560   200026 630500                    EPPR0   BUILT_MES+12,,AUTO
         2 001561   200031 450500                    STP0    BUILT_MES+15,,AUTO
         2 001562   000000 236000 xsym               LDQ     FIELD_LEN
         2 001563   000020 736000                    QLS     16
         2 001564   000046 036000 3                  ADLQ    38
         2 001565   200030 756100                    STQ     BUILT_MES+14,,AUTO
         2 001566   200030 630500                    EPPR0   BUILT_MES+14,,AUTO
         2 001567   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001570   000000 701000 xent               TSX1    GETFD
         2 001571   001511 702000 2                  TSX2    CAT8A

      726     2161    2             IF ALPHA_FLG='1'B THEN GOTO CAT8A;

   2161  2 001572   000000 234000 xsym               SZN     ALPHA_FLG
         2 001573   001511 604000 2                  TMI     CAT8A

      727     2162    2               ELSE;
      728     2163    2             CALL CHARBIN(CHG_CHN,SUBSTR(ANS,0,FIELD_LEN));

PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:122  
   2163  2 001574   000000 470400 xsym               LDP0    FIELD$
         2 001575   000000 720000 xsym               LXL0    FIELD_LEN
         2 001576   000100 305540                    DTB
         2 001577   000000 030010                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=*X0
         2 001600   200026 000010                    NDSC9   BUILT_MES+12,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         2 001601   200027 235100                    LDA     BUILT_MES+13,,AUTO
         2 001602   200007 755100                    STA     CHG_CHN,,AUTO

      729     2164    2             IF CHG_CHN>HIGHEST_CHAN THEN GOTO CAT8A;

   2164  2 001603   200003 236100                    LDQ     HIGHEST_CHAN,,AUTO
         2 001604   200007 116100                    CMPQ    CHG_CHN,,AUTO
         2 001605   001511 602000 2                  TNC     CAT8A

      730     2165    2             DEVINFO.CHN#(I)=CHG_CHN;

   2165  2 001606   200010 236100                    LDQ     I,,AUTO
         2 001607   000014 402007                    MPY     12,DL
         2 001610   000000 621006                    EAX1    0,QL
         2 001611   200007 236100                    LDQ     CHG_CHN,,AUTO
         2 001612   000033 736000                    QLS     27
         2 001613   000000 676011 xsym               ERQ     DEVINFO,X1
         2 001614   777000 376003                    ANQ     -512,DU
         2 001615   000000 656011 xsym               ERSQ    DEVINFO,X1

      731     2166    2             DEVINFO.IOM#(I)=CHG_IOM;

   2166  2 001616   200006 236100                    LDQ     CHG_IOM,,AUTO
         2 001617   000023 736000                    QLS     19
         2 001620   000000 676011 xsym               ERQ     DEVINFO,X1
         2 001621   000006 376003                    ANQ     6,DU
         2 001622   000000 656011 xsym               ERSQ    DEVINFO,X1

      732     2167    2             CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(I),3,1),DEVINFO.IOM#(I));

   2167  2 001623   200010 236100                    LDQ     I,,AUTO
         2 001624   000060 402007                    MPY     48,DL
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:123  
         2 001625   200026 756100                    STQ     BUILT_MES+12,,AUTO
         2 001626   000000 236011 xsym               LDQ     DEVINFO,X1
         2 001627   000023 772000                    QRL     19
         2 001630   000003 376007                    ANQ     3,DL
         2 001631   000000 235003                    LDA     0,DU
         2 001632   200030 757100                    STAQ    BUILT_MES+14,,AUTO
         2 001633   200026 235100                    LDA     BUILT_MES+12,,AUTO
         2 001634   000005 301500                    BTD
         2 001635   200030 000010                    NDSC9   BUILT_MES+14,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         2 001636   000006 630001 xsym               NDSC9   DEVINFO+6,A              cn=3,s=nosgn,sf=0,n=1

      733     2168    2             CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(I),5,3),DEVINFO.CHN#(I));

   2168  2 001637   200010 236100                    LDQ     I,,AUTO
         2 001640   000060 402007                    MPY     48,DL
         2 001641   200026 756100                    STQ     BUILT_MES+12,,AUTO
         2 001642   000000 236011 xsym               LDQ     DEVINFO,X1
         2 001643   000033 772000                    QRL     27
         2 001644   000000 235003                    LDA     0,DU
         2 001645   200030 757100                    STAQ    BUILT_MES+14,,AUTO
         2 001646   200026 235100                    LDA     BUILT_MES+12,,AUTO
         2 001647   000005 301500                    BTD
         2 001650   200030 000010                    NDSC9   BUILT_MES+14,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         2 001651   000007 230003 xsym               NDSC9   DEVINFO+7,A              cn=1,s=nosgn,sf=0,n=3

      734     2169    2   CAT8E:
      735     2170    2           END;                            /* DO I=                              */

   2170  2 001652   200010 235100       CAT8E        LDA     I,,AUTO
         2 001653   000001 035007                    ADLA    1,DL
         2 001654   200010 755100                    STA     I,,AUTO
         2 001655   000003 115007                    CMPA    3,DL
         2 001656   001474 602000 2                  TNC     CAT8

      736     2171    1   CAT9:
      737     2172    1           CALL KEYIN(CATQFEP,ANSBUF);     /* Ask about FEP                      */

PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:124  
   2172  2 001657   000047 630400 3     CAT9         EPPR0   39
         2 001660   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001661   000000 701000 xent               TSX1    KEYIN
         2 001662   000000 011000                    NOP     0

      738     2173    1           CALL GETFD(ANSBUF.TXT,16) ALTRET(CAT9E); /* Default OK                */

   2173  2 001663   000026 630400 3                  EPPR0   22
         2 001664   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001665   000000 701000 xent               TSX1    GETFD
         2 001666   001733 702000 2                  TSX2    CAT9E

      739     2174    1           IF ALPHA_FLG='1'B THEN GOTO CAT9; /* It has to be decimal             */

   2174  2 001667   000000 234000 xsym               SZN     ALPHA_FLG
         2 001670   001657 604000 2                  TMI     CAT9

      740     2175    1           CALL CHARBIN(FEPIOM,SUBSTR(ANS,0,FIELD_LEN));

   2175  2 001671   000000 470400 xsym               LDP0    FIELD$
         2 001672   000000 720000 xsym               LXL0    FIELD_LEN
         2 001673   000100 305540                    DTB
         2 001674   000000 030010                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=*X0
         2 001675   200026 000010                    NDSC9   BUILT_MES+12,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         2 001676   200027 235100                    LDA     BUILT_MES+13,,AUTO
         2 001677   000005 755000 0                  STA     FEPIOM

      741     2176    1           IF FEPIOM>%HIGHEST_IOM THEN GOTO CAT9;

   2176  2 001700   000004 115007                    CMPA    4,DL
         2 001701   001657 603000 2                  TRC     CAT9

      742     2177    1           CALL GETFD(SUBSTR(ANSBUF.TXT,FIELD_LEN+1),16-FIELD_LEN-1) ALTRET(CAT9);

   2177  2 001702   000017 236007                    LDQ     15,DL
         2 001703   000000 136000 xsym               SBLQ    FIELD_LEN
         2 001704   200026 756100                    STQ     BUILT_MES+12,,AUTO
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:125  
         2 001705   200026 631500                    EPPR1   BUILT_MES+12,,AUTO
         2 001706   200031 451500                    STP1    BUILT_MES+15,,AUTO
         2 001707   000000 236000 xsym               LDQ     FIELD_LEN
         2 001710   000020 736000                    QLS     16
         2 001711   000046 036000 3                  ADLQ    38
         2 001712   200030 756100                    STQ     BUILT_MES+14,,AUTO
         2 001713   200030 630500                    EPPR0   BUILT_MES+14,,AUTO
         2 001714   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001715   000000 701000 xent               TSX1    GETFD
         2 001716   001657 702000 2                  TSX2    CAT9

      743     2178    1           IF ALPHA_FLG='1'B THEN GOTO CAT9;

   2178  2 001717   000000 234000 xsym               SZN     ALPHA_FLG
         2 001720   001657 604000 2                  TMI     CAT9

      744     2179    1             ELSE;
      745     2180    1           CALL CHARBIN(FEPCHAN,SUBSTR(ANS,0,FIELD_LEN));

   2180  2 001721   000000 470400 xsym               LDP0    FIELD$
         2 001722   000000 720000 xsym               LXL0    FIELD_LEN
         2 001723   000100 305540                    DTB
         2 001724   000000 030010                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=*X0
         2 001725   200026 000010                    NDSC9   BUILT_MES+12,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         2 001726   200027 235100                    LDA     BUILT_MES+13,,AUTO
         2 001727   000006 755000 0                  STA     FEPCHAN

      746     2181    1           IF FEPCHAN>HIGHEST_CHAN THEN GOTO CAT9;

   2181  2 001730   200003 236100                    LDQ     HIGHEST_CHAN,,AUTO
         2 001731   000006 116000 0                  CMPQ    FEPCHAN
         2 001732   001657 602000 2                  TNC     CAT9

   2181  2 001733   001736 710000 2     CAT9E        TRA     s:2184

      747     2182    1   CAT9E:  ;
      748     2183    1   TYPE_SIZE: ENTRY ALTRET;
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:126  

   2183  2 001734   000000 700200 xent  TYPE_SIZE    TSX0  ! X66_AUTO_0
         2 001735   000032 000000                    ZERO    26,0

      749     2184    1           IF RCV_FLG.RBO='1'B THEN CALL TYPEC(RCVRM);

   2184  2 001736   000000 236000 xsym               LDQ     RCV_FLG
         2 001737   040000 316003                    CANQ    16384,DU
         2 001740   001745 600000 2                  TZE     s:2185

   2184  2 001741   000051 630400 3                  EPPR0   41
         2 001742   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001743   000000 701000 xent               TSX1    TYPEC
         2 001744   000000 011000                    NOP     0

      750     2185    1           IS_PPUT_SIZE = HIPAGE;

   2185  2 001745   000000 235000 xsym               LDA     HIPAGE
         2 001746   000000 755000 xsym               STA     IS_PPUT_SIZE

      751     2186    2           IF RPM_FLG THEN DO;

   2186  2 001747   000000 234000 xsym               SZN     RPM_FLG
         2 001750   002012 605000 2                  TPL     s:2198

      752     2187    2                 I = RPM_BOOTIN.IMX#;

   2187  2 001751   000000 236000 xsym               LDQ     RPM_BOOTIN
         2 001752   000011 772000                    QRL     9
         2 001753   000003 376007                    ANQ     3,DL
         2 001754   200010 756100                    STQ     I,,AUTO

      753     2188    3                 CALL DO_SCU_STATE(I) WHENRETURN DO;

   2188  2 001755   200010 630500                    EPPR0   I,,AUTO
         2 001756   200026 450500                    STP0    BUILT_MES+12,,AUTO
         2 001757   200026 630500                    EPPR0   BUILT_MES+12,,AUTO
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:127  
         2 001760   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001761   000000 701000 xent               TSX1    DO_SCU_STATE
         2 001762   002012 702000 2                  TSX2    s:2198

      754     2189    4                       IF IS_CFG_TYPE = %IS_CFG_MULT_CAB_REL# THEN DO;

   2189  2 001763   000000 235000 xsym               LDA     IS_CFG_TYPE
         2 001764   000002 115007                    CMPA    2,DL
         2 001765   002012 601000 2                  TNZ     s:2198

      755     2190    4                            UPPER_SCU.UPP_BND = MCA_CFG.PORT_INFO.START_ADDR(1) * 1024
              2190                                      +

   2190  2 001766   000020 236000 xsym               LDQ     MCA_CFG+16
         2 001767   000011 772000                    QRL     9
         2 001770   000777 376007                    ANQ     511,DL
         2 001771   200026 756100                    STQ     BUILT_MES+12,,AUTO
         2 001772   000021 236000 xsym               LDQ     MCA_CFG+17
         2 001773   000007 772000                    QRL     7
         2 001774   003774 376007                    ANQ     2044,DL
         2 001775   200026 036100                    ADLQ    BUILT_MES+12,,AUTO
         2 001776   000010 736000                    QLS     8
         2 001777   000001 136007                    SBLQ    1,DL
         2 002000   000001 756000 xsym               STQ     UPPER_SCU+1

      756     2191    4                               MCA_CFG.PORT_INFO.SIZE(1) * 256 -1;
      757     2192    4                            UPPER_SCU.LOW_BND = MCA_CFG.PORT_INFO.START_ADDR(1) * 1024
              2192                                      ;

   2192  2 002001   000021 236000 xsym               LDQ     MCA_CFG+17
         2 002002   000001 736000                    QLS     1
         2 002003   000052 376000 3                  ANQ     42
         2 002004   000000 756000 xsym               STQ     UPPER_SCU

      758     2193    4                             IS_PPUT_SIZE = UPPER_SCU.UPP_BND;

   2193  2 002005   000001 235000 xsym               LDA     UPPER_SCU+1
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:128  
         2 002006   000000 755000 xsym               STA     IS_PPUT_SIZE

      759     2194    4                             GAP_SZ = UPPER_SCU.LOW_BND - LOWER_SCU.UPP_BND-1;

   2194  2 002007   000001 136000 xsym               SBLQ    LOWER_SCU+1
         2 002010   000001 136007                    SBLQ    1,DL
         2 002011   000000 756000 xsym               STQ     GAP_SZ

      760     2195    4                           END;

      761     2196    3                     END;

      762     2197    2               END;

      763     2198    2           IF ORDBFLG='0'B THEN DO;

   2198  2 002012   000000 236000 xsym               LDQ     ORDBFLG
         2 002013   600000 316003                    CANQ    -65536,DU
         2 002014   002075 601000 2                  TNZ     s:2214

      764     2199    2                 AM2MS = AM2MS_FIXED;

   2199  2 002015   000000 100400                    MLR     fill='000'O
         2 002016   000233 000061 0                  ADSC9   AM2MS_FIXED              cn=0,n=49
         2 002017   000216 000061 0                  ADSC9   AM2MS                    cn=0,n=49

      765     2200                                                /* Type mem size                      */
      766     2201    2                 MESSAGE$=ADDR(AM2MS);

   2201  2 002020   000053 236000 3                  LDQ     43
         2 002021   200004 756100                    STQ     MESSAGE$,,AUTO

      767     2202    2                 IF IS_CFG_TYPE = %IS_CFG_MULT_CAB_REL# THEN

   2202  2 002022   000000 235000 xsym               LDA     IS_CFG_TYPE
         2 002023   000002 115007                    CMPA    2,DL
         2 002024   002037 601000 2                  TNZ     s:2205
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:129  

      768     2203    2                   CALL BINCHAR(SUBSTR(TEXTM.TXT,32,6),HIPAGE+1);

   2203  2 002025   200004 470500                    LDP0    MESSAGE$,,AUTO
         2 002026   000000 720100                    LXL0    0,,PR0
         2 002027   000000 235000 xsym               LDA     HIPAGE
         2 002030   000001 035007                    ADLA    1,DL
         2 002031   000044 773000                    LRL     36
         2 002032   200026 757100                    STAQ    BUILT_MES+12,,AUTO
         2 002033   000100 301500                    BTD
         2 002034   200026 000010                    NDSC9   BUILT_MES+12,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         2 002035   000011 030006                    NDSC9   9,,PR0                   cn=0,s=nosgn,sf=0,n=6
         2 002036   002050 710000 2                  TRA     s:2206

      769     2204    2                   ELSE
      770     2205    2                   CALL BINCHAR(SUBSTR(TEXTM.TXT,32,6),HIPAGE+1-GAP_SZ);

   2205  2 002037   200004 470500                    LDP0    MESSAGE$,,AUTO
         2 002040   000000 720100                    LXL0    0,,PR0
         2 002041   000000 236000 xsym               LDQ     HIPAGE
         2 002042   000000 136000 xsym               SBLQ    GAP_SZ
         2 002043   000001 036007                    ADLQ    1,DL
         2 002044   200026 756100                    STQ     BUILT_MES+12,,AUTO
         2 002045   000100 301500                    BTD
         2 002046   200026 000004                    NDSC9   BUILT_MES+12,,AUTO       cn=0,s=lsgnf,sf=0,n=4
         2 002047   000011 030006                    NDSC9   9,,PR0                   cn=0,s=nosgn,sf=0,n=6

      771     2206    3                 DO WHILE (SUBSTR(TEXTM.TXT,32,1)='0');

   2206  2 002050   002063 710000 2                  TRA     s:2209

      772     2207    3                   SUBSTR(TEXTM.TXT,32)=SUBSTR(TEXTM.TXT,33);

   2207  2 002051   200004 470500                    LDP0    MESSAGE$,,AUTO
         2 002052   000000 720100                    LXL0    0,,PR0
         2 002053   777737 621010                    EAX1    -33,X0
         2 002054   777740 622010                    EAX2    -32,X0
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:130  
         2 002055   040140 100540                    MLR     fill='040'O
         2 002056   000011 200011                    ADSC9   9,,PR0                   cn=1,n=*X1
         2 002057   000011 000012                    ADSC9   9,,PR0                   cn=0,n=*X2

      773     2208    3                   TEXTM.CNT = TEXTM.CNT - 1;

   2208  2 002060   000000 235100                    LDA     0,,PR0
         2 002061   000001 135007                    SBLA    1,DL
         2 002062   000000 755100                    STA     0,,PR0

      774     2209    3                 END;

   2209  2 002063   000000 720100                    LXL0    0,,PR0
         2 002064   000011 236100                    LDQ     9,,PR0
         2 002065   777000 376003                    ANQ     -512,DU
         2 002066   060000 116003                    CMPQ    24576,DU
         2 002067   002051 600000 2                  TZE     s:2207

      775     2210    2                 CALL TYPEC(AM2MS);

   2210  2 002070   000053 630400 3                  EPPR0   43
         2 002071   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002072   000000 701000 xent               TSX1    TYPEC
         2 002073   000000 011000                    NOP     0

      776     2211    2                 RETURN;

   2211  2 002074   000000 702200 xent               TSX2  ! X66_ARET

      777     2212    2               END;                        /* THEN                               */
      778     2213    2             ELSE DO;

      779     2214    2                 ALTRETURN;

   2214  2 002075   000000 702200 xent               TSX2  ! X66_AALT

      780     2215    2               END;                        /*ELSE                                */
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:131  
      781     2216    1   HELPTB:
      782     2217    1           CALL TYPEC(HELPA);

   2217  2 002076   000054 630400 3     HELPTB       EPPR0   44
         2 002077   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002100   000000 701000 xent               TSX1    TYPEC
         2 002101   000000 011000                    NOP     0

      783     2218    1   HELPDBOR:
      784     2219    1           CALL TYPEC(HELPD);

   2219  2 002102   000055 630400 3     HELPDBOR     EPPR0   45
         2 002103   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002104   000000 701000 xent               TSX1    TYPEC
         2 002105   000000 011000                    NOP     0

      785     2220    1           IF ORDBFLG~='0'B THEN GOTO HELPALL;

   2220  2 002106   000000 236000 xsym               LDQ     ORDBFLG
         2 002107   600000 316003                    CANQ    -65536,DU
         2 002110   002125 601000 2                  TNZ     HELPALL

      786     2221    1             ELSE;
      787     2222    1           CALL TYPEC(HELPP);

   2222  2 002111   000056 630400 3                  EPPR0   46
         2 002112   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002113   000000 701000 xent               TSX1    TYPEC
         2 002114   000000 011000                    NOP     0

      788     2223    1           CALL TYPEC(HELPX);

   2223  2 002115   000057 630400 3                  EPPR0   47
         2 002116   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002117   000000 701000 xent               TSX1    TYPEC
         2 002120   000000 011000                    NOP     0

PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:132  
      789     2224    1           CALL TYPEC(HELPF);

   2224  2 002121   000060 630400 3                  EPPR0   48
         2 002122   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002123   000000 701000 xent               TSX1    TYPEC
         2 002124   000000 011000                    NOP     0

      790     2225    1   HELPALL:
      791     2226    1           CALL TYPEC(HELPY);

   2226  2 002125   000061 630400 3     HELPALL      EPPR0   49
         2 002126   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002127   000000 701000 xent               TSX1    TYPEC
         2 002130   000000 011000                    NOP     0

      792     2227    1           CALL TYPEC(HELPN);

   2227  2 002131   000062 630400 3                  EPPR0   50
         2 002132   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002133   000000 701000 xent               TSX1    TYPEC
         2 002134   000000 011000                    NOP     0

      793     2228    1           IF ORDBFLG='0'B THEN GOTO Q1;

   2228  2 002135   000000 236000 xsym               LDQ     ORDBFLG
         2 002136   600000 316003                    CANQ    -65536,DU
         2 002137   000773 600000 2                  TZE     Q1

      794     2229    1             ELSE GOTO Q2;

   2229  2 002140   000766 710000 2                  TRA     Q2
      795     2230    1   END PUSSYCAT_PL6;
      796     2231        %EOD;

PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:133  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure PUSSYCAT_PL6.
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:134  

 **** Variables and constants ****

  ****  Section 000  Data  PUSSYCAT_PL6

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   216-0-0/w STRC(441)   r     1 AM2MS                    233-0-0/w STRC(441)   r     1 AM2MS_FIXED
    10-0-0/w STRC(72)    r     1 BOOTINFO                 100-0-0/w STRC(234)   r     1 CATQCH
   107-0-0/w STRC(162)   r     1 CATQFEP                   70-0-0/w STRC(270)   r     1 CATQU
     6-0-0/w UBIN        r     1 FEPCHAN                    5-0-0/w UBIN        r     1 FEPIOM
   134-0-0/w STRC(414)   r     1 HELPA                    150-0-0/w STRC(360)   r     1 HELPD
   205-0-0/w STRC(315)   r     1 HELPF                    124-0-0/w STRC(288)   r     1 HELPN
   162-0-0/w STRC(369)   r     1 HELPP                    175-0-0/w STRC(270)   r     1 HELPX
   114-0-0/w STRC(279)   r     1 HELPY                     17-0-0/w STRC(576)   r     1 HUHHH
     2-0-0/w UBIN        r     1 IMWBASE                    7-0-0/w UBIN        r     1 MDELTAFLG
     0-0-0/w STRC(72)    r     1 OCZONE                    37-0-0/w STRC(459)   r     1 Q1Q
    54-0-0/w STRC(423)   r     1 Q2Q                      250-0-0/w STRC(297)   r     1 RCVRM
    12-0-0/b BIT         r     1 SILENT                    13-0-0/w STRC(144)   r     1 TBDBORQ
     3-0-0/b BIT         r     1 TYPEBI                     4-0-0/w UBIN        r     1 URCHN

  ****  Section 001 RoData PUSSYCAT_PL6

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(9)     r     1 AARDVARK_NAME              3-0-0/c CHAR(16)    r     1 AARDVARK_SERVICE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    12-0-0/w STRC(396)   r     1 BUILT_MES                  7-0-0/w UBIN        r     1 CHG_CHN
     6-0-0/w UBIN        r     1 CHG_IOM                   11-0-0/w PTR         r     1 COMMAND$
     3-0-0/w UBIN        r     1 HIGHEST_CHAN              10-0-0/w UBIN        r     1 I
     4-0-0/w PTR         r     1 MESSAGE$                   5-0-0/w UBIN        r     1 TIME_OUT
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:135  

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b STRC(5)     r     1 ADPXF                      0-0-0/b BIT         r     1 ALPHA_FLG
     0-0-0/w STRC(180)   r     1 ANSBUF                     0-0-0/w UBIN        r     1 BOOTTAPE
     0-0-0/c ASTR(9)     r     1 B_VERSION                  0-0-0/b BIT         r     1 CHN_CFG(0:511)
     0-0-0/d STRC(288)   r     1 CONNECT_TABLE              0-0-0/b BIT         r     1 CONS_DCWS
     0-0-0/b STRC(18)    r     1 CONS_INFO                  0-0-0/w STRC(864)   r     1 CONS_MBX
     0-0-0/d STRC(396)   r     1 DEVINFO(0:21)              0-0-0/w PTR         r     1 FIELD$
     0-0-0/w UBIN        r     1 FIELD_LEN                  0-0-0/b BIT         r     1 FW_LOAD(0:511)
     0-0-0/w UBIN        r     1 GAP_SZ                     0-0-0/w UBIN        r     1 HIPAGE
     0-0-0/w STRC        r     1 IOMTAB(0:3)                0-0-0/w UBIN        r     1 IS_CFG_TYPE
     0-0-0/w UBIN        r     1 IS_PPUT_SIZE               0-0-0/w STRC(72)    r     1 LOWER_SCU
     0-0-0/w STRC(14616) r     1 MCA_CFG                    0-0-0/b BIT         r     1 MONPA
     0-0-0/b STRC(2)     r     1 ORDBFLG                    0-0-0/w STRC(864)   r     1 PATT_MBX
     0-0-0/b BIT         r     1 PLVPA                      0-0-0/b STRC(4)     r     1 RCV_FLG
     0-0-0/b STRC        r     1 RPM_BOOTIN                 0-0-0/b STRC        r     1 RPM_BOOT_IDCW
     0-0-0/w SBIN        r     1 RPM_CONSOLE                0-0-0/b BIT         r     1 RPM_FLG
     0-0-0/b BIT         r     1 RUMPA                      0-0-0/b BIT         r     1 S1000_FLG
     0-0-0/b BIT         r     1 SH_DCWS                    0-0-0/w STRC(864)   r     1 SH_MBX
     0-0-0/b BIT         r     1 TIGRPA                     0-0-0/w STRC(72)    r     1 UPPER_SCU
     0-0-0/b BIT         r     1 VOFLG

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(16)    r     1 ANS                        0-0-0/w ASTR        r     1 TEXTM


   Procedure PUSSYCAT_PL6 requires 1121 words for executable code.
   Procedure PUSSYCAT_PL6 requires 26 words of local(AUTO) storage.
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:136  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:137  
          MINI XREF LISTING

AARDVARK_NAME
      1877**DCL      2008>>ASSIGN   2009--ASSIGN   2010--ASSIGN   2011--ASSIGN
AARDVARK_SERVICE
      1878**DCL      2010--ASSIGN   2010>>ASSIGN   2011--ASSIGN
ADPXF
      1457**DCL      2054<<ASSIGN   2063<<ASSIGN
ADPXF.A
      1458**DCL      2076<<ASSIGN
ADPXF.D
      1459**DCL      2064<<ASSIGN   2078<<ASSIGN   2097>>IF
ADPXF.F
      1462**DCL      2087<<ASSIGN
ADPXF.P
      1460**DCL      2081<<ASSIGN
ADPXF.X
      1461**DCL      2084<<ASSIGN
ALPHA_FLG
      1778**DCL      2113>>IF       2128>>IF       2135>>IF       2154>>IF       2161>>IF       2174>>IF
      2178>>IF
AM2MS
      1863**DCL      2199<<ASSIGN   2201--ASSIGN   2210<>CALL
AM2MS_FIXED
      1868**DCL      2199>>ASSIGN
ANS
      1885**DCL      2115>>CALLBLT  2129>>CALLBLT  2137>>CALLBLT  2155>>CALLBLT  2163>>CALLBLT  2175>>CALLBLT
      2180>>CALLBLT
ANSBUF
      1768**DCL      2016<>CALL     2049<>CALL     2052<>CALL     2100<>CALL     2111<>CALL     2126<>CALL
      2152<>CALL     2172<>CALL
ANSBUF.TXT
      1770**DCL      2017>>IF       2019<>CALL     2020>>DOSELCT  2055<>CALL     2056>>DOSELCT  2067>>DOSELCT
      2072<>CALL     2073>>DOSELCT  2101<>CALL     2102<>CALL     2103>>DOSELCT  2112<>CALL     2127<>CALL
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:138  
      2134<>CALL     2153<>CALL     2160<>CALL     2173<>CALL     2177<>CALL
BOOTINFO.BCHN
      1431**DCL      1904<<ASSIGN   1931>>ASSIGN   1941>>CALLBLT
BOOTINFO.BIMWAD
      1435**DCL      1976>>ASSIGN
BOOTINFO.BIOM#
      1437**DCL      1905<<ASSIGN   1910>>CALLBLT  1926>>ASSIGN   1935>>CALLBLT  1938>>CALLBLT  1973>>ASSIGN
      1974>>ASSIGN
BOOTINFO.BIOMAD
      1434**DCL      1973>>ASSIGN
BOOTINFO.BPORT#
      1433**DCL      1974>>ASSIGN
BOOTTAPE
      1464**DCL      1956>>IF       1956>>IF       1957<<ASSIGN
BUILT_MES
      1886**DCL      2012<>CALL     2126<>CALL     2152<>CALL
BUILT_MES.CNT
      1887**DCL      2011<<ASSIGN   2124<<ASSIGN   2150<<ASSIGN
BUILT_MES.TXT
      1888**DCL      2008<<ASSIGN   2009<<ASSIGN   2010<<ASSIGN   2121<<ASSIGN   2122<<ASSIGN   2123<<ASSIGN
      2147<<ASSIGN   2148<<ASSIGN   2149<<ASSIGN
B_VERSION.C
      1762**DCL      2009>>ASSIGN
B_VERSION.L
      1761**DCL      1762--IMP-SIZ  2009>>ASSIGN   2009>>ASSIGN   2010>>ASSIGN   2011>>ASSIGN
CAT5
      2100**LABEL    2108--GOTO
CAT6
      2103**LABEL    2113--GOTO     2116--GOTO
CAT6E
      2119**LABEL    2112--CALLALT
CAT7A
      2126**LABEL    2128--GOTO     2130--GOTO     2134--CALLALT  2135--GOTO     2138--GOTO
CAT7E
      2144**LABEL    2127--CALLALT
CAT8A
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:139  
      2152**LABEL    2154--GOTO     2156--GOTO     2160--CALLALT  2161--GOTO     2164--GOTO
CAT8E
      2170**LABEL    2153--CALLALT
CAT9
      2172**LABEL    2101--CALLALT  2105--GOTO     2174--GOTO     2176--GOTO     2177--CALLALT  2178--GOTO
      2181--GOTO
CAT9E
      2181**LABEL    2055--CALLALT  2061--GOTO     2097--GOTO     2173--CALLALT
CATQCH
      1818**DCL      2111<>CALL
CATQFEP
      1823**DCL      1908--ASSIGN   2172<>CALL
CATQU
      1813**DCL      2100<>CALL
CHG_CHN
      1882**DCL      2137<<CALLBLT  2138>>IF       2140>>ASSIGN   2163<<CALLBLT  2164>>IF       2165>>ASSIGN
CHG_IOM
      1881**DCL      2129<<CALLBLT  2130>>IF       2132>>IF       2133<>CALL     2139>>ASSIGN   2155<<CALLBLT
      2156>>IF       2158>>IF       2159<>CALL     2166>>ASSIGN
CHN_CFG
      1790**DCL      1958>>IF
COMMAND$
      1884**DCL      1993<<ASSIGN   1997<>CALL
CONNECT_TABLE.ENTRI.SCU_PORT
      1383**DCL      1967>>ASSIGN
CONS_DCWS
      1473**DCL      1949--ASSIGN
CONS_INFO.CHN#
      1767**DCL      1980>>ASSIGN
CONS_INFO.IOM#
      1766**DCL      1981>>ASSIGN
CONS_MBX
      1485**DCL      1946<<ASSIGN   1948--ASSIGN
CONS_MBX.STATUS.W8
      1515**DCL      1518--REDEF
DEVINFO.BSTAT.W1.H1
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:140  
      1338**DCL      1998>>IF
DEVINFO.CHN#
      1296**DCL      1912<<ASSIGN   1916<<ASSIGN   1920<<ASSIGN   1931<<ASSIGN   1956>>IF       1960<<ASSIGN
      1980<<ASSIGN   1985<<ASSIGN   1996<<ASSIGN   2140<<ASSIGN   2142>>CALLBLT  2165<<ASSIGN   2168>>CALLBLT
DEVINFO.DEV#
      1297**DCL      1932<<ASSIGN   1961<<ASSIGN
DEVINFO.DEVNAME
      1343**DCL      1913<<ASSIGN   1917<<ASSIGN   1921<<ASSIGN   1935<<CALLBLT  1938<<CALLBLT  1941<<CALLBLT
      1942<<CALLBLT  1962<<ASSIGN   1963<<ASSIGN   2007<<CALLBLT  2122>>ASSIGN   2141<<CALLBLT  2142<<CALLBLT
      2148>>ASSIGN   2167<<CALLBLT  2168<<CALLBLT
DEVINFO.IOM#
      1298**DCL      1926<<ASSIGN   1956>>IF       1981<<ASSIGN   2139<<ASSIGN   2141>>CALLBLT  2166<<ASSIGN
      2167>>CALLBLT
DEVINFO.PCWS
      1300**DCL      1311--REDEF
DEVINFO.RPM_PTRS.EF_DCWS$
      1313**DCL      1314--REDEF    1949<<ASSIGN   1952<<ASSIGN
DEVINFO.RPM_PTRS.MBX$
      1312**DCL      1948<<ASSIGN   1951<<ASSIGN
DEVINFO.STATUS
      1317**DCL      1336--REDEF
DEVINFO.STATUS.IOM_CENT_STAT
      1328**DCL      1998>>IF
DEVINFO.STATUS.IOM_CHAN_STAT
      1327**DCL      1998>>IF
DOIO
      1890**DCL-ENT  1997--CALL
DO_RPM_CFG
      1891**DCL-ENT  1955--CALL     2133--CALL     2159--CALL
DO_RPM_TIME
      1893**DCL-ENT  2030--CALL
DO_SCU_STATE
      1892**DCL-ENT  2188--CALL
FEPCHAN
      1428**DCL      1907<<ASSIGN   2180<<CALLBLT  2181>>IF
FEPIOM
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:141  
      1427**DCL      2175<<CALLBLT  2176>>IF
FIELD$
      1775**DCL      1885--IMP-PTR  2115>>CALLBLT  2129>>CALLBLT  2137>>CALLBLT  2155>>CALLBLT  2163>>CALLBLT
      2175>>CALLBLT  2180>>CALLBLT
FIELD_LEN
      1776**DCL      2115>>CALLBLT  2129>>CALLBLT  2134>>CALL     2134>>CALL     2137>>CALLBLT  2155>>CALLBLT
      2160>>CALL     2160>>CALL     2163>>CALLBLT  2175>>CALLBLT  2177>>CALL     2177>>CALL     2180>>CALLBLT
FINDOC
      1993**LABEL    2003--GOTO
FW_LOAD
      1465**DCL      1956>>IF
GAP_SZ
      1780**DCL      2194<<ASSIGN   2205>>CALLBLT
GETFD
      1897**DCL-ENT  2055--CALL     2101--CALL     2112--CALL     2127--CALL     2134--CALL     2153--CALL
      2160--CALL     2173--CALL     2177--CALL
HELPA
      1838**DCL      2217<>CALL
HELPALL
      2226**LABEL    2220--GOTO
HELPD
      1843**DCL      2219<>CALL
HELPDBOR
      2219**LABEL    2059--GOTO
HELPF
      1858**DCL      2224<>CALL
HELPN
      1833**DCL      2227<>CALL
HELPP
      1848**DCL      2222<>CALL
HELPTB
      2217**LABEL    2058--GOTO
HELPX
      1853**DCL      2223<>CALL
HELPY
      1828**DCL      2226<>CALL
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:142  
HIGHEST_CHAN
      1759**DCL      1901<<ASSIGN   1903<<ASSIGN   1995>>DOINDEX  2116>>IF       2138>>IF       2164>>IF
      2181>>IF
HIPAGE
      1779**DCL      2185>>ASSIGN   2203>>CALLBLT  2205>>CALLBLT
HUHHH
      1798**DCL      2046<>CALL
I
      1883**DCL      1911<<DOINDEX  1912>>ASSIGN   1913>>ASSIGN   1915<<DOINDEX  1916>>ASSIGN   1917>>ASSIGN
      1919<<DOINDEX  1920>>ASSIGN   1921>>ASSIGN   1925<<DOINDEX  1926>>ASSIGN   1930<<DOINDEX  1931>>ASSIGN
      1932>>ASSIGN   1932>>ASSIGN   1934<<DOINDEX  1935>>CALLBLT  1937<<DOINDEX  1938>>CALLBLT  1940<<DOINDEX
      1941>>CALLBLT  1942>>CALLBLT  1942>>CALLBLT  1950<<DOINDEX  1951>>ASSIGN   1952>>ASSIGN   1954<<ASSIGN
      1955<>CALL     1958>>IF       1959<<DOINDEX  1960>>ASSIGN   1961>>ASSIGN   1962>>ASSIGN   1963>>ASSIGN
      1966<<DOINDEX  1967>>ASSIGN   1967>>ASSIGN   1972<<DOINDEX  1973>>ASSIGN   1973>>ASSIGN   1974>>ASSIGN
      1974>>ASSIGN   1988<<DOINDEX  1995<<DOINDEX  1996>>ASSIGN   2007>>CALLBLT  2029<<ASSIGN   2030<>CALL
      2066<<DOINDEX  2067>>DOSELCT  2072>>CALL     2073>>DOSELCT  2119<<DOINDEX  2122>>ASSIGN   2139>>ASSIGN
      2140>>ASSIGN   2141>>CALLBLT  2141>>CALLBLT  2142>>CALLBLT  2142>>CALLBLT  2145<<DOINDEX  2148>>ASSIGN
      2165>>ASSIGN   2166>>ASSIGN   2167>>CALLBLT  2167>>CALLBLT  2168>>CALLBLT  2168>>CALLBLT  2187<<ASSIGN
      2188<>CALL
IMWBASE
      1424**DCL      1976<<ASSIGN
IOMTAB.MAILBAD
      1365**DCL      1973<<ASSIGN
IOMTAB.PORT#
      1367**DCL      1967<<ASSIGN   1974<<ASSIGN
IS_CFG_TYPE
      1787**DCL      2189>>IF       2202>>IF
IS_PPUT_SIZE
      1788**DCL      2185<<ASSIGN   2193<<ASSIGN
ITSHELP
      2046**LABEL    2017--GOTO
ITSTB
      2040**LABEL    2022--GOTO     2035--GOTO
KEYIN
      1894**DCL-ENT  2016--CALL     2049--CALL     2052--CALL     2100--CALL     2111--CALL     2126--CALL
      2152--CALL     2172--CALL
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:143  
LOWER_SCU.UPP_BND
      1783**DCL      2194>>ASSIGN
MCA_CFG.LEVEL_1.CONSOLE_CNTL
      1717**DCL      1723--REDEF    1727--REDEF
MCA_CFG.PORT_INFO.SIZE
      1709**DCL      2190>>ASSIGN
MCA_CFG.PORT_INFO.START_ADDR
      1713**DCL      2190>>ASSIGN   2192>>ASSIGN
MDELTAFLG
      1429**DCL      2070<<ASSIGN
MESSAGE$
      1774**DCL      1771--IMP-PTR  1908<<ASSIGN   1909>>ASSIGN   1909>>ASSIGN   1910>>CALLBLT  1910>>CALLBLT
      2201<<ASSIGN   2203>>CALLBLT  2203>>CALLBLT  2205>>CALLBLT  2205>>CALLBLT  2206>>DOWHILE  2206>>DOWHILE
      2207>>ASSIGN   2207>>ASSIGN   2207>>ASSIGN   2207>>ASSIGN   2208>>ASSIGN   2208>>ASSIGN
MONPA
      1467**DCL      2041<<ASSIGN
OCFOUND
      1999**LABEL    1999--GOTO
OCZONE
      1401**DCL      1993--ASSIGN
OCZONE.DCW
      1408**DCL      1412--REDEF    1415--REDEF    1416--REDEF    1992<<ASSIGN
OCZONE.IDCW$
      1407**DCL      1991<<ASSIGN
OCZONE.W1
      1402**DCL      1407--REDEF
ORDBFLG
      1448**DCL      2058>>IF       2063>>IF       2075>>IF       2080>>IF       2083>>IF       2086>>IF
      2091>>IF       2198>>IF       2220>>IF       2228>>IF
ORDBFLG.DBF
      1450**DCL      2024<<ASSIGN
ORDBFLG.ORF
      1449**DCL      2027<<ASSIGN
PATT_MBX
      1599**DCL      1946>>ASSIGN   1947>>ASSIGN
PATT_MBX.STATUS.W8
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:144  
      1629**DCL      1632--REDEF
PLVPA
      1469**DCL      2043<<ASSIGN
Q01
      2054**LABEL    2050--GOTO
Q1
      2052**LABEL    2044--GOTO     2091--GOTO     2228--GOTO
Q1Q
      1803**DCL      2052<>CALL
Q2
      2049**LABEL    2025--GOTO     2032--GOTO     2075--GOTO     2080--GOTO     2083--GOTO     2086--GOTO
      2092--GOTO     2229--GOTO
Q2Q
      1808**DCL      2049<>CALL
RCVRM
      1873**DCL      2184<>CALL
RCV_FLG
      1451**DCL      2015<<ASSIGN
RCV_FLG.RBO
      1455**DCL      2184>>IF
READ_CONNECT_TABLE
      1898**DCL-ENT  1965--CALL
RPM_BOOTIN.CHN#
      1440**DCL      1904>>ASSIGN
RPM_BOOTIN.IMX#
      1442**DCL      1905>>ASSIGN   1954>>ASSIGN   2029>>ASSIGN   2132>>IF       2158>>IF       2187>>ASSIGN
RPM_BOOT_IDCW.DEV#
      1446**DCL      1957>>ASSIGN
RPM_CONSOLE
      1755**DCL      1984>>IF       1985>>ASSIGN
RPM_FLG
      1756**DCL      1902>>IF       1945>>IF       1984>>IF       2028>>IF       2131>>IF       2157>>IF
      2186>>IF
RUMPA
      1468**DCL      2042<<ASSIGN
S1000_FLG
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:145  
      1757**DCL      1979>>IF
SH_DCWS
      1758**DCL      1952--ASSIGN
SH_MBX
      1542**DCL      1947<<ASSIGN   1951--ASSIGN
SH_MBX.STATUS.W8
      1572**DCL      1575--REDEF
SILENT
      1470**DCL      2089<<ASSIGN
TBDBOR
      2015**LABEL    2037--GOTO     2047--GOTO
TBDBORQ
      1793**DCL      2016<>CALL
TEXTM.CNT
      1772**DCL      1773--IMP-SIZ  1909>>ASSIGN   1910>>CALLBLT  2203>>CALLBLT  2205>>CALLBLT  2206>>DOWHILE
      2207>>ASSIGN   2207>>ASSIGN   2208<<ASSIGN   2208>>ASSIGN
TEXTM.TXT
      1773**DCL      1909<<ASSIGN   1910<<CALLBLT  2203<<CALLBLT  2205<<CALLBLT  2206>>DOWHILE  2207<<ASSIGN
      2207>>ASSIGN
TIGRPA
      1466**DCL      2040<<ASSIGN
TIME_OUT
      1880**DCL      1990<<ASSIGN   1997<>CALL
TYPEBI
      1425**DCL      1991--ASSIGN
TYPEC
      1895**DCL-ENT  2012--CALL     2046--CALL     2184--CALL     2210--CALL     2217--CALL     2219--CALL
      2222--CALL     2223--CALL     2224--CALL     2226--CALL     2227--CALL
UPPER_CASE
      1896**DCL-ENT  2019--CALL     2072--CALL     2102--CALL
UPPER_SCU.LOW_BND
      1785**DCL      2192<<ASSIGN   2194>>ASSIGN
UPPER_SCU.UPP_BND
      1786**DCL      2190<<ASSIGN   2193>>ASSIGN
URCHN
      1426**DCL      1906<<ASSIGN   2115<<CALLBLT  2116>>IF
PL6.E3A0      #002=PUSSYCAT_PL6 File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:52 Page:146  
VOFLG
      1456**DCL      2034<<ASSIGN

PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:147  
      797        1        /*T***********************************************************/
      798        2        /*T*                                                         */
      799        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      800        4        /*T*                                                         */
      801        5        /*T***********************************************************/
      802        6        MINIQ_PL6:PROC(INDX,BUF$,L,CODE,GRAN#) ALTRET;
      803        7        /* This programm receives I/O requests */
      804        8        /* Calling param: INDX entry in DEVINFO */
      805        9        /*                BUF$ ptr to buffer    */
      806       10        /*                L buffer length       */
      807       11        /*                CODE  I/O code        */
      808       12        %INCLUDE IS$MACROS;
      809     1287    1   DCL INDX UBIN WORD;
      810     1288    1   DCL BUF$ PTR;
      811     1289        %PTR_STRUCT(NAME=BUF_PTR,STCLASS="REDEF BUF$");
      812     1307    1   DCL L UBIN WORD;
      813     1308    1   DCL CODE UBIN WORD;
      814     1309    1   DCL GRAN# UBIN WORD;
      815     1310        /**/
      816     1311    1   DCL DOIO ENTRY(4);
      817     1312    1   DCL S_INT ENTRY;
      818     1313    1   DCL R_INT ENTRY;
      819     1314    1   DCL CLLD EPTR;
      820     1315        /**/
      821     1316        %DEVINFO(STCLASS="SYMREF");
      822     1385    1   DCL BUF CHAR(1024) BASED(BUF$);
      823     1386        %DCW_STRUCT(NAME=IOTEMP);
      824     1404        %DOIO_COMZONE(NAME=MINI_ZONE);
      825     1437        %DCW_STRUCT(NAME=TDCW_IODCW);
      826     1455    1   DCL IODCW(0:2) STATIC SYMDEF BIT(36) ALIGNED;
      827     1456    1   DCL RETRY_FLG STATIC SYMDEF BIT(1) INIT('0'B);
      828     1457    1   DCL C_FLG STATIC BIT(1) INIT('0'B);
      829     1458    1   DCL IODCW$ PTR STATIC INIT(ADDR(IODCW));
      830     1459        %PTR_STRUCT(NAME=IODCW_PTR,STCLASS="REDEF IODCW$");
      831     1477    1   DCL CODETAB(0:19) BIT(36) BASED ALIGNED;
      832     1478    1   DCL DOIO_COM$ PTR STATIC INIT(ADDR(MINI_ZONE));
      833     1479    1   DCL TIMES_THRU SBIN WORD STATIC INIT(0);
PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:148  
      834     1480        /**/
      835     1481    2           DO INHIBIT;
      836     1482    2             IF TIMES_THRU = 0 THEN
      837     1483    2               CALL S_INT;
      838     1484    2             TIMES_THRU = TIMES_THRU + 1;
      839     1485    2           END;                            /* DO INHIBIT                         */
      840     1486    1   ENT_MINIQ:;
      841     1487    1           C_FLG='0'B;
      842     1488        /* Build a DCW */
      843     1489    1           IOTEMP.AD=BUF_PTR.WOFFS;
      844     1490    1           IOTEMP.CP=BUF_PTR.BYTEPOS;
      845     1491    1           IOTEMP.TYPE='0'B;               /* Make it an IOTD                    */
      846     1492    1           IOTEMP.TALLY=(L+3)/4;
      847     1493    1   MINIQ1:
      848     1494    1           IODCW(0)=IOTEMP;
      849     1495        /* Call device handler routine */
      850     1496    1           CLLD=DEVINFO.HANDROUT$(INDX);
      851     1497    1           RETRY_FLG='0'B;
      852     1498    1           CALL CLLD(INDX,CODE,GRAN#) ALTRET(MINIQER);
      853     1499        /* Build DOIO command zone */
      854     1500    1           MINI_ZONE.IDCW$=ADDR(DEVINFO.FUNCTAB$(INDX)->CODETAB(CODE));
      855     1501    1           TDCW_IODCW.AD=IODCW_PTR.WOFFS;
      856     1502    1           TDCW_IODCW.TYPE='10'B;          /* TDCW to IODCW                      */
      857     1503    1           MINI_ZONE.DCW=TDCW_IODCW;
      858     1504    1           CALL DOIO(INDX,DOIO_COM$);
      859     1505        /* Call device clean_up routine */
      860     1506    1           CLLD=DEVINFO.CLEANROUT$(INDX);
      861     1507    1           RETRY_FLG='0'B;
      862     1508    1           CALL CLLD(INDX,CODE,GRAN#) ALTRET(MINIQER);
      863     1509    2           DO INHIBIT;
      864     1510    2             TIMES_THRU = TIMES_THRU - 1;
      865     1511    2             IF TIMES_THRU = 0 THEN
      866     1512    2               CALL R_INT;
      867     1513    2             RETURN;
      868     1514    2           END;                            /* DO INHIBIT                         */
      869     1515    1   MINIQER:;
      870     1516    2           IF RETRY_FLG='1'B THEN DO;
PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:149  
      871     1517    2                 IF C_FLG='0'B THEN GOTO ENT_MINIQ;
      872     1518    2                   ELSE GOTO ENT_MINIQC;
      873     1519    2               END;                        /* THEN                               */
      874     1520    1             ELSE;
      875     1521    2           DO INHIBIT;
      876     1522    2             TIMES_THRU = TIMES_THRU - 1;
      877     1523    2             IF TIMES_THRU = 0 THEN
      878     1524    2               CALL R_INT;
      879     1525    2             ALTRETURN;
      880     1526    2           END;                            /* DO INHIBIT                         */
      881     1527        /**/
      882     1528    1   MINIQC_PL6:ENTRY(INDX,BUF$,L,CODE,GRAN#) ALTRET;
      883     1529        /* Here BUF$ is the address of an user DCW */
      884     1530    2           DO INHIBIT;
      885     1531    2             IF TIMES_THRU = 0 THEN
      886     1532    2               CALL S_INT;
      887     1533    2             TIMES_THRU = TIMES_THRU + 1;
      888     1534    2           END;                            /* DO INHIBIT                         */
      889     1535    1   ENT_MINIQC:
      890     1536        /* Build a TDCW to user's DCW */
      891     1537    1           IOTEMP.AD=BUF_PTR.WOFFS;
      892     1538    1           IOTEMP.CP=0;
      893     1539    1           IOTEMP.NU='0'B;
      894     1540    1           IOTEMP.TYPE='10'B;              /* Make a TDCW                        */
      895     1541    1           IOTEMP.TALLY=0;
      896     1542    1           C_FLG='1'B;                     /* For possible retry                 */
      897     1543    1           GOTO MINIQ1;
      898     1544    1   END MINIQ_PL6;
      899     1545        %EOD;

PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:150  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure MINIQ_PL6.

   Procedure MINIQ_PL6 requires 129 words for executable code.
   Procedure MINIQ_PL6 requires 14 words of local(AUTO) storage.

PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:151  

 Object Unit name= MINIQ_PL6                                  File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:52:30.76 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    12     14  MINIQ_PL6
    1   Proc  even  none   129    201  MINIQ_PL6
    2  RoData even  none     4      4  MINIQ_PL6

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        5  MINIQ_PL6
     1    151          yes     yes      Std        5  MINIQC_PL6

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  IOTEMP                             0      1  MINI_ZONE
    0      3  TDCW_IODCW                         0      4  IODCW
    0      7  RETRY_FLG
PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:152  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 S_INT
         yes           Std       4 DOIO
         yes           Std       0 R_INT
                       nStd      0 X66_AUTO_5
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DEVINFO                               B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:153  


      797        1        /*T***********************************************************/
      798        2        /*T*                                                         */
      799        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      800        4        /*T*                                                         */
      801        5        /*T***********************************************************/
      802        6        MINIQ_PL6:PROC(INDX,BUF$,L,CODE,GRAN#) ALTRET;

      6  1 000000   000000 700200 xent  MINIQ_PL6    TSX0  ! X66_AUTO_5
         1 000001   000016 000005                    ZERO    14,5

      803        7        /* This programm receives I/O requests */
      804        8        /* Calling param: INDX entry in DEVINFO */
      805        9        /*                BUF$ ptr to buffer    */
      806       10        /*                L buffer length       */
      807       11        /*                CODE  I/O code        */
      808       12        %INCLUDE IS$MACROS;
      809     1287    1   DCL INDX UBIN WORD;
      810     1288    1   DCL BUF$ PTR;
      811     1289        %PTR_STRUCT(NAME=BUF_PTR,STCLASS="REDEF BUF$");
      812     1307    1   DCL L UBIN WORD;
      813     1308    1   DCL CODE UBIN WORD;
      814     1309    1   DCL GRAN# UBIN WORD;
      815     1310        /**/
      816     1311    1   DCL DOIO ENTRY(4);
      817     1312    1   DCL S_INT ENTRY;
      818     1313    1   DCL R_INT ENTRY;
      819     1314    1   DCL CLLD EPTR;
      820     1315        /**/
      821     1316        %DEVINFO(STCLASS="SYMREF");
      822     1385    1   DCL BUF CHAR(1024) BASED(BUF$);
      823     1386        %DCW_STRUCT(NAME=IOTEMP);
      824     1404        %DOIO_COMZONE(NAME=MINI_ZONE);
      825     1437        %DCW_STRUCT(NAME=TDCW_IODCW);
      826     1455    1   DCL IODCW(0:2) STATIC SYMDEF BIT(36) ALIGNED;
      827     1456    1   DCL RETRY_FLG STATIC SYMDEF BIT(1) INIT('0'B);
      828     1457    1   DCL C_FLG STATIC BIT(1) INIT('0'B);
PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:154  
      829     1458    1   DCL IODCW$ PTR STATIC INIT(ADDR(IODCW));
      830     1459        %PTR_STRUCT(NAME=IODCW_PTR,STCLASS="REDEF IODCW$");
      831     1477    1   DCL CODETAB(0:19) BIT(36) BASED ALIGNED;
      832     1478    1   DCL DOIO_COM$ PTR STATIC INIT(ADDR(MINI_ZONE));
      833     1479    1   DCL TIMES_THRU SBIN WORD STATIC INIT(0);
      834     1480        /**/
      835     1481    2           DO INHIBIT;

      836     1482    2             IF TIMES_THRU = 0 THEN

   1482  1 000002   000013 235200 0                  LDA   ! TIMES_THRU
         1 000003   000007 601200 1                  TNZ   ! s:1484

      837     1483    2               CALL S_INT;

   1483  1 000004   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         1 000005   000000 701200 xent               TSX1  ! S_INT
         1 000006   000000 011200                    NOP   ! 0

      838     1484    2             TIMES_THRU = TIMES_THRU + 1;

   1484  1 000007   000013 054200 0                  AOS   ! TIMES_THRU

      839     1485    2           END;                            /* DO INHIBIT                         */

   1484  1 000010                       ENT_MINIQ    null
      840     1486    1   ENT_MINIQ:;
      841     1487    1           C_FLG='0'B;

   1487  1 000010   000010 450000 0                  STZ     C_FLG

      842     1488        /* Build a DCW */
      843     1489    1           IOTEMP.AD=BUF_PTR.WOFFS;

   1489  1 000011   200004 470500                    LDP0    @BUF$,,AUTO
         1 000012   000000 220100                    LDX0    0,,PR0
         1 000013   000000 740000 0                  STX0    IOTEMP
PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:155  

      844     1490    1           IOTEMP.CP=BUF_PTR.BYTEPOS;

   1490  1 000014   000000 236100                    LDQ     0,,PR0
         1 000015   600000 376007                    ANQ     -65536,DL
         1 000016   000001 772000                    QRL     1
         1 000017   000000 676000 0                  ERQ     IOTEMP
         1 000020   700000 376007                    ANQ     -32768,DL
         1 000021   000000 656000 0                  ERSQ    IOTEMP

      845     1491    1           IOTEMP.TYPE='0'B;               /* Make it an IOTD                    */

   1491  1 000022   000000 236000 2                  LDQ     0
         1 000023   000000 356000 0                  ANSQ    IOTEMP

      846     1492    1           IOTEMP.TALLY=(L+3)/4;

   1492  1 000024   200005 471500                    LDP1    @L,,AUTO
         1 000025   100000 236100                    LDQ     0,,PR1
         1 000026   000003 036007                    ADLQ    3,DL
         1 000027   000002 772000                    QRL     2
         1 000030   000000 752003 0                  STCQ    IOTEMP,'03'O

      847     1493    1   MINIQ1:
      848     1494    1           IODCW(0)=IOTEMP;

   1494  1 000031   000000 236000 0     MINIQ1       LDQ     IOTEMP
         1 000032   000004 756000 0                  STQ     IODCW

      849     1495        /* Call device handler routine */
      850     1496    1           CLLD=DEVINFO.HANDROUT$(INDX);

   1496  1 000033   200003 470500                    LDP0    @INDX,,AUTO
         1 000034   000000 236100                    LDQ     0,,PR0
         1 000035   000006 402007                    MPY     6,DL
         1 000036   000001 736000                    QLS     1
         1 000037   000010 236006 xsym               LDQ     DEVINFO+8,QL
PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:156  
         1 000040   200010 756100                    STQ     CLLD,,AUTO

      851     1497    1           RETRY_FLG='0'B;

   1497  1 000041   000007 450000 0                  STZ     RETRY_FLG

      852     1498    1           CALL CLLD(INDX,CODE,GRAN#) ALTRET(MINIQER);

   1498  1 000042   200007 236100                    LDQ     @GRAN#,,AUTO
         1 000043   200014 756100                    STQ     CLLD+4,,AUTO
         1 000044   200006 236100                    LDQ     @CODE,,AUTO
         1 000045   200003 235100                    LDA     @INDX,,AUTO
         1 000046   200012 757100                    STAQ    CLLD+2,,AUTO
         1 000047   200012 630500                    EPPR0   CLLD+2,,AUTO
         1 000050   200010 220100                    LDX0    CLLD,,AUTO
         1 000051   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000052   000000 701010                    TSX1    0,X0
         1 000053   000134 702000 1                  TSX2    MINIQER

      853     1499        /* Build DOIO command zone */
      854     1500    1           MINI_ZONE.IDCW$=ADDR(DEVINFO.FUNCTAB$(INDX)->CODETAB(CODE));

   1500  1 000054   200003 470500                    LDP0    @INDX,,AUTO
         1 000055   000000 236100                    LDQ     0,,PR0
         1 000056   000006 402007                    MPY     6,DL
         1 000057   000001 736000                    QLS     1
         1 000060   000012 471406 xsym               LDP1    DEVINFO+10,QL
         1 000061   200006 473500                    LDP3    @CODE,,AUTO
         1 000062   300000 720100                    LXL0    0,,PR3
         1 000063   100000 634510                    EPPR4   0,X0,PR1
         1 000064   000001 454400 0                  STP4    MINI_ZONE

      855     1501    1           TDCW_IODCW.AD=IODCW_PTR.WOFFS;

   1501  1 000065   000011 220000 0                  LDX0    IODCW$
         1 000066   000003 740000 0                  STX0    TDCW_IODCW

PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:157  
      856     1502    1           TDCW_IODCW.TYPE='10'B;          /* TDCW to IODCW                      */

   1502  1 000067   000003 236000 0                  LDQ     TDCW_IODCW
         1 000070   000000 376000 2                  ANQ     0
         1 000071   020000 276007                    ORQ     8192,DL
         1 000072   000003 756000 0                  STQ     TDCW_IODCW

      857     1503    1           MINI_ZONE.DCW=TDCW_IODCW;

   1503  1 000073   000003 236000 0                  LDQ     TDCW_IODCW
         1 000074   000002 756000 0                  STQ     MINI_ZONE+1

      858     1504    1           CALL DOIO(INDX,DOIO_COM$);

   1504  1 000075   000001 236000 2                  LDQ     1
         1 000076   200003 235100                    LDA     @INDX,,AUTO
         1 000077   200012 757100                    STAQ    CLLD+2,,AUTO
         1 000100   200012 630500                    EPPR0   CLLD+2,,AUTO
         1 000101   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000102   000000 701000 xent               TSX1    DOIO
         1 000103   000000 011000                    NOP     0

      859     1505        /* Call device clean_up routine */
      860     1506    1           CLLD=DEVINFO.CLEANROUT$(INDX);

   1506  1 000104   200003 470500                    LDP0    @INDX,,AUTO
         1 000105   000000 236100                    LDQ     0,,PR0
         1 000106   000006 402007                    MPY     6,DL
         1 000107   000001 736000                    QLS     1
         1 000110   000011 236006 xsym               LDQ     DEVINFO+9,QL
         1 000111   200010 756100                    STQ     CLLD,,AUTO

      861     1507    1           RETRY_FLG='0'B;

   1507  1 000112   000007 450000 0                  STZ     RETRY_FLG

      862     1508    1           CALL CLLD(INDX,CODE,GRAN#) ALTRET(MINIQER);
PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:158  

   1508  1 000113   200007 236100                    LDQ     @GRAN#,,AUTO
         1 000114   200014 756100                    STQ     CLLD+4,,AUTO
         1 000115   200006 236100                    LDQ     @CODE,,AUTO
         1 000116   200003 235100                    LDA     @INDX,,AUTO
         1 000117   200012 757100                    STAQ    CLLD+2,,AUTO
         1 000120   200012 630500                    EPPR0   CLLD+2,,AUTO
         1 000121   200010 220100                    LDX0    CLLD,,AUTO
         1 000122   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000123   000000 701010                    TSX1    0,X0
         1 000124   000134 702000 1                  TSX2    MINIQER

      863     1509    2           DO INHIBIT;

      864     1510    2             TIMES_THRU = TIMES_THRU - 1;

   1510  1 000125   000001 336207                    LCQ   ! 1,DL
         1 000126   000013 056200 0                  ASQ   ! TIMES_THRU

      865     1511    2             IF TIMES_THRU = 0 THEN

   1511  1 000127   000133 601200 1                  TNZ   ! s:1513

      866     1512    2               CALL R_INT;

   1512  1 000130   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         1 000131   000000 701200 xent               TSX1  ! R_INT
         1 000132   000000 011200                    NOP   ! 0

      867     1513    2             RETURN;

   1513  1 000133   000000 702200 xent               TSX2  ! X66_ARET

      868     1514    2           END;                            /* DO INHIBIT                         */

   1510  1 000134                       MINIQER      null
      869     1515    1   MINIQER:;
PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:159  
      870     1516    2           IF RETRY_FLG='1'B THEN DO;

   1516  1 000134   000007 234000 0                  SZN     RETRY_FLG
         1 000135   000141 605000 1                  TPL     s:1522

      871     1517    2                 IF C_FLG='0'B THEN GOTO ENT_MINIQ;

   1517  1 000136   000010 234000 0                  SZN     C_FLG
         1 000137   000010 605000 1                  TPL     ENT_MINIQ

      872     1518    2                   ELSE GOTO ENT_MINIQC;

   1518  1 000140   000161 710000 1                  TRA     ENT_MINIQC

      873     1519    2               END;                        /* THEN                               */
      874     1520    1             ELSE;
      875     1521    2           DO INHIBIT;

      876     1522    2             TIMES_THRU = TIMES_THRU - 1;

   1522  1 000141   000001 336207                    LCQ   ! 1,DL
         1 000142   000013 056200 0                  ASQ   ! TIMES_THRU

      877     1523    2             IF TIMES_THRU = 0 THEN

   1523  1 000143   000147 601200 1                  TNZ   ! s:1525

      878     1524    2               CALL R_INT;

   1524  1 000144   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         1 000145   000000 701200 xent               TSX1  ! R_INT
         1 000146   000000 011200                    NOP   ! 0

      879     1525    2             ALTRETURN;

   1525  1 000147   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:160  
      880     1526    2           END;                            /* DO INHIBIT                         */

   1526  1 000150   000153 710000 1                  TRA     s:1531

      881     1527        /**/
      882     1528    1   MINIQC_PL6:ENTRY(INDX,BUF$,L,CODE,GRAN#) ALTRET;

   1528  1 000151   000000 700200 xent  MINIQC_PL6   TSX0  ! X66_AUTO_5
         1 000152   000016 000005                    ZERO    14,5

      883     1529        /* Here BUF$ is the address of an user DCW */
      884     1530    2           DO INHIBIT;

      885     1531    2             IF TIMES_THRU = 0 THEN

   1531  1 000153   000013 235200 0                  LDA   ! TIMES_THRU
         1 000154   000160 601200 1                  TNZ   ! s:1533

      886     1532    2               CALL S_INT;

   1532  1 000155   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         1 000156   000000 701200 xent               TSX1  ! S_INT
         1 000157   000000 011200                    NOP   ! 0

      887     1533    2             TIMES_THRU = TIMES_THRU + 1;

   1533  1 000160   000013 054200 0                  AOS   ! TIMES_THRU

      888     1534    2           END;                            /* DO INHIBIT                         */

      889     1535    1   ENT_MINIQC:
      890     1536        /* Build a TDCW to user's DCW */
      891     1537    1           IOTEMP.AD=BUF_PTR.WOFFS;

   1537  1 000161   200004 470500       ENT_MINIQC   LDP0    @BUF$,,AUTO
         1 000162   000000 220100                    LDX0    0,,PR0
         1 000163   000000 740000 0                  STX0    IOTEMP
PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:161  

      892     1538    1           IOTEMP.CP=0;

   1538  1 000164   000002 236000 2                  LDQ     2
         1 000165   000000 356000 0                  ANSQ    IOTEMP

      893     1539    1           IOTEMP.NU='0'B;

   1539  1 000166   000003 236000 2                  LDQ     3
         1 000167   000000 356000 0                  ANSQ    IOTEMP

      894     1540    1           IOTEMP.TYPE='10'B;              /* Make a TDCW                        */

   1540  1 000170   000000 236000 0                  LDQ     IOTEMP
         1 000171   000000 376000 2                  ANQ     0
         1 000172   020000 276007                    ORQ     8192,DL
         1 000173   000000 756000 0                  STQ     IOTEMP

      895     1541    1           IOTEMP.TALLY=0;

   1541  1 000174   000000 236003                    LDQ     0,DU
         1 000175   000000 752003 0                  STCQ    IOTEMP,'03'O

      896     1542    1           C_FLG='1'B;                     /* For possible retry                 */

   1542  1 000176   400000 236003                    LDQ     -131072,DU
         1 000177   000010 756000 0                  STQ     C_FLG

      897     1543    1           GOTO MINIQ1;

   1543  1 000200   000031 710000 1                  TRA     MINIQ1
      898     1544    1   END MINIQ_PL6;
      899     1545        %EOD;

PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:162  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure MINIQ_PL6.
PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:163  

 **** Variables and constants ****

  ****  Section 000  Data  MINIQ_PL6

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    10-0-0/b BIT         r     1 C_FLG                     12-0-0/w PTR         r     1 DOIO_COM$
     4-0-0/w BIT         r     1 IODCW(0:2)                11-0-0/w PTR         r     1 IODCW$
    11-0-0/w STRC        r     1 IODCW_PTR                  0-0-0/w STRC        r     1 IOTEMP
     1-0-0/w STRC(72)    r     1 MINI_ZONE                  7-0-0/b BIT         r     1 RETRY_FLG
     3-0-0/w STRC        r     1 TDCW_IODCW                13-0-0/w SBIN        r     1 TIMES_THRU

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @BUF$                      6-0-0/w PTR         r     1 @CODE
     7-0-0/w PTR         r     1 @GRAN#                     3-0-0/w PTR         r     1 @INDX
     5-0-0/w PTR         r     1 @L                        *0-0-0/w PTR         r     1 BUF$
    *0-0-0/w STRC        r     1 BUF_PTR                   10-0-0/w EPTR        r     1 CLLD
    *0-0-0/w UBIN        r     1 CODE                      *0-0-0/w UBIN        r     1 GRAN#
    *0-0-0/w UBIN        r     1 INDX                      *0-0-0/w UBIN        r     1 L

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(396)   r     1 DEVINFO(0:21)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:164  
     0-0-0/w BIT         r     1 CODETAB(0:19)


   Procedure MINIQ_PL6 requires 129 words for executable code.
   Procedure MINIQ_PL6 requires 14 words of local(AUTO) storage.
PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:165  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:166  
          MINI XREF LISTING

BUF$
      1288**DCL         6--PROC     1300--REDEF    1385--IMP-PTR  1528--ENTRY
BUF_PTR.BYTEPOS
      1302**DCL      1490>>ASSIGN
BUF_PTR.WOFFS
      1301**DCL      1489>>ASSIGN   1537>>ASSIGN
CLLD
      1314**DCL      1496<<ASSIGN   1498>>CALL     1506<<ASSIGN   1508>>CALL
CODE
      1308**DCL         6--PROC     1498<>CALL     1500>>ASSIGN   1508<>CALL     1528--ENTRY
CODETAB
      1477**DCL      1500--ASSIGN
C_FLG
      1457**DCL      1487<<ASSIGN   1517>>IF       1542<<ASSIGN
DEVINFO.CLEANROUT$
      1379**DCL      1506>>ASSIGN
DEVINFO.FUNCTAB$
      1381**DCL      1500>>ASSIGN
DEVINFO.HANDROUT$
      1377**DCL      1496>>ASSIGN
DEVINFO.PCWS
      1332**DCL      1343--REDEF
DEVINFO.RPM_PTRS.EF_DCWS$
      1345**DCL      1346--REDEF
DEVINFO.STATUS
      1349**DCL      1368--REDEF
DOIO
      1311**DCL-ENT  1504--CALL
DOIO_COM$
      1478**DCL      1504<>CALL
ENT_MINIQ
      1484**LABEL    1517--GOTO
PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:167  
ENT_MINIQC
      1537**LABEL    1518--GOTO
GRAN#
      1309**DCL         6--PROC     1498<>CALL     1508<>CALL     1528--ENTRY
INDX
      1287**DCL         6--PROC     1496>>ASSIGN   1498<>CALL     1500>>ASSIGN   1504<>CALL     1506>>ASSIGN
      1508<>CALL     1528--ENTRY
IODCW
      1455**DCL      1458--DCLINIT  1494<<ASSIGN
IODCW$
      1458**DCL      1470--REDEF
IODCW_PTR.WOFFS
      1471**DCL      1501>>ASSIGN
IOTEMP
      1396**DCL      1494>>ASSIGN
IOTEMP.AD
      1397**DCL      1489<<ASSIGN   1537<<ASSIGN
IOTEMP.CP
      1398**DCL      1490<<ASSIGN   1538<<ASSIGN
IOTEMP.NU
      1399**DCL      1539<<ASSIGN
IOTEMP.TALLY
      1401**DCL      1492<<ASSIGN   1541<<ASSIGN
IOTEMP.TYPE
      1400**DCL      1491<<ASSIGN   1540<<ASSIGN
L
      1307**DCL         6--PROC     1492>>ASSIGN   1528--ENTRY
MINIQ1
      1494**LABEL    1543--GOTO
MINIQER
      1510**LABEL    1498--CALLALT  1508--CALLALT
MINI_ZONE
      1415**DCL      1478--DCLINIT
MINI_ZONE.DCW
      1422**DCL      1426--REDEF    1429--REDEF    1430--REDEF    1503<<ASSIGN
MINI_ZONE.IDCW$
PL6.E3A0      #003=MINIQ_PL6 File=ISI$IOPROC.:E05TSI                             TUE 07/29/97 22:52 Page:168  
      1421**DCL      1500<<ASSIGN
MINI_ZONE.W1
      1416**DCL      1421--REDEF
RETRY_FLG
      1456**DCL      1497<<ASSIGN   1507<<ASSIGN   1516>>IF
R_INT
      1313**DCL-ENT  1512--CALL     1524--CALL
S_INT
      1312**DCL-ENT  1483--CALL     1532--CALL
TDCW_IODCW
      1447**DCL      1503>>ASSIGN
TDCW_IODCW.AD
      1448**DCL      1501<<ASSIGN
TDCW_IODCW.TYPE
      1451**DCL      1502<<ASSIGN
TIMES_THRU
      1479**DCL      1482>>IF       1484<<ASSIGN   1484>>ASSIGN   1510<<ASSIGN   1510>>ASSIGN   1511>>IF
      1522<<ASSIGN   1522>>ASSIGN   1523>>IF       1531>>IF       1533<<ASSIGN   1533>>ASSIGN

PL6.E3A0      #004=OCIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:169  
      900        1        /*T***********************************************************/
      901        2        /*T*                                                         */
      902        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      903        4        /*T*                                                         */
      904        5        /*T***********************************************************/
      905        6        OCIO:   PROC(INDX,CODE);
      906        7        %INCLUDE IS$MACROS;
      907     1282    1   DCL CODE UBIN WORD;
      908     1283    1   DCL INDX UBIN WORD;
      909     1284    1   DCL S1000_FLG BIT(1) SYMREF;
      910     1285    1   DCL PSI_FLG BIT(1) SYMREF;
      911     1286        /**/
      912     1287    1   DCL IODCW(0:2) BIT(36) SYMREF;
      913     1288        %DCW_STRUCT(NAME=IOTP_CR);
      914     1306    1   DCL CR_BUF BIT(36) STATIC ALIGNED INIT('015015015012'O);
      915     1307    1   DCL CR_BUF$ PTR STATIC INIT(ADDR(CR_BUF));
      916     1308        %PTR_STRUCT(NAME=CR_BUF_PTR,STCLASS="REDEF CR_BUF$");
      917     1326        %DCW_STRUCT(NAME=W_CELL,STCLASS="");
      918     1344        %PTR_STRUCT(NAME=CHECK_PTR);
      919     1362    1   DCL CHECK$ REDEF CHECK_PTR PTR;
      920     1363    1   DCL CCBUF CHAR(LGTH) BASED(CHECK$);
      921     1364    1   DCL UBUF(0:0) UBIN(9) BASED(CHECK$) UNAL;
      922     1365    1   DCL I UBIN WORD;
      923     1366    1   DCL LGTH UBIN WORD;
      924     1367    1           IF S1000_FLG='1'B THEN PSI_FLG='1'B;
              1367                    /* On IOP the console is a PSI device */
      925     1368    1             ELSE;
      926     1369    2           IF (CODE=%FCNWCA OR CODE=%FCNWCM) AND S1000_FLG THEN DO;
      927     1370                                      /* Check for unprintable characters on S1000    */
      928     1371    2                 W_CELL=IODCW(0);
      929     1372    2                 CHECK_PTR.WOFFS=W_CELL.AD;
      930     1373    2                 CHECK_PTR.BYTEPOS=W_CELL.CP;
      931     1374    2                 LGTH=W_CELL.TALLY*4;
      932     1375    3                 DO I=0 TO LGTH-1;
      933     1376    3                   IF NOT(UBUF(I)=10 OR UBUF(I)=13) THEN
      934     1377    3                     IF ( UBUF(I)>=126 OR UBUF(I)<32 ) THEN
      935     1378    3                       SUBSTR(CCBUF,I,1)=' ';
PL6.E3A0      #004=OCIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:170  
      936     1379    3                 END;                      /* DO I=                              */
      937     1380    2               END;                        /* THEN                               */
      938     1381    1           IOTP_CR.AD=CR_BUF_PTR.WOFFS;
      939     1382    1           IOTP_CR.TYPE='01'B;
      940     1383    1           IOTP_CR.TALLY=1;                /* IOTP with CR                       */
      941     1384    1           IF CODE~=1 THEN RETURN;
      942     1385    2             ELSE DO;
      943     1386    2                 IODCW(1)=IODCW(0);
      944     1387    2                 IODCW(0)=IOTP_CR;
      945     1388    2               END;                        /* ELSE                               */
      946     1389    1           RETURN;
      947     1390    1   END OCIO;
      948     1391        %EOD;

PL6.E3A0      #004=OCIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:171  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure OCIO.

   Procedure OCIO requires 89 words for executable code.
   Procedure OCIO requires 10 words of local(AUTO) storage.

PL6.E3A0      #004=OCIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:172  

 Object Unit name= OCIO                                       File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:52:36.00 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     4      4  OCIO
    1   Proc  even  none    89    131  OCIO
    2  RoData even  none     1      1  OCIO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        2  OCIO

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  IOTP_CR                            0      3  CHECK_PTR

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #004=OCIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:173  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     S1000_FLG                             PSI_FLG                               IODCW
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #004=OCIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:174  


      900        1        /*T***********************************************************/
      901        2        /*T*                                                         */
      902        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      903        4        /*T*                                                         */
      904        5        /*T***********************************************************/
      905        6        OCIO:   PROC(INDX,CODE);

      6  1 000000   000000 700200 xent  OCIO         TSX0  ! X66_AUTO_2
         1 000001   000012 000002                    ZERO    10,2

      906        7        %INCLUDE IS$MACROS;
      907     1282    1   DCL CODE UBIN WORD;
      908     1283    1   DCL INDX UBIN WORD;
      909     1284    1   DCL S1000_FLG BIT(1) SYMREF;
      910     1285    1   DCL PSI_FLG BIT(1) SYMREF;
      911     1286        /**/
      912     1287    1   DCL IODCW(0:2) BIT(36) SYMREF;
      913     1288        %DCW_STRUCT(NAME=IOTP_CR);
      914     1306    1   DCL CR_BUF BIT(36) STATIC ALIGNED INIT('015015015012'O);
      915     1307    1   DCL CR_BUF$ PTR STATIC INIT(ADDR(CR_BUF));
      916     1308        %PTR_STRUCT(NAME=CR_BUF_PTR,STCLASS="REDEF CR_BUF$");
      917     1326        %DCW_STRUCT(NAME=W_CELL,STCLASS="");
      918     1344        %PTR_STRUCT(NAME=CHECK_PTR);
      919     1362    1   DCL CHECK$ REDEF CHECK_PTR PTR;
      920     1363    1   DCL CCBUF CHAR(LGTH) BASED(CHECK$);
      921     1364    1   DCL UBUF(0:0) UBIN(9) BASED(CHECK$) UNAL;
      922     1365    1   DCL I UBIN WORD;
      923     1366    1   DCL LGTH UBIN WORD;
      924     1367    1           IF S1000_FLG='1'B THEN PSI_FLG='1'B;
              1367                    /* On IOP the console is a PSI device */

   1367  1 000002   000000 234000 xsym               SZN     S1000_FLG
         1 000003   000006 605000 1                  TPL     s:1369

   1367  1 000004   400000 236003                    LDQ     -131072,DU
         1 000005   000000 756000 xsym               STQ     PSI_FLG
PL6.E3A0      #004=OCIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:175  

      925     1368    1             ELSE;
      926     1369    2           IF (CODE=%FCNWCA OR CODE=%FCNWCM) AND S1000_FLG THEN DO;

   1369  1 000006   200004 470500                    LDP0    @CODE,,AUTO
         1 000007   000000 235100                    LDA     0,,PR0
         1 000010   000001 115007                    CMPA    1,DL
         1 000011   000014 600000 1                  TZE     s:1369+6
         1 000012   000002 115007                    CMPA    2,DL
         1 000013   000107 601000 1                  TNZ     s:1381
         1 000014   000000 234000 xsym               SZN     S1000_FLG
         1 000015   000107 605000 1                  TPL     s:1381

      927     1370                                      /* Check for unprintable characters on S1000    */
      928     1371    2                 W_CELL=IODCW(0);

   1371  1 000016   000000 236000 xsym               LDQ     IODCW
         1 000017   200005 756100                    STQ     W_CELL,,AUTO

      929     1372    2                 CHECK_PTR.WOFFS=W_CELL.AD;

   1372  1 000020   200005 220100                    LDX0    W_CELL,,AUTO
         1 000021   000003 740000 0                  STX0    CHECK_PTR

      930     1373    2                 CHECK_PTR.BYTEPOS=W_CELL.CP;

   1373  1 000022   000001 736000                    QLS     1
         1 000023   000003 676000 0                  ERQ     CHECK_PTR
         1 000024   600000 376007                    ANQ     -65536,DL
         1 000025   000003 656000 0                  ERSQ    CHECK_PTR

      931     1374    2                 LGTH=W_CELL.TALLY*4;

   1374  1 000026   200005 236100                    LDQ     W_CELL,,AUTO
         1 000027   000002 736000                    QLS     2
         1 000030   037774 376007                    ANQ     16380,DL
         1 000031   200007 756100                    STQ     LGTH,,AUTO
PL6.E3A0      #004=OCIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:176  

      932     1375    3                 DO I=0 TO LGTH-1;

   1375  1 000032   200006 450100                    STZ     I,,AUTO
         1 000033   000104 710000 1                  TRA     s:1379+3

      933     1376    3                   IF NOT(UBUF(I)=10 OR UBUF(I)=13) THEN

   1376  1 000034   200006 236100                    LDQ     I,,AUTO
         1 000035   000011 402007                    MPY     9,DL
         1 000036   000003 470400 0                  LDP0    CHECK_PTR
         1 000037   003100 061506                    CSR     bolr='003'O
         1 000040   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         1 000041   200010 000044                    BDSC    LGTH+1,,AUTO             by=0,bit=0,n=36
         1 000042   200010 236100                    LDQ     LGTH+1,,AUTO
         1 000043   000012 116007                    CMPQ    10,DL
         1 000044   000101 600000 1                  TZE     s:1379
         1 000045   200006 236100                    LDQ     I,,AUTO
         1 000046   000011 402007                    MPY     9,DL
         1 000047   003100 061506                    CSR     bolr='003'O
         1 000050   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         1 000051   200011 000044                    BDSC    LGTH+2,,AUTO             by=0,bit=0,n=36
         1 000052   200011 236100                    LDQ     LGTH+2,,AUTO
         1 000053   000015 116007                    CMPQ    13,DL
         1 000054   000101 600000 1                  TZE     s:1379

      934     1377    3                     IF ( UBUF(I)>=126 OR UBUF(I)<32 ) THEN

   1377  1 000055   200006 236100                    LDQ     I,,AUTO
         1 000056   000011 402007                    MPY     9,DL
         1 000057   003100 061506                    CSR     bolr='003'O
         1 000060   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         1 000061   200010 000044                    BDSC    LGTH+1,,AUTO             by=0,bit=0,n=36
         1 000062   200010 236100                    LDQ     LGTH+1,,AUTO
         1 000063   000176 116007                    CMPQ    126,DL
         1 000064   000075 605000 1                  TPL     s:1378
         1 000065   200006 236100                    LDQ     I,,AUTO
PL6.E3A0      #004=OCIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:177  
         1 000066   000011 402007                    MPY     9,DL
         1 000067   003100 061506                    CSR     bolr='003'O
         1 000070   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         1 000071   200011 000044                    BDSC    LGTH+2,,AUTO             by=0,bit=0,n=36
         1 000072   200011 236100                    LDQ     LGTH+2,,AUTO
         1 000073   000040 116007                    CMPQ    32,DL
         1 000074   000101 605000 1                  TPL     s:1379

      935     1378    3                       SUBSTR(CCBUF,I,1)=' ';

   1378  1 000075   200006 235100                    LDA     I,,AUTO
         1 000076   040105 100400                    MLR     fill='040'O
         1 000077   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000100   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1

      936     1379    3                 END;                      /* DO I=                              */

   1379  1 000101   200006 235100                    LDA     I,,AUTO
         1 000102   000001 035007                    ADLA    1,DL
         1 000103   200006 755100                    STA     I,,AUTO
         1 000104   200006 236100                    LDQ     I,,AUTO
         1 000105   200007 116100                    CMPQ    LGTH,,AUTO
         1 000106   000034 602000 1                  TNC     s:1376

      937     1380    2               END;                        /* THEN                               */

      938     1381    1           IOTP_CR.AD=CR_BUF_PTR.WOFFS;

   1381  1 000107   000002 220000 0                  LDX0    CR_BUF$
         1 000110   000000 740000 0                  STX0    IOTP_CR

      939     1382    1           IOTP_CR.TYPE='01'B;

   1382  1 000111   000000 236000 0                  LDQ     IOTP_CR
         1 000112   000000 376000 2                  ANQ     0
         1 000113   010000 276007                    ORQ     4096,DL
         1 000114   000000 756000 0                  STQ     IOTP_CR
PL6.E3A0      #004=OCIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:178  

      940     1383    1           IOTP_CR.TALLY=1;                /* IOTP with CR                       */

   1383  1 000115   000001 236007                    LDQ     1,DL
         1 000116   000000 752003 0                  STCQ    IOTP_CR,'03'O

      941     1384    1           IF CODE~=1 THEN RETURN;

   1384  1 000117   200004 470500                    LDP0    @CODE,,AUTO
         1 000120   000000 235100                    LDA     0,,PR0
         1 000121   000001 115007                    CMPA    1,DL
         1 000122   000124 600000 1                  TZE     s:1386

   1384  1 000123   000000 702200 xent               TSX2  ! X66_ARET

      942     1385    2             ELSE DO;

      943     1386    2                 IODCW(1)=IODCW(0);

   1386  1 000124   000000 236000 xsym               LDQ     IODCW
         1 000125   000001 756000 xsym               STQ     IODCW+1

      944     1387    2                 IODCW(0)=IOTP_CR;

   1387  1 000126   000000 236000 0                  LDQ     IOTP_CR
         1 000127   000000 756000 xsym               STQ     IODCW

      945     1388    2               END;                        /* ELSE                               */

      946     1389    1           RETURN;

   1389  1 000130   000000 702200 xent               TSX2  ! X66_ARET
      947     1390    1   END OCIO;
      948     1391        %EOD;

PL6.E3A0      #004=OCIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:179  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure OCIO.
PL6.E3A0      #004=OCIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:180  

 **** Variables and constants ****

  ****  Section 000  Data  OCIO

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 CHECK$                     3-0-0/w STRC        r     1 CHECK_PTR
     1-0-0/w BIT         r     1 CR_BUF                     2-0-0/w PTR         r     1 CR_BUF$
     2-0-0/w STRC        r     1 CR_BUF_PTR                 0-0-0/w STRC        r     1 IOTP_CR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @CODE                      3-0-0/w PTR         r     1 @INDX
    *0-0-0/w UBIN        r     1 CODE                       6-0-0/w UBIN        r     1 I
    *0-0-0/w UBIN        r     1 INDX                       7-0-0/w UBIN        r     1 LGTH
     5-0-0/w STRC        r     1 W_CELL

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 IODCW(0:2)                 0-0-0/b BIT         r     1 PSI_FLG
     0-0-0/b BIT         r     1 S1000_FLG

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR        r     1 CCBUF                      0-0-0/b UBIN(9)     r     1 UBUF(0:0)

PL6.E3A0      #004=OCIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:181  

   Procedure OCIO requires 89 words for executable code.
   Procedure OCIO requires 10 words of local(AUTO) storage.
PL6.E3A0      #004=OCIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:182  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=OCIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:183  
          MINI XREF LISTING

CCBUF
      1363**DCL      1378<<ASSIGN
CHECK$
      1362**DCL      1363--IMP-PTR  1364--IMP-PTR  1376>>IF       1376>>IF       1377>>IF       1377>>IF
      1378>>ASSIGN
CHECK_PTR
      1355**DCL      1362--REDEF
CHECK_PTR.BYTEPOS
      1357**DCL      1373<<ASSIGN
CHECK_PTR.WOFFS
      1356**DCL      1372<<ASSIGN
CODE
      1282**DCL         6--PROC     1369>>IF       1369>>IF       1384>>IF
CR_BUF
      1306**DCL      1307--DCLINIT
CR_BUF$
      1307**DCL      1319--REDEF
CR_BUF_PTR.WOFFS
      1320**DCL      1381>>ASSIGN
I
      1365**DCL      1375<<DOINDEX  1376>>IF       1376>>IF       1377>>IF       1377>>IF       1378>>ASSIGN
INDX
      1283**DCL         6--PROC
IODCW
      1287**DCL      1371>>ASSIGN   1386<<ASSIGN   1386>>ASSIGN   1387<<ASSIGN
IOTP_CR
      1298**DCL      1387>>ASSIGN
IOTP_CR.AD
      1299**DCL      1381<<ASSIGN
IOTP_CR.TALLY
      1303**DCL      1383<<ASSIGN
IOTP_CR.TYPE
PL6.E3A0      #004=OCIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:184  
      1302**DCL      1382<<ASSIGN
LGTH
      1366**DCL      1363--IMP-SIZ  1374<<ASSIGN   1375>>DOINDEX  1378>>ASSIGN
PSI_FLG
      1285**DCL      1367<<ASSIGN
S1000_FLG
      1284**DCL      1367>>IF       1369>>IF
UBUF
      1364**DCL      1376>>IF       1376>>IF       1377>>IF       1377>>IF
W_CELL
      1336**DCL      1371<<ASSIGN
W_CELL.AD
      1337**DCL      1372>>ASSIGN
W_CELL.CP
      1338**DCL      1373>>ASSIGN
W_CELL.TALLY
      1341**DCL      1374>>ASSIGN

PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:185  
      949        1        /*T***********************************************************/
      950        2        /*T*                                                         */
      951        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      952        4        /*T*                                                         */
      953        5        /*T***********************************************************/
      954        6        OCCU:   PROC(INDX,CODE) ALTRET;
      955        7        %INCLUDE IS$MACROS;
      956     1282    1   DCL INDX UBIN WORD;
      957     1283    1   DCL CODE UBIN WORD;
      958     1284        /**/
      959     1285    1   DCL BUILD_MESSAGE ENTRY(1);
      960     1286    1   DCL MINIQ_PL6 ENTRY(5) ALTRET;
      961     1287    1   DCL DOIO ENTRY(4);
      962     1288    1   DCL DOIOX ENTRY(4);
      963     1289        /**/
      964     1290        %DEVINFO(STCLASS="SYMREF");
      965     1359        %DOIO_COMZONE(NAME=OCCU_ZONE);
      966     1392    1   DCL DOIO_COM$ PTR STATIC INIT(ADDR(OCCU_ZONE));
      967     1393    1   DCL BUF CHAR(1024) BASED(RES_BUF$);
      968     1394        %PTR_STRUCT(NAME=RES_BUF_PTR);
      969     1412    1   DCL RES_BUF$ REDEF RES_BUF_PTR PTR;
      970     1413    1   DCL RETRY_FLG BIT(1) SYMREF;
      971     1414    1   DCL TYPEBI BIT(36) SYMREF;
      972     1415    1   DCL OCCUM CHAR(1) SYMREF;
      973     1416    1   DCL MESSAGE CHAR(80) SYMREF;
      974     1417    1   DCL MESSAGE_CNT UBIN SYMREF;
      975     1418    1   DCL S1000_FLG BIT(1) SYMREF;
      976     1419    1   DCL CRNOLF BIT(36) ALIGNED STATIC INIT('015040040040'O);
      977     1420        /**/
      978     1421    1           IF CODE=%FCNWCA OR CODE=%FCNWCM THEN GOTO OCCUW; /* Write codes       */
      979     1422    1             ELSE;
      980     1423    1           IF (DEVINFO.BSTAT.W1.H1(INDX)&'777707'O)~='400000'O OR
      981     1424    1             DEVINFO.STATUS.IOM_CHAN_STAT(INDX)~='0'B OR
      982     1425    1             DEVINFO.STATUS.IOM_CENT_STAT(INDX)~='0'B
      983     1426    1             THEN GOTO OCCU7;              /* Not ready status                   */
      984     1427    1             ELSE;                         /* Ready                              */
      985     1428        /* Fill buffer with blanks */
PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:186  
      986     1429    1   OCCU6:  ;
      987     1430    1           RES_BUF_PTR.WOFFS=DEVINFO.STATUS.NEXT_ADDR(INDX)-1;
      988     1431    1           RES_BUF_PTR.BYTEPOS=DEVINFO.STATUS.CHAR_POS(INDX);
      989     1432    2           IF DEVINFO.STATUS.CHAR_POS(INDX)=0 THEN DO;
      990     1433    2                 RES_BUF_PTR.WOFFS=RES_BUF_PTR.WOFFS+1;
      991     1434    2                 SUBSTR(BUF,0,DEVINFO.STATUS.TALLY_RESID(INDX)*4)=' ';
      992     1435    2               END;                        /* THEN                               */
      993     1436    1             ELSE
      994     1437    1             SUBSTR(BUF,0,(DEVINFO.STATUS.TALLY_RESID(INDX)*4+4-DEVINFO.STATUS.CHAR_POS
              1437                      (INDX)))=' ';
      995     1438    1           RETURN;
      996     1439        /**/
      997     1440    1   OCCU7:  ;
      998     1441    1           IF DEVINFO.STATUS.MAJ_STAT(INDX)~='0011'B THEN GOTO WRIT_ALERT;
      999     1442    1             ELSE;
     1000     1443    1           IF DEVINFO.STATUS.SUB_STAT(INDX)='04'O THEN GOTO RETRY0;
              1443                    /* Operator input alert */
     1001     1444    1             ELSE;
     1002     1445    1           IF DEVINFO.STATUS.SUB_STAT(INDX)='40'O THEN GOTO OCCU6; /* Length error */
     1003     1446    1             ELSE;
     1004     1447    1           IF DEVINFO.STATUS.SUB_STAT(INDX)='10'O THEN GOTO OCCUB;
              1447                    /* Operator distracted */
     1005     1448        /* Call DOIO */
     1006     1449    1   WRIT_ALERT:;
     1007     1450    1           OCCU_ZONE.IDCW$=ADDR(TYPEBI);
     1008     1451    1           OCCU_ZONE.DCW='0'B;
     1009     1452    1           IF S1000_FLG='0'B THEN CALL DOIO(INDX,DOIO_COM$);
     1010     1453    1             ELSE CALL DOIOX(INDX,DOIO_COM$);
     1011     1454    1           IF DEVINFO.STATUS.TBIT(INDX)='0'B&DEVINFO.STATUS.MAJ_STAT(INDX)='0011'B THEN
              1454                    GOTO OCCUA; /* Data alert */
     1012     1455    1             ELSE GOTO RETRY;
     1013     1456    1   OCCUB:  ;
     1014     1457    1           IF CODE=%FCNRCR THEN ALTRETURN; /* Time out                           */
     1015     1458    1             ELSE GOTO RETRY;
     1016     1459    1   OCCUA:  ;
     1017     1460    1           CALL BUILD_MESSAGE(OCCUM);
     1018     1461    1           CALL MINIQ_PL6(INDX,ADDR(MESSAGE),MESSAGE_CNT,%FCNWCA);
PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:187  
     1019     1462    1           GOTO RETRY;
     1020     1463    1   RETRY0: ;
     1021     1464    1           CALL MINIQ_PL6(INDX,ADDR(CRNOLF),4,%FCNWCA);
     1022     1465    1   RETRY:  ;
     1023     1466    1           RETRY_FLG='1'B;
     1024     1467    1           ALTRETURN;
     1025     1468    1   OCCUW:  ;
     1026     1469    1           IF (DEVINFO.BSTAT.W1.H1(INDX)&'777707'O)='400000'O THEN RETURN;
     1027     1470    1             ELSE GOTO RETRY;
     1028     1471    1   END OCCU;
     1029     1472        %EOD;

PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:188  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure OCCU.

   Procedure OCCU requires 202 words for executable code.
   Procedure OCCU requires 12 words of local(AUTO) storage.

PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:189  

 Object Unit name= OCCU                                       File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:52:39.64 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     5      5  OCCU
    1   Proc  even  none   202    312  OCCU
    2  RoData even  none    10     12  OCCU

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  OCCU

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  OCCU_ZONE                          0      3  RES_BUF_PTR

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       4 DOIO
         yes           Std       1 BUILD_MESSAGE
         yes           Std       4 DOIOX
 yes     yes           Std       5 MINIQ_PL6
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:190  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DEVINFO                               RETRY_FLG                             TYPEBI
     OCCUM                                 MESSAGE                               MESSAGE_CNT
     S1000_FLG                             B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:191  


      949        1        /*T***********************************************************/
      950        2        /*T*                                                         */
      951        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      952        4        /*T*                                                         */
      953        5        /*T***********************************************************/
      954        6        OCCU:   PROC(INDX,CODE) ALTRET;

      6  1 000000   000000 700200 xent  OCCU         TSX0  ! X66_AUTO_2
         1 000001   000014 000002                    ZERO    12,2

      955        7        %INCLUDE IS$MACROS;
      956     1282    1   DCL INDX UBIN WORD;
      957     1283    1   DCL CODE UBIN WORD;
      958     1284        /**/
      959     1285    1   DCL BUILD_MESSAGE ENTRY(1);
      960     1286    1   DCL MINIQ_PL6 ENTRY(5) ALTRET;
      961     1287    1   DCL DOIO ENTRY(4);
      962     1288    1   DCL DOIOX ENTRY(4);
      963     1289        /**/
      964     1290        %DEVINFO(STCLASS="SYMREF");
      965     1359        %DOIO_COMZONE(NAME=OCCU_ZONE);
      966     1392    1   DCL DOIO_COM$ PTR STATIC INIT(ADDR(OCCU_ZONE));
      967     1393    1   DCL BUF CHAR(1024) BASED(RES_BUF$);
      968     1394        %PTR_STRUCT(NAME=RES_BUF_PTR);
      969     1412    1   DCL RES_BUF$ REDEF RES_BUF_PTR PTR;
      970     1413    1   DCL RETRY_FLG BIT(1) SYMREF;
      971     1414    1   DCL TYPEBI BIT(36) SYMREF;
      972     1415    1   DCL OCCUM CHAR(1) SYMREF;
      973     1416    1   DCL MESSAGE CHAR(80) SYMREF;
      974     1417    1   DCL MESSAGE_CNT UBIN SYMREF;
      975     1418    1   DCL S1000_FLG BIT(1) SYMREF;
      976     1419    1   DCL CRNOLF BIT(36) ALIGNED STATIC INIT('015040040040'O);
      977     1420        /**/
      978     1421    1           IF CODE=%FCNWCA OR CODE=%FCNWCM THEN GOTO OCCUW; /* Write codes       */

   1421  1 000002   200004 470500                    LDP0    @CODE,,AUTO
PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:192  
         1 000003   000000 235100                    LDA     0,,PR0
         1 000004   000001 115007                    CMPA    1,DL
         1 000005   000301 600000 1                  TZE     OCCUW
         1 000006   000002 115007                    CMPA    2,DL
         1 000007   000301 600000 1                  TZE     OCCUW

      979     1422    1             ELSE;
      980     1423    1           IF (DEVINFO.BSTAT.W1.H1(INDX)&'777707'O)~='400000'O OR

   1423  1 000010   200003 471500                    LDP1    @INDX,,AUTO
         1 000011   100000 236100                    LDQ     0,,PR1
         1 000012   000006 402007                    MPY     6,DL
         1 000013   000001 736000                    QLS     1
         1 000014   000004 220006 xsym               LDX0    DEVINFO+4,QL
         1 000015   777707 360003                    ANX0    -57,DU
         1 000016   400000 100003                    CMPX0   -131072,DU
         1 000017   000126 601000 1                  TNZ     OCCU7
         1 000020   100000 236100                    LDQ     0,,PR1
         1 000021   000006 402007                    MPY     6,DL
         1 000022   000001 736000                    QLS     1
         1 000023   000004 236006 xsym               LDQ     DEVINFO+4,QL
         1 000024   700000 316007                    CANQ    -32768,DL
         1 000025   000126 601000 1                  TNZ     OCCU7
         1 000026   100000 236100                    LDQ     0,,PR1
         1 000027   000006 402007                    MPY     6,DL
         1 000030   000001 736000                    QLS     1
         1 000031   000004 236006 xsym               LDQ     DEVINFO+4,QL
         1 000032   070000 316007                    CANQ    28672,DL
         1 000033   000126 601000 1                  TNZ     OCCU7

   1423  1 000034                       OCCU6        null
      981     1424    1             DEVINFO.STATUS.IOM_CHAN_STAT(INDX)~='0'B OR
      982     1425    1             DEVINFO.STATUS.IOM_CENT_STAT(INDX)~='0'B
      983     1426    1             THEN GOTO OCCU7;              /* Not ready status                   */
      984     1427    1             ELSE;                         /* Ready                              */
      985     1428        /* Fill buffer with blanks */
      986     1429    1   OCCU6:  ;
PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:193  
      987     1430    1           RES_BUF_PTR.WOFFS=DEVINFO.STATUS.NEXT_ADDR(INDX)-1;

   1430  1 000034   200003 470500                    LDP0    @INDX,,AUTO
         1 000035   000000 236100                    LDQ     0,,PR0
         1 000036   000006 402007                    MPY     6,DL
         1 000037   000001 736000                    QLS     1
         1 000040   000005 220006 xsym               LDX0    DEVINFO+5,QL
         1 000041   777777 621010                    EAX1    -1,X0
         1 000042   000003 741000 0                  STX1    RES_BUF_PTR

      988     1431    1           RES_BUF_PTR.BYTEPOS=DEVINFO.STATUS.CHAR_POS(INDX);

   1431  1 000043   000000 236100                    LDQ     0,,PR0
         1 000044   000006 402007                    MPY     6,DL
         1 000045   000001 736000                    QLS     1
         1 000046   000005 236006 xsym               LDQ     DEVINFO+5,QL
         1 000047   000001 736000                    QLS     1
         1 000050   000003 676000 0                  ERQ     RES_BUF_PTR
         1 000051   600000 376007                    ANQ     -65536,DL
         1 000052   000003 656000 0                  ERSQ    RES_BUF_PTR

      989     1432    2           IF DEVINFO.STATUS.CHAR_POS(INDX)=0 THEN DO;

   1432  1 000053   000000 236100                    LDQ     0,,PR0
         1 000054   000006 402007                    MPY     6,DL
         1 000055   000001 736000                    QLS     1
         1 000056   000005 236006 xsym               LDQ     DEVINFO+5,QL
         1 000057   700000 316007                    CANQ    -32768,DL
         1 000060   000077 601000 1                  TNZ     s:1437

      990     1433    2                 RES_BUF_PTR.WOFFS=RES_BUF_PTR.WOFFS+1;

   1433  1 000061   000001 620011                    EAX0    1,X1
         1 000062   000003 740000 0                  STX0    RES_BUF_PTR

      991     1434    2                 SUBSTR(BUF,0,DEVINFO.STATUS.TALLY_RESID(INDX)*4)=' ';

PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:194  
   1434  1 000063   000000 236100                    LDQ     0,,PR0
         1 000064   000006 402007                    MPY     6,DL
         1 000065   000001 736000                    QLS     1
         1 000066   000005 236006 xsym               LDQ     DEVINFO+5,QL
         1 000067   000002 736000                    QLS     2
         1 000070   037774 376007                    ANQ     16380,DL
         1 000071   000003 471400 0                  LDP1    RES_BUF_PTR
         1 000072   000000 621006                    EAX1    0,QL
         1 000073   040140 100400                    MLR     fill='040'O
         1 000074   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000075   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

      992     1435    2               END;                        /* THEN                               */

   1435  1 000076   000125 710000 1                  TRA     s:1438

      993     1436    1             ELSE
      994     1437    1            SUBSTR(BUF,0,(DEVINFO.STATUS.TALLY_RESID(INDX)*4+4-DEVINFO.STATUS.CHAR_POS
              1437                      (INDX)))=' ';

   1437  1 000077   000000 236100                    LDQ     0,,PR0
         1 000100   000006 402007                    MPY     6,DL
         1 000101   000000 620006                    EAX0    0,QL
         1 000102   000001 736000                    QLS     1
         1 000103   000005 236006 xsym               LDQ     DEVINFO+5,QL
         1 000104   000017 772000                    QRL     15
         1 000105   000007 376007                    ANQ     7,DL
         1 000106   200006 756100                    STQ     @CODE+2,,AUTO
         1 000107   000000 635010                    EAA     0,X0
         1 000110   000021 771000                    ARL     17
         1 000111   000005 236005 xsym               LDQ     DEVINFO+5,AL
         1 000112   000002 736000                    QLS     2
         1 000113   037774 376007                    ANQ     16380,DL
         1 000114   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 000115   000001 036007                    ADLQ    1,DL
         1 000116   200006 036100                    ADLQ    @CODE+2,,AUTO
         1 000117   777773 620006                    EAX0    -5,QL
PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:195  
         1 000120   777777 660003                    ERX0    -1,DU
         1 000121   000003 471400 0                  LDP1    RES_BUF_PTR
         1 000122   040140 100400                    MLR     fill='040'O
         1 000123   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000124   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

      995     1438    1           RETURN;

   1438  1 000125   000000 702200 xent               TSX2  ! X66_ARET

   1437  1 000126                       OCCU7        null
      996     1439        /**/
      997     1440    1   OCCU7:  ;
      998     1441    1           IF DEVINFO.STATUS.MAJ_STAT(INDX)~='0011'B THEN GOTO WRIT_ALERT;

   1441  1 000126   100000 236100                    LDQ     0,,PR1
         1 000127   000006 402007                    MPY     6,DL
         1 000130   000001 736000                    QLS     1
         1 000131   000004 236006 xsym               LDQ     DEVINFO+4,QL
         1 000132   170000 376003                    ANQ     61440,DU
         1 000133   030000 116003                    CMPQ    12288,DU
         1 000134   000162 601000 1                  TNZ     WRIT_ALERT

      999     1442    1             ELSE;
     1000     1443    1           IF DEVINFO.STATUS.SUB_STAT(INDX)='04'O THEN GOTO RETRY0;
              1443                    /* Operator input alert */

   1443  1 000135   100000 236100                    LDQ     0,,PR1
         1 000136   000006 402007                    MPY     6,DL
         1 000137   000001 736000                    QLS     1
         1 000140   000004 236006 xsym               LDQ     DEVINFO+4,QL
         1 000141   007700 376003                    ANQ     4032,DU
         1 000142   000400 116003                    CMPQ    256,DU
         1 000143   000262 600000 1                  TZE     RETRY0

     1001     1444    1             ELSE;
     1002     1445    1           IF DEVINFO.STATUS.SUB_STAT(INDX)='40'O THEN GOTO OCCU6; /* Length error */
PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:196  

   1445  1 000144   100000 236100                    LDQ     0,,PR1
         1 000145   000006 402007                    MPY     6,DL
         1 000146   000001 736000                    QLS     1
         1 000147   000004 236006 xsym               LDQ     DEVINFO+4,QL
         1 000150   007700 376003                    ANQ     4032,DU
         1 000151   004000 116003                    CMPQ    2048,DU
         1 000152   000034 600000 1                  TZE     OCCU6

     1003     1446    1             ELSE;
     1004     1447    1           IF DEVINFO.STATUS.SUB_STAT(INDX)='10'O THEN GOTO OCCUB;
              1447                    /* Operator distracted */

   1447  1 000153   100000 236100                    LDQ     0,,PR1
         1 000154   000006 402007                    MPY     6,DL
         1 000155   000001 736000                    QLS     1
         1 000156   000004 236006 xsym               LDQ     DEVINFO+4,QL
         1 000157   007700 376003                    ANQ     4032,DU
         1 000160   001000 116003                    CMPQ    512,DU
         1 000161   000235 600000 1                  TZE     OCCUB

   1447  1 000162                       WRIT_ALERT   null
     1005     1448        /* Call DOIO */
     1006     1449    1   WRIT_ALERT:;
     1007     1450    1           OCCU_ZONE.IDCW$=ADDR(TYPEBI);

   1450  1 000162   000000 236000 2                  LDQ     0
         1 000163   000000 756000 0                  STQ     OCCU_ZONE

     1008     1451    1           OCCU_ZONE.DCW='0'B;

   1451  1 000164   000001 450000 0                  STZ     OCCU_ZONE+1

     1009     1452    1           IF S1000_FLG='0'B THEN CALL DOIO(INDX,DOIO_COM$);

   1452  1 000165   000000 234000 xsym               SZN     S1000_FLG
         1 000166   000177 604000 1                  TMI     s:1453
PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:197  

   1452  1 000167   000001 236000 2                  LDQ     1
         1 000170   200003 235100                    LDA     @INDX,,AUTO
         1 000171   200006 757100                    STAQ    @CODE+2,,AUTO
         1 000172   200006 630500                    EPPR0   @CODE+2,,AUTO
         1 000173   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000174   000000 701000 xent               TSX1    DOIO
         1 000175   000000 011000                    NOP     0
         1 000176   000206 710000 1                  TRA     s:1454

     1010     1453    1             ELSE CALL DOIOX(INDX,DOIO_COM$);

   1453  1 000177   000001 236000 2                  LDQ     1
         1 000200   200003 235100                    LDA     @INDX,,AUTO
         1 000201   200006 757100                    STAQ    @CODE+2,,AUTO
         1 000202   200006 630500                    EPPR0   @CODE+2,,AUTO
         1 000203   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000204   000000 701000 xent               TSX1    DOIOX
         1 000205   000000 011000                    NOP     0

     1011     1454    1          IF DEVINFO.STATUS.TBIT(INDX)='0'B&DEVINFO.STATUS.MAJ_STAT(INDX)='0011'B THEN
              1454                    GOTO OCCUA; /* Data alert */

   1454  1 000206   200003 470500                    LDP0    @INDX,,AUTO
         1 000207   000000 236100                    LDQ     0,,PR0
         1 000210   000006 402007                    MPY     6,DL
         1 000211   400000 220003                    LDX0    -131072,DU
         1 000212   000001 736000                    QLS     1
         1 000213   000004 234006 xsym               SZN     DEVINFO+4,QL
         1 000214   000216 605000 1                  TPL     s:1454+8
         1 000215   000000 220003                    LDX0    0,DU
         1 000216   000000 236100                    LDQ     0,,PR0
         1 000217   000006 402007                    MPY     6,DL
         1 000220   400000 221003                    LDX1    -131072,DU
         1 000221   000001 736000                    QLS     1
         1 000222   000004 236006 xsym               LDQ     DEVINFO+4,QL
         1 000223   170000 376003                    ANQ     61440,DU
PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:198  
         1 000224   030000 116003                    CMPQ    12288,DU
         1 000225   000227 600000 1                  TZE     s:1454+17
         1 000226   000000 221003                    LDX1    0,DU
         1 000227   000000 636011                    EAQ     0,X1
         1 000230   200006 756100                    STQ     @CODE+2,,AUTO
         1 000231   000000 636010                    EAQ     0,X0
         1 000232   200006 376100                    ANQ     @CODE+2,,AUTO
         1 000233   000241 601000 1                  TNZ     OCCUA

     1012     1455    1             ELSE GOTO RETRY;

   1455  1 000234   000276 710000 1                  TRA     RETRY

   1454  1 000235                       OCCUB        null
     1013     1456    1   OCCUB:  ;
     1014     1457    1           IF CODE=%FCNRCR THEN ALTRETURN; /* Time out                           */

   1457  1 000235   000000 235100                    LDA     0,,PR0
         1 000236   000003 115007                    CMPA    3,DL
         1 000237   000276 601000 1                  TNZ     RETRY

   1457  1 000240   000000 702200 xent               TSX2  ! X66_AALT

   1457  1 000241                       OCCUA        null
     1015     1458    1             ELSE GOTO RETRY;
     1016     1459    1   OCCUA:  ;
     1017     1460    1           CALL BUILD_MESSAGE(OCCUM);

   1460  1 000241   000002 630400 2                  EPPR0   2
         1 000242   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000243   000000 701000 xent               TSX1    BUILD_MESSAGE
         1 000244   000000 011000                    NOP     0

     1018     1461    1           CALL MINIQ_PL6(INDX,ADDR(MESSAGE),MESSAGE_CNT,%FCNWCA);

   1461  1 000245   000003 236000 2                  LDQ     3
         1 000246   200006 756100                    STQ     @CODE+2,,AUTO
PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:199  
         1 000247   000004 237000 2                  LDAQ    4
         1 000250   200012 757100                    STAQ    @CODE+6,,AUTO
         1 000251   200006 630500                    EPPR0   @CODE+2,,AUTO
         1 000252   200011 450500                    STP0    @CODE+5,,AUTO
         1 000253   200003 236100                    LDQ     @INDX,,AUTO
         1 000254   200010 756100                    STQ     @CODE+4,,AUTO
         1 000255   200010 630500                    EPPR0   @CODE+4,,AUTO
         1 000256   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000257   000000 701000 xent               TSX1    MINIQ_PL6
         1 000260   000000 011000                    NOP     0

     1019     1462    1           GOTO RETRY;

   1462  1 000261   000276 710000 1                  TRA     RETRY

   1457  1 000262                       RETRY0       null
     1020     1463    1   RETRY0: ;
     1021     1464    1           CALL MINIQ_PL6(INDX,ADDR(CRNOLF),4,%FCNWCA);

   1464  1 000262   000006 236000 2                  LDQ     6
         1 000263   200006 756100                    STQ     @CODE+2,,AUTO
         1 000264   000010 237000 2                  LDAQ    8
         1 000265   200012 757100                    STAQ    @CODE+6,,AUTO
         1 000266   200006 633500                    EPPR3   @CODE+2,,AUTO
         1 000267   200011 453500                    STP3    @CODE+5,,AUTO
         1 000270   200003 236100                    LDQ     @INDX,,AUTO
         1 000271   200010 756100                    STQ     @CODE+4,,AUTO
         1 000272   200010 630500                    EPPR0   @CODE+4,,AUTO
         1 000273   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000274   000000 701000 xent               TSX1    MINIQ_PL6
         1 000275   000000 011000                    NOP     0

   1464  1 000276                       RETRY        null
     1022     1465    1   RETRY:  ;
     1023     1466    1           RETRY_FLG='1'B;

   1466  1 000276   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:200  
         1 000277   000000 756000 xsym               STQ     RETRY_FLG

     1024     1467    1           ALTRETURN;

   1467  1 000300   000000 702200 xent               TSX2  ! X66_AALT

   1466  1 000301                       OCCUW        null
     1025     1468    1   OCCUW:  ;
     1026     1469    1           IF (DEVINFO.BSTAT.W1.H1(INDX)&'777707'O)='400000'O THEN RETURN;

   1469  1 000301   200003 471500                    LDP1    @INDX,,AUTO
         1 000302   100000 236100                    LDQ     0,,PR1
         1 000303   000006 402007                    MPY     6,DL
         1 000304   000001 736000                    QLS     1
         1 000305   000004 220006 xsym               LDX0    DEVINFO+4,QL
         1 000306   777707 360003                    ANX0    -57,DU
         1 000307   400000 100003                    CMPX0   -131072,DU
         1 000310   000276 601000 1                  TNZ     RETRY

   1469  1 000311   000000 702200 xent               TSX2  ! X66_ARET
     1027     1470    1             ELSE GOTO RETRY;
     1028     1471    1   END OCCU;
     1029     1472        %EOD;

PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:201  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure OCCU.
PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:202  

 **** Variables and constants ****

  ****  Section 000  Data  OCCU

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w BIT         r     1 CRNOLF                     2-0-0/w PTR         r     1 DOIO_COM$
     0-0-0/w STRC(72)    r     1 OCCU_ZONE                  3-0-0/w PTR         r     1 RES_BUF$
     3-0-0/w STRC        r     1 RES_BUF_PTR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @CODE                      3-0-0/w PTR         r     1 @INDX
    *0-0-0/w UBIN        r     1 CODE                      *0-0-0/w UBIN        r     1 INDX

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(396)   r     1 DEVINFO(0:21)              0-0-0/c CHAR(80)    r     1 MESSAGE
     0-0-0/w UBIN        r     1 MESSAGE_CNT                0-0-0/c CHAR        r     1 OCCUM
     0-0-0/b BIT         r     1 RETRY_FLG                  0-0-0/b BIT         r     1 S1000_FLG
     0-0-0/b BIT         r     1 TYPEBI

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(1024)  r     1 BUF

PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:203  

   Procedure OCCU requires 202 words for executable code.
   Procedure OCCU requires 12 words of local(AUTO) storage.
PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:204  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:205  
          MINI XREF LISTING

BUF
      1393**DCL      1434<<ASSIGN   1437<<ASSIGN
BUILD_MESSAGE
      1285**DCL-ENT  1460--CALL
CODE
      1283**DCL         6--PROC     1421>>IF       1421>>IF       1457>>IF
CRNOLF
      1419**DCL      1464--CALL
DEVINFO.BSTAT.W1.H1
      1344**DCL      1423>>IF       1469>>IF
DEVINFO.PCWS
      1306**DCL      1317--REDEF
DEVINFO.RPM_PTRS.EF_DCWS$
      1319**DCL      1320--REDEF
DEVINFO.STATUS
      1323**DCL      1342--REDEF
DEVINFO.STATUS.CHAR_POS
      1338**DCL      1431>>ASSIGN   1432>>IF       1437>>ASSIGN
DEVINFO.STATUS.IOM_CENT_STAT
      1334**DCL      1423>>IF
DEVINFO.STATUS.IOM_CHAN_STAT
      1333**DCL      1423>>IF
DEVINFO.STATUS.MAJ_STAT
      1326**DCL      1441>>IF       1454>>IF
DEVINFO.STATUS.NEXT_ADDR
      1337**DCL      1430>>ASSIGN
DEVINFO.STATUS.SUB_STAT
      1327**DCL      1443>>IF       1445>>IF       1447>>IF
DEVINFO.STATUS.TALLY_RESID
      1341**DCL      1434>>ASSIGN   1437>>ASSIGN
DEVINFO.STATUS.TBIT
      1324**DCL      1454>>IF
PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:206  
DOIO
      1287**DCL-ENT  1452--CALL
DOIOX
      1288**DCL-ENT  1453--CALL
DOIO_COM$
      1392**DCL      1452<>CALL     1453<>CALL
INDX
      1282**DCL         6--PROC     1423>>IF       1423>>IF       1423>>IF       1430>>ASSIGN   1431>>ASSIGN
      1432>>IF       1434>>ASSIGN   1437>>ASSIGN   1437>>ASSIGN   1441>>IF       1443>>IF       1445>>IF
      1447>>IF       1452<>CALL     1453<>CALL     1454>>IF       1454>>IF       1461<>CALL     1464<>CALL
      1469>>IF
MESSAGE
      1416**DCL      1461--CALL
MESSAGE_CNT
      1417**DCL      1461<>CALL
MINIQ_PL6
      1286**DCL-ENT  1461--CALL     1464--CALL
OCCU6
      1423**LABEL    1445--GOTO
OCCU7
      1437**LABEL    1426--GOTO
OCCUA
      1457**LABEL    1454--GOTO
OCCUB
      1454**LABEL    1447--GOTO
OCCUM
      1415**DCL      1460<>CALL
OCCUW
      1466**LABEL    1421--GOTO
OCCU_ZONE
      1370**DCL      1392--DCLINIT
OCCU_ZONE.DCW
      1377**DCL      1381--REDEF    1384--REDEF    1385--REDEF    1451<<ASSIGN
OCCU_ZONE.IDCW$
      1376**DCL      1450<<ASSIGN
OCCU_ZONE.W1
PL6.E3A0      #005=OCCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:207  
      1371**DCL      1376--REDEF
RES_BUF$
      1412**DCL      1393--IMP-PTR  1434>>ASSIGN   1437>>ASSIGN
RES_BUF_PTR
      1405**DCL      1412--REDEF
RES_BUF_PTR.BYTEPOS
      1407**DCL      1431<<ASSIGN
RES_BUF_PTR.WOFFS
      1406**DCL      1430<<ASSIGN   1433<<ASSIGN   1433>>ASSIGN
RETRY
      1464**LABEL    1455--GOTO     1458--GOTO     1462--GOTO     1470--GOTO
RETRY0
      1457**LABEL    1443--GOTO
RETRY_FLG
      1413**DCL      1466<<ASSIGN
S1000_FLG
      1418**DCL      1452>>IF
TYPEBI
      1414**DCL      1450--ASSIGN
WRIT_ALERT
      1447**LABEL    1441--GOTO

PL6.E3A0      #006=LPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:208  
     1030        1        /*T***********************************************************/
     1031        2        /*T*                                                         */
     1032        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1033        4        /*T*                                                         */
     1034        5        /*T***********************************************************/
     1035        6        LPIO:   PROC(INDX,CODE) ALTRET;
     1036        7        %INCLUDE IS$MACROS;
     1037     1282    1   DCL INDX UBIN WORD;
     1038     1283    1   DCL CODE UBIN WORD;
     1039     1284        %DEVINFO(STCLASS="SYMREF");
     1040     1353    1   DCL LPXTRA BIT(36) STATIC ALIGNED INIT('0301007'O); /* Read Status Command    */
     1041     1354    1   DCL LPSTAT$ PTR STATIC INIT(ADDR(LPSTAT));
     1042     1355        %DCW_STRUCT(NAME=GET_LPSTAT,STCLASS="REDEF LPSTAT$"); /* Get status IOTD      */
     1043     1373    1   DCL LPXTRA$ PTR STATIC INIT(ADDR(LPXTRA));
     1044     1374        %DCW_STRUCT(NAME=TDCW_LPEXT,STCLASS="REDEF LPXTRA$"); /* TDCW to LPXTRA       */
     1045     1392    1   DCL LPSTAT(0:3) BIT(36) STATIC SYMDEF ALIGNED; /* Status answer buffer        */
     1046     1393    1   DCL 1 LPBUF STATIC ALIGNED,   /* Control character + actual printer buffer    */
     1047     1394    1         2 CONTRB UBIN(9) UNAL,
     1048     1395    1         2 TXT CHAR(160);
     1049     1396        %PTR_STRUCT(NAME=USER_BUF_PTR);         /* Pointer to user's buffer           */
     1050     1414    1   DCL USER_BUF$ REDEF USER_BUF_PTR PTR;
     1051     1415    1   DCL USER_BUF CHAR(160) BASED(USER_BUF$);
     1052     1416        %DCW_STRUCT(NAME=COPY_IODCW);
     1053     1434        /**/
     1054     1435    1   DCL PSI_FLG BIT(1) SYMREF;
     1055     1436    1   DCL IODCW(0:2) BIT(36) SYMREF;
     1056     1437    1   DCL DCTLINES(0:%(FRSTCR-FRSTLP-1)) SBIN(18) SYMREF;
     1057     1438    1   DCL CURR_LINES(0:%(FRSTCR-FRSTLP-1)) SBIN(18) SYMREF;
     1058     1439        /**/
     1059     1440    1           IF DEVINFO.BITS(INDX)~='0'B THEN ALTRETURN; /* LP down                */
     1060     1441    1             ELSE;
     1061     1442    1           GET_LPSTAT.TALLY=4;             /* Initialize Get Status IOTD         */
     1062     1443    1           TDCW_LPEXT.TYPE='10'B;          /* Make a TDCW to Get Status IDCW     */
     1063     1444    1           TDCW_LPEXT.TALLY=0;
     1064     1445    1           IODCW(1)=TDCW_LPEXT;            /* Append to DCW list                 */
     1065     1446    2           DO CASE(CODE);
     1066     1447    2             CASE(4);
PL6.E3A0      #006=LPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:209  
     1067     1448    2   LPIOX:
     1068     1449    2               CURR_LINES(INDX-%FRSTLP)=-DCTLINES(INDX-%FRSTLP);
              1449                        /* Reset lines count */
     1069     1450    2   LPIOX1:
     1070     1451    2               PSI_FLG='1'B;
     1071     1452    2               RETURN;
     1072     1453    2             CASE(3);
     1073     1454    2               LPBUF.CONTRB=%CB_TOF;       /* Top of Form                        */
     1074     1455    2   RLINE:
     1075     1456    2               CURR_LINES(INDX-%FRSTLP)=-DCTLINES(INDX-%FRSTLP);
              1456                        /* Reset lines count */
     1076     1457    2   LPIO1:
     1077     1458    2               COPY_IODCW=IODCW(0);        /* User's IODCW                       */
     1078     1459    2               IF COPY_IODCW.TALLY>40 THEN COPY_IODCW.TALLY=40; /* Truncate it   */
     1079     1460        /* Move user's buffer */
     1080     1461    2               USER_BUF_PTR.WOFFS=COPY_IODCW.AD;
     1081     1462    2               USER_BUF_PTR.BYTEPOS=COPY_IODCW.CP;
     1082     1463    2               LPBUF.TXT=SUBSTR(USER_BUF,0,COPY_IODCW.TALLY*4);
     1083     1464        /* Make a DCW with LPBUF */
     1084     1465    2               USER_BUF$=ADDR(LPBUF);
     1085     1466    2               COPY_IODCW.AD=USER_BUF_PTR.WOFFS;
     1086     1467    2               COPY_IODCW.TALLY=COPY_IODCW.TALLY+1;
     1087     1468    2               IODCW(0)=COPY_IODCW;
     1088     1469    2               GOTO LPIOX1;
     1089     1470    2             CASE(1,2);
     1090     1471    3               IF CURR_LINES(INDX-%FRSTLP)+CODE<=0 THEN DO;
              1471                        /* Lines count not too big */
     1091     1472    3                     CURR_LINES(INDX-%FRSTLP)=CURR_LINES(INDX-%FRSTLP)+CODE;
     1092     1473    3                     LPBUF.CONTRB=%CB_SAP+CODE;
     1093     1474    3                     GOTO LPIO1;
     1094     1475    3                   END;                    /* THEN                               */
     1095     1476    3                 ELSE DO;                  /* Line count too big                 */
     1096     1477    3                     LPBUF.CONTRB=%CB_TOF+CODE;
     1097     1478    3                     GOTO RLINE;
     1098     1479    3                   END;                    /* ELSE                               */
     1099     1480    2             CASE(ELSE);
     1100     1481    2               ALTRETURN;
PL6.E3A0      #006=LPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:210  
     1101     1482    2           END;                            /* DO CASE                            */
     1102     1483    1   END LPIO;
     1103     1484        %EOD;

PL6.E3A0      #006=LPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:211  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure LPIO.

   Procedure LPIO requires 97 words for executable code.
   Procedure LPIO requires 6 words of local(AUTO) storage.

PL6.E3A0      #006=LPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:212  

 Object Unit name= LPIO                                       File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:52:45.12 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    50     62  LPIO
    1   Proc  even  none    97    141  LPIO
    2  RoData even  none     2      2  LPIO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  LPIO

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      3  LPSTAT                             0     60  USER_BUF_PTR
    0     61  COPY_IODCW

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #006=LPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:213  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DEVINFO                               PSI_FLG                               IODCW
     DCTLINES                              CURR_LINES

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #006=LPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:214  


     1030        1        /*T***********************************************************/
     1031        2        /*T*                                                         */
     1032        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1033        4        /*T*                                                         */
     1034        5        /*T***********************************************************/
     1035        6        LPIO:   PROC(INDX,CODE) ALTRET;

      6  1 000000   000000 700200 xent  LPIO         TSX0  ! X66_AUTO_2
         1 000001   000006 000002                    ZERO    6,2

     1036        7        %INCLUDE IS$MACROS;
     1037     1282    1   DCL INDX UBIN WORD;
     1038     1283    1   DCL CODE UBIN WORD;
     1039     1284        %DEVINFO(STCLASS="SYMREF");
     1040     1353    1   DCL LPXTRA BIT(36) STATIC ALIGNED INIT('0301007'O); /* Read Status Command    */
     1041     1354    1   DCL LPSTAT$ PTR STATIC INIT(ADDR(LPSTAT));
     1042     1355        %DCW_STRUCT(NAME=GET_LPSTAT,STCLASS="REDEF LPSTAT$"); /* Get status IOTD      */
     1043     1373    1   DCL LPXTRA$ PTR STATIC INIT(ADDR(LPXTRA));
     1044     1374        %DCW_STRUCT(NAME=TDCW_LPEXT,STCLASS="REDEF LPXTRA$"); /* TDCW to LPXTRA       */
     1045     1392    1   DCL LPSTAT(0:3) BIT(36) STATIC SYMDEF ALIGNED; /* Status answer buffer        */
     1046     1393    1   DCL 1 LPBUF STATIC ALIGNED,   /* Control character + actual printer buffer    */
     1047     1394    1         2 CONTRB UBIN(9) UNAL,
     1048     1395    1         2 TXT CHAR(160);
     1049     1396        %PTR_STRUCT(NAME=USER_BUF_PTR);         /* Pointer to user's buffer           */
     1050     1414    1   DCL USER_BUF$ REDEF USER_BUF_PTR PTR;
     1051     1415    1   DCL USER_BUF CHAR(160) BASED(USER_BUF$);
     1052     1416        %DCW_STRUCT(NAME=COPY_IODCW);
     1053     1434        /**/
     1054     1435    1   DCL PSI_FLG BIT(1) SYMREF;
     1055     1436    1   DCL IODCW(0:2) BIT(36) SYMREF;
     1056     1437    1   DCL DCTLINES(0:%(FRSTCR-FRSTLP-1)) SBIN(18) SYMREF;
     1057     1438    1   DCL CURR_LINES(0:%(FRSTCR-FRSTLP-1)) SBIN(18) SYMREF;
     1058     1439        /**/
     1059     1440    1           IF DEVINFO.BITS(INDX)~='0'B THEN ALTRETURN; /* LP down                */

   1440  1 000002   200003 470500                    LDP0    @INDX,,AUTO
PL6.E3A0      #006=LPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:215  
         1 000003   000000 236100                    LDQ     0,,PR0
         1 000004   000006 402007                    MPY     6,DL
         1 000005   000001 736000                    QLS     1
         1 000006   000001 235006 xsym               LDA     DEVINFO+1,QL
         1 000007   000011 600000 1                  TZE     s:1442

   1440  1 000010   000000 702200 xent               TSX2  ! X66_AALT

     1060     1441    1             ELSE;
     1061     1442    1           GET_LPSTAT.TALLY=4;             /* Initialize Get Status IOTD         */

   1442  1 000011   000004 236007                    LDQ     4,DL
         1 000012   000001 752003 0                  STCQ    LPSTAT$,'03'O

     1062     1443    1           TDCW_LPEXT.TYPE='10'B;          /* Make a TDCW to Get Status IDCW     */

   1443  1 000013   000002 236000 0                  LDQ     LPXTRA$
         1 000014   000000 376000 2                  ANQ     0
         1 000015   020000 276007                    ORQ     8192,DL
         1 000016   000002 756000 0                  STQ     LPXTRA$

     1063     1444    1           TDCW_LPEXT.TALLY=0;

   1444  1 000017   000000 236003                    LDQ     0,DU
         1 000020   000002 752003 0                  STCQ    LPXTRA$,'03'O

     1064     1445    1           IODCW(1)=TDCW_LPEXT;            /* Append to DCW list                 */

   1445  1 000021   000002 236000 0                  LDQ     LPXTRA$
         1 000022   000001 756000 xsym               STQ     IODCW+1

     1065     1446    2           DO CASE(CODE);

   1446  1 000023   200004 471500                    LDP1    @CODE,,AUTO
         1 000024   100000 235100                    LDA     0,,PR1
         1 000025   000005 115007                    CMPA    5,DL
         1 000026   000030 602005 1                  TNC     s:1446+5,AL
PL6.E3A0      #006=LPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:216  
         1 000027   000140 710000 1                  TRA     s:1481
         1 000030   000140 710000 1                  TRA     s:1481
         1 000031   000114 710000 1                  TRA     s:1471
         1 000032   000114 710000 1                  TRA     s:1471
         1 000033   000044 710000 1                  TRA     s:1454
         1 000034   000035 710000 1                  TRA     LPIOX

     1066     1447    2             CASE(4);

     1067     1448    2   LPIOX:
     1068     1449    2               CURR_LINES(INDX-%FRSTLP)=-DCTLINES(INDX-%FRSTLP);
              1449                        /* Reset lines count */

   1449  1 000035   000000 720100       LPIOX        LXL0    0,,PR0
         1 000036   000000 221003                    LDX1    0,DU
         1 000037   777777 121010 xsym               SBLX1   DCTLINES-1,X0
         1 000040   777777 741010 xsym               STX1    CURR_LINES-1,X0

     1069     1450    2   LPIOX1:
     1070     1451    2               PSI_FLG='1'B;

   1451  1 000041   400000 236003       LPIOX1       LDQ     -131072,DU
         1 000042   000000 756000 xsym               STQ     PSI_FLG

     1071     1452    2               RETURN;

   1452  1 000043   000000 702200 xent               TSX2  ! X66_ARET

     1072     1453    2             CASE(3);

     1073     1454    2               LPBUF.CONTRB=%CB_TOF;       /* Top of Form                        */

   1454  1 000044   160000 236003                    LDQ     57344,DU
         1 000045   000007 552040 0                  STBQ    LPBUF,'40'O

     1074     1455    2   RLINE:
     1075     1456    2               CURR_LINES(INDX-%FRSTLP)=-DCTLINES(INDX-%FRSTLP);
PL6.E3A0      #006=LPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:217  
              1456                        /* Reset lines count */

   1456  1 000046   200003 470500       RLINE        LDP0    @INDX,,AUTO
         1 000047   000000 720100                    LXL0    0,,PR0
         1 000050   000000 221003                    LDX1    0,DU
         1 000051   777777 121010 xsym               SBLX1   DCTLINES-1,X0
         1 000052   777777 741010 xsym               STX1    CURR_LINES-1,X0

     1076     1457    2   LPIO1:
     1077     1458    2               COPY_IODCW=IODCW(0);        /* User's IODCW                       */

   1458  1 000053   000000 236000 xsym  LPIO1        LDQ     IODCW
         1 000054   000061 756000 0                  STQ     COPY_IODCW

     1078     1459    2               IF COPY_IODCW.TALLY>40 THEN COPY_IODCW.TALLY=40; /* Truncate it   */

   1459  1 000055   000061 236000 0                  LDQ     COPY_IODCW
         1 000056   007777 376007                    ANQ     4095,DL
         1 000057   000051 116007                    CMPQ    41,DL
         1 000060   000063 602000 1                  TNC     s:1461

   1459  1 000061   000050 236007                    LDQ     40,DL
         1 000062   000061 752003 0                  STCQ    COPY_IODCW,'03'O

     1079     1460        /* Move user's buffer */
     1080     1461    2               USER_BUF_PTR.WOFFS=COPY_IODCW.AD;

   1461  1 000063   000061 220000 0                  LDX0    COPY_IODCW
         1 000064   000060 740000 0                  STX0    USER_BUF_PTR

     1081     1462    2               USER_BUF_PTR.BYTEPOS=COPY_IODCW.CP;

   1462  1 000065   000061 236000 0                  LDQ     COPY_IODCW
         1 000066   000001 736000                    QLS     1
         1 000067   000060 676000 0                  ERQ     USER_BUF_PTR
         1 000070   600000 376007                    ANQ     -65536,DL
         1 000071   000060 656000 0                  ERSQ    USER_BUF_PTR
PL6.E3A0      #006=LPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:218  

     1082     1463    2               LPBUF.TXT=SUBSTR(USER_BUF,0,COPY_IODCW.TALLY*4);

   1463  1 000072   000061 236000 0                  LDQ     COPY_IODCW
         1 000073   000002 736000                    QLS     2
         1 000074   037774 376007                    ANQ     16380,DL
         1 000075   000060 470400 0                  LDP0    USER_BUF_PTR
         1 000076   000000 621006                    EAX1    0,QL
         1 000077   040000 100540                    MLR     fill='040'O
         1 000100   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
         1 000101   000007 200240 0                  ADSC9   LPBUF                    cn=1,n=160

     1083     1464        /* Make a DCW with LPBUF */
     1084     1465    2               USER_BUF$=ADDR(LPBUF);

   1465  1 000102   000001 236000 2                  LDQ     1
         1 000103   000060 756000 0                  STQ     USER_BUF_PTR

     1085     1466    2               COPY_IODCW.AD=USER_BUF_PTR.WOFFS;

   1466  1 000104   000060 221000 0                  LDX1    USER_BUF_PTR
         1 000105   000061 741000 0                  STX1    COPY_IODCW

     1086     1467    2               COPY_IODCW.TALLY=COPY_IODCW.TALLY+1;

   1467  1 000106   000061 236000 0                  LDQ     COPY_IODCW
         1 000107   000001 036007                    ADLQ    1,DL
         1 000110   000061 752003 0                  STCQ    COPY_IODCW,'03'O

     1087     1468    2               IODCW(0)=COPY_IODCW;

   1468  1 000111   000061 236000 0                  LDQ     COPY_IODCW
         1 000112   000000 756000 xsym               STQ     IODCW

     1088     1469    2               GOTO LPIOX1;

   1469  1 000113   000041 710000 1                  TRA     LPIOX1
PL6.E3A0      #006=LPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:219  

     1089     1470    2             CASE(1,2);

     1090     1471    3               IF CURR_LINES(INDX-%FRSTLP)+CODE<=0 THEN DO;
              1471                        /* Lines count not too big */

   1471  1 000114   000000 720100                    LXL0    0,,PR0
         1 000115   777777 236010 xsym               LDQ     CURR_LINES-1,X0
         1 000116   000022 732000                    QRS     18
         1 000117   100000 036100                    ADLQ    0,,PR1
         1 000120   000133 605400 1                  TPNZ    s:1477

     1091     1472    3                     CURR_LINES(INDX-%FRSTLP)=CURR_LINES(INDX-%FRSTLP)+CODE;

   1472  1 000121   777777 236010 xsym               LDQ     CURR_LINES-1,X0
         1 000122   000022 732000                    QRS     18
         1 000123   100000 036100                    ADLQ    0,,PR1
         1 000124   000000 621006                    EAX1    0,QL
         1 000125   777777 741010 xsym               STX1    CURR_LINES-1,X0

     1092     1473    3                     LPBUF.CONTRB=%CB_SAP+CODE;

   1473  1 000126   100000 236100                    LDQ     0,,PR1
         1 000127   000100 036007                    ADLQ    64,DL
         1 000130   000033 736000                    QLS     27
         1 000131   000007 552040 0                  STBQ    LPBUF,'40'O

     1093     1474    3                     GOTO LPIO1;

   1474  1 000132   000053 710000 1                  TRA     LPIO1

     1094     1475    3                   END;                    /* THEN                               */
     1095     1476    3                 ELSE DO;                  /* Line count too big                 */

     1096     1477    3                     LPBUF.CONTRB=%CB_TOF+CODE;

   1477  1 000133   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #006=LPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:220  
         1 000134   000160 036007                    ADLQ    112,DL
         1 000135   000033 736000                    QLS     27
         1 000136   000007 552040 0                  STBQ    LPBUF,'40'O

     1097     1478    3                     GOTO RLINE;

   1478  1 000137   000046 710000 1                  TRA     RLINE

     1098     1479    3                   END;                    /* ELSE                               */
     1099     1480    2             CASE(ELSE);

     1100     1481    2               ALTRETURN;

   1481  1 000140   000000 702200 xent               TSX2  ! X66_AALT
     1101     1482    2           END;                            /* DO CASE                            */
     1102     1483    1   END LPIO;
     1103     1484        %EOD;

PL6.E3A0      #006=LPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:221  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure LPIO.
PL6.E3A0      #006=LPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:222  

 **** Variables and constants ****

  ****  Section 000  Data  LPIO

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    61-0-0/w STRC        r     1 COPY_IODCW                 1-0-0/w STRC        r     1 GET_LPSTAT
     7-0-0/w STRC(1449)  r     1 LPBUF                      3-0-0/w BIT         r     1 LPSTAT(0:3)
     1-0-0/w PTR         r     1 LPSTAT$                    0-0-0/w BIT         r     1 LPXTRA
     2-0-0/w PTR         r     1 LPXTRA$                    2-0-0/w STRC        r     1 TDCW_LPEXT
    60-0-0/w PTR         r     1 USER_BUF$                 60-0-0/w STRC        r     1 USER_BUF_PTR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @CODE                      3-0-0/w PTR         r     1 @INDX
    *0-0-0/w UBIN        r     1 CODE                      *0-0-0/w UBIN        r     1 INDX

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN(18)    r     1 CURR_LINES(0:0)
     0-0-0/w SBIN(18)    r     1 DCTLINES(0:0)
     0-0-0/d STRC(396)   r     1 DEVINFO(0:21)              0-0-0/b BIT         r     1 IODCW(0:2)
     0-0-0/b BIT         r     1 PSI_FLG

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(160)   r     1 USER_BUF
PL6.E3A0      #006=LPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:223  


   Procedure LPIO requires 97 words for executable code.
   Procedure LPIO requires 6 words of local(AUTO) storage.
PL6.E3A0      #006=LPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:224  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=LPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:225  
          MINI XREF LISTING

CODE
      1283**DCL         6--PROC     1446>>DOCASE   1471>>IF       1472>>ASSIGN   1473>>ASSIGN   1477>>ASSIGN
COPY_IODCW
      1426**DCL      1458<<ASSIGN   1468>>ASSIGN
COPY_IODCW.AD
      1427**DCL      1461>>ASSIGN   1466<<ASSIGN
COPY_IODCW.CP
      1428**DCL      1462>>ASSIGN
COPY_IODCW.TALLY
      1431**DCL      1459>>IF       1459<<ASSIGN   1463>>ASSIGN   1467<<ASSIGN   1467>>ASSIGN
CURR_LINES
      1438**DCL      1449<<ASSIGN   1456<<ASSIGN   1471>>IF       1472<<ASSIGN   1472>>ASSIGN
DCTLINES
      1437**DCL      1449>>ASSIGN   1456>>ASSIGN
DEVINFO.BITS
      1299**DCL      1440>>IF
DEVINFO.PCWS
      1300**DCL      1311--REDEF
DEVINFO.RPM_PTRS.EF_DCWS$
      1313**DCL      1314--REDEF
DEVINFO.STATUS
      1317**DCL      1336--REDEF
GET_LPSTAT.TALLY
      1370**DCL      1442<<ASSIGN
INDX
      1282**DCL         6--PROC     1440>>IF       1449>>ASSIGN   1449>>ASSIGN   1456>>ASSIGN   1456>>ASSIGN
      1471>>IF       1472>>ASSIGN   1472>>ASSIGN
IODCW
      1436**DCL      1445<<ASSIGN   1458>>ASSIGN   1468<<ASSIGN
LPBUF
      1393**DCL      1465--ASSIGN
LPBUF.CONTRB
PL6.E3A0      #006=LPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:226  
      1394**DCL      1454<<ASSIGN   1473<<ASSIGN   1477<<ASSIGN
LPBUF.TXT
      1395**DCL      1463<<ASSIGN
LPIO1
      1458**LABEL    1474--GOTO
LPIOX1
      1451**LABEL    1469--GOTO
LPSTAT
      1392**DCL      1354--DCLINIT
LPSTAT$
      1354**DCL      1365--REDEF
LPXTRA
      1353**DCL      1373--DCLINIT
LPXTRA$
      1373**DCL      1384--REDEF
PSI_FLG
      1435**DCL      1451<<ASSIGN
RLINE
      1456**LABEL    1478--GOTO
TDCW_LPEXT
      1384**DCL      1445>>ASSIGN
TDCW_LPEXT.TALLY
      1389**DCL      1444<<ASSIGN
TDCW_LPEXT.TYPE
      1388**DCL      1443<<ASSIGN
USER_BUF
      1415**DCL      1463>>ASSIGN
USER_BUF$
      1414**DCL      1415--IMP-PTR  1463>>ASSIGN   1465<<ASSIGN
USER_BUF_PTR
      1407**DCL      1414--REDEF
USER_BUF_PTR.BYTEPOS
      1409**DCL      1462<<ASSIGN
USER_BUF_PTR.WOFFS
      1408**DCL      1461<<ASSIGN   1466>>ASSIGN

PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:227  
     1104        1        /*T***********************************************************/
     1105        2        /*T*                                                         */
     1106        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1107        4        /*T*                                                         */
     1108        5        /*T***********************************************************/
     1109        6        LPCU:   PROC(INDX) ALTRET;
     1110        7        %INCLUDE IS$MACROS;
     1111     1282    1   DCL INDX UBIN WORD;
     1112     1283        %DEVINFO(STCLASS="SYMREF");
     1113     1352        %TEXTC(N#=LPHMX,M#="' XXXXXXXX READY status not returned . '");
     1114     1357        %TEXTC(N#=LPHMY,M#="' XXXXXXXX error . '");
     1115     1362    1   DCL LPHM BIT(1) SYMREF;
     1116     1363    1   DCL MESSAGE$ PTR;
     1117     1364    1   DCL 1 TEXTM BASED(MESSAGE$),
     1118     1365    1         2 CNT UBIN WORD,
     1119     1366    1         2 TXT CHAR(TEXTM.CNT);
     1120     1367    1   DCL RETR# UBIN(9);                      /* Number of retries                  */
     1121     1368    1   DCL I UBIN WORD;
     1122     1369        /**/
     1123     1370    1   DCL RETRY_FLG BIT(1) SYMREF;
     1124     1371    1   DCL LPSTAT(0:3) BIT(36) SYMREF;
     1125     1372    1   DCL 1 ANSBUF SYMREF,
     1126     1373    1         2 CNT UBIN WORD,
     1127     1374    1         2 TXT CHAR(16);
     1128     1375    1   DCL LPINIT ENTRY(1) ALTRET;
     1129     1376    1   DCL SET_TRAIN5 ENTRY(1) ALTRET;
     1130     1377    1   DCL SET_TRAIN6 ENTRY(1) ALTRET;
     1131     1378    1   DCL TYPEC ENTRY(1);
     1132     1379    1   DCL TYPEST ENTRY(1);
     1133     1380    1   DCL KEYIN ENTRY(2) ALTRET;
     1134     1381        /**/
     1135     1382    1           IF(DEVINFO.BSTAT.W1(INDX)&%STATUS_MASK)~=%TERM_STATUS THEN GOTO ANALZ_STAT;
     1136     1383    1             ELSE;
     1137     1384        /* See if all is OK */
     1138     1385    2           IF LPSTAT(0)~='0'B THEN DO;     /* All is well;normal return          */
     1139     1386    2   NORM_RET:
     1140     1387    2                 RETR#=0;
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:228  
     1141     1388    2                 RETURN;
     1142     1389    2               END;                        /* THEN                               */
     1143     1390    1             ELSE GOTO LPCUX;              /* The impossible ..                  */
     1144     1391    1   ANALZ_STAT:
     1145     1392    2           DO SELECT(DEVINFO.STATUS.MAJ_STAT(INDX)); /* Transfer on major status */
     1146     1393    2             SELECT('0011'B);              /* Major status=3 : data alert        */
     1147     1394    3             DO SELECT(DEVINFO.STATUS.SUB_STAT(INDX)); /* Check sub_status       */
     1148     1395    3               SELECT('01'O,'02'O);
     1149     1396    3               GOTO RETRY;
     1150     1397    3               SELECT('00'O);              /* Reload VFC and train image         */
     1151     1398    3               CALL LPINIT(INDX) ALTRET(ERR_RET);
     1152     1399    4               DO I=0 TO 30000;            /* Wait                               */
     1153     1400    4               END;                        /* DO I=                              */
     1154     1401    3   RETR2:
     1155     1402    3               RETR#=RETR#+1;
     1156     1403    3               IF RETR#<=2 THEN GOTO NRETRY;
     1157     1404    3                 ELSE GOTO ERR_RET;
     1158     1405    3               SELECT('10'O);              /* Top of page echo                   */
     1159     1406    3               GOTO NORM_RET;              /* OK                                 */
     1160     1407    3               SELECT(ELSE);
     1161     1408    3   RETR4:
     1162     1409    3             RETR#=RETR#+1;
     1163     1410    3             IF RETR#<=4 THEN GOTO NRETRY;
     1164     1411    3               ELSE GOTO ERR_RET;
     1165     1412    3             END;                          /* DO SELECT on sub_status            */
     1166     1413    2           SELECT('0101'B);                /* Major status=5 : command reject    */
     1167     1414    3           DO SELECT(DEVINFO.STATUS.SUB_STAT(INDX)); /* Check sub_status         */
     1168     1415    3             SELECT('04'O,'02'O);     /* Paper motion alert, top of page echo    */
     1169     1416    3             GOTO RETR4;
     1170     1417    3             SELECT(ELSE);
     1171     1418    3           GOTO LPCU2;
     1172     1419    3           END;                            /* DO SELECT on sub_status            */
     1173     1420    2           SELECT(ELSE);
     1174     1421    2   LPCU2:
     1175     1422    2           MESSAGE$=ADDR(LPHMY);
     1176     1423    2           SUBSTR(TEXTM.TXT,1,8)=DEVINFO.DEVNAME(INDX);
     1177     1424    2           CALL TYPEC(LPHMY);
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:229  
     1178     1425    2           CALL TYPEST(DEVINFO.STATUS(INDX)); /* Give status info                */
     1179     1426    2   LPCU20:
     1180     1427    2           MESSAGE$=ADDR(LPHM);
     1181     1428    2           SUBSTR(TEXTM.TXT,0,8)=DEVINFO.DEVNAME(INDX);
     1182     1429    2   ASK:
     1183     1430    2           CALL KEYIN(LPHM,ANSBUF);
     1184     1431    3           DO SELECT(SUBSTR(ANSBUF.TXT,0,1));
     1185     1432    3             SELECT('5');
     1186     1433    3             CALL SET_TRAIN5(INDX) ALTRET(ERR_RET);
     1187     1434    4             DO I=0 TO 30000;              /* Wait                               */
     1188     1435    4             END;                          /* DO I=                              */
     1189     1436    3             GOTO RETRY;
     1190     1437    3             SELECT('6');
     1191     1438    3             CALL SET_TRAIN6(INDX) ALTRET(ERR_RET);
     1192     1439    4             DO I=0 TO 30000;              /* Wait                               */
     1193     1440    4             END;                          /* DO I=                              */
     1194     1441    3             GOTO RETRY;
     1195     1442    3             SELECT('S','s');
     1196     1443    3   LPDWN:
     1197     1444    3             DEVINFO.BITS(INDX)='1'B;
     1198     1445    3   ERR_RET:
     1199     1446    3             RETR#=0;
     1200     1447    3             ALTRETURN;
     1201     1448    3             SELECT('G','g');
     1202     1449    3             GOTO RETRY;
     1203     1450    3             SELECT(ELSE);
     1204     1451    3           GOTO ASK;
     1205     1452    3           END;                            /* DO SELECT on answer                */
     1206     1453    2           END;                            /* DO SELECT on major status          */
     1207     1454    1   LPCUX:
     1208     1455    1           MESSAGE$=ADDR(LPHMX);
     1209     1456    1           SUBSTR(TEXTM.TXT,1,8)=DEVINFO.DEVNAME(INDX);
     1210     1457    1           CALL TYPEC(LPHMX);
     1211     1458    1           GOTO NORM_RET;                  /* Ignore it                          */
     1212     1459    1   RETRY:
     1213     1460    1           RETR#=0;
     1214     1461    1   NRETRY:
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:230  
     1215     1462    1           RETRY_FLG='1'B;
     1216     1463    1           ALTRETURN;
     1217     1464    1   END LPCU;
     1218     1465        %EOD;

PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:231  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure LPCU.

   Procedure LPCU requires 255 words for executable code.
   Procedure LPCU requires 10 words of local(AUTO) storage.

PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:232  

 Object Unit name= LPCU                                       File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:52:49.72 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    17     21  LPCU
    1  RoData even  UTS      1      1  LPCU
    2   Proc  even  none   255    377  LPCU
    3  RoData even  none     6      6  LPCU

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  LPCU

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  LPHMX                              0     13  LPHMY
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:233  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 LPINIT
         yes           Std       1 TYPEC
 yes     yes           Std       2 KEYIN
 yes     yes           Std       1 SET_TRAIN5
 yes     yes           Std       1 SET_TRAIN6
         yes           Std       1 TYPEST
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DEVINFO                               LPHM                                  RETRY_FLG
     LPSTAT                                ANSBUF                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:234  


     1104        1        /*T***********************************************************/
     1105        2        /*T*                                                         */
     1106        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1107        4        /*T*                                                         */
     1108        5        /*T***********************************************************/
     1109        6        LPCU:   PROC(INDX) ALTRET;

      6  2 000000   000000 700200 xent  LPCU         TSX0  ! X66_AUTO_1
         2 000001   000012 000001                    ZERO    10,1

     1110        7        %INCLUDE IS$MACROS;
     1111     1282    1   DCL INDX UBIN WORD;
     1112     1283        %DEVINFO(STCLASS="SYMREF");
     1113     1352        %TEXTC(N#=LPHMX,M#="' XXXXXXXX READY status not returned . '");
     1114     1357        %TEXTC(N#=LPHMY,M#="' XXXXXXXX error . '");
     1115     1362    1   DCL LPHM BIT(1) SYMREF;
     1116     1363    1   DCL MESSAGE$ PTR;
     1117     1364    1   DCL 1 TEXTM BASED(MESSAGE$),
     1118     1365    1         2 CNT UBIN WORD,
     1119     1366    1         2 TXT CHAR(TEXTM.CNT);
     1120     1367    1   DCL RETR# UBIN(9);                      /* Number of retries                  */
     1121     1368    1   DCL I UBIN WORD;
     1122     1369        /**/
     1123     1370    1   DCL RETRY_FLG BIT(1) SYMREF;
     1124     1371    1   DCL LPSTAT(0:3) BIT(36) SYMREF;
     1125     1372    1   DCL 1 ANSBUF SYMREF,
     1126     1373    1         2 CNT UBIN WORD,
     1127     1374    1         2 TXT CHAR(16);
     1128     1375    1   DCL LPINIT ENTRY(1) ALTRET;
     1129     1376    1   DCL SET_TRAIN5 ENTRY(1) ALTRET;
     1130     1377    1   DCL SET_TRAIN6 ENTRY(1) ALTRET;
     1131     1378    1   DCL TYPEC ENTRY(1);
     1132     1379    1   DCL TYPEST ENTRY(1);
     1133     1380    1   DCL KEYIN ENTRY(2) ALTRET;
     1134     1381        /**/
     1135     1382    1           IF(DEVINFO.BSTAT.W1(INDX)&%STATUS_MASK)~=%TERM_STATUS THEN GOTO ANALZ_STAT;
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:235  

   1382  2 000002   200003 470500                    LDP0    @INDX,,AUTO
         2 000003   000000 236100                    LDQ     0,,PR0
         2 000004   000006 402007                    MPY     6,DL
         2 000005   000001 736000                    QLS     1
         2 000006   000000 620006                    EAX0    0,QL
         2 000007   000000 236000 1                  LDQ     0
         2 000010   000004 376010 xsym               ANQ     DEVINFO+4,X0
         2 000011   400000 116003                    CMPQ    -131072,DU
         2 000012   000017 601000 2                  TNZ     ANALZ_STAT

     1136     1383    1             ELSE;
     1137     1384        /* See if all is OK */
     1138     1385    2           IF LPSTAT(0)~='0'B THEN DO;     /* All is well;normal return          */

   1385  2 000013   000000 235000 xsym               LDA     LPSTAT
         2 000014   000354 600000 2                  TZE     LPCUX

     1139     1386    2   NORM_RET:
     1140     1387    2                 RETR#=0;

   1387  2 000015   200005 450100       NORM_RET     STZ     RETR#,,AUTO

     1141     1388    2                 RETURN;

   1388  2 000016   000000 702200 xent               TSX2  ! X66_ARET

     1142     1389    2               END;                        /* THEN                               */
     1143     1390    1             ELSE GOTO LPCUX;              /* The impossible ..                  */
     1144     1391    1   ANALZ_STAT:
     1145     1392    2           DO SELECT(DEVINFO.STATUS.MAJ_STAT(INDX)); /* Transfer on major status */

   1392  2 000017   000000 236100       ANALZ_STAT   LDQ     0,,PR0
         2 000020   000006 402007                    MPY     6,DL
         2 000021   000000 620006                    EAX0    0,QL
         2 000022   000001 736000                    QLS     1
         2 000023   000004 236006 xsym               LDQ     DEVINFO+4,QL
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:236  
         2 000024   170000 376003                    ANQ     61440,DU
         2 000025   030000 116003                    CMPQ    12288,DU
         2 000026   000175 602000 2                  TNC     LPCU2
         2 000027   000000 635010                    EAA     0,X0
         2 000030   000021 771000                    ARL     17
         2 000031   000004 236005 xsym               LDQ     DEVINFO+4,AL
         2 000032   170000 376003                    ANQ     61440,DU
         2 000033   030000 116003                    CMPQ    12288,DU
         2 000034   000044 600000 2                  TZE     s:1394
         2 000035   000000 635010                    EAA     0,X0
         2 000036   000021 771000                    ARL     17
         2 000037   000004 236005 xsym               LDQ     DEVINFO+4,AL
         2 000040   170000 376003                    ANQ     61440,DU
         2 000041   050000 116003                    CMPQ    20480,DU
         2 000042   000175 601000 2                  TNZ     LPCU2
         2 000043   000147 710000 2                  TRA     s:1414

     1146     1393    2             SELECT('0011'B);              /* Major status=3 : data alert        */

     1147     1394    3             DO SELECT(DEVINFO.STATUS.SUB_STAT(INDX)); /* Check sub_status       */

   1394  2 000044   000000 635010                    EAA     0,X0
         2 000045   000021 771000                    ARL     17
         2 000046   000004 236005 xsym               LDQ     DEVINFO+4,AL
         2 000047   007700 376003                    ANQ     4032,DU
         2 000050   000100 116003                    CMPQ    64,DU
         2 000051   000103 602000 2                  TNC     s:1394+31
         2 000052   000000 635010                    EAA     0,X0
         2 000053   000021 771000                    ARL     17
         2 000054   000004 236005 xsym               LDQ     DEVINFO+4,AL
         2 000055   007700 376003                    ANQ     4032,DU
         2 000056   000100 116003                    CMPQ    64,DU
         2 000057   000113 600000 2                  TZE     s:1396
         2 000060   000000 635010                    EAA     0,X0
         2 000061   000021 771000                    ARL     17
         2 000062   000004 236005 xsym               LDQ     DEVINFO+4,AL
         2 000063   007700 376003                    ANQ     4032,DU
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:237  
         2 000064   000200 116003                    CMPQ    128,DU
         2 000065   000137 602000 2                  TNC     RETR4
         2 000066   000000 635010                    EAA     0,X0
         2 000067   000021 771000                    ARL     17
         2 000070   000004 236005 xsym               LDQ     DEVINFO+4,AL
         2 000071   007700 376003                    ANQ     4032,DU
         2 000072   000200 116003                    CMPQ    128,DU
         2 000073   000113 600000 2                  TZE     s:1396
         2 000074   000000 635010                    EAA     0,X0
         2 000075   000021 771000                    ARL     17
         2 000076   000004 236005 xsym               LDQ     DEVINFO+4,AL
         2 000077   007700 376003                    ANQ     4032,DU
         2 000100   001000 116003                    CMPQ    512,DU
         2 000101   000137 601000 2                  TNZ     RETR4
         2 000102   000136 710000 2                  TRA     s:1406
         2 000103   000000 635010                    EAA     0,X0
         2 000104   000021 771000                    ARL     17
         2 000105   000004 236005 xsym               LDQ     DEVINFO+4,AL
         2 000106   007700 376003                    ANQ     4032,DU
         2 000107   000000 116003                    CMPQ    0,DU
         2 000110   000114 602000 2                  TNC     s:1398
         2 000111   000114 600000 2                  TZE     s:1398
         2 000112   000137 710000 2                  TRA     RETR4

     1148     1395    3               SELECT('01'O,'02'O);

     1149     1396    3               GOTO RETRY;

   1396  2 000113   000373 710000 2                  TRA     RETRY

     1150     1397    3               SELECT('00'O);              /* Reload VFC and train image         */

     1151     1398    3               CALL LPINIT(INDX) ALTRET(ERR_RET);

   1398  2 000114   200003 630500                    EPPR0   @INDX,,AUTO
         2 000115   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000116   000000 701000 xent               TSX1    LPINIT
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:238  
         2 000117   000350 702000 2                  TSX2    ERR_RET

     1152     1399    4               DO I=0 TO 30000;            /* Wait                               */

   1399  2 000120   200006 450100                    STZ     I,,AUTO

     1153     1400    4               END;                        /* DO I=                              */

   1400  2 000121   200006 235100                    LDA     I,,AUTO
         2 000122   000001 035007                    ADLA    1,DL
         2 000123   200006 755100                    STA     I,,AUTO
         2 000124   072461 115007                    CMPA    30001,DL
         2 000125   000121 602000 2                  TNC     s:1400

     1154     1401    3   RETR2:
     1155     1402    3               RETR#=RETR#+1;

   1402  2 000126   200005 236100       RETR2        LDQ     RETR#,,AUTO
         2 000127   001000 036003                    ADLQ    512,DU
         2 000130   200005 552140                    STBQ    RETR#,'40'O,AUTO

     1156     1403    3               IF RETR#<=2 THEN GOTO NRETRY;

   1403  2 000131   200005 236100                    LDQ     RETR#,,AUTO
         2 000132   777000 376003                    ANQ     -512,DU
         2 000133   003000 116003                    CMPQ    1536,DU
         2 000134   000374 602000 2                  TNC     NRETRY

     1157     1404    3                 ELSE GOTO ERR_RET;

   1404  2 000135   000350 710000 2                  TRA     ERR_RET

     1158     1405    3               SELECT('10'O);              /* Top of page echo                   */

     1159     1406    3               GOTO NORM_RET;              /* OK                                 */

   1406  2 000136   000015 710000 2                  TRA     NORM_RET
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:239  

     1160     1407    3               SELECT(ELSE);

     1161     1408    3   RETR4:
     1162     1409    3             RETR#=RETR#+1;

   1409  2 000137   200005 236100       RETR4        LDQ     RETR#,,AUTO
         2 000140   001000 036003                    ADLQ    512,DU
         2 000141   200005 552140                    STBQ    RETR#,'40'O,AUTO

     1163     1410    3             IF RETR#<=4 THEN GOTO NRETRY;

   1410  2 000142   200005 236100                    LDQ     RETR#,,AUTO
         2 000143   777000 376003                    ANQ     -512,DU
         2 000144   005000 116003                    CMPQ    2560,DU
         2 000145   000374 602000 2                  TNC     NRETRY

     1164     1411    3               ELSE GOTO ERR_RET;

   1411  2 000146   000350 710000 2                  TRA     ERR_RET

     1165     1412    3             END;                          /* DO SELECT on sub_status            */

     1166     1413    2           SELECT('0101'B);                /* Major status=5 : command reject    */

     1167     1414    3           DO SELECT(DEVINFO.STATUS.SUB_STAT(INDX)); /* Check sub_status         */

   1414  2 000147   000000 635010                    EAA     0,X0
         2 000150   000021 771000                    ARL     17
         2 000151   000004 236005 xsym               LDQ     DEVINFO+4,AL
         2 000152   007700 376003                    ANQ     4032,DU
         2 000153   000400 116003                    CMPQ    256,DU
         2 000154   000164 602000 2                  TNC     s:1414+13
         2 000155   000000 635010                    EAA     0,X0
         2 000156   000021 771000                    ARL     17
         2 000157   000004 236005 xsym               LDQ     DEVINFO+4,AL
         2 000160   007700 376003                    ANQ     4032,DU
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:240  
         2 000161   000400 116003                    CMPQ    256,DU
         2 000162   000173 600000 2                  TZE     s:1416
         2 000163   000174 710000 2                  TRA     s:1418
         2 000164   000000 635010                    EAA     0,X0
         2 000165   000021 771000                    ARL     17
         2 000166   000004 236005 xsym               LDQ     DEVINFO+4,AL
         2 000167   007700 376003                    ANQ     4032,DU
         2 000170   000200 116003                    CMPQ    128,DU
         2 000171   000174 601000 2                  TNZ     s:1418
         2 000172   000173 710000 2                  TRA     s:1416

     1168     1415    3             SELECT('04'O,'02'O);     /* Paper motion alert, top of page echo    */

     1169     1416    3             GOTO RETR4;

   1416  2 000173   000137 710000 2                  TRA     RETR4

     1170     1417    3             SELECT(ELSE);

     1171     1418    3           GOTO LPCU2;

   1418  2 000174   000175 710000 2                  TRA     LPCU2

     1172     1419    3           END;                            /* DO SELECT on sub_status            */

     1173     1420    2           SELECT(ELSE);

     1174     1421    2   LPCU2:
     1175     1422    2           MESSAGE$=ADDR(LPHMY);

   1422  2 000175   000000 236000 3     LPCU2        LDQ     0
         2 000176   200004 756100                    STQ     MESSAGE$,,AUTO

     1176     1423    2           SUBSTR(TEXTM.TXT,1,8)=DEVINFO.DEVNAME(INDX);

   1423  2 000177   200004 471500                    LDP1    MESSAGE$,,AUTO
         2 000200   100000 721100                    LXL1    0,,PR1
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:241  
         2 000201   000000 635010                    EAA     0,X0
         2 000202   000017 771000                    ARL     15
         2 000203   040100 100405                    MLR     fill='040'O
         2 000204   000006 000010 xsym               ADSC9   DEVINFO+6,A              cn=0,n=8
         2 000205   100001 200010                    ADSC9   1,,PR1                   cn=1,n=8

     1177     1424    2           CALL TYPEC(LPHMY);

   1424  2 000206   000000 630400 3                  EPPR0   0
         2 000207   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000210   000000 701000 xent               TSX1    TYPEC
         2 000211   000000 011000                    NOP     0

     1178     1425    2           CALL TYPEST(DEVINFO.STATUS(INDX)); /* Give status info                */

   1425  2 000212   200003 470500                    LDP0    @INDX,,AUTO
         2 000213   000000 236100                    LDQ     0,,PR0
         2 000214   000006 402007                    MPY     6,DL
         2 000215   000023 736000                    QLS     19
         2 000216   000001 036000 3                  ADLQ    1
         2 000217   200010 756100                    STQ     I+2,,AUTO
         2 000220   200010 630500                    EPPR0   I+2,,AUTO
         2 000221   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000222   000000 701000 xent               TSX1    TYPEST
         2 000223   000000 011000                    NOP     0

     1179     1426    2   LPCU20:
     1180     1427    2           MESSAGE$=ADDR(LPHM);

   1427  2 000224   000002 236000 3     LPCU20       LDQ     2
         2 000225   200004 756100                    STQ     MESSAGE$,,AUTO

     1181     1428    2           SUBSTR(TEXTM.TXT,0,8)=DEVINFO.DEVNAME(INDX);

   1428  2 000226   200004 470500                    LDP0    MESSAGE$,,AUTO
         2 000227   000000 720100                    LXL0    0,,PR0
         2 000230   200003 471500                    LDP1    @INDX,,AUTO
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:242  
         2 000231   100000 236100                    LDQ     0,,PR1
         2 000232   000006 402007                    MPY     6,DL
         2 000233   000001 736000                    QLS     1
         2 000234   000006 237006 xsym               LDAQ    DEVINFO+6,QL
         2 000235   000001 755100                    STA     1,,PR0
         2 000236   000002 756100                    STQ     2,,PR0

     1182     1429    2   ASK:
     1183     1430    2           CALL KEYIN(LPHM,ANSBUF);

   1430  2 000237   000003 630400 3     ASK          EPPR0   3
         2 000240   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000241   000000 701000 xent               TSX1    KEYIN
         2 000242   000000 011000                    NOP     0

     1184     1431    3           DO SELECT(SUBSTR(ANSBUF.TXT,0,1));

   1431  2 000243   000001 236000 xsym               LDQ     ANSBUF+1
         2 000244   777000 376003                    ANQ     -512,DU
         2 000245   123000 116003                    CMPQ    42496,DU
         2 000246   000271 602000 2                  TNC     s:1431+22
         2 000247   000001 236000 xsym               LDQ     ANSBUF+1
         2 000250   777000 376003                    ANQ     -512,DU
         2 000251   123000 116003                    CMPQ    42496,DU
         2 000252   000341 600000 2                  TZE     LPDWN
         2 000253   000001 236000 xsym               LDQ     ANSBUF+1
         2 000254   777000 376003                    ANQ     -512,DU
         2 000255   163000 116003                    CMPQ    58880,DU
         2 000256   000264 602000 2                  TNC     s:1431+17
         2 000257   000001 236000 xsym               LDQ     ANSBUF+1
         2 000260   777000 376003                    ANQ     -512,DU
         2 000261   163000 116003                    CMPQ    58880,DU
         2 000262   000341 600000 2                  TZE     LPDWN
         2 000263   000353 710000 2                  TRA     s:1451
         2 000264   000001 236000 xsym               LDQ     ANSBUF+1
         2 000265   777000 376003                    ANQ     -512,DU
         2 000266   147000 116003                    CMPQ    52736,DU
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:243  
         2 000267   000353 601000 2                  TNZ     s:1451
         2 000270   000352 710000 2                  TRA     s:1449
         2 000271   000001 236000 xsym               LDQ     ANSBUF+1
         2 000272   777000 376003                    ANQ     -512,DU
         2 000273   066000 116003                    CMPQ    27648,DU
         2 000274   000306 602000 2                  TNC     s:1431+35
         2 000275   000001 236000 xsym               LDQ     ANSBUF+1
         2 000276   777000 376003                    ANQ     -512,DU
         2 000277   066000 116003                    CMPQ    27648,DU
         2 000300   000326 600000 2                  TZE     s:1438
         2 000301   000001 236000 xsym               LDQ     ANSBUF+1
         2 000302   777000 376003                    ANQ     -512,DU
         2 000303   107000 116003                    CMPQ    36352,DU
         2 000304   000353 601000 2                  TNZ     s:1451
         2 000305   000352 710000 2                  TRA     s:1449
         2 000306   000001 236000 xsym               LDQ     ANSBUF+1
         2 000307   777000 376003                    ANQ     -512,DU
         2 000310   065000 116003                    CMPQ    27136,DU
         2 000311   000353 601000 2                  TNZ     s:1451
         2 000312   000313 710000 2                  TRA     s:1433

     1185     1432    3             SELECT('5');

     1186     1433    3             CALL SET_TRAIN5(INDX) ALTRET(ERR_RET);

   1433  2 000313   200003 630500                    EPPR0   @INDX,,AUTO
         2 000314   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000315   000000 701000 xent               TSX1    SET_TRAIN5
         2 000316   000350 702000 2                  TSX2    ERR_RET

     1187     1434    4             DO I=0 TO 30000;              /* Wait                               */

   1434  2 000317   200006 450100                    STZ     I,,AUTO

     1188     1435    4             END;                          /* DO I=                              */

   1435  2 000320   200006 235100                    LDA     I,,AUTO
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:244  
         2 000321   000001 035007                    ADLA    1,DL
         2 000322   200006 755100                    STA     I,,AUTO
         2 000323   072461 115007                    CMPA    30001,DL
         2 000324   000320 602000 2                  TNC     s:1435

     1189     1436    3             GOTO RETRY;

   1436  2 000325   000373 710000 2                  TRA     RETRY

     1190     1437    3             SELECT('6');

     1191     1438    3             CALL SET_TRAIN6(INDX) ALTRET(ERR_RET);

   1438  2 000326   200003 630500                    EPPR0   @INDX,,AUTO
         2 000327   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000330   000000 701000 xent               TSX1    SET_TRAIN6
         2 000331   000350 702000 2                  TSX2    ERR_RET

     1192     1439    4             DO I=0 TO 30000;              /* Wait                               */

   1439  2 000332   200006 450100                    STZ     I,,AUTO

     1193     1440    4             END;                          /* DO I=                              */

   1440  2 000333   200006 235100                    LDA     I,,AUTO
         2 000334   000001 035007                    ADLA    1,DL
         2 000335   200006 755100                    STA     I,,AUTO
         2 000336   072461 115007                    CMPA    30001,DL
         2 000337   000333 602000 2                  TNC     s:1440

     1194     1441    3             GOTO RETRY;

   1441  2 000340   000373 710000 2                  TRA     RETRY

     1195     1442    3             SELECT('S','s');

     1196     1443    3   LPDWN:
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:245  
     1197     1444    3             DEVINFO.BITS(INDX)='1'B;

   1444  2 000341   200003 470500       LPDWN        LDP0    @INDX,,AUTO
         2 000342   000000 236100                    LDQ     0,,PR0
         2 000343   000006 402007                    MPY     6,DL
         2 000344   000001 736000                    QLS     1
         2 000345   000000 620006                    EAX0    0,QL
         2 000346   400000 236003                    LDQ     -131072,DU
         2 000347   000001 756010 xsym               STQ     DEVINFO+1,X0

     1198     1445    3   ERR_RET:
     1199     1446    3             RETR#=0;

   1446  2 000350   200005 450100       ERR_RET      STZ     RETR#,,AUTO

     1200     1447    3             ALTRETURN;

   1447  2 000351   000000 702200 xent               TSX2  ! X66_AALT

     1201     1448    3             SELECT('G','g');

     1202     1449    3             GOTO RETRY;

   1449  2 000352   000373 710000 2                  TRA     RETRY

     1203     1450    3             SELECT(ELSE);

     1204     1451    3           GOTO ASK;

   1451  2 000353   000237 710000 2                  TRA     ASK

     1205     1452    3           END;                            /* DO SELECT on answer                */

     1206     1453    2           END;                            /* DO SELECT on major status          */

     1207     1454    1   LPCUX:
     1208     1455    1           MESSAGE$=ADDR(LPHMX);
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:246  

   1455  2 000354   000005 236000 3     LPCUX        LDQ     5
         2 000355   200004 756100                    STQ     MESSAGE$,,AUTO

     1209     1456    1           SUBSTR(TEXTM.TXT,1,8)=DEVINFO.DEVNAME(INDX);

   1456  2 000356   200004 471500                    LDP1    MESSAGE$,,AUTO
         2 000357   100000 720100                    LXL0    0,,PR1
         2 000360   000000 236100                    LDQ     0,,PR0
         2 000361   000006 402007                    MPY     6,DL
         2 000362   000003 736000                    QLS     3
         2 000363   040100 100406                    MLR     fill='040'O
         2 000364   000006 000010 xsym               ADSC9   DEVINFO+6,Q              cn=0,n=8
         2 000365   100001 200010                    ADSC9   1,,PR1                   cn=1,n=8

     1210     1457    1           CALL TYPEC(LPHMX);

   1457  2 000366   000005 630400 3                  EPPR0   5
         2 000367   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000370   000000 701000 xent               TSX1    TYPEC
         2 000371   000000 011000                    NOP     0

     1211     1458    1           GOTO NORM_RET;                  /* Ignore it                          */

   1458  2 000372   000015 710000 2                  TRA     NORM_RET

     1212     1459    1   RETRY:
     1213     1460    1           RETR#=0;

   1460  2 000373   200005 450100       RETRY        STZ     RETR#,,AUTO

     1214     1461    1   NRETRY:
     1215     1462    1           RETRY_FLG='1'B;

   1462  2 000374   400000 236003       NRETRY       LDQ     -131072,DU
         2 000375   000000 756000 xsym               STQ     RETRY_FLG

PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:247  
     1216     1463    1           ALTRETURN;

   1463  2 000376   000000 702200 xent               TSX2  ! X66_AALT
     1217     1464    1   END LPCU;
     1218     1465        %EOD;

PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:248  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure LPCU.
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:249  

 **** Variables and constants ****

  ****  Section 000  Data  LPCU

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(378)   r     1 LPHMX                     13-0-0/w STRC(198)   r     1 LPHMY

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @INDX                      6-0-0/w UBIN        r     1 I
    *0-0-0/w UBIN        r     1 INDX                       4-0-0/w PTR         r     1 MESSAGE$
     5-0-0/w UBIN(9)     r     1 RETR#

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ANSBUF                     0-0-0/d STRC(396)   r     1 DEVINFO(0:21)
     0-0-0/b BIT         r     1 LPHM                       0-0-0/b BIT         r     1 LPSTAT(0:3)
     0-0-0/b BIT         r     1 RETRY_FLG

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ASTR        r     1 TEXTM


   Procedure LPCU requires 255 words for executable code.
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:250  
   Procedure LPCU requires 10 words of local(AUTO) storage.
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:251  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:252  
          MINI XREF LISTING

ANALZ_STAT
      1392**LABEL    1382--GOTO
ANSBUF
      1372**DCL      1430<>CALL
ANSBUF.TXT
      1374**DCL      1431>>DOSELCT
ASK
      1430**LABEL    1451--GOTO
DEVINFO.BITS
      1298**DCL      1444<<ASSIGN
DEVINFO.BSTAT.W1
      1336**DCL      1382>>IF
DEVINFO.DEVNAME
      1342**DCL      1423>>ASSIGN   1428>>ASSIGN   1456>>ASSIGN
DEVINFO.PCWS
      1299**DCL      1310--REDEF
DEVINFO.RPM_PTRS.EF_DCWS$
      1312**DCL      1313--REDEF
DEVINFO.STATUS
      1316**DCL      1335--REDEF    1425<>CALL
DEVINFO.STATUS.MAJ_STAT
      1319**DCL      1392>>DOSELCT
DEVINFO.STATUS.SUB_STAT
      1320**DCL      1394>>DOSELCT  1414>>DOSELCT
ERR_RET
      1446**LABEL    1398--CALLALT  1404--GOTO     1411--GOTO     1433--CALLALT  1438--CALLALT
I
      1368**DCL      1399<<DOINDEX  1434<<DOINDEX  1439<<DOINDEX
INDX
      1282**DCL         6--PROC     1382>>IF       1392>>DOSELCT  1394>>DOSELCT  1398<>CALL     1414>>DOSELCT
      1423>>ASSIGN   1425>>CALL     1428>>ASSIGN   1433<>CALL     1438<>CALL     1444>>ASSIGN   1456>>ASSIGN
KEYIN
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:253  
      1380**DCL-ENT  1430--CALL
LPCU2
      1422**LABEL    1418--GOTO
LPCUX
      1455**LABEL    1390--GOTO
LPHM
      1362**DCL      1427--ASSIGN   1430<>CALL
LPHMX
      1353**DCL      1455--ASSIGN   1457<>CALL
LPHMY
      1358**DCL      1422--ASSIGN   1424<>CALL
LPINIT
      1375**DCL-ENT  1398--CALL
LPSTAT
      1371**DCL      1385>>IF
MESSAGE$
      1363**DCL      1364--IMP-PTR  1422<<ASSIGN   1423>>ASSIGN   1423>>ASSIGN   1427<<ASSIGN   1428>>ASSIGN
      1428>>ASSIGN   1455<<ASSIGN   1456>>ASSIGN   1456>>ASSIGN
NORM_RET
      1387**LABEL    1406--GOTO     1458--GOTO
NRETRY
      1462**LABEL    1403--GOTO     1410--GOTO
RETR#
      1367**DCL      1387<<ASSIGN   1402<<ASSIGN   1402>>ASSIGN   1403>>IF       1409<<ASSIGN   1409>>ASSIGN
      1410>>IF       1446<<ASSIGN   1460<<ASSIGN
RETR4
      1409**LABEL    1416--GOTO
RETRY
      1460**LABEL    1396--GOTO     1436--GOTO     1441--GOTO     1449--GOTO
RETRY_FLG
      1370**DCL      1462<<ASSIGN
SET_TRAIN5
      1376**DCL-ENT  1433--CALL
SET_TRAIN6
      1377**DCL-ENT  1438--CALL
TEXTM.CNT
PL6.E3A0      #007=LPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:254  
      1365**DCL      1366--IMP-SIZ  1423>>ASSIGN   1428>>ASSIGN   1456>>ASSIGN
TEXTM.TXT
      1366**DCL      1423<<ASSIGN   1428<<ASSIGN   1456<<ASSIGN
TYPEC
      1378**DCL-ENT  1424--CALL     1457--CALL
TYPEST
      1379**DCL-ENT  1425--CALL

PL6.E3A0      #008=MTIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:255  
     1219        1        /*T***********************************************************/
     1220        2        /*T*                                                         */
     1221        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1222        4        /*T*                                                         */
     1223        5        /*T***********************************************************/
     1224        6        MTIO:   PROC;
     1225        7    1   DCL INDX UBIN WORD;
     1226        8    1   DCL CODE UBIN WORD;
     1227        9    1   DCL PSI_FLG BIT(1) SYMREF;
     1228       10        /**/
     1229       11    1           PSI_FLG='1'B;                   /* Set PSI interface                  */
     1230       12    1           RETURN;
     1231       13    1   END MTIO;
     1232       14        %EOD;

PL6.E3A0      #008=MTIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:256  
      No diagnostics issued in procedure MTIO.

   Procedure MTIO requires 5 words for executable code.
   Procedure MTIO requires 6 words of local(AUTO) storage.

PL6.E3A0      #008=MTIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:257  

 Object Unit name= MTIO                                       File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:52:55.40 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none     5      5  MTIO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        0  MTIO

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     PSI_FLG
PL6.E3A0      #008=MTIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:258  


     1219        1        /*T***********************************************************/
     1220        2        /*T*                                                         */
     1221        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1222        4        /*T*                                                         */
     1223        5        /*T***********************************************************/
     1224        6        MTIO:   PROC;

      6  0 000000   000000 700200 xent  MTIO         TSX0  ! X66_AUTO_0
         0 000001   000006 000000                    ZERO    6,0

     1225        7    1   DCL INDX UBIN WORD;
     1226        8    1   DCL CODE UBIN WORD;
     1227        9    1   DCL PSI_FLG BIT(1) SYMREF;
     1228       10        /**/
     1229       11    1           PSI_FLG='1'B;                   /* Set PSI interface                  */

     11  0 000002   400000 236003                    LDQ     -131072,DU
         0 000003   000000 756000 xsym               STQ     PSI_FLG

     1230       12    1           RETURN;

     12  0 000004   000000 702200 xent               TSX2  ! X66_ARET
     1231       13    1   END MTIO;
     1232       14        %EOD;

PL6.E3A0      #008=MTIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:259  
      No diagnostics issued in procedure MTIO.
PL6.E3A0      #008=MTIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:260  

 **** Variables and constants ****

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 PSI_FLG


   Procedure MTIO requires 5 words for executable code.
   Procedure MTIO requires 6 words of local(AUTO) storage.
PL6.E3A0      #008=MTIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:261  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #008=MTIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:262  
          MINI XREF LISTING

PSI_FLG
         9**DCL        11<<ASSIGN

PL6.E3A0      #009=MTCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:263  
     1233        1        /*T***********************************************************/
     1234        2        /*T*                                                         */
     1235        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1236        4        /*T*                                                         */
     1237        5        /*T***********************************************************/
     1238        6        MTCU:   PROC(INDX,CODE) ALTRET;
     1239        7        %INCLUDE IS$MACROS;
     1240     1282    1   DCL INDX UBIN WORD;
     1241     1283    1   DCL CODE UBIN WORD;
     1242     1284    1   DCL RETRY_FLG BIT(1) SYMREF;
     1243     1285        %DEVINFO(STCLASS="SYMREF");
     1244     1354        %TEXTC(N#=MTM,M#="' Error on tape drive X-XXX-XX.'");
     1245     1359    1   DCL MESSAGE$ PTR;
     1246     1360    1   DCL 1 TEXTM BASED(MESSAGE$),
     1247     1361    1         2 CNT UBIN WORD,
     1248     1362    1         2 TXT CHAR(TEXTM.CNT);
     1249     1363        /**/
     1250     1364    1   DCL TYPEC ENTRY(1);
     1251     1365    1   DCL TYPEST ENTRY(1);
     1252     1366        /**/
     1253     1367    1           IF (DEVINFO.BSTAT.W1(INDX)&'770005777'O)='4'O OR
     1254     1368    1             (DEVINFO.BSTAT.W1(INDX)&'770005777'O)='44'O THEN RETURN;
              1368                      /*Ready status or EOF */
     1255     1369    1             ELSE;
     1256     1370    1           IF (DEVINFO.BSTAT.W1(INDX)&'770005777'O)='41'O THEN GOTO RETRY;
              1370                    /* Busy,probably rewinding */
     1257     1371    1             ELSE;
     1258     1372    1           IF(CODE=%FCNUNL OR CODE=%FCNSDT8 OR CODE=%FCNSDT16 OR CODE = %FCNSDT62)THEN
              1372                    ALTRETURN; /* Unload or set density code */
     1259     1373    1             ELSE;
     1260     1374        /* Build message */
     1261     1375    2           IF (DEVINFO.BSTAT.W1(INDX) & '777700'O) ~= '5210'O THEN DO;
     1262     1376    2                 MESSAGE$=ADDR(MTM);
     1263     1377    2                 SUBSTR(TEXTM.TXT,21,8)=DEVINFO.DEVNAME(INDX);
     1264     1378    2                 CALL TYPEC(MTM);
     1265     1379    2                 CALL TYPEST(DEVINFO.STATUS(INDX));
     1266     1380    2               END;
PL6.E3A0      #009=MTCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:264  
     1267     1381    1           ALTRETURN;
     1268     1382    1   RETRY:
     1269     1383    1           RETRY_FLG='1'B;
     1270     1384    1           ALTRETURN;
     1271     1385    1   END MTCU;
     1272     1386        %EOD;

PL6.E3A0      #009=MTCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:265  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure MTCU.

   Procedure MTCU requires 74 words for executable code.
   Procedure MTCU requires 8 words of local(AUTO) storage.

PL6.E3A0      #009=MTCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:266  

 Object Unit name= MTCU                                       File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:52:56.56 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     9     11  MTCU
    1  RoData even  UTS      1      1  MTCU
    2   Proc  even  none    74    112  MTCU
    3  RoData even  none     2      2  MTCU

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        2  MTCU

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  MTM

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 TYPEC
         yes           Std       1 TYPEST
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
                       Std       0 B_CONSPOOL_D
PL6.E3A0      #009=MTCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:267  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     RETRY_FLG                             DEVINFO                               B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #009=MTCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:268  


     1233        1        /*T***********************************************************/
     1234        2        /*T*                                                         */
     1235        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1236        4        /*T*                                                         */
     1237        5        /*T***********************************************************/
     1238        6        MTCU:   PROC(INDX,CODE) ALTRET;

      6  2 000000   000000 700200 xent  MTCU         TSX0  ! X66_AUTO_2
         2 000001   000010 000002                    ZERO    8,2

     1239        7        %INCLUDE IS$MACROS;
     1240     1282    1   DCL INDX UBIN WORD;
     1241     1283    1   DCL CODE UBIN WORD;
     1242     1284    1   DCL RETRY_FLG BIT(1) SYMREF;
     1243     1285        %DEVINFO(STCLASS="SYMREF");
     1244     1354        %TEXTC(N#=MTM,M#="' Error on tape drive X-XXX-XX.'");
     1245     1359    1   DCL MESSAGE$ PTR;
     1246     1360    1   DCL 1 TEXTM BASED(MESSAGE$),
     1247     1361    1         2 CNT UBIN WORD,
     1248     1362    1         2 TXT CHAR(TEXTM.CNT);
     1249     1363        /**/
     1250     1364    1   DCL TYPEC ENTRY(1);
     1251     1365    1   DCL TYPEST ENTRY(1);
     1252     1366        /**/
     1253     1367    1           IF (DEVINFO.BSTAT.W1(INDX)&'770005777'O)='4'O OR

   1367  2 000002   200003 470500                    LDP0    @INDX,,AUTO
         2 000003   000000 236100                    LDQ     0,,PR0
         2 000004   000006 402007                    MPY     6,DL
         2 000005   000001 736000                    QLS     1
         2 000006   000000 620006                    EAX0    0,QL
         2 000007   000000 236000 1                  LDQ     0
         2 000010   000004 376010 xsym               ANQ     DEVINFO+4,X0
         2 000011   400000 116003                    CMPQ    -131072,DU
         2 000012   000023 600000 2                  TZE     s:1368
         2 000013   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #009=MTCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:269  
         2 000014   000006 402007                    MPY     6,DL
         2 000015   000001 736000                    QLS     1
         2 000016   000000 620006                    EAX0    0,QL
         2 000017   000000 236000 1                  LDQ     0
         2 000020   000004 376010 xsym               ANQ     DEVINFO+4,X0
         2 000021   440000 116003                    CMPQ    -114688,DU
         2 000022   000024 601000 2                  TNZ     s:1370

     1254     1368    1             (DEVINFO.BSTAT.W1(INDX)&'770005777'O)='44'O THEN RETURN;
              1368                      /*Ready status or EOF */

   1368  2 000023   000000 702200 xent               TSX2  ! X66_ARET

     1255     1369    1             ELSE;
     1256     1370    1           IF (DEVINFO.BSTAT.W1(INDX)&'770005777'O)='41'O THEN GOTO RETRY;
              1370                    /* Busy,probably rewinding */

   1370  2 000024   000000 236100                    LDQ     0,,PR0
         2 000025   000006 402007                    MPY     6,DL
         2 000026   000001 736000                    QLS     1
         2 000027   000000 620006                    EAX0    0,QL
         2 000030   000000 236000 1                  LDQ     0
         2 000031   000004 376010 xsym               ANQ     DEVINFO+4,X0
         2 000032   410000 116003                    CMPQ    -126976,DU
         2 000033   000107 600000 2                  TZE     RETRY

     1257     1371    1             ELSE;
     1258     1372    1           IF(CODE=%FCNUNL OR CODE=%FCNSDT8 OR CODE=%FCNSDT16 OR CODE = %FCNSDT62)THEN
              1372                    ALTRETURN; /* Unload or set density code */

   1372  2 000034   200004 471500                    LDP1    @CODE,,AUTO
         2 000035   100000 235100                    LDA     0,,PR1
         2 000036   000011 115007                    CMPA    9,DL
         2 000037   000046 600000 2                  TZE     s:1372+10
         2 000040   000006 115007                    CMPA    6,DL
         2 000041   000046 600000 2                  TZE     s:1372+10
         2 000042   000007 115007                    CMPA    7,DL
PL6.E3A0      #009=MTCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:270  
         2 000043   000046 600000 2                  TZE     s:1372+10
         2 000044   000017 115007                    CMPA    15,DL
         2 000045   000047 601000 2                  TNZ     s:1375

   1372  2 000046   000000 702200 xent               TSX2  ! X66_AALT

     1259     1373    1             ELSE;
     1260     1374        /* Build message */
     1261     1375    2           IF (DEVINFO.BSTAT.W1(INDX) & '777700'O) ~= '5210'O THEN DO;

   1375  2 000047   000000 236100                    LDQ     0,,PR0
         2 000050   000006 402007                    MPY     6,DL
         2 000051   000001 736000                    QLS     1
         2 000052   000004 236006 xsym               LDQ     DEVINFO+4,QL
         2 000053   777700 376003                    ANQ     -64,DU
         2 000054   521000 116003                    CMPQ    -89600,DU
         2 000055   000106 600000 2                  TZE     s:1381

     1262     1376    2                 MESSAGE$=ADDR(MTM);

   1376  2 000056   000000 236000 3                  LDQ     0
         2 000057   200005 756100                    STQ     MESSAGE$,,AUTO

     1263     1377    2                 SUBSTR(TEXTM.TXT,21,8)=DEVINFO.DEVNAME(INDX);

   1377  2 000060   200005 473500                    LDP3    MESSAGE$,,AUTO
         2 000061   300000 720100                    LXL0    0,,PR3
         2 000062   000000 236100                    LDQ     0,,PR0
         2 000063   000006 402007                    MPY     6,DL
         2 000064   000003 736000                    QLS     3
         2 000065   040100 100406                    MLR     fill='040'O
         2 000066   000006 000010 xsym               ADSC9   DEVINFO+6,Q              cn=0,n=8
         2 000067   300006 200010                    ADSC9   6,,PR3                   cn=1,n=8

     1264     1378    2                 CALL TYPEC(MTM);

   1378  2 000070   000000 630400 3                  EPPR0   0
PL6.E3A0      #009=MTCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:271  
         2 000071   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000072   000000 701000 xent               TSX1    TYPEC
         2 000073   000000 011000                    NOP     0

     1265     1379    2                 CALL TYPEST(DEVINFO.STATUS(INDX));

   1379  2 000074   200003 470500                    LDP0    @INDX,,AUTO
         2 000075   000000 236100                    LDQ     0,,PR0
         2 000076   000006 402007                    MPY     6,DL
         2 000077   000023 736000                    QLS     19
         2 000100   000001 036000 3                  ADLQ    1
         2 000101   200006 756100                    STQ     MESSAGE$+1,,AUTO
         2 000102   200006 630500                    EPPR0   MESSAGE$+1,,AUTO
         2 000103   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000104   000000 701000 xent               TSX1    TYPEST
         2 000105   000000 011000                    NOP     0

     1266     1380    2               END;

     1267     1381    1           ALTRETURN;

   1381  2 000106   000000 702200 xent               TSX2  ! X66_AALT

     1268     1382    1   RETRY:
     1269     1383    1           RETRY_FLG='1'B;

   1383  2 000107   400000 236003       RETRY        LDQ     -131072,DU
         2 000110   000000 756000 xsym               STQ     RETRY_FLG

     1270     1384    1           ALTRETURN;

   1384  2 000111   000000 702200 xent               TSX2  ! X66_AALT
     1271     1385    1   END MTCU;
     1272     1386        %EOD;

PL6.E3A0      #009=MTCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:272  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure MTCU.
PL6.E3A0      #009=MTCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:273  

 **** Variables and constants ****

  ****  Section 000  Data  MTCU

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(306)   r     1 MTM

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @CODE                      3-0-0/w PTR         r     1 @INDX
    *0-0-0/w UBIN        r     1 CODE                      *0-0-0/w UBIN        r     1 INDX
     5-0-0/w PTR         r     1 MESSAGE$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(396)   r     1 DEVINFO(0:21)              0-0-0/b BIT         r     1 RETRY_FLG

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ASTR        r     1 TEXTM


   Procedure MTCU requires 74 words for executable code.
   Procedure MTCU requires 8 words of local(AUTO) storage.
PL6.E3A0      #009=MTCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:274  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #009=MTCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:52 Page:275  
          MINI XREF LISTING

CODE
      1283**DCL         6--PROC     1372>>IF       1372>>IF       1372>>IF       1372>>IF
DEVINFO.BSTAT.W1
      1338**DCL      1367>>IF       1367>>IF       1370>>IF       1375>>IF
DEVINFO.DEVNAME
      1344**DCL      1377>>ASSIGN
DEVINFO.PCWS
      1301**DCL      1312--REDEF
DEVINFO.RPM_PTRS.EF_DCWS$
      1314**DCL      1315--REDEF
DEVINFO.STATUS
      1318**DCL      1337--REDEF    1379<>CALL
INDX
      1282**DCL         6--PROC     1367>>IF       1367>>IF       1370>>IF       1375>>IF       1377>>ASSIGN
      1379>>CALL
MESSAGE$
      1359**DCL      1360--IMP-PTR  1376<<ASSIGN   1377>>ASSIGN   1377>>ASSIGN
MTM
      1355**DCL      1376--ASSIGN   1378<>CALL
RETRY
      1383**LABEL    1370--GOTO
RETRY_FLG
      1284**DCL      1383<<ASSIGN
TEXTM.CNT
      1361**DCL      1362--IMP-SIZ  1377>>ASSIGN
TEXTM.TXT
      1362**DCL      1377<<ASSIGN
TYPEC
      1364**DCL-ENT  1378--CALL
TYPEST
      1365**DCL-ENT  1379--CALL

PL6.E3A0      #010=DPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:276  
     1273        1        /*T***********************************************************/
     1274        2        /*T*                                                         */
     1275        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1276        4        /*T*                                                         */
     1277        5        /*T***********************************************************/
     1278        6        DPIO:   PROC(INDX,CODE,GRAN#);
     1279        7        %INCLUDE IS$MACROS;
     1280     1282    1   DCL INDX UBIN WORD;
     1281     1283    1   DCL CODE UBIN WORD;
     1282     1284    1   DCL GRAN# UBIN WORD;
     1283     1285    1   DCL PSI_FLG BIT(1) SYMREF;
     1284     1286    1   DCL DISK_FLG BIT(1) STATIC SYMDEF INIT('0'B);
     1285     1287    1   DCL SKIDCW BIT(36) ALIGNED STATIC SYMDEF INIT('34000002'O);
              1287            /* Seek IDCW with continue */
     1286     1288    1   DCL SKADD$ PTR STATIC INIT(ADDR(SKADD));
     1287     1289        %PTR_STRUCT(NAME=SKADD_PTR,STCLASS="REDEF SKADD$");
     1288     1307        %DCW_STRUCT(NAME=SKDCW);
     1289     1325    1   DCL SKADD UBIN WORD STATIC INIT(0);     /* Seek address                       */
     1290     1326    1   DCL NSPG(0:%(DIM-FRSTDP-1)) UBIN(18) SYMREF; /* Nr of sectors/granule         */
     1291     1327    1   DCL TYPEC ENTRY(1);
     1292     1328        /**/
     1293     1329    1           SKDCW.AD=SKADD_PTR.WOFFS;       /* Build seek DCW                     */
     1294     1330    1           SKDCW.TALLY=1;
     1295     1331    1           SKADD=GRAN#*NSPG(INDX-%FRSTDP); /* Seek address                       */
     1296     1332    1           DISK_FLG='1'B;
     1297     1333    1           PSI_FLG='1'B;
     1298     1334    1           RETURN;
     1299     1335    1   END DPIO;
     1300     1336        %EOD;

PL6.E3A0      #010=DPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:277  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure DPIO.

   Procedure DPIO requires 17 words for executable code.
   Procedure DPIO requires 6 words of local(AUTO) storage.

PL6.E3A0      #010=DPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:278  

 Object Unit name= DPIO                                       File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:53:00.08 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     5      5  DPIO
    1   Proc  even  none    17     21  DPIO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        3  DPIO

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  DISK_FLG                           0      1  SKIDCW
    0      3  SKDCW

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET
PL6.E3A0      #010=DPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:279  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     PSI_FLG                               NSPG

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #010=DPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:280  


     1273        1        /*T***********************************************************/
     1274        2        /*T*                                                         */
     1275        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1276        4        /*T*                                                         */
     1277        5        /*T***********************************************************/
     1278        6        DPIO:   PROC(INDX,CODE,GRAN#);

      6  1 000000   000000 700200 xent  DPIO         TSX0  ! X66_AUTO_3
         1 000001   000006 000003                    ZERO    6,3

     1279        7        %INCLUDE IS$MACROS;
     1280     1282    1   DCL INDX UBIN WORD;
     1281     1283    1   DCL CODE UBIN WORD;
     1282     1284    1   DCL GRAN# UBIN WORD;
     1283     1285    1   DCL PSI_FLG BIT(1) SYMREF;
     1284     1286    1   DCL DISK_FLG BIT(1) STATIC SYMDEF INIT('0'B);
     1285     1287    1   DCL SKIDCW BIT(36) ALIGNED STATIC SYMDEF INIT('34000002'O);
              1287            /* Seek IDCW with continue */
     1286     1288    1   DCL SKADD$ PTR STATIC INIT(ADDR(SKADD));
     1287     1289        %PTR_STRUCT(NAME=SKADD_PTR,STCLASS="REDEF SKADD$");
     1288     1307        %DCW_STRUCT(NAME=SKDCW);
     1289     1325    1   DCL SKADD UBIN WORD STATIC INIT(0);     /* Seek address                       */
     1290     1326    1   DCL NSPG(0:%(DIM-FRSTDP-1)) UBIN(18) SYMREF; /* Nr of sectors/granule         */
     1291     1327    1   DCL TYPEC ENTRY(1);
     1292     1328        /**/
     1293     1329    1           SKDCW.AD=SKADD_PTR.WOFFS;       /* Build seek DCW                     */

   1329  1 000002   000002 220000 0                  LDX0    SKADD$
         1 000003   000003 740000 0                  STX0    SKDCW

     1294     1330    1           SKDCW.TALLY=1;

   1330  1 000004   000001 236007                    LDQ     1,DL
         1 000005   000003 752003 0                  STCQ    SKDCW,'03'O

     1295     1331    1           SKADD=GRAN#*NSPG(INDX-%FRSTDP); /* Seek address                       */
PL6.E3A0      #010=DPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:281  

   1331  1 000006   200003 470500                    LDP0    @INDX,,AUTO
         1 000007   000000 721100                    LXL1    0,,PR0
         1 000010   200005 471500                    LDP1    @GRAN#,,AUTO
         1 000011   777754 236011 xsym               LDQ     NSPG-20,X1
         1 000012   000022 772000                    QRL     18
         1 000013   100000 402100                    MPY     0,,PR1
         1 000014   000004 756000 0                  STQ     SKADD

     1296     1332    1           DISK_FLG='1'B;

   1332  1 000015   400000 236003                    LDQ     -131072,DU
         1 000016   000000 756000 0                  STQ     DISK_FLG

     1297     1333    1           PSI_FLG='1'B;

   1333  1 000017   000000 756000 xsym               STQ     PSI_FLG

     1298     1334    1           RETURN;

   1334  1 000020   000000 702200 xent               TSX2  ! X66_ARET
     1299     1335    1   END DPIO;
     1300     1336        %EOD;

PL6.E3A0      #010=DPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:282  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure DPIO.
PL6.E3A0      #010=DPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:283  

 **** Variables and constants ****

  ****  Section 000  Data  DPIO

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 DISK_FLG                   4-0-0/w UBIN        r     1 SKADD
     2-0-0/w PTR         r     1 SKADD$                     2-0-0/w STRC        r     1 SKADD_PTR
     3-0-0/w STRC        r     1 SKDCW

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @CODE                      5-0-0/w PTR         r     1 @GRAN#
     3-0-0/w PTR         r     1 @INDX                     *0-0-0/w UBIN        r     1 CODE
    *0-0-0/w UBIN        r     1 GRAN#                     *0-0-0/w UBIN        r     1 INDX

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN(18)    r     1 NSPG(0:1)                  0-0-0/b BIT         r     1 PSI_FLG


   Procedure DPIO requires 17 words for executable code.
   Procedure DPIO requires 6 words of local(AUTO) storage.
PL6.E3A0      #010=DPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:284  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #010=DPIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:285  
          MINI XREF LISTING

CODE
      1283**DCL         6--PROC
DISK_FLG
      1286**DCL      1332<<ASSIGN
GRAN#
      1284**DCL         6--PROC     1331>>ASSIGN
INDX
      1282**DCL         6--PROC     1331>>ASSIGN
NSPG
      1326**DCL      1331>>ASSIGN
PSI_FLG
      1285**DCL      1333<<ASSIGN
SKADD
      1325**DCL      1288--DCLINIT  1331<<ASSIGN
SKADD$
      1288**DCL      1300--REDEF
SKADD_PTR.WOFFS
      1301**DCL      1329>>ASSIGN
SKDCW.AD
      1318**DCL      1329<<ASSIGN
SKDCW.TALLY
      1322**DCL      1330<<ASSIGN

PL6.E3A0      #011=DPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:286  
     1301        1        /*T***********************************************************/
     1302        2        /*T*                                                         */
     1303        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1304        4        /*T*                                                         */
     1305        5        /*T***********************************************************/
     1306        6        DPCU:   PROC(INDX) ALTRET;
     1307        7        %INCLUDE IS$MACROS;
     1308     1282        %DEVINFO(STCLASS="SYMREF");
     1309     1351        %TEXTC(N#=DPM,M#="' Error on disk drive X-XXX-XX. '");
     1310     1356    1   DCL MESSAGE$ PTR;
     1311     1357    1   DCL 1 TEXTM BASED(MESSAGE$),
     1312     1358    1         2 CNT UBIN WORD,
     1313     1359    1         2 TXT CHAR(TEXTM.CNT);
     1314     1360    1   DCL INDX UBIN WORD;
     1315     1361    1   DCL CODE UBIN WORD;
     1316     1362    1   DCL DISK_FLG BIT(1) SYMREF;
     1317     1363    1   DCL TYPEC ENTRY(1);
     1318     1364    1   DCL TYPEST ENTRY(1);
     1319     1365        /**/
     1320     1366    1           DISK_FLG='0'B;
     1321     1367    1           IF(DEVINFO.BSTAT.W1(INDX)&%STATUS_MASK)=%TERM_STATUS THEN RETURN;
     1322     1368    1             ELSE;
     1323     1369    1           MESSAGE$=ADDR(DPM);
     1324     1370    1           CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(INDX),0,1),DEVINFO.IOM#(INDX));
     1325     1371    1           CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(INDX),2,3),DEVINFO.CHN#(INDX));
     1326     1372    1           CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(INDX),6,2),DEVINFO.DEV#(INDX));
     1327     1373    1           SUBSTR(TEXTM.TXT,21,8)=DEVINFO.DEVNAME(INDX);
     1328     1374    1           CALL TYPEC(DPM);
     1329     1375    1           CALL TYPEST(DEVINFO.STATUS(INDX));
     1330     1376    1           ALTRETURN;
     1331     1377    1   END DPCU;
     1332     1378        %EOD;

PL6.E3A0      #011=DPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:287  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure DPCU.

   Procedure DPCU requires 85 words for executable code.
   Procedure DPCU requires 10 words of local(AUTO) storage.

PL6.E3A0      #011=DPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:288  

 Object Unit name= DPCU                                       File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:53:02.88 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     9     11  DPCU
    1  RoData even  UTS      1      1  DPCU
    2   Proc  even  none    85    125  DPCU
    3  RoData even  none     2      2  DPCU

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  DPCU

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  DPM

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 TYPEC
         yes           Std       1 TYPEST
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
PL6.E3A0      #011=DPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:289  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DEVINFO                               DISK_FLG                              B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #011=DPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:290  


     1301        1        /*T***********************************************************/
     1302        2        /*T*                                                         */
     1303        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1304        4        /*T*                                                         */
     1305        5        /*T***********************************************************/
     1306        6        DPCU:   PROC(INDX) ALTRET;

      6  2 000000   000000 700200 xent  DPCU         TSX0  ! X66_AUTO_1
         2 000001   000012 000001                    ZERO    10,1

     1307        7        %INCLUDE IS$MACROS;
     1308     1282        %DEVINFO(STCLASS="SYMREF");
     1309     1351        %TEXTC(N#=DPM,M#="' Error on disk drive X-XXX-XX. '");
     1310     1356    1   DCL MESSAGE$ PTR;
     1311     1357    1   DCL 1 TEXTM BASED(MESSAGE$),
     1312     1358    1         2 CNT UBIN WORD,
     1313     1359    1         2 TXT CHAR(TEXTM.CNT);
     1314     1360    1   DCL INDX UBIN WORD;
     1315     1361    1   DCL CODE UBIN WORD;
     1316     1362    1   DCL DISK_FLG BIT(1) SYMREF;
     1317     1363    1   DCL TYPEC ENTRY(1);
     1318     1364    1   DCL TYPEST ENTRY(1);
     1319     1365        /**/
     1320     1366    1           DISK_FLG='0'B;

   1366  2 000002   000000 450000 xsym               STZ     DISK_FLG

     1321     1367    1           IF(DEVINFO.BSTAT.W1(INDX)&%STATUS_MASK)=%TERM_STATUS THEN RETURN;

   1367  2 000003   200003 470500                    LDP0    @INDX,,AUTO
         2 000004   000000 236100                    LDQ     0,,PR0
         2 000005   000006 402007                    MPY     6,DL
         2 000006   000001 736000                    QLS     1
         2 000007   000000 620006                    EAX0    0,QL
         2 000010   000000 236000 1                  LDQ     0
         2 000011   000004 376010 xsym               ANQ     DEVINFO+4,X0
PL6.E3A0      #011=DPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:291  
         2 000012   400000 116003                    CMPQ    -131072,DU
         2 000013   000015 601000 2                  TNZ     s:1369

   1367  2 000014   000000 702200 xent               TSX2  ! X66_ARET

     1322     1368    1             ELSE;
     1323     1369    1           MESSAGE$=ADDR(DPM);

   1369  2 000015   000000 236000 3                  LDQ     0
         2 000016   200004 756100                    STQ     MESSAGE$,,AUTO

     1324     1370    1           CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(INDX),0,1),DEVINFO.IOM#(INDX));

   1370  2 000017   000000 236100                    LDQ     0,,PR0
         2 000020   000006 402007                    MPY     6,DL
         2 000021   000000 620006                    EAX0    0,QL
         2 000022   000003 736000                    QLS     3
         2 000023   000000 635010                    EAA     0,X0
         2 000024   000021 771000                    ARL     17
         2 000025   200006 756100                    STQ     MESSAGE$+2,,AUTO
         2 000026   000000 236005 xsym               LDQ     DEVINFO,AL
         2 000027   000023 772000                    QRL     19
         2 000030   000003 376007                    ANQ     3,DL
         2 000031   000000 235003                    LDA     0,DU
         2 000032   200010 757100                    STAQ    MESSAGE$+4,,AUTO
         2 000033   200006 235100                    LDA     MESSAGE$+2,,AUTO
         2 000034   000005 301500                    BTD
         2 000035   200010 000010                    NDSC9   MESSAGE$+4,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         2 000036   000006 030001 xsym               NDSC9   DEVINFO+6,A              cn=0,s=nosgn,sf=0,n=1

     1325     1371    1           CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(INDX),2,3),DEVINFO.CHN#(INDX));

   1371  2 000037   000000 236100                    LDQ     0,,PR0
         2 000040   000006 402007                    MPY     6,DL
         2 000041   000000 620006                    EAX0    0,QL
         2 000042   000003 736000                    QLS     3
         2 000043   000000 635010                    EAA     0,X0
PL6.E3A0      #011=DPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:292  
         2 000044   000021 771000                    ARL     17
         2 000045   200006 756100                    STQ     MESSAGE$+2,,AUTO
         2 000046   000000 236005 xsym               LDQ     DEVINFO,AL
         2 000047   000033 772000                    QRL     27
         2 000050   000000 235003                    LDA     0,DU
         2 000051   200010 757100                    STAQ    MESSAGE$+4,,AUTO
         2 000052   200006 235100                    LDA     MESSAGE$+2,,AUTO
         2 000053   000005 301500                    BTD
         2 000054   200010 000010                    NDSC9   MESSAGE$+4,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         2 000055   000006 430003 xsym               NDSC9   DEVINFO+6,A              cn=2,s=nosgn,sf=0,n=3

     1326     1372    1           CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(INDX),6,2),DEVINFO.DEV#(INDX));

   1372  2 000056   000000 236100                    LDQ     0,,PR0
         2 000057   000006 402007                    MPY     6,DL
         2 000060   000000 620006                    EAX0    0,QL
         2 000061   000003 736000                    QLS     3
         2 000062   000000 635010                    EAA     0,X0
         2 000063   000021 771000                    ARL     17
         2 000064   200006 756100                    STQ     MESSAGE$+2,,AUTO
         2 000065   000000 236005 xsym               LDQ     DEVINFO,AL
         2 000066   000025 772000                    QRL     21
         2 000067   000077 376007                    ANQ     63,DL
         2 000070   000000 235003                    LDA     0,DU
         2 000071   200010 757100                    STAQ    MESSAGE$+4,,AUTO
         2 000072   200006 235100                    LDA     MESSAGE$+2,,AUTO
         2 000073   000005 301500                    BTD
         2 000074   200010 000010                    NDSC9   MESSAGE$+4,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         2 000075   000007 430002 xsym               NDSC9   DEVINFO+7,A              cn=2,s=nosgn,sf=0,n=2

     1327     1373    1           SUBSTR(TEXTM.TXT,21,8)=DEVINFO.DEVNAME(INDX);

   1373  2 000076   200004 471500                    LDP1    MESSAGE$,,AUTO
         2 000077   100000 720100                    LXL0    0,,PR1
         2 000100   000000 236100                    LDQ     0,,PR0
         2 000101   000006 402007                    MPY     6,DL
         2 000102   000003 736000                    QLS     3
PL6.E3A0      #011=DPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:293  
         2 000103   040100 100406                    MLR     fill='040'O
         2 000104   000006 000010 xsym               ADSC9   DEVINFO+6,Q              cn=0,n=8
         2 000105   100006 200010                    ADSC9   6,,PR1                   cn=1,n=8

     1328     1374    1           CALL TYPEC(DPM);

   1374  2 000106   000000 630400 3                  EPPR0   0
         2 000107   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000110   000000 701000 xent               TSX1    TYPEC
         2 000111   000000 011000                    NOP     0

     1329     1375    1           CALL TYPEST(DEVINFO.STATUS(INDX));

   1375  2 000112   200003 470500                    LDP0    @INDX,,AUTO
         2 000113   000000 236100                    LDQ     0,,PR0
         2 000114   000006 402007                    MPY     6,DL
         2 000115   000023 736000                    QLS     19
         2 000116   000001 036000 3                  ADLQ    1
         2 000117   200006 756100                    STQ     MESSAGE$+2,,AUTO
         2 000120   200006 630500                    EPPR0   MESSAGE$+2,,AUTO
         2 000121   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000122   000000 701000 xent               TSX1    TYPEST
         2 000123   000000 011000                    NOP     0

     1330     1376    1           ALTRETURN;

   1376  2 000124   000000 702200 xent               TSX2  ! X66_AALT
     1331     1377    1   END DPCU;
     1332     1378        %EOD;

PL6.E3A0      #011=DPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:294  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure DPCU.
PL6.E3A0      #011=DPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:295  

 **** Variables and constants ****

  ****  Section 000  Data  DPCU

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(315)   r     1 DPM

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @INDX                     *0-0-0/w UBIN        r     1 INDX
     4-0-0/w PTR         r     1 MESSAGE$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(396)   r     1 DEVINFO(0:21)              0-0-0/b BIT         r     1 DISK_FLG

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ASTR        r     1 TEXTM


   Procedure DPCU requires 85 words for executable code.
   Procedure DPCU requires 10 words of local(AUTO) storage.
PL6.E3A0      #011=DPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:296  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #011=DPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:297  
          MINI XREF LISTING

DEVINFO.BSTAT.W1
      1335**DCL      1367>>IF
DEVINFO.CHN#
      1294**DCL      1371>>CALLBLT
DEVINFO.DEV#
      1295**DCL      1372>>CALLBLT
DEVINFO.DEVNAME
      1341**DCL      1370<<CALLBLT  1371<<CALLBLT  1372<<CALLBLT  1373>>ASSIGN
DEVINFO.IOM#
      1296**DCL      1370>>CALLBLT
DEVINFO.PCWS
      1298**DCL      1309--REDEF
DEVINFO.RPM_PTRS.EF_DCWS$
      1311**DCL      1312--REDEF
DEVINFO.STATUS
      1315**DCL      1334--REDEF    1375<>CALL
DISK_FLG
      1362**DCL      1366<<ASSIGN
DPM
      1352**DCL      1369--ASSIGN   1374<>CALL
INDX
      1360**DCL         6--PROC     1367>>IF       1370>>CALLBLT  1370>>CALLBLT  1371>>CALLBLT  1371>>CALLBLT
      1372>>CALLBLT  1372>>CALLBLT  1373>>ASSIGN   1375>>CALL
MESSAGE$
      1356**DCL      1357--IMP-PTR  1369<<ASSIGN   1373>>ASSIGN   1373>>ASSIGN
TEXTM.CNT
      1358**DCL      1359--IMP-SIZ  1373>>ASSIGN
TEXTM.TXT
      1359**DCL      1373<<ASSIGN
TYPEC
      1363**DCL-ENT  1374--CALL
TYPEST
PL6.E3A0      #011=DPCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:298  
      1364**DCL-ENT  1375--CALL

PL6.E3A0      #012=CRIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:299  
     1333        1        /*T***********************************************************/
     1334        2        /*T*                                                         */
     1335        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1336        4        /*T*                                                         */
     1337        5        /*T***********************************************************/
     1338        6        CRIO:   PROC;
     1339        7    1   DCL PSI_FLG BIT(1) SYMREF;
     1340        8    1           PSI_FLG='1'B;
     1341        9    1           RETURN;
     1342       10    1   END CRIO;
     1343       11        %EOD;

PL6.E3A0      #012=CRIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:300  
      No diagnostics issued in procedure CRIO.

   Procedure CRIO requires 5 words for executable code.
   Procedure CRIO requires 4 words of local(AUTO) storage.

PL6.E3A0      #012=CRIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:301  

 Object Unit name= CRIO                                       File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:53:06.32 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none     5      5  CRIO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        0  CRIO

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     PSI_FLG
PL6.E3A0      #012=CRIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:302  


     1333        1        /*T***********************************************************/
     1334        2        /*T*                                                         */
     1335        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1336        4        /*T*                                                         */
     1337        5        /*T***********************************************************/
     1338        6        CRIO:   PROC;

      6  0 000000   000000 700200 xent  CRIO         TSX0  ! X66_AUTO_0
         0 000001   000004 000000                    ZERO    4,0

     1339        7    1   DCL PSI_FLG BIT(1) SYMREF;
     1340        8    1           PSI_FLG='1'B;

      8  0 000002   400000 236003                    LDQ     -131072,DU
         0 000003   000000 756000 xsym               STQ     PSI_FLG

     1341        9    1           RETURN;

      9  0 000004   000000 702200 xent               TSX2  ! X66_ARET
     1342       10    1   END CRIO;
     1343       11        %EOD;

PL6.E3A0      #012=CRIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:303  
      No diagnostics issued in procedure CRIO.
PL6.E3A0      #012=CRIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:304  

 **** Variables and constants ****

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 PSI_FLG


   Procedure CRIO requires 5 words for executable code.
   Procedure CRIO requires 4 words of local(AUTO) storage.
PL6.E3A0      #012=CRIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:305  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #012=CRIO File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:306  
          MINI XREF LISTING

PSI_FLG
         7**DCL         8<<ASSIGN

PL6.E3A0      #013=CRCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:307  
     1344        1        /*T***********************************************************/
     1345        2        /*T*                                                         */
     1346        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1347        4        /*T*                                                         */
     1348        5        /*T***********************************************************/
     1349        6        CRCU:   PROC(INDX,CODE) ALTRET;
     1350        7        %INCLUDE IS$MACROS;
     1351     1282        %DEVINFO(STCLASS="SYMREF");
     1352     1351        %TEXTC(N#=CRM,M#="' Error reading cards. '");
     1353     1356    1   DCL INDX UBIN WORD;
     1354     1357    1   DCL CODE UBIN WORD;
     1355     1358    1   DCL TYPEC ENTRY(1);
     1356     1359        /**/
     1357     1360    1           IF(DEVINFO.BSTAT.W1(INDX)&%STATUS_MASK)=%TERM_STATUS THEN RETURN;
     1358     1361    1             ELSE;
     1359     1362    2           DO SELECT(DEVINFO.STATUS.MAJ_STAT(INDX));
     1360     1363    2             SELECT('0010'B);              /* Device attention                   */
     1361     1364    2             IF(DEVINFO.STATUS.SUB_STAT(INDX)&'07'O)~='0'B THEN RETURN;
     1362     1365    2               ELSE GOTO CRCU8;
     1363     1366    2             SELECT(ELSE);
     1364     1367    2   CRCU8:
     1365     1368    2           CALL TYPEC(CRM);
     1366     1369    2           ALTRETURN;
     1367     1370    2           END;                            /* DO SELECT                          */
     1368     1371    1   END CRCU;
     1369     1372        %EOD;

PL6.E3A0      #013=CRCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:308  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure CRCU.

   Procedure CRCU requires 34 words for executable code.
   Procedure CRCU requires 6 words of local(AUTO) storage.

PL6.E3A0      #013=CRCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:309  

 Object Unit name= CRCU                                       File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:53:07.48 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     7      7  CRCU
    1  RoData even  UTS      1      1  CRCU
    2   Proc  even  none    34     42  CRCU
    3  RoData even  none     1      1  CRCU

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        2  CRCU

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  CRM

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 TYPEC
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
PL6.E3A0      #013=CRCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:310  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DEVINFO                               B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #013=CRCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:311  


     1344        1        /*T***********************************************************/
     1345        2        /*T*                                                         */
     1346        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1347        4        /*T*                                                         */
     1348        5        /*T***********************************************************/
     1349        6        CRCU:   PROC(INDX,CODE) ALTRET;

      6  2 000000   000000 700200 xent  CRCU         TSX0  ! X66_AUTO_2
         2 000001   000006 000002                    ZERO    6,2

     1350        7        %INCLUDE IS$MACROS;
     1351     1282        %DEVINFO(STCLASS="SYMREF");
     1352     1351        %TEXTC(N#=CRM,M#="' Error reading cards. '");
     1353     1356    1   DCL INDX UBIN WORD;
     1354     1357    1   DCL CODE UBIN WORD;
     1355     1358    1   DCL TYPEC ENTRY(1);
     1356     1359        /**/
     1357     1360    1           IF(DEVINFO.BSTAT.W1(INDX)&%STATUS_MASK)=%TERM_STATUS THEN RETURN;

   1360  2 000002   200003 470500                    LDP0    @INDX,,AUTO
         2 000003   000000 236100                    LDQ     0,,PR0
         2 000004   000006 402007                    MPY     6,DL
         2 000005   000001 736000                    QLS     1
         2 000006   000000 620006                    EAX0    0,QL
         2 000007   000000 236000 1                  LDQ     0
         2 000010   000004 376010 xsym               ANQ     DEVINFO+4,X0
         2 000011   400000 116003                    CMPQ    -131072,DU
         2 000012   000014 601000 2                  TNZ     s:1362

   1360  2 000013   000000 702200 xent               TSX2  ! X66_ARET

     1358     1361    1             ELSE;
     1359     1362    2           DO SELECT(DEVINFO.STATUS.MAJ_STAT(INDX));

   1362  2 000014   000000 236100                    LDQ     0,,PR0
         2 000015   000006 402007                    MPY     6,DL
PL6.E3A0      #013=CRCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:312  
         2 000016   000001 736000                    QLS     1
         2 000017   000004 236006 xsym               LDQ     DEVINFO+4,QL
         2 000020   170000 376003                    ANQ     61440,DU
         2 000021   020000 116003                    CMPQ    8192,DU
         2 000022   000035 601000 2                  TNZ     CRCU8
         2 000023   000024 710000 2                  TRA     s:1364

     1360     1363    2             SELECT('0010'B);              /* Device attention                   */

     1361     1364    2             IF(DEVINFO.STATUS.SUB_STAT(INDX)&'07'O)~='0'B THEN RETURN;

   1364  2 000024   000000 236100                    LDQ     0,,PR0
         2 000025   000006 402007                    MPY     6,DL
         2 000026   000001 736000                    QLS     1
         2 000027   000004 236006 xsym               LDQ     DEVINFO+4,QL
         2 000030   000006 736000                    QLS     6
         2 000031   770000 376003                    ANQ     -4096,DU
         2 000032   070000 376003                    ANQ     28672,DU
         2 000033   000035 600000 2                  TZE     CRCU8

   1364  2 000034   000000 702200 xent               TSX2  ! X66_ARET

     1362     1365    2               ELSE GOTO CRCU8;
     1363     1366    2             SELECT(ELSE);

     1364     1367    2   CRCU8:
     1365     1368    2           CALL TYPEC(CRM);

   1368  2 000035   000000 630400 3     CRCU8        EPPR0   0
         2 000036   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000037   000000 701000 xent               TSX1    TYPEC
         2 000040   000000 011000                    NOP     0

     1366     1369    2           ALTRETURN;

   1369  2 000041   000000 702200 xent               TSX2  ! X66_AALT
     1367     1370    2           END;                            /* DO SELECT                          */
PL6.E3A0      #013=CRCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:313  
     1368     1371    1   END CRCU;
     1369     1372        %EOD;

PL6.E3A0      #013=CRCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:314  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure CRCU.
PL6.E3A0      #013=CRCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:315  

 **** Variables and constants ****

  ****  Section 000  Data  CRCU

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(234)   r     1 CRM

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @CODE                      3-0-0/w PTR         r     1 @INDX
    *0-0-0/w UBIN        r     1 CODE                      *0-0-0/w UBIN        r     1 INDX

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(396)   r     1 DEVINFO(0:21)


   Procedure CRCU requires 34 words for executable code.
   Procedure CRCU requires 6 words of local(AUTO) storage.
PL6.E3A0      #013=CRCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:316  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #013=CRCU File=ISI$IOPROC.:E05TSI                                  TUE 07/29/97 22:53 Page:317  
          MINI XREF LISTING

CODE
      1357**DCL         6--PROC
CRCU8
      1368**LABEL    1365--GOTO
CRM
      1352**DCL      1368<>CALL
DEVINFO.BSTAT.W1
      1335**DCL      1360>>IF
DEVINFO.PCWS
      1298**DCL      1309--REDEF
DEVINFO.RPM_PTRS.EF_DCWS$
      1311**DCL      1312--REDEF
DEVINFO.STATUS
      1315**DCL      1334--REDEF
DEVINFO.STATUS.MAJ_STAT
      1318**DCL      1362>>DOSELCT
DEVINFO.STATUS.SUB_STAT
      1319**DCL      1364>>IF
INDX
      1356**DCL         6--PROC     1360>>IF       1362>>DOSELCT  1364>>IF
TYPEC
      1358**DCL-ENT  1368--CALL

PL6.E3A0      #014=BUILD_MESSAGE File=ISI$IOPROC.:E05TSI                         TUE 07/29/97 22:53 Page:318  
     1370        1        /*T***********************************************************/
     1371        2        /*T*                                                         */
     1372        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1373        4        /*T*                                                         */
     1374        5        /*T***********************************************************/
     1375        6        BUILD_MESSAGE:PROC(MES);
     1376        7        /* This programm builds a message with an entire NR
     1377        8        of words; the TXT is completed with null characters */
     1378        9    1   DCL 1 MES,
     1379       10    1         2 CNT UBIN WORD,
     1380       11    1         2 TXT CHAR(MES.CNT);
     1381       12    1   DCL MESSAGE CHAR(80) STATIC SYMDEF;
     1382       13    1   DCL MESSAGE_CNT UBIN WORD STATIC SYMDEF;
     1383       14    1   DCL BNUL_CHAR BIT(27) STATIC INIT('0'B);
     1384       15    1   DCL NUL_CHAR REDEF BNUL_CHAR CHAR(3);
     1385       16        /**/
     1386       17    1           MESSAGE_CNT=(MES.CNT+3)/4*4;
     1387       18    1           SUBSTR(MESSAGE,0,MES.CNT)=MES.TXT;
     1388       19    1           SUBSTR(MESSAGE,MES.CNT,(MESSAGE_CNT-MES.CNT))=NUL_CHAR;
     1389       20    1           RETURN;
     1390       21    1   END BUILD_MESSAGE;
     1391       22        %EOD;

PL6.E3A0      #014=BUILD_MESSAGE File=ISI$IOPROC.:E05TSI                         TUE 07/29/97 22:53 Page:319  
      No diagnostics issued in procedure BUILD_MESSAGE.

   Procedure BUILD_MESSAGE requires 21 words for executable code.
   Procedure BUILD_MESSAGE requires 4 words of local(AUTO) storage.

PL6.E3A0      #014=BUILD_MESSAGE File=ISI$IOPROC.:E05TSI                         TUE 07/29/97 22:53 Page:320  

 Object Unit name= BUILD_MESSAGE                              File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:53:10.44 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    22     26  BUILD_MESSAGE
    1   Proc  even  none    21     25  BUILD_MESSAGE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  BUILD_MESSAGE

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  MESSAGE                            0     24  MESSAGE_CNT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
PL6.E3A0      #014=BUILD_MESSAGE File=ISI$IOPROC.:E05TSI                         TUE 07/29/97 22:53 Page:321  


     1370        1        /*T***********************************************************/
     1371        2        /*T*                                                         */
     1372        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1373        4        /*T*                                                         */
     1374        5        /*T***********************************************************/
     1375        6        BUILD_MESSAGE:PROC(MES);

      6  1 000000   000000 700200 xent  BUILD_MESSA* TSX0  ! X66_AUTO_1
         1 000001   000004 000001                    ZERO    4,1

     1376        7        /* This programm builds a message with an entire NR
     1377        8        of words; the TXT is completed with null characters */
     1378        9    1   DCL 1 MES,
     1379       10    1         2 CNT UBIN WORD,
     1380       11    1         2 TXT CHAR(MES.CNT);
     1381       12    1   DCL MESSAGE CHAR(80) STATIC SYMDEF;
     1382       13    1   DCL MESSAGE_CNT UBIN WORD STATIC SYMDEF;
     1383       14    1   DCL BNUL_CHAR BIT(27) STATIC INIT('0'B);
     1384       15    1   DCL NUL_CHAR REDEF BNUL_CHAR CHAR(3);
     1385       16        /**/
     1386       17    1           MESSAGE_CNT=(MES.CNT+3)/4*4;

     17  1 000002   200003 470500                    LDP0    @MES,,AUTO
         1 000003   000000 236100                    LDQ     0,,PR0
         1 000004   000003 036007                    ADLQ    3,DL
         1 000005   000002 772000                    QRL     2
         1 000006   000002 736000                    QLS     2
         1 000007   000024 756000 0                  STQ     MESSAGE_CNT

     1387       18    1           SUBSTR(MESSAGE,0,MES.CNT)=MES.TXT;

     18  1 000010   000000 720100                    LXL0    0,,PR0
         1 000011   000000 721100                    LXL1    0,,PR0
         1 000012   040040 100540                    MLR     fill='040'O
         1 000013   000001 000011                    ADSC9   1,,PR0                   cn=0,n=*X1
         1 000014   000000 000010 0                  ADSC9   MESSAGE                  cn=0,n=*X0
PL6.E3A0      #014=BUILD_MESSAGE File=ISI$IOPROC.:E05TSI                         TUE 07/29/97 22:53 Page:322  

     1388       19    1           SUBSTR(MESSAGE,MES.CNT,(MESSAGE_CNT-MES.CNT))=NUL_CHAR;

     19  1 000015   000024 236000 0                  LDQ     MESSAGE_CNT
         1 000016   000000 136100                    SBLQ    0,,PR0
         1 000017   000000 235100                    LDA     0,,PR0
         1 000020   000000 620006                    EAX0    0,QL
         1 000021   040045 100400                    MLR     fill='040'O
         1 000022   000025 000003 0                  ADSC9   BNUL_CHAR                cn=0,n=3
         1 000023   000000 000010 0                  ADSC9   MESSAGE,A                cn=0,n=*X0

     1389       20    1           RETURN;

     20  1 000024   000000 702200 xent               TSX2  ! X66_ARET
     1390       21    1   END BUILD_MESSAGE;
     1391       22        %EOD;

PL6.E3A0      #014=BUILD_MESSAGE File=ISI$IOPROC.:E05TSI                         TUE 07/29/97 22:53 Page:323  
      No diagnostics issued in procedure BUILD_MESSAGE.
PL6.E3A0      #014=BUILD_MESSAGE File=ISI$IOPROC.:E05TSI                         TUE 07/29/97 22:53 Page:324  

 **** Variables and constants ****

  ****  Section 000  Data  BUILD_MESSAGE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    25-0-0/b BIT (27)    r     1 BNUL_CHAR                  0-0-0/c CHAR(80)    r     1 MESSAGE
    24-0-0/w UBIN        r     1 MESSAGE_CNT               25-0-0/c CHAR(3)     r     1 NUL_CHAR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @MES                      *0-0-0/w ASTR        r     1 MES


   Procedure BUILD_MESSAGE requires 21 words for executable code.
   Procedure BUILD_MESSAGE requires 4 words of local(AUTO) storage.
PL6.E3A0      #014=BUILD_MESSAGE File=ISI$IOPROC.:E05TSI                         TUE 07/29/97 22:53 Page:325  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #014=BUILD_MESSAGE File=ISI$IOPROC.:E05TSI                         TUE 07/29/97 22:53 Page:326  
          MINI XREF LISTING

BNUL_CHAR
        14**DCL        15--REDEF
MES
         9**DCL         6--PROC
MES.CNT
        10**DCL        11--IMP-SIZ    17>>ASSIGN     18>>ASSIGN     18>>ASSIGN     19>>ASSIGN     19>>ASSIGN
MES.TXT
        11**DCL        18>>ASSIGN
MESSAGE
        12**DCL        18<<ASSIGN     19<<ASSIGN
MESSAGE_CNT
        13**DCL        17<<ASSIGN     19>>ASSIGN
NUL_CHAR
        15**DCL        19>>ASSIGN

PL6.E3A0      #015=TYPEC File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:327  
     1392        1        /*T***********************************************************/
     1393        2        /*T*                                                         */
     1394        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1395        4        /*T*                                                         */
     1396        5        /*T***********************************************************/
     1397        6        TYPEC:  PROC(TXT);
     1398        7        /* Types a message */
     1399        8        %INCLUDE IS$MACROS;
     1400     1283    1   DCL TXT CHAR(1);
     1401     1284    1   DCL BUILD_MESSAGE ENTRY(1);
     1402     1285    1   DCL MINIQ_PL6 ENTRY(5) ALTRET;
     1403     1286    1   DCL MESSAGE CHAR(80) SYMREF;
     1404     1287    1   DCL MESSAGE_CNT UBIN WORD SYMREF;
     1405     1288        /**/
     1406     1289    1           CALL BUILD_MESSAGE(TXT);
     1407     1290    1           CALL MINIQ_PL6(0,ADDR(MESSAGE),MESSAGE_CNT,%FCNWCA);
     1408     1291    1           RETURN;
     1409     1292    1   END TYPEC;
     1410     1293        %EOD;

PL6.E3A0      #015=TYPEC File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:328  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure TYPEC.

   Procedure TYPEC requires 19 words for executable code.
   Procedure TYPEC requires 10 words of local(AUTO) storage.

PL6.E3A0      #015=TYPEC File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:329  

 Object Unit name= TYPEC                                      File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:53:11.84 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    19     23  TYPEC
    1  RoData even  none     5      5  TYPEC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        1  TYPEC

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 BUILD_MESSAGE
 yes     yes           Std       5 MINIQ_PL6
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     MESSAGE                               MESSAGE_CNT                           B_VECTNIL
PL6.E3A0      #015=TYPEC File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:330  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #015=TYPEC File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:331  


     1392        1        /*T***********************************************************/
     1393        2        /*T*                                                         */
     1394        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1395        4        /*T*                                                         */
     1396        5        /*T***********************************************************/
     1397        6        TYPEC:  PROC(TXT);

      6  0 000000   000000 700200 xent  TYPEC        TSX0  ! X66_AUTO_1
         0 000001   000012 000001                    ZERO    10,1

     1398        7        /* Types a message */
     1399        8        %INCLUDE IS$MACROS;
     1400     1283    1   DCL TXT CHAR(1);
     1401     1284    1   DCL BUILD_MESSAGE ENTRY(1);
     1402     1285    1   DCL MINIQ_PL6 ENTRY(5) ALTRET;
     1403     1286    1   DCL MESSAGE CHAR(80) SYMREF;
     1404     1287    1   DCL MESSAGE_CNT UBIN WORD SYMREF;
     1405     1288        /**/
     1406     1289    1           CALL BUILD_MESSAGE(TXT);

   1289  0 000002   200003 630500                    EPPR0   @TXT,,AUTO
         0 000003   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000004   000000 701000 xent               TSX1    BUILD_MESSAGE
         0 000005   000000 011000                    NOP     0

     1407     1290    1           CALL MINIQ_PL6(0,ADDR(MESSAGE),MESSAGE_CNT,%FCNWCA);

   1290  0 000006   000000 236000 1                  LDQ     0
         0 000007   200004 756100                    STQ     @TXT+1,,AUTO
         0 000010   000002 237000 1                  LDAQ    2
         0 000011   200010 757100                    STAQ    @TXT+5,,AUTO
         0 000012   200004 630500                    EPPR0   @TXT+1,,AUTO
         0 000013   200007 450500                    STP0    @TXT+4,,AUTO
         0 000014   000004 236000 1                  LDQ     4
         0 000015   200006 756100                    STQ     @TXT+3,,AUTO
         0 000016   200006 630500                    EPPR0   @TXT+3,,AUTO
PL6.E3A0      #015=TYPEC File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:332  
         0 000017   000022 631400 xsym               EPPR1   B_VECTNIL+18
         0 000020   000000 701000 xent               TSX1    MINIQ_PL6
         0 000021   000000 011000                    NOP     0

     1408     1291    1           RETURN;

   1291  0 000022   000000 702200 xent               TSX2  ! X66_ARET
     1409     1292    1   END TYPEC;
     1410     1293        %EOD;

PL6.E3A0      #015=TYPEC File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:333  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure TYPEC.
PL6.E3A0      #015=TYPEC File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:334  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @TXT                      *0-0-0/c CHAR        r     1 TXT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(80)    r     1 MESSAGE                    0-0-0/w UBIN        r     1 MESSAGE_CNT


   Procedure TYPEC requires 19 words for executable code.
   Procedure TYPEC requires 10 words of local(AUTO) storage.
PL6.E3A0      #015=TYPEC File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:335  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #015=TYPEC File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:336  
          MINI XREF LISTING

BUILD_MESSAGE
      1284**DCL-ENT  1289--CALL
MESSAGE
      1286**DCL      1290--CALL
MESSAGE_CNT
      1287**DCL      1290<>CALL
MINIQ_PL6
      1285**DCL-ENT  1290--CALL
TXT
      1283**DCL         6--PROC     1289<>CALL

PL6.E3A0      #016=TYPEST File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:337  
     1411        1        /*T***********************************************************/
     1412        2        /*T*                                                         */
     1413        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1414        4        /*T*                                                         */
     1415        5        /*T***********************************************************/
     1416        6        TYPEST: PROC(DIG);
     1417        7        /* Type status */
     1418        8        %INCLUDE IS$MACROS;
     1419     1283    1   DCL DIG(0:11) UBIN(3) UNAL;             /* Redefines status                   */
     1420     1284        %TEXTC(N#=STATUSM,M#="' STATUS = 000000000000'");
     1421     1289    1   DCL MESSAGE$ PTR;
     1422     1290    1   DCL 1 TEXTM BASED(MESSAGE$),
     1423     1291    1         2 CNT UBIN WORD,
     1424     1292    1         2 TXT CHAR(TEXTM.CNT);
     1425     1293    1   DCL I UBIN WORD;
     1426     1294        /**/
     1427     1295    1   DCL BUILD_MESSAGE ENTRY(1);
     1428     1296    1   DCL MINIQ_PL6 ENTRY(5) ALTRET;
     1429     1297    1   DCL MESSAGE CHAR(80) SYMREF;
     1430     1298    1   DCL MESSAGE_CNT UBIN WORD SYMREF;
     1431     1299        /**/
     1432     1300    1           MESSAGE$=ADDR(STATUSM);
     1433     1301    2           DO I=0 TO 11;
     1434     1302    2             CALL BINCHAR(SUBSTR(TEXTM.TXT,10+I,1),DIG(I));
     1435     1303    2           END;                            /* DO I=                              */
     1436     1304    1           CALL BUILD_MESSAGE(STATUSM);
     1437     1305    1           CALL MINIQ_PL6(0,ADDR(MESSAGE),MESSAGE_CNT,%FCNWCM);
     1438     1306    1           RETURN;
     1439     1307    1   END TYPEST;
     1440     1308        %EOD;

PL6.E3A0      #016=TYPEST File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:338  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure TYPEST.

   Procedure TYPEST requires 41 words for executable code.
   Procedure TYPEST requires 12 words of local(AUTO) storage.

PL6.E3A0      #016=TYPEST File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:339  

 Object Unit name= TYPEST                                     File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:53:14.28 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     7      7  TYPEST
    1   Proc  even  none    41     51  TYPEST
    2  RoData even  none     5      5  TYPEST

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  TYPEST

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  STATUSM

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 BUILD_MESSAGE
 yes     yes           Std       5 MINIQ_PL6
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #016=TYPEST File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:340  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     MESSAGE                               MESSAGE_CNT                           B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #016=TYPEST File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:341  


     1411        1        /*T***********************************************************/
     1412        2        /*T*                                                         */
     1413        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1414        4        /*T*                                                         */
     1415        5        /*T***********************************************************/
     1416        6        TYPEST: PROC(DIG);

      6  1 000000   000000 700200 xent  TYPEST       TSX0  ! X66_AUTO_1
         1 000001   000014 000001                    ZERO    12,1

     1417        7        /* Type status */
     1418        8        %INCLUDE IS$MACROS;
     1419     1283    1   DCL DIG(0:11) UBIN(3) UNAL;             /* Redefines status                   */
     1420     1284        %TEXTC(N#=STATUSM,M#="' STATUS = 000000000000'");
     1421     1289    1   DCL MESSAGE$ PTR;
     1422     1290    1   DCL 1 TEXTM BASED(MESSAGE$),
     1423     1291    1         2 CNT UBIN WORD,
     1424     1292    1         2 TXT CHAR(TEXTM.CNT);
     1425     1293    1   DCL I UBIN WORD;
     1426     1294        /**/
     1427     1295    1   DCL BUILD_MESSAGE ENTRY(1);
     1428     1296    1   DCL MINIQ_PL6 ENTRY(5) ALTRET;
     1429     1297    1   DCL MESSAGE CHAR(80) SYMREF;
     1430     1298    1   DCL MESSAGE_CNT UBIN WORD SYMREF;
     1431     1299        /**/
     1432     1300    1           MESSAGE$=ADDR(STATUSM);

   1300  1 000002   000000 236000 2                  LDQ     0
         1 000003   200004 756100                    STQ     MESSAGE$,,AUTO

     1433     1301    2           DO I=0 TO 11;

   1301  1 000004   200005 450100                    STZ     I,,AUTO

     1434     1302    2             CALL BINCHAR(SUBSTR(TEXTM.TXT,10+I,1),DIG(I));

PL6.E3A0      #016=TYPEST File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:342  
   1302  1 000005   200004 470500                    LDP0    MESSAGE$,,AUTO
         1 000006   000000 720100                    LXL0    0,,PR0
         1 000007   200005 236100                    LDQ     I,,AUTO
         1 000010   000003 402007                    MPY     3,DL
         1 000011   200003 471500                    LDP1    @DIG,,AUTO
         1 000012   003100 061506                    CSR     bolr='003'O
         1 000013   100000 000003                    BDSC    0,Q,PR1                  by=0,bit=0,n=3
         1 000014   200006 000044                    BDSC    I+1,,AUTO                by=0,bit=0,n=36
         1 000015   200006 236100                    LDQ     I+1,,AUTO
         1 000016   000000 235003                    LDA     0,DU
         1 000017   200010 757100                    STAQ    I+3,,AUTO
         1 000020   200005 235100                    LDA     I,,AUTO
         1 000021   000105 301500                    BTD
         1 000022   200010 000010                    NDSC9   I+3,,AUTO                cn=0,s=lsgnf,sf=0,n=8
         1 000023   000003 430001                    NDSC9   3,A,PR0                  cn=2,s=nosgn,sf=0,n=1

     1435     1303    2           END;                            /* DO I=                              */

   1303  1 000024   000001 035007                    ADLA    1,DL
         1 000025   200005 755100                    STA     I,,AUTO
         1 000026   000014 115007                    CMPA    12,DL
         1 000027   000005 602000 1                  TNC     s:1302

     1436     1304    1           CALL BUILD_MESSAGE(STATUSM);

   1304  1 000030   000000 630400 2                  EPPR0   0
         1 000031   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000032   000000 701000 xent               TSX1    BUILD_MESSAGE
         1 000033   000000 011000                    NOP     0

     1437     1305    1           CALL MINIQ_PL6(0,ADDR(MESSAGE),MESSAGE_CNT,%FCNWCM);

   1305  1 000034   000001 236000 2                  LDQ     1
         1 000035   200006 756100                    STQ     I+1,,AUTO
         1 000036   000002 237000 2                  LDAQ    2
         1 000037   200012 757100                    STAQ    I+5,,AUTO
         1 000040   200006 630500                    EPPR0   I+1,,AUTO
PL6.E3A0      #016=TYPEST File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:343  
         1 000041   200011 450500                    STP0    I+4,,AUTO
         1 000042   000004 236000 2                  LDQ     4
         1 000043   200010 756100                    STQ     I+3,,AUTO
         1 000044   200010 630500                    EPPR0   I+3,,AUTO
         1 000045   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000046   000000 701000 xent               TSX1    MINIQ_PL6
         1 000047   000000 011000                    NOP     0

     1438     1306    1           RETURN;

   1306  1 000050   000000 702200 xent               TSX2  ! X66_ARET
     1439     1307    1   END TYPEST;
     1440     1308        %EOD;

PL6.E3A0      #016=TYPEST File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:344  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure TYPEST.
PL6.E3A0      #016=TYPEST File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:345  

 **** Variables and constants ****

  ****  Section 000  Data  TYPEST

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(234)   r     1 STATUSM

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @DIG                      *0-0-0/b UBIN(3)     r     1 DIG(0:11)
     5-0-0/w UBIN        r     1 I                          4-0-0/w PTR         r     1 MESSAGE$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(80)    r     1 MESSAGE                    0-0-0/w UBIN        r     1 MESSAGE_CNT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ASTR        r     1 TEXTM


   Procedure TYPEST requires 41 words for executable code.
   Procedure TYPEST requires 12 words of local(AUTO) storage.
PL6.E3A0      #016=TYPEST File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:346  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #016=TYPEST File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:347  
          MINI XREF LISTING

BUILD_MESSAGE
      1295**DCL-ENT  1304--CALL
DIG
      1283**DCL         6--PROC     1302>>CALLBLT
I
      1293**DCL      1301<<DOINDEX  1302>>CALLBLT  1302>>CALLBLT
MESSAGE
      1297**DCL      1305--CALL
MESSAGE$
      1289**DCL      1290--IMP-PTR  1300<<ASSIGN   1302>>CALLBLT  1302>>CALLBLT
MESSAGE_CNT
      1298**DCL      1305<>CALL
MINIQ_PL6
      1296**DCL-ENT  1305--CALL
STATUSM
      1285**DCL      1300--ASSIGN   1304<>CALL
TEXTM.CNT
      1291**DCL      1292--IMP-SIZ  1302>>CALLBLT
TEXTM.TXT
      1292**DCL      1302<<CALLBLT

PL6.E3A0      #017=KEYIN File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:348  
     1441        1        /*T***********************************************************/
     1442        2        /*T*                                                         */
     1443        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1444        4        /*T*                                                         */
     1445        5        /*T***********************************************************/
     1446        6        KEYIN:  PROC(TXT,BUF) ALTRET;
     1447        7        /* Types a message (in TXT) ,
     1448        8           Receives an answer (in BUF) */
     1449        9        %INCLUDE IS$MACROS;
     1450     1284    1   DCL TXT CHAR(1);
     1451     1285    1   DCL 1 BUF,
     1452     1286    1         2 CNT UBIN WORD,
     1453     1287    1         2 TXT CHAR(BUF.CNT);
     1454     1288        /**/
     1455     1289    1   DCL TYPEC ENTRY(1);
     1456     1290    1   DCL MINIQ_PL6 ENTRY(5) ALTRET;
     1457     1291    1   DCL EDIT_INP ENTRY(1);
     1458     1292        /**/
     1459     1293    1           CALL TYPEC(TXT);
     1460     1294    1           CALL MINIQ_PL6(0,ADDR(BUF.TXT),BUF.CNT,%FCNRCA) ALTRET(IN_ERR);
     1461     1295    1           CALL EDIT_INP(BUF);
     1462     1296    1           RETURN;
     1463     1297    1   IN_ERR:
     1464     1298    1           ALTRETURN;
     1465     1299    1   END KEYIN;
     1466     1300        %EOD;

PL6.E3A0      #017=KEYIN File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:349  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure KEYIN.

   Procedure KEYIN requires 26 words for executable code.
   Procedure KEYIN requires 12 words of local(AUTO) storage.

PL6.E3A0      #017=KEYIN File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:350  

 Object Unit name= KEYIN                                      File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:53:17.08 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    26     32  KEYIN
    1  RoData even  none     1      1  KEYIN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        2  KEYIN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 TYPEC
 yes     yes           Std       5 MINIQ_PL6
         yes           Std       1 EDIT_INP
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL
PL6.E3A0      #017=KEYIN File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:351  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #017=KEYIN File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:352  


     1441        1        /*T***********************************************************/
     1442        2        /*T*                                                         */
     1443        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1444        4        /*T*                                                         */
     1445        5        /*T***********************************************************/
     1446        6        KEYIN:  PROC(TXT,BUF) ALTRET;

      6  0 000000   000000 700200 xent  KEYIN        TSX0  ! X66_AUTO_2
         0 000001   000014 000002                    ZERO    12,2

     1447        7        /* Types a message (in TXT) ,
     1448        8           Receives an answer (in BUF) */
     1449        9        %INCLUDE IS$MACROS;
     1450     1284    1   DCL TXT CHAR(1);
     1451     1285    1   DCL 1 BUF,
     1452     1286    1         2 CNT UBIN WORD,
     1453     1287    1         2 TXT CHAR(BUF.CNT);
     1454     1288        /**/
     1455     1289    1   DCL TYPEC ENTRY(1);
     1456     1290    1   DCL MINIQ_PL6 ENTRY(5) ALTRET;
     1457     1291    1   DCL EDIT_INP ENTRY(1);
     1458     1292        /**/
     1459     1293    1           CALL TYPEC(TXT);

   1293  0 000002   200003 630500                    EPPR0   @TXT,,AUTO
         0 000003   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000004   000000 701000 xent               TSX1    TYPEC
         0 000005   000000 011000                    NOP     0

     1460     1294    1           CALL MINIQ_PL6(0,ADDR(BUF.TXT),BUF.CNT,%FCNRCA) ALTRET(IN_ERR);

   1294  0 000006   200004 236100                    LDQ     @BUF,,AUTO
         0 000007   000001 036003                    ADLQ    1,DU
         0 000010   200006 756100                    STQ     @BUF+2,,AUTO
         0 000011   000000 236000 1                  LDQ     0
         0 000012   200004 235100                    LDA     @BUF,,AUTO
PL6.E3A0      #017=KEYIN File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:353  
         0 000013   200012 757100                    STAQ    @BUF+6,,AUTO
         0 000014   200006 630500                    EPPR0   @BUF+2,,AUTO
         0 000015   200011 450500                    STP0    @BUF+5,,AUTO
         0 000016   000000 236000 1                  LDQ     0
         0 000017   200010 756100                    STQ     @BUF+4,,AUTO
         0 000020   200010 630500                    EPPR0   @BUF+4,,AUTO
         0 000021   000022 631400 xsym               EPPR1   B_VECTNIL+18
         0 000022   000000 701000 xent               TSX1    MINIQ_PL6
         0 000023   000031 702000 0                  TSX2    IN_ERR

     1461     1295    1           CALL EDIT_INP(BUF);

   1295  0 000024   200004 630500                    EPPR0   @BUF,,AUTO
         0 000025   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000026   000000 701000 xent               TSX1    EDIT_INP
         0 000027   000000 011000                    NOP     0

     1462     1296    1           RETURN;

   1296  0 000030   000000 702200 xent               TSX2  ! X66_ARET

     1463     1297    1   IN_ERR:
     1464     1298    1           ALTRETURN;

   1298  0 000031   000000 702200 xent  IN_ERR       TSX2  ! X66_AALT
     1465     1299    1   END KEYIN;
     1466     1300        %EOD;

PL6.E3A0      #017=KEYIN File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:354  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure KEYIN.
PL6.E3A0      #017=KEYIN File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:355  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @BUF                       3-0-0/w PTR         r     1 @TXT
    *0-0-0/w ASTR        r     1 BUF                       *0-0-0/c CHAR        r     1 TXT


   Procedure KEYIN requires 26 words for executable code.
   Procedure KEYIN requires 12 words of local(AUTO) storage.
PL6.E3A0      #017=KEYIN File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:356  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #017=KEYIN File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:357  
          MINI XREF LISTING

BUF
      1285**DCL         6--PROC     1295<>CALL
BUF.CNT
      1286**DCL      1287--IMP-SIZ  1294<>CALL     1295>>CALL
BUF.TXT
      1287**DCL      1294--CALL
EDIT_INP
      1291**DCL-ENT  1295--CALL
IN_ERR
      1298**LABEL    1294--CALLALT
MINIQ_PL6
      1290**DCL-ENT  1294--CALL
TXT
      1284**DCL         6--PROC     1293<>CALL
TYPEC
      1289**DCL-ENT  1293--CALL

PL6.E3A0      #018=KEYINX File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:358  
     1467        1        /*T***********************************************************/
     1468        2        /*T*                                                         */
     1469        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1470        4        /*T*                                                         */
     1471        5        /*T***********************************************************/
     1472        6        KEYINX: PROC(TXT,BUF,IANS);
     1473        7        /* Types a message (in TXT) ,
     1474        8           Receives an answer (in BUF),
     1475        9           If timeout & non_recovery->BUF=IANS
     1476       10            (answer=implicit answer)         */
     1477       11        %INCLUDE IS$MACROS;
     1478     1286    1   DCL TXT CHAR(1);
     1479     1287    1   DCL 1 BUF,
     1480     1288    1         2 CNT UBIN WORD,
     1481     1289    1         2 TXT CHAR(BUF.CNT);
     1482     1290    1   DCL 1 IANS,
     1483     1291    1         2 CNT UBIN WORD,
     1484     1292    1         2 TXT CHAR(IANS.CNT);
     1485     1293        /**/
     1486     1294    1   DCL RCV_FLG BIT(4) SYMREF;
     1487     1295    1   DCL TYPEC ENTRY(1);
     1488     1296    1   DCL MINIQ_PL6 ENTRY(5) ALTRET;
     1489     1297    1   DCL EDIT_INP ENTRY(1);
     1490     1298        /**/
     1491     1299    1           CALL TYPEC(TXT);
     1492     1300    1   GTANS:
     1493     1301    2           CALL MINIQ_PL6(0,ADDR(BUF.TXT),BUF.CNT,%FCNRCR) WHENALTRETURN DO;
              1301                    /*Command code=3,Read console ASCII return on Timeout */
     1494     1302    2                 IF RCV_FLG='0'B THEN GOTO GTANS;
     1495     1303    2                   ELSE;
     1496     1304        /* Don't timeout unless recovery */
     1497     1305    2                 BUF.CNT=IANS.CNT;
     1498     1306    2                 BUF.TXT=IANS.TXT;
     1499     1307    2               END;                        /* WHENALTRETURN                      */
     1500     1308    1           CALL EDIT_INP(BUF);
     1501     1309    1           RETURN;
     1502     1310    1   END KEYINX;
PL6.E3A0      #018=KEYINX File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:359  
     1503     1311        %EOD;

PL6.E3A0      #018=KEYINX File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:360  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure KEYINX.

   Procedure KEYINX requires 38 words for executable code.
   Procedure KEYINX requires 12 words of local(AUTO) storage.

PL6.E3A0      #018=KEYINX File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:361  

 Object Unit name= KEYINX                                     File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:53:19.56 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    38     46  KEYINX
    1  RoData even  none     2      2  KEYINX

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        3  KEYINX

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 TYPEC
 yes     yes           Std       5 MINIQ_PL6
         yes           Std       1 EDIT_INP
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     RCV_FLG                               B_VECTNIL
PL6.E3A0      #018=KEYINX File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:362  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #018=KEYINX File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:363  


     1467        1        /*T***********************************************************/
     1468        2        /*T*                                                         */
     1469        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1470        4        /*T*                                                         */
     1471        5        /*T***********************************************************/
     1472        6        KEYINX: PROC(TXT,BUF,IANS);

      6  0 000000   000000 700200 xent  KEYINX       TSX0  ! X66_AUTO_3
         0 000001   000014 000003                    ZERO    12,3

     1473        7        /* Types a message (in TXT) ,
     1474        8           Receives an answer (in BUF),
     1475        9           If timeout & non_recovery->BUF=IANS
     1476       10            (answer=implicit answer)         */
     1477       11        %INCLUDE IS$MACROS;
     1478     1286    1   DCL TXT CHAR(1);
     1479     1287    1   DCL 1 BUF,
     1480     1288    1         2 CNT UBIN WORD,
     1481     1289    1         2 TXT CHAR(BUF.CNT);
     1482     1290    1   DCL 1 IANS,
     1483     1291    1         2 CNT UBIN WORD,
     1484     1292    1         2 TXT CHAR(IANS.CNT);
     1485     1293        /**/
     1486     1294    1   DCL RCV_FLG BIT(4) SYMREF;
     1487     1295    1   DCL TYPEC ENTRY(1);
     1488     1296    1   DCL MINIQ_PL6 ENTRY(5) ALTRET;
     1489     1297    1   DCL EDIT_INP ENTRY(1);
     1490     1298        /**/
     1491     1299    1           CALL TYPEC(TXT);

   1299  0 000002   200003 630500                    EPPR0   @TXT,,AUTO
         0 000003   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000004   000000 701000 xent               TSX1    TYPEC
         0 000005   000000 011000                    NOP     0

     1492     1300    1   GTANS:
PL6.E3A0      #018=KEYINX File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:364  
     1493     1301    2           CALL MINIQ_PL6(0,ADDR(BUF.TXT),BUF.CNT,%FCNRCR) WHENALTRETURN DO;
              1301                    /*Command code=3,Read console ASCII return on Timeout */

   1301  0 000006   200004 236100       GTANS        LDQ     @BUF,,AUTO
         0 000007   000001 036003                    ADLQ    1,DU
         0 000010   200006 756100                    STQ     @IANS+1,,AUTO
         0 000011   000000 236000 1                  LDQ     0
         0 000012   200004 235100                    LDA     @BUF,,AUTO
         0 000013   200012 757100                    STAQ    @IANS+5,,AUTO
         0 000014   200006 630500                    EPPR0   @IANS+1,,AUTO
         0 000015   200011 450500                    STP0    @IANS+4,,AUTO
         0 000016   000001 236000 1                  LDQ     1
         0 000017   200010 756100                    STQ     @IANS+3,,AUTO
         0 000020   200010 630500                    EPPR0   @IANS+3,,AUTO
         0 000021   000022 631400 xsym               EPPR1   B_VECTNIL+18
         0 000022   000000 701000 xent               TSX1    MINIQ_PL6
         0 000023   000025 702000 0                  TSX2    s:1302
         0 000024   000041 710000 0                  TRA     s:1308

     1494     1302    2                 IF RCV_FLG='0'B THEN GOTO GTANS;

   1302  0 000025   000000 236000 xsym               LDQ     RCV_FLG
         0 000026   740000 316003                    CANQ    -16384,DU
         0 000027   000006 600000 0                  TZE     GTANS

     1495     1303    2                   ELSE;
     1496     1304        /* Don't timeout unless recovery */
     1497     1305    2                 BUF.CNT=IANS.CNT;

   1305  0 000030   200005 470500                    LDP0    @IANS,,AUTO
         0 000031   200004 471500                    LDP1    @BUF,,AUTO
         0 000032   000000 235100                    LDA     0,,PR0
         0 000033   100000 755100                    STA     0,,PR1

     1498     1306    2                 BUF.TXT=IANS.TXT;

   1306  0 000034   100000 720100                    LXL0    0,,PR1
PL6.E3A0      #018=KEYINX File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:365  
         0 000035   000000 721100                    LXL1    0,,PR0
         0 000036   040140 100540                    MLR     fill='040'O
         0 000037   000001 000011                    ADSC9   1,,PR0                   cn=0,n=*X1
         0 000040   100001 000010                    ADSC9   1,,PR1                   cn=0,n=*X0

     1499     1307    2               END;                        /* WHENALTRETURN                      */

     1500     1308    1           CALL EDIT_INP(BUF);

   1308  0 000041   200004 630500                    EPPR0   @BUF,,AUTO
         0 000042   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000043   000000 701000 xent               TSX1    EDIT_INP
         0 000044   000000 011000                    NOP     0

     1501     1309    1           RETURN;

   1309  0 000045   000000 702200 xent               TSX2  ! X66_ARET
     1502     1310    1   END KEYINX;
     1503     1311        %EOD;

PL6.E3A0      #018=KEYINX File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:366  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure KEYINX.
PL6.E3A0      #018=KEYINX File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:367  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @BUF                       5-0-0/w PTR         r     1 @IANS
     3-0-0/w PTR         r     1 @TXT                      *0-0-0/w ASTR        r     1 BUF
    *0-0-0/w ASTR        r     1 IANS                      *0-0-0/c CHAR        r     1 TXT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT (4)     r     1 RCV_FLG


   Procedure KEYINX requires 38 words for executable code.
   Procedure KEYINX requires 12 words of local(AUTO) storage.
PL6.E3A0      #018=KEYINX File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:368  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #018=KEYINX File=ISI$IOPROC.:E05TSI                                TUE 07/29/97 22:53 Page:369  
          MINI XREF LISTING

BUF
      1287**DCL         6--PROC     1308<>CALL
BUF.CNT
      1288**DCL      1289--IMP-SIZ  1301<>CALL     1305<<ASSIGN   1306>>ASSIGN   1308>>CALL
BUF.TXT
      1289**DCL      1301--CALL     1306<<ASSIGN
EDIT_INP
      1297**DCL-ENT  1308--CALL
GTANS
      1301**LABEL    1302--GOTO
IANS
      1290**DCL         6--PROC
IANS.CNT
      1291**DCL      1292--IMP-SIZ  1305>>ASSIGN   1306>>ASSIGN
IANS.TXT
      1292**DCL      1306>>ASSIGN
MINIQ_PL6
      1296**DCL-ENT  1301--CALL
RCV_FLG
      1294**DCL      1302>>IF
TXT
      1286**DCL         6--PROC     1299<>CALL
TYPEC
      1295**DCL-ENT  1299--CALL

PL6.E3A0      #019=KEYINXX File=ISI$IOPROC.:E05TSI                               TUE 07/29/97 22:53 Page:370  
     1504        1        /*T***********************************************************/
     1505        2        /*T*                                                         */
     1506        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1507        4        /*T*                                                         */
     1508        5        /*T***********************************************************/
     1509        6        KEYINXX: PROC(TXT,BUF);
     1510        7        /* Types a message (in TXT) ,
     1511        8           Receives an answer (in BUF) ,
     1512        9           When timed out, Reprompt.    */
     1513       10        %INCLUDE IS$MACROS;
     1514     1285    1   DCL TXT CHAR(1);
     1515     1286    1   DCL 1 BUF,
     1516     1287    1         2 CNT UBIN WORD,
     1517     1288    1         2 TXT CHAR(BUF.CNT);
     1518     1289        /**/
     1519     1290    1   DCL TYPEC ENTRY(1);
     1520     1291    1   DCL MINIQ_PL6 ENTRY(5) ALTRET;
     1521     1292    1   DCL EDIT_INP ENTRY(1);
     1522     1293        /**/
     1523     1294    1   REPROMPT:
     1524     1295    1           CALL TYPEC(TXT);
     1525     1296    1           CALL MINIQ_PL6(0,ADDR(BUF.TXT),BUF.CNT,%FCNRCR) ALTRET(REPROMPT);
     1526     1297    1           CALL EDIT_INP(BUF);
     1527     1298    1           RETURN;
     1528     1299    1   END KEYINXX;
     1529     1300        %EOD;

PL6.E3A0      #019=KEYINXX File=ISI$IOPROC.:E05TSI                               TUE 07/29/97 22:53 Page:371  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure KEYINXX.

   Procedure KEYINXX requires 25 words for executable code.
   Procedure KEYINXX requires 12 words of local(AUTO) storage.

PL6.E3A0      #019=KEYINXX File=ISI$IOPROC.:E05TSI                               TUE 07/29/97 22:53 Page:372  

 Object Unit name= KEYINXX                                    File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:53:22.36 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    25     31  KEYINXX
    1  RoData even  none     2      2  KEYINXX

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        2  KEYINXX

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 TYPEC
 yes     yes           Std       5 MINIQ_PL6
         yes           Std       1 EDIT_INP
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL
PL6.E3A0      #019=KEYINXX File=ISI$IOPROC.:E05TSI                               TUE 07/29/97 22:53 Page:373  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #019=KEYINXX File=ISI$IOPROC.:E05TSI                               TUE 07/29/97 22:53 Page:374  


     1504        1        /*T***********************************************************/
     1505        2        /*T*                                                         */
     1506        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1507        4        /*T*                                                         */
     1508        5        /*T***********************************************************/
     1509        6        KEYINXX: PROC(TXT,BUF);

      6  0 000000   000000 700200 xent  KEYINXX      TSX0  ! X66_AUTO_2
         0 000001   000014 000002                    ZERO    12,2

     1510        7        /* Types a message (in TXT) ,
     1511        8           Receives an answer (in BUF) ,
     1512        9           When timed out, Reprompt.    */
     1513       10        %INCLUDE IS$MACROS;
     1514     1285    1   DCL TXT CHAR(1);
     1515     1286    1   DCL 1 BUF,
     1516     1287    1         2 CNT UBIN WORD,
     1517     1288    1         2 TXT CHAR(BUF.CNT);
     1518     1289        /**/
     1519     1290    1   DCL TYPEC ENTRY(1);
     1520     1291    1   DCL MINIQ_PL6 ENTRY(5) ALTRET;
     1521     1292    1   DCL EDIT_INP ENTRY(1);
     1522     1293        /**/
     1523     1294    1   REPROMPT:
     1524     1295    1           CALL TYPEC(TXT);

   1295  0 000002   200003 630500       REPROMPT     EPPR0   @TXT,,AUTO
         0 000003   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000004   000000 701000 xent               TSX1    TYPEC
         0 000005   000000 011000                    NOP     0

     1525     1296    1           CALL MINIQ_PL6(0,ADDR(BUF.TXT),BUF.CNT,%FCNRCR) ALTRET(REPROMPT);

   1296  0 000006   200004 236100                    LDQ     @BUF,,AUTO
         0 000007   000001 036003                    ADLQ    1,DU
         0 000010   200006 756100                    STQ     @BUF+2,,AUTO
PL6.E3A0      #019=KEYINXX File=ISI$IOPROC.:E05TSI                               TUE 07/29/97 22:53 Page:375  
         0 000011   000000 236000 1                  LDQ     0
         0 000012   200004 235100                    LDA     @BUF,,AUTO
         0 000013   200012 757100                    STAQ    @BUF+6,,AUTO
         0 000014   200006 630500                    EPPR0   @BUF+2,,AUTO
         0 000015   200011 450500                    STP0    @BUF+5,,AUTO
         0 000016   000001 236000 1                  LDQ     1
         0 000017   200010 756100                    STQ     @BUF+4,,AUTO
         0 000020   200010 630500                    EPPR0   @BUF+4,,AUTO
         0 000021   000022 631400 xsym               EPPR1   B_VECTNIL+18
         0 000022   000000 701000 xent               TSX1    MINIQ_PL6
         0 000023   000002 702000 0                  TSX2    REPROMPT

     1526     1297    1           CALL EDIT_INP(BUF);

   1297  0 000024   200004 630500                    EPPR0   @BUF,,AUTO
         0 000025   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000026   000000 701000 xent               TSX1    EDIT_INP
         0 000027   000000 011000                    NOP     0

     1527     1298    1           RETURN;

   1298  0 000030   000000 702200 xent               TSX2  ! X66_ARET
     1528     1299    1   END KEYINXX;
     1529     1300        %EOD;

PL6.E3A0      #019=KEYINXX File=ISI$IOPROC.:E05TSI                               TUE 07/29/97 22:53 Page:376  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure KEYINXX.
PL6.E3A0      #019=KEYINXX File=ISI$IOPROC.:E05TSI                               TUE 07/29/97 22:53 Page:377  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @BUF                       3-0-0/w PTR         r     1 @TXT
    *0-0-0/w ASTR        r     1 BUF                       *0-0-0/c CHAR        r     1 TXT


   Procedure KEYINXX requires 25 words for executable code.
   Procedure KEYINXX requires 12 words of local(AUTO) storage.
PL6.E3A0      #019=KEYINXX File=ISI$IOPROC.:E05TSI                               TUE 07/29/97 22:53 Page:378  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #019=KEYINXX File=ISI$IOPROC.:E05TSI                               TUE 07/29/97 22:53 Page:379  
          MINI XREF LISTING

BUF
      1286**DCL         6--PROC     1297<>CALL
BUF.CNT
      1287**DCL      1288--IMP-SIZ  1296<>CALL     1297>>CALL
BUF.TXT
      1288**DCL      1296--CALL
EDIT_INP
      1292**DCL-ENT  1297--CALL
MINIQ_PL6
      1291**DCL-ENT  1296--CALL
REPROMPT
      1295**LABEL    1296--CALLALT
TXT
      1285**DCL         6--PROC     1295<>CALL
TYPEC
      1290**DCL-ENT  1295--CALL

PL6.E3A0      #020=EDIT_INP File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:380  
     1530        1        /*T***********************************************************/
     1531        2        /*T*                                                         */
     1532        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1533        4        /*T*                                                         */
     1534        5        /*T***********************************************************/
     1535        6        EDIT_INP:PROC(BUF);
     1536        7        /* Edits a console input string */
     1537        8        /* (any character followed by DEL or BS is deleted) */
     1538        9        /**/
     1539       10    1   DCL 1 BUF,
     1540       11    1         2 CNT UBIN WORD,
     1541       12    1         2 TXT CHAR(BUF.CNT);
     1542       13        /**/
     1543       14    1   DCL BDEL BIT(9) CALIGNED STATIC INIT('177'O); /* ASCII for DEL                */
     1544       15    1   DCL DEL REDEF BDEL CHAR(1);
     1545       16    1   DCL BBS BIT(9) CALIGNED STATIC INIT('010'O); /* ASCII for BS                  */
     1546       17    1   DCL BS REDEF BBS CHAR(1);
     1547       18    1   DCL CH CHAR(1);
     1548       19    1   DCL I UBIN WORD;
     1549       20    1   DCL J UBIN WORD;
     1550       21        /**/
     1551       22    1           I=0;
     1552       23    2           DO J=0 TO BUF.CNT-1;
     1553       24    2             CH=SUBSTR(BUF.TXT,I,1);
     1554       25    3             IF CH=DEL OR CH=BS THEN DO;
     1555       26    3                   IF I=0 THEN SUBSTR(BUF.TXT,0)=SUBSTR(BUF.TXT,1);
     1556       27    4                     ELSE DO;
     1557       28    4                         SUBSTR(BUF.TXT,I-1)=SUBSTR(BUF.TXT,I+1);
     1558       29    4                         I=I-1;
     1559       30    4                       END;                /* ELSE                               */
     1560       31    3                 END;                      /*THEN                                */
     1561       32    2               ELSE I=I+1;
     1562       33    2           END;                            /* DO                                 */
     1563       34    1           RETURN;
     1564       35    1   END EDIT_INP;
     1565       36        %EOD;

PL6.E3A0      #020=EDIT_INP File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:381  
      No diagnostics issued in procedure EDIT_INP.

   Procedure EDIT_INP requires 52 words for executable code.
   Procedure EDIT_INP requires 10 words of local(AUTO) storage.

PL6.E3A0      #020=EDIT_INP File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:382  

 Object Unit name= EDIT_INP                                   File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:53:24.88 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     2      2  EDIT_INP
    1   Proc  even  none    52     64  EDIT_INP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  EDIT_INP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
PL6.E3A0      #020=EDIT_INP File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:383  


     1530        1        /*T***********************************************************/
     1531        2        /*T*                                                         */
     1532        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1533        4        /*T*                                                         */
     1534        5        /*T***********************************************************/
     1535        6        EDIT_INP:PROC(BUF);

      6  1 000000   000000 700200 xent  EDIT_INP     TSX0  ! X66_AUTO_1
         1 000001   000012 000001                    ZERO    10,1

     1536        7        /* Edits a console input string */
     1537        8        /* (any character followed by DEL or BS is deleted) */
     1538        9        /**/
     1539       10    1   DCL 1 BUF,
     1540       11    1         2 CNT UBIN WORD,
     1541       12    1         2 TXT CHAR(BUF.CNT);
     1542       13        /**/
     1543       14    1   DCL BDEL BIT(9) CALIGNED STATIC INIT('177'O); /* ASCII for DEL                */
     1544       15    1   DCL DEL REDEF BDEL CHAR(1);
     1545       16    1   DCL BBS BIT(9) CALIGNED STATIC INIT('010'O); /* ASCII for BS                  */
     1546       17    1   DCL BS REDEF BBS CHAR(1);
     1547       18    1   DCL CH CHAR(1);
     1548       19    1   DCL I UBIN WORD;
     1549       20    1   DCL J UBIN WORD;
     1550       21        /**/
     1551       22    1           I=0;

     22  1 000002   200005 450100                    STZ     I,,AUTO

     1552       23    2           DO J=0 TO BUF.CNT-1;

     23  1 000003   200006 450100                    STZ     J,,AUTO
         1 000004   000057 710000 1                  TRA     s:33+3

     1553       24    2             CH=SUBSTR(BUF.TXT,I,1);

PL6.E3A0      #020=EDIT_INP File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:384  
     24  1 000005   200003 470500                    LDP0    @BUF,,AUTO
         1 000006   000000 720100                    LXL0    0,,PR0
         1 000007   200005 235100                    LDA     I,,AUTO
         1 000010   040100 100505                    MLR     fill='040'O
         1 000011   000001 000001                    ADSC9   1,A,PR0                  cn=0,n=1
         1 000012   200004 000001                    ADSC9   CH,,AUTO                 cn=0,n=1

     1554       25    3             IF CH=DEL OR CH=BS THEN DO;

     25  1 000013   200004 236100                    LDQ     CH,,AUTO
         1 000014   000000 676000 0                  ERQ     BDEL
         1 000015   777000 376003                    ANQ     -512,DU
         1 000016   000023 600000 1                  TZE     s:26
         1 000017   200004 236100                    LDQ     CH,,AUTO
         1 000020   000001 676000 0                  ERQ     BBS
         1 000021   777000 376003                    ANQ     -512,DU
         1 000022   000052 601000 1                  TNZ     s:32

     1555       26    3                   IF I=0 THEN SUBSTR(BUF.TXT,0)=SUBSTR(BUF.TXT,1);

     26  1 000023   000000 115003                    CMPA    0,DU
         1 000024   000032 601000 1                  TNZ     s:28

     26  1 000025   777777 621010                    EAX1    -1,X0
         1 000026   040140 100540                    MLR     fill='040'O
         1 000027   000001 200011                    ADSC9   1,,PR0                   cn=1,n=*X1
         1 000030   000001 000010                    ADSC9   1,,PR0                   cn=0,n=*X0
         1 000031   000054 710000 1                  TRA     s:33

     1556       27    4                     ELSE DO;

     1557       28    4                         SUBSTR(BUF.TXT,I-1)=SUBSTR(BUF.TXT,I+1);

     28  1 000032   000000 636010                    EAQ     0,X0
         1 000033   000022 772000                    QRL     18
         1 000034   200005 136100                    SBLQ    I,,AUTO
         1 000035   200010 756100                    STQ     J+2,,AUTO
PL6.E3A0      #020=EDIT_INP File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:385  
         1 000036   000000 636010                    EAQ     0,X0
         1 000037   000022 772000                    QRL     18
         1 000040   200005 136100                    SBLQ    I,,AUTO
         1 000041   777777 620006                    EAX0    -1,QL
         1 000042   200010 721100                    LXL1    J+2,,AUTO
         1 000043   000001 622011                    EAX2    1,X1
         1 000044   040145 100545                    MLR     fill='040'O
         1 000045   000001 200010                    ADSC9   1,A,PR0                  cn=1,n=*X0
         1 000046   000000 600012                    ADSC9   0,A,PR0                  cn=3,n=*X2

     1558       29    4                         I=I-1;

     29  1 000047   000001 135007                    SBLA    1,DL
         1 000050   200005 755100                    STA     I,,AUTO

     1559       30    4                       END;                /* ELSE                               */

     1560       31    3                 END;                      /*THEN                                */

     31  1 000051   000054 710000 1                  TRA     s:33

     1561       32    2               ELSE I=I+1;

     32  1 000052   000001 035007                    ADLA    1,DL
         1 000053   200005 755100                    STA     I,,AUTO

     1562       33    2           END;                            /* DO                                 */

     33  1 000054   200006 236100                    LDQ     J,,AUTO
         1 000055   000001 036007                    ADLQ    1,DL
         1 000056   200006 756100                    STQ     J,,AUTO
         1 000057   200003 470500                    LDP0    @BUF,,AUTO
         1 000060   200006 236100                    LDQ     J,,AUTO
         1 000061   000000 116100                    CMPQ    0,,PR0
         1 000062   000005 602000 1                  TNC     s:24

     1563       34    1           RETURN;
PL6.E3A0      #020=EDIT_INP File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:386  

     34  1 000063   000000 702200 xent               TSX2  ! X66_ARET
     1564       35    1   END EDIT_INP;
     1565       36        %EOD;

PL6.E3A0      #020=EDIT_INP File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:387  
      No diagnostics issued in procedure EDIT_INP.
PL6.E3A0      #020=EDIT_INP File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:388  

 **** Variables and constants ****

  ****  Section 000  Data  EDIT_INP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/c BIT (9)     r     1 BBS                        0-0-0/c BIT (9)     r     1 BDEL
     1-0-0/c CHAR        r     1 BS                         0-0-0/c CHAR        r     1 DEL

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @BUF                      *0-0-0/w ASTR        r     1 BUF
     4-0-0/c CHAR        r     1 CH                         5-0-0/w UBIN        r     1 I
     6-0-0/w UBIN        r     1 J


   Procedure EDIT_INP requires 52 words for executable code.
   Procedure EDIT_INP requires 10 words of local(AUTO) storage.
PL6.E3A0      #020=EDIT_INP File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:389  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #020=EDIT_INP File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:390  
          MINI XREF LISTING

BBS
        16**DCL        17--REDEF
BDEL
        14**DCL        15--REDEF
BS
        17**DCL        25>>IF
BUF
        10**DCL         6--PROC
BUF.CNT
        11**DCL        12--IMP-SIZ    23>>DOINDEX    24>>ASSIGN     26>>ASSIGN     26>>ASSIGN     28>>ASSIGN
        28>>ASSIGN
BUF.TXT
        12**DCL        24>>ASSIGN     26<<ASSIGN     26>>ASSIGN     28<<ASSIGN     28>>ASSIGN
CH
        18**DCL        24<<ASSIGN     25>>IF         25>>IF
DEL
        15**DCL        25>>IF
I
        19**DCL        22<<ASSIGN     24>>ASSIGN     26>>IF         28>>ASSIGN     28>>ASSIGN     29<<ASSIGN
        29>>ASSIGN     32<<ASSIGN     32>>ASSIGN
J
        20**DCL        23<<DOINDEX

PL6.E3A0      #021=UPPER_CASE File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:391  
     1566        1        /*T***********************************************************/
     1567        2        /*T*                                                         */
     1568        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1569        4        /*T*                                                         */
     1570        5        /*T***********************************************************/
     1571        6        UPPER_CASE:PROC(BUF,L);
     1572        7        /* Converts characters in BUF on length L
     1573        8            in upper_case characters               */
     1574        9        %INCLUDE IS$MACROS;
     1575     1284    1   DCL L UBIN WORD;
     1576     1285    1   DCL BUF CHAR(L);
     1577     1286    1   DCL BCH BIT(9) CALIGNED BASED(CH$);
     1578     1287    1   DCL BINCH UBIN(9) CALIGNED BASED(CH$);
     1579     1288    1   DCL OLLIM BIT(9) CALIGNED STATIC INIT('141'O); /* Lower limit of low case ASCII */
     1580     1289    1   DCL LLIM REDEF OLLIM UBIN(9) UNAL;
     1581     1290    1   DCL OULIM BIT(9) CALIGNED STATIC INIT('172'O); /* Upper limit of low case ASCII */
     1582     1291    1   DCL ULIM REDEF OULIM UBIN(9) UNAL;
     1583     1292        %PTR_STRUCT(NAME=CH_PTR,STCLASS="STATIC");
     1584     1310    1   DCL CH$ REDEF CH_PTR PTR;
     1585     1311    1   DCL 1 CH_AD REDEF CH_PTR,
     1586     1312    1         2 BYTEAD UBIN(20) UNAL,
     1587     1313    1         2 * BIT(16);
     1588     1314    1   DCL UP BIT(9) CALIGNED STATIC INIT('737'O);
     1589     1315    1   DCL I UBIN WORD;
     1590     1316        /**/
     1591     1317    1           CH$=ADDR(BUF);
     1592     1318    2           DO I=0 TO L-1;
     1593     1319    2             IF(BINCH>=LLIM AND BINCH<=ULIM) THEN BCH=BCH&UP;
     1594     1320    2               ELSE;
     1595     1321        /* Update POINTER to next character */
     1596     1322    2             CH_AD.BYTEAD=CH_AD.BYTEAD+1;
     1597     1323    2           END;                            /* DO                                 */
     1598     1324    1           RETURN;
     1599     1325    1   END UPPER_CASE;
     1600     1326        %EOD;

PL6.E3A0      #021=UPPER_CASE File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:392  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure UPPER_CASE.

   Procedure UPPER_CASE requires 50 words for executable code.
   Procedure UPPER_CASE requires 10 words of local(AUTO) storage.

PL6.E3A0      #021=UPPER_CASE File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:393  

 Object Unit name= UPPER_CASE                                 File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:53:26.68 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     4      4  UPPER_CASE
    1   Proc  even  none    50     62  UPPER_CASE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        2  UPPER_CASE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL
PL6.E3A0      #021=UPPER_CASE File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:394  


     1566        1        /*T***********************************************************/
     1567        2        /*T*                                                         */
     1568        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1569        4        /*T*                                                         */
     1570        5        /*T***********************************************************/
     1571        6        UPPER_CASE:PROC(BUF,L);

      6  1 000000   000000 700200 xent  UPPER_CASE   TSX0  ! X66_AUTO_2
         1 000001   000012 000002                    ZERO    10,2

     1572        7        /* Converts characters in BUF on length L
     1573        8            in upper_case characters               */
     1574        9        %INCLUDE IS$MACROS;
     1575     1284    1   DCL L UBIN WORD;
     1576     1285    1   DCL BUF CHAR(L);
     1577     1286    1   DCL BCH BIT(9) CALIGNED BASED(CH$);
     1578     1287    1   DCL BINCH UBIN(9) CALIGNED BASED(CH$);
     1579     1288    1   DCL OLLIM BIT(9) CALIGNED STATIC INIT('141'O); /* Lower limit of low case ASCII */
     1580     1289    1   DCL LLIM REDEF OLLIM UBIN(9) UNAL;
     1581     1290    1   DCL OULIM BIT(9) CALIGNED STATIC INIT('172'O); /* Upper limit of low case ASCII */
     1582     1291    1   DCL ULIM REDEF OULIM UBIN(9) UNAL;
     1583     1292        %PTR_STRUCT(NAME=CH_PTR,STCLASS="STATIC");
     1584     1310    1   DCL CH$ REDEF CH_PTR PTR;
     1585     1311    1   DCL 1 CH_AD REDEF CH_PTR,
     1586     1312    1         2 BYTEAD UBIN(20) UNAL,
     1587     1313    1         2 * BIT(16);
     1588     1314    1   DCL UP BIT(9) CALIGNED STATIC INIT('737'O);
     1589     1315    1   DCL I UBIN WORD;
     1590     1316        /**/
     1591     1317    1           CH$=ADDR(BUF);

   1317  1 000002   200003 236100                    LDQ     @BUF,,AUTO
         1 000003   000002 756000 0                  STQ     CH_PTR

     1592     1318    2           DO I=0 TO L-1;

PL6.E3A0      #021=UPPER_CASE File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:395  
   1318  1 000004   200005 450100                    STZ     I,,AUTO
         1 000005   000055 710000 1                  TRA     s:1323+3

     1593     1319    2             IF(BINCH>=LLIM AND BINCH<=ULIM) THEN BCH=BCH&UP;

   1319  1 000006   000000 236000 0                  LDQ     OLLIM
         1 000007   000033 772000                    QRL     27
         1 000010   200006 756100                    STQ     I+1,,AUTO
         1 000011   000002 470400 0                  LDP0    CH_PTR
         1 000012   000100 101500                    MRL     fill='000'O
         1 000013   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000014   200007 000004                    ADSC9   I+2,,AUTO                cn=0,n=4
         1 000015   200007 236100                    LDQ     I+2,,AUTO
         1 000016   200006 116100                    CMPQ    I+1,,AUTO
         1 000017   000043 604000 1                  TMI     s:1322
         1 000020   000100 101500                    MRL     fill='000'O
         1 000021   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000022   200010 000004                    ADSC9   I+3,,AUTO                cn=0,n=4
         1 000023   000001 236000 0                  LDQ     OULIM
         1 000024   000033 772000                    QRL     27
         1 000025   200010 116100                    CMPQ    I+3,,AUTO
         1 000026   000043 604000 1                  TMI     s:1322

   1319  1 000027   000003 236000 0                  LDQ     UP
         1 000030   777000 376003                    ANQ     -512,DU
         1 000031   200006 756100                    STQ     I+1,,AUTO
         1 000032   000100 100500                    MLR     fill='000'O
         1 000033   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000034   200007 000004                    ADSC9   I+2,,AUTO                cn=0,n=4
         1 000035   200007 236100                    LDQ     I+2,,AUTO
         1 000036   200006 376100                    ANQ     I+1,,AUTO
         1 000037   200010 756100                    STQ     I+3,,AUTO
         1 000040   000100 100500                    MLR     fill='000'O
         1 000041   200010 000004                    ADSC9   I+3,,AUTO                cn=0,n=4
         1 000042   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1594     1320    2               ELSE;
PL6.E3A0      #021=UPPER_CASE File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:396  
     1595     1321        /* Update POINTER to next character */
     1596     1322    2             CH_AD.BYTEAD=CH_AD.BYTEAD+1;

   1322  1 000043   000002 236000 0                  LDQ     CH_PTR
         1 000044   000020 772000                    QRL     16
         1 000045   000001 036007                    ADLQ    1,DL
         1 000046   000020 736000                    QLS     16
         1 000047   000002 676000 0                  ERQ     CH_PTR
         1 000050   000034 376000 xsym               ANQ     B_VECTNIL+28
         1 000051   000002 656000 0                  ERSQ    CH_PTR

     1597     1323    2           END;                            /* DO                                 */

   1323  1 000052   200005 235100                    LDA     I,,AUTO
         1 000053   000001 035007                    ADLA    1,DL
         1 000054   200005 755100                    STA     I,,AUTO
         1 000055   200004 470500                    LDP0    @L,,AUTO
         1 000056   200005 236100                    LDQ     I,,AUTO
         1 000057   000000 116100                    CMPQ    0,,PR0
         1 000060   000006 602000 1                  TNC     s:1319

     1598     1324    1           RETURN;

   1324  1 000061   000000 702200 xent               TSX2  ! X66_ARET
     1599     1325    1   END UPPER_CASE;
     1600     1326        %EOD;

PL6.E3A0      #021=UPPER_CASE File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:397  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure UPPER_CASE.
PL6.E3A0      #021=UPPER_CASE File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:398  

 **** Variables and constants ****

  ****  Section 000  Data  UPPER_CASE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/w PTR         r     1 CH$                        2-0-0/w STRC        r     1 CH_AD
     2-0-0/w STRC        r     1 CH_PTR                     0-0-0/c UBIN(9)     r     1 LLIM
     0-0-0/c BIT (9)     r     1 OLLIM                      1-0-0/c BIT (9)     r     1 OULIM
     1-0-0/c UBIN(9)     r     1 ULIM                       3-0-0/c BIT (9)     r     1 UP

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @BUF                       4-0-0/w PTR         r     1 @L
    *0-0-0/c ACHR        r     1 BUF                        5-0-0/w UBIN        r     1 I
    *0-0-0/w UBIN        r     1 L

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c BIT (9)     r     1 BCH                        0-0-0/c UBIN(9)     r     1 BINCH


   Procedure UPPER_CASE requires 50 words for executable code.
   Procedure UPPER_CASE requires 10 words of local(AUTO) storage.
PL6.E3A0      #021=UPPER_CASE File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:399  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #021=UPPER_CASE File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:400  
          MINI XREF LISTING

BCH
      1286**DCL      1319<<ASSIGN   1319>>ASSIGN
BINCH
      1287**DCL      1319>>IF       1319>>IF
BUF
      1285**DCL         6--PROC     1317--ASSIGN
CH$
      1310**DCL      1286--IMP-PTR  1287--IMP-PTR  1317<<ASSIGN   1319>>IF       1319>>IF       1319>>ASSIGN
      1319>>ASSIGN
CH_AD.BYTEAD
      1312**DCL      1322<<ASSIGN   1322>>ASSIGN
CH_PTR
      1303**DCL      1310--REDEF    1311--REDEF
I
      1315**DCL      1318<<DOINDEX
L
      1284**DCL         6--PROC     1285--IMP-SIZ  1318>>DOINDEX
LLIM
      1289**DCL      1319>>IF
OLLIM
      1288**DCL      1289--REDEF
OULIM
      1290**DCL      1291--REDEF
ULIM
      1291**DCL      1319>>IF
UP
      1314**DCL      1319>>ASSIGN

PL6.E3A0      #022=GETFD File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:401  
     1601        1        /*T***********************************************************/
     1602        2        /*T*                                                         */
     1603        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1604        4        /*T*                                                         */
     1605        5        /*T***********************************************************/
     1606        6        GETFD:  PROC(BUF,L) ALTRET;
     1607        7        /* This programm gets a field from an input
     1608        8           buffer:BUF of length L                   */
     1609        9        /* Result:  -if only blanks-> ALTRET,
     1610       10                    -otherwise beginning of field->FIELD$,
     1611       11                               field length->FIELD_LEN,
     1612       12                               -if DECIMAL->DECIM_FLG='1'B,
     1613       13                               -otherwise->ALPHA_FLG='1'B.  */
     1614       14        /**/
     1615       15        %INCLUDE IS$MACROS;
     1616     1290        /**/
     1617     1291    1   DCL L UBIN WORD;
     1618     1292    1   DCL BUF CHAR(L);
     1619     1293        /**/
     1620     1294    1   DCL TERMINATORS CHAR(6) STATIC INIT(' =+-<>');
     1621     1295    1   DCL ALPHA_FLG STATIC SYMDEF BIT(1) INIT('0'B);
     1622     1296    1   DCL DECIM_FLG STATIC SYMDEF BIT(1) INIT('0'B);
     1623     1297    1   DCL FIELD$ STATIC SYMDEF PTR;
     1624     1298    1   DCL CURR$ PTR;
     1625     1299        %PTR_STRUCT(NAME=CURR_PTR,STCLASS="REDEF CURR$");
     1626     1317    1   DCL 1 CURR_BYTE REDEF CURR$,
     1627     1318    1         2 BYTEAD UBIN(20) UNAL,
     1628     1319    1         2 * BIT(16);
     1629     1320    1   DCL FIELD_LEN UBIN WORD STATIC SYMDEF;
     1630     1321    1   DCL CH CHAR(1) BASED(CURR$);
     1631     1322    1   DCL I UBIN;
     1632     1323    1   DCL J UBIN;
     1633     1324    1   DCL J1 UBIN;
     1634     1325        /**/
     1635     1326    1           DECIM_FLG='0'B;
     1636     1327    1           ALPHA_FLG='0'B;
     1637     1328    1           FIELD_LEN=0;
PL6.E3A0      #022=GETFD File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:402  
     1638     1329    1           FIELD$=ADDR(BUF);
     1639     1330    1           CURR$=ADDR(BUF);
     1640     1331    1           IF BUF=' ' THEN ALTRETURN;
     1641     1332    1             ELSE;
     1642     1333    2           DO I=0 TO L-1;
     1643     1334    2             IF CH~=' ' THEN GOTO BLKSBURNED;
     1644     1335    2               ELSE;                       /* Burn leading blanks                */
     1645     1336        /* Update pointer */
     1646     1337    2             CURR_BYTE.BYTEAD=CURR_BYTE.BYTEAD+1;
     1647     1338    2           END;                            /* DO                                 */
     1648     1339    1   BLKSBURNED:
     1649     1340    1           FIELD$=CURR$;
     1650     1341    2           DO J=I TO L-1;
     1651     1342    2             CALL INDEX(J1,CH,TERMINATORS); /* Terminator ?                      */
     1652     1343    3             IF J1>=6 THEN DO;             /* No                                 */
     1653     1344        /* Find out what kind of a character this is */
     1654     1345    3                   IF ASCBIN(CH)>=ASCBIN('0')&ASCBIN(CH)<=ASCBIN('9') THEN GOTO ITSDEC;
     1655     1346    3                     ELSE;
     1656     1347    3   ITSALPH:
     1657     1348    3                   IF DECIM_FLG='1'B THEN GOTO THATSALL;
     1658     1349    3                     ELSE;
     1659     1350    3                   ALPHA_FLG='1'B;
     1660     1351    3                   GOTO UPD_POINT;
     1661     1352    3   ITSDEC:
     1662     1353    3                   IF ALPHA_FLG='1'B THEN GOTO THATSALL;
     1663     1354    3                     ELSE;
     1664     1355    3                   DECIM_FLG='1'B;
     1665     1356    3                   GOTO UPD_POINT;
     1666     1357    3   THATSALL:
     1667     1358    3                   FIELD_LEN=J-I;
     1668     1359    3                   IF FIELD_LEN=0 THEN ALTRETURN;
     1669     1360    3                   RETURN;
     1670     1361    3   UPD_POINT:
     1671     1362    3                   CURR_BYTE.BYTEAD=CURR_BYTE.BYTEAD+1;
     1672     1363    3                 END;                      /* THEN                               */
     1673     1364    2               ELSE GOTO THATSALL;
     1674     1365    2           END;                            /* DO                                 */
PL6.E3A0      #022=GETFD File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:403  
     1675     1366    1           FIELD_LEN=L-I;
     1676     1367    1           RETURN;
     1677     1368    1   END GETFD;
     1678     1369        %EOD;

PL6.E3A0      #022=GETFD File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:404  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure GETFD.

   Procedure GETFD requires 106 words for executable code.
   Procedure GETFD requires 14 words of local(AUTO) storage.

PL6.E3A0      #022=GETFD File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:405  

 Object Unit name= GETFD                                      File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:53:29.60 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     6      6  GETFD
    1   Proc  even  none   106    152  GETFD

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  GETFD

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      2  ALPHA_FLG                          0      3  DECIM_FLG
    0      4  FIELD$                             0      5  FIELD_LEN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #022=GETFD File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:406  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL
PL6.E3A0      #022=GETFD File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:407  


     1601        1        /*T***********************************************************/
     1602        2        /*T*                                                         */
     1603        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1604        4        /*T*                                                         */
     1605        5        /*T***********************************************************/
     1606        6        GETFD:  PROC(BUF,L) ALTRET;

      6  1 000000   000000 700200 xent  GETFD        TSX0  ! X66_AUTO_2
         1 000001   000016 000002                    ZERO    14,2

     1607        7        /* This programm gets a field from an input
     1608        8           buffer:BUF of length L                   */
     1609        9        /* Result:  -if only blanks-> ALTRET,
     1610       10                    -otherwise beginning of field->FIELD$,
     1611       11                               field length->FIELD_LEN,
     1612       12                               -if DECIMAL->DECIM_FLG='1'B,
     1613       13                               -otherwise->ALPHA_FLG='1'B.  */
     1614       14        /**/
     1615       15        %INCLUDE IS$MACROS;
     1616     1290        /**/
     1617     1291    1   DCL L UBIN WORD;
     1618     1292    1   DCL BUF CHAR(L);
     1619     1293        /**/
     1620     1294    1   DCL TERMINATORS CHAR(6) STATIC INIT(' =+-<>');
     1621     1295    1   DCL ALPHA_FLG STATIC SYMDEF BIT(1) INIT('0'B);
     1622     1296    1   DCL DECIM_FLG STATIC SYMDEF BIT(1) INIT('0'B);
     1623     1297    1   DCL FIELD$ STATIC SYMDEF PTR;
     1624     1298    1   DCL CURR$ PTR;
     1625     1299        %PTR_STRUCT(NAME=CURR_PTR,STCLASS="REDEF CURR$");
     1626     1317    1   DCL 1 CURR_BYTE REDEF CURR$,
     1627     1318    1         2 BYTEAD UBIN(20) UNAL,
     1628     1319    1         2 * BIT(16);
     1629     1320    1   DCL FIELD_LEN UBIN WORD STATIC SYMDEF;
     1630     1321    1   DCL CH CHAR(1) BASED(CURR$);
     1631     1322    1   DCL I UBIN;
     1632     1323    1   DCL J UBIN;
PL6.E3A0      #022=GETFD File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:408  
     1633     1324    1   DCL J1 UBIN;
     1634     1325        /**/
     1635     1326    1           DECIM_FLG='0'B;

   1326  1 000002   000003 450000 0                  STZ     DECIM_FLG

     1636     1327    1           ALPHA_FLG='0'B;

   1327  1 000003   000002 450000 0                  STZ     ALPHA_FLG

     1637     1328    1           FIELD_LEN=0;

   1328  1 000004   000005 450000 0                  STZ     FIELD_LEN

     1638     1329    1           FIELD$=ADDR(BUF);

   1329  1 000005   200003 236100                    LDQ     @BUF,,AUTO
         1 000006   000004 756000 0                  STQ     FIELD$

     1639     1330    1           CURR$=ADDR(BUF);

   1330  1 000007   200005 756100                    STQ     CURR$,,AUTO

     1640     1331    1           IF BUF=' ' THEN ALTRETURN;

   1331  1 000010   200004 470500                    LDP0    @L,,AUTO
         1 000011   000000 720100                    LXL0    0,,PR0
         1 000012   200003 471500                    LDP1    @BUF,,AUTO
         1 000013   040000 106540                    CMPC    fill='040'O
         1 000014   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         1 000015   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000016   000020 601000 1                  TNZ     s:1333

   1331  1 000017   000000 702200 xent               TSX2  ! X66_AALT

     1641     1332    1             ELSE;
     1642     1333    2           DO I=0 TO L-1;
PL6.E3A0      #022=GETFD File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:409  

   1333  1 000020   200006 450100                    STZ     I,,AUTO
         1 000021   000041 710000 1                  TRA     s:1338+3

     1643     1334    2             IF CH~=' ' THEN GOTO BLKSBURNED;

   1334  1 000022   200005 470500                    LDP0    CURR$,,AUTO
         1 000023   040000 106500                    CMPC    fill='040'O
         1 000024   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000025   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000026   000045 601000 1                  TNZ     BLKSBURNED

     1644     1335    2               ELSE;                       /* Burn leading blanks                */
     1645     1336        /* Update pointer */
     1646     1337    2             CURR_BYTE.BYTEAD=CURR_BYTE.BYTEAD+1;

   1337  1 000027   200005 236100                    LDQ     CURR$,,AUTO
         1 000030   000020 772000                    QRL     16
         1 000031   000001 036007                    ADLQ    1,DL
         1 000032   000020 736000                    QLS     16
         1 000033   200005 676100                    ERQ     CURR$,,AUTO
         1 000034   000034 376000 xsym               ANQ     B_VECTNIL+28
         1 000035   200005 656100                    ERSQ    CURR$,,AUTO

     1647     1338    2           END;                            /* DO                                 */

   1338  1 000036   200006 235100                    LDA     I,,AUTO
         1 000037   000001 035007                    ADLA    1,DL
         1 000040   200006 755100                    STA     I,,AUTO
         1 000041   200004 470500                    LDP0    @L,,AUTO
         1 000042   200006 236100                    LDQ     I,,AUTO
         1 000043   000000 116100                    CMPQ    0,,PR0
         1 000044   000022 602000 1                  TNC     s:1334

     1648     1339    1   BLKSBURNED:
     1649     1340    1           FIELD$=CURR$;

PL6.E3A0      #022=GETFD File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:410  
   1340  1 000045   200005 236100       BLKSBURNED   LDQ     CURR$,,AUTO
         1 000046   000004 756000 0                  STQ     FIELD$

     1650     1341    2           DO J=I TO L-1;

   1341  1 000047   200006 235100                    LDA     I,,AUTO
         1 000050   200007 755100                    STA     J,,AUTO
         1 000051   000142 710000 1                  TRA     s:1365+3

     1651     1342    2             CALL INDEX(J1,CH,TERMINATORS); /* Terminator ?                      */

   1342  1 000052   200005 470500                    LDP0    CURR$,,AUTO
         1 000053   000100 124400                    SCM     mask='000'O
         1 000054   000000 000006 0                  ADSC9   TERMINATORS              cn=0,n=6
         1 000055   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000056   200010 000100                    ARG     J1,,AUTO

     1652     1343    3             IF J1>=6 THEN DO;             /* No                                 */

   1343  1 000057   200010 235100                    LDA     J1,,AUTO
         1 000060   000006 115007                    CMPA    6,DL
         1 000061   000121 602000 1                  TNC     THATSALL

     1653     1344        /* Find out what kind of a character this is */
     1654     1345    3                  IF ASCBIN(CH)>=ASCBIN('0')&ASCBIN(CH)<=ASCBIN('9') THEN GOTO ITSDEC;

   1345  1 000062   000100 101500                    MRL     fill='000'O
         1 000063   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000064   200012 000004                    ADSC9   J1+2,,AUTO               cn=0,n=4
         1 000065   200012 236100                    LDQ     J1+2,,AUTO
         1 000066   400000 220003                    LDX0    -131072,DU
         1 000067   000060 116007                    CMPQ    48,DL
         1 000070   000072 603000 1                  TRC     s:1345+8
         1 000071   000000 220003                    LDX0    0,DU
         1 000072   000100 101500                    MRL     fill='000'O
         1 000073   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000074   200013 000004                    ADSC9   J1+3,,AUTO               cn=0,n=4
PL6.E3A0      #022=GETFD File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:411  
         1 000075   200013 236100                    LDQ     J1+3,,AUTO
         1 000076   400000 221003                    LDX1    -131072,DU
         1 000077   000072 116007                    CMPQ    58,DL
         1 000100   000102 602000 1                  TNC     s:1345+16
         1 000101   000000 221003                    LDX1    0,DU
         1 000102   000000 636011                    EAQ     0,X1
         1 000103   200014 756100                    STQ     J1+4,,AUTO
         1 000104   000000 636010                    EAQ     0,X0
         1 000105   200014 376100                    ANQ     J1+4,,AUTO
         1 000106   000114 601000 1                  TNZ     ITSDEC

     1655     1346    3                     ELSE;
     1656     1347    3   ITSALPH:
     1657     1348    3                   IF DECIM_FLG='1'B THEN GOTO THATSALL;

   1348  1 000107   000003 234000 0     ITSALPH      SZN     DECIM_FLG
         1 000110   000121 604000 1                  TMI     THATSALL

     1658     1349    3                     ELSE;
     1659     1350    3                   ALPHA_FLG='1'B;

   1350  1 000111   400000 236003                    LDQ     -131072,DU
         1 000112   000002 756000 0                  STQ     ALPHA_FLG

     1660     1351    3                   GOTO UPD_POINT;

   1351  1 000113   000127 710000 1                  TRA     UPD_POINT

     1661     1352    3   ITSDEC:
     1662     1353    3                   IF ALPHA_FLG='1'B THEN GOTO THATSALL;

   1353  1 000114   000002 234000 0     ITSDEC       SZN     ALPHA_FLG
         1 000115   000121 604000 1                  TMI     THATSALL

     1663     1354    3                     ELSE;
     1664     1355    3                   DECIM_FLG='1'B;

PL6.E3A0      #022=GETFD File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:412  
   1355  1 000116   400000 236003                    LDQ     -131072,DU
         1 000117   000003 756000 0                  STQ     DECIM_FLG

     1665     1356    3                   GOTO UPD_POINT;

   1356  1 000120   000127 710000 1                  TRA     UPD_POINT

     1666     1357    3   THATSALL:
     1667     1358    3                   FIELD_LEN=J-I;

   1358  1 000121   200007 236100       THATSALL     LDQ     J,,AUTO
         1 000122   200006 136100                    SBLQ    I,,AUTO
         1 000123   000005 756000 0                  STQ     FIELD_LEN

     1668     1359    3                   IF FIELD_LEN=0 THEN ALTRETURN;

   1359  1 000124   000126 601000 1                  TNZ     s:1360

   1359  1 000125   000000 702200 xent               TSX2  ! X66_AALT

     1669     1360    3                   RETURN;

   1360  1 000126   000000 702200 xent               TSX2  ! X66_ARET

     1670     1361    3   UPD_POINT:
     1671     1362    3                   CURR_BYTE.BYTEAD=CURR_BYTE.BYTEAD+1;

   1362  1 000127   200005 236100       UPD_POINT    LDQ     CURR$,,AUTO
         1 000130   000020 772000                    QRL     16
         1 000131   000001 036007                    ADLQ    1,DL
         1 000132   000020 736000                    QLS     16
         1 000133   200005 676100                    ERQ     CURR$,,AUTO
         1 000134   000034 376000 xsym               ANQ     B_VECTNIL+28
         1 000135   200005 656100                    ERSQ    CURR$,,AUTO

     1672     1363    3                 END;                      /* THEN                               */

PL6.E3A0      #022=GETFD File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:413  
   1363  1 000136   000137 710000 1                  TRA     s:1365

     1673     1364    2               ELSE GOTO THATSALL;
     1674     1365    2           END;                            /* DO                                 */

   1365  1 000137   200007 236100                    LDQ     J,,AUTO
         1 000140   000001 036007                    ADLQ    1,DL
         1 000141   200007 756100                    STQ     J,,AUTO
         1 000142   200004 470500                    LDP0    @L,,AUTO
         1 000143   200007 236100                    LDQ     J,,AUTO
         1 000144   000000 116100                    CMPQ    0,,PR0
         1 000145   000052 602000 1                  TNC     s:1342

     1675     1366    1           FIELD_LEN=L-I;

   1366  1 000146   000000 236100                    LDQ     0,,PR0
         1 000147   200006 136100                    SBLQ    I,,AUTO
         1 000150   000005 756000 0                  STQ     FIELD_LEN

     1676     1367    1           RETURN;

   1367  1 000151   000000 702200 xent               TSX2  ! X66_ARET
     1677     1368    1   END GETFD;
     1678     1369        %EOD;

PL6.E3A0      #022=GETFD File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:414  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure GETFD.
PL6.E3A0      #022=GETFD File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:415  

 **** Variables and constants ****

  ****  Section 000  Data  GETFD

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/b BIT         r     1 ALPHA_FLG                  3-0-0/b BIT         r     1 DECIM_FLG
     4-0-0/w PTR         r     1 FIELD$                     5-0-0/w UBIN        r     1 FIELD_LEN
     0-0-0/c CHAR(6)     r     1 TERMINATORS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @BUF                       4-0-0/w PTR         r     1 @L
    *0-0-0/c ACHR        r     1 BUF                        5-0-0/w PTR         r     1 CURR$
     5-0-0/w STRC        r     1 CURR_BYTE                  6-0-0/w UBIN        r     1 I
     7-0-0/w UBIN        r     1 J                         10-0-0/w UBIN        r     1 J1
    *0-0-0/w UBIN        r     1 L

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 CH


   Procedure GETFD requires 106 words for executable code.
   Procedure GETFD requires 14 words of local(AUTO) storage.
PL6.E3A0      #022=GETFD File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:416  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #022=GETFD File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:417  
          MINI XREF LISTING

ALPHA_FLG
      1295**DCL      1327<<ASSIGN   1350<<ASSIGN   1353>>IF
BLKSBURNED
      1340**LABEL    1334--GOTO
BUF
      1292**DCL         6--PROC     1329--ASSIGN   1330--ASSIGN   1331>>IF
CH
      1321**DCL      1334>>IF       1342>>CALLBLT  1345>>IF       1345>>IF
CURR$
      1298**DCL      1310--REDEF    1317--REDEF    1321--IMP-PTR  1330<<ASSIGN   1334>>IF       1340>>ASSIGN
      1342>>CALLBLT  1345>>IF       1345>>IF
CURR_BYTE.BYTEAD
      1318**DCL      1337<<ASSIGN   1337>>ASSIGN   1362<<ASSIGN   1362>>ASSIGN
DECIM_FLG
      1296**DCL      1326<<ASSIGN   1348>>IF       1355<<ASSIGN
FIELD$
      1297**DCL      1329<<ASSIGN   1340<<ASSIGN
FIELD_LEN
      1320**DCL      1328<<ASSIGN   1358<<ASSIGN   1359>>IF       1366<<ASSIGN
I
      1322**DCL      1333<<DOINDEX  1341>>DOINDEX  1358>>ASSIGN   1366>>ASSIGN
ITSDEC
      1353**LABEL    1345--GOTO
J
      1323**DCL      1341<<DOINDEX  1358>>ASSIGN
J1
      1324**DCL      1342<<CALLBLT  1343>>IF
L
      1291**DCL         6--PROC     1292--IMP-SIZ  1331>>IF       1333>>DOINDEX  1341>>DOINDEX  1366>>ASSIGN
TERMINATORS
      1294**DCL      1342>>CALLBLT
THATSALL
PL6.E3A0      #022=GETFD File=ISI$IOPROC.:E05TSI                                 TUE 07/29/97 22:53 Page:418  
      1358**LABEL    1348--GOTO     1353--GOTO     1364--GOTO
UPD_POINT
      1362**LABEL    1351--GOTO     1356--GOTO

PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:419  
     1679        1        /*T***********************************************************/
     1680        2        /*T*                                                         */
     1681        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1682        4        /*T*                                                         */
     1683        5        /*T***********************************************************/
     1684        6        GT_SYSPACKAD:PROC(INDX);
     1685        7        /* This program obtains the address of a disk pack */
     1686        8        /* For system pack : CALL GT_SYSPACKAD ,
     1687        9           for another pack: CALL GT_PACKAD      */
     1688       10        %INCLUDE IS$MACROS;
     1689     1285    1   DCL INDX UBIN WORD;
     1690     1286        %DEVINFO(STCLASS="SYMREF");
     1691     1355        %TEXTC(N#=SYSDPQ,M#="' System pack (I-CCC-UU) = '");
     1692     1360        %TEXTC(N#=DPQ,M#="' Pack (I-CCC-UU) = '");
     1693     1365    1   DCL MESSAGE$ PTR;
     1694     1366    1   DCL 1 TEXTM BASED(MESSAGE$),
     1695     1367    1         2 CNT UBIN WORD,
     1696     1368    1         2 TXT CHAR(TEXTM.CNT);
     1697     1369    1   DCL 1 ANSBUF SYMREF,
     1698     1370    1         2 CNT UBIN WORD,
     1699     1371    1         2 TXT CHAR(16);
     1700     1372        /* GETFD results */
     1701     1373    1   DCL ALPHA_FLG BIT(1) SYMREF;
     1702     1374    1   DCL 1 ADPXF SYMREF,
     1703     1375    1         2 A BIT(1),
     1704     1376    1         2 D BIT(1),
     1705     1377    1         2 P BIT(1),
     1706     1378    1         2 X BIT(1),
     1707     1379    1         2 F BIT(1);
     1708     1380    1   DCL FIELD$ PTR SYMREF;
     1709     1381    1   DCL FIELD_LEN UBIN WORD SYMREF;
     1710     1382    1   DCL RPM_FLG BIT(1) SYMREF;
     1711     1383    1   DCL   HIGHEST_CHAN UBIN ;
     1712     1384    1   DCL ANS CHAR(16) BASED(FIELD$);
     1713     1385        /**/
     1714     1386    1   DCL   DO_RPM_CFG ENTRY(1) ALTRET;
     1715     1387    1   DCL KEYIN ENTRY(2) ALTRET;
PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:420  
     1716     1388    1   DCL GETFD ENTRY(2) ALTRET;
     1717     1389        /**/
     1718     1390    1   DCL NUMBER UBIN WORD;
     1719     1391    1   DCL   SP_IOM UBIN WORD;
     1720     1392    1   DCL   SP_CHN UBIN WORD;
     1721     1393    1   DCL DIG# UBIN WORD;
     1722     1394        /**/
     1723     1395    1           IF ADPXF.D='0'B THEN RETURN;
     1724     1396    1           HIGHEST_CHAN = %HIGH_CHAN;
     1725     1397    1           IF RPM_FLG THEN
     1726     1398    1             HIGHEST_CHAN = %HIGH_RPM_CHAN;
     1727     1399    1           MESSAGE$=ADDR(SYSDPQ);
     1728     1400    1           SUBSTR(TEXTM.TXT,14,8)=SUBSTR(DEVINFO.DEVNAME(INDX),0,8);
     1729     1401    1   ASK:
     1730     1402    1           CALL KEYIN(TEXTM,ANSBUF);
     1731     1403    1           CALL GETFD(ANSBUF.TXT,16) ALTRET(RETPACK); /* Get IOM#                */
     1732     1404    1           IF ALPHA_FLG='1'B THEN GOTO ASK;
     1733     1405    1             ELSE;
     1734     1406    1           CALL CHARBIN(SP_IOM,SUBSTR(ANS,0,FIELD_LEN));
     1735     1407    1           IF SP_IOM>%HIGHEST_IOM THEN GOTO ASK;
     1736     1408    1           IF RPM_FLG THEN
     1737     1409    1             CALL DO_RPM_CFG(SP_IOM);
     1738     1410    1           DIG#=FIELD_LEN+1;
     1739     1411    1           CALL GETFD(SUBSTR(ANSBUF.TXT,DIG#),16-DIG#) ALTRET(ASK); /* Get Channel# */
     1740     1412    1           IF ALPHA_FLG='1'B THEN GOTO ASK;
     1741     1413    1             ELSE;
     1742     1414    1           CALL CHARBIN(SP_CHN,SUBSTR(ANS,0,FIELD_LEN));
     1743     1415    1           IF SP_CHN > HIGHEST_CHAN THEN GOTO ASK;
     1744     1416    1           DIG#=DIG#+FIELD_LEN+1;
     1745     1417    1           CALL GETFD(SUBSTR(ANSBUF.TXT,DIG#),16-DIG#) ALTRET(ASK); /* Get Unit# */
     1746     1418    1           IF ALPHA_FLG='1'B THEN GOTO ASK;
     1747     1419    1             ELSE;
     1748     1420    1           CALL CHARBIN(NUMBER,SUBSTR(ANS,0,FIELD_LEN));
     1749     1421    1           DEVINFO.IOM#(INDX)=SP_IOM;
     1750     1422    1           DEVINFO.CHN#(INDX)=SP_CHN;
     1751     1423    1           DEVINFO.DEV#(INDX)=NUMBER;
     1752     1424    1           CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(INDX),0,1),DEVINFO.IOM#(INDX));
PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:421  
     1753     1425    1           CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(INDX),2,3),DEVINFO.CHN#(INDX));
     1754     1426    1           CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(INDX),6,2),DEVINFO.DEV#(INDX));
     1755     1427    1   RETPACK:
     1756     1428    1           RETURN;
     1757     1429    1   GT_PACK:ENTRY(INDX);
     1758     1430    1           MESSAGE$=ADDR(DPQ);
     1759     1431    1           SUBSTR(TEXTM.TXT,7,8)=SUBSTR(DEVINFO.DEVNAME(INDX),0,8);
     1760     1432    1           GOTO ASK;
     1761     1433    1   END GT_SYSPACKAD;
     1762     1434        %EOD;

PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:422  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure GT_SYSPACKAD.

   Procedure GT_SYSPACKAD requires 196 words for executable code.
   Procedure GT_SYSPACKAD requires 14 words of local(AUTO) storage.

PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:423  

 Object Unit name= GT_SYSPACKAD                               File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:53:33.40 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    14     16  GT_SYSPACKAD
    1   Proc  even  none   196    304  GT_SYSPACKAD
    2  RoData even  none     6      6  GT_SYSPACKAD

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  GT_SYSPACKAD
     1    266                  yes      Std        1  GT_PACK

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  SYSDPQ                             0     10  DPQ

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 KEYIN
 yes     yes           Std       2 GETFD
 yes     yes           Std       1 DO_RPM_CFG
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:424  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DEVINFO                               ANSBUF                                ALPHA_FLG
     ADPXF                                 FIELD$                                FIELD_LEN
     RPM_FLG                               B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:425  


     1679        1        /*T***********************************************************/
     1680        2        /*T*                                                         */
     1681        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1682        4        /*T*                                                         */
     1683        5        /*T***********************************************************/
     1684        6        GT_SYSPACKAD:PROC(INDX);

      6  1 000000   000000 700200 xent  GT_SYSPACKAD TSX0  ! X66_AUTO_1
         1 000001   000016 000001                    ZERO    14,1

     1685        7        /* This program obtains the address of a disk pack */
     1686        8        /* For system pack : CALL GT_SYSPACKAD ,
     1687        9           for another pack: CALL GT_PACKAD      */
     1688       10        %INCLUDE IS$MACROS;
     1689     1285    1   DCL INDX UBIN WORD;
     1690     1286        %DEVINFO(STCLASS="SYMREF");
     1691     1355        %TEXTC(N#=SYSDPQ,M#="' System pack (I-CCC-UU) = '");
     1692     1360        %TEXTC(N#=DPQ,M#="' Pack (I-CCC-UU) = '");
     1693     1365    1   DCL MESSAGE$ PTR;
     1694     1366    1   DCL 1 TEXTM BASED(MESSAGE$),
     1695     1367    1         2 CNT UBIN WORD,
     1696     1368    1         2 TXT CHAR(TEXTM.CNT);
     1697     1369    1   DCL 1 ANSBUF SYMREF,
     1698     1370    1         2 CNT UBIN WORD,
     1699     1371    1         2 TXT CHAR(16);
     1700     1372        /* GETFD results */
     1701     1373    1   DCL ALPHA_FLG BIT(1) SYMREF;
     1702     1374    1   DCL 1 ADPXF SYMREF,
     1703     1375    1         2 A BIT(1),
     1704     1376    1         2 D BIT(1),
     1705     1377    1         2 P BIT(1),
     1706     1378    1         2 X BIT(1),
     1707     1379    1         2 F BIT(1);
     1708     1380    1   DCL FIELD$ PTR SYMREF;
     1709     1381    1   DCL FIELD_LEN UBIN WORD SYMREF;
     1710     1382    1   DCL RPM_FLG BIT(1) SYMREF;
PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:426  
     1711     1383    1   DCL   HIGHEST_CHAN UBIN ;
     1712     1384    1   DCL ANS CHAR(16) BASED(FIELD$);
     1713     1385        /**/
     1714     1386    1   DCL   DO_RPM_CFG ENTRY(1) ALTRET;
     1715     1387    1   DCL KEYIN ENTRY(2) ALTRET;
     1716     1388    1   DCL GETFD ENTRY(2) ALTRET;
     1717     1389        /**/
     1718     1390    1   DCL NUMBER UBIN WORD;
     1719     1391    1   DCL   SP_IOM UBIN WORD;
     1720     1392    1   DCL   SP_CHN UBIN WORD;
     1721     1393    1   DCL DIG# UBIN WORD;
     1722     1394        /**/
     1723     1395    1           IF ADPXF.D='0'B THEN RETURN;

   1395  1 000002   000000 236000 xsym               LDQ     ADPXF
         1 000003   200000 316003                    CANQ    65536,DU
         1 000004   000006 601000 1                  TNZ     s:1396

   1395  1 000005   000000 702200 xent               TSX2  ! X66_ARET

     1724     1396    1           HIGHEST_CHAN = %HIGH_CHAN;

   1396  1 000006   000077 235007                    LDA     63,DL
         1 000007   200005 755100                    STA     HIGHEST_CHAN,,AUTO

     1725     1397    1           IF RPM_FLG THEN

   1397  1 000010   000000 234000 xsym               SZN     RPM_FLG
         1 000011   000014 605000 1                  TPL     s:1399

     1726     1398    1             HIGHEST_CHAN = %HIGH_RPM_CHAN;

   1398  1 000012   000177 235007                    LDA     127,DL
         1 000013   200005 755100                    STA     HIGHEST_CHAN,,AUTO

     1727     1399    1           MESSAGE$=ADDR(SYSDPQ);

PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:427  
   1399  1 000014   000000 236000 2                  LDQ     0
         1 000015   200004 756100                    STQ     MESSAGE$,,AUTO

     1728     1400    1           SUBSTR(TEXTM.TXT,14,8)=SUBSTR(DEVINFO.DEVNAME(INDX),0,8);

   1400  1 000016   200004 470500                    LDP0    MESSAGE$,,AUTO
         1 000017   000000 720100                    LXL0    0,,PR0
         1 000020   200003 471500                    LDP1    @INDX,,AUTO
         1 000021   100000 236100                    LDQ     0,,PR1
         1 000022   000006 402007                    MPY     6,DL
         1 000023   000003 736000                    QLS     3
         1 000024   040100 100406                    MLR     fill='040'O
         1 000025   000006 000010 xsym               ADSC9   DEVINFO+6,Q              cn=0,n=8
         1 000026   000004 400010                    ADSC9   4,,PR0                   cn=2,n=8

     1729     1401    1   ASK:
     1730     1402    1           CALL KEYIN(TEXTM,ANSBUF);

   1402  1 000027   000001 236000 2     ASK          LDQ     1
         1 000030   200004 235100                    LDA     MESSAGE$,,AUTO
         1 000031   200012 757100                    STAQ    DIG#+1,,AUTO
         1 000032   200012 630500                    EPPR0   DIG#+1,,AUTO
         1 000033   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000034   000000 701000 xent               TSX1    KEYIN
         1 000035   000000 011000                    NOP     0

     1731     1403    1           CALL GETFD(ANSBUF.TXT,16) ALTRET(RETPACK); /* Get IOM#                */

   1403  1 000036   000003 630400 2                  EPPR0   3
         1 000037   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000040   000000 701000 xent               TSX1    GETFD
         1 000041   000265 702000 1                  TSX2    RETPACK

     1732     1404    1           IF ALPHA_FLG='1'B THEN GOTO ASK;

   1404  1 000042   000000 234000 xsym               SZN     ALPHA_FLG
         1 000043   000027 604000 1                  TMI     ASK
PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:428  

     1733     1405    1             ELSE;
     1734     1406    1           CALL CHARBIN(SP_IOM,SUBSTR(ANS,0,FIELD_LEN));

   1406  1 000044   000000 470400 xsym               LDP0    FIELD$
         1 000045   000000 720000 xsym               LXL0    FIELD_LEN
         1 000046   000100 305540                    DTB
         1 000047   000000 030010                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=*X0
         1 000050   200012 000010                    NDSC9   DIG#+1,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         1 000051   200013 235100                    LDA     DIG#+2,,AUTO
         1 000052   200007 755100                    STA     SP_IOM,,AUTO

     1735     1407    1           IF SP_IOM>%HIGHEST_IOM THEN GOTO ASK;

   1407  1 000053   000004 115007                    CMPA    4,DL
         1 000054   000027 603000 1                  TRC     ASK

     1736     1408    1           IF RPM_FLG THEN

   1408  1 000055   000000 234000 xsym               SZN     RPM_FLG
         1 000056   000065 605000 1                  TPL     s:1410

     1737     1409    1             CALL DO_RPM_CFG(SP_IOM);

   1409  1 000057   200007 631500                    EPPR1   SP_IOM,,AUTO
         1 000060   200012 451500                    STP1    DIG#+1,,AUTO
         1 000061   200012 630500                    EPPR0   DIG#+1,,AUTO
         1 000062   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000063   000000 701000 xent               TSX1    DO_RPM_CFG
         1 000064   000000 011000                    NOP     0

     1738     1410    1           DIG#=FIELD_LEN+1;

   1410  1 000065   000000 235000 xsym               LDA     FIELD_LEN
         1 000066   000001 035007                    ADLA    1,DL
         1 000067   200011 755100                    STA     DIG#,,AUTO

PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:429  
     1739     1411    1           CALL GETFD(SUBSTR(ANSBUF.TXT,DIG#),16-DIG#) ALTRET(ASK); /* Get Channel# */

   1411  1 000070   000027 675000 xsym               ERA     B_VECTNIL+23
         1 000071   000021 035007                    ADLA    17,DL
         1 000072   200012 755100                    STA     DIG#+1,,AUTO
         1 000073   200012 630500                    EPPR0   DIG#+1,,AUTO
         1 000074   200015 450500                    STP0    DIG#+4,,AUTO
         1 000075   200011 236100                    LDQ     DIG#,,AUTO
         1 000076   000020 736000                    QLS     16
         1 000077   000003 036000 2                  ADLQ    3
         1 000100   200014 756100                    STQ     DIG#+3,,AUTO
         1 000101   200014 630500                    EPPR0   DIG#+3,,AUTO
         1 000102   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000103   000000 701000 xent               TSX1    GETFD
         1 000104   000027 702000 1                  TSX2    ASK

     1740     1412    1           IF ALPHA_FLG='1'B THEN GOTO ASK;

   1412  1 000105   000000 234000 xsym               SZN     ALPHA_FLG
         1 000106   000027 604000 1                  TMI     ASK

     1741     1413    1             ELSE;
     1742     1414    1           CALL CHARBIN(SP_CHN,SUBSTR(ANS,0,FIELD_LEN));

   1414  1 000107   000000 470400 xsym               LDP0    FIELD$
         1 000110   000000 720000 xsym               LXL0    FIELD_LEN
         1 000111   000100 305540                    DTB
         1 000112   000000 030010                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=*X0
         1 000113   200012 000010                    NDSC9   DIG#+1,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         1 000114   200013 235100                    LDA     DIG#+2,,AUTO
         1 000115   200010 755100                    STA     SP_CHN,,AUTO

     1743     1415    1           IF SP_CHN > HIGHEST_CHAN THEN GOTO ASK;

   1415  1 000116   200005 236100                    LDQ     HIGHEST_CHAN,,AUTO
         1 000117   200010 116100                    CMPQ    SP_CHN,,AUTO
         1 000120   000027 602000 1                  TNC     ASK
PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:430  

     1744     1416    1           DIG#=DIG#+FIELD_LEN+1;

   1416  1 000121   200011 236100                    LDQ     DIG#,,AUTO
         1 000122   000000 036000 xsym               ADLQ    FIELD_LEN
         1 000123   000001 036007                    ADLQ    1,DL
         1 000124   200011 756100                    STQ     DIG#,,AUTO

     1745     1417    1           CALL GETFD(SUBSTR(ANSBUF.TXT,DIG#),16-DIG#) ALTRET(ASK); /* Get Unit# */

   1417  1 000125   000020 235007                    LDA     16,DL
         1 000126   200011 135100                    SBLA    DIG#,,AUTO
         1 000127   200012 755100                    STA     DIG#+1,,AUTO
         1 000130   200012 631500                    EPPR1   DIG#+1,,AUTO
         1 000131   200015 451500                    STP1    DIG#+4,,AUTO
         1 000132   000020 736000                    QLS     16
         1 000133   000003 036000 2                  ADLQ    3
         1 000134   200014 756100                    STQ     DIG#+3,,AUTO
         1 000135   200014 630500                    EPPR0   DIG#+3,,AUTO
         1 000136   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000137   000000 701000 xent               TSX1    GETFD
         1 000140   000027 702000 1                  TSX2    ASK

     1746     1418    1           IF ALPHA_FLG='1'B THEN GOTO ASK;

   1418  1 000141   000000 234000 xsym               SZN     ALPHA_FLG
         1 000142   000027 604000 1                  TMI     ASK

     1747     1419    1             ELSE;
     1748     1420    1           CALL CHARBIN(NUMBER,SUBSTR(ANS,0,FIELD_LEN));

   1420  1 000143   000000 470400 xsym               LDP0    FIELD$
         1 000144   000000 720000 xsym               LXL0    FIELD_LEN
         1 000145   000100 305540                    DTB
         1 000146   000000 030010                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=*X0
         1 000147   200012 000010                    NDSC9   DIG#+1,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         1 000150   200013 235100                    LDA     DIG#+2,,AUTO
PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:431  
         1 000151   200006 755100                    STA     NUMBER,,AUTO

     1749     1421    1           DEVINFO.IOM#(INDX)=SP_IOM;

   1421  1 000152   200003 471500                    LDP1    @INDX,,AUTO
         1 000153   100000 236100                    LDQ     0,,PR1
         1 000154   000006 402007                    MPY     6,DL
         1 000155   000001 736000                    QLS     1
         1 000156   000000 621006                    EAX1    0,QL
         1 000157   200007 236100                    LDQ     SP_IOM,,AUTO
         1 000160   000023 736000                    QLS     19
         1 000161   000000 676011 xsym               ERQ     DEVINFO,X1
         1 000162   000006 376003                    ANQ     6,DU
         1 000163   000000 656011 xsym               ERSQ    DEVINFO,X1

     1750     1422    1           DEVINFO.CHN#(INDX)=SP_CHN;

   1422  1 000164   100000 236100                    LDQ     0,,PR1
         1 000165   000006 402007                    MPY     6,DL
         1 000166   000001 736000                    QLS     1
         1 000167   000000 621006                    EAX1    0,QL
         1 000170   200010 236100                    LDQ     SP_CHN,,AUTO
         1 000171   000033 736000                    QLS     27
         1 000172   000000 676011 xsym               ERQ     DEVINFO,X1
         1 000173   777000 376003                    ANQ     -512,DU
         1 000174   000000 656011 xsym               ERSQ    DEVINFO,X1

     1751     1423    1           DEVINFO.DEV#(INDX)=NUMBER;

   1423  1 000175   100000 236100                    LDQ     0,,PR1
         1 000176   000006 402007                    MPY     6,DL
         1 000177   000001 736000                    QLS     1
         1 000200   000000 621006                    EAX1    0,QL
         1 000201   200006 236100                    LDQ     NUMBER,,AUTO
         1 000202   000025 736000                    QLS     21
         1 000203   000000 676011 xsym               ERQ     DEVINFO,X1
         1 000204   000770 376003                    ANQ     504,DU
PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:432  
         1 000205   000000 656011 xsym               ERSQ    DEVINFO,X1

     1752     1424    1           CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(INDX),0,1),DEVINFO.IOM#(INDX));

   1424  1 000206   100000 236100                    LDQ     0,,PR1
         1 000207   000006 402007                    MPY     6,DL
         1 000210   000000 621006                    EAX1    0,QL
         1 000211   000003 736000                    QLS     3
         1 000212   000000 635011                    EAA     0,X1
         1 000213   000021 771000                    ARL     17
         1 000214   200012 756100                    STQ     DIG#+1,,AUTO
         1 000215   000000 236005 xsym               LDQ     DEVINFO,AL
         1 000216   000023 772000                    QRL     19
         1 000217   000003 376007                    ANQ     3,DL
         1 000220   000000 235003                    LDA     0,DU
         1 000221   200014 757100                    STAQ    DIG#+3,,AUTO
         1 000222   200012 235100                    LDA     DIG#+1,,AUTO
         1 000223   000005 301500                    BTD
         1 000224   200014 000010                    NDSC9   DIG#+3,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         1 000225   000006 030001 xsym               NDSC9   DEVINFO+6,A              cn=0,s=nosgn,sf=0,n=1

     1753     1425    1           CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(INDX),2,3),DEVINFO.CHN#(INDX));

   1425  1 000226   100000 236100                    LDQ     0,,PR1
         1 000227   000006 402007                    MPY     6,DL
         1 000230   000000 621006                    EAX1    0,QL
         1 000231   000003 736000                    QLS     3
         1 000232   000000 635011                    EAA     0,X1
         1 000233   000021 771000                    ARL     17
         1 000234   200012 756100                    STQ     DIG#+1,,AUTO
         1 000235   000000 236005 xsym               LDQ     DEVINFO,AL
         1 000236   000033 772000                    QRL     27
         1 000237   000000 235003                    LDA     0,DU
         1 000240   200014 757100                    STAQ    DIG#+3,,AUTO
         1 000241   200012 235100                    LDA     DIG#+1,,AUTO
         1 000242   000005 301500                    BTD
         1 000243   200014 000010                    NDSC9   DIG#+3,,AUTO             cn=0,s=lsgnf,sf=0,n=8
PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:433  
         1 000244   000006 430003 xsym               NDSC9   DEVINFO+6,A              cn=2,s=nosgn,sf=0,n=3

     1754     1426    1           CALL BINCHAR(SUBSTR(DEVINFO.DEVNAME(INDX),6,2),DEVINFO.DEV#(INDX));

   1426  1 000245   100000 236100                    LDQ     0,,PR1
         1 000246   000006 402007                    MPY     6,DL
         1 000247   000000 621006                    EAX1    0,QL
         1 000250   000003 736000                    QLS     3
         1 000251   000000 635011                    EAA     0,X1
         1 000252   000021 771000                    ARL     17
         1 000253   200012 756100                    STQ     DIG#+1,,AUTO
         1 000254   000000 236005 xsym               LDQ     DEVINFO,AL
         1 000255   000025 772000                    QRL     21
         1 000256   000077 376007                    ANQ     63,DL
         1 000257   000000 235003                    LDA     0,DU
         1 000260   200014 757100                    STAQ    DIG#+3,,AUTO
         1 000261   200012 235100                    LDA     DIG#+1,,AUTO
         1 000262   000005 301500                    BTD
         1 000263   200014 000010                    NDSC9   DIG#+3,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         1 000264   000007 430002 xsym               NDSC9   DEVINFO+7,A              cn=2,s=nosgn,sf=0,n=2

     1755     1427    1   RETPACK:
     1756     1428    1           RETURN;

   1428  1 000265   000000 702200 xent  RETPACK      TSX2  ! X66_ARET

     1757     1429    1   GT_PACK:ENTRY(INDX);

   1429  1 000266   000000 700200 xent  GT_PACK      TSX0  ! X66_AUTO_1
         1 000267   000016 000001                    ZERO    14,1

     1758     1430    1           MESSAGE$=ADDR(DPQ);

   1430  1 000270   000005 236000 2                  LDQ     5
         1 000271   200004 756100                    STQ     MESSAGE$,,AUTO

     1759     1431    1           SUBSTR(TEXTM.TXT,7,8)=SUBSTR(DEVINFO.DEVNAME(INDX),0,8);
PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:434  

   1431  1 000272   200004 470500                    LDP0    MESSAGE$,,AUTO
         1 000273   000000 720100                    LXL0    0,,PR0
         1 000274   200003 471500                    LDP1    @INDX,,AUTO
         1 000275   100000 236100                    LDQ     0,,PR1
         1 000276   000006 402007                    MPY     6,DL
         1 000277   000003 736000                    QLS     3
         1 000300   040100 100406                    MLR     fill='040'O
         1 000301   000006 000010 xsym               ADSC9   DEVINFO+6,Q              cn=0,n=8
         1 000302   000002 600010                    ADSC9   2,,PR0                   cn=3,n=8

     1760     1432    1           GOTO ASK;

   1432  1 000303   000027 710000 1                  TRA     ASK
     1761     1433    1   END GT_SYSPACKAD;
     1762     1434        %EOD;

PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:435  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure GT_SYSPACKAD.
PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:436  

 **** Variables and constants ****

  ****  Section 000  Data  GT_SYSPACKAD

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    10-0-0/w STRC(207)   r     1 DPQ                        0-0-0/w STRC(270)   r     1 SYSDPQ

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @INDX                     11-0-0/w UBIN        r     1 DIG#
     5-0-0/w UBIN        r     1 HIGHEST_CHAN              *0-0-0/w UBIN        r     1 INDX
     4-0-0/w PTR         r     1 MESSAGE$                   6-0-0/w UBIN        r     1 NUMBER
    10-0-0/w UBIN        r     1 SP_CHN                     7-0-0/w UBIN        r     1 SP_IOM

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b STRC(5)     r     1 ADPXF                      0-0-0/b BIT         r     1 ALPHA_FLG
     0-0-0/w STRC(180)   r     1 ANSBUF                     0-0-0/d STRC(396)   r     1 DEVINFO(0:21)
     0-0-0/w PTR         r     1 FIELD$                     0-0-0/w UBIN        r     1 FIELD_LEN
     0-0-0/b BIT         r     1 RPM_FLG

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(16)    r     1 ANS                        0-0-0/w ASTR        r     1 TEXTM

PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:437  

   Procedure GT_SYSPACKAD requires 196 words for executable code.
   Procedure GT_SYSPACKAD requires 14 words of local(AUTO) storage.
PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:438  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:439  
          MINI XREF LISTING

ADPXF.D
      1376**DCL      1395>>IF
ALPHA_FLG
      1373**DCL      1404>>IF       1412>>IF       1418>>IF
ANS
      1384**DCL      1406>>CALLBLT  1414>>CALLBLT  1420>>CALLBLT
ANSBUF
      1369**DCL      1402<>CALL
ANSBUF.TXT
      1371**DCL      1403<>CALL     1411<>CALL     1417<>CALL
ASK
      1402**LABEL    1404--GOTO     1407--GOTO     1411--CALLALT  1412--GOTO     1415--GOTO     1417--CALLALT
      1418--GOTO     1432--GOTO
DEVINFO.CHN#
      1298**DCL      1422<<ASSIGN   1425>>CALLBLT
DEVINFO.DEV#
      1299**DCL      1423<<ASSIGN   1426>>CALLBLT
DEVINFO.DEVNAME
      1345**DCL      1400>>ASSIGN   1424<<CALLBLT  1425<<CALLBLT  1426<<CALLBLT  1431>>ASSIGN
DEVINFO.IOM#
      1300**DCL      1421<<ASSIGN   1424>>CALLBLT
DEVINFO.PCWS
      1302**DCL      1313--REDEF
DEVINFO.RPM_PTRS.EF_DCWS$
      1315**DCL      1316--REDEF
DEVINFO.STATUS
      1319**DCL      1338--REDEF
DIG#
      1393**DCL      1410<<ASSIGN   1411>>CALL     1411>>CALL     1416<<ASSIGN   1416>>ASSIGN   1417>>CALL
      1417>>CALL
DO_RPM_CFG
      1386**DCL-ENT  1409--CALL
PL6.E3A0      #023=GT_SYSPACKAD File=ISI$IOPROC.:E05TSI                          TUE 07/29/97 22:53 Page:440  
DPQ
      1361**DCL      1430--ASSIGN
FIELD$
      1380**DCL      1384--IMP-PTR  1406>>CALLBLT  1414>>CALLBLT  1420>>CALLBLT
FIELD_LEN
      1381**DCL      1406>>CALLBLT  1410>>ASSIGN   1414>>CALLBLT  1416>>ASSIGN   1420>>CALLBLT
GETFD
      1388**DCL-ENT  1403--CALL     1411--CALL     1417--CALL
HIGHEST_CHAN
      1383**DCL      1396<<ASSIGN   1398<<ASSIGN   1415>>IF
INDX
      1285**DCL         6--PROC     1400>>ASSIGN   1421>>ASSIGN   1422>>ASSIGN   1423>>ASSIGN   1424>>CALLBLT
      1424>>CALLBLT  1425>>CALLBLT  1425>>CALLBLT  1426>>CALLBLT  1426>>CALLBLT  1429--ENTRY    1431>>ASSIGN
KEYIN
      1387**DCL-ENT  1402--CALL
MESSAGE$
      1365**DCL      1366--IMP-PTR  1399<<ASSIGN   1400>>ASSIGN   1400>>ASSIGN   1402>>CALL     1402>>CALL
      1430<<ASSIGN   1431>>ASSIGN   1431>>ASSIGN
NUMBER
      1390**DCL      1420<<CALLBLT  1423>>ASSIGN
RETPACK
      1428**LABEL    1403--CALLALT
RPM_FLG
      1382**DCL      1397>>IF       1408>>IF
SP_CHN
      1392**DCL      1414<<CALLBLT  1415>>IF       1422>>ASSIGN
SP_IOM
      1391**DCL      1406<<CALLBLT  1407>>IF       1409<>CALL     1421>>ASSIGN
SYSDPQ
      1356**DCL      1399--ASSIGN
TEXTM
      1366**DCL      1402<>CALL
TEXTM.CNT
      1367**DCL      1368--IMP-SIZ  1400>>ASSIGN   1402>>CALL     1431>>ASSIGN
TEXTM.TXT
      1368**DCL      1400<<ASSIGN   1431<<ASSIGN

PL6.E3A0      #024=MINT_PL6 File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:441  
     1763        1        /*T***********************************************************/
     1764        2        /*T*                                                         */
     1765        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1766        4        /*T*                                                         */
     1767        5        /*T***********************************************************/
     1768        6        MINT_PL6:PROC;
     1769        7        /* Got here on keyin from console */
     1770        8        %INCLUDE IS$MACROS;
     1771     1283        %DEVINFO(STCLASS="SYMREF");
     1772     1352        %IOM_TAB(NAME=IOMTAB,STCLASS="SYMREF");
     1773     1369    1   DCL IMWCEL(0:31) BIT(1) BASED(IMW$) UNAL;
     1774     1370    1   DCL IMW$ PTR;
     1775     1371        %PTR_STRUCT(NAME=IMW_PTR,STCLASS="REDEF IMW$");
     1776     1389    1   DCL IMWBASE UBIN WORD SYMREF;
     1777     1390    1   DCL CODE UBIN WORD SYMREF;
     1778     1391    1   DCL 1 SSR_W5 REDEF CODE,
     1779     1392    1         2 * BIT(11) UNAL,
     1780     1393    1         2 F_I_BIT BIT(1),
     1781     1394    1         2 INT_CODE UBIN(5) UNAL,
     1782     1395    1         2 * BIT(19);
     1783     1396        %TEXTC(N#=PROMPT,M#="'!!!Required action (A/Z/P) ? '");
     1784     1401        %TEXTC(N#=GIVHLP,M#="'A->Go to MINI; Z->self destruct; P->Read PO tape . '");
     1785     1406        %TEXTC(N#=FIN,M#="'That''s all folks...'");
     1786     1411    1   DCL 1 ANSBUF SYMREF,
     1787     1412    1         2 CNT UBIN WORD,
     1788     1413    1         2 TXT CHAR(16);
     1789     1414    1   DCL I UBIN WORD;
     1790     1415    1   DCL TYPEC ENTRY(1);
     1791     1416    1   DCL KEYIN ENTRY(2) ALTRET;
     1792     1417        /**/
     1793     1418    2           IF SSR_W5.F_I_BIT='0'B THEN DO; /* Not an interruption                */
     1794     1419    2   NOACT:
     1795     1420    2                 CODE=0;
     1796     1421    2                 RETURN;
     1797     1422    2               END;                        /* THEN                               */
     1798     1423    1             ELSE;
     1799     1424        /* The 5 bit code has to be special interr from console */
PL6.E3A0      #024=MINT_PL6 File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:442  
     1800     1425    1           IMW_PTR='0'B;
     1801     1426    1           IMW_PTR.S_D_FIELD=%ALS_AIS;     /* Frame real                         */
     1802     1427    1           I=DEVINFO.CHN#(0);              /* Console                            */
     1803     1428    2           IF I<32 THEN DO;
     1804     1429    2                 IF CODE~=DEVINFO.IOM#(0)+28 THEN GOTO NOACT;
     1805     1430    2                   ELSE IMW_PTR.WOFFS=IMWBASE+DEVINFO.IOM#(0)+28;
     1806     1431    2               END;                        /* THEN                               */
     1807     1432    2             ELSE DO;
     1808     1433    2                 IF CODE~=DEVINFO.IOM#(0)+24 THEN GOTO NOACT;
     1809     1434    2                   ELSE IMW_PTR.WOFFS=IMWBASE+DEVINFO.IOM#(0)+24;
     1810     1435    2                 I=I-32;
     1811     1436    2               END;                        /* ELSE                               */
     1812     1437    1           IMWCEL(I)='0'B;                 /* Reset the interr bit               */
     1813     1438    1   ASK:
     1814     1439    1           CALL KEYIN(PROMPT,ANSBUF);
     1815     1440    2           DO SELECT(SUBSTR(ANSBUF.TXT,0,1));
     1816     1441    2             SELECT('A','a');
     1817     1442    2             CODE=1;
     1818     1443    2             SELECT('Z','z');
     1819     1444    2             CODE=2;
     1820     1445    2             SELECT('P','p');
     1821     1446    2             CODE=3;
     1822     1447    2             SELECT('?');
     1823     1448    2             CALL TYPEC(GIVHLP);
     1824     1449    2             GOTO ASK;
     1825     1450    2             SELECT(ELSE);
     1826     1451    2           GOTO ASK;
     1827     1452    2           END;                            /* DO SELECT                          */
     1828     1453    1           RETURN;
     1829     1454    1   FINAL:  ENTRY;
     1830     1455    1           CALL TYPEC(FIN);
     1831     1456    1           RETURN;
     1832     1457    1   END MINT_PL6;
     1833     1458        %EOD;

PL6.E3A0      #024=MINT_PL6 File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:443  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure MINT_PL6.

   Procedure MINT_PL6 requires 119 words for executable code.
   Procedure MINT_PL6 requires 6 words of local(AUTO) storage.

PL6.E3A0      #024=MINT_PL6 File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:444  

 Object Unit name= MINT_PL6                                   File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:53:38.68 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    29     35  MINT_PL6
    1   Proc  even  none   119    167  MINT_PL6
    2  RoData even  none     4      4  MINT_PL6

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        0  MINT_PL6
     1    160                  yes      Std        0  FINAL

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  PROMPT                             0     11  GIVHLP
    0     27  FIN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 KEYIN
         yes           Std       1 TYPEC
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
PL6.E3A0      #024=MINT_PL6 File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:445  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DEVINFO                               IMWBASE                               CODE
     ANSBUF                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #024=MINT_PL6 File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:446  


     1763        1        /*T***********************************************************/
     1764        2        /*T*                                                         */
     1765        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1766        4        /*T*                                                         */
     1767        5        /*T***********************************************************/
     1768        6        MINT_PL6:PROC;

      6  1 000000   000000 700200 xent  MINT_PL6     TSX0  ! X66_AUTO_0
         1 000001   000006 000000                    ZERO    6,0

     1769        7        /* Got here on keyin from console */
     1770        8        %INCLUDE IS$MACROS;
     1771     1283        %DEVINFO(STCLASS="SYMREF");
     1772     1352        %IOM_TAB(NAME=IOMTAB,STCLASS="SYMREF");
     1773     1369    1   DCL IMWCEL(0:31) BIT(1) BASED(IMW$) UNAL;
     1774     1370    1   DCL IMW$ PTR;
     1775     1371        %PTR_STRUCT(NAME=IMW_PTR,STCLASS="REDEF IMW$");
     1776     1389    1   DCL IMWBASE UBIN WORD SYMREF;
     1777     1390    1   DCL CODE UBIN WORD SYMREF;
     1778     1391    1   DCL 1 SSR_W5 REDEF CODE,
     1779     1392    1         2 * BIT(11) UNAL,
     1780     1393    1         2 F_I_BIT BIT(1),
     1781     1394    1         2 INT_CODE UBIN(5) UNAL,
     1782     1395    1         2 * BIT(19);
     1783     1396        %TEXTC(N#=PROMPT,M#="'!!!Required action (A/Z/P) ? '");
     1784     1401        %TEXTC(N#=GIVHLP,M#="'A->Go to MINI; Z->self destruct; P->Read PO tape . '");
     1785     1406        %TEXTC(N#=FIN,M#="'That''s all folks...'");
     1786     1411    1   DCL 1 ANSBUF SYMREF,
     1787     1412    1         2 CNT UBIN WORD,
     1788     1413    1         2 TXT CHAR(16);
     1789     1414    1   DCL I UBIN WORD;
     1790     1415    1   DCL TYPEC ENTRY(1);
     1791     1416    1   DCL KEYIN ENTRY(2) ALTRET;
     1792     1417        /**/
     1793     1418    2           IF SSR_W5.F_I_BIT='0'B THEN DO; /* Not an interruption                */

PL6.E3A0      #024=MINT_PL6 File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:447  
   1418  1 000002   000000 236000 xsym               LDQ     CODE
         1 000003   000100 316003                    CANQ    64,DU
         1 000004   000007 601000 1                  TNZ     s:1425

     1794     1419    2   NOACT:
     1795     1420    2                 CODE=0;

   1420  1 000005   000000 450000 xsym  NOACT        STZ     CODE

     1796     1421    2                 RETURN;

   1421  1 000006   000000 702200 xent               TSX2  ! X66_ARET

     1797     1422    2               END;                        /* THEN                               */
     1798     1423    1             ELSE;
     1799     1424        /* The 5 bit code has to be special interr from console */
     1800     1425    1           IMW_PTR='0'B;

   1425  1 000007   200003 450100                    STZ     IMW$,,AUTO

     1801     1426    1           IMW_PTR.S_D_FIELD=%ALS_AIS;     /* Frame real                         */

   1426  1 000010   006000 236007                    LDQ     3072,DL
         1 000011   200003 752103                    STCQ    IMW$,'03'O,AUTO

     1802     1427    1           I=DEVINFO.CHN#(0);              /* Console                            */

   1427  1 000012   000000 236000 xsym               LDQ     DEVINFO
         1 000013   000033 772000                    QRL     27
         1 000014   200004 756100                    STQ     I,,AUTO

     1803     1428    2           IF I<32 THEN DO;

   1428  1 000015   000040 116007                    CMPQ    32,DL
         1 000016   000034 603000 1                  TRC     s:1433

     1804     1429    2                 IF CODE~=DEVINFO.IOM#(0)+28 THEN GOTO NOACT;
PL6.E3A0      #024=MINT_PL6 File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:448  

   1429  1 000017   000000 236000 xsym               LDQ     DEVINFO
         1 000020   000023 772000                    QRL     19
         1 000021   000003 376007                    ANQ     3,DL
         1 000022   000034 036007                    ADLQ    28,DL
         1 000023   000000 116000 xsym               CMPQ    CODE
         1 000024   000005 601000 1                  TNZ     NOACT

     1805     1430    2                   ELSE IMW_PTR.WOFFS=IMWBASE+DEVINFO.IOM#(0)+28;

   1430  1 000025   000000 236000 xsym               LDQ     DEVINFO
         1 000026   000023 772000                    QRL     19
         1 000027   000003 376007                    ANQ     3,DL
         1 000030   000000 036000 xsym               ADLQ    IMWBASE
         1 000031   000034 620006                    EAX0    28,QL
         1 000032   200003 740100                    STX0    IMW$,,AUTO

     1806     1431    2               END;                        /* THEN                               */

   1431  1 000033   000053 710000 1                  TRA     s:1437

     1807     1432    2             ELSE DO;

     1808     1433    2                 IF CODE~=DEVINFO.IOM#(0)+24 THEN GOTO NOACT;

   1433  1 000034   000000 236000 xsym               LDQ     DEVINFO
         1 000035   000023 772000                    QRL     19
         1 000036   000003 376007                    ANQ     3,DL
         1 000037   000030 036007                    ADLQ    24,DL
         1 000040   000000 116000 xsym               CMPQ    CODE
         1 000041   000005 601000 1                  TNZ     NOACT

     1809     1434    2                   ELSE IMW_PTR.WOFFS=IMWBASE+DEVINFO.IOM#(0)+24;

   1434  1 000042   000000 236000 xsym               LDQ     DEVINFO
         1 000043   000023 772000                    QRL     19
         1 000044   000003 376007                    ANQ     3,DL
PL6.E3A0      #024=MINT_PL6 File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:449  
         1 000045   000000 036000 xsym               ADLQ    IMWBASE
         1 000046   000030 620006                    EAX0    24,QL
         1 000047   200003 740100                    STX0    IMW$,,AUTO

     1810     1435    2                 I=I-32;

   1435  1 000050   200004 235100                    LDA     I,,AUTO
         1 000051   000040 135007                    SBLA    32,DL
         1 000052   200004 755100                    STA     I,,AUTO

     1811     1436    2               END;                        /* ELSE                               */

     1812     1437    1           IMWCEL(I)='0'B;                 /* Reset the interr bit               */

   1437  1 000053   200003 470500                    LDP0    IMW$,,AUTO
         1 000054   200004 235100                    LDA     I,,AUTO
         1 000055   003105 060400                    CSL     bolr='003'O
         1 000056   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         1 000057   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1

     1813     1438    1   ASK:
     1814     1439    1           CALL KEYIN(PROMPT,ANSBUF);

   1439  1 000060   000000 630400 2     ASK          EPPR0   0
         1 000061   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000062   000000 701000 xent               TSX1    KEYIN
         1 000063   000000 011000                    NOP     0

     1815     1440    2           DO SELECT(SUBSTR(ANSBUF.TXT,0,1));

   1440  1 000064   000001 236000 xsym               LDQ     ANSBUF+1
         1 000065   777000 376003                    ANQ     -512,DU
         1 000066   132000 116003                    CMPQ    46080,DU
         1 000067   000116 602000 1                  TNC     s:1440+26
         1 000070   000001 236000 xsym               LDQ     ANSBUF+1
         1 000071   777000 376003                    ANQ     -512,DU
         1 000072   132000 116003                    CMPQ    46080,DU
PL6.E3A0      #024=MINT_PL6 File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:450  
         1 000073   000143 600000 1                  TZE     s:1444
         1 000074   000001 236000 xsym               LDQ     ANSBUF+1
         1 000075   777000 376003                    ANQ     -512,DU
         1 000076   160000 116003                    CMPQ    57344,DU
         1 000077   000111 602000 1                  TNC     s:1440+21
         1 000100   000001 236000 xsym               LDQ     ANSBUF+1
         1 000101   777000 376003                    ANQ     -512,DU
         1 000102   160000 116003                    CMPQ    57344,DU
         1 000103   000146 600000 1                  TZE     s:1446
         1 000104   000001 236000 xsym               LDQ     ANSBUF+1
         1 000105   777000 376003                    ANQ     -512,DU
         1 000106   172000 116003                    CMPQ    62464,DU
         1 000107   000156 601000 1                  TNZ     s:1451
         1 000110   000143 710000 1                  TRA     s:1444
         1 000111   000001 236000 xsym               LDQ     ANSBUF+1
         1 000112   777000 376003                    ANQ     -512,DU
         1 000113   141000 116003                    CMPQ    49664,DU
         1 000114   000156 601000 1                  TNZ     s:1451
         1 000115   000140 710000 1                  TRA     s:1442
         1 000116   000001 236000 xsym               LDQ     ANSBUF+1
         1 000117   777000 376003                    ANQ     -512,DU
         1 000120   101000 116003                    CMPQ    33280,DU
         1 000121   000133 602000 1                  TNC     s:1440+39
         1 000122   000001 236000 xsym               LDQ     ANSBUF+1
         1 000123   777000 376003                    ANQ     -512,DU
         1 000124   101000 116003                    CMPQ    33280,DU
         1 000125   000140 600000 1                  TZE     s:1442
         1 000126   000001 236000 xsym               LDQ     ANSBUF+1
         1 000127   777000 376003                    ANQ     -512,DU
         1 000130   120000 116003                    CMPQ    40960,DU
         1 000131   000156 601000 1                  TNZ     s:1451
         1 000132   000146 710000 1                  TRA     s:1446
         1 000133   000001 236000 xsym               LDQ     ANSBUF+1
         1 000134   777000 376003                    ANQ     -512,DU
         1 000135   077000 116003                    CMPQ    32256,DU
         1 000136   000156 601000 1                  TNZ     s:1451
         1 000137   000151 710000 1                  TRA     s:1448
PL6.E3A0      #024=MINT_PL6 File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:451  

     1816     1441    2             SELECT('A','a');

     1817     1442    2             CODE=1;

   1442  1 000140   000001 235007                    LDA     1,DL
         1 000141   000000 755000 xsym               STA     CODE
         1 000142   000157 710000 1                  TRA     s:1453

     1818     1443    2             SELECT('Z','z');

     1819     1444    2             CODE=2;

   1444  1 000143   000002 235007                    LDA     2,DL
         1 000144   000000 755000 xsym               STA     CODE
         1 000145   000157 710000 1                  TRA     s:1453

     1820     1445    2             SELECT('P','p');

     1821     1446    2             CODE=3;

   1446  1 000146   000003 235007                    LDA     3,DL
         1 000147   000000 755000 xsym               STA     CODE
         1 000150   000157 710000 1                  TRA     s:1453

     1822     1447    2             SELECT('?');

     1823     1448    2             CALL TYPEC(GIVHLP);

   1448  1 000151   000002 630400 2                  EPPR0   2
         1 000152   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000153   000000 701000 xent               TSX1    TYPEC
         1 000154   000000 011000                    NOP     0

     1824     1449    2             GOTO ASK;

   1449  1 000155   000060 710000 1                  TRA     ASK
PL6.E3A0      #024=MINT_PL6 File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:452  

     1825     1450    2             SELECT(ELSE);

     1826     1451    2           GOTO ASK;

   1451  1 000156   000060 710000 1                  TRA     ASK

     1827     1452    2           END;                            /* DO SELECT                          */

     1828     1453    1           RETURN;

   1453  1 000157   000000 702200 xent               TSX2  ! X66_ARET

     1829     1454    1   FINAL:  ENTRY;

   1454  1 000160   000000 700200 xent  FINAL        TSX0  ! X66_AUTO_0
         1 000161   000006 000000                    ZERO    6,0

     1830     1455    1           CALL TYPEC(FIN);

   1455  1 000162   000003 630400 2                  EPPR0   3
         1 000163   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000164   000000 701000 xent               TSX1    TYPEC
         1 000165   000000 011000                    NOP     0

     1831     1456    1           RETURN;

   1456  1 000166   000000 702200 xent               TSX2  ! X66_ARET
     1832     1457    1   END MINT_PL6;
     1833     1458        %EOD;

PL6.E3A0      #024=MINT_PL6 File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:453  
--  Include file information  --

   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure MINT_PL6.
PL6.E3A0      #024=MINT_PL6 File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:454  

 **** Variables and constants ****

  ****  Section 000  Data  MINT_PL6

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    27-0-0/w STRC(207)   r     1 FIN                       11-0-0/w STRC(495)   r     1 GIVHLP
     0-0-0/w STRC(297)   r     1 PROMPT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w UBIN        r     1 I                          3-0-0/w PTR         r     1 IMW$
     3-0-0/w STRC        r     1 IMW_PTR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ANSBUF                     0-0-0/w UBIN        r     1 CODE
     0-0-0/d STRC(396)   r     1 DEVINFO(0:21)              0-0-0/w UBIN        r     1 IMWBASE
     0-0-0/w STRC        r     1 SSR_W5

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 IMWCEL(0:31)


   Procedure MINT_PL6 requires 119 words for executable code.
PL6.E3A0      #024=MINT_PL6 File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:455  
   Procedure MINT_PL6 requires 6 words of local(AUTO) storage.
PL6.E3A0      #024=MINT_PL6 File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:456  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #024=MINT_PL6 File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:457  
          MINI XREF LISTING

ANSBUF
      1411**DCL      1439<>CALL
ANSBUF.TXT
      1413**DCL      1440>>DOSELCT
ASK
      1439**LABEL    1449--GOTO     1451--GOTO
CODE
      1390**DCL      1391--REDEF    1420<<ASSIGN   1429>>IF       1433>>IF       1442<<ASSIGN   1444<<ASSIGN
      1446<<ASSIGN
DEVINFO.CHN#
      1295**DCL      1427>>ASSIGN
DEVINFO.IOM#
      1297**DCL      1429>>IF       1430>>ASSIGN   1433>>IF       1434>>ASSIGN
DEVINFO.PCWS
      1299**DCL      1310--REDEF
DEVINFO.RPM_PTRS.EF_DCWS$
      1312**DCL      1313--REDEF
DEVINFO.STATUS
      1316**DCL      1335--REDEF
FIN
      1407**DCL      1455<>CALL
GIVHLP
      1402**DCL      1448<>CALL
I
      1414**DCL      1427<<ASSIGN   1428>>IF       1435<<ASSIGN   1435>>ASSIGN   1437>>ASSIGN
IMW$
      1370**DCL      1369--IMP-PTR  1382--REDEF    1437>>ASSIGN
IMWBASE
      1389**DCL      1430>>ASSIGN   1434>>ASSIGN
IMWCEL
      1369**DCL      1437<<ASSIGN
IMW_PTR
PL6.E3A0      #024=MINT_PL6 File=ISI$IOPROC.:E05TSI                              TUE 07/29/97 22:53 Page:458  
      1382**DCL      1425<<ASSIGN
IMW_PTR.S_D_FIELD
      1386**DCL      1426<<ASSIGN
IMW_PTR.WOFFS
      1383**DCL      1430<<ASSIGN   1434<<ASSIGN
KEYIN
      1416**DCL-ENT  1439--CALL
NOACT
      1420**LABEL    1429--GOTO     1433--GOTO
PROMPT
      1397**DCL      1439<>CALL
SSR_W5.F_I_BIT
      1393**DCL      1418>>IF
TYPEC
      1415**DCL-ENT  1448--CALL     1455--CALL

PL6.E3A0      #025=CLOSE_SYST File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:459  
     1834        1        /*T***********************************************************/
     1835        2        /*T*                                                         */
     1836        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1837        4        /*T*                                                         */
     1838        5        /*T***********************************************************/
     1839        6        CLOSE_SYST:PROC;
     1840        7        /* This program tells MSOS that the system is closing */
     1841        8        %INCLUDE IS$MACROS;
     1842     1283        %INCLUDE NI$TABLES;
     1843     1499    1   DCL IOM# UBIN WORD;
     1844     1500    1   DCL START_IO ENTRY(1);
     1845     1501        %CHANMBOX(NAME=CMBOX);
     1846     1526        %IOM_TAB(NAME=IOMTAB,STCLASS="SYMREF");
     1847     1543        %PTR_STRUCT(NAME=CON_PTR,STCLASS="STATIC");
     1848     1561    1   DCL CON$ REDEF CON_PTR PTR;
     1849     1562    1   DCL INFO$ PTR;
     1850     1563        %PTR_STRUCT(NAME=INFO_PTR,STCLASS="REDEF INFO$");
     1851     1581    1   DCL BAS_UBIN UBIN WORD ALIGNED BASED(INFO$);
     1852     1582    1   DCL   BAS_PTR(0:0) PTR  ALIGNED BASED(INFO$);
     1853     1583    1   DCL NI_IOMS UBIN   SYMREF;
     1854     1584    1   DCL NI$IOM$(0:3) PTR SYMREF;
     1855     1585        %NI$IOM(NAME=NI$IOM);
     1856     1590    1   DCL INFO2$ PTR;
     1857     1591        %PTR_STRUCT(NAME=INFO2_PTR,STCLASS="REDEF INFO2$");
     1858     1609    1   DCL 1 PCWS STATIC DALIGNED,
     1859     1610    1         2 PCW1 BIT(36) INIT('0000007'O),
     1860     1611    1         2 PCW2,
     1861     1612    1           3 CHN# UBIN(9) UNAL INIT(4),
     1862     1613    1           3 * BIT(27) INIT('0'B);
     1863     1614        /**/
     1864     1615    1   DCL CHAN$ PTR;
     1865     1616    1   DCL I UBIN WORD;
     1866     1617    1   DCL PORT# UBIN WORD;
     1867     1618    1   DCL   NIOM# UBIN WORD;
     1868     1619        /**/
     1869     1620        /* Find IOM Nr */
     1870     1621    1           INFO$=ADDR(NI_IOMS);
PL6.E3A0      #025=CLOSE_SYST File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:460  
     1871     1622    1           INFO_PTR.S_D_FIELD=%ALS_MONIS;  /* Frame IOM # in the TIGR            */
     1872     1623    1           NIOM#=BAS_UBIN - 1;
     1873     1624    1           INFO$ = ADDR(NI$IOM$(0));
     1874     1625    1           INFO_PTR.S_D_FIELD = %ALS_MONIS;
     1875     1626    2           DO IOM# = 0 TO NIOM#;
     1876     1627    2             INFO2$ = BAS_PTR(IOM#);
     1877     1628    2             INFO2_PTR.S_D_FIELD = %ALS_TIGR;
     1878     1629    3             IF ~INFO2$->NI$IOM.STATUS.DOWN THEN DO;
     1879     1630        /* Build MSOS mailbox */
     1880     1631    3                   CON_PTR.WOFFS=IOMTAB.MAILBAD(IOM#)+4*4; /* MSOS mailbox       */
     1881     1632    3                   CHAN$=CON$;
     1882     1633    3                   CMBOX.LPW$=ADDR(PCWS);  /* Used as an IDCW with code o'00'    */
     1883     1634    3                   CMBOX.W1.H2.TALLY=4095; /* Count                              */
     1884     1635    3                   CMBOX.W2='0'B;          /* LPWX                               */
     1885     1636        /* Find connect channel mailbox */
     1886     1637    3                   CON_PTR.WOFFS=IOMTAB.MAILBAD(IOM#)+2*4;
     1887     1638        /* Wait for connect channel to free up */
     1888     1639    3                   CHAN$=CON$;
     1889     1640    4                   DO UNTIL CMBOX.W1.H2.TALLY=0;
     1890     1641    4                   END;                    /* DO                                 */
     1891     1642    3                   CMBOX.LPW$=ADDR(PCWS);  /* Pointer to PCW                     */
     1892     1643    3                   CMBOX.W1.H2.TAL='1'B;   /* Tally                              */
     1893     1644    3                   CMBOX.W1.H2.TALLY=1;    /* Count 1                            */
     1894     1645    3                   CMBOX.W2='0'B;          /* LPWX                               */
     1895     1646    3                   PORT#=IOMTAB.PORT#(IOM#);
     1896     1647    3                   CALL START_IO(PORT#);
     1897     1648        /* Wait for connect channel to free up */
     1898     1649    4                   DO UNTIL CMBOX.W1.H2.TALLY=0;
     1899     1650    4                   END;                    /* DO UNTIL                           */
     1900     1651        /* Wait a while */
     1901     1652    4                   DO I=0 TO 128*1024;
     1902     1653    4                   END;                    /* DO I=                              */
     1903     1654    3                 END;
     1904     1655    2           END;
     1905     1656    1           RETURN;
     1906     1657    1   END CLOSE_SYST;
     1907     1658        %EOD;
PL6.E3A0      #025=CLOSE_SYST File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:461  

PL6.E3A0      #025=CLOSE_SYST File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:462  
--  Include file information  --

   NI$TABLES.:E05TOU  is referenced.
   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure CLOSE_SYST.

   Procedure CLOSE_SYST requires 84 words for executable code.
   Procedure CLOSE_SYST requires 12 words of local(AUTO) storage.

PL6.E3A0      #025=CLOSE_SYST File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:463  

 Object Unit name= CLOSE_SYST                                 File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:53:43.04 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     4      4  CLOSE_SYST
    1   Proc  even  none    84    124  CLOSE_SYST
    2  RoData even  none     3      3  CLOSE_SYST

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        0  CLOSE_SYST

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 START_IO
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     IOMTAB                                NI_IOMS                               NI$IOM$
     B_VECTNIL
PL6.E3A0      #025=CLOSE_SYST File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:464  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #025=CLOSE_SYST File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:465  


     1834        1        /*T***********************************************************/
     1835        2        /*T*                                                         */
     1836        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1837        4        /*T*                                                         */
     1838        5        /*T***********************************************************/
     1839        6        CLOSE_SYST:PROC;

      6  1 000000   000000 700200 xent  CLOSE_SYST   TSX0  ! X66_AUTO_0
         1 000001   000014 000000                    ZERO    12,0

     1840        7        /* This program tells MSOS that the system is closing */
     1841        8        %INCLUDE IS$MACROS;
     1842     1283        %INCLUDE NI$TABLES;
     1843     1499    1   DCL IOM# UBIN WORD;
     1844     1500    1   DCL START_IO ENTRY(1);
     1845     1501        %CHANMBOX(NAME=CMBOX);
     1846     1526        %IOM_TAB(NAME=IOMTAB,STCLASS="SYMREF");
     1847     1543        %PTR_STRUCT(NAME=CON_PTR,STCLASS="STATIC");
     1848     1561    1   DCL CON$ REDEF CON_PTR PTR;
     1849     1562    1   DCL INFO$ PTR;
     1850     1563        %PTR_STRUCT(NAME=INFO_PTR,STCLASS="REDEF INFO$");
     1851     1581    1   DCL BAS_UBIN UBIN WORD ALIGNED BASED(INFO$);
     1852     1582    1   DCL   BAS_PTR(0:0) PTR  ALIGNED BASED(INFO$);
     1853     1583    1   DCL NI_IOMS UBIN   SYMREF;
     1854     1584    1   DCL NI$IOM$(0:3) PTR SYMREF;
     1855     1585        %NI$IOM(NAME=NI$IOM);
     1856     1590    1   DCL INFO2$ PTR;
     1857     1591        %PTR_STRUCT(NAME=INFO2_PTR,STCLASS="REDEF INFO2$");
     1858     1609    1   DCL 1 PCWS STATIC DALIGNED,
     1859     1610    1         2 PCW1 BIT(36) INIT('0000007'O),
     1860     1611    1         2 PCW2,
     1861     1612    1           3 CHN# UBIN(9) UNAL INIT(4),
     1862     1613    1           3 * BIT(27) INIT('0'B);
     1863     1614        /**/
     1864     1615    1   DCL CHAN$ PTR;
     1865     1616    1   DCL I UBIN WORD;
PL6.E3A0      #025=CLOSE_SYST File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:466  
     1866     1617    1   DCL PORT# UBIN WORD;
     1867     1618    1   DCL   NIOM# UBIN WORD;
     1868     1619        /**/
     1869     1620        /* Find IOM Nr */
     1870     1621    1           INFO$=ADDR(NI_IOMS);

   1621  1 000002   000000 236000 2                  LDQ     0
         1 000003   200004 756100                    STQ     INFO$,,AUTO

     1871     1622    1           INFO_PTR.S_D_FIELD=%ALS_MONIS;  /* Frame IOM # in the TIGR            */

   1622  1 000004   006050 236007                    LDQ     3112,DL
         1 000005   200004 752103                    STCQ    INFO$,'03'O,AUTO

     1872     1623    1           NIOM#=BAS_UBIN - 1;

   1623  1 000006   200004 470500                    LDP0    INFO$,,AUTO
         1 000007   000000 235100                    LDA     0,,PR0
         1 000010   000001 135007                    SBLA    1,DL
         1 000011   200011 755100                    STA     NIOM#,,AUTO

     1873     1624    1           INFO$ = ADDR(NI$IOM$(0));

   1624  1 000012   000001 236000 2                  LDQ     1
         1 000013   200004 756100                    STQ     INFO$,,AUTO

     1874     1625    1           INFO_PTR.S_D_FIELD = %ALS_MONIS;

   1625  1 000014   006050 236007                    LDQ     3112,DL
         1 000015   200004 752103                    STCQ    INFO$,'03'O,AUTO

     1875     1626    2           DO IOM# = 0 TO NIOM#;

   1626  1 000016   200003 450100                    STZ     IOM#,,AUTO
         1 000017   000120 710000 1                  TRA     s:1655+3

     1876     1627    2             INFO2$ = BAS_PTR(IOM#);
PL6.E3A0      #025=CLOSE_SYST File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:467  

   1627  1 000020   200004 470500                    LDP0    INFO$,,AUTO
         1 000021   200003 720100                    LXL0    IOM#,,AUTO
         1 000022   000000 236110                    LDQ     0,X0,PR0
         1 000023   200005 756100                    STQ     INFO2$,,AUTO

     1877     1628    2             INFO2_PTR.S_D_FIELD = %ALS_TIGR;

   1628  1 000024   006030 236007                    LDQ     3096,DL
         1 000025   200005 752103                    STCQ    INFO2$,'03'O,AUTO

     1878     1629    3             IF ~INFO2$->NI$IOM.STATUS.DOWN THEN DO;

   1629  1 000026   200005 471500                    LDP1    INFO2$,,AUTO
         1 000027   100003 236100                    LDQ     3,,PR1
         1 000030   000036 736000                    QLS     30
         1 000031   400000 376003                    ANQ     -131072,DU
         1 000032   400000 676003                    ERQ     -131072,DU
         1 000033   000115 600000 1                  TZE     s:1655

     1879     1630        /* Build MSOS mailbox */
     1880     1631    3                   CON_PTR.WOFFS=IOMTAB.MAILBAD(IOM#)+4*4; /* MSOS mailbox       */

   1631  1 000034   000000 221010 xsym               LDX1    IOMTAB,X0
         1 000035   000020 622011                    EAX2    16,X1
         1 000036   000000 742000 0                  STX2    CON_PTR

     1881     1632    3                   CHAN$=CON$;

   1632  1 000037   000000 236000 0                  LDQ     CON_PTR
         1 000040   200006 756100                    STQ     CHAN$,,AUTO

     1882     1633    3                   CMBOX.LPW$=ADDR(PCWS);  /* Used as an IDCW with code o'00'    */

   1633  1 000041   000002 236000 2                  LDQ     2
         1 000042   200006 473500                    LDP3    CHAN$,,AUTO
         1 000043   300000 756100                    STQ     0,,PR3
PL6.E3A0      #025=CLOSE_SYST File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:468  

     1883     1634    3                   CMBOX.W1.H2.TALLY=4095; /* Count                              */

   1634  1 000044   007777 236007                    LDQ     4095,DL
         1 000045   300000 752103                    STCQ    0,'03'O,PR3

     1884     1635    3                   CMBOX.W2='0'B;          /* LPWX                               */

   1635  1 000046   300001 450100                    STZ     1,,PR3

     1885     1636        /* Find connect channel mailbox */
     1886     1637    3                   CON_PTR.WOFFS=IOMTAB.MAILBAD(IOM#)+2*4;

   1637  1 000047   000000 221010 xsym               LDX1    IOMTAB,X0
         1 000050   000010 623011                    EAX3    8,X1
         1 000051   000000 743000 0                  STX3    CON_PTR

     1887     1638        /* Wait for connect channel to free up */
     1888     1639    3                   CHAN$=CON$;

   1639  1 000052   000000 236000 0                  LDQ     CON_PTR
         1 000053   200006 756100                    STQ     CHAN$,,AUTO

     1889     1640    4                   DO UNTIL CMBOX.W1.H2.TALLY=0;

     1890     1641    4                   END;                    /* DO                                 */

   1641  1 000054   200006 470500                    LDP0    CHAN$,,AUTO
         1 000055   000000 236100                    LDQ     0,,PR0
         1 000056   007777 316007                    CANQ    4095,DL
         1 000057   000054 601000 1                  TNZ     s:1641

     1891     1642    3                   CMBOX.LPW$=ADDR(PCWS);  /* Pointer to PCW                     */

   1642  1 000060   000002 236000 2                  LDQ     2
         1 000061   000000 756100                    STQ     0,,PR0

PL6.E3A0      #025=CLOSE_SYST File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:469  
     1892     1643    3                   CMBOX.W1.H2.TAL='1'B;   /* Tally                              */

   1643  1 000062   020000 236007                    LDQ     8192,DL
         1 000063   000000 256100                    ORSQ    0,,PR0

     1893     1644    3                   CMBOX.W1.H2.TALLY=1;    /* Count 1                            */

   1644  1 000064   000001 236007                    LDQ     1,DL
         1 000065   000000 752103                    STCQ    0,'03'O,PR0

     1894     1645    3                   CMBOX.W2='0'B;          /* LPWX                               */

   1645  1 000066   000001 450100                    STZ     1,,PR0

     1895     1646    3                   PORT#=IOMTAB.PORT#(IOM#);

   1646  1 000067   200003 720100                    LXL0    IOM#,,AUTO
         1 000070   000000 236010 xsym               LDQ     IOMTAB,X0
         1 000071   000007 376007                    ANQ     7,DL
         1 000072   200010 756100                    STQ     PORT#,,AUTO

     1896     1647    3                   CALL START_IO(PORT#);

   1647  1 000073   200010 631500                    EPPR1   PORT#,,AUTO
         1 000074   200012 451500                    STP1    NIOM#+1,,AUTO
         1 000075   200012 630500                    EPPR0   NIOM#+1,,AUTO
         1 000076   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000077   000000 701000 xent               TSX1    START_IO
         1 000100   000000 011000                    NOP     0

     1897     1648        /* Wait for connect channel to free up */
     1898     1649    4                   DO UNTIL CMBOX.W1.H2.TALLY=0;

     1899     1650    4                   END;                    /* DO UNTIL                           */

   1650  1 000101   200006 470500                    LDP0    CHAN$,,AUTO
         1 000102   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #025=CLOSE_SYST File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:470  
         1 000103   007777 316007                    CANQ    4095,DL
         1 000104   000101 601000 1                  TNZ     s:1650

     1900     1651        /* Wait a while */
     1901     1652    4                   DO I=0 TO 128*1024;

   1652  1 000105   200007 450100                    STZ     I,,AUTO
         1 000106   000112 710000 1                  TRA     s:1653+3

     1902     1653    4                   END;                    /* DO I=                              */

   1653  1 000107   200007 235100                    LDA     I,,AUTO
         1 000110   000001 035007                    ADLA    1,DL
         1 000111   200007 755100                    STA     I,,AUTO
         1 000112   200007 235100                    LDA     I,,AUTO
         1 000113   400001 115007                    CMPA    -131071,DL
         1 000114   000107 602000 1                  TNC     s:1653

     1903     1654    3                 END;

     1904     1655    2           END;

   1655  1 000115   200003 235100                    LDA     IOM#,,AUTO
         1 000116   000001 035007                    ADLA    1,DL
         1 000117   200003 755100                    STA     IOM#,,AUTO
         1 000120   200011 236100                    LDQ     NIOM#,,AUTO
         1 000121   200003 116100                    CMPQ    IOM#,,AUTO
         1 000122   000020 603000 1                  TRC     s:1627

     1905     1656    1           RETURN;

   1656  1 000123   000000 702200 xent               TSX2  ! X66_ARET
     1906     1657    1   END CLOSE_SYST;
     1907     1658        %EOD;

PL6.E3A0      #025=CLOSE_SYST File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:471  
--  Include file information  --

   NI$TABLES.:E05TOU  is referenced.
   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure CLOSE_SYST.
PL6.E3A0      #025=CLOSE_SYST File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:472  

 **** Variables and constants ****

  ****  Section 000  Data  CLOSE_SYST

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CON$                       0-0-0/w STRC        r     1 CON_PTR
     2-0-0/d STRC(72)    r     1 PCWS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w PTR         r     1 CHAN$                      7-0-0/w UBIN        r     1 I
     4-0-0/w PTR         r     1 INFO$                      5-0-0/w PTR         r     1 INFO2$
     5-0-0/w STRC        r     1 INFO2_PTR                  4-0-0/w STRC        r     1 INFO_PTR
     3-0-0/w UBIN        r     1 IOM#                      11-0-0/w UBIN        r     1 NIOM#
    10-0-0/w UBIN        r     1 PORT#

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 IOMTAB(0:3)
     0-0-0/w PTR         r     1 NI$IOM$(0:3)
     0-0-0/w UBIN        r     1 NI_IOMS

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 BAS_PTR(0:0)
     0-0-0/w UBIN        r     1 BAS_UBIN                   0-0-0/w STRC(144)   r     1 CMBOX
PL6.E3A0      #025=CLOSE_SYST File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:473  
     0-0-0/w STRC(252)   r     1 NI$IOM


   Procedure CLOSE_SYST requires 84 words for executable code.
   Procedure CLOSE_SYST requires 12 words of local(AUTO) storage.
PL6.E3A0      #025=CLOSE_SYST File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:474  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #025=CLOSE_SYST File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:475  
          MINI XREF LISTING

BAS_PTR
      1582**DCL      1627>>ASSIGN
BAS_UBIN
      1581**DCL      1623>>ASSIGN
CHAN$
      1615**DCL      1502--IMP-PTR  1632<<ASSIGN   1633>>ASSIGN   1634>>ASSIGN   1635>>ASSIGN   1639<<ASSIGN
      1640>>DOUNTIL  1642>>ASSIGN   1643>>ASSIGN   1644>>ASSIGN   1645>>ASSIGN   1649>>DOUNTIL
CMBOX.LPW$
      1513**DCL      1633<<ASSIGN   1642<<ASSIGN
CMBOX.W1
      1503**DCL      1513--REDEF
CMBOX.W1.H2.TAL
      1510**DCL      1643<<ASSIGN
CMBOX.W1.H2.TALLY
      1512**DCL      1634<<ASSIGN   1640>>DOUNTIL  1644<<ASSIGN   1649>>DOUNTIL
CMBOX.W2
      1514**DCL      1635<<ASSIGN   1645<<ASSIGN
CMBOX.W3
      1517**DCL      1520--REDEF
CMBOX.W4
      1521**DCL      1524--REDEF
CON$
      1561**DCL      1632>>ASSIGN   1639>>ASSIGN
CON_PTR
      1554**DCL      1561--REDEF
CON_PTR.WOFFS
      1555**DCL      1631<<ASSIGN   1637<<ASSIGN
I
      1616**DCL      1652<<DOINDEX
INFO$
      1562**DCL      1574--REDEF    1581--IMP-PTR  1582--IMP-PTR  1621<<ASSIGN   1623>>ASSIGN   1624<<ASSIGN
      1627>>ASSIGN
PL6.E3A0      #025=CLOSE_SYST File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:476  
INFO2$
      1590**DCL      1602--REDEF    1627<<ASSIGN   1629>>IF
INFO2_PTR.S_D_FIELD
      1606**DCL      1628<<ASSIGN
INFO_PTR.S_D_FIELD
      1578**DCL      1622<<ASSIGN   1625<<ASSIGN
IOM#
      1499**DCL      1626<<DOINDEX  1627>>ASSIGN   1631>>ASSIGN   1637>>ASSIGN   1646>>ASSIGN
IOMTAB.MAILBAD
      1538**DCL      1631>>ASSIGN   1637>>ASSIGN
IOMTAB.PORT#
      1540**DCL      1646>>ASSIGN
NI$IOM.STATUS.DOWN
      1587**DCL      1629>>IF
NI$IOM$
      1584**DCL      1624--ASSIGN
NIOM#
      1618**DCL      1623<<ASSIGN   1626>>DOINDEX
NI_IOMS
      1583**DCL      1621--ASSIGN
PCWS
      1609**DCL      1633--ASSIGN   1642--ASSIGN
PORT#
      1617**DCL      1646<<ASSIGN   1647<>CALL
START_IO
      1500**DCL-ENT  1647--CALL

PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:477  
     1908        1        /*T***********************************************************/
     1909        2        /*T*                                                         */
     1910        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1911        4        /*T*                                                         */
     1912        5        /*T***********************************************************/
     1913        6        DO_RPM_CFG: PROC (IMX_NO) ALTRET;
     1914        7        /*F*    NAME:         DO_RPM_CFG
     1915        8
     1916        9                PURPOSE:      MCA IO INTERFACE
     1917       10        */
     1918       11        /*D*    NAME:         DO_RPM_CFG
     1919       12                CALL:         CALL DO_RPM_CFG(IMX_NO)
     1920       13                ENVIRONMENT:  AARDVARK Linkage Segment - used only on the DPS8000
     1921       14                INPUT:        IMX_NO
     1922       15                OUTPUT:       Data read by MCA
     1923       16                DESCRIPTION:  This routine is called to read the configuration
     1924       17                   file.
     1925       18        */
     1926       19        %INCLUDE IS$MACROS;
     1927     1294        %INCLUDE XUD_UTS_M;
     1928     1376        %XUD$UTS_ENTRIES;
     1929     1408        %XUD_UTS_EQU;
     1930     1419
     1931     1420    1   DCL   SET_TIME_FROM_SP ENTRY(1);
     1932     1421    1   DCL   IMX_NO UBIN WORD;
     1933     1422    1   DCL   CH3_CONS_DCWS(0:3) UBIN WORD SYMREF;
     1934     1423    1   DCL   FW_LOAD(0:511) BIT(1) UNAL SYMREF;
     1935     1424    1   DCL   IS_CFG_NAME CHAR(9) UNAL SYMREF;
     1936     1425    1   DCL   IS_MEM_SIDE1 BIT(1) SYMREF;
     1937     1426    1   DCL   IS_CSP_SIDE1 BIT(1) SYMREF;
     1938     1427    1   DCL   IS_CFG_TYPE UBIN WORD SYMREF;
     1939     1428    1   DCL    CHN_CFG(0:511) BIT(1) UNAL SYMREF;
     1940     1429    1   DCL   HW_RPM_CFG BIT(1) SYMREF;
     1941     1430    1   DCL   POBUF CHAR(4096) SYMREF;
     1942     1431    1   DCL   POBUF_BIT(0:4095) REDEF POBUF BIT(9) UNAL ;
     1943     1432    1   DCL   RPM_CONSOLE SBIN WORD SYMREF;
     1944     1433    1   DCL   LOG_CHN SBIN WORD;
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:478  
     1945     1434    1   DCL   ST$LEN UBIN WORD;
     1946     1435    1   DCL   ST$   PTR;
     1947     1436    1   DCL   ST CHAR(ST$LEN) BASED(ST$);
     1948     1437        %MCA_CFG(STCLASS=SYMREF);
     1949     1547        %MCA_HDR(NAME=INIT_HDR);
     1950     1581        %MCA_HDR(STCLASS="BASED(PO$)");
     1951     1615        %IMX_MBX(NAME=CHN3_MBX,STCLASS=SYMREF);
     1952     1672        %IMX_MBX(NAME=PATT_MBX,STCLASS=SYMREF);
     1953     1729        %TEXTC(N#=CFG_RESET_ERR,M#="'CMDNO x: Problems resetting -  boot aborted'");
     1954     1734        %TEXTC(N#=CFG_ERR,M#="'CMDNO x: Problems executing command -  boot aborted'");
     1955     1739        %TEXTC(N#=CFG_STATUS,M#="'CMDNO x: Invalid status -  boot aborted'");
     1956     1744    1   DCL 1 TEXTM BASED(MESSAGE$),
     1957     1745    1         2 CNT UBIN WORD,
     1958     1746    1         2 TXT CHAR(TEXTM.CNT);
     1959     1747    1   DCL  MESSAGE$ PTR;
     1960     1748    1   DCL   READ_CONFIG_INIT CHAR(0) CONSTANT INIT('READ CONFIG');
     1961     1749    1   DCL   SP_CCINIT_INIT CHAR(0) CONSTANT INIT('SP CCINIT CP6');
     1962     1750    1   DCL   SP_SCU0_STATE CHAR(0) CONSTANT INIT('SP STATE SCU 0 ');
     1963     1751    1   DCL   SP_SCU1_STATE CHAR(0) CONSTANT INIT('SP STATE SCU 1 ');
     1964     1752    1   DCL   SP_SWITCH CHAR(0) CONSTANT INIT('SP SWITCH CPU 0 PORT A OFF ');
     1965     1753    1   DCL   HANG ENTRY;
     1966     1754    1   DCL   START_IO_RPM ENTRY(2);
     1967     1755    1   DCL   TYPEC ENTRY(1) ;
     1968     1756    1   DCL   HW_RPM_CFG_DONE(0:3) BIT(1) UNAL STATIC INIT('0'B*0);
     1969     1757    1   DCL   MBX$ PTR;
     1970     1758    1   DCL   PO$ PTR STATIC INIT(ADDR(POBUF));
     1971     1759    1   DCL   SP$ PTR;
     1972     1760    1   DCL   TEMP_DCWS$ PTR;
     1973     1761        %PTR_STRUCT(NAME=TEMP_DCWS_PTR,STCLASS="REDEF TEMP_DCWS$");
     1974     1779    1   DCL   TRYS SBIN WORD;
     1975     1780    1   DCL   NEXT_DEFINER UBIN WORD;
     1976     1781    1   DCL DO_CMD UBIN WORD;
     1977     1782    1   DCL   TEMP$STRING CHAR(30);
     1978     1783    1   DCL   OR_TIME UBIN WORD;
     1979     1784    1   DCL 1 OR_TIME_STRUC REDEF OR_TIME,
     1980     1785    1         2 * BIT(4) UNAL,
     1981     1786    1         2 HEX_DIGIT(0:7) UBIN(4) UNAL;
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:479  
     1982     1787    1   DCL   M SBIN WORD;
     1983     1788    1   DCL 1 SP_TIME BASED(SP$),
     1984     1789    1         2 BITE(0:7) CALIGNED,
     1985     1790    1           3 * BIT(5) UNAL,
     1986     1791    1           3 HEX_DIGIT UBIN(4) UNAL;
     1987     1792    1   DCL 1 TEMP_DCWS BASED(TEMP_DCWS$) ALIGNED,
     1988     1793    1         2 DCW0,
     1989     1794    1           3 OPCODE UBIN(6) UNAL,
     1990     1795    1           3 DEV# UBIN(6) UNAL,
     1991     1796    1           3 ADEXT BIT(6),
     1992     1797    1           3 TYPE BIT(3),
     1993     1798    1           3 EC BIT(1),
     1994     1799    1           3 CONT BIT(1),
     1995     1800    1           3 MARK BIT(1),
     1996     1801    1           3 * BIT(12),
     1997     1802    1         2 DCW1,
     1998     1803    1           3 AD UBIN(18) UNAL,
     1999     1804    1           3 CP UBIN(3) UNAL,
     2000     1805    1           3 NU BIT(1) UNAL,
     2001     1806    1           3 TYPE BIT(2) UNAL,
     2002     1807    1           3 TALLY UBIN(12) UNAL,
     2003     1808    1         2 DCW1$ REDEF DCW1 PTR,
     2004     1809    1         2 DCW2,
     2005     1810    1           3 OPCODE UBIN(6) UNAL,
     2006     1811    1           3 DEV# UBIN(6) UNAL,
     2007     1812    1           3 ADEXT BIT(6),
     2008     1813    1           3 TYPE BIT(3),
     2009     1814    1           3 EC BIT(1),
     2010     1815    1           3 CONT BIT(1),
     2011     1816    1           3 MARK BIT(1),
     2012     1817    1           3 * BIT(12),
     2013     1818    1         2 DCW3,
     2014     1819    1           3 AD UBIN(18) UNAL,
     2015     1820    1           3 CP UBIN(3) UNAL,
     2016     1821    1           3 NU BIT(1) UNAL,
     2017     1822    1           3 TYPE BIT(2) UNAL,
     2018     1823    1           3 TALLY UBIN(12) UNAL;
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:480  
     2019     1824    1   DCL I SBIN WORD;
     2020     1825    1   DCL J SBIN WORD;
     2021     1826    1   DCL   MCA_FW_LOAD(0:15) BIT(1) UNAL CONSTANT INIT(
     2022     1827    1      '0'B,'0'B,'1'B,'0'B,'1'B,'1'B,'1'B,'0'B,'0'B,'0'B,'0'B,'1'B,'0'B*0);
     2023     1828
     2024     1829    1           IF ~HW_RPM_CFG THEN
     2025     1830    1             ALTRETURN;
     2026     1831    1           IF HW_RPM_CFG_DONE(IMX_NO) THEN
     2027     1832    1             RETURN;
     2028     1833    1           CALL CHANNEL_3_CMD(IMX_NO,0);
     2029     1834    2           DO I = 0 TO 15;
     2030     1835    3             IF MCA_CFG.LEVEL_1.STATE(I) = 150 THEN DO;
     2031     1836    3                   IF RPM_CONSOLE = -1 THEN
     2032     1837    3                     IF MCA_CFG.LEVEL_1.CONSOLE_CNTL.REM_MAINT(I) THEN
     2033     1838    3                       IF MCA_CFG.LEVEL_1.CONSOLE_CNTL.MASTER(I) THEN
     2034     1839    3                         RPM_CONSOLE = MCA_CFG.LEVEL_1.PRI_CHN(I);
     2035     1840    4                   DO J = MCA_CFG.LEVEL_1.PRI_CHN(I) TO MCA_CFG.LEVEL_1.PRI_CHN(I)
     2036     1841    4                     + MCA_CFG.LEVEL_1.LOG_CHNS(I) - 1;
     2037     1842    4                     CHN_CFG(IMX_NO * 128 + J) = '1'B;
     2038     1843    4                     IF MCA_FW_LOAD(MCA_CFG.LEVEL_1.HARDWARE_ID(I)) THEN
     2039     1844    4                       FW_LOAD( IMX_NO * 128 + J) = '0'B;
     2040     1845    4                   END;
     2041     1846    3                 END;
     2042     1847    2           END;
     2043     1848    1           HW_RPM_CFG_DONE(IMX_NO) = '1'B;
     2044     1849    1           RETURN;
     2045     1850    1   DO_RPM_TIME:ENTRY(IMX_NO) ALTRET;
     2046     1851
     2047     1852    1           CALL CHANNEL_3_CMD(IMX_NO,1);
     2048     1853    1           CALL SET_TIME_FROM_SP(OR_TIME);
     2049     1854    1           RETURN;
     2050     1855    1   DO_SCU_STATE: ENTRY(IMX_NO) ALTRET;
     2051     1856    1           DO_CMD = %MCA_CMD_STATE_SCU0# + MOD(IMX_NO,2);
     2052     1857    1           CALL CHANNEL_3_CMD(MOD(IMX_NO,2),DO_CMD);
     2053     1858    1           RETURN;
     2054     1859    1   DO_CPU_SWITCH: ENTRY(IMX_NO) ALTRET;
     2055     1860    1           DO_CMD = %MCA_CMD_SWITCH_CPU0# + IMX_NO;
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:481  
     2056     1861    1           CALL CHANNEL_3_CMD(MOD(IMX_NO,2),DO_CMD);
     2057     1862    1           RETURN;
     2058     1863
     2059     1864        %EJECT;
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:482  
     2060     1865    1   CHANNEL_3_CMD:PROC(IMX#,CMD_NO);
     2061     1866    2   DCL IMX# UBIN WORD;
     2062     1867    2   DCL CMD_NO UBIN WORD;
     2063     1868    2           MESSAGE$ = ADDR(CFG_STATUS);
     2064     1869    2           CALL BINCHAR(SUBSTR(TEXTM.TXT,6,1),CMD_NO);
     2065     1870    2           TEMP_DCWS$ = ADDR(CH3_CONS_DCWS);
     2066     1871    2           MBX$ = ADDR(CHN3_MBX);
     2067     1872    2           CHN3_MBX = PATT_MBX;
     2068     1873    2           CHN3_MBX.LPW.DCW_ADDR = TEMP_DCWS_PTR.WOFFS;
     2069     1874    2   START_OVER:
     2070     1875    2           CALL BUILD_CH3_DCWS(%FCNRSS,%FCNRDC3,9);
     2071     1876    2           TEMP_DCWS.DCW0.CONT = '0'B;
     2072     1877    2           CALL READ_CHN3(IMX#);
     2073     1878    3           IF CHN3_MBX.STATUS.W8_INFO.TERM ~= '4002'O THEN DO;
     2074     1879    3                 TRYS = TRYS + 1;
     2075     1880    4                 IF TRYS > 5 THEN DO;
     2076     1881    4                       MESSAGE$ = ADDR(CFG_RESET_ERR);
     2077     1882    4                       CALL BINCHAR(SUBSTR(TEXTM.TXT,6,1),CMD_NO);
     2078     1883    4                       CALL TYPEC(TEXTM);
     2079     1884    4                       CALL HANG;
     2080     1885    4                     END;
     2081     1886    3                 GOTO START_OVER;
     2082     1887    3               END;
     2083     1888    3           DO CASE (CMD_NO);
     2084     1889    3             CASE (%MCA_CMD_CONFIG#);
     2085     1890    3               CALL BUILD_CH3_DCWS(%FCNWTC3,%FCNRDC3,7,LENGTHC(READ_CONFIG_INIT),
              1890                        READ_CONFIG_INIT);
     2086     1891    3             CASE (%MCA_CMD_CCINIT#);
     2087     1892    3               CALL BUILD_CH3_DCWS(%FCNWTC3,%FCNRDC3,7,LENGTHC(SP_CCINIT_INIT),
              1892                        SP_CCINIT_INIT);
     2088     1893    3             CASE(%MCA_CMD_SWITCH_CPU0#,%MCA_CMD_SWITCH_CPU2#);
     2089     1894    3               TEMP$STRING = SP_SWITCH;
     2090     1895    3               IF CMD_NO = %MCA_CMD_SWITCH_CPU0# THEN
     2091     1896    3                 SUBSTR(TEMP$STRING,14,1) = '0';
     2092     1897    3                 ELSE
     2093     1898    3                 SUBSTR(TEMP$STRING,14,1) = '2';
     2094     1899    3               SUBSTR(TEMP$STRING,21,1) = 'B';
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:483  
     2095     1900    3               CALL BUILD_CH3_DCWS(%FCNWTC3,%FCNRDC3,7,LENGTHC(SP_SWITCH),TEMP$STRING);
     2096     1901    3             CASE(%MCA_CMD_SWITCH_CPU1#,%MCA_CMD_SWITCH_CPU3#);
     2097     1902    3               TEMP$STRING = SP_SWITCH;
     2098     1903    3               IF CMD_NO = %MCA_CMD_SWITCH_CPU1# THEN
     2099     1904    3                 SUBSTR(TEMP$STRING,14,1) = '0';
     2100     1905    3                 ELSE
     2101     1906    3                 SUBSTR(TEMP$STRING,14,1) = '2';
     2102     1907    3               SUBSTR(TEMP$STRING,21,1) = 'A';
     2103     1908    3               CALL BUILD_CH3_DCWS(%FCNWTC3,%FCNRDC3,7,LENGTHC(SP_SWITCH),TEMP$STRING);
     2104     1909    3             CASE (%MCA_CMD_STATE_SCU0#);
     2105     1910    3               CALL BUILD_CH3_DCWS(%FCNWTC3,%FCNRDC3,7,LENGTHC(SP_SCU0_STATE),
              1910                        SP_SCU0_STATE);
     2106     1911    3             CASE (%MCA_CMD_STATE_SCU1#);
     2107     1912    3               CALL BUILD_CH3_DCWS(%FCNWTC3,%FCNRDC3,7,LENGTHC(SP_SCU1_STATE),
              1912                        SP_SCU1_STATE);
     2108     1913    3           END;
     2109     1914    2   DO_READ:
     2110     1915    2           CALL READ_CHN3(IMX#);
     2111     1916    3           DO SELECT(CHN3_MBX.STATUS.W8_INFO.TERM & '3777'O);
     2112     1917    3             SELECT('0040'O);
     2113     1918    3             IF MCA_HDR.DEFINER = %MCA_DEF_READ# THEN
     2114     1919    3               NEXT_DEFINER = %MCA_DEF_STATUS#;
     2115     1920    3               ELSE
     2116     1921    3               IF MCA_HDR.DEFINER = %MCA_DEF_READDATA# THEN
     2117     1922    3                 NEXT_DEFINER = %MCA_DEF_DATA#;
     2118     1923    4                 ELSE DO;
     2119     1924    4                     MESSAGE$ = ADDR(CFG_ERR);
     2120     1925    4                     CALL BINCHAR(SUBSTR(TEXTM.TXT,6,1),CMD_NO);
     2121     1926    4                     CALL TYPEC(TEXTM);
     2122     1927    4                     CALL HANG;
     2123     1928    4                   END;
     2124     1929    4             DO CASE (CMD_NO);
     2125     1930    4               CASE(%MCA_CMD_CONFIG#);
     2126     1931    4                 ST$LEN = LENGTHC(MCA_CFG);
     2127     1932    4                 ST$ = ADDR(MCA_CFG);
     2128     1933    4                 ST = PINCRC(PO$,32)->ST;
     2129     1934    4               CASE(%MCA_CMD_CCINIT#);
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:484  
     2130     1935    4                 SP$ = PINCRC(PO$,LENGTHC(INIT_HDR));
     2131     1936    4                 OR_TIME = 0;
     2132     1937    5                 DO I = 0 TO 7;
     2133     1938    5                   OR_TIME_STRUC.HEX_DIGIT(I) = SP_TIME.BITE.HEX_DIGIT(I);
     2134     1939    5                 END;
     2135     1940    4                 CALL XUD$UTS_ADJ_25TH (OR_TIME, 0, OR_TIME*%UTS_25TH_SEC#);
     2136     1941    4               CASE(%MCA_CMD_STATE_SCU0#,%MCA_CMD_STATE_SCU1#);
     2137     1942    4                 ST$ = PINCRC(PO$,32);
     2138     1943    4                 ST$LEN = MCA_HDR.SRCLEN;
     2139     1944    4                 CALL INDEX(I,'CONFIGURED',ST);
     2140     1945    5                 IF (I < ST$LEN) THEN DO;
     2141     1946    5                       CALL INDEX(I,'S',ST);
     2142     1947    5                       IS_CFG_NAME = SUBSTR(ST,I,12);
     2143     1948    5                       IF SUBSTR(IS_CFG_NAME,6,1) = '1' THEN
     2144     1949    5                         IS_MEM_SIDE1 = '1'B;
     2145     1950    5                         ELSE
     2146     1951    5                         IS_MEM_SIDE1 = '0'B;
     2147     1952    5                       IF SUBSTR(IS_CFG_NAME,1,1) = '1' THEN
     2148     1953    5                         IS_CSP_SIDE1 = '1'B;
     2149     1954    5                         ELSE
     2150     1955    5                         IS_CSP_SIDE1 = '0'B;
     2151     1956    5                       IF SUBSTR(IS_CFG_NAME,2,4) = 'SING' THEN
     2152     1957    5                         IS_CFG_TYPE = %IS_CFG_SINGLE_CAB#;
     2153     1958    6                         ELSE DO;
     2154     1959    7                             IF SUBSTR(IS_CFG_NAME,6,1) = 'H' THEN DO;
     2155     1960    7                                   IF SUBSTR(IS_CFG_NAME,7,1) = 'R' THEN
     2156     1961    7                                     IS_CFG_TYPE = %IS_CFG_MULT_CAB_REL#;
     2157     1962    7                                     ELSE
     2158     1963    7                                     IS_CFG_TYPE = %IS_CFG_SINGLE_CAB#;
     2159     1964    7                                   IF IS_CSP_SIDE1 THEN
     2160     1965    7                                     IS_MEM_SIDE1 = '1'B;
     2161     1966    7                                 END;
     2162     1967    6                               ELSE
     2163     1968    6                               IS_CFG_TYPE = %IS_CFG_MULT_CAB#;
     2164     1969    6                           END;
     2165     1970    5                     END;
     2166     1971    4             END;
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:485  
     2167     1972    3             IF CMD_NO >= %MCA_CMD_STATE_SCU0# AND NEXT_DEFINER= %MCA_DEF_DATA# THEN
     2168     1973    3               CALL BUILD_CH3_DCWS(%FCNWDC3,%FCNRDC3,NEXT_DEFINER,0,SP_SCU0_STATE);
     2169     1974    3               ELSE
     2170     1975    3               CALL BUILD_CH3_DCWS(%FCNWDC3,%FCNRDC3,NEXT_DEFINER);
     2171     1976    3             GOTO DO_READ;
     2172     1977    3             SELECT('0002'O);
     2173     1978    3             RETURN;
     2174     1979    3             SELECT (ELSE);
     2175     1980    3           TRYS = TRYS + 1;
     2176     1981    4           IF TRYS > 5 THEN DO;
     2177     1982    4                 CALL TYPEC(TEXTM);
     2178     1983    4                 CALL HANG;
     2179     1984    4               END;
     2180     1985    3           GOTO START_OVER;
     2181     1986    3           END;
     2182     1987    2   END CHANNEL_3_CMD;
     2183     1988        %EJECT;
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:486  
     2184     1989    1   BUILD_CH3_DCWS:PROC(IDCW0,IDCW1,HDR_DEFINER,HDR_CMD_LEN,HDR_CMD);
     2185     1990    2   DCL   IDCW0 SBIN WORD;
     2186     1991    2   DCL   IDCW1 SBIN WORD;
     2187     1992    2   DCL   HDR_DEFINER SBIN WORD;
     2188     1993    2   DCL   HDR_CMD_LEN SBIN WORD;
     2189     1994    2   DCL   HDR_CMD CHAR(HDR_CMD_LEN);
     2190     1995
     2191     1996    2           MCA_HDR = INIT_HDR;
     2192     1997    2           MCA_HDR.DEFINER = HDR_DEFINER;
     2193     1998    2           TEMP_DCWS = '0'B;
     2194     1999    2           TEMP_DCWS.DCW1$ = ADDR(POBUF);
     2195     2000    2           TEMP_DCWS.DCW1.TALLY = 0;
     2196     2001    2           IF ADDR(HDR_CMD_LEN) = ADDR(NIL) THEN
     2197     2002    2             MCA_HDR.TBYTES = 0;
     2198     2003    3             ELSE DO;
     2199     2004    3                 MCA_HDR.TBYTES = HDR_CMD_LEN + 1;
     2200     2005    3                 TEMP_DCWS.DCW1.TALLY = (HDR_CMD_LEN + 4)/4;
     2201     2006    3                 SUBSTR(POBUF,32,HDR_CMD_LEN) = HDR_CMD;
     2202     2007    3                 POBUF_BIT(HDR_CMD_LEN + 32) = '015'O;
     2203     2008    3               END;
     2204     2009    2           TEMP_DCWS.DCW0.DEV# = 0;
     2205     2010    2           TEMP_DCWS.DCW0.TYPE = '7'O;
     2206     2011    2           TEMP_DCWS.DCW0.CONT = '1'B;
     2207     2012    2           TEMP_DCWS.DCW0.OPCODE = IDCW0;
     2208     2013    2           TEMP_DCWS.DCW1.TALLY = TEMP_DCWS.DCW1.TALLY + 8;
     2209     2014    2           TEMP_DCWS.DCW2 = TEMP_DCWS.DCW0;
     2210     2015    2           TEMP_DCWS.DCW2.OPCODE = IDCW1;
     2211     2016    2           TEMP_DCWS.DCW2.CONT = '0'B;
     2212     2017    2           TEMP_DCWS.DCW3 = TEMP_DCWS.DCW1;
     2213     2018    2           TEMP_DCWS.DCW3.TALLY = 0;
     2214     2019    2   END BUILD_CH3_DCWS;
     2215     2020    1   READ_CHN3: PROC(IM#);
     2216     2021    2   DCL IM# UBIN WORD;
     2217     2022    2           CHN3_MBX.STATUS ='0'B;
     2218     2023    2           CHN3_MBX.CHN_LINK.SYNC = '0'B;
     2219     2024    2           LOG_CHN = IM# * 128 + 8 + 3;
     2220     2025    2           CALL START_IO_RPM(LOG_CHN,MBX$);
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:487  
     2221     2026    3           DO UNTIL CHN3_MBX.STATUS.W8.TBIT = '1'B;
     2222     2027    3             I = 1;
     2223     2028    3           END;
     2224     2029    3           DO UNTIL CHN3_MBX.CHN_LINK.SYNC='1'B;
     2225     2030    3             I = 1;
     2226     2031    3           END;
     2227     2032    2   END READ_CHN3;
     2228     2033    1   END DO_RPM_CFG;

PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:488  
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure DO_RPM_CFG.

   Procedure DO_RPM_CFG requires 638 words for executable code.
   Procedure DO_RPM_CFG requires 42 words of local(AUTO) storage.

    No errors detected in file ISI$IOPROC.:E05TSI    .

PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:489  

 Object Unit name= DO_RPM_CFG                                 File name= ISI$IOPROC.:E05TOU
 UTS= JUL 29 '97 22:53:47.36 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    47     57  DO_RPM_CFG
    1  RoData even  UTS     27     33  DO_RPM_CFG
    2   Proc  even  none   638   1176  DO_RPM_CFG
    3  RoData even  none    34     42  DO_RPM_CFG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  DO_RPM_CFG
     2    160          yes     yes      Std        1  DO_RPM_TIME
     2    177          yes     yes      Std        1  DO_SCU_STATE
     2    220          yes     yes      Std        1  DO_CPU_SWITCH

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0     10  CFG_RESET_ERR                      0     24  CFG_ERR
    0     42  CFG_STATUS
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:490  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 SET_TIME_FROM_SP
         yes           Std       1 TYPEC
 yes     yes           Std       3 XUD$UTS_ADJ_25TH
         yes           Std       0 HANG
         yes           Std       2 START_IO_RPM
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_AALT
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_INDEX

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     CH3_CONS_DCWS                         FW_LOAD                               IS_CFG_NAME
     IS_MEM_SIDE1                          IS_CSP_SIDE1                          IS_CFG_TYPE
     CHN_CFG                               HW_RPM_CFG                            POBUF
     RPM_CONSOLE                           MCA_CFG                               CHN3_MBX
     PATT_MBX                              B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:491  


     1908        1        /*T***********************************************************/
     1909        2        /*T*                                                         */
     1910        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1911        4        /*T*                                                         */
     1912        5        /*T***********************************************************/
     1913        6        DO_RPM_CFG: PROC (IMX_NO) ALTRET;

      6  2 000000   000000 700200 xent  DO_RPM_CFG   TSX0  ! X66_AUTO_1
         2 000001   000052 000001                    ZERO    42,1

     1914        7        /*F*    NAME:         DO_RPM_CFG
     1915        8
     1916        9                PURPOSE:      MCA IO INTERFACE
     1917       10        */
     1918       11        /*D*    NAME:         DO_RPM_CFG
     1919       12                CALL:         CALL DO_RPM_CFG(IMX_NO)
     1920       13                ENVIRONMENT:  AARDVARK Linkage Segment - used only on the DPS8000
     1921       14                INPUT:        IMX_NO
     1922       15                OUTPUT:       Data read by MCA
     1923       16                DESCRIPTION:  This routine is called to read the configuration
     1924       17                   file.
     1925       18        */
     1926       19        %INCLUDE IS$MACROS;
     1927     1294        %INCLUDE XUD_UTS_M;
     1928     1376        %XUD$UTS_ENTRIES;
     1929     1408        %XUD_UTS_EQU;
     1930     1419
     1931     1420    1   DCL   SET_TIME_FROM_SP ENTRY(1);
     1932     1421    1   DCL   IMX_NO UBIN WORD;
     1933     1422    1   DCL   CH3_CONS_DCWS(0:3) UBIN WORD SYMREF;
     1934     1423    1   DCL   FW_LOAD(0:511) BIT(1) UNAL SYMREF;
     1935     1424    1   DCL   IS_CFG_NAME CHAR(9) UNAL SYMREF;
     1936     1425    1   DCL   IS_MEM_SIDE1 BIT(1) SYMREF;
     1937     1426    1   DCL   IS_CSP_SIDE1 BIT(1) SYMREF;
     1938     1427    1   DCL   IS_CFG_TYPE UBIN WORD SYMREF;
     1939     1428    1   DCL    CHN_CFG(0:511) BIT(1) UNAL SYMREF;
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:492  
     1940     1429    1   DCL   HW_RPM_CFG BIT(1) SYMREF;
     1941     1430    1   DCL   POBUF CHAR(4096) SYMREF;
     1942     1431    1   DCL   POBUF_BIT(0:4095) REDEF POBUF BIT(9) UNAL ;
     1943     1432    1   DCL   RPM_CONSOLE SBIN WORD SYMREF;
     1944     1433    1   DCL   LOG_CHN SBIN WORD;
     1945     1434    1   DCL   ST$LEN UBIN WORD;
     1946     1435    1   DCL   ST$   PTR;
     1947     1436    1   DCL   ST CHAR(ST$LEN) BASED(ST$);
     1948     1437        %MCA_CFG(STCLASS=SYMREF);
     1949     1547        %MCA_HDR(NAME=INIT_HDR);
     1950     1581        %MCA_HDR(STCLASS="BASED(PO$)");
     1951     1615        %IMX_MBX(NAME=CHN3_MBX,STCLASS=SYMREF);
     1952     1672        %IMX_MBX(NAME=PATT_MBX,STCLASS=SYMREF);
     1953     1729        %TEXTC(N#=CFG_RESET_ERR,M#="'CMDNO x: Problems resetting -  boot aborted'");
     1954     1734        %TEXTC(N#=CFG_ERR,M#="'CMDNO x: Problems executing command -  boot aborted'");
     1955     1739        %TEXTC(N#=CFG_STATUS,M#="'CMDNO x: Invalid status -  boot aborted'");
     1956     1744    1   DCL 1 TEXTM BASED(MESSAGE$),
     1957     1745    1         2 CNT UBIN WORD,
     1958     1746    1         2 TXT CHAR(TEXTM.CNT);
     1959     1747    1   DCL  MESSAGE$ PTR;
     1960     1748    1   DCL   READ_CONFIG_INIT CHAR(0) CONSTANT INIT('READ CONFIG');
     1961     1749    1   DCL   SP_CCINIT_INIT CHAR(0) CONSTANT INIT('SP CCINIT CP6');
     1962     1750    1   DCL   SP_SCU0_STATE CHAR(0) CONSTANT INIT('SP STATE SCU 0 ');
     1963     1751    1   DCL   SP_SCU1_STATE CHAR(0) CONSTANT INIT('SP STATE SCU 1 ');
     1964     1752    1   DCL   SP_SWITCH CHAR(0) CONSTANT INIT('SP SWITCH CPU 0 PORT A OFF ');
     1965     1753    1   DCL   HANG ENTRY;
     1966     1754    1   DCL   START_IO_RPM ENTRY(2);
     1967     1755    1   DCL   TYPEC ENTRY(1) ;
     1968     1756    1   DCL   HW_RPM_CFG_DONE(0:3) BIT(1) UNAL STATIC INIT('0'B*0);
     1969     1757    1   DCL   MBX$ PTR;
     1970     1758    1   DCL   PO$ PTR STATIC INIT(ADDR(POBUF));
     1971     1759    1   DCL   SP$ PTR;
     1972     1760    1   DCL   TEMP_DCWS$ PTR;
     1973     1761        %PTR_STRUCT(NAME=TEMP_DCWS_PTR,STCLASS="REDEF TEMP_DCWS$");
     1974     1779    1   DCL   TRYS SBIN WORD;
     1975     1780    1   DCL   NEXT_DEFINER UBIN WORD;
     1976     1781    1   DCL DO_CMD UBIN WORD;
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:493  
     1977     1782    1   DCL   TEMP$STRING CHAR(30);
     1978     1783    1   DCL   OR_TIME UBIN WORD;
     1979     1784    1   DCL 1 OR_TIME_STRUC REDEF OR_TIME,
     1980     1785    1         2 * BIT(4) UNAL,
     1981     1786    1         2 HEX_DIGIT(0:7) UBIN(4) UNAL;
     1982     1787    1   DCL   M SBIN WORD;
     1983     1788    1   DCL 1 SP_TIME BASED(SP$),
     1984     1789    1         2 BITE(0:7) CALIGNED,
     1985     1790    1           3 * BIT(5) UNAL,
     1986     1791    1           3 HEX_DIGIT UBIN(4) UNAL;
     1987     1792    1   DCL 1 TEMP_DCWS BASED(TEMP_DCWS$) ALIGNED,
     1988     1793    1         2 DCW0,
     1989     1794    1           3 OPCODE UBIN(6) UNAL,
     1990     1795    1           3 DEV# UBIN(6) UNAL,
     1991     1796    1           3 ADEXT BIT(6),
     1992     1797    1           3 TYPE BIT(3),
     1993     1798    1           3 EC BIT(1),
     1994     1799    1           3 CONT BIT(1),
     1995     1800    1           3 MARK BIT(1),
     1996     1801    1           3 * BIT(12),
     1997     1802    1         2 DCW1,
     1998     1803    1           3 AD UBIN(18) UNAL,
     1999     1804    1           3 CP UBIN(3) UNAL,
     2000     1805    1           3 NU BIT(1) UNAL,
     2001     1806    1           3 TYPE BIT(2) UNAL,
     2002     1807    1           3 TALLY UBIN(12) UNAL,
     2003     1808    1         2 DCW1$ REDEF DCW1 PTR,
     2004     1809    1         2 DCW2,
     2005     1810    1           3 OPCODE UBIN(6) UNAL,
     2006     1811    1           3 DEV# UBIN(6) UNAL,
     2007     1812    1           3 ADEXT BIT(6),
     2008     1813    1           3 TYPE BIT(3),
     2009     1814    1           3 EC BIT(1),
     2010     1815    1           3 CONT BIT(1),
     2011     1816    1           3 MARK BIT(1),
     2012     1817    1           3 * BIT(12),
     2013     1818    1         2 DCW3,
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:494  
     2014     1819    1           3 AD UBIN(18) UNAL,
     2015     1820    1           3 CP UBIN(3) UNAL,
     2016     1821    1           3 NU BIT(1) UNAL,
     2017     1822    1           3 TYPE BIT(2) UNAL,
     2018     1823    1           3 TALLY UBIN(12) UNAL;
     2019     1824    1   DCL I SBIN WORD;
     2020     1825    1   DCL J SBIN WORD;
     2021     1826    1   DCL   MCA_FW_LOAD(0:15) BIT(1) UNAL CONSTANT INIT(
     2022     1827    1      '0'B,'0'B,'1'B,'0'B,'1'B,'1'B,'1'B,'0'B,'0'B,'0'B,'0'B,'1'B,'0'B*0);
     2023     1828
     2024     1829    1           IF ~HW_RPM_CFG THEN

   1829  2 000002   000000 236000 xsym               LDQ     HW_RPM_CFG
         2 000003   400000 376003                    ANQ     -131072,DU
         2 000004   400000 676003                    ERQ     -131072,DU
         2 000005   000007 600000 2                  TZE     s:1831

     2025     1830    1             ALTRETURN;

   1830  2 000006   000000 702200 xent               TSX2  ! X66_AALT

     2026     1831    1           IF HW_RPM_CFG_DONE(IMX_NO) THEN

   1831  2 000007   200003 470500                    LDP0    @IMX_NO,,AUTO
         2 000010   000000 235100                    LDA     0,,PR0
         2 000011   000000 066405                    CMPB    filb='0'B
         2 000012   000055 000001 0                  BDSC    HW_RPM_CFG_DONE,A        by=0,bit=0,n=1
         2 000013   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 000014   000016 600000 2                  TZE     s:1833

     2027     1832    1             RETURN;

   1832  2 000015   000000 702200 xent               TSX2  ! X66_ARET

     2028     1833    1           CALL CHANNEL_3_CMD(IMX_NO,0);

   1833  2 000016   000000 236000 3                  LDQ     0
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:495  
         2 000017   200034 756100                    STQ     @IMX#+1,,AUTO
         2 000020   200003 236100                    LDQ     @IMX_NO,,AUTO
         2 000021   200033 756100                    STQ     J+2,,AUTO
         2 000022   000240 701000 2                  TSX1    CHANNEL_3_CMD
         2 000023   000000 011000                    NOP     0

     2029     1834    2           DO I = 0 TO 15;

   1834  2 000024   200030 450100                    STZ     I,,AUTO

     2030     1835    3             IF MCA_CFG.LEVEL_1.STATE(I) = 150 THEN DO;

   1835  2 000025   200030 236100                    LDQ     I,,AUTO
         2 000026   000013 402007                    MPY     11,DL
         2 000027   000100 101406                    MRL     fill='000'O
         2 000030   000026 400001 xsym               ADSC9   MCA_CFG+22,Q             cn=2,n=1
         2 000031   200044 000004                    ADSC9   @HDR_CMD+1,,AUTO         cn=0,n=4
         2 000032   200044 236100                    LDQ     @HDR_CMD+1,,AUTO
         2 000033   000226 116007                    CMPQ    150,DL
         2 000034   000146 601000 2                  TNZ     s:1847

     2031     1836    3                   IF RPM_CONSOLE = -1 THEN

   1836  2 000035   000000 235000 xsym               LDA     RPM_CONSOLE
         2 000036   000027 115000 xsym               CMPA    B_VECTNIL+23
         2 000037   000067 601000 2                  TNZ     s:1840

     2032     1837    3                     IF MCA_CFG.LEVEL_1.CONSOLE_CNTL.REM_MAINT(I) THEN

   1837  2 000040   200030 236100                    LDQ     I,,AUTO
         2 000041   000143 402007                    MPY     99,DL
         2 000042   000000 116003                    CMPQ    0,DU
         2 000043   000045 605000 2                  TPL     s:1837+5
         2 000044   000044 036003                    ADLQ    36,DU
         2 000045   000000 066406                    CMPB    filb='0'B
         2 000046   000026 610001 xsym               BDSC    MCA_CFG+22,Q             by=3,bit=1,n=1
         2 000047   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:496  
         2 000050   000067 600000 2                  TZE     s:1840

     2033     1838    3                       IF MCA_CFG.LEVEL_1.CONSOLE_CNTL.MASTER(I) THEN

   1838  2 000051   200030 236100                    LDQ     I,,AUTO
         2 000052   000143 402007                    MPY     99,DL
         2 000053   000000 116003                    CMPQ    0,DU
         2 000054   000056 605000 2                  TPL     s:1838+5
         2 000055   000044 036003                    ADLQ    36,DU
         2 000056   000000 066406                    CMPB    filb='0'B
         2 000057   000026 620001 xsym               BDSC    MCA_CFG+22,Q             by=3,bit=2,n=1
         2 000060   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 000061   000067 600000 2                  TZE     s:1840

     2034     1839    3                         RPM_CONSOLE = MCA_CFG.LEVEL_1.PRI_CHN(I);

   1839  2 000062   200030 236100                    LDQ     I,,AUTO
         2 000063   000013 402007                    MPY     11,DL
         2 000064   000000 101406                    MRL     fill='000'O
         2 000065   000030 000001 xsym               ADSC9   MCA_CFG+24,Q             cn=0,n=1
         2 000066   000000 000004 xsym               ADSC9   RPM_CONSOLE              cn=0,n=4

     2035     1840    4                   DO J = MCA_CFG.LEVEL_1.PRI_CHN(I) TO MCA_CFG.LEVEL_1.PRI_CHN(I)

   1840  2 000067   200030 236100                    LDQ     I,,AUTO
         2 000070   000013 402007                    MPY     11,DL
         2 000071   000100 101406                    MRL     fill='000'O
         2 000072   000030 000001 xsym               ADSC9   MCA_CFG+24,Q             cn=0,n=1
         2 000073   200031 000004                    ADSC9   J,,AUTO                  cn=0,n=4
         2 000074   000131 710000 2                  TRA     s:1845+1

     2036     1841    4                     + MCA_CFG.LEVEL_1.LOG_CHNS(I) - 1;
     2037     1842    4                     CHN_CFG(IMX_NO * 128 + J) = '1'B;

   1842  2 000075   200003 470500                    LDP0    @IMX_NO,,AUTO
         2 000076   000000 236100                    LDQ     0,,PR0
         2 000077   000007 736000                    QLS     7
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:497  
         2 000100   200031 036100                    ADLQ    J,,AUTO
         2 000101   000103 605000 2                  TPL     s:1842+6
         2 000102   000044 036003                    ADLQ    36,DU
         2 000103   003006 060400                    CSL     bolr='003'O
         2 000104   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         2 000105   000000 000001 xsym               BDSC    CHN_CFG,Q                by=0,bit=0,n=1

     2038     1843    4                     IF MCA_FW_LOAD(MCA_CFG.LEVEL_1.HARDWARE_ID(I)) THEN

   1843  2 000106   200030 236100                    LDQ     I,,AUTO
         2 000107   000013 402007                    MPY     11,DL
         2 000110   000100 101406                    MRL     fill='000'O
         2 000111   000027 400001 xsym               ADSC9   MCA_CFG+23,Q             cn=2,n=1
         2 000112   200044 000004                    ADSC9   @HDR_CMD+1,,AUTO         cn=0,n=4
         2 000113   200044 236100                    LDQ     @HDR_CMD+1,,AUTO
         2 000114   000000 066406                    CMPB    filb='0'B
         2 000115   000026 000001 1                  BDSC    MCA_FW_LOAD,Q            by=0,bit=0,n=1
         2 000116   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 000117   000130 600000 2                  TZE     s:1845

     2039     1844    4                       FW_LOAD( IMX_NO * 128 + J) = '0'B;

   1844  2 000120   000000 236100                    LDQ     0,,PR0
         2 000121   000007 736000                    QLS     7
         2 000122   200031 036100                    ADLQ    J,,AUTO
         2 000123   000125 605000 2                  TPL     s:1844+5
         2 000124   000044 036003                    ADLQ    36,DU
         2 000125   003006 060400                    CSL     bolr='003'O
         2 000126   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 000127   000000 000001 xsym               BDSC    FW_LOAD,Q                by=0,bit=0,n=1

     2040     1845    4                   END;

   1845  2 000130   200031 054100                    AOS     J,,AUTO
         2 000131   200030 236100                    LDQ     I,,AUTO
         2 000132   000013 402007                    MPY     11,DL
         2 000133   000100 101406                    MRL     fill='000'O
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:498  
         2 000134   000030 200001 xsym               ADSC9   MCA_CFG+24,Q             cn=1,n=1
         2 000135   200044 000004                    ADSC9   @HDR_CMD+1,,AUTO         cn=0,n=4
         2 000136   000100 101406                    MRL     fill='000'O
         2 000137   000030 000001 xsym               ADSC9   MCA_CFG+24,Q             cn=0,n=1
         2 000140   200045 000004                    ADSC9   @HDR_CMD+2,,AUTO         cn=0,n=4
         2 000141   200045 236100                    LDQ     @HDR_CMD+2,,AUTO
         2 000142   200044 036100                    ADLQ    @HDR_CMD+1,,AUTO
         2 000143   000075 604000 2                  TMI     s:1842
         2 000144   200031 116100                    CMPQ    J,,AUTO
         2 000145   000075 605400 2                  TPNZ    s:1842

     2041     1846    3                 END;

     2042     1847    2           END;

   1847  2 000146   200030 054100                    AOS     I,,AUTO
         2 000147   200030 235100                    LDA     I,,AUTO
         2 000150   000017 115007                    CMPA    15,DL
         2 000151   000025 604400 2                  TMOZ    s:1835

     2043     1848    1           HW_RPM_CFG_DONE(IMX_NO) = '1'B;

   1848  2 000152   200003 470500                    LDP0    @IMX_NO,,AUTO
         2 000153   000000 235100                    LDA     0,,PR0
         2 000154   003005 060400                    CSL     bolr='003'O
         2 000155   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         2 000156   000055 000001 0                  BDSC    HW_RPM_CFG_DONE,A        by=0,bit=0,n=1

     2044     1849    1           RETURN;

   1849  2 000157   000000 702200 xent               TSX2  ! X66_ARET

     2045     1850    1   DO_RPM_TIME:ENTRY(IMX_NO) ALTRET;

   1850  2 000160   000000 700200 xent  DO_RPM_TIME  TSX0  ! X66_AUTO_1
         2 000161   000052 000001                    ZERO    42,1

PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:499  
     2046     1851
     2047     1852    1           CALL CHANNEL_3_CMD(IMX_NO,1);

   1852  2 000162   000001 236000 3                  LDQ     1
         2 000163   200034 756100                    STQ     @IMX#+1,,AUTO
         2 000164   200003 236100                    LDQ     @IMX_NO,,AUTO
         2 000165   200033 756100                    STQ     J+2,,AUTO
         2 000166   000240 701000 2                  TSX1    CHANNEL_3_CMD
         2 000167   000000 011000                    NOP     0

     2048     1853    1           CALL SET_TIME_FROM_SP(OR_TIME);

   1853  2 000170   200026 630500                    EPPR0   OR_TIME,,AUTO
         2 000171   200044 450500                    STP0    @HDR_CMD+1,,AUTO
         2 000172   200044 630500                    EPPR0   @HDR_CMD+1,,AUTO
         2 000173   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000174   000000 701000 xent               TSX1    SET_TIME_FROM_SP
         2 000175   000000 011000                    NOP     0

     2049     1854    1           RETURN;

   1854  2 000176   000000 702200 xent               TSX2  ! X66_ARET

     2050     1855    1   DO_SCU_STATE: ENTRY(IMX_NO) ALTRET;

   1855  2 000177   000000 700200 xent  DO_SCU_STATE TSX0  ! X66_AUTO_1
         2 000200   000052 000001                    ZERO    42,1

     2051     1856    1           DO_CMD = %MCA_CMD_STATE_SCU0# + MOD(IMX_NO,2);

   1856  2 000201   200003 470500                    LDP0    @IMX_NO,,AUTO
         2 000202   000000 236100                    LDQ     0,,PR0
         2 000203   000001 376007                    ANQ     1,DL
         2 000204   000006 036007                    ADLQ    6,DL
         2 000205   200015 756100                    STQ     DO_CMD,,AUTO

     2052     1857    1           CALL CHANNEL_3_CMD(MOD(IMX_NO,2),DO_CMD);
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:500  

   1857  2 000206   000000 236100                    LDQ     0,,PR0
         2 000207   000001 376007                    ANQ     1,DL
         2 000210   200050 756100                    STQ     @HDR_CMD+5,,AUTO
         2 000211   200015 631500                    EPPR1   DO_CMD,,AUTO
         2 000212   200034 451500                    STP1    @IMX#+1,,AUTO
         2 000213   200050 633500                    EPPR3   @HDR_CMD+5,,AUTO
         2 000214   200033 453500                    STP3    J+2,,AUTO
         2 000215   000240 701000 2                  TSX1    CHANNEL_3_CMD
         2 000216   000000 011000                    NOP     0

     2053     1858    1           RETURN;

   1858  2 000217   000000 702200 xent               TSX2  ! X66_ARET

     2054     1859    1   DO_CPU_SWITCH: ENTRY(IMX_NO) ALTRET;

   1859  2 000220   000000 700200 xent  DO_CPU_SWIT* TSX0  ! X66_AUTO_1
         2 000221   000052 000001                    ZERO    42,1

     2055     1860    1           DO_CMD = %MCA_CMD_SWITCH_CPU0# + IMX_NO;

   1860  2 000222   200003 470500                    LDP0    @IMX_NO,,AUTO
         2 000223   000000 235100                    LDA     0,,PR0
         2 000224   000002 035007                    ADLA    2,DL
         2 000225   200015 755100                    STA     DO_CMD,,AUTO

     2056     1861    1           CALL CHANNEL_3_CMD(MOD(IMX_NO,2),DO_CMD);

   1861  2 000226   000000 236100                    LDQ     0,,PR0
         2 000227   000001 376007                    ANQ     1,DL
         2 000230   200051 756100                    STQ     @HDR_CMD+6,,AUTO
         2 000231   200015 631500                    EPPR1   DO_CMD,,AUTO
         2 000232   200034 451500                    STP1    @IMX#+1,,AUTO
         2 000233   200051 633500                    EPPR3   @HDR_CMD+6,,AUTO
         2 000234   200033 453500                    STP3    J+2,,AUTO
         2 000235   000240 701000 2                  TSX1    CHANNEL_3_CMD
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:501  
         2 000236   000000 011000                    NOP     0

     2057     1862    1           RETURN;

   1862  2 000237   000000 702200 xent               TSX2  ! X66_ARET

     2058     1863
     2059     1864        %EJECT;
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:502  
     2060     1865    1   CHANNEL_3_CMD:PROC(IMX#,CMD_NO);

   1865  2 000240   200032 741300       CHANNEL_3_C* STX1  ! J+1,,AUTO

     2061     1866    2   DCL IMX# UBIN WORD;
     2062     1867    2   DCL CMD_NO UBIN WORD;
     2063     1868    2           MESSAGE$ = ADDR(CFG_STATUS);

   1868  2 000241   000002 236000 3                  LDQ     2
         2 000242   200007 756100                    STQ     MESSAGE$,,AUTO

     2064     1869    2           CALL BINCHAR(SUBSTR(TEXTM.TXT,6,1),CMD_NO);

   1869  2 000243   200007 470500                    LDP0    MESSAGE$,,AUTO
         2 000244   000000 720100                    LXL0    0,,PR0
         2 000245   200034 471500                    LDP1    @CMD_NO,,AUTO
         2 000246   100000 235100                    LDA     0,,PR1
         2 000247   000044 773000                    LRL     36
         2 000250   200044 757100                    STAQ    @HDR_CMD+1,,AUTO
         2 000251   000100 301500                    BTD
         2 000252   200044 000010                    NDSC9   @HDR_CMD+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         2 000253   000002 430001                    NDSC9   2,,PR0                   cn=2,s=nosgn,sf=0,n=1

     2065     1870    2           TEMP_DCWS$ = ADDR(CH3_CONS_DCWS);

   1870  2 000254   000003 236000 3                  LDQ     3
         2 000255   200012 756100                    STQ     TEMP_DCWS$,,AUTO

     2066     1871    2           MBX$ = ADDR(CHN3_MBX);

   1871  2 000256   000004 236000 3                  LDQ     4
         2 000257   200010 756100                    STQ     MBX$,,AUTO

     2067     1872    2           CHN3_MBX = PATT_MBX;

   1872  2 000260   000000 100400                    MLR     fill='000'O
         2 000261   000000 000140 xsym               ADSC9   PATT_MBX                 cn=0,n=96
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:503  
         2 000262   000000 000140 xsym               ADSC9   CHN3_MBX                 cn=0,n=96

     2068     1873    2           CHN3_MBX.LPW.DCW_ADDR = TEMP_DCWS_PTR.WOFFS;

   1873  2 000263   200012 220100                    LDX0    TEMP_DCWS$,,AUTO
         2 000264   000007 740000 xsym               STX0    CHN3_MBX+7

     2069     1874    2   START_OVER:
     2070     1875    2           CALL BUILD_CH3_DCWS(%FCNRSS,%FCNRDC3,9);

   1875  2 000265   000001 236000 xsym  START_OVER   LDQ     B_VECTNIL+1
         2 000266   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000267   200042 757100                    STAQ    @HDR_DEFINER+1,,AUTO
         2 000270   000006 237000 3                  LDAQ    6
         2 000271   200040 757100                    STAQ    @IM#+1,,AUTO
         2 000272   000010 236000 3                  LDQ     8
         2 000273   200037 756100                    STQ     @CMD_NO+3,,AUTO
         2 000274   001034 701000 2                  TSX1    BUILD_CH3_DCWS
         2 000275   000000 011000                    NOP     0

     2071     1876    2           TEMP_DCWS.DCW0.CONT = '0'B;

   1876  2 000276   200012 470500                    LDP0    TEMP_DCWS$,,AUTO
         2 000277   000011 236000 3                  LDQ     9
         2 000300   000000 356100                    ANSQ    0,,PR0

     2072     1877    2           CALL READ_CHN3(IMX#);

   1877  2 000301   200033 236100                    LDQ     @IMX#,,AUTO
         2 000302   200037 756100                    STQ     @CMD_NO+3,,AUTO
         2 000303   001140 701000 2                  TSX1    READ_CHN3
         2 000304   000000 011000                    NOP     0

     2073     1878    3           IF CHN3_MBX.STATUS.W8_INFO.TERM ~= '4002'O THEN DO;

   1878  2 000305   000010 236000 xsym               LDQ     CHN3_MBX+8
         2 000306   777700 376003                    ANQ     -64,DU
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:504  
         2 000307   400200 116003                    CMPQ    -130944,DU
         2 000310   000340 600000 2                  TZE     s:1888

     2074     1879    3                 TRYS = TRYS + 1;

   1879  2 000311   200013 054100                    AOS     TRYS,,AUTO

     2075     1880    4                 IF TRYS > 5 THEN DO;

   1880  2 000312   200013 235100                    LDA     TRYS,,AUTO
         2 000313   000005 115007                    CMPA    5,DL
         2 000314   000337 604400 2                  TMOZ    s:1886

     2076     1881    4                       MESSAGE$ = ADDR(CFG_RESET_ERR);

   1881  2 000315   000012 236000 3                  LDQ     10
         2 000316   200007 756100                    STQ     MESSAGE$,,AUTO

     2077     1882    4                       CALL BINCHAR(SUBSTR(TEXTM.TXT,6,1),CMD_NO);

   1882  2 000317   200007 470500                    LDP0    MESSAGE$,,AUTO
         2 000320   000000 720100                    LXL0    0,,PR0
         2 000321   200034 471500                    LDP1    @CMD_NO,,AUTO
         2 000322   100000 235100                    LDA     0,,PR1
         2 000323   000044 773000                    LRL     36
         2 000324   200044 757100                    STAQ    @HDR_CMD+1,,AUTO
         2 000325   000100 301500                    BTD
         2 000326   200044 000010                    NDSC9   @HDR_CMD+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         2 000327   000002 430001                    NDSC9   2,,PR0                   cn=2,s=nosgn,sf=0,n=1

     2078     1883    4                       CALL TYPEC(TEXTM);

   1883  2 000330   200007 630500                    EPPR0   MESSAGE$,,AUTO
         2 000331   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000332   000000 701000 xent               TSX1    TYPEC
         2 000333   000000 011000                    NOP     0

PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:505  
     2079     1884    4                       CALL HANG;

   1884  2 000334   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000335   000000 701000 xent               TSX1    HANG
         2 000336   000000 011000                    NOP     0

     2080     1885    4                     END;

     2081     1886    3                 GOTO START_OVER;

   1886  2 000337   000265 710000 2                  TRA     START_OVER

     2082     1887    3               END;
     2083     1888    3           DO CASE (CMD_NO);

   1888  2 000340   200034 470500                    LDP0    @CMD_NO,,AUTO
         2 000341   000000 235100                    LDA     0,,PR0
         2 000342   000010 115007                    CMPA    8,DL
         2 000343   000345 602005 2                  TNC     s:1888+5,AL
         2 000344   000500 710000 2                  TRA     DO_READ
         2 000345   000355 710000 2                  TRA     s:1890
         2 000346   000366 710000 2                  TRA     s:1892
         2 000347   000377 710000 2                  TRA     s:1894
         2 000350   000427 710000 2                  TRA     s:1902
         2 000351   000377 710000 2                  TRA     s:1894
         2 000352   000427 710000 2                  TRA     s:1902
         2 000353   000457 710000 2                  TRA     s:1910
         2 000354   000470 710000 2                  TRA     s:1912

     2084     1889    3             CASE (%MCA_CMD_CONFIG#);

     2085     1890    3               CALL BUILD_CH3_DCWS(%FCNWTC3,%FCNRDC3,7,LENGTHC(READ_CONFIG_INIT),
              1890                        READ_CONFIG_INIT);

   1890  2 000355   000014 237000 3                  LDAQ    12
         2 000356   200042 757100                    STAQ    @HDR_DEFINER+1,,AUTO
         2 000357   000016 237000 3                  LDAQ    14
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:506  
         2 000360   200040 757100                    STAQ    @IM#+1,,AUTO
         2 000361   000014 236000 3                  LDQ     12
         2 000362   200037 756100                    STQ     @CMD_NO+3,,AUTO
         2 000363   001034 701000 2                  TSX1    BUILD_CH3_DCWS
         2 000364   000000 011000                    NOP     0
         2 000365   000500 710000 2                  TRA     DO_READ

     2086     1891    3             CASE (%MCA_CMD_CCINIT#);

     2087     1892    3               CALL BUILD_CH3_DCWS(%FCNWTC3,%FCNRDC3,7,LENGTHC(SP_CCINIT_INIT),
              1892                        SP_CCINIT_INIT);

   1892  2 000366   000022 237000 3                  LDAQ    18
         2 000367   200042 757100                    STAQ    @HDR_DEFINER+1,,AUTO
         2 000370   000016 237000 3                  LDAQ    14
         2 000371   200040 757100                    STAQ    @IM#+1,,AUTO
         2 000372   000014 236000 3                  LDQ     12
         2 000373   200037 756100                    STQ     @CMD_NO+3,,AUTO
         2 000374   001034 701000 2                  TSX1    BUILD_CH3_DCWS
         2 000375   000000 011000                    NOP     0
         2 000376   000500 710000 2                  TRA     DO_READ

     2088     1893    3             CASE(%MCA_CMD_SWITCH_CPU0#,%MCA_CMD_SWITCH_CPU2#);

     2089     1894    3               TEMP$STRING = SP_SWITCH;

   1894  2 000377   040100 100400                    MLR     fill='040'O
         2 000400   000017 000033 1                  ADSC9   SP_SWITCH                cn=0,n=27
         2 000401   200016 000036                    ADSC9   TEMP$STRING,,AUTO        cn=0,n=30

     2090     1895    3               IF CMD_NO = %MCA_CMD_SWITCH_CPU0# THEN

   1895  2 000402   000000 235100                    LDA     0,,PR0
         2 000403   000002 115007                    CMPA    2,DL
         2 000404   000410 601000 2                  TNZ     s:1898

     2091     1896    3                 SUBSTR(TEMP$STRING,14,1) = '0';
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:507  

   1896  2 000405   060000 236007                    LDQ     24576,DL
         2 000406   200021 552110                    STBQ    TEMP$STRING+3,'10'O,AUTO
         2 000407   000412 710000 2                  TRA     s:1899

     2092     1897    3                 ELSE
     2093     1898    3                 SUBSTR(TEMP$STRING,14,1) = '2';

   1898  2 000410   062000 236007                    LDQ     25600,DL
         2 000411   200021 552110                    STBQ    TEMP$STRING+3,'10'O,AUTO

     2094     1899    3               SUBSTR(TEMP$STRING,21,1) = 'B';

   1899  2 000412   000102 236003                    LDQ     66,DU
         2 000413   200023 552120                    STBQ    TEMP$STRING+5,'20'O,AUTO

     2095     1900    3              CALL BUILD_CH3_DCWS(%FCNWTC3,%FCNRDC3,7,LENGTHC(SP_SWITCH),TEMP$STRING);

   1900  2 000414   200016 631500                    EPPR1   TEMP$STRING,,AUTO
         2 000415   200043 451500                    STP1    @HDR_CMD_LEN+1,,AUTO
         2 000416   000024 236000 3                  LDQ     20
         2 000417   200042 756100                    STQ     @HDR_DEFINER+1,,AUTO
         2 000420   000016 237000 3                  LDAQ    14
         2 000421   200040 757100                    STAQ    @IM#+1,,AUTO
         2 000422   000014 236000 3                  LDQ     12
         2 000423   200037 756100                    STQ     @CMD_NO+3,,AUTO
         2 000424   001034 701000 2                  TSX1    BUILD_CH3_DCWS
         2 000425   000000 011000                    NOP     0
         2 000426   000500 710000 2                  TRA     DO_READ

     2096     1901    3             CASE(%MCA_CMD_SWITCH_CPU1#,%MCA_CMD_SWITCH_CPU3#);

     2097     1902    3               TEMP$STRING = SP_SWITCH;

   1902  2 000427   040100 100400                    MLR     fill='040'O
         2 000430   000017 000033 1                  ADSC9   SP_SWITCH                cn=0,n=27
         2 000431   200016 000036                    ADSC9   TEMP$STRING,,AUTO        cn=0,n=30
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:508  

     2098     1903    3               IF CMD_NO = %MCA_CMD_SWITCH_CPU1# THEN

   1903  2 000432   000000 235100                    LDA     0,,PR0
         2 000433   000003 115007                    CMPA    3,DL
         2 000434   000440 601000 2                  TNZ     s:1906

     2099     1904    3                 SUBSTR(TEMP$STRING,14,1) = '0';

   1904  2 000435   060000 236007                    LDQ     24576,DL
         2 000436   200021 552110                    STBQ    TEMP$STRING+3,'10'O,AUTO
         2 000437   000442 710000 2                  TRA     s:1907

     2100     1905    3                 ELSE
     2101     1906    3                 SUBSTR(TEMP$STRING,14,1) = '2';

   1906  2 000440   062000 236007                    LDQ     25600,DL
         2 000441   200021 552110                    STBQ    TEMP$STRING+3,'10'O,AUTO

     2102     1907    3               SUBSTR(TEMP$STRING,21,1) = 'A';

   1907  2 000442   000101 236003                    LDQ     65,DU
         2 000443   200023 552120                    STBQ    TEMP$STRING+5,'20'O,AUTO

     2103     1908    3              CALL BUILD_CH3_DCWS(%FCNWTC3,%FCNRDC3,7,LENGTHC(SP_SWITCH),TEMP$STRING);

   1908  2 000444   200016 631500                    EPPR1   TEMP$STRING,,AUTO
         2 000445   200043 451500                    STP1    @HDR_CMD_LEN+1,,AUTO
         2 000446   000024 236000 3                  LDQ     20
         2 000447   200042 756100                    STQ     @HDR_DEFINER+1,,AUTO
         2 000450   000016 237000 3                  LDAQ    14
         2 000451   200040 757100                    STAQ    @IM#+1,,AUTO
         2 000452   000014 236000 3                  LDQ     12
         2 000453   200037 756100                    STQ     @CMD_NO+3,,AUTO
         2 000454   001034 701000 2                  TSX1    BUILD_CH3_DCWS
         2 000455   000000 011000                    NOP     0
         2 000456   000500 710000 2                  TRA     DO_READ
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:509  

     2104     1909    3             CASE (%MCA_CMD_STATE_SCU0#);

     2105     1910    3               CALL BUILD_CH3_DCWS(%FCNWTC3,%FCNRDC3,7,LENGTHC(SP_SCU0_STATE),
              1910                        SP_SCU0_STATE);

   1910  2 000457   000026 237000 3                  LDAQ    22
         2 000460   200042 757100                    STAQ    @HDR_DEFINER+1,,AUTO
         2 000461   000016 237000 3                  LDAQ    14
         2 000462   200040 757100                    STAQ    @IM#+1,,AUTO
         2 000463   000014 236000 3                  LDQ     12
         2 000464   200037 756100                    STQ     @CMD_NO+3,,AUTO
         2 000465   001034 701000 2                  TSX1    BUILD_CH3_DCWS
         2 000466   000000 011000                    NOP     0
         2 000467   000500 710000 2                  TRA     DO_READ

     2106     1911    3             CASE (%MCA_CMD_STATE_SCU1#);

     2107     1912    3               CALL BUILD_CH3_DCWS(%FCNWTC3,%FCNRDC3,7,LENGTHC(SP_SCU1_STATE),
              1912                        SP_SCU1_STATE);

   1912  2 000470   000030 237000 3                  LDAQ    24
         2 000471   200042 757100                    STAQ    @HDR_DEFINER+1,,AUTO
         2 000472   000016 237000 3                  LDAQ    14
         2 000473   200040 757100                    STAQ    @IM#+1,,AUTO
         2 000474   000014 236000 3                  LDQ     12
         2 000475   200037 756100                    STQ     @CMD_NO+3,,AUTO
         2 000476   001034 701000 2                  TSX1    BUILD_CH3_DCWS
         2 000477   000000 011000                    NOP     0

     2108     1913    3           END;

     2109     1914    2   DO_READ:
     2110     1915    2           CALL READ_CHN3(IMX#);

   1915  2 000500   200033 236100       DO_READ      LDQ     @IMX#,,AUTO
         2 000501   200037 756100                    STQ     @CMD_NO+3,,AUTO
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:510  
         2 000502   001140 701000 2                  TSX1    READ_CHN3
         2 000503   000000 011000                    NOP     0

     2111     1916    3           DO SELECT(CHN3_MBX.STATUS.W8_INFO.TERM & '3777'O);

   1916  2 000504   000010 236000 xsym               LDQ     CHN3_MBX+8
         2 000505   777700 376003                    ANQ     -64,DU
         2 000506   377700 376003                    ANQ     131008,DU
         2 000507   004000 116003                    CMPQ    2048,DU
         2 000510   000513 602000 2                  TNC     s:1916+7
         2 000511   000516 600000 2                  TZE     s:1918
         2 000512   001020 710000 2                  TRA     s:1980
         2 000513   000200 116003                    CMPQ    128,DU
         2 000514   001020 601000 2                  TNZ     s:1980
         2 000515   001016 710000 2                  TRA     s:1978

     2112     1917    3             SELECT('0040'O);

     2113     1918    3             IF MCA_HDR.DEFINER = %MCA_DEF_READ# THEN

   1918  2 000516   000056 470400 0                  LDP0    PO$
         2 000517   000000 236100                    LDQ     0,,PR0
         2 000520   000777 376003                    ANQ     511,DU
         2 000521   000001 116003                    CMPQ    1,DU
         2 000522   000526 601000 2                  TNZ     s:1921

     2114     1919    3               NEXT_DEFINER = %MCA_DEF_STATUS#;

   1919  2 000523   000011 235007                    LDA     9,DL
         2 000524   200014 755100                    STA     NEXT_DEFINER,,AUTO
         2 000525   000557 710000 2                  TRA     s:1929

     2115     1920    3               ELSE
     2116     1921    3               IF MCA_HDR.DEFINER = %MCA_DEF_READDATA# THEN

   1921  2 000526   000000 236100                    LDQ     0,,PR0
         2 000527   000777 376003                    ANQ     511,DU
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:511  
         2 000530   000002 116003                    CMPQ    2,DU
         2 000531   000535 601000 2                  TNZ     s:1924

     2117     1922    3                 NEXT_DEFINER = %MCA_DEF_DATA#;

   1922  2 000532   000007 235007                    LDA     7,DL
         2 000533   200014 755100                    STA     NEXT_DEFINER,,AUTO
         2 000534   000557 710000 2                  TRA     s:1929

     2118     1923    4                 ELSE DO;

     2119     1924    4                     MESSAGE$ = ADDR(CFG_ERR);

   1924  2 000535   000032 236000 3                  LDQ     26
         2 000536   200007 756100                    STQ     MESSAGE$,,AUTO

     2120     1925    4                     CALL BINCHAR(SUBSTR(TEXTM.TXT,6,1),CMD_NO);

   1925  2 000537   200007 471500                    LDP1    MESSAGE$,,AUTO
         2 000540   100000 720100                    LXL0    0,,PR1
         2 000541   200034 473500                    LDP3    @CMD_NO,,AUTO
         2 000542   300000 235100                    LDA     0,,PR3
         2 000543   000044 773000                    LRL     36
         2 000544   200044 757100                    STAQ    @HDR_CMD+1,,AUTO
         2 000545   000100 301500                    BTD
         2 000546   200044 000010                    NDSC9   @HDR_CMD+1,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         2 000547   100002 430001                    NDSC9   2,,PR1                   cn=2,s=nosgn,sf=0,n=1

     2121     1926    4                     CALL TYPEC(TEXTM);

   1926  2 000550   200007 630500                    EPPR0   MESSAGE$,,AUTO
         2 000551   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000552   000000 701000 xent               TSX1    TYPEC
         2 000553   000000 011000                    NOP     0

     2122     1927    4                     CALL HANG;

PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:512  
   1927  2 000554   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000555   000000 701000 xent               TSX1    HANG
         2 000556   000000 011000                    NOP     0

     2123     1928    4                   END;

     2124     1929    4             DO CASE (CMD_NO);

   1929  2 000557   200034 470500                    LDP0    @CMD_NO,,AUTO
         2 000560   000000 235100                    LDA     0,,PR0
         2 000561   000010 115007                    CMPA    8,DL
         2 000562   000564 602005 2                  TNC     s:1929+5,AL
         2 000563   000760 710000 2                  TRA     s:1972
         2 000564   000574 710000 2                  TRA     s:1931
         2 000565   000607 710000 2                  TRA     s:1935
         2 000566   000760 710000 2                  TRA     s:1972
         2 000567   000760 710000 2                  TRA     s:1972
         2 000570   000760 710000 2                  TRA     s:1972
         2 000571   000760 710000 2                  TRA     s:1972
         2 000572   000653 710000 2                  TRA     s:1942
         2 000573   000653 710000 2                  TRA     s:1942

     2125     1930    4               CASE(%MCA_CMD_CONFIG#);

     2126     1931    4                 ST$LEN = LENGTHC(MCA_CFG);

   1931  2 000574   003130 236007                    LDQ     1624,DL
         2 000575   200005 756100                    STQ     ST$LEN,,AUTO

     2127     1932    4                 ST$ = ADDR(MCA_CFG);

   1932  2 000576   000033 236000 3                  LDQ     27
         2 000577   200006 756100                    STQ     ST$,,AUTO

     2128     1933    4                 ST = PINCRC(PO$,32)->ST;

   1933  2 000600   000056 471400 0                  LDP1    PO$
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:513  
         2 000601   200005 720100                    LXL0    ST$LEN,,AUTO
         2 000602   200006 473500                    LDP3    ST$,,AUTO
         2 000603   040140 100540                    MLR     fill='040'O
         2 000604   100010 000010                    ADSC9   8,,PR1                   cn=0,n=*X0
         2 000605   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         2 000606   000760 710000 2                  TRA     s:1972

     2129     1934    4               CASE(%MCA_CMD_CCINIT#);

     2130     1935    4                 SP$ = PINCRC(PO$,LENGTHC(INIT_HDR));

   1935  2 000607   000056 236000 0                  LDQ     PO$
         2 000610   000010 036003                    ADLQ    8,DU
         2 000611   200011 756100                    STQ     SP$,,AUTO

     2131     1936    4                 OR_TIME = 0;

   1936  2 000612   200026 450100                    STZ     OR_TIME,,AUTO

     2132     1937    5                 DO I = 0 TO 7;

   1937  2 000613   200030 450100                    STZ     I,,AUTO

     2133     1938    5                   OR_TIME_STRUC.HEX_DIGIT(I) = SP_TIME.BITE.HEX_DIGIT(I);

   1938  2 000614   200030 236100                    LDQ     I,,AUTO
         2 000615   000011 402007                    MPY     9,DL
         2 000616   000000 116003                    CMPQ    0,DU
         2 000617   000621 605000 2                  TPL     s:1938+5
         2 000620   000044 036003                    ADLQ    36,DU
         2 000621   200030 235100                    LDA     I,,AUTO
         2 000622   000002 735000                    ALS     2
         2 000623   000625 605000 2                  TPL     s:1938+9
         2 000624   000044 035003                    ADLA    36,DU
         2 000625   200011 470500                    LDP0    SP$,,AUTO
         2 000626   003105 060506                    CSL     bolr='003'O
         2 000627   000000 050004                    BDSC    0,Q,PR0                  by=0,bit=5,n=4
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:514  
         2 000630   200026 040004                    BDSC    OR_TIME,A,AUTO           by=0,bit=4,n=4

     2134     1939    5                 END;

   1939  2 000631   200030 054100                    AOS     I,,AUTO
         2 000632   200030 235100                    LDA     I,,AUTO
         2 000633   000007 115007                    CMPA    7,DL
         2 000634   000614 604400 2                  TMOZ    s:1938

     2135     1940    4                 CALL XUD$UTS_ADJ_25TH (OR_TIME, 0, OR_TIME*%UTS_25TH_SEC#);

   1940  2 000635   200026 236100                    LDQ     OR_TIME,,AUTO
         2 000636   000031 402007                    MPY     25,DL
         2 000637   200044 756100                    STQ     @HDR_CMD+1,,AUTO
         2 000640   200044 631500                    EPPR1   @HDR_CMD+1,,AUTO
         2 000641   200047 451500                    STP1    @HDR_CMD+4,,AUTO
         2 000642   000000 236000 3                  LDQ     0
         2 000643   200046 756100                    STQ     @HDR_CMD+3,,AUTO
         2 000644   200026 633500                    EPPR3   OR_TIME,,AUTO
         2 000645   200045 453500                    STP3    @HDR_CMD+2,,AUTO
         2 000646   200045 630500                    EPPR0   @HDR_CMD+2,,AUTO
         2 000647   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000650   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         2 000651   000000 011000                    NOP     0
         2 000652   000760 710000 2                  TRA     s:1972

     2136     1941    4               CASE(%MCA_CMD_STATE_SCU0#,%MCA_CMD_STATE_SCU1#);

     2137     1942    4                 ST$ = PINCRC(PO$,32);

   1942  2 000653   000056 236000 0                  LDQ     PO$
         2 000654   000010 036003                    ADLQ    8,DU
         2 000655   200006 756100                    STQ     ST$,,AUTO

     2138     1943    4                 ST$LEN = MCA_HDR.SRCLEN;

   1943  2 000656   000056 471400 0                  LDP1    PO$
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:515  
         2 000657   100006 236100                    LDQ     6,,PR1
         2 000660   000022 732000                    QRS     18
         2 000661   200005 756100                    STQ     ST$LEN,,AUTO

     2139     1944    4                 CALL INDEX(I,'CONFIGURED',ST);

   1944  2 000662   200030 631500                    EPPR1   I,,AUTO
         2 000663   000027 633400 1                  EPPR3   MCA_FW_LOAD+1
         2 000664   000012 223003                    LDX3    10,DU
         2 000665   200006 470500                    LDP0    ST$,,AUTO
         2 000666   000000 620006                    EAX0    0,QL
         2 000667   000000 236003                    LDQ     0,DU
         2 000670   000000 701000 xent               TSX1    X66_INDEX
         2 000671   000000 011000                    NOP     0

     2140     1945    5                 IF (I < ST$LEN) THEN DO;

   1945  2 000672   200030 236100                    LDQ     I,,AUTO
         2 000673   000676 604000 2                  TMI     s:1946
         2 000674   200005 116100                    CMPQ    ST$LEN,,AUTO
         2 000675   000760 603000 2                  TRC     s:1972

     2141     1946    5                       CALL INDEX(I,'S',ST);

   1946  2 000676   200005 720100                    LXL0    ST$LEN,,AUTO
         2 000677   000000 124540                    SCM     mask='000'O
         2 000700   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         2 000701   000034 000001 3                  ADSC9   28                       cn=0,n=1
         2 000702   200030 000100                    ARG     I,,AUTO

     2142     1947    5                       IS_CFG_NAME = SUBSTR(ST,I,12);

   1947  2 000703   200030 235100                    LDA     I,,AUTO
         2 000704   040000 100505                    MLR     fill='040'O
         2 000705   000000 000011                    ADSC9   0,A,PR0                  cn=0,n=9
         2 000706   000000 000011 xsym               ADSC9   IS_CFG_NAME              cn=0,n=9

PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:516  
     2143     1948    5                       IF SUBSTR(IS_CFG_NAME,6,1) = '1' THEN

   1948  2 000707   000001 236000 xsym               LDQ     IS_CFG_NAME+1
         2 000710   777000 376007                    ANQ     -512,DL
         2 000711   061000 116007                    CMPQ    25088,DL
         2 000712   000716 601000 2                  TNZ     s:1951

     2144     1949    5                         IS_MEM_SIDE1 = '1'B;

   1949  2 000713   400000 236003                    LDQ     -131072,DU
         2 000714   000000 756000 xsym               STQ     IS_MEM_SIDE1
         2 000715   000717 710000 2                  TRA     s:1952

     2145     1950    5                         ELSE
     2146     1951    5                         IS_MEM_SIDE1 = '0'B;

   1951  2 000716   000000 450000 xsym               STZ     IS_MEM_SIDE1

     2147     1952    5                       IF SUBSTR(IS_CFG_NAME,1,1) = '1' THEN

   1952  2 000717   000000 236000 xsym               LDQ     IS_CFG_NAME
         2 000720   000777 376003                    ANQ     511,DU
         2 000721   000061 116003                    CMPQ    49,DU
         2 000722   000726 601000 2                  TNZ     s:1955

     2148     1953    5                         IS_CSP_SIDE1 = '1'B;

   1953  2 000723   400000 236003                    LDQ     -131072,DU
         2 000724   000000 756000 xsym               STQ     IS_CSP_SIDE1
         2 000725   000727 710000 2                  TRA     s:1956

     2149     1954    5                         ELSE
     2150     1955    5                         IS_CSP_SIDE1 = '0'B;

   1955  2 000726   000000 450000 xsym               STZ     IS_CSP_SIDE1

     2151     1956    5                       IF SUBSTR(IS_CFG_NAME,2,4) = 'SING' THEN
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:517  

   1956  2 000727   040000 106400                    CMPC    fill='040'O
         2 000730   000000 400004 xsym               ADSC9   IS_CFG_NAME              cn=2,n=4
         2 000731   000032 000004 1                  ADSC9   MCA_FW_LOAD+4            cn=0,n=4
         2 000732   000735 601000 2                  TNZ     s:1959

     2152     1957    5                         IS_CFG_TYPE = %IS_CFG_SINGLE_CAB#;

   1957  2 000733   000000 450000 xsym               STZ     IS_CFG_TYPE
         2 000734   000760 710000 2                  TRA     s:1972

     2153     1958    6                         ELSE DO;

     2154     1959    7                             IF SUBSTR(IS_CFG_NAME,6,1) = 'H' THEN DO;

   1959  2 000735   000001 236000 xsym               LDQ     IS_CFG_NAME+1
         2 000736   777000 376007                    ANQ     -512,DL
         2 000737   110000 116007                    CMPQ    36864,DL
         2 000740   000756 601000 2                  TNZ     s:1968

     2155     1960    7                                   IF SUBSTR(IS_CFG_NAME,7,1) = 'R' THEN

   1960  2 000741   000001 236000 xsym               LDQ     IS_CFG_NAME+1
         2 000742   000777 376007                    ANQ     511,DL
         2 000743   000122 116007                    CMPQ    82,DL
         2 000744   000750 601000 2                  TNZ     s:1963

     2156     1961    7                                     IS_CFG_TYPE = %IS_CFG_MULT_CAB_REL#;

   1961  2 000745   000002 236007                    LDQ     2,DL
         2 000746   000000 756000 xsym               STQ     IS_CFG_TYPE
         2 000747   000751 710000 2                  TRA     s:1964

     2157     1962    7                                     ELSE
     2158     1963    7                                     IS_CFG_TYPE = %IS_CFG_SINGLE_CAB#;

   1963  2 000750   000000 450000 xsym               STZ     IS_CFG_TYPE
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:518  

     2159     1964    7                                   IF IS_CSP_SIDE1 THEN

   1964  2 000751   000000 234000 xsym               SZN     IS_CSP_SIDE1
         2 000752   000760 605000 2                  TPL     s:1972

     2160     1965    7                                     IS_MEM_SIDE1 = '1'B;

   1965  2 000753   400000 236003                    LDQ     -131072,DU
         2 000754   000000 756000 xsym               STQ     IS_MEM_SIDE1

     2161     1966    7                                 END;

   1966  2 000755   000760 710000 2                  TRA     s:1972

     2162     1967    6                               ELSE
     2163     1968    6                               IS_CFG_TYPE = %IS_CFG_MULT_CAB#;

   1968  2 000756   000001 236007                    LDQ     1,DL
         2 000757   000000 756000 xsym               STQ     IS_CFG_TYPE

     2164     1969    6                           END;

     2165     1970    5                     END;

     2166     1971    4             END;

     2167     1972    3             IF CMD_NO >= %MCA_CMD_STATE_SCU0# AND NEXT_DEFINER= %MCA_DEF_DATA# THEN

   1972  2 000760   200034 470500                    LDP0    @CMD_NO,,AUTO
         2 000761   000000 235100                    LDA     0,,PR0
         2 000762   000006 115007                    CMPA    6,DL
         2 000763   001002 602000 2                  TNC     s:1975
         2 000764   200014 236100                    LDQ     NEXT_DEFINER,,AUTO
         2 000765   000007 116007                    CMPQ    7,DL
         2 000766   001002 601000 2                  TNZ     s:1975

PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:519  
     2168     1973    3               CALL BUILD_CH3_DCWS(%FCNWDC3,%FCNRDC3,NEXT_DEFINER,0,SP_SCU0_STATE);

   1973  2 000767   000036 237000 3                  LDAQ    30
         2 000770   200042 757100                    STAQ    @HDR_DEFINER+1,,AUTO
         2 000771   200014 631500                    EPPR1   NEXT_DEFINER,,AUTO
         2 000772   200041 451500                    STP1    @IDCW1+1,,AUTO
         2 000773   000006 236000 3                  LDQ     6
         2 000774   200040 756100                    STQ     @IM#+1,,AUTO
         2 000775   000022 236000 3                  LDQ     18
         2 000776   200037 756100                    STQ     @CMD_NO+3,,AUTO
         2 000777   001034 701000 2                  TSX1    BUILD_CH3_DCWS
         2 001000   000000 011000                    NOP     0
         2 001001   001015 710000 2                  TRA     s:1976

     2169     1974    3               ELSE
     2170     1975    3               CALL BUILD_CH3_DCWS(%FCNWDC3,%FCNRDC3,NEXT_DEFINER);

   1975  2 001002   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001003   000001 235000 xsym               LDA     B_VECTNIL+1
         2 001004   200042 757100                    STAQ    @HDR_DEFINER+1,,AUTO
         2 001005   200014 631500                    EPPR1   NEXT_DEFINER,,AUTO
         2 001006   200041 451500                    STP1    @IDCW1+1,,AUTO
         2 001007   000006 236000 3                  LDQ     6
         2 001010   200040 756100                    STQ     @IM#+1,,AUTO
         2 001011   000022 236000 3                  LDQ     18
         2 001012   200037 756100                    STQ     @CMD_NO+3,,AUTO
         2 001013   001034 701000 2                  TSX1    BUILD_CH3_DCWS
         2 001014   000000 011000                    NOP     0

     2171     1976    3             GOTO DO_READ;

   1976  2 001015   000500 710000 2                  TRA     DO_READ

     2172     1977    3             SELECT('0002'O);

     2173     1978    3             RETURN;

PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:520  
   1978  2 001016   200032 221300                    LDX1  ! J+1,,AUTO
         2 001017   000001 702211                    TSX2  ! 1,X1

     2174     1979    3             SELECT (ELSE);

     2175     1980    3           TRYS = TRYS + 1;

   1980  2 001020   200013 054100                    AOS     TRYS,,AUTO

     2176     1981    4           IF TRYS > 5 THEN DO;

   1981  2 001021   200013 235100                    LDA     TRYS,,AUTO
         2 001022   000005 115007                    CMPA    5,DL
         2 001023   001033 604400 2                  TMOZ    s:1985

     2177     1982    4                 CALL TYPEC(TEXTM);

   1982  2 001024   200007 630500                    EPPR0   MESSAGE$,,AUTO
         2 001025   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001026   000000 701000 xent               TSX1    TYPEC
         2 001027   000000 011000                    NOP     0

     2178     1983    4                 CALL HANG;

   1983  2 001030   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001031   000000 701000 xent               TSX1    HANG
         2 001032   000000 011000                    NOP     0

     2179     1984    4               END;

     2180     1985    3           GOTO START_OVER;

   1985  2 001033   000265 710000 2                  TRA     START_OVER

     2181     1986    3           END;

     2182     1987    2   END CHANNEL_3_CMD;
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:521  
     2183     1988        %EJECT;
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:522  
     2184     1989    1   BUILD_CH3_DCWS:PROC(IDCW0,IDCW1,HDR_DEFINER,HDR_CMD_LEN,HDR_CMD);

   1989  2 001034   200036 741300       BUILD_CH3_D* STX1  ! @CMD_NO+2,,AUTO

     2185     1990    2   DCL   IDCW0 SBIN WORD;
     2186     1991    2   DCL   IDCW1 SBIN WORD;
     2187     1992    2   DCL   HDR_DEFINER SBIN WORD;
     2188     1993    2   DCL   HDR_CMD_LEN SBIN WORD;
     2189     1994    2   DCL   HDR_CMD CHAR(HDR_CMD_LEN);
     2190     1995
     2191     1996    2           MCA_HDR = INIT_HDR;

   1996  2 001035   000056 470400 0                  LDP0    PO$
         2 001036   000100 100400                    MLR     fill='000'O
         2 001037   000000 000040 0                  ADSC9   INIT_HDR                 cn=0,n=32
         2 001040   000000 000040                    ADSC9   0,,PR0                   cn=0,n=32

     2192     1997    2           MCA_HDR.DEFINER = HDR_DEFINER;

   1997  2 001041   200041 471500                    LDP1    @HDR_DEFINER,,AUTO
         2 001042   100000 236100                    LDQ     0,,PR1
         2 001043   000022 736000                    QLS     18
         2 001044   000000 552120                    STBQ    0,'20'O,PR0

     2193     1998    2           TEMP_DCWS = '0'B;

   1998  2 001045   200012 473500                    LDP3    TEMP_DCWS$,,AUTO
         2 001046   000100 100400                    MLR     fill='000'O
         2 001047   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 001050   300000 000020                    ADSC9   0,,PR3                   cn=0,n=16

     2194     1999    2           TEMP_DCWS.DCW1$ = ADDR(POBUF);

   1999  2 001051   000035 236000 3                  LDQ     29
         2 001052   300001 756100                    STQ     1,,PR3

     2195     2000    2           TEMP_DCWS.DCW1.TALLY = 0;
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:523  

   2000  2 001053   000000 236003                    LDQ     0,DU
         2 001054   300001 752103                    STCQ    1,'03'O,PR3

     2196     2001    2           IF ADDR(HDR_CMD_LEN) = ADDR(NIL) THEN

   2001  2 001055   200042 236100                    LDQ     @HDR_CMD_LEN,,AUTO
         2 001056   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 001057   001063 601000 2                  TNZ     s:2004

     2197     2002    2             MCA_HDR.TBYTES = 0;

   2002  2 001060   000000 220003                    LDX0    0,DU
         2 001061   000007 440100                    SXL0    7,,PR0
         2 001062   001105 710000 2                  TRA     s:2009

     2198     2003    3             ELSE DO;

     2199     2004    3                 MCA_HDR.TBYTES = HDR_CMD_LEN + 1;

   2004  2 001063   200042 474500                    LDP4    @HDR_CMD_LEN,,AUTO
         2 001064   400000 720100                    LXL0    0,,PR4
         2 001065   000001 621010                    EAX1    1,X0
         2 001066   000007 441100                    SXL1    7,,PR0

     2200     2005    3                 TEMP_DCWS.DCW1.TALLY = (HDR_CMD_LEN + 4)/4;

   2005  2 001067   400000 236100                    LDQ     0,,PR4
         2 001070   000004 036007                    ADLQ    4,DL
         2 001071   000004 506007                    DIV     4,DL
         2 001072   300001 752103                    STCQ    1,'03'O,PR3

     2201     2006    3                 SUBSTR(POBUF,32,HDR_CMD_LEN) = HDR_CMD;

   2006  2 001073   400000 720100                    LXL0    0,,PR4
         2 001074   400000 721100                    LXL1    0,,PR4
         2 001075   200043 475500                    LDP5    @HDR_CMD,,AUTO
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:524  
         2 001076   040040 100540                    MLR     fill='040'O
         2 001077   500000 000011                    ADSC9   0,,PR5                   cn=0,n=*X1
         2 001100   000010 000010 xsym               ADSC9   POBUF+8                  cn=0,n=*X0

     2202     2007    3                 POBUF_BIT(HDR_CMD_LEN + 32) = '015'O;

   2007  2 001101   400000 235100                    LDA     0,,PR4
         2 001102   000005 100400                    MLR     fill='000'O
         2 001103   000040 000001 3                  ADSC9   32                       cn=0,n=1
         2 001104   000010 000001 xsym               ADSC9   POBUF+8,A                cn=0,n=1

     2203     2008    3               END;

     2204     2009    2           TEMP_DCWS.DCW0.DEV# = 0;

   2009  2 001105   000000 236003                    LDQ     0,DU
         2 001106   300000 752120                    STCQ    0,'20'O,PR3

     2205     2010    2           TEMP_DCWS.DCW0.TYPE = '7'O;

   2010  2 001107   700000 236007                    LDQ     -32768,DL
         2 001110   300000 256100                    ORSQ    0,,PR3

     2206     2011    2           TEMP_DCWS.DCW0.CONT = '1'B;

   2011  2 001111   020000 236007                    LDQ     8192,DL
         2 001112   300000 256100                    ORSQ    0,,PR3

     2207     2012    2           TEMP_DCWS.DCW0.OPCODE = IDCW0;

   2012  2 001113   200037 474500                    LDP4    @IDCW0,,AUTO
         2 001114   400000 236100                    LDQ     0,,PR4
         2 001115   000036 736000                    QLS     30
         2 001116   300000 752140                    STCQ    0,'40'O,PR3

     2208     2013    2           TEMP_DCWS.DCW1.TALLY = TEMP_DCWS.DCW1.TALLY + 8;

PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:525  
   2013  2 001117   300001 236100                    LDQ     1,,PR3
         2 001120   000010 036007                    ADLQ    8,DL
         2 001121   300001 752103                    STCQ    1,'03'O,PR3

     2209     2014    2           TEMP_DCWS.DCW2 = TEMP_DCWS.DCW0;

   2014  2 001122   300000 236100                    LDQ     0,,PR3
         2 001123   300002 756100                    STQ     2,,PR3

     2210     2015    2           TEMP_DCWS.DCW2.OPCODE = IDCW1;

   2015  2 001124   200040 475500                    LDP5    @IDCW1,,AUTO
         2 001125   500000 236100                    LDQ     0,,PR5
         2 001126   000036 736000                    QLS     30
         2 001127   300002 752140                    STCQ    2,'40'O,PR3

     2211     2016    2           TEMP_DCWS.DCW2.CONT = '0'B;

   2016  2 001130   000011 236000 3                  LDQ     9
         2 001131   300002 356100                    ANSQ    2,,PR3

     2212     2017    2           TEMP_DCWS.DCW3 = TEMP_DCWS.DCW1;

   2017  2 001132   300001 236100                    LDQ     1,,PR3
         2 001133   300003 756100                    STQ     3,,PR3

     2213     2018    2           TEMP_DCWS.DCW3.TALLY = 0;

   2018  2 001134   000000 236003                    LDQ     0,DU
         2 001135   300003 752103                    STCQ    3,'03'O,PR3

     2214     2019    2   END BUILD_CH3_DCWS;

   2019  2 001136   200036 221300                    LDX1  ! @CMD_NO+2,,AUTO
         2 001137   000001 702211                    TSX2  ! 1,X1

     2215     2020    1   READ_CHN3: PROC(IM#);
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:526  

   2020  2 001140   200036 741300       READ_CHN3    STX1  ! @CMD_NO+2,,AUTO

     2216     2021    2   DCL IM# UBIN WORD;
     2217     2022    2           CHN3_MBX.STATUS ='0'B;

   2022  2 001141   000000 100400                    MLR     fill='000'O
         2 001142   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 001143   000010 000040 xsym               ADSC9   CHN3_MBX+8               cn=0,n=32

     2218     2023    2           CHN3_MBX.CHN_LINK.SYNC = '0'B;

   2023  2 001144   000041 236000 3                  LDQ     33
         2 001145   000006 356000 xsym               ANSQ    CHN3_MBX+6

     2219     2024    2           LOG_CHN = IM# * 128 + 8 + 3;

   2024  2 001146   200037 470500                    LDP0    @IM#,,AUTO
         2 001147   000000 235100                    LDA     0,,PR0
         2 001150   000007 735000                    ALS     7
         2 001151   000013 035007                    ADLA    11,DL
         2 001152   200004 755100                    STA     LOG_CHN,,AUTO

     2220     2025    2           CALL START_IO_RPM(LOG_CHN,MBX$);

   2025  2 001153   200010 631500                    EPPR1   MBX$,,AUTO
         2 001154   200045 451500                    STP1    @HDR_CMD+2,,AUTO
         2 001155   200004 633500                    EPPR3   LOG_CHN,,AUTO
         2 001156   200044 453500                    STP3    @HDR_CMD+1,,AUTO
         2 001157   200044 630500                    EPPR0   @HDR_CMD+1,,AUTO
         2 001160   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001161   000000 701000 xent               TSX1    START_IO_RPM
         2 001162   000000 011000                    NOP     0

     2221     2026    3           DO UNTIL CHN3_MBX.STATUS.W8.TBIT = '1'B;

     2222     2027    3             I = 1;
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:527  

   2027  2 001163   000001 235007                    LDA     1,DL
         2 001164   200030 755100                    STA     I,,AUTO

     2223     2028    3           END;

   2028  2 001165   000010 234000 xsym               SZN     CHN3_MBX+8
         2 001166   001163 605000 2                  TPL     s:2027

     2224     2029    3           DO UNTIL CHN3_MBX.CHN_LINK.SYNC='1'B;

     2225     2030    3             I = 1;

   2030  2 001167   000001 235007                    LDA     1,DL
         2 001170   200030 755100                    STA     I,,AUTO

     2226     2031    3           END;

   2031  2 001171   000006 236000 xsym               LDQ     CHN3_MBX+6
         2 001172   000400 316007                    CANQ    256,DL
         2 001173   001167 600000 2                  TZE     s:2030

     2227     2032    2   END READ_CHN3;

   2032  2 001174   200036 221300                    LDX1  ! @CMD_NO+2,,AUTO
         2 001175   000001 702211                    TSX2  ! 1,X1
     2228     2033    1   END DO_RPM_CFG;

PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:528  
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   IS$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure DO_RPM_CFG.
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:529  

 **** Variables and constants ****

  ****  Section 000  Data  DO_RPM_CFG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    24-0-0/w STRC(495)   r     1 CFG_ERR                   10-0-0/w STRC(423)   r     1 CFG_RESET_ERR
    42-0-0/w STRC(387)   r     1 CFG_STATUS
    55-0-0/b BIT         r     1 HW_RPM_CFG_DONE(0:3)
     0-0-0/w STRC(288)   r     1 INIT_HDR                  56-0-0/w PTR         r     1 PO$

  ****  Section 001 RoData DO_RPM_CFG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    26-0-0/b BIT         r     1 MCA_FW_LOAD(0:15)
     0-0-0/c CHAR(11)    r     1 READ_CONFIG_INIT           3-0-0/c CHAR(13)    r     1 SP_CCINIT_INIT
     7-0-0/c CHAR(15)    r     1 SP_SCU0_STATE             13-0-0/c CHAR(15)    r     1 SP_SCU1_STATE
    17-0-0/c CHAR(27)    r     1 SP_SWITCH

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    34-0-0/w PTR         r     1 @CMD_NO                   43-0-0/w PTR         r     1 @HDR_CMD
    42-0-0/w PTR         r     1 @HDR_CMD_LEN              41-0-0/w PTR         r     1 @HDR_DEFINER
    37-0-0/w PTR         r     1 @IDCW0                    40-0-0/w PTR         r     1 @IDCW1
    37-0-0/w PTR         r     1 @IM#                      33-0-0/w PTR         r     1 @IMX#
     3-0-0/w PTR         r     1 @IMX_NO                   *0-0-0/w UBIN        r     1 CMD_NO
    15-0-0/w UBIN        r     1 DO_CMD                    *0-0-0/c ACHR        r     1 HDR_CMD
    *0-0-0/w SBIN        r     1 HDR_CMD_LEN               *0-0-0/w SBIN        r     1 HDR_DEFINER
    30-0-0/w SBIN        r     1 I                         *0-0-0/w SBIN        r     1 IDCW0
    *0-0-0/w SBIN        r     1 IDCW1                     *0-0-0/w UBIN        r     1 IM#
    *0-0-0/w UBIN        r     1 IMX#                      *0-0-0/w UBIN        r     1 IMX_NO
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:530  
    31-0-0/w SBIN        r     1 J                          4-0-0/w SBIN        r     1 LOG_CHN
    10-0-0/w PTR         r     1 MBX$                       7-0-0/w PTR         r     1 MESSAGE$
    14-0-0/w UBIN        r     1 NEXT_DEFINER              26-0-0/w UBIN        r     1 OR_TIME
    26-0-0/w STRC        r     1 OR_TIME_STRUC             11-0-0/w PTR         r     1 SP$
     6-0-0/w PTR         r     1 ST$                        5-0-0/w UBIN        r     1 ST$LEN
    16-0-0/c CHAR(30)    r     1 TEMP$STRING               12-0-0/w PTR         r     1 TEMP_DCWS$
    12-0-0/w STRC        r     1 TEMP_DCWS_PTR             13-0-0/w SBIN        r     1 TRYS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 CH3_CONS_DCWS(0:3)
     0-0-0/w STRC(864)   r     1 CHN3_MBX                   0-0-0/b BIT         r     1 CHN_CFG(0:511)
     0-0-0/b BIT         r     1 FW_LOAD(0:511)             0-0-0/b BIT         r     1 HW_RPM_CFG
     0-0-0/c CHAR(9)     r     1 IS_CFG_NAME                0-0-0/w UBIN        r     1 IS_CFG_TYPE
     0-0-0/b BIT         r     1 IS_CSP_SIDE1               0-0-0/b BIT         r     1 IS_MEM_SIDE1
     0-0-0/w STRC(14616) r     1 MCA_CFG                    0-0-0/w STRC(864)   r     1 PATT_MBX
     0-0-0/c CHAR(4096)  r     1 POBUF                      0-0-0/c BIT (9)     r     1 POBUF_BIT(0:4095)
     0-0-0/w SBIN        r     1 RPM_CONSOLE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)   r     1 MCA_HDR                    0-0-0/c STRC(72)    r     1 SP_TIME
     0-0-0/c ACHR        r     1 ST                         0-0-0/w STRC(144)   r     1 TEMP_DCWS
     0-0-0/w ASTR        r     1 TEXTM


   Procedure DO_RPM_CFG requires 638 words for executable code.
   Procedure DO_RPM_CFG requires 42 words of local(AUTO) storage.
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:531  

    No errors detected in file ISI$IOPROC.:E05TSI    .
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:532  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:533  
          MINI XREF LISTING

BUILD_CH3_DCWS
      1989**PROC     1875--CALL     1890--CALL     1892--CALL     1900--CALL     1908--CALL     1910--CALL
      1912--CALL     1973--CALL     1975--CALL
CFG_ERR
      1735**DCL      1924--ASSIGN
CFG_RESET_ERR
      1730**DCL      1881--ASSIGN
CFG_STATUS
      1740**DCL      1868--ASSIGN
CH3_CONS_DCWS
      1422**DCL      1870--ASSIGN
CHANNEL_3_CMD
      1865**PROC     1833--CALL     1852--CALL     1857--CALL     1861--CALL
CHN3_MBX
      1626**DCL      1871--ASSIGN   1872<<ASSIGN
CHN3_MBX.CHN_LINK.SYNC
      1639**DCL      2023<<ASSIGN   2029>>DOUNTIL
CHN3_MBX.LPW.DCW_ADDR
      1646**DCL      1873<<ASSIGN
CHN3_MBX.STATUS
      1655**DCL      2022<<ASSIGN
CHN3_MBX.STATUS.W8
      1656**DCL      1659--REDEF
CHN3_MBX.STATUS.W8.TBIT
      1657**DCL      2026>>DOUNTIL
CHN3_MBX.STATUS.W8_INFO.TERM
      1660**DCL      1878>>IF       1916>>DOSELCT
CHN_CFG
      1428**DCL      1842<<ASSIGN
CMD_NO IN PROCEDURE CHANNEL_3_CMD
      1867**DCL      1865--PROC     1869>>CALLBLT  1882>>CALLBLT  1888>>DOCASE   1895>>IF       1903>>IF
      1925>>CALLBLT  1929>>DOCASE   1972>>IF
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:534  
DO_CMD
      1781**DCL      1856<<ASSIGN   1857<>CALL     1860<<ASSIGN   1861<>CALL
DO_READ IN PROCEDURE CHANNEL_3_CMD
      1915**LABEL    1976--GOTO
FW_LOAD
      1423**DCL      1844<<ASSIGN
HANG
      1753**DCL-ENT  1884--CALL     1927--CALL     1983--CALL
HDR_CMD IN PROCEDURE BUILD_CH3_DCWS
      1994**DCL      1989--PROC     2006>>ASSIGN
HDR_CMD_LEN IN PROCEDURE BUILD_CH3_DCWS
      1993**DCL      1989--PROC     1994--IMP-SIZ  2001--IF       2004>>ASSIGN   2005>>ASSIGN   2006>>ASSIGN
      2006>>ASSIGN   2007>>ASSIGN
HDR_DEFINER IN PROCEDURE BUILD_CH3_DCWS
      1992**DCL      1989--PROC     1997>>ASSIGN
HW_RPM_CFG
      1429**DCL      1829>>IF
HW_RPM_CFG_DONE
      1756**DCL      1831>>IF       1848<<ASSIGN
I
      1824**DCL      1834<<DOINDEX  1835>>IF       1837>>IF       1838>>IF       1839>>ASSIGN   1840>>DOINDEX
      1840>>DOINDEX  1840>>DOINDEX  1843>>IF       1937<<DOINDEX  1938>>ASSIGN   1938>>ASSIGN   1944<<CALLBLT
      1945>>IF       1946<<CALLBLT  1947>>ASSIGN   2027<<ASSIGN   2030<<ASSIGN
IDCW0 IN PROCEDURE BUILD_CH3_DCWS
      1990**DCL      1989--PROC     2012>>ASSIGN
IDCW1 IN PROCEDURE BUILD_CH3_DCWS
      1991**DCL      1989--PROC     2015>>ASSIGN
IM# IN PROCEDURE READ_CHN3
      2021**DCL      2020--PROC     2024>>ASSIGN
IMX# IN PROCEDURE CHANNEL_3_CMD
      1866**DCL      1865--PROC     1877<>CALL     1915<>CALL
IMX_NO
      1421**DCL         6--PROC     1831>>IF       1833<>CALL     1842>>ASSIGN   1844>>ASSIGN   1848>>ASSIGN
      1850--ENTRY    1852<>CALL     1855--ENTRY    1856>>ASSIGN   1857>>CALL     1859--ENTRY    1860>>ASSIGN
      1861>>CALL
INIT_HDR
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:535  
      1557**DCL      1935--ASSIGN   1996>>ASSIGN
IS_CFG_NAME
      1424**DCL      1947<<ASSIGN   1948>>IF       1952>>IF       1956>>IF       1959>>IF       1960>>IF
IS_CFG_TYPE
      1427**DCL      1957<<ASSIGN   1961<<ASSIGN   1963<<ASSIGN   1968<<ASSIGN
IS_CSP_SIDE1
      1426**DCL      1953<<ASSIGN   1955<<ASSIGN   1964>>IF
IS_MEM_SIDE1
      1425**DCL      1949<<ASSIGN   1951<<ASSIGN   1965<<ASSIGN
J
      1825**DCL      1840<<DOINDEX  1842>>ASSIGN   1844>>ASSIGN
LOG_CHN
      1433**DCL      2024<<ASSIGN   2025<>CALL
MBX$
      1757**DCL      1871<<ASSIGN   2025<>CALL
MCA_CFG
      1447**DCL      1931--ASSIGN   1932--ASSIGN
MCA_CFG.LEVEL_1.CONSOLE_CNTL
      1509**DCL      1515--REDEF    1519--REDEF
MCA_CFG.LEVEL_1.CONSOLE_CNTL.MASTER
      1512**DCL      1838>>IF
MCA_CFG.LEVEL_1.CONSOLE_CNTL.REM_MAINT
      1511**DCL      1837>>IF
MCA_CFG.LEVEL_1.HARDWARE_ID
      1530**DCL      1843>>IF
MCA_CFG.LEVEL_1.LOG_CHNS
      1533**DCL      1840>>DOINDEX
MCA_CFG.LEVEL_1.PRI_CHN
      1532**DCL      1839>>ASSIGN   1840>>DOINDEX  1840>>DOINDEX
MCA_CFG.LEVEL_1.STATE
      1508**DCL      1835>>IF
MCA_FW_LOAD
      1826**DCL      1843>>IF
MCA_HDR
      1591**DCL      1996<<ASSIGN
MCA_HDR.DEFINER
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:536  
      1593**DCL      1918>>IF       1921>>IF       1997<<ASSIGN
MCA_HDR.SRCLEN
      1609**DCL      1943>>ASSIGN
MCA_HDR.TBYTES
      1612**DCL      2002<<ASSIGN   2004<<ASSIGN
MESSAGE$
      1747**DCL      1744--IMP-PTR  1868<<ASSIGN   1869>>CALLBLT  1869>>CALLBLT  1881<<ASSIGN   1882>>CALLBLT
      1882>>CALLBLT  1883>>CALL     1883>>CALL     1924<<ASSIGN   1925>>CALLBLT  1925>>CALLBLT  1926>>CALL
      1926>>CALL     1982>>CALL     1982>>CALL
NEXT_DEFINER
      1780**DCL      1919<<ASSIGN   1922<<ASSIGN   1972>>IF       1973<>CALL     1975<>CALL
OR_TIME
      1783**DCL      1784--REDEF    1853<>CALL     1936<<ASSIGN   1940<>CALL     1940>>CALL
OR_TIME_STRUC.HEX_DIGIT
      1786**DCL      1938<<ASSIGN
PATT_MBX
      1683**DCL      1872>>ASSIGN
PATT_MBX.STATUS.W8
      1713**DCL      1716--REDEF
PO$
      1758**DCL      1591--IMP-PTR  1918>>IF       1921>>IF       1933>>ASSIGN   1935>>ASSIGN   1942>>ASSIGN
      1943>>ASSIGN   1996>>ASSIGN   1997>>ASSIGN   2002>>ASSIGN   2004>>ASSIGN
POBUF
      1430**DCL      1431--REDEF    1758--DCLINIT  1999--ASSIGN   2006<<ASSIGN
POBUF_BIT
      1431**DCL      2007<<ASSIGN
READ_CHN3
      2020**PROC     1877--CALL     1915--CALL
READ_CONFIG_INIT
      1748**DCL      1890--CALL     1890<>CALL
RPM_CONSOLE
      1432**DCL      1836>>IF       1839<<ASSIGN
SET_TIME_FROM_SP
      1420**DCL-ENT  1853--CALL
SP$
      1759**DCL      1788--IMP-PTR  1935<<ASSIGN   1938>>ASSIGN
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:537  
SP_CCINIT_INIT
      1749**DCL      1892--CALL     1892<>CALL
SP_SCU0_STATE
      1750**DCL      1910--CALL     1910<>CALL     1973<>CALL
SP_SCU1_STATE
      1751**DCL      1912--CALL     1912<>CALL
SP_SWITCH
      1752**DCL      1894>>ASSIGN   1900--CALL     1902>>ASSIGN   1908--CALL
SP_TIME.BITE.HEX_DIGIT
      1791**DCL      1938>>ASSIGN
ST
      1436**DCL      1933<<ASSIGN   1933>>ASSIGN   1944>>CALLBLT  1946>>CALLBLT  1947>>ASSIGN
ST$
      1435**DCL      1436--IMP-PTR  1932<<ASSIGN   1933>>ASSIGN   1942<<ASSIGN   1944>>CALLBLT  1946>>CALLBLT
      1947>>ASSIGN
ST$LEN
      1434**DCL      1436--IMP-SIZ  1931<<ASSIGN   1933>>ASSIGN   1933>>ASSIGN   1943<<ASSIGN   1944>>CALLBLT
      1945>>IF       1946>>CALLBLT  1947>>ASSIGN
START_IO_RPM
      1754**DCL-ENT  2025--CALL
START_OVER IN PROCEDURE CHANNEL_3_CMD
      1875**LABEL    1886--GOTO     1985--GOTO
TEMP$STRING
      1782**DCL      1894<<ASSIGN   1896<<ASSIGN   1898<<ASSIGN   1899<<ASSIGN   1900<>CALL     1902<<ASSIGN
      1904<<ASSIGN   1906<<ASSIGN   1907<<ASSIGN   1908<>CALL
TEMP_DCWS
      1792**DCL      1998<<ASSIGN
TEMP_DCWS.DCW0
      1793**DCL      2014>>ASSIGN
TEMP_DCWS.DCW0.CONT
      1799**DCL      1876<<ASSIGN   2011<<ASSIGN
TEMP_DCWS.DCW0.DEV#
      1795**DCL      2009<<ASSIGN
TEMP_DCWS.DCW0.OPCODE
      1794**DCL      2012<<ASSIGN
TEMP_DCWS.DCW0.TYPE
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:538  
      1797**DCL      2010<<ASSIGN
TEMP_DCWS.DCW1
      1802**DCL      1808--REDEF    2017>>ASSIGN
TEMP_DCWS.DCW1.TALLY
      1807**DCL      2000<<ASSIGN   2005<<ASSIGN   2013<<ASSIGN   2013>>ASSIGN
TEMP_DCWS.DCW1$
      1808**DCL      1999<<ASSIGN
TEMP_DCWS.DCW2
      1809**DCL      2014<<ASSIGN
TEMP_DCWS.DCW2.CONT
      1815**DCL      2016<<ASSIGN
TEMP_DCWS.DCW2.OPCODE
      1810**DCL      2015<<ASSIGN
TEMP_DCWS.DCW3
      1818**DCL      2017<<ASSIGN
TEMP_DCWS.DCW3.TALLY
      1823**DCL      2018<<ASSIGN
TEMP_DCWS$
      1760**DCL      1772--REDEF    1792--IMP-PTR  1870<<ASSIGN   1876>>ASSIGN   1998>>ASSIGN   1999>>ASSIGN
      2000>>ASSIGN   2005>>ASSIGN   2009>>ASSIGN   2010>>ASSIGN   2011>>ASSIGN   2012>>ASSIGN   2013>>ASSIGN
      2013>>ASSIGN   2014>>ASSIGN   2014>>ASSIGN   2015>>ASSIGN   2016>>ASSIGN   2017>>ASSIGN   2017>>ASSIGN
      2018>>ASSIGN
TEMP_DCWS_PTR.WOFFS
      1773**DCL      1873>>ASSIGN
TEXTM
      1744**DCL      1883<>CALL     1926<>CALL     1982<>CALL
TEXTM.CNT
      1745**DCL      1746--IMP-SIZ  1869>>CALLBLT  1882>>CALLBLT  1883>>CALL     1925>>CALLBLT  1926>>CALL
      1982>>CALL
TEXTM.TXT
      1746**DCL      1869<<CALLBLT  1882<<CALLBLT  1925<<CALLBLT
TRYS
      1779**DCL      1879<<ASSIGN   1879>>ASSIGN   1880>>IF       1980<<ASSIGN   1980>>ASSIGN   1981>>IF
TYPEC
      1755**DCL-ENT  1883--CALL     1926--CALL     1982--CALL
XUD$UTS_ADJ_25TH
PL6.E3A0      #026=DO_RPM_CFG File=ISI$IOPROC.:E05TSI                            TUE 07/29/97 22:53 Page:539  
      1401**DCL-ENT  1940--CALL
