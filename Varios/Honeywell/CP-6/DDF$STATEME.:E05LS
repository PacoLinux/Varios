VERSION E05

PL6.E3A0      #001=DDF$FIND_IE File=DDF$STATEME.:E05TSI                          TUE 07/29/97 13:58 Page:1    
        1        1        /*M* DDF$STATEME IC TO EXECUTABLE STATEMENT/INTERNAL ENTRY ROUTINES */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        /*P* NAME: DDF$STATEME
        9        9             PURPOSE: THIS MODULE CONTAINS TWO ROUTINES, DDF$FIND_IE & DDF$STATEME.
       10       10                      GIVEN AN IC VALUE, THEY FIND A CORRESPONDING ENTRY IN THE
       11       11                      EXECUTABLE STATEMENTS TABLE, OR THE INTERNAL ENTRYS TABLE,
       12       12                      RESPECTIVELY. */
       13       13        %EJECT;
PL6.E3A0      #001=DDF$FIND_IE File=DDF$STATEME.:E05TSI                          TUE 07/29/97 13:58 Page:2    
       14       14        /*F* NAME: DDF$FIND_IE
       15       15             PURPOSE: TO FIND AN INTERNAL ENTRY AT THE SPECIFIED LOCATION.
       16       16             DESCRIPTION: SEARCHES THE INTERNAL ENTRY TABLE FOR THE SPECIFIED
       17       17             INTERNAL ENTRY IN THE QUALIFIED SCHEMA. RETURNS WITH A POINTER TO
       18       18             THE INTERNAL ENTRY IF FOUND, ELSE ALTRETURNS. */
       19       19        /*D* NAME: DDF$FIND_IE
       20       20             CALL: CALL DDF$FIND_IE( IC, ENTRY$ ) ALTRET( CANT FIND );
       21       21             INTERFACE: DDF$IE_#
       22       22                        DDF$N_IE
       23       23             ENVIRONMENT: DELTA.
       24       24             INPUT: IC - SPECIFIED ADDRESS.
       25       25             OUTPUT: ENTRY$ - POINTER TO INTERNAL ENTRY.
       26       26             SCRATCH: LOCAL AUTO ONLY.
       27       27             DESCRIPTION: SEARCHES THE INTERNAL ENTRY TABLE FOR THE SPECIFIED
       28       28             INTERNAL ENTRY IN THE QUALIFIED SCHEMA. RETURNS WITH A POINTER TO
       29       29             THE INTERNAL ENTRY IF FOUND, ELSE ALTRETURNS. */
       30       30                                                /**/
       31       31        DDF$FIND_IE: PROC( IC, ENTRY$ ) ALTRET;
       32       32                                                /**/
       33       33    1   DCL IC UBIN;
       34       34    1   DCL ENTRY$ PTR;
       35       35    1   DCL TIC UBIN;
       36       36    1   DCL IE$ PTR;
       37       37    1   DCL IEND UBIN;
       38       38    1   DCL IX UBIN;
       39       39        %INCLUDE B$OBJECT_C;
       40     3469        %B$LBNTRY1;
       41     3496        %B$INTNTRY (STCLASS="BASED(IE$)");
       42     3554        %INCLUDE XUH_MACRO_C;
       43     3638        %INCLUDE DD_SD_M;
       44     4974        %S_D;
       45     6292    1   DCL DDF$IE_# ENTRY(2) ALTRET;
       46     6293    1   DCL DDF$N_IE ENTRY(1) ALTRET;
       47     6294                                                /**/
       48     6295    1        IF ( NOT S_D.SCHEMA ) OR ( NOT S_D.QSCH.OK ) OR ( S_D.IE$ = ADDR( NIL ) )
       49     6296    1        THEN GOTO ARET;
       50     6297    1        CALL DDF$IE_#( 0, IE$ );
PL6.E3A0      #001=DDF$FIND_IE File=DDF$STATEME.:E05TSI                          TUE 07/29/97 13:58 Page:3    
       51     6298    1        IEND = S_D.LB1$ -> B$LBNTRY1.INTRYSIZ / SIZEW( B$INTNTRY );
       52     6299    1        TIC = IC;
       53     6300    2        DO IX = 1 TO IEND;
       54     6301    2             IF ( TIC = B$INTNTRY.ISADDR )
       55     6302    3             THEN DO;
       56     6303    3                  ENTRY$ = IE$;
       57     6304    3                  RETURN;
       58     6305    3                END;
       59     6306    2             CALL DDF$N_IE( IE$ ) ALTRET( ARET );
       60     6307    2           END;
       61     6308                                                /**/
       62     6309    1   ARET: ALTRETURN;
       63     6310                                                /**/
       64     6311    1   END DDF$FIND_IE;
       65     6312        %EOD;

PL6.E3A0      #001=DDF$FIND_IE File=DDF$STATEME.:E05TSI                          TUE 07/29/97 13:58 Page:4    
--  Include file information  --

   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDF$FIND_IE.

   Procedure DDF$FIND_IE requires 52 words for executable code.
   Procedure DDF$FIND_IE requires 12 words of local(AUTO) storage.

PL6.E3A0      #001=DDF$FIND_IE File=DDF$STATEME.:E05TSI                          TUE 07/29/97 13:58 Page:5    

 Object Unit name= DDF$FIND_IE                                File name= DDF$STATEME.:E05TOU
 UTS= JUL 29 '97 13:58:56.12 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    52     64  DDF$FIND_IE
    1  RoData even  none     1      1  DDF$FIND_IE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        2  DDF$FIND_IE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 DDF$IE_#
 yes     yes           Std       1 DDF$N_IE
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    S_D$                                  B_VECTNIL
PL6.E3A0      #001=DDF$FIND_IE File=DDF$STATEME.:E05TSI                          TUE 07/29/97 13:58 Page:6    

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=DDF$FIND_IE File=DDF$STATEME.:E05TSI                          TUE 07/29/97 13:58 Page:7    


        1        1        /*M* DDF$STATEME IC TO EXECUTABLE STATEMENT/INTERNAL ENTRY ROUTINES */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        /*P* NAME: DDF$STATEME
        9        9             PURPOSE: THIS MODULE CONTAINS TWO ROUTINES, DDF$FIND_IE & DDF$STATEME.
       10       10                      GIVEN AN IC VALUE, THEY FIND A CORRESPONDING ENTRY IN THE
       11       11                      EXECUTABLE STATEMENTS TABLE, OR THE INTERNAL ENTRYS TABLE,
       12       12                      RESPECTIVELY. */
       13       13        %EJECT;
PL6.E3A0      #001=DDF$FIND_IE File=DDF$STATEME.:E05TSI                          TUE 07/29/97 13:58 Page:8    
       14       14        /*F* NAME: DDF$FIND_IE
       15       15             PURPOSE: TO FIND AN INTERNAL ENTRY AT THE SPECIFIED LOCATION.
       16       16             DESCRIPTION: SEARCHES THE INTERNAL ENTRY TABLE FOR THE SPECIFIED
       17       17             INTERNAL ENTRY IN THE QUALIFIED SCHEMA. RETURNS WITH A POINTER TO
       18       18             THE INTERNAL ENTRY IF FOUND, ELSE ALTRETURNS. */
       19       19        /*D* NAME: DDF$FIND_IE
       20       20             CALL: CALL DDF$FIND_IE( IC, ENTRY$ ) ALTRET( CANT FIND );
       21       21             INTERFACE: DDF$IE_#
       22       22                        DDF$N_IE
       23       23             ENVIRONMENT: DELTA.
       24       24             INPUT: IC - SPECIFIED ADDRESS.
       25       25             OUTPUT: ENTRY$ - POINTER TO INTERNAL ENTRY.
       26       26             SCRATCH: LOCAL AUTO ONLY.
       27       27             DESCRIPTION: SEARCHES THE INTERNAL ENTRY TABLE FOR THE SPECIFIED
       28       28             INTERNAL ENTRY IN THE QUALIFIED SCHEMA. RETURNS WITH A POINTER TO
       29       29             THE INTERNAL ENTRY IF FOUND, ELSE ALTRETURNS. */
       30       30                                                /**/
       31       31        DDF$FIND_IE: PROC( IC, ENTRY$ ) ALTRET;

     31  0 000000   000000 700200 xent  DDF$FIND_IE  TSX0  ! X66_AUTO_2
         0 000001   000014 000002                    ZERO    12,2

       32       32                                                /**/
       33       33    1   DCL IC UBIN;
       34       34    1   DCL ENTRY$ PTR;
       35       35    1   DCL TIC UBIN;
       36       36    1   DCL IE$ PTR;
       37       37    1   DCL IEND UBIN;
       38       38    1   DCL IX UBIN;
       39       39        %INCLUDE B$OBJECT_C;
       40     3469        %B$LBNTRY1;
       41     3496        %B$INTNTRY (STCLASS="BASED(IE$)");
       42     3554        %INCLUDE XUH_MACRO_C;
       43     3638        %INCLUDE DD_SD_M;
       44     4974        %S_D;
       45     6292    1   DCL DDF$IE_# ENTRY(2) ALTRET;
       46     6293    1   DCL DDF$N_IE ENTRY(1) ALTRET;
PL6.E3A0      #001=DDF$FIND_IE File=DDF$STATEME.:E05TSI                          TUE 07/29/97 13:58 Page:9    
       47     6294                                                /**/
       48     6295    1        IF ( NOT S_D.SCHEMA ) OR ( NOT S_D.QSCH.OK ) OR ( S_D.IE$ = ADDR( NIL ) )

   6295  0 000002   000000 470400 xsym               LDP0    S_D$
         0 000003   000052 234100                    SZN     42,,PR0
         0 000004   000063 605000 0                  TPL     ARET
         0 000005   000733 234100                    SZN     475,,PR0
         0 000006   000063 605000 0                  TPL     ARET
         0 000007   001013 236100                    LDQ     523,,PR0
         0 000010   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000011   000063 600000 0                  TZE     ARET

       49     6296    1        THEN GOTO ARET;
       50     6297    1        CALL DDF$IE_#( 0, IE$ );

   6297  0 000012   200006 631500                    EPPR1   IE$,,AUTO
         0 000013   200013 451500                    STP1    IX+3,,AUTO
         0 000014   000000 236000 1                  LDQ     0
         0 000015   200012 756100                    STQ     IX+2,,AUTO
         0 000016   200012 630500                    EPPR0   IX+2,,AUTO
         0 000017   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000020   000000 701000 xent               TSX1    DDF$IE_#
         0 000021   000000 011000                    NOP     0

       51     6298    1        IEND = S_D.LB1$ -> B$LBNTRY1.INTRYSIZ / SIZEW( B$INTNTRY );

   6298  0 000022   000000 470400 xsym               LDP0    S_D$
         0 000023   001036 471500                    LDP1    542,,PR0
         0 000024   100003 236100                    LDQ     3,,PR1
         0 000025   000022 772000                    QRL     18
         0 000026   000001 772000                    QRL     1
         0 000027   200007 756100                    STQ     IEND,,AUTO

       52     6299    1        TIC = IC;

   6299  0 000030   200003 473500                    LDP3    @IC,,AUTO
         0 000031   300000 235100                    LDA     0,,PR3
PL6.E3A0      #001=DDF$FIND_IE File=DDF$STATEME.:E05TSI                          TUE 07/29/97 13:58 Page:10   
         0 000032   200005 755100                    STA     TIC,,AUTO

       53     6300    2        DO IX = 1 TO IEND;

   6300  0 000033   000001 235007                    LDA     1,DL
         0 000034   200010 755100                    STA     IX,,AUTO
         0 000035   000060 710000 0                  TRA     s:6307+3

       54     6301    2             IF ( TIC = B$INTNTRY.ISADDR )

   6301  0 000036   200006 470500                    LDP0    IE$,,AUTO
         0 000037   000000 236100                    LDQ     0,,PR0
         0 000040   000032 376000 xsym               ANQ     B_VECTNIL+26
         0 000041   200005 116100                    CMPQ    TIC,,AUTO
         0 000042   000047 601000 0                  TNZ     s:6306

       55     6302    3             THEN DO;

       56     6303    3                  ENTRY$ = IE$;

   6303  0 000043   200006 236100                    LDQ     IE$,,AUTO
         0 000044   200004 471500                    LDP1    @ENTRY$,,AUTO
         0 000045   100000 756100                    STQ     0,,PR1

       57     6304    3                  RETURN;

   6304  0 000046   000000 702200 xent               TSX2  ! X66_ARET

       58     6305    3                END;
       59     6306    2             CALL DDF$N_IE( IE$ ) ALTRET( ARET );

   6306  0 000047   200006 631500                    EPPR1   IE$,,AUTO
         0 000050   200012 451500                    STP1    IX+2,,AUTO
         0 000051   200012 630500                    EPPR0   IX+2,,AUTO
         0 000052   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000053   000000 701000 xent               TSX1    DDF$N_IE
         0 000054   000063 702000 0                  TSX2    ARET
PL6.E3A0      #001=DDF$FIND_IE File=DDF$STATEME.:E05TSI                          TUE 07/29/97 13:58 Page:11   

       60     6307    2           END;

   6307  0 000055   200010 235100                    LDA     IX,,AUTO
         0 000056   000001 035007                    ADLA    1,DL
         0 000057   200010 755100                    STA     IX,,AUTO
         0 000060   200007 236100                    LDQ     IEND,,AUTO
         0 000061   200010 116100                    CMPQ    IX,,AUTO
         0 000062   000036 603000 0                  TRC     s:6301

       61     6308                                                /**/
       62     6309    1   ARET: ALTRETURN;

   6309  0 000063   000000 702200 xent  ARET         TSX2  ! X66_AALT

(unnamed)
 Sect OctLoc
   1     000   000002 006000                                                    ....
       63     6310                                                /**/
       64     6311    1   END DDF$FIND_IE;
       65     6312        %EOD;

PL6.E3A0      #001=DDF$FIND_IE File=DDF$STATEME.:E05TSI                          TUE 07/29/97 13:58 Page:12   
--  Include file information  --

   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDF$FIND_IE.

   Procedure DDF$FIND_IE requires 52 words for executable code.
   Procedure DDF$FIND_IE requires 12 words of local(AUTO) storage.
PL6.E3A0      #001=DDF$FIND_IE File=DDF$STATEME.:E05TSI                          TUE 07/29/97 13:58 Page:13   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDF$FIND_IE File=DDF$STATEME.:E05TSI                          TUE 07/29/97 13:58 Page:14   
          MINI XREF LISTING

ARET
      6309**LABEL    6296--GOTO     6306--CALLALT
B$INTNTRY
      3497**DCL      6298--ASSIGN
B$INTNTRY.ISADDR
      3508**DCL      6301>>IF
B$INTNTRY.OU
      3501**DCL      3508--REDEF
B$LBNTRY1.INTRYSIZ
      3489**DCL      6298>>ASSIGN
DDF$IE_#
      6292**DCL-ENT  6297--CALL
DDF$N_IE
      6293**DCL-ENT  6306--CALL
ENTRY$
        34**DCL        31--PROC     6303<<ASSIGN
IC
        33**DCL        31--PROC     6299>>ASSIGN
IE$
        36**DCL      3497--IMP-PTR  6297<>CALL     6301>>IF       6303>>ASSIGN   6306<>CALL
IEND
        37**DCL      6298<<ASSIGN   6300>>DOINDEX
IX
        38**DCL      6300<<DOINDEX
S_D.CURRENT_CHANNEL
      5926**DCL      5928--REDEF
S_D.DEBUGA
      5078**DCL      5080--REDEF
S_D.EIS
      6036**DCL      6065--REDEF
S_D.HOST_MESSAGE_BUF_REMOTE
      5969**DCL      5970--REDEF    5984--REDEF
PL6.E3A0      #001=DDF$FIND_IE File=DDF$STATEME.:E05TSI                          TUE 07/29/97 13:58 Page:15   
S_D.IE$
      5388**DCL      6295>>IF
S_D.JDE
      5583**DCL      5584--REDEF
S_D.L$.VALUE
      5136**DCL      5142--REDEF    5150--REDEF    5153--REDEF    5156--REDEF    5159--REDEF
S_D.L$.VALUE.L
      5137**DCL      5138--REDEF    5139--REDEF
S_D.L6_MESSAGE_BUF
      5990**DCL      5992--REDEF
S_D.LB1$
      5414**DCL      6298>>ASSIGN
S_D.OUTPUT
      5956**DCL      5958--REDEF
S_D.QSCH.OK
      5282**DCL      6295>>IF
S_D.REMOTE_MSG.FNCC
      5975**DCL      5976--REDEF
S_D.REMOTE_MSG.STXC
      5971**DCL      5972--REDEF
S_D.REMOTE_MSG.SUBFNCC
      5979**DCL      5980--REDEF
S_D.SCHEMA
      5076**DCL      6295>>IF
S_D.SV
      5035**DCL      5056--REDEF
S_D$
      6287**DCL      4983--IMP-PTR  6295>>IF       6295>>IF       6295>>IF       6298>>ASSIGN
TIC
        35**DCL      6299<<ASSIGN   6301>>IF
PL6.E3A0      #001=DDF$FIND_IE File=DDF$STATEME.:E05TSI                          TUE 07/29/97 13:58 Page:16   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDF$FIND_IE File=DDF$STATEME.:E05TSI                          TUE 07/29/97 13:58 Page:17   
              MINI UREF LISTING

DDF$FIND_IE      31**PROC

PL6.E3A0      #002=DDF$STATEMENT File=DDF$STATEME.:E05TSI                        TUE 07/29/97 13:59 Page:18   
       66        1        /*T***********************************************************/
       67        2        /*T*                                                         */
       68        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       69        4        /*T*                                                         */
       70        5        /*T***********************************************************/
       71        6        /*F* NAME: DDF$STATEME
       72        7             PURPOSE: To locate an IC value in the executable statements table.
       73        8             DESCRIPTION: Given the IC value, the executable statements table
       74        9             is searched so as to locate the beginning of the statement, the closest
       75       10             substatement, and its substatement number. If the IC value is less than
       76       11             any executable statement, or if there is no executable statements
       77       12             record, then the altreturn is taken, else the normal return is taken
       78       13             with the values indicated being returned. */
       79       14        /*D* NAME: DDF$STATEME
       80       15             CALL: CALL DDF$STATEME( IC, STMT#, SUBST#, SUBST ) ALTRET( cant find );
       81       16             INTERFACE: DDF$EXST_#
       82       17                        DDF$N_EXST
       83       18             ENVIRONMENT: Delta.
       84       19             INPUT: IC - IC value.
       85       20             OUTPUT: STMT# - entry number of closest statement.
       86       21                     SUBST# - entry number of closest substatement.
       87       22                     SUBST - substatement number.
       88       23             SCRATCH: Local auto only.
       89       24             DESCRIPTION: Given the IC value, the executable statements table
       90       25             is searched so as to locate the beginning of the statement, the closest
       91       26             substatement, and its substatement number. If the IC value is less than
       92       27             any executable statement, or if there is no executable statements
       93       28             record, then the altreturn is taken, else the normal return is taken
       94       29             with the values indicated being returned. */
       95       30                                                /**/
       96       31        DDF$STATEMENT: PROC( IC, STMT#, SUBST#, SUBST ) ALTRET;
       97       32                                                /**/
       98       33    1   DCL IC UBIN;
       99       34    1   DCL STMT# UBIN;
      100       35    1   DCL SUBST# UBIN;
      101       36    1   DCL SUBST UBIN;
      102       37    1   DCL ST# UBIN;
PL6.E3A0      #002=DDF$STATEMENT File=DDF$STATEME.:E05TSI                        TUE 07/29/97 13:59 Page:19   
      103       38    1   DCL TST$ PTR;
      104       39    1   DCL LST# UBIN;
      105       40    1   DCL TIC UBIN;
      106       41    1   DCL EXSTART SBIN;
      107       42    1   DCL EXSTEND SBIN;
      108       43    1   DCL IX SBIN;
      109       44        /*D* EXSTART, EXSTEND, & IX must be SBIN */
      110       45    1   DCL LINE SBIN;
      111       46    1   DCL TLINE UBIN;
      112       47    1   DCL SUB UBIN;
      113       48    1   DCL STT UBIN;
      114       49        %INCLUDE B$OBJECT_C;
      115     3479        %B$STTYPESUBS;
      116     3548        %B$EXST (STCLASS="BASED(TST$)");
      117     3655        %B$LOGBLK;
      118     3686        %INCLUDE XUH_MACRO_C;
      119     3770        %INCLUDE DD_SD_M;
      120     5106        %S_D;
      121     6424    1   DCL DDF$EXST_# ENTRY(2) ALTRET;
      122     6425    1        S_D.LABEL_FOUND = '0'B;
      123     6426                                                /**/
      124     6427    1        IF ( NOT S_D.SCHEMA ) OR ( NOT S_D.QSCH.OK ) OR ( S_D.EXST$ = ADDR( NIL ) )
      125     6428    1        THEN GOTO ARET;
      126     6429    1        LINE = -1;
      127     6430    1        TST$ = PINCRW( S_D.LB$, SIZEW( B$LOGBLK ) * S_D.QSCH.LB# );
      128     6431    1        EXSTART = TST$ -> B$LOGBLK.STOFFST / SIZEW( B$EXST );
      129     6432    1        EXSTEND = EXSTART + TST$ -> B$LOGBLK.STSIZE - 1;
      130     6433    2        DO IX = EXSTART TO EXSTEND;
      131     6434    2             CALL DDF$EXST_#( IX, TST$ ) ALTRET( ARET );
      132     6435    2             STT = B$EXST.STTYPE;
      133     6436    2             IF STT ~= %S@MISC OR
      134     6437    2               NOT (STT = %S@NULL AND S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6)
      135     6438    3             THEN DO;                      /* Don't ignore it */
      136     6439    3                  TIC = B$EXST.ISADDR;
      137     6440    3                  IF TIC > IC
      138     6441    3                  THEN GOTO OUT;           /* Done - use last found */
      139     6442    3                  IF TIC = IC
PL6.E3A0      #002=DDF$STATEMENT File=DDF$STATEME.:E05TSI                        TUE 07/29/97 13:59 Page:20   
      140     6443    3                  THEN IF B$EXST.NPOINTER >= 0
      141     6444    3                       THEN S_D.LABEL_FOUND = '1'B;
      142     6445    3                  TLINE = B$EXST.LINENUM;
      143     6446    3                  IF TLINE = LINE          /* Do accounting now */
      144     6447    4                  THEN DO;
      145     6448    4                       LST# = IX;
      146     6449    4                       SUB = SUB + 1;
      147     6450    4                     END;
      148     6451    4                  ELSE DO;
      149     6452    4                       ST# = IX;
      150     6453    4                       LST# = IX;
      151     6454    4                       LINE = TLINE;
      152     6455    4                       SUB = 0;
      153     6456    4                     END;
      154     6457    3                END;                       /* Don't ignore it */
      155     6458    2           END;
      156     6459    1   OUT:
      157     6460    1        IF LINE = -1
      158     6461    1        THEN GOTO ARET;
      159     6462    1        STMT# = ST#;
      160     6463    1        SUBST# = LST#;
      161     6464    1        SUBST = SUB;
      162     6465                                                /**/
      163     6466    1        RETURN;
      164     6467                                                /**/
      165     6468    1   ARET: ALTRETURN;
      166     6469                                                /**/
      167     6470    1   END DDF$STATEMENT;

PL6.E3A0      #002=DDF$STATEMENT File=DDF$STATEME.:E05TSI                        TUE 07/29/97 13:59 Page:21   
--  Include file information  --

   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDF$STATEMENT.

   Procedure DDF$STATEMENT requires 100 words for executable code.
   Procedure DDF$STATEMENT requires 20 words of local(AUTO) storage.

    No errors detected in file DDF$STATEME.:E05TSI    .

PL6.E3A0      #002=DDF$STATEMENT File=DDF$STATEME.:E05TSI                        TUE 07/29/97 13:59 Page:22   

 Object Unit name= DDF$STATEMENT                              File name= DDF$STATEME.:E05TOU
 UTS= JUL 29 '97 13:59:04.68 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   100    144  DDF$STATEMENT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        4  DDF$STATEMENT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 DDF$EXST_#
                       nStd      0 X66_AUTO_4
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    S_D$                                  B_VECTNIL
PL6.E3A0      #002=DDF$STATEMENT File=DDF$STATEME.:E05TSI                        TUE 07/29/97 13:59 Page:23   


       66        1        /*T***********************************************************/
       67        2        /*T*                                                         */
       68        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       69        4        /*T*                                                         */
       70        5        /*T***********************************************************/
       71        6        /*F* NAME: DDF$STATEME
       72        7             PURPOSE: To locate an IC value in the executable statements table.
       73        8             DESCRIPTION: Given the IC value, the executable statements table
       74        9             is searched so as to locate the beginning of the statement, the closest
       75       10             substatement, and its substatement number. If the IC value is less than
       76       11             any executable statement, or if there is no executable statements
       77       12             record, then the altreturn is taken, else the normal return is taken
       78       13             with the values indicated being returned. */
       79       14        /*D* NAME: DDF$STATEME
       80       15             CALL: CALL DDF$STATEME( IC, STMT#, SUBST#, SUBST ) ALTRET( cant find );
       81       16             INTERFACE: DDF$EXST_#
       82       17                        DDF$N_EXST
       83       18             ENVIRONMENT: Delta.
       84       19             INPUT: IC - IC value.
       85       20             OUTPUT: STMT# - entry number of closest statement.
       86       21                     SUBST# - entry number of closest substatement.
       87       22                     SUBST - substatement number.
       88       23             SCRATCH: Local auto only.
       89       24             DESCRIPTION: Given the IC value, the executable statements table
       90       25             is searched so as to locate the beginning of the statement, the closest
       91       26             substatement, and its substatement number. If the IC value is less than
       92       27             any executable statement, or if there is no executable statements
       93       28             record, then the altreturn is taken, else the normal return is taken
       94       29             with the values indicated being returned. */
       95       30                                                /**/
       96       31        DDF$STATEMENT: PROC( IC, STMT#, SUBST#, SUBST ) ALTRET;

     31  0 000000   000000 700200 xent  DDF$STATEME* TSX0  ! X66_AUTO_4
         0 000001   000024 000004                    ZERO    20,4

       97       32                                                /**/
PL6.E3A0      #002=DDF$STATEMENT File=DDF$STATEME.:E05TSI                        TUE 07/29/97 13:59 Page:24   
       98       33    1   DCL IC UBIN;
       99       34    1   DCL STMT# UBIN;
      100       35    1   DCL SUBST# UBIN;
      101       36    1   DCL SUBST UBIN;
      102       37    1   DCL ST# UBIN;
      103       38    1   DCL TST$ PTR;
      104       39    1   DCL LST# UBIN;
      105       40    1   DCL TIC UBIN;
      106       41    1   DCL EXSTART SBIN;
      107       42    1   DCL EXSTEND SBIN;
      108       43    1   DCL IX SBIN;
      109       44        /*D* EXSTART, EXSTEND, & IX must be SBIN */
      110       45    1   DCL LINE SBIN;
      111       46    1   DCL TLINE UBIN;
      112       47    1   DCL SUB UBIN;
      113       48    1   DCL STT UBIN;
      114       49        %INCLUDE B$OBJECT_C;
      115     3479        %B$STTYPESUBS;
      116     3548        %B$EXST (STCLASS="BASED(TST$)");
      117     3655        %B$LOGBLK;
      118     3686        %INCLUDE XUH_MACRO_C;
      119     3770        %INCLUDE DD_SD_M;
      120     5106        %S_D;
      121     6424    1   DCL DDF$EXST_# ENTRY(2) ALTRET;
      122     6425    1        S_D.LABEL_FOUND = '0'B;

   6425  0 000002   000000 470400 xsym               LDP0    S_D$
         0 000003   005327 450100                    STZ     2775,,PR0

      123     6426                                                /**/
      124     6427    1        IF ( NOT S_D.SCHEMA ) OR ( NOT S_D.QSCH.OK ) OR ( S_D.EXST$ = ADDR( NIL ) )

   6427  0 000004   000052 234100                    SZN     42,,PR0
         0 000005   000143 605000 0                  TPL     ARET
         0 000006   000733 234100                    SZN     475,,PR0
         0 000007   000143 605000 0                  TPL     ARET
         0 000010   001010 236100                    LDQ     520,,PR0
PL6.E3A0      #002=DDF$STATEMENT File=DDF$STATEME.:E05TSI                        TUE 07/29/97 13:59 Page:25   
         0 000011   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000012   000143 600000 0                  TZE     ARET

      125     6428    1        THEN GOTO ARET;
      126     6429    1        LINE = -1;

   6429  0 000013   000001 335007                    LCA     1,DL
         0 000014   200016 755100                    STA     LINE,,AUTO

      127     6430    1        TST$ = PINCRW( S_D.LB$, SIZEW( B$LOGBLK ) * S_D.QSCH.LB# );

   6430  0 000015   000740 720100                    LXL0    480,,PR0
         0 000016   001037 471500                    LDP1    543,,PR0
         0 000017   000000 635010                    EAA     0,X0
         0 000020   000020 771000                    ARL     16
         0 000021   100000 633505                    EPPR3   0,AL,PR1
         0 000022   200010 453500                    STP3    TST$,,AUTO

      128     6431    1        EXSTART = TST$ -> B$LOGBLK.STOFFST / SIZEW( B$EXST );

   6431  0 000023   300002 236100                    LDQ     2,,PR3
         0 000024   000022 772000                    QRL     18
         0 000025   000003 506007                    DIV     3,DL
         0 000026   200013 756100                    STQ     EXSTART,,AUTO

      129     6432    1        EXSTEND = EXSTART + TST$ -> B$LOGBLK.STSIZE - 1;

   6432  0 000027   300002 236100                    LDQ     2,,PR3
         0 000030   777777 376007                    ANQ     -1,DL
         0 000031   200013 036100                    ADLQ    EXSTART,,AUTO
         0 000032   000001 136007                    SBLQ    1,DL
         0 000033   200014 756100                    STQ     EXSTEND,,AUTO

      130     6433    2        DO IX = EXSTART TO EXSTEND;

   6433  0 000034   200013 235100                    LDA     EXSTART,,AUTO
         0 000035   200015 755100                    STA     IX,,AUTO
PL6.E3A0      #002=DDF$STATEMENT File=DDF$STATEME.:E05TSI                        TUE 07/29/97 13:59 Page:26   
         0 000036   000123 710000 0                  TRA     s:6458+1

      131     6434    2             CALL DDF$EXST_#( IX, TST$ ) ALTRET( ARET );

   6434  0 000037   200010 630500                    EPPR0   TST$,,AUTO
         0 000040   200023 450500                    STP0    STT+2,,AUTO
         0 000041   200015 631500                    EPPR1   IX,,AUTO
         0 000042   200022 451500                    STP1    STT+1,,AUTO
         0 000043   200022 630500                    EPPR0   STT+1,,AUTO
         0 000044   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000045   000000 701000 xent               TSX1    DDF$EXST_#
         0 000046   000143 702000 0                  TSX2    ARET

      132     6435    2             STT = B$EXST.STTYPE;

   6435  0 000047   200010 470500                    LDP0    TST$,,AUTO
         0 000050   000002 236100                    LDQ     2,,PR0
         0 000051   000022 772000                    QRL     18
         0 000052   000177 376007                    ANQ     127,DL
         0 000053   200021 756100                    STQ     STT,,AUTO

      133     6436    2             IF STT ~= %S@MISC OR

   6436  0 000054   000150 116007                    CMPQ    104,DL
         0 000055   000064 601000 0                  TNZ     s:6439
         0 000056   000000 116003                    CMPQ    0,DU
         0 000057   000064 601000 0                  TNZ     s:6439
         0 000060   000000 471400 xsym               LDP1    S_D$
         0 000061   106714 235100                    LDA     3532,,PR1
         0 000062   000002 115007                    CMPA    2,DL
         0 000063   000122 600000 0                  TZE     s:6458

      134     6437    2               NOT (STT = %S@NULL AND S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6)
      135     6438    3             THEN DO;                      /* Don't ignore it */

      136     6439    3                  TIC = B$EXST.ISADDR;

PL6.E3A0      #002=DDF$STATEMENT File=DDF$STATEME.:E05TSI                        TUE 07/29/97 13:59 Page:27   
   6439  0 000064   000000 236100                    LDQ     0,,PR0
         0 000065   000032 376000 xsym               ANQ     B_VECTNIL+26
         0 000066   200012 756100                    STQ     TIC,,AUTO

      137     6440    3                  IF TIC > IC

   6440  0 000067   200003 471500                    LDP1    @IC,,AUTO
         0 000070   100000 116100                    CMPQ    0,,PR1
         0 000071   000073 600000 0                  TZE     s:6442
         0 000072   000126 603000 0                  TRC     OUT

      138     6441    3                  THEN GOTO OUT;           /* Done - use last found */
      139     6442    3                  IF TIC = IC

   6442  0 000073   000101 601000 0                  TNZ     s:6445

      140     6443    3                  THEN IF B$EXST.NPOINTER >= 0

   6443  0 000074   000001 220100                    LDX0    1,,PR0
         0 000075   000101 604000 0                  TMI     s:6445

      141     6444    3                       THEN S_D.LABEL_FOUND = '1'B;

   6444  0 000076   400000 236003                    LDQ     -131072,DU
         0 000077   000000 473400 xsym               LDP3    S_D$
         0 000100   305327 756100                    STQ     2775,,PR3

      142     6445    3                  TLINE = B$EXST.LINENUM;

   6445  0 000101   000002 236100                    LDQ     2,,PR0
         0 000102   777777 376007                    ANQ     -1,DL
         0 000103   200017 756100                    STQ     TLINE,,AUTO

      143     6446    3                  IF TLINE = LINE          /* Do accounting now */

   6446  0 000104   000115 604000 0                  TMI     s:6452
         0 000105   200016 116100                    CMPQ    LINE,,AUTO
PL6.E3A0      #002=DDF$STATEMENT File=DDF$STATEME.:E05TSI                        TUE 07/29/97 13:59 Page:28   
         0 000106   000115 601000 0                  TNZ     s:6452

      144     6447    4                  THEN DO;

      145     6448    4                       LST# = IX;

   6448  0 000107   200015 235100                    LDA     IX,,AUTO
         0 000110   200011 755100                    STA     LST#,,AUTO

      146     6449    4                       SUB = SUB + 1;

   6449  0 000111   200020 235100                    LDA     SUB,,AUTO
         0 000112   000001 035007                    ADLA    1,DL
         0 000113   200020 755100                    STA     SUB,,AUTO

      147     6450    4                     END;

   6450  0 000114   000122 710000 0                  TRA     s:6458

      148     6451    4                  ELSE DO;

      149     6452    4                       ST# = IX;

   6452  0 000115   200015 235100                    LDA     IX,,AUTO
         0 000116   200007 755100                    STA     ST#,,AUTO

      150     6453    4                       LST# = IX;

   6453  0 000117   200011 755100                    STA     LST#,,AUTO

      151     6454    4                       LINE = TLINE;

   6454  0 000120   200016 756100                    STQ     LINE,,AUTO

      152     6455    4                       SUB = 0;

   6455  0 000121   200020 450100                    STZ     SUB,,AUTO
PL6.E3A0      #002=DDF$STATEMENT File=DDF$STATEME.:E05TSI                        TUE 07/29/97 13:59 Page:29   

      153     6456    4                     END;

      154     6457    3                END;                       /* Don't ignore it */

      155     6458    2           END;

   6458  0 000122   200015 054100                    AOS     IX,,AUTO
         0 000123   200015 236100                    LDQ     IX,,AUTO
         0 000124   200014 116100                    CMPQ    EXSTEND,,AUTO
         0 000125   000037 604400 0                  TMOZ    s:6434

      156     6459    1   OUT:
      157     6460    1        IF LINE = -1

   6460  0 000126   200016 235100       OUT          LDA     LINE,,AUTO
         0 000127   000027 115000 xsym               CMPA    B_VECTNIL+23
         0 000130   000143 600000 0                  TZE     ARET

      158     6461    1        THEN GOTO ARET;
      159     6462    1        STMT# = ST#;

   6462  0 000131   200004 470500                    LDP0    @STMT#,,AUTO
         0 000132   200007 236100                    LDQ     ST#,,AUTO
         0 000133   000000 756100                    STQ     0,,PR0

      160     6463    1        SUBST# = LST#;

   6463  0 000134   200005 471500                    LDP1    @SUBST#,,AUTO
         0 000135   200011 235100                    LDA     LST#,,AUTO
         0 000136   100000 755100                    STA     0,,PR1

      161     6464    1        SUBST = SUB;

   6464  0 000137   200006 473500                    LDP3    @SUBST,,AUTO
         0 000140   200020 235100                    LDA     SUB,,AUTO
         0 000141   300000 755100                    STA     0,,PR3
PL6.E3A0      #002=DDF$STATEMENT File=DDF$STATEME.:E05TSI                        TUE 07/29/97 13:59 Page:30   

      162     6465                                                /**/
      163     6466    1        RETURN;

   6466  0 000142   000000 702200 xent               TSX2  ! X66_ARET

      164     6467                                                /**/
      165     6468    1   ARET: ALTRETURN;

   6468  0 000143   000000 702200 xent  ARET         TSX2  ! X66_AALT
      166     6469                                                /**/
      167     6470    1   END DDF$STATEMENT;

PL6.E3A0      #002=DDF$STATEMENT File=DDF$STATEME.:E05TSI                        TUE 07/29/97 13:59 Page:31   
--  Include file information  --

   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDF$STATEMENT.

   Procedure DDF$STATEMENT requires 100 words for executable code.
   Procedure DDF$STATEMENT requires 20 words of local(AUTO) storage.

    No errors detected in file DDF$STATEME.:E05TSI    .
PL6.E3A0      #002=DDF$STATEMENT File=DDF$STATEME.:E05TSI                        TUE 07/29/97 13:59 Page:32   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=DDF$STATEMENT File=DDF$STATEME.:E05TSI                        TUE 07/29/97 13:59 Page:33   
          MINI XREF LISTING

ARET
      6468**LABEL    6428--GOTO     6434--CALLALT  6461--GOTO
B$EXST
      3549**DCL      6431--ASSIGN
B$EXST.ISADDR
      3564**DCL      6439>>ASSIGN
B$EXST.LINENUM
      3652**DCL      6445>>ASSIGN
B$EXST.NPOINTER
      3566**DCL      6443>>IF
B$EXST.OU
      3558**DCL      3564--REDEF
B$EXST.STTYPE
      3582**DCL      6435>>ASSIGN
B$LOGBLK
      3656**DCL      6430--ASSIGN
B$LOGBLK.STOFFST
      3671**DCL      6431>>ASSIGN
B$LOGBLK.STSIZE
      3675**DCL      6432>>ASSIGN
DDF$EXST_#
      6424**DCL-ENT  6434--CALL
EXSTART
        41**DCL      6431<<ASSIGN   6432>>ASSIGN   6433>>DOINDEX
EXSTEND
        42**DCL      6432<<ASSIGN   6433>>DOINDEX
IC
        33**DCL        31--PROC     6440>>IF       6442>>IF
IX
        43**DCL      6433<<DOINDEX  6434<>CALL     6448>>ASSIGN   6452>>ASSIGN   6453>>ASSIGN
LINE
        45**DCL      6429<<ASSIGN   6446>>IF       6454<<ASSIGN   6460>>IF
PL6.E3A0      #002=DDF$STATEMENT File=DDF$STATEME.:E05TSI                        TUE 07/29/97 13:59 Page:34   
LST#
        39**DCL      6448<<ASSIGN   6453<<ASSIGN   6463>>ASSIGN
OUT
      6460**LABEL    6441--GOTO
ST#
        37**DCL      6452<<ASSIGN   6462>>ASSIGN
STMT#
        34**DCL        31--PROC     6462<<ASSIGN
STT
        48**DCL      6435<<ASSIGN   6436>>IF       6436>>IF
SUB
        47**DCL      6449<<ASSIGN   6449>>ASSIGN   6455<<ASSIGN   6464>>ASSIGN
SUBST
        36**DCL        31--PROC     6464<<ASSIGN
SUBST#
        35**DCL        31--PROC     6463<<ASSIGN
S_D.CURRENT_CHANNEL
      6058**DCL      6060--REDEF
S_D.DEBUGA
      5210**DCL      5212--REDEF
S_D.EIS
      6168**DCL      6197--REDEF
S_D.EXST$
      5514**DCL      6427>>IF
S_D.HOST_MESSAGE_BUF_REMOTE
      6101**DCL      6102--REDEF    6116--REDEF
S_D.JDE
      5715**DCL      5716--REDEF
S_D.L$.VALUE
      5268**DCL      5274--REDEF    5282--REDEF    5285--REDEF    5288--REDEF    5291--REDEF
S_D.L$.VALUE.L
      5269**DCL      5270--REDEF    5271--REDEF
S_D.L6_MESSAGE_BUF
      6122**DCL      6124--REDEF
S_D.LABEL_FOUND
      6075**DCL      6425<<ASSIGN   6444<<ASSIGN
PL6.E3A0      #002=DDF$STATEMENT File=DDF$STATEME.:E05TSI                        TUE 07/29/97 13:59 Page:35   
S_D.LB$
      5548**DCL      6430>>ASSIGN
S_D.ONE_TO_TWO.EXEC_DOMAIN
      6133**DCL      6436>>IF
S_D.OUTPUT
      6088**DCL      6090--REDEF
S_D.QSCH.LB#
      5424**DCL      6430>>ASSIGN
S_D.QSCH.OK
      5414**DCL      6427>>IF
S_D.REMOTE_MSG.FNCC
      6107**DCL      6108--REDEF
S_D.REMOTE_MSG.STXC
      6103**DCL      6104--REDEF
S_D.REMOTE_MSG.SUBFNCC
      6111**DCL      6112--REDEF
S_D.SCHEMA
      5208**DCL      6427>>IF
S_D.SV
      5167**DCL      5188--REDEF
S_D$
      6419**DCL      5115--IMP-PTR  6425>>ASSIGN   6427>>IF       6427>>IF       6427>>IF       6430>>ASSIGN
      6430>>ASSIGN   6436>>IF       6444>>ASSIGN
TIC
        40**DCL      6439<<ASSIGN   6440>>IF       6442>>IF
TLINE
        46**DCL      6445<<ASSIGN   6446>>IF       6454>>ASSIGN
TST$
        38**DCL      3549--IMP-PTR  6430<<ASSIGN   6431>>ASSIGN   6432>>ASSIGN   6434<>CALL     6435>>ASSIGN
      6439>>ASSIGN   6443>>IF       6445>>ASSIGN
PL6.E3A0      #002=DDF$STATEMENT File=DDF$STATEME.:E05TSI                        TUE 07/29/97 13:59 Page:36   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #002=DDF$STATEMENT File=DDF$STATEME.:E05TSI                        TUE 07/29/97 13:59 Page:37   
              MINI UREF LISTING

DDF$STATEMENT      31**PROC
