
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:1    
        1        1        /*M*       ZII$ADD_NAM            I-D-S/II INTERFACE MODULE*/
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8          NAME:  ZII$ADD_NAM
        9        9          PURPOSE: This module is used to add information to tables
       10       10                   NAM1 & NAM2 when certain types of descriptors are encountered
       11       11                   in the Subschema file*/
       12       12        /************************************************************/
       13       13        ZII$ADD_NAM: PROC ALTRET AVOID($PR5,$PR6,$PR7);
       14       14        /********************Auto dcls*******************/
       15       15    1   DCL TDRFS$ PTR;
       16       16    1   DCL HRFS$ PTR;
       17       17    1   DCL TDRFK$ PTR;
       18       18    1   DCL TDRP$ PTR;
       19       19    1   DCL HRFK$ PTR;
       20       20    1   DCL TDRA$ PTR;
       21       21    1   DCL I UBIN(36);
       22       22    1   DCL TMP_NAME CHAR(32) ALIGNED;
       23       23    1   DCL TMP_RVA_SIZ UBIN AUTO;
       24       24        /*******************Ext   dcls*******************/
       25       25    1   DCL ERROR_CODE UBIN(36) EXT;
       26       26    1   DCL REC$ PTR EXT;
       27       27    1   DCL RVA_SIZ UBIN(36) EXT;
       28       28    1   DCL RVE_IDX UBIN(18) EXT;
       29       29        /*******************Entry dcls******************/
       30       30    1   DCL ZII$FDDESC ENTRY(5) ALTRET;
       31       31    1   DCL ZII$LNKDSC ENTRY(7);
       32       32    1   DCL ZII$FDRLDSC ENTRY(5) ALTRET;
       33       33    1   DCL ZII$GET_RVA ENTRY(1);
       34       34        /*********************Include files**************/
       35       35        %INCLUDE CP_6_SUBS;
       36      575        %INCLUDE ZI$STRUCTS;
       37      647        %NAM1;
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:2    
       38      676        %NAM2;
       39      690        %INCLUDE ZI$USER;
       40      835        %RVA (STCLASS="EXT");
       41      848        %INCLUDE ZI_SUB_LANG;
       42     2563        %DESC_TYPE_31 (STCLASS="BASED(REC$)");
       43     2605        %DESC_TYPE_32 (STCLASS="BASED(REC$)");
       44     2671        %DESC_TYPE_33 (STCLASS="BASED(REC$)");
       45     2716        %DESC_TYPE_34 (STCLASS="BASED(REC$)");
       46     2764        %DESC_TYPE_35 (STCLASS="BASED(REC$)");
       47     2803        %DESC_TYPE_37 (STCLASS="BASED(REC$)");
       48     2843        %DESC_TYPE_110 (STCLASS="BASED(REC$)");
       49     2907        %DESC_TYPE_200 (STCLASS="BASED(REC$)");
       50     2960        %DESC_TYPE_300 (STCLASS="BASED(REC$)");
       51     3029        %DESC_TYPE_400 (STCLASS="BASED(REC$)");
       52     3088        %DESC_TYPE_420 (STCLASS="BASED(REC$)");
       53     3121        %DESC_TYPE_430 (STCLASS="BASED(REC$)");
       54     3280        %INCLUDE ZI$DESC;
       55     4130        %DSC_AREA;
       56     4152        %DSC_REC;
       57     4186        %DSC_SET;
       58     4228        %DSC_KEY;
       59     4238        %DSC_RFS;
       60     4283        %DSC_RFK;
       61     4299        %DSC_RA;
       62     4314        %DSC_RP;
       63     4324        %DSC_DESC;
       64     4332        %DSC_FLD;
       65     4447        %DSC_PARAM;
       66     4464        %TYPE_SUBS;
       67     4474        %INCLUDE ZI_ERRORS_SUBS;
       68     4994        /*******************Program procedure************/
       69     4995    1       TMP_NAME=' ';
       70     4996    1       IF TYPE_430.TYPE=31 THEN /*Record_Area descriptor*/
       71     4997    2       DO;
       72     4998    2           CALL ZII$FDRLDSC(TYPE_31.SUB_RECORD_NM,TYPE_31.SUB_AREA_NM,,DRA$,#STORE)
              4998                    ALTRET(ER_FDRLDSC);
       73     4999        /***********************************************************************/
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:3    
       74     5000        /*Procedure to link in an RA_DSC to a link list for the record
       75     5001                 1. Find the  record descriptor.
       76     5002                 2. Test to see if this is  the 1st RA_DSC to be linked
       77     5003                     into the link list for this particular record.
       78     5004                    a. If it is, modify the RECORD.RA_DSC$ to point  to the
       79     5005                        RA_DSC descrptoriptor that  is about to be built.
       80     5006                    b. If it is not,
       81     5007                       1. get the pointer to the 1st RA_DSC for the record descriptor
       82     5008                      2. keep following the RA_DSC.REC$ link list until  the end of the list
       83     5009                           is reached(RA_DSC.REC$ equals ADDR(nil))
       84     5010                    3. hook up the RA_DSC that is about to be built  to the end of the chain
       85     5011        */
       86     5012        /***********************************************************************/
       87     5013    2           CALL ZII$FDDESC(TYPE_31.SUB_RECORD_NM,#RECORD,DR$,#RETRIEVE,) ALTRET(
              5013                    ER_FDDESC);
       88     5014    2           IF RECORD.RA_DSC$=ADDR(NIL) THEN
       89     5015    3           DO;
       90     5016    3               RECORD.RA_DSC$=DRA$;
       91     5017    3               END;
       92     5018    3           ELSE DO;
       93     5019    3               TDRA$=RECORD.RA_DSC$;
       94     5020    4               DO WHILE(TDRA$->RA_DSC.REC$ ~= ADDR(NIL));
       95     5021    4                   TDRA$=TDRA$->RA_DSC.REC$;
       96     5022    4                   END;
       97     5023    3               TDRA$->RA_DSC.REC$=DRA$;
       98     5024    3               END;
       99     5025        /***********************************************************************/
      100     5026        /*Procedure to link in an RA_DSC to a link list for the area
      101     5027                 1. Find the  area descriptor.
      102     5028                 2. Test to see if this is  the 1st RA_DSC to be linked
      103     5029                     into the link list for this particular area.
      104     5030                    a. If it is, modify the AREA.RA_DSC$ to point  to the
      105     5031                        RA_DSC descrptoriptor that  is about to be built.
      106     5032                    b. If it is not,
      107     5033                       1. get the pointer to the 1st RA_DSC for the area descriptor
      108     5034                     2. keep following the RA_DSC.AREA$ link list until  the end of the list
      109     5035                           is reached(RA_DSC.AREA$ equals ADDR(nil))
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:4    
      110     5036                    3. hook up the RA_DSC that is about to be built  to the end of the chain
      111     5037        */
      112     5038        /***********************************************************************/
      113     5039    2           CALL ZII$FDDESC(TYPE_31.SUB_AREA_NM,#AREA,DA$,#RETRIEVE,) ALTRET(ER_FDDESC);
      114     5040    2           IF AREA.RA_DSC$=ADDR(NIL) THEN
      115     5041    3           DO;
      116     5042    3               AREA.RA_DSC$=DRA$;
      117     5043    3               END;
      118     5044    3           ELSE DO;
      119     5045    3               TDRA$=AREA.RA_DSC$;
      120     5046    4               DO WHILE(TDRA$->RA_DSC.AREA$ ~= ADDR(NIL));
      121     5047    4                   TDRA$=TDRA$->RA_DSC.AREA$;
      122     5048    4                   END;
      123     5049    3               TDRA$->RA_DSC.AREA$=DRA$;
      124     5050    3               END;
      125     5051    2           RA_DSC.AREA_IDX=AREA.NAM_IDX; /*Put in the NAM1 index for the area name */
      126     5052    2           RA_DSC.REC_IDX=RECORD.NAM_IDX;
              5052                    /*Put in the NAM1 index for the record name */
      127     5053    2           RA_DSC.LO_DBK_RNG=TYPE_31.LO_DBK_RNG;
              5053                    /*Get the  low DBK range for the record in this area*/
      128     5054    2           RA_DSC.HI_DBK_RNG=TYPE_31.HI_DBK_RNG;
              5054                    /*Get the high DBK range for the record in this area*/
      129     5055    2           RA_DSC.FLAGS=TYPE_31.FLAGS; /*Put in the  flags for the RA_DSC,. */
      130     5056    2           RA_DSC.REC$=ADDR(NIL); /*Null out  all the link list pointers */
      131     5057    2           RA_DSC.AREA$=ADDR(NIL);
      132     5058    2           RA_DSC.LLIST$=ADDR(NIL);
      133     5059    2           END;
      134     5060    1       ELSE IF TYPE_430.TYPE=32 THEN /*Record_Set descriptors*/
      135     5061    2           DO;
      136     5062    2               CALL ZII$FDRLDSC(TYPE_32.SUB_RECORD_NM,TYPE_32.SUB_SET_NM,,DRFS$,#STORE)
              5062                        ALTRET(ER_FDRLDSC);
      137     5063        /********************************************************************/
      138     5064        /*Hook up the  record descriptor for the  RFS_DSC the same as  the
      139     5065          record descriptor was hooked up for the  the RA_DSC above          */
      140     5066        /*********************************************************************/
      141     5067    2               CALL ZII$FDDESC(TYPE_32.SUB_RECORD_NM,#RECORD,DR$,#RETRIEVE,) ALTRET(
              5067                        ER_FDDESC);
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:5    
      142     5068    2               IF RECORD.RFS_DSC$=ADDR(NIL) THEN
      143     5069    3               DO;
      144     5070    3                   RECORD.RFS_DSC$=DRFS$;
      145     5071    3                   END;
      146     5072    3               ELSE DO;
      147     5073    3                   TDRFS$=RECORD.RFS_DSC$;
      148     5074    4                   DO WHILE(TDRFS$->RFS_DSC.REC$ ~= ADDR(NIL));
      149     5075    4                       TDRFS$=TDRFS$->RFS_DSC.REC$;
      150     5076    4                       END;
      151     5077    3                   TDRFS$->RFS_DSC.REC$=DRFS$;
      152     5078    3                   END;
      153     5079        /********************************************************************/
      154     5080        /*Hook up the  set descriptor for the  RFS_DSC the same as  the
      155     5081          area descriptor was hooked up for the  the RA_DSC above          */
      156     5082        /*********************************************************************/
      157     5083    2               CALL ZII$FDDESC(TYPE_32.SUB_SET_NM,#SET,DS$,#RETRIEVE,) ALTRET(ER_FDDESC
              5083                        );
      158     5084    2               IF SET.RFS_DSC$=ADDR(NIL) THEN
      159     5085    3               DO;
      160     5086    3                   SET.RFS_DSC$=DRFS$;
      161     5087    3                   END;
      162     5088    3               ELSE DO;
      163     5089    3                   TDRFS$=SET.RFS_DSC$;
      164     5090    4                   DO WHILE(TDRFS$->RFS_DSC.SET$ ~= ADDR(NIL));
      165     5091    4                       TDRFS$=TDRFS$->RFS_DSC.SET$;
      166     5092    4                       END;
      167     5093    3                   TDRFS$->RFS_DSC.SET$=DRFS$;
      168     5094    3                   END;
      169     5095    2               RFS_DSC.REC_IDX=RECORD.NAM_IDX;
              5095                        /*Put in the  NAM1 index for the  record name*/
      170     5096    2               RFS_DSC.SET_IDX=SET.NAM_IDX; /*Put in the NAM1 index for the set name */
      171     5097    2               IF TYPE_32.OWNER = %YES# THEN
              5097                        /*Is this record name in the type 32 the owner of the set?*/
      172     5098    3               DO; /*yes */
      173     5099    3                   SET.OWNER_IDX=RFS_DSC.REC_IDX;
              5099                            /*Update the  set descriptor to put in the  record NAM1 index*/
      174     5100    3                   RFS_DSC.OWN_MEM=%NO#;
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:6    
              5100                            /*Update the RFS_DSC to  turn OWN_MEM bit off */
      175     5101    3                   END;
      176     5102    2               IF TYPE_32.MEMBER = %YES# THEN RFS_DSC.OWN_MEM= %YES#;
              5102                        /*Turn the  OWN_MEM bit on*/
      177     5103    2               IF TYPE_32.OPTIONAL_MEM = %YES# THEN RFS_DSC.MND_OPT = %YES#;
              5103                        /*Turn on the  MND_OPT bit on*/
      178     5104    2               ELSE RFS_DSC.MND_OPT = %NO#; /*Turn the MND_OPT bit off */
      179     5105    2               IF TYPE_32.MANUAL_MEM = %YES# THEN RFS_DSC.MAN_AUTO = %YES#;
      180     5106    2               RFS_DSC.DEF = TYPE_32.DEF; /*Put the DEF bits in the RFS_DSC */
      181     5107    2               RFS_DSC.NUM_CON_FIELDS = TYPE_32.NUM_CON_FIELDS;
              5107                        /*Put in the  Num_con_fld for this  set */
      182     5108    2               RFS_DSC.LFLD$=ADDR(NIL); /* Null out all the  link list ptrs */
      183     5109    2               RFS_DSC.REC$=ADDR(NIL);
      184     5110    2               RFS_DSC.SET$=ADDR(NIL);
      185     5111    2               RFS_DSC.FLD$=ADDR(NIL);
      186     5112    2               RFS_DSC.LLIST$=ADDR(NIL);
      187     5113    2               END;
      188     5114    1           ELSE IF TYPE_430.TYPE=33 THEN /*Record_Key descriptor */
      189     5115    2               DO;
      190     5116    2                   CALL ZII$FDRLDSC(TYPE_33.SUB_RECORD_NM,TYPE_33.SUB_KEY_NM,,DRFK$,
              5116                            #STORE) ALTRET(ER_FDRLDSC);
      191     5117        /********************************************************************/
      192     5118        /*Hook up the  record descriptor for the  RFS_DSC the same as  the
      193     5119          record descriptor was hooked up for the  the RA_DSC above          */
      194     5120        /*********************************************************************/
      195     5121    2                   CALL ZII$FDDESC(TYPE_33.SUB_RECORD_NM,#RECORD,DR$,#RETRIEVE,) ALTRET
              5121                            (ER_FDDESC);
      196     5122    2                   IF RECORD.RFK_DSC$=ADDR(NIL) THEN
      197     5123    3                   DO;
      198     5124    3                       RECORD.RFK_DSC$=DRFK$;
      199     5125    3                       END;
      200     5126    3                   ELSE DO;
      201     5127    3                       TDRFK$=RECORD.RFK_DSC$;
      202     5128    4                       DO WHILE(TDRFK$->RFK_DSC.REC$ ~= ADDR(NIL));
      203     5129    4                           TDRFK$=TDRFK$->RFK_DSC.REC$;
      204     5130    4                           END;
      205     5131    3                       TDRFK$->RFK_DSC.REC$=DRFK$;
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:7    
      206     5132    3                       END;
      207     5133        /********************************************************************/
      208     5134        /*Hook up the  key descriptor for the  RFS_DSC the same as  the
      209     5135          area descriptor was hooked up for the  the RA_DSC above          */
      210     5136        /*********************************************************************/
      211     5137    2                   CALL ZII$FDDESC(TYPE_33.SUB_KEY_NM,#KEY,DK$,#RETRIEVE,) ALTRET(
              5137                            ER_FDDESC);
      212     5138    2                   IF KEY.RFK_DSC$=ADDR(NIL) THEN
      213     5139    3                   DO;
      214     5140    3                       KEY.RFK_DSC$=DRFK$;
      215     5141    3                       END;
      216     5142    3                   ELSE DO;
      217     5143    3                       TDRFK$=KEY.RFK_DSC$;
      218     5144    4                       DO WHILE(TDRFK$->RFK_DSC.KEY$ ~= ADDR(NIL));
      219     5145    4                           TDRFK$=TDRFK$->RFK_DSC.KEY$;
      220     5146    4                           END;
      221     5147    3                       TDRFK$->RFK_DSC.KEY$=DRFK$;
      222     5148    3                       END;
      223     5149    2                   RFK_DSC.KEY_IDX=KEY.NAM_IDX; /*Get the key name index for NAM1 */
      224     5150    2                   RFK_DSC.REC_IDX=RECORD.NAM_IDX;
              5150                            /*Get the record name for the  NAM1 table */
      225     5151    2                   RFK_DSC.NUM_CON_FIELDS=TYPE_33.NUM_CON_FIELDS;
              5151                            /*Get the  number  fields for the  key*/
      226     5152    2                   RFK_DSC.PRIM_SEC=TYPE_33.PRIM_OR_SEC;
              5152                            /*Is this a primary or  secondary key*/
      227     5153    2                   RFK_DSC.LFLD$=ADDR(NIL); /*Null out all the pointers */
      228     5154    2                   RFK_DSC.REC$=ADDR(NIL);
      229     5155    2                   RFK_DSC.KEY$=ADDR(NIL);
      230     5156    2                   RFK_DSC.FLD$=ADDR(NIL);
      231     5157    2                   RFK_DSC.LLIST$=ADDR(NIL);
      232     5158    2                   END;
      233     5159    1               ELSE IF TYPE_430.TYPE=34 THEN /*Field_Set descriptors*/
      234     5160    2                   DO;
      235     5161    2                       IF TYPE_34.THEN_THRU_FIELD = '0'B THEN
      236     5162    3                       DO;
      237     5163    3        CALL ZII$FDRLDSC(TYPE_34.SUB_RECORD_NM,TYPE_34.SUB_SET_NM,TYPE_34.SUB_FIELD_NM,
              5163                 DRFS$,#STORE) ALTRET(ER_FDRLDSC);
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:8    
      238     5164    3                         CALL ZII$FDRLDSC(TYPE_34.SUB_RECORD_NM,TYPE_34.SUB_SET_NM,,
              5164                                  HRFS$,#RETRIEVE) ALTRET(ER_FDRLDSC);
      239     5165        /*
      240     5166          Fill in the new RFS Descriptor
      241     5167        */
      242     5168    3                           RFS_DSC.REC_IDX=HRFS$->RFS_DSC.REC_IDX;
      243     5169    3                           RFS_DSC.SET_IDX=HRFS$->RFS_DSC.SET_IDX;
      244     5170    3                     CALL ZII$FDDESC(TYPE_34.SUB_FIELD_NM,#FIELD,DF$,#RETRIEVE,TYPE_34.
              5170                              SUB_RECORD_NM) ALTRET(ER_FDDESC);
      245     5171    3                           RFS_DSC.FLD_IDX=FIELD.NAM_IDX;
      246     5172    3                           RFS_DSC.ASCEND_DESCEND=TYPE_34.ASSEND_OR_DESCEND;
      247     5173        /*
      248     5174           Set up LFLD$ to point from the linked list eminating from
      249     5175           the higher-level RFS_DSC to the current RFS_DSC containing the
      250     5176           control field from the current record and which controls the
      251     5177           current set.
      252     5178        */
      253     5179    3                           IF HRFS$->RFS_DSC.LFLD$ = ADDR(NIL) THEN
      254     5180    3                               HRFS$->RFS_DSC.LFLD$=DRFS$;
      255     5181    3                           ELSE
      256     5182    4                           DO;
      257     5183    4                               TDRFS$=HRFS$->RFS_DSC.LFLD$;
      258     5184    5                               DO WHILE(TDRFS$->RFS_DSC.LFLD$ ~= ADDR(NIL));
      259     5185    5                                   TDRFS$=TDRFS$->RFS_DSC.LFLD$;
      260     5186    5                                   END;
      261     5187    4                               TDRFS$->RFS_DSC.LFLD$=DRFS$;
      262     5188    4                               END;
      263     5189        /*
      264     5190           Set up all PTRs for this Field.
      265     5191        */
      266     5192    3                           IF NAM1.DESC$(RFS_DSC.FLD_IDX)->FIELD.RFS_DSC$=ADDR(NIL)
              5192                                    THEN
      267     5193    3                               NAM1.DESC$(RFS_DSC.FLD_IDX)->FIELD.RFS_DSC$=DRFS$;
      268     5194    3                           ELSE
      269     5195    4                           DO;
      270     5196    4                               TDRFS$=NAM1.DESC$(RFS_DSC.FLD_IDX)->FIELD.RFS_DSC$;
      271     5197    5                               DO WHILE (TDRFS$->RFS_DSC.FLD$~=ADDR(NIL));
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:9    
      272     5198    5                                   TDRFS$=TDRFS$->RFS_DSC.FLD$;
      273     5199    5                                   END;
      274     5200    4                               TDRFS$->RFS_DSC.FLD$=DRFS$;
      275     5201    4                               END;
      276     5202        /*
      277     5203           Null out all other PTRs for this RFS Descriptor.
      278     5204        */
      279     5205    3                           RFS_DSC.REC$=ADDR(NIL);
      280     5206    3                           RFS_DSC.SET$=ADDR(NIL);
      281     5207    3                           RFS_DSC.FLD$=ADDR(NIL);
      282     5208    3                           RFS_DSC.LFLD$=ADDR(NIL);
      283     5209    3                           RFS_DSC.LLIST$=ADDR(NIL);
      284     5210    3                           END;
      285     5211    2                       END;
      286     5212    1                   ELSE IF TYPE_430.TYPE=35 THEN /*Field_Key descriptor*/
      287     5213    2                       DO;
      288     5214    3                           DO;
      289     5215        /*********************************************************************/
      290     5216        /*We are now about to  link in the  "lower level" RFK_DSC descriptors
      291     5217          1. We have found the  "higher level " RFK_DSC by hashing  the  record name
      292     5218             and the set name  and get  the descriptor pointer (HRFK$)
      293     5219          2. Find the field descripotr pointer
      294     5220          3. Follow the RFK_DSC.FLD$ pointer link link until  the end is reached
      295     5221              (RFK_DSC.FLD$ equal addr(nil))
      296     5222        _  4.  Put the associated Record,Set, and Field indexes into the "lower
      297     5223                level" RFK_DSC descriptor
      298     5224           5. Then hook up the  FIELD descriptor like the  record  descriptor was hooked
      299     5225               up for the  RA_DSC
      300     5226        */
      301     5227        /****************************************************************************/
      302     5228    3                               CALL ZII$FDRLDSC(TYPE_35.SUB_RECORD_NM,TYPE_35.
              5228                                        SUB_KEY_NM,,HRFK$) ALTRET(ER_FDRLDSC);
      303     5229    3     CALL ZII$FDRLDSC(TYPE_35.SUB_RECORD_NM,TYPE_35.SUB_KEY_NM,TYPE_35.SUB_FIELD_NM,
              5229              DRFK$,#STORE) ALTRET(ER_FDRLDSC);
      304     5230    3                  CALL ZII$FDDESC(TYPE_35.SUB_FIELD_NM,#FIELD,DF$,#RETRIEVE,TYPE_35.
              5230                           SUB_RECORD_NM) ALTRET(ER_FDDESC);
      305     5231    3                               TDRFK$=HRFK$;
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:10   
      306     5232    4                               DO WHILE(TDRFK$->RFK_DSC.FLD$ ~= ADDR(NIL));
      307     5233    4                                   TDRFK$=TDRFK$->RFK_DSC.FLD$;
      308     5234    4                                   END;
      309     5235    3                               TDRFK$->RFK_DSC.FLD$=DRFK$;
      310     5236    3                               END;
      311     5237    2                           RFK_DSC.REC_IDX=HRFK$->RFK_DSC.REC_IDX;
      312     5238    2                           RFK_DSC.KEY_IDX=HRFK$->RFK_DSC.KEY_IDX;
      313     5239    2                           RFK_DSC.FLD_IDX=FIELD.NAM_IDX;
      314     5240    2                           IF FIELD.RFK_DSC$= ADDR(NIL) THEN
      315     5241    3                           DO;
      316     5242    3                               FIELD.RFK_DSC$=DRFK$;
      317     5243    3                               END;
      318     5244    3                           ELSE DO;
      319     5245    3                               TDRFK$=FIELD.RFK_DSC$;
      320     5246    4                               DO WHILE(TDRFK$->RFK_DSC.LFLD$ ~= ADDR(NIL));
      321     5247    4                                   TDRFK$=TDRFK$->RFK_DSC.LFLD$;
      322     5248    4                                   END;
      323     5249    3                               TDRFK$->RFK_DSC.LFLD$=DRFK$;
      324     5250    3                               END;
      325     5251    2                           RFK_DSC.LFLD$=ADDR(NIL);
      326     5252    2                           RFK_DSC.REC$=ADDR(NIL);
      327     5253    2                           RFK_DSC.KEY$=ADDR(NIL);
      328     5254    2                           RFK_DSC.FLD$=ADDR(NIL);
      329     5255    2                           RFK_DSC.LLIST$=ADDR(NIL);
      330     5256    2                           END;
      331     5257    1                       ELSE IF TYPE_430.TYPE=37 THEN /*Record_Parameter descriptor*/
      332     5258    2                           DO;
      333     5259    2    CALL ZII$FDRLDSC(TYPE_37.SUB_RECORD_ST_NM,TYPE_37.SUB_FIELD_NM,TYPE_37.
              5259             SUB_RECORD_NM,DRP$,#STORE) ALTRET(ER_FDRLDSC);
      334     5260    2                               CALL ZII$FDDESC(TYPE_37.SUB_RECORD_ST_NM,#RECORD,DR$,
              5260                                        #RETRIEVE) ALTRET(ER_FDDESC);
      335     5261    2                               IF RECORD.RP_DSC$=ADDR(NIL) THEN
      336     5262    3                               DO;
      337     5263    3                                   RECORD.RP_DSC$=DRP$;
      338     5264    3                                   END;
      339     5265    3                               ELSE DO;
      340     5266    3                                   TDRP$=RECORD.RP_DSC$;
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:11   
      341     5267    4                                   DO WHILE(TDRP$->RP_DSC.REC$ ~= ADDR(NIL));
      342     5268    4                                       TDRP$=TDRP$->RP_DSC.REC$;
      343     5269    4                                       END;
      344     5270    3                                   TDRP$->RP_DSC.REC$=DRP$;
      345     5271    3                                   END;
      346     5272    2                               IF TYPE_37.SUB_RECORD_NM = '*DBPARAM' THEN
      347     5273    2            CALL ZII$FDDESC(TYPE_37.SUB_FIELD_NM,#PARAM,DP$,#RETRIEVE,TYPE_37.
              5273                     SUB_RECORD_ST_NM) ALTRET(ER_FDDESC);
      348     5274    2                               ELSE
      349     5275    2               CALL ZII$FDDESC(TYPE_37.SUB_FIELD_NM,#FIELD,DP$,#RETRIEVE,TYPE_37.
              5275                        SUB_RECORD_NM) ALTRET(ER_FDDESC);
      350     5276    2                               IF DSC_PARAM.RP_DSC$=ADDR(NIL) THEN
      351     5277    3                               DO;
      352     5278    3                                   DSC_PARAM.RP_DSC$=DRP$;
      353     5279    3                                   END;
      354     5280    3                               ELSE DO;
      355     5281    3                                   TDRP$=DSC_PARAM.RP_DSC$;
      356     5282    4                                   DO WHILE(TDRP$->RP_DSC.PARAM$ ~= ADDR(NIL));
      357     5283    4                                       TDRP$=TDRP$->RP_DSC.PARAM$;
      358     5284    4                                       END;
      359     5285    3                                   TDRP$->RP_DSC.PARAM$=DRP$;
      360     5286    3                                   END;
      361     5287    2                               RP_DSC.PARAM_IDX=DSC_PARAM.NAM_IDX;
              5287                                        /*Put in the NAM1 index for the area name */
      362     5288    2                               RP_DSC.REC_IDX=RECORD.NAM_IDX;
              5288                                        /*Put in the NAM1 index for the record name */
      363     5289    2                               RP_DSC.REC$=ADDR(NIL);
              5289                                        /*Null out  all the link list pointers */
      364     5290    2                               RP_DSC.PARAM$=ADDR(NIL);
      365     5291    2                               RP_DSC.LLIST$=ADDR(NIL);
      366     5292    2                               END;
      367     5293    1                           ELSE IF TYPE_430.TYPE = 200 THEN /*Area descriptor*/
      368     5294    2                               DO;
      369     5295    2                               TMP_NAME=TYPE_200.SUB_AREA_NAME;
              5295                                        /*Move name here to get full 32 char .blank fill*/
      370     5296    2                             CALL ZII$FDDESC(TMP_NAME,#AREA,DA$,#RETRIEVE,) ALTRET(
              5296                                      ER_FDDESC); /*Find the descrp*/
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:12   
      371     5297    2                              AREA.AREA_BITS = TYPE_200.AREA_BITS;
              5297                                       /*Move in the information bits about the area*/
      372     5298    2                                   END;
      373     5299    1                               ELSE IF TYPE_430.TYPE=300 THEN /*Set    descriptor*/
      374     5300    2                                   DO;
      375     5301    2                                       IF TYPE_300.SUB_SET_NAME = ' ' THEN TMP_NAME=
              5301                                                TYPE_300.SET_NAME;
      376     5302    2                                       ELSE TMP_NAME=TYPE_300.SUB_SET_NAME;
      377     5303    2                                       CALL ZII$FDDESC(TMP_NAME,#SET,DS$,#RETRIEVE,)
              5303                                                ALTRET(ER_FDDESC);
      378     5304    2                                       SET.FLAG_BITS=TYPE_300.FLAGS.INFO_BITS;
      379     5305    2                                       END;
      380     5306    1                                   ELSE IF TYPE_430.TYPE=400 THEN
              5306                                            /*Record  descriptor*/
      381     5307    2                                       DO;
      382     5308    2                                       IF TYPE_400.SUB_RECORD_NAME = ' ' THEN TMP_NAME=
              5308                                                TYPE_400.RECORD_NAME;
      383     5309    2                                           ELSE TMP_NAME=TYPE_400.SUB_RECORD_NAME;
      384     5310    2                                         CALL ZII$FDDESC(TMP_NAME,#RECORD,DR$,#RETRIEVE
              5310                                                  ,) ALTRET(ER_FDDESC);
      385     5311    2                                           RECORD.FLAG_BITS=TYPE_400.FLAGS.INFO_BITS;
      386     5312    2                                           END;
      387     5313    1                                       ELSE IF TYPE_430.TYPE = 430 THEN
              5313                                                /*Field descriptor*/
      388     5314    2                                           DO;
      389     5315    2                                      IF TYPE_430.SUB_FIELD_NAME = ' ' THEN TMP_NAME=
              5315                                               TYPE_430.FIELD_NAME;
      390     5316    2                                               ELSE TMP_NAME=TYPE_430.SUB_FIELD_NAME;
      391     5317    2    CALL ZII$FDDESC(TMP_NAME,#FIELD,DF$,#RETRIEVE,NAM1.NAME.TEXT(DR$->RECORD.NAM_IDX))
              5317             ALTRET(ER_FDDESC);
      392     5318    2                                               IF TYPE_430.PRIMARY_CON_FIELD = %YES#
              5318                                                        THEN
      393     5319    3                                               DO;
      394     5320    3                                                   DR$=NAM1.DESC$(FIELD.REC_ASSC_IDX);
      395     5321    3                                                   FIELD.CALC_FLD#=RECORD.NUM_CALC_FLDS
              5321                                                            +1;
      396     5322    3                                                   RECORD.NUM_CALC_FLDS=RECORD.
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:13   
              5322                                                            NUM_CALC_FLDS+1;
      397     5323    3                                                   END;
      398     5324    2                                               ELSE FIELD.CALC_FLD#=0;
      399     5325    2                                               FIELD.EIS_BITS=TYPE_430.EIS.EIS_BITS;
      400     5326    2                                               FIELD.FLAGS_2.ELEM=TYPE_430.ELEMENTARY;
      401     5327    2                                               FIELD.FLAGS_2.DATA_TYPE=TYPE_430.
              5327                                                        DATA_TYPE;
      402     5328    2                                               FIELD.FLAG_BITS_1=TYPE_430.FLAGS;
      403     5329    2                                               IF TYPE_430.FLAGS.TYPE~='111111111111'B
              5329                                                        AND
      404     5330    2                                                  TYPE_430.FLAGS.TYPE~='111111111110'B
              5330                                                           THEN
      405     5331    3                                               DO;
      406     5332    3                                                   CALL ZII$GET_RVA(#FIELD);
      407     5333    3                                                   FIELD.RVA_OFF=RVE_IDX;
      408     5334    3                                                   END;
      409     5335    2                                               END;
      410     5336    1   RET:
      411     5337    1       RETURN;
      412     5338    1   ER_FDDESC:
      413     5339        /*************************************************************/
      414     5340        /*E*
      415     5341           ERROR: ZII-#BADDESC-C
      416     5342           MESSAGE: Cannot find  NAM2 descriptor for subschema %U1.
      417     5343        */
      418     5344        /***********************************************************/
      419     5345    1       ERROR_CODE=#BADDESC;
      420     5346    1       GOTO COM_ERR;
      421     5347    1   ER_FDRLDSC:
      422     5348        /*************************************************************/
      423     5349        /*E*
      424     5350           ERROR: ZII-#BADLNKRECSET-C
      425     5351           MESSAGE: Cannot  find  relationship descriptor in NAM2 for subschema %U1.
      426     5352        */
      427     5353        /************************************************************/
      428     5354    1       ERROR_CODE=#BADLNKRECSET;
      429     5355    1       GOTO COM_ERR;
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:14   
      430     5356    1   COM_ERR:
      431     5357    1       ALTRETURN;
      432     5358    1   END ZII$ADD_NAM;

PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:15   
--  Include file information  --

   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZI$DESC.:ZIC0TOU  is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   ZI$USER.:ZIC0TOU  is referenced.
   ZI$STRUCTS.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZII$ADD_NAM.

   Procedure ZII$ADD_NAM requires 883 words for executable code.
   Procedure ZII$ADD_NAM requires 26 words of local(AUTO) storage.

    No errors detected in file ZII$ADD_NAM.:ZIC0TSI    .

PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:16   

 Object Unit name= ZII$ADD_NAM                                File name= ZII$ADD_NAM.:ZIC0TOU
 UTS= SEP 05 '97 12:24:43.04 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ERROR_CODE
    1  LblCom even  none     1      1  REC$
    2  LblCom even  none     1      1  RVA_SIZ
    3  LblCom even  none     1      1  RVE_IDX
    4  LblCom even  none     1      1  NAM1$
    5  LblCom even  none     1      1  NAM1_SIZ
    6  LblCom even  none     1      1  NAM1_IDX
    7  LblCom even  none     1      1  NAM2$
    8  LblCom even  none     1      1  NAM2_SIZ
    9  LblCom even  none     1      1  DESC#
   10  LblCom even  none     1      1  RVA$
   11  LblCom even  none     1      1  DA$
   12  LblCom even  none     1      1  DR$
   13  LblCom even  none     1      1  DS$
   14  LblCom even  none     1      1  DK$
   15  LblCom even  none     1      1  DRFS$
   16  LblCom even  none     1      1  DRFK$
   17  LblCom even  none     1      1  DRA$
   18  LblCom even  none     1      1  DRP$
   19  LblCom even  none     1      1  DD$
   20  LblCom even  none     1      1  DF$
   21  LblCom even  none     1      1  DP$
   22  RoData even  UTS      2      2  ZII$ADD_NAM
   23   Proc  even  none   883   1563  ZII$ADD_NAM
   24  RoData even  none    38     46  ZII$ADD_NAM
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:17   

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    23      0   yes    yes     yes      XStd       0  ZII$ADD_NAM

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           XStd      5 ZII$FDRLDSC
 yes     yes           XStd      5 ZII$FDDESC
         yes           XStd      1 ZII$GET_RVA
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:18   


        1        1        /*M*       ZII$ADD_NAM            I-D-S/II INTERFACE MODULE*/
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8          NAME:  ZII$ADD_NAM
        9        9          PURPOSE: This module is used to add information to tables
       10       10                   NAM1 & NAM2 when certain types of descriptors are encountered
       11       11                   in the Subschema file*/
       12       12        /************************************************************/
       13       13        ZII$ADD_NAM: PROC ALTRET AVOID($PR5,$PR6,$PR7);

     13 23 000000   000000 700200 xent  ZII$ADD_NAM  TSX0  ! X66_AUTO_0
        23 000001   000032 000000                    ZERO    26,0

       14       14        /********************Auto dcls*******************/
       15       15    1   DCL TDRFS$ PTR;
       16       16    1   DCL HRFS$ PTR;
       17       17    1   DCL TDRFK$ PTR;
       18       18    1   DCL TDRP$ PTR;
       19       19    1   DCL HRFK$ PTR;
       20       20    1   DCL TDRA$ PTR;
       21       21    1   DCL I UBIN(36);
       22       22    1   DCL TMP_NAME CHAR(32) ALIGNED;
       23       23    1   DCL TMP_RVA_SIZ UBIN AUTO;
       24       24        /*******************Ext   dcls*******************/
       25       25    1   DCL ERROR_CODE UBIN(36) EXT;
       26       26    1   DCL REC$ PTR EXT;
       27       27    1   DCL RVA_SIZ UBIN(36) EXT;
       28       28    1   DCL RVE_IDX UBIN(18) EXT;
       29       29        /*******************Entry dcls******************/
       30       30    1   DCL ZII$FDDESC ENTRY(5) ALTRET;
       31       31    1   DCL ZII$LNKDSC ENTRY(7);
       32       32    1   DCL ZII$FDRLDSC ENTRY(5) ALTRET;
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:19   
       33       33    1   DCL ZII$GET_RVA ENTRY(1);
       34       34        /*********************Include files**************/
       35       35        %INCLUDE CP_6_SUBS;
       36      575        %INCLUDE ZI$STRUCTS;
       37      647        %NAM1;
       38      676        %NAM2;
       39      690        %INCLUDE ZI$USER;
       40      835        %RVA (STCLASS="EXT");
       41      848        %INCLUDE ZI_SUB_LANG;
       42     2563        %DESC_TYPE_31 (STCLASS="BASED(REC$)");
       43     2605        %DESC_TYPE_32 (STCLASS="BASED(REC$)");
       44     2671        %DESC_TYPE_33 (STCLASS="BASED(REC$)");
       45     2716        %DESC_TYPE_34 (STCLASS="BASED(REC$)");
       46     2764        %DESC_TYPE_35 (STCLASS="BASED(REC$)");
       47     2803        %DESC_TYPE_37 (STCLASS="BASED(REC$)");
       48     2843        %DESC_TYPE_110 (STCLASS="BASED(REC$)");
       49     2907        %DESC_TYPE_200 (STCLASS="BASED(REC$)");
       50     2960        %DESC_TYPE_300 (STCLASS="BASED(REC$)");
       51     3029        %DESC_TYPE_400 (STCLASS="BASED(REC$)");
       52     3088        %DESC_TYPE_420 (STCLASS="BASED(REC$)");
       53     3121        %DESC_TYPE_430 (STCLASS="BASED(REC$)");
       54     3280        %INCLUDE ZI$DESC;
       55     4130        %DSC_AREA;
       56     4152        %DSC_REC;
       57     4186        %DSC_SET;
       58     4228        %DSC_KEY;
       59     4238        %DSC_RFS;
       60     4283        %DSC_RFK;
       61     4299        %DSC_RA;
       62     4314        %DSC_RP;
       63     4324        %DSC_DESC;
       64     4332        %DSC_FLD;
       65     4447        %DSC_PARAM;
       66     4464        %TYPE_SUBS;
       67     4474        %INCLUDE ZI_ERRORS_SUBS;
       68     4994        /*******************Program procedure************/
       69     4995    1       TMP_NAME=' ';
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:20   

   4995 23 000002   040100 100400                    MLR     fill='040'O
        23 000003   000000 000001 24                 ADSC9   0                        cn=0,n=1
        23 000004   200012 000040                    ADSC9   TMP_NAME,,AUTO           cn=0,n=32

       70     4996    1       IF TYPE_430.TYPE=31 THEN /*Record_Area descriptor*/

   4996 23 000005   000000 470400 1                  LDP0    REC$
        23 000006   000100 100500                    MLR     fill='000'O
        23 000007   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
        23 000010   200024 000004                    ADSC9   TMP_RVA_SIZ+2,,AUTO      cn=0,n=4
        23 000011   200024 236100                    LDQ     TMP_RVA_SIZ+2,,AUTO
        23 000012   000037 116007                    CMPQ    31,DL
        23 000013   000155 601000 23                 TNZ     s:5060

       71     4997    2       DO;

       72     4998    2           CALL ZII$FDRLDSC(TYPE_31.SUB_RECORD_NM,TYPE_31.SUB_AREA_NM,,DRA$,#STORE)
              4998                    ALTRET(ER_FDRLDSC);

   4998 23 000014   000004 236000 24                 LDQ     4
        23 000015   200030 756100                    STQ     TMP_RVA_SIZ+6,,AUTO
        23 000016   000005 236000 24                 LDQ     5
        23 000017   000002 235000 24                 LDA     2
        23 000020   200026 757100                    STAQ    TMP_RVA_SIZ+4,,AUTO
        23 000021   000000 236000 1                  LDQ     REC$
        23 000022   000015 036003                    ADLQ    13,DU
        23 000023   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 000024   000000 236000 1                  LDQ     REC$
        23 000025   000005 036003                    ADLQ    5,DU
        23 000026   200024 756100                    STQ     TMP_RVA_SIZ+2,,AUTO
        23 000027   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 000030   000001 631400 24                 EPPR1   1
        23 000031   000000 701000 xent               TSX1    ZII$FDRLDSC
        23 000032   001557 702000 23                 TSX2    ER_FDRLDSC

       73     4999        /***********************************************************************/
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:21   
       74     5000        /*Procedure to link in an RA_DSC to a link list for the record
       75     5001                 1. Find the  record descriptor.
       76     5002                 2. Test to see if this is  the 1st RA_DSC to be linked
       77     5003                     into the link list for this particular record.
       78     5004                    a. If it is, modify the RECORD.RA_DSC$ to point  to the
       79     5005                        RA_DSC descrptoriptor that  is about to be built.
       80     5006                    b. If it is not,
       81     5007                       1. get the pointer to the 1st RA_DSC for the record descriptor
       82     5008                      2. keep following the RA_DSC.REC$ link list until the end of the list
       83     5009                           is reached(RA_DSC.REC$ equals ADDR(nil))
       84     5010                    3. hook up the RA_DSC that is about to be built to the end of the chain
       85     5011        */
       86     5012        /***********************************************************************/
       87     5013    2           CALL ZII$FDDESC(TYPE_31.SUB_RECORD_NM,#RECORD,DR$,#RETRIEVE,) ALTRET(
              5013                    ER_FDDESC);

   5013 23 000033   000012 237000 24                 LDAQ    10
        23 000034   200026 757100                    STAQ    TMP_RVA_SIZ+4,,AUTO
        23 000035   000011 236000 24                 LDQ     9
        23 000036   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 000037   000000 236000 1                  LDQ     REC$
        23 000040   000005 036003                    ADLQ    5,DU
        23 000041   200024 756100                    STQ     TMP_RVA_SIZ+2,,AUTO
        23 000042   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 000043   000006 631400 24                 EPPR1   6
        23 000044   000000 701000 xent               TSX1    ZII$FDDESC
        23 000045   001554 702000 23                 TSX2    ER_FDDESC

       88     5014    2           IF RECORD.RA_DSC$=ADDR(NIL) THEN

   5014 23 000046   000000 470400 12                 LDP0    DR$
        23 000047   000003 236100                    LDQ     3,,PR0
        23 000050   000002 116000 24                 CMPQ    2
        23 000051   000055 601000 23                 TNZ     s:5019

       89     5015    3           DO;

PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:22   
       90     5016    3               RECORD.RA_DSC$=DRA$;

   5016 23 000052   000000 236000 17                 LDQ     DRA$
        23 000053   000003 756100                    STQ     3,,PR0

       91     5017    3               END;

   5017 23 000054   000070 710000 23                 TRA     s:5039

       92     5018    3           ELSE DO;

       93     5019    3               TDRA$=RECORD.RA_DSC$;

   5019 23 000055   200010 756100                    STQ     TDRA$,,AUTO

       94     5020    4               DO WHILE(TDRA$->RA_DSC.REC$ ~= ADDR(NIL));

   5020 23 000056   000062 710000 23                 TRA     s:5022

       95     5021    4                   TDRA$=TDRA$->RA_DSC.REC$;

   5021 23 000057   200010 470500                    LDP0    TDRA$,,AUTO
        23 000060   000006 236100                    LDQ     6,,PR0
        23 000061   200010 756100                    STQ     TDRA$,,AUTO

       96     5022    4                   END;

   5022 23 000062   200010 470500                    LDP0    TDRA$,,AUTO
        23 000063   000006 236100                    LDQ     6,,PR0
        23 000064   000002 116000 24                 CMPQ    2
        23 000065   000057 601000 23                 TNZ     s:5021

       97     5023    3               TDRA$->RA_DSC.REC$=DRA$;

   5023 23 000066   000000 236000 17                 LDQ     DRA$
        23 000067   000006 756100                    STQ     6,,PR0

PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:23   
       98     5024    3               END;

       99     5025        /***********************************************************************/
      100     5026        /*Procedure to link in an RA_DSC to a link list for the area
      101     5027                 1. Find the  area descriptor.
      102     5028                 2. Test to see if this is  the 1st RA_DSC to be linked
      103     5029                     into the link list for this particular area.
      104     5030                    a. If it is, modify the AREA.RA_DSC$ to point  to the
      105     5031                        RA_DSC descrptoriptor that  is about to be built.
      106     5032                    b. If it is not,
      107     5033                       1. get the pointer to the 1st RA_DSC for the area descriptor
      108     5034                     2. keep following the RA_DSC.AREA$ link list until the end of the list
      109     5035                           is reached(RA_DSC.AREA$ equals ADDR(nil))
      110     5036                    3. hook up the RA_DSC that is about to be built to the end of the chain
      111     5037        */
      112     5038        /***********************************************************************/
      113     5039    2          CALL ZII$FDDESC(TYPE_31.SUB_AREA_NM,#AREA,DA$,#RETRIEVE,) ALTRET(ER_FDDESC);

   5039 23 000070   000014 237000 24                 LDAQ    12
        23 000071   200026 757100                    STAQ    TMP_RVA_SIZ+4,,AUTO
        23 000072   000013 236000 24                 LDQ     11
        23 000073   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 000074   000000 236000 1                  LDQ     REC$
        23 000075   000015 036003                    ADLQ    13,DU
        23 000076   200024 756100                    STQ     TMP_RVA_SIZ+2,,AUTO
        23 000077   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 000100   000006 631400 24                 EPPR1   6
        23 000101   000000 701000 xent               TSX1    ZII$FDDESC
        23 000102   001554 702000 23                 TSX2    ER_FDDESC

      114     5040    2           IF AREA.RA_DSC$=ADDR(NIL) THEN

   5040 23 000103   000000 470400 11                 LDP0    DA$
        23 000104   000006 236100                    LDQ     6,,PR0
        23 000105   000002 116000 24                 CMPQ    2
        23 000106   000112 601000 23                 TNZ     s:5045

PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:24   
      115     5041    3           DO;

      116     5042    3               AREA.RA_DSC$=DRA$;

   5042 23 000107   000000 236000 17                 LDQ     DRA$
        23 000110   000006 756100                    STQ     6,,PR0

      117     5043    3               END;

   5043 23 000111   000125 710000 23                 TRA     s:5051

      118     5044    3           ELSE DO;

      119     5045    3               TDRA$=AREA.RA_DSC$;

   5045 23 000112   200010 756100                    STQ     TDRA$,,AUTO

      120     5046    4               DO WHILE(TDRA$->RA_DSC.AREA$ ~= ADDR(NIL));

   5046 23 000113   000117 710000 23                 TRA     s:5048

      121     5047    4                   TDRA$=TDRA$->RA_DSC.AREA$;

   5047 23 000114   200010 470500                    LDP0    TDRA$,,AUTO
        23 000115   000007 236100                    LDQ     7,,PR0
        23 000116   200010 756100                    STQ     TDRA$,,AUTO

      122     5048    4                   END;

   5048 23 000117   200010 470500                    LDP0    TDRA$,,AUTO
        23 000120   000007 236100                    LDQ     7,,PR0
        23 000121   000002 116000 24                 CMPQ    2
        23 000122   000114 601000 23                 TNZ     s:5047

      123     5049    3               TDRA$->RA_DSC.AREA$=DRA$;

   5049 23 000123   000000 236000 17                 LDQ     DRA$
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:25   
        23 000124   000007 756100                    STQ     7,,PR0

      124     5050    3               END;

      125     5051    2           RA_DSC.AREA_IDX=AREA.NAM_IDX; /*Put in the NAM1 index for the area name */

   5051 23 000125   000000 470400 11                 LDP0    DA$
        23 000126   000000 220100                    LDX0    0,,PR0
        23 000127   000000 471400 17                 LDP1    DRA$
        23 000130   100000 440100                    SXL0    0,,PR1

      126     5052    2           RA_DSC.REC_IDX=RECORD.NAM_IDX;
              5052                    /*Put in the NAM1 index for the record name */

   5052 23 000131   000000 470400 12                 LDP0    DR$
        23 000132   000000 220100                    LDX0    0,,PR0
        23 000133   000000 471400 17                 LDP1    DRA$
        23 000134   100000 740100                    STX0    0,,PR1

      127     5053    2           RA_DSC.LO_DBK_RNG=TYPE_31.LO_DBK_RNG;
              5053                    /*Get the  low DBK range for the record in this area*/

   5053 23 000135   000000 470400 1                  LDP0    REC$
        23 000136   000000 471400 17                 LDP1    DRA$
        23 000137   000100 100500                    MLR     fill='000'O
        23 000140   000025 000004                    ADSC9   21,,PR0                  cn=0,n=4
        23 000141   100001 000004                    ADSC9   1,,PR1                   cn=0,n=4

      128     5054    2           RA_DSC.HI_DBK_RNG=TYPE_31.HI_DBK_RNG;
              5054                    /*Get the high DBK range for the record in this area*/

   5054 23 000142   000100 100500                    MLR     fill='000'O
        23 000143   000026 000004                    ADSC9   22,,PR0                  cn=0,n=4
        23 000144   100002 000004                    ADSC9   2,,PR1                   cn=0,n=4

      129     5055    2           RA_DSC.FLAGS=TYPE_31.FLAGS; /*Put in the  flags for the RA_DSC,. */

PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:26   
   5055 23 000145   000100 100500                    MLR     fill='000'O
        23 000146   000027 000004                    ADSC9   23,,PR0                  cn=0,n=4
        23 000147   100003 000004                    ADSC9   3,,PR1                   cn=0,n=4

      130     5056    2           RA_DSC.REC$=ADDR(NIL); /*Null out  all the link list pointers */

   5056 23 000150   000002 236000 24                 LDQ     2
        23 000151   100006 756100                    STQ     6,,PR1

      131     5057    2           RA_DSC.AREA$=ADDR(NIL);

   5057 23 000152   100007 756100                    STQ     7,,PR1

      132     5058    2           RA_DSC.LLIST$=ADDR(NIL);

   5058 23 000153   100010 756100                    STQ     8,,PR1

      133     5059    2           END;

   5059 23 000154   001553 710000 23                 TRA     RET

      134     5060    1       ELSE IF TYPE_430.TYPE=32 THEN /*Record_Set descriptors*/

   5060 23 000155   000100 100500                    MLR     fill='000'O
        23 000156   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
        23 000157   200024 000004                    ADSC9   TMP_RVA_SIZ+2,,AUTO      cn=0,n=4
        23 000160   200024 236100                    LDQ     TMP_RVA_SIZ+2,,AUTO
        23 000161   000040 116007                    CMPQ    32,DL
        23 000162   000364 601000 23                 TNZ     s:5114

      135     5061    2           DO;

      136     5062    2              CALL ZII$FDRLDSC(TYPE_32.SUB_RECORD_NM,TYPE_32.SUB_SET_NM,,DRFS$,#STORE)
              5062                        ALTRET(ER_FDRLDSC);

   5062 23 000163   000004 236000 24                 LDQ     4
        23 000164   200030 756100                    STQ     TMP_RVA_SIZ+6,,AUTO
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:27   
        23 000165   000016 236000 24                 LDQ     14
        23 000166   000002 235000 24                 LDA     2
        23 000167   200026 757100                    STAQ    TMP_RVA_SIZ+4,,AUTO
        23 000170   000000 236000 1                  LDQ     REC$
        23 000171   000015 036003                    ADLQ    13,DU
        23 000172   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 000173   000000 236000 1                  LDQ     REC$
        23 000174   000005 036003                    ADLQ    5,DU
        23 000175   200024 756100                    STQ     TMP_RVA_SIZ+2,,AUTO
        23 000176   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 000177   000001 631400 24                 EPPR1   1
        23 000200   000000 701000 xent               TSX1    ZII$FDRLDSC
        23 000201   001557 702000 23                 TSX2    ER_FDRLDSC

      137     5063        /********************************************************************/
      138     5064        /*Hook up the  record descriptor for the  RFS_DSC the same as  the
      139     5065          record descriptor was hooked up for the  the RA_DSC above          */
      140     5066        /*********************************************************************/
      141     5067    2               CALL ZII$FDDESC(TYPE_32.SUB_RECORD_NM,#RECORD,DR$,#RETRIEVE,) ALTRET(
              5067                        ER_FDDESC);

   5067 23 000202   000012 237000 24                 LDAQ    10
        23 000203   200026 757100                    STAQ    TMP_RVA_SIZ+4,,AUTO
        23 000204   000011 236000 24                 LDQ     9
        23 000205   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 000206   000000 236000 1                  LDQ     REC$
        23 000207   000005 036003                    ADLQ    5,DU
        23 000210   200024 756100                    STQ     TMP_RVA_SIZ+2,,AUTO
        23 000211   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 000212   000006 631400 24                 EPPR1   6
        23 000213   000000 701000 xent               TSX1    ZII$FDDESC
        23 000214   001554 702000 23                 TSX2    ER_FDDESC

      142     5068    2               IF RECORD.RFS_DSC$=ADDR(NIL) THEN

   5068 23 000215   000000 470400 12                 LDP0    DR$
        23 000216   000006 236100                    LDQ     6,,PR0
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:28   
        23 000217   000002 116000 24                 CMPQ    2
        23 000220   000224 601000 23                 TNZ     s:5073

      143     5069    3               DO;

      144     5070    3                   RECORD.RFS_DSC$=DRFS$;

   5070 23 000221   000000 236000 15                 LDQ     DRFS$
        23 000222   000006 756100                    STQ     6,,PR0

      145     5071    3                   END;

   5071 23 000223   000237 710000 23                 TRA     s:5083

      146     5072    3               ELSE DO;

      147     5073    3                   TDRFS$=RECORD.RFS_DSC$;

   5073 23 000224   200003 756100                    STQ     TDRFS$,,AUTO

      148     5074    4                   DO WHILE(TDRFS$->RFS_DSC.REC$ ~= ADDR(NIL));

   5074 23 000225   000231 710000 23                 TRA     s:5076

      149     5075    4                       TDRFS$=TDRFS$->RFS_DSC.REC$;

   5075 23 000226   200003 470500                    LDP0    TDRFS$,,AUTO
        23 000227   000005 236100                    LDQ     5,,PR0
        23 000230   200003 756100                    STQ     TDRFS$,,AUTO

      150     5076    4                       END;

   5076 23 000231   200003 470500                    LDP0    TDRFS$,,AUTO
        23 000232   000005 236100                    LDQ     5,,PR0
        23 000233   000002 116000 24                 CMPQ    2
        23 000234   000226 601000 23                 TNZ     s:5075

PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:29   
      151     5077    3                   TDRFS$->RFS_DSC.REC$=DRFS$;

   5077 23 000235   000000 236000 15                 LDQ     DRFS$
        23 000236   000005 756100                    STQ     5,,PR0

      152     5078    3                   END;

      153     5079        /********************************************************************/
      154     5080        /*Hook up the  set descriptor for the  RFS_DSC the same as  the
      155     5081          area descriptor was hooked up for the  the RA_DSC above          */
      156     5082        /*********************************************************************/
      157     5083    2              CALL ZII$FDDESC(TYPE_32.SUB_SET_NM,#SET,DS$,#RETRIEVE,) ALTRET(ER_FDDESC
              5083                        );

   5083 23 000237   000020 237000 24                 LDAQ    16
        23 000240   200026 757100                    STAQ    TMP_RVA_SIZ+4,,AUTO
        23 000241   000022 236000 24                 LDQ     18
        23 000242   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 000243   000000 236000 1                  LDQ     REC$
        23 000244   000015 036003                    ADLQ    13,DU
        23 000245   200024 756100                    STQ     TMP_RVA_SIZ+2,,AUTO
        23 000246   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 000247   000006 631400 24                 EPPR1   6
        23 000250   000000 701000 xent               TSX1    ZII$FDDESC
        23 000251   001554 702000 23                 TSX2    ER_FDDESC

      158     5084    2               IF SET.RFS_DSC$=ADDR(NIL) THEN

   5084 23 000252   000000 470400 13                 LDP0    DS$
        23 000253   000007 236100                    LDQ     7,,PR0
        23 000254   000002 116000 24                 CMPQ    2
        23 000255   000261 601000 23                 TNZ     s:5089

      159     5085    3               DO;

      160     5086    3                   SET.RFS_DSC$=DRFS$;

PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:30   
   5086 23 000256   000000 236000 15                 LDQ     DRFS$
        23 000257   000007 756100                    STQ     7,,PR0

      161     5087    3                   END;

   5087 23 000260   000274 710000 23                 TRA     s:5095

      162     5088    3               ELSE DO;

      163     5089    3                   TDRFS$=SET.RFS_DSC$;

   5089 23 000261   200003 756100                    STQ     TDRFS$,,AUTO

      164     5090    4                   DO WHILE(TDRFS$->RFS_DSC.SET$ ~= ADDR(NIL));

   5090 23 000262   000266 710000 23                 TRA     s:5092

      165     5091    4                       TDRFS$=TDRFS$->RFS_DSC.SET$;

   5091 23 000263   200003 470500                    LDP0    TDRFS$,,AUTO
        23 000264   000006 236100                    LDQ     6,,PR0
        23 000265   200003 756100                    STQ     TDRFS$,,AUTO

      166     5092    4                       END;

   5092 23 000266   200003 470500                    LDP0    TDRFS$,,AUTO
        23 000267   000006 236100                    LDQ     6,,PR0
        23 000270   000002 116000 24                 CMPQ    2
        23 000271   000263 601000 23                 TNZ     s:5091

      167     5093    3                   TDRFS$->RFS_DSC.SET$=DRFS$;

   5093 23 000272   000000 236000 15                 LDQ     DRFS$
        23 000273   000006 756100                    STQ     6,,PR0

      168     5094    3                   END;

PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:31   
      169     5095    2               RFS_DSC.REC_IDX=RECORD.NAM_IDX;
              5095                        /*Put in the  NAM1 index for the  record name*/

   5095 23 000274   000000 470400 12                 LDP0    DR$
        23 000275   000000 220100                    LDX0    0,,PR0
        23 000276   000000 471400 15                 LDP1    DRFS$
        23 000277   100000 740100                    STX0    0,,PR1

      170     5096    2              RFS_DSC.SET_IDX=SET.NAM_IDX; /*Put in the NAM1 index for the set name */

   5096 23 000300   000000 470400 13                 LDP0    DS$
        23 000301   000000 220100                    LDX0    0,,PR0
        23 000302   000000 471400 15                 LDP1    DRFS$
        23 000303   100000 440100                    SXL0    0,,PR1

      171     5097    2               IF TYPE_32.OWNER = %YES# THEN
              5097                        /*Is this record name in the type 32 the owner of the set?*/

   5097 23 000304   000000 470400 1                  LDP0    REC$
        23 000305   000000 066500                    CMPB    filb='0'B
        23 000306   000004 000001                    BDSC    4,,PR0                   by=0,bit=0,n=1
        23 000307   000010 000022 24                 BDSC    8                        by=0,bit=0,n=18
        23 000310   000317 600000 23                 TZE     s:5102

      172     5098    3               DO; /*yes */

      173     5099    3                   SET.OWNER_IDX=RFS_DSC.REC_IDX;
              5099                            /*Update the  set descriptor to put in the  record NAM1 index*/

   5099 23 000311   000000 471400 15                 LDP1    DRFS$
        23 000312   100000 220100                    LDX0    0,,PR1
        23 000313   000000 473400 13                 LDP3    DS$
        23 000314   300001 740100                    STX0    1,,PR3

      174     5100    3                   RFS_DSC.OWN_MEM=%NO#;
              5100                            /*Update the RFS_DSC to  turn OWN_MEM bit off */

PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:32   
   5100 23 000315   000023 236000 24                 LDQ     19
        23 000316   100001 356100                    ANSQ    1,,PR1

      175     5101    3                   END;

      176     5102    2               IF TYPE_32.MEMBER = %YES# THEN RFS_DSC.OWN_MEM= %YES#;
              5102                        /*Turn the  OWN_MEM bit on*/

   5102 23 000317   000000 066500                    CMPB    filb='0'B
        23 000320   000004 010001                    BDSC    4,,PR0                   by=0,bit=1,n=1
        23 000321   000010 000022 24                 BDSC    8                        by=0,bit=0,n=18
        23 000322   000326 600000 23                 TZE     s:5103

   5102 23 000323   000000 471400 15                 LDP1    DRFS$
        23 000324   400000 236007                    LDQ     -131072,DL
        23 000325   100001 256100                    ORSQ    1,,PR1

      177     5103    2               IF TYPE_32.OPTIONAL_MEM = %YES# THEN RFS_DSC.MND_OPT = %YES#;
              5103                        /*Turn on the  MND_OPT bit on*/

   5103 23 000326   000000 066500                    CMPB    filb='0'B
        23 000327   000004 020001                    BDSC    4,,PR0                   by=0,bit=2,n=1
        23 000330   000010 000022 24                 BDSC    8                        by=0,bit=0,n=18
        23 000331   000336 600000 23                 TZE     s:5104

   5103 23 000332   000000 471400 15                 LDP1    DRFS$
        23 000333   100000 236007                    LDQ     32768,DL
        23 000334   100001 256100                    ORSQ    1,,PR1
        23 000335   000341 710000 23                 TRA     s:5105

      178     5104    2               ELSE RFS_DSC.MND_OPT = %NO#; /*Turn the MND_OPT bit off */

   5104 23 000336   000000 471400 15                 LDP1    DRFS$
        23 000337   000024 236000 24                 LDQ     20
        23 000340   100001 356100                    ANSQ    1,,PR1

      179     5105    2               IF TYPE_32.MANUAL_MEM = %YES# THEN RFS_DSC.MAN_AUTO = %YES#;
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:33   

   5105 23 000341   000000 066500                    CMPB    filb='0'B
        23 000342   000004 030001                    BDSC    4,,PR0                   by=0,bit=3,n=1
        23 000343   000010 000022 24                 BDSC    8                        by=0,bit=0,n=18
        23 000344   000347 600000 23                 TZE     s:5106

   5105 23 000345   200000 236007                    LDQ     65536,DL
        23 000346   100001 256100                    ORSQ    1,,PR1

      180     5106    2               RFS_DSC.DEF = TYPE_32.DEF; /*Put the DEF bits in the RFS_DSC */

   5106 23 000347   000100 100500                    MLR     fill='000'O
        23 000350   000025 000004                    ADSC9   21,,PR0                  cn=0,n=4
        23 000351   100002 000004                    ADSC9   2,,PR1                   cn=0,n=4

      181     5107    2               RFS_DSC.NUM_CON_FIELDS = TYPE_32.NUM_CON_FIELDS;
              5107                        /*Put in the  Num_con_fld for this  set */

   5107 23 000352   000100 100500                    MLR     fill='000'O
        23 000353   000026 000004                    ADSC9   22,,PR0                  cn=0,n=4
        23 000354   100003 000004                    ADSC9   3,,PR1                   cn=0,n=4

      182     5108    2               RFS_DSC.LFLD$=ADDR(NIL); /* Null out all the  link list ptrs */

   5108 23 000355   000002 236000 24                 LDQ     2
        23 000356   100004 756100                    STQ     4,,PR1

      183     5109    2               RFS_DSC.REC$=ADDR(NIL);

   5109 23 000357   100005 756100                    STQ     5,,PR1

      184     5110    2               RFS_DSC.SET$=ADDR(NIL);

   5110 23 000360   100006 756100                    STQ     6,,PR1

      185     5111    2               RFS_DSC.FLD$=ADDR(NIL);

PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:34   
   5111 23 000361   100007 756100                    STQ     7,,PR1

      186     5112    2               RFS_DSC.LLIST$=ADDR(NIL);

   5112 23 000362   100010 756100                    STQ     8,,PR1

      187     5113    2               END;

   5113 23 000363   001553 710000 23                 TRA     RET

      188     5114    1           ELSE IF TYPE_430.TYPE=33 THEN /*Record_Key descriptor */

   5114 23 000364   000100 100500                    MLR     fill='000'O
        23 000365   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
        23 000366   200024 000004                    ADSC9   TMP_RVA_SIZ+2,,AUTO      cn=0,n=4
        23 000367   200024 236100                    LDQ     TMP_RVA_SIZ+2,,AUTO
        23 000370   000041 116007                    CMPQ    33,DL
        23 000371   000532 601000 23                 TNZ     s:5159

      189     5115    2               DO;

      190     5116    2                   CALL ZII$FDRLDSC(TYPE_33.SUB_RECORD_NM,TYPE_33.SUB_KEY_NM,,DRFK$,
              5116                            #STORE) ALTRET(ER_FDRLDSC);

   5116 23 000372   000004 236000 24                 LDQ     4
        23 000373   200030 756100                    STQ     TMP_RVA_SIZ+6,,AUTO
        23 000374   000025 236000 24                 LDQ     21
        23 000375   000002 235000 24                 LDA     2
        23 000376   200026 757100                    STAQ    TMP_RVA_SIZ+4,,AUTO
        23 000377   000000 236000 1                  LDQ     REC$
        23 000400   000015 036003                    ADLQ    13,DU
        23 000401   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 000402   000000 236000 1                  LDQ     REC$
        23 000403   000005 036003                    ADLQ    5,DU
        23 000404   200024 756100                    STQ     TMP_RVA_SIZ+2,,AUTO
        23 000405   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 000406   000001 631400 24                 EPPR1   1
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:35   
        23 000407   000000 701000 xent               TSX1    ZII$FDRLDSC
        23 000410   001557 702000 23                 TSX2    ER_FDRLDSC

      191     5117        /********************************************************************/
      192     5118        /*Hook up the  record descriptor for the  RFS_DSC the same as  the
      193     5119          record descriptor was hooked up for the  the RA_DSC above          */
      194     5120        /*********************************************************************/
      195     5121    2                  CALL ZII$FDDESC(TYPE_33.SUB_RECORD_NM,#RECORD,DR$,#RETRIEVE,) ALTRET
              5121                            (ER_FDDESC);

   5121 23 000411   000012 237000 24                 LDAQ    10
        23 000412   200026 757100                    STAQ    TMP_RVA_SIZ+4,,AUTO
        23 000413   000011 236000 24                 LDQ     9
        23 000414   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 000415   000000 236000 1                  LDQ     REC$
        23 000416   000005 036003                    ADLQ    5,DU
        23 000417   200024 756100                    STQ     TMP_RVA_SIZ+2,,AUTO
        23 000420   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 000421   000006 631400 24                 EPPR1   6
        23 000422   000000 701000 xent               TSX1    ZII$FDDESC
        23 000423   001554 702000 23                 TSX2    ER_FDDESC

      196     5122    2                   IF RECORD.RFK_DSC$=ADDR(NIL) THEN

   5122 23 000424   000000 470400 12                 LDP0    DR$
        23 000425   000007 236100                    LDQ     7,,PR0
        23 000426   000002 116000 24                 CMPQ    2
        23 000427   000433 601000 23                 TNZ     s:5127

      197     5123    3                   DO;

      198     5124    3                       RECORD.RFK_DSC$=DRFK$;

   5124 23 000430   000000 236000 16                 LDQ     DRFK$
        23 000431   000007 756100                    STQ     7,,PR0

      199     5125    3                       END;
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:36   

   5125 23 000432   000446 710000 23                 TRA     s:5137

      200     5126    3                   ELSE DO;

      201     5127    3                       TDRFK$=RECORD.RFK_DSC$;

   5127 23 000433   200005 756100                    STQ     TDRFK$,,AUTO

      202     5128    4                       DO WHILE(TDRFK$->RFK_DSC.REC$ ~= ADDR(NIL));

   5128 23 000434   000440 710000 23                 TRA     s:5130

      203     5129    4                           TDRFK$=TDRFK$->RFK_DSC.REC$;

   5129 23 000435   200005 470500                    LDP0    TDRFK$,,AUTO
        23 000436   000005 236100                    LDQ     5,,PR0
        23 000437   200005 756100                    STQ     TDRFK$,,AUTO

      204     5130    4                           END;

   5130 23 000440   200005 470500                    LDP0    TDRFK$,,AUTO
        23 000441   000005 236100                    LDQ     5,,PR0
        23 000442   000002 116000 24                 CMPQ    2
        23 000443   000435 601000 23                 TNZ     s:5129

      205     5131    3                       TDRFK$->RFK_DSC.REC$=DRFK$;

   5131 23 000444   000000 236000 16                 LDQ     DRFK$
        23 000445   000005 756100                    STQ     5,,PR0

      206     5132    3                       END;

      207     5133        /********************************************************************/
      208     5134        /*Hook up the  key descriptor for the  RFS_DSC the same as  the
      209     5135          area descriptor was hooked up for the  the RA_DSC above          */
      210     5136        /*********************************************************************/
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:37   
      211     5137    2                   CALL ZII$FDDESC(TYPE_33.SUB_KEY_NM,#KEY,DK$,#RETRIEVE,) ALTRET(
              5137                            ER_FDDESC);

   5137 23 000446   000030 237000 24                 LDAQ    24
        23 000447   200026 757100                    STAQ    TMP_RVA_SIZ+4,,AUTO
        23 000450   000027 236000 24                 LDQ     23
        23 000451   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 000452   000000 236000 1                  LDQ     REC$
        23 000453   000015 036003                    ADLQ    13,DU
        23 000454   200024 756100                    STQ     TMP_RVA_SIZ+2,,AUTO
        23 000455   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 000456   000006 631400 24                 EPPR1   6
        23 000457   000000 701000 xent               TSX1    ZII$FDDESC
        23 000460   001554 702000 23                 TSX2    ER_FDDESC

      212     5138    2                   IF KEY.RFK_DSC$=ADDR(NIL) THEN

   5138 23 000461   000000 470400 14                 LDP0    DK$
        23 000462   000006 236100                    LDQ     6,,PR0
        23 000463   000002 116000 24                 CMPQ    2
        23 000464   000470 601000 23                 TNZ     s:5143

      213     5139    3                   DO;

      214     5140    3                       KEY.RFK_DSC$=DRFK$;

   5140 23 000465   000000 236000 16                 LDQ     DRFK$
        23 000466   000006 756100                    STQ     6,,PR0

      215     5141    3                       END;

   5141 23 000467   000503 710000 23                 TRA     s:5149

      216     5142    3                   ELSE DO;

      217     5143    3                       TDRFK$=KEY.RFK_DSC$;

PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:38   
   5143 23 000470   200005 756100                    STQ     TDRFK$,,AUTO

      218     5144    4                       DO WHILE(TDRFK$->RFK_DSC.KEY$ ~= ADDR(NIL));

   5144 23 000471   000475 710000 23                 TRA     s:5146

      219     5145    4                           TDRFK$=TDRFK$->RFK_DSC.KEY$;

   5145 23 000472   200005 470500                    LDP0    TDRFK$,,AUTO
        23 000473   000006 236100                    LDQ     6,,PR0
        23 000474   200005 756100                    STQ     TDRFK$,,AUTO

      220     5146    4                           END;

   5146 23 000475   200005 470500                    LDP0    TDRFK$,,AUTO
        23 000476   000006 236100                    LDQ     6,,PR0
        23 000477   000002 116000 24                 CMPQ    2
        23 000500   000472 601000 23                 TNZ     s:5145

      221     5147    3                       TDRFK$->RFK_DSC.KEY$=DRFK$;

   5147 23 000501   000000 236000 16                 LDQ     DRFK$
        23 000502   000006 756100                    STQ     6,,PR0

      222     5148    3                       END;

      223     5149    2                   RFK_DSC.KEY_IDX=KEY.NAM_IDX; /*Get the key name index for NAM1 */

   5149 23 000503   000000 470400 14                 LDP0    DK$
        23 000504   000000 220100                    LDX0    0,,PR0
        23 000505   000000 471400 16                 LDP1    DRFK$
        23 000506   100000 440100                    SXL0    0,,PR1

      224     5150    2                   RFK_DSC.REC_IDX=RECORD.NAM_IDX;
              5150                            /*Get the record name for the  NAM1 table */

   5150 23 000507   000000 470400 12                 LDP0    DR$
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:39   
        23 000510   000000 220100                    LDX0    0,,PR0
        23 000511   000000 471400 16                 LDP1    DRFK$
        23 000512   100000 740100                    STX0    0,,PR1

      225     5151    2                   RFK_DSC.NUM_CON_FIELDS=TYPE_33.NUM_CON_FIELDS;
              5151                            /*Get the  number  fields for the  key*/

   5151 23 000513   000000 470400 1                  LDP0    REC$
        23 000514   000000 471400 16                 LDP1    DRFK$
        23 000515   000100 100500                    MLR     fill='000'O
        23 000516   000025 000004                    ADSC9   21,,PR0                  cn=0,n=4
        23 000517   100001 400004                    ADSC9   1,,PR1                   cn=2,n=4

      226     5152    2                   RFK_DSC.PRIM_SEC=TYPE_33.PRIM_OR_SEC;
              5152                            /*Is this a primary or  secondary key*/

   5152 23 000520   003100 060500                    CSL     bolr='003'O
        23 000521   000026 000001                    BDSC    22,,PR0                  by=0,bit=0,n=1
        23 000522   100002 400001                    BDSC    2,,PR1                   by=2,bit=0,n=1

      227     5153    2                   RFK_DSC.LFLD$=ADDR(NIL); /*Null out all the pointers */

   5153 23 000523   000002 236000 24                 LDQ     2
        23 000524   100003 756100                    STQ     3,,PR1

      228     5154    2                   RFK_DSC.REC$=ADDR(NIL);

   5154 23 000525   100005 756100                    STQ     5,,PR1

      229     5155    2                   RFK_DSC.KEY$=ADDR(NIL);

   5155 23 000526   100006 756100                    STQ     6,,PR1

      230     5156    2                   RFK_DSC.FLD$=ADDR(NIL);

   5156 23 000527   100007 756100                    STQ     7,,PR1

PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:40   
      231     5157    2                   RFK_DSC.LLIST$=ADDR(NIL);

   5157 23 000530   100010 756100                    STQ     8,,PR1

      232     5158    2                   END;

   5158 23 000531   001553 710000 23                 TRA     RET

      233     5159    1               ELSE IF TYPE_430.TYPE=34 THEN /*Field_Set descriptors*/

   5159 23 000532   000100 100500                    MLR     fill='000'O
        23 000533   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
        23 000534   200024 000004                    ADSC9   TMP_RVA_SIZ+2,,AUTO      cn=0,n=4
        23 000535   200024 236100                    LDQ     TMP_RVA_SIZ+2,,AUTO
        23 000536   000042 116007                    CMPQ    34,DL
        23 000537   000735 601000 23                 TNZ     s:5212

      234     5160    2                   DO;

      235     5161    2                       IF TYPE_34.THEN_THRU_FIELD = '0'B THEN

   5161 23 000540   000000 066500                    CMPB    filb='0'B
        23 000541   000004 010001                    BDSC    4,,PR0                   by=0,bit=1,n=1
        23 000542   000010 000022 24                 BDSC    8                        by=0,bit=0,n=18
        23 000543   001553 601000 23                 TNZ     RET

      236     5162    3                       DO;

      237     5163    3       CALL ZII$FDRLDSC(TYPE_34.SUB_RECORD_NM,TYPE_34.SUB_SET_NM,TYPE_34.SUB_FIELD_NM,
              5163                 DRFS$,#STORE) ALTRET(ER_FDRLDSC);

   5163 23 000544   000004 236000 24                 LDQ     4
        23 000545   200030 756100                    STQ     TMP_RVA_SIZ+6,,AUTO
        23 000546   000016 236000 24                 LDQ     14
        23 000547   200027 756100                    STQ     TMP_RVA_SIZ+5,,AUTO
        23 000550   000000 236000 1                  LDQ     REC$
        23 000551   000005 036003                    ADLQ    5,DU
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:41   
        23 000552   200026 756100                    STQ     TMP_RVA_SIZ+4,,AUTO
        23 000553   000000 236000 1                  LDQ     REC$
        23 000554   000015 036003                    ADLQ    13,DU
        23 000555   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 000556   000000 236000 1                  LDQ     REC$
        23 000557   000025 036003                    ADLQ    21,DU
        23 000560   200024 756100                    STQ     TMP_RVA_SIZ+2,,AUTO
        23 000561   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 000562   000001 631400 24                 EPPR1   1
        23 000563   000000 701000 xent               TSX1    ZII$FDRLDSC
        23 000564   001557 702000 23                 TSX2    ER_FDRLDSC

      238     5164    3                         CALL ZII$FDRLDSC(TYPE_34.SUB_RECORD_NM,TYPE_34.SUB_SET_NM,,
              5164                                  HRFS$,#RETRIEVE) ALTRET(ER_FDRLDSC);

   5164 23 000565   000013 236000 24                 LDQ     11
        23 000566   200030 756100                    STQ     TMP_RVA_SIZ+6,,AUTO
        23 000567   200004 630500                    EPPR0   HRFS$,,AUTO
        23 000570   200027 450500                    STP0    TMP_RVA_SIZ+5,,AUTO
        23 000571   000002 236000 24                 LDQ     2
        23 000572   200026 756100                    STQ     TMP_RVA_SIZ+4,,AUTO
        23 000573   000000 236000 1                  LDQ     REC$
        23 000574   000015 036003                    ADLQ    13,DU
        23 000575   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 000576   000000 236000 1                  LDQ     REC$
        23 000577   000025 036003                    ADLQ    21,DU
        23 000600   200024 756100                    STQ     TMP_RVA_SIZ+2,,AUTO
        23 000601   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 000602   000001 631400 24                 EPPR1   1
        23 000603   000000 701000 xent               TSX1    ZII$FDRLDSC
        23 000604   001557 702000 23                 TSX2    ER_FDRLDSC

      239     5165        /*
      240     5166          Fill in the new RFS Descriptor
      241     5167        */
      242     5168    3                           RFS_DSC.REC_IDX=HRFS$->RFS_DSC.REC_IDX;

PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:42   
   5168 23 000605   200004 470500                    LDP0    HRFS$,,AUTO
        23 000606   000000 220100                    LDX0    0,,PR0
        23 000607   000000 471400 15                 LDP1    DRFS$
        23 000610   100000 740100                    STX0    0,,PR1

      243     5169    3                           RFS_DSC.SET_IDX=HRFS$->RFS_DSC.SET_IDX;

   5169 23 000611   200004 470500                    LDP0    HRFS$,,AUTO
        23 000612   000000 720100                    LXL0    0,,PR0
        23 000613   000000 471400 15                 LDP1    DRFS$
        23 000614   100000 440100                    SXL0    0,,PR1

      244     5170    3                    CALL ZII$FDDESC(TYPE_34.SUB_FIELD_NM,#FIELD,DF$,#RETRIEVE,TYPE_34.
              5170                              SUB_RECORD_NM) ALTRET(ER_FDDESC);

   5170 23 000615   000000 236000 1                  LDQ     REC$
        23 000616   000025 036003                    ADLQ    21,DU
        23 000617   200030 756100                    STQ     TMP_RVA_SIZ+6,,AUTO
        23 000620   000034 237000 24                 LDAQ    28
        23 000621   200026 757100                    STAQ    TMP_RVA_SIZ+4,,AUTO
        23 000622   000033 236000 24                 LDQ     27
        23 000623   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 000624   000000 236000 1                  LDQ     REC$
        23 000625   000005 036003                    ADLQ    5,DU
        23 000626   200024 756100                    STQ     TMP_RVA_SIZ+2,,AUTO
        23 000627   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 000630   000001 631400 24                 EPPR1   1
        23 000631   000000 701000 xent               TSX1    ZII$FDDESC
        23 000632   001554 702000 23                 TSX2    ER_FDDESC

      245     5171    3                           RFS_DSC.FLD_IDX=FIELD.NAM_IDX;

   5171 23 000633   000000 470400 20                 LDP0    DF$
        23 000634   000000 220100                    LDX0    0,,PR0
        23 000635   000000 471400 15                 LDP1    DRFS$
        23 000636   100001 740100                    STX0    1,,PR1

PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:43   
      246     5172    3                           RFS_DSC.ASCEND_DESCEND=TYPE_34.ASSEND_OR_DESCEND;

   5172 23 000637   000000 473400 1                  LDP3    REC$
        23 000640   003100 060500                    CSL     bolr='003'O
        23 000641   300004 000001                    BDSC    4,,PR3                   by=0,bit=0,n=1
        23 000642   100001 430001                    BDSC    1,,PR1                   by=2,bit=3,n=1

      247     5173        /*
      248     5174           Set up LFLD$ to point from the linked list eminating from
      249     5175           the higher-level RFS_DSC to the current RFS_DSC containing the
      250     5176           control field from the current record and which controls the
      251     5177           current set.
      252     5178        */
      253     5179    3                           IF HRFS$->RFS_DSC.LFLD$ = ADDR(NIL) THEN

   5179 23 000643   200004 474500                    LDP4    HRFS$,,AUTO
        23 000644   400004 236100                    LDQ     4,,PR4
        23 000645   000002 116000 24                 CMPQ    2
        23 000646   000652 601000 23                 TNZ     s:5183

      254     5180    3                               HRFS$->RFS_DSC.LFLD$=DRFS$;

   5180 23 000647   000000 236000 15                 LDQ     DRFS$
        23 000650   400004 756100                    STQ     4,,PR4
        23 000651   000665 710000 23                 TRA     s:5192

      255     5181    3                           ELSE
      256     5182    4                           DO;

      257     5183    4                               TDRFS$=HRFS$->RFS_DSC.LFLD$;

   5183 23 000652   200003 756100                    STQ     TDRFS$,,AUTO

      258     5184    5                               DO WHILE(TDRFS$->RFS_DSC.LFLD$ ~= ADDR(NIL));

   5184 23 000653   000657 710000 23                 TRA     s:5186

PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:44   
      259     5185    5                                   TDRFS$=TDRFS$->RFS_DSC.LFLD$;

   5185 23 000654   200003 470500                    LDP0    TDRFS$,,AUTO
        23 000655   000004 236100                    LDQ     4,,PR0
        23 000656   200003 756100                    STQ     TDRFS$,,AUTO

      260     5186    5                                   END;

   5186 23 000657   200003 470500                    LDP0    TDRFS$,,AUTO
        23 000660   000004 236100                    LDQ     4,,PR0
        23 000661   000002 116000 24                 CMPQ    2
        23 000662   000654 601000 23                 TNZ     s:5185

      261     5187    4                               TDRFS$->RFS_DSC.LFLD$=DRFS$;

   5187 23 000663   000000 236000 15                 LDQ     DRFS$
        23 000664   000004 756100                    STQ     4,,PR0

      262     5188    4                               END;

      263     5189        /*
      264     5190           Set up all PTRs for this Field.
      265     5191        */
      266     5192    3                           IF NAM1.DESC$(RFS_DSC.FLD_IDX)->FIELD.RFS_DSC$=ADDR(NIL)
              5192                                    THEN

   5192 23 000665   000000 470400 15                 LDP0    DRFS$
        23 000666   000001 236100                    LDQ     1,,PR0
        23 000667   000022 772000                    QRL     18
        23 000670   000012 402007                    MPY     10,DL
        23 000671   000000 471400 4                  LDP1    NAM1$
        23 000672   100011 473506                    LDP3    9,QL,PR1
        23 000673   300006 236100                    LDQ     6,,PR3
        23 000674   000002 116000 24                 CMPQ    2
        23 000675   000705 601000 23                 TNZ     s:5196

      267     5193    3                               NAM1.DESC$(RFS_DSC.FLD_IDX)->FIELD.RFS_DSC$=DRFS$;
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:45   

   5193 23 000676   000001 236100                    LDQ     1,,PR0
        23 000677   000022 772000                    QRL     18
        23 000700   000012 402007                    MPY     10,DL
        23 000701   100011 473506                    LDP3    9,QL,PR1
        23 000702   000000 236000 15                 LDQ     DRFS$
        23 000703   300006 756100                    STQ     6,,PR3
        23 000704   000725 710000 23                 TRA     s:5205

      268     5194    3                           ELSE
      269     5195    4                           DO;

      270     5196    4                               TDRFS$=NAM1.DESC$(RFS_DSC.FLD_IDX)->FIELD.RFS_DSC$;

   5196 23 000705   000001 236100                    LDQ     1,,PR0
        23 000706   000022 772000                    QRL     18
        23 000707   000012 402007                    MPY     10,DL
        23 000710   100011 473506                    LDP3    9,QL,PR1
        23 000711   300006 236100                    LDQ     6,,PR3
        23 000712   200003 756100                    STQ     TDRFS$,,AUTO

      271     5197    5                               DO WHILE (TDRFS$->RFS_DSC.FLD$~=ADDR(NIL));

   5197 23 000713   000717 710000 23                 TRA     s:5199

      272     5198    5                                   TDRFS$=TDRFS$->RFS_DSC.FLD$;

   5198 23 000714   200003 470500                    LDP0    TDRFS$,,AUTO
        23 000715   000007 236100                    LDQ     7,,PR0
        23 000716   200003 756100                    STQ     TDRFS$,,AUTO

      273     5199    5                                   END;

   5199 23 000717   200003 470500                    LDP0    TDRFS$,,AUTO
        23 000720   000007 236100                    LDQ     7,,PR0
        23 000721   000002 116000 24                 CMPQ    2
        23 000722   000714 601000 23                 TNZ     s:5198
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:46   

      274     5200    4                               TDRFS$->RFS_DSC.FLD$=DRFS$;

   5200 23 000723   000000 236000 15                 LDQ     DRFS$
        23 000724   000007 756100                    STQ     7,,PR0

      275     5201    4                               END;

      276     5202        /*
      277     5203           Null out all other PTRs for this RFS Descriptor.
      278     5204        */
      279     5205    3                           RFS_DSC.REC$=ADDR(NIL);

   5205 23 000725   000002 236000 24                 LDQ     2
        23 000726   000000 470400 15                 LDP0    DRFS$
        23 000727   000005 756100                    STQ     5,,PR0

      280     5206    3                           RFS_DSC.SET$=ADDR(NIL);

   5206 23 000730   000006 756100                    STQ     6,,PR0

      281     5207    3                           RFS_DSC.FLD$=ADDR(NIL);

   5207 23 000731   000007 756100                    STQ     7,,PR0

      282     5208    3                           RFS_DSC.LFLD$=ADDR(NIL);

   5208 23 000732   000004 756100                    STQ     4,,PR0

      283     5209    3                           RFS_DSC.LLIST$=ADDR(NIL);

   5209 23 000733   000010 756100                    STQ     8,,PR0

      284     5210    3                           END;

      285     5211    2                       END;

PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:47   
   5211 23 000734   001553 710000 23                 TRA     RET

      286     5212    1                   ELSE IF TYPE_430.TYPE=35 THEN /*Field_Key descriptor*/

   5212 23 000735   000100 100500                    MLR     fill='000'O
        23 000736   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
        23 000737   200024 000004                    ADSC9   TMP_RVA_SIZ+2,,AUTO      cn=0,n=4
        23 000740   200024 236100                    LDQ     TMP_RVA_SIZ+2,,AUTO
        23 000741   000043 116007                    CMPQ    35,DL
        23 000742   001101 601000 23                 TNZ     s:5257

      287     5213    2                       DO;

      288     5214    3                           DO;

      289     5215        /*********************************************************************/
      290     5216        /*We are now about to  link in the  "lower level" RFK_DSC descriptors
      291     5217          1. We have found the  "higher level " RFK_DSC by hashing  the  record name
      292     5218             and the set name  and get  the descriptor pointer (HRFK$)
      293     5219          2. Find the field descripotr pointer
      294     5220          3. Follow the RFK_DSC.FLD$ pointer link link until  the end is reached
      295     5221              (RFK_DSC.FLD$ equal addr(nil))
      296     5222        _  4.  Put the associated Record,Set, and Field indexes into the "lower
      297     5223                level" RFK_DSC descriptor
      298     5224           5. Then hook up the  FIELD descriptor like the  record  descriptor was hooked
      299     5225               up for the  RA_DSC
      300     5226        */
      301     5227        /****************************************************************************/
      302     5228    3                               CALL ZII$FDRLDSC(TYPE_35.SUB_RECORD_NM,TYPE_35.
              5228                                        SUB_KEY_NM,,HRFK$) ALTRET(ER_FDRLDSC);

   5228 23 000743   200007 631500                    EPPR1   HRFK$,,AUTO
        23 000744   200027 451500                    STP1    TMP_RVA_SIZ+5,,AUTO
        23 000745   000002 236000 24                 LDQ     2
        23 000746   200026 756100                    STQ     TMP_RVA_SIZ+4,,AUTO
        23 000747   000000 236000 1                  LDQ     REC$
        23 000750   000015 036003                    ADLQ    13,DU
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:48   
        23 000751   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 000752   000000 236000 1                  LDQ     REC$
        23 000753   000025 036003                    ADLQ    21,DU
        23 000754   200024 756100                    STQ     TMP_RVA_SIZ+2,,AUTO
        23 000755   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 000756   000006 631400 24                 EPPR1   6
        23 000757   000000 701000 xent               TSX1    ZII$FDRLDSC
        23 000760   001557 702000 23                 TSX2    ER_FDRLDSC

      303     5229    3     CALL ZII$FDRLDSC(TYPE_35.SUB_RECORD_NM,TYPE_35.SUB_KEY_NM,TYPE_35.SUB_FIELD_NM,
              5229              DRFK$,#STORE) ALTRET(ER_FDRLDSC);

   5229 23 000761   000004 236000 24                 LDQ     4
        23 000762   200030 756100                    STQ     TMP_RVA_SIZ+6,,AUTO
        23 000763   000025 236000 24                 LDQ     21
        23 000764   200027 756100                    STQ     TMP_RVA_SIZ+5,,AUTO
        23 000765   000000 236000 1                  LDQ     REC$
        23 000766   000005 036003                    ADLQ    5,DU
        23 000767   200026 756100                    STQ     TMP_RVA_SIZ+4,,AUTO
        23 000770   000000 236000 1                  LDQ     REC$
        23 000771   000015 036003                    ADLQ    13,DU
        23 000772   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 000773   000000 236000 1                  LDQ     REC$
        23 000774   000025 036003                    ADLQ    21,DU
        23 000775   200024 756100                    STQ     TMP_RVA_SIZ+2,,AUTO
        23 000776   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 000777   000001 631400 24                 EPPR1   1
        23 001000   000000 701000 xent               TSX1    ZII$FDRLDSC
        23 001001   001557 702000 23                 TSX2    ER_FDRLDSC

      304     5230    3                  CALL ZII$FDDESC(TYPE_35.SUB_FIELD_NM,#FIELD,DF$,#RETRIEVE,TYPE_35.
              5230                           SUB_RECORD_NM) ALTRET(ER_FDDESC);

   5230 23 001002   000000 236000 1                  LDQ     REC$
        23 001003   000025 036003                    ADLQ    21,DU
        23 001004   200030 756100                    STQ     TMP_RVA_SIZ+6,,AUTO
        23 001005   000034 237000 24                 LDAQ    28
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:49   
        23 001006   200026 757100                    STAQ    TMP_RVA_SIZ+4,,AUTO
        23 001007   000033 236000 24                 LDQ     27
        23 001010   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 001011   000000 236000 1                  LDQ     REC$
        23 001012   000005 036003                    ADLQ    5,DU
        23 001013   200024 756100                    STQ     TMP_RVA_SIZ+2,,AUTO
        23 001014   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 001015   000001 631400 24                 EPPR1   1
        23 001016   000000 701000 xent               TSX1    ZII$FDDESC
        23 001017   001554 702000 23                 TSX2    ER_FDDESC

      305     5231    3                               TDRFK$=HRFK$;

   5231 23 001020   200007 236100                    LDQ     HRFK$,,AUTO
        23 001021   200005 756100                    STQ     TDRFK$,,AUTO

      306     5232    4                               DO WHILE(TDRFK$->RFK_DSC.FLD$ ~= ADDR(NIL));

   5232 23 001022   001026 710000 23                 TRA     s:5234

      307     5233    4                                   TDRFK$=TDRFK$->RFK_DSC.FLD$;

   5233 23 001023   200005 470500                    LDP0    TDRFK$,,AUTO
        23 001024   000007 236100                    LDQ     7,,PR0
        23 001025   200005 756100                    STQ     TDRFK$,,AUTO

      308     5234    4                                   END;

   5234 23 001026   200005 470500                    LDP0    TDRFK$,,AUTO
        23 001027   000007 236100                    LDQ     7,,PR0
        23 001030   000002 116000 24                 CMPQ    2
        23 001031   001023 601000 23                 TNZ     s:5233

      309     5235    3                               TDRFK$->RFK_DSC.FLD$=DRFK$;

   5235 23 001032   000000 236000 16                 LDQ     DRFK$
        23 001033   000007 756100                    STQ     7,,PR0
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:50   

      310     5236    3                               END;

      311     5237    2                           RFK_DSC.REC_IDX=HRFK$->RFK_DSC.REC_IDX;

   5237 23 001034   200007 471500                    LDP1    HRFK$,,AUTO
        23 001035   100000 220100                    LDX0    0,,PR1
        23 001036   000000 473400 16                 LDP3    DRFK$
        23 001037   300000 740100                    STX0    0,,PR3

      312     5238    2                           RFK_DSC.KEY_IDX=HRFK$->RFK_DSC.KEY_IDX;

   5238 23 001040   200007 471500                    LDP1    HRFK$,,AUTO
        23 001041   100000 720100                    LXL0    0,,PR1
        23 001042   000000 473400 16                 LDP3    DRFK$
        23 001043   300000 440100                    SXL0    0,,PR3

      313     5239    2                           RFK_DSC.FLD_IDX=FIELD.NAM_IDX;

   5239 23 001044   000000 471400 20                 LDP1    DF$
        23 001045   100000 220100                    LDX0    0,,PR1
        23 001046   000000 473400 16                 LDP3    DRFK$
        23 001047   300001 740100                    STX0    1,,PR3

      314     5240    2                           IF FIELD.RFK_DSC$= ADDR(NIL) THEN

   5240 23 001050   100007 236100                    LDQ     7,,PR1
        23 001051   000002 116000 24                 CMPQ    2
        23 001052   001056 601000 23                 TNZ     s:5245

      315     5241    3                           DO;

      316     5242    3                               FIELD.RFK_DSC$=DRFK$;

   5242 23 001053   000000 236000 16                 LDQ     DRFK$
        23 001054   100007 756100                    STQ     7,,PR1

PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:51   
      317     5243    3                               END;

   5243 23 001055   001071 710000 23                 TRA     s:5251

      318     5244    3                           ELSE DO;

      319     5245    3                               TDRFK$=FIELD.RFK_DSC$;

   5245 23 001056   200005 756100                    STQ     TDRFK$,,AUTO

      320     5246    4                               DO WHILE(TDRFK$->RFK_DSC.LFLD$ ~= ADDR(NIL));

   5246 23 001057   001063 710000 23                 TRA     s:5248

      321     5247    4                                   TDRFK$=TDRFK$->RFK_DSC.LFLD$;

   5247 23 001060   200005 470500                    LDP0    TDRFK$,,AUTO
        23 001061   000003 236100                    LDQ     3,,PR0
        23 001062   200005 756100                    STQ     TDRFK$,,AUTO

      322     5248    4                                   END;

   5248 23 001063   200005 470500                    LDP0    TDRFK$,,AUTO
        23 001064   000003 236100                    LDQ     3,,PR0
        23 001065   000002 116000 24                 CMPQ    2
        23 001066   001060 601000 23                 TNZ     s:5247

      323     5249    3                               TDRFK$->RFK_DSC.LFLD$=DRFK$;

   5249 23 001067   000000 236000 16                 LDQ     DRFK$
        23 001070   000003 756100                    STQ     3,,PR0

      324     5250    3                               END;

      325     5251    2                           RFK_DSC.LFLD$=ADDR(NIL);

   5251 23 001071   000002 236000 24                 LDQ     2
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:52   
        23 001072   000000 471400 16                 LDP1    DRFK$
        23 001073   100003 756100                    STQ     3,,PR1

      326     5252    2                           RFK_DSC.REC$=ADDR(NIL);

   5252 23 001074   100005 756100                    STQ     5,,PR1

      327     5253    2                           RFK_DSC.KEY$=ADDR(NIL);

   5253 23 001075   100006 756100                    STQ     6,,PR1

      328     5254    2                           RFK_DSC.FLD$=ADDR(NIL);

   5254 23 001076   100007 756100                    STQ     7,,PR1

      329     5255    2                           RFK_DSC.LLIST$=ADDR(NIL);

   5255 23 001077   100010 756100                    STQ     8,,PR1

      330     5256    2                           END;

   5256 23 001100   001553 710000 23                 TRA     RET

      331     5257    1                       ELSE IF TYPE_430.TYPE=37 THEN /*Record_Parameter descriptor*/

   5257 23 001101   000100 100500                    MLR     fill='000'O
        23 001102   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
        23 001103   200024 000004                    ADSC9   TMP_RVA_SIZ+2,,AUTO      cn=0,n=4
        23 001104   200024 236100                    LDQ     TMP_RVA_SIZ+2,,AUTO
        23 001105   000045 116007                    CMPQ    37,DL
        23 001106   001267 601000 23                 TNZ     s:5293

      332     5258    2                           DO;

      333     5259    2    CALL ZII$FDRLDSC(TYPE_37.SUB_RECORD_ST_NM,TYPE_37.SUB_FIELD_NM,TYPE_37.
              5259             SUB_RECORD_NM,DRP$,#STORE) ALTRET(ER_FDRLDSC);

PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:53   
   5259 23 001107   000004 236000 24                 LDQ     4
        23 001110   200030 756100                    STQ     TMP_RVA_SIZ+6,,AUTO
        23 001111   000036 236000 24                 LDQ     30
        23 001112   200027 756100                    STQ     TMP_RVA_SIZ+5,,AUTO
        23 001113   000000 236000 1                  LDQ     REC$
        23 001114   000025 036003                    ADLQ    21,DU
        23 001115   200026 756100                    STQ     TMP_RVA_SIZ+4,,AUTO
        23 001116   000000 236000 1                  LDQ     REC$
        23 001117   000005 036003                    ADLQ    5,DU
        23 001120   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 001121   000000 236000 1                  LDQ     REC$
        23 001122   000015 036003                    ADLQ    13,DU
        23 001123   200024 756100                    STQ     TMP_RVA_SIZ+2,,AUTO
        23 001124   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 001125   000001 631400 24                 EPPR1   1
        23 001126   000000 701000 xent               TSX1    ZII$FDRLDSC
        23 001127   001557 702000 23                 TSX2    ER_FDRLDSC

      334     5260    2                               CALL ZII$FDDESC(TYPE_37.SUB_RECORD_ST_NM,#RECORD,DR$,
              5260                                        #RETRIEVE) ALTRET(ER_FDDESC);

   5260 23 001130   000012 237000 24                 LDAQ    10
        23 001131   200026 757100                    STAQ    TMP_RVA_SIZ+4,,AUTO
        23 001132   000011 236000 24                 LDQ     9
        23 001133   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 001134   000000 236000 1                  LDQ     REC$
        23 001135   000015 036003                    ADLQ    13,DU
        23 001136   200024 756100                    STQ     TMP_RVA_SIZ+2,,AUTO
        23 001137   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 001140   000006 631400 24                 EPPR1   6
        23 001141   000000 701000 xent               TSX1    ZII$FDDESC
        23 001142   001554 702000 23                 TSX2    ER_FDDESC

      335     5261    2                               IF RECORD.RP_DSC$=ADDR(NIL) THEN

   5261 23 001143   000000 470400 12                 LDP0    DR$
        23 001144   000004 236100                    LDQ     4,,PR0
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:54   
        23 001145   000002 116000 24                 CMPQ    2
        23 001146   001152 601000 23                 TNZ     s:5266

      336     5262    3                               DO;

      337     5263    3                                   RECORD.RP_DSC$=DRP$;

   5263 23 001147   000000 236000 18                 LDQ     DRP$
        23 001150   000004 756100                    STQ     4,,PR0

      338     5264    3                                   END;

   5264 23 001151   001165 710000 23                 TRA     s:5272

      339     5265    3                               ELSE DO;

      340     5266    3                                   TDRP$=RECORD.RP_DSC$;

   5266 23 001152   200006 756100                    STQ     TDRP$,,AUTO

      341     5267    4                                   DO WHILE(TDRP$->RP_DSC.REC$ ~= ADDR(NIL));

   5267 23 001153   001157 710000 23                 TRA     s:5269

      342     5268    4                                       TDRP$=TDRP$->RP_DSC.REC$;

   5268 23 001154   200006 470500                    LDP0    TDRP$,,AUTO
        23 001155   000006 236100                    LDQ     6,,PR0
        23 001156   200006 756100                    STQ     TDRP$,,AUTO

      343     5269    4                                       END;

   5269 23 001157   200006 470500                    LDP0    TDRP$,,AUTO
        23 001160   000006 236100                    LDQ     6,,PR0
        23 001161   000002 116000 24                 CMPQ    2
        23 001162   001154 601000 23                 TNZ     s:5268

PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:55   
      344     5270    3                                   TDRP$->RP_DSC.REC$=DRP$;

   5270 23 001163   000000 236000 18                 LDQ     DRP$
        23 001164   000006 756100                    STQ     6,,PR0

      345     5271    3                                   END;

      346     5272    2                               IF TYPE_37.SUB_RECORD_NM = '*DBPARAM' THEN

   5272 23 001165   000000 470400 1                  LDP0    REC$
        23 001166   040000 106500                    CMPC    fill='040'O
        23 001167   000025 000040                    ADSC9   21,,PR0                  cn=0,n=32
        23 001170   000000 000010 22                 ADSC9   0                        cn=0,n=8
        23 001171   001211 601000 23                 TNZ     s:5275

      347     5273    2            CALL ZII$FDDESC(TYPE_37.SUB_FIELD_NM,#PARAM,DP$,#RETRIEVE,TYPE_37.
              5273                     SUB_RECORD_ST_NM) ALTRET(ER_FDDESC);

   5273 23 001172   000000 236000 1                  LDQ     REC$
        23 001173   000015 036003                    ADLQ    13,DU
        23 001174   200030 756100                    STQ     TMP_RVA_SIZ+6,,AUTO
        23 001175   000040 237000 24                 LDAQ    32
        23 001176   200026 757100                    STAQ    TMP_RVA_SIZ+4,,AUTO
        23 001177   000042 236000 24                 LDQ     34
        23 001200   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 001201   000000 236000 1                  LDQ     REC$
        23 001202   000005 036003                    ADLQ    5,DU
        23 001203   200024 756100                    STQ     TMP_RVA_SIZ+2,,AUTO
        23 001204   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 001205   000001 631400 24                 EPPR1   1
        23 001206   000000 701000 xent               TSX1    ZII$FDDESC
        23 001207   001554 702000 23                 TSX2    ER_FDDESC
        23 001210   001227 710000 23                 TRA     s:5276

      348     5274    2                               ELSE
      349     5275    2               CALL ZII$FDDESC(TYPE_37.SUB_FIELD_NM,#FIELD,DP$,#RETRIEVE,TYPE_37.
              5275                        SUB_RECORD_NM) ALTRET(ER_FDDESC);
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:56   

   5275 23 001211   000000 236000 1                  LDQ     REC$
        23 001212   000025 036003                    ADLQ    21,DU
        23 001213   200030 756100                    STQ     TMP_RVA_SIZ+6,,AUTO
        23 001214   000040 237000 24                 LDAQ    32
        23 001215   200026 757100                    STAQ    TMP_RVA_SIZ+4,,AUTO
        23 001216   000033 236000 24                 LDQ     27
        23 001217   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 001220   000000 236000 1                  LDQ     REC$
        23 001221   000005 036003                    ADLQ    5,DU
        23 001222   200024 756100                    STQ     TMP_RVA_SIZ+2,,AUTO
        23 001223   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 001224   000001 631400 24                 EPPR1   1
        23 001225   000000 701000 xent               TSX1    ZII$FDDESC
        23 001226   001554 702000 23                 TSX2    ER_FDDESC

      350     5276    2                               IF DSC_PARAM.RP_DSC$=ADDR(NIL) THEN

   5276 23 001227   000000 470400 21                 LDP0    DP$
        23 001230   000007 236100                    LDQ     7,,PR0
        23 001231   000002 116000 24                 CMPQ    2
        23 001232   001236 601000 23                 TNZ     s:5281

      351     5277    3                               DO;

      352     5278    3                                   DSC_PARAM.RP_DSC$=DRP$;

   5278 23 001233   000000 236000 18                 LDQ     DRP$
        23 001234   000007 756100                    STQ     7,,PR0

      353     5279    3                                   END;

   5279 23 001235   001251 710000 23                 TRA     s:5287

      354     5280    3                               ELSE DO;

      355     5281    3                                   TDRP$=DSC_PARAM.RP_DSC$;
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:57   

   5281 23 001236   200006 756100                    STQ     TDRP$,,AUTO

      356     5282    4                                   DO WHILE(TDRP$->RP_DSC.PARAM$ ~= ADDR(NIL));

   5282 23 001237   001243 710000 23                 TRA     s:5284

      357     5283    4                                       TDRP$=TDRP$->RP_DSC.PARAM$;

   5283 23 001240   200006 470500                    LDP0    TDRP$,,AUTO
        23 001241   000007 236100                    LDQ     7,,PR0
        23 001242   200006 756100                    STQ     TDRP$,,AUTO

      358     5284    4                                       END;

   5284 23 001243   200006 470500                    LDP0    TDRP$,,AUTO
        23 001244   000007 236100                    LDQ     7,,PR0
        23 001245   000002 116000 24                 CMPQ    2
        23 001246   001240 601000 23                 TNZ     s:5283

      359     5285    3                                   TDRP$->RP_DSC.PARAM$=DRP$;

   5285 23 001247   000000 236000 18                 LDQ     DRP$
        23 001250   000007 756100                    STQ     7,,PR0

      360     5286    3                                   END;

      361     5287    2                               RP_DSC.PARAM_IDX=DSC_PARAM.NAM_IDX;
              5287                                        /*Put in the NAM1 index for the area name */

   5287 23 001251   000000 470400 21                 LDP0    DP$
        23 001252   000000 220100                    LDX0    0,,PR0
        23 001253   000000 471400 18                 LDP1    DRP$
        23 001254   100000 440100                    SXL0    0,,PR1

      362     5288    2                               RP_DSC.REC_IDX=RECORD.NAM_IDX;
              5288                                        /*Put in the NAM1 index for the record name */
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:58   

   5288 23 001255   000000 470400 12                 LDP0    DR$
        23 001256   000000 220100                    LDX0    0,,PR0
        23 001257   000000 471400 18                 LDP1    DRP$
        23 001260   100000 740100                    STX0    0,,PR1

      363     5289    2                               RP_DSC.REC$=ADDR(NIL);
              5289                                        /*Null out  all the link list pointers */

   5289 23 001261   000002 236000 24                 LDQ     2
        23 001262   000000 470400 18                 LDP0    DRP$
        23 001263   000006 756100                    STQ     6,,PR0

      364     5290    2                               RP_DSC.PARAM$=ADDR(NIL);

   5290 23 001264   000007 756100                    STQ     7,,PR0

      365     5291    2                               RP_DSC.LLIST$=ADDR(NIL);

   5291 23 001265   000010 756100                    STQ     8,,PR0

      366     5292    2                               END;

   5292 23 001266   001553 710000 23                 TRA     RET

      367     5293    1                           ELSE IF TYPE_430.TYPE = 200 THEN /*Area descriptor*/

   5293 23 001267   000100 100500                    MLR     fill='000'O
        23 001270   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
        23 001271   200024 000004                    ADSC9   TMP_RVA_SIZ+2,,AUTO      cn=0,n=4
        23 001272   200024 236100                    LDQ     TMP_RVA_SIZ+2,,AUTO
        23 001273   000310 116007                    CMPQ    200,DL
        23 001274   001320 601000 23                 TNZ     s:5299

      368     5294    2                               DO;

      369     5295    2                               TMP_NAME=TYPE_200.SUB_AREA_NAME;
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:59   
              5295                                        /*Move name here to get full 32 char .blank fill*/

   5295 23 001275   040100 100500                    MLR     fill='040'O
        23 001276   000013 000036                    ADSC9   11,,PR0                  cn=0,n=30
        23 001277   200012 000040                    ADSC9   TMP_NAME,,AUTO           cn=0,n=32

      370     5296    2                             CALL ZII$FDDESC(TMP_NAME,#AREA,DA$,#RETRIEVE,) ALTRET(
              5296                                      ER_FDDESC); /*Find the descrp*/

   5296 23 001300   000014 237000 24                 LDAQ    12
        23 001301   200026 757100                    STAQ    TMP_RVA_SIZ+4,,AUTO
        23 001302   000013 236000 24                 LDQ     11
        23 001303   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 001304   200012 631500                    EPPR1   TMP_NAME,,AUTO
        23 001305   200024 451500                    STP1    TMP_RVA_SIZ+2,,AUTO
        23 001306   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 001307   000006 631400 24                 EPPR1   6
        23 001310   000000 701000 xent               TSX1    ZII$FDDESC
        23 001311   001554 702000 23                 TSX2    ER_FDDESC

      371     5297    2                              AREA.AREA_BITS = TYPE_200.AREA_BITS;
              5297                                       /*Move in the information bits about the area*/

   5297 23 001312   000000 470400 1                  LDP0    REC$
        23 001313   000000 471400 11                 LDP1    DA$
        23 001314   000100 100500                    MLR     fill='000'O
        23 001315   000024 000004                    ADSC9   20,,PR0                  cn=0,n=4
        23 001316   100001 000004                    ADSC9   1,,PR1                   cn=0,n=4

      372     5298    2                                   END;

   5298 23 001317   001553 710000 23                 TRA     RET

      373     5299    1                               ELSE IF TYPE_430.TYPE=300 THEN /*Set    descriptor*/

   5299 23 001320   000100 100500                    MLR     fill='000'O
        23 001321   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:60   
        23 001322   200024 000004                    ADSC9   TMP_RVA_SIZ+2,,AUTO      cn=0,n=4
        23 001323   200024 236100                    LDQ     TMP_RVA_SIZ+2,,AUTO
        23 001324   000454 116007                    CMPQ    300,DL
        23 001325   001361 601000 23                 TNZ     s:5306

      374     5300    2                                   DO;

      375     5301    2                                       IF TYPE_300.SUB_SET_NAME = ' ' THEN TMP_NAME=
              5301                                                TYPE_300.SET_NAME;

   5301 23 001326   040000 106500                    CMPC    fill='040'O
        23 001327   000013 000036                    ADSC9   11,,PR0                  cn=0,n=30
        23 001330   000000 000001 24                 ADSC9   0                        cn=0,n=1
        23 001331   001336 601000 23                 TNZ     s:5302

   5301 23 001332   040100 100500                    MLR     fill='040'O
        23 001333   000003 000036                    ADSC9   3,,PR0                   cn=0,n=30
        23 001334   200012 000040                    ADSC9   TMP_NAME,,AUTO           cn=0,n=32
        23 001335   001341 710000 23                 TRA     s:5303

      376     5302    2                                       ELSE TMP_NAME=TYPE_300.SUB_SET_NAME;

   5302 23 001336   040100 100500                    MLR     fill='040'O
        23 001337   000013 000036                    ADSC9   11,,PR0                  cn=0,n=30
        23 001340   200012 000040                    ADSC9   TMP_NAME,,AUTO           cn=0,n=32

      377     5303    2                                       CALL ZII$FDDESC(TMP_NAME,#SET,DS$,#RETRIEVE,)
              5303                                                ALTRET(ER_FDDESC);

   5303 23 001341   000020 237000 24                 LDAQ    16
        23 001342   200026 757100                    STAQ    TMP_RVA_SIZ+4,,AUTO
        23 001343   000022 236000 24                 LDQ     18
        23 001344   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 001345   200012 631500                    EPPR1   TMP_NAME,,AUTO
        23 001346   200024 451500                    STP1    TMP_RVA_SIZ+2,,AUTO
        23 001347   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 001350   000006 631400 24                 EPPR1   6
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:61   
        23 001351   000000 701000 xent               TSX1    ZII$FDDESC
        23 001352   001554 702000 23                 TSX2    ER_FDDESC

      378     5304    2                                       SET.FLAG_BITS=TYPE_300.FLAGS.INFO_BITS;

   5304 23 001353   000000 470400 1                  LDP0    REC$
        23 001354   000000 471400 13                 LDP1    DS$
        23 001355   003100 060500                    CSL     bolr='003'O
        23 001356   000024 230030                    BDSC    20,,PR0                  by=1,bit=3,n=24
        23 001357   100002 000030                    BDSC    2,,PR1                   by=0,bit=0,n=24

      379     5305    2                                       END;

   5305 23 001360   001553 710000 23                 TRA     RET

      380     5306    1                                   ELSE IF TYPE_430.TYPE=400 THEN
              5306                                            /*Record  descriptor*/

   5306 23 001361   000100 100500                    MLR     fill='000'O
        23 001362   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
        23 001363   200024 000004                    ADSC9   TMP_RVA_SIZ+2,,AUTO      cn=0,n=4
        23 001364   200024 236100                    LDQ     TMP_RVA_SIZ+2,,AUTO
        23 001365   000620 116007                    CMPQ    400,DL
        23 001366   001422 601000 23                 TNZ     s:5313

      381     5307    2                                       DO;

      382     5308    2                                      IF TYPE_400.SUB_RECORD_NAME = ' ' THEN TMP_NAME=
              5308                                                TYPE_400.RECORD_NAME;

   5308 23 001367   040000 106500                    CMPC    fill='040'O
        23 001370   000013 000036                    ADSC9   11,,PR0                  cn=0,n=30
        23 001371   000000 000001 24                 ADSC9   0                        cn=0,n=1
        23 001372   001377 601000 23                 TNZ     s:5309

   5308 23 001373   040100 100500                    MLR     fill='040'O
        23 001374   000003 000036                    ADSC9   3,,PR0                   cn=0,n=30
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:62   
        23 001375   200012 000040                    ADSC9   TMP_NAME,,AUTO           cn=0,n=32
        23 001376   001402 710000 23                 TRA     s:5310

      383     5309    2                                           ELSE TMP_NAME=TYPE_400.SUB_RECORD_NAME;

   5309 23 001377   040100 100500                    MLR     fill='040'O
        23 001400   000013 000036                    ADSC9   11,,PR0                  cn=0,n=30
        23 001401   200012 000040                    ADSC9   TMP_NAME,,AUTO           cn=0,n=32

      384     5310    2                                        CALL ZII$FDDESC(TMP_NAME,#RECORD,DR$,#RETRIEVE
              5310                                                  ,) ALTRET(ER_FDDESC);

   5310 23 001402   000012 237000 24                 LDAQ    10
        23 001403   200026 757100                    STAQ    TMP_RVA_SIZ+4,,AUTO
        23 001404   000011 236000 24                 LDQ     9
        23 001405   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 001406   200012 631500                    EPPR1   TMP_NAME,,AUTO
        23 001407   200024 451500                    STP1    TMP_RVA_SIZ+2,,AUTO
        23 001410   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 001411   000006 631400 24                 EPPR1   6
        23 001412   000000 701000 xent               TSX1    ZII$FDDESC
        23 001413   001554 702000 23                 TSX2    ER_FDDESC

      385     5311    2                                           RECORD.FLAG_BITS=TYPE_400.FLAGS.INFO_BITS;

   5311 23 001414   000000 470400 1                  LDP0    REC$
        23 001415   000000 471400 12                 LDP1    DR$
        23 001416   003100 060500                    CSL     bolr='003'O
        23 001417   000024 230022                    BDSC    20,,PR0                  by=1,bit=3,n=18
        23 001420   100001 400022                    BDSC    1,,PR1                   by=2,bit=0,n=18

      386     5312    2                                           END;

   5312 23 001421   001553 710000 23                 TRA     RET

      387     5313    1                                       ELSE IF TYPE_430.TYPE = 430 THEN
              5313                                                /*Field descriptor*/
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:63   

   5313 23 001422   000100 100500                    MLR     fill='000'O
        23 001423   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
        23 001424   200024 000004                    ADSC9   TMP_RVA_SIZ+2,,AUTO      cn=0,n=4
        23 001425   200024 236100                    LDQ     TMP_RVA_SIZ+2,,AUTO
        23 001426   000656 116007                    CMPQ    430,DL
        23 001427   001553 601000 23                 TNZ     RET

      388     5314    2                                           DO;

      389     5315    2                                      IF TYPE_430.SUB_FIELD_NAME = ' ' THEN TMP_NAME=
              5315                                               TYPE_430.FIELD_NAME;

   5315 23 001430   040000 106500                    CMPC    fill='040'O
        23 001431   000013 000036                    ADSC9   11,,PR0                  cn=0,n=30
        23 001432   000000 000001 24                 ADSC9   0                        cn=0,n=1
        23 001433   001440 601000 23                 TNZ     s:5316

   5315 23 001434   040100 100500                    MLR     fill='040'O
        23 001435   000003 000036                    ADSC9   3,,PR0                   cn=0,n=30
        23 001436   200012 000040                    ADSC9   TMP_NAME,,AUTO           cn=0,n=32
        23 001437   001443 710000 23                 TRA     s:5317

      390     5316    2                                               ELSE TMP_NAME=TYPE_430.SUB_FIELD_NAME;

   5316 23 001440   040100 100500                    MLR     fill='040'O
        23 001441   000013 000036                    ADSC9   11,,PR0                  cn=0,n=30
        23 001442   200012 000040                    ADSC9   TMP_NAME,,AUTO           cn=0,n=32

      391     5317    2    CALL ZII$FDDESC(TMP_NAME,#FIELD,DF$,#RETRIEVE,NAM1.NAME.TEXT(DR$->RECORD.NAM_IDX))
              5317             ALTRET(ER_FDDESC);

   5317 23 001443   000000 471400 12                 LDP1    DR$
        23 001444   100000 236100                    LDQ     0,,PR1
        23 001445   000022 772000                    QRL     18
        23 001446   000012 402007                    MPY     10,DL
        23 001447   000022 736000                    QLS     18
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:64   
        23 001450   000001 036003                    ADLQ    1,DU
        23 001451   000000 036000 4                  ADLQ    NAM1$
        23 001452   200030 756100                    STQ     TMP_RVA_SIZ+6,,AUTO
        23 001453   000034 237000 24                 LDAQ    28
        23 001454   200026 757100                    STAQ    TMP_RVA_SIZ+4,,AUTO
        23 001455   000033 236000 24                 LDQ     27
        23 001456   200025 756100                    STQ     TMP_RVA_SIZ+3,,AUTO
        23 001457   200012 633500                    EPPR3   TMP_NAME,,AUTO
        23 001460   200024 453500                    STP3    TMP_RVA_SIZ+2,,AUTO
        23 001461   200024 630500                    EPPR0   TMP_RVA_SIZ+2,,AUTO
        23 001462   000001 631400 24                 EPPR1   1
        23 001463   000000 701000 xent               TSX1    ZII$FDDESC
        23 001464   001554 702000 23                 TSX2    ER_FDDESC

      392     5318    2                                               IF TYPE_430.PRIMARY_CON_FIELD = %YES#
              5318                                                        THEN

   5318 23 001465   000000 470400 1                  LDP0    REC$
        23 001466   000000 066500                    CMPB    filb='0'B
        23 001467   000030 020001                    BDSC    24,,PR0                  by=0,bit=2,n=1
        23 001470   000010 000022 24                 BDSC    8                        by=0,bit=0,n=18
        23 001471   001514 600000 23                 TZE     s:5324

      393     5319    3                                               DO;

      394     5320    3                                                   DR$=NAM1.DESC$(FIELD.REC_ASSC_IDX);

   5320 23 001472   000000 471400 20                 LDP1    DF$
        23 001473   100001 236100                    LDQ     1,,PR1
        23 001474   777777 376007                    ANQ     -1,DL
        23 001475   000012 402007                    MPY     10,DL
        23 001476   000000 473400 4                  LDP3    NAM1$
        23 001477   300011 236106                    LDQ     9,QL,PR3
        23 001500   000000 756000 12                 STQ     DR$

      395     5321    3                                                  FIELD.CALC_FLD#=RECORD.NUM_CALC_FLDS
              5321                                                            +1;
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:65   

   5321 23 001501   000000 474400 12                 LDP4    DR$
        23 001502   400002 236100                    LDQ     2,,PR4
        23 001503   000001 036007                    ADLQ    1,DL
        23 001504   200024 756100                    STQ     TMP_RVA_SIZ+2,,AUTO
        23 001505   000100 100500                    MLR     fill='000'O
        23 001506   200024 000004                    ADSC9   TMP_RVA_SIZ+2,,AUTO      cn=0,n=4
        23 001507   100004 400004                    ADSC9   4,,PR1                   cn=2,n=4

      396     5322    3                                                   RECORD.NUM_CALC_FLDS=RECORD.
              5322                                                            NUM_CALC_FLDS+1;

   5322 23 001510   400002 235100                    LDA     2,,PR4
        23 001511   000001 035007                    ADLA    1,DL
        23 001512   400002 755100                    STA     2,,PR4

      397     5323    3                                                   END;

   5323 23 001513   001520 710000 23                 TRA     s:5325

      398     5324    2                                               ELSE FIELD.CALC_FLD#=0;

   5324 23 001514   000000 471400 20                 LDP1    DF$
        23 001515   000100 100400                    MLR     fill='000'O
        23 001516   000010 000004 24                 ADSC9   8                        cn=0,n=4
        23 001517   100004 400004                    ADSC9   4,,PR1                   cn=2,n=4

      399     5325    2                                               FIELD.EIS_BITS=TYPE_430.EIS.EIS_BITS;

   5325 23 001520   000100 100500                    MLR     fill='000'O
        23 001521   000031 400002                    ADSC9   25,,PR0                  cn=2,n=2
        23 001522   100005 400002                    ADSC9   5,,PR1                   cn=2,n=2

      400     5326    2                                               FIELD.FLAGS_2.ELEM=TYPE_430.ELEMENTARY;

   5326 23 001523   003100 060500                    CSL     bolr='003'O
        23 001524   000030 000001                    BDSC    24,,PR0                  by=0,bit=0,n=1
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:66   
        23 001525   100004 010001                    BDSC    4,,PR1                   by=0,bit=1,n=1

      401     5327    2                                               FIELD.FLAGS_2.DATA_TYPE=TYPE_430.
              5327                                                        DATA_TYPE;

   5327 23 001526   003100 061500                    CSR     bolr='003'O
        23 001527   000024 000044                    BDSC    20,,PR0                  by=0,bit=0,n=36
        23 001530   100004 020020                    BDSC    4,,PR1                   by=0,bit=2,n=16

      402     5328    2                                               FIELD.FLAG_BITS_1=TYPE_430.FLAGS;

   5328 23 001531   000100 100500                    MLR     fill='000'O
        23 001532   000032 000004                    ADSC9   26,,PR0                  cn=0,n=4
        23 001533   100003 000004                    ADSC9   3,,PR1                   cn=0,n=4

      403     5329    2                                               IF TYPE_430.FLAGS.TYPE~='111111111111'B
              5329                                                        AND

   5329 23 001534   000000 066500                    CMPB    filb='0'B
        23 001535   000032 000014                    BDSC    26,,PR0                  by=0,bit=0,n=12
        23 001536   000043 000022 24                 BDSC    35                       by=0,bit=0,n=18
        23 001537   001553 600000 23                 TZE     RET
        23 001540   000000 066500                    CMPB    filb='0'B
        23 001541   000032 000014                    BDSC    26,,PR0                  by=0,bit=0,n=12
        23 001542   000044 000022 24                 BDSC    36                       by=0,bit=0,n=18
        23 001543   001553 600000 23                 TZE     RET

      404     5330    2                                                  TYPE_430.FLAGS.TYPE~='111111111110'B
              5330                                                           THEN
      405     5331    3                                               DO;

      406     5332    3                                                   CALL ZII$GET_RVA(#FIELD);

   5332 23 001544   000033 630400 24                 EPPR0   27
        23 001545   000045 631400 24                 EPPR1   37
        23 001546   000000 701000 xent               TSX1    ZII$GET_RVA
        23 001547   000000 011000                    NOP     0
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:67   

      407     5333    3                                                   FIELD.RVA_OFF=RVE_IDX;

   5333 23 001550   000000 220000 3                  LDX0    RVE_IDX
        23 001551   000000 470400 20                 LDP0    DF$
        23 001552   000000 440100                    SXL0    0,,PR0

      408     5334    3                                                   END;

      409     5335    2                                               END;

      410     5336    1   RET:
      411     5337    1       RETURN;

   5337 23 001553   000000 702200 xent  RET          TSX2  ! X66_ARET

      412     5338    1   ER_FDDESC:
      413     5339        /*************************************************************/
      414     5340        /*E*
      415     5341           ERROR: ZII-#BADDESC-C
      416     5342           MESSAGE: Cannot find  NAM2 descriptor for subschema %U1.
      417     5343        */
      418     5344        /***********************************************************/
      419     5345    1       ERROR_CODE=#BADDESC;

   5345 23 001554   011611 235007       ER_FDDESC    LDA     5001,DL
        23 001555   000000 755000 0                  STA     ERROR_CODE

      420     5346    1       GOTO COM_ERR;

   5346 23 001556   001562 710000 23                 TRA     COM_ERR

      421     5347    1   ER_FDRLDSC:
      422     5348        /*************************************************************/
      423     5349        /*E*
      424     5350           ERROR: ZII-#BADLNKRECSET-C
      425     5351           MESSAGE: Cannot  find  relationship descriptor in NAM2 for subschema %U1.
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:68   
      426     5352        */
      427     5353        /************************************************************/
      428     5354    1       ERROR_CODE=#BADLNKRECSET;

   5354 23 001557   011614 235007       ER_FDRLDSC   LDA     5004,DL
        23 001560   000000 755000 0                  STA     ERROR_CODE

      429     5355    1       GOTO COM_ERR;

   5355 23 001561   001562 710000 23                 TRA     COM_ERR

      430     5356    1   COM_ERR:
      431     5357    1       ALTRETURN;

   5357 23 001562   000000 702200 xent  COM_ERR      TSX2  ! X66_AALT

(unnamed)
 Sect OctLoc
  22     000   052104 102120   101122 101115                                    *DBPARAM

(unnamed)
 Sect OctLoc
  24     000   040040 040040   000005 000000   000000 006014   400000 000000        ............
  24     004   000003 006000   000000 006000   000004 000000   000000 000002    ................
  24     010   000000 000000   000007 006000   000000 006000   000010 006000    ................
  24     014   000000 006000   000010 006000   000000 006000   000000 000001    ................
  24     020   000000 006000   000010 006000   000017 006000   777777 377777    ................
  24     024   777777 677777   000000 006000   000000 000010   000026 006000    ................
  24     030   000000 006000   000010 006000   000000 000003   000032 006000    ................
  24     034   000000 006000   000010 006000   000000 006000   000000 000005    ................
  24     040   000000 006000   000010 006000   000037 006000   777700 000000    ................
  24     044   777600 000000   000001 000000                                    ........
      432     5358    1   END ZII$ADD_NAM;

PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:69   
--  Include file information  --

   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZI$DESC.:ZIC0TOU  is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   ZI$USER.:ZIC0TOU  is referenced.
   ZI$STRUCTS.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZII$ADD_NAM.

   Procedure ZII$ADD_NAM requires 883 words for executable code.
   Procedure ZII$ADD_NAM requires 26 words of local(AUTO) storage.

    No errors detected in file ZII$ADD_NAM.:ZIC0TSI    .
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:70   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:71   
          MINI XREF LISTING

AREA.AREA_BITS
      4135**DCL      5297<<ASSIGN
AREA.NAM_IDX
      4133**DCL      5051>>ASSIGN
AREA.RA_DSC$
      4148**DCL      5040>>IF       5042<<ASSIGN   5045>>ASSIGN
COM_ERR
      5357**LABEL    5346--GOTO     5355--GOTO
DA$
      4131**DCL      4132--IMP-PTR  5039<>CALL     5040>>IF       5042>>ASSIGN   5045>>ASSIGN   5051>>ASSIGN
      5296<>CALL     5297>>ASSIGN
DD$
      4325**DCL      4326--IMP-PTR
DESC#
       683**DCL       688--IMP-SIZ
DF$
      4333**DCL      4334--IMP-PTR  5170<>CALL     5171>>ASSIGN   5230<>CALL     5239>>ASSIGN   5240>>IF
      5242>>ASSIGN   5245>>ASSIGN   5317<>CALL     5320>>ASSIGN   5321>>ASSIGN   5324>>ASSIGN   5325>>ASSIGN
      5326>>ASSIGN   5327>>ASSIGN   5328>>ASSIGN   5333>>ASSIGN
DK$
      4229**DCL      4230--IMP-PTR  5137<>CALL     5138>>IF       5140>>ASSIGN   5143>>ASSIGN   5149>>ASSIGN
DP$
      4448**DCL      4449--IMP-PTR  5273<>CALL     5275<>CALL     5276>>IF       5278>>ASSIGN   5281>>ASSIGN
      5287>>ASSIGN
DR$
      4153**DCL      4154--IMP-PTR  5013<>CALL     5014>>IF       5016>>ASSIGN   5019>>ASSIGN   5052>>ASSIGN
      5067<>CALL     5068>>IF       5070>>ASSIGN   5073>>ASSIGN   5095>>ASSIGN   5121<>CALL     5122>>IF
      5124>>ASSIGN   5127>>ASSIGN   5150>>ASSIGN   5260<>CALL     5261>>IF       5263>>ASSIGN   5266>>ASSIGN
      5288>>ASSIGN   5310<>CALL     5311>>ASSIGN   5317>>CALL     5320<<ASSIGN   5321>>ASSIGN   5322>>ASSIGN
      5322>>ASSIGN
DRA$
      4300**DCL      4301--IMP-PTR  4998<>CALL     5016>>ASSIGN   5023>>ASSIGN   5042>>ASSIGN   5049>>ASSIGN
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:72   
      5051>>ASSIGN   5052>>ASSIGN   5053>>ASSIGN   5054>>ASSIGN   5055>>ASSIGN   5056>>ASSIGN   5057>>ASSIGN
      5058>>ASSIGN
DRFK$
      4284**DCL      4285--IMP-PTR  5116<>CALL     5124>>ASSIGN   5131>>ASSIGN   5140>>ASSIGN   5147>>ASSIGN
      5149>>ASSIGN   5150>>ASSIGN   5151>>ASSIGN   5152>>ASSIGN   5153>>ASSIGN   5154>>ASSIGN   5155>>ASSIGN
      5156>>ASSIGN   5157>>ASSIGN   5229<>CALL     5235>>ASSIGN   5237>>ASSIGN   5238>>ASSIGN   5239>>ASSIGN
      5242>>ASSIGN   5249>>ASSIGN   5251>>ASSIGN   5252>>ASSIGN   5253>>ASSIGN   5254>>ASSIGN   5255>>ASSIGN
DRFS$
      4239**DCL      4240--IMP-PTR  5062<>CALL     5070>>ASSIGN   5077>>ASSIGN   5086>>ASSIGN   5093>>ASSIGN
      5095>>ASSIGN   5096>>ASSIGN   5099>>ASSIGN   5100>>ASSIGN   5102>>ASSIGN   5103>>ASSIGN   5104>>ASSIGN
      5105>>ASSIGN   5106>>ASSIGN   5107>>ASSIGN   5108>>ASSIGN   5109>>ASSIGN   5110>>ASSIGN   5111>>ASSIGN
      5112>>ASSIGN   5163<>CALL     5168>>ASSIGN   5169>>ASSIGN   5171>>ASSIGN   5172>>ASSIGN   5180>>ASSIGN
      5187>>ASSIGN   5192>>IF       5193>>ASSIGN   5193>>ASSIGN   5196>>ASSIGN   5200>>ASSIGN   5205>>ASSIGN
      5206>>ASSIGN   5207>>ASSIGN   5208>>ASSIGN   5209>>ASSIGN
DRP$
      4315**DCL      4316--IMP-PTR  5259<>CALL     5263>>ASSIGN   5270>>ASSIGN   5278>>ASSIGN   5285>>ASSIGN
      5287>>ASSIGN   5288>>ASSIGN   5289>>ASSIGN   5290>>ASSIGN   5291>>ASSIGN
DS$
      4187**DCL      4188--IMP-PTR  5083<>CALL     5084>>IF       5086>>ASSIGN   5089>>ASSIGN   5096>>ASSIGN
      5099>>ASSIGN   5303<>CALL     5304>>ASSIGN
DSC_PARAM.NAM_IDX
      4450**DCL      5287>>ASSIGN
DSC_PARAM.RP_DSC$
      4461**DCL      5276>>IF       5278<<ASSIGN   5281>>ASSIGN
ERROR_CODE
        25**DCL      5345<<ASSIGN   5354<<ASSIGN
ER_FDDESC
      5345**LABEL    5013--CALLALT  5039--CALLALT  5067--CALLALT  5083--CALLALT  5121--CALLALT  5137--CALLALT
      5170--CALLALT  5230--CALLALT  5260--CALLALT  5273--CALLALT  5275--CALLALT  5296--CALLALT  5303--CALLALT
      5310--CALLALT  5317--CALLALT
ER_FDRLDSC
      5354**LABEL    4998--CALLALT  5062--CALLALT  5116--CALLALT  5163--CALLALT  5164--CALLALT  5228--CALLALT
      5229--CALLALT  5259--CALLALT
FIELD.CALC_FLD#
      4403**DCL      5321<<ASSIGN   5324<<ASSIGN
FIELD.EIS_BITS
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:73   
      4404**DCL      5325<<ASSIGN
FIELD.EIS_BITS.NDSC
      4405**DCL      4434--REDEF
FIELD.FLAGS_2.DATA_TYPE
      4381**DCL      5327<<ASSIGN
FIELD.FLAGS_2.ELEM
      4378**DCL      5326<<ASSIGN
FIELD.FLAG_BITS_1
      4346**DCL      4347--REDEF    5328<<ASSIGN
FIELD.FLAG_BITS_2
      4373**DCL      4374--REDEF
FIELD.NAM_IDX
      4335**DCL      5171>>ASSIGN   5239>>ASSIGN
FIELD.REC_ASSC_IDX
      4339**DCL      5320>>ASSIGN
FIELD.RFK_DSC$
      4444**DCL      5240>>IF       5242<<ASSIGN   5245>>ASSIGN
FIELD.RFS_DSC$
      4443**DCL      5192>>IF       5193<<ASSIGN   5196>>ASSIGN
FIELD.RVA_OFF
      4336**DCL      5333<<ASSIGN
HRFK$
        19**DCL      5228<>CALL     5231>>ASSIGN   5237>>ASSIGN   5238>>ASSIGN
HRFS$
        16**DCL      5164<>CALL     5168>>ASSIGN   5169>>ASSIGN   5179>>IF       5180>>ASSIGN   5183>>ASSIGN
KEY.NAM_IDX
      4231**DCL      5149>>ASSIGN
KEY.RFK_DSC$
      4234**DCL      5138>>IF       5140<<ASSIGN   5143>>ASSIGN
NAM1.DESC$
       674**DCL      5192>>IF       5193>>ASSIGN   5196>>ASSIGN   5320>>ASSIGN
NAM1.NAME.TEXT
       673**DCL      5317<>CALL
NAM1$
       656**DCL       659--IMP-PTR  5192>>IF       5193>>ASSIGN   5196>>ASSIGN   5317>>CALL     5320>>ASSIGN
NAM2.DESC
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:74   
       687**DCL       688--REDEF
NAM2$
       681**DCL       684--IMP-PTR
RA_DSC.AREA$
      4311**DCL      5046>>DOWHILE  5047>>ASSIGN   5049<<ASSIGN   5057<<ASSIGN
RA_DSC.AREA_IDX
      4303**DCL      5051<<ASSIGN
RA_DSC.FLAGS
      4306**DCL      5055<<ASSIGN
RA_DSC.HI_DBK_RNG
      4305**DCL      5054<<ASSIGN
RA_DSC.LLIST$
      4312**DCL      5058<<ASSIGN
RA_DSC.LO_DBK_RNG
      4304**DCL      5053<<ASSIGN
RA_DSC.REC$
      4310**DCL      5020>>DOWHILE  5021>>ASSIGN   5023<<ASSIGN   5056<<ASSIGN
RA_DSC.REC_IDX
      4302**DCL      5052<<ASSIGN
REC$
        26**DCL      2589--IMP-PTR  2637--IMP-PTR  2703--IMP-PTR  2751--IMP-PTR  2792--IMP-PTR  2832--IMP-PTR
      2881--IMP-PTR  2940--IMP-PTR  2986--IMP-PTR  3055--IMP-PTR  3111--IMP-PTR  3178--IMP-PTR  4996>>IF
      4998>>CALL     4998>>CALL     5013>>CALL     5039>>CALL     5053>>ASSIGN   5054>>ASSIGN   5055>>ASSIGN
      5060>>IF       5062>>CALL     5062>>CALL     5067>>CALL     5083>>CALL     5097>>IF       5102>>IF
      5103>>IF       5105>>IF       5106>>ASSIGN   5107>>ASSIGN   5114>>IF       5116>>CALL     5116>>CALL
      5121>>CALL     5137>>CALL     5151>>ASSIGN   5152>>ASSIGN   5159>>IF       5161>>IF       5163>>CALL
      5163>>CALL     5163>>CALL     5164>>CALL     5164>>CALL     5170>>CALL     5170>>CALL     5172>>ASSIGN
      5212>>IF       5228>>CALL     5228>>CALL     5229>>CALL     5229>>CALL     5229>>CALL     5230>>CALL
      5230>>CALL     5257>>IF       5259>>CALL     5259>>CALL     5259>>CALL     5260>>CALL     5272>>IF
      5273>>CALL     5273>>CALL     5275>>CALL     5275>>CALL     5293>>IF       5295>>ASSIGN   5297>>ASSIGN
      5299>>IF       5301>>IF       5301>>ASSIGN   5302>>ASSIGN   5304>>ASSIGN   5306>>IF       5308>>IF
      5308>>ASSIGN   5309>>ASSIGN   5311>>ASSIGN   5313>>IF       5315>>IF       5315>>ASSIGN   5316>>ASSIGN
      5318>>IF       5325>>ASSIGN   5326>>ASSIGN   5327>>ASSIGN   5328>>ASSIGN   5329>>IF       5329>>IF
RECORD.FLAG_BITS
      4158**DCL      4159--REDEF    5311<<ASSIGN
RECORD.NAM_IDX
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:75   
      4155**DCL      5052>>ASSIGN   5095>>ASSIGN   5150>>ASSIGN   5288>>ASSIGN   5317>>CALL
RECORD.NUM_CALC_FLDS
      4178**DCL      5321>>ASSIGN   5322<<ASSIGN   5322>>ASSIGN
RECORD.RA_DSC$
      4179**DCL      5014>>IF       5016<<ASSIGN   5019>>ASSIGN
RECORD.RFK_DSC$
      4183**DCL      5122>>IF       5124<<ASSIGN   5127>>ASSIGN
RECORD.RFS_DSC$
      4182**DCL      5068>>IF       5070<<ASSIGN   5073>>ASSIGN
RECORD.RP_DSC$
      4180**DCL      5261>>IF       5263<<ASSIGN   5266>>ASSIGN
RFK_DSC.FLD$
      4296**DCL      5156<<ASSIGN   5232>>DOWHILE  5233>>ASSIGN   5235<<ASSIGN   5254<<ASSIGN
RFK_DSC.FLD_IDX
      4288**DCL      5239<<ASSIGN
RFK_DSC.KEY$
      4295**DCL      5144>>DOWHILE  5145>>ASSIGN   5147<<ASSIGN   5155<<ASSIGN   5253<<ASSIGN
RFK_DSC.KEY_IDX
      4287**DCL      5149<<ASSIGN   5238<<ASSIGN   5238>>ASSIGN
RFK_DSC.LFLD$
      4292**DCL      5153<<ASSIGN   5246>>DOWHILE  5247>>ASSIGN   5249<<ASSIGN   5251<<ASSIGN
RFK_DSC.LLIST$
      4297**DCL      5157<<ASSIGN   5255<<ASSIGN
RFK_DSC.NUM_CON_FIELDS
      4289**DCL      5151<<ASSIGN
RFK_DSC.PRIM_SEC
      4290**DCL      5152<<ASSIGN
RFK_DSC.REC$
      4294**DCL      5128>>DOWHILE  5129>>ASSIGN   5131<<ASSIGN   5154<<ASSIGN   5252<<ASSIGN
RFK_DSC.REC_IDX
      4286**DCL      5150<<ASSIGN   5237<<ASSIGN   5237>>ASSIGN
RFS_DSC.ASCEND_DESCEND
      4255**DCL      5172<<ASSIGN
RFS_DSC.DEF
      4258**DCL      5106<<ASSIGN
RFS_DSC.FLD$
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:76   
      4280**DCL      5111<<ASSIGN   5197>>DOWHILE  5198>>ASSIGN   5200<<ASSIGN   5207<<ASSIGN
RFS_DSC.FLD_IDX
      4243**DCL      5171<<ASSIGN   5192>>IF       5193>>ASSIGN   5196>>ASSIGN
RFS_DSC.LFLD$
      4277**DCL      5108<<ASSIGN   5179>>IF       5180<<ASSIGN   5183>>ASSIGN   5184>>DOWHILE  5185>>ASSIGN
      5187<<ASSIGN   5208<<ASSIGN
RFS_DSC.LLIST$
      4281**DCL      5112<<ASSIGN   5209<<ASSIGN
RFS_DSC.MAN_AUTO
      4247**DCL      5105<<ASSIGN
RFS_DSC.MND_OPT
      4251**DCL      5103<<ASSIGN   5104<<ASSIGN
RFS_DSC.NUM_CON_FIELDS
      4276**DCL      5107<<ASSIGN
RFS_DSC.OWN_MEM
      4244**DCL      5100<<ASSIGN   5102<<ASSIGN
RFS_DSC.REC$
      4278**DCL      5074>>DOWHILE  5075>>ASSIGN   5077<<ASSIGN   5109<<ASSIGN   5205<<ASSIGN
RFS_DSC.REC_IDX
      4241**DCL      5095<<ASSIGN   5099>>ASSIGN   5168<<ASSIGN   5168>>ASSIGN
RFS_DSC.SET$
      4279**DCL      5090>>DOWHILE  5091>>ASSIGN   5093<<ASSIGN   5110<<ASSIGN   5206<<ASSIGN
RFS_DSC.SET_IDX
      4242**DCL      5096<<ASSIGN   5169<<ASSIGN   5169>>ASSIGN
RP_DSC.LLIST$
      4322**DCL      5291<<ASSIGN
RP_DSC.PARAM$
      4321**DCL      5282>>DOWHILE  5283>>ASSIGN   5285<<ASSIGN   5290<<ASSIGN
RP_DSC.PARAM_IDX
      4318**DCL      5287<<ASSIGN
RP_DSC.REC$
      4320**DCL      5267>>DOWHILE  5268>>ASSIGN   5270<<ASSIGN   5289<<ASSIGN
RP_DSC.REC_IDX
      4317**DCL      5288<<ASSIGN
RVA.RVE.EO
       844**DCL       845--REDEF
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:77   
RVA$
       837**DCL       838--IMP-PTR
RVE_IDX
        28**DCL      5333>>ASSIGN
SET.FLAG_BITS
      4193**DCL      4194--REDEF    5304<<ASSIGN
SET.NAM_IDX
      4189**DCL      5096>>ASSIGN
SET.OWNER_IDX
      4191**DCL      5099<<ASSIGN
SET.RFS_DSC$
      4225**DCL      5084>>IF       5086<<ASSIGN   5089>>ASSIGN
TDRA$
        20**DCL      5019<<ASSIGN   5020>>DOWHILE  5021<<ASSIGN   5021>>ASSIGN   5023>>ASSIGN   5045<<ASSIGN
      5046>>DOWHILE  5047<<ASSIGN   5047>>ASSIGN   5049>>ASSIGN
TDRFK$
        17**DCL      5127<<ASSIGN   5128>>DOWHILE  5129<<ASSIGN   5129>>ASSIGN   5131>>ASSIGN   5143<<ASSIGN
      5144>>DOWHILE  5145<<ASSIGN   5145>>ASSIGN   5147>>ASSIGN   5231<<ASSIGN   5232>>DOWHILE  5233<<ASSIGN
      5233>>ASSIGN   5235>>ASSIGN   5245<<ASSIGN   5246>>DOWHILE  5247<<ASSIGN   5247>>ASSIGN   5249>>ASSIGN
TDRFS$
        15**DCL      5073<<ASSIGN   5074>>DOWHILE  5075<<ASSIGN   5075>>ASSIGN   5077>>ASSIGN   5089<<ASSIGN
      5090>>DOWHILE  5091<<ASSIGN   5091>>ASSIGN   5093>>ASSIGN   5183<<ASSIGN   5184>>DOWHILE  5185<<ASSIGN
      5185>>ASSIGN   5187>>ASSIGN   5196<<ASSIGN   5197>>DOWHILE  5198<<ASSIGN   5198>>ASSIGN   5200>>ASSIGN
TDRP$
        18**DCL      5266<<ASSIGN   5267>>DOWHILE  5268<<ASSIGN   5268>>ASSIGN   5270>>ASSIGN   5281<<ASSIGN
      5282>>DOWHILE  5283<<ASSIGN   5283>>ASSIGN   5285>>ASSIGN
TMP_NAME
        22**DCL      4995<<ASSIGN   5295<<ASSIGN   5296<>CALL     5301<<ASSIGN   5302<<ASSIGN   5303<>CALL
      5308<<ASSIGN   5309<<ASSIGN   5310<>CALL     5315<<ASSIGN   5316<<ASSIGN   5317<>CALL
TYPE_200.AREA_BITS
      2949**DCL      5297>>ASSIGN
TYPE_200.SUB_AREA_NAME
      2946**DCL      5295>>ASSIGN
TYPE_300.FLAGS.INFO_BITS
      2998**DCL      5304>>ASSIGN
TYPE_300.INFO
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:78   
      2995**DCL      2996--REDEF
TYPE_300.SET_NAME
      2990**DCL      5301>>ASSIGN
TYPE_300.SUB_SET_NAME
      2992**DCL      5301>>IF       5302>>ASSIGN
TYPE_31.FLAGS
      2600**DCL      5055>>ASSIGN
TYPE_31.HI_DBK_RNG
      2599**DCL      5054>>ASSIGN
TYPE_31.LO_DBK_RNG
      2598**DCL      5053>>ASSIGN
TYPE_31.SUB_AREA_NM
      2597**DCL      4998<>CALL     5039<>CALL
TYPE_31.SUB_RECORD_NM
      2596**DCL      4998<>CALL     5013<>CALL
TYPE_32.DEF
      2650**DCL      5106>>ASSIGN
TYPE_32.MANUAL_MEM
      2645**DCL      5105>>IF
TYPE_32.MEMBER
      2643**DCL      5102>>IF
TYPE_32.NUM_CON_FIELDS
      2668**DCL      5107>>ASSIGN
TYPE_32.OPTIONAL_MEM
      2644**DCL      5103>>IF
TYPE_32.OWNER
      2642**DCL      5097>>IF
TYPE_32.SUB_RECORD_NM
      2648**DCL      5062<>CALL     5067<>CALL
TYPE_32.SUB_SET_NM
      2649**DCL      5062<>CALL     5083<>CALL
TYPE_33.NUM_CON_FIELDS
      2711**DCL      5151>>ASSIGN
TYPE_33.PRIM_OR_SEC
      2712**DCL      5152>>ASSIGN
TYPE_33.SUB_KEY_NM
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:79   
      2710**DCL      5116<>CALL     5137<>CALL
TYPE_33.SUB_RECORD_NM
      2709**DCL      5116<>CALL     5121<>CALL
TYPE_34.ASSEND_OR_DESCEND
      2756**DCL      5172>>ASSIGN
TYPE_34.SUB_FIELD_NM
      2759**DCL      5163<>CALL     5170<>CALL
TYPE_34.SUB_RECORD_NM
      2761**DCL      5163<>CALL     5164<>CALL     5170<>CALL
TYPE_34.SUB_SET_NM
      2760**DCL      5163<>CALL     5164<>CALL
TYPE_34.THEN_THRU_FIELD
      2757**DCL      5161>>IF
TYPE_35.SUB_FIELD_NM
      2798**DCL      5229<>CALL     5230<>CALL
TYPE_35.SUB_KEY_NM
      2799**DCL      5228<>CALL     5229<>CALL
TYPE_35.SUB_RECORD_NM
      2800**DCL      5228<>CALL     5229<>CALL     5230<>CALL
TYPE_37.SUB_FIELD_NM
      2838**DCL      5259<>CALL     5273<>CALL     5275<>CALL
TYPE_37.SUB_RECORD_NM
      2840**DCL      5259<>CALL     5272>>IF       5275<>CALL
TYPE_37.SUB_RECORD_ST_NM
      2839**DCL      5259<>CALL     5260<>CALL     5273<>CALL
TYPE_400.FLAGS.INFO_BITS
      3067**DCL      5311>>ASSIGN
TYPE_400.INFO
      3064**DCL      3065--REDEF
TYPE_400.RECORD_NAME
      3059**DCL      5308>>ASSIGN
TYPE_400.SUB_RECORD_NAME
      3061**DCL      5308>>IF       5309>>ASSIGN
TYPE_430.DATA_TYPE
      3187**DCL      5327>>ASSIGN
TYPE_430.EIS.ADDER
PL6.E3A0      #001=ZII$ADD_NAM File=ZII$ADD_NAM.:ZIC0TSI                         FRI 09/05/97 12:24 Page:80   
      3197**DCL      3198--REDEF    3199--REDEF
TYPE_430.EIS.EIS_BITS
      3202**DCL      3203--REDEF    3207--REDEF    3235--REDEF    5325>>ASSIGN
TYPE_430.ELEMENTARY
      3191**DCL      5326>>ASSIGN
TYPE_430.FIELD_NAME
      3182**DCL      5315>>ASSIGN
TYPE_430.FLAGS
      3245**DCL      5328>>ASSIGN
TYPE_430.FLAGS.TYPE
      3246**DCL      5329>>IF       5329>>IF
TYPE_430.INFO
      3244**DCL      3245--REDEF
TYPE_430.PRIMARY_CON_FIELD
      3193**DCL      5318>>IF
TYPE_430.SUB_FIELD_NAME
      3184**DCL      5315>>IF       5316>>ASSIGN
TYPE_430.TYPE
      3179**DCL      4996>>IF       5060>>IF       5114>>IF       5159>>IF       5212>>IF       5257>>IF
      5293>>IF       5299>>IF       5306>>IF       5313>>IF
ZII$FDDESC
        30**DCL-ENT  5013--CALL     5039--CALL     5067--CALL     5083--CALL     5121--CALL     5137--CALL
      5170--CALL     5230--CALL     5260--CALL     5273--CALL     5275--CALL     5296--CALL     5303--CALL
      5310--CALL     5317--CALL
ZII$FDRLDSC
        32**DCL-ENT  4998--CALL     5062--CALL     5116--CALL     5163--CALL     5164--CALL     5228--CALL
      5229--CALL     5259--CALL
ZII$GET_RVA
        33**DCL-ENT  5332--CALL
