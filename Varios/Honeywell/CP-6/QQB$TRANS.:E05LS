VERSION E05

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:1    
        1        1        /*M* QQB$TRANS - Perform  TRANSACTION  command */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QQB$TRANS:
        9        9                PROC;
       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE CP_6_SUBS;
       16      690        %INCLUDE B_ERRORS_C;
       17     1817        %INCLUDE XU_MACRO_C;
       18     4923        %INCLUDE QQ_SUBS_C;
       19     5115        %INCLUDE QQ_MACROS_C;
       20     5540        %INCLUDE QQ_DATA_R;
       21     5786        %INCLUDE QQ_PERR_C;
       22     5947        %INCLUDE Q_ERRCODE_C;
       23     5970        %PAGE(ARG="Externally defined routines");

              5987    1   /***************************************************************************
              5988    1    *                                                                         *
              5989    1    *                        Externally defined routines                      *
              5990    1    *                                                                         *
              5991    1    ***************************************************************************/

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:2    
       24     5995    1   DCL QQB$SAVCMD  ENTRY;
       25     5996    1   DCL QQC$SCREECH ENTRY;
       26     5997    1   DCL QQC$BLDMSG_BLK ENTRY(1);
       27     5998    1   DCL QQC$BLDMSG ENTRY(1);
       28     5999    1   DCL QQC$START_TPU ENTRY(4) ALTRET;
       29     6000    1   DCL QQC$WILD_COMP ENTRY(2) ALTRET;
       30     6001    1   DCL QQC$CONVERT_NUM ENTRY(3);
       31     6002        %PAGE(ARG="Symrefs");

              6019    1   /***************************************************************************
              6020    1    *                                                                         *
              6021    1    *                                  Symrefs                                *
              6022    1    *                                                                         *
              6023    1    ***************************************************************************/

       32     6027    1   DCL B$TCB$ PTR SYMREF;
       33     6028        %PAGE(ARG="DCBs");

              6045    1   /***************************************************************************
              6046    1    *                                                                         *
              6047    1    *                                    DCBs                                 *
              6048    1    *                                                                         *
              6049    1    ***************************************************************************/

       34     6053    1   DCL M$CG DCB;
       35     6054        %PAGE(ARG="Based");

              6071    1   /***************************************************************************
              6072    1    *                                                                         *
              6073    1    *                                   Based                                 *
              6074    1    *                                                                         *
              6075    1    ***************************************************************************/

       36     6079        %B$TCB;
       37     6082        %B$ALT;
       38     6090        %TPU$INFO;
       39     6119        %TP$STATION;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:3    
       40     6192        %PARSE$OUT(STCLASS=BASED);
       41     6237        %PARSE$SYM(STCLASS=BASED);
       42     6275        %PAGE(ARG="Constants");

              6292    1   /***************************************************************************
              6293    1    *                                                                         *
              6294    1    *                                 Constants                               *
              6295    1    *                                                                         *
              6296    1    ***************************************************************************/

       43     6300        %VLP_CGTYPL(FPTN=VLP_CGTYPL_C, STCLASS=CONSTANT);
       44     6325
       45     6326        %VLP_CGQL(FPTN=VLP_CGQL_C, STCLASS=CONSTANT);
       46     6348        %PAGE(ARG="Static");

              6365    1   /***************************************************************************
              6366    1    *                                                                         *
              6367    1    *                                   Static                                *
              6368    1    *                                                                         *
              6369    1    ***************************************************************************/

       47     6373    1   DCL STATION CHAR(8) STATIC;
       48     6374        %PAGE(ARG="Auto");

              6391    1   /***************************************************************************
              6392    1    *                                                                         *
              6393    1    *                                    Auto                                 *
              6394    1    *                                                                         *
              6395    1    ***************************************************************************/

       49     6399    1   DCL NEXT$ PTR;
       50     6400    1   DCL JOURNAL$ PTR;
       51     6401    1   DCL ONEREPORT$ PTR;
       52     6402    1   DCL SUBLK$ PTR;
       53     6403    1   DCL PRIO$ PTR;
       54     6404    1   DCL MAXLATCH$ PTR;
       55     6405    1   DCL PERM$ PTR;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:4    
       56     6406    1   DCL TYPE$ PTR;
       57     6407    1   DCL MAXACTIVE$ PTR;
       58     6408    1   DCL TIMEOUT$ PTR;
       59     6409    1   DCL OLD_SUBLK$ PTR;
       60     6410
       61     6411    1   DCL I SBIN WORD;
       62     6412    1   DCL NSUBLKS UBIN WORD;
       63     6413    1   DCL POS UBIN WORD;
       64     6414    1   DCL OLD_PRIO UBIN WORD;
       65     6415    1   DCL NEW_PRIO SBIN WORD;
       66     6416    1   DCL OLD_MAXLATCH UBIN WORD;
       67     6417    1   DCL NEW_MAXLATCH SBIN WORD;
       68     6418    1   DCL OLD_MAXACTIVE UBIN WORD;
       69     6419    1   DCL NEW_MAXACTIVE SBIN WORD;
       70     6420    1   DCL OLD_PERM UBIN WORD;
       71     6421    1   DCL NEW_PERM SBIN WORD;
       72     6422    1   DCL TIMEOUT UBIN WORD;
       73     6423    1   DCL DELTA SBIN WORD;
       74     6424    1   DCL DELTA_PERM SBIN WORD;
       75     6425    1   DCL MULTIPLIER SBIN WORD;
       76     6426    1   DCL SIZE UBIN WORD;
       77     6427
       78     6428    1   DCL MSGTYP CHAR(8);
       79     6429
       80     6430    1   DCL WILD_FLAG BIT(1) ALIGNED;
       81     6431    1   DCL NEW_JOURNAL_FLAG BIT(1) ALIGNED;
       82     6432    1   DCL OLD_JOURNAL_FLAG BIT(1) ALIGNED;
       83     6433    1   DCL NEW_ONEREPORT_FLAG BIT(1) ALIGNED;
       84     6434    1   DCL OLD_ONEREPORT_FLAG BIT(1) ALIGNED;
       85     6435    1   DCL NOW_FLAG BIT(1) ALIGNED;
       86     6436
       87     6437        %MSGBLK;
       88     6527        %VLP_NAME(FPTN=TEXTC_NUM, NAME='12345678');
       89     6554    1   DCL 1 ERR,
       90     6555    1         2 FCG BIT(12) UNAL,
       91     6556    1         2 MID BIT(6) UNAL,
       92     6557    1         2 MON BIT(1) UNAL,
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:5    
       93     6558    1         2 CODE UBIN(14) UNAL,
       94     6559    1         2 SEV UBIN(3) UNAL;
       95     6560        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:6    
              6577    1   /***************************************************************************
              6578    1    *                                                                         *
              6579    1    *                                Error codes                              *
              6580    1    *                                                                         *
              6581    1    ***************************************************************************/

       96     6585        %ERRCODE(NAME=CODE_NMOT, CODE#=%E$NMOT, FCG#=%FCG_QQ, MID#=%MID_B);
       97     6592        %ERRCODE(NAME=CODE_IWT, CODE#=%E$IWT, FCG#=%FCG_QQ, MID#=%MID_B);
       98     6599        %ERRCODE(NAME=CODE_NWH, CODE#=%E$NWH, FCG#=%FCG_QQ, MID#=%MID_B);
       99     6606        %ERRCODE(NAME=CODE_NOTDEF, CODE#=%E$NOTDEF, FCG#=%FCG_QQ, MID#=%MID_B);
      100     6613        %ERRCODE(NAME=CODE_BIGGEST_PRIO, CODE#=%E$BIGGEST_PRIO, FCG#=%FCG_QQ, MID#=%MID_B);
      101     6620        %ERRCODE(NAME=CODE_SMALLEST_PRIO, CODE#=%E$SMALLEST_PRIO, FCG#=%FCG_QQ, MID#=%MID_B)
              6620            ;
      102     6627        %ERRCODE(NAME=CODE_SMALLEST_MAXACT, CODE#=%E$SMALLEST_MAXACT, FCG#=%FCG_QQ, MID#=
              6627            %MID_B);
      103     6634        %ERRCODE(NAME=CODE_NOTENUF_TPUS, CODE#=%E$NOTENUF_TPUS, FCG#=%FCG_QQ, MID#=%MID_B);
      104     6641        %ERRCODE(NAME=CODE_BIGR_MAXACT, CODE#=%E$BIGR_MAXACT, FCG#=%FCG_QQ, MID#=%MID_B);
      105     6648        %ERRCODE(NAME=CODE_CST, CODE#=%E$CST, FCG#=%FCG_QQ, MID#=%MID_B);
      106     6655        %ERRCODE(NAME=CODE_DUPL, CODE#=%E$DUPL, FCG#=%FCG_QQ, MID#=%MID_B);
      107     6662        %ERRCODE(NAME=CODE_NOWWT, CODE#=%E$NOWWT, FCG#=%FCG_QQ, MID#=%MID_B);
      108     6669        %ERRCODE(NAME=CODE_SMALLEST_TIMEOUT, CODE#=%E$SMALLEST_TIMEOUT, FCG#=%FCG_QQ, MID#=
              6669            %MID_B);
      109     6676        %ERRCODE(NAME=CODE_BIGGEST_TIMEOUT, CODE#=%E$BIGGEST_TIMEOUT, FCG#=%FCG_QQ, MID#=
              6676            %MID_B);
      110     6683        %ERRCODE(NAME=CODE_SMALLEST_MAXLATCH, CODE#=%E$SMALLEST_MAXLATCH, FCG#=%FCG_QQ, MID#
              6683            =%MID_B);
      111     6690        %ERRCODE(NAME=CODE_BIGGEST_MAXLATCH, CODE#=%E$BIGGEST_MAXLATCH, FCG#=%FCG_QQ, MID#=
              6690            %MID_B);
      112     6697        %ERRCODE(NAME=CODE_TWOP, CODE#=%E$TWOP, FCG#=%FCG_QQ, MID#=%MID_B);
      113     6704
      114     6705        /*E*       ERROR: QQB-E$NMOT-C
      115     6706
      116     6707                 MESSAGE: This command is incomplete.
      117     6708             DESCRIPTION: Although the command that was provided is
      118     6709                          syntactically correct the command does
      119     6710                          not direct me to do anything.
      120     6711        */
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:7    
      121     6712        /*E*       ERROR: QQB-E$IWT-C
      122     6713
      123     6714                 MESSAGE: The specified transaction type is invalid.
      124     6715                          Wildcarded types may only have a ? as the last
      125     6716                          character of the transaction type.
      126     6717                          e. g., A?B? is illegal, ? or AB? are legal.
      127     6718             DESCRIPTION: Wild carded transaction types are more restrictive
      128     6719                          than generalized wild carding.  The rules are
      129     6720                          only one ?, and the ? must be the last character
      130     6721                          of the transaction type.  In addition ? may not
      131     6722                          be the only character E.G., ????.
      132     6723        */
      133     6724        /*E*       ERROR: QQB-E$NWH-C
      134     6725
      135     6726                 MESSAGE: Wildcarded transaction types may not be used
      136     6727                          in conjunction with any option other than PERM.
      137     6728             DESCRIPTION: If wild carded transaction types were permitted
      138     6729                          here the whole comgroup would have to be
      139     6730                          searched for match to the wild carded type.
      140     6731                          This operation would be time consuming
      141     6732                          (and take a gob of code).
      142     6733        */
      143     6734        /*E*       ERROR: QQB-E$NOTDEF-C
      144     6735
      145     6736                 MESSAGE: The +- suboptions can only be used for transaction
      146     6737                          types that have been specifically defined.
      147     6738             DESCRIPTION: This restriction is to make sure the user knows
      148     6739                          what he is doing.  A transaction can get specifically
      149     6740                          3 ways: 1) TRANSACTION A PRIO=7    2) Define it
      150     6741                          in the TRADER file with a PRIO or MAXACTIVE
      151     6742                          3) Actually have the transaction used
      152     6743
      153     6744        */
      154     6745        /*E*       ERROR: QQB-E$SMALLEST_MAXACT-C
      155     6746
      156     6747                 MESSAGE: The value for MAXACTIVE may not be less than 1.
      157     6748                          1 has been substituted.
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:8    
      158     6749             DESCRIPTION: A specified value for  MAXACTIVE  was illegal.
      159     6750                          The smallest permissible value has been substituted.
      160     6751        */
      161     6752        /*E*       ERROR: QQB-E$NOTENUF_TPUS-C
      162     6753
      163     6754                 MESSAGE: This command requests elimination of more
      164     6755                          TPUs than are actually running.  This command
      165     6756                          is ignored.
      166     6757             DESCRIPTION: The  PERM  is being used to take away a greater
      167     6758                          number of permanent TPUs than you actually have
      168     6759                          running and processing this transaction
      169     6760                          type.
      170     6761        */
      171     6762        /*E*       ERROR: QQB-E$BIGR_MAXACT-C
      172     6763
      173     6764                 MESSAGE: Warning:  MAXACTIVE is less than PERM; therefore
      174     6765                          some permanent TPUs cannot be activated.
      175     6766             DESCRIPTION: If  MAXACTIVE  for a transaction type is <  PERM
      176     6767                          then some of the TPUs will not be doing anything.
      177     6768                          It would be a waste to permit this to take place.
      178     6769        */
      179     6770        /*E*       ERROR: QQB-E$CST-C
      180     6771
      181     6772                 MESSAGE: CONTROL limit for TPUs in this instance of TP
      182     6773                          reached.  Only %U1 TPU(s) were started.
      183     6774             DESCRIPTION: The system would not permit me to start the
      184     6775                          requested number of TPUs.  As many as possible
      185     6776                          have been started.
      186     6777        */
      187     6778        /*E*       ERROR: QQB-E$DUPL-C
      188     6779
      189     6780                 MESSAGE: A duplicate parameter has been found.  The last
      190     6781                          one specified has been used.
      191     6782             DESCRIPTION: No parameter should be used more than once.  The
      192     6783                          user has specified one of the parameters of
      193     6784                          this command more than once.  The last
      194     6785                          occurrence of that parameter specified was used.
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:9    
      195     6786        */
      196     6787        /*E*       ERROR: QQB-E$NOWWT-C
      197     6788
      198     6789                 MESSAGE: Transactions type can not be wildcarded when NOW
      199     6790                          option is specified.
      200     6791             DESCRIPTION: Wildcarded type is not allowed when NOW option is
      201     6792                          present.
      202     6793        */
      203     6794        /*E*       ERROR: QQB-E$SMALLEST_TIMEOUT-C
      204     6795
      205     6796                 MESSAGE: The value for TIMEOUT may not be less than 1 minute.
      206     6797                          1 minute has been substituted.
      207     6798             DESCRIPTION: A specified value for  TIMEOUT  was illegal.
      208     6799                          The smallest permissible value has been substituted.
      209     6800        */
      210     6801        /*E*       ERROR: QQB-E$BIGGEST_TIMEOUT-C
      211     6802
      212     6803                 MESSAGE: The value for TIMEOUT may not exceed 4000 minutes.
      213     6804                          4000 has been substituted.
      214     6805             DESCRIPTION: A specified value for  TIMEOUT  was illegal.
      215     6806                          The largest permissible value has been substituted.
      216     6807        */
      217     6808        /*E*       ERROR: QQB-E$SMALLEST_MAXLATCH-C
      218     6809
      219     6810                 MESSAGE: The value for MAXLATCH may not be less than 1.
      220     6811                          1 has been substituted.
      221     6812             DESCRIPTION: A specified value for  MAXLATCH  was illegal.
      222     6813                          The smallest permissible value has been substituted.
      223     6814        */
      224     6815        /*E*       ERROR: QQB-E$BIGGEST_MAXLATCH-C
      225     6816
      226     6817                 MESSAGE: The value for MAXLATCH may not exceed 263000.
      227     6818                          263000 has been substituted.
      228     6819             DESCRIPTION: A specified value for  MAXLATCH  was illegal.
      229     6820                          The largest permissible value has been substituted.
      230     6821        */
      231     6822        /*E*       ERROR: QQB-E$TWOP-C
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:10   
      232     6823
      233     6824                 MESSAGE: The option TIMEOUT is meaningless without PERM.
      234     6825                          No value for TIMEOUT has been set.
      235     6826             DESCRIPTION: A value was specified for TIMEOUT without PERM.
      236     6827                          The only way TIMEOUT is activated is on startup of a
      237     6828                          new TPU.
      238     6829        */
      239     6830        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:11   
              6847    1   /***************************************************************************
              6848    1    *                                                                         *
              6849    1    *                                    FPTs                                 *
              6850    1    *                                                                         *
              6851    1    ***************************************************************************/

      240     6855        %FPT_ACTIVATE(DCB=M$CG, STATION=STATION, ABTET=YES, ABTREAD=%TYC_EOF);
      241     6878
      242     6879        %FPT_CGCTL(DCB=M$CG, TYPLIST=VLP_CGTYPL, QLIST=VLP_CGQL);
      243     6902
      244     6903        %FPT_CGINFO(DCB=M$CG, TYPLIST=VLP_CGTYPL, QLIST=VLP_CGQL);
      245     6923        %PAGE(ARG="VLPs");

              6940    1   /***************************************************************************
              6941    1    *                                                                         *
              6942    1    *                                    VLPs                                 *
              6943    1    *                                                                         *
              6944    1    ***************************************************************************/

      246     6948        %VLP_CGTYPL;
      247     6973        %VLP_CGQL;
      248     6995        %PAGE(ARG="QQB$TRANS", PAGE=YES);

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:12   
              7012    1   /***************************************************************************
              7013    1    *                                                                         *
              7014    1    *                                 QQB$TRANS                               *
              7015    1    *                                                                         *
              7016    1    ***************************************************************************/

      249     7020    1           PRIO$ = ADDR(NIL);
      250     7021    1           MAXLATCH$ = ADDR(NIL);
      251     7022    1           PERM$ = ADDR(NIL);
      252     7023    1           MAXACTIVE$ = ADDR(NIL);
      253     7024    1           TYPE$ = ADDR(NIL);
      254     7025    1           JOURNAL$ = ADDR(NIL);
      255     7026    1           ONEREPORT$ = ADDR(NIL);
      256     7027    1           WILD_FLAG = '0'B;
      257     7028    1           NOW_FLAG = '0'B;
      258     7029    1           TIMEOUT$ = ADDR(NIL);           /*  EOFTIME param                     */
      259     7030    1           TIMEOUT = 0;                    /*  Set to default value              */
      260     7031
      261     7032    1           NSUBLKS = QQ_CMDBLK.OUT$ -> OUT$BLK.NSUBLKS - 1;
      262     7033
      263     7034    2           DO I = 0 TO NSUBLKS;
      264     7035    2             SUBLK$ = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(I);
      265     7036    3             DO CASE(SUBLK$ -> OUT$SYM.CODE);
      266     7037
      267     7038    3               CASE(1 /* OPT_PRIO */);
      268     7039    3                 OLD_SUBLK$ = PRIO$;
      269     7040    3                 PRIO$ = SUBLK$;
      270     7041
      271     7042    3               CASE(2 /* OPT_PERM */);
      272     7043    3                 OLD_SUBLK$ = PERM$;
      273     7044    3                 PERM$ = SUBLK$;
      274     7045
      275     7046    3               CASE(3 /* OPT_MAXACTIVE */);
      276     7047    3                 OLD_SUBLK$ = MAXACTIVE$;
      277     7048    3                 MAXACTIVE$ = SUBLK$;
      278     7049
      279     7050    3               CASE(4 /* OPT_TYPE */);
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:13   
      280     7051    3                 OLD_SUBLK$ = TYPE$;
      281     7052    3                 TYPE$ = SUBLK$ -> OUT$BLK.SUBLK$(0);
      282     7053    3                 MSGTYP = TYPE$ -> OUT$SYM.TEXT;
      283     7054
      284     7055    3               CASE(5 /* OPT_JOURNAL */);
      285     7056    3                 OLD_SUBLK$ = JOURNAL$;
      286     7057    3                 JOURNAL$ = SUBLK$ -> OUT$BLK.SUBLK$(0);
      287     7058
      288     7059    3               CASE(6 /* OPT_ONEREPORT */);
      289     7060    3                 OLD_SUBLK$ = ONEREPORT$;
      290     7061    3                 ONEREPORT$ = SUBLK$ -> OUT$BLK.SUBLK$(0);
      291     7062
      292     7063    3               CASE(7 /* OPT_TRANS_NOW */);
      293     7064    3                 NOW_FLAG = '1'B;
      294     7065
      295     7066    3               CASE(8 /* OPT_TIMEOUT */);
      296     7067    3                 OLD_SUBLK$ = TIMEOUT$;
      297     7068    3                 TIMEOUT$ = SUBLK$;
      298     7069
      299     7070    3               CASE(9 /* OPT_MAXLATCH */);
      300     7071    3                 OLD_SUBLK$ = MAXLATCH$;
      301     7072    3                 MAXLATCH$ = SUBLK$;
      302     7073
      303     7074    3             END /* CASE */;
      304     7075
      305     7076    2             IF OLD_SUBLK$ ~= ADDR(NIL) THEN
      306     7077    3               DO;
      307     7078    3                 QQ_CMDBLK.MINOR_ERR = CODE_DUPL;
      308     7079    3                 CALL QQC$BLDMSG_BLK(MSGBLK);
      309     7080    3                 CALL QQC$BLDMSG(MSGBLK);
      310     7081    3               END;
      311     7082    2           END;
      312     7083
      313     7084    1           IF TYPE$ = ADDR(NIL) OR
      314     7085    1               (PRIO$ = ADDR(NIL) AND PERM$ = ADDR(NIL) AND
      315     7086    1               MAXACTIVE$ = ADDR(NIL) AND JOURNAL$ = ADDR(NIL) AND
      316     7087    1               MAXLATCH$ = ADDR(NIL) AND ONEREPORT$ = ADDR(NIL)) THEN
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:14   
      317     7088    2             DO;
      318     7089    2               QQ_CMDBLK.MINOR_ERR = CODE_NMOT;
      319     7090    2               QQ_CMDBLK.FLAGS.ERR = '1'B;
      320     7091    2               GOTO PRINT_ERR;
      321     7092    2             END;
      322     7093
      323     7094    1           IF TIMEOUT$ ~= ADDR(NIL) AND PERM$ = ADDR(NIL) THEN
      324     7095    2             DO;
      325     7096    2               QQ_CMDBLK.MINOR_ERR = CODE_TWOP;
      326     7097    2               QQ_CMDBLK.FLAGS.ERR = '1'B;
      327     7098    2               GOTO PRINT_ERR;
      328     7099    2             END;
      329     7100    1           CALL INDEX(POS, '?', TYPE$ -> OUT$SYM.TEXT) ALTRET(NO_Q);
      330     7101    1           WILD_FLAG = '1'B;
      331     7102
      332     7103    1           IF TYPE$ -> OUT$SYM.COUNT - 1 ~= POS THEN
      333     7104    2             DO;
      334     7105    2               QQ_CMDBLK.MINOR_ERR = CODE_IWT;
      335     7106    2               QQ_CMDBLK.FLAGS.ERR = '1'B;
      336     7107    2               GOTO PRINT_ERR;
      337     7108    2             END;
      338     7109
      339     7110    1           IF PRIO$ ~= ADDR(NIL) OR MAXACTIVE$ ~= ADDR(NIL) OR
      340     7111    1               MAXLATCH$ ~= ADDR(NIL) OR
      341     7112    1               JOURNAL$ ~= ADDR(NIL) OR ONEREPORT$ ~= ADDR(NIL) THEN
      342     7113    2             DO;
      343     7114    2               QQ_CMDBLK.MINOR_ERR = CODE_NWH;
      344     7115    2               QQ_CMDBLK.FLAGS.ERR = '1'B;
      345     7116    2               GOTO PRINT_ERR;
      346     7117    2             END;
      347     7118
      348     7119    1   NO_Q:
      349     7120    1           VLP_CGTYPL.LIST.NAME#(0) = TYPE$ -> OUT$SYM.TEXT;
      350     7121    1           CALL M$CGINFO(FPT_CGINFO) ALTRET(CGINFO_ERR);
      351     7122    1           OLD_MAXLATCH = VLP_CGTYPL.LIST.MAXLATCH#(0);
      352     7123    1           OLD_JOURNAL_FLAG = VLP_CGTYPL.LIST.JOURNAL#(0);
      353     7124    1           OLD_ONEREPORT_FLAG = VLP_CGTYPL.LIST.ONEREPORT#(0);
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:15   
      354     7125    1           OLD_MAXACTIVE = VLP_CGQL.LIST.MXACT#(0);
      355     7126    1           GOTO DO_PRIO;
      356     7127
      357     7128    1   CGINFO_ERR:
      358     7129    1           ERR= B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      359     7130
      360     7131    1           IF ERR.CODE ~= 1153 /* E$CGAFNT */ THEN
      361     7132    2             DO;
      362     7133    2               GOTO MON_ERR;
      363     7134    2             END;
      364     7135
      365     7136        /* NOTE: This ifs are written like this because connective ands
      366     7137                 dont evaluate from left to right in PL6 */
      367     7138
      368     7139    1           IF PRIO$ ~= ADDR(NIL) THEN
      369     7140    2             DO;
      370     7141    2               IF PRIO$ -> OUT$BLK.NSUBLKS = 2 THEN
      371     7142    3                 DO;
      372     7143    3                   QQ_CMDBLK.MINOR_ERR = CODE_NOTDEF;
      373     7144    3                   GOTO PRINT_ERR;
      374     7145    3                 END;
      375     7146    2             END;
      376     7147
      377     7148    1           IF MAXACTIVE$ ~= ADDR(NIL) THEN
      378     7149    2             DO;
      379     7150    2               IF MAXACTIVE$ -> OUT$BLK.NSUBLKS = 2 THEN
      380     7151    3                 DO;
      381     7152    3                   QQ_CMDBLK.MINOR_ERR = CODE_NOTDEF;
      382     7153    3                   GOTO PRINT_ERR;
      383     7154    3                 END;
      384     7155    2             END;
      385     7156
      386     7157    1           OLD_MAXACTIVE = VLP_CGQL_C.LIST.MXACT#(0);
      387     7158    1           OLD_JOURNAL_FLAG = VLP_CGTYPL_C.LIST.JOURNAL#(0);
      388     7159    1           OLD_ONEREPORT_FLAG = VLP_CGTYPL_C.LIST.ONEREPORT#(0);
      389     7160    1           OLD_PRIO = VLP_CGTYPL_C.LIST.PRIO#(0);
      390     7161        %EJECT;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:16   
      391     7162    1   DO_PRIO:
      392     7163    1           NEW_PRIO = OLD_PRIO;
      393     7164    1           IF PRIO$ ~= ADDR(NIL) THEN
      394     7165    2             DO;
      395     7166    2               IF PRIO$ -> OUT$BLK.NSUBLKS = 1 THEN
      396     7167    3                 DO;
      397     7168    3                   CALL CHARBIN(NEW_PRIO, PRIO$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);
      398     7169    3                   GOTO SET_PRIO;
      399     7170    3                 END;
      400     7171
      401     7172    2               DELTA = 0;
      402     7173    2               MULTIPLIER = 1;
      403     7174    2               NEW_PRIO = OLD_PRIO;
      404     7175
      405     7176    2               IF PRIO$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.CODE = 2 /* - */ THEN
      406     7177    3                 DO;
      407     7178    3                   MULTIPLIER = -1;
      408     7179    3                 END;
      409     7180
      410     7181    2               CALL CHARBIN(DELTA, PRIO$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT);
      411     7182
      412     7183    2               NEW_PRIO = NEW_PRIO + DELTA * MULTIPLIER;
      413     7184
      414     7185    2   SET_PRIO:
      415     7186    2               IF NEW_PRIO > 500 THEN
      416     7187    3                 DO;
      417     7188    3                   QQ_CMDBLK.MINOR_ERR = CODE_BIGGEST_PRIO;
      418     7189    3                   CALL QQC$BLDMSG_BLK(MSGBLK);
      419     7190    3                   CALL QQC$BLDMSG(MSGBLK);
      420     7191    3                   NEW_PRIO = 500;
      421     7192    3                 END;
      422     7193
      423     7194    2               IF NEW_PRIO < 1 THEN
      424     7195    3                 DO;
      425     7196    3                   QQ_CMDBLK.MINOR_ERR = CODE_SMALLEST_PRIO;
      426     7197    3                   CALL QQC$BLDMSG_BLK(MSGBLK);
      427     7198    3                   CALL QQC$BLDMSG(MSGBLK);
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:17   
      428     7199    3                   NEW_PRIO = 1;
      429     7200    3                 END;
      430     7201    2             END;
      431     7202        %EJECT;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:18   
      432     7203    1   DO_JOURNAL:
      433     7204    1           NEW_JOURNAL_FLAG = OLD_JOURNAL_FLAG;
      434     7205    1           IF JOURNAL$ ~= ADDR(NIL) THEN
      435     7206    2             DO;
      436     7207    2               IF JOURNAL$ -> OUT$SYM.CODE = 2 /* YES */ THEN
      437     7208    3                 DO;
      438     7209    3                   NEW_JOURNAL_FLAG = '1'B;
      439     7210    3                 END;
      440     7211    2               ELSE
      441     7212    3                 DO;
      442     7213    3                   NEW_JOURNAL_FLAG = '0'B;
      443     7214    3                 END;
      444     7215    2             END;
      445     7216        %EJECT;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:19   
      446     7217    1   DO_ONEREPORT:
      447     7218    1           NEW_ONEREPORT_FLAG = OLD_ONEREPORT_FLAG;
      448     7219    1           IF ONEREPORT$ ~= ADDR(NIL) THEN
      449     7220    2             DO;
      450     7221    2               IF ONEREPORT$ -> OUT$SYM.CODE = 2 /* YES */ THEN
      451     7222    3                 DO;
      452     7223    3                   NEW_ONEREPORT_FLAG = '1'B;
      453     7224    3                 END;
      454     7225    2               ELSE
      455     7226    3                 DO;
      456     7227    3                   NEW_ONEREPORT_FLAG = '0'B;
      457     7228    3                 END;
      458     7229    2             END;
      459     7230        %EJECT;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:20   
      460     7231    1   DO_MAXACTIVE:
      461     7232    1           NEW_MAXACTIVE = OLD_MAXACTIVE;
      462     7233    1           IF MAXACTIVE$ ~= ADDR(NIL) THEN
      463     7234    2             DO;
      464     7235    2               IF MAXACTIVE$ -> OUT$BLK.NSUBLKS = 1 THEN
      465     7236    3                 DO;
      466     7237    3                   CALL CHARBIN(NEW_MAXACTIVE, MAXACTIVE$ -> OUT$BLK.SUBLK$(0) ->
      467     7238    3                       OUT$SYM.TEXT);
      468     7239    3                   GOTO SET_MAXACTIVE;
      469     7240    3                 END;
      470     7241
      471     7242    2               DELTA = 0;
      472     7243    2               MULTIPLIER = 1;
      473     7244
      474     7245    2               IF MAXACTIVE$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.CODE = 2 /* - */ THEN
      475     7246    3                 DO;
      476     7247    3                   MULTIPLIER = -1;
      477     7248    3                 END;
      478     7249
      479     7250    2               CALL CHARBIN(DELTA, MAXACTIVE$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT);
      480     7251
      481     7252    2               NEW_MAXACTIVE = OLD_MAXACTIVE + DELTA * MULTIPLIER;
      482     7253
      483     7254    2   SET_MAXACTIVE:
      484     7255    2               IF NEW_MAXACTIVE < 0 THEN
      485     7256    3                 DO;
      486     7257    3                   NEW_MAXACTIVE = 0;
      487     7258    3                   QQ_CMDBLK.MINOR_ERR = CODE_SMALLEST_MAXACT;
      488     7259    3                   CALL QQC$BLDMSG_BLK(MSGBLK);
      489     7260    3                   CALL QQC$BLDMSG(MSGBLK);
      490     7261    3                 END;
      491     7262    2             END;
      492     7263
      493     7264        %EJECT;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:21   
      494     7265        /* Calculate the current # of permanent TPUs processing this
      495     7266           type of transaction */
      496     7267    1           DELTA = 0;
      497     7268    1           OLD_PERM = 0;
      498     7269
      499     7270    1           NEXT$ = QQ_GLOBAL.TPU$;
      500     7271    2           DO WHILE('1'B);
      501     7272    2             NEXT$ = NEXT$ -> TPU$INFO.FLINK$;
      502     7273    2             IF NEXT$ -> TPU$INFO.FLINK$ = ADDR(NIL) THEN
      503     7274    3               DO;
      504     7275    3                 GOTO CALC_NEW_PERM;
      505     7276    3               END;
      506     7277
      507     7278    2             IF NEXT$ -> TPU$INFO.MSGTYP = MSGTYP THEN
      508     7279    3               DO;
      509     7280    3                 OLD_PERM = OLD_PERM + 1;
      510     7281    3               END;
      511     7282    2           END;
      512     7283        %EJECT;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:22   
      513     7284    1   CALC_NEW_PERM:
      514     7285    1           NEW_PERM = OLD_PERM;
      515     7286    1           IF PERM$ ~= ADDR(NIL) THEN
      516     7287    2             DO;
      517     7288    2               IF PERM$ -> OUT$BLK.NSUBLKS = 1 THEN
      518     7289    3                 DO;
      519     7290    3                   CALL CHARBIN(NEW_PERM, PERM$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);
      520     7291    3                   GOTO SET_PERM;
      521     7292    3                 END;
      522     7293
      523     7294    2               MULTIPLIER = 1;
      524     7295
      525     7296    2               IF PERM$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.CODE = 2 /* - */ THEN
      526     7297    3                 DO;
      527     7298    3                   MULTIPLIER = -1;
      528     7299    3                 END;
      529     7300
      530     7301    2               CALL CHARBIN(DELTA, PERM$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT);
      531     7302
      532     7303    2               NEW_PERM = OLD_PERM + DELTA * MULTIPLIER;
      533     7304    2             END;
      534     7305
      535     7306    1   SET_PERM:
      536     7307    1           IF DELTA ~= 0 THEN
      537     7308    2             DO;
      538     7309    2               DELTA_PERM = DELTA * MULTIPLIER;
      539     7310    2             END;
      540     7311    1           ELSE
      541     7312    2             DO;
      542     7313    2               DELTA_PERM = NEW_PERM - OLD_PERM;
      543     7314    2             END;
      544     7315
      545     7316    1           IF DELTA_PERM + OLD_PERM < 0 THEN
      546     7317    2             DO;
      547     7318    2               QQ_CMDBLK.MINOR_ERR = CODE_NOTENUF_TPUS;
      548     7319    2               GOTO PRINT_ERR;
      549     7320    2             END;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:23   
      550     7321
      551     7322    1           IF DELTA_PERM + OLD_PERM > NEW_MAXACTIVE THEN
      552     7323    2             DO;
      553     7324    2               QQ_CMDBLK.MINOR_ERR = CODE_BIGR_MAXACT;
      554     7325    2               CALL QQC$BLDMSG_BLK(MSGBLK);
      555     7326    2               CALL QQC$BLDMSG(MSGBLK);
      556     7327    2             END;
      557     7328        %EJECT;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:24   
      558     7329    1   CALC_TIMEOUT:
      559     7330    1           IF TIMEOUT$ ~= ADDR(NIL) THEN
      560     7331    2             DO;
      561     7332    2               CALL CHARBIN(TIMEOUT, TIMEOUT$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);
      562     7333    2               IF TIMEOUT < 1 THEN
      563     7334    3                 DO;
      564     7335    3                   TIMEOUT = 1;            /* set to 1 minute                    */
      565     7336    3                   QQ_CMDBLK.MINOR_ERR = CODE_SMALLEST_TIMEOUT;
      566     7337    3                   CALL QQC$BLDMSG_BLK(MSGBLK);
      567     7338    3                   CALL QQC$BLDMSG(MSGBLK);
      568     7339    3                 END;
      569     7340
      570     7341    2               IF TIMEOUT > 4000 THEN
      571     7342    3                 DO;
      572     7343    3                   TIMEOUT = 4000;         /* set to 4000 minutes                */
      573     7344    3                   QQ_CMDBLK.MINOR_ERR = CODE_BIGGEST_TIMEOUT;
      574     7345    3                   CALL QQC$BLDMSG_BLK(MSGBLK);
      575     7346    3                   CALL QQC$BLDMSG(MSGBLK);
      576     7347    3                 END;
      577     7348
      578     7349    2             END;
      579     7350    1   CALC_MAXLATCH:
      580     7351    1           NEW_MAXLATCH = OLD_MAXLATCH;
      581     7352    1           IF MAXLATCH$ ~= ADDR(NIL) THEN
      582     7353    2             DO;
      583     7354    2               CALL CHARBIN(NEW_MAXLATCH, MAXLATCH$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.
              7354                        TEXT);
      584     7355    2               IF NEW_MAXLATCH < 1 THEN
      585     7356    3                 DO;
      586     7357    3                   NEW_MAXLATCH = 1;       /* set to 1 latched write             */
      587     7358    3                   QQ_CMDBLK.MINOR_ERR = CODE_SMALLEST_MAXLATCH;
      588     7359    3                   CALL QQC$BLDMSG_BLK(MSGBLK);
      589     7360    3                   CALL QQC$BLDMSG(MSGBLK);
      590     7361    3                 END;
      591     7362
      592     7363    2               IF NEW_MAXLATCH > 262143 THEN
      593     7364    3                 DO;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:25   
      594     7365    3                   NEW_MAXLATCH = 262143; /* set to 263000 latched writes */
      595     7366    3                   QQ_CMDBLK.MINOR_ERR = CODE_BIGGEST_MAXLATCH;
      596     7367    3                   CALL QQC$BLDMSG_BLK(MSGBLK);
      597     7368    3                   CALL QQC$BLDMSG(MSGBLK);
      598     7369    3                 END;
      599     7370
      600     7371    2             END;
      601     7372    1           IF PRIO$ ~= ADDR(NIL) OR MAXACTIVE$ ~= ADDR(NIL) OR
      602     7373    1               MAXLATCH$ ~= ADDR(NIL) OR
      603     7374    1               JOURNAL$ ~= ADDR(NIL) OR ONEREPORT$ ~= ADDR(NIL) THEN
      604     7375    2             DO;
      605     7376    2               VLP_CGTYPL.LIST(0) = VLP_CGTYPL_C.LIST(0);
      606     7377    2               VLP_CGQL.LIST(0) = VLP_CGQL_C.LIST(0);
      607     7378    2               VLP_CGTYPL.LIST.NAME#(0) = TYPE$ -> OUT$SYM.TEXT;
      608     7379    2               VLP_CGTYPL.LIST.MAXLATCH#(0) = NEW_MAXLATCH;
      609     7380    2               VLP_CGTYPL.LIST.JOURNAL#(0) = NEW_JOURNAL_FLAG;
      610     7381    2               VLP_CGTYPL.LIST.ONEREPORT#(0) = NEW_ONEREPORT_FLAG;
      611     7382    2               VLP_CGQL.LIST.MXACT#(0) = NEW_MAXACTIVE;
      612     7383    2               CALL M$CGCTL(FPT_CGCTL) ALTRET(MON_ERR);
      613     7384    2             END;
      614     7385
      615     7386    1           IF DELTA_PERM >= 1 AND NOW_FLAG AND WILD_FLAG THEN
      616     7387    2             DO;
      617     7388    2               QQ_CMDBLK.MINOR_ERR = CODE_NOWWT;
      618     7389    2               QQ_CMDBLK.FLAGS.ERR = '1'B;
      619     7390    2               GOTO PRINT_ERR;
      620     7391    2             END;
      621     7392
      622     7393    2           DO I = 1 TO DELTA_PERM;
      623     7394    2             CALL QQC$START_TPU(MSGTYP,ERR,NOW_FLAG,TIMEOUT) ALTRET(START_ERR);
      624     7395    2           END;
      625     7396
      626     7397    1           NEXT$ = QQ_GLOBAL.TPU$;
      627     7398    2           DO WHILE(DELTA_PERM < 0);
      628     7399    2             NEXT$ = NEXT$ -> TPU$INFO.FLINK$;
      629     7400    2             IF MSGTYP = NEXT$ -> TPU$INFO.MSGTYP THEN
      630     7401    3               DO;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:26   
      631     7402    3                 STATION = NEXT$ -> TPU$INFO.STATION;
      632     7403    3                 CALL M$ACTIVATE(FPT_ACTIVATE) ALTRET(ACTIVATE_ERR);
      633     7404    3                 NEXT$ -> TPU$INFO.FLAGS.DISCONNECT = '1'B;
      634     7405
      635     7406    4                 DO WHILE('0'B);
      636     7407
      637     7408    4   ACTIVATE_ERR:
      638     7409    4                   IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 1154 /* E$CGAFNS */
              7409                            THEN
      639     7410    5                     DO;
      640     7411    5                       GOTO MON_ERR;
      641     7412    5                     END;
      642     7413    4                 END /* NEVER */;
      643     7414
      644     7415    3                 DELTA_PERM = DELTA_PERM + 1;
      645     7416    3               END;
      646     7417    2           END;
      647     7418
      648     7419    1           CALL QQB$SAVCMD;                /*  Good TRANS commands will be saved */
      649     7420    1           GOTO RET;
      650     7421
      651     7422    1   START_ERR:
      652     7423    1           QQ_CMDBLK.MINOR_ERR = CODE_CST;
      653     7424    1           CALL QQC$BLDMSG_BLK(MSGBLK);
      654     7425    1           CALL QQC$CONVERT_NUM(I - 1, SIZE, ADDR(TEXTC_NUM.NAME#));
      655     7426    1           TEXTC_NUM.L# = SIZE;
      656     7427    1           MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_NUM);
      657     7428    1           MSGBLK.ERRINFO.ERR(1) = ERR;
      658     7429    1           CALL QQC$BLDMSG(MSGBLK);
      659     7430    1           GOTO RET;
      660     7431
      661     7432    1   PRINT_ERR:
      662     7433    1           CALL QQC$BLDMSG_BLK(MSGBLK);
      663     7434    1           CALL QQC$BLDMSG(MSGBLK);
      664     7435
      665     7436    1   RET:
      666     7437    1           RETURN;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:27   
      667     7438
      668     7439    1   MON_ERR:
      669     7440    1           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      670     7441    1           CALL QQC$SCREECH;
      671     7442    1   END QQB$TRANS;

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:28   
--  Include file information  --

   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQB$TRANS.

   Procedure QQB$TRANS requires 775 words for executable code.
   Procedure QQB$TRANS requires 68 words of local(AUTO) storage.

    No errors detected in file QQB$TRANS.:E05TSI    .

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:29   

 Object Unit name= QQB$TRANS                                  File name= QQB$TRANS.:E05TOU
 UTS= JUL 30 '97 05:37:43.12 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$CG
    2  RoData even  UTS     35     43  QQB$TRANS
    3   Data  even  none   142    216  QQB$TRANS
    4   Proc  even  none   775   1407  QQB$TRANS
    5  RoData even  none     4      4  QQB$TRANS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  QQB$TRANS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 QQC$BLDMSG_BLK
         yes           Std       1 QQC$BLDMSG
 yes     yes           Std       4 QQC$START_TPU
         yes           Std       0 QQB$SAVCMD
         yes           Std       0 QQC$SCREECH
         yes           Std       3 QQC$CONVERT_NUM
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:30   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  QQ_CMDBLK                             QQ_GLOBAL
     B$TCB$                                M$CG                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:31   


        1        1        /*M* QQB$TRANS - Perform  TRANSACTION  command */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QQB$TRANS:
        9        9                PROC;

      9  4 000000   000000 700200 xent  QQB$TRANS    TSX0  ! X66_AUTO_0
         4 000001   000104 000000                    ZERO    68,0

       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE CP_6_SUBS;
       16      690        %INCLUDE B_ERRORS_C;
       17     1817        %INCLUDE XU_MACRO_C;
       18     4923        %INCLUDE QQ_SUBS_C;
       19     5115        %INCLUDE QQ_MACROS_C;
       20     5540        %INCLUDE QQ_DATA_R;
       21     5786        %INCLUDE QQ_PERR_C;
       22     5947        %INCLUDE Q_ERRCODE_C;
       23     5970        %PAGE(ARG="Externally defined routines");

              5987    1   /***************************************************************************
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:32   
              5988    1    *                                                                         *
              5989    1    *                        Externally defined routines                      *
              5990    1    *                                                                         *
              5991    1    ***************************************************************************/

       24     5995    1   DCL QQB$SAVCMD  ENTRY;
       25     5996    1   DCL QQC$SCREECH ENTRY;
       26     5997    1   DCL QQC$BLDMSG_BLK ENTRY(1);
       27     5998    1   DCL QQC$BLDMSG ENTRY(1);
       28     5999    1   DCL QQC$START_TPU ENTRY(4) ALTRET;
       29     6000    1   DCL QQC$WILD_COMP ENTRY(2) ALTRET;
       30     6001    1   DCL QQC$CONVERT_NUM ENTRY(3);
       31     6002        %PAGE(ARG="Symrefs");

              6019    1   /***************************************************************************
              6020    1    *                                                                         *
              6021    1    *                                  Symrefs                                *
              6022    1    *                                                                         *
              6023    1    ***************************************************************************/

       32     6027    1   DCL B$TCB$ PTR SYMREF;
       33     6028        %PAGE(ARG="DCBs");

              6045    1   /***************************************************************************
              6046    1    *                                                                         *
              6047    1    *                                    DCBs                                 *
              6048    1    *                                                                         *
              6049    1    ***************************************************************************/

       34     6053    1   DCL M$CG DCB;
       35     6054        %PAGE(ARG="Based");

              6071    1   /***************************************************************************
              6072    1    *                                                                         *
              6073    1    *                                   Based                                 *
              6074    1    *                                                                         *
              6075    1    ***************************************************************************/
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:33   

       36     6079        %B$TCB;
       37     6082        %B$ALT;
       38     6090        %TPU$INFO;
       39     6119        %TP$STATION;
       40     6192        %PARSE$OUT(STCLASS=BASED);
       41     6237        %PARSE$SYM(STCLASS=BASED);
       42     6275        %PAGE(ARG="Constants");

              6292    1   /***************************************************************************
              6293    1    *                                                                         *
              6294    1    *                                 Constants                               *
              6295    1    *                                                                         *
              6296    1    ***************************************************************************/

       43     6300        %VLP_CGTYPL(FPTN=VLP_CGTYPL_C, STCLASS=CONSTANT);
       44     6325
       45     6326        %VLP_CGQL(FPTN=VLP_CGQL_C, STCLASS=CONSTANT);
       46     6348        %PAGE(ARG="Static");

              6365    1   /***************************************************************************
              6366    1    *                                                                         *
              6367    1    *                                   Static                                *
              6368    1    *                                                                         *
              6369    1    ***************************************************************************/

       47     6373    1   DCL STATION CHAR(8) STATIC;
       48     6374        %PAGE(ARG="Auto");

              6391    1   /***************************************************************************
              6392    1    *                                                                         *
              6393    1    *                                    Auto                                 *
              6394    1    *                                                                         *
              6395    1    ***************************************************************************/

       49     6399    1   DCL NEXT$ PTR;
       50     6400    1   DCL JOURNAL$ PTR;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:34   
       51     6401    1   DCL ONEREPORT$ PTR;
       52     6402    1   DCL SUBLK$ PTR;
       53     6403    1   DCL PRIO$ PTR;
       54     6404    1   DCL MAXLATCH$ PTR;
       55     6405    1   DCL PERM$ PTR;
       56     6406    1   DCL TYPE$ PTR;
       57     6407    1   DCL MAXACTIVE$ PTR;
       58     6408    1   DCL TIMEOUT$ PTR;
       59     6409    1   DCL OLD_SUBLK$ PTR;
       60     6410
       61     6411    1   DCL I SBIN WORD;
       62     6412    1   DCL NSUBLKS UBIN WORD;
       63     6413    1   DCL POS UBIN WORD;
       64     6414    1   DCL OLD_PRIO UBIN WORD;
       65     6415    1   DCL NEW_PRIO SBIN WORD;
       66     6416    1   DCL OLD_MAXLATCH UBIN WORD;
       67     6417    1   DCL NEW_MAXLATCH SBIN WORD;
       68     6418    1   DCL OLD_MAXACTIVE UBIN WORD;
       69     6419    1   DCL NEW_MAXACTIVE SBIN WORD;
       70     6420    1   DCL OLD_PERM UBIN WORD;
       71     6421    1   DCL NEW_PERM SBIN WORD;
       72     6422    1   DCL TIMEOUT UBIN WORD;
       73     6423    1   DCL DELTA SBIN WORD;
       74     6424    1   DCL DELTA_PERM SBIN WORD;
       75     6425    1   DCL MULTIPLIER SBIN WORD;
       76     6426    1   DCL SIZE UBIN WORD;
       77     6427
       78     6428    1   DCL MSGTYP CHAR(8);
       79     6429
       80     6430    1   DCL WILD_FLAG BIT(1) ALIGNED;
       81     6431    1   DCL NEW_JOURNAL_FLAG BIT(1) ALIGNED;
       82     6432    1   DCL OLD_JOURNAL_FLAG BIT(1) ALIGNED;
       83     6433    1   DCL NEW_ONEREPORT_FLAG BIT(1) ALIGNED;
       84     6434    1   DCL OLD_ONEREPORT_FLAG BIT(1) ALIGNED;
       85     6435    1   DCL NOW_FLAG BIT(1) ALIGNED;
       86     6436
       87     6437        %MSGBLK;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:35   
       88     6527        %VLP_NAME(FPTN=TEXTC_NUM, NAME='12345678');
       89     6554    1   DCL 1 ERR,
       90     6555    1         2 FCG BIT(12) UNAL,
       91     6556    1         2 MID BIT(6) UNAL,
       92     6557    1         2 MON BIT(1) UNAL,
       93     6558    1         2 CODE UBIN(14) UNAL,
       94     6559    1         2 SEV UBIN(3) UNAL;
       95     6560        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:36   
              6577    1   /***************************************************************************
              6578    1    *                                                                         *
              6579    1    *                                Error codes                              *
              6580    1    *                                                                         *
              6581    1    ***************************************************************************/

       96     6585        %ERRCODE(NAME=CODE_NMOT, CODE#=%E$NMOT, FCG#=%FCG_QQ, MID#=%MID_B);
       97     6592        %ERRCODE(NAME=CODE_IWT, CODE#=%E$IWT, FCG#=%FCG_QQ, MID#=%MID_B);
       98     6599        %ERRCODE(NAME=CODE_NWH, CODE#=%E$NWH, FCG#=%FCG_QQ, MID#=%MID_B);
       99     6606        %ERRCODE(NAME=CODE_NOTDEF, CODE#=%E$NOTDEF, FCG#=%FCG_QQ, MID#=%MID_B);
      100     6613        %ERRCODE(NAME=CODE_BIGGEST_PRIO, CODE#=%E$BIGGEST_PRIO, FCG#=%FCG_QQ, MID#=%MID_B);
      101     6620       %ERRCODE(NAME=CODE_SMALLEST_PRIO, CODE#=%E$SMALLEST_PRIO, FCG#=%FCG_QQ, MID#=%MID_B)
              6620            ;
      102     6627        %ERRCODE(NAME=CODE_SMALLEST_MAXACT, CODE#=%E$SMALLEST_MAXACT, FCG#=%FCG_QQ, MID#=
              6627            %MID_B);
      103     6634        %ERRCODE(NAME=CODE_NOTENUF_TPUS, CODE#=%E$NOTENUF_TPUS, FCG#=%FCG_QQ, MID#=%MID_B);
      104     6641        %ERRCODE(NAME=CODE_BIGR_MAXACT, CODE#=%E$BIGR_MAXACT, FCG#=%FCG_QQ, MID#=%MID_B);
      105     6648        %ERRCODE(NAME=CODE_CST, CODE#=%E$CST, FCG#=%FCG_QQ, MID#=%MID_B);
      106     6655        %ERRCODE(NAME=CODE_DUPL, CODE#=%E$DUPL, FCG#=%FCG_QQ, MID#=%MID_B);
      107     6662        %ERRCODE(NAME=CODE_NOWWT, CODE#=%E$NOWWT, FCG#=%FCG_QQ, MID#=%MID_B);
      108     6669        %ERRCODE(NAME=CODE_SMALLEST_TIMEOUT, CODE#=%E$SMALLEST_TIMEOUT, FCG#=%FCG_QQ, MID#=
              6669            %MID_B);
      109     6676        %ERRCODE(NAME=CODE_BIGGEST_TIMEOUT, CODE#=%E$BIGGEST_TIMEOUT, FCG#=%FCG_QQ, MID#=
              6676            %MID_B);
      110     6683       %ERRCODE(NAME=CODE_SMALLEST_MAXLATCH, CODE#=%E$SMALLEST_MAXLATCH, FCG#=%FCG_QQ, MID#
              6683            =%MID_B);
      111     6690        %ERRCODE(NAME=CODE_BIGGEST_MAXLATCH, CODE#=%E$BIGGEST_MAXLATCH, FCG#=%FCG_QQ, MID#=
              6690            %MID_B);
      112     6697        %ERRCODE(NAME=CODE_TWOP, CODE#=%E$TWOP, FCG#=%FCG_QQ, MID#=%MID_B);
      113     6704
      114     6705        /*E*       ERROR: QQB-E$NMOT-C
      115     6706
      116     6707                 MESSAGE: This command is incomplete.
      117     6708             DESCRIPTION: Although the command that was provided is
      118     6709                          syntactically correct the command does
      119     6710                          not direct me to do anything.
      120     6711        */
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:37   
      121     6712        /*E*       ERROR: QQB-E$IWT-C
      122     6713
      123     6714                 MESSAGE: The specified transaction type is invalid.
      124     6715                          Wildcarded types may only have a ? as the last
      125     6716                          character of the transaction type.
      126     6717                          e. g., A?B? is illegal, ? or AB? are legal.
      127     6718             DESCRIPTION: Wild carded transaction types are more restrictive
      128     6719                          than generalized wild carding.  The rules are
      129     6720                          only one ?, and the ? must be the last character
      130     6721                          of the transaction type.  In addition ? may not
      131     6722                          be the only character E.G., ????.
      132     6723        */
      133     6724        /*E*       ERROR: QQB-E$NWH-C
      134     6725
      135     6726                 MESSAGE: Wildcarded transaction types may not be used
      136     6727                          in conjunction with any option other than PERM.
      137     6728             DESCRIPTION: If wild carded transaction types were permitted
      138     6729                          here the whole comgroup would have to be
      139     6730                          searched for match to the wild carded type.
      140     6731                          This operation would be time consuming
      141     6732                          (and take a gob of code).
      142     6733        */
      143     6734        /*E*       ERROR: QQB-E$NOTDEF-C
      144     6735
      145     6736                 MESSAGE: The +- suboptions can only be used for transaction
      146     6737                          types that have been specifically defined.
      147     6738             DESCRIPTION: This restriction is to make sure the user knows
      148     6739                          what he is doing.  A transaction can get specifically
      149     6740                          3 ways: 1) TRANSACTION A PRIO=7    2) Define it
      150     6741                          in the TRADER file with a PRIO or MAXACTIVE
      151     6742                          3) Actually have the transaction used
      152     6743
      153     6744        */
      154     6745        /*E*       ERROR: QQB-E$SMALLEST_MAXACT-C
      155     6746
      156     6747                 MESSAGE: The value for MAXACTIVE may not be less than 1.
      157     6748                          1 has been substituted.
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:38   
      158     6749             DESCRIPTION: A specified value for  MAXACTIVE  was illegal.
      159     6750                          The smallest permissible value has been substituted.
      160     6751        */
      161     6752        /*E*       ERROR: QQB-E$NOTENUF_TPUS-C
      162     6753
      163     6754                 MESSAGE: This command requests elimination of more
      164     6755                          TPUs than are actually running.  This command
      165     6756                          is ignored.
      166     6757             DESCRIPTION: The  PERM  is being used to take away a greater
      167     6758                          number of permanent TPUs than you actually have
      168     6759                          running and processing this transaction
      169     6760                          type.
      170     6761        */
      171     6762        /*E*       ERROR: QQB-E$BIGR_MAXACT-C
      172     6763
      173     6764                 MESSAGE: Warning:  MAXACTIVE is less than PERM; therefore
      174     6765                          some permanent TPUs cannot be activated.
      175     6766             DESCRIPTION: If  MAXACTIVE  for a transaction type is <  PERM
      176     6767                          then some of the TPUs will not be doing anything.
      177     6768                          It would be a waste to permit this to take place.
      178     6769        */
      179     6770        /*E*       ERROR: QQB-E$CST-C
      180     6771
      181     6772                 MESSAGE: CONTROL limit for TPUs in this instance of TP
      182     6773                          reached.  Only %U1 TPU(s) were started.
      183     6774             DESCRIPTION: The system would not permit me to start the
      184     6775                          requested number of TPUs.  As many as possible
      185     6776                          have been started.
      186     6777        */
      187     6778        /*E*       ERROR: QQB-E$DUPL-C
      188     6779
      189     6780                 MESSAGE: A duplicate parameter has been found.  The last
      190     6781                          one specified has been used.
      191     6782             DESCRIPTION: No parameter should be used more than once.  The
      192     6783                          user has specified one of the parameters of
      193     6784                          this command more than once.  The last
      194     6785                          occurrence of that parameter specified was used.
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:39   
      195     6786        */
      196     6787        /*E*       ERROR: QQB-E$NOWWT-C
      197     6788
      198     6789                 MESSAGE: Transactions type can not be wildcarded when NOW
      199     6790                          option is specified.
      200     6791             DESCRIPTION: Wildcarded type is not allowed when NOW option is
      201     6792                          present.
      202     6793        */
      203     6794        /*E*       ERROR: QQB-E$SMALLEST_TIMEOUT-C
      204     6795
      205     6796                 MESSAGE: The value for TIMEOUT may not be less than 1 minute.
      206     6797                          1 minute has been substituted.
      207     6798             DESCRIPTION: A specified value for  TIMEOUT  was illegal.
      208     6799                          The smallest permissible value has been substituted.
      209     6800        */
      210     6801        /*E*       ERROR: QQB-E$BIGGEST_TIMEOUT-C
      211     6802
      212     6803                 MESSAGE: The value for TIMEOUT may not exceed 4000 minutes.
      213     6804                          4000 has been substituted.
      214     6805             DESCRIPTION: A specified value for  TIMEOUT  was illegal.
      215     6806                          The largest permissible value has been substituted.
      216     6807        */
      217     6808        /*E*       ERROR: QQB-E$SMALLEST_MAXLATCH-C
      218     6809
      219     6810                 MESSAGE: The value for MAXLATCH may not be less than 1.
      220     6811                          1 has been substituted.
      221     6812             DESCRIPTION: A specified value for  MAXLATCH  was illegal.
      222     6813                          The smallest permissible value has been substituted.
      223     6814        */
      224     6815        /*E*       ERROR: QQB-E$BIGGEST_MAXLATCH-C
      225     6816
      226     6817                 MESSAGE: The value for MAXLATCH may not exceed 263000.
      227     6818                          263000 has been substituted.
      228     6819             DESCRIPTION: A specified value for  MAXLATCH  was illegal.
      229     6820                          The largest permissible value has been substituted.
      230     6821        */
      231     6822        /*E*       ERROR: QQB-E$TWOP-C
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:40   
      232     6823
      233     6824                 MESSAGE: The option TIMEOUT is meaningless without PERM.
      234     6825                          No value for TIMEOUT has been set.
      235     6826             DESCRIPTION: A value was specified for TIMEOUT without PERM.
      236     6827                          The only way TIMEOUT is activated is on startup of a
      237     6828                          new TPU.
      238     6829        */
      239     6830        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:41   
              6847    1   /***************************************************************************
              6848    1    *                                                                         *
              6849    1    *                                    FPTs                                 *
              6850    1    *                                                                         *
              6851    1    ***************************************************************************/

      240     6855        %FPT_ACTIVATE(DCB=M$CG, STATION=STATION, ABTET=YES, ABTREAD=%TYC_EOF);
      241     6878
      242     6879        %FPT_CGCTL(DCB=M$CG, TYPLIST=VLP_CGTYPL, QLIST=VLP_CGQL);
      243     6902
      244     6903        %FPT_CGINFO(DCB=M$CG, TYPLIST=VLP_CGTYPL, QLIST=VLP_CGQL);
      245     6923        %PAGE(ARG="VLPs");

              6940    1   /***************************************************************************
              6941    1    *                                                                         *
              6942    1    *                                    VLPs                                 *
              6943    1    *                                                                         *
              6944    1    ***************************************************************************/

      246     6948        %VLP_CGTYPL;
      247     6973        %VLP_CGQL;
      248     6995        %PAGE(ARG="QQB$TRANS", PAGE=YES);

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:42   
              7012    1   /***************************************************************************
              7013    1    *                                                                         *
              7014    1    *                                 QQB$TRANS                               *
              7015    1    *                                                                         *
              7016    1    ***************************************************************************/

      249     7020    1           PRIO$ = ADDR(NIL);

   7020  4 000002   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000003   200011 756100                    STQ     PRIO$,,AUTO

      250     7021    1           MAXLATCH$ = ADDR(NIL);

   7021  4 000004   200012 756100                    STQ     MAXLATCH$,,AUTO

      251     7022    1           PERM$ = ADDR(NIL);

   7022  4 000005   200013 756100                    STQ     PERM$,,AUTO

      252     7023    1           MAXACTIVE$ = ADDR(NIL);

   7023  4 000006   200015 756100                    STQ     MAXACTIVE$,,AUTO

      253     7024    1           TYPE$ = ADDR(NIL);

   7024  4 000007   200014 756100                    STQ     TYPE$,,AUTO

      254     7025    1           JOURNAL$ = ADDR(NIL);

   7025  4 000010   200006 756100                    STQ     JOURNAL$,,AUTO

      255     7026    1           ONEREPORT$ = ADDR(NIL);

   7026  4 000011   200007 756100                    STQ     ONEREPORT$,,AUTO

      256     7027    1           WILD_FLAG = '0'B;

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:43   
   7027  4 000012   200042 450100                    STZ     WILD_FLAG,,AUTO

      257     7028    1           NOW_FLAG = '0'B;

   7028  4 000013   200047 450100                    STZ     NOW_FLAG,,AUTO

      258     7029    1           TIMEOUT$ = ADDR(NIL);           /*  EOFTIME param                     */

   7029  4 000014   200016 756100                    STQ     TIMEOUT$,,AUTO

      259     7030    1           TIMEOUT = 0;                    /*  Set to default value              */

   7030  4 000015   200033 450100                    STZ     TIMEOUT,,AUTO

      260     7031
      261     7032    1           NSUBLKS = QQ_CMDBLK.OUT$ -> OUT$BLK.NSUBLKS - 1;

   7032  4 000016   000005 470400 xsym               LDP0    QQ_CMDBLK+5
         4 000017   000001 236100                    LDQ     1,,PR0
         4 000020   000022 772000                    QRL     18
         4 000021   000001 136007                    SBLQ    1,DL
         4 000022   200021 756100                    STQ     NSUBLKS,,AUTO

      262     7033
      263     7034    2           DO I = 0 TO NSUBLKS;

   7034  4 000023   200020 450100                    STZ     I,,AUTO
         4 000024   000153 710000 4                  TRA     s:7082+1

      264     7035    2             SUBLK$ = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(I);

   7035  4 000025   000005 470400 xsym               LDP0    QQ_CMDBLK+5
         4 000026   200020 720100                    LXL0    I,,AUTO
         4 000027   000003 236110                    LDQ     3,X0,PR0
         4 000030   200010 756100                    STQ     SUBLK$,,AUTO

      265     7036    3             DO CASE(SUBLK$ -> OUT$SYM.CODE);
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:44   

   7036  4 000031   200010 471500                    LDP1    SUBLK$,,AUTO
         4 000032   100000 721100                    LXL1    0,,PR1
         4 000033   000012 101003                    CMPX1   10,DU
         4 000034   000036 602011 4                  TNC     s:7036+5,X1
         4 000035   000131 710000 4                  TRA     s:7076
         4 000036   000131 710000 4                  TRA     s:7076
         4 000037   000050 710000 4                  TRA     s:7039
         4 000040   000055 710000 4                  TRA     s:7043
         4 000041   000062 710000 4                  TRA     s:7047
         4 000042   000067 710000 4                  TRA     s:7051
         4 000043   000103 710000 4                  TRA     s:7056
         4 000044   000110 710000 4                  TRA     s:7060
         4 000045   000115 710000 4                  TRA     s:7064
         4 000046   000120 710000 4                  TRA     s:7067
         4 000047   000125 710000 4                  TRA     s:7071

      266     7037
      267     7038    3               CASE(1 /* OPT_PRIO */);

      268     7039    3                 OLD_SUBLK$ = PRIO$;

   7039  4 000050   200011 236100                    LDQ     PRIO$,,AUTO
         4 000051   200017 756100                    STQ     OLD_SUBLK$,,AUTO

      269     7040    3                 PRIO$ = SUBLK$;

   7040  4 000052   200010 236100                    LDQ     SUBLK$,,AUTO
         4 000053   200011 756100                    STQ     PRIO$,,AUTO
         4 000054   000131 710000 4                  TRA     s:7076

      270     7041
      271     7042    3               CASE(2 /* OPT_PERM */);

      272     7043    3                 OLD_SUBLK$ = PERM$;

   7043  4 000055   200013 236100                    LDQ     PERM$,,AUTO
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:45   
         4 000056   200017 756100                    STQ     OLD_SUBLK$,,AUTO

      273     7044    3                 PERM$ = SUBLK$;

   7044  4 000057   200010 236100                    LDQ     SUBLK$,,AUTO
         4 000060   200013 756100                    STQ     PERM$,,AUTO
         4 000061   000131 710000 4                  TRA     s:7076

      274     7045
      275     7046    3               CASE(3 /* OPT_MAXACTIVE */);

      276     7047    3                 OLD_SUBLK$ = MAXACTIVE$;

   7047  4 000062   200015 236100                    LDQ     MAXACTIVE$,,AUTO
         4 000063   200017 756100                    STQ     OLD_SUBLK$,,AUTO

      277     7048    3                 MAXACTIVE$ = SUBLK$;

   7048  4 000064   200010 236100                    LDQ     SUBLK$,,AUTO
         4 000065   200015 756100                    STQ     MAXACTIVE$,,AUTO
         4 000066   000131 710000 4                  TRA     s:7076

      278     7049
      279     7050    3               CASE(4 /* OPT_TYPE */);

      280     7051    3                 OLD_SUBLK$ = TYPE$;

   7051  4 000067   200014 236100                    LDQ     TYPE$,,AUTO
         4 000070   200017 756100                    STQ     OLD_SUBLK$,,AUTO

      281     7052    3                 TYPE$ = SUBLK$ -> OUT$BLK.SUBLK$(0);

   7052  4 000071   100003 236100                    LDQ     3,,PR1
         4 000072   200014 756100                    STQ     TYPE$,,AUTO

      282     7053    3                 MSGTYP = TYPE$ -> OUT$SYM.TEXT;

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:46   
   7053  4 000073   200014 473500                    LDP3    TYPE$,,AUTO
         4 000074   300004 236100                    LDQ     4,,PR3
         4 000075   000033 772000                    QRL     27
         4 000076   000000 622006                    EAX2    0,QL
         4 000077   040100 100540                    MLR     fill='040'O
         4 000100   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         4 000101   200040 000010                    ADSC9   MSGTYP,,AUTO             cn=0,n=8
         4 000102   000131 710000 4                  TRA     s:7076

      283     7054
      284     7055    3               CASE(5 /* OPT_JOURNAL */);

      285     7056    3                 OLD_SUBLK$ = JOURNAL$;

   7056  4 000103   200006 236100                    LDQ     JOURNAL$,,AUTO
         4 000104   200017 756100                    STQ     OLD_SUBLK$,,AUTO

      286     7057    3                 JOURNAL$ = SUBLK$ -> OUT$BLK.SUBLK$(0);

   7057  4 000105   100003 236100                    LDQ     3,,PR1
         4 000106   200006 756100                    STQ     JOURNAL$,,AUTO
         4 000107   000131 710000 4                  TRA     s:7076

      287     7058
      288     7059    3               CASE(6 /* OPT_ONEREPORT */);

      289     7060    3                 OLD_SUBLK$ = ONEREPORT$;

   7060  4 000110   200007 236100                    LDQ     ONEREPORT$,,AUTO
         4 000111   200017 756100                    STQ     OLD_SUBLK$,,AUTO

      290     7061    3                 ONEREPORT$ = SUBLK$ -> OUT$BLK.SUBLK$(0);

   7061  4 000112   100003 236100                    LDQ     3,,PR1
         4 000113   200007 756100                    STQ     ONEREPORT$,,AUTO
         4 000114   000131 710000 4                  TRA     s:7076

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:47   
      291     7062
      292     7063    3               CASE(7 /* OPT_TRANS_NOW */);

      293     7064    3                 NOW_FLAG = '1'B;

   7064  4 000115   400000 236003                    LDQ     -131072,DU
         4 000116   200047 756100                    STQ     NOW_FLAG,,AUTO
         4 000117   000131 710000 4                  TRA     s:7076

      294     7065
      295     7066    3               CASE(8 /* OPT_TIMEOUT */);

      296     7067    3                 OLD_SUBLK$ = TIMEOUT$;

   7067  4 000120   200016 236100                    LDQ     TIMEOUT$,,AUTO
         4 000121   200017 756100                    STQ     OLD_SUBLK$,,AUTO

      297     7068    3                 TIMEOUT$ = SUBLK$;

   7068  4 000122   200010 236100                    LDQ     SUBLK$,,AUTO
         4 000123   200016 756100                    STQ     TIMEOUT$,,AUTO
         4 000124   000131 710000 4                  TRA     s:7076

      298     7069
      299     7070    3               CASE(9 /* OPT_MAXLATCH */);

      300     7071    3                 OLD_SUBLK$ = MAXLATCH$;

   7071  4 000125   200012 236100                    LDQ     MAXLATCH$,,AUTO
         4 000126   200017 756100                    STQ     OLD_SUBLK$,,AUTO

      301     7072    3                 MAXLATCH$ = SUBLK$;

   7072  4 000127   200010 236100                    LDQ     SUBLK$,,AUTO
         4 000130   200012 756100                    STQ     MAXLATCH$,,AUTO

      302     7073
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:48   
      303     7074    3             END /* CASE */;

      304     7075
      305     7076    2             IF OLD_SUBLK$ ~= ADDR(NIL) THEN

   7076  4 000131   200017 236100                    LDQ     OLD_SUBLK$,,AUTO
         4 000132   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000133   000152 600000 4                  TZE     s:7082

      306     7077    3               DO;

      307     7078    3                 QQ_CMDBLK.MINOR_ERR = CODE_DUPL;

   7078  4 000134   000034 236000 2                  LDQ     CODE_DUPL
         4 000135   000001 756000 xsym               STQ     QQ_CMDBLK+1

      308     7079    3                 CALL QQC$BLDMSG_BLK(MSGBLK);

   7079  4 000136   200050 633500                    EPPR3   MSGBLK,,AUTO
         4 000137   200076 453500                    STP3    ERR+1,,AUTO
         4 000140   200076 630500                    EPPR0   ERR+1,,AUTO
         4 000141   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000142   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 000143   000000 011000                    NOP     0

      309     7080    3                 CALL QQC$BLDMSG(MSGBLK);

   7080  4 000144   200050 630500                    EPPR0   MSGBLK,,AUTO
         4 000145   200076 450500                    STP0    ERR+1,,AUTO
         4 000146   200076 630500                    EPPR0   ERR+1,,AUTO
         4 000147   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000150   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000151   000000 011000                    NOP     0

      310     7081    3               END;

      311     7082    2           END;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:49   

   7082  4 000152   200020 054100                    AOS     I,,AUTO
         4 000153   200021 236100                    LDQ     NSUBLKS,,AUTO
         4 000154   000025 604000 4                  TMI     s:7035
         4 000155   200020 116100                    CMPQ    I,,AUTO
         4 000156   000025 605000 4                  TPL     s:7035

      312     7083
      313     7084    1           IF TYPE$ = ADDR(NIL) OR

   7084  4 000157   200014 236100                    LDQ     TYPE$,,AUTO
         4 000160   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000161   000204 600000 4                  TZE     s:7089
         4 000162   200011 236100                    LDQ     PRIO$,,AUTO
         4 000163   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000164   000211 601000 4                  TNZ     s:7094
         4 000165   200013 236100                    LDQ     PERM$,,AUTO
         4 000166   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000167   000211 601000 4                  TNZ     s:7094
         4 000170   200015 236100                    LDQ     MAXACTIVE$,,AUTO
         4 000171   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000172   000211 601000 4                  TNZ     s:7094
         4 000173   200006 236100                    LDQ     JOURNAL$,,AUTO
         4 000174   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000175   000211 601000 4                  TNZ     s:7094
         4 000176   200012 236100                    LDQ     MAXLATCH$,,AUTO
         4 000177   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000200   000211 601000 4                  TNZ     s:7094
         4 000201   200007 236100                    LDQ     ONEREPORT$,,AUTO
         4 000202   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000203   000211 601000 4                  TNZ     s:7094

      314     7085    1               (PRIO$ = ADDR(NIL) AND PERM$ = ADDR(NIL) AND
      315     7086    1               MAXACTIVE$ = ADDR(NIL) AND JOURNAL$ = ADDR(NIL) AND
      316     7087    1               MAXLATCH$ = ADDR(NIL) AND ONEREPORT$ = ADDR(NIL)) THEN
      317     7088    2             DO;

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:50   
      318     7089    2               QQ_CMDBLK.MINOR_ERR = CODE_NMOT;

   7089  4 000204   000022 236000 2                  LDQ     CODE_NMOT
         4 000205   000001 756000 xsym               STQ     QQ_CMDBLK+1

      319     7090    2               QQ_CMDBLK.FLAGS.ERR = '1'B;

   7090  4 000206   400000 236007                    LDQ     -131072,DL
         4 000207   000010 256000 xsym               ORSQ    QQ_CMDBLK+8

      320     7091    2               GOTO PRINT_ERR;

   7091  4 000210   001362 710000 4                  TRA     PRINT_ERR

      321     7092    2             END;
      322     7093
      323     7094    1           IF TIMEOUT$ ~= ADDR(NIL) AND PERM$ = ADDR(NIL) THEN

   7094  4 000211   200016 236100                    LDQ     TIMEOUT$,,AUTO
         4 000212   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000213   000224 600000 4                  TZE     s:7100
         4 000214   200013 236100                    LDQ     PERM$,,AUTO
         4 000215   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000216   000224 601000 4                  TNZ     s:7100

      324     7095    2             DO;

      325     7096    2               QQ_CMDBLK.MINOR_ERR = CODE_TWOP;

   7096  4 000217   000042 236000 2                  LDQ     CODE_TWOP
         4 000220   000001 756000 xsym               STQ     QQ_CMDBLK+1

      326     7097    2               QQ_CMDBLK.FLAGS.ERR = '1'B;

   7097  4 000221   400000 236007                    LDQ     -131072,DL
         4 000222   000010 256000 xsym               ORSQ    QQ_CMDBLK+8

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:51   
      327     7098    2               GOTO PRINT_ERR;

   7098  4 000223   001362 710000 4                  TRA     PRINT_ERR

      328     7099    2             END;
      329     7100    1           CALL INDEX(POS, '?', TYPE$ -> OUT$SYM.TEXT) ALTRET(NO_Q);

   7100  4 000224   200014 470500                    LDP0    TYPE$,,AUTO
         4 000225   000004 236100                    LDQ     4,,PR0
         4 000226   000033 772000                    QRL     27
         4 000227   000000 620006                    EAX0    0,QL
         4 000230   000000 124540                    SCM     mask='000'O
         4 000231   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 000232   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000233   200022 000100                    ARG     POS,,AUTO
         4 000234   000276 606400 4                  TTN     NO_Q

      330     7101    1           WILD_FLAG = '1'B;

   7101  4 000235   400000 236003                    LDQ     -131072,DU
         4 000236   200042 756100                    STQ     WILD_FLAG,,AUTO

      331     7102
      332     7103    1           IF TYPE$ -> OUT$SYM.COUNT - 1 ~= POS THEN

   7103  4 000237   000004 236100                    LDQ     4,,PR0
         4 000240   000033 772000                    QRL     27
         4 000241   000001 136007                    SBLQ    1,DL
         4 000242   000245 604000 4                  TMI     s:7105
         4 000243   200022 116100                    CMPQ    POS,,AUTO
         4 000244   000252 600000 4                  TZE     s:7110

      333     7104    2             DO;

      334     7105    2               QQ_CMDBLK.MINOR_ERR = CODE_IWT;

   7105  4 000245   000023 236000 2                  LDQ     CODE_IWT
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:52   
         4 000246   000001 756000 xsym               STQ     QQ_CMDBLK+1

      335     7106    2               QQ_CMDBLK.FLAGS.ERR = '1'B;

   7106  4 000247   400000 236007                    LDQ     -131072,DL
         4 000250   000010 256000 xsym               ORSQ    QQ_CMDBLK+8

      336     7107    2               GOTO PRINT_ERR;

   7107  4 000251   001362 710000 4                  TRA     PRINT_ERR

      337     7108    2             END;
      338     7109
      339     7110    1           IF PRIO$ ~= ADDR(NIL) OR MAXACTIVE$ ~= ADDR(NIL) OR

   7110  4 000252   200011 236100                    LDQ     PRIO$,,AUTO
         4 000253   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000254   000271 601000 4                  TNZ     s:7114
         4 000255   200015 236100                    LDQ     MAXACTIVE$,,AUTO
         4 000256   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000257   000271 601000 4                  TNZ     s:7114
         4 000260   200012 236100                    LDQ     MAXLATCH$,,AUTO
         4 000261   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000262   000271 601000 4                  TNZ     s:7114
         4 000263   200006 236100                    LDQ     JOURNAL$,,AUTO
         4 000264   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000265   000271 601000 4                  TNZ     s:7114
         4 000266   200007 236100                    LDQ     ONEREPORT$,,AUTO
         4 000267   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000270   000276 600000 4                  TZE     NO_Q

      340     7111    1               MAXLATCH$ ~= ADDR(NIL) OR
      341     7112    1               JOURNAL$ ~= ADDR(NIL) OR ONEREPORT$ ~= ADDR(NIL) THEN
      342     7113    2             DO;

      343     7114    2               QQ_CMDBLK.MINOR_ERR = CODE_NWH;

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:53   
   7114  4 000271   000024 236000 2                  LDQ     CODE_NWH
         4 000272   000001 756000 xsym               STQ     QQ_CMDBLK+1

      344     7115    2               QQ_CMDBLK.FLAGS.ERR = '1'B;

   7115  4 000273   400000 236007                    LDQ     -131072,DL
         4 000274   000010 256000 xsym               ORSQ    QQ_CMDBLK+8

      345     7116    2               GOTO PRINT_ERR;

   7116  4 000275   001362 710000 4                  TRA     PRINT_ERR

      346     7117    2             END;
      347     7118
      348     7119    1   NO_Q:
      349     7120    1           VLP_CGTYPL.LIST.NAME#(0) = TYPE$ -> OUT$SYM.TEXT;

   7120  4 000276   200014 470500       NO_Q         LDP0    TYPE$,,AUTO
         4 000277   000004 236100                    LDQ     4,,PR0
         4 000300   000033 772000                    QRL     27
         4 000301   000000 620006                    EAX0    0,QL
         4 000302   040000 100540                    MLR     fill='040'O
         4 000303   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 000304   000175 000010 3                  ADSC9   VLP_CGTYPL+1             cn=0,n=8

      350     7121    1           CALL M$CGINFO(FPT_CGINFO) ALTRET(CGINFO_ERR);

   7121  4 000305   000112 630400 3                  EPPR0   FPT_CGINFO
         4 000306   500004 713400                    CLIMB   alt,+32772
         4 000307   411400 401760                    pmme    nvectors=20
         4 000310   000327 702000 4                  TSX2    CGINFO_ERR

      351     7122    1           OLD_MAXLATCH = VLP_CGTYPL.LIST.MAXLATCH#(0);

   7122  4 000311   000201 235000 3                  LDA     VLP_CGTYPL+5
         4 000312   000022 771000                    ARL     18
         4 000313   200025 755100                    STA     OLD_MAXLATCH,,AUTO
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:54   

      352     7123    1           OLD_JOURNAL_FLAG = VLP_CGTYPL.LIST.JOURNAL#(0);

   7123  4 000314   000177 236000 3                  LDQ     VLP_CGTYPL+3
         4 000315   000012 736000                    QLS     10
         4 000316   400000 376003                    ANQ     -131072,DU
         4 000317   200044 756100                    STQ     OLD_JOURNAL_FLAG,,AUTO

      353     7124    1           OLD_ONEREPORT_FLAG = VLP_CGTYPL.LIST.ONEREPORT#(0);

   7124  4 000320   000177 236000 3                  LDQ     VLP_CGTYPL+3
         4 000321   000013 736000                    QLS     11
         4 000322   400000 376003                    ANQ     -131072,DU
         4 000323   200046 756100                    STQ     OLD_ONEREPORT_FLAG,,AUTO

      354     7125    1           OLD_MAXACTIVE = VLP_CGQL.LIST.MXACT#(0);

   7125  4 000324   000204 235000 3                  LDA     VLP_CGQL
         4 000325   200027 755100                    STA     OLD_MAXACTIVE,,AUTO

      355     7126    1           GOTO DO_PRIO;

   7126  4 000326   000401 710000 4                  TRA     DO_PRIO

      356     7127
      357     7128    1   CGINFO_ERR:
      358     7129    1           ERR= B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   7129  4 000327   000000 470400 xsym  CGINFO_ERR   LDP0    B$TCB$
         4 000330   000000 471500                    LDP1    0,,PR0
         4 000331   100102 236100                    LDQ     66,,PR1
         4 000332   200075 756100                    STQ     ERR,,AUTO

      359     7130
      360     7131    1           IF ERR.CODE ~= 1153 /* E$CGAFNT */ THEN

   7131  4 000333   200075 236100                    LDQ     ERR,,AUTO
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:55   
         4 000334   377770 376007                    ANQ     131064,DL
         4 000335   022010 116007                    CMPQ    9224,DL
         4 000336   000340 600000 4                  TZE     s:7139

      361     7132    2             DO;

      362     7133    2               GOTO MON_ERR;

   7133  4 000337   001377 710000 4                  TRA     MON_ERR

      363     7134    2             END;
      364     7135
      365     7136        /* NOTE: This ifs are written like this because connective ands
      366     7137                 dont evaluate from left to right in PL6 */
      367     7138
      368     7139    1           IF PRIO$ ~= ADDR(NIL) THEN

   7139  4 000340   200011 236100                    LDQ     PRIO$,,AUTO
         4 000341   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000342   000352 600000 4                  TZE     s:7148

      369     7140    2             DO;

      370     7141    2               IF PRIO$ -> OUT$BLK.NSUBLKS = 2 THEN

   7141  4 000343   200011 471500                    LDP1    PRIO$,,AUTO
         4 000344   100001 220100                    LDX0    1,,PR1
         4 000345   000002 100003                    CMPX0   2,DU
         4 000346   000352 601000 4                  TNZ     s:7148

      371     7142    3                 DO;

      372     7143    3                   QQ_CMDBLK.MINOR_ERR = CODE_NOTDEF;

   7143  4 000347   000025 236000 2                  LDQ     CODE_NOTDEF
         4 000350   000001 756000 xsym               STQ     QQ_CMDBLK+1

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:56   
      373     7144    3                   GOTO PRINT_ERR;

   7144  4 000351   001362 710000 4                  TRA     PRINT_ERR

      374     7145    3                 END;
      375     7146    2             END;
      376     7147
      377     7148    1           IF MAXACTIVE$ ~= ADDR(NIL) THEN

   7148  4 000352   200015 236100                    LDQ     MAXACTIVE$,,AUTO
         4 000353   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000354   000364 600000 4                  TZE     s:7157

      378     7149    2             DO;

      379     7150    2               IF MAXACTIVE$ -> OUT$BLK.NSUBLKS = 2 THEN

   7150  4 000355   200015 471500                    LDP1    MAXACTIVE$,,AUTO
         4 000356   100001 220100                    LDX0    1,,PR1
         4 000357   000002 100003                    CMPX0   2,DU
         4 000360   000364 601000 4                  TNZ     s:7157

      380     7151    3                 DO;

      381     7152    3                   QQ_CMDBLK.MINOR_ERR = CODE_NOTDEF;

   7152  4 000361   000025 236000 2                  LDQ     CODE_NOTDEF
         4 000362   000001 756000 xsym               STQ     QQ_CMDBLK+1

      382     7153    3                   GOTO PRINT_ERR;

   7153  4 000363   001362 710000 4                  TRA     PRINT_ERR

      383     7154    3                 END;
      384     7155    2             END;
      385     7156
      386     7157    1           OLD_MAXACTIVE = VLP_CGQL_C.LIST.MXACT#(0);
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:57   

   7157  4 000364   000010 235000 2                  LDA     VLP_CGQL_C
         4 000365   200027 755100                    STA     OLD_MAXACTIVE,,AUTO

      387     7158    1           OLD_JOURNAL_FLAG = VLP_CGTYPL_C.LIST.JOURNAL#(0);

   7158  4 000366   000003 236000 2                  LDQ     VLP_CGTYPL_C+3
         4 000367   000012 736000                    QLS     10
         4 000370   400000 376003                    ANQ     -131072,DU
         4 000371   200044 756100                    STQ     OLD_JOURNAL_FLAG,,AUTO

      388     7159    1           OLD_ONEREPORT_FLAG = VLP_CGTYPL_C.LIST.ONEREPORT#(0);

   7159  4 000372   000003 236000 2                  LDQ     VLP_CGTYPL_C+3
         4 000373   000013 736000                    QLS     11
         4 000374   400000 376003                    ANQ     -131072,DU
         4 000375   200046 756100                    STQ     OLD_ONEREPORT_FLAG,,AUTO

      389     7160    1           OLD_PRIO = VLP_CGTYPL_C.LIST.PRIO#(0);

   7160  4 000376   000003 236000 2                  LDQ     VLP_CGTYPL_C+3
         4 000377   000033 772000                    QRL     27
         4 000400   200023 756100                    STQ     OLD_PRIO,,AUTO

      390     7161        %EJECT;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:58   
      391     7162    1   DO_PRIO:
      392     7163    1           NEW_PRIO = OLD_PRIO;

   7163  4 000401   200023 236100       DO_PRIO      LDQ     OLD_PRIO,,AUTO
         4 000402   200024 756100                    STQ     NEW_PRIO,,AUTO

      393     7164    1           IF PRIO$ ~= ADDR(NIL) THEN

   7164  4 000403   200011 236100                    LDQ     PRIO$,,AUTO
         4 000404   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000405   000515 600000 4                  TZE     DO_JOURNAL

      394     7165    2             DO;

      395     7166    2               IF PRIO$ -> OUT$BLK.NSUBLKS = 1 THEN

   7166  4 000406   200011 470500                    LDP0    PRIO$,,AUTO
         4 000407   000001 220100                    LDX0    1,,PR0
         4 000410   000001 100003                    CMPX0   1,DU
         4 000411   000422 601000 4                  TNZ     s:7172

      396     7167    3                 DO;

      397     7168    3                   CALL CHARBIN(NEW_PRIO, PRIO$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);

   7168  4 000412   000003 471500                    LDP1    3,,PR0
         4 000413   100004 236100                    LDQ     4,,PR1
         4 000414   000033 772000                    QRL     27
         4 000415   000000 621006                    EAX1    0,QL
         4 000416   000100 305540                    DTB
         4 000417   100004 230011                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X1
         4 000420   200024 000004                    NDSC9   NEW_PRIO,,AUTO           cn=0,s=lsgnf,sf=0,n=4

      398     7169    3                   GOTO SET_PRIO;

   7169  4 000421   000450 710000 4                  TRA     SET_PRIO

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:59   
      399     7170    3                 END;
      400     7171
      401     7172    2               DELTA = 0;

   7172  4 000422   200034 450100                    STZ     DELTA,,AUTO

      402     7173    2               MULTIPLIER = 1;

   7173  4 000423   000001 235007                    LDA     1,DL
         4 000424   200036 755100                    STA     MULTIPLIER,,AUTO

      403     7174    2               NEW_PRIO = OLD_PRIO;

   7174  4 000425   200023 235100                    LDA     OLD_PRIO,,AUTO
         4 000426   200024 755100                    STA     NEW_PRIO,,AUTO

      404     7175
      405     7176    2               IF PRIO$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.CODE = 2 /* - */ THEN

   7176  4 000427   000003 471500                    LDP1    3,,PR0
         4 000430   100000 721100                    LXL1    0,,PR1
         4 000431   000002 101003                    CMPX1   2,DU
         4 000432   000435 601000 4                  TNZ     s:7181

      406     7177    3                 DO;

      407     7178    3                   MULTIPLIER = -1;

   7178  4 000433   000001 335007                    LCA     1,DL
         4 000434   200036 755100                    STA     MULTIPLIER,,AUTO

      408     7179    3                 END;

      409     7180
      410     7181    2               CALL CHARBIN(DELTA, PRIO$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT);

   7181  4 000435   000004 473500                    LDP3    4,,PR0
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:60   
         4 000436   300004 236100                    LDQ     4,,PR3
         4 000437   000033 772000                    QRL     27
         4 000440   000000 622006                    EAX2    0,QL
         4 000441   000100 305540                    DTB
         4 000442   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         4 000443   200034 000004                    NDSC9   DELTA,,AUTO              cn=0,s=lsgnf,sf=0,n=4

      411     7182
      412     7183    2               NEW_PRIO = NEW_PRIO + DELTA * MULTIPLIER;

   7183  4 000444   200034 236100                    LDQ     DELTA,,AUTO
         4 000445   200036 402100                    MPY     MULTIPLIER,,AUTO
         4 000446   200024 036100                    ADLQ    NEW_PRIO,,AUTO
         4 000447   200024 756100                    STQ     NEW_PRIO,,AUTO

      413     7184
      414     7185    2   SET_PRIO:
      415     7186    2               IF NEW_PRIO > 500 THEN

   7186  4 000450   200024 235100       SET_PRIO     LDA     NEW_PRIO,,AUTO
         4 000451   000764 115007                    CMPA    500,DL
         4 000452   000473 604400 4                  TMOZ    s:7194

      416     7187    3                 DO;

      417     7188    3                   QQ_CMDBLK.MINOR_ERR = CODE_BIGGEST_PRIO;

   7188  4 000453   000026 236000 2                  LDQ     CODE_BIGGEST_PRIO
         4 000454   000001 756000 xsym               STQ     QQ_CMDBLK+1

      418     7189    3                   CALL QQC$BLDMSG_BLK(MSGBLK);

   7189  4 000455   200050 633500                    EPPR3   MSGBLK,,AUTO
         4 000456   200076 453500                    STP3    ERR+1,,AUTO
         4 000457   200076 630500                    EPPR0   ERR+1,,AUTO
         4 000460   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000461   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:61   
         4 000462   000000 011000                    NOP     0

      419     7190    3                   CALL QQC$BLDMSG(MSGBLK);

   7190  4 000463   200050 630500                    EPPR0   MSGBLK,,AUTO
         4 000464   200076 450500                    STP0    ERR+1,,AUTO
         4 000465   200076 630500                    EPPR0   ERR+1,,AUTO
         4 000466   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000467   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000470   000000 011000                    NOP     0

      420     7191    3                   NEW_PRIO = 500;

   7191  4 000471   000764 235007                    LDA     500,DL
         4 000472   200024 755100                    STA     NEW_PRIO,,AUTO

      421     7192    3                 END;

      422     7193
      423     7194    2               IF NEW_PRIO < 1 THEN

   7194  4 000473   000000 115003                    CMPA    0,DU
         4 000474   000515 605400 4                  TPNZ    DO_JOURNAL

      424     7195    3                 DO;

      425     7196    3                   QQ_CMDBLK.MINOR_ERR = CODE_SMALLEST_PRIO;

   7196  4 000475   000027 236000 2                  LDQ     CODE_SMALLEST_PRIO
         4 000476   000001 756000 xsym               STQ     QQ_CMDBLK+1

      426     7197    3                   CALL QQC$BLDMSG_BLK(MSGBLK);

   7197  4 000477   200050 630500                    EPPR0   MSGBLK,,AUTO
         4 000500   200076 450500                    STP0    ERR+1,,AUTO
         4 000501   200076 630500                    EPPR0   ERR+1,,AUTO
         4 000502   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:62   
         4 000503   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 000504   000000 011000                    NOP     0

      427     7198    3                   CALL QQC$BLDMSG(MSGBLK);

   7198  4 000505   200050 630500                    EPPR0   MSGBLK,,AUTO
         4 000506   200076 450500                    STP0    ERR+1,,AUTO
         4 000507   200076 630500                    EPPR0   ERR+1,,AUTO
         4 000510   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000511   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000512   000000 011000                    NOP     0

      428     7199    3                   NEW_PRIO = 1;

   7199  4 000513   000001 235007                    LDA     1,DL
         4 000514   200024 755100                    STA     NEW_PRIO,,AUTO

      429     7200    3                 END;

      430     7201    2             END;

      431     7202        %EJECT;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:63   
      432     7203    1   DO_JOURNAL:
      433     7204    1           NEW_JOURNAL_FLAG = OLD_JOURNAL_FLAG;

   7204  4 000515   200044 236100       DO_JOURNAL   LDQ     OLD_JOURNAL_FLAG,,AUTO
         4 000516   400000 376003                    ANQ     -131072,DU
         4 000517   200043 756100                    STQ     NEW_JOURNAL_FLAG,,AUTO

      434     7205    1           IF JOURNAL$ ~= ADDR(NIL) THEN

   7205  4 000520   200006 236100                    LDQ     JOURNAL$,,AUTO
         4 000521   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000522   000533 600000 4                  TZE     DO_ONEREPORT

      435     7206    2             DO;

      436     7207    2               IF JOURNAL$ -> OUT$SYM.CODE = 2 /* YES */ THEN

   7207  4 000523   200006 470500                    LDP0    JOURNAL$,,AUTO
         4 000524   000000 720100                    LXL0    0,,PR0
         4 000525   000002 100003                    CMPX0   2,DU
         4 000526   000532 601000 4                  TNZ     s:7213

      437     7208    3                 DO;

      438     7209    3                   NEW_JOURNAL_FLAG = '1'B;

   7209  4 000527   400000 236003                    LDQ     -131072,DU
         4 000530   200043 756100                    STQ     NEW_JOURNAL_FLAG,,AUTO

      439     7210    3                 END;

   7210  4 000531   000533 710000 4                  TRA     DO_ONEREPORT

      440     7211    2               ELSE
      441     7212    3                 DO;

      442     7213    3                   NEW_JOURNAL_FLAG = '0'B;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:64   

   7213  4 000532   200043 450100                    STZ     NEW_JOURNAL_FLAG,,AUTO

      443     7214    3                 END;

      444     7215    2             END;

      445     7216        %EJECT;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:65   
      446     7217    1   DO_ONEREPORT:
      447     7218    1           NEW_ONEREPORT_FLAG = OLD_ONEREPORT_FLAG;

   7218  4 000533   200046 236100       DO_ONEREPORT LDQ     OLD_ONEREPORT_FLAG,,AUTO
         4 000534   400000 376003                    ANQ     -131072,DU
         4 000535   200045 756100                    STQ     NEW_ONEREPORT_FLAG,,AUTO

      448     7219    1           IF ONEREPORT$ ~= ADDR(NIL) THEN

   7219  4 000536   200007 236100                    LDQ     ONEREPORT$,,AUTO
         4 000537   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000540   000551 600000 4                  TZE     DO_MAXACTIVE

      449     7220    2             DO;

      450     7221    2               IF ONEREPORT$ -> OUT$SYM.CODE = 2 /* YES */ THEN

   7221  4 000541   200007 470500                    LDP0    ONEREPORT$,,AUTO
         4 000542   000000 720100                    LXL0    0,,PR0
         4 000543   000002 100003                    CMPX0   2,DU
         4 000544   000550 601000 4                  TNZ     s:7227

      451     7222    3                 DO;

      452     7223    3                   NEW_ONEREPORT_FLAG = '1'B;

   7223  4 000545   400000 236003                    LDQ     -131072,DU
         4 000546   200045 756100                    STQ     NEW_ONEREPORT_FLAG,,AUTO

      453     7224    3                 END;

   7224  4 000547   000551 710000 4                  TRA     DO_MAXACTIVE

      454     7225    2               ELSE
      455     7226    3                 DO;

      456     7227    3                   NEW_ONEREPORT_FLAG = '0'B;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:66   

   7227  4 000550   200045 450100                    STZ     NEW_ONEREPORT_FLAG,,AUTO

      457     7228    3                 END;

      458     7229    2             END;

      459     7230        %EJECT;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:67   
      460     7231    1   DO_MAXACTIVE:
      461     7232    1           NEW_MAXACTIVE = OLD_MAXACTIVE;

   7232  4 000551   200027 235100       DO_MAXACTIVE LDA     OLD_MAXACTIVE,,AUTO
         4 000552   200030 755100                    STA     NEW_MAXACTIVE,,AUTO

      462     7233    1           IF MAXACTIVE$ ~= ADDR(NIL) THEN

   7233  4 000553   200015 236100                    LDQ     MAXACTIVE$,,AUTO
         4 000554   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000555   000637 600000 4                  TZE     s:7267

      463     7234    2             DO;

      464     7235    2               IF MAXACTIVE$ -> OUT$BLK.NSUBLKS = 1 THEN

   7235  4 000556   200015 470500                    LDP0    MAXACTIVE$,,AUTO
         4 000557   000001 220100                    LDX0    1,,PR0
         4 000560   000001 100003                    CMPX0   1,DU
         4 000561   000572 601000 4                  TNZ     s:7242

      465     7236    3                 DO;

      466     7237    3                   CALL CHARBIN(NEW_MAXACTIVE, MAXACTIVE$ -> OUT$BLK.SUBLK$(0) ->

   7237  4 000562   000003 471500                    LDP1    3,,PR0
         4 000563   100004 236100                    LDQ     4,,PR1
         4 000564   000033 772000                    QRL     27
         4 000565   000000 621006                    EAX1    0,QL
         4 000566   000100 305540                    DTB
         4 000567   100004 230011                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X1
         4 000570   200030 000004                    NDSC9   NEW_MAXACTIVE,,AUTO      cn=0,s=lsgnf,sf=0,n=4

      467     7238    3                       OUT$SYM.TEXT);
      468     7239    3                   GOTO SET_MAXACTIVE;

   7239  4 000571   000616 710000 4                  TRA     SET_MAXACTIVE
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:68   

      469     7240    3                 END;
      470     7241
      471     7242    2               DELTA = 0;

   7242  4 000572   200034 450100                    STZ     DELTA,,AUTO

      472     7243    2               MULTIPLIER = 1;

   7243  4 000573   000001 235007                    LDA     1,DL
         4 000574   200036 755100                    STA     MULTIPLIER,,AUTO

      473     7244
      474     7245    2               IF MAXACTIVE$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.CODE = 2 /* - */ THEN

   7245  4 000575   000003 471500                    LDP1    3,,PR0
         4 000576   100000 721100                    LXL1    0,,PR1
         4 000577   000002 101003                    CMPX1   2,DU
         4 000600   000603 601000 4                  TNZ     s:7250

      475     7246    3                 DO;

      476     7247    3                   MULTIPLIER = -1;

   7247  4 000601   000001 335007                    LCA     1,DL
         4 000602   200036 755100                    STA     MULTIPLIER,,AUTO

      477     7248    3                 END;

      478     7249
      479     7250    2               CALL CHARBIN(DELTA, MAXACTIVE$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT);

   7250  4 000603   000004 473500                    LDP3    4,,PR0
         4 000604   300004 236100                    LDQ     4,,PR3
         4 000605   000033 772000                    QRL     27
         4 000606   000000 622006                    EAX2    0,QL
         4 000607   000100 305540                    DTB
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:69   
         4 000610   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         4 000611   200034 000004                    NDSC9   DELTA,,AUTO              cn=0,s=lsgnf,sf=0,n=4

      480     7251
      481     7252    2               NEW_MAXACTIVE = OLD_MAXACTIVE + DELTA * MULTIPLIER;

   7252  4 000612   200034 236100                    LDQ     DELTA,,AUTO
         4 000613   200036 402100                    MPY     MULTIPLIER,,AUTO
         4 000614   200027 036100                    ADLQ    OLD_MAXACTIVE,,AUTO
         4 000615   200030 756100                    STQ     NEW_MAXACTIVE,,AUTO

      482     7253
      483     7254    2   SET_MAXACTIVE:
      484     7255    2               IF NEW_MAXACTIVE < 0 THEN

   7255  4 000616   200030 235100       SET_MAXACTI* LDA     NEW_MAXACTIVE,,AUTO
         4 000617   000637 605000 4                  TPL     s:7267

      485     7256    3                 DO;

      486     7257    3                   NEW_MAXACTIVE = 0;

   7257  4 000620   200030 450100                    STZ     NEW_MAXACTIVE,,AUTO

      487     7258    3                   QQ_CMDBLK.MINOR_ERR = CODE_SMALLEST_MAXACT;

   7258  4 000621   000030 236000 2                  LDQ     CODE_SMALLEST_MAXACT
         4 000622   000001 756000 xsym               STQ     QQ_CMDBLK+1

      488     7259    3                   CALL QQC$BLDMSG_BLK(MSGBLK);

   7259  4 000623   200050 633500                    EPPR3   MSGBLK,,AUTO
         4 000624   200076 453500                    STP3    ERR+1,,AUTO
         4 000625   200076 630500                    EPPR0   ERR+1,,AUTO
         4 000626   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000627   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 000630   000000 011000                    NOP     0
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:70   

      489     7260    3                   CALL QQC$BLDMSG(MSGBLK);

   7260  4 000631   200050 630500                    EPPR0   MSGBLK,,AUTO
         4 000632   200076 450500                    STP0    ERR+1,,AUTO
         4 000633   200076 630500                    EPPR0   ERR+1,,AUTO
         4 000634   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000635   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000636   000000 011000                    NOP     0

      490     7261    3                 END;

      491     7262    2             END;

      492     7263
      493     7264        %EJECT;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:71   
      494     7265        /* Calculate the current # of permanent TPUs processing this
      495     7266           type of transaction */
      496     7267    1           DELTA = 0;

   7267  4 000637   200034 450100                    STZ     DELTA,,AUTO

      497     7268    1           OLD_PERM = 0;

   7268  4 000640   200031 450100                    STZ     OLD_PERM,,AUTO

      498     7269
      499     7270    1           NEXT$ = QQ_GLOBAL.TPU$;

   7270  4 000641   000155 236000 xsym               LDQ     QQ_GLOBAL+109
         4 000642   200005 756100                    STQ     NEXT$,,AUTO

      500     7271    2           DO WHILE('1'B);

      501     7272    2             NEXT$ = NEXT$ -> TPU$INFO.FLINK$;

   7272  4 000643   200005 470500                    LDP0    NEXT$,,AUTO
         4 000644   000001 236100                    LDQ     1,,PR0
         4 000645   200005 756100                    STQ     NEXT$,,AUTO

      502     7273    2             IF NEXT$ -> TPU$INFO.FLINK$ = ADDR(NIL) THEN

   7273  4 000646   200005 470500                    LDP0    NEXT$,,AUTO
         4 000647   000001 236100                    LDQ     1,,PR0
         4 000650   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000651   000653 601000 4                  TNZ     s:7278

      503     7274    3               DO;

      504     7275    3                 GOTO CALC_NEW_PERM;

   7275  4 000652   000663 710000 4                  TRA     CALC_NEW_PERM

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:72   
      505     7276    3               END;
      506     7277
      507     7278    2             IF NEXT$ -> TPU$INFO.MSGTYP = MSGTYP THEN

   7278  4 000653   040100 106500                    CMPC    fill='040'O
         4 000654   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
         4 000655   200040 000010                    ADSC9   MSGTYP,,AUTO             cn=0,n=8
         4 000656   000643 601000 4                  TNZ     s:7272

      508     7279    3               DO;

      509     7280    3                 OLD_PERM = OLD_PERM + 1;

   7280  4 000657   200031 235100                    LDA     OLD_PERM,,AUTO
         4 000660   000001 035007                    ADLA    1,DL
         4 000661   200031 755100                    STA     OLD_PERM,,AUTO

      510     7281    3               END;

      511     7282    2           END;

   7282  4 000662   000643 710000 4                  TRA     s:7272

      512     7283        %EJECT;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:73   
      513     7284    1   CALC_NEW_PERM:
      514     7285    1           NEW_PERM = OLD_PERM;

   7285  4 000663   200031 235100       CALC_NEW_PE* LDA     OLD_PERM,,AUTO
         4 000664   200032 755100                    STA     NEW_PERM,,AUTO

      515     7286    1           IF PERM$ ~= ADDR(NIL) THEN

   7286  4 000665   200013 236100                    LDQ     PERM$,,AUTO
         4 000666   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000667   000727 600000 4                  TZE     SET_PERM

      516     7287    2             DO;

      517     7288    2               IF PERM$ -> OUT$BLK.NSUBLKS = 1 THEN

   7288  4 000670   200013 471500                    LDP1    PERM$,,AUTO
         4 000671   100001 220100                    LDX0    1,,PR1
         4 000672   000001 100003                    CMPX0   1,DU
         4 000673   000704 601000 4                  TNZ     s:7294

      518     7289    3                 DO;

      519     7290    3                   CALL CHARBIN(NEW_PERM, PERM$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);

   7290  4 000674   100003 473500                    LDP3    3,,PR1
         4 000675   300004 236100                    LDQ     4,,PR3
         4 000676   000033 772000                    QRL     27
         4 000677   000000 621006                    EAX1    0,QL
         4 000700   000100 305540                    DTB
         4 000701   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         4 000702   200032 000004                    NDSC9   NEW_PERM,,AUTO           cn=0,s=lsgnf,sf=0,n=4

      520     7291    3                   GOTO SET_PERM;

   7291  4 000703   000727 710000 4                  TRA     SET_PERM

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:74   
      521     7292    3                 END;
      522     7293
      523     7294    2               MULTIPLIER = 1;

   7294  4 000704   000001 235007                    LDA     1,DL
         4 000705   200036 755100                    STA     MULTIPLIER,,AUTO

      524     7295
      525     7296    2               IF PERM$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.CODE = 2 /* - */ THEN

   7296  4 000706   100003 473500                    LDP3    3,,PR1
         4 000707   300000 721100                    LXL1    0,,PR3
         4 000710   000002 101003                    CMPX1   2,DU
         4 000711   000714 601000 4                  TNZ     s:7301

      526     7297    3                 DO;

      527     7298    3                   MULTIPLIER = -1;

   7298  4 000712   000001 335007                    LCA     1,DL
         4 000713   200036 755100                    STA     MULTIPLIER,,AUTO

      528     7299    3                 END;

      529     7300
      530     7301    2               CALL CHARBIN(DELTA, PERM$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT);

   7301  4 000714   100004 474500                    LDP4    4,,PR1
         4 000715   400004 236100                    LDQ     4,,PR4
         4 000716   000033 772000                    QRL     27
         4 000717   000000 622006                    EAX2    0,QL
         4 000720   000100 305540                    DTB
         4 000721   400004 230012                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X2
         4 000722   200034 000004                    NDSC9   DELTA,,AUTO              cn=0,s=lsgnf,sf=0,n=4

      531     7302
      532     7303    2               NEW_PERM = OLD_PERM + DELTA * MULTIPLIER;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:75   

   7303  4 000723   200034 236100                    LDQ     DELTA,,AUTO
         4 000724   200036 402100                    MPY     MULTIPLIER,,AUTO
         4 000725   200031 036100                    ADLQ    OLD_PERM,,AUTO
         4 000726   200032 756100                    STQ     NEW_PERM,,AUTO

      533     7304    2             END;

      534     7305
      535     7306    1   SET_PERM:
      536     7307    1           IF DELTA ~= 0 THEN

   7307  4 000727   200034 235100       SET_PERM     LDA     DELTA,,AUTO
         4 000730   000735 600000 4                  TZE     s:7313

      537     7308    2             DO;

      538     7309    2               DELTA_PERM = DELTA * MULTIPLIER;

   7309  4 000731   200034 236100                    LDQ     DELTA,,AUTO
         4 000732   200036 402100                    MPY     MULTIPLIER,,AUTO
         4 000733   200035 756100                    STQ     DELTA_PERM,,AUTO

      539     7310    2             END;

   7310  4 000734   000740 710000 4                  TRA     s:7316

      540     7311    1           ELSE
      541     7312    2             DO;

      542     7313    2               DELTA_PERM = NEW_PERM - OLD_PERM;

   7313  4 000735   200032 236100                    LDQ     NEW_PERM,,AUTO
         4 000736   200031 136100                    SBLQ    OLD_PERM,,AUTO
         4 000737   200035 756100                    STQ     DELTA_PERM,,AUTO

      543     7314    2             END;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:76   

      544     7315
      545     7316    1           IF DELTA_PERM + OLD_PERM < 0 THEN

   7316  4 000740   200031 036100                    ADLQ    OLD_PERM,,AUTO
         4 000741   000745 605000 4                  TPL     s:7322

      546     7317    2             DO;

      547     7318    2               QQ_CMDBLK.MINOR_ERR = CODE_NOTENUF_TPUS;

   7318  4 000742   000031 236000 2                  LDQ     CODE_NOTENUF_TPUS
         4 000743   000001 756000 xsym               STQ     QQ_CMDBLK+1

      548     7319    2               GOTO PRINT_ERR;

   7319  4 000744   001362 710000 4                  TRA     PRINT_ERR

      549     7320    2             END;
      550     7321
      551     7322    1           IF DELTA_PERM + OLD_PERM > NEW_MAXACTIVE THEN

   7322  4 000745   200035 236100                    LDQ     DELTA_PERM,,AUTO
         4 000746   200031 036100                    ADLQ    OLD_PERM,,AUTO
         4 000747   200030 116100                    CMPQ    NEW_MAXACTIVE,,AUTO
         4 000750   000767 604400 4                  TMOZ    CALC_TIMEOUT

      552     7323    2             DO;

      553     7324    2               QQ_CMDBLK.MINOR_ERR = CODE_BIGR_MAXACT;

   7324  4 000751   000032 236000 2                  LDQ     CODE_BIGR_MAXACT
         4 000752   000001 756000 xsym               STQ     QQ_CMDBLK+1

      554     7325    2               CALL QQC$BLDMSG_BLK(MSGBLK);

   7325  4 000753   200050 631500                    EPPR1   MSGBLK,,AUTO
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:77   
         4 000754   200076 451500                    STP1    ERR+1,,AUTO
         4 000755   200076 630500                    EPPR0   ERR+1,,AUTO
         4 000756   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000757   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 000760   000000 011000                    NOP     0

      555     7326    2               CALL QQC$BLDMSG(MSGBLK);

   7326  4 000761   200050 630500                    EPPR0   MSGBLK,,AUTO
         4 000762   200076 450500                    STP0    ERR+1,,AUTO
         4 000763   200076 630500                    EPPR0   ERR+1,,AUTO
         4 000764   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000765   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000766   000000 011000                    NOP     0

      556     7327    2             END;

      557     7328        %EJECT;
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:78   
      558     7329    1   CALC_TIMEOUT:
      559     7330    1           IF TIMEOUT$ ~= ADDR(NIL) THEN

   7330  4 000767   200016 236100       CALC_TIMEOUT LDQ     TIMEOUT$,,AUTO
         4 000770   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000771   001050 600000 4                  TZE     CALC_MAXLATCH

      560     7331    2             DO;

      561     7332    2               CALL CHARBIN(TIMEOUT, TIMEOUT$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);

   7332  4 000772   200016 470500                    LDP0    TIMEOUT$,,AUTO
         4 000773   000003 471500                    LDP1    3,,PR0
         4 000774   100004 236100                    LDQ     4,,PR1
         4 000775   000033 772000                    QRL     27
         4 000776   000000 620006                    EAX0    0,QL
         4 000777   000100 305540                    DTB
         4 001000   100004 230010                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X0
         4 001001   200076 000010                    NDSC9   ERR+1,,AUTO              cn=0,s=lsgnf,sf=0,n=8
         4 001002   200077 235100                    LDA     ERR+2,,AUTO
         4 001003   200033 755100                    STA     TIMEOUT,,AUTO

      562     7333    2               IF TIMEOUT < 1 THEN

   7333  4 001004   001025 601000 4                  TNZ     s:7341

      563     7334    3                 DO;

      564     7335    3                   TIMEOUT = 1;            /* set to 1 minute                    */

   7335  4 001005   000001 236007                    LDQ     1,DL
         4 001006   200033 756100                    STQ     TIMEOUT,,AUTO

      565     7336    3                   QQ_CMDBLK.MINOR_ERR = CODE_SMALLEST_TIMEOUT;

   7336  4 001007   000036 236000 2                  LDQ     CODE_SMALLEST_TIMEOUT
         4 001010   000001 756000 xsym               STQ     QQ_CMDBLK+1
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:79   

      566     7337    3                   CALL QQC$BLDMSG_BLK(MSGBLK);

   7337  4 001011   200050 631500                    EPPR1   MSGBLK,,AUTO
         4 001012   200076 451500                    STP1    ERR+1,,AUTO
         4 001013   200076 630500                    EPPR0   ERR+1,,AUTO
         4 001014   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001015   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 001016   000000 011000                    NOP     0

      567     7338    3                   CALL QQC$BLDMSG(MSGBLK);

   7338  4 001017   200050 630500                    EPPR0   MSGBLK,,AUTO
         4 001020   200076 450500                    STP0    ERR+1,,AUTO
         4 001021   200076 630500                    EPPR0   ERR+1,,AUTO
         4 001022   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001023   000000 701000 xent               TSX1    QQC$BLDMSG
         4 001024   000000 011000                    NOP     0

      568     7339    3                 END;

      569     7340
      570     7341    2               IF TIMEOUT > 4000 THEN

   7341  4 001025   200033 235100                    LDA     TIMEOUT,,AUTO
         4 001026   007641 115007                    CMPA    4001,DL
         4 001027   001050 602000 4                  TNC     CALC_MAXLATCH

      571     7342    3                 DO;

      572     7343    3                   TIMEOUT = 4000;         /* set to 4000 minutes                */

   7343  4 001030   007640 236007                    LDQ     4000,DL
         4 001031   200033 756100                    STQ     TIMEOUT,,AUTO

      573     7344    3                   QQ_CMDBLK.MINOR_ERR = CODE_BIGGEST_TIMEOUT;

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:80   
   7344  4 001032   000037 236000 2                  LDQ     CODE_BIGGEST_TIMEOUT
         4 001033   000001 756000 xsym               STQ     QQ_CMDBLK+1

      574     7345    3                   CALL QQC$BLDMSG_BLK(MSGBLK);

   7345  4 001034   200050 630500                    EPPR0   MSGBLK,,AUTO
         4 001035   200076 450500                    STP0    ERR+1,,AUTO
         4 001036   200076 630500                    EPPR0   ERR+1,,AUTO
         4 001037   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001040   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 001041   000000 011000                    NOP     0

      575     7346    3                   CALL QQC$BLDMSG(MSGBLK);

   7346  4 001042   200050 630500                    EPPR0   MSGBLK,,AUTO
         4 001043   200076 450500                    STP0    ERR+1,,AUTO
         4 001044   200076 630500                    EPPR0   ERR+1,,AUTO
         4 001045   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001046   000000 701000 xent               TSX1    QQC$BLDMSG
         4 001047   000000 011000                    NOP     0

      576     7347    3                 END;

      577     7348
      578     7349    2             END;

      579     7350    1   CALC_MAXLATCH:
      580     7351    1           NEW_MAXLATCH = OLD_MAXLATCH;

   7351  4 001050   200025 235100       CALC_MAXLAT* LDA     OLD_MAXLATCH,,AUTO
         4 001051   200026 755100                    STA     NEW_MAXLATCH,,AUTO

      581     7352    1           IF MAXLATCH$ ~= ADDR(NIL) THEN

   7352  4 001052   200012 236100                    LDQ     MAXLATCH$,,AUTO
         4 001053   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 001054   001132 600000 4                  TZE     s:7372
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:81   

      582     7353    2             DO;

      583     7354    2               CALL CHARBIN(NEW_MAXLATCH, MAXLATCH$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.
              7354                        TEXT);

   7354  4 001055   200012 470500                    LDP0    MAXLATCH$,,AUTO
         4 001056   000003 471500                    LDP1    3,,PR0
         4 001057   100004 236100                    LDQ     4,,PR1
         4 001060   000033 772000                    QRL     27
         4 001061   000000 620006                    EAX0    0,QL
         4 001062   000100 305540                    DTB
         4 001063   100004 230010                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X0
         4 001064   200026 000004                    NDSC9   NEW_MAXLATCH,,AUTO       cn=0,s=lsgnf,sf=0,n=4

      584     7355    2               IF NEW_MAXLATCH < 1 THEN

   7355  4 001065   200026 235100                    LDA     NEW_MAXLATCH,,AUTO
         4 001066   001107 605400 4                  TPNZ    s:7363

      585     7356    3                 DO;

      586     7357    3                   NEW_MAXLATCH = 1;       /* set to 1 latched write             */

   7357  4 001067   000001 235007                    LDA     1,DL
         4 001070   200026 755100                    STA     NEW_MAXLATCH,,AUTO

      587     7358    3                   QQ_CMDBLK.MINOR_ERR = CODE_SMALLEST_MAXLATCH;

   7358  4 001071   000040 236000 2                  LDQ     CODE_SMALLEST_MAXLATCH
         4 001072   000001 756000 xsym               STQ     QQ_CMDBLK+1

      588     7359    3                   CALL QQC$BLDMSG_BLK(MSGBLK);

   7359  4 001073   200050 633500                    EPPR3   MSGBLK,,AUTO
         4 001074   200076 453500                    STP3    ERR+1,,AUTO
         4 001075   200076 630500                    EPPR0   ERR+1,,AUTO
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:82   
         4 001076   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001077   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 001100   000000 011000                    NOP     0

      589     7360    3                   CALL QQC$BLDMSG(MSGBLK);

   7360  4 001101   200050 630500                    EPPR0   MSGBLK,,AUTO
         4 001102   200076 450500                    STP0    ERR+1,,AUTO
         4 001103   200076 630500                    EPPR0   ERR+1,,AUTO
         4 001104   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001105   000000 701000 xent               TSX1    QQC$BLDMSG
         4 001106   000000 011000                    NOP     0

      590     7361    3                 END;

      591     7362
      592     7363    2               IF NEW_MAXLATCH > 262143 THEN

   7363  4 001107   200026 235100                    LDA     NEW_MAXLATCH,,AUTO
         4 001110   777777 115007                    CMPA    -1,DL
         4 001111   001132 604400 4                  TMOZ    s:7372

      593     7364    3                 DO;

      594     7365    3                   NEW_MAXLATCH = 262143; /* set to 263000 latched writes */

   7365  4 001112   777777 236007                    LDQ     -1,DL
         4 001113   200026 756100                    STQ     NEW_MAXLATCH,,AUTO

      595     7366    3                   QQ_CMDBLK.MINOR_ERR = CODE_BIGGEST_MAXLATCH;

   7366  4 001114   000041 236000 2                  LDQ     CODE_BIGGEST_MAXLATCH
         4 001115   000001 756000 xsym               STQ     QQ_CMDBLK+1

      596     7367    3                   CALL QQC$BLDMSG_BLK(MSGBLK);

   7367  4 001116   200050 630500                    EPPR0   MSGBLK,,AUTO
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:83   
         4 001117   200076 450500                    STP0    ERR+1,,AUTO
         4 001120   200076 630500                    EPPR0   ERR+1,,AUTO
         4 001121   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001122   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 001123   000000 011000                    NOP     0

      597     7368    3                   CALL QQC$BLDMSG(MSGBLK);

   7368  4 001124   200050 630500                    EPPR0   MSGBLK,,AUTO
         4 001125   200076 450500                    STP0    ERR+1,,AUTO
         4 001126   200076 630500                    EPPR0   ERR+1,,AUTO
         4 001127   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001130   000000 701000 xent               TSX1    QQC$BLDMSG
         4 001131   000000 011000                    NOP     0

      598     7369    3                 END;

      599     7370
      600     7371    2             END;

      601     7372    1           IF PRIO$ ~= ADDR(NIL) OR MAXACTIVE$ ~= ADDR(NIL) OR

   7372  4 001132   200011 236100                    LDQ     PRIO$,,AUTO
         4 001133   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 001134   001151 601000 4                  TNZ     s:7376
         4 001135   200015 236100                    LDQ     MAXACTIVE$,,AUTO
         4 001136   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 001137   001151 601000 4                  TNZ     s:7376
         4 001140   200012 236100                    LDQ     MAXLATCH$,,AUTO
         4 001141   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 001142   001151 601000 4                  TNZ     s:7376
         4 001143   200006 236100                    LDQ     JOURNAL$,,AUTO
         4 001144   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 001145   001151 601000 4                  TNZ     s:7376
         4 001146   200007 236100                    LDQ     ONEREPORT$,,AUTO
         4 001147   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 001150   001210 600000 4                  TZE     s:7386
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:84   

      602     7373    1               MAXLATCH$ ~= ADDR(NIL) OR
      603     7374    1               JOURNAL$ ~= ADDR(NIL) OR ONEREPORT$ ~= ADDR(NIL) THEN
      604     7375    2             DO;

      605     7376    2               VLP_CGTYPL.LIST(0) = VLP_CGTYPL_C.LIST(0);

   7376  4 001151   000000 100400                    MLR     fill='000'O
         4 001152   000001 000034 2                  ADSC9   VLP_CGTYPL_C+1           cn=0,n=28
         4 001153   000175 000034 3                  ADSC9   VLP_CGTYPL+1             cn=0,n=28

      606     7377    2               VLP_CGQL.LIST(0) = VLP_CGQL_C.LIST(0);

   7377  4 001154   000000 100400                    MLR     fill='000'O
         4 001155   000010 000044 2                  ADSC9   VLP_CGQL_C               cn=0,n=36
         4 001156   000204 000044 3                  ADSC9   VLP_CGQL                 cn=0,n=36

      607     7378    2               VLP_CGTYPL.LIST.NAME#(0) = TYPE$ -> OUT$SYM.TEXT;

   7378  4 001157   200014 470500                    LDP0    TYPE$,,AUTO
         4 001160   000004 236100                    LDQ     4,,PR0
         4 001161   000033 772000                    QRL     27
         4 001162   000000 620006                    EAX0    0,QL
         4 001163   040000 100540                    MLR     fill='040'O
         4 001164   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 001165   000175 000010 3                  ADSC9   VLP_CGTYPL+1             cn=0,n=8

      608     7379    2               VLP_CGTYPL.LIST.MAXLATCH#(0) = NEW_MAXLATCH;

   7379  4 001166   200026 720100                    LXL0    NEW_MAXLATCH,,AUTO
         4 001167   000201 740000 3                  STX0    VLP_CGTYPL+5

      609     7380    2               VLP_CGTYPL.LIST.JOURNAL#(0) = NEW_JOURNAL_FLAG;

   7380  4 001170   200043 236100                    LDQ     NEW_JOURNAL_FLAG,,AUTO
         4 001171   000012 772000                    QRL     10
         4 001172   000177 676000 3                  ERQ     VLP_CGTYPL+3
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:85   
         4 001173   000200 376003                    ANQ     128,DU
         4 001174   000177 656000 3                  ERSQ    VLP_CGTYPL+3

      610     7381    2               VLP_CGTYPL.LIST.ONEREPORT#(0) = NEW_ONEREPORT_FLAG;

   7381  4 001175   200045 236100                    LDQ     NEW_ONEREPORT_FLAG,,AUTO
         4 001176   000013 772000                    QRL     11
         4 001177   000177 676000 3                  ERQ     VLP_CGTYPL+3
         4 001200   000100 376003                    ANQ     64,DU
         4 001201   000177 656000 3                  ERSQ    VLP_CGTYPL+3

      611     7382    2               VLP_CGQL.LIST.MXACT#(0) = NEW_MAXACTIVE;

   7382  4 001202   200030 235100                    LDA     NEW_MAXACTIVE,,AUTO
         4 001203   000204 755000 3                  STA     VLP_CGQL

      612     7383    2               CALL M$CGCTL(FPT_CGCTL) ALTRET(MON_ERR);

   7383  4 001204   000026 630400 3                  EPPR0   FPT_CGCTL
         4 001205   500003 713400                    CLIMB   alt,+32771
         4 001206   411400 401760                    pmme    nvectors=20
         4 001207   001377 702000 4                  TSX2    MON_ERR

      613     7384    2             END;

      614     7385
      615     7386    1           IF DELTA_PERM >= 1 AND NOW_FLAG AND WILD_FLAG THEN

   7386  4 001210   200035 235100                    LDA     DELTA_PERM,,AUTO
         4 001211   001223 604400 4                  TMOZ    s:7393
         4 001212   200047 234100                    SZN     NOW_FLAG,,AUTO
         4 001213   001223 605000 4                  TPL     s:7393
         4 001214   200042 234100                    SZN     WILD_FLAG,,AUTO
         4 001215   001223 605000 4                  TPL     s:7393

      616     7387    2             DO;

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:86   
      617     7388    2               QQ_CMDBLK.MINOR_ERR = CODE_NOWWT;

   7388  4 001216   000035 236000 2                  LDQ     CODE_NOWWT
         4 001217   000001 756000 xsym               STQ     QQ_CMDBLK+1

      618     7389    2               QQ_CMDBLK.FLAGS.ERR = '1'B;

   7389  4 001220   400000 236007                    LDQ     -131072,DL
         4 001221   000010 256000 xsym               ORSQ    QQ_CMDBLK+8

      619     7390    2               GOTO PRINT_ERR;

   7390  4 001222   001362 710000 4                  TRA     PRINT_ERR

      620     7391    2             END;
      621     7392
      622     7393    2           DO I = 1 TO DELTA_PERM;

   7393  4 001223   000001 236007                    LDQ     1,DL
         4 001224   200020 756100                    STQ     I,,AUTO
         4 001225   001243 710000 4                  TRA     s:7395+1

      623     7394    2             CALL QQC$START_TPU(MSGTYP,ERR,NOW_FLAG,TIMEOUT) ALTRET(START_ERR);

   7394  4 001226   200033 630500                    EPPR0   TIMEOUT,,AUTO
         4 001227   200101 450500                    STP0    ERR+4,,AUTO
         4 001230   200047 631500                    EPPR1   NOW_FLAG,,AUTO
         4 001231   200100 451500                    STP1    ERR+3,,AUTO
         4 001232   200075 633500                    EPPR3   ERR,,AUTO
         4 001233   200077 453500                    STP3    ERR+2,,AUTO
         4 001234   200040 634500                    EPPR4   MSGTYP,,AUTO
         4 001235   200076 454500                    STP4    ERR+1,,AUTO
         4 001236   200076 630500                    EPPR0   ERR+1,,AUTO
         4 001237   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001240   000000 701000 xent               TSX1    QQC$START_TPU
         4 001241   001313 702000 4                  TSX2    START_ERR

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:87   
      624     7395    2           END;

   7395  4 001242   200020 054100                    AOS     I,,AUTO
         4 001243   200020 236100                    LDQ     I,,AUTO
         4 001244   200035 116100                    CMPQ    DELTA_PERM,,AUTO
         4 001245   001226 604400 4                  TMOZ    s:7394

      625     7396
      626     7397    1           NEXT$ = QQ_GLOBAL.TPU$;

   7397  4 001246   000155 236000 xsym               LDQ     QQ_GLOBAL+109
         4 001247   200005 756100                    STQ     NEXT$,,AUTO

      627     7398    2           DO WHILE(DELTA_PERM < 0);

   7398  4 001250   200035 235100                    LDA     DELTA_PERM,,AUTO
         4 001251   001307 605000 4                  TPL     s:7419

      628     7399    2             NEXT$ = NEXT$ -> TPU$INFO.FLINK$;

   7399  4 001252   200005 470500                    LDP0    NEXT$,,AUTO
         4 001253   000001 236100                    LDQ     1,,PR0
         4 001254   200005 756100                    STQ     NEXT$,,AUTO

      629     7400    2             IF MSGTYP = NEXT$ -> TPU$INFO.MSGTYP THEN

   7400  4 001255   200005 470500                    LDP0    NEXT$,,AUTO
         4 001256   040100 106500                    CMPC    fill='040'O
         4 001257   200040 000010                    ADSC9   MSGTYP,,AUTO             cn=0,n=8
         4 001260   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
         4 001261   001305 601000 4                  TNZ     s:7417

      630     7401    3               DO;

      631     7402    3                 STATION = NEXT$ -> TPU$INFO.STATION;

   7402  4 001262   040000 100500                    MLR     fill='040'O
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:88   
         4 001263   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8
         4 001264   000000 000010 3                  ADSC9   STATION                  cn=0,n=8

      632     7403    3                 CALL M$ACTIVATE(FPT_ACTIVATE) ALTRET(ACTIVATE_ERR);

   7403  4 001265   000006 630400 3                  EPPR0   FPT_ACTIVATE
         4 001266   500000 713400                    CLIMB   alt,+32768
         4 001267   401400 401760                    pmme    nvectors=4
         4 001270   001275 702000 4                  TSX2    ACTIVATE_ERR

      633     7404    3                 NEXT$ -> TPU$INFO.FLAGS.DISCONNECT = '1'B;

   7404  4 001271   200005 470500                    LDP0    NEXT$,,AUTO
         4 001272   200000 236003                    LDQ     65536,DU
         4 001273   000011 256100                    ORSQ    9,,PR0

      634     7405
      635     7406    4                 DO WHILE('0'B);

   7406  4 001274   001304 710000 4                  TRA     s:7415

      636     7407
      637     7408    4   ACTIVATE_ERR:
      638     7409    4                   IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 1154 /* E$CGAFNS */
              7409                            THEN

   7409  4 001275   000000 470400 xsym  ACTIVATE_ERR LDP0    B$TCB$
         4 001276   000000 471500                    LDP1    0,,PR0
         4 001277   100102 236100                    LDQ     66,,PR1
         4 001300   377770 376007                    ANQ     131064,DL
         4 001301   022020 116007                    CMPQ    9232,DL
         4 001302   001304 600000 4                  TZE     s:7415

      639     7410    5                     DO;

      640     7411    5                       GOTO MON_ERR;

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:89   
   7411  4 001303   001377 710000 4                  TRA     MON_ERR

      641     7412    5                     END;
      642     7413    4                 END /* NEVER */;

      643     7414
      644     7415    3                 DELTA_PERM = DELTA_PERM + 1;

   7415  4 001304   200035 054100                    AOS     DELTA_PERM,,AUTO

      645     7416    3               END;

      646     7417    2           END;

   7417  4 001305   200035 235100                    LDA     DELTA_PERM,,AUTO
         4 001306   001252 604000 4                  TMI     s:7399

      647     7418
      648     7419    1           CALL QQB$SAVCMD;                /*  Good TRANS commands will be saved */

   7419  4 001307   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001310   000000 701000 xent               TSX1    QQB$SAVCMD
         4 001311   000000 011000                    NOP     0

      649     7420    1           GOTO RET;

   7420  4 001312   001376 710000 4                  TRA     RET

      650     7421
      651     7422    1   START_ERR:
      652     7423    1           QQ_CMDBLK.MINOR_ERR = CODE_CST;

   7423  4 001313   000033 236000 2     START_ERR    LDQ     CODE_CST
         4 001314   000001 756000 xsym               STQ     QQ_CMDBLK+1

      653     7424    1           CALL QQC$BLDMSG_BLK(MSGBLK);

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:90   
   7424  4 001315   200050 630500                    EPPR0   MSGBLK,,AUTO
         4 001316   200076 450500                    STP0    ERR+1,,AUTO
         4 001317   200076 630500                    EPPR0   ERR+1,,AUTO
         4 001320   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001321   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 001322   000000 011000                    NOP     0

      654     7425    1           CALL QQC$CONVERT_NUM(I - 1, SIZE, ADDR(TEXTC_NUM.NAME#));

   7425  4 001323   200020 235100                    LDA     I,,AUTO
         4 001324   000001 135007                    SBLA    1,DL
         4 001325   200076 755100                    STA     ERR+1,,AUTO
         4 001326   000001 236000 5                  LDQ     1
         4 001327   200077 756100                    STQ     ERR+2,,AUTO
         4 001330   200077 630500                    EPPR0   ERR+2,,AUTO
         4 001331   200102 450500                    STP0    ERR+5,,AUTO
         4 001332   200037 631500                    EPPR1   SIZE,,AUTO
         4 001333   200101 451500                    STP1    ERR+4,,AUTO
         4 001334   200076 633500                    EPPR3   ERR+1,,AUTO
         4 001335   200100 453500                    STP3    ERR+3,,AUTO
         4 001336   200100 630500                    EPPR0   ERR+3,,AUTO
         4 001337   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001340   000000 701000 xent               TSX1    QQC$CONVERT_NUM
         4 001341   000000 011000                    NOP     0

      655     7426    1           TEXTC_NUM.L# = SIZE;

   7426  4 001342   200037 236100                    LDQ     SIZE,,AUTO
         4 001343   000033 736000                    QLS     27
         4 001344   000002 552040 3                  STBQ    TEXTC_NUM,'40'O

      656     7427    1           MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_NUM);

   7427  4 001345   000100 100400                    MLR     fill='000'O
         4 001346   000002 000010 5                  ADSC9   2                        cn=0,n=8
         4 001347   200057 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:91   
      657     7428    1           MSGBLK.ERRINFO.ERR(1) = ERR;

   7428  4 001350   000100 100500                    MLR     fill='000'O
         4 001351   200075 000004                    ADSC9   ERR,,AUTO                cn=0,n=4
         4 001352   200065 200004                    ADSC9   MSGBLK+13,,AUTO          cn=1,n=4

      658     7429    1           CALL QQC$BLDMSG(MSGBLK);

   7429  4 001353   200050 630500                    EPPR0   MSGBLK,,AUTO
         4 001354   200076 450500                    STP0    ERR+1,,AUTO
         4 001355   200076 630500                    EPPR0   ERR+1,,AUTO
         4 001356   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001357   000000 701000 xent               TSX1    QQC$BLDMSG
         4 001360   000000 011000                    NOP     0

      659     7430    1           GOTO RET;

   7430  4 001361   001376 710000 4                  TRA     RET

      660     7431
      661     7432    1   PRINT_ERR:
      662     7433    1           CALL QQC$BLDMSG_BLK(MSGBLK);

   7433  4 001362   200050 630500       PRINT_ERR    EPPR0   MSGBLK,,AUTO
         4 001363   200076 450500                    STP0    ERR+1,,AUTO
         4 001364   200076 630500                    EPPR0   ERR+1,,AUTO
         4 001365   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001366   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 001367   000000 011000                    NOP     0

      663     7434    1           CALL QQC$BLDMSG(MSGBLK);

   7434  4 001370   200050 630500                    EPPR0   MSGBLK,,AUTO
         4 001371   200076 450500                    STP0    ERR+1,,AUTO
         4 001372   200076 630500                    EPPR0   ERR+1,,AUTO
         4 001373   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001374   000000 701000 xent               TSX1    QQC$BLDMSG
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:92   
         4 001375   000000 011000                    NOP     0

      664     7435
      665     7436    1   RET:
      666     7437    1           RETURN;

   7437  4 001376   000000 702200 xent  RET          TSX2  ! X66_ARET

      667     7438
      668     7439    1   MON_ERR:
      669     7440    1           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   7440  4 001377   000000 470400 xsym  MON_ERR      LDP0    B$TCB$
         4 001400   000000 471500                    LDP1    0,,PR0
         4 001401   100102 236100                    LDQ     66,,PR1
         4 001402   000000 756000 xsym               STQ     QQ_GLOBAL

      670     7441    1           CALL QQC$SCREECH;

   7441  4 001403   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001404   000000 701000 xent               TSX1    QQC$SCREECH
         4 001405   000000 011000                    NOP     0

      671     7442    1   END QQB$TRANS;

   7442  4 001406   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:93   
--  Include file information  --

   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQB$TRANS.
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:94   

 **** Variables and constants ****

  ****  Section 002 RoData QQB$TRANS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    41-0-0/b STRC        r     1 CODE_BIGGEST_MAXLATCH
    26-0-0/b STRC        r     1 CODE_BIGGEST_PRIO         37-0-0/b STRC        r     1 CODE_BIGGEST_TIMEOUT
    32-0-0/b STRC        r     1 CODE_BIGR_MAXACT          33-0-0/b STRC        r     1 CODE_CST
    34-0-0/b STRC        r     1 CODE_DUPL                 23-0-0/b STRC        r     1 CODE_IWT
    22-0-0/b STRC        r     1 CODE_NMOT                 25-0-0/b STRC        r     1 CODE_NOTDEF
    31-0-0/b STRC        r     1 CODE_NOTENUF_TPUS         35-0-0/b STRC        r     1 CODE_NOWWT
    24-0-0/b STRC        r     1 CODE_NWH                  30-0-0/b STRC        r     1 CODE_SMALLEST_MAXACT
    40-0-0/b STRC        r     1 CODE_SMALLEST_MAXLATCH
    27-0-0/b STRC        r     1 CODE_SMALLEST_PRIO
    36-0-0/b STRC        r     1 CODE_SMALLEST_TIMEOUT
    42-0-0/b STRC        r     1 CODE_TWOP                 10-0-0/d STRC(324)   r     1 VLP_CGQL_C
     0-0-0/d STRC(288)   r     1 VLP_CGTYPL_C

  ****  Section 003  Data  QQB$TRANS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/d STRC(576)   r     1 FPT_ACTIVATE              26-0-0/d STRC(1872)  r     1 FPT_CGCTL
   112-0-0/d STRC(1800)  r     1 FPT_CGINFO                 0-0-0/c CHAR(8)     r     1 STATION
     2-0-0/c STRC(81)    r     1 TEXTC_NUM                204-0-0/d STRC(324)   r     1 VLP_CGQL
   174-0-0/d STRC(288)   r     1 VLP_CGTYPL

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    34-0-0/w SBIN        r     1 DELTA                     35-0-0/w SBIN        r     1 DELTA_PERM
    75-0-0/b STRC        r     1 ERR                       20-0-0/w SBIN        r     1 I
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:95   
     6-0-0/w PTR         r     1 JOURNAL$                  15-0-0/w PTR         r     1 MAXACTIVE$
    12-0-0/w PTR         r     1 MAXLATCH$                 50-0-0/w STRC(738)   r     1 MSGBLK
    40-0-0/c CHAR(8)     r     1 MSGTYP                    36-0-0/w SBIN        r     1 MULTIPLIER
    43-0-0/w BIT         r     1 NEW_JOURNAL_FLAG          30-0-0/w SBIN        r     1 NEW_MAXACTIVE
    26-0-0/w SBIN        r     1 NEW_MAXLATCH              45-0-0/w BIT         r     1 NEW_ONEREPORT_FLAG
    32-0-0/w SBIN        r     1 NEW_PERM                  24-0-0/w SBIN        r     1 NEW_PRIO
     5-0-0/w PTR         r     1 NEXT$                     47-0-0/w BIT         r     1 NOW_FLAG
    21-0-0/w UBIN        r     1 NSUBLKS                   44-0-0/w BIT         r     1 OLD_JOURNAL_FLAG
    27-0-0/w UBIN        r     1 OLD_MAXACTIVE             25-0-0/w UBIN        r     1 OLD_MAXLATCH
    46-0-0/w BIT         r     1 OLD_ONEREPORT_FLAG        31-0-0/w UBIN        r     1 OLD_PERM
    23-0-0/w UBIN        r     1 OLD_PRIO                  17-0-0/w PTR         r     1 OLD_SUBLK$
     7-0-0/w PTR         r     1 ONEREPORT$                13-0-0/w PTR         r     1 PERM$
    22-0-0/w UBIN        r     1 POS                       11-0-0/w PTR         r     1 PRIO$
     4-0-0/w PTR         r     1 S$                        37-0-0/w UBIN        r     1 SIZE
    10-0-0/w PTR         r     1 SUBLK$                     3-0-0/w PTR         r     1 T$
    33-0-0/w UBIN        r     1 TIMEOUT                   16-0-0/w PTR         r     1 TIMEOUT$
    14-0-0/w PTR         r     1 TYPE$                     42-0-0/w BIT         r     1 WILD_FLAG

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w STRC(315)   r     1 QQ_CMDBLK
     0-0-0/d STRC(9090)  r     1 QQ_GLOBAL

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0N  NULL        r     1 M$CG                       0-0-0/w STRC(144)   r     1 OUT$BLK
     0-0-0/w ASTR(153)   r     1 OUT$SYM                    0-0-0/w STRC(361)   r     1 TPU$INFO

PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:96   

   Procedure QQB$TRANS requires 775 words for executable code.
   Procedure QQB$TRANS requires 68 words of local(AUTO) storage.

    No errors detected in file QQB$TRANS.:E05TSI    .
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:97   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:98   
          MINI XREF LISTING

ACTIVATE_ERR
      7409**LABEL    7403--CALLALT
B$ALT.CODE
      6084**DCL      6084--REDEF    6085--REDEF    6085--REDEF
B$ALT.ERR
      6085**DCL      7129>>ASSIGN   7440>>ASSIGN
B$ALT.ERR.CODE
      6086**DCL      7409>>IF
B$ALT.ERR.ERR#
      6086**DCL      6086--REDEF
B$ALT.EVID
      6085**DCL      6085--REDEF    6085--REDEF
B$TCB.ALT$
      6080**DCL      7129>>ASSIGN   7409>>IF       7440>>ASSIGN
B$TCB$
      6027**DCL      7129>>ASSIGN   7409>>IF       7440>>ASSIGN
CALC_NEW_PERM
      7285**LABEL    7275--GOTO
CGINFO_ERR
      7129**LABEL    7121--CALLALT
CODE_BIGGEST_MAXLATCH
      6691**DCL      7366>>ASSIGN
CODE_BIGGEST_PRIO
      6614**DCL      7188>>ASSIGN
CODE_BIGGEST_TIMEOUT
      6677**DCL      7344>>ASSIGN
CODE_BIGR_MAXACT
      6642**DCL      7324>>ASSIGN
CODE_CST
      6649**DCL      7423>>ASSIGN
CODE_DUPL
      6656**DCL      7078>>ASSIGN
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:99   
CODE_IWT
      6593**DCL      7105>>ASSIGN
CODE_NMOT
      6586**DCL      7089>>ASSIGN
CODE_NOTDEF
      6607**DCL      7143>>ASSIGN   7152>>ASSIGN
CODE_NOTENUF_TPUS
      6635**DCL      7318>>ASSIGN
CODE_NOWWT
      6663**DCL      7388>>ASSIGN
CODE_NWH
      6600**DCL      7114>>ASSIGN
CODE_SMALLEST_MAXACT
      6628**DCL      7258>>ASSIGN
CODE_SMALLEST_MAXLATCH
      6684**DCL      7358>>ASSIGN
CODE_SMALLEST_PRIO
      6621**DCL      7196>>ASSIGN
CODE_SMALLEST_TIMEOUT
      6670**DCL      7336>>ASSIGN
CODE_TWOP
      6698**DCL      7096>>ASSIGN
DELTA
      6423**DCL      7172<<ASSIGN   7181<<CALLBLT  7183>>ASSIGN   7242<<ASSIGN   7250<<CALLBLT  7252>>ASSIGN
      7267<<ASSIGN   7301<<CALLBLT  7303>>ASSIGN   7307>>IF       7309>>ASSIGN
DELTA_PERM
      6424**DCL      7309<<ASSIGN   7313<<ASSIGN   7316>>IF       7322>>IF       7386>>IF       7393>>DOINDEX
      7398>>DOWHILE  7415<<ASSIGN   7415>>ASSIGN
DO_PRIO
      7163**LABEL    7126--GOTO
ERR
      6554**DCL      7129<<ASSIGN   7394<>CALL     7428>>ASSIGN
ERR.CODE
      6558**DCL      7131>>IF
FPT_ACTIVATE
      6866**DCL      7403<>CALL
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:100  
FPT_ACTIVATE.V
      6867**DCL      6866--DCLINIT
FPT_ACTIVATE.V.DVBYTE.REREAD#
      6869**DCL      6869--REDEF
FPT_CGCTL
      6890**DCL      7383<>CALL
FPT_CGCTL.V
      6895**DCL      6890--DCLINIT
FPT_CGINFO
      6914**DCL      7121<>CALL
FPT_CGINFO.V
      6919**DCL      6914--DCLINIT
I
      6411**DCL      7034<<DOINDEX  7035>>ASSIGN   7393<<DOINDEX  7425>>CALL
JOURNAL$
      6400**DCL      7025<<ASSIGN   7056>>ASSIGN   7057<<ASSIGN   7084>>IF       7110>>IF       7205>>IF
      7207>>IF       7372>>IF
M$ACTIVATE
        98**DCL-ENT  7403--CALL
M$CGCTL
        99**DCL-ENT  7383--CALL
M$CGINFO
        99**DCL-ENT  7121--CALL
MAXACTIVE$
      6407**DCL      7023<<ASSIGN   7047>>ASSIGN   7048<<ASSIGN   7084>>IF       7110>>IF       7148>>IF
      7150>>IF       7233>>IF       7235>>IF       7237>>CALLBLT  7237>>CALLBLT  7245>>IF       7250>>CALLBLT
      7250>>CALLBLT  7372>>IF
MAXLATCH$
      6404**DCL      7021<<ASSIGN   7071>>ASSIGN   7072<<ASSIGN   7084>>IF       7110>>IF       7352>>IF
      7354>>CALLBLT  7354>>CALLBLT  7372>>IF
MON_ERR
      7440**LABEL    7133--GOTO     7383--CALLALT  7411--GOTO
MSGBLK
      6438**DCL      7079<>CALL     7080<>CALL     7189<>CALL     7190<>CALL     7197<>CALL     7198<>CALL
      7259<>CALL     7260<>CALL     7325<>CALL     7326<>CALL     7337<>CALL     7338<>CALL     7345<>CALL
      7346<>CALL     7359<>CALL     7360<>CALL     7367<>CALL     7368<>CALL     7424<>CALL     7429<>CALL
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:101  
      7433<>CALL     7434<>CALL
MSGBLK.ERRINFO.ERR
      6516**DCL      7428<<ASSIGN
MSGBLK.ERRINFO.FIELD1
      6520**DCL      7427<<ASSIGN
MSGTYP
      6428**DCL      7053<<ASSIGN   7278>>IF       7394<>CALL     7400>>IF
MULTIPLIER
      6425**DCL      7173<<ASSIGN   7178<<ASSIGN   7183>>ASSIGN   7243<<ASSIGN   7247<<ASSIGN   7252>>ASSIGN
      7294<<ASSIGN   7298<<ASSIGN   7303>>ASSIGN   7309>>ASSIGN
NEW_JOURNAL_FLAG
      6431**DCL      7204<<ASSIGN   7209<<ASSIGN   7213<<ASSIGN   7380>>ASSIGN
NEW_MAXACTIVE
      6419**DCL      7232<<ASSIGN   7237<<CALLBLT  7252<<ASSIGN   7255>>IF       7257<<ASSIGN   7322>>IF
      7382>>ASSIGN
NEW_MAXLATCH
      6417**DCL      7351<<ASSIGN   7354<<CALLBLT  7355>>IF       7357<<ASSIGN   7363>>IF       7365<<ASSIGN
      7379>>ASSIGN
NEW_ONEREPORT_FLAG
      6433**DCL      7218<<ASSIGN   7223<<ASSIGN   7227<<ASSIGN   7381>>ASSIGN
NEW_PERM
      6421**DCL      7285<<ASSIGN   7290<<CALLBLT  7303<<ASSIGN   7313>>ASSIGN
NEW_PRIO
      6415**DCL      7163<<ASSIGN   7168<<CALLBLT  7174<<ASSIGN   7183<<ASSIGN   7183>>ASSIGN   7186>>IF
      7191<<ASSIGN   7194>>IF       7199<<ASSIGN
NEXT$
      6399**DCL      7270<<ASSIGN   7272<<ASSIGN   7272>>ASSIGN   7273>>IF       7278>>IF       7397<<ASSIGN
      7399<<ASSIGN   7399>>ASSIGN   7400>>IF       7402>>ASSIGN   7404>>ASSIGN
NOW_FLAG
      6435**DCL      7028<<ASSIGN   7064<<ASSIGN   7386>>IF       7394<>CALL
NO_Q
      7120**LABEL    7100--CALLALT
NSUBLKS
      6412**DCL      7032<<ASSIGN   7034>>DOINDEX
OLD_JOURNAL_FLAG
      6432**DCL      7123<<ASSIGN   7158<<ASSIGN   7204>>ASSIGN
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:102  
OLD_MAXACTIVE
      6418**DCL      7125<<ASSIGN   7157<<ASSIGN   7232>>ASSIGN   7252>>ASSIGN
OLD_MAXLATCH
      6416**DCL      7122<<ASSIGN   7351>>ASSIGN
OLD_ONEREPORT_FLAG
      6434**DCL      7124<<ASSIGN   7159<<ASSIGN   7218>>ASSIGN
OLD_PERM
      6420**DCL      7268<<ASSIGN   7280<<ASSIGN   7280>>ASSIGN   7285>>ASSIGN   7303>>ASSIGN   7313>>ASSIGN
      7316>>IF       7322>>IF
OLD_PRIO
      6414**DCL      7160<<ASSIGN   7163>>ASSIGN   7174>>ASSIGN
OLD_SUBLK$
      6409**DCL      7039<<ASSIGN   7043<<ASSIGN   7047<<ASSIGN   7051<<ASSIGN   7056<<ASSIGN   7060<<ASSIGN
      7067<<ASSIGN   7071<<ASSIGN   7076>>IF
ONEREPORT$
      6401**DCL      7026<<ASSIGN   7060>>ASSIGN   7061<<ASSIGN   7084>>IF       7110>>IF       7219>>IF
      7221>>IF       7372>>IF
OUT$BLK.NSUBLKS
      6210**DCL      7032>>ASSIGN   7141>>IF       7150>>IF       7166>>IF       7235>>IF       7288>>IF
OUT$BLK.SUBLK$
      6231**DCL      7035>>ASSIGN   7052>>ASSIGN   7057>>ASSIGN   7061>>ASSIGN   7168>>CALLBLT  7168>>CALLBLT
      7176>>IF       7181>>CALLBLT  7181>>CALLBLT  7237>>CALLBLT  7237>>CALLBLT  7245>>IF       7250>>CALLBLT
      7250>>CALLBLT  7290>>CALLBLT  7290>>CALLBLT  7296>>IF       7301>>CALLBLT  7301>>CALLBLT  7332>>CALLBLT
      7332>>CALLBLT  7354>>CALLBLT  7354>>CALLBLT
OUT$SYM.CODE
      6250**DCL      7036>>DOCASE   7176>>IF       7207>>IF       7221>>IF       7245>>IF       7296>>IF
OUT$SYM.COUNT
      6267**DCL      6270--IMP-SIZ  7053>>ASSIGN   7100>>CALLBLT  7103>>IF       7120>>ASSIGN   7168>>CALLBLT
      7181>>CALLBLT  7237>>CALLBLT  7250>>CALLBLT  7290>>CALLBLT  7301>>CALLBLT  7332>>CALLBLT  7354>>CALLBLT
      7378>>ASSIGN
OUT$SYM.TEXT
      6270**DCL      7053>>ASSIGN   7100>>CALLBLT  7120>>ASSIGN   7168>>CALLBLT  7181>>CALLBLT  7237>>CALLBLT
      7250>>CALLBLT  7290>>CALLBLT  7301>>CALLBLT  7332>>CALLBLT  7354>>CALLBLT  7378>>ASSIGN
PERM$
      6405**DCL      7022<<ASSIGN   7043>>ASSIGN   7044<<ASSIGN   7084>>IF       7094>>IF       7286>>IF
      7288>>IF       7290>>CALLBLT  7290>>CALLBLT  7296>>IF       7301>>CALLBLT  7301>>CALLBLT
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:103  
POS
      6413**DCL      7100<<CALLBLT  7103>>IF
PRINT_ERR
      7433**LABEL    7091--GOTO     7098--GOTO     7107--GOTO     7116--GOTO     7144--GOTO     7153--GOTO
      7319--GOTO     7390--GOTO
PRIO$
      6403**DCL      7020<<ASSIGN   7039>>ASSIGN   7040<<ASSIGN   7084>>IF       7110>>IF       7139>>IF
      7141>>IF       7164>>IF       7166>>IF       7168>>CALLBLT  7168>>CALLBLT  7176>>IF       7181>>CALLBLT
      7181>>CALLBLT  7372>>IF
QQB$SAVCMD
      5995**DCL-ENT  7419--CALL
QQC$BLDMSG
      5998**DCL-ENT  7080--CALL     7190--CALL     7198--CALL     7260--CALL     7326--CALL     7338--CALL
      7346--CALL     7360--CALL     7368--CALL     7429--CALL     7434--CALL
QQC$BLDMSG_BLK
      5997**DCL-ENT  7079--CALL     7189--CALL     7197--CALL     7259--CALL     7325--CALL     7337--CALL
      7345--CALL     7359--CALL     7367--CALL     7424--CALL     7433--CALL
QQC$CONVERT_NUM
      6001**DCL-ENT  7425--CALL
QQC$SCREECH
      5996**DCL-ENT  7441--CALL
QQC$START_TPU
      5999**DCL-ENT  7394--CALL
QQ_CMDBLK.FLAGS.ERR
      5550**DCL      7090<<ASSIGN   7097<<ASSIGN   7106<<ASSIGN   7115<<ASSIGN   7389<<ASSIGN
QQ_CMDBLK.MINOR_ERR
      5549**DCL      7078<<ASSIGN   7089<<ASSIGN   7096<<ASSIGN   7105<<ASSIGN   7114<<ASSIGN   7143<<ASSIGN
      7152<<ASSIGN   7188<<ASSIGN   7196<<ASSIGN   7258<<ASSIGN   7318<<ASSIGN   7324<<ASSIGN   7336<<ASSIGN
      7344<<ASSIGN   7358<<ASSIGN   7366<<ASSIGN   7388<<ASSIGN   7423<<ASSIGN
QQ_CMDBLK.OUT$
      5549**DCL      7032>>ASSIGN   7035>>ASSIGN
QQ_GLOBAL.DS1$_BITS
      5560**DCL      5560--REDEF
QQ_GLOBAL.DS2$_BITS
      5560**DCL      5561--REDEF
QQ_GLOBAL.DS3$_BITS
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:104  
      5561**DCL      5561--REDEF
QQ_GLOBAL.DS4$_BITS
      5561**DCL      5562--REDEF
QQ_GLOBAL.ERR
      5550**DCL      7440<<ASSIGN
QQ_GLOBAL.TPU$
      5562**DCL      7270>>ASSIGN   7397>>ASSIGN
RET
      7437**LABEL    7420--GOTO     7430--GOTO
S$
      6131**DCL      6133--IMP-PTR
SET_MAXACTIVE
      7255**LABEL    7239--GOTO
SET_PERM
      7307**LABEL    7291--GOTO
SET_PRIO
      7186**LABEL    7169--GOTO
SIZE
      6426**DCL      7425<>CALL     7426>>ASSIGN
START_ERR
      7423**LABEL    7394--CALLALT
STATION
      6373**DCL      6866--DCLINIT  7402<<ASSIGN
SUBLK$
      6402**DCL      7035<<ASSIGN   7036>>DOCASE   7040>>ASSIGN   7044>>ASSIGN   7048>>ASSIGN   7052>>ASSIGN
      7057>>ASSIGN   7061>>ASSIGN   7068>>ASSIGN   7072>>ASSIGN
T$
      6091**DCL      6092--IMP-PTR
TEXTC_NUM
      6552**DCL      7427--ASSIGN
TEXTC_NUM.L#
      6552**DCL      7426<<ASSIGN
TEXTC_NUM.NAME#
      6552**DCL      7425--CALL
TIMEOUT
      6422**DCL      7030<<ASSIGN   7332<<CALLBLT  7333>>IF       7335<<ASSIGN   7341>>IF       7343<<ASSIGN
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:105  
      7394<>CALL
TIMEOUT$
      6408**DCL      7029<<ASSIGN   7067>>ASSIGN   7068<<ASSIGN   7094>>IF       7330>>IF       7332>>CALLBLT
      7332>>CALLBLT
TPU$INFO.FLAGS.DISCONNECT
      6111**DCL      7404<<ASSIGN
TPU$INFO.FLINK$
      6095**DCL      7272>>ASSIGN   7273>>IF       7399>>ASSIGN
TPU$INFO.MSGTYP
      6103**DCL      7278>>IF       7400>>IF
TPU$INFO.STATION
      6101**DCL      7402>>ASSIGN
TYPE$
      6406**DCL      7024<<ASSIGN   7051>>ASSIGN   7052<<ASSIGN   7053>>ASSIGN   7053>>ASSIGN   7084>>IF
      7100>>CALLBLT  7100>>CALLBLT  7103>>IF       7120>>ASSIGN   7120>>ASSIGN   7378>>ASSIGN   7378>>ASSIGN
VLP_CGQL
      6989**DCL      6892--DCLINIT  6916--DCLINIT
VLP_CGQL.LIST
      6989**DCL      7377<<ASSIGN
VLP_CGQL.LIST.MXACT#
      6989**DCL      7125>>ASSIGN   7382<<ASSIGN
VLP_CGQL_C.LIST
      6342**DCL      7377>>ASSIGN
VLP_CGQL_C.LIST.MXACT#
      6342**DCL      7157>>ASSIGN
VLP_CGTYPL
      6966**DCL      6890--DCLINIT  6914--DCLINIT
VLP_CGTYPL.LIST
      6966**DCL      7376<<ASSIGN
VLP_CGTYPL.LIST.JOURNAL#
      6967**DCL      7123>>ASSIGN   7380<<ASSIGN
VLP_CGTYPL.LIST.MAXLATCH#
      6969**DCL      7122>>ASSIGN   7379<<ASSIGN
VLP_CGTYPL.LIST.NAME#
      6966**DCL      7120<<ASSIGN   7378<<ASSIGN
VLP_CGTYPL.LIST.ONEREPORT#
PL6.E3A0      #001=QQB$TRANS File=QQB$TRANS.:E05TSI                              WED 07/30/97 05:37 Page:106  
      6968**DCL      7124>>ASSIGN   7381<<ASSIGN
VLP_CGTYPL_C.LIST
      6318**DCL      7376>>ASSIGN
VLP_CGTYPL_C.LIST.JOURNAL#
      6319**DCL      7158>>ASSIGN
VLP_CGTYPL_C.LIST.ONEREPORT#
      6320**DCL      7159>>ASSIGN
VLP_CGTYPL_C.LIST.PRIO#
      6319**DCL      7160>>ASSIGN
WILD_FLAG
      6430**DCL      7027<<ASSIGN   7101<<ASSIGN   7386>>IF
